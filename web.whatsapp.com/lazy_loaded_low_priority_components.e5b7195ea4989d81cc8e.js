/*! Copyright (c) 2021 WhatsApp Inc. All Rights Reserved. */
(self.webpackChunkwhatsapp_web_client=self.webpackChunkwhatsapp_web_client||[]).push([[275],{26004:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.cartItemCollection.reset(),e.set("message",void 0),e.trigger("change:cartItemCollection"),(0,i.default)(e)};var i=a(s(83622))},97783:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){const s=i.default.findCart(e);return s.cartItemCollection.remove(t),s.trigger("change:cartItemCollection"),(0,n.default)(s),s.itemCount};var i=a(s(25523)),n=a(s(83622))},30833:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.parsePrice=v,t.isPriceMatch=C,t.createProductFromRefreshCartItem=x,t.default=function(e,t){const s=n.default.get((0,m.createWid)(e.id)),a=[],i=[];let c=!0;s&&e.cartItemCollection.forEach((n=>{const o=s.productCollection.get(n.id);let l=t&&t.products.find((e=>e.id===n.id));if(l=function(e,t){if(e&&"deleted"===e.status)return void t.productCollection.remove(e.id);return e}(l,s),!t&&o){const e=function(e,t){const s=function(e,t){return e.priceAmount1000===(0,h.getActivePrice)(t)&&e.currency===t.currency&&e.name===t.name&&e.imageHash===t.imageHash}(e,t);s||e.set({priceAmount1000:(0,h.getActivePrice)(t),currency:t.currency,name:t.name,imageHash:t.imageHash},{silent:!0});return s}(n,o);c=c&&e,a.push({product:o,cartItem:n})}else if(l){const t=function(e,t){const s=!t||function(e,t){var s,a;const i=(0,h.getActivePrice)(_(t));return C(e.priceAmount1000,i)&&(!(0,p.isString)(e.currency)&&!(0,p.isString)(t.currency)||e.currency===t.currency)&&e.name===t.name&&e.imageHash===(null===(s=t.media)||void 0===s||null===(a=s.image)||void 0===a?void 0:a.id)}(e,t);if(!s&&t){const s=_(t);e.set({priceAmount1000:(0,h.getActivePrice)(s),currency:s.currency,name:s.name,imageHash:s.imageHash},{silent:!0})}return s}(n,l);c=c&&t,a.push({product:x(l,e.id),cartItem:n})}else c=!1,i.push(n.id)})),s||(0,o.default)(e);c||(i.length&&e.cartItemCollection.remove(i),e.trigger("change:cartItemCollection"),l.default.openModal((0,g.jsx)(r.default,{onOK:()=>{l.default.closeModal()},children:d.default.t(487)})));return(0,f.default)(e),a};var i=a(s(81109)),n=a(s(60028)),o=a(s(26004)),l=a(s(91952)),r=a(s(75940)),d=a(s(2408)),c=a(s(78150)),u=s(94583),h=s(60952),f=a(s(83622)),p=s(74289),m=s(89573),g=s(85893);function _(e){var t,s,a,i,n,o,l,r;return{id:e.id,name:null!==(t=e.name)&&void 0!==t?t:"",imageCdnUrl:null===(s=e.media)||void 0===s||null===(a=s.image)||void 0===a?void 0:a.request_image_url,imageHash:null===(i=e.media)||void 0===i||null===(n=i.image)||void 0===n?void 0:n.id,currency:e.currency,priceAmount1000:v(e.price),salePriceAmount1000:v(null===(o=e.sale_price)||void 0===o?void 0:o.price),salePriceStartDate:(0,u.parseDateValue)(null===(l=e.sale_price)||void 0===l?void 0:l.start_date),salePriceEndDate:(0,u.parseDateValue)(null===(r=e.sale_price)||void 0===r?void 0:r.end_date)}}function v(e){return"string"==typeof e?e.length>0?parseInt(e,10):null:e}function C(e,t){const s=v(e),a=v(t);return(0,p.isNumber)(s)&&(0,p.isNumber)(a)?s===a:!(0,p.isNumber)(s)&&!(0,p.isNumber)(a)}function x(e,t){return new c.default((0,i.default)((0,i.default)({},_(e)),{},{catalogWid:(0,m.createWid)(t),productMsgMediaData:null,imageCount:1,fetchedFromServer:!0,t:Date.now()/1e3,old:!1}))}},32973:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){if(0===e.cartItemCollection.length)return Promise.resolve({products:[],price:{}});const t=e.cartItemCollection.map((e=>e.id));return(0,i.refreshCart)(e.id,t,n.default.imageWidth,n.default.imageHeight)};var i=s(62010),n=a(s(25523))},33764:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return u.apply(this,arguments)};var i=a(s(48926)),n=a(s(60028)),o=s(53071),l=a(s(58679)),r=a(s(83622)),d=s(89573);function c(e){var t,s;const a=e.cartItemCollection.at(0);if(null==a)return"";const i=n.default.get((0,d.createWid)(e.id)),o=null==i?void 0:i.productCollection.get(a.id),l=null==o||null===(t=o.productImageCollection.at(0))||void 0===t?void 0:t.mediaData;if(null==l)return"";const r=null===(s=l.preview)||void 0===s?void 0:s.getBase64();return null!=r?r:""}function u(){return(u=(0,i.default)((function*(e,t){const s=yield(0,o.createOrder)(t.id,e.cartItemCollection.toArray());return yield(0,l.default)(t,s,e.itemCount,c(e),e.message),(0,r.default)(e),s.id}))).apply(this,arguments)}},75878:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){e.set("message",t),(0,i.default)(e)};var i=a(s(83622))},48133:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,s){const a=i.default.findCart(e),o=a.cartItemCollection.get(t.id);null==o||o.set("quantity",s),a.trigger("change:cartItemCollection"),(0,n.default)(a)};var i=a(s(25523)),n=a(s(83622))},58679:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return f.apply(this,arguments)};var i=a(s(48926)),n=a(s(25142)),o=a(s(55454)),l=s(86723),r=a(s(77043)),d=a(s(17754)),c=s(35339),u=s(88300),h=a(s(69635));function f(){return(f=(0,i.default)((function*(e,t,s,a,i){const n=(0,l.getMaybeMeUser)(),o=p(e,t,s,a,i);if(h.default.equals(e.id,n))return(0,c.addAndSendMsgToChat)(e,o)[0].then((()=>{})).catch((e=>{throw __LOG__(3)`Order message send to chat failure: ${e}`,e}));try{const t=yield(0,c.addAndSendMsgToChat)(e,o)[1];if(!t||t!==u.SendMsgResult.OK)throw new Error("Order message SendMsgResult failure status")}catch(e){throw __LOG__(3)`Order message send to chat failure: ${e}`,e}}))).apply(this,arguments)}function p(e,t,s,a,i){const c=(0,l.getMaybeMeUser)(),u={type:"order",ack:o.default.ACK.CLOCK,from:c,id:new r.default({from:c,to:e.id,id:(0,d.default)(),participant:void 0,selfDir:"out"}),local:!0,isNewMsg:!0,self:"out",t:n.default.globalUnixTime(),to:e.id,orderId:t.id,token:t.token,orderTitle:e.name||e.formattedTitle,sellerJid:e.id.toString({legacy:!0}),thumbnail:a,itemCount:s,message:i},h=t.price.total;return h&&h.length>0&&(u.totalAmount1000=parseInt(h,10)),t.price.currency&&t.price.currency.length>0&&(u.totalCurrencyCode=t.price.currency),u}},17959:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.setPushname=function(e){return p(e)};var i=a(s(48926)),n=s(55084),o=s(6467),l=a(s(91952)),r=a(s(9322)),d=s(54647),c=a(s(2408)),u=a(s(66743)),h=s(14403),f=s(85893);function p(){return m.apply(this,arguments)}function m(){return(m=(0,i.default)((function*(e,t=(0,o.genId)()){const s=(0,u.default)(e),a=new o.ActionType(c.default.t(216)),i=r.default.pushname,m=s.then((()=>new o.ActionType(c.default.t(213),{actionText:c.default.t(228),actionHandler:()=>p(i,t)}))).catch((0,n.filteredCatch)(d.ServerStatusCodeError,(e=>{if(e.status>=400)return new o.ActionType(c.default.t(214))}))).catch((()=>{throw __LOG__(3)`models:conn:setPushname dropped`,new o.ActionType(c.default.t(214),{actionText:c.default.t(224),actionHandler:()=>p(status,t)})}));l.default.openToast((0,f.jsx)(o.ActionToast,{id:t,initialAction:a,pendingAction:m}));(yield s)._duplicate||(0,h.setPushnameLocally)(e)}))).apply(this,arguments)}},16875:(e,t,s)=>{"use strict";var a=s(20862),i=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,s,a){const i=e.map(C.vcardFromContactModel),l=1===i.length?i[0]:(0,C.mergeVcards)(i),r=`${l.displayName}.vcf`,c=(0,h.createFile)([l.vcard],r,{type:S}),v=c.size/1024;if(0!==_.default.vcardAsDocumentSizeKb&&v>_.default.vcardAsDocumentSizeKb)return void function(){y.apply(this,arguments)}(c,e.length,t,s,a);!function(e,t,s,a,i){const l=a&&a.msgContextInfo(t.id),r=(0,f.getMaybeMeUser)(),c=(0,n.default)((0,n.default)({ack:u.default.ACK.CLOCK,from:r,id:new p.default({from:r,to:t.id,id:(0,m.default)(),participant:void 0,selfDir:"out"}),local:!0,isNewMsg:!0,self:"out",t:d.default.globalUnixTime(),to:t.id},l),{},{ctwaContext:i}),h=1===e.length?(0,n.default)((0,n.default)({type:"vcard",vcardFormattedName:e[0].displayName,body:e[0].vcard},c),E(t)):(0,n.default)((0,n.default)({type:"multi_vcard",vcardList:e},c),E(t));(0,o.default)((function*(){try{yield(0,g.addAndSendMsgToChat)(t,h)[1]}catch(e){throw __LOG__(2)`Error sending contact: ${e}`,e}}))()}(i,t,0,s,a)};var n=i(s(81109)),o=i(s(48926)),l=i(s(7900)),r=i(s(62202)),d=i(s(25142)),c=i(s(91952)),u=i(s(55454)),h=s(57085),f=s(86723),p=i(s(77043)),m=i(s(17754)),g=s(35339),_=i(s(65565)),v=a(s(49201)),C=s(50313),x=s(85893);const S="text/vcard";function y(){return(y=(0,o.default)((function*(e,t,s,a,i){const n={file:e,type:u.default.MSG_TYPE.DOCUMENT,filename:e.name,mimetype:S,isVcardOverMmsDocument:!0,documentPageCount:t},d=new r.default({chatParticipantCount:s.getParticipantCount()});yield d.processAttachments([n]);const{errorMsgs:h}=d.uiProcessMsgs();if(h)return void c.default.openToast((0,x.jsx)(v.default,{msg:h,id:(0,v.genId)()}));const f=(0,l.default)(d.getValidMedias()[0],"collection.getValidMedias()[0]");(0,o.default)((function*(){try{yield f.sendToChat(s,{quotedMsg:a,ctwaContext:i})}catch(e){throw __LOG__(2)`Error sending contact: ${e}`,e}}))()}))).apply(this,arguments)}function E(e){const t={};e.isEphemeralSettingOn()&&(t.ephemeralDuration=e.getEphemeralSetting());const s=e.getEphemeralSettingTimestamp();null!=s&&(t.ephemeralSettingTimestamp=s);const a=e.getDisappearingModeInitiator();return null!=a&&(t.disappearingModeInitiator=a),t}},88253:(e,t,s)=>{"use strict";var a=s(20862),i=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){n.default.openToast((0,r.jsx)(l.default,{msg:o.default.t(495),duration:6e3,id:(0,l.genId)()}))};var n=i(s(91952)),o=i(s(2408)),l=a(s(49201)),r=s(85893)},66557:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.sendSupportRequest=function(){return f.apply(this,arguments)};var i=a(s(48926)),n=s(8701),o=s(43129),l=s(28047),r=s(84922),d=s(86723),c=s(49438);function u(e,t){__LOG__(3,void 0,void 0,!0)`supportRequest error: code=${e} message=${null!=t?t:""}`,SEND_LOGS("supportRequest")}const h=new n.WapParser("supportResponse",(e=>{const t=e.child("response");if(t.hasAttr("error_code")){return{type:"error",errorCode:t.attrInt("error_code",0,1e3)}}t.assertAttr("status","ok");return{type:"success",message:t.child("message").contentString(),ticketId:t.child("ticket_id").contentString()}}));function f(){return(f=(0,i.default)((function*(e,t){const s=(0,o.wap)("iq",{from:(0,c.USER_JID)((0,d.getMeUser)()),id:(0,o.generateId)(),smax_id:"3",to:o.S_WHATSAPP_NET,type:"set",xmlns:"fb:thrift_iq"},(0,o.wap)("description",null,e),null!=t?(0,o.wap)("debug_information_json",null,t):null),a=yield(0,r.sendIq)(s,h);let i;if(a.success){var n;const{result:e}=a;return"success"===e.type?(null!=t&&(__LOG__(2)`InAppSupport: Uploading logs for ticketId=${e.ticketId}`,(0,l.upload)({reason:"user-report",immediate:!0,force:!0,persist:!0,ticketId:e.ticketId}).then((t=>{__LOG__(2)`InAppSupport: Logs upload complete for ticketId=${e.ticketId}, logsId=${t}`}))),{type:"success",message:e.message,ticketId:e.ticketId}):(i=null!==(n=e.errorCode)&&void 0!==n?n:400,u(i),{type:"error",errorCode:i})}return u(a.errorCode,a.errorText),{type:"error",errorCode:a.errorCode}}))).apply(this,arguments)}},85148:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.editBusinessCompliance=t.editBusinessProfile=void 0;var i=a(s(12950)),n=a(s(77828)),o=s(18149),l=s(60805);t.editBusinessProfile=e=>{let t;return i.default.supportsFeature(i.default.F.MD_BACKEND)?(t=(0,o.editBusinessProfile)(e),t||(t=Promise.reject(new Error("md business profile edit not supported")))):t=(0,n.default)(e),t};t.editBusinessCompliance=e=>i.default.supportsFeature(i.default.F.MD_BACKEND)?(0,l.setMerchantCompliance)(e):Promise.reject(new Error("md business compliance profile edit not supported"))},77828:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.convertProfileToRequestData=void 0;var i=a(s(81109)),n=a(s(48926)),o=s(54647),l=a(s(4321)),r=a(s(72787));const d=e=>{if(!e)return;return{category:e.map((({id:e})=>({id:e})))}},c=e=>{if(!e)return;const{note:t,timezone:s,config:a}=e,i=[];for(const e in a){const t=a[e],{mode:s,hours:n}=t;if(n)for(const[t,a]of n)i.push({day_of_week:e,mode:s,open_time:t,close_time:a});else i.push({day_of_week:e,mode:s})}return{timezone:s,business_hours_note:t,business_hours_config:i}},u=({address:e,description:t,email:s,website:a,businessHours:i,categories:n})=>{const o=(0,l.default)({address:e,description:t,email:s,website:a,business_hours:c(i),categories:d(n)});return Object.keys(o).length>0?o:void 0};t.convertProfileToRequestData=u;var h=function(){var e=(0,n.default)((function*(e){const t=u(e);if(!t)return void __LOG__(3)`empty profile received, ignoring save`;const s=(0,i.default)({v:2},t);try{const e=yield r.default.send2({data:["action","editBusinessProfile",s],retryOn5xx:!0}),{status:t}=e;if((e=>e>=200&&e<=299)(t))return;throw __LOG__(3)`error editing business profile webd: ${t}`,new o.ServerStatusCodeError(t,"edit business profile")}catch(e){const t=e;throw __LOG__(3)`error editing business profile: ${t}`,t}}));return function(){return e.apply(this,arguments)}}();t.default=h},66743:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return h.apply(this,arguments)};var i=a(s(48926)),n=s(54647),o=a(s(12950)),l=a(s(865)),r=s(57148),d=a(s(59961)),c=a(s(72363)),u=s(78487);function h(){return(h=(0,i.default)((function*(e){if(o.default.supportsFeature(o.default.F.MD_BACKEND)&&e){const t=(0,r.unixTimeMs)(),s=c.default.getPushnameMutation(t,e);return(0,d.default)(e),(0,u.lockForSync)([],[s],(()=>Promise.resolve())).then((()=>({_duplicate:null})))}const t=yield l.default.setPushname(e);if(t.status&&200!==t.status)throw new n.ServerStatusCodeError(t.status);return{_duplicate:t._duplicate}}))).apply(this,arguments)}},85103:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CombinedFingerprintSpec=t.FingerprintDataSpec=void 0;var a=s(95783);const i={};t.FingerprintDataSpec=i;const n={};t.CombinedFingerprintSpec=n,i.internalSpec={publicKey:[1,a.TYPES.BYTES],identifier:[2,a.TYPES.BYTES]},n.internalSpec={version:[1,a.TYPES.UINT32],localFingerprint:[2,a.TYPES.MESSAGE,i],remoteFingerprint:[3,a.TYPES.MESSAGE,i]}},88743:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(s(48926)),n=a(s(81109)),o=s(67294),l=a(s(87009)),r=a(s(33287)),d=a(s(70775)),c=a(s(2408)),u=s(25349),h=a(s(33215)),f=a(s(40858)),p=a(s(20128)),m=a(s(29458)),g=s(83607),_=s(85893);const v=s(54302).Mirrored(["START","END"]),C=u.BUSINESS_HOUR_MODES.SPECIFIC_HOURS,x=()=>[(0,g.minutesToTime)(540),(0,g.minutesToTime)(1080)];class S extends o.Component{constructor(...e){super(...e),this.state=(({businessHours:{mode:e,days:t}})=>{const s={};for(const{dayKey:e,closed:a,hours:i,dayName:n}of t)s[e]={closed:a,hours:i||[x()],dayKey:e,dayName:n};return{mode:e||C,dayValues:s}})(this.props)}_buildDayId({dayKey:e}){return`${e}_business_hours`}_renderCheckbox(e){const{closed:t,dayKey:s}=e,a=this._buildDayId(e);return(0,_.jsx)("div",{className:l.default.dayCheckbox,children:(0,_.jsx)(r.default,{id:a,checked:!t,onChange:()=>{const{dayValues:e}=this.state,t=e[s];this._updateDayValue(s,{closed:!t.closed})}})})}_renderTabs(){const{mode:e}=this.state;return(0,_.jsx)(p.default,{onSelect:e=>{if(e===u.BUSINESS_HOUR_MODES.OPEN_24H){const{dayValues:t}=this.state;for(const e of u.DAYS_OF_WEEK)t[e]=(0,n.default)((0,n.default)({},t[e]),{},{closed:!1});this.setState({mode:e,dayValues:t})}else this.setState({mode:e})},selectedId:e,tabConfigs:[{title:c.default.t(423),id:u.BUSINESS_HOUR_MODES.SPECIFIC_HOURS},{title:c.default.t(419),id:u.BUSINESS_HOUR_MODES.OPEN_24H},{title:c.default.t(420),id:u.BUSINESS_HOUR_MODES.APPOINTMENT_ONLY}]})}_updateValueToUserTimeFormat(e,t,s){const{dayValues:a}=this.state,i=a[e],{hours:n}=i,o=t===v.START?0:1,l=n[s][o],r=(0,g.timeStringToMinutes)(l);void 0!==r&&this._updateDayValue(e,{hours:this._updateHoursValue(n,(0,g.minutesToTime)(r),t,s)})}_updateHoursValue(e,t,s,a){const i=[...e],n=s===v.START?0:1,o=[...i[a]];return o[n]=t,i[a]=o,i}_renderTimeInput(e,t,s,a){const i=(0,g.isValidTime)(t)?null:" ";return(0,_.jsx)("div",{className:l.default.timeWrapper,children:(0,_.jsx)(m.default,{managed:!0,value:t,theme:"small",maxLength:15,customStyleThemes:["desaturated","noErrorInfo"],error:i,onChange:t=>{const{dayValues:i}=this.state,n=i[e],{hours:o}=n;this._updateDayValue(e,{hours:this._updateHoursValue(o,t,s,a)})},onBlur:()=>{this._updateValueToUserTimeFormat(e,s,a)}})},`${e}-${s}-${a}`)}_updateDayValue(e,t){const{dayValues:s}=this.state,a=s[e];this.setState({dayValues:(0,n.default)((0,n.default)({},s),{},{[e]:(0,n.default)((0,n.default)({},a),t)})})}_addHours(e){const{dayValues:t}=this.state,s=t[e],{hours:a}=s;this._updateDayValue(e,{hours:[...a,x()]})}_removeHours(e){const{dayValues:t}=this.state,s=t[e],{hours:a}=s,i=[...a];i.pop(),this._updateDayValue(e,{hours:i})}_renderAdd(e){return(0,_.jsx)("div",{className:l.default.timeWrapper,children:(0,_.jsx)(d.default,{"aria-label":c.default.t(1),label:c.default.t(245),onClick:()=>{this._addHours(e)},prefixIcon:"status-ciphertext",iconTheme:"padded-svg"})})}_renderRemove(e){return(0,_.jsx)("div",{className:l.default.timeWrapper,children:(0,_.jsx)(f.default,{title:c.default.t(1516),"aria-label":c.default.t(1516),name:"x-alt",onClick:()=>{this._removeHours(e)}})})}_renderHours({dayKey:e,hours:t}){const s=[],a=t.length>=2?this._renderRemove(e):this._renderAdd(e);return t.forEach((([t,a],i)=>{i>0&&s.push((0,_.jsx)("div",{className:l.default.hoursAnd,children:c.default.t(413)})),s.push(this._renderTimeInput(e,t,v.START,i),this._renderTimeInput(e,a,v.END,i))})),(0,_.jsxs)("div",{className:l.default.hoursMain,children:[s,a]})}_renderDayValues(e,t){const{closed:s}=e;let a;return s?a=c.default.t(415):t===u.BUSINESS_HOUR_MODES.APPOINTMENT_ONLY?a=c.default.t(414):t===u.BUSINESS_HOUR_MODES.OPEN_24H&&(a=c.default.t(426)),a?(0,_.jsx)("div",{className:l.default.dayInfoText,children:a}):u.BUSINESS_HOUR_MODES.SPECIFIC_HOURS&&!e.closed?this._renderHours(e):null}_renderDayInfo(e,t){const{dayName:s}=e,a=this._buildDayId(e);return(0,_.jsxs)("div",{className:l.default.dayInfo,children:[(0,_.jsx)("label",{htmlFor:a,children:s}),this._renderDayValues(e,t)]})}_renderDay(e){const{mode:t}=this.state;return(0,_.jsxs)("div",{className:l.default.dayMain,children:[this._renderCheckbox(e),this._renderDayInfo(e,t)]},`day-${e.dayKey}`)}_renderBusinessHours(){const{businessHours:{days:e}}=this.props;return(0,_.jsxs)("div",{children:[this._renderTabs(),(0,_.jsx)("div",{className:l.default.editMain,children:e.map((({dayKey:e})=>{const t=this.state.dayValues[e];return this._renderDay(t)}))})]})}render(){var e=this;const t=this._renderBusinessHours(),{mode:s,dayValues:a}=this.state,{businessHours:{note:n,timezone:o}}=this.props;return(0,_.jsx)(h.default,{title:c.default.t(421),isValid:(0,g.isValidBusinessHours)(s,a),doSave:(0,i.default)((function*(){yield e.props.saveBusinessProfile((0,g.convertToRawBusinessProfile)({mode:s,dayValues:a,note:n,timezone:o}))})),afterSave:this.props.afterSave,onCancel:this.props.onCancel,children:t})}}t.default=S,S.displayName="BusinessHours"},55409:(e,t,s)=>{"use strict";var a=s(20862),i=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(s(48926)),o=i(s(81109)),l=i(s(94184)),r=s(67294),d=s(32816),c=s(42097),u=i(s(50743)),h=i(s(33287)),f=i(s(52349)),p=i(s(91952)),m=i(s(86025)),g=i(s(19257)),_=i(s(67893)),v=i(s(2408)),C=i(s(55325)),x=i(s(33215)),S=i(s(46714)),y=a(s(49201)),E=s(85893);class j extends r.Component{constructor(...e){super(...e),this.state=(({initialCategories:e})=>({selectedCategories:e,searchText:"",isLoading:!1}))(this.props),this.flatListController=new _.default,this.setRefList=e=>{this.list=e},this.renderItem=e=>{const t=(0,E.jsx)(h.default,{id:`${e.id}`,onChange:()=>{!e.disabled&&this._toggleResultById(e.id)},checked:e.selected,disabled:e.disabled}),s=(0,E.jsx)("label",{className:(0,l.default)(u.default.rowLabel,{[u.default.disabled]:e.disabled}),htmlFor:e.id,children:e.localized_display_name});return this._renderRow(s,t)},this._removeById=e=>{const t=this.state.selectedCategories.filter((t=>t.id===e))[0];t&&this.toggle(t)},this._toggleResultById=e=>{var t;const s=null===(t=this.state.results)||void 0===t?void 0:t.filter((t=>t.id===e))[0];s&&this.toggle(s)},this.toggle=e=>{var t;const s=null===(t=this.state.results)||void 0===t?void 0:t.find((e=>e.not_a_biz)),a=this.state.selectedCategories.find((e=>e.id===(null==s?void 0:s.id)));let i=this.state.selectedCategories;this.state.selectedCategories.length>0&&(e.not_a_biz&&!a?(i=[],this._showConflictWarning()):!e.not_a_biz&&a&&(i=this.state.selectedCategories.filter((e=>e.id!==a.id)),this._showConflictWarning())),this.isSelected(e.id)?this.setState({selectedCategories:i.filter((t=>t.id!==e.id))}):this.setState({selectedCategories:[...i,e]})},this.setSearchText=e=>{this._getResults(e)},this.handleRemoveItem=e=>{this.setState({selectedCategories:this.state.selectedCategories.filter((t=>t.id!==e.id))})}}componentDidMount(){this._getResults("")}renderList(){if(this.state.isLoading)return(0,E.jsx)("div",{className:u.default.loadingSpinner,children:(0,E.jsx)(S.default,{color:"highlight",size:44,stroke:6})});if(!this.state.results||0===this.state.results.length)return this._renderRow(v.default.t(460),null);const e=this.state.results.map((e=>(0,o.default)((0,o.default)({},e),{},{id:e.id,itemKey:e.id.toString(),disabled:this.isDisabled(e),selected:this.isSelected(e.id)})));return(0,E.jsx)(g.default,{flatListControllers:[this.flatListController],children:(0,E.jsx)(m.default,{ref:this.setRefList,data:e,flatListController:this.flatListController,direction:"vertical",renderItem:this.renderItem,defaultItemHeight:48})})}_renderRow(e,t){return(0,E.jsxs)("div",{className:u.default.rowMain,children:[(0,E.jsx)("div",{className:u.default.rowCheckbox,children:t}),e]})}_renderSearchBox(){return(0,E.jsx)(C.default,{onSearch:this.setSearchText,placeholder:v.default.t(462)})}_renderFooter(){return this.state&&this.state.selectedCategories?(0,E.jsx)(f.default,{categories:this.state.selectedCategories,onRemoveItem:this._removeById}):null}_showConflictWarning(){p.default.openToast((0,E.jsx)(y.default,{id:(0,y.genId)(),msg:v.default.t(440)}))}isSelected(e){const{selectedCategories:t}=this.state;for(let s=0;s<t.length;s++)if(t[s].id===e)return!0;return!1}isDisabled(e){return!e.not_a_biz&&!this.isSelected(e.id)&&this.state.selectedCategories.length>=c.MAX_BUSINESS_CATEGORIES}_getResults(e){this.setState({isLoading:!0}),this.props.searchCategories(e||d.BUSINESS_CATEGORY_EMPTY_STR_ID).then((t=>{let s=t.categories;""!==e&&(s=s.filter((e=>!e.not_a_biz))),this.setState({isLoading:!1,results:s})})).catch((()=>{p.default.openToast((0,E.jsx)(y.default,{id:(0,y.genId)(),msg:v.default.t(439)})),this.setState({isLoading:!1,results:[]})}))}render(){var e=this;let t;return this.state.selectedCategories.length&&(t=this._renderFooter()),(0,E.jsxs)(x.default,{title:v.default.t(441),isValid:this.state.selectedCategories.length>0,doSave:(0,n.default)((function*(){yield e.props.saveBusinessProfile({categories:e.state.selectedCategories})})),afterSave:this.props.afterSave,onCancel:this.props.onCancel,children:[(0,E.jsx)("div",{className:u.default.searchBackground,children:this._renderSearchBox()}),(0,E.jsxs)("div",{className:u.default.editMain,children:[(0,E.jsx)("div",{className:u.default.list,children:this.renderList()}),t]})]})}}t.default=j,j.displayName="Categories"},50586:(e,t,s)=>{"use strict";var a=s(20862),i=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(s(81109)),o=s(67294),l=i(s(54100)),r=i(s(88743)),d=s(4650),c=i(s(55409)),u=i(s(91952)),h=i(s(25061)),f=i(s(76482)),p=s(78615),m=a(s(14179)),g=i(s(2408)),_=s(31661),v=i(s(23958)),C=i(s(4231)),x=s(47094),S=s(72274),y=i(s(29458)),E=i(s(1458)),j=s(81465),I=s(85893);const M=256,T=512,b=128,P=256;t.default=({businessProfile:e,saveBusinessProfile:t,sessionId:s,verifiedName:a})=>{const[i,L]=(0,o.useState)(),[w,D]=(0,o.useState)(),[O,N]=(0,o.useState)(),[R,k]=(0,o.useState)(),[A,F]=(0,o.useState)(),[B,U]=(0,o.useState)(),[G,H]=(0,o.useState)(),[V,W]=(0,o.useState)(),[z,K]=(0,o.useState)(),[Y,q]=(0,o.useState)(!1),[Z,X]=(0,o.useState)();(0,o.useEffect)((()=>{const t=(0,S.convertRawBusinessProfile)(e);L(t.description),N(t.email),D(t.address),k(t.primaryWebsite),F(t.secondaryWebsite),U(Boolean(t.primaryWebsite&&!t.secondaryWebsite))}),[e]),(0,o.useEffect)((()=>{(0,j.validateEmail)(O)&&H(null)}),[O]),(0,o.useEffect)((()=>{(0,j.validateURL)(R)&&W(null)}),[R]),(0,o.useEffect)((()=>{(0,j.validateURL)(A)&&K(null)}),[A]);const $=()=>{const e=[];return R&&e.push(R),A&&e.push(A),{website:e.map(((e,t)=>{if(!E.default.isHttps(e)&&!E.default.isHttp(e)){const s=`https://${e}`;return 0===t?k(s):F(s),s}return e}))}},J=e=>(0,I.jsx)(m.default,(0,n.default)((0,n.default)({},e),{},{hideEditIcon:Boolean(Z)})),Q=({setValue:a,value:i,fieldKey:o,fieldMetric:l,originalValue:r,textFieldConfig:d,formatForSave:c,validate:u,onError:h,error:f,lowProfile:p,placeholder:m,startActive:g})=>{const v=(null==Z?void 0:Z.fieldKey)===o,C=i?void 0:m;return(0,I.jsx)(y.default,(0,n.default)({value:i,editable:!Z||v,pending:v&&(null==Z?void 0:Z.editType)===x.EditType.PENDING,showRemaining:!0,onBeginEdit:()=>{(0,_.logProfileFieldOpen)(l,e,s),X({fieldKey:o,editType:x.EditType.EDITING})},onChange:a,onSave:()=>{(0,_.logProfileFieldSave)(l,e,s),X({fieldKey:o,editType:x.EditType.PENDING}),t(c()).then((()=>{X()}),(()=>{X()}))},onCancel:()=>{(0,_.logProfileFieldDiscard)(l,e,s),a(r),X()},lockable:!0,lowProfile:p,multiline:!0,inputPlaceholder:C,theme:"text-input",validate:u,onError:h,error:f,a8n:`biz-profile-${o}-input`,fieldName:m,startActive:g},d))},ee=(e,t,s)=>{if(t)return g.default.t(415);switch(e){case d.BUSINESS_HOUR_MODES.SPECIFIC_HOURS:return(0,I.jsx)(I.Fragment,{children:s&&s.map((([e,t],s)=>(0,I.jsxs)("div",{className:f.default.businessHoursTime,children:[e," - ",t]},s)))});case d.BUSINESS_HOUR_MODES.APPOINTMENT_ONLY:return g.default.t(414);case d.BUSINESS_HOUR_MODES.OPEN_24H:return g.default.t(426);default:return null}},te=(0,S.convertRawBusinessProfile)(e);let se,ae=g.default.t(457);return(0,p.canSeeBizProfileV3)()&&(ae=null,se=f.default.noPaddingTop),(0,I.jsxs)(h.default,{title:ae,theme:"refresh",className:se,children:[(e=>{if(!e)return null;const t=(0,p.canSeeBizProfileV3)()?m.IconSectionTheme.NoMargin:void 0;return J({theme:t,icon:"account-box",iconClass:f.default.verifiedNameIcon,content:(0,I.jsxs)("div",{children:[(0,I.jsx)("div",{children:e}),(0,I.jsx)("div",{className:f.default.infoText,children:g.default.t(459)})]})})})(a),J({icon:"business-description",content:Q({value:i,setValue:L,originalValue:te.description,fieldKey:"description",fieldMetric:C.default.BUSINESS_PROFILE_FIELD.DESCRIPTION,placeholder:g.default.t(449),textFieldConfig:{maxLength:T,supportsEmoji:!0},lowProfile:!0,formatForSave:()=>({description:i})})}),J({icon:"business-category",type:"container",emptyText:g.default.t(448),content:(ie=te.categories,0===ie.length?null:(0,I.jsx)("div",{children:ie.map((e=>e.localized_display_name)).join(g.default.t(815))})),fieldName:g.default.t(448),onEdit:()=>{(0,_.logProfileFieldOpen)(C.default.BUSINESS_PROFILE_FIELD.CATEGORY,e,s),u.default.openModal((0,I.jsx)(c.default,{initialCategories:te.categories,saveBusinessProfile:t,searchCategories:e=>l.default.find(e),afterSave:()=>(0,_.logProfileFieldSave)(C.default.BUSINESS_PROFILE_FIELD.CATEGORY,e,s),onCancel:()=>{(0,_.logProfileFieldDiscard)(C.default.BUSINESS_PROFILE_FIELD.CATEGORY,e,s)}}))}}),J({icon:"business-address",content:(e=>{const t=Q({value:w,placeholder:g.default.t(446),setValue:D,originalValue:e.address,fieldKey:"address",fieldMetric:C.default.BUSINESS_PROFILE_FIELD.ADDRESS,textFieldConfig:{maxLength:P},lowProfile:!0,formatForSave:()=>({address:w})}),{latitude:s,longitude:a}=e;let i;return null!=s&&null!=a&&(i=((e,t)=>{let s;return"address"===(null==Z?void 0:Z.fieldKey)&&(s=(0,I.jsx)("div",{className:f.default.mapOverlay,children:(0,I.jsx)("div",{className:f.default.overlayHint,children:g.default.t(452)})})),(0,I.jsxs)("div",{style:{height:100},className:f.default.businessMap,children:[s,(0,I.jsx)(v.default,{lat:e,lng:t,name:w,width:312,height:96})]})})(s,a)),(0,I.jsxs)(I.Fragment,{children:[t,i]})})(te)}),J({icon:"business-hours",type:"container",emptyText:g.default.t(447),content:(({mode:e,days:t})=>null==e?null:(0,I.jsx)("div",{children:t.map((({dayName:t,dayKey:s,closed:a,hours:i})=>(0,I.jsxs)("div",{className:f.default.businessHoursSection,children:[(0,I.jsx)("div",{className:f.default.businessHoursDayColumn,children:t}),(0,I.jsx)("div",{className:f.default.businessHoursTimeColumn,children:ee(e,a,i)})]},s)))}))(te.hours),fieldName:g.default.t(447),onEdit:()=>{(0,_.logProfileFieldOpen)(C.default.BUSINESS_PROFILE_FIELD.HOURS,e,s),u.default.openModal((0,I.jsx)(r.default,{businessHours:te.hours,saveBusinessProfile:t,onCancel:()=>{(0,_.logProfileFieldDiscard)(C.default.BUSINESS_PROFILE_FIELD.HOURS,e,s)},afterSave:()=>(0,_.logProfileFieldSave)(C.default.BUSINESS_PROFILE_FIELD.HOURS,e,s)}))}}),J({icon:"business-email",content:Q({value:O,placeholder:g.default.t(450),originalValue:te.email,setValue:N,fieldKey:"email",fieldMetric:C.default.BUSINESS_PROFILE_FIELD.EMAIL,textFieldConfig:{maxLength:b},error:G,lowProfile:!1,formatForSave:()=>({email:O}),validate:e=>(0,j.validateEmail)(e),onError:()=>{H(g.default.t(881))}})}),(e=>{const t=Q({value:R,placeholder:g.default.t(458),originalValue:e.primaryWebsite,setValue:k,fieldKey:"primaryWebsite",fieldMetric:C.default.BUSINESS_PROFILE_FIELD.WEBSITE,textFieldConfig:{maxLength:M},formatForSave:$,lowProfile:!1,validate:j.validateURL,onError:()=>{W(g.default.t(889))},error:V});return J({icon:"business-website",theme:m.IconSectionTheme.SmallMargin,content:(0,I.jsx)("div",{children:t})})})(te),(e=>{if(!e.primaryWebsite)return null;if(A||!B){const t=Q({placeholder:g.default.t(458),value:A,originalValue:e.secondaryWebsite,setValue:F,fieldKey:"secondaryWebsite",fieldMetric:C.default.BUSINESS_PROFILE_FIELD.WEBSITE,textFieldConfig:{maxLength:M},formatForSave:$,lowProfile:!1,validate:j.validateURL,onError:()=>{K(g.default.t(889))},error:z,startActive:Y});return J({icon:"business-website",theme:m.IconSectionTheme.NoMargin,content:(0,I.jsx)("div",{children:t})})}{const e=(0,I.jsx)("button",{className:f.default.addAnotherWebsite,onClick:()=>{U(!1),q(!0)},children:g.default.t(445)});return J({theme:m.IconSectionTheme.NoMargin,content:(0,I.jsx)("div",{children:e})})}})(te)]});var ie}},80223:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){const[e,t]=(0,n.useState)(_.LoadType.PENDING),[s,a]=(0,n.useState)(),o=(0,n.useRef)(Math.floor(2147483648*Math.random()).toString()),p=function(){var e=(0,i.default)((function*(){t(_.LoadType.PENDING);try{const e=yield y();a(e),t(_.LoadType.DONE),(0,g.logProfileOpen)(e,o.current)}catch(e){t(_.LoadType.ERROR)}}));return function(){return e.apply(this,arguments)}}();if((0,n.useEffect)((()=>{p()}),[]),e===_.LoadType.PENDING)return(0,x.jsx)("div",{className:h.default.loadingSpinner,children:(0,x.jsx)(v.default,{color:"default",size:24,stroke:6})});if(e===_.LoadType.ERROR)return(0,x.jsx)(c.default,{title:m.default.t(457),theme:"refresh",children:(0,x.jsxs)(f.FlexRow,{align:"center",justify:"center",children:[(0,x.jsx)(f.FlexItem,{children:m.default.t(455)}),(0,x.jsx)(f.FlexItem,{xstyle:S.retryButton,children:(0,x.jsx)(r.default,{onClick:()=>{p()},type:"simplified",children:m.default.t(1553)})})]})});if(e===_.LoadType.DONE&&s)return(0,x.jsx)(u.default,{verifiedName:d.default.pushname||void 0,sessionId:o.current,businessProfile:s,saveBusinessProfile:function(){var e=(0,i.default)((function*(e){try{yield(0,l.editBusinessProfile)(e)}catch(e){throw(0,C.showError)(m.default.t(456)),__LOG__(3,void 0,void 0,!0)`business_profile:edit_form save failed`,SEND_LOGS(`businessProfile edit handled server error - ${e.status}`),e}try{const e=yield E();return a(e),e}catch(e){throw(0,C.showError)(m.default.t(455)),e}}));return function(){return e.apply(this,arguments)}}()});return null};var i=a(s(48926)),n=s(67294),o=(a(s(56720)),a(s(8581))),l=s(85148),r=a(s(69991)),d=a(s(9322)),c=a(s(25061)),u=a(s(50586)),h=a(s(62389)),f=s(63290),p=s(86723),m=a(s(2408)),g=s(31661),_=s(47094),v=a(s(46714)),C=s(59641),x=s(85893);const S={retryButton:{height:"epwkujcx",marginStart:"nzcjdldu"}},y=function(){var e=(0,i.default)((function*(){const e=(0,p.getMeUser)(),t=o.default.get(e);t&&t.markStale();return(yield o.default.find(e)).serialize()}));return function(){return e.apply(this,arguments)}}(),E=function(){var e=(0,i.default)((function*(){const e=(0,p.getMeUser)(),t=yield o.default.update(e);return(Array.isArray(t)?t[0]:t).serialize()}));return function(){return e.apply(this,arguments)}}()},31661:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.getProfilePopulatedFields=o,t.logProfileOpen=function(e,t){const s=new n.default.EditBusinessProfile((0,i.default)({editProfileAction:n.default.EDIT_PROFILE_ACTION.ACTION_OPEN,businessProfileEntryPoint:n.default.BUSINESS_PROFILE_ENTRY_POINT.SETTINGS,editBusinessProfileSessionId:t},o(e)));s&&s.commit()},t.logProfileFieldOpen=function(e,t,s){const a=new n.default.EditBusinessProfile((0,i.default)({editProfileAction:n.default.EDIT_PROFILE_ACTION.ACTION_PROFILE_FIELD_OPEN,businessProfileEntryPoint:n.default.BUSINESS_PROFILE_ENTRY_POINT.SETTINGS,editProfileActionField:e,editBusinessProfileSessionId:s},o(t)));a&&a.commit()},t.logProfileFieldSave=function(e,t,s){const a=new n.default.EditBusinessProfile((0,i.default)({editProfileAction:n.default.EDIT_PROFILE_ACTION.ACTION_PROFILE_FIELD_SAVE,businessProfileEntryPoint:n.default.BUSINESS_PROFILE_ENTRY_POINT.SETTINGS,editProfileActionField:e,editBusinessProfileSessionId:s},o(t)));a&&a.commit()},t.logProfileFieldDiscard=function(e,t,s){const a=new n.default.EditBusinessProfile((0,i.default)({editProfileAction:n.default.EDIT_PROFILE_ACTION.ACTION_PROFILE_FIELD_DISCARD,businessProfileEntryPoint:n.default.BUSINESS_PROFILE_ENTRY_POINT.SETTINGS,editProfileActionField:e,editBusinessProfileSessionId:s},o(t)));a&&a.commit()};var i=a(s(81109)),n=a(s(4231));function o(e){var t;return{hasDescription:null!=e.description,hasCategory:!!(e.categories&&e.categories.length>0),hasHours:null!=(null===(t=e.businessHours)||void 0===t?void 0:t.config),hasEmail:null!=e.email,hasAddress:null!=e.address,hasWebsite:null!=e.website}}},72274:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.convertRawBusinessProfile=void 0;var a=s(71547);t.convertRawBusinessProfile=e=>{const{description:t,email:s,address:i,website:n,categories:o,businessHours:l,latitude:r,longitude:d}=e,[c,u]=n||[];return{description:t,email:s,address:i,primaryWebsite:c,secondaryWebsite:u,hours:(0,a.getBusinessHoursForEdit)(l),categories:o||[],latitude:r,longitude:d}}},59641:(e,t,s)=>{"use strict";var a=s(20862),i=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.showError=void 0;var n=i(s(91952)),o=a(s(49201)),l=s(85893);t.showError=e=>{n.default.openToast((0,l.jsx)(o.default,{msg:e,duration:6e3,id:(0,o.genId)()}))}},48720:(e,t,s)=>{"use strict";var a=s(20862),i=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.CartDetailDrawer=void 0;var n=i(s(48926)),o=s(72379),l=s(55084),r=s(67294),d=i(s(76610)),c=i(s(8581)),u=s(47874),h=i(s(69991)),f=i(s(25523)),p=i(s(19453)),m=i(s(12756)),g=i(s(26004)),_=i(s(91952)),v=i(s(75940)),C=i(s(55454)),x=a(s(61447)),S=i(s(17747)),y=i(s(9042)),E=i(s(79864)),j=a(s(55588)),I=a(s(13540)),M=i(s(67893)),T=i(s(52715)),b=i(s(2408)),P=i(s(71681)),L=s(1236),w=s(20232),D=i(s(30833)),O=i(s(84658)),N=s(70790),R=i(s(40630)),k=i(s(32973)),A=i(s(3132)),F=i(s(88253)),B=i(s(33764)),U=i(s(2966)),G=s(97504),H=i(s(75878)),V=i(s(82669)),W=s(85893);class z extends r.Component{constructor(e){var t;super(e),t=this,this._cartFlatListController=new M.default,this.updateData=function(){var e=(0,n.default)((function*(e){const[s,a]=yield Promise.all([e?(0,k.default)(t.state.cart):Promise.resolve(),c.default.find(t.props.chat.id)]);s&&(t.refreshedCart=s);const i=(0,D.default)(t.state.cart,t.refreshedCart);t.setState({businessProfile:a,cartProductItems:i,isLoading:!1})}));return function(){return e.apply(this,arguments)}}(),this.handleSend=()=>{const{cart:e}=this.state;this.setState({isLoading:!0}),(0,B.default)(e,this.props.chat).then((t=>{const s=Boolean(e.message);(0,L.logSendOrderMessage)({orderId:t,catalogOwnerJid:e.id,catalogContext:(0,N.getProductCatalogContext)(this.context),isOrderMsgAttached:s,quantity:e.itemCount}),this.props.onBack(),(0,g.default)(e),e.message=void 0,this.props.closeDrawerRightOnSend&&this._closeDrawerRight()})).catch((()=>{__LOG__(4,!0,new Error,!0)`Unable to create catalog order`,SEND_LOGS("submitOrder: order creation or order message send error"),(0,F.default)(),this.updateData(!0)})).finally((()=>{this.setState({isLoading:!1})}))},this.handleChange=e=>{const{cart:t}=this.state;this.setState({cartMessage:e},(()=>{(0,H.default)(t,e)}))},this._setRefMessageInput=e=>{this._refMessageInput=e},this.handleMaxPasteExceeded=()=>{_.default.openModal((0,W.jsx)(v.default,{title:b.default.t(491),onOK:()=>{_.default.closeModal()},okText:b.default.t(2085),children:b.default.t(490)}))},this.updateDataQueue=new o.PromiseQueue;const s=f.default.findCart(this.props.sellerJid);this.state={isLoading:!0,businessProfile:void 0,cartProductItems:[],cartMessage:s.message,cart:s}}_closeDrawerRight(){_.default.existsDrawerRight((e=>{e&&_.default.closeDrawerRight()}))}componentDidMount(){const{cart:e}=this.state,{listeners:t,rejectOnUnmount:s}=this.props;t.add(e,"change:cartItemCollection",(()=>{this.updateDataQueue.enqueue((()=>this.updateData()))})),this.updateData(!0).checkpoint(s()).then((()=>{(0,w.logCartListImpression)(e.id.toString(),(0,N.getProductCatalogContext)(this.context))})).catch((0,l.filteredCatch)(I.Unmount,(()=>{}))).catch((()=>{__LOG__(4,!0,new Error,!0)`Unable to open the cart`,SEND_LOGS("openCart: failed to open the cart"),(0,F.default)(),(0,g.default)(e)})).finally((()=>{this.setState({isLoading:!1})}))}_emptyCartContent(){return(0,W.jsxs)("div",{className:p.default.emptyCartContainer,children:[(0,W.jsx)(U.default,{name:"shopping-cart-empty"}),(0,W.jsx)(G.TextDiv,{className:p.default.emptyCardHeader,theme:"large",children:b.default.t(483)}),(0,W.jsx)(G.TextDiv,{className:p.default.emptyCardText,theme:"plain",children:b.default.t(484)}),(0,u.hasCatalog)(this.state.businessProfile)&&(0,W.jsx)(h.default,{onClick:this.props.onProductCatalog,type:"primary",children:b.default.t(1465)})]})}_getDrawerContent(){const{chat:e,sellerJid:t}=this.props,{cart:s}=this.state;if(this.state.isLoading)return(0,W.jsx)(T.default,{});const a=s.itemCount,i=a>0;let n,o;if(i){const e=b.default.t(1092,{count:a,_plural:a});n=(0,W.jsx)(G.TextDiv,{theme:"title",children:e})}null!=s.total&&null!=s.currency?o=(0,W.jsx)(G.TextDiv,{theme:"muted-small",children:b.default.t(1426,{subtotal:x.formatAmount1000(s.currency,s.total)})}):a>0&&(o=(0,W.jsx)(G.TextDiv,{theme:"muted-small",children:b.default.t(1422)}));const l=(0,W.jsx)(V.default,{transitionName:"media-caption",className:p.default.cartMessage,children:(0,W.jsx)(O.default,{ref:this._setRefMessageInput,chat:e,maxLength:C.default.MAX_CART_MESSAGE_LENGTH,multiline:!0,onEnter:this.handleSend,onChange:this.handleChange,onMaxPasteExceeded:this.handleMaxPasteExceeded,placeholder:b.default.t(489),showRemaining:!0,spellCheck:!0,supportsEmoji:!0,value:this.state.cartMessage})}),r=(0,W.jsx)("button",{"data-a8n":d.default.key("cart-send-button"),className:p.default.btnSend,tabIndex:"-1",onClick:this.handleSend,title:b.default.t(494),children:(0,W.jsx)(A.default,{large:!0,children:(0,W.jsx)(U.default,{name:"send",directional:!0})})});return(0,W.jsxs)(W.Fragment,{children:[!i&&this._emptyCartContent(),(0,W.jsxs)("div",{className:p.default.info,children:[n,o]}),(0,W.jsx)(m.default,{flatListController:this._cartFlatListController,onProductDetail:this.props.onProductDetail,cart:s,sellerJid:t,cartProductItems:this.state.cartProductItems}),i&&(0,W.jsxs)("div",{className:p.default.footer,children:[l,(0,W.jsx)(V.default,{transitionAppear:!0,transitionName:"btn",children:r})]})]})}render(){const{onBack:e}=this.props;return(0,W.jsxs)(S.default,{onDrop:e,theme:"striped",children:[(0,W.jsx)(j.default,{title:b.default.t(482),type:j.DRAWER_HEADER_TYPE.SMALL,onBack:e}),(0,W.jsx)(y.default,{flatListControllers:[this._cartFlatListController],children:this._getDrawerContent()})]})}}t.CartDetailDrawer=z,z.contextType=E.default,z.displayName="CartDetailDrawer";var K=(0,R.default)((0,P.default)(z));t.default=K},12756:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{cartProductItems:t,onProductDetail:s,sellerJid:a}=e;return(0,d.jsx)(r.default,{flatListControllers:[e.flatListController],children:(0,d.jsx)(l.default,{flatListController:e.flatListController,direction:"vertical",forceConsistentRenderCount:!1,data:t.map((e=>({itemKey:e.cartItem.id,contentKey:(0,i.default)("cartItem"),product:e.product,cartItem:e.cartItem}))),renderItem:e=>{const t={productId:e.cartItem.id,businessOwnerJid:a};return(0,d.jsx)(n.default,{cartId:a,product:e.product,quantity:e.cartItem.quantity,onClick:()=>s(t)})},defaultItemHeight:o.default.PRODUCT_LIST_ITEM_HEIGHT})})};var i=a(s(73955)),n=a(s(31355)),o=a(s(55454)),l=a(s(86025)),r=a(s(19257)),d=s(85893)},31355:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t;const{product:s,onClick:a}=e,v=(0,_.jsx)(c.default,{text:s.name,ellipsify:!0,titlify:!0}),C=null===(t=s.getPreviewImage())||void 0===t?void 0:t.mediaData;let x;x=C?(0,_.jsx)(m.default,{theme:"list",mediaData:C}):(0,_.jsx)(_.Fragment,{});const S=(0,_.jsx)(p.default,{className:i.default.price,product:s,fallback:u.default.t(485)});return(0,_.jsx)(o.default,{image:x,customImage:!0,primary:v,secondary:S,theme:"cart-product",onClick:a,detail:(0,_.jsx)(d.default.Consumer,{children:t=>(0,_.jsxs)("div",{className:i.default.actions,children:[(0,_.jsx)(n.default,{quantity:e.quantity,onChange:s=>function(t,s){const{cartId:a,product:i}=e;(0,g.default)(a,i,t),(0,h.logEditProduct)(i,s,t)}(s,(0,f.getProductCatalogContext)(t))}),(0,_.jsx)("div",{className:i.default.deleteIcon,children:(0,_.jsx)(l.default,{onClick:s=>function(t,s){const{cartId:a,product:i}=e,n=(0,r.default)(a,i.id.toString());(0,r.default)(a,i.id.toString()),(0,h.logDeleteProduct)(i,s),0===n&&(0,h.logCartAbandon)(i.catalogWid.toString(),s),function(e){e.preventDefault(),e.stopPropagation()}(t)}(s,(0,f.getProductCatalogContext)(t))})})]})}),className:i.default.cartListItem},s.id.toString())};var i=a(s(65324)),n=a(s(84054)),o=a(s(55092)),l=a(s(6235)),r=a(s(97783)),d=a(s(79864)),c=a(s(85051)),u=a(s(2408)),h=s(20232),f=s(70790),p=a(s(22986)),m=a(s(84241)),g=a(s(48133)),_=s(85893)},84054:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,o.jsx)("div",{className:n.default.select,children:(0,o.jsx)("select",{onClick:function(e){e.preventDefault(),e.stopPropagation()},value:e.quantity,onChange:function(t){const s=t.target;s instanceof HTMLSelectElement&&e.onChange(parseInt(s.value,10))},children:function(){const e=[];for(let t=1;t<=i.MAX_QUANTITY;t++)e.push((0,o.jsx)("option",{value:t,children:t},t));return e}()})})};var i=s(53685),n=a(s(5323)),o=s(85893)},6235:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,l.jsx)(o.default,{"aria-label":n.default.t(1490),name:"delete",title:n.default.t(1490),className:i.default.deleteIcon,onClick:e.onClick})};var i=a(s(33776)),n=a(s(2408)),o=a(s(40858)),l=s(85893)},62069:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(s(76610)),n=a(s(55092)),o=a(s(25142)),l=a(s(8959)),r=s(85893);t.default=({title:e,icon:t,t:s})=>{const a=null!=s?o.default.relativeDateAndTimeStr(s):"-",d=(0,r.jsxs)("div",{className:l.default.title,"data-a8n":i.default.key("msg-info-title"),children:[t,e]});return(0,r.jsx)(n.default,{primary:d,secondary:a,theme:"plain",idle:!0})}},95005:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const t=(0,r.default)(e.msg,["numTimesForwarded","isFrequentlyForwarded"]),{numTimesForwarded:s,isFrequentlyForwarded:a}=t;if(s<=0||a)return null;const c=(0,d.jsx)(o.default,{name:"forwarded",display:"inline",className:n.default.icon}),u=i.default.t(912,{count:s,_plural:s});return(0,d.jsxs)("div",{className:n.default.title,children:[c,(0,d.jsx)(l.TextSpan,{theme:"title",className:n.default.text,children:u})]})};var i=a(s(2408)),n=a(s(78749)),o=a(s(2966)),l=s(97504),r=a(s(76006)),d=s(85893)},13531:(e,t,s)=>{"use strict";var a=s(20862),i=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=s(67294),o=i(s(53407)),l=a(s(75381)),r=i(s(84758)),d=i(s(55454)),c=a(s(70521)),u=i(s(15308)),h=a(s(86025)),f=i(s(39e3)),p=i(s(2408)),m=i(s(37314)),g=i(s(16967)),_=i(s(79939)),v=s(85893);function C(e,t){const{onFocusSearch:s,onClick:a,showPersonGroupDivisionHeader:i}=e,C=(0,n.useRef)(null),x=(0,_.default)((()=>new g.default([],(e=>e.id.toString())))),S=()=>{x.current.setFirst(!0)};(0,n.useImperativeHandle)(t,(()=>({focusFirst:S})));const y=(e,t)=>{const s=(t?c.FREQUENT_PREFIX:"")+e.id.toString();if(e.isGroup){const a=r.default.get(e.id);return a?{itemKey:s,data:a,type:3,frequent:t}:null}return{itemKey:s,data:e,type:2,frequent:t}},E=e=>{if(0===e.length)return[];const t=e[0].isGroup?"group":"contact",s=[],a=e.length>10;let i="XXX";for(let n=0;n<e.length;n++){const o=e[n];if(a&&o.header){const a=o.header;if(a!==i){const o=n<e.length-1&&a!==e[n+1].header;s.push({itemKey:`header-${t}-${a}`,data:a,separator:o,type:1}),i=a}}const l=y(o);l&&s.push(l)}return s};return x.current.init((()=>{const{contacts:t,frequentContacts:s}=e,a=[],i=[];return t.forEach((e=>{if(e.isGroup){const t=r.default.get(e.id);t&&i.push(t)}else a.push(e)})),(s||[]).concat(a).concat(i)})()),(0,v.jsx)(f.default,{onRef:e=>{C.current=e},handlers:{down:e=>{e.preventDefault(),e.stopPropagation(),x.current.setNext(!0)},up:e=>{e.preventDefault(),e.stopPropagation();const t=x.current;t.prev()>-1?t.setPrev(!0):(t.unset(),s(e))}},onFocus:e=>{if(e.target!==C.current)return;const t=x.current;t.index<0?S():t.reset(!0)},"data-tab":d.default.TAB_ORDERS.CHAT_CONTACT_LIST,"data-testid":"contact-list-key",children:(0,v.jsx)(h.default,{data:(()=>{const{frequentContacts:t}=e,s=[],a=[],n=[];t&&t.length&&(s.push({itemKey:"frequent-contacts-header",type:0}),s.push(...(e=>{const t=[];return e.forEach((e=>{const s=y(e,!0);s&&t.push(s)})),t})(t))),e.contacts.forEach((e=>{e.isGroup?n.push(e):a.push(e)}));const o=E(a),l=E(n);if(i&&o.length>0){const e=p.default.t(1930);s.push({itemKey:`header-${e}`,data:e,separator:!0,type:1})}if(s.push(...o),i&&l.length>0){const e=p.default.t(2038);s.push({itemKey:`header-${e}`,data:e,separator:!0,type:1})}return s.push(...l),s})(),renderItem:function(e){switch(e.type){case 0:return(0,v.jsx)(m.default,{header:p.default.t(1959)},"frequent-contacts-header");case 3:const{data:t,frequent:s}=e;return((e,t)=>(0,v.jsx)(l.default,{active:x.current,chat:e,mode:l.Mode.INFO,noContext:!0,onClick:a,frequent:t}))(t,s);case 2:const{data:i,frequent:n}=e;return((e,t)=>{let s;return e.isBlocked()&&(s=p.default.t(718)),(0,v.jsx)(c.default,{active:x.current,contact:e,onClick:a,secondary:s,frequent:t,waitIdle:!0})})(i,n);case 1:const{data:r,separator:d}=e;return(0,v.jsxs)("div",{className:u.default.header,children:[d?(0,v.jsx)(o.default,{},`separator-${r}`):null,(0,v.jsx)(m.default,{header:r})]});default:throw new h.UnknownDataError(e)}},flatListController:e.flatListController,direction:"vertical"})})}var x=(0,n.forwardRef)(C);t.default=x},4337:(e,t,s)=>{"use strict";var a=s(20862),i=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(s(35161)),o=s(67294),l=a(s(70521)),r=i(s(39e3)),d=i(s(2408)),c=i(s(16967)),u=s(85893);class h extends o.PureComponent{constructor(e){super(e),this.focusLast=()=>{this.props.contacts&&this.props.contacts.length&&this.selection.setLast(!0)},this._focusPrev=e=>{e.preventDefault(),e.stopPropagation();this.selection.prev()>-1&&this.selection.setPrev(!0)},this._focusNext=e=>{e.preventDefault(),e.stopPropagation();const{onFocusSearch:t}=this.props,s=this.selection.next();this.selection.index===s?(this.selection.unset(),t&&t(e)):this.selection.setNext(!0)},this._deleteContact=e=>{e.preventDefault(),e.stopPropagation();const{onDelete:t}=this.props,s=this.selection.getVal();if(s){const a=this.props.contacts.find(s);a&&t&&t(e,a)}},this.onParticipantClick=(e,t)=>{this.selection.setVal(t)},this.selection=new c.default(e.contacts,(e=>e.id))}componentDidUpdate(){this.selection.init(this.props.contacts,!0)}render(){const e=this.props.contacts;if(!e)return null;const t=e.length?(0,n.default)(e,(e=>(0,u.jsx)(l.default,{contact:e,active:this.selection,onDelete:this.props.onDelete,onClick:this.onParticipantClick,type:l.Type.SMALL,theme:this.props.theme,waitIdle:!0},e.id.toString()))):null,s={up:this._focusPrev,down:this._focusNext};this.props.onDelete&&(s[d.default.LR("left","right")]=this._focusPrev,s[d.default.LR("right","left")]=this._focusNext,s.backspace=this._deleteContact);const a=(0,u.jsx)("ul",{children:t});return(0,u.jsx)(r.default,{handlers:s,children:a})}}t.default=h,h.displayName="ParticipantList"},12064:(e,t,s)=>{"use strict";var a=s(20862),i=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{ids:t,size:s,onClick:a,showCount:i,square:d,border:c}=e,u=t.length;if(0===u)return null;if(1===u)return(0,r.jsx)(l.default,{id:t[0],size:40,onClick:a,border:c});const h=t.slice(0,4).map(((e,t)=>(0,r.jsx)("div",{className:(0,n.default)(o.default.avatar,{[o.default.first]:0===t,[o.default.second]:1===t,[o.default.third]:2===t,[o.default.fourth]:3===t}),children:(0,r.jsx)(l.default,{id:e,size:s,square:!0})},`avatar-combo-image-${t}`))),f=(0,n.default)(o.default.container,{[o.default.square]:d,[o.default.border]:c},{[o.default.two]:2===u,[o.default.three]:3===u,[o.default.four]:u>=4}),p=(0,l.getSize)(s),m={height:p,width:p,cursor:a?"pointer":void 0},g=i?(0,r.jsx)("div",{className:o.default.count,style:m,children:t.length}):null;return(0,r.jsxs)("div",{className:f,style:m,onClick:a,children:[h,g]})};var n=i(s(94184)),o=i(s(72084)),l=a(s(88419)),r=s(85893)},78899:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,o.jsxs)("div",{className:n.default.overlay,children:[(0,o.jsx)("div",{className:n.default.icon,children:e.icon}),(0,o.jsx)("div",{"data-a8n":i.default.key("avatar-text"),className:n.default.text,children:e.text})]},"avatar-overlay")};var i=a(s(76610)),n=a(s(79169)),o=s(85893)},70775:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{onClick:t,label:s,prefixIcon:a,postfixIcon:c,xstyle:u}=e,h="padded-svg"===e.iconTheme,f=[d.iconSvg,h&&d.paddedSvg],p={width:h?20:16,height:h?20:16};return(0,r.jsxs)(l.default,{xstyle:[d.container,null!=a&&d.hasPrefixIcon,null!=c&&d.hasPostfixIcon,u],onClick:t,"aria-label":e["aria-label"],children:[a&&(0,r.jsx)(o.default,(0,i.default)({name:a,xstyle:[d.icon,d.prefixIcon],iconXstyle:f},p)),(0,r.jsx)("div",{className:(0,n.default)(d.content),children:s}),c&&(0,r.jsx)(o.default,(0,i.default)({name:c,xstyle:d.icon,iconXstyle:f},p))]})};var i=a(s(81109)),n=a(s(56720)),o=a(s(2966)),l=a(s(89135)),r=s(85893);const d={container:{position:"g0rxnol2",paddingTop:"fbgy3m38",paddingEnd:"btzf6ewn",paddingBottom:"oq31bsqd",paddingStart:"nqtxkp62",color:"nuiuantz",backgroundColor:"jvy3y6qh",borderTopStartRadius:"g130k69c",borderTopEndRadius:"k1a7joe8",borderBottomEndRadius:"dc5qina8",borderBottomStartRadius:"kfr1vweg"},hasPrefixIcon:{paddingStart:"fif0zr45"},hasPostfixIcon:{paddingEnd:"ig3h26t1"},content:{display:"l7jjieqr"},icon:{display:"l7jjieqr",marginTop:"tt8xd2xn",marginEnd:"jnwc1y2a",marginBottom:"mpdn4nr2",marginStart:"p3lsiedt",position:"lhggkp7q",right:"rsmgdaqi",top:"mvf5n2qr"},iconSvg:{color:"nuiuantz",paddingTop:"eujn52yf",paddingEnd:"jfqm35v0",paddingBottom:"ckm995li",paddingStart:"bdbt56hn"},prefixIcon:{left:"lidbxt4q"},paddedSvg:{paddingTop:"qbqilfqo",paddingEnd:"iqx13udk",paddingBottom:"a15vwmim",paddingStart:"qiohso4h"}}},5481:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function({children:e,download:t,file:s,extension:a}){return(0,o.jsx)(n.default,{xstyle:l.button,onClick:()=>{null!=s&&i.default.downloadData(s,t,a)},children:e})};a(s(56720));var i=a(s(97227)),n=a(s(89135)),o=s(85893);const l={button:{display:"f804f6gw"}}},51402:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const t=(0,a.useRef)(null),s=(0,a.useRef)(!1);return(0,a.useEffect)((()=>{if(null==e)return;function a(e){const s=t.current;return!!s&&(e instanceof Node&&!s.contains(e))}function i(e){if(e.isPrimary){const t=a(e.target);s.current=t}}function n(e){"touch"!==e.pointerType&&"pen"!==e.pointerType||(s.current=!1)}function o(t){const i=a(t.target);s.current&&i&&t.isPrimary&&e(t),s.current=!1}function l(t){a(t.target)&&e(t)}const r="PointerEvent"in window;return r?(document.addEventListener("pointerdown",i),document.addEventListener("pointermove",n),document.addEventListener("pointerup",o)):document.addEventListener("click",l),()=>{r?(document.removeEventListener("pointerdown",i),document.removeEventListener("pointermove",n),document.removeEventListener("pointerup",o)):document.removeEventListener("click",l)}}),[e]),t};var a=s(67294)},24516:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(s(35161)),n=a(s(94184)),o=a(s(7900)),l=s(67294),r=a(s(55454)),d=s(73554),c=a(s(40854)),u=a(s(47193)),h=a(s(39e3)),f=a(s(58780)),p=a(s(2408)),m=a(s(47822)),g=a(s(16967)),_=a(s(46714)),v=a(s(69217)),C=a(s(89135)),x=s(85893);class S extends l.PureComponent{constructor(...e){super(...e),this.state={},this._setRefBody=e=>{this._refBody=e},this._refImages=new Map,this.setRefImage=(e,t)=>{t?this._refImages.set(e,t):this._refImages.delete(e)},this._setImageRefCache=new m.default(this.setRefImage),this.selection=new g.default(this.props.thumbnails,(e=>e.id)),this._handleHotKeysRef=e=>{this._refHotKeys=e},this.handleMouseDown=e=>{e.preventDefault(),e.stopPropagation()},this.handleClick=e=>{const t=e.target;this.props.onImageClick&&1===t.nodeType&&"IMG"===t.tagName&&this.props.onImageClick(t.src)},this.handleEnter=()=>{const e=this.selection.getVal();e||(__LOG__(4,void 0,new Error,!0)`Assertion failed!`,SEND_LOGS("No value selected, but enter clicked")),this.props.onImageClick&&e&&this.props.onImageClick(e.thumbUrl)},this._requestMoreImagesIfNeeded=()=>{if(!this.props.isLoadingMore&&this.props.canLoadMore&&this.props.onRequestMoreImages){if(!this._refBody)throw new Error("Requesting more images when body not rendered");this._refBody.scrollTop+r.default.SCROLL_FUDGE>this._refBody.scrollHeight-this._refBody.clientHeight&&this.props.onRequestMoreImages()}},this.handleScroll=this.props.throttle(this._requestMoreImagesIfNeeded,100),this._selectPrev=e=>{e.preventDefault(),e.stopPropagation(),this.selection.setPrev(!1),this._updateSelected(!0,!0)},this.selectNext=e=>{e.preventDefault(),e.stopPropagation(),this.selection.setNext(!1),this._updateSelected(!0,!0)},this._selectPrevRow=e=>{if(e.preventDefault(),e.stopPropagation(),0===this.selection.index&&this.props.onFocusPrev)this.props.onFocusPrev();else{const e=Math.max(this.selection.index-3,0);this.selection.set(e,!1,!1),this._updateSelected(!0,!0)}},this._selectNextRow=e=>{e.preventDefault(),e.stopPropagation(),this.selection.set(this.selection.index+3,!1,!1),this._updateSelected(!0,!0)},this._handleFocus=e=>{e.stopPropagation(),e.preventDefault(),(null==this.selection.index||this.selection.index<0)&&this.selection.setFirst(!1),this._updateSelected(!0,!1);const t=(0,o.default)(this._refImages.get(`${this.selection.index}`),"this._refImages.get(`${this.selection.index}`)").getElementsByClassName(f.default.imageGalleryItemOverlay);if(1!==t.length)throw new Error(`Unexpected number of overlay elements ${t.length}`);c.default.maybeIndicateFocus(t[0],f.default.focusAnimation)},this.handleRequestDismiss=()=>{this.selection.unset(),this.setState({selectedImage:void 0})}}componentDidMount(){this._updateSelected()}componentDidUpdate(){this._requestMoreImagesIfNeeded(),this.selection.init(this.props.thumbnails,!1),this._updateSelected()}focus(){this._refHotKeys&&this._refHotKeys.focus()}_updateSelected(e=!1,t=!1){const s=this.selection.getVal();if(s&&this.state.selectedImage!==s&&(this.setState({selectedImage:s}),this.selection.index>-1)){const e=this._refImages.get(`${this.selection.index}`);u.default.focus(e),t&&e&&(0,d.scrollIntoViewIfNeeded)(e,!1)}}render(){const e={down:this._selectNextRow,enter:this.handleEnter,left:this._selectPrev,right:this.selectNext,up:this._selectPrevRow},t=(0,i.default)(this.props.thumbnails,(({id:e,name:t,thumbUrl:s},a)=>{const i=!!this.state.selectedImage&&this.state.selectedImage.id===e,o=(0,n.default)(f.default.imageGalleryItem,{[f.default.selected]:i}),l=(0,x.jsx)("div",{className:f.default.imageGalleryItemOverlay});return(0,x.jsxs)("div",{ref:this._setImageRefCache.getRefSetter(`${a}`),className:o,tabIndex:-1,children:[l,(0,x.jsx)(C.default,{onClick:this.handleClick,children:(0,x.jsx)("img",{alt:p.default.t(42,{name:t}),className:f.default.imageGalleryItemImage,src:s})})]},e)})),s=this.props.isLoadingMore?(0,x.jsx)("div",{tabIndex:-1,className:f.default.imageGalleryFooter,children:(0,x.jsx)(_.default,{stroke:6,size:24})}):null;return(0,x.jsx)(h.default,{className:f.default.imageGallery,"data-tab":r.default.TAB_ORDERS.CHAT_IMAGE_GALLERY,handlers:e,onFocus:this._handleFocus,onMouseDown:this.handleMouseDown,onRef:this._handleHotKeysRef,children:(0,x.jsxs)("div",{ref:this._setRefBody,className:f.default.imageGalleryList,onScroll:this.handleScroll,children:[t,(0,x.jsx)("div",{tabIndex:-1,className:f.default.imageGalleryItemSpacer}),(0,x.jsx)("div",{tabIndex:-1,className:f.default.imageGalleryItemSpacer}),(0,x.jsx)("div",{tabIndex:-1,className:f.default.imageGalleryItemSpacer}),s]})})}}S.defaultProps={thumbnails:[]},S.displayName="ImageGallery";const y=(0,v.default)(S);t.default=class extends y{focus(){this.getComponent().focus()}}},84658:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(s(94184)),n=s(67294),o=a(s(91952)),l=a(s(75940)),r=s(9492),d=a(s(91137)),c=s(22252),u=a(s(39e3)),h=a(s(2408)),f=a(s(45689)),p=a(s(36344)),m=s(2904),g=a(s(2966)),_=a(s(63477)),v=a(s(68062)),C=s(49002),x=a(s(82669)),S=s(85893);class y extends n.Component{constructor(...e){super(...e),this.state={active:!1,emojiPicker:null},this._refEmojiPanel=(0,n.createRef)(),this.handleEmojiPicker=e=>{e&&(e.preventDefault(),e.stopPropagation());const t=(0,S.jsx)(d.default,{ref:this._refEmojiPanel,onEmoji:this.handleEmoji,onFocusNext:this.restoreFocus,onFocusPrev:this.restoreFocus});this.setState({emojiPicker:{menu:t,dirY:r.DirY.TOP,type:"emoji_picker",anchor:e.target}}),this.restoreFocus()},this.handleEmojiPickerClose=()=>{this.setState({emojiPicker:null})},this.handleRestoreEmojiPickerFocus=()=>{var e;null===(e=this._refEmojiPanel.current)||void 0===e||e.restoreFocus()},this.handleEmoji=e=>{const t=this.refInput;t&&(t.focus(!1),t.replaceSelection(e)),this.handleEmojiPickerClose()},this.setRefInput=e=>{this.refInput=e},this.handleSelectionChange=e=>{this.selection=e},this.restoreFocus=()=>{this.refInput&&this.refInput.focus()},this.handleBlur=e=>{this.state.active&&this.setState({active:!1}),this.props.onBlur&&this.props.onBlur(e)},this.handleFocus=e=>{e.stopPropagation(),this.state.active||this.setState({active:!0}),this.props.onFocus&&this.props.onFocus(e)},this.handleReset=()=>{this.refInput&&this.refInput.reset()}}componentDidMount(){this.props.focusOnMount&&this.restoreFocus()}render(){const e=this.props.maxLength,t=(0,C.numCodepoints)(this.props.value||""),s=(0,i.default)(p.default.textInput,{[p.default.noPlaceholder]:!this.props.placeholder,[p.default.active]:!0}),a=(0,i.default)(p.default.labelText,{[p.default.float]:!!this.props.value}),n=this.props.supportsEmoji?(0,S.jsx)("button",{className:p.default.inputEmoji,onClick:this.handleEmojiPicker,children:(0,S.jsx)(g.default,{"aria-label":h.default.t(30),name:"emoji-input"})}):void 0;let o=null;const{value:l}=this.props;o=l&&""!==l?(0,S.jsx)("div",{role:"button",className:p.default.clearInput,onClick:this.handleReset,children:(0,S.jsx)(g.default,{name:"x-alt"})}):null;const r=this.props.showRemaining?(0,S.jsx)("div",{className:(0,i.default)(p.default.buttonContainer,p.default.charCounter,{[p.default.charCounterWithClearBtn]:!!o}),children:(0,S.jsx)("div",{className:p.default.charCounter,children:e-t<50?h.default.n(e-t):null})}):null;let d;return this.state.emojiPicker&&(d=(0,S.jsx)(_.default,{displayName:"EmojiPicker",escapable:!0,popable:!0,requestDismiss:this.handleEmojiPickerClose,requestFocus:this.handleRestoreEmojiPickerFocus,children:(0,S.jsx)(v.default,{contextMenu:this.state.emojiPicker})})),(0,S.jsxs)(u.default,{className:s,onFocus:this.restoreFocus,children:[(0,S.jsx)("span",{className:a,children:this.props.placeholder}),(0,S.jsx)("div",{className:p.default.spacer}),(0,S.jsx)("div",{className:p.default.suggestionsPositioner,children:(0,S.jsxs)("div",{className:p.default.suggestionsContainer,children:[(0,S.jsx)(f.default.MentionSuggestions,{chat:this.props.chat,theme:m.ThemeOptions.MEDIA_CAPTION}),(0,S.jsx)(f.default.EmojiSuggestions,{chat:this.props.chat,theme:c.ThemeOptions.MEDIA_CAPTION})]})}),(0,S.jsxs)("div",{className:(0,i.default)(p.default.wrapper,{[p.default.textActive]:this.state.active}),children:[(0,S.jsx)(f.default,{ref:this.setRefInput,initialValue:this.props.value,initialSelection:this.selection,readOnly:!1,spellCheck:this.props.spellCheck,multiline:this.props.multiline,maxLength:this.props.maxLength,onEnter:this.props.onEnter,onMaxPasteExceeded:this.props.onMaxPasteExceeded,onFiles:this.props.onFiles,onChange:this.props.onChange,onSelect:this.handleSelectionChange,theme:"media-caption"}),(0,S.jsxs)("div",{className:p.default.inputControls,children:[(0,S.jsxs)(x.default,{transitionName:"pop",component:"div",className:p.default.buttonContainer,children:[o,n]}),r]})]}),d]})}}t.default=y,y.defaultProps={maxLength:25,onMaxPasteExceeded:()=>{o.default.openModal((0,S.jsx)(l.default,{title:h.default.t(481),onOK:()=>{o.default.closeModal()},okText:h.default.t(2085),children:h.default.t(480)}))}},y.displayName="MediaCaptionTextInput"},69704:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(67294),n=a(s(55454)),o=a(s(98213)),l=a(s(20487)),r=a(s(76006)),d=s(85893);function c(e,t){const s=(0,i.useRef)(null),a=(0,r.default)(e.chatPreference,["wallpaperColor","showDoodle"]);(0,i.useImperativeHandle)(t,(()=>({get container(){return s.current}})));const{wallpaperColor:c,showDoodle:u}=a;let h={};return c!==n.default.DEFAULT_CHAT_WALLPAPER&&(h={backgroundColor:c}),(0,d.jsx)("div",{className:l.default.container,ref:s,children:(0,d.jsxs)("div",{className:l.default.body,style:h,children:[(0,d.jsx)(o.default,{wallpaperColor:c,showDoodle:u}),e.children]})})}var u=(0,i.forwardRef)(c);t.default=u},29827:(e,t,s)=>{"use strict";var a=s(20862),i=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(s(63105)),o=s(67294),l=i(s(76610)),r=i(s(78899)),d=i(s(89545)),c=i(s(91952)),u=i(s(75940)),h=i(s(55454)),f=i(s(17025)),p=i(s(84286)),m=i(s(47452)),g=i(s(42155)),_=s(57085),v=i(s(47193)),C=i(s(22079)),x=i(s(52087)),S=i(s(39e3)),y=i(s(72739)),E=i(s(13985)),j=i(s(2408)),I=a(s(42856)),M=a(s(79475)),T=i(s(90904)),b=i(s(5582)),P=i(s(76870)),L=i(s(25817)),w=i(s(2966)),D=i(s(80750)),O=i(s(35371)),N=i(s(63477)),R=i(s(68062)),k=i(s(82669)),A=s(85893);class F extends o.Component{constructor(...e){super(...e),this.state={img:this.props.startImage,hover:!1,imageSize:null},this._setRefImageContainer=e=>{this._refImageContainer=e},this._setRefImageInput=e=>{this._refImageInput=e},this._handleUpload=()=>{const e=this._refImageInput;if(e)return e.click(),!0},this._removeImage=()=>{this.props.onImageSet(),c.default.closeModal()},this._handleRemove=()=>{const e=this.props.type===P.default.GROUP?j.default.t(1517):j.default.t(1520);c.default.openModal((0,A.jsx)(u.default,{onOK:this._removeImage,okText:j.default.t(1516),onCancel:()=>c.default.closeModal(),cancelText:j.default.t(1912),children:e}))},this._handleView=()=>{const e=this._refImageContainer,{id:t,attachToChat:s}=this.props;if(!e||!t)return;const a=f.default.assertGet(t),i={transition:"profile-viewer"};s&&(i.uim=this.props.uim),c.default.openModalMedia((0,A.jsx)(L.default,{contact:a,profilePicThumb:a.getProfilePicThumb(),animateBorderRadius:!0,getZoomNode:t=>{t(e)}}),i)},this.handlePaste=e=>{if(!this.state.contextMenu)return;const t=new p.default(e.clipboardData),s=(0,n.default)(t.getFiles(),(e=>"image"===(0,_.typeFromMimetype)(e.type)));if(!s.length)return;e.preventDefault(),e.stopPropagation(),this.closeContextMenu();const a=s[0];this._handleImagePick(a)},this.handleImageSelected=e=>{this.closeContextMenu();const t=e.target.files[0];if(!t)return!1;this._handleImagePick(t),e.target.value="",this._refImageContainer&&v.default.focus(this._refImageContainer)},this._handleImageReceived=(e,t)=>{e?I.loadImage(e).then((()=>{this.setState({img:e}),this.props.onImageSet(e,t)})).catch((e=>{__LOG__(3)`PhotoPicker:onImageReceived failed to load image: ${String(e)}`;const t=this.props.type===P.default.GROUP?j.default.t(141):j.default.t(210);c.default.openModal((0,A.jsx)(u.default,{onOK:()=>c.default.closeModal(),children:t}))})):this.setState({img:null,imageSize:null})},this.handleSearch=()=>{c.default.openModal((0,A.jsx)(M.default,{type:M.ModalTheme.Box,children:(0,A.jsx)(y.default,{onFinished:this._handleImageReceived})}))},this._handleImagePick=e=>{const t=URL.createObjectURL(e);I.loadImage(t).then((t=>{t&&(t.width<h.default.MIN_PIC_SIDE||t.height<h.default.MIN_PIC_SIDE)?c.default.openModal((0,A.jsx)(u.default,{onOK:()=>c.default.closeModal(),children:j.default.t(1508,{size:h.default.MIN_PIC_SIDE,_plural:h.default.MIN_PIC_SIDE})})):c.default.openModal((0,A.jsx)(M.default,{type:M.ModalTheme.Box,children:(0,A.jsx)(g.default,{img:e,onFinished:this._handleImageReceived,onRetake:this._handleUpload})}))})).catch((()=>{const e=this.props.type===P.default.GROUP?j.default.t(141):j.default.t(210);c.default.openModal((0,A.jsx)(u.default,{onOK:()=>c.default.closeModal(),children:e}))})).finally((()=>{URL.revokeObjectURL(t)}))},this._createMenu=()=>{const e=[];return this.props.id&&this.state.img&&e.push((0,A.jsx)(m.default,{a8n:"mi-view-photo",action:this._handleView,children:j.default.t(1797)},"view")),C.default&&e.push((0,A.jsx)(D.default,{onImageTake:this._handleImageReceived},"take")),e.push((0,A.jsx)(m.default,{a8n:"mi-upload-photo",action:this._handleUpload,children:j.default.t(1750)},"upload")),O.default.isElectron&&this.props.type===P.default.GROUP&&e.push((0,A.jsx)(m.default,{a8n:"mi-search-photo",action:this.handleSearch,children:j.default.t(2145)},"search")),this.state.img&&e.push((0,A.jsx)(m.default,{a8n:"mi-remove-photo",action:this._handleRemove,children:j.default.t(1519)},"remove")),e},this.handleImageKeypress=()=>{const e=this._createMenu();this.setState({contextMenu:{menu:e,anchor:this._refImageContainer}})},this.handleImageClick=e=>{if(this.props.readOnly)return void(this.state.img&&this._handleView());e.stopPropagation(),e.preventDefault();const t=this._createMenu();this.setState({contextMenu:{menu:t,event:e}})},this.closeContextMenu=()=>{this.setState({contextMenu:null})},this.handleMouseOver=()=>{this.state.hover||this.setState({hover:!0})},this.handleMouseEnter=()=>{this.state.hover||this.setState({hover:!0})},this.handleMouseLeave=()=>{this.state.hover&&this.setState({hover:!1})},this.handleLoad=e=>{const t=e.target.clientWidth,s=e.target.clientHeight;this.setState({imageSize:{width:t,height:s}})}}static getDerivedStateFromProps(e){return e.startImage?{img:e.startImage}:{img:e.startImage,imageSize:null}}_getContainerStyle(){return null!=this.props.size?{width:this.props.size,height:this.props.size}:void 0}render(){let e,t;this.state.img&&(e=(0,A.jsx)(T.default,{type:"cover",size:this.state.imageSize,children:(0,A.jsx)(E.default,{src:this.state.img,crossOrigin:!1,style:{height:"100%",width:"100%"},onLoad:this.handleLoad})})),(this.props.pending||this.state.img&&!this.state.imageSize)&&(t=(0,A.jsx)(d.default,{}));let s=null;if(!this.props.pending&&!this.props.readOnly&&(!this.state.img||this.state.imageSize)&&(!this.state.img||this.state.contextMenu||this.state.hover)){let e="";switch(this.props.type){case P.default.GROUP:e=this.state.img?j.default.t(560):j.default.t(237);break;case P.default.PROFILE:e=this.state.img?j.default.t(565):j.default.t(244)}s=(0,A.jsx)(r.default,{icon:(0,A.jsx)(w.default,{name:"camera"}),text:e})}const a=this.props.pending||!this.state.imageSize&&this.state.img?()=>{}:this.handleImageClick;let i,n;if(this.state.contextMenu&&(i=(0,A.jsx)(N.default,{displayName:"PhotoPickerContextMenu",escapable:!0,popable:!0,requestDismiss:this.closeContextMenu,children:(0,A.jsx)(R.default,{contextMenu:this.state.contextMenu})})),this.props.pending||!this.state.img||this.state.img&&!this.state.imageSize){const e=this.props.type===P.default.PROFILE?"default-user":"default-group";n=(0,A.jsx)("div",{className:b.default.defaultIcon,children:(0,A.jsx)(w.default,{name:e})})}return(0,A.jsxs)(S.default,{className:b.default.container,style:this._getContainerStyle(),handlers:{space:this.handleImageKeypress,enter:this.handleImageKeypress},children:[(0,A.jsxs)("div",{className:b.default.body,onClick:a,onMouseOver:this.handleMouseOver,onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,onPaste:this.handlePaste,onFocus:this.handleMouseEnter,onBlur:this.handleMouseLeave,ref:this._setRefImageContainer,dir:"ltr",tabIndex:0,role:"button","data-a8n":l.default.key(this.props.a8nText),children:[(0,A.jsxs)("div",{className:b.default.imageContainer,children:[e,n]}),(0,A.jsxs)(k.default,{transitionName:"fade",children:[t,s]})]}),(0,A.jsx)("input",{ref:this._setRefImageInput,type:"file",accept:"image/gif,image/jpeg,image/jpg,image/png",style:{display:"none"},onChange:this.handleImageSelected}),i]})}}F.displayName="PhotoPicker";var B=(0,x.default)(F);t.default=B},45689:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(s(68635)),n=a(s(28856)),o=a(s(22252)),l=a(s(99818)),r=a(s(31719)),d=a(s(1718)),c=a(s(2904)),u=a(s(34701));const h=new l.default,f=new i.default;class p extends((0,r.default)([n.default,f,h,d.default])){}t.default=p,p.MentionSuggestions=(0,u.default)(c.default,{plugin:h}),p.EmojiSuggestions=(0,u.default)(o.default,{plugin:f})},86537:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(s(94184)),n=a(s(3132)),o=a(s(18312)),l=s(85893);var r=({large:e,a8nText:t,onClick:s,icon:a,count:r,disabled:d})=>(0,l.jsxs)("div",{className:(0,i.default)(o.default.container,{[o.default.disabled]:d}),children:[(0,l.jsx)(n.default,{large:e,a8nText:t,onClick:s,disabled:d,children:a}),null!=r&&(0,l.jsx)("div",{className:(0,i.default)(o.default.count,{[o.default.large]:e}),children:(0,l.jsx)("span",{children:r})})]});t.default=r},33215:(e,t,s)=>{"use strict";var a=s(20862),i=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(s(81109)),o=s(67294),l=i(s(91952)),r=i(s(75940)),d=a(s(55588)),c=i(s(2408)),u=s(79475),h=s(88281),f=s(85893);t.default=({doSave:e,afterSave:t,isValid:s,children:a,modalConfig:i,onError:p,title:m,onCancel:g})=>{const[_,v]=(0,o.useState)(h.EditType.EDITING),C=(0,f.jsx)(d.default,{title:m,type:d.DRAWER_HEADER_TYPE.POPUP,onCancel:()=>{l.default.closeModal(),g&&g()}});return(0,f.jsx)(r.default,(0,n.default)({children:a,okText:c.default.t(1564),type:u.ModalTheme.Auto,onOK:()=>{v(h.EditType.PENDING),e().then((()=>{v(h.EditType.DONE),t&&t(),l.default.closeModal()}),(e=>{v(h.EditType.ERROR),p&&p(e)}))},okSpinner:_===h.EditType.PENDING,okDisabled:_===h.EditType.PENDING||!s,title:C},i))}},20128:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(s(94184)),n=s(67294),o=a(s(39e3)),l=a(s(95108)),r=s(85893);var d=({tabConfigs:e,selectedId:t,onSelect:s,tabClass:a,className:d})=>{const c=(0,n.useRef)(t),u=(0,n.useRef)([]),h=e.map((({id:e})=>e)),f=h.length-1;return(0,r.jsx)(o.default,{handlers:{right:()=>{const e=h.indexOf(c.current),t=e===f?0:e+1,s=u.current[t];s&&s.focus()},left:()=>{const e=h.indexOf(c.current),t=0===e?f:e-1,s=u.current[t];s&&s.focus()}},children:(0,r.jsx)("div",{role:"tablist",className:(0,i.default)(l.default.tabContainer,d),children:e.map(((e,n)=>(({title:e,id:n},o)=>{const d=n===t;return(0,r.jsx)("button",{role:"tab",tabIndex:d?0:-1,"aria-selected":Boolean(d),title:e,className:(0,i.default)(l.default.tab,{[l.default.selected]:d},a),onClick:()=>{d||s(n)},onFocus:()=>{c.current=n},ref:e=>u.current[o]=e,children:e},e)})(e,n)))})})};t.default=d},80750:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{onImageTake:t}=e;return(0,r.jsx)(n.default,{action:()=>{i.default.openModal((0,r.jsx)(o.default,{onFinished:t}))},a8n:"mi-take-photo",disabled:e.disabled,children:l.default.t(1687)})};var i=a(s(91952)),n=a(s(47452)),o=a(s(28174)),l=a(s(2408)),r=s(85893)},7795:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function({className:e}){let t=o.default.VERSION_STR;return(0,c.jsxs)(r.SelectableDiv,{"data-a8n":n.default.key("version"),className:(0,i.default)(d.default.versionInfo,e),selectable:!0,children:[l.default.t(1772,{version:""}),(0,c.jsx)("span",{dir:"LTR",children:t}),null,null]})};var i=a(s(94184)),n=a(s(76610)),o=a(s(55454)),l=a(s(2408)),r=s(20845),d=a(s(6935)),c=s(85893)},43348:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(s(84758)),n=a(s(91952)),o=a(s(75940)),l=a(s(85051)),r=a(s(99942)),d=a(s(47193)),c=a(s(75730)),u=a(s(2408)),h=s(97449),f=s(85893);class p extends r.default{constructor(...e){super(...e),this.filter=e=>{const t=e.groupMetadata;return!(!e.isGroup||e.isGroup&&!(null==t?void 0:t.participants.iAmMember()))&&((null==t?void 0:t.participants.get(this.props.contact.id))?u.default.t(249):!!(null==t?void 0:t.participants.iAmAdmin())||u.default.t(584))},this._confirmAddToGroup=e=>{this.props.requestFocus&&this.props.requestFocus(),this.push((0,f.jsx)(o.default,{cancelText:u.default.t(1912),okText:u.default.t(238),onOK:this._addToGroup.bind(null,e),onCancel:this._pop,children:(0,f.jsx)(l.default,{text:u.default.t(689,{participant:this.props.contact.formattedName,subject:e.contact.name})})}))},this.requestFocus=()=>{if(!this.refUIE)return;const e=this.refUIE.getNode();e&&!e.contains(document.activeElement)&&d.default.focus(e)},this._addToGroup=e=>{(0,h.addParticipants)(e,[this.props.contact]).then((()=>{n.default.openChatFromUnread(e).then((t=>{t&&n.default.focusChatTextInput(e)}))})).catch((()=>{})),this.end()},this._pop=()=>{this.pop()}}componentDidMount(){this.push((0,f.jsx)(c.default,{chats:i.default.filter((e=>e.isGroup)),filter:this.filter,onCancel:this._pop,onGroup:this._confirmAddToGroup}))}}t.default=p},9679:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(s(81629)),n=a(s(51463)),o=s(73754),l=a(s(91952)),r=a(s(99942)),d=a(s(92235)),c=s(90672),u=s(88340),h=a(s(35371)),f=s(85893);class p extends r.default{constructor(...e){super(...e),this._setRefMediaEditor=e=>{this._refMediaEditor=e},this.onCancel=()=>{this.props.onComplete&&this.props.onComplete(!1),this._clearAttachMedia(),this.props.mediaCollection.mediaPickerStatsLogger.logCancel(),this.end()},this.onFailedMedias=e=>{const t=e.filter((e=>e.isGif));if(t.length>0){const e=t.map((e=>e.filename));l.default.once("ui_idle",(()=>{l.default.pasteChatTextInput(this.props.chat,e.join(" "))})),this.props.onComplete&&this.props.onComplete(!1),this._clearAttachMedia(),this.props.mediaCollection.mediaPickerStatsLogger.logCancel(),this.end()}},this._sendMediaWithMentions=(e,t={})=>{const{initCaptionUsed:s,isViewOnce:a,asSticker:i}=t,{chat:n}=this.props;l.default.once("ui_idle",(()=>{e.forEach(((e,t)=>{const s=e.media,l={};if(0===t&&(l.quotedMsg=n.composeQuotedMsg,n.composeQuotedMsg=null),l.isViewOnce=a,l.asSticker=i,i&&(l.type=c.OUTWARD_TYPES.STICKER),l.mentionedJidList=e.mentionedJidList,l.caption=s.caption,l.addEvenWhilePreparing=s.previewable&&s.state===o.ATTACH_MEDIA_STATE.PROCESSING,this.props.initCaption&&this.props.initCaption.ctwaContextLinkData){const{ctwaContextLinkData:e,ctwaContext:t}=this.props.initCaption;l.ctwaContext=(0,u.prepareCtwaContextSend)(e,t)}s.sendToChat(n,l)})),this._clearAttachMedia()})),this.props.onComplete&&this.props.onComplete(!0,{initCaptionUsed:s}),this.props.mediaCollection.mediaPickerStatsLogger.logSend(),this.end()},this.setText=e=>{null!=e&&l.default.once("ui_idle",(()=>{l.default.pasteChatTextInput(this.props.chat,e)})),this.end()},this.handleRequestDismiss=e=>{var t;(null===(t=this._refMediaEditor)||void 0===t?void 0:t.handleRequestDismiss())&&(!1===e&&this.onCancel(),super.handleRequestDismiss())},this._clearAttachMedia=()=>{this.props.chat&&this.props.chat.setAttachMediaContents(null)}}componentDidMount(){l.default.closeContextMenu(),l.default.closeTooltip(),this.push((0,f.jsx)(d.default,{theme:"attach",ref:this._setRefMediaEditor,chat:this.props.chat,onClose:this.onCancel,initCaption:this.props.initCaption,onSendMedia:(0,n.default)(this._sendMediaWithMentions),mediaCollection:this.props.mediaCollection,onDropText:(0,n.default)(this.setText)}))}componentWillUnmount(){h.default.isGecko?(0,i.default)((()=>l.default.focusChatTextInput(this.props.chat))):l.default.focusChatTextInput(this.props.chat)}}t.default=p},91338:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(s(91952)),n=a(s(99942)),o=a(s(2408)),l=s(30333),r=a(s(63389)),d=s(40307),c=s(85893);class u extends n.default{constructor(...e){super(...e),this.requestFocus=()=>{var e;const t=null===(e=this.refUIE)||void 0===e?void 0:e.getRef();null!=t&&(t instanceof HTMLElement||"function"!=typeof t.onFocusList||t.onFocusList())},this._sendProducts=e=>{const{chat:t}=this.props;e.forEach(((e,s)=>{const a=0===s?t.composeQuotedMsg:null;t.sendProductMessage(e,a).then((()=>{(0,l.logProductMessageSent)({product:e,catalogSessionId:this.props.sessionId})}))})),t.composeQuotedMsg=null,this.end()},this._shareCatalog=e=>{const{chat:t}=this.props,s=(0,d.createCatalogLink)(e.id.user),a=`${o.default.t(1462)} ${s}`;i.default.pasteChatTextInput(t,a),(0,l.logSendCatalogClick)({catalogOwnerWid:e.id,catalogSessionId:this.props.sessionId}),this.end()},this._pop=()=>{this.pop()},this._popNone=()=>{this.pop("none")}}componentDidMount(){this.push((0,c.jsx)(r.default,{onCancel:this._pop,onConfirm:this._sendProducts,onShare:this._shareCatalog}))}}var h=u;t.default=h},68050:(e,t,s)=>{"use strict";var a=s(20862),i=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(s(81109)),o=i(s(99942)),l=i(s(2408)),r=a(s(57774)),d=i(s(16875)),c=i(s(65565)),u=i(s(45953)),h=s(85893);class f extends o.default{constructor(...e){super(...e),this._confirmSendContacts=e=>{this.push((0,h.jsx)(u.default,{contactList:e,onSend:()=>this._sendContacts(e),onBack:this._popNone,chat:this.props.chat}),"none"),this.contacts=e},this._sendContacts=e=>{const{chat:t}=this.props,s=t.composeQuotedMsg,a=t.getComposeContents().ctwaContext||void 0;(0,d.default)(e,t,s,a),t.composeQuotedMsg=null,this.props.onContactsSent(),this.end()},this._getContacts=()=>this.contacts,this._pop=()=>{this.pop()},this._popNone=()=>{this.pop("none")}}componentDidMount(){const e=this.props.serverProps.maxParticipants;this.contacts=[],this.push((0,h.jsx)(r.default,{title:l.default.t(1601),onCancel:this._pop,onConfirm:this._confirmSendContacts,getInitialItems:this._getContacts,listType:r.ListType.CONTACT_SELECT_MODAL,maxItems:e,allowBlockedContacts:!0}))}}t.default=e=>(0,h.jsx)(f,(0,n.default)((0,n.default)({},e),{},{serverProps:c.default}))},40993:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(s(66578)),n=a(s(99942)),o=s(57990),l=s(85893);class r extends n.default{constructor(...e){super(...e),this.sendMedia=({getImg:e,caption:t,isViewOnce:s,mentionedJidList:a})=>{const i=this.props.chat,n=i.composeQuotedMsg;i.composeQuotedMsg=null;const l=i.getComposeContents().ctwaContext||void 0;(0,o.prepRawMedia)(e,{}).sendToChat(i,{caption:t,mentionedJidList:a,quotedMsg:n,ctwaContext:l,isViewOnce:s}),this.props.onCaptureSent(),this.end()}}componentDidMount(){this.push((0,l.jsx)(i.default,{onBack:()=>{this.end()},chat:this.props.chat,caption:!0,theme:"capture-contain",onSend:this.sendMedia,stream:this.props.stream,disposeStream:this.props.disposeStream}))}}t.default=r},58665:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(s(48720)),n=a(s(91952)),o=a(s(79864)),l=a(s(99942)),r=a(s(4231)),d=s(70790),c=a(s(62002)),u=s(85893);class h extends l.default{constructor(...e){super(...e),this.onProductCatalog=()=>{const{sellerJid:e,chat:t}=this.props;this.push((0,u.jsx)(c.default,{chat:t,catalogOwnerJid:e}))},this.onProductDetail=e=>{const{chat:t}=this.props;this.push((0,u.jsx)(c.default,{refreshCarousel:!0,chat:t,productInfo:e,onEnd:this._pop}))},this._end=()=>{this.end(!0)},this._pop=()=>{this.pop()}}componentDidMount(){const{sellerJid:e,chat:t}=this.props;this.push((0,u.jsx)(o.default.Consumer,{children:s=>{const{entryPoint:a}=(0,d.getProductCatalogContext)(s);return(0,u.jsx)(i.default,{chat:t,sellerJid:e,onProductDetail:this.onProductDetail,onProductCatalog:this.onProductCatalog,onBack:this._end,closeDrawerRightOnSend:a===r.default.CATALOG_ENTRY_POINT.CATALOG_ENTRY_POINT_PRODUCT_LIST_MESSAGE})}})),n.default.existsDrawerLeft((e=>{e&&n.default.closeDrawerLeft()})),n.default.existsDrawerMid((e=>{e&&n.default.closeDrawerMid()}))}}t.default=h},85445:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(s(81109)),n=s(55084),o=a(s(60028)),l=a(s(17663)),r=a(s(65571)),d=a(s(64305)),c=a(s(91952)),u=a(s(70458)),h=a(s(34114)),f=a(s(17025)),p=a(s(79864)),m=s(55588),g=a(s(69105)),_=a(s(2466)),v=s(54647),C=a(s(99942)),x=s(86723),S=s(78615),y=a(s(2408)),E=s(59562),j=a(s(60879)),I=a(s(78150)),M=s(70790),T=a(s(83153)),b=a(s(27370)),P=s(68598),L=a(s(64883)),w=s(85893);class D extends C.default{constructor(...e){super(...e),this._handleAddFirstProduct=()=>{o.default.find(this.props.catalogId).then((()=>{this._showProductList(),this._onAddProduct()})).catch((0,n.filteredCatch)(v.ServerStatusCodeError,(()=>{__LOG__(3)`Failed to fetch product catalog from server`})))},this._showProductList=()=>{const e=f.default.get(this.props.catalogId);if(!e)return;const t=(0,S.canManageCollections)()?(0,w.jsx)(d.default,{contact:e,onCatalogLinkClick:this._onCatalogShare,onProductShare:this.onProductShare,onProductDetail:this.onEditProduct,onAddProduct:this._onAddProduct,catalogId:this.props.catalogId,onBack:this._end,onCartClick:this.onCartClick,businessProfile:null,headerType:m.DRAWER_HEADER_TYPE.LARGE,onCollectionSeeAll:this.onCollectionSeeAll,canManageCatalog:!0,autoUpdate:!0,onOpenCollections:this.onOpenCollections,onEditCollection:this._onEditCollection,onOpenSettings:this.onOpenSettings}):(0,w.jsx)(b.default,{contact:e,onCatalogLinkClick:this._onCatalogShare,onProductShare:this.onProductShare,onProductDetail:this.onEditProduct,onAddProduct:this._onAddProduct,catalogId:this.props.catalogId,onBack:this._end,onCartClick:this.onCartClick,businessProfile:null,headerType:m.DRAWER_HEADER_TYPE.LARGE,canManageCatalog:!0,autoUpdate:!0,onOpenSettings:this.onOpenSettings});this.push(t)},this.onEditProduct=e=>{const t=o.default.assertGet(this.props.catalogId);c.default.openDrawerMid((0,w.jsx)(_.default,{catalog:t,product:e}),"slide-left",void 0,void 0,this.props.context,P.FocusType.TABBABLE)},this.onCartClick=e=>{(0,L.default)(e,void 0,this.props.context)},this.onCollectionSeeAll=e=>{const t=this.props.catalogId,s=f.default.gadd(t);this.push((0,w.jsx)(u.default,{contact:s,onProductDetail:this.onEditProduct,onProductShare:this.onProductShare,catalogId:t,onBack:this._pop,onCatalogLinkClick:this._onCatalogShare,onCartClick:this.onCartClick,collection:e,canManageCatalog:!0,headerType:m.DRAWER_HEADER_TYPE.LARGE,onEditCollection:this._onEditCollection}))},this._onEditCollection=e=>{const t=(0,x.getMeUser)(),s=o.default.get(t);s&&this.push((0,w.jsx)(g.default,{onBack:this._pop,collection:e,catalog:s}))},this._onAddProduct=()=>{const e=o.default.assertGet(this.props.catalogId),t=new I.default({catalogWid:e.id,additionalImageCdnUrl:[]});c.default.openDrawerMid((0,w.jsx)(_.default,{catalog:e,product:t,newProduct:!0}),"slide-left",void 0,void 0,this.props.context,P.FocusType.TABBABLE)},this._onCatalogShare=(e,t)=>{c.default.openDrawerMid((0,w.jsx)(l.default,{onCancel:()=>{c.default.closeDrawerMid()},catalog:e,contact:t,prompt:y.default.t(556),onSend:()=>c.default.closeDrawerMid(),centerDrawer:!0}),"slide-left",void 0,void 0,this.props.context,P.FocusType.TABBABLE)},this.onProductShare=e=>{c.default.openDrawerMid((0,w.jsx)(T.default,{onCancel:()=>{c.default.closeDrawerMid()},product:e,prompt:y.default.t(556),onSend:()=>c.default.closeDrawerMid(),centerDrawer:!0,sendProductMsg:!0}),"slide-left",void 0,void 0,this.props.context,P.FocusType.TABBABLE)},this.onOpenCollections=()=>{this.push((0,w.jsx)(h.default,{onBack:this._pop,editCollection:this.editCollection,onSeeCollection:this.onSeeCollection})),(0,E.logCollectionMenuClicked)((0,M.getProductCatalogContext)(this.props.context))},this.onSeeCollection=e=>{const t=s(85445).default;this.push((0,w.jsx)(t,{catalogId:(0,x.getMeUser)(),collection:e,product:null}))},this.editCollection=e=>{const t=(0,x.getMeUser)(),s=o.default.get(t);e||(0,E.logCollectionCreateClicked)((0,M.getProductCatalogContext)(this.props.context)),s&&this.push((0,w.jsx)(g.default,{onBack:this._pop,collection:e,catalog:s}))},this.onOpenSettings=()=>{this.push((0,w.jsx)(r.default,{onBack:this._pop}))},this._pop=()=>{this.pop(),c.default.closeDrawerMid()},this._end=()=>{this.end(!0),c.default.closeDrawerMid()}}componentDidMount(){null!=this.props.collection?this.onCollectionSeeAll(this.props.collection):null!=this.props.catalog?(this._showProductList(),null!=this.props.product&&this.onEditProduct(this.props.product)):this._showNewCatalog()}_showNewCatalog(){this.push((0,w.jsx)(j.default,{onBack:this._pop,onAddProductClick:this._handleAddFirstProduct,onCatalogAlreadyCreated:this._showProductList}))}}t.default=e=>(0,w.jsx)(p.default.Consumer,{children:t=>(0,w.jsx)(D,(0,i.default)({context:t},e))})},64732:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(s(79353)),n=a(s(99942)),o=a(s(62002)),l=s(85893);class r extends n.default{constructor(...e){super(...e),this.onProductClick=e=>{this.push((0,l.jsx)(o.default,{refreshCarousel:!0,chat:this.props.msg.chat,product:e,onEnd:this._pop}))},this._pop=()=>{this.pop()}}componentDidMount(){this.push((0,l.jsx)(i.default,{msg:this.props.msg,onProductClick:this.onProductClick}))}}t.default=r},50179:(e,t,s)=>{"use strict";var a=s(20862),i=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=s(55084),o=i(s(66578)),l=i(s(91952)),r=a(s(7158)),d=a(s(13540)),c=i(s(99942)),u=a(s(47683)),h=a(s(10214)),f=a(s(79475)),p=i(s(40630)),m=s(85893);class g extends c.default{constructor(...e){super(...e),this._refCaptureDrawer=null,this._setRefCaptureDrawer=e=>{this._refCaptureDrawer=e},this._pushPermissionModal=()=>{this.push((0,m.jsx)(u.default,{messaging:u.Messaging.CAMERA,type:u.default.TYPE.GUIDE_ALLOW,onConfirm:this._popModal}),"modal")},this._popModal=()=>{this.pop("modal")},this._startCaptureDrawer=()=>{var e;null===(e=this._disposeStream)||void 0===e||e.call(this);const{asyncStream:t,disposeStream:s}=h.start("camera",this._pushPermissionModal);this._disposeStream=s,t.then((e=>{this._refCaptureDrawer||this._popModal(),e&&this._refCaptureDrawer&&this._refCaptureDrawer.loadNewStream(e,s)})).catch((0,n.filteredCatch)(d.GUM.NotAllowedError,(()=>{this.cleanUp(),l.default.openModal((0,m.jsx)(u.default,{messaging:u.Messaging.CAMERA_FAIL,type:u.default.TYPE.GUIDE_UNBLOCK}))}))).catch((0,n.filteredCatch)(d.GUM.GUMError,(()=>{this.cleanUp(),l.default.openModal((0,m.jsx)(u.default,{messaging:u.Messaging.CAMERA_MISSING,type:u.default.TYPE.GUIDE_NONE}))})))},this.onFinished=(e,t)=>{this.props.onFinished(e,t),this.cleanUp()},this.cleanUp=()=>{this.end()},this.onRetake=()=>{this.pop("flow-transition-box-size-drawer-pop"),this._startCaptureDrawer()},this.onCaptured=e=>{this.push((0,m.jsx)(f.default,{type:f.ModalTheme.Box,children:(0,m.jsx)(r.default,{onRetake:this.onRetake,retryText:r.RETRY_OPTIONS.RETAKE,onFinished:this.onFinished,onCancel:this.cleanUp,img:e})}),"flow-transition-box-size-drawer-push")},this.handleRequestDismiss=e=>{!1===e&&this.stackSize()>1?this.onRetake():this.cleanUp()}}componentDidMount(){this.push((0,m.jsx)(f.default,{type:f.ModalTheme.Box,children:(0,m.jsx)(o.default,{ref:this._setRefCaptureDrawer,stream:void 0,disposeStream:void 0,caption:!1,theme:"capture-cover",onBack:this.cleanUp,onSend:null,onCaptured:this.onCaptured,chat:void 0})})),this._startCaptureDrawer()}componentWillUnmount(){var e;null===(e=this._disposeStream)||void 0===e||e.call(this)}}var _=(0,p.default)(g);t.default=_},42155:(e,t,s)=>{"use strict";var a=s(95318),i=s(20862);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(s(7158)),o=a(s(99942)),l=s(85893);class r extends o.default{constructor(...e){super(...e),this.onEnd=()=>{this.end()},this.onFinished=(e,t)=>{this.props.onFinished(e,t),this.end()}}componentDidMount(){this.push((0,l.jsx)(n.default,{onCancel:this.onEnd,onFinished:this.onFinished,onRetake:this.props.onRetake,retryText:n.RETRY_OPTIONS.RESTART,img:this.props.img}))}}t.default=r},2466:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(s(91952)),n=a(s(74659)),o=a(s(99942)),l=a(s(2408)),r=a(s(21792)),d=a(s(83153)),c=s(85893);class u extends o.default{constructor(...e){super(...e),this._showInfoDrawer=e=>{const{catalog:t}=this.props;this.push((0,c.jsx)(r.default,{catalog:t,product:e,onCancel:this.end,onEditProduct:this._onProductEdit,onShareProduct:this.onShareProduct}))},this.onShareProduct=e=>{this.push((0,c.jsx)(d.default,{onBack:this._pop,product:e,prompt:(0,c.jsx)("div",{children:l.default.t(556)}),onSend:()=>i.default.closeDrawerMid(),centerDrawer:!0,sendProductMsg:!0}))},this._onProductEdit=e=>{this.push((0,c.jsx)(n.default,{catalog:this.props.catalog,onBack:this._pop,onEditSuccess:this._showInfoDrawer,product:e,onDelete:this.props.onDelete}))},this._pop=()=>{this.pop()},this._end=()=>{this.end(!0)}}componentDidMount(){const{catalog:e,product:t,onCreate:s,newProduct:a}=this.props;a?this.push((0,c.jsx)(n.default,{onCancel:this._pop,onEditSuccess:e=>{s&&s(),this._showInfoDrawer(e)},catalog:e,product:t,newProduct:!0})):this._showInfoDrawer(t)}}t.default=u},65682:(e,t,s)=>{"use strict";var a=s(20862),i=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=s(55084),o=i(s(84758)),l=i(s(91952)),r=i(s(75940)),d=i(s(55454)),c=i(s(99942)),u=i(s(9324)),h=i(s(49461)),f=i(s(2408)),p=a(s(57774)),m=i(s(65565)),g=s(85893);class _ extends c.default{constructor(...e){super(...e),this.requestFocus=()=>{var e;const t=null===(e=this.refUIE)||void 0===e?void 0:e.getRef();null!=t&&(t instanceof HTMLElement||"function"!=typeof t.onFocusList||t.onFocusList())},this.onForwardConfirmed=e=>{const{msgs:t,onForward:s}=this.props;o.default.forwardMessagesToChats(t,e).catch((0,n.filteredCatch)(u.default,(e=>{this._showMediaSendError(e.reasons)}))),this.end(),s&&s(t),l.default.openChatFromUnread(e[0])},this._showMediaSendError=e=>{const t=e.map((({chat:e,reason:t})=>(0,g.jsxs)("p",{children:[e.formattedTitle," : ",t]},e.id.toString())));l.default.openModal((0,g.jsx)(r.default,{onOK:()=>l.default.closeModal(),okText:f.default.t(2085),children:t}),void 0)}}componentDidMount(){const{msgs:e}=this.props,t=f.default.t(910,{_plural:e.length||1}),s=e[0],a=s&&s.chat;let i;i="video"!==s.type&&"image"!==s.type?"message":s.type;const n=e.some((e=>e.isFrequentlyForwarded)),o=e.filter((e=>!e.isFrequentlyForwarded&&e.getForwardingScoreWhenForwarded()===d.default.FREQUENTLY_FORWARDED_SENTINEL));let l;o.length&&(l=(0,g.jsx)(h.default,{frequentlyForwardedCount:o.length,totalCount:e.length}));const r=n?m.default.frequentlyForwardedMax:m.default.multicastLimitGlobal;this.push((0,g.jsx)(p.default,{onConfirm:this.onForwardConfirmed,maxItems:r,excludeChat:a,excludeBroadcast:!0,msgType:i,title:t,listType:p.ListType.CHAT_SELECT_MODAL,customHeader:l,hasFrequentlyForwarded:n,showEphemeralIcon:!0}))}}t.default=_},56396:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(s(99942)),n=a(s(2251)),o=s(85893);class l extends i.default{componentDidMount(){this.push((0,o.jsx)(n.default,{chat:this.props.chat,onConfirm:this.props.onConfirm}))}}t.default=l},12158:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(s(99942)),n=a(s(62286)),o=a(s(62002)),l=s(85893);class r extends i.default{constructor(...e){super(...e),this.onProductClick=e=>{this.push((0,l.jsx)(o.default,{refreshCarousel:!0,chat:this.props.msg.chat,product:e,onEnd:this._pop}))},this._pop=()=>{this.pop()}}componentDidMount(){this.push((0,l.jsx)(n.default,{msg:this.props.msg,onProductClick:this.onProductClick}))}}t.default=r},50731:(e,t,s)=>{"use strict";var a=s(20862),i=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(s(91952)),o=i(s(75940)),l=s(62238),r=i(s(99942)),d=i(s(75798)),c=i(s(82981)),u=i(s(2408)),h=i(s(86245)),f=i(s(78972)),p=s(88300),m=a(s(49201)),g=s(85893);class _ extends r.default{constructor(...e){super(...e),this.onSendInvite=(e="",t)=>{n.default.closeModal(),Promise.all(this.props.participantNeedInvite.map((s=>{const{contact:a,invite_code:i,invite_code_exp:n}=s;return(0,l.findChat)(a.id).then((s=>{const o=this.props.groupGid.toString(),l=d.default.assertGet(o);return s.sendGroupInviteMessage(o,this.props.subject,i||"",n,e,t).then((e=>e===p.SendMsgResult.OK&&(l.pendingParticipants.add({id:a.id}),!0)))}))}))).then((e=>{const t=e.filter(Boolean).length;n.default.openToast((0,g.jsx)(m.default,{msg:u.default.t(2036,{num:t,_plural:t}),id:(0,m.genId)()}))}))},this._addInviteCommment=e=>{this.push((0,g.jsx)(c.default,{participants:e,gid:this.props.groupGid,subject:this.props.subject,groupDesc:this.props.groupDesc,onClose:this._pop,onSend:this.onSendInvite}))},this._pop=()=>{this.pop()}}componentDidMount(){const{participantNeedInvite:e}=this.props,t=this._getFormattedNames(e.map((e=>e.contact)),!0),s=u.default.t(1006,{participant:t,_plural:e.length});this.push((0,g.jsx)(o.default,{onOK:this._addInviteCommment.bind(this,e),okText:u.default.t(2035),onCancel:this._pop,cancelText:u.default.t(1912),children:s}))}_getFormattedName(e,t=!1){return t?e.formattedUser:(0,g.jsx)(f.default,{contact:e})}_getFormattedNames(e,t=!1){if(!Array.isArray(e))return this._getFormattedName(e,t);const s=e.map((e=>this._getFormattedName(e,t)));return(0,h.default)(s,t)}}t.default=_,_.defaultProps={removeTopDrawer:!0,pushTransition:"none",popTransition:"none"}},72739:(e,t,s)=>{"use strict";var a=s(95318),i=s(20862);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(s(7158)),o=a(s(99942)),l=a(s(51642)),r=s(85893);class d extends o.default{constructor(...e){super(...e),this.onImageSelected=(e,t)=>{this.push((0,r.jsx)(n.default,{onCancel:this._handleCancel,attributionUrl:t,onFinished:this.onFinished,onRetake:this._pop,retryText:n.RETRY_OPTIONS.NONE,img:e}))},this._handleCancel=()=>{this.end()},this._pop=()=>{this.pop()},this.onFinished=(e,t)=>{this.props.onFinished(e,t),this.end()}}componentDidMount(){this.push((0,r.jsx)(l.default,{onCancel:this._pop,onImageSelected:this.onImageSelected}))}}t.default=d},92243:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(s(22011)),n=a(s(91952)),o=a(s(75940)),l=a(s(55454)),r=a(s(99942)),d=a(s(2408)),c=a(s(59606)),u=a(s(26456)),h=a(s(35355)),f=a(s(22555)),p=s(85893);class m extends r.default{constructor(...e){super(...e),this.onDeleteLabel=e=>{e.forEach((({id:e})=>{c.default.deleteLabel(e)}))},this._onManageLabels=e=>{n.default.openModal((0,p.jsx)(f.default,{modelsToUpdate:e}))},this.onEditLabel=e=>{n.default.openModal((0,p.jsx)(i.default,{labelId:e,onUpdateLabel:this.onUpdateLabel,onCancel:n.default.closeModal()}))},this.onLabelClick=e=>{const t=s(19049).Z;this.push((0,p.jsx)(t,{openLabelColorDrawer:this.openLabelColorDrawer,labelId:e,onManageLabels:this._onManageLabels,onClose:this._pop,onRemoveLabel:this.onRemoveLabel,onEditLabel:this.onEditLabel}))},this.openAddLabel=()=>{c.default.toArray().length>=l.default.MAX_SMB_LABEL_COUNT?n.default.openModal((0,p.jsx)(o.default,{okText:d.default.t(1407),onOK:()=>n.default.closeModal(),children:d.default.t(2247,{count:l.default.MAX_SMB_LABEL_COUNT})})):n.default.openModal((0,p.jsx)(i.default,{onAddLabel:this.onAddLabel,onCancel:n.default.closeModal()}))},this.onUpdateLabel=(e,t)=>{c.default.updateLabel(e,t)},this.openLabelColorDrawer=(e,t)=>{this.push((0,p.jsx)(u.default,{labelId:e,onClose:this._pop,onUpdateColor:this.onUpdateLabel,currentColor:t}))},this._pop=()=>{this.pop()}}componentDidMount(){this.push((0,p.jsx)(h.default,{onDeleteLabel:this.onDeleteLabel,onLabelClick:this.onLabelClick,onClose:this._pop,openAddLabel:this.openAddLabel}))}onAddLabel(e,t){c.default.addNewLabel(e,t)}onRemoveLabel(e,t){c.default.addOrRemoveLabels([{id:e,type:"remove"}],t)}}t.default=m},4255:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(s(22011)),n=a(s(58380)),o=a(s(91952)),l=a(s(75940)),r=a(s(55454)),d=a(s(99942)),c=a(s(2408)),u=a(s(59606)),h=s(12735),f=a(s(64827)),p=a(s(4231)),m=s(85893);class g extends d.default{constructor(...e){super(...e),this._newlyAddedLabels=new Set,this._logWamEvent=()=>{const e=this.props.modelsToUpdate.length;this._labelViewType=1===e?this.props.modelsToUpdate[0]instanceof n.default?p.default.LABEL_TARGETS.LABEL_CHAT_DIALOG:p.default.LABEL_TARGETS.LABEL_MESSAGE_DIALOG:p.default.LABEL_TARGETS.LABEL_COMBINED_DIALOG,(0,h.logLabelOperationEvent)(p.default.LABEL_OPERATIONS.VIEW,e,this._labelViewType)},this.onLabelUpdateComplete=()=>{this.props.onLabelUpdateComplete&&this.props.onLabelUpdateComplete(),this._pop()},this.onAddLabel=(e,t)=>{u.default.addNewLabel(e,t).then((()=>{this._newlyAddedLabels.add(e)}))},this.shouldScrollIntoViewAndSelect=e=>this._newlyAddedLabels.has(e)?(this._newlyAddedLabels.delete(e),{shouldScrollIntoView:!0,shouldSelect:!0}):{shouldScrollIntoView:!1,shouldSelect:!1},this.onAddNewLabel=()=>{u.default.toArray().length>=r.default.MAX_SMB_LABEL_COUNT?o.default.openModal((0,m.jsx)(l.default,{okText:c.default.t(1407),onOK:()=>o.default.closeModal(),children:c.default.t(2247,{count:r.default.MAX_SMB_LABEL_COUNT})})):this.push((0,m.jsx)(i.default,{onAddLabel:this.onAddLabel,onCancel:this._pop}))},this._popAndLogEvent=()=>{this._labelViewType&&(0,h.logLabelOperationEvent)(p.default.LABEL_OPERATIONS.CLICK_NEGATIVE,this.props.modelsToUpdate.length,this._labelViewType),this.pop()},this._pop=()=>{this.pop()}}componentDidMount(){this._logWamEvent(),this.push((0,m.jsx)(f.default,{shouldScrollIntoViewAndSelect:this.shouldScrollIntoViewAndSelect,onAddNewLabel:this.onAddNewLabel,onLabelUpdateComplete:this.onLabelUpdateComplete,onCancel:this._popAndLogEvent,modelsToUpdate:this.props.modelsToUpdate}))}}t.default=g,g.defaultProps={removeTopDrawer:!0,pushTransition:"none",popTransition:"none"}},76820:(e,t,s)=>{"use strict";var a=s(20862),i=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(s(81109)),o=i(s(48926)),l=s(59118),r=s(67294),d=i(s(8581)),c=s(85148),u=i(s(91952)),h=s(10504),f=i(s(55454)),p=i(s(17747)),m=i(s(9042)),g=a(s(55588)),_=i(s(25061)),v=i(s(99942)),C=a(s(14179)),x=i(s(2408)),S=i(s(29458)),y=a(s(49201)),E=s(81465),j=s(85893);class I extends v.default{componentDidMount(){this.push((0,j.jsx)(M,{contactId:this.props.contactId,onBack:this.pop}))}}t.default=I;const M=(0,r.forwardRef)((({contactId:e,onBack:t},s)=>{const a=(0,r.useRef)(null);(0,r.useImperativeHandle)(s,(()=>({getElement:()=>a.current})));const[i,v]=(0,r.useState)({}),[C,S]=(0,r.useState)(!0),[y,I]=(0,r.useState)(!1);(0,r.useEffect)((()=>{(0,o.default)((function*(){const t=yield d.default.update(e,{getMerchantCompliance:!0}),s=(Array.isArray(t)?t[0]:t).serialize();s?(v(s.legalEntityDetails||void 0),S(!1)):__LOG__(3)`compliance: cannot fetch business details (${e.toString()})`}))()}),[e]);const M=(0,r.useCallback)(function(){var e=(0,o.default)((function*(e,t){const s={[e]:t};yield(0,c.editBusinessCompliance)((0,n.default)((0,n.default)({},s),{},{isRegistered:null==i?void 0:i.isRegistered})),v((e=>(0,n.default)((0,n.default)({},e),s)))}));return function(){return e.apply(this,arguments)}}(),[null==i?void 0:i.isRegistered]),b=(0,r.useCallback)(function(){var e=(0,o.default)((function*(e,t,s){const a={[e]:{[t]:s}};try{yield(0,c.editBusinessCompliance)((0,n.default)((0,n.default)({},a),{},{isRegistered:null==i?void 0:i.isRegistered}))}catch(e){throw new Error(e)}v((t=>(0,n.default)((0,n.default)({},t),{},{[e]:(0,n.default)((0,n.default)({},null==t?void 0:t[e]),a[e])})))}));return function(){return e.apply(this,arguments)}}(),[null==i?void 0:i.isRegistered]),P=(0,r.useCallback)(function(){var e=(0,o.default)((function*(e,t,s){const a={entityType:e,entityTypeCustom:t,isRegistered:s};I(!0),yield(0,c.editBusinessCompliance)(a),I(!1),v((e=>(0,n.default)((0,n.default)({},e),a)))}));return function(){return e.apply(this,arguments)}}(),[]),L=(0,r.useCallback)((e=>!e||(0,l.isPotentiallyPhoneNumber)(e)),[]),{entityName:w,customerCareDetails:D,grievanceOfficerDetails:O}=i||{},N=(0,r.useMemo)((()=>(0,h.getEntityTypeText)(i)),[i]);return(0,j.jsx)("div",{ref:a,children:(0,j.jsxs)(p.default,{children:[(0,j.jsx)(g.default,{title:x.default.t(394),onBack:t,type:g.DRAWER_HEADER_TYPE.LARGE}),(0,j.jsx)(m.default,{theme:C?"center-content":void 0,children:C?(0,j.jsx)(h.ComplianceInfoLoading,{}):(0,j.jsxs)(j.Fragment,{children:[(0,j.jsxs)(_.default,{theme:"form",children:[(0,j.jsx)(T,{value:w,maxLength:f.default.COMPLIANCE_INFO_LENGTH.ENTITY_NAME,placeholder:x.default.t(402),icon:"info",onSave:e=>M("entityName",e)}),(0,j.jsx)(T,{value:N,placeholder:x.default.t(403),icon:"account-balance",onFocus:()=>u.default.showMerchantDetailsEntityTypePopup(i,P),isLoading:y})]}),(0,j.jsxs)(_.default,{title:x.default.t(390),theme:"form",children:[(0,j.jsx)(T,{value:null==D?void 0:D.email,maxLength:f.default.COMPLIANCE_INFO_LENGTH.EMAIL,placeholder:x.default.t(391),icon:"business-email",validate:E.validateEmail,error:x.default.t(881),onSave:e=>b("customerCareDetails","email",e)}),(0,j.jsx)(T,{value:null==D?void 0:D.mobileNumber,maxLength:f.default.COMPLIANCE_INFO_LENGTH.MOBILE_NUMBER,placeholder:x.default.t(393),icon:"phone",validate:L,error:x.default.t(396),onSave:e=>b("customerCareDetails","mobileNumber",e)}),(0,j.jsx)(T,{value:null==D?void 0:D.landlineNumber,maxLength:f.default.COMPLIANCE_INFO_LENGTH.LANDLINE_NUMBER,placeholder:x.default.t(392),icon:"phone",validate:L,error:x.default.t(395),onSave:e=>b("customerCareDetails","landlineNumber",e)})]}),(0,j.jsxs)(_.default,{title:x.default.t(397),theme:"form",children:[(0,j.jsx)(T,{value:null==O?void 0:O.name,maxLength:f.default.COMPLIANCE_INFO_LENGTH.GRIEVANCE_OFFICER_NAME,placeholder:x.default.t(401),icon:"assignment-ind",onSave:e=>b("grievanceOfficerDetails","name",e)}),(0,j.jsx)(T,{value:null==O?void 0:O.email,maxLength:f.default.COMPLIANCE_INFO_LENGTH.EMAIL,placeholder:x.default.t(398),icon:"business-email",validate:E.validateEmail,error:x.default.t(881),onSave:e=>b("grievanceOfficerDetails","email",e)}),(0,j.jsx)(T,{value:null==O?void 0:O.mobileNumber,maxLength:f.default.COMPLIANCE_INFO_LENGTH.MOBILE_NUMBER,placeholder:x.default.t(400),icon:"phone",validate:L,error:x.default.t(396),onSave:e=>b("grievanceOfficerDetails","mobileNumber",e)}),(0,j.jsx)(T,{value:null==O?void 0:O.landlineNumber,maxLength:f.default.COMPLIANCE_INFO_LENGTH.LANDLINE_NUMBER,placeholder:x.default.t(399),icon:"phone",validate:L,error:x.default.t(395),onSave:e=>b("grievanceOfficerDetails","landlineNumber",e)})]})]})})]})})}));function T({value:e="",maxLength:t,placeholder:s,icon:a,isLoading:i=!1,validate:n,error:l,onSave:d,onFocus:c}){const[h,f]=(0,r.useState)(e),[p,m]=(0,r.useState)(l),[g,_]=(0,r.useState)(i);return(0,r.useEffect)((()=>{f(e)}),[e]),(0,r.useEffect)((()=>{(null==n?void 0:n(h))&&m(null)}),[h,n,l]),(0,r.useEffect)((()=>{_(i)}),[i]),(0,j.jsx)(C.default,{icon:a,theme:C.IconSectionTheme.NoMargin,content:(0,j.jsx)(S.default,{value:h,editable:!0,maxLength:t,pending:g,inputPlaceholder:s,showRemaining:!0,validate:n,error:p,onChange:f,onSave:(0,o.default)((function*(){_(!0);try{yield null==d?void 0:d(h)}catch(e){l&&(m(l),u.default.openToast((0,j.jsx)(y.default,{id:(0,y.genId)(),msg:l})))}_(!1)})),onCancel:()=>f(e),onError:()=>{m(l)},theme:"text-input",onFocus:c,lockable:!0})})}},58716:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(s(91952)),n=a(s(17025)),o=a(s(18670)),l=s(62238),r=a(s(99942)),d=a(s(2408)),c=a(s(91142)),u=a(s(63982)),h=s(85893);class f extends r.default{constructor(...e){super(...e),this.onClick=(e,t)=>{(0,l.findChat)(t.id).then(i.default.openChatFromUnread.bind(i.default)),this.end()},this.onNewGroup=()=>{this.push((0,h.jsx)(u.default,{onBack:this.pop,onContinue:this.onSetGroupInfo}))},this.onSetGroupInfo=e=>{this.push((0,h.jsx)(c.default,{participants:e,onBack:()=>{this.popAndUpdate({participants:e})},onContinue:this.end}))}}componentDidMount(){n.default.ensureSorted(),this.push((0,h.jsx)(o.default,{title:d.default.t(1369),onBack:this.end,onClick:this.onClick,onNewGroup:this.onNewGroup}))}}t.default=f},44692:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(s(17025)),n=a(s(99942)),o=a(s(91142)),l=a(s(63982)),r=s(85893);class d extends n.default{constructor(...e){super(...e),this.onSetGroupInfo=e=>{this.push((0,r.jsx)(o.default,{participants:e,onBack:()=>{this.popAndUpdate({participants:e})},onContinue:this.end}))}}componentDidMount(){i.default.ensureSorted(),this.push((0,r.jsx)(l.default,{onBack:this.end,onContinue:this.onSetGroupInfo}))}}t.default=d},48105:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=b;var i=a(s(81109)),n=a(s(48926)),o=s(67294),l=a(s(8581)),r=a(s(17663)),d=a(s(64305)),c=a(s(70458)),u=a(s(17025)),h=a(s(79864)),f=a(s(99942)),p=s(78615),m=s(30333),g=a(s(79354)),_=s(70790),v=a(s(35154)),C=a(s(7127)),x=a(s(83153)),S=a(s(27370)),y=a(s(36873)),E=a(s(22685)),j=a(s(64883)),I=s(89573),M=s(85893);class T extends f.default{constructor(...e){var t;super(...e),t=this,this.scrollOffset=0,this.setScrollOffset=e=>{this.scrollOffset=e},this.onCollectionSeeAll=e=>{const{catalogOwnerJid:t,chat:s,product:a,productInfo:i,sellerJid:n}=this.props,o=t||(null==a?void 0:a.catalogWid.toString())||(null==i?void 0:i.businessOwnerJid)||n;this.push((0,M.jsx)(b,{chat:s,catalogOwnerJid:o,collection:e,isAllItems:!e}))},this._pushProductDetails=(e,t)=>{const{chat:s,refreshCarousel:a}=this.props,i=(0,M.jsx)(v.default,{chat:s,product:e,onEnd:this._end,onBack:this._popAndUpdate,onProductDetail:this.onProductDetail,onProductCatalog:this.onProductCatalogHeaderClick,onProductLinkClick:this._onProductLinkClick,onProductMoreInformation:this.onProductMoreInformation,refreshCarousel:a,onCartClick:this._onCartClick,collectionId:t});this.push(i)},this._pushProductMoreInformation=e=>{const t=(0,M.jsx)(E.default,{product:e,onBack:this._popAndUpdate});this.push(t)},this._pushProductDetailsWithDeepLink=e=>{const t=(0,M.jsx)(C.default,{chat:this.props.chat,productInfo:e,onEnd:this._end,onBack:this._pop,onProductDetail:this.onProductDetail,onProductCatalog:this.onProductCatalogHeaderClick,onProductLinkClick:this._onProductLinkClick,onProductMoreInformation:this.onProductMoreInformation,onCartClick:this._onCartClick});this.push(t)},this.pushProductCatalog=function(){var e=(0,n.default)((function*(e){const s=u.default.gadd(e),a=yield l.default.find(e),i=(0,p.canViewCollections)()?(0,M.jsx)(d.default,{contact:s,onProductDetail:t.onProductDetail,catalogId:e,onBack:t._pop,businessProfile:a,scrollOffset:t.scrollOffset,setScrollOffset:t.setScrollOffset,onCatalogLinkClick:t._onCatalogLinkClick,onCartClick:t._onCartClick,onCollectionSeeAll:t.onCollectionSeeAll}):(0,M.jsx)(S.default,{contact:s,onProductDetail:t.onProductDetail,catalogId:e,onBack:t._pop,businessProfile:a,setScrollOffset:t.setScrollOffset,onCatalogLinkClick:t._onCatalogLinkClick,onCartClick:t._onCartClick});t.push(i)}));return function(){return e.apply(this,arguments)}}(),this._pushOrderDetail=(e,t,s,a)=>{const i=(0,M.jsx)(g.default,{orderId:e,token:t,sellerJid:s,userIsCartOwner:a,onProductDetail:this._onProductDetailFromInfo});this.push(i)},this._pushProductList=(e,t)=>{const s=u.default.gadd(t),a=(0,M.jsx)(y.default,{contact:s,productListId:e,onProductDetail:this.onProductDetail,onCartClick:this._onCartClick,onBack:this._pop,onEnd:this._end,setScrollOffset:this.setScrollOffset});this.push(a)},this.onProductDetail=(e,t)=>{this._pushProductDetails(e,t)},this.onProductMoreInformation=e=>{this._pushProductMoreInformation(e)},this._onProductDetailFromInfo=e=>{this._pushProductDetailsWithDeepLink(e)},this.onProductCatalogHeaderClick=(e,t)=>{(0,m.logCarouselViewMoreClick)({catalogOwnerWid:e,catalogContext:t}),this.pushProductCatalog(e)},this._onProductLinkClick=e=>{this.push((0,M.jsx)(x.default,{product:e,onBack:this._pop}))},this._onCatalogLinkClick=(e,t)=>{this.push((0,M.jsx)(r.default,{catalog:e,contact:t,onBack:this._pop}))},this._onCartClick=e=>{const t=(0,_.getProductCatalogContext)(this.props.context),s=(0,j.default)(e,this.props.chat,t);s&&this.push(s)},this._pop=()=>{this.pop()},this._end=()=>{this.end(!0)},this._popAndUpdate=()=>{this.popAndUpdate({scrollOffset:this.scrollOffset})}}componentDidMount(){const{catalogOwnerJid:e,orderId:t,product:s,productInfo:a,productListId:i,collection:n,collectionId:o,isAllItems:l,token:r,sellerJid:d,userIsCartOwner:c}=this.props;if(e)n||l?this.pushCollectionContent((0,I.createWid)(e)):null!=i?this._pushProductList(i,(0,I.createWid)(e)):this.pushProductCatalog((0,I.createWid)(e));else if(s)this._pushProductDetails(s,o);else if(a)this._pushProductDetailsWithDeepLink(a);else{if(!t)throw new Error("ProductDetailsFlow:no-product");null!=r&&null!=d&&null!=c&&this._pushOrderDetail(t,r,d,c)}}pushCollectionContent(e){const t=u.default.gadd(e);this.push((0,M.jsx)(c.default,{contact:t,onProductDetail:this.onProductDetail,catalogId:e,onBack:this._pop,onCatalogLinkClick:this._onCatalogLinkClick,onCartClick:this._onCartClick,scrollOffset:this.scrollOffset,setScrollOffset:this.setScrollOffset,collection:this.props.collection}))}}function b(e){const t=(0,o.useContext)(h.default);return(0,M.jsx)(T,(0,i.default)({context:t},e))}},25571:(e,t,s)=>{"use strict";var a=s(20862),i=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(s(81109)),o=i(s(99942)),l=i(s(2408)),r=a(s(57774)),d=i(s(16875)),c=i(s(65565)),u=s(85893);class h extends o.default{constructor(...e){super(...e),this._handleForwardConfirmed=e=>{0===e.length&&this.end(),this._chatsToForwardTo=e,this._sendContactToChats(e)},this._sendContactToChats=e=>{for(const t of e)(0,d.default)(this.props.contacts,t),t.composeQuotedMsg=null;this.props.onContactsSent(e[0]),this.end()},this._popNone=()=>{this.pop("none")},this._handleCancel=()=>{this.end()}}componentDidMount(){const e=null==this.props.maxItems?this.props.serverProps.maxParticipants:this.props.maxItems;this.push((0,u.jsx)(r.default,{onConfirm:this._handleForwardConfirmed,maxItems:e,title:l.default.t(1601),listType:r.ListType.CHAT_SELECT_MODAL,onCancel:this._handleCancel}))}}t.default=e=>(0,u.jsx)(h,(0,n.default)((0,n.default)({},e),{},{serverProps:c.default}))},57825:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t;const{chat:s}=e,a=(0,i.default)(null===(t=s.groupMetadata)||void 0===t?void 0:t.groupInviteLink,"chat.groupMetadata?.groupInviteLink"),r=`${n.default.t(1e3)} ${a}`;return(0,l.jsx)(o.default,{title:n.default.t(979),text:r,pushTransition:"none",popTransition:"none"})};var i=a(s(7900)),n=a(s(2408)),o=a(s(24024)),l=s(85893)},45510:(e,t,s)=>{"use strict";var a=s(20862),i=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(s(81109)),o=s(38512),l=i(s(91952)),r=i(s(99942)),d=i(s(2408)),c=a(s(57774)),u=s(30239),h=i(s(65565)),f=s(85893);class p extends r.default{constructor(...e){super(...e),this.onForwardConfirmed=e=>{const t=this.props.msgText;if(1===e.length){let s;const a=e[0];s=a.isUser&&a.contact.isBlocked()?(0,o.unblockContact)(a.contact):Promise.resolve(!0),s.then((()=>{if(t){if(a.urlText=this.props.urlText,a.active)return void l.default.pasteChatTextInput(a,t);a.setComposeContents({text:t})}return l.default.openChatFromUnread(a).then((e=>{e&&l.default.focusChatTextInput(a)}))}))}else Promise.all(e.map((e=>{let s;s=e.isUser&&e.contact.isBlocked()?(0,o.unblockContact)(e.contact):Promise.resolve(!0),s.then((()=>{e.urlText=this.props.urlText,(0,u.sendTextMsgToChat)(e,t)}))}))),l.default.openChatFromUnread(e[0]);this.end()}}componentDidMount(){this.push((0,f.jsx)(c.default,{onConfirm:this.onForwardConfirmed,maxItems:this.props.serverProps.multicastLimitGlobal,title:d.default.t(1279),listType:c.ListType.CHAT_SELECT_MODAL}))}}t.default=e=>(0,f.jsx)(p,(0,n.default)((0,n.default)({},e),{},{serverProps:h.default}))},1483:(e,t,s)=>{"use strict";var a=s(20862),i=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(s(48926)),o=s(38512),l=i(s(91952)),r=i(s(55454)),d=i(s(99942)),c=i(s(2408)),u=a(s(57774)),h=i(s(65565)),f=s(85893);class p extends d.default{constructor(...e){var t;super(...e),t=this,this._handleForwardConfirmed=e=>{e.forEach(function(){var e=(0,n.default)((function*(e){e.isUser&&e.contact.isBlocked()&&(yield(0,o.unblockContact)(e.contact)),t._sendProduct(e)}));return function(){return e.apply(this,arguments)}}()),this.end(),1===e.length&&(l.default.openChatFromUnread(e[0]),window.innerWidth<=r.default.LAYOUT_2COLUMNS_MAX_WIDTH&&l.default.closeDrawerRight()),this.props.onSend&&this.props.onSend()},this._handleCancel=()=>{this.end()},this._sendProduct=e=>{const{product:t}=this.props;l.default.once("ui_idle",(()=>{e.sendProductMessage(t)}))}}componentDidMount(){l.default.closeContextMenu(),l.default.closeTooltip(),this.push((0,f.jsx)(u.default,{onConfirm:this._handleForwardConfirmed,maxItems:h.default.multicastLimitGlobal,title:c.default.t(1279),listType:u.ListType.CHAT_SELECT_MODAL,onCancel:this._handleCancel}))}}t.default=p},55310:(e,t,s)=>{"use strict";var a=s(20862),i=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(s(53427)),o=i(s(33322)),l=a(s(28047)),r=i(s(91952)),d=i(s(9322)),c=i(s(17025)),u=i(s(99942)),h=s(86723),f=i(s(50792)),p=i(s(53683)),m=i(s(64170)),g=i(s(88616)),_=i(s(2606)),v=i(s(3165)),C=i(s(87947)),x=i(s(24148)),S=i(s(22360)),y=i(s(63252)),E=i(s(12824)),j=i(s(7883)),I=s(85893);class M extends u.default{constructor(...e){super(...e),this._showWallpaperDrawer=()=>{this.push((0,I.jsx)(E.default,{onClose:this._pop}))},this._showArchiveSettingsDrawer=()=>{this.push((0,I.jsx)(n.default,{settings:C.default,onClose:this._pop}))},this._showBlockedDrawer=()=>{this.push((0,I.jsx)(o.default,{onClose:this._pop}))},this._showProfileDrawer=()=>{const e=(0,h.getMaybeMeUser)(),t=S.default.assertGet(e),s=v.default.assertGet(e),a=c.default.assertGet(e);this.push((0,I.jsx)(_.default,{status:t,profilePicThumb:s,contact:a,conn:d.default,onClose:this._pop}))},this._showNotifications=()=>{this.push((0,I.jsx)(g.default,{onClose:this._pop}))},this._showMediaAutoDownload=()=>{this.push((0,I.jsx)(m.default,{onClose:this._pop}))},this._showSecurity=()=>{this.push((0,I.jsx)(j.default,{onClose:this._pop}))},this._showHelp=()=>{l.upload({reason:"help-page-opened",isHighPri:!0}),this.push((0,I.jsx)(f.default,{onClose:this._pop}))},this._showThemePopup=()=>{r.default.openModal((0,I.jsx)(y.default,{}))},this.showKeyboardShortcuts=()=>{r.default.openModal((0,I.jsx)(p.default,{}))},this._pop=()=>{this.pop()}}componentDidMount(){this.push((0,I.jsx)(x.default,{profileId:(0,h.getMaybeMeUser)(),onWallpaper:this._showWallpaperDrawer,onBlocked:this._showBlockedDrawer,onProfile:this._showProfileDrawer,onNotifications:this._showNotifications,onMediaAutoDownload:this._showMediaAutoDownload,onSecurity:this._showSecurity,onHelp:this._showHelp,onThemeSettings:this._showThemePopup,onKeyboardShortcuts:this.showKeyboardShortcuts,onClose:this._pop,settings:C.default,onArchiveSettings:this._showArchiveSettingsDrawer}))}}t.default=M},38992:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(s(91952)),n=a(s(99942)),o=a(s(71681)),l=a(s(67315)),r=a(s(44519)),d=s(85893);class c extends n.default{constructor(...e){super(...e),this.sessionId=Math.round(1e9*Math.random()),this._openStatusViewer=(e,t,s)=>{this.push((0,d.jsx)(r.default,{initialStatusV3:e,initialStatusMsg:t,closeStatusViewer:this.closeStatusViewer,sessionId:this.sessionId,rowIdx:s}),"none")},this.closeStatusViewer=e=>{e?this.end():this.pop("none")}}componentDidMount(){this.push((0,d.jsx)(l.default,{onOpenStatus:this._openStatusViewer,closeStatusViewer:this.closeStatusViewer,sessionId:this.sessionId}),"status-v3-modal"),this.props.listeners.add(i.default,"close_status_viewer",(()=>{this.closeStatusViewer(!0)}))}componentWillUnmount(){this.props.onFlowEnd()}}var u=(0,o.default)(c);t.default=u},16909:(e,t,s)=>{"use strict";var a=s(20862),i=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=s(67294),o=i(s(55092)),l=i(s(85051)),r=s(78615),d=i(s(2408)),c=i(s(59606)),u=a(s(84498)),h=i(s(71681)),f=s(85893);class p extends n.PureComponent{constructor(...e){super(...e),this._updateLabels=()=>{this.forceUpdate()}}componentDidMount(){this.props.listeners.add(c.default,`label_updated_${this.props.label}`,this._updateLabels)}render(){const{label:e}=this.props,t=c.default.get(e);if(!t||!t.name)return null;if("label-list"===this.props.theme){const s=(0,f.jsx)(u.default,{renderAsCircle:"label-list"===this.props.theme,theme:this.props.theme,labels:[e]}),a=(0,f.jsx)(l.default,{text:t.name,ellipsify:!0,titlify:!0});return(0,f.jsx)(o.default,{theme:(0,r.canEditLabel)()?"chat-checkbox":void 0,image:s,primary:a,secondary:d.default.t(1092,{count:parseInt(t.count||0,10),_plural:parseInt(t.count||0,10)})})}{const e=(0,u.renderLabelSvg)(t.hexColor),s=(0,f.jsx)(l.default,{text:t.name,ellipsify:!0,titlify:!0});return(0,f.jsx)(o.default,{theme:"label-selection",image:e,primary:s})}}}p.displayName="LabelListItem";var m=(0,h.default)(p);t.default=m},99385:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(67294),n=a(s(46806)),o=a(s(12950)),l=s(78615),r=a(s(59606)),d=a(s(16909)),c=a(s(71681)),u=a(s(23721)),h=s(85893);class f extends i.PureComponent{constructor(){super(),this._refLastLabel=null,this.updateData=(e,t,s)=>{const{shouldScrollIntoViewAndSelect:a}=this.props;this.setState({labels:r.default.toArray()},(()=>{if(s.add&&a){const{shouldScrollIntoView:t,shouldSelect:s}=a(e.name);t&&this._refLastLabel&&this._refLastLabel.scrollIntoView({behavior:"smooth"}),s&&this.onMultiSelect(e,!0,!1)}}))},this._setRefLastLabel=e=>{this._refLastLabel=e},this.onMultiSelect=(e,t,s)=>{const{selectedLabels:a,onMultiSelect:i}=this.props;a&&a.setVal(e,t,s),i&&i(e.id)},this._renderLabelRow=()=>{const{renderContext:e,onLabelClick:t,initialLabelState:s={}}=this.props,a=this.props.SelectableState||new u.default(!0),i=o.default.supportsFeature(o.default.F.MD_BACKEND)?[...this.state.labels].sort(((e,t)=>{const s=parseInt(e.id,10),a=parseInt(t.id,10);return isNaN(s)||isNaN(a)?0:s-a})):this.state.labels;return i.reduce(((o,c,u)=>{const f=r.default.assertGet(c.id);if(!c.name)return o;const p="label-selection"===e||(0,l.canEditLabel)()?(0,h.jsx)(n.default,{theme:e,model:f,initialSelection:s[c.id]||0,multiSelection:this.props.selectedLabels,selectableState:a,onSelect:this.onMultiSelect,children:(0,h.jsx)(d.default,{label:c.id})}):(0,h.jsx)(d.default,{label:c.id,theme:e});return[...o,(0,h.jsx)("div",{ref:u===i.length-1?this._setRefLastLabel:()=>{},onClick:t?t.bind(null,c.id):()=>{},children:p},`label_item_${c.id}`)]}),[])},this.state={labels:r.default.toArray()}}componentDidMount(){this.props.listeners.add(r.default,"add remove",this.updateData)}render(){return(0,h.jsx)("div",{children:this._renderLabelRow()})}}f.displayName="MultiSelectLabelList";var p=(0,c.default)(f);t.default=p},78418:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"LiveLocationDrawer",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(t,"ExpiredLocationDrawer",{enumerable:!0,get:function(){return n.default}});var i=a(s(32129)),n=a(s(82701))},83952:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.openMerchantDetailsFormFlow=function(){const e=(0,l.getMeUser)();n.default.openDrawerLeft((0,c.jsx)(h,{contactId:e}))},t.default=t.requireBundle=void 0;var i=a(s(68356)),n=a(s(91952)),o=a(s(55454)),l=s(86723),r=a(s(6615)),d=a(s(33961)),c=s(85893);const u=(0,d.default)((()=>Promise.all([s.e(8295),s.e(1702),s.e(9488),s.e(275)]).then(s.bind(s,76820)).then((e=>e.default))),"MerchantDetailsFormFlow");t.requireBundle=u;const h=(0,i.default)({loader:u,loading:e=>(0,c.jsx)(r.default,{error:Boolean(e.error)}),delay:o.default.LOADABLE_DELAY});var f=h;t.default=f},26785:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CanvasContext=void 0;const a={transforming:!1,dragging:!1,editing:!1},i=(0,s(67294).createContext)(a);t.CanvasContext=i},1590:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.CanvasLayer=function({layer:e,scale:t,editing:s,selected:a,editable:v,textBackgroundShadow:C,paintCanvasRef:x,selectedGroupRef:S,transformerRef:y,stageWidth:E,stageHeight:j,onSelect:I,onDoubleClick:M,onDragStart:T,onDragEnd:b,onDragMove:P,onTransformStart:L,onTransformEnd:w}){const[D,O]=(0,i.useState)(!1),N=(0,i.useContext)(n.CanvasContext);let R,k,A,F;v&&a&&!s&&(k=(0,g.jsx)(f.default,{layer:e}),F=(0,g.jsx)(h.Transformer,{ref:y,anchorStroke:"blue",anchorFill:"white",anchorSize:8,anchorCornerRadius:4,borderEnabled:!1,centeredScaling:!0,enabledAnchors:["bottom-right"],resizeEnabled:!0,rotateAnchorOffset:12,rotateEnabled:!0,rotationSnaps:_,ignoreStroke:!0,rotationSnapTolerance:10,boundBoxFunc:(s,a)=>{const i=a.width/t,n=a.height/t;return e instanceof m.default&&(i<=18||n<=18)||i<=36||n<=36?s:a}},"transformer"));v&&D&&!a&&(A=(0,g.jsx)(o.default,{layer:e}));e instanceof r.default?R=(0,g.jsx)(l.default,{layer:e}):e instanceof c.default?R=(0,g.jsx)(u.default,{ref:x,layer:e}):e instanceof m.default&&!s&&(R=(0,g.jsx)(p.default,{layer:e,shadow:C}));(0,i.useEffect)((()=>{s&&O(!1)}),[s,O]);const B=e.frame.getCenter();return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsxs)(h.Group,{ref:a?S:null,x:B.x,y:B.y,offsetX:e.width/2,offsetY:e.height/2,width:e.width,height:e.height,rotation:e.rotation,scaleX:e.scale,scaleY:e.scale,draggable:v,dragBoundFunc:e=>{let{x:t,y:s}=e;return t<0?t=0:t>E&&(t=E),s<0?s=0:s>j&&(s=j),{x:t,y:s}},onMouseEnter:t=>{!e.editable||N.dragging||N.transforming||(t.cancelBubble=!0,O(!0))},onMouseLeave:t=>{e.editable&&(t.cancelBubble=!0,O(!1))},onMouseDown:t=>{e.editable&&(t.cancelBubble=!0,I(e))},onDblClick:()=>M(e),onDragStart:()=>T(e),onDragEnd:t=>{const s=(0,d.getPointFromGroup)(t);b(e,s)},onDragMove:t=>P(e,t),onTransformStart:()=>L(e),onTransformEnd:t=>{if(!a)return;const s=(0,d.getRotationFromGroup)(t),i=(0,d.getScaleFromGroup)(t);w(e,s,i)},children:[R,k,A]}),F]})};var i=s(67294),n=s(26785),o=a(s(68327)),l=a(s(63856)),r=a(s(85499)),d=s(40302),c=a(s(32582)),u=a(s(61577)),h=s(47971),f=a(s(6650)),p=a(s(10456)),m=a(s(4301)),g=s(85893);const _=[0,45,90,135,180,225,270,315]},89067:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.EditableText=void 0;var i=a(s(81109)),n=a(s(18446)),o=s(67294),l=s(9492),r=a(s(54115)),d=a(s(96962)),c=a(s(91137)),u=s(57528),h=a(s(2408)),f=a(s(2966)),p=s(56130),m=a(s(63477)),g=a(s(68062)),_=a(s(51402)),v=a(s(35523)),C=a(s(82275)),x=s(85893);const S=1.2,y=(0,d.default)(),E=(0,o.forwardRef)((({text:e,layer:t,layerCenter:s,scale:a,onSave:d,onUnselect:p,onOutsideClick:E},M)=>{const[T,b]=(0,o.useState)(e),[P,L]=(0,o.useState)(),w=(0,o.useRef)(),D=(0,o.useCallback)((()=>{d(T.replace(/^\n+/,"").replace(/\n+$/,""))}),[d,T]);(0,o.useImperativeHandle)(M,(()=>({save:()=>{D(),p()}})),[D,p]);const O=(0,_.default)((e=>{P||!1===(null==E?void 0:E(e))||(D(),p())})),N=e=>{const t=w.current;t&&t.replaceSelection(e)},R=()=>{L(null)},[k,A]=(0,C.default)((e=>{L({menu:(0,x.jsx)(c.default,{onEmoji:N,onFocusNext:R,onFocusPrev:R}),anchor:e.target})}));(0,o.useEffect)((()=>{var e,t;null===(e=w.current)||void 0===e||null===(t=e.refInput)||void 0===t||t.focus()}),[]);const F={borderWidth:2,padding:t.styles.layerPadding-2,transform:"scale(1.2)"},B={left:s.x*a,top:s.y*a},U={color:t.textColor.toHex(),fontFamily:(0,u.getFontStyle)(t.font).fontFamily,fontSize:t.fontSize,lineHeight:`${t.lineHeight+2*t.styles.lineVerticalPadding}px`,textAlign:j(t.alignment),paddingLeft:t.styles.lineHorizontalPadding,paddingRight:t.styles.lineHorizontalPadding,borderWidth:0,borderRadius:5,margin:0,boxSizing:"border-box",backgroundColor:t.textBackground?t.textBackgroundColor.toHex():void 0},G=t.styles.backgroundShadow,H={boxShadow:t.textBackground?`${G.offsetX}px ${G.offsetY}px ${G.radius}px ${G.spread}px ${G.color.toRgbaString()}`:void 0},V=function(e){const t=(0,v.default)(e),s=(0,o.useRef)(0);t&&!(0,n.default)(t,e)&&(s.current+=1);return s.current}(U),W=(0,i.default)((0,i.default)({},U),{},{fontSize:15,paddingRight:8,fontFamily:void 0}),z=20-t.fontSize,K=t.styles.lineVerticalPadding-z,Y=`\n    .${r.default.inputContainer} .emoji.emoji.emoji {\n      margin: ${K}px ${-z/2}px 0 ${-z/2}px;\n      transform: scale(${t.fontSize/20});\n    }\n  `;return(0,x.jsxs)("div",{className:r.default.positioner,style:B,children:[(0,x.jsxs)("div",{className:r.default.container,style:F,children:[(0,x.jsx)("style",{children:Y}),(0,x.jsxs)("div",{className:r.default.resizableInput,ref:O,children:[(0,x.jsx)("div",(0,i.default)((0,i.default)({className:r.default.emojiButton},A),{},{ref:k,style:{transform:`scale(${1/S}) translateX(-60%)`,top:-37.666666666666664},children:(0,x.jsx)("div",{className:r.default.buttonIconWrapper,children:(0,x.jsx)(f.default,{name:"smiley"})})})),(0,x.jsx)("div",{className:r.default.inputContainer,style:H,children:(0,x.jsx)(y,{style:U,ref:w,initialValue:T,onChange:e=>{let t=e;t=e.match(/\n\n$/)?t.replace(/\n\n$/,"\n"):t.replace(/\n$/,""),b(t)},onEnter:D,multiline:!0,theme:"media-editor-text-input",placeholder:h.default.t(1204)},V)}),(0,x.jsx)(I,{layer:t,text:T||h.default.t(1204),style:T?U:W})]})]}),P&&(0,x.jsx)(m.default,{displayName:"EmojiPicker",escapable:!0,popable:!0,requestDismiss:R,children:(0,x.jsx)(g.default,{contextMenu:(0,i.default)({dirY:l.DirY.TOP,type:"emoji_picker"},P)})})]})}));function j(e){switch(e){case u.TextAlignment.LEFT:return"left";case u.TextAlignment.CENTER:return"center";case u.TextAlignment.RIGHT:return"right"}}function I({text:e,style:t,layer:s}){return(0,x.jsx)("div",{className:r.default.hiddenText,style:t,children:(0,p.getLines)(e,s.font,s.fontSize,0).map(((e,t)=>(0,x.jsx)("div",{className:r.default.hiddenTextLine,children:0===e.words.length?" ":e.words.map(((e,t)=>e.emojiPath?(0,x.jsx)("span",{className:r.default.emojiPlaceholder},t):e.text))},t)))})}t.EditableText=E},68327:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function({layer:e}){const t=e instanceof n.default&&e.isSticker();return(0,l.jsx)(o.Rect,{width:e.width,height:e.height,stroke:r.toRgbaString(),strokeWidth:2,cornerRadius:t?40:5,strokeScaleEnabled:!1})};var i=a(s(33845)),n=a(s(85499)),o=s(47971),l=s(85893);const r=new i.default(82,248,24,1)},63856:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{layer:t}=e;return(0,i.jsx)(a.Image,{width:t.width,height:t.height,image:t.image})};var a=s(47971),i=s(85893)},64193:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(s(81109)),n=a(s(18446)),o=s(67294),l=s(26785),r=s(1590),d=a(s(33845)),c=s(89067),u=a(s(63856)),h=s(40302),f=a(s(14219)),p=s(47971),m=a(s(4301)),g=s(45139),_=s(85893);const v="#52F818";class C extends o.Component{constructor(...e){super(...e),this.state={guides:{horizontal:null,vertical:null},dragging:!1},this._setRefStage=e=>{this._refStage=e},this._setRefSelectedGroup=e=>{this._refSelectedGroup=e},this._setRefTransformer=e=>{this._refTransformer=e},this._setRefGuidesLayer=e=>{this._refGuidesLayer=e},this._refPaintCanvas=(0,o.createRef)(),this._refPaintOverlay=(0,o.createRef)(),this._refEditableText=(0,o.createRef)(),this._canvasContext={dragging:!1,transforming:!1,editing:!1},this._hideEditingState=()=>{var e,t,s,a,i,n,o,l,r;null===(e=this._refTransformer)||void 0===e||e.hide(),null===(t=this._refSelectedGroup)||void 0===t||null===(s=t.getChildren()[1])||void 0===s||s.hide(),null===(a=this._refSelectedGroup)||void 0===a||null===(i=a.getChildren()[2])||void 0===i||i.hide(),null===(n=this._refGuidesLayer)||void 0===n||n.hide(),null===(o=this._refPaintOverlay.current)||void 0===o||o.toggleCursor(!1),null===(l=this._refTransformer)||void 0===l||null===(r=l.getLayer())||void 0===r||r.batchDraw()},this._showEditingState=()=>{var e,t,s,a,i,n,o,l,r;null===(e=this._refTransformer)||void 0===e||e.show(),null===(t=this._refSelectedGroup)||void 0===t||null===(s=t.getChildren()[1])||void 0===s||s.show(),null===(a=this._refSelectedGroup)||void 0===a||null===(i=a.getChildren()[2])||void 0===i||i.show(),null===(n=this._refGuidesLayer)||void 0===n||n.show(),null===(o=this._refPaintOverlay.current)||void 0===o||o.toggleCursor(!0),null===(l=this._refTransformer)||void 0===l||null===(r=l.getLayer())||void 0===r||r.batchDraw()},this._handleMouseDown=e=>{this.props.currentlyEditingTextLayer||(0,h.isEventOnAnchor)(e)||this.props.onLayerUnselect()},this._handleDragStart=()=>{this._canvasContext.dragging=!0,this.setState({dragging:!0})},this._handleDragEnd=(e,t)=>{this._canvasContext.dragging=!1,this.props.onLayerTranslate(e,t),this.setState({guides:{vertical:null,horizontal:null},dragging:!1})},this._handleTransformStart=()=>{this._canvasContext.transforming=!0},this._handleTransformEnd=(e,t,s)=>{this._canvasContext.transforming=!1,this.props.onLayerTransform(e,t,s)},this._handleDragMove=(e,t)=>{var s,a,i,o;const l=[{position:this.getStage().width()/2,orientation:"v"},{position:this.getStage().height()/2,orientation:"h"}],r=t.target,d=r.absolutePosition(),c=[{position:d.y,orientation:"h"},{position:d.x,orientation:"v"}],u=[];for(const e of c)for(const t of l){if(e.orientation!==t.orientation)continue;const s=Math.abs(t.position-e.position);s<=15&&u.push({guide:t,distance:s})}u.sort(((e,t)=>e.distance-t.distance));let h=null,f=null;for(const{guide:e}of u)"v"!==e.orientation||h?"h"!==e.orientation||f||(f=e):h=e;r.absolutePosition({x:null!==(s=null===(a=h)||void 0===a?void 0:a.position)&&void 0!==s?s:d.x,y:null!==(i=null===(o=f)||void 0===o?void 0:o.position)&&void 0!==i?i:d.y});const p={horizontal:f,vertical:h};(0,n.default)(this.state.guides,p)||this.setState({guides:p})},this._handleDoubleClick=e=>{e instanceof m.default&&this.props.onTextEditingStart(e)},this._handleTextSave=e=>{this.props.draftTextLayer&&this.props.onTextEditingEnd(this.props.draftTextLayer,e)},this._handleSelect=e=>{this.props.onLayerSelect(e)},this._renderEditableText=()=>{const{draftTextLayer:e}=this.props;if(!e)return null;const t=this.props.data.toScreenPoint(e.frame.getCenter());return(0,_.jsx)(c.EditableText,{ref:this._refEditableText,layer:e,layerCenter:t,text:e.text,scale:this.props.scale,onSave:this._handleTextSave,onUnselect:this.props.onLayerUnselect,onOutsideClick:this.props.onTextInputOutsideClick})},this._renderLayer=e=>{const{data:t}=this.props,{currentlyEditingTextLayer:s}=this.props,a=t.selectedLayer===e&&s!==e,i=this.props.scale,n=this.props.data.screenWidth*i,o=this.props.data.screenHeight*i,l=e.editable&&this.props.canEditLayer&&!this.props.inPaintMode&&!this.props.currentlyEditingTextLayer;return(0,_.jsx)(r.CanvasLayer,{layer:e,scale:i,textBackgroundShadow:!this.state.dragging,editing:s===e,selected:a,editable:l,stageHeight:o,stageWidth:n,selectedGroupRef:this._setRefSelectedGroup,paintCanvasRef:this._refPaintCanvas,transformerRef:this._setRefTransformer,onSelect:this._handleSelect,onDoubleClick:this._handleDoubleClick,onDragMove:this._handleDragMove,onDragStart:this._handleDragStart,onDragEnd:this._handleDragEnd,onTransformStart:this._handleTransformStart,onTransformEnd:this._handleTransformEnd},String(e.id))}}componentDidUpdate(){var e,t,s;this._refSelectedGroup&&(null===(e=this._refTransformer)||void 0===e||e.nodes([this._refSelectedGroup]),null===(t=this._refTransformer)||void 0===t||null===(s=t.getLayer())||void 0===s||s.batchDraw())}getStage(){if(!this._refStage)throw new Error("MediaEditorCanvas:stage is not initialized");return this._refStage.getStage()}getDataUrl(){this._hideEditingState();const e=this.getStage().toDataURL({mimetype:"image/jpeg",quality:1,pixelRatio:1/this.props.scale});return this._showEditingState(),e}endTextEditing(){var e;null===(e=this._refEditableText.current)||void 0===e||e.save()}_renderGuides(){const{vertical:e,horizontal:t}=this.state.guides;if(!e&&!t)return null;const s=this.getStage(),a=this.props.scale;return(0,_.jsxs)(p.Layer,{ref:this._setRefGuidesLayer,children:[e&&(0,_.jsx)(p.Line,{x:e.position/a,y:0,points:[0,0,0,s.height()/a],stroke:v,strokeWidth:1,strokeScaleEnabled:!1},"vertical"),t&&(0,_.jsx)(p.Line,{x:0,y:t.position/a,points:[0,0,s.width()/a,0],stroke:v,strokeWidth:1,strokeScaleEnabled:!1},"horizontal")]},"guides")}render(){var e;const{data:t,inPaintMode:s,paintColor:a,paintThickness:n}=this.props,o=this.props.scale,r=t.screenWidth/2,d=t.screenHeight/2,c=t.toScreenPoint(t.cropCenter),h=t.toScreenPoint(t.canvasCenter),m=r-(c.x-h.x),v=d-(c.y-h.y);return(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(p.Stage,{ref:this._setRefStage,width:t.screenWidth*o,height:t.screenHeight*o,onMouseDown:this._handleMouseDown,scaleX:o,scaleY:o,style:(0,i.default)({cursor:s?"none":"default"},null!==(e=this.props.style)&&void 0!==e?e:{}),children:(0,_.jsxs)(l.CanvasContext.Provider,{value:this._canvasContext,children:[t.background&&(0,_.jsx)(p.Layer,{x:m,y:v,offsetX:t.width/2,offsetY:t.height/2,rotation:t.rotation,children:(0,_.jsx)(u.default,{layer:t.background})},"background"),(0,_.jsxs)(p.Layer,{x:m,y:v,offsetX:t.width/2,offsetY:t.height/2,rotation:t.rotation,children:[t.paintLayer&&this._renderLayer(t.paintLayer),t.layers.map(this._renderLayer)]},"edits"),this._renderGuides(),s&&(0,_.jsx)(f.default,{ref:this._refPaintOverlay,width:t.screenWidth,height:t.screenHeight,pathStyle:{color:a,thickness:(0,g.getThicknessValue)(n)},paintCanvasRef:this._refPaintCanvas,data:t,onDrawEnd:this.props.onDrawEnd})]})}),this._renderEditableText()]})}}t.default=C,C.defaultProps={inPaintMode:!1,paintColor:d.default.White,paintThickness:g.THICKNESS.MEDIUM,canEditLayer:!0,currentlyEditingTextLayer:null,draftTextLayer:null,onLayerSelect:()=>{},onLayerUnselect:()=>{},onLayerTranslate:()=>{},onLayerTransform:()=>{},onTextEditingStart:()=>{},onTextEditingEnd:()=>{},onTextInputOutsideClick:()=>!0,onDrawEnd:()=>{}},C.displayName="MediaEditorCanvas"},61577:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=s(67294),i=s(47971),n=s(85893);var o=(0,a.forwardRef)((function({layer:e},t){const s=(0,a.useMemo)((()=>{const t=document.createElement("canvas");return t.width=Math.max(e.width,1),t.height=Math.max(e.height,1),t}),[e.width,e.height]),o=(0,a.useRef)(),r=(0,a.useRef)(),d=(0,a.useRef)();return(0,a.useEffect)((()=>{var t,a;s.getContext("2d").clearRect(0,0,s.width,s.height),e.paths.forEach((e=>function(e,t){const{points:s}=t;if(!s.length)return;const a=e.getContext("2d"),i={color:t.color,thickness:t.thickness};l(a,i),a.beginPath(),a.moveTo(s[0].x,s[0].y),t.points.slice(1).forEach((e=>a.lineTo(e.x,e.y))),a.stroke()}(s,e))),null===(t=o.current)||void 0===t||null===(a=t.getLayer())||void 0===a||a.batchDraw()}),[e.paths,s]),(0,a.useImperativeHandle)(t,(()=>({startPath(e,t){r.current=e,d.current=t},continuePath(e){const t=r.current;if(t){var a,i;const n=s.getContext("2d"),r=d.current;r&&l(n,r),n.beginPath(),n.moveTo(t.x,t.y),n.lineTo(e.x,e.y),n.stroke(),null===(a=o.current)||void 0===a||null===(i=a.getLayer())||void 0===i||i.batchDraw()}r.current=e},endPath(){r.current=null,d.current=null}})),[s]),(0,n.jsx)(i.Image,{ref:o,width:e.width,height:e.height,image:s})}));function l(e,t){e.lineCap="round",e.lineJoin="round",e.lineWidth=t.thickness,e.strokeStyle=t.color.toHex()}t.default=o},14219:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(s(81109)),n=s(67294),o=s(40302),l=s(47971),r=s(85893);var d=(0,n.forwardRef)((({width:e,height:t,paintCanvasRef:s,pathStyle:a,data:d,onDrawEnd:c},u)=>{const[h,f]=(0,n.useState)(),p=(0,n.useRef)([]),[m,g]=(0,n.useState)(!1),_=(0,n.useRef)();(0,n.useImperativeHandle)(u,(()=>({toggleCursor(e){const t=_.current;t&&(e?t.show():t.hide())}})));const v=e=>{const t=(0,o.getPointFromStage)(e);f(null),e.evt.stopPropagation();const n=s.current;if(n&&0!==p.current.length){const e=d.toCanvasPoint(t);n.endPath(e),p.current.push(e),c((0,i.default)({points:p.current},a)),p.current=[]}};return(0,n.useEffect)((()=>{if(m){const e=()=>{g(!1)};return window.addEventListener("mouseup",e),()=>{window.removeEventListener("mouseup",e)}}}),[m,g]),(0,r.jsxs)(l.Layer,{onMouseDown:e=>{const t=s.current;if(t){const s=(0,o.getPointFromStage)(e),i=d.toCanvasPoint(s);t.startPath(i,a),p.current.push(i),g(!0)}},onMouseEnter:e=>{const t=s.current;if(t&&m){const s=(0,o.getPointFromStage)(e),i=d.toCanvasPoint(s);t.startPath(i,a),p.current.push(i)}},onMouseMove:e=>{const t=(0,o.getPointFromStage)(e);f(t);const a=s.current;if(a&&m){const e=d.toCanvasPoint(t);a.continuePath(e),p.current.push(e)}},onMouseUp:e=>{v(e),g(!1)},onMouseLeave:e=>{v(e)},width:e,height:t,children:[(0,r.jsx)(l.Rect,{width:e,height:t,fill:"rgba(0, 0, 0, 0)"}),h&&(0,r.jsx)(l.Circle,{x:h.x,y:h.y,radius:a.thickness/2,fill:a.color.toRgbaString(),ref:_})]},"paintCursor")}));t.default=d},6650:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function({layer:e}){const t=e instanceof n.default&&e.isSticker();return(0,l.jsx)(l.Fragment,{children:(0,l.jsx)(o.Rect,{width:e.width,height:e.height,fill:d.toRgbaString(),stroke:r.toRgbaString(),strokeWidth:2,cornerRadius:t?40:5,strokeScaleEnabled:!1})})};var i=a(s(33845)),n=a(s(85499)),o=s(47971),l=s(85893);const r=new i.default(82,248,24,1),d=new i.default(82,248,24,.1)},10456:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function({layer:e,shadow:t}){const s=function(e){const t=[];for(const s of e)for(const{emojiPath:e}of s.words)e&&t.push(e);return function(e){const t=[...new Set(e)],s=t.join(""),i=(0,a.useRef)({}),[,n]=(0,a.useState)(0);return(0,a.useEffect)((()=>{i.current={},n(0),t.forEach((e=>{const t=new Image;t.onload=()=>{i.current[e]=t,n(Object.keys(i.current).length)},t.src=e}))}),[n,s]),i.current}(t)}(e.lines),r=t=>{const a=Math.max(...e.lineWidths);let r=0;switch(e.alignment){case i.TextAlignment.LEFT:r=0;break;case i.TextAlignment.CENTER:r=(a-t.width)/2;break;case i.TextAlignment.RIGHT:r=a-t.width}let d=0;return t.words.map((({text:t,emojiPath:a,width:c},u)=>{const h=r+e.styles.lineHorizontalPadding+d,f=e.styles.lineVerticalPadding;let p;if(a){const t=s[a];p=t?(0,l.jsx)(n.Image,{x:h,y:f,width:e.lineHeight,height:e.lineHeight,image:t},u):(0,l.jsx)(n.Rect,{x:h,y:f,width:e.lineHeight,height:e.lineHeight,fill:"rgba(0,0,0,0)"},u)}else{const s=(0,o.getTextBounds)(e.font,e.fontSize);p=(0,l.jsx)(l.Fragment,{children:(0,l.jsx)(n.Text,{x:h,y:f-s.top+(s.top+s.bottom)/2,width:c,height:e.lineHeight,text:t,fill:e.textColor.toHex(),fontFamily:(0,i.getFontStyle)(e.font).fontFamily,fontSize:e.fontSize},u)})}return d+=c,p}))},d=e.lines.map(((t,s)=>{const a=t.width+2*e.styles.lineHorizontalPadding,i=e.lineHeight+2*e.styles.lineVerticalPadding;return(0,l.jsx)(n.Group,{width:a,height:i,y:s*i,children:r(t)},s)})),{backgroundShadow:c}=e.styles;return(0,l.jsx)(n.Group,{visible:0!==e.width,width:e.width,height:e.height,children:(0,l.jsxs)(n.Group,{x:e.styles.layerPadding,y:e.styles.layerPadding,children:[e.textBackground&&(t?(0,l.jsx)(n.Path,{data:e.backgroundPath,stroke:e.textBackgroundColor.toHex(),fill:e.textBackgroundColor.toHex(),shadowColor:c.color.toHex(),shadowBlur:c.radius,shadowOffset:{x:c.offsetX,y:c.offsetY},shadowOpacity:c.color.alpha},"1"):(0,l.jsx)(n.Path,{data:e.backgroundPath,stroke:e.textBackgroundColor.toHex(),fill:e.textBackgroundColor.toHex()},"2")),d]})})};var a=s(67294),i=s(57528),n=s(47971),o=s(56130),l=s(85893)},8731:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(s(94184)),n=s(67294),o=a(s(73895)),l=a(s(55454)),r=s(9492),d=a(s(91137)),c=s(63290),u=a(s(12950)),h=a(s(71488)),f=a(s(2408)),p=a(s(45689)),m=s(92954),g=a(s(33994)),_=a(s(65565)),v=s(2904),C=a(s(2966)),x=a(s(63477)),S=a(s(68062)),y=s(49002),E=s(85893);class j extends n.Component{constructor(e){super(e),this.setRefInput=e=>{this.refInput=e,this.props.setCaptionInputRef(e)},this.setRefEmojiPicker=e=>{this.refEmojiPicker=e},this.restoreFocus=()=>{this.refInput&&this.refInput.focus()},this.handleReset=()=>{this.refInput&&this.refInput.reset(),this.restoreFocus()},this.handleEmojiPickerClose=()=>{this.setState({emojiPicker:null})},this.handleEmoji=e=>{const t=this.refInput;t&&(t.focus(!1),t.replaceSelection(e))},this.handleEmojiPicker=e=>{e.preventDefault(),e.stopPropagation();const t=(0,E.jsx)(d.default,{onEmoji:this.handleEmoji,onFocusNext:this.restoreFocus,onFocusPrev:this.restoreFocus});this.setState({emojiPicker:{menu:t,dirY:r.DirY.TOP,type:"emoji_picker",anchor:e.target}}),this.restoreFocus()},this.handleEnter=e=>{this.refInput&&this.refInput.isFocused()&&this.props.onEnter(e)},this.state={emojiPicker:null}}componentDidMount(){this.restoreFocus()}render(){const{emojiPicker:e}=this.state,{caption:t,onToggleSendAsSticker:s}=this.props,a=(0,y.numCodepoints)(this.props.caption||""),n=l.default.MAX_CAPTION_LENGTH-a<50,r=(0,E.jsx)("div",{role:"button",className:h.default.inputEmoji,onClick:this.handleEmojiPicker,children:(0,E.jsx)(C.default,{name:"emoji-input"})}),d=t&&""!==t?(0,E.jsx)("div",{role:"button",className:h.default.clearBtn,onClick:this.handleReset,children:(0,E.jsx)(C.default,{name:"x-alt"})}):null,j=n&&(0,E.jsx)("div",{className:h.default.charCounter,children:f.default.n(l.default.MAX_CAPTION_LENGTH-a)});let I,M,T=null;return e&&(T=(0,E.jsx)(x.default,{displayName:"EmojiPicker",escapable:!0,popable:!0,ref:this.setRefEmojiPicker,requestDismiss:this.handleEmojiPickerClose,children:(0,E.jsx)(S.default,{contextMenu:e})})),_.default.viewOnceWrite&&(I=(0,E.jsx)("div",{className:h.default.secondaryButtonContainer,children:(0,E.jsx)(o.default,{disabled:this.props.viewOnceDisabled,isOn:Boolean(this.props.viewOnce),mediaType:this.props.msgType,onChange:this.props.onToggleViewOnce,noMargin:!0})})),u.default.isStickerMakerEnabled()&&this.props.msgType===m.TYPE.IMAGE&&null!=s&&(M=(0,E.jsx)("div",{className:h.default.secondaryButtonContainer,children:(0,E.jsx)(g.default,{disabled:this.props.sendAsStickerDisabled,isOn:Boolean(this.props.sendAsSticker),onChange:s})})),(0,E.jsxs)(c.FlexRow,{className:(0,i.default)(h.default.container,{[h.default.videoCaption]:"video"===this.props.theme}),align:"center",justify:"center",children:[(0,E.jsx)("div",{className:h.default.suggestionsPositioner,children:(0,E.jsxs)("div",{className:h.default.suggestionsContainer,children:[(0,E.jsx)(p.default.MentionSuggestions,{chat:this.props.chat,theme:v.ThemeOptions.MEDIA_CAPTION}),(0,E.jsx)(p.default.EmojiSuggestions,{chat:this.props.chat,theme:v.ThemeOptions.MEDIA_CAPTION})]})}),(0,E.jsxs)(c.FlexRow,{align:"start",className:h.default.inputContainer,children:[(0,E.jsx)(p.default,{ref:this.setRefInput,initialValue:t,placeholder:f.default.t(1706),onChange:this.props.onChange,onEnter:this.handleEnter,onFiles:this.props.onFiles,theme:"media-caption",maxLength:l.default.MAX_CAPTION_LENGTH,multiline:!0,spellCheck:!0}),(0,E.jsxs)(c.FlexRow,{className:h.default.buttonContainer,align:"center",children:[j,d,r]})]}),I,M,T]})}}t.default=j,j.displayName="Caption"},33994:(e,t,s)=>{"use strict";var a=s(20862),i=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function({isOn:e,onChange:t,disabled:s}){return(0,n.useEffect)((()=>{if(!e)return;const t=(0,h.jsx)(c.default,{msg:r.default.t(1599),id:(0,c.genId)("send-as-sticker-toast")});return l.default.openToast(t),()=>{l.default.closeToast(t)}}),[e]),(0,h.jsx)(u.default,{a8nText:o.default.key("send-as-sticker-toggle"),xstyle:[f.button,e&&f.buttonOn,s&&f.buttonDisabled],disabled:s,onClick:()=>t(!e),"aria-pressed":e,children:(0,h.jsx)(d.default,{"aria-label":e?r.default.t(44):r.default.t(45),name:"sticker",height:26,width:26})})};var n=s(67294),o=(i(s(56720)),i(s(76610))),l=i(s(91952)),r=i(s(2408)),d=i(s(2966)),c=a(s(49201)),u=i(s(89135)),h=s(85893);const f={button:{marginTop:"tt8xd2xn",marginEnd:"jnwc1y2a",marginBottom:"mpdn4nr2",marginStart:"svoq16ka",display:"f804f6gw",color:"svlsagor"},buttonOn:{color:"m5p9kmvp"},buttonDisabled:{cursor:"h2qzpyga",opacity:"notw83rv"}}},45139:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getAllThicknesses=function(){return Object.keys(s)},t.getThicknessValue=function(e){return a[e]},t.THICKNESS=void 0;const s=Object.freeze({SMALL:"SMALL",MEDIUM:"MEDIUM",LARGE:"LARGE",XLARGE:"XLARGE"});t.THICKNESS=s;const a={[s.SMALL]:8,[s.MEDIUM]:12,[s.LARGE]:18,[s.XLARGE]:24}},37620:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{onClick:t,onClose:s,forwardRef:a,id:i}=e,l=(0,h.default)(e.attachMedia,["mimetype","preview","type","fullPreview","fullPreviewSize","documentPageCount"]);return(0,f.jsxs)("div",{className:(0,n.default)(o.default.thumb,{[o.default.active]:e.active}),onClick:e=>{t((0,c.unproxy)(l),e)},tabIndex:"-1",ref:e=>{a(i,e)},children:[(0,f.jsx)("div",{className:o.default.btnDelete,onClick:e=>{s((0,c.unproxy)(l),e)},role:"button",children:(0,f.jsx)(u.default,{name:"x-alt"})}),(0,f.jsx)("div",{className:o.default.bodyWrapper,children:(()=>{let e;if(l.type===p)e=l.preview;else if(l.type===m)e=`data:image/jpeg;base64,${l.preview}`;else if("pdf"===(0,d.previewType)(l.mimetype)){l.fullPreview&&l.fullPreviewSize&&null!=l.documentPageCount&&l.documentPageCount>0&&(e=l.fullPreview)}if(e)return(0,f.jsx)("div",{className:o.default.body,children:(0,f.jsx)("img",{src:e,alt:r.default.t(2136)})});const t=(0,n.default)(o.default.body,o.default.bodyIcon,g[l.mimetype]?g[l.mimetype].icon:"icon-doc-generic");return(0,f.jsx)("div",{className:t})})()})]})};var i=a(s(35937)),n=a(s(94184)),o=a(s(99062)),l=a(s(55454)),r=a(s(2408)),d=s(38961),c=s(15298),u=a(s(2966)),h=a(s(76006)),f=s(85893);const{IMAGE:p,VIDEO:m}=l.default.MSG_TYPE,g=(0,i.default)(d.MIMETYPES,(e=>"document"===e.msgType))},17893:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(67294),n=s(99420),o=a(s(37620)),l=a(s(55454)),r=s(85893);const d=(0,n.SortableElement)((({children:e})=>e)),c=(0,n.SortableContainer)((({children:e})=>e));class u extends i.Component{constructor(e){super(e),this._handleSortEnd=({oldIndex:e,newIndex:t})=>{const{mediaCollection:s}=this.props,a=s.reorder(e,t);this.setState({medias:a})},this.state={medias:this.props.mediaCollection.getPreviewableMedias()}}static getDerivedStateFromProps(e){return{medias:e.mediaCollection.getPreviewableMedias()}}render(){const{mediaCollection:e,className:t,forwardRef:s}=this.props,a=this.state.medias;return(0,r.jsx)(c,{onSortEnd:this._handleSortEnd,axis:"x",helperClass:"SortableHelper",distance:10,children:(0,r.jsx)("div",{className:t,children:a.map(((t,a)=>{var i;return(0,r.jsx)(d,{index:a,children:(0,r.jsx)(o.default,{id:t.id,attachMedia:t,active:t===e.getActive(),previewMode:(null===(i=e.getActive())||void 0===i?void 0:i.type)!==l.default.MSG_TYPE.IMAGE,onClick:this.props.onClick,onClose:this.props.onClose,forwardRef:s})},t.id)}))})})}}t.default=u,u.displayName="DragAndDrop"},66737:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(s(23279)),n=a(s(94184)),o=s(67294),l=a(s(91420)),r=a(s(64193)),d=a(s(8731)),c=a(s(40156)),u=s(91940),h=s(96532),f=a(s(23742)),p=s(63290),m=a(s(64603)),g=s(57528),_=s(33237),v=a(s(4104)),C=a(s(2408)),x=a(s(71681)),S=a(s(35087)),y=s(92954),E=a(s(7668)),j=a(s(60738)),I=s(50240),M=a(s(79485)),T=a(s(2966)),b=a(s(4301)),P=a(s(55154)),L=a(s(98417)),w=s(45139),D=a(s(1458)),O=s(85893);const N=new j.default({width:200,height:200});class R extends o.PureComponent{constructor(e){super(e),this._setRefCanvasContainer=e=>this._refCanvasContainer=e,this._setRefHeaderContainer=e=>this._refHeaderContainer=e,this._setRefFooterContainer=e=>this._refFooterContainer=e,this._setRefCanvas=e=>this._refCanvas=e,this._refTextColorToolbar=(0,o.createRef)(),this._refFontToolbar=(0,o.createRef)(),this._handleGlobalMouseDown=e=>{this._outsideClickTarget=e.target},this._handleGlobalClick=()=>{this._outsideClickTarget!==this._refCanvasContainer&&this._outsideClickTarget!==this._refFooterContainer&&this._outsideClickTarget!==this._refHeaderContainer||this.resetUIState()},this._handleResize=()=>{if(!this._refCanvasContainer)return;const e=this._refCanvasContainer.getBoundingClientRect(),t=new j.default({width:e.width-40,height:e.height-40});this.setState({containerSize:t})},this._handleGlobalKeydown=e=>{"Backspace"!==e.code||e.target instanceof HTMLInputElement||e.target instanceof HTMLDivElement&&"true"===e.target.contentEditable||this.state.inCropRotateMode||this._handleLayerDelete()},this._handleLayerDelete=()=>{const{selectedLayer:e}=this.props.attachMedia.mediaEditorData;e&&this.props.onLayerDelete(e)},this._updatePreview=()=>{if(null!=this._refCanvas){const{width:e,height:t}=this._refCanvas.getStage().attrs;if(0!==e&&0!==t){const e=this._getFile(),t=window.URL.createObjectURL(e);this.props.attachMedia.updateEditedFile(e),this.props.attachMedia.updatePreview(t),this.props.attachMedia.updateFullPreview(t)}}},this._updatePreviewDebounced=(0,i.default)((()=>{this._ricId&&((0,_.cancelIdleCallback)(this._ricId),this._ricId=null),this._ricId=(0,_.requestIdleCallback)(this._updatePreview)}),1e3),this._handleTextEditingStart=e=>{this.setState({isEditing:!0}),this.props.onTextEditingStart(e)},this._handleTextEditingEnd=(e,t)=>{this.setState({isEditing:!1}),this.props.onTextEditingEnd(e,t)},this._handleClickDone=()=>{if(this.state.inCropRotateMode)this._toggleCropRotateMode();else if(this.state.inPaintMode)this._togglePaintMode();else if(this.props.draftTextLayer){var e;null===(e=this._refCanvas)||void 0===e||e.endTextEditing()}else this._getData().selectedLayer&&this.props.onLayerUnselect()},this._handlePaintSelect=()=>{this._togglePaintMode(),this.props.onPaintSelect()},this._handleCropRotateSelect=()=>{this._toggleCropRotateMode()},this._handleRotateCanvas=e=>{this.props.onCropRotateCanvas(this._getData().rotation+e,this._getData().cropOrigin,this._getData().cropSize)},this._handleResetCropRotate=()=>{this.props.onCropRotateCanvas(0,new E.default({x:0,y:0}),this._getData().size)},this._handleCropChange=(e,t)=>{this.props.onCropRotateCanvas(this._getData().rotation,e,t)},this._handleToggleEmojiPanel=e=>{this.setState({isEmojiPanelVisible:e})},this._handleToggleStickerPanel=e=>{this.setState({isStickerPanelVisible:e})},this._handleTextInputOutsideClick=e=>{var t,s;const a=e.target;return!(a instanceof HTMLElement&&a.closest(`.${v.default.footer}`)&&a!==this._refFooterContainer||(null===(t=this._refTextColorToolbar.current)||void 0===t?void 0:t.isPanelVisible())||(null===(s=this._refFontToolbar.current)||void 0===s?void 0:s.isMenuVisible()))},this.state={containerSize:j.default.empty(),isEditing:!1,inPaintMode:!1,inCropRotateMode:!1,isEmojiPanelVisible:!1,isStickerPanelVisible:!1}}componentDidMount(){window.addEventListener("resize",this._handleResize),window.addEventListener("keydown",this._handleGlobalKeydown),this._handleResize(),this.props.listeners.add(window,"mousedown",this._handleGlobalMouseDown),this.props.listeners.add(window,"click",this._handleGlobalClick)}componentWillUnmount(){window.removeEventListener("resize",this._handleResize),window.removeEventListener("keydown",this._handleGlobalKeydown),this.updatePreview({immediately:!0})}resetUIState(){if(this._inPaintMode())this._togglePaintMode();else if(this._inCropRotateMode())this._toggleCropRotateMode();else{if(!this.props.attachMedia.mediaEditorData.selectedLayer||this.props.draftTextLayer)return!1;this.props.onLayerUnselect()}return!0}_inPaintMode(){return this.state.inPaintMode}_inCropRotateMode(){return this.state.inCropRotateMode}_togglePaintMode(){this.setState((({inPaintMode:e})=>({inPaintMode:!e})))}_toggleCropRotateMode(){!this.state.inCropRotateMode&&this._getData().selectedLayer&&this.props.onLayerUnselect(),this.setState((({inCropRotateMode:e})=>({inCropRotateMode:!e})),this._handleResize)}updatePreview(e){(null==e?void 0:e.immediately)?this._updatePreview():this._updatePreviewDebounced()}_getDataUrl(){if(!this._refCanvas)throw new Error("MediaEditor:canvas is not initialized");return this._refCanvas.getDataUrl()}_getFile(){const e=this._getDataUrl();return D.default.dataURLtoFile(e)}_getData(){return this.props.attachMedia.mediaEditorData}getCanvasScale(){const e=this.props.attachMedia.mediaEditorData;return(0,I.calculateContainScale)(e.screenWidth,e.screenHeight,this.state.containerSize,N)}render(){const{attachMedia:e,paintColor:t,paintThickness:s}=this.props,{inPaintMode:a,inCropRotateMode:i}=this.state,o=e.mediaEditorData,_=this.props.draftTextLayer||o.selectedLayer;let x;if(i)x=(0,O.jsx)(h.CropRotateToolbar,{canReset:o.isRotated()||o.isCropped(),onRotateCanvas:this._handleRotateCanvas,onReset:this._handleResetCropRotate});else if(_)if(_ instanceof b.default){const e=(0,u.getAllColors)().map((e=>{const t=(0,u.getColorValue)(e),s=(0,u.getColorValue)(t.isLight()?u.COLORS.BLACK:u.COLORS.WHITE);return{primaryColor:t,secondaryColor:s}}));x=(0,O.jsxs)(O.Fragment,{children:[(0,O.jsx)(c.default,{ref:this._refTextColorToolbar,colors:e,onColorSelect:this.props.onTextColorSelect,selectedColor:_.textColor}),(0,O.jsx)(m.default,{ref:this._refFontToolbar,fonts:(0,g.getAllFonts)(),selectedFont:_.font,selectedAlignment:_.alignment,onFontSelect:this.props.onFontSelect,onAlignmentSelect:this.props.onAlignmentSelect}),(0,O.jsx)(P.default,{checked:_.textBackground,onBackgroundToggle:this.props.onTextBackgroundToggle}),(0,O.jsx)(l.default,{icon:"delete",title:C.default.t(1195),onClick:this._handleLayerDelete})]})}else x=(0,O.jsx)(O.Fragment,{children:(0,O.jsx)(l.default,{icon:"delete",title:C.default.t(1195),onClick:this._handleLayerDelete})});else a&&(x=(0,O.jsxs)(O.Fragment,{children:[(0,O.jsx)(c.default,{colors:(0,u.getAllColors)().map((e=>({primaryColor:(0,u.getColorValue)(e)}))),onColorSelect:this.props.onPaintColorSelect,selectedColor:t}),(0,O.jsx)(L.default,{thicknesses:(0,w.getAllThicknesses)(),onThicknessSelect:this.props.onPaintThicknessSelect,selectedThickness:s})]}));const E=!x&&!this.props.draftTextLayer,j=(0,O.jsx)(p.FlexRow,{className:(0,n.default)(v.default.captionInputContainer,{[v.default.captionInputHidden]:!E}),justify:"center",children:(0,O.jsx)(d.default,{chat:this.props.chat,caption:e.caption,viewOnce:this.props.viewOnce,viewOnceDisabled:this.props.viewOnceDisabled,sendAsSticker:this.props.sendAsSticker,sendAsStickerDisabled:this.props.sendAsStickerDisabled,msgType:y.TYPE.IMAGE,theme:"image",onToggleViewOnce:this.props.onToggleViewOnce,onToggleSendAsSticker:this.props.onToggleSendAsSticker,onChange:this.props.onCaptionChange,onEnter:this.props.onEnter,onFiles:this.props.onFiles,setCaptionInputRef:t=>{this.props.setCaptionInputRef(e.id,t)}},e.id)}),I=(0,O.jsxs)(p.FlexRow,{justify:"center",align:"center",className:v.default.footer,ref:this._setRefFooterContainer,children:[x&&(0,O.jsx)(p.FlexRow,{justify:"center",align:"center",className:v.default.bottomToolbar,children:x}),j]});let M=null;i&&(M=(0,O.jsx)(f.default,{data:o,rotation:this._getData().rotation,cropOrigin:this._getData().cropOrigin,cropSize:this._getData().cropSize,onCropChange:this._handleCropChange,containerSize:this.state.containerSize}));const D=i||a||this.state.isEmojiPanelVisible||this.state.isStickerPanelVisible||Boolean(this.props.draftTextLayer)||Boolean(this._getData().selectedLayer);return(0,O.jsxs)("div",{className:v.default.container,children:[(0,O.jsxs)(p.FlexRow,{className:v.default.header,ref:this._setRefHeaderContainer,children:[this.props.onClose?(0,O.jsx)("div",{onClick:this.props.onClose,className:v.default.closeButton,children:(0,O.jsx)(T.default,{name:"x"})}):(0,O.jsx)("div",{className:v.default.closeButtonPlaceholder}),(0,O.jsx)(S.default,{selectedLayer:_,inPaintMode:a,inCropRotateMode:i,inTextEditingMode:Boolean(this.props.draftTextLayer),canUndo:this.props.canUndo,canRedo:this.props.canRedo,onPaintSelect:this._handlePaintSelect,onCropRotateSelect:this._handleCropRotateSelect,onTextSelect:this.props.onTextSelect,onEmojiSelect:this.props.onEmojiSelect,onStickerSelect:this.props.onStickerSelect,onToggleEmojiPanel:this._handleToggleEmojiPanel,onToggleStickerPanel:this._handleToggleStickerPanel,onUndo:this.props.onUndo,onRedo:this.props.onRedo}),(0,O.jsx)(p.FlexRow,{className:v.default.headerRight,justify:"end",children:D&&(0,O.jsx)(l.default,{onClick:this._handleClickDone,children:C.default.t(1185)})})]}),(0,O.jsxs)("div",{ref:this._setRefCanvasContainer,className:(0,n.default)(v.default.canvasContainer,{[v.default.cropRotateContainer]:i}),children:[(0,O.jsx)("div",{className:v.default.canvas,style:{display:i?"none":"unset"},children:(0,O.jsx)(r.default,{ref:this._setRefCanvas,data:o,inPaintMode:a,paintColor:t,paintThickness:s,currentlyEditingTextLayer:this.props.currentlyEditingTextLayer,draftTextLayer:this.props.draftTextLayer,scale:this.getCanvasScale(),onLayerSelect:this.props.onLayerSelect,onLayerUnselect:this.props.onLayerUnselect,onLayerTranslate:this.props.onLayerTranslate,onLayerTransform:this.props.onLayerTransform,onTextEditingStart:this._handleTextEditingStart,onTextEditingEnd:this._handleTextEditingEnd,onTextInputOutsideClick:this._handleTextInputOutsideClick,onDrawEnd:this.props.onDrawEnd})}),M]}),I]})}}R.CONCERNS={attachMedia:["mediaEditorData","caption","id"]},R.displayName="ImageBodyBase";const k=(0,x.default)((0,M.default)(R,R.CONCERNS));t.default=class extends k{constructor(...e){super(...e),this.updatePreview=e=>this.getComponent().updatePreview(e)}getCanvasScale(){return this.getComponent().getCanvasScale()}resetUIState(){return this.getComponent().resetUIState()}}},92235:(e,t,s)=>{"use strict";var a=s(20862),i=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(s(48926)),o=i(s(94184)),l=s(55084),r=i(s(7900)),d=s(67294),c=i(s(11725)),u=i(s(91952)),h=s(91940),f=i(s(55454)),p=i(s(51144)),m=i(s(84286)),g=i(s(6002)),_=i(s(17893)),v=i(s(17747)),C=i(s(9042)),x=i(s(2561)),S=s(54432),y=a(s(13540)),E=i(s(74711)),j=s(57085),I=s(63290),M=i(s(47193)),T=s(57528),b=i(s(12950)),P=i(s(39e3)),L=i(s(66737)),w=a(s(85499)),D=i(s(44532)),O=i(s(2408)),N=i(s(71681)),R=i(s(75571)),k=i(s(4231)),A=s(38961),F=i(s(39110)),B=i(s(7668)),U=i(s(40630)),G=i(s(86537)),H=i(s(65565)),V=i(s(46714)),W=i(s(40858)),z=i(s(2966)),K=a(s(4301)),Y=s(45139),q=a(s(49201)),Z=i(s(94252)),X=i(s(85472)),$=s(85893);const{IMAGE:J,VIDEO:Q,AUDIO:ee}=f.default.MSG_TYPE;class te extends d.Component{constructor(e){var t;super(e),t=this,this._setRefCanvasContainer=e=>{this._refCanvasContainer=e},this._setRefCanvas=e=>{this._refCanvas=e},this._setRefImageBody=e=>{this._refImageBody=e},this._setRefFileInput=e=>{this._refFileInput=e},this._setRefCaptionInput=e=>{this.props.mediaCollection.getActive()&&!e||(this._refCaptionInput=e)},this._setRefSendButton=e=>{this._refSendButton=e},this._mediaThumbRefMap=new Map,this._setRefMediaThumb=(e,t)=>{this._mediaThumbRefMap.set(e,t)},this._captionInputRefMap=new Map,this._setRefCaptionInput=(e,t)=>{this._captionInputRefMap.set(e,t)},this._setRefHotKeys=e=>{this._refHotKeys=e},this._update=(e,t)=>{if(e===this._getData())return;const s=this.state.activeMedia;var a,i;s&&(s.updateMediaEditorData(e,{undoable:null!==(a=null==t?void 0:t.undoable)&&void 0!==a&&a}),this._updateUndoRedoState());(null==t?void 0:t.updatePreview)&&(null===(i=this._refImageBody)||void 0===i||i.updatePreview())},this._getData=()=>{const{activeMedia:e}=this.state;return null==e?p.default.create():e.mediaEditorData},this._handleUndo=()=>{const{activeMedia:e}=this.state;var t;e&&e.canUndoMediaEditorData()&&(e.undoMediaEditorData(),this._updateUndoRedoState(),null===(t=this._refImageBody)||void 0===t||t.updatePreview())},this._handleRedo=()=>{const{activeMedia:e}=this.state;var t;e&&e.canRedoMediaEditorData()&&(e.redoMediaEditorData(),this._updateUndoRedoState(),null===(t=this._refImageBody)||void 0===t||t.updatePreview())},this._updateUndoRedoState=()=>{this.setState((e=>{var t,s,a,i;const n=null!==(t=null===(s=this.state.activeMedia)||void 0===s?void 0:s.canUndoMediaEditorData())&&void 0!==t&&t,o=null!==(a=null===(i=this.state.activeMedia)||void 0===i?void 0:i.canRedoMediaEditorData())&&void 0!==a&&a;return e.canUndo!==n||e.canRedo!==o?{canUndo:n,canRedo:o}:null}))},this._addImageLayer=(e,t,s,a,i)=>{const n=(0,r.default)(this._refImageBody,"this._refImageBody").getCanvasScale(),o=t.width*n,l=t.width*n,d=Math.min(i/o,i/l),c=this._getData().addImageLayerToCenter({type:e,image:t,editable:!0,scale:d});this._update(c,{updatePreview:!0,undoable:!0})},this._handleEmojiSelect=function(){var e=(0,n.default)((function*(e){try{const s=x.default.getGlyphId(e);if(null==s)return;const a=x.default.getGlyphPath(s,"xlarge").high,i=yield ae(a);t._addImageLayer(w.ImageLayerType.Emoji,i,i.width,i.height,64)}catch(e){u.default.openToast((0,$.jsx)(q.default,{msg:O.default.t(1186),id:(0,q.genId)()}))}}));return function(){return e.apply(this,arguments)}}(),this._handleStickerSelect=function(){var e=(0,n.default)((function*(e){try{let s;const a=e.mediaData.fullWidth,i=e.mediaData.fullHeight;if(yield(0,g.default)()){const t=e.mediaData.filehash,a=R.default.getOrCreateURL(t);s=yield ae(a)}else s=yield function(){return ie.apply(this,arguments)}(e.mediaData);t._addImageLayer(w.ImageLayerType.Sticker,s,a,i,128)}catch(e){u.default.openToast((0,$.jsx)(q.default,{msg:O.default.t(1186),id:(0,q.genId)()}))}}));return function(){return e.apply(this,arguments)}}(),this._handlePaintSelect=()=>{const e=this._getData().clearSelectedLayer();this._update(e)},this._handleCropRotateCanvas=(e,t,s)=>{const a=this._getData().setRotation(e).setCrop(t,s);this._update(a,{undoable:!0,updatePreview:!0})},this._handlePaintColorSelect=e=>{this.setState({paintColor:e})},this._handlePaintThicknessSelect=e=>{this.setState({paintThickness:e})},this._handleTextSelect=()=>{if(this.state.currentlyEditingTextLayer)return;this._handleLayerUnselect();const e=(0,r.default)(this._refImageBody,"this._refImageBody").getCanvasScale(),t=new B.default({x:this._getData().screenWidth/2,y:this._getData().screenHeight/2}),s={origin:this._getData().toCanvasPoint(t),text:"",textColor:this.state.textColor,textBackground:this.state.textBackground,alignment:this.state.alignment,font:this.state.font,scale:K.DEFAULT_FONT_SIZE/(K.DEFAULT_FONT_SIZE*e)*1.2},a=this._getData().addTextLayer(s),i=(0,r.default)(a.lastTextLayer,"data.lastTextLayer");this.setState({draftTextLayer:i,currentlyEditingTextLayer:null})},this._handleFontSelect=e=>{this.setState({font:e});const{selectedLayer:t}=this._getData(),{draftTextLayer:s}=this.state;if(s)this.setState({draftTextLayer:s.setFont(e)});else if(t&&t instanceof K.default){const s=this._getData().setFont(t,e);this._update(s,{updatePreview:!0,undoable:!0})}},this._handleAlignmentSelect=e=>{this.setState({alignment:e});const{selectedLayer:t}=this._getData(),{draftTextLayer:s}=this.state;if(s)this.setState({draftTextLayer:s.setAlignment(e)});else if(t&&t instanceof K.default){const s=this._getData().setAlignment(t,e);this._update(s,{updatePreview:!0,undoable:!0})}},this._handleTextColorSelect=e=>{this.setState({textColor:e});const{selectedLayer:t}=this._getData(),{draftTextLayer:s}=this.state;if(s)this.setState({draftTextLayer:s.setTextColor(e)});else if(t&&t instanceof K.default){const s=this._getData().setTextColor(t,e);this._update(s,{updatePreview:!0,undoable:!0})}},this._handleTextBackgroundToggle=()=>{const e=!this.state.textBackground;this.setState({textBackground:e});const{selectedLayer:t}=this._getData(),{draftTextLayer:s}=this.state;if(s)this.setState({draftTextLayer:s.setTextBackground(e)});else if(t&&t instanceof K.default){const s=this._getData().setTextBackground(t,e);this._update(s,{updatePreview:!0,undoable:!0})}},this._handleTextEditingStart=e=>{this.setState({draftTextLayer:e,currentlyEditingTextLayer:e})},this._handleTextEditingEnd=(e,t)=>{var s;if(t){let e=this._getData();const s=(0,r.default)(this.state.draftTextLayer,"this.state.draftTextLayer").setText(t);e=this.state.currentlyEditingTextLayer?e.updateLayer((0,r.default)(this.state.currentlyEditingTextLayer,"this.state.currentlyEditingTextLayer"),s):e.addTextLayer(s),this._update(e,{updatePreview:!0,undoable:!0})}else{const{currentlyEditingTextLayer:t}=this.state;t&&this._update(this._getData().deleteLayer(t),{updatePreview:!0,undoable:Boolean(e.text)})}setTimeout((()=>{this.setState({draftTextLayer:null,currentlyEditingTextLayer:null})}),0),null===(s=this._refHotKeys)||void 0===s||s.focus()},this._handleDrawEnd=e=>{this._update(this._getData().addPath(e),{undoable:!0,updatePreview:!0})},this._handleLayerUnselect=()=>{this._update(this._getData().clearSelectedLayer())},this._handleLayerSelect=e=>{if(!e.editable)return;const t=this._getData().setSelectedLayer(e).moveToTop(e);this._update(t),e instanceof K.default&&this.setState({textColor:e.textColor,textBackground:e.textBackground,font:e.font})},this._handleLayerTranslate=(e,t)=>{const s=this._getData().translateLayer(e,t);this._update(s,{updatePreview:!0,undoable:!0})},this._handleLayerTransform=(e,t,s)=>{const a=this._getData().transformLayer(e,t,s);this._update(a,{updatePreview:!0,undoable:!0})},this._handleLayerDelete=e=>{const t=this._getData().deleteLayer(e);this._update(t,{updatePreview:!0,undoable:!0})},this._handleMediaProcessUpdate=()=>{const{mediaCollection:e}=this.props;if(!e.canSend())return;const{errorMsgs:t}=e.uiProcessMsgs();t&&(u.default.openToast((0,$.jsx)(q.default,{msg:t,id:(0,q.genId)()})),0===e.getPreviewableMedias().length&&this.props.onClose()),this.forceUpdate()},this._handleDrop=e=>{this.state.viewOnce||this.state.sendAsSticker||this._handleFilePick(e)},this._handleDragChange=(e,t)=>{this.state.viewOnce||this.state.sendAsSticker||(this.setState({isDragging:e}),e||t||this.props.mediaCollection.length||this.props.onClose())},this._handleCaptionChange=e=>{const{activeMedia:t,isInitCaptionUsed:s}=this.state;if(!t)return;const a=this.props.mediaCollection.indexOf(t);t.updateCaption(e),0===a&&""===e&&s&&this.setState({isInitCaptionUsed:!1})},this._handlePaste=e=>{e.preventDefault(),e.stopPropagation();const t=new m.default(e.clipboardData);t.hasFiles()&&this._handleFiles(t)},this._handleFiles=e=>{const t=e.getFiles().filter((e=>{const t=(0,j.typeFromMimetype)(e.type);return"image"===t||"video"===t})).map((e=>({file:e})));this.props.mediaCollection.processAttachments(t,k.default.MEDIA_PICKER_ORIGIN_TYPE.PASTE)},this._handleAddFileClick=()=>{if(this._refFileInput){this._refFileInput.click()}},this._handleFilePick=e=>{(0,S.getFiles)(e).then((e=>this.props.mediaCollection.processAttachments(e.map((e=>({file:e}))),k.default.MEDIA_PICKER_ORIGIN_TYPE.CHAT_PHOTO_LIBRARY))).checkpoint(this.props.rejectOnUnmount()).catch((0,l.filteredCatch)(y.Unmount,(()=>{}))).catch((0,l.filteredCatch)(y.MediaDragDropError,(e=>{this.props.mediaCollection.length||this.props.onDropText(e.src)}))),e.target&&e.target.value&&(e.target.value="")},this._handleEnter=e=>{if(!this.state.activeMedia)return;if(e.repeat)return;if(e.shiftKey)return;if(this.state.draftTextLayer)return;const{selectedLayer:t}=this._getData();t instanceof K.default?(e.preventDefault(),e.stopPropagation(),this._handleTextEditingStart(t)):this._handleSendFromMediaEditor()},this._handleArrowKey=(e,t)=>{if(!this.state.activeMedia||t.repeat||this.state.draftTextLayer)return;const{activeMedia:s}=this.state,a=s&&!s.caption,i=this._refCaptionInput&&this._refCaptionInput.refInput;(a||i&&!i.isFocused()||i&&i.cursorIsAtStart())&&("left"===e?this._handlePrev():this._handleNext())},this._handlePrev=()=>{this.props.mediaCollection.setPrevAsActive()&&(this._refSendButton&&!this.state.draftTextLayer&&M.default.focus(this._refSendButton),this._scrollIntoView())},this._handleNext=()=>{this.props.mediaCollection.setNextAsActive()&&(this._refSendButton&&!this.state.draftTextLayer&&M.default.focus(this._refSendButton),this._scrollIntoView())},this._scrollIntoView=()=>{const{activeMedia:e}=this.state;if(!e)return;const t=this._mediaThumbRefMap.get(e.id);t&&t.scrollIntoView()},this._handleSelectThumb=e=>{this.props.mediaCollection.setActive(e)},this._handleRemoveThumb=(e,t)=>{t.stopPropagation(),t.preventDefault(),this.props.mediaCollection.remove(e),0===this.props.mediaCollection.getValidMedias().length?this._delayedClose=setTimeout((()=>{this.props.onClose()}),200):this._refSendButton&&M.default.focus(this._refSendButton)},this._handleSendFromMediaEditor=e=>{var t;e&&e.preventDefault();const{mediaCollection:s}=this.props;if(!s.canSend())return;const a=s.getPreviewableMedias();if(0===a.length)return void this.props.onClose();var i;(null===(t=this.state.activeMedia)||void 0===t?void 0:t.mediaEditorData.hasEdits())&&(null===(i=this._refImageBody)||void 0===i||i.updatePreview({immediately:!0}));const n=[];a.forEach((e=>{if(!e.mediaEditorData||!e.mediaEditorData.hasEdits()||!e.editedFile)return;const t=s.replace(e.id,{file:e.editedFile});n.push(t)})),Promise.all(n).then((()=>{const e=s.getPreviewableMedias();if(0===e.length)return;const t=e.map((e=>{var t;let s=e.caption,a=[];const i=this._captionInputRefMap.get(e.id);if(s&&i){const e=i.serialize(s),[t,n]=[e[0].trim(),e[1]];t.length&&(s=t,a=n.mentionedJidList||[])}return e.caption=null!==(t=s)&&void 0!==t?t:void 0,{media:e,mentionedJidList:a}}));this.props.onSendMedia(t,{initCaptionUsed:this.state.isInitCaptionUsed,isViewOnce:this._canViewOnce()&&this.state.viewOnce,asSticker:this.state.sendAsSticker}),this._commitMediaEditorSendMetric(a)}))},this._handleToggleViewOnce=e=>{this.setState({viewOnce:e,sendAsSticker:!1})},this._canViewOnce=()=>{var e;const{chat:t,mediaCollection:s}=this.props,a=t.contact.isEnterprise;return H.default.viewOnceWrite&&1===s.length&&!0===(null===(e=s.at(0))||void 0===e?void 0:e.isViewableOnce())&&!a},this._handleToggleSendAsSticker=e=>{this.setState({sendAsSticker:e,viewOnce:!1})},this._canSendAsSticker=()=>{var e;const{mediaCollection:t}=this.props;return b.default.supportsFeature(b.default.F.STICKER_MAKER)&&1===t.length&&!0===(null===(e=t.at(0))||void 0===e?void 0:e.isSendableAsSticker())},this._getMediaBody=e=>{let t=null;const{paintColor:s,paintThickness:a,canUndo:i,canRedo:n}=this.state,o=H.default.viewOnceWrite?this.state.viewOnce:null;switch(e.type){case J:t=(0,$.jsx)(L.default,{ref:this._setRefImageBody,attachMedia:e,chat:this.props.chat,onCaptionChange:this._handleCaptionChange,onClose:"capture"===this.props.theme?null:this.props.onClose,onEnter:this._handleSendFromMediaEditor,setCaptionInputRef:this._setRefCaptionInput,paintColor:s,paintThickness:a,canUndo:i,canRedo:n,currentlyEditingTextLayer:this.state.currentlyEditingTextLayer,draftTextLayer:this.state.draftTextLayer,viewOnce:o,viewOnceDisabled:!this._canViewOnce(),sendAsSticker:this.state.sendAsSticker,sendAsStickerDisabled:!this._canSendAsSticker(),onPaintSelect:this._handlePaintSelect,onTextSelect:this._handleTextSelect,onTextBackgroundToggle:this._handleTextBackgroundToggle,onEmojiSelect:this._handleEmojiSelect,onStickerSelect:this._handleStickerSelect,onLayerSelect:this._handleLayerSelect,onLayerUnselect:this._handleLayerUnselect,onLayerDelete:this._handleLayerDelete,onLayerTranslate:this._handleLayerTranslate,onLayerTransform:this._handleLayerTransform,onTextEditingStart:this._handleTextEditingStart,onTextEditingEnd:this._handleTextEditingEnd,onTextColorSelect:this._handleTextColorSelect,onFontSelect:this._handleFontSelect,onAlignmentSelect:this._handleAlignmentSelect,onPaintColorSelect:this._handlePaintColorSelect,onPaintThicknessSelect:this._handlePaintThicknessSelect,onCropRotateCanvas:this._handleCropRotateCanvas,onUndo:this._handleUndo,onRedo:this._handleRedo,onDrawEnd:this._handleDrawEnd,onToggleViewOnce:this._handleToggleViewOnce,onToggleSendAsSticker:this._handleToggleSendAsSticker,onFiles:this._handleFiles},e.mediaEditorData.id);break;case Q:t=(0,$.jsx)(Z.default,{attachMedia:e,chat:this.props.chat,viewOnce:o,viewOnceDisabled:!this._canViewOnce(),setCaptionInputRef:this._setRefCaptionInput,onCaptionChange:this._handleCaptionChange,onClose:this.props.onClose,onEnter:this._handleSendFromMediaEditor,onToggleViewOnce:this._handleToggleViewOnce,onFiles:this._handleFiles},e.id);break;case ee:t=(0,$.jsx)(c.default,{item:e,onClose:this.props.onClose},e.id);break;default:t="pdf"===(0,A.previewType)(e.mimetype)?(0,$.jsx)(F.default,{item:e,onClose:this.props.onClose},e.id):(0,$.jsx)(E.default,{mimeType:e.mimetype,filesize:e.filesize,filename:e.filename,fileExt:e.fileExt,onClose:this.props.onClose},e.id)}return t},this.getThumbs=()=>{const{mediaCollection:e}=this.props;return(0,$.jsx)(_.default,{className:D.default.thumbs,mediaCollection:e,onClick:this._handleSelectThumb,onClose:this._handleRemoveThumb,forwardRef:this._setRefMediaThumb})},this.state={paintColor:(0,h.getColorValue)(h.COLORS.BLUE),paintThickness:Y.THICKNESS.SMALL,textColor:(0,h.getColorValue)(h.COLORS.BLACK),font:T.FONTS.SANS_SERIF,textBackground:!0,alignment:T.TextAlignment.CENTER,isDragging:!1,canUndo:!1,canRedo:!1,activeMedia:null,prevActiveMedia:null,isInitCaptionUsed:!1,initCaption:this.props.initCaption&&this.props.initCaption.text,currentlyEditingTextLayer:null,draftTextLayer:null,viewOnce:!1,sendAsSticker:!1}}static getDerivedStateFromProps(e,t){var s,a;const i=e.mediaCollection.getActive(),n=t.initCaption;let o=t.isInitCaptionUsed;return o||t.activeMedia||!n||!i||i.type!==J&&i.type!==Q||(i.caption=n,o=!0),{prevActiveMedia:i,activeMedia:i,canUndo:null!==(s=null==i?void 0:i.canUndoMediaEditorData())&&void 0!==s&&s,canRedo:null!==(a=null==i?void 0:i.canRedoMediaEditorData())&&void 0!==a&&a,isInitCaptionUsed:o}}componentDidMount(){var e;const{mediaCollection:t,listeners:s}=this.props;s.add(t,"add remove reset",(()=>{this.forceUpdate()})),s.add(t,"active-change change:state change:previewable",this._handleMediaProcessUpdate),null===(e=this._refHotKeys)||void 0===e||e.focus()}componentDidUpdate(){}componentWillUnmount(){this._delayedClose&&clearTimeout(this._delayedClose)}handleRequestDismiss(){var e;return!(null===(e=this._refImageBody)||void 0===e?void 0:e.resetUIState())&&(!this.state.draftTextLayer||(this.setState({currentlyEditingTextLayer:null,draftTextLayer:null}),!1))}_commitMediaEditorSendMetric(e){let t=0,s=0,a=0,i=0,n=0,o=0;e.forEach((e=>{const l=e.mediaEditorData;e.type===J&&(t++,l.hasEdits()&&s++,l.paintLayer.paths.length>0&&a++),l.layers.forEach((e=>{e instanceof w.default?(e.isEmoji()&&i++,e.isSticker()&&n++):e instanceof K.default&&o++}))})),new k.default.WebcMediaEditorSend({imageCount:t,editedImageCount:s,paintedImageCount:a,emojiLayerCount:i,stickerLayerCount:n,textLayerCount:o}).commit()}render(){const{mediaCollection:e}=this.props,{activeMedia:t}=this.state;let s,a=e.getPreviewableMedias();a.length>f.default.MAX_FILES&&(a=a.slice(0,f.default.MAX_FILES)),e.canSend()?t&&(s=this._getMediaBody(t)):s=(0,$.jsx)("div",{className:D.default.spinner,children:(0,$.jsx)(V.default,{color:"highlight"},"processing")});const i=this.state.isDragging?(0,$.jsx)("div",{className:D.default.dropOverlay,children:(0,$.jsx)("div",{className:D.default.dropOverlayOutline,children:O.default.t(793)})},"container"):null,n={enter:this._handleEnter,left:e=>this._handleArrowKey("left",e),right:e=>this._handleArrowKey("right",e)},l="*"===A.DOC_MIMES?"*":[f.default.IMAGE_MIMES].join();let r;if(null!=s){let t;if(a.length>0&&(t=(0,$.jsx)("div",{className:D.default.sendButton,tabIndex:"-1",ref:this._setRefSendButton,onKeyPress:e=>e.preventDefault(),children:(0,$.jsx)(G.default,{large:!0,icon:(0,$.jsx)(z.default,{name:"send",directional:!0}),count:1===a.length?null:a.length,onClick:this._handleSendFromMediaEditor,disabled:!e.canSend()})})),"capture"===this.props.theme)r=(0,$.jsx)("div",{className:D.default.captureFooter,children:t});else{const e=!this.state.viewOnce&&!this.state.sendAsSticker&&a.length<f.default.MAX_FILES,s="add-alt",i=(0,$.jsx)(W.default,{className:(0,o.default)(D.default.addMediaButton,{[D.default.addMediaButtonDisabled]:!e}),disabled:!e,name:s,title:O.default.t(235),onClick:this._handleAddFileClick,"aria-label":O.default.t(235)},"media-more");let n;a.length>0&&(n=(0,$.jsxs)(I.FlexRow,{className:D.default.filmstripContainer,justify:"center",align:"start",children:[this.getThumbs(),i]})),r=(0,$.jsxs)("div",{className:D.default.footer,children:[n,t]})}}const d=(0,o.default)(D.default.container,{[D.default.previewOnly]:t&&t.type!==J});let c=(0,$.jsxs)(I.FlexColumn,{className:d,align:"stretch",children:[i,s,r,(0,$.jsx)("input",{ref:this._setRefFileInput,type:"file",accept:l,style:{display:"none"},onChange:this._handleFilePick,multiple:!0})]});return"attach"===this.props.theme&&(c=(0,$.jsx)(v.default,{theme:"media",onDrop:this._handleDrop,onDragChange:this._handleDragChange,children:(0,$.jsx)(C.default,{tabIndex:"-1",overflow:"hidden",onPaste:this._handlePaste,children:c})},"attach-image-modal")),(0,$.jsx)(P.default,{handlers:n,onRef:this._setRefHotKeys,children:c})}}te.defaultProps={onClose:()=>{},theme:"attach"},te.displayName="MediaEditor";const se=(0,U.default)((0,N.default)(te));function ae(e){return new Promise(((t,s)=>{const a=new Image;a.onload=()=>{t(a)},a.onerror=s,a.src=e}))}function ie(){return(ie=(0,n.default)((function*(e){let t=e.rgbaBuffer;if(!t){const s=R.default.get(e.filehash);if(!s)throw new Error("Failed to get media blob");const a=yield(0,j.blobToArrayBuffer)(s),i=(yield(0,X.default)(a)).frames[0];if(!i)throw new Error("Failed to get sticker first frame.");t=i.rgbaBuffer}const s=e.fullWidth,a=e.fullHeight,i=document.createElement("canvas");i.width=s,i.height=a;const n=i.getContext("2d"),o=n.createImageData(s,a);return o.data.set(new Uint8Array(t)),n.putImageData(o,0,0),i}))).apply(this,arguments)}t.default=class extends se{handleRequestDismiss(){return this.getComponent().handleRequestDismiss()}}},11725:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function({onClose:e,item:t}){const{mimetype:s,fullPreview:a}=t;return(0,l.jsxs)("div",{className:o.default.container,children:[(0,l.jsx)(n.default,{onClose:e}),(0,l.jsx)(i.default,{mimeType:s,url:a})]})};var i=a(s(59732)),n=a(s(77903)),o=a(s(81419)),l=s(85893)},23742:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function({data:e,rotation:t,cropOrigin:s,cropSize:a,containerSize:g,onCropChange:_}){const v=e.resetCropRotate().setRotation(t),C=(0,i.useRef)(),x=(0,i.useRef)(),{width:S,height:y}=a,{x:E,y:j}=s,I=(0,i.useRef)(a),M=S/I.current.width,T=y/I.current.height,b=e.width,P=e.height,{width:L,height:w}=p(b,P,t),D=new d.default({width:g.width-20,height:g.height-20}),O=(0,c.calculateContainScale)(t%180?P:b,t%180?b:P,D,h),N=f/O,R=new d.default({width:b+2*N,height:P+2*N}),{width:k,height:A}=p(R.width,R.height,t),F=R.width/2,B=R.height/2;(0,i.useEffect)((()=>{const e=C.current,t=x.current;var s;e&&t&&0===e.nodes().length&&(e.nodes([t]),null===(s=t.getLayer())||void 0===s||s.batchDraw())}));const U=e=>{const{target:t}=e,s=Math.round(t.x()),a=Math.round(t.y()),i=Math.min(Math.round(t.width()*t.scaleX()),b-s),n=Math.min(Math.round(t.height()*t.scaleY()),P-a);_(new l.default({x:s,y:a}),new d.default({width:i,height:n}))};return(0,u.jsxs)("div",{className:o.default.container,children:[(0,u.jsx)(n.default,{data:v,scale:O,canEditLayer:!1,style:{padding:f}}),(0,u.jsx)(r.Stage,{className:o.default.cropperContainer,width:Math.round(k*O),height:Math.round(A*O),scaleX:O,scaleY:O,children:(0,u.jsx)(r.Layer,{rotation:t,offsetX:F,offsetY:B,x:k/2,y:A/2,children:(0,u.jsxs)(r.Group,{x:N,y:N,children:[(0,u.jsx)(r.Rect,{x:0,y:0,width:b,height:P,fill:"black",opacity:.6}),(0,u.jsx)(r.Rect,{ref:x,fill:"red",x:E,y:j,width:I.current.width,height:I.current.height,scaleX:M,scaleY:T,draggable:!0,dragBoundFunc:e=>{const{width:s,height:a}=p(S,y,t);let{x:i,y:n}=function(e,t,s,a,i){switch((i%360+360)%360){case 0:return{x:e,y:t};case 90:return{x:e-s,y:t};case 180:return{y:t-a,x:e-s};case 270:return{x:e,y:t-a};default:throw new Error("Unsupported angle")}}(e.x,e.y,s*O,a*O,t);i<f?i=f:(i-f)/O+s>L&&(i=Math.round(L-s+N)*O),n<f?n=f:(n-f)/O+a>w&&(n=Math.round(w-a+N)*O);return function(e,t,s,a,i){switch((i%360+360)%360){case 0:return{x:e,y:t};case 90:return{x:e+s,y:t};case 180:return{y:t+a,x:e+s};case 270:return{x:e,y:t+a};default:throw new Error("Unsupported angle")}}(i,n,s*O,a*O,t)},onTransformEnd:U,onDragEnd:U,globalCompositeOperation:"destination-out"}),(0,u.jsx)(r.Transformer,{ref:C,anchorStroke:"blue",anchorFill:"white",anchorSize:10,anchorCornerRadius:5,borderEnabled:!1,centeredScaling:!1,resizeEnabled:!0,rotateEnabled:!1,ignoreStroke:!0,boundBoxFunc:(e,s)=>{const a=b*O+20,i=P*O+20,n=m(e,a,i,t,-t),o=m(s,a,i,t,-t);return Math.round(o.x)<f?(o.x=f,o.width=n.width+(n.x-f)):Math.round(o.width)<20?(o.x=n.x,o.width=n.width):Math.round(o.x+o.width)>Math.round(a)-f&&(o.width=a-o.x-f),Math.round(o.y)<f?(o.y=f,o.height=n.height+(n.y-f)):Math.round(o.height)<20?(o.y=n.y,o.height=n.height):Math.round(o.y+o.height)>Math.round(i)-f&&(o.height=i-o.y-f),m(o,a,i,0,t)},keepRatio:!1},"transformer")]})},"cropper")})]})};var i=s(67294),n=a(s(64193)),o=a(s(70905)),l=a(s(7668)),r=s(47971),d=a(s(60738)),c=s(50240),u=s(85893);const h=new d.default({width:200,height:200}),f=10;function p(e,t,s){return{width:s%180==0?e:t,height:s%180==0?t:e}}function m(e,t,s,a,i){const n=Math.max(t,s),o=p(t,s,a),r=(n-o.width)/2,d=(n-o.height)/2,c=new l.default({x:e.x+r,y:e.y+d}),u=new l.default({x:n/2,y:n/2}),h=c.rotate(u,i),f=p(t,s,a+i),m=(n-f.width)/2,g=(n-f.height)/2;return{x:h.x-m,y:h.y-g,width:e.width,height:e.height,rotation:e.rotation}}},74711:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function({onClose:e,filename:t,filesize:s,fileExt:a,mimeType:h}){var f;const p=null!=s?r.default.filesize(s):"",m=null!==(f=u[h])&&void 0!==f?f:"preview-generic";return(0,c.jsxs)("div",{className:l.default.container,children:[(0,c.jsx)(o.default,{onClose:e,filename:t}),(0,c.jsx)(n.FlexColumn,{className:i.default.body,align:"center",justify:"center",children:(0,c.jsxs)(n.FlexColumn,{className:i.default.previewContainer,align:"center",justify:"center",children:[(0,c.jsx)("div",{className:i.default.previewIcon,children:(0,c.jsx)(d.default,{name:m})}),(0,c.jsx)("div",{className:i.default.header,children:r.default.t(1192)}),(0,c.jsxs)("div",{className:i.default.metadata,children:[p,a?` - ${a.toUpperCase()}`:null]})]})})]})};var i=a(s(2482)),n=s(63290),o=a(s(77903)),l=a(s(81419)),r=a(s(2408)),d=a(s(2966)),c=s(85893);const u={"text/plain":"preview-txt","text/rtf":"preview-doc","application/msword":"preview-doc","application/vnd.openxmlformats-officedocument.wordprocessingml.document":"preview-doc","text/csv":"preview-sheet","application/vnd.ms-excel":"preview-sheet","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":"preview-sheet","application/vnd.ms-powerpoint":"preview-slides","application/vnd.openxmlformats-officedocument.presentationml.presentation":"preview-slides","audio/aac":"preview-audio","audio/mp4":"preview-audio","audio/amr":"preview-audio","audio/mpeg":"preview-audio","audio/ogg; codecs=opus":"preview-audio","audio/wav":"preview-audio","application/zip":"preview-compressed"}},77903:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{filename:t,pageCount:s}=e;let a=null;null!=s&&s>0&&(a=n.default.t(267,{count:s,_plural:s}));return(0,l.jsxs)("div",{className:i.default.container,children:[(0,l.jsx)("div",{onClick:e.onClose,className:i.default.closeButton,children:(0,l.jsx)(o.default,{name:"x"})}),(0,l.jsxs)("div",{className:i.default.header,children:[t&&(0,l.jsx)("span",{className:i.default.title,children:t}),null!=a&&(0,l.jsx)("span",{className:i.default.pageCount,children:a})]})]})};var i=a(s(33807)),n=a(s(2408)),o=a(s(2966)),l=s(85893)},39110:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function({onClose:e,item:t}){const{mimetype:s,fullPreview:a,fullPreviewSize:d,documentPageCount:c,filename:u}=t;if(!(a&&d&&null!=c&&c>0))return(0,r.jsx)(n.default,{mimeType:t.mimetype,filesize:t.filesize,filename:t.filename,fileExt:t.fileExt,onClose:e});return(0,r.jsxs)("div",{className:l.default.container,children:[(0,r.jsx)(o.default,{onClose:e,filename:u,pageCount:c}),(0,r.jsx)(i.default,{fullPreview:a,fullPreviewSize:d,pageCount:c,showPageCount:!1,showBorder:!0,mimeType:s,filename:u})]})};var i=a(s(12218)),n=a(s(74711)),o=a(s(77903)),l=a(s(81419)),r=s(85893)},94252:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function({attachMedia:e,onClose:t,chat:s,viewOnce:a,viewOnceDisabled:i,onCaptionChange:f,onEnter:p,setCaptionInputRef:m,onToggleViewOnce:g,onFiles:_}){const{caption:v}=(0,d.default)(e,["caption"]);return(0,u.jsxs)("div",{className:c.default.container,children:[(0,u.jsx)(l.default,{onClose:t}),(0,u.jsx)(n.default,{mimeType:e.mimetype,url:e.fullPreview,isGif:e.isGif,size:e.fullPreviewSize,processing:e.state===h,preview:e.preview}),(0,u.jsx)("div",{className:c.default.footer,children:(0,u.jsx)(o.default,{chat:s,caption:v,viewOnce:a,viewOnceDisabled:i,msgType:r.TYPE.VIDEO,theme:"video",onToggleViewOnce:g,onChange:f,onEnter:p,onFiles:_,setCaptionInputRef:t=>{m(e.id,t)}},e.id)})]})};var i=s(73754),n=a(s(51427)),o=a(s(8731)),l=a(s(77903)),r=s(92954),d=a(s(76006)),c=a(s(43232)),u=s(85893);const{PROCESSING:h}=i.ATTACH_MEDIA_STATE},91420:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{children:t,onClick:s,icon:a,caret:d,disabled:c,title:u}=e;let h,f;if("string"==typeof a)switch(a){case"sans-serif":h=(0,r.jsx)(l.default,{name:"panel-emoji-flags",display:"inline"});break;case"checked":h=(0,r.jsx)(l.default,{name:"checkmark",display:"inline"});break;case"unchecked":h=(0,r.jsx)(l.default,{name:"x",display:"inline"});break;default:a&&(h=(0,r.jsx)(l.default,{name:a,display:"inline"}))}else a&&(h=a);if(d)switch(d){case"up":f=(0,r.jsx)(l.default,{name:"chevron-down-alt",display:"inline",className:n.default.rotate});break;case"down":f=(0,r.jsx)(l.default,{name:"chevron-down-alt",display:"inline"})}return(0,r.jsxs)("div",{role:"button",tabIndex:"-1",onClick:s,className:(0,i.default)(n.default.container,e.className,{[n.default.disabled]:c}),title:u,children:[h&&(0,r.jsx)(o.FlexRow,{align:"center",justify:"center",className:n.default.icon,children:h}),t&&(0,r.jsx)("span",{className:n.default.body,children:t}),f&&(0,r.jsx)("span",{className:n.default.caret,children:f})]})};var i=a(s(94184)),n=a(s(35588)),o=s(63290),l=a(s(2966)),r=s(85893)},40156:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(67294),n=a(s(91420)),o=a(s(78055)),l=a(s(96701)),r=a(s(87482)),d=s(9492),c=s(63290),u=a(s(2408)),h=a(s(63477)),f=a(s(68062)),p=s(85893);class m extends i.Component{constructor(...e){super(...e),this.state={colorPicker:null},this._handleColorPickerOpen=e=>{e.preventDefault(),e.stopPropagation();const t={menu:(0,p.jsx)(r.default,{onColorSelect:this.props.onColorSelect,selectedColor:this.props.selectedColor,onColorPickerClose:this._handleColorPickerClose}),dirX:u.default.isRTL()?d.DirX.RIGHT:d.DirX.LEFT,dirY:d.DirY.BOTTOM,type:"color_picker",anchor:e.target};this.setState({colorPicker:t})},this._handleColorPickerClose=()=>{this.setState({colorPicker:null})}}isPanelVisible(){return Boolean(this.state.colorPicker)}render(){const{colors:e,onColorSelect:t,selectedColor:s}=this.props,a=e.map((({primaryColor:e,secondaryColor:a})=>(0,p.jsx)(l.default,{primaryColor:e,onSelect:()=>t(e),selected:Boolean(s&&s.equals(e))},e.toString())));let i=null;return this.state.colorPicker&&(i=(0,p.jsx)(h.default,{displayName:"ColorPicker",escapable:!0,popable:!0,requestDismiss:this._handleColorPickerClose,children:(0,p.jsx)(f.default,{contextMenu:this.state.colorPicker})})),(0,p.jsxs)("div",{className:o.default.container,children:[(0,p.jsx)(c.FlexRow,{className:o.default.colorChipsContainer,children:a}),(0,p.jsx)(n.default,{onClick:this._handleColorPickerOpen,caret:i?"down":"up"}),i]})}}t.default=m,m.displayName="ColorToolbar"},96701:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(s(94184)),n=s(67294),o=a(s(89471)),l=s(85893);class r extends n.Component{constructor(...e){super(...e),this.state={hover:!1,active:!1},this._handleMouseEnter=()=>{this.setState({hover:!0})},this._handleMouseLeave=()=>{this.setState({hover:!1})},this._handleMouseDown=()=>{this.setState({active:!0})},this._handleMouseUp=()=>{this.setState({active:!1})}}render(){const{primaryColor:e,secondaryColor:t,onSelect:s,selected:a,withBorder:n}=this.props,{hover:r,active:d}=this.state;return(0,l.jsx)("div",{onClick:s,onMouseEnter:this._handleMouseEnter,onMouseLeave:this._handleMouseLeave,onMouseDown:this._handleMouseDown,onMouseUp:this._handleMouseUp,className:(0,i.default)(o.default.colorButton,{[o.default.selected]:a,[o.default.hover]:r,[o.default.active]:d}),style:{backgroundColor:d&&!a?e.withAlpha(.2).toRgbaString():"transparent"},children:(0,l.jsx)("div",{className:(0,i.default)(o.default.primaryColorChip,{[o.default.colorChipWithBorder]:n&&e.isWhite(),[o.default.primaryColorChipMedium]:"medium"===this.props.theme}),style:{backgroundColor:e.toRgbaString()},children:t&&a&&(0,l.jsx)("div",{className:o.default.secondaryColorChip,style:{backgroundColor:t.toRgbaString()}})})})}}t.default=r,r.displayName="ColorChip"},63097:(e,t,s)=>{"use strict";var a=s(95318),i=s(20862);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=s(67294),o=i(s(33845)),l=a(s(96701)),r=a(s(95698)),d=s(30905),c=a(s(39e3)),u=s(20845),h=s(85893);class f extends n.Component{constructor(...e){super(...e),this._setRefHexColorInput=e=>this._refHexColorInput=e,this.state={inputColorVal:this.props.color.toHex(),selectedColor:this.props.color},this._handleInputChange=e=>{const t=e.target.value;if(this.setState({inputColorVal:t}),!t||t&&!(0,o.isValidHex)(t))return;const s=o.default.fromHex(t);this.props.onChangeColor(s)},this._handleEnter=()=>{this.props.onColorPickerClose()}}static getDerivedStateFromProps(e,t){const s={};return e.color!==t.selectedColor&&((0,o.compareHex)(t.inputColorVal,e.color.toHex())||(s.inputColorVal=e.color.toHex()),s.selectedColor=e.color),s}render(){const{color:e}=this.props,{inputColorVal:t}=this.state;return(0,h.jsxs)("div",{className:r.default.container,style:{width:d.CONTAINER_WIDTH,height:d.INPUT_HEIGHT},children:[(0,h.jsx)(l.default,{withBorder:!0,primaryColor:e,selected:!1,theme:"medium"}),(0,h.jsx)(c.default,{handlers:{enter:this._handleEnter},children:(0,h.jsx)(u.SelectableDiv,{selectable:!0,children:(0,h.jsx)("input",{type:"text",ref:this._setRefHexColorInput,className:r.default.input,value:t,onChange:this._handleInputChange})})})]})}}t.default=f,f.displayName="ColorPickerInput"},31557:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(s(23493)),n=s(67294),o=a(s(33845)),l=a(s(56347)),r=s(30905),d=s(39350),c=s(85893);class u extends n.Component{constructor(e){super(e),this._setCanvasRef=e=>{this._canvasRef=e},this._updateIsDraggingAndPosition=(e,t)=>{null!=t&&this.setState({isDragging:t});const{x:s,y:a}=this._getCursorPosition(e),i=this._getColorAt({x:s,y:a});this._updateSelectedColor(i),this.props.onChangeCanvasColor(i)},this._handleMouseDown=e=>{this._updateIsDraggingAndPosition(e,!0)},this._handleMouseMove=e=>{this.state.isDragging&&(e.stopPropagation(),e.preventDefault(),this._updateIsDraggingAndPosition(e))},this._handleMouseUp=e=>{this._updateIsDraggingAndPosition(e,!1)},this._getCursorPosition=e=>{const t=this._canvasRef;if(!t)return{x:0,y:0};const s=t.getBoundingClientRect();let a=e.clientX-s.left,i=e.clientY-s.top;return a>s.width&&(a=s.width-.1),a<0&&(a=0),i>s.height&&(i=s.height),i<0&&(i=.1),a-=r.CURSOR_SIZE/2,i-=r.CURSOR_SIZE/2,{x:a,y:i}},this._getColorAt=e=>{const t=this._canvasRef;if(!t)return new o.default(0,0,0);const s=e.x+r.CURSOR_SIZE/2,a=e.y+r.CURSOR_SIZE/2,i=t.getContext("2d").getImageData(s,a,1,1).data;return new o.default(i[0],i[1],i[2])},this.state={isDragging:!1},this._updateSelectedColor=(0,i.default)(this.props.onChangeSelectedColor,r.THROTTLE_WAIT_TIME)}componentDidMount(){this._initColorPicker()}_initColorPicker(){const e=this._canvasRef;if(!e)return;const t=e.getContext("2d");let s=t.createLinearGradient(0,0,e.width,0);s.addColorStop(0,"#ff0000"),s.addColorStop(1/6,"#ffff00"),s.addColorStop(1/6*2,"#00ff00"),s.addColorStop(.5,"#00ffff"),s.addColorStop(1/6*4,"#0000ff"),s.addColorStop(1/6*5,"#ff00ff"),s.addColorStop(1,"#ff0000"),t.fillStyle=s,t.fillRect(0,0,e.width,e.height),s=t.createLinearGradient(0,0,0,e.height),s.addColorStop(0,"rgba(255, 255, 255, 1)"),s.addColorStop(.5,"rgba(255, 255, 255, 0)"),s.addColorStop(1,"rgba(255, 255, 255, 0)"),t.fillStyle=s,t.fillRect(0,0,e.width,e.height),s=t.createLinearGradient(0,0,0,e.height),s.addColorStop(0,"rgba(0, 0, 0, 0)"),s.addColorStop(.5,"rgba(0, 0, 0, 0)"),s.addColorStop(1,"rgba(0, 0, 0, 1)"),t.fillStyle=s,t.fillRect(0,0,e.width,e.height)}render(){const{color:e}=this.props,t=(0,d.getPositionFromColor)(e);return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("canvas",{width:r.CONTAINER_WIDTH,height:r.CANVAS_HEIGHT,className:l.default.canvas,ref:this._setCanvasRef,onMouseDown:this._handleMouseDown,onMouseMove:this._handleMouseMove,onMouseUp:this._handleMouseUp}),(0,c.jsx)("div",{className:l.default.cursor,style:{width:r.CURSOR_SIZE,height:r.CURSOR_SIZE,left:t.x,top:t.y,backgroundColor:e.toRgbaString()}})]})}}t.default=u,u.displayName="ColorPickerPanel"},30905:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.THROTTLE_WAIT_TIME=t.DEFAULT_COLOR=t.CURSOR_SIZE=t.INPUT_HEIGHT=t.CANVAS_HEIGHT=t.CONTAINER_HEIGHT=t.CONTAINER_WIDTH=void 0;var i=a(s(33845));t.CONTAINER_WIDTH=334;t.CONTAINER_HEIGHT=203;const n=150.22;t.CANVAS_HEIGHT=n;t.INPUT_HEIGHT=52.78;t.CURSOR_SIZE=20;const o=new i.default(210,252,86);t.DEFAULT_COLOR=o;t.THROTTLE_WAIT_TIME=900},87482:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(67294),n=a(s(63097)),o=a(s(31557)),l=s(30905),r=a(s(58510)),d=s(85893);class c extends i.Component{constructor(e){var t;super(e),this.handleChangeCanvasColor=e=>{this.setState({canvasColor:e})},this.handleChangeSelectedColor=e=>{this.props.onColorSelect(e)},this.handleChangeColor=e=>{this.handleChangeCanvasColor(e),this.handleChangeSelectedColor(e)},this.state={canvasColor:null!==(t=this.props.selectedColor)&&void 0!==t?t:l.DEFAULT_COLOR}}render(){const{canvasColor:e}=this.state;return(0,d.jsxs)("div",{className:r.default.container,style:{width:l.CONTAINER_WIDTH,height:l.CONTAINER_HEIGHT},children:[(0,d.jsx)(o.default,{color:e,onChangeCanvasColor:this.handleChangeCanvasColor,onChangeSelectedColor:this.handleChangeSelectedColor}),(0,d.jsx)(n.default,{color:e,onChangeColor:this.handleChangeColor,onColorPickerClose:this.props.onColorPickerClose})]})}}t.default=c,c.displayName="ColorPicker"},96532:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.CropRotateToolbar=function({canReset:e,onRotateCanvas:t,onReset:s}){return(0,r.jsxs)(o.FlexRow,{className:n.default.container,children:[(0,r.jsx)(i.default,{className:n.default.rotateLeftButton,icon:"media-editor-rotate-left",title:l.default.t(1199),onClick:()=>t(-90)}),(0,r.jsx)(i.default,{icon:"media-editor-rotate-right",title:l.default.t(1200),onClick:()=>t(90)}),(0,r.jsx)(i.default,{onClick:s,disabled:!e,children:l.default.t(1193)})]})};var i=a(s(91420)),n=a(s(57775)),o=s(63290),l=a(s(2408)),r=s(85893)},64603:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(s(81109)),n=s(67294),o=a(s(91420)),l=s(63290),r=a(s(50918)),d=a(s(9079)),c=s(57528),u=a(s(63477)),h=a(s(68062)),f=a(s(82669)),p=s(85893);class m extends n.Component{constructor(...e){super(...e),this.state={contextMenu:null},this._setRefButton=e=>{this._refButton=e},this._handleOpen=()=>{this.state.contextMenu||this._refButton&&this.setState({contextMenu:{menu:this._getDropdown(),anchor:this._refButton}})},this._handleClose=()=>{this.setState({contextMenu:null})}}_getDropdown(){const{fonts:e,onFontSelect:t,onAlignmentSelect:s,selectedFont:a,selectedAlignment:i}=this.props;return(0,p.jsx)(d.default,{fonts:e,selectedFont:a,selectedAlignment:i,onFontSelect:t,onAlignmentSelect:s})}isMenuVisible(){return Boolean(this.state.contextMenu)}render(){const{selectedFont:e}=this.props,{contextMenu:t}=this.state,s=Boolean(t);let a;return t&&(a=(0,p.jsx)(u.default,{displayName:"MediaEditorFontDropdown",escapable:!0,popable:!0,requestDismiss:this._handleClose,children:(0,p.jsx)(h.default,{contextMenu:t})})),(0,p.jsxs)("div",{ref:this._setRefButton,className:r.default.container,children:[(0,p.jsx)(o.default,{onClick:this._handleOpen,icon:(0,p.jsx)(g,{font:e}),selected:s,caret:s?"down":"up",children:(0,p.jsx)("span",{className:r.default.fontLabel,children:(0,c.getFontTranslation)(e)})}),(0,p.jsx)(f.default,{transitionName:"dropdown",children:a})]})}}function g({font:e}){return(0,p.jsx)(l.FlexRow,{className:r.default.icon,style:(0,i.default)({},(0,c.getFontStyle)(e)),justify:"center",align:"center",children:(0,p.jsx)("div",{"aria-hidden":"true",children:"A"})})}t.default=m,m.displayName="FontToolbar"},9079:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{onFontSelect:t,onAlignmentSelect:s,selectedFont:a,selectedAlignment:p}=e;(0,n.useEffect)((()=>{d.default.loadAllFonts()}),[]);return(0,h.jsxs)("div",{children:[e.fonts.map((e=>{let s;a===e&&(s=(0,h.jsx)("span",{className:r.default.selected,children:(0,h.jsx)(u.default,{name:"checkmark",display:"inline"})}));const i=(0,c.getFontTranslation)(e);let n;switch(e){case c.FONTS.SANS_SERIF:n=r.default.sansSerif;break;case c.FONTS.SERIF:n=r.default.serif;break;case c.FONTS.NORICAN_REGULAR:n=r.default.noricanRegular;break;case c.FONTS.BRYNDAN_WRITE:n=r.default.bryndanWrite;break;case c.FONTS.OSWALD_HEAVY:n=r.default.oswaldHeavy}return(0,h.jsx)(o.default,{action:s=>((e,s)=>{e.stopPropagation(),t(s)})(s,e),children:(0,h.jsxs)("div",{role:"button",className:r.default.item,style:(0,c.getFontStyle)(e),children:[(0,h.jsx)("span",{className:n,children:i}),s]})},e)})),(0,h.jsx)(l.FlexRow,{className:r.default.alignmentContainer,justify:"around",align:"center",children:f.map((({alignment:e,icon:t})=>(0,h.jsx)(l.FlexItem,{children:(0,h.jsx)(o.default,{action:t=>((e,t)=>{e.stopPropagation(),s(t)})(t,e),children:(0,h.jsx)(u.default,{name:t,className:(0,i.default)(r.default.alignmentIcon,{[r.default.alignmentIconSelected]:e===p})})})},t)))},"alignment")]})};var i=a(s(94184)),n=s(67294),o=a(s(47452)),l=s(63290),r=a(s(67024)),d=a(s(32397)),c=s(57528),u=a(s(2966)),h=s(85893);const f=[{alignment:c.TextAlignment.LEFT,icon:"align-left"},{alignment:c.TextAlignment.CENTER,icon:"align-center"},{alignment:c.TextAlignment.RIGHT,icon:"align-right"}]},35087:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function({selectedLayer:e,inPaintMode:t,inCropRotateMode:s,inTextEditingMode:a,canUndo:C,canRedo:x,onPaintSelect:S,onCropRotateSelect:y,onTextSelect:E,onEmojiSelect:j,onToggleEmojiPanel:I,onStickerSelect:M,onToggleStickerPanel:T,onUndo:b,onRedo:P}){const[L,w]=(0,i.useState)(),[D,O]=(0,i.useState)(),N=(0,i.useRef)({});N.current={inPaintMode:t,onEmojiSelect:j,onStickerSelect:M,onPaintSelect:S};const R=()=>{s?y():t&&S()},k=()=>{w(null),I(!1)},A=()=>{O(null),T(!1)};return(0,v.jsxs)(c.MenuBar,{theme:"media-editor",children:[(0,v.jsx)(c.MenuBarItem,{icon:(0,v.jsx)(h.default,{name:"media-editor-emoji"}),a8nText:"emoji-button",title:d.default.t(1196),onClick:e=>{e.preventDefault(),e.stopPropagation(),R();const t=(0,v.jsx)(o.default,{onEmoji:e=>{N.current.inPaintMode&&N.current.onPaintSelect(),N.current.onEmojiSelect(e),k()},onFocusNext:k,onFocusPrev:k});w({menu:t,dirY:n.DirY.TOP,type:"emoji_picker",anchor:e.target}),I(!0)},selected:Boolean(L)||e instanceof r.default&&e.isEmoji()},"emoji"),(0,v.jsx)(c.MenuBarItem,{icon:(0,v.jsx)(h.default,{name:"media-editor-sticker"}),a8nText:"sticker-button",title:d.default.t(1201),onClick:e=>{e.preventDefault(),e.stopPropagation(),R();const t=e=>{N.current.inPaintMode&&N.current.onPaintSelect(),N.current.onStickerSelect(e),A()};let s;l.default.supportsFeature(l.default.F.MD_BACKEND)?_.default.webServerStickerPanel&&(s=(0,v.jsx)(g.default,{onSticker:t,onFocusNext:A,onFocusPrev:A})):s=(0,v.jsx)(u.default,{onSticker:t,onFocusNext:A,onFocusPrev:A}),s&&(O({menu:s,dirY:n.DirY.TOP,type:"sticker_picker",anchor:e.target}),T(!0))},selected:Boolean(D)||e instanceof r.default&&e.isSticker()},"sticker"),(0,v.jsx)(c.MenuBarItem,{icon:(0,v.jsx)(h.default,{name:"media-editor-text"}),a8nText:"text-button",title:d.default.t(1202),onClick:e=>{e.preventDefault(),R(),E()},selected:a||e instanceof f.default},"text"),(0,v.jsx)(c.MenuBarItem,{icon:(0,v.jsx)(h.default,{name:"media-editor-drawing"}),a8nText:"paint-button",title:d.default.t(1197),onClick:e=>{e.preventDefault(),t||R(),S()},selected:t},"paint"),(0,v.jsx)(c.MenuBarItem,{icon:(0,v.jsx)(h.default,{name:"media-editor-crop-rotate"}),a8nText:"crop-rotate-button",title:d.default.t(1194),onClick:e=>{e.preventDefault(),s||R(),y()},selected:s},"crop-rotate"),(0,v.jsx)(c.MenuBarItem,{icon:(0,v.jsx)(h.default,{name:"media-editor-undo"}),a8nText:"undo-button",title:d.default.t(1203),disabled:!C,onClick:b},"undo"),(0,v.jsx)(c.MenuBarItem,{icon:(0,v.jsx)(h.default,{name:"media-editor-redo"}),a8nText:"redo-button",title:d.default.t(1198),disabled:!x,onClick:P},"redo"),D&&(0,v.jsx)(p.default,{displayName:"StickerPicker",escapable:!0,popable:!0,requestDismiss:A,children:(0,v.jsx)(m.default,{contextMenu:D})}),L&&(0,v.jsx)(p.default,{displayName:"EmojiPicker",escapable:!0,popable:!0,requestDismiss:k,children:(0,v.jsx)(m.default,{contextMenu:L})})]})};var i=s(67294),n=s(9492),o=a(s(91137)),l=a(s(12950)),r=a(s(85499)),d=a(s(2408)),c=s(47941),u=a(s(3754)),h=a(s(2966)),f=a(s(4301)),p=a(s(63477)),m=a(s(68062)),g=a(s(30023)),_=a(s(65565)),v=s(85893)},55154:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function({checked:e,onBackgroundToggle:t}){const s=(0,d.jsx)("div",{className:(0,i.default)(r.default.cirle,{[r.default.circleFilled]:e}),children:e?(0,d.jsx)("div",{className:r.default.checked,children:(0,d.jsx)(l.default,{name:"checkmark"})}):(0,d.jsx)("div",{className:r.default.unchecked})});return(0,d.jsx)(n.default,{icon:s,onClick:t,children:o.default.t(1184)})};var i=a(s(94184)),n=a(s(91420)),o=a(s(2408)),l=a(s(2966)),r=a(s(53964)),d=s(85893)},98417:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const t=e.thicknesses.map(((t,s)=>(0,l.jsx)(r,{thickness:t,onThicknessSelect:e.onThicknessSelect,selectedThickness:e.selectedThickness},s)));return(0,l.jsx)("div",{className:n.default.container,children:t})};var i=a(s(94184)),n=a(s(65251)),o=s(45139),l=s(85893);function r(e){return(0,l.jsx)("div",{onClick:()=>e.onThicknessSelect(e.thickness),className:(0,i.default)(n.default.thicknessButton,{[n.default.selected]:e.selectedThickness&&e.selectedThickness===e.thickness}),children:(0,l.jsx)("div",{className:n.default.thicknessChip,style:{height:(0,o.getThicknessValue)(e.thickness),width:(0,o.getThicknessValue)(e.thickness)}})},e.thickness.toString())}},39350:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getPositionFromColor=function(e){const t=e.toHsl(),s=a.CONTAINER_WIDTH*t.hue-a.CURSOR_SIZE/2,i=a.CANVAS_HEIGHT*(1-t.lightness)-a.CURSOR_SIZE/2;return{x:s,y:i}};var a=s(30905)},40302:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.getPointFromStage=function(e){const t=e.currentTarget.getStage(),{x:s,y:a}=t.getPointerPosition()||{x:0,y:0},{x:n,y:o}=t.getAbsoluteScale();return new i.default({x:s/n,y:a/o})},t.getPointFromGroup=function(e){return new i.default({x:e.target.x()-e.target.offsetX(),y:e.target.y()-e.target.offsetY()})},t.getRotationFromGroup=function(e){return e.target.rotation()},t.getScaleFromGroup=function(e){return e.target.scaleX()},t.isEventOnAnchor=function(e){var t,s;return null!==(t=null===(s=e.target.attrs.name)||void 0===s?void 0:s.includes("anchor"))&&void 0!==t&&t};var i=a(s(7668))},47971:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"Circle",{enumerable:!0,get:function(){return a.Circle}}),Object.defineProperty(t,"Group",{enumerable:!0,get:function(){return a.Group}}),Object.defineProperty(t,"Image",{enumerable:!0,get:function(){return a.Image}}),Object.defineProperty(t,"Layer",{enumerable:!0,get:function(){return a.Layer}}),Object.defineProperty(t,"Line",{enumerable:!0,get:function(){return a.Line}}),Object.defineProperty(t,"Path",{enumerable:!0,get:function(){return a.Path}}),Object.defineProperty(t,"Rect",{enumerable:!0,get:function(){return a.Rect}}),Object.defineProperty(t,"Stage",{enumerable:!0,get:function(){return a.Stage}}),Object.defineProperty(t,"Text",{enumerable:!0,get:function(){return a.Text}}),Object.defineProperty(t,"Transformer",{enumerable:!0,get:function(){return a.Transformer}}),s(7643),s(71298),s(27149),s(87339),s(75244),s(23787),s(29516);var a=s(77201)},50240:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.calculateContainScale=function(e,t,s,a){if(0===e||0===t)return 1;if(!s.isEmpty()&&(e>s.width||t>s.height))return Math.min(s.width/e,s.height/t);if(!a.isEmpty()&&e<a.width&&t<a.height)return Math.min(a.width/e,a.height/t);return 1}},22011:(e,t,s)=>{"use strict";var a=s(20862),i=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=s(67294),o=i(s(84978)),l=i(s(91952)),r=i(s(75940)),d=i(s(55454)),c=i(s(2408)),u=s(14137),h=a(s(59606)),f=s(12735),p=s(84498),m=i(s(4231)),g=i(s(46714)),_=i(s(29458)),v=s(85893);class C extends n.Component{constructor(e){super(e),this._labelModel=null,this.handleOk=()=>{const{labelName:e,labelColor:t,labelNameError:s}=this.state;if(s)return;(0,f.logLabelOperationEvent)(m.default.LABEL_OPERATIONS.CLICK_POSITIVE,1,this.props.onAddLabel?m.default.LABEL_TARGETS.ADD_LABEL_DIALOG:m.default.LABEL_TARGETS.EDIT_LABEL_DIALOG);const a=e&&e.trim(),i=this._validateLabelName(a||"");i.passed?(this.props.labelId&&this.props.onUpdateLabel?this.props.onUpdateLabel({id:this.props.labelId,color:t,name:e},h.LABEL_PROPERTIES.NAME):this.props.onAddLabel&&this.props.onAddLabel(e||"",t),this.props.onCancel?this.props.onCancel():l.default.closeModal()):this.setState({labelNameError:i.error})},this.handleCancel=()=>{(0,f.logLabelOperationEvent)(m.default.LABEL_OPERATIONS.CLICK_NEGATIVE,1,this.props.onAddLabel?m.default.LABEL_TARGETS.ADD_LABEL_DIALOG:m.default.LABEL_TARGETS.EDIT_LABEL_DIALOG),this.props.onCancel?this.props.onCancel():l.default.closeModal()},this._handleLabelNameChange=e=>{const t=this._validateLabelName(e);this.setState({labelName:e,labelNameError:t.passed?void 0:t.error})},this._validateLabelName=e=>{let t=!0,s=null;return e&&""!==e.trim()||(t=!1),this._labelModel&&this._labelModel.name===e||0===h.default.where({name:e}).length||(t=!1,s=c.default.t(240)),{passed:t,error:s}},this._handleKeyEnter=e=>{e.stopPropagation(),this.handleOk()},this.props.labelId&&(this._labelModel=h.default.assertGet(this.props.labelId)),this.state={labelColor:this._labelModel&&this._labelModel.color||void 0,labelName:this._labelModel&&this._labelModel.name||"",labelNameError:void 0}}componentDidMount(){this.props.onAddLabel?(h.default.getNewLabelColor().then((e=>{this.setState({labelColor:e||d.default.DEFAULT_SMB__NEW_LABEL_COLOR})})),(0,f.logLabelOperationEvent)(m.default.LABEL_OPERATIONS.VIEW,1,m.default.LABEL_TARGETS.ADD_LABEL_DIALOG)):this.props.onUpdateLabel&&(0,f.logLabelOperationEvent)(m.default.LABEL_OPERATIONS.VIEW,1,m.default.LABEL_TARGETS.EDIT_LABEL_DIALOG)}render(){const e=!this._validateLabelName(this.state.labelName.trim()).passed;return(0,v.jsx)(r.default,{title:this.props.onUpdateLabel?c.default.t(801):c.default.t(243),okText:c.default.t(2085),onOK:this.handleOk,okDisabled:e,onCancel:this.handleCancel,children:(0,v.jsxs)("div",{className:o.default.inputContainer,children:[(0,v.jsx)("div",{className:o.default.label,children:this.state.labelColor?(0,p.renderLabelSvg)((0,u.intColorToHex)(this.state.labelColor)):(0,v.jsx)(g.default,{stroke:5,size:20})}),(0,v.jsx)("div",{className:o.default.input,children:(0,v.jsx)(_.default,{a8n:"add-new-label-name-input",focusOnMount:!0,hideFloatingLabel:!0,showRemaining:!0,supportsEmoji:!0,value:this.state.labelName,error:this.state.labelNameError,maxLength:d.default.SMB_LABELS.MAX_LABEL_LENGTH,onChange:this._handleLabelNameChange,onEnter:this._handleKeyEnter,placeholder:c.default.t(242)})})]})})}}t.default=C,C.displayName="AddOrEditLabelPopup"},12716:(e,t,s)=>{"use strict";var a=s(20862),i=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=s(55084),o=s(67294),l=i(s(91952)),r=i(s(75940)),d=i(s(55454)),c=s(54647),u=i(s(4919)),h=i(s(2408)),f=s(30333),p=s(68793),m=s(26491),g=s(97504),_=i(s(29458)),v=a(s(49201)),C=s(85893);class x extends o.PureComponent{constructor(...e){super(...e),this.state={isSubmitting:!1,submitted:!1,reason:""},this._onInputChange=e=>{this.setState({reason:e})},this._handleOk=()=>{const{product:e,sessionId:t}=this.props;(0,f.logAppealProductCatalogClick)(t),this.setState({isSubmitting:!0}),(0,p.appealProduct)(e.id.toString(),this.state.reason).then((()=>{e.canAppeal=!1,e.reviewStatus=m.PRODUCT_REVIEW_STATUS.PENDING,(0,f.logAppealProductCatalogSuccess)(t),this.setState({isSubmitting:!1,submitted:!0})})).catch((0,n.filteredCatch)(c.ServerStatusCodeError,(e=>{l.default.openToast((0,C.jsx)(v.default,{msg:h.default.t(499),id:(0,v.genId)("catalog_appeal_submission_failed")})),(0,f.logAppealProductCatalogFailed)(t,e.status),this.setState({isSubmitting:!1})})))},this._handleCancel=()=>{l.default.closeModal()}}render(){const{submitted:e,isSubmitting:t,reason:s}=this.state;return e?(0,C.jsx)(r.default,{title:h.default.t(1550),onOK:this._handleCancel,children:(0,C.jsx)(g.TextDiv,{children:h.default.t(528)})}):(0,C.jsx)(r.default,{title:h.default.t(1550),onOK:this._handleOk,onCancel:this._handleCancel,okDisabled:t,children:(0,C.jsxs)("form",{children:[(0,C.jsx)(_.default,{a8n:"confirm-popup-text-input",placeholder:h.default.t(1099),onChange:this._onInputChange,value:s,maxLength:1e3}),(0,C.jsx)(u.default,{href:d.default.WA_COMMERCE_POLICY_URL,children:h.default.t(1103)})]})})}}t.default=x,x.displayName="AppealProductPopup"},59732:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function({mimeType:e,url:t}){return(0,n.jsx)("div",{className:i.default.container,"data-animate-attach-media":!0,children:(0,n.jsx)("div",{className:i.default.media,children:(0,n.jsx)("audio",{controls:!0,type:e,src:t})})})};var i=a(s(46771)),n=s(85893)},12048:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function({mimeType:e,filename:t}){const s=(0,n.default)(o.default.icon,d[e]?d[e].icon:"icon-doc-generic");return(0,r.jsx)("div",{className:o.default.container,"data-animate-attach-media":!0,children:(0,r.jsx)("div",{className:o.default.media,children:(0,r.jsxs)("div",{className:o.default.document,children:[(0,r.jsx)("div",{className:s}),(0,r.jsx)("div",{className:o.default.text,children:t})]})})})};var i=a(s(35937)),n=a(s(94184)),o=a(s(56342)),l=s(38961),r=s(85893);const d=(0,i.default)(l.MIMETYPES,(e=>"document"===e.msgType))},51427:(e,t,s)=>{"use strict";var a=s(20862),i=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function({mimeType:e,url:t,isGif:s,size:a,processing:i,preview:o}){let c;switch(m[e].msgType){case"image":c=(0,p.jsx)("img",{alt:d.default.t(2136),src:t,className:r.default.img});break;case"video":const a=s?{loop:!i,autoPlay:!i,muted:!1,controls:!1}:{},u=i?(0,p.jsx)("div",{className:r.default.spinner,children:(0,p.jsx)(h.default,{color:h.colorOptions.white,size:50,stroke:3})}):null,m=o?(0,p.jsx)("img",{alt:d.default.t(2136),className:r.default.staticPreview,src:`data:image/jpeg;base64,${o}`}):null,g=i?null:(0,p.jsx)(f.default,(0,n.default)((0,n.default)({controls:!0,controlsList:"nodownload nofullscreen",className:r.default.video},a),{},{src:t}));c=(0,p.jsxs)("div",{className:(0,l.default)(r.default.img,r.default.videoContainer),children:[u,g,m]});break;case"audio":c=(0,p.jsx)("audio",{controls:!0,className:r.default.audio,type:e,src:t})}return(0,p.jsx)("div",{className:r.default.container,"data-animate-attach-media":!0,children:(0,p.jsx)("div",{className:r.default.media,children:(0,p.jsx)(u.default,{type:"scaleDown",size:a,children:c})})})};var n=i(s(81109)),o=i(s(35937)),l=i(s(94184)),r=i(s(13149)),d=i(s(2408)),c=s(38961),u=i(s(90904)),h=a(s(46714)),f=i(s(92018)),p=s(85893);const m=(0,o.default)(c.MIMETYPES,(e=>"image"===e.msgType||"video"===e.msgType))},12218:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function({fullPreview:e,fullPreviewSize:t,pageCount:s,mimeType:a,filename:c,showPageCount:u=!0,showBorder:h=!1}){if(e&&t&&null!=s&&s>0){const a=l.default.t(267,{count:s,_plural:s});return(0,d.jsxs)("div",{className:o.default.container,"data-js-attach-preview":!0,children:[(0,d.jsx)("div",{className:o.default.preview,children:(0,d.jsx)(r.default,{type:"scaleDown",size:t,children:(0,d.jsx)("img",{alt:l.default.t(2136),src:e,className:(0,i.default)(o.default.img,{[o.default.imgBorder]:h})})})}),u&&(0,d.jsx)("div",{className:o.default.caption,children:a})]})}return(0,d.jsx)(n.default,{mimeType:a,filename:c})};var i=a(s(94184)),n=a(s(12048)),o=a(s(28469)),l=a(s(2408)),r=a(s(90904)),d=s(85893)},73895:(e,t,s)=>{"use strict";var a=s(20862),i=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function({disabled:e,isOn:t,mediaType:s,onChange:a,noMargin:i}){const[v,C]=(0,n.useState)((0,c.shouldShowNUX)(d.default.NUX.EPHEMERAL_VIEW_ONCE));return(0,n.useEffect)((()=>{if(!t)return;if(v){const e=(0,g.jsx)(l.default,{onOkClick:()=>{C(!1),r.default.closeModal()}});return void r.default.openModal(e)}const e=s===h.TYPE.VIDEO?u.default.t(1791):u.default.t(1788),a=(0,g.jsx)(p.default,{msg:e,id:(0,p.genId)("view-once-toast")});return r.default.openToast(a),()=>{r.default.closeToast(a)}}),[v,s,t]),(0,g.jsx)(m.default,{a8nText:o.default.key("view-once-toggle"),xstyle:[_.btnViewOnce,i&&_.btnNoMargin,e&&_.btnDisabled],disabled:e,onClick:()=>a(!t),"aria-pressed":t,children:(0,g.jsx)(f.default,{"aria-label":t?u.default.t(58):u.default.t(59),name:t?"view-once-media-select-on":"view-once-media-select",height:26,width:26})})};var n=s(67294),o=(i(s(56720)),i(s(76610))),l=i(s(41011)),r=i(s(91952)),d=i(s(55454)),c=s(86723),u=i(s(2408)),h=s(92954),f=i(s(2966)),p=a(s(49201)),m=i(s(89135)),g=s(85893);const _={btnViewOnce:{display:"f804f6gw",marginTop:"c46o30wg",marginEnd:"bugiwsl0",marginStart:"eab7llgz",color:"svlsagor"},btnNoMargin:{marginTop:"tt8xd2xn",marginEnd:"jnwc1y2a",marginBottom:"mpdn4nr2",marginStart:"svoq16ka"},btnDisabled:{cursor:"h2qzpyga",opacity:"notw83rv"}}},41011:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{onOkClick:t}=e;return(0,i.useEffect)((()=>()=>{(0,u.setNUX)(l.default.NUX.EPHEMERAL_VIEW_ONCE,{views:1,maxViews:1})}),[]),(0,m.jsx)(o.default,{onOK:t,cancelText:h.default.t(1103),onCancel:()=>{(0,r.openExternalLink)((0,d.getViewOnceFaqUrl)())},children:(0,m.jsxs)(c.FlexColumn,{children:[(0,m.jsx)(c.FlexItem,{xstyle:g.graphic,align:"center",children:(0,m.jsx)(f.default,{name:"view-once-sender-nux",width:195,height:177})}),(0,m.jsx)(p.TextHeader,{className:n.default.text,theme:"popup-title",children:h.default.t(1786)}),(0,m.jsx)(p.TextParagraph,{className:n.default.text,color:"secondary",children:h.default.t(1785)})]})})};var i=s(67294),n=(a(s(56720)),a(s(29669))),o=a(s(75940)),l=a(s(55454)),r=s(4919),d=s(57092),c=s(63290),u=s(86723),h=a(s(2408)),f=a(s(2966)),p=s(97504),m=s(85893);const g={graphic:{marginBottom:"t4zgqcuo"}}},92508:(e,t,s)=>{"use strict";var a=s(95318),i=s(20862);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){const[e,t]=(0,n.useState)(o.getAutoDownloadPhotos),[s,a]=(0,n.useState)(o.getAutoDownloadAudio),[i,u]=(0,n.useState)(o.getAutoDownloadVideos),[h,f]=(0,n.useState)(o.getAutoDownloadDocuments);return(0,c.jsxs)(r.default,{children:[(0,c.jsx)(r.SettingsCheckListItem,{a8nText:"option-photos",id:"photos",checked:e,onChange:()=>t((e=>{const t=!e;return o.setAutoDownloadPhotos(t),t})),children:l.default.t(1419)}),(0,c.jsx)(r.SettingsCheckListItem,{a8nText:"option-audio",id:"audio",checked:s,onChange:()=>a((e=>{const t=!e;return o.setAutoDownloadAudio(t),t})),children:l.default.t(1411)}),(0,c.jsx)(r.SettingsCheckListItem,{a8nText:"option-videos",id:"videos",checked:i,onChange:()=>u((e=>{const t=!e;return o.setAutoDownloadVideos(t),t})),children:l.default.t(1421)}),(0,c.jsx)(r.SettingsCheckListItem,{a8nText:"option-documents",id:"documents",checked:h,onChange:()=>f((e=>{const t=!e;return o.setAutoDownloadDocuments(t),t})),children:l.default.t(1414)}),(0,c.jsx)(r.SettingsCheckListSection,{children:(0,c.jsx)(d.TextDiv,{theme:"muted",children:l.default.t(1182)})})]})};var n=s(67294),o=i(s(86723)),l=a(s(2408)),r=i(s(31051)),d=s(97504),c=s(85893)},33322:(e,t,s)=>{"use strict";var a=s(20862),i=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(s(51463)),o=s(67294),l=i(s(76610)),r=s(38512),d=i(s(53939)),c=i(s(15701)),u=i(s(91952)),h=i(s(75940)),f=i(s(70521)),p=i(s(17025)),m=i(s(18260)),g=i(s(17747)),_=i(s(9042)),v=i(s(17061)),C=a(s(55588)),x=s(92231),S=i(s(86025)),y=i(s(19257)),E=i(s(67893)),j=i(s(2408)),I=i(s(71681)),M=i(s(2966)),T=s(85893);class b extends o.Component{constructor(...e){super(...e),this.flatListController=new E.default,this._handleBlockConfirm=e=>{(0,r.blockContact)(e).catch((()=>{})),u.default.closeModal()},this.handleBlock=()=>{u.default.openModal((0,T.jsx)(m.default,{title:j.default.t(232),filter:function(e){return!!p.default.isFilteredContact(e)&&(!c.default.get(e.id)||j.default.t(1438))},onCancel:()=>u.default.closeModal(),onSelect:(0,n.default)(this._handleBlockConfirm)}))},this._handleUnblockConfirm=e=>{(0,r.unblockContact)(e).catch((()=>{})),u.default.closeModal()},this._handleUnblockCancel=()=>{u.default.closeModal()},this._handleUnblock=(e,t)=>{u.default.openModal((0,T.jsx)(h.default,{okText:j.default.t(1709),onOK:this._handleUnblockConfirm.bind(this,t),cancelText:j.default.t(1912),onCancel:this._handleUnblockCancel,children:j.default.t(1710,{contact:t.formattedName})}))},this.renderItem=e=>{const{blocklist:t}=e,s=t.contact();return(0,T.jsx)(f.default,{contact:s,onClick:this._handleUnblock,onDelete:this._handleUnblock,waitIdle:!0},s.id.toString())}}componentDidMount(){this.props.listeners.add(c.default,"add remove",(()=>{this.forceUpdate()}))}getData(){return c.default.map((e=>({itemKey:e.id.toString(),blocklist:e})))}render(){let e,t;return c.default.length>0?(e=(0,T.jsx)(y.default,{flatListControllers:[this.flatListController],className:d.default.list,children:(0,T.jsx)(S.default,{flatListController:this.flatListController,direction:"vertical",data:this.getData(),renderItem:this.renderItem})}),t=(0,T.jsx)("div",{"data-a8n":l.default.key("blocked-description"),className:d.default.hint,children:j.default.t(231)})):e=(0,T.jsx)(x.Blocked,{}),(0,T.jsxs)(g.default,{children:[(0,T.jsx)(C.default,{title:j.default.t(323),onBack:this.props.onClose,type:C.DRAWER_HEADER_TYPE.LARGE}),(0,T.jsx)("div",{className:d.default.button,children:(0,T.jsx)(v.default,{a8nText:"li-add-blocked",onClick:this.handleBlock,icon:(0,T.jsx)(M.default,{name:"add-user",directional:!0}),children:j.default.t(232)})}),(0,T.jsxs)(_.default,{children:[e,t]})]})}}b.displayName="BlockedDrawer";var P=(0,I.default)(b);t.default=P},66578:(e,t,s)=>{"use strict";var a=s(20862),i=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(s(94184)),o=s(55084),l=s(78285),r=i(s(7900)),d=s(67294),c=i(s(62202)),u=i(s(73895)),h=i(s(55386)),f=i(s(91952)),p=i(s(55454)),m=i(s(17747)),g=i(s(9042)),_=a(s(55588)),v=a(s(13540)),C=s(57085),x=a(s(47683)),S=a(s(49288)),y=i(s(2408)),E=i(s(89537)),j=i(s(84658)),I=a(s(10214)),M=i(s(92235)),T=i(s(4231)),b=i(s(90904)),P=i(s(52937)),L=i(s(40630)),w=i(s(3132)),D=i(s(65565)),O=i(s(46714)),N=i(s(2966)),R=i(s(1458)),k=i(s(82669)),A=i(s(92018)),F=s(85893);const B="ANIMATING",U="LOADING",G="RECORDING",H="SENDING";class V extends d.PureComponent{constructor(...e){super(...e),this.state={caption:void 0,img:void 0,isViewOnce:!1,state:B,stream:void 0,videoSize:void 0},this._refVideo=(0,d.createRef)(),this._startTimer=new l.ShiftTimer((({stream:e,disposeStream:t})=>{this.loadNewStream(e,t)})),this.loadNewStreamTimerUpdate=(e,t)=>{this._startTimer.forceRunNow({stream:e,disposeStream:t})},this.loadNewStream=(e,t)=>{var s;e?(null===(s=this._disposeStream)||void 0===s||s.call(this),this._disposeStream=t,this.setState({state:U,stream:e}),(0,I.isSrcObjectInVideoElement)()||(e?(window.URL.revokeObjectURL(this.url),this.url=window.URL.createObjectURL(e)):(window.URL.revokeObjectURL(this.url),this.url=void 0))):this.state.state===B&&this.setState({state:U})},this._stopStreamTimer=new l.ShiftTimer((({stream:e,disposeStream:t})=>{e&&t&&t(),(0,I.isSrcObjectInVideoElement)()||(this.url=window.URL.revokeObjectURL(this.url))})),this.onCapture=()=>{var e;const t=null===(e=this._refVideo.current)||void 0===e?void 0:e.underlyingVideo();if(!t)return;const{chat:s}=this.props,a=document.createElement("canvas");a.height=t.videoHeight,a.width=t.videoWidth;const i=a.getContext("2d");if(!i)return void __LOG__(3)`CaptureDrawer:onCapture can not get 2d context`;i.translate(a.width,0),i.scale(-1,1),i.drawImage(t,0,0,t.videoWidth,t.videoHeight);const n=this.props.onCaptured;if(n)S.canvasToBlob(a).then((e=>{n(e)}));else{this._stopStreamTimer.onOrBefore(500,{stream:this.state.stream,disposeStream:this._disposeStream}),this._mediaLogger=new E.default,this._mediaLogger.logAdd("CAPTURE_MEDIA","image",T.default.MEDIA_PICKER_ORIGIN_TYPE.MENU_CAMERA_CAPTURE),this._mediaLogger.chatRecipients=s&&s.groupMetadata?s.groupMetadata.participants.length:1;const e=a.toDataURL("image/jpeg"),t=window.dataURLtoBlob(e);if(s){s.attachMediaContents||s.setAttachMediaContents(new c.default({chatParticipantCount:s.getParticipantCount()}));(0,r.default)(s.attachMediaContents,"chat.attachMediaContents").processAttachments([{file:(0,C.createFile)([t],"",{type:"image/jpeg"})}])}this.setState({state:H,stream:void 0,img:e})}},this.onVideoLoaded=e=>{this.setState({state:G,videoSize:{width:e.videoWidth,height:e.videoHeight}})},this.onRetake=()=>{this.setState({state:U,caption:void 0}),this._clearAttachMedia();const{asyncStream:e,disposeStream:t}=I.start("camera");this._disposeStream=t,e.then((e=>{e&&((0,I.isSrcObjectInVideoElement)()||(this.url=window.URL.createObjectURL(e)),this.setState({stream:e}))})).catch((0,o.filteredCatch)(v.GUM.NotAllowedError,(()=>{this.props.onBack(),f.default.openModal((0,F.jsx)(x.default,{messaging:x.Messaging.CAMERA_FAIL,type:x.default.TYPE.GUIDE_UNBLOCK}))}))).catch((0,o.filteredCatch)(v.GUM.GUMError,(()=>{this.props.onBack(),f.default.openModal((0,F.jsx)(x.default,{messaging:x.Messaging.CAMERA_MISSING,type:x.default.TYPE.GUIDE_NONE}))})))},this.onSend=()=>{let{img:e,caption:t}=this.state;const s=this.props.onSend;if(s)if(e){const a=this.refCaptionInput&&this.refCaptionInput.refInput;let i=[];if(t&&a){const e=a.serialize(t),[s,n]=[e[0].trim(),e[1]];s.length&&(t=s,i=n.mentionedJidList||[])}s({caption:t,getImg:P.default.createFromBase64Jpeg(R.default.parseDataURL(e).data),isViewOnce:this.state.isViewOnce,mentionedJidList:i}),this._mediaLogger.logSend()}else __LOG__(4,void 0,new Error,!0)`Assertion failed!`,SEND_LOGS("capture-drawer-no-img");else __LOG__(4,void 0,new Error,!0)`Assertion failed!`,SEND_LOGS("capture-drawer-no-onSend")},this.onCaptionChange=e=>{this.setState({caption:e})},this._canViewOnce=()=>{const{chat:e}=this.props,t=null==e?void 0:e.contact.isEnterprise;return D.default.viewOnceWrite&&!t},this._onViewOnceChange=e=>{this.setState({isViewOnce:e})},this.setRefCaptionInput=e=>{this.refCaptionInput=e},this._handleSendMedia=(e,t={})=>{const{isViewOnce:s}=t,a=this.props.onSend;if(a)if(0===e.length)__LOG__(4,void 0,new Error,!0)`Assertion failed!`,SEND_LOGS("capture-drawer-no-img");else{const{media:t,mentionedJidList:n}=(0,r.default)(e[0],"medias[0]"),o=t.file;var i;if(o instanceof Blob)a({getImg:P.default.createFromData(o,o.type),caption:null!==(i=t.caption)&&void 0!==i?i:void 0,isViewOnce:s,mentionedJidList:n}),this._mediaLogger.logSend();this._clearAttachMedia()}else __LOG__(4,void 0,new Error,!0)`Assertion failed!`,SEND_LOGS("capture-drawer-no-onSend")},this._clearAttachMedia=()=>{this.props.chat&&this.props.chat.setAttachMediaContents(null)}}componentDidMount(){this._startTimer.onOrBefore(300,{stream:this.props.stream,disposeStream:this.props.disposeStream})}componentWillUnmount(){var e;this._startTimer.cancel(),this.url&&window.URL.revokeObjectURL(this.url),null===(e=this._disposeStream)||void 0===e||e.call(this),this._mediaLogger&&this._mediaLogger.logCancel(),this._clearAttachMedia()}render(){let e,t,s,a,i;const o="capture-cover"===this.props.theme?"cover":"contain";switch(this.state.state){case B:case U:if(i=(0,F.jsx)(O.default,{stroke:4,size:50}),this.state.state===B)break;case G:const l=(0,n.default)(h.default.video,{[h.default.videoInactive]:this.state.stream&&this.state.state===U}),d=this.state.stream?(0,F.jsx)(A.default,{autoPlay:!0,ref:this._refVideo,onPlay:this.onVideoLoaded,src:this.url?this.url:void 0,srcObject:this.url?void 0:this.state.stream}):null;s=this.state.stream?(0,F.jsx)("div",{children:(0,F.jsx)(b.default,{type:o,size:this.state.videoSize,children:(0,F.jsx)("div",{className:l,"data-animage-capture-webcam":!0,children:d})})},"webcam"):null,e=this.state.state===G?(0,F.jsx)("div",{className:h.default.btn,children:(0,F.jsx)(w.default,{large:!0,onClick:this.onCapture,children:(0,F.jsx)(N.default,{name:"camera"})})},"btn-capture"):null;break;case H:s=(0,F.jsx)(b.default,{type:o,size:this.state.videoSize,children:(0,F.jsx)("img",{alt:"",className:h.default.image,"data-animate-capture-snapshot":!0,src:this.state.img})});const{chat:c}=this.props;if(c){const e=(0,r.default)(c.attachMediaContents,"chat.attachMediaContents");s=(0,F.jsx)(M.default,{theme:"capture",chat:c,initCaption:null,mediaCollection:e,onDropText:()=>{},onSendMedia:this._handleSendMedia})}e=(0,F.jsx)("div",{className:(0,n.default)(h.default.btn,h.default.btnSend),children:(0,F.jsx)(w.default,{large:!0,onClick:this.onSend,children:(0,F.jsx)(N.default,{name:"send",directional:!0})})},"btn-send"),t=(0,F.jsxs)("div",{className:h.default.retakeBtn,onClick:this.onRetake,children:[(0,F.jsx)("div",{className:h.default.retakeIcon,children:(0,F.jsx)(N.default,{name:"return"})}),y.default.t(1552)]}),a=this.props.chat?(0,F.jsxs)("div",{className:h.default.captionInput,children:[(0,F.jsx)(j.default,{ref:this.setRefCaptionInput,chat:this.props.chat,maxLength:p.default.MAX_CAPTION_LENGTH,multiline:!0,onEnter:this.onSend,onChange:this.onCaptionChange,placeholder:y.default.t(229),showRemaining:!0,spellCheck:!0,supportsEmoji:!0,value:this.state.caption}),D.default.viewOnceWrite?(0,F.jsx)(u.default,{disabled:!this._canViewOnce(),isOn:this.state.isViewOnce,mediaType:"image",onChange:this._onViewOnceChange}):null]}):null;break;default:__LOG__(2)`captureDrawer:render Unhandled video capture state ${this.state.state}`}const l=this.props.caption?(0,F.jsx)(k.default,{transitionName:"media-caption",className:h.default.caption,children:a}):null;let d=(0,F.jsxs)("div",{className:h.default.footer,children:[l,(0,F.jsx)(k.default,{transitionName:"pop_delay",children:e})]});return this.state.state===H&&(d=null),(0,F.jsxs)(m.default,{theme:this.props.theme,children:[(0,F.jsx)(_.default,{title:y.default.t(1687),type:_.DRAWER_HEADER_TYPE.OFFSET,onCancel:this.props.onBack,children:t}),(0,F.jsxs)(g.default,{overflow:"hidden",children:[(0,F.jsxs)("div",{className:h.default.container,children:[i,(0,F.jsx)("div",{className:h.default.body,children:(0,F.jsx)(k.default,{transitionName:"capture",className:h.default.videoContainer,children:s})})]}),d]})]},"attach-capture-modal")}}V.defaultProps={caption:!1},V.displayName="CaptureDrawer";const W=(0,L.default)(V);t.default=class extends W{constructor(...e){super(...e),this.loadNewStream=(e,t)=>{this.getComponent().loadNewStreamTimerUpdate(e,t)}}}},52349:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,r.jsx)("div",{className:(0,i.default)(d.container),children:(0,r.jsx)(o.FlexRow,{align:"start",justify:"start",wrap:"wrap",children:e.categories.map((t=>(0,r.jsx)(n.default,{"aria-label":l.default.t(56),onClick:()=>e.onRemoveItem(t.id),label:t.localized_display_name,postfixIcon:"round-x-inv",xstyle:d.chip},t.id.toString())))})})};var i=a(s(94184)),n=(a(s(56720)),a(s(70775))),o=s(63290),l=a(s(2408)),r=s(85893);const d={container:{paddingTop:"b7n2qyd4",paddingEnd:"iffbo4e8",paddingBottom:"s8gyl5p1",paddingStart:"khscay3k",backgroundColor:"sjyhwr5o",borderTop:"dl47i6rc"},chip:{marginTop:"dj1c3cmq",marginEnd:"bugiwsl0",marginBottom:"mpdn4nr2",marginStart:"svoq16ka"}}},18670:(e,t,s)=>{"use strict";var a=s(20862),i=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=s(67294),o=i(s(53407)),l=i(s(55092)),r=i(s(17025)),d=i(s(71889)),c=i(s(13531)),u=i(s(17747)),h=i(s(9042)),f=a(s(55588)),p=s(92231),m=i(s(67893)),g=i(s(40854)),_=i(s(47193)),v=i(s(39e3)),C=i(s(2408)),x=i(s(55325)),S=i(s(70422)),y=i(s(80091)),E=i(s(2966)),j=i(s(38853)),I=s(85893);var M=(0,n.forwardRef)(((e,t)=>{const{title:s,onBack:a,onClick:i,onNewGroup:M}=e,[T,b]=(0,n.useState)(""),P=(0,n.useRef)(),L=(0,n.useRef)(),w=(0,n.useRef)(),D=(0,n.useMemo)((()=>r.default.frequentContacts("message")),[r.default.length]),O=Boolean(T),N=(0,n.useMemo)((()=>O?[]:D),[O,D]),[R]=(0,n.useState)((()=>new m.default)),k=(0,n.useCallback)((e=>{r.default.ensureSorted();const t="string"==typeof e?e:T;if(!t)return r.default.getFilteredContacts();const s=r.default.getFilteredContacts().concat(r.default.filter((e=>e.name&&!e.isMe&&!e.isPSA&&!e.isWAContact))),a=C.default.accentFold(t),i=(0,S.default)(a);return s.filter((function(e){return e.searchMatch(a,i)}))}),[T]);(0,n.useEffect)((()=>{_.default.focus(P.current)}),[]);const A=(0,n.useCallback)((()=>{g.default.shouldIndicateFocus(),_.default.focus(P.current)}),[]),F=(0,n.useCallback)((e=>{const t=L.current;null!=t&&(e.preventDefault(),e.stopPropagation(),g.default.shouldIndicateFocus(),t.focusFirst())}),[]),B=(0,j.default)((e=>b(e)),100),U=(0,n.useCallback)((e=>{w.current=e,B(e)}),[B]),G=(0,n.useCallback)((e=>{e.preventDefault(),e.stopPropagation();const t=N[0];if(t)return g.default.shouldIndicateFocus(),void i(e,t);const s=k(w.current)[0];s&&(g.default.shouldIndicateFocus(),i(e,s))}),[i,k,N]);let H,V;const W=k();if(H=0===W.length?T?(0,p.SearchWithKeyword)(T):(0,p.SearchWithoutKeyword)():(0,I.jsx)(c.default,{ref:L,contacts:W,flatListController:R,frequentContacts:N,onClick:i,onFocusSearch:A,showPersonGroupDivisionHeader:!!T}),!T){const e=(0,I.jsx)(y.default,{children:(0,I.jsx)(E.default,{name:"new-group",directional:!0})});V=(0,I.jsx)("div",{"data-list-scroll-offset":!0,children:(0,I.jsxs)("div",{className:d.default.newGroupButton,children:[(0,I.jsx)(l.default,{image:e,primary:C.default.t(2065),onClick:M}),(0,I.jsx)(o.default,{})]})})}return(0,I.jsxs)(u.default,{ref:t,children:[(0,I.jsx)(f.default,{title:s,type:f.DRAWER_HEADER_TYPE.LARGE,onBack:a}),(0,I.jsx)(v.default,{handlers:{down:F},children:(0,I.jsx)(x.default,{ref:P,onSearch:U,onEnter:G,placeholder:C.default.t(1566)})}),(0,I.jsxs)(h.default,{flatListControllers:[R],children:[V,H]})]},"contact-modal")}));t.default=M},79353:(e,t,s)=>{"use strict";var a=s(20862),i=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=s(55084),o=s(67294),l=i(s(94822)),r=i(s(91952)),d=i(s(55454)),c=i(s(62069)),u=i(s(13550)),h=i(s(17747)),f=i(s(9042)),p=a(s(55588)),m=i(s(25061)),g=a(s(13540)),_=s(78615),v=i(s(52087)),C=i(s(45530)),x=i(s(2408)),S=i(s(71681)),y=s(51435),E=i(s(4231)),j=i(s(45472)),I=i(s(57636)),M=i(s(95005)),T=i(s(69704)),b=i(s(40630)),P=i(s(65565)),L=i(s(46714)),w=i(s(79485)),D=i(s(2966)),O=a(s(49201)),N=i(s(61211)),R=s(85893);class k extends o.Component{constructor(e){super(e),this.setRefScrollable=e=>{this.refScrollable=e},this.state={msgInfo:void 0,unimplemented:!1},this._refWrapper=(0,o.createRef)(),this.isMsgVisible=(e,t=!1)=>e===this.props.msg.id&&(!!t||this.getMsgComponent()),this.handleClose=()=>{this.props.uim.uie.requestDismiss()},this._uiActionEvent=new E.default.UiAction({uiActionType:E.default.UI_ACTION_TYPE.MSG_INFO_OPEN,uiActionPreloaded:!0})}componentDidMount(){var e;I.default.find(this.props.msg.id).checkpoint(this.props.rejectOnUnmount()).then((e=>{this.setState({msgInfo:e}),this.props.listeners.add(e.played,"add remove",(()=>{this.forceUpdate()})),this.props.listeners.add(e.read,"add remove",(()=>{this.forceUpdate()})),this.props.listeners.add(e.delivery,"add remove",(()=>{this.forceUpdate()}))})).catch((0,n.filteredCatch)(g.Unmount,(()=>{}))).catch((()=>{this.setState({unimplemented:!0}),r.default.openToast((0,R.jsx)(O.default,{msg:x.default.t(1277),id:(0,O.genId)("msg_info_failed")}))}));const t=null===(e=this.refScrollable)||void 0===e?void 0:e.container;this.props.msg.type===d.default.MSG_TYPE.IMAGE&&t&&(t.scrollTop=t.scrollHeight),this.props.listeners.add(this.props.msg,"remove",((e,t)=>{t===j.default&&this.props.uim.uie.requestDismiss()}));const s=this._uiActionEvent;s&&(s.markUiActionT(),s.commit(),this._uiActionEvent=void 0)}getMsgComponent(){var e;return null===(e=this._refWrapper.current)||void 0===e?void 0:e.getMsgComponentRef()}render(){const{msg:e}=this.props,{msgInfo:t,unimplemented:s}=this.state;let a,i,n;if(t){var o;const s=[];let n,l,r;const h=e.type===d.default.MSG_TYPE.PTT;(h||e.isViewOnce)&&(i=h?x.default.t(1243):x.default.t(1245),n=t.played.head(),l=n&&n.t,r=(0,R.jsx)("span",{className:u.default.icon,children:(0,R.jsx)(D.default,{name:h?"status-ptt":"view-once-viewed",className:u.default.statusBlue})}),s.push((0,R.jsx)(c.default,{title:h?x.default.t(1238):x.default.t(1247),t:l,icon:r},"played"))),n=t.read.head(),l=n&&n.t,r=(0,R.jsx)("span",{className:u.default.icon,children:(0,R.jsx)(D.default,{name:"status-dblcheck",className:u.default.ack})}),i=null!==(o=i)&&void 0!==o?o:x.default.t(1240),s.push((0,R.jsx)(c.default,{title:i,t:l,icon:r},"read")),n=t.delivery.head(),l=n&&n.t,r=(0,R.jsx)("span",{className:u.default.icon,children:(0,R.jsx)(D.default,{name:"status-dblcheck"})}),s.push((0,R.jsx)(c.default,{title:x.default.t(1236),t:l,icon:r},"delivery")),!P.default.hfmStringChanges&&e.numTimesForwarded>0&&!e.isFrequentlyForwarded&&s.push((0,R.jsx)(M.default,{msg:e},"forward")),a=(0,R.jsx)(m.default,{theme:"padding",children:s})}t||s||(n=(0,R.jsx)("div",{className:u.default.spinner,children:(0,R.jsx)(L.default,{size:50,stroke:4})},"spinner"));let r=null;return e.labels&&e.labels.length>0&&(0,_.canDisplayLabel)()&&(r=(0,R.jsx)(m.default,{theme:"padding",children:(0,R.jsx)(C.default,{labels:e.labels})})),(0,R.jsxs)(h.default,{theme:"striped",children:[(0,R.jsx)(p.default,{title:x.default.t(1235),type:p.DRAWER_HEADER_TYPE.SMALL,onCancel:this.handleClose}),(0,R.jsx)(T.default,{ref:this.setRefScrollable,chatPreference:l.default.assertGet("defaultPreference"),children:(0,R.jsx)(N.default,{msg:e,ref:this._refWrapper,displayType:d.default.DISP_TYPE.MSG_INFO,isMsgVisible:this.isMsgVisible,position:y.MsgPosition.END,onProductClick:this.props.onProductClick})}),(0,R.jsxs)(f.default,{children:[r,(0,R.jsxs)("div",{className:u.default.body,children:[n,a]})]})]},"message-info-modal")}}k.CONCERNS={msg:["id","star","type","isGif","isViewOnce","labels","numTimesForwarded","isFrequentlyForwarded"]},k.displayName="ContactMsgInfoDrawer";var A=(0,v.default)((0,b.default)((0,S.default)((0,w.default)(k,k.CONCERNS))));t.default=A},16926:(e,t,s)=>{"use strict";var a=s(20862),i=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(s(81109)),o=s(67294),l=i(s(91952)),r=i(s(75940)),d=i(s(55454)),c=i(s(12950)),u=i(s(2408)),h=s(97504),f=(i(s(56720)),s(66557)),p=i(s(44683)),m=i(s(33287)),g=i(s(4919)),_=s(63290),v=i(s(29458)),C=a(s(49201)),x=s(57092),S=i(s(39e3)),y=i(s(35371)),E=s(86723),j=s(85893);const{CONTACT_US_MAX_DESC_LENGTH:I}=d.default,M={deviceInfo:{marginBottom:"t4zgqcuo",marginTop:"opp68qpq"},deviceInfoCheckbox:{minWidth:"r7yn1a4o"},deviceInfoLabel:{paddingEnd:"l9g3jx6n"},emailLink:{marginTop:"opp68qpq"}};class T extends o.Component{constructor(...e){super(...e),this.state={description:"",includeDeviceInfo:!0,isSending:!1},this._setDescriptionRef=e=>{this._descriptionInput=e},this.handleSend=()=>{const{description:e,includeDeviceInfo:t}=this.state;if(this.validateDescription(e)){const s=(0,n.default)((0,n.default)({},y.default.parser.getResult()),{},{"Device ID":(0,E.assertGetMe)()}),a=t?JSON.stringify(s):void 0;this.setState({isSending:!0}),this.props.onSend&&this.props.onSend({description:e}),__LOG__(2)`InAppSupport: Sending support request with deviceInfo=${t}:${null!=a?a:"n/a"}`,this._sendRequest=(0,f.sendSupportRequest)(e,a).then((t=>{null!=t.message?(l.default.closeModal(),l.default.openToast((0,j.jsx)(C.default,{msg:u.default.t(1674),id:(0,C.genId)()}))):this.props.onFailure&&this.props.onFailure({description:e})})).finally((()=>{this._sendRequest=void 0,this.setState({isSending:!1})}))}else this.setState({descriptionError:u.default.t(1620)})},this.handleCancel=()=>{this.props.onCancel&&this.props.onCancel(),l.default.closeModal()},this.handleEmail=()=>{const{onEmail:e}=this.props;e&&(l.default.closeModal(),e({description:this.state.description}))},this.handleDescriptionChange=e=>{this.setState({description:e,descriptionError:this.validateDescription(e)?void 0:this.state.descriptionError})},this._handleIncludeDeviceInfoChange=()=>{this.setState({includeDeviceInfo:!this.state.includeDeviceInfo})},this.validateDescription=e=>e.length>=d.default.CONTACT_US_MIN_DESC_LENGTH,this.stopPropagation=e=>{e.stopPropagation()}}componentWillUnmount(){var e,t;!0===(null===(e=this._sendRequest)||void 0===e?void 0:e.isPending())&&(null===(t=this._sendRequest)||void 0===t||t.cancel())}componentDidMount(){var e;null===(e=this._descriptionInput)||void 0===e||e.restoreFocus()}render(){const{isSending:e}=this.state,t={enter:this.stopPropagation};if(e&&(t.esc=this.stopPropagation),c.default.supportsFeature(c.default.F.MD_BACKEND)){const s="contact-us-include-device";return(0,j.jsx)(r.default,{title:u.default.t(1675),okDisabled:!this.validateDescription(this.state.description)||e,okSpinner:e,okText:u.default.t(1604),onOK:this.handleSend,onCancel:e?void 0:this.handleCancel,children:(0,j.jsx)(S.default,{handlers:t,children:(0,j.jsxs)(_.FlexColumn,{align:"stretch",children:[(0,j.jsx)(v.default,{error:this.state.descriptionError,maxLength:I,onChange:this.handleDescriptionChange,placeholder:u.default.t(1673),ref:this._setDescriptionRef,value:this.state.description}),(0,j.jsx)(_.FlexItem,{xstyle:M.deviceInfo,grow:1,children:(0,j.jsx)(h.TextParagraph,{theme:"muted-small",children:u.default.t(1671)})}),(0,j.jsxs)(_.FlexRow,{children:[(0,j.jsx)(_.FlexItem,{xstyle:M.deviceInfoLabel,grow:1,children:(0,j.jsx)("label",{htmlFor:s,children:(0,j.jsxs)(h.TextParagraph,{theme:"plain",children:[u.default.t(1672)," ",(0,j.jsx)(g.default,{href:(0,x.getSupportChatFaqUrl)(),children:u.default.t(1103)})]})})}),(0,j.jsx)(_.FlexItem,{xstyle:M.deviceInfoCheckbox,grow:0,children:(0,j.jsx)(m.default,{checked:this.state.includeDeviceInfo,id:s,onChange:this._handleIncludeDeviceInfoChange})})]}),(0,j.jsx)(_.FlexRow,{children:(0,j.jsx)(_.FlexItem,{xstyle:M.emailLink,grow:1,children:(0,j.jsx)(p.default,{onClick:this.handleEmail,children:u.default.t(927)})})})]})})})}return(0,j.jsx)(r.default,{okText:u.default.t(2085),onOK:()=>l.default.closeModal(),title:u.default.t(1675),children:(0,j.jsx)(h.TextParagraph,{theme:"plain",children:u.default.t(1676)})})}}t.default=T,T.displayName="ContactUsModal"},58362:(e,t,s)=>{"use strict";var a=s(20862),i=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=s(67294),o=i(s(25142)),l=i(s(91952)),r=i(s(2408)),d=i(s(80959)),c=a(s(31051)),u=s(15298),h=s(97504),f=i(s(76006)),p=s(85893);var m=e=>{const t=(0,f.default)(e.mute,["isMuted","expiration"]),[s,a]=(0,n.useState)((()=>d.default.getGlobalNotifications())),[i,m]=(0,n.useState)((()=>d.default.getOutgoingMessageSound())),[g,_]=(0,n.useState)((()=>d.default.getGlobalSounds())),[v,C]=(0,n.useState)((()=>d.default.getGlobalPreviews())),[x,S]=(0,n.useState)((()=>d.default.getCollapseMuted())),y=()=>{a((e=>{const t=!e;return d.default.setGlobalNotifications(t),t}))},E=()=>{C((e=>{const t=!e;return d.default.setGlobalPreviews(t),t}))},j=[];window.Notification&&(j.push((0,p.jsx)(c.SettingsCheckListItem,{a8nText:"option-desktop-notifications",id:"desktop-notifications",checked:s,onChange:y,children:r.default.t(1413)},0)),j.push((0,p.jsxs)(c.SettingsCheckListItem,{a8nText:"options-msg-previews",disabled:!s,id:"msg-previews",checked:v,onChange:E,children:[r.default.t(1415),(0,p.jsx)(h.TextDiv,{theme:"muted",children:r.default.t(1416)})]},1)));const{expiration:I,isMuted:M}=t;return(0,p.jsxs)(c.default,{children:[(0,p.jsx)(c.SettingsCheckListItem,{a8nText:"option-sounds",id:"sounds",checked:g,onChange:()=>{_((e=>{const t=!e;return d.default.setGlobalSounds(t),t}))},children:r.default.t(1420)}),undefined,j,undefined,(0,p.jsxs)(c.SettingsCheckListItem,{a8nText:"option-mute-desktop-notifications",id:"mute-desktop-notifications",checked:M,onChange:()=>{l.default.muteAll((0,u.unproxy)(t),!t.isMuted)},children:[r.default.t(1704),M&&null!=I?(0,p.jsx)(h.TextDiv,{theme:"muted",children:o.default.untilStr(I)}):null]})]})};t.default=m},36560:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return(0,o.jsx)("div",{className:i.default.dropOverlay,children:(0,o.jsx)("div",{className:i.default.dropOverlayOutline,children:n.default.t(793)})},"container")};var i=a(s(86088)),n=a(s(2408)),o=s(85893)},41024:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.E2EChangeModal=t.E2EChangeModalClass=void 0;var i=s(67294),n=a(s(91952)),o=a(s(75940)),l=a(s(2408)),r=a(s(79485)),d=s(85893);class c extends i.Component{render(){const e=l.default.t(2085),t=this.props.contact.formattedShortName,s=l.default.t(2060,{contactName:t}),a=l.default.t(2059,{contactName:t});return(0,d.jsx)(o.default,{title:s,onOK:()=>n.default.closeModal(),okText:e,children:a})}}t.E2EChangeModalClass=c,c.CONCERNS={contact:["formattedShortName"]},c.displayName="E2EChangeModalClass";const u=(0,r.default)(c,c.CONCERNS);t.E2EChangeModal=u},7158:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.RETRY_OPTIONS=void 0;var i=a(s(41609)),n=s(67294),o=a(s(17747)),l=a(s(9042)),r=a(s(55588)),d=a(s(51236)),c=a(s(21893)),u=a(s(4919)),h=a(s(2408)),f=a(s(71681)),p=a(s(59381)),m=a(s(11750)),g=a(s(90904)),_=a(s(1179)),v=a(s(3132)),C=a(s(2966)),x=s(66317),S=a(s(1458)),y=a(s(82669)),E=s(85893);const j={NONE:"none",RETAKE:"retake",RESTART:"restart"};t.RETRY_OPTIONS=j;class I extends n.Component{constructor(e){super(e),this._handleDoneEditing=()=>{const e=this.state.editedMedia;this.saveCanvas(),this._refProfileCropTool&&this._refProfileCropTool.crop().then((({thumb:t,full:s})=>{this.props.onFinished(t,s),e.cleanUp()}))},this._handleObjectLoad=e=>{if(!(e&&e instanceof HTMLElement))return;const t={};!this.state.editorSize||this.state.editorSize.width===e.clientWidth&&this.state.editorSize.height===e.clientHeight||(t.editorSize={width:e.clientWidth,height:e.clientHeight}),this.state.loaded||(t.loaded=!0),(0,i.default)(t)||this.setState(t)},this.setRefMediaEditCanvas=e=>{this.mediaEditCanvas=e},this._setRefProfileCropTool=e=>{this._refProfileCropTool=e},this.drawCanvas=(e,t)=>{this.mediaEditCanvas&&this.mediaEditCanvas.drawCanvas(e,t)},this.saveCanvas=()=>{this.mediaEditCanvas&&this.mediaEditCanvas.saveCanvas()},this.updateCanvasSize=(e,t)=>{this.mediaEditCanvas&&this.mediaEditCanvas.updateCanvasSize(e,t)},this.handleCanvasInitialized=()=>{this.forceUpdate()},this.state={doneEditing:!1,loaded:!1,editorSize:{width:500,height:361},editedMedia:new c.default(e.img)},this.mediaEditController=new m.default}componentDidMount(){this.props.listeners.add(this.mediaEditController,"change:isInitialized",this.handleCanvasInitialized)}render(){const{attributionUrl:e,onRetake:t,retryText:s}=this.props,a=this.state.loaded?(0,E.jsx)("div",{className:d.default.btnSend,children:(0,E.jsx)(v.default,{large:!0,onClick:this._handleDoneEditing,children:(0,E.jsx)(C.default,{name:"checkmark-large"})})},"btn-send"):null;let i;this.mediaEditController.isInitialized&&(i=(0,E.jsx)(_.default,{editedMedia:this.state.editedMedia,stage:this.mediaEditController.stage,cropOverlay:this.mediaEditController.cropOverlay,mediaContainer:this.mediaEditController.mediaContainer,drawCanvas:this.drawCanvas,ref:this._setRefProfileCropTool}));const n=(0,E.jsx)(p.default,{className:d.default.mediaElement,editedMedia:this.state.editedMedia,mediaEditController:this.mediaEditController,fitType:"cover",ref:this.setRefMediaEditCanvas});let c;if(t){let e;switch(s){case j.NONE:e=null;break;case j.RETAKE:e=h.default.t(1552);break;case j.RESTART:default:e=h.default.t(1555)}c=(0,E.jsxs)("button",{className:d.default.retake,onClick:t,children:[(0,E.jsx)("div",{className:d.default.retakeIcon,children:(0,E.jsx)(C.default,{name:"return"})}),e]})}const f=e?(0,E.jsxs)("div",{className:d.default.attribution,children:[(0,E.jsx)(u.default,{className:d.default.attributionLink,href:e,children:S.default.hostname(e)}),(0,E.jsxs)("span",{children:[h.default.t(1046),"",(0,E.jsx)(u.default,{href:(0,x.getTosUrl)(),children:h.default.t(1052)})]})]}):null,m=(0,E.jsxs)("div",{className:d.default.footer,children:[(0,E.jsx)(y.default,{transitionName:"btn",children:a}),f]}),I=this.props.imageSize?this.props.imageSize:{width:500,height:361};return(0,E.jsxs)(o.default,{theme:"edit",children:[(0,E.jsx)(r.default,{title:h.default.t(247),type:"offset",onCancel:this.props.onCancel,children:c}),(0,E.jsxs)(l.default,{overflow:"hidden",children:[(0,E.jsxs)("div",{className:d.default.mediaBody,children:[i,(0,E.jsx)("div",{className:d.default.containerBackground,children:(0,E.jsx)(y.default,{transitionName:"capture",children:(0,E.jsx)(g.default,{type:"cover",size:I,onObjectLoad:this._handleObjectLoad,children:n})})})]}),m]})]},"attach-edit-modal")}}I.displayName="EditImageDrawer";var M=(0,f.default)(I);t.default=M},21893:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(s(82492)),n=s(57085),o=a(s(1458));class l{constructor(e,t,s,a){this.updateEditData=e=>{this.saveEdits(),this.editData=(0,i.default)({},this.editData,e)},this.updateEditItems=(e,t)=>{this.saveEdits();const s=[];this.editData.items&&this.editData.items.forEach((e=>{e!==t&&s.push(e)})),s.push(e),this.editData.items=s},this.saveEdits=()=>{const e=new l(this.media,this.originalImage,this.editData,this.previous);this.previous=e},this.revertEdit=()=>{this.previous&&(this.editData=this.previous.editData,this.previous=this.previous.previous)},this.saveEditsFromCanvas=e=>{const t=e.toDataURL();this.editedImage||(this.editedImage=new Image),this.editedImage.src=t},this.exportEditedMedia=()=>{if(this.hasEdits()&&this.editedImage){const e=this.editedImage.src;return o.default.dataURLtoFile(e)}return this.media instanceof File?this.media:(0,n.createFile)([this.media],"",{type:this.media.type})},this.hasEdits=()=>!!this.previous&&this.editedImage,this.cleanUp=()=>{window.URL.revokeObjectURL(this.originalImage.src)},this.media=e,t?this.originalImage=t:(this.originalImage=new Image,this.originalImage.src=window.URL.createObjectURL(e)),this.previous=a,this.editData={height:0,width:0,offsetX:0,offsetY:0,rotation:0,scale:1,items:[],baseItem:null},(0,i.default)(this.editData,s)}}t.default=l},59381:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(71730),n=s(76304),o=s(67294),l=a(s(95884)),r=a(s(90904)),d=a(s(92489)),c=s(85893);class u extends o.Component{constructor(e){super(e),this._initCanvas=()=>{const e=this.props.editedMedia.originalImage;e.complete?this.handleImageLoad():e.onload=this.handleImageLoad},this.handleImageLoad=()=>{const e=this.props.editedMedia.editData;this.props.editedMedia.editedImage=null;const t=this.props.editedMedia.originalImage;if(e.width||e.height||(e.width=t.naturalWidth,e.height=t.naturalHeight),!e.baseItem){const s=new n.Easel.Bitmap(t);e.baseItem=s}this.drawCanvas(!0)},this._maybeInitStage=e=>{let t;return this.state.stage?t=this.state.stage:(t=new n.Easel.Stage(e),t.enableMouseOver()),this.props.mediaEditController.stage=t,t},this.drawCanvas=(e,t)=>{if(!this._refStaticCanvas||!this._refStaticCanvas.refCanvas)return;const s=this._refStaticCanvas.refCanvas;t&&this.props.mediaPickerStatsLogger&&this.props.mediaPickerStatsLogger.logChange(this.props.activeMediaId||-1,t);const a=this.props.editedMedia,n=a.editData,o=this._maybeInitStage(s);e&&(s.width=n.width,s.height=n.height),o.removeAllChildren(),null!=n.baseItem&&o.addChild(n.baseItem),n.items&&o.addChild(...n.items);const l=a.originalImage.naturalWidth,r=a.originalImage.naturalHeight;o.regX=l/2,o.regY=r/2,o.rotation=n.rotation,(0,i.isNonZeroNumber)(n.width)&&(0,i.isNonZeroNumber)(n.height)&&(o.x=n.width/2+n.scale*n.offsetX,o.y=n.height/2+n.scale*n.offsetY),o.scaleX=n.scale,o.scaleY=n.scale,o.update(),this.setState({canvasSize:{width:s.width,height:s.height},stage:o})},this.saveCanvas=()=>{this.drawCanvas(!0);const e=this._refStaticCanvas&&this._refStaticCanvas.refCanvas;e&&this.props.editedMedia.saveEditsFromCanvas(e)},this.clearStage=e=>{e&&(e.children.forEach((e=>{e.removeAllEventListeners()})),e.removeAllEventListeners(),e.removeAllChildren(),e.enableMouseOver(0),e.clear())},this._setRefStaticCanvas=e=>{this._refStaticCanvas=e},this._setRefMediaContainer=e=>{this._refMediaContainer=e},this._setRefCropOverlay=e=>{this._refCropOverlay=e},this.updateCanvasSize=(e,t)=>{this.setState({canvasSize:{width:e,height:t}})},this.state={canvasSize:{height:1,width:1},stage:null,mediaContainer:null}}componentDidMount(){this._initCanvas(),this.setState({mediaContainer:this._refMediaContainer}),this.cropOverlay=new n.Easel.Stage(this._refCropOverlay),this.cropOverlay.autoClear=!1,this.cropOverlay.enableMouseOver(),this._refMediaContainer&&(this.props.mediaEditController.mediaContainer=this._refMediaContainer),this.props.mediaEditController.cropOverlay=this.cropOverlay}componentWillUnmount(){const e=this.props.editedMedia.originalImage;e.complete||(e.onload=void 0),this.saveCanvas(),this.clearStage(this.state.stage),this.clearStage(this.cropOverlay)}render(){const e=(0,c.jsx)("canvas",{ref:this._setRefCropOverlay,className:l.default.cropOverlay});return(0,c.jsx)("div",{className:this.props.className,ref:this._setRefMediaContainer,children:(0,c.jsxs)(r.default,{type:this.props.fitType||"scaleDown",size:this.state.canvasSize,children:[e,(0,c.jsx)(d.default,{ref:this._setRefStaticCanvas,className:l.default.mediaViewerImg})]})})}}t.default=u,u.displayName="MediaEditCanvas"},11750:(e,t,s)=>{"use strict";var a=s(20862);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(s(57283));class n extends i.default{constructor(...e){super(...e),this.stage=(0,i.prop)(),this.cropOverlay=(0,i.prop)(),this.mediaContainer=(0,i.prop)(),this.isInitialized=(0,i.derived)(this._isInitialized,["stage","cropOverlay","mediaContainer"])}_isInitialized(){return!!this.stage&&!!this.cropOverlay&&!!this.mediaContainer}clearStage(e){e&&(e.children.forEach((e=>{e.removeAllEventListeners()})),e.removeAllEventListeners(),e.removeAllChildren(),e.clear())}}var o=(0,i.defineModel)(n);t.default=o},1179:(e,t,s)=>{"use strict";var a=s(20862),i=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=s(76304),o=s(67294),l=i(s(55454)),r=a(s(49288)),d=i(s(71681)),c=i(s(46475)),u=i(s(2966)),h=s(85893);const f=1.1;class p extends o.Component{constructor(...e){super(...e),this._validateTranslate=(e,t)=>{const s=this.props.editedMedia.editData,a=(e-s.width/2)*s.scale,i=(e+s.width/2)*s.scale,n=(t+s.height/2)*s.scale,o=(t-s.height/2)*s.scale;return{x:a<-this._cropRadius&&i>this._cropRadius,y:o<-this._cropRadius&&n>this._cropRadius}},this._validateScale=e=>{const t=this.props.editedMedia.editData,s=Math.max(2*this._cropRadius/t.width,2*this._cropRadius/t.height),a=Math.max(e,s);if(t.width*e<this._cropRadius||t.height*e<this._cropRadius)return!1;const i=-this._cropRadius/a+t.width/2,n=this._cropRadius/a-t.width/2,o=-this._cropRadius/a+t.height/2,l=this._cropRadius/a-t.height/2;return{scale:a,offsetX:Math.min(Math.max(t.offsetX,n),i),offsetY:Math.min(Math.max(t.offsetY,l),o)}},this._handlePressMove=(e,t)=>{const s=this.props.editedMedia.editData,a=e.stageX-t.x,i=e.stageY-t.y,n=s.offsetX+a/s.scale,o=s.offsetY+i/s.scale,l=this._validateTranslate(n,o);l.x&&(s.offsetX=n),l.y&&(s.offsetY=o),t.x=e.stageX,t.y=e.stageY,this.props.drawCanvas()},this._handleEnlarge=(e=1.1)=>{const t=this.props.editedMedia.editData,s=0!==e?e:f,a=this._validateScale(t.scale*s);a&&(t.scale=a.scale,t.offsetX=a.offsetX,t.offsetY=a.offsetY,this.props.drawCanvas())},this._handleReduce=(e=1.1)=>{const t=this.props.editedMedia.editData,s=0!==e?e:f,a=this._validateScale(t.scale/s);a&&(t.scale=a.scale,t.offsetX=a.offsetX,t.offsetY=a.offsetY,this.props.drawCanvas())},this.crop=()=>{const e=this.props.editedMedia,t=e.editData,s=e.editedImage&&e.editedImage.src;let a;if(!s)return Promise.reject("empty image");const i=2*this._cropRadius;let n=i;return i>l.default.MAX_PIC_SIDE?n=l.default.MAX_PIC_SIDE:i<l.default.MIN_PIC_SIDE&&(n=l.default.MIN_PIC_SIDE),r.crop(s,(t.width-2*this._cropRadius)/2,(t.height-2*this._cropRadius)/2,2*this._cropRadius,2*this._cropRadius,n,n,r.DATA_URL|r.CANVAS).then((({images:e})=>(a=e.dataUrl,r.crop(e.canvas,0,0,l.default.PROF_PIC_THUMB_SIDE,l.default.PROF_PIC_THUMB_SIDE)))).then((({images:e})=>({thumb:e.dataUrl,full:a})))}}render(){return(0,h.jsxs)("div",{className:c.default.scaler,children:[(0,h.jsx)("div",{className:c.default.scalerButton,onClick:()=>{this._handleEnlarge()},children:(0,h.jsx)(u.default,{name:"plus"})}),(0,h.jsx)("div",{className:c.default.scalerButton,onClick:()=>{this._handleReduce()},children:(0,h.jsx)(u.default,{name:"minus"})})]})}componentDidMount(){this.props.editedMedia.saveEdits();const e=this.props.editedMedia.editData,t=this.props.cropOverlay,s=t.canvas;let a;a=e.baseItem?e.baseItem.getBounds():{width:0,height:0},s.style.display="block",s.width=a.width,s.height=a.height;const i=new n.Easel.Shape;i.graphics.beginFill("rgba(0, 0, 0, 0.1)"),i.graphics.drawRect(0,0,a.width,a.height),i.regX=a.width/2,i.regY=a.height/2,i.x=a.width/2,i.y=a.height/2,i.on("mousedown",(e=>{const t={x:e.stageX,y:e.stageY},s=i.on("pressmove",this._handlePressMove,null,!1,t);i.on("pressup",(()=>{i.off("pressmove",s)}),null,!0)})),i.cursor="move",this.props.listeners.add(s,"mousewheel",(e=>{e.deltaY>0?this._handleEnlarge(1.02):this._handleReduce(1.02)}));const o=s.getContext("2d"),l=s.width,r=s.height,d=l/r>500/361?r/361:l/500;this._cropRadius=Math.min(361,500)/2*.9*d,o.fillStyle="rgba(0, 0, 0, 0.5)",o.fillRect(0,0,l,r),o.globalCompositeOperation="destination-out",o.beginPath(),o.arc(l/2,r/2,this._cropRadius,0,2*Math.PI,!0),o.fillStyle="#ffffff",o.fill(),t.addChild(i),t.update()}}p.displayName="ProfileCropTool";const m=(0,d.default)(p);t.default=class extends m{crop(){return this.getComponent().crop()}}},92489:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=s(67294),i=s(85893);class n extends a.Component{constructor(...e){super(...e),this._setRefCanvas=e=>{this.refCanvas=e}}shouldComponentUpdate(){return!1}render(){return(0,i.jsx)("canvas",{className:this.props.className,ref:this._setRefCanvas})}}t.default=n,n.displayName="StaticCanvas"},57597:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const[t,s]=(0,i.useState)(e.initialDuration),a=e=>s(parseInt(e.target.value,10));return(0,u.jsxs)(l.default,{title:d.default.t(992),onOK:()=>{e.onDurationSelected(t),o.default.closeModal()},onCancel:()=>{o.default.closeModal()},children:[(0,u.jsx)(c.TextParagraph,{xstyle:h.explanation,children:d.default.t(853)}),(0,r.getAllDurations)().map((({value:e,label:s})=>(0,u.jsx)("div",{className:(0,n.default)(h.option),children:(0,u.jsxs)("label",{className:(0,n.default)(h.label),children:[(0,u.jsx)("input",{type:"radio",className:(0,n.default)(h.input),value:String(e),checked:e===t,onChange:a}),s]})},`option-${e}`)))]})};var i=s(67294),n=a(s(56720)),o=a(s(91952)),l=a(s(75940)),r=s(33906),d=a(s(2408)),c=s(97504),u=s(85893);const h={option:{display:"p357zi0d",alignItems:"gndfcl4n",height:"sai7fuui"},label:{display:"f804f6gw",cursor:"ajgl1lbb"},input:{marginEnd:"claouzo6",verticalAlign:"neme6l2y"},explanation:{marginBottom:"t4zgqcuo"}}},49461:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function({frequentlyForwardedCount:e,totalCount:t}){const s=(0,c.jsxs)("span",{className:l.default.text,children:[1===e&&1===t?r.default.t(916):r.default.t(915)," ",(0,c.jsx)(n.default,{href:(0,o.getFrequentlyForwardedFaqUrl)(),children:r.default.t(1103)})]});return(0,c.jsxs)("div",{className:l.default.wrapper,children:[(0,c.jsx)("div",{className:l.default.icon,children:(0,c.jsx)(d.default,{name:"highly-forwarded"})}),(0,c.jsx)(i.default,{theme:"plain",primary:s,idle:!0})]})};var i=a(s(55092)),n=a(s(4919)),o=s(57092),l=a(s(65813)),r=a(s(2408)),d=a(s(2966)),c=s(85893)},90581:(e,t,s)=>{"use strict";var a=s(20862),i=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=s(8139),o=s(55084),l=s(67294),r=i(s(55092)),d=i(s(91952)),c=i(s(55059)),u=a(s(88419)),h=i(s(17747)),f=i(s(9042)),p=i(s(17061)),m=a(s(55588)),g=i(s(85051)),_=s(92231),v=s(54647),C=a(s(13540)),x=s(70991),S=i(s(32521)),y=i(s(56396)),E=i(s(2408)),j=i(s(40630)),I=s(20845),M=i(s(70475)),T=i(s(5646)),b=i(s(79485)),P=i(s(2966)),L=a(s(49201)),w=s(85893);const D="group-invite-link-anchor",O=0,N=1,R=2;class k extends l.Component{constructor(...e){super(...e),this.state={state:O},this._getErrorMessageFromStatusCode=e=>{switch(e){case 401:return E.default.t(967);case 403:return E.default.t(968);case 404:return E.default.t(969);default:return E.default.t(970)}},this._handleLoadingErrorStatusCode=e=>{const t=this._getErrorMessageFromStatusCode(e);this.props.onBack(),d.default.openToast((0,w.jsx)(L.default,{msg:t,id:(0,L.genId)()}))},this._handleRevokeGroupInvite=()=>{d.default.openModal((0,w.jsx)(y.default,{pushTransition:"none",popTransition:"none",chat:this.props.chat,onConfirm:this._handleConfirmRevokeGroupInvite}),{transition:"modal-flow"})},this._handleRevokingErrorStatusCode=e=>{const t=this._getErrorMessageFromStatusCode(e);this.props.onBack(),d.default.openToast((0,w.jsx)(L.default,{msg:t,id:(0,L.genId)()}))},this._handleConfirmRevokeGroupInvite=()=>{this.setState({state:N});const e=(0,x.revokeGroupInvite)(this.props.groupMetadata);(0,n.delayMs)(500).then((()=>e)).checkpoint(this.props.rejectOnUnmount()).then((()=>{d.default.openToast((0,w.jsx)(L.default,{msg:E.default.t(978),id:(0,L.genId)()})),this.setState({state:R})})).catch((0,o.filteredCatch)(v.ServerStatusCodeError,(e=>{this._handleRevokingErrorStatusCode(e.statusCode)}))).catch((0,o.filteredCatch)(C.Unmount,(()=>{})))},this._handleSendGroupInviteLink=()=>{d.default.openModal((0,w.jsx)(M.default,{chat:this.props.chat}),{transition:"modal-flow"})},this.handleClickGroupInviteLinkCapture=e=>{e.preventDefault(),e.stopPropagation()},this._renderDrawerBody=()=>{const e=this.props.groupMetadata;let t;if(this.state.state===O)t=(0,w.jsx)(_.LoadingWithText,{text:E.default.t(960)});else if(this.state.state===N)t=(0,w.jsx)(_.LoadingWithText,{text:E.default.t(977,{groupName:this.props.chat.contact.name})});else{const s=e.groupInviteLink;let a=null;document.queryCommandSupported("copy")&&(a=(0,w.jsx)(c.default,{elementId:D}));const i=(0,w.jsx)(u.default,{id:this.props.chat.id,size:82,quality:u.DETAIL_IMAGE_QUALITY.HIGH}),n=(0,w.jsx)("span",{className:S.default.linkContainer,children:(0,w.jsx)(I.SelectableLink,{id:D,href:s,selectable:!0,children:s})});t=(0,w.jsxs)(f.default,{children:[(0,w.jsx)(r.default,{image:i,primary:(0,w.jsx)(g.default,{text:this.props.chat.contact.name,direction:"auto"}),theme:"identity",secondary:n}),(0,w.jsx)("div",{className:S.default.descContainer,children:E.default.t(965)}),(0,w.jsx)(T.default,{onClick:this._handleSendGroupInviteLink}),a,(0,w.jsx)(p.default,{a8nText:"li-revoke-link",icon:(0,w.jsx)(P.default,{name:"revoke",className:S.default.icon}),onClick:this._handleRevokeGroupInvite,children:E.default.t(962)})]})}return t}}componentDidMount(){(0,x.queryGroupInviteCode)(this.props.groupMetadata).checkpoint(this.props.rejectOnUnmount()).then((()=>{this.setState({state:R})})).catch((0,o.filteredCatch)(v.ServerStatusCodeError,(e=>{this._handleLoadingErrorStatusCode(e.statusCode)}))).catch((0,o.filteredCatch)(C.Unmount,(()=>{})))}render(){return(0,w.jsxs)(h.default,{children:[(0,w.jsx)(m.default,{title:E.default.t(964),onBack:this.props.onBack,type:m.DRAWER_HEADER_TYPE.SMALL}),this._renderDrawerBody()]})}}k.CONCERNS={groupMetadata:["inviteCode","groupInviteLink"]},k.displayName="GroupInviteLinkDrawer";var A=(0,j.default)((0,b.default)(k,k.CONCERNS));t.default=A},2251:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{onConfirm:t}=e;return(0,r.jsx)(n.default,{title:l.default.t(962),onOK:()=>{t(),i.default.closeModal()},okText:l.default.t(962),onCancel:()=>{i.default.closeModal()},cancelText:l.default.t(1912),children:(0,r.jsx)("div",{className:o.default.confirmationText,children:l.default.t(976,{groupName:e.chat.contact.name})})})};var i=a(s(91952)),n=a(s(75940)),o=a(s(56081)),l=a(s(2408)),r=s(85893)},62286:(e,t,s)=>{"use strict";var a=s(20862),i=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=s(55084),o=i(s(7900)),l=s(67294),r=i(s(76610)),d=i(s(94822)),c=i(s(91952)),u=i(s(55454)),h=i(s(17747)),f=i(s(9042)),p=a(s(55588)),m=i(s(25061)),g=a(s(13540)),_=a(s(86025)),v=i(s(67893)),C=s(78615),x=i(s(75798)),S=i(s(51314)),y=i(s(23533)),E=i(s(33677)),j=s(12009),I=i(s(52087)),M=i(s(45530)),T=i(s(2408)),b=i(s(71681)),P=s(51435),L=i(s(4231)),w=i(s(45472)),D=i(s(57636)),O=i(s(95005)),N=i(s(69704)),R=i(s(40630)),k=i(s(16211)),A=i(s(65565)),F=i(s(46714)),B=i(s(79485)),U=i(s(2966)),G=s(97504),H=a(s(49201)),V=i(s(61211)),W=s(85893);class z extends l.Component{constructor(e){super(e),this.flatListController=new v.default,this.setRefScrollable=e=>{this.refScrollable=e},this.state={msgInfo:void 0,unimplemented:!1},this._refWrapper=(0,l.createRef)(),this.isMsgVisible=(e,t=!1)=>e===this.props.msg.id&&(!!t||this.getMsgComponent()),this.handleClose=()=>{this.props.uim.uie.requestDismiss()},this._getHeaderAtSection=e=>{let t,s;switch(e){case j.SECTIONS.PLAYED_HEADER:s=(0,W.jsx)(U.default,{name:"status-ptt",className:y.default.statusBlue}),t=T.default.t(1239);break;case j.SECTIONS.READ_HEADER:s=(0,W.jsx)(U.default,{name:"status-dblcheck",className:y.default.ack}),t=T.default.t(1241);break;case j.SECTIONS.SEEN_HEADER:s=(0,W.jsx)(U.default,{name:"status-dblcheck",className:y.default.ack}),t=this.props.msg.isViewOnce?T.default.t(1246):T.default.t(1244);break;case j.SECTIONS.DELIVERED_HEADER:s=(0,W.jsx)(U.default,{name:"status-dblcheck"}),t=T.default.t(1237);break;case j.SECTIONS.VIEWED_HEADER:s=(0,W.jsx)(U.default,{name:"view-once-viewed",className:y.default.statusBlue}),t=T.default.t(1248);break;default:return __LOG__(4,void 0,new Error)`Invalid SECTION for group message info section header`,null}return s=(0,W.jsx)("div",{className:y.default.titleIcon,children:s}),(0,W.jsx)("div",{"data-a8n":r.default.key("msg-info-title"),className:y.default.title,children:(0,W.jsx)(k.default,{side:s,ellipsify:!0,children:(0,W.jsx)(G.TextSpan,{theme:"section-title",children:t})})})},this._getFooterAtSection=e=>{const t=(0,o.default)(this.state.msgInfo,"this.state.msgInfo");return(0,W.jsx)(E.default,{section:e,msgInfo:t},e)},this.renderItem=e=>{if("row"===e.kind)return this._getInfoCell(e.participant);if(e.type===j.SECTIONS.FORWARD_COUNT)return this._getForwardCount();switch(e.type){case j.SECTIONS.PLAYED_HEADER:case j.SECTIONS.READ_HEADER:case j.SECTIONS.SEEN_HEADER:case j.SECTIONS.DELIVERED_HEADER:case j.SECTIONS.VIEWED_HEADER:return this._getHeaderAtSection(e.type);default:return this._getFooterAtSection(e.type)}},this._uiActionEvent=new L.default.UiAction({uiActionType:L.default.UI_ACTION_TYPE.MSG_INFO_OPEN,uiActionPreloaded:!0})}componentDidMount(){var e;D.default.find(this.props.msg.id).checkpoint(this.props.rejectOnUnmount()).then((e=>{this.setState({msgInfo:e}),this.props.listeners.add(e.played,"add remove",(()=>{this.forceUpdate()})),this.props.listeners.add(e.read,"add remove",(()=>{this.forceUpdate()})),this.props.listeners.add(e.delivery,"add remove",(()=>{this.forceUpdate()}))})).catch((0,n.filteredCatch)(g.Unmount,(()=>{}))).catch((()=>{this.setState({unimplemented:!0}),c.default.openToast((0,W.jsx)(H.default,{msg:T.default.t(1277),id:(0,H.genId)("msg_info_failed")}))}));const t=null===(e=this.refScrollable)||void 0===e?void 0:e.container;this.props.msg.type===u.default.MSG_TYPE.IMAGE&&t&&(t.scrollTop=t.scrollHeight),this.props.listeners.add(this.props.msg,"remove",((e,t)=>{t===w.default&&this.props.uim.uie.requestDismiss()}));const s=this._uiActionEvent;if(s){var a;const e=null===(a=x.default.get(this.props.msg.chat.id))||void 0===a?void 0:a.deviceSizeBucketForLogging;null!=e&&(s.sizeBucket=e),s.markUiActionT(),s.commit(),this._uiActionEvent=void 0}}getAnimateEnterClass(e){return`animate-enter${-1===e?"":e}`}getMsgComponent(){var e;return null===(e=this._refWrapper.current)||void 0===e?void 0:e.getMsgComponentRef()}_getInfoCell(e){return(0,W.jsx)(S.default,{msgInfoParticipant:e,contact:e.contact,theme:"drawer-list"},e.id.toString())}_getForwardCount(){return A.default.hfmStringChanges?null:(0,W.jsx)("div",{className:y.default.forwardCount,children:(0,W.jsx)(O.default,{msg:this.props.msg})})}getData(){const{msg:e}=this.props,{msgInfo:t}=this.state,s=[],a=e.type===u.default.MSG_TYPE.PTT,i=a||e.isViewOnce;if(t&&i){let e=a?j.SECTIONS.PLAYED_HEADER:j.SECTIONS.VIEWED_HEADER;s.push({kind:"section",type:e,itemKey:e,height:50}),s.push(...t.played.map((e=>({participant:e,kind:"row",itemKey:e.id.toString(),height:_.DEFAULT_ITEM_HEIGHT})))),t.playedRemaining>0&&(e=a?j.SECTIONS.PLAYED_FOOTER:j.SECTIONS.VIEWED_FOOTER,s.push({kind:"section",type:e,itemKey:e,height:50}))}return t&&(t.read.length>0||t.playedRemaining>0)&&(s.push({kind:"section",type:i?j.SECTIONS.SEEN_HEADER:j.SECTIONS.READ_HEADER,itemKey:j.SECTIONS.READ_HEADER,height:50}),s.push(...t.read.map((e=>({participant:e,kind:"row",itemKey:e.id.toString(),height:_.DEFAULT_ITEM_HEIGHT})))),t.readRemaining>0&&s.push({kind:"section",type:j.SECTIONS.READ_FOOTER,itemKey:i?j.SECTIONS.SEEN_FOOTER:j.SECTIONS.READ_FOOTER,height:50})),t&&(t.delivery.length>0||t.deliveryRemaining>0)&&(s.push({kind:"section",type:j.SECTIONS.DELIVERED_HEADER,itemKey:j.SECTIONS.DELIVERED_HEADER,height:50}),s.push(...t.delivery.map((e=>({participant:e,kind:"row",itemKey:e.id.toString(),height:_.DEFAULT_ITEM_HEIGHT})))),t.deliveryRemaining>0&&s.push({kind:"section",type:j.SECTIONS.DELIVERED_FOOTER,itemKey:j.SECTIONS.DELIVERED_FOOTER,height:50})),e.numTimesForwarded>0&&!e.isFrequentlyForwarded&&s.push({kind:"section",type:j.SECTIONS.FORWARD_COUNT,itemKey:j.SECTIONS.FORWARD_COUNT,height:60}),s}render(){const{msg:e}=this.props,{msgInfo:t,unimplemented:s}=this.state;let a;t||s||(a=(0,W.jsx)("div",{className:y.default.spinner,children:(0,W.jsx)(F.default,{size:50,stroke:4})},"spinner"));const i=this.getData(),n=i.length?(0,W.jsx)(_.default,{flatListController:this.flatListController,direction:"vertical",forceConsistentRenderCount:!1,data:i,renderItem:this.renderItem}):null;let o=null;return e.labels&&e.labels.length>0&&(0,C.canDisplayLabel)()&&(o=(0,W.jsx)(m.default,{theme:"padding",children:(0,W.jsx)(M.default,{labels:e.labels})})),(0,W.jsxs)(h.default,{theme:"striped",children:[(0,W.jsx)(p.default,{title:T.default.t(1235),type:p.DRAWER_HEADER_TYPE.SMALL,onCancel:this.handleClose}),(0,W.jsx)(N.default,{ref:this.setRefScrollable,chatPreference:d.default.assertGet("defaultPreference"),children:(0,W.jsx)(V.default,{msg:e,ref:this._refWrapper,displayType:u.default.DISP_TYPE.MSG_INFO,isMsgVisible:this.isMsgVisible,position:P.MsgPosition.END,onProductClick:this.props.onProductClick})}),(0,W.jsxs)(f.default,{flatListControllers:[this.flatListController],children:[o,a,(0,W.jsx)("div",{className:y.default.list,children:n})]})]},"message-info-modal")}}z.CONCERNS={msg:["id","star","type","isGif","isViewOnce","labels","numTimesForwarded","isFrequentlyForwarded","chat"]},z.displayName="GroupMsgInfoDrawer";var K=(0,I.default)((0,R.default)((0,b.default)((0,B.default)(z,z.CONCERNS))));t.default=K},33677:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const t=(0,d.default)(e.msgInfo,["playedRemaining","readRemaining","deliveryRemaining"]);let s,a,u;switch(e.section){case o.SECTIONS.PLAYED_FOOTER:case o.SECTIONS.VIEWED_FOOTER:s=t.playedRemaining,a=t.playedRemaining;break;case o.SECTIONS.READ_FOOTER:case o.SECTIONS.SEEN_FOOTER:s=t.readRemaining,a=t.readRemaining;break;case o.SECTIONS.DELIVERED_FOOTER:s=t.deliveryRemaining,a=t.deliveryRemaining;break;default:return __LOG__(4,void 0,new Error)`Invalid SECTION for group message info section footer`,null}u=null!=s&&0!==s?{count:s,_plural:a}:{_plural:a};const h=l.default.t(1242,u);return(0,c.jsx)("div",{"data-a8n":i.default.key("msg-info-remaining"),className:n.default.footer,children:(0,c.jsx)(r.TextSpan,{theme:"muted",children:h})})};var i=a(s(76610)),n=a(s(23533)),o=s(12009),l=a(s(2408)),r=s(97504),d=a(s(76006)),c=s(85893)},12009:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SECTIONS=void 0;const a=s(54302).Mirrored(["DELIVERED_FOOTER","DELIVERED_HEADER","FORWARD_COUNT","PLAYED_FOOTER","PLAYED_HEADER","READ_FOOTER","READ_HEADER","SEEN_FOOTER","SEEN_HEADER","VIEWED_FOOTER","VIEWED_HEADER"]);t.SECTIONS=a},82981:(e,t,s)=>{"use strict";var a=s(20862),i=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=s(67294),o=i(s(55092)),l=i(s(55454)),r=i(s(88419)),d=i(s(17747)),c=i(s(9042)),u=a(s(55588)),h=i(s(85051)),f=i(s(89178)),p=i(s(2021)),m=i(s(2408)),g=a(s(79475)),_=i(s(4337)),v=i(s(3165)),C=i(s(40630)),x=i(s(3132)),S=i(s(2966)),y=i(s(29458)),E=i(s(82669)),j=s(85893);class I extends n.Component{constructor(...e){super(...e),this.state={isBusy:!1,inviteComment:m.default.t(1003)},this.setRefParticipantList=e=>{this.refParticipantList=e},this.handleClose=()=>{const{onClose:e}=this.props;e()},this._getGroupThumbBase64=()=>{const{gid:e}=this.props,t=v.default.get(e);return new Promise((e=>{t&&t.img?(0,f.default)(t.img).then((t=>{if(t.ok)return t.blob();e(void 0)})).then((t=>{if(!t)return;const s=new FileReader;s.onloadend=function(){const t=s.result;if(null==t)return void e(void 0);const a=t.toString().split(",")[1];e(a)},s.readAsDataURL(t)})).catch((()=>e(void 0))):e(void 0)}))},this.handleSend=()=>{const{onSend:e}=this.props,{inviteComment:t}=this.state;this._getGroupThumbBase64().then((s=>{e(t,s)}))},this._handleInviteCommentChange=e=>{this.setState({inviteComment:e})},this.setRefEmojiInput=e=>{this.refEmojiInput=e}}render(){const e=(0,j.jsx)(x.default,{a8nText:"group-participants-btn",large:!0,onClick:this.handleSend,children:(0,j.jsx)(S.default,{name:"send",directional:!0})}),t=(0,j.jsx)(r.default,{id:this.props.gid}),s=(0,j.jsx)(h.default,{text:this.props.subject});return(0,j.jsx)(g.default,{type:g.ModalTheme.Invite,children:(0,j.jsxs)(d.default,{theme:"invite",children:[(0,j.jsx)(u.default,{type:u.DRAWER_HEADER_TYPE.POPUP,title:m.default.t(1012),onCancel:this.handleClose}),(0,j.jsxs)(c.default,{children:[(0,j.jsx)("div",{className:p.default.search,children:(0,j.jsx)("div",{"data-list-scroll-container":!0,children:(0,j.jsx)(_.default,{ref:this.setRefParticipantList,theme:"list-names",contacts:this.props.participants.map((e=>e.contact))})})}),(0,j.jsx)("div",{className:p.default.commentInput,children:(0,j.jsx)(y.default,{a8n:"groups-v4-invite-add-comment-input",ref:this.setRefEmojiInput,value:this.state.inviteComment,showRemaining:!0,maxLength:l.default.MAX_CAPTION_LENGTH,onChange:this._handleInviteCommentChange,theme:"v4-invite-caption",supportsEmoji:!0})}),(0,j.jsx)(E.default,{transitionName:"btn",className:p.default.onSendInvite,children:e}),(0,j.jsx)("div",{className:p.default.groupInfo,children:(0,j.jsx)(o.default,{idle:!0,image:t,primary:s,secondary:m.default.t(1007),theme:"group_v4_invite"})})]})]})})}}I.displayName="GroupV4InviteAddComment";var M=(0,C.default)(I);t.default=M},75730:(e,t,s)=>{"use strict";var a=s(20862),i=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(s(23279)),o=i(s(63105)),l=i(s(35161)),r=s(8139),d=s(67294),c=a(s(75381)),u=s(92231),h=i(s(2408)),f=i(s(15058)),p=i(s(70422)),m=i(s(16967)),g=s(85893);class _ extends d.Component{getElement(){this._refEl}constructor(e){super(e),this._setRefEl=e=>{this._refEl=e},this.handleSelect=(e,t)=>{if(!(t instanceof c.Mode))return;const s=t.props.chat;!0===this.props.filter(s)&&this.props.onGroup(t.props.chat)},this.handleSearch=(0,n.default)((e=>{this.setState({searchText:e})}),100),this.renderItem=e=>{const{onGroup:t,filter:s}=this.props;let a,i;const n=s(e.chat),o="boolean"!=typeof n;return o&&(a=n,i="group-modal"),(0,g.jsx)(c.default,{chat:e.chat,contact:e.chat.contact,mode:c.Mode.INFO,active:this.selection,secondary:a,noContext:!0,theme:i,onClick:o?void 0:t.bind(null,e.chat)})},this.selection=new m.default,this.state={loading:!0,searchText:void 0}}componentDidMount(){const{chats:e}=this.props;(0,r.delayMs)(300).then((()=>Promise.all((0,l.default)((0,o.default)(e,(e=>{var t;return null===(t=e.groupMetadata)||void 0===t?void 0:t.stale})),(e=>{var t;return s(75798).default.update(null===(t=e.groupMetadata)||void 0===t?void 0:t.id).catch((()=>{}))}))))).then((()=>this.setState({loading:!1})))}getData(){const{chats:e,filter:t}=this.props,{loading:s,searchText:a}=this.state;if(s)return[];const i=h.default.accentFold(a),n=(0,p.default)(i),o=e.filter((e=>t(e)&&(!i||i&&e.contact.searchMatch(i,n))));return this.selection.init(o.filter((e=>!0===t(e))).map((e=>e.id))),o.map((e=>({chat:e,itemKey:e.id.toString()})))}render(){const{onCancel:e}=this.props,{loading:t}=this.state,s=t?(0,g.jsx)(u.Loading,{}):(0,g.jsx)(u.SearchGroups,{});return(0,g.jsx)(f.default,{title:h.default.t(2038),data:this.getData(),renderItem:this.renderItem,emptyState:s,selection:this.selection,onCancel:e,onSearch:this.handleSearch,onSelect:this.handleSelect,onRef:this._setRefEl,searchPlaceholder:h.default.t(1569)})}}t.default=_,_.defaultProps={filter:function(){return!0}},_.displayName="GroupsModal"},50792:(e,t,s)=>{"use strict";var a=s(20862),i=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const t=(0,n.useRef)(-1),s=(0,n.useRef)(!1),a=(e,a)=>{(0,C.logSessionEvent)(e,t.current,a),s.current=!0};(0,n.useEffect)((()=>(t.current=performance.now(),l.default.loadAsset(I,l.LOAD_PRIORITY.HELP_ANIMATED_DOODLE),()=>{s.current||a(x.default.CONTACT_US_EXIT_STATE.CANCELLED)})),[]);const i=()=>{a(x.default.CONTACT_US_EXIT_STATE.PROBLEM_DESCRIPTION)},o=e=>{a(x.default.CONTACT_US_EXIT_STATE.EMAIL_SEND,e)},M=()=>{},T=()=>{r.default.openModal((0,j.jsx)(v.default,{onOk:M}))};let b;y.default.isElectron&&(b=(0,j.jsx)(h.default,{a8nText:"li-licenses",onClick:T,children:_.default.t(1104)}));return(0,j.jsxs)(c.default,{children:[(0,j.jsx)(f.default,{a8n:"drawer-title-help",title:_.default.t(1039),onBack:e.onClose,type:f.DRAWER_HEADER_TYPE.LARGE}),(0,j.jsxs)(u.default,{children:[(0,j.jsx)("div",{className:g.default.animation}),(0,j.jsx)(E.default,{className:g.default.versionInfo}),(0,j.jsx)(h.default,{a8nText:"li-faq",onClick:()=>{(0,p.openExternalLink)((0,m.getFaqUrl)()),a(x.default.CONTACT_US_EXIT_STATE.FAQ)},children:_.default.t(2152)}),(0,j.jsx)(h.default,{a8nText:"li-contact-us",onClick:()=>{r.default.openModal((0,j.jsx)(d.default,{onCancel:i,onSend:o}))},children:_.default.t(1618)}),b,(0,j.jsx)(h.default,{a8nText:"li-tos",onClick:()=>{s.current=!0,(0,p.openExternalLink)((0,S.getTosUrl)())},children:_.default.t(1695)}),undefined,undefined]})]})};var n=s(67294),o=i(s(11959)),l=a(s(61970)),r=i(s(91952)),d=i(s(64800)),c=i(s(17747)),u=i(s(9042)),h=i(s(17061)),f=a(s(55588)),p=s(4919),m=s(57092),g=i(s(51298)),_=i(s(2408)),v=i(s(51434)),C=s(36042),x=i(s(4231)),S=s(66317),y=i(s(35371)),E=i(s(7795)),j=s(85893);const I={id:"animated-doodle",selectors:[`.${g.default.animation}`],low:{default:o.default},high:{default:o.default}}},51642:(e,t,s)=>{"use strict";var a=s(20862),i=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(s(57043)),o=i(s(35161)),l=i(s(24350)),r=s(55084),d=s(67294),c=a(s(61379)),u=i(s(91952)),h=i(s(55454)),f=i(s(17747)),p=i(s(9042)),m=a(s(55588)),g=s(92231),_=a(s(13540)),v=i(s(89178)),C=i(s(40854)),x=i(s(47193)),S=i(s(39e3)),y=i(s(24516)),E=i(s(2408)),j=i(s(55325)),I=i(s(40630)),M=i(s(17605)),T=i(s(69217)),b=a(s(49201)),P=i(s(35371)),L=s(49002),w=i(s(865)),D=s(85893);class O extends d.Component{constructor(e){super(e),this.setRefSearch=e=>{this.refSearch=e},this._setRefSearchHotkeys=e=>{this._refSearchHotkeys=e},this._setRefGallery=e=>{this._refGallery=e},this._search=(e,t)=>{this._hasPendingSearch=!1;const s=c.search(e,t).cancellable().then((t=>{s===this._searchPromise&&(this._addSearchResults(e,t),this.setState({isSearching:!1}))})).catch((0,r.filteredCatch)(Promise.CancellationError,(()=>{}))).catch((()=>{__LOG__(3,!0)`Image search failed`,u.default.openToast((0,D.jsx)(b.default,{msg:E.default.t(1047),id:(0,b.genId)()})),s===this._searchPromise&&this.setState({isSearching:!1})})).finally((()=>{s===this._searchPromise&&(this._searchPromise=null)}));this._searchPromise=s,this.setState({isSearching:!0})},this._handleUserInput=e=>{const t=(e||"").trim();if(!t)return this._cancelSearch(),void this._resetState();(0,L.numCodepoints)(t)<h.default.FTS_MIN_CHARS||t!==this.state.query&&(this._cancelSearch(),this._resetState(),this._requestSearch(t))},this._handleRequestMoreImages=()=>{this._hasPendingSearch||this._searchPromise||!this.state.totalEstimatedMatches||this.state.nextOffset>=this.state.totalEstimatedMatches||this._requestSearch(this.state.query,this.state.nextOffset)},this._handleImageClick=e=>{const t=this.state.imageData[e];if(!t)return;const s=t.contentUrl;let a;a=P.default.isElectron?(0,M.default)((()=>(0,v.default)(s))).then((e=>{if(200!==e.status)throw new _.ServerStatusError(null,s,e.status);return e.blob()})):w.default.downloadImage(s),a.checkpoint(this.props.rejectOnUnmount()).then((e=>{if(!(e instanceof Blob))throw new _.ImageError("Server did not respond with image bytes",s);this.props.onImageSelected(e,t.hostPageUrl)})).catch((0,r.filteredCatch)(_.Unmount,(()=>{}))).catch((()=>{__LOG__(3,!0)`Image search failed`,u.default.openToast((0,D.jsx)(b.default,{msg:E.default.t(1044),id:(0,b.genId)()}))}))},this._focusSearch=()=>{C.default.shouldIndicateFocus(),x.default.focus(this.refSearch)},this._focusGallery=e=>{e.repeat||this._refGallery&&this.refSearch&&this.refSearch.cursorIsAtEnd()&&(e.preventDefault(),e.stopPropagation(),C.default.shouldIndicateFocus(),null!=this._refGallery&&x.default.focus(this._refGallery))},this._handleSearchFocus=()=>{C.default.maybeIndicateFocus(this._refSearchHotkeys)},this.state={imageData:{},isSearching:!1,nextOffset:0,query:"",thumbnails:[],totalEstimatedMatches:0},this._hasPendingSearch=!1,this._searchPromise=null,this._debouncedSearch=this.props.debounce(this._search,750)}componentWillUnmount(){this._cancelSearch()}_requestSearch(e,t=0){this._hasPendingSearch=!0,this._debouncedSearch(e,t)}_cancelSearch(){this._hasPendingSearch&&(this._debouncedSearch.cancel(),this._hasPendingSearch=!1),this._searchPromise&&this._searchPromise.cancel()}_resetState(){this.setState({imageData:{},isSearching:!1,nextOffset:0,query:"",thumbnails:[],totalEstimatedMatches:0})}_addSearchResults(e,t){this.setState((s=>{const a=(0,l.default)(t.value,(e=>null==e?void 0:e.thumbnailUrl)),i=(0,o.default)(t.value,(e=>({id:e.imageId,name:e.name,thumbUrl:e.thumbnailUrl}))),r=t.value.length,d={};return s.query===e?(d.nextOffset=t.nextOffset?t.nextOffset:s.nextOffset+r,d.thumbnails=(0,n.default)(s.thumbnails,i),d.totalEstimatedMatches=t.totalEstimatedMatches,d.imageData=Object.assign(a,s.imageData)):(d.imageData=a,d.nextOffset=t.nextOffset?t.nextOffset:r,d.query=e,d.thumbnails=i,d.totalEstimatedMatches=t.totalEstimatedMatches),d}))}render(){const e=m.DRAWER_HEADER_TYPE.POPUP,t={down:this._focusGallery};let s;return s=0===this.state.thumbnails.length?this.state.isSearching?(0,D.jsx)(g.SearchingImages,{}):this.state.query?(0,D.jsx)(g.ImageSearchEmpty,{}):(0,D.jsx)(g.BeforeImageSearch,{}):(0,D.jsx)(y.default,{ref:this._setRefGallery,canLoadMore:this.state.nextOffset<this.state.totalEstimatedMatches,isLoadingMore:this.state.isSearching,thumbnails:this.state.thumbnails,onFocusPrev:this._focusSearch,onImageClick:this._handleImageClick,onRequestMoreImages:this._handleRequestMoreImages}),(0,D.jsxs)(f.default,{children:[(0,D.jsx)(m.default,{title:E.default.t(1051),type:e,onBack:this.props.onBack,onCancel:this.props.onCancel}),(0,D.jsxs)(p.default,{children:[(0,D.jsx)(S.default,{onRef:this._setRefSearchHotkeys,handlers:t,onFocus:this._handleSearchFocus,children:(0,D.jsx)(j.default,{ref:this.setRefSearch,placeholder:E.default.t(1048),onSearch:this._handleUserInput,loading:this.state.isSearching})}),s]})]})}}O.displayName="ImageSearchDrawer";var N=(0,T.default)((0,I.default)(O));t.default=N},26456:(e,t,s)=>{"use strict";var a=s(20862),i=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(s(94184)),o=s(67294),l=i(s(17747)),r=i(s(9042)),d=a(s(55588)),c=i(s(2408)),u=s(14137),h=a(s(59606)),f=i(s(45227)),p=i(s(46714)),m=i(s(2966)),g=s(85893);class _ extends o.Component{constructor(...e){super(...e),this.state={hover:!1},this.handleClick=()=>{this.props.onUpdateColor({id:this.props.labelId,color:this.props.colorInt},h.LABEL_PROPERTIES.COLOR),this.props.onBack()},this._disableHover=()=>{this.state.hover&&this.setState({hover:!1})},this._enableHover=()=>{this.state.hover||this.setState({hover:!0})}}render(){const e=this.props.isSelected?(0,g.jsx)(m.default,{name:"checkmark-medium"}):null,t=(0,n.default)(f.default.wallpaperColorCanvas,{[f.default.canvasHover]:this.state.hover,[f.default.canvasActive]:this.props.isSelected});return(0,g.jsx)("span",{className:t,style:{backgroundColor:(0,u.intColorToHex)(this.props.colorInt)},onMouseOver:this._enableHover,onMouseEnter:this._enableHover,onMouseLeave:this._disableHover,onClick:this.handleClick,children:e})}}function v(e){const{currentColor:t,colors:s}=e,a=s.map((s=>(0,g.jsx)(_,{onUpdateColor:e.onUpdateColor,colorInt:s,onBack:e.onBack,labelId:e.labelId,isSelected:t===s},s)));for(let e=0;e<2;e++)a.push((0,g.jsx)("div",{className:f.default.wallpaperColorEmpty},"emptyEl"+e));return a}_.displayName="ColorCanvas";class C extends o.Component{constructor(){super(),this._getColorPromise=null,this.state={colors:h.default.labelColorPalette&&h.default.labelColorPalette.colors}}componentWillUnmount(){this._getColorPromise&&this._getColorPromise.cancel()}render(){let e=(0,g.jsx)(p.default,{stroke:6,size:24});return this.state.colors?e=(0,g.jsx)(v,{labelId:this.props.labelId,onBack:this.props.onClose,onUpdateColor:this.props.onUpdateColor,colors:this.state.colors,currentColor:this.props.currentColor}):(this._getColorPromise=h.default.getLabelColorPalette(),this._getColorPromise.cancellable().then((e=>{this.setState({colors:e})}))),(0,g.jsxs)(l.default,{children:[(0,g.jsx)(d.default,{theme:this.state.colors?void 0:"center-content",title:c.default.t(1090),onBack:this.props.onClose,type:d.DRAWER_HEADER_TYPE.LARGE}),(0,g.jsx)(r.default,{children:(0,g.jsx)("div",{className:f.default.container,children:e})})]})}}t.default=C,C.displayName="LabelColorDrawer"},35355:(e,t,s)=>{"use strict";var a=s(20862),i=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=s(67294),o=i(s(91952)),l=i(s(75940)),r=i(s(17747)),d=i(s(9042)),c=a(s(55588)),u=s(78615),h=i(s(2408)),f=i(s(44676)),p=s(12735),m=i(s(71681)),g=i(s(4231)),_=i(s(904)),v=i(s(99385)),C=i(s(66329)),x=i(s(3132)),S=i(s(2966)),y=s(85893);class E extends n.PureComponent{constructor(){super(),this.onMultiSelect=()=>{const e=this.multiSelection.getSelected().length;this.setState({selectedCount:e})},this.shouldScrollIntoViewAndSelect=()=>({shouldScrollIntoView:!0,shouldSelect:!1}),this.onDeleteLabel=e=>{o.default.closeModal(),this.multiSelection.unsetAll(),this.props.onDeleteLabel(e)},this._confirmDeleteSelectedLabels=()=>{const e=this.multiSelection.getSelected();(0,p.logLabelOperationEvent)(g.default.LABEL_OPERATIONS.VIEW,e.length,g.default.LABEL_TARGETS.DELETE_LABEL_DIALOG),o.default.openModal((0,y.jsx)(l.default,{okText:h.default.t(2222),cancelText:h.default.t(2082),onCancel:()=>{(0,p.logLabelOperationEvent)(g.default.LABEL_OPERATIONS.CLICK_NEGATIVE,1,g.default.LABEL_TARGETS.DELETE_LABEL_DIALOG),o.default.closeModal()},onOK:()=>{(0,p.logLabelOperationEvent)(g.default.LABEL_OPERATIONS.CLICK_POSITIVE,1,g.default.LABEL_TARGETS.DELETE_LABEL_DIALOG),this.onDeleteLabel(e)},children:h.default.t(753,{_plural:e.length})}))},this.onCancelSelection=()=>{this.multiSelection.unsetAll(),this.setState({selectedCount:0})},this.multiSelection=new C.default([],(e=>e.id)),this.state={selectedCount:0}}componentDidMount(){(0,p.logLabelOperationEvent)(g.default.LABEL_OPERATIONS.VIEW,void 0,g.default.LABEL_TARGETS.LABELS_SCREEN)}render(){const{selectedCount:e}=this.state;let t=null;t=e>0?(0,y.jsx)(_.default,{selectedModels:this.multiSelection,onCancel:this.onCancelSelection,onDelete:this._confirmDeleteSelectedLabels,theme:"drawer-header"}):(0,y.jsx)(c.default,{title:h.default.t(1101),onBack:this.props.onClose,type:c.DRAWER_HEADER_TYPE.LARGE});const s=(0,u.canEditLabel)()&&(0,y.jsx)("div",{className:f.default.addLabelBtContainer,children:(0,y.jsx)(x.default,{large:!0,onClick:this.props.openAddLabel,children:(0,y.jsx)(S.default,{name:"plus-large"})})});return(0,y.jsxs)(r.default,{theme:"settings",children:[t,(0,y.jsx)(d.default,{children:(0,y.jsx)(v.default,{shouldScrollIntoViewAndSelect:this.shouldScrollIntoViewAndSelect,selectedLabels:this.multiSelection,renderContext:"label-list",onMultiSelect:this.onMultiSelect,onLabelClick:this.props.onLabelClick})}),s]})}}E.displayName="LabelDrawer";var j=(0,m.default)(E);t.default=j},19049:(e,t,s)=>{"use strict";var a=s(20862),i=s(95318);t.Z=void 0;var n=s(67294),o=i(s(48392)),l=i(s(91952)),r=i(s(75940)),d=i(s(17747)),c=i(s(9042)),u=a(s(55588)),h=a(s(9492)),f=i(s(47452)),p=s(78615),m=i(s(2408)),g=i(s(59606)),_=s(12735),v=i(s(84498)),C=i(s(71681)),x=s(47941),S=i(s(4231)),y=i(s(904)),E=i(s(92954)),j=i(s(66329)),I=i(s(87947)),M=i(s(2966)),T=s(85893);function b({openColorPicker:e,openEditLabel:t}){return(0,p.canEditLabel)()?(0,T.jsx)(x.MenuBarItem,{a8nText:"starred-menu",icon:(0,T.jsx)(M.default,{name:"menu"}),title:m.default.t(1227),children:(0,T.jsxs)(h.default,{type:"dropdown_menu",flipOnRTL:!0,dirX:h.DirX.LEFT,children:[(0,T.jsx)(f.default,{a8n:"menu-item",action:e,children:m.default.t(1090)}),(0,T.jsx)(f.default,{a8n:"menu-item",action:t,children:m.default.t(801)})]},"labelChooseColor")}):null}class P extends n.PureComponent{constructor(){super(),this._openColorPicker=()=>{const{labelId:e}=this.props,t=g.default.assertGet(e);this.props.openLabelColorDrawer(this.props.labelId,t.color)},this._openEditLabel=()=>{this.props.onEditLabel&&this.props.onEditLabel(this.props.labelId)},this.onCancelLabelSelection=()=>{this.multiSelection.unsetAll()},this.onRemoveLabel=()=>{const e=this.multiSelection.getSelected(),{onRemoveLabel:t,labelId:s}=this.props;if(!t)return;const a=g.default.assertGet(s);(0,_.logLabelOperationEvent)(S.default.LABEL_OPERATIONS.VIEW,e.length,S.default.LABEL_TARGETS.BULK_UNLABEL_DIALOG),l.default.openModal((0,T.jsx)(r.default,{title:m.default.t(1518,{count:e.length,labelName:a.name,_plural:e.length}),okText:m.default.t(2085),cancelText:m.default.t(1912),onCancel:this._closeModal,onOK:this._onRemoveLabelConfirmed.bind(null,s,e)}))},this._closeModal=()=>{const e=this.multiSelection.getSelected();(0,_.logLabelOperationEvent)(S.default.LABEL_OPERATIONS.CLICK_NEGATIVE,e.length,S.default.LABEL_TARGETS.BULK_UNLABEL_DIALOG),l.default.closeModal()},this._onRemoveLabelConfirmed=(e,t)=>{l.default.closeModal(),this.onCancelLabelSelection(),this.props.onRemoveLabel(e,t),(0,_.logLabelOperationEvent)(S.default.LABEL_OPERATIONS.CLICK_POSITIVE,t.length,S.default.LABEL_TARGETS.BULK_UNLABEL_DIALOG)},this.multiSelection=new j.default([],(e=>e.id.toString()))}componentDidMount(){this.props.listeners.add(this.multiSelection,"all",(()=>this.forceUpdate())),(0,_.logLabelOperationEvent)(S.default.LABEL_OPERATIONS.VIEW,void 0,S.default.LABEL_TARGETS.LABEL_DETAILS_SCREEN)}_hasMixedSelection(e){let t,s;for(let a=0;a<e.length;a++){if(e[a]instanceof E.default?s=!0:t=!0,t&&s)return!0}return!1}render(){const e=this.multiSelection.getSelected(),t=this._hasMixedSelection(e),s=this.multiSelection.getSelected().length>0?(0,T.jsx)(y.default,{labelEditEnabled:!t,onRemoveLabel:this.onRemoveLabel,selectedModels:this.multiSelection,onCancel:this.onCancelLabelSelection,theme:"drawer-header"}):(0,T.jsx)(u.default,{onBack:this.props.onClose,menu:(0,T.jsx)(b,{openColorPicker:this._openColorPicker,openEditLabel:this._openEditLabel}),type:u.DRAWER_HEADER_TYPE.LABELS,children:(0,T.jsx)(v.default,{labels:[this.props.labelId],renderAsCircle:!0,showName:!0,theme:"drawer-title"})});return(0,T.jsxs)(d.default,{theme:"settings",children:[s,(0,T.jsx)(c.default,{children:(0,T.jsx)(o.default,{hideMultiSelectBar:!0,multiSelection:this.multiSelection,labelFilter:this.props.labelId,settings:I.default,selectable:!0})})]})}}P.displayName="LabelItemDrawer";var L=(0,C.default)(P);t.Z=L},75402:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(67294),n=a(s(91952)),o=a(s(75940)),l=a(s(2408)),r=a(s(64677)),d=s(79475),c=a(s(46714)),u=s(97504),h=s(85893);class f extends i.Component{constructor(...e){super(...e),this.state={licensesText:void 0},this.onOk=()=>{this.props.onOk&&this.props.onOk(),n.default.closeModal()}}componentDidMount(){}render(){let e,t;return this.state.licensesText||(e=(0,h.jsx)("div",{className:r.default.spinner,children:(0,h.jsx)(c.default,{size:50,stroke:4})},"spinner")),this.state.licensesText&&(t=(0,h.jsx)("div",{className:r.default.textContainer,children:this.state.licensesText})),(0,h.jsx)(o.default,{okText:l.default.t(2085),onOK:this.onOk,type:d.ModalTheme.Flex,children:(0,h.jsxs)("div",{className:r.default.container,children:[(0,h.jsx)(u.TextSpan,{theme:"popup-title",children:l.default.t(1104)}),t,e]})})}}t.default=f,f.displayName="LicensesPopup"},66951:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.ID_SEPARATOR=void 0;var i=a(s(55765)),n=s(20651);t.ID_SEPARATOR=",";t.default=class{constructor(...e){this.participants=new i.default,e.forEach((e=>this.add(e)))}get id(){return this.participants.map((({id:e})=>e.toString())).join(",")}get center(){const e=this.participants.map((({lat:e})=>e)),t=this.participants.map((({lng:e})=>e));return{lat:(Math.min(...e)+Math.max(...e))/2,lng:(Math.min(...t)+Math.max(...t))/2}}get lat(){return this.center.lat}get lng(){return this.center.lng}get length(){return this.participants.length}get northeast(){const e=this.participants.map((({lat:e})=>e)),t=this.participants.map((({lng:e})=>e));return{lat:Math.max(...e),lng:Math.max(...t)}}get southwest(){const e=this.participants.map((({lat:e})=>e)),t=this.participants.map((({lng:e})=>e));return{lat:Math.min(...e),lng:Math.min(...t)}}add(e){this.participants.add(e)}hasSingleParticipant(){return 1===this.length}fits(e,t,s){const{lat:a,lng:i}=this.center,{lat:o,lng:l}=e,r=(0,n.getMetersBetweenLatLngs)(a,i,a,l),d=(0,n.getMetersBetweenLatLngs)(a,i,o,i),c=(0,n.getMetersPerPixel)(a,t);return r/c<=s&&d/c<=s}}},84871:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(67294),n=a(s(14395)),o=a(s(88419)),l=a(s(34295)),r=a(s(86025)),d=a(s(19257)),c=a(s(67893)),u=a(s(2408)),h=a(s(78972)),f=a(s(2966)),p=a(s(95395)),m=s(85893);class g extends i.Component{constructor(...e){super(...e),this.flatListController=new c.default,this.renderListItem=e=>{const{participant:t}=e,s=t.isMe?(0,m.jsx)("div",{className:n.default.time,children:(0,m.jsx)(l.default,{reason:"live-location-time",children:(0,m.jsx)(p.default,{participant:t})})}):null;return(0,m.jsxs)("div",{className:n.default.item,onClick:()=>this.props.onParticipantSelected(t.contact.id.toString()),children:[(0,m.jsx)("div",{className:n.default.left,children:(0,m.jsx)(o.default,{id:t.contact.id,size:28})}),(0,m.jsxs)("div",{className:n.default.right,children:[(0,m.jsx)("div",{className:n.default.name,children:(0,m.jsx)(h.default,{contact:t.contact,titlify:!0,ellipsify:!0,you:!0})}),s]})]})}}getListData(){return this.props.participants.map((e=>({itemKey:e.id.toString(),participant:e})))}render(){return(0,m.jsxs)("div",{className:n.default.container,children:[(0,m.jsxs)("div",{className:n.default.header,children:[(0,m.jsx)("div",{className:n.default.left,children:(0,m.jsx)("span",{className:n.default.close,onClick:this.props.onClearSelected,children:(0,m.jsx)(f.default,{name:"x"})})}),(0,m.jsx)("div",{className:n.default.right,children:u.default.t(1110,{count:this.props.participants.length,_plural:this.props.participants.length})})]}),(0,m.jsx)(d.default,{className:n.default.list,flatListControllers:[this.flatListController],children:(0,m.jsx)(r.default,{data:this.getListData(),flatListController:this.flatListController,direction:"vertical",defaultItemHeight:48,renderItem:this.renderListItem})})]})}}t.default=g,g.displayName="LiveLocationClusterList"},11103:(e,t,s)=>{"use strict";var a=s(20862),i=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,s,a){const i=new Map;if(!e.length)return i;const l=e.filter((e=>e!==s)).sort(((e,t)=>e.lat-t.lat));for(let e=0;e<l.length;e++){const s=l[e];let r;if(i.forEach((e=>{!r&&e.fits(s,t,a)&&(r=e)})),r){const e=r,t=r.id;i.delete(t),e.add(s)}else r=new o.default(s);i.set((0,n.default)(r,"clusterToAdd").id,(0,n.default)(r,"clusterToAdd"))}if(s&&e.length!==l.length){const e=new o.default(s);i.set(e.id,e)}return i},t.participantInCluster=function(e,t){return e.split(o.ID_SEPARATOR).includes(t.toString())},t.singleParticipantClusterId=function(e){return!e.includes(o.ID_SEPARATOR)},t.findClusterForParticipant=function(e,t){let s;const a=e.values();for(;(s=a.next())&&!s.done;){const e=s.value;if(e.participants.get(t))return e}return null};var n=i(s(7900)),o=a(s(66951))},32295:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getSmallestElapsedTime=s,t.isStale=function(e){return s(e)>=600},t.MARKER_SIZE=t.AVATAR_SIZE=t.PIN_SIZE=t.GLOW_SIZE=t.IMAGE_BORDER_SIZE=t.IMAGE_SIZE=t.STALE_THRESHOLD=void 0;t.STALE_THRESHOLD=600;t.IMAGE_SIZE=40;t.IMAGE_BORDER_SIZE=2;t.GLOW_SIZE=4;t.PIN_SIZE=4;t.AVATAR_SIZE=44;function s(e){const t=e.participants.map((e=>e.elapsedTime()));return Math.min(...t)}t.MARKER_SIZE=52},82701:(e,t,s)=>{"use strict";var a=s(20862),i=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=s(67294),o=i(s(25142)),l=i(s(17747)),r=i(s(9042)),d=a(s(55588)),c=i(s(52087)),u=i(s(34600)),h=i(s(2408)),f=i(s(71681)),p=i(s(28526)),m=s(38665),g=i(s(93233)),_=i(s(40298)),v=i(s(79485)),C=i(s(2966)),x=s(85893);class S extends n.PureComponent{constructor(e){super(e),this.onClose=()=>{this.props.onClose?this.props.onClose():this.props.uim.uie.requestDismiss()},this.onRoadmapSelected=()=>{this.setState({mapType:m.MapType.ROADMAP})},this.onSatelliteSelected=()=>{this.setState({mapType:m.MapType.SATELLITE})},this.onTerrainSelected=()=>{this.setState({mapType:m.MapType.TERRAIN})},this.onTrafficToggled=()=>{this.setState((e=>({showTraffic:!e.showTraffic})))},this.onMarkerSelected=e=>{this.setState({markerSelected:e})},this.state={mapType:m.MapType.ROADMAP,showTraffic:!1,markerSelected:!1,online:_.default.online}}componentDidMount(){this.props.listeners.add(_.default,"change:online",(()=>{this.setState({online:_.default.online})}))}render(){const e=(0,x.jsx)(g.default,{onRoadmapSelected:this.onRoadmapSelected,onSatelliteSelected:this.onSatelliteSelected,onTerrainSelected:this.onTerrainSelected,onTrafficToggled:this.onTrafficToggled,showTraffic:this.state.showTraffic}),{finalLat:t,finalLng:s,finalTimeOffset:a,lat:i,lng:n,senderObj:c,t:f}=this.props.msg,{mapType:m,showTraffic:_,markerSelected:v,online:S}=this.state;let y,E,j,I;return void 0===t||void 0===s||void 0===a?(y=i,E=n,j=f):(y=t,E=s,j=f+a),I=S?(0,x.jsxs)("div",{className:u.default.wrapper,children:[(0,x.jsx)(p.default,{contact:c,lat:y,lng:E,mapType:m,showTraffic:_,markerSelected:v,onMarkerSelected:this.onMarkerSelected}),(0,x.jsxs)("div",{className:u.default.notification,children:[(0,x.jsx)("div",{className:u.default.ended,children:h.default.t(1111)}),(0,x.jsx)("div",{className:u.default.lastUpdated,children:o.default.liveLocationLastUpdatedStr(j)})]})]}):(0,x.jsx)("div",{className:u.default.offline,children:(0,x.jsxs)("div",{children:[(0,x.jsx)("div",{className:u.default.circle,children:(0,x.jsx)(C.default,{name:"live-location-disconnected"})}),(0,x.jsx)("div",{className:u.default.text,children:h.default.t(1158)})]})}),(0,x.jsxs)(l.default,{children:[(0,x.jsx)(d.default,{title:h.default.t(1112),type:d.DRAWER_HEADER_TYPE.SMALL,menu:e,onCancel:this.onClose}),(0,x.jsx)(r.default,{children:I})]})}}S.CONCERNS={msg:["finalLat","finalLng","finalTimeOffset","lat","lng","senderObj","t"]},S.displayName="ExpiredLocationDrawer";var y=(0,c.default)((0,f.default)((0,v.default)(S,S.CONCERNS)));t.default=y},28526:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(78285),n=s(67294),o=s(33458),l=s(38665),r=a(s(42599)),d=s(85893);class c extends n.Component{constructor(e){super(e),this.setMap=e=>this.map=e,this.mapOnClick=()=>{this.dismissMarkerTimer.debounceAndCap(50,100)},this.markerOnClick=()=>{this.dismissMarkerTimer.isScheduled()&&this.dismissMarkerTimer.cancel(),this.props.onMarkerSelected(!0)},this.getPixelPositionOffset=(e,t)=>({x:-e/2,y:-t}),this.dismissMarkerTimer=new i.ShiftTimer((()=>{this.props.markerSelected&&this.props.onMarkerSelected(!1)}))}componentWillUnmount(){this.dismissMarkerTimer.isScheduled()&&this.dismissMarkerTimer.cancel()}getMapPaneName(){return o.OverlayView.OVERLAY_MOUSE_TARGET}getMarkers(){const{lat:e,lng:t,contact:s,markerSelected:a}=this.props;return(0,d.jsx)(r.default,{marker:{isLive:!1,contact:s,lat:e,lng:t,selected:a,onClick:e=>this.markerOnClick(e)}})}getTrafficLayer(){return this.props.showTraffic?(0,d.jsx)(o.TrafficLayer,{autoRefresh:!0}):null}render(){const{lat:e,lng:t}=this.props;return(0,d.jsxs)(o.GoogleMap,{ref:this.setMap,defaultCenter:{lat:e,lng:t},defaultOptions:this.props.getMapOptions(),defaultZoom:l.INITIAL_ZOOM,mapTypeId:this.props.mapType,onClick:this.mapOnClick,children:[this.getMarkers(),this.getTrafficLayer()]})}}c.displayName="ExpiredLocationMap";var u=(0,l.withConfig)((0,o.withScriptjs)((0,o.withGoogleMap)(c)));t.default=u},32129:(e,t,s)=>{"use strict";var a=s(20862),i=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(s(41609)),o=i(s(23493)),l=i(s(94184)),r=s(67294),d=i(s(84871)),c=a(s(11103)),u=i(s(91952)),h=s(32295),f=i(s(17747)),p=i(s(9042)),m=a(s(55588)),g=i(s(52087)),_=i(s(85529)),v=i(s(2408)),C=i(s(71681)),x=i(s(70998)),S=i(s(82930)),y=s(38665),E=i(s(93233)),j=i(s(40298)),I=i(s(34060)),M=i(s(39860)),T=i(s(79485)),b=s(15298),P=i(s(2966)),L=i(s(69217)),w=a(s(49201)),D=i(s(69635)),O=s(89573),N=s(85893);const R=["click","mousedown","mousemove","scroll"],k="ACTIVE",A="INACTIVE",F="OFFLINE";class B extends r.PureComponent{constructor(e){super(e),this._onParticipantAdd=()=>{const{zoomLevel:e,selectedParticipantId:t}=this.state;this._updateMinZoomClusters(),this.setState({clusters:this._getClusters(e,t)})},this.onParticipantRemove=e=>{const{selectedClusterId:t,selectedParticipantId:s,zoomLevel:a}=this.state;this._updateMinZoomClusters();let i=t,n=s;t&&(0,c.participantInCluster)(t,e.id)&&(i=null),D.default.equals(s,e.id)&&(n=null),this.setState({selectedClusterId:i,selectedParticipantId:n,clusters:this._getClusters(a,n)})},this._onParticipantDisable=e=>{if(!e.isMe){const t=e.contact.formattedName;u.default.openToast((0,N.jsx)(w.default,{msg:v.default.t(1135,{name:t}),id:(0,w.genId)()}))}},this.onLocationChanged=()=>{const{zoomLevel:e,selectedParticipantId:t}=this.state;this._updateMinZoomClusters(),this.setState({clusters:this._getClusters(e,t)})},this.onIdle=()=>{const{liveLocation:e}=this.props.chat;e&&(e.stopViewingMap(),this.setState({status:A}))},this.onActivity=(0,o.default)((()=>{this._removeIdleTimeout(),this._addIdleTimeout()}),250),this._onRefresh=()=>{const{liveLocation:e}=this.props.chat;e&&(e.startViewingMap(),this.setState({status:k}))},this.onClose=()=>{this.props.onClose?this.props.onClose():this.props.uim.uie.requestDismiss()},this.onMarkerSelected=e=>{e?(0,c.singleParticipantClusterId)(e)?this.onParticipantSelected(e):this._onClusterSelected(e):this.onClearSelected()},this.onClearSelected=()=>{const{selectedParticipantId:e,selectedClusterId:t,zoomLevel:s}=this.state;(e||t)&&this.setState({selectedParticipantId:null,selectedClusterId:null,clusters:this._getClusters(s)})},this._onClusterSelected=e=>{this.state.selectedClusterId!==e&&this.setState({selectedParticipantId:null,selectedClusterId:e})},this.onParticipantSelected=e=>{const{selectedParticipantId:t,zoomLevel:s}=this.state,a=(0,O.createWid)(e);D.default.equals(t,a)||this.setState({selectedParticipantId:a,selectedClusterId:null,clusters:this._getClusters(s,a)})},this.onStopSharing=e=>{e.preventDefault(),e.stopPropagation();const{chat:t}=this.props;u.default.openModal((0,N.jsx)(x.default,{chat:t}))},this.onRoadmapSelected=()=>{this.setState({mapType:y.MapType.ROADMAP})},this.onSatelliteSelected=()=>{this.setState({mapType:y.MapType.SATELLITE})},this.onTerrainSelected=()=>{this.setState({mapType:y.MapType.TERRAIN})},this.onTrafficToggled=()=>{this.setState((e=>({showTraffic:!e.showTraffic})))},this._onBackToCenter=()=>{this.setState({selectedParticipantId:null,selectedClusterId:null,atCenter:!0,clusters:this._getClusters(this.state.zoomLevel)})},this.onMapMoved=(e,t)=>{this.setState((s=>{const a={};if(s.zoomLevel!==e){const t=this._getClusters(e,s.selectedParticipantId);Object.assign(a,{zoomLevel:e,clusters:t})}return this._hasValidParticipants()&&s.atCenter!==t&&Object.assign(a,{atCenter:t}),(0,n.default)(a)?null:a}))},this._updateMinZoomClusters(),this.state={clusters:this._getClusters(y.INITIAL_ZOOM),selectedClusterId:null,selectedParticipantId:null,mapType:y.MapType.ROADMAP,showTraffic:!1,zoomLevel:y.INITIAL_ZOOM,atCenter:!0,status:j.default.online?k:F}}componentDidMount(){this._listenToModelChange(),this._listenToNetworkChange(),this._startCheckingForIdle();const{liveLocation:e}=this.props.chat;e&&(e.startViewingMap(),this._addParticipantListeners(e))}componentWillUnmount(){this.onActivity.cancel();const{liveLocation:e}=this.props.chat;e&&e.stopViewingMap()}_addParticipantListeners(e){this.props.listeners.add(e.participants,"add",this._onParticipantAdd),this.props.listeners.add(e.participants,"remove",this.onParticipantRemove),this.props.listeners.add(e.participants,"change:disabled",this._onParticipantDisable),this.props.listeners.add(e.participants,"change:valid",this.onLocationChanged)}_removeParticipantListeners(e){this.props.listeners.remove(e.participants,"add",this._onParticipantAdd),this.props.listeners.remove(e.participants,"remove",this.onParticipantRemove),this.props.listeners.remove(e.participants,"change:disabled",this._onParticipantDisable),this.props.listeners.remove(e.participants,"change:valid",this.onLocationChanged)}_listenToModelChange(){const{chat:e}=this.props;this.props.listeners.add((0,b.unproxy)(e),"change:liveLocation",(()=>{const{liveLocation:t}=e;t&&(this._removeParticipantListeners(t),this._addParticipantListeners(t));const{zoomLevel:s}=this.state;this.setState({clusters:this._getClusters(s)})}))}_listenToNetworkChange(){this.props.listeners.add(j.default,"change:online",(()=>{j.default.online||this._stopCheckingForIdle(),this.setState({status:j.default.online?k:F})}))}_startCheckingForIdle(){this._addIdleTimeout(),this._addActivityListeners()}_stopCheckingForIdle(){this._removeIdleTimeout(),this._removeActivityListeners()}_addIdleTimeout(){this._idleTimeoutId=this.props.setTimeout(this.onIdle,18e4)}_removeIdleTimeout(){null!=this._idleTimeoutId&&this.props.clearTimeout(this._idleTimeoutId),this._idleTimeoutId=null}_addActivityListeners(){R.forEach((e=>{this.props.listeners.add(document,e,this.onActivity)}))}_removeActivityListeners(){R.forEach((e=>{this.props.listeners.remove(document,e,this.onActivity)}))}_updateMinZoomClusters(){const e=this.getParticipants(),t=e?e.validLocations():[];this._minZoomClusters=(0,c.default)(t,y.MIN_ZOOM,null,h.MARKER_SIZE)}getParticipants(){const{liveLocation:e}=this.props.chat;return e?e.participants:null}_hasValidParticipants(){const e=this.getParticipants();return!!e&&!!e.validLocations().length}_getOpenFromCluster(){const e=this.getParticipants();if(!e||0===e.length)return null;const{openFrom:t}=this.props;let s=null;if(t)s=t;else{const t=e.at(0);t&&(s=t.id)}return s?(0,c.findClusterForParticipant)(this._minZoomClusters,s):null}_getClusters(e,t){const s=this.getParticipants();let a=null,i=[];s&&(t&&(a=s.get(t)),i=s.validLocations());let n=i,o=[];if(this._minZoomClusters.size>1){const e=this._getOpenFromCluster();if(e){const t=e.participants;n=t.validLocations(),o=i.filter((({id:e})=>!t.get(e)))}}return{primary:(0,c.default)(n,e,a,h.MARKER_SIZE),secondary:(0,c.default)(o,e,a,h.MARKER_SIZE)}}_getList(){const{clusters:e,selectedClusterId:t}=this.state,s=this.getParticipants();let a;if(s&&s.length){if(t){const s=e.primary.get(t)||e.secondary.get(t);if(s){const e=s.participants;a=(0,N.jsx)(d.default,{participants:e,onParticipantSelected:this.onParticipantSelected,onClearSelected:this.onClearSelected})}}a||(a=(0,N.jsx)(I.default,{participants:s,onParticipantSelected:this.onParticipantSelected,onStopSharing:this.onStopSharing}))}return a}render(){let e,t;this.props.isFirstLevel?e=this.onClose:t=this.onClose;const{selectedParticipantId:s,selectedClusterId:a,mapType:i,showTraffic:n,atCenter:o,status:r}=this.state,d=r===k?(0,N.jsx)(E.default,{onRoadmapSelected:this.onRoadmapSelected,onSatelliteSelected:this.onSatelliteSelected,onTerrainSelected:this.onTerrainSelected,onTrafficToggled:this.onTrafficToggled,showTraffic:n}):null;let c,u;if(r===k||r===A){const e=s&&s.toString()||a;c=(0,N.jsxs)("div",{className:_.default.wrapper,children:[(0,N.jsx)("div",{className:(0,l.default)(_.default.backToCenter,{[_.default.visible]:!o}),onClick:this._onBackToCenter,children:(0,N.jsx)(P.default,{name:"return"})}),(0,N.jsx)(S.default,{clusters:this.state.clusters.primary,secondaryClusters:this.state.clusters.secondary,selectedMarkerId:e,openFrom:this.props.openFrom,mapType:i,showTraffic:n,atCenter:o,onMarkerSelected:this.onMarkerSelected,onClearSelected:this.onClearSelected,onLocationChanged:this.onLocationChanged,onMapMoved:this.onMapMoved}),this._getList()]})}if(r===A||r===F){const e=r===A,t=e?"live-location-refresh":"live-location-disconnected",s=e?v.default.t(1123):v.default.t(1158);u=(0,N.jsx)(M.default,{inactive:e,svgName:t,text:s,onClick:e?this._onRefresh:void 0})}return(0,N.jsxs)(f.default,{children:[(0,N.jsx)(m.default,{title:v.default.t(1136),type:m.DRAWER_HEADER_TYPE.SMALL,menu:d,onBack:t,onCancel:e}),(0,N.jsxs)(p.default,{children:[c,u]})]})}}B.CONCERNS={chat:["id","liveLocation"]},B.displayName="LiveLocationDrawer";var U=(0,g.default)((0,L.default)((0,C.default)((0,T.default)(B,B.CONCERNS))));t.default=U},82930:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(s(23279)),n=s(78285),o=s(67294),l=s(33458),r=s(38665),d=a(s(42599)),c=s(20651),u=s(85893);const h=1e-4;class f extends o.Component{constructor(e){super(e),this.setMap=e=>this.map=e,this.handleLocationChanged=e=>{const{clusters:t,atCenter:s,selectedMarkerId:a}=this.props;if(this.props.onLocationChanged(),!a&&s)this._viewAllClusters();else if(a&&a===e){const e=t.get(a);e&&this._viewSingleCluster(e)}},this.handleIdle=(0,i.default)((()=>{const e=this.map;if(!e)return;const t=e.getZoom();if(this._zoomingToAllClusters){this._defaultZoomLevel=t,this._zoomingToAllClusters=!1;const e=this._zoomHistory;if(e.prev.preZoom===e.curr.postZoom&&e.prev.postZoom===e.curr.preZoom)return}this.props.onMapMoved(t,this.atCenter())}),100),this.handleDragStart=()=>{const e=this.map;if(!e)return;const t=e.getZoom();this.props.onMapMoved(t,!1)},this.handleResize=(0,i.default)((()=>{this._setMapLatLngDiff()}),250),this.mapOnClick=()=>{this.dismissMarkerTimer.debounceAndCap(50,100)},this.markerOnClick=(e,t)=>{this.dismissMarkerTimer.isScheduled()&&this.dismissMarkerTimer.cancel(),this.props.onMarkerSelected(t)},this.dismissMarkerTimer=new n.ShiftTimer((()=>{this.props.selectedMarkerId&&this.props.onClearSelected()})),this._defaultLatDiff=this._defaultLngDiff=.01,this._defaultZoomLevel=-1,this._zoomingToAllClusters=!1,this._zoomHistory={prev:{preZoom:-1,postZoom:-1},curr:{preZoom:-1,postZoom:-1}}}componentWillUnmount(){this.handleIdle.cancel(),this.handleResize.cancel(),window.removeEventListener("resize",this.handleResize),this.dismissMarkerTimer.isScheduled()&&this.dismissMarkerTimer.cancel()}componentDidMount(){window.addEventListener("resize",this.handleResize),this._setMapLatLngDiff(),this._viewAllClusters()}componentDidUpdate(e){const{clusters:t,secondaryClusters:s,selectedMarkerId:a,atCenter:i}=this.props,{selectedMarkerId:n}=e;if(this._setMapLatLngDiff(),t.size&&(!n||a||i))if(a&&n!==a){const e=t.get(a)||s.get(a);e&&this._viewSingleCluster(e)}else!a&&i&&this._viewAllClusters()}_viewAllClusters(){const{clusters:e}=this.props;0===e.size||this.atCenter()||(this._zoomToFitAllClusters(e),this._centerAllClusters(e))}_viewSingleCluster(e){this._zoomToFitSingleCluster(e),this._centerSingleCluster(e)}_zoomToFitAllClusters(e){const t=this.map;if(!t)return;this._zoomingToAllClusters=!0,this._zoomHistory.prev.preZoom=this._zoomHistory.curr.preZoom,this._zoomHistory.curr.preZoom=t.getZoom();const s=this.getBounds(e),a=e.entries().next();if(1!==e.size||a.done)this._boundsTooSmall(s)?t.fitBounds(this._getDefaultBounds(s.getCenter())):t.fitBounds(s);else{const[,e]=a.value;this._zoomToFitSingleCluster(e,!1)}this._zoomHistory.prev.postZoom=this._zoomHistory.curr.postZoom,this._zoomHistory.curr.postZoom=t.getZoom()}_zoomToFitSingleCluster(e,t=!0){const s=this.map;if(!s)return;if(t&&this._boundsTooSmall(s.getBounds()))return;const a=e.northeast,i=e.southwest,n=new google.maps.LatLng(a.lat,a.lng),o=new google.maps.LatLng(i.lat,i.lng),l=new google.maps.LatLngBounds(o,n);this._boundsTooSmall(l)?s.fitBounds(this._getDefaultBounds(l.getCenter())):s.fitBounds(l)}_centerAllClusters(e){const t=this.getBounds(e).getCenter();this._centerMap(t)}_centerSingleCluster(e){const t=new google.maps.LatLng(e.center);this._centerMap(t)}_centerMap(e){const t=this.map;t&&(t.getCenter().equals(e)||t.panTo(e))}_getInitialCenter(){return this.getBounds(this.props.clusters).getCenter()}getBounds(e){const t=new google.maps.LatLngBounds;return e.forEach((e=>{t.extend({lat:e.lat,lng:e.lng})})),t}_boundsTooSmall(e){const t=e.getNorthEast(),s=e.getSouthWest(),a=t.lat()-s.lat(),i=t.lng()-s.lng(),n=Math.abs(a)<this._defaultLatDiff,o=Math.abs(i)<this._defaultLngDiff;return n||o}_getDefaultBounds(e){const t=new google.maps.LatLng(e.lat()-this._defaultLatDiff/2,e.lng()-this._defaultLngDiff/2),s=new google.maps.LatLng(e.lat()+this._defaultLatDiff/2,e.lng()+this._defaultLngDiff/2);return new google.maps.LatLngBounds(t,s)}atCenter(){const e=this.map;if(!e)return!0;const t=e.getCenter(),s=this._getInitialCenter(),a=t.lat()-s.lat(),i=t.lng()-s.lng();return Math.abs(a)<h&&Math.abs(i)<h&&this._defaultZoomLevel===e.getZoom()}_setMapLatLngDiff(){const e=this.map;if(!e)return;const t=e.getCenter(),s=e.getDiv(),a=(0,c.getMetersPerPixel)(t.lat(),r.INITIAL_ZOOM),i=s.offsetWidth*a,n=s.offsetHeight*a;this._defaultLatDiff=(0,c.getLatDiff)(n),this._defaultLngDiff=(0,c.getLngDiff)(i,t.lat())}getMarkers(){const{clusters:e,secondaryClusters:t,selectedMarkerId:s}=this.props,a=[],i=(e,t)=>{a.push((0,u.jsx)(d.default,{marker:{isLive:!0,cluster:e,onLocationChanged:()=>this.handleLocationChanged(t),selected:s===t,onClick:e=>this.markerOnClick(e,t)}},t))};return e.forEach(i),t.forEach(i),a}getTrafficLayer(){return this.props.showTraffic?(0,u.jsx)(l.TrafficLayer,{autoRefresh:!0}):null}render(){return(0,u.jsxs)(l.GoogleMap,{ref:this.setMap,defaultCenter:this._getInitialCenter(),defaultOptions:this.props.getMapOptions(),defaultZoom:r.INITIAL_ZOOM,mapTypeId:this.props.mapType,onClick:this.mapOnClick,onDragStart:this.handleDragStart,onIdle:this.handleIdle,children:[this.getMarkers(),this.getTrafficLayer()]})}}f.displayName="LiveLocationMap";var p=(0,r.withConfig)((0,l.withScriptjs)((0,l.withGoogleMap)(f)));t.default=p},38665:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.withConfig=function(e){return class extends n.Component{constructor(...e){super(...e),this.state={authFailed:!0===window.gm_authFailed},this._onAuthFailed=()=>{window.gm_authFailed=!0,this.setState({authFailed:!0});const e=this._getUrl();__LOG__(4,void 0,new Error,!0)`url: ${e}\ntarget: ${"web"}`,SEND_LOGS("google-map-auth-failed")}}componentDidMount(){window.gm_authFailure=this._onAuthFailed}componentWillUnmount(){window.gm_authFailure=void 0}_getUrl(){const e={client:"gme-whatsappinc",v:"3",libraries:"geometry,drawing,places",t:Math.floor(Date.now()/864e5)};return d.default.build("https://maps.googleapis.com/maps/api/js",e)}getMapOptions(){return{clickableIcons:!1,fullscreenControl:!1,keyboardShortcuts:!1,mapTypeControl:!1,minZoom:3,streetViewControl:!1,zoomControl:!0,zoomControlOptions:{position:google.maps.ControlPosition.TOP_RIGHT}}}render(){if(this.state.authFailed)return(0,c.jsx)("div",{className:l.default.authFailed,children:o.default.t(946)});const t=this._getUrl(),s=(0,c.jsx)("div",{className:l.default.loading,children:(0,c.jsx)(r.default,{color:"highlight"})}),a=(0,c.jsx)("div",{className:l.default.container}),n=(0,c.jsx)("div",{className:l.default.map});return(0,c.jsx)(e,(0,i.default)({googleMapURL:t,loadingElement:s,containerElement:a,mapElement:n,getMapOptions:this.getMapOptions},this.props))}}},t.MIN_ZOOM=t.INITIAL_ZOOM=t.MapType=void 0;var i=a(s(81109)),n=s(67294),o=a(s(2408)),l=a(s(98057)),r=a(s(46714)),d=a(s(1458)),c=s(85893);const u=s(54302)({ROADMAP:"roadmap",SATELLITE:"satellite",TERRAIN:"terrain"});t.MapType=u;t.INITIAL_ZOOM=15;t.MIN_ZOOM=3},42599:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(s(94184)),n=s(67294),o=s(33458),l=a(s(12064)),r=s(32295),d=a(s(71681)),c=a(s(48347)),u=a(s(89369)),h=a(s(69217)),f=a(s(64029)),p=s(85893);class m extends n.Component{constructor(e){super(e),this._setOverlay=e=>{this.overlay=e},this.handleLocationChanged=()=>{this.props.marker.isLive&&this.props.marker.onLocationChanged()},this._handleLastUpdatedTimeChanged=()=>{if(!this.props.marker.isLive)return;null!=this.timeoutId&&(this.props.clearTimeout(this.timeoutId),this.timeoutId=null);const e=(0,r.isStale)(this.props.marker.cluster);this.state.stale!==e&&this.setState({stale:e}),e||this._setStaleTimeout()},this._getPixelPositionOffset=(e,t)=>({x:-e/2,y:-t}),this.state={stale:!e.marker.isLive||(0,r.isStale)(e.marker.cluster)}}componentDidMount(){if(!this.props.marker.isLive)return;const{cluster:e}=this.props.marker;(0,r.isStale)(e)||this._setStaleTimeout();e.participants.forEach((e=>{this.props.listeners.add(e,"change:lat change:lng",this.handleLocationChanged),this.props.listeners.add(e,"change:lastUpdated",this._handleLastUpdatedTimeChanged)}))}_setStaleTimeout(){if(!this.props.marker.isLive)return;const{cluster:e}=this.props.marker,t=r.STALE_THRESHOLD-(0,r.getSmallestElapsedTime)(e);t<=0||(this.timeoutId=this.props.setTimeout((()=>this.setState({stale:!0})),1e3*t))}_getMapPaneName(){return this.props.marker.onClick?o.OverlayView.OVERLAY_MOUSE_TARGET:o.OverlayView.OVERLAY_LAYER}render(){let e,t,s,a;const{onClick:n,selected:d}=this.props.marker,{stale:h}=this.state;if(this.props.marker.isLive){const{cluster:a}=this.props.marker;e=a.lat,t=a.lng,s=a.participants.map((({id:e})=>e))}else e=this.props.marker.lat,t=this.props.marker.lng,s=[this.props.marker.contact.id];if(d){let s,i,n;if(this.props.marker.isLive){const{cluster:e}=this.props.marker,t=e.participants,a=e.hasSingleParticipant()?t.at(0):null;a&&(s=a.id,i=a.accuracy,n=a.isMe)}else{const{contact:e}=this.props.marker;s=e.id,n=e.isMe}s&&(a=(0,p.jsx)(u.default,{id:s,lat:e,lng:t,accuracy:i,isMe:n||!1,markerSize:r.MARKER_SIZE}))}return(0,p.jsx)(o.OverlayView,{ref:this._setOverlay,position:{lat:e,lng:t},mapPaneName:this._getMapPaneName(),getPixelPositionOffset:this._getPixelPositionOffset,children:(0,p.jsx)(f.default.Provider,{value:this.context,children:(0,p.jsxs)("div",{className:(0,i.default)(c.default.container,{[c.default.selected]:d}),onClick:n,children:[a,(0,p.jsx)("div",{className:(0,i.default)(c.default.glow,{[c.default.stale]:h,[c.default.expired]:!this.props.marker.isLive}),style:{height:r.AVATAR_SIZE,width:r.AVATAR_SIZE,padding:r.GLOW_SIZE},children:(0,p.jsx)("div",{children:(0,p.jsx)(l.default,{ids:s,size:r.IMAGE_SIZE,border:!0,showCount:!0})})}),(0,p.jsx)("div",{className:(0,i.default)(c.default.pin,{[c.default.selected]:d}),style:{height:r.PIN_SIZE,width:r.PIN_SIZE,marginLeft:(r.MARKER_SIZE-r.PIN_SIZE)/2}})]})})})}}m.contextType=f.default,m.displayName="LiveLocationMarker";var g=(0,h.default)((0,d.default)(m));t.default=g},93233:(e,t,s)=>{"use strict";var a=s(95318),i=s(20862);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,c.jsx)(r.MenuBarItem,{a8nText:"live-location-map-menu",icon:(0,c.jsx)(d.default,{name:"menu"}),title:l.default.t(1227),children:(0,c.jsxs)(n.default,{type:"dropdown_menu",flipOnRTL:!0,dirX:n.DirX.LEFT,dirY:n.DirY.BOTTOM,children:[(0,c.jsx)(o.default,{a8n:"mi-roadmap-view menu-item",action:e.onRoadmapSelected,children:l.default.t(1118)}),(0,c.jsx)(o.default,{a8n:"mi-satellite-view menu-item",action:e.onSatelliteSelected,children:l.default.t(1119)}),(0,c.jsx)(o.default,{a8n:"mi-terrain-view menu-item",action:e.onTerrainSelected,children:l.default.t(1120)}),(0,c.jsx)(o.default,{a8n:"mi-traffic menu-item",action:e.onTrafficToggled,children:e.showTraffic?l.default.t(1121):l.default.t(1122)})]})})};var n=i(s(9492)),o=a(s(47452)),l=a(s(2408)),r=s(47941),d=a(s(2966)),c=s(85893)},34060:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(67294),n=a(s(70521)),o=a(s(34295)),l=a(s(86025)),r=a(s(19257)),d=a(s(67893)),c=a(s(2408)),u=a(s(67493)),h=a(s(95395)),f=s(85893);class p extends i.Component{constructor(...e){super(...e),this.flatListController=new d.default,this.renderListItem=e=>{const{participant:t}=e,s=t.valid?(0,f.jsx)(o.default,{reason:"live-location-time",children:(0,f.jsx)(h.default,{participant:t})}):c.default.t(1144),a=t.valid?()=>this.props.onParticipantSelected(t.contact.id.toString()):null,i=t.isMe?(0,f.jsx)("div",{onClick:this.props.onStopSharing,className:u.default.stopSharingButton,children:c.default.t(1134)}):null;return(0,f.jsx)(n.default,{contact:t.contact,secondary:s,onClick:a,detail:i})}}getListData(){return this.props.participants.map((e=>({itemKey:e.id.toString(),contentKey:e.valid?"valid":"invalid",participant:e})))}render(){const e=this.getListData();return(0,f.jsx)(r.default,{className:u.default.list,flatListControllers:[this.flatListController],children:(0,f.jsx)(l.default,{data:e,renderItem:this.renderListItem,flatListController:this.flatListController,direction:"vertical"})})}}p.displayName="LiveLocationParticipants";var m=p;t.default=m},89369:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(s(94184)),n=s(67294),o=a(s(91952)),l=a(s(91547)),r=a(s(17025)),d=a(s(47452)),c=s(4919),u=s(62238),h=a(s(2408)),f=s(25281),p=a(s(78972)),m=a(s(85753)),g=a(s(2966)),_=a(s(63477)),v=a(s(68062)),C=s(85893);class x extends n.Component{constructor(e){super(e),this.mouseEnter=()=>{this.state.hover||this.setState({hover:!0})},this.mouseLeave=()=>{this.state.hover&&this.setState({hover:!1})},this._handleDirection=()=>{const{lat:e,lng:t}=this.props;(0,c.openExternalLink)((0,f.getDirectionUrl)(e,t))},this.handleMessage=()=>{const{id:e}=this.props;(0,u.findChat)(e).then((e=>{e.active&&o.default.existsDrawerRight((e=>{e&&2===l.default.column&&o.default.closeDrawerRight()})),o.default.openChatFromUnread(e).then((t=>{t&&o.default.focusChatTextInput(e)}))}))},this._handleContextOpen=e=>{const t=e&&e.target;this.setState({contextMenu:{menu:this._getContextMenu(),anchor:t}})},this.handleContextClose=()=>{this.setState({contextMenu:!1})},this.state={hover:!1,contextMenu:!1}}_getContextMenu(){const e=[];return e.push((0,C.jsx)(d.default,{a8n:"get-directions",action:this._handleDirection,children:h.default.t(920)},"direction")),e.push((0,C.jsx)(d.default,{a8n:"send-message",action:this.handleMessage,children:h.default.t(1228)},"message")),e}render(){const{id:e,accuracy:t,isMe:s,markerSize:a}=this.props,n=r.default.assertGet(e),o=(0,C.jsx)("div",{className:m.default.name,children:(0,C.jsx)(p.default,{ellipsify:!0,you:!0,contact:n})}),l=null!=t?(0,C.jsx)("div",{className:m.default.status,children:h.default.t(1109,{accuracy:t,_plural:t})}):null,d=s?null:(0,C.jsx)("div",{onClick:this._handleContextOpen,className:m.default.menuButton,children:(0,C.jsx)(g.default,{name:"down"})}),c=(0,C.jsx)("div",{className:m.default.triangle}),u=!s&&this.state.contextMenu?(0,C.jsx)(_.default,{displayName:"LiveLocationPopupContextMenu",escapable:!0,popable:!0,requestDismiss:this.handleContextClose,children:(0,C.jsx)(v.default,{contextMenu:this.state.contextMenu})}):null;return(0,C.jsxs)("div",{className:(0,i.default)(m.default.container,{[m.default.twoLines]:!!l}),style:{transform:`translateX(calc(-50% + ${a/2}px))`},children:[(0,C.jsxs)("div",{className:m.default.popup,onMouseOver:this.mouseEnter,onMouseEnter:this.mouseEnter,onMouseDown:this.mouseLeave,onMouseUp:this.mouseEnter,onMouseLeave:this.mouseLeave,children:[o,l,d]}),c,u]})}}t.default=x,x.displayName="LiveLocationPopup"},39860:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,o.jsx)("div",{className:e.inactive?i.default.inactive:i.default.offline,onClick:e.onClick,children:(0,o.jsxs)("div",{children:[(0,o.jsx)("div",{className:i.default.circle,children:(0,o.jsx)(n.default,{name:e.svgName})}),(0,o.jsx)("div",{className:i.default.text,children:e.text})]})})};var i=a(s(85529)),n=a(s(2966)),o=s(85893)},95395:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(67294),n=a(s(2408)),o=a(s(50589)),l=s(61192),r=s(33156),d=s(85893);const c=(e,t=!1)=>{let s=e;t&&(s+=59);const a=s%3600;return{hours:Math.floor(s/3600),minutes:Math.floor(a/60)}},u=e=>e.isMe?(e=>{const{hours:t,minutes:s}=c(e,!0);return t>0?s>0?n.default.t(1125,{hours:t,minutes:s}):n.default.t(1124,{hours:t,_plural:t}):n.default.t(1126,{minutes:s,_plural:s})})(e.remainingTime()):(e=>{const{hours:t,minutes:s}=c(e);return t>0?s>0?n.default.t(1138,{hours:t,minutes:s}):n.default.t(1137,{hours:t,_plural:t}):s>0?n.default.t(1140,{minutes:s,_plural:s}):n.default.t(1139)})(e.elapsedTime());var h=({participant:e})=>{const[t,s]=(0,i.useState)((()=>u(e)));(0,l.useListener)(e,e.isMe?"change:expiration":"change:lastUpdated",(e=>s(u(e))));const[a,n]=(0,o.default)((()=>s(u(e))),6e4),[c]=(0,r.useManualTimeout)((()=>{s(u(e)),a()})),{expiration:h,lastUpdated:f}=e;return(0,i.useEffect)((()=>{const t=(e=>e.isMe?e.remainingTime():e.elapsedTime())(e)%60;n(),c(1e3*t)}),[h,f]),(0,d.jsx)("span",{children:t})};t.default=h},20651:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getMetersBetweenLatLngs=function(e,t,i,n){const o=a(i-e),l=a(n-t),r=Math.sin(o/2)*Math.sin(o/2)+Math.cos(a(e))*Math.cos(a(i))*Math.sin(l/2)*Math.sin(l/2),d=2*Math.atan2(Math.sqrt(r),Math.sqrt(1-r));return s*d},t.getMetersPerPixel=function(e,t){return 156543.03392*Math.cos(e*Math.PI/180)*(1/2**t)},t.getLatDiff=function(e){return i(e/s)},t.getLngDiff=function(e,t){const n=s*Math.cos(a(t));return i(e/n)};const s=6371e3;function a(e){return e*(Math.PI/180)}function i(e){return e*(180/Math.PI)}},64827:(e,t,s)=>{"use strict";var a=s(20862),i=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(s(66604)),o=s(67294),l=i(s(69991)),r=i(s(17747)),d=i(s(9042)),c=a(s(55588)),u=s(78615),h=i(s(2408)),f=i(s(59606)),p=s(12735),m=i(s(71681)),g=i(s(76747)),_=i(s(4231)),v=a(s(79475)),C=i(s(99385)),x=i(s(66329)),S=s(15298),y=i(s(2966)),E=s(85893);const j=0,I=1,M=2;class T extends o.Component{constructor(e){super(e),this.selectedLabels=new x.default([],(e=>e.id)),this._changeSet=new Set,this.handleMultiSelect=e=>{e&&(this._initialLabelState[e]===M?this._changeSet.add("{labelId}_changed"):this._changeSet.has(e)?this._changeSet.delete(e):this._changeSet.add(e),this.forceUpdate())},this._constructLabelCountMap=()=>{const e={},{modelsToUpdate:t}=this.props;return t.forEach((t=>{const s=(0,S.unproxy)(t);s.labels&&s.labels.forEach((t=>{e[t]=e[t]?++e[t]:1}))})),e},this._handleUpdateLabelsOK=()=>{(0,p.logLabelOperationEvent)(_.default.LABEL_OPERATIONS.CLICK_POSITIVE,this.props.modelsToUpdate.length,_.default.LABEL_TARGETS.LABEL_COMBINED_DIALOG);const e=this.selectedLabels.list,t=this.selectedLabels.selected,s=e.map(((e,s)=>({id:e.id,type:t[s]?"add":"remove"})));f.default.addOrRemoveLabels(s,this.props.modelsToUpdate),this.props.onLabelUpdateComplete&&this.props.onLabelUpdateComplete()};const{modelsToUpdate:t}=this.props,s=this._constructLabelCountMap();this._initialLabelState=(0,n.default)(s,(e=>e===t.length?I:e>0?M:j))}render(){const e=(0,E.jsx)(l.default,{a8nText:"popup-controls-ok",type:"primary",disabled:0===this._changeSet.size,onClick:this._handleUpdateLabelsOK,children:h.default.t(1564)},1),t=(0,E.jsx)(l.default,{a8nText:"popup-controls-cancel",type:"secondary",onClick:this.props.onCancel,children:h.default.t(1912)},0),s=(0,u.canEditLabel)()&&(0,E.jsx)("div",{className:g.default.newLabelBtn,children:(0,E.jsxs)(l.default,{a8nText:"popup-controls-cancel",type:"simplified",onClick:this.props.onAddNewLabel,children:[(0,E.jsx)(y.default,{name:"plus-large",className:g.default.plus,display:"inline"}),h.default.t(241)]},2)});return(0,E.jsx)(v.default,{type:v.ModalTheme.Tower,children:(0,E.jsxs)(r.default,{theme:"labels",children:[(0,E.jsx)(c.default,{title:h.default.t(1093),type:c.DRAWER_HEADER_TYPE.POPUP,onCancel:this.props.onCancel}),(0,E.jsx)(d.default,{"data-list-scroll-container":!0,theme:"padding",children:(0,E.jsx)(C.default,{shouldScrollIntoViewAndSelect:this.props.shouldScrollIntoViewAndSelect,initialLabelState:this._initialLabelState,selectedLabels:this.selectedLabels,renderContext:"label-selection",onLabelClick:this.props.onLabelClick,onMultiSelect:this.handleMultiSelect})}),s,(0,E.jsxs)("div",{className:g.default.actionBtns,children:[t,e]})]},"mange_label_modal")})}}T.displayName="ManageLabelModal";var b=(0,m.default)(T);t.default=b},64170:(e,t,s)=>{"use strict";var a=s(20862),i=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=s(67294),o=i(s(92508)),l=i(s(17747)),r=i(s(9042)),d=a(s(55588)),c=i(s(2408)),u=s(85893);var h=(0,n.forwardRef)(((e,t)=>(0,u.jsxs)(l.default,{ref:t,children:[(0,u.jsx)(d.default,{a8n:"drawer-title-auto-download",title:c.default.t(277),onBack:e.onClose,type:d.DRAWER_HEADER_TYPE.LARGE}),(0,u.jsx)(r.default,{children:(0,u.jsx)(o.default,{},"auto-download")})]})));t.default=h},91142:(e,t,s)=>{"use strict";var a=s(20862),i=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(s(51463)),o=s(67294),l=i(s(76610)),r=i(s(91952)),d=s(48492),c=i(s(17747)),u=i(s(92787)),h=i(s(9042)),f=a(s(55588)),p=i(s(25061)),m=i(s(61136)),g=i(s(57597)),_=s(86723),v=s(20572),C=i(s(12950)),x=s(31140),S=i(s(2408)),y=s(21134),E=i(s(4448)),j=i(s(45605)),I=i(s(76870)),M=i(s(3132)),T=i(s(2966)),b=s(97504),P=i(s(29458)),L=i(s(82669)),w=s(85893);class D extends o.Component{constructor(e){var t,s;let a;if(super(e),this.handleImageSet=(e,t)=>{this.setState({thumb:e,full:t})},this.handleContinue=()=>{const e=(0,m.default)(this.state.text.trim());(0,d.createGroup)(e,this.state.thumb,this.state.full,this.props.participants,this.state.ephemeralDuration,this.state.dogfoodingGroupsInternalOnly),this.props.onContinue()},this.handleSubjectChange=e=>{this.setState({text:e})},this.setRefEmojiInput=e=>{this.refEmojiInput=e},this._handleDogfoodingGroupChange=()=>{const e=!this.state.dogfoodingGroupsInternalOnly;this.setState({dogfoodingGroupsInternalOnly:e})},this._handleEphemeralDurationChange=e=>{this.setState({ephemeralDuration:e})},this._onEphemeralDurationClick=()=>{r.default.openModal((0,w.jsx)(g.default,{initialDuration:this.state.ephemeralDuration,onDurationSelected:this._handleEphemeralDurationChange}))},this._renderEphemeralDurationBlock=()=>{if(!C.default.supportsFeature(C.default.F.DISAPPEARING_MODE))return null;const{ephemeralDuration:e}=this.state;let t;t=e>0?(0,y.isEphemeral24HDurationEnabled)()?(0,x.getDisappearingMessageDurationString)(e):S.default.t(871):S.default.t(870);const s=(0,w.jsx)(T.default,{className:E.default.chevronIcon,name:"chevron-right-alt",directional:!0});return(0,w.jsx)(p.default,{children:(0,w.jsxs)(u.default,{onClick:this._onEphemeralDurationClick,side:s,multiline:!0,children:[(0,w.jsx)("div",{className:E.default.header,children:(0,w.jsx)(b.TextHeader,{level:"3",theme:"title",children:S.default.t(992)})}),(0,w.jsx)(b.TextParagraph,{theme:"muted",children:t})]})})},C.default.supportsFeature(C.default.F.DISAPPEARING_MODE)){const e=(0,_.getMaybeMeUser)();e&&(a=(0,v.getDisappearingModeSettingForUser)(e))}this.state={text:e.subject||"",thumb:e.thumb,full:e.full,dogfoodingGroupsInternalOnly:!1,ephemeralDuration:null!==(t=null===(s=a)||void 0===s?void 0:s.duration)&&void 0!==t?t:0}}componentDidMount(){this.refEmojiInput&&this.refEmojiInput.restoreFocus()}render(){const e=this.state.text.trim().length>0,t=e?(0,w.jsx)("div",{className:E.default.nextButton,children:(0,w.jsx)(M.default,{a8nText:"create-group-btn",onClick:(0,n.default)(this.handleContinue),children:(0,w.jsx)(T.default,{name:"checkmark-medium"})})}):null;return(0,w.jsxs)(c.default,{children:[(0,w.jsx)(f.default,{title:S.default.t(1370),type:f.DRAWER_HEADER_TYPE.LARGE,onBack:this.props.onBack}),(0,w.jsxs)(h.default,{children:[(0,w.jsxs)(p.default,{children:[(0,w.jsx)("div",{className:E.default.section,children:(0,w.jsx)(j.default,{type:I.default.GROUP,attachToChat:!1,startImage:this.state.full,onImageSet:this.handleImageSet})}),(0,w.jsx)("div",{"data-a8n":l.default.key("group-subject"),className:E.default.section,children:(0,w.jsx)(P.default,{ref:this.setRefEmojiInput,value:this.state.text,maxLength:25,showRemaining:!0,onChange:this.handleSubjectChange,placeholder:S.default.t(1002),onEnter:e?(0,n.default)(this.handleContinue):()=>{},supportsEmoji:!0})}),null]}),this._renderEphemeralDurationBlock(),(0,w.jsx)(L.default,{transitionName:"btn",children:t})]})]})}}t.default=D,D.displayName="NewGroupDrawer"},63982:(e,t,s)=>{"use strict";var a=s(20862),i=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(s(63105)),o=i(s(41609)),l=i(s(91966)),r=i(s(94184)),d=s(55084),c=s(67294),u=i(s(76610)),h=s(38512),f=i(s(91952)),p=i(s(75940)),m=i(s(17025)),g=i(s(13531)),_=i(s(17747)),v=i(s(9042)),C=a(s(55588)),x=s(92231),S=a(s(13540)),y=i(s(19257)),E=i(s(67893)),j=i(s(40854)),I=i(s(47193)),M=i(s(39e3)),T=i(s(2408)),b=i(s(95575)),P=i(s(70422)),L=i(s(4337)),w=i(s(40630)),D=i(s(3132)),O=s(20845),N=i(s(65565)),R=i(s(46714)),k=i(s(2966)),A=a(s(49201)),F=i(s(82669)),B=s(85893);const U=(0,A.genId)("max_participant_toast");class G extends c.Component{constructor(...e){super(...e),this.state={searchText:"",participants:this.props.participants,shouldFocus:!0,isBusy:!1},this.flatListController=new E.default,this.setRefParticipantList=e=>{this.refParticipantList=e},this.setRefList=e=>{this.refList=e},this.handleKeyDown=e=>{if("Backspace"===e.key&&!this.state.searchText&&!(0,o.default)(this.state.participants)){e.preventDefault();const t=this.state.participants;this.setState({participants:t.slice(0,t.length-1),shouldFocus:!0})}},this.handleInput=e=>{this.setState({searchText:e.target.value})},this.handleReset=()=>{this.setState({searchText:"",shouldFocus:!0})},this.focus=()=>{I.default.focus(this.refInput)},this.handleBack=()=>{this.props.onBack()},this.handleContinue=()=>{this.props.onContinue(this.state.participants)},this.handleDelete=(e,t)=>{const s=(0,n.default)(this.state.participants,(e=>!e.id.equals(t.id)));this.setState({participants:s,shouldFocus:!s.length})},this.handleContactClick=(e,t)=>{this.state.participants.find((e=>e.id.equals(t.id)))?this._removeContact(t):t.isBlocked()?f.default.openModal((0,B.jsx)(p.default,{title:T.default.t(232),onOK:()=>{this._unblockAndAddContact(t),f.default.closeModal()},onCancel:()=>f.default.closeModal(),okText:T.default.t(2222),cancelText:T.default.t(2082),children:T.default.t(230)})):this.addContact(t)},this.handleFocusList=e=>{this.refList&&(e.preventDefault(),e.stopPropagation(),j.default.shouldIndicateFocus(),this.refList&&this.refList.focusFirst())},this._handleFocusParticipants=e=>{e.repeat||this.refInput&&0!==this.refInput.selectionStart||this.refParticipantList&&(e.preventDefault(),e.stopPropagation(),M.default.flashFocus=0,this.refParticipantList&&this.refParticipantList.focusLast())},this.handleSelectFirst=e=>{e.preventDefault(),e.stopPropagation();const t=this.getFilteredContacts()[0];t&&this.handleContactClick(e,t)},this.handleFocusSearch=()=>{j.default.shouldIndicateFocus(),I.default.focus(this.refInput)},this.setRefInput=e=>{this.refInput=e},this._setRefSizer=e=>{this._refSizer=e}}componentDidMount(){this.focus()}componentDidUpdate(){this._adjustInput()}getFilteredContacts(){const e=(0,l.default)(m.default.getFilteredContacts(),this.state.participants);let t=this.state.searchText;if(!t)return e;t=T.default.accentFold(t);const s=(0,P.default)(t);return e.filter((e=>e.searchMatch(t,s)))}_adjustInput(){if(this.refInput){const e=this.refInput.offsetParent.offsetWidth-10,t=this._refSizer.offsetWidth,s=t>e?e:t;let a;this.refInput.style.width=s+"px",a=e-this.refInput.offsetLeft-s>0?e-this.refInput.offsetLeft:e,this.refInput.style.width=a+"px",this.state.shouldFocus&&this.focus()}}addContact(e){const t=this.state.participants;if(t.length>=N.default.maxParticipants){const e=T.default.t(121,{max:N.default.maxParticipants});f.default.openToast((0,B.jsx)(A.default,{msg:e,id:U}))}else this.setState({participants:t.concat(e),searchText:"",shouldFocus:!0})}_removeContact(e){const t=this.state.participants;this.setState({participants:(0,n.default)(t,(t=>!e.id.equals(t.id))),shouldFocus:!0})}_unblockAndAddContact(e){this.setState({isBusy:!0}),(0,h.unblockContact)(e).checkpoint(this.props.rejectOnUnmount()).then((()=>{this.addContact(e),this.setState({isBusy:!1})})).catch((0,d.filteredCatch)(S.Unmount,(()=>{}))).catch((()=>{this.setState({isBusy:!1})}))}render(){let e;this.state.isBusy?e=(0,B.jsx)("div",{className:b.default.spinner,children:(0,B.jsx)(R.default,{stroke:6,size:24})}):this.state.participants&&this.state.participants.length&&(e=(0,B.jsx)(D.default,{a8nText:"group-participants-btn",onClick:this.handleContinue,children:(0,B.jsx)(k.default,{name:"arrow-forward",directional:!0})}));const t=this.state.participants&&this.state.participants.length?" ":T.default.t(989),s={down:this.handleFocusList,enter:this.state.searchText?this.handleSelectFirst:this.state.participants&&this.state.participants.length?this.handleContinue:()=>{},up:this._handleFocusParticipants};s[T.default.LR("left","right")]=this._handleFocusParticipants;const a=this.getFilteredContacts();let i;return i=0===a.length?(0,B.jsx)(x.SearchContacts,{}):(0,B.jsx)(g.default,{ref:this.setRefList,flatListController:this.flatListController,contacts:a,onClick:this.handleContactClick,onFocusSearch:this.handleFocusSearch,showPersonGroupDivisionHeader:!1}),(0,B.jsxs)(_.default,{children:[(0,B.jsx)(C.default,{title:T.default.t(239),type:C.DRAWER_HEADER_TYPE.LARGE,onBack:this.handleBack}),(0,B.jsxs)(v.default,{children:[(0,B.jsx)("div",{className:b.default.search,children:(0,B.jsx)("div",{children:(0,B.jsxs)(M.default,{handlers:s,className:b.default.inputLine,children:[(0,B.jsx)("div",{"data-list-scroll-container":!0,children:(0,B.jsx)(L.default,{ref:this.setRefParticipantList,theme:"list-names",contacts:this.state.participants,onDelete:this.handleDelete,onFocusSearch:this.handleFocusSearch})}),(0,B.jsx)("input",{"data-a8n":u.default.key("inputarea"),className:(0,r.default)(b.default.inputarea,O.SELECTABLE_INPUT_CSS_CLASS),ref:this.setRefInput,placeholder:t,onKeyDown:this.handleKeyDown,onChange:this.handleInput,value:this.state.searchText,type:"text"}),(0,B.jsx)("span",{className:b.default.inputareaSizer,ref:this._setRefSizer,children:this.state.searchText})]})})}),(0,B.jsx)(y.default,{className:b.default.contacts,flatListControllers:[this.flatListController],children:i}),(0,B.jsx)(F.default,{transitionName:"btn",className:b.default.drawerSection,children:e})]})]})}}G.defaultProps={participants:[]},G.displayName="NewGroupParticipantsDrawer";var H=(0,w.default)(G);t.default=H},88616:(e,t,s)=>{"use strict";var a=s(20862),i=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=s(67294),o=i(s(58362)),l=i(s(17747)),r=i(s(9042)),d=a(s(55588)),c=i(s(2408)),u=i(s(80959)),h=s(85893);var f=(0,n.forwardRef)(((e,t)=>(0,h.jsxs)(l.default,{ref:t,children:[(0,h.jsx)(d.default,{a8n:"drawer-title-notifications",title:c.default.t(1391),onBack:e.onClose,type:d.DRAWER_HEADER_TYPE.LARGE}),(0,h.jsx)(r.default,{children:(0,h.jsx)(o.default,{mute:u.default.globalMute()},"notifications")})]})));t.default=f},28682:(e,t,s)=>{"use strict";var a=s(20862),i=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(s(81109)),o=s(55084),l=s(67294),r=(i(s(56720)),i(s(76610))),d=i(s(60028)),c=i(s(91952)),u=i(s(75940)),h=i(s(9322)),f=i(s(55454)),p=i(s(77392)),m=i(s(17747)),g=i(s(9042)),_=i(s(79864)),v=a(s(55588)),C=i(s(25061)),x=i(s(80223)),S=i(s(61136)),y=a(s(13540)),E=s(63290),j=s(86723),I=s(78615),M=i(s(52087)),T=i(s(14179)),b=i(s(2408)),P=s(83952),L=i(s(4231)),w=s(70790),D=i(s(65587)),O=i(s(90277)),N=i(s(66915)),R=i(s(8497)),k=i(s(40630)),A=s(20845),F=s(17959),B=i(s(79485)),U=s(650),G=i(s(2966)),H=s(97504),V=i(s(29458)),W=i(s(98532)),z=s(85893);const K={businessComplianceIconWrapper:{paddingEnd:"htg54gjl",color:"s4k44ver"},businessComplianceText:{flexGrow:"ggj6brxn",color:"tviruh8d"},businessComplianceRightAltIcon:{color:"cs9t9or5"}};class Y extends l.Component{constructor(e){super(e),this.handleBack=()=>{this.props.onClose?this.props.onClose():this.props.uim.uie.requestDismiss()},this._validateStatus=e=>!!(e||"").trim(),this._handleStatusBegin=()=>{this._isEditingStatus=!0},this._handleSetStatusError=()=>{c.default.openModal((0,z.jsx)(u.default,{onOK:()=>c.default.closeModal(),okText:b.default.t(2085),children:b.default.t(220)}))},this._handleSetStatus=()=>{if(null==this.state.status)return void this._handleCancelStatus();this._isEditingStatus=!1;const e=this.props.status.status,t=(0,S.default)(this.state.status);if(t===e)return this.setState({status:t});this.setState({pendingStatus:!0}),(0,U.setMyStatus)((0,S.default)(this.state.status)).checkpoint(this.props.rejectOnUnmount()).then((()=>{this.setState({pendingStatus:!1})})).catch((0,o.filteredCatch)(y.Unmount,(()=>{})))},this.handleStatusChange=e=>{this.setState({status:e})},this._handleCancelStatus=()=>{this._isEditingStatus=!1,this.setState({status:this.props.status.status})},this._handlePushnameBegin=()=>{this._isEditingPushname=!0},this._validatePushname=()=>{let e,{pushname:t}=this.state;return t=(t||"").trim(),t?/[\u2714\u2705\u2611]/g.test(t)&&(e=b.default.t(215)):e=b.default.t(212),!e||(this._handleSetPushnameError(e),!1)},this._handleSetPushname=()=>{if(this._isEditingPushname=!1,!h.default.canSetMyPushname())return;let{pushname:e}=this.state;e=(0,S.default)((e||"").trim());if(e===this.props.conn.pushname)return this.setState({pushname:e});this.setState({pendingPushname:!0}),(0,F.setPushname)(e).checkpoint(this.props.rejectOnUnmount()).then((()=>{this.setState({pendingPushname:!1})})).catch((0,o.filteredCatch)(y.Unmount,(()=>{})))},this._handleSetPushnameError=e=>{c.default.openModal((0,z.jsx)(u.default,{onOK:()=>c.default.closeModal(),okText:b.default.t(2085),children:e}))},this._handlePushnameChange=e=>{this.setState({pushname:e})},this._handleCancelPushname=()=>{this._isEditingPushname=!1,this.setState({pushname:this.props.conn.pushname})},this.state={pushname:e.conn.pushname,status:e.status.status,pendingPushname:!1,pendingStatus:!1,catalog:null}}componentDidMount(){if(!h.default.isSMB)return;d.default.findCarouselCatalog((0,j.getMeUser)()).then((e=>{const t=Array.isArray(e)?e[0]:e;this.setState({catalog:t})})).catch((()=>{}));const{session:e}=(0,w.getProductCatalogContext)(this.context);e.isAccidental()&&c.default.setDrawerContext("left",(0,w.buildProductCatalogContext)(new O.default,L.default.BIZ_PLATFORM.SMB,L.default.CATALOG_ENTRY_POINT.CATALOG_ENTRY_POINT_SETTINGS))}renderProductCatalogSection(){const{session:e}=(0,w.getProductCatalogContext)(this.context);return e.isAccidental()?null:(0,z.jsx)(D.default,{businessProfile:this.props.contact.businessProfile,catalog:this.state.catalog})}renderMerchantDetailsFormSection(){return(0,z.jsx)(C.default,{title:(0,z.jsxs)(E.FlexRow,{align:"center",children:[(0,z.jsx)(E.FlexItem,{xstyle:K.businessComplianceIconWrapper,children:(0,z.jsx)(G.default,{name:"business"})}),(0,z.jsx)(E.FlexItem,{xstyle:K.businessComplianceText,children:b.default.t(394)}),(0,z.jsx)(E.FlexItem,{children:(0,z.jsx)(G.default,{xstyle:K.businessComplianceRightAltIcon,name:"chevron-right-alt",directional:!0})})]}),theme:"refresh-padding-title",titleOnClick:P.openMerchantDetailsFormFlow})}_renderAboutInput(){const{status:e}=this.props,t=this._isEditingStatus||this.state.pendingStatus?this.state.status:e.status;return(0,z.jsx)(V.default,{a8n:"col-main-profile-input",value:t,editable:!0,pending:this.state.pendingStatus,showRemaining:!0,validate:this._validateStatus,maxLength:f.default.MAX_STATUS_LENGTH,onBeginEdit:this._handleStatusBegin,onChange:this.handleStatusChange,onSave:this._handleSetStatus,onError:this._handleSetStatusError,onCancel:this._handleCancelStatus,theme:"text-input",fieldName:b.default.t(36),supportsEmoji:!0,lockable:!0,lowProfile:!0})}_renderStandardEditSection(){const{conn:e}=this.props,t=this._isEditingPushname||this.state.pendingPushname?this.state.pushname:e.pushname,s=h.default.isSMB?b.default.t(434):b.default.t(1512),a=(0,z.jsx)(C.default,{a8nText:"col-main-profile",title:b.default.t(2165),theme:"padding",children:this._renderAboutInput()});return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(C.default,{a8nText:"col-main-profile",title:b.default.t(1511),theme:"padding",children:(0,z.jsx)(V.default,{a8n:"col-main-profile-input",value:t,editable:h.default.canSetMyPushname(),pending:this.state.pendingPushname,showRemaining:!0,validate:this._validatePushname,maxLength:f.default.MAX_PUSHNAME_LENGTH,onBeginEdit:this._handlePushnameBegin,onChange:this._handlePushnameChange,onSave:this._handleSetPushname,onCancel:this._handleCancelPushname,supportsEmoji:!0,lockable:!0,lowProfile:!0})}),(0,z.jsx)("div",{"data-a8n":r.default.key("pushname-description"),className:N.default.nameWrapper,children:(0,z.jsx)(H.TextSpan,{theme:"muted",children:s})}),a]})}_renderSection(e){return(0,z.jsx)(T.default,(0,n.default)({},e))}_renderAboutSection(){const e=this._renderSection({icon:"info",content:this._renderAboutInput()}),t=this._renderSection({icon:"call-phone",iconClass:N.default.phoneIcon,content:(0,z.jsxs)("div",{children:[(0,z.jsx)(A.SelectableDiv,{className:N.default.phoneField,selectable:!0,children:(0,W.default)((0,j.assertGetMe)())}),(0,z.jsx)("div",{className:N.default.infoText,children:b.default.t(454)})]})});return(0,z.jsxs)(C.default,{title:b.default.t(444),theme:"refresh",children:[e,t]})}_renderEditBizProfileEditSection(){return(0,z.jsxs)("div",{children:[(0,z.jsx)(x.default,{}),(0,I.canSeeECommerceComplianceIndiaBusinessJourney)(this.props.contact.id.user)&&this.renderMerchantDetailsFormSection(),this.renderProductCatalogSection(),this._renderAboutSection()]})}_renderCoverPhoto(){return(0,z.jsx)(C.default,{theme:"padding-no-margin",children:(0,z.jsx)(p.default,{contact:this.props.contact,editable:!0,profilePicThumb:this.props.profilePicThumb,hideStatusV3:!0})})}_renderProfilePicture(){return(0,z.jsx)("div",{className:N.default.photoPickerWrapper,children:(0,z.jsx)(R.default,{profilePicThumb:this.props.profilePicThumb})})}render(){const e=(0,I.canSeeBizProfileV3)()&&h.default.isSMB?this._renderCoverPhoto():this._renderProfilePicture(),t=h.default.isSMB?this._renderEditBizProfileEditSection():this._renderStandardEditSection(),s=b.default.t(1219);return(0,z.jsxs)(m.default,{children:[(0,z.jsx)(v.default,{a8n:"drawer-title-profile",title:s,onBack:this.handleBack,type:v.DRAWER_HEADER_TYPE.LARGE}),(0,z.jsxs)(g.default,{children:[e,t]})]})}}Y.contextType=_.default,Y.CONCERNS={contact:["businessProfile","id","statusMute"],profilePicThumb:["imgFull","id"],status:["status"],conn:["pushname"]},Y.displayName="ProfileDrawer";var q=(0,M.default)((0,k.default)((0,B.default)(Y,Y.CONCERNS)));t.default=q},28981:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,o.jsx)(i.default,{primary:e.choiceText,onClick:e.onChoose,theme:"radio-button-row",image:(0,o.jsx)(n.default,{checked:e.isChosen,hover:!1,radio:!0,onChange:e.onChoose,systemUncheckedColor:!0})})};var i=a(s(55092)),n=a(s(88540)),o=s(85893)},7883:(e,t,s)=>{"use strict";var a=s(20862),i=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=s(67294),o=i(s(33287)),l=i(s(17747)),r=i(s(9042)),d=a(s(55588)),c=i(s(25061)),u=i(s(4919)),h=s(57092),f=s(63290),p=s(86723),m=i(s(2408)),g=i(s(4662)),_=i(s(65565)),v=s(62701),C=i(s(2966)),x=s(97504),S=s(85893);class y extends n.PureComponent{constructor(e){super(e),this._onSecurityNotificationChange=()=>{const e=!this.state.securityNotificationEnabled;(0,p.setGlobalSecurityNotifications)(e),this.setState({securityNotificationEnabled:e})},this.state={securityNotificationEnabled:(0,p.getGlobalSecurityNotifications)()}}render(){const e=_.default.bspSystemMessageEnabled;return(0,S.jsxs)(l.default,{children:[(0,S.jsx)(d.default,{a8n:"drawer-title-security",title:m.default.t(1594),onBack:this.props.onClose,type:d.DRAWER_HEADER_TYPE.LARGE}),(0,S.jsx)(r.default,{children:(0,S.jsxs)(c.default,{theme:"padding-large",animation:!1,children:[(0,S.jsxs)(f.FlexColumn,{className:g.default.icon,align:"center",justify:"center",children:[(0,S.jsx)(f.FlexItem,{children:(0,S.jsx)(C.default,{name:"security-shield"})}),(0,S.jsx)(f.FlexColumn,{className:g.default.iconLock,align:"center",justify:"center",children:(0,S.jsx)(f.FlexItem,{children:(0,S.jsx)(C.default,{name:"security-lock"})})})]}),(0,S.jsxs)("div",{className:g.default.text,children:[e?m.default.t(1593):m.default.t(1592)," ",(0,S.jsx)(u.default,{href:(0,v.securityUrl)(),children:m.default.t(1103)})]}),(0,S.jsxs)(f.FlexRow,{className:g.default.controls,children:[(0,S.jsx)("div",{className:g.default.checkbox,children:(0,S.jsx)(o.default,{onChange:this._onSecurityNotificationChange,checked:this.state.securityNotificationEnabled})}),(0,S.jsxs)(f.FlexItem,{children:[(0,S.jsx)("div",{className:g.default.header,children:(0,S.jsx)(x.TextSpan,{theme:"title",children:m.default.t(1591)})}),(0,S.jsxs)(x.TextDiv,{theme:"muted",children:[e?m.default.t(1589):m.default.t(1588)," ",(0,S.jsx)(u.default,{href:(0,h.getCodeChangeFaqUrl)(),children:m.default.t(1103)})]})]})]})]})})]})}}t.default=y,y.displayName="SecurityDrawer"},84653:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{onOK:t}=e,s=e.name||l.default.t(711),a=l.default.t(1625,{name:s});return(0,r.jsx)(n.default,{onOK:()=>{i.default.closeModal(),t()},okText:l.default.t(2085),children:(0,r.jsx)("div",{children:(0,r.jsx)(o.default,{text:a})})})};var i=a(s(91952)),n=a(s(75940)),o=a(s(85051)),l=a(s(2408)),r=s(85893)},31051:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,r.jsx)("div",{className:l.default.container,children:e.children})},t.SettingsCheckListSection=d,t.SettingsCheckListItem=function(e){return(0,r.jsxs)(d,{disabled:e.disabled,children:[(0,r.jsx)("div",{"data-a8n":n.default.key(e.a8nText),className:l.default.control,children:(0,r.jsx)(o.default,{id:e.id,onChange:e.onChange,checked:e.checked,disabled:e.disabled})}),(0,r.jsx)("label",{className:l.default.label,htmlFor:e.id,children:e.children})]})};var i=a(s(94184)),n=a(s(76610)),o=a(s(33287)),l=a(s(96601)),r=s(85893);function d(e){return(0,r.jsx)("div",{className:(0,i.default)(l.default.section,{[l.default.disabled]:e.disabled}),children:e.children})}},24148:(e,t,s)=>{"use strict";var a=s(20862),i=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=s(67294),o=i(s(55092)),l=i(s(9322)),r=a(s(88419)),d=i(s(17747)),c=i(s(9042)),u=i(s(17061)),h=a(s(55588)),f=i(s(85051)),p=s(86723),m=i(s(12950)),g=s(78615),_=i(s(2408)),v=i(s(77898)),C=i(s(2966)),x=i(s(76006)),S=s(85893);function y(e,t){const s=(0,x.default)(e.settings,["archive"]),a=(0,S.jsx)(v.default,{id:e.profileId}),i=(0,S.jsx)(r.default,{id:(0,p.getMaybeMeUser)(),size:82,quality:r.DETAIL_IMAGE_QUALITY.HIGH}),n=(0,S.jsx)(f.default,{text:l.default.pushname,ellipsify:!0,titlify:!0});let y,E,j,I;return!m.default.supportsFeature(m.default.F.MD_BACKEND)&&(0,g.archiveV2Supported)()&&s.archive.enabled&&(j=(0,S.jsx)(u.default,{icon:(0,S.jsx)(C.default,{name:"archived"}),onClick:e.onArchiveSettings,children:_.default.t(255)})),m.default.supportsFeature(m.default.F.MD_BACKEND)&&(E=(0,S.jsx)(u.default,{a8nText:"li-security",icon:(0,S.jsx)(C.default,{name:"settings-security"}),onClick:e.onSecurity,children:_.default.t(1221)})),(0,g.webMediaAutoDownloadEnabled)()&&(I=(0,S.jsx)(u.default,{a8nText:"li-media-auto-download",icon:(0,S.jsx)(C.default,{name:"media-download"}),onClick:e.onMediaAutoDownload,children:_.default.t(1216)})),y=(0,S.jsx)(u.default,{a8nText:"li-keyboard-shortcuts",icon:(0,S.jsx)(C.default,{name:"settings-keyboard"}),onClick:e.onKeyboardShortcuts,children:_.default.t(1087)}),(0,S.jsxs)(d.default,{ref:t,theme:"settings",children:[(0,S.jsx)(h.default,{title:_.default.t(1629),onBack:e.onClose,type:h.DRAWER_HEADER_TYPE.LARGE}),(0,S.jsxs)(c.default,{children:[(0,S.jsx)(o.default,{onClick:e.onProfile,image:i,primary:n,theme:"identity",secondary:a}),(0,S.jsx)(u.default,{a8nText:"li-notifications",icon:(0,S.jsx)(C.default,{name:"settings-notifications"}),onClick:e.onNotifications,children:_.default.t(1217)}),E,(0,S.jsx)(u.default,{icon:(0,S.jsx)(C.default,{name:"settings-theme"}),onClick:e.onThemeSettings,children:_.default.t(1224)}),(0,S.jsx)(u.default,{icon:(0,S.jsx)(C.default,{name:"settings-wallpaper"}),onClick:e.onWallpaper,children:_.default.t(1225)}),j,(0,S.jsx)(u.default,{a8nText:"li-blocked",icon:(0,S.jsx)(C.default,{name:"settings-blocked"}),onClick:e.onBlocked,children:_.default.t(1210)}),I,undefined,y,(0,S.jsx)(u.default,{a8nText:"li-help",icon:(0,S.jsx)(C.default,{name:"settings-help"}),onClick:e.onHelp,children:_.default.t(1212)}),undefined,undefined,undefined,undefined,undefined]})]})}var E=(0,n.forwardRef)(y);t.default=E},72403:(e,t,s)=>{"use strict";var a=s(20862),i=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(s(23493)),o=s(55084),l=s(67294),r=s(58380),d=i(s(25142)),c=i(s(91952)),u=i(s(55454)),h=i(s(52384)),f=i(s(17747)),p=i(s(9042)),m=a(s(55588)),g=s(92231),_=a(s(13540)),v=i(s(47193)),C=s(86723),x=i(s(12950)),S=i(s(52087)),y=i(s(39e3)),E=i(s(2408)),j=i(s(71681)),I=s(47941),M=i(s(40630)),T=i(s(42321)),b=i(s(16967)),P=i(s(46714)),L=i(s(96363)),w=i(s(94602)),D=i(s(14784)),O=i(s(2966)),N=i(s(82669)),R=s(85893);class k extends l.Component{constructor(e){super(e),this._msgRefs={},this._setRefHotKeys=e=>{this._refHotKeys=e},this._refScrollContainer=(0,l.createRef)(),this._getInitialState=()=>{const{starredMsgs:e}=this.props;return{cursor:T.default.create({msgCollection:e,type:u.default.RENDER_CURSOR.STARRED_DRAWER}).loadAfter(e,{count:u.default.MSG_PRELOAD_THRESHOLD})}},this._handleStarChange=()=>{this._initSelectionObjects(),this.forceUpdate()},this._initSelectionObjects=()=>{const e=this.props.starredMsgs.toArray();this._currSelection.init(e,!0),this._activeSelection.init(e)},this.setRefMsgComponent=(e,t)=>{t?this._msgRefs[e.id.toString()]=t:delete this._msgRefs[e.id.toString()]},this.loadEarlierMsgs=()=>{const e=this.state.cursor,t=this.props.chat&&this.props.chat.id,{starredMsgs:s}=this.props,a=s.models;if(e.getEnd(s)<a.length)this.setState({cursor:e.loadAfter(s)});else{if(s.isSynced)return;this.props.starredMsgs.sync(t).checkpoint(this.props.rejectOnUnmount()).then((()=>{e.hasAfter(s)&&this.setState({cursor:e.loadAfter(s)})})).catch((0,o.filteredCatch)(_.Unmount,(()=>{}))).catch((e=>{__LOG__(2)`StarredDrawer:loadEarlierMsgs failed\n${e}`}))}},this.handleClose=()=>{this.props.onClose?this.props.onClose():this.props.uim.uie.requestDismiss()},this.focus=()=>{this._refHotKeys&&v.default.focus(this._refHotKeys)},this.handleFocusGain=e=>{if(!this._refHotKeys)return;(e?e.target:document.activeElement)===this._refHotKeys&&(this._currSelection.index<0?this._currSelection.setFirst(!0):this._currSelection.reset(!1))},this._handleNextMsg=e=>{e&&(e.preventDefault(),e.stopPropagation());const t=this._currSelection.next();this._currSelection.index!==t&&this._currSelection.setNext(!0)},this._handlePrevMsg=e=>{e&&(e.stopPropagation(),e.preventDefault());this._currSelection.prev()>-1&&this._currSelection.setPrev(!0)},this.onScroll=e=>{this.handleScroll(e.currentTarget)},this._handleScroll=e=>{this.updateMsgListInfo(),function(e){return e.scrollTop+u.default.SCROLL_FUDGE>e.scrollHeight-e.clientHeight}(e)&&this.loadEarlierMsgs()},this._selectMsg=e=>{this._currSelection.setVal(e),this._activeSelection.setVal(e),c.default.openChatAt(e.chat,e.chat.getSearchContext(e)),c.default.focusShowMsg(e.id)},this._getMsgList=()=>{const e=this.state.cursor,{starredMsgs:t}=this.props;let s=t.toArray();const a=t.isSynced?e.getEnd(t):Math.min(e.getEnd(t),s.length);return s=s.slice(e.getStart(t),a),this.length=s.length,s},this.getMsgVisibility=e=>{if(!e)return u.default.VISIBILITY.BELOW;const t=this._refScrollContainer.current;if(!t)return;const s=t.previousSibling;if(!(s&&s instanceof HTMLElement))return;const a=s.clientHeight,i=t.scrollTop+a,n=i+t.clientHeight,o=e.getContainerElement();return o?o.offsetTop+o.clientHeight<=i?u.default.VISIBILITY.ABOVE:o.offsetTop>=n?u.default.VISIBILITY.BELOW:u.default.VISIBILITY.VISIBLE:u.default.VISIBILITY.BELOW},this.isMsgVisible=(e,t=!1)=>!!this._msgListInfo.visibleMsgs[e.toString()]&&(!!t||this.getMsgComponent(e)),this.getMsgComponent=e=>{const t=this._msgRefs[e.toString()];if(!t)return;const s=t.getWrapperRef();return s&&"function"==typeof s.getMsgComponentRef?s.getMsgComponentRef():void 0},this._updateMsgListInfo=()=>{const e=this._getMsgList(),t={};let s=0,a=this.length-1;for(;s<a;){const t=Math.floor((s+a)/2),i=this._msgRefs[e[t].id.toString()];this.getMsgVisibility(i)===u.default.VISIBILITY.ABOVE?s=t+1:a=t}for(let a=s;a<e.length;a++){const s=this._msgRefs[e[a].id.toString()];if(this.getMsgVisibility(s)!==u.default.VISIBILITY.VISIBLE)break;t[e[a].id.toString()]=!0}this.pauseHiddenGifs(this._msgListInfo.visibleMsgs,t),this._msgListInfo.visibleMsgs=t},this.pauseHiddenGifs=(e,t)=>{for(const s in e)if(!t[s]){const e=this.props.starredMsgs.get(s);if(e&&e.isGif){const e=this.getMsgComponent(s);e&&e.getPlayCount()&&e.pause()}}},this.handleScroll=(0,n.default)(this._handleScroll,100),this.updateMsgListInfo=(0,n.default)(this._updateMsgListInfo,100),this._msgListInfo={visibleMsgs:{}},this.state=this._getInitialState(),this._currSelection=new b.default([],(e=>e.id.toString())),this._activeSelection=new b.default([],(e=>e.id.toString())),this._initSelectionObjects()}componentDidMount(){this.focus(),this.props.listeners.add(window,"resize",this.updateMsgListInfo),!this.props.starredMsgs.isSynced&&this.props.starredMsgs.length<u.default.PAGE_SIZE&&this.props.listeners.uiIdle(this.loadEarlierMsgs),this.props.listeners.add(this.props.starredMsgs,"reset sync",(()=>{this._initSelectionObjects(),this.forceUpdate()})),this.props.listeners.add(this.props.starredMsgs,"add remove",this._handleStarChange),this.handleFocusGain(),this.props.listeners.add(this.props.starredMsgs,"reset",(()=>{this._msgListInfo={visibleMsgs:{}},this.setState(this._getInitialState()),this.loadEarlierMsgs()}))}componentWillUnmount(){this.handleScroll.cancel(),this.updateMsgListInfo.cancel()}componentDidUpdate(){this.updateMsgListInfo()}render(){const e=this._getMsgList(),t=this.state.cursor,{starredMsgs:s}=this.props,a=this.props.chat||null;let i,n;if(n=s.isSynced&&t.getEnd(s)>=e.length?null:this.props.starredMsgs.syncPromise?(0,R.jsx)("div",{className:L.default.more,title:E.default.t(1145),children:(0,R.jsx)(P.default,{stroke:6,size:24})}):(0,R.jsx)("div",{className:L.default.more,children:(0,R.jsx)("div",{title:E.default.t(1142),onClick:this.loadEarlierMsgs,children:(0,R.jsx)(O.default,{name:"refresh"})})}),e.length>0){const t=e.map((e=>{const t=e.type===u.default.MSG_TYPE.IMAGE||e.type===u.default.MSG_TYPE.VIDEO||e.type===u.default.MSG_TYPE.AUDIO;return(0,R.jsx)(D.default,{ref:t=>{this.setRefMsgComponent(e,t)},msg:e,isMsgVisible:t?this.isMsgVisible:()=>{},currSelection:this._currSelection,activeSelection:this._activeSelection,onClickMsg:this._selectMsg},e.id.toString())}));i=(0,R.jsx)(N.default,{transitionName:"slide",children:t})}else this.props.starredMsgs.isSynced?i=(0,R.jsx)(g.StarredMsgs,{}):(i=(0,R.jsx)(g.Loading,{}),n=null);const o={down:this._handleNextMsg,up:this._handlePrevMsg},l=e.length>0?(0,R.jsx)(I.MenuBarItem,{a8nText:"starred-menu",icon:(0,R.jsx)(O.default,{name:"menu"}),title:E.default.t(1227),children:(0,R.jsx)(w.default,{chat:a,msgs:e})}):null;let c;if(x.default.supportsFeature(x.default.F.MD_BACKEND)&&(!a||a&&a.endOfHistoryTransferType===r.ConversationEndOfHistoryTransferModelPropType.COMPLETE_BUT_MORE_MESSAGES_REMAIN_ON_PRIMARY)){const e=d.default.relativeDateStr((0,C.getHistorySyncEarliestDate)());c=(0,R.jsx)(h.default,{icon:(0,R.jsx)(O.default,{name:"content-chat"}),theme:"list",secondary:E.default.t(734,{date:e}),children:E.default.t(732)})}return(0,R.jsx)(f.default,{theme:"gallery",children:(0,R.jsxs)(y.default,{className:L.default.hotKeyWraper,handlers:o,onFocus:this.handleFocusGain,"data-tab":u.default.TAB_ORDERS.CHAT_STARRED_DRAWER,onRef:this._setRefHotKeys,children:[(0,R.jsx)(m.default,{title:E.default.t(1641),onBack:this.handleClose,type:m.DRAWER_HEADER_TYPE.LARGE,menu:l}),(0,R.jsxs)(p.default,{onScroll:this.onScroll,ref:this._refScrollContainer,children:[i,n,c]})]})})}}k.displayName="StarredDrawer";var A=(0,S.default)((0,M.default)((0,j.default)(k)));t.default=A},94602:(e,t,s)=>{"use strict";var a=s(20862),i=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=s(67294),o=i(s(91952)),l=a(s(9492)),r=i(s(47452)),d=i(s(2408)),c=i(s(36798)),u=s(85893);class h extends n.Component{constructor(...e){super(...e),this.sendUnstarAll=()=>{o.default.openModal((0,u.jsx)(c.default,{msgs:this.props.msgs,chat:this.props.chat}))}}getElement(){return this._refDropdown}render(){const{msgs:e}=this.props;return(0,u.jsx)(l.default,{onRef:e=>{this._refDropdown=e},type:"dropdown_menu",flipOnRTL:!0,dirX:l.DirX.LEFT,children:(0,u.jsx)(r.default,{a8n:"mi-unstar-all menu-item",action:this.sendUnstarAll,disabled:0===e.length,children:d.default.t(1718)})},"StarredDrawerHeader")}}t.default=h,h.displayName="StarredHeaderDropdown"},14512:(e,t,s)=>{"use strict";var a=s(20862),i=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(s(7900)),o=s(67294),l=i(s(76610)),r=i(s(25142)),d=i(s(17025)),c=i(s(88419)),u=s(92231),h=a(s(86025)),f=i(s(19257)),p=i(s(67893)),m=s(86723),g=i(s(12950)),_=i(s(2408)),v=i(s(71681)),C=i(s(55922)),x=i(s(83125)),S=i(s(58036)),y=i(s(51130)),E=i(s(2966)),j=s(85893);const I="SEC_UNREAD",M="SEC_READ",T="SEC_MUTED",b="ROW_STATUS";class P extends o.Component{constructor(){super(...arguments),this.flatListController=new p.default,this.handleStatusChange=()=>{const e=this._getUnreadStatusList(),t=this._getReadStatusList(),s=[...e,...t].filter((e=>e.contact.statusMute));this.setState({unreadStatusList:e.filter((e=>!e.contact.statusMute)),readStatusList:t.filter((e=>!e.contact.statusMute)),mutedStatusList:s,myStatus:x.default.getMyStatus()})},this._handleContactMuteChange=()=>{const e=this._getUnreadStatusList(),t=this._getReadStatusList(),s=[...e,...t].filter((e=>e.contact.statusMute));this.setState({unreadStatusList:e.filter((e=>!e.contact.statusMute)),readStatusList:t.filter((e=>!e.contact.statusMute)),mutedStatusList:s,myStatus:x.default.getMyStatus()})},this._toggleMuted=()=>{this.setState((e=>({isMutedExpanded:!e.isMutedExpanded})))},this.renderItem=e=>{switch(e.type){case I:return(0,j.jsxs)("div",{className:S.default.listSectionSep,children:[(0,j.jsx)("hr",{}),(0,j.jsx)("div",{className:S.default.listSectionText,children:(0,j.jsx)("span",{children:_.default.t(1652)})})]});case M:return(0,j.jsxs)("div",{className:S.default.listSectionSep,children:[(0,j.jsx)("hr",{}),(0,j.jsx)("div",{className:S.default.listSectionText,children:(0,j.jsx)("span",{children:_.default.t(1659)})})]});case T:return(0,j.jsxs)("div",{className:S.default.listSectionSep,children:[(0,j.jsx)("hr",{}),(0,j.jsxs)("div",{className:S.default.listSectionText,children:[(0,j.jsx)("span",{children:_.default.t(1648)}),(0,j.jsx)("button",{className:S.default.listSectionAction,onClick:this._toggleMuted,children:e.expanded?_.default.t(1645):_.default.t(1646)})]})]});case b:return(0,j.jsx)(C.default,{statusV3:e.status,onClick:()=>this.props.onOpenStatus(e.status,void 0,e.index),contact:e.status.contact});default:throw new h.UnknownDataError(e)}};const e=this._getUnreadStatusList(),t=this._getReadStatusList(),s=[...e,...t].filter((e=>e.contact.statusMute));this.state={unreadStatusList:e.filter((e=>!e.contact.statusMute)),readStatusList:t.filter((e=>!e.contact.statusMute)),mutedStatusList:s,myStatus:x.default.getMyStatus(),isMutedExpanded:!1}}componentDidMount(){this.props.listeners.add(x.default,"add remove bulk_add sort change:msgsChanged change:hasUnread",this.handleStatusChange),this.props.listeners.add(d.default,"change:statusMute",this._handleContactMuteChange),this.props.listeners.add(x.default,"sync",(()=>{this.forceUpdate()}))}_getUnreadStatusList(){return x.default.getUnexpired(!0)}_getReadStatusList(){return x.default.getUnexpired(!1)}getData(){const{unreadStatusList:e,readStatusList:t,mutedStatusList:s}=this.state,a=[];return e.length>0&&(a.push({type:I,itemKey:"section-unread",height:48}),a.push(...e.map(((e,t)=>({type:b,itemKey:e.id.toString(),height:64,status:e,index:t}))))),t.length>0&&(a.push({type:M,itemKey:"section-read",height:48}),a.push(...t.map(((e,t)=>({type:b,itemKey:e.id.toString(),height:64,status:e,index:t}))))),s.length>0&&(a.push({type:T,itemKey:"section-muted",height:48,expanded:this.state.isMutedExpanded}),this.state.isMutedExpanded&&a.push(...s.map(((e,t)=>({type:b,itemKey:e.id.toString(),height:64,status:e,index:t}))))),a}render(){const e=this.getData();let t;return t=x.default.hasSynced()&&e.length>0?(0,j.jsx)(h.default,{className:"statusList",itemEnterAnimationsEnabled:!0,flatListController:this.flatListController,direction:"vertical",data:e,renderItem:this.renderItem}):(0,j.jsx)(u.ListStatus,{}),(0,j.jsxs)("div",{className:S.default.listPanel,children:[(0,j.jsx)(L,{statusV3:this.state.myStatus,onOpenStatus:this.props.onOpenStatus}),(0,j.jsx)(f.default,{className:S.default.listBody,flatListControllers:[this.flatListController],children:t})]})}}function L(e){let t;const s=e.statusV3;let a,i;s&&(i=s.msgs);const o=()=>{const t=s&&s.msgs;s&&t&&t.length&&e.onOpenStatus(s,t.head(),0)};let d,u,h,f;if(s&&i&&i.length){t=(0,j.jsx)(y.default,{statusV3:s,contact:s.contact,onClick:o});const e=(0,n.default)(i.last(),"myMsgs.last()").t;a=(0,j.jsx)("span",{className:S.default.secondaryHeaderText,children:r.default.relativeDateAndTimeStr(e)}),u={cursor:"pointer"},d=o}else t=(0,j.jsx)(c.default,{id:(0,m.getMaybeMeUser)(),theme:"status_v3",size:40}),a=(0,j.jsx)("span",{"data-a8n":l.default.key("status-no-updates"),className:S.default.secondaryHeaderText,children:_.default.t(1650)});g.default.supportsFeature(g.default.F.STATUS_V3_UI_SENDING)&&(h=(0,j.jsx)(E.default,{name:"menu"}),f=(0,j.jsx)(E.default,{name:"status-v3-create"}));const p=(0,j.jsx)("span",{"data-a8n":l.default.key("my-status"),className:S.default.primaryHeaderText,children:_.default.t(1649)});return(0,j.jsxs)("div",{className:S.default.panelHeader,style:u,onClick:d,children:[(0,j.jsx)("div",{className:S.default.headerButtonsPrimary,children:t}),(0,j.jsxs)("div",{className:S.default.headerText,children:[p,a]}),(0,j.jsxs)("div",{className:S.default.headerButtonsSecondary,children:[f,h]})]})}P.displayName="StatusV3ListPanel";var w=(0,v.default)(P);t.default=w},67315:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(s(94184)),n=s(67294),o=a(s(91952)),l=s(86723),r=a(s(71681)),d=a(s(83125)),c=a(s(14512)),u=a(s(15750)),h=a(s(26515)),f=a(s(2966)),p=s(85893);class m extends n.Component{constructor(e){super(e),this._handleStatusAddRemove=()=>{this.setState({status:d.default.getMyStatus()})},this.state={status:d.default.getMyStatus()}}shouldComponentUpdate(e,t){return t.status!==this.state.status}componentDidMount(){const{sessionId:e,listeners:t}=this.props;(0,l.setLastStatusUsage)(),t.add(d.default,"add remove",this._handleStatusAddRemove),t.add(o.default,"dismiss_status_v3_viewer",(()=>{this.props.closeStatusViewer(!0)})),null!=e&&d.default.logMetrics({type:"session",sessionId:e})}render(){const{onOpenStatus:e}=this.props,t=(0,i.default)(u.default.v3_x,{});return(0,p.jsx)("div",{className:u.default.modalBackground,"data-animate-status-v3-modal-background":!0,children:(0,p.jsxs)("div",{className:u.default.mainWrapper,children:[(0,p.jsx)(c.default,{onOpenStatus:e}),(0,p.jsx)(h.default,{status:this.state.status,onOpenStatus:e}),(0,p.jsx)("button",{className:t,onClick:()=>this.props.closeStatusViewer(!0),children:(0,p.jsx)(f.default,{name:"x-viewer"})})]})})}}m.displayName="StatusV3Main";var g=(0,r.default)(m);t.default=g},26515:(e,t,s)=>{"use strict";var a=s(20862),i=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const t=(0,S.jsx)(E,{statusV3:e.status,onOpenStatus:e.onOpenStatus});let s,a;h.default.supportsFeature(h.default.F.STATUS_V3_UI_SENDING)&&(s=(0,S.jsxs)("div",{className:_.default.updateWrapper,children:[(0,S.jsx)("div",{className:_.default.updateTitle,children:f.default.t(1655)}),(0,S.jsxs)("div",{className:_.default.uploadButtons,children:[(0,S.jsxs)("div",{className:_.default.buttonContainer,children:[(0,S.jsx)(x.default,{name:"status-v3-upload",className:_.default.buttonIcon}),f.default.t(1656)]}),(0,S.jsxs)("div",{className:_.default.buttonContainer,children:[(0,S.jsx)(x.default,{name:"status-v3-camera",className:_.default.buttonIcon}),f.default.t(1644)]})]})]}),a=(0,S.jsx)("hr",{}));return(0,S.jsxs)("div",{className:_.default.outStatusPanel,children:[s,a,t]})};var n=s(55084),o=s(67294),l=i(s(76610)),r=i(s(25142)),d=i(s(88419)),c=s(54647),u=a(s(13540)),h=i(s(12950)),f=i(s(2408)),p=i(s(71681)),m=i(s(57636)),g=i(s(40630)),_=i(s(86020)),v=i(s(50539)),C=i(s(51130)),x=i(s(2966)),S=s(85893);class y extends o.Component{constructor(...e){super(...e),this.rerender=()=>{this.forceUpdate()}}componentDidMount(){const{statusV3:e,listeners:t}=this.props;e&&(t.add(e,"change:msgsChanged",this.rerender),e.loadMore(e.totalCount).catch((e=>{__LOG__(3)`error while loading all out status: ${String(e)}`})))}componentDidUpdate(e){const{listeners:t,statusV3:s}=this.props,{statusV3:a}=e;a!==s&&(a&&t.remove(a,"change:msgsChanged",this.rerender),s&&t.add(s,"change:msgsChanged",this.rerender))}render(){const e=this.props.statusV3;if(e&&e.msgs.length>0){const t=e.msgs.map((t=>(0,S.jsx)(I,{msg:t,status:e,onOpenStatus:this.props.onOpenStatus},t.id.toString())));return(0,S.jsxs)("div",{className:_.default.viewWrapper,children:[(0,S.jsx)("div",{className:_.default.viewTitle,children:f.default.t(1658)}),(0,S.jsx)("div",{className:_.default.viewUpdates,children:t})]})}return(0,S.jsxs)("div",{className:_.default.viewWrapper,children:[(0,S.jsx)("div",{className:_.default.placeholderIcon,children:(0,S.jsx)(x.default,{name:"status-v3-placeholder"})}),(0,S.jsx)("div",{"data-a8n":l.default.key("status-placeholder"),className:_.default.placeholderText,children:f.default.t(1651)})]})}}y.displayName="StatusV3OutViewerImpl";const E=(0,p.default)(y);class j extends o.Component{constructor(){super(...arguments),this.state={}}componentDidMount(){m.default.find(this.props.msg.id).checkpoint(this.props.rejectOnUnmount()).then((e=>{this.props.listeners.add(e.read,"add remove",(()=>{this.setState({seenCount:e.read.length})})),this.setState({seenCount:e.read.length})})).catch((0,n.filteredCatch)(u.Unmount,(()=>{}))).catch((0,n.filteredCatch)(c.EphemeralDrop,(()=>{})))}render(){const{msg:e,status:t}=this.props,s=(0,S.jsx)(d.default,{id:e.sender,theme:"status_v3",size:80});return(0,S.jsxs)("div",{className:_.default.outDetail,children:[(0,S.jsx)(C.default,{statusV3:t,msg:e,onClick:()=>this.props.onOpenStatus(t,e),contact:t.contact,role:"button",theme:"status-panel",thumbnailPlaceholder:s}),(0,S.jsx)("div",{className:_.default.seen,children:(0,S.jsx)(v.default,{seenCount:this.state.seenCount})}),(0,S.jsx)("div",{className:_.default.timestamp,children:r.default.relativeDateAndTimeStr(e.t)})]})}}j.displayName="StatusV3OutDetailImpl";const I=(0,g.default)((0,p.default)(j))},63252:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(67294),n=a(s(91952)),o=a(s(75940)),l=a(s(2408)),r=a(s(25232)),d=a(s(45812)),c=a(s(13038)),u=s(85893);class h extends i.PureComponent{constructor(...e){super(...e),this.state={theme:"system"},this._handleThemeChange=e=>{const t=e.target.value;"light"!==t&&"dark"!==t&&"system"!==t||this.setState({theme:t})},this._handleOk=()=>{const{theme:e}=this.state;"system"===e?(this.context.setSystemThemeMode(!0),this.context.setTheme(d.default.currentTheme)):(this.context.setSystemThemeMode(!1),this.context.setTheme(e)),n.default.closeModal()},this._handleCancel=()=>{n.default.closeModal()}}componentDidMount(){this.setState({theme:this.context.systemThemeMode?"system":this.context.theme})}render(){const{theme:e}=this.state;return(0,u.jsx)(o.default,{title:l.default.t(1698),onOK:this._handleOk,onCancel:this._handleCancel,children:(0,u.jsx)("form",{children:(0,u.jsxs)("ol",{children:[(0,u.jsx)("li",{children:(0,u.jsxs)("label",{className:r.default.label,children:[(0,u.jsx)("input",{type:"radio",name:"theme",value:"light",className:r.default.input,checked:"light"===e,onChange:this._handleThemeChange}),l.default.t(1697)]})},"light"),(0,u.jsx)("li",{children:(0,u.jsxs)("label",{className:r.default.label,children:[(0,u.jsx)("input",{type:"radio",name:"theme",value:"dark",className:r.default.input,checked:"dark"===e,onChange:this._handleThemeChange}),l.default.t(1696)]})},"dark"),(0,u.jsx)("li",{children:(0,u.jsxs)("label",{className:r.default.label,children:[(0,u.jsx)("input",{type:"radio",name:"theme",value:"system",className:r.default.input,checked:"system"===e,onChange:this._handleThemeChange}),l.default.t(1699)]})},"system")]})})})}}t.default=h,h.contextType=c.default,h.displayName="ThemePopup"},36798:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{chat:t,msgs:s}=e;return(0,d.jsx)(o.default,{onOK:()=>{t&&t.pendingAction++,i.default.unstarAllMessages(s,t).finally((()=>{t&&t.pendingAction--})),n.default.closeModal()},okText:r.default.t(1719),onCancel:()=>{n.default.closeModal()},children:(0,d.jsx)("div",{children:(0,d.jsx)(l.default,{text:r.default.t(1720)})})})};var i=a(s(84758)),n=a(s(91952)),o=a(s(75940)),l=a(s(85051)),r=a(s(2408)),d=s(85893)},45953:(e,t,s)=>{"use strict";var a=s(20862),i=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{contactList:t,onSend:s,onBack:a,chat:i}=e;let g;switch(i.kind){case n.CHAT_KIND.CHAT:g=u.default.t(700,{chat:i.title(),count:u.default.n(t.length),_plural:t.length});break;case n.CHAT_KIND.GROUP:g=u.default.t(701,{chat:i.title(),count:u.default.n(t.length),_plural:t.length});break;case n.CHAT_KIND.BROADCAST:g=u.default.t(699,{chat:i.title(),count:u.default.n(t.length),_plural:t.length})}const x=g?(0,v.jsx)(d.default,{text:g,direction:"auto",titlify:!0,ellipsify:!0}):null;return(0,v.jsx)(h.default,{type:h.ModalTheme.Box,children:(0,v.jsxs)(o.default,{children:[(0,v.jsx)(r.default,{type:r.DRAWER_HEADER_TYPE.POPUP,onBack:a,children:x}),(0,v.jsx)(l.default,{children:(0,v.jsx)(c.default,{children:(0,v.jsx)("div",{className:m.default.body,children:t.map(((e,t)=>(0,v.jsx)(C,{contact:(0,_.vcardFromContactModel)(e)},t.toString())))})})}),(0,v.jsx)("div",{className:m.default.btnContainer,children:(0,v.jsx)("div",{className:m.default.btnPosition,children:(0,v.jsx)(f.default,{large:!0,onClick:s,children:(0,v.jsx)(p.default,{name:"send",directional:!0})})})})]})})};var n=s(58380),o=i(s(17747)),l=i(s(9042)),r=a(s(55588)),d=i(s(85051)),c=i(s(39e3)),u=i(s(2408)),h=a(s(79475)),f=i(s(3132)),p=i(s(2966)),m=i(s(83314)),g=i(s(46873)),_=s(50313),v=s(85893);function C({contact:e}){const t=(0,_.parseVcard)(e.vcard);return t?(0,v.jsx)("div",{className:m.default.vcardWrapper,children:(0,v.jsx)(g.default,{parsedVcard:t,thumbnail:(0,_.vcardThumbnail)(t)})}):null}},409:(e,t,s)=>{"use strict";var a=s(20862),i=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(s(94184)),o=s(55084),l=s(18400),r=i(s(31339)),d=s(67294),c=i(s(78899)),u=i(s(69991)),h=i(s(91952)),f=i(s(55454)),p=i(s(17025)),m=i(s(5481)),g=i(s(17747)),_=i(s(9042)),v=a(s(55588)),C=a(s(13540)),x=i(s(4919)),S=s(57092),y=s(97227),E=s(85103),j=s(86723),I=i(s(22079)),M=i(s(12950)),T=a(s(47683)),b=i(s(52087)),P=s(16719),L=i(s(2408)),w=i(s(71681)),D=a(s(10214)),O=i(s(40630)),N=i(s(31516)),R=s(20845),k=i(s(84653)),A=i(s(46714)),F=i(s(79485)),B=i(s(2966)),U=s(97504),G=i(s(69217)),H=i(s(17040)),V=i(s(92018)),W=s(41024),z=i(s(76238)),K=s(85893);class Y extends d.Component{constructor(...e){super(...e),this.state={hover:!1,currentQRBinary:null,currentQRData:null},this.handleMouseOver=()=>{this.state.hover||this.setState({hover:!0})},this.handleMouseEnter=()=>{this.state.hover||this.setState({hover:!0})},this.handleMouseLeave=()=>{this.state.hover&&this.setState({hover:!1})},this._setRefQRCodeContainer=e=>{this._refQRCodeContainer=e}}componentDidMount(){this.props.binary&&this._generateQRCode()}componentDidUpdate(){this._generateQRCode()}shouldComponentUpdate(e,t){return!(this._compareBinary(e.binary,this.props.binary)&&this._compareBinary(t.currentQRBinary,this.state.currentQRBinary)&&e.visible===this.props.visible&&t.hover===this.state.hover&&t.currentQRData===this.state.currentQRData)}_fingerprintsMatched(e,t){return!!e&&!!t&&ce(e.publicKey,t.publicKey)&&ce(e.identifier,t.identifier)}_compareBinary(e,t){if(!e&&!t)return!0;const s=(0,l.decodeProtobuf)(E.CombinedFingerprintSpec,e),a=(0,l.decodeProtobuf)(E.CombinedFingerprintSpec,t);if(!s&&!a)return!0;if(!(null!=s.version||null!=a.version||s.localFingerprint||a.localFingerprint||s.remoteFingerprint||a.remoteFingerprint))return!0;if(s.version!==a.version)return!1;const i=this._fingerprintsMatched(s.localFingerprint,a.localFingerprint),n=this._fingerprintsMatched(s.remoteFingerprint,a.remoteFingerprint);return i&&n}_generateQRCode(){const e=this._refQRCodeContainer,t=this.props.binary;if(!e||!t)return void this.setState({currentQRBinary:null,currentQRData:null});if(this._compareBinary(this.state.currentQRBinary,t))return;for(this.qr&&delete this.qr;e.firstChild;)e.removeChild(e.firstChild);this.qr=new N.default(e,{text:t,width:f.default.QR_EDGE/2,height:f.default.QR_EDGE/2,correctLevel:N.default.CorrectLevel.L}),this.setState({currentQRBinary:t});const s=e.getElementsByTagName("canvas")[0];s?this._storeQRData(s):this.setState({currentQRData:null})}_storeQRData(e){const t=document.createElement("canvas");t.width=e.width+10,t.height=e.height+10;const s=t.getContext("2d");s.fillStyle="white",s.fillRect(0,0,t.width,t.height),s.drawImage(e,5,5),t.toBlob((e=>this.setState({currentQRData:e})),"image/png")}render(){let e=null;if(this.props.visible){let t=null;if(this.state.hover&&this.state.currentQRData){const e=this.props.contact.formattedUser||"",s=p.default.assertGet((0,j.getMaybeMeUser)()).formattedUser;t=(0,K.jsx)(m.default,{file:this.state.currentQRData,download:"Verification Code between "+s+" and "+e,extension:y.AllowedFileExtensions.PNG,children:(0,K.jsx)(c.default,{text:L.default.t(2208)})})}e=(0,K.jsxs)("div",{onMouseOver:this.handleMouseOver,onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,children:[t,(0,K.jsx)("div",{className:H.default.circle,ref:this._setRefQRCodeContainer})]})}return e}}function q({visible:e}){let t=null;return e&&(t=(0,K.jsx)("div",{className:H.default.circle,children:(0,K.jsx)("div",{className:H.default.spinner,children:(0,K.jsx)(A.default,{size:52,stroke:4})})})),t}function Z({binary:e,contact:t,visible:s}){let a=null;return s&&(a=(0,K.jsxs)("div",{className:(0,n.default)(H.default.container,H.default.circleContainer),children:[(0,K.jsx)(Y,{visible:!!e,binary:e,contact:t}),(0,K.jsx)(q,{visible:!e})]})),a}Y.defaultProps={binary:null},Y.displayName="VerificationQRCode";class X extends d.Component{shouldComponentUpdate(e){return e.string!==this.props.string}_numDigitsInVerificationString(){return 60}render(){if(!this.props.string)return(0,K.jsx)("div",{children:L.default.t(1144)});const e=this.props.string;if(e.length!==this._numDigitsInVerificationString())return __LOG__(3)`verificationString:render this.props.stringshould be ${this._numDigitsInVerificationString()} characters long instead of ${e.length}.`,(0,K.jsx)("div",{children:L.default.t(2214)});const t=[];for(let s=0;s<3;s++){const a=[];for(let t=0;t<4;t++){const i=[];for(let a=0;a<5;a++){const n=e.charAt(5*s*4+5*t+a);i.push((0,K.jsx)("span",{className:H.default.digit,children:n},a))}a.push((0,K.jsx)("span",{className:H.default.block,children:i},t))}t.push((0,K.jsx)(R.SelectableDiv,{className:H.default.row,selectable:!0,children:a},s))}return(0,K.jsx)(R.SelectableDiv,{selectable:!0,children:t})}}function $({visible:e}){let t=null;return e&&(t=(0,K.jsx)("div",{className:(0,n.default)(H.default.container,H.default.checkmarkContainer),children:(0,K.jsx)("div",{className:H.default.checkmark,children:" "})})),t}function J({visible:e}){let t=null;return e&&(t=(0,K.jsx)("div",{className:(0,n.default)(H.default.container,H.default.errorContainer),children:(0,K.jsx)("div",{className:H.default.error,children:"!"})})),t}function Q({children:e}){return(0,K.jsx)("div",{className:H.default.errorBanner,children:e})}X.defaultProps={string:null},X.displayName="VerificationString";class ee extends d.Component{constructor(...e){super(...e),this._refVerificationVideo=(0,d.createRef)(),this.handleVideoLoaded=()=>{null==this._captureInterval&&(this._adjustOverlayPosition(),this._captureInterval=this.props.setInterval(this.capture,200))},this.capture=()=>{var e;const t=null===(e=this._refVerificationVideo.current)||void 0===e?void 0:e.underlyingVideo();if(!t)return;const s=document.createElement("canvas");s.width=t.videoWidth/2,s.height=t.videoHeight/2;s.getContext("2d").drawImage(t,s.width/2,s.height/2,s.width,s.height,0,0,s.width,s.height),s.toBlob((e=>{const t=window.URL.createObjectURL(e);__LOG__(2)`objectURL: ${t}`,this.props.onCapture(t)}),"image/jpeg",1)},this._adjustOverlayPosition=()=>{var e;const t=null===(e=this._refVerificationVideo.current)||void 0===e?void 0:e.underlyingVideo(),s=this._refVerificationOverlay;if(!t||!s)return;const a=t.offsetHeight,i=t.offsetWidth,n=i/3,o=n;s.style.width=n+"px",s.style.height=o+"px",s.style.margin=(a-o)/2+"px "+(i-n)/2+"px"},this._setRefVerificationOverlay=e=>{this._refVerificationOverlay=e}}componentDidMount(){this.props.listeners.add(window,"resize",this._adjustOverlayPosition),(0,D.isSrcObjectInVideoElement)()||(this._videoURL=window.URL.createObjectURL(this.props.stream))}componentWillUnmount(){var e,t;null!=this._captureInterval&&this.props.clearInterval(this._captureInterval),this.props.stream&&(null===(e=(t=this.props).disposeStream)||void 0===e||e.call(t),this._videoURL&&window.URL.revokeObjectURL(this._videoURL))}render(){let e=null;return this.props.stream&&(e=(0,K.jsxs)("div",{className:H.default.webcam,children:[(0,K.jsx)("div",{className:H.default.webcamVideo,children:(0,K.jsx)(V.default,{autoPlay:!0,ref:this._refVerificationVideo,onPlay:this.handleVideoLoaded,src:this._videoURL?this._videoURL:void 0,srcObject:this._videoURL?void 0:this.props.stream,width:"100%"})}),(0,K.jsx)("div",{className:H.default.overlay,ref:this._setRefVerificationOverlay}),(0,K.jsx)("button",{onClick:this.props.onClose,className:H.default.btnClose,children:(0,K.jsx)(B.default,{name:"x-alt"})})]})),e}}ee.displayName="VerificationWebcamComponent";const te=(0,w.default)((0,G.default)(ee)),se=0,ae=1,ie=2,ne=3,oe=4,le=5;class re extends d.Component{constructor(...e){super(...e),this.state={circleVisible:!0,checkmarkVisible:!1,errorIconVisible:!1,webcamVisible:!1,bannerVisible:!1,bannerText:null,stream:null,isDragging:!1,binaryMD:null,stringMD:null},this._handleIdentityKeyMissing=()=>{h.default.openModal((0,K.jsx)(k.default,{name:this.props.contact.formattedUser,onOK:()=>{this.props.onClose?this.props.onClose():this.props.uim.uie.requestDismiss()}}))},this.handleDragChange=e=>{this.setState({isDragging:e})},this.handleDrop=e=>{this.props.contact.verificationBinary&&this.props.contact.verificationString&&this._handleUploadSelect(e)},this._setIdentityState=()=>{(0,z.default)(this.props.contact.id).checkpoint(this.props.rejectOnUnmount()).then((e=>{e?(ce(this.state.binaryMD,e.binary)&&!e.string!==this.state.stringMD||(null!=this.state.binaryMD&&h.default.openModal((0,K.jsx)(W.E2EChangeModal,{contact:this.props.contact})),this.setState({binaryMD:e.binary,stringMD:e.string})),this._refreshTimer=this.props.setTimeout((()=>{this._setIdentityState()}),1e3)):(null!=this._refreshTimer&&this.props.clearTimeout(this._refreshTimer),this._handleIdentityKeyMissing())})).catch((0,o.filteredCatch)(C.Unmount,(()=>{})))},this._showWebcamHint=()=>{this.state.webcamVisible&&!this.state.bannerVisible&&this._showBanner(L.default.t(2218))},this._handleWebcamOpen=()=>{const{asyncStream:e,disposeStream:t}=D.start("camera");this._disposeStream=t,e.then((e=>this._showWebcamStream(e))).catch((0,o.filteredCatch)(C.GUM.NotAllowedError,(()=>{h.default.openModal((0,K.jsx)(T.default,{messaging:T.Messaging.CAMERA_FAIL,type:T.default.TYPE.GUIDE_UNBLOCK}))}))).catch((0,o.filteredCatch)(C.GUM.GUMError,(()=>{h.default.openModal((0,K.jsx)(T.default,{messaging:T.Messaging.CAMERA_MISSING,type:T.default.TYPE.GUIDE_NONE}))})))},this._handleWebcamClose=()=>{this.setState({webcamVisible:!1,bannerVisible:!1,stream:null}),this._disposeStream=null},this._handleWebcamCapture=e=>{this._verifyImage(e,!0)},this._handleUploadClick=()=>{const e=this._refVerificationFilePickerInput;e&&e.click()},this._handleUploadSelect=e=>{e.stopPropagation();const t=e.target.files||e.dataTransfer.files;if(!t||!t[0])return;const s=t[0],a=URL.createObjectURL(s);this._verifyImage(a,!1);const i=this._refVerificationFilePickerForm;i&&i.reset()},this.handleClose=()=>{this.props.onClose?this.props.onClose():this.props.uim.uie.requestDismiss()},this._hideCheckmark=()=>{this.state.errorIconVisible||this.setState({circleVisible:!0}),this.setState({checkmarkVisible:!1})},this._hideError=()=>{this.state.checkmarkVisible||this.setState({circleVisible:!0}),this.setState({errorIconVisible:!1})},this._hideBanner=()=>{this.setState({bannerVisible:!1})},this._setRefVerificationFilePickerForm=e=>{this._refVerificationFilePickerForm=e},this._setRefVerificationFilePickerInput=e=>{this._refVerificationFilePickerInput=e}}componentDidMount(){M.default.supportsFeature(M.default.F.MD_BACKEND)?this._setIdentityState():(0,P.queryIdentity)(this.props.contact)}componentDidUpdate(e){e.contact===this.props.contact||M.default.supportsFeature(M.default.F.MD_BACKEND)||(0,P.queryIdentity)(this.props.contact)}componentWillUnmount(){var e;null===(e=this._disposeStream)||void 0===e||e.call(this)}_showWebcamStream(e){this.setState({webcamVisible:!0,circleVisible:!0,checkmarkVisible:!1,errorIconVisible:!1,stream:e}),null!=this._hintTimer&&(this.props.clearTimeout(this._hintTimer),delete this._hintTimer),this._hintTimer=this.props.setTimeout(this._showWebcamHint,7e3)}_getErrorBannerText(e){let t;const s=this.props.contact.formattedShortName;switch(e){case ie:t=L.default.t(2212,{contact:s});break;case ne:case oe:t=L.default.t(2211,{contact:s});break;case le:default:t=L.default.t(2210)}return t}_showCheckmark(){this._handleWebcamClose(),this.setState({circleVisible:!1,checkmarkVisible:!0,errorIconVisible:!1,bannerVisible:!1}),null!=this._iconTimer&&(this.props.clearTimeout(this._iconTimer),delete this._iconTimer),this._iconTimer=this.props.setTimeout(this._hideCheckmark,3e3)}_showErrorIcon(){this._handleWebcamClose(),this.setState({circleVisible:!1,checkmarkVisible:!1,errorIconVisible:!0,bannerVisible:!1}),null!=this._iconTimer&&(this.props.clearTimeout(this._iconTimer),delete this._iconTimer),this._iconTimer=this.props.setTimeout(this._hideError,3e3)}_showErrorBanner(e){const t=this._getErrorBannerText(e);this._showBanner(t)}_showBanner(e){this.setState({circleVisible:!0,checkmarkVisible:!1,errorIconVisible:!1,bannerVisible:!0,bannerText:e}),null!=this._bannerTimer&&(this.props.clearTimeout(this._bannerTimer),delete this._bannerTimer),this._bannerTimer=this.props.setTimeout(this._hideBanner,5e3)}_validateFingerprint(e){if(!e||0===!e.version||!e.localFingerprint||!e.remoteFingerprint)return le;let t=new ArrayBuffer(0);t=M.default.supportsFeature(M.default.F.MD_BACKEND)?this.state.binaryMD:this.props.contact.verificationBinary;const s=(0,l.decodeProtobuf)(E.CombinedFingerprintSpec,t);if(ce(e.localFingerprint&&e.localFingerprint.identifier,s.localFingerprint&&s.localFingerprint.identifier)&&ce(e.remoteFingerprint&&e.remoteFingerprint.identifier,s.remoteFingerprint&&s.remoteFingerprint.identifier))return se;const a=ce(e.remoteFingerprint&&e.remoteFingerprint.identifier,s.localFingerprint&&s.localFingerprint.identifier),i=ce(e.localFingerprint&&e.localFingerprint.identifier,s.remoteFingerprint&&s.remoteFingerprint.identifier);if(!a&&!i)return oe;if(!a)return ie;if(!i)return ne;const n=ce(e.remoteFingerprint&&e.remoteFingerprint.publicKey,s.localFingerprint&&s.localFingerprint.publicKey),o=ce(e.localFingerprint&&e.localFingerprint.publicKey,s.remoteFingerprint&&s.remoteFingerprint.publicKey);return n&&o?se:ae}_decodeQRCode(e){return new Promise(((t,s)=>{r.default.callback=(e,a)=>{if(a)s(a);else if(e.length<1)s("QR decoder did not return decoded binary");else{const s=new Uint8Array(e[0]);t(s)}},r.default.decode(e)}))}_verifyImage(e,t){this._decodeQRCode(e).then((e=>(0,l.decodeProtobuf)(E.CombinedFingerprintSpec,e))).then((e=>{const s=this._validateFingerprint(e);s?t&&s===le||(this.setState({errorType:s}),s===ae?this._showErrorIcon():this._showErrorBanner(s)):this._showCheckmark()})).catch((()=>{t||(this.setState({errorType:le}),this._showErrorBanner(le))})).finally((()=>{window.URL.revokeObjectURL(e)}))}render(){let e=null,t=null,s=null,a=null,i=null,n=null,o=new ArrayBuffer(0),l="";return M.default.supportsFeature(M.default.F.MD_BACKEND)?(o=this.state.binaryMD,l=this.state.stringMD,n=L.default.t(2063,{contactName:this.props.contact.formattedShortName})):(o=this.props.contact.verificationBinary,l=this.props.contact.verificationString,n=L.default.t(2213)),o&&(I.default&&(e=(0,K.jsx)("div",{className:H.default.section,children:(0,K.jsx)(u.default,{type:"primary",onClick:this.state.webcamVisible?this._handleWebcamClose:this._handleWebcamOpen,children:this.state.webcamVisible?L.default.t(2217):L.default.t(2219)})})),t=(0,K.jsxs)("div",{className:H.default.section,children:[(0,K.jsx)(u.default,{type:"primary",onClick:this._handleUploadClick,children:L.default.t(2216)}),(0,K.jsx)("p",{className:H.default.dragAndDropExplanation,children:this.state.isDragging?L.default.t(2209):null})]}),s=(0,K.jsx)("form",{ref:this._setRefVerificationFilePickerForm,children:(0,K.jsx)("input",{ref:this._setRefVerificationFilePickerInput,accept:"image/*",type:"file",style:{display:"none"},onChange:this._handleUploadSelect,onClick:e=>e.stopPropagation()})})),this.state.webcamVisible&&this.state.stream&&(a=(0,K.jsx)(te,{stream:this.state.stream,disposeStream:this._disposeStream,onCapture:this._handleWebcamCapture,onClose:this._handleWebcamClose})),this.state.bannerVisible&&(i=(0,K.jsx)(Q,{children:this.state.bannerText})),(0,K.jsxs)(g.default,{theme:"verification",onDrop:this.handleDrop,onDragChange:this.handleDragChange,children:[(0,K.jsxs)(v.default,{type:v.DRAWER_HEADER_TYPE.SMALL,onBack:this.handleClose,children:[(0,K.jsx)(U.TextDiv,{theme:"title",children:L.default.t(2215)}),(0,K.jsxs)(U.TextDiv,{theme:"small",children:[L.default.t(2225),", ",this.props.contact.formattedUser]})]}),a,i,(0,K.jsx)(_.default,{children:(0,K.jsxs)("div",{className:H.default.form,children:[(0,K.jsxs)("div",{className:H.default.photo,children:[(0,K.jsx)(Z,{binary:o,contact:this.props.contact,visible:this.state.circleVisible}),(0,K.jsx)($,{visible:this.state.checkmarkVisible}),(0,K.jsx)(J,{visible:this.state.errorIconVisible})]}),(0,K.jsx)("div",{className:H.default.section,children:(0,K.jsx)("div",{className:H.default.code,children:(0,K.jsx)(X,{string:l})})}),(0,K.jsx)("div",{className:H.default.section,children:(0,K.jsxs)("p",{className:H.default.explanation,children:[(0,K.jsxs)("span",{children:[n,""]}),(0,K.jsx)(x.default,{href:(0,S.getE2EFaqUrl)(),children:L.default.t(1103)})]})}),e,t,s]})})]})}}re.CONCERNS={contact:["verificationBinary","verificationString","formattedUser","formattedShortName","id"]},re.displayName="VerificationDrawer";var de=(0,b.default)((0,O.default)((0,G.default)((0,F.default)(re,re.CONCERNS))));function ce(e,t){if(!e||!t)return!1;const s=new Uint8Array(e),a=new Uint8Array(t),i=s.length;if(i!==a.length)return!1;for(let e=0;e<i;e++)if(s[e]!==a[e])return!1;return!0}t.default=de},12824:(e,t,s)=>{"use strict";var a=s(20862),i=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(s(94184)),o=s(67294),l=i(s(76610)),r=i(s(94822)),d=i(s(33287)),c=i(s(91952)),u=i(s(55454)),h=i(s(17747)),f=i(s(9042)),p=a(s(55588)),m=i(s(2408)),g=i(s(65565)),_=i(s(79485)),v=s(97504),C=i(s(13038)),x=a(s(49201)),S=s(62437),y=i(s(26163)),E=s(85893);class j extends o.Component{constructor(...e){super(...e),this.state={hover:!1},this.handleClick=()=>{const e=this._encodeColor(),t=r.default.get("defaultPreference");t&&e!==t.wallpaperColor&&(t.set("wallpaperColor",e),c.default.openToast((0,E.jsx)(x.default,{msg:m.default.t(1889),id:(0,x.genId)()})))},this.handleMouseOver=()=>{this.state.hover||(this.setState({hover:!0}),r.default.trigger("wallpaper_color_preview",this._encodeColor()))},this.handleMouseEnter=()=>{this.state.hover||(this.setState({hover:!0}),r.default.trigger("wallpaper_color_preview",this._encodeColor()))},this.handleMouseLeave=()=>{this.state.hover&&(this.setState({hover:!1}),r.default.trigger("wallpaper_color_preview"))},this._encodeColor=()=>{const{colorHex:e,isDefault:t}=this.props;return t?u.default.DEFAULT_CHAT_WALLPAPER:e}}render(){const e=this.props.isDefault?(0,E.jsx)("span",{className:y.default.wallpaperDefaultTitle,"data-a8n":l.default.key("wallpaper-default-title"),children:m.default.t(743)}):null,t=(0,n.default)(y.default.wallpaperColorCanvas,{[y.default.canvasHover]:this.state.hover,[y.default.canvasActive]:this.props.isSelected,[y.default.canvasDefault]:this.props.isDefault});return(0,E.jsx)("span",{className:t,style:{backgroundColor:this.props.colorHex},onMouseOver:this.handleMouseOver,onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,onClick:this.handleClick,title:this.props.isDefault?m.default.t(743):null,children:e})}}j.displayName="ColorCanvas";class I extends o.Component{constructor(...e){super(...e),this._handleWallpaperDoodleChange=()=>{const{chatPreference:e}=this.props;if(e){const t=!e.showDoodle;e.set("showDoodle",t),c.default.openToast((0,E.jsx)(x.default,{msg:t?m.default.t(1890):m.default.t(1891),id:(0,x.genId)()}))}}}render(){let e;const{chatPreference:t,colors:s}=this.props,a=t&&t.wallpaperColor,i=t&&t.showDoodle,n=s.map((e=>(0,E.jsx)(j,{colorHex:e,isSelected:a===e,isDefault:!1},e))),o=(0,E.jsx)(j,{isSelected:a===u.default.DEFAULT_CHAT_WALLPAPER,isDefault:!0},u.default.DEFAULT_CHAT_WALLPAPER);n.unshift(o);for(let e=0;e<2;e++)n.push((0,E.jsx)("div",{className:y.default.wallpaperColorEmpty},"emptyEl"+e));return g.default.wallpapersV2&&(e=(0,E.jsxs)("div",{className:y.default.wallpaperApplyDoodle,children:[(0,E.jsx)(d.default,{onChange:this._handleWallpaperDoodleChange,checked:!!i}),(0,E.jsx)(v.TextSpan,{className:y.default.checkboxLabel,theme:"small",children:m.default.t(1888)})]})),(0,E.jsxs)(E.Fragment,{children:[e,(0,E.jsx)("div",{className:y.default.wallpaperColorGrid,children:n})]})}}I.CONCERNS={chatPreference:["wallpaperColor","showDoodle"]},I.displayName="ColorGridClass";const M=(0,_.default)(I,I.CONCERNS);class T extends o.Component{componentWillUnmount(){r.default.trigger("wallpaper_color_preview"),g.default.wallpapersV2&&r.default.trigger("wallpaper_drawer_close")}componentDidMount(){g.default.wallpapersV2&&r.default.trigger("wallpaper_drawer_open")}render(){return(0,E.jsxs)(h.default,{children:[(0,E.jsx)(p.default,{title:m.default.t(1892),onBack:this.props.onClose,type:p.DRAWER_HEADER_TYPE.LARGE}),(0,E.jsx)(f.default,{children:(0,E.jsx)(M,{colors:(0,S.getWallpaperColors)(this.context.theme),chatPreference:r.default.get("defaultPreference")})})]})}}t.default=T,T.contextType=C.default,T.displayName="WallpaperDrawer"},79354:(e,t,s)=>{"use strict";var a=s(20862),i=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=s(55084),o=s(67294),l=i(s(25142)),r=i(s(91952)),d=i(s(75940)),c=a(s(61447)),u=i(s(17747)),h=i(s(9042)),f=a(s(55588)),p=s(54647),m=i(s(8212)),g=i(s(67893)),_=i(s(2408)),v=i(s(98052)),C=i(s(55850)),x=i(s(50320)),S=s(97504),y=s(85893);class E extends o.Component{constructor(e){super(e),this._orderFlatListController=new g.default,this.state={isLoading:!0,fetchState:"PENDING",order:null}}componentDidMount(){const{orderId:e,token:t,sellerJid:s}=this.props;v.default.findOrder(e,s,t).then((e=>{this.setState({fetchState:"SUCCESS",isLoading:!1,order:e})})).catch((0,n.filteredCatch)(p.E404,(()=>{this._showNotFoundErrorToast(),this.setState({fetchState:"ERROR",isLoading:!1})}))).catch((()=>{this.setState({fetchState:"ERROR",isLoading:!1}),__LOG__(4,!0,new Error,!0)`Catalog Order Display failed`,SEND_LOGS("OrderDetails: failed to display")}))}_getDrawerContent(){const{sellerJid:e}=this.props,{fetchState:t,order:s}=this.state;if(this.state.isLoading||null==s)return(0,y.jsx)(m.default,{fetchState:t});let a="";a=s.products.length>0?_.default.t(1092,{count:s.totalItemCount||0,_plural:s.totalItemCount||0}):_.default.t(1431);const i=(0,y.jsx)(S.TextDiv,{theme:"title",children:a});let n=null;n=null!=s.total&&0!==s.total?_.default.t(1426,{subtotal:c.formatAmount1000(s.currency,s.total)}):_.default.t(1422);const o=(0,y.jsx)(S.TextDiv,{theme:"muted-small",children:n});let r=null;if(null!=s.createdAt){const e=l.default.timeStr(s.createdAt);r=(0,y.jsx)(S.TextSpan,{theme:"muted-small",children:`${e}`})}return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(m.default,{fetchState:t}),(0,y.jsxs)("div",{className:C.default.info,children:[i,o]}),(0,y.jsx)(x.default,{flatListController:this._orderFlatListController,onProductDetail:this.props.onProductDetail,order:s,sellerJid:e}),(0,y.jsx)("div",{className:C.default.date,children:r})]})}_showNotFoundErrorToast(){r.default.openModal((0,y.jsx)(d.default,{onOK:()=>{r.default.closeModal()},okText:_.default.t(2085),children:_.default.t(1423)}))}handleClose(){r.default.closeDrawerRight()}render(){const{userIsCartOwner:e}=this.props;return(0,y.jsxs)(u.default,{theme:"striped",onDrop:this.handleClose,children:[(0,y.jsx)(f.default,{title:e?_.default.t(493):_.default.t(492),type:f.DRAWER_HEADER_TYPE.SMALL,onBack:this.handleClose}),(0,y.jsx)(h.default,{flatListControllers:[this._orderFlatListController],children:this._getDrawerContent()})]})}}t.default=E,E.displayName="OrderDetailDrawer"},50320:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{order:t,onProductDetail:s,sellerJid:a}=e,h=e=>{const s=t.orderItemCollection.toArray();return(0,r.logOrderListImpression)({catalogContext:e,orderId:t.id,productCount:s.length,catalogOwnerJid:a}),s.map((e=>({itemKey:e.id.toString(),product:e})))};return(0,u.jsx)(n.default.Consumer,{children:t=>{const a=(0,c.getProductCatalogContext)(t);return(0,u.jsx)(l.default,{flatListControllers:[e.flatListController],children:(0,u.jsx)(o.default,{a8nKey:"order-product-list",flatListController:e.flatListController,direction:"vertical",forceConsistentRenderCount:!1,data:h(a),renderItem:t=>((t,a)=>{const{sellerJid:i}=e,{product:n}=t,o={productId:n.id,businessOwnerJid:i};return(0,u.jsx)(d.default,{product:n,onClick:()=>{(0,r.logOrderListItemClick)({catalogContext:a,orderId:e.order.id,catalogOwnerJid:i}),s(o)}})})(t,a),defaultItemHeight:i.default.PRODUCT_LIST_ITEM_HEIGHT})})}})};var i=a(s(55454)),n=a(s(79864)),o=a(s(86025)),l=a(s(19257)),r=s(1236),d=a(s(7148)),c=s(70790),u=s(85893)},7148:(e,t,s)=>{"use strict";var a=s(20862),i=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{product:t,onClick:s}=e,a=(0,f.jsx)(r.default,{text:t.name,ellipsify:!0,titlify:!0}),i=(0,f.jsx)(u.default,{mediaData:t.mediaData,theme:"list"}),p=d.default.t(1427,{quantity:t.quantity.toString()});let m=null;t.quantity&&(m=(0,f.jsx)(h.TextSpan,{className:c.default.quantity,children:p}));let g=null;g=(0,n.isNonZeroNumber)(t.price)?l.formatAmount1000(t.currency,t.price):d.default.t(485);const _=(0,f.jsx)(h.TextSpan,{className:c.default.price,children:g});let v=null;null!=m&&(v=(0,f.jsx)("span",{className:c.default.separator,children:""}));const C=(0,f.jsxs)("div",{children:[_,v,m]});return(0,f.jsx)(o.default,{image:i,customImage:!0,primary:a,secondary:C,theme:"order-product",onClick:s},t.id.toString())};var n=s(71730),o=i(s(55092)),l=a(s(61447)),r=i(s(85051)),d=i(s(2408)),c=i(s(20295)),u=i(s(84241)),h=s(97504),f=s(85893)},65571:(e,t,s)=>{"use strict";var a=s(20862),i=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.CatalogSettingsDrawer=void 0;var n=s(67294),o=s(98216),l=i(s(8581)),r=i(s(93543)),d=i(s(44683)),c=i(s(91952)),u=i(s(17747)),h=i(s(9042)),f=a(s(55588)),p=i(s(25061)),m=s(4919),g=s(57092),_=s(86723),v=i(s(2408)),C=i(s(663)),x=i(s(71681)),S=i(s(40630)),y=i(s(28981)),E=i(s(46714)),j=s(97504),I=a(s(49201)),M=s(85893);function T({cartEnabled:e,setCartEnabled:t}){const s=s=>{t(s),(0,o.updateCartEnabled)(s).catch((()=>{__LOG__(4,!0,new Error,!0)`Failed to update cartEnabled value`,SEND_LOGS("updateCartEnabled: cartEnabled toggle error"),c.default.openToast((0,M.jsx)(I.default,{msg:v.default.t(546),duration:6e3,id:(0,I.genId)()})),t(e)}))},a=(0,g.getCatalogCartOnOffFaqUrl)(),i=(0,M.jsx)(d.default,{href:a,onClick:e=>{e.preventDefault(),(0,m.openExternalLink)(a)},children:v.default.t(1103)}),n=(0,M.jsx)(C.default,{id:548,params:{learn_more_link:i}});return(0,M.jsxs)(M.Fragment,{children:[(0,M.jsxs)(p.default,{title:v.default.t(547),theme:"title-larger",animation:!1,children:[(0,M.jsx)(y.default,{isChosen:e,onChoose:()=>{s(!0)},choiceText:v.default.t(552)}),(0,M.jsx)(y.default,{isChosen:!e,onChoose:()=>{s(!1)},choiceText:v.default.t(551)})]}),(0,M.jsx)(j.TextDiv,{theme:"plain",className:r.default.descriptionText,children:n})]})}class b extends n.Component{constructor(e){super(e),this.updateCartEnabled=e=>{this.setState({cartEnabled:e})},this.state={isLoading:!0,cartEnabled:!1}}componentDidMount(){l.default.fetchBizProfile((0,_.getMeUser)()).then((e=>{const t=e.profileOptions;this.setState({cartEnabled:null!=t&&t.cartEnabled,isLoading:!1})})).catch((()=>{__LOG__(4,!0,new Error)`Error fetching the business profile.`,c.default.openToast((0,M.jsx)(I.default,{msg:v.default.t(549),duration:6e3,id:(0,I.genId)()})),this.props.onBack()}))}_getDrawerContent(){return(0,M.jsx)(T,{cartEnabled:this.state.cartEnabled,setCartEnabled:this.updateCartEnabled})}render(){return(0,M.jsxs)(u.default,{theme:"catalog",onDrop:this.props.onBack,children:[(0,M.jsx)(f.default,{title:v.default.t(550),type:f.DRAWER_HEADER_TYPE.LARGE,onBack:this.props.onBack}),(0,M.jsx)(h.default,{children:this.state.isLoading?(0,M.jsx)("div",{className:r.default.loadingSpinner,children:(0,M.jsx)(E.default,{})}):this._getDrawerContent()})]})}}t.CatalogSettingsDrawer=b,b.displayName="CatalogSettingsDrawer";var P=(0,S.default)((0,x.default)(b));t.default=P},8730:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{selections:t,active:s,onSelectionChanged:a,catalog:d}=e,c=e=>{((e,i,n)=>{t.setVal(e,i,n),s.setVal(e,n),a()})(e,!t.isSelected(e),!1)};return(0,r.jsx)(o.default,{flatListControllers:[e.flatListController],children:(0,r.jsx)(n.default,{flatListController:e.flatListController,direction:"vertical",forceConsistentRenderCount:!1,data:d.productCollection.getProductModels(!0).map((e=>({itemKey:e.id.toString(),product:e}))),renderItem:e=>{const{product:a}=e;return(0,r.jsx)(l.default,{product:a,selections:t,onClick:()=>c(a),active:s},a.id.toString())},defaultItemHeight:i.default.PRODUCT_LIST_ITEM_HEIGHT})})};var i=a(s(55454)),n=a(s(86025)),o=a(s(19257)),l=a(s(65161)),r=s(85893)},69105:(e,t,s)=>{"use strict";var a=s(20862),i=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.EditCollectionContent=void 0;var n=i(s(48926)),o=i(s(23493)),l=i(s(94184)),r=s(67294),d=s(96470),c=s(46215),u=i(s(8730)),h=i(s(55454)),f=i(s(17747)),p=i(s(9042)),m=i(s(79864)),g=a(s(55588)),_=i(s(78518)),v=i(s(67893)),C=i(s(52715)),x=i(s(2408)),S=i(s(71681)),y=s(59562),E=i(s(66329)),j=s(70790),I=i(s(40630)),M=i(s(3132)),T=i(s(16967)),b=i(s(46714)),P=i(s(2966)),L=i(s(29458)),w=s(85893);class D extends r.Component{constructor(e){var t,s;super(e),this.active=new T.default([],(e=>e.id)),this.selections=new E.default([],(e=>e.id.toString())),this._collectionFlatListController=new v.default,this.handleNameChange=e=>{let t=this.state.errorName;t&&e&&(t=null),this.setState({name:e,errorName:t})},this._handleScroll=(e,t)=>{var s,a;(null===(s=this.state.scrollHelper)||void 0===s?void 0:s.willLoadMore(t))&&this.setState({loadingMore:!0}),null===(a=this.state.scrollHelper)||void 0===a||a.onScroll(e,t).then((e=>{e&&this.setState({loadingMore:!1})})).catch((e=>{throw this.setState({loadingMore:!1}),e}))},this.handleScroll=(0,o.default)(this._handleScroll,100),this.onScroll=e=>{this.handleScroll(e,e.currentTarget)},this.state={saveEnabled:!0,dataSource:null,scrollHelper:null,name:null===(t=e.collection)||void 0===t?void 0:t.name,lastNameSaved:null===(s=e.collection)||void 0===s?void 0:s.name,errorName:null,isUpdating:!1,loadingMore:!0}}componentDidMount(){this._setupDataSource()}_setupDataSource(){var e;const t=new c.CollectionsContentDataSource(this.props.catalog,h.default.PRODUCT_LIST_ITEM_HEIGHT,null===(e=this.props.collection)||void 0===e?void 0:e.id),s=new c.CatalogListItemScrollHelper(t);this.setState({dataSource:t,scrollHelper:s},(()=>{t.loadInitialItems().then((()=>{this.setState({loadingMore:!1}),this.forceUpdate()}))}))}getNameEdit(){return(0,w.jsx)(L.default,{editable:!0,focusOnMount:!0,showRemaining:!0,value:this.state.name,onChange:this.handleNameChange,inputPlaceholder:x.default.t(503),theme:"text-input",error:this.state.errorName,maxLength:30})}getFooter(e){let t;const s=this.syncSelection();if(s>0||this.props.collection&&this.state.name!==this.props.collection.name){const a=x.default.t(509,{updated:s,_plural:s});t=(0,w.jsxs)("div",{className:_.default.footer,children:[a,(0,w.jsx)("div",{className:_.default.saveButton,children:(0,w.jsx)(M.default,{large:!0,onClick:()=>{this.save(e)},children:(0,w.jsx)(P.default,{directional:!0,name:"checkmark-medium"})})})]})}return t}_getDrawerContent(){const e=this.state.isUpdating?(0,w.jsx)("div",{className:_.default.spinner,children:(0,w.jsx)(b.default,{size:50,stroke:3})}):null;return(0,w.jsx)(m.default.Consumer,{children:t=>{const s=(0,j.getProductCatalogContext)(t);return(0,w.jsxs)(w.Fragment,{children:[e,(0,w.jsxs)("div",{className:_.default.nameContainer,children:[(0,w.jsx)("span",{className:_.default.nameIcon,children:(0,w.jsx)(P.default,{name:"collections_folder"})}),(0,w.jsx)("span",{className:_.default.nameEdit,children:this.getNameEdit(s)})]}),(0,w.jsx)("div",{className:_.default.operation,children:this.props.collection?x.default.t(514):x.default.t(500)}),(0,w.jsxs)("div",{className:_.default.listContainer,children:[(0,w.jsx)(u.default,{catalog:this.props.catalog,flatListController:this._collectionFlatListController,active:this.active,selections:this.selections,onSelectionChanged:()=>this.forceUpdate()}),this.state.loadingMore&&(0,w.jsx)("div",{className:_.default.loadingSpinner,children:(0,w.jsx)(C.default,{})})]}),this.getFooter(s)]})}})}syncSelection(){const e=this.props.catalog.productCollection.getProductModels(!0);let t=0;return e.forEach((e=>{this.selections.isInList(e)?e.checkmark!==this.selections.isSelected(e)&&t++:this.selections.setVal(e,e.checkmark)})),t}getProductDeltas(){const e=this.props.catalog.productCollection.getProductModels(!0),t=[],s=[];return e.forEach((e=>{const a=this.selections.isSelected(e);e.checkmark!==a&&(a?s.push(e):t.push(e))})),{added:s,removed:t}}save(e){var t=this;return(0,n.default)((function*(){const s=(0,j.getProductCatalogContext)(e);if(t.state.name&&""!==t.state.name.trim()){t.setState({isUpdating:!0});const{added:e,removed:a}=t.getProductDeltas();try{const{collection:i,catalog:n,onBack:o}=t.props;if(yield(0,d.handleCollectionSave)(n,i,t.state.name||"",e,a,s)){o();const n=null==i?void 0:i.id,l=t.state.name!==t.state.lastNameSaved;n&&l&&((0,y.logCollectionRenamed)({catalogContext:s,collectionId:n}),t.setState({lastNameSaved:t.state.name})),i&&(0,y.logCollectionItemsAssignment)({collectionId:i.id,addedCount:e.length,removedCount:a.length,catalogContext:s})}else t.setState({isUpdating:!1})}catch(e){t.setState({isUpdating:!1})}}else t.setState({errorName:x.default.t(510)})}))()}render(){var e;const t=(0,l.default)(_.default.container,{[_.default.isSending]:this.state.isUpdating}),s=(null===(e=this.props.collection)||void 0===e?void 0:e.name)||x.default.t(512);return(0,w.jsxs)(f.default,{theme:"products",onDrop:this.props.onBack,children:[(0,w.jsx)(g.default,{title:s,type:g.DRAWER_HEADER_TYPE.LARGE,onBack:this.props.onBack,menu:(0,w.jsx)(w.Fragment,{})}),(0,w.jsx)(p.default,{className:t,flatListControllers:[this._collectionFlatListController],onScroll:this.onScroll,children:this._getDrawerContent()})]})}}t.EditCollectionContent=D,D.displayName="EditCollectionContent";var O=(0,I.default)((0,S.default)(D));t.default=O},74659:(e,t,s)=>{"use strict";var a=s(20862),i=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.ComplianceInfoFields=Y,t.default=t.EditProductDrawer=void 0;var n=i(s(81109)),o=i(s(48926)),l=i(s(94184)),r=s(55084),d=i(s(7900)),c=s(67294),u=s(96470),h=i(s(69991)),f=i(s(60028)),p=i(s(33287)),m=i(s(91952)),g=i(s(55454)),_=s(27546),v=s(94910),C=a(s(61447)),x=i(s(36560)),S=i(s(17747)),y=i(s(9042)),E=i(s(79864)),j=a(s(55588)),I=i(s(37201)),M=s(54647),T=s(63290),b=s(86723),P=s(78615),L=i(s(52087)),w=i(s(2408)),D=i(s(71681)),O=s(30333),N=a(s(78150)),R=s(94583),k=s(70790),A=i(s(65248)),F=i(s(40630)),B=i(s(46714)),U=i(s(79485)),G=s(97504),H=i(s(29458)),V=a(s(49201)),W=i(s(1458)),z=s(85893);class K extends c.Component{constructor(e){var t,s;super(e),t=this,this._imagePanelRef=(0,c.createRef)(),this._handleNameChange=e=>{this.setState({name:e,nameError:""===e?w.default.t(883):"",isModified:!0})},this.getServerPrice=e=>parseInt(parseFloat(e).toFixed(2).toString().replace(/\.|,/g,""),10),this._handlePriceChange=e=>{const t=C.valueFromString(this.state.currency,e);let s="";""===e||C.validatePriceString(this.state.currency,e,N.MIN_PRICE,N.MAX_PRICE)||(s=w.default.t(884)),this.setState({priceAmount1000:""===e?null:t,priceStr:`${e}`,priceError:s,isModified:!0})},this.handleDescriptionChange=e=>{this.setState({description:e,isModified:!0})},this._handleUrlChange=e=>{let t="";""===e||W.default.isValid(e)||(t=w.default.t(889)),this.setState({url:e,urlError:t,isModified:!0})},this._handleUrlBlur=()=>{const{url:e}=this.state;""===e||W.default.isHttps(e)||W.default.isHttp(e)||this.setState({url:`https://${e}`})},this._handleRetailerIdChange=e=>{this.setState({retailerId:e,retailerIdError:"",isModified:!0})},this._showComplianceInfoImporterAddress=e=>!!e&&e!==g.default.COMPLIANCE_INFO_CODES.INDIA,this._handleComplianceInfoChange=function(){var e=(0,o.default)((function*(e,s){var a;let i=!1;const o=(0,n.default)((0,n.default)({},t.state.complianceInfo),{},{importerAddress:(0,n.default)({},null===(a=t.state.complianceInfo)||void 0===a?void 0:a.importerAddress)});"countryCodeOrigin"===e&&(o.countryNameOrigin=(yield(0,_.getCountryName)(s))||"",i=!t._showComplianceInfoImporterAddress(s)),o[e]=s||"",i&&(o.importerAddress.street1="",o.importerAddress.street1Error="",o.importerAddress.street2="",o.importerAddress.postalCode="",o.importerAddress.city="",o.importerAddress.cityError="",o.importerAddress.region="",o.importerAddress.countryCode="",o.importerAddress.countryName="",o.importerAddress.countryCodeError=""),t.setState({complianceInfo:o,isModified:!0})}));return function(){return e.apply(this,arguments)}}(),this._handleComplianceInfoImporterAddressChange=function(){var e=(0,o.default)((function*(e,s){var a,i;const{street1:o,city:l,countryCode:r}=(null===(a=t.state.complianceInfo)||void 0===a?void 0:a.importerAddress)||{},d="street1"===e?s:o,c="city"===e?s:l,u="countryCode"===e?s:r,h=[d,c,u].some((e=>e)),f=(0,n.default)((0,n.default)({},t.state.complianceInfo),{},{importerAddress:(0,n.default)({},null===(i=t.state.complianceInfo)||void 0===i?void 0:i.importerAddress)});"countryCode"===e&&(f.importerAddress.countryName=(yield(0,_.getCountryName)(s))||""),f.importerAddress[e]=s||"",f.importerAddress.street1Error=h&&!d?w.default.t(1475):"",f.importerAddress.cityError=h&&!c?w.default.t(1469):"",f.importerAddress.countryCodeError=h&&!u?w.default.t(1471):"",t.setState({complianceInfo:f,isModified:!0})}));return function(){return e.apply(this,arguments)}}(),this._handleHiddenChange=()=>{this.setState({isHidden:!this.state.isHidden})},this._getProductChanges=()=>{const{catalog:e,product:t}=this.props,{name:s,priceAmount1000:a,currency:i,description:n,url:o,retailerId:l,complianceInfo:r,isHidden:d}=this.state;return new N.default({id:t.id,priceAmount1000:a,currency:i,description:n||"",imageCdnUrl:t.imageCdnUrl,additionalImageCdnUrl:t.additionalImageCdnUrl,name:s,retailerId:l,url:o,isHidden:d,complianceInfo:(0,P.canSeeECommerceComplianceIndiaBusinessJourney)(e.id.user)?{countryCodeOrigin:null==r?void 0:r.countryCodeOrigin,importerName:null==r?void 0:r.importerName,importerAddress:{street1:null==r?void 0:r.importerAddress.street1,street2:null==r?void 0:r.importerAddress.street2,postalCode:null==r?void 0:r.importerAddress.postalCode,city:null==r?void 0:r.importerAddress.city,region:null==r?void 0:r.importerAddress.region,countryCode:null==r?void 0:r.importerAddress.countryCode}}:void 0})},this._handleSaveItem=()=>{const{catalog:e,product:t,newProduct:s}=this.props,a=this._getProductChanges();var i;(s?(0,O.logAddProductClick)((0,k.getProductCatalogContext)(this.context)):(0,O.logEditProductClick)(t,(0,k.getProductCatalogContext)(this.context)),this.setState({isUpdating:!0}),s||this.state.isModified)?null===(i=this._imagePanelRef.current)||void 0===i||i.component.uploadImages().then((t=>{a.imageCdnUrl=t[0],a.additionalImageCdnUrl=t.slice(1);(s?e.addProduct:e.editProduct).call(e,a).then(this._handleEditSuccess).catch((0,r.filteredCatch)(M.CatalogEditServerError,this._handleEditError)).finally((()=>{this.setState({isUpdating:!1})}))})).catch((e=>{throw this.setState({isUpdating:!1}),e})):(0,R.productVisibilitySet)([{productId:t.id.toString(),isHidden:a.isHidden}]).then((()=>{t.isHidden=a.isHidden,this._handleEditSuccess(t)})).catch((0,r.filteredCatch)(M.CatalogEditServerError,this._handleEditError)).finally((()=>{this.setState({isUpdating:!1})}))},this._handleEditError=e=>{this.props.newProduct?(0,O.logAddProductFailed)((0,k.getProductCatalogContext)(this.context)):(0,O.logEditProductFailed)(this.props.product,(0,k.getProductCatalogContext)(this.context),e.statusCode),null!=e.errors&&e.errors.map((e=>{"media"===e.name&&"duplicate"===e.reason&&this.setState({imageError:w.default.t(879)}),"retailer_id"!==e.name&&"retailer-id"!==e.name||"duplicate"!==e.reason||this.setState({retailerIdError:w.default.t(880)})})),m.default.openToast((0,z.jsx)(V.default,{msg:w.default.t(544),id:(0,V.genId)("catalog_save_item_failed")}))},this._handleEditSuccess=e=>{const{catalog:t,onEditSuccess:s,newProduct:a,onCreate:i}=this.props;t.productCollection.add(e,{merge:!0}),this.props.newProduct?(0,O.logAddProductSuccess)((0,k.getProductCatalogContext)(this.context)):(0,O.logEditProductSuccess)(this.props.product,(0,k.getProductCatalogContext)(this.context)),m.default.openToast((0,z.jsx)(V.default,{msg:w.default.t(534),id:(0,V.genId)("catalog_item_saved")})),s(e),null!=a&&i&&i()},this._handleDeleteItem=()=>{const{catalog:e,product:t,onDelete:s}=this.props;(0,u.handleProductDelete)(e,t,(0,k.getProductCatalogContext)(this.context)).then((e=>{e&&(m.default.closeDrawerMid(),s&&s())}))},this._handleImageChange=e=>{let t="";0===e.length&&(t=w.default.t(882)),this.setState({imageError:t,hasImages:e.length>0,isModified:!0})},this.handleDrop=e=>{var t;null===(t=this._imagePanelRef.current)||void 0===t||t.component.handleFilePick(e)},this.handleDragChange=e=>{this.setState({isDragging:e})};const{product:a}=this.props,i=null==a.priceAmount1000?null:a.priceAmount1000;let l="";if(null!=i&&null!=a.currency){const e=C.formatAmount1000ToParts(a.currency,i);l=`${e.integer}${e.decimal}`}this.state={name:a.name||"",priceAmount1000:i,description:a.description||"",url:a.url||"",retailerId:a.retailerId||"",priceStr:l,currency:a.currency||C.currencyForCountryShortcode((0,v.getCountryShortcodeByPhone)(null===(s=(0,b.getMaybeMeUser)())||void 0===s?void 0:s.user)),isUpdating:!1,nameError:"",priceError:"",urlError:"",retailerIdError:"",imageError:"",hasImages:!!a.imageCdnUrl,isDragging:!1,isHidden:a.isHidden,isModified:!1,isComplianceInfoAvailable:!1,complianceInfo:void 0}}componentDidMount(){const{listeners:e,catalog:t,product:s}=this.props;(0,P.canSeeECommerceComplianceIndiaBusinessJourney)(t.id.user)&&this.setComplianceInfo(),e.add(s,"change:isHidden",(()=>{this.setState({isHidden:this.props.product.isHidden})}))}setComplianceInfo(){var e=this;return(0,o.default)((function*(){const{product:t,catalog:s,newProduct:a}=e.props;if(a)e.setState({isComplianceInfoAvailable:!0});else{yield f.default.findProduct({catalogWid:s.id,productId:t.id.toString(),shouldFetchComplianceFields:!0});const a=(0,d.default)(s,"catalog").productCollection.get(t.id),{countryCodeOrigin:i,importerName:n,importerAddress:o}=(null==a?void 0:a.complianceInfo)||{},l=i&&(yield(0,_.getCountryName)(i)),r=(null==o?void 0:o.countryCode)&&(yield(0,_.getCountryName)(o.countryCode));e.setState({isComplianceInfoAvailable:!0,complianceInfo:{countryCodeOrigin:i||"",countryNameOrigin:l||"",countryCodeOriginError:"",importerName:n||"",importerAddress:{street1:(null==o?void 0:o.street1)||"",street1Error:"",street2:(null==o?void 0:o.street2)||"",postalCode:(null==o?void 0:o.postalCode)||"",city:(null==o?void 0:o.city)||"",cityError:"",region:(null==o?void 0:o.region)||"",countryCode:(null==o?void 0:o.countryCode)||"",countryName:r||"",countryCodeError:""}}})}}))()}isValid(){const{name:e,nameError:t,priceError:s,urlError:a,retailerIdError:i,imageError:n,hasImages:o,complianceInfo:l}=this.state;return""!==e&&!1!==o&&[t,s,a,i,n,null==l?void 0:l.importerAddress.street1Error,null==l?void 0:l.importerAddress.cityError,null==l?void 0:l.importerAddress.countryCodeError].every((e=>!e))}render(){var e;const{catalog:t,product:s,onBack:a,onCancel:i,newProduct:n}=this.props,{isUpdating:o,isDragging:r,currency:d,nameError:c,priceError:u,urlError:f,retailerIdError:m,imageError:g,complianceInfo:_,isComplianceInfoAvailable:v}=this.state,E=(0,z.jsx)(h.default,{type:"primary",onClick:this._handleSaveItem,disabled:!this.isValid(),a8nText:"product-edit-drawer-save-button",children:n?w.default.t(246):w.default.t(1564)}),M=(0,z.jsxs)("div",{className:I.default.drawerHeader,children:[(0,z.jsx)(G.TextHeader,{level:"2",weight:"normal",customSize:"inherit",children:n?w.default.t(557):w.default.t(558)}),(0,z.jsx)("div",{className:I.default.drawerHeaderButtonContainer,children:E})]}),T=n?null:(0,z.jsx)("div",{className:I.default.deleteButtonContainer,children:(0,z.jsx)(h.default,{type:"warning",onClick:this._handleDeleteItem,a8nText:"product-edit-drawer-delete-button",children:w.default.t(752)})}),b=(0,l.default)(I.default.productWrapper,{[I.default.isSending]:o}),L=r?(0,z.jsx)(x.default,{}):null,D=o?(0,z.jsx)("div",{className:I.default.spinner,children:(0,z.jsx)(B.default,{size:50,stroke:3})}):null,O=(0,z.jsxs)("div",{className:I.default.hiddenContainer,children:[(0,z.jsx)(p.default,{id:"product-hidden-check",onChange:this._handleHiddenChange,checked:this.state.isHidden,disabled:!1}),(0,z.jsx)("label",{className:I.default.hiddenLabel,htmlFor:"product-hidden-check",children:w.default.t(530)}),(0,z.jsx)("div",{className:I.default.hiddenDescr,children:w.default.t(529)})]});return(0,z.jsxs)(S.default,{theme:"catalog",onDrop:this.handleDrop,onDragChange:this.handleDragChange,children:[L,(0,z.jsx)(j.default,{a8n:"catalog-link-title",title:M,type:j.DRAWER_HEADER_TYPE.SMALL,onBack:a,onCancel:i,focusBackOrCancel:!0}),(0,z.jsx)(y.default,{children:(0,z.jsxs)("div",{className:b,children:[D,(0,z.jsx)(A.default,{product:s,maxImageCount:N.MAX_PRODUCT_IMAGES,onChange:this._handleImageChange,ref:this._imagePanelRef,error:g}),(0,z.jsx)(H.default,{a8n:"product-edit-drawer-name-input",value:this.state.name,placeholder:w.default.t(1097),onChange:this._handleNameChange,theme:"small",customStyleThemes:["desaturated"],maxLength:150,error:c,title:w.default.t(52)}),(0,z.jsx)(H.default,{a8n:"product-edit-drawer-price-input",value:this.state.priceStr,placeholder:w.default.t(1098,{currencySymbol:C.formatAmount1000ToParts(d,0).symbol}),onChange:this._handlePriceChange,theme:"small",maxLength:30,customStyleThemes:["desaturated"],error:u,title:w.default.t(53)}),(0,z.jsx)(H.default,{a8n:"product-edit-drawer-description-input",value:this.state.description,placeholder:w.default.t(1095),onChange:this.handleDescriptionChange,theme:"small",maxLength:5e3,customStyleThemes:["desaturated"],multiline:!0,title:w.default.t(49)}),(0,z.jsx)(H.default,{a8n:"product-edit-drawer-link-input",value:this.state.url,placeholder:w.default.t(1096),onChange:this._handleUrlChange,onBlur:this._handleUrlBlur,theme:"small",customStyleThemes:["desaturated"],maxLength:75,error:f,managed:!0,title:w.default.t(51)}),(0,z.jsx)(H.default,{a8n:"product-edit-drawer-retailer-id-input",value:this.state.retailerId,placeholder:w.default.t(1094),onChange:this._handleRetailerIdChange,theme:"small",customStyleThemes:["desaturated"],maxLength:100,error:m,title:w.default.t(50)}),(0,P.canSeeECommerceComplianceIndiaBusinessJourney)(t.id.user)?(0,z.jsx)(Y,{isComplianceInfoAvailable:v,showComplianceInfoImporterAddress:this._showComplianceInfoImporterAddress(null===(e=this.state.complianceInfo)||void 0===e?void 0:e.countryCodeOrigin),complianceInfo:_,onComplianceInfoChange:this._handleComplianceInfoChange,onComplianceInfoImporterAddressChange:this._handleComplianceInfoImporterAddressChange}):null,O,T]})})]},"catalog-link-drawer")}}function Y({isComplianceInfoAvailable:e,showComplianceInfoImporterAddress:t,complianceInfo:s,onComplianceInfoChange:a,onComplianceInfoImporterAddressChange:i}){const n=e=>{const{street1:t,city:a,countryCode:i}=(null==s?void 0:s.importerAddress)||{};return t||a||i?e:`${e} (${w.default.t(1478)})`};return e?(0,z.jsxs)("div",{a8n:"product-edit-drawer-compliance",children:[(0,z.jsx)(H.default,{a8n:"product-edit-drawer-compliance-country-of-origin-input",value:null==s?void 0:s.countryNameOrigin,placeholder:w.default.t(1466),onChange:()=>{},theme:"small",customStyleThemes:["desaturated"],managed:!0,onFocus:()=>m.default.showCountrySelector(w.default.t(1466),null==s?void 0:s.countryCodeOrigin,(e=>{a("countryCodeOrigin",e)}))}),(0,z.jsx)(H.default,{a8n:"product-edit-drawer-compliance-importer-name-input",value:null==s?void 0:s.importerName,placeholder:w.default.t(1477),onChange:e=>{a("importerName",e)},theme:"small",customStyleThemes:["desaturated"],maxLength:100}),t&&(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(H.default,{a8n:"product-edit-drawer-compliance-importer-address-street-1-input",value:null==s?void 0:s.importerAddress.street1,placeholder:n(w.default.t(1474)),onChange:e=>{i("street1",e)},theme:"small",customStyleThemes:["desaturated"],maxLength:g.default.COMPLIANCE_INFO_LENGTH.STREET1,error:null==s?void 0:s.importerAddress.street1Error}),(0,z.jsx)(H.default,{a8n:"product-edit-drawer-compliance-importer-address-street-2-input",value:null==s?void 0:s.importerAddress.street2,placeholder:w.default.t(1476),onChange:e=>{i("street2",e)},theme:"small",customStyleThemes:["desaturated"],maxLength:g.default.COMPLIANCE_INFO_LENGTH.STREET2}),(0,z.jsx)(H.default,{a8n:"product-edit-drawer-compliance-importer-address-city-input",value:null==s?void 0:s.importerAddress.city,placeholder:n(w.default.t(1468)),onChange:e=>{i("city",e)},theme:"small",customStyleThemes:["desaturated"],maxLength:g.default.COMPLIANCE_INFO_LENGTH.CITY,error:null==s?void 0:s.importerAddress.cityError}),(0,z.jsx)(H.default,{a8n:"product-edit-drawer-compliance-importer-address-region-input",value:null==s?void 0:s.importerAddress.region,placeholder:w.default.t(1473),onChange:e=>{i("region",e)},theme:"small",customStyleThemes:["desaturated"],maxLength:g.default.COMPLIANCE_INFO_LENGTH.REGION}),(0,z.jsx)(H.default,{a8n:"product-edit-drawer-compliance-importer-address-country-code-input",value:null==s?void 0:s.importerAddress.countryName,placeholder:n(w.default.t(1470)),onChange:()=>{},theme:"small",customStyleThemes:["desaturated"],managed:!0,onFocus:()=>m.default.showCountrySelector(w.default.t(1470),null==s?void 0:s.importerAddress.countryCode,(e=>{i("countryCode",e)})),error:null==s?void 0:s.importerAddress.countryCodeError}),(0,z.jsx)(H.default,{a8n:"product-edit-drawer-compliance-importer-address-postal-code-input",value:null==s?void 0:s.importerAddress.postalCode,placeholder:w.default.t(1472),onChange:e=>{i("postalCode",e)},theme:"small",customStyleThemes:["desaturated"],maxLength:g.default.COMPLIANCE_INFO_LENGTH.POSTAL_CODE})]})]}):(0,z.jsx)(T.FlexRow,{align:"center",justify:"center",children:(0,z.jsx)(T.FlexItem,{children:(0,z.jsx)(B.default,{})})})}t.EditProductDrawer=K,K.contextType=E.default,K.CONCERNS={product:["id","additionalImageCdnUrl","name","priceAmount1000","description","productImageCollection","reviewStatus","url","imageCdnUrl","retailerId","currency","isHidden","complianceInfo"]},K.displayName="EditProductDrawer";var q=(0,L.default)((0,F.default)((0,U.default)((0,D.default)(K),K.CONCERNS)));t.default=q},60879:(e,t,s)=>{"use strict";var a=s(20862),i=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{onBack:t,onAddProductClick:s,onCatalogAlreadyCreated:a}=e,[i,L]=(0,l.useState)(!1),w=(0,P.jsx)("div",{className:E.default.placeholderIcon}),D=(0,P.jsx)(c.default,{href:h.default.FB_LEGAL_TERMS_URL,onClick:e=>{e.preventDefault(),(0,C.openExternalLink)(h.default.FB_LEGAL_TERMS_URL)},children:x.default.t(894)}),O=(0,P.jsx)(c.default,{href:h.default.FB_COMMERCE_POLICY_URL,onClick:e=>{e.preventDefault(),(0,C.openExternalLink)(h.default.FB_COMMERCE_POLICY_URL)},children:x.default.t(893)}),N=(0,P.jsx)(c.default,{href:h.default.WA_COMMERCE_POLICY_URL,onClick:e=>{e.preventDefault(),(0,C.openExternalLink)(h.default.WA_COMMERCE_POLICY_URL)},children:x.default.t(2230)}),R=(0,P.jsx)(S.default,{id:524,params:{fb_product_link:D,fb_commerce_link:O,wa_commerce_policy_link:N}});const k=(0,n.default)({[E.default.isLoading]:i}),A=i?(0,P.jsx)("div",{className:E.default.spinner,children:(0,P.jsx)(M.default,{size:50,stroke:3})}):null,F=i?(0,P.jsx)(r.default,{onClick:()=>{},theme:"default",idle:!!i}):(0,P.jsx)(m.default.Consumer,{children:e=>(0,P.jsx)(r.default,{onClick:()=>{!function(e){L(!0),(0,y.logCreateProductCatalogClick)(e),(0,j.createCatalog)().then((()=>{(0,y.logCreateProductCatalogSuccess)(e),s()})).catch((0,o.filteredCatch)(v.ServerStatusCodeError,(t=>{(0,y.logCreateProductCatalogFailed)(e,t.statusCode),u.default.openToast((0,P.jsx)(b.default,{msg:x.default.t(878),id:(0,b.genId)("err_catalog_already_created")})),a()}))).finally((()=>{L(!1)}))}((0,I.getProductCatalogContext)(e))},theme:"default",idle:!1})});return(0,P.jsxs)(f.default,{children:[(0,P.jsx)(g.default,{title:x.default.t(1464),type:g.DRAWER_HEADER_TYPE.LARGE,onBack:t}),(0,P.jsx)(p.default,{className:k,children:(0,P.jsxs)(_.default,{theme:"padding-small",animation:!1,children:[A,(0,P.jsx)(T.TextDiv,{theme:"title",children:x.default.t(497)}),F,(0,P.jsx)(T.TextDiv,{theme:"plain",children:R}),(0,P.jsxs)("div",{className:E.default.placeholderContainer,children:[(0,P.jsx)(d.default,{theme:"add-item-placeholder",image:w,customImage:!0,className:E.default.addItemPlaceholder,primary:"",secondary:"",idle:!0}),(0,P.jsx)("div",{className:E.default.divider}),(0,P.jsx)(d.default,{theme:"add-item-placeholder",image:w,customImage:!0,className:E.default.addItemPlaceholder,primary:"",secondary:"",idle:!0}),(0,P.jsx)("div",{className:E.default.divider})]})]})})]},"catalog-link-drawer")};var n=i(s(94184)),o=s(55084),l=s(67294),r=i(s(32179)),d=i(s(55092)),c=i(s(44683)),u=i(s(91952)),h=i(s(55454)),f=i(s(17747)),p=i(s(9042)),m=i(s(79864)),g=a(s(55588)),_=i(s(25061)),v=s(54647),C=s(4919),x=i(s(2408)),S=i(s(663)),y=s(30333),E=i(s(97721)),j=s(94583),I=s(70790),M=i(s(46714)),T=s(97504),b=a(s(49201)),P=s(85893)},21792:(e,t,s)=>{"use strict";var a=s(20862),i=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.ProductInfoDrawer=void 0;var n=s(67294),o=i(s(69991)),l=i(s(17747)),r=i(s(9042)),d=i(s(79864)),c=a(s(55588)),u=i(s(25061)),h=i(s(52715)),f=s(86723),p=i(s(52087)),m=i(s(2408)),g=s(30333),_=s(68793),v=s(70790),C=s(26491),x=i(s(45858)),S=i(s(10462)),y=i(s(43368)),E=i(s(29513)),j=i(s(51587)),I=i(s(79485)),M=i(s(22360)),T=s(97504),b=s(85893);class P extends n.Component{constructor(e){super(e),this.handleEditProduct=()=>{const{product:e}=this.props;this.props.onEditProduct&&this.props.onEditProduct(e)},this.handleShareProduct=()=>{const{product:e}=this.props;this.props.onShareProduct&&this.props.onShareProduct(e)},this.handleSendChat=()=>{this.props.onCancel(),(0,_.sendProductToChat)(this.props.product,this.props.catalog),(0,g.logProductMessageBusinessClick)(this.props.product,(0,v.getProductCatalogContext)(this.context))},this.state={isLoading:!0}}componentDidMount(){const{catalog:e,product:t,collectionId:s}=this.props;e.pullProduct(t.id.toString()).finally((()=>{this.setState({isLoading:!1})})),(0,g.logProductDetailView)({product:t,catalogContext:(0,v.getProductCatalogContext)(this.context),collectionId:s})}render(){const{product:e,onCancel:t,collectionId:s}=this.props,a=(0,f.getMaybeMeUser)(),i=M.default.get(a),n=(0,b.jsx)(T.TextDiv,{theme:"muted",className:S.default.businessInfoTitle,children:m.default.t(433)}),d=e.reviewStatus!==C.PRODUCT_REVIEW_STATUS.APPROVED||e.isHidden,p=(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:S.default.buttonSeparator,children:(0,b.jsx)(o.default,{type:"strong",onClick:this.handleEditProduct,a8nText:"product-info-drawer edit-button",children:m.default.t(798)})}),(0,b.jsx)(o.default,{type:"strong-primary",onClick:this.handleShareProduct,disabled:d,a8nText:"product-info-drawer share-button",children:m.default.t(2153)})]}),g=(0,b.jsxs)("div",{className:S.default.drawerHeader,children:[(0,b.jsx)("div",{className:S.default.productName,children:e.name}),(0,b.jsx)("div",{className:S.default.drawerHeaderButtonContainer,children:p})]}),_=i?(0,b.jsx)(u.default,{title:n,theme:"no-padding",children:(0,b.jsx)(j.default,{status:i})}):null,v=this.state.isLoading?(0,b.jsx)(h.default,{}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(E.default,{product:e,isAvailable:!0,fetching:!1}),(0,b.jsx)(y.default,{product:e}),(0,b.jsx)(x.default,{product:e,collectionId:s,onSendChat:this.handleSendChat,isAvailable:!0})]});return(0,b.jsxs)(l.default,{theme:"catalog",children:[(0,b.jsx)(c.default,{a8n:"catalog-product-title",title:g,type:c.DRAWER_HEADER_TYPE.SMALL,onCancel:t,headingLevel:"2",focusBackOrCancel:!0}),(0,b.jsxs)(r.default,{children:[(0,b.jsx)(u.default,{theme:"center-column-fixed-width",children:v}),(0,b.jsx)("div",{className:S.default.productWrapper,children:_})]})]},"catalog-link-drawer")}}t.ProductInfoDrawer=P,P.contextType=d.default,P.CONCERNS={product:["id","catalogWid","name","priceAmount1000","description","productImageCollection","reviewStatus","url","canAppeal","imageCdnUrl","retailerId","currency","isHidden"]},P.displayName="ProductInfoDrawer";var L=(0,p.default)((0,I.default)(P,P.CONCERNS));t.default=L},43368:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{product:t}=e;const s=(0,v.jsx)(o.default,{href:r.default.WA_COMMERCE_POLICY_URL,onClick:e=>{e.preventDefault(),(0,c.openExternalLink)(r.default.WA_COMMERCE_POLICY_URL)},children:u.default.t(1103)});if(t.reviewStatus===p.PRODUCT_REVIEW_STATUS.APPROVED)return t.isHidden?(0,v.jsxs)("div",{className:m.default.root,children:[(0,v.jsx)("div",{className:m.default.icon,children:(0,v.jsx)(g.default,{name:"hide"})}),(0,v.jsx)("div",{className:m.default.text,children:(0,v.jsx)(_.TextDiv,{children:u.default.t(1482)})})]}):null;if(t.reviewStatus===p.PRODUCT_REVIEW_STATUS.REJECTED){if(!0===t.canAppeal){const e=(0,v.jsx)(h.default,{id:532,params:{learn_more_link:s}}),a=(0,v.jsx)(o.default,{onClick:function(){l.default.openModal((0,v.jsx)(d.default.Consumer,{children:e=>(0,v.jsx)(n.default,{product:t,sessionId:(0,f.getProductCatalogSessionId)(e)})}))},a8n:"product-appeal-button",children:u.default.t(533)}),r=(0,v.jsx)(h.default,{id:525,params:{request_review_link:a},className:m.default.appealText,tabIndex:"0"});return(0,v.jsxs)("div",{className:m.default.root,"data-a8n":i.default.key("product-appeal-rejected-initial-review"),children:[(0,v.jsx)("div",{className:m.default.icon,children:(0,v.jsx)(g.default,{name:"info"})}),(0,v.jsxs)("div",{className:m.default.text,children:[e,r]})]})}{const e=(0,v.jsx)(h.default,{id:527,params:{learn_more_link:s}});return(0,v.jsx)("div",{className:m.default.root,"data-a8n":i.default.key("product-appeal-rejected-final"),children:e})}}if(t.reviewStatus===p.PRODUCT_REVIEW_STATUS.NO_REVIEW||t.reviewStatus===p.PRODUCT_REVIEW_STATUS.OUTDATED){const e=t.isHidden?(0,v.jsx)(h.default,{id:542,params:{learn_more_link:s}}):(0,v.jsx)(h.default,{id:541,params:{learn_more_link:s}});return(0,v.jsx)("div",{className:m.default.root,"data-a8n":i.default.key("product-appeal-pending-initial-review"),children:e})}if(!1===t.canAppeal){const e=u.default.t(526);return(0,v.jsx)("div",{className:m.default.root,"data-a8n":i.default.key("product-appeal-pending-appeal"),children:e})}return null};var i=a(s(76610)),n=a(s(12716)),o=a(s(44683)),l=a(s(91952)),r=a(s(55454)),d=a(s(79864)),c=s(4919),u=a(s(2408)),h=a(s(663)),f=s(70790),p=s(26491),m=a(s(72974)),g=a(s(2966)),_=s(97504),v=s(85893)},51587:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(67294),n=a(s(55092)),o=a(s(9322)),l=a(s(88419)),r=s(86723),d=a(s(52087)),c=a(s(79485)),u=s(85893);class h extends i.Component{constructor(e){super(e)}render(){const{status:e}=this.props;return(0,u.jsx)(n.default,{image:(0,u.jsx)(l.default,{id:(0,r.getMaybeMeUser)()}),primary:o.default.pushname,secondary:e.status,idle:!0})}}h.CONCERNS={status:["status"]},h.displayName="ProfileLockup";var f=(0,d.default)((0,c.default)(h,h.CONCERNS));t.default=f},65587:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function({businessProfile:e,catalog:t}){const s=(0,n.hasShop)(e),a=Boolean(s&&u.default.shopsProductGrid);if((0,i.useEffect)((()=>{(0,d.logShopsManagementEvent)(c.default.SHOPS_MANAGEMENT_ACTION.ACTION_SHOPS_PRODUCT_PREVIEW_VISIBLE,{shouldLogJid:!1,isShopsProductPreviewVisible:a})}),[a]),s)return a?(0,f.jsx)(h.default,{isEditMode:!0,subtitle:r.default.t(1160),businessProfile:e,catalog:t,productsToShow:3}):null;return(0,f.jsx)(o.default,{catalog:t,onProductDetail:p,onProductCatalog:p,productsToShow:3,catalogEntryLabel:null==t?r.default.t(233):r.default.t(1796),showProductPlaceholders:!0,seeMoreOverlay:!0,sectionTheme:"refresh"})};var i=s(67294),n=s(47874),o=a(s(22715)),l=s(77512),r=a(s(2408)),d=s(29931),c=a(s(4231)),u=a(s(65565)),h=a(s(56605)),f=s(85893);function p(){(0,l.openCatalogManagementFlow)(null,c.default.CATALOG_ENTRY_POINT.CATALOG_ENTRY_POINT_PROFILE)}},38265:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(67294),n=a(s(91749)),o=a(s(48567)),l=a(s(47452)),r=a(s(85051)),d=a(s(2408)),c=a(s(2966)),u=a(s(63477)),h=a(s(68062)),f=s(85893);class p extends i.Component{constructor(...e){super(...e),this.state={active:!1,contextMenu:null},this.handleDelete=e=>{e.preventDefault(),e.stopPropagation(),this.props.onDelete&&this.props.onDelete(this.props.collection)},this.handleEdit=e=>{e.preventDefault(),e.stopPropagation(),this.props.onEdit&&this.props.onEdit(this.props.collection)},this.handleSeeCollection=e=>{e.preventDefault(),e.stopPropagation(),this.props.onSeeCollection&&this.props.onSeeCollection(this.props.collection)},this.removeContext=()=>{this.setState({contextMenu:null})},this.handleContext=e=>{if(this.state.contextMenu)return void this.setState({contextMenu:null});const t=[];this.props.canManage&&(t.push((0,f.jsx)(l.default,{a8n:"mi-show-label",action:this.handleEdit,children:d.default.t(508)},"EditLabel")),t.push((0,f.jsx)(l.default,{a8n:"mi-show-label",action:this.handleDelete,children:d.default.t(506)},"DeleteLabel"))),this.setState({contextMenu:{menu:t,event:e.event,anchor:e.anchor}})}}render(){const{collection:e,theme:t}=this.props,s=(0,f.jsx)("div",{className:o.default.collectionIcon,children:(0,f.jsx)("div",{className:o.default.iconContainer,children:(0,f.jsx)(c.default,{name:"collections_folder"})})}),a=(0,f.jsx)(r.default,{text:e.name,ellipsify:!0,titlify:!0});let i;return this.state.contextMenu&&(i=(0,f.jsx)(u.default,{displayName:"CollectionContextMenu",escapable:!0,popable:!0,requestDismiss:this.removeContext,children:(0,f.jsx)(h.default,{contextMenu:this.state.contextMenu})})),(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(n.default,{customImage:!0,image:s,primary:a,theme:t,active:this.state.active,contextEnabled:()=>this.props.canManage,onContext:this.handleContext,onClick:this.handleSeeCollection},e.id.toString()),i]})}}p.defaultProps={theme:"collection-edit",isMuted:!1},p.displayName="CollectionManageListItem";var m=p;t.default=m},22120:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{data:t,canManage:s,onEditCollection:a,onSeeCollection:p}=e,m=(0,h.default)(e.catalog,["collections"]);return(0,f.jsx)(d.default,{flatListControllers:[e.flatListController],children:(0,f.jsx)(r.default,{flatListController:e.flatListController,direction:"vertical",forceConsistentRenderCount:!1,data:(()=>{const e=[];return t.forEach((t=>{t.collection&&e.push({itemKey:t.collection.id,collection:t.collection})})),e})(),renderItem:({collection:e})=>(0,f.jsx)(l.default.Consumer,{children:t=>(0,f.jsx)(n.default,{collection:e,canManage:s,onDelete:()=>((e,t)=>{(0,i.handleCollectionDelete)((0,u.unproxy)(m),e,t)})(e,(0,c.getProductCatalogContext)(t)),onEdit:a,onSeeCollection:p})}),defaultItemHeight:o.default.PRODUCT_LIST_ITEM_HEIGHT})})};var i=s(96470),n=a(s(38265)),o=a(s(55454)),l=a(s(79864)),r=a(s(86025)),d=a(s(19257)),c=s(70790),u=s(15298),h=a(s(76006)),f=s(85893)},34114:(e,t,s)=>{"use strict";var a=s(20862),i=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.CollectionsManagementDrawer=void 0;var n=i(s(48926)),o=i(s(23493)),l=i(s(23279)),r=s(67294),d=i(s(32179)),c=i(s(60028)),u=s(46215),h=i(s(22120)),f=i(s(12156)),p=i(s(55454)),m=i(s(17747)),g=i(s(9042)),_=a(s(55588)),v=i(s(67893)),C=i(s(52715)),x=s(86723),S=i(s(2408)),y=i(s(71681)),E=i(s(40630)),j=s(85893);class I extends r.Component{constructor(e){super(e),this._catalogFlatListController=new v.default,this._handleScroll=(e,t)=>{var s,a;this.props.setScrollOffset&&this.props.setScrollOffset(t.scrollTop),(null===(s=this.state.scrollHelper)||void 0===s?void 0:s.willLoadMore(t))&&this.setState({loadingMore:!0}),null===(a=this.state.scrollHelper)||void 0===a||a.onScroll(e,t).then((e=>{e&&this.setState({loadingMore:!1})})).catch((e=>{throw this.setState({loadingMore:!1}),e}))},this.handleScroll=(0,o.default)(this._handleScroll,100),this.onScroll=e=>{this.handleScroll(e,e.currentTarget)},this.state={loadingMore:!0,dataSource:null,scrollHelper:null}}componentDidMount(){const e=this.getCatalog();if(e){const t=new u.CollectionsDataSource(e,!0,p.default.PRODUCT_LIST_ITEM_HEIGHT);e.collections.on("add",(0,l.default)((()=>this.forceUpdate()),100)),e.collections.on("remove",(0,l.default)((()=>this.forceUpdate()),100));const s=new u.CatalogListItemScrollHelper(t);this.setState({dataSource:t,scrollHelper:s},(()=>{this.loadInitialItems()}))}}getCatalog(){const e=(0,x.getMeUser)();return c.default.get(e)}getDrawerContent(){const e=this.getCatalog(),t=this.state.dataSource;return e&&t?(0,j.jsxs)("div",{children:[(0,j.jsx)(d.default,{onClick:()=>{this.props.editCollection(null)},theme:"collections",title:S.default.t(511)}),(0,j.jsx)(h.default,{canManage:!0,catalog:e,onEditCollection:this.props.editCollection,data:t.getData(),flatListController:this._catalogFlatListController,onSeeCollection:this.props.onSeeCollection}),this.state.loadingMore&&(0,j.jsx)("div",{className:f.default.loadingSpinner,children:(0,j.jsx)(C.default,{})})]}):null}loadInitialItems(){var e=this;return(0,n.default)((function*(){const{dataSource:t}=e.state;yield null==t?void 0:t.loadInitialItems(),e.setState({loadingMore:!1})}))()}render(){return(0,j.jsxs)(m.default,{theme:"products",onDrop:this.props.onBack,children:[(0,j.jsx)(_.default,{title:S.default.t(515),type:_.DRAWER_HEADER_TYPE.LARGE,onBack:this.props.onBack,menu:(0,j.jsx)(j.Fragment,{})}),(0,j.jsx)(g.default,{onScroll:this.onScroll,flatListControllers:[this._catalogFlatListController],scrollOffset:this.props.scrollOffset,children:this.getDrawerContent()})]})}}t.CollectionsManagementDrawer=I,I.displayName="CollectionsManagementDrawer";var M=(0,E.default)((0,y.default)(I));t.default=M},65248:(e,t,s)=>{"use strict";var a=s(20862),i=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=s(55084),o=s(67294),l=(i(s(56720)),i(s(73754))),r=i(s(91952)),d=i(s(55454)),c=s(54432),u=a(s(13540)),h=i(s(2408)),f=s(57990),p=s(90672),m=s(92954),g=i(s(52937)),_=i(s(62831)),v=i(s(84241)),C=i(s(40630)),x=i(s(2966)),S=a(s(49201)),y=i(s(89135)),E=i(s(82669)),j=s(85893);const I={btnDelete:{position:"lhggkp7q",top:"hdpg1tjz",end:"ltcz4qz9",zIndex:"mb8var44",color:"k17s6i4e",filter:"rhe1kc9j"},btnAdd:{display:"p357zi0d",flexDirection:"f8m0rgwh",alignItems:"gndfcl4n",justifyContent:"ac2vgrno",width:"jkv2xdwy",height:"sptw4ec9",fontSize:"lak21jic",fontWeight:"hnx8ox4h",lineHeight:"gz7w46tb",letterSpacing:"hql59cr1"}};class M extends o.Component{constructor(e){super(e),this.handleAddFileClick=()=>{if(this.refInput){this.refInput.click()}},this.handleFilePick=e=>{(0,c.getFiles)(e,d.default.IMAGE_MIMES).then((e=>{const t=this.props.maxImageCount-this.state.images.length;e.length>t&&r.default.openToast((0,j.jsx)(S.default,{msg:h.default.t(1164),duration:6e3,action:{onAction:()=>{},actionText:h.default.t(947),dismiss:!0,theme:"success"},id:(0,S.genId)()})),e.slice(0,this.props.maxImageCount-this.state.images.length).map((e=>({file:e,filename:e.name,mimetype:e.type,type:m.TYPE.PRODUCT}))).map((e=>{var t;const s=new l.default({file:Promise.resolve(e)});return null===(t=s.processPromise)||void 0===t?void 0:t.then((()=>{this._appendImage(s)}))}))})).checkpoint(this.props.rejectOnUnmount()).catch((0,n.filteredCatch)(u.Unmount,(()=>{}))),e.target&&e.target.value&&(e.target.value="")},this.uploadImages=()=>{const e=this.state.images.filter((e=>null==e.url)).map((e=>(0,f.uploadProductImage)(e.mediaData.mediaBlob,e.mediaData.filehash).then((t=>{e.url=t}))));return Promise.all(e).then((()=>this.state.images.map((e=>e.url||""))))},this.setRefInput=e=>{this.refInput=e};const t=e.product.productImageCollection.filter((e=>!e.old)).map((e=>({url:e.mediaUrl,mediaData:e.mediaData})));this.state={images:t}}_appendImage(e){e.mediaPrep.waitForPrep().then((t=>{if(this._validateImage(t)){t.mediaStage=p.MEDIA_DATA_STAGE.RESOLVED,t.renderableUrl=e.fullPreview;const s=t.mediaBlob;!s||s instanceof g.default||g.default.createFromData(s,s.type).then((e=>{t.mediaBlob=e})),this.setState({images:[...this.state.images,{url:null,mediaData:t}]}),this.props.onChange&&this.props.onChange(this.state.images)}}))}_validateImage(e){return!(this.state.images.filter((t=>t.mediaData.filehash===e.filehash)).length>0)||(r.default.openToast((0,j.jsx)(S.default,{id:(0,S.genId)(),msg:h.default.t(879)})),!1)}_deleteImage(e){const t=this.state.images.filter((t=>t!==e));this.setState({images:t}),this.props.onChange&&this.props.onChange(t)}_renderTiles(){return this.state.images.filter((e=>e.mediaData)).map(((e,t)=>(0,j.jsxs)("div",{className:_.default.imageTile,children:[(0,j.jsx)(y.default,{xstyle:I.btnDelete,"aria-label":h.default.t(41,{imageNumber:t+1}),a8nText:"delete-image",onClick:()=>this._deleteImage(e),children:(0,j.jsx)(x.default,{className:_.default.deleteIcon,name:"x-alt"})}),(0,j.jsx)(v.default,{mediaData:e.mediaData,className:_.default.imageThumb})]},e.mediaData.filehash)))}_renderAddImageButton(){return this.state.images.length<this.props.maxImageCount?(0,j.jsx)("div",{className:_.default.btnAddContainer,children:(0,j.jsxs)(y.default,{xstyle:I.btnAdd,"aria-label":h.default.t(2),onClick:this.handleAddFileClick,a8nText:"add-image",children:[(0,j.jsx)(x.default,{name:"camera"}),(0,j.jsx)("div",{className:_.default.btnAddText,children:h.default.t(496)})]})}):null}_renderFileInput(){return(0,j.jsx)("input",{ref:this.setRefInput,type:"file",accept:d.default.IMAGE_MIMES,style:{display:"none"},onChange:this.handleFilePick,multiple:!0})}renderErrorMessage(){return(0,j.jsx)("div",{className:_.default.errorMessage,role:"alert",children:this.props.error})}render(){return(0,j.jsxs)("div",{className:_.default.panel,children:[(0,j.jsxs)("div",{className:_.default.tileContainer,children:[(0,j.jsxs)(E.default,{transitionAppear:!0,transitionName:"thumb-scale-flex",children:[this._renderTiles(),this._renderAddImageButton()]}),this._renderFileInput()]}),this.renderErrorMessage()]})}}M.displayName="ProductImagesEditPanel";var T=(0,C.default)(M);t.default=T},38666:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function({flatListController:e,onProductDetail:t,productMessageList:s}){const a=s.productCollection.getProductModels(),C=s.getSections(),x=s.getSectionsCount()>0,S=s.getTotalProductsFetchedOrFailed(),y=s.getProductSize()===S&&0===a.length,E=[];C.forEach((({title:e,products:t},s)=>{const i=[];t.forEach((({productId:e})=>{const t=a.find((t=>t.id===e));null!=t&&i.push({itemKey:`section-${s}-${t.id.toString()}`,product:t,type:"product",height:l.default.PRODUCT_LIST_ITEM_HEIGHT})})),i.length>0&&(null!=e&&""!==e&&E.push({itemKey:`header-${s}-${e}`,label:e,type:"section",height:72}),E.push(...i))}));const j=(0,n.useCallback)(((e,s)=>((0,u.logCatalogListDetailClick)({product:(0,_.unproxy)(e),catalogContext:s}),t(e))),[t]),I=(0,n.useCallback)((e=>{let t=null;switch(e.type){case"section":const{label:s}=e;t=(0,v.jsx)(g.default,{header:s});break;case"product":const{product:a}=e;t=(0,v.jsx)(r.default.Consumer,{children:e=>(0,v.jsx)(f.default,{product:a,onClick:()=>j(a,(0,h.getProductCatalogContext)(e)),canManageCatalog:!1})})}return t}),[j]);return(0,n.useEffect)((()=>{y&&o.default.openModal((0,v.jsx)(m.default,{onConfirm:()=>{o.default.closeDrawerRight(),o.default.closeModal()}}))}),[y]),(0,v.jsx)("div",{className:(0,i.default)({[p.default.list]:!0,[p.default.noSections]:!x}),children:(0,v.jsx)(c.default,{flatListControllers:[e],children:(0,v.jsx)(d.default,{flatListController:e,direction:"vertical",forceConsistentRenderCount:!1,data:E,renderItem:I,itemEnterAnimationsEnabled:!0})})})};var i=a(s(94184)),n=s(67294),o=a(s(91952)),l=a(s(55454)),r=a(s(79864)),d=a(s(86025)),c=a(s(19257)),u=s(30333),h=s(70790),f=a(s(34290)),p=a(s(30781)),m=a(s(72126)),g=a(s(37314)),_=s(15298),v=s(85893)},36873:(e,t,s)=>{"use strict";var a=s(20862),i=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.ProductMessageListDrawer=void 0;var n=i(s(23493)),o=s(55084),l=s(67294),r=i(s(25523)),d=i(s(5221)),c=i(s(39618)),u=i(s(55454)),h=i(s(17747)),f=i(s(9042)),p=i(s(79864)),m=a(s(55588)),g=i(s(85051)),_=a(s(13540)),v=s(28379),C=i(s(8212)),x=i(s(67893)),S=i(s(52715)),y=i(s(2408)),E=i(s(71681)),j=s(20232),I=s(47941),M=s(70790),T=i(s(38666)),b=i(s(97038)),P=i(s(31025)),L=i(s(40630)),w=i(s(79485)),D=s(74289),O=s(85893);class N extends l.Component{constructor(e){super(e),this._productListFlatListController=new x.default,this._handleScroll=e=>{this.state.loadingMore||e.scrollTop+u.default.SCROLL_FUDGE>e.scrollHeight-e.clientHeight&&this._loadMoreProduct()},this.handleScroll=(0,n.default)(this._handleScroll,100),this._loadMoreProduct=()=>{const{productListId:e}=this.props,{stopLoading:t,loadedProducts:s}=this.state;if(t)return;const a=b.default.assertGet(e),i=a.getTotalProductsFetchedOrFailed(),n=a.getProductSize();i!==n?(this.setState({loadingMore:!0,loadedProducts:i}),b.default.update(e).checkpoint(this.props.rejectOnUnmount()).then((e=>{this.setState({loadingMore:!1});(Array.isArray(e)?e[0]:e).getTotalProductsFetchedOrFailed()===s&&this.setState({stopLoading:!0}),i*u.default.PRODUCT_LIST_ITEM_HEIGHT<window.innerHeight&&this._loadMoreProduct()})).catch((0,o.filteredCatch)(_.Unmount,(()=>{}))).catch((()=>{this.setState({loadingMore:!1,stopLoading:!0})}))):this.setState({stopLoading:!0})},this.onScroll=e=>{this.handleScroll(e.currentTarget),this.props.setScrollOffset&&this.props.setScrollOffset(e.currentTarget.scrollTop)},this._handleCartChange=()=>{const e=this.state.cart.itemCount;this.state.cartCount!==e&&this.setState({cartCount:e})},this._handleCartClick=()=>{const{contact:e,onCartClick:t}=this.props;t&&t(e.id.toString())};const t=b.default.get(this.props.productListId),s=r.default.findCart(this.props.contact.id.toString());this.state={loadingMore:!1,loadedProducts:0,stopLoading:!1,productMessageList:t,cart:s,cartCount:s.itemCount,cartEnabled:!1,productMessageListFetchState:t?"SUCCESS":"NONE"}}componentDidMount(){const{listeners:e,contact:t}=this.props;e.add(this.state.cart,"all",this._handleCartChange),this.state.productMessageList?this._loadMoreProduct():this._findProductMessageList(),(0,c.default)(t.id).checkpoint(this.props.rejectOnUnmount()).then((e=>{this.setState({cartEnabled:e})})).catch((0,o.filteredCatch)(_.Unmount,(()=>{})))}_findProductMessageList(){return b.default.find(this.props.productListId).checkpoint(this.props.rejectOnUnmount()).then((e=>{this.setState({productMessageList:e,productMessageListFetchState:"SUCCESS"}),this._loadMoreProduct()})).catch((e=>{(0,v.parseErrorState)(e,(e=>this.setState({productMessageListFetchState:e})))}))}_getDrawerContent(){const{productMessageList:e}=this.state;return e?(0,O.jsx)(O.Fragment,{children:(0,O.jsxs)("div",{children:[(0,O.jsx)(T.default,{productMessageList:e,flatListController:this._productListFlatListController,onProductDetail:this.props.onProductDetail}),this.state.loadingMore&&(0,O.jsx)(S.default,{})]})}):(0,O.jsx)(C.default,{fetchState:this.state.productMessageListFetchState})}_getCartIcon(){const{onCartClick:e,contact:t}=this.props;if(e&&this.state.cartEnabled){const e=this.state.cartCount,s=(0,D.isNumber)(e)&&e>0?e.toString():void 0,a=(0,j.getOnCartClickWithLog)(this._handleCartClick,t.id.toString(),(0,M.getProductCatalogContext)(this.context));return(0,O.jsx)(I.MenuBarItem,{a8nText:"menu-bar-cart-link",icon:(0,O.jsx)(d.default,{theme:"inherit-color"}),text:s,title:y.default.t(482),onClick:a})}return null}render(){const{productMessageList:e}=this.state;return(0,O.jsxs)(h.default,{theme:"products",onDrop:this.props.onBack,children:[(0,O.jsx)(m.default,{title:(0,O.jsx)("div",{className:P.default.title,children:(0,O.jsx)(g.default,{text:null==e?void 0:e.title,ellipsify:!0})}),type:m.DRAWER_HEADER_TYPE.SMALL,onBack:this.props.onBack,menu:this._getCartIcon()}),(0,O.jsx)(f.default,{onScroll:this.onScroll,flatListControllers:[this._productListFlatListController],scrollOffset:this.props.scrollOffset,children:this._getDrawerContent()})]})}}t.ProductMessageListDrawer=N,N.contextType=p.default,N.CONCERNS={contact:["id"]},N.displayName="ProductMessageListDrawer";var R=(0,L.default)((0,E.default)((0,w.default)(N,N.CONCERNS)));t.default=R},72126:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function({onConfirm:e}){return(0,l.jsx)(i.default,{onOK:e,okText:o.default.t(2085),children:(0,l.jsx)(n.default,{text:o.default.t(1485)})})};var i=a(s(75940)),n=a(s(85051)),o=a(s(2408)),l=s(85893)},63389:(e,t,s)=>{"use strict";var a=s(20862),i=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(s(7900)),o=s(67294),l=i(s(60028)),r=i(s(2408)),d=a(s(57774)),c=i(s(11546)),u=s(85893);const h=(e,t)=>{const[s,a]=(0,o.useState)(!1),[i,h]=(0,o.useState)([]),f=(0,u.jsx)(c.default,{disabled:!s,onClick:()=>{var t;const s=(0,n.default)(null===(t=i[0])||void 0===t?void 0:t.catalogWid,"products[0]?.catalogWid"),a=(0,n.default)(l.default.get(s),"CatalogCollection.get(catalogWid)");e.onShare(a)}});return(0,u.jsx)(d.default,{ref:t,title:r.default.t(1627),onCancel:e.onCancel,onConfirm:e.onConfirm,listType:d.ListType.PRODUCT_SELECT_MODAL,enableSearchBox:!1,customHeader:f,onSelectionChanged:(e,t,s)=>{a(0===s.length)},onDataLoaded:e=>{const t=e;h(t),a(t.length>0)}})};var f=(0,o.forwardRef)(h);t.default=f},11546:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const t=e.disabled?l.default.disabled:"",s=e.disabled?null:e.onClick,a=(0,d.jsx)("span",{className:l.default.title,children:n.default.t(1461)}),c=(0,d.jsx)(o.default,{theme:"compact",disabled:e.disabled,children:(0,d.jsx)(r.default,{name:"catalog"})});return(0,d.jsx)(i.default,{image:c,onClick:s,primary:a,theme:"list-button-compact",className:t})};var i=a(s(55092)),n=a(s(2408)),o=a(s(80091)),l=a(s(42082)),r=a(s(2966)),d=s(85893)},55922:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const t=(0,d.default)(e.statusV3,["id","t","hasUnread","unreadCount","totalCount","contact"]),s=(0,d.default)(e.contact,["formattedName","statusMute"]),a=(0,i.default)({[l.default.dimmed]:s.statusMute}),u=o.default.relativeDateAndTimeStr(t.t);return(0,c.jsx)(n.default,{className:a,customImage:!0,theme:"status-list",image:(0,c.jsx)(r.default,{statusV3:t,contact:s,onClick:e.onClick}),primary:s.formattedName,secondary:u,onClick:e.onClick,contextEnabled:()=>!1},t.id.toString())};var i=a(s(94184)),n=a(s(91749)),o=a(s(25142)),l=a(s(44710)),r=a(s(51130)),d=a(s(76006)),c=s(85893)},51130:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{theme:t,thumbnailPlaceholder:s,msg:a}=e,n=(0,u.default)(e.statusV3,["lastStatus"]),l=(0,u.default)(e.contact,["statusMute"]),d=null!=a?a:n.lastStatus,p=f(t);let g;g=null!=s?s:d?(0,h.jsx)(o.default,{id:d.sender,theme:"status_v3",size:40}):null;return(0,h.jsxs)("div",{className:(0,i.default)(c.default.container,p),role:e.role||"",onContextMenu:null,onClickCapture:t=>{var s;null===(s=e.onClick)||void 0===s||s.call(e),t.stopPropagation(),t.preventDefault()},children:[l.statusMute||"status-panel"===t?null:(0,h.jsx)(r.default,{statusV3:n}),(0,h.jsx)(m,{msg:d,theme:t,thumbnailPlaceholder:g})]})};var i=a(s(94184)),n=a(s(55454)),o=a(s(88419)),l=a(s(99053)),r=a(s(46929)),d=s(21694),c=a(s(84080)),u=a(s(76006)),h=s(85893);function f(e){return"status-panel"===e?c.default.thumbSizeLarge:c.default.thumbSizeSmall}function p(e){const{msg:t,theme:s}=e;return(0,h.jsx)("div",{className:(0,i.default)(c.default.statusImage,f(s)),style:{backgroundColor:t.statusV3TextBg},children:(0,h.jsx)("div",{className:(0,i.default)(c.default.textThumb,f(s)),children:(0,h.jsx)(d.StatusV3Text,{msg:t,theme:null!=s?s:"status-thumbnail"})})})}function m(e){const{msg:t,theme:s,thumbnailPlaceholder:a}=e,o=f(s),r=c.default.statusImage;return t?t.type===n.default.MSG_TYPE.CHAT?(0,h.jsx)(p,{msg:t,theme:s}):(0,h.jsx)(l.default,{containerClassName:(0,i.default)(c.default.thumbContainer,o,c.default.statusImageFallbackBackground),childClassName:(0,i.default)(r,o),msg:t,thumbnailPlaceholder:a}):(0,h.jsx)("div",{className:(0,i.default)(r,o,c.default.statusImageFallbackBackground)})}},61379:(e,t,s)=>{"use strict";var a=s(20862),i=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.search=function(){return m.apply(this,arguments)};var n=i(s(48926)),o=a(s(13540)),l=i(s(2408)),r=i(s(1458)),d=i(s(40138));const c="https://www.bingapis.com/api/v6/images/search",u="D41D8CD98F00B204E9800998ECF8427E4F4A7492",h="Square",f="Medium",p={ar:"ar-SA",da:"da-DK",de:"de-DE",en:"en-US",es:"es-US",fi:"fi-FI",fr:"fr-FR",it:"it-IT",ko:"ko-KR",nl:"nl-NL",pl:"pl-PL","pt-BR":"pt-BR",ru:"ru-RU",sv:"sv-SE",tr:"tr-TR","zh-CN":"zh-CN","zh-TW":"zh-TW","zh-HK":"zh-HK"};function m(){return(m=(0,n.default)((function*(e,t,s=30){const a={q:e,SafeSearch:"Strict",appid:u,mkt:p[l.default.getLocale()]||p.en,size:f,aspect:h,count:s,offset:t},i=r.default.build(c,a),n=yield d.default.get(i,d.default.RESP_TYPE.JSON);if(!n.response.hasOwnProperty("_type"))throw new o.InvalidServerResponseError(i,status,`Not a valid Bing response: ${JSON.stringify(n.response)}`);if("ErrorResponse"===n.response._type){const t=n.response;throw new o.BingServerError(e,n.status,t)}if("Images"!==n.response._type)throw new o.InvalidServerResponseError(i,status,`Did not receive an image search response, potentially malformed query ${JSON.stringify(n.response)}`);return n.response}))).apply(this,arguments)}},76238:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return S.apply(this,arguments)};var i=a(s(48926)),n=s(29292),o=s(38438),l=s(65971),r=s(85103),d=s(86723),c=s(28535),u=a(s(59e3)),h=s(42847);const f=/^([17]|2[07]|3[0123469]|4[013456789]|5[12345678]|6[0123456]|8[1246]|9[0123458]|\d{3})\d*?(\d{4,6})$/;function p(e){const t=f.exec(function(e){return e.user.split("@")[0]}(e));return o.Binary.build(t?t[1]+t[2]:e.toString()).readByteArray()}function m(e,t){return`00000${256*e.getUint32(t,!1)+e.getUint8(t+4)}`.slice(-5)}function g(){return _.apply(this,arguments)}function _(){return(_=(0,i.default)((function*(e,t){let s=Promise.resolve(o.Binary.build(0,0,t,e).readByteArray());for(let e=0;e<5200;e++)s=s.then((e=>self.crypto.subtle.digest({name:"SHA-512"},o.Binary.build(e,t).readByteArray())));const a=yield s,i=new DataView(a instanceof ArrayBuffer?a.slice(0,30):a.slice(0,30).buffer);return[m(i,0),m(i,5),m(i,10),m(i,15),m(i,20),m(i,25)].join("")}))).apply(this,arguments)}function v(){return C.apply(this,arguments)}function C(){return(C=(0,i.default)((function*(e,t,s,a){return(yield Promise.all([g(e,t),g(s,a)])).sort().join("")}))).apply(this,arguments)}function x(e,t,s,a){const i=new o.Binary;return(0,n.encodeProtobuf)(r.CombinedFingerprintSpec,{version:0,localFingerprint:{publicKey:t,identifier:e},remoteFingerprint:{publicKey:a,identifier:s}},i),i.readBuffer()}function S(){return(S=(0,i.default)((function*(e){const t=(0,d.assertGetMe)(),s=yield(0,l.getFanOutList)([e,t]);try{yield(0,c.ensureE2ESessions)(s)}catch(e){__LOG__(4,void 0,new Error)`ensureE2ESessions with error`}const a=[],i=[];s.forEach((e=>{e.user===t.user?i.push(e):a.push(e)}));try{const t=yield(0,h.getAllIdentityKeysBytesOrThrow)(a),s=yield(0,h.getAllIdentityKeysBytesOrThrow)(i),n=yield u.default.getIdentityKeyPair();if(!n)return __LOG__(3)`getIdentityVerificationData: missing identity for device verification`,null;s.push(new Uint8Array(n.pubKey));const o=(0,h.identityKeysToBinary)(s),l=(0,h.identityKeysToBinary)(t),r=p((0,d.getMeUser)()),c=p(e),f=yield Promise.all([v(r,o,c,l),x(r,o,c,l)]);if(null==f)return null;const[m,g]=f;return{binary:g,string:m}}catch(e){return __LOG__(3)`getIdentityVerificationData: error ${e} when trying to generate identtiy QR code`,null}}))).apply(this,arguments)}},17605:(e,t,s)=>{"use strict";var a=s(20862),i=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,r.promiseLoop)(function(){var t=(0,n.default)((function*(t,s,a){const i=(0,l.delayMs)(d.expBackoff(a,6e4,void 0,.1));try{yield u.default.state===u.STATE.CONNECTED?Promise.resolve():(0,c.default)(u.default,"change:state",(0,o.default)({state:u.STATE.CONNECTED}));const s=yield e();if(s.status>=500&&s.status<600)return i;t(s)}catch(e){return i}}));return function(){return t.apply(this,arguments)}}())};var n=i(s(48926)),o=i(s(6410)),l=s(8139),r=s(99935),d=a(s(77062)),c=i(s(18051)),u=a(s(72787))},66317:(e,t,s)=>{"use strict";var a=s(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.getTosUrl=function(){return`${n}?lg=${i.default.getLocale()}`},t.TOS_BASE_URL=void 0;var i=a(s(2408));const n="https://www.whatsapp.com/legal/";t.TOS_BASE_URL=n},81465:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.validateURL=t.validateEmail=t.EMAIL_REGEX=void 0;var a=s(1458);const i=new RegExp(/^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?/);t.EMAIL_REGEX=i;t.validateEmail=e=>!e||i.test(e);t.validateURL=e=>!e||a.URL_REGEX.test(e)},11959:(e,t,s)=>{e.exports=s.p+"img/animated-doodle_600127bdb5f7627ede5cd4ef320f55b0.png"},87009:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});const a={editMain:"_2I1Ow",dayMain:"JQF0C",timeWrapper:"_3MRIR",hoursAnd:"_2JxoB",hoursMain:"_28Fp0",dayCheckbox:"_2TA8L",dayInfo:"_1nLa3",dayInfoText:"_3nHg5"}},50743:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});const a={editMain:"_3JLJ7",list:"_2E4iI",rowMain:"uomL_",rowCheckbox:"x3Vkl",rowLabel:"_2H7gl",disabled:"_2rN2h",loadingSpinner:"_2ZkHo",searchBackground:"kkGAP"}},76482:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});const a={businessHoursDayColumn:"_2e5cd",businessHoursTimeColumn:"ePJ9B",businessHoursSection:"_25cLK",businessHoursTime:"_1Fbr2",addAnotherWebsite:"_2ic4J",businessMap:"_2lFZs",mapOverlay:"_3KH8A",overlayHint:"zLudj",infoText:"egL-4",verifiedNameIcon:"vr8kz",noPaddingTop:"_3-G7O"}},62389:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});const a={loadingSpinner:"_3YfhH"}},19453:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});const a={info:"_3_VBJ",footer:"_1fPbz",emptyCartContainer:"_2o_Dj",emptyCardHeader:"_3hoSO",emptyCardText:"_8jb_l",btnSend:"_5P7L4",cartMessage:"_2F64R"}},65324:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});const a={price:"JOk72",actions:"_31IdY",deleteIcon:"_2fSr8",cartListItem:"_1kVL7"}},5323:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});const a={select:"_1xCOB"}},33776:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});const a={deleteIcon:"_19lTm"}},8959:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});const a={title:"_3Q5hz"}},78749:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});const a={title:"_13MJe",text:"hM3sj",icon:"_1p9YY"}},15308:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});const a={header:"_1vhuQ"}},72084:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});const a={container:"_2RE0a",border:"_3t6bN",square:"_36Gk7",avatar:"_1b8fw",count:"_1gLP4",two:"_1EzI5",first:"JOgRb",second:"_3Q0g1",three:"_33l2L",third:"_1MivT",four:"_18BoY",fourth:"_1P7KC"}},79169:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});const a={overlay:"gDU26",icon:"_28Ee5",text:"_3D1Iu"}},58780:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});const a={imageGallery:"_3uMAp",imageGalleryList:"_1WX5F",imageGalleryItem:"MkTEt",imageGalleryItemSpacer:"_2ppZW",imageGalleryItemImage:"_6CxGV",imageGalleryItemOverlay:"_7mUkD",selected:"_1KnO5",imageGalleryFooter:"PYlBE",focusAnimation:"_30mp5",focusAnimationKeyframes:"_3i50e"}},36344:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});const a={inputEmoji:"_3K0ya",wrapper:"_1paHP",textInput:"_3yEml",labelText:"_2YN70",clearInput:"_1U7gF",float:"_24wuh",textActive:"_1nfyj",suggestionsPositioner:"_25axk",suggestionsContainer:"_3X1SA",charCounter:"_3yMv6",inputControls:"_202sS",charCounterWithClearBtn:"T2VTG",spacer:"_3vk_J",noPlaceholder:"_1KJOl",buttonContainer:"_3Ai1P",active:"_2359L"}},20487:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});const a={container:"_3cOtp",body:"_1YLvc"}},18312:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});const a={container:"_1w1m1",disabled:"_3Sg2g",count:"ItnCt",large:"_3OTTU"}},95108:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});const a={tabContainer:"_2kl47",tab:"_3fLXe",selected:"_2TdgQ"}},6935:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});const a={versionInfo:"AwT3E"}},54115:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});const a={positioner:"_388vZ",container:"ewANj",resizableInput:"_1L8rJ",emojiButton:"_3tKNQ",buttonIconWrapper:"_1F5dF",inputContainer:"_3DCJ3",hiddenText:"_269u7",hiddenTextLine:"_3F7_-",emojiPlaceholder:"_39TQD"}},71488:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});const a={container:"_2nStn",inputContainer:"_1VmmK",videoCaption:"_2M4pc",buttonContainer:"_26J91",clearBtn:"_3EUIt",inputEmoji:"I1HlI",charCounter:"_3HWI2",suggestionsPositioner:"_3-qS1",suggestionsContainer:"_1Uy4i",secondaryButtonContainer:"_3g507"}},99062:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});const a={thumb:"_2AkjL",active:"_31gut",bodyWrapper:"_1iECW",body:"_1hZLd",bodyIcon:"_299B_",btnDelete:"_1By33"}},4104:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});const a={container:"_34aQy",header:"qAj2u",headerRight:"_3PqRX",canvasContainer:"_1PFn9",cropRotateContainer:"_3zRbB",closeButton:"_1gvdP",closeButtonPlaceholder:"_1Ao72",canvas:"_153i9",footer:"_1nPzf",bottomToolbar:"_1nNuD",captionInputContainer:"_1iQr1",captionInputHidden:"_6dYhh"}},44532:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});const a={container:"_1Mcu-",previewOnly:"_2NB7f",dropOverlay:"_1PdGl",dropOverlayOutline:"_2HexZ",spinner:"pzFG8",footer:"_1HI4Y",addMediaButton:"_1xotB",addMediaButtonDisabled:"WAMhx",filmstripContainer:"_1vAZI",thumbs:"_7Tfhi",sendButton:"_33pCO",captureFooter:"_1z1Aw"}},70905:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});const a={container:"_3gx1m",cropperContainer:"_2mSFk"}},2482:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});const a={body:"_25wph",previewContainer:"OW_mU",previewIcon:"_4FGL4",header:"_1Xi6x",metadata:"_3QpE7"}},33807:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});const a={container:"_2oWjT",header:"Ku3Q6",title:"_2RTJr",pageCount:"_1aYm8",closeButton:"_3gqDa"}},81419:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});const a={container:"jcXC6"}},43232:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});const a={container:"_2SXhH",footer:"UJ-0N"}},35588:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});const a={container:"_2wtUo",disabled:"wZyqj",icon:"ZZ0GN",rotate:"_2X1cd",body:"_2O4Bw",caret:"_104hn"}},78055:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});const a={container:"_3eK79",colorChipsContainer:"_1E-L7"}},89471:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});const a={colorButton:"_2J8i-",primaryColorChip:"fteqj",primaryColorChipMedium:"_1Rjww",secondaryColorChip:"_1H9V5",active:"_3Jsf_",hover:"_1jiBu",selected:"_1lanH",colorChipWithBorder:"_2WYx6"}},95698:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});const a={container:"_1uNZ6",input:"_1bDiJ"}},56347:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});const a={canvas:"_3ZCwl",cursor:"_1YJQa"}},58510:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});const a={container:"fZGUF"}},57775:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});const a={container:"_1LRKO",rotateLeftButton:"_3dKFO"}},50918:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});const a={container:"QUfeO",fontLabel:"_3OMGG",icon:"_3SJCV"}},67024:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});const a={item:"_1j1xr",selected:"_2DKLD",sansSerif:"_106wS",serif:"_1yqqW",noricanRegular:"bzq8z",bryndanWrite:"_3Pj9c",oswaldHeavy:"ah3iR",alignmentContainer:"_2lKFu",alignmentIcon:"mi3vs",alignmentIconSelected:"_1KlZW"}},53964:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});const a={cirle:"_10ZsU",circleFilled:"_1ZATr",unchecked:"_1B4g5",checked:"_3s-4-"}},65251:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});const a={container:"_1_bv-",thicknessButton:"_3bAiP",thicknessChip:"_3iRrK",selected:"_32C9L"}},84978:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});const a={inputContainer:"XVAlv",label:"_3zFV7",input:"_3RaCQ"}},46771:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});const a={container:"JKr_m",media:"_3R3yC"}},56342:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});const a={container:"_3fFxj",media:"_3lqv9",document:"hH6sl",text:"eAWMI",icon:"fDWKK"}},13149:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});const a={container:"_1ULgK",media:"_2gN82",img:"OunMM",audio:"_3ZDt1",videoContainer:"_33jN5",spinner:"_1-L7X",video:"_2Vd8_",staticPreview:"sWhPU"}},28469:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});const a={container:"_2nVq-",preview:"_1K_xd",caption:"_3xLDc",img:"_2zsdh",imgBorder:"_2Cuay"}},29669:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});const a={text:"woR8K"}},53939:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});const a={list:"_2i0C9",hint:"_3sZ4R",button:"AoASc"}},55386:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});const a={container:"_3zKdl",body:"Sy3TC",captionInput:"_32AUO",footer:"_11gZr",retakeBtn:"rKFEM",retakeIcon:"_2rZzC",caption:"_1sxcB",videoContainer:"_2xIhM",video:"_2jZjN",btn:"_2kkeT",videoInactive:"_2eCp4",btnSend:"_1103Z",image:"_288ya",snapshot:"_3sE1m"}},71889:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});const a={newGroupButton:"EptxG"}},13550:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});const a={icon:"_2WtuC",body:"_3TCJd",spinner:"_1PKms",ack:"YYcY9",statusBlue:"_13UwK"}},86088:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});const a={dropOverlay:"PHaD9",dropOverlayOutline:"WsbTY"}},51236:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});const a={btnSend:"_1WEiG",attributionLink:"_4yicW",mediaBody:"_1YZ48",attribution:"_1nd00",footer:"iajo1",containerBackground:"_3rPvK",retake:"_3r-Fa",retakeIcon:"_3SS26",mediaElementBase:"_3ULIF",mediaElement:"_38bBM _3ULIF"}},95884:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});const a={mediaViewerImg:"_2rSfC",cropOverlay:"pKKiG"}},46475:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});const a={scaler:"_3QxRj",scalerButton:"P6r3N"}},65813:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});const a={wrapper:"fvxZ_",icon:"_3kxe5",text:"sfUBV"}},32521:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});const a={linkContainer:"_3eSYR",descContainer:"_1r8tU",icon:"_3qnQ8"}},56081:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});const a={confirmationText:"_2rM2V"}},23533:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});const a={title:"_3X4ur",titleIcon:"_3v5-C",ack:"_3hJA9",statusBlue:"_31P1q",forwardCount:"_36jfD",spinner:"_3pJTm",list:"_34Zzk",footer:"W5HdQ"}},2021:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});const a={commentInput:"_2_o99",search:"_1Plju",groupInfo:"_2wLei",onSendInvite:"_2-WpU"}},51298:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});const a={animation:"o43XS","play-ltr":"_1-zyO",playLtr:"_1-zyO","play-rtl":"_27Hce",playRtl:"_27Hce",versionInfo:"_1hWGI"}},45227:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});const a={container:"srSIT",wallpaperColorCanvas:"_33YuY",wallpaperColorEmpty:"_1BHKm",canvasActive:"_3o6gY",canvasHover:"_3zuY0"}},44676:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});const a={addLabelBtContainer:"ohbFn"}},64677:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});const a={container:"_2BtE_",textContainer:"_2Tvyf",spinner:"HYKvS"}},14395:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});const a={container:"_2136P",list:"C1Dd9",header:"K1c_P",item:"_16f8P",right:"DMk3i",left:"_1mO8w",close:"_38Gu8",name:"_2z4ea",time:"_4VLPt"}},34600:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});const a={wrapper:"_9Gs_R",offline:"_3rEcJ",circle:"_2Xn1u",text:"_1nFpn",notification:"p9CjV",ended:"_2OrJW",lastUpdated:"_3VPfk"}},85529:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});const a={wrapper:"_26J0I",inactive:"_2ZG5x",offline:"Pc7bU",circle:"_1487t",text:"_2WNWn",backToCenter:"_3LWZ9",visible:"_2Ozk7"}},98057:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});const a={container:"_2BPRJ",map:"_312iE",authFailed:"xgGDH",loading:"L5P7F"}},48347:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});const a={container:"_3rs7K",selected:"_10G_J",glow:"h5TUN",stale:"_3WyhQ",expired:"_1HO_K",pin:"_2JeQm"}},67493:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});const a={list:"D0Q5P",stopSharingButton:"_8wYL"}},85753:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});const a={popup:"_1O7kH",container:"_1qWAL",twoLines:"_2dn9y",name:"_2UN5N",status:"_1fM0V",menuButton:"_2UenO",triangle:"_1NoUg"}},76747:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});const a={actionBtns:"_1s6Xm",newLabelBtn:"_3bYuL",plus:"_2ZM_7"}},4448:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});const a={nextButton:"_1Opmc",section:"_1p7Ee",label:"_1I3g8",control:"gwZYu",header:"_1AdYi",chevronIcon:"_3Xfdv"}},95575:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});const a={spinner:"_27bPO",search:"_3zFPA",inputarea:"_1x9wV",inputLine:"etp_f",contacts:"_2DdHI",drawerSection:"_37Xh5",inputareaSizer:"_2-opG"}},66915:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});const a={photoPickerWrapper:"_1Mc0y",scale:"_55HVY",nameWrapper:"_2LTDQ","well-animation":"_1EgwP",wellAnimation:"_1EgwP",phoneIcon:"_9P72S",phoneField:"_1zywm",infoText:"_3FDYs"}},4662:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});const a={icon:"_3nXFq",iconLock:"_1q7G4",text:"_2QEzO",controls:"_1O2-j",checkbox:"_3xbR9",header:"_1_8IZ"}},96601:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});const a={container:"_1J075",section:"_2BZQN",control:"_1iSYt",label:"_3AXj8",disabled:"_1Aj3d"}},96363:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});const a={more:"_394Lu",hotKeyWraper:"_3lwKF"}},83314:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});const a={body:"nWPOn",vcardWrapper:"j80SY",btnContainer:"_386ov",btnPosition:"_3o41r"}},26163:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});const a={wallpaperApplyDoodle:"_1aWJq",checkboxLabel:"XvSmy",wallpaperColorGrid:"KzJy3",wallpaperColorCanvas:"Iwkc0",wallpaperDefaultTitle:"_2jzUd",wallpaperColorEmpty:"_1qqLM",canvasHover:"_3Mp8z",canvasActive:"_2MCR7",canvasDefault:"GRVkn"}},55850:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});const a={date:"DFImE",info:"_22yfR"}},20295:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});const a={price:"_3VVtW",separator:"I8-Ql",quantity:"_3hg85"}},93543:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});const a={descriptionText:"HZZS9",loadingSpinner:"_1D_wr"}},78518:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});const a={nameContainer:"_29TgP",nameIcon:"_2VsX7",nameEdit:"ajaQb",listContainer:"g5Pwo",footer:"gsAan",saveButton:"_2992-",operation:"Ky876",spinner:"_10Kpf",isSending:"_2saS4",container:"g0kY2",loadingSpinner:"_1mBPZ"}},37201:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});const a={productWrapper:"nwLZK",drawerHeader:"_9loHN",drawerHeaderButtonContainer:"_3UHa1",deleteButtonContainer:"_1GJGf",isSending:"R3KoU",spinner:"_3Of6S",hiddenLabel:"_1wTLv",hiddenDescr:"_133oH",hiddenContainer:"dhIGH"}},97721:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});const a={addItemPlaceholder:"_13K6_",placeholderIcon:"_21z7W",placeholderContainer:"j43hv",divider:"_1fHvf",isLoading:"_3cWYA",spinner:"_3skoT"}},10462:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});const a={drawerHeader:"_361UW",productName:"_3oqif",buttonSeparator:"_1dmnE",drawerHeaderButtonContainer:"G-hW5",productWrapper:"_2OajO",businessInfoTitle:"_2Wol_"}},72974:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});const a={root:"_28jDA",appealText:"Cifen",icon:"_3fJrr",text:"_2ZAuC"}},48567:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});const a={collectionIcon:"_1hToA",iconContainer:"_16Vdq"}},12156:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});const a={loadingSpinner:"_15oXt"}},62831:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});const a={panel:"_2k6IR",tileContainer:"hFwyO",imageTile:"_37Ag3",imageThumb:"_2gPsu",deleteIcon:"_2ICL9",btnAddContainer:"_JDHz",btnAddText:"_1rMC8",errorMessage:"_3Ueu_"}},30781:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});const a={list:"_3hjFg",noSections:"_3UBYX"}},31025:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});const a={title:"jm-c-"}},42082:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});const a={disabled:"_29h2z",title:"_2AWxj"}},44710:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});const a={dimmed:"khEuM"}},84080:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});const a={textThumb:"qgEhU",thumbSizeSmall:"_14N8a",thumbSizeLarge:"_2dKet",statusImage:"_37ckN",statusImageFallbackBackground:"_14MS9",container:"_3xFA4",thumbContainer:"_1cDhn"}}}]);