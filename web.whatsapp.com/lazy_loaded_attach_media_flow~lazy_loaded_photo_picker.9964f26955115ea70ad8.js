/*! For license information please see lazy_loaded_attach_media_flow~lazy_loaded_photo_picker.9964f26955115ea70ad8.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{bcijfighgd:function(e,t){e.exports={scaler:"_2LALH",scalerButton:"wdrS2"}},bgjhfgcbb:function(e,t,a){"use strict";var i=a("bfejgijfbh"),d=a("cfjecfhbfg");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=d(a("eaidjcib")),r=d(a("dgcdacjddi")),s=d(a("ffceefejc")),o=d(a("cjedcdbdii")),l=d(a("dbjagcfebh")),c=i(a("ddhijeejag")),f=function(e){function t(){var e,a;(0,n.default)(this,t);for(var i=arguments.length,d=new Array(i),r=0;r<i;r++)d[r]=arguments[r];return(a=(0,s.default)(this,(e=(0,o.default)(t)).call.apply(e,[this].concat(d)))).setRefCanvas=function(e){a.refCanvas=e},a}return(0,l.default)(t,e),(0,r.default)(t,[{key:"shouldComponentUpdate",value:function(){return!1}},{key:"render",value:function(){return c.createElement("canvas",{className:this.props.className,ref:this.setRefCanvas})}}]),t}(c.Component);t.default=f},bjghfcjch:function(e,t){e.exports={mediaViewerImg:"_1_C41",cropOverlay:"_1F-mx"}},dccciaccbi:function(e,t){e.exports={btnSend:"_35Y4T",attributionLink:"_3La-j",mediaBody:"jzbv2",attribution:"hDd8M",footer:"_18wuJ",containerBackground:"_7RNZ3",retake:"_2iFI3",retakeIcon:"jbwws",mediaElementBase:"PvIlC",mediaElement:"_2uhqO PvIlC"}},dcghjbcbii:function(e,t,a){"use strict";var i=a("bfejgijfbh"),d=a("cfjecfhbfg");Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.Component=t.RETRY_OPTIONS=void 0;var n=d(a("eaidjcib")),r=d(a("dgcdacjddi")),s=d(a("ffceefejc")),o=d(a("cjedcdbdii")),l=d(a("dbjagcfebh")),c=d(a("bebajedcaf")),f=i(a("ddhijeejag")),u=d(a("djcchigfih")),h=d(a("djbhiedbef")),v=d(a("dajffajabh")),g=d(a("dccciaccbi")),p=d(a("gfdchbigi")),m=d(a("bidfjbaebi")),b=d(a("eceadcicaf")),C=d(a("fbfedehbb")),E=d(a("jhjhdgfci")),j=i(a("dgfecega")),w=d(a("dgidheegej")),y=d(a("cdjhjdcbeg")),I=d(a("bfdcadbbif")),M=a("dfjhjafaab"),R=d(a("edbaidcaf")),S=d(a("didfdhbecg")),_={NONE:"none",RETAKE:"retake",RESTART:"restart"};t.RETRY_OPTIONS=_;var O=function(e){function t(e){var a;return(0,n.default)(this,t),(a=(0,s.default)(this,(0,o.default)(t).call(this,e))).onDoneEditing=function(){var e=a.state.editedMedia;a.saveCanvas(),a.refProfileCropTool&&a.refProfileCropTool.getComponent().crop().then((function(t){var i=t.thumb,d=t.full;a.props.onFinished(i,d),e.cleanUp()}))},a.onObjectLoad=function(e){if(e&&e instanceof HTMLElement){var t={};!a.state.editorSize||a.state.editorSize.width===e.clientWidth&&a.state.editorSize.height===e.clientHeight||(t.editorSize={width:e.clientWidth,height:e.clientHeight}),a.state.loaded||(t.loaded=!0),(0,c.default)(t)||a.setState(t)}},a.setRefMediaEditCanvas=function(e){a.mediaEditCanvas=e},a.setRefProfileCropTool=function(e){a.refProfileCropTool=e},a.drawCanvas=function(e,t){a.mediaEditCanvas&&a.mediaEditCanvas.drawCanvas(e,t)},a.saveCanvas=function(){a.mediaEditCanvas&&a.mediaEditCanvas.saveCanvas()},a.updateCanvasSize=function(e,t){a.mediaEditCanvas&&a.mediaEditCanvas.updateCanvasSize(e,t)},a.onCanvasInitialized=function(){a.forceUpdate()},a.state={doneEditing:!1,loaded:!1,editorSize:{width:500,height:361},editedMedia:new p.default(e.img)},a.mediaEditController=new E.default,a}return(0,l.default)(t,e),(0,r.default)(t,[{key:"componentDidMount",value:function(){this.props.listeners.add(this.mediaEditController,"change:isInitialized",this.onCanvasInitialized)}},{key:"render",value:function(){var e,t=this.props,a=t.attributionUrl,i=t.onRetake,d=t.retryText,n=this.state.loaded?f.createElement("div",{className:g.default.btnSend,key:"btn-send"},f.createElement(y.default,{large:!0,onClick:this.onDoneEditing},f.createElement(I.default,{name:"checkmark-light-l"}))):null;this.mediaEditController.isInitialized&&(e=f.createElement(w.default,{editedMedia:this.state.editedMedia,stage:this.mediaEditController.stage,cropOverlay:this.mediaEditController.cropOverlay,mediaContainer:this.mediaEditController.mediaContainer,drawCanvas:this.drawCanvas,ref:this.setRefProfileCropTool}));var r,s=f.createElement(C.default,{className:g.default.mediaElement,editedMedia:this.state.editedMedia,mediaEditController:this.mediaEditController,fitType:j.FIT_TYPE.COVER,ref:this.setRefMediaEditCanvas});if(i){var o;switch(d){case _.NONE:o=null;break;case _.RETAKE:o=l10n.t(987);break;case _.RESTART:default:o=l10n.t(996)}r=f.createElement("div",{className:g.default.retake,onClick:i},f.createElement("div",{className:g.default.retakeIcon},f.createElement(I.default,{name:"return-light"})),o)}var l=a?f.createElement("div",{className:g.default.attribution},f.createElement(m.default,{className:g.default.attributionLink,href:a},R.default.hostname(a)),f.createElement("span",null,l10n.t(623),"Â ",f.createElement(m.default,{href:(0,M.getTosUrl)()},l10n.t(629)))):null,c=f.createElement("div",{className:g.default.footer},f.createElement(S.default,{transitionName:"btn"},n),l),p=this.props.imageSize?this.props.imageSize:{width:500,height:361};return f.createElement(u.default,{key:"attach-edit-modal",theme:"edit"},f.createElement(v.default,{title:l10n.t(179),type:"offset",onCancel:this.props.onCancel},r),f.createElement(h.default,{overflow:"hidden"},f.createElement("div",{className:g.default.mediaBody},e,f.createElement("div",{className:g.default.containerBackground},f.createElement(S.default,{transitionName:"capture"},f.createElement(j.default,{type:j.FIT_TYPE.COVER,size:p,onObjectLoad:this.onObjectLoad},s)))),c))}}]),t}(f.Component),k=O;t.Component=k;var D=(0,b.default)(O);t.default=D},dfjhjafaab:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getTosUrl=function(){return"".concat("https://www.whatsapp.com/legal/","?lg=").concat(l10n.getLocale())}},dgidheegej:function(e,t,a){"use strict";var i=a("bfejgijfbh"),d=a("cfjecfhbfg");Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.Component=void 0;var n=d(a("eaidjcib")),r=d(a("dgcdacjddi")),s=d(a("ffceefejc")),o=d(a("cjedcdbdii")),l=d(a("dbjagcfebh")),c=a("cfabbaghh"),f=i(a("ddhijeejag")),u=d(a("baagejbchg")),h=d(a("dgjacfgggf")),v=d(a("eceadcicaf")),g=d(a("bcijfighgd")),p=d(a("bfdcadbbif")),m=function(e){function t(){var e,a;(0,n.default)(this,t);for(var i=arguments.length,d=new Array(i),r=0;r<i;r++)d[r]=arguments[r];return(a=(0,s.default)(this,(e=(0,o.default)(t)).call.apply(e,[this].concat(d)))).validateTranslate=function(e,t){var i=a.props.editedMedia.editData,d=(e-i.width/2)*i.scale,n=(e+i.width/2)*i.scale,r=(t+i.height/2)*i.scale,s=(t-i.height/2)*i.scale;return{x:d<-a.cropRadius&&n>a.cropRadius,y:s<-a.cropRadius&&r>a.cropRadius}},a.validateScale=function(e){var t=a.props.editedMedia.editData,i=Math.max(2*a.cropRadius/t.width,2*a.cropRadius/t.height),d=Math.max(e,i);if(t.width*e<a.cropRadius||t.height*e<a.cropRadius)return!1;var n=-a.cropRadius/d+t.width/2,r=a.cropRadius/d-t.width/2,s=-a.cropRadius/d+t.height/2,o=a.cropRadius/d-t.height/2;return{scale:d,offsetX:Math.min(Math.max(t.offsetX,r),n),offsetY:Math.min(Math.max(t.offsetY,o),s)}},a.onPressMove=function(e,t){var i=a.props.editedMedia.editData,d=e.stageX-t.x,n=e.stageY-t.y,r=i.offsetX+d/i.scale,s=i.offsetY+n/i.scale,o=a.validateTranslate(r,s);o.x&&(i.offsetX=r),o.y&&(i.offsetY=s),t.x=e.stageX,t.y=e.stageY,a.props.drawCanvas()},a.onEnlarge=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1.1,t=a.props.editedMedia.editData,i=0!==e?e:1.1,d=a.validateScale(t.scale*i);d&&(t.scale=d.scale,t.offsetX=d.offsetX,t.offsetY=d.offsetY,a.props.drawCanvas())},a.onReduce=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1.1,t=a.props.editedMedia.editData,i=0!==e?e:1.1,d=a.validateScale(t.scale/i);d&&(t.scale=d.scale,t.offsetX=d.offsetX,t.offsetY=d.offsetY,a.props.drawCanvas())},a.crop=function(){var e,t=a.props.editedMedia,i=t.editData,d=t.editedImage&&t.editedImage.src;if(!d)return Promise.reject("empty image");var n=2*a.cropRadius,r=n;return n>u.default.MAX_PIC_SIDE?r=u.default.MAX_PIC_SIDE:n<u.default.MIN_PIC_SIDE&&(r=u.default.MIN_PIC_SIDE),h.default.crop(d,(i.width-2*a.cropRadius)/2,(i.height-2*a.cropRadius)/2,2*a.cropRadius,2*a.cropRadius,r,r,h.default.DATA_URL|h.default.CANVAS).then((function(t){var a=t.images;return e=a.dataUrl,h.default.crop(a.canvas,0,0,u.default.PROF_PIC_THUMB_SIDE,u.default.PROF_PIC_THUMB_SIDE)})).then((function(t){return{thumb:t.images.dataUrl,full:e}}))},a}return(0,l.default)(t,e),(0,r.default)(t,[{key:"render",value:function(){var e=this;return f.createElement("div",{className:g.default.scaler},f.createElement("div",{className:g.default.scalerButton,onClick:function(){e.onEnlarge()}},f.createElement(p.default,{name:"plus"})),f.createElement("div",{className:g.default.scalerButton,onClick:function(){e.onReduce()}},f.createElement(p.default,{name:"minus"})))}},{key:"componentDidMount",value:function(){var e=this;this.props.editedMedia.saveEdits();var t,a=this.props.editedMedia.editData,i=this.props.cropOverlay,d=i.canvas;t=a.baseItem?a.baseItem.getBounds():{width:0,height:0},d.style.display="block",d.width=t.width,d.height=t.height;var n=new c.Easel.Shape;n.graphics.beginFill("rgba(0, 0, 0, 0.1)"),n.graphics.drawRect(0,0,t.width,t.height),n.regX=t.width/2,n.regY=t.height/2,n.x=t.width/2,n.y=t.height/2,n.on("mousedown",(function(t){var a={x:t.stageX,y:t.stageY},i=n.on("pressmove",e.onPressMove,null,!1,a);n.on("pressup",(function(){n.off("pressmove",i)}),null,!0)})),n.cursor="move",this.props.listeners.add(d,"mousewheel",(function(t){t.deltaY>0?e.onEnlarge(1.02):e.onReduce(1.02)}));var r=d.getContext("2d"),s=d.width,o=d.height,l=s/o>500/361?o/361:s/500;this.cropRadius=Math.min(361,500)/2*.9*l,r.fillStyle="rgba(0, 0, 0, 0.5)",r.fillRect(0,0,s,o),r.globalCompositeOperation="destination-out",r.beginPath(),r.arc(s/2,o/2,this.cropRadius,0,2*Math.PI,!0),r.fillStyle="#ffffff",r.fill(),i.addChild(n),i.update()}}]),t}(f.Component),b=m;t.Component=b;var C=(0,v.default)(m);t.default=C},fbfedehbb:function(e,t,a){"use strict";var i=a("bfejgijfbh"),d=a("cfjecfhbfg");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=d(a("bhfcfhafdj")),r=d(a("eaidjcib")),s=d(a("dgcdacjddi")),o=d(a("ffceefejc")),l=d(a("cjedcdbdii")),c=d(a("dbjagcfebh")),f=a("cfabbaghh"),u=i(a("ddhijeejag")),h=d(a("bjghfcjch")),v=i(a("dgfecega")),g=d(a("bgjhfgcbb")),p=function(e){function t(e){var a;return(0,r.default)(this,t),(a=(0,o.default)(this,(0,l.default)(t).call(this,e))).initCanvas=function(){var e=a.props.editedMedia.originalImage;e.complete?a.onImageLoad():e.onload=a.onImageLoad},a.onImageLoad=function(){var e=a.props.editedMedia.editData;a.props.editedMedia.editedImage=null;var t=a.props.editedMedia.originalImage;if(e.width||e.height||(e.width=t.naturalWidth,e.height=t.naturalHeight),!e.baseItem){var i=new f.Easel.Bitmap(t);e.baseItem=i}a.drawCanvas(!0)},a.maybeInitStage=function(e){var t;return a.state.stage?t=a.state.stage:(t=new f.Easel.Stage(e)).enableMouseOver(),a.props.mediaEditController.stage=t,t},a.drawCanvas=function(e,t){if(a.refStaticCanvas&&a.refStaticCanvas.refCanvas){var i=a.refStaticCanvas.refCanvas;t&&a.props.mediaPickerStatsLogger&&a.props.mediaPickerStatsLogger.logChange(a.props.activeMediaId||-1,t);var d=a.props.editedMedia,r=d.editData,s=a.maybeInitStage(i);e&&(i.width=r.width,i.height=r.height),s.removeAllChildren(),s.addChild(r.baseItem),r.items&&s.addChild.apply(s,(0,n.default)(r.items));var o=d.originalImage.naturalWidth,l=d.originalImage.naturalHeight;s.regX=o/2,s.regY=l/2,s.rotation=r.rotation,r.width&&r.height&&(s.x=r.width/2+r.scale*r.offsetX,s.y=r.height/2+r.scale*r.offsetY),s.scaleX=r.scale,s.scaleY=r.scale,s.update(),a.setState({canvasSize:{width:i.width,height:i.height},stage:s})}},a.saveCanvas=function(){a.drawCanvas(!0);var e=a.refStaticCanvas&&a.refStaticCanvas.refCanvas;e&&a.props.editedMedia.saveEditsFromCanvas(e)},a.clearStage=function(e){e&&(e.children.forEach((function(e){e.removeAllEventListeners()})),e.removeAllEventListeners(),e.removeAllChildren(),e.enableMouseOver(0),e.clear())},a.setRefStaticCanvas=function(e){a.refStaticCanvas=e},a.setRefMediaContainer=function(e){a.refMediaContainer=e},a.setRefCropOverlay=function(e){a.refCropOverlay=e},a.updateCanvasSize=function(e,t){a.setState({canvasSize:{width:e,height:t}})},a.state={canvasSize:{height:1,width:1},stage:null,mediaContainer:null},a}return(0,c.default)(t,e),(0,s.default)(t,[{key:"componentDidMount",value:function(){this.initCanvas(),this.setState({mediaContainer:this.refMediaContainer}),this.cropOverlay=new f.Easel.Stage(this.refCropOverlay),this.cropOverlay.autoClear=!1,this.cropOverlay.enableMouseOver(),this.refMediaContainer&&(this.props.mediaEditController.mediaContainer=this.refMediaContainer),this.props.mediaEditController.cropOverlay=this.cropOverlay}},{key:"componentWillUnmount",value:function(){var e=this.props.editedMedia.originalImage;e.complete||(e.onload=void 0),this.saveCanvas(),this.clearStage(this.state.stage),this.clearStage(this.cropOverlay)}},{key:"render",value:function(){var e=u.createElement("canvas",{ref:this.setRefCropOverlay,className:h.default.cropOverlay});return u.createElement("div",{className:this.props.className,ref:this.setRefMediaContainer},u.createElement(v.default,{type:this.props.fitType||v.FIT_TYPE.SCALE_DOWN,size:this.state.canvasSize},e,u.createElement(g.default,{ref:this.setRefStaticCanvas,className:h.default.mediaViewerImg})))}}]),t}(u.Component);t.default=p},gfdchbigi:function(e,t,a){"use strict";var i=a("cfjecfhbfg");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var d=i(a("eaidjcib")),n=i(a("gcfidijgh")),r=a("cgffhfegce"),s=i(a("edbaidcaf"));t.default=function e(t,a,i,o){var l=this;(0,d.default)(this,e),this.updateEditData=function(e){l.saveEdits(),l.editData=(0,n.default)({},l.editData,e)},this.updateEditItems=function(e,t){l.saveEdits();var a=[];l.editData.items&&l.editData.items.forEach((function(e){e!==t&&a.push(e)})),a.push(e),l.editData.items=a},this.saveEdits=function(){var t=new e(l.media,l.originalImage,l.editData,l.previous);l.previous=t},this.revertEdit=function(){l.previous&&(l.editData=l.previous.editData,l.previous=l.previous.previous)},this.saveEditsFromCanvas=function(e){var t=e.toDataURL();l.editedImage||(l.editedImage=new Image),l.editedImage.src=t},this.exportEditedMedia=function(){if(l.hasEdits()&&l.editedImage){var e=l.editedImage.src;return s.default.dataURLtoFile(e)}return l.media instanceof File?l.media:(0,r.createFile)([l.media],"",{type:l.media.type})},this.hasEdits=function(){return!!l.previous&&l.editedImage},this.cleanUp=function(){window.URL.revokeObjectURL(l.originalImage.src)},this.media=t,a?this.originalImage=a:(this.originalImage=new Image,this.originalImage.src=window.URL.createObjectURL(t)),this.previous=o,this.editData={height:0,width:0,offsetX:0,offsetY:0,rotation:0,scale:1,items:[],baseItem:null},(0,n.default)(this.editData,i)}},jhjhdgfci:function(e,t,a){"use strict";var i=a("bfejgijfbh"),d=a("cfjecfhbfg");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=d(a("eaidjcib")),r=d(a("dgcdacjddi")),s=d(a("ffceefejc")),o=d(a("cjedcdbdii")),l=d(a("dbjagcfebh")),c=i(a("dcaifjegcg")),f=function(e){function t(){var e,a;(0,n.default)(this,t);for(var i=arguments.length,d=new Array(i),r=0;r<i;r++)d[r]=arguments[r];return(a=(0,s.default)(this,(e=(0,o.default)(t)).call.apply(e,[this].concat(d)))).stage=(0,c.prop)(),a.cropOverlay=(0,c.prop)(),a.mediaContainer=(0,c.prop)(),a.isInitialized=(0,c.derived)(a._isInitialized,["stage","cropOverlay","mediaContainer"]),a}return(0,l.default)(t,e),(0,r.default)(t,[{key:"_isInitialized",value:function(){return!!this.stage&&!!this.cropOverlay&&!!this.mediaContainer}},{key:"clearStage",value:function(e){e&&(e.children.forEach((function(e){e.removeAllEventListeners()})),e.removeAllEventListeners(),e.removeAllChildren(),e.clear())}}]),t}(c.default),u=(0,c.defineModel)(f);t.default=u}}]);