/*! For license information please see lazy_loaded_attach_media_flow.74b1efa5c6efd40f536e.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{bahefiaghi:function(e,t,a){"use strict";var i=a("cfjecfhbfg"),n=a("bfejgijfbh");Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.fullPreview,a=e.fullPreviewSize,i=e.mimeType,n=e.filename;return t&&a?o.createElement("div",{className:c.default.container,"data-animate-attach-media":!0},o.createElement("div",{className:c.default.preview},o.createElement(r.default,{type:r.FIT_TYPE.SCALE_DOWN,size:a},o.createElement("img",{src:t,className:c.default.img})))):o.createElement(d.default,{mimeType:i,filename:n})};var o=n(a("ddhijeejag")),c=i(a("jgbhhadeh")),d=i(a("becegcbegb")),r=n(a("dgfecega"))},bcjhbcbjbf:function(e,t){e.exports={thumb:"_2gZno",active:"_2UCiX",body:"GpvML",btnDelete:"_2pAE-",bodyDoc:"_1pxPR"}},bdgjaajijj:function(e,t,a){"use strict";var i=a("bfejgijfbh"),n=a("cfjecfhbfg");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=n(a("eaidjcib")),c=n(a("dgcdacjddi")),d=n(a("ffceefejc")),r=n(a("cjedcdbdii")),l=n(a("dbjagcfebh")),s=i(a("ddhijeejag")),f=n(a("bhaigiibeh")),u=n(a("bbchdeehff")),p=i(a("dcghjbcbii")),m=i(a("cajijabhgb")),h=n(a("bcbahjefec")),g=i(a("ffchhcfdj")),b=i(a("dcecgegjfc")),v=i(a("chcadgfgad")),j=a("dgfecega"),E=n(a("bjbedjfe")),C=function(e){function t(){var e,a;(0,o.default)(this,t);for(var i=arguments.length,n=new Array(i),c=0;c<i;c++)n[c]=arguments[c];return(a=(0,d.default)(this,(e=(0,r.default)(t)).call.apply(e,[this].concat(n)))).refCaptureDrawer=null,a.setRefCaptureDrawer=function(e){a.refCaptureDrawer=e},a.pushPermissionModal=function(){a.push(s.createElement(g.default,{messaging:g.Messaging.CAMERA,type:g.default.TYPE.GUIDE_ALLOW,onConfirm:a.popModal}),"modal")},a.popModal=function(){a.pop("modal")},a.startCaptureDrawer=function(){var e=b.start("camera",a.pushPermissionModal);Promise.race([e,a.props.rejectOnUnmount()]).checkpoint(a.props.rejectOnUnmount()).then((function(e){a.refCaptureDrawer||a.popModal(),e&&a.refCaptureDrawer&&a.refCaptureDrawer.loadNewStream(e)})).catch(m.GUM.NotAllowedError,(function(){a.cleanUp(),u.default.openModal(s.createElement(g.default,{messaging:g.Messaging.CAMERA_FAIL,type:g.default.TYPE.GUIDE_UNBLOCK}))})).catch(m.GUM.GUMError,(function(){a.cleanUp(),u.default.openModal(s.createElement(g.default,{messaging:g.Messaging.CAMERA_MISSING,type:g.default.TYPE.GUIDE_NONE}))}))},a.onFinished=function(e,t){a.props.onFinished(e,t),a.cleanUp()},a.cleanUp=function(){a.end()},a.onRetake=function(){a.pop("flow-transition-box-size-drawer-pop"),a.startCaptureDrawer()},a.onCaptured=function(e){a.push(s.createElement(v.default,{type:v.BoxModalType},s.createElement(p.default,{onRetake:a.onRetake,retryText:p.RETRY_OPTIONS.RETAKE,onFinished:a.onFinished,onCancel:a.cleanUp,img:e})),"flow-transition-box-size-drawer-push")},a}return(0,l.default)(t,e),(0,c.default)(t,[{key:"componentDidMount",value:function(){this.push(s.createElement(v.default,{type:v.BoxModalType},s.createElement(f.default,{ref:this.setRefCaptureDrawer,stream:void 0,caption:!1,layoutType:j.FIT_TYPE.COVER,onBack:this.cleanUp,onSend:null,onCaptured:this.onCaptured,chat:void 0}))),this.startCaptureDrawer()}}]),t}(h.default),M=(0,E.default)(C);t.default=M},becegcbegb:function(e,t,a){"use strict";var i=a("bfejgijfbh"),n=a("cfjecfhbfg");Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.mimeType,a=e.filename,i=(0,d.default)(r.default.icon,s[t]?s[t].icon:"icon-doc-generic");return c.createElement("div",{className:r.default.container,"data-animate-attach-media":!0},c.createElement("div",{className:r.default.media},c.createElement("div",{className:r.default.document},c.createElement("div",{className:i}),c.createElement("div",{className:r.default.text},a))))};var o=n(a("bgeijhbbad")),c=i(a("ddhijeejag")),d=n(a("ceffhbhahb")),r=n(a("cihjadddhc")),l=a("eabibhbeaf"),s=(0,o.default)(l.MIMETYPES,(function(e){return"document"===e.msgType}))},bhaigiibeh:function(e,t,a){"use strict";var i=a("bfejgijfbh"),n=a("cfjecfhbfg");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=n(a("eaidjcib")),c=n(a("dgcdacjddi")),d=n(a("ffceefejc")),r=n(a("cjedcdbdii")),l=n(a("dbjagcfebh")),s=n(a("ceffhbhahb")),f=i(a("ddhijeejag")),u=n(a("cdcfgefbba")),p=n(a("bbchdeehff")),m=n(a("baagejbchg")),h=n(a("djcchigfih")),g=n(a("djbhiedbef")),b=i(a("dajffajabh")),v=i(a("cajijabhgb")),j=i(a("ffchhcfdj")),E=a("ejbdjaifi"),C=n(a("dgjacfgggf")),M=n(a("bdiiahhjbe")),y=n(a("bbcjhfahhb")),_=n(a("jgcieiibj")),I=i(a("dcecgegjfc")),P=a("bfbggcdbfb"),k=n(a("dgfecega")),w=n(a("ebcfdcdhji")),N=n(a("bjbedjfe")),S=n(a("cdjhjdcbeg")),T=n(a("ceddibdhdb")),A=n(a("becfabjeeg")),R=n(a("bfdcadbbif")),D=n(a("edbaidcaf")),O=n(a("didfdhbecg")),x=n(a("ccfdaijebj")),L="ANIMATING",U="LOADING",F="RECORDING",B="SENDING",G=function(e){function t(){var e,a;(0,o.default)(this,t);for(var i=arguments.length,n=new Array(i),c=0;c<i;c++)n[c]=arguments[c];return(a=(0,d.default)(this,(e=(0,r.default)(t)).call.apply(e,[this].concat(n)))).state={state:L,stream:void 0,img:void 0,caption:void 0,videoSize:void 0},a.videoRef=null,a.startTimer=new T.default((function(e){a.loadNewStream(e)})),a.loadNewStream=function(e){e?(a.setState({state:U,stream:e}),(0,I.isSrcObjectInVideoElement)()||(e?(window.URL.revokeObjectURL(a.url),a.url=window.URL.createObjectURL(e)):(window.URL.revokeObjectURL(a.url),a.url=void 0))):a.state.state===L&&a.setState({state:U})},a.stopStreamTimer=new T.default((function(e){e&&I.stop(e),(0,I.isSrcObjectInVideoElement)()||(a.url=window.URL.revokeObjectURL(a.url))})),a.onCapture=function(){if(a.videoRef){var e=a.videoRef.underlyingVideo();if(e){var t=a.props.chat,i=document.createElement("canvas");i.height=e.videoHeight,i.width=e.videoWidth;var n=i.getContext("2d");if(n){n.translate(i.width,0),n.scale(-1,1),n.drawImage(e,0,0,e.videoWidth,e.videoHeight);var o=a.props.onCaptured;if(o)C.default.canvasToBlob(i).then((function(e){o(e)}));else{a.stopStreamTimer.onOrBefore(500,a.state.stream),a.mediaLogger=new y.default,a.mediaLogger.logAdd("CAPTURE_MEDIA","image",P.MEDIA_PICKER_ORIGIN_TYPE.MENU_CAMERA_CAPTURE),a.mediaLogger.chatRecipients=t&&t.groupMetadata?t.groupMetadata.participants.length:1;var c=i.toDataURL("image/jpeg");a.setState({state:B,stream:void 0,img:c})}}else M.default.warn("CaptureDrawer:onCapture can not get 2d context")()}}},a.onVideoLoaded=function(e){a.setState({state:F,videoSize:{width:e.videoWidth,height:e.videoHeight}})},a.onRetake=function(){a.setState({state:U,caption:void 0});var e=I.start("camera");Promise.race([e,a.props.rejectOnUnmount()]).checkpoint(a.props.rejectOnUnmount()).then((function(e){e&&((0,I.isSrcObjectInVideoElement)()||(a.url=window.URL.createObjectURL(e)),a.setState({stream:e}))})).catch(v.Unmount,(function(){e.then((function(e){return I.stop(e)})).catch((function(){}))})).catch(v.GUM.NotAllowedError,(function(){a.props.onBack(),p.default.openModal(f.createElement(j.default,{messaging:j.Messaging.CAMERA_FAIL,type:j.default.TYPE.GUIDE_UNBLOCK}))})).catch(v.GUM.GUMError,(function(){a.props.onBack(),p.default.openModal(f.createElement(j.default,{messaging:j.Messaging.CAMERA_MISSING,type:j.default.TYPE.GUIDE_NONE}))}))},a.onSend=function(){var e=a.state,t=e.img,i=e.caption,n=a.props.onSend;if(n)if(t){var o=t,c=a.refCaptionInput&&a.refCaptionInput.refInput,d=[];if(i&&c){var r=c.serialize(i),l=[r[0].trim(),r[1]],s=l[0],f=l[1];s.length&&(i=s,d=f.mentionedJidList||[])}n({getImg:w.default.createFromBase64Jpeg(D.default.parseDataURL(o).data),caption:i,mentionedJidList:d}),a.mediaLogger.logSend()}else M.default.assert(t,"capture-drawer-no-img")();else M.default.assert(n,"capture-drawer-no-onSend")()},a.onCaptionChange=function(e){a.setState({caption:e})},a.setRefCaptionInput=function(e){a.refCaptionInput=e},a}return(0,l.default)(t,e),(0,c.default)(t,[{key:"componentDidMount",value:function(){this.startTimer.onOrBefore(300,this.props.stream)}},{key:"componentWillUnmount",value:function(){this.startTimer.cancel(),this.url&&window.URL.revokeObjectURL(this.url),this.state.stream&&I.stop(this.state.stream),this.mediaLogger&&this.mediaLogger.logCancel()}},{key:"render",value:function(){var e,t,a,i,n;switch(this.state.state){case L:case U:if(n=f.createElement(A.default,{stroke:4,size:50}),this.state.state===L)break;case F:var o=(0,s.default)(u.default.video,{[u.default.videoInactive]:this.state.stream&&this.state.state===U}),c=this.state.stream?f.createElement(x.default,{autoPlay:!0,ref:(0,E.GetRef)("videoRef",this),onPlay:this.onVideoLoaded,src:this.url?this.url:void 0,srcObject:this.url?void 0:this.state.stream}):null;a=this.state.stream?f.createElement("div",{key:"webcam"},f.createElement(k.default,{type:this.props.layoutType,size:this.state.videoSize},f.createElement("div",{className:o,"data-animage-capture-webcam":!0},c))):null,e=this.state.state===F?f.createElement("div",{className:u.default.btn,key:"btn-capture"},f.createElement(S.default,{large:!0,onClick:this.onCapture},f.createElement(R.default,{name:"camera-light"}))):null;break;case B:a=f.createElement(k.default,{type:this.props.layoutType,size:this.state.videoSize},f.createElement("img",{className:u.default.image,"data-animate-capture-snapshot":!0,src:this.state.img})),e=f.createElement("div",{className:(0,s.default)(u.default.btn,u.default.btnSend),key:"btn-send"},f.createElement(S.default,{large:!0,onClick:this.onSend},f.createElement(R.default,{name:"send-light",directional:!0}))),t=f.createElement("div",{className:u.default.retakeBtn,onClick:this.onRetake},f.createElement("div",{className:u.default.retakeIcon},f.createElement(R.default,{name:"return-light"})),l10n.t(987)),i=this.props.chat?f.createElement(_.default,{ref:this.setRefCaptionInput,chat:this.props.chat,maxLength:m.default.MAX_CAPTION_LENGTH,multiline:!0,onEnter:this.onSend,onChange:this.onCaptionChange,placeholder:l10n.t(163),showRemaining:!0,spellCheck:!0,supportsEmoji:!0,value:this.state.caption}):null;break;default:M.default.log("captureDrawer:render Unhandled video capture state "+this.state.state)()}var d=this.props.caption?f.createElement(O.default,{transitionName:"media-caption",className:u.default.caption},i):null;return f.createElement(h.default,{key:"attach-capture-modal",theme:"capture"},f.createElement(b.default,{title:l10n.t(1098),type:b.DRAWER_HEADER_TYPE.OFFSET,onCancel:this.props.onBack},t),f.createElement(g.default,{overflow:"hidden"},f.createElement("div",{className:u.default.container},n,f.createElement("div",{className:u.default.body},f.createElement(O.default,{transitionName:"capture",className:u.default.videoContainer},a))),f.createElement("div",{className:u.default.footer},d,f.createElement(O.default,{transitionName:"pop_delay"},e))))}}]),t}(f.PureComponent);G.defaultProps={caption:!1};var z=function(e){function t(){var e,a;(0,o.default)(this,t);for(var i=arguments.length,n=new Array(i),c=0;c<i;c++)n[c]=arguments[c];return(a=(0,d.default)(this,(e=(0,r.default)(t)).call.apply(e,[this].concat(n)))).loadNewStream=function(e){a.getComponent().loadNewStream(e)},a}return(0,l.default)(t,e),t}((0,N.default)(G));t.default=z},cbfidcgebe:function(e,t){e.exports={container:"_2qtw6",media:"_1-okK"}},cdcfgefbba:function(e,t){e.exports={container:"_3fJXs",body:"_1tfR8",footer:"_3UUn3",retakeBtn:"_1VQOF",retakeIcon:"_3KiSR",caption:"_26WTk",videoContainer:"_2pEAB",video:"_2oKVP",videoInactive:"fX_7B",btn:"w0LJp",btnSend:"_2-dbC",image:"_3ygW4",snapshot:"_2XF1e"}},cfghbhcedd:function(e,t,a){"use strict";var i=a("bfejgijfbh"),n=a("cfjecfhbfg");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=n(a("eaidjcib")),c=n(a("dgcdacjddi")),d=n(a("ffceefejc")),r=n(a("cjedcdbdii")),l=n(a("dbjagcfebh")),s=i(a("ddhijeejag")),f=n(a("bhaigiibeh")),u=n(a("bcbahjefec")),p=a("ddgbhifaji"),m=a("dgfecega"),h=function(e){function t(){var e,a;(0,o.default)(this,t);for(var i=arguments.length,n=new Array(i),c=0;c<i;c++)n[c]=arguments[c];return(a=(0,d.default)(this,(e=(0,r.default)(t)).call.apply(e,[this].concat(n)))).sendMedia=function(e){var t=e.getImg,i=e.caption,n=e.mentionedJidList,o=a.props.chat,c=o.composeQuotedMsg;o.composeQuotedMsg=null,(0,p.prepRawMedia)(t,{}).sendToChat(o,{caption:i,mentionedJidList:n,quotedMsg:c}),a.end()},a}return(0,l.default)(t,e),(0,c.default)(t,[{key:"componentDidMount",value:function(){var e=this;this.push(s.createElement(f.default,{onBack:function(){e.end()},chat:this.props.chat,caption:!0,layoutType:m.FIT_TYPE.CONTAIN,onSend:this.sendMedia,stream:this.props.stream}))}}]),t}(u.default);t.default=h},cihjadddhc:function(e,t){e.exports={container:"_3y0EN",media:"_3EjgV",document:"_6Pnex",text:"QA8Vz",icon:"jcxhw"}},cjcecfgaji:function(e,t,a){"use strict";var i=a("bfejgijfbh"),n=a("cfjecfhbfg");Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t,a=e.mimeType,i=e.url,n=e.isGif,c=e.size,s=e.processing,h=e.preview;switch(m[a].msgType){case"image":t=r.createElement("img",{src:i,className:l.default.img});break;case"video":var g=n?{loop:!s,autoPlay:!s,muted:!1,controls:!1}:{},b=s?r.createElement("div",{className:l.default.spinner},r.createElement(u.default,{color:u.colorOptions.white,size:50,stroke:3})):null,v=h?r.createElement("img",{className:l.default.staticPreview,src:"data:image/jpeg;base64,".concat(h)}):null,j=s?null:r.createElement(p.default,(0,o.default)({controls:!0,controlsList:"nodownload nofullscreen",className:l.default.video},g,{src:i}));t=r.createElement("div",{className:(0,d.default)(l.default.img,l.default.videoContainer)},b,j,v);break;case"audio":t=r.createElement("audio",{controls:!0,className:l.default.audio,type:a,src:i})}return r.createElement("div",{className:l.default.container,"data-animate-attach-media":!0},r.createElement("div",{className:l.default.media},r.createElement(f.default,{type:f.FIT_TYPE.SCALE_DOWN,size:c},t)))};var o=n(a("bacehaajgh")),c=n(a("bgeijhbbad")),d=n(a("ceffhbhahb")),r=i(a("ddhijeejag")),l=n(a("dhhbehfjej")),s=a("eabibhbeaf"),f=i(a("dgfecega")),u=i(a("becfabjeeg")),p=n(a("ccfdaijebj")),m=(0,c.default)(s.MIMETYPES,(function(e){return"image"===e.msgType||"video"===e.msgType}))},cjgdeggcdi:function(e,t){e.exports={inputEmoji:"wTdDG",wrapper:"CzI8E",textInput:"TI3qN",labelText:"_7HWvs",clearInput:"_2WH-g",float:"FstZn",textActive:"_3rp1J",suggestionsPositioner:"_17XE4",suggestionsContainer:"_1xHCd",charCounter:"_2IC1c",inputControls:"_3MR8o",charCounterWithClearBtn:"_2BRYw",spacer:"_2ssn3",noPlaceholder:"_17dH2",buttonContainer:"_3GaI4",active:"_2Mg6D"}},dbcfhfbbbf:function(e,t,a){"use strict";var i=a("cfjecfhbfg");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(a("eaidjcib")),o=i(a("ffceefejc")),c=i(a("cjedcdbdii")),d=i(a("dbjagcfebh")),r=i(a("bfjfgcfade")),l=i(a("dfcggebdjj")),s=i(a("cdheafhdbh")),f=i(a("ccchcigijb")),u=i(a("eccjbdjafd")),p=i(a("eaecbgafff")),m=i(a("bfccafhbbb")),h=i(a("ecidjifge")),g=new f.default,b=new r.default,v=function(e){function t(){return(0,n.default)(this,t),(0,o.default)(this,(0,c.default)(t).apply(this,arguments))}return(0,d.default)(t,e),t}((0,u.default)([l.default,b,g,p.default]));t.default=v,v.MentionSuggestions=(0,h.default)(m.default,{plugin:g}),v.EmojiSuggestions=(0,h.default)(s.default,{plugin:b})},dbifaacaac:function(e,t,a){"use strict";var i=a("bfejgijfbh"),n=a("cfjecfhbfg");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=n(a("eaidjcib")),c=n(a("dgcdacjddi")),d=n(a("ffceefejc")),r=n(a("djecdhecha")),l=n(a("cjedcdbdii")),s=n(a("bjehdcaaj")),f=n(a("dbjagcfebh")),u=n(a("bgifaaggh")),p=n(a("fhfbcdaib")),m=i(a("ddhijeejag")),h=a("biheibdage"),g=n(a("ihfgagaij")),b=n(a("bbchdeehff")),v=n(a("bcbahjefec")),j=n(a("bcjcbbafcj")),E=function(e){function t(){var e;return(0,o.default)(this,t),(e=(0,d.default)(this,(0,l.default)(t).apply(this,arguments))).onCancel=function(){e.props.onComplete&&e.props.onComplete(!1),e.clearComposeAttachMedia(),e.props.mediaCollection.mediaPickerStatsLogger.logCancel(),e.end()},e.onFailedMedias=function(t){var a=t.filter((function(e){return e.isGif}));if(a.length>0){var i=a.map((function(e){return e.filename}));b.default.once("ui_idle",(function(){b.default.pasteChatTextInput(e.props.chat,i.join(" "))})),e.props.onComplete&&e.props.onComplete(!1),e.clearComposeAttachMedia(),e.props.mediaCollection.mediaPickerStatsLogger.logCancel(),e.end()}},e.sendMediaWithMentions=function(t,a){var i=e.props.chat;b.default.once("ui_idle",(function(){t.forEach((function(e,t){var a=e.media,n={};0===t&&(n.quotedMsg=i.composeQuotedMsg,i.composeQuotedMsg=null),n.mentionedJidList=e.mentionedJidList,n.caption=a.caption,n.addEvenWhilePreparing=a.previewable&&a.state===h.ATTACH_MEDIA_STATE.PROCESSING,a.sendToChat(i,n)})),e.clearComposeAttachMedia()})),e.props.onComplete&&e.props.onComplete(!0,a),e.props.mediaCollection.mediaPickerStatsLogger.logSend(),e.end()},e.setText=function(t){null!=t&&b.default.once("ui_idle",(function(){b.default.pasteChatTextInput(e.props.chat,t)})),e.end()},e.clearComposeAttachMedia=function(){e.props.chat&&e.props.chat.setComposeAttachMediaContents(null)},e.handleRequestDismiss=e.handleRequestDismiss.bind((0,r.default)(e)),e}return(0,f.default)(t,e),(0,c.default)(t,[{key:"componentDidMount",value:function(){b.default.closeContextMenu(),b.default.closeTooltip(),this.push(m.createElement(g.default,{chat:this.props.chat,onBack:this.onCancel,initCaption:this.props.initCaption,onSendMedia:(0,p.default)(this.sendMediaWithMentions),onDropText:(0,p.default)(this.setText),onFailedMedias:this.onFailedMedias,mediaCollection:this.props.mediaCollection}))}},{key:"componentWillUnmount",value:function(){var e=this;j.default.isGecko?(0,u.default)((function(){return b.default.focusChatTextInput(e.props.chat)})):b.default.focusChatTextInput(this.props.chat)}},{key:"handleRequestDismiss",value:function(e){!1===e&&(this.clearComposeAttachMedia(),this.props.mediaCollection.mediaPickerStatsLogger.logCancel()),(0,s.default)((0,l.default)(t.prototype),"handleRequestDismiss",this).call(this)}}]),t}(v.default);t.default=E},dhhbehfjej:function(e,t){e.exports={container:"_2k1om",media:"xVBLL",img:"_1a4Ru",audio:"_3MIB_",videoContainer:"_3S63o",spinner:"_3sxu7",video:"_3q7Vo",staticPreview:"_2XZGZ"}},eajjbbihhc:function(e,t,a){"use strict";var i=a("cfjecfhbfg"),n=a("bfejgijfbh");Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.mimeType,a=e.url;return o.createElement("div",{className:c.default.container,"data-animate-attach-media":!0},o.createElement("div",{className:c.default.media},o.createElement("audio",{controls:!0,type:t,src:a})))};var o=n(a("ddhijeejag")),c=i(a("cbfidcgebe"))},ffhhggjcj:function(e,t){e.exports={container:"r4crx",preview:"_2-_Pl",caption:"_2GgBs",img:"_3m_5X"}},fhdffdech:function(e,t,a){"use strict";var i=a("cfjecfhbfg"),n=a("bfejgijfbh");Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.fullPreview,a=e.fullPreviewSize,i=e.pdfPages,n=e.mimeType,l=e.filename;if(t&&a&&null!=i&&i>0){var s=l10n.t(192,{count:i,_plural:i});return o.createElement("div",{className:d.default.container,"data-js-attach-preview":!0},o.createElement("div",{className:d.default.preview},o.createElement(r.default,{type:r.FIT_TYPE.SCALE_DOWN,size:a},o.createElement("img",{src:t,className:d.default.img}))),o.createElement("div",{className:d.default.caption},s))}return o.createElement(c.default,{mimeType:n,filename:l})};var o=n(a("ddhijeejag")),c=i(a("becegcbegb")),d=i(a("ffhhggjcj")),r=n(a("dgfecega"))},ihfgagaij:function(e,t,a){"use strict";var i=a("bfejgijfbh"),n=a("cfjecfhbfg");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=n(a("eaidjcib")),c=n(a("ffceefejc")),d=n(a("cjedcdbdii")),r=n(a("dgcdacjddi")),l=n(a("dbjagcfebh")),s=i(a("ddhijeejag")),f=a("biheibdage"),u=n(a("ijdibihbi")),p=n(a("jfbdejdfi")),m=n(a("eajjbbihhc")),h=n(a("bahefiaghi")),g=n(a("becegcbegb")),b=n(a("cjcecfgaji")),v=n(a("fhdffdech")),j=n(a("cfaacaccfj")),E=n(a("bbchdeehff")),C=n(a("baagejbchg")),M=n(a("biddiiafgd")),y=n(a("dcjhajfghf")),_=n(a("djcchigfih")),I=n(a("djbhiedbef")),P=i(a("dajffajabh")),k=a("cfffidafid"),w=i(a("cajijabhgb")),N=a("cgffhfegce"),S=n(a("ddajbaceej")),T=n(a("dhfbfehaef")),A=n(a("eceadcicaf")),R=n(a("jgcieiibj")),D=a("bfbggcdbfb"),O=n(a("eabibhbeaf")),x=n(a("bjbedjfe")),L=n(a("cdjhjdcbeg")),U=n(a("becfabjeeg")),F=n(a("bfdcadbbif")),B=i(a("bfjajhbdf")),G=n(a("didfdhbecg")),z=C.default.MSG_TYPE,W=z.IMAGE,Y=z.VIDEO,V=z.DOCUMENT,J=z.AUDIO,H=f.ATTACH_MEDIA_STATE.PROCESSING,K=function(e){function t(e){var a;return(0,o.default)(this,t),(a=(0,c.default)(this,(0,d.default)(t).call(this,e))).attachMediaRefMap=new Map,a.setRefContainer=function(e){a.refContainer=e},a.setRefInput=function(e){a.refInput=e},a.setAttachMediaRef=function(e,t){a.attachMediaRefMap.set(e,t)},a.onMediaProcessUpdate=function(){var e=a.props.mediaCollection;if(e.canSend()){var t=e.uiProcessMsgs().errorMsgs,i=e.getPreviewableMedias();t&&i.length>0&&E.default.openToast(s.createElement(B.default,{msg:t,id:(0,B.genId)()})),a.forceUpdate()}},a.onFilesNotSupported=function(){var e=a.props.mediaCollection.filter((function(e){return e.exception}));e.length>0&&a.props.onFailedMedias(e)},a.showIgnoredToast=function(e){if(e>0){var t=l10n.t(1101,{number:e,_plural:e});E.default.openToast(s.createElement(B.default,{msg:t,id:(0,B.genId)()}))}},a.onDrop=function(e){a.onFilePick(e)},a.onDragLeave=function(e){a.props.mediaCollection.length||a.props.onBack()},a.onDragChange=function(e,t){a.setState({isDragging:e}),e||t||a.props.mediaCollection.length||a.props.onBack()},a.onEnter=function(e){a.state.activeMedia&&(e.repeat||e.shiftKey||a.onSend())},a.onArrowLeft=function(e){if(a.state.activeMedia&&!e.repeat){var t=a.state.activeMedia&&!a.state.activeMedia.caption,i=a.refCaptionInput&&a.refCaptionInput.refInput;(t||i&&!i.isFocused()||i&&i.cursorIsAtStart())&&a.onPrev()}},a.onArrowRight=function(e){if(a.state.activeMedia&&!e.repeat){var t=a.state.activeMedia&&!a.state.activeMedia.caption,i=a.refCaptionInput&&a.refCaptionInput.refInput;(t||i&&!i.isFocused()||i&&i.cursorIsAtEnd())&&a.onNext()}},a.onNext=function(){a.props.mediaCollection.setNextAsActive()&&(a.refSendButton&&S.default.focus(a.refSendButton),a._scrollIntoView())},a.onPrev=function(){a.props.mediaCollection.setPrevAsActive()&&(a.refSendButton&&S.default.focus(a.refSendButton),a._scrollIntoView())},a._scrollIntoView=function(){var e=a.props.mediaCollection.getActive();if(e){var t=a.attachMediaRefMap.get(e.id);t&&t.scrollIntoView()}},a.onSelectThumb=function(e){a.props.mediaCollection.setActive(e)},a.onSend=function(e){if(e&&e.preventDefault(),(!e||!e.shiftKey)&&a.props.mediaCollection.canSend()){Promise.all([]).then((function(){var e=a.props.mediaCollection.getPreviewableMedias();if(0!==e.length){var t=e.map((function(e){var t=e.caption,i=[],n=a.refCaptionInput&&a.refCaptionInput.refInput;if(t&&n){var o=n.serialize(t),c=[o[0].trim(),o[1]],d=c[0],r=c[1];d.length&&(t=d,i=r.mentionedJidList||[])}return e.caption=t||void 0,{media:e,mentionedJidList:i}}));a.props.onSendMedia(t,a.state.isInitCaptionUsed)}}))}},a.onAddFileClick=function(){a.refInput&&a.refInput.click()},a.onFilePick=function(e){(0,k.getFiles)(e).then((function(e){return a.props.mediaCollection.processAttachments(e.map((function(e){return{file:e}})),D.MEDIA_PICKER_ORIGIN_TYPE.CHAT_PHOTO_LIBRARY)})).checkpoint(a.props.rejectOnUnmount()).catch(w.Unmount,(function(){})).catch(w.MediaDragDropError,(function(e){a.props.mediaCollection.length||a.props.onDropText(e.src)})),e.target&&e.target.value&&(e.target.value="")},a.onRemoveThumb=function(e,t){t.stopPropagation(),t.preventDefault(),a.props.mediaCollection.remove(e),0===a.props.mediaCollection.getValidMedias().length?a.delayedClose=setTimeout((function(){a.props.onBack()}),200):a.refSendButton&&S.default.focus(a.refSendButton)},a.onCaptionChange=function(e){var t=a.state,i=t.activeMedia,n=t.isInitCaptionUsed;if(i){var o=a.props.mediaCollection.indexOf(i);i.caption=e,0===o&&""===e&&n?a.setState({isInitCaptionUsed:!1}):a.forceUpdate()}},a.onPaste=function(e){e.preventDefault(),e.stopPropagation();var t=new y.default(e.clipboardData);t.hasFiles()&&a.onFiles(t)},a.onFiles=function(e){var t=e.getFiles().filter((function(e){var t=(0,N.typeFromMimetype)(e.type);return"image"===t||"video"===t})).map((function(e){return{file:e}}));a.props.mediaCollection.processAttachments(t,D.MEDIA_PICKER_ORIGIN_TYPE.PASTE)},a.setRefCaptionInput=function(e){a.state.activeMedia&&!e||(a.refCaptionInput=e)},a.getMedia=function(e){var t,i,n;switch(e.type){case W:case Y:t||(t=s.createElement(b.default,{mimeType:e.mimetype,url:e.fullPreview,isGif:e.isGif,size:e.fullPreviewSize,processing:e.state===H,preview:e.preview})),i=s.createElement("div",{className:u.default.captionInput,"data-animate-media-caption":!0},s.createElement(R.default,{ref:a.setRefCaptionInput,value:e.caption,placeholder:l10n.t(163),maxLength:C.default.MAX_CAPTION_LENGTH,onEnter:a.onSend,onChange:a.onCaptionChange,onFiles:a.onFiles,chat:a.props.chat,showRemaining:!0,spellCheck:!0,multiline:!0,supportsEmoji:!0}));break;case J:t=s.createElement(m.default,{mimeType:e.mimetype,url:e.fullPreview});break;case V:switch(O.default.previewType(e.mimetype)){case"pdf":t=s.createElement(v.default,{fullPreview:e.fullPreview,fullPreviewSize:e.fullPreviewSize,pdfPages:e.pdfPages,mimeType:e.mimetype,filename:e.filename});break;case"msoffice":t=s.createElement(h.default,{fullPreview:e.fullPreview,fullPreviewSize:e.fullPreviewSize,mimeType:e.mimetype,filename:e.filename});break;default:t=s.createElement(g.default,{mimeType:e.mimetype,filename:e.filename})}}return"image/gif"===e.originalMimetype&&(n=s.createElement("div",{className:u.default.mediaWarning,"data-animate-attach-media":!0},l10n.t(714)," ",s.createElement(j.default,{onClick:a.onWarningCtaClick},l10n.t(651)))),s.createElement("div",{className:u.default.mediaBody,key:e.id},t,n,i)},a.onWarningCtaClick=function(e){e.preventDefault(),E.default.openModal(s.createElement(M.default,{onOK:function(){return E.default.closeModal()}},l10n.t(509)))},a.getThumbs=function(e){return e.map((function(e,t){return s.createElement(p.default,{id:e.id,key:"media-"+e.id,active:e===a.state.activeMedia,attachMedia:e,onClick:a.onSelectThumb,onClose:a.onRemoveThumb,onRef:a.setAttachMediaRef})}))},a.setRefSendButton=function(e){a.refSendButton=e},a.state={activeMedia:null,prevActiveMedia:null,isInitCaptionUsed:!1,isDragging:!1},a}return(0,l.default)(t,e),(0,r.default)(t,null,[{key:"getDerivedStateFromProps",value:function(e,t){var a=e.mediaCollection.getActive(),i=e.initCaption&&e.initCaption.text,n=t.isInitCaptionUsed;return n||t.activeMedia||!i||!a||a.type!==W&&a.type!==Y||(a.caption=i,n=!0),{prevActiveMedia:t.activeMedia,activeMedia:a,isInitCaptionUsed:n}}}]),(0,r.default)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props,a=t.mediaCollection,i=t.listeners;i.add(a,"add remove reset",(function(){e.forceUpdate()})),i.add(a,"active-change change:state change:previewable",this.onMediaProcessUpdate),i.add(a,"files_not_supported",this.onFilesNotSupported),i.add(a,"max_upload_limit",this.showIgnoredToast),a.mediaPickerStatsLogger.resumeTimer()}},{key:"componentDidUpdate",value:function(e,t){var a=this;!t.activeMedia&&this.state.activeMedia&&this.refCaptionInput?this.props.listeners.uiIdle((function(){a.refCaptionInput&&a.refCaptionInput.restoreFocus()})):this.refSendButton&&this.refContainer&&!this.refContainer.contains(document.activeElement)&&S.default.focus(this.refSendButton)}},{key:"componentWillUnmount",value:function(){this.delayedClose&&clearTimeout(this.delayedClose),this.props.mediaCollection.mediaPickerStatsLogger.pauseTimer()}},{key:"render",value:function(){var e,t,a,i=this.props.mediaCollection,n=this.state,o=n.activeMedia,c=n.prevActiveMedia,d=0,r=!0,l=i.getPreviewableMedias();l.length>C.default.MAX_FILES&&(l=l.slice(0,C.default.MAX_FILES)),i.canSend()?o?e=this.getMedia(o):0===l.length&&i.errorMsgs&&(e=s.createElement("div",{className:u.default.invalidContainer,key:"pending"},s.createElement("div",{className:u.default.invalidMedia},i.errorMsgs))):(r=!1,e=s.createElement(U.default,{key:"processing",color:"highlight"})),l.length>0&&(t=this.getThumbs(l),d=1===l.length?400:400+(150+15*l.length),a=r?s.createElement("div",{className:u.default.btnSend,tabIndex:"-1",ref:this.setRefSendButton,onKeyPress:function(e){return e.preventDefault()}},s.createElement(L.default,{large:!0,onClick:this.onSend},s.createElement(F.default,{name:"send-light",directional:!0}))):null);var f=this.state.isDragging?s.createElement("div",{key:"container",className:u.default.dropOverlay},s.createElement("div",{className:u.default.dropOverlayOutline},l10n.t(415))):null,p=l.length<C.default.MAX_FILES?s.createElement("div",{className:u.default.btnAdd,key:"media-more",onClick:this.onAddFileClick,role:"button"},s.createElement(F.default,{name:"add-alt"}),s.createElement("div",{className:u.default.btnAddText},l10n.t(170))):null,m={enter:this.onEnter,left:this.onArrowLeft,right:this.onArrowRight},h="*"===O.default.DOC_MIMES?"*":[C.default.IMAGE_MIMES,C.default.VIDEO_MIMES,O.default.DOC_MIMES].join(),g="media-scale";return o&&c&&o!==c&&(g=i.indexOf(o)>i.indexOf(c)?"media-slide-forward":"media-slide-back"),s.createElement(T.default,{handlers:m,onRef:this.setRefContainer},s.createElement(_.default,{key:"attach-image-modal",theme:"media",onDrop:this.onDrop,onDragChange:this.onDragChange},s.createElement(P.default,{title:l10n.t(1394),type:P.DRAWER_HEADER_TYPE.OFFSET,onCancel:this.props.onBack}),s.createElement(I.default,{tabIndex:"-1",overflow:"hidden",onPaste:this.onPaste},f,s.createElement("div",{className:u.default.body},s.createElement(G.default,{transitionName:g},e)),s.createElement("div",{className:u.default.thumbs},s.createElement(G.default,{transitionAppear:!0,transitionName:"thumb-scale",className:u.default.thumbsContainer},t),p),s.createElement(G.default,{transitionAppear:!0,transitionName:"btn",delay:d},a),s.createElement("input",{ref:this.setRefInput,type:"file",accept:h,style:{display:"none"},onChange:this.onFilePick,multiple:!0}))))}}]),t}(s.Component),q=(0,x.default)((0,A.default)(K));t.default=q},ijdibihbi:function(e,t){e.exports={body:"NuJ4j",thumbs:"_3nuGo",thumbsContainer:"_2sSRd",btnSend:"_3nfoJ",captionInput:"_18KIe",mediaBody:"_3Mxes",invalidContainer:"_1e9zI",invalidMedia:"_2n7FA",mediaWarning:"_1qE6k",dropOverlay:"_2n-96",dropOverlayOutline:"_3L-be",btnAdd:"_1ypOz",btnAddText:"Vrmh_"}},jfbdejdfi:function(e,t,a){"use strict";var i=a("bfejgijfbh"),n=a("cfjecfhbfg");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=n(a("eaidjcib")),c=n(a("dgcdacjddi")),d=n(a("ffceefejc")),r=n(a("cjedcdbdii")),l=n(a("dbjagcfebh")),s=n(a("bgeijhbbad")),f=n(a("ceffhbhahb")),u=i(a("ddhijeejag")),p=n(a("bcjhbcbjbf")),m=n(a("baagejbchg")),h=n(a("bdiiahhjbe")),g=n(a("eabibhbeaf")),b=n(a("ihfccfgdf")),v=a("bheafeifce"),j=n(a("bfdcadbbif")),E=m.default.MSG_TYPE,C=E.IMAGE,M=E.VIDEO,y=E.DOCUMENT,_=E.AUDIO,I=(0,s.default)(g.default.MIMETYPES,(function(e){return e.msgType===y})),P=function(e){function t(){var e,a;(0,o.default)(this,t);for(var i=arguments.length,n=new Array(i),c=0;c<i;c++)n[c]=arguments[c];return(a=(0,d.default)(this,(e=(0,r.default)(t)).call.apply(e,[this].concat(n))))._onClick=function(e){a.props.onClick&&a.props.onClick((0,v.unproxy)(a.props.attachMedia),e)},a._onClose=function(e){a.props.onClose&&a.props.onClose((0,v.unproxy)(a.props.attachMedia),e)},a.setRef=function(e){e&&a.props.onRef(a.props.id,e)},a}return(0,l.default)(t,e),(0,c.default)(t,[{key:"_renderBody",value:function(){var e,t,a,i=this.props.attachMedia;switch(i.type){case C:a={backgroundImage:"url(".concat(i.preview,")")},e=u.createElement("div",{className:p.default.body,style:a});break;case M:a={backgroundImage:"url(data:image/jpeg;base64,".concat(i.preview,")")},e=u.createElement("div",{className:p.default.body,style:a});break;case _:e=u.createElement("div",{className:(0,f.default)(p.default.body,"attach-media-audio-thumb")});break;case y:if(h.default.log("media is",i)(),i.preview){var n={backgroundImage:"url("+i.preview+")"};e=u.createElement("div",{className:p.default.body,style:n});break}I[i.mimetype]&&(t=I[i.mimetype].icon);default:t=(0,f.default)(p.default.body,p.default.bodyDoc,t,{"icon-doc-generic":!t}),e=u.createElement("div",{className:t})}return e}},{key:"render",value:function(){var e=(0,f.default)(p.default.thumb,{[p.default.active]:this.props.active});return u.createElement("div",{className:e,onClick:this._onClick,role:"button",ref:this.setRef},u.createElement("div",{className:p.default.btnDelete,onClick:this._onClose,role:"button"},u.createElement(j.default,{name:"x-alt-light"})),this._renderBody())}}]),t}(u.PureComponent);P.CONCERNS={attachMedia:["mimetype","preview","type"]};var k=(0,b.default)(P,P.CONCERNS);t.default=k},jgbhhadeh:function(e,t){e.exports={container:"_3Qeli",preview:"_1RUry",img:"mBkWs"}},jgcieiibj:function(e,t,a){"use strict";var i=a("bfejgijfbh"),n=a("cfjecfhbfg");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=n(a("eaidjcib")),c=n(a("dgcdacjddi")),d=n(a("ffceefejc")),r=n(a("cjedcdbdii")),l=n(a("dbjagcfebh")),s=n(a("ceffhbhahb")),f=i(a("ddhijeejag")),u=n(a("bbchdeehff")),p=n(a("biddiiafgd")),m=a("dbgdaechch"),h=n(a("bjbggbjed")),g=a("cdheafhdbh"),b=n(a("dhfbfehaef")),v=n(a("dbcfhfbbbf")),j=n(a("cjgdeggcdi")),E=a("bfccafhbbb"),C=n(a("bfdcadbbif")),M=n(a("caffijjhc")),y=n(a("dbjbhajgfd")),_=a("chhhffajfi"),I=n(a("didfdhbecg")),P=function(e){function t(){var e,a;(0,o.default)(this,t);for(var i=arguments.length,n=new Array(i),c=0;c<i;c++)n[c]=arguments[c];return(a=(0,d.default)(this,(e=(0,r.default)(t)).call.apply(e,[this].concat(n)))).state={active:!1,emojiPicker:null},a.onEmojiPicker=function(e){e&&(e.preventDefault(),e.stopPropagation());var t=f.createElement(h.default,{onEmoji:a.onEmoji,onFocusNext:a.restoreFocus,onFocusPrev:a.restoreFocus});a.setState({emojiPicker:{menu:t,dirY:m.DirY.TOP,type:"emoji_picker",anchor:e.target}}),a.restoreFocus()},a.onEmojiPickerClose=function(){a.setState({emojiPicker:null})},a.onRestoreEmojiPickerFocus=function(){if(a.refEmojiPicker){var e=a.refEmojiPicker.getRef();if(e){var t=e.getElement();t&&t.restoreFocus()}}},a.onEmoji=function(e){var t=a.refInput;t&&(t.focus(!1),t.replaceSelection(e)),a.onEmojiPickerClose()},a.setRefInput=function(e){a.refInput=e},a.setRefEmojiPicker=function(e){a.refEmojiPicker=e},a.onSelectionChange=function(e){a.selection=e},a.onMaxPasteExceeded=function(){u.default.openModal(f.createElement(p.default,{title:l10n.t(279),onOK:function(){u.default.closeModal()},okText:l10n.t(1340)},l10n.t(278)))},a.restoreFocus=function(){a.refInput&&a.refInput.focus()},a.onBlur=function(e){a.state.active&&a.setState({active:!1}),a.props.onBlur&&a.props.onBlur(e)},a.onFocus=function(e){e.stopPropagation(),a.state.active||a.setState({active:!0}),a.props.onFocus&&a.props.onFocus(e)},a.onReset=function(){a.refInput&&a.refInput.reset()},a}return(0,l.default)(t,e),(0,c.default)(t,[{key:"componentDidMount",value:function(){this.props.focusOnMount&&this.restoreFocus()}},{key:"render",value:function(){var e,t=this.props.maxLength,a=(0,_.numCodepoints)(this.props.value||""),i=t-a<50,n=(0,s.default)(j.default.textInput,{[j.default.noPlaceholder]:!this.props.placeholder,[j.default.active]:!0}),o=(0,s.default)(j.default.labelText,{[j.default.float]:!!this.props.value}),c=(0,s.default)(j.default.wrapper,{[j.default.textActive]:this.state.active}),d=this.props.supportsEmoji?f.createElement("button",{className:j.default.inputEmoji,onClick:this.onEmojiPicker},f.createElement(C.default,{name:"emoji-input"})):void 0,r=this.props.value;e=r&&""!==r?f.createElement("div",{role:"button",className:j.default.clearInput,onClick:this.onReset},f.createElement(C.default,{name:"x-alt"})):null;var l,u=this.props.showRemaining?f.createElement("div",{className:(0,s.default)(j.default.buttonContainer,j.default.charCounter,{[j.default.charCounterWithClearBtn]:!!e})},f.createElement("div",{className:j.default.charCounter},i?l10n.n(t-a):null)):null;return this.state.emojiPicker&&(l=f.createElement(M.default,{displayName:"EmojiPicker",escapable:!0,popable:!0,ref:this.setRefEmojiPicker,requestDismiss:this.onEmojiPickerClose,requestFocus:this.onRestoreEmojiPickerFocus},f.createElement(y.default,{contextMenu:this.state.emojiPicker}))),f.createElement(b.default,{className:n,onFocus:this.restoreFocus},f.createElement("span",{className:o},this.props.placeholder),f.createElement("div",{className:j.default.spacer}),f.createElement("div",{className:j.default.suggestionsPositioner},f.createElement("div",{className:j.default.suggestionsContainer},f.createElement(v.default.MentionSuggestions,{chat:this.props.chat,theme:E.ThemeOptions.MEDIA_CAPTION}),f.createElement(v.default.EmojiSuggestions,{chat:this.props.chat,theme:g.ThemeOptions.MEDIA_CAPTION}))),f.createElement("div",{className:c},f.createElement(v.default,{ref:this.setRefInput,initialValue:this.props.value,initialSelection:this.selection,readOnly:!1,spellCheck:this.props.spellCheck,multiline:this.props.multiline,maxLength:this.props.maxLength,onEnter:this.props.onEnter,onMaxPasteExceeded:this.onMaxPasteExceeded,onFiles:this.props.onFiles,onChange:this.props.onChange,onSelect:this.onSelectionChange,theme:"media-caption"}),f.createElement("div",{className:j.default.inputControls},f.createElement(I.default,{transitionName:"pop",component:"div",className:j.default.buttonContainer},e,d),u)),l)}}]),t}(f.Component);t.default=P,P.defaultProps={maxLength:25}}}]);