/*! Copyright (c) 2022 WhatsApp Inc. All Rights Reserved. */
(self.webpackChunkwhatsapp_web_client=self.webpackChunkwhatsapp_web_client||[]).push([[3770],{8219:(e,t,r)=>{"use strict";var n=r(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.AdditionalChargesFormDrawer=function(e){let{currency:t,subtotal:r,additionalCharges:n,onBack:g,onApply:C}=e;const S=(null==n?void 0:n.discountText)||"",[M,T]=(0,u.useState)(S),O=(null==n?void 0:n.taxText)||"",[j,A]=(0,u.useState)(O),P=(null==n?void 0:n.shippingText)||"",[I,k]=(0,u.useState)(P),E=(null==n?void 0:n.discountType)||_,[D,w]=(0,u.useState)(E),R=(null==n?void 0:n.taxType)||v,[F,L]=(0,u.useState)(R),[N,U]=(0,u.useState)(!1),[B,q]=(0,u.useState)(!1),H=(0,u.useMemo)((()=>(0,h.additionalChargeErrorHandler)({currency:t,value:I})),[t,I]),G=[N,B,H].some((e=>e));return(0,x.jsxs)(d.default,{children:[(0,x.jsx)(c.DrawerHeader,{title:o.fbt._("Add discount, shipping or tax",null,{hk:"1O4Enc"}),type:c.DRAWER_HEADER_TYPE.SMALL,onBack:S!==M||O!==j||P!==I||E!==D||R!==F?()=>{a.ModalManager.open((0,x.jsx)(m.ConfirmDiscardModal,{onOK:g}))}:g,focusBackOrCancel:!0}),(0,x.jsxs)(f.default,{className:(0,i.default)(l.uiPadding.all16),children:[(0,x.jsx)(p.AdditionalChargesTextInput,{text:M,a8nText:"additional-charges-discount-input",label:o.fbt._("Discount",null,{hk:"3dW1e0"}),symbol:D,currency:t,priceValue:r,setText:T,setError:U,setSymbol:w}),(0,x.jsx)(b.TextInput,{value:I,a8n:"additional-charges-shipping-input",placeholder:o.fbt._("Shipping ({currency_symbol})",[o.fbt._param("currency_symbol",(0,s.formatAmount1000ToParts)(t,0).symbol)],{hk:"1z5IVc"}),onChange:k,theme:"small",maxLength:10,customStyleThemes:["desaturated"],error:H}),(0,x.jsx)(p.AdditionalChargesTextInput,{text:j,a8nText:"additional-charges-tax-input",label:o.fbt._("Tax",null,{hk:"2Ghypp"}),symbol:F,currency:t,priceValue:r,setText:A,setError:q,setSymbol:L}),(0,x.jsx)(y.OrderApplyChangesButton,{disabled:G,a8nText:"apply-additional-costs-button",title:o.fbt._("Apply",null,{hk:"1af9Ka"}),onClick:()=>C({discountText:M,taxText:j,shippingText:I,discountType:D,taxType:F})})]})]})};var a=r(14597),l=r(28298),o=r(48360),u=r(67294),i=n(r(56720)),s=r(39519),d=n(r(60453)),c=r(94790),f=n(r(33308)),p=r(52088),m=r(3445),h=r(47188),g=r(59789),y=r(33877),b=r(90011),x=r(85893);const _=g.PERCENTAGE_SYMBOL,v=g.PERCENTAGE_SYMBOL},52088:(e,t,r)=>{"use strict";var n=r(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.AdditionalChargesTextInput=function(e){let{text:t,label:r,symbol:n,a8nText:m,currency:h,priceValue:g,setText:y,setError:b,setSymbol:x}=e;const _=(0,l.useMemo)((()=>{const e=(0,i.additionalChargeErrorHandler)({label:r,currency:h,fieldType:n,maxFlatValue:g/s.DEFAULT_OFFSET,enablePercentValueCheck:!0,value:t});return b(Boolean(e)),e}),[t,r,n,h,b,g]);return(0,c.jsxs)("div",{className:(0,o.default)(f),children:[(0,c.jsx)(d.TextInput,{value:t,a8n:m,placeholder:a.fbt._("{input_label} ({currency_or_percentage})",[a.fbt._param("input_label",r),a.fbt._param("currency_or_percentage",n)],{hk:"1j7m80"}),onChange:e=>y(e),theme:"small",maxLength:10,customStyleThemes:["desaturated"],error:_}),(0,c.jsx)("div",{className:(0,o.default)(p),children:(0,c.jsx)(u.OrderDetailAmountTypeSelector,{currency:h,value:n,onChange:e=>{let{value:t}=e;return x(t)}})})]})};var a=r(48360),l=r(67294),o=n(r(56720)),u=r(70239),i=r(47188),s=r(59789),d=r(90011),c=r(85893);const f={position:"g0rxnol2"},p={position:"lhggkp7q",end:"ebjesfe0",zIndex:"mb8var44",top:"agjvi7sf"}},15607:(e,t,r)=>{"use strict";var n=r(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.CatalogFormDrawer=function(e){let{currency:t,orderProducts:r,onBack:n,onAddProdutcs:O,onAddCustomItem:j}=e;const[A,P]=(0,s.useState)(0),[I,k]=(0,s.useState)(!0),[E,D]=(0,s.useState)(!1),w=(0,c.default)(),R=(0,f.default)((()=>new b.default)),F=(0,f.default)((()=>new o.default([],(e=>e.id.toString())))).current,L=F.getSelected().reduce(((e,t)=>e+(t.priceAmount1000||0)*Number(F.getVal(t))),0);return(0,M.jsxs)(m.default,{children:[(0,M.jsx)(g.DrawerHeader,{title:i.fbt._("Add items",null,{hk:"2nsVXo"}),type:g.DRAWER_HEADER_TYPE.SMALL,onBack:(I?A:E)?()=>{l.ModalManager.open((0,M.jsx)(v.ConfirmDiscardModal,{onOK:n}))}:n,focusBackOrCancel:!0}),(0,M.jsxs)(h.default,{children:[(0,M.jsxs)(y.default,{theme:"expand-height",xstyle:T.drawerSection,children:[(0,a.orderDetailsCustomItemEnabled)()&&(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(x.AddOrderItem,{title:i.fbt._("Add custom item",null,{hk:"DCIZF"}),onClick:j}),(0,M.jsx)("hr",{className:(0,d.default)(T.catalogBar,u.uiMargin.vert0)})]}),(0,M.jsx)("p",{className:(0,d.default)(T.catalogTitleText,u.uiPadding.start16,u.uiPadding.vert10),children:i.fbt._("Catalog items",null,{hk:"2rgdJA"})}),(0,M.jsx)(_.default,{className:(0,d.default)(T.catalogProductsList),selections:F,selectedProducts:r,flatListController:R.current,updateCounters:(e,t)=>{P(e),k(t)},onProductSelect:e=>{const t=F.isSelected(e);F.setVal(e,t?0:1),P(A+(t?-1:1)),E||D(!0),w()},onProductQuantityChange:(e,t)=>{F.setVal(e,t),E||D(!0),w()}})]}),(0,M.jsx)(S.OrderTotalPrice,{xstyle:[u.uiPadding.all16,u.uiMargin.top10],visible:!0,disabled:I?0===A:!E,totalPrice:(0,p.formatAmount1000)(t,L),a8nButtonText:"save-products-button",onConfirm:()=>{const e=F.getSelected().map((e=>{var t;return new C.default({id:e.id,name:e.name,price:e.priceAmount1000,thumbnailUrl:null===(t=e.getPreviewImage())||void 0===t?void 0:t.mediaUrl,quantity:Number(F.getVal(e)),isCustomItem:!1,isQuantitySet:!0})}));O(e)},title:i.fbt._("Estimated total",null,{hk:"1mIWnC"}),confirmTitle:I?i.fbt._("Add to Order",null,{hk:"3paxqQ"}):i.fbt._("Update Order",null,{hk:"44rGm7"})})]})]})};var a=r(8139),l=r(14597),o=n(r(78931)),u=r(28298),i=r(48360),s=r(67294),d=n(r(56720)),c=n(r(59312)),f=n(r(16223)),p=r(39519),m=n(r(60453)),h=n(r(69637)),g=r(94790),y=n(r(33308)),b=n(r(30855)),x=r(58795),_=n(r(31499)),v=r(3445),C=n(r(52822)),S=r(33877),M=r(85893);r(76672).Mirrored(["CATALOG_PRODUCTS_FORM","CUSTOM_ITEM_FORM","ORDER_SUMMARY","ADDITIONAL_CHARGES_FORM"]);const T={catalogTitleText:{fontWeight:"m1e7cby3",lineHeight:"tkq7s68q",fontSize:"ovllcyds",color:"q70jrbp7"},catalogBar:{width:"ln8gz9je",borderEnd:"eta5aym1",borderBottom:"d9802myq",borderStart:"e4xiuwjv",borderTop:"gq6acybq"},catalogProductsList:{overflowX:"i44ccddp",overflowY:"ag5g9lrv",flexGrow:"ggj6brxn",flexShrink:"m0h2a7mj",flexBasis:"l07amlnk"},drawerSection:{display:"p357zi0d",overflowX:"i44ccddp",overflowY:"ag5g9lrv",flexDirection:"f8m0rgwh"}}},39504:(e,t,r)=>{"use strict";var n=r(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.CatalogFormProduct=function(e){let{product:t,selections:r,onProductClick:n,onProductQuantityChange:i}=e;return(0,u.jsx)(l.default,{model:t,selections:r,children:(0,u.jsx)(o.default,{product:t,onClick:()=>n(t),checkbox:!0,detail:r.isSelected(t)&&(0,u.jsx)("div",{children:(0,u.jsx)(a.default,{quantity:Number(r.getVal(t)),onChange:e=>i(t,e),a8nText:"product-quantity-selector"})})})},t.id.toString())};var a=n(r(39864)),l=n(r(90233)),o=n(r(88990)),u=r(85893)},31499:(e,t,r)=>{"use strict";var n=r(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){let{className:t,selections:r,selectedProducts:n,flatListController:_,updateCounters:v,onProductSelect:C,onProductQuantityChange:S}=e;const M=(0,f.default)(),T=(0,s.default)(),O=(0,i.default)(T,100),j=p.CatalogCollection.assertGet((0,o.getMaybeMeUser)()),[A,P]=(0,u.useState)(!1),[I,k]=(0,u.useState)(0),[E,D]=(0,u.useState)(!1),w=(0,u.useRef)(0),R=()=>j.productCollection.getProductModels().map((e=>({itemKey:e.id.toString(),product:e}))),F=e=>{let t=w.current;e.forEach((e=>{const a=n.find((t=>t.id===e.product.id));void 0!==a&&(r.setVal(e.product,Number(a.quantity)),t+=1)})),w.current=t;v(t,0===t)},L=function(){var e=(0,a.default)((function*(){if(E)return;if(!j.afterCursor)return;const e=j.productCollection.getProductModels().length;P(!0),k(e);try{const t=yield p.CatalogCollection.update((0,o.getMaybeMeUser)());if(M.aborted)return;P(!1);const r=(Array.isArray(t)?t[0]:t).productCollection.getProductModels().length;if(F(R().slice(e)),r===I&&D(!0),e*m.PRODUCT_LIST_ITEM_HEIGHT<window.innerHeight)return L()}catch(e){P(!1),D(!0)}}));return function(){return e.apply(this,arguments)}}();(0,u.useEffect)((()=>{F(R()),L()}),[]),(0,d.useListener)(j.productCollection,"add",O);const N=(0,c.default)((e=>{A||e.scrollTop+l.SCROLL_FUDGE>e.scrollHeight-e.clientHeight&&L()}),100);return(0,x.jsxs)(g.default,{className:t,flatListControllers:[_],onScroll:e=>{e.currentTarget&&N(e.currentTarget)},children:[(0,x.jsx)(h.FlatList,{flatListController:_,direction:"vertical",forceConsistentRenderCount:!1,data:R(),renderItem:e=>{let{product:t}=e;return(0,x.jsx)(b.CatalogFormProduct,{product:t,selections:r,onProductClick:C,onProductQuantityChange:S})},defaultItemHeight:m.PRODUCT_LIST_ITEM_HEIGHT}),A&&(0,x.jsx)(y.default,{})]})};var a=n(r(48926)),l=r(41906),o=r(78820),u=r(67294),i=n(r(51799)),s=n(r(59312)),d=r(87550),c=n(r(90886)),f=n(r(3409)),p=r(99989),m=r(64481),h=r(47915),g=n(r(44942)),y=n(r(29796)),b=r(39504),x=r(85893)},3445:(e,t,r)=>{"use strict";var n=r(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.ConfirmDiscardModal=function(e){let{onOK:t}=e;return(0,i.jsx)(o.default,{title:l.fbt._("Discard changes?",null,{hk:"2aroAx"}),onOK:()=>{a.ModalManager.close(),t()},okText:l.fbt._("Discard",null,{hk:"2rIxjp"}),onCancel:()=>a.ModalManager.close(),children:(0,i.jsx)(u.TextDiv,{theme:"muted",children:l.fbt._("If you close this, your draft will be discarded.",null,{hk:"2Sbnur"})})})};var a=r(14597),l=r(48360),o=n(r(52665)),u=r(13923),i=r(85893)},73668:(e,t,r)=>{"use strict";var n=r(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.CustomItemFormDrawer=function(e){let{currency:t,customItem:r,onBack:n,onSaveCustomItem:s}=e;const[v,C]=(0,u.useState)(null==r?void 0:r.name),[S,M]=(0,u.useState)(Number.isInteger(null==r?void 0:r.price)?String(Number(null==r?void 0:r.price)/1e3):null),[T,O]=(0,u.useState)(null==r?void 0:r.price),[j,A]=(0,u.useState)((null==r?void 0:r.isQuantitySet)?r.quantity:null),[P,I]=(0,u.useState)((null==r?void 0:r.isQuantitySet)?String(r.quantity):null),k=(0,u.useMemo)((()=>function(e){if(null==e)return"";const t=String(o.fbt._("Add a title",null,{hk:"1wJ7fh"}));return""===e.trim()?t:""}(v)),[v]),E=(0,u.useMemo)((()=>function(e,t){if(null==t)return"";const r=String(o.fbt._("Enter a valid price",null,{hk:"KWrAE"}));return""!==t.trim()&&(0,d.validatePriceString)(e,t,y.MIN_PRICE,y.MAX_PRICE)?"":r}(t,S)),[t,S]),D=(0,u.useMemo)((()=>function(e){if(null==e)return"";const t=String(o.fbt._("Enter a valid quantity",null,{hk:"2KDyC5"}));return _(Number(e))?"":t}(P)),[P]),w=function(e,t,r,n){const a=(null==e?void 0:e.isQuantitySet)?Number(n)!==e.quantity:null!=n;return(null==e?void 0:e.name)!==t||(null==e?void 0:e.price)!==r||a}(r,v,T,P);return(0,x.jsxs)(c.default,{children:[(0,x.jsx)(p.DrawerHeader,{title:r?o.fbt._("Update items",null,{hk:"8H9jW"}):o.fbt._("Add items",null,{hk:"2SjafD"}),type:p.DRAWER_HEADER_TYPE.SMALL,onBack:w?()=>{a.ModalManager.open((0,x.jsx)(h.ConfirmDiscardModal,{onOK:n}))}:n,focusBackOrCancel:!0}),(0,x.jsx)(f.default,{children:(0,x.jsxs)(m.default,{className:(0,i.default)(l.uiPadding.all16),children:[(0,x.jsx)(b.TextInput,{a8n:"custom-item-edit-name-input",value:v,placeholder:o.fbt._("Item name",null,{hk:"1LDktG"}),onChange:e=>{C(e)},theme:"small",customStyleThemes:["desaturated"],maxLength:150,error:k}),(0,x.jsx)(b.TextInput,{a8n:"custom-item-edit-price-input",value:S,placeholder:o.fbt._("Price {symbol}",[o.fbt._param("symbol",(0,d.formatAmount1000ToParts)(t,0).symbol)],{hk:"3yCPZW"}),onChange:e=>{const r=(0,d.valueFromString)(t,e);O(r),M(e)},theme:"small",maxLength:30,customStyleThemes:["desaturated"],error:E}),(0,x.jsx)(b.TextInput,{a8n:"custom-item-edit-quantity-input",value:P,placeholder:o.fbt._("Quantity (Optional)",null,{hk:"30uF5W"}),onChange:e=>{let t=""===e?null:Number(e);_(t)||(t=null),A(t),I(""===e?null:e)},theme:"small",maxLength:30,customStyleThemes:["desaturated"],error:D}),(0,x.jsx)(g.OrderApplyChangesButton,{title:r?o.fbt._("Update Order",null,{hk:"4ckyCu"}):o.fbt._("Add to Order",null,{hk:"4iSOkO"}),disabled:null==v||null==S||!(!r||w)||[k,E,D].some((e=>e)),onClick:()=>{const e={name:v,priceAmount1000:+T,quantity:j,isQuantitySet:Number.isInteger(j)};s(e)},a8nText:"save-custom-item-button"})]})})]})};var a=r(14597),l=r(28298),o=r(48360),u=r(67294),i=n(r(56720)),s=r(9581),d=r(39519),c=n(r(60453)),f=n(r(69637)),p=r(94790),m=n(r(33308)),h=r(3445),g=r(33877),y=r(9468),b=r(90011),x=r(85893);function _(e){return Number.isInteger(e)&&+e>0&&+e<=s.MAX_QUANTITY}},70239:(e,t,r)=>{"use strict";var n=r(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.OrderDetailAmountTypeSelector=function(e){let{value:t,onChange:r,currency:n}=e;const d=o.formatLocalSymbol(n),c=a.fbt._("Select amount type",null,{hk:"1xddkG"}),f=[{id:"percentage",label:a.fbt._("by Percentage ({percentage-symbol})",[a.fbt._param("percentage-symbol",u.PERCENTAGE_SYMBOL)],{hk:"3fQwM3"}),value:u.PERCENTAGE_SYMBOL},{id:"flat-amount",label:a.fbt._("by Flat amount ({currency-symbol})",[a.fbt._param("currency-symbol",d)],{hk:"duPhj"}),value:d}],p=(0,l.useMemo)((()=>f.findIndex((e=>e.value===t))),[]);return(0,s.jsx)(i.default,{"aria-label":c,options:f,defaultIndex:p,onChange:r})};var a=r(48360),l=r(67294),o=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=d(t);if(r&&r.has(e))return r.get(e);var n={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in e)if("default"!==l&&Object.prototype.hasOwnProperty.call(e,l)){var o=a?Object.getOwnPropertyDescriptor(e,l):null;o&&(o.get||o.set)?Object.defineProperty(n,l,o):n[l]=e[l]}n.default=e,r&&r.set(e,n);return n}(r(39519)),u=r(59789),i=n(r(43369)),s=r(85893);function d(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(d=function(e){return e?r:t})(e)}},43369:(e,t,r)=>{"use strict";var n=r(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){let{defaultIndex:t=0,options:r,onChange:n,"aria-label":p}=e;const m=(0,a.useRef)(null),[h,g]=(0,a.useState)(!1),[y,b]=(0,a.useState)(t),x=r.map(((e,t)=>{const{id:r,label:a}=e;return(0,c.jsx)(u.DropdownItem,{a8n:`mi-${r}`,action:()=>{n(e),b(t)},children:(0,c.jsx)("div",{className:(0,l.default)(f),role:"button","aria-label":a,children:t===y?(0,c.jsx)(i.TextSpan,{weight:"bold",children:a}):a})},r)}));return(0,c.jsxs)("div",{ref:m,children:[(0,c.jsx)(o.default,{"aria-label":p,postfixIcon:"down",label:r[y].value,onClick:()=>g((e=>!e))}),h&&m.current&&(0,c.jsx)(s.UIE,{displayName:"ValuePicker",escapable:!0,popable:!0,dismissOnWindowResize:!0,requestDismiss:()=>g(!1),children:(0,c.jsx)(d.default,{contextMenu:{menu:x,anchor:m.current}})})]})};var a=r(67294),l=n(r(56720)),o=n(r(72332)),u=r(71174),i=r(13923),s=r(18644),d=n(r(24717)),c=r(85893);const f={boxSizing:"cm280p3y",color:"tviruh8d",cursor:"ajgl1lbb",fontSize:"f8jlpxt4",height:"lniyxyh2",lineHeight:"gz7w46tb",overflowX:"gfz4du6o",overflowY:"r7fjleex",paddingStart:"sta02ykp",paddingEnd:"pnfw7ual",paddingTop:"lqdozo90",textOverflow:"lhj4utae",whiteSpace:"le5p0ye3",position:"g0rxnol2"}},29886:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getErrorMsgFromProducts=u,t.notifyIfAnyProductMissesPrice=void 0;var n=r(94816),a=r(48360),l=r(50452),o=r(85893);function u(e){const t=e.length;return 0===t?"":1===t?a.fbt._("Enter a price for {first-product-name}",[a.fbt._param("first-product-name",e[0])],{hk:"4ypZH8"}):2===t?a.fbt._("Enter prices for {first-product-name} and {second-product-name}",[a.fbt._param("first-product-name",e[0]),a.fbt._param("second-product-name",e[1])],{hk:"3o3aq3"}):a.fbt._({"*":"Enter prices for {first-product-name}, {second-product-name} and {other-items} other items",_1:"Enter prices for {first-product-name}, {second-product-name} and 1 other item"},[a.fbt._plural(t-2,"other-items"),a.fbt._param("first-product-name",e[0]),a.fbt._param("second-product-name",e[1])],{hk:"2AB1Gl"})}t.notifyIfAnyProductMissesPrice=(e,t)=>{const r=u(e.reduce(((e,r)=>{var n;const a=null!==(n=r.price)&&void 0!==n?n:t[r.id];return Number.isInteger(a)||e.push(r.name||""),e}),[]));r&&n.ToastManager.open((0,o.jsx)(l.Toast,{duration:1e4,id:(0,l.genId)(),msg:r,action:{actionText:a.fbt._("OKAY",null,{hk:"24jI97"}),dismiss:!0,theme:"success"}}))}},63770:(e,t,r)=>{"use strict";var n=r(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){let{order:t,chat:r,onBack:n}=e;const[m,h]=(0,d.useState)(I.ORDER_SUMMARY),[P,D]=(0,d.useState)(null),[w,R]=(0,d.useState)(!1),[F,L]=(0,d.useState)((()=>function(e){if(!e)return[];const t={isCustomItem:!1,isQuantitySet:!0},r=e.products.map((e=>new M.default((0,a.default)((0,a.default)({},t),e))));return(0,S.notifyIfAnyProductMissesPrice)(r,{}),r}(t))),[N,U]=(0,d.useState)({}),[B,q]=(0,d.useState)(null),H=(e,t)=>{U((r=>(0,a.default)((0,a.default)({},r),{},{[t]:e})))},G=(0,d.useMemo)((()=>F.reduce(((e,t)=>{var r,n;return e+(null!==(r=null!==(n=t.price)&&void 0!==n?n:N[t.id])&&void 0!==r?r:0)*t.quantity}),0)),[F,N]),Q=(0,C.calculateFlatAmounts)({orderSubtotal:G/C.DEFAULT_OFFSET,discountType:(null==B?void 0:B.discountType)||"",discountText:(null==B?void 0:B.discountText)||"",taxType:(null==B?void 0:B.taxType)||"",taxText:(null==B?void 0:B.taxText)||"",shippingText:(null==B?void 0:B.shippingText)||""}),W=()=>{const e=null!=t?t:x.OrderCollection.addOrder();e.products=F.map((e=>{var t;return e.price=null!==(t=e.price)&&void 0!==t?t:N[e.id],e.currency=E,e})),e.currency=E,e.subtotal=G,e.triggerItemCollectionUpdate(),(0,O.sendOrderDetailsMessageAsMerchant)({order:e,chat:r,orderNote:"",offset:C.DEFAULT_OFFSET,total:Q.total,discount:Q.discount,shipping:Q.shipping,tax:Q.tax}),l.DrawerManager.closeDrawerRight()},Y=(0,p.hasCatalog)(f.BusinessProfileCollection.get((0,i.getMaybeMeUser)())),V=(0,c.default)((()=>{n?n():l.DrawerManager.closeDrawerRight()})),z=()=>{!function(e,t,r){if(!e)return t.length>0;return t.length!==e.products.length||t.some(((t,n)=>{var a,l;return t.id!==e.products[n].id||t.quantity!==e.products[n].quantity||(null!==(a=null!==(l=t.price)&&void 0!==l?l:r[t.id])&&void 0!==a?a:null)!==e.products[n].price}))}(t,F,N)?V():u.ModalManager.open((0,A.jsx)(_.ConfirmDiscardModal,{onOK:V}))},K=e=>{!0!==e&&(0,S.notifyIfAnyProductMissesPrice)(F,N),h(I.ORDER_SUMMARY)},X=()=>{h(I.CATALOG_PRODUCTS_FORM)},Z=(e,t)=>{const r=Number.isInteger(e)?e:null;D(r),R(!0===t),h(null==r||F[r].isCustomItem?I.CUSTOM_ITEM_FORM:I.CATALOG_PRODUCTS_FORM)},J=()=>{h(I.ADDITIONAL_CHARGES_FORM)},$=(e,t)=>{const r=e.length,n=e.reduce(((e,t,r)=>e.set(t.id,r)),new Map);return[...t].sort(((e,t)=>{var a,l;return(null!==(a=n.get(e.id))&&void 0!==a?a:r)-(null!==(l=n.get(t.id))&&void 0!==l?l:r)}))},ee=e=>{L((t=>[...t.slice(0,e),...t.slice(e+1)]))},te=e=>{null!=P?((e,t)=>{L((r=>{var n;const a=[...r];return a[t].set({name:String(e.name),price:Number(e.priceAmount1000),quantity:null!==(n=e.quantity)&&void 0!==n?n:1,isQuantitySet:e.isQuantitySet}),a}))})(e,P):(e=>{let{name:t,priceAmount1000:r,quantity:n,isQuantitySet:a}=e;const l=(0,g.default)();L((e=>$(e,[...e,new M.default({id:l,name:t,price:r,quantity:null!=n?n:1,isCustomItem:!0,isQuantitySet:a})])))})(e)},re=k.indexOf(m);if(!m)return null;return(0,A.jsx)(s.default,{children:(0,A.jsx)(j.UIE,{displayName:`FlowDrawer${re}`,escapable:!0,children:(0,A.jsx)("div",{children:function(e){switch(e){case I.CATALOG_PRODUCTS_FORM:return(0,A.jsx)(b.CatalogFormDrawer,{currency:E,orderProducts:F,onBack:K,onAddProdutcs:e=>{var t;t=e,L((e=>$(e,[...e.filter((e=>e.isCustomItem)),...t]))),(0,S.notifyIfAnyProductMissesPrice)(t,N),K(!0)},onAddCustomItem:()=>{Z(null,!0)}});case I.CUSTOM_ITEM_FORM:return(0,A.jsx)(v.CustomItemFormDrawer,{currency:E,onBack:w?X:K,onSaveCustomItem:e=>{te(e),K()},customItem:F[Number.isInteger(P)?Number(P):-1]});case I.ORDER_SUMMARY:return(0,A.jsx)(T.OrderSummaryDrawer,{chat:r,currency:E,priceMap:N,orderItems:F,orderSubtotal:G,flatAdditionalAmounts:Q,onPriceChange:H,onBack:z,onSubmit:W,onAddItem:Y&&(0,o.orderDetailsFromCatalogEnabled)()?X:Z,onAdditionalCharges:J,onDeleteItem:ee,onEditItem:Z});case I.ADDITIONAL_CHARGES_FORM:return(0,A.jsx)(y.AdditionalChargesFormDrawer,{currency:E,additionalCharges:B,subtotal:G,onBack:K,onApply:e=>{q((t=>(0,a.default)((0,a.default)({},t),e))),K()}})}}(m)})},re)})};var a=n(r(81109)),l=r(41455),o=r(8139),u=r(14597),i=r(78820),s=n(r(40436)),d=r(67294),c=n(r(16031)),f=r(93581),p=r(94010),m=r(92059),h=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=P(t);if(r&&r.has(e))return r.get(e);var n={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in e)if("default"!==l&&Object.prototype.hasOwnProperty.call(e,l)){var o=a?Object.getOwnPropertyDescriptor(e,l):null;o&&(o.get||o.set)?Object.defineProperty(n,l,o):n[l]=e[l]}n.default=e,r&&r.set(e,n);return n}(r(39519)),g=n(r(48456)),y=r(8219),b=r(15607),x=r(84312),_=r(3445),v=r(73668),C=r(59789),S=r(29886),M=n(r(52822)),T=r(52604),O=r(73150),j=r(18644),A=r(85893);function P(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(P=function(e){return e?r:t})(e)}const I=r(76672).Mirrored(["CATALOG_PRODUCTS_FORM","CUSTOM_ITEM_FORM","ORDER_SUMMARY","ADDITIONAL_CHARGES_FORM"]),k=Array.from(I.members()),E=h.currencyForCountryShortcode((0,m.getCountryShortcodeByPhone)((0,i.getMeUser)().user))}}]);
//# sourceMappingURL=https://web.whatsapp.com/3770.68a03ce196420ccde013.js.map
