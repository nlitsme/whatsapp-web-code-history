/*! Copyright (c) 2021 WhatsApp Inc. All Rights Reserved. */
(self.webpackChunkwhatsapp_web_client=self.webpackChunkwhatsapp_web_client||[]).push([[7205],{31351:e=>{var t=Array.prototype.reverse;e.exports=function(e){return null==e?e:t.call(e)}},2027:(e,t,a)=>{"use strict";var s=a(20862),i=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.setGroupDesc=function(e,t=""){return m((0,p.unproxy)(e),t)};var l=a(55084),n=a(6467),o=i(a(91952)),r=a(54647),d=s(a(13540)),u=i(a(2408)),c=a(19986),h=i(a(17754)),p=a(15298),f=a(85893);function m(e,t="",a=(0,n.genId)()){var s,i,p,g=t&&t.trim();if(g===(null===(s=e.groupMetadata)||void 0===s?void 0:s.desc))return Promise.reject(new d.ActionError);""===g&&(g=null);var v=(0,c.sendSetGroupDescription)(e.id,g,(0,h.default)(),null===(i=e.groupMetadata)||void 0===i?void 0:i.descId),_=null===(p=e.groupMetadata)||void 0===p?void 0:p.desc,x=new n.ActionType(u.default.t(124)),C=v.then((()=>new n.ActionType(u.default.t(126),{actionText:u.default.t(224),actionHandler:()=>m(e,_,a)}))).catch((0,l.filteredCatch)(r.ServerStatusCodeError,(e=>{if(e.status>=400)return new n.ActionType(u.default.t(125))}))).catch((()=>(__LOG__(3)`models:chat:setGroupDesc dropped`,new n.ActionType(u.default.t(125),{actionText:u.default.t(220),actionHandler:()=>m(e,g,a)}))));return o.default.openToast((0,f.jsx)(n.ActionToast,{id:a,initialAction:x,pendingAction:C})),v.then((t=>{var a;t._duplicate||(null===(a=e.groupMetadata)||void 0===a||a.set({desc:g||""}))})).catch((0,l.filteredCatch)(r.ServerStatusCodeError,(()=>{})))}},32593:(e,t,a)=>{"use strict";var s=a(20862),i=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.setGroupSubject=function(e,t=""){return m((0,h.unproxy)(e),t)};var l=a(55084),n=a(6467),o=i(a(91952)),r=a(54647),d=s(a(13540)),u=i(a(2408)),c=a(19986),h=a(15298),p=a(75824),f=a(85893);function m(e,t,a=(0,n.genId)()){var s=t.trim();if(!s)return Promise.reject(new d.ActionError);if(s===e.contact.name)return Promise.reject(new d.ActionError);var i=(0,c.sendSetGroupSubject)(e.id,s),h=e.contact.name,g=new n.ActionType(u.default.t(144)),v=i.then((()=>new n.ActionType(u.default.t(143,{subject:s}),{actionText:u.default.t(224),actionHandler:()=>m(e,h,a)}))).catch((0,l.filteredCatch)(r.ServerStatusCodeError,(e=>{if(e.status>=400)return new n.ActionType(u.default.t(142))}))).catch((()=>(__LOG__(3)`models:chat:setSubject dropped`,new n.ActionType(u.default.t(142),{actionText:u.default.t(220),actionHandler:()=>m(e,s,a)}))));return o.default.openToast((0,f.jsx)(n.ActionToast,{id:a,initialAction:g,pendingAction:v})),i.then((t=>{if(!t._duplicate){var a={name:s};return(0,p.updateLocal)(e.contact.id,a).then((()=>{e.contact.set(a)}))}})).catch((0,l.filteredCatch)(r.ServerStatusCodeError,(()=>{})))}},76865:(e,t,a)=>{"use strict";var s=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var{contact:t,onClick:a,contextMenu:s,isPendingParticipant:o,contextEnabled:r,onContext:d}=e,u=(0,l.default)(e.participant,["isAdmin"]);return(0,n.jsx)(i.default,{contact:t,admin:u.isAdmin,onClick:a,theme:"drawer-list",contextEnabled:()=>null!=r&&r(t),contextMenu:s,onContext:e=>d&&d(e,t),isPendingParticipant:o,showNotifyName:!0,waitIdle:!0})};var i=s(a(70521)),l=s(a(76006)),n=a(85893)},88654:(e,t,a)=>{"use strict";var s=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(a(81109)),l=s(a(6479)),n=a(67294),o=a(58380),r=s(a(52384)),d=s(a(12950)),u=s(a(2408)),c=s(a(71681)),h=s(a(26630)),p=s(a(2966)),f=a(85893);class m extends n.Component{constructor(...e){super(...e),this._setGallery=e=>{this._gallery=e},this._queryCollection=(e,t)=>{var{docMsgs:a,chat:s}=this.props;this.props.listeners.uiIdle((()=>{a.queryDocs(s,t)}))}}componentDidMount(){this.props.listeners.add(this.props.docMsgs,"add remove reset",(()=>{var e;null===(e=this._gallery)||void 0===e||e.forceUpdate()})),this.props.listeners.add(this.props.docMsgs,"query_doc_before",(()=>{var e;null===(e=this._gallery)||void 0===e||e.forceUpdate()}))}render(){var e,t=this.props,{docMsgs:a,listeners:s,chat:n}=t,c=(0,l.default)(t,["docMsgs","listeners","chat"]);return d.default.supportsFeature(d.default.F.MD_BACKEND)&&n.endOfHistoryTransferType===o.ConversationEndOfHistoryTransferModelPropType.COMPLETE_BUT_MORE_MESSAGES_REMAIN_ON_PRIMARY&&(e=(0,f.jsx)(r.default,{icon:(0,f.jsx)(p.default,{name:"content-chat"}),theme:"list",secondary:u.default.t(718),children:u.default.t(719)})),(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(h.default,(0,i.default)({ref:this._setGallery,msgsCollection:a,queryCollection:this._queryCollection,hasBefore:a.hasDocBefore,queryBefore:a.queryDocBefore,emptyText:u.default.t(1342),chat:n},c)),e]})}}m.displayName="DocGallery";var g=(0,c.default)(m);t.default=g},38946:(e,t,a)=>{"use strict";var s=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var{chat:t,groupMetadata:a,onClick:s}=e;return a?(0,g.jsx)(C,{groupMetadata:a,onClick:s}):(0,g.jsx)(_,{chat:t,onClick:s})},t.BaseEphemeralSettingRow=M;var i=a(67294),l=a(38512),n=s(a(91952)),o=s(a(75940)),r=s(a(92787)),d=s(a(35346)),u=s(a(12950)),c=a(31140),h=s(a(2408)),p=s(a(79485)),f=s(a(2966)),m=a(97504),g=a(85893);class v extends i.PureComponent{constructor(...e){super(...e),this._getEphemeralDuration=()=>{var e;return null!==(e=this.props.chat.ephemeralDuration)&&void 0!==e?e:0},this._unblockContact=()=>{var{chat:e,onClick:t}=this.props;e.contact.addPendingAction((0,l.unblockContact)(e.contact)).then((()=>{t(),n.default.closeModal()})).catch((()=>{}))},this._closeModal=()=>{n.default.closeModal()},this._openUnblockContactModal=()=>{n.default.openModal((0,g.jsx)(o.default,{onOK:this._unblockContact,okText:h.default.t(1661),onCancel:this._closeModal,cancelText:h.default.t(1856),children:this._getEphemeralDuration()?h.default.t(867):h.default.t(868)}))},this._handleClick=()=>{var{chat:e,onClick:t}=this.props;e.contact.isContactBlocked?this._openUnblockContactModal():t()}}render(){return(0,g.jsx)(M,{ephemeralDuration:this._getEphemeralDuration(),canChange:!0,onClick:this._handleClick})}}v.CONCERNS={chat:["contact","ephemeralDuration"]},v.displayName="ContactEphemeralSettingRow";var _=(0,p.default)(v,v.CONCERNS);class x extends i.PureComponent{constructor(...e){super(...e),this._closeModal=()=>{n.default.closeModal()},this._openNonAdminModal=()=>{n.default.openModal((0,g.jsx)(o.default,{onOK:this._closeModal,okText:h.default.t(2029),children:h.default.t(807)}))},this._handleClick=()=>{var{onClick:e,groupMetadata:t}=this.props;t.canSetEphemeralSetting()?e():this._openNonAdminModal()}}render(){var e,{groupMetadata:t}=this.props;return(0,g.jsx)(M,{ephemeralDuration:null!==(e=t.ephemeralDuration)&&void 0!==e?e:0,canChange:t.canSetEphemeralSetting(),onClick:this._handleClick})}}x.CONCERNS={groupMetadata:["ephemeralDuration","participants"]},x.displayName="GroupEphemeralSettingRow";var C=(0,p.default)(x,x.CONCERNS);function M(e){var t,{ephemeralDuration:a,canChange:s,onClick:i}=e;t=a>0?s?u.default.isEphemeral24HDurationEnabled()?(0,c.getDisappearingMessageDurationString)(a):h.default.t(862):(0,c.getDisappearingMessageExplanationString)(a):h.default.t(861);var l=(0,g.jsx)(f.default,{className:s?d.default.chevronIcon:d.default.ephemeralIcon,name:s?"chevron-right-alt":"disappearing",directional:!0});return(0,g.jsxs)(r.default,{onClick:i,side:l,multiline:!0,children:[(0,g.jsx)("div",{className:d.default.header,children:(0,g.jsx)(m.TextSpan,{theme:"title",children:h.default.t(983)})}),(0,g.jsx)(m.TextDiv,{theme:"muted",children:t})]})}},46144:(e,t,a)=>{"use strict";var s=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(a(81109)),l=s(a(6479)),n=a(67294),o=a(58380),r=s(a(55454)),d=s(a(52384)),u=s(a(12950)),c=s(a(2408)),h=s(a(56512)),p=s(a(71681)),f=s(a(26630)),m=s(a(14784)),g=s(a(2966)),v=a(85893);class _ extends n.Component{constructor(...e){super(...e),this._setGallery=e=>{this._gallery=e},this._handleNewMsgs=e=>{if(e){var t=[],a=Array.isArray(e)?e:[e];Promise.all(a.map((e=>(e.getLinks().length&&t.push(e),Promise.resolve())))).then((()=>{t.length&&this.props.linkMsgs.add(t)}))}},this._queryCollection=(e,t)=>{var{linkMsgs:a,chat:s}=this.props;this.props.listeners.uiIdle((()=>{a.queryLinks(s,t)}))},this._renderLinks=e=>{var{linkMsgs:t,selectedMessages:a}=this.props,s=[];return t.forEach((t=>{var i=!t.isSentByMe&&t.isGroupMsg;t.getGalleryLinks().forEach(((l,n)=>{l.href!==t.matchedText&&s.push((0,v.jsx)(h.default,{msg:t.safe(),link:l,displayAuthor:i,selectable:this.props.selectable,selectedMessages:a,onMessageSelect:this.props.onMessageSelect,onClickMsg:e},`${t.id.toString()}-${n}`))})),t.linkPreview&&s.push((0,v.jsx)(m.default,{msg:t,selectable:this.props.selectable,selectedMessages:a,onMessageSelect:this.props.onMessageSelect,displayType:r.default.DISP_TYPE.GALLERY,onClickMsg:e},t.id.toString()))})),s.reverse(),s}}componentDidMount(){this.props.listeners.add(this.props.linkMsgs,"add remove reset",(()=>{var e;null===(e=this._gallery)||void 0===e||e.forceUpdate()})),this.props.listeners.add(this.props.linkMsgs,"query_link_before",(()=>{var e;null===(e=this._gallery)||void 0===e||e.forceUpdate()})),this.props.listeners.add(this.props.chat.msgs,"add bulk_add",this._handleNewMsgs)}render(){var e,t=this.props,{linkMsgs:a,listeners:s,chat:n}=t,r=(0,l.default)(t,["linkMsgs","listeners","chat"]);return u.default.supportsFeature(u.default.F.MD_BACKEND)&&n.endOfHistoryTransferType===o.ConversationEndOfHistoryTransferModelPropType.COMPLETE_BUT_MORE_MESSAGES_REMAIN_ON_PRIMARY&&(e=(0,v.jsx)(d.default,{icon:(0,v.jsx)(g.default,{name:"content-chat"}),theme:"list",secondary:c.default.t(718),children:c.default.t(721)})),(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(f.default,(0,i.default)({ref:this._setGallery,msgsCollection:a,queryCollection:this._queryCollection,hasBefore:a.hasLinkBefore,queryBefore:a.queryLinkBefore,renderElements:this._renderLinks,emptyText:c.default.t(1344),chat:n},r)),e]})}}_.displayName="LinkGallery";var x=(0,p.default)(_);t.default=x},56512:(e,t,a)=>{"use strict";var s=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(a(94184)),l=a(67294),n=s(a(17850)),o=a(68551),r=s(a(55454)),d=s(a(85051)),u=s(a(16712)),c=s(a(2408)),h=s(a(4949)),p=s(a(26976)),f=s(a(71681)),m=s(a(18416)),g=s(a(79485)),v=s(a(89589)),_=s(a(82669)),x=a(61211),C=a(85893);class M extends l.Component{constructor(e){super(e),this.mouseOver=()=>{this.state.hover||this.setState({hover:!0})},this.mouseEnter=()=>{this.state.hover||this.setState({hover:!0})},this.mouseLeave=()=>{this.state.hover&&this.setState({hover:!1})},this.handleSelectChange=e=>{this.state.selected!==e&&this.setState({selected:e})},this.handleSelectClick=e=>{e&&e.stopPropagation(),this.props.onMessageSelect(this.props.msg.unsafe(),!this.state.selected)},this.handleClick=()=>{this.props.onClickMsg(this.props.msg.unsafe(),!this.state.selected)};var{msg:t,selectedMessages:a}=e;this.state={hover:!1,selected:a.isSelected(t.unsafe())}}componentDidMount(){this.props.listeners.add(this.props.selectedMessages,this.props.msg.id.toString(),this.handleSelectChange)}render(){var{msg:e,link:t,displayAuthor:a}=this.props,s=this.props.selectable||this.state.hover?(0,C.jsx)(m.default,{checked:this.state.selected,onClick:this.handleSelectClick,msgTheme:"gallery"}):null,l=(0,o.Conversation)({mentions:e.mentionMap(),links:e.getLinks(),selectable:true,trusted:e.isTrusted()}),f=e.body&&e.body.includes(t.url)?e.body:e.caption,g=a?(0,C.jsx)("div",{className:h.default.author,children:(0,C.jsx)(n.default,{msg:e,contact:e.senderObj})}):null,M=e.getSuspiciousLinks().length>0;return(0,C.jsx)(u.default,{hover:this.state.hover,onClick:this.handleClick,onMouseEnter:this.state.hover?null:this.mouseEnter,onMouseOver:this.state.hover?null:this.mouseOver,onMouseLeave:this.state.hover?this.mouseLeave:null,children:(0,C.jsxs)("div",{className:h.default.msg,children:[(0,C.jsx)(_.default,{transitionName:"delay-leave",children:s}),(0,C.jsx)(x.MessageContainer,{isSentByMe:e.isSentByMe,children:(0,C.jsxs)("div",{className:(0,i.default)(h.default.bubble,{[h.default.hasAuthor]:a,[h.default.hasSuspiciousLinks]:M}),children:[g,(0,C.jsx)(v.default,{link:t,displayType:r.default.DISP_TYPE.GALLERY}),(0,C.jsx)(p.default,{title:t.url,isSentByMe:e.isSentByMe,canonicalUrl:t.domain,displayType:r.default.DISP_TYPE.GALLERY,star:e.star}),(0,C.jsx)(d.default,{text:f,selectable:true,className:h.default.text,dirMismatch:e.rtl!==c.default.isRTL(),direction:e.dir,formatters:l})]})})]})})}}M.CONCERNS={msg:["body","caption","dir","id","isSentByMe","mediaData","type","rtl","senderObj","star","mediaData","asRevoked"]},M.displayName="LinkMsg";var S=(0,f.default)((0,g.default)(M,M.CONCERNS));t.default=S},52963:(e,t,a)=>{"use strict";var s=a(20862),i=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=i(a(23493)),n=i(a(98913)),o=i(a(94654)),r=i(a(31351)),d=a(67294),u=a(58380),c=i(a(25142)),h=i(a(55454)),p=i(a(52384)),f=i(a(12950)),m=i(a(2408)),g=i(a(71681)),v=i(a(46786)),_=i(a(62381)),x=s(a(83427)),C=a(1393),M=i(a(79485)),S=a(15298),j=i(a(2966)),E=a(85893);function T(e){return!f.default.supportsFeature(f.default.F.MD_BACKEND)||(0,C.hasThumbnail)(e.mediaData)}class P extends d.Component{constructor(...e){super(...e),this.handleScroll=e=>{this._handleScroll(e.currentTarget)},this._handleScroll=(0,l.default)((e=>{var t=this.props.mediaMsgs;t.hasMediaBefore&&e.scrollTop+h.default.SCROLL_FUDGE>e.scrollHeight-e.clientHeight&&this._scheduleMediaQuery(t.head())}),100)}componentDidMount(){this.props.mediaMsgs.hasMediaBefore&&this._scheduleMediaQuery(),this.props.listeners.add(this.props.mediaMsgs,"add",(()=>{this.forceUpdate()})),this.props.listeners.add(this.props.mediaMsgs,"remove",(e=>{var t=this.props.selectedMessages;t&&t.isSelected(e)&&t.setVal(e,!1),this.forceUpdate()})),this.props.listeners.add(this.props.mediaMsgs,"reset",(()=>{this.props.selectedMessages&&this.props.selectedMessages.unsetAll(),this.forceUpdate()})),this.props.listeners.add(this.props.mediaMsgs,"query_media_before",(()=>{this.forceUpdate()}))}componentWillUnmount(){this._handleScroll.cancel()}_scheduleMediaQuery(e){var t=this.props.mediaMsgs;t.hasMediaBefore&&this.props.listeners.uiIdle((()=>{t.queryMedia({chat:(0,S.unproxy)(this.props.chat),msg:e})}))}render(){var e,{fullCollection:t,selectedMessages:a,chat:s,mediaMsgs:i,selectable:l,onMessageSelect:d}=this.props,h=function(e,t,a,s,i){var l=null,d=(0,r.default)(e).filter(T).slice(0,t?e.length:6);return(0,o.default)(d,((e,o)=>{var r=!t&&o>=3&&o<=5?"hideableSecondRow":void 0,d=(0,E.jsx)(v.default,{msg:e,hoverEvent:t,selectable:a,selectedMessages:s,onMessageSelect:i,theme:r},e.id.toString());if(!t)return[d];var u=c.default.monthStr(e.t);if(u!==l){l=u;var h=(0,E.jsx)(_.default,{children:u},`header-${e.t}`);return[...(0,n.default)(6,(t=>(0,E.jsx)(x.EmptyCanvas,{},`padding-${e.t}-${t}`))),h,d]}return[d]}))}(i.toArray(),t,l,a,d),g=!1;return f.default.supportsFeature(f.default.F.MD_BACKEND)&&s.endOfHistoryTransferType===u.ConversationEndOfHistoryTransferModelPropType.COMPLETE_BUT_MORE_MESSAGES_REMAIN_ON_PRIMARY&&(g=!0,t?e=m.default.t(722):0===i.length&&0===s.docCount&&0===s.linkCount&&0===s.productCount&&(e=m.default.t(720))),(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)(x.default,{medias:h,mediaCollection:i,fullCollection:t,chat:(0,S.unproxy)(s),onScroll:this.handleScroll}),g?(0,E.jsx)(p.default,{icon:(0,E.jsx)(j.default,{name:"content-chat"}),theme:"list",secondary:m.default.t(718),children:e}):null]})}}P.CONCERNS={chat:["linkCount","docCount","productCount","endOfHistoryTransferType"]},P.displayName="MediaGallery";var I=(0,g.default)((0,M.default)(P,P.CONCERNS));t.default=I},46786:(e,t,a)=>{"use strict";var s=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(a(94184)),l=a(67294),n=s(a(91952)),o=s(a(71681)),r=s(a(49694)),d=s(a(32666)),u=s(a(1393)),c=a(90672),h=a(15298),p=a(85893);class f extends l.Component{constructor(){super(...arguments),this.setRefImg=e=>{this.img=e},this._handleSelectChange=e=>{this.state.selected!==e&&this.setState({selected:e})},this.handleClick=e=>{var{msg:t,selectable:a,onMessageSelect:s}=this.props,i=t.mediaData;if(a&&s)s(t,!this.state.selected);else if(i.mediaStage!==c.MEDIA_DATA_STAGE.ERROR_MISSING){var l;e&&e.stopPropagation();var o=t.id;if(i.isGif||i.type===r.default.TYPE.IMAGE){var u=this.img;l=e=>o.equals(e)&&u?u:null}n.default.mediaViewerModal({msg:(0,h.unproxy)(t),getZoomNode:l})}else n.default.openModal((0,p.jsx)(d.default,{msg:t}))},this.handleDragStart=e=>{e.nativeEvent.dataTransfer.setData("text/uri-list",this.props.msg.mediaData.renderableUrl)};var{msg:e,selectedMessages:t}=this.props;this.state={selected:!(!t||!t.isSelected(e))}}componentDidMount(){this.props.selectedMessages&&this.props.listeners.add(this.props.selectedMessages,this.props.msg.id.toString(),this._handleSelectChange)}render(){var{msg:e,hoverEvent:t,selectable:a,onMessageSelect:s,theme:l,className:n}=this.props,o=e.mediaData,d=o.type===r.default.TYPE.IMAGE&&o.renderableUrl?this.handleDragStart:null,c=(0,i.default)(n);return(0,p.jsx)(u.default,{classes:c,onClick:this.handleClick,hoverEvent:t,selectable:a,selected:this.state.selected,onMessageSelect:s,onDragStart:d,msg:e,theme:l,imgRef:this.setRefImg})}}f.displayName="MediaCanvas";var m=(0,o.default)(f);t.default=m},62381:(e,t,a)=>{"use strict";var s=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,l.jsx)("div",{className:i.default.container,children:e.children})};var i=s(a(49866)),l=a(85893)},1393:(e,t,a)=>{"use strict";var s=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.hasThumbnail=E,t.default=t.MediaThumb=void 0;var i=s(a(94184)),l=a(67294),n=s(a(88540)),o=a(9492),r=s(a(71681)),d=s(a(75571)),u=s(a(49694)),c=s(a(20720)),h=s(a(70950)),p=s(a(84331)),f=s(a(88064)),m=a(90672),g=s(a(80747)),v=s(a(4231)),_=s(a(2966)),x=s(a(69217)),C=s(a(63477)),M=s(a(54136)),S=a(85893);class j extends l.Component{constructor(...e){super(...e),this.state={hover:!1,tooltip:null},this._setRefImg=e=>{this._img=e},this._setRefContainer=e=>{this._container=e},this._handleSelectClick=()=>{this.props.onMessageSelect&&this.props.onMessageSelect(this.props.msg,!this.props.selected)},this._handleMouseOver=()=>{this.state.hover||this.setState({hover:!0})},this._handleMouseEnter=e=>{this.state.hover||(e.persist(),this.setState({hover:!0},(()=>this._startTooltipTimer(e.target))))},this._handleMouseLeave=()=>{this.state.hover&&(null!=this._tooltipTimer&&this.props.clearTimeout(this._tooltipTimer),this.setState({hover:!1,tooltip:null}))},this.maybeDownloadMediaMD=()=>{var{msg:e}=this.props;e.mediaData.preview||e.mediaData.fullPreviewData||e.mediaData.type!==u.default.TYPE.IMAGE&&e.mediaData.type!==u.default.TYPE.VIDEO||e.downloadMedia({downloadEvenIfExpensive:!1,isUserInitiated:!1,rmrReason:v.default.WEBC_RMR_REASON_CODE.MEDIA_VIEWER})},this._renderImgNode=(e,t,a,s)=>{var i=a?(0,S.jsx)("div",{className:c.default.shade}):null,l=t?{backgroundImage:`url(${t})`}:null;return(0,S.jsxs)("div",{className:e,style:l,onClick:this.props.onClick,ref:this._setRefImg,onDragStart:this.props.onDragStart,draggable:null!=this.props.onDragStart||null,children:[s,i]})},this._downloadMedia=()=>{this.props.msg.downloadMedia({downloadEvenIfExpensive:!1,isUserInitiated:!1,rmrReason:v.default.WEBC_RMR_REASON_CODE.MEDIA_VIEWER})},this._dismissTooltip=()=>{this.setState({tooltip:null})},this._renderImg=()=>{var e,{msg:{mediaData:t},preferPreview:a}=this.props;switch(t.type){case u.default.TYPE.AUDIO:return this._renderImgNode(`${c.default.mediaCanvas} attach-media-audio-thumb`);case u.default.TYPE.VIDEO:var s=(0,i.default)(c.default.mediaCanvas,{"media-video-thumb":t.isGif&&!t.preview}),l=null===(e=t.preview)||void 0===e?void 0:e.url();return this._renderImgNode(s,l,!0);case u.default.TYPE.IMAGE:var n=e=>{var a,s=null!=e?(0,S.jsx)("div",{className:c.default.mediaCanvas,style:{backgroundImage:`url(${e})`}}):null;return this._renderImgNode(c.default.mediaCanvas,null===(a=t.preview)||void 0===a?void 0:a.url(),this.props.msg.star,s)},o=()=>t.preview?n(null):this._renderImgNode(c.default.mediaCanvas,null,this.props.msg.star);return a?o():(0,S.jsx)("div",{className:c.default.mediaCanvas,children:(0,S.jsx)(g.default,{mediaData:t,placeholderRenderer:o,renderProgressively:!0,downloadMedia:this._downloadMedia,children:n})});default:return this._renderImgNode(null,null,this.props.msg.star)}}}componentDidMount(){this.props.listeners.add(this.props.msg.mediaData,"change:preview",(()=>{this.forceUpdate()})),this.props.listeners.add(this.props.msg,"change:star",(()=>{this.forceUpdate()})),this.props.imgRef&&this.props.imgRef(this._img),this.props.containerRef&&this.props.containerRef(this._container),this.maybeDownloadMediaMD(),this.props.listeners.add(this.props.msg.mediaData,"change:mediaStage",(()=>{this.props.msg.mediaData.mediaStage===m.MEDIA_DATA_STAGE.RESOLVED&&this.forceUpdate()}))}componentDidUpdate(){this.props.imgRef&&this.props.imgRef(this._img),this.props.containerRef&&this.props.containerRef(this._container)}componentWillUnmount(){this.props.imgRef&&this.props.imgRef(null),this.props.containerRef&&this.props.containerRef(null)}_getTooltip(e){if(!(this._shouldShowTooltip()&&e instanceof HTMLElement))return null;var t=e.offsetWidth;return{menu:(0,S.jsx)(f.default,{msg:this.props.msg}),anchor:e,dirY:o.DirY.TOP,dirX:o.DirX.CENTER,offsetX:this.props.active?.5*-t*.13:0,type:o.MenuType.tooltip}}_startTooltipTimer(e){null!=this._tooltipTimer&&this.props.clearTimeout(this._tooltipTimer),this._tooltipTimer=this.props.setTimeout((()=>{this._tooltipTimer=null,this._showTooltip(e)}),500)}_showTooltip(e){this.setState({tooltip:this._getTooltip(e)})}_shouldShowTooltip(){return!!this.props.showTooltip&&"viewerFlowTransparent"!==this.props.theme}render(){var e,{msg:t,selectable:a,theme:s,active:l}=this.props,o=this.props.selected||!1;(a||this.state.hover&&this.props.hoverEvent)&&(e=(0,S.jsxs)("div",{className:c.default.mediaSelect,children:[(0,S.jsx)("div",{className:c.default.shadeTop,onClick:this.props.onClick}),(0,S.jsx)(n.default,{onChange:this._handleSelectClick,hover:this.state.hover,checked:o})]}));var r=(0,i.default)(this.props.classes,c.default.canvasComponent,{[c.default.canvasSelected]:o,[c.default.canvasSecondRow]:"hideableSecondRow"===s,[c.default.viewerFlow]:"viewerFlow"===s||"viewerFlowTransparent"===s,[c.default.viewerFlowTransparent]:"viewerFlowTransparent"===s,[c.default.active]:l}),d=t.star?(0,S.jsx)("div",{className:c.default.iconStar,children:(0,S.jsx)(_.default,{name:"star"})}):null,u=E(t.mediaData),f=this.state.tooltip?(0,S.jsx)(C.default,{displayName:"MediaThumbTitle",popable:!0,escapable:!0,requestDismiss:this._dismissTooltip,requestRecentFocusOnUnmount:!1,children:(0,S.jsx)(M.default,{tooltip:this.state.tooltip})}):null;return u?(0,S.jsxs)("div",{ref:this._setRefContainer,className:r,onMouseOver:this._handleMouseOver,onMouseEnter:this._handleMouseEnter,onMouseLeave:this._handleMouseLeave,children:[e,(0,S.jsxs)("div",{className:c.default.canvasBody,children:[(0,S.jsx)(p.default,{mediaData:t.mediaData}),(0,S.jsx)(h.default,{mediaData:t.mediaData,selected:o}),d]}),this._renderImg(),f]}):null}}function E(e){switch(e.type){case u.default.TYPE.VIDEO:case u.default.TYPE.IMAGE:if(e.preview||e.fullPreviewData||e.mediaStage===m.MEDIA_DATA_STAGE.RESOLVED)return!0;if(d.default.has(e.filehash)){try{d.default.getOrCreateURL(e.filehash)}catch(e){return!1}return!0}return!1;default:return!0}}t.MediaThumb=j,j.displayName="MediaThumb";var T=(0,x.default)((0,r.default)(j));t.default=T},70950:(e,t,a)=>{"use strict";var s=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var{selected:t,mediaData:a}=e;switch(a.type){case n.default.TYPE.AUDIO:return(0,r.jsx)(d,{duration:a.duration,selected:t});case n.default.TYPE.VIDEO:return a.isGif?null:(0,r.jsx)(d,{duration:a.duration,selected:t});default:return null}};var i=s(a(94184)),l=s(a(25142)),n=s(a(49694)),o=s(a(8829)),r=a(85893);function d({duration:e,selected:t}){var a=l.default.durationStr(e);return a?(0,r.jsx)("span",{className:(0,i.default)(o.default.container,{[o.default.selected]:t}),children:a}):null}},84331:(e,t,a)=>{"use strict";var s=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var{mediaData:t}=e;if(!t)return null;var a=function(e){switch(e.type){case i.default.TYPE.AUDIO:return"msg-audio";case i.default.TYPE.VIDEO:return e.isGif?"msg-gif":"msg-video";default:return null}}(t);return null==a?null:(0,o.jsx)("div",{className:l.default.iconType,children:(0,o.jsx)(n.default,{name:a})})};var i=s(a(49694)),l=s(a(31318)),n=s(a(2966)),o=a(85893)},88064:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var{msg:{senderObj:{formattedShortName:t}}}=e;return(0,i.jsx)(s.TextSpan,{children:t})};var s=a(97504),i=a(85893)},26630:(e,t,a)=>{"use strict";var s=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(67294),l=s(a(91952)),n=s(a(55454)),o=a(92231),r=s(a(52715)),d=s(a(79011)),u=s(a(14784)),c=a(15298),h=s(a(45172)),p=s(a(16297)),f=a(85893);function m(e,t){var{queryBefore:a,hasBefore:s,msgsCollection:m,emptyText:g,scrollOffset:v=0,selectable:_,onMessageSelect:x,queryCollection:C,selectedMessages:M,renderElements:S,onProductDetail:j,setScrollOffset:E}=e,T=(0,h.default)();(0,i.useImperativeHandle)(t,(()=>({forceUpdate:T})));var P=(0,i.useRef)(null),I=e=>{s&&C(e)},b=(0,p.default)((e=>{var t=e.scrollHeight-e.clientHeight-e.scrollTop<n.default.SCROLL_FUDGE;s&&t&&I(m.head()),E&&E(e.scrollTop)}),100);(0,i.useEffect)((()=>{s&&I();var e=P.current;return e&&(e.scrollTop=v),()=>{b.cancel()}}),[]);var N=(e,t)=>{var a=(0,c.unproxy)(e);_&&void 0!==t?x(a,t):l.default.openChatAt(a.chat,a.chat.getSearchContext(a))},y=S?S(N):m.map(((e,t)=>(0,f.jsx)(u.default,{msg:e,selectable:_,selectedMessages:M,onMessageSelect:x,displayType:n.default.DISP_TYPE.GALLERY,onClickMsg:N,onProductClick:j},`${e.id.toString()}_${t}`))).reverse();if(a){if(0===y.length)return(0,f.jsx)(o.Loading,{});y.push((0,f.jsx)(r.default,{}))}return 0!==m.length||a||s?(0,f.jsx)("div",{ref:P,onScroll:e=>{b(e.target)},className:d.default.wrapper,children:y}):(0,f.jsx)(o.Empty,{text:g,a8nText:"no-elements"})}var g=(0,i.forwardRef)(m);t.default=g},93450:(e,t,a)=>{"use strict";var s=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=(0,f.default)(e.chat,["isGroup","muteExpiration","archive"]),a=(0,f.default)(e.mute,["isMuted"]),s=(0,f.default)(e.settings,["showArchiveV2"]),g=e=>{o.default.muteChat((0,h.unproxy)(t),e)},v=()=>{g(!1),o.default.closeModal()},_=a.isMuted,x=t.muteExpiration;if(t.archive&&(0,u.archiveV2Supported)()&&s.showArchiveV2)return(0,m.jsx)(d.default,{children:(0,m.jsx)(p.TextSpan,{theme:"muted",size:"16",children:c.default.t(259)})});var C,M=_?()=>{var e=t.isGroup?c.default.t(702):c.default.t(700);o.default.openModal((0,m.jsx)(r.default,{onOK:v,okText:c.default.t(104),onCancel:()=>o.default.closeModal(),cancelText:c.default.t(1856),children:e}))}:()=>{g(!0)},S=(0,m.jsx)(l.default,{checked:_,onChange:M}),j=_?c.default.t(1865):c.default.t(2010);if(_&&x){var E=n.default.untilStr(x);C=(0,m.jsx)(p.TextDiv,{theme:"muted",children:E})}return(0,m.jsxs)(d.default,{a8nText:i.default.key("block-mute"),side:S,onClick:M,multiline:!(!_||!x),children:[(0,m.jsx)(p.TextSpan,{theme:"title",children:j}),C]})};var i=s(a(76610)),l=s(a(33287)),n=s(a(25142)),o=s(a(91952)),r=s(a(75940)),d=s(a(92787)),u=a(78615),c=s(a(2408)),h=a(15298),p=a(97504),f=s(a(76006)),m=a(85893)},16505:(e,t,a)=>{"use strict";var s=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var{productMsgs:t,chat:a}=e,s=(0,l.default)(e,["productMsgs","chat"]),g=(0,n.useRef)(null);(0,p.useListener)(t,"add remove reset",(()=>{var e;null===(e=g.current)||void 0===e||e.forceUpdate()}));var v,_=(0,f.default)();d.default.supportsFeature(d.default.F.MD_BACKEND)&&a.endOfHistoryTransferType===o.ConversationEndOfHistoryTransferModelPropType.COMPLETE_BUT_MORE_MESSAGES_REMAIN_ON_PRIMARY&&(v=(0,m.jsx)(r.default,{icon:(0,m.jsx)(h.default,{name:"content-chat"}),theme:"list",secondary:u.default.t(718),children:u.default.t(724)}));return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(c.default,(0,i.default)({ref:g,msgsCollection:t,queryCollection:e=>_((()=>{t.queryProducts(a,e)})),hasBefore:t.hasProductBefore,queryBefore:t.hasProductBefore?Promise.resolve():null,emptyText:u.default.t(1348),chat:a},s)),v]})};var i=s(a(81109)),l=s(a(6479)),n=a(67294),o=a(58380),r=s(a(52384)),d=s(a(12950)),u=s(a(2408)),c=s(a(26630)),h=s(a(2966)),p=a(61192),f=s(a(20994)),m=a(85893)},50692:(e,t,a)=>{"use strict";var s=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(a(91952)),l=s(a(75940)),n=s(a(17025)),o=s(a(18260)),r=s(a(85051)),d=s(a(99942)),u=s(a(2408)),c=a(97449),h=a(85893);class p extends d.default{constructor(...e){super(...e),this.contactFilter=e=>{var t=this.props.chat.groupMetadata;return!!n.default.isFilteredContact(e)&&(!(null==t?void 0:t.participants.get(e.id))||u.default.t(245))},this.confirmAddParticipant=e=>{var t=this.onAddParticipant.bind(this,e),a=u.default.t(684,{participant:e.formattedName,subject:this.props.chat.contact.name});this.push((0,h.jsx)(l.default,{onOK:t,okText:u.default.t(234),onCancel:this._pop,cancelText:u.default.t(1856),children:(0,h.jsx)(r.default,{text:a})}))},this.onAddParticipant=e=>{(0,c.addParticipants)(this.props.chat,[e]).catch((()=>{})),i.default.closeModal()},this._pop=()=>{this.pop()}}componentDidMount(){this.push((0,h.jsx)(o.default,{title:u.default.t(234),filter:this.contactFilter,onCancel:this._pop,onSelect:this.confirmAddParticipant}))}}t.default=p},70569:(e,t,a)=>{"use strict";var s=a(20862),i=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=a(82754),n=i(a(91952)),o=i(a(75940)),r=i(a(17025)),d=i(a(85051)),u=i(a(99942)),c=i(a(2408)),h=a(97449),p=s(a(57774)),f=a(85893);class m extends u.default{constructor(...e){super(...e),this._isGroupParticipant=e=>{var t,{chat:a}=this.props;return!!(null===(t=a.groupMetadata)||void 0===t?void 0:t.participants.get(e))},this.customSecondaryText=e=>{var t,{chat:a}=this.props;return(null===(t=a.groupMetadata)||void 0===t?void 0:t.participants.get(e))?c.default.t(245):null},this.contactFilter=e=>{var t=this.props.chat.groupMetadata;return!!r.default.isFilteredContact(e)&&(!(null==t?void 0:t.participants.get(e.id))||c.default.t(245))},this.confirmAddParticipant=e=>{var{chat:t}=this.props;this.push((0,f.jsx)(o.default,{onOK:this.onAddParticipant.bind(this,e),okText:c.default.t(234,{_plural:e.length}),onCancel:this._pop,cancelText:c.default.t(1856),children:(0,f.jsx)(d.default,{text:this._makeNameEnumeration(e,t.contact.name)})}))},this._makeNameEnumeration=(e,t)=>{var a=e.map((e=>e.formattedShortName||e.shortName)).reduce(((t,a,s)=>[...t,a,s!==e.length-1&&c.default.t(806)||""]),[]);return c.default.t(685,{participants:a.join(""),subject:t})},this.onAddParticipant=e=>{(0,h.addParticipants)(this.props.chat,e).catch((()=>{})),n.default.closeModal()},this._pop=()=>{this.pop()}}componentDidMount(){this.push((0,f.jsx)(p.default,{onConfirm:this.confirmAddParticipant,filter:this.contactFilter,title:c.default.t(234),isDisabled:this._isGroupParticipant,isSelected:this._isGroupParticipant,customSecondaryText:this.customSecondaryText,listType:p.ListType.PARTICIPANT_MANAGE_MODAL,singleSelectionFooterType:l.FooterType.CONFIRM,multipleSelectionFooterType:l.FooterType.CONFIRM}))}}t.default=m},31530:(e,t,a)=>{"use strict";var s=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(a(53427)),l=s(a(45190)),n=s(a(99942)),o=s(a(87947)),r=a(85893);class d extends n.default{constructor(...e){super(...e),this._showArchiveSettingsDrawer=()=>{this.push((0,r.jsx)(i.default,{settings:o.default,onClose:this._pop}))},this._pop=()=>{this.pop()}}componentDidMount(){this.push((0,r.jsx)(l.default,{showSettings:this._showArchiveSettingsDrawer,onClose:this._pop,settings:o.default}))}}t.default=d},78080:(e,t,a)=>{"use strict";var s=a(20862),i=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=i(a(81109)),n=i(a(62153)),o=i(a(17663)),r=i(a(64305)),d=i(a(91952)),u=i(a(70458)),c=i(a(30841)),h=i(a(24337)),p=a(59014),f=i(a(79864)),m=i(a(11695)),g=i(a(99942)),v=a(78615),_=i(a(81343)),x=i(a(14804)),C=i(a(32827)),M=a(63124),S=a(30333),j=s(a(65389)),E=i(a(4231)),T=a(70790),P=i(a(90277)),I=i(a(35154)),b=i(a(7127)),N=i(a(83153)),y=i(a(27370)),A=i(a(22685)),w=i(a(64883)),O=i(a(46707)),D=i(a(41631)),R=a(85893);class k extends g.default{constructor(...e){super(...e),this._scrollOffset=0,this._setScrollOffset=e=>{this._scrollOffset=e},this.onProductDetail=(e,t)=>{var{chat:a}=this.props,s=(0,R.jsx)(I.default,{chat:a,collectionId:t,product:e,onEnd:this._end,onBack:this._popAndUpdate,refreshCarousel:!1,onProductLinkClick:this._onProductLinkClick,onProductMoreInformation:this.onProductMoreInformation,onCartClick:this._onCartClick});this.push(s)},this.onProductDetailFromInfo=e=>{var t=(0,R.jsx)(b.default,{chat:this.props.chat,productInfo:e,onEnd:this._end,onBack:this._pop,onProductDetail:this.onProductDetail,onProductCatalog:this.onProductCatalogHeaderClick,onProductLinkClick:this._onProductLinkClick,onProductMoreInformation:this.onProductMoreInformation,onCartClick:this._onCartClick});this.push(t)},this.onCollectionSeeAll=e=>{var t=this.props.chat.id;this.push((0,R.jsx)(u.default,{contact:this.props.chat.contact,onProductDetail:this.onProductDetail,catalogId:t,onBack:this._pop,onCatalogLinkClick:this._onCatalogLinkClick,onCartClick:this._onCartClick,collection:e}))},this._onProductLinkClick=e=>{this.push((0,R.jsx)(N.default,{product:e,onBack:this._pop}))},this.onProductMoreInformation=e=>{var t=(0,R.jsx)(A.default,{product:e,onBack:this._popAndUpdate});this.push(t)},this._onCatalogLinkClick=(e,t)=>{this.push((0,R.jsx)(o.default,{catalog:e,contact:t,onBack:this._pop}))},this._onCartClick=e=>{var t=(0,T.getProductCatalogContext)(this.props.context),a=(0,w.default)(e,this.props.chat,t);a&&this.push(a)},this.pushProductCatalog=()=>{var{chat:e}=this.props,t=(0,v.canViewCollections)()?(0,R.jsx)(r.default,{contact:e.contact,onProductDetail:this.onProductDetail,catalogId:e.id,onBack:this._pop,businessProfile:e.contact.businessProfile,onCatalogLinkClick:this._onCatalogLinkClick,onCartClick:this._onCartClick,onCollectionSeeAll:this.onCollectionSeeAll}):(0,R.jsx)(y.default,{contact:e.contact,onProductDetail:this.onProductDetail,catalogId:e.id,onBack:this._pop,businessProfile:e.contact.businessProfile,onCatalogLinkClick:this._onCatalogLinkClick,onCartClick:this._onCartClick});this.push(t)},this.onProductCatalog=e=>{var t=this.props.chat.id;(0,S.logCarouselViewMoreClick)({catalogOwnerWid:t,catalogContext:e}),this.pushProductCatalog(t)},this.onProductCatalogHeaderClick=(e,t)=>{(0,S.logCarouselViewMoreClick)({catalogOwnerWid:e,catalogContext:t}),this.onProductCatalog(t)},this.onStarred=()=>{var e=(0,R.jsx)(O.default,{chat:this.props.chat,starredMsgs:this.props.chat.getStarredMsgs(),onClose:this._pop});this.push(e)},this.onAdminSetting=()=>{var{chat:e}=this.props,t=(0,R.jsx)(C.default,{chat:e,groupMetadata:e.groupMetadata,onClose:this._pop});this.push(t)},this.onContactCard=()=>{this.push((0,R.jsx)(c.default,{chat:this.props.chat,onClose:this._pop}))},this.onMediaGallery=()=>{var e=(0,R.jsx)(j.default,{chat:this.props.chat,onBack:this._pop,onProductDetail:this.onProductDetail,setProductsScrollOffset:this._setScrollOffset});this.push(e)},this.onGroupInviteLink=()=>{var{chat:e}=this.props,t=(0,R.jsx)(x.default,{chat:this.props.chat,groupMetadata:e.groupMetadata,onBack:this._pop});this.push(t)},this._pop=()=>{this.pop()},this._popAndUpdate=()=>{this.popAndUpdate({initialTab:j.TABS.PRODUCTS,productsScrollOffset:this._scrollOffset})},this._end=()=>{this.end(!0)},this.onVerification=e=>{var t=e||this.props.chat.contact,a=(0,R.jsx)(D.default,{contact:t,onClose:this._pop,isFirstLevel:!1});this.push(a)},this.onLiveLocation=()=>{var e=(0,R.jsx)(M.LiveLocationDrawerLoadable,{chat:this.props.chat,onClose:this._pop});this.push(e)},this.onEphemeral=()=>{var{chat:e}=this.props,t=(0,R.jsx)(m.default,{chat:e,fromInfoFlow:!0,onClose:this._pop});this.push(t)}}componentDidMount(){var e=this.onStarred,t=this.onMediaGallery,a=this.props.chat;this.props.chat.isGroup?this.push((0,R.jsx)(_.default,{chat:a,showFullGroupDescription:this.props.showFullGroupDescription,scrollToParticipantList:this.props.scrollToParticipantList,groupMetadata:a.groupMetadata,contact:a.contact,profilePicThumb:a.contact.getProfilePicThumb(),onVerification:this.onVerification,onStarred:e,onMediaGallery:t,onAdminSetting:this.onAdminSetting,onGroupInviteLink:this.onGroupInviteLink,onLiveLocation:this.onLiveLocation,onEphemeral:this.onEphemeral,onClose:this._pop})):a.isBroadcast?this.push((0,R.jsx)(n.default,{chat:a,contact:a.contact,onStarred:e,onMediaGallery:t,onClose:this._pop})):a.isUser&&(a.contact.isBusiness&&(0,v.canSeeBizProfileV3)()&&d.default.setDrawerContext("right",(0,T.buildProductCatalogContext)(new P.default,(0,p.getMaybeBizPlatformForLogging)(a.contact.id.toString()),E.default.CATALOG_ENTRY_POINT.CATALOG_ENTRY_POINT_PROFILE)),this.push((0,R.jsx)(h.default,{contact:a.contact,onVerification:this.onVerification,onStarred:e,onContactCard:this.onContactCard,onMediaGallery:t,onProductCatalog:this.onProductCatalog,onProductDetail:this.onProductDetail,onLiveLocation:this.onLiveLocation,onEphemeral:this.onEphemeral,onClose:this._pop})))}}t.default=e=>(0,R.jsx)(f.default.Consumer,{children:t=>(0,R.jsx)(k,(0,l.default)({context:t},e))})},23377:(e,t,a)=>{"use strict";var s=a(20862),i=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=i(a(23493)),n=a(55084),o=i(a(7900)),r=a(67294),d=i(a(91952)),u=i(a(55454)),c=s(a(13540)),h=i(a(12950)),p=i(a(2408)),f=i(a(71681)),m=a(90672),g=i(a(61169)),v=i(a(84223)),_=i(a(4231)),x=i(a(40630)),C=i(a(45285)),M=a(1393),S=a(85893);class j extends r.Component{constructor(e){super(e),this._unmounted=!1,this._addListeners=()=>{var e=()=>this.state.activeMsg,{mediaMsgs:t}=this,{listeners:a}=this.props;a.uiIdle((()=>{var a=e();a&&t.loadMoreAroundIfNeeded(a)}));var s=e();(null==s?void 0:s.isViewOnce)?a.add(s,"revoked",(()=>{this.setState({activeMsg:null}),this.endFlow()})):(a.add(t,"remove",((a,s,i)=>{var l=e();if(t.includes(a)||null!=l&&null!=l.id&&l.id.toString()!==a.id.toString())this.forceUpdate();else{var n=i.index;0===t.length?this.endFlow():t.length===n?this.handleSelectThumb((0,o.default)(t.at(n-1),"mediaMsgs.at(index - 1)")):this.handleSelectThumb((0,o.default)(t.at(n),"mediaMsgs.at(index)"))}})),a.add(t,"reset",(()=>{this.endFlow()})),a.add(t,"query_media_after",(()=>{this.forceUpdate()})),a.add(t,"query_media_before",(()=>{var e=this._refThumbs;e&&(this._prevScrollWidth=e.scrollWidth,e instanceof HTMLElement&&this.forceUpdate())})))},this.handleKeyDown=e=>{var t=p.default.isRTL();37===e.keyCode?t?this.handleNext():this.handlePrev():39===e.keyCode&&(t?this.handlePrev():this.handleNext())},this.handleImageLoad=()=>{var{uiActionEvent:e}=this;e&&(e.markUiActionT(),e.commit(),delete this.uiActionEvent)},this.handleScroll=e=>{this._handleScrollThrottled(e.currentTarget,this.mediaMsgs,e.currentTarget.scrollLeft,this.props.listeners)},this.handleNext=e=>{if(e&&e.stopPropagation(),!this.state.imgZoomed){var t=this.state.activeMsg;if(t){var a=null;for(a=this.mediaMsgs.getAfter(t);a&&a.mediaData&&!(0,M.hasThumbnail)(a.mediaData);)a=this.mediaMsgs.getAfter(a);a?this.handleSelectThumb(a):this.mediaMsgs.hasMediaAfter&&(this._queryMediaAfter||(this._queryMediaAfter=this.mediaMsgs.queryMedia({chat:t.chat,msg:t,direction:"after"}).checkpoint(this.props.rejectOnUnmount()).then((e=>{"number"==typeof e.length&&e.length>0&&this.state.activeMsg===t&&this.handleNext()})).catch((0,n.filteredCatch)(c.Unmount,(()=>{}))).catch((()=>{__LOG__(3)`query media msgs error: `})).finally((()=>{this._queryMediaAfter=null}))))}}},this.handlePrev=e=>{if(e&&e.stopPropagation(),!this.state.imgZoomed){var t=this.state.activeMsg;if(t){var a=null;for(a=this.mediaMsgs.getBefore(t);a&&a.mediaData&&!(0,M.hasThumbnail)(a.mediaData);)a=this.mediaMsgs.getBefore(a);a?this.handleSelectThumb(a):this.mediaMsgs.hasMediaBefore&&(this._queryMediaBefore||(this._queryMediaBefore=this.mediaMsgs.queryMedia({chat:t.chat,msg:t,direction:"before"}).checkpoint(this.props.rejectOnUnmount()).then((e=>{"number"==typeof e.length&&e.length>0&&this.state.activeMsg===t&&this.handlePrev()})).catch((0,n.filteredCatch)(c.Unmount,(()=>{}))).catch((()=>{__LOG__(3)`query media msgs error: `})).finally((()=>{this._queryMediaBefore=null}))))}}},this.handleImgZoomIn=e=>{this.setState({imgZoomed:e})},this.endFlow=()=>{d.default.closeModalMedia()},this.willEndFlow=()=>{var e;(e=this._refThumbsContainer)&&(0,C.default)(e,{opacity:[0,1],translateY:["100%","0%"]},{duration:300,easing:[.1,.82,.25,1]})},this.handleSelectThumb=e=>{this.props.listeners.uiIdle((()=>{this.mediaMsgs.loadMoreAroundIfNeeded(e)})),this.setState({activeMsg:e})},this.scrollToActive=(e=!1)=>{var t=this._refThumbsContainer,a=this._refThumbs,s=this._refActiveThumb;if(t&&a&&s){var i=0;s instanceof HTMLElement&&(i=s.clientWidth/2-t.clientWidth/2),(0,C.default)(a,"stop");var l=0;e&&(l=300),(0,C.default)(s,"scroll",{duration:l,container:a,offset:i,axis:"x",easing:[.1,.82,.25,1]})}},this._setRefActiveThumb=e=>{this._refActiveThumb=e},this.setRefThumbsContainer=e=>{this._refThumbsContainer=e},this.setRefThumbs=e=>{this._refThumbs=e},this._getActiveMsgIndexInAlbum=()=>{var e=-1,{highlightedMsgIds:t}=this.props;if(!t||!this.state.activeMsg)return e;var a=this.state.activeMsg.id.toString();if(!t.has(a))return e;var s=0;return t.forEach((t=>{t===a&&(e=s),s++})),e},this._previousMediaHasThumb=()=>{var e=this.state.activeMsg;if(!e)return!1;for(var t=this.mediaMsgs.indexOf(e)-1;t>0;t--){var a=this.mediaMsgs.at(t);if(a&&(0,M.hasThumbnail)(a.mediaData))return!0}return!1},this._prevScrollWidth=null;var t=this.props.msg;this.mediaMsgs=t.chat.constructMediaMsgs(t),this._handleScrollThrottled=(0,l.default)(this._handleScroll.bind(this),100),t.type===u.default.MSG_TYPE.IMAGE&&(this.uiActionEvent=new _.default.UiAction({uiActionType:_.default.UI_ACTION_TYPE.IMAGE_OPEN,uiActionPreloaded:t.mediaData.mediaStage===m.MEDIA_DATA_STAGE.RESOLVED})),this.state={activeMsg:t,imgZoomed:!1,animatingThumbs:this._hasThumbList(t)}}componentDidMount(){this.props.listeners.add(window,"keydown",this.handleKeyDown),this._addListeners(),this.scrollToActive(),(e=>{e&&(0,C.default)(e,{opacity:[1,0],translateY:["0%","100%"]},{duration:300,delay:100,easing:[.1,.82,.25,1]}).then((()=>{this._unmounted||this.setState({animatingThumbs:!1})}))})(this._refThumbsContainer)}componentDidUpdate(e,t){if(t.activeMsg!==this.state.activeMsg)this.scrollToActive(!0);else{var a=this._refThumbs;if(!a||null==this._prevScrollWidth||0===this._prevScrollWidth)return;a instanceof HTMLElement&&(a.scrollLeft+=a.scrollWidth-this._prevScrollWidth),this._prevScrollWidth=null}}componentWillUnmount(){this._handleScrollThrottled.cancel(),this._unmounted=!0}_hasThumbList(e){return!(null==e?void 0:e.isViewOnce)}_handleScroll(e,t,a,s){if(0!==t.length&&null!=a){if(t.hasMediaBefore&&a<e.clientWidth){var i=(0,o.default)(t.head(),"mediaMsgs.head()");s.uiIdle((()=>{t.queryMedia({chat:i.chat,msg:i}),this.forceUpdate()}))}if(t.hasMediaAfter&&a+u.default.SCROLL_FUDGE>e.scrollWidth-2*e.clientWidth){var l=(0,o.default)(t.last(),"mediaMsgs.last()");s.uiIdle((()=>{t.queryMedia({chat:l.chat,msg:l,direction:"after"}),this.forceUpdate()}))}}}render(){var e,t=this.state.activeMsg;if(!t)return null;var a=this.mediaMsgs.last(),s=this.mediaMsgs.hasMediaAfter||this.state.activeMsg!==a?this.handleNext:null,i=this.mediaMsgs.head(),l=null;return l=this.mediaMsgs.hasMediaBefore||this.state.activeMsg!==i?this.handlePrev:null,h.default.supportsFeature(h.default.F.MD_BACKEND)&&(l=(this.mediaMsgs.hasMediaBefore||this.state.activeMsg!==i)&&this._previousMediaHasThumb()?this.handlePrev:null),(0,S.jsxs)("div",{className:this.state.imgZoomed?"img-zoomed-in":null,children:[this._hasThumbList(t)&&(0,S.jsx)(v.default,{activeMsg:t,mediaMsgs:this.mediaMsgs,highlightedMsgIds:this.props.highlightedMsgIds,onSelectThumb:this.handleSelectThumb,onSetActiveThumb:this._setRefActiveThumb,onScroll:this.handleScroll,setRefThumbsContainer:this.setRefThumbsContainer,setRefThumbs:this.setRefThumbs}),(0,S.jsx)(g.default,{msg:t,mediaData:t.mediaData,onBack:this.endFlow,onExitAnimation:this.willEndFlow,onNext:s,onPrev:l,onImgZoomIn:this.handleImgZoomIn,getZoomNode:this.props.getZoomNode,startTime:this.props.startTime,isAnimatingIn:this.state.animatingThumbs,onImageLoad:this.uiActionEvent?this.handleImageLoad:null,msgIndexInAlbum:this._getActiveMsgIndexInAlbum(),albumSize:(null===(e=this.props.highlightedMsgIds)||void 0===e?void 0:e.size)||0})]})}}j.displayName="MediaViewerFlow";var E=(0,x.default)((0,f.default)(j));t.default=E},88772:(e,t,a)=>{"use strict";var s=a(20862),i=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=i(a(48926)),n=a(67294),o=i(a(8581)),r=a(10504),d=i(a(17747)),u=i(a(9042)),c=s(a(55588)),h=i(a(99942)),p=i(a(2408)),f=a(85893);class m extends h.default{componentDidMount(){this.push((0,f.jsx)(g,{contactId:this.props.contactId,onClose:this.pop}))}}t.default=m;class g extends n.Component{constructor(...e){super(...e),this.state={legalEntityDetails:void 0,isLoading:!0}}componentDidMount(){var e=this;return(0,l.default)((function*(){var t=yield o.default.update(e.props.contactId,{getMerchantCompliance:!0}),a=(Array.isArray(t)?t[0]:t).serialize();a?e.setState({legalEntityDetails:a.legalEntityDetails||void 0,isLoading:!1}):__LOG__(3)`compliance: cannot fetch business details (${e.props.contactId.toString()})`}))()}render(){var{legalEntityDetails:e={},isLoading:t}=this.state,{entityName:a,entityType:s,isRegistered:i,entityTypeCustom:l,customerCareDetails:n,grievanceOfficerDetails:o}=e,h=s||l||"",m=h&&i&&p.default.t(406);return(0,f.jsxs)(d.default,{theme:"striped",children:[(0,f.jsx)(c.default,{title:p.default.t(390),type:c.DRAWER_HEADER_TYPE.SMALL,onCancel:this.props.onClose}),(0,f.jsx)(u.default,{theme:t?"center-content":void 0,children:t?(0,f.jsx)(r.ComplianceInfoLoading,{}):(0,f.jsxs)(f.Fragment,{children:[(0,f.jsxs)(r.ComplianceInfoGroup,{children:[(0,f.jsx)(r.ComplianceInfoPrimitiveField,{value:a,label:p.default.t(398)}),(0,f.jsx)(r.ComplianceInfoPrimitiveField,{value:`${h}${m?` (${m})`:""}`,label:p.default.t(399)})]}),(0,f.jsxs)(r.ComplianceInfoGroup,{title:p.default.t(386),children:[(0,f.jsx)(r.ComplianceInfoPrimitiveField,{value:null==n?void 0:n.email,label:p.default.t(387)}),(0,f.jsx)(r.ComplianceInfoPrimitiveField,{value:null==n?void 0:n.mobileNumber,label:p.default.t(389)}),(0,f.jsx)(r.ComplianceInfoPrimitiveField,{value:null==n?void 0:n.landlineNumber,label:p.default.t(388)})]}),(0,f.jsxs)(r.ComplianceInfoGroup,{title:p.default.t(393),children:[(0,f.jsx)(r.ComplianceInfoPrimitiveField,{value:null==o?void 0:o.name,label:p.default.t(397)}),(0,f.jsx)(r.ComplianceInfoPrimitiveField,{value:null==o?void 0:o.email,label:p.default.t(394)}),(0,f.jsx)(r.ComplianceInfoPrimitiveField,{value:null==o?void 0:o.mobileNumber,label:p.default.t(396)}),(0,f.jsx)(r.ComplianceInfoPrimitiveField,{value:null==o?void 0:o.landlineNumber,label:p.default.t(395)})]})]})})]},"merchant-details-modal")}}g.displayName="MerchantDetails"},74477:(e,t,a)=>{"use strict";var s=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.requireBundle=void 0;var i=s(a(68356)),l=s(a(55454)),n=s(a(2408)),o=s(a(74878)),r=s(a(33961)),d=a(85893),u=(0,r.default)((()=>Promise.all([a.e(8295),a.e(1702),a.e(9488),a.e(275)]).then(a.bind(a,25571)).then((e=>e.default))),"SendContactFlow");t.requireBundle=u;var c=(0,i.default)({loader:u,loading:e=>(0,d.jsx)(o.default,{title:n.default.t(1553),error:Boolean(e.error)}),delay:l.default.LOADABLE_DELAY});t.default=c},45190:(e,t,a)=>{"use strict";var s=a(20862),i=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=a(67294),n=i(a(82338)),o=s(a(75381)),r=i(a(84758)),d=i(a(91952)),u=i(a(55454)),c=i(a(17747)),h=i(a(9042)),p=s(a(55588)),f=s(a(9492)),m=i(a(47452)),g=a(92231),v=i(a(86025)),_=i(a(67893)),x=a(63290),C=i(a(47193)),M=a(86723),S=i(a(12950)),j=a(78615),E=i(a(39e3)),T=i(a(2408)),P=i(a(71681)),I=a(47941),b=i(a(16967)),N=i(a(79485)),y=i(a(2966)),A=i(a(97504)),w=i(a(82669)),O=a(85893);class D extends l.Component{constructor(...e){super(...e),this.flatListController=new _.default,this.selection=new b.default([],(e=>e.id.toString())),this.state={forceHideNux:!1,chats:this._getArchivedChats()},this.handleClick=(e,t)=>{d.default.openChatFromUnread(t).then((e=>{e&&d.default.focusChatTextInput(t)})),(0,j.archiveV2Supported)()&&this.props.settings.archive.enabled||this.handleClose()},this._updateSelected=e=>{this.selection.setVal(e,!1)},this.handleClose=()=>{this.props.onClose()},this.handleNextChat=e=>{e.preventDefault(),e.stopPropagation(),this.selection.setNext(!0)},this.handlePrevChat=e=>{e.preventDefault(),e.stopPropagation(),this.selection.setPrev(!0)},this.shouldShowArchiveV2=()=>(0,j.archiveV2Supported)()&&this.props.settings.showArchiveV2,this._handleCloseChat=e=>{e===this.selection.getVal()&&this.selection.unset()},this.renderItem=e=>(0,O.jsx)(o.default,{chat:e.chat,mode:o.Mode.LAST,active:this.selection,onClick:this.handleClick,hideArchivedIcon:(0,j.archiveV2Supported)()&&this.props.settings.archive.enabled,hideMuteIcon:this.shouldShowArchiveV2(),hideMuteOption:this.shouldShowArchiveV2(),showEphemeralIcon:!0}),this.setRefHotKeys=e=>{this.refList=e},this._handleCloseNux=()=>{(0,M.setNUX)(u.default.NUX.ARCHIVE,{views:u.default.ARCHIVE_NUX_MAX_VIEWS,maxViews:u.default.ARCHIVE_NUX_MAX_VIEWS}),this.setState({forceHideNux:!0})},this._showNux=()=>{var e=r.default.some((e=>e.archive));return this.shouldShowArchiveV2()&&e&&(0,M.shouldShowNUX)(u.default.NUX.ARCHIVE)&&!this.state.forceHideNux}}componentDidMount(){this.shouldShowArchiveV2()&&!(0,M.getNUX)(u.default.NUX.ARCHIVE)&&(0,M.setNUX)(u.default.NUX.ARCHIVE,{views:0,maxViews:u.default.ARCHIVE_NUX_MAX_VIEWS}),this._showNux()&&(0,M.viewNUX)(u.default.NUX.ARCHIVE),this.shouldShowArchiveV2()?this.props.listeners.add(r.default,"sort change:archive add remove",(()=>{this.setState({chats:this._getArchivedChats()})})):this.props.listeners.add(r.default,"change:archive add remove",(()=>{this.setState({chats:this._getArchivedChats()})})),this.refList&&C.default.focus(this.refList),this.props.listeners.add(d.default,"update_chatlist_selection",this._updateSelected),this.props.listeners.add(d.default,"close_chat",this._handleCloseChat);var e=this._getActiveArchiveChat();e&&this._updateSelected(e)}_getActiveArchiveChat(){return r.default.toArray().find((e=>e.active&&e.archive))}_getArchivedChats(){return r.default.filter((e=>e.archive))}getData(){return this.state.chats.map((e=>({itemKey:e.id.toString(),chat:e})))}render(){var e,t;if(this.selection.init(this.state.chats,!0),this._showNux()&&(t=(0,O.jsxs)("div",{className:n.default.nuxContainer,children:[(0,O.jsxs)(x.FlexColumn,{align:"center",children:[(0,O.jsx)("span",{className:n.default.nuxIcon,children:(0,O.jsx)(y.default,{name:"archive-nux"})}),(0,O.jsx)("div",{className:n.default.nuxHeader,children:(0,O.jsx)(A.default,{theme:"large",as:"h1",children:T.default.t(254)})}),(0,O.jsx)("div",{className:n.default.nuxContent,children:(0,O.jsx)("div",{className:n.default.nuxText,children:(0,O.jsx)(A.default,{theme:"plain",as:"p",children:S.default.supportsFeature(S.default.F.MD_BACKEND)?T.default.t(253):T.default.t(252)})})})]}),(0,O.jsx)("button",{onClick:this._handleCloseNux,className:n.default.btnClose,children:(0,O.jsx)(y.default,{name:"x-alt"})})]})),this.state.chats.length>0){var a={down:this.handleNextChat,up:this.handlePrevChat};e=(0,O.jsxs)(E.default,{onRef:this.setRefHotKeys,handlers:a,children:[(0,O.jsx)(w.default,{transitionName:"slide",children:t}),(0,O.jsx)(v.default,{className:n.default.flatListContainer,data:this.getData(),flatListController:this.flatListController,direction:"vertical",renderItem:this.renderItem})]})}else e=(0,O.jsx)(g.Archived,{});var s=!S.default.supportsFeature(S.default.F.MD_BACKEND)&&(0,j.archiveV2Supported)()&&this.props.settings.archive.enabled?(0,O.jsx)(I.MenuBarItem,{a8nText:"archived-menu",icon:(0,O.jsx)(y.default,{name:"menu"}),title:T.default.t(1194),children:(0,O.jsx)(f.default,{type:"dropdown_menu",flipOnRTL:!0,dirX:f.DirX.LEFT,children:(0,O.jsx)(m.default,{a8n:"open-archive-settings menu-item",action:this.props.showSettings,children:T.default.t(255)})},"ArchivedDrawerHeader")}):null,i=(0,j.archiveV2Supported)()&&this.props.settings.archive.enabled?T.default.t(258):T.default.t(257);return(0,O.jsxs)(c.default,{theme:"archived",children:[(0,O.jsx)(p.default,{title:i,onBack:this.handleClose,type:p.DRAWER_HEADER_TYPE.LARGE,menu:s}),(0,O.jsx)(h.default,{flatListControllers:[this.flatListController],children:e})]})}}D.CONCERNS={settings:["showArchiveV2","archive"]},D.displayName="ArchivedDrawer";var R=(0,P.default)((0,N.default)(D,D.CONCERNS));t.default=R},62153:(e,t,a)=>{"use strict";var s=a(20862),i=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=a(67294),n=i(a(31777)),o=i(a(25142)),r=i(a(91952)),d=i(a(70521)),u=i(a(17025)),c=s(a(88419)),h=i(a(17747)),p=i(a(9042)),f=i(a(17061)),m=s(a(55588)),g=i(a(25061)),v=a(62238),_=i(a(86025)),x=i(a(67893)),C=a(86723),M=i(a(52087)),S=i(a(2408)),j=i(a(71681)),E=i(a(52963)),T=i(a(79485)),P=a(15298),I=i(a(2966)),b=a(97504),N=i(a(69635)),y=i(a(12950)),A=i(a(82829)),w=i(a(37719)),O=a(85893);class D extends l.Component{constructor(...e){super(...e),this.flatListController=new x.default,this.handleParticipantClick=(e,t)=>{N.default.equals((0,C.getMaybeMeUser)(),t.id)||(0,v.findChat)(t.id).then((function(e){r.default.openChatFromUnread(e).then((t=>{t&&r.default.focusChatTextInput(e)}))}))},this.handleClose=()=>{this.props.onClose?this.props.onClose():this.props.uim.uie.requestDismiss()},this.handleDelete=()=>{r.default.deleteOrExitChat((0,P.unproxy)(this.props.chat))},this.showEncryptionInfoPopup=()=>{r.default.openModal((0,O.jsx)(w.default,{chatId:this.props.chat.id,e2eSubtype:"info_encrypted"}))},this.renderItem=e=>{var{participant:t}=e,a=u.default.gadd(t.id);return(0,O.jsx)(d.default,{contact:a,theme:"drawer-list",admin:!!t.isAdmin,onClick:this.handleParticipantClick,waitIdle:!0},t.id.toString())}}componentDidMount(){var e=this.props.chat.groupMetadata;null!=e&&this.props.listeners.add(e.participants,"add remove sort reset",(()=>{this.forceUpdate()}))}getData(){var e,t;return(null!==(e=null===(t=this.props.chat.groupMetadata)||void 0===t?void 0:t.participants)&&void 0!==e?e:[]).map((e=>({itemKey:e.id.toString(),participant:e})))}render(){var e,t,a,s=this.props.chat,i=null;if(this.props.onMediaGallery){var l=(0,O.jsx)(I.default,{className:n.default.chevron,name:"chevron-right-alt",directional:!0}),r=S.default.t(1174);i=(0,O.jsx)(g.default,{title:r,titleOnClick:this.props.onMediaGallery||(()=>{}),subtitle:l,theme:"padding",children:(0,O.jsx)(E.default,{chat:(0,P.unproxy)(s),mediaMsgs:s.getMediaMsgs()})})}var d,u=null!==(e=null===(t=this.props.chat.groupMetadata)||void 0===t?void 0:t.participants)&&void 0!==e?e:[],v=(0,O.jsx)(b.TextSpan,{theme:"section-title",children:S.default.n(u.length)}),x=u.length?(0,O.jsx)(g.default,{title:S.default.t(2083),subtitle:v,children:(0,O.jsx)(_.default,{flatListController:this.flatListController,direction:"vertical",forceConsistentRenderCount:!1,data:this.getData(),renderItem:this.renderItem})}):null,C=(0,O.jsx)(g.default,{children:(0,O.jsx)(f.default,{a8nText:"li-delete-broadcast",icon:(0,O.jsx)(I.default,{name:"delete"}),color:"danger",theme:"list-aligned",onClick:this.handleDelete,children:S.default.t(1898)})});(null===(a=s.groupMetadata)||void 0===a?void 0:a.creation)?(d=o.default.createdStr(s.groupMetadata.creation),d=(0,O.jsx)(b.TextDiv,{theme:"small",children:d})):d=null;var M=null;y.default.supportsFeature(y.default.F.MD_BACKEND)&&(M=(0,O.jsx)(A.default,{onClick:this.showEncryptionInfoPopup,text:S.default.t(1845)}));var j=null;return M&&(j=(0,O.jsxs)(g.default,{children:[null,M]})),(0,O.jsxs)(h.default,{theme:"striped",children:[(0,O.jsxs)(m.default,{type:m.DRAWER_HEADER_TYPE.SMALL,onCancel:this.handleClose,children:[(0,O.jsx)(b.TextDiv,{theme:"title",children:S.default.t(384)}),d]}),(0,O.jsx)(p.default,{flatListControllers:[this.flatListController],children:(0,O.jsxs)("div",{className:n.default.body,children:[(0,O.jsx)("div",{className:n.default.photo,children:(0,O.jsx)(c.default,{id:s.id,size:c.DETAIL_IMAGE_SIZE.LARGE})}),i,j,x,C]})})]},"contact-info-modal")}}D.CONCERNS={chat:["id","groupMetadata"]},D.displayName="BroadcastInfoDrawer";var R=(0,M.default)((0,j.default)((0,T.default)(D,D.CONCERNS)));t.default=R},84851:(e,t,a)=>{"use strict";var s=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t,a=(0,p.default)(e.contact,["name","verifiedLevel","verifiedName","formattedName"]);t=c.default.supportsFeature(c.default.F.VNAME_V_2)?(()=>{switch(a.verifiedLevel){case o.default.VERIFIED_LEVEL.HIGH:return a.name===a.verifiedName?h.default.t(1849,{businessName:a.verifiedName}):h.default.t(1850,{businessName:a.verifiedName});case o.default.VERIFIED_LEVEL.LOW:case o.default.VERIFIED_LEVEL.UNKNOWN:return h.default.t(1851)}})():(()=>{switch(a.verifiedLevel){case o.default.VERIFIED_LEVEL.HIGH:return h.default.t(2111);case o.default.VERIFIED_LEVEL.LOW:return h.default.t(2113);case o.default.VERIFIED_LEVEL.UNKNOWN:return h.default.t(2115,{businessName:a.formattedName})}})();var s=(0,f.jsx)(i.default,{href:(0,u.getBusinessFaqUrl)(),onClick:g,children:h.default.t(1084)});return(0,f.jsxs)(n.default,{onOK:m,okText:h.default.t(1372),children:[(0,f.jsx)(r.default,{text:t})," ",s]})};var i=s(a(44683)),l=s(a(91952)),n=s(a(75940)),o=s(a(55454)),r=s(a(85051)),d=a(4919),u=a(57092),c=s(a(12950)),h=s(a(2408)),p=s(a(76006)),f=a(85893),m=()=>{l.default.closeModal()},g=e=>{e.preventDefault(),l.default.closeModal("none"),setTimeout((()=>(0,d.openExternalLink)((0,u.getBusinessFaqUrl)())),10)}},30693:(e,t,a)=>{"use strict";var s=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t,{contact:a}=e,s=h.default.t(458);function m(){o.default.openModal((0,f.jsx)(l.default,{contact:a}))}function g(){o.default.openModal((0,f.jsx)(n.default,{contact:a}))}t=(0,c.canSeeSMBUpsell)()?(0,f.jsx)(r.default,{a8nText:"business-title",onClick:g,side:(0,f.jsx)(p.default,{display:"inline",name:"info"}),children:s}):(0,f.jsx)(d.default,{a8nText:"business-title",className:i.default.businessTitleText,onClick:m,children:s});return(0,f.jsx)(u.default,{className:i.default.businessAccount,children:t})};var i=s(a(92447)),l=s(a(84851)),n=s(a(38880)),o=s(a(91952)),r=s(a(92787)),d=s(a(17061)),u=s(a(25061)),c=a(78615),h=s(a(2408)),p=s(a(2966)),f=a(85893)},13613:(e,t,a)=>{"use strict";var s=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t,a,s,{contact:i,onProductCatalog:v}=e,C=(0,l.useContext)(h.default),j=(0,g.getProductCatalogSessionId)(C);var E,T,P=u.default.toArray().find((e=>e.active));(null==P?void 0:P.id.equals(i.id))||((0,o.logMessageClick)(j),s=(0,M.jsx)(S,{icon:"chat-msg",label:m.default.t(1195),onClick:function(){(0,p.findChat)(i.id).then((function(e){c.default.openChatFromUnread(e).then((()=>{c.default.closeDrawerRight()}))}))},a8nText:"business-action chat"}));(null===(t=i.businessProfile)||void 0===t||null===(a=t.profileOptions)||void 0===a?void 0:a.commerceExperience)===r.COMMERCE_EXPERIENCE_TYPES.CATALOG&&(E=(0,M.jsx)(S,{icon:"catalog-filled",label:m.default.t(1069),onClick:()=>{(0,o.logCatalogClick)(j),v((0,g.getProductCatalogContext)(C))},a8nText:"business-action catalog"}));(0,d.hasShop)(i.businessProfile)&&(T=(0,M.jsx)(S,{icon:"shop-filled",label:m.default.t(1582),onClick:function(){(0,o.logShopsClick)(j),(0,d.goToShop)(i.businessProfile)},a8nText:"business-action shop"}));var I=(0,M.jsx)(S,{icon:"forward-filled",label:m.default.t(895),onClick:function(){(0,o.logForwardClick)(j),c.default.openModal((0,M.jsx)(_.default,{contacts:[(0,x.unproxy)(i)],onContactsSent:e=>{c.default.openChatFromUnread(e).then((()=>{}))}}))},a8nText:"business-action forward"});return(0,M.jsxs)(f.FlexRow,{className:n.default.actionsRow,justify:"evenly",children:[s,undefined,E,T,I]})};var i=s(a(94184)),l=a(67294),n=s(a(89628)),o=a(83137),r=a(4650),d=a(47874),u=s(a(84758)),c=s(a(91952)),h=(s(a(9322)),s(a(79864))),p=a(62238),f=a(63290),m=s(a(2408)),g=a(70790),v=s(a(3132)),_=s(a(74477)),x=a(15298),C=s(a(2966)),M=(a(61192),a(85893));a(24082).default,a(18124).Z;function S({a8nText:e,icon:t,label:a,disabled:s,onClick:l}){return(0,M.jsxs)("div",{className:(0,i.default)(n.default.actionButton,{[n.default.actionDisabled]:s}),children:[(0,M.jsx)(v.default,{inverted:!0,onClick:l,disabled:s,a8nText:e,children:(0,M.jsx)(C.default,{name:t,directional:!0})}),(0,M.jsx)("div",{className:n.default.actionLabel,children:a})]})}},36709:(e,t,a)=>{"use strict";var s=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var{businessHours:t}=e,a=(0,c.getProductCatalogSessionId)((0,l.useContext)(r.default)),s=(0,m.getBusinessOpenState)(t),[i,n]=(0,l.useState)(!0);if(null==t)return null;var d=(0,h.getBusinessHours)(t).map((e=>{var{day:t,hours:a,first:l}=e,n=t,o=a,r=!1;if(l)switch(s.status){case m.BUSINESS_OPEN_STATUS.OPEN_24H:n=u.default.t(425),o=u.default.t(421),r=!0;break;case m.BUSINESS_OPEN_STATUS.OPEN_APPOINTMENT:n=u.default.t(425),o=u.default.t(424),r=!0;break;case m.BUSINESS_OPEN_STATUS.OPEN:n=u.default.t(425),r=!0;break;case m.BUSINESS_OPEN_STATUS.CLOSED_TODAY:o=u.default.t(410)}return!l&&i?null:(0,g.jsx)(_,{day:n,dayIsOpen:r,hours:o,first:l,collapsed:i},t)}));return(0,g.jsx)(f.default,{xstyle:v.businessHours,onClick:()=>{(0,o.logHoursClick)(a),n(!i)},a8nText:"business-hours-expand",children:d})};var i=s(a(94184)),l=a(67294),n=(s(a(56720)),s(a(33596))),o=a(83137),r=s(a(79864)),d=s(a(85051)),u=s(a(2408)),c=a(70790),h=a(71547),p=s(a(2966)),f=s(a(89135)),m=a(83607),g=a(85893),v={businessHours:{display:"f804f6gw",width:"ln8gz9je",textAlign:"ml4r5409"}};function _(e){if(e.first){var t=(0,g.jsx)("div",{className:n.default.businessHoursChevron,role:"button",children:(0,g.jsx)(p.default,{className:e.collapsed?"":n.default.flipSvg,display:"inline",name:"chevron-down-alt"})});return(0,g.jsxs)("div",{className:(0,i.default)(n.default.businessHoursRow,{[n.default.firstRow]:e.first}),children:[(0,g.jsx)("div",{className:(0,i.default)(n.default.businessHoursDay,{[n.default.dayIsOpen]:e.dayIsOpen}),children:(0,g.jsx)(d.default,{direction:"auto",text:e.day})}),(0,g.jsx)("div",{className:n.default.businessHoursHours,children:(0,g.jsx)(d.default,{direction:"auto",text:e.hours})}),t]})}return(0,g.jsxs)("div",{className:n.default.businessHoursRow,children:[(0,g.jsx)("div",{className:n.default.businessHoursDay,children:(0,g.jsx)(d.default,{direction:"auto",text:e.day})}),(0,g.jsx)("div",{className:n.default.businessHoursHours,children:(0,g.jsx)(d.default,{direction:"auto",text:e.hours})})]})}},3511:(e,t,a)=>{"use strict";var s=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t,a,s,x,C,M,{businessProfile:S}=e,{description:j,address:E,latitude:T,longitude:P,website:I,email:b,businessHours:N}=(0,v.default)(S,["description","address","latitude","longitude","website","email","businessHours"]),y=(0,l.useContext)(u.default),A=(0,g.getProductCatalogSessionId)(y);null!=j&&(t=(0,_.jsx)("div",{className:o.default.section,children:(0,_.jsx)(p.default,{text:j,textLimit:d.default.BUSINESS_DESCRIPTION_INFO_PANEL_TRUNC_LENGTH,children:({textLimit:e})=>(0,_.jsx)(h.default,{className:o.default.description,selectable:!0,direction:"auto",text:j,textLimit:e})})}));null!=N&&(a=(0,_.jsx)("div",{className:o.default.section,children:(0,_.jsx)(n.default,{businessHours:N})}));null!=E&&(s=(0,_.jsx)("div",{className:o.default.section,children:(0,_.jsx)(h.default,{selectable:!0,direction:"auto",text:E})}));null!=T&&null!=P&&(x=(0,_.jsx)("div",{style:{height:132},className:(0,i.default)(o.default.section,o.default.map),children:(0,_.jsx)(m.default,{lat:T,lng:P,name:E||"",width:590,height:132,onClick:()=>(0,r.logLocationClick)(A),a8nText:"business-info-map"})}));null!=b&&(C=(0,_.jsx)("div",{className:o.default.section,children:(0,_.jsx)(f.default,{href:`mailto:${b}`,onClick:()=>(0,r.logEmailClick)(A),a8nText:"business-info-email",children:b})}));null!=I&&I.length>0&&(M=(0,_.jsx)("div",{className:o.default.section,children:I.map((e=>(0,_.jsx)("div",{children:(0,_.jsx)(f.default,{href:e,onClick:()=>(0,r.logWebsiteClick)(A),a8nText:"business-info-website",children:e})},e)))}));return null==t&&null==a&&null==s&&null==x&&null==C&&null==M?null:(0,_.jsxs)(c.default,{theme:"padding",children:[t,a,s,x,C,M]})};var i=s(a(94184)),l=a(67294),n=s(a(36709)),o=s(a(88274)),r=a(83137),d=s(a(55454)),u=s(a(79864)),c=s(a(25061)),h=s(a(85051)),p=s(a(18598)),f=s(a(4919)),m=s(a(23958)),g=a(70790),v=s(a(76006)),_=a(85893)},83137:(e,t,a)=>{"use strict";var s=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.logProfileImpression=function(e){var t=new i.default.ViewBusinessProfile({viewBusinessProfileAction:i.default.VIEW_BUSINESS_PROFILE_ACTION.ACTION_IMPRESSION,catalogSessionId:e});t&&t.commit()},t.logProfileExit=function(e,t){var a=new i.default.ViewBusinessProfile({viewBusinessProfileAction:i.default.VIEW_BUSINESS_PROFILE_ACTION.ACTION_EXIT,catalogSessionId:e,scrollDepth:t});a&&a.commit()},t.logMessageClick=function(e){var t=new i.default.ViewBusinessProfile({viewBusinessProfileAction:i.default.VIEW_BUSINESS_PROFILE_ACTION.ACTION_CLICK_MESSAGE,catalogSessionId:e});t&&t.commit()},t.logVoiceCallClick=function(e){var t=new i.default.ViewBusinessProfile({viewBusinessProfileAction:i.default.VIEW_BUSINESS_PROFILE_ACTION.ACTION_CLICK_VOICE_CALL,catalogSessionId:e});t&&t.commit()},t.logShopsClick=function(e){var t=new i.default.ViewBusinessProfile({viewBusinessProfileAction:i.default.VIEW_BUSINESS_PROFILE_ACTION.ACTION_CLICK_SHOPS_ICON,catalogSessionId:e});t&&t.commit()},t.logCatalogClick=function(e){var t=new i.default.ViewBusinessProfile({viewBusinessProfileAction:i.default.VIEW_BUSINESS_PROFILE_ACTION.ACTION_CLICK_CATALOG_ICON,catalogSessionId:e});t&&t.commit()},t.logForwardClick=function(e){var t=new i.default.ViewBusinessProfile({viewBusinessProfileAction:i.default.VIEW_BUSINESS_PROFILE_ACTION.ACTION_CLICK_FORWARD,catalogSessionId:e});t&&t.commit()},t.logEmailClick=function(e){var t=new i.default.ViewBusinessProfile({viewBusinessProfileAction:i.default.VIEW_BUSINESS_PROFILE_ACTION.ACTION_CLICK_EMAIL,catalogSessionId:e});t&&t.commit()},t.logWebsiteClick=function(e){var t=new i.default.ViewBusinessProfile({viewBusinessProfileAction:i.default.VIEW_BUSINESS_PROFILE_ACTION.ACTION_CLICK_WEBSITE,catalogSessionId:e});t&&t.commit()},t.logLocationClick=function(e){var t=new i.default.ViewBusinessProfile({viewBusinessProfileAction:i.default.VIEW_BUSINESS_PROFILE_ACTION.ACTION_CLICK_LOCATION,catalogSessionId:e});t&&t.commit()},t.logHoursClick=function(e){var t=new i.default.ViewBusinessProfile({viewBusinessProfileAction:i.default.VIEW_BUSINESS_PROFILE_ACTION.ACTION_CLICK_HOURS,catalogSessionId:e});t&&t.commit()},t.logStatusClick=function(e){var t=new i.default.ViewBusinessProfile({viewBusinessProfileAction:i.default.VIEW_BUSINESS_PROFILE_ACTION.ACTION_CLICK_STATUS,catalogSessionId:e});t&&t.commit()};var i=s(a(4231))},89797:(e,t,a)=>{"use strict";var s=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t,a,{contact:s}=e;if(s.isMyContact)if(s.name!==s.verifiedName){var d;s.showBusinessCheckmarkAsSecondary&&(d=(0,r.jsx)("div",{className:i.default.icon,children:(0,r.jsx)(o.default,{name:"psa-verified"})})),t=(0,r.jsx)(n.default,{contact:s}),a=(0,r.jsxs)("div",{className:i.default.wrapper,children:[(0,r.jsx)(l.default,{text:`~${s.verifiedName}`,className:i.default.verifiedText,direction:"auto",ellipsify:!0,titlify:!0}),d]})}else t=(0,r.jsx)(n.default,{contact:s,showBusinessCheckmark:s.showBusinessCheckmarkAsPrimary});else t=(0,r.jsx)(l.default,{text:s.verifiedName,direction:"auto",ellipsify:!0,titlify:!0}),a=(0,r.jsx)(n.default,{contact:s,showBusinessCheckmark:s.showBusinessCheckmarkAsPrimary});return(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:i.default.title,children:t}),(0,r.jsx)("div",{className:i.default.subtitle,children:a})]})};var i=s(a(23653)),l=s(a(85051)),n=s(a(78972)),o=s(a(2966)),r=a(85893)},81270:(e,t,a)=>{"use strict";var s=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.BusinessProfile=void 0;var i=s(a(94184)),l=a(67294),n=s(a(84851)),o=s(a(38880)),r=s(a(15525)),d=s(a(91952)),u=s(a(55454)),c=s(a(92787)),h=s(a(17061)),p=s(a(25061)),f=s(a(85051)),m=s(a(18598)),g=s(a(4919)),v=s(a(12950)),_=a(78615),x=s(a(2408)),C=s(a(663)),M=s(a(23958)),S=a(25281),j=s(a(4231)),E=a(71547),T=s(a(46714)),P=s(a(79485)),I=s(a(2966)),b=a(85893),{VERIFIED_LEVEL:N}=u.default;class y extends l.PureComponent{constructor(...e){super(...e),this.state={collapsedHours:!0},this._onBusinessHoursClick=()=>{this.setState({collapsedHours:!this.state.collapsedHours})},this._onBusinessInfoClick=()=>{d.default.openModal((0,b.jsx)(n.default,{contact:this.props.contact}))},this._onBusinessInfoWithUpsellClick=()=>{d.default.openModal((0,b.jsx)(o.default,{contact:this.props.contact}))}}componentDidMount(){new j.default.ViewBusinessProfile({viewBusinessProfileAction:j.default.VIEW_BUSINESS_PROFILE_ACTION.ACTION_IMPRESSION}).commit()}_getBusinessInfoTitle(){var e,t=this.props.contact,a=!t.name||t.name===t.verifiedName,s="psa-unverified";switch(t.verifiedLevel){case N.HIGH:s="psa-verified",a?e=(0,b.jsx)(f.default,{className:r.default.verifiedLabel,text:x.default.t(461)}):(e=(0,b.jsx)(f.default,{className:r.default.verifiedLabel,text:x.default.t(459)}),e=(0,b.jsx)(C.default,{id:460,params:{verified:e,businessName:t.verifiedName}}));break;case N.LOW:e=a?(0,b.jsx)(f.default,{text:x.default.t(438)}):x.default.t(437,{businessName:t.verifiedName});break;case N.UNKNOWN:e=x.default.t(433)}return(0,b.jsx)(w,{icon:s,className:r.default.businessMarker,onClick:this._onBusinessInfoClick,children:e})}_getBusinessInfoTitleV2(){var e;switch(this.props.contact.verifiedLevel){case N.HIGH:e=x.default.t(456);break;case N.LOW:case N.UNKNOWN:e=x.default.t(433)}return(0,b.jsx)(h.default,{a8nText:"business-title",className:r.default.businessTitleText,onClick:this._onBusinessInfoClick,children:e})}_getBusinessInfoTitleWithSMBUpsell(){var e=this.props.contact.verifiedLevel===N.HIGH?x.default.t(456):x.default.t(433);return(0,b.jsx)(c.default,{a8nText:"business-title",onClick:this._onBusinessInfoWithUpsellClick,side:(0,b.jsx)(I.default,{className:r.default.infoIcon,display:"inline",name:"info"}),children:e})}_getBusinessHours(e){var t=(0,E.getBusinessHours)(e).map((e=>{var{day:t,hours:a,first:s}=e;return!s&&this.state.collapsedHours?null:(0,b.jsx)(A,{day:t,hours:a,first:s,collapsed:this.state.collapsedHours},t)}));return(0,b.jsx)(w,{icon:"business-hours",onClick:this._onBusinessHoursClick,children:t})}getAddressString(e){var{streetAddress:t,localizedCityName:a,zipCode:s}=e;return t&&a&&s?x.default.t(432,{streetAddress:t,city:a,zipCode:s}):t&&a?x.default.t(431,{streetAddress:t,city:a}):t}_getAddress(e,t,a,s){var i,l,n,o=s?this.getAddressString(s):null;(null!=t&&null!=a&&(i=(0,b.jsx)("div",{style:{height:150},className:r.default.businessMap,children:(0,b.jsx)(M.default,{lat:t,lng:a,name:o||e,width:565,height:150})})),o)&&(n=null!=t&&null!=a?(0,S.getMapUrl)(t,a,o):(0,S.getSearchUrl)(o),l=(0,b.jsx)("div",{className:r.default.address,children:(0,b.jsx)(g.default,{href:n,children:(0,b.jsx)(f.default,{selectable:!0,direction:"auto",text:o})})}));return l||i?(0,b.jsxs)(w,{icon:"business-address",children:[l,i]}):null}render(){var e,t,a,s,i,l,n,o;e=(0,_.canSeeSMBUpsell)()?this._getBusinessInfoTitleWithSMBUpsell():v.default.supportsFeature(v.default.F.VNAME_V_2)?this._getBusinessInfoTitleV2():this._getBusinessInfoTitle();var d,c=this.props.businessProfile;if(c.stale)t=(0,b.jsx)("div",{className:r.default.contactBusinessInfoSpinner,children:(0,b.jsx)(T.default,{size:20,stroke:5})});else if(a=c.categories&&c.categories.length?(0,b.jsx)(w,{icon:"business-category",children:(0,b.jsx)(f.default,{selectable:!0,direction:"auto",text:c.categories.map((e=>e.localized_display_name)).join(x.default.t(806))})}):null,s=c.description?(0,b.jsx)(w,{icon:"business-description",children:(0,b.jsx)(m.default,{text:c.description,textLimit:u.default.BUSINESS_DESCRIPTION_INFO_PANEL_TRUNC_LENGTH,children:({textLimit:e})=>(0,b.jsx)(f.default,{selectable:!0,direction:"auto",breakWord:!0,text:c.description,textLimit:e})})}):null,i=this._getAddress(this.props.contact.name,c.latitude,c.longitude,c.structuredAddress),c.website&&Array.isArray(c.website)&&c.website.length&&(l=c.website.map(((e,t)=>{var a=(0,E.getWebsiteLink)(e),s=(0,b.jsx)(f.default,{selectable:!0,direction:"auto",text:e}),i=(0,b.jsx)(g.default,{className:r.default.link,href:a,children:s});return(0,b.jsx)(w,{icon:"business-website",children:i},t)}))),c.businessHours&&(n=this._getBusinessHours(c.businessHours)),c.email){var h=(0,b.jsx)(f.default,{selectable:!0,direction:"auto",text:c.email}),C=(0,b.jsx)(g.default,{className:r.default.link,href:`mailto:${c.email}`,children:h});o=(0,b.jsx)(w,{icon:"business-email",dir:"auto",children:C})}return(t||null!=i||a||s||null!=n||o||l)&&(d=(0,b.jsx)(p.default,{theme:"padding",children:(0,b.jsxs)("div",{className:r.default.contactBusinessInfo,children:[t,i,a,s,n,o,l]})})),(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(p.default,{children:e}),d]})}}t.BusinessProfile=y,y.CONCERNS={contact:["id","verifiedLevel","name","verifiedName"],businessProfile:["description","categories","website","email","stale","latitude","longitude","businessHours","structuredAddress"]},y.displayName="BusinessProfile";var A=e=>{var t=e.first?(0,b.jsx)("div",{className:r.default.businessHoursChevron,role:"button",children:(0,b.jsx)(I.default,{className:e.collapsed?"":r.default.flipSvg,display:"inline",name:"chevron-down-alt"})}):null;return(0,b.jsxs)("div",{className:r.default.businessHoursRow,children:[(0,b.jsx)("div",{className:r.default.businessHoursDay,children:(0,b.jsx)(f.default,{direction:"auto",text:e.day})}),(0,b.jsx)("div",{className:r.default.businessHoursHours,children:(0,b.jsx)(f.default,{direction:"auto",text:e.hours})}),t]})},w=e=>(0,b.jsxs)("div",{className:(0,i.default)(r.default.dataRow,e.className),onClick:e.onClick,children:[(0,b.jsx)("div",{className:r.default.dataRowIcon,children:(0,b.jsx)(I.default,{name:e.icon})}),(0,b.jsx)("div",{className:r.default.dataRowText,children:e.children})]}),O=(0,P.default)(y,y.CONCERNS);t.default=O},45035:(e,t,a)=>{"use strict";var s=a(20862),i=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=a(67294),n=i(a(55092)),o=s(a(75381)),r=i(a(91952)),d=i(a(55454)),u=i(a(25061)),c=a(60651),h=i(a(86025)),p=i(a(2408)),f=i(a(71681)),m=i(a(80091)),g=i(a(79485)),v=i(a(2966)),_=a(97504),x=a(85893);class C extends l.Component{constructor(...e){super(...e),this._commonGroupInitialized=!1,this.state={collapsed:!1,numGroups:0},this.rerender=()=>{this.forceUpdate()},this.handleClick=(e,t)=>{r.default.openChatFromUnread(t).then((e=>{e&&r.default.focusChatTextInput(t)})),this.props.onClose()},this.handleShowMore=()=>{this.setState({collapsed:!1})},this.renderItem=e=>{var{chat:t}=e;return(0,x.jsx)(o.default,{chat:t,theme:"drawer-list",contact:t.contact,mode:o.Mode.INFO,onClick:this.handleClick},t.id.toString())}}static getDerivedStateFromProps(e,t){var{commonGroups:a}=e.contact,s=a?a.length:0;return t.numGroups<=d.default.INFO_DRAWER_MAX_ROWS&&s>d.default.INFO_DRAWER_MAX_ROWS?{numGroups:s,collapsed:!0}:{numGroups:s}}componentDidMount(){var{commonGroups:e}=this.props.contact;e&&(this.props.listeners.add(e,"add remove",this.rerender),this._commonGroupInitialized=!0),(0,c.findCommonGroups)(this.props.contact).catch((()=>{throw __LOG__(4,!0,new Error,!0)`get from participants table failed`,SEND_LOGS("get from participants table failed when finding common groups"),new Error("get from participants table failed")}))}componentDidUpdate(e){if(e.contact!==this.props.contact){var t=e.contact.commonGroups;t&&e.listeners.remove(t,"add remove",this.rerender),this._commonGroupInitialized=!1}var{commonGroups:a}=this.props.contact;a&&(this._commonGroupInitialized||(this.props.listeners.add(a,"add remove",this.rerender),this._commonGroupInitialized=!0))}componentWillUnmount(){var{commonGroups:e}=this.props.contact;e&&this._commonGroupInitialized&&(this.props.listeners.remove(e,"add remove",this.rerender),this._commonGroupInitialized=!1)}getData(){var e=this.props.contact.commonGroups;return e.length>d.default.INFO_DRAWER_MAX_ROWS&&this.state.collapsed&&(e=e.slice(0,d.default.INFO_DRAWER_MAX_ROWS)),e.map((e=>({itemKey:e.id.toString(),chat:e})))}render(){var e=this.props.contact.commonGroups;if(!e||!e.length)return null;var t,a=(0,x.jsx)(_.TextSpan,{theme:"section-title",children:p.default.n(e.length)});if(e.length>d.default.INFO_DRAWER_MAX_ROWS&&this.state.collapsed){var s=e.length-d.default.INFO_DRAWER_MAX_ROWS,i=(0,x.jsx)(m.default,{theme:"transparent",children:(0,x.jsx)(v.default,{name:"down"})});t=(0,x.jsx)(n.default,{image:i,theme:"drawer-list",primary:p.default.t(992,{count:s,_plural:s}),onClick:this.handleShowMore})}return(0,x.jsxs)(u.default,{a8nText:"section-common-groups",title:p.default.t(1983),subtitle:a,children:[(0,x.jsx)(h.default,{flatListController:this.props.flatListController,direction:"vertical",forceConsistentRenderCount:!1,data:this.getData(),renderItem:this.renderItem}),t]})}}C.CONCERNS={contact:["commonGroups"]},C.displayName="CommonGroupsWell";var M=(0,f.default)((0,g.default)(C,C.CONCERNS));t.default=M},68177:(e,t,a)=>{"use strict";var s=a(20862),i=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=i(a(81109)),n=a(55084),o=a(67294),r=a(38512),d=i(a(15701)),u=i(a(30693)),c=i(a(3511)),h=a(83137),p=i(a(81270)),f=a(47874),m=i(a(60028)),g=i(a(22715)),v=i(a(84758)),_=i(a(91952)),x=i(a(45035)),C=i(a(75940)),M=i(a(58293)),S=a(59014),j=i(a(92128)),E=s(a(88419)),T=i(a(17747)),P=i(a(92787)),I=i(a(9042)),b=i(a(17061)),N=i(a(79864)),y=s(a(55588)),A=i(a(25061)),w=i(a(85051)),O=i(a(38946)),D=a(54647),R=i(a(67893)),k=i(a(12950)),L=a(78615),B=i(a(52087)),F=i(a(45530)),G=i(a(2408)),U=i(a(663)),V=i(a(71681)),H=i(a(38775)),W=i(a(52963)),Y=i(a(4231)),q=i(a(93450)),K=i(a(78972)),z=i(a(25817)),Z=a(70790),X=i(a(90277)),$=i(a(40630)),Q=i(a(19582)),J=a(20845),ee=a(84254),te=i(a(87947)),ae=i(a(56605)),se=a(48224),ie=i(a(79485)),le=i(a(77898)),ne=i(a(2966)),oe=a(97504),re=s(a(49201)),de=i(a(30584)),ue=i(a(98532)),ce=i(a(65565)),he=a(28535),pe=a(42805),fe=a(10608),me=a(86723),ge=i(a(82829)),ve=i(a(61057)),_e=a(57092),xe=a(60408),Ce=i(a(20838)),Me=i(a(23388)),Se=a(85893);class je extends o.Component{constructor(e){super(e),this.flatListController=new R.default,this._handleBlocklistChange=()=>{this.state.contactIsBlocked!==!!d.default.get(this.props.contact.id)&&this.setState({contactIsBlocked:!!d.default.get(this.props.contact.id)})},this.handleVerificationClick=()=>{this.props.onVerification()},this._handleDeleteChat=()=>{var e=v.default.assertGet(this.props.contact.id);_.default.deleteOrExitChat(e)},this.handleBlockContact=()=>{var e=(0,Se.jsx)(K.default,{contact:this.props.contact});_.default.openModal((0,Se.jsx)(C.default,{onOK:this.blockContact,okText:G.default.t(313),onCancel:()=>_.default.closeModal(),cancelText:G.default.t(1856),children:(0,Se.jsx)(U.default,{id:315,params:{contact:e}})}))},this.handleReportSpam=()=>{_.default.openModal((0,Se.jsx)(Q.default,{isBusiness:this.props.contact.isBusiness,isGroupChat:!1,onReport:this.reportSpam,onReportBlockClear:this.reportSpamBlockClear,onCancel:()=>_.default.closeModal()}))},this.reportSpam=()=>{var e=v.default.get(this.props.contact.id);e&&(0,ee.sendSpamReport)(e,se.SpamFlow.Account),_.default.closeModal()},this.reportSpamBlockClear=()=>{var e=v.default.get(this.props.contact.id);e&&(0,ee.sendSpamBlockClear)(e,se.SpamFlow.Block),_.default.closeModal()},this.handleUnblockContact=()=>{var e=(0,Se.jsx)(K.default,{contact:this.props.contact});_.default.openModal((0,Se.jsx)(C.default,{okText:G.default.t(1661),onOK:this.unblockContact,cancelText:G.default.t(1856),onCancel:()=>_.default.closeModal(),children:(0,Se.jsx)(U.default,{id:1662,params:{contact:e}})}))},this.blockContact=()=>{(0,r.blockContact)(this.props.contact),_.default.closeModal()},this.unblockContact=()=>{(0,r.unblockContact)(this.props.contact),_.default.closeModal()},this.handleClose=()=>{this.props.onClose?this.props.onClose():this.props.uim.uie.requestDismiss()},this._handleViewPicture=e=>{if(this._canViewPicture){var t=e.target;_.default.openModalMedia((0,Se.jsx)(z.default,{contact:this.props.contact,profilePicThumb:this.props.contact.getProfilePicThumb(),animateBorderRadius:!0,getZoomNode:e=>{e(t)}}),{transition:"profile-viewer",uim:this.props.uim})}else _.default.openToast((0,Se.jsx)(re.default,{id:(0,re.genId)(),msg:G.default.t(1349)}))},this._handleOpenStatus=()=>{(0,h.logStatusClick)((0,Z.getProductCatalogSessionId)(this.context))},this._handleDetailImageLoad=()=>{this._canViewPicture=!0},this._canViewPicture=!1,this.state={contactIsBlocked:!!d.default.get(e.contact.id),scrollDepth:100}}componentDidMount(){this.props.listeners.add(d.default,"add remove reset sync",this._handleBlocklistChange);var{contact:e}=this.props;e.businessProfile&&!e.businessProfile.stale&&e.businessCatalog&&m.default.findCarouselCatalog(e.id).catch((0,n.filteredCatch)(D.ServerStatusCodeError,(()=>{__LOG__(3)`Failed to fetch product catalog in contact drawer from server`}))),k.default.supportsFeature(k.default.F.MD_BACKEND)&&(0,fe.getFanOutList)([e.id,(0,me.assertGetMe)()]).then((e=>{(0,he.ensureE2ESessions)(e)}));var{session:t}=(0,Z.getProductCatalogContext)(this.context);t.isAccidental()?_.default.setDrawerContext("right",(0,Z.buildProductCatalogContext)(new X.default,(0,S.getMaybeBizPlatformForLogging)(e.id.toString()),Y.default.CATALOG_ENTRY_POINT.CATALOG_ENTRY_POINT_PROFILE)):e.isBusiness&&(0,L.canSeeBizProfileV3)()&&(0,h.logProfileImpression)((0,Z.getProductCatalogSessionId)(this.context))}componentWillUnmount(){var{contact:e}=this.props,{session:t}=(0,Z.getProductCatalogContext)(this.context);t.isAccidental()||e.isBusiness&&(0,L.canSeeBizProfileV3)()&&(0,h.logProfileExit)((0,Z.getProductCatalogSessionId)(this.context),this.state.scrollDepth)}_shouldRenderCatalog(){var{contact:e}=this.props;return!!(e&&e.isBusiness&&e.businessProfile)&&!!e.businessCatalog}_renderBusinessProfileTopCard(){return this.props.contact.businessProfile?(0,Se.jsx)(j.default,{contact:this.props.contact,onProfilePicLoad:this._handleDetailImageLoad,onProfilePicClick:this._handleViewPicture,onOpenStatus:this._handleOpenStatus,businessProfile:this.props.contact.businessProfile,onProductCatalog:this.props.onProductCatalog}):null}_renderTopCard(){var{contact:e}=this.props;if((0,L.canSeeBizProfileV3)()&&e.isBusiness)return this._renderBusinessProfileTopCard();var t=v.default.get(e.id),a=!e.name&&e.notifyName?(0,Se.jsx)("div",{className:M.default.nameSecondary,children:(0,Se.jsx)(oe.TextSpan,{theme:"muted",children:(0,Se.jsx)(w.default,{className:M.default.screenName,direction:"auto",text:e.notifyName,selectable:!0})})}):null,s=e.showBusinessCheckmarkAsSecondary&&k.default.supportsFeature(k.default.F.VNAME_V_2)?(0,Se.jsxs)("div",{className:M.default.businessVname,children:[(0,Se.jsx)(w.default,{text:e.verifiedName,direction:"auto"}),(0,Se.jsx)("div",{className:M.default.icon,children:(0,Se.jsx)(ne.default,{name:"psa-verified"})})]}):null,i=t&&t.presence?(0,Se.jsx)(de.default,{contact:e,presence:t.presence,chatstate:t.presence.chatstate,location:"info"}):null;return(0,Se.jsxs)(A.default,{theme:"padding-large",children:[(0,Se.jsx)("div",{className:M.default.avatar,children:(0,Se.jsx)(E.default,{id:e.id,size:E.DETAIL_IMAGE_SIZE.LARGE,loader:!0,onLoad:this._handleDetailImageLoad,onClick:this._handleViewPicture,quality:E.DETAIL_IMAGE_QUALITY.HIGH})}),(0,Se.jsx)(oe.TextHeader,{level:"2",theme:"large",children:(0,Se.jsx)(K.default,{contact:e,selectable:!0,showBusinessCheckmark:e.showBusinessCheckmarkAsPrimary})}),a,(0,Se.jsxs)("div",{className:M.default.nameSecondary,children:[(0,Se.jsx)(oe.TextSpan,{theme:"muted",children:s}),(0,Se.jsx)(oe.TextSpan,{theme:"muted",children:i})]}),(0,Se.jsx)(F.default,{labels:e.labels})]})}_handleScroll(e){var t=Math.floor(100*(1+e.currentTarget.scrollTop/e.currentTarget.offsetHeight));t>this.state.scrollDepth&&this.setState({scrollDepth:t})}renderProductCatalogSection(){if(!this._shouldRenderCatalog())return null;var{contact:e,onProductCatalog:t,onProductDetail:a}=this.props,s=m.default.get(e.id);if(!s)return null;var i="",l=!1;(0,L.canSeeBizProfileV3)()&&(i=G.default.t(540),l=!0);var{session:n}=(0,Z.getProductCatalogContext)(this.context);return n.isAccidental()?null:(0,f.hasShop)(e.businessProfile)?(0,Se.jsx)(ae.default,{businessProfile:e.businessProfile,catalog:s,subtitle:i,hideIncompleteRows:l}):(0,Se.jsx)(g.default,{onProductDetail:a,onProductCatalog:t,catalog:s,subtitle:i,hideIncompleteRows:l,shouldLog:!0})}renderButtons(){var e,t=this.props.contact,a=v.default.get(t.id),s=k.default.isNewChatInfoEnabled()?"borderless":null;a&&(e=(0,Se.jsx)(b.default,{a8nText:"li-delete-chat",icon:(0,Se.jsx)(ne.default,{name:"delete"}),color:"danger",onClick:this._handleDeleteChat,theme:s,children:G.default.t(738)}));var i=null;i=this.state.contactIsBlocked?(0,Se.jsx)(b.default,{a8nText:"li-unblock",color:"success",icon:(0,Se.jsx)(ne.default,{name:"settings-blocked",directional:!0}),onClick:this.handleUnblockContact,theme:s,children:G.default.t(1661)}):(0,Se.jsx)(b.default,{a8nText:"li-block",color:"danger",icon:(0,Se.jsx)(ne.default,{name:"settings-blocked",directional:!0}),onClick:this.handleBlockContact,theme:s,children:G.default.t(313)});var l=(0,Se.jsx)(b.default,{a8nText:"li-report-spam",color:"danger",icon:(0,Se.jsx)(ne.default,{name:"thumbs-down",directional:!0}),onClick:this.handleReportSpam,theme:s,children:t.isBusiness?G.default.t(1477):G.default.t(1480)});return k.default.isNewChatInfoEnabled()?(0,Se.jsxs)(A.default,{children:[i,l,e]}):(0,Se.jsxs)(Se.Fragment,{children:[(0,Se.jsx)(A.default,{children:i}),(0,Se.jsx)(A.default,{children:l}),(0,Se.jsx)(A.default,{children:e})]})}render(){var e=this.props.contact,t=(0,Se.jsx)(x.default,{contact:this.props.contact,onClose:this.handleClose,flatListController:this.flatListController}),a=v.default.get(e.id),s=null;if(this.props.onMediaGallery&&a){var i=this.props.onMediaGallery,l=(0,Se.jsx)(ne.default,{className:M.default.chevron,name:"chevron-right-alt",directional:!0}),n=G.default.t(1174);s=(0,Se.jsx)(A.default,{a8nText:"section-media",title:n,titleOnClick:i,subtitle:l,theme:"padding",children:(0,Se.jsx)(W.default,{chat:a,mediaMsgs:a.getMediaMsgs()})})}var o=null;k.default.supportsFeature(k.default.F.LIVE_LOCATIONS)&&a&&(o=(0,Se.jsx)(H.default,{chat:a,onClick:this.props.onLiveLocation}));var r=null,d=null;(0,L.canSeeBizProfileV3)()?d=this.renderProductCatalogSection():r=this.renderProductCatalogSection();var h=a&&a.mute.canMute()?(0,Se.jsx)(q.default,{chat:a,mute:a.mute,settings:te.default}):null,f=null;if(this.props.onStarred){var m=(0,Se.jsx)(ne.default,{className:M.default.chevron,name:"chevron-right-alt",directional:!0});f=(0,Se.jsx)(P.default,{a8nText:"block-starred-messages",side:m,onClick:this.props.onStarred,children:(0,Se.jsx)(oe.TextSpan,{theme:"title",children:G.default.t(581)})})}var g=a&&a.shouldShowEphemeralSetting()?(0,Se.jsx)(O.default,{onClick:this.props.onEphemeral,chat:a}):null,_=null,C=a&&a.getReceivedVcardMsgs();if(k.default.supportsFeature(k.default.F.INDEX_RECEIVED_VCARD)&&C&&C.length){var S=(0,Se.jsx)(ne.default,{className:M.default.chevron,name:"chevron-right-alt",directional:!0});_=(0,Se.jsx)(P.default,{a8nText:"block-contact-card",side:S,onClick:this.props.onContactCard,children:(0,Se.jsx)(oe.TextSpan,{theme:"title",children:G.default.t(707,{_plural:C.length})})})}var j=k.default.supportsFeature(k.default.F.MD_BACKEND)?(0,Se.jsx)(Ee,{reducedPrivacyMode:(0,pe.getReducedPrivacyMode)(this.props.contact.privacyMode),onVerificationClick:this.handleVerificationClick,contactId:this.props.contact.id}):null,E=null;(h||f||g||_||j)&&(E=(0,Se.jsxs)(A.default,{children:[h,f,g,_,j]}));var b,N,w=(0,Se.jsx)(P.default,{multiline:!0,children:(0,Se.jsx)(oe.TextSpan,{theme:"title",children:(0,Se.jsx)(le.default,{id:e.id})})}),D=(0,Se.jsx)(P.default,{children:(0,Se.jsx)(J.SelectableSpan,{dir:"auto",selectable:!0,children:(0,Se.jsx)(oe.TextSpan,{theme:"title",children:(0,ue.default)(e.id)})})}),R=(0,Se.jsxs)(A.default,{a8nText:"section-about-and-phone-number",children:[(0,Se.jsx)("div",{className:M.default.titleAbout,children:(0,Se.jsx)(oe.TextSpan,{theme:"section-title",children:G.default.t(708)})}),w,D]}),B=this._renderTopCard(),U=null,V=void 0;return e.isBusiness&&e.businessProfile&&((0,L.canSeeBizProfileV3)()&&e.businessProfile?(U=(0,Se.jsx)(c.default,{businessProfile:e.businessProfile}),b=(0,Se.jsx)(u.default,{contact:e}),e.labels&&e.labels.length>0&&(N=(0,Se.jsx)(A.default,{theme:"padding",children:(0,Se.jsx)(F.default,{labels:e.labels,theme:"standalone"})})),V=this._handleScroll.bind(this)):e.businessProfile&&(U=(0,Se.jsx)(p.default,{contact:e,businessProfile:e.businessProfile}))),(0,Se.jsxs)(T.default,{theme:"striped",children:[(0,Se.jsx)(y.default,{title:G.default.t(1868),type:y.DRAWER_HEADER_TYPE.SMALL,onCancel:this.handleClose}),(0,Se.jsx)(I.default,{flatListControllers:[this.flatListController],onScroll:V,children:(0,Se.jsxs)("section",{className:M.default.body,children:[B,b,N,d,U,o,r,s,E,R,null,t,this.renderButtons()]})})]},"contact-info-modal")}}function Ee({reducedPrivacyMode:e,onVerificationClick:t,contactId:a}){var s=ve.default.isVoiceCallEnabled()||ve.default.isVideoCallEnabled()?G.default.t(1872):G.default.t(1871);if(ce.default.bspSystemMessageEnabled){var{title:i,text:n,onClick:o}=function(e,t){if((0,Me.default)(t.user))return{text:G.default.t(1631),title:G.default.t(710),onClick:()=>{(0,Ce.default)(G.default.t(1629),(0,_e.getSupportChatSafetyFaqUrl)(),G.default.t(1630))}};switch(e){case pe.ReducedPrivacyMode.E2EE:return(0,l.default)({},null);case pe.ReducedPrivacyMode.BSP:return{text:G.default.t(296),title:G.default.t(710),onClick:()=>{(0,Ce.default)((0,xe.formatBspModalText)(),(0,_e.getE2EEnterpriseFaqUrl)())}};case pe.ReducedPrivacyMode.FB:return{text:G.default.t(297),title:G.default.t(710),onClick:()=>{(0,Ce.default)((0,xe.formatFbModalText)(),(0,_e.getE2EEnterpriseFaqUrl)())}}}}(e,a);return(0,Se.jsx)(ge.default,{title:i,text:null!=n?n:s,onClick:null!=o?o:t})}return(0,Se.jsx)(ge.default,{onClick:t,text:s})}je.contextType=N.default,je.CONCERNS={contact:["id","formattedName","formattedUser","formattedShortName","isBusiness","isEnterprise","isMyContact","commonGroups","businessProfile","showBusinessCheckmarkAsPrimary","showBusinessCheckmarkAsSecondary","verifiedName","verifiedLevel","name","notifyName","labels","businessCatalog","isContactBlocked","isMe","statusMute","privacyMode"]},je.displayName="ContactInfoDrawer";var Te=(0,B.default)((0,$.default)((0,V.default)((0,ie.default)(je,je.CONCERNS))));t.default=Te},92128:(e,t,a)=>{"use strict";var s=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function({contact:e,businessProfile:t,onOpenStatus:a,onProductCatalog:s,onProfilePicLoad:p,onProfilePicClick:f}){var m,{businessHours:g,categories:v}=(0,c.default)(t,["businessHours","categories"]),_=(0,h.jsx)(l.default,{contact:e});null!=v&&v.length>0&&(m=(0,h.jsx)("div",{className:o.default.categories,children:v.map((e=>e.localized_display_name)).join(d.default.t(805))}));var x=g?(0,h.jsx)(u.default,{hours:g}):null;return(0,h.jsxs)(r.default,{className:o.default.noPaddingBottom,theme:"padding",children:[(0,h.jsx)(n.default,{contact:e,onClick:f,onOpenStatus:a,onLoad:p}),(0,h.jsxs)("div",{className:o.default.info,children:[_,m,x,(0,h.jsx)(i.default,{contact:e,onProductCatalog:s})]})]})};var i=s(a(13613)),l=s(a(89797)),n=s(a(77392)),o=s(a(78857)),r=s(a(25061)),d=s(a(2408)),u=s(a(80614)),c=s(a(76006)),h=a(85893)},24337:(e,t,a)=>{"use strict";var s=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return i.default}});var i=s(a(68177))},80614:(e,t,a)=>{"use strict";var s=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var{hours:t}=e,a=function(e){switch(e.status){case o.BUSINESS_OPEN_STATUS.OPEN_24H:return l.default.t(422,{open:`<span class="${n.default.open}">${l.default.t(420)}</span>`});case o.BUSINESS_OPEN_STATUS.OPEN_APPOINTMENT:return l.default.t(423,{open:`<span class="${n.default.open}">${l.default.t(420)}</span>`});case o.BUSINESS_OPEN_STATUS.OPEN:if(e.openUntil&&e.additionalOpen&&e.additionalClose)return l.default.t(427,{open:`<span class="${n.default.open}">${l.default.t(420)}</span>`,time:d(e.openUntil),additionalOpenTime:d(e.additionalOpen),additionalCloseTime:d(e.additionalClose)});if(e.openUntil)return l.default.t(426,{open:`<span class="${n.default.open}">${l.default.t(420)}</span>`,time:d(e.openUntil)});break;case o.BUSINESS_OPEN_STATUS.CLOSED:return e.opensAt?l.default.t(412,{closed:`<span class="${n.default.closed}">${l.default.t(411)}</span>`,time:d(e.opensAt)}):`<span class="${n.default.closed}">${l.default.t(411)}</span>`;case o.BUSINESS_OPEN_STATUS.CLOSED_TODAY:return`<span class="${n.default.closed}">${l.default.t(413)}</span>`}return null}((0,o.getBusinessOpenState)(t));if(null==a)return null;var s=i.default.sanitize(a);return(0,r.jsx)("div",{className:n.default.openStatus,dangerouslySetInnerHTML:{__html:s}})};var i=s(a(27856)),l=s(a(2408)),n=s(a(32201)),o=a(83607),r=a(85893);function d(e){return null==e?"":e.toLocaleTimeString([],{hour:"numeric",minute:"2-digit"})}},82829:(e,t,a)=>{"use strict";var s=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){if(i.default.supportsFeature(i.default.F.MD_BACKEND)){var t,{onClick:a,text:s}=e,c=(0,u.jsx)(n.default,{name:"lock",className:r.default.icon});return(0,u.jsxs)(o.default,{onClick:a,side:c,multiline:!0,children:[(0,u.jsx)("div",{className:r.default.header,children:(0,u.jsx)(l.TextSpan,{theme:"title",children:null!==(t=e.title)&&void 0!==t?t:d.default.t(1900)})}),(0,u.jsx)(l.TextDiv,{theme:"muted",children:s})]})}return null};var i=s(a(12950)),l=a(97504),n=s(a(2966)),o=s(a(92787)),r=s(a(13474)),d=s(a(2408)),u=a(85893)},81343:(e,t,a)=>{"use strict";var s=a(20862),i=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=i(a(81109)),n=i(a(48926)),o=a(55084),r=a(67294),d=i(a(76610)),u=i(a(50692)),c=i(a(70569)),h=i(a(55092)),p=i(a(25142)),f=i(a(91952)),m=i(a(75940)),g=i(a(55454)),v=i(a(17747)),_=i(a(92787)),x=i(a(9042)),C=i(a(17061)),M=s(a(55588)),S=i(a(25061)),j=i(a(47452)),E=i(a(37719)),T=i(a(85051)),P=i(a(61136)),I=i(a(38946)),b=s(a(13540)),N=a(62238),y=s(a(86025)),A=i(a(67893)),w=a(86723),O=i(a(12950)),D=i(a(13648)),R=i(a(92051)),k=i(a(52087)),L=a(49895),B=i(a(45530)),F=i(a(2408)),G=s(a(17126)),U=i(a(71681)),V=i(a(38775)),H=i(a(52963)),W=i(a(4231)),Y=a(97449),q=i(a(93450)),K=a(78972),z=i(a(31175)),Z=i(a(76865)),X=i(a(45605)),$=i(a(76870)),Q=a(76229),J=i(a(40630)),ee=i(a(19582)),te=i(a(80091)),ae=a(84254),se=i(a(65565)),ie=a(2027),le=a(32593),ne=i(a(87947)),oe=a(48224),re=i(a(79485)),de=a(15298),ue=i(a(24348)),ce=i(a(2966)),he=a(97504),pe=s(a(29458)),fe=s(a(49201)),me=i(a(63477)),ge=i(a(68062)),ve=i(a(69635)),_e=a(73554),xe=i(a(82829)),Ce=i(a(61057)),Me=a(276),Se=a(85893);function je(e){return e.length>g.default.INFO_DRAWER_MAX_ROWS_IN_COLLAPSED_LIST}var Ee=(0,fe.genId)("max_participant_toast");class Te extends r.Component{constructor(e){var t;super(e),t=this,this._participantFlatListController=new A.default,this._pendingParticipantFlatListController=new A.default,this._setRefContainer=e=>{this._refContainer=e},this._updateGroupDescOnModelChange=()=>{this.props.groupMetadata&&this.setState({groupDesc:this.props.groupMetadata.desc})},this.handleImageSet=(e,t)=>{var a=this.props.profilePicThumb;this.setState({pendingPhoto:!0}),(e&&t?(0,Q.setProfilePic)(a,e,t):(0,Q.deleteProfilePic)(a)).checkpoint(this.props.rejectOnUnmount()).catch((0,o.filteredCatch)(b.Unmount,(()=>{}))).catch((0,o.filteredCatch)(b.ActionError,(()=>{__LOG__(3)`GroupInfoDrawer: failed to set/delete group image`,this.setState({resetPhotoPicker:!this.state.resetPhotoPicker})}))).finally((()=>{this.setState({pendingPhoto:!1})}))},this.handleParticipantClick=(e,t)=>{ve.default.equals((0,w.getMaybeMeUser)(),t.id)||(0,N.findChat)(t.id).then((e=>{f.default.openChatFromUnread(e).then((t=>{t&&f.default.focusChatTextInput(e)}))}))},this._menuEnabled=e=>{var t=this.props.groupMetadata.participants,a=t.get(e.id);return!!a&&(t.canPromote(a)||t.canRemove(a)||t.canVerifyIdentity(a))},this.handleDemoteAdmin=e=>{e.contact.pendingAction++,(0,Y.demoteParticipants)(this.props.chat,[e]).then((()=>{e.contact.pendingAction--})),this.setState({contextMenu:null})},this.handleParticipantMenu=(e,t)=>{var a=this.props.groupMetadata.participants,s=a.assertGet(t.id);if(this._menuEnabled(t)){var i=[];if(a.canPromote(s)){var l=this._confirmParticipantPromote.bind(this,s);i.push((0,Se.jsx)(j.default,{a8n:"mi-grp-promote-admin",action:l,children:F.default.t(1182)},"promote"))}if(a.canRemove(s)){var n=this._confirmParticipantRemove.bind(this,s);i.push((0,Se.jsx)(j.default,{a8n:"mi-grp-remove-participant",action:n,children:F.default.t(1187)},"remove"))}if(O.default.supportsFeature(O.default.F.GROUPS_V_3)&&a.canDemote(s)){var o=this.handleDemoteAdmin.bind(this,s);i.push((0,Se.jsx)(j.default,{a8n:"mi-grp-verify-identify",action:o,children:F.default.t(769)},"demote-admin"))}if(O.default.supportsFeature(O.default.F.MD_BACKEND)&&a.canVerifyIdentity(s)){var r=this._handleVerifyIdentity.bind(this,s);i.push((0,Se.jsx)(j.default,{a8n:"mi-grp-verify-identify",action:r,children:F.default.t(2157)},"verify-identity"))}this.setState({contextMenu:{contactId:t.id,menu:i,anchor:e.anchor,event:e.event}})}},this.closeContextMenu=()=>{this.setState({contextMenu:null})},this._confirmParticipantRemove=e=>{var t=this.handleParticipantRemove.bind(this,e,!0),a=F.default.t(693,{participant:e.contact.formattedName,subject:this.props.contact.name});f.default.openModal((0,Se.jsx)(m.default,{onOK:t,okText:F.default.t(1469),onCancel:()=>f.default.closeModal(),cancelText:F.default.t(1856),children:(0,Se.jsx)(T.default,{text:a})}))},this.handleParticipantRemove=(e,t)=>{e.contact.pendingAction++,(0,Y.removeParticipants)(this.props.chat,[e]).then((()=>{e.contact.pendingAction--})),t&&f.default.closeModal()},this._confirmParticipantPromote=e=>{var t=this.handleParticipantPromote.bind(this,e,!0),a=F.default.t(692,{participant:e.contact.formattedName,subject:this.props.contact.name});f.default.openModal((0,Se.jsx)(m.default,{onOK:t,okText:F.default.t(1182),onCancel:()=>f.default.closeModal(),cancelText:F.default.t(1856),children:(0,Se.jsx)(T.default,{text:a})}))},this.handleParticipantPromote=(e,t)=>{e.contact.pendingAction++,(0,Y.promoteParticipants)(this.props.chat,[e]).then((()=>{e.contact.pendingAction--})),t&&f.default.closeModal()},this._handleVerifyIdentity=e=>{this.props.onVerification&&this.props.onVerification(e.contact)},this._openAddGroupParticipantFlow=()=>{var{chat:e}=this.props;if(this.props.groupMetadata.participants.length>=se.default.maxParticipants){var t=F.default.t(117,{max:se.default.maxParticipants});f.default.openToast((0,Se.jsx)(fe.default,{msg:t,id:Ee}))}else{var a=O.default.supportsFeature(O.default.F.GROUPS_V_3)?(0,Se.jsx)(c.default,{chat:(0,de.unproxy)(e),pushTransition:"none",popTransition:"none"}):(0,Se.jsx)(u.default,{chat:(0,de.unproxy)(e),pushTransition:"none",popTransition:"none"});f.default.openModal(a,{transition:"modal-flow"})}},this._openParticpantSearch=()=>{f.default.openModal((0,Se.jsx)(R.default,{chat:(0,de.unproxy)(this.props.chat),onParticipantPromote:this.handleParticipantPromote,onParticipantRemove:this.handleParticipantRemove,onDemoteAdmin:this.handleDemoteAdmin}),{transition:"modal-flow"})},this.handleClose=()=>{this.props.onClose?this.props.onClose():this.props.uim.uie.requestDismiss()},this._handleExitOrDeleteGroup=()=>{f.default.deleteOrExitChat(this.props.chat)},this._handleGroupDescChange=e=>{this.setState({groupDesc:e})},this._handleSetSubject=function(){var e=(0,n.default)((function*(e){var a=(0,P.default)(e);a!==t.props.contact.name&&(yield(0,le.setGroupSubject)(t.props.chat,a).catch((0,o.filteredCatch)(b.Unmount,(()=>{}))).catch((()=>{__LOG__(3)`group_info_drawer:onSetSubject failed`})))}));return function(){return e.apply(this,arguments)}}(),this._handleSetDescription=()=>{var{chat:e,groupMetadata:t}=this.props;if(t.canSetDescription()){var a=this.state.groupDesc||"",s=a.match(/\r\n/gm)?"\r\n":"\n",i=new RegExp(`^(${s}{2,})([^\n])`,"gm");a=a.replace(i,`${s}$2`);var l=(0,P.default)(a||"");if(l===t.desc)return this.setState({groupDesc:l});this.setState({pendingDesc:!0}),(0,ie.setGroupDesc)(e,l).then((()=>{this.setState({groupDesc:t.desc,pendingDesc:!1})})).catch((0,o.filteredCatch)(b.Unmount,(()=>{}))).catch((()=>{__LOG__(3)`group_info_drawer:onSetDescription failed`,this.setState({groupDesc:this.props.groupMetadata.desc,pendingDesc:!1})}))}},this._handleCancelDesc=()=>{this.setState({groupDesc:this.props.groupMetadata.desc})},this.showEncryptionInfoPopup=()=>{f.default.openModal((0,Se.jsx)(E.default,{chatId:this.props.chat.id,e2eSubtype:"info_encrypted"}))},this._showSecurityInfoPopup=()=>{f.default.openModal((0,Se.jsx)(E.default,{chat:this.props.chat,chatId:this.props.chat.id,e2eSubtype:"info_encrypted"}))},this.handleShowMore=()=>{this.setState({participantListCollapsed:!1})},this._handleShowMorePendingParticipants=()=>{this.setState({pendingParticipantListCollapsed:!1})},this.renderItem=e=>{var{id:t}=e,a=this.props.groupMetadata.participants.get(t);if(!a)throw new y.UnknownDataError(e);var s=a.contact,i=!!this.state.contextMenu&&ve.default.equals(s.id,this.state.contextMenu.contactId);return(0,Se.jsx)(Z.default,{contact:s,participant:a,onClick:this.handleParticipantClick,contextEnabled:this._menuEnabled.bind(this,s),contextMenu:i,onContext:e=>this.handleParticipantMenu(e,s),showNotifyName:!0,waitIdle:!0},a.id.toString())},this.handleReportSpam=()=>{f.default.openModal((0,Se.jsx)(ee.default,{isGroupChat:!0,onReport:this.reportSpam,onReportExitClear:this.reportSpamExitClear,onCancel:()=>f.default.closeModal()}))},this.reportSpam=()=>{(0,ae.sendSpamReport)(this.props.chat,oe.SpamFlow.Group),f.default.closeModal()},this.reportSpamExitClear=()=>{(0,ae.sendSpamExitClear)(this.props.chat,oe.SpamFlow.Block),f.default.closeModal()},this._handleDescriptionReadMore=()=>{this.setState({descTruncated:!1})},this._showEditRestrictionInfo=()=>{f.default.openModal((0,Se.jsx)(m.default,{onOK:()=>f.default.closeModal(),okText:F.default.t(2029),children:F.default.t(1373)}))},this.revokeGrpV4Invite=e=>{f.default.openModal((0,Se.jsx)(m.default,{onOK:()=>{f.default.closeModal(),this.props.groupMetadata.revokeGroupV4AddInvite([e.id.toString()]).then((()=>{f.default.openToast((0,Se.jsx)(fe.default,{msg:F.default.t(1981),id:(0,fe.genId)()}))}))},okText:F.default.t(2088),onCancel:()=>f.default.closeModal(),cancelText:F.default.t(1856),children:(0,Se.jsx)(T.default,{text:F.default.t(1004,{participant:e.contact.formattedName})})}))},this._renderPendingParticipantItem=e=>{var{id:t}=e,a=this.props.groupMetadata.pendingParticipants.get(t);if(!a)throw new y.UnknownDataError(e);var s=a.contact;return(0,Se.jsx)(Z.default,{contact:s,participant:a,contextEnabled:()=>!0,contextMenu:!0,onContext:e=>this._handlePendingParticipantMenu(e,s),showNotifyName:!0,isPendingParticipant:!0,waitIdle:!0},a.id.toString())},this._handlePendingParticipantMenu=(e,t)=>{var a=this.props.groupMetadata.pendingParticipants.assertGet(t.id),s=[(0,Se.jsx)(j.default,{a8n:"mi-grp-promote-admin",action:this.revokeGrpV4Invite.bind(this,a),children:F.default.t(1513)},"promote")];this.setState({contextMenu:{contactId:t.id,menu:s,anchor:e.anchor,event:e.event}})};var{groupMetadata:{desc:a,participants:s,pendingParticipants:i},showFullGroupDescription:l}=this.props;this.state={pendingDesc:!1,pendingPhoto:!1,contextMenu:null,groupDraftSubject:null,groupDesc:a,descTruncated:!l&&!!(a&&a.length>30),participantListCollapsed:je(s),pendingParticipantListCollapsed:je(i),resetPhotoPicker:!1},this._uiActionEvent=new W.default.UiAction({uiActionType:W.default.UI_ACTION_TYPE.GROUP_INFO_OPEN,uiActionPreloaded:!0})}componentDidMount(){var e=this.props.groupMetadata;O.default.supportsFeature(O.default.F.MD_BACKEND)&&(0,Me.queryAndUpdateGroupMetadataById)(e.id),O.default.supportsFeature(O.default.F.GROUPS_V_4_JOIN_PERMISSION)&&e.queryGroupV4PendingInvite().then((()=>{this.setState({pendingParticipantListCollapsed:je(e.pendingParticipants)})})),this.props.listeners.add(e.participants,"add remove reset sort change:isAdmin change:isSuperAdmin",(()=>{this.forceUpdate()})),this.props.listeners.add(e.pendingParticipants,"add remove reset",(()=>{this.forceUpdate()})),this.props.listeners.add(e,"change:desc",(()=>{this._updateGroupDescOnModelChange()})),this.ensureParticipantsSorted(),O.default.supportsFeature(O.default.F.MD_BACKEND)&&this.props.scrollToParticipantList&&this._refContainer&&(0,_e.scrollIntoViewIfNeeded)(this._refContainer,!1);var t=this._uiActionEvent;if(t){var a=this.props.groupMetadata.deviceCountForLogging;null!=a&&(t.sizeBucket=(0,z.default)(a)),t.markUiActionT(),t.commit(),this._uiActionEvent=void 0}}componentDidUpdate(){this.ensureParticipantsSorted()}ensureParticipantsSorted(){this.props.groupMetadata.participants.ensureSorted(),this.props.groupMetadata.pendingParticipants.ensureSorted()}getData(){var e,t=[],a=[],s=this.props.groupMetadata.participants;s.forEach((s=>{s.contact.isMe?e=s:s.isAdmin?t.push(s):a.push(s)}));var i=[];return e&&i.push(e),i=i.concat(t,a),je(s)&&this.state.participantListCollapsed&&(i=i.slice(0,g.default.INFO_DRAWER_MAX_ROWS)),i.map((e=>({itemKey:e.id.toString(),id:e.id})))}_getPendingParticipantListData(){var e=this.props.groupMetadata.pendingParticipants,t=e.toArray();return je(e)&&this.state.pendingParticipantListCollapsed&&(t=t.slice(0,g.default.INFO_DRAWER_MAX_ROWS)),t.map((e=>({itemKey:e.id.toString(),id:e.id})))}_getTitle(){return se.default.productMediaAttachments?F.default.t(1175):F.default.t(1174)}render(){var e,t,a,s,i,l,n,{chat:o,groupMetadata:r}=this.props,u=(0,Se.jsx)(S.default,{children:(0,Se.jsx)(C.default,{a8nText:"li-delete-group",icon:(0,Se.jsx)(ce.default,{name:"exit",directional:!0}),theme:"list-aligned",color:"danger",onClick:this._handleExitOrDeleteGroup,children:o.isReadOnly?F.default.t(1897):F.default.t(1902)})});if(o.isReadOnly||(e=(0,Se.jsx)(S.default,{children:(0,Se.jsx)(C.default,{a8nText:"li-report-spam",theme:"list-aligned",color:"danger",icon:(0,Se.jsx)(ce.default,{name:"thumbs-down",directional:!0}),onClick:this.handleReportSpam,children:F.default.t(1484)})})),r.participants.canAdd()&&!r.support){var c=(0,Se.jsx)(te.default,{children:(0,Se.jsx)(ce.default,{name:"add-user",directional:!0})});t=(0,Se.jsx)(h.default,{image:c,theme:"drawer-list",primary:F.default.t(234),onClick:this._openAddGroupParticipantFlow})}if(r.participants.iAmAdmin()&&this.props.onGroupInviteLink&&!r.support){var f=(0,Se.jsx)(te.default,{children:(0,Se.jsx)(ce.default,{name:"link"})});a=(0,Se.jsx)(h.default,{image:f,theme:"drawer-list",primary:F.default.t(955),onClick:this.props.onGroupInviteLink})}if(je(r.participants)&&this.state.participantListCollapsed){var m=r.participants.length-g.default.INFO_DRAWER_MAX_ROWS,j=(0,Se.jsx)(te.default,{theme:"transparent",children:(0,Se.jsx)(ce.default,{name:"down"})});s=(0,Se.jsx)(h.default,{image:j,theme:"drawer-list",primary:F.default.t(992,{count:m,_plural:m}),onClick:this.handleShowMore})}if(je(r.pendingParticipants)&&this.state.pendingParticipantListCollapsed){var E=r.pendingParticipants.length-g.default.INFO_DRAWER_MAX_ROWS,T=(0,Se.jsx)(te.default,{theme:"transparent",children:(0,Se.jsx)(ce.default,{name:"down"})});i=(0,Se.jsx)(h.default,{image:T,theme:"drawer-list",primary:F.default.t(992,{count:E,_plural:E}),onClick:this._handleShowMorePendingParticipants})}if(r.pendingParticipants.length>0&&(l=(0,Se.jsx)(y.default,{flatListController:this._pendingParticipantFlatListController,direction:"vertical",forceConsistentRenderCount:!1,data:this._getPendingParticipantListData(),renderItem:this._renderPendingParticipantItem})),r.participants.iAmAdmin()&&O.default.supportsFeature(O.default.F.GROUPS_V_3)&&!r.support){var P=(0,Se.jsx)(ce.default,{className:D.default.chevron,name:"chevron-right-alt",directional:!0});n=(0,Se.jsx)(_.default,{onClick:this.props.onAdminSetting,side:P,children:(0,Se.jsx)(he.TextSpan,{theme:"title",children:F.default.t(990)})})}var b,N=(0,Se.jsx)(ce.default,{name:"search",className:D.default.iconSearch}),A=r.participants.length?(0,Se.jsxs)(S.default,{onRef:this._setRefContainer,a8nText:"section-participants",title:F.default.t(2031,{count:r.participants.length,_plural:r.participants.length}),titleOnClick:O.default.supportsFeature(O.default.F.GROUPS_V_3)?this._openParticpantSearch:void 0,subtitle:O.default.supportsFeature(O.default.F.GROUPS_V_3)?N:void 0,children:[t,a,(0,Se.jsx)(y.default,{flatListController:this._participantFlatListController,direction:"vertical",forceConsistentRenderCount:!1,data:this.getData(),renderItem:this.renderItem}),s]}):null;r.participants.iAmAdmin()&&r.pendingParticipants.length>0&&(b=(0,Se.jsxs)(S.default,{a8nText:"section-participants",title:F.default.t(996,{number:r.pendingParticipants.length}),children:[l,i]}));var w=null;if(this.props.onMediaGallery){var R=this.props.onMediaGallery,k=(0,Se.jsx)(ce.default,{className:D.default.chevron,name:"chevron-right-alt",directional:!0}),U=this._getTitle();w=(0,Se.jsx)(S.default,{a8nText:"section-media",title:U,titleOnClick:R,subtitle:k,theme:"padding",children:(0,Se.jsx)(H.default,{chat:(0,de.unproxy)(o),mediaMsgs:o.getMediaMsgs()})})}var W=this.props.contact.profilePicThumb,Y=$.default.GROUP,z=o.isReadOnly||!W.canDelete()&&!W.canSet()||o.isSupportGroup(),Z=(0,Se.jsx)("div",{className:D.default.avatar,children:(0,Se.jsx)(X.default,{type:Y,id:this.props.contact.id,attachToChat:!0,pending:this.state.pendingPhoto,startImage:this.props.profilePicThumb.imgFull,readOnly:z,onImageSet:this.handleImageSet},String(this.state.resetPhotoPicker))}),Q=null;this.props.groupMetadata.creation&&(Q=(0,Se.jsx)("div",{"data-a8n":d.default.key("group-created-time"),className:D.default.nameSecondary,children:(0,Se.jsx)(he.TextSpan,{theme:"muted",children:p.default.createdStr(this.props.groupMetadata.creation,this.props.chat.isSupportGroup())})}));var J=null;O.default.supportsFeature(O.default.F.LIVE_LOCATIONS)&&(J=(0,Se.jsx)(V.default,{chat:o,onClick:this.props.onLiveLocation}));var ee=o&&o.shouldShowEphemeralSetting()?(0,Se.jsx)(I.default,{onClick:this.props.onEphemeral,chat:o,groupMetadata:r}):null,ae=null;O.default.supportsFeature(O.default.F.MD_BACKEND)&&(ae=(0,Se.jsx)(xe.default,{onClick:this.showEncryptionInfoPopup,text:Ce.default.isGroupCallEnabled()?F.default.t(1935):F.default.t(1934)})),this.props.chat.isSupportGroup()&&(ae=(0,Se.jsx)(ue.default,{onClick:this._showSecurityInfoPopup}));var ie,le=o.mute.canMute()?(0,Se.jsx)(q.default,{chat:o,mute:o.mute,settings:ne.default}):null,oe=null;if(this.props.onStarred){var re=(0,Se.jsx)(ce.default,{className:D.default.chevron,name:"chevron-right-alt",directional:!0});oe=(0,Se.jsx)(_.default,{side:re,onClick:this.props.onStarred,children:(0,Se.jsx)(he.TextSpan,{theme:"title",children:F.default.t(581)})})}this.state.contextMenu&&(ie=(0,Se.jsx)(me.default,{displayName:"ChatContextMenu",escapable:!0,popable:!0,requestDismiss:this.closeContextMenu,children:(0,Se.jsx)(ge.default,{contextMenu:this.state.contextMenu})}));var fe,ve=null;if((le||oe||ae||ee)&&(ve=(0,Se.jsxs)(S.default,{children:[le,oe,ee,ae,n]})),O.default.supportsFeature(O.default.F.GROUPS_V_3)&&se.default.groupDescLength>0){var _e=this.state.groupDesc||"",Me={textLimit:this.state.descTruncated?g.default.GROUP_DESCRIPTION_INFO_PANEL_TRUNC_LENGTH:1/0,readMoreText:F.default.t(1467),onReadMore:this._handleDescriptionReadMore,formatters:this.props.chat.isTrusted()?L.Configuration.TrustedGroupDesc({links:G.findLinks(_e)}):L.Configuration.UntrustedGroupDesc()};fe=(0,Se.jsx)(S.default,{theme:"group-desc-padding",title:F.default.t(942),children:(0,Se.jsx)("div",{className:D.default.description,children:(0,Se.jsx)(pe.default,{a8n:"group-info-drawer-description-title-input",value:_e,emptyValuePlaceholder:F.default.t(232),renderEmojiTextInLockMode:Me,editable:r.canSetDescription(),pending:this.state.pendingDesc,showRemaining:!0,maxLength:se.default.groupDescLength,onChange:this._handleGroupDescChange,onSave:this._handleSetDescription,onCancel:this._handleCancelDesc,multiline:!0,editRestrictionInfo:r.restrict?this._showEditRestrictionInfo:void 0,supportsEmoji:!0,lockable:!0,lowProfile:!0,customStyleThemes:[pe.TextInputCustomStyleThemes.groupInfoName],theme:"small"})})})}return(0,Se.jsxs)(v.default,{theme:"striped",children:[(0,Se.jsx)(M.default,{title:F.default.t(1933),type:M.DRAWER_HEADER_TYPE.SMALL,onCancel:this.handleClose}),(0,Se.jsx)(x.default,{flatListControllers:[this._pendingParticipantFlatListController,this._participantFlatListController],children:(0,Se.jsxs)("section",{className:D.default.body,children:[null,(0,Se.jsxs)(S.default,{theme:"padding-large",children:[Z,r.support?(0,Se.jsx)(he.TextHeader,{className:D.default.title,level:"2",theme:"large",children:(0,Se.jsx)(K.GroupName,{chat:o,groupMetadata:r})}):(0,Se.jsx)(Pe,{subject:this.props.contact.name,onSave:this._handleSetSubject,textInputProps:{editable:r.canSetSubject(),editRestrictionInfo:r.restrict?this._showEditRestrictionInfo:void 0}}),Q,(0,Se.jsx)(B.default,{labels:o.labels})]}),fe,J,w,ve,null,A,b,u,e]})}),ie]},"contact-info-modal")}}function Pe(e){var[t,a]=(0,r.useState)(null),[s,i]=(0,r.useState)(!1),o=(0,r.useRef)(!1),d=function(){var s=(0,n.default)((function*(){if(!t||t===e.subject)return o.current=!1,void a(null);i(!0);try{yield e.onSave(t)}finally{o.current=!1,a(null),i(!1)}}));return function(){return s.apply(this,arguments)}}();return(0,Se.jsx)(pe.default,(0,l.default)({a8n:"group-info-drawer-subject-input",value:null!=t?t:e.subject,pending:s,showRemaining:!0,validate:e=>!(!e||!e.trim()),maxLength:se.default.maxSubject,onBeginEdit:()=>{o.current=!0},onChange:e=>{o.current&&a(e)},onSave:d,onError:()=>{f.default.openModal((0,Se.jsx)(m.default,{onOK:()=>f.default.closeModal(),okText:F.default.t(2029),children:F.default.t(145)}))},onCancel:()=>{o.current=!1,a(null)},supportsEmoji:!0,lockable:!0,lowProfile:!0,theme:"large",customStyleThemes:[pe.TextInputCustomStyleThemes.groupInfoName]},e.textInputProps))}Te.CONCERNS={chat:["isReadOnly","mute","id","pendingAction","liveLocation","labels"],groupMetadata:["id","desc","deviceCountForLogging","participants","pendingParticipants","creation","restrict","announce","support"],contact:["name","id","profilePicThumb","pendingAction"],profilePicThumb:["imgFull"]},Te.displayName="GroupInfoDrawer";var Ie=(0,k.default)((0,J.default)((0,U.default)((0,re.default)(Te,Te.CONCERNS))));t.default=Ie},92051:(e,t,a)=>{"use strict";var s=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(67294),l=s(a(91952)),n=s(a(18260)),o=s(a(47452)),r=a(62238),d=a(86723),u=s(a(12950)),c=s(a(2408)),h=s(a(71681)),p=s(a(91619)),f=s(a(63477)),m=s(a(68062)),g=s(a(69635)),v=a(85893);class _ extends i.Component{constructor(...e){super(...e),this.state={contextMenu:null},this.openChat=e=>{(0,r.findChat)(e).then((e=>{l.default.closeModal(),l.default.openChatFromUnread(e)}))},this.contextMenu=e=>!g.default.equals((0,d.getMaybeMeUser)(),e),this.handleParticipantMenu=(e,t)=>{var a=(0,p.default)(this.props.chat.groupMetadata,"this.props.chat.groupMetadata").participants,s=a.assertGet(t.id),i=[];if(a.canPromote(s)){var l=this.props.onParticipantPromote.bind(null,s,!1);i.push((0,v.jsx)(o.default,{a8n:"mi-grp-promote-admin",action:l,children:c.default.t(1182)},"promote"))}if(a.canRemove(s)){var n=this.props.onParticipantRemove.bind(null,s,!1);i.push((0,v.jsx)(o.default,{a8n:"mi-grp-remove-participant",action:n,children:c.default.t(1187)},"remove"))}if(u.default.supportsFeature(u.default.F.GROUPS_V_3)&&a.canDemote(s)){var r=this.props.onDemoteAdmin.bind(this,s);i.push((0,v.jsx)(o.default,{a8n:"mi-grp-verify-identify",action:r,children:c.default.t(769)},"demote-admin"))}g.default.equals((0,d.getMaybeMeUser)(),s.id)||i.push((0,v.jsx)(o.default,{action:this.openChat.bind(null,s.contact.id),children:c.default.t(1198,{author:s.contact.formattedName})},"message author")),this.setState({contextMenu:{contactId:t.id,menu:i,anchor:e.anchor,event:e.anchor?void 0:e}})},this.closeContextMenu=()=>{this.setState({contextMenu:null})},this.contextEnabled=()=>!1,this.cancel=()=>{l.default.closeModal()},this.isAdmin=e=>(0,p.default)(this.props.chat.groupMetadata,"this.props.chat.groupMetadata").participants.assertGet(e).isAdmin,this.contactFilter=e=>{var t=this.props.chat.groupMetadata;return!(null==t||!t.participants.get(e.id))}}componentDidMount(){var e,t=null===(e=this.props.chat.groupMetadata)||void 0===e?void 0:e.participants;null!=t&&this.props.listeners.add(t,"add remove reset",(()=>{this.forceUpdate()}))}render(){var e;return this.state.contextMenu&&(e=(0,v.jsx)(f.default,{displayName:"ChatContextMenu",escapable:!0,popable:!0,requestDismiss:this.closeContextMenu,children:(0,v.jsx)(m.default,{contextMenu:this.state.contextMenu})})),(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(n.default,{title:c.default.t(1530),filter:this.contactFilter,onCancel:this.cancel,openContextOnClick:!0,contextEnabled:this.contextEnabled,contextMenu:this.contextMenu,onContext:this.handleParticipantMenu,showNotifyName:!0,listenForAdminChange:!0,participantCollection:(0,p.default)(this.props.chat.groupMetadata,"this.props.chat.groupMetadata").participants}),e]})}}_.displayName="GroupParticipantSearch";var x=(0,h.default)(_);t.default=x},32827:(e,t,a)=>{"use strict";var s=a(20862),i=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=i(a(29521)),n=a(67294),o=a(82754),r=i(a(91952)),d=i(a(55454)),u=i(a(17747)),c=i(a(92787)),h=i(a(9042)),p=s(a(55588)),f=i(a(25061)),m=a(86723),g=i(a(12950)),v=i(a(33019)),_=i(a(89128)),x=i(a(52087)),C=i(a(2408)),M=i(a(71681)),S=a(97449),j=s(a(57774)),E=i(a(65565)),T=i(a(79485)),P=a(97504),I=i(a(69635)),b=a(85893),N=({isRestricted:e,onClick:t})=>(0,b.jsxs)(c.default,{onClick:t,multiline:!0,children:[(0,b.jsx)("div",{className:v.default.header,children:(0,b.jsx)(P.TextSpan,{theme:"title",children:C.default.t(982)})}),(0,b.jsx)(P.TextDiv,{theme:"muted",children:e?C.default.t(988):C.default.t(981)})]}),y=({isAnnouncement:e,onClick:t})=>(0,b.jsxs)(c.default,{onClick:t,multiline:!0,children:[(0,b.jsx)("div",{className:v.default.header,children:(0,b.jsx)(P.TextSpan,{theme:"title",children:C.default.t(989)})}),(0,b.jsx)(P.TextDiv,{theme:"muted",children:e?C.default.t(988):C.default.t(981)})]}),A=({isNoFrequentlyForwarded:e,onClick:t})=>{var a=E.default.hfmStringChanges?C.default.t(986):C.default.t(985);return(0,b.jsxs)(c.default,{onClick:t,multiline:!0,children:[(0,b.jsx)("div",{className:v.default.header,children:(0,b.jsx)(P.TextSpan,{theme:"title",children:a})}),(0,b.jsx)(P.TextDiv,{theme:"muted",children:e?C.default.t(987):C.default.t(984)})]})};class w extends n.Component{constructor(...e){super(...e),this._openSettingModal=e=>{var{chat:t,groupMetadata:a}=this.props;r.default.openModal((0,b.jsx)(_.default,{settingType:e,chat:t,groupMetadata:a}),{transition:"modal",uim:this.props.uim})},this._openAnnouncementSettingModal=()=>{this._openSettingModal(d.default.GROUP_SETTING_TYPE.ANNOUNCEMENT)},this._openRestrictedSettingModal=()=>{this._openSettingModal(d.default.GROUP_SETTING_TYPE.RESTRICT)},this._openNoFrequentlyForwardedSettingModal=()=>{this._openSettingModal(d.default.GROUP_SETTING_TYPE.NO_FREQUENTLY_FORWARDED)},this._getCurrentAdmins=()=>{var{groupMetadata:e}=this.props;return e.participants.filter((e=>e.isAdmin)).map((e=>e.contact))},this._filterParticipants=e=>{var{groupMetadata:t}=this.props;return!!t.participants.get(e.id)},this.isDisabled=e=>{var{groupMetadata:t}=this.props;return I.default.equals(e,t.owner)||(0,m.getMaybeMeUser)().equals(e)},this._openManageAdminModal=()=>{r.default.openModal((0,b.jsx)(j.default,{onConfirm:this._updateAdmins,getInitialItems:this._getCurrentAdmins,isDisabled:this.isDisabled,isSelected:this.isDisabled,filter:this._filterParticipants,title:C.default.t(1142),useShortName:!0,useAllContacts:!0,listType:j.ListType.PARTICIPANT_MANAGE_MODAL,singleSelectionFooterType:o.FooterType.CONFIRM,multipleSelectionFooterType:o.FooterType.CONFIRM}))},this._updateAdmins=e=>{var{chat:t,groupMetadata:a}=this.props,s=a.participants,i=s.filter((e=>e.isAdmin)),n=(0,l.default)(e,i,((e,t)=>e.id.equals(t.id))).map((e=>s.assertGet(e.id))),o=(0,l.default)(i,e,((e,t)=>e.id.equals(t.id)));n.length>0&&(n.forEach((e=>{e.contact.pendingAction++})),(0,S.promoteParticipants)(t,n).finally((()=>{n.forEach((e=>{e.contact.pendingAction--}))}))),o.length>0&&(o.forEach((e=>{e.contact.pendingAction++})),(0,S.demoteParticipants)(t,o).finally((()=>{o.forEach((e=>{e.contact.pendingAction--}))}))),r.default.closeModal()}}render(){var{groupMetadata:e}=this.props;return(0,b.jsxs)(u.default,{theme:"striped",children:[(0,b.jsx)(p.default,{title:C.default.t(990),type:p.DRAWER_HEADER_TYPE.SMALL,onBack:this.props.onClose}),(0,b.jsxs)(h.default,{children:[(0,b.jsx)(f.default,{animation:!1,children:(0,b.jsx)(N,{onClick:this._openRestrictedSettingModal,isRestricted:e.restrict})}),g.default.isEphemeralAllowGroupMembersEnabled()?(0,b.jsx)("div",{className:v.default.restrictText,children:(0,b.jsx)(P.TextSpan,{theme:"muted",children:C.default.t(790)})}):null,(0,b.jsxs)(f.default,{animation:!1,children:[(0,b.jsx)(y,{onClick:this._openAnnouncementSettingModal,isAnnouncement:e.announce}),g.default.supportsFeature(g.default.F.FREQUENTLY_FORWARDED_SETTING)?(0,b.jsx)(A,{onClick:this._openNoFrequentlyForwardedSettingModal,isNoFrequentlyForwarded:e.noFrequentlyForwarded}):null]}),(0,b.jsx)(f.default,{animation:!1,children:(0,b.jsx)(c.default,{onClick:this._openManageAdminModal,multiline:!0,children:(0,b.jsx)("div",{className:v.default.header,children:(0,b.jsx)(P.TextSpan,{theme:"title",children:C.default.t(1142)})})})})]})]})}}w.CONCERNS={chat:["id"],groupMetadata:["restrict","announce","noFrequentlyForwarded","participants","owner"]},w.displayName="GroupAdminSetting";var O=(0,x.default)((0,M.default)((0,T.default)(w,w.CONCERNS)));t.default=O},89128:(e,t,a)=>{"use strict";var s=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var{settingType:t}=e,a=(0,c.default)(e.chat,["id"]),s=(0,c.default)(e.groupMetadata,["restrict","announce","noFrequentlyForwarded"]),p=(0,i.useMemo)((()=>{switch(t){case l.default.GROUP_SETTING_TYPE.ANNOUNCEMENT:case l.default.GROUP_SETTING_TYPE.RESTRICT:return[{label:o.default.t(981),value:0},{label:o.default.t(988),value:1}];case l.default.GROUP_SETTING_TYPE.NO_FREQUENTLY_FORWARDED:return[{label:o.default.t(984),value:0},{label:o.default.t(987),value:1}];default:return[]}}),[t]),f=(0,i.useMemo)((()=>{var{restrict:e,announce:a,noFrequentlyForwarded:i}=s;switch(t){case l.default.GROUP_SETTING_TYPE.ANNOUNCEMENT:return a?1:0;case l.default.GROUP_SETTING_TYPE.RESTRICT:return e?1:0;case l.default.GROUP_SETTING_TYPE.NO_FREQUENTLY_FORWARDED:return i?1:0;default:return 0}}),[t,s]),m=(0,i.useMemo)((()=>{switch(t){case l.default.GROUP_SETTING_TYPE.ANNOUNCEMENT:return o.default.t(989);case l.default.GROUP_SETTING_TYPE.RESTRICT:return o.default.t(982);case l.default.GROUP_SETTING_TYPE.NO_FREQUENTLY_FORWARDED:return r.default.hfmStringChanges?o.default.t(986):o.default.t(985);default:return""}}),[t]),g=(0,i.useMemo)((()=>t===l.default.GROUP_SETTING_TYPE.RESTRICT&&n.default.isEphemeralAllowGroupMembersEnabled()?o.default.t(790):null),[t]);return(0,h.jsx)(u.default,{options:p,initialValue:f,title:m,onSelect:e=>{e!==f&&(0,d.setGroupProperty)(a,t,e).catch((()=>()=>{}))},explanation:g})};var i=a(67294),l=s(a(55454)),n=s(a(12950)),o=s(a(2408)),r=s(a(65565)),d=a(73533),u=s(a(31033)),c=s(a(76006)),h=a(85893)},38775:(e,t,a)=>{"use strict";var s=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(67294),l=s(a(25061)),n=s(a(2408)),o=s(a(71681)),r=s(a(31104)),d=a(19407),u=s(a(16211)),c=s(a(79485)),h=a(15298),p=s(a(2966)),f=a(97504),m=a(85893);class g extends i.Component{constructor(e){super(e),this._updateParticipants=()=>{this.setState({participants:this.getParticipants(this.props.chat)})},this.state={participants:this.getParticipants(e.chat)}}componentDidMount(){var{chat:e}=this.props;e.liveLocationQueried||r.default.getActive(e.id.toString()).then((()=>{e.liveLocationQueried=!0})).catch((()=>{})),this.props.listeners.add((0,h.unproxy)(e),"change:liveLocation",(()=>{var{liveLocation:t}=e;t&&(this._removeParticipantListener(t),this._addParticipantListener(t),this._updateParticipants())}));var{liveLocation:t}=e;t&&this._addParticipantListener(t)}_addParticipantListener(e){this.props.listeners.add(e.participants,"add remove",this._updateParticipants)}_removeParticipantListener(e){this.props.listeners.remove(e.participants,"add remove",this._updateParticipants)}getParticipants(e){var{liveLocation:t}=e;return t?t.participants.toArray():[]}getText(){var e,t,{chat:a}=this.props,{participants:s}=this.state,i=0;if(s.forEach((a=>{a.isMe?e=!0:(t||(t=a.contact),i++)})),a.isGroup)return e?1===s.length?n.default.t(1114):n.default.t(1113,{count:i,_plural:i}):n.default.t(1110,{count:i,_plural:i});if(e){if(1===s.length)return n.default.t(1114);if(t)return n.default.t(1112,{name:t.formattedShortNameWithNonBreakingSpaces})}else if(t)return n.default.t(1109,{name:t.formattedShortNameWithNonBreakingSpaces});return""}render(){var{onClick:e}=this.props;if(!this.state.participants.length)return null;var t=(0,m.jsx)(p.default,{name:(0,d.liveLocationIcon)(!0)});return(0,m.jsx)(l.default,{a8nText:"section-live-location",theme:"padding",title:n.default.t(1117),titleOnClick:e,children:(0,m.jsx)(u.default,{side:t,onClick:e,children:(0,m.jsx)(f.TextSpan,{theme:"title",children:this.getText()})})})}}g.CONCERNS={chat:["id","isGroup","liveLocation","liveLocationQueried"]},g.displayName="LiveLocationRow";var v=(0,o.default)((0,c.default)(g,g.CONCERNS));t.default=v},65389:(e,t,a)=>{"use strict";var s=a(20862),i=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.TABS=void 0;var l=i(a(52628)),n=i(a(94184)),o=a(67294),r=a(6467),d=i(a(88654)),u=i(a(17747)),c=i(a(9042)),h=s(a(55588)),p=i(a(2408)),f=i(a(46144)),m=i(a(52963)),g=i(a(27356)),v=i(a(74343)),_=i(a(66329)),x=i(a(16505)),C=i(a(65565)),M=i(a(63477)),S=i(a(82669)),j=a(85893),E={MEDIA:"media",DOCS:"docs",LINKS:"links",PRODUCTS:"products"};t.TABS=E;class T extends o.Component{constructor(){super(...arguments),this.state={selected:this.props.initialTab,direction:null,selectable:!1},this.handleSelectMessages=()=>{this.state.selectable||this.setState({selectable:!0})},this.handleCancelSelection=()=>{this.state.selectable&&(this.selectedMessages.unsetAll(),this.setState({selectable:!1}))},this.handleMessageSelect=(e,t)=>{this.handleSelectMessages(),this.selectedMessages.setVal(e,t),0===this.selectedMessages.getSelected().length&&this.handleCancelSelection()},this.selectedMessages=new _.default([],(e=>e.id.toString()))}_handleSelectTab(e){var t=(0,l.default)(E).indexOf(this.state.selected),a=(0,l.default)(E).indexOf(e);t!==a&&this.selectedMessages.unsetAll();var s=a>t?"right":"left";this.setState({selected:e,direction:s,selectable:!1})}_getTabs(){var e=[{tab:E.MEDIA,title:p.default.t(1148)},{tab:E.DOCS,title:p.default.t(770)},{tab:E.LINKS,title:p.default.t(1088)}];C.default.productMediaAttachments&&e.push({tab:E.PRODUCTS,title:p.default.t(1459)});var t=e.map((e=>{var t=(0,n.default)(g.default.menuItem,{[g.default.active]:this.state.selected===e.tab});return(0,j.jsx)("button",{className:t,onClick:this._handleSelectTab.bind(this,e.tab),title:e.title,children:e.title},e.tab)})),a=(0,n.default)(g.default.menuTabsLists,C.default.productMediaAttachments?g.default.fourTabs:g.default.threeTabs);return(0,j.jsx)("div",{className:a,"data-active-tab":this.state.selected,children:t})}_getContent(){var e,t=this.props.chat;switch(this.state.selected){case E.MEDIA:e=(0,j.jsx)(m.default,{chat:t,mediaMsgs:t.getMediaMsgs(),selectable:this.state.selectable,onMessageSelect:this.handleMessageSelect,selectedMessages:this.selectedMessages,fullCollection:!0});break;case E.LINKS:e=(0,j.jsx)(f.default,{chat:t,linkMsgs:t.getLinkMsgs(),selectable:this.state.selectable,onMessageSelect:this.handleMessageSelect,selectedMessages:this.selectedMessages});break;case E.DOCS:e=(0,j.jsx)(d.default,{chat:t,docMsgs:t.getDocMsgs(),selectable:this.state.selectable,onMessageSelect:this.handleMessageSelect,selectedMessages:this.selectedMessages});break;case E.PRODUCTS:e=(0,j.jsx)(x.default,{chat:t,productMsgs:t.getProductMsgs(),selectable:this.state.selectable,onMessageSelect:this.handleMessageSelect,selectedMessages:this.selectedMessages,onProductDetail:this.props.onProductDetail,setScrollOffset:this.props.setProductsScrollOffset,scrollOffset:this.props.productsScrollOffset})}return e}render(){var e=this.props.chat,t=this._getTabs(),a=this._getContent(),s=[E.MEDIA,E.DOCS].includes(this.state.selected),i=this.state.selectable?(0,j.jsx)(M.default,{displayName:"MediaMultiSelect",escapable:!0,requestDismiss:this.handleCancelSelection,children:(0,j.jsx)(v.default,{chat:e,noSortOnForward:!0,theme:"mediaGallery",toastPosition:r.ToastPosition.RIGHT,downloadButton:s,selectedMessages:this.selectedMessages,onCancel:this.handleCancelSelection})}):null,l="right"===this.state.direction?"slide-forward":"slide-back";return(0,j.jsxs)(u.default,{theme:"gallery",children:[(0,j.jsx)(h.default,{title:" ",onBack:this.props.onBack,type:h.DRAWER_HEADER_TYPE.MULTI_MEDIA_GALLERY}),i,t,(0,j.jsx)(c.default,{"data-list-scroll-container":!0,children:(0,j.jsx)(S.default,{transitionName:l,className:g.default.column,children:(0,j.jsx)("div",{className:g.default.multimediaGallery,children:(0,j.jsx)("div",{className:g.default.column,children:a})},this.state.selected)})})]})}}t.default=T,T.defaultProps={initialTab:E.MEDIA,productsScrollOffset:0},T.displayName="MediaGalleryDrawer"},45418:(e,t,a)=>{"use strict";var s=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=(0,d.default)(e.mediaData,["mediaStage","renderableUrl"]);return(0,u.jsx)(r.default,{mediaData:t,placeholderRenderer:p,children:e=>(0,u.jsx)(h,{url:e})})};var i=s(a(94184)),l=s(a(37781)),n=s(a(2408)),o=s(a(8752)),r=s(a(80747)),d=s(a(76006)),u=a(85893),c=e=>{e.stopPropagation()};function h({url:e}){return(0,u.jsx)(l.default,{url:e,className:o.default.mediaViewerAudio,onClick:c,autoPlay:!0,controls:!0,children:n.default.t(268)})}function p(){return(0,u.jsx)("div",{className:(0,i.default)(o.default.imageAudio,o.default.mediaViewerPlaceholder),onClick:c})}},85128:(e,t,a)=>{"use strict";var s=a(20862),i=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=a(67294),n=i(a(55092)),o=i(a(25142)),r=i(a(91952)),d=i(a(88419)),u=s(a(9492)),c=i(a(47452)),h=i(a(85051)),p=i(a(2408)),f=i(a(71681)),m=i(a(42784)),g=a(90672),v=a(47941),_=i(a(79465)),x=a(84254),C=a(48224),M=i(a(79485)),S=a(15298),j=i(a(2966)),E=i(a(43711)),T=a(85893);class P extends l.PureComponent{constructor(...e){super(...e),this._refCloseBtn=(0,l.createRef)(),this._getMenuBtns=()=>this.props.msg.isViewOnce?this._getViewOnceMediaMenuBtns():this.props.msgIndexInAlbum>=0?this._getAlbumMediaMenuBtns():this._getNonAlbumMediaMenuBtns(),this._getViewOnceMediaMenuBtns=()=>[(0,T.jsx)(v.MenuBarItem,{icon:(0,T.jsx)(j.default,{name:"view-once",className:m.default.voIcon}),title:p.default.t(53),onClick:this.props.onViewOnceInfoClick},"btnViewOnceInfo"),this._getDropdownMenuBarItem()],this._getNonAlbumMediaMenuBtns=()=>{var{msg:e}=this.props;return[(0,T.jsx)(v.MenuBarItem,{icon:(0,T.jsx)(j.default,{name:"bubble"}),title:p.default.t(935),onClick:this.props.onGoToMsgClick},"btnGoToMsg"),e.canStar()?this._getStarMenuBarItem():null,e.canForward()?this._getForwardMenuBarItem():null,(0,T.jsx)(v.MenuBarItem,{icon:(0,T.jsx)(j.default,{name:"download"}),title:p.default.t(1852),disabled:!this._isMediaDownloadable(),onClick:this.props.onDownloadClick},"btnDownload")].filter(Boolean)},this._getAlbumMediaMenuBtns=()=>{var{msg:e}=this.props;return[e.canReply()?(0,T.jsx)(v.MenuBarItem,{icon:(0,T.jsx)(j.default,{name:"reply"}),title:p.default.t(1474),onClick:this.props.onReplyClick},"btnReply"):null,e.canStar()?this._getStarMenuBarItem():null,(0,T.jsx)(v.MenuBarItem,{icon:(0,T.jsx)(j.default,{name:"delete"}),title:p.default.t(1896),onClick:this.props.onDeleteClick},"btnDelete"),e.canForward()?this._getForwardMenuBarItem():null,this._getDropdownMenuBarItem()].filter(Boolean)},this._getStarMenuBarItem=()=>{var e,t,a,{msg:s}=this.props;return s.star?(e=this.props.onUnstarClick,t="unstar-btn",a=p.default.t(1674)):(e=this.props.onStarClick,t="star-btn",a=p.default.t(1591)),(0,T.jsx)(v.MenuBarItem,{icon:(0,T.jsx)(j.default,{name:t}),title:a,onClick:e},t)},this._getForwardMenuBarItem=()=>(0,T.jsx)(v.MenuBarItem,{icon:(0,T.jsx)(j.default,{name:"forward"}),title:p.default.t(895),onClick:this.props.openForwardFlow},"btnForward"),this.handlePrivateReplyMessage=()=>{var e=(0,S.unproxy)(this.props.msg);(0,_.default)(e)},this._getDropdownMenuBarItem=()=>{var{msg:e}=this.props,t=[];return(e.canPrivateReply()||e.canPrivateReplyInRestrictedGrp())&&t.push((0,T.jsx)(c.default,{a8n:"mi-msg-reply",action:this.handlePrivateReplyMessage,children:p.default.t(1419)},"private_reply")),e.isViewOnce?t.push((0,T.jsx)(c.default,{action:this._handleDropdownViewOnceReportSpam,children:this._getViewOnceReportTitle()},"dropdownMsgInfo")):(e.isSentByMe&&t.push((0,T.jsx)(c.default,{action:this.props.onMsgInfoClick,children:p.default.t(1202)},"dropdownMsgInfo")),t.push((0,T.jsx)(c.default,{action:this.props.onGoToMsgClick,children:p.default.t(935)},"dropdownGoToMsg"),(0,T.jsx)(c.default,{action:this.props.onDownloadClick,disabled:!this._isMediaDownloadable(),children:p.default.t(1852)},"dropdownDownload"))),(0,T.jsx)(v.MenuBarItem,{icon:(0,T.jsx)(j.default,{name:"menu"}),title:p.default.t(1194),children:(0,T.jsx)(u.default,{type:"dropdown_menu",flipOnRTL:!0,dirX:u.DirX.LEFT,children:t},"MediaPanelHeaderDropdown")},"btnMenu")},this._isMediaDownloadable=()=>{var{mediaData:e,msg:t}=this.props;return!t.isViewOnce&&(!!e.renderableUrl||e.mediaStage===g.MEDIA_DATA_STAGE.RESOLVED)},this._handleDropdownViewOnceReportSpam=()=>{r.default.openModal((0,T.jsx)(E.default,{isBusiness:this.props.msg.senderObj.isBusiness,isGroup:this.props.msg.chat.isGroup,onReport:this._handleReport,onCancel:()=>r.default.closeModal(),title:this._getViewOnceReportTitle()}))},this._handleReport=e=>{var{chat:t}=this.props.msg;t&&(e?t.isGroup?(0,x.sendSpamExitClear)(t,C.SpamFlow.MediaViewer):(0,x.sendSpamBlockClear)(t,C.SpamFlow.MediaViewer):(0,x.sendSpamReport)(t,C.SpamFlow.MediaViewer)),r.default.closeModal()}}_getViewOnceReportTitle(){var{msg:e}=this.props;return e.chat.isGroup?p.default.t(1484):p.default.t(1483,{contactInfo:e.senderObj.displayName})}componentDidMount(){null!=this._refCloseBtn.current&&this.props.listeners.add(this._refCloseBtn.current,"animationend",(()=>{this.props.onHightlightCloseEnd()}))}render(){var e=this.props.msg,t=e.displayName(!0,!0);return e.isGroupMsg&&(t+=" @ "+e.chat.title()),(0,T.jsxs)("div",{className:m.default.mediaPanelHeader,children:[(0,T.jsx)("div",{className:m.default.info,children:(0,T.jsx)(n.default,{idle:!0,image:(0,T.jsx)(d.default,{id:e.sender,size:40}),primary:(0,T.jsx)(h.default,{ellipsify:!0,text:t}),secondary:o.default.relativeDateAndTimeStr(e.t),theme:"media"})}),(0,T.jsx)("div",{className:m.default.mediaPanelTools,children:(0,T.jsxs)(v.MenuBar,{theme:"strong",children:[this._getMenuBtns(),(0,T.jsx)(v.MenuBarItem,{a8nText:"btn-close",icon:(0,T.jsx)(j.default,{className:this.props.isHighlightClose?m.default.highlightClose:null,containerRef:this._refCloseBtn,name:"x-viewer"}),title:p.default.t(1867),onClick:this.props.onClose})]},"media-panel-header")})]})}}P.CONCERNS={msg:["star","isGroupMsg","chat","type","isGif","isViewOnce","sender","senderObj","t","isSentByMe"],mediaData:["filehash","mediaStage","renderableUrl"]},P.displayName="MediaPanelHeader";var I=(0,f.default)((0,M.default)(P,P.CONCERNS));t.default=I},71090:(e,t,a)=>{"use strict";var s=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(71730),l=a(67294),n=s(a(20396)),o=s(a(36083)),r=a(90246),d=a(50472),u=s(a(2408)),c=s(a(92660)),h=a(90672),p=s(a(4231)),f=s(a(96419)),m=s(a(90904)),g=s(a(79485)),v=s(a(92018)),_=a(85893);class x extends l.PureComponent{constructor(...e){super(...e),this.state={played:!1,size:{width:0,height:0},isFullscreenMode:!1},this._setRefContainer=e=>{this.refContainer=e},this.stopPropagation=e=>{e.stopPropagation()},this._handleFullscreenToggle=e=>{this.setState({isFullscreenMode:e})}}static getDerivedStateFromProps(e){var{mediaData:t}=e;return(t.mediaStage===h.MEDIA_DATA_STAGE.RESOLVED||t.streamable&&t.isStreamable())&&(0,i.isNonZeroNumber)(t.fullWidth)&&(0,i.isNonZeroNumber)(t.fullHeight)?{size:x.getSize(t)}:null}static getSize(e){if(e.isGif){return e.fullWidth>=330?{width:e.fullWidth,height:e.fullHeight}:{width:330,height:330*e.fullHeight/e.fullWidth}}return e.fullWidth>=d.MIN_WIDTH?{width:e.fullWidth,height:e.fullHeight}:{width:d.MIN_WIDTH,height:e.fullHeight}}componentDidMount(){this.props.mediaData.isStreamable()||this.props.msg.downloadMedia({downloadEvenIfExpensive:!0,rmrReason:p.default.WEBC_RMR_REASON_CODE.MEDIA_VIEWER,isUserInitiated:!0})}componentWillUnmount(){this.props.msg.mediaObject&&this.props.msg.cancelDownload()}render(){var e,{msg:t,mediaData:a}=this.props,s=a.isGif,i=a.mediaStage===h.MEDIA_DATA_STAGE.RESOLVED||a.streamable&&a.isStreamable();if(i=i||t.isForcingRMR()){var l,d,p=u.default.t(1721);return!this.state.isFullscreenMode&&t&&t.interactiveAnnotations&&t.interactiveAnnotations.length>0&&(l=(0,_.jsx)(n.default,{annotations:t.interactiveAnnotations})),d=s?(0,_.jsxs)("div",{className:c.default.mediaViewerImg,ref:this._setRefContainer,children:[(0,_.jsx)(v.default,{src:a.renderableUrl,onClick:this.stopPropagation,autoPlay:!0,loop:!0,children:p}),l]}):(0,_.jsx)("div",{ref:this._setRefContainer,className:c.default.mediaViewerImg,onClick:this.stopPropagation,children:(0,_.jsx)(f.default,{msg:t,mediaData:a,startTime:this.props.startTime,onClose:this.props.onClose,onError:()=>{},onFullscreenToggle:this._handleFullscreenToggle,autoPlay:this.props.autoPlay,type:r.PLAYER_TYPE.MEDIA_VIEWER,overlays:l,noPip:t.isViewOnce})}),(0,_.jsx)(m.default,{type:"scaleDown",position:"relative",objectPosition:"relative",size:this.state.size,onObjectLoad:this.props.onLoad,children:d})}return(0,_.jsx)(m.default,{type:"scaleDown",position:"relative",objectPosition:"relative",size:{width:this.props.mediaData.fullWidth,height:this.props.mediaData.fullHeight},children:(0,_.jsx)(o.default,{altText:null!==(e=t.caption)&&void 0!==e?e:"",mediaData:a})})}}x.CONCERNS={mediaData:["mediaStage","fullWidth","fullHeight","isGif","isViewOnce","preview","renderableUrl","streamable"]},x.defaultProps={startTime:0},x.displayName="MediaVideo";var C=(0,g.default)(x,x.CONCERNS);t.default=class extends C{getContainerElement(){return this.getComponent().refContainer}}},61169:(e,t,a)=>{"use strict";var s=a(20862),i=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=i(a(23493)),n=i(a(94184)),o=a(8139),r=a(67294),d=(i(a(56720)),s(a(93972))),u=i(a(91952)),c=i(a(91547)),h=i(a(75940)),p=i(a(55454)),f=i(a(7235)),m=i(a(85051)),g=i(a(97227)),v=i(a(47193)),_=i(a(85033)),x=a(86723),C=i(a(96889)),M=i(a(39e3)),S=a(49895),j=i(a(2408)),E=a(64850),T=i(a(45418)),P=i(a(49694)),I=i(a(41552)),b=i(a(85128)),N=i(a(53608)),y=a(90672),A=i(a(71090)),w=i(a(7674)),O=i(a(85398)),D=a(3132),R=i(a(79485)),k=a(15298),L=a(97504),B=a(74289),F=i(a(63477)),G=i(a(89135)),U=i(a(45285)),V=a(85893),H={captionReadMoreBtn:{position:"lhggkp7q",end:"h223g3sc",bottom:"jxacihee",paddingTop:"ppypbuwx",paddingEnd:"f9ovudaz",paddingBottom:"przvwfww",paddingStart:"nu34rnf1",backgroundColor:"idmi9oma",borderTopStartRadius:"ho9ovbg7",borderTopEndRadius:"tcg15ap9",borderBottomEndRadius:"c5wy1lv0",borderBottomStartRadius:"bqysl6j9",boxShadow:"a95fzlb5"},captionReadMoreBtnExpanded:{visibility:"kojwoqec"},captionReadMoreBtnZoomed:{visibility:"kqpkm0zi",opacity:"lxctpz5v"}};function W(e){null==e||e.stopPropagation()}function Y(e){var t=e.chat;t.composeQuotedMsg=e,u.default.focusChatTextInput(t)}class q extends r.PureComponent{constructor(e){super(e),this._setRefMediaImage=e=>{this._refMediaImage=e},this._setRefMediaVideo=e=>{this._refMediaVideo=e},this._setRefHotKeys=e=>{this._refHotKeys=e},this._handleViewOnceInfoClick=()=>{this._showViewOnceNux()},this._showViewOnceNux=()=>{var{mediaData:e}=this.props,t=(0,V.jsx)(O.default,{isPhoto:e.type===P.default.TYPE.IMAGE,onOkClick:()=>{u.default.closeModal()}});u.default.openModal(t)},this._handleImageLoad=e=>{this.props.onImageLoad&&this.props.onImageLoad();var t=this.state.zoomElement;t&&e&&this.props.isAnimatingIn&&e instanceof HTMLElement&&(this._zoomed||(this._zoomed=!0,this.animateZoom(t,e)))},this.animateZoom=(e,t)=>{var a,s=t.getBoundingClientRect(),i=e.getBoundingClientRect(),l=i.top-s.top,n=i.left-s.left,o=e.clientWidth/t.clientWidth;l-=(t.clientHeight-e.clientHeight)/2,n-=(t.clientWidth-e.clientWidth)/2,(0,U.default)(t,{opacity:[1,0],translateX:[0,n],translateY:[0,l],scale:[1,o]},{duration:p.default.MEDIA_VIEWER.ANIMATION_DURATION,easing:[.1,.82,.25,1]});var r=null===(a=this._refCaption)||void 0===a?void 0:a.getContainerElement();r&&(0,U.default)(r,{opacity:[1,0]},{duration:p.default.MEDIA_VIEWER.ANIMATION_DURATION})},this.openForwardFlow=e=>{e.stopPropagation();var{msg:t}=this.props;t.isUnsentMedia?u.default.openModal((0,V.jsx)(h.default,{title:j.default.t(879),onOK:()=>u.default.closeModal(),okText:j.default.t(2029),children:j.default.t(876)})):u.default.openModal((0,V.jsx)(_.default,{msgs:[(0,k.unproxy)(t)]}),{transition:"modal-flow"})},this._handleReplyClick=()=>{this._handleClose(),(0,o.delayMs)(p.default.MEDIA_VIEWER.CLOSE_ANIMATION_DURATION).then(Y.bind(null,(0,k.unproxy)(this.props.msg)))},this._handleDeleteClick=()=>{var{msg:e}=this.props;u.default.openModal((0,V.jsx)(f.default,{chat:e.chat,msgList:[(0,k.unproxy)(e)],deletePrompt:!0,revokePrompt:e.canRevoke()}))},this._handleMsgInfoClick=()=>{this._handleClose(),(0,o.delayMs)(p.default.MEDIA_VIEWER.CLOSE_ANIMATION_DURATION+250).then(u.default.msgInfoDrawer.bind(u.default,(0,k.unproxy)(this.props.msg)))},this._handleImgZoomIn=e=>{var t=this._refMediaImage;e&&t&&(this._listenToMouseMove=t.heightOverflow>0||t.widthOverflow>0),this.setState({imgZoomed:e}),this.props.onImgZoomIn(e)},this._handleZoomOut=e=>{this._updateZoomPosition.cancel();var t=this._refMediaImage;t&&this.state.imgZoomed&&t.onImageClick(e)},this._handleMouseMove=e=>{this._updateZoomPosition(e.pageX,e.pageY)},this._updateZoomPosition=(0,l.default)(((e,t)=>{if(!this.state.annotationTooltipDisplayed){var a=this._refMediaImage;if(a){var s=a.getInsideContainer();if(s&&s instanceof HTMLElement){var i=a.getOutsideContainer();if(i&&i instanceof HTMLElement){var{translateX:l,translateY:n}=a.getTranslatePosition(i,e,t);(0,U.default)(s,"stop"),(0,U.default)(s,{translateX:l,translateY:n,scale:p.default.MEDIA_VIEWER.ZOOM_IN_FACTOR},{duration:0})}}}}})),this._handleKeyboardZoom=e=>{if(!this.props.isAnimatingIn){this._updateZoomPosition.cancel();var t=this._refMediaImage;null!=t&&t.onImageKeyboardZoom(e)}},this._handleDownloadClick=e=>{e.stopPropagation(),g.default.initDownload((0,k.unproxy)(this.props.msg))},this._handleStarClick=e=>{e.stopPropagation();var{msg:t}=this.props;u.default.sendStarMsgs(t.chat,[(0,k.unproxy)(t)])},this._handleUnstarClick=e=>{e.stopPropagation();var{msg:t}=this.props;u.default.sendUnstarMsgs(t.chat,[(0,k.unproxy)(t)])},this._handleGoToMsgClick=e=>{e.stopPropagation(),this._handleClose(),u.default.existsDrawerRight((e=>{e&&2===c.default.column&&u.default.closeDrawerRight()}));var{msg:t}=this.props,a=t.chat.getSearchContext((0,k.unproxy)(t));u.default.openChatAt(t.chat,a).then((e=>{e&&u.default.focusChatTextInput(t.chat)}))},this._handleClose=()=>{if(!this._closing){this._closing=!0,(0,B.isFunction)(this.props.onExitAnimation)&&this.props.onExitAnimation();var e,t=this.props.getZoomNode&&this.props.getZoomNode(this.props.msg.id);if(!t)return this.props.onBack();if(this.props.mediaData.type===P.default.TYPE.IMAGE&&this._refMediaImage?e=this._refMediaImage.getInsideContainer():this.props.mediaData.isGif&&this._refMediaVideo&&(e=this._refMediaVideo.getContainerElement()),!e)return this.props.onBack();var a,s=e,i=e.getBoundingClientRect(),l=t.getBoundingClientRect(),n=l.top-i.top,o=l.left-i.left,r=t.clientWidth/s.clientWidth;n-=(s.clientHeight-t.clientHeight)/2,o-=(s.clientWidth-t.clientWidth)/2,(0,U.default)(e,{translateX:[o,0],translateY:[n,0],scale:[r,1]},{duration:p.default.MEDIA_VIEWER.CLOSE_ANIMATION_DURATION,easing:[.1,.82,.25,1]}).then((()=>{this.props.onBack()}));var d=null===(a=this._refCaption)||void 0===a?void 0:a.getContainerElement();d&&(0,U.default)(d,{opacity:[0,1]},{duration:p.default.MEDIA_VIEWER.CLOSE_ANIMATION_DURATION,easing:[.1,.82,.25,1]})}},this._handleClickToCloseBlocked=()=>{this.setState({isHighlightClose:!0})},this._handleHighlightCloseEnd=()=>{this.setState({isHighlightClose:!1})},this._handleAnnotationTooltipDisplay=()=>this.setState({annotationTooltipDisplayed:!0}),this._handleAnnotationTooltipDismiss=()=>this.setState({annotationTooltipDisplayed:!1}),this._handleCaptionClick=e=>{e.stopPropagation(),this.setState((e=>({isCaptionExpanded:!e.isCaptionExpanded})))},this._zoomed=!1,this._closing=!1,this._listenToMouseMove=!1,this._shouldShowViewOnceNux=e.msg.isViewOnce&&(0,x.shouldShowNUX)(p.default.NUX.EPHEMERAL_VIEW_ONCE_RECEIVER);var t=e.mediaData.mediaStage===y.MEDIA_DATA_STAGE.RESOLVED&&e.isAnimatingIn&&e.getZoomNode?e.getZoomNode(e.msg.id):null;this.state={zoomElement:t,imgZoomed:!1,annotationTooltipDisplayed:!1,isCaptionVisible:!e.isAnimatingIn,isCaptionExpanded:!1,isHighlightClose:!1}}componentDidMount(){var{msg:e}=this.props;e.isViewOnce&&(0,E.canMarkPlayed)(e)&&(0,E.markPlayed)(e),this._shouldShowViewOnceNux&&this._showViewOnceNux(),v.default.focus(this._refHotKeys)}getSnapshotBeforeUpdate(){var e,t=null===(e=this._refCaption)||void 0===e?void 0:e.getContainerElement();return null!=t&&null==this._captionExpandable&&(this._captionExpandable=t.scrollHeight>t.clientHeight),null}componentDidUpdate(e){var{isCaptionVisible:t}=this.state,{isAnimatingIn:a}=this.props;a||t||!e.isAnimatingIn||this.setState({isCaptionVisible:!0})}componentWillUnmount(){this._updateZoomPosition.cancel()}render(){var e,t,a,s,i,l,{msg:o,mediaData:r}=this.props;switch(r.type){case P.default.TYPE.IMAGE:i=(0,V.jsx)(I.default,{msg:o,mediaData:r,onLoad:this._handleImageLoad,onImgZoomIn:this._handleImgZoomIn,onAnnotationTooltipDisplay:this._handleAnnotationTooltipDisplay,onAnnotationTooltipDismiss:this._handleAnnotationTooltipDismiss,preventDownload:o.isViewOnce,ref:this._setRefMediaImage},o.id.toString());break;case P.default.TYPE.VIDEO:i=(0,V.jsx)(A.default,{autoPlay:!this._shouldShowViewOnceNux,msg:o,mediaData:r,onLoad:r.isGif?this._handleImageLoad:null,startTime:this.props.startTime,onClose:this._handleClose,ref:this._setRefMediaVideo},o.id.toString());break;case P.default.TYPE.AUDIO:i=(0,V.jsx)(T.default,{mediaData:r},o.id.toString());break;default:__LOG__(4,void 0,new Error,!0)`type: ${r.type}`,SEND_LOGS("MediaViewerModal: unexpected media type")}var u=this.props.msgIndexInAlbum>=0&&this.props.albumSize>=0;if(o.caption||u){var c;if(u){var h={number:this.props.msgIndexInAlbum+1,totalNumber:this.props.albumSize};c=j.default.t(1357,h)}var p=S.Configuration.Conversation({mentions:o.mentionMap(),links:o.getLinks(),trusted:!0}),f=!this.state.isCaptionVisible&&(r.isGif||r.type===P.default.TYPE.IMAGE);l=(0,V.jsxs)(V.Fragment,{children:[(0,V.jsxs)("p",{className:(0,n.default)(w.default.captionWrapper,this._captionExpandable&&w.default.captionWrapperExpandable),onClick:this._captionExpandable?this._handleCaptionClick:void 0,title:this._captionExpandable?j.default.t(1467):void 0,"aria-hidden":this.state.isCaptionExpanded||void 0,children:[(0,V.jsx)(m.default,{className:(0,n.default)(w.default.mediaCaption,{[w.default.captionHidden]:f,[w.default.expanded]:this.state.isCaptionExpanded}),formatters:p,ref:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((e=>{this._refCaption=e})),text:o.caption||c}),this._captionExpandable&&(0,V.jsx)(G.default,{xstyle:[H.captionReadMoreBtn,this.state.isCaptionExpanded&&H.captionReadMoreBtnExpanded,this.state.imgZoomed&&H.captionReadMoreBtnZoomed],onClick:this._handleCaptionClick,children:(0,V.jsx)(L.TextSpan,{children:j.default.t(1467)})})]}),this.state.isCaptionExpanded&&(0,V.jsx)("p",{className:(0,n.default)(w.default.captionWrapper,w.default.captionWrapperExpandable,w.default.captionExpanded),onClick:this._handleCaptionClick,children:(0,V.jsx)(m.default,{className:(0,n.default)(w.default.mediaCaption,w.default.mediaCaptionExpanded),formatters:p,text:o.caption})})]})}var g=(0,n.default)(w.default.media,{[w.default.mediaWithCaption]:!!l}),v=(0,n.default)("overlay",w.default.mediaViewer,{[w.default.viewOnce]:o.isViewOnce,[w.default.mediaViewerAnimate]:this.props.isAnimatingIn,[w.default.cursorZoomOut]:this.state.imgZoomed}),_=this.state.imgZoomed&&this._listenToMouseMove?this._handleMouseMove:null,x=this.state.imgZoomed?this._handleZoomOut:null,E=this.state.imgZoomed?null:this._handleClose;null!=E&&o.isViewOnce&&(E=this._handleClickToCloseBlocked);var y=!o.isViewOnce;return(0,V.jsx)(F.default,{displayName:"MediaViewer",escapable:!0,requestDismiss:this._handleClose,children:(0,V.jsx)(M.default,{handlers:{space:this._handleKeyboardZoom},onRef:this._setRefHotKeys,children:(0,V.jsxs)("div",{className:v,"data-animate-media-viewer":!0,onClick:x,onMouseMove:_,children:[(0,V.jsx)(b.default,{isHighlightClose:this.state.isHighlightClose,msg:o,mediaData:r,onClose:this._handleClose,onGoToMsgClick:this._handleGoToMsgClick,onHightlightCloseEnd:this._handleHighlightCloseEnd,onReplyClick:this._handleReplyClick,onUnstarClick:this._handleUnstarClick,onStarClick:this._handleStarClick,onDeleteClick:this._handleDeleteClick,openForwardFlow:this.openForwardFlow,onDownloadClick:this._handleDownloadClick,onMsgInfoClick:this._handleMsgInfoClick,onViewOnceInfoClick:this._handleViewOnceInfoClick,msgIndexInAlbum:this.props.msgIndexInAlbum}),(0,V.jsxs)("div",{className:w.default.mediaContent,onClick:E,children:[y&&(0,V.jsx)("div",{className:(0,n.default)(w.default.btnMediaPrev),children:(0,V.jsx)(d.default,{type:d.ButtonType.Prev,onClick:null!==(e=this.props.onPrev)&&void 0!==e?e:W,onKeyDown:null!==(t=this.props.onPrev)&&void 0!==t?t:W,disabled:!this.props.onPrev||this.state.imgZoomed,theme:D.RoundTheme.Default})}),(0,V.jsxs)("div",{className:g,children:[(0,V.jsx)(N.default,{msg:o,mediaData:r}),i,(0,V.jsx)(C.default.Provider,{value:o.chat.groupMetadata,children:l})]}),y&&(0,V.jsx)("div",{className:(0,n.default)(w.default.btnMediaNext),children:(0,V.jsx)(d.default,{type:d.ButtonType.Next,onClick:null!==(a=this.props.onNext)&&void 0!==a?a:W,onKeyDown:null!==(s=this.props.onNext)&&void 0!==s?s:W,disabled:!this.props.onNext||this.state.imgZoomed,theme:D.RoundTheme.Default})})]})]})})})}}q.CONCERNS={msg:["id","star","isUnsentMedia","isViewOnce","chat","caption","interactiveAnnotations"],mediaData:["mediaStage","type","isGif"]},q.displayName="MediaViewerModal";var K=(0,R.default)(q,q.CONCERNS);t.default=K},84223:(e,t,a)=>{"use strict";var s=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(a(23493)),l=a(67294),n=s(a(12950)),o=s(a(22024)),r=s(a(1393)),d=s(a(77030)),u=s(a(46714)),c=a(85893);class h extends l.Component{constructor(e){super(e),this._setThumbRef=(e,t)=>{this._thumbRefs[t]=e},this._isPreviewPreferred=e=>{var t=this._thumbRefs[e];if(!t)return!1;var a=t.getBoundingClientRect(),s=(a.left+a.right)/2;return!(s>-1*window.innerWidth&&s<2*window.innerWidth)},this._getMsgIdToPreferPreview=()=>{var e=new Map;return this.props.mediaMsgs.forEach((t=>{var a=t.id.toString();e.set(a,this._isPreviewPreferred(a))})),e},this.onScroll=e=>{this.handleScroll(),this.props.onScroll(e)},this._handleScroll=()=>{var e=this._getMsgIdToPreferPreview();(0,o.default)(this.state.msgIdToPreferPreview,e)||this.setState({msgIdToPreferPreview:e})},this.getThumbs=()=>{var{highlightedMsgIds:e}=this.props,t=e&&e.size>0&&e.has(this.props.activeMsg.id.toString()),a=[];return this.props.mediaMsgs.forEach((s=>{if(null!=s.mediaData){var i=t&&e&&!e.has(s.id.toString())?"viewerFlowTransparent":"viewerFlow",l=n.default.supportsFeature(n.default.F.GROUP_CONVERSATIONS_MEDIA_TOOLTIPS)&&s.isGroupMsg;a.push((0,c.jsx)(r.default,{theme:i,active:s===this.props.activeMsg,msg:s,containerRef:e=>{this._setThumbRef(e,s.id.toString()),s===this.props.activeMsg&&this.props.onSetActiveThumb(e)},onClick:()=>{this.props.onSelectThumb(s)},preferPreview:!!this.state.msgIdToPreferPreview.get(s.id.toString()),showTooltip:l},`media-${s.id.id}`))}else{var o=this.props.activeMsg;__LOG__(3,!0)`MediaViewerFlow: attempted to render a msg without mediaData: ${JSON.stringify({type:s.type,isMedia:s.isMedia,startMsgType:o.type,startMsgIsMedia:o.isMedia})}`}})),a.push((0,c.jsx)("div",{className:d.default.mediaThumb,children:this.props.mediaMsgs.queryMediaAfter?(0,c.jsx)(u.default,{stroke:6,size:24}):null},"spinner-right")),a.unshift((0,c.jsx)("div",{className:d.default.mediaThumb,children:this.props.mediaMsgs.queryMediaBefore?(0,c.jsx)(u.default,{stroke:6,size:24}):null},"spinner-left")),a.push((0,c.jsx)("div",{className:d.default.thumbPadding},"padding-right")),a.unshift((0,c.jsx)("div",{className:d.default.thumbPadding},"padding-left")),a},this._thumbRefs={},this.handleScroll=(0,i.default)(this._handleScroll,100),this.state={msgIdToPreferPreview:this._getMsgIdToPreferPreview()}}componentWillUnmount(){this.handleScroll.cancel()}render(){var e=this.getThumbs();return(0,c.jsx)("div",{className:d.default.thumbsContainer,ref:this.props.setRefThumbsContainer,children:(0,c.jsx)("div",{className:d.default.scrollContainer,dir:"ltr",children:(0,c.jsx)("div",{onScroll:this.onScroll,className:d.default.viewerThumbs,ref:this.props.setRefThumbs,children:e})})})}}t.default=h,h.displayName="MediaViewerThumbList"},85398:(e,t,a)=>{"use strict";var s=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var{onOkClick:t}=e;return(0,i.useEffect)((()=>{(0,u.setNUX)(n.default.NUX.EPHEMERAL_VIEW_ONCE_RECEIVER,{views:1,maxViews:1})}),[]),(0,m.jsx)(l.default,{onOK:t,cancelText:c.default.t(1084),onCancel:()=>{(0,o.openExternalLink)((0,r.getViewOnceFaqUrl)())},children:(0,m.jsxs)(d.FlexColumn,{children:[(0,m.jsx)(d.FlexItem,{xstyle:g.graphic,align:"center",children:(0,m.jsx)(p.default,{name:"view-once-sender-nux",width:195,height:177})}),(0,m.jsx)(f.TextHeader,{className:h.default.text,theme:"popup-title",children:e.isPhoto?c.default.t(1735):c.default.t(1738)}),(0,m.jsx)(f.TextParagraph,{className:h.default.text,children:e.isPhoto?c.default.t(1734):c.default.t(1737)})]})})};var i=a(67294),l=(s(a(56720)),s(a(75940))),n=s(a(55454)),o=a(4919),r=a(57092),d=a(63290),u=a(86723),c=s(a(2408)),h=s(a(81623)),p=s(a(2966)),f=a(97504),m=a(85893),g={graphic:{marginBottom:"t4zgqcuo"}}},31033:(e,t,a)=>{"use strict";var s=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(67294),l=s(a(91952)),n=s(a(75940)),o=s(a(2408)),r=s(a(89732)),d=a(97504),u=a(85893);class c extends i.PureComponent{constructor(e){super(e),this._handleOK=()=>{var{selectedValue:e}=this.state;null!=e&&this.props.onSelect(e),this.closeModal()},this._handleChange=e=>{var{target:t}=e;t instanceof HTMLInputElement&&this.setState({selectedValue:parseInt(t.value,10)})},this.closeModal=()=>{l.default.closeModal()},this.state={selectedValue:e.initialValue}}render(){var{options:e,explanation:t}=this.props,a=e.map((({value:e,label:t})=>(0,u.jsx)("li",{children:(0,u.jsxs)("label",{className:r.default.label,children:[(0,u.jsx)("input",{type:"radio",className:r.default.input,value:String(e),checked:e===this.state.selectedValue,onChange:this._handleChange}),t]})},`setting-${e}`)));return(0,u.jsxs)(n.default,{title:this.props.title,okText:o.default.t(686),onOK:this._handleOK,onCancel:this.closeModal,children:[t?(0,u.jsx)(d.TextDiv,{theme:"muted",className:r.default.explanation,children:t}):null,(0,u.jsx)("form",{children:(0,u.jsx)("ol",{children:a})})]})}}t.default=c,c.displayName="SettingsPopup"},38880:(e,t,a)=>{"use strict";var s=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function({contact:e}){var{verifiedLevel:t,verifiedName:a}=(0,_.default)(e,["verifiedLevel","verifiedName"]),s=(0,p.getBusinessFaqUrl)(),C=!d.default.isSMB;(0,i.useEffect)((()=>{C&&new m.default.BannerEvent({bannerType:m.default.BANNER_TYPES.CROSS_SELL_PROFILE_INTERSTITIAL,bannerOperation:m.default.BANNER_OPERATIONS.SHOWN}).commit()}),[C]);var M=t===u.default.VERIFIED_LEVEL.HIGH?f.default.t(2099,{businessName:a}):f.default.t(2098);return(0,x.jsxs)(r.default,{title:f.default.t(2101),onOK:()=>{o.default.closeModal(),C&&new m.default.BannerEvent({bannerType:m.default.BANNER_TYPES.CROSS_SELL_PROFILE_INTERSTITIAL,bannerOperation:m.default.BANNER_OPERATIONS.DISMISS}).commit()},okText:f.default.t(2029),children:[(0,x.jsx)(c.default,{text:M})," ",(0,x.jsx)(n.default,{href:s,onClick:e=>{e.preventDefault(),o.default.closeModal(),setTimeout((()=>(0,h.openExternalLink)(s)),10)},children:f.default.t(1084)}),C&&(0,x.jsx)("div",{className:l.default.footerNote,children:(0,x.jsxs)(v.TextSpan,{theme:"muted",size:"13",children:[f.default.t(2102),(0,x.jsx)("br",{}),(0,x.jsx)(n.default,{onClick:e=>{e.preventDefault(),o.default.closeModal(),new m.default.BannerEvent({bannerType:m.default.BANNER_TYPES.CROSS_SELL_PROFILE_INTERSTITIAL,bannerOperation:m.default.BANNER_OPERATIONS.CLICK}).commit(),setTimeout((()=>o.default.openModal((0,x.jsx)(g.default,{}))),200)},className:l.default.getTheAppLink,children:f.default.t(2100)})]})})]})};var i=a(67294),l=s(a(96089)),n=s(a(44683)),o=s(a(91952)),r=s(a(75940)),d=s(a(9322)),u=s(a(55454)),c=s(a(85051)),h=a(4919),p=a(57092),f=s(a(2408)),m=s(a(4231)),g=s(a(57844)),v=a(97504),_=s(a(76006)),x=a(85893)},57844:(e,t,a)=>{"use strict";var s=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return(0,h.jsxs)(n.default,{title:d.default.t(2105),onOK:()=>{new u.default.BannerEvent({bannerType:u.default.BANNER_TYPES.CROSS_SELL_PROFILE_INTERSTITIAL,bannerOperation:u.default.BANNER_OPERATIONS.DISMISS}).commit(),l.default.closeModal()},okText:d.default.t(1867),children:[(0,h.jsx)(c.default,{}),(0,h.jsx)("p",{children:(0,h.jsx)(o.default,{text:d.default.t(2103)})}),(0,h.jsx)("br",{}),(0,h.jsxs)("p",{children:[(0,h.jsx)(o.default,{text:d.default.t(2104)})," ",(0,h.jsx)(i.default,{href:p,onClick:e=>{e.preventDefault(),l.default.closeModal(),setTimeout((()=>(0,r.openExternalLink)(p)),10)},children:d.default.t(1084)})]})]})},t.WHATSAPP_BUSINESS_URL=void 0;var i=s(a(44683)),l=s(a(91952)),n=s(a(75940)),o=s(a(85051)),r=a(4919),d=s(a(2408)),u=s(a(4231)),c=s(a(67370)),h=a(85893),p="https://www.whatsapp.com/business";t.WHATSAPP_BUSINESS_URL=p},67370:(e,t,a)=>{"use strict";var s=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){var e=(0,l.useRef)(null),t=(0,l.useRef)(null),{theme:a}=(0,l.useContext)(d.default),s="dark"===a;return(0,l.useEffect)((()=>(null!=e.current&&(t.current=new o.default(e.current,{text:"https://www.whatsapp.com/business/download",colorDark:"#122e31",colorLight:"#ffffff",width:n.default.QR_EDGE/2,height:n.default.QR_EDGE/2,typeNumber:4,correctLevel:o.default.CorrectLevel.H})),()=>{null!=t.current&&(t.current.clear(),t.current=null,e.current=null)})),[s]),(0,u.jsx)("div",{className:r.default.wrapper,children:(0,u.jsx)("div",{ref:e,className:(0,i.default)(r.default.code,{[r.default.codeDarkMode]:s}),children:(0,u.jsx)(c,{theme:a})})})};var i=s(a(94184)),l=a(67294),n=s(a(55454)),o=s(a(31516)),r=s(a(90487)),d=s(a(13038)),u=a(85893);function c(){return(0,u.jsx)("div",{className:r.default.codeLogo,children:(0,u.jsx)("svg",{width:"100%",viewBox:"0 0 50 50",xmlns:"http://www.w3.org/2000/svg",children:(0,u.jsx)("path",{d:"M42.6776 42.6779C37.9558 47.3997 31.6777 50.0001 24.9999 50.0001C21.0047 50.0001 17.0541 49.0389 13.5244 47.2141L0.601068 49.3339L2.72832 36.3645C0.941278 32.8647 0 28.9525 0 25.0001C0 18.3223 2.60042 12.0443 7.32229 7.32237C12.0442 2.6005 18.3221 0 24.9999 0C31.6777 0 37.9558 2.6005 42.6776 7.32237C47.3995 12.0443 50 18.3223 50 25.0001C50 31.678 47.3995 37.9558 42.6776 42.6779ZM24.9999 4.33778C13.6067 4.33778 4.33772 13.607 4.33772 25.0001C4.33772 28.4792 5.21935 31.9192 6.8868 34.9487L7.24853 35.6054L5.85915 44.0756L14.2959 42.6918L14.9565 43.0601C18.0107 44.7624 21.4837 45.6622 24.9999 45.6622C36.3932 45.6622 45.6622 36.3933 45.6622 25.0001C45.6622 13.607 36.3932 4.33778 24.9999 4.33778ZM31.1133 24.3614C32.4522 24.9804 34.1536 26.3725 34.1208 29.3117C34.0749 33.4266 31.2191 35.6542 27.2744 35.6542H19.4594H18.3042C17.5079 35.6542 16.8645 35.0053 16.8713 34.2092L17.0344 15.0573C17.041 14.2714 17.6794 13.6377 18.4652 13.6366L27.1493 13.6256C31.4651 13.6256 33.9598 16.039 33.9177 19.8134C33.8903 22.2579 32.2484 23.8355 31.1133 24.3614ZM26.766 17.4622H21.3643L21.3076 22.5361H26.7093C28.5347 22.5361 29.5672 21.5152 29.584 19.9992C29.6009 18.4831 28.5915 17.4622 26.766 17.4622ZM26.9444 26.4035H21.2643L21.2038 31.8178H26.884C28.8333 31.8178 29.7752 30.5802 29.792 29.0952C29.8085 27.6101 28.8939 26.4035 26.9444 26.4035Z",fill:"currentColor"})})})}},24348:(e,t,a)=>{"use strict";var s=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var{onClick:t}=e;return(0,d.jsxs)(i.default,{onClick:t,side:(0,d.jsx)(o.default,{name:"lock",className:l.default.icon}),multiline:!0,children:[(0,d.jsx)("div",{className:l.default.header,children:(0,d.jsx)(r.TextSpan,{theme:"title",children:n.default.t(1632)})}),(0,d.jsx)(r.TextDiv,{theme:"muted",children:n.default.t(1631)})]})};var i=s(a(92787)),l=s(a(13474)),n=s(a(2408)),o=s(a(2966)),r=a(97504),d=a(85893)},43711:(e,t,a)=>{"use strict";var s=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var[t,a]=(0,i.useState)(!1);return(0,c.jsxs)(n.default,{onOK:function(){e.onReport(t)},okText:r.default.t(1475),onCancel:e.onCancel,title:e.title,children:[(0,c.jsx)(d.TextParagraph,{className:u.default.section,color:"muted",children:e.isGroup?r.default.t(1496):r.default.t(1495)}),(0,c.jsx)(d.TextParagraph,{className:u.default.section,color:"muted",children:e.isGroup?r.default.t(1499):e.isBusiness?r.default.t(1498):r.default.t(1497)}),(0,c.jsxs)(o.FlexRow,{align:"center",justify:"start",children:[(0,c.jsx)(l.default,{onChange:()=>a((e=>!e)),checked:t,id:"menu-icon-report-spam"}),(0,c.jsx)(d.TextLabel,{className:u.default.checkboxLabel,htmlFor:"menu-icon-report-spam",color:"muted",children:e.isGroup?r.default.t(1902):e.isBusiness?r.default.t(314):r.default.t(316)})]})]})};var i=a(67294),l=s(a(33287)),n=s(a(75940)),o=a(63290),r=s(a(2408)),d=a(97504),u=s(a(73662)),c=a(85893)},22024:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var a;if(e.size!==t.size)return!1;for(var[s,i]of e)if((a=t.get(s))!==i||void 0===a&&!t.has(s))return!1;return!0}},35346:(e,t,a)=>{"use strict";a.r(t),t.default={header:"_2J_Rg",chevronIcon:"_3grvf",ephemeralIcon:"_36-dp"}},4949:(e,t,a)=>{"use strict";a.r(t),t.default={msg:"_3YiZC",text:"RmpKn",bubble:"_2z0p1",author:"XntIB",hasSuspiciousLinks:"_3bU-2",hasAuthor:"_2cFHu",suspiciousLabel:"_2tYTz"}},49866:(e,t,a)=>{"use strict";a.r(t),t.default={container:"_2G0i8"}},20720:(e,t,a)=>{"use strict";a.r(t),t.default={mediaCanvas:"_7xcOR",shade:"_3t-Dc",iconStar:"qSojz",shadeTop:"kt7p8",canvasBody:"_2pnVj",canvasSelected:"xRcWX",mediaSelect:"_2GKAW",canvasComponent:"_3_8JL",canvasSecondRow:"_2j2vv",viewerFlow:"q0PwG",active:"_2IToT",viewerFlowTransparent:"_1Brnl"}},8829:(e,t,a)=>{"use strict";a.r(t),t.default={container:"_3QXeb",selected:"_11w_h"}},31318:(e,t,a)=>{"use strict";a.r(t),t.default={iconType:"_1Dw5O"}},79011:(e,t,a)=>{"use strict";a.r(t),t.default={wrapper:"_11tTr"}},82338:(e,t,a)=>{"use strict";a.r(t),t.default={nuxContainer:"_2MN2b",flatListContainer:"_3P67r",btnClose:"_1rNId",nuxHeader:"_1fDhw",nuxContent:"_3CSup",nuxIcon:"wZmgd",nuxText:"_23F3I"}},31777:(e,t,a)=>{"use strict";a.r(t),t.default={body:"_2j9Df",photo:"_3wMpK",chevron:"_2o-Pp"}},92447:(e,t,a)=>{"use strict";a.r(t),t.default={businessAccount:"_3Wx0w",businessTitleText:"_3hEvS"}},89628:(e,t,a)=>{"use strict";a.r(t),t.default={actionsRow:"_2kAwJ",actionButton:"_2iUPD",actionLabel:"_2oaCg",actionDisabled:"_3GWG6"}},33596:(e,t,a)=>{"use strict";a.r(t),t.default={businessHoursRow:"_1E5MZ",firstRow:"_3qGzL",businessHoursDay:"CY6kT",businessHoursHours:"_1ujuU",dayIsOpen:"_3nRm3",businessHoursChevron:"_36zDQ",flipSvg:"_3-kwz"}},88274:(e,t,a)=>{"use strict";a.r(t),t.default={section:"_2yoR2",description:"_2COKu",map:"_2FPvQ"}},23653:(e,t,a)=>{"use strict";a.r(t),t.default={wrapper:"_-68fg",title:"_1FhZx",subtitle:"_3YwTO",verifiedText:"_25I1z",icon:"_2ie2d"}},15525:(e,t,a)=>{"use strict";a.r(t),t.default={contactBusinessInfo:"_2Qmz_",contactBusinessInfoSpinner:"_3UShD",dataRow:"_2GoqA",businessHoursRow:"T9W1E",businessHoursDay:"_1Qi8h",businessHoursHours:"_265N_",businessHoursChevron:"_235Hk",flipSvg:"sdLP_",dataRowIcon:"uj7Hl",dataRowText:"_1y-yA",businessTitleText:"_20eRR",businessMarker:"-ouoI",verifiedLabel:"_3WNAO",businessMap:"_34r-I",address:"HXkG_",link:"_3AYvg",infoIcon:"_3hzkD"}},58293:(e,t,a)=>{"use strict";a.r(t),t.default={body:"_2YEfx",avatar:"_2ALnh",nameSecondary:"_3l1_9",screenName:"_2UVLe",businessVname:"_1viks",icon:"_37Tl1",titleAbout:"Xt0cg",chevron:"_1Fclf"}},78857:(e,t,a)=>{"use strict";a.r(t),t.default={info:"_2U0ik",categories:"_2oH_b",noPaddingBottom:"_3W57d"}},32201:(e,t,a)=>{"use strict";a.r(t),t.default={open:"_25r2J",closed:"_5Xa1z",openStatus:"_1i7Je"}},13474:(e,t,a)=>{"use strict";a.r(t),t.default={header:"_2zyOo",icon:"_4aKqp"}},13648:(e,t,a)=>{"use strict";a.r(t),t.default={body:"_f0hJ",avatar:"_3zYOj",description:"_8xDKI",nameSecondary:"_3IaWU",chevron:"_1kh2B",iconSearch:"PLicp",title:"_1VJFC",dogfoodingGroupBannerInternalOnly:"_2j99K"}},33019:(e,t,a)=>{"use strict";a.r(t),t.default={header:"_3AwRc",restrictText:"_1fFgT"}},27356:(e,t,a)=>{"use strict";a.r(t),t.default={multimediaGallery:"_3M644",column:"_3nvje",menuItem:"OJuvv",active:"_KRg9",menuTabsLists:"_3CC5A",threeTabs:"_1KRHF",fourTabs:"rLX29"}},8752:(e,t,a)=>{"use strict";a.r(t),t.default={mediaViewerPlaceholder:"nehFG",imageAudio:"_2OreO",mediaViewerAudio:"_1alR8"}},77030:(e,t,a)=>{"use strict";a.r(t),t.default={thumbsContainer:"_1XWMx",scrollContainer:"_1MhXb",viewerThumbs:"_1FS45",mediaThumb:"_52crR",thumbPadding:"_1833d"}},81623:(e,t,a)=>{"use strict";a.r(t),t.default={text:"_1iOjC"}},89732:(e,t,a)=>{"use strict";a.r(t),t.default={label:"QzWWL",input:"_1LOWN",explanation:"_37J_Y"}},96089:(e,t,a)=>{"use strict";a.r(t),t.default={footerNote:"_1chRk",getTheAppLink:"_3t8G3"}},90487:(e,t,a)=>{"use strict";a.r(t),t.default={wrapper:"_2Cwyq",code:"_3LMFv",codeDarkMode:"_3-nnq",codeLogo:"_3wVH-"}},73662:(e,t,a)=>{"use strict";a.r(t),t.default={section:"_2ppks",checkboxLabel:"l2_nh"}}}]);