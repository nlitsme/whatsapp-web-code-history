/*! Copyright (c) 2023 WhatsApp Inc. All Rights Reserved. */
(self.webpackChunkwhatsapp_web_client=self.webpackChunkwhatsapp_web_client||[]).push([[4018],{273925:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.JobBuilder=void 0,t.definePersistedJob=function(){return new r([])};var n=s(811158),i=s(632157);class r{constructor(e){this.steps=e}step(e,t){return this._stepWithOptions(e,"function"==typeof t?{code:t}:t)}_stepWithOptions(e,t){const{stopRetryIf:s,requirements:c,code:d}=t;let l=u(c,d,s);if(s){const{timePassedSeconds:e,appCrashed:t,onStopRetry:r}=s,c=u(null,function(e){return(t,s,i)=>Promise.resolve(e(t,s,i)).then((e=>e instanceof n.InterruptJob?e:new n.InterruptJob(e)))}(r),s);null!=e&&(l=o(((t,s,n)=>{let{jobStartTime:r}=n;return(0,i.happenedWithin)(r,e)}),l,c)),t&&(l=o(((e,t,s)=>{let{afterCrash:n}=s;return!n}),l,c))}return new r([...this.steps,{stepName:e,info:l}])}finalStep(e,t){const s=this.step(e,t);return{end:()=>s.steps}}}function o(e,t,s){return(n,i,r)=>e(n,i,r)?t(n,i,r):s(n,i,r)}function u(e,t,s){const n={requirements:e,code:t,stopRetryIf:s};return()=>n}t.JobBuilder=r},193182:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.defineWebPersistedJob=function(){return(0,n.definePersistedJob)()};var n=s(273925)},634018:(e,t,s)=>{"use strict";var n=s(595318);Object.defineProperty(t,"__esModule",{value:!0}),t.dismissQuickPromotion=void 0;var i=n(s(81109)),r=n(s(348926)),o=s(193182),u=s(658265),c=s(732011);const d=(0,o.defineWebPersistedJob)().finalStep("saveToDb",(function(e){let{id:t,ts:s}=e;return(0,c.getStorage)().lock(["quick-promotions"],function(){var e=(0,r.default)((function*(e){let[n]=e;const r=yield n.get(t);if(null==r)return void __LOG__(3)`dismissQuickPromotion: promotion not found`;const o=(0,i.default)((0,i.default)({},r.tracking),{},{dismisses:r.tracking.dismisses+1}),{lastDismissTs:u}=o;(null==u||s>u)&&(o.lastDismissTs=s),yield n.merge(t,{tracking:o})}));return function(){return e.apply(this,arguments)}}()).then(u.loadQuickPromotions)})).end();t.dismissQuickPromotion=d}}]);
//# sourceMappingURL=https://web.whatsapp.com/4018.67728b4b8e4260e89ffd.js.map
