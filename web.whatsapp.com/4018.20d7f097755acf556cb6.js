/*! Copyright (c) 2023 WhatsApp Inc. All Rights Reserved. */
(self.webpackChunkwhatsapp_web_client=self.webpackChunkwhatsapp_web_client||[]).push([[4018],{634018:(e,t,s)=>{"use strict";var i=s(595318);Object.defineProperty(t,"__esModule",{value:!0}),t.dismissQuickPromotion=void 0;var n=i(s(81109)),o=i(s(348926)),r=s(400538),u=s(193182),a=s(658265),c=s(732011);function l(){return(l=(0,o.default)((function*(e,t){let{id:s,ts:i}=t;const n=yield(0,r.sendEventRPC)({eventType:"dismiss",eventPromotionId:s,eventTimestampSec:i,eventLogdata:""});"EventResponseSuccess"!==n.name&&(n.name,__LOG__(4,void 0,new Error)`dismissQuickPromotion: unable to log`)}))).apply(this,arguments)}const d=(0,u.defineWebPersistedJob)().step("saveToDb",(function(e){let{id:t,ts:s}=e;return(0,c.getStorage)().lock(["quick-promotions"],function(){var e=(0,o.default)((function*(e){let[i]=e;const o=yield i.get(t);if(null==o)return void __LOG__(3)`dismissQuickPromotion: promotion not found`;const r=(0,n.default)((0,n.default)({},o.tracking),{},{dismisses:o.tracking.dismisses+1}),{lastDismissTs:u}=r;(null==u||s>u)&&(r.lastDismissTs=s),yield i.merge(t,{tracking:r})}));return function(){return e.apply(this,arguments)}}()).then(a.loadQuickPromotions)})).finalStep("reportToComms",(function(){return l.apply(this,arguments)})).end();t.dismissQuickPromotion=d}}]);
//# sourceMappingURL=https://web.whatsapp.com/4018.20d7f097755acf556cb6.js.map
