/*! Copyright (c) 2022 WhatsApp Inc. All Rights Reserved. */
(self.webpackChunkwhatsapp_web_client=self.webpackChunkwhatsapp_web_client||[]).push([[5837],{158114:(e,l,a)=>{"use strict";Object.defineProperty(l,"__esModule",{value:!0}),l.JobBuilder=void 0,l.definePersistedJob=function(){return new r([])};var n=a(247901),t=a(892844);class r{constructor(e){this.steps=e}step(e,l){return this._stepWithOptions(e,"function"==typeof l?{code:l}:l)}_stepWithOptions(e,l){const{stopRetryIf:a,requirements:u,code:o}=l;let d=s(u,o,a);if(a){const{timePassedSeconds:e,appCrashed:l,onStopRetry:r}=a,u=s(null,function(e){return(l,a,t)=>Promise.resolve(e(l,a,t)).then((e=>e instanceof n.InterruptJob?e:new n.InterruptJob(e)))}(r),a);null!=e&&(d=i(((l,a,n)=>{let{jobStartTime:r}=n;return(0,t.happenedWithin)(r,e)}),d,u)),l&&(d=i(((e,l,a)=>{let{afterCrash:n}=a;return!n}),d,u))}return new r([...this.steps,{stepName:e,info:d}])}finalStep(e,l){const a=this.step(e,l);return{end:()=>a.steps}}}function i(e,l,a){return(n,t,r)=>e(n,t,r)?l(n,t,r):a(n,t,r)}function s(e,l,a){const n={requirements:e,code:l,stopRetryIf:a};return()=>n}l.JobBuilder=r},647292:(e,l,a)=>{"use strict";Object.defineProperty(l,"__esModule",{value:!0}),l.defineWebPersistedJob=function(){return(0,n.definePersistedJob)()};var n=a(158114)},535837:(e,l,a)=>{"use strict";var n=a(595318);Object.defineProperty(l,"__esModule",{value:!0}),l.QueryProductListCatalog=void 0;var t,r=n(a(348926)),i=a(736184),s=n(a(653872)),u=n(a(145095)),o=a(831914),d=a(471914),c=a(492574),g=a(429332),p=a(732624),y=a(696055),_=a(647292),m=a(248089),f=a(408139),k=a(801321),S=a(745454),h=n(a(357291)),P=a(653069),b=a(526002);const F=new d.WapParser("productListResponse",(e=>{e.assertTag("iq"),e.assertFromServer();const l=e.child("product_list"),a=[];return l.forEachChildWithTag("product",(e=>{const l=e.maybeChild("id");if(!l)return;const n=e.maybeChild("status");(null==n?void 0:n.contentString())===b.INVALID_PRODUCT_TOKEN?a.push({id:l.contentString(),status:b.INVALID_PRODUCT_TOKEN}):a.push((0,g.parseProductNode)(e))})),a})),K=function(){var e=(0,r.default)((function*(e){let{catalogWid:l,productIds:a,width:n,height:t,directConnectionEncryptedInfo:r}=e;const s=(0,o.wap)("iq",{to:o.S_WHATSAPP_NET,type:"get",smax_id:"21",xmlns:"w:biz:catalog",id:(0,o.generateId)()},(0,o.wap)("product_list",{jid:(0,y.USER_JID)((0,S.createWid)(l))},a.map((e=>(0,o.wap)("product",null,(0,o.wap)("id",null,e)))).concat((0,h.default)([(0,o.wap)("width",null,n.toString()),(0,o.wap)("height",null,t.toString()),r?(0,o.wap)("direct_connection_encrypted_info",null,r):null])))),u=yield(0,i.sendIq)(s,F);if(u.success)return u.result;throw new c.ServerStatusCodeError(u.errorCode)}));return function(){return e.apply(this,arguments)}}(),C=function(){var e=(0,r.default)((function*(e){try{var l,n;const{catalogWid:r,productIds:i,width:s,height:o,directConnectionEncryptedInfo:d}=e,c=yield(0,k.fetchQuery)(void 0!==t?t:t=a(661136),{request:{product_list:{jid:r.toString(),products:i.map((e=>({id:e}))),width:String(s),height:String(o),direct_connection_encrypted_info:d}}},{eventLogger:(0,p.createCatalogEventLogger)(p.GRAPHQL_CATALOG_ENDPOINT.GET_PRODUCT_LIST)});return(0,u.default)(null==c||null===(l=c.xwa_product_catalog_get_product_list)||void 0===l||null===(n=l.product_list)||void 0===n?void 0:n.products.map(P.parseProductGraphQL),"data?.xwa_product_catalog_get_product_list?.product_list?.products.map(parseProductGraphQL)")}catch(l){return l instanceof m.GraphQLServerError&&(0,s.default)(l),__LOG__(3)`GraphQL: Failed fetching xwa_product_catalog_get_product_list query. Falling back to IQ.`,K(e)}}));return function(){return e.apply(this,arguments)}}(),L=(0,_.defineWebPersistedJob)().finalStep("sendStanza",(e=>((0,f.graphQLForCatalogM1Enabled)()?C:K)(e))).end();l.QueryProductListCatalog=L},661136:e=>{"use strict";const l={fragment:{argumentDefinitions:a=[{defaultValue:null,kind:"LocalArgument",name:"request"}],kind:"Fragment",metadata:null,name:"WAWebQueryProductListCatalogJobQuery",selections:r=[{alias:null,args:[{kind:"Variable",name:"request",variableName:"request"}],concreteType:"XWAProductCatalogGetProductListResponseSuccess",kind:"LinkedField",name:"xwa_product_catalog_get_product_list",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{alias:null,args:null,concreteType:"XWAProductCatalogGetProductListResponseSuccessProductList",kind:"LinkedField",name:"product_list",plural:!1,selections:[{alias:null,args:null,concreteType:"XWACatalogProduct",kind:"LinkedField",name:"products",plural:!0,selections:[n={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"retailer_id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_hidden",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"availability",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"currency",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"price",storageKey:null},{alias:null,args:null,concreteType:"XWAProductCatalogProductStatusInfo",kind:"LinkedField",name:"status_info",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"can_appeal",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"status",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XWAProductCatalogProductSalePrice",kind:"LinkedField",name:"sale_price",plural:!1,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"start_date",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"end_date",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XWAProductCatalogProductMedia",kind:"LinkedField",name:"media",plural:!1,selections:[{alias:null,args:null,concreteType:"XWAProductCatalogProductMediaImage",kind:"LinkedField",name:"images",plural:!0,selections:[n,{alias:null,args:null,kind:"ScalarField",name:"original_image_url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"request_image_url",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"belongs_to",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"compliance_category",storageKey:null},{alias:null,args:null,concreteType:"XWAProductCatalogProductComplianceInfo",kind:"LinkedField",name:"compliance_info",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"country_code_origin",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"importer_name",storageKey:null},{alias:null,args:null,concreteType:"XWAProductCatalogProductComplianceInfoImporterAddress",kind:"LinkedField",name:"importer_address",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"street1",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"street2",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"postal_code",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"city",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"region",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"country_code",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"WAWebQueryProductListCatalogJobQuery",selections:r},params:{id:"WAWebQueryProductListCatalogJobQuery",metadata:{},name:"WAWebQueryProductListCatalogJobQuery",operationKind:"query",text:null}};var a,n,t,r;l.hash="d4f7b0d81647f5b9b87b0831cd2b0cf5",e.exports=l}}]);
//# sourceMappingURL=https://web.whatsapp.com/5837.e364b62663193cde57b9.js.map
