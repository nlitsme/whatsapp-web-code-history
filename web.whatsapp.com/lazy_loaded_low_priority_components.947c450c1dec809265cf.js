/*! Copyright (c) 2022 WhatsApp Inc. All Rights Reserved. */
(self.webpackChunkwhatsapp_web_client=self.webpackChunkwhatsapp_web_client||[]).push([[275],{74220:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.cartItemCollection.reset(),e.set("message",void 0),e.trigger("change:cartItemCollection"),(0,r.default)(e)};var r=a(n(38260))},72921:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){const n=r.CartCollection.findCart(e);return n.cartItemCollection.remove(t),n.trigger("change:cartItemCollection"),(0,i.default)(n),n.itemCount};var r=n(12392),i=a(n(38260))},79495:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.createProductFromRefreshCartItem=C,t.isPriceMatch=x,t.matchCartItemsToProducts=function(e,t){const n=s.CatalogCollection.get((0,i.createWid)(e.id)),a=[],r=[];let u=!0;n&&e.cartItemCollection.forEach((i=>{const o=n.productCollection.get(i.id);let s=t&&t.products.find((e=>e.id===i.id));if(s=function(e,t){if(e&&"deleted"===e.status)return void t.productCollection.remove(e.id);return e}(s,n),!t&&o){const e=function(e,t){const n=function(e,t){return e.priceAmount1000===(0,f.getActivePrice)(t)&&e.currency===t.currency&&e.name===t.name&&e.imageHash===t.imageHash}(e,t);n||e.set({priceAmount1000:(0,f.getActivePrice)(t),currency:t.currency,name:t.name,imageHash:t.imageHash},{silent:!0});return n}(i,o);u=u&&e,a.push({product:o,cartItem:i})}else if(s){const t=function(e,t){const n=!t||function(e,t){var n,a;const r=(0,f.getActivePrice)(v(t));return x(e.priceAmount1000,r)&&(!(0,m.isString)(e.currency)&&!(0,m.isString)(t.currency)||e.currency===t.currency)&&e.name===t.name&&e.imageHash===(null===(n=t.media)||void 0===n||null===(a=n.image)||void 0===a?void 0:a.id)}(e,t);if(!n&&t){const n=v(t);e.set({priceAmount1000:(0,f.getActivePrice)(n),currency:n.currency,name:n.name,imageHash:n.imageHash},{silent:!0})}return n}(i,s);u=u&&t,a.push({product:C(s,e.id),cartItem:i})}else u=!1,r.push(i.id)})),n||(0,l.default)(e);u||(r.length&&e.cartItemCollection.remove(r),e.trigger("change:cartItemCollection"),d.Cmd.openModal((0,g.jsx)(c.default,{onOK:()=>{d.Cmd.closeModal()},children:o.fbt._("One or more items in your cart have been updated",null,{hk:"1jr9xE"})})));return(0,p.default)(e),a},t.parsePrice=_;var r=a(n(81109)),i=n(45454),o=n(48360),s=n(99989),l=a(n(74220)),d=n(88102),c=a(n(52665)),u=n(9468),h=n(21374),f=n(13151),p=a(n(38260)),m=n(31515),g=n(85893);function v(e){var t,n,a,r,i,o,s,l;return{id:e.id,name:null!==(t=e.name)&&void 0!==t?t:"",imageCdnUrl:null===(n=e.media)||void 0===n||null===(a=n.image)||void 0===a?void 0:a.request_image_url,imageHash:null===(r=e.media)||void 0===r||null===(i=r.image)||void 0===i?void 0:i.id,currency:e.currency,priceAmount1000:_(e.price),salePriceAmount1000:_(null===(o=e.sale_price)||void 0===o?void 0:o.price),salePriceStartDate:(0,h.parseDateValue)(null===(s=e.sale_price)||void 0===s?void 0:s.start_date),salePriceEndDate:(0,h.parseDateValue)(null===(l=e.sale_price)||void 0===l?void 0:l.end_date)}}function _(e){return"string"==typeof e?e.length>0?parseInt(e,10):null:e}function x(e,t){const n=_(e),a=_(t);return(0,m.isNumber)(n)&&(0,m.isNumber)(a)?n===a:!(0,m.isNumber)(n)&&!(0,m.isNumber)(a)}function C(e,t){return new u.Product((0,r.default)((0,r.default)({},v(e)),{},{catalogWid:(0,i.createWid)(t),productMsgMediaData:null,imageCount:1,fetchedFromServer:!0,t:Date.now()/1e3,old:!1}))}},9186:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(0===e.cartItemCollection.length)return Promise.resolve({products:[],price:{}});const n=e.cartItemCollection.map((e=>e.id));return(0,r.refreshCart)((0,a.createWid)(e.id),n,i.CartCollection.imageWidth,i.CartCollection.imageHeight,t)};var a=n(45454),r=n(6878),i=n(12392)},53109:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return h.apply(this,arguments)};var r=a(n(48926)),i=n(45454),o=n(99989),s=a(n(34949)),l=n(9538),d=a(n(76533)),c=a(n(38260));function u(e){var t,n;const a=e.cartItemCollection.at(0);if(null==a)return"";const r=o.CatalogCollection.get((0,i.createWid)(e.id)),l=null==r?void 0:r.productCollection.get(a.id),d=null==l||null===(t=l.getProductImageCollectionHead())||void 0===t?void 0:t.mediaData;return null==d?"":d.preview instanceof s.default&&null!==(n=d.preview.getBase64())&&void 0!==n?n:""}function h(){return(h=(0,r.default)((function*(e,t){const n=yield(0,l.createOrder)(t.id,e.cartItemCollection.toArray());return yield(0,d.default)(t,n,e.itemCount,u(e),e.message),(0,c.default)(e),n.id}))).apply(this,arguments)}},51383:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){e.set("message",t),(0,r.default)(e)};var r=a(n(38260))},85566:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){const a=r.CartCollection.findCart(e),o=a.cartItemCollection.get(t.id);null==o||o.set("quantity",n),a.trigger("change:cartItemCollection"),(0,i.default)(a)};var r=n(12392),i=a(n(38260))},76533:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return h.apply(this,arguments)};var r=a(n(48926)),i=n(35470),o=a(n(65212)),s=a(n(89867)),l=n(22683),d=n(99234),c=n(75887),u=n(13705);function h(){return(h=(0,r.default)((function*(e,t,n,a,r){const i=(0,d.getMaybeMeUser)(),o=f(e,t,n,a,r);if(s.default.equals(e.id,i))return(0,c.addAndSendMsgToChat)(e,o)[0].then((()=>{})).catch((e=>{throw __LOG__(3)`Order message send to chat failure: ${e}`,e}));try{const t=yield(0,c.addAndSendMsgToChat)(e,o)[1];if(!t||t!==u.SendMsgResult.OK)throw new Error("Order message SendMsgResult failure status")}catch(e){throw __LOG__(3)`Order message send to chat failure: ${e}`,e}}))).apply(this,arguments)}function f(e,t,n,a,r){const s=(0,d.getMaybeMeUser)(),c={type:"order",ack:i.ACK.CLOCK,from:s,id:new o.default({from:s,to:e.id,id:o.default.newId(),participant:void 0,selfDir:"out"}),local:!0,isNewMsg:!0,self:"out",t:l.Clock.globalUnixTime(),to:e.id,orderId:t.id,token:t.token,orderTitle:e.name||e.formattedTitle,sellerJid:e.id.toString({legacy:!0}),thumbnail:a,itemCount:n,message:r},u=t.price.total;return u&&u.length>0&&(c.totalAmount1000=parseInt(u,10)),t.price.currency&&t.price.currency.length>0&&(c.totalCurrencyCode=t.price.currency),c}},12224:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return m.apply(this,arguments)};var r=a(n(48926)),i=n(50796),o=n(48360),s=n(46331),l=n(88102),d=n(62251),c=n(56489),u=n(3764),h=n(82039),f=n(77591),p=n(85893);function m(){return(m=(0,r.default)((function*(e){let{name:t,desc:n,icon:a,existingGroups:m,newGroups:g}=e;const v=(0,d.sendCreateCommunity)({name:t,desc:n}),_=(0,r.default)((function*(){return yield v,new s.ActionType(o.fbt._("",null,{hk:"2NkvWT"}))}))(),x=new s.ActionType(o.fbt._("",null,{hk:"YrkdK"}));l.Cmd.openToast((0,p.jsx)(s.ActionToast,{id:(0,s.genId)(),initialAction:x,pendingAction:_}));try{const e=(yield v).wid;if(null!=a){const t=h.ProfilePicThumbCollection.gadd(e);yield(0,u.setProfilePic)(t,a,a)}let t=[];g.length>0&&(t=g.map((t=>{let{subject:n,icon:a,ephemeralDuration:r}=t;return(0,c.createGroup)(n,a,a,[],r,e)}))),m.length&&t.push((0,d.sendLinkSubgroups)({parentGroupWid:e,subgroups:m.map((e=>e.id))})),yield Promise.all(t)}catch(e){(0,i.filteredCatch)(f.ServerStatusCodeError,(()=>{}))(e)}}))).apply(this,arguments)}},55326:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.setPushname=function(e){return p(e)};var r=a(n(48926)),i=n(50796),o=n(46331),s=n(88102),l=n(17239),d=a(n(43725)),c=a(n(54947)),u=n(53006),h=n(77591),f=n(85893);function p(){return m.apply(this,arguments)}function m(){return(m=(0,r.default)((function*(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(0,o.genId)(),n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const a=(0,c.default)(e),r=new o.ActionType(d.default.t(121)),m=l.Conn.pushname,g=a.then((()=>{const e=n?void 0:{actionText:d.default.t(133),actionHandler:()=>p(m,t,!0)};return new o.ActionType(d.default.t(119),e)})).catch((0,i.filteredCatch)(h.ServerStatusCodeError,(e=>{if(e.status>=400)return new o.ActionType(d.default.t(120))}))).catch((()=>{throw __LOG__(3)`models:conn:setPushname dropped`,new o.ActionType(d.default.t(120),{actionText:d.default.t(129),actionHandler:()=>p(status,t)})}));s.Cmd.openToast((0,f.jsx)(o.ActionToast,{id:t,initialAction:r,pendingAction:g}));const v=yield a;v._duplicate||(0,u.setPushnameLocally)(e)}))).apply(this,arguments)}},50247:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){r.Cmd.openToast((0,o.jsx)(i.Toast,{msg:a.fbt._("Something went wrong",null,{hk:"2TMztB"}),duration:6e3,id:(0,i.genId)()}))};var a=n(48360),r=n(88102),i=n(50452),o=n(85893)},28602:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useGdprDelete=function(){return(0,i.useSendIq)((0,a.wap)("iq",{xmlns:"urn:xmpp:whatsapp:account",to:a.S_WHATSAPP_NET,type:"get",id:(0,a.generateId)()},(0,a.wap)("gdpr",{action:"delete"})),r.GdprStatusWapParser)};var a=n(31914),r=n(23218),i=n(648)},60768:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.useGdprDownload=function(){const[e,t]=(0,o.useState)(!1);return[e,e=>{t(!0),(0,l.gdprDownloadMedia)(e).then((e=>s.FileSaver.downloadData((0,r.default)(e.mediaBlob,"mediaObject.mediaBlob").formData(),String(i.fbt._("My Account Info",null,{hk:"IqRu3"})),s.AllowedFileExtensions.ZIP))).finally((()=>t(!1)))}]};var r=a(n(45095)),i=n(48360),o=n(67294),s=n(77811),l=n(61647)},98753:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useGdprRequest=function(){return(0,i.useSendIq)((0,a.wap)("iq",{xmlns:"urn:xmpp:whatsapp:account",to:a.S_WHATSAPP_NET,type:"get",id:(0,a.generateId)()},(0,a.wap)("gdpr",{action:"request"})),r.GdprStatusWapParser)};var a=n(31914),r=n(23218),i=n(648)},23218:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.GdprStatusWapParser=void 0,t.useGdprStatus=function(){const[e,t]=function(e){(0,u.default)((()=>{f=(0,i.generateId)()}));const[t,n]=(0,l.useState)(f),a=(0,l.useMemo)((()=>e(t)),[e,t]);return[(0,c.sendSuspensefulIq)(a,h),()=>n((0,i.generateId)())]}((e=>(0,i.wap)("iq",{xmlns:"urn:xmpp:whatsapp:account",to:i.S_WHATSAPP_NET,type:"get",id:e},(0,i.wap)("gdpr",{action:"status"}))));return[e.result,t]};var r=a(n(45095)),i=n(31914),o=n(71914),s=n(84902),l=n(67294),d=n(24808),c=n(53663),u=a(n(84215));const h=new o.WapParser("parseStatus",(e=>{if(!e.hasChild("gdpr"))return null;const t=e.child("gdpr");if(t.hasChild("document")){const e=t.child("document");return{creation:e.attrTime("creation"),documentMessage:(0,r.default)((0,s.decodeProtobuf)(d.MessageSpec,e.contentBytes()).documentMessage,"decodeProtobuf(MessageSpec, document.contentBytes()).documentMessage"),expiration:e.attrTime("expiration"),type:"GdprAvailableStatusResponse"}}return{timestamp:t.attrTime("timestamp"),type:"GdprPendingStatusResponse"}}));t.GdprStatusWapParser=h;let f=(0,i.generateId)()},42681:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.syncAndGetAdminedGroups=function(){return l.apply(this,arguments)};var r=a(n(48926)),i=n(69951),o=n(19380),s=n(36163);function l(){return(l=(0,r.default)((function*(){try{yield(0,s.restoreGroupParticipants)();const e=o.ContactCollection.getGroupContacts();return e.filter((e=>{var t,n;const a=null===(t=i.ChatCollection.get(e.id.toString()))||void 0===t||null===(n=t.groupMetadata)||void 0===n?void 0:n.participants;return null!=a&&a.iAmAdmin()}))}catch(e){return __LOG__(3)`Failed to sync group metadata`,[]}}))).apply(this,arguments)}},39434:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.privacyWebNameToServerName=function(e){switch(e){case"readReceipts":return"readreceipts";case"groupAdd":return"groupadd";case"profilePicture":return"profile";case"about":return"status";case"lastSeen":return"last"}},t.setPrivacyForOneCategory=function(){return p.apply(this,arguments)};var r=a(n(81109)),i=a(n(48926)),o=a(n(45095)),s=n(99234),l=n(61319),d=n(94646),c=n(14810),u=n(77591);function h(e){switch(e){case"readreceipts":return"readReceipts";case"groupadd":return"groupAdd";case"profile":return"profilePicture";case"status":return"about";case"last":return"lastSeen"}}function f(e){switch(e){case"status":return l.PrivacyDisallowedListType.About;case"groupadd":return l.PrivacyDisallowedListType.GroupAdd;case"last":return l.PrivacyDisallowedListType.LastSeen;case"profile":return l.PrivacyDisallowedListType.ProfilePicture;default:throw new Error("castToPrivacyDisallowedListType: invalid name")}}function p(){return(p=(0,i.default)((function*(e,t){const n=yield(0,d.setPrivacy)([e]);if(1!==n.length)throw new Error("setPrivacy should return one response");const a=n[0];if(a instanceof u.ServerStatusCodeError)throw 409===a.statusCode&&"contact_blacklist"===e.value&&(yield(0,c.syncSinglePrivacyDisallowedList)(f(e.name))),a;const{name:i,value:p}=e,m=h(i);if((0,s.setUserPrivacySettings)((0,r.default)((0,r.default)({},(0,s.getUserPrivacySettings)()),{},{[m]:p})),"contact_blacklist"===p){const e={id:f(i),disallowedList:(0,o.default)(t,"contactExceptList").map((e=>e.toString())),dhash:(0,o.default)(a.dhash,"response.dhash")};yield(0,l.getTable)().createOrReplace(e)}}))).apply(this,arguments)}},1673:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.getTwoFactor=function(){return s.apply(this,arguments)},t.setTwoFactor=function(){return l.apply(this,arguments)};var r=a(n(48926)),i=n(1618),o=a(n(81044));function s(){return(s=(0,r.default)((function*(){try{var e;const t=yield(0,i.getTwoFactor)();return null!==(e=null==t?void 0:t.code)&&void 0!==e&&e}catch(e){return __LOG__(3,!0,void 0,!0)`get2FA failed - ${e}`,SEND_LOGS("get-2FA-failed"),!1}}))).apply(this,arguments)}function l(){return(l=(0,r.default)((function*(e,t){try{yield(0,o.default)(e,t)}catch(e){__LOG__(3,!0,void 0,!0)`set2FA failed -${e}`,SEND_LOGS("set-2FA-failed")}}))).apply(this,arguments)}},53663:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sendSuspensefulIq=function(e,t){const n=e.attrs.id;if(r.has(n)){const e=r.get(n);if(e instanceof Promise)throw e;return e}const i=(0,a.sendIq)(e,t);throw r.set(n,i),i.then((e=>r.set(n,e))),i};var a=n(24747);const r=new Map},1618:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.getTwoFactor=function(){return u.apply(this,arguments)};var r=a(n(48926)),i=n(8584),o=n(31914),s=n(71914),l=n(24747),d=n(77591);const c=new s.WapParser("getTwoFactor",(e=>{if(e.hasChild("2fa"))return{code:e.child("2fa").hasChild("code"),email:e.child("2fa").hasChild("email")}}));function u(){return(u=(0,r.default)((function*(e){const t=yield(0,l.sendIq)(h(e),c);if(!t.success)throw new d.ServerStatusCodeError(t.errorCode,t.errorText);return t.result}))).apply(this,arguments)}function h(e){const t=[];return null!=e&&t.push(new o.WapNode("code",void 0,i.Binary.build(e).readByteArray())),(0,o.wap)("iq",{to:o.S_WHATSAPP_NET,type:"get",xmlns:"urn:xmpp:whatsapp:account",id:(0,o.generateId)()},new o.WapNode("2fa",void 0,t))}},62251:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.sendCreateCommunity=function(){return p.apply(this,arguments)},t.sendLinkSubgroups=function(){return g.apply(this,arguments)};var r=a(n(48926)),i=n(87614),o=n(31914),s=n(71914),l=n(81663),d=n(45454),c=n(24747),u=n(39410),h=n(77591);const f=new s.WapParser("createCommunityReplyParser",(e=>{const t=e.child("group"),n=(0,d.createWid)(`${t.attrString("id")}@g.us`);if(!n.isGroup())throw Error("createGroupReplyParser: invalid group id");return{wid:n,subject:t.attrString("subject"),creator:(0,l.userJidToUserWid)(t.attrUserJid("creator")),ts:t.attrTime("creation")}}));function p(){return(p=(0,r.default)((function*(e){let{name:t,desc:n}=e;const a=(0,i.randomHex)(8),r=(0,o.wap)("iq",{to:o.G_US,type:"set",xmlns:"w:g2",id:(0,o.generateId)()},(0,o.wap)("create",{subject:(0,o.CUSTOM_STRING)(t),key:(0,o.CUSTOM_STRING)(a)},(0,o.wap)("parent",null),null!=n&&n.length>0?(0,o.wap)("description",{id:(0,o.generateId)()},(0,o.wap)("body",null,n)):null)),s=yield(0,c.sendIq)(r,f);return s.success?s.result:(__LOG__(2)`sendCreateCommunity failed: ${s.errorCode}:${s.errorType}`,Promise.reject(new h.ServerStatusCodeError(s.errorCode,s.errorText)))}))).apply(this,arguments)}const m=new s.WapParser("linkSubgroupsReplyParser",(e=>(e.assertTag("iq"),e.assertAttr("type","result"),{id:e.attrString("id"),linkedGroupJids:e.child("links").child("link").mapChildren((e=>e.attrGroupJid("jid")))})));function g(){return(g=(0,r.default)((function*(e){let{parentGroupWid:t,subgroups:n}=e;const a=n.map((e=>(0,o.wap)("group",{jid:(0,u.JID)(e)}))),r=(0,o.wap)("iq",{to:(0,u.JID)(t),type:"set",xmlns:"w:g2",id:(0,o.generateId)()},(0,o.wap)("links",null,(0,o.wap)("link",{link_type:"sub_group"},a))),i=yield(0,c.sendIq)(r,m);return i.success?i.result:(__LOG__(2)`sendLinkSubgroups failed: ${i.errorCode}:${i.errorType}`,Promise.reject(new h.ServerStatusCodeError(i.errorCode,i.errorText)))}))).apply(this,arguments)}},15161:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getIdentityVerificationDataJob=function(e){return(0,i.NonPersistJob)("getIdentityVerificationData",(e=>(0,r.getIdentityVerificationData)(e)),{priority:a.JOB_PRIORITY.SKIP}).waitUntilCompleted({jid:e})};var a=n(1973),r=n(35723),i=n(29731)},81044:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return u.apply(this,arguments)};var r=a(n(48926)),i=n(8584),o=n(31914),s=n(71914),l=n(24747),d=n(77591);const c=new s.WapParser("set2FA",(e=>({stanzaId:e.attrString("id")})));function u(){return(u=(0,r.default)((function*(e,t){const n=[new o.WapNode("code",void 0,i.Binary.build(e).readByteArray())];null!=t&&n.push(new o.WapNode("email",void 0,i.Binary.build(t).readByteArray()));const a=yield(0,l.sendIq)((0,o.wap)("iq",{to:o.S_WHATSAPP_NET,type:"set",xmlns:"urn:xmpp:whatsapp:account",id:(0,o.generateId)()},new o.WapNode("2fa",void 0,n)),c);if(!a.success)throw new d.ServerStatusCodeError(a.errorCode,a.errorText)}))).apply(this,arguments)}},94646:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.PrivacyUserAction=void 0,t.setPrivacy=function(){return h.apply(this,arguments)};var r=a(n(48926)),i=n(31914),o=n(71914),s=n(24747),l=n(39410),d=n(77591);const c=new o.WapParser("setPrivacyParser",(e=>e.child("privacy").mapChildrenWithTag("category",(e=>{if("error"===e.attrString("value")){const t=e.child("error");return new d.ServerStatusCodeError(t.attrInt("code"),t.attrString("text"))}return{name:e.attrString("name"),value:e.attrString("value"),dhash:e.maybeAttrString("dhash")}})))),u=n(76672)({Add:"add",Remove:"remove"});function h(){return(h=(0,r.default)((function*(e){const t=e.map((e=>{const{name:t,value:n,users:a,dhash:r}=e;return(0,i.wap)("category",{name:(0,i.CUSTOM_STRING)(t),value:(0,i.CUSTOM_STRING)(n),dhash:null==a?i.DROP_ATTR:(0,i.CUSTOM_STRING)(null!=r?r:"none")},null==a?null:a.map((e=>{let{action:t,wid:n}=e;return(0,i.wap)("user",{action:(0,i.CUSTOM_STRING)(t),jid:(0,l.JID)(n)})})))})),n=yield(0,s.sendIq)((0,i.wap)("iq",{to:i.S_WHATSAPP_NET,type:"set",xmlns:"privacy",id:(0,i.generateId)()},(0,i.wap)("privacy",null,t)),c);if(!0===n.success)return n.result;throw new d.ServerStatusCodeError(n.errorCode,n.errorText)}))).apply(this,arguments)}t.PrivacyUserAction=u},15194:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.sendSupportRequest=function(){return f.apply(this,arguments)};var r=a(n(48926)),i=n(31914),o=n(71914),s=n(85965),l=n(24747),d=n(99234),c=n(39410);function u(e,t){__LOG__(3,void 0,void 0,!0)`supportRequest error: code=${e} message=${null!=t?t:""}`,SEND_LOGS("supportRequest")}const h=new o.WapParser("supportResponse",(e=>{const t=e.child("response");if(t.hasAttr("error_code")){return{type:"error",errorCode:t.attrInt("error_code",0,1e3)}}t.assertAttr("status","ok");return{type:"success",message:t.child("message").contentString(),ticketId:t.child("ticket_id").contentString()}}));function f(){return(f=(0,r.default)((function*(e,t){const n=(0,i.wap)("iq",{from:(0,c.USER_JID)((0,d.getMeUser)()),id:(0,i.generateId)(),smax_id:"3",to:i.S_WHATSAPP_NET,type:"set",xmlns:"fb:thrift_iq"},(0,i.wap)("description",null,e),null!=t?(0,i.wap)("debug_information_json",null,t):null),a=yield(0,l.sendIq)(n,h);let r;if(a.success){var o;const{result:e}=a;return"success"===e.type?(null!=t&&(__LOG__(2)`InAppSupport: Uploading logs for ticketId=${e.ticketId}`,(0,s.upload)({reason:"user-report",immediate:!0,force:!0,persist:!0,ticketId:e.ticketId}).then((t=>{__LOG__(2)`InAppSupport: Logs upload complete for ticketId=${e.ticketId}, logsId=${t}`}))),{type:"success",message:e.message,ticketId:e.ticketId}):(r=null!==(o=e.errorCode)&&void 0!==o?o:400,u(r),{type:"error",errorCode:r})}return u(a.errorCode,a.errorText),{type:"error",errorCode:a.errorCode}}))).apply(this,arguments)}},35723:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.getIdentityVerificationData=function(){return y.apply(this,arguments)};var r=a(n(48926)),i=n(8584),o=n(60980),s=n(26409),l=n(80498),d=n(99234),c=n(97398),u=a(n(76128)),h=n(56592);const f=/^([17]|2[07]|3[0123469]|4[013456789]|5[12345678]|6[0123456]|8[1246]|9[0123458]|\d{3})\d*?(\d{4,6})$/;function p(e){const t=f.exec(function(e){return e.user.split("@")[0]}(e));return i.Binary.build(t?t[1]+t[2]:e.toString()).readByteArray()}function m(e,t){return`00000${256*e.getUint32(t,!1)+e.getUint8(t+4)}`.slice(-5)}function g(){return v.apply(this,arguments)}function v(){return(v=(0,r.default)((function*(e,t){let n=Promise.resolve(i.Binary.build(0,0,t,e).readByteArray());for(let e=0;e<5200;e++)n=n.then((e=>self.crypto.subtle.digest({name:"SHA-512"},i.Binary.build(e,t).readByteArray())));const a=yield n,r=new DataView(a instanceof ArrayBuffer?a.slice(0,30):a.slice(0,30).buffer);return[m(r,0),m(r,5),m(r,10),m(r,15),m(r,20),m(r,25)].join("")}))).apply(this,arguments)}function _(){return x.apply(this,arguments)}function x(){return(x=(0,r.default)((function*(e,t,n,a){return(yield Promise.all([g(e,t),g(n,a)])).sort().join("")}))).apply(this,arguments)}function C(e,t,n,a){const r=new i.Binary;return(0,o.encodeProtobuf)(l.CombinedFingerprintSpec,{version:0,localFingerprint:{publicKey:t,identifier:e},remoteFingerprint:{publicKey:a,identifier:n}},r),r.readBuffer()}function y(){return(y=(0,r.default)((function*(e){let{jid:t}=e;const n=(0,d.assertGetMe)(),a=yield(0,s.getFanOutListJob)([t,n]);try{yield(0,c.ensureE2ESessions)(a)}catch(e){__LOG__(4,void 0,new Error)`ensureE2ESessions with error`}const r=[],i=[];a.forEach((e=>{e.user===n.user?i.push(e):r.push(e)}));try{const e=yield(0,h.getAllIdentityKeysBytesOrThrow)(r),n=yield(0,h.getAllIdentityKeysBytesOrThrow)(i),a=yield u.default.getIdentityKeyPair();if(!a)return __LOG__(3)`getIdentityVerificationData: missing identity for device verification`,null;n.push(new Uint8Array(a.pubKey));const o=(0,h.identityKeysToBinary)(n),s=(0,h.identityKeysToBinary)(e),l=p((0,d.getMeUser)()),c=p(t),f=yield Promise.all([_(l,o,c,s),C(l,o,c,s)]);if(null==f)return null;const[m,g]=f;return{binary:g,string:m}}catch(e){return __LOG__(3)`getIdentityVerificationData: error ${e} when trying to generate identtiy QR code`,null}}))).apply(this,arguments)}},33866:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.editBusinessProfile=t.editBusinessCompliance=void 0;var r=n(8021),i=n(7293),o=n(90549),s=n(63442),l=n(46277),d=a(n(56891));t.editBusinessProfile=e=>{let t;return(0,o.qplPointProfileSave)("datasource_start"),i.GK.supportsFeature(i.GK.F.MD_BACKEND)?(t=(0,r.editBusinessProfile)(e),t||(t=Promise.reject(new Error("md business profile edit not supported")))):t=(0,l.editBusinessProfile)(e),t.then((()=>{(0,o.qplPointProfileSave)("datasource_end")})),t};t.editBusinessCompliance=e=>{let t;return i.GK.supportsFeature(i.GK.F.MD_BACKEND)?(t=(0,s.setMerchantCompliance)(e),t||(t=Promise.reject(new Error("md business compliance profile called from a non-md build")))):t=d.default.editBusinessComplianceWebd(e),t}},46277:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.editBusinessProfile=t.convertProfileToRequestData=void 0;var r=a(n(81109)),i=a(n(48926)),o=a(n(70740)),s=n(77591),l=n(65044);const d=e=>{if(!e)return;return{category:e.map((e=>{let{id:t}=e;return{id:t}}))}},c=e=>{if(!e)return;const{note:t,timezone:n,config:a}=e,r=[];for(const e in a){const t=a[e],{mode:n,hours:i}=t;if(i)for(const[t,a]of i)r.push({day_of_week:e,mode:n,open_time:t,close_time:a});else r.push({day_of_week:e,mode:n})}return{timezone:n,business_hours_note:t,business_hours_config:r}},u=e=>{let{address:t,description:n,email:a,website:r,businessHours:i,categories:s}=e;const l=(0,o.default)({address:t,description:n,email:a,website:r,business_hours:c(i),categories:d(s)});return Object.keys(l).length>0?l:void 0};t.convertProfileToRequestData=u;const h=function(){var e=(0,i.default)((function*(e){const t=u(e);if(!t)return void __LOG__(3)`empty profile received, ignoring save`;const n=(0,r.default)({v:2},t);try{const e=yield l.Socket.send2({data:["action","editBusinessProfile",n],retryOn5xx:!0}),{status:t}=e;if((e=>e>=200&&e<=299)(t))return;throw __LOG__(3)`error editing business profile webd: ${t}`,new s.ServerStatusCodeError(t,"edit business profile")}catch(e){const t=e;throw __LOG__(3)`error editing business profile: ${t}`,t}}));return function(){return e.apply(this,arguments)}}();t.editBusinessProfile=h},54947:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return h.apply(this,arguments)};var r=a(n(48926)),i=n(92844),o=n(7293),s=a(n(42339)),l=a(n(45723)),d=n(38804),c=a(n(56891)),u=n(77591);function h(){return(h=(0,r.default)((function*(e){if(o.GK.supportsFeature(o.GK.F.MD_BACKEND)&&e){const t=(0,i.unixTimeMs)(),n=s.default.getPushnameMutation(t,e);return(0,l.default)(e),(0,d.lockForSync)([],[n],(()=>Promise.resolve())).then((()=>({_duplicate:null})))}const t=yield c.default.setPushname(e);if(t.status&&200!==t.status)throw new u.ServerStatusCodeError(t.status);return{_duplicate:t._duplicate}}))).apply(this,arguments)}},61647:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.gdprDownloadMedia=function(e){const t=(0,l.getOrCreateMediaObject)((0,i.encodeB64)((0,o.default)(e.fileSha256,"documentMessage.fileSha256"))),n={debugHint:"setMediaObjectValues",deprecatedMms3Url:(0,o.default)(e.directPath,"documentMessage.directPath"),encFilehash:(0,i.encodeB64)((0,o.default)(e.fileEncSha256,"documentMessage.fileEncSha256")),mediaKey:(0,i.encodeB64)((0,o.default)(e.mediaKey,"documentMessage.mediaKey")),mediaKeyTimestamp:(0,s.unixTime)(),type:c.MEDIA_TYPES.DOCUMENT};return t.entries.addEntry(n),t.consolidate((0,r.default)((0,r.default)({},n),{},{filehash:(0,i.encodeB64)((0,o.default)(e.fileSha256,"documentMessage.fileSha256")),type:d.TYPE.DOCUMENT})),(0,h.downloadMedia)({downloadEvenIfExpensive:!0,downloadOrigin:u.default.DOWNLOAD_ORIGIN_TYPE.GDPR,mediaObject:t,mediaType:c.MEDIA_TYPES.DOCUMENT,mimetype:"application/zip",rmrReason:u.default.WEBC_RMR_REASON_CODE.DOCUMENT_DOWNLOAD}).then((()=>t))};var r=a(n(81109)),i=n(15688),o=a(n(45095)),s=n(92844),l=(n(21009),n(88297)),d=n(58668),c=n(61596),u=a(n(11339)),h=n(9329)},43560:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LoadType=t.EditType=void 0;const a=n(76672).Mirrored(["EDITING","PENDING","DONE","ERROR"]);t.EditType=a;const r=n(76672).Mirrored(["PENDING","DONE","ERROR"]);t.LoadType=r},80498:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FingerprintDataSpec=t.CombinedFingerprintSpec=void 0;var a=n(1390);const r={};t.FingerprintDataSpec=r;const i={};t.CombinedFingerprintSpec=i,r.internalSpec={publicKey:[1,a.TYPES.BYTES],identifier:[2,a.TYPES.BYTES]},i.internalSpec={version:[1,a.TYPES.UINT32],localFingerprint:[2,a.TYPES.MESSAGE,r],remoteFingerprint:[3,a.TYPES.MESSAGE,r]}},79686:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.BusinessAddressField=function(e){let{businessProfile:t,activeField:n,rawBusinessProfile:a,sessionId:i,value:l,validate:u,error:h,lowProfile:f=!0,onActive:m,onChange:g,onSaveBusinessProfile:v,onError:_,onCancel:x}=e;const C=(0,c.jsx)(o.BusinessProfileFormField,{activeField:n,fieldKey:"address",fieldMetric:d.default.BUSINESS_PROFILE_FIELD.ADDRESS,formatForSave:()=>({address:l}),lowProfile:f,originalValue:t.address,placeholder:r.fbt._("Business Address",null,{hk:"HF4CB"}),rawBusinessProfile:a,sessionId:i,textFieldConfig:{maxLength:s.BUSINESS_PROFILE_FIELDS_LENGTH.ADDRESS},value:l,validate:u,error:h,onActive:m,onChange:g,onSaveBusinessProfile:v,onError:_,onCancel:x}),{latitude:y,longitude:S}=t,j=null!=y&&null!=S?(0,c.jsx)(p,{activeField:n,value:l,latitude:y,longitude:S}):null;return(0,c.jsxs)(c.Fragment,{children:[C,j]})};var r=n(48360),i=a(n(56720)),o=n(57597),s=n(93170),l=a(n(83452)),d=a(n(11339)),c=n(85893);const u={position:"g0rxnol2",display:"p357zi0d",alignItems:"gndfcl4n",justifyContent:"ac2vgrno",paddingTop:"ppypbuwx",paddingEnd:"fhfm09ip",paddingBottom:"s8gyl5p1",paddingStart:"mjn2akup",marginTop:"c6axuxzh",marginEnd:"jnwc1y2a",marginBottom:"mpdn4nr2",marginStart:"svoq16ka"},h={position:"lhggkp7q",top:"qq0sjtgm",right:"grt5ktjy",bottom:"jxacihee",left:"tukmaf4q",display:"p357zi0d",alignItems:"gndfcl4n",justifyContent:"ac2vgrno"},f={paddingTop:"fbgy3m38",paddingEnd:"bcymb0na",paddingBottom:"oq31bsqd",paddingStart:"e8k79tju",fontSize:"f8jlpxt4",color:"o4oavg8t",textTransform:"ofejerhi",backgroundColor:"o8fg3bdd",borderTop:"dl47i6rc",borderEnd:"pdo9fnbd",borderBottom:"n8n2xqzm",borderStart:"hqx4twni",borderTopStartRadius:"g1jn521u",borderTopEndRadius:"mrnekr2l",borderBottomEndRadius:"wu0i2wpa",borderBottomStartRadius:"bbs9k8l5"};function p(e){let{activeField:t,latitude:n,longitude:a,value:o}=e;const s="address"===(null==t?void 0:t.fieldKey)?(0,c.jsx)("div",{className:(0,i.default)(h),children:(0,c.jsx)("div",{className:(0,i.default)(f),children:r.fbt._("Edit map on mobile",null,{hk:"3AK8Fa"})})}):null;return(0,c.jsxs)("div",{style:{height:96},className:(0,i.default)(u),children:[s,(0,c.jsx)(l.default,{lat:n,lng:a,name:o,width:312,height:96})]})}},14124:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{businessHours:{note:t,timezone:n}}=e,[a,j]=(0,s.useState)(e.businessHours.mode||y),[b,E]=(0,s.useState)((()=>{const{days:t}=e.businessHours,n={};for(const{dayKey:e,closed:a,hours:r,dayName:i}of t)n[e]={closed:a,hours:r||[S()],dayKey:e,dayName:i};return n})),k=(e,t)=>{const n=b[e];E((0,i.default)((0,i.default)({},b),{},{[e]:(0,i.default)((0,i.default)({},n),t)}))},I=(e,t,n,a)=>{const r=[...e],i=n===C.START?0:1,o=[...r[a]];return o[i]=t,r[a]=o,r},w=e=>{let{dayKey:t}=e;return`${t}_business_hours`},T=e=>(0,x.jsx)("div",{className:l.default.timeWrapper,children:(0,x.jsx)(c.default,{"aria-label":o.fbt._("Add additional hours",null,{hk:"1RUQxq"}),label:o.fbt._("Add set of hours",null,{hk:"XYa8r"}),onClick:()=>{(e=>{const t=b[e],{hours:n}=t;k(e,{hours:[...n,S()]})})(e)},prefixIcon:"status-ciphertext",iconTheme:"padded-svg"})}),P=e=>(0,x.jsx)("div",{className:l.default.timeWrapper,children:(0,x.jsx)(m.default,{title:u.default.t(717),"aria-label":u.default.t(717),name:"x-alt",onClick:()=>{(e=>{const t=b[e],{hours:n}=t,a=[...n];a.pop(),k(e,{hours:a})})(e)}})}),M=e=>{const{closed:t,dayKey:n}=e,a=w(e);return(0,x.jsx)("div",{className:l.default.dayCheckbox,children:(0,x.jsx)(d.CheckBox,{id:a,checked:!t,onChange:()=>{const e=b[n];k(n,{closed:!e.closed})}})})},L=(e,t,n,a)=>{const r=(0,_.isValidTime)(t)?null:" ";return(0,x.jsx)("div",{className:l.default.timeWrapper,children:(0,x.jsx)(v.TextInput,{managed:!0,value:t,theme:"small",maxLength:15,customStyleThemes:["desaturated","noErrorInfo"],error:r,onChange:t=>{const r=b[e],{hours:i}=r;k(e,{hours:I(i,t,n,a)})},onBlur:()=>{((e,t,n)=>{const a=b[e],{hours:r}=a,i=t===C.START?0:1,o=r[n][i],s=(0,_.timeStringToMinutes)(o);void 0!==s&&k(e,{hours:I(r,(0,_.minutesToTime)(s),t,n)})})(e,n,a)}})},`${e}-${n}-${a}`)},O=e=>{const{closed:t}=e;let n;return t?n=o.fbt._("Closed",null,{hk:"3IRgct"}):a===f.BUSINESS_HOUR_MODES.APPOINTMENT_ONLY?n=o.fbt._("By appointment only",null,{hk:"e1vew"}):a===f.BUSINESS_HOUR_MODES.OPEN_24H&&(n=o.fbt._("Open 24 hours",null,{hk:"1AlfF5"})),n?(0,x.jsx)("div",{className:l.default.dayInfoText,children:n}):f.BUSINESS_HOUR_MODES.SPECIFIC_HOURS&&!e.closed?(e=>{let{dayKey:t,hours:n}=e;const a=[],r=n.length>=2?P(t):T(t);return n.forEach(((e,n)=>{let[r,i]=e;n>0&&a.push((0,x.jsx)("div",{className:l.default.hoursAnd,children:o.fbt._("and",null,{hk:"280Z25"})})),a.push(L(t,r,C.START,n),L(t,i,C.END,n))})),(0,x.jsxs)("div",{className:l.default.hoursMain,children:[a,r]})})(e):null},A=e=>{const{dayName:t}=e,n=w(e);return(0,x.jsxs)("div",{className:l.default.dayInfo,children:[(0,x.jsx)("label",{htmlFor:n,children:t}),O(e)]})},D=(()=>{const{businessHours:{days:t}}=e;return(0,x.jsxs)("div",{children:[(0,x.jsx)(g.default,{onSelect:e=>{j(e);const t={};if(a===f.BUSINESS_HOUR_MODES.OPEN_24H){for(const e of f.DAYS_OF_WEEK)t[e]=(0,i.default)((0,i.default)({},b[e]),{},{closed:!1});E(t)}},selectedId:a,tabConfigs:[{title:o.fbt._("Selected Hours",null,{hk:"1EI8CI"}),id:f.BUSINESS_HOUR_MODES.SPECIFIC_HOURS},{title:o.fbt._("Always Open",null,{hk:"W2gxH"}),id:f.BUSINESS_HOUR_MODES.OPEN_24H},{title:o.fbt._("By Appointment",null,{hk:"nN1q9"}),id:f.BUSINESS_HOUR_MODES.APPOINTMENT_ONLY}]}),(0,x.jsx)("div",{className:l.default.editMain,children:t.map((e=>{let{dayKey:t}=e;const n=b[t];return a=n,(0,x.jsxs)("div",{className:l.default.dayMain,children:[M(a),A(a)]},`day-${a.dayKey}`);var a}))})]})})();return(0,x.jsx)(p.default,{title:o.fbt._("Edit Business Hours",null,{hk:"2zl0Ai"}),isValid:(0,_.isValidBusinessHours)(a,b),doSave:(0,r.default)((function*(){(0,h.qplStartProfileSave)("bizHours"),yield e.saveBusinessProfile((0,_.convertToRawBusinessProfile)({mode:a,dayValues:b,note:t,timezone:n}))})),afterSave:e.afterSave,onCancel:e.onCancel,children:D})};var r=a(n(48926)),i=a(n(81109)),o=n(48360),s=n(67294),l=a(n(56246)),d=n(16593),c=a(n(72332)),u=a(n(43725)),h=n(82145),f=n(58313),p=a(n(34544)),m=a(n(38932)),g=a(n(38801)),v=n(90011),_=n(33572),x=n(85893);const C=n(76672).Mirrored(["START","END"]),y=f.BUSINESS_HOUR_MODES.SPECIFIC_HOURS,S=()=>[(0,_.minutesToTime)(540),(0,_.minutesToTime)(1080)]},58313:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"BUSINESS_HOUR_MODES",{enumerable:!0,get:function(){return r.BUSINESS_HOUR_MODES}}),Object.defineProperty(t,"DAYS_OF_WEEK",{enumerable:!0,get:function(){return r.DAYS_OF_WEEK}}),Object.defineProperty(t,"RawBusinessProfile",{enumerable:!0,get:function(){return a.RawBusinessProfile}});var a=n(97347),r=n(93170)},33572:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isValidTime=t.isValidBusinessHours=t.convertToRawBusinessProfile=void 0,Object.defineProperty(t,"minutesToTime",{enumerable:!0,get:function(){return r.minutesToTime}}),Object.defineProperty(t,"timeStringToMinutes",{enumerable:!0,get:function(){return r.timeStringToMinutes}});var a=n(58313),r=n(43390);const i=e=>void 0!==(0,r.timeStringToMinutes)(e);t.isValidTime=i;t.isValidBusinessHours=(e,t)=>{if(e===a.BUSINESS_HOUR_MODES.SPECIFIC_HOURS)for(const e in t){const n=t[e],{closed:a,hours:r}=n;if(!a)for(const[e,t]of r)if(!i(e)||!i(t))return!1}return!0};t.convertToRawBusinessProfile=e=>{let{mode:t,dayValues:n,note:i,timezone:o}=e;const s={};for(const e in n){const i=n[e],{closed:o,hours:l}=i;if(!o){const n={mode:t};t===a.BUSINESS_HOUR_MODES.SPECIFIC_HOURS&&(n.hours=l.map((e=>{let[t,n]=e;return[(0,r.timeStringToMinutes)(t)||0,(0,r.timeStringToMinutes)(n)||0]}))),s[e]=n}}return{businessHours:{config:s,note:i,timezone:o||Intl.DateTimeFormat().resolvedOptions().timeZone}}}},57597:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.BusinessProfileFormField=function(e){let{activeField:t,error:n,fieldKey:a,fieldMetric:c,formatForSave:u,lowProfile:h,originalValue:f,placeholder:p,rawBusinessProfile:m,sessionId:g,startActive:v,textFieldConfig:_,validate:x,value:C,onActive:y,onChange:S,onError:j,onSaveBusinessProfile:b,onCancel:E}=e;const k=(null==t?void 0:t.fieldKey)===a,I=C?void 0:p;return(0,d.jsx)(l.TextInput,(0,r.default)({value:C,editable:!t||k,pending:k&&(null==t?void 0:t.editType)===s.EditType.PENDING,showRemaining:!0,onBeginEdit:()=>{null!=g&&(0,i.logProfileFieldOpen)(c,m,g),y({fieldKey:a,editType:s.EditType.EDITING})},onChange:S,onSave:()=>{(0,o.qplStartProfileSave)(a),null!=g&&(0,i.logProfileFieldSave)(c,m,g),y({fieldKey:a,editType:s.EditType.PENDING}),b(u()).then((()=>{y()}),(()=>{y()}))},onCancel:()=>{null!=g&&(0,i.logProfileFieldDiscard)(c,m,g),S(f),y(),null==E||E()},lockable:!0,lowProfile:h,multiline:!0,inputPlaceholder:I,theme:"text-input",validate:x,onError:j,error:n,a8n:`biz-profile-${a}-input`,fieldName:p,startActive:v},_))};var r=a(n(81109)),i=n(30426),o=n(82145),s=(a(n(11339)),n(97347)),l=n(90011),d=n(85893)},70656:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const[t,n]=(0,d.useState)(e.initialCategories),[a,r]=(0,d.useState)(!1),[o,s]=(0,d.useState)(!1),[f,g]=(0,d.useState)([]),[v,_]=(0,d.useState)(""),j=()=>{m.Cmd.openToast((0,k.jsx)(b.Toast,{id:(0,b.genId)(),msg:l.fbt._('You cannot select categories when you have selected "Not a Business"',null,{hk:"12A4L0"})}))},E=e=>{for(let n=0;n<t.length;n++)if(t[n].id===e)return!0;return!1},I=e=>{const a=t.find((e=>e.id===v));let r=t;t.length>0&&(e.not_a_biz&&!a?(r=[],j()):!e.not_a_biz&&a&&(r=t.filter((e=>e.id!==a.id)),j())),E(e.id)?n(r.filter((t=>t.id!==e.id))):n([...r,e])},w=t=>{s(!0),e.searchCategories(t||c.BUSINESS_CATEGORY_EMPTY_STR_ID).then((e=>{let n=e.categories;""!==t&&(n=n.filter((e=>!e.not_a_biz))),s(!1),g(n),_(e.notABizId),(0,C.qplAnnotateProfileCatsView)(n.length),(0,C.qplEndProfileCatsView)(y.QuickLogActionType.SUCCESS)})).catch((()=>{m.Cmd.openToast((0,k.jsx)(b.Toast,{id:(0,b.genId)(),msg:l.fbt._("Something went wrong.",null,{hk:"2Cx5Nt"})})),s(!1),g([]),_(""),(0,C.qplEndProfileCatsView)(y.QuickLogActionType.FAIL)}))};return(0,d.useEffect)((()=>{w("")}),[]),(0,k.jsxs)(S.default,{title:l.fbt._("Choose up to three categories",null,{hk:"17Tmht"}),isValid:t.length>0,doSave:(0,i.default)((function*(){(0,C.qplStartProfileSave)("categories"),yield e.saveBusinessProfile({categories:t})})),afterSave:()=>{r(!0),e.afterSave()},onCancel:()=>{r(!0),e.onCancel()},children:[(0,k.jsx)("div",{className:h.default.searchBackground,children:(0,k.jsx)(x.default,{onSearch:e=>{o||a||((0,C.qplStartProfileCatsView)("Search"),w(e))},placeholder:l.fbt._("Search categories",null,{hk:"4zfNoj"})})}),(0,k.jsxs)("div",{className:h.default.editMain,children:[(0,k.jsx)("div",{className:h.default.list,children:(0,k.jsx)(T,{isLoading:o,results:f,isSelected:E,isDisabled:e=>!e.not_a_biz&&!E(e.id)&&t.length>=u.MAX_BUSINESS_CATEGORIES,toggleResultById:e=>{const t=f.filter((t=>t.id===e))[0];t&&I(t)}})}),t&&(0,k.jsx)(p.default,{categories:t,onRemoveItem:e=>{const n=t.filter((t=>t.id===e))[0];n&&I(n)}})]})]})};var r=a(n(81109)),i=a(n(48926)),o=a(n(99964)),s=a(n(94184)),l=n(48360),d=n(67294),c=n(32742),u=n(48018),h=a(n(4830)),f=n(16593),p=a(n(98001)),m=n(88102),g=n(47915),v=a(n(44942)),_=a(n(30855)),x=a(n(48837)),C=n(82145),y=n(48870),S=a(n(34544)),j=n(11054),b=n(50452),E=a(n(59552)),k=n(85893);function I(e){let{category:t,toggleResultById:n}=e;return(0,k.jsxs)("div",{className:h.default.rowMain,children:[(0,k.jsx)("div",{className:h.default.rowCheckbox,children:(0,k.jsx)(f.CheckBox,{id:`${t.id}`,onChange:()=>{!t.disabled&&n(t.id)},checked:t.selected,disabled:t.disabled})}),(0,k.jsx)("label",{"data-a8n":o.default.key("category-list-item"),className:(0,s.default)(h.default.rowLabel,{[h.default.disabled]:t.disabled}),htmlFor:t.id,children:t.localized_display_name})]})}function w(e){let{label:t}=e;return(0,k.jsxs)("div",{className:h.default.rowMain,children:[(0,k.jsx)("div",{className:h.default.rowCheckbox}),t]})}function T(e){let{isLoading:t,results:n,isSelected:a,isDisabled:i,toggleResultById:o}=e;const s=(0,E.default)((()=>new _.default));if(t)return(0,k.jsx)("div",{className:h.default.loadingSpinner,children:(0,k.jsx)(j.Spinner,{color:"highlight",size:44,stroke:6})});if(!n||0===n.length)return(0,k.jsx)(w,{label:l.fbt._("No categories found",null,{hk:"2xfbJX"})});const d=n.map((e=>(0,r.default)((0,r.default)({},e),{},{id:e.id,itemKey:e.id.toString(),disabled:i(e),selected:a(e.id)})));return(0,k.jsx)(v.default,{flatListControllers:[s.current],children:(0,k.jsx)(g.FlatList,{data:d,flatListController:s.current,direction:"vertical",renderItem:e=>(0,k.jsx)(I,{category:e,toggleResultById:o}),defaultItemHeight:48})})}},30923:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(n(81109)),i=a(n(99964)),o=n(28298),s=n(48360),l=n(67294),d=a(n(56720)),c=n(79686),u=n(3754),h=a(n(22635)),f=a(n(14124)),p=n(57597),m=n(93170),g=a(n(70656)),v=n(88102),_=n(72549),x=a(n(33308)),C=a(n(73308)),y=n(99234),S=n(57701),j=n(84287),b=a(n(43725)),E=n(30426),k=n(82145),I=a(n(11339)),w=(n(97347),n(58170)),T=n(2541),P=n(85832),M=n(85893);const L={color:"ky3f94nk",fontSize:"f8jlpxt4",textTransform:"ofejerhi"},O={flexGrow:"gj6qtt9u",flexShrink:"m0h2a7mj",flexBasis:"rjo8vgbg",textTransform:"aprpv14t"},A={display:"p357zi0d"},D={flexGrow:"a6lcuizr",flexShrink:"m0h2a7mj",flexBasis:"rjo8vgbg"},R={color:"t35qvd06",fontSize:"dsh4tgtl",lineHeight:"jgi8eev7",marginTop:"dkeqio29"};t.default=e=>{let{businessProfile:t,saveBusinessProfile:n,sessionId:a,verifiedName:N}=e;const[F,B]=(0,l.useState)(),[U,H]=(0,l.useState)(),[G,W]=(0,l.useState)(),[V,z]=(0,l.useState)(),[q,K]=(0,l.useState)(),[Y,Q]=(0,l.useState)(),[X,Z]=(0,l.useState)(),[J,$]=(0,l.useState)(),[ee,te]=(0,l.useState)(),[ne,ae]=(0,l.useState)(!1),re=(0,y.getMeUser)(),ie=(0,S.canSeeECommerceComplianceIndiaHardEnforcementBusinessJourney)(re.user),[oe,se]=(0,l.useState)();(0,l.useEffect)((()=>{const e=(0,w.convertRawBusinessProfile)(t);B(e.description),W(e.email),H(e.address),z(e.primaryWebsite),K(e.secondaryWebsite),Q(Boolean(e.primaryWebsite&&!e.secondaryWebsite))}),[t]),(0,l.useEffect)((()=>{(0,P.validateEmail)(G)&&Z(null)}),[G]),(0,l.useEffect)((()=>{(0,P.validateURL)(V)&&$(null)}),[V]),(0,l.useEffect)((()=>{(0,P.validateURL)(q)&&te(null)}),[q]);const le=()=>{const e=[];return V&&e.push(V),q&&e.push(q),{website:e.map(((e,t)=>{if(!T.URL.isHttps(e)&&!T.URL.isHttp(e)){const n=`https://${e}`;return 0===t?z(n):K(n),n}return e}))}},de=e=>(0,M.jsx)(j.IconSection,(0,r.default)((0,r.default)({},e),{},{hideEditIcon:Boolean(oe)})),ce=(e,t,n)=>{if(t)return s.fbt._("Closed",null,{hk:"3IRgct"});switch(e){case m.BUSINESS_HOUR_MODES.SPECIFIC_HOURS:return(0,M.jsx)(M.Fragment,{children:n&&n.map(((e,t)=>{let[n,a]=e;return(0,M.jsxs)("div",{className:(0,d.default)(0!==t&&o.uiMargin.top16),"data-a8n":i.default.key("business-hours-time"),children:[n," - ",a]},t)}))});case m.BUSINESS_HOUR_MODES.APPOINTMENT_ONLY:return s.fbt._("By appointment only",null,{hk:"e1vew"});case m.BUSINESS_HOUR_MODES.OPEN_24H:return s.fbt._("Open 24 hours",null,{hk:"1AlfF5"});default:return null}},ue=(0,l.useCallback)((()=>ie?(0,h.default)():void 0),[ie]),he=(0,w.convertRawBusinessProfile)(t);let fe,pe=s.fbt._("Business Information",null,{hk:"36RGyI"});return(0,S.canSeeBizProfileV3)()&&(pe=null,fe=C.default.noPaddingTop),(0,M.jsxs)(x.default,{title:pe,theme:"refresh",className:fe,children:[(e=>{if(!e)return null;const t=(0,S.canSeeBizProfileV3)()?j.IconSectionTheme.NoMargin:void 0;return de({theme:t,icon:"account-box",iconClass:C.default.verifiedNameIcon,content:(0,M.jsxs)("div",{children:[(0,M.jsx)("div",{children:e}),(0,M.jsx)("div",{className:(0,d.default)(R),children:s.fbt._("This name will be visible to your WhatsApp customers and can be edited from the app on your mobile device.",null,{hk:"1y9lc"})})]})})})(N),de({icon:"business-description",content:(0,M.jsx)(p.BusinessProfileFormField,{activeField:oe,fieldKey:"description",fieldMetric:I.default.BUSINESS_PROFILE_FIELD.DESCRIPTION,formatForSave:()=>({description:F}),lowProfile:!0,originalValue:he.description,placeholder:s.fbt._("Business Description",null,{hk:"2Q2DP8"}),rawBusinessProfile:t,sessionId:a,textFieldConfig:{maxLength:m.BUSINESS_PROFILE_FIELDS_LENGTH.DESCRIPTION,supportsEmoji:!0},value:F,onActive:se,onChange:B,onSaveBusinessProfile:n})}),de({icon:"business-category",type:"container",emptyText:s.fbt._("Categories",null,{hk:"2YgYDL"}),content:(me=he.categories,0===me.length?null:(0,M.jsx)("div",{"data-a8n":i.default.key("biz-profile-category-input"),children:me.map((e=>e.localized_display_name)).join(b.default.t(407))})),fieldName:s.fbt._("Categories",null,{hk:"2YgYDL"}),onEdit:()=>{(0,k.qplStartProfileCatsView)("Profile"),(0,E.logProfileFieldOpen)(I.default.BUSINESS_PROFILE_FIELD.CATEGORY,t,a),v.Cmd.openModal((0,M.jsx)(g.default,{initialCategories:he.categories,saveBusinessProfile:n,searchCategories:e=>u.BusinessCategoriesResultCollection.find(e),afterSave:()=>(0,E.logProfileFieldSave)(I.default.BUSINESS_PROFILE_FIELD.CATEGORY,t,a),onCancel:()=>{(0,E.logProfileFieldDiscard)(I.default.BUSINESS_PROFILE_FIELD.CATEGORY,t,a)}}))}}),de({icon:"business-address",content:(0,M.jsx)(c.BusinessAddressField,{businessProfile:he,activeField:oe,rawBusinessProfile:t,sessionId:a,value:U,onActive:se,onChange:H,onSaveBusinessProfile:n,validate:e=>(0,_.existsField)(e,re),onError:ue})}),de({icon:"business-hours",type:"container",emptyText:s.fbt._("Business Hours",null,{hk:"1bV20v"}),content:(e=>{let{mode:t,days:n}=e;return null==t?null:(0,M.jsx)("div",{children:n.map(((e,n)=>{let{dayName:a,dayKey:r,closed:s,hours:l}=e;return(0,M.jsxs)("div",{className:(0,d.default)(A,0!==n&&o.uiMargin.top28),"data-a8n":i.default.key("business-hours-section-row"),children:[(0,M.jsx)("div",{className:(0,d.default)(O),children:a}),(0,M.jsx)("div",{className:(0,d.default)(D),children:ce(t,s,l)})]},r)}))})})(he.hours),fieldName:s.fbt._("Business Hours",null,{hk:"1bV20v"}),onEdit:()=>{(0,E.logProfileFieldOpen)(I.default.BUSINESS_PROFILE_FIELD.HOURS,t,a),v.Cmd.openModal((0,M.jsx)(f.default,{businessHours:he.hours,saveBusinessProfile:n,onCancel:()=>{(0,E.logProfileFieldDiscard)(I.default.BUSINESS_PROFILE_FIELD.HOURS,t,a)},afterSave:()=>(0,E.logProfileFieldSave)(I.default.BUSINESS_PROFILE_FIELD.HOURS,t,a)}))}}),de({icon:"business-email",content:(0,M.jsx)(p.BusinessProfileFormField,{activeField:oe,error:X,fieldKey:"email",fieldMetric:I.default.BUSINESS_PROFILE_FIELD.EMAIL,formatForSave:()=>({email:G}),lowProfile:!1,originalValue:he.email,placeholder:s.fbt._("Email Address",null,{hk:"5tSKT"}),rawBusinessProfile:t,sessionId:a,textFieldConfig:{maxLength:m.BUSINESS_PROFILE_FIELDS_LENGTH.EMAIL},validate:e=>(0,P.validateEmail)(e),value:G,onActive:se,onChange:W,onError:()=>{Z(s.fbt._("Incorrect email address format",null,{hk:"1KuwvT"}))},onSaveBusinessProfile:n})}),(e=>{const r=(0,M.jsx)(p.BusinessProfileFormField,{activeField:oe,error:J,fieldKey:"primaryWebsite",fieldMetric:I.default.BUSINESS_PROFILE_FIELD.WEBSITE,formatForSave:le,lowProfile:!1,originalValue:e.primaryWebsite,placeholder:s.fbt._("Website",null,{hk:"2HRvqj"}),rawBusinessProfile:t,sessionId:a,textFieldConfig:{maxLength:m.BUSINESS_PROFILE_FIELDS_LENGTH.WEBSITE},validate:P.validateURL,value:V,onActive:se,onChange:z,onError:()=>{$(s.fbt._("URL is incorrect",null,{hk:"xiOtm"}))},onSaveBusinessProfile:n});return de({icon:"business-website",theme:j.IconSectionTheme.SmallMargin,content:(0,M.jsx)("div",{children:r})})})(he),(e=>{if(!e.primaryWebsite)return null;if(q||!Y){const r=(0,M.jsx)(p.BusinessProfileFormField,{activeField:oe,error:ee,fieldKey:"secondaryWebsite",fieldMetric:I.default.BUSINESS_PROFILE_FIELD.WEBSITE,formatForSave:le,lowProfile:!1,originalValue:e.secondaryWebsite,placeholder:s.fbt._("Website",null,{hk:"2HRvqj"}),rawBusinessProfile:t,sessionId:a,startActive:ne,textFieldConfig:{maxLength:m.BUSINESS_PROFILE_FIELDS_LENGTH.WEBSITE},validate:P.validateURL,value:q,onActive:se,onChange:K,onError:()=>{te(s.fbt._("URL is incorrect",null,{hk:"xiOtm"}))},onSaveBusinessProfile:n});return de({icon:"business-website",theme:j.IconSectionTheme.NoMargin,content:(0,M.jsx)("div",{children:r})})}const r=(0,M.jsx)("button",{className:(0,d.default)(L),onClick:()=>{Q(!1),ae(!0)},children:s.fbt._("Add another website",null,{hk:"1HOyZt"})});return de({theme:j.IconSectionTheme.NoMargin,content:(0,M.jsx)("div",{children:r})})})(he)]});var me}},44281:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){const[e,t]=(0,o.useState)(x.LoadType.PENDING),[n,a]=(0,o.useState)(),s=(0,o.useRef)(Math.floor(2147483648*Math.random()).toString()),m=function(){var e=(0,r.default)((function*(){t(x.LoadType.PENDING);try{const e=yield E();a(e),t(x.LoadType.DONE),(0,v.logProfileOpen)(e,s.current)}catch(e){t(x.LoadType.ERROR)}}));return function(){return e.apply(this,arguments)}}();if((0,o.useEffect)((()=>{m()}),[]),e===x.LoadType.PENDING)return(0,j.jsx)("div",{className:f.default.loadingSpinner,children:(0,j.jsx)(y.Spinner,{color:"default",size:24,stroke:6})});if(e===x.LoadType.ERROR)return(0,j.jsx)(u.default,{title:i.fbt._("Business Information",null,{hk:"36RGyI"}),theme:"refresh",children:(0,j.jsxs)(p.FlexRow,{align:"center",justify:"center",children:[(0,j.jsx)(p.FlexItem,{children:g.default.t(250)}),(0,j.jsx)(p.FlexItem,{xstyle:b.retryButton,children:(0,j.jsx)(d.default,{onClick:()=>{m()},type:"simplified",children:i.fbt._("Retry",null,{hk:"2jS9Tg"})})})]})});if(e===x.LoadType.DONE&&n)return(0,j.jsx)(h.default,{verifiedName:c.Conn.pushname||void 0,sessionId:s.current,businessProfile:n,saveBusinessProfile:function(){var e=(0,r.default)((function*(e){try{yield(0,l.editBusinessProfile)(e)}catch(e){throw(0,S.showError)(g.default.t(251)),(0,_.qplEndProfileSave)(C.QuickLogActionType.FAIL),__LOG__(3,void 0,void 0,!0)`business_profile:edit_form save failed`,SEND_LOGS(`businessProfile edit handled server error - ${e.status}`),e}try{const e=yield k();return a(e),(0,_.qplEndProfileSave)(C.QuickLogActionType.SUCCESS),e}catch(e){throw(0,S.showError)(g.default.t(250)),(0,_.qplEndProfileSave)(C.QuickLogActionType.FAIL),e}}));return function(){return e.apply(this,arguments)}}()});return null};var r=a(n(48926)),i=n(48360),o=n(67294),s=(a(n(56720)),n(93581)),l=n(33866),d=a(n(39770)),c=n(17239),u=a(n(33308)),h=a(n(30923)),f=a(n(12923)),p=n(29623),m=n(99234),g=a(n(43725)),v=n(30426),_=n(82145),x=n(97347),C=n(48870),y=n(11054),S=n(29283),j=n(85893);const b={retryButton:{height:"epwkujcx",marginStart:"nzcjdldu"}},E=function(){var e=(0,r.default)((function*(){const e=(0,m.getMeUser)(),t=s.BusinessProfileCollection.get(e);t&&t.markStale();return(yield s.BusinessProfileCollection.find(e)).serialize()}));return function(){return e.apply(this,arguments)}}(),k=function(){var e=(0,r.default)((function*(){const e=(0,m.getMeUser)(),t=yield s.BusinessProfileCollection.update(e);return(Array.isArray(t)?t[0]:t).serialize()}));return function(){return e.apply(this,arguments)}}()},30426:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.getProfilePopulatedFields=o,t.logProfileFieldDiscard=function(e,t,n){const a=new i.default.EditBusinessProfile((0,r.default)({editProfileAction:i.default.EDIT_PROFILE_ACTION.ACTION_PROFILE_FIELD_DISCARD,businessProfileEntryPoint:i.default.BUSINESS_PROFILE_ENTRY_POINT.SETTINGS,editProfileActionField:e,editBusinessProfileSessionId:n},o(t)));a&&a.commit()},t.logProfileFieldOpen=function(e,t,n){const a=new i.default.EditBusinessProfile((0,r.default)({editProfileAction:i.default.EDIT_PROFILE_ACTION.ACTION_PROFILE_FIELD_OPEN,businessProfileEntryPoint:i.default.BUSINESS_PROFILE_ENTRY_POINT.SETTINGS,editProfileActionField:e,editBusinessProfileSessionId:n},o(t)));a&&a.commit()},t.logProfileFieldSave=function(e,t,n){const a=new i.default.EditBusinessProfile((0,r.default)({editProfileAction:i.default.EDIT_PROFILE_ACTION.ACTION_PROFILE_FIELD_SAVE,businessProfileEntryPoint:i.default.BUSINESS_PROFILE_ENTRY_POINT.SETTINGS,editProfileActionField:e,editBusinessProfileSessionId:n},o(t)));a&&a.commit()},t.logProfileOpen=function(e,t){const n=new i.default.EditBusinessProfile((0,r.default)({editProfileAction:i.default.EDIT_PROFILE_ACTION.ACTION_OPEN,businessProfileEntryPoint:i.default.BUSINESS_PROFILE_ENTRY_POINT.SETTINGS,editBusinessProfileSessionId:t},o(e)));n&&n.commit()};var r=a(n(81109)),i=a(n(11339));function o(e){var t;return{hasDescription:null!=e.description,hasCategory:!!(e.categories&&e.categories.length>0),hasHours:null!=(null===(t=e.businessHours)||void 0===t?void 0:t.config),hasEmail:null!=e.email,hasAddress:null!=e.address,hasWebsite:null!=e.website}}},97347:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"EditType",{enumerable:!0,get:function(){return a.EditType}}),Object.defineProperty(t,"LoadType",{enumerable:!0,get:function(){return a.LoadType}});var a=n(43560)},58170:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.convertRawBusinessProfile=void 0;var a=n(43390);t.convertRawBusinessProfile=e=>{const{description:t,email:n,address:r,website:i,categories:o,businessHours:s,latitude:l,longitude:d}=e,[c,u]=i||[];return{description:t,email:n,address:r,primaryWebsite:c,secondaryWebsite:u,hours:(0,a.getBusinessHoursForEdit)(s),categories:o||[],latitude:l,longitude:d}}},29283:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.showError=void 0;var a=n(88102),r=n(50452),i=n(85893);t.showError=e=>{a.Cmd.openToast((0,i.jsx)(r.Toast,{msg:e,duration:6e3,id:(0,r.genId)()}))}},44189:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.CartDetailDrawer=function(e){const{onBack:t,sellerJid:n,chat:a,closeDrawerRightOnSend:z,onProductCatalog:q,onProductDetail:K,isPushed:Y=!0}=e,Q=(0,d.useContext)(S.DrawerContext),X=(0,d.useMemo)((()=>f.CartCollection.findCart(n)),[n]),Z=(0,d.useRef)(null),J=(0,d.useRef)(null),$=(0,H.default)((()=>new i.PromiseQueue)),ee=(0,H.default)((()=>new b.default)),[te,ne]=(0,d.useState)(!0),[ae,re]=(0,d.useState)(void 0),[ie,oe]=(0,d.useState)([]),[se,le]=(0,d.useState)(X.message),de=function(){var e=(0,r.default)((function*(e){const[t,n]=yield Promise.all([e?(0,O.default)(X,Y):Promise.resolve(),c.BusinessProfileCollection.find(a.id)]);t&&(J.current=t);const r=(0,P.matchCartItemsToProducts)(X,J.current);ne(!1),re(n),oe(r)}));return function(){return e.apply(this,arguments)}}();(0,G.useListener)(X,"change:cartItemCollection",(()=>{$.current.enqueue((()=>de()))})),(0,d.useEffect)((()=>{let e=!0;Y&&(0,T.qplAnnotateCartView)(X.id.toString()!==n,X.itemCount),de(!0,Y).then((()=>{e=!1,Y&&(0,T.qplEndCartView)(A.QuickLogActionType.SUCCESS),(0,w.logCartListImpression)(X.id.toString(),(0,L.getProductCatalogContext)(Q))})).catch((()=>{__LOG__(4,!0,new Error,!0)`Unable to open the cart`,SEND_LOGS("openCart: failed to open the cart"),(0,R.default)(),(0,g.default)(X)})).finally((()=>{e&&Y&&(0,T.qplEndCartView)(A.QuickLogActionType.FAIL),ne(!1)}))}),[]);const ce=()=>{ne(!0),(0,T.qplStartOrderCreate)(ie.length),(0,N.default)(X,a).then((e=>{const n=Boolean(X.message);(0,I.logSendOrderMessage)({orderId:e,catalogOwnerJid:X.id,catalogContext:(0,L.getProductCatalogContext)(Q),isOrderMsgAttached:n,quantity:X.itemCount}),t(),(0,g.default)(X),X.message=void 0,z&&v.Cmd.existsDrawerRight((e=>{e&&v.Cmd.closeDrawerRight()})),(0,T.qplEndOrderCreate)(A.QuickLogActionType.SUCCESS)})).catch((()=>{__LOG__(4,!0,new Error,!0)`Unable to create catalog order`,SEND_LOGS("submitOrder: order creation or order message send error"),(0,R.default)(),de(!0),(0,T.qplEndOrderCreate)(A.QuickLogActionType.FAIL)})).finally((()=>{ne(!1)}))},ue=e=>{le(e),(0,U.default)(X,e)},he=()=>{v.Cmd.openModal((0,V.jsx)(_.default,{title:l.fbt._("Message Too Long",null,{hk:"3CMbLA"}),onOK:()=>{v.Cmd.closeModal()},okText:l.fbt._("OK",null,{hk:"2KEeHb"}),children:l.fbt._("The message you’re pasting is too long. Try shortening it or sending it as a separate message.",null,{hk:"9VR0L"})}))};return(0,V.jsxs)(C.default,{onDrop:t,theme:"striped",children:[(0,V.jsx)(j.DrawerHeader,{title:l.fbt._("Your cart",null,{hk:"Sn66V"}),type:j.DRAWER_HEADER_TYPE.SMALL,onBack:t}),(0,V.jsx)(y.default,{flatListControllers:[ee.current],children:(()=>{if(te)return(0,V.jsx)(E.default,{});const e=X.itemCount,t=e>0;let r,i;if(t){const t=k.default.t(551,{count:e,_plural:e});r=(0,V.jsx)(B.TextDiv,{theme:"title",children:t})}null!=X.total&&null!=X.currency?i=(0,V.jsx)(B.TextDiv,{theme:"muted-small",children:k.default.t(697,{subtotal:x.formatAmount1000(X.currency,X.total)})}):e>0&&(i=(0,V.jsx)(B.TextDiv,{theme:"muted-small",children:l.fbt._("Ask for total",null,{hk:"3qm9mR"})}));const d=(0,V.jsx)(W.default,{transitionName:"media-caption",className:p.default.cartMessage,children:(0,V.jsx)(M.default,{ref:Z,chat:a,maxLength:s.default.MAX_CART_MESSAGE_LENGTH,multiline:!0,onEnter:ce,onChange:ue,onMaxPasteExceeded:he,placeholder:l.fbt._("Add a message",null,{hk:"4drJT1"}),showRemaining:!0,spellCheck:!0,supportsEmoji:!0,value:se})}),c=(0,V.jsx)("button",{"data-a8n":o.default.key("cart-send-button"),className:p.default.btnSend,tabIndex:"-1",onClick:ce,title:l.fbt._("Send a cart",null,{hk:"37qP8u"}),children:(0,V.jsx)(D.Round,{large:!0,children:(0,V.jsx)(F.default,{name:"send",directional:!0})})});return(0,V.jsxs)(V.Fragment,{children:[!t&&(0,V.jsxs)("div",{className:p.default.emptyCartContainer,children:[(0,V.jsx)(F.default,{name:"shopping-cart-empty"}),(0,V.jsx)(B.TextDiv,{className:p.default.emptyCardHeader,theme:"large",children:l.fbt._("Add items to your cart",null,{hk:"411bLF"})}),(0,V.jsx)(B.TextDiv,{className:p.default.emptyCardText,theme:"plain",children:l.fbt._("Collect all the items you're interested in here and then send them to the business. Use your cart to ask about buying, customizing, delivery, or anything you want.",null,{hk:"2L1JTk"})}),(0,u.hasCatalog)(ae)&&(0,V.jsx)(h.default,{onClick:q,type:"primary",children:l.fbt._("View catalog",null,{hk:"1bDXja"})})]}),(0,V.jsxs)("div",{className:p.default.info,children:[r,i]}),(0,V.jsx)(m.default,{flatListController:ee.current,onProductDetail:K,cart:X,sellerJid:n,cartProductItems:ie}),t&&(0,V.jsxs)("div",{className:p.default.footer,children:[d,(0,V.jsx)(W.default,{transitionAppear:!0,transitionName:"btn",children:c})]})]})})()})]})};var r=a(n(48926)),i=n(27870),o=a(n(99964)),s=a(n(64369)),l=n(48360),d=n(67294),c=n(93581),u=n(94010),h=a(n(39770)),f=n(12392),p=a(n(32976)),m=a(n(38778)),g=a(n(74220)),v=n(88102),_=a(n(52665)),x=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=z(t);if(n&&n.has(e))return n.get(e);var a={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var o=r?Object.getOwnPropertyDescriptor(e,i):null;o&&(o.get||o.set)?Object.defineProperty(a,i,o):a[i]=e[i]}a.default=e,n&&n.set(e,a);return a}(n(74764)),C=a(n(60453)),y=a(n(69637)),S=n(27394),j=n(94790),b=a(n(30855)),E=a(n(29796)),k=a(n(43725)),I=n(79544),w=n(88571),T=n(82145),P=n(79495),M=a(n(3028)),L=n(97567),O=a(n(9186)),A=n(48870),D=n(82857),R=a(n(50247)),N=a(n(53109)),F=a(n(23217)),B=n(13923),U=a(n(51383)),H=a(n(59552)),G=n(19529),W=a(n(41956)),V=n(85893);function z(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(z=function(e){return e?n:t})(e)}},38778:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{cartProductItems:t,onProductDetail:n,sellerJid:a}=e;return(0,d.jsx)(l.default,{flatListControllers:[e.flatListController],children:(0,d.jsx)(s.FlatList,{flatListController:e.flatListController,direction:"vertical",forceConsistentRenderCount:!1,data:t.map((e=>({itemKey:e.cartItem.id,contentKey:(0,r.default)("cartItem"),product:e.product,cartItem:e.cartItem}))),renderItem:e=>{const t={productId:e.cartItem.id,businessOwnerJid:a};return(0,d.jsx)(i.default,{cartId:a,product:e.product,quantity:e.cartItem.quantity,onClick:()=>n(t)})},defaultItemHeight:o.PRODUCT_LIST_ITEM_HEIGHT})})};var r=a(n(73955)),i=a(n(30068)),o=n(64481),s=n(47915),l=a(n(44942)),d=n(85893)},30068:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t;const{product:n,onClick:a}=e,_=(0,v.jsx)(u.EmojiText,{text:n.name,ellipsify:!0,titlify:!0}),x=null===(t=n.getPreviewImage())||void 0===t?void 0:t.mediaData;let C;C=x?(0,v.jsx)(m.ProductThumb,{theme:"list",mediaData:x}):(0,v.jsx)(v.Fragment,{});const y=(0,v.jsx)(p.default,{className:i.default.price,product:n,fallback:r.fbt._("Ask for price",null,{hk:"2Rtbeg"})});return(0,v.jsx)(s.default,{image:C,customImage:!0,primary:_,secondary:y,theme:"cart-product",onClick:a,detail:(0,v.jsx)(c.DrawerContext.Consumer,{children:t=>(0,v.jsxs)("div",{className:i.default.actions,children:[(0,v.jsx)(o.default,{quantity:e.quantity,onChange:n=>function(t,n){const{cartId:a,product:r}=e;(0,g.default)(a,r,t),(0,h.logEditProduct)(r,n,t)}(n,(0,f.getProductCatalogContext)(t))}),(0,v.jsx)("div",{className:i.default.deleteIcon,children:(0,v.jsx)(l.default,{onClick:n=>function(t,n){const{cartId:a,product:r}=e,i=(0,d.default)(a,r.id.toString());(0,d.default)(a,r.id.toString()),(0,h.logDeleteProduct)(r,n),0===i&&(0,h.logCartAbandon)(r.catalogWid.toString(),n),function(e){e.preventDefault(),e.stopPropagation()}(t)}(n,(0,f.getProductCatalogContext)(t))})})]})}),className:i.default.cartListItem},n.id.toString())};var r=n(48360),i=a(n(10476)),o=a(n(39864)),s=a(n(44356)),l=a(n(52814)),d=a(n(72921)),c=n(27394),u=n(65417),h=n(88571),f=n(97567),p=a(n(62089)),m=n(3013),g=a(n(85566)),v=n(85893)},26383:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{label:t,label:n}=e,a=(0,c.default)();(0,u.useListener)(l.LabelCollection,`label_updated_${n}`,(()=>{a()}));const f=l.LabelCollection.get(t);if(!f||!f.name)return null;if("label-list"===e.theme){const n=(0,h.jsx)(d.Labels,{renderAsCircle:"label-list"===e.theme,theme:e.theme,labels:[t]}),a=(0,h.jsx)(i.EmojiText,{text:f.name,ellipsify:!0,titlify:!0});return(0,h.jsx)(r.default,{theme:(0,o.canEditLabel)()?"chat-checkbox":void 0,image:n,primary:a,secondary:s.default.t(551,{count:parseInt(f.count||0,10),_plural:parseInt(f.count||0,10)})})}const p=(0,d.renderLabelSvg)(f.hexColor),m=(0,h.jsx)(i.EmojiText,{text:f.name,ellipsify:!0,titlify:!0});return(0,h.jsx)(r.default,{theme:"label-selection",image:p,primary:m})};var r=a(n(44356)),i=n(65417),o=n(57701),s=a(n(43725)),l=n(16770),d=n(84543),c=a(n(59909)),u=n(19529),h=n(85893)},67901:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{shouldScrollIntoViewAndSelect:t,selectedLabels:n,onMultiSelect:a,renderContext:i,onLabelClick:s,initialLabelState:d={}}=e,[p,m]=(0,r.useState)((()=>l.LabelCollection.toArray())),g=(0,r.useRef)(null),v=(e,t,r)=>{null==n||n.setVal(e,t,r),null==a||a(e.id)};(0,u.useListener)(l.LabelCollection,"add remove",((e,n,a)=>{if(m(l.LabelCollection.toArray()),a.add&&t){var r;const{shouldScrollIntoView:n,shouldSelect:a}=t(e.name);n&&(null===(r=g.current)||void 0===r||r.scrollIntoView({behavior:"smooth"})),a&&v(e,!0,!1)}}));const _=(0,r.useMemo)((()=>o.GK.supportsFeature(o.GK.F.MD_BACKEND)?[...p].sort(((e,t)=>{const n=parseInt(e.id,10),a=parseInt(t.id,10);return isNaN(n)||isNaN(a)?0:n-a})):p),[p]);return(0,h.jsx)("div",{children:_.map(((t,a)=>(0,h.jsx)(f,{selectedLabels:n,renderContext:i,onLabelClick:s,initialLabelState:d,onMultiSelect:v,label:t,selectableState:e.SelectableState||new c.default(!0),onRef:e=>{a===p.length-1&&(g.current=e)}},t.id)))})};var r=n(67294),i=a(n(61837)),o=n(7293),s=n(57701),l=n(16770),d=a(n(26383)),c=a(n(49905)),u=n(19529),h=n(85893);function f(e){let{label:t,selectedLabels:n,renderContext:a,onLabelClick:r,initialLabelState:o,onMultiSelect:c,selectableState:u,onRef:f}=e;if(!t.name)return null;const p=l.LabelCollection.assertGet(t.id),m="label-selection"===a||(0,s.canEditLabel)()?(0,h.jsx)(i.default,{theme:a,model:p,initialSelection:o[t.id]||0,multiSelection:n,selectableState:u,onSelect:c,children:(0,h.jsx)(d.default,{label:t.id})}):(0,h.jsx)(d.default,{label:t.id,theme:a});return(0,h.jsx)("div",{ref:f,onClick:r?r.bind(null,t.id):void 0,children:m},`label_item_${t.id}`)}},77338:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{userIsCartOwner:t,orderId:n,token:a,sellerJid:R,onProductDetail:F,onOrderCreate:B,ownerHasReviewed:U,chat:H,orderMessage:G,onOrderCancel:W,isPushed:V=!0}=e,[z,q]=(0,d.useState)(!0),[K,Y]=(0,d.useState)("PENDING"),[Q,X]=(0,d.useState)(null),[Z,J]=(0,d.useState)(""),$=(0,O.default)((()=>new y.default));(0,d.useEffect)((()=>{I.OrderCollection.findOrder(n,R,a).then((e=>{q(!1),Y("SUCCESS"),X(e),V&&((0,E.qplAnnotateOrderView)((null==e?void 0:e.products.length)||0),(0,E.qplEndOrderView)(P.QuickLogActionType.SUCCESS))})).catch((0,r.filteredCatch)(A.E404,(()=>{h.Cmd.openModal((0,D.jsx)(f.default,{onOK:()=>{h.Cmd.closeModal()},okText:l.fbt._("OK",null,{hk:"2KEeHb"}),children:l.fbt._("The seller has deleted your sent cart. Contact the seller for more information.",null,{hk:"3f21OJ"})})),q(!1),Y("ERROR"),(0,E.qplDropOrderView)()}))).catch((()=>{q(!1),Y("ERROR"),__LOG__(4,!0,new Error,!0)`Catalog Order Display failed`,SEND_LOGS("OrderDetails: failed to display"),V&&(0,E.qplEndOrderView)(P.QuickLogActionType.FAIL)}))}),[]);const ee=()=>{h.Cmd.closeDrawerRight()},te=()=>{if(ee(),null!=G){const e=l.fbt._("We have canceled your order.",null,{hk:"4glubN"}).toString()+"\n"+Z;(0,M.sendTextMsgToChat)(H,e,{quotedMsg:new k.Msg(G)})}h.Cmd.openChatFromUnread(H)},ne=()=>{if(!(0,j.orderDetailsFromCartEnabled)()||U)return null;return(0,s.createUserWid)(R).equals((0,S.getMaybeMeUser)())?(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(x.default,{children:(0,D.jsx)(v.default,{a8nText:"order-create",color:"dark",onClick:()=>B((0,i.default)(Q,"order")),children:l.fbt._("Create order",null,{hk:"4Fn7Vw"})})}),(0,D.jsx)(x.default,{children:(0,D.jsx)(v.default,{a8nText:"order-decline",color:"dark",onClick:W,children:l.fbt._("Decline order",null,{hk:"3y5T6d"})})})]}):null};return(0,D.jsxs)(m.default,{theme:"striped",onDrop:ee,children:[(0,D.jsx)(_.DrawerHeader,{title:t?l.fbt._("Your sent cart",null,{hk:"2NjAs4"}):b.default.t(261),type:_.DRAWER_HEADER_TYPE.SMALL,onBack:ee}),(0,D.jsx)(g.default,{flatListControllers:[$.current],children:(()=>{if(z||null==Q)return(0,D.jsx)(C.default,{fetchState:K});let e="";e=Q.products.length>0?b.default.t(551,{count:Q.totalItemCount||0,_plural:Q.totalItemCount||0}):l.fbt._("No Items",null,{hk:"49qWfy"});const t=(0,D.jsx)(L.TextDiv,{theme:"title",children:e});let n=null;n=null!=Q.total&&0!==Q.total?b.default.t(697,{subtotal:p.formatAmount1000(Q.currency,Q.total)}):l.fbt._("Ask for total",null,{hk:"3qm9mR"});const a=(0,D.jsx)(L.TextDiv,{theme:"muted-small",children:n});let r=null;if(null!=Q.createdAt){const e=u.Clock.timeStr(Q.createdAt);r=(0,D.jsx)(L.TextSpan,{theme:"muted-small",children:`${e}`})}return(0,D.jsxs)(D.Fragment,{children:[(0,D.jsxs)(x.default,{children:[(0,D.jsx)(C.default,{fetchState:K}),(0,D.jsxs)("div",{className:(0,c.default)(N,o.uiPadding.all18),children:[t,a]}),(0,D.jsx)(T.default,{flatListController:$.current,onProductDetail:F,order:Q,sellerJid:R}),(0,D.jsx)("div",{className:(0,c.default)(N,o.uiPadding.all18),children:r}),U?(0,D.jsx)("div",{className:(0,c.default)(o.uiPadding.vert0,o.uiPadding.horiz18),children:(0,D.jsx)(w.default,{chat:H,onChange:J,onSubmit:te,value:Z,placeholder:l.fbt._("Add a cancelation note",null,{hk:"22DPGj"})})}):null]}),ne()]})})()})]})};var r=n(50796),i=a(n(45095)),o=n(28298),s=n(45454),l=n(48360),d=n(67294),c=a(n(56720)),u=n(22683),h=n(88102),f=a(n(52665)),p=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=R(t);if(n&&n.has(e))return n.get(e);var a={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var o=r?Object.getOwnPropertyDescriptor(e,i):null;o&&(o.get||o.set)?Object.defineProperty(a,i,o):a[i]=e[i]}a.default=e,n&&n.set(e,a);return a}(n(74764)),m=a(n(60453)),g=a(n(69637)),v=a(n(64738)),_=n(94790),x=a(n(33308)),C=a(n(61055)),y=a(n(30855)),S=n(99234),j=n(57701),b=a(n(43725)),E=n(82145),k=n(17304),I=n(84312),w=a(n(96152)),T=a(n(33865)),P=n(48870),M=n(5524),L=n(13923),O=a(n(59552)),A=n(77591),D=n(85893);function R(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(R=function(e){return e?n:t})(e)}const N={backgroundColor:"ihvf49ua"}},18085:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.useGetOrders=function(){const[e,t]=(0,i.useState)({contactAndOrderInfoMap:{},orderStatusInfoMap:{}}),[n,a]=(0,i.useState)(!0),d=(0,i.useCallback)((e=>{t((t=>{const{contactAndOrderInfoMap:n,orderStatusInfoMap:a}=t,{contactsAndOrdersInfo:r,ordersStatusInfo:i}=e;return{contactAndOrderInfoMap:(0,s.getMergedContactAndOrderInfoMap)(n,r),orderStatusInfoMap:(0,s.getMergedOrderStatusInfoMap)(a,i)}}))}),[]);return(0,l.useListener)(o.ChatCollection,"add",function(){var e=(0,r.default)((function*(e){const t=yield(0,s.getCachedOrdersInfoFromChat)(e);d(t)}));return function(){return e.apply(this,arguments)}}()),(0,l.useListeners)(o.ChatCollection.toArray().map((e=>({source:e.msgs,eventOrEvents:"add",callback:t=>{const n=(0,s.getOrdersInfoFromMsgs)([t],e.contact);d(n)}})))),(0,i.useEffect)((()=>{const e=[];o.ChatCollection.toArray().forEach((t=>{const n=(t.msgs.msgLoadState.noEarlierMsgs?s.getCachedOrdersInfoFromChat:s.getNotCachedOrdersInfoFromChat)(t);n.then(d),e.push(n)})),Promise.all(e).finally((()=>a(!1)))}),[d]),{ordersInfoMap:e,isLoading:n}};var r=a(n(48926)),i=n(67294),o=n(69951),s=n(18878),l=n(19529)},80456:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(28298),i=n(48360),o=n(67294),s=(a(n(56720)),function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=j(t);if(n&&n.has(e))return n.get(e);var a={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var o=r?Object.getOwnPropertyDescriptor(e,i):null;o&&(o.get||o.set)?Object.defineProperty(a,i,o):a[i]=e[i]}a.default=e,n&&n.set(e,a);return a}(n(74764))),l=a(n(60453)),d=a(n(69637)),c=a(n(64738)),u=n(94790),h=a(n(33308)),f=n(29623),p=n(30699),m=a(n(18985)),g=a(n(42116)),v=a(n(82240)),_=n(88998),x=a(n(23217)),C=n(13923),y=a(n(27968)),S=n(85893);function j(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(j=function(e){return e?n:t})(e)}function b(e){let{children:t}=e;return(0,S.jsx)(C.TextSpan,{color:"secondary",children:t})}const E={orderProductSummaryContainer:{marginTop:"jdreu547",marginEnd:"jnwc1y2a",marginBottom:"n5a6z3tu",marginStart:"svoq16ka"},fieldContainer:{gap:"fbvzomvk"}};function k(e,t){const{chat:n,orderInfo:a,sellerWid:j}=e,{referenceId:k,discount:I,tax:w,shipping:T,subtotal:P,totalAmount:M}=a,L=(0,y.default)(j),O=(0,o.useMemo)((()=>(0,_.findOrderStatus)(n,k)),[n,k]);if(null==L||null==P)return null;const A=L.productCollection.getProductModels().reduce(((e,t)=>(e[t.id.toString()]=t,e)),{}),D=a.items.map((e=>{var t,n;const r=null!=e.amount?1e3*e.amount:null;return{id:e.id,name:e.name,quantity:e.quantity,price:r,currency:a.currency,mediaData:null===(t=A[e.id])||void 0===t||null===(n=t.getPreviewImage())||void 0===n?void 0:n.mediaData}}));return(0,S.jsxs)(l.default,{onDrop:e.onBack,ref:t,children:[(0,S.jsx)(u.DrawerHeader,{title:i.fbt._("Order details",null,{hk:"2HeBLz"}),onBack:e.onBack,type:u.DRAWER_HEADER_TYPE.SMALL}),(0,S.jsxs)(d.default,{children:[(0,S.jsx)(h.default,{xstyle:[r.uiPadding.top20,r.uiPadding.horiz16,r.uiPadding.bottom15],children:(0,S.jsxs)(m.default,{children:[(0,S.jsx)(g.default,{orderId:a.referenceId,sellerWid:j,orderStatus:(0,S.jsx)(v.default,{orderStatus:O})}),(0,S.jsx)(f.FlexColumn,{align:"stretch",xstyle:E.orderProductSummaryContainer,children:(0,S.jsx)(p.OrderDetailProductSummary,{productMediaData:D[0].mediaData,totalItemCount:a.quantity,productItems:D,onClick:()=>{var t;null===(t=e.onProductSummaryClick)||void 0===t||t.call(e,D)}})}),(0,S.jsxs)(f.FlexColumn,{align:"stretch",xstyle:E.fieldContainer,children:[(0,S.jsxs)(f.FlexRow,{justify:"all",children:[(0,S.jsx)(b,{children:i.fbt._("Subtotal",null,{hk:"4ciFet"})}),(0,S.jsx)(b,{children:s.formatAmount(a.currency,P)})]}),null!=I?(0,S.jsxs)(f.FlexRow,{justify:"all",children:[(0,S.jsx)(b,{children:i.fbt._("Discount",null,{hk:"ITgTG"})}),(0,S.jsx)(b,{children:s.formatAmount(a.currency,-I)})]}):null,null!=T?(0,S.jsxs)(f.FlexRow,{justify:"all",children:[(0,S.jsx)(b,{children:i.fbt._("Shipping",null,{hk:"269x6X"})}),(0,S.jsx)(b,{children:s.formatAmount(a.currency,T)})]}):null,null!=w?(0,S.jsxs)(f.FlexRow,{justify:"all",children:[(0,S.jsx)(b,{children:i.fbt._("Tax",null,{hk:"1ZWlTS"})}),(0,S.jsx)(b,{children:s.formatAmount(a.currency,w)})]}):null]}),(0,S.jsxs)(f.FlexRow,{justify:"all",children:[(0,S.jsx)(C.TextSpan,{theme:"title",children:i.fbt._("Total",null,{hk:"7xRrT"})}),(0,S.jsx)(C.TextSpan,{theme:"title",children:s.formatAmount(a.currency,M)})]})]})}),(0,S.jsx)(h.default,{children:(0,S.jsx)(c.default,{icon:(0,S.jsx)(x.default,{color:"teal",width:20,name:"status-ciphertext"}),a8nText:"order-status-update",color:"dark",onClick:()=>{var t;null===(t=e.onOrderStatusUpdateClick)||void 0===t||t.call(e)},children:i.fbt._("Update order status",null,{hk:"BQwg8"})})})]})]})}var I=(0,o.forwardRef)(k);t.default=I},39049:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{productItems:t}=e,n=t.map((e=>({itemKey:e.id.toString(),product:e})));return(0,s.jsx)(i.default,{flatListControllers:[e.flatListController],children:(0,s.jsx)(r.FlatList,{a8nKey:"order-detail-product-list",flatListController:e.flatListController,direction:"vertical",forceConsistentRenderCount:!1,data:n,renderItem:function(e){let{product:t}=e;return(0,s.jsx)(o.default,{product:t})},defaultItemHeight:60})})};var r=n(47915),i=a(n(44942)),o=a(n(20329)),s=n(85893)},32488:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(48360),i=n(67294),o=(a(n(56720)),a(n(60453))),s=a(n(69637)),l=n(94790),d=a(n(33308)),c=a(n(30855)),u=a(n(39049)),h=a(n(59552)),f=n(85893);const p={container:{paddingTop:"emrlamx0",paddingEnd:"folpon7g",paddingBottom:"aiput80m",paddingStart:"lyvj5e2u"}};function m(e,t){const{productItems:n}=e,a=(0,h.default)((()=>new c.default));return(0,f.jsxs)(o.default,{onDrop:e.onBack,ref:t,children:[(0,f.jsx)(l.DrawerHeader,{title:r.fbt._("Items",null,{hk:"3B8pMI"}),onBack:e.onBack,type:l.DRAWER_HEADER_TYPE.SMALL}),(0,f.jsx)(s.default,{flatListControllers:[a.current],children:(0,f.jsx)(d.default,{xstyle:p.container,theme:"refresh-padding-title",children:(0,f.jsx)(u.default,{flatListController:a.current,productItems:n})})})]})}var g=(0,i.forwardRef)(m);t.default=g},20329:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{product:t}=e,n=(0,m.jsx)(c.EmojiText,{text:t.name,ellipsify:!0,titlify:!0}),a=t.mediaData?(0,m.jsx)(h.ProductThumb,{mediaData:t.mediaData,theme:"squareThumb"}):(0,m.jsx)("div",{className:(0,s.default)(v,r.uiMargin.end12),children:(0,m.jsx)(f.default,{className:(0,s.default)(_),name:"list-msg-icon"})});let g=null;if(t.quantity){const e=u.default.t(698,{quantity:t.quantity.toString()});g=(0,m.jsx)(p.TextSpan,{children:e})}let x=null;x=(0,o.isNonZeroNumber)(t.price)?d.formatAmount1000(t.currency,t.price):i.fbt._("Ask for price",null,{hk:"2Rtbeg"});const C=(0,m.jsx)(p.TextSpan,{children:x});return(0,m.jsx)(l.default,{image:a,customImage:!0,primary:n,secondary:g,detail:C,theme:"media"})};var r=n(28298),i=n(48360),o=n(29984),s=a(n(56720)),l=a(n(44356)),d=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=g(t);if(n&&n.has(e))return n.get(e);var a={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var o=r?Object.getOwnPropertyDescriptor(e,i):null;o&&(o.get||o.set)?Object.defineProperty(a,i,o):a[i]=e[i]}a.default=e,n&&n.set(e,a);return a}(n(74764)),c=n(65417),u=a(n(43725)),h=n(3013),f=a(n(23217)),p=n(13923),m=n(85893);function g(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(g=function(e){return e?n:t})(e)}const v={display:"p357zi0d",alignItems:"gndfcl4n",width:"dyxdk6fi",height:"m3o1wsh7",borderTopStartRadius:"bbr44loe",borderTopEndRadius:"ooj5yc5b",borderBottomEndRadius:"m8i16etx",borderBottomStartRadius:"cw0ivh8j",backgroundColor:"lzol1dln",position:"g0rxnol2"},_={marginTop:"m3ct2rho",marginEnd:"k1jo73ug",marginBottom:"ec1z5skj",marginStart:"isfiuinm",color:"s4recxw2"}},59322:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){let{label:t,isCanceled:n,checked:a,onClick:u}=e;return(0,d.jsx)(l.default,{onClick:u,children:(0,d.jsxs)(s.FlexRow,{children:[(0,d.jsx)(s.FlexColumn,{xstyle:r.uiPadding.horiz24,children:(0,d.jsx)(o.default,{checked:a,radio:!0,hover:!1,systemUncheckedColor:!0,onChange:()=>{u()}})}),(0,d.jsx)("div",{className:n?(0,i.default)(c):null,children:t})]})})};var r=n(28298),i=a(n(56720)),o=a(n(9275)),s=n(29623),l=a(n(1784)),d=n(85893);const c={color:"mvxzr2tb"}},33865:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{order:t,onProductDetail:n,sellerJid:a}=e,f=e=>{const n=t.orderItemCollection.toArray();return(0,l.logOrderListImpression)({catalogContext:e,orderId:t.id,productCount:n.length,catalogOwnerJid:a}),n.map((e=>({itemKey:e.id.toString(),product:e})))};return(0,h.jsx)(i.DrawerContext.Consumer,{children:t=>{const i=(0,u.getProductCatalogContext)(t);return(0,h.jsx)(s.default,{flatListControllers:[e.flatListController],children:(0,h.jsx)(o.FlatList,{a8nKey:"order-product-list",flatListController:e.flatListController,direction:"vertical",forceConsistentRenderCount:!1,data:f(i),renderItem:t=>(0,h.jsx)(c.default,{product:t.product,onClick:()=>{const r={productId:t.product.id,businessOwnerJid:a};(0,d.qplStartProductView)("Order"),(0,l.logOrderListItemClick)({catalogContext:i,orderId:e.order.id,catalogOwnerJid:a}),n(r)}}),defaultItemHeight:r.PRODUCT_LIST_ITEM_HEIGHT})})}})};var r=n(64481),i=n(27394),o=n(47915),s=a(n(44942)),l=n(79544),d=n(82145),c=a(n(7714)),u=n(97567),h=n(85893)},7714:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{product:t,onClick:n}=e,a=(0,p.jsx)(c.EmojiText,{text:t.name,ellipsify:!0,titlify:!0}),m=(0,p.jsx)(h.ProductThumb,{mediaData:t.mediaData,theme:"list"}),g=u.default.t(698,{quantity:t.quantity.toString()});let v=null;t.quantity&&(v=(0,p.jsx)(f.TextSpan,{className:(0,s.default)(r.uiMargin.vert0,r.uiMargin.start0,r.uiMargin.end6),children:g}));let _=null;_=(0,o.isNonZeroNumber)(t.price)?d.formatAmount1000(t.currency,t.price):i.fbt._("Ask for price",null,{hk:"2Rtbeg"});const x=(0,p.jsx)(f.TextSpan,{className:(0,s.default)(r.uiMargin.vert0,r.uiMargin.start0,r.uiMargin.end6),children:_});let C=null;null!=v&&(C=(0,p.jsx)("span",{className:(0,s.default)(r.uiMargin.vert0,r.uiMargin.start0,r.uiMargin.end6),children:"•"}));const y=(0,p.jsxs)("div",{children:[x,C,v]});return(0,p.jsx)(l.default,{image:m,customImage:!0,primary:a,secondary:y,theme:"order-product",onClick:n},t.id.toString())};var r=n(28298),i=n(48360),o=n(29984),s=a(n(56720)),l=a(n(44356)),d=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=m(t);if(n&&n.has(e))return n.get(e);var a={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var o=r?Object.getOwnPropertyDescriptor(e,i):null;o&&(o.get||o.set)?Object.defineProperty(a,i,o):a[i]=e[i]}a.default=e,n&&n.set(e,a);return a}(n(74764)),c=n(65417),u=a(n(43725)),h=n(3013),f=n(13923),p=n(85893);function m(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(m=function(e){return e?n:t})(e)}},3607:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(28298),i=n(48360),o=n(67294),s=(a(n(56720)),n(88102)),l=a(n(60453)),d=a(n(69637)),c=n(94790),u=a(n(33308)),h=n(29623),f=n(59789),p=a(n(59322)),m=a(n(96152)),g=n(88998),v=n(43538),_=n(73150),x=n(85893);const C=[g.OrderStatus.Processing,g.OrderStatus.PartiallyShipped,g.OrderStatus.Shipped,g.OrderStatus.Complete,g.OrderStatus.Canceled],y={checkboxContainer:{gap:"n8lfltvd"}};function S(e,t){const[n,a]=(0,o.useState)(""),[S,j]=(0,o.useState)((()=>(0,g.findOrderStatus)(e.chat,e.orderInfo.referenceId))),{chat:b,sellerJid:E,orderInfo:k}=e,I=i.fbt._("Add a note",null,{hk:"1bEnPm"});return(0,x.jsxs)(l.default,{onDrop:e.onBack,ref:t,children:[(0,x.jsx)(c.DrawerHeader,{title:i.fbt._("Update order status",null,{hk:"Zrpil"}),onBack:e.onBack,type:c.DRAWER_HEADER_TYPE.SMALL}),(0,x.jsxs)(d.default,{children:[(0,x.jsx)(u.default,{xstyle:[r.uiPadding.vert20,r.uiPadding.horiz16],theme:"refresh-padding-title",children:(0,x.jsx)(h.FlexColumn,{xstyle:y.checkboxContainer,children:C.map((function(e){return(0,x.jsx)(p.default,{label:v.OrderStatusLabels[e],isCanceled:e===g.OrderStatus.Canceled,checked:S===e,onClick:()=>{j(e)}},e)}))})}),(0,x.jsx)(u.default,{xstyle:[r.uiPadding.top8,r.uiPadding.horiz16],theme:"refresh-padding-title",children:(0,x.jsx)(m.default,{chat:e.chat,placeholder:I,value:n,onChange:a,onSubmit:function(){s.Cmd.closeDrawerRight(),(0,_.sendOrderStatusMessageAsMerchant)({chat:b,sellerJid:E,orderInfo:k,orderNote:n,orderStatus:S,offset:f.DEFAULT_OFFSET}),s.Cmd.openChatFromUnread(b)},buttonTitle:I,a8nTextButton:"order-status-update-button"})})]})]})}var j=(0,o.forwardRef)(S);t.default=j},91545:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.CatalogSettingsDrawer=function(e){const{onBack:t}=e,[n,a]=(0,o.useState)(!0),[s,c]=(0,o.useState)(!1),m=(0,k.default)();(0,o.useEffect)((()=>{(0,y.default)(l.BusinessProfileCollection.fetchBizProfile((0,_.getMeUser)()),m).then((e=>{const t=e.profileOptions;a(!1),c(null!=t&&t.cartEnabled)})).catch((0,r.catchAbort)((()=>{}))).catch((()=>{__LOG__(4,!0,new Error)`Error fetching the business profile.`,u.Cmd.openToast((0,I.jsx)(E.Toast,{msg:i.fbt._("Failed to load catalog settings.",null,{hk:"2UxoQh"}),duration:6e3,id:(0,E.genId)()})),t()}))}),[]);const g=e=>{c(e)};return(0,I.jsxs)(h.default,{theme:"catalog",onDrop:e.onBack,children:[(0,I.jsx)(p.DrawerHeader,{title:i.fbt._("Settings",null,{hk:"2RmHUB"}),type:p.DRAWER_HEADER_TYPE.LARGE,onBack:e.onBack}),(0,I.jsx)(f.default,{children:n?(0,I.jsx)("div",{className:d.default.loadingSpinner,children:(0,I.jsx)(j.Spinner,{})}):(0,I.jsx)(w,{cartEnabled:s,setCartEnabled:g})})]})};var r=n(89385),i=n(48360),o=n(67294),s=n(46977),l=n(93581),d=a(n(48608)),c=a(n(99360)),u=n(88102),h=a(n(60453)),f=a(n(69637)),p=n(94790),m=a(n(33308)),g=n(12591),v=n(96384),_=n(99234),x=a(n(43725)),C=a(n(56074)),y=a(n(84644)),S=a(n(25421)),j=n(11054),b=n(13923),E=n(50452),k=a(n(38080)),I=n(85893);function w(e){let{cartEnabled:t,setCartEnabled:n}=e;const a=e=>{n(e),(0,s.updateCartEnabled)(e).catch((()=>{__LOG__(4,!0,new Error,!0)`Failed to update cartEnabled value`,SEND_LOGS("updateCartEnabled: cartEnabled toggle error"),u.Cmd.openToast((0,I.jsx)(E.Toast,{msg:i.fbt._("Failed to update the setting.",null,{hk:"RZBg9"}),duration:6e3,id:(0,E.genId)()})),n(t)}))},r=(0,v.getCatalogCartOnOffFaqUrl)(),o=(0,I.jsx)(c.default,{href:r,onClick:e=>{e.preventDefault(),(0,g.openExternalLink)(r)},children:x.default.t(554)}),l=(0,I.jsx)(C.default,{id:269,params:{learn_more_link:o}});return(0,I.jsxs)(I.Fragment,{children:[(0,I.jsxs)(m.default,{title:i.fbt._("Add to cart",null,{hk:"1mbCt1"}),theme:"title-larger",animation:!1,children:[(0,I.jsx)(S.default,{isChosen:t,onChoose:()=>{a(!0)},choiceText:i.fbt._("On",null,{hk:"2m7e5W"})}),(0,I.jsx)(S.default,{isChosen:!t,onChoose:()=>{a(!1)},choiceText:i.fbt._("Off",null,{hk:"1l0P5X"})})]}),(0,I.jsx)(b.TextDiv,{theme:"plain",className:d.default.descriptionText,children:l})]})}},27968:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const[t,n]=(0,i.useState)((()=>o.CatalogCollection.get(e))),a=(0,s.default)();return(0,i.useEffect)((()=>{const i=o.CatalogCollection.get(e);i!==t&&(null!=i?n(i):(0,r.default)((function*(){const t=yield o.CatalogCollection.find(e);a()&&n(t)}))())}),[e,t,a]),t};var r=a(n(48926)),i=n(67294),o=n(99989),s=a(n(88624))},65656:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{selections:t,active:n,onSelectionChanged:a,catalog:d}=e,c=e=>{((e,r,i)=>{t.setVal(e,r,i),n.setVal(e,i),a()})(e,!t.isSelected(e),!1)};return(0,l.jsx)(o.default,{flatListControllers:[e.flatListController],children:(0,l.jsx)(i.FlatList,{flatListController:e.flatListController,direction:"vertical",forceConsistentRenderCount:!1,data:d.productCollection.getProductModels(!0).map((e=>({itemKey:e.id.toString(),product:e}))),renderItem:e=>{const{product:a}=e;return(0,l.jsx)(s.default,{product:a,selections:t,onClick:()=>c(a),active:n},a.id.toString())},defaultItemHeight:r.PRODUCT_LIST_ITEM_HEIGHT})})};var r=n(64481),i=n(47915),o=a(n(44942)),s=a(n(60809)),l=n(85893)},93870:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t;const{catalog:n,collection:a,onBack:R}=e,N=(0,L.default)((()=>new I.default([],(e=>e.id.toString())))),F=(0,L.default)((()=>new o.default([],(e=>e.id.toString())))),B=(0,L.default)((()=>new x.default)),U=(0,M.default)(),H=(0,A.default)(),[G,W]=(0,d.useState)(null),[V,z]=(0,d.useState)(null),[q,K]=(0,d.useState)(null==a?void 0:a.name),[Y,Q]=(0,d.useState)(null==a?void 0:a.name),[X,Z]=(0,d.useState)(null),[J,$]=(0,d.useState)(!1),[ee,te]=(0,d.useState)(!0);(0,d.useEffect)((()=>{(()=>{const e=new h.CollectionsContentDataSource(n,u.PRODUCT_LIST_ITEM_HEIGHT,null==a?void 0:a.id),t=new h.CatalogListItemScrollHelper(e);W(e),z(t),e.loadInitialItems().then((()=>{if(H.aborted)throw new i.AbortError;te(!1),U()})).catch((0,i.catchAbort)((()=>{})))})()}),[]);const ne=e=>{K(e),Z(X&&e?null:X)},ae=(0,O.default)((e=>{const t=e.currentTarget;(null==V?void 0:V.willLoadMore(t))&&te(!0),null==V||V.onScroll(e,t).then((e=>{te(!1),e&&te(!1)})).catch((e=>{throw te(!1),e}))}),100),re=function(){var e=(0,r.default)((function*(e){const t=(0,j.getProductCatalogContext)(e);if(q&&""!==q.trim()){b.QPL.markerStart(E.QuickLogMarkerId.WHATSAPP_COLLECTION_EDIT),$(!0);const{added:e,removed:r}=(()=>{const e=n.productCollection.getProductModels(!0),t=[],a=[];return e.forEach((e=>{const n=F.current.isSelected(e);e.checkmark!==n&&(n?a.push(e):t.push(e))})),{added:a,removed:t}})(),i=q!==Y;b.QPL.markerAnnotate(E.QuickLogMarkerId.WHATSAPP_COLLECTION_EDIT,{bool:{IsNew:!a},int:{ProductsAdded:e.length}}),a&&b.QPL.markerAnnotate(E.QuickLogMarkerId.WHATSAPP_COLLECTION_EDIT,{bool:{Renamed:i},int:{ProductsDeleted:r.length}});try{if(yield(0,c.handleCollectionSave)(n,a,q||"",e,r,t)){R();const n=null==a?void 0:a.id;n&&i&&((0,S.logCollectionRenamed)({catalogContext:t,collectionId:n}),Q(q)),a&&(0,S.logCollectionItemsAssignment)({collectionId:a.id,addedCount:e.length,removedCount:r.length,catalogContext:t}),b.QPL.markerEnd(E.QuickLogMarkerId.WHATSAPP_COLLECTION_EDIT,b.QuickLogActionType.SUCCESS)}else $(!1),b.QPL.markerDrop(E.QuickLogMarkerId.WHATSAPP_COLLECTION_EDIT)}catch(e){$(!1),b.QPL.markerEnd(E.QuickLogMarkerId.WHATSAPP_COLLECTION_EDIT,b.QuickLogActionType.FAIL)}}else Z(l.fbt._("Name required",null,{hk:"1pvj2p"}))}));return function(){return e.apply(this,arguments)}}(),ie=e=>{let t;const r=(()=>{const e=n.productCollection.getProductModels(!0);let t=0;return e.forEach((e=>{F.current.isInList(e)?e.checkmark!==F.current.isSelected(e)&&t++:F.current.setVal(e,e.checkmark)})),t})();if(r>0||a&&q!==a.name){const n=y.default.t(262,{updated:r,_plural:r});t=(0,D.jsxs)("div",{className:_.default.footer,children:[n,(0,D.jsx)("div",{className:_.default.saveButton,children:(0,D.jsx)(k.Round,{large:!0,onClick:()=>{re(e)},children:(0,D.jsx)(T.default,{name:"checkmark-medium"})})})]})}return t},oe=(0,s.default)(_.default.container,{[_.default.isSending]:J}),se=(null===(t=e.collection)||void 0===t?void 0:t.name)||l.fbt._("New collection",null,{hk:"4dusPd"});return(0,D.jsxs)(p.default,{theme:"products",onDrop:e.onBack,children:[(0,D.jsx)(v.DrawerHeader,{title:se,type:v.DRAWER_HEADER_TYPE.LARGE,onBack:e.onBack,menu:(0,D.jsx)(D.Fragment,{})}),(0,D.jsx)(m.default,{className:oe,flatListControllers:[B.current],onScroll:ae,children:(()=>{const e=J?(0,D.jsx)("div",{className:_.default.spinner,children:(0,D.jsx)(w.Spinner,{size:50,stroke:3})}):null;return(0,D.jsx)(g.DrawerContext.Consumer,{children:t=>{const r=(0,j.getProductCatalogContext)(t);return(0,D.jsxs)(D.Fragment,{children:[e,(0,D.jsxs)("div",{className:_.default.nameContainer,children:[(0,D.jsx)("span",{className:_.default.nameIcon,children:(0,D.jsx)(T.default,{name:"collections_folder"})}),(0,D.jsx)("span",{className:_.default.nameEdit,children:(0,D.jsx)(P.TextInput,{editable:!0,focusOnMount:!0,showRemaining:!0,value:q,onChange:ne,inputPlaceholder:l.fbt._("New collection",null,{hk:"2NAI33"}),theme:"text-input",error:X,maxLength:30})})]}),(0,D.jsx)("div",{className:_.default.operation,children:a?l.fbt._("Update Items",null,{hk:"2dT3Pu"}):l.fbt._("Add Items",null,{hk:"3NRr27"})}),(0,D.jsxs)("div",{className:_.default.listContainer,children:[(0,D.jsx)(f.default,{catalog:n,flatListController:B.current,active:N.current,selections:F.current,onSelectionChanged:()=>U()}),ee&&(0,D.jsx)("div",{className:_.default.loadingSpinner,children:(0,D.jsx)(C.default,{})})]}),ie(r)]})}})})()})]})};var r=a(n(48926)),i=n(89385),o=a(n(78931)),s=a(n(94184)),l=n(48360),d=n(67294),c=n(47217),u=n(64481),h=n(71599),f=a(n(65656)),p=a(n(60453)),m=a(n(69637)),g=n(27394),v=n(94790),_=a(n(24514)),x=a(n(30855)),C=a(n(29796)),y=a(n(43725)),S=n(35054),j=n(97567),b=n(48870),E=n(27798),k=n(82857),I=a(n(87481)),w=n(11054),T=a(n(23217)),P=n(90011),M=a(n(59909)),L=a(n(59552)),O=a(n(88857)),A=a(n(38080)),D=n(85893)},65303:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.ComplianceInfoFields=$,t.EditProductDrawerImpl=t.EditProductDrawer=void 0;var r=a(n(81109)),i=a(n(48926)),o=n(50796),s=a(n(45095)),l=a(n(94184)),d=n(48360),c=n(67294),u=(a(n(56720)),n(47217)),h=a(n(39770)),f=n(99989),p=n(16593),m=n(88102),g=n(30066),v=n(27105),_=n(72549),x=n(9978),C=n(79502),y=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=X(t);if(n&&n.has(e))return n.get(e);var a={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var o=r?Object.getOwnPropertyDescriptor(e,i):null;o&&(o.get||o.set)?Object.defineProperty(a,i,o):a[i]=e[i]}a.default=e,n&&n.set(e,a);return a}(n(74764)),S=a(n(54896)),j=a(n(60453)),b=a(n(69637)),E=n(27394),k=n(94790),I=a(n(18829)),w=n(29623),T=n(99234),P=n(57701),M=a(n(3222)),L=a(n(43725)),O=n(84387),A=n(77975),D=n(9468),R=n(21374),N=n(97567),F=a(n(30327)),B=n(48870),U=n(27798),H=n(11054),G=a(n(65932)),W=n(13923),V=n(90011),z=n(50452),q=a(n(90012)),K=n(2541),Y=n(77591),Q=n(85893);function X(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(X=function(e){return e?n:t})(e)}const Z={complianceInfoHelpCenterBanner:{paddingTop:"nlnf8xo7",paddingEnd:"f9ovudaz",paddingBottom:"jzp2c175",paddingStart:"gx1rr48f"}};class J extends c.Component{constructor(e){var t;super(e),t=this,this._imagePanelRef=(0,c.createRef)(),this._handleNameChange=e=>{this.setState({name:e,nameError:""===e.trim()?d.fbt._("Add a title",null,{hk:"3QauyV"}):"",isModified:!0})},this._handlePriceChange=e=>{const t=y.valueFromString(this.state.currency,e);let n="";""===e||y.validatePriceString(this.state.currency,e,D.MIN_PRICE,D.MAX_PRICE)||(n=d.fbt._("Enter a valid price",null,{hk:"3JgcXg"})),this.setState({priceAmount1000:""===e?null:t,priceStr:`${e}`,priceError:n,isModified:!0})},this.handleDescriptionChange=e=>{this.setState({description:e,isModified:!0})},this._handleUrlChange=e=>{let t="";""===e||K.URL.isValid(e)||(t=d.fbt._("URL is incorrect",null,{hk:"xiOtm"})),this.setState({url:e,urlError:t,isModified:!0})},this._handleUrlBlur=()=>{const{url:e}=this.state;""===e||K.URL.isHttps(e)||K.URL.isHttp(e)||this.setState({url:`https://${e}`})},this._handleRetailerIdChange=e=>{this.setState({retailerId:e,retailerIdError:"",isModified:!0})},this._showComplianceInfoImporterAddress=()=>{var e;const t=null===(e=this.state.complianceInfo)||void 0===e?void 0:e.countryCodeOrigin;return!!t&&![g.COMPLIANCE_INFO_CODES.INDIA,x.SyntheticCountryCode.NotApplicable].includes(t)},this._handleComplianceInfoChange=function(){var e=(0,i.default)((function*(e,n){var a;let i;const o=(0,r.default)((0,r.default)({},t.state.complianceInfo),{},{importerAddress:(0,r.default)({},null===(a=t.state.complianceInfo)||void 0===a?void 0:a.importerAddress)});"countryCodeOrigin"===e&&(i=n===String(x.SyntheticCountryCode.NotApplicable)?d.fbt._("Not Applicable",null,{hk:"2k1klN"}).toString():yield(0,x.getCountryName)(n),o.countryNameOrigin=i,o.countryCodeOriginError=""),"importerName"===e&&(o.importerNameError=(0,_.existsField)(n,(0,T.getMeUser)())||!t.shouldComplianceBeHardEnforced()?"":d.fbt._("Add an importer name",null,{hk:"3UwP1T"})),o[e]=n||void 0,t.setState({complianceInfo:o,isModified:!0})}));return function(){return e.apply(this,arguments)}}(),this._getImporterAddressFieldValueOnChange=(e,t,n)=>{const{importerAddress:a}=this.state.complianceInfo||{};return t===e?n:a[e]},this._handleComplianceInfoImporterAddressChange=function(){var e=(0,i.default)((function*(e,n){var a;const i=t._getImporterAddressFieldValueOnChange("street1",e,n),o=t._getImporterAddressFieldValueOnChange("street2",e,n),s=t._getImporterAddressFieldValueOnChange("postalCode",e,n),l=t._getImporterAddressFieldValueOnChange("city",e,n),c=t._getImporterAddressFieldValueOnChange("region",e,n),u=t._getImporterAddressFieldValueOnChange("countryCode",e,n),h=[i,o,s,l,c,u].some((e=>e))||t.shouldComplianceBeHardEnforced(),f=(0,r.default)((0,r.default)({},t.state.complianceInfo),{},{importerAddress:(0,r.default)({},null===(a=t.state.complianceInfo)||void 0===a?void 0:a.importerAddress)});"countryCode"===e&&(f.importerAddress.countryName=(yield(0,x.getCountryName)(n))||void 0),f.importerAddress[e]=n||void 0,f.importerAddress.street1Error=h&&!(0,_.existsFieldIgnoreHardEnforcement)(i)?d.fbt._("Add an importer address line 1",null,{hk:"3HSMmN"}):"",f.importerAddress.cityError=h&&!(0,_.existsFieldIgnoreHardEnforcement)(l)?d.fbt._("Add an importer city",null,{hk:"1nq7dA"}):"",f.importerAddress.countryCodeError=h&&!(0,_.existsFieldIgnoreHardEnforcement)(u)?d.fbt._("Add an importer country",null,{hk:"3VmDTh"}):"",t.setState({complianceInfo:f,isModified:!0})}));return function(){return e.apply(this,arguments)}}(),this._handleHiddenChange=()=>{this.setState({isHidden:!this.state.isHidden})},this._getProductChanges=()=>{const{catalog:e,product:t}=this.props,{name:n,priceAmount1000:a,currency:r,description:i,url:o,retailerId:s,complianceInfo:l,isHidden:d}=this.state;return new D.Product({id:t.id,priceAmount1000:a,currency:r,description:i||"",imageCdnUrl:t.imageCdnUrl,additionalImageCdnUrl:t.additionalImageCdnUrl,name:n,retailerId:s,url:o,isHidden:d,complianceInfo:(0,P.canSeeECommerceComplianceIndiaSoftEnforcement)(e.id.user)?{countryCodeOrigin:null==l?void 0:l.countryCodeOrigin,importerName:null==l?void 0:l.importerName,importerAddress:{street1:null==l?void 0:l.importerAddress.street1,street2:null==l?void 0:l.importerAddress.street2,postalCode:null==l?void 0:l.importerAddress.postalCode,city:null==l?void 0:l.importerAddress.city,region:null==l?void 0:l.importerAddress.region,countryCode:null==l?void 0:l.importerAddress.countryCode}}:void 0})},this._handleEditSuccess=e=>{const{catalog:t,onEditSuccess:n,newProduct:a,onCreate:r}=this.props;t.productCollection.add(e,{merge:!0}),this.props.newProduct?(0,A.logAddProductSuccess)((0,N.getProductCatalogContext)(this.context)):(0,A.logEditProductSuccess)(this.props.product,(0,N.getProductCatalogContext)(this.context)),m.Cmd.openToast((0,Q.jsx)(z.Toast,{msg:d.fbt._("Changes saved",null,{hk:"fmK60"}),id:(0,z.genId)("catalog_item_saved")})),n(e),null!=a&&r&&r()},this._handleDeleteItem=()=>{const{catalog:e,product:t,onDelete:n}=this.props;(0,u.handleProductDelete)(e,t,(0,N.getProductCatalogContext)(this.context),"Product").then((e=>{e&&(m.Cmd.closeDrawerMid(),null==n||n(t))}))},this._handleEditError=(e,t)=>{this.props.newProduct?(0,A.logAddProductFailed)((0,N.getProductCatalogContext)(this.context)):(0,A.logEditProductFailed)(this.props.product,(0,N.getProductCatalogContext)(this.context),e.statusCode);let n=d.fbt._("Failed to save changes",null,{hk:"1rgjJH"});null!=e.errors&&(e.errors.filter((e=>"duplicate"===e.reason)).length>0?B.QPL.markerDrop(t):B.QPL.markerEnd(t,B.QuickLogActionType.FAIL),e.errors.map((e=>{"media"===e.name&&"duplicate"===e.reason&&this.setState({imageError:d.fbt._("Two or more images are the same. Delete any duplicates and try again.",null,{hk:"3qIMS6"})}),"retailer_id"!==e.name&&"retailer-id"!==e.name||"duplicate"!==e.reason||this.setState({retailerIdError:d.fbt._("Item code must be unique.",null,{hk:"2T0KbL"})}),(0,P.hideUnsupportedCurrency)()&&"currency"===e.name&&"invalid-data"===e.reason&&(n=d.fbt._("Price can’t be shown in your country. Delete the price you entered.",null,{hk:"R4VXy"}))}))),m.Cmd.openToast((0,Q.jsx)(z.Toast,{msg:n,id:(0,z.genId)("catalog_save_item_failed")}))},this._handleSaveItem=()=>{const{catalog:e,product:t,newProduct:n}=this.props;let a=!0;const r=this._getProductChanges();var i;this.errorsRevealed()||(n?(0,A.logAddProductClick)((0,N.getProductCatalogContext)(this.context)):(0,A.logEditProductClick)(t,(0,N.getProductCatalogContext)(this.context)),this.setState({isUpdating:!0}),n||this.state.isModified?(B.QPL.markerStart(U.QuickLogMarkerId.WHATSAPP_PRODUCT_SAVE,{bool:{IsNewProduct:!!n}}),null===(i=this._imagePanelRef.current)||void 0===i||i.uploadImages().then((t=>{r.imageCdnUrl=t[0],r.additionalImageCdnUrl=t.slice(1);(n?e.addProduct:e.editProduct).call(e,r).then((e=>{this._handleEditSuccess(e),a=!1,B.QPL.markerEnd(U.QuickLogMarkerId.WHATSAPP_PRODUCT_SAVE,B.QuickLogActionType.SUCCESS)})).catch((0,o.filteredCatch)(Y.CatalogEditServerError,(e=>{a=!1,this._handleEditError(e,U.QuickLogMarkerId.WHATSAPP_PRODUCT_SAVE)}))).finally((()=>{a&&B.QPL.markerEnd(U.QuickLogMarkerId.WHATSAPP_PRODUCT_SAVE,B.QuickLogActionType.FAIL),this.setState({isUpdating:!1})}))})).catch((e=>{throw B.QPL.markerEnd(U.QuickLogMarkerId.WHATSAPP_PRODUCT_SAVE,B.QuickLogActionType.FAIL),this.setState({isUpdating:!1}),e}))):(B.QPL.markerStart(U.QuickLogMarkerId.WHATSAPP_PRODUCT_SET_VISIBLE,{string:{EntryPoint:"Product"}}),(0,R.productVisibilitySet)([{productId:t.id.toString(),isHidden:r.isHidden}]).then((()=>{t.isHidden=r.isHidden,this._handleEditSuccess(t),a=!1,B.QPL.markerEnd(U.QuickLogMarkerId.WHATSAPP_PRODUCT_SET_VISIBLE,B.QuickLogActionType.SUCCESS)})).catch((0,o.filteredCatch)(Y.CatalogEditServerError,(e=>{a=!1,this._handleEditError(e,U.QuickLogMarkerId.WHATSAPP_PRODUCT_SET_VISIBLE)}))).finally((()=>{a&&B.QPL.markerEnd(U.QuickLogMarkerId.WHATSAPP_PRODUCT_SET_VISIBLE,B.QuickLogActionType.FAIL),this.setState({isUpdating:!1})}))))},this._handleImageChange=e=>{let t="";0===e.length&&(t=d.fbt._("Add at least one image",null,{hk:"4tbVYS"})),this.setState({imageError:t,hasImages:e.length>0,isModified:!0})},this.handleDrop=e=>{var t;null===(t=this._imagePanelRef.current)||void 0===t||t.handleFilePick(e)},this.handleDragChange=e=>{this.setState({isDragging:e})},this.getServerPrice=e=>parseInt(parseFloat(e).toFixed(2).toString().replace(/\.|,/g,""),10);const{product:n}=this.props;let a=!1,s=null!=n.currency?n.currency:y.currencyForCountryShortcode((0,C.getCountryShortcodeByPhone)((0,T.getMeUser)().user)),l=null==n.priceAmount1000?null:n.priceAmount1000,h="";if(null!=l&&null!=n.currency){const e=y.formatAmount1000ToParts(n.currency,l);h=`${e.integer}${e.decimal}`}this.canDisplayPrice(s)||(h="",s="",l=null,a=!0),this.state={name:n.name||"",priceAmount1000:l,description:n.description||"",url:n.url||"",retailerId:n.retailerId||"",priceStr:h,currency:s,isUpdating:!1,nameError:"",priceError:"",urlError:"",retailerIdError:"",imageError:"",hasImages:!!n.imageCdnUrl,isDragging:!1,isHidden:n.isHidden,isModified:a,isComplianceInfoAvailable:!1,complianceInfo:void 0}}componentDidMount(){const{listeners:e,catalog:t,product:n}=this.props;(0,P.canSeeECommerceComplianceIndiaSoftEnforcement)(t.id.user)&&this.setComplianceInfo(),e.add(n,"change:isHidden",(()=>{this.setState({isHidden:this.props.product.isHidden})}))}canDisplayPrice(e){return!(0,P.hideUnsupportedCurrency)()||y.isSupportedCurrency(e)}shouldComplianceBeHardEnforced(){const{catalog:e}=this.props;return(0,P.canSeeECommerceComplianceIndiaHardEnforcementBusinessJourney)(e.id.user)}errorsRevealed(){var e;const t=(0,T.getMeUser)(),n=this.state.isComplianceInfoAvailable;if(!this.shouldComplianceBeHardEnforced()||!n)return!1;const a=(0,r.default)((0,r.default)({},this.state.complianceInfo),{},{importerAddress:(0,r.default)({},null===(e=this.state.complianceInfo)||void 0===e?void 0:e.importerAddress)});if(!(0,_.existsField)(a.countryCodeOrigin,t))return a.countryCodeOriginError=d.fbt._("Add a country of origin",null,{hk:"3WA7X9"}),this.setState({complianceInfo:a}),!0;if(!this._showComplianceInfoImporterAddress())return!1;const{importerName:i,importerAddress:{street1:o,city:s,countryCode:l}}=a;let c=!1;return(0,_.existsField)(i,t)||(a.importerNameError=d.fbt._("Add an importer name",null,{hk:"3UwP1T"}),c=!0),(0,_.existsFieldIgnoreHardEnforcement)(o)||(a.importerAddress.street1Error=d.fbt._("Add an importer address line 1",null,{hk:"3HSMmN"}),c=!0),(0,_.existsFieldIgnoreHardEnforcement)(s)||(a.importerAddress.cityError=d.fbt._("Add an importer city",null,{hk:"1nq7dA"}),c=!0),(0,_.existsFieldIgnoreHardEnforcement)(l)||(a.importerAddress.countryCodeError=d.fbt._("Add an importer country",null,{hk:"3VmDTh"}),c=!0),!!c&&(this.setState({complianceInfo:a}),!0)}setComplianceInfo(){var e=this;return(0,i.default)((function*(){const{product:t,catalog:n,newProduct:a}=e.props;if(a)e.setState({isComplianceInfoAvailable:!0});else{yield f.CatalogCollection.findProduct({catalogWid:n.id,productId:t.id.toString(),shouldFetchComplianceFields:!0});const a=(0,s.default)(n,"catalog").productCollection.get(t.id),{countryCodeOrigin:r,importerName:i,importerAddress:o}=(null==a?void 0:a.complianceInfo)||{},l=r===String(x.SyntheticCountryCode.NotApplicable)?d.fbt._("Not Applicable",null,{hk:"2k1klN"}).toString():r&&(yield(0,x.getCountryName)(r)),c=(null==o?void 0:o.countryCode)&&(yield(0,x.getCountryName)(o.countryCode));e.setState({isComplianceInfoAvailable:!0,complianceInfo:{countryCodeOrigin:r,countryNameOrigin:l,countryCodeOriginError:"",importerName:i,importerNameError:"",importerAddress:{street1:null==o?void 0:o.street1,street1Error:"",street2:null==o?void 0:o.street2,postalCode:null==o?void 0:o.postalCode,city:null==o?void 0:o.city,cityError:"",region:null==o?void 0:o.region,countryCode:null==o?void 0:o.countryCode,countryName:c,countryCodeError:""}}})}}))()}isValid(){const{name:e,nameError:t,priceError:n,urlError:a,retailerIdError:r,imageError:i,hasImages:o,complianceInfo:s}=this.state;if(""===e.trim()||!1===o)return!1;const l=[t,n,a,r,i];return this._showComplianceInfoImporterAddress()&&l.push(null==s?void 0:s.importerNameError,null==s?void 0:s.importerAddress.street1Error,null==s?void 0:s.importerAddress.cityError,null==s?void 0:s.importerAddress.countryCodeError),this.shouldComplianceBeHardEnforced()&&l.push(null==s?void 0:s.countryCodeOriginError),l.every((e=>!e))}render(){const{catalog:e,product:t,onBack:n,onCancel:a,newProduct:r}=this.props,{isUpdating:i,isDragging:o,currency:s,nameError:c,priceError:u,urlError:f,retailerIdError:m,imageError:g,complianceInfo:v,isComplianceInfoAvailable:_}=this.state,x=(0,Q.jsx)(h.default,{type:"primary",onClick:this._handleSaveItem,disabled:!this.isValid(),a8nText:"product-edit-drawer-save-button",children:r?d.fbt._("Add to catalog",null,{hk:"3Dku2o"}):L.default.t(729)}),C=(0,Q.jsxs)("div",{className:I.default.drawerHeader,children:[(0,Q.jsx)(W.TextHeader,{level:"2",weight:"normal",customSize:"inherit",children:r?d.fbt._("Add new item",null,{hk:"3DqBBM"}):d.fbt._("Edit item",null,{hk:"2qzKLB"})}),(0,Q.jsx)("div",{className:I.default.drawerHeaderButtonContainer,children:x})]}),E=r?null:(0,Q.jsx)("div",{className:I.default.deleteButtonContainer,children:(0,Q.jsx)(h.default,{type:"warning",onClick:this._handleDeleteItem,a8nText:"product-edit-drawer-delete-button",children:d.fbt._("Delete Item",null,{hk:"Frzv9"})})}),w=(0,l.default)(I.default.productWrapper,{[I.default.isSending]:i}),T=o?(0,Q.jsx)(S.default,{}):null,M=i?(0,Q.jsx)("div",{className:I.default.spinner,children:(0,Q.jsx)(H.Spinner,{size:50,stroke:3})}):null,O=(0,Q.jsxs)("div",{className:I.default.hiddenContainer,children:[(0,Q.jsx)(p.CheckBox,{id:"product-hidden-check",onChange:this._handleHiddenChange,checked:this.state.isHidden,disabled:!1}),(0,Q.jsx)("label",{className:I.default.hiddenLabel,htmlFor:"product-hidden-check",children:d.fbt._("Hide item",null,{hk:"GjLlA"})}),(0,Q.jsx)("div",{className:I.default.hiddenDescr,children:d.fbt._("When you hide an item, customers won’t see it in your catalog.",null,{hk:"1crP8q"})})]});return(0,Q.jsxs)(j.default,{theme:"catalog",onDrop:this.handleDrop,onDragChange:this.handleDragChange,children:[T,(0,Q.jsx)(k.DrawerHeader,{a8n:"catalog-link-title",title:C,type:k.DRAWER_HEADER_TYPE.SMALL,onBack:n,onCancel:a,focusBackOrCancel:!0}),(0,Q.jsx)(b.default,{children:(0,Q.jsxs)("div",{className:w,children:[M,(0,Q.jsx)(F.default,{product:t,maxImageCount:D.MAX_PRODUCT_IMAGES,onChange:this._handleImageChange,ref:this._imagePanelRef,error:g}),(0,Q.jsx)(V.TextInput,{a8n:"product-edit-drawer-name-input",value:this.state.name,placeholder:d.fbt._("Name",null,{hk:"46mqET"}),onChange:this._handleNameChange,theme:"small",customStyleThemes:["desaturated"],maxLength:150,error:c,title:d.fbt._("Name",null,{hk:"47pzCN"})}),this.canDisplayPrice(this.state.currency)&&(0,Q.jsx)(V.TextInput,{a8n:"product-edit-drawer-price-input",value:this.state.priceStr,placeholder:L.default.t(552,{currencySymbol:y.formatAmount1000ToParts(s,0).symbol}),onChange:this._handlePriceChange,theme:"small",maxLength:30,customStyleThemes:["desaturated"],error:u,title:d.fbt._("Price",null,{hk:"1q6KRK"})}),(0,Q.jsx)(V.TextInput,{a8n:"product-edit-drawer-description-input",value:this.state.description,placeholder:d.fbt._("Description (Optional)",null,{hk:"38PzGH"}),onChange:this.handleDescriptionChange,theme:"small",maxLength:5e3,customStyleThemes:["desaturated"],multiline:!0,title:d.fbt._("Description",null,{hk:"2sGitZ"})}),(0,Q.jsx)(V.TextInput,{a8n:"product-edit-drawer-link-input",value:this.state.url,placeholder:d.fbt._("Link (Optional)",null,{hk:"18F36s"}),onChange:this._handleUrlChange,onBlur:this._handleUrlBlur,theme:"small",customStyleThemes:["desaturated"],maxLength:75,error:f,managed:!0,title:d.fbt._("Link",null,{hk:"1yLSRM"})}),(0,Q.jsx)(V.TextInput,{a8n:"product-edit-drawer-retailer-id-input",value:this.state.retailerId,placeholder:d.fbt._("Item Code (Optional)",null,{hk:"MWG64"}),onChange:this._handleRetailerIdChange,theme:"small",customStyleThemes:["desaturated"],maxLength:100,error:m,title:d.fbt._("Item code",null,{hk:"6trPE"})}),(0,P.canSeeECommerceComplianceIndiaSoftEnforcement)(e.id.user)?(0,Q.jsx)($,{isComplianceHardEnforced:this.shouldComplianceBeHardEnforced(),isComplianceInfoAvailable:_,showComplianceInfoImporterAddress:this._showComplianceInfoImporterAddress(),complianceInfo:v,onComplianceInfoChange:this._handleComplianceInfoChange,onComplianceInfoImporterAddressChange:this._handleComplianceInfoImporterAddressChange}):null,O,E]})})]},"catalog-link-drawer")}}function $(e){let{isComplianceInfoAvailable:t,isComplianceHardEnforced:n,showComplianceInfoImporterAddress:a,complianceInfo:r,onComplianceInfoChange:o,onComplianceInfoImporterAddressChange:s}=e;const[l,u]=(0,c.useState)([]),h=(0,c.useMemo)((()=>{const e=(0,T.getMeUser)().user;return l.length>0&&(0,P.canSeeECommerceComplianceIndiaCountryOriginExemptBusinessJourney)(e)?(0,x.bubbleCountryOnListOfCountries)(l,g.COMPLIANCE_INFO_CODES.INDIA,!0):l}),[l]),f=(0,c.useMemo)((()=>{const e=(0,T.getMeUser)().user;if(l.length>0&&(0,P.canSeeECommerceComplianceIndiaCountryOriginExemptBusinessJourney)(e)){let e=g.COMPLIANCE_INFO_CODES.INDIA;return"string"==typeof(null==r?void 0:r.countryCodeOrigin)&&""!==r.countryCodeOrigin&&(e=r.countryCodeOrigin),(0,x.formatCountriesOfOrigin)(l,e)}return l}),[l,null==r?void 0:r.countryCodeOrigin]),p=e=>`${e.toString()} (${d.fbt._("Optional",null,{hk:"4vf9yI"}).toString()})`,_=e=>!r||Object.values(r.importerAddress).every((e=>!e))?p(e):e;return(0,c.useEffect)((()=>{let e=!0;return(0,i.default)((function*(){const t=(0,T.getMeUser)().user;if((0,P.canSeeECommerceComplianceIndiaSoftEnforcement)(t)){const t=yield(0,x.getCountries)();e&&u(t)}}))(),()=>{e=!1}}),[]),t&&l.length?(0,Q.jsxs)("div",{a8n:"product-edit-drawer-compliance",children:[(0,Q.jsx)(V.TextInput,{a8n:"product-edit-drawer-compliance-country-of-origin-input",value:null==r?void 0:r.countryNameOrigin,placeholder:d.fbt._("Country of Origin",null,{hk:"2yl0F7"}),onChange:()=>{},theme:"small",customStyleThemes:["desaturated"],managed:!0,onFocus:()=>m.Cmd.showCountrySelector(d.fbt._("Country of Origin",null,{hk:"2yl0F7"}),null==r?void 0:r.countryCodeOrigin,f,(e=>{o("countryCodeOrigin",e)})),error:null==r?void 0:r.countryCodeOriginError}),a&&(0,Q.jsxs)(Q.Fragment,{children:[(0,Q.jsx)(V.TextInput,{a8n:"product-edit-drawer-compliance-importer-name-input",value:null==r?void 0:r.importerName,placeholder:_(d.fbt._("Importer Name",null,{hk:"3DW3Nn"})),onChange:e=>{o("importerName",e)},theme:"small",customStyleThemes:["desaturated"],maxLength:g.COMPLIANCE_INFO_LENGTH.IMPORTER_NAME,error:null==r?void 0:r.importerNameError}),(0,Q.jsx)(V.TextInput,{a8n:"product-edit-drawer-compliance-importer-address-street-1-input",value:null==r?void 0:r.importerAddress.street1,placeholder:_(d.fbt._("Importer Address Line 1",null,{hk:"1ORfyh"})),onChange:e=>{s("street1",e)},theme:"small",customStyleThemes:["desaturated"],maxLength:g.COMPLIANCE_INFO_LENGTH.STREET1,error:null==r?void 0:r.importerAddress.street1Error}),(0,Q.jsx)(V.TextInput,{a8n:"product-edit-drawer-compliance-importer-address-street-2-input",value:null==r?void 0:r.importerAddress.street2,placeholder:p(d.fbt._("Importer Address Line 2",null,{hk:"2pYt7Y"})),onChange:e=>{s("street2",e)},theme:"small",customStyleThemes:["desaturated"],maxLength:g.COMPLIANCE_INFO_LENGTH.STREET2}),(0,Q.jsx)(V.TextInput,{a8n:"product-edit-drawer-compliance-importer-address-city-input",value:null==r?void 0:r.importerAddress.city,placeholder:_(d.fbt._("Importer City",null,{hk:"4c06Q3"})),onChange:e=>{s("city",e)},theme:"small",customStyleThemes:["desaturated"],maxLength:g.COMPLIANCE_INFO_LENGTH.CITY,error:null==r?void 0:r.importerAddress.cityError}),(0,Q.jsx)(V.TextInput,{a8n:"product-edit-drawer-compliance-importer-address-region-input",value:null==r?void 0:r.importerAddress.region,placeholder:p(d.fbt._("Importer Region",null,{hk:"3MkbQD"})),onChange:e=>{s("region",e)},theme:"small",customStyleThemes:["desaturated"],maxLength:g.COMPLIANCE_INFO_LENGTH.REGION}),(0,Q.jsx)(V.TextInput,{a8n:"product-edit-drawer-compliance-importer-address-country-code-input",value:null==r?void 0:r.importerAddress.countryName,placeholder:_(d.fbt._("Importer Country",null,{hk:"3ar6sr"})),onChange:()=>{},theme:"small",customStyleThemes:["desaturated"],managed:!0,onFocus:()=>m.Cmd.showCountrySelector(d.fbt._("Importer Country",null,{hk:"3ar6sr"}),null==r?void 0:r.importerAddress.countryCode,h,(e=>{s("countryCode",e)})),error:null==r?void 0:r.importerAddress.countryCodeError}),(0,Q.jsx)(V.TextInput,{a8n:"product-edit-drawer-compliance-importer-address-postal-code-input",value:null==r?void 0:r.importerAddress.postalCode,placeholder:p(d.fbt._("Importer Zip/Postal Code",null,{hk:"Bbhqf"})),onChange:e=>{s("postalCode",e)},theme:"small",customStyleThemes:["desaturated"],maxLength:g.COMPLIANCE_INFO_LENGTH.POSTAL_CODE}),(0,Q.jsx)(v.ComplianceInfoHelpCenterBanner,{xstyle:Z.complianceInfoHelpCenterBanner})]})]}):(0,Q.jsx)(w.FlexRow,{align:"center",justify:"center",children:(0,Q.jsx)(w.FlexItem,{children:(0,Q.jsx)(H.Spinner,{})})})}t.EditProductDrawerImpl=J,J.contextType=E.DrawerContext,J.CONCERNS={product:["id","additionalImageCdnUrl","name","priceAmount1000","description","productImageCollection","reviewStatus","url","imageCdnUrl","retailerId","currency","isHidden","complianceInfo"]},J.displayName="EditProductDrawerImpl";const ee=(0,M.default)((0,q.default)((0,G.default)((0,O.ListenerHOC)(J),J.CONCERNS)));t.EditProductDrawer=ee},63935:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{onBack:t,onAddProductClick:n,isCreatingCatalogFn:a}=e,j=a(),b=(0,C.jsx)("div",{className:v.default.placeholderIcon}),E=(0,C.jsx)(d.default,{href:y,onClick:e=>{e.preventDefault(),(0,m.openExternalLink)(y)},children:o.fbt._("Facebook Product",null,{hk:"3JyFEa"})}),k=(0,C.jsx)(d.default,{href:S,onClick:e=>{e.preventDefault(),(0,m.openExternalLink)(S)},children:o.fbt._("Facebook Commercial Terms",null,{hk:"3LS54M"})}),I=(0,C.jsx)(d.default,{href:r.default.WA_COMMERCE_POLICY_URL,onClick:e=>{e.preventDefault(),(0,m.openExternalLink)(r.default.WA_COMMERCE_POLICY_URL)},children:o.fbt._("WhatsApp Commerce Policies",null,{hk:"2wf95I"})}),w=(0,C.jsx)(g.default,{id:263,params:{fb_product_link:E,fb_commerce_link:k,wa_commerce_policy_link:I}}),T=(0,i.default)({[v.default.isLoading]:j}),P=j?(0,C.jsx)("div",{className:v.default.spinner,children:(0,C.jsx)(_.Spinner,{size:50,stroke:3})}):null,M=j?(0,C.jsx)(s.default,{onClick:()=>{},theme:"default",idle:!!j}):(0,C.jsx)(h.DrawerContext.Consumer,{children:()=>(0,C.jsx)(s.default,{onClick:()=>{n()},theme:"default",idle:!1})});return(0,C.jsxs)(c.default,{children:[(0,C.jsx)(f.DrawerHeader,{title:o.fbt._("Catalog",null,{hk:"3YVOSV"}),type:f.DRAWER_HEADER_TYPE.LARGE,onBack:t}),(0,C.jsx)(u.default,{className:T,children:(0,C.jsxs)(p.default,{theme:"padding-small",animation:!1,children:[P,(0,C.jsx)(x.TextDiv,{theme:"title",children:o.fbt._("Add items to your catalog so customers can see what you're offering",null,{hk:"3z35i1"})}),M,(0,C.jsx)(x.TextDiv,{theme:"plain",children:w}),(0,C.jsxs)("div",{className:v.default.placeholderContainer,children:[(0,C.jsx)(l.default,{theme:"add-item-placeholder",image:b,customImage:!0,className:v.default.addItemPlaceholder,primary:"",secondary:"",idle:!0}),(0,C.jsx)("div",{className:v.default.divider}),(0,C.jsx)(l.default,{theme:"add-item-placeholder",image:b,customImage:!0,className:v.default.addItemPlaceholder,primary:"",secondary:"",idle:!0}),(0,C.jsx)("div",{className:v.default.divider})]})]})})]},"catalog-link-drawer")};var r=a(n(64369)),i=a(n(94184)),o=n(48360),s=a(n(33889)),l=a(n(44356)),d=a(n(99360)),c=a(n(60453)),u=a(n(69637)),h=n(27394),f=n(94790),p=a(n(33308)),m=n(12591),g=a(n(56074)),v=a(n(3840)),_=n(11054),x=n(13923),C=n(85893);const y="https://www.facebook.com/legal/terms",S="https://www.facebook.com/policies/commerce"},14746:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.ProductInfoDrawer=function(e){const{onCancel:t,collectionId:n,catalog:a,onEditProduct:P,onShareProduct:M,isPushed:L=!0}=e,O=(0,i.useContext)(d.DrawerContext),A=(0,w.useModelValues)(e.product,["id","catalogWid","name","priceAmount1000","description","productImageCollection","reviewStatus","url","canAppeal","imageCdnUrl","retailerId","currency","isHidden"]),[D,R]=(0,i.useState)(!0);(0,i.useEffect)((()=>{const e=(0,f.getMaybeMeUser)();L&&(0,g.qplAnnotateProductView)(!(null==e?void 0:e.equals(A.catalogWid))),a.pullProduct(A.id.toString(),L).then((()=>{L&&(0,g.qplEndProductView)(E.QuickLogActionType.SUCCESS)})).catch((()=>{L&&(0,g.qplEndProductView)(E.QuickLogActionType.FAIL)})).finally((()=>{R(!1)})),(0,m.logProductDetailView)({product:A,catalogContext:(0,_.getProductCatalogContext)(O),collectionId:n})}),[]);const N=(0,f.getMaybeMeUser)(),F=k.StatusCollection.get(N),B=(0,T.jsx)(I.TextDiv,{theme:"muted",className:y.default.businessInfoTitle,children:r.fbt._("Business Info",null,{hk:"20HLtr"})}),U=A.reviewStatus!==x.PRODUCT_REVIEW_STATUS.APPROVED||A.isHidden,H=(0,T.jsxs)("div",{children:[(0,T.jsx)("div",{className:y.default.buttonSeparator,children:(0,T.jsx)(o.default,{type:"strong",onClick:()=>{P&&P(A)},a8nText:"product-info-drawer edit-button",children:p.default.t(402)})}),(0,T.jsx)(o.default,{type:"strong-primary",onClick:()=>{M&&M(A)},disabled:U,a8nText:"product-info-drawer share-button",children:r.fbt._("Share",null,{hk:"3RmUA"})})]}),G=(0,T.jsxs)("div",{className:y.default.drawerHeader,children:[(0,T.jsx)("div",{className:y.default.productName,children:A.name}),(0,T.jsx)("div",{className:y.default.drawerHeaderButtonContainer,children:H})]}),W=F?(0,T.jsx)(u.default,{title:B,theme:"no-padding",children:(0,T.jsx)(b.default,{status:F})}):null,V=D?(0,T.jsx)(h.default,{}):(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(j.default,{product:A,isAvailable:!0,fetching:!1}),(0,T.jsx)(S.default,{product:A}),(0,T.jsx)(C.default,{product:A,collectionId:n,onSendChat:()=>{t(),(0,v.sendProductToChat)(A,a),(0,m.logProductMessageBusinessClick)(A,(0,_.getProductCatalogContext)(O))},isAvailable:!0})]});return(0,T.jsxs)(s.default,{theme:"catalog",children:[(0,T.jsx)(c.DrawerHeader,{a8n:"catalog-product-title",title:G,type:c.DRAWER_HEADER_TYPE.SMALL,onCancel:t,headingLevel:"2",focusBackOrCancel:!0}),(0,T.jsxs)(l.default,{children:[(0,T.jsx)(u.default,{theme:"center-column-fixed-width",children:V}),(0,T.jsx)("div",{className:y.default.productWrapper,children:W})]})]},"catalog-link-drawer")};var r=n(48360),i=n(67294),o=a(n(39770)),s=a(n(60453)),l=a(n(69637)),d=n(27394),c=n(94790),u=a(n(33308)),h=a(n(29796)),f=n(99234),p=a(n(43725)),m=n(77975),g=n(82145),v=n(96519),_=n(97567),x=n(5641),C=a(n(16481)),y=a(n(93748)),S=a(n(11956)),j=a(n(33382)),b=a(n(37867)),E=n(48870),k=n(46133),I=n(13923),w=n(49082),T=n(85893)},11956:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{product:t}=e;const n=(0,x.jsx)(l.default,{href:i.default.WA_COMMERCE_POLICY_URL,onClick:e=>{e.preventDefault(),(0,u.openExternalLink)(i.default.WA_COMMERCE_POLICY_URL)},children:h.default.t(554)});if(t.reviewStatus===m.PRODUCT_REVIEW_STATUS.APPROVED)return t.isHidden?(0,x.jsxs)("div",{className:g.default.root,children:[(0,x.jsx)("div",{className:g.default.icon,children:(0,x.jsx)(v.default,{name:"hide"})}),(0,x.jsx)("div",{className:g.default.text,children:(0,x.jsx)(_.TextDiv,{children:o.fbt._("You hid this item. Your customers can't see it in your catalog",null,{hk:"28Rw4y"})})})]}):null;if(t.reviewStatus===m.PRODUCT_REVIEW_STATUS.REJECTED){if(!0===t.canAppeal){const e=(0,x.jsx)(f.default,{id:266,params:{learn_more_link:n}}),a=(0,x.jsx)(l.default,{onClick:function(){d.Cmd.openModal((0,x.jsx)(c.DrawerContext.Consumer,{children:e=>(0,x.jsx)(s.default,{product:t,sessionId:(0,p.getProductCatalogSessionId)(e)})}))},a8n:"product-appeal-button",children:o.fbt._("request another review",null,{hk:"1edAPz"})}),i=(0,x.jsx)(f.default,{id:264,params:{request_review_link:a},className:g.default.appealText,tabIndex:"0"});return(0,x.jsxs)("div",{className:g.default.root,"data-a8n":r.default.key("product-appeal-rejected-initial-review"),children:[(0,x.jsx)("div",{className:g.default.icon,children:(0,x.jsx)(v.default,{name:"info"})}),(0,x.jsxs)("div",{className:g.default.text,children:[e,i]})]})}const e=(0,x.jsx)(f.default,{id:265,params:{learn_more_link:n}});return(0,x.jsx)("div",{className:g.default.root,"data-a8n":r.default.key("product-appeal-rejected-final"),children:e})}if(t.reviewStatus===m.PRODUCT_REVIEW_STATUS.NO_REVIEW||t.reviewStatus===m.PRODUCT_REVIEW_STATUS.OUTDATED){const e=t.isHidden?(0,x.jsx)(f.default,{id:268,params:{learn_more_link:n}}):(0,x.jsx)(f.default,{id:267,params:{learn_more_link:n}});return(0,x.jsx)("div",{className:g.default.root,"data-a8n":r.default.key("product-appeal-pending-initial-review"),children:e})}if(!1===t.canAppeal){const e=o.fbt._("Your appeal was submitted. If it’s approved, your item will be added to your catalog. If it’s not approved, you’ll be notified.",null,{hk:"4aNdXt"});return(0,x.jsx)("div",{className:g.default.root,"data-a8n":r.default.key("product-appeal-pending-appeal"),children:e})}return null};var r=a(n(99964)),i=a(n(64369)),o=n(48360),s=a(n(43318)),l=a(n(99360)),d=n(88102),c=n(27394),u=n(12591),h=a(n(43725)),f=a(n(56074)),p=n(97567),m=n(5641),g=a(n(51817)),v=a(n(23217)),_=n(13923),x=n(85893)},37867:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const t=(0,l.useModelValues)(e.status,["status"]);return(0,d.jsx)(r.default,{image:(0,d.jsx)(o.DetailImage,{id:(0,s.getMaybeMeUser)()}),primary:i.Conn.pushname,secondary:t.status,idle:!0})};var r=a(n(44356)),i=n(17239),o=n(88984),s=n(99234),l=n(49082),d=n(85893)},87728:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){let{businessProfile:t,catalog:n,openCatalog:a=m}=e;const l=(0,o.hasShop)(t),g=Boolean(l&&h.ServerProps.shopsProductGrid);if((0,i.useEffect)((()=>{(0,c.logShopsManagementEvent)(u.default.SHOPS_MANAGEMENT_ACTION.ACTION_SHOPS_PRODUCT_PREVIEW_VISIBLE,{shouldLogJid:!1,isShopsProductPreviewVisible:g})}),[g]),l)return g?(0,p.jsx)(f.default,{isEditMode:!0,subtitle:d.default.t(591),businessProfile:t,catalog:n,productsToShow:3}):null;return(0,p.jsx)(s.default,{catalog:n,onProductDetail:a,onProductCatalog:()=>{a()},productsToShow:3,catalogEntryLabel:null==n?r.fbt._("Add catalog",null,{hk:"2iihM5"}):r.fbt._("View or edit catalog",null,{hk:"354QjL"}),showProductPlaceholders:!0,seeMoreOverlay:!0,sectionTheme:"refresh"})};var r=n(48360),i=n(67294),o=n(94010),s=a(n(42953)),l=n(87912),d=a(n(43725)),c=n(55631),u=a(n(11339)),h=n(64551),f=a(n(82495)),p=n(85893);function m(e){(0,l.openCatalogManagementFlow)(e,u.default.CATALOG_ENTRY_POINT.CATALOG_ENTRY_POINT_PROFILE)}},75260:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(48360),i=n(67294),o=a(n(49107)),s=a(n(62342)),l=n(71174),d=n(65417),c=a(n(23217)),u=n(18644),h=a(n(24717)),f=n(85893);function p(e){const{collection:t,theme:n,onDelete:a,onEdit:p,onSeeCollection:m,canManage:g}=e,[v]=(0,i.useState)(!1),[_,x]=(0,i.useState)(null),C=e=>{e.preventDefault(),e.stopPropagation(),a&&a(t)},y=e=>{e.preventDefault(),e.stopPropagation(),p&&p(t)},S=()=>{x(null)},j=(0,f.jsx)("div",{className:s.default.collectionIcon,children:(0,f.jsx)("div",{className:s.default.iconContainer,children:(0,f.jsx)(c.default,{name:"collections_folder"})})}),b=(0,f.jsx)(d.EmojiText,{text:t.name,ellipsify:!0,titlify:!0});let E;return _&&(E=(0,f.jsx)(u.UIE,{displayName:"CollectionContextMenu",escapable:!0,popable:!0,requestDismiss:S,children:(0,f.jsx)(h.default,{contextMenu:_})})),(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(o.default,{customImage:!0,image:j,primary:b,theme:n,active:v,contextEnabled:()=>e.canManage,onContext:e=>{if(_)return void x(null);const t=[];g&&(t.push((0,f.jsx)(l.DropdownItem,{a8n:"mi-edit-collection",action:y,children:r.fbt._("Edit",null,{hk:"Xow6E"})},"EditLabel")),t.push((0,f.jsx)(l.DropdownItem,{a8n:"mi-delete-collection",action:C,children:r.fbt._("Delete",null,{hk:"1rLhBB"})},"DeleteLabel"))),x({menu:t,event:e.event,anchor:e.anchor})},onClick:e=>{e.preventDefault(),e.stopPropagation(),m&&m(t)}},t.id.toString()),E]})}p.defaultProps={theme:"collection-edit",isMuted:!1};var m=p;t.default=m},92625:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{data:t,canManage:n,onEditCollection:a,onSeeCollection:p}=e,m=(0,h.useModelValues)(e.catalog,["collections"]);return(0,f.jsx)(d.default,{flatListControllers:[e.flatListController],children:(0,f.jsx)(l.FlatList,{flatListController:e.flatListController,direction:"vertical",forceConsistentRenderCount:!1,data:(()=>{const e=[];return t.forEach((t=>{t.collection&&e.push({itemKey:t.collection.id,collection:t.collection})})),e})(),renderItem:e=>{let{collection:t}=e;return(0,f.jsx)(s.DrawerContext.Consumer,{children:e=>(0,f.jsx)(o.default,{collection:t,canManage:n,onDelete:()=>((e,t)=>{(0,r.handleCollectionDelete)((0,u.unproxy)(m),e,t)})(t,(0,c.getProductCatalogContext)(e)),onEdit:a,onSeeCollection:p})})},defaultItemHeight:i.PRODUCT_LIST_ITEM_HEIGHT})})};var r=n(47217),i=n(64481),o=a(n(75260)),s=n(27394),l=n(47915),d=a(n(44942)),c=n(97567),u=n(31019),h=n(49082),f=n(85893)},95416:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{setScrollOffset:t,editCollection:n,onSeeCollection:a}=e,E=(0,y.default)(),k=(0,C.default)((()=>E()),100),I=(0,S.default)((()=>new m.default)),[w,T]=(0,i.useState)(!0),[P,M]=(0,i.useState)(null),[L,O]=(0,i.useState)(null),A=(0,i.useMemo)((()=>{const e=(0,v.getMeUser)();return s.CatalogCollection.get(e)}),[]);(0,i.useEffect)((()=>{const{isPushed:t=!0}=e;if(A){const e=new d.CollectionsDataSource(A,!0,l.PRODUCT_LIST_ITEM_HEIGHT,t);A.collections.on("add remove",k);const n=new d.CatalogListItemScrollHelper(e);M(e),O(n),e.loadInitialItems().then((()=>{T(!1),t&&_.QPL.markerEnd(x.QuickLogMarkerId.WHATSAPP_COLLECTIONS_MANAGEMENT_VIEW,_.QuickLogActionType.SUCCESS)})).catch((()=>{t&&_.QPL.markerEnd(x.QuickLogMarkerId.WHATSAPP_COLLECTIONS_MANAGEMENT_VIEW,_.QuickLogActionType.FAIL)}))}}),[]);const D=(0,j.default)((e=>{const n=e.currentTarget;t&&t(n.scrollTop),(null==L?void 0:L.willLoadMore(n))&&T(!0),null==L||L.onScroll(e,n).then((e=>{e&&T(!1)})).catch((e=>{throw T(!1),e}))}),100);return(0,b.jsxs)(h.default,{theme:"products",onDrop:e.onBack,children:[(0,b.jsx)(p.DrawerHeader,{title:r.fbt._("Collections",null,{hk:"I9pEH"}),type:p.DRAWER_HEADER_TYPE.LARGE,onBack:e.onBack,menu:(0,b.jsx)(b.Fragment,{})}),(0,b.jsx)(f.default,{onScroll:D,flatListControllers:[I.current],scrollOffset:e.scrollOffset,children:A&&P?(0,b.jsxs)("div",{children:[(0,b.jsx)(o.default,{onClick:()=>{n(null)},theme:"collections",title:r.fbt._("New collection",null,{hk:"2Q4UnS"})}),(0,b.jsx)(c.default,{canManage:!0,catalog:A,onEditCollection:n,data:P.getData(),flatListController:I.current,onSeeCollection:a}),w&&(0,b.jsx)("div",{className:u.default.loadingSpinner,children:(0,b.jsx)(g.default,{})})]}):null})]})};var r=n(48360),i=n(67294),o=a(n(33889)),s=n(99989),l=n(64481),d=n(71599),c=a(n(92625)),u=a(n(40302)),h=a(n(60453)),f=a(n(69637)),p=n(94790),m=a(n(30855)),g=a(n(29796)),v=n(99234),_=n(48870),x=n(27798),C=a(n(81559)),y=a(n(59909)),S=a(n(59552)),j=a(n(88857)),b=n(85893)},30327:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(15461),i=n(48360),o=n(67294),s=(a(n(56720)),n(80666)),l=n(88102),d=n(60769),c=n(78986),u=n(58668),h=n(43257),f=a(n(34949)),p=a(n(39658)),m=n(3013),g=n(48870),v=n(27798),_=a(n(23217)),x=n(50452),C=a(n(1784)),y=a(n(41956)),S=n(85893);const j={btnDelete:{position:"lhggkp7q",top:"hdpg1tjz",end:"ltcz4qz9",zIndex:"mb8var44",color:"k17s6i4e",filter:"rhe1kc9j"},btnAdd:{display:"p357zi0d",flexDirection:"f8m0rgwh",alignItems:"gndfcl4n",justifyContent:"ac2vgrno",width:"jkv2xdwy",height:"sptw4ec9",fontSize:"lak21jic",fontWeight:"hnx8ox4h",lineHeight:"gz7w46tb",letterSpacing:"hql59cr1"}};function b(e){let{images:t,deleteImage:n}=e;return t.filter((e=>e.mediaData)).map(((e,t)=>(0,S.jsxs)("div",{className:p.default.imageTile,children:[(0,S.jsx)(C.default,{xstyle:j.btnDelete,"aria-label":i.fbt._("Remove image number {imageNumber}",[i.fbt._param("imageNumber",t+1)],{hk:"11vQtK"}),a8nText:"delete-image",onClick:()=>n(e),children:(0,S.jsx)(_.default,{className:p.default.deleteIcon,name:"x-alt"})}),(0,S.jsx)(m.ProductThumb,{mediaData:e.mediaData,className:p.default.imageThumb})]},e.mediaData.filehash)))}function E(e){let{inputRef:t,handleFilePick:n}=e;return(0,S.jsx)("input",{ref:t,type:"file",accept:h.IMAGE_MIMES,style:{display:"none"},onChange:n,multiple:!0})}function k(e){let{onAddFileClick:t}=e;return(0,S.jsx)("div",{className:p.default.btnAddContainer,children:(0,S.jsxs)(C.default,{xstyle:j.btnAdd,"aria-label":i.fbt._("Add additional image",null,{hk:"1zIuu3"}),onClick:t,a8nText:"add-image",children:[(0,S.jsx)(_.default,{name:"camera"}),(0,S.jsx)("div",{className:p.default.btnAddText,children:i.fbt._("Add Images",null,{hk:"3yrGBr"})})]})})}function I(e){let{error:t}=e;return(0,S.jsx)("div",{className:p.default.errorMessage,role:"alert",children:t})}function w(e,t){const{maxImageCount:n,onChange:a,error:m,product:_}=e,C=(0,o.useRef)(null),[j,w]=(0,o.useState)((()=>_.productImageCollection.filter((e=>!e.old)).map((e=>({url:e.mediaUrl,mediaData:e.mediaData}))))),T=e=>{e.mediaPrep.waitForPrep().then((t=>{if((e=>!(j.filter((t=>t.mediaData.filehash===e.filehash)).length>0&&(l.Cmd.openToast((0,S.jsx)(x.Toast,{id:(0,x.genId)(),msg:i.fbt._("Two or more images are the same. Delete any duplicates and try again.",null,{hk:"3qIMS6"})})),1)))(t)){t.mediaStage=u.MEDIA_DATA_STAGE.RESOLVED,t.renderableUrl=e.fullPreview;const n=t.mediaBlob;!n||n instanceof f.default||f.default.createFromData(n,n.type).then((e=>{t.mediaBlob=e}));const r=[...j,{url:null,mediaData:t}];w(r),null==a||a(r)}}))},P=e=>{(0,d.getFiles)(e,h.IMAGE_MIMES).then((e=>{const t=n-j.length;e.length>t&&l.Cmd.openToast((0,S.jsx)(x.Toast,{msg:i.fbt._("You've reached the maximum number of images to add.",null,{hk:"2ra3Nx"}),duration:6e3,action:{onAction:()=>{},actionText:i.fbt._("GOT IT",null,{hk:"175geM"}),dismiss:!0,theme:"success"},id:(0,x.genId)()})),e.slice(0,n-j.length).map((e=>({file:e,filename:e.name,mimetype:e.type,type:r.MSG_TYPE.PRODUCT}))).map((e=>{var t;const n=new s.AttachMedia({file:Promise.resolve(e)});return null===(t=n.processPromise)||void 0===t?void 0:t.then((()=>{T(n)}))}))})),e.target.value&&(e.target.value="")},M=()=>{const e=j.filter((e=>null==e.url)).length;g.QPL.markerAnnotate(v.QuickLogMarkerId.WHATSAPP_PRODUCT_SAVE,{int:{ImagesCount:e}}),g.QPL.markerPoint(v.QuickLogMarkerId.WHATSAPP_PRODUCT_SAVE,"images_upload_start");const t=j.filter((e=>null==e.url)).map((e=>{const{mediaData:{mediaBlob:t,filehash:n}}=e;return t instanceof f.default?(0,c.uploadProductImage)(t,n).then((t=>{e.url=t})):null})).filter(Boolean);return Promise.all(t).then((()=>(g.QPL.markerPoint(v.QuickLogMarkerId.WHATSAPP_PRODUCT_SAVE,"images_upload_end"),j.map((e=>e.url||"")))))};return(0,o.useImperativeHandle)(t,(()=>({uploadImages:M,handleFilePick:P}))),(0,S.jsxs)("div",{className:p.default.panel,children:[(0,S.jsxs)("div",{className:p.default.tileContainer,children:[(0,S.jsxs)(y.default,{transitionAppear:!0,transitionName:"thumb-scale-flex",children:[(0,S.jsx)(b,{images:j,deleteImage:e=>{const t=j.filter((t=>t!==e));w(t),null==a||a(t)}}),j.length<n?(0,S.jsx)(k,{onAddFileClick:()=>{if(C.current){C.current.click()}}}):null]}),(0,S.jsx)(E,{inputRef:C,handleFilePick:P})]}),(0,S.jsx)(I,{error:m})]})}var T=(0,o.forwardRef)(w);t.default=T},46767:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){let{flatListController:t,onProductDetail:n,productMessageList:a}=e;const C=a.productCollection.getProductModels(),y=a.getSections(),S=a.getSectionsCount()>0,j=a.getTotalProductsFetchedOrFailed(),b=a.getProductSize()===j&&0===C.length,E=[];y.forEach(((e,t)=>{let{title:n,products:a}=e;const r=[];a.forEach((e=>{let{productId:n}=e;const a=C.find((e=>e.id===n));null!=a&&r.push({itemKey:`section-${t}-${a.id.toString()}`,product:a,type:"product",height:o.PRODUCT_LIST_ITEM_HEIGHT})})),r.length>0&&(null!=n&&""!==n&&E.push({itemKey:`header-${t}-${n}`,label:n,type:"section",height:72}),E.push(...r))}));const k=(0,i.useCallback)(((e,t)=>((0,u.logCatalogListDetailClick)({product:(0,_.unproxy)(e),catalogContext:t}),(0,h.qplStartProductView)("PLM"),n(e))),[n]),I=(0,i.useCallback)((e=>{let t=null;switch(e.type){case"section":const{label:n}=e;t=(0,x.jsx)(v.default,{header:n});break;case"product":const{product:a}=e;t=(0,x.jsx)(l.DrawerContext.Consumer,{children:e=>(0,x.jsx)(p.default,{product:a,onClick:()=>k(a,(0,f.getProductCatalogContext)(e)),canManageCatalog:!1})})}return t}),[k]);return(0,i.useEffect)((()=>{b&&s.Cmd.openModal((0,x.jsx)(g.default,{onConfirm:()=>{s.Cmd.closeDrawerRight(),s.Cmd.closeModal()}}))}),[b]),(0,x.jsx)("div",{className:(0,r.default)({[m.default.list]:!0,[m.default.noSections]:!S}),children:(0,x.jsx)(c.default,{flatListControllers:[t],children:(0,x.jsx)(d.FlatList,{flatListController:t,direction:"vertical",forceConsistentRenderCount:!1,data:E,renderItem:I,itemEnterAnimationsEnabled:!0})})})};var r=a(n(94184)),i=n(67294),o=n(64481),s=n(88102),l=n(27394),d=n(47915),c=a(n(44942)),u=n(77975),h=n(82145),f=n(97567),p=a(n(88990)),m=a(n(31516)),g=a(n(8714)),v=a(n(11497)),_=n(31019),x=n(85893)},91695:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.ProductMessageListDrawer=function(e){const{productListId:t,setScrollOffset:n,onCartClick:a,onProductDetail:R}=e,N=(0,A.default)(),F=(0,M.default)((()=>new x.default)),B=(0,s.useContext)(p.DrawerContext),U=(0,O.useModelValues)(e.contact,["id"]),[H,G]=(0,s.useState)(!1),[W,V]=(0,s.useState)(0),[z,q]=(0,s.useState)(!1),[K,Y]=(0,s.useState)((()=>k.ProductMessageListCollection.get(t))),[Q]=(0,s.useState)((()=>l.CartCollection.findCart(U.id.toString()))),[X,Z]=(0,s.useState)(Q.itemCount),[J,$]=(0,s.useState)(!1),[ee,te]=(0,s.useState)(K?"SUCCESS":"NONE"),ne=n=>{const{isPushed:a=!0}=e,r=a&&!0===n,i=k.ProductMessageListCollection.assertGet(t),o=i.getTotalProductsFetchedOrFailed(),s=i.getProductSize();if(z||o===s)return r&&(w.QPL.markerAnnotate(T.QuickLogMarkerId.WHATSAPP_PLM_DETAILS_VIEW,{int:{ProductsCount:o}}),w.QPL.markerEnd(T.QuickLogMarkerId.WHATSAPP_PLM_DETAILS_VIEW,w.QuickLogActionType.SUCCESS)),void q(!0);G(!0),V(o);const l=r?T.QuickLogMarkerId.WHATSAPP_PLM_DETAILS_VIEW:void 0;k.ProductMessageListCollection.update(t,{markerId:l}).then((e=>{if(N.aborted)return void(r&&w.QPL.markerDrop(T.QuickLogMarkerId.WHATSAPP_PLM_DETAILS_VIEW));G(!1);const t=(Array.isArray(e)?e[0]:e).getTotalProductsFetchedOrFailed();t===W&&q(!0),r&&(w.QPL.markerAnnotate(T.QuickLogMarkerId.WHATSAPP_PLM_DETAILS_VIEW,{int:{ProductsCount:t}}),w.QPL.markerEnd(T.QuickLogMarkerId.WHATSAPP_PLM_DETAILS_VIEW,w.QuickLogActionType.SUCCESS)),o*c.PRODUCT_LIST_ITEM_HEIGHT<window.innerHeight&&ne()})).catch((()=>{G(!1),q(!0),r&&w.QPL.markerEnd(T.QuickLogMarkerId.WHATSAPP_PLM_DETAILS_VIEW,w.QuickLogActionType.FAIL)}))},ae=function(){var n=(0,r.default)((function*(){const{isPushed:n=!0}=e;try{const e=yield k.ProductMessageListCollection.find(t);if(N.aborted)return void(n&&w.QPL.markerDrop(T.QuickLogMarkerId.WHATSAPP_PLM_DETAILS_VIEW));Y(e),te("SUCCESS"),ne(!0)}catch(e){(0,v.parseErrorState)(e,(e=>te(e))),n&&w.QPL.markerEnd(T.QuickLogMarkerId.WHATSAPP_PLM_DETAILS_VIEW,w.QuickLogActionType.FAIL)}}));return function(){return n.apply(this,arguments)}}();(0,s.useEffect)((()=>{K?ne():ae(),(0,u.default)(U.id).then((e=>{N.aborted||$(e)}))}),[]),(0,L.useListener)(Q,"all",(()=>{Z(Q.itemCount)}));const re=()=>{(0,S.qplStartCartView)("PLM"),null==a||a(U.id.toString())};return(0,D.jsxs)(h.default,{theme:"products",onDrop:e.onBack,children:[(0,D.jsx)(m.DrawerHeader,{title:(0,D.jsx)("div",{className:I.default.title,children:(0,D.jsx)(g.EmojiText,{text:null==K?void 0:K.title,ellipsify:!0})}),type:m.DRAWER_HEADER_TYPE.SMALL,onBack:e.onBack,menu:(()=>{if(null==a||!J)return null;const e=(0,P.isNumber)(X)&&X>0?X.toString():void 0,t=(0,y.getOnCartClickWithLog)(re,U.id.toString(),(0,b.getProductCatalogContext)(B));return(0,D.jsx)(j.MenuBarItem,{a8nText:"menu-bar-cart-link",icon:(0,D.jsx)(d.default,{theme:"inherit-color"}),text:e,title:o.fbt._("Your cart",null,{hk:"Sn66V"}),onClick:t})})()}),(0,D.jsx)(f.default,{onScroll:e=>{var t;t=e.currentTarget,H||t.scrollTop+i.SCROLL_FUDGE>t.scrollHeight-t.clientHeight&&ne(),null==n||n(e.currentTarget.scrollTop)},flatListControllers:[F.current],scrollOffset:e.scrollOffset,children:K?(0,D.jsx)(D.Fragment,{children:(0,D.jsxs)("div",{children:[(0,D.jsx)(E.default,{productMessageList:K,flatListController:F.current,onProductDetail:R}),H&&(0,D.jsx)(C.default,{})]})}):(0,D.jsx)(_.default,{fetchState:ee})})]})};var r=a(n(48926)),i=n(41906),o=n(48360),s=n(67294),l=n(12392),d=a(n(51070)),c=n(64481),u=a(n(17986)),h=a(n(60453)),f=a(n(69637)),p=n(27394),m=n(94790),g=n(65417),v=n(14375),_=a(n(61055)),x=a(n(30855)),C=a(n(29796)),y=n(88571),S=n(82145),j=n(46346),b=n(97567),E=a(n(46767)),k=n(18952),I=a(n(77948)),w=n(48870),T=n(27798),P=n(31515),M=a(n(59552)),L=n(19529),O=n(49082),A=a(n(38080)),D=n(85893)},8714:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){let{onConfirm:t}=e;return(0,s.jsx)(i.default,{onOK:t,okText:r.fbt._("OK",null,{hk:"2KEeHb"}),children:(0,s.jsx)(o.EmojiText,{text:r.fbt._("Items in this message are no longer available",null,{hk:"1MclQl"})})})};var r=n(48360),i=a(n(52665)),o=n(65417),s=n(85893)},5537:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(n(45095)),i=n(48360),o=n(67294),s=n(99989),l=n(56728),d=a(n(29861)),c=n(85893);const u=(e,t)=>{const[n,a]=(0,o.useState)(!1),[u,h]=(0,o.useState)([]),f=(0,c.jsx)(d.default,{disabled:!n,onClick:()=>{var t;const n=(0,r.default)(null===(t=u[0])||void 0===t?void 0:t.catalogWid,"products[0]?.catalogWid"),a=(0,r.default)(s.CatalogCollection.get(n),"CatalogCollection.get(catalogWid)");e.onShare(a)}});return(0,c.jsx)(l.SelectModal,{ref:t,title:i.fbt._("Send products",null,{hk:"3C7pQj"}),onCancel:e.onCancel,onConfirm:e.onConfirm,listType:l.ListType.PRODUCT_SELECT_MODAL,enableSearchBox:!1,customHeader:f,onSelectionChanged:(e,t,n)=>{a(0===n.length)},onDataLoaded:e=>{const t=e;h(t),a(t.length>0)}})};var h=(0,o.forwardRef)(u);t.default=h},29861:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const t=e.disabled?s.default.disabled:"",n=e.disabled?null:e.onClick,a=(0,d.jsx)("span",{className:s.default.title,children:r.fbt._("Send catalog",null,{hk:"BiYcl"})}),c=(0,d.jsx)(o.default,{theme:"compact",disabled:e.disabled,children:(0,d.jsx)(l.default,{name:"catalog"})});return(0,d.jsx)(i.default,{image:c,onClick:n,primary:a,theme:"list-button-compact",className:t})};var r=n(48360),i=a(n(44356)),o=a(n(52711)),s=a(n(47514)),l=a(n(23217)),d=n(85893)},56790:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(n(99964)),i=a(n(44356)),o=n(22683),s=a(n(4389)),l=n(85893);t.default=e=>{let{title:t,icon:n,t:a}=e;const d=null!=a?o.Clock.relativeDateAndTimeStr(a):"-",c=(0,l.jsxs)("div",{className:s.default.title,"data-a8n":r.default.key("msg-info-title"),children:[n,t]});return(0,l.jsx)(i.default,{primary:c,secondary:d,theme:"plain",idle:!0})}},82678:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const t=(0,l.useModelValues)(e.msg,["numTimesForwarded","isFrequentlyForwarded"]),{numTimesForwarded:n,isFrequentlyForwarded:a}=t;if(n<=0||a)return null;const c=(0,d.jsx)(o.default,{name:"forwarded",display:"inline",className:i.default.icon}),u=r.default.t(470,{count:n,_plural:n});return(0,d.jsxs)("div",{className:i.default.title,children:[c,(0,d.jsx)(s.TextSpan,{theme:"title",className:i.default.text,children:u})]})};var r=a(n(43725)),i=a(n(70180)),o=a(n(23217)),s=n(13923),l=n(49082),d=n(85893)},35487:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(55715),i=n(48360),o=n(67294),s=a(n(56720)),l=a(n(22245)),d=n(65511),c=n(69951),u=n(2732),h=n(47915),f=n(29424),p=a(n(43725)),m=a(n(11497)),g=a(n(87481)),v=a(n(59552)),_=a(n(83800)),x=n(85893);const C={height:"ttegvvei",overflowX:"gfz4du6o",overflowY:"r7fjleex",backgroundColor:"ihvf49ua"};function y(e,t){const{contacts:n,frequentContacts:a,onFocusSearch:y,onClick:S,showPersonGroupDivisionHeader:j}=e,b=(0,o.useRef)(null),E=(0,v.default)((()=>new g.default([],(e=>e.id.toString())))),k=()=>{E.current.setFirst(!0)};(0,o.useImperativeHandle)(t,(()=>({focusFirst:k})));const I=(e,t)=>{const n=(t?u.FREQUENT_PREFIX:"")+e.id.toString();if(e.isGroup){const a=c.ChatCollection.get(e.id);return a?{itemKey:n,data:a,type:3,frequent:t}:null}return{itemKey:n,data:e,type:2,frequent:t}},w=(0,o.useMemo)((()=>{const e=[];return null==a||a.forEach((t=>{const n=I(t,!0);n&&e.push(n)})),e}),[a]),T=(0,_.default)((e=>{if(0===e.length)return[];const t=e[0].isGroup?"group":"contact",n=[],a=e.length>10;let r="XXX";for(let i=0;i<e.length;i++){const o=e[i];if(a&&o.header){const a=o.header;if(a!==r){const o=i<e.length-1&&a!==e[i+1].header;n.push({itemKey:`header-${t}-${a}`,data:a,separator:o,type:1}),r=a}}const s=I(o);s&&n.push(s)}return n})),P=(0,o.useMemo)((()=>{const t=[],a=[],r=[];w.length&&(t.push({itemKey:"frequent-contacts-header",type:0}),t.push(...w)),n.forEach((e=>{e.isGroup?r.push(e):a.push(e)}));const o=T(a),s=T(r);if(j&&o.length>0){const e=i.fbt._("Contacts",null,{hk:"2jWpt9"});t.push({itemKey:`header-${e.toString()}`,data:e.toString(),separator:!0,type:1})}if(t.push(...o),j&&s.length>0){let n;n=!0===e.isCommunityCreation?i.fbt._("Groups you're an admin of",null,{hk:"YrVyI"}).toString():i.fbt._("Groups",null,{hk:"4bUoVs"}).toString(),t.push({itemKey:`header-${n}`,data:n,separator:!0,type:1})}return t.push(...s),t}),[n,w,T,j,e.isCommunityCreation]);return E.current.init((()=>{const e=[],t=[];return n.forEach((n=>{if(n.isGroup){const e=c.ChatCollection.get(n.id);e&&t.push(e)}else e.push(n)})),(a||[]).concat(e).concat(t)})()),(0,x.jsx)(f.HotKeys,{onRef:e=>{b.current=e},handlers:{down:e=>{e.preventDefault(),e.stopPropagation(),E.current.setNext(!0)},up:e=>{e.preventDefault(),e.stopPropagation();const t=E.current;t.prev()>-1?t.setPrev(!0):(t.unset(),y(e))}},onFocus:e=>{if(e.target!==b.current)return;const t=E.current;t.index<0?k():t.reset(!0)},"data-tab":r.TAB_ORDER.CHAT_CONTACT_LIST,"data-testid":"contact-list-key",children:(0,x.jsx)(h.FlatList,{data:P,renderItem:function(t){switch(t.type){case 0:return(0,x.jsx)(m.default,{header:p.default.t(883)},"frequent-contacts-header");case 3:const{data:n,frequent:a}=t;return((t,n)=>!0===e.disabled?(0,x.jsx)(d.Chat,{chat:t,mode:d.Mode.INFO,noContext:!0,frequent:n,theme:"disabled"}):(0,x.jsx)(d.Chat,{active:E.current,chat:t,mode:d.Mode.INFO,noContext:!0,onClick:S,frequent:n}))(n,a);case 2:const{data:r,frequent:o}=t;return((e,t)=>{let n;return e.isBlocked()&&(n=i.fbt._("Contact is blocked",null,{hk:"284Coh"})),(0,x.jsx)(u.Contact,{active:E.current,contact:e,onClick:S,secondary:n,frequent:t,waitIdle:!0})})(r,o);case 1:const{data:c,separator:f}=t;return(0,x.jsxs)("div",{className:(0,s.default)(C),children:[f?(0,x.jsx)(l.default,{},`separator-${c}`):null,(0,x.jsx)(m.default,{header:c})]});default:throw new h.UnknownDataError(t)}},flatListController:e.flatListController,direction:"vertical"})})}var S=(0,o.forwardRef)(y);t.default=S},53153:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(n(35161)),i=n(67294),o=n(2732),s=n(29424),l=a(n(43725)),d=a(n(87481)),c=a(n(59552)),u=n(85893);function h(e,t){const{contacts:n,onFocusSearch:a,onDelete:h}=e,f=(0,c.default)((()=>new d.default(n,(e=>e.id.toString())))),p=()=>{(null==n?void 0:n.length)&&f.current.setLast(!0)},m=e=>{e.preventDefault(),e.stopPropagation();f.current.prev()>-1&&f.current.setPrev(!0)},g=e=>{e.preventDefault(),e.stopPropagation();const t=f.current.next();f.current.index===t?(f.current.unset(),a&&a(e)):f.current.setNext(!0)},v=e=>{e.preventDefault(),e.stopPropagation();const t=f.current.getVal();if(t){const a=n.find((e=>e===t));a&&h&&h(e,a)}},_=(e,t)=>{f.current.setVal(t)};if((0,i.useEffect)((()=>{f.current.init(n,!0)}),[n,f]),(0,i.useImperativeHandle)(t,(()=>({focusLast:p}))),!n)return null;const x=n.length?(0,r.default)(n,(t=>(0,u.jsx)(o.Contact,{contact:t,active:f.current,onDelete:e.onDelete,onClick:_,type:o.Type.SMALL,theme:e.theme,waitIdle:!0},t.id.toString()))):null,C={up:m,down:g};e.onDelete&&(C[l.default.LR("left","right")]=m,C[l.default.LR("right","left")]=g,C.backspace=v);const y=(0,u.jsx)("ul",{children:x});return(0,u.jsx)(s.HotKeys,{handlers:C,children:y})}var f=(0,i.forwardRef)(h);t.default=f},57850:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{ids:t,size:n,onClick:a,showCount:l,square:d,border:c}=e,u=t.length;if(0===u)return null;if(1===u)return(0,s.jsx)(o.DetailImage,{id:t[0],size:40,onClick:a,border:c});const h=t.slice(0,4).map(((e,t)=>(0,s.jsx)("div",{className:(0,r.default)(i.default.avatar,{[i.default.first]:0===t,[i.default.second]:1===t,[i.default.third]:2===t,[i.default.fourth]:3===t}),children:(0,s.jsx)(o.DetailImage,{id:e,size:n,square:!0})},`avatar-combo-image-${t}`))),f=(0,r.default)(i.default.container,{[i.default.square]:d,[i.default.border]:c},{[i.default.two]:2===u,[i.default.three]:3===u,[i.default.four]:u>=4}),p=(0,o.getSize)(n),m={height:p,width:p,cursor:a?"pointer":void 0},g=l?(0,s.jsx)("div",{className:i.default.count,style:m,children:t.length}):null;return(0,s.jsxs)("div",{className:f,style:m,onClick:a,children:[h,g]})};var r=a(n(94184)),i=a(n(87240)),o=n(88984),s=n(85893)},50514:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.AvatarOverlay=function(e){return(0,o.jsxs)("div",{className:(0,i.default)([l.overlay,e.theme===s.Community&&l.noBorderRadius]),children:[(0,o.jsx)("div",{className:(0,i.default)(l.icon),children:e.icon}),(0,o.jsx)("div",{"data-a8n":r.default.key("avatar-text"),className:(0,i.default)(l.text),children:e.text})]},"avatar-overlay")},t.AvatarOverlayTheme=void 0;var r=a(n(99964)),i=a(n(56720)),o=n(85893);const s=n(76672).Mirrored(["DEFAULT","Community"]);t.AvatarOverlayTheme=s;const l={overlay:{position:"lhggkp7q",top:"qq0sjtgm",start:"tkdu00h0",zIndex:"ercejckq",boxSizing:"cm280p3y",display:"p357zi0d",flexDirection:"f8m0rgwh",alignItems:"gndfcl4n",justifyContent:"ac2vgrno",width:"ln8gz9je",height:"ppled2lx",paddingTop:"pxvlsfnc",fontSize:"ovllcyds",lineHeight:"tkq7s68q",color:"k239c91b",textTransform:"ofejerhi",backgroundColor:"epdck8xl",borderTopStartRadius:"g9p5wyxn",borderTopEndRadius:"i0tg5vk9",borderBottomEndRadius:"aoogvgrq",borderBottomStartRadius:"o2zu3hjb"},noBorderRadius:{borderTopStartRadius:"bi2mdrpt",borderTopEndRadius:"hsk1pqkj",borderBottomEndRadius:"e3yfz9gx",borderBottomStartRadius:"a0vc5f8u"},icon:{color:"k17s6i4e"},text:{width:"gbtdc75f",marginTop:"opp68qpq",textAlign:"qfejxiq4",overflowWrap:"fd365im1"}}},8334:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(n(81109)),i=a(n(6479)),o=n(67294),s=a(n(56720)),l=n(85893);const d=["breakpoint","inverseToContainer","maxWidth","minWidth","xstyle"],c={boxSizing:"cm280p3y",flexShrink:"oq44ahr5",position:"g0rxnol2"};function u(e,t){let{breakpoint:n,inverseToContainer:a=!1,maxWidth:o,minWidth:u,xstyle:h}=e,f=(0,i.default)(e,d);return(0,l.jsx)("div",(0,r.default)((0,r.default)({},f),{},{className:(0,s.default)(c,h),ref:t,style:{maxWidth:o,minWidth:u,width:a?`calc((${n}px - 100%) * 9999)`:`calc((100% - ${n-.1}px) * 9999)`}}))}var h=(0,o.forwardRef)(u);t.default=h},16194:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){let{children:t,download:n,file:a,extension:l}=e;return(0,o.jsx)(i.default,{xstyle:s.button,onClick:()=>{null!=a&&r.FileSaver.downloadData(a,n,l)},children:t})};a(n(56720));var r=n(77811),i=a(n(1784)),o=n(85893);const s={button:{display:"f804f6gw"}}},28768:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:200,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;const n=(0,a.useRef)(null);(0,r.useListener)(t,"mousedown",(()=>{n.current=performance.now()})),(0,r.useListener)(t,"mouseup",(()=>{n.current=null}));const i=(0,a.useCallback)((()=>{const t=n.current;return null!=t&&performance.now()-t>=e}),[e]);return i};var a=n(67294),r=n(19529)},33743:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const t=(0,a.useRef)(null),n=(0,a.useRef)(!1);return(0,a.useEffect)((()=>{if(null==e)return;function a(e){const n=t.current;return!!n&&(e instanceof Node&&!n.contains(e))}function r(e){if(e.isPrimary){const t=a(e.target);n.current=t}}function i(e){"touch"!==e.pointerType&&"pen"!==e.pointerType||(n.current=!1)}function o(t){const r=a(t.target);n.current&&r&&t.isPrimary&&e(t),n.current=!1}function s(t){a(t.target)&&e(t)}const l="PointerEvent"in window;return l?(document.addEventListener("pointerdown",r),document.addEventListener("pointermove",i),document.addEventListener("pointerup",o)):document.addEventListener("click",s),()=>{l?(document.removeEventListener("pointerdown",r),document.removeEventListener("pointermove",i),document.removeEventListener("pointerup",o)):document.removeEventListener("click",s)}}),[e]),t};var a=n(67294)},648:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useSendIq=function(e,t){const[n,i]=(0,a.useState)(!1);return[n,()=>(i(!0),(0,r.sendIq)(e,t).finally((()=>i(!1))))]};var a=n(67294),r=n(24747)},152:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){const n=(0,i.default)(t),[a,o]=(0,r.useState)(e),s=(0,r.useCallback)((()=>o((e=>{const t=!e;return n(t),t}))),[n]);return[a,s]};var r=n(67294),i=a(n(83800))},31469:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(n(35161)),i=a(n(45095)),o=a(n(45120)),s=a(n(52013)),l=n(41906),d=n(55715),c=a(n(94184)),u=n(48360),h=n(67294),f=n(29424),p=a(n(34531)),m=n(78756),g=a(n(59578)),v=a(n(87481)),_=n(11054),x=a(n(1784)),C=a(n(59552)),y=a(n(88857)),S=n(85893);function j(e,t){const{onImageClick:n,isLoadingMore:a,canLoadMore:j,onRequestMoreImages:b,onFocusPrev:E,thumbnails:k}=e,I=(0,h.useRef)(null),w=(0,C.default)((()=>new Map)),T=(0,h.useRef)(null),P=(0,C.default)((()=>new v.default(k,(e=>e.id)))),[M,L]=(0,h.useState)(null),O=(0,h.useCallback)((function(){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const t=P.current,n=t.getVal();if(n&&M!==n&&(L(n),t.index>-1)){const n=w.current.get(`${t.index}`);s.default.focus(n),e&&n&&(0,m.scrollIntoViewIfNeeded)(n,!1)}}),[w,M,P]),A=new g.default(((e,t)=>{t?w.current.set(e,t):w.current.delete(e)})),D=e=>{const t=e.target;n&&1===t.nodeType&&"IMG"===t.tagName&&n(t.src)},R=(0,h.useCallback)((()=>{if(!a&&j&&b){if(!I.current)throw new Error("Requesting more images when body not rendered");I.current.scrollTop+l.SCROLL_FUDGE>I.current.scrollHeight-I.current.clientHeight&&b()}}),[j,a,b]),N=(0,y.default)(R,100),F=()=>{P.current.unset(),L(void 0)};(0,h.useEffect)((()=>{R(),P.current.init(k,!1),O()}),[R,P,k,O]);const B=()=>{T.current&&T.current.focus()};(0,h.useImperativeHandle)(t,(()=>({focus:B,handleRequestDismiss:F})));const U=(0,r.default)(e.thumbnails,((e,t)=>{let{id:n,name:a,thumbUrl:r}=e;const i=!!M&&M.id===n,o=(0,c.default)(p.default.imageGalleryItem,{[p.default.selected]:i}),s=(0,S.jsx)("div",{className:p.default.imageGalleryItemOverlay});return(0,S.jsxs)("div",{ref:A.getRefSetter(`${t}`),className:o,tabIndex:-1,children:[s,(0,S.jsx)(x.default,{onClick:D,children:(0,S.jsx)("img",{alt:u.fbt._("Result: {name}",[u.fbt._param("name",a)],{hk:"1u9YJJ"}),className:p.default.imageGalleryItemImage,src:r})})]},n)})),H=e.isLoadingMore?(0,S.jsx)("div",{tabIndex:-1,className:p.default.imageGalleryFooter,children:(0,S.jsx)(_.Spinner,{stroke:6,size:24})}):null;return(0,S.jsx)(f.HotKeys,{className:p.default.imageGallery,"data-tab":d.TAB_ORDER.CHAT_IMAGE_GALLERY,handlers:{down:e=>{e.preventDefault(),e.stopPropagation(),P.current.set(P.current.index+3,!1,!1),O(!0,!0)},enter:()=>{const e=P.current.getVal();e||(__LOG__(4,void 0,new Error,!0)`Assertion failed!`,SEND_LOGS("No value selected, but enter clicked")),n&&e&&n(e.thumbUrl)},left:e=>{e.preventDefault(),e.stopPropagation(),P.current.setPrev(!1),O(!0,!0)},right:e=>{e.preventDefault(),e.stopPropagation(),P.current.setNext(!1),O(!0,!0)},up:e=>{if(e.preventDefault(),e.stopPropagation(),0===P.current.index&&E)E();else{const e=Math.max(P.current.index-3,0);P.current.set(e,!1,!1),O(!0,!0)}}},onFocus:e=>{e.stopPropagation(),e.preventDefault(),(null==P.current.index||P.current.index<0)&&P.current.setFirst(!1),O(!0,!1);const t=(0,i.default)(w.current.get(`${P.current.index}`),"imagesRef.current.get(`${selectionRef.current.index}`)").getElementsByClassName(p.default.imageGalleryItemOverlay);if(1!==t.length)throw new Error(`Unexpected number of overlay elements ${t.length}`);o.default.maybeIndicateFocus(t[0],p.default.focusAnimation)},onMouseDown:e=>{e.preventDefault(),e.stopPropagation()},onRef:e=>{T.current=e},children:(0,S.jsxs)("div",{ref:I,className:p.default.imageGalleryList,onScroll:N,children:[U,(0,S.jsx)("div",{tabIndex:-1,className:p.default.imageGalleryItemSpacer}),(0,S.jsx)("div",{tabIndex:-1,className:p.default.imageGalleryItemSpacer}),(0,S.jsx)("div",{tabIndex:-1,className:p.default.imageGalleryItemSpacer}),H]})})}var b=(0,h.forwardRef)(j);t.default=b},60195:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n(67294),r=n(14330);const i=(e,t)=>{const[n,i]=(0,r.useLottie)(e);return(0,a.useImperativeHandle)(t,(()=>i)),n};var o=(0,a.forwardRef)(i);t.default=o},14330:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.Renderer=void 0,t.useLottie=function(e){let{autoplay:t=!1,data:n,direction:a=1,fallback:c=null,loop:u=!1,path:h,placeholder:f=null,renderer:p=d.SVG,speed:m=1,xstyle:g}=e;(0,r.default)(null==n&&null!=h||null!=n&&null==h,"These opts are mutually exclusive");const v=(0,o.useRef)(),_=(0,o.useRef)(),[x,C]=(0,o.useState)(!0),[y,S]=(0,o.useState)(!1),j=(0,o.useCallback)((()=>{var e;null===(e=v.current)||void 0===e||e.play()}),[]),b=(0,o.useCallback)((()=>{var e;null===(e=v.current)||void 0===e||e.stop()}),[]),E=(0,o.useCallback)((()=>{var e;null===(e=v.current)||void 0===e||e.pause()}),[]),k=(0,o.useCallback)(((e,t)=>{var n;null===(n=v.current)||void 0===n||n.goToAndPlay(e,t)}),[]),I=(0,o.useCallback)(((e,t)=>{var n;null===(n=v.current)||void 0===n||n.goToAndStop(e,t)}),[]),w=(0,o.useCallback)((e=>{var t;null===(t=v.current)||void 0===t||t.getDuration(e)}),[]);(0,o.useEffect)((()=>{const e=i.default.loadAnimation({container:_.current,animationData:n,path:h,renderer:p,loop:u,autoplay:t});v.current=e;const a=[{name:"data_ready",handler:()=>C(!1)},{name:"data_failed",handler:()=>S(!0)}].map((t=>(e.addEventListener(t.name,t.handler),()=>e.removeEventListener(t.name,t.handler))));return()=>{a.forEach((e=>e())),e.destroy()}}),[n,h,p,u,t]),(0,o.useEffect)((()=>{var e;null===(e=v.current)||void 0===e||e.setSpeed(m)}),[m]),(0,o.useEffect)((()=>{var e;null===(e=v.current)||void 0===e||e.setDirection(a)}),[a]);return[(0,l.jsxs)("div",{className:(0,s.default)(g),ref:_,children:[x&&!y?f:null,y?c:null]}),{play:j,stop:b,pause:E,goToAndPlay:k,goToAndStop:I,getDuration:w}]};var r=a(n(41143)),i=a(n(11248)),o=n(67294),s=a(n(56720)),l=n(85893);const d=n(76672)({SVG:"svg",Canvas:"canvas"});t.Renderer=d},1697:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(67294),i=a(n(91050)),o=a(n(56646)),s=n(49082),l=n(78123),d=n(85893);function c(e,t){const n=(0,r.useRef)(null),a=(0,s.useModelValues)(e.chatPreference,["wallpaperColor","showDoodle"]);(0,r.useImperativeHandle)(t,(()=>({get container(){return n.current}})));const{wallpaperColor:c,showDoodle:u}=a;let h={};return c!==l.DEFAULT_CHAT_WALLPAPER&&(h={backgroundColor:c}),(0,d.jsx)("div",{className:o.default.container,ref:n,children:(0,d.jsxs)("div",{className:o.default.body,style:h,children:[(0,d.jsx)(i.default,{wallpaperColor:c,showDoodle:u}),e.children]})})}var u=(0,r.forwardRef)(c);t.default=u},82541:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(n(63105)),i=a(n(99964)),o=a(n(52013)),s=a(n(94184)),l=n(48360),d=n(67294),c=n(50514),u=a(n(46918)),h=n(88102),f=a(n(52665)),p=n(19380),m=a(n(92726)),g=n(71174),v=a(n(37792)),_=n(1063),x=a(n(72451)),C=a(n(3222)),y=n(29424),S=a(n(89936)),j=a(n(47065)),b=a(n(43725)),E=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=B(t);if(n&&n.has(e))return n.get(e);var a={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var o=r?Object.getOwnPropertyDescriptor(e,i):null;o&&(o.get||o.set)?Object.defineProperty(a,i,o):a[i]=e[i]}a.default=e,n&&n.set(e,a);return a}(n(97692)),k=n(57224),I=a(n(11791)),w=a(n(40134)),T=a(n(43556)),P=a(n(71528)),M=n(558),L=a(n(23217)),O=a(n(81499)),A=n(65127),D=n(18644),R=a(n(24717)),N=a(n(41956)),F=n(85893);function B(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(B=function(e){return e?n:t})(e)}class U extends d.Component{constructor(){super(...arguments),this.state={img:this.props.startImage,hover:!1,imageSize:null},this._setRefImageContainer=e=>{this._refImageContainer=e},this._setRefImageInput=e=>{this._refImageInput=e},this._handleUpload=()=>{const e=this._refImageInput;if(e)return e.click(),!0},this._removeImage=()=>{this.props.onImageSet(),h.Cmd.closeModal()},this._handleRemove=()=>{let e;switch(this.props.type){case T.default.GROUP:e=b.default.t(718);break;case T.default.COMMUNITY:e=l.fbt._("",null,{hk:"1jy3zx"});break;case T.default.PROFILE:e=b.default.t(721)}h.Cmd.openModal((0,F.jsx)(f.default,{onOK:this._removeImage,okText:b.default.t(717),onCancel:()=>h.Cmd.closeModal(),cancelText:l.fbt._("Cancel",null,{hk:"H0gNq"}),children:e}))},this._handleView=()=>{const e=this._refImageContainer,{id:t,attachToChat:n}=this.props;if(!e||!t)return;const a=p.ContactCollection.assertGet(t),r={transition:"profile-viewer"};n&&(r.uim=this.props.uim),h.Cmd.openModalMedia((0,F.jsx)(P.default,{contact:a,profilePicThumb:a.getProfilePicThumb(),animateBorderRadius:!0,getZoomNode:t=>{t(e)}}),r)},this.handlePaste=e=>{if(!this.state.contextMenu)return;const t=new m.default(e.clipboardData),n=(0,r.default)(t.getFiles(),(e=>"image"===(0,_.typeFromMimetype)(e.type)));if(!n.length)return;e.preventDefault(),e.stopPropagation(),this.closeContextMenu();const a=n[0];this._handleImagePick(a)},this.handleImageSelected=e=>{this.closeContextMenu();const t=e.target.files[0];if(!t)return!1;this._handleImagePick(t),e.target.value="",this._refImageContainer&&o.default.focus(this._refImageContainer)},this._handleImageReceived=(e,t)=>{e?E.loadImage(e).then((()=>{this.setState({img:e}),this.props.onImageSet(e,t)})).catch((e=>{let t;switch(__LOG__(3)`PhotoPicker:onImageReceived failed to load image: ${String(e)}`,this.props.type){case T.default.GROUP:t=b.default.t(62);break;case T.default.COMMUNITY:t=l.fbt._("",null,{hk:"2CWmRt"});break;case T.default.PROFILE:t=b.default.t(116)}h.Cmd.openModal((0,F.jsx)(f.default,{onOK:()=>h.Cmd.closeModal(),children:t}))})):this.setState({img:null,imageSize:null})},this.handleSearch=()=>{h.Cmd.openModal((0,F.jsx)(k.Modal,{type:k.ModalTheme.Box,children:(0,F.jsx)(S.default,{onFinished:this._handleImageReceived})}))},this._handleImagePick=e=>{const t=URL.createObjectURL(e);E.loadImage(t).then((t=>{t&&(t.width<M.PROF_PIC_MIN_SIDE||t.height<M.PROF_PIC_MIN_SIDE)?h.Cmd.openModal((0,F.jsx)(f.default,{onOK:()=>h.Cmd.closeModal(),children:b.default.t(709,{size:M.PROF_PIC_MIN_SIDE,_plural:M.PROF_PIC_MIN_SIDE})})):h.Cmd.openModal((0,F.jsx)(k.Modal,{type:k.ModalTheme.Box,children:(0,F.jsx)(v.default,{img:e,onFinished:this._handleImageReceived,onRetake:this._handleUpload})}))})).catch((()=>{let e;switch(this.props.type){case T.default.GROUP:e=b.default.t(62);break;case T.default.COMMUNITY:e=l.fbt._("",null,{hk:"2CWmRt"});break;case T.default.PROFILE:e=b.default.t(116)}h.Cmd.openModal((0,F.jsx)(f.default,{onOK:()=>h.Cmd.closeModal(),children:e}))})).finally((()=>{URL.revokeObjectURL(t)}))},this._createMenu=()=>{const e=[];return this.props.id&&this.state.img&&e.push((0,F.jsx)(g.DropdownItem,{a8n:"mi-view-photo",action:this._handleView,children:b.default.t(820)},"view")),x.default&&e.push((0,F.jsx)(O.default,{onImageTake:this._handleImageReceived},"take")),e.push((0,F.jsx)(g.DropdownItem,{a8n:"mi-upload-photo",action:this._handleUpload,children:b.default.t(810)},"upload")),A.UA.isElectron&&(this.props.type!==T.default.GROUP&&this.props.type!==T.default.COMMUNITY||e.push((0,F.jsx)(g.DropdownItem,{a8n:"mi-search-photo",action:this.handleSearch,children:l.fbt._("Web Search",null,{hk:"3otQk8"})},"search"))),this.state.img&&e.push((0,F.jsx)(g.DropdownItem,{a8n:"mi-remove-photo",action:this._handleRemove,children:b.default.t(720)},"remove")),e},this.handleImageKeypress=()=>{const e=this._createMenu();this.setState({contextMenu:{menu:e,anchor:this._refImageContainer}})},this.handleImageClick=e=>{if(this.props.readOnly)return void(this.state.img&&this._handleView());e.stopPropagation(),e.preventDefault();const t=this._createMenu();this.setState({contextMenu:{menu:t,event:e}})},this.closeContextMenu=()=>{this.setState({contextMenu:null})},this.handleMouseOver=()=>{this.state.hover||this.setState({hover:!0})},this.handleMouseEnter=()=>{this.state.hover||this.setState({hover:!0})},this.handleMouseLeave=()=>{this.state.hover&&this.setState({hover:!1})},this.handleLoad=e=>{const t=e.currentTarget.clientWidth,n=e.currentTarget.clientHeight;this.setState({imageSize:{width:t,height:n}})}}static getDerivedStateFromProps(e){return e.startImage?{img:e.startImage}:{img:e.startImage,imageSize:null}}_getContainerStyle(){return null!=this.props.size?{width:this.props.size,height:this.props.size}:void 0}render(){let e,t;this.state.img&&(e=(0,F.jsx)(I.default,{type:"cover",size:this.state.imageSize,children:(0,F.jsx)(j.default,{src:this.state.img,crossOrigin:!1,style:{height:"100%",width:"100%"},onLoad:this.handleLoad})})),(this.props.pending||this.state.img&&!this.state.imageSize)&&(t=(0,F.jsx)(u.default,{}));let n=null;if(!this.props.pending&&!this.props.readOnly&&(!this.state.img||this.state.imageSize)&&(!this.state.img||this.state.contextMenu||this.state.hover)){let e="";switch(this.props.type){case T.default.GROUP:e=this.state.img?b.default.t(273):b.default.t(138);break;case T.default.COMMUNITY:e=this.state.img?l.fbt._("",null,{hk:"2qce1Y"}):l.fbt._("",null,{hk:"3suXp9"});break;case T.default.PROFILE:e=this.state.img?b.default.t(277):b.default.t(139)}n=(0,F.jsx)(c.AvatarOverlay,{icon:(0,F.jsx)(L.default,{name:"camera"}),text:e,theme:this.props.type===T.default.COMMUNITY?c.AvatarOverlayTheme.Community:c.AvatarOverlayTheme.DEFAULT})}const a=this.props.pending||!this.state.imageSize&&this.state.img?()=>{}:this.handleImageClick;let r,o;if(this.state.contextMenu&&(r=(0,F.jsx)(D.UIE,{displayName:"PhotoPickerContextMenu",escapable:!0,popable:!0,requestDismiss:this.closeContextMenu,children:(0,F.jsx)(R.default,{contextMenu:this.state.contextMenu})})),this.props.pending||!this.state.img||this.state.img&&!this.state.imageSize){let e;switch(this.props.type){case T.default.PROFILE:e="default-user";break;case T.default.COMMUNITY:e="community-squircle";break;default:e="default-group"}o=(0,F.jsx)("div",{className:w.default.defaultIcon,children:(0,F.jsx)(L.default,{name:e})})}return(0,F.jsxs)(y.HotKeys,{className:w.default.container,style:this._getContainerStyle(),handlers:{space:this.handleImageKeypress,enter:this.handleImageKeypress},children:[(0,F.jsxs)("div",{className:(0,s.default)(w.default.body,{[w.default.squircleBackground]:this.props.type===T.default.COMMUNITY}),onClick:a,onMouseOver:this.handleMouseOver,onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,onPaste:this.handlePaste,onFocus:this.handleMouseEnter,onBlur:this.handleMouseLeave,ref:this._setRefImageContainer,title:l.fbt._("Photo Picker",null,{hk:"3TURye"}),dir:"ltr",tabIndex:0,role:"button","data-a8n":i.default.key(this.props.a8nText),children:[(0,F.jsxs)("div",{className:w.default.imageContainer,children:[e,o]}),(0,F.jsxs)(N.default,{transitionName:"fade",children:[t,n]})]}),(0,F.jsx)("input",{ref:this._setRefImageInput,type:"file",accept:"image/gif,image/jpeg,image/jpg,image/png",style:{display:"none"},onChange:this.handleImageSelected}),r]})}}U.displayName="PhotoPicker";var H=(0,C.default)(U);t.default=H},25324:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(n(94184)),i=n(82857),o=a(n(85747)),s=n(85893);var l=e=>{let{ariaLabel:t,large:n,a8nText:a,onClick:l,icon:d,count:c,disabled:u}=e;return(0,s.jsxs)("div",{className:(0,r.default)(o.default.container,{[o.default.disabled]:u}),children:[(0,s.jsx)(i.Round,{label:t,large:n,a8nText:a,onClick:l,disabled:u,children:d}),null!=c&&(0,s.jsx)("div",{className:(0,r.default)(o.default.count,{[o.default.large]:n}),children:(0,s.jsx)("span",{children:c})})]})};t.default=l},34544:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(n(81109)),i=n(67294),o=n(88102),s=a(n(52665)),l=n(94790),d=a(n(43725)),c=n(57224),u=n(43560),h=n(85893);t.default=e=>{let{doSave:t,afterSave:n,isValid:a,children:f,modalConfig:p,onError:m,title:g,onCancel:v}=e;const[_,x]=(0,i.useState)(u.EditType.EDITING),C=(0,h.jsx)(l.DrawerHeader,{title:g,type:l.DRAWER_HEADER_TYPE.POPUP,onCancel:()=>{o.Cmd.closeModal(),v&&v()}});return(0,h.jsx)(s.default,(0,r.default)({children:f,okText:d.default.t(729),type:c.ModalTheme.Auto,onOK:()=>{x(u.EditType.PENDING),t().then((()=>{x(u.EditType.DONE),n&&n(),o.Cmd.closeModal()}),(e=>{x(u.EditType.ERROR),m&&m(e)}))},okSpinner:_===u.EditType.PENDING,okDisabled:_===u.EditType.PENDING||!a,title:C},p))}},38801:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(67294),i=a(n(56720)),o=n(29424),s=a(n(97056)),l=a(n(41104)),d=n(85893);const c={tabContainer:{display:"p357zi0d",backgroundColor:"rv6u8h8g"},tab:{boxSizing:"cm280p3y",display:"p357zi0d",flexGrow:"ggj6brxn",flexDirection:"f8m0rgwh",alignItems:"gndfcl4n",justifyContent:"ac2vgrno",height:"qmp0wt83",color:"a633jkfz",textTransform:"ofejerhi"},focused:{boxShadow:"lgn58c33"},selected:{paddingTop:"eujn52yf",color:"ky3f94nk",borderBottom:"qldwl5fi"}};var u=e=>{let{tabConfigs:t,selectedId:n,onSelect:a,tabXstyle:s,xstyle:l}=e;const u=(0,r.useRef)(n),f=(0,r.useRef)([]),p=t.map((e=>{let{id:t}=e;return t})),m=p.length-1;return(0,d.jsx)(o.HotKeys,{handlers:{right:()=>{const e=p.indexOf(u.current),t=e===m?0:e+1,n=f.current[t];n&&n.focus()},left:()=>{const e=p.indexOf(u.current),t=0===e?m:e-1,n=f.current[t];n&&n.focus()}},children:(0,d.jsx)("div",{role:"tablist",className:(0,i.default)(c.tabContainer,l),children:t.map(((e,t)=>{let{title:r,id:i}=e;return(0,d.jsx)(h,{ref:e=>{f.current[t]=e},selected:i===n,onSelect:()=>a(i),onFocus:()=>{u.current=i},xstyle:s,children:r},r)}))})})};t.default=u;const h=(0,r.forwardRef)(((e,t)=>{let{selected:n,onSelect:a,onFocus:r,children:o,xstyle:u}=e;const[h,f]=(0,s.default)(),p=(0,l.default)(t,h);return(0,d.jsx)("button",{ref:p,role:"tab",tabIndex:n?0:-1,"aria-selected":Boolean(n),title:o,className:(0,i.default)(c.tab,f&&c.focused,n&&c.selected,u),onClick:()=>{n||a()},onFocus:r,children:o})}))},81499:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{onImageTake:t}=e;return(0,l.jsx)(i.DropdownItem,{action:()=>{r.Cmd.openModal((0,l.jsx)(o.EditCaptureFlowLoadable,{onFinished:t}))},a8n:"mi-take-photo",disabled:e.disabled,children:s.default.t(779)})};var r=n(88102),i=n(71174),o=n(70174),s=a(n(43725)),l=n(85893)},56204:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){let{className:t}=e;return(0,d.jsxs)(s.SelectableDiv,{"data-a8n":r.default.key("version"),className:(0,i.default)(l.default.versionInfo,t),selectable:!0,children:[o.default.t(813,{version:""}),(0,d.jsx)("span",{dir:"LTR",children:"2.2208.14"}),null,null]})};var r=a(n(99964)),i=a(n(94184)),o=(a(n(30381)),n(12591),a(n(11772)),a(n(43725))),s=n(52596),l=a(n(39567)),d=n(85893)},83192:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(n(52013)),i=n(48360),o=n(69951),s=n(88102),l=a(n(52665)),d=n(65417),c=a(n(32973)),u=a(n(12500)),h=a(n(43725)),f=n(89389),p=n(85893);class m extends c.default{constructor(){super(...arguments),this.filter=e=>{const t=e.groupMetadata;return!(!e.isGroup||e.isGroup&&!(null==t?void 0:t.participants.iAmMember()))&&((null==t?void 0:t.participants.get(this.props.contact.id))?i.fbt._("Already added to group",null,{hk:"4hdDHF"}).toString():!!(null==t?void 0:t.participants.iAmAdmin())||h.default.t(280))},this._confirmAddToGroup=e=>{this.props.requestFocus&&this.props.requestFocus(),this.push((0,p.jsx)(l.default,{cancelText:i.fbt._("Cancel",null,{hk:"H0gNq"}),okText:i.fbt._("Add participant",null,{hk:"48ECfz"}),onOK:this._addToGroup.bind(null,e),onCancel:this._pop,children:(0,p.jsx)(d.EmojiText,{text:h.default.t(341,{participant:this.props.contact.formattedName,subject:e.contact.name})})}))},this.requestFocus=()=>{if(!this.refUIE)return;const e=this.refUIE.getNode();e&&!e.contains(document.activeElement)&&r.default.focus(e)},this._addToGroup=e=>{(0,f.addParticipants)(e,[this.props.contact]).then((()=>{s.Cmd.openChatFromUnread(e).then((t=>{t&&s.Cmd.focusChatTextInput(e)}))})).catch((()=>{})),this.end()},this._pop=()=>{this.pop()}}componentDidMount(){this.push((0,p.jsx)(u.default,{chats:o.ChatCollection.filter((e=>e.isGroup)),filter:this.filter,onCancel:this._pop,onGroup:this._confirmAddToGroup}))}}t.default=m},93259:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(n(81629)),i=a(n(51463)),o=n(80666),s=n(88102),l=n(65100),d=a(n(32973)),c=n(7293),u=a(n(14500)),h=n(92157),f=n(65127),p=n(85893);class m extends d.default{constructor(){var e;super(...arguments),e=this,this._setRefMediaEditor=e=>{this._refMediaEditor=e},this.onCancel=()=>{this.props.onComplete&&this.props.onComplete(!1),this._clearAttachMedia(),this.props.mediaCollection.mediaPickerStatsLogger.logCancel(),this.end()},this.onFailedMedias=e=>{const t=e.filter((e=>e.isGif));if(t.length>0){const e=t.map((e=>e.filename));s.Cmd.once("ui_idle",(()=>{s.Cmd.pasteChatTextInput(this.props.chat,e.join(" "))})),this.props.onComplete&&this.props.onComplete(!1),this._clearAttachMedia(),this.props.mediaCollection.mediaPickerStatsLogger.logCancel(),this.end()}},this._sendMediaWithMentions=function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{initCaptionUsed:a,isViewOnce:r}=n,{chat:i}=e.props;s.Cmd.once("ui_idle",(()=>{t.forEach(((t,n)=>{var a;const s=t.media,l={};if(0===n&&(l.quotedMsg=i.composeQuotedMsg,i.composeQuotedMsg=null),l.isViewOnce=r,l.mentionedJidList=t.mentionedJidList,l.caption=s.caption,l.addEvenWhilePreparing=s.previewable&&s.state===o.ATTACH_MEDIA_STATE.PROCESSING,null===(a=e.props.initCaption)||void 0===a?void 0:a.ctwaContextLinkData){const{ctwaContextLinkData:t,ctwaContext:n}=e.props.initCaption;l.ctwaContext=(0,h.prepareCtwaContextSend)(t,n)}s.sendToChat(i,l)})),e._clearAttachMedia()})),e.props.onComplete&&e.props.onComplete(!0,{initCaptionUsed:a}),e.props.mediaCollection.mediaPickerStatsLogger.logSend({isViewOnce:r}),e.end()},this.setText=e=>{null!=e&&s.Cmd.once("ui_idle",(()=>{s.Cmd.pasteChatTextInput(this.props.chat,e)})),this.end()},this.handleRequestDismiss=e=>{var t;(null===(t=this._refMediaEditor)||void 0===t?void 0:t.handleRequestDismiss())&&(!1===e&&this.onCancel(),super.handleRequestDismiss())},this._clearAttachMedia=()=>{this.props.chat&&this.props.chat.setAttachMediaContents(null)}}componentDidMount(){s.Cmd.closeContextMenu(),s.Cmd.closeTooltip(),this.push((0,p.jsx)(u.default,{theme:"attach",ref:this._setRefMediaEditor,chat:this.props.chat,onClose:this.onCancel,initCaption:this.props.initCaption,onSendMedia:(0,i.default)(this._sendMediaWithMentions),mediaCollection:this.props.mediaCollection,onDropText:(0,i.default)(this.setText),sendAsSticker:this.props.sendAsSticker})),c.GK.supportsFeature(c.GK.F.MD_BACKEND)&&(0,l.eagerlyEstablishE2EESessionForMedia)(this.props.chat)}componentWillUnmount(){f.UA.isGecko?(0,r.default)((()=>s.Cmd.focusChatTextInput(this.props.chat))):s.Cmd.focusChatTextInput(this.props.chat)}}t.default=m},91037:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(n(81109)),i=a(n(32973)),o=a(n(43725)),s=n(56728),l=a(n(60356)),d=n(64551),c=a(n(93110)),u=n(85893);class h extends i.default{constructor(){super(...arguments),this._confirmSendContacts=e=>{this.push((0,u.jsx)(c.default,{contactList:e,onSend:()=>this._sendContacts(e),onBack:this._popNone,chat:this.props.chat}),"none"),this.contacts=e},this._sendContacts=e=>{const{chat:t}=this.props,n=t.composeQuotedMsg,a=t.getComposeContents().ctwaContext||void 0;(0,l.default)(e,t,n,a),t.composeQuotedMsg=null,this.props.onContactsSent(),this.end()},this._getContacts=()=>this.contacts,this._pop=()=>{this.pop()},this._popNone=()=>{this.pop("none")}}componentDidMount(){const e=this.props.serverProps.maxParticipants;this.contacts=[],this.push((0,u.jsx)(s.SelectModal,{title:o.default.t(751),onCancel:this._pop,onConfirm:this._confirmSendContacts,getInitialItems:this._getContacts,listType:s.ListType.CONTACT_SELECT_MODAL,maxItems:e,allowBlockedContacts:!0}))}}t.default=e=>(0,u.jsx)(h,(0,r.default)((0,r.default)({},e),{},{serverProps:d.ServerProps}))},97669:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(48360),i=n(88102),o=a(n(32973)),s=n(77975),l=n(24064),d=a(n(5537)),c=n(61358),u=n(85893);class h extends o.default{constructor(){super(...arguments),this.requestFocus=()=>{var e;const t=null===(e=this.refUIE)||void 0===e?void 0:e.getRef();null!=t&&(t instanceof HTMLElement||"function"!=typeof t.onFocusList||t.onFocusList())},this._sendProducts=e=>{const{chat:t}=this.props;(0,l.qplStartProductSendMessage)("Attachment",e.length);const n=e.map(((e,n)=>{const a=0===n?t.composeQuotedMsg:null;return t.sendProductMessage(e,a).then((()=>{(0,s.logProductMessageSent)({product:e,catalogSessionId:this.props.sessionId})}))}));(0,l.qplEndProductMessageSend)(Promise.all(n)),t.composeQuotedMsg=null,this.end()},this._shareCatalog=e=>{const{chat:t}=this.props,n=(0,c.createCatalogLink)(e.id.user),a=`${r.fbt._("Follow this link to view our catalog on WhatsApp:",null,{hk:"1bmMoC"}).toString()} ${n}`;i.Cmd.pasteChatTextInput(t,a),(0,s.logSendCatalogClick)({catalogOwnerWid:e.id,catalogSessionId:this.props.sessionId}),this.end()},this._pop=()=>{this.pop()},this._popNone=()=>{this.pop("none")}}componentDidMount(){this.push((0,u.jsx)(d.default,{onCancel:this._pop,onConfirm:this._sendProducts,onShare:this._shareCatalog}))}}var f=h;t.default=f},92246:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(44189),i=n(88102),o=n(27394),s=a(n(32973)),l=n(57701),d=n(82145),c=a(n(11339)),u=n(97567),h=n(67455),f=n(48870),p=n(27798),m=n(85893);class g extends s.default{constructor(){super(...arguments),this.onProductCatalog=()=>{const{sellerJid:e,chat:t}=this.props;(0,l.canViewCollections)()&&f.QPL.markerStart(p.QuickLogMarkerId.WHATSAPP_CATALOG_COLLECTIONS_VIEW,{string:{EntryPoint:"Cart"}}),this.push((0,m.jsx)(h.ProductDetailsFlowLoadable,{chat:t,catalogOwnerJid:e}))},this.onProductDetail=e=>{const{chat:t}=this.props;(0,d.qplStartProductView)("Cart"),this.push((0,m.jsx)(h.ProductDetailsFlowLoadable,{refreshCarousel:!0,chat:t,productInfo:e,onEnd:this._pop}))},this._end=()=>{this.end(!0)},this._pop=()=>{this.pop()}}componentDidMount(){const{sellerJid:e,chat:t}=this.props;this.push((0,m.jsx)(o.DrawerContext.Consumer,{children:n=>{const{entryPoint:a}=(0,u.getProductCatalogContext)(n),{isPushed:i}=this.state;return(0,m.jsx)(r.CartDetailDrawer,{chat:t,sellerJid:e,onProductDetail:this.onProductDetail,onProductCatalog:this.onProductCatalog,onBack:this._end,closeDrawerRightOnSend:a===c.default.CATALOG_ENTRY_POINT.CATALOG_ENTRY_POINT_PRODUCT_LIST_MESSAGE,isPushed:i})}})),i.Cmd.existsDrawerLeft((e=>{e&&i.Cmd.closeDrawerLeft()})),i.Cmd.existsDrawerMid((e=>{e&&i.Cmd.closeDrawerMid()}))}}t.default=g},86704:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=Y;var r=a(n(81109)),i=a(n(48926)),o=n(50796),s=n(48360),l=n(67294),d=n(93581),c=n(99989),u=a(n(7532)),h=n(91545),f=a(n(54414)),p=n(88102),m=n(19829),g=a(n(95416)),v=n(27105),_=n(72549),x=n(19380),C=a(n(60453)),y=a(n(69637)),S=n(27394),j=n(94790),b=a(n(93870)),E=a(n(12290)),k=a(n(32973)),I=n(99234),w=n(57701),T=n(77975),P=n(35054),M=n(82145),L=n(92557),O=a(n(63935)),A=n(9468),D=n(21374),R=n(97567),N=a(n(54050)),F=n(11395),B=n(48870),U=n(27798),H=n(87956),G=a(n(56829)),W=n(50452),V=n(77591),z=n(85893);const q=n(76672).Mirrored(["YES","NO","PENDING"]);class K extends k.default{constructor(){var e;super(...arguments),e=this,this._isComplianceFormVisible=!1,this._isProductListVisible=!1,this._blockCartInterstitial=()=>this.props.mustCompleteCompliance!==q.NO,this._isCreatingCatalog=()=>this.props.isCreatingCatalog,this._showProductList=e=>{const t=(0,w.canManageCollections)()?(0,z.jsx)(f.default,{contact:this.props.contact,onCatalogLinkClick:this._onCatalogShare,onProductShare:this.onProductShare,onProductDetail:this.onEditProduct,onAddProduct:this._onAddProduct,onRemoveProduct:this._onRemoveProduct,catalogId:this.props.catalogId,onBack:this._end,onCartClick:this.onCartClick,businessProfile:null,headerType:j.DRAWER_HEADER_TYPE.LARGE,onCollectionSeeAll:this.onCollectionSeeAll,canManageCatalog:!0,autoUpdate:!0,onOpenCollections:this.onOpenCollections,onOpenMerchantDetailsForm:this._handleOpenMerchantDetailsForm,onEditCollection:this._onEditCollection,onOpenSettings:this.onOpenSettings,blockCartInterstitialFn:this._blockCartInterstitial,canLogQpl:e}):(0,z.jsx)(F.ProductListDrawer,{contact:this.props.contact,onCatalogLinkClick:this._onCatalogShare,onProductShare:this.onProductShare,onProductDetail:this.onEditProduct,onAddProduct:this._onAddProduct,onRemoveProduct:this._onRemoveProduct,catalogId:this.props.catalogId,onBack:this._end,onCartClick:this.onCartClick,businessProfile:null,headerType:j.DRAWER_HEADER_TYPE.LARGE,canManageCatalog:!0,autoUpdate:!0,onOpenSettings:this.onOpenSettings,blockCartInterstitialFn:this._blockCartInterstitial});this.push(t)},this._handleOpenMerchantDetailsForm=()=>{const e=(0,I.getMeUser)();this.push((0,z.jsx)(L.MerchantDetailsFormFlowLoadable,{contactId:e,onBack:this.pop}))},this.onEditProduct=e=>{const t=c.CatalogCollection.assertGet(this.props.catalogId);p.Cmd.openDrawerMid((0,z.jsx)(E.default,{catalog:t,product:e}),"slide-left",void 0,void 0,this.props.context,H.FocusType.TABBABLE)},this.onCartClick=e=>{(0,G.default)(e,void 0,this.props.context)},this.onCollectionSeeAll=e=>{this.push((0,z.jsx)(m.CollectionContentDrawer,{contact:this.props.contact,onProductDetail:this.onEditProduct,onProductShare:this.onProductShare,catalogId:this.props.catalogId,onBack:this._pop,onCatalogLinkClick:this._onCatalogShare,onCartClick:this.onCartClick,collection:e,canManageCatalog:!0,headerType:j.DRAWER_HEADER_TYPE.LARGE,onEditCollection:this._onEditCollection}))},this._onEditCollection=e=>{const t=c.CatalogCollection.get(this.props.catalogId);e||(0,P.logCollectionCreateClicked)((0,R.getProductCatalogContext)(this.props.context)),t&&this.push((0,z.jsx)(b.default,{onBack:this._pop,collection:e,catalog:t}))},this._onCatalogShare=(e,t)=>{p.Cmd.openDrawerMid((0,z.jsx)(u.default,{onCancel:()=>{p.Cmd.closeDrawerMid()},catalog:e,contact:t,prompt:s.fbt._("Anyone with WhatsApp can follow this link to browse catalog",null,{hk:"1Lofnu"}),onSend:()=>p.Cmd.closeDrawerMid(),centerDrawer:!0}),"slide-left",void 0,void 0,this.props.context,H.FocusType.TABBABLE)},this.onProductShare=e=>{p.Cmd.openDrawerMid((0,z.jsx)(N.default,{onCancel:()=>{p.Cmd.closeDrawerMid()},product:e,prompt:s.fbt._("Anyone with WhatsApp can follow this link to browse catalog",null,{hk:"1Lofnu"}),onSend:()=>p.Cmd.closeDrawerMid(),centerDrawer:!0,sendProductMsg:!0}),"slide-left",void 0,void 0,this.props.context,H.FocusType.TABBABLE)},this.onOpenCollections=()=>{B.QPL.markerStart(U.QuickLogMarkerId.WHATSAPP_COLLECTIONS_MANAGEMENT_VIEW),this.push((0,z.jsx)(g.default,{onBack:this._pop,editCollection:this.editCollection,onSeeCollection:this.onSeeCollection})),(0,P.logCollectionMenuClicked)((0,R.getProductCatalogContext)(this.props.context))},this.onSeeCollection=e=>{(0,M.qplStartCollectionViewAll)("Collection"),this.push((0,z.jsx)(Y,{catalogId:this.props.catalogId,collection:e,product:null}))},this.editCollection=e=>{const t=c.CatalogCollection.get(this.props.catalogId);e||(0,P.logCollectionCreateClicked)((0,R.getProductCatalogContext)(this.props.context)),t&&this.push((0,z.jsx)(b.default,{onBack:this._pop,collection:e,catalog:t}))},this.onOpenSettings=()=>{this.push((0,z.jsx)(h.CatalogSettingsDrawer,{onBack:this._pop}))},this._onAddProduct=()=>this.props.onAddProduct(),this._onAddFirstProduct=()=>this.props.onAddFirstProduct(),this._onRemoveProduct=()=>this.props.onRemoveProduct(),this._onAddProductFromBusinessDetails=(0,i.default)((function*(){e._pop(),e._isComplianceFormVisible=!1,yield e.props.onComplianceFormClosed();c.CatalogCollection.get(e.props.catalogId)?e._onAddProduct():e._onAddFirstProduct()})),this._pop=()=>{this.pop(),p.Cmd.closeDrawerMid()},this._end=()=>{this.end(!0),p.Cmd.closeDrawerMid()}}componentDidMount(){null!=this.props.collection?this.onCollectionSeeAll(this.props.collection):null!=this.props.catalog?(this._showProductList(!0),null!=this.props.product&&this.onEditProduct(this.props.product)):(B.QPL.markerDrop(U.QuickLogMarkerId.WHATSAPP_CATALOG_COLLECTIONS_VIEW),this._showNewCatalog())}componentDidUpdate(){this.props.showComplianceForm&&!this._isComplianceFormVisible?(this._isComplianceFormVisible=!0,this._showComplianceForm()):this.props.showProductList&&!this._isProductListVisible&&(this._isProductListVisible=!0,this._showProductList(!1))}_showNewCatalog(){this.push((0,z.jsx)(O.default,{isCreatingCatalogFn:this._isCreatingCatalog,onBack:this._pop,onAddProductClick:this._onAddFirstProduct}))}_showComplianceForm(){this.push((0,z.jsx)(L.MerchantDetailsFormFlowLoadable,{contactId:this.props.contact.id,enableCatalogCreationContext:!0,enableBusinessProfileAddress:!0,onAddProduct:this._onAddProductFromBusinessDetails,onBack:()=>{this._pop(),this._isComplianceFormVisible=!1,this.props.onComplianceFormClosed()},onUnmount:()=>{this._isComplianceFormVisible=!1,this.props.onComplianceFormClosed()}}))}}function Y(e){const t=(0,l.useContext)(S.DrawerContext),[n,a]=(0,l.useState)(q.PENDING),u=x.ContactCollection.get(e.catalogId),[h,f]=(0,l.useState)(!1),[m,g]=(0,l.useState)(!1),[b,k]=(0,l.useState)(!1),[I,P]=(0,l.useState)(!1),M=(0,l.useCallback)((()=>c.CatalogCollection.get(e.catalogId)),[e.catalogId]),L=(0,l.useCallback)((0,i.default)((function*(){var e;if(!u)return __LOG__(4,void 0,new Error,!0)`Cannot update compliance for non existing user`,void SEND_LOGS("catalog-management-flow-compliance-no-contact-error");a(q.PENDING);const t=null===(e=d.BusinessProfileCollection.get(u.id))||void 0===e?void 0:e.address;let n=q.NO;const r=M();!(0,w.canSeeECommerceComplianceIndiaHardEnforcementBusinessJourney)(u.id.user)||r&&r.productCollection.length||(0,_.isBusinessCompliant)(t,yield(0,v.getLegalEntityDetails)(u.id),u.id)||(n=q.YES),a(n)})),[u,M]),O=(0,l.useCallback)((()=>{const e=M();if(n===q.YES)f(!0);else if(n===q.PENDING)k(!0);else if(e){const n=new A.Product({catalogWid:e.id,additionalImageCdnUrl:[]});p.Cmd.openDrawerMid((0,z.jsx)(E.default,{catalog:e,product:n,onCreate:n=>{p.Cmd.openDrawerMid((0,z.jsx)(E.default,{catalog:e,product:n}),"slide-left",void 0,void 0,t,H.FocusType.TABBABLE)},newProduct:!0}),"slide-left",void 0,void 0,t,H.FocusType.TABBABLE)}}),[n,t,M]),N=(0,l.useCallback)((0,i.default)((function*(){P(!0);const n=(0,R.getProductCatalogContext)(t);(0,T.logCreateProductCatalogClick)(n),B.QPL.markerStart(U.QuickLogMarkerId.WHATSAPP_CATALOG_CREATE);let a=!0;try{yield(0,D.createCatalog)(),(0,T.logCreateProductCatalogSuccess)(n),a=!1,B.QPL.markerEnd(U.QuickLogMarkerId.WHATSAPP_CATALOG_CREATE,B.QuickLogActionType.SUCCESS);try{yield c.CatalogCollection.find(e.catalogId),g(!0),O()}catch(e){(0,o.filteredCatch)(V.ServerStatusCodeError,(()=>{__LOG__(3)`Failed to fetch product catalog from server`}))}}catch(e){(0,o.filteredCatch)(V.ServerStatusCodeError,(e=>{(0,T.logCreateProductCatalogFailed)(n,e.statusCode),p.Cmd.openToast((0,z.jsx)(W.Toast,{msg:s.fbt._("Catalog already created.",null,{hk:"1s2DFD"}),id:(0,W.genId)("err_catalog_already_created")})),g(!0)}))}finally{a&&B.QPL.markerEnd(U.QuickLogMarkerId.WHATSAPP_CATALOG_CREATE,B.QuickLogActionType.FAIL)}P(!1)})),[e.catalogId,t,O]),F=(0,l.useCallback)((0,i.default)((function*(){n===q.YES?f(!0):n===q.PENDING?k(!0):yield N()})),[n,N]),G=(0,l.useCallback)((0,i.default)((function*(){yield L()})),[L]);return(0,l.useEffect)((()=>{L()}),[]),(0,l.useEffect)((()=>{const e=M();b&&n!==q.PENDING&&(k(!1),n===q.YES?f(!0):e?O():N()),n===q.YES&&p.Cmd.closeDrawerMid()}),[b,n,M,N,O]),u?b?(0,z.jsxs)(C.default,{children:[(0,z.jsx)(j.DrawerHeader,{title:s.fbt._("Add new item",null,{hk:"2Tc6p3"}),onCancel:()=>{f(!1),k(!1)},type:j.DRAWER_HEADER_TYPE.LARGE}),(0,z.jsx)(y.default,{theme:"center-content",children:(0,z.jsx)(v.ComplianceInfoLoading,{})})]}):(0,z.jsx)(S.DrawerContext.Consumer,{children:t=>(0,z.jsx)(K,(0,r.default)({contact:u,context:t,mustCompleteCompliance:n,showComplianceForm:h,showProductList:m,isCreatingCatalog:I,onAddProduct:O,onAddFirstProduct:F,onRemoveProduct:G,onComplianceFormClosed:()=>(f(!1),L())},e))}):null}},12290:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(48360),i=n(88102),o=n(65303),s=a(n(32973)),l=n(82145),d=n(14746),c=a(n(54050)),u=n(85893);class h extends s.default{constructor(){super(...arguments),this._onEditSuccess=e=>{(0,l.qplStartProductView)("EditProduct"),this._showInfoDrawer(e)},this._showInfoDrawer=e=>{const{catalog:t}=this.props;this.push((0,u.jsx)(d.ProductInfoDrawer,{catalog:t,product:e,onCancel:this.end,onEditProduct:this._onProductEdit,onShareProduct:this.onShareProduct}))},this.onShareProduct=e=>{this.push((0,u.jsx)(c.default,{onBack:this._pop,product:e,prompt:(0,u.jsx)("div",{children:r.fbt._("Anyone with WhatsApp can follow this link to browse catalog",null,{hk:"1Lofnu"})}),onSend:()=>i.Cmd.closeDrawerMid(),centerDrawer:!0,sendProductMsg:!0}))},this._onProductEdit=e=>{this.push((0,u.jsx)(o.EditProductDrawer,{catalog:this.props.catalog,onBack:this._pop,onEditSuccess:this._onEditSuccess,product:e,onDelete:this._handleDelete}))},this._handleDelete=e=>{var t,n;const{product:a}=this.props;a.id===e.id&&i.Cmd.closeDrawerMid(),null===(t=(n=this.props).onDelete)||void 0===t||t.call(n)},this._pop=()=>{this.pop()},this._end=()=>{this.end(!0)}}componentDidMount(){const{catalog:e,product:t,onCreate:n,newProduct:a}=this.props;e.productCollection.on("remove",this._handleDelete),a?this.push((0,u.jsx)(o.EditProductDrawer,{onCancel:this._pop,onEditSuccess:e=>n?n(e):this._onEditSuccess(t),catalog:e,product:t,newProduct:!0})):this._showInfoDrawer(t)}componentWillUnmount(){this.props.catalog.productCollection.off("remove",this._handleDelete)}}t.default=h},77467:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(n(64369)),i=a(n(10403)),o=n(88102),s=a(n(52665)),l=a(n(32973)),d=a(n(43725)),c=n(16770),u=a(n(76419)),h=a(n(19446)),f=n(47809),p=n(85893);class m extends l.default{constructor(){super(...arguments),this.onDeleteLabel=e=>{e.forEach((e=>{let{id:t}=e;c.LabelCollection.deleteLabel(t)}))},this._onManageLabels=e=>{o.Cmd.openModal((0,p.jsx)(f.ManageLabelFlowLoadable,{modelsToUpdate:e}))},this.onEditLabel=e=>{o.Cmd.openModal((0,p.jsx)(i.default,{labelId:e,onUpdateLabel:this.onUpdateLabel,onCancel:o.Cmd.closeModal()}))},this.onLabelClick=e=>{const t=n(41885).Z;this.push((0,p.jsx)(t,{openLabelColorDrawer:this.openLabelColorDrawer,labelId:e,onManageLabels:this._onManageLabels,onClose:this._pop,onRemoveLabel:this.onRemoveLabel,onEditLabel:this.onEditLabel}))},this.openAddLabel=()=>{c.LabelCollection.toArray().length>=r.default.MAX_SMB_LABEL_COUNT?o.Cmd.openModal((0,p.jsx)(s.default,{okText:d.default.t(689),onOK:()=>o.Cmd.closeModal(),children:d.default.t(1040,{count:r.default.MAX_SMB_LABEL_COUNT})})):o.Cmd.openModal((0,p.jsx)(i.default,{onAddLabel:this.onAddLabel,onCancel:o.Cmd.closeModal()}))},this.onUpdateLabel=(e,t)=>{c.LabelCollection.updateLabel(e,t)},this.openLabelColorDrawer=(e,t)=>{this.push((0,p.jsx)(u.default,{labelId:e,onClose:this._pop,onUpdateColor:this.onUpdateLabel,currentColor:t}))},this._pop=()=>{this.pop()}}componentDidMount(){this.push((0,p.jsx)(h.default,{onDeleteLabel:this.onDeleteLabel,onLabelClick:this.onLabelClick,onClose:this._pop,openAddLabel:this.openAddLabel}))}onAddLabel(e,t){c.LabelCollection.addNewLabel(e,t)}onRemoveLabel(e,t){c.LabelCollection.addOrRemoveLabels([{id:e,type:"remove"}],t)}}t.default=m},51095:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(n(64369)),i=a(n(10403)),o=n(63183),s=n(88102),l=a(n(52665)),d=a(n(32973)),c=a(n(43725)),u=n(16770),h=n(50047),f=a(n(94981)),p=a(n(11339)),m=n(85893);class g extends d.default{constructor(){super(...arguments),this._newlyAddedLabels=new Set,this._logWamEvent=()=>{const e=this.props.modelsToUpdate.length;this._labelViewType=1===e?this.props.modelsToUpdate[0]instanceof o.Chat?p.default.LABEL_TARGETS.LABEL_CHAT_DIALOG:p.default.LABEL_TARGETS.LABEL_MESSAGE_DIALOG:p.default.LABEL_TARGETS.LABEL_COMBINED_DIALOG,(0,h.logLabelOperationEvent)(p.default.LABEL_OPERATIONS.VIEW,e,this._labelViewType)},this.onLabelUpdateComplete=()=>{this.props.onLabelUpdateComplete&&this.props.onLabelUpdateComplete(),this._pop()},this.onAddLabel=(e,t)=>{u.LabelCollection.addNewLabel(e,t).then((()=>{this._newlyAddedLabels.add(e)}))},this.shouldScrollIntoViewAndSelect=e=>this._newlyAddedLabels.has(e)?(this._newlyAddedLabels.delete(e),{shouldScrollIntoView:!0,shouldSelect:!0}):{shouldScrollIntoView:!1,shouldSelect:!1},this.onAddNewLabel=()=>{u.LabelCollection.toArray().length>=r.default.MAX_SMB_LABEL_COUNT?s.Cmd.openModal((0,m.jsx)(l.default,{okText:c.default.t(689),onOK:()=>s.Cmd.closeModal(),children:c.default.t(1040,{count:r.default.MAX_SMB_LABEL_COUNT})})):this.push((0,m.jsx)(i.default,{onAddLabel:this.onAddLabel,onCancel:this._pop}))},this._popAndLogEvent=()=>{this._labelViewType&&(0,h.logLabelOperationEvent)(p.default.LABEL_OPERATIONS.CLICK_NEGATIVE,this.props.modelsToUpdate.length,this._labelViewType),this.pop()},this._pop=()=>{this.pop()}}componentDidMount(){this._logWamEvent(),this.push((0,m.jsx)(f.default,{shouldScrollIntoViewAndSelect:this.shouldScrollIntoViewAndSelect,onAddNewLabel:this.onAddNewLabel,onLabelUpdateComplete:this.onLabelUpdateComplete,onCancel:this._popAndLogEvent,modelsToUpdate:this.props.modelsToUpdate}))}}t.default=g,g.defaultProps={removeTopDrawer:!0,pushTransition:"none",popTransition:"none"}},11753:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(n(81109)),i=a(n(48926)),o=n(40277),s=n(48360),l=n(67294),d=(a(n(56720)),n(79686)),c=a(n(48517)),u=n(93581),h=n(33866),f=n(88102),p=n(30066),m=n(27105),g=n(72549),v=a(n(60453)),_=a(n(69637)),x=n(94790),C=a(n(33308)),y=a(n(71520)),S=a(n(32973)),j=n(99234),b=n(57701),E=n(84287),k=n(13923),I=n(90011),w=n(85832),T=n(85893);const P={complianceInfoHelpCenterBanner:{color:"hp667wtd",paddingTop:"nlnf8xo7",paddingEnd:"bcymb0na",paddingBottom:"r219jyu0",paddingStart:"e8k79tju"},formContainer:{paddingTop:"a4bywxmn",paddingEnd:"bcymb0na",paddingBottom:"ekpn4oxx",paddingStart:"e8k79tju",marginBottom:"brac1wpa"},formTitle:{paddingTop:"i5tg98hk",paddingEnd:"f9ovudaz",paddingBottom:"przvwfww",paddingStart:"gx1rr48f",marginBottom:"oqp0d33z"},formTitleWithSubtitle:{paddingTop:"i5tg98hk",paddingEnd:"f9ovudaz",paddingBottom:"przvwfww",paddingStart:"gx1rr48f",marginBottom:"inww9tbj"},subtitle:{color:"hp667wtd",marginBottom:"oqp0d33z"},containingBlock:{transform:"cgi16xlc"}};class M extends S.default{componentDidMount(){this.push((0,T.jsx)(B,{contactId:this.props.contactId,enableCatalogCreationContext:this.props.enableCatalogCreationContext,enableBusinessProfileAddress:this.props.enableBusinessProfileAddress,onBack:()=>{this.props.onBack()},onAddProduct:this.props.onAddProduct}))}componentWillUnmount(){var e,t;null===(e=(t=this.props).onUnmount)||void 0===e||e.call(t)}}t.default=M;const L=e=>e?P.formTitleWithSubtitle:P.formTitle,O=()=>s.fbt._("Add a legal name of business",null,{hk:"1Dgk4f"}),A=()=>s.fbt._("Add a business address",null,{hk:"2x7w3h"}),D=e=>e?s.fbt._("Incorrect email address format",null,{hk:"1KuwvT"}):s.fbt._("Add an email address",null,{hk:"KeJaU"}),R=()=>s.fbt._("Add a grievance officer name",null,{hk:"29OUSc"}),N=e=>!e||(0,o.isPotentiallyPhoneNumber)(e),F=(0,j.getMeUser)(),B=(0,l.forwardRef)(((e,t)=>{let{contactId:n,onBack:a,enableCatalogCreationContext:o,enableBusinessProfileAddress:d,onAddProduct:S}=e;const j=(0,l.useRef)(null);(0,l.useImperativeHandle)(t,(()=>({getElement:()=>j.current})));const[E,I]=(0,l.useState)({}),[M,B]=(0,l.useState)({}),[H,W]=(0,l.useState)(!0),[V,z]=(0,l.useState)(!1),[q,K]=(0,l.useState)(),[Y,Q]=(0,l.useState)(!1);(0,l.useEffect)((()=>{let e=!0;return(0,i.default)((function*(){const[t,a]=yield Promise.all([(0,m.getLegalEntityDetails)(n),u.BusinessProfileCollection.find(n)]);e&&(I(t),K(a.serialize()),W(!1))}))(),()=>{e=!1}}),[n]),(0,l.useEffect)((()=>{Q(!Object.keys(M).length&&(0,g.isBusinessCompliant)(null==q?void 0:q.address,E,n))}),[E,M,null==q?void 0:q.address,n]);const X=function(){var e=(0,i.default)((function*(e){yield(0,h.editBusinessCompliance)(e);const t=yield u.BusinessProfileCollection.update(F,{getMerchantCompliance:!0});return(Array.isArray(t)?t[0]:t).serialize().legalEntityDetails}));return function(){return e.apply(this,arguments)}}(),Z=(0,l.useCallback)(function(){var e=(0,i.default)((function*(e,t){const n={[e]:t,isRegistered:null==E?void 0:E.isRegistered};I((0,r.default)((0,r.default)({},E),n));const a=yield X(n);I(a)}));return function(){return e.apply(this,arguments)}}(),[E]),J=(0,l.useCallback)(((e,t)=>{B((n=>(0,r.default)((0,r.default)({},n),{},{[`${e}.${t}`]:!0})))}),[]),$=(0,l.useCallback)(((e,t)=>{B((n=>{const a=(0,r.default)({},n);return delete a[`${e}.${t}`],a}))}),[]),ee=(0,l.useCallback)(function(){var e=(0,i.default)((function*(e,t,n){const a={[e]:{[t]:n},isRegistered:null==E?void 0:E.isRegistered};I((0,r.default)((0,r.default)({},E),{},{[e]:(0,r.default)((0,r.default)({},null==E?void 0:E[e]),a[e])}));try{J(e,t);const n=yield X(a);I(n),$(e,t)}catch(e){throw new Error(e)}}));return function(){return e.apply(this,arguments)}}(),[E,J,$]),te=(0,l.useCallback)(function(){var e=(0,i.default)((function*(e){K(e),yield u.BusinessProfileCollection.update(F)}));return function(){return e.apply(this,arguments)}}(),[]),ne=(0,l.useCallback)(function(){var e=(0,i.default)((function*(e,t){I(yield(0,m.getLegalEntityDetails)(n)),$(e,t)}));return function(){return e.apply(this,arguments)}}(),[n,$]),ae=(0,l.useCallback)(function(){var e=(0,i.default)((function*(e,t,n){if(e||t){z(!0);const a=yield X({entityType:e,entityTypeCustom:t,isRegistered:n});z(!1),I(a)}}));return function(){return e.apply(this,arguments)}}(),[]),{entityName:re,customerCareDetails:ie,grievanceOfficerDetails:oe}=E||{},se=(0,l.useMemo)((()=>(0,g.getEntityTypeText)(E)),[E]),le=(0,l.useCallback)((e=>(0,g.existsField)(e,n)),[n]),de=(0,l.useRef)(null),ce=(0,b.canSeeECommerceComplianceIndiaHardEnforcementBusinessJourney)(F.user);return(0,T.jsx)("div",{ref:j,children:(0,T.jsxs)(v.default,{xstyle:P.containingBlock,children:[(0,T.jsx)(x.DrawerHeader,{title:s.fbt._("Business details",null,{hk:"m9xzp"}),onBack:a,type:x.DRAWER_HEADER_TYPE.LARGE}),(0,T.jsx)(_.default,{theme:H?"center-content":void 0,ref:de,children:H?(0,T.jsx)(m.ComplianceInfoLoading,{}):(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(m.ComplianceInfoHelpCenterBanner,{xstyle:P.complianceInfoHelpCenterBanner}),(0,T.jsxs)(C.default,{titleXStyle:P.formTitle,xstyle:[P.formContainer],children:[(0,T.jsx)(U,{value:re,maxLength:p.COMPLIANCE_INFO_LENGTH.ENTITY_NAME,placeholder:s.fbt._("Legal Name of Business",null,{hk:"2s9jD"}),icon:"info",validate:le,errorFn:O,onSave:e=>Z("entityName",e)}),(0,T.jsx)(U,{value:se,placeholder:s.fbt._("Business Type",null,{hk:"48J73B"}),icon:"account-balance",onFocus:()=>f.Cmd.showMerchantDetailsEntityTypePopup(E,ae),isLoading:V}),ce?(0,T.jsx)(G,{rawBusinessProfile:q,validate:le,onAfterSave:te,errorFn:A}):null]}),(0,T.jsxs)(C.default,{title:s.fbt._("Customer Care Information",null,{hk:"qlYos"}),titleXStyle:L(ce),xstyle:[P.formContainer],children:[ce?(0,T.jsx)(k.TextDiv,{xstyle:P.subtitle,children:s.fbt._("Provide at least one phone number and email address",null,{hk:"IKXYK"})}):null,(0,T.jsx)(U,{value:null==ie?void 0:ie.mobileNumber,maxLength:p.COMPLIANCE_INFO_LENGTH.MOBILE_NUMBER,placeholder:s.fbt._("Mobile Phone Number",null,{hk:"PMTTg"}),icon:"phone",validate:e=>(0,g.existsCustomerCareDetailsContact)(ie,n,"mobileNumber",e)&&N(e),onSave:e=>ee("customerCareDetails","mobileNumber",e),onCancel:()=>ne("customerCareDetails","mobileNumber"),onError:e=>(0,m.handleCustomerCareDetailsError)(ie,n,"mobileNumber",e),errorFn:e=>(0,g.getCustomerCareDetailsError)(ie,"mobileNumber",e,s.fbt._("Incorrect phone number format",null,{hk:"3lFQ1f"}),n)}),(0,T.jsx)(U,{value:null==ie?void 0:ie.landlineNumber,maxLength:p.COMPLIANCE_INFO_LENGTH.LANDLINE_NUMBER,placeholder:s.fbt._("Landline Phone Number",null,{hk:"tXYaf"}),icon:"phone",validate:e=>(0,g.existsCustomerCareDetailsContact)(ie,n,"landlineNumber",e)&&N(e),onSave:e=>ee("customerCareDetails","landlineNumber",e),onCancel:()=>ne("customerCareDetails","landlineNumber"),onError:e=>(0,m.handleCustomerCareDetailsError)(ie,n,"landlineNumber",e),errorFn:e=>(0,g.getCustomerCareDetailsError)(ie,"landlineNumber",e,s.fbt._("Incorrect landline phone number format",null,{hk:"4zXlsw"}),n)}),(0,T.jsx)(U,{value:null==ie?void 0:ie.email,maxLength:p.COMPLIANCE_INFO_LENGTH.EMAIL,placeholder:s.fbt._("Email Address",null,{hk:"2jYxR1"}),icon:"business-email",validate:e=>le(e)&&(0,w.validateEmail)(e),onSave:e=>ee("customerCareDetails","email",e),errorFn:D})]}),(0,T.jsxs)(C.default,{title:s.fbt._("Grievance Officer Information",null,{hk:"3emd7I"}),titleXStyle:L(ce),xstyle:[P.formContainer],children:[ce?(0,T.jsx)(k.TextDiv,{xstyle:P.subtitle,children:s.fbt._("Provide name and at least one contact method",null,{hk:"2Fjw3Y"})}):null,(0,T.jsx)(U,{value:null==oe?void 0:oe.name,maxLength:p.COMPLIANCE_INFO_LENGTH.GRIEVANCE_OFFICER_NAME,placeholder:s.fbt._("Name",null,{hk:"2vEs6r"}),validate:le,icon:"assignment-ind",onSave:e=>ee("grievanceOfficerDetails","name",e),errorFn:R}),(0,T.jsx)(U,{value:null==oe?void 0:oe.mobileNumber,maxLength:p.COMPLIANCE_INFO_LENGTH.MOBILE_NUMBER,placeholder:s.fbt._("Mobile Phone Number",null,{hk:"3kk5I"}),icon:"phone",validate:e=>(0,g.existsGrievanceOfficerDetailsContact)(oe,n,"mobileNumber",e)&&N(e),onSave:e=>ee("grievanceOfficerDetails","mobileNumber",e),onCancel:()=>ne("grievanceOfficerDetails","mobileNumber"),onError:e=>(0,m.handleGrievanceOfficerDetailsError)(oe,n,"mobileNumber",e),errorFn:e=>(0,g.getGrievanceOfficerDetailsError)(oe,"mobileNumber",e,s.fbt._("Incorrect phone number format",null,{hk:"3lFQ1f"}),n)}),(0,T.jsx)(U,{value:null==oe?void 0:oe.landlineNumber,maxLength:p.COMPLIANCE_INFO_LENGTH.LANDLINE_NUMBER,placeholder:s.fbt._("Landline Phone Number",null,{hk:"4GBzF0"}),icon:"phone",validate:e=>(0,g.existsGrievanceOfficerDetailsContact)(oe,n,"landlineNumber",e)&&N(e),onSave:e=>ee("grievanceOfficerDetails","landlineNumber",e),onCancel:()=>ne("grievanceOfficerDetails","landlineNumber"),onError:e=>(0,m.handleGrievanceOfficerDetailsError)(oe,n,"landlineNumber",e),errorFn:e=>(0,g.getGrievanceOfficerDetailsError)(oe,"landlineNumber",e,s.fbt._("Incorrect landline phone number format",null,{hk:"4zXlsw"}),n)}),(0,T.jsx)(U,{value:null==oe?void 0:oe.email,maxLength:p.COMPLIANCE_INFO_LENGTH.EMAIL,placeholder:s.fbt._("Email Address",null,{hk:"3SvbLl"}),icon:"business-email",validate:e=>(0,g.existsGrievanceOfficerDetailsContact)(oe,n,"email",e)&&(0,w.validateEmail)(e),onSave:e=>ee("grievanceOfficerDetails","email",e),onError:e=>(0,m.handleGrievanceOfficerDetailsError)(oe,n,"email",e),errorFn:e=>(0,g.getGrievanceOfficerDetailsError)(oe,"email",e,s.fbt._("Incorrect email address format",null,{hk:"1KuwvT"}),n)})]}),null!=o&&null!=S?(0,T.jsx)(y.default,{disabled:!Y,rootRef:de.current,onClick:()=>(0,c.default)(S),children:s.fbt._("Next: Add Items",null,{hk:"4gxzId"})}):null]})})]})})}));function U(e){let{value:t="",maxLength:n,placeholder:a,icon:r,isLoading:o=!1,validate:s,errorFn:d,onChange:c,onSave:u,onCancel:h,onError:f,onFocus:p}=e;const[m,g]=(0,l.useState)(t),[v,_]=(0,l.useState)(),[x,C]=(0,l.useState)(o);return(0,l.useEffect)((()=>{g(t)}),[t]),(0,l.useEffect)((()=>{(null==s?void 0:s(m))&&_(null)}),[m,s,d]),(0,l.useEffect)((()=>{C(o)}),[o]),(0,T.jsx)(E.IconSection,{icon:r,theme:E.IconSectionTheme.NoMargin,content:(0,T.jsx)(I.TextInput,{value:m,editable:!0,maxLength:n,pending:x,inputPlaceholder:a,showRemaining:!0,managedError:!0,validate:s,error:v,onChange:g,onSave:(0,i.default)((function*(){C(!0);try{yield null==u?void 0:u(m)}catch(e){d&&_(d(m))}C(!1)})),onCancel:()=>{g(t),_(null),null==h||h()},onError:()=>{d&&_(d(m)),null==f||f(m)},theme:"text-input",onFocus:p,blockFocusOnLock:!!p,lockable:!0})})}function H(e,t,n){return{address:e,categories:[],hours:{days:[]},longitude:t,latitude:n}}function G(e){let{rawBusinessProfile:t,validate:n,onAfterSave:a,errorFn:o}=e;const[s,c]=(0,l.useState)(),[u,f]=(0,l.useState)(null==t?void 0:t.address),[p,m]=(0,l.useState)(),{longitude:g,latitude:v}=t||{},[_,x]=(0,l.useState)(H(u,g,v));return(0,l.useEffect)((()=>x(H(u,g,v))),[u,g,v]),(0,l.useEffect)((()=>{n(u)&&m(null)}),[u,n]),null==t||null==_?null:(0,T.jsx)(E.IconSection,{icon:"business-address",theme:E.IconSectionTheme.NoMargin,content:(0,T.jsx)(d.BusinessAddressField,{businessProfile:_,activeField:s,rawBusinessProfile:t,value:u,validate:n,error:p,lowProfile:!1,onActive:c,onChange:f,onCancel:()=>{f(t.address)},onSaveBusinessProfile:(0,i.default)((function*(){yield(0,h.editBusinessProfile)({address:u}),yield a((0,r.default)((0,r.default)({},t),{},{address:u}))})),onError:()=>{o&&m(o(u))}})})}},62643:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(48360),i=n(67294),o=a(n(56720)),s=n(88102),l=n(88984),d=a(n(60453)),c=a(n(69637)),u=n(94790),h=a(n(32973)),f=n(12176),p=n(96866),m=n(18878),g=n(88998),v=n(43538),_=n(11054),x=a(n(23217)),C=n(18085),y=a(n(59147)),S=n(85893);class j extends h.default{componentDidMount(){this.push((0,S.jsx)(w,{onBack:this.end}))}}t.default=j;const b={orderButton:{paddingTop:"emrlamx0",paddingEnd:"itegkywt",paddingBottom:"aiput80m",paddingStart:"rppts313",display:"p357zi0d",borderBottom:"qmxv8cnq",textAlign:"ljrqcn24",width:"ln8gz9je"},orderManagementDrawerBody:{backgroundColor:"ihvf49ua"},orderInfo:{paddingTop:"i5tg98hk",paddingEnd:"itegkywt",paddingBottom:"przvwfww",paddingStart:"rppts313",flexGrow:"ggj6brxn"},orderInfoRow:{display:"p357zi0d",paddingTop:"qomlamqu",paddingEnd:"lnjlmjd6",paddingBottom:"bxcbqipq",paddingStart:"mc6o24uu",fontSize:"enbbiyaj"},flexGrow:{flexGrow:"ggj6brxn"},orderSubDetails:{color:"re3l9645"},canceled:{color:"mvxzr2tb"},completed:{color:"jq3rn4u7"},title:{paddingTop:"emrlamx0",paddingEnd:"l9g3jx6n",paddingBottom:"aiput80m",paddingStart:"lyvj5e2u",color:"re3l9645",fontWeight:"hnx8ox4h",fontSize:"f8jlpxt4",lineHeight:"nig63irp"},noHistoryWrpr:{display:"p357zi0d",flexDirection:"f8m0rgwh",alignItems:"gndfcl4n",paddingTop:"qlb265nb"},subTitle:{paddingTop:"tvsr5v2h",paddingEnd:"l9g3jx6n",paddingBottom:"jd93c9cp",paddingStart:"lyvj5e2u",color:"re3l9645",fontSize:"dsh4tgtl",lineHeight:"geihefkw"},loader:{paddingTop:"tvsr5v2h",paddingEnd:"l9g3jx6n",paddingBottom:"jd93c9cp",paddingStart:"lyvj5e2u",display:"p357zi0d",justifyContent:"ac2vgrno"}},E=e=>{let{orderStatusInfo:t=g.OrderStatus.Pending}=e;const n=v.OrderStatusLabels[t];return(0,S.jsx)("span",{className:(0,o.default)(b[String(t)]),children:n})},k=e=>{let{items:t=[]}=e;if(0===t.length)return null;const[n,...a]=t;return(0,S.jsxs)("span",{className:(0,o.default)(b.flexGrow),children:[n.name," ",a.length>0&&(0,S.jsxs)(S.Fragment,{children:[r.fbt._("and",null,{hk:"10D2a9"})," ",1===a.length?a[0].name:r.fbt._({"*":"{number_of_items} items",_1:"1 item"},[r.fbt._plural(a.length,"number_of_items")],{hk:"1kMaqb"})]})]})},I=()=>(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)("div",{className:(0,o.default)(b.title),children:r.fbt._("History",null,{hk:"4glDgc"})}),(0,S.jsxs)("div",{className:(0,o.default)(b.noHistoryWrpr),children:[(0,S.jsx)(x.default,{name:"payment-history-empty"}),(0,S.jsx)("div",{className:(0,o.default)(b.subTitle),children:r.fbt._("No order history",null,{hk:"AiunH"})})]})]}),w=(0,i.forwardRef)((e=>{const{ordersInfoMap:{contactAndOrderInfoMap:t,orderStatusInfoMap:n},isLoading:a}=(0,C.useGetOrders)(),s=(0,i.useMemo)((()=>Object.keys(t).sort(((e,n)=>t[n].timestamp-t[e].timestamp))),[t]);return(0,S.jsxs)(d.default,{children:[(0,S.jsx)(u.DrawerHeader,{title:r.fbt._("Orders",null,{hk:"3cylXu"}),type:u.DRAWER_HEADER_TYPE.LARGE,onBack:e.onBack}),(0,S.jsxs)(c.default,{className:(0,o.default)(b.orderManagementDrawerBody),children:[s.map(((e,a)=>(0,S.jsxs)(i.Fragment,{children:[(0,S.jsx)(P,{date:(0,m.getOrderDisplayDate)(t,s,a)}),(0,S.jsx)(T,{contactAndOrderInfo:t[e],orderStatusInfo:n[e]?n[e].status:g.OrderStatus.Pending})]},e))),a&&(0,S.jsx)("div",{className:(0,o.default)(b.loader),children:(0,S.jsx)(_.Spinner,{color:"default",size:24,stroke:6})}),!a&&!s.length&&(0,S.jsx)(I,{})]})]})})),T=e=>{var t;let{contactAndOrderInfo:n,orderStatusInfo:a}=e;const r=(0,y.default)();return(0,S.jsxs)("button",{onClick:()=>{const{interactiveMsg:e}=n;e&&(s.Cmd.openChatFromUnread(e.chat),(0,p.openOrderDetailDrawer)(e,r))},className:(0,o.default)(b.orderButton),children:[(0,S.jsx)(l.DetailImage,{id:n.contact.id}),(0,S.jsxs)("div",{className:(0,o.default)(b.orderInfo),children:[(0,S.jsxs)("div",{className:(0,o.default)(b.orderInfoRow),children:[(0,S.jsx)(f.Name,{className:(0,o.default)(b.flexGrow),contact:n.contact}),(0,S.jsxs)("span",{children:[n.orderInfo.currency," ",null!==(t=n.orderInfo.totalAmount)&&void 0!==t?t:0]})]}),(0,S.jsxs)("div",{className:(0,o.default)(b.orderInfoRow,b.orderSubDetails),children:[(0,S.jsx)(k,{items:n.orderInfo.items}),(0,S.jsx)(E,{orderStatusInfo:a})]})]})]})},P=e=>{let{date:t=""}=e;return t&&(0,S.jsx)("div",{className:(0,o.default)(b.title),children:t.toUpperCase()})}},82554:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=D;var r=a(n(81109)),i=a(n(48926)),o=n(45454),s=n(48360),l=n(67294),d=n(93581),c=a(n(77338)),u=a(n(7532)),h=a(n(54414)),f=n(88102),p=n(19829),m=a(n(52665)),g=n(19380),v=n(27394),_=a(n(32973)),x=n(57701),C=n(77975),y=a(n(67700)),S=a(n(80456)),j=a(n(32488)),b=a(n(3607)),E=n(97567),k=a(n(70107)),I=n(79188),w=a(n(54050)),T=n(11395),P=n(91695),M=a(n(77776)),L=a(n(56829)),O=n(85893);class A extends _.default{constructor(){var e;super(...arguments),e=this,this.scrollOffset=0,this.setScrollOffset=e=>{this.scrollOffset=e},this.onCollectionSeeAll=e=>{const{catalogOwnerJid:t,chat:n,product:a,productInfo:r,sellerJid:i}=this.props,o=t||(null==a?void 0:a.catalogWid.toString())||(null==r?void 0:r.businessOwnerJid)||i;this.push((0,O.jsx)(D,{chat:n,catalogOwnerJid:o,collection:e,isAllItems:!e}))},this._pushProductDetails=(e,t)=>{const{chat:n,refreshCarousel:a}=this.props,r=(0,O.jsx)(k.default,{chat:n,product:e,onEnd:this._end,onBack:this._popAndUpdate,onProductDetail:this.onProductDetail,onProductCatalog:this.onProductCatalogHeaderClick,onProductLinkClick:this._onProductLinkClick,onProductMoreInformation:this.onProductMoreInformation,refreshCarousel:a,onCartClick:this._onCartClick,collectionId:t});this.push(r)},this._pushProductMoreInformation=e=>{const t=(0,O.jsx)(M.default,{product:e,onBack:this._popAndUpdate});this.push(t)},this._pushProductDetailsWithDeepLink=e=>{const t=(0,O.jsx)(I.ProductDetailsWithDeepLink,{chat:this.props.chat,productInfo:e,onEnd:this._end,onBack:this._pop,onProductDetail:this.onProductDetail,onProductCatalog:this.onProductCatalogHeaderClick,onProductLinkClick:this._onProductLinkClick,onProductMoreInformation:this.onProductMoreInformation,onCartClick:this._onCartClick});this.push(t)},this.pushProductCatalog=function(){var t=(0,i.default)((function*(t){const n=g.ContactCollection.gadd(t),a=yield d.BusinessProfileCollection.find(t),r=(0,x.canViewCollections)()?(0,O.jsx)(h.default,{contact:n,onProductDetail:e.onProductDetail,catalogId:t,onBack:e._pop,businessProfile:a,scrollOffset:e.scrollOffset,setScrollOffset:e.setScrollOffset,onCatalogLinkClick:e._onCatalogLinkClick,onCartClick:e._onCartClick,onCollectionSeeAll:e.onCollectionSeeAll}):(0,O.jsx)(T.ProductListDrawer,{contact:n,onProductDetail:e.onProductDetail,catalogId:t,onBack:e._pop,businessProfile:a,setScrollOffset:e.setScrollOffset,onCatalogLinkClick:e._onCatalogLinkClick,onCartClick:e._onCartClick});e.push(r)}));return function(){return t.apply(this,arguments)}}(),this._pushCartOrderDetail=(e,t,n,a,r,i,o)=>{const s=(0,O.jsx)(c.default,{orderId:e,token:t,sellerJid:n,userIsCartOwner:a,onProductDetail:this._onProductDetailFromInfo,onOrderCreate:this.onOrderCreate,onOrderCancel:this._handleOrderCancel,ownerHasReviewed:r,orderMessage:i,chat:o});this.push(s)},this._pushProductList=(e,t)=>{const n=g.ContactCollection.gadd(t),a=(0,O.jsx)(P.ProductMessageListDrawer,{contact:n,productListId:e,onProductDetail:this.onProductDetail,onCartClick:this._onCartClick,onBack:this._pop,onEnd:this._end,setScrollOffset:this.setScrollOffset});this.push(a)},this._handleProductSummaryClick=e=>{this._pushOrderDetailProductList(e)},this._handleOrderStatusUpdateClick=()=>{this._pushOrderStatusUpdate()},this.onOrderCreate=e=>{this._pushOrderCreate(e)},this.cancelOrder=()=>{const{orderId:e,token:t,sellerJid:n,userIsCartOwner:a,orderMessage:r,chat:i}=this.props;null!=e&&null!=t&&null!=n&&null!=a&&this._pushCartOrderDetail(e,t,n,a,!0,r,i),f.Cmd.closeModal()},this._handleOrderCancel=()=>{f.Cmd.openModal((0,O.jsx)(m.default,{onCancel:()=>{f.Cmd.closeModal()},cancelText:s.fbt._("No",null,{hk:"4G38V6"}),onOK:this.cancelOrder,okText:s.fbt._("Yes cancel",null,{hk:"N0ngG"}),title:s.fbt._("Cancel this order?",null,{hk:"dMHPf"}),children:s.fbt._("The user will be notified that the order has been canceled.",null,{hk:"2cf0Xl"})}))},this.onProductDetail=(e,t)=>{this._pushProductDetails(e,t)},this.onProductMoreInformation=e=>{this._pushProductMoreInformation(e)},this._onProductDetailFromInfo=e=>{this._pushProductDetailsWithDeepLink(e)},this.onProductCatalogHeaderClick=(e,t)=>{(0,C.logCarouselViewMoreClick)({catalogOwnerWid:e,catalogContext:t}),this.pushProductCatalog(e)},this._onProductLinkClick=e=>{this.push((0,O.jsx)(w.default,{product:e,onBack:this._pop}))},this._onCatalogLinkClick=(e,t)=>{this.push((0,O.jsx)(u.default,{catalog:e,contact:t,onBack:this._pop}))},this._onCartClick=e=>{const t=(0,E.getProductCatalogContext)(this.props.context),n=(0,L.default)(e,this.props.chat,t);n&&this.push(n)},this._pop=()=>{this.pop()},this._end=()=>{this.end(!0)},this._popAndUpdate=()=>{this.popAndUpdate({scrollOffset:this.scrollOffset})}}componentDidMount(){const{catalogOwnerJid:e,orderId:t,product:n,productInfo:a,productListId:r,collection:i,collectionId:s,isAllItems:l,token:d,sellerJid:c,userIsCartOwner:u,orderMessage:h,chat:f,orderInfo:p}=this.props;if(e)i||l?this.pushCollectionContent((0,o.createWid)(e)):null!=r?this._pushProductList(r,(0,o.createWid)(e)):this.pushProductCatalog((0,o.createWid)(e));else if(n)this._pushProductDetails(n,s);else if(a)this._pushProductDetailsWithDeepLink(a);else if(t)null!=d&&null!=c&&null!=u&&this._pushCartOrderDetail(t,d,c,u,!1,h,f);else{if(null==p||null==c)throw new Error("ProductDetailsFlow:no-product");this._pushOrderDetail(f,p,(0,o.createWid)(c))}}pushCollectionContent(e){const t=g.ContactCollection.gadd(e);this.push((0,O.jsx)(p.CollectionContentDrawer,{contact:t,onProductDetail:this.onProductDetail,catalogId:e,onBack:this._pop,onCatalogLinkClick:this._onCatalogLinkClick,onCartClick:this._onCartClick,scrollOffset:this.scrollOffset,setScrollOffset:this.setScrollOffset,collection:this.props.collection}))}_pushOrderCreate(e){this.push((0,O.jsx)(y.default,{order:e,chat:this.props.chat}))}_pushOrderDetailProductList(e){this.push((0,O.jsx)(j.default,{onBack:this._pop,productItems:e}))}_pushOrderDetail(e,t,n){this.push((0,O.jsx)(S.default,{onBack:this._pop,orderInfo:t,sellerWid:n,chat:e,onProductSummaryClick:this._handleProductSummaryClick,onOrderStatusUpdateClick:this._handleOrderStatusUpdateClick}))}_pushOrderStatusUpdate(){const{orderInfo:e,sellerJid:t}=this.props;null!=e&&null!=t&&this.push((0,O.jsx)(b.default,{chat:this.props.chat,onBack:this._pop,orderInfo:e,sellerJid:t}))}}function D(e){const t=(0,l.useContext)(v.DrawerContext);return(0,O.jsx)(A,(0,r.default)({context:t},e))}},56464:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(n(48926)),i=n(41906),o=n(80140),s=n(88102),l=a(n(32973)),d=a(n(43725)),c=n(24064),u=n(56728),h=n(64551),f=n(85893);class p extends l.default{constructor(){var e;super(...arguments),e=this,this._handleForwardConfirmed=t=>{(0,c.qplStartProductSendMessage)("Forward",void 0,t.length);const n=t.map(function(){var t=(0,r.default)((function*(t){return t.isUser&&t.contact.isBlocked()&&(yield(0,o.unblockContact)(t.contact)),e._sendProduct(t)}));return function(){return t.apply(this,arguments)}}());(0,c.qplEndProductMessageSend)(Promise.all(n)),this.end(),1===t.length&&(s.Cmd.openChatFromUnread(t[0]),window.innerWidth<=i.LAYOUT_2COLUMNS_MAX_WIDTH&&s.Cmd.closeDrawerRight()),this.props.onSend&&this.props.onSend()},this._handleCancel=()=>{this.end()},this._sendProduct=e=>{const{product:t}=this.props;return new Promise(((n,a)=>{s.Cmd.once("ui_idle",(()=>{e.sendProductMessage(t).then((()=>n())).catch((e=>a(e)))}))}))}}componentDidMount(){s.Cmd.closeContextMenu(),s.Cmd.closeTooltip(),this.push((0,f.jsx)(u.SelectModal,{onConfirm:this._handleForwardConfirmed,maxItems:h.ServerProps.multicastLimitGlobal,title:d.default.t(641),listType:u.ListType.CHAT_SELECT_MODAL,onCancel:this._handleCancel}))}}t.default=p},74671:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(n(37409)),i=a(n(32973)),o=n(78986),s=n(85893);class l extends i.default{constructor(){super(...arguments),this.sendMedia=e=>{let{getImg:t,caption:n,isViewOnce:a,mentionedJidList:r}=e;const i=this.props.chat,s=i.composeQuotedMsg;i.composeQuotedMsg=null;const l=i.getComposeContents().ctwaContext||void 0;(0,o.prepRawMedia)(t,{}).sendToChat(i,{caption:n,mentionedJidList:r,quotedMsg:s,ctwaContext:l,isViewOnce:a}),this.props.onCaptureSent(),this.end()}}componentDidMount(){this.push((0,s.jsx)(r.default,{onBack:()=>{this.end()},chat:this.props.chat,caption:!0,theme:"capture-contain",onSend:this.sendMedia,stream:this.props.stream,disposeStream:this.props.disposeStream}))}}t.default=l},87971:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(n(67873)),i=a(n(32973)),o=n(67455),s=n(85893);class l extends i.default{constructor(){super(...arguments),this.onProductClick=e=>{this.push((0,s.jsx)(o.ProductDetailsFlowLoadable,{refreshCarousel:!0,chat:this.props.msg.chat,product:e,onEnd:this._pop}))},this._pop=()=>{this.pop()}}componentDidMount(){this.push((0,s.jsx)(r.default,{msg:this.props.msg,onProductClick:this.onProductClick}))}}t.default=l},53135:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(50796),i=a(n(37409)),o=n(88102),s=n(50025),l=g(n(64103)),d=a(n(32973)),c=n(18671),u=g(n(61849)),h=n(57224),f=a(n(90012)),p=n(85893);function m(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(m=function(e){return e?n:t})(e)}function g(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=m(t);if(n&&n.has(e))return n.get(e);var a={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var o=r?Object.getOwnPropertyDescriptor(e,i):null;o&&(o.get||o.set)?Object.defineProperty(a,i,o):a[i]=e[i]}return a.default=e,n&&n.set(e,a),a}class v extends d.default{constructor(){super(...arguments),this._refCaptureDrawer=null,this._setRefCaptureDrawer=e=>{this._refCaptureDrawer=e},this._pushPermissionModal=()=>{this.push((0,p.jsx)(c.GuidePopup,{messaging:c.Messaging.CAMERA,type:c.TYPE.GUIDE_ALLOW,onConfirm:this._popModal}),"modal")},this._popModal=()=>{this.pop("modal")},this._startCaptureDrawer=()=>{var e;null===(e=this._disposeStream)||void 0===e||e.call(this);const{asyncStream:t,disposeStream:n}=u.start("camera",this._pushPermissionModal);this._disposeStream=n,t.then((e=>{this._refCaptureDrawer||this._popModal(),e&&this._refCaptureDrawer&&this._refCaptureDrawer.loadNewStream(e,n)})).catch((0,r.filteredCatch)(l.GUM.NotAllowedError,(()=>{this.cleanUp(),o.Cmd.openModal((0,p.jsx)(c.GuidePopup,{messaging:c.Messaging.CAMERA_FAIL,type:c.TYPE.GUIDE_UNBLOCK}))}))).catch((0,r.filteredCatch)(l.GUM.GUMError,(()=>{this.cleanUp(),o.Cmd.openModal((0,p.jsx)(c.GuidePopup,{messaging:c.Messaging.CAMERA_MISSING,type:c.TYPE.GUIDE_NONE}))})))},this.onFinished=(e,t)=>{this.props.onFinished(e,t),this.cleanUp()},this.cleanUp=()=>{this.end()},this.onRetake=()=>{this.pop("flow-transition-box-size-drawer-pop"),this._startCaptureDrawer()},this.onCaptured=e=>{this.push((0,p.jsx)(h.Modal,{type:h.ModalTheme.Box,children:(0,p.jsx)(s.EditImageDrawer,{onRetake:this.onRetake,retryText:s.RETRY_OPTIONS.RETAKE,onFinished:this.onFinished,onCancel:this.cleanUp,img:e})}),"flow-transition-box-size-drawer-push")},this.handleRequestDismiss=e=>{!1===e&&this.stackSize()>1?this.onRetake():this.cleanUp()}}componentDidMount(){this.push((0,p.jsx)(h.Modal,{type:h.ModalTheme.Box,children:(0,p.jsx)(i.default,{ref:this._setRefCaptureDrawer,stream:void 0,disposeStream:void 0,caption:!1,theme:"capture-cover",onBack:this.cleanUp,onSend:null,onCaptured:this.onCaptured,chat:void 0})})),this._startCaptureDrawer()}componentWillUnmount(){var e;null===(e=this._disposeStream)||void 0===e||e.call(this)}}var _=(0,f.default)(v);t.default=_},37792:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(50025),i=a(n(32973)),o=n(85893);class s extends i.default{constructor(){super(...arguments),this.onEnd=()=>{this.end()},this.onFinished=(e,t)=>{this.props.onFinished(e,t),this.end()}}componentDidMount(){this.push((0,o.jsx)(r.EditImageDrawer,{onCancel:this.onEnd,onFinished:this.onFinished,onRetake:this.props.onRetake,retryText:r.RETRY_OPTIONS.RESTART,img:this.props.img}))}}t.default=s},22587:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(50796),i=a(n(64369)),o=n(48360),s=n(69951),l=n(88102),d=a(n(52665)),c=a(n(32973)),u=a(n(45126)),h=a(n(67247)),f=a(n(43725)),p=n(56728),m=n(64551),g=n(85893);class v extends c.default{constructor(){super(...arguments),this.requestFocus=()=>{var e;const t=null===(e=this.refUIE)||void 0===e?void 0:e.getRef();null!=t&&(t instanceof HTMLElement||"function"!=typeof t.onFocusList||t.onFocusList())},this.onForwardConfirmed=e=>{const{msgs:t,onForward:n}=this.props;s.ChatCollection.forwardMessagesToChats(t,e).catch((0,r.filteredCatch)(u.default,(e=>{this._showMediaSendError(e.reasons)}))),this.end(),n&&n(t),l.Cmd.openChatFromUnread(e[0])},this._showMediaSendError=e=>{const t=e.map((e=>{let{chat:t,reason:n}=e;return(0,g.jsxs)("p",{children:[t.formattedTitle," : ",n]},t.id.toString())}));l.Cmd.openModal((0,g.jsx)(d.default,{onOK:()=>l.Cmd.closeModal(),okText:o.fbt._("OK",null,{hk:"2KEeHb"}),children:t}),void 0)}}componentDidMount(){const{msgs:e}=this.props,t=f.default.t(469,{_plural:e.length||1}),n=e[0],a=n.chat;let r;r="video"!==n.type&&"image"!==n.type?"message":n.type;const o=e.some((e=>e.isFrequentlyForwarded)),s=e.some((e=>e.isForwarded)),l=e.filter((e=>!e.isFrequentlyForwarded&&e.getForwardingScoreWhenForwarded()===i.default.FREQUENTLY_FORWARDED_SENTINEL));let d;l.length&&(d=(0,g.jsx)(h.default,{frequentlyForwardedCount:l.length,totalCount:e.length}));const c=o?m.ServerProps.frequentlyForwardedMax:m.ServerProps.multicastLimitGlobal;this.push((0,g.jsx)(p.SelectModal,{onConfirm:this.onForwardConfirmed,maxItems:c,excludeChat:a,excludeBroadcast:!0,msgType:r,title:t,listType:p.ListType.CHAT_SELECT_MODAL,customHeader:d,hasFrequentlyForwarded:o,hasForwarded:s,ephemeralIcon:"chat-list"}))}}t.default=v},21649:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(n(32973)),i=a(n(78582)),o=n(85893);class s extends r.default{componentDidMount(){this.push((0,o.jsx)(i.default,{chat:this.props.chat,onConfirm:this.props.onConfirm}))}}t.default=s},85916:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(n(32973)),i=a(n(41552)),o=n(67455),s=n(85893);class l extends r.default{constructor(){super(...arguments),this.onProductClick=e=>{this.push((0,s.jsx)(o.ProductDetailsFlowLoadable,{refreshCarousel:!0,chat:this.props.msg.chat,product:e,onEnd:this._pop}))},this._pop=()=>{this.pop()}}componentDidMount(){this.push((0,s.jsx)(i.default,{msg:this.props.msg,onProductClick:this.onProductClick}))}}t.default=l},7335:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(n(48926)),i=n(48360),o=n(88102),s=a(n(52665)),l=n(50101),d=a(n(32973)),c=a(n(63928)),u=a(n(14767)),h=a(n(43725)),f=a(n(88793)),p=n(12176),m=n(13705),g=n(50452),v=n(85893);class _ extends d.default{constructor(){var e;super(...arguments),e=this,this.onSendInvite=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1?arguments[1]:void 0;o.Cmd.closeModal(),Promise.all(e.props.participantNeedInvite.map(function(){var a=(0,r.default)((function*(a){const{contact:r,invite_code:i,invite_code_exp:o}=a,s=yield(0,l.findChat)(r.id),d=e.props.groupGid.toString(),u=c.default.assertGet(d);return(yield s.sendGroupInviteMessage(d,e.props.subject,i||"",o,t,n))===m.SendMsgResult.OK&&(u.pendingParticipants.add({id:r.id}),!0)}));return function(){return a.apply(this,arguments)}}())).then((e=>{const t=e.filter(Boolean).length;o.Cmd.openToast((0,v.jsx)(g.Toast,{msg:h.default.t(932,{num:t,_plural:t}),id:(0,g.genId)()}))}))},this._addInviteCommment=e=>{this.push((0,v.jsx)(u.default,{participants:e,gid:this.props.groupGid,subject:this.props.subject,groupDesc:this.props.groupDesc,onClose:this._pop,onSend:this.onSendInvite}))},this._pop=()=>{this.pop()}}componentDidMount(){const{participantNeedInvite:e}=this.props,t=this._getFormattedNames(e.map((e=>e.contact)),!0),n=h.default.t(512,{participant:t,_plural:e.length});this.push((0,v.jsx)(s.default,{onOK:this._addInviteCommment.bind(this,e),okText:i.fbt._("Invite to group",null,{hk:"FbMSO"}),onCancel:this._pop,cancelText:i.fbt._("Cancel",null,{hk:"H0gNq"}),children:n}))}_getFormattedName(e){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]?e.formattedUser:(0,v.jsx)(p.Name,{contact:e})}_getFormattedNames(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!Array.isArray(e))return this._getFormattedName(e,t);const n=e.map((e=>this._getFormattedName(e,t)));return(0,f.default)(n,t)}}t.default=_,_.defaultProps={removeTopDrawer:!0,pushTransition:"none",popTransition:"none"}},89936:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(50025),i=a(n(32973)),o=a(n(90312)),s=n(85893);class l extends i.default{constructor(){super(...arguments),this.onImageSelected=(e,t)=>{this.push((0,s.jsx)(r.EditImageDrawer,{onCancel:this._handleCancel,attributionUrl:t,onFinished:this.onFinished,onRetake:this._pop,retryText:r.RETRY_OPTIONS.NONE,img:e}))},this._handleCancel=()=>{this.end()},this._pop=()=>{this.pop()},this.onFinished=(e,t)=>{this.props.onFinished(e,t),this.end()}}componentDidMount(){this.push((0,s.jsx)(o.default,{onCancel:this._pop,onImageSelected:this.onImageSelected}))}}t.default=l},24064:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.qplEndProductMessageSend=function(e){const t=r.QuickLogMarkerId.WHATSAPP_PRODUCT_MESSAGE_SEND;e.then((()=>{a.QPL.markerEnd(t,a.QuickLogActionType.SUCCESS)})).catch((()=>{a.QPL.markerEnd(t,a.QuickLogActionType.FAIL)}))},t.qplStartProductSendMessage=function(e,t,n){const i=r.QuickLogMarkerId.WHATSAPP_PRODUCT_MESSAGE_SEND;a.QPL.markerStart(i,{string:{EntryPoint:e}}),void 0!==t&&a.QPL.markerAnnotate(i,{int:{ProductCount:t}}),void 0!==n&&a.QPL.markerAnnotate(i,{int:{ContactCount:n}})};var a=n(48870),r=n(27798)},3884:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(88102),i=n(19380),o=a(n(81411)),s=n(56489),l=n(50101),d=a(n(32973)),c=a(n(43725)),u=n(23620),h=a(n(7326)),f=a(n(15309)),p=n(85893);class m extends d.default{constructor(){var e;super(...arguments),e=this,this._handleClick=(e,t)=>{(0,l.findChat)(t.id).then(r.Cmd.openChatFromUnread.bind(r.Cmd)),this.end()},this._handleNewGroup=()=>{this.push((0,p.jsx)(f.default,{onBack:this.pop,onContinue:this._handleSetGroupInfo}))},this._handleNewCommunity=()=>{this.push((0,p.jsx)(u.NewCommunityFlowLoadable,{onBack:this.pop.bind(this)}))},this._handleSubmit=function(t,n,a,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];(0,s.createGroup)(t,n,a,i,r),e.end()},this._handleSetGroupInfo=e=>{this.push((0,p.jsx)(h.default,{participants:e,onBack:()=>{this.popAndUpdate({participants:e})},onSubmit:this._handleSubmit}))}}componentDidMount(){i.ContactCollection.ensureSorted(),this.push((0,p.jsx)(o.default,{title:c.default.t(675),onBack:this.end,onClick:this._handleClick,onNewGroup:this._handleNewGroup,onNewCommunity:this._handleNewCommunity}))}}t.default=m},81971:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const[t,n]=(0,l.useState)(""),[a,k]=(0,l.useState)(),[I,w]=(0,l.useState)(),[T,P]=(0,C.default)(_.NUX.COMMUNITY),[M,L]=(0,l.useState)([]),[O,A]=(0,l.useState)([]),[D,R]=(0,l.useState)(!0),[N,F]=(0,l.useState)(j.METADATA_DRAWER),B=(0,i.default)((()=>{e.onBack?e.onBack():u.Cmd.closeDrawerLeft()}));function U(e){R(!0),F(e)}function H(e){R(!1),F(e)}function G(){return W.apply(this,arguments)}function W(){return(W=(0,r.default)((function*(){yield(0,f.default)({name:t,desc:a,icon:I,existingGroups:M,newGroups:O}),u.Cmd.closeDrawerLeft()}))).apply(this,arguments)}function V(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;const r=(0,o.randomHex)(8);A((t=>[{tempId:r,subject:e,icon:n,ephemeralDuration:a},...t])),H(j.GROUPS_MANAGER)}function z(e){const t=e.map((e=>{var t;const n=(0,s.default)(c.ChatCollection.get(e.id.toString()),"ChatCollection.get(contact.id.toString())");return{id:e.id,subject:n.title(),participants:null===(t=n.groupMetadata)||void 0===t?void 0:t.participants,contact:e}}));L(t),H(j.GROUPS_MANAGER)}function q(e){const t=O.filter((t=>t.tempId!==e)),n=M.filter((t=>t.id.toString()!==e));O.length!==t&&A(t),M.length!==n&&L(n)}const K=b.indexOf(N),Y=function(e){switch(e){case j.METADATA_DRAWER:return(0,S.jsx)(g.default,{name:t,description:a,imgBlob:I,onBack:B,onContinue:(e,t,a)=>{n(e),k(t),w(a),U(j.GROUPS_MANAGER)}});case j.GROUPS_MANAGER:return(0,S.jsx)(m.default,{name:t,description:a,imgBlob:I,onBack:()=>H(j.METADATA_DRAWER),onNewGroupFlow:()=>U(j.NEW_GROUP),onExistingGroupFlow:()=>U(j.EXISTING_GROUP),onRemoveGroup:q,onCreateCommunity:G,groups:[...M,...O]});case j.NEW_GROUP:return(0,S.jsx)(v.default,{onBack:()=>H(j.GROUPS_MANAGER),onSubmit:V});case j.EXISTING_GROUP:return function(){const e=M.reduce(((e,t)=>(null!=t.contact&&e.push(t.contact),e)),[]);return(0,S.jsx)(p.default,{onBack:()=>H(j.GROUPS_MANAGER),onSubmit:z,addedExistingGroups:e,newGroupsCount:O.length})}()}}(N);if(T)return(0,S.jsx)(h.default,{onContinue:P});return(0,S.jsx)(y.default,{transitionName:D?"flow-transition-drawer-push":"flow-transition-drawer-pop",className:(0,d.default)(E),children:(0,S.jsx)(x.UIE,{displayName:`FlowDrawer${K}`,escapable:!0,requestDismiss:function(){B()},children:Y},K)})};var r=a(n(48926)),i=a(n(51463)),o=n(87614),s=a(n(45095)),l=n(67294),d=a(n(56720)),c=n(69951),u=n(88102),h=a(n(30730)),f=a(n(12224)),p=a(n(49658)),m=a(n(63232)),g=a(n(98600)),v=a(n(7326)),_=n(61653),x=n(18644),C=a(n(54416)),y=a(n(41956)),S=n(85893);const j=n(76672).Mirrored(["METADATA_DRAWER","GROUPS_MANAGER","NEW_GROUP","EXISTING_GROUP"]),b=Array.from(j.members()),E={position:"lhggkp7q",top:"qq0sjtgm",start:"tkdu00h0",width:"ln8gz9je",height:"ppled2lx",overflowX:"gfz4du6o",overflowY:"r7fjleex"}},66960:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(19380),i=n(56489),o=a(n(32973)),s=a(n(7326)),l=a(n(15309)),d=n(85893);class c extends o.default{constructor(){var e;super(...arguments),e=this,this._handleSubmit=function(t,n,a,r){let o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];(0,i.createGroup)(t,n,a,o,r),e.end()},this.onSetGroupInfo=e=>{this.push((0,d.jsx)(s.default,{participants:e,onBack:()=>{this.popAndUpdate({participants:e})},onSubmit:this._handleSubmit}))}}componentDidMount(){r.ContactCollection.ensureSorted(),this.push((0,d.jsx)(l.default,{onBack:this.end,onContinue:this.onSetGroupInfo}))}}t.default=c},68706:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(n(48926)),i=a(n(70735)),o=n(45454),s=n(48360),l=n(88102),d=n(19380),c=a(n(32973)),u=a(n(43725)),h=n(61319),f=n(56728),p=n(18963),m=n(94646),g=n(39434),v=n(50452),_=n(77591),x=n(85893);function C(e){switch(e){case"about":return s.fbt._("Hide About from...",null,{hk:"1MC2Uy"});case"profilePicture":return s.fbt._("Hide Profile photo from...",null,{hk:"1j0ovi"});case"lastSeen":return s.fbt._("Hide Last seen from...",null,{hk:"1bZFrJ"});case"groupAdd":return s.fbt._("My contacts except...",null,{hk:"2tCWPL"})}}class y extends c.default{constructor(){var e;super(...arguments),e=this,this._excludedContacts=[],this._handleConfirm=function(){var t=(0,r.default)((function*(t,n){const a=e._excludedContacts.map((e=>e.id)),r=t.map((e=>e.id)),o=[...(0,i.default)(r,a,(e=>e.toString())).map((e=>({action:m.PrivacyUserAction.Add,wid:e}))),...(0,i.default)(a,r,(e=>e.toString())).map((e=>({action:m.PrivacyUserAction.Remove,wid:e})))],d=(0,g.privacyWebNameToServerName)(e.props.category);if("readreceipts"===d)throw new Error("select_contacts_except_flow: name can not be readreceipts");try{yield(0,g.setPrivacyForOneCategory)({value:"contact_blacklist",users:o,dhash:n,name:d},r),e.props.onConfirm()}catch(e){e instanceof _.ServerStatusCodeError&&409===e.statusCode||(__LOG__(3,void 0,void 0,!0)`select_contacts_except_flow: set visiblity option failed ${e.stack}`,SEND_LOGS("select_contacts_except_flow: set visiblity option failed")),l.Cmd.openToast((0,x.jsx)(v.Toast,{id:(0,v.genId)(),msg:s.fbt._("Failed to update privacy settings. Please try again.",null,{hk:"h89q3"})}))}e.pop()}));return function(){return t.apply(this,arguments)}}()}componentDidMount(){this._pushSelectModalToFlow()}_pushSelectModalToFlow(){var e=this;return(0,r.default)((function*(){const{category:t}=e.props;let n=null;try{const a=yield(0,h.getTable)().get(function(e){switch(e){case"about":return h.PrivacyDisallowedListType.About;case"profilePicture":return h.PrivacyDisallowedListType.ProfilePicture;case"lastSeen":return h.PrivacyDisallowedListType.LastSeen;case"groupAdd":return h.PrivacyDisallowedListType.GroupAdd}}(t));null!=a&&(e._excludedContacts=a.disallowedList.map((e=>d.ContactCollection.gadd((0,o.createWid)(e)))),n=a.dhash)}catch(t){return __LOG__(4,void 0,new Error,!0)`error: ${String(t.stack)}`,SEND_LOGS("SelectContactsExceptFlow:failed to get privacyDisallowedList"),l.Cmd.openToast((0,x.jsx)(v.Toast,{id:(0,v.genId)(),msg:s.fbt._("Failed to get contacts except list. Please try again.",null,{hk:"1OErrO"})})),void e.pop()}const a=new Set(e._excludedContacts.map((e=>e.id.toString())));e.push((0,x.jsx)(f.SelectModal,{title:C(t),onCancel:()=>e.pop(),onConfirm:t=>{e._handleConfirm(t,n)},getInitialItems:()=>e._excludedContacts,listType:f.ListType.CONTACT_SELECT_MODAL,maxItems:64e3,singleSelectionFooterType:p.FooterType.CONFIRM,multipleSelectionFooterType:p.FooterType.CONFIRM,useAllContacts:!0,filter:e=>a.has(e.id.toString())||d.ContactCollection.isFilteredContact(e),getSelectionSummary:S,enableSelectAll:!0,activeWithoutSelection:!0}))}))()}}function S(e){const t=e.length;return u.default.t(707,{count:t,_plural:t})}t.default=y},43661:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(n(81109)),i=a(n(32973)),o=a(n(43725)),s=n(56728),l=a(n(60356)),d=n(64551),c=n(85893);class u extends i.default{constructor(){super(...arguments),this._handleForwardConfirmed=e=>{0===e.length&&this.end(),this._chatsToForwardTo=e,this._sendContactToChats(e)},this._sendContactToChats=e=>{for(const t of e)(0,l.default)(this.props.contacts,t),t.composeQuotedMsg=null;this.props.onContactsSent(e[0]),this.end()},this._popNone=()=>{this.pop("none")},this._handleCancel=()=>{this.end()}}componentDidMount(){const e=null==this.props.maxItems?this.props.serverProps.maxParticipants:this.props.maxItems;this.push((0,c.jsx)(s.SelectModal,{onConfirm:this._handleForwardConfirmed,maxItems:e,title:o.default.t(751),listType:s.ListType.CHAT_SELECT_MODAL,onCancel:this._handleCancel}))}}t.default=e=>(0,c.jsx)(u,(0,r.default)((0,r.default)({},e),{},{serverProps:d.ServerProps}))},89495:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t;const{chat:n}=e,a=(0,r.default)(null===(t=n.groupMetadata)||void 0===t?void 0:t.groupInviteLink,"chat.groupMetadata?.groupInviteLink"),d=`${i.fbt._("Follow this link to join my WhatsApp group:",null,{hk:"4FZHrC"}).toString()} ${a}`;return(0,l.jsx)(s.default,{title:o.default.t(494),text:d,pushTransition:"none",popTransition:"none"})};var r=a(n(45095)),i=n(48360),o=a(n(43725)),s=a(n(24158)),l=n(85893)},64232:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(n(81109)),i=a(n(48926)),o=n(80140),s=n(88102),l=a(n(32973)),d=a(n(43725)),c=n(56728),u=n(5524),h=n(64551),f=n(85893);class p extends l.default{constructor(){var e;super(...arguments),e=this,this.onForwardConfirmed=t=>{const n=this.props.msgText;if(1===t.length){let a;const r=t[0];a=r.isUser&&r.contact.isBlocked()?(0,o.unblockContact)(r.contact):Promise.resolve(!0),a.then(function(){var t=(0,i.default)((function*(){if(n){if(r.urlText=e.props.urlText,r.active)return void s.Cmd.pasteChatTextInput(r,n);r.setComposeContents({text:n})}(yield s.Cmd.openChatFromUnread(r))&&s.Cmd.focusChatTextInput(r)}));return function(){return t.apply(this,arguments)}}())}else Promise.all(t.map((e=>{let t;t=e.isUser&&e.contact.isBlocked()?(0,o.unblockContact)(e.contact):Promise.resolve(!0),t.then((()=>{e.urlText=this.props.urlText,(0,u.sendTextMsgToChat)(e,n)}))}))),s.Cmd.openChatFromUnread(t[0]);this.end()}}componentDidMount(){this.push((0,f.jsx)(c.SelectModal,{onConfirm:this.onForwardConfirmed,maxItems:this.props.serverProps.multicastLimitGlobal,title:d.default.t(641),listType:c.ListType.CHAT_SELECT_MODAL}))}}t.default=e=>(0,f.jsx)(p,(0,r.default)((0,r.default)({},e),{},{serverProps:h.ServerProps}))},77248:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(n(62921)),i=a(n(51731)),o=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=A(t);if(n&&n.has(e))return n.get(e);var a={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var o=r?Object.getOwnPropertyDescriptor(e,i):null;o&&(o.get||o.set)?Object.defineProperty(a,i,o):a[i]=e[i]}a.default=e,n&&n.set(e,a);return a}(n(85965)),s=n(88102),l=n(17239),d=n(19380),c=a(n(43250)),u=a(n(32973)),h=n(99234),f=a(n(15048)),p=a(n(57302)),m=a(n(31839)),g=a(n(11339)),v=a(n(46385)),_=a(n(22082)),x=n(39828),C=n(77117),y=n(82039),S=a(n(87613)),j=a(n(98863)),b=a(n(68132)),E=a(n(74265)),k=n(46133),I=a(n(7693)),w=a(n(45026)),T=a(n(37789)),P=a(n(79697)),M=a(n(58030)),L=a(n(14551)),O=n(85893);function A(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(A=function(e){return e?n:t})(e)}class D extends u.default{constructor(){super(...arguments),this._showWallpaperDrawer=()=>{this.push((0,O.jsx)(L.default,{onClose:this._pop}))},this._showArchiveSettingsDrawer=()=>{this.push((0,O.jsx)(r.default,{settings:b.default,onClose:this._pop}))},this._showRequestAccountInfo=()=>this.push((0,O.jsx)(S.default,{settings:b.default,onClose:this._pop})),this._showBlockedDrawer=()=>{this.push((0,O.jsx)(i.default,{onClose:this._pop}))},this._showProfileDrawer=()=>{const e=(0,h.getMaybeMeUser)(),t=k.StatusCollection.assertGet(e),n=y.ProfilePicThumbCollection.assertGet(e),a=d.ContactCollection.assertGet(e);this.push((0,O.jsx)(C.ProfileDrawerFlowLoadable,{status:t,profilePicThumb:n,contact:a,conn:l.Conn,onClose:this._pop}))},this._showNotifications=()=>{this.push((0,O.jsx)(v.default,{onClose:this._pop}))},this._showTwoFactor=()=>{this.push((0,O.jsx)(w.default,{onClose:this._pop,onOpenUpdateEmailDrawer:this._showTwoFactorUpdateEmail,onOpenUpdatePinDrawer:this._showTwoFactorUpdatePinDrawer,onOpenRegistrationDrawer:this._showTwoFactorRegistrationDrawer}))},this._showTwoFactorUpdateEmail=()=>{this.push((0,O.jsx)(P.default,{onClose:this._pop}))},this._showTwoFactorUpdatePinDrawer=()=>{this.push((0,O.jsx)(M.default,{onClose:this._pop}))},this._showTwoFactorRegistrationDrawer=()=>{this.push((0,O.jsx)(T.default,{onClose:this._pop}))},this._showMediaAutoDownload=()=>{this.push((0,O.jsx)(m.default,{onClose:this._pop}))},this._showSecurity=()=>{this.push((0,O.jsx)(j.default,{onClose:this._pop}))},this._showPrivacyVisibilityEditDrawer=e=>{this.push((0,O.jsx)(x.PrivacyVisibilityEditDrawer,{onClose:this._pop,category:e}))},this._showPrivacyDrawer=()=>{this.push((0,O.jsx)(_.default,{onClose:this._pop,onOpenVisibilityEditDrawer:this._showPrivacyVisibilityEditDrawer,onOpenBlockedContacts:this._showBlockedDrawer,onOpenEphemeralityDrawer:this._showEphemeralityDrawer}))},this._showEphemeralityDrawer=()=>{this.push((0,O.jsx)(c.default,{onClose:this._pop,entryPoint:g.default.DISAPPEARING_MODE_ENTRY_POINT_TYPE.ACCOUNT_SETTINGS}))},this._showDesktopSettingsDrawer=()=>{},this._showHelp=()=>{o.upload({reason:"help-page-opened",isHighPri:!0}),this.push((0,O.jsx)(f.default,{onClose:this._pop}))},this._showThemePopup=()=>{s.Cmd.openModal((0,O.jsx)(I.default,{}))},this.showKeyboardShortcuts=()=>{s.Cmd.openModal((0,O.jsx)(p.default,{}))},this._pop=()=>{this.pop()}}componentDidMount(){this.push((0,O.jsx)(E.default,{profileId:(0,h.getMaybeMeUser)(),onWallpaper:this._showWallpaperDrawer,onBlocked:this._showBlockedDrawer,onProfile:this._showProfileDrawer,onNotifications:this._showNotifications,onTwoFactor:this._showTwoFactor,onMediaAutoDownload:this._showMediaAutoDownload,onSecurity:this._showSecurity,onPrivacy:this._showPrivacyDrawer,onDesktopSettings:()=>{},onHelp:this._showHelp,onThemeSettings:this._showThemePopup,onKeyboardShortcuts:this.showKeyboardShortcuts,onClose:this._pop,settings:b.default,onArchiveSettings:this._showArchiveSettingsDrawer,onRequestAccountInfo:this._showRequestAccountInfo}))}}t.default=D},540:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(88102),i=a(n(32973)),o=n(84387),s=a(n(78985)),l=a(n(61752)),d=n(85893);class c extends i.default{constructor(){super(...arguments),this.sessionId=Math.round(1e9*Math.random()),this._openStatusViewer=(e,t,n)=>{this.push((0,d.jsx)(l.default,{initialStatusV3:e,initialStatusMsg:t,closeStatusViewer:this.closeStatusViewer,sessionId:this.sessionId,rowIdx:n}),"none")},this.closeStatusViewer=e=>{e?this.end():this.pop("none")}}componentDidMount(){this.push((0,d.jsx)(s.default,{onOpenStatus:this._openStatusViewer,closeStatusViewer:this.closeStatusViewer,sessionId:this.sessionId}),"status-v3-modal"),this.props.listeners.add(r.Cmd,"close_status_viewer",(()=>{this.closeStatusViewer(!0)}))}componentWillUnmount(){this.props.onFlowEnd()}}var u=(0,o.ListenerHOC)(c);t.default=u},86245:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(88102),i=a(n(32973)),o=a(n(11339)),s=a(n(39822)),l=a(n(41966)),d=a(n(37968)),c=n(85893);class u extends i.default{constructor(){super(...arguments),this._scrollOffset=0,this._handleScrollOffsetChange=e=>{this._scrollOffset=e},this.handleStickerStore=()=>{const e=(0,c.jsx)(d.default,{onStickerPackDetails:this.handleStickerPackDetails,onClose:this._pop,onScrollOffsetChange:this._handleScrollOffsetChange});this.push(e)},this.handleStickerPackDetails=e=>{const t=(0,c.jsx)(l.default,{stickerPack:e,onStickerClick:this.handleStickerDetails,onStickerEnter:this.handleStickerDetails,onBack:this._handleBackStickerPackDetails});this.push(t)},this.handleStickerPackDetailsById=e=>{const t=(0,c.jsx)(l.default,{stickerPackId:e,onStickerClick:this.handleStickerDetails,onStickerEnter:this.handleStickerDetails,onClose:this._end});this.push(t)},this.handleStickerDetails=(e,t)=>{const n=(0,c.jsx)(s.default,{sticker:e,stickerPack:t,onSend:this.handleStickerSend,onBack:this._pop});this.push(n)},this.handleStickerSend=e=>{this._pop(),r.Cmd.once("ui_idle",(()=>{this.props.onSticker(e,o.default.STICKER_SEND_ORIGIN_TYPE.STICKER_STORE)}))},this._pop=()=>{this.pop()},this._end=()=>{this.end(!0)},this._handleBackStickerPackDetails=()=>{this.popAndUpdate({scrollOffset:this._scrollOffset})}}componentDidMount(){const{stickerPackId:e}=this.props;e?this.handleStickerPackDetailsById(e):this.handleStickerStore()}}t.default=u},92557:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.MerchantDetailsFormFlowLoadable=void 0;var r=a(n(48926)),i=a(n(68356)),o=a(n(16866)),s=a(n(15334)),l=n(85893);const d=(0,s.default)((0,r.default)((function*(){return(yield Promise.all([n.e(8295),n.e(1702),n.e(9488),n.e(2790),n.e(275)]).then(n.bind(n,11753))).default})),"MerchantDetailsFormFlow"),c=(0,i.default)({loader:d,loading:e=>(0,l.jsx)(o.default,{error:Boolean(e.error)})});t.MerchantDetailsFormFlowLoadable=c},85905:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"ExpiredLocationDrawer",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(t,"LiveLocationDrawer",{enumerable:!0,get:function(){return r.default}});var r=a(n(11399)),i=a(n(74717))},72443:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(67294),i=n(35718),o=a(n(9996)),s=n(33262),l=n(99282),d=n(90669),c=n(85893);function u(e,t){let{layer:n,outlineLayer:a,dimension:u,removeBackground:h,scale:f,visible:p}=e;const m=(0,r.useRef)(),g=(0,r.useRef)();if((0,r.useImperativeHandle)(t,(()=>({toCanvas(){var e;const t=null===(e=g.current)||void 0===e?void 0:e.getBoundingRect(),n=m.current;if(!t||!n||t.size.isEmpty())return;const{x:a,y:r,width:o,height:s}=t;var l;null===(l=g.current)||void 0===l||l.show();const c=n.toCanvas({x:a,y:r,width:o,height:s,pixelRatio:1/f});var u;null===(u=g.current)||void 0===u||u.hide();const h=Math.max(c.width,c.height),p=Math.max(Math.ceil(d.STICKER_BORDER_WIDTH*(h/d.STICKER_DIMENSION)),2),v=(0,i.addBorder)(c,p);return(0,i.trim)(v)}}))),!n||!a)return null;const v=n.frame.getCenter();return(0,c.jsxs)(l.Group,{ref:m,visible:p,children:[(0,c.jsx)(l.Group,{x:v.x,y:v.y,offsetX:n.width/2,offsetY:n.height/2,width:n.width,height:n.height,rotation:n.rotation,scaleX:n.scale,scaleY:n.scale,children:(0,c.jsx)(o.default,{layer:n})}),(0,c.jsx)(s.Outline,{ref:g,layer:a,dimension:u})]})}var h=(0,r.forwardRef)(u);t.default=h},39239:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CanvasContext=void 0;const a={transforming:!1,dragging:!1,editing:!1},r=(0,n(67294).createContext)(a);t.CanvasContext=r},89797:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.CanvasLayer=function(e){let{layer:t,scale:n,editing:a,selected:x,editable:C,hidden:y,textBackgroundShadow:S,dimension:j,selectedGroupRef:b,transformerRef:E,stageWidth:k,stageHeight:I,onSelect:w,onDoubleClick:T,onDragStart:P,onDragEnd:M,onDragMove:L,onTransformStart:O,onTransformEnd:A}=e;const[D,R]=(0,r.useState)(!1),N=(0,r.useContext)(i.CanvasContext);let F,B,U,H;C&&x&&!a&&(B=(0,v.jsx)(p.default,{layer:t}),H=(0,v.jsx)(f.Transformer,{ref:E,anchorStroke:"blue",anchorFill:"white",anchorSize:8,anchorCornerRadius:4,borderEnabled:!1,centeredScaling:!0,enabledAnchors:["bottom-right"],resizeEnabled:!0,rotateAnchorOffset:12,rotateEnabled:!0,rotationSnaps:_,ignoreStroke:!0,rotationSnapTolerance:10,boundBoxFunc:(e,a)=>{const r=a.width/n,i=a.height/n;return t instanceof g.TextLayer&&(r<=18||i<=18)||r<=36||i<=36?e:a}},"transformer"));C&&D&&!x&&(U=(0,v.jsx)(s.default,{layer:t}));t instanceof d.ImageLayer?F=(0,v.jsx)(l.default,{layer:t}):t instanceof o.DrawLayer?t.type===o.DrawLayerType.Paint?F=(0,v.jsx)(h.default,{layer:t}):t.type===o.DrawLayerType.Outline&&(F=(0,v.jsx)(u.Outline,{layer:t,dimension:j})):t instanceof g.TextLayer&&!a&&(F=(0,v.jsx)(m.default,{layer:t,shadow:S}));y&&(F=(0,v.jsx)(f.Rect,{width:t.width,height:t.height}));(0,r.useEffect)((()=>{a&&R(!1)}),[a,R]);const G=t.frame.getCenter();return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsxs)(f.Group,{ref:x?b:null,x:G.x,y:G.y,offsetX:t.width/2,offsetY:t.height/2,width:t.width,height:t.height,rotation:t.rotation,scaleX:t.scale,scaleY:t.scale,draggable:C,dragBoundFunc:e=>{let{x:t,y:n}=e;return t<0?t=0:t>k&&(t=k),n<0?n=0:n>I&&(n=I),{x:t,y:n}},onMouseEnter:e=>{!t.editable||N.dragging||N.transforming||(e.cancelBubble=!0,R(!0))},onMouseLeave:e=>{t.editable&&(e.cancelBubble=!0,R(!1))},onMouseDown:e=>{t.editable&&(e.cancelBubble=!0,w(t))},onDblClick:()=>T(t),onDragStart:()=>P(t),onDragEnd:e=>{const n=(0,c.getPointFromGroup)(e);M(t,n)},onDragMove:e=>L(t,e),onTransformStart:()=>O(t),onTransformEnd:e=>{if(!x)return;const n=(0,c.getRotationFromGroup)(e),a=(0,c.getScaleFromGroup)(e);A(t,n,a)},children:[F,B,U]}),H]})};var r=n(67294),i=n(39239),o=n(50833),s=a(n(67101)),l=a(n(9996)),d=n(39989),c=n(91788),u=n(33262),h=a(n(9226)),f=n(99282),p=a(n(74554)),m=a(n(63933)),g=n(81829),v=n(85893);const _=[0,45,90,135,180,225,270,315]},6067:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.EditableText=void 0;var r=a(n(81109)),i=a(n(18446)),o=n(48360),s=n(67294),l=n(60811),d=a(n(52144)),c=a(n(18888)),u=n(30424),h=n(39581),f=a(n(23217)),p=n(51234),m=n(18644),g=a(n(24717)),v=a(n(33743)),_=a(n(41502)),x=a(n(60265)),C=n(85893);const y=(0,c.default)(),S=(0,s.forwardRef)(((e,t)=>{let{text:n,layer:a,layerCenter:c,scale:p,onSave:S,onUnselect:E,onOutsideClick:k}=e;const[I,w]=(0,s.useState)(n),[T,P]=(0,s.useState)(),M=(0,s.useRef)(),L=(0,s.useCallback)((()=>{S(I.replace(/^\n+/,"").replace(/\n+$/,""))}),[S,I]);(0,s.useImperativeHandle)(t,(()=>({save:()=>{L(),E()}})),[L,E]);const O=(0,v.default)((e=>{T||!1===(null==k?void 0:k(e))||(L(),E())})),A=e=>{const t=M.current;t&&t.replaceSelection(e)},D=()=>{P(null)},[R,N]=(0,x.default)((e=>{P({menu:(0,C.jsx)(u.EmojiPanel,{onEmoji:A,onFocusNext:D,onFocusPrev:D}),anchor:e.target})}));(0,s.useEffect)((()=>{var e,t;null===(e=M.current)||void 0===e||null===(t=e.refInput)||void 0===t||t.focus()}),[]);const F=Math.max(a.scale*p,1.2),B={borderWidth:2/F,padding:a.styles.layerPadding-2,transform:`scale(${F})`},U={left:c.x*p,top:c.y*p},H={color:a.textColor.toHex(),fontFamily:(0,h.getFontStyle)(a.font).fontFamily,fontSize:a.fontSize,lineHeight:`${a.lineHeight+2*a.styles.lineVerticalPadding}px`,textAlign:j(a.alignment),paddingLeft:a.styles.lineHorizontalPadding+1,paddingRight:a.styles.lineHorizontalPadding+1,paddingTop:1,paddingBottom:1,borderWidth:0,borderRadius:6,margin:0,boxSizing:"border-box",backgroundColor:a.textBackground?a.textBackgroundColor.toHex():void 0},G=a.styles.backgroundShadow,W={boxShadow:a.textBackground?`${G.offsetX}px ${G.offsetY}px ${G.radius}px ${G.spread}px ${G.color.toRgbaString()}`:void 0},V=function(e){const t=(0,_.default)(e),n=(0,s.useRef)(0);t&&!(0,i.default)(t,e)&&(n.current+=1);return n.current}(H),z=(0,r.default)((0,r.default)({},H),{},{fontSize:15,paddingRight:8,fontFamily:void 0}),q=20-a.fontSize,K=a.styles.lineVerticalPadding-q,Y=`\n    .${d.default.inputContainer} .emoji.emoji.emoji {\n      margin: ${K}px ${-q/2}px 0 ${-q/2}px;\n      transform: scale(${a.fontSize/20});\n    }\n  `;return(0,C.jsxs)("div",{className:d.default.positioner,style:U,children:[(0,C.jsxs)("div",{className:d.default.container,style:B,children:[(0,C.jsx)("style",{children:Y}),(0,C.jsxs)("div",{className:d.default.resizableInput,ref:O,children:[(0,C.jsx)("div",(0,r.default)((0,r.default)({className:d.default.emojiButton},N),{},{ref:R,style:{transform:`scale(${1/F}) translateX(-${50*F}%)`,top:28*(1-1/F)/2-40},children:(0,C.jsx)("div",{className:d.default.buttonIconWrapper,children:(0,C.jsx)(f.default,{name:"smiley"})})})),(0,C.jsx)("div",{className:d.default.inputContainer,style:W,children:(0,C.jsx)(y,{style:H,ref:M,initialValue:I,onChange:e=>{let t=e;t=e.match(/\n\n$/)?t.replace(/\n\n$/,"\n"):t.replace(/\n$/,""),w(t)},onEnter:L,multiline:!0,theme:"media-editor-text-input",placeholder:o.fbt._("Type something",null,{hk:"15NglL"})},V)}),(0,C.jsx)(b,{layer:a,text:I||o.fbt._("Type something",null,{hk:"15NglL"}).toString(),style:I?H:z})]})]}),T&&(0,C.jsx)(m.UIE,{displayName:"EmojiPicker",escapable:!0,popable:!0,requestDismiss:D,children:(0,C.jsx)(g.default,{contextMenu:(0,r.default)({dirY:l.DirY.TOP,type:"emoji_picker"},T)})})]})}));function j(e){switch(e){case h.TextAlignment.LEFT:return"left";case h.TextAlignment.CENTER:return"center";case h.TextAlignment.RIGHT:return"right"}}function b(e){let{text:t,style:n,layer:a}=e;return(0,C.jsx)("div",{className:d.default.hiddenText,style:n,children:(0,p.getLines)(t,a.font,a.fontSize,0).map(((e,t)=>(0,C.jsx)("div",{className:d.default.hiddenTextLine,children:0===e.words.length?" ":e.words.map(((e,t)=>e.emojiPath?(0,C.jsx)("span",{className:d.default.emojiPlaceholder},t):e.text))},t)))})}t.EditableText=S},67101:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){let{layer:t}=e;const n=t instanceof r.ImageLayer&&(t.isSticker()||t.isBackground());return(0,o.jsx)(i.Rect,{width:t.width,height:t.height,stroke:s.toRgbaString(),strokeWidth:2,cornerRadius:n?40:5,strokeScaleEnabled:!1})};var a=n(16241),r=n(39989),i=n(99282),o=n(85893);const s=new a.Color(82,248,24,1)},9996:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{layer:t}=e;return(0,r.jsx)(a.Image,{width:t.width,height:t.height,image:t.image})};var a=n(99282),r=n(85893)},35344:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(n(81109)),i=a(n(18446)),o=n(67294),s=a(n(72443)),l=n(39239),d=n(89797),c=n(16241),u=n(6067),h=n(91788),f=a(n(88564)),p=a(n(60541)),m=n(99282),g=n(81829),v=n(54274),_=a(n(71328)),x=n(85893);const C="#52F818";function y(e,t){var n;const{inPaintMode:a=!1,inOutlineMode:y=!1,paintColor:S=c.Color.White,paintThickness:j=v.THICKNESS.MEDIUM,outlineSmoothing:b=!0,canEditLayer:E=!0,canEditBackground:k=!1,outlineEnabled:I=!1,currentlyEditingTextLayer:w=null,draftTextLayer:T=null,onLayerSelect:P=(()=>{}),onLayerUnselect:M=(()=>{}),onLayerTranslate:L=(()=>{}),onLayerTransform:O=(()=>{}),onTextEditingStart:A=(()=>{}),onTextEditingEnd:D=(()=>{}),onTextInputOutsideClick:R=(()=>!0),onPaintDrawEnd:N=(()=>{}),onOutlineDrawEnd:F=(()=>{}),onOutlineDone:B=(()=>{}),scale:U,data:H}=e,G=(0,o.useRef)(null),W=(0,o.useRef)(null),V=(0,o.useRef)(null),z=(0,o.useRef)(null),q=(0,o.useRef)(null),K=(0,o.useRef)(null),Y=(0,o.useRef)(null),Q=(0,o.useRef)(null),X=(0,o.useRef)(null),Z=(0,o.useRef)({dragging:!1,transforming:!1,editing:!1}),[J,$]=(0,o.useState)({horizontal:null,vertical:null}),[ee,te]=(0,o.useState)(!1),[ne,ae]=(0,o.useState)(!1),[re,ie]=(0,o.useState)("crosshair"),oe=()=>{Z.current.dragging=!0,te(!0)},se=(e,t)=>{Z.current.dragging=!1,L(e,t),$({vertical:null,horizontal:null}),te(!1)},le=()=>{Z.current.transforming=!0,ae(!0)},de=(e,t,n)=>{Z.current.transforming=!1,O(e,t,n),ae(!1)},ce=()=>{if(!G.current)throw new Error("MediaEditorCanvas:stage is not initialized");return G.current.getStage()},ue=(e,t)=>{var n,a,r,o;const s=[{position:ce().width()/2,orientation:"v"},{position:ce().height()/2,orientation:"h"}],l=t.target,d=l.absolutePosition(),c=[{position:d.y,orientation:"h"},{position:d.x,orientation:"v"}],u=[];for(const e of c)for(const t of s){if(e.orientation!==t.orientation)continue;const n=Math.abs(t.position-e.position);n<=15&&u.push({guide:t,distance:n})}u.sort(((e,t)=>e.distance-t.distance));let h=null,f=null;for(const{guide:e}of u)"v"!==e.orientation||h?"h"!==e.orientation||f||(f=e):h=e;l.absolutePosition({x:null!==(n=null===(a=h)||void 0===a?void 0:a.position)&&void 0!==n?n:d.x,y:null!==(r=null===(o=f)||void 0===o?void 0:o.position)&&void 0!==r?r:d.y});const p={horizontal:f,vertical:h};(0,i.default)(J,p)||$(p)},he=e=>{e instanceof g.TextLayer&&A(e)},fe=e=>{T&&D(T,e)},pe=e=>{P(e)},me=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{hidden:n=!1}=t,r=H.selectedLayer===e&&w!==e,i=H.screenWidth*U,o=H.screenHeight*U,s=H.cropSize.dimension,l=e.editable&&E&&!a&&!y&&!w;return(0,x.jsx)(d.CanvasLayer,{layer:e,scale:U,textBackgroundShadow:!ee,dimension:s,editing:w===e,selected:r,editable:l,stageHeight:o,stageWidth:i,selectedGroupRef:e=>{W.current=e},transformerRef:e=>{V.current=e},onSelect:pe,onDoubleClick:he,onDragMove:ue,onDragStart:oe,onDragEnd:se,onTransformStart:le,onTransformEnd:de,hidden:n},String(e.id))};(0,o.useEffect)((()=>{var e,t,n;W.current&&(null===(e=V.current)||void 0===e||e.nodes([W.current]),null===(t=V.current)||void 0===t||null===(n=t.getLayer())||void 0===n||n.batchDraw())}));const ge=()=>{var e,t,n,a,r,i,o,s,l,d,c;null===(e=V.current)||void 0===e||e.hide(),null===(t=W.current)||void 0===t||null===(n=t.getChildren()[1])||void 0===n||n.hide(),null===(a=W.current)||void 0===a||null===(r=a.getChildren()[2])||void 0===r||r.hide(),null===(i=z.current)||void 0===i||i.hide(),null===(o=K.current)||void 0===o||o.toggleCursor(!1),null===(s=Y.current)||void 0===s||s.hide(),null===(l=V.current)||void 0===l||null===(d=l.getLayer())||void 0===d||d.batchDraw(),null===(c=q.current)||void 0===c||c.hide();const u=ce().toDataURL({mimetype:"image/png",quality:1,pixelRatio:1/U});var h,f,p,m,g,v,_,x,C,y,S;return null===(h=V.current)||void 0===h||h.show(),null===(f=W.current)||void 0===f||null===(p=f.getChildren()[1])||void 0===p||p.show(),null===(m=W.current)||void 0===m||null===(g=m.getChildren()[2])||void 0===g||g.show(),null===(v=z.current)||void 0===v||v.show(),null===(_=K.current)||void 0===_||_.toggleCursor(!0),null===(x=Y.current)||void 0===x||x.show(),null===(C=V.current)||void 0===C||null===(y=C.getLayer())||void 0===y||y.batchDraw(),null===(S=q.current)||void 0===S||S.show(),u},ve=()=>{var e;return null===(e=X.current)||void 0===e?void 0:e.toCanvas()},_e=()=>{var e;null===(e=Q.current)||void 0===e||e.save()},xe=()=>(ee||ne)&&H.selectedLayer===H.background;(0,o.useImperativeHandle)(t,(()=>({getStage:ce,getDataUrl:ge,endTextEditing:_e,getBackground:ve})));const Ce=H.screenWidth/2,ye=H.screenHeight/2,Se=H.toScreenPoint(H.cropCenter),je=H.toScreenPoint(H.canvasCenter),be=Ce-(Se.x-je.x),Ee=ye-(Se.y-je.y),ke=H.cropSize.dimension;return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(m.Stage,{ref:G,width:H.screenWidth*U,height:H.screenHeight*U,onMouseDown:e=>{w||(0,h.isEventOnAnchor)(e)||M()},scaleX:U,scaleY:U,style:(0,r.default)({cursor:a?"none":y?re:"default"},null!==(n=e.style)&&void 0!==n?n:{}),children:(0,x.jsxs)(l.CanvasContext.Provider,{value:Z.current,children:[I&&(0,x.jsx)(m.Layer,{x:be,y:Ee,offsetX:H.width/2,offsetY:H.height/2,rotation:H.rotation,children:(0,x.jsx)(_.default,{ref:q,width:H.width,height:H.height})},"transparent"),(0,x.jsx)(m.Layer,{x:be,y:Ee,offsetX:H.width/2,offsetY:H.height/2,rotation:H.rotation,children:(0,x.jsx)(s.default,{ref:X,layer:H.background,outlineLayer:H.outlineLayer,dimension:ke,removeBackground:I&&!y,scale:U,visible:!xe()})},"background"),(0,x.jsx)(m.Layer,{x:be,y:Ee,offsetX:H.width/2,offsetY:H.height/2,rotation:H.rotation,children:(()=>{const e=[];if(H.paintLayer&&!Z.current.dragging){const t=me(H.paintLayer);e.push(t)}if(k&&H.background){const t=me(H.background,{hidden:!xe()});e.push(t)}if(H.paintLayer&&Z.current.dragging){const t=me(H.paintLayer);e.push(t)}return e.push(...H.layers.map((e=>me(e)))),e})()},"edits"),(()=>{const{vertical:e,horizontal:t}=J;if(!e&&!t)return null;const n=ce();return(0,x.jsxs)(m.Layer,{ref:z,children:[e&&(0,x.jsx)(m.Line,{x:e.position/U,y:0,points:[0,0,0,n.height()/U],stroke:C,strokeWidth:1,strokeScaleEnabled:!1},"vertical"),t&&(0,x.jsx)(m.Line,{x:0,y:t.position/U,points:[0,0,n.width()/U,0],stroke:C,strokeWidth:1,strokeScaleEnabled:!1},"horizontal")]},"guides")})(),a&&(0,x.jsx)(p.default,{ref:K,width:H.screenWidth,height:H.screenHeight,scale:U,pathStyle:{color:S,thickness:(0,v.getThicknessValue)(j),smoothing:!1},data:H,onDrawEnd:N}),y&&(0,x.jsx)(f.default,{ref:Y,width:H.screenWidth,height:H.screenHeight,scale:U,data:H,smoothing:b,onDrawEnd:F,onDone:B,onCursorChange:e=>{ie(e)}})]})}),(()=>{if(!T)return null;const e=H.toScreenPoint(T.frame.getCenter());return(0,x.jsx)(u.EditableText,{ref:Q,layer:T,layerCenter:e,text:T.text,scale:U,onSave:fe,onUnselect:M,onOutsideClick:R})})()]})}var S=(0,o.forwardRef)(y);t.default=S},33262:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.Outline=void 0;var r=a(n(94654)),i=a(n(64369)),o=n(67294),s=n(99282),l=a(n(24055)),d=n(85893);function c(e,t){let{layer:n,dimension:a}=e;const c=(0,o.useRef)(),u=(0,o.useRef)();(0,o.useImperativeHandle)(t,(()=>({show(){var e;null===(e=c.current)||void 0===e||e.show()},hide(){var e;null===(e=c.current)||void 0===e||e.hide()},getBoundingRect(){const e=u.current;if(!e)return;const{x:t,y:a,width:r,height:i}=e.getClientRect();return l.default.create({x:t,y:a,width:r,height:i,rotation:n.rotation,scale:n.scale})}})));const h=(0,r.default)(n.getAllPoints(),(e=>[e.x,e.y]));return(0,d.jsx)(s.Group,{ref:c,width:n.width,height:n.height,visible:!1,children:(0,d.jsx)(s.Line,{ref:u,points:h,closed:!0,fill:"white",lineCap:"round",lineJoin:"round",tension:i.default.MEDIA_EDITOR_OUTLINE_TENSION,globalCompositeOperation:"destination-in"})})}const u=(0,o.forwardRef)(c);t.Outline=u},88564:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(n(81109)),i=a(n(94654)),o=a(n(64369)),s=n(67294),l=n(16241),d=(n(7293),n(99282)),c=a(n(85313)),u=n(85893);const h="dot-first",f="dot-last";function p(e,t){var n;let{width:a,height:p,scale:m,data:v,smoothing:_,onDrawEnd:x,onDone:C,onCursorChange:y}=e;const S=(0,s.useRef)(),j=(0,s.useRef)(!1),b=(0,s.useRef)("crosshair");(0,s.useEffect)((()=>{y("crosshair")}),[]),(0,s.useImperativeHandle)(t,(()=>({show(){var e;null===(e=S.current)||void 0===e||e.show()},hide(){var e;null===(e=S.current)||void 0===e||e.hide()}})));const{cursorPosition:E,points:k,handlers:I}=(0,c.default)({onDrawStart:()=>{j.current=!0},onDrawEnd:e=>{j.current=!1,x(e)},onDone:C,onMouseMove:e=>{const t=e.target.name()===h,n=j.current,a=t&&!n?"pointer":"crosshair";a!==b.current&&(b.current=a,y(a))},data:v,stage:null===(n=S.current)||void 0===n?void 0:n.getStage(),minPointDistance:12/m,clickThreshold:200,boundToStage:!0,doneTargets:{mousedown:[h,f],mouseup:[h]},pathStyle:{color:l.Color.White,thickness:0,smoothing:_}}),w=v.outlineLayer.getAllPoints().map((e=>v.toScreenPoint(e)));!_&&w.length&&w.push(w[w.length-1]);Boolean(k.length)&&w.push(k[0]),w.push(...k);const T=[...w];!_&&T.length&&T.push(T[T.length-1]),E&&T.push(E);const P=(0,i.default)(T,(e=>[e.x,e.y]));return(0,u.jsxs)(d.Layer,(0,r.default)((0,r.default)({ref:S},I),{},{width:a,height:p,children:[(0,u.jsx)(d.Rect,{x:0,y:0,width:a,height:p,fill:"rgba(0,0,0,0)"}),(0,u.jsx)(d.Line,{points:P,lineCap:"round",lineJoin:"round",stroke:"#FA6533",strokeWidth:3/m,dash:[12/m,6/m],tension:o.default.MEDIA_EDITOR_OUTLINE_TENSION}),(0,u.jsx)(g,{points:w,scale:m})]}),"paintCursor")}var m=(0,s.forwardRef)(p);function g(e){let{points:t,scale:n}=e;if(!t.length)return null;const a=t[0],r=t[t.length-1],i=3/n;return(0,u.jsxs)(u.Fragment,{children:[undefined,(0,u.jsx)(d.Circle,{name:f,x:r.x,y:r.y,radius:i}),(0,u.jsx)(d.Circle,{x:a.x,y:a.y,radius:i,stroke:"white"}),(0,u.jsx)(d.Circle,{name:h,x:a.x,y:a.y,radius:4*i})]})}t.default=m},9226:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){let{layer:t}=e;const n=(0,a.useMemo)((()=>{const e=document.createElement("canvas");return e.width=Math.max(t.width,1),e.height=Math.max(t.height,1),e}),[t.width,t.height]),o=(0,a.useRef)();return(0,a.useEffect)((()=>{var e,a;n.getContext("2d").clearRect(0,0,n.width,n.height),t.paths.forEach((e=>function(e,t){const{points:n}=t;if(!n.length)return;const a=e.getContext("2d"),r={color:t.color,thickness:t.thickness,smoothing:!1};(function(e,t){e.lineCap="round",e.lineJoin="round",e.lineWidth=t.thickness,e.strokeStyle=t.color.toHex()})(a,r),a.beginPath(),a.moveTo(n[0].x,n[0].y),n.forEach((e=>a.lineTo(e.x,e.y))),a.stroke()}(n,e))),null===(e=o.current)||void 0===e||null===(a=e.getLayer())||void 0===a||a.batchDraw()}),[t.paths,n]),(0,i.jsx)(r.Image,{ref:o,width:t.width,height:t.height,image:n})};var a=n(67294),r=n(99282),i=n(85893)},60541:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(n(81109)),i=a(n(94654)),o=n(67294),s=n(99282),l=a(n(85313)),d=n(85893);const c=(e,t)=>{var n;let{width:a,height:c,scale:u,pathStyle:h,data:f,onDrawEnd:p}=e;const m=(0,o.useRef)(),g=(0,o.useRef)();(0,o.useImperativeHandle)(t,(()=>({toggleCursor(e){const t=g.current;t&&(e?t.show():t.hide())}})));const{cursorPosition:v,points:_,handlers:x}=(0,l.default)({onDrawEnd:p,data:f,pathStyle:h,stage:null===(n=m.current)||void 0===n?void 0:n.getStage()}),C=(0,i.default)(_,(e=>[e.x,e.y]));return(0,d.jsxs)(s.Layer,(0,r.default)((0,r.default)({ref:m},x),{},{width:a,height:c,children:[(0,d.jsx)(s.Rect,{width:a,height:c,fill:"rgba(0, 0, 0, 0)"}),v&&(0,d.jsx)(s.Circle,{ref:g,x:v.x,y:v.y,radius:h.thickness/2,fill:h.color.toRgbaString()}),(0,d.jsx)(s.Line,{points:C,lineCap:"round",lineJoin:"round",stroke:h.color.toRgbaString(),strokeWidth:h.thickness})]}),"paintCursor")};var u=(0,o.forwardRef)(c);t.default=u},74554:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){let{layer:t}=e;const n=t instanceof r.ImageLayer&&(t.isSticker()||t.isBackground());return(0,o.jsx)(o.Fragment,{children:(0,o.jsx)(i.Rect,{width:t.width,height:t.height,fill:l.toRgbaString(),stroke:s.toRgbaString(),strokeWidth:2,cornerRadius:n?40:5,strokeScaleEnabled:!1})})};var a=n(16241),r=n(39989),i=n(99282),o=n(85893);const s=new a.Color(82,248,24,1),l=new a.Color(82,248,24,.1)},63933:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){let{layer:t,shadow:n}=e;const l=function(e){const t=[];for(const n of e)for(const{emojiPath:e}of n.words)e&&t.push(e);return function(e){const t=Array.from(new Set(e)),n=t.join(""),r=(0,a.useRef)({}),[,i]=(0,a.useState)(0);return(0,a.useEffect)((()=>{r.current={},i(0),t.forEach((e=>{const t=new Image;t.onload=()=>{r.current[e]=t,i(Object.keys(r.current).length)},t.src=e}))}),[i,n]),r.current}(t)}(t.lines),d=e=>{const n=Math.max(...t.lineWidths);let a=0;switch(t.alignment){case r.TextAlignment.LEFT:a=0;break;case r.TextAlignment.CENTER:a=(n-e.width)/2;break;case r.TextAlignment.RIGHT:a=n-e.width}let d=0;return e.words.map(((e,n)=>{let{text:c,emojiPath:u,width:h}=e;const f=a+t.styles.lineHorizontalPadding+d,p=t.styles.lineVerticalPadding;let m;if(u){const e=l[u];m=e?(0,s.jsx)(i.Image,{x:f,y:p,width:t.lineHeight,height:t.lineHeight,image:e},n):(0,s.jsx)(i.Rect,{x:f,y:p,width:t.lineHeight,height:t.lineHeight,fill:"rgba(0,0,0,0)"},n)}else{const e=(0,o.getTextBounds)(t.font,t.fontSize);m=(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(i.Text,{x:f,y:p-e.top+(e.top+e.bottom)/2,width:h,height:t.lineHeight,text:c,fill:t.textColor.toHex(),fontFamily:(0,r.getFontStyle)(t.font).fontFamily,fontSize:t.fontSize},n)})}return d+=h,m}))},c=t.lines.map(((e,n)=>{const a=e.width+2*t.styles.lineHorizontalPadding,r=t.lineHeight+2*t.styles.lineVerticalPadding;return(0,s.jsx)(i.Group,{width:a,height:r,y:n*r,children:d(e)},n)})),{backgroundShadow:u}=t.styles;return(0,s.jsx)(i.Group,{visible:0!==t.width,width:t.width,height:t.height,children:(0,s.jsxs)(i.Group,{x:t.styles.layerPadding,y:t.styles.layerPadding,children:[t.textBackground&&(n?(0,s.jsx)(i.Path,{data:t.backgroundPath,stroke:t.textBackgroundColor.toHex(),fill:t.textBackgroundColor.toHex(),shadowColor:u.color.toHex(),shadowBlur:u.radius,shadowOffset:{x:u.offsetX,y:u.offsetY},shadowOpacity:u.color.alpha},"1"):(0,s.jsx)(i.Path,{data:t.backgroundPath,stroke:t.textBackgroundColor.toHex(),fill:t.textBackgroundColor.toHex()},"2")),c]})})};var a=n(67294),r=n(39581),i=n(99282),o=n(51234),s=n(85893)},71328:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n(67294),r=n(16241),i=n(99282),o=n(85893);const s=new r.Color(230,230,230).toRgbString(),l=new r.Color(255,255,255).toRgbString();function d(e,t){let{width:n,height:r}=e;const d=(0,a.useRef)();(0,a.useImperativeHandle)(t,(()=>({hide(){var e;null===(e=d.current)||void 0===e||e.hide()},show(){var e;null===(e=d.current)||void 0===e||e.show()}})));const c=(0,a.useMemo)((()=>{const e=document.createElement("canvas");return e.width=Math.max(n,1),e.height=Math.max(r,1),e}),[n,r]);return(0,a.useEffect)((()=>{var e,t;const a=c.getContext("2d");a.clearRect(0,0,c.width,c.height);const i=20,o=Math.ceil(n/i),u=Math.ceil(r/i);for(let e=0;e<u;e++)for(let t=0;t<o;t++){const n=(e+t)%2==0?l:s;a.beginPath(),a.rect(t*i,e*i,i,i),a.fillStyle=n,a.fill()}null===(e=d.current)||void 0===e||null===(t=e.getLayer())||void 0===t||t.batchDraw()}),[c,n,r]),(0,o.jsx)(i.Image,{ref:d,width:n,height:r,image:c})}var c=(0,a.forwardRef)(d);t.default=c},85313:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){let{onDrawStart:t,onDrawEnd:n,onDone:a,onMouseMove:c,data:u,endOnMouseLeave:h=!0,minPointDistance:f=0,clickThreshold:p=0,boundToStage:m=!1,pathStyle:g={},stage:v,doneTargets:_={}}=e;const[x,C]=(0,i.useState)(),y=(0,i.useRef)([]),S=(0,i.useRef)(!1),j=(0,s.default)(),b=(0,l.default)(p),E=(0,i.useRef)(!1);return(0,d.useListener)(window,"mouseup",(()=>{if(S.current=!1,0!==y.current.length){const e=y.current.map((e=>u.toCanvasPoint(e)));n((0,r.default)({points:e},g)),y.current=[],j()}})),(0,d.useListener)(window,"mousemove",(e=>{const t=(0,o.getPointFromStage)(e,v,m),n=m&&S.current;if(C(n?(0,o.getPointFromStage)(e,v,!0):t),S.current){const e=y.current,n=e[e.length-1];(!n||n.distance(t)>=f&&b()||(0,o.isStageCorner)(t,v))&&e.push(t)}})),(0,i.useEffect)((()=>{E.current&&(null==a||a(),E.current=!1)})),{cursorPosition:x,points:y.current,handlers:{onMouseDown:e=>{var n;if(null==t||t(),null===(n=_.mousedown)||void 0===n?void 0:n.includes(e.target.name()))return void(null==a||a());const r=(0,o.getPointFromStage)(e.evt,v,m);y.current.push(r),S.current=!0,j()},onMouseUp:e=>{var t;const n=null===(t=_.mouseup)||void 0===t?void 0:t.includes(e.target.name()),a=1===y.current.length;n&&!a&&(E.current=!0)},onMouseMove:e=>{null==c||c(e)}}}};var r=a(n(81109)),i=n(67294),o=n(91788),s=a(n(59909)),l=a(n(28768)),d=n(19529)},69613:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{caption:t,setCaptionInputRef:n,onEnter:a}=e,S=(0,l.useRef)(null),j=(0,l.useRef)(null),[b,E]=(0,l.useState)(null),k=()=>{var e;null===(e=S.current)||void 0===e||e.focus()};(0,l.useEffect)((()=>{k()}),[]);const I=()=>{E(null)},w=e=>{const t=S.current;t&&(t.focus(!1),t.replaceSelection(e))},T=(0,r.numCodepoints)(e.caption||""),P=i.default.MAX_CAPTION_LENGTH-T<50,M=(0,y.jsx)("div",{role:"button",className:f.default.inputEmoji,onClick:e=>{e.preventDefault(),e.stopPropagation();const t=(0,y.jsx)(u.EmojiPanel,{onEmoji:w,onFocusNext:k,onFocusPrev:k});E({menu:t,dirY:c.DirY.TOP,type:"emoji_picker",anchor:e.target}),k()},children:(0,y.jsx)(_.default,{name:"emoji-input"})}),L=t&&""!==t?(0,y.jsx)("div",{role:"button",className:f.default.clearBtn,onClick:()=>{var e;null===(e=S.current)||void 0===e||e.reset(),k()},children:(0,y.jsx)(_.default,{name:"x-alt"})}):null,O=P&&(0,y.jsx)("div",{className:f.default.charCounter,children:p.default.n(i.default.MAX_CAPTION_LENGTH-T)});let A,D=null;b&&(D=(0,y.jsx)(x.UIE,{displayName:"EmojiPicker",escapable:!0,popable:!0,ref:j,requestDismiss:I,children:(0,y.jsx)(C.default,{contextMenu:b})}));g.ServerProps.viewOnceWrite&&(A=(0,y.jsx)("div",{className:f.default.secondaryButtonContainer,children:(0,y.jsx)(d.default,{disabled:e.viewOnceDisabled,isOn:Boolean(e.viewOnce),mediaType:e.msgType,onChange:e.onToggleViewOnce,noMargin:!0})}));return(0,y.jsxs)(h.FlexRow,{className:(0,o.default)(f.default.container,{[f.default.videoCaption]:"video"===e.theme}),align:"center",justify:"center",children:[(0,y.jsx)("div",{className:f.default.suggestionsPositioner,children:(0,y.jsxs)("div",{className:f.default.suggestionsContainer,children:[(0,y.jsx)(m.default.MentionSuggestions,{chat:e.chat,theme:v.ThemeOptions.MEDIA_CAPTION}),(0,y.jsx)(m.default.EmojiSuggestions,{chat:e.chat,theme:v.ThemeOptions.MEDIA_CAPTION})]})}),(0,y.jsxs)(h.FlexRow,{align:"start",className:f.default.inputContainer,children:[(0,y.jsx)(m.default,{ref:e=>{S.current=e,n(e)},initialValue:t,placeholder:s.fbt._("Type a message",null,{hk:"3h5KZB"}),onChange:e.onChange,onEnter:e=>{var t;(null===(t=S.current)||void 0===t?void 0:t.isFocused())&&a(e)},onFiles:e.onFiles,theme:"media-caption",maxLength:i.default.MAX_CAPTION_LENGTH,multiline:!0,spellCheck:!0}),(0,y.jsxs)(h.FlexRow,{className:f.default.buttonContainer,align:"center",children:[O,L,M]})]}),A,D]})};var r=n(64331),i=a(n(64369)),o=a(n(94184)),s=n(48360),l=n(67294),d=a(n(75680)),c=n(60811),u=n(30424),h=n(29623),f=a(n(50907)),p=a(n(43725)),m=a(n(43698)),g=n(64551),v=n(16477),_=a(n(23217)),x=n(18644),C=a(n(24717)),y=n(85893)},54274:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.THICKNESS=void 0,t.getAllThicknesses=function(){return Object.keys(n)},t.getThicknessValue=function(e){return a[e]};const n=Object.freeze({SMALL:"SMALL",MEDIUM:"MEDIUM",LARGE:"LARGE",XLARGE:"XLARGE"});t.THICKNESS=n;const a={[n.SMALL]:8,[n.MEDIUM]:12,[n.LARGE]:18,[n.XLARGE]:24}},77890:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{attachMedia:t,onClick:n,onClose:a,forwardRef:r,id:i}=e;return(0,f.jsxs)("div",{className:(0,o.default)(s.default.thumb,{[s.default.active]:e.active}),onClick:e=>{n((0,c.unproxy)(t),e)},tabIndex:"-1",ref:e=>{r(i,e)},children:[(0,f.jsx)("div",{className:s.default.btnDelete,onClick:e=>{a((0,c.unproxy)(t),e)},role:"button",children:(0,f.jsx)(u.default,{name:"x-alt"})}),(0,f.jsx)("div",{className:s.default.bodyWrapper,children:(0,f.jsx)(v,{attachMedia:t})})]})};var r=a(n(35937)),i=n(15461),o=a(n(94184)),s=a(n(30635)),l=a(n(43725)),d=n(43257),c=n(31019),u=a(n(23217)),h=n(49082),f=n(85893);const{IMAGE:p,VIDEO:m}=i.MSG_TYPE,g=(0,r.default)(d.MIMETYPES,(e=>"document"===(null==e?void 0:e.msgType)));function v(e){const t=(0,h.useModelValues)(e.attachMedia,["mimetype","preview","type","fullPreview","fullPreviewSize","documentPageCount"]);let n;if(t.type===p)n=t.preview;else if(t.type===m)n=`data:image/jpeg;base64,${t.preview}`;else if("pdf"===(0,d.previewType)(t.mimetype)){t.fullPreview&&t.fullPreviewSize&&null!=t.documentPageCount&&t.documentPageCount>0&&(n=t.fullPreview)}if(n)return(0,f.jsx)("div",{className:s.default.body,children:(0,f.jsx)("img",{src:n,alt:l.default.t(986)})});const a=(0,o.default)(s.default.body,s.default.bodyIcon,g[t.mimetype]?g[t.mimetype].icon:"icon-doc-generic");return(0,f.jsx)("div",{className:a})}},63727:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(15461),i=n(67294),o=n(99420),s=a(n(77890)),l=n(85893);const d=(0,o.SortableElement)((e=>{let{children:t}=e;return t})),c=(0,o.SortableContainer)((e=>{let{children:t}=e;return t}));class u extends i.Component{constructor(e){super(e),this._handleSortEnd=e=>{let{oldIndex:t,newIndex:n}=e;const{mediaCollection:a}=this.props,r=a.reorder(t,n);this.setState({medias:r})},this.state={medias:this.props.mediaCollection.getPreviewableMedias()}}static getDerivedStateFromProps(e){return{medias:e.mediaCollection.getPreviewableMedias()}}render(){const{mediaCollection:e,className:t,forwardRef:n}=this.props,a=this.state.medias;return(0,l.jsx)(c,{onSortEnd:this._handleSortEnd,axis:"x",helperClass:"SortableHelper",distance:10,children:(0,l.jsx)("div",{className:t,children:a.map(((t,a)=>{var i;return(0,l.jsx)(d,{index:a,children:(0,l.jsx)(s.default,{id:t.id,attachMedia:t,active:t===e.getActive(),previewMode:(null===(i=e.getActive())||void 0===i?void 0:i.type)!==r.MSG_TYPE.IMAGE,onClick:this.props.onClick,onClose:this.props.onClose,forwardRef:n})},t.id)}))})})}}t.default=u,u.displayName="DragAndDrop"},6327:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.ImageBody=void 0;var r=n(15461),i=a(n(94184)),o=n(48360),s=n(67294),l=n(80666),d=a(n(88262)),c=a(n(35344)),u=a(n(69613)),h=a(n(66430)),f=n(92320),p=n(30383),m=a(n(13057)),g=n(29623),v=n(66747),_=n(39581),x=n(53485),C=a(n(90388)),y=n(39989),S=a(n(54277)),j=n(5807),b=a(n(16186)),E=a(n(46668)),k=n(79230),I=a(n(23217)),w=n(81829),T=a(n(77268)),P=a(n(9165)),M=n(54274),L=n(2541),O=a(n(81559)),A=n(19529),D=n(49082),R=n(85893);const N=new E.default({width:200,height:200}),F=(0,s.forwardRef)((function(e,t){const{paintColor:n,paintThickness:a,outlineSmoothing:F,onLayerDelete:B,onTextEditingStart:U,onTextEditingEnd:H,onOutlineDone:G,draftTextLayer:W,onLayerUnselect:V,onPaintSelect:z,onCropRotateCanvas:q,onOutlineSelect:K}=e,Y=(0,D.useModelValues)(e.attachMedia,["mediaEditorData","caption","id"]),Q=(0,s.useRef)(null),X=(0,s.useRef)(null),Z=(0,s.useRef)(null),J=(0,s.useRef)(null),$=(0,s.useRef)(null),ee=(0,s.useRef)(null),te=(0,s.useRef)(null),ne=(0,s.useRef)(null),[ae,re]=(0,s.useState)(E.default.empty()),[ie,oe]=(0,s.useState)(!1),[se,le]=(0,s.useState)(!1),[de,ce]=(0,s.useState)(!1),[ue,he]=(0,s.useState)(!1),[fe,pe]=(0,s.useState)(!1),[me,ge]=(0,s.useState)(!1),ve=()=>{le((e=>!e))},_e=()=>Y.mediaEditorData,xe=()=>{if(!Q.current)return;const e=Q.current.getBoundingClientRect(),t=new E.default({width:e.width-40,height:e.height-40});re(t)},Ce=()=>{!de&&_e().selectedLayer&&V(),ce((e=>!e)),xe()},ye=()=>ue,Se=()=>{he((e=>!e))},je=()=>{if(se)ve();else if(de)Ce();else if(ye())G(),Se();else{if(!Y.mediaEditorData.selectedLayer||W)return!1;V()}return!0};(0,A.useListener)(window,"mousedown",(e=>{ne.current=e.target})),(0,A.useListener)(window,"click",(()=>{const e=ne.current;e!==Q.current&&e!==Z.current&&e!==X.current||je()}));const be=()=>{const{selectedLayer:e}=Y.mediaEditorData;e&&B(e)},Ee=e=>{"Backspace"!==e.code||e.target instanceof HTMLInputElement||e.target instanceof HTMLDivElement&&"true"===e.target.contentEditable||de||be()},ke=()=>{const e=(()=>{if(!J.current)throw new Error("MediaEditor:canvas is not initialized");return J.current.getDataUrl()})();return L.URL.dataURLtoFile(e)},Ie=()=>{if(null!=J.current){const{width:e,height:t}=J.current.getStage().attrs;if(0!==e&&0!==t){const e=ke(),t=window.URL.createObjectURL(e);Y.updateEditedFile(e),Y.updatePreview(t),Y.updateFullPreview(t)}}},we=(0,O.default)((()=>{te.current&&((0,x.cancelIdleCallback)(te.current),te.current=null),te.current=(0,x.requestIdleCallback)(Ie)}),1e3),Te=e=>{(null==e?void 0:e.immediately)?Ie():we()};(0,s.useEffect)((()=>(window.addEventListener("resize",xe),window.addEventListener("keydown",Ee),xe(),()=>{window.removeEventListener("resize",xe),window.removeEventListener("keydown",Ee),Te({immediately:!0})})),[]);const Pe=()=>{if(de)Ce();else if(se)ve();else if(ue)G(),Se();else if(W){var e;null===(e=J.current)||void 0===e||e.endTextEditing()}else _e().selectedLayer&&V()},Me=e=>{q(_e().rotation+e,_e().cropOrigin,_e().cropSize)},Le=()=>{q(0,new b.default({x:0,y:0}),_e().size)},Oe=(e,t)=>{q(_e().rotation,e,t)},Ae=(e,t)=>{e===l.MediaEditorAction.OutlineDone?(je(),Se()):e===l.MediaEditorAction.Outline?(ye()&&Se(),t===l.MediaEditorAction.Outline&&Se()):e===l.MediaEditorAction.CropRotateCanvas&&(je(),t===l.MediaEditorAction.CropRotateCanvas&&Ce())},De=(e,t)=>{e===l.MediaEditorAction.OutlineDone?je():e===l.MediaEditorAction.Outline?ye()||Se():e===l.MediaEditorAction.CropRotateCanvas?(je(),Ce()):t===l.MediaEditorAction.CropRotateCanvas&&e!==l.MediaEditorAction.CropRotateCanvas&&je()},Re=()=>{const e=Y.mediaEditorData;return(0,k.calculateContainScale)(e.screenWidth,e.screenHeight,ae,N)},Ne=()=>{var e;return null===(e=J.current)||void 0===e?void 0:e.getBackground()};(0,s.useImperativeHandle)(t,(()=>({updatePreview:Te,undoAction:Ae,redoAction:De,getCanvasScale:Re,resetUIState:je,getBackground:Ne})));const Fe=Y.mediaEditorData,Be=e.draftTextLayer||Fe.selectedLayer;let Ue;if(de)Ue=(0,R.jsx)(p.CropRotateToolbar,{canReset:Fe.isRotated()||Fe.isCropped(),onRotateCanvas:Me,onReset:Le});else if(ue)Ue=(0,R.jsx)(j.OutlineToolbar,{smoothing:e.outlineSmoothing,onSmoothingToggle:e.onOutlineSmoothingToggle,canReset:Fe.isOutlined(),onReset:e.onOutlineReset});else if(Be){const t=Be instanceof y.ImageLayer&&Be.isBackground();if(Be instanceof w.TextLayer){const t=(0,f.getAllColors)().map((e=>{const t=(0,f.getColorValue)(e),n=(0,f.getColorValue)(t.isLight()?f.COLORS.BLACK:f.COLORS.WHITE);return{primaryColor:t,secondaryColor:n}}));Ue=(0,R.jsxs)(R.Fragment,{children:[(0,R.jsx)(h.default,{ref:$,colors:t,onColorSelect:e.onTextColorSelect,selectedColor:Be.textColor}),(0,R.jsx)(v.Font,{ref:ee,fonts:(0,_.getAllFonts)(),selectedFont:Be.font,selectedAlignment:Be.alignment,onFontSelect:e.onFontSelect,onAlignmentSelect:e.onAlignmentSelect}),(0,R.jsx)(T.default,{checked:Be.textBackground,onBackgroundToggle:e.onTextBackgroundToggle}),(0,R.jsx)(d.default,{icon:"delete",title:o.fbt._("Delete",null,{hk:"1XGJJN"}),onClick:be})]})}else t||(Ue=(0,R.jsx)(R.Fragment,{children:(0,R.jsx)(d.default,{icon:"delete",title:o.fbt._("Delete",null,{hk:"1XGJJN"}),onClick:be})}))}else se&&(Ue=(0,R.jsxs)(R.Fragment,{children:[(0,R.jsx)(h.default,{colors:(0,f.getAllColors)().map((e=>({primaryColor:(0,f.getColorValue)(e)}))),onColorSelect:e.onPaintColorSelect,selectedColor:n}),(0,R.jsx)(P.default,{thicknesses:(0,M.getAllThicknesses)(),onThicknessSelect:e.onPaintThicknessSelect,selectedThickness:a})]}));const He=!Ue&&!e.draftTextLayer&&!e.sendAsSticker,Ge=(0,R.jsx)(g.FlexRow,{className:(0,i.default)(C.default.captionInputContainer,{[C.default.captionInputHidden]:!He}),justify:"center",children:(0,R.jsx)(u.default,{chat:e.chat,caption:Y.caption,viewOnce:e.viewOnce,viewOnceDisabled:e.viewOnceDisabled,msgType:r.MSG_TYPE.IMAGE,theme:"image",onToggleViewOnce:e.onToggleViewOnce,onChange:e.onCaptionChange,onEnter:e.onEnter,onFiles:e.onFiles,setCaptionInputRef:t=>{e.setCaptionInputRef(Y.id,t)}},Y.id)}),We=(0,R.jsxs)(g.FlexRow,{justify:"center",align:"center",className:C.default.footer,ref:Z,children:[Ue&&(0,R.jsx)(g.FlexRow,{justify:"center",align:"center",className:C.default.bottomToolbar,children:Ue}),Ge]});let Ve=null;de&&(Ve=(0,R.jsx)(m.default,{data:Fe,rotation:_e().rotation,cropOrigin:_e().cropOrigin,cropSize:_e().cropSize,onCropChange:Oe,containerSize:ae,keepRatio:e.sendAsSticker,sendAsSticker:e.sendAsSticker}));const ze=de||se||ue||fe||me||Boolean(e.draftTextLayer)||Boolean(_e().selectedLayer);return(0,R.jsxs)("div",{className:C.default.container,children:[(0,R.jsxs)(g.FlexRow,{className:C.default.header,ref:X,children:[e.onClose?(0,R.jsx)("div",{onClick:e.onClose,className:C.default.closeButton,children:(0,R.jsx)(I.default,{name:"x"})}):(0,R.jsx)("div",{className:C.default.closeButtonPlaceholder}),(0,R.jsx)(S.default,{selectedLayer:Be,inPaintMode:se,inCropRotateMode:de,inTextEditingMode:Boolean(e.draftTextLayer),inOutlineMode:ue,canUndo:e.canUndo,canRedo:e.canRedo,onPaintSelect:()=>{ve(),z()},onCropRotateSelect:()=>{Ce()},onOutlineSelect:()=>{Se(),K()},onTextSelect:e.onTextSelect,onEmojiSelect:e.onEmojiSelect,onStickerSelect:e.onStickerSelect,onToggleEmojiPanel:e=>{pe(e)},onToggleStickerPanel:e=>{ge(e)},onUndo:e.onUndo,onRedo:e.onRedo,showOutline:e.sendAsSticker}),(0,R.jsx)(g.FlexRow,{className:C.default.headerRight,justify:"end",children:ze&&(0,R.jsx)(d.default,{onClick:Pe,children:o.fbt._("Done",null,{hk:"2nVR7W"})})})]}),(0,R.jsxs)("div",{ref:Q,className:(0,i.default)(C.default.canvasContainer,{[C.default.cropRotateContainer]:de}),children:[(0,R.jsx)("div",{className:C.default.canvas,style:{display:de?"none":"unset"},children:(0,R.jsx)(c.default,{ref:J,data:Fe,inPaintMode:se,inOutlineMode:ue,paintColor:n,paintThickness:a,outlineSmoothing:F,currentlyEditingTextLayer:e.currentlyEditingTextLayer,draftTextLayer:e.draftTextLayer,scale:Re(),onLayerSelect:e.onLayerSelect,onLayerUnselect:e.onLayerUnselect,onLayerTranslate:e.onLayerTranslate,onLayerTransform:e.onLayerTransform,onTextEditingStart:e=>{oe(!0),U(e)},onTextEditingEnd:(e,t)=>{oe(!1),H(e,t)},onTextInputOutsideClick:e=>{var t,n;const a=e.target;return!(a instanceof HTMLElement&&a.closest(`.${C.default.footer}`)&&a!==Z.current||(null===(t=$.current)||void 0===t?void 0:t.isPanelVisible())||(null===(n=ee.current)||void 0===n?void 0:n.isMenuVisible()))},onPaintDrawEnd:e.onPaintDrawEnd,onOutlineDrawEnd:e.onOutlineDrawEnd,onOutlineDone:Pe,canEditBackground:e.sendAsSticker,outlineEnabled:e.sendAsSticker})}),Ve]}),We]})}));t.ImageBody=F},14500:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(n(48926)),i=n(50796),o=a(n(45095)),s=a(n(64369)),l=a(n(52013)),d=n(15461),c=a(n(94184)),u=n(61498),h=n(48360),f=n(67294),p=n(80666),m=a(n(37793)),g=n(88102),v=n(92320),_=a(n(65273)),x=a(n(92726)),C=a(n(63727)),y=a(n(60453)),S=a(n(69637)),j=n(70449),b=n(60769),E=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=$(t);if(n&&n.has(e))return n.get(e);var a={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var o=r?Object.getOwnPropertyDescriptor(e,i):null;o&&(o.get||o.set)?Object.defineProperty(a,i,o):a[i]=e[i]}a.default=e,n&&n.set(e,a);return a}(n(64103)),k=a(n(50580)),I=n(1063),w=n(29623),T=n(39581),P=n(29424),M=n(6327),L=n(39989),O=a(n(79334)),A=n(84387),D=n(84866),R=a(n(11339)),N=n(43257),F=a(n(87618)),B=a(n(16186)),U=a(n(25324)),H=n(64551),G=n(11054),W=n(90669),V=a(n(38932)),z=a(n(23217)),q=n(81829),K=n(54274),Y=n(50452),Q=a(n(90012)),X=a(n(65235)),Z=a(n(36123)),J=n(85893);function $(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return($=function(e){return e?n:t})(e)}const{IMAGE:ee,VIDEO:te,AUDIO:ne,STICKER:ae}=d.MSG_TYPE,re=3*q.DEFAULT_FONT_SIZE;class ie extends f.Component{constructor(e){var t,n;super(e),t=this,this._setRefCanvasContainer=e=>{this._refCanvasContainer=e},this._setRefCanvas=e=>{this._refCanvas=e},this._setRefImageBody=e=>{this._refImageBody=e},this._setRefFileInput=e=>{this._refFileInput=e},this._setRefSendButton=e=>{this._refSendButton=e},this._mediaThumbRefMap=new Map,this._setRefMediaThumb=(e,t)=>{this._mediaThumbRefMap.set(e,t)},this._captionInputRefMap=new Map,this._setRefCaptionInput=(e,t)=>{this.props.mediaCollection.getActive()&&!t||this._captionInputRefMap.set(e,t)},this._setRefHotKeys=e=>{this._refHotKeys=e},this._update=(e,t)=>{if(e===this._getData())return;const n=this.state.activeMedia;var a,r,i;n&&(n.updateMediaEditorData(e,{undoable:null!==(a=null==t?void 0:t.undoable)&&void 0!==a&&a,lastAction:null!==(r=null==t?void 0:t.lastAction)&&void 0!==r?r:null}),this._updateUndoRedoState());(null==t?void 0:t.updatePreview)&&(null===(i=this._refImageBody)||void 0===i||i.updatePreview());__LOG__(2)`MediaEditor: Updated MediaEditorData`},this._getData=()=>{const{activeMedia:e}=this.state;return null==e?_.default.create():e.mediaEditorData},this._getBackground=()=>{var e;return null===(e=this._refImageBody)||void 0===e?void 0:e.getBackground()},this._handleUndo=()=>{const{activeMedia:e}=this.state;if(e&&e.canUndoMediaEditorData()){var t,n;const a=e.lastMediaEditorAction;e.undoMediaEditorData();const r=e.lastMediaEditorAction;this._updateUndoRedoState(),null===(t=this._refImageBody)||void 0===t||t.updatePreview(),null===(n=this._refImageBody)||void 0===n||n.undoAction(a,r)}},this._handleRedo=()=>{const{activeMedia:e}=this.state;if(e&&e.canRedoMediaEditorData()){var t,n;const a=e.lastMediaEditorAction;e.redoMediaEditorData();const r=e.lastMediaEditorAction;this._updateUndoRedoState(),null===(t=this._refImageBody)||void 0===t||t.updatePreview(),null===(n=this._refImageBody)||void 0===n||n.redoAction(r,a)}},this._updateUndoRedoState=()=>{this.setState((e=>{var t,n,a,r;const i=null!==(t=null===(n=this.state.activeMedia)||void 0===n?void 0:n.canUndoMediaEditorData())&&void 0!==t&&t,o=null!==(a=null===(r=this.state.activeMedia)||void 0===r?void 0:r.canRedoMediaEditorData())&&void 0!==a&&a;return e.canUndo!==i||e.canRedo!==o?{canUndo:i,canRedo:o}:null}))},this._addImageLayer=(e,t,n,a,r)=>{const i=(0,o.default)(this._refImageBody,"this._refImageBody").getCanvasScale(),s=t.width*i,l=t.width*i,d=Math.min(r/s,r/l),c=this._getData().addImageLayerToCenter({type:e,image:t,editable:!0,scale:d});this._update(c,{updatePreview:!0,undoable:!0})},this._handleEmojiSelect=function(){var e=(0,r.default)((function*(e){try{const n=j.EmojiUtil.getGlyphId(e);if(null==n)return;const a=j.EmojiUtil.getGlyphPath(n,"xlarge").high,r=yield se(a),i=t.state.sendAsSticker?128:64;t._addImageLayer(L.ImageLayerType.Emoji,r,r.width,r.height,i),t.state.sendAsSticker&&new R.default.WebcStickerMakerEvents({stickerMakerEventName:R.default.WEBC_STICKER_MAKER_EVENT_NAME_TYPE.EMOJI_ADDED}).commit()}catch(e){g.Cmd.openToast((0,J.jsx)(Y.Toast,{msg:h.fbt._("Failed to add image",null,{hk:"1e7nnp"}),id:(0,Y.genId)()}))}}));return function(){return e.apply(this,arguments)}}(),this._handleStickerSelect=function(){var e=(0,r.default)((function*(e){try{let n;const a=e.mediaData.fullWidth,r=e.mediaData.fullHeight;if(yield(0,u.detectWebpSupport)()){const t=e.mediaData.filehash,a=D.MediaBlobCache.getOrCreateURL(t);n=yield se(a)}else n=yield function(){return le.apply(this,arguments)}(e.mediaData);t._addImageLayer(L.ImageLayerType.Sticker,n,a,r,128),t.state.sendAsSticker&&new R.default.WebcStickerMakerEvents({stickerMakerEventName:R.default.WEBC_STICKER_MAKER_EVENT_NAME_TYPE.STICKER_ADDED}).commit()}catch(e){g.Cmd.openToast((0,J.jsx)(Y.Toast,{msg:h.fbt._("Failed to add image",null,{hk:"1e7nnp"}),id:(0,Y.genId)()}))}}));return function(){return e.apply(this,arguments)}}(),this._handlePaintSelect=()=>{const e=this._getData().clearSelectedLayer();this._update(e)},this._handleOutlineSelect=()=>{const e=this._getData().clearSelectedLayer();this._update(e)},this._handleOutlineDone=()=>{const e=this._getBackground(),t=this._getData();if(!e||t.outlineLayer.isEmpty())return;const n=t.cropCenter,{width:a,height:r}=e,i=new B.default({x:n.x-a/2,y:n.y-r/2}),o=-t.rotation,s=Math.max(a,r),l=t.cropSize.dimension,d=t.updateBackground(e,i,o,l*((W.STICKER_DIMENSION-2*W.STICKER_PADDING)/W.STICKER_DIMENSION)/s).clearOutlinePaths();this._update(d,{undoable:!0,updatePreview:!0,lastAction:p.MediaEditorAction.OutlineDone}),this.state.sendAsSticker&&new R.default.WebcStickerMakerEvents({stickerMakerEventName:R.default.WEBC_STICKER_MAKER_EVENT_NAME_TYPE.IMAGE_OUTLINED}).commit()},this._handleOutlineReset=()=>{const e=this._getData().clearOutlinePaths();this._update(e,{undoable:!0,updatePreview:!0})},this._handleCropRotateCanvas=(e,t,n)=>{const a=this._getData().setRotation(e).setCrop(t,n);this._update(a,{undoable:!0,updatePreview:!0,lastAction:p.MediaEditorAction.CropRotateCanvas}),this.state.sendAsSticker&&new R.default.WebcStickerMakerEvents({stickerMakerEventName:R.default.WEBC_STICKER_MAKER_EVENT_NAME_TYPE.IMAGE_CROPPED}).commit()},this._handlePaintColorSelect=e=>{this.setState({paintColor:e})},this._handlePaintThicknessSelect=e=>{this.setState({paintThickness:e})},this._handleOutlineSmoothingToggle=e=>{this.setState({outlineSmoothing:e})},this._handleTextSelect=()=>{if(this.state.currentlyEditingTextLayer)return;this._handleLayerUnselect();let e=1.2/(0,o.default)(this._refImageBody,"this._refImageBody").getCanvasScale();if(this.state.sendAsSticker){const t=this._getData().cropSize.dimension;e=re*t/W.STICKER_DIMENSION/q.DEFAULT_FONT_SIZE}const t={origin:this._getData().cropCenter,text:"",textColor:this.state.textColor,textBackground:this.state.textBackground,alignment:this.state.alignment,font:this.state.font,scale:e},n=this._getData().addTextLayer(t),a=(0,o.default)(n.lastTextLayer,"data.lastTextLayer");this.setState({draftTextLayer:a,currentlyEditingTextLayer:null})},this._handleFontSelect=e=>{this.setState({font:e});const{selectedLayer:t}=this._getData(),{draftTextLayer:n}=this.state;if(n)this.setState({draftTextLayer:n.setFont(e)});else if(t&&t instanceof q.TextLayer){const n=this._getData().setFont(t,e);this._update(n,{updatePreview:!0,undoable:!0})}},this._handleAlignmentSelect=e=>{this.setState({alignment:e});const{selectedLayer:t}=this._getData(),{draftTextLayer:n}=this.state;if(n)this.setState({draftTextLayer:n.setAlignment(e)});else if(t&&t instanceof q.TextLayer){const n=this._getData().setAlignment(t,e);this._update(n,{updatePreview:!0,undoable:!0})}},this._handleTextColorSelect=e=>{this.setState({textColor:e});const{selectedLayer:t}=this._getData(),{draftTextLayer:n}=this.state;if(n)this.setState({draftTextLayer:n.setTextColor(e)});else if(t&&t instanceof q.TextLayer){const n=this._getData().setTextColor(t,e);this._update(n,{updatePreview:!0,undoable:!0})}},this._handleTextBackgroundToggle=()=>{const e=!this.state.textBackground;this.setState({textBackground:e});const{selectedLayer:t}=this._getData(),{draftTextLayer:n}=this.state;if(n)this.setState({draftTextLayer:n.setTextBackground(e)});else if(t&&t instanceof q.TextLayer){const n=this._getData().setTextBackground(t,e);this._update(n,{updatePreview:!0,undoable:!0})}},this._handleTextEditingStart=e=>{this.setState({draftTextLayer:e,currentlyEditingTextLayer:e})},this._handleTextEditingEnd=(e,t)=>{var n;if(t){let e=this._getData();const n=(0,o.default)(this.state.draftTextLayer,"this.state.draftTextLayer").setText(t);this.state.currentlyEditingTextLayer?e=e.updateLayer((0,o.default)(this.state.currentlyEditingTextLayer,"this.state.currentlyEditingTextLayer"),n):(e=e.addTextLayer(n),this.state.sendAsSticker&&new R.default.WebcStickerMakerEvents({stickerMakerEventName:R.default.WEBC_STICKER_MAKER_EVENT_NAME_TYPE.TEXT_ADDED}).commit()),this._update(e,{updatePreview:!0,undoable:!0})}else{const{currentlyEditingTextLayer:t}=this.state;t&&this._update(this._getData().deleteLayer(t),{updatePreview:!0,undoable:Boolean(e.text)})}setTimeout((()=>{this.setState({draftTextLayer:null,currentlyEditingTextLayer:null})}),0),null===(n=this._refHotKeys)||void 0===n||n.focus()},this._handlePaintDrawEnd=e=>{this._update(this._getData().addPaintPath(e),{undoable:!0,updatePreview:!0})},this._handleOutlineDrawEnd=e=>{this._update(this._getData().addOutlinePath(e),{undoable:!0,updatePreview:!0,lastAction:p.MediaEditorAction.Outline})},this._handleLayerUnselect=()=>{this._update(this._getData().clearSelectedLayer())},this._handleLayerSelect=e=>{if(!e.editable)return;const t=this._getData().setSelectedLayer(e);this._update(t),e instanceof q.TextLayer&&this.setState({textColor:e.textColor,textBackground:e.textBackground,font:e.font})},this._handleLayerTranslate=(e,t)=>{e instanceof L.ImageLayer&&e.isBackground()?this._update(this._getData().translateBackground(t),{updatePreview:!0,undoable:!0}):this._update(this._getData().translateLayer(e,t),{updatePreview:!0,undoable:!0})},this._handleLayerTransform=(e,t,n)=>{e instanceof L.ImageLayer&&e.isBackground()?this._update(this._getData().transformBackground(t,n),{updatePreview:!0,undoable:!0}):this._update(this._getData().transformLayer(e,t,n),{updatePreview:!0,undoable:!0})},this._handleLayerDelete=e=>{const t=this._getData().deleteLayer(e);this._update(t,{updatePreview:!0,undoable:!0})},this._handleMediaProcessUpdate=()=>{const{mediaCollection:e}=this.props;if(!e.canSend())return;const{errorMsgs:t}=e.uiProcessMsgs();t&&(g.Cmd.openToast((0,J.jsx)(Y.Toast,{msg:t,id:(0,Y.genId)()})),0===e.getPreviewableMedias().length&&this.props.onClose()),this.forceUpdate()},this._handleDrop=e=>{this.state.viewOnce||this.state.sendAsSticker||this._handleFilePick(e)},this._handleDragChange=(e,t)=>{this.state.viewOnce||this.state.sendAsSticker||(this.setState({isDragging:e}),e||t||this.props.mediaCollection.length||this.props.onClose())},this._handleCaptionChange=e=>{const{activeMedia:t,isInitCaptionUsed:n}=this.state;if(!t)return;const a=this.props.mediaCollection.indexOf(t);t.updateCaption(e),0===a&&""===e&&n&&this.setState({isInitCaptionUsed:!1})},this._handlePaste=e=>{e.preventDefault(),e.stopPropagation();const t=new x.default(e.clipboardData);t.hasFiles()&&this._handleFiles(t)},this._handleFiles=e=>{const t=e.getFiles().filter((e=>{const t=(0,I.typeFromMimetype)(e.type);return"image"===t||"video"===t})).map((e=>({file:e})));this.props.mediaCollection.processAttachments(t,R.default.MEDIA_PICKER_ORIGIN_TYPE.PASTE)},this._handleAddFileClick=()=>{if(this._refFileInput){this._refFileInput.click()}},this._handleFilePick=e=>{const t=this.props.getUnmountSignal();(0,b.getFiles)(e).then((n=>{if(t.aborted)return;let a;return e.shiftKey&&e.altKey&&1===n.length&&(this.setState({sendAsSticker:!0,paintThickness:K.THICKNESS.XLARGE}),a=!0),this.props.mediaCollection.processAttachments(n.map((e=>({file:e,stickerMaker:a}))),R.default.MEDIA_PICKER_ORIGIN_TYPE.CHAT_PHOTO_LIBRARY)})).catch((0,i.filteredCatch)(E.MediaDragDropError,(e=>{this.props.mediaCollection.length||this.props.onDropText(e.src)}))),e.target.value&&(e.target.value="")},this._handleEnter=e=>{var t;if(!this.state.activeMedia)return;if(e.repeat)return;if(e.shiftKey)return;if(this.state.draftTextLayer)return;const{selectedLayer:n}=this._getData();if(n instanceof q.TextLayer)return e.preventDefault(),e.stopPropagation(),void this._handleTextEditingStart(n);(null===(t=this._refImageBody)||void 0===t?void 0:t.resetUIState())||this._handleSendFromMediaEditor()},this._handleArrowKey=(e,t)=>{if(!this.state.activeMedia||t.repeat||this.state.draftTextLayer)return;const{activeMedia:n}=this.state,a=n&&!n.caption,r=this._captionInputRefMap.get(n.id);(a||r&&!r.isFocused()||r&&r.cursorIsAtStart())&&("left"===e?this._handlePrev():this._handleNext())},this._handlePrev=()=>{this.props.mediaCollection.setPrevAsActive()&&(this._refSendButton&&!this.state.draftTextLayer&&l.default.focus(this._refSendButton),this._scrollIntoView())},this._handleNext=()=>{this.props.mediaCollection.setNextAsActive()&&(this._refSendButton&&!this.state.draftTextLayer&&l.default.focus(this._refSendButton),this._scrollIntoView())},this._scrollIntoView=()=>{const{activeMedia:e}=this.state;if(!e)return;const t=this._mediaThumbRefMap.get(e.id);t&&t.scrollIntoView()},this._handleSelectThumb=e=>{this.props.mediaCollection.setActive(e)},this._handleRemoveThumb=(e,t)=>{t.stopPropagation(),t.preventDefault(),this.props.mediaCollection.remove(e),0===this.props.mediaCollection.getValidMedias().length?this._delayedClose=setTimeout((()=>{this.props.onClose()}),200):this._refSendButton&&l.default.focus(this._refSendButton)},this._handleSendFromMediaEditor=e=>{var t;null==e||e.preventDefault(),null==e||e.stopPropagation();const{mediaCollection:n}=this.props;if(!n.canSend())return;const a=n.getPreviewableMedias();if(0===a.length)return void this.props.onClose();var r;((null===(t=this.state.activeMedia)||void 0===t?void 0:t.mediaEditorData.hasEdits())||this.state.sendAsSticker)&&(null===(r=this._refImageBody)||void 0===r||r.updatePreview({immediately:!0}));const i=new Map,o=[];a.forEach((e=>{const t=e.caption,a=this._captionInputRefMap.get(e.id);if(t&&a){const n=a.serialize(t);i.set(e.id,n)}if(e.editedFile&&(e.mediaEditorData.hasEdits()||this.state.sendAsSticker)){const t=n.replace(e.id,{file:e.editedFile,asSticker:this.state.sendAsSticker});o.push(t)}})),Promise.all(o).then((()=>{const e=n.getPreviewableMedias();if(0===e.length)return;const t=e.map((e=>{var t;let n=e.caption,a=[];const r=i.get(e.id);if(r){const[e,t]=[r[0].trim(),r[1]];e.length&&(n=e,a=t.mentionedJidList||[])}return e.caption=null!==(t=n)&&void 0!==t?t:void 0,{media:e,mentionedJidList:a}}));this.props.onSendMedia(t,{initCaptionUsed:this.state.isInitCaptionUsed,isViewOnce:this._canViewOnce()&&this.state.viewOnce}),this._commitMediaEditorSendMetric(a)}))},this._handleToggleViewOnce=e=>{this.setState({viewOnce:e})},this._handleToggleStickerMaker=()=>{const e=!this.state.sendAsSticker&&this._canSendAsSticker();this.setState({sendAsSticker:e,paintThickness:e?K.THICKNESS.XLARGE:K.THICKNESS.SMALL})},this._canViewOnce=()=>{var e;const{chat:t,mediaCollection:n}=this.props,a=t.contact.isEnterprise;return H.ServerProps.viewOnceWrite&&1===n.length&&!0===(null===(e=n.at(0))||void 0===e?void 0:e.isViewableOnce())&&!a&&!this.props.sendAsSticker},this._canSendAsSticker=()=>{var e;const{mediaCollection:t}=this.props;return 1===t.length&&(null===(e=t.at(0))||void 0===e?void 0:e.type)===ee},this._getMediaBody=e=>{let t=null;const{paintColor:n,paintThickness:a,outlineSmoothing:r,canUndo:i,canRedo:o}=this.state,s=H.ServerProps.viewOnceWrite?this.state.viewOnce:null;switch(e.type){case ae:case ee:t=(0,J.jsx)(M.ImageBody,{ref:this._setRefImageBody,attachMedia:e,chat:this.props.chat,onCaptionChange:this._handleCaptionChange,onClose:"capture"===this.props.theme?null:this.props.onClose,onEnter:this._handleSendFromMediaEditor,setCaptionInputRef:this._setRefCaptionInput,paintColor:n,paintThickness:a,outlineSmoothing:r,canUndo:i,canRedo:o,currentlyEditingTextLayer:this.state.currentlyEditingTextLayer,draftTextLayer:this.state.draftTextLayer,viewOnce:s,viewOnceDisabled:!this._canViewOnce(),sendAsSticker:this.state.sendAsSticker,onPaintSelect:this._handlePaintSelect,onOutlineSelect:this._handleOutlineSelect,onOutlineDone:this._handleOutlineDone,onOutlineReset:this._handleOutlineReset,onTextSelect:this._handleTextSelect,onTextBackgroundToggle:this._handleTextBackgroundToggle,onEmojiSelect:this._handleEmojiSelect,onStickerSelect:this._handleStickerSelect,onLayerSelect:this._handleLayerSelect,onLayerUnselect:this._handleLayerUnselect,onLayerDelete:this._handleLayerDelete,onLayerTranslate:this._handleLayerTranslate,onLayerTransform:this._handleLayerTransform,onTextEditingStart:this._handleTextEditingStart,onTextEditingEnd:this._handleTextEditingEnd,onTextColorSelect:this._handleTextColorSelect,onFontSelect:this._handleFontSelect,onAlignmentSelect:this._handleAlignmentSelect,onPaintColorSelect:this._handlePaintColorSelect,onPaintThicknessSelect:this._handlePaintThicknessSelect,onOutlineSmoothingToggle:this._handleOutlineSmoothingToggle,onCropRotateCanvas:this._handleCropRotateCanvas,onUndo:this._handleUndo,onRedo:this._handleRedo,onPaintDrawEnd:this._handlePaintDrawEnd,onOutlineDrawEnd:this._handleOutlineDrawEnd,onToggleViewOnce:this._handleToggleViewOnce,onFiles:this._handleFiles},e.mediaEditorData.id);break;case te:t=(0,J.jsx)(X.default,{attachMedia:e,chat:this.props.chat,viewOnce:s,viewOnceDisabled:!this._canViewOnce(),setCaptionInputRef:this._setRefCaptionInput,onCaptionChange:this._handleCaptionChange,onClose:this.props.onClose,onEnter:this._handleSendFromMediaEditor,onToggleViewOnce:this._handleToggleViewOnce,onFiles:this._handleFiles},e.id);break;case ne:t=(0,J.jsx)(m.default,{item:e,onClose:this.props.onClose},e.id);break;default:t="pdf"===(0,N.previewType)(e.mimetype)?(0,J.jsx)(F.default,{item:e,onClose:this.props.onClose},e.id):(0,J.jsx)(k.default,{mimeType:e.mimetype,filesize:e.filesize,filename:e.filename,fileExt:e.fileExt,onClose:this.props.onClose},e.id)}return t},this.getThumbs=()=>{const{mediaCollection:e}=this.props;return(0,J.jsx)(C.default,{className:O.default.thumbs,mediaCollection:e,onClick:this._handleSelectThumb,onClose:this._handleRemoveThumb,forwardRef:this._setRefMediaThumb})},this.state={paintColor:(0,v.getColorValue)(v.COLORS.BLUE),paintThickness:e.sendAsSticker?K.THICKNESS.XLARGE:K.THICKNESS.SMALL,outlineSmoothing:!0,textColor:(0,v.getColorValue)(v.COLORS.BLACK),font:T.FONTS.SANS_SERIF,textBackground:!0,alignment:T.TextAlignment.CENTER,isDragging:!1,canUndo:!1,canRedo:!1,activeMedia:null,prevActiveMedia:null,isInitCaptionUsed:!1,initCaption:null===(n=this.props.initCaption)||void 0===n?void 0:n.text,currentlyEditingTextLayer:null,draftTextLayer:null,viewOnce:!1,sendAsSticker:e.sendAsSticker}}static getDerivedStateFromProps(e,t){var n,a;const r=e.mediaCollection.getActive(),i=t.initCaption;let o=t.isInitCaptionUsed;return o||t.activeMedia||!i||!r||r.type!==ee&&r.type!==te||(r.caption=i,o=!0),{prevActiveMedia:r,activeMedia:r,canUndo:null!==(n=null==r?void 0:r.canUndoMediaEditorData())&&void 0!==n&&n,canRedo:null!==(a=null==r?void 0:r.canRedoMediaEditorData())&&void 0!==a&&a,isInitCaptionUsed:o}}componentDidMount(){var e;const{mediaCollection:t,listeners:n}=this.props;t.isStickerMaker=this.state.sendAsSticker,n.add(t,"add remove reset",(()=>{this.forceUpdate()})),n.add(t,"active-change change:state change:previewable",this._handleMediaProcessUpdate),n.add(g.Cmd,"toggle_sticker_maker",this._handleToggleStickerMaker),null===(e=this._refHotKeys)||void 0===e||e.focus()}componentDidUpdate(){this.props.mediaCollection.isStickerMaker=this.state.sendAsSticker}componentWillUnmount(){this._delayedClose&&clearTimeout(this._delayedClose)}handleRequestDismiss(){var e;return!(null===(e=this._refImageBody)||void 0===e?void 0:e.resetUIState())&&(!this.state.draftTextLayer||(this.setState({currentlyEditingTextLayer:null,draftTextLayer:null}),!1))}_commitMediaEditorSendMetric(e){if(this.state.sendAsSticker)return new R.default.StickerSend({stickerSendOrigin:R.default.STICKER_SEND_ORIGIN_TYPE.STICKER_MAKER,stickerIsAnimated:!1,stickerIsFirstParty:!1,stickerIsFromStickerMaker:!0}).commit(),void new R.default.WebcStickerMakerEvents({stickerMakerEventName:R.default.WEBC_STICKER_MAKER_EVENT_NAME_TYPE.SEND_STICKER}).commit();let t=0,n=0,a=0,r=0,i=0,o=0;e.forEach((e=>{const s=e.mediaEditorData;e.type===ee&&(t++,s.hasEdits()&&n++,s.paintLayer.paths.length>0&&a++),s.layers.forEach((e=>{e instanceof L.ImageLayer?(e.isEmoji()&&r++,e.isSticker()&&i++):e instanceof q.TextLayer&&o++}))})),new R.default.WebcMediaEditorSend({imageCount:t,editedImageCount:n,paintedImageCount:a,emojiLayerCount:r,stickerLayerCount:i,textLayerCount:o}).commit()}render(){const{mediaCollection:e}=this.props,{activeMedia:t}=this.state;let n,a=e.getPreviewableMedias();a.length>s.default.MAX_FILES&&(a=a.slice(0,s.default.MAX_FILES)),e.canSend()?t&&(n=this._getMediaBody(t)):n=(0,J.jsx)("div",{className:O.default.spinner,children:(0,J.jsx)(G.Spinner,{color:"highlight"},"processing")});const r=this.state.isDragging?(0,J.jsx)("div",{className:O.default.dropOverlay,children:(0,J.jsx)("div",{className:O.default.dropOverlayOutline,children:h.fbt._("Drag file here",null,{hk:"y9aHs"})})},"container"):null,i={enter:this._handleEnter,left:e=>this._handleArrowKey("left",e),right:e=>this._handleArrowKey("right",e)},o="*"===N.DOC_MIMES?"*":[N.IMAGE_MIMES].join();let l;if(null!=n){let t;if(a.length>0&&(t=(0,J.jsx)("div",{className:O.default.sendButton,tabIndex:"-1",ref:this._setRefSendButton,onKeyPress:e=>e.preventDefault(),children:(0,J.jsx)(U.default,{ariaLabel:h.fbt._("Send",null,{hk:"2JJUaP"}),large:!0,icon:(0,J.jsx)(z.default,{name:"send",directional:!0}),count:1===a.length?null:a.length,onClick:this._handleSendFromMediaEditor,disabled:!e.canSend()})})),"capture"===this.props.theme)l=(0,J.jsx)("div",{className:O.default.captureFooter,children:t});else{const e=!this.state.viewOnce&&!this.state.sendAsSticker&&a.length<s.default.MAX_FILES,n="add-alt",r=this.state.sendAsSticker?null:(0,J.jsx)(V.default,{className:(0,c.default)(O.default.addMediaButton,{[O.default.addMediaButtonDisabled]:!e}),disabled:!e,name:n,title:h.fbt._("Add file",null,{hk:"4Gvj3D"}),onClick:this._handleAddFileClick,"aria-label":h.fbt._("Add file",null,{hk:"4Gvj3D"})},"media-more");let i;a.length>0&&(i=(0,J.jsxs)(w.FlexRow,{className:O.default.filmstripContainer,justify:"center",align:"start",children:[this.getThumbs(),r]})),l=(0,J.jsxs)("div",{className:O.default.footer,children:[i,t]})}}const d=(0,c.default)(O.default.container,{[O.default.previewOnly]:t&&t.type!==ee});let u=(0,J.jsxs)(w.FlexColumn,{className:d,align:"stretch",children:[r,n,l,(0,J.jsx)("input",{ref:this._setRefFileInput,type:"file",accept:o,style:{display:"none"},onChange:this._handleFilePick,multiple:!0})]});return"attach"===this.props.theme&&(u=(0,J.jsx)(y.default,{theme:"media",onDrop:this._handleDrop,onDragChange:this._handleDragChange,children:(0,J.jsx)(S.default,{tabIndex:"-1",overflow:"hidden",onPaste:this._handlePaste,children:u})},"attach-image-modal")),(0,J.jsx)(P.HotKeys,{handlers:i,onRef:this._setRefHotKeys,children:u})}}ie.defaultProps={onClose:()=>{},theme:"attach",sendAsSticker:!1},ie.displayName="MediaEditor";const oe=(0,Q.default)((0,A.ListenerHOC)(ie));function se(e){return new Promise(((t,n)=>{const a=new Image;a.onload=()=>{t(a)},a.onerror=n,a.src=e}))}function le(){return(le=(0,r.default)((function*(e){let t=e.rgbaBuffer;if(!t){const n=D.MediaBlobCache.get(e.filehash);if(!n)throw new Error("Failed to get media blob");const a=yield(0,I.blobToArrayBuffer)(n),r=(yield(0,Z.default)(a)).frames[0];if(!r)throw new Error("Failed to get sticker first frame.");t=r.rgbaBuffer}const n=e.fullWidth,a=e.fullHeight,r=document.createElement("canvas");r.width=n,r.height=a;const i=r.getContext("2d"),o=i.createImageData(n,a);return o.data.set(new Uint8Array(t)),i.putImageData(o,0,0),r}))).apply(this,arguments)}t.default=class extends oe{handleRequestDismiss(){return this.getComponent().handleRequestDismiss()}}},37793:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){let{onClose:t,item:n}=e;const{mimetype:a,fullPreview:l}=n;return(0,s.jsxs)("div",{className:o.default.container,children:[(0,s.jsx)(i.default,{onClose:t}),(0,s.jsx)(r.default,{mimeType:a,url:l})]})};var r=a(n(74252)),i=a(n(21454)),o=a(n(58099)),s=n(85893)},13057:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){let{data:t,rotation:n,cropOrigin:a,cropSize:g,containerSize:v,keepRatio:_,onCropChange:x,sendAsSticker:C}=e;const y=t.resetCropRotate().setRotation(n),S=(0,r.useRef)(),j=(0,r.useRef)(),{width:b,height:E}=g,{x:k,y:I}=a,w=(0,r.useRef)(g),T=b/w.current.width,P=E/w.current.height,M=t.width,L=t.height,{width:O,height:A}=p(M,L,n),D=new d.default({width:v.width-20,height:v.height-20}),R=(0,c.calculateContainScale)(n%180?L:M,n%180?M:L,D,h),N=f/R,F=new d.default({width:M+2*N,height:L+2*N}),{width:B,height:U}=p(F.width,F.height,n),H=F.width/2,G=F.height/2;(0,r.useEffect)((()=>{const e=S.current,t=j.current;var n;e&&t&&0===e.nodes().length&&(e.nodes([t]),null===(n=t.getLayer())||void 0===n||n.batchDraw())}));const W=e=>{const{target:t}=e,n=Math.round(t.x()),a=Math.round(t.y()),r=Math.min(Math.round(t.width()*t.scaleX()),M-n),i=Math.min(Math.round(t.height()*t.scaleY()),L-a);x(new s.default({x:n,y:a}),new d.default({width:r,height:i}))},V=["top-left","top-right","bottom-left","bottom-right"];_||V.push("top-center","middle-right","middle-left","bottom-center");return(0,u.jsxs)("div",{className:o.default.container,children:[(0,u.jsx)(i.default,{data:y,scale:R,canEditLayer:!1,style:{padding:f},outlineEnabled:C}),(0,u.jsx)(l.Stage,{className:o.default.cropperContainer,width:Math.round(B*R),height:Math.round(U*R),scaleX:R,scaleY:R,children:(0,u.jsx)(l.Layer,{rotation:n,offsetX:H,offsetY:G,x:B/2,y:U/2,children:(0,u.jsxs)(l.Group,{x:N,y:N,children:[(0,u.jsx)(l.Rect,{x:0,y:0,width:M,height:L,fill:"black",opacity:.6}),(0,u.jsx)(l.Rect,{ref:j,fill:"red",x:k,y:I,width:w.current.width,height:w.current.height,scaleX:T,scaleY:P,draggable:!0,dragBoundFunc:e=>{const{width:t,height:a}=p(b,E,n);let{x:r,y:i}=function(e,t,n,a,r){switch((r%360+360)%360){case 0:return{x:e,y:t};case 90:return{x:e-n,y:t};case 180:return{y:t-a,x:e-n};case 270:return{x:e,y:t-a};default:throw new Error("Unsupported angle")}}(e.x,e.y,t*R,a*R,n);r<f?r=f:(r-f)/R+t>O&&(r=Math.round(O-t+N)*R),i<f?i=f:(i-f)/R+a>A&&(i=Math.round(A-a+N)*R);return function(e,t,n,a,r){switch((r%360+360)%360){case 0:return{x:e,y:t};case 90:return{x:e+n,y:t};case 180:return{y:t+a,x:e+n};case 270:return{x:e,y:t+a};default:throw new Error("Unsupported angle")}}(r,i,t*R,a*R,n)},onTransformEnd:W,onDragEnd:W,globalCompositeOperation:"destination-out"}),(0,u.jsx)(l.Transformer,{ref:S,anchorStroke:"blue",anchorFill:"white",anchorSize:10,anchorCornerRadius:5,borderEnabled:!1,centeredScaling:!1,resizeEnabled:!0,rotateEnabled:!1,ignoreStroke:!0,boundBoxFunc:(e,t)=>{const a=M*R+20,r=L*R+20,i=m(e,a,r,n,-n),o=m(t,a,r,n,-n);return Math.round(o.x)<f?(o.x=f,o.width=i.width+(i.x-f)):Math.round(o.width)<20?(o.x=i.x,o.width=i.width):Math.round(o.x+o.width)>Math.round(a)-f&&(o.width=a-o.x-f),Math.round(o.y)<f?(o.y=f,o.height=i.height+(i.y-f)):Math.round(o.height)<20?(o.y=i.y,o.height=i.height):Math.round(o.y+o.height)>Math.round(r)-f&&(o.height=r-o.y-f),m(o,a,r,0,n)},keepRatio:_,enabledAnchors:V},"transformer")]})},"cropper")})]})};var r=n(67294),i=a(n(35344)),o=a(n(10706)),s=a(n(16186)),l=n(99282),d=a(n(46668)),c=n(79230),u=n(85893);const h=new d.default({width:200,height:200}),f=10;function p(e,t,n){return{width:n%180==0?e:t,height:n%180==0?t:e}}function m(e,t,n,a,r){const i=Math.max(t,n),o=p(t,n,a),l=(i-o.width)/2,d=(i-o.height)/2,c=new s.default({x:e.x+l,y:e.y+d}),u=new s.default({x:i/2,y:i/2}),h=c.rotate(u,r),f=p(t,n,a+r),m=(i-f.width)/2,g=(i-f.height)/2;return{x:h.x-m,y:h.y-g,width:e.width,height:e.height,rotation:e.rotation}}},50580:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t;let{onClose:n,filename:a,filesize:f,fileExt:p,mimeType:m}=e;const g=null!=f?d.default.filesize(f):"",v=null!==(t=h.get(m))&&void 0!==t?t:"preview-generic";return(0,u.jsxs)("div",{className:l.default.container,children:[(0,u.jsx)(s.default,{onClose:n,filename:a}),(0,u.jsx)(o.FlexColumn,{className:i.default.body,align:"center",justify:"center",children:(0,u.jsxs)(o.FlexColumn,{className:i.default.previewContainer,align:"center",justify:"center",children:[(0,u.jsx)("div",{className:i.default.previewIcon,children:(0,u.jsx)(c.default,{name:v})}),(0,u.jsx)("div",{className:i.default.header,children:r.fbt._("No preview available",null,{hk:"3NAVbb"})}),(0,u.jsxs)("div",{className:i.default.metadata,children:[g,null!=p&&""!==p?` - ${p.toUpperCase()}`:null]})]})})]})};var r=n(48360),i=a(n(45134)),o=n(29623),s=a(n(21454)),l=a(n(58099)),d=a(n(43725)),c=a(n(23217)),u=n(85893);const h=new Map([["text/plain","preview-txt"],["text/rtf","preview-doc"],["application/msword","preview-doc"],["application/vnd.openxmlformats-officedocument.wordprocessingml.document","preview-doc"],["text/csv","preview-sheet"],["application/vnd.ms-excel","preview-sheet"],["application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","preview-sheet"],["application/vnd.ms-powerpoint","preview-slides"],["application/vnd.openxmlformats-officedocument.presentationml.presentation","preview-slides"],["audio/aac","preview-audio"],["audio/mp4","preview-audio"],["audio/amr","preview-audio"],["audio/mpeg","preview-audio"],["audio/ogg; codecs=opus","preview-audio"],["audio/wav","preview-audio"],["application/zip","preview-compressed"]])},21454:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{filename:t,pageCount:n}=e;let a=null;null!=n&&n>0&&(a=o.default.t(146,{count:n,_plural:n}));return(0,l.jsxs)("div",{className:(0,i.default)(d),children:[(0,l.jsx)("button",{"aria-label":r.fbt._("Close",null,{hk:"17RE2w"}),onClick:e.onClose,className:(0,i.default)(f),children:(0,l.jsx)(s.default,{"aria-hidden":!0,color:"secondary",name:"x"})}),(0,l.jsxs)("div",{className:(0,i.default)(c),children:[t&&(0,l.jsx)("span",{className:(0,i.default)(u),children:t}),null!=a&&(0,l.jsx)("span",{className:(0,i.default)(h),children:a})]})]})};var r=n(48360),i=a(n(56720)),o=a(n(43725)),s=a(n(23217)),l=n(85893);const d={display:"p357zi0d",alignItems:"gndfcl4n",justifyContent:"o4u7okr9",minHeight:"cl7oiv0o",paddingTop:"fbgy3m38",paddingEnd:"l9g3jx6n",paddingBottom:"oq31bsqd",paddingStart:"lyvj5e2u",backgroundColor:"ej3x2ktq"},c={display:"p357zi0d",flexGrow:"ggj6brxn",flexShrink:"m0h2a7mj",flexBasis:"rjo8vgbg",flexDirection:"f8m0rgwh",alignItems:"gndfcl4n"},u={fontSize:"f8jlpxt4",color:"tl2vja3b"},h={marginTop:"hymafltn",fontSize:"dsh4tgtl",color:"pm5hny62"},f={cursor:"ajgl1lbb"}},87618:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){let{onClose:t,item:n}=e;const{mimetype:a,fullPreview:d,fullPreviewSize:c,documentPageCount:u,filename:h}=n;if(!(d&&c&&null!=u&&u>0))return(0,l.jsx)(i.default,{mimeType:n.mimetype,filesize:n.filesize,filename:n.filename,fileExt:n.fileExt,onClose:t});return(0,l.jsxs)("div",{className:s.default.container,children:[(0,l.jsx)(o.default,{onClose:t,filename:h,pageCount:u}),(0,l.jsx)(r.default,{fullPreview:d,fullPreviewSize:c,pageCount:u,showPageCount:!1,showBorder:!0,mimeType:a,filename:h})]})};var r=a(n(35137)),i=a(n(50580)),o=a(n(21454)),s=a(n(58099)),l=n(85893)},65235:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){let{attachMedia:t,onClose:n,chat:a,viewOnce:i,viewOnceDisabled:f,onCaptionChange:p,onEnter:m,setCaptionInputRef:g,onToggleViewOnce:v,onFiles:_}=e;const{caption:x}=(0,d.useModelValues)(t,["caption"]);return(0,u.jsxs)("div",{className:c.default.container,children:[(0,u.jsx)(l.default,{onClose:n}),(0,u.jsx)(o.default,{mimeType:t.mimetype,url:t.fullPreview,isGif:t.isGif,size:t.fullPreviewSize,processing:t.state===h,preview:t.preview}),(0,u.jsx)("div",{className:c.default.footer,children:(0,u.jsx)(s.default,{chat:a,caption:x,viewOnce:i,viewOnceDisabled:f,msgType:r.MSG_TYPE.VIDEO,theme:"video",onToggleViewOnce:v,onChange:p,onEnter:m,onFiles:_,setCaptionInputRef:e=>{g(t.id,e)}},t.id)})]})};var r=n(15461),i=n(80666),o=a(n(84124)),s=a(n(69613)),l=a(n(21454)),d=n(49082),c=a(n(91976)),u=n(85893);const{PROCESSING:h}=i.ATTACH_MEDIA_STATE},88262:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{children:t,onClick:n,icon:a,caret:d,disabled:c,title:u,selected:h}=e;let f,p;if("string"==typeof a)switch(a){case"sans-serif":f=(0,l.jsx)(s.default,{name:"panel-emoji-flags",display:"inline"});break;case"checked":f=(0,l.jsx)(s.default,{name:"checkmark",display:"inline"});break;case"unchecked":f=(0,l.jsx)(s.default,{name:"x",display:"inline"});break;default:a&&(f=(0,l.jsx)(s.default,{name:a,display:"inline"}))}else a&&(f=a);if(d)switch(d){case"up":p=(0,l.jsx)(s.default,{name:"chevron-down-alt",display:"inline",className:i.default.rotate});break;case"down":p=(0,l.jsx)(s.default,{name:"chevron-down-alt",display:"inline"})}return(0,l.jsxs)("div",{role:"button",tabIndex:"-1",onClick:n,className:(0,r.default)(i.default.container,e.className,{[i.default.disabled]:c,[i.default.selected]:h}),title:u,children:[f&&(0,l.jsx)(o.FlexRow,{align:"center",justify:"center",className:i.default.icon,children:f}),t&&(0,l.jsx)("span",{className:i.default.body,children:t}),p&&(0,l.jsx)("span",{className:i.default.caret,children:p})]})};var r=a(n(94184)),i=a(n(86382)),o=n(29623),s=a(n(23217)),l=n(85893)},66430:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(67294),i=a(n(88262)),o=a(n(4837)),s=a(n(31488)),l=a(n(29598)),d=n(60811),c=n(29623),u=a(n(43725)),h=n(18644),f=a(n(24717)),p=n(85893);function m(e,t){const{colors:n,onColorSelect:a,selectedColor:m}=e,[g,v]=(0,r.useState)(null),_=()=>{v(null)},x=()=>Boolean(g);(0,r.useImperativeHandle)(t,(()=>({isPanelVisible:x})));const C=n.map((e=>{let{primaryColor:t,secondaryColor:n}=e;return(0,p.jsx)(s.default,{primaryColor:t,onSelect:()=>a(t),selected:Boolean(m&&m.equals(t))},t.toString())}));let y=null;return g&&(y=(0,p.jsx)(h.UIE,{displayName:"ColorPicker",escapable:!0,popable:!0,requestDismiss:_,children:(0,p.jsx)(f.default,{contextMenu:g})})),(0,p.jsxs)("div",{className:o.default.container,children:[(0,p.jsx)(c.FlexRow,{className:o.default.colorChipsContainer,children:C}),(0,p.jsx)(i.default,{onClick:e=>{e.preventDefault(),e.stopPropagation();const t={menu:(0,p.jsx)(l.default,{onColorSelect:a,selectedColor:m,onColorPickerClose:_}),dirX:u.default.isRTL()?d.DirX.RIGHT:d.DirX.LEFT,dirY:d.DirY.BOTTOM,type:"color_picker",anchor:e.target};v(t)},caret:g?"down":"up"}),y]})}var g=(0,r.forwardRef)(m);t.default=g},31488:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{primaryColor:t,secondaryColor:n,onSelect:a,selected:l,withBorder:d}=e,[c,u]=(0,i.useState)(!1),[h,f]=(0,i.useState)(!1);return(0,s.jsx)("div",{onClick:a,onMouseEnter:()=>{u(!0)},onMouseLeave:()=>{u(!1)},onMouseDown:()=>{f(!0)},onMouseUp:()=>{f(!1)},className:(0,r.default)(o.default.colorButton,{[o.default.selected]:l,[o.default.hover]:c,[o.default.active]:h}),style:{backgroundColor:h&&!l?t.withAlpha(.2).toRgbaString():"transparent"},children:(0,s.jsx)("div",{className:(0,r.default)(o.default.primaryColorChip,{[o.default.colorChipWithBorder]:d&&t.isWhite(),[o.default.primaryColorChipMedium]:"medium"===e.theme}),style:{backgroundColor:t.toRgbaString()},children:n&&l&&(0,s.jsx)("div",{className:o.default.secondaryColorChip,style:{backgroundColor:n.toRgbaString()}})})})};var r=a(n(94184)),i=n(67294),o=a(n(88501)),s=n(85893)},60753:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(67294),i=n(16241),o=a(n(31488)),s=a(n(60755)),l=n(98254),d=n(29424),c=n(52596),u=n(85893);class h extends r.Component{constructor(){super(...arguments),this._setRefHexColorInput=e=>this._refHexColorInput=e,this.state={inputColorVal:this.props.color.toHex(),selectedColor:this.props.color},this._handleInputChange=e=>{const t=e.target.value;if(this.setState({inputColorVal:t}),!t||t&&!(0,i.isValidHex)(t))return;const n=i.Color.fromHex(t);this.props.onChangeColor(n)},this._handleEnter=()=>{this.props.onColorPickerClose()}}static getDerivedStateFromProps(e,t){const n={};return e.color!==t.selectedColor&&((0,i.compareHex)(t.inputColorVal,e.color.toHex())||(n.inputColorVal=e.color.toHex()),n.selectedColor=e.color),n}render(){const{color:e}=this.props,{inputColorVal:t}=this.state;return(0,u.jsxs)("div",{className:s.default.container,style:{width:l.CONTAINER_WIDTH,height:l.INPUT_HEIGHT},children:[(0,u.jsx)(o.default,{withBorder:!0,primaryColor:e,selected:!1,theme:"medium"}),(0,u.jsx)(d.HotKeys,{handlers:{enter:this._handleEnter},children:(0,u.jsx)(c.SelectableDiv,{selectable:!0,children:(0,u.jsx)("input",{type:"text",ref:this._setRefHexColorInput,className:s.default.input,value:t,onChange:this._handleInputChange})})})]})}}t.default=h,h.displayName="ColorPickerInput"},26162:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{color:t,onChangeSelectedColor:n,onChangeCanvasColor:a}=e,u=(0,r.useRef)(null),[h,f]=(0,r.useState)(!1);(0,r.useEffect)((()=>{const e=u.current;if(!e)return;const t=e.getContext("2d");let n=t.createLinearGradient(0,0,e.width,0);n.addColorStop(0,"#ff0000"),n.addColorStop(1/6,"#ffff00"),n.addColorStop(1/6*2,"#00ff00"),n.addColorStop(.5,"#00ffff"),n.addColorStop(1/6*4,"#0000ff"),n.addColorStop(1/6*5,"#ff00ff"),n.addColorStop(1,"#ff0000"),t.fillStyle=n,t.fillRect(0,0,e.width,e.height),n=t.createLinearGradient(0,0,0,e.height),n.addColorStop(0,"rgba(255, 255, 255, 1)"),n.addColorStop(.5,"rgba(255, 255, 255, 0)"),n.addColorStop(1,"rgba(255, 255, 255, 0)"),t.fillStyle=n,t.fillRect(0,0,e.width,e.height),n=t.createLinearGradient(0,0,0,e.height),n.addColorStop(0,"rgba(0, 0, 0, 0)"),n.addColorStop(.5,"rgba(0, 0, 0, 0)"),n.addColorStop(1,"rgba(0, 0, 0, 1)"),t.fillStyle=n,t.fillRect(0,0,e.width,e.height)}),[]);const p=(0,l.getPositionFromColor)(t),m=(0,d.default)(n,s.THROTTLE_WAIT_TIME),g=(e,t)=>{null!=t&&f(t);const{x:n,y:r}=(e=>{const t=u.current;if(!t)return{x:0,y:0};const n=t.getBoundingClientRect();let a=e.clientX-n.left,r=e.clientY-n.top;return a>n.width&&(a=n.width-.1),a<0&&(a=0),r>n.height&&(r=n.height),r<0&&(r=.1),a-=s.CURSOR_SIZE/2,r-=s.CURSOR_SIZE/2,{x:a,y:r}})(e),o=(e=>{const t=u.current;if(!t)return new i.Color(0,0,0);const n=e.x+s.CURSOR_SIZE/2,a=e.y+s.CURSOR_SIZE/2,r=t.getContext("2d").getImageData(n,a,1,1).data;return new i.Color(r[0],r[1],r[2])})({x:n,y:r});m(o),a(o)};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("canvas",{width:s.CONTAINER_WIDTH,height:s.CANVAS_HEIGHT,className:o.default.canvas,ref:u,onMouseDown:e=>{g(e,!0)},onMouseMove:e=>{h&&(e.stopPropagation(),e.preventDefault(),g(e))},onMouseUp:e=>{g(e,!1)}}),(0,c.jsx)("div",{className:o.default.cursor,style:{width:s.CURSOR_SIZE,height:s.CURSOR_SIZE,left:p.x,top:p.y,backgroundColor:t.toRgbaString()}})]})};var r=n(67294),i=n(16241),o=a(n(50889)),s=n(98254),l=n(73473),d=a(n(88857)),c=n(85893)},98254:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.THROTTLE_WAIT_TIME=t.INPUT_HEIGHT=t.DEFAULT_COLOR=t.CURSOR_SIZE=t.CONTAINER_WIDTH=t.CONTAINER_HEIGHT=t.CANVAS_HEIGHT=void 0;var a=n(16241);t.CONTAINER_WIDTH=334;t.CONTAINER_HEIGHT=203;const r=150.22;t.CANVAS_HEIGHT=r;t.INPUT_HEIGHT=52.78;t.CURSOR_SIZE=20;const i=new a.Color(210,252,86);t.DEFAULT_COLOR=i;t.THROTTLE_WAIT_TIME=900},29598:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{selectedColor:t,onColorSelect:n}=e,[a,c]=(0,r.useState)(null!=t?t:s.DEFAULT_COLOR),u=e=>{c(e)},h=e=>{n(e)};return(0,d.jsxs)("div",{className:l.default.container,style:{width:s.CONTAINER_WIDTH,height:s.CONTAINER_HEIGHT},children:[(0,d.jsx)(o.default,{color:a,onChangeCanvasColor:u,onChangeSelectedColor:h}),(0,d.jsx)(i.default,{color:a,onChangeColor:e=>{u(e),h(e)},onColorPickerClose:e.onColorPickerClose})]})};var r=n(67294),i=a(n(60753)),o=a(n(26162)),s=n(98254),l=a(n(34618)),d=n(85893)},30383:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.CropRotateToolbar=function(e){let{canReset:t,onRotateCanvas:n,onReset:a}=e;return(0,l.jsxs)(s.FlexRow,{className:o.default.container,children:[(0,l.jsx)(i.default,{className:o.default.rotateLeftButton,icon:"media-editor-rotate-left",title:r.fbt._("Rotate left",null,{hk:"2t86bC"}),onClick:()=>n(-90)}),(0,l.jsx)(i.default,{icon:"media-editor-rotate-right",title:r.fbt._("Rotate right",null,{hk:"XqQCf"}),onClick:()=>n(90)}),(0,l.jsx)(i.default,{onClick:a,disabled:!t,children:r.fbt._("Reset",null,{hk:"1aUuOP"})})]})};var r=n(48360),i=a(n(88262)),o=a(n(52418)),s=n(29623),l=n(85893)},66747:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.Font=void 0;var r=a(n(81109)),i=n(67294),o=a(n(88262)),s=n(29623),l=a(n(43384)),d=a(n(79563)),c=n(39581),u=n(18644),h=a(n(24717)),f=a(n(41956)),p=n(85893);function m(e,t){const{selectedFont:n,fonts:a,onFontSelect:r,onAlignmentSelect:s,selectedAlignment:m}=e,g=(0,i.useRef)(null),[_,x]=(0,i.useState)(null),C=()=>{x(null)},y=()=>Boolean(_);(0,i.useImperativeHandle)(t,(()=>({isMenuVisible:y})));const S=Boolean(_);let j;return _&&(j=(0,p.jsx)(u.UIE,{displayName:"MediaEditorFontDropdown",escapable:!0,popable:!0,requestDismiss:C,children:(0,p.jsx)(h.default,{contextMenu:_})})),(0,p.jsxs)("div",{ref:g,className:l.default.container,children:[(0,p.jsx)(o.default,{onClick:()=>{_||g.current&&x({menu:(0,p.jsx)(d.default,{fonts:a,selectedFont:n,selectedAlignment:m,onFontSelect:r,onAlignmentSelect:s}),anchor:g.current})},icon:(0,p.jsx)(v,{font:n}),selected:S,caret:S?"down":"up",children:(0,p.jsx)("span",{className:l.default.fontLabel,children:(0,c.getFontTranslation)(n)})}),(0,p.jsx)(f.default,{transitionName:"dropdown",children:j})]})}const g=(0,i.forwardRef)(m);function v(e){let{font:t}=e;return(0,p.jsx)(s.FlexRow,{className:l.default.icon,style:(0,r.default)({},(0,c.getFontStyle)(t)),justify:"center",align:"center",children:(0,p.jsx)("div",{"aria-hidden":"true",children:"A"})})}t.Font=g},79563:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{onFontSelect:t,onAlignmentSelect:n,selectedFont:a,selectedAlignment:p}=e;(0,i.useEffect)((()=>{d.default.loadAllFonts()}),[]);return(0,h.jsxs)("div",{children:[e.fonts.map((e=>{let n;a===e&&(n=(0,h.jsx)("span",{className:l.default.selected,children:(0,h.jsx)(u.default,{name:"checkmark",display:"inline"})}));const r=(0,c.getFontTranslation)(e);let i;switch(e){case c.FONTS.SANS_SERIF:i=l.default.sansSerif;break;case c.FONTS.SERIF:i=l.default.serif;break;case c.FONTS.NORICAN_REGULAR:i=l.default.noricanRegular;break;case c.FONTS.BRYNDAN_WRITE:i=l.default.bryndanWrite;break;case c.FONTS.OSWALD_HEAVY:i=l.default.oswaldHeavy}return(0,h.jsx)(o.DropdownItem,{action:n=>((e,n)=>{e.stopPropagation(),t(n)})(n,e),children:(0,h.jsxs)("div",{role:"button",className:l.default.item,style:(0,c.getFontStyle)(e),children:[(0,h.jsx)("span",{className:i,children:r}),n]})},e)})),(0,h.jsx)(s.FlexRow,{className:l.default.alignmentContainer,justify:"around",align:"center",children:f.map((e=>{let{alignment:t,icon:a}=e;return(0,h.jsx)(s.FlexItem,{children:(0,h.jsx)(o.DropdownItem,{action:e=>((e,t)=>{e.stopPropagation(),n(t)})(e,t),children:(0,h.jsx)(u.default,{name:a,className:(0,r.default)(l.default.alignmentIcon,{[l.default.alignmentIconSelected]:t===p})})})},a)}))},"alignment")]})};var r=a(n(94184)),i=n(67294),o=n(71174),s=n(29623),l=a(n(16702)),d=a(n(10483)),c=n(39581),u=a(n(23217)),h=n(85893);const f=[{alignment:c.TextAlignment.LEFT,icon:"align-left"},{alignment:c.TextAlignment.CENTER,icon:"align-center"},{alignment:c.TextAlignment.RIGHT,icon:"align-right"}]},54277:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){let{selectedLayer:t,inPaintMode:n,inCropRotateMode:a,inTextEditingMode:x,inOutlineMode:C,canUndo:y,canRedo:S,onPaintSelect:j,onCropRotateSelect:b,onTextSelect:E,onEmojiSelect:k,onToggleEmojiPanel:I,onStickerSelect:w,onToggleStickerPanel:T,onOutlineSelect:P,onUndo:M,onRedo:L,showOutline:O}=e;const[A,D]=(0,i.useState)(),[R,N]=(0,i.useState)(),F=(0,i.useRef)({});F.current={inPaintMode:n,onEmojiSelect:k,onStickerSelect:w,onPaintSelect:j};const B=()=>{a?b():n?j():C&&P()},U=()=>{D(null),I(!1)},H=()=>{N(null),T(!1)};return(0,_.jsxs)(u.MenuBar,{theme:"media-editor",children:[O&&(0,_.jsx)(u.MenuBarItem,{icon:(0,_.jsx)(p.default,{name:"scissors"}),a8nText:"outline-button",title:r.fbt._("Outline",null,{hk:"47JwiV"}),onClick:e=>{e.preventDefault(),C||B(),P()},selected:C},"outline"),(0,_.jsx)(u.MenuBarItem,{icon:(0,_.jsx)(p.default,{name:"media-editor-emoji"}),a8nText:"emoji-button",title:r.fbt._("Emoji",null,{hk:"3f1gtD"}),onClick:e=>{e.preventDefault(),e.stopPropagation(),B();const t=(0,_.jsx)(s.EmojiPanel,{onEmoji:e=>{F.current.inPaintMode&&F.current.onPaintSelect(),F.current.onEmojiSelect(e),U()},onFocusNext:U,onFocusPrev:U});D({menu:t,dirY:o.DirY.TOP,type:"emoji_picker",anchor:e.target}),I(!0)},selected:Boolean(A)||t instanceof d.ImageLayer&&t.isEmoji()},"emoji"),(0,_.jsx)(u.MenuBarItem,{icon:(0,_.jsx)(p.default,{name:"media-editor-sticker"}),a8nText:"sticker-button",title:r.fbt._("Sticker",null,{hk:"4342bb"}),onClick:e=>{e.preventDefault(),e.stopPropagation(),B();const t=e=>{F.current.inPaintMode&&F.current.onPaintSelect(),F.current.onStickerSelect(e),H()};let n;l.GK.supportsFeature(l.GK.F.MD_BACKEND)?h.ServerProps.webServerStickerPanel&&(n=(0,_.jsx)(c.default,{onSticker:t,onFocusNext:H,onFocusPrev:H})):n=(0,_.jsx)(f.default,{onSticker:t,onFocusNext:H,onFocusPrev:H}),n&&(N({menu:n,dirY:o.DirY.TOP,type:"sticker_picker",anchor:e.target}),T(!0))},selected:Boolean(R)||t instanceof d.ImageLayer&&t.isSticker()},"sticker"),(0,_.jsx)(u.MenuBarItem,{icon:(0,_.jsx)(p.default,{name:"media-editor-text"}),a8nText:"text-button",title:r.fbt._("Text",null,{hk:"12XnGO"}),onClick:e=>{e.preventDefault(),B(),E()},selected:x||t instanceof m.TextLayer},"text"),(0,_.jsx)(u.MenuBarItem,{icon:(0,_.jsx)(p.default,{name:"media-editor-drawing"}),a8nText:"paint-button",title:r.fbt._("Paint",null,{hk:"U5v5P"}),onClick:e=>{e.preventDefault(),n||B(),j()},selected:n},"paint"),(0,_.jsx)(u.MenuBarItem,{icon:(0,_.jsx)(p.default,{name:"media-editor-crop-rotate"}),a8nText:"crop-rotate-button",title:r.fbt._("Crop & Rotate",null,{hk:"3WqVhk"}),onClick:e=>{e.preventDefault(),a||B(),b()},selected:a},"crop-rotate"),(0,_.jsx)(u.MenuBarItem,{icon:(0,_.jsx)(p.default,{name:"media-editor-undo"}),a8nText:"undo-button",title:r.fbt._("Undo",null,{hk:"12qsD9"}),disabled:!y,onClick:M},"undo"),(0,_.jsx)(u.MenuBarItem,{icon:(0,_.jsx)(p.default,{name:"media-editor-redo"}),a8nText:"redo-button",title:r.fbt._("Redo",null,{hk:"39SiUc"}),disabled:!S,onClick:L},"redo"),R&&(0,_.jsx)(g.UIE,{displayName:"StickerPicker",escapable:!0,popable:!0,requestDismiss:H,children:(0,_.jsx)(v.default,{contextMenu:R})}),A&&(0,_.jsx)(g.UIE,{displayName:"EmojiPicker",escapable:!0,popable:!0,requestDismiss:U,children:(0,_.jsx)(v.default,{contextMenu:A})})]})};var r=n(48360),i=n(67294),o=n(60811),s=n(30424),l=n(7293),d=n(39989),c=a(n(7380)),u=n(46346),h=n(64551),f=a(n(64894)),p=a(n(23217)),m=n(81829),g=n(18644),v=a(n(24717)),_=n(85893)},5807:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.OutlineToolbar=function(e){let{smoothing:t,onSmoothingToggle:n,canReset:a,onReset:c}=e;return(0,l.jsxs)(s.FlexRow,{children:[(0,l.jsx)(o.default,{className:(0,i.default)(d),icon:"outline-smooth",title:r.fbt._("Smooth",null,{hk:"4vwxxi"}),selected:t,onClick:()=>n(!0)}),(0,l.jsx)(o.default,{className:(0,i.default)(d),icon:"outline-straight",title:r.fbt._("Straight",null,{hk:"3KyC8d"}),selected:!t,onClick:()=>n(!1)}),(0,l.jsx)(o.default,{className:(0,i.default)(d),onClick:c,disabled:!a,children:r.fbt._("Reset",null,{hk:"1aUuOP"})})]})};var r=n(48360),i=a(n(56720)),o=a(n(88262)),s=n(29623),l=n(85893);const d={marginTop:"tt8xd2xn",marginEnd:"bugiwsl0",marginBottom:"mpdn4nr2",marginStart:"fooq7fky"}},77268:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){let{checked:t,onBackgroundToggle:n}=e;const a=(0,d.jsx)("div",{className:(0,r.default)(l.default.cirle,{[l.default.circleFilled]:t}),children:t?(0,d.jsx)("div",{className:l.default.checked,children:(0,d.jsx)(s.default,{name:"checkmark"})}):(0,d.jsx)("div",{className:l.default.unchecked})});return(0,d.jsx)(o.default,{icon:a,onClick:n,children:i.fbt._("Background",null,{hk:"3Y8odq"})})};var r=a(n(94184)),i=n(48360),o=a(n(88262)),s=a(n(23217)),l=a(n(89046)),d=n(85893)},9165:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const t=e.thicknesses.map(((t,n)=>(0,s.jsx)(l,{thickness:t,onThicknessSelect:e.onThicknessSelect,selectedThickness:e.selectedThickness},n)));return(0,s.jsx)("div",{className:i.default.container,children:t})};var r=a(n(94184)),i=a(n(60349)),o=n(54274),s=n(85893);function l(e){return(0,s.jsx)("div",{onClick:()=>e.onThicknessSelect(e.thickness),className:(0,r.default)(i.default.thicknessButton,{[i.default.selected]:e.selectedThickness&&e.selectedThickness===e.thickness}),children:(0,s.jsx)("div",{className:i.default.thicknessChip,style:{height:(0,o.getThicknessValue)(e.thickness),width:(0,o.getThicknessValue)(e.thickness)}})},e.thickness.toString())}},73473:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getPositionFromColor=function(e){const t=e.toHsl(),n=a.CONTAINER_WIDTH*t.hue-a.CURSOR_SIZE/2,r=a.CANVAS_HEIGHT*(1-t.lightness)-a.CURSOR_SIZE/2;return{x:n,y:r}};var a=n(98254)},91788:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.getPointFromGroup=function(e){return new r.default({x:e.target.x()-e.target.offsetX(),y:e.target.y()-e.target.offsetY()})},t.getPointFromStage=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!t)return new r.default({x:0,y:0});const{x:a,y:i}=t.getAbsoluteScale(),o=t.content.getBoundingClientRect();let s=e.clientX-o.left,l=e.clientY-o.top;n&&(s=Math.min(Math.max(0,s),o.width),l=Math.min(Math.max(0,l),o.height));return new r.default({x:s/a,y:l/i})},t.getRotationFromGroup=function(e){return e.target.rotation()},t.getScaleFromGroup=function(e){return e.target.scaleX()},t.isEventOnAnchor=function(e){var t,n;return null!==(t=null===(n=e.target.attrs.name)||void 0===n?void 0:n.includes("anchor"))&&void 0!==t&&t},t.isStageCorner=function(e,t){if(!t)return!1;const{x:n,y:a}=t.getAbsoluteScale(),{width:r,height:i}=t.content.getBoundingClientRect();return 0===e.x&&0===e.y||0===e.x&&e.y===i/a||e.x===r/n&&0===e.y||e.x===r/n&&e.y===i/a};var r=a(n(16186))},99282:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"Circle",{enumerable:!0,get:function(){return a.Circle}}),Object.defineProperty(t,"Group",{enumerable:!0,get:function(){return a.Group}}),Object.defineProperty(t,"Image",{enumerable:!0,get:function(){return a.Image}}),Object.defineProperty(t,"Layer",{enumerable:!0,get:function(){return a.Layer}}),Object.defineProperty(t,"Line",{enumerable:!0,get:function(){return a.Line}}),Object.defineProperty(t,"Path",{enumerable:!0,get:function(){return a.Path}}),Object.defineProperty(t,"Rect",{enumerable:!0,get:function(){return a.Rect}}),Object.defineProperty(t,"Stage",{enumerable:!0,get:function(){return a.Stage}}),Object.defineProperty(t,"Text",{enumerable:!0,get:function(){return a.Text}}),Object.defineProperty(t,"Transformer",{enumerable:!0,get:function(){return a.Transformer}});var a=n(77201);n(7643),n(71298),n(27149),n(87339),n(75244),n(23787),n(29516)},79230:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.calculateContainScale=function(e,t,n,a){if(0===e||0===t)return 1;if(!n.isEmpty()&&(e>n.width||t>n.height))return Math.min(n.width/e,n.height/t);if(!a.isEmpty()&&e<a.width&&t<a.height)return Math.min(a.width/e,a.height/t);return 1}},74252:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){let{mimeType:t,url:n}=e;return(0,i.jsx)("div",{className:r.default.container,"data-animate-attach-media":!0,children:(0,i.jsx)("div",{className:r.default.media,children:(0,i.jsx)("audio",{controls:!0,type:t,src:n})})})};var r=a(n(77046)),i=n(85893)},39414:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t,n;let{mimeType:a,filename:l}=e;const d=(0,r.default)(i.default.icon,null!==(t=null===(n=o.DOCUMENT_MIMETYPES[a])||void 0===n?void 0:n.icon)&&void 0!==t?t:"icon-doc-generic");return(0,s.jsx)("div",{className:i.default.container,"data-animate-attach-media":!0,children:(0,s.jsx)("div",{className:i.default.media,children:(0,s.jsxs)("div",{className:i.default.document,children:[(0,s.jsx)("div",{className:d}),(0,s.jsx)("div",{className:i.default.text,children:l})]})})})};var r=a(n(94184)),i=a(n(71003)),o=n(43257),s=n(85893)},84124:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){let t,{mimeType:n,url:a,isGif:i,size:d,processing:m,preview:g}=e;switch(p[n].msgType){case"image":t=(0,f.jsx)("img",{alt:l.default.t(986),src:a,className:s.default.img});break;case"video":const e=i?{loop:!m,autoPlay:!m,muted:!1,controls:!1}:{},d=m?(0,f.jsx)("div",{className:s.default.spinner,children:(0,f.jsx)(u.Spinner,{color:u.colorOptions.white,size:50,stroke:3})}):null,c=g?(0,f.jsx)("img",{alt:l.default.t(986),className:s.default.staticPreview,src:`data:image/jpeg;base64,${g}`}):null,p=m?null:(0,f.jsx)(h.default,(0,r.default)((0,r.default)({controls:!0,controlsList:"nodownload nofullscreen",className:s.default.video},e),{},{src:a}));t=(0,f.jsxs)("div",{className:(0,o.default)(s.default.img,s.default.videoContainer),children:[d,p,c]});break;case"audio":t=(0,f.jsx)("audio",{controls:!0,className:s.default.audio,type:n,src:a})}return(0,f.jsx)("div",{className:s.default.container,"data-animate-attach-media":!0,children:(0,f.jsx)("div",{className:s.default.media,children:(0,f.jsx)(c.default,{type:"scaleDown",size:d,children:t})})})};var r=a(n(81109)),i=a(n(35937)),o=a(n(94184)),s=a(n(58523)),l=a(n(43725)),d=n(43257),c=a(n(11791)),u=n(11054),h=a(n(23425)),f=n(85893);const p=(0,i.default)(d.MIMETYPES,(e=>"image"===(null==e?void 0:e.msgType)||"video"===(null==e?void 0:e.msgType)))},35137:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){let{fullPreview:t,fullPreviewSize:n,pageCount:a,mimeType:c,filename:u,showPageCount:h=!0,showBorder:f=!1}=e;if(t&&n&&null!=a&&a>0){const e=s.default.t(146,{count:a,_plural:a});return(0,d.jsxs)("div",{className:o.default.container,"data-js-attach-preview":!0,children:[(0,d.jsx)("div",{className:o.default.preview,children:(0,d.jsx)(l.default,{type:"scaleDown",size:n,children:(0,d.jsx)("img",{alt:s.default.t(986),src:t,className:(0,r.default)(o.default.img,{[o.default.imgBorder]:f})})})}),h&&(0,d.jsx)("div",{className:o.default.caption,children:e})]})}return(0,d.jsx)(i.default,{mimeType:c,filename:u})};var r=a(n(94184)),i=a(n(39414)),o=a(n(53519)),s=a(n(43725)),l=a(n(11791)),d=n(85893)},75680:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){let{disabled:t,isOn:n,mediaType:a,onChange:v,noMargin:_}=e;const[x,C]=(0,p.default)(c.NUX.EPHEMERAL_VIEW_ONCE,1);return(0,s.useEffect)((()=>{if(!n)return;if(x){const e=(0,m.jsx)(l.default,{onOkClick:()=>{C(),d.Cmd.closeModal()}});return void d.Cmd.openModal(e)}const e=a===i.MSG_TYPE.VIDEO?o.fbt._("Video set to view once",null,{hk:"2L7ZJW"}):o.fbt._("Photo set to view once",null,{hk:"1jN7IR"}),t=(0,m.jsx)(h.Toast,{msg:e,id:(0,h.genId)("view-once-toast")});return d.Cmd.openToast(t),()=>{d.Cmd.closeToast(t)}}),[x,C,a,n]),(0,m.jsx)(f.default,{a8nText:r.default.key("view-once-toggle"),xstyle:[g.btnViewOnce,_&&g.btnNoMargin,t&&g.btnDisabled],disabled:t,onClick:()=>v(!n),"aria-pressed":n,children:(0,m.jsx)(u.default,{"aria-label":n?o.fbt._("Turn off view once",null,{hk:"3cl8Dn"}):o.fbt._("Turn on view once",null,{hk:"3pd2lD"}),name:n?"view-once-media-select-on":"view-once-media-select",height:26,width:26})})};var r=a(n(99964)),i=n(15461),o=n(48360),s=n(67294),l=(a(n(56720)),a(n(22594))),d=n(88102),c=n(61653),u=a(n(23217)),h=n(50452),f=a(n(1784)),p=a(n(54416)),m=n(85893);const g={btnViewOnce:{display:"f804f6gw",marginTop:"c46o30wg",marginEnd:"bugiwsl0",marginStart:"eab7llgz",color:"svlsagor"},btnNoMargin:{marginTop:"tt8xd2xn",marginEnd:"jnwc1y2a",marginBottom:"mpdn4nr2",marginStart:"svoq16ka"},btnDisabled:{cursor:"h2qzpyga",opacity:"notw83rv"}}},22594:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{onOkClick:t}=e;return(0,f.jsx)(o.default,{onOK:t,cancelText:c.default.t(554),onCancel:()=>{(0,s.openExternalLink)((0,l.getViewOnceFaqUrl)())},children:(0,f.jsxs)(d.FlexColumn,{children:[(0,f.jsx)(d.FlexItem,{xstyle:p.graphic,align:"center",children:(0,f.jsx)(u.default,{name:"view-once-sender-nux",width:195,height:177})}),(0,f.jsx)(h.TextHeader,{className:(0,i.default)(p.text),theme:"popup-title",children:r.fbt._("Send photos and videos that can be viewed only once",null,{hk:"t5MUO"})}),(0,f.jsx)(h.TextParagraph,{className:(0,i.default)(p.text),color:"secondary",children:r.fbt._("For more privacy, your photo or video will disappear from the chat after the recipient opens it once. Remember, people can always take screenshots.",null,{hk:"Y4e8s"})})]})})};var r=n(48360),i=a(n(56720)),o=a(n(52665)),s=n(12591),l=n(96384),d=n(29623),c=a(n(43725)),u=a(n(23217)),h=n(13923),f=n(85893);const p={text:{marginBottom:"or9x5nie"},graphic:{marginBottom:"t4zgqcuo"}}},72758:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){const[e,t]=(0,l.default)(i.getAutoDownloadPhotos,i.setAutoDownloadPhotos),[n,a]=(0,l.default)(i.getAutoDownloadAudio,i.setAutoDownloadAudio),[c,u]=(0,l.default)(i.getAutoDownloadVideos,i.setAutoDownloadVideos),[h,f]=(0,l.default)(i.getAutoDownloadDocuments,i.setAutoDownloadDocuments);return(0,d.jsxs)(o.SettingsCheckList,{children:[(0,d.jsx)(o.SettingsCheckListItem,{a8nText:"option-photos",id:"photos",checked:e,onChange:t,children:r.fbt._("Photos",null,{hk:"4wPArA"})}),(0,d.jsx)(o.SettingsCheckListItem,{a8nText:"option-audio",id:"audio",checked:n,onChange:a,children:r.fbt._("Audio",null,{hk:"eXaYA"})}),(0,d.jsx)(o.SettingsCheckListItem,{a8nText:"option-videos",id:"videos",checked:c,onChange:u,children:r.fbt._("Videos",null,{hk:"4yB3QY"})}),(0,d.jsx)(o.SettingsCheckListItem,{a8nText:"option-documents",id:"documents",checked:h,onChange:f,children:r.fbt._("Documents",null,{hk:"1UBrPi"})}),(0,d.jsx)(o.SettingsCheckListSection,{children:(0,d.jsx)(s.TextDiv,{theme:"muted",children:r.fbt._("Voice Messages are always automatically downloaded for the best communication experience",null,{hk:"jmuCZ"})})})]})};var r=n(48360),i=n(99234),o=n(40015),s=n(13923),l=a(n(152)),d=n(85893)},10403:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{labelId:t,onAddLabel:n,onUpdateLabel:a,onCancel:x}=e,C=(0,v.default)((()=>t?c.LabelCollection.assertGet(t):void 0)),[y,S]=(0,i.useState)((()=>{var e;return(null===(e=C.current)||void 0===e?void 0:e.color)||void 0})),[j,b]=(0,i.useState)((()=>{var e;return(null===(e=C.current)||void 0===e?void 0:e.name)||""})),[E,k]=(0,i.useState)(void 0),I=e=>{let t=!0,n=null;return e&&""!==e.trim()||(t=!1),C.current&&C.current.name===e||0===c.LabelCollection.where({name:e}).length||(t=!1,n=r.fbt._("Label name already exists",null,{hk:"3du3mm"})),{passed:t,error:n}};(0,i.useEffect)((()=>{n?(c.LabelCollection.getNewLabelColor().then((e=>{S(e||"#d6d7d7")})),(0,h.logLabelOperationEvent)(p.default.LABEL_OPERATIONS.VIEW,1,p.default.LABEL_TARGETS.ADD_LABEL_DIALOG)):a&&(0,h.logLabelOperationEvent)(p.default.LABEL_OPERATIONS.VIEW,1,p.default.LABEL_TARGETS.EDIT_LABEL_DIALOG)}),[]);const w=()=>{if(E)return;(0,h.logLabelOperationEvent)(p.default.LABEL_OPERATIONS.CLICK_POSITIVE,1,n?p.default.LABEL_TARGETS.ADD_LABEL_DIALOG:p.default.LABEL_TARGETS.EDIT_LABEL_DIALOG);const e=j&&j.trim(),r=I(e||"");r.passed?(t&&a?a({id:t,color:y,name:j},u.LABEL_PROPERTIES.NAME):n&&n(j||"",y),x?x():s.Cmd.closeModal()):k(r.error)},T=!I(j.trim()).passed;return(0,_.jsx)(l.default,{title:e.onUpdateLabel?r.fbt._("Edit label",null,{hk:"3QX44B"}):r.fbt._("Add new label",null,{hk:"2JFfTv"}),okText:r.fbt._("OK",null,{hk:"2KEeHb"}),onOK:w,okDisabled:T,onCancel:()=>{(0,h.logLabelOperationEvent)(p.default.LABEL_OPERATIONS.CLICK_NEGATIVE,1,n?p.default.LABEL_TARGETS.ADD_LABEL_DIALOG:p.default.LABEL_TARGETS.EDIT_LABEL_DIALOG),x?x():s.Cmd.closeModal()},children:(0,_.jsxs)("div",{className:o.default.inputContainer,children:[(0,_.jsx)("div",{className:o.default.label,children:y?(0,f.renderLabelSvg)((0,d.intColorToHex)(y)):(0,_.jsx)(m.Spinner,{stroke:5,size:20})}),(0,_.jsx)("div",{className:o.default.input,children:(0,_.jsx)(g.TextInput,{a8n:"add-new-label-name-input",focusOnMount:!0,hideFloatingLabel:!0,showRemaining:!0,supportsEmoji:!0,value:j,error:E,maxLength:100,onChange:e=>{const t=I(e);b(e),k(t.passed?void 0:t.error)},onEnter:e=>{e.stopPropagation(),w()},placeholder:r.fbt._("New label",null,{hk:"33ueym"})})})]})})};var r=n(48360),i=n(67294),o=a(n(10160)),s=n(88102),l=a(n(52665)),d=n(8803),c=n(16770),u=n(59846),h=n(50047),f=n(84543),p=a(n(11339)),m=n(11054),g=n(90011),v=a(n(59552)),_=n(85893)},43318:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{product:t,sessionId:n}=e,[a,y]=(0,s.useState)(!1),[S,j]=(0,s.useState)(!1),[b,E]=(0,s.useState)(""),k=()=>{l.Cmd.closeModal()};if(S)return(0,C.jsx)(d.default,{title:o.fbt._("Request review",null,{hk:"1Rp2pL"}),onOK:k,children:(0,C.jsx)(g.TextDiv,{children:o.fbt._("We will review the item and if it meets our guidelines, it will be added to your catalog.",null,{hk:"4tmhbu"})})});const I=b.length<1||a;return(0,C.jsx)(d.default,{title:o.fbt._("Request review",null,{hk:"1Rp2pL"}),onOK:()=>{(0,u.logAppealProductCatalogClick)(n),y(!0);let e=!0;p.QPL.markerStart(m.QuickLogMarkerId.WHATSAPP_PRODUCT_APPEAL),(0,h.appealProduct)(t.id.toString(),b).then((()=>{t.canAppeal=!1,t.reviewStatus=f.PRODUCT_REVIEW_STATUS.PENDING,(0,u.logAppealProductCatalogSuccess)(n),y(!1),j(!0),e=!1,p.QPL.markerEnd(m.QuickLogMarkerId.WHATSAPP_PRODUCT_APPEAL,p.QuickLogActionType.SUCCESS)})).catch((0,r.filteredCatch)(x.ServerStatusCodeError,(e=>{l.Cmd.openToast((0,C.jsx)(_.Toast,{msg:o.fbt._("Failed to send review request.",null,{hk:"1MNBtG"}),id:(0,_.genId)("catalog_appeal_submission_failed")})),(0,u.logAppealProductCatalogFailed)(n,e.status),y(!1)}))).finally((()=>{e&&p.QPL.markerEnd(m.QuickLogMarkerId.WHATSAPP_PRODUCT_APPEAL,p.QuickLogActionType.FAIL)}))},onCancel:k,okDisabled:I,children:(0,C.jsxs)("form",{children:[(0,C.jsx)(v.TextInput,{a8n:"confirm-popup-text-input",placeholder:o.fbt._("Enter reason for this request...",null,{hk:"49sHMz"}),onChange:e=>{E(e)},value:b,maxLength:1e3}),(0,C.jsx)(c.ExternalLink,{href:i.default.WA_COMMERCE_POLICY_URL,children:o.fbt._("Learn more",null,{hk:"2S4fxr"})})]})})};var r=n(50796),i=a(n(64369)),o=n(48360),s=n(67294),l=n(88102),d=a(n(52665)),c=n(12591),u=n(77975),h=n(96519),f=n(5641),p=n(48870),m=n(27798),g=n(13923),v=n(90011),_=n(50452),x=n(77591),C=n(85893)},22635:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(48360),i=n(88102),o=n(27105),s=a(n(52665)),l=n(85893);var d=()=>{i.Cmd.openModal((0,l.jsx)(s.default,{okText:r.fbt._("OK",null,{hk:"2KEeHb"}),onOK:()=>i.Cmd.closeModal(),children:(0,l.jsx)(o.ComplianceInfoHelpCenterBanner,{})}))};t.default=d},48517:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(48360),i=n(88102),o=a(n(52665)),s=n(85893);var l=e=>{i.Cmd.openModal((0,s.jsx)(o.default,{title:r.fbt._("Information accuracy",null,{hk:"1IkKdC"}),okText:r.fbt._("OK",null,{hk:"2KEeHb"}),onOK:()=>{null==e||e(),i.Cmd.closeModal()},cancelText:r.fbt._("Go back",null,{hk:"3k17TN"}),onCancel:()=>i.Cmd.closeModal(),children:(0,s.jsxs)(s.Fragment,{children:[r.fbt._("By continuing, you confirm that all information you have provided is correct and current.",null,{hk:"3VB7Ib"}),(0,s.jsx)("br",{}),(0,s.jsx)("br",{}),r.fbt._("You are required by law to update this info on WhatsApp if it ever changes.",null,{hk:"3FF6ZU"})]})}))};t.default=l},76419:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t;const n=(0,_.default)(),[a,i]=(0,s.useState)(null===(t=h.LabelCollection.labelColorPalette)||void 0===t?void 0:t.colors),u=(0,s.useRef)(null);(0,s.useEffect)((()=>((0,m.default)(h.LabelCollection.getLabelColorPalette(),n).then((e=>{i(e)})).catch((0,r.catchAbort)((()=>{}))),()=>{var e;null===(e=u.current)||void 0===e||e.cancel()})),[]);let p=(0,x.jsx)(g.Spinner,{stroke:6,size:24});a&&(p=(0,x.jsx)(y,{labelId:e.labelId,onBack:e.onClose,onUpdateColor:e.onUpdateColor,colors:a,currentColor:e.currentColor}));return(0,x.jsxs)(l.default,{children:[(0,x.jsx)(c.DrawerHeader,{title:o.fbt._("Choose color",null,{hk:"16haXO"}),onBack:e.onClose,type:c.DRAWER_HEADER_TYPE.LARGE}),(0,x.jsx)(d.default,{children:(0,x.jsx)("div",{className:f.default.container,children:p})})]})};var r=n(89385),i=a(n(94184)),o=n(48360),s=n(67294),l=a(n(60453)),d=a(n(69637)),c=n(94790),u=n(8803),h=n(16770),f=a(n(56126)),p=n(59846),m=a(n(84644)),g=n(11054),v=a(n(23217)),_=a(n(38080)),x=n(85893);function C(e){const{onUpdateColor:t,labelId:n,colorInt:a,onBack:r}=e,[o,l]=(0,s.useState)(!1),d=e.isSelected?(0,x.jsx)(v.default,{name:"checkmark-medium"}):null,c=()=>{o||l(!0)},h=(0,i.default)(f.default.wallpaperColorCanvas,{[f.default.canvasHover]:o,[f.default.canvasActive]:e.isSelected});return(0,x.jsx)("span",{className:h,style:{backgroundColor:(0,u.intColorToHex)(e.colorInt)},onMouseOver:c,onMouseEnter:c,onMouseLeave:()=>{o&&l(!1)},onClick:()=>{t({id:n,color:a},p.LABEL_PROPERTIES.COLOR),r()},children:d})}function y(e){const{currentColor:t,colors:n}=e,a=n.map((n=>(0,x.jsx)(C,{onUpdateColor:e.onUpdateColor,colorInt:n,onBack:e.onBack,labelId:e.labelId,isSelected:t===n},n)));for(let e=0;e<2;e++)a.push((0,x.jsx)("div",{className:f.default.wallpaperColorEmpty},"emptyEl"+e));return a}},19446:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{onDeleteLabel:t}=e,[n,a]=(0,o.useState)(0),j=(0,y.default)((()=>new r.default([],(e=>e.id))));(0,o.useEffect)((()=>{(0,m.logLabelOperationEvent)(g.default.LABEL_OPERATIONS.VIEW,void 0,g.default.LABEL_TARGETS.LABELS_SCREEN)}),[]);const b=()=>{const e=j.current.getSelected();(0,m.logLabelOperationEvent)(g.default.LABEL_OPERATIONS.VIEW,e.length,g.default.LABEL_TARGETS.DELETE_LABEL_DIALOG),s.Cmd.openModal((0,S.jsx)(l.default,{okText:i.fbt._("Yes",null,{hk:"12b9aE"}),cancelText:i.fbt._("No",null,{hk:"4G38V6"}),onCancel:()=>{(0,m.logLabelOperationEvent)(g.default.LABEL_OPERATIONS.CLICK_NEGATIVE,1,g.default.LABEL_TARGETS.DELETE_LABEL_DIALOG),s.Cmd.closeModal()},onOK:()=>{(0,m.logLabelOperationEvent)(g.default.LABEL_OPERATIONS.CLICK_POSITIVE,1,g.default.LABEL_TARGETS.DELETE_LABEL_DIALOG),(e=>{s.Cmd.closeModal(),j.current.unsetAll(),t(e)})(e)},children:f.default.t(375,{_plural:e.length})}))},E=()=>{j.current.unsetAll(),a(0)};let k=null;k=n>0?(0,S.jsx)(v.default,{selectedModels:j.current,onCancel:E,onDelete:b,theme:"drawer-header"}):(0,S.jsx)(u.DrawerHeader,{title:i.fbt._("Labels",null,{hk:"t1hII"}),onBack:e.onClose,type:u.DRAWER_HEADER_TYPE.LARGE});const I=(0,h.canEditLabel)()&&(0,S.jsx)("div",{className:p.default.addLabelBtContainer,children:(0,S.jsx)(x.Round,{large:!0,onClick:e.openAddLabel,children:(0,S.jsx)(C.default,{name:"plus-large"})})});return(0,S.jsxs)(d.default,{theme:"settings",children:[k,(0,S.jsx)(c.default,{children:(0,S.jsx)(_.default,{shouldScrollIntoViewAndSelect:()=>({shouldScrollIntoView:!0,shouldSelect:!1}),selectedLabels:j.current,renderContext:"label-list",onMultiSelect:()=>{const e=j.current.getSelected().length;a(e)},onLabelClick:e.onLabelClick})}),I]})};var r=a(n(78931)),i=n(48360),o=n(67294),s=n(88102),l=a(n(52665)),d=a(n(60453)),c=a(n(69637)),u=n(94790),h=n(57701),f=a(n(43725)),p=a(n(63820)),m=n(50047),g=a(n(11339)),v=a(n(63538)),_=a(n(67901)),x=n(82857),C=a(n(23217)),y=a(n(59552)),S=n(85893)},41885:(e,t,n)=>{"use strict";var a=n(95318);t.Z=function(e){const{labelId:t,openLabelColorDrawer:n,onEditLabel:a,onRemoveLabel:f}=e,p=(0,k.default)(),m=(0,I.default)((()=>new r.default([],(e=>e.id.toString())))).current;(0,w.useListener)(m,"all",(()=>p())),(0,o.useEffect)((()=>{(0,_.logLabelOperationEvent)(y.default.LABEL_OPERATIONS.VIEW,void 0,y.default.LABEL_TARGETS.LABEL_DETAILS_SCREEN)}),[]);const C=()=>{m.unsetAll()},E=()=>{const e=m.getSelected();(0,_.logLabelOperationEvent)(y.default.LABEL_OPERATIONS.CLICK_NEGATIVE,e.length,y.default.LABEL_TARGETS.BULK_UNLABEL_DIALOG),l.Cmd.closeModal()},M=(e=>{let t,n;for(let a=0;a<e.length;a++){if(e[a]instanceof j.Msg?n=!0:t=!0,t&&n)return!0}return!1})(m.getSelected()),L=m.getSelected().length>0?(0,T.jsx)(S.default,{labelEditEnabled:!M,onRemoveLabel:()=>{const e=m.getSelected();if(!f)return;const n=v.LabelCollection.assertGet(t);(0,_.logLabelOperationEvent)(y.default.LABEL_OPERATIONS.VIEW,e.length,y.default.LABEL_TARGETS.BULK_UNLABEL_DIALOG),l.Cmd.openModal((0,T.jsx)(d.default,{title:g.default.t(719,{count:e.length,labelName:n.name,_plural:e.length}),okText:i.fbt._("OK",null,{hk:"2KEeHb"}),cancelText:i.fbt._("Cancel",null,{hk:"H0gNq"}),onCancel:E,onOK:()=>((e,t)=>{l.Cmd.closeModal(),C(),f(e,t),(0,_.logLabelOperationEvent)(y.default.LABEL_OPERATIONS.CLICK_POSITIVE,t.length,y.default.LABEL_TARGETS.BULK_UNLABEL_DIALOG)})(t,e)}))},selectedModels:m,onCancel:C,theme:"drawer-header"}):(0,T.jsx)(h.DrawerHeader,{onBack:e.onClose,menu:(0,T.jsx)(P,{openColorPicker:()=>{const e=v.LabelCollection.assertGet(t);n(t,e.color)},openEditLabel:()=>{a&&a(t)}}),type:h.DRAWER_HEADER_TYPE.LABELS,children:(0,T.jsx)(x.Labels,{labels:[e.labelId],renderAsCircle:!0,showName:!0,theme:"drawer-title"})});return(0,T.jsxs)(c.default,{theme:"settings",children:[L,(0,T.jsx)(u.default,{children:(0,T.jsx)(s.default,{hideMultiSelectBar:!0,multiSelection:m,labelFilter:e.labelId,settings:b.default,selectable:!0})})]})};var r=a(n(78931)),i=n(48360),o=n(67294),s=a(n(47488)),l=n(88102),d=a(n(52665)),c=a(n(60453)),u=a(n(69637)),h=n(94790),f=n(60811),p=n(71174),m=n(57701),g=a(n(43725)),v=n(16770),_=n(50047),x=n(84543),C=n(46346),y=a(n(11339)),S=a(n(63538)),j=n(17304),b=a(n(68132)),E=a(n(23217)),k=a(n(59909)),I=a(n(59552)),w=n(19529),T=n(85893);function P(e){let{openColorPicker:t,openEditLabel:n}=e;return(0,m.canEditLabel)()?(0,T.jsx)(C.MenuBarItem,{a8nText:"starred-menu",icon:(0,T.jsx)(E.default,{name:"menu"}),title:g.default.t(611),children:(0,T.jsxs)(f.Dropdown,{type:"dropdown_menu",flipOnRTL:!0,dirX:f.DirX.LEFT,children:[(0,T.jsx)(p.DropdownItem,{a8n:"menu-item",action:t,children:i.fbt._("Choose color",null,{hk:"16haXO"})}),(0,T.jsx)(p.DropdownItem,{a8n:"menu-item",action:n,children:i.fbt._("Edit label",null,{hk:"3QX44B"})})]},"labelChooseColor")}):null}},94981:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{modelsToUpdate:t,onLabelUpdateComplete:n}=e,a=(0,j.default)((()=>new i.default([],(e=>e.id)))),w=(0,s.useRef)(new Set),T=a.current,P=w.current,M=(0,S.default)(),L=(0,s.useMemo)((()=>{const e=(()=>{const e={};return t.forEach((t=>{const n=(0,C.unproxy)(t);n.labels&&n.labels.forEach((t=>{e[t]=e[t]?++e[t]:1}))})),e})();return(0,r.default)(e,(e=>e===t.length?k:e>0?I:E))}),[]),O=(0,b.jsx)(l.default,{a8nText:"popup-controls-ok",type:"primary",disabled:0===P.size,onClick:()=>{(0,m.logLabelOperationEvent)(v.default.LABEL_OPERATIONS.CLICK_POSITIVE,t.length,v.default.LABEL_TARGETS.LABEL_COMBINED_DIALOG);const e=T.list,a=T.selected,r=e.map(((e,t)=>({id:e.id,type:a[t]?"add":"remove"})));p.LabelCollection.addOrRemoveLabels(r,t),n&&n()},children:f.default.t(729)},1),A=(0,b.jsx)(l.default,{a8nText:"popup-controls-cancel",type:"secondary",onClick:e.onCancel,children:o.fbt._("Cancel",null,{hk:"H0gNq"})},0),D=(0,h.canEditLabel)()&&(0,b.jsx)("div",{className:g.default.newLabelBtn,children:(0,b.jsxs)(l.default,{a8nText:"popup-controls-cancel",type:"simplified",onClick:e.onAddNewLabel,children:[(0,b.jsx)(y.default,{name:"plus-large",className:g.default.plus,display:"inline"}),o.fbt._("NEW LABEL",null,{hk:"4xjp4I"})]},2)});return(0,b.jsx)(_.Modal,{type:_.ModalTheme.Tower,children:(0,b.jsxs)(d.default,{theme:"labels",children:[(0,b.jsx)(u.DrawerHeader,{title:o.fbt._("Label items",null,{hk:"2xOVMD"}),type:u.DRAWER_HEADER_TYPE.POPUP,onCancel:e.onCancel}),(0,b.jsx)(c.default,{"data-list-scroll-container":!0,theme:"padding",children:(0,b.jsx)(x.default,{shouldScrollIntoViewAndSelect:e.shouldScrollIntoViewAndSelect,initialLabelState:L,selectedLabels:T,renderContext:"label-selection",onLabelClick:e.onLabelClick,onMultiSelect:e=>{e&&(L[e]===I?P.add("{labelId}_changed"):P.has(e)?P.delete(e):P.add(e),M())}})}),D,(0,b.jsxs)("div",{className:g.default.actionBtns,children:[A,O]})]},"mange_label_modal")})};var r=a(n(66604)),i=a(n(78931)),o=n(48360),s=n(67294),l=a(n(39770)),d=a(n(60453)),c=a(n(69637)),u=n(94790),h=n(57701),f=a(n(43725)),p=n(16770),m=n(50047),g=a(n(20705)),v=a(n(11339)),_=n(57224),x=a(n(67901)),C=n(31019),y=a(n(23217)),S=a(n(59909)),j=a(n(59552)),b=n(85893);const E=0,k=1,I=2},51731:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(n(51463)),i=a(n(99964)),o=n(48360),s=n(67294),l=n(80140),d=a(n(62556)),c=n(32826),u=n(88102),h=a(n(52665)),f=n(2732),p=n(19380),m=a(n(29234)),g=a(n(60453)),v=a(n(69637)),_=a(n(64738)),x=n(94790),C=n(85600),y=n(47915),S=a(n(44942)),j=a(n(30855)),b=a(n(43725)),E=n(84387),k=a(n(23217)),I=n(85893);class w extends s.Component{constructor(){super(...arguments),this.flatListController=new j.default,this._handleBlockConfirm=e=>{(0,l.blockContact)(e).catch((()=>{})),u.Cmd.closeModal()},this.handleBlock=()=>{u.Cmd.openModal((0,I.jsx)(m.default,{title:b.default.t(136),filter:function(e){return!!p.ContactCollection.isFilteredContact(e)&&(!c.BlocklistCollection.get(e.id)||b.default.t(700))},onCancel:()=>u.Cmd.closeModal(),onSelect:(0,r.default)(this._handleBlockConfirm)}))},this._handleUnblockConfirm=e=>{(0,l.unblockContact)(e).catch((()=>{})),u.Cmd.closeModal()},this._handleUnblockCancel=()=>{u.Cmd.closeModal()},this._handleUnblock=(e,t)=>{u.Cmd.openModal((0,I.jsx)(h.default,{okText:b.default.t(788),onOK:this._handleUnblockConfirm.bind(this,t),cancelText:o.fbt._("Cancel",null,{hk:"H0gNq"}),onCancel:this._handleUnblockCancel,children:b.default.t(789,{contact:t.formattedName})}))},this.renderItem=e=>{const{blocklist:t}=e,n=t.contact();return(0,I.jsx)(f.Contact,{contact:n,onClick:this._handleUnblock,onDelete:this._handleUnblock,waitIdle:!0},n.id.toString())}}componentDidMount(){this.props.listeners.add(c.BlocklistCollection,"add remove",(()=>{this.forceUpdate()}))}getData(){return c.BlocklistCollection.map((e=>({itemKey:e.id.toString(),blocklist:e})))}render(){let e,t;return c.BlocklistCollection.length>0?(e=(0,I.jsx)(S.default,{flatListControllers:[this.flatListController],className:d.default.list,children:(0,I.jsx)(y.FlatList,{flatListController:this.flatListController,direction:"vertical",data:this.getData(),renderItem:this.renderItem})}),t=(0,I.jsx)("div",{"data-a8n":i.default.key("blocked-description"),className:d.default.hint,children:b.default.t(135)})):e=(0,I.jsx)(C.Blocked,{}),(0,I.jsxs)(g.default,{children:[(0,I.jsx)(x.DrawerHeader,{title:b.default.t(175),onBack:this.props.onClose,type:x.DRAWER_HEADER_TYPE.LARGE}),(0,I.jsx)("div",{className:d.default.button,children:(0,I.jsx)(_.default,{a8nText:"li-add-blocked",onClick:this.handleBlock,icon:(0,I.jsx)(k.default,{name:"add-user",directional:!0}),children:b.default.t(136)})}),(0,I.jsxs)(v.default,{children:[e,t]})]})}}w.displayName="BlockedDrawer";var T=(0,E.ListenerHOC)(w);t.default=T},37409:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(50796),i=a(n(45095)),o=n(57319),s=a(n(64369)),l=a(n(94184)),d=n(48360),c=n(67294),u=a(n(14075)),h=a(n(75680)),f=n(35718),p=a(n(26616)),m=n(88102),g=a(n(60453)),v=a(n(69637)),_=n(94790),x=U(n(64103)),C=n(1063),y=n(18671),S=a(n(43725)),j=n(90535),b=a(n(3028)),E=U(n(61849)),k=a(n(14500)),I=a(n(11339)),w=a(n(11791)),T=a(n(34949)),P=n(82857),M=n(64551),L=n(11054),O=a(n(23217)),A=n(2541),D=a(n(59552)),R=a(n(41956)),N=a(n(23425)),F=n(85893);function B(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(B=function(e){return e?n:t})(e)}function U(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=B(t);if(n&&n.has(e))return n.get(e);var a={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var o=r?Object.getOwnPropertyDescriptor(e,i):null;o&&(o.get||o.set)?Object.defineProperty(a,i,o):a[i]=e[i]}return a.default=e,n&&n.set(e,a),a}const H="ANIMATING",G="LOADING",W="RECORDING",V="SENDING";function z(e,t){const{chat:n,disposeStream:a,onCaptured:B,onBack:U,onSend:z}=e,q=(0,c.useRef)(null),K=(0,c.useRef)(null),Y=(0,c.useRef)(null),Q=(0,c.useRef)(null),X=(0,c.useRef)(null),[Z,J]=(0,c.useState)(void 0),[$,ee]=(0,c.useState)(void 0),[te,ne]=(0,c.useState)(!1),[ae,re]=(0,c.useState)(void 0),[ie,oe]=(0,c.useState)(H),[se,le]=(0,c.useState)(void 0),de=(e,t)=>{var n;e?(null===(n=K.current)||void 0===n||n.call(K),K.current=t,oe(G),le(e),(0,E.isSrcObjectInVideoElement)()||(e?(window.URL.revokeObjectURL(Y.current),Y.current=window.URL.createObjectURL(e)):(window.URL.revokeObjectURL(Y.current),Y.current=void 0))):ie===H&&oe(G)},ce=(0,D.default)((()=>new o.ShiftTimer((e=>{let{stream:t,disposeStream:n}=e;de(t,n)})))),ue=(0,D.default)((()=>new o.ShiftTimer((e=>{let{stream:t,disposeStream:n}=e;var a;t&&n&&(null===(a=K.current)||void 0===a||a.call(K));(0,E.isSrcObjectInVideoElement)()||(Y.current=window.URL.revokeObjectURL(Y.current))})))),he=()=>{n&&n.setAttachMediaContents(null)};(0,c.useEffect)((()=>(ce.current.onOrBefore(300,{stream:e.stream,disposeStream:e.disposeStream}),()=>{ce.current.cancel(),Y.current&&window.URL.revokeObjectURL(Y.current),null==a||a(),q.current&&q.current.logCancel(),he()})),[]);const fe=(e,t)=>{ce.current.forceRunNow({stream:e,disposeStream:t})};(0,c.useImperativeHandle)(t,(()=>({loadNewStreamTimerUpdate:fe,loadNewStream:de})));const pe=()=>{var e;const t=null===(e=X.current)||void 0===e?void 0:e.underlyingVideo();if(!t)return;const r=document.createElement("canvas");r.height=t.videoHeight,r.width=t.videoWidth;const o=r.getContext("2d");if(o)if(o.translate(r.width,0),o.scale(-1,1),o.drawImage(t,0,0,t.videoWidth,t.videoHeight),B)(0,f.canvasToBlob)(r).then((e=>{B(e)}));else{ue.current.onOrBefore(500,{stream:se,disposeStream:a});const e=new j.MediaPickerStatsLogger;e.logAdd("CAPTURE_MEDIA","image",I.default.MEDIA_PICKER_ORIGIN_TYPE.MENU_CAMERA_CAPTURE),e.chatRecipients=(null==n?void 0:n.groupMetadata)?n.groupMetadata.participants.length:1,q.current=e;const t=r.toDataURL("image/jpeg"),o=window.dataURLtoBlob(t);if(n){n.attachMediaContents||n.setAttachMediaContents(new u.default({chatParticipantCount:n.getParticipantCount()}));(0,i.default)(n.attachMediaContents,"chat.attachMediaContents").processAttachments([{file:(0,C.createFile)([o],"",{type:"image/jpeg"})}])}ee(t),oe(V),le(void 0)}else __LOG__(3)`CaptureDrawer:onCapture can not get 2d context`},me=e=>{oe(W),re({width:e.videoWidth,height:e.videoHeight})},ge=()=>{J(void 0),oe(G),he();const{asyncStream:e,disposeStream:t}=E.start("camera");K.current=t,e.then((e=>{e&&((0,E.isSrcObjectInVideoElement)()||(Y.current=window.URL.createObjectURL(e)),le(e))})).catch((0,r.filteredCatch)(x.GUM.NotAllowedError,(()=>{U(),m.Cmd.openModal((0,F.jsx)(y.GuidePopup,{messaging:y.Messaging.CAMERA_FAIL,type:y.TYPE.GUIDE_UNBLOCK}))}))).catch((0,r.filteredCatch)(x.GUM.GUMError,(()=>{U(),m.Cmd.openModal((0,F.jsx)(y.GuidePopup,{messaging:y.Messaging.CAMERA_MISSING,type:y.TYPE.GUIDE_NONE}))})))},ve=()=>{let e=Z;if(z)if($){var t,n;const a=null===(t=Q.current)||void 0===t?void 0:t.refInput;let r=[];if(Z&&a){const t=a.serialize(Z),[n,i]=[t[0].trim(),t[1]];n.length&&(e=n,r=i.mentionedJidList||[])}z({caption:e,getImg:T.default.createFromBase64Jpeg(A.URL.parseDataURL($).data),isViewOnce:te,mentionedJidList:r}),null===(n=q.current)||void 0===n||n.logSend({isViewOnce:te})}else __LOG__(4,void 0,new Error,!0)`Assertion failed!`,SEND_LOGS("capture-drawer-no-img");else __LOG__(4,void 0,new Error,!0)`Assertion failed!`,SEND_LOGS("capture-drawer-no-onSend")},_e=e=>{J(e)},xe=()=>{const e=null==n?void 0:n.contact.isEnterprise;return M.ServerProps.viewOnceWrite&&!e},Ce=e=>{ne(e)},ye=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{isViewOnce:n}=t;if(z)if(0===e.length)__LOG__(4,void 0,new Error,!0)`Assertion failed!`,SEND_LOGS("capture-drawer-no-img");else{const{media:t,mentionedJidList:o}=(0,i.default)(e[0],"medias[0]"),s=t.file;var a,r;if(s instanceof Blob)z({getImg:T.default.createFromData(s,s.type),caption:null!==(a=t.caption)&&void 0!==a?a:void 0,isViewOnce:n,mentionedJidList:o}),null===(r=q.current)||void 0===r||r.logSend({isViewOnce:n});he()}else __LOG__(4,void 0,new Error,!0)`Assertion failed!`,SEND_LOGS("capture-drawer-no-onSend")};let Se,je,be,Ee,ke;const Ie="capture-cover"===e.theme?"cover":"contain";switch(ie){case H:case G:if(ke=(0,F.jsx)(L.Spinner,{stroke:4,size:50}),ie===H)break;case W:const t=(0,l.default)(p.default.video,{[p.default.videoInactive]:se&&ie===G}),a=se?(0,F.jsx)(N.default,{autoPlay:!0,ref:X,onPlay:me,src:Y.current?Y.current:void 0,srcObject:Y.current?void 0:se}):null;be=se?(0,F.jsx)("div",{children:(0,F.jsx)(w.default,{type:Ie,size:ae,children:(0,F.jsx)("div",{className:t,"data-animage-capture-webcam":!0,children:a})})},"webcam"):null,Se=ie===W?(0,F.jsx)("div",{className:p.default.btn,children:(0,F.jsx)(P.Round,{large:!0,onClick:pe,children:(0,F.jsx)(O.default,{name:"camera"})})},"btn-capture"):null;break;case V:if(be=(0,F.jsx)(w.default,{type:Ie,size:ae,children:(0,F.jsx)("img",{alt:"",className:p.default.image,"data-animate-capture-snapshot":!0,src:$})}),n){const e=(0,i.default)(n.attachMediaContents,"chat.attachMediaContents");be=(0,F.jsx)(k.default,{theme:"capture",chat:n,initCaption:null,mediaCollection:e,onDropText:()=>{},onSendMedia:ye})}Se=(0,F.jsx)("div",{className:(0,l.default)(p.default.btn,p.default.btnSend),children:(0,F.jsx)(P.Round,{large:!0,onClick:ve,children:(0,F.jsx)(O.default,{name:"send",directional:!0})})},"btn-send"),je=(0,F.jsxs)("div",{className:p.default.retakeBtn,onClick:ge,children:[(0,F.jsx)("div",{className:p.default.retakeIcon,children:(0,F.jsx)(O.default,{name:"return"})}),d.fbt._("Retake",null,{hk:"tGeQz"})]}),Ee=e.chat?(0,F.jsxs)("div",{className:p.default.captionInput,children:[(0,F.jsx)(b.default,{ref:Q,chat:e.chat,maxLength:s.default.MAX_CAPTION_LENGTH,multiline:!0,onEnter:ve,onChange:_e,placeholder:S.default.t(134),showRemaining:!0,spellCheck:!0,supportsEmoji:!0,value:Z}),M.ServerProps.viewOnceWrite?(0,F.jsx)(h.default,{disabled:!xe(),isOn:te,mediaType:"image",onChange:Ce}):null]}):null;break;default:__LOG__(2)`captureDrawer:render Unhandled video capture state ${ie}`}const we=e.caption?(0,F.jsx)(R.default,{transitionName:"media-caption",className:p.default.caption,children:Ee}):null;let Te=(0,F.jsxs)("div",{className:p.default.footer,children:[we,(0,F.jsx)(R.default,{transitionName:"pop_delay",children:Se})]});return ie===V&&(Te=null),(0,F.jsxs)(g.default,{theme:e.theme,children:[(0,F.jsx)(_.DrawerHeader,{title:S.default.t(779),type:_.DRAWER_HEADER_TYPE.OFFSET,onCancel:e.onBack,children:je}),(0,F.jsxs)(v.default,{overflow:"hidden",children:[(0,F.jsxs)("div",{className:p.default.container,children:[ke,(0,F.jsx)("div",{className:p.default.body,children:(0,F.jsx)(R.default,{transitionName:"capture",className:p.default.videoContainer,children:be})})]}),Te]})]},"attach-capture-modal")}z.defaultProps={caption:!1};var q=(0,c.forwardRef)(z);t.default=q},98001:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const t=l.default.isRTL();return(0,d.jsx)("div",{className:(0,r.default)(c.container),children:(0,d.jsx)(s.FlexRow,{align:"start",justify:"start",wrap:"wrap",children:e.categories.map((n=>(0,d.jsx)(o.default,{"aria-label":i.fbt._("Unselect category",null,{hk:"2Swokr"}),onClick:()=>e.onRemoveItem(n.id),label:n.localized_display_name,postfixIcon:t?void 0:"round-x-inv",prefixIcon:t?"round-x-inv":void 0,xstyle:c.chip},n.id.toString())))})})};var r=a(n(94184)),i=n(48360),o=(a(n(56720)),a(n(72332))),s=n(29623),l=a(n(43725)),d=n(85893);const c={container:{paddingTop:"b7n2qyd4",paddingEnd:"iffbo4e8",paddingBottom:"s8gyl5p1",paddingStart:"khscay3k",backgroundColor:"sjyhwr5o",borderTop:"dl47i6rc"},chip:{marginTop:"dj1c3cmq",marginEnd:"bugiwsl0",marginBottom:"mpdn4nr2",marginStart:"svoq16ka"}}},30730:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const t=(0,g.default)(e.onContinue),n=(0,o.useMemo)((()=>(0,r.default)(t)),[t]),a=i.fbt._("",null,{hk:"1ZjYYW"}),x=(0,v.jsx)(p.default,{name:"communities-nux"}),C=i.fbt._("",null,{hk:"4fVDKS"}),y=(0,v.jsx)(p.default,{name:"triple-dots",width:22,height:22}),S=i.fbt._("",null,{hk:"2J8MAM"}),j=i.fbt._("",null,{hk:"4fVDKS"}),b=i.fbt._("",null,{hk:"2J8MAM"}),E=(0,v.jsx)(p.default,{name:"announcement-speaker",width:22,height:22});return(0,v.jsxs)(l.default,{children:[(0,v.jsx)(c.DrawerHeader,{title:i.fbt._("",null,{hk:"GzfEK"}),type:c.DRAWER_HEADER_TYPE.LARGE}),(0,v.jsxs)(d.default,{children:[(0,v.jsxs)(u.default,{animation:!1,className:(0,s.default)(_.main),children:[(0,v.jsx)(h.FlexRow,{align:"center",justify:"center",children:(0,v.jsx)(h.FlexItem,{xstyle:_.badge,children:x})}),(0,v.jsx)(h.FlexRow,{align:"center",justify:"center",children:(0,v.jsx)(m.TextHeader,{xstyle:_.header,size:"24",color:"dark",weight:"bold",children:a})}),(0,v.jsxs)("div",{className:(0,s.default)(_.infoArea),children:[(0,v.jsx)(h.FlexColumn,{xstyle:_.iconColumn,children:y}),(0,v.jsxs)(h.FlexColumn,{xstyle:_.textArea,children:[(0,v.jsx)(m.TextHeader,{theme:"title",children:C}),(0,v.jsx)(m.TextParagraph,{theme:"muted",xstyle:_.subText,children:S})]})]}),(0,v.jsxs)("div",{className:(0,s.default)(_.infoArea),children:[(0,v.jsx)(h.FlexColumn,{xstyle:_.iconColumn,children:E}),(0,v.jsxs)(h.FlexColumn,{xstyle:_.textArea,children:[(0,v.jsx)(m.TextHeader,{theme:"title",children:j}),(0,v.jsx)(m.TextParagraph,{theme:"muted",xstyle:_.subText,children:b})]})]})]}),(0,v.jsx)("div",{className:(0,s.default)(_.nextButton),children:(0,v.jsx)(f.Round,{a8nText:"create-group-btn",onClick:n,children:(0,v.jsx)(p.default,{name:"arrow-forward"})})})]})]})};var r=a(n(51463)),i=n(48360),o=n(67294),s=a(n(56720)),l=a(n(60453)),d=a(n(69637)),c=n(94790),u=a(n(33308)),h=n(29623),f=n(82857),p=a(n(23217)),m=n(13923),g=a(n(83800)),v=n(85893);const _={main:{paddingBottom:"lnhl94cj"},nextButton:{zIndex:"b9fczbqn",display:"p357zi0d",justifyContent:"j1p1mz06",paddingBottom:"fwm24tzf",marginTop:"mnhq3yws",textAlign:"qfejxiq4"},badge:{borderTopStartRadius:"boajuire",borderTopEndRadius:"o93wvyfv",borderBottomEndRadius:"i5w8n1e6",borderBottomStartRadius:"cnpay6qi",color:"qiqvuef5",fontSize:"rwfn434h",marginTop:"rek1qe2c",paddingTop:"eujn52yf",paddingEnd:"abxuf49s",paddingBottom:"ckm995li",paddingStart:"mhcwslh8",textTransform:"ofejerhi"},header:{marginTop:"rek1qe2c",marginEnd:"k1jo73ug",marginBottom:"mpdn4nr2",marginStart:"isfiuinm",width:"gha8fw27",textAlign:"qfejxiq4"},infoArea:{display:"p357zi0d",marginTop:"mnhq3yws",marginEnd:"k1jo73ug",marginBottom:"mpdn4nr2",marginStart:"isfiuinm",maxWidth:"dknb6df3"},textArea:{paddingStart:"bmj4fdax"},subText:{paddingTop:"jvpa774f"},iconColumn:{paddingTop:"tspiaou6"}}},49658:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(n(48926)),i=a(n(29521)),o=a(n(99964)),s=a(n(45120)),l=a(n(52013)),d=a(n(94184)),c=n(48360),u=n(67294),h=a(n(56720)),f=n(86945),p=n(88102),m=a(n(35487)),g=a(n(60453)),v=a(n(69637)),_=n(94790),x=n(85600),C=a(n(44942)),y=a(n(30855)),S=a(n(63928)),j=n(55981),b=a(n(43725)),E=a(n(48690)),k=a(n(53153)),I=n(82857),w=n(52596),T=n(11054),P=a(n(23217)),M=n(42681),L=n(13923),O=n(50452),A=a(n(41956)),D=n(85893);const R={search:{paddingTop:"mw9hwy0h",paddingEnd:"ixsqo53d",paddingBottom:"ekpn4oxx",paddingStart:"iy3dfvyp",marginTop:"s15egc35",marginEnd:"r67mms0c",marginBottom:"pel5o5rz",marginStart:"m0ig7u5t",backgroundColor:"ihvf49ua"},inputArea:{display:"l7jjieqr",width:"ln8gz9je",height:"bvcnfjzh",paddingTop:"ppypbuwx",paddingEnd:"f9ovudaz",paddingBottom:"s8gyl5p1",paddingStart:"gx1rr48f",marginTop:"tt8xd2xn",marginEnd:"jnwc1y2a",marginBottom:"mpdn4nr2",marginStart:"svoq16ka",fontSize:"bze30y65",lineHeight:"jgi8eev7",color:"mfzfak1c",verticalAlign:"fewfhwl7",backgroundColor:"thr4l2wc",borderTop:"q4zabkcz",borderEnd:"jkanexlp",borderBottom:"thn59n0e",borderStart:"nsmrnv0a",outline:"gk6igrwd"},inputLine:{position:"g0rxnol2",width:"ln8gz9je",minHeight:"g4oj0cdv",maxHeight:"f0mh0h6e",paddingTop:"n1yiu2zv",paddingEnd:"f9ovudaz",paddingBottom:"przvwfww",paddingStart:"mjn2akup",overflowY:"ag5g9lrv",fontSize:"bze30y65",fontWeight:"e1gr2w1z",lineHeight:"htjsae3x",backgroundColor:"thr4l2wc",borderTop:"q4zabkcz",borderEnd:"jkanexlp",borderStart:"nsmrnv0a",borderBottom:"ob9ouq0z",outline:"gk6igrwd",transition:"qbtd8e50"},drawerSection:{zIndex:"b9fczbqn",display:"p357zi0d",justifyContent:"j1p1mz06",paddingBottom:"hjz8m82x",marginTop:"ignnouf6",textAlign:"qfejxiq4"},inputAreaSizer:{position:"snyj76hw",visibility:"kojwoqec"},contacts:{position:"g0rxnol2",flexGrow:"ggj6brxn",flexShrink:"m0h2a7mj",flexBasis:"l07amlnk",overflowX:"gfz4du6o",overflowY:"ag5g9lrv",backgroundColor:"ihvf49ua"},paragraph:{paddingTop:"b8cdf3jl",paddingEnd:"h5uqwbaf",paddingBottom:"q1tx93la",paddingStart:"kjjye8e3",fontSize:"f8jlpxt4",lineHeight:"jgi8eev7",textAlign:"qfejxiq4",color:"pm5hny62",backgroundColor:"ihvf49ua",borderBottom:"daad4uqs"},spinner:{backgroundColor:"ihvf49ua",display:"p357zi0d",justifyContent:"ac2vgrno",paddingTop:"gzqlv4l6",paddingEnd:"f9ovudaz",paddingBottom:"lhcgb2gc",paddingStart:"gx1rr48f"}};var N=(0,u.forwardRef)((e=>{const t=(0,O.genId)("max_subgroup_toast"),n=(0,f.getABPropConfigValue)("parent_group_link_limit"),[a,N]=(0,u.useState)(""),[F,B]=(0,u.useState)(e.addedExistingGroups),[U,H]=(0,u.useState)([]),[G,W]=(0,u.useState)(!0),V=(0,u.useRef)(new y.default),z=(0,u.useRef)(),q=(0,u.useRef)();(0,u.useEffect)((()=>{l.default.focus(q.current)}));const K=function(){var e=(0,r.default)((function*(){W(!0);const e=(yield(0,M.syncAndGetAdminedGroups)()).filter((e=>{const t=S.default.get(e.id.toString());return(null==t?void 0:t.groupType)===j.GroupType.DEFAULT}));H(e),W(!1)}));return function(){return e.apply(this,arguments)}}();(0,u.useEffect)((()=>{K()}),[]);const Y=()=>{s.default.shouldIndicateFocus(),l.default.focus(q.current)},Q=()=>{e.onSubmit(F)},X=(a,r)=>{(a=>{if(F.length+e.newGroupsCount>=n){const e=c.fbt._("",null,{hk:"ZY1JV"});p.Cmd.openToast((0,D.jsx)(O.Toast,{msg:e,id:t}))}else B([...F,a]),N("")})(r)};let Z;F.length>0&&(Z=(0,D.jsx)(I.Round,{a8nText:"group-participants-btn",onClick:Q,children:(0,D.jsx)(P.default,{name:"arrow-forward",directional:!0})}));const J=(()=>{const e=(0,i.default)(U,F,((e,t)=>e.id===t.id));if(!a)return e;const t=b.default.accentFold(a),n=(0,E.default)(t);return e.filter((e=>e.searchMatch(t,n)))})();let $;return $=0===J.length?(0,D.jsx)(x.SearchGroups,{}):(0,D.jsx)(m.default,{ref:z,flatListController:V.current,contacts:J,onClick:X,onFocusSearch:Y,showPersonGroupDivisionHeader:!0,isCommunityCreation:!0,disabled:F.length+e.newGroupsCount>=n}),(0,D.jsxs)(g.default,{children:[(0,D.jsx)(_.DrawerHeader,{title:c.fbt._("",null,{hk:"2ildtF"}).toString(),type:_.DRAWER_HEADER_TYPE.LARGE,onBack:e.onBack}),(0,D.jsxs)(v.default,{children:[(0,D.jsx)(L.TextParagraph,{xstyle:R.paragraph,children:c.fbt._("",null,{hk:"3nnXVI"})}),G?(0,D.jsx)("div",{className:(0,h.default)(R.spinner),children:(0,D.jsx)(T.Spinner,{})}):(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)("div",{className:(0,h.default)(R.search),children:(0,D.jsxs)("div",{className:(0,h.default)(R.inputLine),children:[(0,D.jsx)("div",{"data-list-scroll-container":!0,children:(0,D.jsx)(k.default,{theme:"list-names",contacts:F,onDelete:(e,t)=>{(e=>{B(F.filter((t=>!e.id.equals(t.id))))})(t)},onFocusSearch:Y})}),(0,D.jsx)("input",{"data-a8n":o.default.key("inputarea"),className:(0,d.default)((0,h.default)(R.inputArea),w.SELECTABLE_INPUT_CSS_CLASS),ref:q,placeholder:c.fbt._("",null,{hk:"5ZAVL"}),onChange:e=>N(e.target.value),value:a,type:"text"}),(0,D.jsx)("span",{className:(0,h.default)(R.inputAreaSizer),children:a})]})}),(0,D.jsx)(C.default,{className:(0,h.default)(R.contacts),flatListControllers:[V.current],children:$})]}),(0,D.jsx)(A.default,{transitionName:"btn",className:(0,h.default)(R.drawerSection),children:Z})]})]})}));t.default=N},63232:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(n(51463)),i=a(n(45095)),o=n(48360),s=n(67294),l=a(n(56720)),d=n(86945),c=a(n(39770)),u=a(n(44356)),h=n(88102),f=a(n(52665)),p=n(88984),m=a(n(60453)),g=a(n(69637)),v=n(94790),_=a(n(33308)),x=n(47915),C=a(n(44942)),y=a(n(30855)),S=a(n(61684)),j=a(n(63928)),b=n(57224),E=a(n(37982)),k=n(82857),I=a(n(52711)),w=a(n(23217)),T=a(n(1784)),P=a(n(83800)),M=n(85893);const L={addGroupButton:{paddingBottom:"a15vwmim",marginTop:"o9i7y497"},panelBody:{zIndex:"jnl3jror",display:"p357zi0d",flexDirection:"f8m0rgwh",flexGrow:"ggj6brxn",overflowY:"ag5g9lrv",backgroundColor:"ihvf49ua"},nextButton:{zIndex:"b9fczbqn",display:"p357zi0d",justifyContent:"j1p1mz06",paddingBottom:"hjz8m82x",marginTop:"ignnouf6",textAlign:"qfejxiq4",animationName:"s0bejz76",animationDuration:"oauresqk",animationTimingFunction:"pqvv99ib"},roundIcon:{height:"brqbuz94",width:"nfc7olq2",overflowX:"gfz4du6o",overflowY:"r7fjleex"},announcementIcon:{backgroundColor:"se52eggw"},announcementSpeaker:{color:"q3u0wlip"},groupIcon:{height:"ppled2lx",width:"ln8gz9je"}},O=(0,M.jsx)(I.default,{children:(0,M.jsx)(w.default,{name:"plus",directional:!0})}),A=(0,M.jsx)(I.default,{children:(0,M.jsx)(w.default,{name:"link"})}),D=(0,M.jsx)(I.default,{xstyle:[L.roundIcon,L.announcementIcon],theme:"transparent",children:(0,M.jsx)(w.default,{name:"announcement-speaker",directional:!0,height:32,width:32,iconXstyle:L.announcementSpeaker})});var R=(0,s.forwardRef)(((e,t)=>{const n=(0,d.getABPropConfigValue)("parent_group_link_limit"),a=(0,s.useRef)(null),R=(0,s.useRef)(new y.default),N=(0,P.default)(e.onCreateCommunity),F=(0,s.useMemo)((()=>(0,r.default)((()=>{N()}))),[N]),B=e.groups.map((e=>{const{subject:t,icon:n=null,id:a=null,tempId:r=null,participants:s=null}=e;let d,c;null!=a?(d=(0,M.jsx)(p.DetailImage,{id:a}),null!=s&&(c=(0,S.default)(s))):(d=null!=n?(0,M.jsx)("img",{src:n,alt:"Group icon",className:(0,l.default)(L.groupIcon)}):(0,M.jsx)(w.default,{name:"default-group",xstyle:L.groupIcon,className:E.default.defaultGroupIcon}),c=o.fbt._("",null,{hk:"1Q2Jqa"}));return{itemKey:(0,i.default)(null!=r?r:null==a?void 0:a.toString(),"tempId ?? id?.toString()"),name:e.subject,icon:(0,M.jsx)(I.default,{xstyle:L.roundIcon,theme:"transparent",children:d}),secondary:c}}));B.unshift({itemKey:e.name,name:e.name,icon:D,secondary:o.fbt._("",null,{hk:"21RRQt"})});const U=()=>{h.Cmd.openModal((0,M.jsx)(f.default,{onOK:()=>h.Cmd.closeModal(),children:o.fbt._("",null,{hk:"2i88hJ"})}))};return(0,s.useImperativeHandle)(t,(()=>({restoreFocus:()=>{var e;return null===(e=a.current)||void 0===e?void 0:e.focus()},getElement:()=>a.current}))),(0,M.jsxs)(m.default,{children:[(0,M.jsx)(v.DrawerHeader,{title:o.fbt._("",null,{hk:"4xaIXe"}),type:v.DRAWER_HEADER_TYPE.LARGE,onBack:e.onBack}),(0,M.jsxs)(g.default,{children:[(0,M.jsxs)(_.default,{children:[(0,M.jsx)("div",{"data-list-scroll-offset":!0,children:(0,M.jsx)("div",{className:(0,l.default)(L.addGroupButton),ref:a,children:(0,M.jsx)(u.default,{image:O,primary:o.fbt._("",null,{hk:"1LoFaq"}),onClick:()=>{e.groups.length>=n?U():e.onNewGroupFlow()}})})}),(0,M.jsx)("div",{"data-list-scroll-offset":!0,children:(0,M.jsx)("div",{className:(0,l.default)(L.addGroupButton),children:(0,M.jsx)(u.default,{image:A,primary:o.fbt._("",null,{hk:"1CsADY"}),onClick:()=>{if(e.groups.length>=n)U();else{if(null!=j.default.findFirst((e=>e.participants.iAmAdmin())))e.onExistingGroupFlow();else{const t=(0,M.jsx)(c.default,{type:"secondary",onClick:()=>h.Cmd.closeModal(),children:o.fbt._("Cancel",null,{hk:"w74ws"})},0),n=(0,M.jsx)(c.default,{type:"primary",onClick:()=>{h.Cmd.closeModal(),e.onNewGroupFlow()},children:o.fbt._("",null,{hk:"3Aq8lH"})},1);h.Cmd.openModal((0,M.jsx)(b.Modal,{actions:[t,n],children:(0,M.jsx)("div",{children:o.fbt._("",null,{hk:"2SsDzN"})})}))}}}})})})]}),(0,M.jsx)(_.default,{title:o.fbt._("",null,{hk:"uK7K1"}),children:(0,M.jsx)(C.default,{flatListControllers:[R.current],className:(0,l.default)(L.panelBody),id:"pane-side",children:(0,M.jsx)(x.FlatList,{flatListController:R.current,direction:"vertical",data:B,renderItem:t=>t.itemKey===e.name?(0,M.jsx)(u.default,{primary:t.name,image:t.icon,secondary:t.secondary}):(0,M.jsx)(u.default,{primary:t.name,image:t.icon,secondary:t.secondary,detail:(0,M.jsx)(T.default,{onClick:()=>{return n=t.itemKey,void e.onRemoveGroup(n);var n},children:(0,M.jsx)(w.default,{name:"x"})})})})})}),(0,M.jsx)("div",{className:(0,l.default)(L.nextButton),children:(0,M.jsx)(k.Round,{a8nText:"create-group-btn",onClick:F,children:(0,M.jsx)(w.default,{name:"arrow-forward"})})})]})]})}));t.default=R},98600:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(n(51463)),i=a(n(99964)),o=n(48360),s=n(67294),l=a(n(56720)),d=a(n(60453)),c=a(n(69637)),u=n(94790),h=a(n(33308)),f=a(n(66797)),p=n(33646),m=a(n(43556)),g=n(82857),v=n(64551),_=a(n(23217)),x=n(90011),C=a(n(41956)),y=n(85893);const S={marginTop:"ignnouf6",marginEnd:"bcfko8ch",marginBottom:"bibl1e27",marginStart:"dl2ettod"},j={zIndex:"b9fczbqn",display:"p357zi0d",justifyContent:"j1p1mz06",paddingBottom:"hjz8m82x",marginTop:"ignnouf6",textAlign:"qfejxiq4"};var b=(0,s.forwardRef)(((e,t)=>{var n,a;const b=(0,s.useRef)(null),E=(0,s.useRef)(null),[k,I]=(0,s.useState)(null!==(n=e.name)&&void 0!==n?n:""),[w,T]=(0,s.useState)(null!==(a=e.description)&&void 0!==a?a:""),[P,M]=(0,s.useState)(e.imgBlob);(0,s.useEffect)((()=>{var e;null===(e=b.current)||void 0===e||e.restoreFocus()}),[]);const L=()=>{const t=(0,f.default)(k.trim());e.onContinue(t,w,P)};(0,s.useImperativeHandle)(t,(()=>({restoreFocus:()=>{var e;return null===(e=b.current)||void 0===e?void 0:e.restoreFocus()},getElement:()=>E.current})));const O=k.trim().length>0,A=O?(0,y.jsx)("div",{className:(0,l.default)(j),children:(0,y.jsx)(g.Round,{a8nText:"create-group-btn",onClick:(0,r.default)(L),children:(0,y.jsx)(_.default,{name:"arrow-forward"})})}):null;return(0,y.jsxs)(d.default,{children:[(0,y.jsx)(u.DrawerHeader,{title:o.fbt._("",null,{hk:"GzfEK"}),type:u.DRAWER_HEADER_TYPE.LARGE,onBack:e.onBack}),(0,y.jsxs)(c.default,{children:[(0,y.jsxs)(h.default,{animation:!1,children:[(0,y.jsx)("div",{className:(0,l.default)(S),children:(0,y.jsx)(p.PhotoPickerLoadable,{type:m.default.COMMUNITY,attachToChat:!1,startImage:P,onImageSet:(e,t)=>{M(t)}})}),(0,y.jsx)("div",{"data-a8n":i.default.key("community-subject"),className:(0,l.default)(S),ref:E,children:(0,y.jsx)(x.TextInput,{ref:e=>{b.current=e},value:k,maxLength:25,showRemaining:!0,onChange:e=>{I(e)},placeholder:o.fbt._("",null,{hk:"1Yj1bU"}),onEnter:O?(0,r.default)(L):()=>{},supportsEmoji:!0})}),(0,y.jsx)("div",{"data-a8n":i.default.key("community-description"),className:(0,l.default)(S),children:(0,y.jsx)(x.TextInput,{value:w,maxLength:v.ServerProps.groupDescLength,showRemaining:!0,onChange:e=>{T(e)},placeholder:o.fbt._("",null,{hk:"2jZNJ7"}),onEnter:O?(0,r.default)(L):()=>{}})})]}),(0,y.jsx)(C.default,{transitionName:"btn",children:A})]})]})}));t.default=b},61684:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const t=e.filter((e=>!e.contact.isMe&&e.contact.shortName)).slice(0,3).map((e=>e.contact.shortName)),n=e.length-t.length-1;let a=r.default.t(1020);t.length+n<3?t.forEach(((e,n)=>{n===t.length-1?a+=r.default.t(405)+e:a+=r.default.t(407)+e})):a+=r.default.t(407)+t.join(r.default.t(407));n>0&&(a+=r.default.t(405)+r.default.t(507,{count:n,_plural:n}));return a};var r=a(n(43725))},81411:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(n(45120)),i=a(n(52013)),o=n(48360),s=n(67294),l=a(n(22245)),d=a(n(44356)),c=n(19380),u=a(n(33621)),h=a(n(35487)),f=a(n(60453)),p=a(n(69637)),m=n(94790),g=n(85600),v=a(n(30855)),_=n(57701),x=n(29424),C=a(n(43725)),y=a(n(48837)),S=a(n(48690)),j=a(n(52711)),b=a(n(23217)),E=a(n(81559)),k=n(85893);var I=(0,s.forwardRef)(((e,t)=>{const{title:n,onBack:a,onClick:I,onNewGroup:w,onNewCommunity:T}=e,[P,M]=(0,s.useState)(""),L=(0,s.useRef)(),O=(0,s.useRef)(),A=(0,s.useRef)(),D=(0,s.useMemo)((()=>c.ContactCollection.frequentContacts("message")),[c.ContactCollection.length]),R=Boolean(P),N=(0,s.useMemo)((()=>R?[]:D),[R,D]),[F]=(0,s.useState)((()=>new v.default)),B=(0,s.useCallback)((e=>{c.ContactCollection.ensureSorted();const t="string"==typeof e?e:P;if(!t)return c.ContactCollection.getFilteredContacts();const n=c.ContactCollection.getFilteredContacts().concat(c.ContactCollection.filter((e=>e.name&&!e.isMe&&!e.isPSA&&!e.isWAContact))),a=C.default.accentFold(t),r=(0,S.default)(a);return n.filter((function(e){return e.searchMatch(a,r)}))}),[P]);(0,s.useEffect)((()=>{i.default.focus(L.current)}),[]);const U=(0,s.useCallback)((()=>{r.default.shouldIndicateFocus(),i.default.focus(L.current)}),[]),H=(0,s.useCallback)((e=>{const t=O.current;null!=t&&(e.preventDefault(),e.stopPropagation(),r.default.shouldIndicateFocus(),t.focusFirst())}),[]),G=(0,E.default)((e=>M(e)),100),W=(0,s.useCallback)((e=>{A.current=e,G(e)}),[G]),V=(0,s.useCallback)((e=>{e.preventDefault(),e.stopPropagation();const t=N[0];if(t)return r.default.shouldIndicateFocus(),void I(e,t);const n=B(A.current)[0];n&&(r.default.shouldIndicateFocus(),I(e,n))}),[I,B,N]);let z,q,K;const Y=B();if(z=0===Y.length?P?(0,g.SearchWithKeyword)(P):(0,g.SearchWithoutKeyword)():(0,k.jsx)(h.default,{ref:O,contacts:Y,flatListController:F,frequentContacts:N,onClick:I,onFocusSearch:U,showPersonGroupDivisionHeader:!!P}),!P){const e=(0,k.jsx)(j.default,{children:(0,k.jsx)(b.default,{name:"default-group",height:36,width:36,directional:!0,className:u.default.defaultGroupIcon})}),t=(0,k.jsx)(j.default,{children:(0,k.jsx)(b.default,{name:"community-group",directional:!0})});q=(0,k.jsx)("div",{"data-list-scroll-offset":!0,children:(0,k.jsxs)("div",{className:u.default.newGroupButton,children:[(0,k.jsx)(d.default,{image:e,primary:o.fbt._("New group",null,{hk:"43A4qP"}),onClick:w}),(0,k.jsx)(l.default,{})]})}),K=(0,_.communityCreationEnabled)()?(0,k.jsx)("div",{"data-list-scroll-offset":!0,children:(0,k.jsxs)("div",{className:u.default.newGroupButton,children:[(0,k.jsx)(d.default,{image:t,primary:o.fbt._("",null,{hk:"GzfEK"}),onClick:T}),(0,k.jsx)(l.default,{})]})}):null}return(0,k.jsxs)(f.default,{ref:t,children:[(0,k.jsx)(m.DrawerHeader,{title:n,type:m.DRAWER_HEADER_TYPE.LARGE,onBack:a}),(0,k.jsx)(x.HotKeys,{handlers:{down:H},children:(0,k.jsx)(y.default,{ref:L,onSearch:W,onEnter:V,placeholder:C.default.t(732)})}),(0,k.jsxs)(p.default,{flatListControllers:[F],children:[q,K,z]})]},"contact-modal")}));t.default=I},67873:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const t=(0,O.useModelValues)(e.msg,["id","star","type","isGif","isViewOnce","labels","numTimesForwarded","isFrequentlyForwarded"]),n=(0,A.default)(),a=(0,P.default)(),F=(0,D.default)(),B=(0,s.useRef)(null),U=(0,s.useRef)(null),H=(0,M.default)((()=>new C.default.UiAction({uiActionType:C.default.UI_ACTION_TYPE.MSG_INFO_OPEN,uiActionPreloaded:!0}))),[G,W]=(0,s.useState)(void 0),[V,z]=(0,s.useState)(!1);(0,L.useListener)(null==G?void 0:G.played,["add","remove"],a),(0,L.useListener)(null==G?void 0:G.read,["add","remove"],a),(0,L.useListener)(null==G?void 0:G.delivery,["add","remove"],a),(0,L.useListener)(t,["remove"],((e,t)=>{t===y.MsgCollection&&(null==n||n.uie.requestDismiss())})),(0,s.useEffect)((()=>{var e;S.MsgInfoCollection.find(t.id).then((e=>{F.aborted||W(e)})).catch((()=>{z(!0),d.Cmd.openToast((0,N.jsx)(T.Toast,{msg:o.fbt._("Couldn't display message info. Try again later.",null,{hk:"mRFf6"}),id:(0,T.genId)("msg_info_failed")}))}));const n=null===(e=B.current)||void 0===e?void 0:e.container;t.type===i.MSG_TYPE.IMAGE&&n&&(n.scrollTop=n.scrollHeight);const a=H.current;a&&(a.markUiActionT(),a.commit(),(0,E.logUiActionShadowPrivateStatsTestEvents)(),H.current=void 0)}),[]);const q=()=>{var e;return null===(e=U.current)||void 0===e?void 0:e.getMsgComponentRef()};let K,Y,Q;if(G){var X,Z,J;const e=[];let n,a,r;const s=t.type===i.MSG_TYPE.PTT;var $;if(s||t.isViewOnce)Y=s?o.fbt._("Seen",null,{hk:"2XnbT5"}):o.fbt._("Seen",null,{hk:"n9K7N"}),n=G.played.head(),a=null===($=n)||void 0===$?void 0:$.t,r=(0,N.jsx)("span",{className:u.default.icon,children:(0,N.jsx)(w.default,{name:s?"status-ptt":"view-once-viewed",className:u.default.statusBlue})}),e.push((0,N.jsx)(c.default,{title:s?_.default.t(620):o.fbt._("Opened",null,{hk:"4lUnhv"}),t:a,icon:r},"played"));n=G.read.head(),a=null===(X=n)||void 0===X?void 0:X.t,r=(0,N.jsx)("span",{className:u.default.icon,children:(0,N.jsx)(w.default,{name:"status-dblcheck",className:u.default.ack})}),Y=null!==(Z=Y)&&void 0!==Z?Z:_.default.t(622),e.push((0,N.jsx)(c.default,{title:Y,t:a,icon:r},"read")),n=G.delivery.head(),a=null===(J=n)||void 0===J?void 0:J.t,r=(0,N.jsx)("span",{className:u.default.icon,children:(0,N.jsx)(w.default,{name:"status-dblcheck"})}),e.push((0,N.jsx)(c.default,{title:_.default.t(618),t:a,icon:r},"delivery")),!k.ServerProps.hfmStringChanges&&t.numTimesForwarded>0&&!t.isFrequentlyForwarded&&e.push((0,N.jsx)(j.default,{msg:t},"forward")),K=(0,N.jsx)(m.default,{theme:"padding",children:e})}G||V||(Q=(0,N.jsx)("div",{className:u.default.spinner,children:(0,N.jsx)(I.Spinner,{size:50,stroke:4})},"spinner"));let ee=null;t.labels&&t.labels.length>0&&(0,g.canDisplayLabel)()&&(ee=(0,N.jsx)(m.default,{theme:"padding",children:(0,N.jsx)(v.default,{labels:t.labels})}));return(0,N.jsxs)(h.default,{theme:"striped",children:[(0,N.jsx)(p.DrawerHeader,{title:_.default.t(617),type:p.DRAWER_HEADER_TYPE.SMALL,rtlFixIfOnDarwin:!0,onCancel:()=>{null==n||n.uie.requestDismiss()}}),(0,N.jsx)(b.default,{ref:B,chatPreference:l.default.assertGet("defaultPreference"),children:(0,N.jsx)(R.Wrapper,{msg:t,ref:U,displayType:r.DISPLAY_TYPE.MSG_INFO,isMsgVisible:function(e){let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e===t.id&&(!!n||q())},position:x.MsgPosition.END,onProductClick:e.onProductClick})}),(0,N.jsxs)(f.default,{children:[ee,(0,N.jsxs)("div",{className:u.default.body,children:[Q,K]})]})]},"message-info-modal")};var r=n(5177),i=n(15461),o=n(48360),s=n(67294),l=a(n(66034)),d=n(88102),c=a(n(56790)),u=a(n(40261)),h=a(n(60453)),f=a(n(69637)),p=n(94790),m=a(n(33308)),g=n(57701),v=a(n(77577)),_=a(n(43725)),x=n(87931),C=a(n(11339)),y=n(59871),S=n(17972),j=a(n(82678)),b=a(n(1697)),E=n(7595),k=n(64551),I=n(11054),w=a(n(23217)),T=n(50452),P=a(n(59909)),M=a(n(59552)),L=n(19529),O=n(49082),A=a(n(59147)),D=a(n(38080)),R=n(58827),N=n(85893)},42769:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{supportTag:t,onSend:n,onFailure:a,onCancel:w,onEmail:T}=e,P=(0,E.default)(),[M,L]=(0,s.useState)(""),[O,A]=(0,s.useState)(null),[D,R]=(0,s.useState)(!0),[N,F]=(0,s.useState)(!1),B=(0,s.useRef)(null);(0,s.useEffect)((()=>{var e;null===(e=B.current)||void 0===e||e.restoreFocus()}),[]);const U=e=>e.length>=10,H=()=>{if(U(M)){let e=(0,r.default)((0,r.default)({},b.UA.parser.getResult()),{},{"Device ID":(0,m.assertGetMe)()});t&&(e=(0,r.default)((0,r.default)({},e),{},{context:t}));const s=D?JSON.stringify(e):void 0;F(!0),null==n||n({description:M}),__LOG__(2)`InAppSupport: Sending support request with deviceInfo=${D}:${null!=s?s:"n/a"}`,(0,x.default)((0,C.sendSupportRequest)(M,s),P).then((e=>{null!=e.message?(c.Cmd.closeModal(),c.Cmd.openToast((0,k.jsx)(j.Toast,{msg:o.fbt._("Your question has been sent to WhatsApp Support. We'll respond in a WhatsApp chat shortly.",null,{hk:"2wt947"}),id:(0,j.genId)()}))):a&&a({description:M})})).catch((0,i.catchAbort)((()=>{}))).finally((()=>{F(!1)}))}else A(_.default.t(763))},G=()=>{null==w||w(),c.Cmd.closeModal()},W=()=>{T&&(c.Cmd.closeModal(),T({description:M}))},V=e=>{L(e)},z=()=>{R(!D)},q=e=>{e.stopPropagation()},K={enter:q};N&&(K.esc=q);if(g.GK.supportsFeature(g.GK.F.MD_BACKEND)){const e="contact-us-include-device";return(0,k.jsx)(u.default,{title:o.fbt._("Contact us",null,{hk:"1FJ2cU"}),okDisabled:!U(M)||N,okSpinner:N,okText:_.default.t(752),onOK:H,onCancel:N?void 0:G,children:(0,k.jsx)(v.HotKeys,{handlers:K,children:(0,k.jsxs)(p.FlexColumn,{align:"stretch",children:[(0,k.jsx)(S.TextInput,{error:O,maxLength:5e3,onChange:V,placeholder:o.fbt._("Tell us how we can help",null,{hk:"1R8W3F"}),ref:B,value:M}),(0,k.jsx)(p.FlexItem,{xstyle:I.deviceInfo,grow:1,children:(0,k.jsx)(y.TextParagraph,{theme:"muted-small",children:o.fbt._("Include device information? (optional)",null,{hk:"1nGqHl"})})}),(0,k.jsxs)(p.FlexRow,{children:[(0,k.jsx)(p.FlexItem,{xstyle:I.deviceInfoLabel,grow:1,children:(0,k.jsx)("label",{htmlFor:e,children:(0,k.jsxs)(y.TextParagraph,{theme:"plain",children:[o.fbt._("Technical details like your model and settings can help us answer your question.",null,{hk:"1Edwn1"})," ",(0,k.jsx)(h.ExternalLink,{href:(0,f.getSupportChatFaqUrl)(),children:_.default.t(554)})]})})}),(0,k.jsx)(p.FlexItem,{xstyle:I.deviceInfoCheckbox,grow:0,children:(0,k.jsx)(l.CheckBox,{checked:D,id:e,onChange:z})})]}),(0,k.jsx)(p.FlexRow,{children:(0,k.jsx)(p.FlexItem,{xstyle:I.emailLink,grow:1,children:(0,k.jsx)(d.default,{onClick:W,children:o.fbt._("Get support via email",null,{hk:"3vajRd"})})})})]})})})}return(0,k.jsx)(u.default,{okText:o.fbt._("OK",null,{hk:"2KEeHb"}),onOK:()=>c.Cmd.closeModal(),title:o.fbt._("Contact us",null,{hk:"1FJ2cU"}),children:(0,k.jsx)(y.TextParagraph,{theme:"plain",children:o.fbt._("The support request form is not yet available for desktop. Use your phone to submit it.",null,{hk:"2Jk5Da"})})})};var r=a(n(81109)),i=n(89385),o=n(48360),s=n(67294),l=(a(n(56720)),n(16593)),d=a(n(99360)),c=n(88102),u=a(n(52665)),h=n(12591),f=n(96384),p=n(29623),m=n(99234),g=n(7293),v=n(29424),_=a(n(43725)),x=a(n(84644)),C=n(15194),y=n(13923),S=n(90011),j=n(50452),b=n(65127),E=a(n(38080)),k=n(85893);const I={deviceInfo:{marginBottom:"t4zgqcuo",marginTop:"opp68qpq"},deviceInfoCheckbox:{minWidth:"r7yn1a4o"},deviceInfoLabel:{paddingEnd:"l9g3jx6n"},emailLink:{marginTop:"opp68qpq"}}},38322:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(48360),i=n(22683),o=n(88102),s=n(57701),l=a(n(43725)),d=n(72472),c=n(40015),u=n(31019),h=n(13923),f=n(49082),p=a(n(152)),m=n(85893);var g=e=>{const t=(0,f.useModelValues)(e.mute,["isMuted","expiration","isCallMuted","callExpiration"]),n=(0,f.useModelValues)(e.reactionsMute,["isMuted","expiration","isCallMuted","callExpiration"]),[a,g]=(0,p.default)((()=>d.MuteCollection.getGlobalNotifications()),(e=>d.MuteCollection.setGlobalNotifications(e))),[v,_]=(0,p.default)((()=>d.MuteCollection.getOutgoingMessageSound()),(e=>d.MuteCollection.setOutgoingMessageSound(e))),[x,C]=(0,p.default)((()=>d.MuteCollection.getGlobalSounds()),(e=>d.MuteCollection.setGlobalSounds(e))),[y,S]=(0,p.default)((()=>d.MuteCollection.getGlobalCallRingtone()),(e=>d.MuteCollection.setGlobalCallRingtone(e))),[j,b]=(0,p.default)((()=>d.MuteCollection.getGlobalPreviews()),(e=>d.MuteCollection.setGlobalPreviews(e))),[E,k]=(0,p.default)((()=>d.MuteCollection.getCollapseMuted()),(e=>d.MuteCollection.setCollapseMuted(e))),I=()=>{o.Cmd.muteAll((0,u.unproxy)(n),!n.isMuted,!0)},w=[];let T;window.Notification&&(w.push((0,m.jsx)(c.SettingsCheckListItem,{a8nText:"option-desktop-notifications",id:"desktop-notifications",checked:a,onChange:g,children:l.default.t(691)},0)),w.push((0,m.jsxs)(c.SettingsCheckListItem,{a8nText:"options-msg-previews",disabled:!a,id:"msg-previews",checked:j,onChange:b,children:[l.default.t(692),(0,m.jsx)(h.TextDiv,{theme:"muted",children:l.default.t(693)})]},1)));const{expiration:P,callExpiration:M,isMuted:L,isCallMuted:O}=t;if((0,s.receiveReactionsEnabled)()){const{expiration:e,isMuted:t}=n;T=(0,m.jsxs)(c.SettingsCheckListItem,{a8nText:"option-reactions-mute-desktop-notifications",id:"reactions-mute-desktop-notifications",checked:t,onChange:I,children:[r.fbt._("Turn off all reactions notifications",null,{hk:"34XbQa"}),t&&null!=e?(0,m.jsx)(h.TextDiv,{theme:"muted",children:i.Clock.untilStr(e)}):null]})}return(0,m.jsxs)(c.SettingsCheckList,{children:[(0,m.jsx)(c.SettingsCheckListItem,{a8nText:"option-sounds",id:"sounds",checked:x,onChange:C,children:l.default.t(694)}),undefined,undefined,w,undefined,T,(0,m.jsxs)(c.SettingsCheckListItem,{a8nText:"option-mute-desktop-notifications",id:"mute-desktop-notifications",checked:L,onChange:()=>{o.Cmd.muteAll((0,u.unproxy)(t),!t.isMuted,!1)},children:[r.fbt._("Turn off all desktop notifications",null,{hk:"JXF2W"}),L&&null!=P?(0,m.jsx)(h.TextDiv,{theme:"muted",children:i.Clock.untilStr(P)}):null]}),null,null]})};t.default=g},54896:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return(0,o.jsx)("div",{className:i.default.dropOverlay,children:(0,o.jsx)("div",{className:i.default.dropOverlayOutline,children:r.fbt._("Drag file here",null,{hk:"y9aHs"})})},"container")};var r=n(48360),i=a(n(45082)),o=n(85893)},71520:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){let{rootRef:t,disabled:n,onClick:a,children:u}=e;const[h,f,p]=function(e){const[t,n]=(0,r.useState)(),[a,i]=(0,r.useState)(),[o,{isIntersecting:s}]=(0,l.default)({root:e,rootMargin:null!=t?`-${t.offsetHeight}px`:void 0});return(0,r.useEffect)((()=>{if(null!=e&&null!=t&&null!=a){if(s)t.style.removeProperty("right");else{const n=e.offsetWidth-(e.clientWidth+2*e.clientLeft);t.style.setProperty("right",`${n}px`)}a.style.setProperty("min-height",`${t.offsetHeight}px`)}}),[s,e,t,a]),[s,e=>{o(e),i(e)},n]}(t);return(0,d.jsx)("div",{ref:f,className:(0,i.default)(c.ctaPlaceholder),children:(0,d.jsx)(s.default,{onRef:p,xstyle:[h?null:c.ctaContainerSticky],theme:"sticky-button-section",children:(0,d.jsx)(o.default,{type:"primary",onClick:a,disabled:n,className:(0,i.default)(c.ctaButton),children:u})})})};var r=n(67294),i=a(n(56720)),o=a(n(39770)),s=a(n(33308)),l=a(n(6914)),d=n(85893);const c={ctaContainerSticky:{position:"ly2gu7o9",bottom:"jxacihee",left:"tukmaf4q",boxShadow:"th8ck7tu"},ctaButton:{display:"f804f6gw",marginBottom:"pel5o5rz"},ctaPlaceholder:{marginBottom:"brac1wpa"}}},21976:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.E2EChangeModal=function(e){const t=(0,l.useModelValues)(e.contact,["formattedShortName"]),n=r.fbt._("OK",null,{hk:"2KEeHb"}),a=t.formattedShortName,c=s.default.t(941,{contactName:a}),u=s.default.t(940,{contactName:a});return(0,d.jsx)(o.default,{title:c,onOK:()=>i.Cmd.closeModal(),okText:n,children:u})};var r=n(48360),i=n(88102),o=a(n(52665)),s=a(n(43725)),l=n(49082),d=n(85893)},50025:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.EditImageDrawer=function(e){var t;const{attributionUrl:n,onRetake:a,retryText:I,onFinished:w}=e,T=(0,y.default)(),P=(0,i.useRef)(),M=(0,i.useRef)(null),L=(0,S.default)((()=>new p.default)),[O,A]=(0,i.useState)(!1),[D,R]=(0,i.useState)({width:500,height:361}),[N]=(0,i.useState)((()=>new c.default(e.img)));(0,j.useListener)(L.current,"change:isInitialized",(()=>{T()}));const F=(e,t)=>{var n;null===(n=P.current)||void 0===n||n.drawCanvas(e,t)},B=O?(0,E.jsx)("div",{className:d.default.btnSend,children:(0,E.jsx)(v.Round,{large:!0,onClick:()=>{var e,t;null===(t=P.current)||void 0===t||t.saveCanvas(),null===(e=M.current)||void 0===e||e.crop().then((e=>{let{thumb:t,full:n}=e;w(t,n),N.cleanUp()}))},children:(0,E.jsx)(_.default,{name:"checkmark-large"})})},"btn-send"):null;let U;L.current.isInitialized&&(U=(0,E.jsx)(g.default,{editedMedia:N,stage:L.current.stage,cropOverlay:L.current.cropOverlay,mediaContainer:L.current.mediaContainer,drawCanvas:F,ref:M}));const H=(0,E.jsx)(f.default,{className:d.default.mediaElement,editedMedia:N,mediaEditController:L.current,fitType:"cover",ref:P});let G;if(a){let e;switch(I){case k.NONE:e=null;break;case k.RETAKE:e=r.fbt._("Retake",null,{hk:"tGeQz"});break;case k.RESTART:default:e=r.fbt._("Upload",null,{hk:"3FMQvb"})}G=(0,E.jsxs)("button",{className:d.default.retake,onClick:a,children:[(0,E.jsx)("div",{className:d.default.retakeIcon,children:(0,E.jsx)(_.default,{name:"return"})}),e]})}const W=n?(0,E.jsxs)("div",{className:d.default.attribution,children:[(0,E.jsx)(u.ExternalLink,{className:d.default.attributionLink,href:n,children:C.URL.hostname(n)}),(0,E.jsxs)("span",{children:[r.fbt._("Image may be subject to copyright.",null,{hk:"XoHv1"}),(0,E.jsx)(u.ExternalLink,{href:(0,x.getTosUrl)(),children:r.fbt._("Terms of Service",null,{hk:"1Lpm6J"})})]})]}):null,V=(0,E.jsxs)("div",{className:d.default.footer,children:[(0,E.jsx)(b.default,{transitionName:"btn",children:B}),W]}),z=null!==(t=e.imageSize)&&void 0!==t?t:{width:500,height:361};return(0,E.jsxs)(o.default,{theme:"edit",children:[(0,E.jsx)(l.DrawerHeader,{title:h.default.t(140),type:"offset",onCancel:e.onCancel,children:G}),(0,E.jsxs)(s.default,{overflow:"hidden",children:[(0,E.jsxs)("div",{className:d.default.mediaBody,children:[U,(0,E.jsx)("div",{className:d.default.containerBackground,children:(0,E.jsx)(b.default,{transitionName:"capture",children:(0,E.jsx)(m.default,{type:"cover",size:z,onObjectLoad:e=>{null!=e&&e instanceof HTMLElement&&(!D||D.width===e.clientWidth&&D.height===e.clientHeight||R({width:e.clientWidth,height:e.clientHeight}),O||A(!0))},children:H})})})]}),V]})]},"attach-edit-modal")},t.RETRY_OPTIONS=void 0;var r=n(48360),i=n(67294),o=a(n(60453)),s=a(n(69637)),l=n(94790),d=a(n(63881)),c=a(n(12199)),u=n(12591),h=a(n(43725)),f=a(n(16144)),p=a(n(47739)),m=a(n(11791)),g=a(n(92144)),v=n(82857),_=a(n(23217)),x=n(73915),C=n(2541),y=a(n(59909)),S=a(n(59552)),j=n(19529),b=a(n(41956)),E=n(85893);const k={NONE:"none",RETAKE:"retake",RESTART:"restart"};t.RETRY_OPTIONS=k},12199:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(n(82492)),i=n(1063),o=n(2541);class s{constructor(e,t,n,a){this.updateEditData=e=>{this.saveEdits(),this.editData=(0,r.default)({},this.editData,e)},this.updateEditItems=(e,t)=>{this.saveEdits();const n=[];this.editData.items&&this.editData.items.forEach((e=>{e!==t&&n.push(e)})),n.push(e),this.editData.items=n},this.saveEdits=()=>{const e=new s(this.media,this.originalImage,this.editData,this.previous);this.previous=e},this.revertEdit=()=>{this.previous&&(this.editData=this.previous.editData,this.previous=this.previous.previous)},this.saveEditsFromCanvas=e=>{const t=e.toDataURL();this.editedImage||(this.editedImage=new Image),this.editedImage.src=t},this.exportEditedMedia=()=>{if(this.hasEdits()&&this.editedImage){const e=this.editedImage.src;return o.URL.dataURLtoFile(e)}return this.media instanceof File?this.media:(0,i.createFile)([this.media],"",{type:this.media.type})},this.hasEdits=()=>!!this.previous&&this.editedImage,this.cleanUp=()=>{window.URL.revokeObjectURL(this.originalImage.src)},this.media=e,t?this.originalImage=t:(this.originalImage=new Image,this.originalImage.src=window.URL.createObjectURL(e)),this.previous=a,this.editData={height:0,width:0,offsetX:0,offsetY:0,rotation:0,scale:1,items:[],baseItem:null},(0,r.default)(this.editData,n)}}t.default=s},16144:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(76304),i=n(29984),o=n(67294),s=a(n(214)),l=a(n(11791)),d=a(n(76557)),c=a(n(84215)),u=n(85893);function h(e,t){const{mediaEditController:n,editedMedia:a,mediaPickerStatsLogger:h,activeMediaId:f}=e,p=(0,o.useRef)(null),m=(0,o.useRef)(null),g=(0,o.useRef)(null),v=(0,o.useRef)(null),[_,x]=(0,o.useState)({height:1,width:1}),[C,y]=(0,o.useState)(null),[S,j]=(0,o.useState)(null),b=(e,t)=>{if(!p.current)return;const o=p.current;t&&h&&h.logChange(f||-1,t);const s=a.editData,l=(e=>{let t;return C?t=C:(t=new r.Easel.Stage(e),t.enableMouseOver()),n.stage=t,t})(o);e&&(o.width=s.width,o.height=s.height),l.removeAllChildren(),null!=s.baseItem&&l.addChild(s.baseItem),s.items&&l.addChild(...s.items);const d=a.originalImage.naturalWidth,c=a.originalImage.naturalHeight;l.regX=d/2,l.regY=c/2,l.rotation=s.rotation,(0,i.isNonZeroNumber)(s.width)&&(0,i.isNonZeroNumber)(s.height)&&(l.x=s.width/2+s.scale*s.offsetX,l.y=s.height/2+s.scale*s.offsetY),l.scaleX=s.scale,l.scaleY=s.scale,l.update(),x({width:o.width,height:o.height}),y(l)},E=()=>{const e=a.editData;a.editedImage=null;const t=a.originalImage;if(e.width||e.height||(e.width=t.naturalWidth,e.height=t.naturalHeight),!e.baseItem){const n=new r.Easel.Bitmap(t);e.baseItem=n}b(!0)},k=()=>{b(!0);const e=p.current;e&&a.saveEditsFromCanvas(e)},I=e=>{e&&(e.children.forEach((e=>{e.removeAllEventListeners()})),e.removeAllEventListeners(),e.removeAllChildren(),e.enableMouseOver(0),e.clear())};(0,o.useEffect)((()=>{(()=>{const e=a.originalImage;e.complete?E():e.onload=E})(),j(m.current),v.current=new r.Easel.Stage(g.current),v.current.autoClear=!1,v.current.enableMouseOver(),m.current&&(n.mediaContainer=m.current),n.cropOverlay=v.current}),[]),(0,c.default)((()=>{const e=a.originalImage;e.complete||(e.onload=void 0),k(),I(C),I(v.current)}));const w=(e,t)=>{x({width:e,height:t})};(0,o.useImperativeHandle)(t,(()=>({saveCanvas:k,drawCanvas:b,updateCanvasSize:w})));const T=(0,u.jsx)("canvas",{ref:g,className:s.default.cropOverlay});return(0,u.jsx)("div",{className:e.className,ref:m,children:(0,u.jsxs)(l.default,{type:e.fitType||"scaleDown",size:_,children:[T,(0,u.jsx)(d.default,{ref:p,className:s.default.mediaViewerImg})]})})}var f=(0,o.forwardRef)(h);t.default=f},47739:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n(11290);class r extends a.BaseModel{constructor(){super(...arguments),this.stage=(0,a.prop)(),this.cropOverlay=(0,a.prop)(),this.mediaContainer=(0,a.prop)(),this.isInitialized=(0,a.derived)(this._isInitialized,["stage","cropOverlay","mediaContainer"])}_isInitialized(){return!!this.stage&&!!this.cropOverlay&&!!this.mediaContainer}clearStage(e){e&&(e.children.forEach((e=>{e.removeAllEventListeners()})),e.removeAllEventListeners(),e.removeAllChildren(),e.clear())}}var i=(0,a.defineModel)(r);t.default=i},558:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PROF_PIC_THUMB_SIDE=t.PROF_PIC_MIN_SIDE=t.PROF_PIC_MAX_SIDE=void 0;t.PROF_PIC_MIN_SIDE=192;t.PROF_PIC_MAX_SIDE=640;t.PROF_PIC_THUMB_SIDE=96},92144:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(n(48926)),i=n(76304),o=n(67294),s=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=f(t);if(n&&n.has(e))return n.get(e);var a={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var o=r?Object.getOwnPropertyDescriptor(e,i):null;o&&(o.get||o.set)?Object.defineProperty(a,i,o):a[i]=e[i]}a.default=e,n&&n.set(e,a);return a}(n(36638)),l=n(558),d=a(n(50922)),c=a(n(23217)),u=n(19529),h=n(85893);function f(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(f=function(e){return e?n:t})(e)}const p=1.1;function m(e,t){const{editedMedia:n,cropOverlay:a,drawCanvas:f}=e,m=(0,o.useRef)(0),g=e=>{const t=m.current,a=n.editData,r=Math.max(2*t/a.width,2*t/a.height),i=Math.max(e,r);if(a.width*e<t||a.height*e<t)return!1;const o=-t/i+a.width/2,s=t/i-a.width/2,l=-t/i+a.height/2,d=t/i-a.height/2;return{scale:i,offsetX:Math.min(Math.max(a.offsetX,s),o),offsetY:Math.min(Math.max(a.offsetY,d),l)}},v=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:p;const t=n.editData,a=0!==e?e:p,r=g(t.scale*a);r&&(t.scale=r.scale,t.offsetX=r.offsetX,t.offsetY=r.offsetY,f())},_=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:p;const t=n.editData,a=0!==e?e:p,r=g(t.scale/a);r&&(t.scale=r.scale,t.offsetX=r.offsetX,t.offsetY=r.offsetY,f())};(0,u.useListener)(a.canvas,"mousewheel",(e=>{e.deltaY>0?v(1.02):_(1.02)}));const x=(e,t)=>{const a=n.editData,r=e.stageX-t.x,i=e.stageY-t.y,o=a.offsetX+r/a.scale,s=a.offsetY+i/a.scale,l=((e,t)=>{const a=m.current,r=n.editData,i=(e-r.width/2)*r.scale,o=(e+r.width/2)*r.scale,s=(t+r.height/2)*r.scale;return{x:i<-a&&o>a,y:(t-r.height/2)*r.scale<-a&&s>a}})(o,s);l.x&&(a.offsetX=o),l.y&&(a.offsetY=s),t.x=e.stageX,t.y=e.stageY,f()};(0,o.useEffect)((()=>{n.saveEdits();const e=n.editData,t=a.canvas;let r;r=e.baseItem?e.baseItem.getBounds():{width:0,height:0},t.style.display="block",t.width=r.width,t.height=r.height;const o=new i.Easel.Shape;o.graphics.beginFill("rgba(0, 0, 0, 0.1)"),o.graphics.drawRect(0,0,r.width,r.height),o.regX=r.width/2,o.regY=r.height/2,o.x=r.width/2,o.y=r.height/2,o.on("mousedown",(e=>{const t={x:e.stageX,y:e.stageY},n=o.on("pressmove",x,null,!1,t);o.on("pressup",(()=>{o.off("pressmove",n)}),null,!0)})),o.cursor="move";const s=t.getContext("2d"),l=t.width,d=t.height,c=l/d>500/361?d/361:l/500;m.current=Math.min(361,500)/2*.9*c;const u=m.current;s.fillStyle="rgba(0, 0, 0, 0.5)",s.fillRect(0,0,l,d),s.globalCompositeOperation="destination-out",s.beginPath(),s.arc(l/2,d/2,u,0,2*Math.PI,!0),s.fillStyle="#ffffff",s.fill(),a.addChild(o),a.update()}),[]);const C=function(){var e=(0,r.default)((function*(){var e;const t=n.editData,a=null===(e=n.editedImage)||void 0===e?void 0:e.src,r=m.current;if(!a)throw new Error("empty image");const i=2*r;let o=i;i>l.PROF_PIC_MAX_SIDE?o=l.PROF_PIC_MAX_SIDE:i<l.PROF_PIC_MIN_SIDE&&(o=l.PROF_PIC_MIN_SIDE);const d=yield s.crop(a,(t.width-2*r)/2,(t.height-2*r)/2,2*r,2*r,o,o,s.DATA_URL|s.CANVAS),c=d.images.dataUrl;return{thumb:(yield s.crop(d.images.canvas,0,0,l.PROF_PIC_THUMB_SIDE,l.PROF_PIC_THUMB_SIDE)).images.dataUrl,full:c}}));return function(){return e.apply(this,arguments)}}();return(0,o.useImperativeHandle)(t,(()=>({crop:C}))),(0,h.jsxs)("div",{className:d.default.scaler,children:[(0,h.jsx)("div",{className:d.default.scalerButton,onClick:()=>{v()},children:(0,h.jsx)(c.default,{name:"plus"})}),(0,h.jsx)("div",{className:d.default.scalerButton,onClick:()=>{_()},children:(0,h.jsx)(c.default,{name:"minus"})})]})}var g=(0,o.forwardRef)(m);t.default=g},76557:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n(67294),r=n(85893);function i(e,t){return(0,r.jsx)("canvas",{className:e.className,ref:t})}function o(e,t){return e.className===t.className}var s=(0,a.memo)((0,a.forwardRef)(i),o);t.default=s},56318:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const[t,n]=(0,i.useState)(e.initialDuration),[a,x]=(0,g.default)(p.NUX.EPHEMERAL),C=e=>n(parseInt(e.target.value,10));let y;y=a?(0,v.jsx)(d.default,{fromMe:!0}):(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(m.TextParagraph,{xstyle:_.explanation,children:r.fbt._("All new messages in this chat will disappear after the selected duration.",null,{hk:"4lToiN"})}),(0,h.getAllDurations)().map((e=>{let{value:n,label:a}=e;return(0,v.jsx)("div",{className:(0,o.default)(_.option),children:(0,v.jsxs)("label",{className:(0,o.default)(_.label),children:[(0,v.jsx)("input",{type:"radio",className:(0,o.default)(_.input),value:String(n),checked:n===t,onChange:C}),a]})},`option-${n}`)}))]});return(0,v.jsx)(l.default,{title:a?void 0:r.fbt._("Disappearing messages",null,{hk:"384ocn"}),onOK:a?()=>{x()}:()=>{e.onDurationSelected(t),s.Cmd.closeModal()},onCancel:a?()=>{(0,c.openExternalLink)((0,u.getEphemeralFaqUrl)())}:()=>{s.Cmd.closeModal()},cancelText:a?f.default.t(554):r.fbt._("Cancel",null,{hk:"H0gNq"}),children:y})};var r=n(48360),i=n(67294),o=a(n(56720)),s=n(88102),l=a(n(52665)),d=a(n(70263)),c=n(12591),u=n(96384),h=n(71206),f=a(n(43725)),p=n(61653),m=n(13923),g=a(n(54416)),v=n(85893);const _={option:{display:"p357zi0d",alignItems:"gndfcl4n",height:"sai7fuui"},label:{display:"f804f6gw",cursor:"ajgl1lbb"},input:{marginEnd:"claouzo6",verticalAlign:"neme6l2y"},explanation:{marginBottom:"t4zgqcuo"}}},67247:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){let{frequentlyForwardedCount:t,totalCount:n}=e;const a=(0,u.jsxs)("span",{className:l.default.text,children:[1===t&&1===n?r.fbt._("This message will be marked as forwarded many times.",null,{hk:"37i1m9"}):r.fbt._("One or more messages will be marked as forwarded many times.",null,{hk:"1Z8wFQ"})," ",(0,u.jsx)(o.ExternalLink,{href:(0,s.getFrequentlyForwardedFaqUrl)(),children:d.default.t(554)})]});return(0,u.jsxs)("div",{className:l.default.wrapper,children:[(0,u.jsx)("div",{className:l.default.icon,children:(0,u.jsx)(c.default,{name:"highly-forwarded"})}),(0,u.jsx)(i.default,{theme:"plain",primary:a,idle:!0})]})};var r=n(48360),i=a(n(44356)),o=n(12591),s=n(96384),l=a(n(83123)),d=a(n(43725)),c=a(n(23217)),u=n(85893)},90089:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(89385),i=n(50796),o=n(13959),s=n(48360),l=n(67294),d=a(n(44356)),c=n(88102),u=a(n(26609)),h=n(88984),f=a(n(60453)),p=a(n(69637)),m=a(n(64738)),g=n(94790),v=n(65417),_=n(85600),x=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=N(t);if(n&&n.has(e))return n.get(e);var a={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var o=r?Object.getOwnPropertyDescriptor(e,i):null;o&&(o.get||o.set)?Object.defineProperty(a,i,o):a[i]=e[i]}a.default=e,n&&n.set(e,a);return a}(n(64103)),C=n(7293),y=n(73058),S=a(n(57363)),j=a(n(21649)),b=n(55800),E=a(n(43725)),k=n(74028),I=a(n(84644)),w=n(52596),T=n(11234),P=a(n(51628)),M=a(n(23217)),L=n(50452),O=n(49082),A=a(n(38080)),D=n(77591),R=n(85893);function N(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(N=function(e){return e?n:t})(e)}const F="group-invite-link-anchor",B=0,U=1,H=2;function G(e){let t,{state:n,chat:a,groupMetadata:r,onDrawerButtonClick:i,onSendLinkButtonClick:o}=e;if(n===B)t=(0,R.jsx)(_.LoadingWithText,{text:E.default.t(485)});else if(n===U)t=(0,R.jsx)(_.LoadingWithText,{text:E.default.t(493,{groupName:a.contact.name})});else{const e=r.groupInviteLink;let n=null;document.queryCommandSupported("copy")&&(n=(0,R.jsx)(u.default,{elementId:F}));const l=(0,R.jsx)(h.DetailImage,{id:a.id,size:82,quality:h.DETAIL_IMAGE_QUALITY.HIGH}),c=(0,R.jsx)("span",{className:S.default.linkContainer,children:(0,R.jsx)(w.SelectableLink,{id:F,href:e,selectable:!0,children:e})});t=(0,R.jsxs)(p.default,{children:[(0,R.jsx)(d.default,{image:l,primary:(0,R.jsx)(v.EmojiText,{text:a.contact.name,direction:"auto"}),theme:"identity",secondary:c}),(0,R.jsx)("div",{className:S.default.descContainer,children:E.default.t(488)}),(0,R.jsx)(P.default,{onClick:o}),n,(0,R.jsx)(m.default,{a8nText:"li-revoke-link",icon:(0,R.jsx)(M.default,{name:"revoke",className:S.default.icon}),onClick:i,children:s.fbt._("Reset link",null,{hk:"37cdK4"})})]})}return t}function W(e,t){const{onBack:n,chat:a}=e,[d,u]=(0,l.useState)(B),h=(0,A.default)(),p=(0,O.useModelValues)(e.groupMetadata,["inviteCode","groupInviteLink"]),m=e=>{switch(e){case 401:return E.default.t(490);case 403:return s.fbt._("You can't view this group's invite link because you're no longer a participant.",null,{hk:"4fEfyY"});case 404:return s.fbt._("You can't view this group's invite link because this group has ended.",null,{hk:"2fhpj0"});case 436:return s.fbt._("Invite via link is temporarily unavailable for this group.",null,{hk:"11ALNM"});default:return E.default.t(491)}};(0,l.useEffect)((()=>{(0,I.default)((0,y.queryGroupInviteCode)(p),h).then((()=>{u(H)})).catch((0,i.filteredCatch)(D.ServerStatusCodeError,(e=>{(e=>{const t=m(e);n(),436===e&&(C.GK.supportsFeature(C.GK.F.MD_BACKEND)&&(0,k.queryAndUpdateGroupMetadataById)(a.id),(0,b.openGrowthLockedModal)(!0)),c.Cmd.openToast((0,R.jsx)(L.Toast,{msg:t,id:(0,L.genId)()}))})(e.statusCode)}))).catch((0,r.catchAbort)((()=>{})))}),[]);const v=()=>{u(U);const e=(0,y.revokeGroupInvite)(p);(0,o.delayMs)(500).then((()=>e)).then((()=>{c.Cmd.openToast((0,R.jsx)(L.Toast,{msg:s.fbt._("The previous invite link is now reset and a new invite link has been created.",null,{hk:"2RPI3K"}),id:(0,L.genId)()})),u(H)})).catch((0,i.filteredCatch)(D.ServerStatusCodeError,(e=>{(e=>{const t=m(e);n(),c.Cmd.openToast((0,R.jsx)(L.Toast,{msg:t,id:(0,L.genId)()}))})(e.statusCode)}))).catch((0,i.filteredCatch)(x.Unmount,(()=>{})))};return(0,R.jsxs)(f.default,{ref:t,children:[(0,R.jsx)(g.DrawerHeader,{title:s.fbt._("Invite to group via link",null,{hk:"3vDtFL"}),onBack:e.onBack,rtlFixIfOnDarwin:!0,type:g.DRAWER_HEADER_TYPE.SMALL}),(0,R.jsx)(G,{state:d,chat:a,groupMetadata:p,onDrawerButtonClick:()=>{c.Cmd.openModal((0,R.jsx)(j.default,{pushTransition:"none",popTransition:"none",chat:a,onConfirm:v}),{transition:"modal-flow"})},onSendLinkButtonClick:()=>{c.Cmd.openModal((0,R.jsx)(T.SendGroupInviteFlowLoadable,{chat:a}),{transition:"modal-flow"})}})]})}var V=(0,l.forwardRef)(W);t.default=V},78582:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{onConfirm:t}=e;return(0,d.jsx)(o.default,{title:r.fbt._("Reset link",null,{hk:"37cdK4"}),onOK:()=>{t(),i.Cmd.closeModal()},okText:r.fbt._("Reset link",null,{hk:"37cdK4"}),onCancel:()=>{i.Cmd.closeModal()},cancelText:r.fbt._("Cancel",null,{hk:"H0gNq"}),children:(0,d.jsx)("div",{className:s.default.confirmationText,children:l.default.t(492,{groupName:e.chat.contact.name})})})};var r=n(48360),i=n(88102),o=a(n(52665)),s=a(n(26297)),l=a(n(43725)),d=n(85893)},41552:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const t=(0,G.useModelValues)(e.msg,["id","star","type","isGif","isViewOnce","labels","numTimesForwarded","isFrequentlyForwarded","chat"]),n=(0,B.default)(),a=(0,V.default)(),K=(0,W.default)(),Y=(0,U.default)((()=>new v.default)),Q=(0,U.default)((()=>new I.default.UiAction({uiActionType:I.default.UI_ACTION_TYPE.MSG_INFO_OPEN,uiActionPreloaded:!0}))),X=(0,d.useRef)(null),Z=(0,d.useRef)(null),[J,$]=(0,d.useState)(void 0),[ee,te]=(0,d.useState)(!1);(0,d.useEffect)((()=>{var e;T.MsgInfoCollection.find(t.id).then((e=>{a.aborted||$(e)})).catch((()=>{te(!0),u.Cmd.openToast((0,q.jsx)(F.Toast,{msg:l.fbt._("Couldn't display message info. Try again later.",null,{hk:"mRFf6"}),id:(0,F.genId)("msg_info_failed")}))}));const n=null===(e=X.current)||void 0===e?void 0:e.container;t.type===s.MSG_TYPE.IMAGE&&n&&(n.scrollTop=n.scrollHeight);const r=Q.current;if(r){var i;const e=null===(i=x.default.get(t.chat.id))||void 0===i?void 0:i.cachedDeviceSizeBucket;null!=e&&(r.sizeBucket=e),r.markUiActionT(),r.commit(),(0,L.logUiActionShadowPrivateStatsTestEvents)(),Q.current=void 0}}),[]);const ne=()=>{var e;return null===(e=Z.current)||void 0===e?void 0:e.getMsgComponentRef()};let ae;(0,H.useListener)(null==J?void 0:J.played,["add","remove"],n),(0,H.useListener)(null==J?void 0:J.read,["add","remove"],n),(0,H.useListener)(null==J?void 0:J.delivery,["add","remove"],n),(0,H.useListener)(t,"remove",((e,t)=>{t===w.MsgCollection&&(null==K||K.uie.requestDismiss())})),J||ee||(ae=(0,q.jsx)("div",{className:y.default.spinner,children:(0,q.jsx)(D.Spinner,{size:50,stroke:4})},"spinner"));const re=(()=>{const e=[],n=t.type===s.MSG_TYPE.PTT,a=n||t.isViewOnce;if(J&&a){let t=n?j.SECTIONS.PLAYED_HEADER:j.SECTIONS.VIEWED_HEADER;e.push({kind:"section",type:t,itemKey:t,height:50}),e.push(...J.played.map((e=>({participant:e,kind:"row",itemKey:e.id.toString(),height:g.DEFAULT_ITEM_HEIGHT})))),J.playedRemaining>0&&(t=n?j.SECTIONS.PLAYED_FOOTER:j.SECTIONS.VIEWED_FOOTER,e.push({kind:"section",type:t,itemKey:t,height:50}))}return J&&(J.read.length>0||J.playedRemaining>0)&&(e.push({kind:"section",type:a?j.SECTIONS.SEEN_HEADER:j.SECTIONS.READ_HEADER,itemKey:j.SECTIONS.READ_HEADER,height:50}),e.push(...J.read.map((e=>({participant:e,kind:"row",itemKey:e.id.toString(),height:g.DEFAULT_ITEM_HEIGHT})))),J.readRemaining>0&&e.push({kind:"section",type:j.SECTIONS.READ_FOOTER,itemKey:a?j.SECTIONS.SEEN_FOOTER:j.SECTIONS.READ_FOOTER,height:50})),J&&(J.delivery.length>0||J.deliveryRemaining>0)&&(e.push({kind:"section",type:j.SECTIONS.DELIVERED_HEADER,itemKey:j.SECTIONS.DELIVERED_HEADER,height:50}),e.push(...J.delivery.map((e=>({participant:e,kind:"row",itemKey:e.id.toString(),height:g.DEFAULT_ITEM_HEIGHT})))),J.deliveryRemaining>0&&e.push({kind:"section",type:j.SECTIONS.DELIVERED_FOOTER,itemKey:j.SECTIONS.DELIVERED_FOOTER,height:50})),t.numTimesForwarded>0&&!t.isFrequentlyForwarded&&e.push({kind:"section",type:j.SECTIONS.FORWARD_COUNT,itemKey:j.SECTIONS.FORWARD_COUNT,height:60}),e})(),ie=re.length?(0,q.jsx)(g.FlatList,{flatListController:Y.current,direction:"vertical",forceConsistentRenderCount:!1,data:re,renderItem:e=>{if("row"===e.kind)return n=e.participant,(0,q.jsx)(C.default,{msgInfoParticipant:n,contact:n.contact,theme:"drawer-list"},n.id.toString());var n,a;if(e.type===j.SECTIONS.FORWARD_COUNT)return A.ServerProps.hfmStringChanges?null:(0,q.jsx)("div",{className:y.default.forwardCount,children:(0,q.jsx)(P.default,{msg:t})});switch(e.type){case j.SECTIONS.PLAYED_HEADER:case j.SECTIONS.READ_HEADER:case j.SECTIONS.SEEN_HEADER:case j.SECTIONS.DELIVERED_HEADER:case j.SECTIONS.VIEWED_HEADER:return(e=>{let n,a;switch(e){case j.SECTIONS.PLAYED_HEADER:a=(0,q.jsx)(R.default,{name:"status-ptt",className:y.default.statusBlue}),n=E.default.t(621);break;case j.SECTIONS.READ_HEADER:a=(0,q.jsx)(R.default,{name:"status-dblcheck",className:y.default.ack}),n=E.default.t(623);break;case j.SECTIONS.SEEN_HEADER:a=(0,q.jsx)(R.default,{name:"status-dblcheck",className:y.default.ack}),n=t.isViewOnce?l.fbt._("Seen by",null,{hk:"3MxARC"}):l.fbt._("Seen by",null,{hk:"3vzp0U"});break;case j.SECTIONS.DELIVERED_HEADER:a=(0,q.jsx)(R.default,{name:"status-dblcheck"}),n=E.default.t(619);break;case j.SECTIONS.VIEWED_HEADER:a=(0,q.jsx)(R.default,{name:"view-once-viewed",className:y.default.statusBlue}),n=l.fbt._("Opened by",null,{hk:"1BkoM7"});break;default:return __LOG__(4,void 0,new Error)`Invalid SECTION for group message info section header`,null}return a=(0,q.jsx)("div",{className:y.default.titleIcon,children:a}),(0,q.jsx)("div",{"data-a8n":i.default.key("msg-info-title"),className:y.default.title,children:(0,q.jsx)(O.default,{side:a,ellipsify:!0,children:(0,q.jsx)(N.TextSpan,{theme:"section-title",children:n})})})})(e.type);default:return a=e.type,(0,q.jsx)(S.default,{section:a,msgInfo:(0,r.default)(J,"msgInfo")},a)}}}):null;let oe=null;t.labels&&t.labels.length>0&&(0,_.canDisplayLabel)()&&(oe=(0,q.jsx)(m.default,{theme:"padding",children:(0,q.jsx)(b.default,{labels:t.labels})}));return(0,q.jsxs)(h.default,{theme:"striped",children:[(0,q.jsx)(p.DrawerHeader,{title:E.default.t(617),type:p.DRAWER_HEADER_TYPE.SMALL,rtlFixIfOnDarwin:!0,onCancel:()=>{null==K||K.uie.requestDismiss()}}),(0,q.jsx)(M.default,{ref:X,chatPreference:c.default.assertGet("defaultPreference"),children:(0,q.jsx)(z.Wrapper,{msg:t,ref:Z,displayType:o.DISPLAY_TYPE.MSG_INFO,isMsgVisible:function(e){let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e===t.id&&(!!n||ne())},position:k.MsgPosition.END,onProductClick:e.onProductClick})}),(0,q.jsxs)(f.default,{flatListControllers:[Y.current],children:[oe,ae,(0,q.jsx)("div",{className:y.default.list,children:ie})]})]},"message-info-modal")};var r=a(n(45095)),i=a(n(99964)),o=n(5177),s=n(15461),l=n(48360),d=n(67294),c=a(n(66034)),u=n(88102),h=a(n(60453)),f=a(n(69637)),p=n(94790),m=a(n(33308)),g=n(47915),v=a(n(30855)),_=n(57701),x=a(n(63928)),C=a(n(47834)),y=a(n(67371)),S=a(n(95164)),j=n(59996),b=a(n(77577)),E=a(n(43725)),k=n(87931),I=a(n(11339)),w=n(59871),T=n(17972),P=a(n(82678)),M=a(n(1697)),L=n(7595),O=a(n(53145)),A=n(64551),D=n(11054),R=a(n(23217)),N=n(13923),F=n(50452),B=a(n(59909)),U=a(n(59552)),H=n(19529),G=n(49082),W=a(n(59147)),V=a(n(38080)),z=n(58827),q=n(85893)},95164:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const t=(0,d.useModelValues)(e.msgInfo,["playedRemaining","readRemaining","deliveryRemaining"]);let n,a,u;switch(e.section){case o.SECTIONS.PLAYED_FOOTER:case o.SECTIONS.VIEWED_FOOTER:n=t.playedRemaining,a=t.playedRemaining;break;case o.SECTIONS.READ_FOOTER:case o.SECTIONS.SEEN_FOOTER:n=t.readRemaining,a=t.readRemaining;break;case o.SECTIONS.DELIVERED_FOOTER:n=t.deliveryRemaining,a=t.deliveryRemaining;break;default:return __LOG__(4,void 0,new Error)`Invalid SECTION for group message info section footer`,null}if(null==n||0===n)return null;u={count:n,_plural:a};const h=s.default.t(624,u);return(0,c.jsx)("div",{"data-a8n":r.default.key("msg-info-remaining"),className:i.default.footer,children:(0,c.jsx)(l.TextSpan,{theme:"muted",children:h})})};var r=a(n(99964)),i=a(n(67371)),o=n(59996),s=a(n(43725)),l=n(13923),d=n(49082),c=n(85893)},59996:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SECTIONS=void 0;const a=n(76672).Mirrored(["DELIVERED_FOOTER","DELIVERED_HEADER","FORWARD_COUNT","PLAYED_FOOTER","PLAYED_HEADER","READ_FOOTER","READ_HEADER","SEEN_FOOTER","SEEN_HEADER","VIEWED_FOOTER","VIEWED_HEADER"]);t.SECTIONS=a},14767:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{onClose:t,gid:n,onSend:a}=e,j=(0,o.useRef)(null),b=(0,o.useRef)(null),[E,k]=(0,o.useState)(i.fbt._("Invitation to join my WhatsApp group",null,{hk:"2WNS77"}).toString()),I=(0,S.jsx)(_.Round,{a8nText:"group-participants-btn",large:!0,onClick:()=>{(()=>{const e=v.ProfilePicThumbCollection.get(n);return new Promise((t=>{e&&e.img?(0,f.default)(e.img).then((e=>{if(e.ok)return e.blob();t(void 0)})).then((e=>{if(!e)return;const n=new FileReader;n.onloadend=function(){const e=n.result;if(null==e)return void t(void 0);const a=e.toString().split(",")[1];t(a)},n.readAsDataURL(e)})).catch((()=>t(void 0))):t(void 0)}))})().then((e=>{a(E,e)}))},children:(0,S.jsx)(x.default,{name:"send",directional:!0})}),w=(0,S.jsx)(l.DetailImage,{id:e.gid}),T=(0,S.jsx)(h.EmojiText,{text:e.subject});return(0,S.jsx)(m.Modal,{type:m.ModalTheme.Invite,children:(0,S.jsxs)(d.default,{theme:"invite",children:[(0,S.jsx)(u.DrawerHeader,{type:u.DRAWER_HEADER_TYPE.POPUP,title:i.fbt._("Send invite to...",null,{hk:"2Yaa3P"}),onCancel:()=>{t()}}),(0,S.jsxs)(c.default,{children:[(0,S.jsx)("div",{className:p.default.search,children:(0,S.jsx)("div",{"data-list-scroll-container":!0,children:(0,S.jsx)(g.default,{ref:j,theme:"list-names",contacts:e.participants.map((e=>e.contact))})})}),(0,S.jsx)("div",{className:p.default.commentInput,children:(0,S.jsx)(C.TextInput,{a8n:"groups-v4-invite-add-comment-input",ref:b,value:E,showRemaining:!0,maxLength:r.default.MAX_CAPTION_LENGTH,onChange:e=>{k(e)},theme:"v4-invite-caption",supportsEmoji:!0})}),(0,S.jsx)(y.default,{transitionName:"btn",className:p.default.onSendInvite,children:I}),(0,S.jsx)("div",{className:p.default.groupInfo,children:(0,S.jsx)(s.default,{idle:!0,image:w,primary:T,secondary:i.fbt._("WhatsApp group invite",null,{hk:"Yox1t"}),theme:"group_v4_invite"})})]})]})})};var r=a(n(64369)),i=n(48360),o=n(67294),s=a(n(44356)),l=n(88984),d=a(n(60453)),c=a(n(69637)),u=n(94790),h=n(65417),f=a(n(18561)),p=a(n(4025)),m=n(57224),g=a(n(53153)),v=n(82039),_=n(82857),x=a(n(23217)),C=n(90011),y=a(n(41956)),S=n(85893)},12500:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(n(63105)),i=a(n(35161)),o=n(13959),s=n(67294),l=n(65511),d=n(85600),c=a(n(43725)),u=a(n(67568)),h=a(n(48690)),f=a(n(87481)),p=a(n(81559)),m=a(n(59552)),g=n(85893);function v(e,t){const{onCancel:a,chats:v,filter:_=(()=>!0),onGroup:x}=e,C=(0,s.useRef)(null),y=(0,m.default)((()=>new f.default([],(e=>e)))),[S,j]=(0,s.useState)(!0),[b,E]=(0,s.useState)(void 0);(0,s.useEffect)((()=>{(0,o.delayMs)(300).then((()=>Promise.all((0,i.default)((0,r.default)(v,(e=>{var t;return null===(t=e.groupMetadata)||void 0===t?void 0:t.stale})),(e=>{var t;return n(63928).default.update(null===(t=e.groupMetadata)||void 0===t?void 0:t.id).catch((()=>{}))}))))).then((()=>j(!1)))}),[]);const k=()=>C.current;(0,s.useImperativeHandle)(t,(()=>({getElement:k})));const I=(0,p.default)(E,100),w=S?(0,g.jsx)(d.Loading,{}):(0,g.jsx)(d.SearchGroups,{});return(0,g.jsx)(u.default,{title:c.default.t(933),data:(()=>{if(S)return[];const e=c.default.accentFold(b),t=(0,h.default)(e),n=v.filter((n=>_(n)&&(!e||e&&n.contact.searchMatch(e,t))));return y.current.init(n.filter((e=>!0===_(e))).map((e=>e.id))),n.map((e=>({chat:e,itemKey:e.id.toString()})))})(),renderItem:e=>{let t,n;const a=_(e.chat),r="boolean"!=typeof a;return r&&(t=a,n="group-modal"),(0,g.jsx)(l.Chat,{chat:e.chat,contact:e.chat.contact,mode:l.Mode.INFO,active:y.current,secondary:t,noContext:!0,theme:n,onClick:r?void 0:x.bind(null,e.chat)})},emptyState:w,selection:y.current,onCancel:a,onSearch:I,onSelect:(e,t)=>{if(!(t instanceof l.Mode))return;const n=t.props.chat;!0===_(n)&&x(t.props.chat)},onRef:e=>{C.current=e},searchPlaceholder:c.default.t(735)})}var _=(0,s.forwardRef)(v);t.default=_},15048:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const t=(0,i.useRef)(-1),n=(0,i.useRef)(!1),a=(e,a)=>{(0,x.logSessionEvent)(e,t.current,a),n.current=!0};(0,i.useEffect)((()=>(t.current=performance.now(),s.AssetLoader.loadAsset(k,s.LOAD_PRIORITY.HELP_ANIMATED_DOODLE),()=>{n.current||a(C.default.CONTACT_US_EXIT_STATE.CANCELLED)})),[]);const o=()=>{a(C.default.CONTACT_US_EXIT_STATE.PROBLEM_DESCRIPTION)},I=e=>{a(C.default.CONTACT_US_EXIT_STATE.EMAIL_SEND,e)},w=()=>{},T=()=>{l.Cmd.openModal((0,E.jsx)(_.LicensesPopupLoadable,{onOk:w}))};let P;j.UA.isElectron&&(P=(0,E.jsx)(h.default,{a8nText:"li-licenses",onClick:T,icon:(0,E.jsx)(y.default,{name:"settings-document",height:24}),children:r.fbt._("Licenses",null,{hk:"39PWhp"})}));return(0,E.jsxs)(c.default,{children:[(0,E.jsx)(f.DrawerHeader,{a8n:"drawer-title-help",title:v.default.t(526),onBack:e.onClose,type:f.DRAWER_HEADER_TYPE.LARGE}),(0,E.jsxs)(u.default,{children:[(0,E.jsx)("div",{className:g.default.animation}),(0,E.jsx)(b.default,{className:g.default.versionInfo}),(0,E.jsx)(h.default,{a8nText:"li-faq",icon:(0,E.jsx)(y.default,{name:"settings-help"}),onClick:()=>{(0,p.openExternalLink)((0,m.getFaqUrl)()),a(C.default.CONTACT_US_EXIT_STATE.FAQ)},children:r.fbt._("Help Center",null,{hk:"22rPCE"})}),(0,E.jsx)(h.default,{a8nText:"li-contact-us",icon:(0,E.jsx)(y.default,{name:"group"}),onClick:()=>{l.Cmd.openModal((0,E.jsx)(d.default,{onCancel:o,onSend:I}))},children:v.default.t(761)}),P,(0,E.jsx)(h.default,{a8nText:"li-tos",icon:(0,E.jsx)(y.default,{name:"settings-document",height:24}),onClick:()=>{n.current=!0,(0,p.openExternalLink)((0,S.getTosUrl)())},children:r.fbt._("Terms and Privacy Policy",null,{hk:"y6imq"})}),undefined,undefined]})]})};var r=n(48360),i=n(67294),o=a(n(9349)),s=n(89721),l=n(88102),d=a(n(50485)),c=a(n(60453)),u=a(n(69637)),h=a(n(64738)),f=n(94790),p=n(12591),m=n(96384),g=a(n(77798)),v=a(n(43725)),_=n(88240),x=n(93045),C=a(n(11339)),y=a(n(23217)),S=n(73915),j=n(65127),b=a(n(56204)),E=n(85893);const k={id:"animated-doodle",selectors:[`.${g.default.animation}`],low:{default:o.default},high:{default:o.default}}},99413:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.search=function(){return m.apply(this,arguments)};var r=a(n(48926)),i=a(n(11854)),o=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=d(t);if(n&&n.has(e))return n.get(e);var a={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var o=r?Object.getOwnPropertyDescriptor(e,i):null;o&&(o.get||o.set)?Object.defineProperty(a,i,o):a[i]=e[i]}a.default=e,n&&n.set(e,a);return a}(n(64103)),s=a(n(43725)),l=n(2541);function d(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(d=function(e){return e?n:t})(e)}const c="https://www.bingapis.com/api/v6/images/search",u="D41D8CD98F00B204E9800998ECF8427E4F4A7492",h="Square",f="Medium",p={ar:"ar-SA",da:"da-DK",de:"de-DE",en:"en-US",es:"es-US",fi:"fi-FI",fr:"fr-FR",it:"it-IT",ko:"ko-KR",nl:"nl-NL",pl:"pl-PL","pt-BR":"pt-BR",ru:"ru-RU",sv:"sv-SE",tr:"tr-TR","zh-CN":"zh-CN","zh-TW":"zh-TW","zh-HK":"zh-HK"};function m(){return(m=(0,r.default)((function*(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:30;const a={q:e,SafeSearch:"Strict",appid:u,mkt:p[s.default.getLocale()]||p.en,size:f,aspect:h,count:n,offset:t},r=l.URL.build(c,a),d=yield i.default.get(r,i.default.RESP_TYPE.JSON);if(!d.response.hasOwnProperty("_type"))throw new o.InvalidServerResponseError(r,status,`Not a valid Bing response: ${JSON.stringify(d.response)}`);if("ErrorResponse"===d.response._type){const t=d.response;throw new o.BingServerError(e,d.status,t)}if("Images"!==d.response._type)throw new o.InvalidServerResponseError(r,status,`Did not receive an image search response, potentially malformed query ${JSON.stringify(d.response)}`);return d.response}))).apply(this,arguments)}},90312:(e,t,n)=>{"use strict";var a=n(59182).default,r=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{onImageSelected:t}=e,n=(0,M.default)(),r=(0,f.useRef)(null),A=(0,f.useRef)(null),D=(0,f.useRef)(null),R=(0,f.useRef)(!1),N=(0,f.useRef)(null),[F,B]=(0,f.useState)({}),[U,H]=(0,f.useState)(!1),[G,W]=(0,f.useState)(0),[V,z]=(0,f.useState)(""),[q,K]=(0,f.useState)([]),[Y,Q]=(0,f.useState)(0),X=(0,P.default)(((e,t)=>{R.current=!1;const n=new a,r=p.search(e,t).then((t=>{var a;if(n.signal.aborted)throw new l.AbortError;r===(null===(a=N.current)||void 0===a?void 0:a.promise)&&(((e,t)=>{const n=(0,s.default)(t.value,(e=>e.thumbnailUrl)),a=(0,o.default)(t.value,(e=>({id:e.imageId,name:e.name,thumbUrl:e.thumbnailUrl}))),r=t.value.length;var l,d;V===e?(W(t.nextOffset?t.nextOffset:G+r),K((0,i.default)(q,a)),Q(null!==(l=t.totalEstimatedMatches)&&void 0!==l?l:0),B(Object.assign(n,F))):(B(n),W(t.nextOffset?t.nextOffset:G+r),z(V),K(a),Q(null!==(d=t.totalEstimatedMatches)&&void 0!==d?d:0))})(e,t),H(!1))})).catch((0,l.catchAbort)((()=>{}))).catch((()=>{var e;__LOG__(3,!0)`Image search failed`,m.Cmd.openToast((0,O.jsx)(w.Toast,{msg:h.fbt._("Image search failed",null,{hk:"9pHyN"}),id:(0,w.genId)()})),r===(null===(e=N.current)||void 0===e?void 0:e.promise)&&H(!1)})).finally((()=>{var e;r===(null===(e=N.current)||void 0===e?void 0:e.promise)&&(N.current=null)}));N.current={promise:r,controller:n},H(!0)}),750),Z=()=>{X.cancel(),R.current&&(R.current=!1),N.current&&N.current.controller.abort()},J=()=>{B({}),H(!1),W(0),z(""),K([]),Q(0)},$=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;R.current=!0,X(e,t)},ee=()=>{R.current||N.current||!Y||G>=Y||$(V,G)},te=e=>{const a=F[e];if(!a)return;const r=a.contentUrl;let i;if(T.UA.isElectron)i=(0,I.default)((()=>(0,y.default)(r))).then((e=>{if(200!==e.status)throw new C.ServerStatusError(null,r,e.status);return e.blob()}));else{if(j.GK.supportsFeature(j.GK.F.MD_BACKEND))throw new Error("This call is only supported in non-MD mode");i=L.default.downloadImage(r)}i.then((e=>{if(!n.aborted){if(!(e instanceof Blob))throw new C.ImageError("Server did not respond with image bytes",r);t(e,a.hostPageUrl)}})).catch((()=>{__LOG__(3,!0)`Image search failed`,m.Cmd.openToast((0,O.jsx)(w.Toast,{msg:h.fbt._("Failed to load image",null,{hk:"1k5xX"}),id:(0,w.genId)()}))}))},ne=()=>{c.default.shouldIndicateFocus(),u.default.focus(r.current)},ae=_.DRAWER_HEADER_TYPE.POPUP;let re;re=0===q.length?U?(0,O.jsx)(x.SearchingImages,{}):V?(0,O.jsx)(x.ImageSearchEmpty,{}):(0,O.jsx)(x.BeforeImageSearch,{}):(0,O.jsx)(E.default,{ref:D,canLoadMore:G<Y,isLoadingMore:U,thumbnails:q,onFocusPrev:ne,onImageClick:te,onRequestMoreImages:ee});return(0,O.jsxs)(g.default,{children:[(0,O.jsx)(_.DrawerHeader,{title:h.fbt._("Image Search",null,{hk:"p4JUz"}),type:ae,onBack:e.onBack,onCancel:e.onCancel}),(0,O.jsxs)(v.default,{children:[(0,O.jsx)(b.HotKeys,{onRef:e=>{A.current=e},handlers:{down:e=>{e.repeat||D.current&&r.current&&r.current.cursorIsAtEnd()&&(e.preventDefault(),e.stopPropagation(),c.default.shouldIndicateFocus(),null!=D.current&&u.default.focus(D.current))}},onFocus:()=>{c.default.maybeIndicateFocus(A.current)},children:(0,O.jsx)(k.default,{ref:r,placeholder:h.fbt._("Enter search term here",null,{hk:"sgCKx"}),onSearch:e=>{const t=(e||"").trim();if(!t)return Z(),void J();(0,d.numCodepoints)(t)<S.FTS_MIN_CHARS||t!==V&&(Z(),J(),$(t))},loading:U})}),re]})]})};var i=r(n(57043)),o=r(n(35161)),s=r(n(24350)),l=n(89385),d=n(64331),c=r(n(45120)),u=r(n(52013)),h=n(48360),f=n(67294),p=D(n(99413)),m=n(88102),g=r(n(60453)),v=r(n(69637)),_=n(94790),x=n(85600),C=D(n(64103)),y=r(n(18561)),S=n(80872),j=n(7293),b=n(29424),E=r(n(31469)),k=r(n(48837)),I=r(n(70047)),w=n(50452),T=n(65127),P=r(n(81559)),M=r(n(38080)),L=r(n(56891)),O=n(85893);function A(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(A=function(e){return e?n:t})(e)}function D(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=A(t);if(n&&n.has(e))return n.get(e);var a={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var o=r?Object.getOwnPropertyDescriptor(e,i):null;o&&(o.get||o.set)?Object.defineProperty(a,i,o):a[i]=e[i]}return a.default=e,n&&n.set(e,a),a}},70047:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,s.promiseLoop)(function(){var t=(0,r.default)((function*(t,n,a){const r=(0,o.delayMs)(d.expBackoff(a,6e4,void 0,.1));try{yield function(){if(u.Socket.state===l.SOCKET_STATE.CONNECTED)return Promise.resolve();return(0,c.default)(u.Socket,"change:state",(0,i.default)({state:l.SOCKET_STATE.CONNECTED}))}();const n=yield e();if(n.status>=500&&n.status<600)return r;t(n)}catch(e){return r}}));return function(){return t.apply(this,arguments)}}())};var r=a(n(48926)),i=a(n(6410)),o=n(13959),s=n(4352),l=n(62583),d=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=h(t);if(n&&n.has(e))return n.get(e);var a={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var o=r?Object.getOwnPropertyDescriptor(e,i):null;o&&(o.get||o.set)?Object.defineProperty(a,i,o):a[i]=e[i]}a.default=e,n&&n.set(e,a);return a}(n(22906)),c=a(n(17072)),u=n(65044);function h(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(h=function(e){return e?n:t})(e)}},87027:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{onOk:t}=e,[n,a]=(0,i.useState)(void 0);let f,p;(0,i.useEffect)((()=>{}),[]),n||(f=(0,h.jsx)("div",{className:l.default.spinner,children:(0,h.jsx)(c.Spinner,{size:50,stroke:4})},"spinner"));n&&(p=(0,h.jsx)("div",{className:l.default.textContainer,children:n}));return(0,h.jsx)(s.default,{okText:r.fbt._("OK",null,{hk:"2KEeHb"}),onOK:()=>{null==t||t(),o.Cmd.closeModal()},type:d.ModalTheme.Flex,children:(0,h.jsxs)("div",{className:l.default.container,children:[(0,h.jsx)(u.TextSpan,{theme:"popup-title",children:r.fbt._("Licenses",null,{hk:"39PWhp"})}),p,f]})})};var r=n(48360),i=n(67294),o=n(88102),s=a(n(52665)),l=a(n(23918)),d=n(57224),c=n(11054),u=n(13923),h=n(85893)},39301:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.ID_SEPARATOR=t.Cluster=void 0;var r=a(n(33861)),i=n(53462);t.ID_SEPARATOR=",";t.Cluster=class{constructor(){this.participants=new r.default;for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];t.forEach((e=>this.add(e)))}get id(){return this.participants.map((e=>{let{id:t}=e;return t.toString()})).join(",")}get center(){const e=this.participants.map((e=>{let{lat:t}=e;return t})),t=this.participants.map((e=>{let{lng:t}=e;return t}));return{lat:(Math.min(...e)+Math.max(...e))/2,lng:(Math.min(...t)+Math.max(...t))/2}}get lat(){return this.center.lat}get lng(){return this.center.lng}get length(){return this.participants.length}get northeast(){const e=this.participants.map((e=>{let{lat:t}=e;return t})),t=this.participants.map((e=>{let{lng:t}=e;return t}));return{lat:Math.max(...e),lng:Math.max(...t)}}get southwest(){const e=this.participants.map((e=>{let{lat:t}=e;return t})),t=this.participants.map((e=>{let{lng:t}=e;return t}));return{lat:Math.min(...e),lng:Math.min(...t)}}add(e){this.participants.add(e)}hasSingleParticipant(){return 1===this.length}fits(e,t,n){const{lat:a,lng:r}=this.center,{lat:o,lng:s}=e,l=(0,i.getMetersBetweenLatLngs)(a,r,a,s),d=(0,i.getMetersBetweenLatLngs)(a,r,o,r),c=(0,i.getMetersPerPixel)(a,t);return l/c<=n&&d/c<=n}}},51654:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{onParticipantSelected:t,participants:n}=e,a=(0,p.default)((()=>new d.default));return(0,m.jsxs)("div",{className:r.default.container,children:[(0,m.jsxs)("div",{className:r.default.header,children:[(0,m.jsx)("div",{className:r.default.left,children:(0,m.jsx)("span",{className:r.default.close,onClick:e.onClearSelected,children:(0,m.jsx)(h.default,{name:"x"})})}),(0,m.jsx)("div",{className:r.default.right,children:c.default.t(558,{count:e.participants.length,_plural:e.participants.length})})]}),(0,m.jsx)(l.default,{className:r.default.list,flatListControllers:[a.current],children:(0,m.jsx)(s.FlatList,{data:n.map((e=>({itemKey:e.id.toString(),participant:e}))),flatListController:a.current,direction:"vertical",defaultItemHeight:48,renderItem:e=>{const{participant:n}=e,a=n.isMe?(0,m.jsx)("div",{className:r.default.time,children:(0,m.jsx)(o.default,{reason:"live-location-time",children:(0,m.jsx)(f.default,{participant:n})})}):null;return(0,m.jsxs)("div",{className:r.default.item,onClick:()=>t(n.contact.id.toString()),children:[(0,m.jsx)("div",{className:r.default.left,children:(0,m.jsx)(i.DetailImage,{id:n.contact.id,size:28})}),(0,m.jsxs)("div",{className:r.default.right,children:[(0,m.jsx)("div",{className:r.default.name,children:(0,m.jsx)(u.Name,{contact:n.contact,titlify:!0,ellipsify:!0,you:!0})}),a]})]})}})})]})};var r=a(n(50521)),i=n(88984),o=a(n(51099)),s=n(47915),l=a(n(44942)),d=a(n(30855)),c=a(n(43725)),u=n(12176),h=a(n(23217)),f=a(n(61804)),p=a(n(59552)),m=n(85893)},16641:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.cluster=function(e,t,n,a){const o=new Map;if(!e.length)return o;const s=e.filter((e=>e!==n)).sort(((e,t)=>e.lat-t.lat));for(let e=0;e<s.length;e++){const n=s[e];let l;if(o.forEach((e=>{!l&&e.fits(n,t,a)&&(l=e)})),l){const e=l,t=l.id;o.delete(t),e.add(n)}else l=new i.Cluster(n);o.set((0,r.default)(l,"clusterToAdd").id,(0,r.default)(l,"clusterToAdd"))}if(n&&e.length!==s.length){const e=new i.Cluster(n);o.set(e.id,e)}return o},t.findClusterForParticipant=function(e,t){let n;const a=e.values();for(;(n=a.next())&&!n.done;){const e=n.value;if(e.participants.get(t))return e}return null},t.participantInCluster=function(e,t){return e.split(i.ID_SEPARATOR).includes(t.toString())},t.singleParticipantClusterId=function(e){return!e.includes(i.ID_SEPARATOR)};var r=a(n(45095)),i=n(39301)},9903:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.STALE_THRESHOLD=t.PIN_SIZE=t.MARKER_SIZE=t.IMAGE_SIZE=t.IMAGE_BORDER_SIZE=t.GLOW_SIZE=t.AVATAR_SIZE=void 0,t.getSmallestElapsedTime=n,t.isStale=function(e){return n(e)>=600};t.STALE_THRESHOLD=600;t.IMAGE_SIZE=40;t.IMAGE_BORDER_SIZE=2;t.GLOW_SIZE=4;t.PIN_SIZE=4;t.AVATAR_SIZE=44;function n(e){const t=e.participants.map((e=>e.elapsedTime()));return Math.min(...t)}t.MARKER_SIZE=52},74717:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(48360),i=n(67294),o=n(22683),s=a(n(60453)),l=a(n(69637)),d=n(94790),c=a(n(3222)),u=a(n(94692)),h=a(n(43725)),f=n(84387),p=a(n(49314)),m=n(73098),g=a(n(27766)),v=a(n(57220)),_=a(n(65932)),x=a(n(23217)),C=n(85893);class y extends i.PureComponent{constructor(e){super(e),this.onClose=()=>{this.props.onClose?this.props.onClose():this.props.uim.uie.requestDismiss()},this.onRoadmapSelected=()=>{this.setState({mapType:m.MapType.ROADMAP})},this.onSatelliteSelected=()=>{this.setState({mapType:m.MapType.SATELLITE})},this.onTerrainSelected=()=>{this.setState({mapType:m.MapType.TERRAIN})},this.onTrafficToggled=()=>{this.setState((e=>({showTraffic:!e.showTraffic})))},this.onMarkerSelected=e=>{this.setState({markerSelected:e})},this.state={mapType:m.MapType.ROADMAP,showTraffic:!1,markerSelected:!1,online:v.default.online}}componentDidMount(){this.props.listeners.add(v.default,"change:online",(()=>{this.setState({online:v.default.online})}))}render(){const e=(0,C.jsx)(g.default,{onRoadmapSelected:this.onRoadmapSelected,onSatelliteSelected:this.onSatelliteSelected,onTerrainSelected:this.onTerrainSelected,onTrafficToggled:this.onTrafficToggled,showTraffic:this.state.showTraffic}),{finalLat:t,finalLng:n,finalTimeOffset:a,lat:i,lng:c,senderObj:f,t:m}=this.props.msg,{mapType:v,showTraffic:_,markerSelected:y,online:S}=this.state;let j,b,E,k;return void 0===t||void 0===n||void 0===a?(j=i,b=c,E=m):(j=t,b=n,E=m+a),k=S?(0,C.jsxs)("div",{className:u.default.wrapper,children:[(0,C.jsx)(p.default,{contact:f,lat:j,lng:b,mapType:v,showTraffic:_,markerSelected:y,onMarkerSelected:this.onMarkerSelected}),(0,C.jsxs)("div",{className:u.default.notification,children:[(0,C.jsx)("div",{className:u.default.ended,children:r.fbt._("Live location ended",null,{hk:"1qhVqb"})}),(0,C.jsx)("div",{className:u.default.lastUpdated,children:o.Clock.liveLocationLastUpdatedStr(E)})]})]}):(0,C.jsx)("div",{className:u.default.offline,children:(0,C.jsxs)("div",{children:[(0,C.jsx)("div",{className:u.default.circle,children:(0,C.jsx)(x.default,{name:"live-location-disconnected"})}),(0,C.jsx)("div",{className:u.default.text,children:h.default.t(590)})]})}),(0,C.jsxs)(s.default,{children:[(0,C.jsx)(d.DrawerHeader,{title:r.fbt._("Expired Location",null,{hk:"2bVGaN"}),type:d.DRAWER_HEADER_TYPE.SMALL,menu:e,onCancel:this.onClose}),(0,C.jsx)(l.default,{children:k})]})}}y.CONCERNS={msg:["finalLat","finalLng","finalTimeOffset","lat","lng","senderObj","t"]},y.displayName="ExpiredLocationDrawer";var S=(0,c.default)((0,f.ListenerHOC)((0,_.default)(y,y.CONCERNS)));t.default=S},49314:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(57319),i=n(67294),o=n(33458),s=n(73098),l=a(n(48037)),d=n(85893);class c extends i.Component{constructor(e){super(e),this.setMap=e=>this.map=e,this.mapOnClick=()=>{this.dismissMarkerTimer.debounceAndCap(50,100)},this.markerOnClick=()=>{this.dismissMarkerTimer.isScheduled()&&this.dismissMarkerTimer.cancel(),this.props.onMarkerSelected(!0)},this.getPixelPositionOffset=(e,t)=>({x:-e/2,y:-t}),this.dismissMarkerTimer=new r.ShiftTimer((()=>{this.props.markerSelected&&this.props.onMarkerSelected(!1)}))}componentWillUnmount(){this.dismissMarkerTimer.isScheduled()&&this.dismissMarkerTimer.cancel()}getMapPaneName(){return o.OverlayView.OVERLAY_MOUSE_TARGET}getMarkers(){const{lat:e,lng:t,contact:n,markerSelected:a}=this.props;return(0,d.jsx)(l.default,{marker:{isLive:!1,contact:n,lat:e,lng:t,selected:a,onClick:e=>this.markerOnClick(e)}})}getTrafficLayer(){return this.props.showTraffic?(0,d.jsx)(o.TrafficLayer,{autoRefresh:!0}):null}render(){const{lat:e,lng:t}=this.props;return(0,d.jsxs)(o.GoogleMap,{ref:this.setMap,defaultCenter:{lat:e,lng:t},defaultOptions:this.props.getMapOptions(),defaultZoom:s.INITIAL_ZOOM,mapTypeId:this.props.mapType,onClick:this.mapOnClick,children:[this.getMarkers(),this.getTrafficLayer()]})}}c.displayName="ExpiredLocationMap";var u=(0,s.withConfig)((0,o.withScriptjs)((0,o.withGoogleMap)(c)));t.default=u},11399:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(n(41609)),i=a(n(23493)),o=a(n(89867)),s=n(45454),l=a(n(94184)),d=n(48360),c=n(67294),u=a(n(51654)),h=n(16641),f=n(88102),p=n(9903),m=a(n(60453)),g=a(n(69637)),v=n(94790),_=a(n(3222)),x=a(n(26658)),C=a(n(43725)),y=n(84387),S=a(n(79834)),j=a(n(22163)),b=n(73098),E=a(n(27766)),k=a(n(57220)),I=a(n(32213)),w=a(n(86058)),T=a(n(65932)),P=n(31019),M=a(n(23217)),L=a(n(4478)),O=n(50452),A=n(85893);const D=["click","mousedown","mousemove","scroll"],R="ACTIVE",N="INACTIVE",F="OFFLINE";class B extends c.PureComponent{constructor(e){super(e),this._onParticipantAdd=()=>{const{zoomLevel:e,selectedParticipantId:t}=this.state;this._updateMinZoomClusters(),this.setState({clusters:this._getClusters(e,t)})},this.onParticipantRemove=e=>{const{selectedClusterId:t,selectedParticipantId:n,zoomLevel:a}=this.state;this._updateMinZoomClusters();let r=t,i=n;t&&(0,h.participantInCluster)(t,e.id)&&(r=null),o.default.equals(n,e.id)&&(i=null),this.setState({selectedClusterId:r,selectedParticipantId:i,clusters:this._getClusters(a,i)})},this._onParticipantDisable=e=>{if(!e.isMe){const t=e.contact.formattedName;f.Cmd.openToast((0,A.jsx)(O.Toast,{msg:C.default.t(573,{name:t}),id:(0,O.genId)()}))}},this.onLocationChanged=()=>{const{zoomLevel:e,selectedParticipantId:t}=this.state;this._updateMinZoomClusters(),this.setState({clusters:this._getClusters(e,t)})},this.onIdle=()=>{const{liveLocation:e}=this.props.chat;e&&(e.stopViewingMap(),this.setState({status:N}))},this.onActivity=(0,i.default)((()=>{this._removeIdleTimeout(),this._addIdleTimeout()}),250),this._onRefresh=()=>{const{liveLocation:e}=this.props.chat;e&&(e.startViewingMap(),this.setState({status:R}))},this.onClose=()=>{this.props.onClose?this.props.onClose():this.props.uim.uie.requestDismiss()},this.onMarkerSelected=e=>{e?(0,h.singleParticipantClusterId)(e)?this.onParticipantSelected(e):this._onClusterSelected(e):this.onClearSelected()},this.onClearSelected=()=>{const{selectedParticipantId:e,selectedClusterId:t,zoomLevel:n}=this.state;(e||t)&&this.setState({selectedParticipantId:null,selectedClusterId:null,clusters:this._getClusters(n)})},this._onClusterSelected=e=>{this.state.selectedClusterId!==e&&this.setState({selectedParticipantId:null,selectedClusterId:e})},this.onParticipantSelected=e=>{const{selectedParticipantId:t,zoomLevel:n}=this.state,a=(0,s.createWid)(e);o.default.equals(t,a)||this.setState({selectedParticipantId:a,selectedClusterId:null,clusters:this._getClusters(n,a)})},this.onStopSharing=e=>{e.preventDefault(),e.stopPropagation();const{chat:t}=this.props;f.Cmd.openModal((0,A.jsx)(S.default,{chat:t}))},this.onRoadmapSelected=()=>{this.setState({mapType:b.MapType.ROADMAP})},this.onSatelliteSelected=()=>{this.setState({mapType:b.MapType.SATELLITE})},this.onTerrainSelected=()=>{this.setState({mapType:b.MapType.TERRAIN})},this.onTrafficToggled=()=>{this.setState((e=>({showTraffic:!e.showTraffic})))},this._onBackToCenter=()=>{this.setState({selectedParticipantId:null,selectedClusterId:null,atCenter:!0,clusters:this._getClusters(this.state.zoomLevel)})},this.onMapMoved=(e,t)=>{this.setState((n=>{const a={};if(n.zoomLevel!==e){const t=this._getClusters(e,n.selectedParticipantId);Object.assign(a,{zoomLevel:e,clusters:t})}return this._hasValidParticipants()&&n.atCenter!==t&&Object.assign(a,{atCenter:t}),(0,r.default)(a)?null:a}))},this._updateMinZoomClusters(),this.state={clusters:this._getClusters(b.INITIAL_ZOOM),selectedClusterId:null,selectedParticipantId:null,mapType:b.MapType.ROADMAP,showTraffic:!1,zoomLevel:b.INITIAL_ZOOM,atCenter:!0,status:k.default.online?R:F}}componentDidMount(){this._listenToModelChange(),this._listenToNetworkChange(),this._startCheckingForIdle();const{liveLocation:e}=this.props.chat;e&&(e.startViewingMap(),this._addParticipantListeners(e))}componentWillUnmount(){this.onActivity.cancel();const{liveLocation:e}=this.props.chat;e&&e.stopViewingMap()}_addParticipantListeners(e){this.props.listeners.add(e.participants,"add",this._onParticipantAdd),this.props.listeners.add(e.participants,"remove",this.onParticipantRemove),this.props.listeners.add(e.participants,"change:disabled",this._onParticipantDisable),this.props.listeners.add(e.participants,"change:valid",this.onLocationChanged)}_removeParticipantListeners(e){this.props.listeners.remove(e.participants,"add",this._onParticipantAdd),this.props.listeners.remove(e.participants,"remove",this.onParticipantRemove),this.props.listeners.remove(e.participants,"change:disabled",this._onParticipantDisable),this.props.listeners.remove(e.participants,"change:valid",this.onLocationChanged)}_listenToModelChange(){const{chat:e}=this.props;this.props.listeners.add((0,P.unproxy)(e),"change:liveLocation",(()=>{const{liveLocation:t}=e;t&&(this._removeParticipantListeners(t),this._addParticipantListeners(t));const{zoomLevel:n}=this.state;this.setState({clusters:this._getClusters(n)})}))}_listenToNetworkChange(){this.props.listeners.add(k.default,"change:online",(()=>{k.default.online||this._stopCheckingForIdle(),this.setState({status:k.default.online?R:F})}))}_startCheckingForIdle(){this._addIdleTimeout(),this._addActivityListeners()}_stopCheckingForIdle(){this._removeIdleTimeout(),this._removeActivityListeners()}_addIdleTimeout(){this._idleTimeoutId=this.props.setTimeout(this.onIdle,18e4)}_removeIdleTimeout(){null!=this._idleTimeoutId&&this.props.clearTimeout(this._idleTimeoutId),this._idleTimeoutId=null}_addActivityListeners(){D.forEach((e=>{this.props.listeners.add(document,e,this.onActivity)}))}_removeActivityListeners(){D.forEach((e=>{this.props.listeners.remove(document,e,this.onActivity)}))}_updateMinZoomClusters(){const e=this.getParticipants(),t=e?e.validLocations():[];this._minZoomClusters=(0,h.cluster)(t,b.MIN_ZOOM,null,p.MARKER_SIZE)}getParticipants(){const{liveLocation:e}=this.props.chat;return e?e.participants:null}_hasValidParticipants(){const e=this.getParticipants();return!!e&&!!e.validLocations().length}_getOpenFromCluster(){const e=this.getParticipants();if(!e||0===e.length)return null;const{openFrom:t}=this.props;let n=null;if(t)n=t;else{const t=e.at(0);t&&(n=t.id)}return n?(0,h.findClusterForParticipant)(this._minZoomClusters,n):null}_getClusters(e,t){const n=this.getParticipants();let a=null,r=[];n&&(t&&(a=n.get(t)),r=n.validLocations());let i=r,o=[];if(this._minZoomClusters.size>1){const e=this._getOpenFromCluster();if(e){const t=e.participants;i=t.validLocations(),o=r.filter((e=>{let{id:n}=e;return!t.get(n)}))}}return{primary:(0,h.cluster)(i,e,a,p.MARKER_SIZE),secondary:(0,h.cluster)(o,e,a,p.MARKER_SIZE)}}_getList(){const{clusters:e,selectedClusterId:t}=this.state,n=this.getParticipants();let a;if(null==n?void 0:n.length){if(t){const n=e.primary.get(t)||e.secondary.get(t);if(n){const e=n.participants;a=(0,A.jsx)(u.default,{participants:e,onParticipantSelected:this.onParticipantSelected,onClearSelected:this.onClearSelected})}}a||(a=(0,A.jsx)(I.default,{participants:n,onParticipantSelected:this.onParticipantSelected,onStopSharing:this.onStopSharing}))}return a}render(){let e,t;this.props.isFirstLevel?e=this.onClose:t=this.onClose;const{selectedParticipantId:n,selectedClusterId:a,mapType:r,showTraffic:i,atCenter:o,status:s}=this.state,c=s===R?(0,A.jsx)(E.default,{onRoadmapSelected:this.onRoadmapSelected,onSatelliteSelected:this.onSatelliteSelected,onTerrainSelected:this.onTerrainSelected,onTrafficToggled:this.onTrafficToggled,showTraffic:i}):null;let u,h;if(s===R||s===N){const e=n&&n.toString()||a;u=(0,A.jsxs)("div",{className:x.default.wrapper,children:[(0,A.jsx)("div",{className:(0,l.default)(x.default.backToCenter,{[x.default.visible]:!o}),onClick:this._onBackToCenter,children:(0,A.jsx)(M.default,{name:"return"})}),(0,A.jsx)(j.default,{clusters:this.state.clusters.primary,secondaryClusters:this.state.clusters.secondary,selectedMarkerId:e,openFrom:this.props.openFrom,mapType:r,showTraffic:i,atCenter:o,onMarkerSelected:this.onMarkerSelected,onClearSelected:this.onClearSelected,onLocationChanged:this.onLocationChanged,onMapMoved:this.onMapMoved}),this._getList()]})}if(s===N||s===F){const e=s===N,t=e?"live-location-refresh":"live-location-disconnected",n=e?d.fbt._("Click to continue viewing live location",null,{hk:"4j5wQx"}):C.default.t(590);h=(0,A.jsx)(w.default,{inactive:e,svgName:t,text:n,onClick:e?this._onRefresh:void 0})}return(0,A.jsxs)(m.default,{children:[(0,A.jsx)(v.DrawerHeader,{title:d.fbt._("Live Location",null,{hk:"1LvIwY"}),type:v.DRAWER_HEADER_TYPE.SMALL,menu:c,onBack:t,onCancel:e}),(0,A.jsxs)(g.default,{children:[u,h]})]})}}B.CONCERNS={chat:["id","liveLocation"]},B.displayName="LiveLocationDrawer";var U=(0,_.default)((0,L.default)((0,y.ListenerHOC)((0,T.default)(B,B.CONCERNS))));t.default=U},22163:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(n(23279)),i=n(57319),o=n(67294),s=n(33458),l=n(73098),d=a(n(48037)),c=n(53462),u=n(85893);const h=1e-4;class f extends o.Component{constructor(e){super(e),this.setMap=e=>this.map=e,this.handleLocationChanged=e=>{const{clusters:t,atCenter:n,selectedMarkerId:a}=this.props;if(this.props.onLocationChanged(),!a&&n)this._viewAllClusters();else if(a&&a===e){const e=t.get(a);e&&this._viewSingleCluster(e)}},this.handleIdle=(0,r.default)((()=>{const e=this.map;if(!e)return;const t=e.getZoom();if(this._zoomingToAllClusters){this._defaultZoomLevel=t,this._zoomingToAllClusters=!1;const e=this._zoomHistory;if(e.prev.preZoom===e.curr.postZoom&&e.prev.postZoom===e.curr.preZoom)return}this.props.onMapMoved(t,this.atCenter())}),100),this.handleDragStart=()=>{const e=this.map;if(!e)return;const t=e.getZoom();this.props.onMapMoved(t,!1)},this.handleResize=(0,r.default)((()=>{this._setMapLatLngDiff()}),250),this.mapOnClick=()=>{this.dismissMarkerTimer.debounceAndCap(50,100)},this.markerOnClick=(e,t)=>{this.dismissMarkerTimer.isScheduled()&&this.dismissMarkerTimer.cancel(),this.props.onMarkerSelected(t)},this.dismissMarkerTimer=new i.ShiftTimer((()=>{this.props.selectedMarkerId&&this.props.onClearSelected()})),this._defaultLatDiff=this._defaultLngDiff=.01,this._defaultZoomLevel=-1,this._zoomingToAllClusters=!1,this._zoomHistory={prev:{preZoom:-1,postZoom:-1},curr:{preZoom:-1,postZoom:-1}}}componentWillUnmount(){this.handleIdle.cancel(),this.handleResize.cancel(),window.removeEventListener("resize",this.handleResize),this.dismissMarkerTimer.isScheduled()&&this.dismissMarkerTimer.cancel()}componentDidMount(){window.addEventListener("resize",this.handleResize),this._setMapLatLngDiff(),this._viewAllClusters()}componentDidUpdate(e){const{clusters:t,secondaryClusters:n,selectedMarkerId:a,atCenter:r}=this.props,{selectedMarkerId:i}=e;if(this._setMapLatLngDiff(),t.size&&(!i||a||r))if(a&&i!==a){const e=t.get(a)||n.get(a);e&&this._viewSingleCluster(e)}else!a&&r&&this._viewAllClusters()}_viewAllClusters(){const{clusters:e}=this.props;0===e.size||this.atCenter()||(this._zoomToFitAllClusters(e),this._centerAllClusters(e))}_viewSingleCluster(e){this._zoomToFitSingleCluster(e),this._centerSingleCluster(e)}_zoomToFitAllClusters(e){const t=this.map;if(!t)return;this._zoomingToAllClusters=!0,this._zoomHistory.prev.preZoom=this._zoomHistory.curr.preZoom,this._zoomHistory.curr.preZoom=t.getZoom();const n=this.getBounds(e),a=e.entries().next();if(1!==e.size||a.done)this._boundsTooSmall(n)?t.fitBounds(this._getDefaultBounds(n.getCenter())):t.fitBounds(n);else{const[,e]=a.value;this._zoomToFitSingleCluster(e,!1)}this._zoomHistory.prev.postZoom=this._zoomHistory.curr.postZoom,this._zoomHistory.curr.postZoom=t.getZoom()}_zoomToFitSingleCluster(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n=this.map;if(!n)return;if(t&&this._boundsTooSmall(n.getBounds()))return;const a=e.northeast,r=e.southwest,i=new google.maps.LatLng(a.lat,a.lng),o=new google.maps.LatLng(r.lat,r.lng),s=new google.maps.LatLngBounds(o,i);this._boundsTooSmall(s)?n.fitBounds(this._getDefaultBounds(s.getCenter())):n.fitBounds(s)}_centerAllClusters(e){const t=this.getBounds(e).getCenter();this._centerMap(t)}_centerSingleCluster(e){const t=new google.maps.LatLng(e.center);this._centerMap(t)}_centerMap(e){const t=this.map;t&&(t.getCenter().equals(e)||t.panTo(e))}_getInitialCenter(){return this.getBounds(this.props.clusters).getCenter()}getBounds(e){const t=new google.maps.LatLngBounds;return e.forEach((e=>{t.extend({lat:e.lat,lng:e.lng})})),t}_boundsTooSmall(e){const t=e.getNorthEast(),n=e.getSouthWest(),a=t.lat()-n.lat(),r=t.lng()-n.lng(),i=Math.abs(a)<this._defaultLatDiff,o=Math.abs(r)<this._defaultLngDiff;return i||o}_getDefaultBounds(e){const t=new google.maps.LatLng(e.lat()-this._defaultLatDiff/2,e.lng()-this._defaultLngDiff/2),n=new google.maps.LatLng(e.lat()+this._defaultLatDiff/2,e.lng()+this._defaultLngDiff/2);return new google.maps.LatLngBounds(t,n)}atCenter(){const e=this.map;if(!e)return!0;const t=e.getCenter(),n=this._getInitialCenter(),a=t.lat()-n.lat(),r=t.lng()-n.lng();return Math.abs(a)<h&&Math.abs(r)<h&&this._defaultZoomLevel===e.getZoom()}_setMapLatLngDiff(){const e=this.map;if(!e)return;const t=e.getCenter(),n=e.getDiv(),a=(0,c.getMetersPerPixel)(t.lat(),l.INITIAL_ZOOM),r=n.offsetWidth*a,i=n.offsetHeight*a;this._defaultLatDiff=(0,c.getLatDiff)(i),this._defaultLngDiff=(0,c.getLngDiff)(r,t.lat())}getMarkers(){const{clusters:e,secondaryClusters:t,selectedMarkerId:n}=this.props,a=[],r=(e,t)=>{a.push((0,u.jsx)(d.default,{marker:{isLive:!0,cluster:e,onLocationChanged:()=>this.handleLocationChanged(t),selected:n===t,onClick:e=>this.markerOnClick(e,t)}},t))};return e.forEach(r),t.forEach(r),a}getTrafficLayer(){return this.props.showTraffic?(0,u.jsx)(s.TrafficLayer,{autoRefresh:!0}):null}render(){return(0,u.jsxs)(s.GoogleMap,{ref:this.setMap,defaultCenter:this._getInitialCenter(),defaultOptions:this.props.getMapOptions(),defaultZoom:l.INITIAL_ZOOM,mapTypeId:this.props.mapType,onClick:this.mapOnClick,onDragStart:this.handleDragStart,onIdle:this.handleIdle,children:[this.getMarkers(),this.getTrafficLayer()]})}}f.displayName="LiveLocationMap";var p=(0,l.withConfig)((0,s.withScriptjs)((0,s.withGoogleMap)(f)));t.default=p},73098:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.MapType=t.MIN_ZOOM=t.INITIAL_ZOOM=void 0,t.withConfig=function(e){return class extends o.Component{constructor(){super(...arguments),this.state={authFailed:!0===window.gm_authFailed},this._onAuthFailed=()=>{window.gm_authFailed=!0,this.setState({authFailed:!0});const e=this._getUrl();__LOG__(4,void 0,new Error,!0)`url: ${e}\ntarget: ${"web"}`,SEND_LOGS("google-map-auth-failed")}}componentDidMount(){window.gm_authFailure=this._onAuthFailed}componentWillUnmount(){window.gm_authFailure=void 0}_getUrl(){const e={client:"gme-whatsappinc",v:"3",libraries:"geometry,drawing,places",t:Math.floor(Date.now()/864e5)};return d.URL.build("https://maps.googleapis.com/maps/api/js",e)}getMapOptions(){return{clickableIcons:!1,fullscreenControl:!1,keyboardShortcuts:!1,mapTypeControl:!1,minZoom:3,streetViewControl:!1,zoomControl:!0,zoomControlOptions:{position:google.maps.ControlPosition.TOP_RIGHT}}}render(){if(this.state.authFailed)return(0,c.jsx)("div",{className:s.default.authFailed,children:i.fbt._("Failed to load Google Maps",null,{hk:"2k0Pgj"})});const t=this._getUrl(),n=(0,c.jsx)("div",{className:s.default.loading,children:(0,c.jsx)(l.Spinner,{color:"highlight"})}),a=(0,c.jsx)("div",{className:s.default.container}),o=(0,c.jsx)("div",{className:s.default.map});return(0,c.jsx)(e,(0,r.default)({googleMapURL:t,loadingElement:n,containerElement:a,mapElement:o,getMapOptions:this.getMapOptions},this.props))}}};var r=a(n(81109)),i=n(48360),o=n(67294),s=a(n(89332)),l=n(11054),d=n(2541),c=n(85893);const u=n(76672)({ROADMAP:"roadmap",SATELLITE:"satellite",TERRAIN:"terrain"});t.MapType=u;t.INITIAL_ZOOM=15;t.MIN_ZOOM=3},48037:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(n(94184)),i=n(67294),o=n(33458),s=a(n(57850)),l=n(9903),d=n(84387),c=a(n(92018)),u=a(n(68050)),h=a(n(4478)),f=a(n(2773)),p=n(85893);class m extends i.Component{constructor(e){super(e),this._setOverlay=e=>{this.overlay=e},this.handleLocationChanged=()=>{this.props.marker.isLive&&this.props.marker.onLocationChanged()},this._handleLastUpdatedTimeChanged=()=>{if(!this.props.marker.isLive)return;null!=this.timeoutId&&(this.props.clearTimeout(this.timeoutId),this.timeoutId=null);const e=(0,l.isStale)(this.props.marker.cluster);this.state.stale!==e&&this.setState({stale:e}),e||this._setStaleTimeout()},this._getPixelPositionOffset=(e,t)=>({x:-e/2,y:-t}),this.state={stale:!e.marker.isLive||(0,l.isStale)(e.marker.cluster)}}_setStaleTimeout(){if(!this.props.marker.isLive)return;const{cluster:e}=this.props.marker,t=l.STALE_THRESHOLD-(0,l.getSmallestElapsedTime)(e);t<=0||(this.timeoutId=this.props.setTimeout((()=>this.setState({stale:!0})),1e3*t))}componentDidMount(){if(!this.props.marker.isLive)return;const{cluster:e}=this.props.marker;(0,l.isStale)(e)||this._setStaleTimeout();e.participants.forEach((e=>{this.props.listeners.add(e,"change:lat change:lng",this.handleLocationChanged),this.props.listeners.add(e,"change:lastUpdated",this._handleLastUpdatedTimeChanged)}))}_getMapPaneName(){return this.props.marker.onClick?o.OverlayView.OVERLAY_MOUSE_TARGET:o.OverlayView.OVERLAY_LAYER}render(){let e,t,n,a;const{onClick:i,selected:d}=this.props.marker,{stale:h}=this.state;if(this.props.marker.isLive){const{cluster:a}=this.props.marker;e=a.lat,t=a.lng,n=a.participants.map((e=>{let{id:t}=e;return t}))}else e=this.props.marker.lat,t=this.props.marker.lng,n=[this.props.marker.contact.id];if(d){let n,r,i;if(this.props.marker.isLive){const{cluster:e}=this.props.marker,t=e.participants,a=e.hasSingleParticipant()?t.at(0):null;a&&(n=a.id,r=a.accuracy,i=a.isMe)}else{const{contact:e}=this.props.marker;n=e.id,i=e.isMe}n&&(a=(0,p.jsx)(u.default,{id:n,lat:e,lng:t,accuracy:r,isMe:i||!1,markerSize:l.MARKER_SIZE}))}return(0,p.jsx)(o.OverlayView,{ref:this._setOverlay,position:{lat:e,lng:t},mapPaneName:this._getMapPaneName(),getPixelPositionOffset:this._getPixelPositionOffset,children:(0,p.jsx)(f.default.Provider,{value:this.context,children:(0,p.jsxs)("div",{className:(0,r.default)(c.default.container,{[c.default.selected]:d}),onClick:i,children:[a,(0,p.jsx)("div",{className:(0,r.default)(c.default.glow,{[c.default.stale]:h,[c.default.expired]:!this.props.marker.isLive}),style:{height:l.AVATAR_SIZE,width:l.AVATAR_SIZE,padding:l.GLOW_SIZE},children:(0,p.jsx)("div",{children:(0,p.jsx)(s.default,{ids:n,size:l.IMAGE_SIZE,border:!0,showCount:!0})})}),(0,p.jsx)("div",{className:(0,r.default)(c.default.pin,{[c.default.selected]:d}),style:{height:l.PIN_SIZE,width:l.PIN_SIZE,marginLeft:(l.MARKER_SIZE-l.PIN_SIZE)/2}})]})})})}}m.contextType=f.default,m.displayName="LiveLocationMarker";var g=(0,h.default)((0,d.ListenerHOC)(m));t.default=g},27766:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,c.jsx)(l.MenuBarItem,{a8nText:"live-location-map-menu",icon:(0,c.jsx)(d.default,{name:"menu"}),title:s.default.t(611),children:(0,c.jsxs)(i.Dropdown,{type:"dropdown_menu",flipOnRTL:!0,dirX:i.DirX.LEFT,dirY:i.DirY.BOTTOM,children:[(0,c.jsx)(o.DropdownItem,{a8n:"mi-roadmap-view menu-item",action:e.onRoadmapSelected,children:r.fbt._("Map view",null,{hk:"2d2FOv"})}),(0,c.jsx)(o.DropdownItem,{a8n:"mi-satellite-view menu-item",action:e.onSatelliteSelected,children:r.fbt._("Satellite view",null,{hk:"QnsuG"})}),(0,c.jsx)(o.DropdownItem,{a8n:"mi-terrain-view menu-item",action:e.onTerrainSelected,children:r.fbt._("Terrain view",null,{hk:"3LpQsK"})}),(0,c.jsx)(o.DropdownItem,{a8n:"mi-traffic menu-item",action:e.onTrafficToggled,children:e.showTraffic?r.fbt._("Hide traffic",null,{hk:"1GfpvE"}):r.fbt._("Show traffic",null,{hk:"21KWWk"})})]})})};var r=n(48360),i=n(60811),o=n(71174),s=a(n(43725)),l=n(46346),d=a(n(23217)),c=n(85893)},32213:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{onParticipantSelected:t,onStopSharing:n,participants:a}=e,g=(0,p.default)((()=>new c.default)),v=(0,i.useMemo)((()=>a.map((e=>({itemKey:e.id.toString(),contentKey:e.valid?"valid":"invalid",participant:e})))),[a]);return(0,m.jsx)(d.default,{className:h.default.list,flatListControllers:[g.current],children:(0,m.jsx)(l.FlatList,{data:v,renderItem:e=>{const{participant:a}=e,i=a.valid?(0,m.jsx)(s.default,{reason:"live-location-time",children:(0,m.jsx)(f.default,{participant:a})}):u.default.t(579),l=a.valid?()=>t(a.contact.id.toString()):null,d=a.isMe?(0,m.jsx)("div",{onClick:n,className:h.default.stopSharingButton,children:r.fbt._("Stop Sharing",null,{hk:"14LWdj"})}):null;return(0,m.jsx)(o.Contact,{contact:a.contact,secondary:i,onClick:l,detail:d})},flatListController:g.current,direction:"vertical"})})};var r=n(48360),i=n(67294),o=n(2732),s=a(n(51099)),l=n(47915),d=a(n(44942)),c=a(n(30855)),u=a(n(43725)),h=a(n(6304)),f=a(n(61804)),p=a(n(59552)),m=n(85893)},68050:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(n(94184)),i=n(48360),o=n(67294),s=n(88102),l=n(47620),d=n(19380),c=n(71174),u=n(12591),h=n(50101),f=a(n(43725)),p=n(54586),m=n(12176),g=a(n(22828)),v=a(n(23217)),_=n(18644),x=a(n(24717)),C=n(85893);class y extends o.Component{constructor(e){super(e),this.mouseEnter=()=>{this.state.hover||this.setState({hover:!0})},this.mouseLeave=()=>{this.state.hover&&this.setState({hover:!1})},this._handleDirection=()=>{const{lat:e,lng:t}=this.props;(0,u.openExternalLink)((0,p.getDirectionUrl)(e,t))},this.handleMessage=()=>{const{id:e}=this.props;(0,h.findChat)(e).then((e=>{e.active&&s.Cmd.existsDrawerRight((e=>{e&&2===l.Column.column&&s.Cmd.closeDrawerRight()})),s.Cmd.openChatFromUnread(e).then((t=>{t&&s.Cmd.focusChatTextInput(e)}))}))},this._handleContextOpen=e=>{const t=null==e?void 0:e.target;this.setState({contextMenu:{menu:this._getContextMenu(),anchor:t}})},this.handleContextClose=()=>{this.setState({contextMenu:!1})},this.state={hover:!1,contextMenu:!1}}_getContextMenu(){const e=[];return e.push((0,C.jsx)(c.DropdownItem,{a8n:"get-directions",action:this._handleDirection,children:i.fbt._("Get directions",null,{hk:"MwnzW"})},"direction")),e.push((0,C.jsx)(c.DropdownItem,{a8n:"send-message",action:this.handleMessage,children:i.fbt._("Message",null,{hk:"mZ5DE"})},"message")),e}render(){const{id:e,accuracy:t,isMe:n,markerSize:a}=this.props,i=d.ContactCollection.assertGet(e),o=(0,C.jsx)("div",{className:g.default.name,children:(0,C.jsx)(m.Name,{ellipsify:!0,you:!0,contact:i})}),s=null!=t?(0,C.jsx)("div",{className:g.default.status,children:f.default.t(557,{accuracy:t,_plural:t})}):null,l=n?null:(0,C.jsx)("div",{onClick:this._handleContextOpen,className:g.default.menuButton,children:(0,C.jsx)(v.default,{name:"down"})}),c=(0,C.jsx)("div",{className:g.default.triangle}),u=!n&&this.state.contextMenu?(0,C.jsx)(_.UIE,{displayName:"LiveLocationPopupContextMenu",escapable:!0,popable:!0,requestDismiss:this.handleContextClose,children:(0,C.jsx)(x.default,{contextMenu:this.state.contextMenu})}):null;return(0,C.jsxs)("div",{className:(0,r.default)(g.default.container,{[g.default.twoLines]:!!s}),style:{transform:`translateX(calc(-50% + ${a/2}px))`},children:[(0,C.jsxs)("div",{className:g.default.popup,onMouseOver:this.mouseEnter,onMouseEnter:this.mouseEnter,onMouseDown:this.mouseLeave,onMouseUp:this.mouseEnter,onMouseLeave:this.mouseLeave,children:[o,s,l]}),c,u]})}}t.default=y,y.displayName="LiveLocationPopup"},86058:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,o.jsx)("div",{className:e.inactive?r.default.inactive:r.default.offline,onClick:e.onClick,children:(0,o.jsxs)("div",{children:[(0,o.jsx)("div",{className:r.default.circle,children:(0,o.jsx)(i.default,{name:e.svgName})}),(0,o.jsx)("div",{className:r.default.text,children:e.text})]})})};var r=a(n(26658)),i=a(n(23217)),o=n(85893)},61804:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(48360),i=n(67294),o=a(n(43725)),s=a(n(98007)),l=n(19529),d=n(99935),c=n(85893);const u=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e;t&&(n+=59);const a=3600,r=Math.floor(n/a),i=n%a,o=Math.floor(i/60);return{hours:r,minutes:o}},h=e=>e.isMe?(e=>{const{hours:t,minutes:n}=u(e,!0);return t>0?n>0?o.default.t(565,{hours:t,minutes:n}):o.default.t(564,{hours:t,_plural:t}):o.default.t(566,{minutes:n,_plural:n})})(e.remainingTime()):(e=>{const{hours:t,minutes:n}=u(e);return t>0?n>0?o.default.t(575,{hours:t,minutes:n}):o.default.t(574,{hours:t,_plural:t}):n>0?o.default.t(576,{minutes:n,_plural:n}):r.fbt._("Updated just now",null,{hk:"29EIVi"})})(e.elapsedTime());var f=e=>{let{participant:t}=e;const[n,a]=(0,i.useState)((()=>h(t)));(0,l.useListener)(t,t.isMe?"change:expiration":"change:lastUpdated",(e=>a(h(e))));const[r,o]=(0,s.default)((()=>a(h(t))),6e4),[u]=(0,d.useManualTimeout)((()=>{a(h(t)),r()})),{expiration:f,lastUpdated:p}=t;return(0,i.useEffect)((()=>{const e=(e=>e.isMe?e.remainingTime():e.elapsedTime())(t)%60;o(),u(1e3*e)}),[f,p]),(0,c.jsx)("span",{children:n})};t.default=f},53462:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getLatDiff=function(e){return r(e/n)},t.getLngDiff=function(e,t){const i=n*Math.cos(a(t));return r(e/i)},t.getMetersBetweenLatLngs=function(e,t,r,i){const o=a(r-e),s=a(i-t),l=Math.sin(o/2)*Math.sin(o/2)+Math.cos(a(e))*Math.cos(a(r))*Math.sin(s/2)*Math.sin(s/2),d=2*Math.atan2(Math.sqrt(l),Math.sqrt(1-l));return n*d},t.getMetersPerPixel=function(e,t){return 156543.03392*Math.cos(e*Math.PI/180)*(1/2**t)};const n=6371e3;function a(e){return e*(Math.PI/180)}function r(e){return e*(180/Math.PI)}},31839:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(48360),i=n(67294),o=a(n(72758)),s=a(n(60453)),l=a(n(69637)),d=n(94790),c=n(85893);var u=(0,i.forwardRef)(((e,t)=>(0,c.jsxs)(s.default,{ref:t,children:[(0,c.jsx)(d.DrawerHeader,{a8n:"drawer-title-auto-download",title:r.fbt._("Media Auto-Download",null,{hk:"2iFTSV"}),onBack:e.onClose,type:d.DRAWER_HEADER_TYPE.LARGE}),(0,c.jsx)(l.default,{children:(0,c.jsx)(o.default,{},"auto-download")})]})));t.default=u},7326:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(n(51463)),i=a(n(99964)),o=n(48360),s=n(67294),l=n(88102),d=a(n(60453)),c=a(n(35721)),u=a(n(69637)),h=n(94790),f=a(n(33308)),p=a(n(66797)),m=a(n(56318)),g=n(99234),v=n(28307),_=n(79259),x=a(n(43725)),C=n(10435),y=a(n(25850)),S=n(33646),j=a(n(43556)),b=n(82857),E=a(n(23217)),k=n(13923),I=n(90011),w=a(n(41956)),T=n(85893);function P(e){let t,{ephemeralDuration:n,handleEphemeralDurationClick:a}=e;if(!(0,C.isDisappearingModeEnabled)())return null;t=n>0?(0,C.isEphemeral24HDurationEnabled)()?(0,_.getDisappearingMessageDurationString)(n):x.default.t(447):x.default.t(446);const r=(0,T.jsx)(E.default,{className:y.default.chevronIcon,name:"chevron-right-alt",directional:!0});return(0,T.jsx)(f.default,{children:(0,T.jsxs)(c.default,{onClick:a,side:r,multiline:!0,children:[(0,T.jsx)("div",{className:y.default.header,children:(0,T.jsx)(k.TextHeader,{level:"3",theme:"title",children:o.fbt._("Disappearing messages",null,{hk:"384ocn"})})}),(0,T.jsx)(k.TextParagraph,{theme:"muted",children:t})]})})}var M=(0,s.forwardRef)(((e,t)=>{const{participants:n=[],onSubmit:a}=e,o=(0,s.useRef)(null),c=(0,s.useRef)(null),[_,k]=(0,s.useState)(e.subject||""),[M,L]=(0,s.useState)(e.thumb),[O,A]=(0,s.useState)(e.full),[D,R]=(0,s.useState)((()=>{var e,t;let n;if((0,C.isDisappearingModeEnabled)()){const e=(0,g.getMaybeMeUser)();e&&(n=(0,v.getDisappearingModeSettingForUser)(e))}return null!==(e=null===(t=n)||void 0===t?void 0:t.duration)&&void 0!==e?e:0}));(0,s.useEffect)((()=>{var e;null===(e=o.current)||void 0===e||e.restoreFocus()}),[]);const N=()=>{const e=(0,p.default)(_.trim());a(e,M,O,D,n)},F=_.trim().length>0,B=F?(0,T.jsx)("div",{className:y.default.nextButton,children:(0,T.jsx)(b.Round,{a8nText:"create-group-btn",onClick:(0,r.default)(N),children:(0,T.jsx)(E.default,{name:"checkmark-medium"})})}):null;return(0,s.useImperativeHandle)(t,(()=>({restoreFocus:()=>{var e;return null===(e=o.current)||void 0===e?void 0:e.restoreFocus()},getElement:()=>c.current}))),(0,T.jsxs)(d.default,{children:[(0,T.jsx)(h.DrawerHeader,{title:x.default.t(676),type:h.DRAWER_HEADER_TYPE.LARGE,onBack:e.onBack}),(0,T.jsxs)(u.default,{children:[(0,T.jsxs)(f.default,{children:[(0,T.jsx)("div",{className:y.default.section,children:(0,T.jsx)(S.PhotoPickerLoadable,{type:j.default.GROUP,attachToChat:!1,startImage:O,onImageSet:(e,t)=>{L(e),A(t)}})}),(0,T.jsx)("div",{"data-a8n":i.default.key("group-subject"),className:y.default.section,ref:c,children:(0,T.jsx)(I.TextInput,{ref:o,value:_,maxLength:25,showRemaining:!0,onChange:e=>{k(e)},placeholder:x.default.t(510),onEnter:F?(0,r.default)(N):()=>{},supportsEmoji:!0})})]}),(0,T.jsx)(P,{ephemeralDuration:D,handleEphemeralDurationClick:()=>{l.Cmd.openModal((0,T.jsx)(m.default,{initialDuration:D,onDurationSelected:R}))}}),(0,T.jsx)(w.default,{transitionName:"btn",children:B})]})]})}));t.default=M},15309:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(n(63105)),i=a(n(41609)),o=a(n(91966)),s=a(n(99964)),l=a(n(45120)),d=a(n(52013)),c=a(n(94184)),u=n(48360),h=n(67294),f=n(80140),p=n(88102),m=a(n(52665)),g=n(19380),v=a(n(35487)),_=a(n(60453)),x=a(n(69637)),C=n(94790),y=n(85600),S=a(n(44942)),j=a(n(30855)),b=n(29424),E=a(n(43725)),k=a(n(48566)),I=a(n(48690)),w=a(n(53153)),T=n(82857),P=n(52596),M=n(64551),L=n(11054),O=a(n(23217)),A=n(50452),D=a(n(90012)),R=a(n(41956)),N=n(85893);const F=(0,A.genId)("max_participant_toast");class B extends h.Component{constructor(){super(...arguments),this.state={searchText:"",participants:this.props.participants,shouldFocus:!0,isBusy:!1},this.flatListController=new j.default,this.setRefParticipantList=e=>{this.refParticipantList=e},this.setRefList=e=>{this.refList=e},this.handleKeyDown=e=>{if("Backspace"===e.key&&!this.state.searchText&&!(0,i.default)(this.state.participants)){e.preventDefault();const t=this.state.participants;this.setState({participants:t.slice(0,t.length-1),shouldFocus:!0})}},this.handleInput=e=>{this.setState({searchText:e.target.value})},this.handleReset=()=>{this.setState({searchText:"",shouldFocus:!0})},this.focus=()=>{d.default.focus(this.refInput)},this.handleBack=()=>{this.props.onBack()},this.handleContinue=()=>{this.props.onContinue(this.state.participants)},this.handleDelete=(e,t)=>{const n=(0,r.default)(this.state.participants,(e=>!e.id.equals(t.id)));this.setState({participants:n,shouldFocus:!n.length})},this.handleContactClick=(e,t)=>{this.state.participants.find((e=>e.id.equals(t.id)))?this._removeContact(t):t.isBlocked()?p.Cmd.openModal((0,N.jsx)(m.default,{title:E.default.t(136),onOK:()=>{this._unblockAndAddContact(t),p.Cmd.closeModal()},onCancel:()=>p.Cmd.closeModal(),okText:u.fbt._("Yes",null,{hk:"12b9aE"}),cancelText:u.fbt._("No",null,{hk:"4G38V6"}),children:u.fbt._("The contact you have selected is blocked. Would you like to unblock them and add them to the group?",null,{hk:"3i4hjJ"})})):this.addContact(t)},this.handleFocusList=e=>{this.refList&&(e.preventDefault(),e.stopPropagation(),l.default.shouldIndicateFocus(),this.refList&&this.refList.focusFirst())},this._handleFocusParticipants=e=>{e.repeat||this.refInput&&0!==this.refInput.selectionStart||this.refParticipantList&&(e.preventDefault(),e.stopPropagation(),b.HotKeys.flashFocus=0,this.refParticipantList&&this.refParticipantList.focusLast())},this.handleSelectFirst=e=>{e.preventDefault(),e.stopPropagation();const t=this.getFilteredContacts()[0];t&&this.handleContactClick(e,t)},this.handleFocusSearch=()=>{l.default.shouldIndicateFocus(),d.default.focus(this.refInput)},this.setRefInput=e=>{this.refInput=e},this._setRefSizer=e=>{this._refSizer=e}}componentDidMount(){this.focus()}componentDidUpdate(){this._adjustInput()}getFilteredContacts(){const e=(0,o.default)(g.ContactCollection.getFilteredContacts(),this.state.participants);let t=this.state.searchText;if(!t)return e;t=E.default.accentFold(t);const n=(0,I.default)(t);return e.filter((e=>e.searchMatch(t,n)))}_adjustInput(){if(this.refInput){const e=this.refInput.offsetParent.offsetWidth-10,t=this._refSizer.offsetWidth,n=t>e?e:t;let a;this.refInput.style.width=n+"px",a=e-this.refInput.offsetLeft-n>0?e-this.refInput.offsetLeft:e,this.refInput.style.width=a+"px",this.state.shouldFocus&&this.focus()}}addContact(e){const t=this.state.participants;if(t.length>=M.ServerProps.maxParticipants){const e=E.default.t(49,{max:M.ServerProps.maxParticipants});p.Cmd.openToast((0,N.jsx)(A.Toast,{msg:e,id:F}))}else this.setState({participants:t.concat(e),searchText:"",shouldFocus:!0})}_removeContact(e){const t=this.state.participants;this.setState({participants:(0,r.default)(t,(t=>!e.id.equals(t.id))),shouldFocus:!0})}_unblockAndAddContact(e){this.setState({isBusy:!0}),(0,f.unblockContact)(e).then((()=>{this.props.getUnmountSignal().aborted||(this.addContact(e),this.setState({isBusy:!1}))})).catch((()=>{this.setState({isBusy:!1})}))}render(){var e,t,n;let a;this.state.isBusy?a=(0,N.jsx)("div",{className:k.default.spinner,children:(0,N.jsx)(L.Spinner,{stroke:6,size:24})}):(null===(e=this.state.participants)||void 0===e?void 0:e.length)&&(a=(0,N.jsx)(T.Round,{a8nText:"group-participants-btn",onClick:this.handleContinue,children:(0,N.jsx)(O.default,{name:"arrow-forward",directional:!0})}));const r=(null===(t=this.state.participants)||void 0===t?void 0:t.length)?" ":E.default.t(506),i={down:this.handleFocusList,enter:this.state.searchText?this.handleSelectFirst:(null===(n=this.state.participants)||void 0===n?void 0:n.length)?this.handleContinue:()=>{},up:this._handleFocusParticipants};i[E.default.LR("left","right")]=this._handleFocusParticipants;const o=this.getFilteredContacts();let l;return l=0===o.length?(0,N.jsx)(y.SearchContacts,{}):(0,N.jsx)(v.default,{ref:this.setRefList,flatListController:this.flatListController,contacts:o,onClick:this.handleContactClick,onFocusSearch:this.handleFocusSearch,showPersonGroupDivisionHeader:!1}),(0,N.jsxs)(_.default,{children:[(0,N.jsx)(C.DrawerHeader,{title:u.fbt._("Add group participants",null,{hk:"24QOhm"}),type:C.DRAWER_HEADER_TYPE.LARGE,onBack:this.handleBack}),(0,N.jsxs)(x.default,{children:[(0,N.jsx)("div",{className:k.default.search,children:(0,N.jsx)("div",{children:(0,N.jsxs)(b.HotKeys,{handlers:i,className:k.default.inputLine,children:[(0,N.jsx)("div",{"data-list-scroll-container":!0,children:(0,N.jsx)(w.default,{ref:this.setRefParticipantList,theme:"list-names",contacts:this.state.participants,onDelete:this.handleDelete,onFocusSearch:this.handleFocusSearch})}),(0,N.jsx)("input",{"data-a8n":s.default.key("inputarea"),className:(0,c.default)(k.default.inputarea,P.SELECTABLE_INPUT_CSS_CLASS),ref:this.setRefInput,placeholder:r,onKeyDown:this.handleKeyDown,onChange:this.handleInput,value:this.state.searchText,type:"text"}),(0,N.jsx)("span",{className:k.default.inputareaSizer,ref:this._setRefSizer,children:this.state.searchText})]})})}),(0,N.jsx)(S.default,{className:k.default.contacts,flatListControllers:[this.flatListController],children:l}),(0,N.jsx)(R.default,{transitionName:"btn",className:k.default.drawerSection,children:a})]})]})}}B.defaultProps={participants:[]},B.displayName="NewGroupParticipantsDrawer";var U=(0,D.default)(B);t.default=U},46385:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(67294),i=a(n(38322)),o=a(n(60453)),s=a(n(69637)),l=n(94790),d=a(n(43725)),c=n(72472),u=n(85893);var h=(0,r.forwardRef)(((e,t)=>(0,u.jsxs)(o.default,{ref:t,children:[(0,u.jsx)(l.DrawerHeader,{a8n:"drawer-title-notifications",title:d.default.t(686),onBack:e.onClose,type:l.DRAWER_HEADER_TYPE.LARGE}),(0,u.jsx)(s.default,{children:(0,u.jsx)(i.default,{mute:c.MuteCollection.globalMute(),reactionsMute:c.MuteCollection.globalReactionsMute()},"notifications")})]})));t.default=h},22082:(e,t,n)=>{"use strict";var a=n(59182).default,r=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(n(81109)),o=r(n(48926)),s=r(n(45095)),l=n(68387),d=n(48360),c=n(67294),u=r(n(56720)),h=n(41075),f=n(32826),p=n(16593),m=n(88102),g=n(19380),v=r(n(60453)),_=r(n(69637)),x=n(94790),C=r(n(70835)),y=r(n(33308)),S=n(99234),j=n(71206),b=r(n(43725)),E=n(10435),k=r(n(16866)),I=n(75861),w=n(39434),T=r(n(23217)),P=n(50452),M=n(19529),L=n(49082),O=n(85893);const A={drawerTitle:{paddingTop:"hc2u0oym",paddingEnd:"f9ovudaz",paddingBottom:"myel2vfb",paddingStart:"gx1rr48f"},chevronRightIcon:{color:"g4ti3y4y",height:"qgpfrw6h"},readReceiptsCheckBoxWrapper:{width:"jswlwoyz",display:"p357zi0d",justifyContent:"ac2vgrno"}};function D(e){const t=(0,j.getAllDurations)().find((t=>t.value===e));return void 0===t&&"number"==typeof e?(__LOG__(4,void 0,new Error,!0)`Could not find matching duration label for duration: "${e}"`,SEND_LOGS("No matching duration label"),d.fbt._("On",null,{hk:"1HkDTU"})):void 0===t?d.fbt._("Off",null,{hk:"1ueKlZ"}):t.label}function R(e,t){var n,r,i,j;const[b,w]=(0,c.useState)((()=>F((0,S.getUserPrivacySettings)()))),[T,R]=(0,c.useState)({status:null,groupadd:null,last:null,profile:null}),H=(0,s.default)(g.ContactCollection.get((0,S.getMaybeMeUser)()),"ContactCollection.get(getMaybeMeUser())"),G=(0,L.useModelValues)(H,["disappearingModeDuration"]).disappearingModeDuration;function W(e){const t=F(e.privacySettings);if(null==t)throw new Error(`Incomplete privacy settings: ${Object.keys((0,S.getUserPrivacySettings)()).join(", ")}`);w(t),R((0,I.disallowedRowsToLists)(e.privacyDisallowedRows))}(0,c.useEffect)((()=>{const t=new a;return null==b&&(0,o.default)((function*(){try{const e=yield(0,h.updatePrivacySettings)();if(t.signal.aborted)return;W(e)}catch(t){__LOG__(4,void 0,new Error,!0)`privacy_settings_drawer: get privacy settings failed ${t.stack}`,SEND_LOGS("privacy_settings_drawer: get privacy settings failed"),e.onClose(),m.Cmd.openToast((0,O.jsx)(P.Toast,{id:(0,P.genId)(),msg:d.fbt._("Failed to get privacy settings, please try again.",null,{hk:"2UOq9J"})}))}}))(),()=>t.abort()}),[]),(0,c.useEffect)((()=>{const e=new a;return(0,o.default)((function*(){const t=yield(0,I.queryDisallowedLists)();e.signal.aborted||R(t)}))(),()=>e.abort()}),[]),(0,M.useListener)(m.Cmd,"account_sync_for_privacy",(e=>{W(e)}));const V=d.fbt._("Privacy",null,{hk:"WHXuP"});if(!b)return(0,O.jsx)(k.default,{title:V,error:!1});const z=(0,E.isDefaultDisappearingMessagesEnabled)(),{lastSeen:q,profilePicture:K,about:Y,groupAdd:Q,readReceipts:X}=b;return(0,O.jsxs)(v.default,{ref:t,theme:"striped",testid:"privacy-settings-drawer",children:[(0,O.jsx)(x.DrawerHeader,{a8n:"drawer-title-privacy",title:V,onBack:e.onClose,type:x.DRAWER_HEADER_TYPE.LARGE}),(0,O.jsxs)(_.default,{children:[(0,O.jsxs)(y.default,{title:d.fbt._("Who can see my personal info",null,{hk:"2dUwwx"}),titleXStyle:A.drawerTitle,theme:"padding-no-vertical",animation:!1,ellipsify:!1,children:[(0,O.jsx)(N,{title:d.fbt._("Last seen",null,{hk:"4GuTlB"}),onClick:()=>{e.onOpenVisibilityEditDrawer("lastSeen")},children:(0,O.jsx)("span",{children:B(q,null===(n=T.last)||void 0===n?void 0:n.disallowedList.length)})}),(0,O.jsx)(N,{title:d.fbt._("Profile photo",null,{hk:"rs5RE"}),onClick:()=>{e.onOpenVisibilityEditDrawer("profilePicture")},children:(0,O.jsx)("span",{children:B(K,null===(r=T.profile)||void 0===r?void 0:r.disallowedList.length)})}),(0,O.jsx)(N,{title:d.fbt._("About",null,{hk:"3PhlvU"}),onClick:()=>{e.onOpenVisibilityEditDrawer("about")},children:(0,O.jsx)("span",{children:B(Y,null===(i=T.status)||void 0===i?void 0:i.disallowedList.length)})}),(0,O.jsx)(C.default,{title:d.fbt._("Read receipts",null,{hk:"4p0OAK"}),icon:(0,O.jsx)("div",{className:(0,u.default)(A.readReceiptsCheckBoxWrapper),children:(0,O.jsx)(p.CheckBox,{checked:X===l.ALL_NONE.all,stopPropagation:!0,onChange:()=>{}})}),theme:"privacy",isLastItem:!0,onClick:()=>{!function(){U.apply(this,arguments)}(b,w,X)},children:(0,O.jsx)("span",{children:d.fbt._("If turned off, you won't send or receive Read receipts. Read receipts are always sent for group chats.",null,{hk:"1N51oN"})})})]}),z&&(0,O.jsx)(y.default,{theme:"padding-no-vertical",title:d.fbt._("Disappearing messages",null,{hk:"1u7uAT"}),titleXStyle:A.drawerTitle,animation:!1,children:(0,O.jsx)(N,{title:d.fbt._("Default message timer",null,{hk:"2tVUXb"}),onClick:e.onOpenEphemeralityDrawer,isLastItem:!0,testid:"ddm-settings-item",children:(0,O.jsx)("span",{"data-testid":"ddm-settings-item-value",children:D(G)})})}),(0,O.jsxs)(y.default,{theme:z?"padding":"padding-no-vertical",animation:!1,children:[(0,O.jsx)(N,{title:d.fbt._("Groups",null,{hk:"3ajQWI"}),onClick:()=>{e.onOpenVisibilityEditDrawer("groupAdd")},children:(0,O.jsx)("span",{children:B(Q,null===(j=T.groupadd)||void 0===j?void 0:j.disallowedList.length)})}),(0,O.jsx)(N,{title:d.fbt._("Blocked contacts",null,{hk:"YxQ5T"}),isLastItem:!0,onClick:e.onOpenBlockedContacts,children:(0,O.jsx)("span",{children:0===f.BlocklistCollection.length?d.fbt._("None",null,{hk:"3cviAo"}):f.BlocklistCollection.length})})]})]})]})}function N(e){let{title:t,onClick:n,isLastItem:a,children:r,testid:i}=e;return(0,O.jsx)(C.default,{title:t,theme:"privacy",icon:(0,O.jsx)(T.default,{name:b.default.isRTL()?"chevron-left":"chevron-right",iconXstyle:A.chevronRightIcon}),onClick:n,isLastItem:a,testid:i,children:r})}function F(e){const{about:t,groupAdd:n,lastSeen:a,profilePicture:r,readReceipts:i}=e;if(null!=t&&null!=n&&null!=a&&null!=r&&null!=i)return{about:t,groupAdd:n,lastSeen:a,profilePicture:r,readReceipts:i}}function B(e,t){switch(e){case l.VISIBILITY.all:return d.fbt._("Everyone",null,{hk:"3oWv8q"});case l.VISIBILITY.contacts:return d.fbt._("My contacts",null,{hk:"3jgOvC"});case l.VISIBILITY.contact_blacklist:return null==t?"":b.default.t(707,{count:t,_plural:t});case l.VISIBILITY.none:return d.fbt._("Nobody",null,{hk:"ghOKj"});default:return""}}function U(){return(U=(0,o.default)((function*(e,t,n){const a=n===l.ALL_NONE.all?l.ALL_NONE.none:l.ALL_NONE.all;t((0,i.default)((0,i.default)({},e),{},{readReceipts:a}));try{a===l.ALL_NONE.none?yield(0,w.setPrivacyForOneCategory)({name:"readreceipts",value:"none"}):yield(0,w.setPrivacyForOneCategory)({name:"readreceipts",value:"all"})}catch(e){__LOG__(3,void 0,void 0,!0)`privacy_settings_drawer: set readreceipts failed ${e.stack}`,SEND_LOGS("privacy_settings_drawer: set readreceipts failed"),m.Cmd.openToast((0,O.jsx)(P.Toast,{id:(0,P.genId)(),msg:d.fbt._("Failed to update Read receipts, please try again.",null,{hk:"3xUfMr"})}))}}))).apply(this,arguments)}var H=(0,c.forwardRef)(R);t.default=H},39828:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.PrivacyVisibilityEditDrawer=void 0;var r=a(n(48926)),i=n(68387),o=n(48360),s=n(67294),l=a(n(56720)),d=a(n(9275)),c=n(88102),u=a(n(60453)),h=a(n(69637)),f=n(94790),p=a(n(33308)),m=n(99234),g=n(57701),v=a(n(68706)),_=n(39434),x=n(50452),C=a(n(1784)),y=n(77591),S=n(85893);const j={description:{marginTop:"c46o30wg",marginEnd:"jnwc1y2a",marginBottom:"du8bjn1j",marginStart:"svoq16ka",fontSize:"f8jlpxt4",color:"eruf1vka",lineHeight:"r5qsrrlp"},visibilityOption:{display:"f804f6gw",paddingTop:"a71rq12o",paddingEnd:"f9ovudaz",paddingBottom:"pcbmd69e",paddingStart:"gx1rr48f",textAlign:"ml4r5409"},visibilityOptionText:{fontSize:"enbbiyaj",lineHeight:"r5qsrrlp",display:"l7jjieqr"},visibilityOptionSpace:{display:"l7jjieqr",width:"m0s4cjtr"}};function b(e,t){let{category:n,onClose:a}=e;const[d,C]=(0,s.useState)((()=>{var e,t,a,r;const o=(0,m.getUserPrivacySettings)();switch(n){case"about":return null!==(e=o.about)&&void 0!==e?e:i.VISIBILITY.all;case"profilePicture":return null!==(t=o.profilePicture)&&void 0!==t?t:i.VISIBILITY.all;case"lastSeen":return null!==(a=o.lastSeen)&&void 0!==a?a:i.VISIBILITY.all;case"groupAdd":return null!==(r=o.groupAdd)&&void 0!==r?r:i.VISIBILITY.all}}));function b(){return w.apply(this,arguments)}function w(){return(w=(0,r.default)((function*(e){if(e===d)return;C(e);const t=(0,_.privacyWebNameToServerName)(n);if("readreceipts"===t)throw new Error("visibility_edit_drawer: category can not be readreceipts");try{switch(e){case i.VISIBILITY.none:if("groupadd"===t)throw new Error("visibility_edit_drawer: groupadd can not be none");return void(yield(0,_.setPrivacyForOneCategory)({name:t,value:"none"}));case i.VISIBILITY.contacts:return void(yield(0,_.setPrivacyForOneCategory)({name:t,value:"contacts"}));case i.VISIBILITY.all:yield(0,_.setPrivacyForOneCategory)({name:t,value:"all"})}}catch(e){C(d);e instanceof y.ServerStatusCodeError&&409===e.statusCode||(__LOG__(3,void 0,void 0,!0)`visibility_edit_drawer: set visiblity option failed ${e.stack}`,SEND_LOGS("visibility_edit_drawer: set visiblity option failed")),c.Cmd.openToast((0,S.jsx)(x.Toast,{id:(0,x.genId)(),msg:o.fbt._("Failed to update privacy settings. Please try again.",null,{hk:"h89q3"})}))}}))).apply(this,arguments)}const T=(0,S.jsx)(I,{text:o.fbt._("Everyone",null,{hk:"3oWv8q"}),selected:d===i.VISIBILITY.all,onClick:()=>{b(i.VISIBILITY.all)}}),P=(0,S.jsx)(I,{text:o.fbt._("My contacts",null,{hk:"3jgOvC"}),selected:d===i.VISIBILITY.contacts,onClick:()=>{b(i.VISIBILITY.contacts)}}),M="groupAdd"===n||(0,g.privacyAllowContactsExceptEnabled)()?(0,S.jsx)(I,{text:o.fbt._("My contacts except...",null,{hk:"2tCWPL"}),selected:d===i.VISIBILITY.contact_blacklist,onClick:()=>{c.Cmd.openModal((0,S.jsx)(v.default,{category:n,onConfirm:()=>{C(i.VISIBILITY.contact_blacklist)}}))}}):null,L="groupAdd"===n?null:(0,S.jsx)(I,{text:o.fbt._("Nobody",null,{hk:"ghOKj"}),selected:d===i.VISIBILITY.none,onClick:()=>{b(i.VISIBILITY.none)}}),O="groupAdd"===n?(0,S.jsx)("div",{className:(0,l.default)(j.description),children:o.fbt._("Admins who can't add you to a group will have the option of inviting you privately instead.",null,{hk:"2dA7i1"})}):null;return(0,S.jsxs)(u.default,{ref:t,children:[(0,S.jsx)(f.DrawerHeader,{a8n:`drawer-title-${n}`,title:E(n),onBack:a,type:f.DRAWER_HEADER_TYPE.LARGE}),(0,S.jsx)(h.default,{children:(0,S.jsxs)(p.default,{theme:"padding-no-vertical",animation:!1,children:[(0,S.jsx)("div",{className:(0,l.default)(j.description),children:k(n)}),T,P,M,L,O]})})]})}function E(e){switch(e){case"about":return o.fbt._("About",null,{hk:"3PhlvU"});case"profilePicture":return o.fbt._("Profile photo",null,{hk:"rs5RE"});case"lastSeen":return o.fbt._("Last seen",null,{hk:"4GuTlB"});case"groupAdd":return o.fbt._("Groups",null,{hk:"3ajQWI"})}}function k(e){switch(e){case"about":return o.fbt._("Who can see my About",null,{hk:"2MFyDi"});case"profilePicture":return o.fbt._("Who can see my Profile Photo",null,{hk:"4iDmTO"});case"lastSeen":return o.fbt._("If you don't share your Last Seen, you won't be able to see other people's Last Seen",null,{hk:"24m816"});case"groupAdd":return o.fbt._("Who can add me to groups",null,{hk:"3Q0mva"})}}function I(e){let{text:t,selected:n,onClick:a}=e;return(0,S.jsxs)(C.default,{xstyle:j.visibilityOption,onClick:a,children:[(0,S.jsx)(d.default,{checked:n,radio:!0,hover:!1,systemUncheckedColor:!0,onChange:a}),(0,S.jsx)("span",{className:(0,l.default)(j.visibilityOptionSpace)}),(0,S.jsx)("span",{className:(0,l.default)(j.visibilityOptionText),children:t})]})}const w=(0,s.forwardRef)(b);t.PrivacyVisibilityEditDrawer=w},30579:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(n(81109)),i=a(n(99964)),o=a(n(64369)),s=n(48360),l=n(67294),d=(a(n(56720)),n(94010)),c=a(n(39770)),u=n(99989),h=n(87912),f=n(88102),p=a(n(52665)),m=n(17239),g=a(n(24697)),v=a(n(60453)),_=a(n(69637)),x=n(27394),C=n(94790),y=a(n(33308)),S=a(n(44281)),j=a(n(66797)),b=n(29623),E=a(n(32973)),k=n(99234),I=n(57701),w=n(84287),T=a(n(43725)),P=a(n(35580)),M=n(92557),L=a(n(11339)),O=n(97567),A=a(n(87728)),D=n(9153),R=a(n(35456)),N=a(n(79876)),F=n(48870),B=n(27798),U=n(52596),H=n(55326),G=n(82350),W=a(n(23217)),V=n(13923),z=n(90011),q=n(49082),K=a(n(59147)),Y=a(n(38080)),Q=a(n(39938)),X=n(85893);class Z extends E.default{constructor(){super(...arguments),this.openMerchantDetailsForm=()=>{const e=(0,k.getMeUser)();this.push((0,X.jsx)(M.MerchantDetailsFormFlowLoadable,{contactId:e,onBack:this.pop}))},this.openCatalogDetailsForm=e=>{(0,I.canManageCollections)()&&F.QPL.markerStart(B.QuickLogMarkerId.WHATSAPP_CATALOG_COLLECTIONS_VIEW,{string:{EntryPoint:"Profile"}}),(0,h.createCatalogManagementFlowObject)(((t,n)=>{this.push((0,X.jsx)(h.CatalogManagementFlowLoadable,{catalog:n,catalogId:t,product:e,onBack:this.pop}))}))}}componentDidMount(){this.push((0,X.jsx)($,{openMerchantDetailsForm:this.openMerchantDetailsForm,openCatalogDetailsForm:this.openCatalogDetailsForm,conn:this.props.conn,contact:this.props.contact,profilePicThumb:this.props.profilePicThumb,status:this.props.status,onClose:this.pop}))}}t.default=Z;const J={businessComplianceIconWrapper:{paddingEnd:"htg54gjl",color:"s4k44ver"},businessComplianceText:{flexGrow:"ggj6brxn",color:"tviruh8d"},businessComplianceRightAltIcon:{color:"cs9t9or5"}};function $(e){const{onClose:t,openCatalogDetailsForm:n,openMerchantDetailsForm:a}=e,h=(0,K.default)(),E=(0,l.useContext)(x.DrawerContext),M=(0,Y.default)(),F=(0,q.useModelValues)(e.contact,["businessProfile","id","statusMute"]),B=(0,q.useModelValues)(e.profilePicThumb,["imgFull","id"]),Z=(0,q.useModelValues)(e.status,["status"]),$=(0,q.useModelValues)(e.conn,["pushname"]),ee=(0,l.useRef)(!1),te=(0,l.useRef)(!1),[ne,ae]=(0,l.useState)($.pushname),[re,ie]=(0,l.useState)(Z.status),[oe,se]=(0,l.useState)(!1),[le,de]=(0,l.useState)(!1),[ce,ue]=(0,l.useState)(null),{businessProfile:he}=F,{session:fe}=m.Conn.isSMB?(0,O.getProductCatalogContext)(E):{};if((0,l.useEffect)((()=>{m.Conn.isSMB&&(u.CatalogCollection.findCarouselCatalog((0,k.getMeUser)()).then((e=>{const t=Array.isArray(e)?e[0]:e;ue(t)})).catch((()=>{})),fe.isAccidental()&&f.Cmd.setDrawerContext("left",(0,O.buildProductCatalogContext)(new D.ProductCatalogSession,L.default.BIZ_PLATFORM.SMB,L.default.CATALOG_ENTRY_POINT.CATALOG_ENTRY_POINT_SETTINGS)))}),[]),m.Conn.isSMB&&fe.isAccidental())return null;const pe=e=>!!(e||"").trim(),me=()=>{ee.current=!0},ge=()=>{f.Cmd.openModal((0,X.jsx)(p.default,{onOK:()=>f.Cmd.closeModal(),okText:s.fbt._("OK",null,{hk:"2KEeHb"}),children:T.default.t(125)}))},ve=()=>{ee.current=!1,ie(Z.status)},_e=()=>{if(null==re)return void ve();ee.current=!1;const e=Z.status;(0,j.default)(re)!==e&&(de(!0),(0,G.setMyStatus)((0,j.default)(re)).then((()=>{M.aborted||de(!1)})))},xe=e=>{ie(e)},Ce=()=>{te.current=!0},ye=()=>{let e,t=ne;return t=(t||"").trim(),t?/[\u2714\u2705\u2611]/g.test(t)&&(e=s.fbt._("That emoji isn't allowed in your name",null,{hk:"1JrVVd"})):e=T.default.t(118),!e||(n=e,f.Cmd.openModal((0,X.jsx)(p.default,{onOK:()=>f.Cmd.closeModal(),okText:s.fbt._("OK",null,{hk:"2KEeHb"}),children:n})),!1);var n},Se=()=>{if(te.current=!1,!m.Conn.canSetMyPushname())return;let e=ne;e=(0,j.default)((e||"").trim());e!==$.pushname&&(se(!0),(0,H.setPushname)(e).then((()=>{M.aborted||se(!1)})))},je=e=>{ae(e)},be=()=>{te.current=!1,ae($.pushname)},Ee=()=>{if((0,I.blockCatalogCreationECommerceComplianceIndia)(F.businessProfile))return null;return(0,I.bannedShopsEnabled)()&&(0,d.hasShop)(he)&&(0,d.isShopBanned)(he)?(0,X.jsx)(y.default,{theme:"padding-large",children:(0,X.jsxs)("div",{className:R.default.content,children:[(0,X.jsx)("div",{className:R.default.bannedShopInfoText,children:s.fbt._("This shop has been disabled for not complying with our Business or Commerce policies.",null,{hk:"39dpXJ"})}),(0,X.jsx)(c.default,{type:"primary",onClick:function(){(0,I.bannedShopsEnabled)()&&(0,d.goToCommerceManager)(he)},children:s.fbt._("Commerce Manager",null,{hk:"2ZKedl"})})]})}):(0,X.jsx)(A.default,{businessProfile:F.businessProfile,catalog:ce,openCatalog:n})},ke=()=>{const e=ee.current||le?re:Z.status;return(0,X.jsx)(z.TextInput,{a8n:"col-main-profile-input",value:e,editable:!0,pending:le,showRemaining:!0,validate:pe,maxLength:139,onBeginEdit:me,onChange:xe,onSave:_e,onError:ge,onCancel:ve,theme:"text-input",fieldName:s.fbt._("About",null,{hk:"2FinUX"}),supportsEmoji:!0,lockable:!0,lowProfile:!0,constrainedWidth:!0})},Ie=e=>(0,X.jsx)(w.IconSection,(0,r.default)({},e)),we=()=>{const e=Ie({icon:"info",content:ke()}),t=Ie({icon:"call-phone",iconClass:R.default.phoneIcon,content:(0,X.jsxs)("div",{children:[(0,X.jsx)(U.SelectableDiv,{className:R.default.phoneField,selectable:!0,children:(0,Q.default)((0,k.assertGetMe)())}),(0,X.jsx)("div",{className:R.default.infoText,children:s.fbt._("Your phone number can be edited from the app on your mobile device.",null,{hk:"2FXNXR"})})]})});return(0,X.jsxs)(y.default,{title:s.fbt._("About and Phone Number",null,{hk:"3lw6jL"}),theme:"refresh",children:[e,t]})},Te=(0,I.canSeeBizProfileV3)()&&m.Conn.isSMB?(0,X.jsx)(y.default,{theme:"padding-no-margin",children:(0,X.jsx)(g.default,{contact:F,editable:!0,profilePicThumb:B,hideStatusV3:!0})}):(0,X.jsx)("div",{className:R.default.photoPickerWrapper,children:(0,X.jsx)(N.default,{profilePicThumb:B})}),Pe=m.Conn.isSMB?(0,X.jsxs)("div",{children:[(0,X.jsx)(S.default,{}),(0,I.canSeeECommerceComplianceIndiaSoftEnforcement)(F.id.user)&&(0,X.jsx)(y.default,{title:(0,X.jsxs)(b.FlexRow,{align:"center",children:[(0,X.jsx)(b.FlexItem,{xstyle:J.businessComplianceIconWrapper,children:(0,X.jsx)(W.default,{name:"business"})}),(0,X.jsx)(b.FlexItem,{xstyle:J.businessComplianceText,children:s.fbt._("Business details",null,{hk:"m9xzp"})}),(0,X.jsx)(b.FlexItem,{children:(0,X.jsx)(W.default,{xstyle:J.businessComplianceRightAltIcon,name:"chevron-right-alt",directional:!0})})]}),theme:"refresh-padding-title",titleOnClick:a}),Ee(),(0,I.bizLinkedAccountsEnabled)()&&F.businessProfile?(0,X.jsx)(P.default,{businessProfile:F.businessProfile,sectionTheme:"refresh-padding-title",showEditHint:!0}):null,we()]}):(()=>{const e=te.current||oe?ne:$.pushname,t=m.Conn.isSMB?s.fbt._("This is your business name. It will be visible to your WhatsApp customers.",null,{hk:"AABda"}):T.default.t(712),n=(0,X.jsx)(y.default,{a8nText:"col-main-profile",title:s.fbt._("About",null,{hk:"7nIJP"}),theme:"padding",children:ke()});return(0,X.jsxs)(X.Fragment,{children:[(0,X.jsx)(y.default,{a8nText:"col-main-profile",title:s.fbt._("Your name",null,{hk:"VtujB"}),theme:"padding",children:(0,X.jsx)(z.TextInput,{a8n:"col-main-profile-input",value:e,editable:m.Conn.canSetMyPushname(),pending:oe,showRemaining:!0,validate:ye,maxLength:o.default.MAX_PUSHNAME_LENGTH,onBeginEdit:Ce,onChange:je,onSave:Se,onCancel:be,supportsEmoji:!0,lockable:!0,lowProfile:!0,constrainedWidth:!0})}),(0,X.jsx)("div",{"data-a8n":i.default.key("pushname-description"),className:R.default.nameWrapper,children:(0,X.jsx)(V.TextSpan,{theme:"muted",children:t})}),n]})})(),Me=T.default.t(607);return(0,X.jsxs)(v.default,{children:[(0,X.jsx)(C.DrawerHeader,{a8n:"drawer-title-profile",title:Me,onBack:()=>{t?t():null==h||h.uie.requestDismiss()},type:C.DRAWER_HEADER_TYPE.LARGE}),(0,X.jsxs)(_.default,{children:[Te,Pe]})]})}},25421:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,o.jsx)(r.default,{primary:e.choiceText,onClick:e.onChoose,theme:"radio-button-row",image:(0,o.jsx)(i.default,{checked:e.isChosen,hover:!1,radio:!0,onChange:e.onChoose,systemUncheckedColor:!0})})};var r=a(n(44356)),i=a(n(9275)),o=n(85893)},87613:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(48360),i=n(67294),o=(a(n(56720)),a(n(60453))),s=a(n(69637)),l=n(94790),d=a(n(33308)),c=n(12591),u=n(29623),h=n(63579),f=n(11054),p=n(32217),m=a(n(23217)),g=n(13923),v=n(85893);const _={drawerSection:{paddingTop:"msavwer2",paddingBottom:"slgfab0f"},description:{paddingTop:"msavwer2",paddingEnd:"bcymb0na",paddingBottom:"slgfab0f",paddingStart:"e8k79tju"}};function x(e,t){let{settings:n,onClose:a}=e;return(0,v.jsxs)(o.default,{ref:t,children:[(0,v.jsx)(l.DrawerHeader,{title:r.fbt._("Request Account Info",null,{hk:"2VisVV"}),onBack:a,type:l.DRAWER_HEADER_TYPE.LARGE}),(0,v.jsx)(s.default,{children:(0,v.jsxs)(d.default,{animation:!1,xstyle:_.drawerSection,children:[(0,v.jsx)(u.FlexRow,{align:"center",justify:"center",children:(0,v.jsx)(u.FlexRow,{align:"center",justify:"center",children:(0,v.jsx)(u.FlexItem,{children:(0,v.jsx)(m.default,{name:"document"})})})}),(0,v.jsxs)(g.TextDiv,{xstyle:_.description,children:[r.fbt._("Create a report of your WhatsApp account information and settings, which you can access or port to another app. This report does not include your messages.",null,{hk:"13xpse"})," ",(0,v.jsx)(c.ExternalLink,{href:(0,p.requestAccountInfoUrl)(),children:r.fbt._("Learn More",null,{hk:"bPizH"})})]}),(0,v.jsx)(i.Suspense,{fallback:(0,v.jsx)(u.FlexRow,{align:"center",justify:"center",children:(0,v.jsx)(u.FlexRow,{align:"center",justify:"center",children:(0,v.jsx)(u.FlexItem,{children:(0,v.jsx)(f.Spinner,{size:50,stroke:4})})})}),children:(0,v.jsx)(h.RequestAccountInfoSettingsDrawerBodyContent,{})})]})})]})}var C=(0,i.forwardRef)(x);t.default=C},6137:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.RequestAccountInfoSettingsDrawerAvailable=function(e){let{gdprStatus:{creation:t,documentMessage:n,expiration:a},onDeleteSuccess:g}=e;const v=(0,r.maybeNumberOrThrowIfTooLarge)(n.fileLength),[_,x]=(0,f.useGdprDownload)(),[C,y]=(0,h.useGdprDelete)();return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)("div",{className:(0,s.default)(m.settingsShare),children:(0,p.jsxs)(l.default,{disabled:_,icon:(0,p.jsx)(c.default,{name:"settings-share"}),onClick:()=>x(n),children:[(0,p.jsx)(u.TextDiv,{children:i.fbt._("Export report",null,{hk:"2v7hn5"})}),(0,p.jsx)(u.TextDiv,{theme:"muted",children:null!=v?i.fbt._("{availability_date} · {file_size}",[i.fbt._param("availability_date",o.default.unix(t).format("MMMM D, YYYY")),i.fbt._param("file_size",d.default.filesize(v))],{hk:"24AFfI"}):i.fbt._("{availability_date}",[i.fbt._param("availability_date",o.default.unix(t).format("MMMM D, YYYY"))],{hk:"1flGQw"})})]})}),(0,p.jsx)("div",{className:(0,s.default)(m.delete),children:(0,p.jsx)(l.default,{disabled:C,icon:(0,p.jsx)(c.default,{name:"delete"}),onClick:()=>{y().then((e=>{e.success&&g()}))},children:(0,p.jsx)(u.TextDiv,{children:i.fbt._("Delete and request new report",null,{hk:"4g8Hdm"})})})}),(0,p.jsx)(u.TextDiv,{theme:"muted",xstyle:m.availability,children:i.fbt._("Your report is available to download until {availability_date}",[i.fbt._param("availability_date",o.default.unix(a).format("MMMM D, YYYY"))],{hk:"4prRdU"})})]})};var r=n(8243),i=n(48360),o=a(n(30381)),s=(n(67294),a(n(56720))),l=a(n(64738)),d=a(n(43725)),c=a(n(23217)),u=n(13923),h=n(28602),f=n(60768),p=n(85893);const m={availability:{marginTop:"nylzjxre",marginStart:"r6x3u63k",marginEnd:"lfum0007"},delete:{borderBottom:"n8n2xqzm"},settingsShare:{borderTop:"dl47i6rc",borderBottom:"n8n2xqzm"}}},63579:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RequestAccountInfoSettingsDrawerBodyContent=function(){const[e,t]=(0,o.useGdprStatus)();switch(null==e?void 0:e.type){case"GdprAvailableStatusResponse":return(0,s.jsx)(a.RequestAccountInfoSettingsDrawerAvailable,{gdprStatus:e,onDeleteSuccess:t});case"GdprPendingStatusResponse":return(0,s.jsx)(i.RequestAccountInfoSettingsDrawerPending,{gdprStatus:e});default:return(0,s.jsx)(r.RequestAccountInfoSettingsDrawerInitial,{onRequestSuccess:t})}};var a=n(6137),r=n(14779),i=n(85291),o=n(23218),s=n(85893)},14779:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.RequestAccountInfoSettingsDrawerInitial=function(e){let{onRequestSuccess:t}=e;const[n,a]=(0,l.useGdprRequest)();return(0,d.jsx)(o.default,{className:(0,i.default)(c),color:"accent",disabled:n,icon:(0,d.jsx)(s.default,{name:"settings-document"}),onClick:()=>{a().then((e=>{e.success&&t()}))},children:r.fbt._("Request Report",null,{hk:"2HyjPn"})})};var r=n(48360),i=a(n(56720)),o=a(n(64738)),s=a(n(23217)),l=n(98753),d=n(85893);const c={borderTop:"dl47i6rc",borderBottom:"n8n2xqzm"}},85291:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.RequestAccountInfoSettingsDrawerPending=function(e){let{gdprStatus:{timestamp:t}}=e;const n=s.Clock.daysDelta(s.Clock.globalUnixTime(),t);return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsxs)(l.default,{className:(0,o.default)(h.businessHours),icon:(0,u.jsx)(d.default,{name:"business-hours"}),onClick:()=>{},children:[(0,u.jsx)(c.TextDiv,{children:r.fbt._("Request sent",null,{hk:"3HaEMW"})}),(0,u.jsx)(c.TextDiv,{theme:"muted",children:r.fbt._("Ready by {availability_date}",[r.fbt._param("availability_date",i.default.unix(t).format("MMMM D, YYYY"))],{hk:"3zr2Aw"})})]}),(0,u.jsxs)("div",{className:(0,o.default)(h.footer),children:[(0,u.jsx)(c.TextDiv,{theme:"muted",xstyle:h.availability,children:r.fbt._({"*":"Your report will be ready in about {number} days. You'll have a few weeks to download your report after it's available.",_1:"Your report will be ready in about 1 day. You'll have a few weeks to download your report after it's available."},[r.fbt._plural(n,"number",n)],{hk:"124kzp"})}),(0,u.jsx)(c.TextDiv,{theme:"muted",children:r.fbt._("Your request will be canceled if you make changes to your account such as changing your number or deleting your account.",null,{hk:"2OLjoV"})})]})]})};var r=n(48360),i=a(n(30381)),o=(n(67294),a(n(56720))),s=n(22683),l=a(n(64738)),d=a(n(23217)),c=n(13923),u=n(85893);const h={availability:{marginBottom:"or9x5nie"},businessHours:{borderTop:"dl47i6rc",borderBottom:"n8n2xqzm"},footer:{paddingTop:"msavwer2",paddingStart:"e8k79tju",paddingEnd:"bcymb0na"}}},98863:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const[t,n]=(0,C.default)(p.getGlobalSecurityNotifications,p.setGlobalSecurityNotifications);let a=r.fbt._("Get notified when your security code changes for a contact in an end-to-end encrypted chat. If you have multiple devices, this setting must be enabled on each device where you want to get notifications.",null,{hk:"1ByD6u"});(0,i.getABPropConfigValue)("adv_v2_m6")&&(a=r.fbt._("Get notified when your security code changes for a contact’s phone. If you have multiple devices, this setting must be enabled on each device where you want to get notifications.",null,{hk:"JvjfY"}));return(0,y.jsxs)(s.default,{children:[(0,y.jsx)(d.DrawerHeader,{a8n:"drawer-title-security",title:r.fbt._("Security",null,{hk:"2nir1E"}),onBack:e.onClose,type:d.DRAWER_HEADER_TYPE.LARGE}),(0,y.jsx)(l.default,{children:(0,y.jsxs)(c.default,{theme:"padding-large",animation:!1,children:[(0,y.jsxs)(f.FlexColumn,{xstyle:S.icon,align:"center",justify:"center",children:[(0,y.jsx)(f.FlexItem,{children:(0,y.jsx)(_.default,{name:"security-shield"})}),(0,y.jsx)(f.FlexColumn,{xstyle:S.iconLock,align:"center",justify:"center",children:(0,y.jsx)(f.FlexItem,{children:(0,y.jsx)(_.default,{name:"security-lock"})})})]}),(0,y.jsxs)("div",{className:g.default.text,children:[r.fbt._("Messages and calls in end-to-end encrypted chats stay between you and the people you choose. Not even WhatsApp can read or listen to them.",null,{hk:"1MCVPM"})," ",(0,y.jsx)(u.ExternalLink,{href:(0,v.securityUrl)(),children:m.default.t(554)})]}),(0,y.jsxs)(f.FlexRow,{xstyle:S.controls,children:[(0,y.jsx)("div",{className:g.default.checkbox,children:(0,y.jsx)(o.CheckBox,{onChange:n,checked:t})}),(0,y.jsxs)(f.FlexItem,{children:[(0,y.jsx)("div",{className:g.default.header,children:(0,y.jsx)(x.TextSpan,{theme:"title",children:r.fbt._("Show security notifications on this computer",null,{hk:"3QRZVR"})})}),(0,y.jsxs)(x.TextDiv,{theme:"muted",children:[a," ",(0,y.jsx)(u.ExternalLink,{href:(0,h.getCodeChangeFaqUrl)(),children:m.default.t(554)})]})]})]})]})})]})};var r=n(48360),i=(a(n(56720)),n(86945)),o=n(16593),s=a(n(60453)),l=a(n(69637)),d=n(94790),c=a(n(33308)),u=n(12591),h=n(96384),f=n(29623),p=n(99234),m=a(n(43725)),g=a(n(83968)),v=n(32217),_=a(n(23217)),x=n(13923),C=a(n(152)),y=n(85893);const S={icon:{position:"g0rxnol2",boxSizing:"cm280p3y",width:"cnprk2g9",height:"j74n1y92",paddingTop:"n1yiu2zv",marginTop:"tt8xd2xn",marginEnd:"k1jo73ug",marginBottom:"mpdn4nr2",marginStart:"isfiuinm",color:"t63vcusb",backgroundColor:"je90h8md",borderTopStartRadius:"g9p5wyxn",borderTopEndRadius:"i0tg5vk9",borderBottomEndRadius:"aoogvgrq",borderBottomStartRadius:"o2zu3hjb"},iconLock:{position:"lhggkp7q",start:"tkdu00h0",end:"ebjesfe0",top:"qq0sjtgm",bottom:"lrw9n60e",color:"ml33x45x"},controls:{paddingBottom:"sq87qsu4",marginTop:"ignnouf6"}}},726:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{onOK:t}=e,n=e.name||r.fbt._("Contact",null,{hk:"xBh6i"}),a=l.default.t(764,{name:n});return(0,d.jsx)(o.default,{onOK:()=>{i.Cmd.closeModal(),t()},okText:r.fbt._("OK",null,{hk:"2KEeHb"}),children:(0,d.jsx)("div",{children:(0,d.jsx)(s.EmojiText,{text:a})})})};var r=n(48360),i=n(88102),o=a(n(52665)),s=n(65417),l=a(n(43725)),d=n(85893)},40015:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.SettingsCheckList=function(e){return(0,l.jsx)("div",{className:s.default.container,children:e.children})},t.SettingsCheckListItem=function(e){return(0,l.jsxs)(d,{disabled:e.disabled,children:[(0,l.jsx)("div",{"data-a8n":r.default.key(e.a8nText),className:s.default.control,children:(0,l.jsx)(o.CheckBox,{id:e.id,onChange:e.onChange,checked:e.checked,disabled:e.disabled})}),(0,l.jsx)("label",{className:s.default.label,htmlFor:e.id,children:e.children})]})},t.SettingsCheckListSection=d;var r=a(n(99964)),i=a(n(94184)),o=n(16593),s=a(n(50717)),l=n(85893);function d(e){return(0,l.jsx)("div",{className:(0,i.default)(s.default.section,{[s.default.disabled]:e.disabled}),children:e.children})}},74265:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(48360),i=n(67294),o=(a(n(56720)),a(n(44356))),s=(n(88102),n(17239)),l=n(88984),d=a(n(60453)),c=a(n(69637)),u=a(n(64738)),h=n(94790),f=n(65417),p=n(99234),m=n(7293),g=n(57701),v=a(n(43725)),_=a(n(73561)),x=a(n(23217)),C=n(49082),y=n(85893);const S={icon:{width:"i94gqilv",height:"bmot90v7"}};function j(e,t){const n=(0,C.useModelValues)(e.settings,["archive"]),a=(0,y.jsx)(_.default,{id:e.profileId}),i=(0,y.jsx)(l.DetailImage,{id:(0,p.getMaybeMeUser)(),size:82,quality:l.DETAIL_IMAGE_QUALITY.HIGH}),j=(0,y.jsx)(f.EmojiText,{text:s.Conn.pushname,ellipsify:!0,titlify:!0}),b=(0,g.privacySettingsEnabled)();let E,k,I,w;!m.GK.supportsFeature(m.GK.F.MD_BACKEND)&&(0,g.archiveV2Supported)()&&n.archive.enabled&&(I=(0,y.jsx)(u.default,{icon:(0,y.jsx)(x.default,{name:"archived"}),onClick:e.onArchiveSettings,children:r.fbt._("Archived chats",null,{hk:"3bOfr5"})})),m.GK.supportsFeature(m.GK.F.MD_BACKEND)&&(E=(0,y.jsx)(u.default,{a8nText:"li-security",icon:(0,y.jsx)(x.default,{name:"settings-security"}),onClick:e.onSecurity,children:r.fbt._("Security",null,{hk:"49DQ09"})})),b&&(k=(0,y.jsx)(u.default,{a8nText:"li-privacy",testid:"settings-drawer-item-privacy",icon:(0,y.jsx)(x.default,{name:"security-lock",iconXstyle:S.icon}),onClick:e.onPrivacy,children:r.fbt._("Privacy",null,{hk:"3Cq6XQ"})})),(0,g.webMediaAutoDownloadEnabled)()&&(w=(0,y.jsx)(u.default,{a8nText:"li-media-auto-download",icon:(0,y.jsx)(x.default,{name:"media-download"}),onClick:e.onMediaAutoDownload,children:r.fbt._("Media auto-download",null,{hk:"9NKKi"})}));const T=(0,y.jsx)(u.default,{a8nText:"li-keyboard-shortcuts",icon:(0,y.jsx)(x.default,{name:"settings-keyboard"}),onClick:e.onKeyboardShortcuts,children:r.fbt._("Keyboard shortcuts",null,{hk:"1uFFXP"})});const P=b?null:(0,y.jsx)(u.default,{a8nText:"li-blocked",icon:(0,y.jsx)(x.default,{name:"settings-blocked"}),onClick:e.onBlocked,children:v.default.t(600)});return(0,y.jsxs)(d.default,{ref:t,theme:"settings",testid:"settings-drawer",children:[(0,y.jsx)(h.DrawerHeader,{title:v.default.t(766),onBack:e.onClose,type:h.DRAWER_HEADER_TYPE.LARGE}),(0,y.jsxs)(c.default,{children:[(0,y.jsx)(o.default,{onClick:e.onProfile,image:i,primary:j,theme:"identity",secondary:a}),(0,y.jsx)(u.default,{a8nText:"li-notifications",icon:(0,y.jsx)(x.default,{name:"settings-notifications"}),onClick:e.onNotifications,children:v.default.t(605)}),k,E,(0,g.web2FAEnabled)()&&(0,y.jsx)(u.default,{a8nText:"li-two-factor",icon:(0,y.jsx)(x.default,{name:"settings-pin"}),onClick:e.onTwoFactor,children:r.fbt._("Two-Step Verification",null,{hk:"1ZYq8m"})}),(0,y.jsx)(u.default,{icon:(0,y.jsx)(x.default,{name:"settings-theme"}),onClick:e.onThemeSettings,children:r.fbt._("Theme",null,{hk:"4zgi0L"})}),(0,y.jsx)(u.default,{icon:(0,y.jsx)(x.default,{name:"settings-wallpaper"}),onClick:e.onWallpaper,children:r.fbt._("Chat wallpaper",null,{hk:"2LOVd6"})}),I,P,w,(0,g.webGDPRRequestAccountInfoEnabled)()&&(0,y.jsx)(u.default,{icon:(0,y.jsx)(x.default,{name:"settings-document",iconXstyle:S.icon}),onClick:e.onRequestAccountInfo,children:r.fbt._("Request Account Info",null,{hk:"4fUjWZ"})}),undefined,T,(0,y.jsx)(u.default,{a8nText:"li-help",icon:(0,y.jsx)(x.default,{name:"settings-help"}),onClick:e.onHelp,children:v.default.t(601)}),undefined,undefined,undefined,undefined,undefined,undefined]})]})}var b=(0,i.forwardRef)(j);t.default=b},53033:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(13042),i=a(n(52013)),o=n(41906),s=n(15461),l=n(55715),d=n(48360),c=n(67294),u=n(63183),h=n(88102),f=a(n(58654)),p=a(n(60453)),m=a(n(69637)),g=n(94790),v=n(85600),_=n(7293),x=n(29424),C=a(n(43725)),y=n(46346),S=n(87931),j=n(75705),b=a(n(87481)),E=n(11054),k=a(n(78350)),I=a(n(20606)),w=a(n(35563)),T=a(n(23217)),P=a(n(59909)),M=a(n(59552)),L=n(19529),O=a(n(83800)),A=a(n(88857)),D=a(n(83542)),R=a(n(59147)),N=a(n(38080)),F=a(n(41956)),B=n(85893);function U(e,t){const{starredMsgs:n,chat:a=null,onClose:U}=e,H=(0,N.default)(),G=(0,R.default)(),W=(0,P.default)(),V=(0,D.default)(),z=(0,M.default)((()=>new b.default([],(e=>e.id.toString())))),q=(0,M.default)((()=>new b.default([],(e=>e.id.toString())))),K=(0,M.default)((()=>new Set)),Y=(0,c.useRef)(0),Q=(0,c.useRef)({}),X=(0,c.useRef)(null),Z=(0,c.useRef)(null),J=()=>j.RenderCursor.create({msgCollection:n,type:j.RENDER_CURSOR.STARRED_DRAWER}).loadAfter(n,{count:r.MSG_PRELOAD_THRESHOLD}),[$,ee]=(0,c.useState)(J),te=()=>{const e=n.toArray();z.current.init(e,!0),q.current.init(e)},ne=(0,O.default)((()=>{const e=null==a?void 0:a.id,t=n.models;if($.getEnd(n)<t.length)ee($.loadAfter(n));else{if(n.isSynced)return;n.sync(e).then((()=>{H.aborted||$.hasAfter(n)&&ee($.loadAfter(n))})).catch((e=>{__LOG__(2)`StarredDrawer:loadEarlierMsgs failed\n${e}`}))}})),ae=e=>{if(!X.current)return;(e?e.target:document.activeElement)===X.current&&(z.current.index<0?z.current.setFirst(!0):z.current.reset(!1))},re=e=>{z.current.setVal(e),q.current.setVal(e),h.Cmd.openChatAt(e.chat,e.chat.getSearchContext(e)),h.Cmd.focusShowMsg(e.id)},ie=()=>{let e=n.toArray();const t=n.isSynced?$.getEnd(n):Math.min($.getEnd(n),e.length);return e=e.slice($.getStart(n),t),Y.current=e.length,e},oe=e=>{if(!e)return S.MSG_VISIBILITY.BELOW;const t=Z.current;if(!t)return;const n=t.previousSibling;if(!(n&&n instanceof HTMLElement))return;const a=n.clientHeight,r=t.scrollTop+a,i=r+t.clientHeight,o=e.getContainerElement();return o?o.offsetTop+o.clientHeight<=r?S.MSG_VISIBILITY.ABOVE:o.offsetTop>=i?S.MSG_VISIBILITY.BELOW:S.MSG_VISIBILITY.VISIBLE:S.MSG_VISIBILITY.BELOW},se=e=>{const t=Q.current[e.toString()];if(!t)return;const n=t.getWrapperRef();return n&&"function"==typeof n.getMsgComponentRef?n.getMsgComponentRef():void 0},le=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return K.current.has(e.toString())&&(!!t||se(e))},de=(0,A.default)((()=>{const e=ie(),t=new Set;let a=0,r=Y.current-1;for(;a<r;){const t=Math.floor((a+r)/2),n=Q.current[e[t].id.toString()];oe(n)===S.MSG_VISIBILITY.ABOVE?a=t+1:r=t}for(let n=a;n<e.length;n++){const a=Q.current[e[n].id.toString()];if(oe(a)!==S.MSG_VISIBILITY.VISIBLE)break;t.add(e[n].id.toString())}var i,o;i=K.current,o=t,i.forEach((e=>{if(!o.has(e)){const t=n.get(e);if(null==t?void 0:t.isGif){const t=se(e);(null==t?void 0:t.getPlayCount())&&(null==t||t.pause())}}})),K.current=t}),100),ce=(0,A.default)((e=>{var t;de(),e.currentTarget&&(t=e.currentTarget).scrollTop+o.SCROLL_FUDGE>t.scrollHeight-t.clientHeight&&ne()}),100);(0,c.useEffect)((()=>{te(),X.current&&i.default.focus(X.current),!n.isSynced&&n.length<r.PAGE_SIZE&&V(ne),ae()}),[]),(0,c.useEffect)((()=>{de()})),(0,L.useListener)(window,"resize",de),(0,L.useListener)(n,["reset","sync"],(()=>{te(),W()})),(0,L.useListener)(n,["add","remove"],(()=>{te(),W()})),(0,L.useListener)(n,"reset",(()=>{K.current=new Set,ee(J()),ne()}));const{isSynced:ue,length:he}=n;(0,c.useEffect)((()=>{!ue&&he<r.PAGE_SIZE&&V(ne)}),[ne,V,ue,he]);const fe=ie();let pe,me;if(me=n.isSynced&&$.getEnd(n)>=fe.length?null:e.starredMsgs.syncPromise?(0,B.jsx)("div",{className:k.default.more,title:C.default.t(580),children:(0,B.jsx)(E.Spinner,{stroke:6,size:24})}):(0,B.jsx)("div",{className:k.default.more,children:(0,B.jsx)("div",{title:C.default.t(577),onClick:ne,children:(0,B.jsx)(T.default,{name:"refresh"})})}),fe.length>0){const e=fe.map((e=>{const t=e.type===s.MSG_TYPE.IMAGE||e.type===s.MSG_TYPE.VIDEO||e.type===s.MSG_TYPE.AUDIO;return(0,B.jsx)(w.default,{ref:t=>{((e,t)=>{t?Q.current[e.id.toString()]=t:delete Q.current[e.id.toString()]})(e,t)},msg:e,isMsgVisible:t?le:()=>{},currSelection:z.current,activeSelection:q.current,onClickMsg:re},e.id.toString())}));pe=(0,B.jsx)(F.default,{transitionName:"slide",children:e})}else e.starredMsgs.isSynced?pe=(0,B.jsx)(v.StarredMsgs,{}):(pe=(0,B.jsx)(v.Loading,{}),me=null);const ge=fe.length>0?(0,B.jsx)(y.MenuBarItem,{a8nText:"starred-menu",icon:(0,B.jsx)(T.default,{name:"menu"}),title:C.default.t(611),children:(0,B.jsx)(I.default,{chat:a,msgs:fe})}):null;let ve;return _.GK.supportsFeature(_.GK.F.MD_BACKEND)&&(!a||a&&a.endOfHistoryTransferType===u.ConversationEndOfHistoryTransferModelPropType.COMPLETE_BUT_MORE_MESSAGES_REMAIN_ON_PRIMARY||a.endOfHistoryTransferType===u.ConversationEndOfHistoryTransferModelPropType.NOT_INCLUDED_IN_HIST_SYNC)&&(ve=(0,B.jsx)(f.default,{theme:"md-chat-search-list",children:d.fbt._("Use WhatsApp on your phone to see older starred messages.",null,{hk:"1hya4S"})})),(0,B.jsx)(p.default,{theme:"gallery",ref:t,children:(0,B.jsxs)(x.HotKeys,{className:k.default.hotKeyWraper,handlers:{down:e=>{e&&(e.preventDefault(),e.stopPropagation());const t=z.current.next();z.current.index!==t&&z.current.setNext(!0)},up:e=>{e&&(e.stopPropagation(),e.preventDefault());z.current.prev()>-1&&z.current.setPrev(!0)}},onFocus:ae,"data-tab":l.TAB_ORDER.CHAT_STARRED_DRAWER,onRef:e=>{X.current=e},children:[(0,B.jsx)(g.DrawerHeader,{title:C.default.t(774),onBack:()=>{U?U():null==G||G.uie.requestDismiss()},type:g.DRAWER_HEADER_TYPE.LARGE,menu:ge}),(0,B.jsxs)(m.default,{onScroll:ce,ref:Z,children:[pe,me,ve]})]})})}var H=(0,c.forwardRef)(U);t.default=H},20606:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(48360),i=n(67294),o=n(88102),s=n(60811),l=n(71174),d=a(n(84470)),c=n(85893);function u(e,t){const{msgs:n,chat:a}=e,u=(0,i.useRef)(null);return(0,i.useImperativeHandle)(t,(()=>({getElement:()=>u.current}))),(0,c.jsx)(s.Dropdown,{onRef:e=>{u.current=e},type:"dropdown_menu",flipOnRTL:!0,dirX:s.DirX.LEFT,children:(0,c.jsx)(l.DropdownItem,{a8n:"mi-unstar-all menu-item",action:()=>{o.Cmd.openModal((0,c.jsx)(d.default,{msgs:n,chat:a}))},disabled:0===n.length,children:r.fbt._("Unstar all",null,{hk:"34KaRh"})})},"StarredDrawerHeader")}var h=(0,i.forwardRef)(u);t.default=h},44606:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{onOpenStatus:t}=e,n=(0,j.default)((()=>new m.default)),a=()=>{const e=x.StatusV3Collection.getUnexpired(!0),t=x.StatusV3Collection.getUnexpired(!1);return{unread:e,read:t,muted:[...e,...t].filter((e=>e.contact.statusMute))}},{unread:r,read:i,muted:l}=(0,s.useMemo)(a,[]),[c,g]=(0,s.useState)((()=>r.filter((e=>!e.contact.statusMute)))),[v,y]=(0,s.useState)((()=>i.filter((e=>!e.contact.statusMute)))),[S,L]=(0,s.useState)(l),[O,A]=(0,s.useState)((()=>x.StatusV3Collection.getMyStatus())),[D,R]=(0,s.useState)(!1);(0,b.useListener)(x.StatusV3Collection,"add remove bulk_add sort change:msgsChanged change:hasUnread",(()=>{const{unread:e,read:t,muted:n}=a();g(e.filter((e=>!e.contact.statusMute))),y(t.filter((e=>!e.contact.statusMute))),L(n),A(x.StatusV3Collection.getMyStatus())})),(0,b.useListener)(d.ContactCollection,"change:statusMute",(()=>{const{unread:e,read:t,muted:n}=a();g(e.filter((e=>!e.contact.statusMute))),y(t.filter((e=>!e.contact.statusMute))),L(n),A(x.StatusV3Collection.getMyStatus())}));const N=()=>{R(!D)},F=e=>{switch(e.type){case k:return(0,E.jsxs)("div",{className:C.default.listSectionSep,children:[(0,E.jsx)("hr",{}),(0,E.jsx)("div",{className:C.default.listSectionText,children:(0,E.jsx)("span",{children:o.fbt._("RECENT",null,{hk:"vPbQs"})})})]});case I:return(0,E.jsxs)("div",{className:C.default.listSectionSep,children:[(0,E.jsx)("hr",{}),(0,E.jsx)("div",{className:C.default.listSectionText,children:(0,E.jsx)("span",{children:o.fbt._("VIEWED",null,{hk:"17DrUs"})})})]});case w:return(0,E.jsxs)("div",{className:C.default.listSectionSep,children:[(0,E.jsx)("hr",{}),(0,E.jsxs)("div",{className:C.default.listSectionText,children:[(0,E.jsx)("span",{children:o.fbt._("MUTED",null,{hk:"31XgZG"})}),(0,E.jsx)("button",{className:C.default.listSectionAction,onClick:N,children:e.expanded?o.fbt._("HIDE",null,{hk:"3n6J18"}):o.fbt._("SHOW",null,{hk:"1KKhJ5"})})]})]});case P:return(0,E.jsx)(_.default,{statusV3:e.status,onClick:()=>t(e.status,void 0,e.index),contact:e.status.contact});case T:return(0,E.jsx)(u.E2eMessageStatusList,{});default:throw new f.UnknownDataError(e)}},B=(0,s.useMemo)((()=>{const e=[];return c.length>0&&(e.push({type:k,itemKey:"section-unread",height:48}),e.push(...c.map(((e,t)=>({type:P,itemKey:e.id.toString(),height:64,status:e,index:t}))))),v.length>0&&(e.push({type:I,itemKey:"section-read",height:48}),e.push(...v.map(((e,t)=>({type:P,itemKey:e.id.toString(),height:64,status:e,index:t}))))),S.length>0&&(e.push({type:w,itemKey:"section-muted",height:48,expanded:D}),D&&e.push(...S.map(((e,t)=>({type:P,itemKey:e.id.toString(),height:64,status:e,index:t}))))),e.push({type:T,itemKey:"section-e2e-message"}),e}),[c,v,S,D]);let U;U=x.StatusV3Collection.hasSynced()&&B.length>0?(0,E.jsx)(f.FlatList,{className:"statusList",itemEnterAnimationsEnabled:!0,flatListController:n.current,direction:"vertical",data:B,renderItem:F}):(0,E.jsx)(h.ListStatus,{});return(0,E.jsxs)("div",{className:C.default.listPanel,children:[(0,E.jsx)(M,{statusV3:O,onOpenStatus:e.onOpenStatus}),(0,E.jsx)(p.default,{className:C.default.listBody,flatListControllers:[n.current],children:U})]})};var r=a(n(45095)),i=a(n(99964)),o=n(48360),s=n(67294),l=n(22683),d=n(19380),c=n(88984),u=n(48256),h=n(85600),f=n(47915),p=a(n(44942)),m=a(n(30855)),g=n(99234),v=n(7293),_=a(n(74410)),x=n(59387),C=a(n(26185)),y=a(n(15265)),S=a(n(23217)),j=a(n(59552)),b=n(19529),E=n(85893);const k="SEC_UNREAD",I="SEC_READ",w="SEC_MUTED",T="SEC_E2E_MESSAGE",P="ROW_STATUS";function M(e){var t;let n;const a=e.statusV3;let s,d;a&&(d=a.msgs);const u=()=>{const t=null==a?void 0:a.msgs;a&&(null==t?void 0:t.length)&&e.onOpenStatus(a,t.head(),0)};let h,f,p,m;if(a&&(null===(t=d)||void 0===t?void 0:t.length)){n=(0,E.jsx)(y.default,{statusV3:a,contact:a.contact,onClick:u});const e=(0,r.default)(d.last(),"myMsgs.last()").t;s=(0,E.jsx)("span",{className:C.default.secondaryHeaderText,children:l.Clock.relativeDateAndTimeStr(e)}),f={cursor:"pointer"},h=u}else n=(0,E.jsx)(c.DetailImage,{id:(0,g.getMaybeMeUser)(),theme:"status_v3",size:40}),s=(0,E.jsx)("span",{"data-a8n":i.default.key("status-no-updates"),className:C.default.secondaryHeaderText,children:o.fbt._("No updates",null,{hk:"2Fcs7d"})});v.GK.supportsFeature(v.GK.F.STATUS_V3_UI_SENDING)&&(p=(0,E.jsx)(S.default,{name:"menu"}),m=(0,E.jsx)(S.default,{name:"status-v3-create"}));const _=(0,E.jsx)("span",{"data-a8n":i.default.key("my-status"),className:C.default.primaryHeaderText,children:o.fbt._("My Status",null,{hk:"225G1q"})});return(0,E.jsxs)("div",{className:C.default.panelHeader,style:f,onClick:h,children:[(0,E.jsx)("div",{className:C.default.headerButtonsPrimary,children:n}),(0,E.jsxs)("div",{className:C.default.headerText,children:[_,s]}),(0,E.jsxs)("div",{className:C.default.headerButtonsSecondary,children:[m,p]})]})}},78985:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{onOpenStatus:t,sessionId:n,closeStatusViewer:a}=e,[m,g]=(0,i.useState)((()=>l.StatusV3Collection.getMyStatus()));(0,i.useEffect)((()=>{(0,s.setLastStatusUsage)(),null!=n&&l.StatusV3Collection.logMetrics({type:"session",sessionId:n}),o.Cmd.onStatusViewerOpen()}),[]);const v=(0,r.default)(c.default.v3_x,{});return(0,f.useListener)(l.StatusV3Collection,["add","remove"],(()=>{g(l.StatusV3Collection.getMyStatus())})),(0,f.useListener)(o.Cmd,["dismiss_status_v3_viewer"],(()=>{a(!0)})),(0,p.jsx)("div",{className:c.default.modalBackground,"data-animate-status-v3-modal-background":!0,children:(0,p.jsxs)("div",{className:c.default.mainWrapper,children:[(0,p.jsx)(d.default,{onOpenStatus:t}),(0,p.jsx)(u.default,{status:m,onOpenStatus:t}),(0,p.jsx)("button",{className:v,onClick:()=>e.closeStatusViewer(!0),children:(0,p.jsx)(h.default,{name:"x-viewer"})})]})})};var r=a(n(94184)),i=n(67294),o=n(88102),s=n(99234),l=n(59387),d=a(n(44606)),c=a(n(18442)),u=a(n(78662)),h=a(n(23217)),f=n(19529),p=n(85893)},78662:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const t=(0,C.jsx)(y,{statusV3:e.status,onOpenStatus:e.onOpenStatus});let n,a;c.GK.supportsFeature(c.GK.F.STATUS_V3_UI_SENDING)&&(n=(0,C.jsxs)("div",{className:h.default.updateWrapper,children:[(0,C.jsx)("div",{className:h.default.updateTitle,children:o.fbt._("Update your status",null,{hk:"43mqpz"})}),(0,C.jsxs)("div",{className:h.default.uploadButtons,children:[(0,C.jsxs)("div",{className:h.default.buttonContainer,children:[(0,C.jsx)(m.default,{name:"status-v3-upload",className:h.default.buttonIcon}),o.fbt._("Upload",null,{hk:"2EkSQz"})]}),(0,C.jsxs)("div",{className:h.default.buttonContainer,children:[(0,C.jsx)(m.default,{name:"status-v3-camera",className:h.default.buttonIcon}),o.fbt._("Camera",null,{hk:"1QXPXc"})]})]})]}),a=(0,C.jsx)("hr",{}));return(0,C.jsxs)("div",{className:h.default.outStatusPanel,children:[n,a,t]})};var r=n(50796),i=a(n(99964)),o=n(48360),s=n(67294),l=n(22683),d=n(88984),c=n(7293),u=(n(54311),n(17972)),h=a(n(89683)),f=a(n(21029)),p=a(n(15265)),m=a(n(23217)),g=a(n(59909)),v=n(19529),_=a(n(38080)),x=n(77591),C=n(85893);function y(e){const{statusV3:t}=e,n=(0,g.default)();(0,s.useEffect)((()=>{null==t||t.loadMore(t.totalCount).catch((e=>{__LOG__(3)`error while loading all out status: ${String(e)}`}))}),[]),(0,v.useListener)(t,"change:msgsChanged",n);const a=e.statusV3;if(a&&a.msgs.length>0){const t=a.msgs.map((t=>(0,C.jsx)(S,{msg:t,status:a,onOpenStatus:e.onOpenStatus},t.id.toString())));return(0,C.jsxs)("div",{className:h.default.viewWrapper,children:[(0,C.jsx)("div",{className:h.default.viewTitle,children:o.fbt._("View your updates",null,{hk:"1DTRQt"})}),(0,C.jsx)("div",{className:h.default.viewUpdates,children:t})]})}return(0,C.jsxs)("div",{className:h.default.viewWrapper,children:[(0,C.jsx)("div",{className:h.default.placeholderIcon,children:(0,C.jsx)(m.default,{name:"status-v3-placeholder"})}),(0,C.jsx)("div",{"data-a8n":i.default.key("status-placeholder"),className:h.default.placeholderText,children:o.fbt._("Click on a contact to view their status updates",null,{hk:"d6xUd"})})]})}function S(e){const{msg:t,status:n}=e,a=(0,_.default)(),[i,o]=(0,s.useState)(null),[c,m]=(0,s.useState)(null);(0,s.useEffect)((()=>{u.MsgInfoCollection.find(t.id).then((e=>{a.aborted||(m(e),o(e.read.length))})).catch((0,r.filteredCatch)(x.EphemeralDrop,(()=>{})))}),[]),(0,v.useListener)(null==c?void 0:c.read,["add","remove"],(()=>{o(null==c?void 0:c.read.length)}));const g=(0,C.jsx)(d.DetailImage,{id:t.sender,theme:"status_v3",size:80});return(0,C.jsxs)("div",{className:h.default.outDetail,children:[(0,C.jsx)(p.default,{statusV3:n,msg:t,onClick:()=>e.onOpenStatus(n,t),contact:n.contact,role:"button",theme:"status-panel",thumbnailPlaceholder:g}),(0,C.jsx)("div",{className:h.default.seen,children:(0,C.jsx)(f.default,{seenCount:i})}),(0,C.jsx)("div",{className:h.default.timestamp,children:l.Clock.relativeDateAndTimeStr(t.t)})]})}},39822:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(48360),i=n(67294),o=a(n(56720)),s=a(n(39902)),l=a(n(60453)),d=a(n(69637)),c=n(94790),u=a(n(33308)),h=a(n(30855)),f=n(10595),p=a(n(52146)),m=a(n(59552)),g=n(85893);const v={stickerContainer:{display:"p357zi0d",justifyContent:"ac2vgrno",marginTop:"hv5pdlef",marginBottom:"gdaqao4w",width:"ln8gz9je"},controlsContainer:{display:"p357zi0d",justifyContent:"ac2vgrno",marginBottom:"fhelu9n7"},controlsButton:{marginStart:"nzcjdldu",marginEnd:"gqi0zhd6"}};function _(e,t){const n=(0,m.default)((()=>new h.default)),{sticker:a,stickerPack:i,onSend:_,onBack:x}=e;return(0,g.jsxs)(l.default,{theme:"sticker-store",ref:t,children:[(0,g.jsx)(c.DrawerHeader,{title:r.fbt._("Sticker Details",null,{hk:"44A1rH"}),type:c.DRAWER_HEADER_TYPE.SMALL,onBack:x}),(0,g.jsx)(d.default,{flatListControllers:[n.current],children:(0,g.jsxs)(u.default,{animation:!1,theme:"padding-no-margin",shadow:!1,children:[(0,g.jsx)("div",{className:(0,o.default)(v.stickerContainer),children:(0,g.jsx)(p.default,{sticker:a,theme:"stickerDetails"},a.id)}),(0,g.jsx)(f.StickerDetailsStickerPackInfo,{name:i.name,publisher:i.publisher,theme:f.Theme.StickerStore}),(0,g.jsx)("div",{className:(0,o.default)(v.controlsContainer),children:(0,g.jsx)(s.default,{icon:"send",label:r.fbt._("Send to this chat",null,{hk:"3uG4Tr"}),a8nText:"sticker-action send-button",xstyle:v.controlsButton,theme:"new-chat-info",onClick:()=>{_(a)}})})]})})]},"sticker-details-modal")}var x=(0,i.forwardRef)(_);t.default=x},41966:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(48360),i=n(67294),o=a(n(56720)),s=a(n(60453)),l=a(n(69637)),d=n(94790),c=a(n(33308)),u=n(65417),h=a(n(30855)),f=a(n(43725)),p=n(11054),m=a(n(10093)),g=a(n(52146)),v=n(44333),_=a(n(23217)),x=n(13923),C=a(n(16704)),y=a(n(59552)),S=a(n(83542)),j=n(85893);const b={titleContainer:{display:"p357zi0d",alignItems:"gndfcl4n",marginBottom:"or9x5nie"},title:{flexGrow:"tvf2evcx"},spinner:{display:"p357zi0d",alignItems:"gndfcl4n",justifyContent:"ac2vgrno",minHeight:"h2zl7k75"},animatedIcon:{marginStart:"oz0g9ue8",color:"kw851w1p"},contentContainer:{marginBottom:"dblt22a0",color:"hp667wtd",fontSize:"f8jlpxt4",lineHeight:"jgi8eev7"},stickersContainer:{display:"btb1m7bk",gridTemplateColumns:"dr6m1ylk",gridTemplateRows:"kenirpp9",gridColumnGap:"zqptfkjs",gridRowGap:"lhjw8glk",justifyContent:"o4u7okr9",width:"ln8gz9je",height:"ppled2lx"},emptyContainer:{display:"p357zi0d",justifyContent:"ac2vgrno",marginTop:"hv5pdlef",marginBottom:"gdaqao4w",width:"ln8gz9je"},emptySticker:{width:"sr23wnuw",height:"rjxfi64q",marginBottom:"dblt22a0",backgroundRepeat:"sxl192xd",backgroundSize:"hbhfgwk1"},emptyText:{textAlign:"qfejxiq4",marginBottom:"fhelu9n7"}};function E(e,t){const n=(0,y.default)((()=>new h.default)),{stickerPack:a,stickerPackId:E,onStickerClick:k,onStickerEnter:I,onBack:w,onClose:T}=e,P=function(e,t){return(0,C.default)(v.StickerPackCollectionMd,"add remove reset",(()=>e||(t?v.StickerPackCollectionMd.get(t):null)))||(null==t?null:void v.StickerPackCollectionMd.fetchStickerPack(t))}(a,E),M=function(e){return(0,C.default)(null==e?void 0:e.stickers,"add remove reset",(()=>null==e?void 0:e.stickers.toArray()))}(P),L=function(e){return(0,C.default)(v.StickerPackCollectionMd,"change:packFetchState",(()=>e?v.StickerPackCollectionMd.packFetchState.get(e):null))}(E),O=(0,S.default)();(0,i.useEffect)((()=>{O((()=>{null==P||P.stickers.fetch()}))}),[null==P?void 0:P.stickers,O]);const A=(e,t)=>{P&&k(e,P,t)},D=(e,t)=>{P&&I(e,P,t)};let R;return(E&&L===v.FETCH_STATE.PENDING||0===(null==M?void 0:M.length))&&(R=(0,j.jsx)(x.TextDiv,{theme:"plain",xstyle:b.spinner,children:(0,j.jsx)(p.Spinner,{size:50,stroke:4})})),(0,j.jsxs)(s.default,{theme:"sticker-store",ref:t,children:[(0,j.jsx)(d.DrawerHeader,{title:r.fbt._("Sticker Details",null,{hk:"44A1rH"}),type:d.DRAWER_HEADER_TYPE.SMALL,onBack:w,onCancel:T}),(0,j.jsx)(l.default,{flatListControllers:[n.current],children:(0,j.jsxs)(c.default,{animation:!1,theme:"padding-no-margin",shadow:!1,children:[P?(0,j.jsxs)(j.Fragment,{children:[(0,j.jsxs)(x.TextDiv,{theme:"title",xstyle:b.titleContainer,children:[(0,j.jsx)(u.EmojiText,{xstyle:b.title,text:P.name,ellipsify:!0,titlify:!0}),P.animated?(0,j.jsx)(_.default,{name:"round-play",className:(0,o.default)(b.animatedIcon),width:16,height:16}):null]}),P.publisher&&(0,j.jsx)(x.TextDiv,{theme:"plain",xstyle:b.contentContainer,children:(0,j.jsx)(u.EmojiText,{text:f.default.t(775,{name:P.publisher})})}),P.description&&(0,j.jsx)(x.TextDiv,{theme:"plain",xstyle:b.contentContainer,children:(0,j.jsx)(u.EmojiText,{text:P.description})}),R,(0,j.jsx)("div",{className:(0,o.default)(b.stickersContainer),children:null==M?void 0:M.map((e=>(0,j.jsx)(g.default,{sticker:e,theme:"stickerStore",onClick:A,onEnter:D,dontShowViewPack:!0},e.id)))})]}):null,!P&&E&&L===v.FETCH_STATE.PENDING?R:null,P||E&&L===v.FETCH_STATE.PENDING?null:(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)("div",{className:(0,o.default)(b.emptyContainer),children:(0,j.jsx)("div",{className:(0,o.default)(b.emptySticker),style:{backgroundImage:`url(${m.default})`}})}),(0,j.jsx)(x.TextDiv,{theme:"plain",xstyle:[b.contentContainer,b.emptyText],children:(0,j.jsx)(u.EmojiText,{text:r.fbt._("Unable to find sticker pack",null,{hk:"3aIIxP"})})})]})]})})]},"sticker-pack-details-modal")}var k=(0,i.forwardRef)(E);t.default=k},37968:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(48360),i=n(67294),o=(a(n(56720)),a(n(60453))),s=a(n(69637)),l=n(94790),d=a(n(33308)),c=a(n(30855)),u=n(11054),h=n(44333),f=a(n(63822)),p=n(13923),m=a(n(16704)),g=a(n(59552)),v=n(85893);const _={spinner:{display:"p357zi0d",alignItems:"gndfcl4n",justifyContent:"ac2vgrno",minHeight:"h2zl7k75"}};function x(e,t){const n=(0,m.default)(h.StickerPackCollectionMd,"add remove reset",(()=>h.StickerPackCollectionMd.filter((e=>null!=e.index)))),a=(0,g.default)((()=>new c.default));let i;return 0===n.length&&(i=(0,v.jsx)(p.TextDiv,{theme:"plain",xstyle:_.spinner,children:(0,v.jsx)(u.Spinner,{size:50,stroke:4})})),(0,v.jsxs)(o.default,{theme:"sticker-store",ref:t,children:[(0,v.jsx)(l.DrawerHeader,{title:r.fbt._("WhatsApp Sticker Store",null,{hk:"nicpq"}),type:l.DRAWER_HEADER_TYPE.SMALL,onCancel:e.onClose}),(0,v.jsx)(s.default,{flatListControllers:[a.current],onScroll:t=>{var n;null===(n=e.onScrollOffsetChange)||void 0===n||n.call(e,t.currentTarget.scrollTop)},scrollOffset:e.scrollOffset,children:(0,v.jsxs)(d.default,{animation:!1,theme:"no-padding",shadow:!1,children:[i,(0,v.jsx)(f.default,{stickerPacks:n,onStickerPackDetails:e.onStickerPackDetails})]})})]},"sticker-store-modal")}var C=(0,i.forwardRef)(x);t.default=C},7693:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){const e=(0,i.useContext)(c.ThemeContext),[t,n]=(0,i.useState)(e.systemThemeMode?"system":e.theme),a=e=>{const t=e.target.value;"light"!==t&&"dark"!==t&&"system"!==t||n(t)};return(0,u.jsxs)(s.default,{title:r.fbt._("Choose theme",null,{hk:"3cnXtb"}),onOK:()=>{"system"===t?(e.setSystemThemeMode(!0),e.setTheme(d.default.getCurrentTheme())):(e.setSystemThemeMode(!1),e.setTheme(t)),o.Cmd.closeModal()},onCancel:()=>{o.Cmd.closeModal()},children:[(0,u.jsx)("form",{children:(0,u.jsxs)("ol",{children:[(0,u.jsx)("li",{children:(0,u.jsxs)("label",{className:l.default.label,children:[(0,u.jsx)("input",{type:"radio",name:"theme",value:"light",className:l.default.input,checked:"light"===t,onChange:a}),r.fbt._("Light",null,{hk:"2EcNH1"})]})},"light"),(0,u.jsx)("li",{children:(0,u.jsxs)("label",{className:l.default.label,children:[(0,u.jsx)("input",{type:"radio",name:"theme",value:"dark",className:l.default.input,checked:"dark"===t,onChange:a}),r.fbt._("Dark",null,{hk:"2GGBbH"})]})},"dark"),(0,u.jsx)("li",{children:(0,u.jsxs)("label",{className:l.default.label,children:[(0,u.jsx)("input",{type:"radio",name:"theme",value:"system",className:l.default.input,checked:"system"===t,onChange:a}),r.fbt._("System default",null,{hk:"2lMytc"})]})},"system")]})}),null]})};var r=n(48360),i=n(67294),o=n(88102),s=a(n(52665)),l=a(n(37388)),d=a(n(3137)),c=n(97628),u=n(85893)},45026:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(48360),i=n(67294),o=(a(n(56720)),a(n(60453))),s=a(n(69637)),l=a(n(64738)),d=n(94790),c=a(n(33308)),u=n(29623),h=a(n(43725)),f=n(11054),p=a(n(23217)),m=n(13923),g=n(1673),v=n(85893);const _={drawerSection:{paddingTop:"msavwer2"},description:{paddingTop:"msavwer2",paddingEnd:"bcymb0na",paddingBottom:"slgfab0f",paddingStart:"e8k79tju"}};function x(e,t){const[n,a]=(0,i.useState)(null);if((0,i.useEffect)((()=>{(0,g.getTwoFactor)().then((e=>a(e)))}),[]),null==n)return(0,v.jsx)(o.default,{ref:t,children:(0,v.jsx)(y,{onClose:e.onClose,children:(0,v.jsx)(u.FlexRow,{align:"center",justify:"center",children:(0,v.jsx)(u.FlexRow,{align:"center",justify:"center",children:(0,v.jsx)(u.FlexItem,{children:(0,v.jsx)(f.Spinner,{size:50,stroke:4})})})})})});let s,l,d;return!0===n?(s=r.fbt._("Two-step verification is enabled. You'll need to enter your PIN when registering your phone number with WhatsApp again.",null,{hk:"2YGRKd"}),l=(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(C,{onClick:()=>{e.onClose},icon:(0,v.jsx)(p.default,{name:"round-x-inv",height:24}),children:r.fbt._("Disable",null,{hk:"EYWqM"})}),(0,v.jsx)(C,{onClick:e.onOpenUpdatePinDrawer,icon:(0,v.jsx)(p.default,{name:"settings-pin"}),children:r.fbt._("Change PIN",null,{hk:"2GykKY"})}),(0,v.jsx)(C,{onClick:e.onOpenUpdateEmailDrawer,icon:(0,v.jsx)(p.default,{name:"business-email"}),children:r.fbt._("Change email address",null,{hk:"2h6SZW"})})]}),d=h.default.isRTL()?"settings_2fa_done_rtl":"settings_2fa_done"):(s=r.fbt._("For added security, enable two-step verification, which will require a PIN when registering your phone number with WhatsApp again.",null,{hk:"Rxhoe"}),l=(0,v.jsx)(C,{onClick:e.onOpenRegistrationDrawer,children:r.fbt._("Enable",null,{hk:"2RMR6d"})}),d="settings_2fa"),(0,v.jsx)(o.default,{ref:t,children:(0,v.jsxs)(y,{onClose:e.onClose,children:[(0,v.jsx)(u.FlexRow,{align:"center",justify:"center",children:(0,v.jsx)(u.FlexItem,{children:(0,v.jsx)(p.default,{name:d})})}),(0,v.jsx)(m.TextDiv,{xstyle:_.description,children:s}),l]})})}function C(e){let{children:t,onClick:n,isLastItem:a,icon:r}=e;return(0,v.jsx)(l.default,{icon:r,onClick:n,children:t})}function y(e){let{children:t,onClose:n}=e;return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(d.DrawerHeader,{title:r.fbt._("Two-Step Verification",null,{hk:"40ydX7"}),onBack:n,type:d.DRAWER_HEADER_TYPE.LARGE}),(0,v.jsx)(s.default,{children:(0,v.jsx)(c.default,{animation:!1,ellipsify:!1,xstyle:_.drawerSection,children:t})})]})}var S=(0,i.forwardRef)(x);t.default=S},39031:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){let{email:t,onEmailChange:n,emailConfirmation:a,onEmailConfirmationChange:c}=e;const[u,h]=(0,i.useState)(!1),[f,p]=(0,i.useState)(!1);return(0,i.useEffect)((()=>{t===a&&p(!1)}),[t,a]),(0,i.useEffect)((()=>{(0,l.validateEmail)(t)&&h(!1)}),[t]),(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(o.default,{title:r.fbt._("Add an email address to your account which will be used to reset your PIN if you forget it and safeguard your account.",null,{hk:"3yrC6H"}),children:(0,d.jsx)(s.TextInput,{onChange:n,value:t,placeholder:r.fbt._("Email",null,{hk:"38jUce"}),onBlur:()=>{(0,l.validateEmail)(t)||h(!0)},error:u?r.fbt._("Incorrect email address format",null,{hk:"1l4toK"}):null})}),(0,d.jsx)(o.default,{title:r.fbt._("Confirm your email address",null,{hk:"4imYJ5"}),children:(0,d.jsx)(s.TextInput,{onChange:c,value:a,placeholder:r.fbt._("Email",null,{hk:"38jUce"}),onBlur:()=>{t!==a&&p(!0)},error:f?r.fbt._("Email addresses don't match. Try again.",null,{hk:"llUUu"}):null})})]})};var r=n(48360),i=n(67294),o=a(n(70835)),s=n(90011),l=n(85832),d=n(85893)},33143:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.PIN_LENGTH=void 0,t.TwoFactorPinItem=function(e){const t=6===e.pinConfirmation.length&&e.pin!==e.pinConfirmation,n=function(e){return!Number.isFinite(parseInt(e.key,10))&&!l.includes(e.key)};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i.default,{title:r.fbt._("Enter a six-digit PIN which you'll be asked for when you register your phone number with WhatsApp",null,{hk:"1gMkDs"}),children:(0,s.jsx)(o.TextInput,{onChange:e.setPin,value:e.pin,placeholder:r.fbt._("******",null,{hk:"2lenlV"}),hideFloatingLabel:!0,maxLength:6,managed:!0,managedError:!0,onKeyDown:n})}),(0,s.jsx)(i.default,{title:r.fbt._("Confirm your PIN",null,{hk:"1uwcc6"}),children:(0,s.jsx)(o.TextInput,{onChange:e.setPinConfirmation,value:e.pinConfirmation,placeholder:r.fbt._("******",null,{hk:"2lenlV"}),hideFloatingLabel:!0,maxLength:6,managed:!0,managedError:!0,error:t?r.fbt._("PINs don't match. Try again.",null,{hk:"2luQHZ"}):null,onKeyDown:n})})]})};var r=n(48360),i=a(n(70835)),o=n(90011),s=n(85893);t.PIN_LENGTH=6;const l=["Backspace","Tab"]},37789:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const[t,n]=(0,i.useState)(""),[a,v]=(0,i.useState)(""),[_,x]=(0,i.useState)(""),[C,y]=(0,i.useState)("");return(0,m.jsxs)(l.default,{children:[(0,m.jsx)(c.DrawerHeader,{a8n:"drawer-title-2fa",title:r.fbt._("Two-Step Verification",null,{hk:"1Yoy3O"}),onBack:e.onClose,type:c.DRAWER_HEADER_TYPE.LARGE}),(0,m.jsx)(d.default,{children:(0,m.jsxs)("form",{children:[(0,m.jsxs)(u.default,{theme:"padding",children:[(0,m.jsx)(f.TwoFactorPinItem,{pin:t,setPin:n,pinConfirmation:a,setPinConfirmation:v}),(0,m.jsx)(h.default,{email:_,onEmailChange:x,emailConfirmation:C,onEmailConfirmationChange:y})]}),(0,m.jsx)(p.default,{transitionName:"btn",className:(0,o.default)(g),children:(0,m.jsx)(s.default,{onClick:()=>{},type:"primary",children:r.fbt._("Register",null,{hk:"8hdUv"})})})]})})]})};var r=n(48360),i=n(67294),o=a(n(56720)),s=a(n(39770)),l=a(n(60453)),d=a(n(69637)),c=n(94790),u=a(n(33308)),h=a(n(39031)),f=n(33143),p=a(n(41956)),m=n(85893);const g={zIndex:"b9fczbqn",display:"p357zi0d",justifyContent:"j1p1mz06",paddingBottom:"hjz8m82x",marginTop:"ignnouf6",textAlign:"qfejxiq4"}},79697:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const[t,n]=(0,i.useState)(""),[a,g]=(0,i.useState)("");return(0,p.jsxs)(l.default,{children:[(0,p.jsx)(c.DrawerHeader,{title:r.fbt._("Two-Step Verification",null,{hk:"294kJZ"}),onBack:e.onClose,type:c.DRAWER_HEADER_TYPE.LARGE}),(0,p.jsx)(d.default,{children:(0,p.jsxs)("form",{children:[(0,p.jsx)(u.default,{theme:"padding",children:(0,p.jsx)(h.default,{email:t,onEmailChange:n,emailConfirmation:a,onEmailConfirmationChange:g})}),(0,p.jsx)(f.default,{transitionName:"btn",className:(0,o.default)(m),children:(0,p.jsx)(s.default,{onClick:()=>{},type:"primary",children:r.fbt._("Update Email",null,{hk:"hBmCV"})})})]})})]})};var r=n(48360),i=n(67294),o=a(n(56720)),s=a(n(39770)),l=a(n(60453)),d=a(n(69637)),c=n(94790),u=a(n(33308)),h=a(n(39031)),f=a(n(41956)),p=n(85893);const m={display:"p357zi0d",justifyContent:"j1p1mz06",paddingBottom:"hjz8m82x",marginTop:"ignnouf6",textAlign:"qfejxiq4"}},58030:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const[t,n]=(0,i.useState)(""),[a,g]=(0,i.useState)(""),v=t.length===h.PIN_LENGTH&&t===a;return(0,p.jsxs)(l.default,{children:[(0,p.jsx)(c.DrawerHeader,{title:r.fbt._("Two-Step Verification",null,{hk:"40ydX7"}),onBack:e.onClose,type:c.DRAWER_HEADER_TYPE.LARGE}),(0,p.jsx)(d.default,{children:(0,p.jsxs)("form",{children:[(0,p.jsx)(u.default,{theme:"padding",children:(0,p.jsx)(h.TwoFactorPinItem,{pin:t,setPin:n,pinConfirmation:a,setPinConfirmation:g})}),(0,p.jsx)(f.default,{transitionName:"btn",className:(0,o.default)(m),children:(0,p.jsx)(s.default,{onClick:()=>{},disabled:!v,type:"primary",children:r.fbt._("Save",null,{hk:"n9x6Q"})})})]})})]})};var r=n(48360),i=n(67294),o=a(n(56720)),s=a(n(39770)),l=a(n(60453)),d=a(n(69637)),c=n(94790),u=a(n(33308)),h=n(33143),f=a(n(41956)),p=n(85893);const m={display:"p357zi0d",justifyContent:"j1p1mz06",paddingBottom:"hjz8m82x",marginTop:"ignnouf6",textAlign:"qfejxiq4"}},84470:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{chat:t,msgs:n}=e;return(0,d.jsx)(o.default,{onOK:()=>{t&&t.pendingAction++,r.ChatCollection.unstarAllMessages(n,t).finally((()=>{t&&t.pendingAction--})),i.Cmd.closeModal()},okText:l.default.t(794),onCancel:c,children:(0,d.jsx)("div",{children:(0,d.jsx)(s.EmojiText,{text:l.default.t(795)})})})};var r=n(69951),i=n(88102),o=a(n(52665)),s=n(65417),l=a(n(43725)),d=n(85893);const c=()=>{i.Cmd.closeModal()}},93110:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{contactList:t,onSend:n,onBack:a,chat:m}=e;let x;switch(m.kind){case r.CHAT_KIND.CHAT:x=c.default.t(351,{chat:m.title(),count:c.default.n(t.length),_plural:t.length});break;case r.CHAT_KIND.GROUP:x=c.default.t(352,{chat:m.title(),count:c.default.n(t.length),_plural:t.length});break;case r.CHAT_KIND.BROADCAST:x=c.default.t(350,{chat:m.title(),count:c.default.n(t.length),_plural:t.length})}const C=x?(0,v.jsx)(l.EmojiText,{text:x,direction:"auto",titlify:!0,ellipsify:!0}):null;return(0,v.jsx)(u.Modal,{type:u.ModalTheme.Box,children:(0,v.jsxs)(i.default,{children:[(0,v.jsx)(s.DrawerHeader,{type:s.DRAWER_HEADER_TYPE.POPUP,onBack:a,children:C}),(0,v.jsx)(o.default,{children:(0,v.jsx)(d.HotKeys,{children:(0,v.jsx)("div",{className:p.default.body,children:t.map(((e,t)=>(0,v.jsx)(_,{contact:(0,g.vcardFromContactModel)(e)},t.toString())))})})}),(0,v.jsx)("div",{className:p.default.btnContainer,children:(0,v.jsx)("div",{className:p.default.btnPosition,children:(0,v.jsx)(h.Round,{large:!0,onClick:n,children:(0,v.jsx)(f.default,{name:"send",directional:!0})})})})]})})};var r=n(63183),i=a(n(60453)),o=a(n(69637)),s=n(94790),l=n(65417),d=n(29424),c=a(n(43725)),u=n(57224),h=n(82857),f=a(n(23217)),p=a(n(55771)),m=a(n(11976)),g=n(78521),v=n(85893);function _(e){let{contact:t}=e;const n=(0,g.parseVcard)(t.vcard);return n?(0,v.jsx)("div",{className:p.default.vcardWrapper,children:(0,v.jsx)(m.default,{parsedVcard:n,thumbnail:(0,g.vcardThumbnail)(n)})}):null}},45925:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{onClose:t}=e,n=(0,W.default)(),a=(0,V.default)(),i=(0,H.useModelValues)(e.contact,["verificationBinary","verificationString","formattedUser","formattedShortName","id"]),o=(0,c.useRef)(null),h=(0,c.useRef)(null),m=(0,c.useRef)(null),[g,b]=(0,c.useState)(!0),[k,O]=(0,c.useState)(!1),[A,R]=(0,c.useState)(!1),[N,B]=(0,c.useState)(!1),[U,K]=(0,c.useState)(!1),[Q,X]=(0,c.useState)(null),[Z,J]=(0,c.useState)(null),[$,ee]=(0,c.useState)(!1),[te,ae]=(0,c.useState)(null),[ge,ve]=(0,c.useState)(null),[_e,xe]=(0,c.useState)(null),Ce=()=>{(0,z.getIdentityVerificationDataJob)(i.id).then((e=>{a.aborted||(e?(me(te,e.binary)&&!e.string!==ge||(null!=te&&p.Cmd.openModal((0,Y.jsx)(C.E2EChangeModal,{contact:i})),ae(e.binary),ve(e.string)),je()):(be(),p.Cmd.openModal((0,Y.jsx)(D.default,{name:i.formattedUser,onOK:()=>{t?t():null==n||n.uie.requestDismiss()}}))))}))},[ye]=(0,G.useTimeout)((()=>{K(!1)}),5e3),Se=e=>{b(!0),O(!1),R(!1),K(!0),X(e),ye()},[je,be]=(0,G.useTimeout)(Ce,1e3),[Ee]=(0,G.useTimeout)((()=>{O(!1)}),3e3),[ke]=(0,G.useTimeout)((()=>{R(!1)}),3e3),[Ie]=(0,G.useTimeout)((()=>{N&&!U&&Se(l.fbt._("Please try increasing the brightness or reducing light reflection.",null,{hk:"2uEW7v"}))}),7e3);const we=()=>{B(!1),K(!1),J(null),o.current=null},Te=e=>{const t=(e=>{let t;const n=i.formattedShortName;switch(e){case ue:t=M.default.t(1018,{contact:n});break;case he:case fe:t=M.default.t(1017,{contact:n});break;case pe:default:t=l.fbt._("The image does not contain a valid identity verification QR code.",null,{hk:"4q3XzO"})}return t})(e);Se(t)},Pe=(e,t)=>{(e=>new Promise(((t,n)=>{d.default.callback=(e,a)=>{if(a)n(a);else if(e.length<1)n(new Error("QR decoder did not return decoded binary"));else{const n=new Uint8Array(e[0]);t(n)}},d.default.decode(e)})))(e).then((e=>(0,s.decodeProtobuf)(E.CombinedFingerprintSpec,e))).then((e=>{const n=(e=>{var t,n,a,r,o,l,d,c,u,h,f,p;if(!e||0===!e.version||!e.localFingerprint||!e.remoteFingerprint)return pe;let m=new ArrayBuffer(0);m=w.GK.supportsFeature(w.GK.F.MD_BACKEND)?te:i.verificationBinary;const g=(0,s.decodeProtobuf)(E.CombinedFingerprintSpec,m);if(me(null===(t=e.localFingerprint)||void 0===t?void 0:t.identifier,null===(n=g.localFingerprint)||void 0===n?void 0:n.identifier)&&me(null===(a=e.remoteFingerprint)||void 0===a?void 0:a.identifier,null===(r=g.remoteFingerprint)||void 0===r?void 0:r.identifier))return de;const v=me(null===(o=e.remoteFingerprint)||void 0===o?void 0:o.identifier,null===(l=g.localFingerprint)||void 0===l?void 0:l.identifier),_=me(null===(d=e.localFingerprint)||void 0===d?void 0:d.identifier,null===(c=g.remoteFingerprint)||void 0===c?void 0:c.identifier);if(!v&&!_)return fe;if(!v)return ue;if(!_)return he;const x=me(null===(u=e.remoteFingerprint)||void 0===u?void 0:u.publicKey,null===(h=g.localFingerprint)||void 0===h?void 0:h.publicKey),C=me(null===(f=e.localFingerprint)||void 0===f?void 0:f.publicKey,null===(p=g.remoteFingerprint)||void 0===p?void 0:p.publicKey);return x&&C?de:ce})(e);n?t&&_e===pe||(xe(n),_e===ce?(we(),b(!1),O(!1),R(!0),K(!1),ke()):Te(n)):(we(),b(!1),O(!0),R(!1),K(!1),Ee())})).catch((()=>{t||(xe(pe),Te(pe))})).finally((()=>{window.URL.revokeObjectURL(e)}))},Me=e=>{e.stopPropagation();const t=e.target.files||e.dataTransfer.files;if(!t||!t[0])return;const n=t[0],a=URL.createObjectURL(n);Pe(a,!1);const r=h.current;r&&r.reset()},Le=()=>{const{asyncStream:e,disposeStream:t}=L.start("camera");o.current=t,e.then((e=>(e=>{b(!0),O(!1),R(!1),B(!0),J(e),Ie()})(e))).catch((0,r.filteredCatch)(y.GUM.NotAllowedError,(()=>{p.Cmd.openModal((0,Y.jsx)(T.GuidePopup,{messaging:T.Messaging.CAMERA_FAIL,type:T.TYPE.GUIDE_UNBLOCK}))}))).catch((0,r.filteredCatch)(y.GUM.GUMError,(()=>{p.Cmd.openModal((0,Y.jsx)(T.GuidePopup,{messaging:T.Messaging.CAMERA_MISSING,type:T.TYPE.GUIDE_NONE}))})))},Oe=e=>{Pe(e,!0)},Ae=()=>{const e=m.current;null==e||e.click()};(0,c.useEffect)((()=>{w.GK.supportsFeature(w.GK.F.MD_BACKEND)||(0,P.queryIdentity)(i)}),[i]),(0,c.useEffect)((()=>(w.GK.supportsFeature(w.GK.F.MD_BACKEND)?Ce():(0,P.queryIdentity)(i),()=>{var e;null===(e=o.current)||void 0===e||e.call(o)})),[]);let De=null,Re=null,Ne=null,Fe=null,Be=null,Ue=null,He=new ArrayBuffer(0),Ge="";w.GK.supportsFeature(w.GK.F.MD_BACKEND)?(He=te,Ge=ge,Ue=(0,u.getABPropConfigValue)("adv_v2_m6")?M.default.t(943,{contactName:i.formattedShortName}):M.default.t(942,{contactName:i.formattedShortName})):(He=i.verificationBinary,Ge=i.verificationString,Ue=l.fbt._("Scan the code on your contact's phone, or ask them to scan your code, to verify your messages and calls to them are end-to-end encrypted. You can also compare the number above to verify. This is optional.",null,{hk:"1Vypk2"}));He&&(I.default&&(De=(0,Y.jsx)("div",{className:q.default.section,children:(0,Y.jsx)(f.default,{type:"primary",onClick:N?we:Le,children:N?l.fbt._("Turn Off Camera",null,{hk:"3OyAHl"}):l.fbt._("Scan Code",null,{hk:"170pLA"})})})),Re=(0,Y.jsxs)("div",{className:q.default.section,children:[(0,Y.jsx)(f.default,{type:"primary",onClick:Ae,children:l.fbt._("Upload Code",null,{hk:"2aJIAo"})}),(0,Y.jsx)("p",{className:q.default.dragAndDropExplanation,children:$?l.fbt._("Release to verify…",null,{hk:"2K08kb"}):null})]}),Ne=(0,Y.jsx)("form",{ref:h,children:(0,Y.jsx)("input",{ref:m,accept:"image/*",type:"file",style:{display:"none"},onChange:Me,onClick:e=>e.stopPropagation()})}));N&&Z&&(Fe=(0,Y.jsx)(le,{stream:Z,disposeStream:o.current,onCapture:Oe,onClose:we}));U&&(Be=(0,Y.jsx)(se,{children:Q}));return(0,Y.jsxs)(v.default,{onDrop:e=>{i.verificationBinary&&i.verificationString&&Me(e)},onDragChange:e=>{ee(e)},children:[(0,Y.jsxs)(x.DrawerHeader,{type:x.DRAWER_HEADER_TYPE.SMALL,rtlFixIfOnDarwin:!0,onBack:()=>{t?t():null==n||n.uie.requestDismiss()},children:[(0,Y.jsx)(F.TextDiv,{theme:"title",children:l.fbt._("Verify Security Code",null,{hk:"1vTVgt"})}),(0,Y.jsxs)(F.TextDiv,{theme:"small",children:[M.default.t(1020),", ",i.formattedUser]})]}),Fe,Be,(0,Y.jsx)(_.default,{children:(0,Y.jsxs)("div",{className:q.default.form,children:[(0,Y.jsxs)("div",{className:q.default.photo,children:[(0,Y.jsx)(ne,{binary:He,contact:i,visible:g}),(0,Y.jsx)(ie,{visible:k}),(0,Y.jsx)(oe,{visible:A})]}),(0,Y.jsx)("div",{className:q.default.section,children:(0,Y.jsx)("div",{className:q.default.code,children:(0,Y.jsx)(re,{string:Ge})})}),(0,Y.jsx)("div",{className:q.default.section,children:(0,Y.jsxs)("p",{className:q.default.explanation,children:[(0,Y.jsxs)("span",{children:[Ue," "]}),(0,Y.jsx)(S.ExternalLink,{href:(0,j.getE2EFaqUrl)(),children:M.default.t(554)})]})}),De,Re,Ne]})})]})};var r=n(50796),i=n(41906),o=a(n(94184)),s=n(84902),l=n(48360),d=a(n(31339)),c=n(67294),u=n(86945),h=n(50514),f=a(n(39770)),p=n(88102),m=n(19380),g=a(n(16194)),v=a(n(60453)),_=a(n(69637)),x=n(94790),C=n(21976),y=X(n(64103)),S=n(12591),j=n(96384),b=n(77811),E=n(80498),k=n(99234),I=a(n(72451)),w=n(7293),T=n(18671),P=n(84765),M=a(n(43725)),L=X(n(61849)),O=a(n(37360)),A=n(52596),D=a(n(726)),R=n(11054),N=a(n(23217)),F=n(13923),B=a(n(98007)),U=n(19529),H=n(49082),G=n(99935),W=a(n(59147)),V=a(n(38080)),z=n(15161),q=a(n(42037)),K=a(n(23425)),Y=n(85893);function Q(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(Q=function(e){return e?n:t})(e)}function X(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=Q(t);if(n&&n.has(e))return n.get(e);var a={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var o=r?Object.getOwnPropertyDescriptor(e,i):null;o&&(o.get||o.set)?Object.defineProperty(a,i,o):a[i]=e[i]}return a.default=e,n&&n.set(e,a),a}const Z=(e,t)=>!!e&&!!t&&me(e.publicKey,t.publicKey)&&me(e.identifier,t.identifier),J=(e,t)=>{if(!e&&!t)return!0;const n=(0,s.decodeProtobuf)(E.CombinedFingerprintSpec,e),a=(0,s.decodeProtobuf)(E.CombinedFingerprintSpec,t);if(!n&&!a)return!0;if(!(null!=n.version||null!=a.version||n.localFingerprint||a.localFingerprint||n.remoteFingerprint||a.remoteFingerprint))return!0;if(n.version!==a.version)return!1;const r=Z(n.localFingerprint,a.localFingerprint),i=Z(n.remoteFingerprint,a.remoteFingerprint);return r&&i};function $(e){const{binary:t=null,visible:n}=e,a=(0,c.useRef)(null),r=(0,c.useRef)(null),[o,s]=(0,c.useState)(!1),[d,u]=(0,c.useState)(null),[f,p]=(0,c.useState)(null),v=()=>{o||s(!0)},_=()=>{o||s(!0)},x=()=>{o&&s(!1)};(0,c.useEffect)((()=>{if(t){const e=a.current;if(!e||!t)return u(null),void p(null);if(J(d,t))return;for(r.current&&(r.current=null);e.firstChild;)e.removeChild(e.firstChild);r.current=new O.default(e,{text:t,width:i.QR_EDGE/2,height:i.QR_EDGE/2,correctLevel:O.default.CorrectLevel.L}),u(t);const n=e.getElementsByTagName("canvas")[0];if(!n)return void p(null);(e=>{const t=document.createElement("canvas");t.width=e.width+10,t.height=e.height+10;const n=t.getContext("2d");n.fillStyle="white",n.fillRect(0,0,t.width,t.height),n.drawImage(e,5,5),t.toBlob((e=>p(e)),"image/png")})(n)}}),[t,d]);let C=null;if(n){let t=null;if(o&&f){const n=e.contact.formattedUser||"",a=m.ContactCollection.assertGet((0,k.getMaybeMeUser)()).formattedUser;t=(0,Y.jsx)(g.default,{file:f,download:"Verification Code between "+a+" and "+n,extension:b.AllowedFileExtensions.PNG,children:(0,Y.jsx)(h.AvatarOverlay,{text:l.fbt._("Download code",null,{hk:"uiMxK"})})})}C=(0,Y.jsxs)("div",{onMouseOver:v,onMouseEnter:_,onMouseLeave:x,children:[t,(0,Y.jsx)("div",{className:q.default.circle,ref:a})]})}return C}const ee=(0,c.memo)($,((e,t)=>J(t.binary,e.binary)&&t.visible===e.visible));function te(e){let{visible:t}=e,n=null;return t&&(n=(0,Y.jsx)("div",{className:q.default.circle,children:(0,Y.jsx)("div",{className:q.default.spinner,children:(0,Y.jsx)(R.Spinner,{size:52,stroke:4})})})),n}function ne(e){let{binary:t,contact:n,visible:a}=e,r=null;return a&&(r=(0,Y.jsxs)("div",{className:(0,o.default)(q.default.container,q.default.circleContainer),children:[(0,Y.jsx)(ee,{visible:!!t,binary:t,contact:n}),(0,Y.jsx)(te,{visible:!t})]})),r}function ae(e){if(!e.string)return(0,Y.jsx)("div",{children:M.default.t(579)});const t=e.string;if(60!==t.length)return __LOG__(3)`verificationString:render props.string should be ${60} characters long instead of ${t.length}.`,(0,Y.jsx)("div",{children:l.fbt._("Couldn't display security code. You can verify using the QR code instead.",null,{hk:"3yMFFL"})});const n=[];for(let e=0;e<3;e++){const a=[];for(let n=0;n<4;n++){const r=[];for(let a=0;a<5;a++){const i=t.charAt(5*e*4+5*n+a);r.push((0,Y.jsx)("span",{className:q.default.digit,children:i},a))}a.push((0,Y.jsx)("span",{className:q.default.block,children:r},n))}n.push((0,Y.jsx)(A.SelectableDiv,{className:q.default.row,selectable:!0,children:a},e))}return(0,Y.jsx)(A.SelectableDiv,{selectable:!0,children:n})}const re=(0,c.memo)((0,c.forwardRef)(ae),((e,t)=>t.string===e.string));function ie(e){let{visible:t}=e,n=null;return t&&(n=(0,Y.jsx)("div",{className:(0,o.default)(q.default.container,q.default.checkmarkContainer),children:(0,Y.jsx)("div",{className:q.default.checkmark,children:"✓ "})})),n}function oe(e){let{visible:t}=e,n=null;return t&&(n=(0,Y.jsx)("div",{className:(0,o.default)(q.default.container,q.default.errorContainer),children:(0,Y.jsx)("div",{className:q.default.error,children:"!"})})),n}function se(e){let{children:t}=e;return(0,Y.jsx)("div",{className:q.default.errorBanner,children:t})}function le(e){const{stream:t,onCapture:n,disposeStream:a}=e,r=(0,c.useRef)(null),i=(0,c.useRef)(!1),o=(0,c.useRef)(null),s=(0,c.useRef)(null),[l]=(0,B.default)((()=>{var e;const t=null===(e=o.current)||void 0===e?void 0:e.underlyingVideo();if(!t)return;const a=document.createElement("canvas");a.width=t.videoWidth/2,a.height=t.videoHeight/2;a.getContext("2d").drawImage(t,a.width/2,a.height/2,a.width,a.height,0,0,a.width,a.height),a.toBlob((e=>{const t=window.URL.createObjectURL(e);__LOG__(2)`objectURL: ${t}`,n(t)}),"image/jpeg",1)}),200);(0,c.useEffect)((()=>((0,L.isSrcObjectInVideoElement)()||(r.current=window.URL.createObjectURL(t)),()=>{t&&(null==a||a(),r.current&&window.URL.revokeObjectURL(r.current))})),[]);const d=()=>{var e;const t=null===(e=o.current)||void 0===e?void 0:e.underlyingVideo(),n=s.current;if(!t||!n)return;const a=t.offsetHeight,r=t.offsetWidth,i=r/3,l=i;n.style.width=i+"px",n.style.height=l+"px",n.style.margin=(a-l)/2+"px "+(r-i)/2+"px"},u=()=>{!0!==i.current&&(d(),l())};(0,U.useListener)(window,"resize",d);let h=null;var f;e.stream&&(h=(0,Y.jsxs)("div",{className:q.default.webcam,children:[(0,Y.jsx)("div",{className:q.default.webcamVideo,children:(0,Y.jsx)(K.default,{autoPlay:!0,ref:o,onPlay:u,src:null!==(f=r.current)&&void 0!==f?f:void 0,srcObject:r.current?void 0:e.stream,width:"100%"})}),(0,Y.jsx)("div",{className:q.default.overlay,ref:s}),(0,Y.jsx)("button",{onClick:e.onClose,className:q.default.btnClose,children:(0,Y.jsx)(N.default,{name:"x-alt"})})]}));return h}const de=0,ce=1,ue=2,he=3,fe=4,pe=5;function me(e,t){if(!e||!t)return!1;const n=new Uint8Array(e),a=new Uint8Array(t),r=n.length;if(r!==a.length)return!1;for(let e=0;e<r;e++)if(n[e]!==a[e])return!1;return!0}},14551:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const t=(0,s.useContext)(v.ThemeContext);return(0,s.useEffect)((()=>(m.ServerProps.wallpapersV2&&l.default.trigger("wallpaper_drawer_open"),()=>{l.default.trigger("wallpaper_color_preview"),m.ServerProps.wallpapersV2&&l.default.trigger("wallpaper_drawer_close")})),[]),(0,S.jsxs)(u.default,{children:[(0,S.jsx)(f.DrawerHeader,{title:p.default.t(849),onBack:e.onClose,type:f.DRAWER_HEADER_TYPE.LARGE}),(0,S.jsx)(h.default,{children:(0,S.jsx)(b,{colors:(0,C.getWallpaperColors)(t.theme),chatPreference:l.default.get("defaultPreference")})})]})};var r=a(n(99964)),i=a(n(94184)),o=n(48360),s=n(67294),l=a(n(66034)),d=n(16593),c=n(88102),u=a(n(60453)),h=a(n(69637)),f=n(94790),p=a(n(43725)),m=n(64551),g=n(13923),v=n(97628),_=n(50452),x=n(49082),C=n(78123),y=a(n(98129)),S=n(85893);function j(e){const{colorHex:t,isDefault:n}=e,[a,o]=(0,s.useState)(!1),d=()=>n?C.DEFAULT_CHAT_WALLPAPER:t,u=e.isDefault?(0,S.jsx)("span",{className:y.default.wallpaperDefaultTitle,"data-a8n":r.default.key("wallpaper-default-title"),children:p.default.t(373)}):null,h=(0,i.default)(y.default.wallpaperColorCanvas,{[y.default.canvasHover]:a,[y.default.canvasActive]:e.isSelected,[y.default.canvasDefault]:e.isDefault});return(0,S.jsx)("span",{className:h,style:{backgroundColor:e.colorHex},onMouseOver:()=>{a||(o(!0),l.default.trigger("wallpaper_color_preview",d()))},onMouseEnter:()=>{a||(o(!0),l.default.trigger("wallpaper_color_preview",d()))},onMouseLeave:()=>{a&&(o(!1),l.default.trigger("wallpaper_color_preview"))},onClick:()=>{const e=d(),t=l.default.get("defaultPreference");t&&e!==t.wallpaperColor&&(t.set("wallpaperColor",e),c.Cmd.openToast((0,S.jsx)(_.Toast,{msg:p.default.t(848),id:(0,_.genId)()})))},title:e.isDefault?p.default.t(373):null,children:u})}function b(e){let t;const{colors:n}=e,a=(0,x.useOptionalModelValues)(e.chatPreference,["wallpaperColor","showDoodle"]),r=null==a?void 0:a.wallpaperColor,i=()=>{if(a){const e=!a.showDoodle;a.set("showDoodle",e),c.Cmd.openToast((0,S.jsx)(_.Toast,{msg:e?o.fbt._("Chat wallpaper doodles added",null,{hk:"4wtFSD"}):o.fbt._("Chat wallpaper doodles removed",null,{hk:"3cppZY"}),id:(0,_.genId)()}))}},s=null==a?void 0:a.showDoodle,l=n.map((e=>(0,S.jsx)(j,{colorHex:e,isSelected:r===e,isDefault:!1},e))),u=(0,S.jsx)(j,{isSelected:r===C.DEFAULT_CHAT_WALLPAPER,isDefault:!0},C.DEFAULT_CHAT_WALLPAPER);l.unshift(u);for(let e=0;e<2;e++)l.push((0,S.jsx)("div",{className:y.default.wallpaperColorEmpty},"emptyEl"+e));return m.ServerProps.wallpapersV2&&(t=(0,S.jsxs)("div",{className:y.default.wallpaperApplyDoodle,children:[(0,S.jsx)(d.CheckBox,{onChange:i,checked:!!s}),(0,S.jsx)(g.TextSpan,{className:y.default.checkboxLabel,theme:"small",children:o.fbt._("Add WhatsApp Doodles",null,{hk:"4rcSeh"})})]})),(0,S.jsxs)(S.Fragment,{children:[t,(0,S.jsx)("div",{className:y.default.wallpaperColorGrid,children:l})]})}},74410:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const t=(0,c.useModelValues)(e.statusV3,["id","t","hasUnread","unreadCount","totalCount","contact"]),n=(0,c.useModelValues)(e.contact,["formattedName","statusMute","isPSA"]),a=(0,r.default)({[s.default.dimmed]:n.statusMute}),h=o.Clock.relativeDateAndTimeStr(t.t);let f=n.formattedName;n.isPSA&&(f=(0,u.jsxs)("span",{className:s.default.verified,children:[n.formattedName,(0,u.jsx)("div",{className:s.default.icon,children:(0,u.jsx)(d.default,{name:"psa-verified"})})]}));return(0,u.jsx)(i.default,{className:a,customImage:!0,theme:"status-list",image:(0,u.jsx)(l.default,{statusV3:t,contact:n,onClick:e.onClick}),primary:f,secondary:h,onClick:e.onClick,contextEnabled:()=>!1},t.id.toString())};var r=a(n(94184)),i=a(n(49107)),o=n(22683),s=a(n(49787)),l=a(n(15265)),d=a(n(23217)),c=n(49082),u=n(85893)},15265:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{theme:t,thumbnailPlaceholder:n,msg:a}=e,r=(0,h.useModelValues)(e.statusV3,["lastStatus"]),i=(0,h.useModelValues)(e.contact,["statusMute"]),l=null!=a?a:r.lastStatus,c=p(t);let m;m=null!=n?n:l?(0,f.jsx)(s.DetailImage,{id:l.sender,theme:"status_v3",size:40}):null;return(0,f.jsxs)("div",{className:(0,o.default)(u.default.container,c),role:e.role||"",onContextMenu:null,onClickCapture:t=>{var n;null===(n=e.onClick)||void 0===n||n.call(e),t.stopPropagation(),t.preventDefault()},children:[i.statusMute||"status-panel"===t?null:(0,f.jsx)(d.StatusV3ImageRing,{statusV3:r}),(0,f.jsx)(g,{msg:l,theme:t,thumbnailPlaceholder:m})]})};var r=n(15461),i=a(n(89867)),o=a(n(94184)),s=n(88984),l=a(n(4293)),d=(n(31019),n(24391)),c=n(47786),u=a(n(39756)),h=n(49082),f=n(85893);function p(e){return"status-panel"===e?u.default.thumbSizeLarge:u.default.thumbSizeSmall}function m(e){const{msg:t,theme:n}=e;return(0,f.jsx)("div",{className:(0,o.default)(u.default.statusImage,p(n)),style:{backgroundColor:t.statusV3TextBg},children:(0,f.jsx)("div",{className:(0,o.default)(u.default.textThumb,p(n)),children:(0,f.jsx)(c.StatusV3Text,{msg:t,theme:null!=n?n:"status-thumbnail"})})})}function g(e){const{msg:t,theme:n,thumbnailPlaceholder:a}=e,s=p(n),d=u.default.statusImage;return t?i.default.isPSA(t.sender)?(0,f.jsx)("div",{className:(0,o.default)(u.default.thumbContainer,s,u.default.statusImageFallbackBackground),children:a}):t.type===r.MSG_TYPE.CHAT?(0,f.jsx)(m,{msg:t,theme:n}):(0,f.jsx)(l.default,{containerClassName:(0,o.default)(u.default.thumbContainer,s,u.default.statusImageFallbackBackground),childClassName:(0,o.default)(d,s),msg:t,thumbnailPlaceholder:a}):(0,f.jsx)("div",{className:(0,o.default)(d,s,u.default.statusImageFallbackBackground)})}},9425:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.StickerIcon=function(e){let{url:t,xstyle:n}=e;const[a,{isIntersecting:u}]=(0,s.default)({root:null,rootMargin:"0px",threshold:0}),h=(0,r.useRef)(u);return h.current=h.current||u,(0,l.jsx)("div",{ref:a,className:(0,i.default)(d,n),children:h.current&&(0,l.jsx)(o.ImgWithFallback,{fallbackSVG:"sticker",wrapOptions:{centerWrapperChild:!0,wrapperClassName:""},className:(0,i.default)(c),size:"NONE",roundContainer:!1,imgProps:{src:t,draggable:!1},theme:o.Theme.Transparent})})};var r=n(67294),i=a(n(56720)),o=n(50981),s=a(n(6914)),l=n(85893);const d={boxSizing:"cm280p3y",height:"graaj7av",width:"jgly3g7g",minHeight:"lignnmtc",minWidth:"j3e9rhaw",position:"g0rxnol2"},c={width:"ln8gz9je",height:"ppled2lx"}},63822:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{stickerPacks:t,onStickerPackDetails:n}=e,a=(0,u.default)((()=>new s.default)),f=(0,r.useMemo)((()=>t.map((e=>({itemKey:e.id,stickerPack:e})))),[t]);return(0,h.jsx)(o.default,{flatListControllers:[a.current],children:(0,h.jsx)(i.FlatList,{flatListController:a.current,direction:"vertical",forceConsistentRenderCount:!1,data:f,renderItem:e=>(0,h.jsx)(c.default,{data:e,onClick:n}),defaultItemHeight:d.STICKER_LIST_ITEM_HEIGHT,keyOrder:l.KeyOrder.INVERSE})})};var r=n(67294),i=n(47915),o=a(n(44942)),s=a(n(30855)),l=n(43882),d=n(90669),c=a(n(73966)),u=a(n(59552)),h=n(85893)},73966:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{stickerPack:t}=e.data,n=(0,u.jsxs)("div",{className:(0,i.default)(h.title),children:[(0,u.jsx)(l.EmojiText,{text:t.name,ellipsify:!0,titlify:!0}),t.animated?(0,u.jsx)(c.default,{name:"round-play",className:(0,i.default)(h.animatedIcon),width:16,height:16}):null]}),a=[],f=Math.min(6,t.previewImageIds.length);for(let e=0;e<f;e++){const n=t.previewImageIds[e];a.push((0,u.jsxs)(r.Fragment,{children:[(0,u.jsx)(o.default,{breakpoint:94*(e+1)-22,inverseToContainer:!0,maxWidth:"100%",minWidth:0}),(0,u.jsx)(d.StickerIcon,{url:`https://static.whatsapp.net/sticker?cat=sticker_preview_png&id=${n}`,xstyle:h.stickerIcon})]},n))}const p=(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(l.EmojiText,{text:t.publisher,ellipsify:!0}),(0,u.jsx)("div",{className:(0,i.default)(h.stickerIconsContainer),children:a})]});return(0,u.jsx)(s.default,{a8n:"sticker-pack-list-item",theme:"sticker-pack",primary:n,secondary:p,onClick:()=>{e.onClick(t)},className:(0,i.default)(h.stickerPack),contextEnabled:()=>!1},t.id)};var r=n(67294),i=a(n(56720)),o=a(n(8334)),s=a(n(49107)),l=n(65417),d=n(9425),c=a(n(23217)),u=n(85893);const h={stickerPack:{paddingStart:"lyvj5e2u",color:"h15s16sg"},title:{display:"p357zi0d",alignItems:"gndfcl4n"},animatedIcon:{marginStart:"oz0g9ue8",color:"kw851w1p"},stickerIconsContainer:{display:"p357zi0d",flexDirection:"sap93d0t",flexWrap:"dnb887gk",marginTop:"dj1c3cmq"},stickerIcon:{marginEnd:"gwq3iy2m"}}},18878:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.getCachedOrdersInfoFromChat=function(e){return Promise.resolve(c(e))},t.getMergedContactAndOrderInfoMap=function(e,t){return(0,r.default)((0,r.default)({},e),t.reduce(((e,t)=>(e[t.orderInfo.referenceId]=t,e)),{}))},t.getMergedOrderStatusInfoMap=function(e,t){return(0,r.default)((0,r.default)({},e),t.reduce(((e,t)=>(e[t.refId]=t,e)),{}))},t.getNotCachedOrdersInfoFromChat=function(e){return new Promise((t=>{const n=setInterval((()=>{e.loadEarlierMsgs(e.msgs)}),200),a=e.msgs.onMsgLoadStateChange((()=>{e.msgs.msgLoadState.noEarlierMsgs&&(t(c(e)),a(),clearInterval(n))}))}))},t.getOrderDisplayDate=void 0,t.getOrdersInfoFromMsgs=u;var r=a(n(81109)),i=n(15461),o=n(22683),s=(n(17304),a(n(5165))),l=n(34841),d=n(88998);function c(e){const{contact:t,msgs:n}=e;return u(n.toArray(),t)}function u(e,t){return e.reduce(((e,n)=>{var a;const[{name:r,buttonParamsJson:i}]=(null===(a=n.interactivePayload)||void 0===a?void 0:a.buttons)||[{}];if(n.nativeFlowName===s.default.ORDER_DETAILS){const a=n.t,o=(0,l.paramsJsonToOrderInfo)(r,i);o&&e.contactsAndOrdersInfo.push({contact:t,orderInfo:o,timestamp:a,interactiveMsg:h(n)})}else if(n.nativeFlowName===s.default.ORDER_STATUS){const t=(0,d.paramsJsonToOrderStatusInfo)(r,i);t&&e.ordersStatusInfo.push(t)}return e}),{contactsAndOrdersInfo:[],ordersStatusInfo:[]})}function h(e){const t=e.safe();return t.type===i.MSG_TYPE.INTERACTIVE?t:null}t.getOrderDisplayDate=(e,t,n)=>{const a=o.Clock.relativeDateStr(e[t[n]].timestamp).toString();return a===(n>0?o.Clock.relativeDateStr(e[t[n-1]].timestamp).toString():"")?"":a}},43538:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OrderStatusLabels=void 0;var a=n(48360),r=n(88998);const i={[String(r.OrderStatus.Pending)]:a.fbt._("Pending",null,{hk:"4GysRv"}),[String(r.OrderStatus.Processing)]:a.fbt._("Processing",null,{hk:"42EV23"}),[String(r.OrderStatus.PartiallyShipped)]:a.fbt._("Partially shipped",null,{hk:"2GgHwQ"}),[String(r.OrderStatus.Shipped)]:a.fbt._("Shipped",null,{hk:"30IDPY"}),[String(r.OrderStatus.Complete)]:a.fbt._("Completed",null,{hk:"1e4PVy"}),[String(r.OrderStatus.Canceled)]:a.fbt._("Cancel",null,{hk:"2TY0Hb"})};t.OrderStatusLabels=i},73915:(e,t,n)=>{"use strict";var a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.TOS_BASE_URL=void 0,t.getTosUrl=function(){return`${i}?lg=${r.default.getLocale()}`};var r=a(n(43725));const i="https://www.whatsapp.com/legal/";t.TOS_BASE_URL=i},85832:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.validateURL=t.validateEmail=t.EMAIL_REGEX=void 0;var a=n(2541);const r=new RegExp(/^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?/);t.EMAIL_REGEX=r;t.validateEmail=e=>!e||r.test(e);t.validateURL=e=>!e||a.URL_REGEX.test(e)},9349:(e,t,n)=>{e.exports=n.p+"img/animated-doodle_600127bdb5f7627ede5cd4ef320f55b0.png"},10093:(e,t,n)=>{e.exports=n.p+"img/sticker-pack-empty_9f0c66fc3aec33b2f78f0ae1721e053b.png"},56246:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a={editMain:"_3xeOe",dayMain:"elIXU",timeWrapper:"_3u7Nx",hoursAnd:"VtTvE",hoursMain:"_1t1ZU",dayCheckbox:"_1_yf5",dayInfo:"_2ycHc",dayInfoText:"_2RSsg"}},4830:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a={editMain:"_1GBQ2",list:"_2ORz2",rowMain:"_1DFmp",rowCheckbox:"_2pPkR",rowLabel:"_1NGCs",disabled:"YVobU",loadingSpinner:"_2-B6b",searchBackground:"_1Fb5R"}},73308:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a={verifiedNameIcon:"_3PMWi",noPaddingTop:"_23GE5"}},12923:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a={loadingSpinner:"_27f4X"}},32976:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a={info:"_1bDv-",footer:"_2a_BY",emptyCartContainer:"_2hNBn",emptyCardHeader:"_3SGPw",emptyCardText:"_1_kdr",btnSend:"apgxN",cartMessage:"_25cOj"}},10476:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a={price:"_2TWGj",actions:"_3qMz1",deleteIcon:"X73p1",cartListItem:"_22OLH"}},48608:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a={descriptionText:"_3cn-t",loadingSpinner:"_39T3a"}},24514:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a={nameContainer:"_2ZSfJ",nameIcon:"_2c2YS",nameEdit:"_3z09E",listContainer:"_3qa_s",footer:"_mlI_",saveButton:"_1Ah-d",operation:"hCFEO",spinner:"_2GKPh",isSending:"_29OTP",container:"_20LKm",loadingSpinner:"_1oYzh"}},18829:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a={productWrapper:"rJvJe",drawerHeader:"_1FOnF",drawerHeaderButtonContainer:"_31Lzw",deleteButtonContainer:"_3ACRw",isSending:"PH_zP",spinner:"_2uvSh",hiddenLabel:"_1iq2E",hiddenDescr:"_2CpMK",hiddenContainer:"_3CZ_C"}},3840:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a={addItemPlaceholder:"_1qJg-",placeholderIcon:"_36m_1",placeholderContainer:"_1G1TN",divider:"Ba9cd",isLoading:"_1GbNE",spinner:"_2K6GK"}},93748:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a={drawerHeader:"_3jATq",productName:"_1v6Jb",buttonSeparator:"_2DYm7",drawerHeaderButtonContainer:"_1TIjK",productWrapper:"_2jzzC",businessInfoTitle:"_3Lz6H"}},51817:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a={root:"_10NM0",appealText:"_1K_U7",icon:"_3eVMu",text:"Qqtdl"}},62342:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a={collectionIcon:"_2tGWa",iconContainer:"_1iPYw"}},40302:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a={loadingSpinner:"o3c-l"}},39658:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a={panel:"_1TOgh",tileContainer:"_1vfS7",imageTile:"_2a_Q7",imageThumb:"Cbc-m",deleteIcon:"_2WYev",btnAddContainer:"_1ar7j",btnAddText:"RAMrK",errorMessage:"_3E49Y"}},31516:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a={list:"_2V4Ys",noSections:"_82KlQ"}},77948:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a={title:"_2bLEK"}},47514:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a={disabled:"_1W_mm",title:"_2jAho"}},4389:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a={title:"_3Q5hz"}},70180:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a={title:"_13MJe",text:"hM3sj",icon:"_1p9YY"}},87240:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a={container:"_2RE0a",border:"_3t6bN",square:"_36Gk7",avatar:"_1b8fw",count:"_1gLP4",two:"_1EzI5",first:"JOgRb",second:"_3Q0g1",three:"_33l2L",third:"_1MivT",four:"_18BoY",fourth:"_1P7KC"}},34531:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a={imageGallery:"_3uMAp",imageGalleryList:"_1WX5F",imageGalleryItem:"MkTEt",imageGalleryItemSpacer:"_2ppZW",imageGalleryItemImage:"_6CxGV",imageGalleryItemOverlay:"_7mUkD",selected:"_1KnO5",imageGalleryFooter:"PYlBE",focusAnimation:"_30mp5",focusAnimationKeyframes:"_3i50e"}},56646:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a={container:"_3cOtp",body:"_1YLvc"}},85747:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a={container:"_1w1m1",disabled:"_3Sg2g",count:"ItnCt",large:"_3OTTU"}},39567:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a={versionInfo:"AwT3E"}},52144:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a={positioner:"_388vZ",container:"ewANj",resizableInput:"_1L8rJ",emojiButton:"_3tKNQ",buttonIconWrapper:"_1F5dF",inputContainer:"_3DCJ3",hiddenText:"_269u7",hiddenTextLine:"_3F7_-",emojiPlaceholder:"_39TQD"}},50907:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a={container:"_2nStn",inputContainer:"_1VmmK",videoCaption:"_2M4pc",buttonContainer:"_26J91",clearBtn:"_3EUIt",inputEmoji:"I1HlI",charCounter:"_3HWI2",suggestionsPositioner:"_3-qS1",suggestionsContainer:"_1Uy4i",secondaryButtonContainer:"_3g507"}},30635:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a={thumb:"_2AkjL",active:"_31gut",bodyWrapper:"_1iECW",body:"_1hZLd",bodyIcon:"_299B_",btnDelete:"_1By33"}},90388:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a={container:"_34aQy",header:"qAj2u",headerRight:"_3PqRX",canvasContainer:"_1PFn9",cropRotateContainer:"_3zRbB",closeButton:"_1gvdP",closeButtonPlaceholder:"_1Ao72",canvas:"_153i9",footer:"_1nPzf",bottomToolbar:"_1nNuD",captionInputContainer:"_1iQr1",captionInputHidden:"_6dYhh"}},79334:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a={container:"_1Mcu-",previewOnly:"_2NB7f",dropOverlay:"_1PdGl",dropOverlayOutline:"_2HexZ",spinner:"pzFG8",footer:"_1HI4Y",addMediaButton:"_1xotB",addMediaButtonDisabled:"WAMhx",filmstripContainer:"_1vAZI",thumbs:"_7Tfhi",sendButton:"_33pCO",captureFooter:"_1z1Aw"}},10706:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a={container:"_3gx1m",cropperContainer:"_2mSFk"}},45134:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a={body:"_25wph",previewContainer:"OW_mU",previewIcon:"_4FGL4",header:"_1Xi6x",metadata:"_3QpE7"}},58099:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a={container:"jcXC6"}},91976:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a={container:"_2SXhH",footer:"UJ-0N"}},86382:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a={container:"_2wtUo",selected:"_3z23o",disabled:"wZyqj",icon:"ZZ0GN",rotate:"_2X1cd",body:"_2O4Bw",caret:"_104hn"}},4837:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a={container:"_3eK79",colorChipsContainer:"_1E-L7"}},88501:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a={colorButton:"_2J8i-",primaryColorChip:"fteqj",primaryColorChipMedium:"_1Rjww",secondaryColorChip:"_1H9V5",active:"_3Jsf_",hover:"_1jiBu",selected:"_1lanH",colorChipWithBorder:"_2WYx6"}},60755:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a={container:"_1uNZ6",input:"_1bDiJ"}},50889:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a={canvas:"_3ZCwl",cursor:"_1YJQa"}},34618:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a={container:"fZGUF"}},52418:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a={container:"_1LRKO",rotateLeftButton:"_3dKFO"}},43384:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a={container:"QUfeO",fontLabel:"_3OMGG",icon:"_3SJCV"}},16702:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a={item:"_1j1xr",selected:"_2DKLD",sansSerif:"_106wS",serif:"_1yqqW",noricanRegular:"bzq8z",bryndanWrite:"_3Pj9c",oswaldHeavy:"ah3iR",alignmentContainer:"_2lKFu",alignmentIcon:"mi3vs",alignmentIconSelected:"_1KlZW"}},89046:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a={cirle:"_10ZsU",circleFilled:"_1ZATr",unchecked:"_1B4g5",checked:"_3s-4-"}},60349:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a={container:"_1_bv-",thicknessButton:"_3bAiP",thicknessChip:"_3iRrK",selected:"_32C9L"}},77046:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a={container:"JKr_m",media:"_3R3yC"}},71003:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a={container:"_3fFxj",media:"_3lqv9",document:"hH6sl",text:"eAWMI",icon:"fDWKK"}},58523:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a={container:"_1ULgK",media:"_2gN82",img:"OunMM",audio:"_3ZDt1",videoContainer:"_33jN5",spinner:"_1-L7X",video:"_2Vd8_",staticPreview:"sWhPU"}},53519:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a={container:"_2nVq-",preview:"_1K_xd",caption:"_3xLDc",img:"_2zsdh",imgBorder:"_2Cuay"}},10160:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a={inputContainer:"_hcHx",label:"_2Nd6M",input:"_3qFYS"}},56126:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a={container:"_3XAt1",wallpaperColorCanvas:"_2IV17",wallpaperColorEmpty:"ZxOfr",canvasActive:"_3ts_T",canvasHover:"_1zeZ4"}},63820:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a={addLabelBtContainer:"_2RW7t"}},20705:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a={actionBtns:"_1NODy",newLabelBtn:"_3_CYW",plus:"_3vPCO"}},62556:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a={list:"_2i0C9",hint:"_3sZ4R",button:"AoASc"}},26616:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a={container:"_3zKdl",body:"Sy3TC",captionInput:"_32AUO",footer:"_11gZr",retakeBtn:"rKFEM",retakeIcon:"_2rZzC",caption:"_1sxcB",videoContainer:"_2xIhM",video:"_2jZjN",btn:"_2kkeT",videoInactive:"_2eCp4",btnSend:"_1103Z",image:"_288ya",snapshot:"_3sE1m"}},37982:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a={defaultGroupIcon:"_3uDrP"}},33621:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a={newGroupButton:"EptxG",defaultGroupIcon:"bSJ6w"}},40261:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a={icon:"_2WtuC",body:"_3TCJd",spinner:"_1PKms",ack:"YYcY9",statusBlue:"_13UwK"}},45082:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a={dropOverlay:"PHaD9",dropOverlayOutline:"WsbTY"}},63881:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a={btnSend:"_1WEiG",attributionLink:"_4yicW",mediaBody:"_1YZ48",attribution:"_1nd00",footer:"iajo1",containerBackground:"_3rPvK",retake:"_3r-Fa",retakeIcon:"_3SS26",mediaElementBase:"_3ULIF",mediaElement:"_38bBM _3ULIF"}},214:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a={mediaViewerImg:"_2rSfC",cropOverlay:"pKKiG"}},50922:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a={scaler:"_3QxRj",scalerButton:"P6r3N"}},83123:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a={wrapper:"fvxZ_",icon:"_3kxe5",text:"sfUBV"}},57363:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a={linkContainer:"_3eSYR",descContainer:"_1r8tU",icon:"_3qnQ8"}},26297:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a={confirmationText:"_2rM2V"}},67371:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a={title:"_3X4ur",titleIcon:"_3v5-C",ack:"_3hJA9",statusBlue:"_31P1q",forwardCount:"_36jfD",spinner:"_3pJTm",list:"_34Zzk",footer:"W5HdQ"}},4025:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a={commentInput:"_2_o99",search:"_1Plju",groupInfo:"_2wLei",onSendInvite:"_2-WpU"}},77798:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a={animation:"o43XS","play-ltr":"_1-zyO",playLtr:"_1-zyO","play-rtl":"_27Hce",playRtl:"_27Hce",versionInfo:"_1hWGI"}},23918:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a={container:"_2BtE_",textContainer:"_2Tvyf",spinner:"HYKvS"}},50521:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a={container:"_2136P",list:"C1Dd9",header:"K1c_P",item:"_16f8P",right:"DMk3i",left:"_1mO8w",close:"_38Gu8",name:"_2z4ea",time:"_4VLPt"}},94692:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a={wrapper:"_9Gs_R",offline:"_3rEcJ",circle:"_2Xn1u",text:"_1nFpn",notification:"p9CjV",ended:"_2OrJW",lastUpdated:"_3VPfk"}},26658:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a={wrapper:"_26J0I",inactive:"_2ZG5x",offline:"Pc7bU",circle:"_1487t",text:"_2WNWn",backToCenter:"_3LWZ9",visible:"_2Ozk7"}},89332:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a={container:"_2BPRJ",map:"_312iE",authFailed:"xgGDH",loading:"L5P7F"}},92018:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a={container:"_3rs7K",selected:"_10G_J",glow:"h5TUN",stale:"_3WyhQ",expired:"_1HO_K",pin:"_2JeQm"}},6304:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a={list:"D0Q5P",stopSharingButton:"_8wYL"}},22828:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a={popup:"_1O7kH",container:"_1qWAL",twoLines:"_2dn9y",name:"_2UN5N",status:"_1fM0V",menuButton:"_2UenO",triangle:"_1NoUg"}},25850:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a={nextButton:"_1Opmc",section:"_1p7Ee",header:"_1AdYi",chevronIcon:"_3Xfdv"}},48566:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a={spinner:"_27bPO",search:"_3zFPA",inputarea:"_1x9wV",inputLine:"etp_f",contacts:"_2DdHI",drawerSection:"_37Xh5",inputareaSizer:"_2-opG"}},35456:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a={photoPickerWrapper:"_1Mc0y",scale:"_55HVY",nameWrapper:"_2LTDQ","well-animation":"_1EgwP",wellAnimation:"_1EgwP",phoneIcon:"_9P72S",phoneField:"_1zywm",infoText:"_3FDYs",bannedShopInfoText:"_1EFZ5",content:"_3XR9y"}},83968:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a={text:"_2QEzO",checkbox:"_3xbR9",header:"_1_8IZ"}},50717:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a={container:"_1J075",section:"_2BZQN",control:"_1iSYt",label:"_3AXj8",disabled:"_1Aj3d"}},78350:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a={more:"_394Lu",hotKeyWraper:"_3lwKF"}},55771:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a={body:"nWPOn",vcardWrapper:"j80SY",btnContainer:"_386ov",btnPosition:"_3o41r"}},42037:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a={form:"_1_psp",section:"S4s9L","well-animation2":"_3PdLd",wellAnimation2:"_3PdLd",circle:"_1C64q",spinner:"_3Ea-7",container:"xvgoq",show:"_2FUyH",circleContainer:"_28mPV",checkmarkContainer:"_1TMgk",errorContainer:"_1ScAm",checkmark:"qlZ5I",error:"_3Fr6b",errorBanner:"_3PYWJ",code:"xYqL-",row:"hsOn4",block:"_3WPv2",digit:"_3Muc-",explanation:"_37tSc",dragAndDropExplanation:"Lbmtf",photo:"_1Ua6g","drawer-scale":"_2OqK6",drawerScale:"_2OqK6",webcam:"_17NcY",webcamVideo:"PKLd7",btnClose:"_35Nbq",overlay:"_3APck"}},98129:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a={wallpaperApplyDoodle:"_1aWJq",checkboxLabel:"XvSmy",wallpaperColorGrid:"KzJy3",wallpaperColorCanvas:"Iwkc0",wallpaperDefaultTitle:"_2jzUd",wallpaperColorEmpty:"_1qqLM",canvasHover:"_3Mp8z",canvasActive:"_2MCR7",canvasDefault:"GRVkn"}},49787:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a={dimmed:"khEuM",verified:"_3e7DF",icon:"_3OVY5"}},39756:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a={textThumb:"qgEhU",thumbSizeSmall:"_14N8a",thumbSizeLarge:"_2dKet",statusImage:"_37ckN",statusImageFallbackBackground:"_14MS9",container:"_3xFA4",thumbContainer:"_1cDhn"}}}]);
//# sourceMappingURL=https://web.whatsapp.com/lazy_loaded_low_priority_components.947c450c1dec809265cf.js.map
