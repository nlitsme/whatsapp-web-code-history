/*! Copyright (c) 2021 WhatsApp Inc. All Rights Reserved. */
(self.webpackChunkbuild=self.webpackChunkbuild||[]).push([[9209],{88610:e=>{"use strict";e.exports=JSON.parse("[65,26,32,26,73,1,11,1,5,1,6,23,24,31,32,449,451,7,21,2,16,5,14,1,130,4,6,2,4,4,5,1,7,1,2,3,4,1,2,20,21,83,84,140,147,166,167,38,40,49,55,-1,46,-1,2,-1,3,-1,3,-1,2,-56,64,-1,3,-1,2,-1,14,-48,82,-3,4,-101,116,-2,9,-2,12,-23,24,-30,57,-91,102,-58,67,-2,6,-3,4,-24,28,-1,10,-1,4,-1,6,-43,46,-119,167,55,56,1,2,4,12,4,5,3,10,10,12,29,30,2,3,8,10,2,4,22,23,7,8,1,4,4,7,4,10,2,4,2,3,1,9,1,5,2,3,3,7,12,14,7,8,2,7,1,2,6,10,2,4,22,23,7,8,2,3,2,3,2,6,3,27,4,5,1,8,10,12,3,4,1,13,1,2,9,10,3,4,22,23,7,8,2,3,5,8,4,12,1,2,2,5,1,16,2,6,11,19,1,9,2,3,8,10,2,4,22,23,7,8,2,3,5,8,2,3,1,7,2,4,2,12,1,5,2,3,3,7,18,29,1,2,6,9,3,4,4,7,2,3,1,2,2,5,2,5,3,6,12,16,2,3,2,5,3,4,3,6,1,7,1,15,13,27,3,4,8,9,3,4,23,24,16,19,1,4,4,23,3,8,2,6,10,17,1,8,2,3,11,12,3,4,23,24,10,11,5,8,8,9,3,4,2,11,2,9,1,2,2,6,10,11,2,17,11,12,3,4,41,43,4,9,3,4,3,4,2,6,14,18,26,28,2,3,18,21,24,25,9,10,1,3,7,15,3,9,8,14,10,12,3,15,48,49,2,14,7,15,13,50,2,3,1,2,5,6,24,25,1,2,10,11,2,11,1,3,5,6,1,10,10,12,4,36,24,26,27,28,1,2,1,6,10,11,36,54,1,6,1,3,5,54,8,9,6,7,13,50,45,49,1,7,1,3,2,4,25,27,4,7,16,20,13,14,2,4,6,7,15,16,40,41,1,6,1,3,377,378,4,6,7,8,1,2,4,6,41,42,4,6,33,34,4,6,7,8,1,2,4,6,15,16,57,58,4,6,67,72,29,32,16,32,86,88,6,9,639,640,26,31,89,96,13,14,4,18,18,21,2,11,18,32,13,14,3,18,52,54,1,8,8,9,2,13,7,8,1,4,10,48,10,16,89,96,5,7,34,35,1,6,70,80,31,35,4,6,3,7,2,3,6,19,40,42,5,16,44,48,26,32,11,48,23,25,2,5,56,57,1,10,1,2,2,10,6,19,10,16,10,16,14,100,48,49,1,6,1,2,5,6,9,13,27,36,9,14,32,36,2,4,1,4,56,57,1,3,3,4,1,4,2,10,48,56,2,7,15,18,60,67,43,45,11,22,1,14,1,8,4,5,6,7,3,5,1,6,192,256,278,280,6,8,38,40,6,8,8,9,1,2,1,2,1,2,31,33,53,54,7,8,1,4,3,4,7,10,4,6,6,10,13,18,3,4,7,24,1,1,-1,98,1,14,1,17,13,114,1,5,1,3,10,11,1,4,5,11,1,2,1,2,1,2,4,5,11,13,4,9,5,9,2,18,41,470,69,95,1,263,78,528,1,340,256,1024,47,48,47,48,133,139,4,7,2,14,38,39,1,6,1,3,56,63,2,17,23,32,7,8,7,8,7,8,7,8,7,8,7,8,7,8,7,557,3,28,9,13,2,3,5,7,5,9,86,92,3,4,90,91,4,9,43,44,94,95,48,96,45,48,48,64,28,31,50,65,12,16,167,171,99,101,31,32,6592,6656,20989,20992,1165,1232,317,320,28,48,47,64,30,32,80,82,6,48,102,103,55,57,9,51,13,14,3,4,4,5,25,27,1,9,8,16,52,64,68,78,12,36,13,14,38,46,25,36,2,13,30,36,48,49,2,6,2,4,16,17,11,15,7,8,25,26,41,47,2,4,2,13,3,4,8,9,1,3,10,12,32,33,51,52,1,4,2,4,5,7,1,2,1,25,17,19,8,19,6,8,6,8,6,15,7,8,7,8,58,64,117,118,2,3,4,7,10,16,11172,11184,23,27,49,2101,6766,6768,106,144,7,19,5,10,-1,2,-10,11,-532,534,-144,176,-13,14,-2,114,-143,177,26,32,26,37,89,92,6,8,6,8,6,8,3,38,12,13,26,27,19,20,2,3,15,17,14,48,123,128,1,2,1,5,45,48,9,86,2,67,45,176,29,32,49,96,36,45,30,35,38,48,30,31,37,41,14,56,158,160,10,16,36,40,36,40,40,48,52,63,1,145,311,320,22,32,8,160,-287,288,-225,228,-1,3,-5,9,-40,43,-4,5,-165,167,-82,89,-484,488,-8,18,-294,325,-44,46,-153,164,-175,175,1,2,54,69,7,31,10,28,49,53,2,4,7,18,1,3,25,32,10,19,36,41,1,10,18,26,35,36,3,14,52,61,10,14,2,3,16,17,20,31,18,19,28,31,2,3,1,3,6,72,7,8,1,2,4,5,15,16,11,17,47,48,3,16,10,18,2,3,8,10,2,4,22,23,7,8,2,3,5,8,3,4,4,6,2,4,3,5,1,7,1,6,7,163,56,64,2,5,1,2,21,22,1,2,3,33,51,57,1,2,4,6,1,3,4,12,10,176,50,56,4,6,1,3,27,63,51,59,2,3,1,3,4,15,10,48,43,44,1,2,2,8,1,2,1,8,10,64,27,32,2,6,1,10,16,208,47,56,1,3,1,101,83,95,8,10,1,3,8,9,2,3,30,31,2,6,1,2,4,5,3,12,10,80,8,10,42,50,4,5,4,31,1,7,2,4,40,46,2,6,8,17,1,7,2,5,46,59,1,3,9,38,57,320,9,10,38,52,8,18,29,32,32,57,1,8,1,3,1,76,7,8,2,3,38,59,1,10,10,16,6,7,2,3,37,41,2,3,1,2,1,8,10,320,19,21,4,187,1,16,21,63,923,1025,111,112,5,16,196,2944,1071,1072,9,4048,583,9216,569,576,31,32,10,14,2,98,30,37,1,11,48,55,15,25,10,11,7,8,21,26,19,707,91,192,75,80,56,67,13,77,2,3,1,13,2,16,6136,6144,1238,1280,9,8960,287,336,3,20,4,12,396,2704,107,112,13,16,9,16,10,12,1,3,1,4961,246,256,39,41,62,65,9,25,2,9,30,34,59,306,20,128,25,160,85,86,71,72,2,4,1,3,2,4,4,5,12,13,1,2,7,8,65,66,4,6,8,9,7,8,28,29,4,5,5,6,1,4,7,8,340,342,51,52,57,58,57,58,57,58,57,58,8,60,512,567,4,54,8,9,14,15,7,1659,45,55,7,9,10,14,2,370,44,48,10,1296,-208,215,-109,116,-1445,1447,-270,542,31,32,58,64,61,118,29,42,44,48,9,16,2,3504,42718,42752,4149,4160,222,224,5762,5776,7473,10576,542,2048,4939,786432,65534,65536,65534]")},16290:(e,t,r)=>{var a={"./f00.png":28112,"./f01.png":42528,"./f02.png":36694,"./f03.png":11362,"./f04.png":79236,"./f05.png":91319,"./f06.png":71016,"./f07.png":63232,"./f08.png":92282,"./f09.png":59766,"./f10.png":76390,"./f11.png":45881,"./f12.png":4403,"./f13.png":55227,"./f14.png":93864,"./f15.png":43571,"./f16.png":8372,"./f17.png":83798,"./f18.png":34761,"./f19.png":53916,"./f20.png":47737,"./f21.png":34996,"./f22.png":85843,"./f23.png":90334,"./f24.png":16270,"./f25.png":1603,"./f26.png":92957,"./f27.png":70475,"./f28.png":41844,"./f29.png":67025,"./f30.png":88471,"./f31.png":20366,"./f32.png":77828,"./f33.png":86365,"./f34.png":4299,"./f35.png":97300,"./f36.png":12406,"./f37.png":29499,"./f38.png":82859,"./f39.png":70754,"./f40.png":9070,"./f41.png":61137,"./f42.png":82323,"./f43.png":59839,"./f44.png":32250,"./f45.png":19392,"./f46.png":89641,"./f47.png":90300,"./f48.png":36824,"./f49.png":38324,"./f50.png":81036,"./f51.png":60222,"./f52.png":11776,"./f53.png":98408,"./f54.png":78995,"./f55.png":76414,"./f56.png":19850,"./f57.png":76436,"./f58.png":12327,"./f59.png":5683,"./f60.png":28979,"./f61.png":38941,"./f62.png":12717,"./f63.png":89157,"./f64.png":58185,"./f65.png":22789,"./f66.png":43712,"./f67.png":58176,"./f68.png":38042,"./f69.png":84607,"./f70.png":56743,"./f71.png":71475,"./f72.png":91638,"./f73.png":60680,"./f74.png":99319,"./f75.png":72673,"./f76.png":90371,"./f77.png":99235,"./f78.png":74681,"./f79.png":44017,"./f80.png":91078,"./f81.png":85463,"./f82.png":50693,"./f83.png":60668,"./f84.png":70206,"./f85.png":33578,"./f86.png":23854,"./f87.png":61471,"./f88.png":32960,"./f89.png":21810,"./f90.png":90864,"./f91.png":56928,"./f92.png":80801,"./f93.png":59496,"./f94.png":36441,"./f95.png":74101,"./f96.png":42428,"./f97.png":18281,"./f98.png":89327,"./f99.png":13,"./favicon-error.png":55626,"./favicon-error2.png":80115,"./favicon.png":85010};function i(e){var t=n(e);return r(t)}function n(e){if(!r.o(a,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return a[e]}i.keys=function(){return Object.keys(a)},i.resolve=n,e.exports=i,i.id=16290},8893:(e,t,r)=>{var a={"./f00.png":3696,"./f01.png":60002,"./f02.png":94662,"./f03.png":46862,"./f04.png":17483,"./f05.png":84503,"./f06.png":86666,"./f07.png":65819,"./f08.png":78503,"./f09.png":80492,"./f10.png":9838,"./f11.png":58230,"./f12.png":9829,"./f13.png":87798,"./f14.png":9622,"./f15.png":81371,"./f16.png":89379,"./f17.png":11568,"./f18.png":84963,"./f19.png":84031,"./f20.png":47363,"./f21.png":15072,"./f22.png":55882,"./f23.png":52906,"./f24.png":27643,"./f25.png":24808,"./f26.png":39778,"./f27.png":62918,"./f28.png":46203,"./f29.png":12124,"./f30.png":40921,"./f31.png":36075,"./f32.png":50820,"./f33.png":41557,"./f34.png":54244,"./f35.png":86200,"./f36.png":35886,"./f37.png":45892,"./f38.png":89059,"./f39.png":14235,"./f40.png":85310,"./f41.png":1883,"./f42.png":81712,"./f43.png":11176,"./f44.png":64735,"./f45.png":55380,"./f46.png":60416,"./f47.png":82479,"./f48.png":26559,"./f49.png":64524,"./f50.png":90832,"./f51.png":14502,"./f52.png":40316,"./f53.png":6347,"./f54.png":10348,"./f55.png":7667,"./f56.png":44117,"./f57.png":9713,"./f58.png":26541,"./f59.png":7986,"./f60.png":70184,"./f61.png":53531,"./f62.png":53737,"./f63.png":95851,"./f64.png":85713,"./f65.png":79963,"./f66.png":64784,"./f67.png":40143,"./f68.png":24041,"./f69.png":49811,"./f70.png":69809,"./f71.png":13510,"./f72.png":11034,"./f73.png":60956,"./f74.png":30816,"./f75.png":89456,"./f76.png":56194,"./f77.png":29022,"./f78.png":26478,"./f79.png":35114,"./f80.png":33618,"./f81.png":65771,"./f82.png":31596,"./f83.png":93862,"./f84.png":58916,"./f85.png":80998,"./f86.png":91920,"./f87.png":18343,"./f88.png":85191,"./f89.png":18011,"./f90.png":37855,"./f91.png":37567,"./f92.png":22297,"./f93.png":16206,"./f94.png":82379,"./f95.png":59353,"./f96.png":68161,"./f97.png":72202,"./f98.png":18133,"./f99.png":91681,"./favicon-error.png":98973,"./favicon-error2.png":33805,"./favicon.png":23238};function i(e){var t=n(e);return r(t)}function n(e){if(!r.o(a,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return a[e]}i.keys=function(){return Object.keys(a)},i.resolve=n,e.exports=i,i.id=8893},26819:module=>{var e={},aa={},l;for(l in e)e.hasOwnProperty(l)&&(aa[l]=e[l]);function ba(e){eval.call(null,e)}for(l in e.read=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText},"undefined"!=typeof arguments&&(e.arguments=arguments),"undefined"!=typeof console?(e.print||(e.print=function(e){console.log(e)}),e.printErr||(e.printErr=function(e){console.log(e)})):e.print||(e.print=function(){}),void 0===e.setWindowTitle&&(e.setWindowTitle=function(e){document.title=e}),!e.load&&e.read&&(e.load=function(t){ba(e.read(t))}),e.print||(e.print=function(){}),e.printErr||(e.printErr=e.print),e.arguments||(e.arguments=[]),e.thisProgram||(e.thisProgram="./this.program"),e.print=e.print,e.S=e.printErr,e.preRun=[],e.postRun=[],aa)aa.hasOwnProperty(l)&&(e[l]=aa[l]);var n={cb:function(e){ca=e},Ua:function(){return ca},na:function(){return m},X:function(e){m=e},Aa:function(e){switch(e){case"i1":case"i8":return 1;case"i16":return 2;case"i32":return 4;case"i64":return 8;case"float":return 4;case"double":return 8;default:return"*"===e[e.length-1]?n.H:"i"===e[0]?(assert(0==(e=parseInt(e.substr(1)))%8),e/8):0}},Ta:function(e){return Math.max(n.Aa(e),n.H)},dd:16,Bd:function(e,t){return"double"===t||"i64"===t?7&e&&(assert(4==(7&e)),e+=4):assert(0==(3&e)),e},od:function(e,t,r){return r||"i64"!=e&&"double"!=e?e?Math.min(t||(e?n.Ta(e):0),n.H):Math.min(t,8):8},J:function(t,r,a){return a&&a.length?(a.splice||(a=Array.prototype.slice.call(a)),a.splice(0,0,r),e["dynCall_"+t].apply(null,a)):e["dynCall_"+t].call(null,r)},U:[],Ma:function(e){for(var t=0;t<n.U.length;t++)if(!n.U[t])return n.U[t]=e,2*(1+t);throw"Finished up all reserved function pointers. Use a higher value for RESERVED_FUNCTION_POINTERS."},$a:function(e){n.U[(e-2)/2]=null},M:function(t){n.M.ma||(n.M.ma={}),n.M.ma[t]||(n.M.ma[t]=1,e.S(t))},ha:{},rd:function(e,t){assert(t),n.ha[t]||(n.ha[t]={});var r=n.ha[t];return r[e]||(r[e]=function(){return n.J(t,e,arguments)}),r[e]},pd:function(){throw"You must build with -s RETAIN_COMPILER_SETTINGS=1 for Runtime.getCompilerSetting or emscripten_get_compiler_setting to work"},W:function(e){var t=m;return m=(m=m+e|0)+15&-16,t},Ia:function(e){var t=p;return p=(p=p+e|0)+15&-16,t},P:function(e){var t=v;return(e=(v=(v=v+e|0)+15&-16)>=w)&&(z("Cannot enlarge memory arrays. Either (1) compile with  -s TOTAL_MEMORY=X  with X higher than the current value "+w+", (2) compile with  -s ALLOW_MEMORY_GROWTH=1  which adjusts the size at runtime but prevents some optimizations, (3) set Module.TOTAL_MEMORY to a higher value before the program runs, or if you want malloc to return NULL (0) instead of this abort, compile with  -s ABORTING_MALLOC=0 "),e=!0),e?(v=t,0):t},ea:function(e,t){return Math.ceil(e/(t||16))*(t||16)},xd:function(e,t,r){return r?+(e>>>0)+4294967296*+(t>>>0):+(e>>>0)+4294967296*+(0|t)},La:8,H:4,ed:0};e.Runtime=n,n.addFunction=n.Ma,n.removeFunction=n.$a;var A=!1,da,fa,ca,ha,ia,buffer;function assert(e,t){e||z("Assertion failed: "+t)}function ga(a){var b=e["_"+a];if(!b)try{b=eval("_"+a)}catch(e){}return assert(b,"Cannot call unknown function "+a+" (perhaps LLVM optimizations or closure removed it?)"),b}function ma(e,t,r){switch("*"===(r=r||"i8").charAt(r.length-1)&&(r="i32"),r){case"i1":case"i8":D[e>>0]=t;break;case"i16":E[e>>1]=t;break;case"i32":F[e>>2]=t;break;case"i64":fa=[t>>>0,(da=t,1<=+na(da)?0<da?(0|oa(+pa(da/4294967296),4294967295))>>>0:~~+qa((da-+(~~da>>>0))/4294967296)>>>0:0)],F[e>>2]=fa[0],F[e+4>>2]=fa[1];break;case"float":ra[e>>2]=t;break;case"double":sa[e>>3]=t;break;default:z("invalid type for setValue: "+r)}}function ta(e,t){switch("*"===(t=t||"i8").charAt(t.length-1)&&(t="i32"),t){case"i1":case"i8":return D[e>>0];case"i16":return E[e>>1];case"i32":case"i64":return F[e>>2];case"float":return ra[e>>2];case"double":return sa[e>>3];default:z("invalid type for setValue: "+t)}return null}function G(e,t,r,a){var i,s;"number"==typeof e?(i=!0,s=e):(i=!1,s=e.length);var o,l,d="string"==typeof t?t:null;if(r=4==r?a:[ua,n.W,n.Ia,n.P][void 0===r?2:r](Math.max(s,d?1:t.length)),i){for(a=r,assert(0==(3&r)),e=r+(-4&s);a<e;a+=4)F[a>>2]=0;for(e=r+s;a<e;)D[a++>>0]=0;return r}if("i8"===d)return e.subarray||e.slice?H.set(e,r):H.set(new Uint8Array(e),r),r;for(a=0;a<s;){var u=e[a];"function"==typeof u&&(u=n.sd(u)),0===(i=d||t[a])?a++:("i64"==i&&(i="i32"),ma(r+a,u,i),l!==i&&(o=n.Aa(i),l=i),a+=o)}return r}function la(t,r){if(0===r||!t)return"";for(var a,i=0,n=0;(i|=a=H[t+n>>0],0!=a||r)&&(n++,!r||n!=r););if(r||(r=n),a="",128>i){for(;0<r;)i=String.fromCharCode.apply(String,H.subarray(t,t+Math.min(r,1024))),a=a?a+i:i,t+=1024,r-=1024;return a}return e.UTF8ToString(t)}function za(e,t){for(var r,a,i,n,s,o="";;){if(!(r=e[t++]))return o;128&r?(a=63&e[t++],192==(224&r)?o+=String.fromCharCode((31&r)<<6|a):(i=63&e[t++],224==(240&r)?r=(15&r)<<12|a<<6|i:(n=63&e[t++],240==(248&r)?r=(7&r)<<18|a<<12|i<<6|n:(s=63&e[t++],248==(252&r)?r=(3&r)<<24|a<<18|i<<12|n<<6|s:r=(1&r)<<30|a<<24|i<<18|n<<12|s<<6|63&e[t++])),65536>r?o+=String.fromCharCode(r):(r-=65536,o+=String.fromCharCode(55296|r>>10,56320|1023&r)))):o+=String.fromCharCode(r)}}function Aa(e,t,r,a){if(!(0<a))return 0;var i=r;a=r+a-1;for(var n=0;n<e.length;++n){var s=e.charCodeAt(n);if(55296<=s&&57343>=s&&(s=65536+((1023&s)<<10)|1023&e.charCodeAt(++n)),127>=s){if(r>=a)break;t[r++]=s}else{if(2047>=s){if(r+1>=a)break;t[r++]=192|s>>6}else{if(65535>=s){if(r+2>=a)break;t[r++]=224|s>>12}else{if(2097151>=s){if(r+3>=a)break;t[r++]=240|s>>18}else{if(67108863>=s){if(r+4>=a)break;t[r++]=248|s>>24}else{if(r+5>=a)break;t[r++]=252|s>>30,t[r++]=128|s>>24&63}t[r++]=128|s>>18&63}t[r++]=128|s>>12&63}t[r++]=128|s>>6&63}t[r++]=128|63&s}}return t[r]=0,r-i}function Ba(e){for(var t=0,r=0;r<e.length;++r){var a=e.charCodeAt(r);55296<=a&&57343>=a&&(a=65536+((1023&a)<<10)|1023&e.charCodeAt(++r)),127>=a?++t:t=2047>=a?t+2:65535>=a?t+3:2097151>=a?t+4:67108863>=a?t+5:t+6}return t}function Ca(t){var r=!!e.___cxa_demangle;if(r)try{var a=ua(t.length);ka(t.substr(1),a);var i=ua(4),s=e.___cxa_demangle(a,0,0,i);if(0===ta(i,"i32")&&s)return la(s)}catch(e){}finally{a&&Da(a),i&&Da(i),s&&Da(s)}var o=3,l={v:"void",b:"bool",c:"char",s:"short",i:"int",l:"long",f:"float",d:"double",w:"wchar_t",a:"signed char",h:"unsigned char",t:"unsigned short",j:"unsigned int",m:"unsigned long",x:"long long",y:"unsigned long long",z:"..."},d=[],u=!0;a=t;try{if("Object._main"==t||"_main"==t)return"main()";if("number"==typeof t&&(t=la(t)),"_"!==t[0]||"_"!==t[1]||"Z"!==t[2])return t;switch(t[3]){case"n":return"operator new()";case"d":return"operator delete()"}a=function e(r,a,i){a=a||1/0;var n,s="",c=[];if("N"===t[o]){for(o++,"K"===t[o]&&o++,n=[];"E"!==t[o];)if("S"===t[o]){o++;var p=t.indexOf("_",o);n.push(d[t.substring(o,p)||0]||"?"),o=p+1}else if("C"===t[o])n.push(n[n.length-1]),o+=2;else{var h=(p=parseInt(t.substr(o))).toString().length;if(!p||!h){o--;break}var f=t.substr(o+h,p);n.push(f),d.push(f),o+=h+p}if(o++,n=n.join("::"),0==--a)return r?[n]:n}else("K"===t[o]||u&&"L"===t[o])&&o++,(p=parseInt(t.substr(o)))&&(h=p.toString().length,n=t.substr(o+h,p),o+=h+p);u=!1,"I"===t[o]?(o++,p=e(!0),s+=(h=e(!0,1,!0))[0]+" "+n+"<"+p.join(", ")+">"):s=n;e:for(;o<t.length&&0<a--;)if(n=t[o++],n in l)c.push(l[n]);else switch(n){case"P":c.push(e(!0,1,!0)[0]+"*");break;case"R":c.push(e(!0,1,!0)[0]+"&");break;case"L":o++,p=t.indexOf("E",o)-o,c.push(t.substr(o,p)),o+=p+2;break;case"A":if(p=parseInt(t.substr(o)),o+=p.toString().length,"_"!==t[o])throw"?";o++,c.push(e(!0,1,!0)[0]+" ["+p+"]");break;case"E":break e;default:s+="?"+n;break e}return i||1!==c.length||"void"!==c[0]||(c=[]),r?(s&&c.push(s+"?"),c):s+"("+c.join(", ")+")"}()}catch(e){a+="?"}return 0<=a.indexOf("?")&&!r&&n.M("warning: a problem occurred in builtin C++ name demangling; build with  -s DEMANGLE_SUPPORT=1  to link in libcxxabi demangling"),a}function Ea(){return Fa().replace(/__Z[\w\d_]+/g,(function(e){var t=Ca(e);return e===t?e:e+" ["+t+"]"}))}function Fa(){var e=Error();if(!e.stack){try{throw Error(0)}catch(t){e=t}if(!e.stack)return"(no stack trace available)"}return e.stack.toString()}function Ga(){var e=v;return 0<e%4096&&(e+=4096-e%4096),e}(function(){function a(e){return{arguments:(e=e.toString().match(d).slice(1))[0],body:e[1],returnValue:e[2]}}var b={stackSave:function(){n.na()},stackRestore:function(){n.X()},arrayToC:function(e){var t=n.W(e.length);return ja(e,t),t},stringToC:function(e){var t=0;return null!=e&&0!==e&&ka(e,t=n.W(1+(e.length<<2))),t}},c={string:b.stringToC,array:b.arrayToC};ia=function(e,t,r,a,i){e=ga(e);var s=[],o=0;if(a)for(var l=0;l<a.length;l++){var d=c[r[l]];d?(0===o&&(o=n.na()),s[l]=d(a[l])):s[l]=a[l]}if(r=e.apply(null,s),"string"===t&&(r=la(r)),0!==o){if(i&&i.async)return void EmterpreterAsync.hd.push((function(){n.X(o)}));n.X(o)}return r};var d=/^function\s*\(([^)]*)\)\s*{\s*([^*]*?)[\s;]*(?:return\s*(.*?)[;\s]*)?}$/,f={},h;for(h in b)b.hasOwnProperty(h)&&(f[h]=a(b[h]));ha=function(b,c,d){d=d||[];var h=ga(b);b=d.every((function(e){return"number"===e}));var u="string"!==c;if(u&&b)return h;var q=d.map((function(e,t){return"$"+t}));c="(function("+q.join(",")+") {";var y=d.length;if(!b){c+="var stack = "+f.stackSave.body+";";for(var B=0;B<y;B++){var J=q[B],ea=d[B];"number"!==ea&&(ea=f[ea+"ToC"],c+="var "+ea.arguments+" = "+J+";",c+=ea.body+";",c+=J+"="+ea.returnValue+";")}}return d=a((function(){return h})).returnValue,c+="var ret = "+d+"("+q.join(",")+");",u||(d=a((function(){return la})).returnValue,c+="ret = "+d+"(ret);"),b||(c+=f.stackRestore.body.replace("()","(stack)")+";"),eval(c+"return ret})")}})(),e.ccall=ia,e.cwrap=ha,e.setValue=ma,e.getValue=ta,e.ALLOC_NORMAL=0,e.ALLOC_STACK=1,e.ALLOC_STATIC=2,e.ALLOC_DYNAMIC=3,e.ALLOC_NONE=4,e.allocate=G,e.getMemory=function(e){return va?void 0!==wa&&!wa.C||!xa?n.P(e):ua(e):n.Ia(e)},e.Pointer_stringify=la,e.AsciiToString=function(e){for(var t="";;){var r=D[e++>>0];if(!r)return t;t+=String.fromCharCode(r)}},e.stringToAscii=function(e,t){return ya(e,t,!1)},e.UTF8ArrayToString=za,e.UTF8ToString=function(e){return za(H,e)},e.stringToUTF8Array=Aa,e.stringToUTF8=function(e,t,r){return Aa(e,H,t,r)},e.lengthBytesUTF8=Ba,e.UTF16ToString=function(e){for(var t=0,r="";;){var a=E[e+2*t>>1];if(0==a)return r;++t,r+=String.fromCharCode(a)}},e.stringToUTF16=function(e,t,r){if(void 0===r&&(r=2147483647),2>r)return 0;var a=t;r=(r-=2)<2*e.length?r/2:e.length;for(var i=0;i<r;++i)E[t>>1]=e.charCodeAt(i),t+=2;return E[t>>1]=0,t-a},e.lengthBytesUTF16=function(e){return 2*e.length},e.UTF32ToString=function(e){for(var t=0,r="";;){var a=F[e+4*t>>2];if(0==a)return r;++t,65536<=a?(a-=65536,r+=String.fromCharCode(55296|a>>10,56320|1023&a)):r+=String.fromCharCode(a)}},e.stringToUTF32=function(e,t,r){if(void 0===r&&(r=2147483647),4>r)return 0;var a=t;r=a+r-4;for(var i=0;i<e.length;++i){if(55296<=(n=e.charCodeAt(i))&&57343>=n)var n=65536+((1023&n)<<10)|1023&e.charCodeAt(++i);if(F[t>>2]=n,(t+=4)+4>r)break}return F[t>>2]=0,t-a},e.lengthBytesUTF32=function(e){for(var t=0,r=0;r<e.length;++r){var a=e.charCodeAt(r);55296<=a&&57343>=a&&++r,t+=4}return t},e.stackTrace=function(){return Ea()};for(var D,H,E,Ha,F,Ia,ra,sa,Ja=0,p=0,va=!1,Ka=0,m=0,La=0,Ma=0,v=0,Na=e.TOTAL_STACK||5242880,w=e.TOTAL_MEMORY||16777216,I=65536;I<w||I<2*Na;)I=16777216>I?2*I:I+16777216;function Oa(e){for(;0<e.length;){var t=e.shift();if("function"==typeof t)t();else{var r=t.Qa;"number"==typeof r?void 0===t.T?n.J("v",r):n.J("vi",r,[t.T]):r(void 0===t.T?null:t.T)}}}I!==w&&(w=I),assert("undefined"!=typeof Int32Array&&"undefined"!=typeof Float64Array&&!!new Int32Array(1).subarray&&!!new Int32Array(1).set,"JS engine does not provide full typed array support"),buffer=new ArrayBuffer(w),D=new Int8Array(buffer),E=new Int16Array(buffer),F=new Int32Array(buffer),H=new Uint8Array(buffer),Ha=new Uint16Array(buffer),Ia=new Uint32Array(buffer),ra=new Float32Array(buffer),sa=new Float64Array(buffer),F[0]=255,assert(255===H[0]&&0===H[3],"Typed arrays 2 must be run on a little-endian system"),e.HEAP=void 0,e.buffer=buffer,e.HEAP8=D,e.HEAP16=E,e.HEAP32=F,e.HEAPU8=H,e.HEAPU16=Ha,e.HEAPU32=Ia,e.HEAPF32=ra,e.HEAPF64=sa;var Pa=[],Qa=[],Ra=[],K=[],Sa=[],xa=!1;function Ta(e){Pa.unshift(e)}function Ua(e){Sa.unshift(e)}function Va(e,t,r){return e=Aa(e,r=Array(0<r?r:Ba(e)+1),0,r.length),t&&(r.length=e),r}function ka(e,t,r){for(e=Va(e,r),r=0;r<e.length;)D[t+r>>0]=e[r],r+=1}function ja(e,t){for(var r=0;r<e.length;r++)D[t++>>0]=e[r]}function ya(e,t,r){for(var a=0;a<e.length;++a)D[t++>>0]=e.charCodeAt(a);r||(D[t>>0]=0)}e.addOnPreRun=Ta,e.addOnInit=function(e){Qa.unshift(e)},e.addOnPreMain=function(e){Ra.unshift(e)},e.addOnExit=function(e){K.unshift(e)},e.addOnPostRun=Ua,e.intArrayFromString=Va,e.intArrayToString=function(e){for(var t=[],r=0;r<e.length;r++){var a=e[r];255<a&&(a&=255),t.push(String.fromCharCode(a))}return t.join("")},e.writeStringToMemory=ka,e.writeArrayToMemory=ja,e.writeAsciiToMemory=ya,Math.imul&&-5===Math.imul(4294967295,5)||(Math.imul=function(e,t){var r=65535&e,a=65535&t;return r*a+((e>>>16)*a+r*(t>>>16)<<16)|0}),Math.td=Math.imul,Math.clz32||(Math.clz32=function(e){e>>>=0;for(var t=0;32>t;t++)if(e&1<<31-t)return t;return 32}),Math.kd=Math.clz32;var na=Math.abs,qa=Math.ceil,pa=Math.floor,oa=Math.min,L=0,Wa=null,Xa=null;function Ya(){L++,e.monitorRunDependencies&&e.monitorRunDependencies(L)}function Za(){if(L--,e.monitorRunDependencies&&e.monitorRunDependencies(L),0==L&&(null!==Wa&&(clearInterval(Wa),Wa=null),Xa)){var t=Xa;Xa=null,t()}}e.addRunDependency=Ya,e.removeRunDependency=Za,e.preloadedImages={},e.preloadedAudios={},Ja=8,p=Ja+1696,Qa.push(),G([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,60,0,0,0,0,0,0,0,5,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,2,0,0,0,164,2,0,0,0,4,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,10,255,255,255,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"i8",4,n.La);var $a=n.ea(G(12,"i8",2),8);function eb(e,t){K.push((function(){n.J("vi",e,[t])})),eb.level=K.length}assert(0==$a%8),e._bitshift64Ashr=ab,e._i64Subtract=bb,e._i64Add=cb,e._memset=db,e._bitshift64Lshr=fb,e._bitshift64Shl=gb;var M={G:1,B:2,Qc:3,Nb:4,F:5,sa:6,gb:7,kc:8,Z:9,ub:10,oa:11,$c:11,Ka:12,Y:13,Gb:14,wc:15,$:16,pa:17,ad:18,ba:19,qa:20,N:21,u:22,fc:23,Ja:24,O:25,Xc:26,Hb:27,sc:28,da:29,Nc:30,Zb:31,Gc:32,Db:33,Kc:34,oc:42,Kb:43,vb:44,Qb:45,Rb:46,Sb:47,Yb:48,Yc:49,ic:50,Pb:51,Ab:35,lc:37,mb:52,pb:53,bd:54,gc:55,qb:56,rb:57,Bb:35,sb:59,uc:60,jc:61,Uc:62,tc:63,pc:64,qc:65,Mc:66,mc:67,jb:68,Rc:69,wb:70,Hc:71,ac:72,Eb:73,ob:74,Bc:76,nb:77,Lc:78,Tb:79,Ub:80,Xb:81,Wb:82,Vb:83,vc:38,ra:39,bc:36,aa:40,Cc:95,Fc:96,zb:104,hc:105,kb:97,Jc:91,zc:88,rc:92,Oc:108,yb:111,hb:98,xb:103,ec:101,cc:100,Vc:110,Ib:112,Jb:113,Mb:115,lb:114,Cb:89,$b:90,Ic:93,Pc:94,ib:99,dc:102,Ob:106,xc:107,Wc:109,Zc:87,Fb:122,Sc:116,Ac:95,nc:123,Lb:84,Dc:75,tb:125,yc:131,Ec:130,Tc:86},hb={0:"Success",1:"Not super-user",2:"No such file or directory",3:"No such process",4:"Interrupted system call",5:"I/O error",6:"No such device or address",7:"Arg list too long",8:"Exec format error",9:"Bad file number",10:"No children",11:"No more processes",12:"Not enough core",13:"Permission denied",14:"Bad address",15:"Block device required",16:"Mount device busy",17:"File exists",18:"Cross-device link",19:"No such device",20:"Not a directory",21:"Is a directory",22:"Invalid argument",23:"Too many open files in system",24:"Too many open files",25:"Not a typewriter",26:"Text file busy",27:"File too large",28:"No space left on device",29:"Illegal seek",30:"Read only file system",31:"Too many links",32:"Broken pipe",33:"Math arg out of domain of func",34:"Math result not representable",35:"File locking deadlock error",36:"File or path name too long",37:"No record locks available",38:"Function not implemented",39:"Directory not empty",40:"Too many symbolic links",42:"No message of desired type",43:"Identifier removed",44:"Channel number out of range",45:"Level 2 not synchronized",46:"Level 3 halted",47:"Level 3 reset",48:"Link number out of range",49:"Protocol driver not attached",50:"No CSI structure available",51:"Level 2 halted",52:"Invalid exchange",53:"Invalid request descriptor",54:"Exchange full",55:"No anode",56:"Invalid request code",57:"Invalid slot",59:"Bad font file fmt",60:"Device not a stream",61:"No data (for no delay io)",62:"Timer expired",63:"Out of streams resources",64:"Machine is not on the network",65:"Package not installed",66:"The object is remote",67:"The link has been severed",68:"Advertise error",69:"Srmount error",70:"Communication error on send",71:"Protocol error",72:"Multihop attempted",73:"Cross mount point (not really error)",74:"Trying to read unreadable message",75:"Value too large for defined data type",76:"Given log. name not unique",77:"f.d. invalid for this operation",78:"Remote address changed",79:"Can   access a needed shared lib",80:"Accessing a corrupted shared lib",81:".lib section in a.out corrupted",82:"Attempting to link in too many libs",83:"Attempting to exec a shared library",84:"Illegal byte sequence",86:"Streams pipe error",87:"Too many users",88:"Socket operation on non-socket",89:"Destination address required",90:"Message too long",91:"Protocol wrong type for socket",92:"Protocol not available",93:"Unknown protocol",94:"Socket type not supported",95:"Not supported",96:"Protocol family not supported",97:"Address family not supported by protocol family",98:"Address already in use",99:"Address not available",100:"Network interface is not configured",101:"Network is unreachable",102:"Connection reset by network",103:"Connection aborted",104:"Connection reset by peer",105:"No buffer space available",106:"Socket is already connected",107:"Socket is not connected",108:"Can't send after socket shutdown",109:"Too many references",110:"Connection timed out",111:"Connection refused",112:"Host is down",113:"Host is unreachable",114:"Socket already connected",115:"Connection already in progress",116:"Stale file handle",122:"Quota exceeded",123:"No medium (in tape drive)",125:"Operation canceled",130:"Previous owner died",131:"State not recoverable"};function ib(t){return e.___errno_location&&(F[e.___errno_location()>>2]=t),t}function jb(e,t){for(var r=0,a=e.length-1;0<=a;a--){var i=e[a];"."===i?e.splice(a,1):".."===i?(e.splice(a,1),r++):r&&(e.splice(a,1),r--)}if(t)for(;r--;r)e.unshift("..");return e}function N(e){var t="/"===e.charAt(0),r="/"===e.substr(-1);return(e=jb(e.split("/").filter((function(e){return!!e})),!t).join("/"))||t||(e="."),e&&r&&(e+="/"),(t?"/":"")+e}function kb(e){var t=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/.exec(e).slice(1);return e=t[0],t=t[1],e||t?(t&&(t=t.substr(0,t.length-1)),e+t):"."}function lb(e){if("/"===e)return"/";var t=e.lastIndexOf("/");return-1===t?e:e.substr(t+1)}function mb(){for(var e="",t=!1,r=arguments.length-1;-1<=r&&!t;r--){if("string"!=typeof(t=0<=r?arguments[r]:"/"))throw new TypeError("Arguments to path.resolve must be strings");if(!t)return"";e=t+"/"+e,t="/"===t.charAt(0)}return(t?"/":"")+(e=jb(e.split("/").filter((function(e){return!!e})),!t).join("/"))||"."}var nb=[];function ob(e,t){nb[e]={input:[],output:[],L:t},pb(e,qb)}var qb={open:function(e){var t=nb[e.g.rdev];if(!t)throw new O(M.ba);e.tty=t,e.seekable=!1},close:function(e){e.tty.L.flush(e.tty)},flush:function(e){e.tty.L.flush(e.tty)},read:function(e,t,r,a){if(!e.tty||!e.tty.L.Ba)throw new O(M.sa);for(var i=0,n=0;n<a;n++){var s;try{s=e.tty.L.Ba(e.tty)}catch(e){throw new O(M.F)}if(void 0===s&&0===i)throw new O(M.oa);if(null==s)break;i++,t[r+n]=s}return i&&(e.g.timestamp=Date.now()),i},write:function(e,t,r,a){if(!e.tty||!e.tty.L.ja)throw new O(M.sa);for(var i=0;i<a;i++)try{e.tty.L.ja(e.tty,t[r+i])}catch(e){throw new O(M.F)}return a&&(e.g.timestamp=Date.now()),i}},rb={Ba:function(e){if(!e.input.length){var t=null;if("undefined"!=typeof window&&"function"==typeof window.prompt?null!==(t=window.prompt("Input: "))&&(t+="\n"):"function"==typeof readline&&(null!==(t=readline())&&(t+="\n")),!t)return null;e.input=Va(t,!0)}return e.input.shift()},ja:function(t,r){null===r||10===r?(e.print(za(t.output,0)),t.output=[]):0!=r&&t.output.push(r)},flush:function(t){t.output&&0<t.output.length&&(e.print(za(t.output,0)),t.output=[])}},sb={ja:function(t,r){null===r||10===r?(e.printErr(za(t.output,0)),t.output=[]):0!=r&&t.output.push(r)},flush:function(t){t.output&&0<t.output.length&&(e.printErr(za(t.output,0)),t.output=[])}},P={q:null,A:function(){return P.createNode(null,"/",16895,0)},createNode:function(e,t,r,a){if(24576==(61440&r)||4096==(61440&r))throw new O(M.G);return P.q||(P.q={dir:{g:{D:P.k.D,p:P.k.p,lookup:P.k.lookup,V:P.k.V,rename:P.k.rename,unlink:P.k.unlink,rmdir:P.k.rmdir,readdir:P.k.readdir,symlink:P.k.symlink},stream:{I:P.n.I}},file:{g:{D:P.k.D,p:P.k.p},stream:{I:P.n.I,read:P.n.read,write:P.n.write,ta:P.n.ta,Ea:P.n.Ea,Ga:P.n.Ga}},link:{g:{D:P.k.D,p:P.k.p,readlink:P.k.readlink},stream:{}},va:{g:{D:P.k.D,p:P.k.p},stream:tb}}),16384==(61440&(r=ub(e,t,r,a)).mode)?(r.k=P.q.dir.g,r.n=P.q.dir.stream,r.e={}):32768==(61440&r.mode)?(r.k=P.q.file.g,r.n=P.q.file.stream,r.o=0,r.e=null):40960==(61440&r.mode)?(r.k=P.q.link.g,r.n=P.q.link.stream):8192==(61440&r.mode)&&(r.k=P.q.va.g,r.n=P.q.va.stream),r.timestamp=Date.now(),e&&(e.e[t]=r),r},Sa:function(e){if(e.e&&e.e.subarray){for(var t=[],r=0;r<e.o;++r)t.push(e.e[r]);return t}return e.e},qd:function(e){return e.e?e.e.subarray?e.e.subarray(0,e.o):new Uint8Array(e.e):new Uint8Array},ya:function(e,t){if(e.e&&e.e.subarray&&t>e.e.length&&(e.e=P.Sa(e),e.o=e.e.length),!e.e||e.e.subarray){var r=e.e?e.e.buffer.byteLength:0;r>=t||(t=Math.max(t,r*(1048576>r?2:1.125)|0),0!=r&&(t=Math.max(t,256)),r=e.e,e.e=new Uint8Array(t),0<e.o&&e.e.set(r.subarray(0,e.o),0))}else for(!e.e&&0<t&&(e.e=[]);e.e.length<t;)e.e.push(0)},ab:function(e,t){if(e.o!=t)if(0==t)e.e=null,e.o=0;else{if(!e.e||e.e.subarray){var r=e.e;e.e=new Uint8Array(new ArrayBuffer(t)),r&&e.e.set(r.subarray(0,Math.min(t,e.o)))}else if(e.e||(e.e=[]),e.e.length>t)e.e.length=t;else for(;e.e.length<t;)e.e.push(0);e.o=t}},k:{D:function(e){var t={};return t.dev=8192==(61440&e.mode)?e.id:1,t.ino=e.id,t.mode=e.mode,t.nlink=1,t.uid=0,t.gid=0,t.rdev=e.rdev,16384==(61440&e.mode)?t.size=4096:32768==(61440&e.mode)?t.size=e.o:40960==(61440&e.mode)?t.size=e.link.length:t.size=0,t.atime=new Date(e.timestamp),t.mtime=new Date(e.timestamp),t.ctime=new Date(e.timestamp),t.Pa=4096,t.blocks=Math.ceil(t.size/t.Pa),t},p:function(e,t){void 0!==t.mode&&(e.mode=t.mode),void 0!==t.timestamp&&(e.timestamp=t.timestamp),void 0!==t.size&&P.ab(e,t.size)},lookup:function(){throw vb[M.B]},V:function(e,t,r,a){return P.createNode(e,t,r,a)},rename:function(e,t,r){if(16384==(61440&e.mode)){var a;try{a=wb(t,r)}catch(e){}if(a)for(var i in a.e)throw new O(M.ra)}delete e.parent.e[e.name],e.name=r,t.e[r]=e,e.parent=t},unlink:function(e,t){delete e.e[t]},rmdir:function(e,t){var r,a=wb(e,t);for(r in a.e)throw new O(M.ra);delete e.e[t]},readdir:function(e){var t,r=[".",".."];for(t in e.e)e.e.hasOwnProperty(t)&&r.push(t);return r},symlink:function(e,t,r){return(e=P.createNode(e,t,41471,0)).link=r,e},readlink:function(e){if(40960!=(61440&e.mode))throw new O(M.u);return e.link}},n:{read:function(e,t,r,a,i){var n=e.g.e;if(i>=e.g.o)return 0;if(assert(0<=(e=Math.min(e.g.o-i,a))),8<e&&n.subarray)t.set(n.subarray(i,i+e),r);else for(a=0;a<e;a++)t[r+a]=n[i+a];return e},write:function(e,t,r,a,i,n){if(!a)return 0;if((e=e.g).timestamp=Date.now(),t.subarray&&(!e.e||e.e.subarray)){if(n)return e.e=t.subarray(r,r+a),e.o=a;if(0===e.o&&0===i)return e.e=new Uint8Array(t.subarray(r,r+a)),e.o=a;if(i+a<=e.o)return e.e.set(t.subarray(r,r+a),i),a}if(P.ya(e,i+a),e.e.subarray&&t.subarray)e.e.set(t.subarray(r,r+a),i);else for(n=0;n<a;n++)e.e[i+n]=t[r+n];return e.o=Math.max(e.o,i+a),a},I:function(e,t,r){if(1===r?t+=e.position:2===r&&32768==(61440&e.g.mode)&&(t+=e.g.o),0>t)throw new O(M.u);return t},ta:function(e,t,r){P.ya(e.g,t+r),e.g.o=Math.max(e.g.o,t+r)},Ea:function(e,t,r,a,i,n,s){if(32768!=(61440&e.g.mode))throw new O(M.ba);if(r=e.g.e,2&s||r.buffer!==t&&r.buffer!==t.buffer){if((0<i||i+a<e.g.o)&&(r=r.subarray?r.subarray(i,i+a):Array.prototype.slice.call(r,i,i+a)),e=!0,!(a=ua(a)))throw new O(M.Ka);t.set(r,a)}else e=!1,a=r.byteOffset;return{Cd:a,gd:e}},Ga:function(e,t,r,a,i){if(32768!=(61440&e.g.mode))throw new O(M.ba);return 2&i||P.n.write(e,t,0,a,r,!1),0}}};G(1,"i32*",2),G(1,"i32*",2),G(1,"i32*",2);var xb=null,yb=[null],zb=[],Ab=1,R=null,Cb=!0,S={},O=null,vb={};function T(e,t){if(t=t||{},!(e=mb("/",e)))return{path:"",g:null};var r,a={za:!0,ka:0};for(r in a)void 0===t[r]&&(t[r]=a[r]);if(8<t.ka)throw new O(M.aa);a=jb(e.split("/").filter((function(e){return!!e})),!1);var i=xb;r="/";for(var n=0;n<a.length;n++){var s=n===a.length-1;if(s&&t.parent)break;if(i=wb(i,a[n]),r=N(r+"/"+a[n]),i.R&&(!s||s&&t.za)&&(i=i.R.root),!s||t.ga)for(s=0;40960==(61440&i.mode);)if(i=Db(r),i=T(r=mb(kb(r),i),{ka:t.ka}).g,40<s++)throw new O(M.aa)}return{path:r,g:i}}function U(e){for(var t;;){if(e===e.parent)return e=e.A.Fa,t?"/"!==e[e.length-1]?e+"/"+t:e+t:e;t=t?e.name+"/"+t:e.name,e=e.parent}}function Eb(e,t){for(var r=0,a=0;a<t.length;a++)r=(r<<5)-r+t.charCodeAt(a)|0;return(e+r>>>0)%R.length}function Fb(e){var t=Eb(e.parent.id,e.name);e.K=R[t],R[t]=e}function wb(e,t){var r;if(r=(r=Gb(e,"x"))?r:e.k.lookup?0:M.Y)throw new O(r,e);for(r=R[Eb(e.id,t)];r;r=r.K){var a=r.name;if(r.parent.id===e.id&&a===t)return r}return e.k.lookup(e,t)}function ub(e,t,r,a){return Hb||((Hb=function(e,t,r,a){e||(e=this),this.parent=e,this.A=e.A,this.R=null,this.id=Ab++,this.name=t,this.mode=r,this.k={},this.n={},this.rdev=a}).prototype={},Object.defineProperties(Hb.prototype,{read:{get:function(){return 365==(365&this.mode)},set:function(e){e?this.mode|=365:this.mode&=-366}},write:{get:function(){return 146==(146&this.mode)},set:function(e){e?this.mode|=146:this.mode&=-147}},Xa:{get:function(){return 16384==(61440&this.mode)}},Ca:{get:function(){return 8192==(61440&this.mode)}}})),Fb(e=new Hb(e,t,r,a)),e}var Ib={r:0,rs:1052672,"r+":2,w:577,wx:705,xw:705,"w+":578,"wx+":706,"xw+":706,a:1089,ax:1217,xa:1217,"a+":1090,"ax+":1218,"xa+":1218};function Gb(e,t){return Cb||(-1===t.indexOf("r")||292&e.mode)&&(-1===t.indexOf("w")||146&e.mode)&&(-1===t.indexOf("x")||73&e.mode)?0:M.Y}function Jb(e,t){try{return wb(e,t),M.pa}catch(e){}return Gb(e,"wx")}function Kb(){for(var e=0;e<=4096;e++)if(!zb[e])return e;throw new O(M.Ja)}function Lb(e){Mb||((Mb=function(){}).prototype={},Object.defineProperties(Mb.prototype,{object:{get:function(){return this.g},set:function(e){this.g=e}},vd:{get:function(){return 1!=(2097155&this.flags)}},wd:{get:function(){return 0!=(2097155&this.flags)}},ud:{get:function(){return 1024&this.flags}}}));var t,r=new Mb;for(t in e)r[t]=e[t];return e=r,r=Kb(),e.fd=r,zb[r]=e}var tb={open:function(e){e.n=yb[e.g.rdev].n,e.n.open&&e.n.open(e)},I:function(){throw new O(M.da)}},Zb;function pb(e,t){yb[e]={n:t}}function Nb(e,t){var r,a="/"===t,i=!t;if(a&&xb)throw new O(M.$);if(!a&&!i){if(t=(r=T(t,{za:!1})).path,(r=r.g).R)throw new O(M.$);if(16384!=(61440&r.mode))throw new O(M.qa)}i={type:e,Ad:{},Fa:t,Ya:[]};var n=e.A(i);n.A=i,i.root=n,a?xb=n:r&&(r.R=i,r.A&&r.A.Ya.push(i))}function Ob(e,t,r){var a=T(e,{parent:!0}).g;if(!(e=lb(e))||"."===e||".."===e)throw new O(M.u);var i=Jb(a,e);if(i)throw new O(i);if(!a.k.V)throw new O(M.G);return a.k.V(a,e,t,r)}function Pb(e,t){return t=4095&(void 0!==t?t:438),Ob(e,t|=32768,0)}function V(e,t){return t=1023&(void 0!==t?t:511),Ob(e,t|=16384,0)}function Qb(e,t,r){return void 0===r&&(r=t,t=438),Ob(e,8192|t,r)}function Rb(e,t){if(!mb(e))throw new O(M.B);var r=T(t,{parent:!0}).g;if(!r)throw new O(M.B);var a=lb(t),i=Jb(r,a);if(i)throw new O(i);if(!r.k.symlink)throw new O(M.G);return r.k.symlink(r,a,e)}function Db(e){if(!(e=T(e).g))throw new O(M.B);if(!e.k.readlink)throw new O(M.u);return mb(U(e.parent),e.k.readlink(e))}function Sb(e,t){var r;if(!(r="string"==typeof e?T(e,{ga:!0}).g:e).k.p)throw new O(M.G);r.k.p(r,{mode:4095&t|-4096&r.mode,timestamp:Date.now()})}function Tb(t,r){var a,i,n;if(""===t)throw new O(M.B);if("string"==typeof r){if(void 0===(i=Ib[r]))throw Error("Unknown file open mode: "+r)}else i=r;if(a=64&(r=i)?4095&(void 0===a?438:a)|32768:0,"object"==typeof t)n=t;else{t=N(t);try{n=T(t,{ga:!(131072&r)}).g}catch(e){}}if(i=!1,64&r)if(n){if(128&r)throw new O(M.pa)}else n=Ob(t,a,0),i=!0;if(!n)throw new O(M.B);if(8192==(61440&n.mode)&&(r&=-513),65536&r&&16384!=(61440&n.mode))throw new O(M.qa);if(!i&&(n?40960==(61440&n.mode)?a=M.aa:16384==(61440&n.mode)&&(0!=(2097155&r)||512&r)?a=M.N:(a=["r","w","rw"][3&r],512&r&&(a+="w"),a=Gb(n,a)):a=M.B,a))throw new O(a);if(512&r){var s;if(!(s="string"==typeof(a=n)?T(a,{ga:!0}).g:a).k.p)throw new O(M.G);if(16384==(61440&s.mode))throw new O(M.N);if(32768!=(61440&s.mode))throw new O(M.u);if(a=Gb(s,"w"))throw new O(a);s.k.p(s,{size:0,timestamp:Date.now()})}r&=-641,(n=Lb({g:n,path:U(n),flags:r,seekable:!0,position:0,n:n.n,eb:[],error:!1})).n.open&&n.n.open(n),!e.logReadFiles||1&r||(Ub||(Ub={}),t in Ub||(Ub[t]=1,e.printErr("read file: "+t)));try{S.onOpenFile&&(s=0,1!=(2097155&r)&&(s|=1),0!=(2097155&r)&&(s|=2),S.onOpenFile(t,s))}catch(e){console.log("FS.trackingDelegate['onOpenFile']('"+t+"', flags) threw an exception: "+e.message)}return n}function Vb(e){e.ia&&(e.ia=null);try{e.n.close&&e.n.close(e)}catch(e){throw e}finally{zb[e.fd]=null}}function Wb(e,t,r){if(!e.seekable||!e.n.I)throw new O(M.da);e.position=e.n.I(e,t,r),e.eb=[]}function Xb(e,t,r,a,i,n){if(0>a||0>i)throw new O(M.u);if(0==(2097155&e.flags))throw new O(M.Z);if(16384==(61440&e.g.mode))throw new O(M.N);if(!e.n.write)throw new O(M.u);1024&e.flags&&Wb(e,0,2);var s=!0;if(void 0===i)i=e.position,s=!1;else if(!e.seekable)throw new O(M.da);t=e.n.write(e,t,r,a,i,n),s||(e.position+=t);try{e.path&&S.onWriteToFile&&S.onWriteToFile(e.path)}catch(e){console.log("FS.trackingDelegate['onWriteToFile']('"+path+"') threw an exception: "+e.message)}return t}function Yb(){O||((O=function(e,t){this.g=t,this.bb=function(e){for(var t in this.Q=e,M)if(M[t]===e){this.code=t;break}},this.bb(e),this.message=hb[e]}).prototype=Error(),O.prototype.constructor=O,[M.B].forEach((function(e){vb[e]=new O(e),vb[e].stack="<generic error, no stack>"})))}function $b(e,t){var r=0;return e&&(r|=365),t&&(r|=146),r}function ac(e,t,r,a){return Pb(e=N(("string"==typeof e?e:U(e))+"/"+t),$b(r,a))}function bc(e,t,r,a,i,n){if(i=Pb(e=t?N(("string"==typeof e?e:U(e))+"/"+t):e,a=$b(a,i)),r){if("string"==typeof r){e=Array(r.length),t=0;for(var s=r.length;t<s;++t)e[t]=r.charCodeAt(t);r=e}Sb(i,146|a),Xb(e=Tb(i,"w"),r,0,r.length,0,n),Vb(e),Sb(i,a)}return i}function W(e,t,r,a){e=N(("string"==typeof e?e:U(e))+"/"+t),t=$b(!!r,!!a),W.Da||(W.Da=64);var i=W.Da++<<8|0;return pb(i,{open:function(e){e.seekable=!1},close:function(){a&&a.buffer&&a.buffer.length&&a(10)},read:function(e,t,a,i){for(var n=0,s=0;s<i;s++){var o;try{o=r()}catch(e){throw new O(M.F)}if(void 0===o&&0===n)throw new O(M.oa);if(null==o)break;n++,t[a+s]=o}return n&&(e.g.timestamp=Date.now()),n},write:function(e,t,r,i){for(var n=0;n<i;n++)try{a(t[r+n])}catch(e){throw new O(M.F)}return i&&(e.g.timestamp=Date.now()),n}}),Qb(e,t,i)}function cc(t){if(t.Ca||t.Xa||t.link||t.e)return!0;var r=!0;if("undefined"!=typeof XMLHttpRequest)throw Error("Lazy loading should have been performed (contents set) in createLazyFile, but it was not. Lazy loading only works in web workers. Use --embed-file or --preload-file in emcc on the main thread.");if(!e.read)throw Error("Cannot load without read() or XMLHttpRequest.");try{t.e=Va(e.read(t.url),!0),t.o=t.e.length}catch(e){r=!1}return r||ib(M.F),r}var dc={},Hb,Mb,Ub,ec=0;function X(){return F[(ec+=4)-4>>2]}function fc(){var e;if(e=X(),!(e=zb[e]))throw new O(M.Z);return e}function wa(e){wa.C||(v=Ga(),wa.C=!0,assert(n.P),wa.Ra=n.P,n.P=function(){z("cannot dynamically allocate, sbrk now has control")});var t=v;return 0==e||wa.Ra(e)?t:4294967295}function hc(e,t){if(ic=e,jc=t,!kc)return 1;if(0==e)Y=function(){setTimeout(lc,t)},mc="timeout";else if(1==e)Y=function(){nc(lc)},mc="rAF";else if(2==e){if(!window.setImmediate){var r=[];window.addEventListener("message",(function(e){e.source===window&&"__emcc"===e.data&&(e.stopPropagation(),r.shift()())}),!0),window.setImmediate=function(e){r.push(e),window.postMessage("__emcc","*")}}Y=function(){window.setImmediate(lc)},mc="immediate"}return 0}function oc(t,r,a,i,s){e.noExitRuntime=!0,assert(!kc,"emscripten_set_main_loop: there can only be one main loop function at once: call emscripten_cancel_main_loop to cancel the previous one before setting a new one with different parameters."),kc=t,pc=i;var o=qc;if(lc=function(){if(!A)if(0<rc.length){var r=Date.now(),a=rc.shift();if(a.Qa(a.T),sc){var s=sc,l=0==s%1?s-1:Math.floor(s);sc=a.ld?l:(8*s+(l+.5))/9}console.log('main loop blocker "'+a.name+'" took '+(Date.now()-r)+" ms"),tc(),setTimeout(lc,0)}else o<qc||(uc=uc+1|0,1==ic&&1<jc&&0!=uc%jc?Y():("timeout"===mc&&e.fa&&(e.S("Looks like you are rendering without using requestAnimationFrame for the main loop. You should use 0 for the frame rate in emscripten_set_main_loop in order to use requestAnimationFrame, as that can greatly improve your frame rates!"),mc=""),vc((function(){void 0!==i?n.J("vi",t,[i]):n.J("v",t)})),o<qc||("object"==typeof SDL&&SDL.audio&&SDL.audio.Za&&SDL.audio.Za(),Y())))},s||(r&&0<r?hc(0,1e3/r):hc(1,1),Y()),a)throw"SimulateInfiniteLoop"}e._memcpy=gc;var Y=null,mc="",qc=0,kc=null,pc=0,ic=0,jc=0,uc=0,rc=[];function tc(){if(e.setStatus){var t=e.statusMessage||"Please wait...",r=sc,a=wc.nd;r?r<a?e.setStatus(t+" ("+(a-r)+"/"+a+")"):e.setStatus(t):e.setStatus("")}}function vc(t){if(!(A||e.preMainLoop&&!1===e.preMainLoop())){try{t()}catch(t){if(t instanceof xc)return;throw t&&"object"==typeof t&&t.stack&&e.S("exception thrown: "+[t,t.stack]),t}e.postMainLoop&&e.postMainLoop()}}var wc={},lc,sc,yc=!1,zc=!1,Ac=[];function Bc(){function t(){zc=document.pointerLockElement===r||document.mozPointerLockElement===r||document.webkitPointerLockElement===r||document.msPointerLockElement===r}if(e.preloadPlugins||(e.preloadPlugins=[]),!Cc){Cc=!0;try{Dc=!0}catch(e){Dc=!1,console.log("warning: no blob constructor, cannot create blobs with mimetypes")}Ec="undefined"!=typeof MozBlobBuilder?MozBlobBuilder:"undefined"!=typeof WebKitBlobBuilder?WebKitBlobBuilder:Dc?null:console.log("warning: no BlobBuilder"),Fc="undefined"!=typeof window?window.URL?window.URL:window.webkitURL:void 0,e.Ha||void 0!==Fc||(console.log("warning: Browser does not support creating object URLs. Built-in browser image decoding will not be available."),e.Ha=!0),e.preloadPlugins.push({canHandle:function(t){return!e.Ha&&/\.(jpg|jpeg|png|bmp)$/i.test(t)},handle:function(t,r,a,i){var s=null;if(Dc)try{(s=new Blob([t],{type:Gc(r)})).size!==t.length&&(s=new Blob([new Uint8Array(t).buffer],{type:Gc(r)}))}catch(e){n.M("Blob constructor present but fails: "+e+"; falling back to blob builder")}s||((s=new Ec).append(new Uint8Array(t).buffer),s=s.getBlob());var o=Fc.createObjectURL(s),l=new Image;l.onload=function(){assert(l.complete,"Image "+r+" could not be decoded");var i=document.createElement("canvas");i.width=l.width,i.height=l.height,i.getContext("2d").drawImage(l,0,0),e.preloadedImages[r]=i,Fc.revokeObjectURL(o),a&&a(t)},l.onerror=function(){console.log("Image "+o+" could not be decoded"),i&&i()},l.src=o}}),e.preloadPlugins.push({canHandle:function(t){return!e.zd&&t.substr(-4)in{".ogg":1,".wav":1,".mp3":1}},handle:function(t,r,a,i){function n(i){o||(o=!0,e.preloadedAudios[r]=i,a&&a(t))}function s(){o||(o=!0,e.preloadedAudios[r]=new Audio,i&&i())}var o=!1;if(!Dc)return s();try{var l=new Blob([t],{type:Gc(r)})}catch(e){return s()}l=Fc.createObjectURL(l);var d=new Audio;d.addEventListener("canplaythrough",(function(){n(d)}),!1),d.onerror=function(){if(!o){console.log("warning: browser could not fully decode audio "+r+", trying slower base64 approach");for(var e="",a=0,i=0,s=0;s<t.length;s++)for(a=a<<8|t[s],i+=8;6<=i;){var l=a>>i-6&63;i=i-6,e=e+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[l]}2==i?(e+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[(3&a)<<4],e+="=="):4==i&&(e+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[(15&a)<<2],e+="="),d.src="data:audio/x-"+r.substr(-3)+";base64,"+e,n(d)}},d.src=l,Hc((function(){n(d)}))}});var r=e.canvas;r&&(r.la=r.requestPointerLock||r.mozRequestPointerLock||r.webkitRequestPointerLock||r.msRequestPointerLock||function(){},r.wa=document.exitPointerLock||document.mozExitPointerLock||document.webkitExitPointerLock||document.msExitPointerLock||function(){},r.wa=r.wa.bind(document),document.addEventListener("pointerlockchange",t,!1),document.addEventListener("mozpointerlockchange",t,!1),document.addEventListener("webkitpointerlockchange",t,!1),document.addEventListener("mspointerlockchange",t,!1),e.elementPointerLock&&r.addEventListener("click",(function(e){!zc&&r.la&&(r.la(),e.preventDefault())}),!1))}}function Ic(t,r,a,i){if(r&&e.fa&&t==e.canvas)return e.fa;var n,s;if(r){if(s={antialias:!1,alpha:!1},i)for(var o in i)s[o]=i[o];(s=GL.createContext(t,s))&&(n=GL.getContext(s).cd),t.style.backgroundColor="black"}else n=t.getContext("2d");return n?(a&&(r||assert("undefined"==typeof GLctx,"cannot set in module if GLctx is used, but we are a non-GL context that would replace it"),e.fa=n,r&&GL.yd(s),e.Dd=r,Ac.forEach((function(e){e()})),Bc()),n):null}var Jc=!1,Kc=void 0,Lc=void 0;function Mc(t,r,a){function i(){yc=!1;var t=n.parentNode;(document.webkitFullScreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.mozFullscreenElement||document.fullScreenElement||document.fullscreenElement||document.msFullScreenElement||document.msFullscreenElement||document.webkitCurrentFullScreenElement)===t?(n.ua=document.cancelFullScreen||document.mozCancelFullScreen||document.webkitCancelFullScreen||document.msExitFullscreen||document.exitFullscreen||function(){},n.ua=n.ua.bind(document),Kc&&n.la(),yc=!0,Lc&&Nc()):(t.parentNode.insertBefore(n,t),t.parentNode.removeChild(t),Lc&&Oc()),e.onFullScreen&&e.onFullScreen(yc),Pc(n)}void 0===(Kc=t)&&(Kc=!0),void 0===(Lc=r)&&(Lc=!1),void 0===(Qc=a)&&(Qc=null);var n=e.canvas;Jc||(Jc=!0,document.addEventListener("fullscreenchange",i,!1),document.addEventListener("mozfullscreenchange",i,!1),document.addEventListener("webkitfullscreenchange",i,!1),document.addEventListener("MSFullscreenChange",i,!1));var s=document.createElement("div");n.parentNode.insertBefore(s,n),s.appendChild(n),s.C=s.requestFullScreen||s.mozRequestFullScreen||s.msRequestFullscreen||(s.webkitRequestFullScreen?function(){s.webkitRequestFullScreen(Element.ALLOW_KEYBOARD_INPUT)}:null),a?s.C({Ed:a}):s.C()}var Rc=0;function Sc(e){var t=Date.now();if(0===Rc)Rc=t+1e3/60;else for(;t+2>=Rc;)Rc+=1e3/60;t=Math.max(Rc-t,0),setTimeout(e,t)}function nc(e){"undefined"==typeof window?Sc(e):(window.requestAnimationFrame||(window.requestAnimationFrame=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame||window.oRequestAnimationFrame||Sc),window.requestAnimationFrame(e))}function Hc(t){e.noExitRuntime=!0,setTimeout((function(){A||t()}),1e4)}function Gc(e){return{jpg:"image/jpeg",jpeg:"image/jpeg",png:"image/png",bmp:"image/bmp",ogg:"audio/ogg",wav:"audio/wav",mp3:"audio/mpeg"}[e.substr(e.lastIndexOf(".")+1)]}function Tc(e,t,r){var a=new XMLHttpRequest;a.open("GET",e,!0),a.responseType="arraybuffer",a.onload=function(){200==a.status||0==a.status&&a.response?t(a.response):r()},a.onerror=r,a.send(null)}function Uc(e,t,r){Tc(e,(function(r){assert(r,'Loading data file "'+e+'" failed (no arrayBuffer).'),t(new Uint8Array(r)),Za()}),(function(){if(!r)throw'Loading data file "'+e+'" failed.';r()})),Ya()}var Vc=[],Cc,Dc,Ec,Fc,Qc;function Wc(){var t=e.canvas;Vc.forEach((function(e){e(t.width,t.height)}))}function Nc(){if("undefined"!=typeof SDL){var e=Ia[SDL.screen+0*n.H>>2];F[SDL.screen+0*n.H>>2]=8388608|e}Wc()}function Oc(){if("undefined"!=typeof SDL){var e=Ia[SDL.screen+0*n.H>>2];F[SDL.screen+0*n.H>>2]=-8388609&e}Wc()}function Pc(t,r,a){r&&a?(t.fb=r,t.Va=a):(r=t.fb,a=t.Va);var i=r,n=a;if(e.forcedAspectRatio&&0<e.forcedAspectRatio&&(i/n<e.forcedAspectRatio?i=Math.round(n*e.forcedAspectRatio):n=Math.round(i/e.forcedAspectRatio)),(document.webkitFullScreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.mozFullscreenElement||document.fullScreenElement||document.fullscreenElement||document.msFullScreenElement||document.msFullscreenElement||document.webkitCurrentFullScreenElement)===t.parentNode&&"undefined"!=typeof screen){var s=Math.min(screen.width/i,screen.height/n);i=Math.round(i*s),n=Math.round(n*s)}Lc?(t.width!=i&&(t.width=i),t.height!=n&&(t.height=n),void 0!==t.style&&(t.style.removeProperty("width"),t.style.removeProperty("height"))):(t.width!=r&&(t.width=r),t.height!=a&&(t.height=a),void 0!==t.style&&(i!=r||n!=a?(t.style.setProperty("width",i+"px","important"),t.style.setProperty("height",n+"px","important")):(t.style.removeProperty("width"),t.style.removeProperty("height"))))}Yb(),R=Array(4096),Nb(P,"/"),V("/tmp"),V("/home"),V("/home/web_user"),function(){var e;if(V("/dev"),pb(259,{read:function(){return 0},write:function(e,t,r,a){return a}}),Qb("/dev/null",259),ob(1280,rb),ob(1536,sb),Qb("/dev/tty",1280),Qb("/dev/tty1",1536),"undefined"!=typeof crypto){var t=new Uint8Array(1);e=function(){return crypto.getRandomValues(t),t[0]}}else e=function(){return 256*Math.random()|0};W("/dev","random",e),W("/dev","urandom",e),V("/dev/shm"),V("/dev/shm/tmp")}(),V("/proc"),V("/proc/self"),V("/proc/self/fd"),Nb({A:function(){var e=ub("/proc/self","fd",16895,73);return e.k={lookup:function(e,t){var r=zb[+t];if(!r)throw new O(M.Z);var a={parent:null,A:{Fa:"fake"},k:{readlink:function(){return r.path}}};return a.parent=a}},e}},"/proc/self/fd"),Qa.unshift((function(){if(!e.noFSInit&&!Zb){assert(!Zb,"FS.init was previously called. If you want to initialize later with custom parameters, remove any earlier calls (note that one is automatically added to the generated code)"),Zb=!0,Yb(),e.stdin=e.stdin,e.stdout=e.stdout,e.stderr=e.stderr,e.stdin?W("/dev","stdin",e.stdin):Rb("/dev/tty","/dev/stdin"),e.stdout?W("/dev","stdout",null,e.stdout):Rb("/dev/tty","/dev/stdout"),e.stderr?W("/dev","stderr",null,e.stderr):Rb("/dev/tty1","/dev/stderr");var t=Tb("/dev/stdin","r");assert(0===t.fd,"invalid handle for stdin ("+t.fd+")"),assert(1===(t=Tb("/dev/stdout","w")).fd,"invalid handle for stdout ("+t.fd+")"),assert(2===(t=Tb("/dev/stderr","w")).fd,"invalid handle for stderr ("+t.fd+")")}})),Ra.push((function(){Cb=!1})),K.push((function(){Zb=!1;var t=e._fflush;for(t&&t(0),t=0;t<zb.length;t++){var r=zb[t];r&&Vb(r)}})),e.FS_createFolder=function(e,t,r,a){return V(e=N(("string"==typeof e?e:U(e))+"/"+t),$b(r,a))},e.FS_createPath=function(e,t){e="string"==typeof e?e:U(e);for(var r=t.split("/").reverse();r.length;){var a=r.pop();if(a){var i=N(e+"/"+a);try{V(i)}catch(e){}e=i}}return i},e.FS_createDataFile=bc,e.FS_createPreloadedFile=function(t,r,a,i,n,s,o,l,d,u){function c(a){function c(e){u&&u(),l||bc(t,r,e,i,n,d),s&&s(),Za()}var h=!1;e.preloadPlugins.forEach((function(e){!h&&e.canHandle(p)&&(e.handle(a,p,c,(function(){o&&o(),Za()})),h=!0)})),h||c(a)}Bc();var p=r?mb(N(t+"/"+r)):t;Ya(),"string"==typeof a?Uc(a,(function(e){c(e)}),o):c(a)},e.FS_createLazyFile=function(e,t,r,a,i){if("undefined"!=typeof XMLHttpRequest)throw"Cannot do synchronous binary XHRs outside webworkers in modern browsers. Use --embed-file or --preload-file in emcc";r={Ca:!1,url:r};var n=ac(e,t,a,i);r.e?n.e=r.e:r.url&&(n.e=null,n.url=r.url),Object.defineProperty(n,"usedBytes",{get:function(){return this.e.length}});var s={};return Object.keys(n.n).forEach((function(e){var t=n.n[e];s[e]=function(){if(!cc(n))throw new O(M.F);return t.apply(null,arguments)}})),s.read=function(e,t,r,a,i){if(!cc(n))throw new O(M.F);if(i>=(e=e.g.e).length)return 0;if(assert(0<=(a=Math.min(e.length-i,a))),e.slice)for(var s=0;s<a;s++)t[r+s]=e[i+s];else for(s=0;s<a;s++)t[r+s]=e.get(i+s);return a},n.n=s,n},e.FS_createLink=function(e,t,r){return Rb(r,e=N(("string"==typeof e?e:U(e))+"/"+t))},e.FS_createDevice=W,e.FS_unlink=function(e){var t,r=T(e,{parent:!0}).g,a=lb(e),i=wb(r,a);e:{try{t=wb(r,a)}catch(e){t=e.Q;break e}var n=Gb(r,"wx");t=n||(16384==(61440&t.mode)?M.N:0)}if(t)throw t===M.N&&(t=M.G),new O(t);if(!r.k.unlink)throw new O(M.G);if(i.R)throw new O(M.$);try{S.willDeletePath&&S.willDeletePath(e)}catch(t){console.log("FS.trackingDelegate['willDeletePath']('"+e+"') threw an exception: "+t.message)}if(r.k.unlink(r,a),r=Eb(i.parent.id,i.name),R[r]===i)R[r]=i.K;else for(r=R[r];r;){if(r.K===i){r.K=i.K;break}r=r.K}try{S.onDeletePath&&S.onDeletePath(e)}catch(t){console.log("FS.trackingDelegate['onDeletePath']('"+e+"') threw an exception: "+t.message)}},Qa.unshift((function(){})),K.push((function(){})),e.requestFullScreen=function(e,t,r){Mc(e,t,r)},e.requestAnimationFrame=function(e){nc(e)},e.setCanvasSize=function(t,r,a){Pc(e.canvas,t,r),a||Wc()},e.pauseMainLoop=function(){Y=null,qc++},e.resumeMainLoop=function(){qc++;var e=ic,t=jc,r=kc;kc=null,oc(r,0,!1,pc,!0),hc(e,t),Y()},e.getUserMedia=function(){window.C||(window.C=navigator.getUserMedia||navigator.mozGetUserMedia),window.C(void 0)},e.createContext=function(e,t,r,a){return Ic(e,t,r,a)},Ka=m=n.ea(p),va=!0,La=Ka+Na,Ma=v=n.ea(La),assert(Ma<w,"TOTAL_MEMORY not big enough for stack");var Xc=G([8,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,5,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,6,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,5,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,7,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,5,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,6,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,5,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0],"i8",3);e.Na={Math,Int8Array,Int16Array,Int32Array,Uint8Array,Uint16Array,Uint32Array,Float32Array,Float64Array,NaN:NaN,Infinity:1/0},e.Oa={abort:z,assert,invoke_ii:function(t,r){try{return e.dynCall_ii(t,r)}catch(e){if("number"!=typeof e&&"longjmp"!==e)throw e;Z.setThrew(1,0)}},invoke_iiii:function(t,r,a,i){try{return e.dynCall_iiii(t,r,a,i)}catch(e){if("number"!=typeof e&&"longjmp"!==e)throw e;Z.setThrew(1,0)}},invoke_vi:function(t,r){try{e.dynCall_vi(t,r)}catch(e){if("number"!=typeof e&&"longjmp"!==e)throw e;Z.setThrew(1,0)}},_pthread_cleanup_pop:function(){assert(eb.level==K.length,"cannot pop if something else added meanwhile!"),K.pop(),eb.level=K.length},___lock:function(){},_emscripten_set_main_loop:oc,_pthread_self:function(){return 0},___syscall6:function(e,t){ec=t;try{return Vb(fc()),0}catch(e){return void 0!==dc&&e instanceof O||z(e),-e.Q}},_emscripten_set_main_loop_timing:hc,_abort:function(){e.abort()},_sbrk:wa,_time:function(e){var t=Date.now()/1e3|0;return e&&(F[e>>2]=t),t},___setErrNo:ib,_emscripten_memcpy_big:function(e,t,r){return H.set(H.subarray(t,t+r),e),e},___syscall54:function(e,t){ec=t;try{var r=fc(),a=X();switch(a){case 21505:case 21506:return r.tty?0:-M.O;case 21519:if(!r.tty)return-M.O;var i=X();return F[i>>2]=0;case 21520:return r.tty?-M.u:-M.O;case 21531:if(i=X(),!r.n.Wa)throw new O(M.O);return r.n.Wa(r,a,i);default:z("bad ioctl syscall "+a)}}catch(e){return void 0!==dc&&e instanceof O||z(e),-e.Q}},___unlock:function(){},___syscall140:function(e,t){ec=t;try{var r=fc(),a=X(),i=X(),n=X(),s=X();return assert(0===a),Wb(r,i,s),F[n>>2]=r.position,r.ia&&0===i&&0===s&&(r.ia=null),0}catch(e){return void 0!==dc&&e instanceof O||z(e),-e.Q}},_pthread_cleanup_push:eb,_sysconf:function(e){switch(e){case 30:return 4096;case 85:return I/4096;case 132:case 133:case 12:case 137:case 138:case 15:case 235:case 16:case 17:case 18:case 19:case 20:case 149:case 13:case 10:case 236:case 153:case 9:case 21:case 22:case 159:case 154:case 14:case 77:case 78:case 139:case 80:case 81:case 82:case 68:case 67:case 164:case 11:case 29:case 47:case 48:case 95:case 52:case 51:case 46:return 200809;case 79:return 0;case 27:case 246:case 127:case 128:case 23:case 24:case 160:case 161:case 181:case 182:case 242:case 183:case 184:case 243:case 244:case 245:case 165:case 178:case 179:case 49:case 50:case 168:case 169:case 175:case 170:case 171:case 172:case 97:case 76:case 32:case 173:case 35:return-1;case 176:case 177:case 7:case 155:case 8:case 157:case 125:case 126:case 92:case 93:case 129:case 130:case 131:case 94:case 91:return 1;case 74:case 60:case 69:case 70:case 4:return 1024;case 31:case 42:case 72:return 32;case 87:case 26:case 33:return 2147483647;case 34:case 1:return 47839;case 38:case 36:return 99;case 43:case 37:return 2048;case 0:return 2097152;case 3:return 65536;case 28:return 32768;case 44:return 32767;case 75:return 16384;case 39:return 1e3;case 89:return 700;case 71:return 256;case 40:return 255;case 2:return 100;case 180:return 64;case 25:return 20;case 5:return 16;case 6:return 6;case 73:return 4;case 84:return"object"==typeof navigator&&navigator.hardwareConcurrency||1}return ib(M.u),-1},___syscall146:function(e,t){ec=t;try{var r,a=fc(),i=X();e:{for(var n=X(),s=0,o=0;o<n;o++){var l=Xb(a,D,F[i+8*o>>2],F[i+(8*o+4)>>2],void 0);if(0>l){r=-1;break e}s+=l}r=s}return r}catch(e){return void 0!==dc&&e instanceof O||z(e),-e.Q}},STACKTOP:m,STACK_MAX:La,tempDoublePtr:$a,ABORT:A,cttz_i8:Xc};var Z=function(e,t,r){var a=new e.Int8Array(r),i=(new e.Int16Array(r),new e.Int32Array(r)),n=new e.Uint8Array(r),s=(new e.Uint16Array(r),new e.Uint32Array(r),new e.Float32Array(r),new e.Float64Array(r),0|t.STACKTOP),o=(t.STACK_MAX,t.tempDoublePtr,t.ABORT,t.cttz_i8,0),l=(e.NaN,e.Infinity,0),d=(e.Math.floor,e.Math.abs,e.Math.sqrt,e.Math.pow,e.Math.cos,e.Math.sin,e.Math.tan,e.Math.acos,e.Math.asin,e.Math.atan,e.Math.atan2,e.Math.exp,e.Math.log,e.Math.ceil,e.Math.imul),u=(e.Math.min,e.Math.clz32,t.abort),c=(t.assert,t.invoke_ii,t.invoke_iiii,t.invoke_vi,t._pthread_cleanup_pop),p=t.___lock,h=(t._emscripten_set_main_loop,t._pthread_self),f=t.___syscall6,_=(t._emscripten_set_main_loop_timing,t._abort),m=t._sbrk,g=t._time,v=(t.___setErrNo,t._emscripten_memcpy_big),E=t.___syscall54,y=t.___unlock,S=t.___syscall140,T=t._pthread_cleanup_push,A=t._sysconf,b=t.___syscall146;function C(e,t,r){e|=0;var a,n=0,o=0,d=0,u=0,c=0,p=0,h=0,f=0,_=0,m=0,g=0;a=s,s=s+160|0,P(n=a,t|=0,r|=0),t=0|i[(r=n+144|0)>>2],o=0|i[r+4>>2],u=0|i[(d=r=n+64|0)>>2],c=0|i[d+4>>2],d=0|B(0|t,0|o,18,0),p=l,h=0|U(0|u,0|c,0|t,0|o),o=0|U(0|h,0|l,0|d,0|p),i[(p=r)>>2]=o,i[p+4>>2]=l,o=0|i[(p=n+136|0)>>2],r=0|i[p+4>>2],h=0|i[(d=p=n+56|0)>>2],t=0|i[d+4>>2],d=0|B(0|o,0|r,18,0),c=l,u=0|U(0|h,0|t,0|o,0|r),r=0|U(0|u,0|l,0|d,0|c),i[(c=p)>>2]=r,i[c+4>>2]=l,r=0|i[(c=n+128|0)>>2],p=0|i[c+4>>2],u=0|i[(d=c=n+48|0)>>2],o=0|i[d+4>>2],d=0|B(0|r,0|p,18,0),t=l,h=0|U(0|u,0|o,0|r,0|p),p=0|U(0|h,0|l,0|d,0|t),i[(t=c)>>2]=p,i[t+4>>2]=l,p=0|i[(t=n+120|0)>>2],c=0|i[t+4>>2],h=0|i[(d=t=n+40|0)>>2],r=0|i[d+4>>2],d=0|B(0|p,0|c,18,0),o=l,u=0|U(0|h,0|r,0|p,0|c),c=0|U(0|u,0|l,0|d,0|o),i[(o=t)>>2]=c,i[o+4>>2]=l,c=0|i[(o=n+112|0)>>2],t=0|i[o+4>>2],u=0|i[(d=o=n+32|0)>>2],p=0|i[d+4>>2],d=0|B(0|c,0|t,18,0),r=l,h=0|U(0|u,0|p,0|c,0|t),t=0|U(0|h,0|l,0|d,0|r),i[(r=o)>>2]=t,i[r+4>>2]=l,t=0|i[(r=n+104|0)>>2],o=0|i[r+4>>2],h=0|i[(d=r=n+24|0)>>2],c=0|i[d+4>>2],d=0|B(0|t,0|o,18,0),p=l,u=0|U(0|h,0|c,0|t,0|o),o=0|U(0|u,0|l,0|d,0|p),i[(p=r)>>2]=o,i[p+4>>2]=l,o=0|i[(p=n+96|0)>>2],r=0|i[p+4>>2],u=0|i[(d=p=n+16|0)>>2],t=0|i[d+4>>2],d=0|B(0|o,0|r,18,0),c=l,h=0|U(0|u,0|t,0|o,0|r),r=0|U(0|h,0|l,0|d,0|c),i[(c=p)>>2]=r,i[c+4>>2]=l,r=0|i[(c=n+88|0)>>2],p=0|i[c+4>>2],h=0|i[(d=c=n+8|0)>>2],o=0|i[d+4>>2],d=0|B(0|r,0|p,18,0),t=l,u=0|U(0|h,0|o,0|r,0|p),p=0|U(0|u,0|l,0|d,0|t),i[(t=c)>>2]=p,i[t+4>>2]=l,d=0|i[(p=t=n+80|0)>>2],u=0|i[p+4>>2],r=0|i[(p=n)>>2],o=0|i[p+4>>2],p=0|B(0|d,0|u,18,0),h=l,f=0|U(0|r,0|o,0|d,0|u),u=0|U(0|f,0|l,0|p,0|h),h=l,i[(p=n)>>2]=u,i[p+4>>2]=h,i[(p=t)>>2]=0,i[p+4>>2]=0,p=h,h=u,u=0;do{r=0|k(0|h,0|p,0|(o=0|x(0|(d=0|L(0|(f=0|U(p>>31>>>6|0,0,0|h,0|p)),0|l,26)),0|(f=l),26)),0|l),i[(o=n+(u<<3)|0)>>2]=r,i[o+4>>2]=l,g=0|k(0|(_=0|U(0|d,0|f,0|i[(r=o=n+((1|u)<<3)|0)>>2],0|i[r+4>>2])),0|(r=l),0|(m=0|x(0|(d=0|L(0|(f=0|U(r>>31>>>7|0,0,0|_,0|r)),0|l,25)),0|(f=l),25)),0|l),i[(m=o)>>2]=g,i[m+4>>2]=l,h=0|U(0|d,0|f,0|i[(g=m=n+((u=u+2|0)<<3)|0)>>2],0|i[g+4>>2]),p=l,i[(g=m)>>2]=h,i[g+4>>2]=p}while(u>>>0<10);p=0|i[(u=t)>>2],h=0|i[u+4>>2],g=0|i[(u=n)>>2],m=0|i[u+4>>2],u=0|B(0|p,0|h,18,0),f=l,d=0|U(0|g,0|m,0|p,0|h),h=0|U(0|d,0|l,0|u,0|f),f=l,i[(u=t)>>2]=0,i[u+4>>2]=0,p=0|k(0|h,0|f,0|(d=0|x(0|(t=0|L(0|(u=0|U(f>>31>>>6|0,0,0|h,0|f)),0|l,26)),0|(u=l),26)),0|l),i[(d=n)>>2]=p,i[d+4>>2]=l,p=0|U(0|t,0|u,0|i[(d=c)>>2],0|i[d+4>>2]),i[(d=c)>>2]=p,i[d+4>>2]=l,d=e,e=n,n=d+80|0;do{i[d>>2]=i[e>>2],d=d+4|0,e=e+4|0}while((0|d)<(0|n));s=a}function P(e,t,r){e|=0,r|=0;var a=0,n=0,s=0,o=0,d=0,u=0,c=0,p=0,h=0,f=0,_=0,m=0,g=0,v=0,E=0,y=0,S=0,T=0,A=0,b=0,C=0,P=0,O=0;a=0|L(0,0|i[(t|=0)>>2],32),n=l,o=0|B(0|(s=0|L(0,0|i[r>>2],32)),0|l,0|a,0|n),i[(n=e)>>2]=o,i[n+4>>2]=l,n=0|L(0,0|i[t>>2],32),o=l,d=0|B(0|(s=0|L(0,0|i[(a=r+8|0)>>2],32)),0|l,0|n,0|o),o=l,s=0|L(0,0|i[(n=t+8|0)>>2],32),u=l,u=0|U(0|(p=0|B(0|(c=0|L(0,0|i[r>>2],32)),0|l,0|s,0|u)),0|l,0|d,0|o),i[(o=e+8|0)>>2]=u,i[o+4>>2]=l,o=0|L(0,0|i[n>>2],31),u=l,p=0|B(0|(d=0|L(0,0|i[a>>2],32)),0|l,0|o,0|u),u=l,o=0|L(0,0|i[t>>2],32),d=l,d=0|U(0|(h=0|B(0|(c=0|L(0,0|i[(s=r+16|0)>>2],32)),0|l,0|o,0|d)),0|l,0|p,0|u),u=l,h=0|L(0,0|i[(p=t+16|0)>>2],32),o=l,o=0|U(0|d,0|u,0|(f=0|B(0|(c=0|L(0,0|i[r>>2],32)),0|l,0|h,0|o)),0|l),i[(f=e+16|0)>>2]=o,i[f+4>>2]=l,f=0|L(0,0|i[n>>2],32),o=l,d=0|B(0|(u=0|L(0,0|i[s>>2],32)),0|l,0|f,0|o),o=l,f=0|L(0,0|i[p>>2],32),u=l,u=0|U(0|(c=0|B(0|(h=0|L(0,0|i[a>>2],32)),0|l,0|f,0|u)),0|l,0|d,0|o),o=l,d=0|L(0,0|i[t>>2],32),c=l,c=0|U(0|u,0|o,0|(_=0|B(0|(h=0|L(0,0|i[(f=r+24|0)>>2],32)),0|l,0|d,0|c)),0|l),_=l,u=0|L(0,0|i[(o=t+24|0)>>2],32),d=l,d=0|U(0|c,0|_,0|(m=0|B(0|(h=0|L(0,0|i[r>>2],32)),0|l,0|u,0|d)),0|l),i[(m=e+24|0)>>2]=d,i[m+4>>2]=l,m=0|L(0,0|i[p>>2],32),d=l,c=0|B(0|(_=0|L(0,0|i[s>>2],32)),0|l,0|m,0|d),d=l,m=0|L(0,0|i[n>>2],32),_=l,h=0|B(0|(u=0|L(0,0|i[f>>2],32)),0|l,0|m,0|_),_=l,m=0|L(0,0|i[o>>2],32),u=l,u=0|U(0|(v=0|B(0|(g=0|L(0,0|i[a>>2],32)),0|l,0|m,0|u)),0|l,0|h,0|_),u=0|U(0|(_=0|x(0|u,0|l,1)),0|l,0|c,0|d),d=l,c=0|L(0,0|i[t>>2],32),_=l,_=0|U(0|u,0|d,0|(m=0|B(0|(v=0|L(0,0|i[(h=r+32|0)>>2],32)),0|l,0|c,0|_)),0|l),m=l,u=0|L(0,0|i[(d=t+32|0)>>2],32),c=l,c=0|U(0|_,0|m,0|(g=0|B(0|(v=0|L(0,0|i[r>>2],32)),0|l,0|u,0|c)),0|l),i[(g=e+32|0)>>2]=c,i[g+4>>2]=l,g=0|L(0,0|i[p>>2],32),c=l,_=0|B(0|(m=0|L(0,0|i[f>>2],32)),0|l,0|g,0|c),c=l,g=0|L(0,0|i[o>>2],32),m=l,m=0|U(0|(v=0|B(0|(u=0|L(0,0|i[s>>2],32)),0|l,0|g,0|m)),0|l,0|_,0|c),c=l,_=0|L(0,0|i[n>>2],32),v=l,v=0|U(0|m,0|c,0|(u=0|B(0|(g=0|L(0,0|i[h>>2],32)),0|l,0|_,0|v)),0|l),u=l,c=0|L(0,0|i[d>>2],32),m=l,m=0|U(0|v,0|u,0|(g=0|B(0|(_=0|L(0,0|i[a>>2],32)),0|l,0|c,0|m)),0|l),g=l,u=0|L(0,0|i[t>>2],32),v=l,v=0|U(0|m,0|g,0|(E=0|B(0|(_=0|L(0,0|i[(c=r+40|0)>>2],32)),0|l,0|u,0|v)),0|l),E=l,m=0|L(0,0|i[(g=t+40|0)>>2],32),u=l,u=0|U(0|v,0|E,0|(y=0|B(0|(_=0|L(0,0|i[r>>2],32)),0|l,0|m,0|u)),0|l),i[(y=e+40|0)>>2]=u,i[y+4>>2]=l,y=0|L(0,0|i[o>>2],32),u=l,v=0|B(0|(E=0|L(0,0|i[f>>2],32)),0|l,0|y,0|u),u=l,y=0|L(0,0|i[n>>2],32),E=l,E=0|U(0|(_=0|B(0|(m=0|L(0,0|i[c>>2],32)),0|l,0|y,0|E)),0|l,0|v,0|u),u=l,v=0|L(0,0|i[g>>2],32),_=l,m=0|x(0|(_=0|U(0|E,0|u,0|(m=0|B(0|(y=0|L(0,0|i[a>>2],32)),0|l,0|v,0|_)),0|l)),0|l,1),_=l,u=0|L(0,0|i[p>>2],32),E=l,E=0|U(0|m,0|_,0|(y=0|B(0|(v=0|L(0,0|i[h>>2],32)),0|l,0|u,0|E)),0|l),y=l,_=0|L(0,0|i[d>>2],32),m=l,m=0|U(0|E,0|y,0|(v=0|B(0|(u=0|L(0,0|i[s>>2],32)),0|l,0|_,0|m)),0|l),v=l,y=0|L(0,0|i[t>>2],32),E=l,E=0|U(0|m,0|v,0|(S=0|B(0|(u=0|L(0,0|i[(_=r+48|0)>>2],32)),0|l,0|y,0|E)),0|l),S=l,m=0|L(0,0|i[(v=t+48|0)>>2],32),y=l,y=0|U(0|E,0|S,0|(T=0|B(0|(u=0|L(0,0|i[r>>2],32)),0|l,0|m,0|y)),0|l),i[(T=e+48|0)>>2]=y,i[T+4>>2]=l,T=0|L(0,0|i[o>>2],32),y=l,E=0|B(0|(S=0|L(0,0|i[h>>2],32)),0|l,0|T,0|y),y=l,T=0|L(0,0|i[d>>2],32),S=l,S=0|U(0|(u=0|B(0|(m=0|L(0,0|i[f>>2],32)),0|l,0|T,0|S)),0|l,0|E,0|y),y=l,E=0|L(0,0|i[p>>2],32),u=l,u=0|U(0|S,0|y,0|(m=0|B(0|(T=0|L(0,0|i[c>>2],32)),0|l,0|E,0|u)),0|l),m=l,y=0|L(0,0|i[g>>2],32),S=l,S=0|U(0|u,0|m,0|(T=0|B(0|(E=0|L(0,0|i[s>>2],32)),0|l,0|y,0|S)),0|l),T=l,m=0|L(0,0|i[n>>2],32),u=l,u=0|U(0|S,0|T,0|(E=0|B(0|(y=0|L(0,0|i[_>>2],32)),0|l,0|m,0|u)),0|l),E=l,T=0|L(0,0|i[v>>2],32),S=l,S=0|U(0|u,0|E,0|(y=0|B(0|(m=0|L(0,0|i[a>>2],32)),0|l,0|T,0|S)),0|l),y=l,E=0|L(0,0|i[t>>2],32),u=l,u=0|U(0|S,0|y,0|(A=0|B(0|(m=0|L(0,0|i[(T=r+56|0)>>2],32)),0|l,0|E,0|u)),0|l),A=l,S=0|L(0,0|i[(y=t+56|0)>>2],32),E=l,E=0|U(0|u,0|A,0|(b=0|B(0|(m=0|L(0,0|i[r>>2],32)),0|l,0|S,0|E)),0|l),i[(b=e+56|0)>>2]=E,i[b+4>>2]=l,b=0|L(0,0|i[d>>2],32),E=l,u=0|B(0|(A=0|L(0,0|i[h>>2],32)),0|l,0|b,0|E),E=l,b=0|L(0,0|i[o>>2],32),A=l,m=0|B(0|(S=0|L(0,0|i[c>>2],32)),0|l,0|b,0|A),A=l,b=0|L(0,0|i[g>>2],32),S=l,S=0|U(0|(P=0|B(0|(C=0|L(0,0|i[f>>2],32)),0|l,0|b,0|S)),0|l,0|m,0|A),A=l,m=0|L(0,0|i[n>>2],32),P=l,P=0|U(0|S,0|A,0|(C=0|B(0|(b=0|L(0,0|i[T>>2],32)),0|l,0|m,0|P)),0|l),C=l,A=0|L(0,0|i[y>>2],32),S=l,S=0|U(0|P,0|C,0|(b=0|B(0|(m=0|L(0,0|i[a>>2],32)),0|l,0|A,0|S)),0|l),S=0|U(0|(b=0|x(0|S,0|l,1)),0|l,0|u,0|E),E=l,u=0|L(0,0|i[p>>2],32),b=l,b=0|U(0|S,0|E,0|(P=0|B(0|(C=0|L(0,0|i[_>>2],32)),0|l,0|u,0|b)),0|l),P=l,E=0|L(0,0|i[v>>2],32),S=l,S=0|U(0|b,0|P,0|(C=0|B(0|(u=0|L(0,0|i[s>>2],32)),0|l,0|E,0|S)),0|l),C=l,P=0|L(0,0|i[t>>2],32),b=l,b=0|U(0|S,0|C,0|(A=0|B(0|(u=0|L(0,0|i[(E=r+64|0)>>2],32)),0|l,0|P,0|b)),0|l),A=l,S=0|L(0,0|i[(C=t+64|0)>>2],32),P=l,P=0|U(0|b,0|A,0|(m=0|B(0|(u=0|L(0,0|i[r>>2],32)),0|l,0|S,0|P)),0|l),i[(m=e+64|0)>>2]=P,i[m+4>>2]=l,m=0|L(0,0|i[d>>2],32),P=l,b=0|B(0|(A=0|L(0,0|i[c>>2],32)),0|l,0|m,0|P),P=l,m=0|L(0,0|i[g>>2],32),A=l,A=0|U(0|(u=0|B(0|(S=0|L(0,0|i[h>>2],32)),0|l,0|m,0|A)),0|l,0|b,0|P),P=l,b=0|L(0,0|i[o>>2],32),u=l,u=0|U(0|A,0|P,0|(S=0|B(0|(m=0|L(0,0|i[_>>2],32)),0|l,0|b,0|u)),0|l),S=l,P=0|L(0,0|i[v>>2],32),A=l,A=0|U(0|u,0|S,0|(m=0|B(0|(b=0|L(0,0|i[f>>2],32)),0|l,0|P,0|A)),0|l),m=l,S=0|L(0,0|i[p>>2],32),u=l,u=0|U(0|A,0|m,0|(b=0|B(0|(P=0|L(0,0|i[T>>2],32)),0|l,0|S,0|u)),0|l),b=l,m=0|L(0,0|i[y>>2],32),A=l,A=0|U(0|u,0|b,0|(P=0|B(0|(S=0|L(0,0|i[s>>2],32)),0|l,0|m,0|A)),0|l),P=l,b=0|L(0,0|i[n>>2],32),u=l,u=0|U(0|A,0|P,0|(S=0|B(0|(m=0|L(0,0|i[E>>2],32)),0|l,0|b,0|u)),0|l),S=l,P=0|L(0,0|i[C>>2],32),A=l,A=0|U(0|u,0|S,0|(m=0|B(0|(b=0|L(0,0|i[a>>2],32)),0|l,0|P,0|A)),0|l),m=l,S=0|L(0,0|i[t>>2],32),u=l,u=0|U(0|A,0|m,0|(O=0|B(0|(b=0|L(0,0|i[(P=r+72|0)>>2],32)),0|l,0|S,0|u)),0|l),O=l,t=0|L(0,0|i[(m=t+72|0)>>2],32),A=l,A=0|U(0|u,0|O,0|(r=0|B(0|(S=0|L(0,0|i[r>>2],32)),0|l,0|t,0|A)),0|l),i[(r=e+72|0)>>2]=A,i[r+4>>2]=l,r=0|L(0,0|i[g>>2],32),A=l,u=0|B(0|(O=0|L(0,0|i[c>>2],32)),0|l,0|r,0|A),A=l,r=0|L(0,0|i[o>>2],32),O=l,O=0|U(0|(S=0|B(0|(t=0|L(0,0|i[T>>2],32)),0|l,0|r,0|O)),0|l,0|u,0|A),A=l,u=0|L(0,0|i[y>>2],32),S=l,S=0|U(0|O,0|A,0|(t=0|B(0|(r=0|L(0,0|i[f>>2],32)),0|l,0|u,0|S)),0|l),t=l,A=0|L(0,0|i[n>>2],32),n=l,n=0|U(0|S,0|t,0|(u=0|B(0|(O=0|L(0,0|i[P>>2],32)),0|l,0|A,0|n)),0|l),u=l,t=0|L(0,0|i[m>>2],32),S=l,a=0|x(0|(S=0|U(0|n,0|u,0|(a=0|B(0|(A=0|L(0,0|i[a>>2],32)),0|l,0|t,0|S)),0|l)),0|l,1),S=l,u=0|L(0,0|i[d>>2],32),n=l,n=0|U(0|a,0|S,0|(A=0|B(0|(t=0|L(0,0|i[_>>2],32)),0|l,0|u,0|n)),0|l),A=l,S=0|L(0,0|i[v>>2],32),a=l,a=0|U(0|n,0|A,0|(t=0|B(0|(u=0|L(0,0|i[h>>2],32)),0|l,0|S,0|a)),0|l),t=l,A=0|L(0,0|i[p>>2],32),n=l,n=0|U(0|a,0|t,0|(u=0|B(0|(S=0|L(0,0|i[E>>2],32)),0|l,0|A,0|n)),0|l),u=l,t=0|L(0,0|i[C>>2],32),a=l,a=0|U(0|n,0|u,0|(S=0|B(0|(A=0|L(0,0|i[s>>2],32)),0|l,0|t,0|a)),0|l),i[(S=e+80|0)>>2]=a,i[S+4>>2]=l,S=0|L(0,0|i[g>>2],32),a=l,n=0|B(0|(u=0|L(0,0|i[_>>2],32)),0|l,0|S,0|a),a=l,S=0|L(0,0|i[v>>2],32),u=l,u=0|U(0|(A=0|B(0|(t=0|L(0,0|i[c>>2],32)),0|l,0|S,0|u)),0|l,0|n,0|a),a=l,n=0|L(0,0|i[d>>2],32),A=l,A=0|U(0|u,0|a,0|(t=0|B(0|(S=0|L(0,0|i[T>>2],32)),0|l,0|n,0|A)),0|l),t=l,a=0|L(0,0|i[y>>2],32),u=l,u=0|U(0|A,0|t,0|(S=0|B(0|(n=0|L(0,0|i[h>>2],32)),0|l,0|a,0|u)),0|l),S=l,t=0|L(0,0|i[o>>2],32),A=l,A=0|U(0|u,0|S,0|(n=0|B(0|(a=0|L(0,0|i[E>>2],32)),0|l,0|t,0|A)),0|l),n=l,S=0|L(0,0|i[C>>2],32),u=l,u=0|U(0|A,0|n,0|(a=0|B(0|(t=0|L(0,0|i[f>>2],32)),0|l,0|S,0|u)),0|l),a=l,n=0|L(0,0|i[p>>2],32),p=l,p=0|U(0|u,0|a,0|(S=0|B(0|(A=0|L(0,0|i[P>>2],32)),0|l,0|n,0|p)),0|l),S=l,a=0|L(0,0|i[m>>2],32),u=l,u=0|U(0|p,0|S,0|(s=0|B(0|(n=0|L(0,0|i[s>>2],32)),0|l,0|a,0|u)),0|l),i[(s=e+88|0)>>2]=u,i[s+4>>2]=l,s=0|L(0,0|i[v>>2],32),u=l,p=0|B(0|(S=0|L(0,0|i[_>>2],32)),0|l,0|s,0|u),u=l,s=0|L(0,0|i[g>>2],32),S=l,n=0|B(0|(a=0|L(0,0|i[T>>2],32)),0|l,0|s,0|S),S=l,s=0|L(0,0|i[y>>2],32),a=l,a=0|U(0|(t=0|B(0|(A=0|L(0,0|i[c>>2],32)),0|l,0|s,0|a)),0|l,0|n,0|S),S=l,n=0|L(0,0|i[o>>2],32),o=l,o=0|U(0|a,0|S,0|(s=0|B(0|(t=0|L(0,0|i[P>>2],32)),0|l,0|n,0|o)),0|l),s=l,S=0|L(0,0|i[m>>2],32),a=l,a=0|U(0|o,0|s,0|(f=0|B(0|(n=0|L(0,0|i[f>>2],32)),0|l,0|S,0|a)),0|l),a=0|U(0|(f=0|x(0|a,0|l,1)),0|l,0|p,0|u),u=l,p=0|L(0,0|i[d>>2],32),f=l,f=0|U(0|a,0|u,0|(o=0|B(0|(s=0|L(0,0|i[E>>2],32)),0|l,0|p,0|f)),0|l),o=l,u=0|L(0,0|i[C>>2],32),a=l,a=0|U(0|f,0|o,0|(s=0|B(0|(p=0|L(0,0|i[h>>2],32)),0|l,0|u,0|a)),0|l),i[(s=e+96|0)>>2]=a,i[s+4>>2]=l,s=0|L(0,0|i[v>>2],32),a=l,f=0|B(0|(o=0|L(0,0|i[T>>2],32)),0|l,0|s,0|a),a=l,s=0|L(0,0|i[y>>2],32),o=l,o=0|U(0|(p=0|B(0|(u=0|L(0,0|i[_>>2],32)),0|l,0|s,0|o)),0|l,0|f,0|a),a=l,f=0|L(0,0|i[g>>2],32),p=l,p=0|U(0|o,0|a,0|(u=0|B(0|(s=0|L(0,0|i[E>>2],32)),0|l,0|f,0|p)),0|l),u=l,a=0|L(0,0|i[C>>2],32),o=l,o=0|U(0|p,0|u,0|(s=0|B(0|(f=0|L(0,0|i[c>>2],32)),0|l,0|a,0|o)),0|l),s=l,u=0|L(0,0|i[d>>2],32),d=l,d=0|U(0|o,0|s,0|(a=0|B(0|(p=0|L(0,0|i[P>>2],32)),0|l,0|u,0|d)),0|l),a=l,s=0|L(0,0|i[m>>2],32),o=l,o=0|U(0|d,0|a,0|(h=0|B(0|(u=0|L(0,0|i[h>>2],32)),0|l,0|s,0|o)),0|l),i[(h=e+104|0)>>2]=o,i[h+4>>2]=l,h=0|L(0,0|i[y>>2],32),o=l,d=0|B(0|(a=0|L(0,0|i[T>>2],32)),0|l,0|h,0|o),o=l,h=0|L(0,0|i[g>>2],32),g=l,g=0|U(0|(s=0|B(0|(a=0|L(0,0|i[P>>2],32)),0|l,0|h,0|g)),0|l,0|d,0|o),o=l,d=0|L(0,0|i[m>>2],32),s=l,c=0|x(0|(s=0|U(0|g,0|o,0|(c=0|B(0|(h=0|L(0,0|i[c>>2],32)),0|l,0|d,0|s)),0|l)),0|l,1),s=l,o=0|L(0,0|i[v>>2],32),g=l,g=0|U(0|c,0|s,0|(h=0|B(0|(d=0|L(0,0|i[E>>2],32)),0|l,0|o,0|g)),0|l),h=l,s=0|L(0,0|i[C>>2],32),c=l,c=0|U(0|g,0|h,0|(d=0|B(0|(o=0|L(0,0|i[_>>2],32)),0|l,0|s,0|c)),0|l),i[(d=e+112|0)>>2]=c,i[d+4>>2]=l,d=0|L(0,0|i[y>>2],32),c=l,g=0|B(0|(h=0|L(0,0|i[E>>2],32)),0|l,0|d,0|c),c=l,d=0|L(0,0|i[C>>2],32),h=l,h=0|U(0|(o=0|B(0|(s=0|L(0,0|i[T>>2],32)),0|l,0|d,0|h)),0|l,0|g,0|c),c=l,g=0|L(0,0|i[v>>2],32),v=l,v=0|U(0|h,0|c,0|(d=0|B(0|(o=0|L(0,0|i[P>>2],32)),0|l,0|g,0|v)),0|l),d=l,c=0|L(0,0|i[m>>2],32),h=l,h=0|U(0|v,0|d,0|(_=0|B(0|(g=0|L(0,0|i[_>>2],32)),0|l,0|c,0|h)),0|l),i[(_=e+120|0)>>2]=h,i[_+4>>2]=l,_=0|L(0,0|i[C>>2],32),h=l,v=0|B(0|(d=0|L(0,0|i[E>>2],32)),0|l,0|_,0|h),h=l,_=0|L(0,0|i[y>>2],32),y=l,c=0|B(0|(d=0|L(0,0|i[P>>2],32)),0|l,0|_,0|y),y=l,_=0|L(0,0|i[m>>2],32),d=l,d=0|U(0|(T=0|B(0|(g=0|L(0,0|i[T>>2],32)),0|l,0|_,0|d)),0|l,0|c,0|y),d=0|U(0|(y=0|x(0|d,0|l,1)),0|l,0|v,0|h),i[(h=e+128|0)>>2]=d,i[h+4>>2]=l,h=0|L(0,0|i[C>>2],32),C=l,v=0|B(0|(d=0|L(0,0|i[P>>2],32)),0|l,0|h,0|C),C=l,h=0|L(0,0|i[m>>2],32),d=l,d=0|U(0|(E=0|B(0|(y=0|L(0,0|i[E>>2],32)),0|l,0|h,0|d)),0|l,0|v,0|C),i[(C=e+136|0)>>2]=d,i[C+4>>2]=l,C=0|L(0,0|i[m>>2],31),m=l,P=0|B(0|(d=0|L(0,0|i[P>>2],32)),0|l,0|C,0|m),i[(m=e+144|0)>>2]=P,i[m+4>>2]=l}function O(e,t){e|=0;var r,a,n,o=0,d=0,u=0,c=0,p=0,h=0,f=0,_=0,m=0,g=0,v=0,E=0,y=0,S=0,T=0,A=0,b=0,C=0,P=0,O=0,w=0,M=0,I=0,R=0,D=0,N=0,G=0,F=0,Y=0,K=0,j=0,W=0,H=0,V=0,$=0,q=0,z=0;r=s,s=s+160|0,o=r,c=0|B(0|(a=0|L(0,0|(d=0|i[(t|=0)>>2]),32)),0|(u=l),0|a,0|u),i[(p=o)>>2]=c,i[p+4>>2]=l,p=0|L(0,0|d,31),d=l,m=0|B(0|(f=0|L(0,0|(h=0|i[(c=t+8|0)>>2]),32)),0|(_=l),0|p,0|d),i[(g=n=o+8|0)>>2]=m,i[g+4>>2]=l,g=0|B(0|f,0|_,0|f,0|_),m=l,m=0|x(0|(T=0|U(0|(S=0|B(0|(E=0|L(0,0|i[(v=t+16|0)>>2],32)),0|(y=l),0|a,0|u)),0|l,0|g,0|m)),0|l,1),i[(g=T=o+16|0)>>2]=m,i[g+4>>2]=l,g=0|B(0|E,0|y,0|f,0|_),m=l,m=0|x(0|(P=0|U(0|(C=0|B(0|(A=0|L(0,0|i[(S=t+24|0)>>2],32)),0|(b=l),0|a,0|u)),0|l,0|g,0|m)),0|l,1),i[(g=P=o+24|0)>>2]=m,i[g+4>>2]=l,g=0|B(0|E,0|y,0|E,0|y),m=l,C=0|U(0|(O=0|B(0|A,0|b,0|(C=0|L(0,0|h,30)),0|l)),0|l,0|g,0|m),d=0|U(0|C,0|(m=l),0|(M=0|B(0|(O=0|L(0,0|i[(g=t+32|0)>>2],32)),0|(w=l),0|p,0|d)),0|l),i[(m=M=o+32|0)>>2]=d,i[m+4>>2]=l,m=0|B(0|A,0|b,0|E,0|y),d=l,p=0|U(0|(C=0|B(0|O,0|w,0|f,0|_)),0|l,0|m,0|d),R=0|x(0|(D=0|U(0|p,0|(d=l),0|(R=0|B(0|(C=0|L(0,0|i[(m=t+40|0)>>2],32)),0|(I=l),0|a,0|u)),0|l)),0|l,1),i[(d=D=o+40|0)>>2]=R,i[d+4>>2]=l,d=0|B(0|A,0|b,0|A,0|b),R=l,N=0|U(0|(p=0|B(0|O,0|w,0|E,0|y)),0|l,0|d,0|R),Y=0|U(0|N,0|(R=l),0|(F=0|B(0|(p=0|L(0,0|i[(d=t+48|0)>>2],32)),0|(G=l),0|a,0|u)),0|l),h=0|x(0|(R=0|U(0|Y,0|(F=l),0|(h=0|B(0|C,0|I,0|(R=0|L(0,0|h,31)),0|l)),0|l)),0|l,1),i[(F=R=o+48|0)>>2]=h,i[F+4>>2]=l,F=0|B(0|O,0|w,0|A,0|b),h=l,N=0|U(0|(Y=0|B(0|C,0|I,0|E,0|y)),0|l,0|F,0|h),Y=0|U(0|N,0|(h=l),0|(F=0|B(0|p,0|G,0|f,0|_)),0|l),j=0|x(0|(W=0|U(0|Y,0|(F=l),0|(j=0|B(0|(N=0|L(0,0|i[(h=t+56|0)>>2],32)),0|(K=l),0|a,0|u)),0|l)),0|l,1),i[(F=W=o+56|0)>>2]=j,i[F+4>>2]=l,F=0|B(0|O,0|w,0|O,0|w),j=l,Y=0|B(0|p,0|G,0|E,0|y),H=l,u=0|U(0|(z=0|B(0|($=0|L(0,0|i[(V=t+64|0)>>2],32)),0|(q=l),0|a,0|u)),0|l,0|Y,0|H),H=l,Y=0|B(0|N,0|K,0|f,0|_),_=l,z=0|U(0|(f=0|B(0|C,0|I,0|A,0|b)),0|l,0|Y,0|_),z=0|U(0|u,0|H,0|(_=0|x(0|z,0|l,1)),0|l),z=0|U(0|(_=0|x(0|z,0|l,1)),0|l,0|F,0|j),i[(F=j=o+64|0)>>2]=z,i[F+4>>2]=l,F=0|B(0|C,0|I,0|O,0|w),z=l,b=0|U(0|(_=0|B(0|p,0|G,0|A,0|b)),0|l,0|F,0|z),y=0|U(0|b,0|(z=l),0|(F=0|B(0|N,0|K,0|E,0|y)),0|l),E=0|U(0|y,0|(F=l),0|(b=0|B(0|$,0|q,0|(z=0|L(0,0|i[c>>2],32)),0|(c=l))),0|l),b=l,F=0|L(0,0|i[t>>2],32),y=l,H=0|x(0|(y=0|U(0|E,0|b,0|(H=0|B(0|(t=0|L(0,0|(_=0|i[t+72>>2]),32)),0|(A=l),0|F,0|y)),0|l)),0|l,1),i[(y=o+72|0)>>2]=H,i[y+4>>2]=l,y=0|B(0|C,0|I,0|C,0|I),H=l,w=0|U(0|(b=0|B(0|p,0|G,0|O,0|w)),0|l,0|y,0|H),O=0|U(0|w,0|(H=l),0|(b=0|B(0|$,0|q,0|(y=0|L(0,0|i[v>>2],32)),0|(v=l))),0|l),b=l,w=0|B(0|N,0|K,0|(H=0|L(0,0|i[S>>2],32)),0|(S=l)),E=l,E=0|x(0|(c=0|U(0|(F=0|B(0|t,0|A,0|z,0|c)),0|l,0|w,0|E)),0|l,1),E=0|x(0|(c=0|U(0|O,0|b,0|E,0|l)),0|l,1),i[(b=c=o+80|0)>>2]=E,i[b+4>>2]=l,b=0|B(0|p,0|G,0|C,0|I),I=l,O=0|U(0|(E=0|B(0|N,0|K,0|(C=0|L(0,0|i[g>>2],32)),0|(g=l))),0|l,0|b,0|I),E=0|U(0|O,0|(I=l),0|(b=0|B(0|$,0|q,0|H,0|S)),0|l),b=0|x(0|(v=0|U(0|E,0|(b=l),0|(I=0|B(0|t,0|A,0|y,0|v)),0|l)),0|(I=l),1),E=l,i[(y=o+88|0)>>2]=b,i[y+4>>2]=E,y=0|B(0|p,0|G,0|p,0|G),G=l,p=0|B(0|$,0|q,0|C,0|g),O=l,z=0|B(0|N,0|K,0|(m=0|L(0,0|(w=0|i[m>>2]),32)),0|(F=l)),u=l,S=0|U(0|(Y=0|B(0|t,0|A,0|H,0|S)),0|l,0|z,0|u),S=0|U(0|(u=0|x(0|S,0|l,1)),0|l,0|p,0|O),S=0|U(0|(O=0|x(0|S,0|l,1)),0|l,0|y,0|G),G=l,i[(y=o+96|0)>>2]=S,i[y+4>>2]=G,O=0|B(0|N,0|K,0|(y=0|L(0,0|i[d>>2],32)),0|(d=l)),K=l,F=0|U(0|(N=0|B(0|$,0|q,0|m,0|F)),0|l,0|O,0|K),K=0|x(0|(g=0|U(0|F,0|(K=l),0|(O=0|B(0|t,0|A,0|C,0|g)),0|l)),0|(O=l),1),F=l,i[(C=o+104|0)>>2]=K,i[C+4>>2]=F,m=0|B(0|(h=0|L(0,0|(C=0|i[h>>2]),32)),0|(N=l),0|h,0|N),p=l,q=0|U(0|(u=0|B(0|$,0|q,0|y,0|d)),0|l,0|m,0|p),p=0|x(0|(m=0|U(0|q,0|(p=l),0|(w=0|B(0|t,0|A,0|(m=0|L(0,0|w,31)),0|l)),0|l)),0|(w=l),1),q=l,i[(u=o+112|0)>>2]=p,i[u+4>>2]=q,z=0|B(0|(V=0|L(0,0|(u=0|i[V>>2]),32)),0|($=l),0|h,0|N),N=l,z=0|x(0|(d=0|U(0|(h=0|B(0|t,0|A,0|y,0|d)),0|l,0|z,0|N)),0|(N=l),1),h=l,i[(y=o+120|0)>>2]=z,i[y+4>>2]=h,y=0|B(0|V,0|$,0|V,0|$),$=l,V=0|U(0|(C=0|B(0|t,0|A,0|(V=0|L(0,0|C,30)),0|l)),0|l,0|y,0|$),$=l,i[(y=o+128|0)>>2]=V,i[y+4>>2]=$,u=0|B(0|t,0|A,0|(y=0|L(0,0|u,31)),0|l),y=l,i[(C=o+136|0)>>2]=u,i[C+4>>2]=y,_=0|B(0|(C=0|L(0,0|_,31)),0|l,0|t,0|A),A=l,i[(t=o+144|0)>>2]=_,i[t+4>>2]=A,C=0|i[(t=j)>>2],Y=0|i[t+4>>2],t=0|B(0|_,0|A,18,0),H=l,f=0|U(0|_,0|A,0|C,0|Y),Y=0|U(0|f,0|l,0|t,0|H),i[(H=j)>>2]=Y,i[H+4>>2]=l,Y=0|i[(H=W)>>2],j=0|i[H+4>>2],H=0|B(0|u,0|y,18,0),t=l,f=0|U(0|Y,0|j,0|u,0|y),y=0|U(0|f,0|l,0|H,0|t),i[(t=W)>>2]=y,i[t+4>>2]=l,y=0|i[(t=R)>>2],W=0|i[t+4>>2],t=0|B(0|V,0|$,18,0),H=l,f=0|U(0|y,0|W,0|V,0|$),$=0|U(0|f,0|l,0|t,0|H),i[(H=R)>>2]=$,i[H+4>>2]=l,$=0|i[(H=D)>>2],R=0|i[H+4>>2],H=0|B(0|d,0|N,36,0),N=l,d=0|U(0|$,0|R,0|z,0|h),h=0|U(0|d,0|l,0|H,0|N),i[(N=D)>>2]=h,i[N+4>>2]=l,h=0|i[(N=M)>>2],D=0|i[N+4>>2],N=0|B(0|m,0|w,36,0),w=l,m=0|U(0|h,0|D,0|p,0|q),q=0|U(0|m,0|l,0|N,0|w),i[(w=M)>>2]=q,i[w+4>>2]=l,q=0|i[(w=P)>>2],M=0|i[w+4>>2],w=0|B(0|g,0|O,36,0),O=l,g=0|U(0|q,0|M,0|K,0|F),F=0|U(0|g,0|l,0|w,0|O),i[(O=P)>>2]=F,i[O+4>>2]=l,F=0|i[(O=T)>>2],P=0|i[O+4>>2],O=0|B(0|S,0|G,18,0),w=l,g=0|U(0|F,0|P,0|S,0|G),G=0|U(0|g,0|l,0|O,0|w),i[(w=T)>>2]=G,i[w+4>>2]=l,G=0|i[(w=n)>>2],T=0|i[w+4>>2],w=0|B(0|v,0|I,36,0),I=l,v=0|U(0|G,0|T,0|b,0|E),E=0|U(0|v,0|l,0|w,0|I),i[(I=n)>>2]=E,i[I+4>>2]=l,E=0|i[(I=c)>>2],w=0|i[I+4>>2],v=0|i[(I=o)>>2],b=0|i[I+4>>2],I=0|B(0|E,0|w,18,0),T=l,G=0|U(0|v,0|b,0|E,0|w),w=0|U(0|G,0|l,0|I,0|T),T=l,i[(I=o)>>2]=w,i[I+4>>2]=T,i[(I=c)>>2]=0,i[I+4>>2]=0,I=T,T=w,w=0;do{v=0|k(0|T,0|I,0|(b=0|x(0|(E=0|L(0|(G=0|U(I>>31>>>6|0,0,0|T,0|I)),0|l,26)),0|(G=l),26)),0|l),i[(b=o+(w<<3)|0)>>2]=v,i[b+4>>2]=l,S=0|k(0|(O=0|U(0|E,0|G,0|i[(v=b=o+((1|w)<<3)|0)>>2],0|i[v+4>>2])),0|(v=l),0|(g=0|x(0|(E=0|L(0|(G=0|U(v>>31>>>7|0,0,0|O,0|v)),0|l,25)),0|(G=l),25)),0|l),i[(g=b)>>2]=S,i[g+4>>2]=l,T=0|U(0|E,0|G,0|i[(S=g=o+((w=w+2|0)<<3)|0)>>2],0|i[S+4>>2]),I=l,i[(S=g)>>2]=T,i[S+4>>2]=I}while(w>>>0<10);I=0|i[(w=c)>>2],T=0|i[w+4>>2],S=0|i[(w=o)>>2],g=0|i[w+4>>2],w=0|B(0|I,0|T,18,0),G=l,E=0|U(0|S,0|g,0|I,0|T),T=0|U(0|E,0|l,0|w,0|G),G=l,i[(w=c)>>2]=0,i[w+4>>2]=0,I=0|k(0|T,0|G,0|(E=0|x(0|(c=0|L(0|(w=0|U(G>>31>>>6|0,0,0|T,0|G)),0|l,26)),0|(w=l),26)),0|l),i[(E=o)>>2]=I,i[E+4>>2]=l,I=0|U(0|c,0|w,0|i[(E=n)>>2],0|i[E+4>>2]),i[(E=n)>>2]=I,i[E+4>>2]=l,E=e,e=o,o=E+80|0;do{i[E>>2]=i[e>>2],E=E+4|0,e=e+4|0}while((0|E)<(0|o));s=r}function w(){return 0|(0|i[2]?0|i[60+(0|h())>>2]:56)}function M(e){var t=0;return(e|=0)>>>0>4294963200?(i[(0|w())>>2]=0-e,t=-1):t=e,0|t}function I(e){return 0,0}function R(e){0}function D(e,t,r){t|=0,r|=0;var a,n,o,l,d,u=0,p=0,h=0,f=0,_=0,m=0,g=0,v=0,E=0,y=0,S=0,A=0,C=0,P=0,O=0,w=0;for(a=s,s=s+48|0,n=a+16|0,o=a,u=a+32|0,p=0|i[(l=(e|=0)+28|0)>>2],i[u>>2]=p,h=(0|i[(d=e+20|0)>>2])-p|0,i[u+4>>2]=h,i[u+8>>2]=t,i[u+12>>2]=r,t=e+60|0,p=e+44|0,f=u,u=2,_=h+r|0;;){if(0|i[2]?(T(1,0|e),i[o>>2]=i[t>>2],i[o+4>>2]=f,i[o+8>>2]=u,h=0|M(0|b(146,0|o)),c(0),m=h):(i[n>>2]=i[t>>2],i[n+4>>2]=f,i[n+8>>2]=u,m=0|M(0|b(146,0|n))),(0|_)==(0|m)){g=6;break}if((0|m)<0){v=f,E=u,g=8;break}h=_-m|0,m>>>0<=(y=0|i[f+4>>2])>>>0?2==(0|u)?(i[l>>2]=(0|i[l>>2])+m,S=y,A=m,C=f,P=2):(S=y,A=m,C=f,P=u):(O=0|i[p>>2],i[l>>2]=O,i[d>>2]=O,S=0|i[f+12>>2],A=m-y|0,C=f+8|0,P=u+-1|0),i[C>>2]=(0|i[C>>2])+A,i[C+4>>2]=S-A,f=C,u=P,_=h}return 6==(0|g)?(_=0|i[p>>2],i[e+16>>2]=_+(0|i[e+48>>2]),p=_,i[l>>2]=p,i[d>>2]=p,w=r):8==(0|g)&&(i[e+16>>2]=0,i[l>>2]=0,i[d>>2]=0,i[e>>2]=32|i[e>>2],w=2==(0|E)?0:r-(0|i[v+4>>2])|0),s=a,0|w}function N(e){var t,r,a=0,n=0,s=0,o=0,l=0;return r=(e|=0)+28|0,(0|i[(t=e+20|0)>>2])>>>0>(0|i[r>>2])>>>0&&(K[3&i[e+36>>2]](e,0,0),0==(0|i[t>>2]))?a=-1:((s=0|i[(n=e+4|0)>>2])>>>0<(l=0|i[(o=e+8|0)>>2])>>>0&&K[3&i[e+40>>2]](e,s-l|0,1),i[e+16>>2]=0,i[r>>2]=0,i[t>>2]=0,i[o>>2]=0,i[n>>2]=0,a=0),0|a}function L(e,t,r){return e|=0,t|=0,(0|(r|=0))<32?(l=t>>r,e>>>r|(t&(1<<r)-1)<<32-r):(l=(0|t)<0?-1:0,t>>r-32|0)}function k(e,t,r,a){return(t|=0)-(a|=0)>>>0,0|(l=t-a-((r|=0)>>>0>(e|=0)>>>0|0)>>>0,e-r>>>0|0)}function U(e,t,r,a){var i;return 0|(l=(t|=0)+(a|=0)+((i=(e|=0)+(r|=0)>>>0)>>>0<e>>>0|0)>>>0,0|i)}function G(e,t,r){t|=0;var n,s=0,o=0,l=0;if(n=(e|=0)+(r|=0)|0,(0|r)>=20){if(o=(t&=255)|t<<8|t<<16|t<<24,l=-4&n,s=3&e)for(s=e+4-s|0;(0|e)<(0|s);)a[e>>0]=t,e=e+1|0;for(;(0|e)<(0|l);)i[e>>2]=o,e=e+4|0}for(;(0|e)<(0|n);)a[e>>0]=t,e=e+1|0;return e-r|0}function F(e,t,r){return e|=0,t|=0,(0|(r|=0))<32?(l=t>>>r,e>>>r|(t&(1<<r)-1)<<32-r):(l=0,t>>>r-32|0)}function x(e,t,r){return e|=0,t|=0,(0|(r|=0))<32?(l=t<<r|(e&(1<<r)-1<<32-r)>>>32-r,e<<r):(l=e<<r-32,0)}function B(e,t,r,a){t|=0,a|=0;var i,n;return r=0|function(e,t){var r,a,i,n=0;return e=((a=0|d(n=65535&(t|=0),r=65535&(e|=0)))>>>16)+(0|d(n,i=e>>>16))|0,t=0|d(n=t>>>16,r),0|(l=(e>>>16)+(0|d(n,i))+(((65535&e)+t|0)>>>16)|0,e+t<<16|65535&a|0)}(i=e|=0,e=r|=0),n=l,0|(l=(0|d(t,e))+(0|d(a,i))+n|0&n,0|r)}var Y=[function(e){return 0,u(0),0},function(e){var t,r;return e|=0,t=s,s=s+16|0,i[(r=t)>>2]=i[e+60>>2],e=0|M(0|f(6,0|r)),s=t,0|e}],K=[function(e,t,r){return 0,0,0,u(1),0},function(e,t,r){t|=0,r|=0;var n,o=0;return n=s,s=s+80|0,o=n,i[(e|=0)+36>>2]=3,0==(64&i[e>>2]|0)&&(i[o>>2]=i[e+60>>2],i[o+4>>2]=21505,i[o+8>>2]=n+12,0!=(0|E(54,0|o)))&&(a[e+75>>0]=-1),o=0|D(e,t,r),s=n,0|o},function(e,t,r){e|=0,t|=0,r|=0;var a,n,o,l=0;return a=s,s=s+32|0,o=a+20|0,i[(n=a)>>2]=i[e+60>>2],i[n+4>>2]=0,i[n+8>>2]=t,i[n+12>>2]=o,i[n+16>>2]=r,(0|M(0|S(140,0|n)))<0?(i[o>>2]=-1,l=-1):l=0|i[o>>2],s=a,0|l},D],j=[function(e){u(2)},function(e){0|i[(e|=0)+68>>2]||R()}];return{_curve25519_donna:function(e,t,r){e|=0,r|=0;var o,u,c,p,h,f,_,m,g,v,E,y,S,T,A,b,w,M,I,R,D,N,Y,K,j,W,H,V,$,q,z,J,Q,X,Z,ee,te,re,ae,ie,ne,se,oe,le,de,ue,ce,pe,he,fe,_e,me,ge,ve,Ee,ye,Se,Te,Ae,be=0,Ce=0,Pe=0,Oe=0,we=0,Me=0,Ie=0,Re=0,De=0,Ne=0,Le=0,ke=0,Ue=0,Ge=0,Fe=0,xe=0,Be=0,Ye=0,Ke=0,je=0,We=0,He=0,Ve=0,$e=0,qe=0,ze=0,Je=0,Qe=0,Xe=0,Ze=0,et=0,tt=0,rt=0,at=0,it=0,nt=0,st=0,ot=0,lt=0,dt=0,ut=0,ct=0,pt=0,ht=0,ft=0,_t=0,mt=0,gt=0,vt=0,Et=0,yt=0,St=0,Tt=0,At=0,bt=0,Ct=0,Pt=0,Ot=0,wt=0,Mt=0,It=0,Rt=0,Dt=0,Nt=0,Lt=0,kt=0,Ut=0,Gt=0,Ft=0,xt=0,Bt=0,Yt=0,Kt=0,jt=0,Wt=0,Ht=0,Vt=0,$t=0,qt=0,zt=0,Jt=0,Qt=0,Xt=0,Zt=0,er=0,tr=0,rr=0,ar=0,ir=0,nr=0,sr=0,or=0,lr=0,dr=0,ur=0,cr=0,pr=0,hr=0,fr=0,_r=0,mr=0,gr=0,vr=0,Er=0,yr=0,Sr=0,Tr=0,Ar=0,br=0,Cr=0,Pr=0,Or=0,wr=0,Mr=0,Ir=0,Rr=0,Dr=0,Nr=0;o=s,s=s+2640|0,be=o+2456|0,Ce=o+2304|0,Pe=o+2152|0,Oe=o+2e3|0,we=o+1848|0,Me=o+1696|0,Ie=o+1544|0,Re=o+1392|0,De=o+1240|0,Ne=o+1088|0,Le=o+936|0,ke=o+784|0,Ue=o+632|0,Ge=o+480|0,Fe=o+328|0,u=o+248|0,xe=o+168|0,Be=o+80|0,Ye=o,je=t|=0,t=(Ke=c=o+2608|0)+32|0;do{a[Ke>>0]=0|a[je>>0],Ke=Ke+1|0,je=je+1|0}while((0|Ke)<(0|t));a[c>>0]=248&(0|n[c>>0]),a[(We=c+31|0)>>0]=63&(0|n[We>>0])|64,We=0|n[r>>0],He=0|x(0|n[r+1>>0],0,8),Ve=l,$e=0|x(0|n[r+2>>0],0,16),qe=Ve|l,ze=0|x(0|(Ve=0|n[r+3>>0]),0,24),i[(Je=u)>>2]=He|We|$e|50331648&ze,i[Je+4>>2]=qe,qe=0|x(0|n[r+4>>0],0,8),Je=l,ze=0|x(0|n[r+5>>0],0,16),$e=Je|l,He=0|F(qe|Ve|ze|(We=0|x(0|(Je=0|n[r+6>>0]),0,24))|0,$e|l|0,2),i[($e=u+8|0)>>2]=33554431&He,i[$e+4>>2]=0,$e=0|x(0|n[r+7>>0],0,8),He=l,We=0|x(0|n[r+8>>0],0,16),ze=He|l,qe=0|F($e|Je|We|(Ve=0|x(0|(He=0|n[r+9>>0]),0,24))|0,ze|l|0,3),i[(ze=u+16|0)>>2]=67108863&qe,i[ze+4>>2]=0,ze=0|x(0|n[r+10>>0],0,8),qe=l,Ve=0|x(0|n[r+11>>0],0,16),We=qe|l,$e=0|F(ze|He|Ve|(Je=0|x(0|(qe=0|n[r+12>>0]),0,24))|0,We|l|0,5),i[(We=u+24|0)>>2]=33554431&$e,i[We+4>>2]=0,We=0|x(0|n[r+13>>0],0,8),$e=l,Je=0|x(0|n[r+14>>0],0,16),Ve=$e|l,He=0|F(We|qe|Je|($e=0|x(0|n[r+15>>0],0,24))|0,Ve|l|0,6),i[(Ve=u+32|0)>>2]=67108863&He,i[Ve+4>>2]=0,Ve=0|n[r+16>>0],He=0|x(0|n[r+17>>0],0,8),$e=l,Je=0|x(0|n[r+18>>0],0,16),qe=$e|l,We=0|x(0|($e=0|n[r+19>>0]),0,24),i[(ze=u+40|0)>>2]=He|Ve|Je|16777216&We,i[ze+4>>2]=qe,qe=0|x(0|n[r+20>>0],0,8),ze=l,We=0|x(0|n[r+21>>0],0,16),Je=ze|l,He=0|F(qe|$e|We|(Ve=0|x(0|(ze=0|n[r+22>>0]),0,24))|0,Je|l|0,1),i[(Je=u+48|0)>>2]=67108863&He,i[Je+4>>2]=0,Je=0|x(0|n[r+23>>0],0,8),He=l,Ve=0|x(0|n[r+24>>0],0,16),We=He|l,qe=0|F(Je|ze|Ve|($e=0|x(0|(He=0|n[r+25>>0]),0,24))|0,We|l|0,3),i[(We=u+56|0)>>2]=33554431&qe,i[We+4>>2]=0,We=0|x(0|n[r+26>>0],0,8),qe=l,$e=0|x(0|n[r+27>>0],0,16),Ve=qe|l,Je=0|F(We|He|$e|(ze=0|x(0|(qe=0|n[r+28>>0]),0,24))|0,Ve|l|0,4),i[(Ve=u+64|0)>>2]=67108863&Je,i[Ve+4>>2]=0,Ve=0|x(0|n[r+29>>0],0,8),Je=l,ze=0|x(0|n[r+30>>0],0,16),$e=Je|l,r=0|F(Ve|qe|ze|(Je=0|x(0|n[r+31>>0],0,24))|0,$e|l|0,6),i[($e=u+72|0)>>2]=33554431&r,i[$e+4>>2]=0,G(0|De,0,152),i[($e=De)>>2]=1,i[$e+4>>2]=0,G(0|Ne,0,152),i[($e=Ne)>>2]=1,i[$e+4>>2]=0,G(0|Le,0,152),G(0|ke,0,152),G(0|Ue,0,152),i[($e=Ue)>>2]=1,i[$e+4>>2]=0,G(0|Ge,0,152),G(0|Fe,0,152),i[($e=Fe)>>2]=1,i[$e+4>>2]=0,t=(Ke=Re+80|0)+72|0;do{i[Ke>>2]=0,Ke=Ke+4|0}while((0|Ke)<(0|t));je=u,t=(Ke=Re)+80|0;do{i[Ke>>2]=i[je>>2],Ke=Ke+4|0,je=je+4|0}while((0|Ke)<(0|t));for($e=Oe+144|0,r=Oe+64|0,Je=Oe+136|0,ze=Oe+56|0,qe=Oe+128|0,Ve=Oe+48|0,He=Oe+120|0,We=Oe+40|0,p=Oe+112|0,h=Oe+32|0,f=Oe+104|0,_=Oe+24|0,m=Oe+96|0,g=Oe+16|0,v=Oe+88|0,E=Oe+8|0,y=Oe+80|0,S=we+144|0,T=we+64|0,A=we+136|0,b=we+56|0,w=we+128|0,M=we+48|0,I=we+120|0,R=we+40|0,D=we+112|0,N=we+32|0,Y=we+104|0,K=we+24|0,j=we+96|0,W=we+16|0,H=we+88|0,V=we+8|0,$=we+80|0,q=Oe+72|0,z=we+72|0,J=Ce+8|0,Q=Pe+8|0,X=Ce+16|0,Z=Pe+16|0,ee=Ce+24|0,te=Pe+24|0,re=Ce+32|0,ae=Pe+32|0,ie=Ce+40|0,ne=Pe+40|0,se=Ce+48|0,oe=Pe+48|0,le=Ce+56|0,de=Pe+56|0,ue=Ce+64|0,ce=Pe+64|0,pe=Ce+72|0,he=Pe+72|0,fe=be+80|0,_e=be+8|0,me=be+16|0,ge=be+24|0,ve=be+32|0,Ee=be+40|0,ye=be+48|0,Se=be+56|0,Te=be+64|0,Ae=be+72|0,Qe=0,Xe=Re,Ze=ke,ke=De,et=Ue,Ue=Ne,tt=Ge,Ge=Le,Le=Fe;;){for(Fe=0|a[c+(31-Qe)>>0],rt=0,at=Xe,it=Ze,nt=ke,st=et,ot=Ue,lt=tt,dt=Ge,ut=Le;;){pt=0|k(0,0,(ct=255&Fe)>>>7|0,0),ht=l,ft=0;do{gt=0|i[(mt=_t=ot+(ft<<3)|0)>>2],vt=0|i[mt+4>>2],yt=0|i[(Et=mt=at+(ft<<3)|0)>>2],Tt=((St=0|i[Et+4>>2])^vt)&ht,vt=0|L(0,(Et=(yt^gt)&pt)^gt|0,32),i[(gt=_t)>>2]=vt,i[gt+4>>2]=l,gt=0|L(0,Et^yt|0,32),i[(yt=mt)>>2]=gt,i[yt+4>>2]=l,ft=ft+1|0}while(10!=(0|ft));At=0;do{gt=0|i[(yt=ft=dt+(At<<3)|0)>>2],mt=0|i[yt+4>>2],vt=0|i[(Et=yt=nt+(At<<3)|0)>>2],St=((_t=0|i[Et+4>>2])^mt)&ht,mt=0|L(0,(Et=(vt^gt)&pt)^gt|0,32),i[(gt=ft)>>2]=mt,i[gt+4>>2]=l,gt=0|L(0,Et^vt|0,32),i[(vt=yt)>>2]=gt,i[vt+4>>2]=l,At=At+1|0}while(10!=(0|At));gt=0|i[(vt=ot)>>2],yt=0|i[vt+4>>2],mt=0|i[(Et=vt=ot+8|0)>>2],ft=0|i[Et+4>>2],St=0|i[(_t=Et=ot+16|0)>>2],Tt=0|i[_t+4>>2],Ct=0|i[(bt=_t=ot+24|0)>>2],Pt=0|i[bt+4>>2],wt=0|i[(Ot=bt=ot+32|0)>>2],Mt=0|i[Ot+4>>2],Rt=0|i[(It=Ot=ot+40|0)>>2],Dt=0|i[It+4>>2],Lt=0|i[(Nt=It=ot+48|0)>>2],kt=0|i[Nt+4>>2],Gt=0|i[(Ut=Nt=ot+56|0)>>2],Ft=0|i[Ut+4>>2],Bt=0|i[(xt=Ut=ot+64|0)>>2],Yt=0|i[xt+4>>2],jt=0|i[(Kt=xt=ot+72|0)>>2],Wt=0|i[Kt+4>>2],Kt=0|U(0|(Ht=0|i[(Kt=dt)>>2]),0|(Vt=0|i[Kt+4>>2]),0|gt,0|yt),i[($t=ot)>>2]=Kt,i[$t+4>>2]=l,Kt=0|U(0|(qt=0|i[(Kt=$t=dt+8|0)>>2]),0|(zt=0|i[Kt+4>>2]),0|mt,0|ft),i[(Jt=vt)>>2]=Kt,i[Jt+4>>2]=l,Kt=0|U(0|(vt=0|i[(Kt=Jt=dt+16|0)>>2]),0|(Qt=0|i[Kt+4>>2]),0|St,0|Tt),i[(Xt=Et)>>2]=Kt,i[Xt+4>>2]=l,Kt=0|U(0|(Et=0|i[(Kt=Xt=dt+24|0)>>2]),0|(Zt=0|i[Kt+4>>2]),0|Ct,0|Pt),i[(er=_t)>>2]=Kt,i[er+4>>2]=l,Kt=0|U(0|(_t=0|i[(Kt=er=dt+32|0)>>2]),0|(tr=0|i[Kt+4>>2]),0|wt,0|Mt),i[(rr=bt)>>2]=Kt,i[rr+4>>2]=l,Kt=0|U(0|(bt=0|i[(Kt=rr=dt+40|0)>>2]),0|(ar=0|i[Kt+4>>2]),0|Rt,0|Dt),i[(ir=Ot)>>2]=Kt,i[ir+4>>2]=l,Kt=0|U(0|(Ot=0|i[(Kt=ir=dt+48|0)>>2]),0|(nr=0|i[Kt+4>>2]),0|Lt,0|kt),i[(sr=It)>>2]=Kt,i[sr+4>>2]=l,Kt=0|U(0|(It=0|i[(Kt=sr=dt+56|0)>>2]),0|(or=0|i[Kt+4>>2]),0|Gt,0|Ft),i[(lr=Nt)>>2]=Kt,i[lr+4>>2]=l,Kt=0|U(0|(Nt=0|i[(Kt=lr=dt+64|0)>>2]),0|(dr=0|i[Kt+4>>2]),0|Bt,0|Yt),i[(ur=Ut)>>2]=Kt,i[ur+4>>2]=l,Kt=0|U(0|(Ut=0|i[(Kt=ur=dt+72|0)>>2]),0|(cr=0|i[Kt+4>>2]),0|jt,0|Wt),i[(pr=xt)>>2]=Kt,i[pr+4>>2]=l,pr=0|k(0|gt,0|yt,0|Ht,0|Vt),i[(Vt=dt)>>2]=pr,i[Vt+4>>2]=l,Vt=0|k(0|mt,0|ft,0|qt,0|zt),i[(zt=$t)>>2]=Vt,i[zt+4>>2]=l,zt=0|k(0|St,0|Tt,0|vt,0|Qt),i[(Qt=Jt)>>2]=zt,i[Qt+4>>2]=l,Qt=0|k(0|Ct,0|Pt,0|Et,0|Zt),i[(Zt=Xt)>>2]=Qt,i[Zt+4>>2]=l,Zt=0|k(0|wt,0|Mt,0|_t,0|tr),i[(tr=er)>>2]=Zt,i[tr+4>>2]=l,tr=0|k(0|Rt,0|Dt,0|bt,0|ar),i[(ar=rr)>>2]=tr,i[ar+4>>2]=l,ar=0|k(0|Lt,0|kt,0|Ot,0|nr),i[(nr=ir)>>2]=ar,i[nr+4>>2]=l,nr=0|k(0|Gt,0|Ft,0|It,0|or),i[(or=sr)>>2]=nr,i[or+4>>2]=l,or=0|k(0|Bt,0|Yt,0|Nt,0|dr),i[(dr=lr)>>2]=or,i[dr+4>>2]=l,dr=0|k(0|jt,0|Wt,0|Ut,0|cr),i[(cr=ur)>>2]=dr,i[cr+4>>2]=l,dr=0|i[(cr=at)>>2],ur=0|i[cr+4>>2],Wt=0|i[(Ut=cr=at+8|0)>>2],jt=0|i[Ut+4>>2],lr=0|i[(or=Ut=at+16|0)>>2],Nt=0|i[or+4>>2],Bt=0|i[(Yt=or=at+24|0)>>2],nr=0|i[Yt+4>>2],It=0|i[(sr=Yt=at+32|0)>>2],Ft=0|i[sr+4>>2],ar=0|i[(Gt=sr=at+40|0)>>2],ir=0|i[Gt+4>>2],kt=0|i[(Ot=Gt=at+48|0)>>2],Lt=0|i[Ot+4>>2],rr=0|i[(tr=Ot=at+56|0)>>2],bt=0|i[tr+4>>2],Rt=0|i[(Dt=tr=at+64|0)>>2],Zt=0|i[Dt+4>>2],_t=0|i[(er=Dt=at+72|0)>>2],Mt=0|i[er+4>>2],er=0|U(0|(wt=0|i[(er=nt)>>2]),0|(Qt=0|i[er+4>>2]),0|dr,0|ur),i[(Xt=at)>>2]=er,i[Xt+4>>2]=l,er=0|U(0|(Et=0|i[(er=Xt=nt+8|0)>>2]),0|(Pt=0|i[er+4>>2]),0|Wt,0|jt),i[(Ct=cr)>>2]=er,i[Ct+4>>2]=l,er=0|U(0|(cr=0|i[(er=Ct=nt+16|0)>>2]),0|(zt=0|i[er+4>>2]),0|lr,0|Nt),i[(Jt=Ut)>>2]=er,i[Jt+4>>2]=l,er=0|U(0|(Ut=0|i[(er=Jt=nt+24|0)>>2]),0|(vt=0|i[er+4>>2]),0|Bt,0|nr),i[(Tt=or)>>2]=er,i[Tt+4>>2]=l,er=0|U(0|(or=0|i[(er=Tt=nt+32|0)>>2]),0|(St=0|i[er+4>>2]),0|It,0|Ft),i[(Vt=Yt)>>2]=er,i[Vt+4>>2]=l,er=0|U(0|(Yt=0|i[(er=Vt=nt+40|0)>>2]),0|($t=0|i[er+4>>2]),0|ar,0|ir),i[(qt=sr)>>2]=er,i[qt+4>>2]=l,er=0|U(0|(sr=0|i[(er=qt=nt+48|0)>>2]),0|(ft=0|i[er+4>>2]),0|kt,0|Lt),i[(mt=Gt)>>2]=er,i[mt+4>>2]=l,er=0|U(0|(Gt=0|i[(er=mt=nt+56|0)>>2]),0|(pr=0|i[er+4>>2]),0|rr,0|bt),i[(Ht=Ot)>>2]=er,i[Ht+4>>2]=l,er=0|U(0|(Ot=0|i[(er=Ht=nt+64|0)>>2]),0|(yt=0|i[er+4>>2]),0|Rt,0|Zt),i[(gt=tr)>>2]=er,i[gt+4>>2]=l,er=0|U(0|(tr=0|i[(er=gt=nt+72|0)>>2]),0|(Kt=0|i[er+4>>2]),0|_t,0|Mt),i[(xt=Dt)>>2]=er,i[xt+4>>2]=l,xt=0|k(0|dr,0|ur,0|wt,0|Qt),i[(Qt=nt)>>2]=xt,i[Qt+4>>2]=l,Qt=0|k(0|Wt,0|jt,0|Et,0|Pt),i[(Pt=Xt)>>2]=Qt,i[Pt+4>>2]=l,Pt=0|k(0|lr,0|Nt,0|cr,0|zt),i[(zt=Ct)>>2]=Pt,i[zt+4>>2]=l,zt=0|k(0|Bt,0|nr,0|Ut,0|vt),i[(vt=Jt)>>2]=zt,i[vt+4>>2]=l,vt=0|k(0|It,0|Ft,0|or,0|St),i[(St=Tt)>>2]=vt,i[St+4>>2]=l,St=0|k(0|ar,0|ir,0|Yt,0|$t),i[($t=Vt)>>2]=St,i[$t+4>>2]=l,$t=0|k(0|kt,0|Lt,0|sr,0|ft),i[(ft=qt)>>2]=$t,i[ft+4>>2]=l,ft=0|k(0|rr,0|bt,0|Gt,0|pr),i[(pr=mt)>>2]=ft,i[pr+4>>2]=l,pr=0|k(0|Rt,0|Zt,0|Ot,0|yt),i[(yt=Ht)>>2]=pr,i[yt+4>>2]=l,yt=0|k(0|_t,0|Mt,0|tr,0|Kt),i[(Kt=gt)>>2]=yt,i[Kt+4>>2]=l,P(Oe,at,dt),P(we,ot,nt),yt=0|i[(Kt=$e)>>2],gt=0|i[Kt+4>>2],tr=0|i[(Kt=r)>>2],Mt=0|i[Kt+4>>2],Kt=0|B(0|yt,0|gt,18,0),_t=l,pr=0|U(0|tr,0|Mt,0|yt,0|gt),gt=0|U(0|pr,0|l,0|Kt,0|_t),i[(_t=r)>>2]=gt,i[_t+4>>2]=l,gt=0|i[(_t=Je)>>2],Kt=0|i[_t+4>>2],pr=0|i[(_t=ze)>>2],yt=0|i[_t+4>>2],_t=0|B(0|gt,0|Kt,18,0),Mt=l,tr=0|U(0|pr,0|yt,0|gt,0|Kt),Kt=0|U(0|tr,0|l,0|_t,0|Mt),i[(Mt=ze)>>2]=Kt,i[Mt+4>>2]=l,Kt=0|i[(Mt=qe)>>2],_t=0|i[Mt+4>>2],tr=0|i[(Mt=Ve)>>2],gt=0|i[Mt+4>>2],Mt=0|B(0|Kt,0|_t,18,0),yt=l,pr=0|U(0|tr,0|gt,0|Kt,0|_t),_t=0|U(0|pr,0|l,0|Mt,0|yt),i[(yt=Ve)>>2]=_t,i[yt+4>>2]=l,_t=0|i[(yt=He)>>2],Mt=0|i[yt+4>>2],pr=0|i[(yt=We)>>2],Kt=0|i[yt+4>>2],yt=0|B(0|_t,0|Mt,18,0),gt=l,tr=0|U(0|pr,0|Kt,0|_t,0|Mt),Mt=0|U(0|tr,0|l,0|yt,0|gt),i[(gt=We)>>2]=Mt,i[gt+4>>2]=l,Mt=0|i[(gt=p)>>2],yt=0|i[gt+4>>2],tr=0|i[(gt=h)>>2],_t=0|i[gt+4>>2],gt=0|B(0|Mt,0|yt,18,0),Kt=l,pr=0|U(0|tr,0|_t,0|Mt,0|yt),yt=0|U(0|pr,0|l,0|gt,0|Kt),i[(Kt=h)>>2]=yt,i[Kt+4>>2]=l,yt=0|i[(Kt=f)>>2],gt=0|i[Kt+4>>2],pr=0|i[(Kt=_)>>2],Mt=0|i[Kt+4>>2],Kt=0|B(0|yt,0|gt,18,0),_t=l,tr=0|U(0|pr,0|Mt,0|yt,0|gt),gt=0|U(0|tr,0|l,0|Kt,0|_t),i[(_t=_)>>2]=gt,i[_t+4>>2]=l,gt=0|i[(_t=m)>>2],Kt=0|i[_t+4>>2],tr=0|i[(_t=g)>>2],yt=0|i[_t+4>>2],_t=0|B(0|gt,0|Kt,18,0),Mt=l,pr=0|U(0|tr,0|yt,0|gt,0|Kt),Kt=0|U(0|pr,0|l,0|_t,0|Mt),i[(Mt=g)>>2]=Kt,i[Mt+4>>2]=l,Kt=0|i[(Mt=v)>>2],_t=0|i[Mt+4>>2],pr=0|i[(Mt=E)>>2],gt=0|i[Mt+4>>2],Mt=0|B(0|Kt,0|_t,18,0),yt=l,tr=0|U(0|pr,0|gt,0|Kt,0|_t),_t=0|U(0|tr,0|l,0|Mt,0|yt),i[(yt=E)>>2]=_t,i[yt+4>>2]=l,_t=0|i[(yt=y)>>2],Mt=0|i[yt+4>>2],tr=0|i[(yt=Oe)>>2],Kt=0|i[yt+4>>2],yt=0|B(0|_t,0|Mt,18,0),gt=l,pr=0|U(0|tr,0|Kt,0|_t,0|Mt),Mt=0|U(0|pr,0|l,0|yt,0|gt),gt=l,i[(yt=Oe)>>2]=Mt,i[yt+4>>2]=gt,i[(yt=y)>>2]=0,i[yt+4>>2]=0,yt=gt,gt=Mt,Mt=0;do{tr=0|k(0|gt,0|yt,0|(Kt=0|x(0|(_t=0|L(0|(pr=0|U(yt>>31>>>6|0,0,0|gt,0|yt)),0|l,26)),0|(pr=l),26)),0|l),i[(Kt=Oe+(Mt<<3)|0)>>2]=tr,i[Kt+4>>2]=l,Zt=0|k(0|(Ht=0|U(0|_t,0|pr,0|i[(tr=Kt=Oe+((1|Mt)<<3)|0)>>2],0|i[tr+4>>2])),0|(tr=l),0|(Ot=0|x(0|(_t=0|L(0|(pr=0|U(tr>>31>>>7|0,0,0|Ht,0|tr)),0|l,25)),0|(pr=l),25)),0|l),i[(Ot=Kt)>>2]=Zt,i[Ot+4>>2]=l,gt=0|U(0|_t,0|pr,0|i[(Zt=Ot=Oe+((Mt=Mt+2|0)<<3)|0)>>2],0|i[Zt+4>>2]),yt=l,i[(Zt=Ot)>>2]=gt,i[Zt+4>>2]=yt}while(Mt>>>0<10);yt=0|i[(Mt=y)>>2],gt=0|i[Mt+4>>2],Zt=0|i[(Mt=Oe)>>2],Ot=0|i[Mt+4>>2],Mt=0|B(0|yt,0|gt,18,0),pr=l,_t=0|U(0|Zt,0|Ot,0|yt,0|gt),gt=0|U(0|_t,0|l,0|Mt,0|pr),pr=l,i[(Mt=y)>>2]=0,i[Mt+4>>2]=0,Ot=0|k(0|gt,0|pr,0|(yt=0|x(0|(_t=0|L(0|(Mt=0|U(pr>>31>>>6|0,0,0|gt,0|pr)),0|l,26)),0|(Mt=l),26)),0|l),yt=l,i[(pr=Oe)>>2]=Ot,i[pr+4>>2]=yt,gt=0|U(0|_t,0|Mt,0|i[(pr=E)>>2],0|i[pr+4>>2]),pr=l,i[(Mt=E)>>2]=gt,i[Mt+4>>2]=pr,_t=0|i[(Mt=S)>>2],Zt=0|i[Mt+4>>2],Kt=0|i[(Mt=T)>>2],tr=0|i[Mt+4>>2],Mt=0|B(0|_t,0|Zt,18,0),Ht=l,Rt=0|U(0|Kt,0|tr,0|_t,0|Zt),Zt=0|U(0|Rt,0|l,0|Mt,0|Ht),i[(Ht=T)>>2]=Zt,i[Ht+4>>2]=l,Zt=0|i[(Ht=A)>>2],Mt=0|i[Ht+4>>2],Rt=0|i[(Ht=b)>>2],_t=0|i[Ht+4>>2],Ht=0|B(0|Zt,0|Mt,18,0),tr=l,Kt=0|U(0|Rt,0|_t,0|Zt,0|Mt),Mt=0|U(0|Kt,0|l,0|Ht,0|tr),i[(tr=b)>>2]=Mt,i[tr+4>>2]=l,Mt=0|i[(tr=w)>>2],Ht=0|i[tr+4>>2],Kt=0|i[(tr=M)>>2],Zt=0|i[tr+4>>2],tr=0|B(0|Mt,0|Ht,18,0),_t=l,Rt=0|U(0|Kt,0|Zt,0|Mt,0|Ht),Ht=0|U(0|Rt,0|l,0|tr,0|_t),i[(_t=M)>>2]=Ht,i[_t+4>>2]=l,Ht=0|i[(_t=I)>>2],tr=0|i[_t+4>>2],Rt=0|i[(_t=R)>>2],Mt=0|i[_t+4>>2],_t=0|B(0|Ht,0|tr,18,0),Zt=l,Kt=0|U(0|Rt,0|Mt,0|Ht,0|tr),tr=0|U(0|Kt,0|l,0|_t,0|Zt),i[(Zt=R)>>2]=tr,i[Zt+4>>2]=l,tr=0|i[(Zt=D)>>2],_t=0|i[Zt+4>>2],Kt=0|i[(Zt=N)>>2],Ht=0|i[Zt+4>>2],Zt=0|B(0|tr,0|_t,18,0),Mt=l,Rt=0|U(0|Kt,0|Ht,0|tr,0|_t),_t=0|U(0|Rt,0|l,0|Zt,0|Mt),i[(Mt=N)>>2]=_t,i[Mt+4>>2]=l,_t=0|i[(Mt=Y)>>2],Zt=0|i[Mt+4>>2],Rt=0|i[(Mt=K)>>2],tr=0|i[Mt+4>>2],Mt=0|B(0|_t,0|Zt,18,0),Ht=l,Kt=0|U(0|Rt,0|tr,0|_t,0|Zt),Zt=0|U(0|Kt,0|l,0|Mt,0|Ht),i[(Ht=K)>>2]=Zt,i[Ht+4>>2]=l,Zt=0|i[(Ht=j)>>2],Mt=0|i[Ht+4>>2],Kt=0|i[(Ht=W)>>2],_t=0|i[Ht+4>>2],Ht=0|B(0|Zt,0|Mt,18,0),tr=l,Rt=0|U(0|Kt,0|_t,0|Zt,0|Mt),Mt=0|U(0|Rt,0|l,0|Ht,0|tr),i[(tr=W)>>2]=Mt,i[tr+4>>2]=l,Mt=0|i[(tr=H)>>2],Ht=0|i[tr+4>>2],Rt=0|i[(tr=V)>>2],Zt=0|i[tr+4>>2],tr=0|B(0|Mt,0|Ht,18,0),_t=l,Kt=0|U(0|Rt,0|Zt,0|Mt,0|Ht),Ht=0|U(0|Kt,0|l,0|tr,0|_t),i[(_t=V)>>2]=Ht,i[_t+4>>2]=l,Ht=0|i[(_t=$)>>2],tr=0|i[_t+4>>2],Kt=0|i[(_t=we)>>2],Mt=0|i[_t+4>>2],_t=0|B(0|Ht,0|tr,18,0),Zt=l,Rt=0|U(0|Kt,0|Mt,0|Ht,0|tr),tr=0|U(0|Rt,0|l,0|_t,0|Zt),Zt=l,i[(_t=we)>>2]=tr,i[_t+4>>2]=Zt,i[(_t=$)>>2]=0,i[_t+4>>2]=0,_t=Zt,Zt=tr,tr=0;do{Kt=0|k(0|Zt,0|_t,0|(Mt=0|x(0|(Ht=0|L(0|(Rt=0|U(_t>>31>>>6|0,0,0|Zt,0|_t)),0|l,26)),0|(Rt=l),26)),0|l),i[(Mt=we+(tr<<3)|0)>>2]=Kt,i[Mt+4>>2]=l,Gt=0|k(0|(ft=0|U(0|Ht,0|Rt,0|i[(Kt=Mt=we+((1|tr)<<3)|0)>>2],0|i[Kt+4>>2])),0|(Kt=l),0|(mt=0|x(0|(Ht=0|L(0|(Rt=0|U(Kt>>31>>>7|0,0,0|ft,0|Kt)),0|l,25)),0|(Rt=l),25)),0|l),i[(mt=Mt)>>2]=Gt,i[mt+4>>2]=l,Zt=0|U(0|Ht,0|Rt,0|i[(Gt=mt=we+((tr=tr+2|0)<<3)|0)>>2],0|i[Gt+4>>2]),_t=l,i[(Gt=mt)>>2]=Zt,i[Gt+4>>2]=_t}while(tr>>>0<10);_t=0|i[(tr=$)>>2],Zt=0|i[tr+4>>2],Gt=0|i[(tr=we)>>2],mt=0|i[tr+4>>2],tr=0|B(0|_t,0|Zt,18,0),Rt=l,Ht=0|U(0|Gt,0|mt,0|_t,0|Zt),Zt=0|U(0|Ht,0|l,0|tr,0|Rt),Rt=l,i[(tr=$)>>2]=0,i[tr+4>>2]=0,mt=0|k(0|Zt,0|Rt,0|(_t=0|x(0|(Ht=0|L(0|(tr=0|U(Rt>>31>>>6|0,0,0|Zt,0|Rt)),0|l,26)),0|(tr=l),26)),0|l),_t=l,Zt=0|U(0|Ht,0|tr,0|i[(Rt=V)>>2],0|i[Rt+4>>2]),Rt=l,Ht=0|i[(tr=g)>>2],Gt=0|i[tr+4>>2],Mt=0|i[(tr=_)>>2],Kt=0|i[tr+4>>2],ft=0|i[(tr=h)>>2],bt=0|i[tr+4>>2],rr=0|i[(tr=We)>>2],$t=0|i[tr+4>>2],qt=0|i[(tr=Ve)>>2],sr=0|i[tr+4>>2],Lt=0|i[(tr=ze)>>2],kt=0|i[tr+4>>2],St=0|i[(tr=r)>>2],Vt=0|i[tr+4>>2],Yt=0|i[(tr=q)>>2],ir=0|i[tr+4>>2],tr=0|U(0|mt,0|_t,0|Ot,0|yt),i[(ar=Oe)>>2]=tr,i[ar+4>>2]=l,ar=0|U(0|Zt,0|Rt,0|gt,0|pr),i[(tr=E)>>2]=ar,i[tr+4>>2]=l,tr=0|U(0|(ar=0|i[(tr=W)>>2]),0|(vt=0|i[tr+4>>2]),0|Ht,0|Gt),i[(Tt=g)>>2]=tr,i[Tt+4>>2]=l,Tt=0|U(0|(tr=0|i[(Tt=K)>>2]),0|(or=0|i[Tt+4>>2]),0|Mt,0|Kt),i[(Ft=_)>>2]=Tt,i[Ft+4>>2]=l,Ft=0|U(0|(Tt=0|i[(Ft=N)>>2]),0|(It=0|i[Ft+4>>2]),0|ft,0|bt),i[(zt=h)>>2]=Ft,i[zt+4>>2]=l,zt=0|U(0|(Ft=0|i[(zt=R)>>2]),0|(Jt=0|i[zt+4>>2]),0|rr,0|$t),i[(Ut=We)>>2]=zt,i[Ut+4>>2]=l,Ut=0|U(0|(zt=0|i[(Ut=M)>>2]),0|(nr=0|i[Ut+4>>2]),0|qt,0|sr),i[(Bt=Ve)>>2]=Ut,i[Bt+4>>2]=l,Bt=0|U(0|(Ut=0|i[(Bt=b)>>2]),0|(Pt=0|i[Bt+4>>2]),0|Lt,0|kt),i[(Ct=ze)>>2]=Bt,i[Ct+4>>2]=l,Ct=0|U(0|(Bt=0|i[(Ct=T)>>2]),0|(cr=0|i[Ct+4>>2]),0|St,0|Vt),i[(Nt=r)>>2]=Ct,i[Nt+4>>2]=l,Nt=0|U(0|(Ct=0|i[(Nt=z)>>2]),0|(lr=0|i[Nt+4>>2]),0|Yt,0|ir),i[(Qt=q)>>2]=Nt,i[Qt+4>>2]=l,Qt=0|k(0|Ot,0|yt,0|mt,0|_t),i[(_t=we)>>2]=Qt,i[_t+4>>2]=l,_t=0|k(0|gt,0|pr,0|Zt,0|Rt),i[(Rt=V)>>2]=_t,i[Rt+4>>2]=l,Rt=0|k(0|Ht,0|Gt,0|ar,0|vt),i[(vt=W)>>2]=Rt,i[vt+4>>2]=l,vt=0|k(0|Mt,0|Kt,0|tr,0|or),i[(or=K)>>2]=vt,i[or+4>>2]=l,or=0|k(0|ft,0|bt,0|Tt,0|It),i[(It=N)>>2]=or,i[It+4>>2]=l,It=0|k(0|rr,0|$t,0|Ft,0|Jt),i[(Jt=R)>>2]=It,i[Jt+4>>2]=l,Jt=0|k(0|qt,0|sr,0|zt,0|nr),i[(nr=M)>>2]=Jt,i[nr+4>>2]=l,nr=0|k(0|Lt,0|kt,0|Ut,0|Pt),i[(Pt=b)>>2]=nr,i[Pt+4>>2]=l,Pt=0|k(0|St,0|Vt,0|Bt,0|cr),i[(cr=T)>>2]=Pt,i[cr+4>>2]=l,cr=0|k(0|Yt,0|ir,0|Ct,0|lr),i[(lr=z)>>2]=cr,i[lr+4>>2]=l,O(Ie,Oe),O(Me,we),P(we,Me,u),cr=0|i[(lr=S)>>2],Ct=0|i[lr+4>>2],ir=0|i[(lr=T)>>2],Yt=0|i[lr+4>>2],lr=0|B(0|cr,0|Ct,18,0),Pt=l,Bt=0|U(0|ir,0|Yt,0|cr,0|Ct),Ct=0|U(0|Bt,0|l,0|lr,0|Pt),i[(Pt=T)>>2]=Ct,i[Pt+4>>2]=l,Ct=0|i[(Pt=A)>>2],lr=0|i[Pt+4>>2],Bt=0|i[(Pt=b)>>2],cr=0|i[Pt+4>>2],Pt=0|B(0|Ct,0|lr,18,0),Yt=l,ir=0|U(0|Bt,0|cr,0|Ct,0|lr),lr=0|U(0|ir,0|l,0|Pt,0|Yt),i[(Yt=b)>>2]=lr,i[Yt+4>>2]=l,lr=0|i[(Yt=w)>>2],Pt=0|i[Yt+4>>2],ir=0|i[(Yt=M)>>2],Ct=0|i[Yt+4>>2],Yt=0|B(0|lr,0|Pt,18,0),cr=l,Bt=0|U(0|ir,0|Ct,0|lr,0|Pt),Pt=0|U(0|Bt,0|l,0|Yt,0|cr),i[(cr=M)>>2]=Pt,i[cr+4>>2]=l,Pt=0|i[(cr=I)>>2],Yt=0|i[cr+4>>2],Bt=0|i[(cr=R)>>2],lr=0|i[cr+4>>2],cr=0|B(0|Pt,0|Yt,18,0),Ct=l,ir=0|U(0|Bt,0|lr,0|Pt,0|Yt),Yt=0|U(0|ir,0|l,0|cr,0|Ct),i[(Ct=R)>>2]=Yt,i[Ct+4>>2]=l,Yt=0|i[(Ct=D)>>2],cr=0|i[Ct+4>>2],ir=0|i[(Ct=N)>>2],Pt=0|i[Ct+4>>2],Ct=0|B(0|Yt,0|cr,18,0),lr=l,Bt=0|U(0|ir,0|Pt,0|Yt,0|cr),cr=0|U(0|Bt,0|l,0|Ct,0|lr),i[(lr=N)>>2]=cr,i[lr+4>>2]=l,cr=0|i[(lr=Y)>>2],Ct=0|i[lr+4>>2],Bt=0|i[(lr=K)>>2],Yt=0|i[lr+4>>2],lr=0|B(0|cr,0|Ct,18,0),Pt=l,ir=0|U(0|Bt,0|Yt,0|cr,0|Ct),Ct=0|U(0|ir,0|l,0|lr,0|Pt),i[(Pt=K)>>2]=Ct,i[Pt+4>>2]=l,Ct=0|i[(Pt=j)>>2],lr=0|i[Pt+4>>2],ir=0|i[(Pt=W)>>2],cr=0|i[Pt+4>>2],Pt=0|B(0|Ct,0|lr,18,0),Yt=l,Bt=0|U(0|ir,0|cr,0|Ct,0|lr),lr=0|U(0|Bt,0|l,0|Pt,0|Yt),i[(Yt=W)>>2]=lr,i[Yt+4>>2]=l,lr=0|i[(Yt=H)>>2],Pt=0|i[Yt+4>>2],Bt=0|i[(Yt=V)>>2],Ct=0|i[Yt+4>>2],Yt=0|B(0|lr,0|Pt,18,0),cr=l,ir=0|U(0|Bt,0|Ct,0|lr,0|Pt),Pt=0|U(0|ir,0|l,0|Yt,0|cr),i[(cr=V)>>2]=Pt,i[cr+4>>2]=l,Pt=0|i[(cr=$)>>2],Yt=0|i[cr+4>>2],ir=0|i[(cr=we)>>2],lr=0|i[cr+4>>2],cr=0|B(0|Pt,0|Yt,18,0),Ct=l,Bt=0|U(0|ir,0|lr,0|Pt,0|Yt),Yt=0|U(0|Bt,0|l,0|cr,0|Ct),Ct=l,i[(cr=we)>>2]=Yt,i[cr+4>>2]=Ct,i[(cr=$)>>2]=0,i[cr+4>>2]=0,cr=Ct,Ct=Yt,Yt=0;do{ir=0|k(0|Ct,0|cr,0|(lr=0|x(0|(Pt=0|L(0|(Bt=0|U(cr>>31>>>6|0,0,0|Ct,0|cr)),0|l,26)),0|(Bt=l),26)),0|l),i[(lr=we+(Yt<<3)|0)>>2]=ir,i[lr+4>>2]=l,nr=0|k(0|(Vt=0|U(0|Pt,0|Bt,0|i[(ir=lr=we+((1|Yt)<<3)|0)>>2],0|i[ir+4>>2])),0|(ir=l),0|(St=0|x(0|(Pt=0|L(0|(Bt=0|U(ir>>31>>>7|0,0,0|Vt,0|ir)),0|l,25)),0|(Bt=l),25)),0|l),i[(St=lr)>>2]=nr,i[St+4>>2]=l,Ct=0|U(0|Pt,0|Bt,0|i[(nr=St=we+((Yt=Yt+2|0)<<3)|0)>>2],0|i[nr+4>>2]),cr=l,i[(nr=St)>>2]=Ct,i[nr+4>>2]=cr}while(Yt>>>0<10);cr=0|i[(Yt=$)>>2],Ct=0|i[Yt+4>>2],pr=0|i[(Yt=we)>>2],gt=0|i[Yt+4>>2],Yt=0|B(0|cr,0|Ct,18,0),yt=l,Ot=0|U(0|pr,0|gt,0|cr,0|Ct),Ct=0|U(0|Ot,0|l,0|Yt,0|yt),yt=l,i[(Yt=$)>>2]=0,i[Yt+4>>2]=0,gt=0|k(0|Ct,0|yt,0|(cr=0|x(0|(Ot=0|L(0|(Yt=0|U(yt>>31>>>6|0,0,0|Ct,0|yt)),0|l,26)),0|(Yt=l),26)),0|l),i[(cr=we)>>2]=gt,i[cr+4>>2]=l,gt=0|U(0|Ot,0|Yt,0|i[(cr=V)>>2],0|i[cr+4>>2]),i[(cr=V)>>2]=gt,i[cr+4>>2]=l,je=Ie,t=(Ke=it)+80|0;do{i[Ke>>2]=i[je>>2],Ke=Ke+4|0,je=je+4|0}while((0|Ke)<(0|t));je=we,t=(Ke=st)+80|0;do{i[Ke>>2]=i[je>>2],Ke=Ke+4|0,je=je+4|0}while((0|Ke)<(0|t));O(Ce,ot),O(Pe,dt),P(lt,Ce,Pe),gt=0|i[(cr=lt+144|0)>>2],Yt=0|i[cr+4>>2],yt=0|i[(Ot=cr=lt+64|0)>>2],Ct=0|i[Ot+4>>2],Ot=0|B(0|gt,0|Yt,18,0),pr=l,nr=0|U(0|yt,0|Ct,0|gt,0|Yt),Yt=0|U(0|nr,0|l,0|Ot,0|pr),i[(pr=cr)>>2]=Yt,i[pr+4>>2]=l,Yt=0|i[(pr=lt+136|0)>>2],cr=0|i[pr+4>>2],nr=0|i[(Ot=pr=lt+56|0)>>2],gt=0|i[Ot+4>>2],Ot=0|B(0|Yt,0|cr,18,0),Ct=l,yt=0|U(0|nr,0|gt,0|Yt,0|cr),cr=0|U(0|yt,0|l,0|Ot,0|Ct),i[(Ct=pr)>>2]=cr,i[Ct+4>>2]=l,cr=0|i[(Ct=lt+128|0)>>2],pr=0|i[Ct+4>>2],yt=0|i[(Ot=Ct=lt+48|0)>>2],Yt=0|i[Ot+4>>2],Ot=0|B(0|cr,0|pr,18,0),gt=l,nr=0|U(0|yt,0|Yt,0|cr,0|pr),pr=0|U(0|nr,0|l,0|Ot,0|gt),i[(gt=Ct)>>2]=pr,i[gt+4>>2]=l,pr=0|i[(gt=lt+120|0)>>2],Ct=0|i[gt+4>>2],nr=0|i[(Ot=gt=lt+40|0)>>2],cr=0|i[Ot+4>>2],Ot=0|B(0|pr,0|Ct,18,0),Yt=l,yt=0|U(0|nr,0|cr,0|pr,0|Ct),Ct=0|U(0|yt,0|l,0|Ot,0|Yt),i[(Yt=gt)>>2]=Ct,i[Yt+4>>2]=l,Ct=0|i[(Yt=lt+112|0)>>2],gt=0|i[Yt+4>>2],yt=0|i[(Ot=Yt=lt+32|0)>>2],pr=0|i[Ot+4>>2],Ot=0|B(0|Ct,0|gt,18,0),cr=l,nr=0|U(0|yt,0|pr,0|Ct,0|gt),gt=0|U(0|nr,0|l,0|Ot,0|cr),i[(cr=Yt)>>2]=gt,i[cr+4>>2]=l,gt=0|i[(cr=lt+104|0)>>2],Yt=0|i[cr+4>>2],nr=0|i[(Ot=cr=lt+24|0)>>2],Ct=0|i[Ot+4>>2],Ot=0|B(0|gt,0|Yt,18,0),pr=l,yt=0|U(0|nr,0|Ct,0|gt,0|Yt),Yt=0|U(0|yt,0|l,0|Ot,0|pr),i[(pr=cr)>>2]=Yt,i[pr+4>>2]=l,Yt=0|i[(pr=lt+96|0)>>2],cr=0|i[pr+4>>2],yt=0|i[(Ot=pr=lt+16|0)>>2],gt=0|i[Ot+4>>2],Ot=0|B(0|Yt,0|cr,18,0),Ct=l,nr=0|U(0|yt,0|gt,0|Yt,0|cr),cr=0|U(0|nr,0|l,0|Ot,0|Ct),i[(Ct=pr)>>2]=cr,i[Ct+4>>2]=l,cr=0|i[(Ct=lt+88|0)>>2],pr=0|i[Ct+4>>2],nr=0|i[(Ot=Ct=lt+8|0)>>2],Yt=0|i[Ot+4>>2],Ot=0|B(0|cr,0|pr,18,0),gt=l,yt=0|U(0|nr,0|Yt,0|cr,0|pr),pr=0|U(0|yt,0|l,0|Ot,0|gt),i[(gt=Ct)>>2]=pr,i[gt+4>>2]=l,Ot=0|i[(pr=gt=lt+80|0)>>2],yt=0|i[pr+4>>2],cr=0|i[(pr=lt)>>2],Yt=0|i[pr+4>>2],pr=0|B(0|Ot,0|yt,18,0),nr=l,St=0|U(0|cr,0|Yt,0|Ot,0|yt),yt=0|U(0|St,0|l,0|pr,0|nr),nr=l,i[(pr=lt)>>2]=yt,i[pr+4>>2]=nr,i[(pr=gt)>>2]=0,i[pr+4>>2]=0,pr=nr,nr=yt,yt=0;do{cr=0|k(0|nr,0|pr,0|(Yt=0|x(0|(Ot=0|L(0|(St=0|U(pr>>31>>>6|0,0,0|nr,0|pr)),0|l,26)),0|(St=l),26)),0|l),i[(Yt=lt+(yt<<3)|0)>>2]=cr,i[Yt+4>>2]=l,lr=0|k(0|(Bt=0|U(0|Ot,0|St,0|i[(cr=Yt=lt+((1|yt)<<3)|0)>>2],0|i[cr+4>>2])),0|(cr=l),0|(Pt=0|x(0|(Ot=0|L(0|(St=0|U(cr>>31>>>7|0,0,0|Bt,0|cr)),0|l,25)),0|(St=l),25)),0|l),i[(Pt=Yt)>>2]=lr,i[Pt+4>>2]=l,nr=0|U(0|Ot,0|St,0|i[(lr=Pt=lt+((yt=yt+2|0)<<3)|0)>>2],0|i[lr+4>>2]),pr=l,i[(lr=Pt)>>2]=nr,i[lr+4>>2]=pr}while(yt>>>0<10);pr=0|i[(yt=gt)>>2],nr=0|i[yt+4>>2],lr=0|i[(yt=lt)>>2],Pt=0|i[yt+4>>2],yt=0|B(0|pr,0|nr,18,0),St=l,Ot=0|U(0|lr,0|Pt,0|pr,0|nr),nr=0|U(0|Ot,0|l,0|yt,0|St),St=l,i[(yt=gt)>>2]=0,i[yt+4>>2]=0,Pt=0|k(0|nr,0|St,0|(pr=0|x(0|(Ot=0|L(0|(yt=0|U(St>>31>>>6|0,0,0|nr,0|St)),0|l,26)),0|(yt=l),26)),0|l),i[(pr=lt)>>2]=Pt,i[pr+4>>2]=l,Pt=0|U(0|Ot,0|yt,0|i[(pr=Ct)>>2],0|i[pr+4>>2]),i[(pr=Ct)>>2]=Pt,i[pr+4>>2]=l,Ot=0|k(0|(Pt=0|i[(pr=Ce)>>2]),0|(yt=0|i[pr+4>>2]),0|i[(pr=Pe)>>2],0|i[pr+4>>2]),pr=l,i[(St=Pe)>>2]=Ot,i[St+4>>2]=pr,Yt=0|k(0|(nr=0|i[(St=J)>>2]),0|(lr=0|i[St+4>>2]),0|i[(St=Q)>>2],0|i[St+4>>2]),St=l,i[(cr=Q)>>2]=Yt,i[cr+4>>2]=St,Vt=0|k(0|(Bt=0|i[(cr=X)>>2]),0|(ir=0|i[cr+4>>2]),0|i[(cr=Z)>>2],0|i[cr+4>>2]),cr=l,i[(Ut=Z)>>2]=Vt,i[Ut+4>>2]=cr,Jt=0|k(0|(kt=0|i[(Ut=ee)>>2]),0|(Lt=0|i[Ut+4>>2]),0|i[(Ut=te)>>2],0|i[Ut+4>>2]),Ut=l,i[(zt=te)>>2]=Jt,i[zt+4>>2]=Ut,It=0|k(0|(sr=0|i[(zt=re)>>2]),0|(qt=0|i[zt+4>>2]),0|i[(zt=ae)>>2],0|i[zt+4>>2]),zt=l,i[(Ft=ae)>>2]=It,i[Ft+4>>2]=zt,or=0|k(0|($t=0|i[(Ft=ie)>>2]),0|(rr=0|i[Ft+4>>2]),0|i[(Ft=ne)>>2],0|i[Ft+4>>2]),Ft=l,i[(Tt=ne)>>2]=or,i[Tt+4>>2]=Ft,vt=0|k(0|(bt=0|i[(Tt=se)>>2]),0|(ft=0|i[Tt+4>>2]),0|i[(Tt=oe)>>2],0|i[Tt+4>>2]),Tt=l,i[(tr=oe)>>2]=vt,i[tr+4>>2]=Tt,Rt=0|k(0|(Kt=0|i[(tr=le)>>2]),0|(Mt=0|i[tr+4>>2]),0|i[(tr=de)>>2],0|i[tr+4>>2]),tr=l,i[(ar=de)>>2]=Rt,i[ar+4>>2]=tr,_t=0|k(0|(Gt=0|i[(ar=ue)>>2]),0|(Ht=0|i[ar+4>>2]),0|i[(ar=ce)>>2],0|i[ar+4>>2]),ar=l,i[(Zt=ce)>>2]=_t,i[Zt+4>>2]=ar,Nt=0|k(0|(Qt=0|i[(Zt=pe)>>2]),0|(mt=0|i[Zt+4>>2]),0|i[(Zt=he)>>2],0|i[Zt+4>>2]),Zt=l,i[(Xt=he)>>2]=Nt,i[Xt+4>>2]=Zt,t=(Ke=fe)+72|0;do{i[Ke>>2]=0,Ke=Ke+4|0}while((0|Ke)<(0|t));Ct=0|B(0|Ot,0|pr,121665,0),gt=l,i[(Xt=be)>>2]=Ct,i[Xt+4>>2]=gt,Xt=0|B(0|Yt,0|St,121665,0),i[(Et=_e)>>2]=Xt,i[Et+4>>2]=l,Et=0|B(0|Vt,0|cr,121665,0),i[(Xt=me)>>2]=Et,i[Xt+4>>2]=l,Xt=0|B(0|Jt,0|Ut,121665,0),i[(Et=ge)>>2]=Xt,i[Et+4>>2]=l,Et=0|B(0|It,0|zt,121665,0),i[(Xt=ve)>>2]=Et,i[Xt+4>>2]=l,Xt=0|B(0|or,0|Ft,121665,0),i[(Et=Ee)>>2]=Xt,i[Et+4>>2]=l,Et=0|B(0|vt,0|Tt,121665,0),i[(Xt=ye)>>2]=Et,i[Xt+4>>2]=l,Xt=0|B(0|Rt,0|tr,121665,0),i[(Et=Se)>>2]=Xt,i[Et+4>>2]=l,Et=0|B(0|_t,0|ar,121665,0),i[(Xt=Te)>>2]=Et,i[Xt+4>>2]=l,Xt=0|B(0|Nt,0|Zt,121665,0),i[(Et=Ae)>>2]=Xt,i[Et+4>>2]=l,i[(Et=fe)>>2]=0,i[Et+4>>2]=0,Et=gt,gt=Ct,Ct=0;do{xt=0|k(0|gt,0|Et,0|(Wt=0|x(0|(jt=0|L(0|(Xt=0|U(Et>>31>>>6|0,0,0|gt,0|Et)),0|l,26)),0|(Xt=l),26)),0|l),i[(Wt=be+(Ct<<3)|0)>>2]=xt,i[Wt+4>>2]=l,dr=0|k(0|(wt=0|U(0|jt,0|Xt,0|i[(xt=Wt=be+((1|Ct)<<3)|0)>>2],0|i[xt+4>>2])),0|(xt=l),0|(ur=0|x(0|(jt=0|L(0|(Xt=0|U(xt>>31>>>7|0,0,0|wt,0|xt)),0|l,25)),0|(Xt=l),25)),0|l),i[(ur=Wt)>>2]=dr,i[ur+4>>2]=l,gt=0|U(0|jt,0|Xt,0|i[(dr=ur=be+((Ct=Ct+2|0)<<3)|0)>>2],0|i[dr+4>>2]),Et=l,i[(dr=ur)>>2]=gt,i[dr+4>>2]=Et}while(Ct>>>0<10);Et=0|i[(Ct=fe)>>2],gt=0|i[Ct+4>>2],Zt=0|i[(Ct=be)>>2],Nt=0|i[Ct+4>>2],Ct=0|B(0|Et,0|gt,18,0),ar=l,_t=0|U(0|Zt,0|Nt,0|Et,0|gt),gt=0|U(0|_t,0|l,0|Ct,0|ar),ar=l,i[(Ct=fe)>>2]=0,i[Ct+4>>2]=0,Et=0|x(0|(_t=0|L(0|(Ct=0|U(ar>>31>>>6|0,0,0|gt,0|ar)),0|l,26)),0|(Ct=l),26),Nt=l,tr=0|i[(Zt=_e)>>2],Rt=0|i[Zt+4>>2],ar=0|k(0|(Zt=0|U(0|gt,0|ar,0|Pt,0|yt)),0|l,0|Et,0|Nt),i[(Nt=be)>>2]=ar,i[Nt+4>>2]=l,Nt=0|U(0|tr,0|Rt,0|nr,0|lr),Rt=0|U(0|Nt,0|l,0|_t,0|Ct),i[(Ct=_e)>>2]=Rt,i[Ct+4>>2]=l,Rt=0|U(0|i[(Ct=me)>>2],0|i[Ct+4>>2],0|Bt,0|ir),i[(Ct=me)>>2]=Rt,i[Ct+4>>2]=l,Rt=0|U(0|i[(Ct=ge)>>2],0|i[Ct+4>>2],0|kt,0|Lt),i[(Ct=ge)>>2]=Rt,i[Ct+4>>2]=l,Rt=0|U(0|i[(Ct=ve)>>2],0|i[Ct+4>>2],0|sr,0|qt),i[(Ct=ve)>>2]=Rt,i[Ct+4>>2]=l,Rt=0|U(0|i[(Ct=Ee)>>2],0|i[Ct+4>>2],0|$t,0|rr),i[(Ct=Ee)>>2]=Rt,i[Ct+4>>2]=l,Rt=0|U(0|i[(Ct=ye)>>2],0|i[Ct+4>>2],0|bt,0|ft),i[(Ct=ye)>>2]=Rt,i[Ct+4>>2]=l,Rt=0|U(0|i[(Ct=Se)>>2],0|i[Ct+4>>2],0|Kt,0|Mt),i[(Ct=Se)>>2]=Rt,i[Ct+4>>2]=l,Rt=0|U(0|i[(Ct=Te)>>2],0|i[Ct+4>>2],0|Gt,0|Ht),i[(Ct=Te)>>2]=Rt,i[Ct+4>>2]=l,Rt=0|U(0|i[(Ct=Ae)>>2],0|i[Ct+4>>2],0|Qt,0|mt),i[(Ct=Ae)>>2]=Rt,i[Ct+4>>2]=l,P(ut,Pe,be),Rt=0|i[(Ct=ut+144|0)>>2],_t=0|i[Ct+4>>2],tr=0|i[(Nt=Ct=ut+64|0)>>2],ar=0|i[Nt+4>>2],Nt=0|B(0|Rt,0|_t,18,0),Et=l,Zt=0|U(0|tr,0|ar,0|Rt,0|_t),_t=0|U(0|Zt,0|l,0|Nt,0|Et),i[(Et=Ct)>>2]=_t,i[Et+4>>2]=l,_t=0|i[(Et=ut+136|0)>>2],Ct=0|i[Et+4>>2],Zt=0|i[(Nt=Et=ut+56|0)>>2],Rt=0|i[Nt+4>>2],Nt=0|B(0|_t,0|Ct,18,0),ar=l,tr=0|U(0|Zt,0|Rt,0|_t,0|Ct),Ct=0|U(0|tr,0|l,0|Nt,0|ar),i[(ar=Et)>>2]=Ct,i[ar+4>>2]=l,Ct=0|i[(ar=ut+128|0)>>2],Et=0|i[ar+4>>2],tr=0|i[(Nt=ar=ut+48|0)>>2],_t=0|i[Nt+4>>2],Nt=0|B(0|Ct,0|Et,18,0),Rt=l,Zt=0|U(0|tr,0|_t,0|Ct,0|Et),Et=0|U(0|Zt,0|l,0|Nt,0|Rt),i[(Rt=ar)>>2]=Et,i[Rt+4>>2]=l,Et=0|i[(Rt=ut+120|0)>>2],ar=0|i[Rt+4>>2],Zt=0|i[(Nt=Rt=ut+40|0)>>2],Ct=0|i[Nt+4>>2],Nt=0|B(0|Et,0|ar,18,0),_t=l,tr=0|U(0|Zt,0|Ct,0|Et,0|ar),ar=0|U(0|tr,0|l,0|Nt,0|_t),i[(_t=Rt)>>2]=ar,i[_t+4>>2]=l,ar=0|i[(_t=ut+112|0)>>2],Rt=0|i[_t+4>>2],tr=0|i[(Nt=_t=ut+32|0)>>2],Et=0|i[Nt+4>>2],Nt=0|B(0|ar,0|Rt,18,0),Ct=l,Zt=0|U(0|tr,0|Et,0|ar,0|Rt),Rt=0|U(0|Zt,0|l,0|Nt,0|Ct),i[(Ct=_t)>>2]=Rt,i[Ct+4>>2]=l,Rt=0|i[(Ct=ut+104|0)>>2],_t=0|i[Ct+4>>2],Zt=0|i[(Nt=Ct=ut+24|0)>>2],ar=0|i[Nt+4>>2],Nt=0|B(0|Rt,0|_t,18,0),Et=l,tr=0|U(0|Zt,0|ar,0|Rt,0|_t),_t=0|U(0|tr,0|l,0|Nt,0|Et),i[(Et=Ct)>>2]=_t,i[Et+4>>2]=l,_t=0|i[(Et=ut+96|0)>>2],Ct=0|i[Et+4>>2],tr=0|i[(Nt=Et=ut+16|0)>>2],Rt=0|i[Nt+4>>2],Nt=0|B(0|_t,0|Ct,18,0),ar=l,Zt=0|U(0|tr,0|Rt,0|_t,0|Ct),Ct=0|U(0|Zt,0|l,0|Nt,0|ar),i[(ar=Et)>>2]=Ct,i[ar+4>>2]=l,Ct=0|i[(ar=ut+88|0)>>2],Et=0|i[ar+4>>2],Zt=0|i[(Nt=ar=ut+8|0)>>2],_t=0|i[Nt+4>>2],Nt=0|B(0|Ct,0|Et,18,0),Rt=l,tr=0|U(0|Zt,0|_t,0|Ct,0|Et),Et=0|U(0|tr,0|l,0|Nt,0|Rt),i[(Rt=ar)>>2]=Et,i[Rt+4>>2]=l,Nt=0|i[(Et=Rt=ut+80|0)>>2],tr=0|i[Et+4>>2],Ct=0|i[(Et=ut)>>2],_t=0|i[Et+4>>2],Et=0|B(0|Nt,0|tr,18,0),Zt=l,gt=0|U(0|Ct,0|_t,0|Nt,0|tr),tr=0|U(0|gt,0|l,0|Et,0|Zt),Zt=l,i[(Et=ut)>>2]=tr,i[Et+4>>2]=Zt,i[(Et=Rt)>>2]=0,i[Et+4>>2]=0,Et=Zt,Zt=tr,tr=0;do{Ct=0|k(0|Zt,0|Et,0|(_t=0|x(0|(Nt=0|L(0|(gt=0|U(Et>>31>>>6|0,0,0|Zt,0|Et)),0|l,26)),0|(gt=l),26)),0|l),i[(_t=ut+(tr<<3)|0)>>2]=Ct,i[_t+4>>2]=l,Ft=0|k(0|(Tt=0|U(0|Nt,0|gt,0|i[(Ct=_t=ut+((1|tr)<<3)|0)>>2],0|i[Ct+4>>2])),0|(Ct=l),0|(vt=0|x(0|(Nt=0|L(0|(gt=0|U(Ct>>31>>>7|0,0,0|Tt,0|Ct)),0|l,25)),0|(gt=l),25)),0|l),i[(vt=_t)>>2]=Ft,i[vt+4>>2]=l,Zt=0|U(0|Nt,0|gt,0|i[(Ft=vt=ut+((tr=tr+2|0)<<3)|0)>>2],0|i[Ft+4>>2]),Et=l,i[(Ft=vt)>>2]=Zt,i[Ft+4>>2]=Et}while(tr>>>0<10);Et=0|i[(tr=Rt)>>2],Zt=0|i[tr+4>>2],mt=0|i[(tr=ut)>>2],Qt=0|i[tr+4>>2],tr=0|B(0|Et,0|Zt,18,0),Ht=l,Gt=0|U(0|mt,0|Qt,0|Et,0|Zt),Zt=0|U(0|Gt,0|l,0|tr,0|Ht),Ht=l,i[(tr=Rt)>>2]=0,i[tr+4>>2]=0,Qt=0|k(0|Zt,0|Ht,0|(Et=0|x(0|(Gt=0|L(0|(tr=0|U(Ht>>31>>>6|0,0,0|Zt,0|Ht)),0|l,26)),0|(tr=l),26)),0|l),i[(Et=ut)>>2]=Qt,i[Et+4>>2]=l,Qt=0|U(0|Gt,0|tr,0|i[(Et=ar)>>2],0|i[Et+4>>2]),i[(Et=ar)>>2]=Qt,i[Et+4>>2]=l,Et=0;do{Gt=0|i[(tr=Qt=lt+(Et<<3)|0)>>2],Ht=0|i[tr+4>>2],mt=0|i[(Zt=tr=it+(Et<<3)|0)>>2],Kt=((Mt=0|i[Zt+4>>2])^Ht)&ht,Ht=0|L(0,(Zt=(mt^Gt)&pt)^Gt|0,32),i[(Gt=Qt)>>2]=Ht,i[Gt+4>>2]=l,Gt=0|L(0,Zt^mt|0,32),i[(mt=tr)>>2]=Gt,i[mt+4>>2]=l,Et=Et+1|0}while(10!=(0|Et));hr=0;do{Rt=0|i[(ar=Et=ut+(hr<<3)|0)>>2],mt=0|i[ar+4>>2],tr=0|i[(Gt=ar=st+(hr<<3)|0)>>2],Ht=((Zt=0|i[Gt+4>>2])^mt)&ht,mt=0|L(0,(Gt=(tr^Rt)&pt)^Rt|0,32),i[(Rt=Et)>>2]=mt,i[Rt+4>>2]=l,Rt=0|L(0,Gt^tr|0,32),i[(tr=ar)>>2]=Rt,i[tr+4>>2]=l,hr=hr+1|0}while(10!=(0|hr));if(8==(0|(rt=rt+1|0))){fr=at,_r=it,mr=nt,gr=st,vr=ot,Er=lt,yr=dt,Sr=ut;break}ht=ut,pt=lt,tr=st,Rt=it,Fe=ct<<1&255,ut=dt,dt=ht,lt=ot,ot=pt,st=nt,nt=tr,it=at,at=Rt}if(32==(0|(at=Qe+1|0))){Tr=Er,Ar=Sr;break}Qe=at,Xe=_r,Ze=fr,ke=gr,et=mr,Ue=Er,tt=vr,Ge=Sr,Le=yr}je=Tr,t=(Ke=xe)+80|0;do{i[Ke>>2]=i[je>>2],Ke=Ke+4|0,je=je+4|0}while((0|Ke)<(0|t));je=Ar,t=(Ke=Be)+80|0;do{i[Ke>>2]=i[je>>2],Ke=Ke+4|0,je=je+4|0}while((0|Ke)<(0|t));O(be,Be),O(Ne,be),O(De,Ne),C(Ce,De,Be),C(Pe,Ce,be),O(De,Pe),C(Oe,De,Ce),O(De,Oe),O(Ne,De),O(De,Ne),O(Ne,De),O(De,Ne),C(we,De,Oe),O(De,we),O(Ne,De),O(De,Ne),O(Ne,De),O(De,Ne),O(Ne,De),O(De,Ne),O(Ne,De),O(De,Ne),O(Ne,De),C(Me,Ne,we),O(De,Me),O(Ne,De),O(De,Ne),O(Ne,De),O(De,Ne),O(Ne,De),O(De,Ne),O(Ne,De),O(De,Ne),O(Ne,De),O(De,Ne),O(Ne,De),O(De,Ne),O(Ne,De),O(De,Ne),O(Ne,De),O(De,Ne),O(Ne,De),O(De,Ne),O(Ne,De),C(De,Ne,Me),O(Ne,De),O(De,Ne),O(Ne,De),O(De,Ne),O(Ne,De),O(De,Ne),O(Ne,De),O(De,Ne),O(Ne,De),O(De,Ne),C(Ie,De,we),O(De,Ie),O(Ne,De),we=2;do{O(De,Ne),O(Ne,De),we=we+2|0}while((0|we)<50);C(Re,Ne,Ie),O(Ne,Re),O(De,Ne),we=2;do{O(Ne,De),O(De,Ne),we=we+2|0}while((0|we)<100);C(Ne,De,Re),O(De,Ne),O(Ne,De),Re=2;do{O(De,Ne),O(Ne,De),Re=Re+2|0}while((0|Re)<50);for(C(De,Ne,Ie),O(Ne,De),O(De,Ne),O(Ne,De),O(De,Ne),O(Ne,De),C(Ye,Ne,Pe),C(Be,xe,Ye),Ye=0|i[Be>>2],i[be>>2]=Ye,i[(xe=be+4|0)>>2]=i[Be+8>>2],i[(Pe=be+8|0)>>2]=i[Be+16>>2],i[(Ne=be+12|0)>>2]=i[Be+24>>2],i[(De=be+16|0)>>2]=i[Be+32>>2],i[(Ie=be+20|0)>>2]=i[Be+40>>2],i[(Re=be+24|0)>>2]=i[Be+48>>2],i[(we=be+28|0)>>2]=i[Be+56>>2],i[(Me=be+32|0)>>2]=i[Be+64>>2],i[(Oe=be+36|0)>>2]=i[Be+72>>2],Be=Ye,Ye=0;Ce=be+(Ye<<2)|0,je=Be>>31&Be,1&Ye?(t=je>>25,i[Ce>>2]=(0|d(t,-33554432))+Be,Tr=(0|i[(je=be+((Ce=Ye+1|0)<<2)|0)>>2])+t|0,i[je>>2]=Tr,br=Tr,Cr=Ce):(Ke=je>>26,i[Ce>>2]=(0|d(Ke,-67108864))+Be,Tr=(0|i[(Ar=be+((t=Ye+1|0)<<2)|0)>>2])+Ke|0,i[Ar>>2]=Tr,br=Tr,Cr=t),9!=(0|Cr);)Be=br,Ye=Cr;for(Ye=((Cr=0|i[Oe>>2])>>31&Cr)>>25,i[Oe>>2]=(0|d(Ye,-33554432))+Cr,Cr=(19*Ye|0)+(0|i[be>>2])|0,i[be>>2]=Cr,Ye=Cr,Cr=0;br=be+(Cr<<2)|0,Be=Ye>>31&Ye,1&Cr?(t=Be>>25,i[br>>2]=(0|d(t,-33554432))+Ye,Tr=(0|i[(Be=be+((br=Cr+1|0)<<2)|0)>>2])+t|0,i[Be>>2]=Tr,Pr=br,Or=Tr):(Ce=Be>>26,i[br>>2]=(0|d(Ce,-67108864))+Ye,t=(0|i[(je=be+((Tr=Cr+1|0)<<2)|0)>>2])+Ce|0,i[je>>2]=t,Pr=Tr,Or=t),9!=(0|Pr);)Ye=Or,Cr=Pr;for(Cr=((Pr=0|i[Oe>>2])>>31&Pr)>>25,i[Oe>>2]=(0|d(Cr,-33554432))+Pr,Pr=(19*Cr|0)+(0|i[be>>2])|0,Or=(0|d(Cr=(Pr>>31&Pr)>>26,-67108864))+Pr|0,i[be>>2]=Or,i[xe>>2]=Cr+(0|i[xe>>2]),Cr=Or,Or=0;Pr=be+(Or<<2)|0,1&Or?(i[Pr>>2]=33554431&Cr,Ye=(0|i[(br=be+((Pr=Or+1|0)<<2)|0)>>2])+(Cr>>25)|0,i[br>>2]=Ye,wr=Pr,Mr=Ye):(i[Pr>>2]=67108863&Cr,br=(0|i[(Tr=be+((Ye=Or+1|0)<<2)|0)>>2])+(Cr>>26)|0,i[Tr>>2]=br,wr=Ye,Mr=br),9!=(0|wr);)Cr=Mr,Or=wr;for(wr=0|i[Oe>>2],i[Oe>>2]=33554431&wr,Or=(19*(wr>>25)|0)+(0|i[be>>2])|0,i[be>>2]=Or,wr=Or,Or=0;Mr=be+(Or<<2)|0,1&Or?(i[Mr>>2]=33554431&wr,Cr=(0|i[(Pr=be+((Mr=Or+1|0)<<2)|0)>>2])+(wr>>25)|0,i[Pr>>2]=Cr,Ir=Mr,Rr=Cr):(i[Mr>>2]=67108863&wr,Pr=(0|i[(Ye=be+((Cr=Or+1|0)<<2)|0)>>2])+(wr>>26)|0,i[Ye>>2]=Pr,Ir=Cr,Rr=Pr),9!=(0|Ir);)wr=Rr,Or=Ir;for(Or=33554431&(Ir=0|i[Oe>>2]),i[Oe>>2]=Or,Rr=(19*(Ir>>25)|0)+(0|i[be>>2])|0,i[be>>2]=Rr,Ir=1,wr=~(Rr+-67108845>>31);;){if(Cr=0|i[be+(Ir<<2)>>2],Dr=1&Ir?(Cr=(Pr=(Cr=(Pr=Cr<<16&(-33554432^Cr))<<8&Pr)<<4&Cr)<<2&Pr)<<1&Cr:(Pr=(Mr=(Pr=(Mr=Cr<<16&(-67108864^Cr))<<8&Mr)<<4&Pr)<<2&Mr)<<1&Pr,Cr=Dr>>31&wr,10==(0|(Ir=Ir+1|0))){Nr=Cr;break}wr=Cr}return wr=Rr-(67108845&Nr)|0,i[be>>2]=wr,be=67108863&Nr,Rr=33554431&Nr,Dr=(Ir=(0|i[xe>>2])-Rr|0)<<2,Pr=(Cr=(0|i[Pe>>2])-be|0)<<3,Ye=(Mr=(0|i[Ne>>2])-Rr|0)<<5,Nr=(br=(0|i[De>>2])-Nr|0)<<6,Tr=(0|i[Ie>>2])-Rr|0,i[Ie>>2]=Tr,Be=(Ie=(0|i[Re>>2])-be|0)<<1,je=(t=(0|i[we>>2])-Rr|0)<<3,Ce=(0|i[Me>>2])-be<<4,i[xe>>2]=Dr,i[Pe>>2]=Pr,i[Ne>>2]=Ye,i[De>>2]=Nr,i[Re>>2]=Be,i[we>>2]=je,i[Me>>2]=Ce,i[Oe>>2]=Or-Rr<<6,a[e>>0]=wr,a[e+1>>0]=wr>>>8,a[e+2>>0]=wr>>>16,a[e+3>>0]=Dr|wr>>>24,a[e+4>>0]=Ir>>>6,a[e+5>>0]=Ir>>>14,a[e+6>>0]=Pr|Ir>>>22,a[e+7>>0]=Cr>>>5,a[e+8>>0]=Cr>>>13,a[e+9>>0]=Ye|Cr>>>21,a[e+10>>0]=Mr>>>3,a[e+11>>0]=Mr>>>11,a[e+12>>0]=Nr|Mr>>>19,a[e+13>>0]=br>>>2,a[e+14>>0]=br>>>10,a[e+15>>0]=br>>>18,a[e+16>>0]=Tr,a[e+17>>0]=Tr>>>8,a[e+18>>0]=Tr>>>16,a[e+19>>0]=Tr>>>24|Be,a[e+20>>0]=Ie>>>7,a[e+21>>0]=Ie>>>15,a[e+22>>0]=Ie>>>23|je,a[e+23>>0]=t>>>5,a[e+24>>0]=t>>>13,je=0|i[Me>>2],a[e+25>>0]=t>>>21|je,a[e+26>>0]=je>>>8,a[e+27>>0]=je>>>16,t=0|i[Oe>>2],a[e+28>>0]=je>>>24|t,a[e+29>>0]=t>>>8,a[e+30>>0]=t>>>16,a[e+31>>0]=t>>>24,s=o,0},_free:function(e){var t,r,a=0,n=0,s=0,o=0,l=0,d=0,u=0,c=0,p=0,h=0,f=0,m=0,g=0,v=0,E=0,y=0,S=0,T=0,A=0,b=0,C=0,P=0,O=0,w=0,M=0,I=0,R=0,D=0,N=0,L=0,k=0,U=0,G=0,F=0;if(e|=0){(a=e+-8|0)>>>0<(n=0|i[47])>>>0&&_(),1==(0|(e=3&(t=0|i[e+-4>>2])))&&_(),r=a+(s=-8&t)|0;do{if(1&t)p=a,h=s;else{if(o=0|i[a>>2],!e)return;if(d=o+s|0,(l=a+(0-o)|0)>>>0<n>>>0&&_(),(0|l)==(0|i[48])){if(3!=(3&(c=0|i[(u=r+4|0)>>2])|0)){p=l,h=d;break}return i[45]=d,i[u>>2]=-2&c,i[l+4>>2]=1|d,void(i[l+d>>2]=d)}if(c=o>>>3,o>>>0<256){if(o=0|i[l+8>>2],u=0|i[l+12>>2],(0|o)!=(0|(f=212+(c<<1<<2)|0))&&(o>>>0<n>>>0&&_(),(0|i[o+12>>2])!=(0|l)&&_()),(0|u)==(0|o)){i[43]=i[43]&~(1<<c),p=l,h=d;break}(0|u)!=(0|f)?(u>>>0<n>>>0&&_(),(0|i[(f=u+8|0)>>2])==(0|l)?m=f:_()):m=u+8|0,i[o+12>>2]=u,i[m>>2]=o,p=l,h=d;break}o=0|i[l+24>>2],u=0|i[l+12>>2];do{if((0|u)==(0|l)){if(g=0|i[(c=(f=l+16|0)+4|0)>>2])y=g,S=c;else{if(!(v=0|i[f>>2])){E=0;break}y=v,S=f}for(;;)if(g=0|i[(c=y+20|0)>>2])y=g,S=c;else{if(!(g=0|i[(c=y+16|0)>>2])){T=y,A=S;break}y=g,S=c}if(!(A>>>0<n>>>0)){i[A>>2]=0,E=T;break}_()}else{if((c=0|i[l+8>>2])>>>0<n>>>0&&_(),(0|i[(g=c+12|0)>>2])!=(0|l)&&_(),(0|i[(f=u+8|0)>>2])==(0|l)){i[g>>2]=u,i[f>>2]=c,E=u;break}_()}}while(0);if(o){if(u=0|i[l+28>>2],(0|l)==(0|i[(c=476+(u<<2)|0)>>2])){if(i[c>>2]=E,!E){i[44]=i[44]&~(1<<u),p=l,h=d;break}}else if(o>>>0<(0|i[47])>>>0&&_(),(0|i[(u=o+16|0)>>2])==(0|l)?i[u>>2]=E:i[o+20>>2]=E,!E){p=l,h=d;break}E>>>0<(u=0|i[47])>>>0&&_(),i[E+24>>2]=o,f=0|i[(c=l+16|0)>>2];do{if(f){if(!(f>>>0<u>>>0)){i[E+16>>2]=f,i[f+24>>2]=E;break}_()}}while(0);if(f=0|i[c+4>>2]){if(!(f>>>0<(0|i[47])>>>0)){i[E+20>>2]=f,i[f+24>>2]=E,p=l,h=d;break}_()}else p=l,h=d}else p=l,h=d}}while(0);if(p>>>0>=r>>>0&&_(),1&(a=0|i[(s=r+4|0)>>2])||_(),2&a)i[s>>2]=-2&a,i[p+4>>2]=1|h,i[p+h>>2]=h,I=h;else{if((0|r)==(0|i[49])){if(E=(0|i[46])+h|0,i[46]=E,i[49]=p,i[p+4>>2]=1|E,(0|p)!=(0|i[48]))return;return i[48]=0,void(i[45]=0)}if((0|r)==(0|i[48]))return E=(0|i[45])+h|0,i[45]=E,i[48]=p,i[p+4>>2]=1|E,void(i[p+E>>2]=E);E=(-8&a)+h|0,n=a>>>3;do{if(a>>>0>=256){T=0|i[r+24>>2],A=0|i[r+12>>2];do{if((0|A)==(0|r)){if(m=0|i[(y=(S=r+16|0)+4|0)>>2])C=m,P=y;else{if(!(e=0|i[S>>2])){b=0;break}C=e,P=S}for(;;)if(m=0|i[(y=C+20|0)>>2])C=m,P=y;else{if(!(m=0|i[(y=C+16|0)>>2])){O=C,w=P;break}C=m,P=y}if(!(w>>>0<(0|i[47])>>>0)){i[w>>2]=0,b=O;break}_()}else{if((y=0|i[r+8>>2])>>>0<(0|i[47])>>>0&&_(),(0|i[(m=y+12|0)>>2])!=(0|r)&&_(),(0|i[(S=A+8|0)>>2])==(0|r)){i[m>>2]=A,i[S>>2]=y,b=A;break}_()}}while(0);if(T){if(A=0|i[r+28>>2],(0|r)==(0|i[(d=476+(A<<2)|0)>>2])){if(i[d>>2]=b,!b){i[44]=i[44]&~(1<<A);break}}else if(T>>>0<(0|i[47])>>>0&&_(),(0|i[(A=T+16|0)>>2])==(0|r)?i[A>>2]=b:i[T+20>>2]=b,!b)break;b>>>0<(A=0|i[47])>>>0&&_(),i[b+24>>2]=T,l=0|i[(d=r+16|0)>>2];do{if(l){if(!(l>>>0<A>>>0)){i[b+16>>2]=l,i[l+24>>2]=b;break}_()}}while(0);if(l=0|i[d+4>>2]){if(!(l>>>0<(0|i[47])>>>0)){i[b+20>>2]=l,i[l+24>>2]=b;break}_()}}}else{if(l=0|i[r+8>>2],A=0|i[r+12>>2],(0|l)!=(0|(T=212+(n<<1<<2)|0))&&(l>>>0<(0|i[47])>>>0&&_(),(0|i[l+12>>2])!=(0|r)&&_()),(0|A)==(0|l)){i[43]=i[43]&~(1<<n);break}(0|A)!=(0|T)?(A>>>0<(0|i[47])>>>0&&_(),(0|i[(T=A+8|0)>>2])==(0|r)?M=T:_()):M=A+8|0,i[l+12>>2]=A,i[M>>2]=l}}while(0);if(i[p+4>>2]=1|E,i[p+E>>2]=E,(0|p)==(0|i[48]))return void(i[45]=E);I=E}if(h=I>>>3,I>>>0<256)return a=212+(h<<1<<2)|0,(s=0|i[43])&(E=1<<h)?(M=0|i[(h=a+8|0)>>2])>>>0<(0|i[47])>>>0?_():(R=h,D=M):(i[43]=s|E,R=a+8|0,D=a),i[R>>2]=p,i[D+12>>2]=p,i[p+8>>2]=D,void(i[p+12>>2]=a);N=(a=I>>>8)?I>>>0>16777215?31:I>>>((s=14-((a=((R=a<<(D=(a+1048320|0)>>>16&8))+520192|0)>>>16&4)|D|(R=((E=R<<a)+245760|0)>>>16&2))+(E<<R>>>15)|0)+7|0)&1|s<<1:0,s=476+(N<<2)|0,i[p+28>>2]=N,i[p+20>>2]=0,i[p+16>>2]=0,R=0|i[44],E=1<<N;do{if(R&E){for(D=I<<(31==(0|N)?0:25-(N>>>1)|0),a=0|i[s>>2];;){if((-8&i[a+4>>2]|0)==(0|I)){L=a,k=130;break}if(!(h=0|i[(M=a+16+(D>>>31<<2)|0)>>2])){U=M,G=a,k=127;break}D<<=1,a=h}if(127==(0|k)){if(!(U>>>0<(0|i[47])>>>0)){i[U>>2]=p,i[p+24>>2]=G,i[p+12>>2]=p,i[p+8>>2]=p;break}_()}else if(130==(0|k)){if((D=0|i[(a=L+8|0)>>2])>>>0>=(d=0|i[47])>>>0&L>>>0>=d>>>0){i[D+12>>2]=p,i[a>>2]=p,i[p+8>>2]=D,i[p+12>>2]=L,i[p+24>>2]=0;break}_()}}else i[44]=R|E,i[s>>2]=p,i[p+24>>2]=s,i[p+12>>2]=p,i[p+8>>2]=p}while(0);if(p=(0|i[51])-1|0,i[51]=p,!p){for(F=628;p=0|i[F>>2];)F=p+8|0;i[51]=-1}}},_i64Add:U,_bitshift64Ashr:L,_i64Subtract:k,_memset:G,_malloc:function(e){e|=0;var t=0,r=0,a=0,n=0,s=0,o=0,l=0,d=0,u=0,c=0,p=0,h=0,f=0,v=0,E=0,y=0,S=0,T=0,b=0,C=0,P=0,O=0,M=0,I=0,R=0,D=0,N=0,L=0,k=0,U=0,G=0,F=0,x=0,B=0,Y=0,K=0,j=0,W=0,H=0,V=0,$=0,q=0,z=0,J=0,Q=0,X=0,Z=0,ee=0,te=0,re=0,ae=0,ie=0,ne=0,se=0,oe=0,le=0,de=0,ue=0,ce=0,pe=0,he=0,fe=0,_e=0,me=0,ge=0,ve=0,Ee=0,ye=0,Se=0,Te=0,Ae=0,be=0,Ce=0,Pe=0,Oe=0,we=0,Me=0,Ie=0,Re=0,De=0,Ne=0,Le=0,ke=0,Ue=0,Ge=0,Fe=0,xe=0,Be=0,Ye=0,Ke=0;do{if(e>>>0<245){if(r=(t=e>>>0<11?16:e+11&-8)>>>3,3&(n=(a=0|i[43])>>>r)){d=0|i[(l=(o=212+((s=(1&n^1)+r|0)<<1<<2)|0)+8|0)>>2],c=0|i[(u=d+8|0)>>2];do{if((0|o)!=(0|c)){if(c>>>0<(0|i[47])>>>0&&_(),(0|i[(p=c+12|0)>>2])==(0|d)){i[p>>2]=o,i[l>>2]=c;break}_()}else i[43]=a&~(1<<s)}while(0);return c=s<<3,i[d+4>>2]=3|c,i[(l=d+c+4|0)>>2]=1|i[l>>2],0|u}if(t>>>0>(l=0|i[45])>>>0){if(n){h=0|i[(v=(f=212+((E=((c=(p=(c=((o=n<<r&((c=2<<r)|0-c))&0-o)-1|0)>>>(o=c>>>12&16))>>>5&8)|o|(p=(h=p>>>c)>>>2&4)|(h=(f=h>>>p)>>>1&2)|(f=(v=f>>>h)>>>1&1))+(v>>>f)|0)<<1<<2)|0)+8|0)>>2],o=0|i[(p=h+8|0)>>2];do{if((0|f)!=(0|o)){if(o>>>0<(0|i[47])>>>0&&_(),(0|i[(c=o+12|0)>>2])==(0|h)){i[c>>2]=f,i[v>>2]=o,y=0|i[45];break}_()}else i[43]=a&~(1<<E),y=l}while(0);return l=(E<<3)-t|0,i[h+4>>2]=3|t,i[(a=h+t|0)+4>>2]=1|l,i[a+l>>2]=l,y&&(o=0|i[48],f=212+((v=y>>>3)<<1<<2)|0,(r=0|i[43])&(n=1<<v)?(u=0|i[(v=f+8|0)>>2])>>>0<(0|i[47])>>>0?_():(S=v,T=u):(i[43]=r|n,S=f+8|0,T=f),i[S>>2]=o,i[T+12>>2]=o,i[o+8>>2]=T,i[o+12>>2]=f),i[45]=l,i[48]=a,0|p}if(a=0|i[44]){for(u=0|i[476+(((l=(f=(l=(a&0-a)-1|0)>>>(a=l>>>12&16))>>>5&8)|a|(f=(o=f>>>l)>>>2&4)|(o=(n=o>>>f)>>>1&2)|(n=(r=n>>>o)>>>1&1))+(r>>>n)<<2)>>2],n=(-8&i[u+4>>2])-t|0,r=u,o=u;;){if(u=0|i[r+16>>2])P=u;else{if(!(f=0|i[r+20>>2])){b=n,C=o;break}P=f}n=(f=(u=(-8&i[P+4>>2])-t|0)>>>0<n>>>0)?u:n,r=P,o=f?P:o}C>>>0<(o=0|i[47])>>>0&&_(),C>>>0>=(r=C+t|0)>>>0&&_(),n=0|i[C+24>>2],p=0|i[C+12>>2];do{if((0|p)==(0|C)){if(E=0|i[(h=C+20|0)>>2])M=E,I=h;else{if(!(u=0|i[(f=C+16|0)>>2])){O=0;break}M=u,I=f}for(;;)if(E=0|i[(h=M+20|0)>>2])M=E,I=h;else{if(!(E=0|i[(h=M+16|0)>>2])){R=M,D=I;break}M=E,I=h}if(!(D>>>0<o>>>0)){i[D>>2]=0,O=R;break}_()}else{if((h=0|i[C+8>>2])>>>0<o>>>0&&_(),(0|i[(E=h+12|0)>>2])!=(0|C)&&_(),(0|i[(f=p+8|0)>>2])==(0|C)){i[E>>2]=p,i[f>>2]=h,O=p;break}_()}}while(0);do{if(n){if(p=0|i[C+28>>2],(0|C)==(0|i[(o=476+(p<<2)|0)>>2])){if(i[o>>2]=O,!O){i[44]=i[44]&~(1<<p);break}}else if(n>>>0<(0|i[47])>>>0&&_(),(0|i[(p=n+16|0)>>2])==(0|C)?i[p>>2]=O:i[n+20>>2]=O,!O)break;O>>>0<(p=0|i[47])>>>0&&_(),i[O+24>>2]=n,o=0|i[C+16>>2];do{if(o){if(!(o>>>0<p>>>0)){i[O+16>>2]=o,i[o+24>>2]=O;break}_()}}while(0);if(o=0|i[C+20>>2]){if(!(o>>>0<(0|i[47])>>>0)){i[O+20>>2]=o,i[o+24>>2]=O;break}_()}}}while(0);return b>>>0<16?(n=b+t|0,i[C+4>>2]=3|n,i[(o=C+n+4|0)>>2]=1|i[o>>2]):(i[C+4>>2]=3|t,i[r+4>>2]=1|b,i[r+b>>2]=b,(o=0|i[45])&&(n=0|i[48],o=212+((p=o>>>3)<<1<<2)|0,(h=0|i[43])&(f=1<<p)?(E=0|i[(p=o+8|0)>>2])>>>0<(0|i[47])>>>0?_():(N=p,L=E):(i[43]=h|f,N=o+8|0,L=o),i[N>>2]=n,i[L+12>>2]=n,i[n+8>>2]=L,i[n+12>>2]=o),i[45]=b,i[48]=r),0|(C+8|0)}k=t}else k=t}else if(e>>>0<=4294967231)if(n=-8&(o=e+11|0),f=0|i[44]){h=0-n|0,U=(E=o>>>8)?n>>>0>16777215?31:n>>>((a=14-((E=((p=E<<(o=(E+1048320|0)>>>16&8))+520192|0)>>>16&4)|o|(p=((u=p<<E)+245760|0)>>>16&2))+(u<<p>>>15)|0)+7|0)&1|a<<1:0,a=0|i[476+(U<<2)>>2];e:do{if(a)for(p=h,u=0,o=n<<(31==(0|U)?0:25-(U>>>1)|0),E=a,l=0;;){if((d=(v=-8&i[E+4>>2])-n|0)>>>0<p>>>0){if((0|v)==(0|n)){Y=d,K=E,j=E,B=90;break e}W=d,H=E}else W=p,H=l;if(v=0==(0|(d=0|i[E+20>>2]))|(0|d)==(0|(E=0|i[E+16+(o>>>31<<2)>>2]))?u:d,d=0==(0|E)){G=W,F=v,x=H,B=86;break}p=W,u=v,o<<=1&d^1,l=H}else G=h,F=0,x=0,B=86}while(0);if(86==(0|B)){if(0==(0|F)&0==(0|x)){if(!(h=f&((a=2<<U)|0-a))){k=n;break}V=0|i[476+(((a=(t=(a=(h&0-h)-1|0)>>>(h=a>>>12&16))>>>5&8)|h|(t=(r=t>>>a)>>>2&4)|(r=(l=r>>>t)>>>1&2)|(l=(o=l>>>r)>>>1&1))+(o>>>l)<<2)>>2]}else V=F;V?(Y=G,K=V,j=x,B=90):($=G,q=x)}if(90==(0|B))for(;;)if(B=0,r=(o=(l=(-8&i[K+4>>2])-n|0)>>>0<Y>>>0)?l:Y,l=o?K:j,o=0|i[K+16>>2])Y=r,K=o,j=l,B=90;else{if(!(K=0|i[K+20>>2])){$=r,q=l;break}Y=r,j=l,B=90}if(0!=(0|q)&&$>>>0<((0|i[45])-n|0)>>>0){q>>>0<(f=0|i[47])>>>0&&_(),q>>>0>=(l=q+n|0)>>>0&&_(),r=0|i[q+24>>2],o=0|i[q+12>>2];do{if((0|o)==(0|q)){if(h=0|i[(t=q+20|0)>>2])J=h,Q=t;else{if(!(u=0|i[(a=q+16|0)>>2])){z=0;break}J=u,Q=a}for(;;)if(h=0|i[(t=J+20|0)>>2])J=h,Q=t;else{if(!(h=0|i[(t=J+16|0)>>2])){X=J,Z=Q;break}J=h,Q=t}if(!(Z>>>0<f>>>0)){i[Z>>2]=0,z=X;break}_()}else{if((t=0|i[q+8>>2])>>>0<f>>>0&&_(),(0|i[(h=t+12|0)>>2])!=(0|q)&&_(),(0|i[(a=o+8|0)>>2])==(0|q)){i[h>>2]=o,i[a>>2]=t,z=o;break}_()}}while(0);do{if(r){if(o=0|i[q+28>>2],(0|q)==(0|i[(f=476+(o<<2)|0)>>2])){if(i[f>>2]=z,!z){i[44]=i[44]&~(1<<o);break}}else if(r>>>0<(0|i[47])>>>0&&_(),(0|i[(o=r+16|0)>>2])==(0|q)?i[o>>2]=z:i[r+20>>2]=z,!z)break;z>>>0<(o=0|i[47])>>>0&&_(),i[z+24>>2]=r,f=0|i[q+16>>2];do{if(f){if(!(f>>>0<o>>>0)){i[z+16>>2]=f,i[f+24>>2]=z;break}_()}}while(0);if(f=0|i[q+20>>2]){if(!(f>>>0<(0|i[47])>>>0)){i[z+20>>2]=f,i[f+24>>2]=z;break}_()}}}while(0);do{if($>>>0>=16){if(i[q+4>>2]=3|n,i[l+4>>2]=1|$,i[l+$>>2]=$,r=$>>>3,$>>>0<256){f=212+(r<<1<<2)|0,(o=0|i[43])&(t=1<<r)?(a=0|i[(r=f+8|0)>>2])>>>0<(0|i[47])>>>0?_():(ee=r,te=a):(i[43]=o|t,ee=f+8|0,te=f),i[ee>>2]=l,i[te+12>>2]=l,i[l+8>>2]=te,i[l+12>>2]=f;break}if(re=(f=$>>>8)?$>>>0>16777215?31:$>>>((r=14-((f=((o=f<<(t=(f+1048320|0)>>>16&8))+520192|0)>>>16&4)|t|(o=((a=o<<f)+245760|0)>>>16&2))+(a<<o>>>15)|0)+7|0)&1|r<<1:0,r=476+(re<<2)|0,i[l+28>>2]=re,i[(o=l+16|0)+4>>2]=0,i[o>>2]=0,!((o=0|i[44])&(a=1<<re))){i[44]=o|a,i[r>>2]=l,i[l+24>>2]=r,i[l+12>>2]=l,i[l+8>>2]=l;break}for(a=$<<(31==(0|re)?0:25-(re>>>1)|0),o=0|i[r>>2];;){if((-8&i[o+4>>2]|0)==(0|$)){ae=o,B=148;break}if(!(t=0|i[(r=o+16+(a>>>31<<2)|0)>>2])){ie=r,ne=o,B=145;break}a<<=1,o=t}if(145==(0|B)){if(!(ie>>>0<(0|i[47])>>>0)){i[ie>>2]=l,i[l+24>>2]=ne,i[l+12>>2]=l,i[l+8>>2]=l;break}_()}else if(148==(0|B)){if((a=0|i[(o=ae+8|0)>>2])>>>0>=(t=0|i[47])>>>0&ae>>>0>=t>>>0){i[a+12>>2]=l,i[o>>2]=l,i[l+8>>2]=a,i[l+12>>2]=ae,i[l+24>>2]=0;break}_()}}else a=$+n|0,i[q+4>>2]=3|a,i[(o=q+a+4|0)>>2]=1|i[o>>2]}while(0);return 0|(q+8|0)}k=n}else k=n;else k=-1}while(0);if((q=0|i[45])>>>0>=k>>>0)return $=q-k|0,ae=0|i[48],$>>>0>15?(ne=ae+k|0,i[48]=ne,i[45]=$,i[ne+4>>2]=1|$,i[ne+$>>2]=$,i[ae+4>>2]=3|k):(i[45]=0,i[48]=0,i[ae+4>>2]=3|q,i[($=ae+q+4|0)>>2]=1|i[$>>2]),0|(ae+8|0);if((ae=0|i[46])>>>0>k>>>0)return $=ae-k|0,i[46]=$,q=(ae=0|i[49])+k|0,i[49]=q,i[q+4>>2]=1|$,i[ae+4>>2]=3|k,0|(ae+8|0);do{if(!(0|i[161])){if(!((ae=0|A(30))+-1&ae)){i[163]=ae,i[162]=ae,i[164]=-1,i[165]=-1,i[166]=0,i[154]=0,i[161]=-16&(0|g(0))^1431655768;break}_()}}while(0);if(ae=k+48|0,($=(ne=($=0|i[163])+(q=k+47|0)|0)&(ie=0-$|0))>>>0<=k>>>0)return 0|0;if(0!=(0|(re=0|i[153]))&&(ee=(te=0|i[151])+$|0)>>>0<=te>>>0|ee>>>0>re>>>0)return 0|0;e:do{if(4&i[154])B=190;else{re=0|i[49];t:do{if(re){for(ee=620;;){if((te=0|i[ee>>2])>>>0<=re>>>0&&(te+(0|i[(z=ee+4|0)>>2])|0)>>>0>re>>>0){se=ee,oe=z;break}if(!(ee=0|i[ee+8>>2])){B=173;break t}}if((ee=ne-(0|i[46])&ie)>>>0<2147483647)if((0|(z=0|m(0|ee)))==((0|i[se>>2])+(0|i[oe>>2])|0)){if(-1!=(0|z)){le=z,de=ee,B=193;break e}}else ue=z,ce=ee,B=183}else B=173}while(0);do{if(173==(0|B)&&-1!=(0|(re=0|m(0)))&&(n=re,pe=(z=(ee=0|i[162])+-1|0)&n?$-n+(z+n&0-ee)|0:$,n=(ee=0|i[151])+pe|0,pe>>>0>k>>>0&pe>>>0<2147483647)){if(0!=(0|(z=0|i[153]))&&n>>>0<=ee>>>0|n>>>0>z>>>0)break;if((0|(z=0|m(0|pe)))==(0|re)){le=re,de=pe,B=193;break e}ue=z,ce=pe,B=183}}while(0);t:do{if(183==(0|B)){z=0-ce|0;do{if(ae>>>0>ce>>>0&ce>>>0<2147483647&-1!=(0|ue)&&(n=q-ce+(re=0|i[163])&0-re)>>>0<2147483647){if(-1==(0|m(0|n))){m(0|z);break t}he=n+ce|0;break}he=ce}while(0);if(-1!=(0|ue)){le=ue,de=he,B=193;break e}}}while(0);i[154]=4|i[154],B=190}}while(0);if(190==(0|B)&&$>>>0<2147483647&&(he=0|m(0|$))>>>0<($=0|m(0))>>>0&-1!=(0|he)&-1!=(0|$)&&(ue=$-he|0)>>>0>(k+40|0)>>>0&&(le=he,de=ue,B=193),193==(0|B)){ue=(0|i[151])+de|0,i[151]=ue,ue>>>0>(0|i[152])>>>0&&(i[152]=ue),ue=0|i[49];do{if(ue){he=620;do{if((0|le)==(($=0|i[he>>2])+(q=0|i[(ce=he+4|0)>>2])|0)){fe=$,_e=ce,me=q,ge=he,B=203;break}he=0|i[he+8>>2]}while(0!=(0|he));if(203==(0|B)&&0==(8&i[ge+12>>2]|0)&&ue>>>0<le>>>0&ue>>>0>=fe>>>0){i[_e>>2]=me+de,he=ue+(q=0==(7&(he=ue+8|0)|0)?0:0-he&7)|0,ce=de-q+(0|i[46])|0,i[49]=he,i[46]=ce,i[he+4>>2]=1|ce,i[he+ce+4>>2]=40,i[50]=i[165];break}for(le>>>0<(ce=0|i[47])>>>0?(i[47]=le,ve=le):ve=ce,ce=le+de|0,he=620;;){if((0|i[he>>2])==(0|ce)){Ee=he,ye=he,B=211;break}if(!(he=0|i[he+8>>2])){Se=620;break}}if(211==(0|B)){if(!(8&i[ye+12>>2])){i[Ee>>2]=le,i[(he=ye+4|0)>>2]=(0|i[he>>2])+de,q=le+(0==(7&(he=le+8|0)|0)?0:0-he&7)|0,$=ce+(0==(7&(he=ce+8|0)|0)?0:0-he&7)|0,he=q+k|0,ae=$-q-k|0,i[q+4>>2]=3|k;do{if((0|$)!=(0|ue)){if((0|$)==(0|i[48])){pe=(0|i[45])+ae|0,i[45]=pe,i[48]=he,i[he+4>>2]=1|pe,i[he+pe>>2]=pe;break}if(1==(3&(pe=0|i[$+4>>2])|0)){oe=-8&pe,se=pe>>>3;e:do{if(pe>>>0>=256){ie=0|i[$+24>>2],ne=0|i[$+12>>2];do{if((0|ne)==(0|$)){if(re=0|i[(n=(z=$+16|0)+4|0)>>2])Ae=re,be=n;else{if(!(ee=0|i[z>>2])){Te=0;break}Ae=ee,be=z}for(;;)if(re=0|i[(n=Ae+20|0)>>2])Ae=re,be=n;else{if(!(re=0|i[(n=Ae+16|0)>>2])){Ce=Ae,Pe=be;break}Ae=re,be=n}if(!(Pe>>>0<ve>>>0)){i[Pe>>2]=0,Te=Ce;break}_()}else{if((n=0|i[$+8>>2])>>>0<ve>>>0&&_(),(0|i[(re=n+12|0)>>2])!=(0|$)&&_(),(0|i[(z=ne+8|0)>>2])==(0|$)){i[re>>2]=ne,i[z>>2]=n,Te=ne;break}_()}}while(0);if(!ie)break;n=476+((ne=0|i[$+28>>2])<<2)|0;do{if((0|$)==(0|i[n>>2])){if(i[n>>2]=Te,Te)break;i[44]=i[44]&~(1<<ne);break e}if(ie>>>0<(0|i[47])>>>0&&_(),(0|i[(z=ie+16|0)>>2])==(0|$)?i[z>>2]=Te:i[ie+20>>2]=Te,!Te)break e}while(0);Te>>>0<(ne=0|i[47])>>>0&&_(),i[Te+24>>2]=ie,z=0|i[(n=$+16|0)>>2];do{if(z){if(!(z>>>0<ne>>>0)){i[Te+16>>2]=z,i[z+24>>2]=Te;break}_()}}while(0);if(!(z=0|i[n+4>>2]))break;if(!(z>>>0<(0|i[47])>>>0)){i[Te+20>>2]=z,i[z+24>>2]=Te;break}_()}else{z=0|i[$+8>>2],ne=0|i[$+12>>2],ie=212+(se<<1<<2)|0;do{if((0|z)!=(0|ie)){if(z>>>0<ve>>>0&&_(),(0|i[z+12>>2])==(0|$))break;_()}}while(0);if((0|ne)==(0|z)){i[43]=i[43]&~(1<<se);break}do{if((0|ne)==(0|ie))Oe=ne+8|0;else{if(ne>>>0<ve>>>0&&_(),(0|i[(n=ne+8|0)>>2])==(0|$)){Oe=n;break}_()}}while(0);i[z+12>>2]=ne,i[Oe>>2]=z}}while(0);we=$+oe|0,Me=oe+ae|0}else we=$,Me=ae;if(i[(se=we+4|0)>>2]=-2&i[se>>2],i[he+4>>2]=1|Me,i[he+Me>>2]=Me,se=Me>>>3,Me>>>0<256){pe=212+(se<<1<<2)|0,ie=0|i[43],n=1<<se;do{if(ie&n){if((re=0|i[(se=pe+8|0)>>2])>>>0>=(0|i[47])>>>0){Ie=se,Re=re;break}_()}else i[43]=ie|n,Ie=pe+8|0,Re=pe}while(0);i[Ie>>2]=he,i[Re+12>>2]=he,i[he+8>>2]=Re,i[he+12>>2]=pe;break}n=Me>>>8;do{if(n){if(Me>>>0>16777215){De=31;break}De=Me>>>((ee=14-((re=((oe=n<<(ie=(n+1048320|0)>>>16&8))+520192|0)>>>16&4)|ie|(oe=((se=oe<<re)+245760|0)>>>16&2))+(se<<oe>>>15)|0)+7|0)&1|ee<<1}else De=0}while(0);if(n=476+(De<<2)|0,i[he+28>>2]=De,i[(pe=he+16|0)+4>>2]=0,i[pe>>2]=0,!((pe=0|i[44])&(ee=1<<De))){i[44]=pe|ee,i[n>>2]=he,i[he+24>>2]=n,i[he+12>>2]=he,i[he+8>>2]=he;break}for(ee=Me<<(31==(0|De)?0:25-(De>>>1)|0),pe=0|i[n>>2];;){if((-8&i[pe+4>>2]|0)==(0|Me)){Ne=pe,B=281;break}if(!(oe=0|i[(n=pe+16+(ee>>>31<<2)|0)>>2])){Le=n,ke=pe,B=278;break}ee<<=1,pe=oe}if(278==(0|B)){if(!(Le>>>0<(0|i[47])>>>0)){i[Le>>2]=he,i[he+24>>2]=ke,i[he+12>>2]=he,i[he+8>>2]=he;break}_()}else if(281==(0|B)){if((ee=0|i[(pe=Ne+8|0)>>2])>>>0>=(oe=0|i[47])>>>0&Ne>>>0>=oe>>>0){i[ee+12>>2]=he,i[pe>>2]=he,i[he+8>>2]=ee,i[he+12>>2]=Ne,i[he+24>>2]=0;break}_()}}else ee=(0|i[46])+ae|0,i[46]=ee,i[49]=he,i[he+4>>2]=1|ee}while(0);return 0|(q+8|0)}Se=620}for(;;){if((he=0|i[Se>>2])>>>0<=ue>>>0&&(ae=he+(0|i[Se+4>>2])|0)>>>0>ue>>>0){Ue=ae;break}Se=0|i[Se+8>>2]}he=(q=(he=(q=Ue+-47|0)+(0==(7&(ae=q+8|0)|0)?0:0-ae&7)|0)>>>0<(ae=ue+16|0)>>>0?ue:he)+8|0,$=le+(ce=0==(7&($=le+8|0)|0)?0:0-$&7)|0,ee=de+-40-ce|0,i[49]=$,i[46]=ee,i[$+4>>2]=1|ee,i[$+ee+4>>2]=40,i[50]=i[165],i[(ee=q+4|0)>>2]=27,i[he>>2]=i[155],i[he+4>>2]=i[156],i[he+8>>2]=i[157],i[he+12>>2]=i[158],i[155]=le,i[156]=de,i[158]=0,i[157]=he,he=q+24|0;do{i[(he=he+4|0)>>2]=7}while((he+4|0)>>>0<Ue>>>0);if((0|q)!=(0|ue)){if(he=q-ue|0,i[ee>>2]=-2&i[ee>>2],i[ue+4>>2]=1|he,i[q>>2]=he,$=he>>>3,he>>>0<256){ce=212+($<<1<<2)|0,(pe=0|i[43])&(oe=1<<$)?(n=0|i[($=ce+8|0)>>2])>>>0<(0|i[47])>>>0?_():(Ge=$,Fe=n):(i[43]=pe|oe,Ge=ce+8|0,Fe=ce),i[Ge>>2]=ue,i[Fe+12>>2]=ue,i[ue+8>>2]=Fe,i[ue+12>>2]=ce;break}if(xe=(ce=he>>>8)?he>>>0>16777215?31:he>>>(($=14-((ce=((pe=ce<<(oe=(ce+1048320|0)>>>16&8))+520192|0)>>>16&4)|oe|(pe=((n=pe<<ce)+245760|0)>>>16&2))+(n<<pe>>>15)|0)+7|0)&1|$<<1:0,$=476+(xe<<2)|0,i[ue+28>>2]=xe,i[ue+20>>2]=0,i[ae>>2]=0,!((pe=0|i[44])&(n=1<<xe))){i[44]=pe|n,i[$>>2]=ue,i[ue+24>>2]=$,i[ue+12>>2]=ue,i[ue+8>>2]=ue;break}for(n=he<<(31==(0|xe)?0:25-(xe>>>1)|0),pe=0|i[$>>2];;){if((-8&i[pe+4>>2]|0)==(0|he)){Be=pe,B=307;break}if(!(oe=0|i[($=pe+16+(n>>>31<<2)|0)>>2])){Ye=$,Ke=pe,B=304;break}n<<=1,pe=oe}if(304==(0|B)){if(!(Ye>>>0<(0|i[47])>>>0)){i[Ye>>2]=ue,i[ue+24>>2]=Ke,i[ue+12>>2]=ue,i[ue+8>>2]=ue;break}_()}else if(307==(0|B)){if((n=0|i[(pe=Be+8|0)>>2])>>>0>=(he=0|i[47])>>>0&Be>>>0>=he>>>0){i[n+12>>2]=ue,i[pe>>2]=ue,i[ue+8>>2]=n,i[ue+12>>2]=Be,i[ue+24>>2]=0;break}_()}}}else{0==(0|(n=0|i[47]))|le>>>0<n>>>0&&(i[47]=le),i[155]=le,i[156]=de,i[158]=0,i[52]=i[161],i[51]=-1,n=0;do{i[(pe=212+(n<<1<<2)|0)+12>>2]=pe,i[pe+8>>2]=pe,n=n+1|0}while(32!=(0|n));n=le+(pe=0==(7&(n=le+8|0)|0)?0:0-n&7)|0,he=de+-40-pe|0,i[49]=n,i[46]=he,i[n+4>>2]=1|he,i[n+he+4>>2]=40,i[50]=i[165]}}while(0);if((de=0|i[46])>>>0>k>>>0)return le=de-k|0,i[46]=le,ue=(de=0|i[49])+k|0,i[49]=ue,i[ue+4>>2]=1|le,i[de+4>>2]=3|k,0|(de+8|0)}return i[(0|w())>>2]=12,0|0},_memcpy:function(e,t,r){var n;if(e|=0,t|=0,(0|(r|=0))>=4096)return 0|v(0|e,0|t,0|r);if(n=0|e,(3&e)==(3&t)){for(;3&e;){if(!r)return 0|n;a[e>>0]=0|a[t>>0],e=e+1|0,t=t+1|0,r=r-1|0}for(;(0|r)>=4;)i[e>>2]=i[t>>2],e=e+4|0,t=t+4|0,r=r-4|0}for(;(0|r)>0;)a[e>>0]=0|a[t>>0],e=e+1|0,t=t+1|0,r=r-1|0;return 0|n},_bitshift64Lshr:F,_fflush:function e(t){t|=0;var r=0,a=0,n=0,s=0,o=0,l=0,d=0;do{if(t){if((0|i[t+76>>2])<=-1){r=0|N(t);break}a=0==(0|I()),n=0|N(t),a||R(),r=n}else{if(s=0|i[13]?0|e(0|i[13]):0,p(36),n=0|i[8])for(a=n,n=s;;){if(l=(0|i[a+76>>2])>-1?0|I():0,d=(0|i[a+20>>2])>>>0>(0|i[a+28>>2])>>>0?0|N(a)|n:n,l&&R(),!(a=0|i[a+56>>2])){o=d;break}n=d}else o=s;y(36),r=o}}while(0);return 0|r},___errno_location:w,_bitshift64Shl:x,runPostSets:function(){},stackAlloc:function(e){var t;return t=s,s=(s=s+(e|=0)|0)+15&-16,0|t},stackSave:function(){return 0|s},stackRestore:function(e){s=e|=0},establishStackSpace:function(e,t){s=e|=0,t|=0},setThrew:function(e,t){e|=0,t|=0,o||(o=e,t)},setTempRet0:function(e){l=e|=0},getTempRet0:function(){return 0|l},dynCall_ii:function(e,t){return t|=0,0|Y[1&(e|=0)](0|t)},dynCall_iiii:function(e,t,r,a){return t|=0,r|=0,a|=0,0|K[3&(e|=0)](0|t,0|r,0|a)},dynCall_vi:function(e,t){t|=0,j[1&(e|=0)](0|t)}}}(e.Na,e.Oa,buffer);e._curve25519_donna=Z._curve25519_donna;var Da=e._free=Z._free;e.runPostSets=Z.runPostSets;var cb=e._i64Add=Z._i64Add,ab=e._bitshift64Ashr=Z._bitshift64Ashr,bb=e._i64Subtract=Z._i64Subtract,db=e._memset=Z._memset,ua=e._malloc=Z._malloc,gc=e._memcpy=Z._memcpy,fb=e._bitshift64Lshr=Z._bitshift64Lshr;e._fflush=Z._fflush,e.___errno_location=Z.___errno_location;var gb=e._bitshift64Shl=Z._bitshift64Shl;function xc(e){this.name="ExitStatus",this.message="Program terminated with exit("+e+")",this.status=e}e.dynCall_ii=Z.dynCall_ii,e.dynCall_iiii=Z.dynCall_iiii,e.dynCall_vi=Z.dynCall_vi,n.W=Z.stackAlloc,n.na=Z.stackSave,n.X=Z.stackRestore,n.md=Z.establishStackSpace,n.cb=Z.setTempRet0,n.Ua=Z.getTempRet0,xc.prototype=Error(),xc.prototype.constructor=xc;var Yc=null,Xa=function t(){e.calledRun||$c(),e.calledRun||(Xa=t)};function $c(t){function r(){if(!e.calledRun&&(e.calledRun=!0,!A)){if(xa||(xa=!0,Oa(Qa)),Oa(Ra),e.onRuntimeInitialized&&e.onRuntimeInitialized(),e._main&&bd&&e.callMain(t),e.postRun)for("function"==typeof e.postRun&&(e.postRun=[e.postRun]);e.postRun.length;)Ua(e.postRun.shift());Oa(Sa)}}if(t=t||e.arguments,null===Yc&&(Yc=Date.now()),!(0<L)){if(e.preRun)for("function"==typeof e.preRun&&(e.preRun=[e.preRun]);e.preRun.length;)Ta(e.preRun.shift());Oa(Pa),0<L||e.calledRun||(e.setStatus?(e.setStatus("Running..."),setTimeout((function(){setTimeout((function(){e.setStatus("")}),1),r()}),1)):r())}}function ad(t,r){if(!r||!e.noExitRuntime)throw!e.noExitRuntime&&(A=!0,m=void 0,Oa(K),e.onExit)&&e.onExit(t),new xc(t)}e.callMain=e.jd=function(t){function r(){for(var e=0;3>e;e++)i.push(0)}assert(0==L,"cannot call main when async dependencies remain! (listen on __ATMAIN__)"),assert(0==Pa.length,"cannot call main when preRun functions remain to be called"),t=t||[],xa||(xa=!0,Oa(Qa));var a=t.length+1,i=[G(Va(e.thisProgram),"i8",0)];r();for(var n=0;n<a-1;n+=1)i.push(G(Va(t[n]),"i8",0)),r();i.push(0),i=G(i,"i32",0);try{ad(e._main(a,i,0),!0)}catch(t){if(!(t instanceof xc)){if("SimulateInfiniteLoop"!=t)throw t&&"object"==typeof t&&t.stack&&e.S("exception thrown: "+[t,t.stack]),t;e.noExitRuntime=!0}}},e.run=e.run=$c,e.exit=e.exit=ad;var cd=[];function z(t){void 0!==t?(e.print(t),e.S(t),t=JSON.stringify(t)):t="",A=!0;var r="abort("+t+") at "+Ea()+"\nIf this abort() is unexpected, build with -s ASSERTIONS=1 which can give more information.";throw cd&&cd.forEach((function(e){r=e(r,t)})),r}if(e.abort=e.abort=z,e.preInit)for("function"==typeof e.preInit&&(e.preInit=[e.preInit]);0<e.preInit.length;)e.preInit.pop()();var bd=!0;e.noInitialRun&&(bd=!1),$c(),module.exports=e},88120:e=>{var t;!function(){function e(e){if(this.mode=a.MODE_8BIT_BYTE,this.data=e,this.parsedData=[],e instanceof ArrayBuffer)this.parsedData=new Int8Array(e);else{for(var t=0,r=this.data.length;t<r;t++){var i=[],n=this.data.charCodeAt(t);n>65536?(i[0]=240|(1835008&n)>>>18,i[1]=128|(258048&n)>>>12,i[2]=128|(4032&n)>>>6,i[3]=128|63&n):n>2048?(i[0]=224|(61440&n)>>>12,i[1]=128|(4032&n)>>>6,i[2]=128|63&n):n>128?(i[0]=192|(1984&n)>>>6,i[1]=128|63&n):i[0]=n,this.parsedData.push(i)}this.parsedData=Array.prototype.concat.apply([],this.parsedData),this.parsedData.length!=this.data.length&&(this.parsedData.unshift(191),this.parsedData.unshift(187),this.parsedData.unshift(239))}}function r(e,t){this.typeNumber=e,this.errorCorrectLevel=t,this.modules=null,this.moduleCount=0,this.dataCache=null,this.dataList=[]}e.prototype={getLength:function(e){return this.parsedData.length},write:function(e){for(var t=0,r=this.parsedData.length;t<r;t++)e.put(this.parsedData[t],8)}},r.prototype={addData:function(t){var r=new e(t);this.dataList.push(r),this.dataCache=null},isDark:function(e,t){if(e<0||this.moduleCount<=e||t<0||this.moduleCount<=t)throw new Error(e+","+t);return this.modules[e][t]},getModuleCount:function(){return this.moduleCount},make:function(){this.makeImpl(!1,this.getBestMaskPattern())},makeImpl:function(e,t){this.moduleCount=4*this.typeNumber+17,this.modules=new Array(this.moduleCount);for(var a=0;a<this.moduleCount;a++){this.modules[a]=new Array(this.moduleCount);for(var i=0;i<this.moduleCount;i++)this.modules[a][i]=null}this.setupPositionProbePattern(0,0),this.setupPositionProbePattern(this.moduleCount-7,0),this.setupPositionProbePattern(0,this.moduleCount-7),this.setupPositionAdjustPattern(),this.setupTimingPattern(),this.setupTypeInfo(e,t),this.typeNumber>=7&&this.setupTypeNumber(e),null==this.dataCache&&(this.dataCache=r.createData(this.typeNumber,this.errorCorrectLevel,this.dataList)),this.mapData(this.dataCache,t)},setupPositionProbePattern:function(e,t){for(var r=-1;r<=7;r++)if(!(e+r<=-1||this.moduleCount<=e+r))for(var a=-1;a<=7;a++)t+a<=-1||this.moduleCount<=t+a||(this.modules[e+r][t+a]=0<=r&&r<=6&&(0==a||6==a)||0<=a&&a<=6&&(0==r||6==r)||2<=r&&r<=4&&2<=a&&a<=4)},getBestMaskPattern:function(){for(var e=0,t=0,r=0;r<8;r++){this.makeImpl(!0,r);var a=h.getLostPoint(this);(0==r||e>a)&&(e=a,t=r)}return t},createMovieClip:function(e,t,r){var a=e.createEmptyMovieClip(t,r);this.make();for(var i=0;i<this.modules.length;i++)for(var n=1*i,s=0;s<this.modules[i].length;s++){var o=1*s;this.modules[i][s]&&(a.beginFill(0,100),a.moveTo(o,n),a.lineTo(o+1,n),a.lineTo(o+1,n+1),a.lineTo(o,n+1),a.endFill())}return a},setupTimingPattern:function(){for(var e=8;e<this.moduleCount-8;e++)null==this.modules[e][6]&&(this.modules[e][6]=e%2==0);for(var t=8;t<this.moduleCount-8;t++)null==this.modules[6][t]&&(this.modules[6][t]=t%2==0)},setupPositionAdjustPattern:function(){for(var e=h.getPatternPosition(this.typeNumber),t=0;t<e.length;t++)for(var r=0;r<e.length;r++){var a=e[t],i=e[r];if(null==this.modules[a][i])for(var n=-2;n<=2;n++)for(var s=-2;s<=2;s++)this.modules[a+n][i+s]=-2==n||2==n||-2==s||2==s||0==n&&0==s}},setupTypeNumber:function(e){for(var t=h.getBCHTypeNumber(this.typeNumber),r=0;r<18;r++){var a=!e&&1==(t>>r&1);this.modules[Math.floor(r/3)][r%3+this.moduleCount-8-3]=a}for(r=0;r<18;r++){a=!e&&1==(t>>r&1);this.modules[r%3+this.moduleCount-8-3][Math.floor(r/3)]=a}},setupTypeInfo:function(e,t){for(var r=this.errorCorrectLevel<<3|t,a=h.getBCHTypeInfo(r),i=0;i<15;i++){var n=!e&&1==(a>>i&1);i<6?this.modules[i][8]=n:i<8?this.modules[i+1][8]=n:this.modules[this.moduleCount-15+i][8]=n}for(i=0;i<15;i++){n=!e&&1==(a>>i&1);i<8?this.modules[8][this.moduleCount-i-1]=n:i<9?this.modules[8][15-i-1+1]=n:this.modules[8][15-i-1]=n}this.modules[this.moduleCount-8][8]=!e},mapData:function(e,t){for(var r=-1,a=this.moduleCount-1,i=7,n=0,s=this.moduleCount-1;s>0;s-=2)for(6==s&&s--;;){for(var o=0;o<2;o++)if(null==this.modules[a][s-o]){var l=!1;n<e.length&&(l=1==(e[n]>>>i&1)),h.getMask(t,a,s-o)&&(l=!l),this.modules[a][s-o]=l,-1==--i&&(n++,i=7)}if((a+=r)<0||this.moduleCount<=a){a-=r,r=-r;break}}}},r.PAD0=236,r.PAD1=17,r.createData=function(e,t,a){for(var i=g.getRSBlocks(e,t),n=new v,s=0;s<a.length;s++){var o=a[s];n.put(o.mode,4),n.put(o.getLength(),h.getLengthInBits(o.mode,e)),o.write(n)}var l=0;for(s=0;s<i.length;s++)l+=i[s].dataCount;if(n.getLengthInBits()>8*l)throw new Error("code length overflow. ("+n.getLengthInBits()+">"+8*l+")");for(n.getLengthInBits()+4<=8*l&&n.put(0,4);n.getLengthInBits()%8!=0;)n.putBit(!1);for(;!(n.getLengthInBits()>=8*l||(n.put(r.PAD0,8),n.getLengthInBits()>=8*l));)n.put(r.PAD1,8);return r.createBytes(n,i)},r.createBytes=function(e,t){for(var r=0,a=0,i=0,n=new Array(t.length),s=new Array(t.length),o=0;o<t.length;o++){var l=t[o].dataCount,d=t[o].totalCount-l;a=Math.max(a,l),i=Math.max(i,d),n[o]=new Array(l);for(var u=0;u<n[o].length;u++)n[o][u]=255&e.buffer[u+r];r+=l;var c=h.getErrorCorrectPolynomial(d),p=new m(n[o],c.getLength()-1).mod(c);s[o]=new Array(c.getLength()-1);for(u=0;u<s[o].length;u++){var f=u+p.getLength()-s[o].length;s[o][u]=f>=0?p.get(f):0}}var _=0;for(u=0;u<t.length;u++)_+=t[u].totalCount;var g=new Array(_),v=0;for(u=0;u<a;u++)for(o=0;o<t.length;o++)u<n[o].length&&(g[v++]=n[o][u]);for(u=0;u<i;u++)for(o=0;o<t.length;o++)u<s[o].length&&(g[v++]=s[o][u]);return g};for(var a={MODE_NUMBER:1,MODE_ALPHA_NUM:2,MODE_8BIT_BYTE:4,MODE_KANJI:8},i={L:1,M:0,Q:3,H:2},n=0,s=1,o=2,l=3,d=4,u=5,c=6,p=7,h={PATTERN_POSITION_TABLE:[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],G15:1335,G18:7973,G15_MASK:21522,getBCHTypeInfo:function(e){for(var t=e<<10;h.getBCHDigit(t)-h.getBCHDigit(h.G15)>=0;)t^=h.G15<<h.getBCHDigit(t)-h.getBCHDigit(h.G15);return(e<<10|t)^h.G15_MASK},getBCHTypeNumber:function(e){for(var t=e<<12;h.getBCHDigit(t)-h.getBCHDigit(h.G18)>=0;)t^=h.G18<<h.getBCHDigit(t)-h.getBCHDigit(h.G18);return e<<12|t},getBCHDigit:function(e){for(var t=0;0!=e;)t++,e>>>=1;return t},getPatternPosition:function(e){return h.PATTERN_POSITION_TABLE[e-1]},getMask:function(e,t,r){switch(e){case n:return(t+r)%2==0;case s:return t%2==0;case o:return r%3==0;case l:return(t+r)%3==0;case d:return(Math.floor(t/2)+Math.floor(r/3))%2==0;case u:return t*r%2+t*r%3==0;case c:return(t*r%2+t*r%3)%2==0;case p:return(t*r%3+(t+r)%2)%2==0;default:throw new Error("bad maskPattern:"+e)}},getErrorCorrectPolynomial:function(e){for(var t=new m([1],0),r=0;r<e;r++)t=t.multiply(new m([1,f.gexp(r)],0));return t},getLengthInBits:function(e,t){if(1<=t&&t<10)switch(e){case a.MODE_NUMBER:return 10;case a.MODE_ALPHA_NUM:return 9;case a.MODE_8BIT_BYTE:case a.MODE_KANJI:return 8;default:throw new Error("mode:"+e)}else if(t<27)switch(e){case a.MODE_NUMBER:return 12;case a.MODE_ALPHA_NUM:return 11;case a.MODE_8BIT_BYTE:return 16;case a.MODE_KANJI:return 10;default:throw new Error("mode:"+e)}else{if(!(t<41))throw new Error("type:"+t);switch(e){case a.MODE_NUMBER:return 14;case a.MODE_ALPHA_NUM:return 13;case a.MODE_8BIT_BYTE:return 16;case a.MODE_KANJI:return 12;default:throw new Error("mode:"+e)}}},getLostPoint:function(e){for(var t=e.getModuleCount(),r=0,a=0;a<t;a++)for(var i=0;i<t;i++){for(var n=0,s=e.isDark(a,i),o=-1;o<=1;o++)if(!(a+o<0||t<=a+o))for(var l=-1;l<=1;l++)i+l<0||t<=i+l||0==o&&0==l||s==e.isDark(a+o,i+l)&&n++;n>5&&(r+=3+n-5)}for(a=0;a<t-1;a++)for(i=0;i<t-1;i++){var d=0;e.isDark(a,i)&&d++,e.isDark(a+1,i)&&d++,e.isDark(a,i+1)&&d++,e.isDark(a+1,i+1)&&d++,0!=d&&4!=d||(r+=3)}for(a=0;a<t;a++)for(i=0;i<t-6;i++)e.isDark(a,i)&&!e.isDark(a,i+1)&&e.isDark(a,i+2)&&e.isDark(a,i+3)&&e.isDark(a,i+4)&&!e.isDark(a,i+5)&&e.isDark(a,i+6)&&(r+=40);for(i=0;i<t;i++)for(a=0;a<t-6;a++)e.isDark(a,i)&&!e.isDark(a+1,i)&&e.isDark(a+2,i)&&e.isDark(a+3,i)&&e.isDark(a+4,i)&&!e.isDark(a+5,i)&&e.isDark(a+6,i)&&(r+=40);var u=0;for(i=0;i<t;i++)for(a=0;a<t;a++)e.isDark(a,i)&&u++;return r+=10*(Math.abs(100*u/t/t-50)/5)}},f={glog:function(e){if(e<1)throw new Error("glog("+e+")");return f.LOG_TABLE[e]},gexp:function(e){for(;e<0;)e+=255;for(;e>=256;)e-=255;return f.EXP_TABLE[e]},EXP_TABLE:new Array(256),LOG_TABLE:new Array(256)},_=0;_<8;_++)f.EXP_TABLE[_]=1<<_;for(_=8;_<256;_++)f.EXP_TABLE[_]=f.EXP_TABLE[_-4]^f.EXP_TABLE[_-5]^f.EXP_TABLE[_-6]^f.EXP_TABLE[_-8];for(_=0;_<255;_++)f.LOG_TABLE[f.EXP_TABLE[_]]=_;function m(e,t){if(null==e.length)throw new Error(e.length+"/"+t);for(var r=0;r<e.length&&0==e[r];)r++;this.num=new Array(e.length-r+t);for(var a=0;a<e.length-r;a++)this.num[a]=e[a+r]}function g(e,t){this.totalCount=e,this.dataCount=t}function v(){this.buffer=[],this.length=0}m.prototype={get:function(e){return this.num[e]},getLength:function(){return this.num.length},multiply:function(e){for(var t=new Array(this.getLength()+e.getLength()-1),r=0;r<this.getLength();r++)for(var a=0;a<e.getLength();a++)t[r+a]^=f.gexp(f.glog(this.get(r))+f.glog(e.get(a)));return new m(t,0)},mod:function(e){if(this.getLength()-e.getLength()<0)return this;for(var t=f.glog(this.get(0))-f.glog(e.get(0)),r=new Array(this.getLength()),a=0;a<this.getLength();a++)r[a]=this.get(a);for(a=0;a<e.getLength();a++)r[a]^=f.gexp(f.glog(e.get(a))+t);return new m(r,0).mod(e)}},g.RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],g.getRSBlocks=function(e,t){var r=g.getRsBlockTable(e,t);if(null==r)throw new Error("bad rs block @ typeNumber:"+e+"/errorCorrectLevel:"+t);for(var a=r.length/3,i=[],n=0;n<a;n++)for(var s=r[3*n+0],o=r[3*n+1],l=r[3*n+2],d=0;d<s;d++)i.push(new g(o,l));return i},g.getRsBlockTable=function(e,t){switch(t){case i.L:return g.RS_BLOCK_TABLE[4*(e-1)+0];case i.M:return g.RS_BLOCK_TABLE[4*(e-1)+1];case i.Q:return g.RS_BLOCK_TABLE[4*(e-1)+2];case i.H:return g.RS_BLOCK_TABLE[4*(e-1)+3];default:return}},v.prototype={get:function(e){var t=Math.floor(e/8);return 1==(this.buffer[t]>>>7-e%8&1)},put:function(e,t){for(var r=0;r<t;r++)this.putBit(1==(e>>>t-r-1&1))},getLengthInBits:function(){return this.length},putBit:function(e){var t=Math.floor(this.length/8);this.buffer.length<=t&&this.buffer.push(0),e&&(this.buffer[t]|=128>>>this.length%8),this.length++}};var E=[[17,14,11,7],[32,26,20,14],[53,42,32,24],[78,62,46,34],[106,84,60,44],[134,106,74,58],[154,122,86,64],[192,152,108,84],[230,180,130,98],[271,213,151,119],[321,251,177,137],[367,287,203,155],[425,331,241,177],[458,362,258,194],[520,412,292,220],[586,450,322,250],[644,504,364,280],[718,560,394,310],[792,624,442,338],[858,666,482,382],[929,711,509,403],[1003,779,565,439],[1091,857,611,461],[1171,911,661,511],[1273,997,715,535],[1367,1059,751,593],[1465,1125,805,625],[1528,1190,868,658],[1628,1264,908,698],[1732,1370,982,742],[1840,1452,1030,790],[1952,1538,1112,842],[2068,1628,1168,898],[2188,1722,1228,958],[2303,1809,1283,983],[2431,1911,1351,1051],[2563,1989,1423,1093],[2699,2099,1499,1139],[2809,2213,1579,1219],[2953,2331,1663,1273]],y=function(e,t){this._bIsPainted=!1,this._htOption=t,this._elCanvas=document.createElement("canvas"),this._elCanvas.width=t.width,this._elCanvas.height=t.height,this._elCanvas.setAttribute("aria-label","Scan me!"),this._elCanvas.setAttribute("role","img"),e.appendChild(this._elCanvas),this._el=e,this._oContext=this._elCanvas.getContext("2d"),this._bIsPainted=!1,this._bSupportDataURI=null};function S(e,t){for(var r=1,a=e instanceof ArrayBuffer?e.byteLength:function(e){var t=encodeURI(e).toString().replace(/\%[0-9a-fA-F]{2}/g,"a");return t.length+(t.length!=e.length?3:0)}(e),n=0,s=E.length;n<=s;n++){var o=0;switch(t){case i.L:o=E[n][0];break;case i.M:o=E[n][1];break;case i.Q:o=E[n][2];break;case i.H:o=E[n][3]}if(a<=o)break;r++}if(r>E.length)throw new Error("Too long data");return r}y.prototype.draw=function(e){var t=this._oContext,r=this._htOption,a=e.getModuleCount(),i=r.width/a,n=r.height/a,s=Math.round(i),o=Math.round(n);this.clear();for(var l=0;l<a;l++)for(var d=0;d<a;d++){var u=e.isDark(l,d),c=d*i,p=l*n;t.strokeStyle=u?r.colorDark:r.colorLight,t.lineWidth=1,t.fillStyle=u?r.colorDark:r.colorLight,t.fillRect(c,p,i,n),t.strokeRect(Math.floor(c)+.5,Math.floor(p)+.5,s,o),t.strokeRect(Math.ceil(c)-.5,Math.ceil(p)-.5,s,o)}this._bIsPainted=!0},y.prototype.isPainted=function(){return this._bIsPainted},y.prototype.clear=function(){this._oContext.clearRect(0,0,this._elCanvas.width,this._elCanvas.height),this._bIsPainted=!1},y.prototype.round=function(e){return e?Math.floor(1e3*e)/1e3:e},(t=function(e,t){if(this._htOption={width:256,height:256,typeNumber:4,colorDark:"#000000",colorLight:"#ffffff",correctLevel:i.H},"string"==typeof t&&(t={text:t}),t)for(var r in t)this._htOption[r]=t[r];"string"==typeof e&&(e=document.getElementById(e)),this._el=e,this._oQRCode=null,this._oDrawing=new y(this._el,this._htOption),this._htOption.text&&this.makeCode(this._htOption.text)}).prototype.makeCode=function(e){this._oQRCode=new r(S(e,this._htOption.correctLevel),this._htOption.correctLevel),this._oQRCode.addData(e),this._oQRCode.make(),this._el.title=e,this._oDrawing.draw(this._oQRCode)},t.prototype.clear=function(){this._oDrawing.clear()},t.CorrectLevel=i}(),e.exports=t},48729:(e,t,r)=>{var a={"./af":[63581,6365],"./af.js":[63581,6365],"./ar":[13684,8054],"./ar-XB":[67733,9995],"./ar-XB.js":[67733,9995],"./ar.js":[13684,8054],"./az":[17912,7072],"./az.js":[17912,7072],"./bg":[1185,7102],"./bg.js":[1185,7102],"./bn":[33123,8700],"./bn.js":[33123,8700],"./ca":[59605,5632],"./ca.js":[59605,5632],"./cs":[68209,165],"./cs.js":[68209,165],"./da":[96219,1628],"./da.js":[96219,1628],"./de":[46278,7216],"./de.js":[46278,7216],"./el":[43597,1204],"./el.js":[43597,1204],"./en":[57454,6933],"./en.js":[57454,6933],"./es":[5475,673],"./es.js":[5475,673],"./et":[45502,792],"./et.js":[45502,792],"./fa":[24950,9999],"./fa.js":[24950,9999],"./fi":[82075,9613],"./fi.js":[82075,9613],"./fil":[3565,907],"./fil.js":[3565,907],"./fr":[31418,6293],"./fr.js":[31418,6293],"./gu":[60364,6038],"./gu.js":[60364,6038],"./he":[32410,5729],"./he.js":[32410,5729],"./hi":[63247,3722],"./hi.js":[63247,3722],"./hr":[96314,5708],"./hr.js":[96314,5708],"./hu":[53676,2556],"./hu.js":[53676,2556],"./id":[48971,5128],"./id.js":[48971,5128],"./it":[99985,2830],"./it.js":[99985,2830],"./ja":[25847,5182],"./ja.js":[25847,5182],"./kk":[84498,9719],"./kk.js":[84498,9719],"./kn":[55038,155],"./kn.js":[55038,155],"./ko":[66660,820],"./ko.js":[66660,820],"./lt":[68021,1529],"./lt.js":[68021,1529],"./lv":[52047,4708],"./lv.js":[52047,4708],"./mk":[15826,6651],"./mk.js":[15826,6651],"./ml":[61565,6655],"./ml.js":[61565,6655],"./mr":[80692,1248],"./mr.js":[80692,1248],"./ms":[95769,5443],"./ms.js":[95769,5443],"./nb":[46214,7749],"./nb.js":[46214,7749],"./nl":[23277,9750],"./nl.js":[23277,9750],"./pa":[81024,9815],"./pa.js":[81024,9815],"./pl":[47356,8628],"./pl.js":[47356,8628],"./pt":[79968,2144,6953],"./pt-BR":[83776,2144,2091],"./pt-BR.js":[83776,2144,2091],"./pt.js":[79968,2144,6953],"./ro":[48314,7162],"./ro.js":[48314,7162],"./ru":[88799,8292],"./ru.js":[88799,8292],"./sk":[77300,1770],"./sk.js":[77300,1770],"./sl":[88091,4259],"./sl.js":[88091,4259],"./sq":[30839,9737],"./sq.js":[30839,9737],"./sr":[30862,6331],"./sr.js":[30862,6331],"./sv":[45985,2944],"./sv.js":[45985,2944],"./sw":[77303,3998],"./sw.js":[77303,3998],"./ta":[29710,2739],"./ta.js":[29710,2739],"./te":[20799,5650],"./te.js":[20799,5650],"./th":[56379,2135],"./th.js":[56379,2135],"./tr":[95039,248],"./tr.js":[95039,248],"./uk":[39857,906],"./uk.js":[39857,906],"./ur":[85107,4361],"./ur.js":[85107,4361],"./uz":[63372,4873],"./uz.js":[63372,4873],"./vi":[74345,8598],"./vi.js":[74345,8598],"./zh-CN":[27137,6483],"./zh-CN.js":[27137,6483],"./zh-HK":[51990,1081],"./zh-HK.js":[51990,1081],"./zh-TW":[10130,7542],"./zh-TW.js":[10130,7542]};function i(e){if(!r.o(a,e))return Promise.resolve().then((()=>{var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=a[e],i=t[0];return Promise.all(t.slice(1).map(r.e)).then((()=>r(i)))}i.keys=()=>Object.keys(a),i.id=48729,e.exports=i},77062:(e,t,r)=>{var a={"./af":[68603,3748],"./af.js":[68603,3748],"./ar":[71295,1473],"./ar-DZ":[92722,6884],"./ar-DZ.js":[92722,6884],"./ar-KW":[88456,6282],"./ar-KW.js":[88456,6282],"./ar-LY":[1119,5671],"./ar-LY.js":[1119,5671],"./ar-MA":[66447,2966],"./ar-MA.js":[66447,2966],"./ar-SA":[30178,9646],"./ar-SA.js":[30178,9646],"./ar-TN":[81468,9289],"./ar-TN.js":[81468,9289],"./ar-XB":[72384,3934],"./ar-XB.js":[72384,3934],"./ar.js":[71295,1473],"./az":[53161,5740],"./az.js":[53161,5740],"./bn":[14740,7728],"./bn.js":[14740,7728],"./ca":[69166,9817],"./ca.js":[69166,9817],"./cs":[15203,2023],"./cs.js":[15203,2023],"./da":[77278,7315],"./da.js":[77278,7315],"./de":[81626,5862],"./de.js":[81626,5862],"./el":[69079,1055],"./el.js":[69079,1055],"./en-AU":[27204,8678],"./en-AU.js":[27204,8678],"./en-CA":[93653,4616],"./en-CA.js":[93653,4616],"./en-GB":[79641,9227],"./en-GB.js":[79641,9227],"./en-IE":[25429,2979],"./en-IE.js":[25429,2979],"./en-NZ":[78305,3892],"./en-NZ.js":[78305,3892],"./es":[92674,1791],"./es-DO":[2807,2394],"./es-DO.js":[2807,2394],"./es.js":[92674,1791],"./et":[32747,4473],"./et.js":[32747,4473],"./fa":[26432,7662],"./fa.js":[26432,7662],"./fi":[7340,7386],"./fi.js":[7340,7386],"./fr":[95325,2445],"./fr-CA":[3305,9765],"./fr-CA.js":[3305,9765],"./fr-CH":[55928,8799],"./fr-CH.js":[55928,8799],"./fr.js":[95325,2445],"./he":[77254,5027],"./he.js":[77254,5027],"./hi":[68597,6709],"./hi.js":[68597,6709],"./hr":[94935,1381],"./hr.js":[94935,1381],"./hu":[87634,4339],"./hu.js":[87634,4339],"./id":[62402,6511],"./id.js":[62402,6511],"./it":[6400,5247],"./it.js":[6400,5247],"./kk":[17994,7074],"./kk.js":[17994,7074],"./kn":[60421,6568],"./kn.js":[60421,6568],"./ko":[9009,4818],"./ko.js":[9009,4818],"./lt":[58528,6920],"./lt.js":[58528,6920],"./mk":[55723,9545],"./mk.js":[55723,9545],"./ml":[57284,3113],"./ml.js":[57284,3113],"./mr":[22554,3422],"./mr.js":[22554,3422],"./ms":[34710,7739],"./ms-MY":[38348,1520],"./ms-MY.js":[38348,1520],"./ms.js":[34710,7739],"./nb":[85691,5959],"./nb.js":[85691,5959],"./nl":[3549,319],"./nl.js":[3549,319],"./pa-IN":[67317,8132],"./pa-IN.js":[67317,8132],"./pl":[8181,4980],"./pl.js":[8181,4980],"./pt":[48791,9116],"./pt-BR":[41692,6547],"./pt-BR.js":[41692,6547],"./pt.js":[48791,9116],"./ro":[64820,3569],"./ro.js":[64820,3569],"./ru":[68638,2957],"./ru.js":[68638,2957],"./sl":[9827,3501],"./sl.js":[9827,3501],"./sq":[83418,6496],"./sq.js":[83418,6496],"./sr":[59847,5170],"./sr-CYRL":[10027,5790],"./sr-CYRL.js":[10027,5790],"./sr.js":[59847,5170],"./sv":[11966,1069],"./sv.js":[11966,1069],"./sw":[89246,2017],"./sw.js":[89246,2017],"./ta":[39298,8634],"./ta.js":[39298,8634],"./te":[32290,3370],"./te.js":[32290,3370],"./tr":[90775,9313],"./tr.js":[90775,9313],"./uk":[16591,9682],"./uk.js":[16591,9682],"./ur":[31520,6163],"./ur.js":[31520,6163],"./uz":[56013,3017],"./uz-LATN":[16178,8117],"./uz-LATN.js":[16178,8117],"./uz.js":[56013,3017],"./zh-CN":[19818,3047],"./zh-CN.js":[19818,3047],"./zh-TW":[13061,5125],"./zh-TW.js":[13061,5125]};function i(e){if(!r.o(a,e))return Promise.resolve().then((()=>{var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=a[e],i=t[0];return r.e(t[1]).then((()=>r(i)))}i.keys=()=>Object.keys(a),i.id=77062,e.exports=i},11284:e=>{"use strict";e.exports=JSON.parse('{"application/":{"applixware":"aw","atom+xml":"atom","atomcat+xml":"atomcat","atomsvc+xml":"atomsvc","ccxml+xml":"ccxml","cdmi-":{"capability":"cdmia","container":"cdmic","domain":"cdmid","object":"cdmio","queue":"cdmiq"},"davmount+xml":"davmount","docbook+xml":"dbk","dssc+der":"dssc","dssc+xml":"xdssc","ecmascript":"ecma","emma+xml":"emma","epub+zip":"epub","exi":"exi","font-":{"tdpfr":"pfr","woff":"woff"},"gml+xml":"gml","gpx+xml":"gpx","gxf":"gxf","hyperstudio":"stk","inkml+xml":["ink","inkml"],"ipfix":"ipfix","java-":{"archive":"jar","vm":"class","serialized-object":"ser"},"javascript":"js","json":"json","jsonml+json":"jsonml","lost+xml":"lostxml","mac-":{"binhex40":"hqx","compactpro":"cpt"},"mads+xml":"mads","marc":"mrc","marcxml+xml":"mrcx","mathematica":["ma","nb","mb"],"mathml+xml":"mathml","mbox":"mbox","mediaservercontrol+xml":"mscml","metalink+xml":"metalink","metalink4+xml":"meta4","mets+xml":"mets","mods+xml":"mods","mp21":["m21","mp21"],"mp4":"mp4s","msword":["doc","dot"],"mxf":"mxf","oda":"oda","ogg":"ogx","omdoc+xml":"omdoc","onenote":["onetoc","onetoc2","onetmp","onepkg"],"oxps":"oxps","pdf":"pdf","pgp-":{"encrypted":"pgp","signature":["asc","sig"]},"pkcs10":"p10","pkcs7-":{"mime":["p7m","p7c"],"signature":"p7s"},"pkcs8":"p8","pkix-":{"cert":"cer","crl":"crl","pkipath":"pkipath","attr-cert":"ac"},"pkixcmp":"pki","pls+xml":"pls","postscript":["ai","eps","ps"],"pskc+xml":"pskcxml","rdf+xml":"rdf","reginfo+xml":"rif","resource-":{"lists+xml":"rl","lists-diff+xml":"rld"},"rpki-":{"ghostbusters":"gbr","manifest":"mft","roa":"roa"},"rsd+xml":"rsd","rss+xml":"rss","rtf":"rtf","sbml+xml":"sbml","scvp-":{"cv-":{"request":"scq","response":"scs"},"vp-":{"request":"spq","response":"spp"}},"sdp":"sdp","set-":{"payment-initiation":"setpay","registration-initiation":"setreg"},"shf+xml":"shf","smil+xml":["smi","smil"],"sparql-":{"query":"rq","results+xml":"srx"},"srgs":"gram","srgs+xml":"grxml","sru+xml":"sru","ssdl+xml":"ssdl","ssml+xml":"ssml","tei+xml":["tei","teicorpus"],"thraud+xml":"tfi","vnd.":{"acucobol":"acu","acucorp":["atc","acutc"],"adobe.":{"fxp":["fxp","fxpl"],"xdp+xml":"xdp","xfdf":"xfdf","formscentral.fcdt":"fcdt","air-application-installer-package+zip":"air"},"apple.":{"installer+xml":"mpkg","mpegurl":"m3u8"},"audiograph":"aep","bmi":"bmi","businessobjects":"rep","chemdraw+xml":"cdxml","cinderella":"cdy","claymore":"cla","commonspace":"csp","cosmocaller":"cmc","crick.":{"clicker":"clkx","clicker.":{"keyboard":"clkk","palette":"clkp","template":"clkt","wordbank":"clkw"}},"curl.":{"car":"car","pcurl":"pcurl"},"dart":"dart","dece.":{"data":["uvf","uvvf","uvd","uvvd"],"ttml+xml":["uvt","uvvt"],"unspecified":["uvx","uvvx"],"zip":["uvz","uvvz"]},"dna":"dna","dpgraph":"dpg","dreamfactory":"dfac","dvb.":{"ait":"ait","service":"svc"},"dynageo":"geo","enliven":"nml","epson.":{"esf":"esf","msf":"msf","quickanime":"qam","salt":"slt","ssf":"ssf"},"eszigno3+xml":["es3","et3"],"ezpix-":{"album":"ez2","package":"ez3"},"fdf":"fdf","fdsn.":{"mseed":"mseed","seed":["seed","dataless"]},"flographit":"gph","framemaker":["fm","frame","maker","book"],"frogans.":{"fnc":"fnc","ltf":"ltf"},"fujitsu.":{"oasys":"oas","oasys2":"oa2","oasys3":"oa3","oasysgp":"fg5","oasysprs":"bh2"},"fujixerox.":{"ddd":"ddd","docuworks":"xdw","docuworks.binder":"xbd"},"fuzzysheet":"fzs","geogebra.":{"file":"ggb","tool":"ggt"},"geonext":"gxt","geoplan":"g2w","geospace":"g3w","gmx":"gmx","grafeq":["gqf","gqs"],"groove-":{"account":"gac","help":"ghf","injector":"grv","tool-":{"message":"gtm","template":"tpl"},"vcard":"vcg","identity-message":"gim"},"hal+xml":"hal","hbci":"hbci","hp-":{"hpgl":"hpgl","hpid":"hpid","hps":"hps","jlyt":"jlt","pcl":"pcl","pclxl":"pclxl"},"ibm.":{"minipay":"mpy","modcap":["afp","listafp","list3820"],"rights-management":"irm","secure-container":"sc"},"iccprofile":["icc","icm"],"igloader":"igl","immervision-":{"ivp":"ivp","ivu":"ivu"},"intergeo":"i2g","intu.":{"qbo":"qbo","qfx":"qfx"},"jam":"jam","jisp":"jisp","kahootz":["ktz","ktr"],"kde.":{"karbon":"karbon","kchart":"chrt","kformula":"kfo","kivio":"flw","kontour":"kon","kpresenter":["kpr","kpt"],"kspread":"ksp","kword":["kwd","kwt"]},"kenameaapp":"htke","kidspiration":"kia","kinar":["kne","knp"],"koan":["skp","skd","skt","skm"],"lotus-":{"approach":"apr","freelance":"pre","notes":"nsf","organizer":"org","screencam":"scm","wordpro":"lwp","1-2-3":"123"},"mcd":"mcd","medcalcdata":"mc1","mfer":"mwf","mfmp":"mfm","micrografx.":{"flo":"flo","igx":"igx"},"mif":"mif","mobius.":{"daf":"daf","dis":"dis","mbk":"mbk","mqy":"mqy","msl":"msl","plc":"plc","txf":"txf"},"mophun.":{"application":"mpn","certificate":"mpc"},"ms-":{"artgalry":"cil","excel":["xls","xlm","xla","xlc","xlt","xlw"],"excel.":{"sheet.":{"macroenabled.12":"xlsm","binary.macroenabled.12":"xlsb"},"addin.macroenabled.12":"xlam","template.macroenabled.12":"xltm"},"fontobject":"eot","htmlhelp":"chm","ims":"ims","lrm":"lrm","officetheme":"thmx","pki.":{"seccat":"cat","stl":"stl"},"powerpoint":["ppt","pps","pot"],"powerpoint.":{"addin.macroenabled.12":"ppam","presentation.macroenabled.12":"pptm","slide.macroenabled.12":"sldm","slideshow.macroenabled.12":"ppsm","template.macroenabled.12":"potm"},"project":["mpp","mpt"],"word.":{"document.macroenabled.12":"docm","template.macroenabled.12":"dotm"},"works":["wps","wks","wcm","wdb"],"wpl":"wpl","xpsdocument":"xps","cab-compressed":"cab"},"mseq":"mseq","musician":"mus","mynfc":"taglet","nitf":["ntf","nitf"],"noblenet-":{"directory":"nnd","sealer":"nns","web":"nnw"},"nokia.":{"radio-":{"preset":"rpst","presets":"rpss"},"n-gage.":{"data":"ngdat","symbian.install":"n-gage"}},"novadigm.":{"edm":"edm","edx":"edx","ext":"ext"},"osgi.":{"dp":"dp","subsystem":"esa"},"palm":["pdb","pqa","oprc"],"pawaafile":"paw","pg.":{"format":"str","osasli":"ei6"},"picsel":"efif","pocketlearn":"plf","powerbuilder6":"pbd","recordare.":{"musicxml":"mxl","musicxml+xml":"musicxml"},"rn-":{"realmedia":"rm","realmedia-vbr":"rmvb"},"seemail":"see","sema":"sema","semd":"semd","semf":"semf","smaf":"mmf","spotfire.":{"dxp":"dxp","sfs":"sfs"},"stardivision.":{"calc":"sdc","draw":"sda","impress":"sdd","math":"smf","writer":["sdw","vor"],"writer-global":"sgl"},"stepmania.":{"package":"smzip","stepchart":"sm"},"svd":"svd","syncml+xml":"xsm","syncml.":{"dm+wbxml":"bdm","dm+xml":"xdm"},"trueapp":"tra","ufdl":["ufd","ufdl"],"umajin":"umj","unity":"unityweb","uoml+xml":"uoml","vcx":"vcx","visio":["vsd","vst","vss","vsw"],"visionary":"vis","vsf":"vsf","Webd.":{"wbxml":"wbxml","wmlc":"wmlc","wmlscriptc":"wmlsc"},"webturbo":"wtb","wordperfect":"wpd","wqd":"wqd","xara":"xar","xfdl":"xfdl","yamaha.":{"hv-":{"dic":"hvd","script":"hvs","voice":"hvp"},"openscoreformat":"osf","smaf-":{"audio":"saf","phrase":"spf"},"openscoreformat.osfpvg+xml":"osfpvg"},"zul":["zir","zirz"],"3gpp2.tcap":"tcap","accpac.simply.":{"aso":"aso","imp":"imp"},"ahead.space":"ahead","airzip.filesecure.":{"azf":"azf","azs":"azs"},"amazon.ebook":"azw","americandynamics.acc":"acc","amiga.ami":"ami","anser-web-":{"certificate-issue-initiation":"cii","funds-transfer-initiation":"fti"},"aristanetworks.swi":"swi","blueice.multipass":"mpm","cloanto.rp9":"rp9","clonk.c4group":["c4g","c4d","c4f","c4p","c4u"],"cluetrust.cartomobile-":{"config":"c11amc","config-pkg":"c11amz"},"contact.cmsg":"cdbcmsg","criticaltools.wbs+xml":"wbs","ctc-posml":"pml","cups-ppd":"ppd","dolby.mlp":"mlp","ds-keypoint":"kpxx","ecowin.chart":"mag","fluxtime.clip":"ftc","fsc.weblaunch":"fsc","genomatix.tuxedo":"txd","geometry-explorer":["gex","gre"],"google-earth.":{"kml+xml":"kml","kmz":"kmz"},"handheld-entertainment+xml":"zmm","insors.igm":"igm","intercon.formnet":["xpw","xpx"],"ipunplugged.rcprofile":"rcprofile","irepository.package+xml":"irp","is-xpr":"xpr","isac.fcs":"fcs","kodak-descriptor":"sse","las.las+xml":"lasxml","macports.portpkg":"portpkg","mediastation.cdkey":"cdkey","mozilla.xul+xml":"xul","muvee.style":"msty","neurolanguage.nlu":"nlu","oasis.opendocument.":{"chart":"odc","database":"odb","formula":"odf","graphics":"odg","image":"odi","presentation":"odp","spreadsheet":"ods","text":"odt","text-":{"master":"odm","template":"ott","web":"oth"},"chart-template":"otc","formula-template":"odft","graphics-template":"otg","image-template":"oti","presentation-template":"otp","spreadsheet-template":"ots"},"olpc-sugar":"xo","oma.dd2+xml":"dd2","openofficeorg.extension":"oxt","openxmlformats-officedocument.":{"presentationml.":{"presentation":"pptx","slide":"sldx","slideshow":"ppsx","template":"potx"},"spreadsheetml.":{"sheet":"xlsx","template":"xltx"},"wordprocessingml.":{"document":"docx","template":"dotx"}},"pmi.widget":"wg","previewsystems.box":"box","proteus.magazine":"mgz","pvi.ptid1":"ptid","quark.quarkxpress":["qxd","qxt","qwd","qwt","qxl","qxb"],"realvnc.bed":"bed","rig.cryptonote":"cryptonote","rim.cod":"cod","route66.link66+xml":"link66","sailingtracker.track":"st","shana.informed.":{"formdata":"ifm","formtemplate":"itp","interchange":"iif","package":"ipk"},"simtech-mindmapper":["twd","twds"],"smart.teacher":"teacher","solent.sdkm+xml":["sdkm","sdkd"],"sun.xml.":{"calc":"sxc","draw":"sxd","impress":"sxi","math":"sxm","writer":"sxw","writer.":{"global":"sxg","template":"stw"},"calc.template":"stc","draw.template":"std","impress.template":"sti"},"sus-calendar":["sus","susp"],"symbian.install":["sis","sisx"],"tcpdump.pcap":["pcap","cap","dmp"],"tmobile-livetv":"tmo","trid.tpt":"tpt","triscape.mxs":"mxs","uiq.theme":"utz","wolfram.player":"nbp","wt.stf":"stf","zzazz.deck+xml":"zaz","3gpp.pic-bw-":{"large":"plb","small":"psb","var":"pvb"},"3m.post-it-notes":"pwn","android.package-archive":"apk","antix.game-component":"atx","astraea-software.iota":"iota","chipnuts.karaoke-mmd":"mmd","data-vision.rdz":"rdz","denovo.fcselayout-link":"fe_launch","hhe.lesson-player":"les","hydrostatix.sof-data":"sfd-hdstx","jcp.javame.midlet-rms":"rms","joost.joda-archive":"joda","llamagraphics.life-balance.":{"desktop":"lbd","exchange+xml":"lbe"},"osgeo.mapguide.package":"mgp","publishare-delta-tree":"qps","tao.intent-module-archive":"tao","yellowriver-custom-menu":"cmp"},"voicexml+xml":"vxml","widget":"wgt","winhlp":"hlp","wsdl+xml":"wsdl","wspolicy+xml":"wspolicy","x-":{"abiword":"abw","authorware-":{"bin":["aab","x32","u32","vox"],"map":"aam","seg":"aas"},"bcpio":"bcpio","bittorrent":"torrent","blorb":["blb","blorb"],"bzip":"bz","bzip2":["bz2","boz"],"cbr":["cbr","cba","cbt","cbz","cb7"],"cdlink":"vcd","chat":"chat","conference":"nsc","cpio":"cpio","csh":"csh","director":["dir","dcr","dxr","cst","cct","cxt","w3d","fgd","swa"],"doom":"wad","dtbncx+xml":"ncx","dtbook+xml":"dtb","dtbresource+xml":"res","dvi":"dvi","envoy":"evy","eva":"eva","font-":{"bdf":"bdf","ghostscript":"gsf","otf":"otf","pcf":"pcf","snf":"snf","ttf":["ttf","ttc"],"type1":["pfa","pfb","pfm","afm"],"linux-psf":"psf"},"freearc":"arc","futuresplash":"spl","glulx":"ulx","gnumeric":"gnumeric","gtar":"gtar","hdf":"hdf","latex":"latex","mie":"mie","ms-":{"application":"application","shortcut":"lnk","wmd":"wmd","wmz":"wmz","xbap":"xbap"},"msaccess":"mdb","msbinder":"obd","mscardfile":"crd","msclip":"clp","msdownload":["exe","dll","com","bat","msi"],"msmediaview":["mvb","m13","m14"],"msmetafile":["wmf","wmz","emf","emz"],"msmoney":"mny","mspublisher":"pub","msschedule":"scd","msterminal":"trm","mswrite":"wri","netcdf":["nc","cdf"],"nzb":"nzb","pkcs12":["p12","pfx"],"pkcs7-":{"certificates":["p7b","spc"],"certreqresp":"p7r"},"sh":"sh","shar":"shar","sql":"sql","stuffit":"sit","stuffitx":"sitx","subrip":"srt","sv4cpio":"sv4cpio","sv4crc":"sv4crc","tads":"gam","tar":"tar","tcl":"tcl","tex":"tex","texinfo":["texinfo","texi"],"tgif":"obj","ustar":"ustar","xfig":"fig","xliff+xml":"xlf","xpinstall":"xpi","xz":"xz","zmachine":["z1","z2","z3","z4","z5","z6","z7","z8"],"7z-compressed":"7z","ace-compressed":"ace","apple-diskimage":"dmg","cfs-compressed":"cfs","chess-pgn":"pgn","debian-package":["deb","udeb"],"dgc-compressed":"dgc","gca-compressed":"gca","gramps-xml":"gramps","install-instructions":"install","iso9660-image":"iso","lzh-compressed":["lzh","lha"],"mobipocket-ebook":["prc","mobi"],"rar-compressed":"rar","shockwave-flash":"swf","silverlight-app":"xap","t3vm-image":"t3","tex-tfm":"tfm","wais-source":"src","java-jnlp-file":"jnlp","research-info-systems":"ris","x509-ca-cert":["der","crt"]},"xaml+xml":"xaml","xenc+xml":"xenc","xhtml+xml":["xhtml","xht"],"xml":["xml","xsl"],"xop+xml":"xop","xproc+xml":"xpl","xslt+xml":"xslt","xspf+xml":"xspf","xv+xml":["mxml","xhvml","xvml","xvm"],"yang":"yang","yin+xml":"yin","zip":"zip","andrew-inset":"ez","cu-seeme":"cu","octet-stream":["bin","dms","lrf","mar","so","dist","distz","pkg","bpk","dump","elc","deploy"],"oebps-package+xml":"opf","pics-rules":"prf","prs.cww":"cww","rls-services+xml":"rs","timestamped-data":"tsd","xcap-diff+xml":"xdf","xml-dtd":"dtd","patch-ops-error+xml":"xer","relax-ng-compact-syntax":"rnc"},"audio/":{"adpcm":"adp","basic":["au","snd"],"midi":["mid","midi","kar","rmi"],"mp4":["m4a","mp4a"],"mpeg":["mpga","mp2","mp2a","mp3","m2a","m3a"],"ogg":["oga","ogg","spx"],"s3m":"s3m","silk":"sil","vnd.":{"dra":"dra","dts":"dts","nuera.":{"ecelp4800":"ecelp4800","ecelp7470":"ecelp7470","ecelp9600":"ecelp9600"},"rip":"rip","dece.audio":["uva","uvva"],"digital-winds":"eol","dts.hd":"dtshd","lucent.voice":"lvp","ms-playready.media.pya":"pya"},"webm":"weba","x-":{"aac":"aac","aiff":["aif","aiff","aifc"],"caf":"caf","flac":"flac","matroska":"mka","mpegurl":"m3u","ms-":{"wax":"wax","wma":"wma"},"pn-":{"realaudio":["ram","ra"],"realaudio-plugin":"rmp"},"wav":"wav"},"xm":"xm"},"image/":{"bmp":"bmp","cgm":"cgm","g3fax":"g3","gif":"gif","ief":"ief","jpeg":["jpeg","jpg","jpe"],"ktx":"ktx","png":"png","sgi":"sgi","svg+xml":["svg","svgz"],"tiff":["tiff","tif"],"vnd.":{"djvu":["djvu","djv"],"dwg":"dwg","dxf":"dxf","fastbidsheet":"fbs","fpx":"fpx","fst":"fst","ms-":{"modi":"mdi","photo":"wdp"},"xiff":"xif","adobe.photoshop":"psd","dece.graphic":["uvi","uvvi","uvg","uvvg"],"dvb.subtitle":"sub","fujixerox.edmics-":{"mmr":"mmr","rlc":"rlc"},"net-fpx":"npx","wap.wbmp":"wbmp"},"webp":"webp","x-":{"3ds":"3ds","cmx":"cmx","freehand":["fh","fhc","fh4","fh5","fh7"],"icon":"ico","pcx":"pcx","pict":["pic","pct"],"portable-":{"anymap":"pnm","bitmap":"pbm","graymap":"pgm","pixmap":"ppm"},"rgb":"rgb","tga":"tga","xbitmap":"xbm","xpixmap":"xpm","xwindowdump":"xwd","cmu-raster":"ras","mrsid-image":"sid"},"prs.btif":"btif"},"model/":{"iges":["igs","iges"],"mesh":["msh","mesh","silo"],"vnd.":{"collada+xml":"dae","dwf":"dwf","gdl":"gdl","gtw":"gtw","mts":"mts","vtu":"vtu"},"vrml":["wrl","vrml"],"x3d+binary":["x3db","x3dbz"],"x3d+vrml":["x3dv","x3dvz"],"x3d+xml":["x3d","x3dz"]},"text/":{"calendar":["ics","ifb"],"css":"css","csv":"csv","html":["html","htm"],"n3":"n3","plain":["txt","text","conf","def","list","log","in"],"richtext":"rtx","sgml":["sgml","sgm"],"troff":["t","tr","roff","man","me","ms"],"turtle":"ttl","vcard":"vcard","vnd.":{"curl":"curl","curl.":{"dcurl":"dcurl","mcurl":"mcurl","scurl":"scurl"},"fly":"fly","graphviz":"gv","in3d.":{"3dml":"3dml","spot":"spot"},"wap.":{"wml":"wml","wmlscript":"wmls"},"dvb.subtitle":"sub","fmi.flexstor":"flx","sun.j2me.app-descriptor":"jad"},"x-":{"asm":["s","asm"],"c":["c","cc","cxx","cpp","h","hh","dic"],"fortran":["f","for","f77","f90"],"nfo":"nfo","opml":"opml","pascal":["p","pas"],"setext":"etx","sfv":"sfv","uuencode":"uu","vcalendar":"vcs","vcard":"vcf","java-source":"java"},"cache-manifest":"appcache","uri-list":["uri","uris","urls"],"prs.lines.tag":"dsc","tab-separated-values":"tsv"},"video/":{"3gpp":"3gp","3gpp2":"3g2","h261":"h261","h263":"h263","h264":"h264","jpeg":"jpgv","jpm":["jpm","jpgm"],"mj2":["mj2","mjp2"],"mp4":["mp4","mp4v","mpg4"],"mpeg":["mpeg","mpg","mpe","m1v","m2v"],"ogg":"ogv","quicktime":["qt","mov"],"vnd.":{"dece.":{"hd":["uvh","uvvh"],"mobile":["uvm","uvvm"],"pd":["uvp","uvvp"],"sd":["uvs","uvvs"],"video":["uvv","uvvv"]},"fvt":"fvt","mpegurl":["mxu","m4u"],"vivo":"viv","dvb.file":"dvb","uvvu.mp4":["uvu","uvvu"],"ms-playready.media.pyv":"pyv"},"webm":"webm","x-":{"f4v":"f4v","fli":"fli","flv":"flv","m4v":"m4v","matroska":["mkv","mk3d","mks"],"mng":"mng","ms-":{"asf":["asf","asx"],"vob":"vob","wm":"wm","wmv":"wmv","wmx":"wmx","wvx":"wvx"},"msvideo":"avi","smv":"smv","sgi-movie":"movie"}},"chemical/x-":{"cdx":"cdx","cif":"cif","cmdf":"cmdf","cml":"cml","csml":"csml","xyz":"xyz"},"message/rfc822":["eml","mime"],"x-conference/x-cooltalk":"ice"}')},215:e=>{"use strict";e.exports=JSON.parse('{"prefixHash":"99abb3d4056fa7f1eea545403cd324c8"}')},19705:e=>{"use strict";e.exports=JSON.parse('{"":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""}')},58299:(e,t,r)=>{"use strict";r.r(t),t.default=[["","Add additional hours","Chat list","Close panel","Open the chat context menu","This is a disappearing message","Full screen","Exit full screen","Mute","Pause","Play","Unmute","Message list. Press right arrow key on a message to open message context menu.","Message list. Press left arrow key on a message to open message context menu.","__author__:","You:","Delivered","Pending","Read","Sent","Voice message","Muted chat","Open emojis panel","Open gif panel","Open sticker panel","Cancel","Voice message","Send","Result: __name__","Search results.","Starred","Sticker with: __emojis__","Sticker with no label","Unselect category","View once info","Turn off view once","Turn on view once","Changing __count__ label","The label could not be updated","__count__ label changed","Adding new label: __labelName__","Archived chats will unarchive when you receive a new message.","Couldn't change archive setting.","Changing archive setting","Archived chats will remain archived when you receive a new message.","Couldn't block __participant__","__participant__ blocked","Blocking __participant__","Couldn't delete broadcast list.","Broadcast list deleted","Broadcast list deleted from this device","Deleting broadcast list","Group setting could not be changed","Couldn't archive chat.","Chat archived","Archiving chat","Couldn't clear chat.","Chat cleared","Chat cleared from this device","Clearing chat","Couldn't delete chat.","Chat deleted","Chat deleted from this device","Deleting chat","Couldn't dismiss change number notification.","Change number notification dismissed.","Dismissing change number notification.","Couldn't mark chat as read.","Couldn't mark chat as unread.","Marked as read","Marked as unread","Marking as read","Marking as unread","Couldn't mute chat.","Chat muted","Muting chat","Couldn't pin chat","You can only pin up to 3 chats.","Chat pinned","Pinning chat","Couldn't unarchive chat.","Chat unarchived","Unarchiving chat","Unmute","Couldn't unmute chat.","Chat unmuted","Unmuting chat","Couldn't unpin chat","Chat unpinned","Unpinning chat","Deleting label: __labelName__ failed","Deleted label: __labelName__","Deleting label: __labelName__","Couldn't create group.","Please enter a shorter subject.","You've created too many groups too quickly. Try again later.","Can't add more than __max__ participants","Created group","Creating group","Couldn't delete group.","Group deleted","Group deleted from this device","Deleting group","Changing group description","Group description change failed","Group description changed","Couldn't exit group.","Exited group","Exiting group","You're not a participant.","This group has ended.","You've added too many contacts to groups too quickly. Try again later.","Couldn't remove group icon.","Group icon removed","Removing group icon","Group icon set","Couldn't set group icon.","Setting group icon","Couldn't mute group.","Group muted","Muting group","Couldn't rename group.","Group renamed to __subject__","Renaming group","Group subject can't be empty","Couldn't unmute group.","Group unmuted","Unmuting group","Updating label color","Label color update failed","Label color updated","Updating label name","Label name update failed","Label name updated","Couldn't stop sharing live location","Stop sharing live location with __name__?","Stop sharing live location with __name__?","Stopped sharing live location","Stopping live location sharing","Marking as not spam","Couldn't mark as not spam","Marked as not spam","Couldn't delete message because the message may have expired","Couldn't delete message","__count__ message deleted","Deleting message","Couldn't star message because the message may have expired","Couldn't star message","__count__ message starred","Starring message","Couldn't unstar all messages","Couldn't unstar message because the message may have expired","Couldn't unstar message","__count__ message unstarred","All messages unstarred","Unstarring message","Unstarring all messages","Failed to add label: __labelName__","Label: __labelName__ added successfully","Couldn't add __participantNames__.","Couldn't add some participants.","You added __participantNames__.","Adding __participantNames__.","Removing __participantNames__ as an admin failed.","You can't dismiss __participant__ as admin because they created this group.","Couldn't remove some participants as an admin.","__participantNames__ is no longer a group admin.","Removing __participantNames__ as a group admin.","They are no longer in this group.","You can't add this participant because they left the group recently.","This group is full.","Please try again.","Couldn't make __participantNames__ an admin.","Couldn't make some participants admin.","__participantNames__ is now a group admin.","Making __participantNames__ a group admin.","Couldn't remove __participantNames__.","Couldn't remove some participants.","You can't remove __participant__ because they created this group.","You removed __participantNames__.","Removing __participantNames__.","Couldn't remove profile photo.","Profile photo removed","Removing profile photo","Profile photo set","Couldn't set profile photo.","Setting profile photo","Your name can't be empty","Your name changed","Couldn't change your name.","That emoji isn't allowed in your name","Changing your name","Reporting spam","Couldn't report spam","Reported spam","About can't be empty","About changed","Couldn't change About.","Changing About","Try again.","Couldn't unblock __participant__","__participant__ unblocked","Unblocking __participant__","Undo","Add a caption","The contact you have selected is blocked. Would you like to unblock them and add them to the group?","Blocked contacts will no longer be able to call you or send you messages","Add blocked contact","Add catalog","Add to a group","Add file","Add group description","Add group icon","Add participant","Add group participants","Label name already exists","NEW LABEL","New label","Add new label","Add profile photo","Add set of hours","Add to catalog","Drag the image to adjust","All chats are archived","Already added to group","Only admins can send messages","Only __admins__ can send messages","admins","Archive chat","Archived","Archived Chats","To reduce interruptions, archived chats will stay here with notifications turned off. You can change this option in Settings.","Welcome to your new Archive","Archive settings","No archived chats","Archived chats","Archived","Archived chats are muted","Camera","Attach Desktop Client Logs","Document","__count__ Page","Photos & Videos","Catalog","Contact","__number__ audio file you tried adding has no content.","Your browser doesnt support audio playback.","1.5","1","2","__number__ audio you tried adding is larger than the __maxSize__ limit.","Archived chats will remain archived when you receive a new message","Keep chats archived","Using __deviceName__ as your __deviceType__ for your WhatsApp calls","BETA","You're using WhatsApp Web Beta","This chat is with a business account. Click for more info.",'"__businessName__" registered as a business account, but WhatsApp hasnt verified their name yet.','This chat is with the official business account of "__businessName__". Click for more info.','WhatsApp has verified that this is the official business account of "__businessName__".','WhatsApp has verified that this is the official business account of "__businessName__". This account is saved with a different name in your address book.',"This business account has now registered as a standard account. Click for more info.","This account was previously a business account but has now registered as a standard account and may no longer belong to the business.",'This official business account changed its name to "__businessName__". Click for more info.','WhatsApp has verified that this official business account changed its name and now uses the name "__businessName__".',"__businessName__ used other companies to store and manage this message.","__businessName__ used Facebook and other companies to store and manage this message.","This message was delivered directly from __businessName__.","This message was delivered directly to __businessName__.","__businessName__ used Facebook to store and manage this message.","This chat is with a business account. Click for more info.",'"__businessName__" registered as a business account, but WhatsApp hasnt verified their name yet.','This chat is with the official business account of "__businessName__". Click for more info.','WhatsApp has verified that this is the official business account of "__businessName__".','WhatsApp has verified that this is the official business account of "__businessName__". This account is saved with a different name in your address book.','This chat is now with the official business account of "__businessName__". Click for more info.','WhatsApp has verified that this is the official business account of "__businessName__".','This chat is no longer with the official business account of "__businessName__". Click for more info.','WhatsApp is no longer able to verify that this is the official business account of "__businessName__".',"Block","Block __contact__? Blocked contacts will no longer be able to call you or send you messages.","Block Contact","List of contacts that you have blocked","No blocked contacts yet","Blocked contacts","Broadcast list deleted","Broadcast list info","Browser not supported","and","By appointment only","Closed","Closed now","__closed__, opens at __time__","Closed today","Always Open","By Appointment","Edit Business Hours","End Time","Selected Hours","Start Time","Open","Open 24 hours","__open__ 24 hours","__open__ by appointment only","Open by appointment only","Open now","__open__ until __time__","__open__ until __time__, __additionalOpenTime__ - __additionalCloseTime__","Business Info","This is your business name. It will be visible to your WhatsApp customers.","This verified business is not in your contact list.","__streetAddress__, __city__","__streetAddress__, __city__ __zipCode__","Business account","Something went wrong.",'You cannot select categories when you have selected "Not a Business"',"Choose up to three categories","Confirmed as __businessName__","Confirmed business","About and Phone Number","Add another website","Business Address","Business Hours","Categories","Business Description","Email Address","End Time","Edit map on mobile","This name will be visible to your WhatsApp customers and can only be editable from the app on your mobile device.","Your phone number can only be editable from the app on your mobile device.","Something went wrong","An error occurred while saving.  Please try again.","Business Information","Website","This name will be visible to your WhatsApp customers and can only be editable from the app on your mobile device.","No categories found","Official business account","Search categories","This is a business account.","Verified","__verified__ as __businessName__","Verified business","Use Here","WhatsApp needs a camera for video calls and taking photos. Allow access in your computer's settings.","Allow WhatsApp to access your camera?","Calls are not supported on WhatsApp Web. Open WhatsApp on your phone to call this business.","__count__ message couldn't be forwarded because __contact__ is on a version of WhatsApp that doesn't support it.","No messages could be forwarded because __contact__ is on a version of WhatsApp that doesn't support them.","__count__ message couldn't be forwarded because the file is missing.","__count__ message couldn't be forwarded because the file is missing or __contact__ is on a version of WhatsApp that doesn't support it.","No messages could be forwarded because the file is missing or __contact__ is on a version of WhatsApp that doesn't support them.","No messages could be forwarded because the file is missing.","Can't Load WhatsApp","The caption youre pasting is too long. Try shortening it or sending it as a separate message.","Caption Too Long","Your cart","Add items to your cart","Collect all the items you're interested in here and then send them to the business. Use your cart to ask about buying, customizing, delivery, or anything you want.","Ask for price","Qty __quantity__","One or more items in your cart have been updated","You can't add any more of this item","Add a message","The message youre pasting is too long. Try shortening it or sending it as a separate message.","Message Too Long","Received cart","Your sent cart","Send a cart","Something went wrong","Add Images","Add items to your catalog so customers can see what you're offering","Add new item","Failed to send review request.","Add Items","New collection","Failed to delete collection","When you delete this collection, items in the collection will not be deleted.","Delete","Delete Collection","Edit","Name required","New collection","Update Items","Collections","A collection with the same items already exists. Choose other items to proceed","Failed to save collection","Are you sure you want to delete this item from your catalog?","Delete Item","Failed to delete product","Catalog disabled","Your catalog is temporarily disabled because WhatsApp is a sales channel for your Facebook shop. To restore your catalog, go to Commerce Manager and set the shops visibility to hidden, or remove WhatsApp from the Business Manager account.","By using this feature, you're using a __fb_product_link__ and agree that the __fb_commerce_link__ and __wa_commerce_policy_link__ apply.","If you feel this is not correct, you can __request_review_link__.","Your appeal was submitted. If its approved, your item will be added to your catalog. If its not approved, youll be notified.","We reviewed this item again and found it didn't follow product or service guidelines. __learn_more_link__.","We will review the item and if it meets our guidelines, it will be added to your catalog.","When you hide an item, customers wont see it in your catalog.","Hide item","This item wasn't approved because it doesn't follow our product or service guidelines. __learn_more_link__.","request another review","Changes saved","Add to cart","Delete","Hide item","Share","Show item","This item is being reviewed. If its been approved, your customers will be able to see it on your profile. __learn_more_link__.","This item is being reviewed. You hid it, so customers wont see it in your catalog when its approved. __learn_more_link__.","Catalog link","Failed to save changes","Learn more about their products & services","View __catalogOwnerName__'s Catalog on WhatsApp","__productName__ from __catalogOwnerName__ on WhatsApp.","Anyone with WhatsApp can follow this link to browse catalog","Add new item","Edit item","View all","Change group icon","Message new number","__name__ changed their phone number. You're currently chatting with their new number.","__name__ changed their phone number to a new number.","__name__ changed their phone number to a new number. Click to message the new number.","Change profile photo","You allowed all participants to send messages to this group","You allowed only admins to send messages to this group","You turned off disappearing messages in this chat","You turned on disappearing messages in this chat","You allowed participants to send messages that have been forwarded many times to this group","You blocked participants from sending messages that have been forwarded many times to this group","You allowed all participants to change this group's info","You allowed only admins to change this group's info","Allowing all participants to send messages to this group","Allowing only admins to send messages to this group","Turning off disappearing messages in this chat","Turning on disappearing messages in this chat","Allowing participants to send messages that have been forwarded many times to this group","Blocking participants from sending messages that have been forwarded many times to this group","Allowing all participants to change this group's info","Allowing only admins to change this group's info","Charge your phone to keep using WhatsApp","Archived","You are not an admin","Search for messages within __chatName__.","Starred Messages","No Internet connection","Group invite message. Open WhatsApp on your phone to view.","Sharing live location. Open WhatsApp on your phone to view.","Payment message. Open WhatsApp on your phone to view.","Choose a phone number","Clear this chat?","Clear messages","Clear chat","Clear this chat?","Delete file from your phone","Clear this chat?","click here for group info","click here for contact info","Update WhatsApp","Click to reload QR code","Click to save, ESC to cancel","Click to update WhatsApp","Close chat","All Items","__count__ item","See all","Collections","Commerce Manager","Your computer is connected to a network that prevents WhatsApp from working correctly","Computer not connected","Add __participant__ to __subject__ group?","Add __participants__ to __subject__ group?","Confirm","You are closing WhatsApp.","Some messages cant be forwarded, do you want to forward rest of the messages?","Can't forward all messages","Forward to __chat__?","Log out?","Make __participant__ an admin for __subject__ group?","Remove __participant__ from __subject__ group?","Send __count__ contact to __chat__?","Send __count__ contact to __chat__?","Send __count__ contact to __chat__?","Unblock __chat__ and forward messages?","Blocked. Click to unblock","Unblock __contact__","Unmute this chat?","Enable sounds and notifications?","Unmute this group?","Connecting","Connecting to WhatsApp","Connecting","Contact","Contact Card","About and phone number","Contact is blocked","Hey there! I am using WhatsApp.","Loading About","View contact","__number__ contact that you tried to add has no content.","The contact that you tried to add is larger than the __maxSize__ limit.","Use WhatsApp on your phone to see the complete message history.","Older documents may be available","Older files may be available","Older links may be available","Older media may be available","Older messages may be available","Older products may be available","Use WhatsApp on your phone to search messages from before __date__.","Use WhatsApp on your phone to see the complete chat history.","Older chat history is available","Additional messages for this chat are being synced","Search for messages with __chatName__.","Copy link","Decrease speed of selected voice message","WhatsApp message","WhatsApp group message","Default","Delete all","Delete broadcast list?","Delete for me","Delete chat","Delete chat","Delete this chat?","Delete group","Delete this group?","Delete Item","Deleting a label removes it from all messages, contacts, and from the list of labels. Are you sure you want to delete this label?","Delete message","Delete message?","Tell us about your issue","Update","Please Update WhatsApp","New version available","Go To Settings","Please update WhatsApp from the Mac App Store","Desktop Settings","Update","To continue using WhatsApp, click Update and install the latest version.","Couldn't Update Automatically","Downloading an update to WhatsApp. This may take several minutes. WhatsApp will automatically update and restart when the download finishes.","Updating WhatsApp","Please update WhatsApp from the Windows App Store","Dismiss","Dismiss as admin","Docs","__count__ Doc","__name__ downloaded.","__number__ document you tried adding has no content.","__number__ document you tried adding is larger than the __maxSize__ limit.","Download all","This contact can't be displayed in WhatsApp Web. Download it to open it with another app on your computer?","Download contact?","Download failed","open","Downloading","Download completed","This file can't be opened in WhatsApp Web. Download it to open it with another app on your computer?","Download Unsupported File?","Drag file here","End-to-end encrypted","Edit","Choose who can change this groups subject, icon, description and disappearing messages setting.","Add text to your image","Edit label","Did you know? You can type : and a word to search emoji","smile","Activity","Animals & Nature","Flags","Food & Drink","Objects","Smileys & People","Symbols","Travel & Places","Turn on desktop notifications","& ","  ",", ","Only admins can change this setting.","Disappearing messages were turned off.","Disappearing messages were turned on. New messages will disappear from this chat after __number__ day.","Disappearing messages were turned on. New messages will disappear from this chat after __number__ hour.","Disappearing messages were turned on. New messages will disappear from this chat after __number__ minute.","Disappearing messages were turned on. New messages will disappear from this chat after __number__ second.","You turned off disappearing messages.","You turned on disappearing messages. New messages will disappear from this chat after __number__ day.","You turned on disappearing messages. New messages will disappear from this chat after __number__ hour.","You turned on disappearing messages. New messages will disappear from this chat after __number__ minute.","You turned on disappearing messages. New messages will disappear from this chat after __number__ second.","__name__ turned off disappearing messages.","__name__ turned on disappearing messages. New messages will disappear from this chat after __number__ day.","__name__ turned on disappearing messages. New messages will disappear from this chat after __number__ hour.","__name__ turned on disappearing messages. New messages will disappear from this chat after __number__ minute.","__name__ turned on disappearing messages. New messages will disappear from this chat after __number__ second.","","Disappearing messages were turned off. Click to change.","Disappearing messages were turned on. New messages will disappear from this chat after __number__ day. Click to change.","Disappearing messages were turned on. New messages will disappear from this chat after __number__ hour. Click to change.","Disappearing messages were turned on. New messages will disappear from this chat after __number__ minute. Click to change.","Disappearing messages were turned on. New messages will disappear from this chat after __number__ second. Click to change.","You turned off disappearing messages. Click to change.","You turned on disappearing messages. New messages will disappear from this chat after __number__ day. Click to change.","You turned on disappearing messages. New messages will disappear from this chat after __number__ hour. Click to change.","You turned on disappearing messages. New messages will disappear from this chat after __number__ minute. Click to change.","You turned on disappearing messages. New messages will disappear from this chat after __number__ second. Click to change.","__name__ turned off disappearing messages. Click to change.","__name__ turned on disappearing messages. New messages will disappear from this chat after __number__ day. Click to change.","__name__ turned on disappearing messages. New messages will disappear from this chat after __number__ hour. Click to change.","__name__ turned on disappearing messages. New messages will disappear from this chat after __number__ minute. Click to change.","__name__ turned on disappearing messages. New messages will disappear from this chat after __number__ second. Click to change.","Turning on this setting will make new messages disappear from this chat after 7 days. Recipients can still save these messages elsewhere.","Turning on this setting will make new messages disappear from this chat after a selected amount of time. Recipients can still save these messages elsewhere.","New messages will disappear from this chat after __number__ day.","New messages will disappear from this chat after __number__ hour.","New messages will disappear from this chat after __number__ minute.","New messages will disappear from this chat after __number__ second.","Anyone in this chat can change this setting.","Group admins control who can change this setting.","This message was sent while disappearing messages were turned off.","This message will disappear from this chat after __number__ day.","This message will disappear from this chat after __number__ hour.","This message will disappear from this chat after __number__ minute.","This message will disappear from this chat after __number__ second.","Messages will disappear after 7 days if theyre sent to a chat that has disappearing messages turned on.","Messages will disappear after a selected amount of time if theyre sent to a chat that has disappearing messages turned on.","While this setting is on, new messages will disappear from this chat after 7 days.","While this setting is on, new messages will disappear from this chat after a selected amount of time.","Media and messages wont disappear from outside the chat or from any devices theyre saved on.","There are still ways for recipients to save messages, like forwarding them or taking a screenshot.","Get Started With Disappearing Messages","Disappearing Messages Were Turned On","You can't change this setting because you're not connected to the Internet. Check your Internet and try again.","Off","On","__number__ day","__number__ hour","__number__ minute","__number__ second","You can't turn off disappearing messages for this chat unless you unblock this contact.","You can't turn on disappearing messages for this chat unless you unblock this contact.","Catalog already created.","Two or more images are the same. Delete any duplicates and try again.","Item code must be unique.","Incorrect email address format","Add at least one image","Add a title","Enter a valid price","Wait until the message finishes sending and displays a checkmark before forwarding.","Wait until this message is fully delivered before forwarding.","Unable to forward unsent message.","Cant Forward","URL is incorrect","Exit group","Exit this group?","Facebook shop","Facebook Commercial Terms","Facebook Product","__number__ file you tried adding has no content.","__count__ file failed to be downloaded because it's no longer on your phone.","__number__ file could not be added.","__number__ file you tried adding is not supported.","__number__ file you tried adding is larger than the __maxSize__ limit.","B","GB","kB","MB","Forward","Forward all","You can only share with up to __count__ chat","Forwarded many times. You can only share with up to __count__ chat.","Messages forwarded many times can only be shared with up to __count__ chat at a time.","Forward message","Forward message to","Forwarded","Forwarded __count__ time","Can't send messages that have been forwarded many times","Forwarded many times","One or more messages will be marked as forwarded many times.","This message will be marked as forwarded many times.","Found a contact card for this number. View contact card?","Older results may be available","Gallery","Get directions","Microsoft Edge","Google Chrome","Mozilla Firefox","Get notified of new messages","Opera","Safari (macOS 10.10+ Only)","Custom GIF animations are currently not supported. Please use provided GIF selection feature.","Favorites","Haha","Love","Reactions","Sad","Sports","Trending","TV","Alerts and sounds off","Alerts and sounds off for 1 day","Alerts and sounds off for 1 hour","Alerts and sounds off for 1 week","Alerts and sounds off for 8 hours","Alerts and sounds off. Click to restore.","Notifications enabled","Go to message","Messages are now end-to-end encrypted. No one outside of this chat, not even WhatsApp, can read or listen to them. Click to learn more.","Failed to load Google Maps","GOT IT","Group","You were added by someone who's not in your contacts","Group deleted","Description","You can't join this group because you were removed.","You can't join this group because it has ended.","You can't join this group because this invite link was reset.","You can't join this group because it is full.","Couldn't join this group. Please try again.","Cancel","Checking invite link","__count__ contact","Reset link","Join group","Invite to group via link","Anyone with WhatsApp can follow this link to join this group. Only share it with people you trust.","__count__ participant","You can't view this group's invite link because you're not an admin.","You can't view this group's invite link because you're no longer a participant.","You can't view this group's invite link because this group has ended.","This invite link doesn't match any WhatsApp groups.","Are you sure you want to reset the invite link for __groupName__? If you reset the link, no one will be able to use it to join this group.","Resetting the invite link for __groupName__.","The previous invite link is now reset and a new invite link has been created.","Send link to","Log in to WhatsApp Web to join this WhatsApp group","View group","Group muted","Type contact name","All participants","Edit group info","Disappearing Messages","Allow","Frequently forwarded messages","Messages forwarded many times","Don't allow","Only admins","Send messages","Group Settings","Follow this link to join my WhatsApp group:","__count__ more","Group Subject","Invitation to join my WhatsApp group","Invite Expired","__number__ invited","Couldn't add __participant__. You can invite them privately to join this group.","WhatsApp group invite","Invited","View invite","Group video call","Group voice call","Send invite to...","Reset invite for __participant__? If you reset the invite, __participant__ won't be able to use it to join this group.","To take photos, click Allow above to give WhatsApp access to your computer's camera.","To take photos, click Yes below to give WhatsApp access to your computer's camera.","To take photos, WhatsApp needs access to your computer's camera. Click __chrome_media_error__ in the URL bar and choose Always allow web.whatsapp.com to access your camera.","To take photos, WhatsApp needs access to your computers camera. Refresh the page, try sending a camera image, and select Yes from the menu that appears.","To take photos, WhatsApp needs access to your computers camera. Click __firefox_lock__ in the URL bar and set Use the Camera to Allow.","To take photos, WhatsApp needs access to your computers camera. Click __opera_media__ in the URL bar and click Clear This Setting and Reload.","To take photos, WhatsApp needs access to your computers camera. Open your browsers Preferences  Websites and change camera setting for web.whatsapp.com to Allow.","You cant take a photo because it looks like your computer doesnt have a camera. Try connecting one or if you have one connected, try restarting your browser.","Camera Not Found","Allow camera","To record Voice Messages, click Allow above to give WhatsApp access to your computer's microphone.","To record Voice Messages, click Yes below to give WhatsApp access to your computer's microphone.","To record Voice Messages, WhatsApp needs access to your microphone. Click __chrome_media_error__ in the URL bar and choose Always allow web.whatsapp.com to access your microphone.","To record Voice Messages, WhatsApp needs access to your computers microphone. Refresh the page, try sending a Voice Message, and select Yes from the menu that appears.","To record Voice Messages, WhatsApp needs access to your computers microphone. Click __firefox_lock__ in the URL bar and set Use the Microphone to Allow.","To record Voice Messages, WhatsApp needs access to your computers microphone. Click __opera_media__ in the URL bar and click Clear This Setting and Reload.","To record Voice Messages, WhatsApp needs access to your computers microphone. Open your browsers Preferences  Websites and change microphone setting for web.whatsapp.com to Allow.","You cant record a Voice Message because it looks like your computer doesnt have a microphone. Try connecting one or if you have one connected, try restarting your browser.","Microphone Not Found","Cant record voice messages during a WhatsApp call.","Allow microphone","To get notifications for new messages, click Allow above.","To get notifications for new messages, click Yes below.","To get notifications for new messages, select Allow notifications from the prompt below the URL bar.","Allow notifications","Help","New Message","Message from __author__","__unreadCount__ New Message","You'll be logged out after several minutes of inactivity","Failed to load image","__number__ image you tried adding has no content.","Image may be subject to copyright.","Image search failed","Enter search term here","No images found","Search for images","Image Search","Terms of Service","__number__ image you tried adding is larger than the __maxSize__ limit.","Check your phone to answer","WhatsApp video call from __name__","WhatsApp voice call from __name__","Increase speed of selected voice message","Send and receive messages without connecting your phone.","Use WhatsApp on up to 4 devices at the same time.","WhatsApp Web","WhatsApp connects to your phone to sync messages. To reduce data usage, connect your phone to Wi-Fi.","Make calls and send messages without connecting your phone.","WhatsApp for Desktop","Get it here","WhatsApp is available for Mac. __get_it_here__.","WhatsApp is available for Windows. __get_it_here__.","Keep your phone connected","Expires at __time__","Expires in __number__ day","Invite expired","Keep starred messages","Keyboard Shortcuts","Catalog","Catalog (temporarily disabled)","Choose color","__count__ item","Label items","Item Code (Optional)","Description (Optional)","Link (Optional)","Name","Price __currencySymbol__ (Optional)","Enter reason for this request...","Search in __labelName__...","Labels","There was an unexpected error, please click to reload the application.","Learn more","Licenses","Couldn't copy to clipboard. Copy using mouse or keyboard.","Link copied to clipboard.","Links","__count__ Link","Accurate to __accuracy__ M","__count__ people","Live location ended","Expired Location","Last updated __date__ at __time__","Last updated today at __time__","Last updated __date__ at __time__","Last updated yesterday at __time__","Live until __time__","Map view","Satellite view","Terrain view","Hide traffic","Show traffic","Click to continue viewing live location","__hours__h left","__hours__h __minutes__m left","__minutes__m left","__sharers__ is sharing live location","__name__ is sharing live location","__count__ person is sharing live location","You are sharing live location","You and __name__ are sharing live location","You and __count__ other person are sharing live location","You are sharing live location","Stop Sharing","__name__ stopped sharing","Live Location","Updated __hours__h ago","Updated __hours__h __minutes__m ago","Updated just now","Updated __minutes__m ago","View Live Location","load earlier messages","load recent messages","Loading","loading messages","Log in","Menu __android_menu_icon__","Click to reload QR code","Need help to get started?","Settings __iphone_settings_icon__","Open WhatsApp on your phone","Tap __android_menu__ or __iphone_settings__ and select __whatsapp_web_menu_item__","Point your phone to this screen to capture the code","To use WhatsApp on your computer:","WhatsApp Web","WhatsApp Web","This business account is not in your contact list.","Make sure your computer has an active Internet connection.","Make sure your phone has an active Internet connection.","Edit group admins","Mark as read","Mark as unread","You've reached the maximum number of images to add.","Downloading messages: __progress__%","Don't close this window. Your messages are downloading.","Media","Add a caption","Background","Done","Bryndan Write","Norican","Oswald","Sans Serif","Serif","No preview available","Reset","Crop & Rotate","Delete","Emoji","Paint","Redo","Rotate left","Rotate right","Sticker","Text","Undo","Type something","The item you tried adding failed to load.","This file was changed from original.","Media, Links and Docs","Media, Links, Docs and Products","Archived","Blocked","Desktop Settings","Help","Keep me signed in","Log out","Make group admin","Notifications","Profile","Profile","Remove","Security","Settings","Starred","Theme","Chat Wallpaper","Attach","Menu","Message","Message admin","This audio is too large. You can send audio up to __maxSize__.","Message __author__","This document is too large. You can send documents up to __maxSize__.","This file is too large. You can send files up to __maxSize__.","This image is too large. You can send images up to __maxSize__.","Message info","Delivered","Delivered to","Played","Played by","Read","Read by","__count__ remaining","Seen","Opened","Opened by","Couldn't find message","The message youre pasting is too long. Try shortening it or sending it in multiple parts.","Message Too Long","This video is too large. You can send videos up to __maxSize__.","Room","Continue in Messenger","Create a room in Messenger and send a link to group video chat with anyone, even if they don't have WhatsApp or Messenger.","Rooms are protected by Messenger's encryption and privacy controls, but they aren't end-to-end encrypted.","Introducing Messenger Rooms","Continue in Messenger to create a room.","Create a room","WhatsApp needs a microphone for calls and voice messages. Allow access in your computer's settings.","Allow WhatsApp to access your microphone?","Cant play this Voice Message because it's no longer on your phone.","Voice Message Unavailable","Cant view this contact because it's no longer on your phone.","Contact Unavailable","Cant download this document because it's no longer on your phone.","Document Unavailable","Cant view this GIF because it's no longer on your phone.","GIF Unavailable","Media Message Unavailable","Cant view this photo because it's no longer on your phone.","Photo Unavailable","Cant download this sticker because it's no longer on your phone.","Sticker Unavailable","Cant play this video because it's no longer on your phone.","Video Unavailable","Couldn't display message info. Try again later.","Phone number shared via url is invalid.","Send message to","Log in to WhatsApp Web to share","__contactName__ and __count__ other contact","No contacts","__count__ contact","You can only send up to __count__ contact","View all","1 Day","1 Hour","1 Week","1 Year","8 Hours","Always","Mute __name__ for","__A__, __B__","__A__, and __B__","__A__, __B__","__A__ and __B__","Archive Chat","Close Window","WhatsApp needed to restart because of a problem.","Problem Detected","Delete Chat","Delete Group","Exit Group","Log Out","Mark as Read","Mark as Unread","Call","Always On Top","Chat","File","Help","Help Center","Terms and Privacy Policy","Copy","Copy Image","Copy Link","Cut","Edit","About WhatsApp","Hide","Hide Others","Preferences","Quit WhatsApp","Services","Show All","Paste","Redo","Search","Select All","Undo","View","Enter Full Screen","Exit Full Screen","Zoom In","Actual Size","Zoom Out","Next Chat","Previous Chat","Search Chat","Add to dictionary","Copy","Copy Image","Copy Link","Cut","Paste","Redo","Select All","Undo","Window","Bring All to Front","Minimize","Zoom","Do Not Move","Move to Applications","You can move WhatsApp to Applications so it's easier to find.","Move WhatsApp to Applications?","Mute","New Chat","New Group","Pin Chat","Profile and About","Unarchive Chat","Cancel Mute","Unpin Chat","Cancel","End Call","Are you sure you want to end the current call?","This video is unavailable. Please try again.","New chat","New group","Next","You need to create a catalog on the phone first","No chats","No contacts","No Docs","No groups","No Links","No Media","No Media, Links and Docs","No Media, Links, Docs and Products","No products","No result found for '__labelName__'","No results","No starred messages","No thanks","No update found","Not spam","Notifications","__number__ of __totalNumber__","+__number__",'This chat is with the official business account of "WhatsApp". Click for more info.','This is the official business account of "WhatsApp".','This is the official business account of "WhatsApp". This account is saved with a different name in your address book.',"This official business account is not in your contact list.","OK, got it","Only admins can edit this group's info","Opening link in new window...","You will now be directed to","Start WhatsApp at Login","Desktop Alerts","Show Previews","Display message text in desktop alerts","Outgoing Message Tone","Toggles the audio tone that plays when you send a message","Sounds","Ask for total","The seller has deleted your sent cart. Contact the seller for more information.","Order Detail","Your Order","__subtotal__ (estimated)","Qty __quantity__","__total__ (estimated total)","No Items","View cart","View sent cart","Organizing messages","This message can't be viewed in WhatsApp Desktop. View it on your phone instead.","This message can't be viewed in WhatsApp Web. View it on your phone instead.","Recent","Already blocked","Payment","Not Now","Phone battery low","WhatsApp is open on another computer or browser. Click Use Here to use WhatsApp in this window.","Phone not connected",'The version of WhatsApp on your phone is too old. Please update to the latest version, then click "LOG IN" to continue using WhatsApp.',"The video can't be played.","Open the link","This video is playing in picture in picture.","Currently playing video was revoked.","Pin chat","Waiting for this message. This may take a while.","Previous","Reply privately","Add to cart","Item added to cart","Catalog","More","Send catalog","Follow this link to view our catalog on WhatsApp:","Something went wrong","Catalog","View catalog","This item is out of stock.","Details","You hid this item. Your customers can't see it in your catalog","Product link","View items","Message Business","Can not send product before media is ready","View","Out of Stock","Remove from cart","This product or service has been removed","This is abusive, harmful or illegal","This appears to be a knockoff or counterfeit item","The pictures or descriptions don't match the item","Other","Tell us more","This is fraud or a scam","This is spam","Submit","Couldn't report product","Thanks for your feedback","Reporting product","Please select a reason.","Follow this link to view our item on WhatsApp:","Waiting for network","Products","__count__ Product","This photo is too small. Please select a photo with height and width of at least __size__ pixel.","Couldn't send this Voice Message.","","Your Name","This is not your username or pin. This name will be visible to your WhatsApp contacts.","Group  __groupName__","Read more","Reconnect","Remove","Remove this group's icon?",'Remove label "__labelName__" from __count__ item',"Remove photo","Remove your profile photo?","Reply","Report","Report and block","Report business","Block business and clear chat","Report this business to WhatsApp?","Report contact","Block contact and clear chat","Report this contact to WhatsApp?","Report group","Exit group and clear chat","Report this group to WhatsApp?","Report product","Report Product","We will review the product and if it does not meet our guidelines, it will be removed.","Your report has now been submitted.","Report this product?","Tell Us More","Report spam","Most recent messages in this group will be forwarded to WhatsApp.","Most recent messages from this user will be forwarded to WhatsApp.","Most recent messages from this business will be forwarded to WhatsApp.","Request review","Click to resend","Retake","Retry","Retry Now","Upload","Retrying","Retrying in __duration__","Retrying in __number__ second","Delete for everyone","Revoke invite","This message was deleted","Messages you selected will be deleted for everyone on the latest version of WhatsApp in this chat.","You deleted this message","Save","Search","Search contacts","Search Emoji","Search GIFs via __service__","Search groups","Search Messages","No chats, contacts or messages found","No contacts found","No groups found","No messages found","No results found for '__keyword__'","Search or start new chat","Search Participants","Search results not yet available. Try again later.","Search via WhatsApp sticker store","Search Web","Couldn't search the web. Check your computer's internet connection and try again.","Would you like to search this on the web? This will upload the message to Google.","Looking for chats, contacts or messages","Searching for images...","Looking for messages","Security code notifications are no longer available for this chat.","Learn which chats are end to end encrypted","Turn on this setting to receive notifications when one of your contact's security code changes.","Turn on this setting to be notified when your security code changes for a contact in an end-to-end encrypted chat. This setting must be enabled on each device you want notifications to show.","Show security notifications","Show security notifications on this computer","WhatsApp secures your conversations with end-to-end encryption. This means your messages, calls and status updates stay between you and the people you choose. Not even WhatsApp can read or listen to them.","Messages and calls in end-to-end encrypted chats stay between you and the people or businesses you choose, so not even WhatsApp can read or listen to them.","Security","See __count__ archived chat","See Location","See more","__count__ selected","Send contact","Send contacts","Couldn't send this message.","Send link via WhatsApp","send","Feedback/Question about WhatsApp","Email address","Confirm email address","Please enter a valid email address","The email addresses do not match","Subject","Please upload images 10 MB or smaller","Question about WhatsApp Business for Mac","Question about WhatsApp for Mac","Release to add...","Add Screenshots","Feedback sent","Please enter a subject.","Contact us","__count__ Screenshot Maximum","Please add more to your description","Question about WhatsApp Business for Web","Question about WhatsApp for Web","Question about WhatsApp Business for Windows","Question about WhatsApp for Windows","To verify, send a message to __name__ and try again.","Send product","Send products","The sender is not in your contact list","Settings","Shop","Search in Broadcast lists","Broadcast lists","Unread chats","Search in Groups","Labels","Search in Unread chats","Some of your messages are still sending.","Star message","No starred messages","Starred messages","Starting chat","Status","Camera","HIDE","SHOW","Status update not found","MUTED","My Status","No updates","Click on a contact to view their status updates","RECENT","Sending reply","You received a status, but your version of WhatsApp doesn't support it.","Update your status","Upload","View your updates","VIEWED","You don't have any stickers yet. Download sticker packs on your phone to get started.","Angry","Celebrate","Greetings","Happy","Love","Sad","You haven't sent any stickers yet","You haven't favorited any stickers yet","Subject","This chat has been closed","Include device information? (optional)","Technical details like your model and settings can help us answer your question.","Tell us how we can help","Your question has been sent to WhatsApp Support. We'll respond in a WhatsApp chat shortly.","Contact us","The support request form is not yet available for desktop. Use your phone to submit it.","WhatsApp secures messages and calls while theyre being delivered to and from this account.","Learn more about chats with WhatsApp Support.","Click to learn how messages and calls are secured.","Security","This chat is with the official account of WhatsApp Support. Click to learn more.","WhatsApp Support","Suspicious link","__count__ suspicious link","Open link","This link contains unusual characters. It may be trying to appear as another site.","Take photo","You'll be able to use WhatsApp again in __duration__","You're temporarily banned from WhatsApp because you sent too many messages to people who dont have __phone__ in their address books.","You're temporarily banned from WhatsApp because too many people blocked you.","You're temporarily banned from WhatsApp because you created too many groups with people who dont have __phone__ in their address books.","You're temporarily banned from WhatsApp because you sent the same message to too many people.","You're temporarily banned from WhatsApp because you sent too many messages to a broadcast list.","You're temporarily banned from WhatsApp because you may have violated our terms of service.","Terms and Privacy Policy","Dark","Light","Choose theme","System default","Maximum number of files uploaded. __number__ file has been ignored.","Trying to reach phone","Turn off all desktop notifications","Turn off all desktop notifications for:","Type a message","Type a reply","Unarchive chat","Unblock","Unblock __contact__?","Unblock Contact","unknown subject","Unpin chat","__count__ unread message","Unread messages","Could not forward this message because the file is no longer on your phone.","Unstar all","Unstar","Unstar all messages?","Unstar message","You received a message on your phone, but your version of WhatsApp Desktop doesn't support it.","This message can't be shown on WhatsApp Desktop. Open WhatsApp on your phone to view.","You received a message, but your version of WhatsApp doesn't support it.","You sent a message from your phone, but your version of WhatsApp Web doesn't support it.","You received a message on your phone, but your version of WhatsApp Web doesn't support it.","Click here to update.","This message can't be shown on WhatsApp Web. Open WhatsApp on your phone to view.","Until __date__ at __time__","Until today at __time__","Until tomorrow at __time__","Until __day__ at __time__","Untitled","Update available","Download Microsoft Edge","Update Google Chrome","Update Mozilla Firefox","Update Safari","Updating WhatsApp","WhatsApp is out of date. Updating now","Updating","Upload photo","__participants__ joined using your invite","You invited __participants__","AIM","Birthday","Description","Business Name","Mobile","Email","Home","Home Fax","ICQ","iPhone","Jabber","Main","Windows Live","Nickname","Pager","Skype","Work","Work Fax","Yahoo","Version __version__","Video call","Switch","__number__ video you tried adding has no content.","Your browser doesnt support video playback.","__number__ video you tried adding is larger than the __maxSize__ limit.","View business","View Contact Card","Expired","When you turn on this setting, recipients can only open your photo or video one time before it disappears. Keep in mind, they can still take screenshots before it's gone.","Send photos and videos more privately","Photo","This photo will disappear after it is opened.","This photo will disappear after you close it.","This video will disappear after it is opened.","This video will disappear after you close it.","Video","Opened","View or edit catalog","View photo","View Shop","Voice call","End call","Mute microphone","Turn off camera","Turn on camera","Unmute microphone","You can turn on your camera after __callee__ answers","Request to switch to video call","Calling","Camera not found","camera off","Call ended","Call failed","Call answered on your connected phone","In call","Your call will end in a few seconds because your microphone and sound output device were disconnected.","Your call will end in a few seconds because your microphone was disconnected.","Microphone not found","Call not answered","__name__'s camera and mic are off","The other person's camera and mic are off","__name__'s camera is off","The other person's camera is off","__name__'s mic is muted","The other person's mic is muted","Reconnecting","Call declined","Your connected phone is already on a WhatsApp call","__name__ is requesting to switch to a video call","Requesting to switch to a video call...","Requesting to switch to a video call...","requesting video call...","Ringing","Your call will end in a few seconds because your sound output device was disconnected.","Your microphone is muted","Camera","Use System Setting","Microphone","Audio Device","Default Communications Device","You can turn off your camera after __callee__ answers","WhatsApp didn't connect to a video or audio device. Try starting the call again. If the problem continues, you may have to restart WhatsApp or your computer.","Call could not be started","Please contact us with the make and model of your camera. ","WhatsApp doesn't work with your camera yet","You are already on a WhatsApp call","Call cannot be placed for more than __count__ participant","Couldn't place call: all recipients are using old versions of WhatsApp or incompatible devices.","You can only call up to __count__ contact","__callee__ couldn't be added to the call, because they are using an old version of WhatsApp or an incompatible device.","__count__ others","WhatsApp needs a camera for video calls. Connect one to your computer.","WhatsApp could not find a connected camera","WhatsApp needs a microphone for calls. Connect one to your computer.","WhatsApp could not find a connected microphone","Make sure your computer has an active Internet connection and try again.","Computer not connected to the Internet","Make sure your phone has an active Internet connection and try again.","Phone not connected to the Internet","WhatsApp needs an audio output device for calls. Connect one to your computer.","WhatsApp could not find a connected audio device","Call could not connect","__callee__ is in a country where WhatsApp Calling is unavailable","Couldn't place call: __callee__ is unable to receive WhatsApp calls.","WhatsApp Calling is unavailable in your country.","Couldn't place call: __callee__ is unable to receive WhatsApp calls at this time.","Couldn't place call: __callee__ is unable to receive WhatsApp calls.","Couldn't place call: __callee__ is not registered on WhatsApp","Unblock this contact to call them.","Couldn't place call: __callee__ is unable to receive WhatsApp video calls at this time.","Your audio device is unavailable","Your audio device or microphone is unavailable","Your camera is unavailable or used by another app","Allow WhatsApp to access your camera in computer's settings","Your microphone is unavailable. Switch to another microphone or end the call and try again.","Allow WhatsApp to access your microphone in computer's settings","Accept","Decline","Ignore","WhatsApp voice call","WhatsApp group voice call","WhatsApp group video call","WhatsApp video call","WhatsApp will use your computer's camera for video calls and taking photos. You can always change this later in your computer's settings.","WhatsApp will use your computer's microphone for calls and voice messages. You can always change this later in your computer's settings.","Call could not connect","__contactName__ - WhatsApp voice call","__contactName__ - WhatsApp video call","Add WhatsApp Doodles","Chat wallpaper set","Chat wallpaper doodles added","Chat wallpaper doodles removed","Set Chat Wallpaper","Wallpaper Preview","Your security code with __contactName__ changed because there was a login on a new device of theirs.","Your security code with __contactName__ changed because you logged into a new device.",'Your security code with all recipients changed because there was a login on a new device of yours. To verify a contact\'s security code, open their Contact Info page and click "Encryption".',"Your security code with __contactName__ changed because there was a login on a new device of yours.",'Your security code with all participants changed because there was a login on a new device of yours. To verify a contact\'s security code, open their Contact Info page and click "Encryption"',"Your security code with __contactName__ changed because there was a login on this device.",'Your security code with all recipients changed because there was a login on this device. To verify a contact\'s security code, open their Contact Info page and click "Encryption".',"Messages are end-to-end encrypted. Click to learn more.","Messages you send to this broadcast list are secured with end-to-end encryption. Click to learn more.","Messages you send to this broadcast list are secured with end-to-end encryption, which means WhatsApp and third parties can't read them.","Your security code with all recipients changed. Click to learn more.",'WhatsApp has verified that this is the official business account of "__businessName__".',"WhatsApp has verified that this is the official business account of __businessName__. This account is saved with a different name in your contacts.","This may be a business. WhatsApp hasn't verified their name yet.","Download","Add label","Delete label","Remove label","Cancel","You can't send messages to this group because you're no longer a participant.","Can't send a message to blocked contact __contact__.","Your security code with __contactName__ changed because there was a login or logout from one or more of their devices.",'Your security code with all recipients changed because there was a login or logout from one or more of your devices. To verify a contact\'s security code, open their Contact Info page and click "Encryption".',"Your security code with __contactName__ changed because there was a login or logout from one or more of your devices.",'Your security code with all participants changed because there was a login or logout from one or more of your devices. To verify a contact\'s security code, open their Contact Info page and click "Encryption".',"WhatsApp secures your conversations with end-to-end encryption. This means your messages and status updates stay between you and the people you choose. Not even WhatsApp can read or listen to them.","WhatsApp secures your conversations with end-to-end encryption. This means your messages, calls and status updates stay between you and the people you choose. Not even WhatsApp can read or listen to them.","Muted","Chats","Close","Contact info","Messages are end-to-end encrypted. No one outside of this chat, not even WhatsApp, can read or listen to them. Click to learn more.","Messages to this chat are secured with end-to-end encryption. __businessName__ may use another company to store, read and respond to your messages. Click to learn more.","Messages are end-to-end encrypted. Click to verify.","Messages and calls are end-to-end encrypted. Click to verify.","Contacts","Continue","online","typing","recording audio","last seen __date__ at __time__","last seen today at __time__","last seen __date__ at __time__","last seen yesterday at __time__","__participant__ is typing","__participant__ is recording audio","Audio","Contact","__count__ page","Document","Photo","Live location","Location","Product","Sticker","Video","Voice message","Delete","Delete group","Delete broadcast list","Download __name__","Encryption","Exit","Exit group","Frequently Contacted","Go",'Your security code with all participants changed because there was a login on this device. To verify a contact\'s security code, open their Contact Info page and click "Encryption".',"Group admin","Only admins can message this group.","__name__ changed this group's settings to allow all participants to send messages to this group.","You changed this group's settings to allow all participants to send messages to this group.","__name__ changed this group's settings to allow only admins to send messages to this group.","You allowed only admins to send messages to this group","An admin created this group","__name__ created group __subject__","__name__ created this group","An admin created group __subject__","You created group __subject__","You created this group","Created __date__ at __time__","Created __date__ at __time__","Created today at __time__","Created today at __time__","Created __day__ at __time__","Created __day__ at __time__","Created yesterday at __time__","Created yesterday at __time__","__name__ changed the group description. Click to view.","__name__ changed the group description.","A participant changed the group description. Click to view.","A participant changed the group description.","You changed the group description. Click to view.","Group Description","This group has ended","Group info","Messages are end-to-end encrypted. Click to learn more.","Messages and calls are end-to-end encrypted. Click to learn more.","Messages are end-to-end encrypted. No one outside of this chat, not even WhatsApp, can read or listen to them. Click to learn more.","Messages you send to this group are secured with end-to-end encryption, which means WhatsApp and third parties can't read them.","Messages and calls to this group are secured with end-to-end encryption, which means WhatsApp and third parties can't read or listen to them.","Messages and calls are end-to-end encrypted. No one outside of this chat, not even WhatsApp, can read or listen to them. Click to learn more.","__name__ reset this group's invite link. Click to view the new invite link.","You reset this group's invite link. Click to view the new invite link.","__name__ changed this group's settings to allow messages that have been forwarded many times.","You changed this group's settings to allow messages that have been forwarded many times.","__name__ changed this group's settings to not allow messages that have been forwarded many times.","You changed this group's settings to not allow messages that have been forwarded many times.","__name__ was added","You were added","__name__ changed their phone number to a new number.","__name__ changed to __new_number__","__participants__ is no longer an admin","You're no longer an admin","__name__ joined via an invite link","You joined via an invite link","__name__ left","You left","__participants__ is now an admin","You're now an admin","__name__ was removed","You were removed","__name__ added __participants__","__name__ added you","__name__ removed __participants__","__name__ removed you","A participant added __participants__","A participant added you","A participant removed __participants__","A participant removed you","You added __participants__","You removed __participants__","__name__ changed this group's settings to allow all participants to edit this group's info.","You changed this group's settings to allow all participants to edit this group's info.","__name__ changed this group's settings to allow only admins to edit this group's info.","You changed this group's settings to allow only admins to edit this group's info.","Your security code with all participants changed. Click to learn more.","__name__ changed the subject to __subject__","A participant changed the subject to __subject__","You changed the subject to __subject__","Invite to group","__num__ invite sent","Invite reset","Groups","Groups in common","Messages to this chat and calls are secured with end-to-end encryption, which means that WhatsApp and third parties cant read or listen to them. __businessName__ may use a service to store, read and respond to your messages and calls. Contact __businessName__ for information on their privacy practices.","Learn more","Broadcast list info","__name__ added to the list","__name__ removed from the list","Logging Out","Do not close this window","One or more group participants are using old versions of WhatsApp that can't receive messages sent from this device. Use your phone to message them instead.","This message couldnt be delivered","__name__ is using an old version of WhatsApp that can't receive messages sent from this device. Use your phone to message them instead.","Clearing or deleting entire chats will remove messages from this device only. They will not be removed from other devices.","Changes to clearing or deleting a chat","Messages will be removed from this device only.","Messages will be removed from this device only.","Your computer does not have enough space for WhatsApp to run. Please create more storage by deleting unused files from your computer, then log in again.","The most recent messages in this group will be forwarded to WhatsApp. If you exit the group and clear the chat, it will be deleted from this device only.","The most recent messages from this contact will be forwarded to WhatsApp. If you block this contact and clear the chat, it will be deleted from this device only.","The most recent messages from this business will be forwarded to WhatsApp. If you block this business and clear the chat, it will be deleted from this device only.","Pinning chats is not yet available on the WhatsApp Web Beta","Can't pin chat","To verify that messages and calls with __contactName__ are end-to-end encrypted, open this screen on your phone, and follow the instructions.","New group","Mute notifications","Unmute notifications","New chat","About","Status","Could not deliver message","Messages","Missed group video call","Missed group video call at __time__","Missed group voice call","Missed group voice call at __time__","Missed video call","Missed video call at __time__","Missed voice call","Missed voice call at __time__","No","The business account for __businessName__ has registered as a standard user account and may no longer belong to the business.","The business account you were chatting with is now a standard account. Click for more info.","Messages to this chat are now secured with end-to-end encryption, which means third parties can't read or listen to them.","Messages to this chat are now secured with end-to-end encryption. Click to learn more.","OK","Other contacts","__count__ participant","To receive a payment from __senderName__, set up your payment account on your phone.","__contactName__ canceled their payment request for __currencyAndAmount__","You canceled your payment request to __contactName__ for __currencyAndAmount__","__contactName__ declined your payment request for __currencyAndAmount__.","You declined __contactName__'s payment request for __currencyAndAmount__.","__senderName__'s payment request for __currencyAndAmount__ to you expired.","Your payment request to __receiverName__ for __currencyAndAmount__ expired.","You notified __receiverName__ that you are trying to send a payment.","You can now send __receiverName__ a payment.","Waiting for this payment message's note. This may take a while.","Payment message  Amount unavailable","This payment message has a note but your version of WhatsApp doesn't support viewing it.","Requested from __receiverName__","Requested __amount__ from You","__senderName__ requested __amount__ from You","__senderName__ requested __amount__ from __receiverName__","Sent __amount__ to You","__senderName__ sent __amount__ to You","__senderName__ sent __amount__ to __receiverName__","Sent to __receiverName__","Canceled","Completed","Failed","Expired","In Review","Pending","Pending (expiring)","Pending (expires __timeSpan__)","Pending (expires in less than 1 minute)","Processing","__senderName__ sent you __currencyAndAmount__. Use WhatsApp on your phone to accept this transaction.","__senderName__'s payment __relativeTime__ is complete.","Declined","Your payment to __receiverName__ __relativeTime__ couldn't complete.","Your payment to __receiverName__ __relativeTime__ couldn't complete.","Your payment to __receiverName__  was refunded __relativeTime__.","on Friday","on Monday","on Saturday","on __date__","on Sunday","on Thursday","on Tuesday","on Wednesday","__name__ changed this group's icon","You changed this group's icon","__name__ deleted this group's icon","You deleted this group's icon","Preview","OFFICIAL ANNOUNCEMENTS","Recent chats","Recipients","Your security code with __contactName__ changed because there was a logout from one of their devices.",'Your security code with all recipients changed because there was a logout from one of your devices. To verify a contact\'s security code, open their Contact Info page and click "Encryption".',"Your security code with __contactName__ changed because there was a logout from one of your devices.",'Your security code with all participants changed because there was a logout from one of your devices. To verify a contact\'s security code, open their Contact Info page and click "Encryption".',"Reset link","Web Search","Your security code with __contactName__ changed. Click to learn more.","Your security code with __name__ changed because there was a registration on a new device of theirs.",'Your security code with all recipients changed because there was a registration on a new device of yours. To verify a contact\'s security code, open their Contact Info page and click "Encryption".',"Your security code with __name__ changed because there was a registration on a new device of yours.",'Your security code with all participants changed because there was a registration on a new device of yours. To verify a contact\'s security code, open their Contact Info page and click "Encryption".',"Select messages","Help Center","Share","This business uses WhatsApp Business, which allows them to add their opening hours, address, website and catalog of products or services.",'WhatsApp has verified that this is the official business account of "__businessName__". This business uses WhatsApp Business, which allows them to add their opening hours, address, website and catalog of products or services.',"Learn about getting the app","About WhatsApp Business","If youre a business, the free WhatsApp Business app can help.","If youre a business, you can benefit from switching to the free WhatsApp Business app. It has tools to connect with customers and manage messages.","Scan this code to get the WhatsApp Business App. Or, you can install it from the App Store or Google Play Store.","WhatsApp Business app","We are updating our WhatsApp Business Terms of Service. Agree to our new Terms on your phone to continue using WhatsApp Business.",'We are updating our WhatsApp Business Terms of Service. Agree to our new Terms on your phone to continue using WhatsApp Business. If you have accepted the Terms of Service, click "LOG IN" to continue using WhatsApp Business.',"Starred Messages","About",'This chat is with the verified business account for "__businessName__". Click for more info.','WhatsApp has made changes to the business account types. "Verified Business" will now be labeled as "Official Business Account".','This chat is with the business account for "__businessName__". Click for more info.','WhatsApp has made changes to the business account types. "Confirmed Business" will now be labeled as "Business Account".',"This chat may be with a business account. Click for more info.","__businessName__ may be a business account, but WhatsApp hasnt verified their name yet.",'The business account youre chatting with is now verified as "__businessName__". Click for more info.','WhatsApp has made changes to the business account types. "Verified Business" will now be labeled as "Official Business Account".',"This business account has now registered as a standard account. Click for more info.","This account was previously a business account and has now registered as a standard account. It may no longer belong to the business.",'The business account youre chatting with is no longer verified as "__businessName__". Click for more info.','WhatsApp is no longer able to verify that this is the account for "__businessName__".','The business account youre chatting with is no longer verified as "__businessName__". Click for more info.','WhatsApp is no longer able to verify that this is the account for "__businessName__".','The business account youre chatting with is no longer confirmed as "__businessName__". Click for more info.','WhatsApp is no longer able to confirm that this is the account for "__businessName__".',"This account has registered as a business account. Click for more info.",'This account has registered as a business account and WhatsApp has confirmed that this is the account for "__businessName__".',"This chat may be with a business account. Click for more info.","__businessName__ registered as a business account, but WhatsApp hasnt verified their name yet.",'The business account you\'re chatting with belongs to "__businessName__".','WhatsApp has made changes to the business account types. This "Confirmed Business" will now be labeled as "Business Account".',"WhatsApp is updating our Terms and Privacy Policy to reflect new features and comply with the new European Union data protection laws. Open WhatsApp on your phone to read our Terms and Privacy Policy and learn more about the choices you have.","WhatsApp is updating our Terms and Privacy Policy to reflect new features and comply with the new European Union data protection laws. Open WhatsApp on your phone to read our Terms and Privacy Policy and learn more about the choices you have.",'WhatsApp is updating our Terms and Privacy Policy to reflect new features and comply with the new European Union data protection laws. Open WhatsApp on your phone to read our Terms and Privacy Policy and learn more about the choices you have. If you have accepted the Terms and Privacy Policy, click "LOG IN" to continue using WhatsApp.',"__date__ at __time__","today","today at __time__","Try Again","The business account you're chatting with may belong to __businessName__. WhatsApp hasn't verified their name yet.","The business account you're chatting with is now unverified. Click for more info.","To help you connect with businesses, we have verified that the business account you're chatting with belongs to __businessName__.","This chat is with a verified business account. Click for more info.","The business account you're chatting with may belong to __businessName__. WhatsApp hasn't verified their name yet.","This chat is with an unverified business account. Click for more info.","To help you connect with businesses, we have verified that the business account you're chatting with belongs to __businessName__.","The business account you're chatting with is now verified. Click for more info.","Verify","Download code","Release to verify","The image does not contain a valid identity verification QR code.",'You opened "Verify security code" for the wrong phone number. Open it for the correct number to verify __contact__.','__contact__ opened "Verify security code" for the wrong phone number. Ask __contact__ to open it for your phone number.',"Scan the code on your contact's phone, or ask them to scan your code, to verify your messages and calls to them are end-to-end encrypted. You can also compare the number above to verify. This is optional.","Couldn't display security code. You can verify using the QR code instead.","Verify Security Code","Upload Code","Turn Off Camera","Please try increasing the brightness or reducing light reflection.","Scan Code","WHATSAPP VOICE CALL","Yes","yesterday","yesterday at __time__","You","You created a broadcast list with __count__ recipient","You","To use WhatsApp, update __chrome_update__ or use __firefox_homepage__, __safari_homepage__, __edge_homepage__ or __opera_homepage__.","WhatsApp works with Google Chrome __min_version_chrome__+","WhatsApp Commerce Policies","To use WhatsApp, update __edge_homepage__ or use __chrome_homepage__, __firefox_homepage__ or __opera_homepage__.","WhatsApp works with Microsoft Edge __min_version_edge__+","To use WhatsApp, update __firefox_update__ or use __chrome_homepage__, __safari_homepage__, __edge_homepage__ or __opera_homepage__.","WhatsApp works with Mozilla Firefox __min_version_firefox__+","WhatsApp group invite","WhatsApp","To use WhatsApp, update __safari_update__ or use __chrome_homepage__, __firefox_homepage__ or __opera_homepage__.","To use all of WhatsApp's features like photo capturing and Voice Message recording, we recommend using __chrome_homepage__, __firefox_homepage__ or __opera_homepage__.","Using Safari","WhatsApp works with Safari __min_version_safari__+","WhatsApp","Send and receive WhatsApp messages right from your computer.","WhatsApp is open in another window. Click Use Here to use WhatsApp in this window.","Quickly send and receive WhatsApp messages right from your computer.","We recommend using WhatsApp with one of the following browsers:","WhatsApp also supports:","You can't add more than __count__ labels","Your shop on WhatsApp","To update your Facebook shop, go to Commerce Manager. Changes will display on WhatsApp and in any other sales channels youve set.","Your security code with __contactName__ changed","This happened likely because __contactName__ or you recently changed which devices you use WhatsApp on. Please verify the security code again."],{37:"Changing __count__ labels",38:"Some labels could not be updated",39:"__count__ labels changed",142:"Couldn't delete __count__ messages because the messages may have expired",143:"Couldn't delete messages",144:"__count__ messages deleted",145:"Deleting messages",146:"Couldn't star messages because the messages may have expired",147:"Couldn't star messages",148:"__count__ messages starred",149:"Starring messages",151:"Couldn't unstar messages because the messages may have expired",152:"Couldn't unstar messages",153:"__count__ messages unstarred",155:"Unstarring messages",159:"Couldn't add __participantNames__.",161:"You added __participantNames__.",162:"Adding __participantNames__.",163:"Removing __participantNames__ as admins failed.",166:"__participantNames__ are no longer group admins.",167:"Removing __participantNames__ as group admins.",168:"They are no longer in this group.",169:"You can't add these participants because they left the group recently.",172:"Couldn't make __participantNames__ admins.",174:"__participantNames__ are now group admins.",175:"Making __participantNames__ group admins.",176:"Couldn't remove __participantNames__.",179:"You removed __participantNames__.",180:"Removing __participantNames__.",213:"Add participants",241:"__count__ Pages",245:"__number__ audio files you tried adding have no content.",250:"__number__ audio files you tried adding are larger than the __maxSize__ limit.",346:"__count__ messages couldn't be forwarded because __contact__ is on a version of WhatsApp that doesn't support them.",348:"__count__ messages couldn't be forwarded because the file is missing.",349:"__count__ messages couldn't be forwarded because the file is missing or __contact__ is on a version of WhatsApp that doesn't support them.",463:"__count__ items",479:"Send __count__ contacts to __chat__?",480:"Send __count__ contacts to __chat__?",481:"Send __count__ contacts to __chat__?",492:"Contact Cards",498:"__number__ contacts that you tried to add have no content.",499:"The contacts that you tried to add are larger than the __maxSize__ limit.",526:"Deleting a label removes it from all messages, contacts, and from the list of labels. Are you sure you want to delete these labels?",527:"Delete messages",528:"Delete messages?",545:"__count__ Docs",547:"__number__ documents you tried adding have no content.",548:"__number__ documents you tried adding are larger than the __maxSize__ limit.",580:"Disappearing messages were turned on. New messages will disappear from this chat after __number__ days.",581:"Disappearing messages were turned on. New messages will disappear from this chat after __number__ hours.",582:"Disappearing messages were turned on. New messages will disappear from this chat after __number__ minutes.",583:"Disappearing messages were turned on. New messages will disappear from this chat after __number__ seconds.",585:"You turned on disappearing messages. New messages will disappear from this chat after __number__ days.",586:"You turned on disappearing messages. New messages will disappear from this chat after __number__ hours.",587:"You turned on disappearing messages. New messages will disappear from this chat after __number__ minutes.",588:"You turned on disappearing messages. New messages will disappear from this chat after __number__ seconds.",590:"__name__ turned on disappearing messages. New messages will disappear from this chat after __number__ days.",591:"__name__ turned on disappearing messages. New messages will disappear from this chat after __number__ hours.",592:"__name__ turned on disappearing messages. New messages will disappear from this chat after __number__ minutes.",593:"__name__ turned on disappearing messages. New messages will disappear from this chat after __number__ seconds.",594:"__name__ turned on disappearing messages. New messages will disappear from this chat after __number__ years.",596:"Disappearing messages were turned on. New messages will disappear from this chat after __number__ days. Click to change.",597:"Disappearing messages were turned on. New messages will disappear from this chat after __number__ hours. Click to change.",598:"Disappearing messages were turned on. New messages will disappear from this chat after __number__ minutes. Click to change.",599:"Disappearing messages were turned on. New messages will disappear from this chat after __number__ seconds. Click to change.",601:"You turned on disappearing messages. New messages will disappear from this chat after __number__ days. Click to change.",602:"You turned on disappearing messages. New messages will disappear from this chat after __number__ hours. Click to change.",603:"You turned on disappearing messages. New messages will disappear from this chat after __number__ minutes. Click to change.",604:"You turned on disappearing messages. New messages will disappear from this chat after __number__ seconds. Click to change.",606:"__name__ turned on disappearing messages. New messages will disappear from this chat after __number__ days. Click to change.",607:"__name__ turned on disappearing messages. New messages will disappear from this chat after __number__ hours. Click to change.",608:"__name__ turned on disappearing messages. New messages will disappear from this chat after __number__ minutes. Click to change.",609:"__name__ turned on disappearing messages. New messages will disappear from this chat after __number__ seconds. Click to change.",612:"New messages will disappear from this chat after __number__ days.",613:"New messages will disappear from this chat after __number__ hours.",614:"New messages will disappear from this chat after __number__ minutes.",615:"New messages will disappear from this chat after __number__ seconds.",619:"This message will disappear from this chat after __number__ days.",620:"This message will disappear from this chat after __number__ hours.",621:"This message will disappear from this chat after __number__ minutes.",622:"This message will disappear from this chat after __number__ seconds.",634:"__number__ days",635:"__number__ hours",636:"__number__ minutes",637:"__number__ seconds",647:"Wait until the messages finish sending and displays a checkmark before forwarding.",657:"__number__ files you tried adding have no content.",658:"__count__ files failed to be downloaded because they are no longer on your phone.",659:"__number__ files could not be added.",660:"__number__ files you tried adding are not supported.",661:"__number__ files you tried adding are larger than the __maxSize__ limit.",668:"You can only share with up to __count__ chats",669:"Forwarded many times. You can only share with up to __count__ chats.",670:"Messages forwarded many times can only be shared with up to __count__ chats at a time.",671:"Forward messages",672:"Forward messages to",674:"Forwarded __count__ times",679:"Found contact cards for this number. View contact cards?",720:"__count__ contacts",725:"__count__ participants",749:"__count__ more",754:"Couldn't add __participant__. You can invite them privately to join this group.",790:"__unreadCount__ New Messages",793:"__number__ images you tried adding have no content.",801:"__number__ images you tried adding are larger than the __maxSize__ limit.",817:"Expires in __number__ days",824:"__count__ items",840:"__count__ Links",841:"Accurate to __accuracy__ M",842:"__count__ people",849:"Live until __time__",856:"__hours__h left",858:"__minutes__m left",859:"__sharers__ are sharing live location",861:"__count__ people are sharing live location",864:"You and __count__ others are sharing live location",869:"Updated __hours__h ago",872:"Updated __minutes__m ago",956:"__count__ remaining",992:"__contactName__ and __count__ other contacts",994:"__count__ contacts",995:"You can only send up to __count__ contacts",1181:"__count__ Products",1182:"This photo is too small. Please select a photo with height and width of at least __size__ pixels.",1192:'Remove label "__labelName__" from __count__ items',1225:"Retrying in __number__ seconds",1262:"See __count__ archived chats",1265:"__count__ selected",1285:"__count__ Screenshots Maximum",1304:"Star messages",1348:"__count__ suspicious links",1364:"Maximum number of files uploaded. __number__ files have been ignored.",1376:"__count__ unread messages",1382:"Unstar messages",1404:"__participants__ joined using your invite",1405:"You invited __participants__",1428:"__number__ videos you tried adding have no content.",1430:"__number__ videos you tried adding are larger than the __maxSize__ limit.",1432:"View Contact Cards",1492:"Call cannot be placed for more than __count__ participants",1494:"You can only call up to __count__ contacts",1495:"__callee__ couldn't be added to the call, because they are using an old version of WhatsApp or an incompatible device.",1496:"__count__ others",1588:"__count__ pages",1651:"__participants__ are no longer admins",1657:"__participants__ are now admins",1680:"__num__ invites sent",1687:"__name__ were added to the list",1688:"__name__ were removed from the list",1714:"Missed group video call at __time__",1716:"Missed group voice call at __time__",1718:"Missed video call at __time__",1720:"Missed voice call at __time__",1728:"__count__ participants",1730:"__contactName__ canceled their payment request for __currencyAndAmount__",1731:"You canceled your payment request to __contactName__ for __currencyAndAmount__",1732:"__contactName__ declined your payment request for __currencyAndAmount__.",1733:"You declined __contactName__'s payment request for __currencyAndAmount__.",1734:"__senderName__'s payment request for __currencyAndAmount__ to you expired.",1735:"Your payment request to __receiverName__ for __currencyAndAmount__ expired.",1742:"Requested __amount__ from You",1743:"__senderName__ requested __amount__ from You",1744:"__senderName__ requested __amount__ from __receiverName__",1745:"Sent __amount__ to You",1746:"__senderName__ sent __amount__ to You",1747:"__senderName__ sent __amount__ to __receiverName__",1759:"__senderName__ sent you __currencyAndAmount__. Use WhatsApp on your phone to accept this transaction.",1862:"You created a broadcast list with __count__ recipients"}]},52495:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ParsableWapNode=t.XmppParsingFailure=void 0;var a=r(27581),i=r(35773),n=r(11219),s=r(49244),o=r(95334),l=r(25364),d=r(62240);class u{constructor(e,t){this.parser=e,this.reason=t}toString(){return`XmppParsingFailure: ${this.parser}: ${this.reason}`}}t.XmppParsingFailure=u;class c extends d.ParsableXmlNode{constructor(e,t){super(e,t)}assertFromServer(){var e=this.attrString("from");"s.whatsapp.net"!==e&&this.throw(`to have "from"="s.whatsapp.net", but instead has "${e}"`)}attrUserJid(e){var t=this.attrString(e);return(0,n.interpretAndValidateJid)(t).userJid||this.throw(`to have "${e}"={UserJid}, but instead has "${t}"`)}maybeAttrUserJid(e){return this.hasAttr(e)?this.attrUserJid(e):null}attrGroupJid(e){var t=this.attrString(e);return(0,n.interpretAndValidateJid)(t).groupJid||this.throw(`to have "${e}"={GroupJid}, but instead has "${t}"`)}attrChatJid(e){var t=this.attrString(e),r=(0,n.interpretAndValidateJid)(t);return r.userJid||r.groupJid||this.throw(`to have "${e}"={ChatJid}, but instead has "${t}"`)}attrDeviceJid(e){var t=this.attrString(e),r=(0,n.interpretAndValidateJid)(t);return r.deviceJid?r.deviceJid:r.userJid?(0,n.defaultDeviceJidForUser)(r.userJid):this.throw(`to have "${e}"={DeviceJid}, but instead has "${t}"`)}attrDeviceId(e){var t=this.attrInt(e);return(0,n.interpretAsDeviceId)(t)}attrFromJid(){var e=this.attrJidWithType(),t=this.hasAttr("participant")?this.attrDeviceJid("participant"):null;switch(e.jidType){case"user":var r=e.userJid,a=(0,n.defaultDeviceJidForUser)(r);return{type:"device",deviceJid:a,chat:r,author:a};case"device":var i=e.deviceJid;return{type:"device",deviceJid:i,chat:(0,n.extractUserJid)(i),author:i};case"broadcast":return t?{type:"broadcast",broadcastJid:e.broadcastJid,chat:(0,n.extractUserJid)(t),author:t}:this.throw("to have participant for broadcast msg");case"group":if(!t)return this.throw("to have participant for group msg");var s=e.groupJid;return{type:"group",groupJid:s,chat:s,author:t};default:return e.jidType,t?{type:"status",author:t}:this.throw("to have participant for status msg")}}attrJidWithType(e="from"){var t=this.attrString(e),r=(0,n.interpretAndValidateJid)(t);return"unknown"===r.jidType?this.throw(`to have "${e}"={Jid}, but instead has "${t}"`):r}attrWapJid(e="from"){var t=this.attrString(e),r=(0,n.interpretAndValidateJid)(t);return"unknown"===r.jidType?a.WapJid.create(null,t):(0,i.JID)((0,n.extractFromJid)(r))}attrLongInt(e){var t=this.attrString(e);return(0,l.decimalStringToLongInt)(t)}attrTime(e){return(0,o.castToUnixTime)(this.attrInt(e))}attrFutureTime(e){var t=this.attrInt(e);return(0,o.futureUnixTime)(t)}contentString(){if(this.hasChildren())return this.throw("to have string content, but has children instead");if(this.hasContent()){var e=new s.Binary(this.contentBytes());return e.readString(e.size())}return this.throw("to have content")}decodeAsString(e){return(0,i.decodeAsString)(e)}throw(e){throw new u(this.name(),`expected <${this.tag()}> ${e}`)}}t.ParsableWapNode=c},27581:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WapJid=t.WAP_JID_SUBTYPE=void 0;var a=r(58545),i={JID:0,JID_AD:1};t.WAP_JID_SUBTYPE=i;class n{constructor(e){this._jid=e}static createAD(e,t,r){return new n({type:i.JID_AD,user:e,device:null==r?0:r,agent:null==t?0:t})}static create(e,t){return new n({type:i.JID,user:e,server:t})}toString(){if(this._jid.type===i.JID_AD){var{user:e,agent:t,device:r}=this._jid,n=a.USER_JID_SUFFIX;return 0===t&&0===r?`${e}@${n}`:0!==t&&0===r?`${e}.${t}@${n}`:0===t&&0!==r?`${e}:${r}@${n}`:`${e}.${t}:${r}@${n}`}this._jid.type;var{user:s,server:o}=this._jid;return null!=s?`${s}@${o}`:o}getInnerJid(){return this._jid}}t.WapJid=n},82420:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WapParser=void 0;var a=r(52495);t.WapParser=class{constructor(e,t){this._name=e,this._parser=t}parse(e){var t=new a.ParsableWapNode(this._name,e);try{return{success:this._parser(t)}}catch(e){if(e instanceof a.XmppParsingFailure)return{error:e};throw e}}parseOrThrow(e){var t=this.parse(e);if(t.error)throw new Error(String(t.error));return t.success}}},58545:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.USER_JID_FB_SUFFIX=t.USER_JID_SUFFIX=void 0;t.USER_JID_SUFFIX="s.whatsapp.net";t.USER_JID_FB_SUFFIX="msgr"},35773:(e,t,r)=>{"use strict";var a=r(34398);Object.defineProperty(t,"__esModule",{value:!0}),t.makeWapNode=A,t.decodeAsString=function(e){if(e instanceof o.WapJid)return e.toString();return e},t.makeStanza=P,t.encodeStanza=function(e){var t=e instanceof T?e:P(e),r=new i.Binary;O(t,r);var a=r.readByteArray(),n=new Uint8Array(1+a.length);return n[0]=0,n.set(a,1),n},t.decodeStanza=function(e,t){var r=new i.Binary(e);if(2&r.readUint8())return __LOG__(2)`Decoding compressed stanza`,t(r.readByteArray()).then((e=>U(new i.Binary(e))));return Promise.resolve(U(r))},t.generateId=function(){if(!m){var e=new Uint16Array(2);self.crypto.getRandomValues(e),m=`${String(e[0])}.${String(e[1])}-`}return`${m}${g++}`},t.extractToJid=B,t.extractParticipantJid=function(e){switch(e.type){case"group":case"status":case"broadcast":return e.author;default:return e.type,null}},t.PARTICIPANT_JID=function(e){return"status"===e.type||"group"===e.type||"broadcast"===e.type?Y(e.author):v},t.TO_JID=function(e){return Y(B(e))},t.JID=Y,t.CUSTOM_STRING=function(e){return e},t.MAYBE_CUSTOM_STRING=function(e){if(null==e)return v;return e},t.INT=function(e){return e.toString()},t.LONG_INT=function(e){return(0,u.longIntToDecimalString)(e)},t.BIG_ENDIAN_CONTENT=function(e,t=4){for(var r=e,a=new Uint8Array(t),i=t-1;i>=0;i--)a[i]=255&r,r>>>=8;return a},t.wap=t.WapNode=t.S_WHATSAPP_NET=t.G_US=t.DROP_ATTR=void 0;var i=r(49244),n=r(42849),s=r(58545),o=r(27581),l=r(39760),d=r(11219),u=r(25364),c=(a(r(92901)),[236,237,238,239]),p=248,h=249,f=["0","1","2","3","4","5","6","7","8","9","-",".","","","",""],_=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F"],m="",g=1,v={sentinel:"DROP_ATTR"};t.DROP_ATTR=v;var E=o.WapJid.create(null,"g.us");t.G_US=E;var y=o.WapJid.create(null,"s.whatsapp.net");t.S_WHATSAPP_NET=y;var S={};class T{constructor(e,t=S,r=null){this.tag=e,this.attrs=t,this.content=r}toString(){var e="<"+this.tag;e+=(0,n.attrsToString)(this.attrs);var t=this.content;return Array.isArray(t)?e+=`>${t.map(String).join("")}</${this.tag}>`:e+=t?`>${(0,n.uint8ArrayToDebugString)(t)}</${this.tag}>`:" />",e}}function A(e,t,r){var a=null;if(t&&null!=t.children)throw new Error('Children should not be passed via props (see eslint check "react/no-children-props")');if(Array.isArray(r))a=r.filter(Boolean);else if("string"==typeof r)a=i.Binary.build(r).readByteArray();else if(r instanceof ArrayBuffer)a=new Uint8Array(r);else if(r instanceof Uint8Array)a=r;else{for(var n=[],s=2;s<arguments.length;s++){var o=arguments[s];o&&n.push(o)}a=n}Array.isArray(a)&&0===a.length&&(a=null);var l={};if(t){var d=t;Object.keys(d).forEach((t=>{var r=d[t];if(null==r)throw new Error(`Attr ${t} in <${e}> is null`);r!==v&&(l[t]=r)}))}return new T(e,l,a)}t.WapNode=T;var b,C=A;function P(e){var t=e.content;return Array.isArray(t)?t=t.map(P):"string"==typeof t&&(t=i.Binary.build(t).readByteArray()),new T(e.tag,e.attrs||S,t)}function O(e,t){if(null==e)t.writeUint8(0);else if(e instanceof T)w(e,t);else if(e instanceof o.WapJid)!function(e,t){var r=e.getInnerJid();if(r.type===o.WAP_JID_SUBTYPE.JID_AD){var{user:a,agent:i,device:n}=r;t.writeUint8(247),t.writeUint8(i),t.writeUint8(n),O(a,t)}else{var{user:s,server:l}=r;t.writeUint8(250),null!=s?O(s,t):t.writeUint8(0),O(l,t)}}(e,t);else if("string"==typeof e)R(e,t);else{if(!(e instanceof Uint8Array))throw new Error("Invalid payload type "+typeof e);!function(e,t){N(e.length,t),t.writeByteArray(e)}(e,t)}}function w(e,t){if(void 0===e.tag)return t.writeUint8(p),void t.writeUint8(0);var r=1;e.attrs&&(r+=2*Object.keys(e.attrs).length),e.content&&r++,r<256?(t.writeUint8(p),t.writeUint8(r)):r<65536&&(t.writeUint8(h),t.writeUint16(r)),O(e.tag,t),e.attrs&&Object.keys(e.attrs).forEach((r=>{R(r,t),O(e.attrs[r],t)}));var a=e.content;if(Array.isArray(a)){a.length<256?(t.writeUint8(p),t.writeUint8(a.length)):a.length<65536&&(t.writeUint8(h),t.writeUint16(a.length));for(var i=0;i<a.length;i++)w(a[i],t)}else a&&O(a,t)}t.wap=C;var M=null;function I(e){for(var t=new Map,r=0;r<e.length;r++)t.set(e[r],r);return t}function R(e,t){if(""===e)return t.writeUint8(252),void t.writeUint8(0);null==b&&(b=I(l.SINGLE_BYTE_TOKEN));var r=b.get(e);if(null==r){if(null==M){M=[];for(var a=0;a<l.DICTIONARIES.length;++a)M.push(I(l.DICTIONARIES[a]))}for(var n=0;n<M.length;++n){var s=M[n].get(e);if(null!=s)return t.writeUint8(c[n]),void t.writeUint8(s)}var o=(0,i.numUtf8Bytes)(e);if(o<128){if(!/[^0-9.-]+?/.exec(e))return void D(e,255,t);if(!/[^0-9A-F]+?/.exec(e))return void D(e,251,t)}N(o,t),t.writeString(e)}else t.writeUint8(r+1)}function D(e,t,r){var a=e.length%2==1;r.writeUint8(t);var i=Math.ceil(e.length/2);a&&(i|=128),r.writeUint8(i);for(var n=0,s=0;s<e.length;s++){var o=e.charCodeAt(s),l=null;if(48<=o&&o<=57?l=o-48:255===t?45===o?l=10:46===o&&(l=11):251===t&&65<=o&&o<=70&&(l=o-55),null==l)throw new Error(`Cannot nibble encode ${o}`);s%2==0?(n=l<<4,s===e.length-1&&(n|=15,r.writeUint8(n))):(n|=l,r.writeUint8(n))}}function N(e,t){if(e<256)t.writeUint8(252),t.writeUint8(e);else if(e<1048576)t.writeUint8(253),t.writeUint8(e>>>16&255),t.writeUint8(e>>>8&255),t.writeUint8(255&e);else{if(!(e<4294967296))throw new Error(`Binary with length ${e} is too big for WAP protocol`);t.writeUint8(254),t.writeUint32(e)}}function L(e,t){var r,a,i,n=e.readUint8();if(0===n)return null;if(n===p)return k(e,e.readUint8());if(n===h)return k(e,e.readUint16());if(252===n){var s=e.readUint8();return F(e,s,t)}if(253===n){var d=e.readUint8(),u=e.readUint8(),c=e.readUint8();return F(e,((15&d)<<16)+(u<<8)+c,t)}if(254===n){var m=e.readUint32();return F(e,m,t)}if(250===n)return a=function(e){var t=L(e,!0);if(null!=t&&"string"!=typeof t)throw new Error(`Decode string got invalid value ${String(t)}, string expected`);return t}(r=e),i=G(r),o.WapJid.create(a,i);if(247===n)return function(e){var t=e.readUint8(),r=e.readUint8(),a=G(e);return o.WapJid.createAD(a,t,r)}(e);if(255===n){var g=e.readUint8();return x(e,f,g>>>7,127&g)}if(251===n){var v=e.readUint8();return x(e,_,v>>>7,127&v)}if(n<=0||n>=240)throw new Error("Unable to decode WAP buffer");if(n>=236&&n<=239){var E=n-236,y=l.DICTIONARIES[E];if(void 0===y)throw new Error(`Missing WAP dictionary ${E}`);var S=e.readUint8(),T=y[S];if(void 0===T)throw new Error(`Invalid value index ${S} in dict ${E}`);return T}var A=l.SINGLE_BYTE_TOKEN[n-1];if(void 0===A)throw new Error(`Undefined token with index ${n}`);return A}function k(e,t){for(var r=[],a=0;a<t;a++)r.push(U(e));return r}function U(e){var t,r=e.readUint8();if(r===p)t=e.readUint8();else{if(r!==h)throw new Error(`Failed to decode node since type byte ${String(r)} is invalid`);t=e.readUint16()}var a=void 0,i=null;if(0===t)throw new Error("Failed to decode node, list cannot be empty");var n=G(e);for(t-=1;t>1;){a||(a={});var s=G(e),l=L(e,!0);a[s]=l,t-=2}return 1===t&&(i=L(e,!1))instanceof o.WapJid&&(i=String(i)),new T(n,a,i)}function G(e){var t=L(e,!0);if("string"!=typeof t)throw new Error(`Decode string got invalid value ${String(t)}, string expected`);return t}function F(e,t,r=!1){return r?e.readString(t):e.readByteArray(t)}function x(e,t,r,a){for(var i=new Array(2*a-r),n=0;n<i.length-1;n+=2){var s=e.readUint8();i[n]=t[s>>>4],i[n+1]=t[15&s]}if(r){var o=e.readUint8();i[i.length-1]=t[o>>>4]}return i.join("")}function B(e){switch(e.type){case"group":return e.groupJid;case"status":return d.STATUS_JID;case"device":return e.deviceJid;default:return e.type,e.broadcastJid}}function Y(e){var[t,r]=e.split("@"),a=null,i=null;return r===s.USER_JID_SUFFIX&&(-1!==t.indexOf(":")&&([t,i]=t.split(":"),i=parseInt(i,10)),-1!==t.indexOf(".")&&([t,a]=t.split("."),a=parseInt(a,10))),null!=i&&0!==i||null!=a&&0!==a?o.WapJid.createAD(t,a,i):o.WapJid.create(t,r)}},39760:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DICTIONARIES=t.DICTIONARY_3_TOKEN=t.DICTIONARY_2_TOKEN=t.DICTIONARY_1_TOKEN=t.DICTIONARY_0_TOKEN=t.SINGLE_BYTE_TOKEN=t.DICT_VERSION=void 0;t.DICT_VERSION=1;t.SINGLE_BYTE_TOKEN=["xmlstreamstart","xmlstreamend","s.whatsapp.net","id","type","from","to","participant","t","receipt","status","jid","2","broadcast","class","g.us","iq","enc","v","ack","1","message","user","notify","read","skmsg","xmlns","result","0","offline","text","off_cnt","7","get","edit","phash","media","mediatype","image","value","item","presence","contact","msg","set","notification","chatstate","video","host","hostname","picture","fna","composing","w:p","ping","pop","media_conn","ip4","primary","download","unavailable","fallback_ip4","fallback_hostname","fallback_class","config","w","ip6","count","participants","fallback_ip6","call","download_buckets","3","retry","00","gif","upload","w:m","last","props","edge_routing","routing_info","handshake","pkmsg","26","location","creation","vll","success","seen","in","list","12","auth","subject","21600","auth_ttl","max_buckets","300","ttl","is_new","hash","call-id","call-creator","platform","4","urn:xmpp:whatsapp:push","relaylatency","8","gcm","urn:xmpp:ping","preview","delivery","verified_name","subscribe","01","name","deny","code","paused","last_id","audio","web","te","out","bits","w:profile:picture","ptt","add","mmg.whatsapp.net","te2","relay_id","business","available","fallback","w:stats","401","contacts","sticker","verified_level","key","unknown","url","5","latency","multicast","fail","prop","w:web","mode","profile","error","played","registration","identity","02","100","6","tag","101","103","102","108","query","104","encrypt","109","document","110","106","107","105","111","day_of_week","business_hours_config","stream:error","e","update","03","transport","false","usync","open_time","delete","resume","medium","net","close_time","1235433600","9","serial","w:gp2","catalog_status","specific_hours","rate","opus","sidelist","action","orientation","true","vertical","canonical","none","04","device_orientation","signature","skey","priority","catalog_not_created","order","context","index","mute","token","offer","terminate","version","token_id","encopt","capability","side_list","ver","05","keygen",".","16000","reason","relay","media-bom1-1.cdn.whatsapp.net","state","direct_path","1080","06","media-sin6-1.cdn.whatsapp.net","conflict"];var r=["screen_height","sync","protocol","c","screen_width","a","description","404","media-frx5-1.cdn.whatsapp.net","540","item-not-found","remove","open_24h","07","10","preaccept","invis","not-authorized","refresh","b","media-gig2-1.cdn.whatsapp.net","media-gru1-1.cdn.whatsapp.net","media-maa2-1.cdn.whatsapp.net","default","d","invite","status-revoke-delay","11","8000","features","08","media_type","resume_check","peer_pid","background","attribute_padding","admin","media-mrs2-1.cdn.whatsapp.net","address","delta","voip_settings","readreceipts","disable","09","note.m4r","complete","business_hours","13","media-frt3-1.cdn.whatsapp.net","accept","uncompressed","rte","200","media-del1-1.cdn.whatsapp.net","720","media-mia3-1.cdn.whatsapp.net","transaction-id","dec","android","keys","other","media-xsp1-1.cdn.whatsapp.net","mon","email","uploadfieldstat","wed","tue","thu","15","14","0a","status-old","timezone","16","lg","w:g2","lc","sat","fri","catalog_exists","480","vp8","website","0b","f","media-eze1-1.cdn.whatsapp.net","media-cgk1-1.cdn.whatsapp.net","active","duration","17","media-cdg2-1.cdn.whatsapp.net","reg_push","groups","media-sof1-1.cdn.whatsapp.net","18","0c","tsoffline","voip","background_location","media-qro1-1.cdn.whatsapp.net","19","nse_ver","Opening.m4r","timeout","latitude","0d","media-otp1-1.cdn.whatsapp.net","media-arn2-1.cdn.whatsapp.net","media-cdt1-1.cdn.whatsapp.net","longitude","24","interactive","media-dfw5-1.cdn.whatsapp.net","not-a-biz","category","media-scl1-1.cdn.whatsapp.net","0f","contact_add","media-mxp1-1.cdn.whatsapp.net","media.fnag1-3.fna.whatsapp.net","media-lhr8-1.cdn.whatsapp.net","media.fnag1-1.fna.whatsapp.net","0e","full","media-lht6-1.cdn.whatsapp.net","voip_payload_type","media-atl3-1.cdn.whatsapp.net","sun","256","-","media-for1-1.cdn.whatsapp.net","25","media-bog1-1.cdn.whatsapp.net","media.fnag1-2.fna.whatsapp.net","20","21","passive","fbip","h.264","contact_remove","22","23","vp8/h.264","media-mad1-1.cdn.whatsapp.net","600","media-frt3-2.cdn.whatsapp.net","255","abt","audio_duration","creator","s_t","group","appointment_only","media-kut2-1.cdn.whatsapp.net","forbidden","media-mia3-2.cdn.whatsapp.net","27","010","media.fsub6-4.fna.whatsapp.net","is_biz","media.fsub6-5.fna.whatsapp.net","50","012","media-sin6-2.cdn.whatsapp.net","connected","media.fcgk5-1.fna.whatsapp.net","28","011","media.fsub6-1.fna.whatsapp.net","invalid","1200","media-xsp1-2.cdn.whatsapp.net","mmg-fna.whatsapp.net","403","media.fcgk4-1.fna.whatsapp.net","media.fsub6-2.fna.whatsapp.net","29","s_o","jabber:iq:privacy","media.fmaa1-4.fna.whatsapp.net","30","32","media.fsub6-3.fna.whatsapp.net","-123","media.fcgk8-1.fna.whatsapp.net","media.fcgk8-2.fna.whatsapp.net","video_duration","media-lim1-1.cdn.whatsapp.net","categories","media-gru2-1.cdn.whatsapp.net","media.fsub3-2.fna.whatsapp.net","013","media.fsub3-1.fna.whatsapp.net","media.fcgk9-2.fna.whatsapp.net","1280","media.fcgk3-2.fna.whatsapp.net","reject","2.20.140","media.fjed4-5.fna.whatsapp.net","media.fmaa1-3.fna.whatsapp.net","media.fcgk9-1.fna.whatsapp.net","media-gru2-2.cdn.whatsapp.net","014","33","31","1020","en","media-arn2-2.cdn.whatsapp.net","media-bom1-2.cdn.whatsapp.net","media.fcgk4-4.fna.whatsapp.net","superadmin","media.fsub2-3.fna.whatsapp.net","media.fsub4-1.fna.whatsapp.net","media.fmaa1-1.fna.whatsapp.net","media-hel2-1.cdn.whatsapp.net","media.famd1-1.fna.whatsapp.net","1a","960","media.fevn1-3.fna.whatsapp.net","1140","privacy","media-jnb1-1.cdn.whatsapp.net","media.fcgk4-2.fna.whatsapp.net","media-mrs2-2.cdn.whatsapp.net","user_add","016","media.fdel3-2.fna.whatsapp.net","media.fjed4-6.fna.whatsapp.net","015","media.fjed4-1.fna.whatsapp.net","35","37","media.fevn1-1.fna.whatsapp.net","34","media.famd1-2.fna.whatsapp.net","media.fbho1-2.fna.whatsapp.net","media.fbho1-1.fna.whatsapp.net","1b","1260","...","business_profile","media-dfw5-2.cdn.whatsapp.net","media.fruh4-6.fna.whatsapp.net","rc_dyn","media.fevn1-2.fna.whatsapp.net","w:biz","254","server-error","media.fruh4-2.fna.whatsapp.net","5000","media.ffjr1-3.fna.whatsapp.net","media.fmaa2-1.fna.whatsapp.net","36","..","media.fmaa2-2.fna.whatsapp.net","40"];t.DICTIONARY_0_TOKEN=r;var a=["WhatsApp","prof-services","1c","media.fcgk7-2.fna.whatsapp.net","media.fdel1-2.fna.whatsapp.net","media.fjed4-3.fna.whatsapp.net","018","group_update","media-lax3-1.cdn.whatsapp.net","media.fruh4-3.fna.whatsapp.net","timestamp","38","media.fdel1-4.fna.whatsapp.net","media.fdel3-1.fna.whatsapp.net","not-allowed","017","39","media.ffjr1-2.fna.whatsapp.net","405","media-ams4-1.cdn.whatsapp.net","media.fcgk3-1.fna.whatsapp.net","userrate","maxfpp","battery","1e","media.ffjr1-4.fna.whatsapp.net","from_ip","1320","019","41","1d","locales","media.ffjr1-1.fna.whatsapp.net","encode","420","media-amt2-1.cdn.whatsapp.net","media.fdel1-3.fna.whatsapp.net","media.fsub2-1.fna.whatsapp.net","45","media.fblr4-1.fna.whatsapp.net","01a","options","enable_vid_one_way_codec_nego","253","browser","aud_pkt_reorder_pct","group_info","live","media.fruh4-5.fna.whatsapp.net","55","01b","media.fmaa1-2.fna.whatsapp.net","entertain","tJyEK","to_ip","media-scl2-1.cdn.whatsapp.net","47558758","44","media.fbho4-1.fna.whatsapp.net","use_correct_order_for_hmac_sha1","43","media.fsaw1-5.fna.whatsapp.net","latency_update_threshold","media.fblr4-2.fna.whatsapp.net","media.fbtz1-4.fna.whatsapp.net","01d","mediaretry","os","retail","auto","enabled_for_video_upgrade","lock_video_orientation","iphone","media.fcgk4-3.fna.whatsapp.net","media.fdel1-1.fna.whatsapp.net","media.fsaw1-2.fna.whatsapp.net","42","k","pid","116470092","46","body","init_bwe","u","nack","60180140","config_code","digest","re","media.fcgk7-1.fna.whatsapp.net","media.fgbb2-2.fna.whatsapp.net","media.fjed4-2.fna.whatsapp.net","1920","01c","47","media.fada1-6.fna.whatsapp.net","media.fcgk18-1.fna.whatsapp.net","proto","status-revoke-drop","A","01f","117625616","127030578","49","83503547","020","80","es","media.fgbb2-1.fna.whatsapp.net","media.fudr1-1.fna.whatsapp.net","1f","Windows","01e","48","51","53","config_value","media-fco1-1.cdn.whatsapp.net","media.fblr1-3.fna.whatsapp.net","media.fjai1-1.fna.whatsapp.net","56","media.fbtz1-8.fna.whatsapp.net","media.fsub2-2.fna.whatsapp.net","cond_net_medium","media.fcgh4-1.fna.whatsapp.net","media.fcgk18-2.fna.whatsapp.net","media.fsaw1-6.fna.whatsapp.net","media.fada1-7.fna.whatsapp.net","powersave","url_text","0.17.11","apparel","media.fsaw1-4.fna.whatsapp.net","021","media-waw1-1.cdn.whatsapp.net","127044826","252","660","media-los2-1.cdn.whatsapp.net","251","media.fsaw1-1.fna.whatsapp.net","41529916","58","59","61","enc_rekey","media-lga3-1.cdn.whatsapp.net","media.fhyd11-1.fna.whatsapp.net","media.fjai1-2.fna.whatsapp.net","media.fjed4-4.fna.whatsapp.net","media.fsaw1-10.fna.whatsapp.net","250","65","media.fcgh5-1.fna.whatsapp.net","media.fdmm2-3.fna.whatsapp.net","~","75","media.fbom19-2.fna.whatsapp.net","66","media.fdmm2-2.fna.whatsapp.net","media.fkno4-1.fna.whatsapp.net","026","55914014","media.fbtz1-7.fna.whatsapp.net","media.fsaw1-8.fna.whatsapp.net","minfpp","39637006","media-lax3-2.cdn.whatsapp.net","media.fdmm2-1.fna.whatsapp.net","media.fsaw1-9.fna.whatsapp.net","57","86400","America/Sao_Paulo","media-dus1-1.cdn.whatsapp.net","media-iad3-1.cdn.whatsapp.net","media.fupg1-1.fna.whatsapp.net","780","media.fada1-2.fna.whatsapp.net","locked","media.fpku3-1.fna.whatsapp.net","media.fruh4-1.fna.whatsapp.net","watls_prefer_ip6","29147490","67","94384562","govt","timeoffline","022","52","M","media.faep8-2.fna.whatsapp.net","media.fhex4-2.fna.whatsapp.net","120","64","media.fruh4-4.fna.whatsapp.net","510","media.fblr1-4.fna.whatsapp.net","media.fupg2-1.fna.whatsapp.net","64084020","840","62","frskmsg","2b","54","all","63","media.fada1-1.fna.whatsapp.net","media.fada1-3.fna.whatsapp.net","media.fhex4-1.fna.whatsapp.net","media.fknu1-1.fna.whatsapp.net","media-mba1-1.cdn.whatsapp.net","Asia/Kolkata","media.fada1-5.fna.whatsapp.net","media.fsub1-2.fna.whatsapp.net","023","024","69","media.fada2-1.fna.whatsapp.net","video_max_bitrate","....","1380","246","60","media.fada1-8.fna.whatsapp.net","media.fdmm2-4.fna.whatsapp.net","media.fmct2-3.fna.whatsapp.net","media.fpku2-1.fna.whatsapp.net","watls_enabled","ab_key","beauty","cond_range_rtt","modify","original_image_url","outgoing","request_image_url","025","750","76","87","media.fada2-2.fna.whatsapp.net","media.faep8-1.fna.whatsapp.net","media.fbtz1-9.fna.whatsapp.net","6000","68","68040630","request","media.fagr1-2.fna.whatsapp.net","media.fdel2-1.fna.whatsapp.net","media.faep9-1.fna.whatsapp.net","media.fbtz1-5.fna.whatsapp.net","55663882","58089031","dtx","media.fsdu2-2.fna.whatsapp.net","media-maa2-2.cdn.whatsapp.net","media.fsaw1-7.fna.whatsapp.net"];t.DICTIONARY_1_TOKEN=a;var i=["target_bitrate","02a","240","media.fcgk24-2.fna.whatsapp.net","92540522","Chrome","media.fdel2-2.fna.whatsapp.net","socTy","watls_early_data","248","79","90","Asia/Jakarta","media.faep9-2.fna.whatsapp.net","source","027","249","2a","disable_prewarm","media.fdel11-1.fna.whatsapp.net","media.fesb4-1.fna.whatsapp.net","media.fixc1-3.fna.whatsapp.net","media.fsdu2-1.fna.whatsapp.net","watls_no_dns","media.fbtz1-6.fna.whatsapp.net","02b","71","85458909","cond_range_packet_loss_pct","029","02e","US","media-kut2-2.cdn.whatsapp.net","media.fasr1-1.fna.whatsapp.net","media.fbdo6-2.fna.whatsapp.net","1177879","77","enc_iv","media.fkul6-1.fna.whatsapp.net","74","media.fada1-4.fna.whatsapp.net","media.fbom19-1.fna.whatsapp.net","media.fsti4-1.fna.whatsapp.net","R","S","biz_block_reasons","media-ort2-1.cdn.whatsapp.net","media.fbtz1-3.fna.whatsapp.net","media.fkul6-2.fna.whatsapp.net","begin","media.fadb3-1.fna.whatsapp.net","media.fbom26-1.fna.whatsapp.net","pt","vid_rc_dyn","70","028","1334","85","92","BR","media.fixc1-2.fna.whatsapp.net","236","242","244","78","biz_block_reasons_version","media-hkg4-1.cdn.whatsapp.net","media.fbom3-1.fna.whatsapp.net","media.fbtz1-1.fna.whatsapp.net","media.fbtz1-2.fna.whatsapp.net","media.fslv1-2.fna.whatsapp.net","73","86","max_subject","media.fagr1-1.fna.whatsapp.net","suspicious_links","245","81","groups_privacy_blacklist","media.fesb3-2.fna.whatsapp.net","media.fist2-1.fna.whatsapp.net","media.fpat1-1.fna.whatsapp.net","media.fsaw2-1.fna.whatsapp.net","media.fsub1-1.fna.whatsapp.net","239","432000","84","media.fadb3-2.fna.whatsapp.net","media.fsaw2-2.fna.whatsapp.net","mms_resume_check_chatd","146","72","83","health","media.fbtz1-10.fna.whatsapp.net","media.fgdl5-3.fna.whatsapp.net","02c","98132223","frequently_forwarded_messages","fs_time_spent","media-vie1-1.cdn.whatsapp.net","media.fccu2-1.fna.whatsapp.net","media.fgyd4-1.fna.whatsapp.net","media.ftuc1-1.fna.whatsapp.net","rc","02d","105427442","900","grocery","group_description_length","media.fgdl5-1.fna.whatsapp.net","media.fist6-1.fna.whatsapp.net","status_video_max_duration","video_codec_priority","033","129563314","180","33554500","503","53713952","89","enable_short_offset","image_max_edge","media.fesb4-2.fna.whatsapp.net","mms_vcache_aggregation_enabled","status_image_max_edge","2f","97","max_bytes","media.fist2-2.fna.whatsapp.net","template_hsm","02f","33554490","announcement_groups","change_number_v2","init_bitrate","media.fbom3-2.fna.whatsapp.net","media.fbom4-2.fna.whatsapp.net","media.fesb3-1.fna.whatsapp.net","media.fidr1-2.fna.whatsapp.net","120661159","128000","247","82","95","enc_p","group_invite_sending","max_participants","media.fbog2-2.fna.whatsapp.net","media.fdel25-1.fna.whatsapp.net","mms_media_key_ttl","-128000","243","33554481","369730359717478","94","96","image_max_kbytes","travel","030","117","130","172800","2d","Desktop","TR","finance","media.fcgk24-1.fna.whatsapp.net","media.fkul5-2.fna.whatsapp.net","33554479","95051518","GB","image_quality","media.fasr1-2.fna.whatsapp.net","media.fidr1-1.fna.whatsapp.net","media.fsaw1-3.fna.whatsapp.net","ru","vid_rc","wap4_enabled","123383191","17578881","2e","33554486","fwd_ui_start_ts","media_max_autodownload","mms_async_fast_forward_ttl","mobile_config","1001","112","113","241","33554484","33554485","93","enable_audio_piggyback_feature","gdpr_report","gif_provider","max_keys","media.fbfh1-2.fna.whatsapp.net","media.fbom4-1.fna.whatsapp.net","promote","sticker_notification_preview","voip_incoming_xml_signaling","1024","1050","157","237","33554483","33554498","91","America/Belem","google_backup_api_w_enabled","media.fbog2-1.fna.whatsapp.net","mms_chatd_resume_check_over_thrift","129864860","2.20.123","228","229","234","33554496","88","announcement","audio_piggyback_timeout_msec","cross_post","frequently_forwarded_max","max_tx_rott_based_bitrate","media.fslv1-1.fna.whatsapp.net","multicast_limit_global","product_catalog_open_deeplink","product_catalog_webclient","status_image_quality","stickers","template_doc_mime_types","test_flags","use_downloadable_filters_int","127","235","33554522","39319543","98","98905883","auth_fingerprint_enabled","enable_periodical_aud_rr_processing","group_join_permissions","media.fmed1-2.fna.whatsapp.net","media.fpku1-1.fna.whatsapp.net","media.fpnq1-2.fna.whatsapp.net","media.ftuc1-2.fna.whatsapp.net","mms_hot_content_timespan_in_seconds","third_party_sticker_caching","1110","1344","19575915","27014777","33554497","33554505"];t.DICTIONARY_2_TOKEN=i;var n=["continuous_ptt_playback","high","media.fbdo1-2.fna.whatsapp.net","media.fbfh1-1.fna.whatsapp.net","media.fscl13-2.fna.whatsapp.net","payments_disable_switch_psp","share_biz_vcard_enabled","status_collapse_muted","voip_incoming_xml_ack","117530242","33554493","33554511","33554515","34838051","450","812","bwe","contact_indexing_ui_enabled","file_max_size","media.fbog2-3.fna.whatsapp.net","media.flca1-2.fna.whatsapp.net","media.fotp3-2.fna.whatsapp.net","media.fsti4-2.fna.whatsapp.net","media.ftru2-3.fna.whatsapp.net","video_max_edge","voice_note_locking_enabled","wam_buffer_count","131","133","160","182","238","33554488","33554491","enable_audio_oob_fec_feature","groups_v3","lasso_integration_enabled","media.fpnq1-1.fna.whatsapp.net","mms_cat_v1_forward_hot_override_enabled","optimistic_image_processing_enabled","packless_hsm","payments_request_messages","status_video_max_bitrate","user_remove","usync_sidelist","voice_note_previewing_enabled","220","33554471","33554502","33554507","33554508","Tri-tone.caf","enable_audio_oob_fec_for_sender","heartbeat_interval","image_edit_zoom","instrument_spam_report_enabled","media-hkt1-1.cdn.whatsapp.net","media.fccu11-1.fna.whatsapp.net","media.fhyd1-2.fna.whatsapp.net","media.fotp3-1.fna.whatsapp.net","media.frba2-2.fna.whatsapp.net","search_in_storage_usage","stream_progressive_jpeg_enabled","web_service_delay","199","221","257","33554501","33554520","570","982188032","consumer_content_provider","db_media_migration_step","db_migration_step","fieldstats_beacon_chance","final_live_location","kaios","max_bitrate","media.fdel27-1.fna.whatsapp.net","media.fkul4-2.fna.whatsapp.net","media.flim18-2.fna.whatsapp.net","media.fluh2-1.fna.whatsapp.net","mtu_size","status_ranking_signal_collection",".....","132","134","145","215","33554487","33554503","33554504","33554516","media.fada1-10.fna.whatsapp.net","mms4_direct_path","payments_upi_transaction_limit","receipt_agg","sigquit_anr_detector_release_rollover_percent","use_local_probing_rx_bitrate","115","33554489","33554514","33554524","33554525","52270851","account_transfer_enabled","audio_oob_fec_max_pkts","de","media-sjc3-1.cdn.whatsapp.net","media.fkul2-2.fna.whatsapp.net","off","121","126","129","153","205","512","99","DE","business_product_catalog","consumer_rc_provider","media.fccu13-1.fna.whatsapp.net","media.fcok1-1.fna.whatsapp.net","media.fcor2-2.fna.whatsapp.net","media.fkul5-1.fna.whatsapp.net","media.fmed1-1.fna.whatsapp.net","media.fpku1-2.fna.whatsapp.net","123","144","150","177","179","191","217","230","33554478","33554494","33554506","350000","82095225","call_in_remote","chord.m4r","google_backup_api_enabled","inline_video","media.fctg1-2.fna.whatsapp.net","media.fist7-2.fna.whatsapp.net","media.fkul2-1.fna.whatsapp.net","move_media_folder_from_sister_app","111404497","124","125","128","135","163","168","189","360","RU","media.fhyd6-1.fna.whatsapp.net","media.fist7-1.fna.whatsapp.net","media.fkul3-2.fna.whatsapp.net","p256dh","payments_web_enabled","product","terminated","141","149","155","161","170","185","204","222","223","2c","33554469","33554499","34816","93580432","call_out_remote","cond_range_target_total_bitrate","final","media.fkul4-1.fna.whatsapp.net","media.fscl9-1.fna.whatsapp.net","mms4_media_retry_notification_encryption_enabled","status_v3_text","stickers_keyboard_integration_enabled","thread_dump_contact_support","wam_real_time_enabled","0.17.10","031","122","1531267200","176","212","33554461","33554470","33554492","33554535","3d","Hi","enable_audio_pkt_piggyback_for_sender","enhanced_block_enabled","ignore_muted_in_badge_count","it","media.flim1-1.fna.whatsapp.net","recipient","139","198","2.20.42","33554466","3e","H","group_call_discoverability_enabled","mms4_audio","optimistic_upload","114","118","138","147","1500","156","165","169","172","190","201","210","224","227","232","33554465","33554474","33554526","644728732639272","Mac OS","media.fbdo6-1.fna.whatsapp.net","media.fesb1-1.fna.whatsapp.net","media.fotp3-3.fna.whatsapp.net","media.fres2-1.fna.whatsapp.net","media.fruh2-1.fna.whatsapp.net","profilo_enabled","039","03c","047","137","142","175","187","196","231","33554475","33554518","K","audio_picker","cond_congestion_no_init_rtt_thr"];t.DICTIONARY_3_TOKEN=n;var s=[r,a,i,n];t.DICTIONARIES=s},12872:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Offline=t.Disconnected=void 0;var a=r(71436),i=(0,a.customError)("Disconnected",!1);t.Disconnected=i;var n=(0,a.customError)("Offline",!1,i);t.Offline=n},21839:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.castToServerMediaType=function(e){switch(e){case"image":case"sticker":case"ptt":case"audio":case"document":case"video":case"gif":case"ppic":case"md-app-state":case"md-msg-hist":case"kyc-id":case"thumbnail-image":case"thumbnail-video":case"thumbnail-gif":case"thumbnail-document":case"thumbnail-link":case"novi-video":case"novi-image":case"template":case"product":case"product-catalog-image":return e;default:return null}},t.SERVER_MEDIA=void 0;t.SERVER_MEDIA=["image","sticker","ptt","audio","document","video","gif","ppic","md-app-state","md-msg-hist","kyc-id","template","thumbnail-image","thumbnail-video","thumbnail-gif","thumbnail-document","thumbnail-link","novi-video","novi-image","product","product-catalog-image"]},88906:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FrameSocket=t.SocketClosed=void 0;var a=r(49244);class i extends Error{constructor(e){var t="SocketClosed";super(null!=e?e:t),this.name=t}}t.SocketClosed=i;function n(e){return!(e.size()<3)&&s(e)<=e.size()}function s(e){return e.readUint8()<<16|e.readUint16()}t.FrameSocket=class{constructor(e,t){this._incoming=new a.Binary,this.closed=!1,this._draining=!1,this.onFrame=null,this.onClose=null,this._handleData=e=>{this._incoming.writeByteArray(e),this.convertBufferedToFrames()},this._handleClose=()=>{if(this._incoming.peek(n))return __LOG__(2)`FrameSocket closed, waiting for pending processing`,void(this._draining=!0);this._doClose()},this._doClose=()=>{if(!this.closed){__LOG__(2)`FrameSocket closed`,this._draining=!1,this.closed=!0;var e=this.onClose;e&&e()}},this._handleError=e=>{__LOG__(4,void 0,new Error)`FrameSocket error ${e}`},this._introToSend=t,this._socket=e,e.onData=this._handleData,e.onClose=this._handleClose,e.onError=this._handleError}sendFrame(e){if(!this._draining){this.throwIfClosed();var t=this._introToSend,r=e.byteLength,a=this._socket.dataToSend;t?(this._introToSend=null,a.ensureAdditionalCapacity(t.length+3+r),a.writeByteArray(t)):a.ensureAdditionalCapacity(3+r),a.writeUint8(r>>16),a.writeUint16(65535&r),a.write(e),this._socket.requestSend()}}convertBufferedToFrames(){for(var e=this._incoming,t=this.onFrame;t&&e.peek(n);){var r=s(e);__LOG__(2)`FrameSocket.onFrame(${r} bytes)`,t(e.readByteArray(r)),t=this.onFrame}this._draining&&!e.peek(n)&&this._doClose(),t&&e.size()&&__LOG__(2)`FrameSocket: queueing partial frame of ${e.size()} bytes`}throwIfClosed(){if(this.closed)throw new i}close(){this._socket.close()}}},2406:(e,t,r)=>{"use strict";var a=r(66390);Object.defineProperty(t,"__esModule",{value:!0}),t.NoiseHandshake=void 0;var i=r(49244),n=a(r(46291)),s=r(12872),o=r(9211),l=r(14409),d=Promise.reject("UNINITIALIZED HANDSHAKE"),u=new Uint8Array(0);d.catch((()=>{}));function c(e){var t=new ArrayBuffer(12);return new DataView(t).setUint32(8,e),new Uint8Array(t)}function p(e,t=["encrypt","decrypt"]){return self.crypto.subtle.importKey("raw",new Uint8Array(e),"AES-GCM",!1,t)}function h(e,t){return n.extract(new Uint8Array(e),t).then((e=>n.expand(new Uint8Array(e),"",64))).then((e=>[e.slice(0,32),e.slice(32)]))}function f(e){e.catch((()=>{}))}t.NoiseHandshake=class{constructor(e){this._hash=d,this._salt=d,this._cryptoKey=d,this._counter=0,this._socket=e,this._rejectOnClose=new l.Resolvable,e.onClose=()=>{this._rejectOnClose.reject(new s.Disconnected("NoiseHandshake: SocketClosed"))},f(this._rejectOnClose.promise)}start(e,t){var r=i.Binary.build(e).readBuffer(),a=32===r.byteLength?Promise.resolve(r):self.crypto.subtle.digest("SHA-256",r);this._hash=a,this._salt=a,this._cryptoKey=a.then(p),this.authenticate(t)}sendAndReceive(e){var t=this._socket,r=new Promise((r=>{t.onFrame=e=>{t.onFrame=null,r(e)},t.sendFrame(e)}));return this._orRejectOnClose(r)}send(e){this._socket.sendFrame(e)}authenticate(e){this._hash=Promise.all([this._hash,e]).then((([e,t])=>{var r=i.Binary.build(e,t).readByteArray();return self.crypto.subtle.digest("SHA-256",r)}))}encrypt(e){var t=this._counter++,r=Promise.all([this._cryptoKey,this._hash,e]).then((([e,r,a])=>function(e,t,r,a){return self.crypto.subtle.encrypt({name:"AES-GCM",iv:c(t),additionalData:r?new Uint8Array(r):u},e,a)}(e,t,r,a)));return this.authenticate(r),this._orRejectOnClose(r)}decrypt(e){var t=this._counter++,r=Promise.all([this._cryptoKey,this._hash]).then((([r,a])=>function(e,t,r,a){return self.crypto.subtle.decrypt({name:"AES-GCM",iv:c(t),additionalData:r?new Uint8Array(r):u},e,a)}(r,t,a,e)));return this.authenticate(e),this._orRejectOnClose(r)}finish(){var e=this._salt.then((e=>h(e,new Uint8Array(0)))).then((([e,t])=>Promise.all([p(e,["encrypt"]),p(t,["decrypt"])]))).then((([e,t])=>new o.NoiseSocket(this._socket,e,t)));return this._orRejectOnClose(e)}mixIntoKey(e){this._counter=0;var t=Promise.all([this._salt,e]).then((([e,t])=>h(e,new Uint8Array(t))));this._salt=t.then((e=>e[0])),this._cryptoKey=t.then((e=>p(e[1]))),f(this._salt),f(this._cryptoKey)}_orRejectOnClose(e){return Promise.race([e,this._rejectOnClose.promise]).then((e=>this._rejectOnClose.resolveWasCalled()?this._rejectOnClose.promise:e))}}},9211:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NoiseSocket=void 0;var a=r(19129),i=Promise.reject("UNINITIALIZED HANDSHAKE"),n=new Uint8Array(0);i.catch((()=>{}));function s(e){var t=new ArrayBuffer(12);return new DataView(t).setUint32(8,e),new Uint8Array(t)}t.NoiseSocket=class{constructor(e,t,r){this._incoming=[],this._readQueue=new a.PromiseQueue,this._sendQueue=new a.PromiseQueue,this._readCounter=0,this._writeCounter=0,this._draining=!1,this._sendCiphertextFrame=e=>{this._socket.closed?__LOG__(2)`NoiseSocket socket closed while encrypting frame`:this._socket.sendFrame(e)},this._handleCiphertext=e=>{var t=this._readCounter++;this._readQueue.enqueueHandlers(function(e,t,r,a){return self.crypto.subtle.decrypt({name:"AES-GCM",iv:s(t),additionalData:r?new Uint8Array(r):n},e,a)}(this._readKey,t,void 0,e),this._handlePlaintext)},this._handleOnClose=()=>{this._draining=!0,this._readQueue.wait().then((()=>{this._draining=!1;var e=this._onClose;e&&e()}))},this._handlePlaintext=e=>{this._onFrame?this._onFrame(e):this._incoming.push(e)},this._socket=e,this._writeKey=t,this._readKey=r,e.onFrame=this._handleCiphertext,this._socket.onClose=this._handleOnClose,e.convertBufferedToFrames()}sendFrame(e){if(!this._draining){this._socket.throwIfClosed();var t,r,a,i,o=this._writeCounter++;this._sendQueue.enqueueHandlers((t=this._writeKey,r=o,a=void 0,i=e,self.crypto.subtle.encrypt({name:"AES-GCM",iv:s(r),additionalData:a?new Uint8Array(a):n},t,i)),this._sendCiphertextFrame)}}setOnFrame(e){this._onFrame=e}setOnClose(e){this._onClose=e}close(){this._socket.close()}}},92582:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.abPropsParser=void 0;var a=new(r(82420).WapParser)("abProps",(e=>{e.assertTag("iq"),e.assertAttr("from","s.whatsapp.net");var t=e.child("props"),r=t.attrInt("protocol");if(1!==r)throw new Error(`Unsupported protocol version ${r}`);var a=[];return t.forEachChildWithTag("prop",(e=>{var t=e.attrInt("config_code"),r=e.attrString("config_value"),i=e.maybeAttrString("config_expo_key");a.push({configCode:t,configValue:r,configExpoKey:i})})),{abKey:t.maybeAttrString("ab_key"),hash:t.maybeAttrString("hash"),refresh:t.maybeAttrInt("refresh"),props:a}}));t.abPropsParser=a},12251:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mediaConnParser=void 0;var a=r(82420),i=r(21839),n=new a.WapParser("mediaConnParser",(e=>{var t=e.child("media_conn");return{hosts:t.mapChildrenWithTag("host",(e=>{var t=e.maybeChild("download_buckets"),r=t?t.mapChildren((e=>parseInt(e.tag(),10))):[];return{domain:e.attrString("hostname"),uploadable:s(e,"upload"),downloadable:s(e,"download"),isFallback:"fallback"===e.maybeAttrString("type"),downloadBuckets:r,class:e.maybeAttrString("class"),ip4:e.hasAttr("ip4")?e.attrString("ip4"):void 0,ip6:e.hasAttr("ip6")?e.attrString("ip6"):void 0}})),authToken:t.attrString("auth"),authTTL:t.hasAttr("auth_ttl")?t.attrFutureTime("auth_ttl"):null,authExpires:t.attrFutureTime("ttl"),maxBuckets:t.hasAttr("max_buckets")?t.attrInt("max_buckets"):null}}));function s(e,t){return e.hasChild(t)?e.child(t).mapChildren((e=>{var t=e.tag();return(0,i.castToServerMediaType)(t)})).filter(Boolean):i.SERVER_MEDIA}t.mediaConnParser=n},44922:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DynamicRouter=t.NOT_HANDLED=void 0;var r={sentinel:"RESPONSE_NAMESPACE"},a={sentinel:"NOT_HANDLED"};t.NOT_HANDLED=a;function i(e,t){var a=t.namespace;return a===r?n:e.get(a)}function n(e,t,r){r(t)}t.DynamicRouter=class{constructor(){this._basePromise=Promise.resolve(),this._handlers=new Map,this._handlerChangeCount=0,this._firstRoute=null,this._nextRoute=null,this._lastRoute=null,this._run=()=>{var e=this._nextRoute;if(e){for(var t,r=this._handlers;e&&!(t=i(r,e));)this._nextRoute=e=e.nextRoute;if(e&&t){var n=this._runHandler(t,e),s=!0;if(n!==a){var o=e.prevRoute,l=e.nextRoute;this._nextRoute===e&&(this._nextRoute=l),o?o.nextRoute=l:this._firstRoute=l,l?l.prevRoute=o:(s=!1,this._lastRoute=o)}return s&&this._basePromise.then(this._run),n}}}}hasHandlerForNamespace(e){return this._handlers.has(e)}getHandledNamespaces(){return Array.from(this._handlers.keys())}setNamespaceHandler(e,t){var r=this._handlers,a=r.get(e);if(a!==t&&(++this._handlerChangeCount,r.set(e,t),!a)){var i=this._firstRoute;i&&(this._nextRoute||this._basePromise.then(this._run),this._nextRoute=i)}}setHandlers(e,t){this.setNamespaceHandler(e,(function(e,r,a){var i=t[e](r);a&&a(i)}))}fireAndForget(e,t,r){this._schedule(e,t,r,null)}sendAndReceive(e,t,a){return new Promise(((i,n)=>{this._schedule(e,t,a,(e=>{try{var t=function(e){if(null!=e&&("object"==typeof e||"function"==typeof e)){var t=e.then;return"function"==typeof t?t:null}return null}(e);t?t.call(e,(e=>{this._schedule(r,"",e,i)}),(e=>{this._schedule(r,"",e,n)})):this._schedule(r,"",e,i)}catch(e){this._schedule(r,"",e,n)}}))}))}_schedule(e,t,r,a){var n=this._lastRoute,s={namespace:e,route:t,arg:r,resolver:a,prevRoute:n,nextRoute:null};this._lastRoute=s;var o=!0;n?(n.nextRoute=s,o=!this._nextRoute):this._firstRoute=s,o&&i(this._handlers,s)&&(this._nextRoute=s,this._basePromise.then(this._run))}_runHandler(e,t){var{route:r,arg:i,resolver:n}=t,s=this._handlerChangeCount,o=null,l=null;try{o=e(r,i,n)}catch(e){l=Promise.reject(e)}if(o===a){if(s!==this._handlerChangeCount)return a;l=Promise.reject(new Error("DynamicRouter: NOT_HANDLED can only be used when updating handlers"))}if(!n)return l;l&&n(l)}}},46291:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.hmacSha256=function(e,t){return s(e).then((e=>o(e,t)))},t.extract=l,t.expand=d,t.extractAndExpand=function(e,t,r){return l(null,e).then((e=>d(new Uint8Array(e),t,r)))},t.extractWithSaltAndExpand=function(e,t,r,a){return l(t,e).then((e=>d(new Uint8Array(e),r,a)))};var a=r(49244),i=new Uint8Array(32),n={name:"HMAC",hash:"SHA-256"};function s(e){return self.crypto.subtle.importKey("raw",e,n,!1,["sign"])}function o(e,t){return self.crypto.subtle.sign(n,e,t)}function l(e,t){return s(e||i).then((e=>o(e,t)))}function d(e,t,r){if(r<0||r>8160)return Promise.reject(new Error(`HKDF::expand given bad length ${r}`));for(var i,n=Math.ceil(r/32),l=a.Binary.build(t).readByteArray(),d=new a.Binary,u=s(e).then((e=>(i=e,new Uint8Array(0)))),c=function(e){u=u.then((t=>o(i,a.Binary.build(t,l,e).readByteArray()))).then((e=>{var t=new Uint8Array(e);return d.writeByteArray(t),t}))},p=1;p<=n;p++)c(p);return u.then((()=>d.readBuffer(r)))}},26540:(e,t)=>{"use strict";function r(e,t){if(e.length!==t.length)return!1;for(var r=1,a=e.length,i=0;i<a;i++)r&=e[i]===t[i]?1:0;return 0!==r}Object.defineProperty(t,"__esModule",{value:!0}),t.areBuffersEqual=function(e,t){return r(new Uint8Array(e),new Uint8Array(t))},t.areBytesEqual=r,t.bytesMod=function(e,t){if(t>8388607)throw new Error("Divisor is too big");for(var r=0,a=0;a<e.length;++a)r=((r<<8)+e[a])%t;return r},t.randomNumberLessThan=function(e){if(e!==(0|e))throw new Error("bound must be int32");if(e<=0)throw new Error("bound must not be positive");var t=new Int32Array(1),r=e*Math.floor((-1>>>1)/e),a=-1;for(;-1===a;){self.crypto.getRandomValues(t);var i=t[0]>>>1;i<r&&(a=i%e)}return a}},75987:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.definePersistedJob=function(e){return new n(e,[])},t.JobBuilder=void 0;var a=r(95334),i=r(22014);class n{constructor(e,t){this.type=e,this.steps=t}step(e,t){return this._stepWithOptions(e,"function"==typeof t?{code:t}:t)}_stepWithOptions(e,t){var{stopRetryIf:r,requirements:l,code:d}=t,u=o(l,d);if(r){var{timePassedSeconds:c,appCrashed:p,onStopRetry:h}=r,f=o(null,function(e){return(t,r,a)=>Promise.resolve(e(t,r,a)).then((e=>e instanceof i.InterruptJob?e:new i.InterruptJob(e)))}(h));null!=c&&(u=s(((e,t,{jobStartTime:r})=>(0,a.happenedWithin)(r,c)),u,f)),p&&(u=s(((e,t,{afterCrash:r})=>!r),u,f))}return new n(this.type,[...this.steps,{stepName:e,info:u}])}finalStep(e,t){var r=this.step(e,t),a={name:r.type,steps:r.steps};return{end:()=>a}}}function s(e,t,r){return(a,i,n)=>e(a,i,n)?t(a,i,n):r(a,i,n)}function o(e,t){var r={requirements:e,code:t};return()=>r}t.JobBuilder=n},45264:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.joinRequirements=function(e,t){var r=e.filter((e=>!e.isSatisfiable()));if(r.length>0){var a=r.map((e=>e.name));return e=>(null==t||t("unsatisfiable",a,e),r[0].waitUntilSatisfied())}var i=e.map((()=>Promise.resolve())),n=Promise.resolve(),s=null,o=()=>{if(!i.every(((t,r)=>t===e[r].waitUntilSatisfied()))){var t=[],r=e.map((e=>{var r=e.waitUntilSatisfied();return e.isSatisfied()||(t.push(e.name),r.then((()=>{var r=t.indexOf(e.name);t.splice(r,1)}))),r}));return i=r,s=t,Promise.all(r).then(o)}s=null};return e=>{if(null==s){var r=o();null!=r&&(n=n.then((()=>r)))}return null==t||t(null==s?"satisfied":"unsatisfied",s,e),n}},t.UnsatisfiableJobRequirement=t.JobRequirement=void 0;class r{constructor(e){this._waitingOn=Promise.resolve(),this._satisfied=!0,this._newBlockers=null,this._blockersFinished=()=>{var e=this._newBlockers;if(null!=e)return this._newBlockers=null,Promise.all(e).then(this._blockersFinished);this._satisfied=!0},this.name=e}addBlocker(e){var t=e.catch((e=>{__LOG__(4,void 0,new Error,!0)`JobRequirement[${this.name}] blocker errored ${e}`,SEND_LOGS("job-blocker-rejected")}));if(this._satisfied)this._satisfied=!1,this._waitingOn=Promise.all([this._waitingOn,t]).then(this._blockersFinished);else{var r=this._newBlockers;null!=r?r.push(t):this._newBlockers=[t]}}waitUntilSatisfied(){return this._waitingOn}isSatisfied(){return this._satisfied}isSatisfiable(){return!0}}t.JobRequirement=r;t.UnsatisfiableJobRequirement=class extends r{constructor(e){super(e),super.addBlocker(new Promise((()=>{})))}addBlocker(){}isSatisfiable(){return!1}}},22014:(e,t,r)=>{"use strict";var a=r(34398);Object.defineProperty(t,"__esModule",{value:!0}),t.startPersistedJobManager=function(e){if(f)return;var t=_?_(e):e,{isRestartAfterCrash:r,accessors:a}=t,i=new Map,n=t.unfinishedJobEntries.then((e=>{var t=[],n=[];return e.forEach((e=>{e.stepHardStartCountAfterTimeout>=5?t.push(e):n.push(e)})),Promise.all(t.map((e=>(__LOG__(4,void 0,new Error,!0)`${g(e)}: stuck on the step ${e.step}, aborting the job`,SEND_LOGS(`job-stuck-${e.type}`),a.deletePersistedJob(e.jobId))))).then((()=>{n.forEach((e=>{i.has(e.jobId)||(__LOG__(2)`${g(e)}: restarting`,i.set(e.jobId,y(e,r)))}))}))}));f={implementationLoaders:h||new Map,implementations:new Map,stepBlockers:new WeakMap,accessors:a,activeJobs:i,initialJobsPromise:n,onJobStarted:t.onJobStarted,onJobFinished:t.onJobFinished,deprecatedJobs:t.deprecatedJobs},h=null},t.addPersistedJobImplementation=function(e,t){var r,a;f?(r=f.implementationLoaders,a=f.deprecatedJobs):r=h||(h=new Map);if(r.has(e))return __LOG__(4,void 0,new Error,!0)`addPersistedJobImplementation called twice for ${e}`,void SEND_LOGS("repeat-job-loader");a&&a.includes(e);r.set(e,t)},t.loadAndRunJobFromId=function(e){var{activeJobs:t}=b("loadAndRunJobFromId"),r=t.get(e);if(null!=r)return r;var a=function(){return E.apply(this,arguments)}(e);return t.set(e,a),a},t.internalTestingResetSingleton=function(e){f&&(h=f.implementationLoaders);f=null,_=e},t.jestResetJob=function(e){b("jestResetJob").activeJobs.delete(e)},t.FINISHED_JOB=t.UNSTARTED_JOB=t.InterruptJob=t.RetryOnBackoff=t.RequiresPage=void 0;var i=a(r(85374)),n=r(95334),s=r(56150),o=r(45264);class l{constructor(e){this.feature=e}toString(){return`RequiresPage: ${this.feature}`}}t.RequiresPage=l;class d{constructor(e){this.backoffOptions=e}toString(){return"RetryOnBackoff"}}t.RetryOnBackoff=d;class u{constructor(e){this.result=e}}t.InterruptJob=u;var c="$unstarted";t.UNSTARTED_JOB=c;var p="$finished";t.FINISHED_JOB=p;var h,f=null,_=null;function m(e){return new u(e)}function g(e){return`Job[${e.jobId}] (${e.type})`}function v(e){return`Job[${e.jobId}] (${e.implementation.name}.${e.currentStepName})`}function E(){return(E=(0,i.default)((function*(e){var t=b("_loadAndRunJobFromId");yield t.initialJobsPromise;var{readPersistedJob:r}=t.accessors,a=yield r(e);return a?y(a,!1):(__LOG__(4,void 0,new Error,!0)`No entry for job ${e}`,SEND_LOGS("missing-job-entry"),null)}))).apply(this,arguments)}function y(){return S.apply(this,arguments)}function S(){return(S=(0,i.default)((function*(e,t){var r,{accessors:a,activeJobs:o,deprecatedJobs:u,onJobFinished:h,onJobStarted:f}=b("runJob"),_=yield A(e.type);if(!_)return u.includes(e.type)?__LOG__(3)`No implementation for deprecated ${e.type}, job deleted`:(__LOG__(4,void 0,new Error,!0)`No implementation for ${e.type}. Maybe it should have been put to the deprecated list?`,SEND_LOGS("missing-job-implementation")),yield a.deletePersistedJob(e.jobId),null;u.includes(e.type);var E=e.step!==c?_.steps.find((t=>t.stepName===e.step)):_.steps[0];if(!E)return __LOG__(4,void 0,new Error,!0)`No implementation for ${e.type}.${e.step}`,SEND_LOGS("missing-job-step"),yield a.deletePersistedJob(e.jobId),null;var y={jobStartTime:e.startTime,afterCrash:t,interruptJob:m},S={jobId:e.jobId,uniqKey:e.uniqKey,implementation:_,currentStepName:E.stepName,originalArgs:e.original,currentStepArgs:e.current,jobInfo:y,numberOfAttemptsAfterTimeout:e.stepHardStartCountAfterTimeout,stepFirstStartTime:null!==(r=e.stepFirstStartTime)&&void 0!==r?r:(0,n.unixTime)(),backedOffCount:e.backedOffCount||0,waitUntil:e.waitUntil,version:e.version};if(S.currentStepName===p){var P=S.waitUntil,O=(0,n.secondsUntil)(S.stepFirstStartTime);return null!=P&&(0,n.isInFuture)(P)&&O>0&&(__LOG__(2)`${g(e)}: skew detected, adjusting accordingly`,P=(0,n.castToUnixTime)(P-O),(0,n.isInFuture)(P)&&(S.stepFirstStartTime=(0,n.castToUnixTime)(S.stepFirstStartTime-O),S.waitUntil=P,yield C(S))),null!=P&&(0,n.isInFuture)(P)||(__LOG__(2)`${g(e)}: removing completed, expired job from db`,yield a.deletePersistedJob(e.jobId),o.delete(e.jobId)),S.currentStepArgs}var w=()=>{var e=S.waitUntil,t=Promise.resolve();if(null!=e){var r=(0,n.futureUnixTime)(n.DAY_SECONDS);e>r?(__LOG__(2)`${v(S)}: trim wait from ${e} to ${r}`,S.waitUntil=r,t=C(S).then((()=>(0,n.delayUntil)(r)))):(__LOG__(2)`${v(S)}: delaying until ${e}`,t=(0,n.delayUntil)(e))}return t.then((()=>T(S,(()=>(S.waitUntil=null,(0,n.happenedWithin)(S.stepFirstStartTime,n.DAY_SECONDS)||S.numberOfAttemptsAfterTimeout++,C(S)))).catch((e=>{if(e instanceof l)return __LOG__(2)`${v(S)}: requires page`,S.numberOfAttemptsAfterTimeout>0&&(--S.numberOfAttemptsAfterTimeout,C(S)),new Promise((()=>{}));if(e instanceof d){__LOG__(2)`${v(S)}: RetryOnBackoff`;var t=(0,s.getDelay)(++S.backedOffCount,e.backoffOptions);return S.waitUntil=(0,n.futureUnixTime)(Math.ceil(t/1e3)),S.numberOfAttemptsAfterTimeout>0&&--S.numberOfAttemptsAfterTimeout,C(S).then(w)}throw e}))))},M=w(),I=M.then(function(){var t=(0,i.default)((function*(t){__LOG__(2)`${v(S)}: finished job`;var r=null;try{r=h(S.jobId,S.implementation.name,S.originalArgs,t)}catch(t){__LOG__(4,void 0,new Error,!0)`onJobFinished for ${e.type} threw exception ${t}`,SEND_LOGS("onJobFinished-threw")}null!=r&&r>0?(S.waitUntil=(0,n.futureUnixTime)(Math.ceil(r/1e3)),S.currentStepName=p,S.currentStepArgs=t,S.stepFirstStartTime=(0,n.unixTime)(),yield C(S)):(yield a.deletePersistedJob(e.jobId),o.delete(e.jobId))}));return function(){return t.apply(this,arguments)}}(),function(){var t=(0,i.default)((function*(t){__LOG__(4,void 0,new Error,!0)`${e.type} failed with error ${t}`,SEND_LOGS(`job-threw-exception-${e.type}`),yield a.deletePersistedJob(e.jobId),o.delete(e.jobId)}));return function(){return t.apply(this,arguments)}}());try{f(e.jobId,e.type,e.original)}catch(t){__LOG__(4,void 0,new Error,!0)`onJobStarted for ${e.type} threw exception ${t}`,SEND_LOGS("onJobStarted-threw")}return I.then((()=>M))}))).apply(this,arguments)}function T(e,t){var{currentStepName:r,implementation:{steps:a}}=e,i=a.findIndex((e=>e.stepName===r)),{requirements:s,code:l}=a[i].info(e.currentStepArgs,e.originalArgs,e.jobInfo),d=function(e,t){if(null==t||0===t.length)return Promise.resolve();var{stepBlockers:r}=b("waitForBlockers"),a=r.get(t);null==a&&(a=(0,o.joinRequirements)(t.map((e=>e())),P),r.set(t,a));return a(e)}(e,s);return t&&(d=d.then(t)),d.then((()=>(__LOG__(2)`${v(e)}: running step`,l(e.currentStepArgs,e.originalArgs,e.jobInfo)))).then((t=>{if(t instanceof u)return __LOG__(2)`${v(e)}: InterruptJob`,t.result;var r=i+1;if(r>=a.length)return t;var s=a[r];return e.currentStepName=s.stepName,e.currentStepArgs=t,e.numberOfAttemptsAfterTimeout=0,e.stepFirstStartTime=(0,n.unixTime)(),e.waitUntil=null,e.backedOffCount=0,C(e).then((()=>T(e)))}))}function A(e){var t=b("getJobImplementation"),{implementations:r,implementationLoaders:a}=t,i=r.get(e);if(i)return i;var n=a.get(e);if(!n)return null;var s=n().then((t=>t.name!==e?(__LOG__(4,void 0,new Error,!0)`addPersistedJobImplementation called for ${e} with object for ${t.name}`,SEND_LOGS("different-job-loader"),null):t));return r.set(e,s),s}function b(e){if(f)return f;throw new Error(`Jobs::${e} called before startManagingJobs`)}function C(e){return b("updateEntryForJob").accessors.updatePersistedJob({jobId:e.jobId,type:e.implementation.name,uniqKey:e.uniqKey,step:e.currentStepName,original:e.originalArgs,current:e.currentStepArgs,startTime:e.jobInfo.jobStartTime,stepHardStartCountAfterTimeout:e.numberOfAttemptsAfterTimeout,stepFirstStartTime:e.stepFirstStartTime,waitUntil:e.waitUntil,backedOffCount:e.backedOffCount,version:e.version,endTime:e.currentStepName===p?e.stepFirstStartTime:void 0})}function P(e,t,r){"unsatisfiable"===e?__LOG__(2)`${v(r)} halting because of ${t}`:"unsatisfied"===e&&__LOG__(2)`${v(r)} waiting on ${t}`}},19129:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PromiseQueueMap=t.PromiseQueue=void 0;t.PromiseQueue=class{constructor(e=-1){this._promise=Promise.resolve(),this._maxDelay=e}wait(){return this._promise}enqueueHandlers(e,t,a){var i=this._promise.then((()=>e)).then(t,a),n=i.then();return this._promise=r(i,this._maxDelay),n}enqueue(e){var t=this._promise.then(e),a=t.then();return this._promise=r(t,this._maxDelay),a}};function r(e,t){return t>=0?new Promise((r=>{var a=()=>{r()};e.then(a,a),setTimeout(a,t)})):e.then(a,a)}function a(){}t.PromiseQueueMap=class{constructor(e=-1){this._map=new Map,this._maxDelay=e}waitIfPending(e){return this._map.get(e)}wait(e){return this._map.get(e)||Promise.resolve()}enqueueHandlers(e,t,r,a){var i=this.wait(e).then((()=>t)).then(r,a);return this._addToMap(e,i)}enqueue(e,t){var r=this.wait(e).then(t);return this._addToMap(e,r)}_addToMap(e,t){var a,i=t.then(),n=()=>{this._map.get(e)===a&&this._map.delete(e)};return a=r(t,this._maxDelay).then(n,n),this._map.set(e,a),i}}},68053:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PromiseRetryLoop=void 0;var a=r(14409),i=r(56150),n=r(60266);t.PromiseRetryLoop=class{constructor(e){this._resolvable=new a.Resolvable,this._promise=null,this._resetTime=null,this.endWithValue=e=>{this._currentLoop.resolve(),this._resolvable.resolve(e)},this._options=e}resetTimeoutAfter(e){this._resetTime=Date.now()+e}cancelReset(){this._resetTime=null}reset(){this._resolvable.resolveWasCalled()||(__LOG__(2)`PromiseRetryLoop: resetting ${this._options.name}`,this._currentLoop.resolve(),this._currentLoop=new a.Resolvable,this._runLoop())}start(){this._resolvable.resolveWasCalled()||(__LOG__(2)`PromiseRetryLoop: starting ${this._options.name}`,null!=this._currentLoop&&__LOG__(4,void 0,new Error)`PromiseRetryLoop was called several times. You may have race conditions`,this._currentLoop=new a.Resolvable,this._runLoop())}_runLoop(){var e=this._options,t=this._currentLoop,r=(0,i.createTimer)(this._options.timer);r();var a=()=>{if(!this._resolvable.resolveWasCalled()&&!t.resolveWasCalled()){var s=Date.now();this._promise=(0,e.code)(this.endWithValue).then((()=>{if(!this._resolvable.resolveWasCalled()){var{resetDelay:t}=e;(void 0!==t&&Date.now()>=s+t||null!=this._resetTime&&this._resetTime<=Date.now())&&(__LOG__(2)`PromiseRetryLoop: resetting ${e.name}`,r=(0,i.createTimer)(this._options.timer)),this._resetTime=null;var o=r();return __LOG__(2)`PromiseRetryLoop: retrying ${e.name} in ${o}ms`,(0,n.delayMs)(o).then(a)}}))}};this._promise=Promise.resolve().then(a)}promise(){return this._promise?Promise.race([this._resolvable.promise,this._promise.then((()=>this._resolvable.promise))]):Promise.reject(new Error(`PromiseRetryLoop ${this._options.name} had promise() called before start()`))}}},14409:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Resolvable=void 0;t.Resolvable=class{constructor(){var e;this._isResolved=!1,this.promise=new Promise((t=>{e=t})),this._resolve=e}resolve(e){this._isResolved=!0,this._resolve(e)}reject(e){this.resolve(Promise.reject(e))}resolveWasCalled(){return this._isResolved}}},97733:(e,t)=>{"use strict";t.Z=v,self.$RefreshReg$=()=>{},self.$RefreshSig$=()=>()=>{};var r,a="undefined"!=typeof Promise?Promise:null,i=0,n=[],s=[],o=[],l={sentinel:"CONTINUE_AS_IF_NO_HANDLER"},d={sentinel:"RETRY_ASYNCHRONOUSLY"},u={sentinel:"TO_STRING"},c={sentinel:"DID_ERROR"},p=null,h=[],f=16,_=64,m=128,g=512;function v(e,t){this._flags=0,this._value=void 0,this._onFulfilled=void 0,this._onRejected=void 0,this._context=void 0,this._resolveLevel=0,this._control=void 0,this.x=void 0,this._thenableParent=null,this._parent=void 0,this._child=void 0,this._children=void 0,this.control=void 0,t&&(this._context=t.this),"function"==typeof e&&(this._onFulfilled=e,this._flags|=4,this._flags|=256,V(e,this._context,(e=>G(this,0,!0,!1,e)),(e=>G(this,0,!1,!1,e))))}function E(e){if(void 0===e)return r;if(k(e))return e;var t=new v;return G(t,0,!0,!1,e),z(t,g),t}function y(e){var t=new v;return t._value=e,z(t,514),h.push(t),t}function S(e){var t=arguments.length-1;if(0===t)return this.then(void 0,e);for(var r=new Array(t),a=0;a<t;a++)r[a]=B(arguments[a]);var i=Y(r,arguments[t]),n=U(this,void 0,i);return n._onRejected&&z(n,m),n}function T(e,t){this.errors=e||[],this.message=t||`${this.errors.length} errors`}function A(e){var t="";if(e._flags&m)t=(e._onFulfilled||e._onRejected).call(e._context,u);else if(e._control)t=`.addRawControl(${e._control.name}, ${e._control.foo})`;else if(e._flags&f)t=`.endWithControls(${Object.keys(e.control)})`;else if(e._flags&g)t=1&e._flags?`Promise.resolve(${void 0===e._value?"":e._value})`:`Promise.reject(${void 0===e._value?"":e._value})`;else if(256&e._flags)switch(3&e._flags){case 2:case 0:case 1:t=`new Promise(${e._onFulfilled})`}else e._onFulfilled&&e._onRejected?t=`.then(${e._onFulfilled}, ${e._onRejected})`:e._onFulfilled?t=`.then(${e._onFulfilled})`:e._onRejected&&(t=`.catch(${e._onRejected})`);return t}function b(e){this.message=e||"StackPromise timed out"}function C(e,t,r,a){this.name=e,this.foo=t,this.lightning=!!r,this.canRunMultipleTimes=!!a}function P(e,t){return function(){for(var r,a,i=e._parent;i&&!(3&i._flags)&&!(i._flags&f);i=i._parent)!i._control||i._control.name!==t||4&i._flags||(r=i);if(!r)return v.NO_ACTIVE_CONTROL;if(r._control.canRunMultipleTimes||z(r,4),arguments.length>0){a=new Array(arguments.length);for(var n=0;n<arguments.length;n++)a[n]=arguments[n]}return r._control.foo.call(r._context,(e=>F(r,r._resolveLevel,!0,!1,e)),(e=>F(r,r._resolveLevel,!1,!1,e)),r._parent,a)}}function O(e){this.message=e,this.stack=new Error(e||this.name).stack}v.resolve=E,v.reject=y,v.prototype.then=function(e,t){"function"!=typeof e&&(e=void 0),"function"!=typeof t&&(t=void 0);var r=new v;r._onFulfilled=e,r._onRejected=t,r._context=this._context,this._flags&_&&z(r,_);var a=3&this._flags;return 0===a?D(this,r):(z(this,8),(1===a?e:t)?(r._parent=this,s.push(r),I()):(r._parent=this,z(r,a),r._value=this._value,2===a&&h.push(r))),r},v.prototype.catch=S,v.prototype.catchType=S,v.prototype.catchTypes=S,v.prototype.catchTypes3=S,v.prototype.catchEqualTo=S,v.prototype.catchConditional=S,v.prototype.end=function(e){var t=this.then();if(z(t,f),t.control={},t._context=void 0,e){var r=e.controls;if(r)for(var a=0;a<r.length;a++){var i=r[a];t.control[i]=P(t,i)}return t}},v.prototype.endWithControls=function(){var e=this.then();z(e,f),e.control={},e._context=void 0;for(var t=0;t<arguments.length;t++){var r=arguments[t];e.control[r]=P(e,r)}return e},v.all=function(e){return new v((function(t,r){var a=e.length;if(0!==a)for(var i=new Array(e.length),n=0;n<e.length;n++)i[n]=U(e[n],s,r);else t([]);function s(e){if(0==--a){for(var r=[],n=0;n<i.length;n++){var s=i[n];r.push(s&&3&s._flags?s._value:e)}t(r)}return e}}))},v.allSettled=function(e){return new v((function(t){var r=Array.from(e),a=r.length;if(0!==a)for(var i=new Array(r.length),n=l(!1),s=l(!0),o=0;o<r.length;o++)i[o]=U(r[o],n,s);else t([]);function l(e){return function(r){var n=e?{status:"rejected",reason:r}:{status:"fulfilled",value:r};if(0==--a){for(var s=[],o=0;o<i.length;o++){var l=i[o];s.push(l&&3&l._flags?l._value:n)}t(s)}return n}}}))},v.any=function(e){return new v((function(t,r){var a=e.length;0===a&&r(new T([],"StackPromise.any called with []"));var i=new Array(e.length);function n(e){if(0==--a){for(var t=[],n=0;n<i.length;n++){var s=i[n];t.push(s&&3&s._flags?s._value:e)}r(new T(t))}return e}for(var s=0;s<e.length;s++)i[s]=U(e[s],t,n)}))},v.reduce=function(e,t,r){return E(e).reduce(t,r)},v.prototype.reduce=function(e,t){return t=L(t),U(this,(function(r,a){if(0===r.length)return t;if(a)return d;for(var i=new Array(r.length),n=0;n<r.length;n++){var s=i[n]=L(r[n]);k(s)&&z(s,8)}var o=this,l=0;return function r(){for(var a=i.length;;){var n=l,s=i[n];if(k(s))switch(3&s._flags){case 2:return s;case 0:return s.then(r);case 1:s=s._value}if(k(t))switch(3&t._flags){case 2:return t;case 0:return t.then(r);case 1:t=t._value}var d=e.call(o,t,s,n,a);if(++l===a)return d;if(k(d=L(d)))switch(3&d._flags){case 2:return d;case 0:return t=d,d.then(r);case 1:z(d,8),t=d._value}else t=d}}()}))},v.race=function(e){var t=L(e);if(k(t)){var r=t.then((e=>v.race(e)));return r._context=void 0,r._flags&=-65,r}return new v((function(e,r){for(var a=0;a<t.length;a++){var i=L(t[a]);if(!k(i)||3&i._flags)for(e(i),a++;a<t.length;a++){var n=t[a];k(n)&&z(n,8)}else i.then(e,r)}}))},T.prototype=Object.create(Error.prototype,{name:{value:"AggregateError"}}),v.AggregateError=T,v.onPossiblyUnhandledRejection=function(e,t){console.error(`StackPromise did not catch ${e}`,t,e)},v.prototype.toString=function(){for(var e,t=[],r=this,a=!1;r;r=r._parent){e=r,!a&&3&r._flags&&(a=!0,r._flags&g||(1&r._flags?t.push(`[resolved value: ${r._value}]`):t.push(`[rejected reason: ${r._value}]`)));var i=A(r);1024&r._flags&&(i=`~${i}`),t.push(i)}return t.reverse(),768&e._flags||(t[0]=`[Promise]${t[0]}`),t.join("\n")},v.prototype.timeout=function(e,t){if(0!=(3&this._flags))return this.then();var r;function a(a){return a===u?`.timeout(${e}, ${t})`:(clearTimeout(r),l)}var i=this.then(a,a);return z(i,160),r=setTimeout((function(e,t){3&e._flags||F(e,0,!1,!1,t instanceof Error?t:new b(t))}),e,i,t),i},b.prototype=Object.create(Error.prototype,{name:{value:"TimeoutError"}}),v.TimeoutError=b,v.prototype.isFulfilled=function(){return!!(1&this._flags)},v.prototype.isRejected=function(){return!!(2&this._flags)},v.prototype.isPending=function(){return!(3&this._flags)},v.prototype.value=function(){if(1&this._flags)return this._value;throw new Error(2&this._flags?"value() called on StackPromise that was rejected":"value() called on StackPromise that is pending")},v.prototype.reason=function(){if(2&this._flags)return this._value;throw new Error(1&this._flags?"reason() called on StackPromise that was fulfilled, not rejected":"reason() called on StackPromise that is pending")},v.prototype.checkpoint=function(e){function t(t){return t===u?`.checkpoint(${e})`:2&e._flags?e:l}e=E(e);var r=this.then(t,t);return z(r,m),r},v.prototype.finally=function(e){function t(t){return t===u?`.finally(${e})`:(e.call(this,t),l)}return z(this.then(t,t),m)},v.prototype.tap=function(e){return z("function"!=typeof e?this.then(R):this.then((function(t){return t===u?`.tap(${e})`:(e.call(this,t),l)})),m)},v.prototype.spread=function(e){var t=this.then((function(t){return t===u?`.spread(${e})`:e.apply(this,t)}));return z(t,m),t},v.prototype.throw=function(e){return this.then((()=>y(e)))},v.Control=C,v.NO_ACTIVE_CONTROL=new Error("No active control was found."),v.prototype.addControl=function(e){if(!(e instanceof C))throw new Error(`addControl must be given Control, but got ${e}`);var t=this.then(e.lightning?void 0:R);return t._control=e,t},v.prototype.addRawControl=function(e,t,r,a){return this.addControl(new C(e,t,r,a))},v.prototype.addResolveControl=function(e,t,r,a){return this.addControl(new C(e,(function(e,r,a,i){try{e(t.apply(this,i))}catch(e){r(e)}}),r,a))},v.prototype.addRejectControl=function(e,t,r,a){return this.addControl(new C(e,(function(e,r,a,i){try{r(t.apply(this,i))}catch(e){r(e)}}),r,a))},O.prototype=Object.create(Error.prototype,{name:{value:"CancellationError"}}),v.CancellationError=O;var w,M=new C("cancel",(function(e,t,r,a){t(new O(a&&a[0]))}),!1,!1);function I(){var e,t;0===i&&(s.length||h.length)&&(i=1,w||(t=0,w="undefined"==typeof MutationObserver||self&&self.navigator&&self.navigator.standalone?a?function(){a.resolve().then(H)}:"function"==typeof setImmediate?function(){setImmediate(H)}:function(){setTimeout(H,0)}:(e=document.createTextNode(""),new MutationObserver(H).observe(e,{characterData:!0}),function(){e.data=t=1-t})),w())}function R(e){return e===u?".tap()":l}function D(e,t){z(e,8),t._parent=e,e._children?e._children.push(t):e._child?(e._children=[e._child,t],e._child=void 0):e._child=t}function N(e){if(e&&("object"==typeof e||"function"==typeof e)){var t;try{t=e.then}catch(e){return p=e,c}if("function"==typeof t)return t}}function L(e){if(!e||k(e))return e;var t=N(e);if(t===c)return y(p);if(t){var r=new v((function(r,a){t.call(e,r,a)}));return r._thenableParent=e,r}return e}function k(e){return e instanceof v}function U(e,t,r){var a,i,n,s,o=k(e=L(e)),u=!1;if(o){if(!(3&e._flags))return z(e.then(t,r),32);z(e,8),u=!!(e._flags&_),n=e._context,a=1&e._flags?t:r,i=e._value}else a=t,i=e;if(!a)return E(e).then();if((i=q(a,n,i,!0))===c)s=y(p);else{if(i===d)return E(e).then(t,r);if(i===l)return o?e.then():E(e);s=E(i)}return u&&(s=s.cancellable()),void 0!==n&&((s=s.then())._context=n),s}function G(e,t,r,a,i){if(t===e._resolveLevel){var n=++e._resolveLevel;if(z(e,4),e._thenableParent=null,r)if(i===e)e._parent=void 0,K(e,!1,a,new TypeError("promise resolved to itself"));else if(k(i)){var s=3&i._flags;0===s?D(i,e):(e._parent=i,z(e,1024),z(i,8),K(e,1===s,a,i._value))}else{var o=N(i);o===c?(e._parent=void 0,K(e,!1,a,p)):o?(e._parent=void 0,e._thenableParent=i,V(o,i,(t=>G(e,n,!0,!1,t)),(t=>G(e,n,!1,!1,t)))):K(e,!0,a,i)}else K(e,!1,a,i)}}function F(e,t,r,a,i){t===e._resolveLevel&&(x(e),G(e,t,r,a,i))}function x(e){if(e._parent){var t=e._parent;if(e._parent=void 0,t._child===e)t._child=void 0;else if(t._children){for(var r=t._children,a=0;a<r.length;a++)if(r[a]===e){r.splice(a,1);break}0===r.length&&(t._children=void 0)}}}function B(e){if(null==e)throw new Error(`Invalid .catch guard ${e}`);if("function"==typeof e)return e;if("object"==typeof e)throw new Error("Object guards in .catch are currently unsupported");return function(t){return t===e}}function Y(e,t){return function(r,a){return r===u?`.catch(..., ${t})`:e&&!function(e,t){for(var r=0;r<e.length;r++){var a=e[r];if(a===Error||a.prototype instanceof Error){if(t instanceof a)return!0}else if(a(t))return!0}return!1}(e,r)?l:a?d:t.call(this,r)}}function K(e,t,r,a){if(z(e,4|(t?1:2)),e._value=a,e._child)j(e._child,t,r,a),e._child=void 0;else if(e._children){var i=e._children;e._children=void 0;for(var n=0;n<i.length;n++)j(i[n],t,r,a)}else t||8&e._flags||h.push(e)}function j(e,t,r,a){e._resolveLevel++;var i=$(e,t);if(i&&32&e._flags){z(e,4);var n=q(i,e._context,a,!0);if(n!==d)return void(n===c?(e._parent=void 0,K(e,!1,r,p)):n===l?K(e,t,r,a):(e._parent=void 0,G(e,e._resolveLevel,!0,r,n)));e._flags&=-5}i?((r?o:s).push(e),I()):K(e,t,r,a)}function W(e,t){for(;0!==e.length;)t.push(e.pop())}function H(){for(;0!==n.length||0!==s.length;){0===n.length&&W(s,n);var e=n.pop(),t=e._parent,r=!!(t&&1&t._flags),a=t&&t._value,u=$(e,r);if(z(e,4),u){var f=void 0;do{f=q(u,e._context,a,!1)}while(f===d);f===c?(a=p,r=!1,e._parent=void 0):f!==l&&(a=f,r=!0,e._parent=void 0)}3&e._flags||(G(e,e._resolveLevel,r,!0,a),W(o,n))}for(i--;0!==h.length;){var _=h.pop();8&_._flags||v.onPossiblyUnhandledRejection(_._value,_)}}function V(e,t,r,a){try{e.call(t,r,a)}catch(e){a(e)}}function $(e,t){if(!(4&e._flags))return t?e._onFulfilled:e._onRejected}function q(e,t,r,a){try{return a?e.call(t,r,!0):e.call(t,r)}catch(e){return p=e,c}}function z(e,t){return e._flags|=t,e}v.prototype.addCancelControl=function(){return z(this.addControl(M),_)},v.sit=function(e,t){var r=new v;return r._control=new C(e,(function(e,r,a,i){e(t?t.apply(void 0,i):i&&i[0])})),r},v.prototype.cancellable=function(){return z(this.then(),_)},v.prototype.uncancellable=function(){var e=this.then();return e._flags&=-65,e},v.prototype.cancel=function(e){for(var t,r=this;r&&!(3&r._flags);r=r._parent)r._flags&_&&(t=r);if(t)if(void 0===e&&(e=new O),$(t,!1)){var a=new v;x(t),D(a,t),F(a,0,!1,!1,e)}else F(t,t._resolveLevel,!1,!1,e)},G(r=new v,0,!0,!1,void 0)},56150:(e,t)=>{"use strict";function r(e){var{relativeDelay:t=!1}=e,r=null,n=i(e.algo);return function(){if(null==r)return r=t?Date.now():0,0;var i=a(e,n());if(t){var s=Date.now(),o=s-r;o>0&&(i=Math.max(0,i-o)),r=s}return i}}function a({max:e,min:t,jitter:r=.1},a){var i=a;return null!=e&&i>e&&(i=e),null!=t&&i<t&&(i=t),0!==r&&(i=Math.ceil(i*(1+r*Math.random()))),i}function i(e){switch(e.type){case"fibonacci":return function(e){var t=e.second-e.first,r=e.first-t;return function(){var e=t+r;return r=t,t=e,e}}(e);case"exponential":return function(e){var{base:t=2}=e,r=e.first;return function(){var e=r;return r*=t,e}}(e);case"constant":return function(e){var t=e.delay;return function(){return t}}(e);case"adjust":return function(e){var{toMs:t,backoff:r}=e,a=i(r);return function(){return t(a())}}(e);default:throw new Error(`makeTimeFunc unrecognized backoff ${e.type}`)}}Object.defineProperty(t,"__esModule",{value:!0}),t.getDelay=function(e,t){if(0===e)return 0;for(var r=i(t.algo),n=1;n<e;n++)r();return a(t,r())},t.createTimer=r,t.createPromiseTimer=function(e){var t=r(e);return function(e){return new Promise((r=>{var a=t();a>0?setTimeout(r,a,e):r(e)}))}}},76331:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.callSyncPromise=function(e,t,...r){try{return Promise.resolve(e.apply(t,r))}catch(e){return Promise.reject(e)}}},60266:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.delayMs=function(e,t){return new Promise((r=>{setTimeout(r,e,t)}))},t.withTimeout=function(e,t,r){return new Promise(((a,i)=>{var n=setTimeout((()=>{try{a(r())}catch(e){i(e)}}),t);e.then((e=>{clearTimeout(n),a(e)}),(e=>{clearTimeout(n),i(e)}))}))}},13275:(e,t,r)=>{"use strict";var a=r(34398);Object.defineProperty(t,"__esModule",{value:!0}),t.promiseLoop=function(){return n.apply(this,arguments)};var i=a(r(85374));function n(){return(n=(0,i.default)((function*(e,t){for(var r,a=!1,i=e=>{a=!0,r=e},n=0,s=t;!a;)s=yield e(i,s,n),n++;return r}))).apply(this,arguments)}},9737:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.promiseProps=function(e){var t=Object.keys(e);return Promise.all(t.map((t=>e[t]))).then((function(e){for(var r={},a=0;a<e.length;a++)r[t[a]]=e[a];return r}))}},31449:(e,t,r)=>{"use strict";var a=r(34398);Object.defineProperty(t,"__esModule",{value:!0}),t.promiseReduce=void 0;var i=a(r(85374)),n=function(){var e=(0,i.default)((function*(e,t,r){for(var a=r,i=e.length,n=0;n<i;n++)a=yield t(a,e[n],n);return a}));return function(){return e.apply(this,arguments)}}();t.promiseReduce=n},7355:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.timeout=t.TimeoutError=void 0;class r extends Error{constructor(e){super(e),this.name="TimeoutError",this.name="TimeoutError"}}t.TimeoutError=r;t.timeout=(e,t,a)=>new Promise(((i,n)=>{var s=setTimeout((()=>n(new r(a))),t);e.then((e=>{clearTimeout(s),i(e)})).catch(n)}))},47428:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.wrapSyncPromise=function(e){return function(){try{return Promise.resolve(e.apply(this,arguments))}catch(e){return Promise.reject(e)}}}},33923:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.compileSpec=function(e){if(e.internalCompiledSpec)return e.internalCompiledSpec;var t=e.internalSpec;if(!t)throw new Error(`Message Class ${String(e)} does not have internalSpec`);var r=e.internalDefaults||{},s=Object.keys(t).filter((e=>e!==a.KEYS.ONEOF)),o=new Array(s.length),l=[],d=[],u=new Array(s.length),c=t[a.KEYS.ONEOF]||{};s.sort(((e,r)=>{var a=n(t,e),i=n(t,r);return a[0]-i[0]}));for(var p=0;p<s.length;p++){var h=s[p],f=n(t,h);u[p]=r[h];var _=f[1],m=f[0];if(l.push(m),d.push(_),(_&a.TYPE_MASK)===a.TYPES.MESSAGE)o[p]=f[2];else if((_&a.TYPE_MASK)===a.TYPES.ENUM){var g=f[2];if("function"==typeof g.cast)o[p]=g;else{var v=!0,E=0;for(var y in g)v&&y!==E++&&(v=!1);var S=void 0;if(v){S=[];for(var T=0;T<E;T++)S.push(!0)}else for(var A in S={},g)S[g[A]]=!0;o[p]=S}}else o[p]=null}var b={},C=function(e){c[e].forEach((t=>{b[t]||(b[t]=[]),b[t].push(e)}))};for(var P in c)C(P);var O=t[a.KEYS.RESERVED]&&t[a.KEYS.RESERVED][a.KEYS.RESERVED_TAGS],w=t[a.KEYS.RESERVED]&&t[a.KEYS.RESERVED][a.KEYS.RESERVED_FIELDS],M=new i(s,l,d,u,o,c,b,O,w);return e.internalCompiledSpec=M,M},t.Spec=void 0;var a=r(99454);class i{constructor(e,t,r,a,i,n,s,o,l){this.names=e,this.fields=t,this.types=r,this.defaults=a,this.meta=i,this.oneofToFields=n,this.fieldToOneof=s,this.reservedTags=o?o.reduce(((e,t)=>(e[t]=!0,e)),{}):{},this.reservedFields=l?l.reduce(((e,t)=>(e[t]=!0,e)),{}):{}}}function n(e,t){var r=e[t];if(null==r)throw new Error(`fieldData of ${t} is missing`);return r}t.Spec=i},99454:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.KEYS=t.ENC=t.TYPES=t.TYPE_MASK=t.FLAGS=void 0;t.FLAGS={REPEATED:64,PACKED:128,REQUIRED:256};t.TYPE_MASK=31;t.TYPES={INT32:1,INT64:2,UINT32:3,UINT64:4,SINT32:5,SINT64:6,BOOL:7,ENUM:8,FIXED64:9,SFIXED64:10,DOUBLE:11,STRING:12,BYTES:13,MESSAGE:14,FIXED32:15,SFIXED32:16,FLOAT:17};t.ENC={VARINT:0,BIT64:1,BINARY:2,BIT32:5};t.KEYS={ONEOF:"__oneofs__",RESERVED:"__reserved__",RESERVED_TAGS:"tags",RESERVED_FIELDS:"fields"}},9557:(e,t,r)=>{"use strict";var a=r(34398);Object.defineProperty(t,"__esModule",{value:!0}),t.decodeProto=function(e,t){var r=new n.Binary(t),a=g(e,r,void 0,!1);return(0,d.checkRequirements)(e,a),a},t.decodeProtoWithUnknowns=function(e,t){var r=new n.Binary(t),a=g(e,r,void 0,!0);return(0,d.checkRequirements)(e,a),a},t.getUnknownFields=function(e){return Object.prototype.hasOwnProperty.call(e,"unsafeUnknownFields")?e.unsafeUnknownFields:null};var i=a(r(98029)),n=r(49244),s=r(33923),o=r(99454),l=r(56438),d=r(48002),u=r(61212);function c(e,t,r){if(e!==(0,l.typeToEncType)(t))throw new Error(`FormatError: ${r} encoded with wire type ${e}`)}function p(e,t,r){switch(t){case o.TYPES.INT32:return h(r,-2147483648,2147483648,e,n.parseInt64OrThrow);case o.TYPES.INT64:return r.readVarInt(f);case o.TYPES.UINT32:return h(r,0,4294967296,e,n.parseUint64OrThrow);case o.TYPES.UINT64:return r.readVarInt(_);case o.TYPES.SINT32:var a=h(r,0,4294967296,e,n.parseInt64OrThrow);return 1&a?~(a>>>1):a>>>1;case o.TYPES.SINT64:return r.readVarInt(m);case o.TYPES.BOOL:return!!h(r,0,2,e,n.parseUint64OrThrow);case o.TYPES.ENUM:return r.readVarInt(n.parseInt64OrThrow);case o.TYPES.FIXED64:return r.readLong(_,!0);case o.TYPES.SFIXED64:return r.readLong(f,!0);case o.TYPES.DOUBLE:return r.readFloat64(!0);case o.TYPES.STRING:return r.readString(r.readVarInt(n.parseUint64OrThrow));case o.TYPES.BYTES:return r.readBuffer(r.readVarInt(n.parseUint64OrThrow));case o.TYPES.FIXED32:return r.readUint32(!0);case o.TYPES.SFIXED32:return r.readInt32(!0);case o.TYPES.FLOAT:return r.readFloat32(!0)}}function h(e,t,r,a,i){var n=e.readVarInt(i);if(n<t||n>=r)throw new Error(`FormatError: ${a} encoded with out-of-range value ${n}`);return n}function f(e,t){if((0,n.longFitsInDouble)(!0,e,t))return 4294967296*e+v(t);var r,a=e<0;r=a?0===t?-e:~e:e;var i=a?-t:t;return(0,u.createHexLongFrom32Bits)(r,i,a)}function _(e,t){return(0,n.longFitsInDouble)(!1,e,t)?4294967296*v(e)+v(t):(0,u.createHexLongFrom32Bits)(e,t)}function m(e,t){var r=e>>>1,a=e<<31|t>>>1;return 1&t&&(r=~r,a=~a),f(r,a)}function g(e,t,r,a){for(var{names:l,fields:d,types:u,meta:f,oneofToFields:_,fieldToOneof:m,reservedTags:v,reservedFields:E}=(0,s.compileSpec)(e),{internalDefaults:y}=e,S=r||(0,i.default)({},y)||{},T=0;T<l.length;T++)u[T]&o.FLAGS.REPEATED&&(S[l[T]]=[]);for(var A=0,b=d[0];t.size();){var C=h(t,0,4294967296,"field and enc type",n.parseInt64OrThrow),P=7&C,O=C>>>3;if(O!==b){var w=A;do{++A===d.length&&(A=0),b=d[A]}while(O!==b&&A!==w)}if(O===b)!function(){var e=l[A],r=u[A];c(P,r,e);var i=r&o.TYPE_MASK,s=f[A];if(r&o.FLAGS.PACKED)for(var d=t.readVarInt(n.parseUint64OrThrow),h=t.readBinary(d);h.size();){var y=p(e,i,h);(i!==o.TYPES.ENUM||s[y]||void 0!==s.cast(y))&&S[e].push(y)}else if(i===o.TYPES.MESSAGE){var T=t.readVarInt(n.parseUint64OrThrow),b=t.readBinary(T);if(r&o.FLAGS.REPEATED)S[e].push(g(s,b,void 0,a));else{var C=S[e];S[e]=g(s,b,C,a)}}else{var w=p(e,i,t);(i!==o.TYPES.ENUM||s[w]||void 0!==s.cast(w))&&(r&o.FLAGS.REPEATED?S[e].push(w):S[e]=w)}var M=m[e];M&&void 0!==S[e]&&M.forEach((t=>{_[t].filter((t=>t!==e)).forEach((e=>{delete S[e]}))})),(v[O]||E[e])&&delete S[e]}();else if(a){S.unsafeUnknownFields||(S.unsafeUnknownFields={});var M=void 0;switch(P){case o.ENC.VARINT:M=t.readVarInt(n.parseInt64OrThrow);break;case o.ENC.BIT64:M=t.readBinary(8);break;case o.ENC.BINARY:M=t.readBinary(t.readVarInt(n.parseUint64OrThrow));break;case o.ENC.BIT32:M=t.readBinary(4)}S.unsafeUnknownFields[O]=M}else P===o.ENC.VARINT?t.readVarInt(n.parseInt64OrThrow):P===o.ENC.BIT64?t.advance(8):P===o.ENC.BINARY?t.advance(t.readVarInt(n.parseUint64OrThrow)):P===o.ENC.BIT32&&t.advance(4)}return S}function v(e){return e>=0?e:4294967296+e}},76549:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.encodeProto=function(e,t,r=new a.Binary){return(0,o.checkValid)(e,t),_(r,t,e),d=void 0,r},t.encodeErrorInfo=function(){return void 0!==d?`Last encoded value for ${d}`:"No information known"};var a=r(49244),i=r(33923),n=r(99454),s=r(56438),o=r(48002),l=r(61212),d=void 0;function u(e,t){e.writeVarInt(t)}function c(e,t){if("number"==typeof t&&t<4503599627370496&&t>=-4503599627370496)e.writeVarInt(t>=0?2*t:2*-t-1);else{var r,i=new a.Binary;"number"==typeof t?(r=t<0,i.writeVarInt(r?-t:t)):(r=(0,l.hexLongIsNegative)(t),i.writeVarIntFromHexLong(r?(0,l.negateHexLong)(t):t));var n=i.peek((()=>i.readByteArray())),s=n.byteLength;if(r){var o,d=0;do{o=n[d],n[d]=128&o|(127&o)-1&127,d++}while(255===n[d-1])}for(var u=r?1:0,c=0;c<s;c++){var p=n[c],h=128&p|(63&p)<<1|u;u=(64&p)>>6,n[c]=h}1===u&&(n[s-1]|=128,i.writeInt8(1)),e.writeBinary(i)}}function p(e,t){"number"==typeof t?e.writeVarInt(t):e.writeVarIntFromHexLong(t)}var h=[void 0,u,p,u,p,c,c,(e,t)=>{e.writeVarInt(t?1:0)},u,(e,t)=>{"number"==typeof t?e.writeUint64(t,!0):e.writeHexLong(t,!0)},(e,t)=>{"number"==typeof t?e.writeInt64(t,!0):e.writeHexLong(t,!0)},(e,t)=>{e.writeFloat64(t,!0)},function(e,t){e.writeVarInt((0,a.numUtf8Bytes)(t)),e.writeString(t)},function(e,t){e.writeVarInt(t.byteLength),e.writeBuffer(t)},function(e,t,r){e.writeWithVarIntLength(((e,t)=>_(e,t,r)),t)},(e,t)=>{e.writeUint32(t,!0)},(e,t)=>{e.writeInt32(t,!0)},(e,t)=>{e.writeFloat32(t,!0)}],f=h.map((e=>{if(null!=e)return(e,r)=>{e.writeWithVarIntLength(t,r)};function t(t,r){for(var a=0;a<r.length;a++)e(t,r[a])}}));function _(e,t,r){for(var{names:a,fields:o,types:l,meta:u}=(0,i.compileSpec)(r),{internalDefaults:c}=r,p=0;p<a.length;p++){var _=a[p],m=t[_];if(void 0===m&&c&&(m=c[_]),void 0!==m){d=_;var g=o[p],v=l[p],E=v&n.TYPE_MASK,y=u[p],S=8*g|(0,s.typeToEncType)(v);if(v&n.FLAGS.PACKED){if(m.length>0)e.writeVarInt(S),(0,f[E])(e,m,y)}else if(v&n.FLAGS.REPEATED)for(var T=0;T<m.length;T++){e.writeVarInt(S),(0,h[E])(e,m[T],y)}else{e.writeVarInt(S),(0,h[E])(e,m,y)}}}}},25364:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.numberOrThrowIfTooLarge=i,t.longIntToDecimalString=function(e){if("number"==typeof e)return e.toString(10);for(var t=(0,a.hexLongToHex)(e),r=[0],i=0,n=0;n<t.length;n++){i=(0,a.hexAt)(t,n);for(var s=0;s<r.length;s++)r[s]=16*r[s]+i,i=r[s]/10|0,r[s]%=10;for(;i>0;)r.push(i%10),i=i/10|0}var o=r.reverse().join("");return(0,a.hexLongIsNegative)(e)?"-"+o:o},t.decimalStringToLongInt=function(e){if(!/^-?\d+$/.test(e))throw __LOG__(2)`"${e}" is not a valid decimal string`,new Error("decimalStringToLongInt is given an invalid decimal string");var t="-"===e[0],r=e.replace(/^-?0*/,""),i=r.length;if(i<16||16===i&&r<="9007199254740991")return t?-Number(r):Number(r);if(i>20||20===i&&r>"18446744073709551615"||t&&(i>19||19===i&&r>"9223372036854775807"))throw __LOG__(2)`"${e}" is over 64 bits`,new Error("decimalStringToHexLong is given value over 64 bits");for(var n=0,s=0,o=0;o<i;o++)n=10*n+Number(r[o]),s=10*s+Math.floor(n/4294967296),n%=4294967296;return(0,a.createHexLongFrom32Bits)(s,n,t)},t.maybeNumberOrThrowIfTooLarge=void 0;var a=r(61212);function i(e){if("number"!=typeof e)throw __LOG__(2)`${e} is not a safe integer`,new Error("numberOrThrowIfTooLarge is given a non-safe integer");return e}t.maybeNumberOrThrowIfTooLarge=e=>null==e?e:i(e)},56438:(e,t,r)=>{"use strict";var a=r(66390);Object.defineProperty(t,"__esModule",{value:!0}),t.typeToEncType=function(e){if(e&n.PACKED)return l.BINARY;var t=e&o;return t<=s.ENUM?l.VARINT:t<=s.DOUBLE?l.BIT64:t<=s.MESSAGE?l.BINARY:l.BIT32};var i=a(r(99454)),{FLAGS:n,TYPES:s,TYPE_MASK:o,ENC:l}=i},48002:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.checkRequirements=s,t.checkValid=function(e,t){s(e,t);var r=h(t,e);if(r)throw r.path.reverse(),new TypeError(`Invalid value at ${r.path.join(".")}: ${r.error}`)};var a=r(33923),i=r(99454),n=Number.MAX_SAFE_INTEGER;function s(e,t){var r=o(e,t);if(r)throw r.reverse(),new TypeError(`Message missing required value ${r.join(".")}`)}function o(e,t){for(var{names:r,types:n,meta:s}=(0,a.compileSpec)(e),l=void 0,d=0;d<n.length&&!l;d++){var u=n[d],c=r[d],p=Object.prototype.hasOwnProperty.call(t,c)?t[c]:void 0;if(u&i.FLAGS.REQUIRED&&void 0===p)l=[c];else if((u&i.TYPE_MASK)===i.TYPES.MESSAGE&&u&i.FLAGS.REPEATED&&void 0!==p){var h=s[d],f=void 0;for(f=0;f<p.length&&!l;f++)l=o(h,p[f]);l&&l.push(`${c}[${f}]`)}else(u&i.TYPE_MASK)===i.TYPES.MESSAGE&&void 0!==p&&(l=o(s[d],p))&&l.push(c)}return l}function l(e,t,r){return"string"==typeof e?!/^-?0x[0-9a-f]{16}$/i.test(e)&&(__LOG__(2)`"${c(e)}" is not a valid long`,{path:[],error:"value must be a hex string of the form '0x123...' or '-0x123...' where the tail is always 16 characters long"}):d(e,t,r)}function d(e,t,r){return"number"!=typeof e||e!=e||Math.floor(e)!==e?(__LOG__(2)`"${c(e)}" is not a valid int`,{path:[],error:"value must be an int"}):(e<t||e>=r)&&(__LOG__(2)`"${c(e)}" is out of range`,{path:[],error:"value is out of range"})}function u(e,t,r){return e?void 0:(__LOG__(2)`"${c(r)}" is not ${t}`,{path:[],error:"value is invalid"})}function c(e){return"string"==typeof e?`"${e}"`:Array.isArray(e)?`[${e.join(", ")}]`:`${e}`}var p=[void 0,e=>d(e,-2147483648,2147483648),e=>l(e,-n,n+1),e=>d(e,0,4294967296),e=>l(e,0,n+1),e=>d(e,-2147483648,2147483648),e=>l(e,-n,n+1),e=>u("boolean"==typeof e,"boolean",e),(e,t)=>u("number"==typeof e&&(t[e]||void 0!==t.cast(e)),"in enum",e),e=>l(e,0,n+1),e=>l(e,-n,n+1),e=>u("number"==typeof e,"number",e),e=>u("string"==typeof e,"string",e),e=>u(e instanceof ArrayBuffer||e instanceof Uint8Array,"ArrayBuffer or Uint8Array",e),h,e=>d(e,0,4294967296),e=>d(e,-2147483648,2147483648),e=>u("number"==typeof e,"number",e)];function h(e,t){for(var{names:r,fields:n,types:s,meta:o,oneofToFields:l,fieldToOneof:d,reservedTags:u,reservedFields:h}=(0,a.compileSpec)(t),f=void 0,_=function(t){var a=r[t],_=s[t],m=e[a],g=_&i.TYPE_MASK,v=p[g];if(void 0===v)throw new Error(`Can not find the validator for type ${g}`);if(_&(i.FLAGS.PACKED|i.FLAGS.REPEATED)&&void 0!==m)if(Array.isArray(m))for(var E=o[t],y=0;y<m.length&&!f;y++)(f=v(m[y],E))&&f.path.push(`${a}[${y}]`);else __LOG__(2)`"${c(m)}" is not an array`,f={path:[a],error:"repeated field must be array"};else if(void 0!==m){(f=v(m,o[t]))&&f.path.push(a);var S=d[a];S&&S.forEach((t=>{l[t].filter((e=>e!==a)).forEach((r=>{void 0!==e[r]&&(f={path:[t],error:`oneof has fields '${a}' and '${r}' set`})}))})),u[n[t]]&&(f={path:[a],error:`tag ${n[t]} is reserved`}),h[a]&&(f={path:[a],error:"field name is reserved"})}},m=0;m<r.length&&!f;m++)_(m);return f}},37444:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ensureSize=d,t.toBytes=function(e,t){return d(new Uint8Array(e),t)},t.toBuffer=function(e){var t=e.buffer,r=e.byteOffset,a=e.length;return 0===r&&a===t.byteLength?t:t.slice(r,r+a)},t.readBytes=function(e,t){return e.readByteArray(t)},t.makeBytes=function(e){return new Uint8Array(e)},t.sliceBytes=function(e,t,r){if(e.length-t<r)throw new Error(`Can not split off ${r} bytes from index ${t} of ${e.length} bytes`);return e.slice(t,t+r)},t.makeRegistrationId=function(e){var t="extendedRange"===e?2147483646:16380;return(0,s.randomNumberLessThan)(t)+1},t.castRegistrationId=function(e){return u(e)},t.makeSenderKeyId=function(){return(0,s.randomNumberLessThan)(-1>>>1)+1},t.castSenderKeyId=function(e){return u(e)},t.ensureIntInRange=u,t.encodeSignalProto=function(e,t){return(0,a.encodeProto)(e,t).readByteArray()},t.decodeSignalProto=function(e,t,r){return r((0,i.decodeProto)(e,t))},t.hkdf=function(e,t,r,a){return(0,n.extractWithSaltAndExpand)(e,t,r,a).then((e=>new Uint8Array(e)))},t.makeCryptoKey=function(e,t){var r,a;"hmac-sha256"===t?(r=l,a=["sign"]):(r=o,a=["encrypt","decrypt"]);return self.crypto.subtle.importKey("raw",e,r,!1,a)},t.HMAC_SHA256=t.AES_CBC=void 0;var a=r(76549),i=r(9557),n=r(46291),s=r(26540),o={name:"AES-CBC"};t.AES_CBC=o;var l={name:"HMAC",hash:"SHA-256"};function d(e,t){if(e.length!==t)throw new Error(`Signal expected ${t} bytes, given ${e.length}`);return e}function u(e,t=0,r=4294967296){if("number"==typeof e&&t<=e&&e<r&&Math.floor(e)===e)return e;throw new Error(`Expected integer in range [${t}, ${r}), given ${String(e)}`)}t.HMAC_SHA256=l},49244:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.numUtf8Bytes=u,t.longFitsInDouble=c,t.parseInt64OrThrow=j,t.parseUint64OrThrow=W,t.Binary=void 0;var a=r(61212),i=65533,n=new Uint8Array(10),s=new Uint8Array(0);class o{constructor(e=s,t=!1){e instanceof ArrayBuffer?(this._buffer=new Uint8Array(e),this._readEndIndex=this._writeIndex=e.byteLength):e instanceof Uint8Array&&(this._buffer=e,this._readEndIndex=this._writeIndex=e.length),this._bytesTrashed=0,this._earliestIndex=this._readIndex=0,this._view=null,this._littleEndian=t,this._hiddenReads=0,this._hiddenWrites=0}size(){return this._readEndIndex-this._readIndex}peek(e,t){this._hiddenReads++;var r=this._readIndex,a=this._bytesTrashed;try{return e(this,t)}finally{this._hiddenReads--,this._readIndex=r-(this._bytesTrashed-a)}}advance(e){this._shiftReadOrThrow(e)}readWithViewParser(e,t,r,a){return t(this._getView(),this._shiftReadOrThrow(e),e,r,a)}readWithBytesParser(e,t,r,a){return t(this._buffer,this._shiftReadOrThrow(e),e,r,a)}readUint8(){return p(this,1,f,!1)}readInt8(){return p(this,1,f,!0)}readUint16(e=this._littleEndian){return p(this,2,_,e)}readInt32(e=this._littleEndian){return p(this,4,m,e)}readUint32(e=this._littleEndian){return p(this,4,g,e)}readInt64(e=this._littleEndian){return p(this,8,v,j,e)}readUint64(e=this._littleEndian){return p(this,8,v,W,e)}readLong(e,t=this._littleEndian){return p(this,8,v,e,t)}readFloat32(e=this._littleEndian){return p(this,4,E,e)}readFloat64(e=this._littleEndian){return p(this,8,y,e)}readVarInt(e){var t=h(this,0,S,this.size());return h(this,t,T,e)}readBuffer(e=this.size()){return 0===e?new ArrayBuffer(0):h(this,e,A)}readByteArray(e=this.size()){return 0===e?new Uint8Array(0):h(this,e,b)}readBinary(e=this.size(),t=this._littleEndian){if(0===e)return new o(void 0,t);var r=h(this,e,b);return new o(r,t)}indexOf(e){if(0===e.length)return 0;for(var t=this._buffer,r=this._readEndIndex,a=this._readIndex,i=0,n=a,s=a;s<r;s++)if(t[s]===e[i]){if(0===i&&(n=s),++i===e.byteLength)return s-a-e.byteLength+1}else i>0&&(i=0,s=n);return-1}readString(e){return h(this,e,C)}ensureCapacity(e){this._maybeReallocate(this._readIndex+e)}ensureAdditionalCapacity(e){this._maybeReallocate(this._writeIndex+e)}writeToView(e,t,r,a){var i=this._shiftWriteMaybeReallocate(e);return t(this._getView(),i,e,r,a)}writeToBytes(e,t,r,a){var i=this._shiftWriteMaybeReallocate(e);return t(this._buffer,i,e,r,a)}write(...e){for(var t=0;t<e.length;t++){var r=e[t];"string"==typeof r?this.writeString(r):"number"==typeof r?this.writeUint8(r):r instanceof o?this.writeBinary(r):r instanceof ArrayBuffer?this.writeBuffer(r):r instanceof Uint8Array&&this.writeByteArray(r)}}writeUint8(e){Y(e,0,256,"uint8"),O(this,1,w,e,!1)}writeInt8(e){Y(e,-128,128,"signed int8"),O(this,1,w,e,!0)}writeUint16(e,t=this._littleEndian){Y(e,0,65536,"uint16"),P(this,2,M,e,t)}writeInt16(e,t=this._littleEndian){Y(e,-32768,32768,"signed int16"),P(this,2,I,e,t)}writeUint32(e,t=this._littleEndian){Y(e,0,4294967296,"uint32"),P(this,4,R,e,t)}writeInt32(e,t=this._littleEndian){Y(e,-2147483648,2147483648,"signed int32"),P(this,4,D,e,t)}writeUint64(e,t=this._littleEndian){Y(e,0,0x10000000000000000,"uint64"),P(this,8,N,e,t)}writeInt64(e,t=this._littleEndian){Y(e,-0x8000000000000000,0x8000000000000000,"signed int64"),P(this,8,N,e,t)}writeFloat32(e,t=this._littleEndian){P(this,4,L,e,t)}writeFloat64(e,t=this._littleEndian){P(this,8,k,e,t)}writeVarInt(e){Y(e,-0x8000000000000000,0x8000000000000000,"varint (signed int64)");var t=e<0,r=t?-e:e,a=Math.floor(r/4294967296),i=r-4294967296*a;t&&(a=~a,0===i?a++:i=-i),O(this,B(a,i),U,a,i)}writeVarIntFromHexLong(e){for(var t=(0,a.hexLongIsNegative)(e),r=t?(0,a.negateHexLong)(e):e,i=(0,a.hexLongToHex)(r),n=0,s=0,o=0;o<a.NUM_HEX_IN_LONG;o++)n=n<<4|s>>>28,s=s<<4|(0,a.hexAt)(i,o);t&&(n=~n,0===s?n++:s=-s),O(this,B(n,s),U,n,s)}writeBinary(e){var t=e.peek((e=>e.readByteArray()));if(t.length){var r=this._shiftWriteMaybeReallocate(t.length);this._buffer.set(t,r)}}writeBuffer(e){this.writeByteArray(new Uint8Array(e))}writeByteArray(e){var t=this._shiftWriteMaybeReallocate(e.length);this._buffer.set(e,t)}writeBufferView(e){this.writeByteArray(new Uint8Array(e.buffer,e.byteOffset,e.byteLength))}writeString(e){O(this,u(e),G,e)}writeHexLong(e,t=this._littleEndian){P(this,8,F,e,t)}writeBytes(...e){for(var t=0;t<e.length;t++)Y(e[t],0,256,"byte");O(this,e.length,x,e)}writeAtomically(e,t){this._hiddenWrites++;var r=this._writeIndex,a=this._bytesTrashed;try{var i=e(this,t);return r=this._writeIndex,a=this._bytesTrashed,i}finally{this._hiddenWrites--,this._writeIndex=r-(this._bytesTrashed-a)}}writeWithVarIntLength(e,t){var r=this._writeIndex,a=this.writeAtomically(e,t),i=this._writeIndex;this.writeVarInt(i-r);for(var s=this._writeIndex-i,o=this._buffer,l=0;l<s;l++)n[l]=o[i+l];for(var d=i-1;d>=r;d--)o[d+s]=o[d];for(var u=0;u<s;u++)o[r+u]=n[u];return a}static build(...e){for(var t=0,r=0;r<e.length;r++){var a=e[r];"string"==typeof a?t+=u(a):"number"==typeof a?t++:a instanceof o?t+=a.size():a instanceof ArrayBuffer?t+=a.byteLength:a instanceof Uint8Array&&(t+=a.length)}var i=new o;return i.ensureCapacity(t),i.write.apply(i,arguments),i}_getView(){return this._view||(this._view=new DataView(this._buffer.buffer,this._buffer.byteOffset))}_shiftReadOrThrow(e){if(e<0)throw new Error("ReadError: given negative number of bytes to read");var t=this._readIndex,r=t+e;if(r>this._readEndIndex)throw new Error(t===this._readEndIndex?"ReadError: tried to read from depleted binary":"ReadError: tried to read beyond end of binary");return this._readIndex=r,this._hiddenReads||(this._earliestIndex=r),t}_maybeReallocate(e){var t=this._buffer;if(e<=t.length)return e;var r=this._earliestIndex,a=e-r,i=Math.max(a,2*(t.length-r),64),n=new Uint8Array(i);return r?(n.set(t.subarray(r)),this._bytesTrashed+=r,this._readIndex-=r,this._readEndIndex-=r,this._writeIndex-=r,this._earliestIndex=0):n.set(t),this._buffer=n,this._view=null,a}_shiftWriteMaybeReallocate(e){var t=this._maybeReallocate(this._writeIndex+e),r=this._writeIndex;return this._writeIndex=t,this._hiddenWrites||(this._readEndIndex=t),r}}t.Binary=o;var l="",d=0;function u(e){if(e===l)return d;for(var t=e.length,r=0,a=0;a<t;a++){var i=e.charCodeAt(a);if(i<128)r++;else if(i<2048)r+=2;else if(i<55296||57344<=i&&i<=65535)r+=3;else if(55296<=i&&i<56320&&a+1!==t){var n=e.charCodeAt(a+1);56320<=n&&n<57344?(a++,r+=4):r+=3}else r+=3}return l=e,d=r}function c(e,t,r){var a=t>>21;if(e){var i=Boolean(2097151&t||r);return 0===a||-1===a&&i}return 0===a}function p(e,t,r,a,i){return e.readWithViewParser(t,r,a,i)}function h(e,t,r,a,i){return e.readWithBytesParser(t,r,a,i)}function f(e,t,r,a){return a?e.getInt8(t):e.getUint8(t)}function _(e,t,r,a){return e.getUint16(t,a)}function m(e,t,r,a){return e.getInt32(t,a)}function g(e,t,r,a){return e.getUint32(t,a)}function v(e,t,r,a,i){return a(e.getInt32(i?t+4:t,i),e.getInt32(i?t:t+4,i))}function E(e,t,r,a){return e.getFloat32(t,a)}function y(e,t,r,a){return e.getFloat64(t,a)}function S(e,t,r,a){for(var i=Math.min(a,10),n=0,s=128;n<i&&128&s;)s=e[t+n++];if(10===n&&s>1)throw new Error("ParseError: varint exceeds 64 bits");return 128&s?n+1:n}function T(e,t,r,a){var i=0,n=0,s=r;10===r&&(n=1&e[t+--s]);for(var o=s-1;o>=0;o--)i=i<<7|n>>>25,n=n<<7|127&e[t+o];return a(i,n)}function A(e,t,r){var a=t+e.byteOffset,i=e.buffer;return 0===a&&r===i.byteLength?i:i.slice(a,a+r)}function b(e,t,r){return e.subarray(t,t+r)}function C(e,t,r){for(var a=t+r,n=[],s=null,o=t;o<a;o++){n.length>5e3&&(s||(s=[]),s.push(String.fromCharCode.apply(String,n)),n=[]);var l=0|e[o];if(0==(128&l))n.push(l);else if(192==(224&l)){var d=H(e,o+1,a);if(d){o++;var u=(31&l)<<6|63&d;u>=128?n.push(u):n.push(i)}else n.push(i)}else if(224==(240&l)){var c=H(e,o+1,a),p=H(e,o+2,a);if(c&&p){o+=2;var h=(15&l)<<12|(63&c)<<6|63&p;h>=2048&&!(55296<=h&&h<57344)?n.push(h):n.push(i)}else c?(o++,n.push(i)):n.push(i)}else if(240==(248&l)){var f=H(e,o+1,a),_=H(e,o+2,a),m=H(e,o+3,a);if(f&&_&&m){o+=3;var g=(7&l)<<18|(63&f)<<12|(63&_)<<6|63&m;if(g>=65536&&g<=1114111){var v=g-65536;n.push(55296|v>>10,56320|1023&v)}else n.push(i)}else f&&_?(o+=2,n.push(i)):f?(o++,n.push(i)):n.push(i)}else n.push(i)}var E=String.fromCharCode.apply(String,n);return s?(s.push(E),s.join("")):E}function P(e,t,r,a,i){return e.writeToView(t,r,a,i)}function O(e,t,r,a,i){return e.writeToBytes(t,r,a,i)}function w(e,t,r,a){e[t]=a}function M(e,t,r,a,i){e.setUint16(t,a,i)}function I(e,t,r,a,i){e.setInt16(t,a,i)}function R(e,t,r,a,i){e.setUint32(t,a,i)}function D(e,t,r,a,i){e.setInt32(t,a,i)}function N(e,t,r,a,i){var n=a<0,s=n?-a:a,o=Math.floor(s/4294967296),l=s-4294967296*o;n&&(o=~o,0===l?o++:l=-l),e.setUint32(i?t+4:t,o,i),e.setUint32(i?t:t+4,l,i)}function L(e,t,r,a,i){e.setFloat32(t,a,i)}function k(e,t,r,a,i){e.setFloat64(t,a,i)}function U(e,t,r,a,i){for(var n=a,s=i,o=t+r-1,l=t;l<o;l++)e[l]=128|127&s,s=n<<25|s>>>7,n>>>=7;e[o]=s}function G(e,t,r,a){for(var i=t,n=a.length,s=0;s<n;s++){var o=a.charCodeAt(s);if(o<128)e[i++]=o;else if(o<2048)e[i++]=192|o>>6,e[i++]=128|63&o;else if(o<55296||57344<=o)e[i++]=224|o>>12,e[i++]=128|o>>6&63,e[i++]=128|63&o;else if(55296<=o&&o<56320&&s+1!==n){var l=a.charCodeAt(s+1);if(56320<=l&&l<57344){s++;var d=65536+((1023&o)<<10|1023&l);e[i++]=240|d>>18,e[i++]=128|d>>12&63,e[i++]=128|d>>6&63,e[i++]=128|63&d}else e[i++]=239,e[i++]=191,e[i++]=189}else e[i++]=239,e[i++]=191,e[i++]=189}}function F(e,t,r,i,n){for(var s=(0,a.hexLongIsNegative)(i),o=(0,a.hexLongToHex)(i),l=0,d=0,u=0;u<16;u++)l=l<<4|d>>>28,d=d<<4|(0,a.hexAt)(o,u);s&&(l=~l,0===d?l++:d=-d),e.setUint32(n?t+4:t,l,n),e.setUint32(n?t:t+4,d,n)}function x(e,t,r,a){for(var i=0;i<r;i++)e[t+i]=a[i]}function B(e,t){var r,a;for(e?(r=5,a=e>>>3):(r=1,a=t>>>7);a;)r++,a>>>=7;return r}function Y(e,t,r,a){if("number"!=typeof e||e!=e||Math.floor(e)!==e||e<t||e>=r)throw new TypeError("string"==typeof e?`WriteError: string "${e}" is not a valid ${a}`:`WriteError: ${String(e)} is not a valid ${a}`)}function K(e,t,r){var a=4294967296*(t>=0||e?t:4294967296+t)+(r>=0?r:4294967296+r);if(!c(e,t,r))throw new Error(`ReadError: integer exceeded 53 bits (${a})`);return a}function j(e,t){return K(!0,e,t)}function W(e,t){return K(!1,e,t)}function H(e,t,r){if(t>=r)return 0;var a=0|e[t];return 128==(192&a)?a:0}},71436:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.customError=a,t.supressQuotaExceededError=function(e){if(null==e||"QuotaExceededError"!==e.name)throw e;n=!0},t.hasSupressedQuotaExceededError=function(){return n},t.obtainErrorSummary=function(e){return JSON.stringify(e,Object.getOwnPropertyNames(e))},t.WrappedError=t.HttpError=void 0;var r=Object.create(Error.prototype,{constructor:{value:void 0,writable:!0,configurable:!0}});function a(e,t=!0,a){function i(r){var a=Error.call(this,r);this.message=r,a.name=e,this.name=e,t&&(this.stack=a.stack)}return i.prototype=Object.create(a?a.prototype:r),i.prototype.constructor=i,i}class i extends(a("HttpError",!1)){constructor(e,t){super(e),this.code=t}}t.HttpError=i;var n=!1;class s extends Error{constructor(e,t){super(e),this.inner=t}}t.WrappedError=s},35160:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ShiftTimer=void 0;function r(e){if(!(e>=0))throw new Error("ShiftTimer must be given delay >= 0")}t.ShiftTimer=class{constructor(e){this._timer=0,this._rafId=0,this.ts=0,this._timerTs=0,this._upperBound=0,this._lowerBound=0,this._arg=void 0,this._run=()=>{var e=this._arg,t=this._foo;this._rafId=0,this._timer=0,this.ts=0,this._timerTs=0,this._upperBound=0,this._lowerBound=0,this._arg=void 0,t(e)},this._foo=e}onOrBefore(e,t){r(e);var a=Date.now()+e,i=this._upperBound;if(!(0!==i&&i<a)){var n=this._lowerBound;0!==n&&a<n||(this._upperBound=a,this._rafId||this._timer&&!(a<this.ts)||this._setDelay(a,e,t))}}onOrBeforeRepaint(e){if(!this._rafId){var t=Date.now(),r=this._lowerBound;if(!(0!==r&&t<r)){var a=this._upperBound;(0===a||t<a)&&(this._upperBound=t),this._timer&&(clearTimeout(this._timer),this._timer=0),(!this.ts||this.ts>t)&&(this.ts=t),this._arg=e,this._rafId=requestAnimationFrame(this._run)}}}onOrAfter(e,t){r(e);var a=Date.now()+e,i=this._lowerBound;if(!(0!==i&&a<i)){var n=this._upperBound;0!==n&&n<a||(this._lowerBound=a,(!this._timer||this.ts<a)&&this._setDelay(a,e,t))}}debounce(e,t){r(e),this._debounce(Date.now(),e,t)}debounceAndCap(e,t,a){r(e),r(t);var i=Date.now(),n=i+t,s=this._lowerBound,o=this._upperBound;(0===s||s<=n)&&(0===o||n<o)&&(this._upperBound=n),this._debounce(i,e,a)}forceRunNow(e){this._timer&&clearTimeout(this._timer),this._rafId&&cancelAnimationFrame(this._rafId),this._arg=e,this._run()}forceRunNowIfScheduled(){this._timer?(clearTimeout(this._timer),this._run()):this._rafId&&(cancelAnimationFrame(this._rafId),this._run())}cancel(){this._timer&&clearTimeout(this._timer),this._rafId&&cancelAnimationFrame(this._rafId),this._timer=0,this._rafId=0,this.ts=0,this._timerTs=0,this._upperBound=0,this._lowerBound=0,this._arg=void 0}isScheduled(){return 0!==this._timer||0!==this._rafId}_debounce(e,t,r){var a=e+t,i=this._lowerBound;if(!(0!==i&&a<i)){var n=this.ts,s=this._upperBound;0!==s&&s<a?n<s&&this._setDelay(s,s-e,r):n<a&&this._setDelay(a,t,r)}}_setDelay(e,t,r){if(this._rafId&&(cancelAnimationFrame(this._rafId),this._rafId=0),this._arg=r,this.ts=e,this._timer){var a=e-this._timerTs;if(-16<a&&a<16)return;clearTimeout(this._timer)}this._timer=setTimeout(this._run,t),this._timerTs=e}}},85947:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.startScheduler=function(e){__LOG__(2)`startScheduler invoked`,s||(s=new n(e))},t.awaitTaskPromise=function(e){return l("awaitTaskPromise").awaitTaskPromise(e)},t.reschedule=o,t.rescheduleNow=function(e){o(e,(0,a.unixTime)())},t.deactivate=function(e){o(e,a.DUMMY_UNIXTIME)},t.getScheduledTime=function(e){return l("getScheduledTime").getScheduledTime(e)},t.registerTask=function(e,t){l("registerTask").registerTask(e,t)},t.DO_NOT_RESCHEDULE=void 0;var a=r(95334),i=r(56150);t.DO_NOT_RESCHEDULE="no_reschedule";class n{constructor(e){this._started=!1,this._resolvers={},this._timers={},this._timeoutIDs={},this._taskImplementations=new Map,this._scheduledTimeResolver=e.scheduledTimeResolver}_startTask(e){var t=this._taskImplementations.get(e);null!=t?this._scheduledTimeResolver.get(e).then((r=>{var i=null==r;if(i||r!==a.DUMMY_UNIXTIME){var n=null==r?0:1e3*r-(0,a.unixTimeMs)();n=Math.max(0,n),n=Math.min(n,~(1<<31)),__LOG__(2)`Scheduling task ${e} in ${n}ms`,this._timeoutIDs[e]=setTimeout((()=>{delete this._timeoutIDs[e],__LOG__(2)`Firing task ${e}`,t(i).then((t=>{return"no_reschedule"===t?new Promise((()=>{})):(t===a.DUMMY_UNIXTIME?(__LOG__(2)`Task ${e} complete, deactivating`,delete this._timers[e],r=a.DUMMY_UNIXTIME):t>=0?(__LOG__(2)`Task ${e} complete, waiting ${t}`,delete this._timers[e],r=(0,a.futureUnixTime)(t)):(__LOG__(2)`Task ${e} will try again later`,r=this._getNextRun(e)),this._scheduledTimeResolver.set(e,r));var r})).then((()=>{this._startTask(e),this._resolvers[e]&&(this._resolvers[e].forEach((e=>e())),delete this._resolvers[e])})).catch((t=>(__LOG__(2)`Task ${e} failed, try again later: ${t}`,this._scheduledTimeResolver.set(e,this._getNextRun(e)).then((()=>{this._startTask(e)})))))}),n)}else __LOG__(2)`Task ${e} deactivated`})):__LOG__(4,void 0,new Error)`Tried to start task ${e} before registering its implementation`}_getNextRun(e){return this._timers[e]||(this._timers[e]=(0,i.createTimer)({jitter:.1,max:1e3*a.HOUR_SECONDS,algo:{type:"fibonacci",first:1e3,second:2e3}})),(0,a.futureUnixTime)(Math.round(this._timers[e]()/1e3))}_registerResolver(e,t){this._resolvers[e]||(this._resolvers[e]=[]),this._resolvers[e].push(t)}awaitTaskPromise(e){return new Promise((t=>{this._registerResolver(e,t)}))}reschedule(e,t){this._started?(this._scheduledTimeResolver.set(e,t),null!=this._timeoutIDs[e]&&clearTimeout(this._timeoutIDs[e]),this._startTask(e)):this._scheduledTimeResolver.set(e,t)}registerTask(e,t){this._started||(this._started=!0),this._taskImplementations.set(e,t),this._startTask(e)}getScheduledTime(e){return this._scheduledTimeResolver.get(e)}}var s=null;function o(e,t){l("reschedule").reschedule(e,t)}function l(e){if(s)return s;throw new Error(`TaskScheduler::${e} called before startScheduler`)}},36916:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.removeIndexWithoutPreservingOrder=function(e,t){var r=e.pop();t<e.length&&(e[t]=r)}},97715:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.stringToArrayBuffer=function(e){var t,r,a=new ArrayBuffer(e.length),i=new Uint8Array(a);for(t=0,r=e.length;t<r;t++)i[t]=e.charCodeAt(t);return i.buffer},t.arrayBufferToString=function(e){return String.fromCharCode.apply(null,new Uint8Array(e))}},87031:e=>{e.exports=function(e){throw new Error(`Impossible value, the default statement should never be reached for value: ${e}`)}},84337:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.encodeB64=function(e){return a(e,43,47,!0)},t.encodeB64UrlSafe=function(e,t=!1){return a(e,45,95,t)},t.decodeB64=function(e){var t=n(e,43,47,61);if(t)return t.buffer;throw new Error("Base64.decode given invalid string")},t.decodeB64UrlSafe=function(e){var t=n(e,45,95,-1);if(t)return t.buffer;throw new Error("Base64.decode given invalid string")},t.decodeB64ToJsArray=function(e){var t=e instanceof ArrayBuffer?new Uint8Array(e):n(e,43,47,61);return t&&Array.prototype.slice.call(t)},t.sizeWhenB64Decoded=function(e){return Math.floor(3*e.length/4)},t.BASE64_DATA_URL_SCHEME=void 0;var r=3e3;function a(e,t,a,n){var s=Array.isArray(e)||e instanceof ArrayBuffer?new Uint8Array(e):e;if(s.length<=r)return i(s,t,a,n);for(var o=[],l=0;l<s.length;l+=r)o.push(i(s.subarray(l,l+r),t,a,n));return o.join("")}function i(e,t,r,a){for(var i=Math.ceil(4*e.length/3),n=4*Math.ceil(e.length/3),s=new Array(n),o=0,l=0;o<n;o+=4,l+=3){var d=e[l]<<16|e[l+1]<<8|e[l+2];s[o]=d>>18,s[o+1]=d>>12&63,s[o+2]=d>>6&63,s[o+3]=63&d}for(var u=0;u<i;u++){var c=s[u];s[u]=c<26?65+c:c<52?71+c:c<62?c-4:62===c?t:r}for(var p=i;p<n;p++)s[p]=61;var h=String.fromCharCode.apply(String,s);return a?h:h.substring(0,i)}function n(e,t,r,a){for(var i=e.length,n=new Int32Array(i+i%4),s=0;s<i;s++){var o=e.charCodeAt(s);if(65<=o&&o<=90)n[s]=o-65;else if(97<=o&&o<=122)n[s]=o-71;else if(48<=o&&o<=57)n[s]=o+4;else if(o===t)n[s]=62;else{if(o!==r){if(o===a){i=s;break}return null!=self.ERROR&&__LOG__(4,void 0,new Error)`Found unexpected character code while decoding B64 at index ${s}, length ${i}: ${o}`,null}n[s]=63}}for(var l=n.length/4,d=0,u=0;d<l;d++,u+=4)n[d]=n[u]<<18|n[u+1]<<12|n[u+2]<<6|n[u+3];for(var c=Math.floor(3*i/4),p=new Uint8Array(c),h=0,f=0;f+3<=c;h++,f+=3){var _=n[h];p[f]=_>>16,p[f+1]=_>>8&255,p[f+2]=255&_}switch(c-f){case 2:p[f]=n[h]>>16,p[f+1]=n[h]>>8&255;break;case 1:p[f]=n[h]>>16}return p}t.BASE64_DATA_URL_SCHEME="data:image/jpeg;base64,"},57643:(e,t,r)=>{"use strict";var a,i;Object.defineProperty(t,"__esModule",{value:!0}),t.dir=function(e){!function(){if(a)return;var e=r(88610),t=e.length/2;a=new Int32Array(t),i=new Int32Array(t);for(var n=0,s=0;n<t;n++,s+=2)a[n]=e[s]+(0===n?0:a[n-1]),i[n]=e[s+1]}();for(var t=0;t<e.length;t++){var n=0|e.charCodeAt(t);if(55296<=n&&n<56320){if(++t===e.length)break;var s=e.charCodeAt(t);if(!(56320<=s&&s<57344))continue;n=65536+((1023&n)<<10|1023&s)}else if(56320<=n&&n<57344)continue;if(!(n<a[0])){for(var o=0|a.length,l=0,d=o-1|0;l<d;){var u=d+l>>1;if(a[u]>n)d=u-1|0;else{if(a[u+1]>n){d=u;break}l=u+1|0}}var c=i[d],p=a[d]+Math.abs(c)|0;if(n<p)return c<0?"rtl":"ltr"}}return}},77884:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=[];r[34]="ES",r[49]="DE",r[52]="MX",r[44]="GB",r[966]="SA",r[39]="IT",r[93]="AF",r[355]="AL",r[213]="DZ",r[376]="AD",r[244]="AO",r[54]="AR",r[374]="AM",r[297]="AW",r[61]="AU",r[43]="AT",r[994]="AZ",r[973]="BH",r[880]="BD",r[375]="BY",r[32]="BE",r[501]="BZ",r[229]="BJ",r[975]="BT",r[591]="BO",r[387]="BA",r[267]="BW",r[55]="BR",r[246]="IO",r[673]="BN",r[359]="BG",r[226]="BF",r[257]="BI",r[225]="CI",r[855]="KH",r[237]="CM",r[238]="CV",r[236]="CF",r[235]="TD",r[56]="CL",r[86]="CN",r[57]="CO",r[269]="KM",r[242]="CG",r[243]="CD",r[682]="CK",r[506]="CR",r[385]="HR",r[53]="CU",r[599]="CW",r[357]="CY",r[420]="CZ",r[45]="DK",r[253]="DJ",r[593]="EC",r[20]="EG",r[503]="SV",r[240]="GQ",r[291]="ER",r[372]="EE",r[251]="ET",r[298]="FO",r[679]="FJ",r[358]="FI",r[33]="FR",r[594]="GF",r[689]="PF",r[241]="GA",r[220]="GM",r[995]="GE",r[233]="GH",r[350]="GI",r[30]="GR",r[299]="GL",r[590]="GP",r[502]="GT",r[224]="GN",r[245]="GW",r[592]="GY",r[509]="HT",r[504]="HN",r[852]="HK",r[36]="HU",r[354]="IS",r[91]="IN",r[62]="ID",r[98]="IR",r[964]="IQ",r[353]="IE",r[972]="IL",r[81]="JP",r[962]="JO",r[254]="KE",r[965]="KW",r[996]="KG",r[856]="LA",r[371]="LV",r[961]="LB",r[266]="LS",r[231]="LR",r[218]="LY",r[423]="LI",r[370]="LT",r[352]="LU",r[853]="MO",r[389]="MK",r[261]="MG",r[265]="MW",r[60]="MY",r[960]="MV",r[223]="ML",r[356]="MT",r[692]="MH",r[596]="MQ",r[222]="MR",r[230]="MU",r[691]="FM",r[373]="MD",r[377]="MC",r[976]="MN",r[382]="ME",r[212]="MA",r[258]="MZ",r[95]="MM",r[264]="NA",r[674]="NR",r[977]="NP",r[31]="NL",r[687]="NC",r[64]="NZ",r[505]="NI",r[227]="NE",r[234]="NG",r[672]="NF",r[850]="KP",r[47]="NO",r[968]="OM",r[92]="PK",r[680]="PW",r[970]="PS",r[507]="PA",r[675]="PG",r[595]="PY",r[51]="PE",r[63]="PH",r[48]="PL",r[351]="PT",r[974]="QA",r[40]="RO",r[7]="RU",r[250]="RW",r[262]="RE",r[508]="PM",r[685]="WS",r[378]="SM",r[221]="SN",r[381]="RS",r[248]="SC",r[232]="SL",r[65]="SG",r[421]="SK",r[386]="SI",r[677]="SB",r[252]="SO",r[27]="ZA",r[82]="KR",r[211]="SS",r[94]="LK",r[249]="SD",r[597]="SR",r[268]="SZ",r[46]="SE",r[41]="CH",r[963]="SY",r[239]="ST",r[886]="TW",r[992]="TJ",r[255]="TZ",r[66]="TH",r[670]="TL",r[228]="TG",r[676]="TO",r[216]="TN",r[90]="TR",r[993]="TM",r[256]="UG",r[380]="UA",r[971]="AE",r[1]="US",r[598]="UY",r[998]="UZ",r[678]="VU",r[58]="VE",r[84]="VN",r[681]="WF",r[967]="YE",r[260]="ZM",r[263]="ZW",r[383]="XK";var a=r;t.default=a},50437:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={1:'[334,-1,"($1) $2-$3"],10',20:'["Ah","[23]"],[334,"1[0125]|[89]00"],["Bg","1[35]|[4-6]|[89][2-9]"],[9,10]',211:"333,9",212:'["[5-7]BF","5(2[015-7]|3[0-4])|[67]",1],["[58]CE",["5(2[2-489]|3[5-9]|92)|892","5(2([2-48]|9[0-7])|3([5-79]|8[0-7])|924)|892"],1],["5DD",["5(29|38)","5(29|38)[89]"],1],["[5]BBBB","5(4[067]|5[03])"],["8[09];G","8(0|9[013-9])",1],9',213:'["[5-8]BBBB","[5-8]"],["9ACBB",9],9',216:"233,8",218:'[27,"[25-79]",1],9',220:"34,7",221:'[2322,"[379]"],[3222,8],9',222:'"[2-48]ABBB",8',223:'[2222,"[246-9]"],8',224:'[2222,3],[3222,"[67]"],[8,9]',225:"2222,8",226:'[2222,"[025-7]"],8',227:'[233,"08"],[2222,"[0289]"],8',228:'[2222,"[279]"],8',229:"2222,8",230:'[34,"[2-46]|8[013]"],[44,5],[7,8]',231:'[133,"[45]"],[233,2],[234,"[23578]"],[7,8,9]',232:"26,8",233:'[234,"[235]"],9',234:'["CCd","[7-9]"],["CDe","[78]"],["CEf","[78]"],10',235:"2222,8",236:"2222,8",237:'[2222,88],[12222,"[26]"],[8,9]',238:"322,7",239:"34,7",240:'[333,"[235]"],[36,"[89]"],9',241:"[2222,0],8",242:'[234,"[02]"],[144,8],9',243:'[234,1],[333,"[89]"],9',244:'[333,"[29]"],9',245:'[333,"44|9[567]"],[34,40],[7,9]',246:"[34,3],7",247:"5",248:'[133,"[246]"],7',249:'[234,"[19]"],9',250:'["2BCC",2],["[7-9]BCC","[7-9]"],9',251:'"[1-59]ACD",9',252:'[17,"24|[67]"],["BA{5,7}","15|28|6[1-35-9]|799|9[2-9]"],[333,"3[59]|4[89]|6[24-6]|79|8[08]|90"],[8,9]',253:"2222,8",254:'["BA{5,7}","[24-6]"],[36,7],["CCd","[89]"],9',255:'["[24]ACD","[24]"],["[67]BCC","[67]"],["[89]BBD","[89]"],9',256:'[45,[202,2024]],[36,"[27-9]|4(6[45]|[7-9])"],[27,"[34]"],9',257:"2222,8",258:'["[28]ACd","2|8[2-7]"],["80ACC",80],9',260:'["[29]AG","[29]"],["800;CC",8],9',261:'[2232,"[23]"],9',262:'"[268]BBBB",9',263:'["7ACd",7],["86BCC","86[24]"],["CCd","2(1[39]|2[0157]|6[14]|7[35]|84)|329"],["[235]ACd","[23]9|54"],["[25]CA{3,5}",["(25|54)8","258[23]|5483"]],["8CF",86],["80ACD",80],[9,10]',264:'["8ACD","8[1235]"],["6ACd",6],["870;CC",870],9',265:'["2BCC",2],[3222,"[1789]"],9',266:"44,8",267:'["7ACC",7],8',268:'[44,"[027]"],8',269:"322,7",27:'[333,860],[234,"[1-9]"],9',290:"[4,5]",291:"133,7",297:"34,7",298:"6,6",299:"222,6",30:'[244,"21|7"],[46,"2(2|3[2-57-9]|4[2-469]|5[2-59]|6[2-9]|7[2-69]|8[2-49])"],[334,"[2689]"],10',31:'["[1-578]ACD","1[035]|2[0346]|3[03568]|4[0356]|5[0358]|7|8[4578]"],["[1-5]BCC","1[16-8]|2[259]|3[124]|4[17-9]|5[124679]"],["6;H","6[0-57-9]"],["66;G",66],["[89]0AA{4,7}","80|9"],[9,11]',32:"[3222,4],9",33:'[3222,8],[12222,"[1-79]"],9',34:'["[89]00;CC","[89]00"],["[5-9]BBBB","[568]|[79][0-8]"],9',350:"[35,2],8",351:'["2ACD","2[12]"],["[2-46-9]BCC","2[3-9]|[346-9]"],9',352:'[2223,20],[333,6],["BBBBb","2([0367]|4[3-8])"],["BBBA{1,5}","[3-57]|8[13-9]|9(0[89]|[2-579])|(2|80)[2-9]"],9',353:'["AdD",1],["BCd","[2569]|4[1-69]|7[14]"],[333,70],[333,81],[234,"[78]"],[433,1],[2134,8],[244,4],9',354:'[34,"[4-9]"],["3BCC",3],[7,8,9]',355:'["6[6-9];CD",6],9',356:'[44,"[2357-9]"],8',357:"26,8",358:'["CA{3,7}","([1-3]00|[6-8]0)"],["116C",116],["BA{4,10}","[14]|2[09]|50|7[135]"],["AA{4,11}","[25689][1-8]|3"],[6,7,8,9,10,11]',359:'[333,999],["BCd","48|8[7-9]|9[08]"],9',36:'["BCd","[2-9]"],9',370:'[134,"52[0-79]"],[323,"[7-9]"],[26,"37|4([15]|6[1-8])"],[35,"[3-6]"],8',371:'[233,"[269]|8[01]"],8',372:'["[3-79]BD",["[369]|4[3-8]|5([0-2]|5[0-478]|6[45])|7[1-9]","[369]|4[3-8]|5([02]|1([0-8]|95)|5[0-478]|6(4[0-4]|5[1-589]))|7[1-9]"]],["70;BD",70],["8000;CC",[800,8000]],["[458]Cd",["40|5|8(00|[1-5])","40|5|8(00[1-9]|[1-5])"]],[7,8]',373:'[233,"22|3"],["[25-7]BBC","2[13-9]|[5-7]"],["[89]BE","[89]"],8',374:'[26,"1|47"],[26,"4[1349]|[5-7]|9[1-9]"],[35,"[23]"],[323,"8|90"],8',375:'[2322,["17[0-3589]|2[4-9]|[34]","17([02358]|1[0-2]|9[0189])|2[4-9]|[34]"],"$1 $2-$3-$4"],[3222,["1(5[24]|6[235]|7[467])|2(1[246]|2[25]|3[26])","1(5[24]|6(2|3[04-9]|5[0346-9])|7([46]|7[37-9]))|2(1[246]|2[25]|3[26])"],"$1 $2-$3-$4"],[423,["1(5[169]|6[3-5]|7[179])|2(1[35]|2[34]|3[3-5])","1(5[169]|6(3[1-3]|4|5[125])|7(1[3-9]|7[0-24-6]|9[2-7]))|2(1[35]|2[34]|3[3-5])"],"$1 $2-$3"],["[89]BCD","8[01]|9"],["82ADD",82],["800;BA{2,4}",800],9',376:'[33,"[135-9]"],[44,1],[333,6],[6,9]',377:'[2222,"[39]"],[233,4],["6;BBBB",6],[332,8],[8,9]',378:'[2222,"[5-7]"],["0549;F",0,"($1) $2"],8',379:"10",380:'[333,["6[12][29]|(3[1-8]|4[136-8]|5[12457]|6[49])2|(56|65)[24]","6[12][29]|(35|4[1378]|5[12457]|6[49])2|(56|65)[24]|(3[1-46-8]|46)2[013-9]"]],[234,["4[45][0-5]|5(0|6[37])|6([12][018]|[36-8])|7|89|9[1-9]|(48|57)[0137-9]","4[45][0-5]|5(0|6(3[14-7]|7))|6([12][018]|[36-8])|7|89|9[1-9]|(48|57)[0137-9]"]],[45,"[3-6]"],["CCd","[89]"],9',381:'["[23]BA{4,9}","(2[389]|39)0"],["[1-3]AA{5,10}","1|2([0-24-7]|[389][1-9])|3([0-8]|9[1-9])"],["6AA{6,8}",6],["[89]BA{3,9}","[89]"],["7[26];A{4,9}","7[26]"],["7[08]AA{4,9}","7[08]"],[8,9,10]',382:'[233,"[2-57-9]|6[036-9]"],[8,9]',383:'[233,"[23][89]|4[3-79]"],[35,"[89]00"],333,8',385:'["1;DC",1],["[2-5]ACd","[2-5]"],["9ACd",9],["[67]ACd","[67]"],["80[01];Bc",8],["80[01];CC",8],[8,9]',386:'[1322,"[12]|3[24-8]|4[24-8]|5[2-8]|7[3-8]"],["[3-7]ACC","[37][01]|4[0139]|51|6"],["[89][09];A{3,6}","[89][09]"],["[58]BE","59|8[1-3]"],8',387:'[233,"6[1-356]|[7-9]"],[233,"[3-5]","$1 $2-$3"],[2223,6],[8,9]',389:'["2;CD",2],["[347]ACC","[347]"],["[58]BABB","[58]"],8',39:'["BdD","0[26]|55"],["0[26];DE","0[26]"],["0BdD","0[13-57-9][0159]"],["CA{3,6}",["0[13-57-9][0159]|8(03|4[17]|9[245])","0[13-57-9][0159]|8(03|4[17]|9(2|[45][0-4]))"]],["0CCD","0[13-57-9][2-46-8]"],["0CA{2,6}","0[13-57-9][2-46-8]"],["CCd",["[13]|8(00|4[08]|9[59])","[13]|8(00|4[08]|9(5[5-9]|9))"]],[344,3],[9,10]',40:'[234,"[23]1"],[333,"[23][3-7]|[7-9]"],9',41:'["[2-9]ACBB","[2-7]|[89]1"],["[89]BCC","8[047]|90"],[32322,860],9',420:'["[2-9]BCC","[2-8]|9[015-7]"],["96ACCC",96],["9ACCC","9[36]"],9',421:'["2;CCB",2,"$1/$2 $3 $4"],["[3-5]ACBB","[3-5]","$1/$2 $3 $4"],["[689]BCC","[689]"],9',423:'[322,"[237-9]"],[234,69],[333,6],7',43:'["1;A{3,12}",1],["5ADA{4,7}","5[079]"],["CA{3,10}","316|46|51|732|6(5[0-3579]|[6-9])|7([28]0)|[89]"],["DA{3,9}","2|3(1[1-578]|[3-8])|4[2378]|5[2-6]|6([12]|4[1-9]|5[468])|7(2[1-8]|35|4[1-8]|[5-79])"],[10,11,12,13]',44:'["Ee",["1(38|5[23]|69|76|94)","1((38|69)7|5(24|39)|768|946)","1(3873|5(242|39[4-6])|(697|768)[347]|9467)"]],["Df","1([2-69][02-9]|[78])"],[244,["[25]|7(0|6[024-9])","[25]|7(0|6([04-9]|2[356]))"]],[46,7],[334,"[1389]"],10',45:"2222,8",46:'["8;ccB",8],["[1-69]AcBB","1[013689]|2[0136]|3[1356]|4[0246]|54|6[03]|90"],[3222,"1[2457]|2([247-9]|5[0138])|3[0247-9]|4[1357-9]|5[0-35-9]|6([124-689]|7[0-2])|9([125-8]|3[0-5]|4[0-3])"],["7ACBB",7],["9[034]ABBC","9[034]"],[32322,"25[245]|67[3-6]"],9',47:'["[489]BBC","[489]"],["[235-7]ABBB","[235-7]"],8',48:'[2322,"[14]|2[0-57-9]|3[2-4]|5[24-689]|6[1-3578]|7[14-7]|8[1-79]|9[145]"],[333,"26|39|5[0137]|6[0469]|7[02389]|8[08]"],9',49:'["BA{3,13}","3[02]|40|[68]9"],["CA{3,12}",["2(0[1-389]|1[124]|2[18]|3[14])|3([35-9][15]|4[015])|906|(2[4-9]|4[2-9]|[579][1-9]|[68][1-8])1","2(0[1-389]|12[0-8])|3([35-9][15]|4[015])|906|2([13][14]|2[18])|(2[4-9]|4[2-9]|[579][1-9]|[68][1-8])1"]],["DA{2,11}",["[24-6]|3([3569][02-46-9]|4[2-4679]|7[2-467]|8[2-46-8])|70[2-8]|8(0[2-9]|[1-8])|90[7-9]|[79][1-9]","[24-6]|3(3(0[1-467]|2[127-9]|3[124578]|7[1257-9]|8[1256]|9[145])|4(2[135]|4[13578]|9[1346])|5(0[14]|2[1-3589]|6[1-4]|7[13468]|8[13568])|6(2[1-489]|3[124-6]|6[13]|7[12579]|8[1-356]|9[135])|7(2[1-7]|4[145]|6[1-5]|7[1-4])|8(21|3[1468]|6|7[1467]|8[136])|9(0[12479]|2[1358]|4[134679]|6[1-9]|7[136]|8[147]|9[1468]))|70[2-8]|8(0[2-9]|[1-8])|90[7-9]|[79][1-9]|3[68]4[1347]|3(47|60)[1356]|3(3[46]|46|5[49])[1246]|3[4579]3[1357]"]],[34,138],["EA{2,10}",3],["CA{5,11}",181],["CAA{4,10}","1(3|80)|9"],["Ch","1[67]"],["CA{7,12}",8],[56,[185,1850,18500]],[344,7],[47,"18[68]"],[56,"15[0568]"],[47,"15[1279]"],[38,18],["CBh","1(6[023]|7)"],[427,"15[279]"],[328,15],[7,8,9,10,11,12]',500:"5",501:'[34,"[2-8]",1],["0;800;DC",0,1],7',502:'[44,"[2-7]"],[434,1],8',503:'[44,"[267]"],[344,"[89]"],8',504:'[44,"[237-9]",1],8',505:"44,8",506:'[44,"[24-7]|8[3-9]"],[334,"[89]0",1],8',507:"[44,6,1],8",508:'"[45]ABB",6',509:"224,8",51:"[333,9],9",52:'[244,"33|5[56]|81"],[334,"[2-9]"],[1244,"1(33|5[56]|81)"],[1334,1],[10,11]',53:'["Ag",7],["BA{4,6}","[2-4]"],[17,5],8',54:'[424,["2(2[024-9]|3[0-59]|47|6[245]|9[02-8])|3(3[28]|4[03-9]|5[2-46-8]|7[1-578]|8[2-9])","2([23]02|6([25]|4[6-8])|9([02356]|4[02568]|72|8[23]))|3(3[28]|4([04679]|3[5-8]|5[4-68]|8[2379])|5([2467]|3[237]|8[2-5])|7[1-578]|8([2469]|3[2578]|5[4-8]|7[36-8]|8[5-8]))|2(2[24-9]|3[1-59]|47)","2([23]02|6([25]|4(64|[78]))|9([02356]|4([0268]|5[2-6])|72|8[23]))|3(3[28]|4([04679]|3[78]|5(4[46]|8)|8[2379])|5([2467]|3[237]|8[23])|7[1-578]|8([2469]|3[278]|5[56][46]|86[3-6]))|2(2[24-9]|3[1-59]|47)|38([58][78]|7[378])|3(4[35][56]|58[45]|8([38]5|54|76))[4-6]","2([23]02|6([25]|4(64|[78]))|9([02356]|4([0268]|5([24-6]|3[2-5]))|72|8[23]))|3(3[28]|4([04679]|3(5(4[0-25689]|[56])|[78])|58|8[2379])|5([2467]|3[237]|8([23]|4([45]|60)|5(4[0-39]|5|64)))|7[1-578]|8([2469]|3[278]|54(4|5[13-7]|6[89])|86[3-6]))|2(2[24-9]|3[1-59]|47)|38([58][78]|7[378])|3(454|85[56])[46]|3(4(36|5[56])|8([38]5|76))[4-6]"],"$1 $2-$3"],[244,1,"$1 $2-$3"],[334,"[23]","$1 $2-$3"],[334,"[68]",1],[1424,["9(2[2-469]|3[3-578])","9(2(2[024-9]|3[0-59]|47|6[245]|9[02-8])|3(3[28]|4[03-9]|5[2-46-8]|7[1-578]|8[2-9]))","9(2([23]02|6([25]|4[6-8])|9([02356]|4[02568]|72|8[23]))|3(3[28]|4([04679]|3[5-8]|5[4-68]|8[2379])|5([2467]|3[237]|8[2-5])|7[1-578]|8([2469]|3[2578]|5[4-8]|7[36-8]|8[5-8])))|92(2[24-9]|3[1-59]|47)","9(2([23]02|6([25]|4(64|[78]))|9([02356]|4([0268]|5[2-6])|72|8[23]))|3(3[28]|4([04679]|3[78]|5(4[46]|8)|8[2379])|5([2467]|3[237]|8[23])|7[1-578]|8([2469]|3[278]|5([56][46]|[78])|7[378]|8(6[3-6]|[78]))))|92(2[24-9]|3[1-59]|47)|93(4[35][56]|58[45]|8([38]5|54|76))[4-6]","9(2([23]02|6([25]|4(64|[78]))|9([02356]|4([0268]|5([24-6]|3[2-5]))|72|8[23]))|3(3[28]|4([04679]|3(5(4[0-25689]|[56])|[78])|5(4[46]|8)|8[2379])|5([2467]|3[237]|8([23]|4([45]|60)|5(4[0-39]|5|64)))|7[1-578]|8([2469]|3[278]|5(4(4|5[13-7]|6[89])|[56][46]|[78])|7[378]|8(6[3-6]|[78]))))|92(2[24-9]|3[1-59]|47)|93(4(36|5[56])|8([38]5|76))[4-6]"],"$1 $2 $3-$4"],[1244,91,"$1 $2 $3-$4"],[1334,9,"$1 $2 $3-$4"],[10,11]',55:'[244,"[1-9][1-9]","$1 $2-$3"],[254,"([14689][1-9]|2[12478]|3[1-578]|5[1-5]|7[13-579])9","$1 $2-$3"],["[3589]00;cD","[3589]00"],[10,11]',56:'[144,"2[23]"],[234,"[357]|4[1-35]|6[13-57]"],["9;DD",9],["44;CD",44],["[68]00;Cd","60|8"],["600;CBC",60],["1230;CD",1],[54,219],9',57:'[17,["1(8[2-9]|9[0-3]|[2-7])|[24-8]","1(8[2-9]|9(09|[1-3])|[2-7])|[24-8]"]],[37,3],["1;CG",["1(80|9[04])","1(800|9(0[01]|4[78]))"]],[8,10]',58:"[37,-1,1],10",590:'["[56]90;BD",-1,"$1 $2-$3"],9',591:'[17,"[23]|4[46]"],[8,"[67]"],[324,8],8',592:"34,7",593:'[134,"[247]|[356][2-8]",1],[234,9],["1800;Cd",1],[8,9]',594:"3222,9",595:'["BCd","([26]1|3[289]|4[124678]|7[123]|8[1236])"],["CA{3,6}","[2-9]0"],[36,"9[1-9]"],[234,8700],[333,"[2-8][1-9]"],9',596:"3222,9",597:'[34,"[6-8]",1],7',598:'[233,9],[44,"[24]"],8',599:'[34,"[13-7]"],["9;CD",9],[7,8]',60:'["3;DD",3,"$1-$2 $3"],["[18]ACd","1[02-46-9][1-9]|8","$1-$2 $3"],["1;[36-8]00;BD","1[36-8]0",1],["11;DD",11,"$1-$2 $3"],["15[49];CD",15,"$1-$2 $3"],[9,10]',61:'["BCA{2,4}",16],[333,"14|[45]"],[144,"[2378]"],[433,"1(30|[89])"],9',62:'["BA{5,9}","2[124]|[36]1"],["CA{5,7}",800],["CA{5,8}","[2-79]"],["CdC","8[1-35-9]",1],["CA{6,8}",1],[334,804],[3133,80],["CDe",8,1],[2434,0],[9,10,11,12]',63:'["DA{4,6}",["3(23|39|46)|4(2[3-6]|[35]9|4[26]|76)|544|88[245]|(52|64|86)2","3(230|397|461)|4(2(35|[46]4|51)|396|4(22|63)|59[347]|76[15])|5(221|446)|642[23]|8(622|8([24]2|5[13]))"]],[334,"[89]"],[434,1],["DbCD",1],10',64:'[323,"[89]0"],[134,"24|[346]|7[2-57-9]|9[2-9]","$1-$2 $3"],["CCd","2(10|74)|[59]|80"],["BdD","2[028]"],["BCA{3,5}","2([169]|7[0-35-9])|7|86"],[8,9,10]',65:'["[3689]CD","[369]|8[1-9]"],["1[89]00;CD","1[89]"],["7000;DC",70],["800;CD",80],8',66:'["BCd","14|[3-9]"],[433,1],9',670:"[44,7],8",672:"[24,1],[15,3],[5,6]",673:'"[2-578]BD",7',674:"34,7",675:'[34,"[13-689]|27"],[44,"20|7"],[7,8]',676:'[34,"7[5-9]|8[47-9]"],[43,0],7',677:'[25,"[7-9]"],7',678:'[34,"[579]"],7',679:'[34,"[35-9]"],[434,0],7',680:"34,7",681:"222,6",682:"23,5",683:"4",685:'["8Bd",8],["7AE",7],[6,7]',686:"8",687:'[222,"[2-46-9]|5[0-4]","$1.$2.$3"],6',688:"[6,7]",689:'[2222,"4[09]|8[79]"],[222,44],[6,8]',690:"[4,5,6,7]",691:"34,7",692:"[34,-1,1],7",7:'[4222,["7(1[0-8]|2[1-9])","7(1([0-6]2|7|8[27])|2(1[23]|[2-9]2))","7(1([0-6]2|7|8[27])|2(13[03-69]|62[013-9]))|72[1-57-9]2"]],[5122,["7(1[0-68]|2[1-9])","7(1([06][3-6]|[18]|2[35]|[3-5][3-5])|2([13][3-5]|[24-689]|7[457]))","7(1(0([356]|4[023])|[18]|2(3[013-9]|5)|3[45]|43[013-79]|5(3[1-8]|4[1-7]|5)|6(3[0-35-9]|[4-6]))|2(1(3[178]|[45])|[24-689]|3[35]|7[457]))|7(14|23)4[0-8]|71(33|45)[1-79]"]],[334,7],[3322,"[3489]","$1 $2-$3-$4"],10',81:'[334,800,1],["DBd","0077",1],[424,"0088",1],["DCd","00(37|66)",1],["DDe","00(37|66)",1],["DEf","00(37|66)",1],["DFg","00(37|66)",1],[244,"[2579]0|80[1-9]",1],10',82:'["AdD",2,1],[234,"60|8",1],["BdD","[1346]|5[1-5]",1],[244,"[57]",1],[533,["003","0030"]],[254,5,1],["EdD",0],[5234,0],[9,10]',84:'[244,"2[48]"],[343,"2[0-35-79]"],["[89]ACBB","8(8|9[89])|9"],["1[2689]ACD","1([26]|8[68]|99)"],["[3578]ACD","[357]|8[1-5]"],["86[89];CC","86[89]"],["1[89]00;A{4,6}",["1[89]0","1[89]00"]],[9,10]',850:"[334,1],10",852:'[44,"[235-7]|[89](0[1-9]|[1-9])"],["800;CC",800],["900;BCC",900],["900;A{2,5}",900],8',853:'"[268]CD",8',855:'["BCd","[1-9]"],[433,1],[8,9]',856:"[2233,2],10",86:'["21;DA{4,6}",21],[344,"3(11|7[179])|4([15]1|3[1-35])|5(1|2[37]|3[12]|51|7[13-79]|9[15])|7(31|5[457]|6[09]|91)|8([57]1|98)"],[434,[807,8078]],[344,"1[3-578]"],["10800;CD",[108,1080,10800]],["Ch",950],11',880:'["CA{3,7}","3([67]|8[013-9])|4(6[168]|7|[89][18])|5(6[128]|9)|6(28|4[14]|5)|7[2-589]|8(0[014-9]|[12])|9[358]|(3[2-5]|4[235]|5[2-578]|6[0389]|76|8[3-7]|9[24])1|(44|66)[01346-9]",1],["DA{3,6}","[13-9]",1],10',886:'["AdD","[25][2-8]|[346]|7[1-9]|8[237-9]"],[234,"[258]"],[333,9],[244,7],9',90:'[334,"512|8[0589]|90"],[3322,["5([0-59]|61)","5([0-59]|616)","5([0-59]|6161)"]],[3322,"[24][1-8]|3[1-9]"],10',91:'[55,["600|7([02-8]|19|9[037-9])|8(0[015-9]|[1-9]|20)|9","600|7([078]|19[0-5]|2([02356-9]|[14][017-9]|9[389])|3([025-9]|1[07-9]|[34][017-9])|4([0-35689]|[47][017-9])|5([02346-9]|1[017-9]|5[017-9])|6([02-9]|1[0-257-9])|9([089]|31|7[02-9]))|8(0([01589]|6[67]|7[02-9])|1([0-57-9]|6[07-9])|2(0[078]|[14][07-9]|[235-9])|3([0357-9]|[126][07-9]|4[1-9])|[45]|6([02457-9]|[136][07-9])|7([078][07-9]|[1-69])|8([0-25-9]|3[07-9]|4[047-9])|9([02-9]|1[027-9]))|9","600|7(0|19[0-5]|2([0235679]|[14][017-9]|8([0-569]|[78][089])|9[389])|3([05-8]|1([089]|7[5-9])|2([5-8]|[0-49][089])|3[017-9]|4([07-9]|11)|9([01689]|[2345][089]|40|7[0189]))|4([056]|1([0135-9]|[23][089]|2[089]|4[089])|2(0[089]|[1-7][089]|[89])|3([0-8][089]|9)|4([089]|11|7[02-8])|7([089]|11|7[02-8])|8([0-24-7][089]|[389])|9([0-7][089]|[89]))|5([0346-9]|1[017-9]|2([03-9]|[12][089])|5[017-9])|6([0346-9]|1[0-257-9]|2([0-4].|[5-9][089])|5([0-367][089]|[4589]))|7(0([02-9]|1[089])|[1-9])|8([0-79]|8(0[0189]|11|8[013-9]|9))|9([089]|313|7([02-8]|9[07-9])))|8(0([01589]|6[67]|7([02-8]|9[05-9]))|1([02-57-9]|1([0-35-9]|4[0-46-9])|6([089]|7[02-8]))|2(0([08]|7[02])|[14]([089]|7[02-8])|[235-9])|3([0357-9]|1([089]|7[02-6])|2([09]|77|8[0-689])|4[1-9]|6([089]|7[02-7]))|[45]|6([02457-9]|1([089]|7[02-8])|3([089]|7[02358])|6([08]|7[02-8]|9[01]))|7(0[07-9]|[1-69]|7([089]|7[02-8])|8([089]|7[02-8]))|8([0-25-9]|3([089]|7[02-8])|4([0489]|7[02-68]))|9([02-9]|1([0289]|7[2-6])))|9"]],[244,"11|2[02]|33|4[04]|79[1-9]|80[2-46]"],[334,"1(2[0-249]|3[0-25]|4[145]|[569][14]|7[1257]|8[1346]|[68][1-9])|2(1[257]|3[013]|4[01]|5[0137]|6[0158]|78|8[1568]|9[14])|3(26|4[1-3]|5[34]|6[01489]|7[02-46]|8[159])|4(1[36]|2[1-47]|3[15]|5[12]|6[0-26-9]|7[0-24-9]|8[013-57]|9[014-7])|5(1[025]|[36][25]|22|4[28]|5[12]|[78]1|9[15])|6(12|[2345]1|57|6[13]|7[14]|80)|7(12|2[14]|3[134]|4[47]|5[15]|[67]1|88)|8(16|2[014]|3[126]|6[136]|7[078]|8[34]|91)"],[433,"1([23579]|[468][1-9])|[2-8]"],[2343,"008"],[334,140],[424,[160,1600]],["DA{2,4};D",[180,1800]],["DdD",[186,1860]],[4333,"18[06]"],10',92:'["Bh","(2[125]|4[0-246-9]|5[1-35-7]|6[1-8]|7[14]|8[16]|91)[2-9]"],["Cg",["2(3[2358]|4[2-4]|9[2-8])|45[3479]|54[2-467]|60[468]|72[236]|8(2[2-689]|3[23578]|4[3478]|5[2356])|9(2[2-8]|3[27-9]|4[2-6]|6[3569]|9[25-8])","9(2[3-8]|98)|(2(3[2358]|4[2-4]|9[2-8])|45[3479]|54[2-467]|60[468]|72[236]|8(2[2-689]|3[23578]|4[3478]|5[2356])|9(22|3[27-9]|4[2-6]|6[3569]|9[25-7]))[2-9]"]],[55,58],[37,3],[2333,"2[125]|4[0-246-9]|5[1-35-7]|6[1-8]|7[14]|8[16]|91"],[3333,"[24-9]"],10',93:'["[2-7]ACD","[2-7]"],9',94:'[234,7],[333,"[1-689]"],9',95:'["ACd","[12]"],["BCd","[4-7]|8[1-35]"],["ACA{4,6}","9(2[0-4]|[35-9]|4[137-9])"],[144,2],[334,8],[1333,92],[154,9],[8,9,10]',960:'[34,"[3467]|9([1-9]|0[1-9])",1],[334,"[89]00"],7',961:'[133,"[13-69]|7([2-57]|62|8[0-7]|9[04-9])|8[02-9]"],[233,"[7-9]"],[7,8]',962:'["7;DD","7[457-9]"],["Cf","70|8[0158]|9"],9',963:'["BCd","[1-5]"],["9BCC",9],9',964:'["BCd","[2-6]"],[334,7],[9,10]',965:'["Dd","[169]|2([235]|4[1-35-9])|52"],[35,"[25]"],8',966:'[45,9],[234,1],[234,5],["CCd",81],[334,8],9',967:'["7BCC","7[0137]"],9',968:'["CA{4,6}","[58]"],[26,2],[44,"[79]"],8',970:'["5[69]ACC",5],["1[78]00;CC","1[78]"],9',971:'["CA{2,9}","60|8"],[315,"[479]"],[234,5],9',972:'[234,"[57]",1],[433,12,1],[46,159,1],[1333,"1[7-9]",1],["CbCD",15,"$1-$2 $3-$4"],9',973:"44,8",974:'["[3-7]CD","[3-7]"],8',975:'[2222,"1|77"],8',976:'["[12]ABD","[12]1"],["[12]2Af","[12]2[1-3]"],["[12]CE",["[12](27|[3-5])","[12](27|[3-5].)2"]],[44,"[57-9]"],["[12]De",["[12](27|[3-5])","[12](27|[3-5].)[4-9]"]],8',977:'["9BG","9(6[013]|7[245]|8)",1],10',98:'[244,"[1-8]"],["CCd",9],10',992:'[612,[331,3317]],[324,"[34]7|91[78]"],[414,3],[234,"[457-9]"],9',993:'[2222,12,"$1 $2-$3-$4"],[26,6],[3122,"13|[2-5]","$1 $2-$3-$4"],8',994:'[3222,9],[2322,["[12]|365","[12]|365","[12]|365([0-46-9]|5[0-35-9])"]],[2322,"[3-8]"],9',995:'[3222,"[348]"],[333,7],[3222,5],9',996:'[45,"3(1[346]|[24-79])"],[333,"[235-79]"],["CCAc",8],9',998:'[2322,"[679]"],[7,8,9]'}},88911:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createDeflate=function(e={}){return new i(e)},t.inflate=function(e){return(0,a.decompressSync)(e)},t.GzipWrapper=void 0;var a=r(37993);class i extends a.Gzip{constructor(e){super(e),this._chunks=[],this.ondata=(e,t)=>{if(this._chunks.push(e),t){var r=0;this._chunks.forEach((e=>{r+=e.length}));var a=new Uint8Array(r),i=0;this._chunks.forEach((e=>{a.set(e,i),i+=e.length})),this._result=a}}}push(e,t){if(null!=this._result)throw new Error("Tried to push chunk to compressor after final block");e instanceof Uint8Array?super.push(e,t):e instanceof ArrayBuffer?super.push(new Uint8Array(e),t):super.push((0,a.strToU8)(e),t)}result(){if(null==this._result)throw new Error("Tried to access result before adding final block");return this._result}}t.GzipWrapper=i},61212:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.randomHex=function(e){var t=new Uint8Array(e);return self.crypto.getRandomValues(t),i(t)},t.toHex=i,t.toLowerCaseHex=function(e){for(var t=[],r=0;r<e.length;r++){var i=e[r];t.push(a[i>>4],a[15&i])}return String.fromCharCode.apply(String,t)},t.parseHex=function(e){var t=s(e);if(t.length%2!=0)throw new Error(`parseHex given hex "${t}" which is not a multiple of 8-bits.`);for(var r=new Uint8Array(t.length>>1),a=0,i=0;a<t.length;a+=2,i++)r[i]=n(t,a)<<4|n(t,a+1);return r.buffer},t.hexAt=n,t.hexOrThrow=s,t.bytesToBuffer=function(e){var t=e.buffer;return 0===e.byteOffset&&e.length===t.byteLength?t:t.slice(e.byteOffset,e.byteOffset+e.length)},t.bytesToDebugString=function(e){var t=!0,r=e.length;for(;t&&r;){var a=e[--r];t=32<=a&&a<127}return t?JSON.stringify(String.fromCharCode.apply(String,e)):i(e)},t.createHexLong=function(e,t=!1){var r=s(e);return function(e,t){if(e.length>t)throw new Error(`"${e}" is longer than ${4*t} bits.`)}(r,16),`${t?"-":""}0x${o(r,16)}`},t.createHexLongFrom32Bits=function(e,t,r=!1){var a=d(e),i=d(t);return`${r?"-":""}0x${a}${i}`},t.hexLongToHex=function(e){return e.substring(e.indexOf("0x")+2)},t.hexLongIsNegative=l,t.negateHexLong=function(e){return l(e)?e.slice(1):"-"+e},t.HEX_LOWER=t.NUM_HEX_IN_LONG=void 0;t.NUM_HEX_IN_LONG=16;var r=[48,49,50,51,52,53,54,55,56,57,65,66,67,68,69,70],a=[48,49,50,51,52,53,54,55,56,57,97,98,99,100,101,102];function i(e){for(var t=[],a=0;a<e.length;a++){var i=e[a];t.push(r[i>>4],r[15&i])}return String.fromCharCode.apply(String,t)}function n(e,t){var r=e.charCodeAt(t);return r<=57?r-48:r<=70?10+r-65:10+r-97}function s(e){if(/[^0-9a-fA-F]/.test(e))throw new Error(`"${e}" is not a valid hex`);return e}function o(e,t){for(var r=t-e.length,a=e,i=0;i<r;i++)a="0"+a;return a}function l(e){return"-"===e[0]}function d(e){if(e>4294967295||e<-4294967296)throw new Error("uint32ToLowerCaseHex given number over 32 bits");return o((e>=0?e:4294967296+e).toString(16),8)}t.HEX_LOWER=a},67368:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.inflatePhoneRegex=function(e){var t;t="number"==typeof e?String(e).split("").map((e=>".".repeat(Number(e)))).join(")("):e.replace(/;|[a-zA-Z]+/g,(e=>";"===e?")(":e.split("").map((e=>{var t=e.charCodeAt(0);return t>=97?".".repeat(t-96)+"?":".".repeat(t-64)})).join(")(")));return`(${t})`}},11219:(e,t,r)=>{"use strict";var a=r(34398);Object.defineProperty(t,"__esModule",{value:!0}),t.toJid=function(e){return`${e}${s}`},t.toGroupJid=function(e){return`${e}@g.us`},t.toBroadcastJid=function(e){return`${e}@broadcast`},t.groupIdFromJid=function(e){if(!e.endsWith(o))throw new Error(`groupId called with non-group jid "${e}"`);return e.slice(0,-o.length)},t.phoneNumberFromJid=l,t.interpretAsUserJid=d,t.interpretAsGroupJid=function(e){return e.endsWith(o)?e:null},t.extractUserJid=function(e){var[t,r]=e.split("@");return`${t=(t=t.split(":")[0]).split(".")[0]}@${r}`},t.extractDeviceId=u,t.toDeviceJid=c,t.defaultDeviceJidForUser=function(e){return c(e,0)},t.isPrimaryDevice=function(e){return 0===u(e)},t.interpretAsDeviceId=function(e){return e},t.parseJidParts=p,t.fullFormDeviceJidString=function(e){var{user:t,agent:r="0",device:a="0",server:i}=p(e);return`${t}.${r}:${a}@${i}`},t.stripAgentIdFromDeviceJid=function(e){var{user:t,device:r="0",server:a}=p(e);return`${t}:${r}@${a}`},t.extractFromJid=function(e){switch(e.jidType){case"user":return e.userJid;case"group":return e.groupJid;case"status":return e.statusJid;case"device":return e.deviceJid;case"broadcast":return e.broadcastJid;default:return(0,i.default)(e.jidType)}},t.interpretAndValidateJid=function(e){return e===n?{jidType:"status",statusJid:n}:h.test(e)?{jidType:"user",userJid:e}:m.test(e)?{jidType:"device",deviceJid:e}:f.test(e)?{jidType:"group",groupJid:e}:_.test(e)?{jidType:"broadcast",broadcastJid:e}:{jidType:"unknown"}},t.asChatJid=function(e){return e===n?null:e},t.switchOnMulticastJidType=function(e,t){if(e===n)return t.multicast(e);return g(e,{user:t.user,group:t.multicast})},t.switchOnJidType=function(e,t){if(e===n)return t.status();return g(e,{user:t.user,group:t.group})},t.switchOnChatJidType=g,t.asStatusJid=function(e){return e===n?n:null},t.asMulticastJid=function(e){return null==d(e)?e:null},t.DEFAULT_DEVICE_ID=t.SURVEY_USER_JID=t.GROUP_CALL_DOMAIN=t.GROUP_DOMAIN=t.USER_DOMAIN=t.STATUS_JID=void 0;var i=a(r(87031)),n="status@broadcast";t.STATUS_JID=n;var s="@s.whatsapp.net";t.USER_DOMAIN=s;var o="@g.us";t.GROUP_DOMAIN=o;t.GROUP_CALL_DOMAIN="@call";function l(e){if(!e.endsWith(s))throw new Error(`phoneNumberFromJid called with non-user jid "${e}"`);return e.slice(0,-s.length)}function d(e){return e.endsWith(s)?e:null}function u(e){return parseInt(e.split(":")[1],10)}function c(e,t){return`${l(e)}:${t}${s}`}t.SURVEY_USER_JID="16505361212@s.whatsapp.net";function p(e){var[t,r]=e.split("@"),[a,i]=t.split(":"),[n,s]=a.split(".");return{user:n,device:i,agent:s,server:r}}t.DEFAULT_DEVICE_ID=0;var h=/^(0|(?!10)[1-9][0-9]{4,19})@s.whatsapp.net$/,f=/^([1-9][0-9]{0,19}|(?!10)[1-9][0-9]{4,19}-[1-9][0-9]{9})@g.us$/,_=/^[0-9]+@broadcast$/,m=/^(0|(?!10)[1-9][0-9]{4,19}(\.[0-9]{1,2})?(:[0-9]{1,2}))@s.whatsapp.net$/;function g(e,t){var r;if(e.endsWith(s)?r=t.user:e.endsWith(o)&&(r=t.group),!r)throw new Error(`Can not switch on chat jid ${e}`);return r(e)}},20595:(e,t,r)=>{"use strict";var a=r(34398);Object.defineProperty(t,"__esModule",{value:!0}),t.findCC=p,t.formatPhone=h,t.extractDigits=function(e){var t=e.match(/\d+/g);return null!=t?t.join(""):""},t.isPotentiallyPhoneNumber=function(e){return f.test(e)},t.isPotentiallyValid=function(e,t){if(!/^\d+$/.test(t))return!1;var r=u[e]||c(e);return!!r&&("number"==typeof r.lengths?r.lengths===t.length:r.lengths.includes(t.length))},t.formattedPhoneNumber=function(e){return h((0,s.phoneNumberFromJid)(e))},t.phoneCC=function(e){return p(e)};var i=a(r(50437)),n=r(67368),s=r(11219),o=/^(1|2[07]|3[0-469]|4[013-9]|5[1-8]|6[0-6]|7|8[1246]|9[0-58])/,l=new Map;class d{constructor(e){var t;if(Array.isArray(e)){t=e[0];var r=e[1];null!=r&&-1!==r&&(Array.isArray(r)||(r=[r]),this._leadins=r.map((function(e){return new RegExp("^("+e+")")}))),this._formatString=e[2]}else t=e;this._regex=new RegExp(`^${(0,n.inflatePhoneRegex)(t)}$`)}_testAndFormat(e){if(!this._regex.test(e)||!this._checkLeadins(e))return!1;if("string"==typeof this._formatString)return e.replace(this._regex,this._formatString);var t=this._regex.exec(e);return null!=t?t.slice(1).join(null!=this._formatString?"-":" "):void 0}_checkLeadins(e){return!this._leadins||this._leadins.some((function(t){return t.test(e)}))}}var u={};function c(e){var t=null!=i.default[e]?JSON.parse(`[${i.default[e]}]`):null;if(null==t)return null;var r=t.pop();return u[e]={lengths:r,formats:t.map((function(e){return new d(e)}))}}function p(e){var t=e.match(o);return t?t[0]:e.length>=3?e.substring(0,3):e}function h(e){var t=l.get(e);return null==t&&(t=function(e){var t=e.length>0&&"+"===e[0]?e.substring(1):e,r=p(t);if(!r)return t;var a=t.substring(r.length),i=u[r]||c(r);if(!i)return"+"+r+" "+a;for(var n=i.formats,s=0;s<n.length;s++){var o=n[s]._testAndFormat(a);if(null!=o&&!1!==o&&""!==o)return"+"+r+" "+o}return"+"+r+" "+a}(e),l.set(e,t)),t}var f=/^\+*[\d ()]+$/},2015:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.nullaryCacheWhilePending=function(e){var t=null,r=()=>(t||(t=(0,a.callSyncPromise)(e).finally((()=>{t=null}))),t);return r.isPending=()=>!!t,r},t.cacheWhilePending=function(e,t){var r=new Map;return a=>{var i,n=e(a),s=r.get(n);if(s)return s;try{i=Promise.resolve(t(a))}catch(e){i=Promise.reject(e)}var o=i.finally((()=>{r.delete(n)}));return r.set(n,o),o}},t.preventGarbageCollection=function(e){i.add(e),e.finally((()=>{i.delete(e)}))};var a=r(76331);var i=new Set},64491:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.length=function(e){var t=e.match(r);return t?t.length:0},t.substring=function(e,t=0,a){var i=e.match(r);return i?i.slice(Math.max(0,t),Math.max(0,a)).join(""):""},t.toArray=function(e){return e.match(r)||[]},t.astralRange=void 0;var r=/\ud83c[\udffb-\udfff](?=\ud83c[\udffb-\udfff])|(?:[^\ud800-\udfff][\u0300-\u036f\ufe20-\ufe23\u20d0-\u20f0]?|[\u0300-\u036f\ufe20-\ufe23\u20d0-\u20f0]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff])[\ufe0e\ufe0f]?(?:[\u0300-\u036f\ufe20-\ufe23\u20d0-\u20f0]|\ud83c[\udffb-\udfff])?(?:\u200d(?:[^\ud800-\udfff]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff])[\ufe0e\ufe0f]?(?:[\u0300-\u036f\ufe20-\ufe23\u20d0-\u20f0]|\ud83c[\udffb-\udfff])?)*/g;t.astralRange=r},15215:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.findSuspiciousCharacters=function(e,t,r,o){var l,p=e.split("."),h=!1;if(p.forEach((e=>{if(h=!e.match(c)){if(l)return null;l=e}})),null==l||h)return null;for(var f=[],_=!0,m=(0,a.toArray)(l),g=0;g<m.length;g++){var v=m[g];if(!(_=_&&u(v))&&n[v]){if(f.length>=2)return null;f.push(v)}}if(_)return d(r)||d(t)||o.some((e=>function(e){return s.has(e)}(e)))?null:new Set(m);if(!f.length)return null;var E=f.filter((e=>{var a=n[e];if(null==a)return!1;if(o.some((e=>a.includes(e))))return!1;for(var s=new Set,l=0;l<a.length;l++){var d=i.LANGUAGE_TO_REGIONS[a[l]];if(null!=d)for(var u=0;u<d.length;u++)s.add(d[u])}return!s.has(r)&&!s.has(t)}));return E.length?new Set(E):null};var a=r(64491),i=r(24236),n={:["ast","ksf","bas","ca","cs","dua","nl","ee","ewo","fo","fr","gl","kl","hu","is","ga","dyo","kea","kkj","nmg","lkt","lag","ln","lu","mas","nnh","jgo","pt","qu","seh","sk","es","to","vai","vi","wae","cy","fy","yav","yo"],:["af","agq","bss","bfd","bas","bkv","btt","nl","igb","ewo","fr","fur","gaj","gby","kl","jab","atg","jbu","kkj","naq","ksh","ku","nmb","lmp","ln","mda","mg","mas","mzm","jgo","nin","ann","ro","sg","scn","srn","yer","tr","wa","cy","yav","yle"],:["agg","ast","az","br","ca","co","cs","nl","etr","et","fr","gl","de","tof","god","hu","tbd","geb","ksh","kup","nds","lb","arn","oc","sg","sk","es","gsw","dts","tr","tk","vo","wa","wae","fy","yll"],:["mt"],:["agq","bss","bfd","bas","bkv","btt","ddn","igb","kjy","ich","gux","haw","jab","iby","idu","jbu","kub","nmg","lv","mda","mi","mas","mql","nin","prg","gd","to","yba","yav"],:["az","crh","tr"],:["lv"],:["dsb","nv","pl","hsb"],:["bs","hr","cs","dzg","et","fi","smn","geb","khq","ses","kun","lkt","lv","lt","dsb","se","nso","prg","sr","sh","sms","sk","sl","taq","twq","tuq","hsb","wqe","dje"],:["ckl","ank","ha","ikx","kai","hia","mbu","anc","nin","pip","tal","tan","wja","wji"],:["naq"],:["naq"],:["liv"],:["fmp","dud","tmh"],:["fub","yay","bkc","bjt","bcn","bas","bsq","bmq","fue","bys","bwr","cky","fuq","ckl","asg","dbq","dnj","dgh","dow","dua","enn","ff","gby","gba","gmm","ank","gde","gkp","jgk","ha","hbb","ikx","kkj","hig","kzr","kai","kpe","nmg","hia","ffm","mbo","mbu","mif","mzm","mua","sur","anc","fuv","nin","dgi","pbi","pip","fuf","cla","sav","srr","sld","sok","tal","tan","yer","ttr","tik","kdl","tsw","vai","vut","wja","wji","fuh","gnd"],:["tzm","kab","okr","shi","tmh","taq"],:["tzm","kab","shi"],:["tzm","kab","shi","tmh","taq"],:[],:["izi","yaz","blt","vi"],:["yay","bom","bin","mfn","dzg","igb","enn","gkn","iby","ikk","ikw","izi","okr","yaz","blt","tan","tuq","vi","yo"],:["avu","mfn","igb","enn","iby","ig","ige","ikk","ikw","izi","okr","blt","tan","vi"]},s=new Set(["abq","ab","ady","av","az","ba","be","bs","bg","bua","ce","ckt","cu","cv","crh","dar","dng","myv","evn","gag","inh","kbd","xal","krc","kaa","kk","kjh","kca","ky","kv","koi","kpy","kum","lbe","lez","mk","mns","chm","mdf","mn","ttt","gld","yrk","nog","os","ru","rue","sr","sh","cjs","alt","tab","tg","tt","tkr","tk","tyv","ude","udm","uk","uz","mrj","sah"]),o=new Set(["374","994","375","387","359","995","7","383","996","389","373","976","382","381","992","993","380","998"]),l="";function d(e){return o.has(e)}function u(e){return l.includes(e)}var c=new RegExp("^[a-z0-9-]+$")},24236:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LANGUAGE_TO_REGIONS=void 0;t.LANGUAGE_TO_REGIONS={fub:["237","235","234"],af:["237","27"],agq:["237"],yay:["234"],bss:["237"],agg:["675"],ast:["34"],avu:["243","211"],az:["994"],bkc:["237","241"],ksf:["237"],bfd:["237"],bjt:["221"],bcn:["234"],bas:["237"],bsq:["231"],bkv:["234"],bom:["234"],btt:["234"],bin:["234"],bmq:["226","223"],bs:["387","385","383","382","381"],fue:["229","228"],br:["33"],bys:["234"],bwr:["234"],cky:["234"],ca:["376","33","39","34"],tzm:["212"],fuq:["234"],ckl:["234"],asg:["234"],co:["33","39"],crh:["7"],hr:["387","385","383","382","381"],mfn:["234"],cs:["420","421"],dbq:["237","234"],dnj:["225","231"],dzg:["235","227"],ddn:["229"],dgh:["234"],dow:["237"],dua:["229"],nl:["297","32","599","31","1","597"],igb:["234"],etr:["675"],enn:["234"],kgy:["675"],et:["372"],ich:["234"],ee:["229","233","228"],ewo:["237"],fo:["298"],fmp:["237"],fi:["358","46"],fr:["32","229","226","257","237","1","236","242","243","235","269","253","240","33","241","509","225","352","261","223","377","227","250","221","248","41","228","678"],fur:["39"],ff:["237","224","222","221"],gaj:["675"],gl:["34"],gby:["234"],gba:["236"],gmm:["237"],de:["43","32","49","423","352","41"],tof:["675"],god:["225"],ank:["234"],gkn:["234"],gux:["229","226","227","228"],gde:["237","234"],gkp:["224"],kl:["299"],jgk:["234"],ha:["229","237","235","233","225","227","234","249","228"],haw:["1"],hbb:["234"],hu:["36"],dud:["234"],jab:["234"],iby:["234"],is:["354"],idu:["234"],ig:["240"],ige:["234"],ikx:["256"],ikk:["234"],ikq:["234"],smn:["358"],ga:["353","44"],atg:["234"],izi:["234"],dyo:["220","221"],jbu:["237","234"],kab:["213"],kea:["238"],tbd:["675"],hig:["234"],kai:["234"],kkj:["237","236","242"],kzr:["237","235"],naq:["264"],geb:["675"],okr:["234"],ksh:["49"],ses:["223"],khq:["223"],kun:["291","251"],kup:["675"],kub:["237","234"],kpe:["224","231"],nmg:["237","240"],ku:["963","90"],lkt:["1"],hia:["234"],lag:["255"],lv:["371"],lmp:["237"],ln:["242","243"],liv:[],lt:["370"],yaz:["234"],nds:["55","49","31"],dsb:["49"],lu:["243"],lb:["32","33","49","352"],mda:["234"],mb:["261"],mt:["356"],mi:["64"],arn:["56"],mas:["254","255"],ffm:["223"],mql:["229","228"],mbo:["237"],mbu:["234"],mif:["237"],mzm:["234"],mua:["237","235"],sur:["234"],nv:["1"],anc:["234"],nnh:["237"],jgo:["237"],fuv:["237","234"],nin:["234"],dgi:["226"],se:["358","46","47"],nso:["27"],ann:["234"],oc:["33","39","377","34"],pbi:["237"],pip:["234"],pl:["48"],pt:["244","55","238","240","245","853","258","351","239","670"],prg:[],fuf:["224","223","221","232"],qu:["54","591","57","593","51"],ro:["373","40"],cla:["234"],sav:["221"],sg:["236","235","243"],gd:["44"],seh:["258"],sr:["387","385","383","382","381"],sh:["387","385","383","382","381"],srr:["220","221"],sch:["39"],sld:["226"],sms:["358"],sk:["420","421"],sl:["386"],sok:["235"],es:["54","501","591","56","57","506","53","593","503","240","502","504","52","505","507","595","51","34","1","598","58"],srn:["597"],gsw:["43","33","49","423","41"],shi:["212"],tal:["234"],tmh:["223"],taq:["226","223"],tan:["234"],twq:["227"],blt:["856","84"],yer:["234"],tuq:["235","218","227","234"],ttr:["234"],tik:["237"],to:["676"],dts:["223"],kdl:["234"],tsw:["234"],tr:["90"],tk:["993"],hsb:["49"],vai:["231","232"],vi:["855","84"],vo:[],vut:["237","234"],wja:["234"],wa:["32"],wae:["43","39","423","41"],wji:["234"],cy:["44"],fy:["31"],fuh:["229","226","227"],yba:["234"],yav:["237"],yle:["675"],yll:["675"],yo:["229","234"],dje:["227"],gnd:["237"]}},16680:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.findSuspiciousCharacters=function(e,t,r,s){var o=e.match(n),l=o&&o[1];if(null==l)return null;var d=(0,i.phoneCC)(r),u="whatsapp"===t?"":(0,i.phoneCC)(t),c=s.map((e=>e.toLowerCase()));return(0,a.findSuspiciousCharacters)(l,u,d,c)};var a=r(15215),i=r(20595),n=/^(?:https?:\/\/)?([^/?#]+)(?:[/?#]|$)/i},95334:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getClockSkew=function(){return p},t.setClockSkew=function(e){p=e},t.toHttpHeaderDate=function(e){return y(e).toUTCString()},t.castToUnixTime=h,t.castLongIntToUnixTime=function(e){return"number"!=typeof e?(0,a.hexLongIsNegative)(e)?u:d:h(e)},t.isOverflowTime=function(e){return e<u||e>d},t.timeoutFor=function(e,t){var r=_(),a=Math.max(e+t-r,0);return Math.min(1e3*a,~(1<<31))},t.futureUnixTime=function(e,t){var r=null!=t?t:_();return h(Math.ceil(r+Math.max(e,0)))},t.pastUnixTime=function(e,t){var r=null!=t?t:_();return h(Math.ceil(r-Math.max(e,0)))},t.cappedMillisecondsUntil=f,t.delayUntil=function(e){var t=f(e);return new Promise((e=>{setTimeout(e,t)}))},t.unixTime=_,t.midnight=function(){return h((new Date).setHours(0,0,0,0)/1e3-p)},t.midnightOn=function(e){return h(y(e).setHours(0,0,0,0)/1e3-p)},t.unixTimeMs=function(){return Date.now()-1e3*p},t.secondsUntil=m,t.isInFuture=function(e){return m(e)>0},t.monotonicTime=g,t.monotonicTimeSince=v,t.oldest=function(e,t){return e<t?e:t},t.timeSince_USE_ONLY_IF_APPROVED=function(e){return Math.max(_()-e,0)},t.unskewedDate_USE_ONLY_IF_APPROVED=function(){return new Date},t.happenedWithinAt=E,t.happenedWithin=function(e,t){return E(_(),e,t)},t.toDate=y,t.sameDay=function(e,t){if(Math.abs(e-t)>n)return!1;var r=c.time===e?c.day:y(e+p).getDay(),a=c.time===t?c.day:y(t+p).getDay();return c.time=t,c.day=a,r===a},t.isWithinNext24h=function(e){return e-_()<=n},t.MonotonicTimer=t.MAX_INT=t.DUMMY_UNIXTIME=t.WEEK_MILLISECONDS=t.DAY_MILLISECONDS=t.HOUR_MILLISECONDS=t.YEAR_SECONDS=t.WEEK_SECONDS=t.DAY_SECONDS=t.HOUR_SECONDS=void 0;var a=r(61212),i=3600;t.HOUR_SECONDS=i;var n=86400;t.DAY_SECONDS=n;t.WEEK_SECONDS=604800;t.YEAR_SECONDS=31536e3;var s=36e5;t.HOUR_MILLISECONDS=s;var o=864e5;t.DAY_MILLISECONDS=o;t.WEEK_MILLISECONDS=6048e5;var l=1<<31;t.DUMMY_UNIXTIME=l;var d=2147483647;t.MAX_INT=d;var u=-2147483647,c={time:0,day:-4},p=0;function h(e){return Math.max(u,Math.min(0|e,d))}function f(e){var t=Math.max(e-_(),0);return Math.min(1e3*t,~(1<<31))}function _(){return h(Date.now()/1e3-p)}function m(e){return Math.max(e-_(),0)}function g(){return performance.now()}function v(e){return Math.floor(performance.now()-e)}function E(e,t,r){return Math.abs(e-t)<=r}function y(e){return new Date(1e3*e)}t.MonotonicTimer=class{constructor(){var e=g();this._initTime=e,this._startTime=e}reset(){this._startTime=g()}elapsed(){return v(this._startTime)}cumulative(){return v(this._initTime)}}},62240:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ParsableXmlNode=void 0;var a=r(28149);t.ParsableXmlNode=class{constructor(e,t){this._name=e,this._node=t,this._children=Array.isArray(t.content)?t.content.map((t=>new this.constructor(e,t))):null}name(){return this._name}hasAttr(e){return Object.prototype.hasOwnProperty.call(this._node.attrs,e)}assertTag(e){this._node.tag!==e&&this.throw(`to be <${e}>`)}tag(){return this._node.tag}maybeChild(e){var t=this._children;if(!t)return null;for(var r=0;r<t.length;r++)if(t[r].tag()===e)return t[r];return null}hasChild(e){return!!this.maybeChild(e)}child(e){var t=this.maybeChild(e);return t||this.throw(`to have child <${e}>`)}assertAttr(e,t){var r=this.attrString(e);r!==t&&this.throw(`to have "${e}"="${t}", but instead has "${r}"`)}attrString(e){return Object.prototype.hasOwnProperty.call(this._node.attrs,e)?this.decodeAsString(this._node.attrs[e]):this.throw(`to have attribute "${e}"`)}forEachAttributeKey(e){var t=this._node.attrs;Object.keys(t).forEach((t=>e(t)))}maybeAttrString(e){return this.hasAttr(e)?this.decodeAsString(this._node.attrs[e]):null}maybeAttrInt(e,t,r){return this.hasAttr(e)?this.attrInt(e,t,r):null}attrEnumValues(e,t){var r=new Set(t),a=this.attrString(e);if(!r.has(a)){var i=Array.from(r).join("|");return this.throw(`to have "${e}"={${i}} but has value "${a}"`)}return a}attrEnum(e,t){var r=this.attrString(e);if(!Object.prototype.hasOwnProperty.call(t,r)){var a=Object.keys(t).join("|");return this.throw(`to have "${e}"={${a}} but has value "${r}"`)}return t[r]}attrEnumOrDefault(e,t,r){return this.hasAttr(e)?this.attrEnum(e,t):r}attrInt(e,t,r){var a=this.attrString(e),i=parseInt(a,10);return Number.isNaN(i)?this.throw(`to have "${e}"={integer} but has value "${a}"`):void 0!==t&&i<t?this.throw(`to have "${e}"={at least ${t}} but has value ${i}`):void 0!==r&&i>=r?this.throw(`to have "${e}"={below ${r}} but has value ${i}`):i}forEachChild(e){var t=this._children;if(t)t.forEach(e);else if(null!=this._node.content)return this.throw("to have children")}forEachChildWithTag(e,t){this.forEachChild((r=>{r.tag()===e&&t(r)}))}mapChildren(e){var t=this._children;return t||null==this._node.content?t?t.map(e):[]:this.throw("to have children")}mapChildrenWithTag(e,t){var r=this._children;return r||null==this._node.content?r?r.filter((t=>t.tag()===e)).map(t):[]:this.throw("to have children")}mapFirstChild(e){var t=this._children;return t&&0!==t.length?e(t[0]):this.throw("to have children")}hasContent(){return!this._children&&!!this._node.content}hasChildren(){return null!=this._children}contentUint(e){for(var t=this.contentBytes(e),r=0,a=0;a<e;a++)r=256*r+t[a];return r}contentBytes(e=-1){if(this._children)return this.throw("to have binary content, but has children instead");if(null!=this._node.content){var t=this._node.content;return-1!==e&&t.length!==e?this.throw(`to be ${e} bytes, but got ${t.length} instead`):t}return this.throw("to have content")}contentString(){return this._children?this.throw("to have string content, but has children instead"):null!=this._node.content?this._node.content:this.throw("to have content")}contentEnum(e){var t=this.contentString();if(!Object.prototype.hasOwnProperty.call(e,t)){var r=Object.keys(e).join("|");return this.throw(`to have content {${r}} but has value "${t}"`)}return e[t]}decodeAsString(e){if("string"!=typeof e)throw new Error(`decodeAsString: attribute is ${typeof e} not a string: ${e}`);return e}throw(e){throw new a.XmlParsingFailure(this._name,`expected <${this._node.tag}> ${e}`)}toString(){return this._node.toString()}}},42849:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.attrsToString=n,t.uint8ArrayToDebugString=s,t.XmlNode=void 0;var a=r(61212),i={};function n(e){for(var t=Object.keys(e),r="",a=0;a<t.length;a++){var i=t[a];r+=` ${i}="${e[i].toString()}"`}return r}function s(e){return 0===e.length?"\x3c!-- empty binary --\x3e":e.length<50?(0,a.bytesToDebugString)(e):`\x3c!-- ${e.length} bytes --\x3e`}t.XmlNode=class{constructor(e,t=i,r=null){this.tag=e,this.attrs=t,this.content=r}toString(){var e="<"+this.tag;e+=n(this.attrs);var t=this.content;return Array.isArray(t)?e+=`>${t.map(String).join("")}</${this.tag}>`:t instanceof Uint8Array?e+=`>${s(t)}</${this.tag}>`:e+=null!=t?`>${String(t)}</${this.tag}>`:" />",e}}},28149:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XmlParsingFailure=void 0;t.XmlParsingFailure=class{constructor(e,t){this.parser=e,this.reason=t}toString(){return`XmlParsingFailure: ${this.parser}: ${this.reason}`}}},92901:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.replace(/>\s{0,}</g,"><").replace(/</g,"~::~<").replace(/\s*xmlns:/g,"~::~xmlns:").replace(/\s*xmlns=/g,"~::~xmlns=").split("~::~"),r=t.length,a=!1,i=0,n="",s=0,o=["\n"];for(s=0;s<100;s++)o.push(o[s]+"    ");var l=function(e,t){var r=/^<[\w:\-.,]+/.exec(e[t-1]),a=/^<\/[\w:\-.,]+/.exec(e[t]);return null!=r&&null!=a&&r[0]===a[0]};for(s=0;s<r;s++)t[s].search(/<!/)>-1?(n+=o[i]+t[s],a=!0,(t[s].search(/-->/)>-1||t[s].search(/\]>/)>-1||t[s].search(/!DOCTYPE/)>-1)&&(a=!1)):t[s].search(/-->/)>-1||t[s].search(/\]>/)>-1?(n+=t[s],a=!1):l(t,s)?(n+=t[s],a||i--):t[s].search(/<\w/)>-1&&-1===t[s].search(/<\//)&&-1===t[s].search(/\/>/)?n=n+=a?t[s]:o[i++]+t[s]:t[s].search(/<\w/)>-1&&t[s].search(/<\//)>-1?n=n+=a?t[s]:o[i]+t[s]:t[s].search(/<\//)>-1?n=n+=a?t[s]:o[--i]+t[s]:t[s].search(/\/>/)>-1?n=n+=a?t[s]:o[i]+t[s]:t[s].search(/<\?/)>-1||t[s].search(/xmlns:/)>-1||t[s].search(/xmlns=/)>-1?n+=o[i]+t[s]:n+=t[s];return"\n"===n[0]?n.slice(1):n}},52894:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.queryBusinessProfile=function(e){return(0,i.queryBusinessProfile)(e)},t.queryBusinessCategories=function(e){return e===a.BUSINESS_CATEGORY_EMPTY_STR_ID?(0,n.queryBusinessCategories)(""):(0,n.queryBusinessCategories)(e)};var a=r(83194),i=r(75512),n=r(28143)},93572:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.updateEphemeralSettingTimestamp=_,t.changeEphemeralDuration=function(e,t){if(e.isGroup)return __LOG__(4,void 0,new Error,!0)`chat.changeEphemeralDuration should not be called for group ${e.id.toString()}`,SEND_LOGS("change-ephemeral-duration"),Promise.resolve();var r=e.contact;if(r.isUser&&r.isContactBlocked)return Promise.reject(new s.default("changing ephemeral setting for contact is blocked",r));var a={id:new u.default({id:(0,c.default)(),remote:e.id,fromMe:!0}),from:(0,o.getMaybeMeUser)(),to:e.id,t:i.default.globalUnixTime(),type:n.default.MSG_TYPE.PROTOCOL,subtype:"ephemeral_setting",ephemeralDuration:t,local:!0,isNewMsg:!0,self:"out"},l=null==e.ephemeralSettingTimestamp?1:e.ephemeralSettingTimestamp+1;return _(e,l),(0,p.addAndSendMsgToChat)(e,a)[1].then((()=>(0,f.updateLocal)(e.id,{ephemeralDuration:t}).then((()=>{e.ephemeralDuration=t,__LOG__(2)`chat.changeEphemeralDuration chatId=${e.id.toString()} ephemeralDuration=${t}`}))))},t.maybeUpdateEphemeralSetting=function(e,t,r,a=!0){var i,n;if(e.isGroup)return __LOG__(4,void 0,new Error,!0)`chat.maybeUpdateEphemeralSetting should not be called for group ${e.id.toString()}`,SEND_LOGS("handle-ephemeral-sync-response"),!1;if(!(0,d.isEphemeralDurationAllowed)(t))return __LOG__(2)`chat.maybeUpdateEphemeralSetting called with invalid setting ${t} seconds for chat ${e.id.toString()}`,!1;var s=null!==(i=e.ephemeralSettingTimestamp)&&void 0!==i?i:0,o=null!==(n=e.ephemeralDuration)&&void 0!==n?n:0,u=e.id,c=(0,h.shouldUpdateEphemeralSetting)({oldDuration:o,oldSettingTimestamp:s,newDuration:t,newSettingTimestamp:r,chatId:u});c&&(0,f.updateLocal)(e.id,{ephemeralDuration:t,ephemeralSettingTimestamp:r}).then((()=>{o!==t&&a&&(0,l.generateEphemeralSystemMessage)(e,t),e.ephemeralDuration=t,e.ephemeralSettingTimestamp=r,__LOG__(2)`chat.maybeUpdateEphemeralSetting updated chatId=${e.id.toString()} ephemeralDuration=${t} ephemeralSettingTimestamp=${r}`}));return c};var i=a(r(99461)),n=a(r(23045)),s=a(r(80206)),o=r(66239),l=r(97488),d=r(34891),u=a(r(83746)),c=a(r(2661)),p=r(76774),h=r(18555),f=r(78413);function _(e,t){if(e.isGroup)return __LOG__(4,void 0,new Error,!0)`chat.updateEphemeralSettingTimestamp should not be called for group ${e.id.toString()}`,void SEND_LOGS("update-ephemeral-setting-timestamp");(0,f.updateLocal)(e.id,{ephemeralSettingTimestamp:t}).then((()=>{e.ephemeralSettingTimestamp=t,__LOG__(2)`chat.updateEphemeralSettingTimestamp chatId=${e.id.toString()} ephemeralSettingTimestamp=${t}`}))}},11968:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.markComposing=function(e){return function(e){if((e.presence.isOnline||e.isGroup)&&!e.typing){var t=e.id;(0,n.sendChatStateComposing)(t).catchType(o.ServerStatusCodeError,(e=>{e.status>=400&&__LOG__(3)`models:chat send presence composing error ${t.toString()}`})).catchTypes(o.WebdDrop,l.ProtoVersionUndefined,(()=>{})),e.presenceResendTimerId=setTimeout((()=>p(e)),s.default.PRESENCE_RESEND_WAIT)}e.typing=!0,e.pausedTimerId&&clearTimeout(e.pausedTimerId);e.pausedTimerId=setTimeout((()=>c(e)),s.default.SEND_PAUSED_WAIT)}((0,u.unproxy)(e))},t.markPaused=function(e){return c((0,u.unproxy)(e))},t.markRecording=function(e){return function(e){if((e.presence.isOnline||e.isGroup)&&!e.recording){var t=e.id;(0,n.sendChatStateRecording)(t).catchType(o.ServerStatusCodeError,(e=>{e.status>=400&&__LOG__(3)`models:chat send presence recording error ${t.toString()}`})).catchTypes(o.WebdDrop,l.ProtoVersionUndefined,(()=>{})),e.presenceResendTimerId=setTimeout((()=>p(e)),s.default.PRESENCE_RESEND_WAIT)}e.pausedTimerId&&(clearTimeout(e.pausedTimerId),e.unset("pausedTimerId"));e.recording=!0,e.typing=!1}((0,u.unproxy)(e))},t.sendPresenceAvailable=function(){(0,d.setPresenceAvailable)()},t.sendPresenceUnavailable=function(){(0,d.setPresenceUnavailable)()},t.presenceOnlineChanged=function(e){e.presence.isOnline?p(e):e.presenceResendTimerId&&(clearTimeout(e.presenceResendTimerId),e.unset("presenceResendTimerId"))},t.clearPresence=function(e){e.presenceResendTimerId&&(clearTimeout(e.presenceResendTimerId),e.unset("presenceResendTimerId"));e.pausedTimerId&&(clearTimeout(e.pausedTimerId),e.unset("pausedTimerId"));e.typing=!1};var n=r(34068),s=i(r(23045)),o=r(33576),l=a(r(24461)),d=r(64506),u=r(47138);function c(e){if((e.presence.isOnline||e.isGroup)&&(e.typing||e.recording)){var t=e.id;(0,n.sendChatStatePaused)(t).catchType(o.ServerStatusCodeError,(e=>{e.status>=400&&__LOG__(3)`models:chat send presence paused error ${t.toString()}`})).catchTypes(o.WebdDrop,l.ProtoVersionUndefined,(()=>{}))}e.presenceResendTimerId&&(clearTimeout(e.presenceResendTimerId),e.unset("presenceResendTimerId")),e.pausedTimerId&&(clearTimeout(e.pausedTimerId),e.unset("pausedTimerId")),e.typing=e.recording=!1}function p(e){var t=e.id;if(e.recording)(0,n.sendChatStateRecording)(t).catchType(o.ServerStatusCodeError,(e=>{e.status>=400&&__LOG__(3)`models:chat send presence resend recording error ${t.toString()}`})).catchTypes(o.WebdDrop,l.ProtoVersionUndefined,(()=>{}));else{if(!e.typing)return void e.unset("presenceResendTimerId");(0,n.sendChatStateComposing)(t).catchType(o.ServerStatusCodeError,(e=>{e.status>=400&&__LOG__(3)`models:chat send presence resend composing error ${t.toString()}`})).catchTypes(o.WebdDrop,l.ProtoVersionUndefined,(()=>{}))}e.presenceResendTimerId=setTimeout((()=>p(e)),s.default.PRESENCE_RESEND_WAIT)}},20838:(e,t,r)=>{"use strict";var a=r(14859),i=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.sendClear=function(e,t){return h((0,p.unproxy)(e),t)},t.clearChat=f;var n=i(r(2784)),s=r(8507),o=r(20637),l=a(r(13277)),d=r(33576),u=a(r(20468)),c=a(r(38637)),p=r(47138);function h(e,t){var{promises:r}=e;if(r.sendClear)return r.sendClear;var a=e.getLastMsgKeyForAction(),i=r.sendClear=(0,o.sendClear)(e,a,t),p=new s.ActionType(c.default.t(59)),_=i.then((()=>u.default.supportsFeature(u.default.F.MD_BACKEND)?new s.ActionType(c.default.t(58)):new s.ActionType(c.default.t(57)))).catchType(d.ServerStatusCodeError,(e=>{if(e.status>=400)return new s.ActionType(c.default.t(56))})).catch((()=>(__LOG__(3)`models:chat:sendClear dropped`,new s.ActionType(c.default.t(56),{actionText:c.default.t(199),actionHandler:()=>h(e,t)}))));return l.default.openToast(n.createElement(s.ActionToast,{id:(0,s.genId)(),initialAction:p,pendingAction:_})),i.then((r=>{r._duplicate||f(e,t)})).catchType(d.ServerStatusCodeError,(()=>{})).finally((()=>{r.sendClear=null}))}function f(e,t){if(e){var r=e.getLastMsgKeyForAction(),a=r?e.msgs.get(r):void 0;e.deleteMsgsBeforeMsgInclusive(a,t)}}},76774:(e,t,r)=>{"use strict";var a=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.addAndSendMsgToChat=function(e,t,a){return function(e,t,a){var s=Promise.resolve(t).then((t=>{var a=r(30528).default.add(t)[0];if(a)return(0,n.storeMessages)([t],e.id).then((()=>a.waitForPrep().then((()=>a))));throw new i.ModelCreateError("Msg",t)})),o=e.addQueue.enqueue(s).then((t=>e.msgs.add(t)[0])),d=a?o.then(a).then((()=>o)):o,u=l(e,d);return[o,u]}((0,o.unproxy)(e),t,a)},t.sendMsgToChat=function(e,t){return l((0,o.unproxy)(e),t)};var i=a(r(24461)),n=r(245),s=r(75096),o=(r(87471),r(47138));function l(e,t){return e.sendQueue.enqueue(t).then((e=>(0,s.sendMsgRecord)(e)))}},11212:(e,t,r)=>{"use strict";var a=r(14859),i=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.sendSpamReport=function(e,t){return v((0,m.unproxy)(e),t)},t.sendNotSpam=function(e,t){return E((0,m.unproxy)(e),t)},t.sendSpamBlockClear=function(e){return function(e){var{promises:t,isGroup:r,contact:a}=e;if(t.reportSpamBlockClear)return t.reportSpamBlockClear;if(r)return Promise.reject(new u.ActionError);var i=v(e,_.SpamFlow.Block);return t.reportSpamBlockClear=i.then((()=>(0,o.blockContact)(a))).then((()=>(0,h.sendClear)(e,!1))).catch((()=>{})).finally((()=>{t.reportSpamBlockClear=null})),t.reportSpamBlockClear}((0,m.unproxy)(e))},t.sendSpamExitClear=function(e){return function(e){var t,{promises:r,isGroup:a,isReadOnly:i,msgs:n}=e;if(r.reportSpamExitClear)return r.reportSpamExitClear;if(!a)return Promise.reject(new u.ActionError);var s=v(e,_.SpamFlow.Block);if(i)t=s;else{var o=(0,c.sendExitGroup)(e),l=(0,g.default)(n,"change:last",(e=>e.isGroupLeave()));t=Promise.all([s,o,l])}return r.reportSpamExitClear=t.then((()=>(0,h.sendClear)(e,!1))).catch((()=>{})).finally((()=>{r.reportSpamExitClear=null})),r.reportSpamExitClear}((0,m.unproxy)(e))};var n=i(r(2784)),s=r(8507),o=r(25559),l=a(r(13277)),d=r(33576),u=i(r(24461)),c=r(34330),p=a(r(38637)),h=r(20838),f=r(65794),_=r(27372),m=r(47138),g=a(r(57568));function v(e,t,r=(0,s.genId)()){var{promises:a}=e;if(a.sendSpamReport)return a.sendSpamReport;var i=a.sendSpamReport=(0,f.sendSpamReport)(e,t),o=new s.ActionType(p.default.t(192)),u=i.then((()=>new s.ActionType(p.default.t(194)))).catchType(d.ServerStatusCodeError,(()=>new s.ActionType(p.default.t(193)))).catch((()=>(__LOG__(3)`models:chat:sendSpamReport dropped`,new s.ActionType(p.default.t(193),{actionText:p.default.t(199),actionHandler:()=>v(e,t,r)}))));return l.default.openToast(n.createElement(s.ActionToast,{id:r,initialAction:o,pendingAction:u})),i.finally((()=>{a.sendSpamReport=null}))}function E(e,t=!1,r=(0,s.genId)()){var{promises:a,notSpam:i}=e;if(i)return Promise.resolve();if(a.sendNotSpam)return a.sendNotSpam;var o=a.sendNotSpam=(0,f.sendNotSpam)(e);if(t){var u=new s.ActionType(p.default.t(139)),c=o.then((()=>new s.ActionType(p.default.t(141)))).catchType(d.ServerStatusCodeError,(()=>new s.ActionType(p.default.t(140)))).catch((()=>(__LOG__(3)`models:chat:sendNotSpam dropped`,new s.ActionType(p.default.t(140),{actionText:p.default.t(199),actionHandler:()=>E(e,t,r)}))));l.default.openToast(n.createElement(s.ActionToast,{id:r,initialAction:u,pendingAction:c}))}return o.then((()=>{e.set({notSpam:!0})})).finally((()=>{e.isTrusted(),a.sendNotSpam=null}))}},966:(e,t,r)=>{"use strict";var a=r(14859),i=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.unstarAllMessages=function(e,t){return f(e,t?(0,h.unproxy)(t):t)};var n=i(r(2784)),s=r(8507),o=a(r(13277)),l=r(33576),d=a(r(38637)),u=r(74856),c=a(r(79090)),p=i(r(37147)),h=r(47138);function f(e,t){var a=r(85030).default,i=t?t.promises:a.promises,h=t?t.id:void 0;if(i.sendUnstarAll)return i.sendUnstarAll;var _=i.sendUnstarAll=(0,u.sendUnstarAll)(e,h),m=new s.ActionType(d.default.t(156)),g=_.then((()=>new s.ActionType(d.default.t(154)))).catchType(l.ServerStatusCodeError,(e=>{if(e.statusCode>=400)return new s.ActionType(d.default.t(150))})).catch((()=>(__LOG__(3)`models:chat:sendUnstarAll dropped`,new s.ActionType(d.default.t(150),{actionText:d.default.t(199),actionHandler:()=>f(e,t)}))));return o.default.openToast(n.createElement(s.ActionToast,{id:(0,s.genId)(),initialAction:m,pendingAction:g})),_.then((()=>{e.forEach((e=>{e.set("star",!1)})),t?(0,p.removeStarredMsgs)(e):(p.default.reset(),c.default.reset(),a.forEach((e=>{e.starredMsgs&&e.starredMsgs.reset()})))})).finally((()=>{i.sendUnstarAll=null}))}},76710:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.markUnread=function(e,t){return S((0,_.unproxy)(e),t)},t.sendSeen=v,t.markSeen=E,t.markUnseen=y,t.updateUnreadCountMD=A;var n=i(r(52954)),s=a(r(2784)),o=r(8507),l=i(r(13277)),d=i(r(23045)),u=r(33576),c=a(r(24461)),p=i(r(20468)),h=i(r(38637)),f=r(75662),_=r(47138),m=i(r(96377)),g=r(78391);function v(e,t=!0){return T((0,_.unproxy)(e),t).catchType(u.ServerStatusCodeError,(e=>{__LOG__(3)`sendSeen: got status ${e.status}`}))}function E(e,t,r){return function(e,t,r=!1){String(t);var a=null;null!=t?t>0&&t<=e.unreadCount?(a=e.unreadCount-t,String(a)):-1===t&&e.unreadCount<=0&&(a=0,String(a)):(a=0,String(a));return(null==a?Promise.resolve():(0,f.markConversationSeen)(e.id,a)).then((()=>{if(null!=t&&r){var i=e.pendingSeenCount-t;e.pendingSeenCount=Math.max(0,i)}null!=a&&(e.unreadCount=a),e.unreadMsgAnchor=void 0,e.markedUnread=!1}))}((0,_.unproxy)(e),t,r)}function y(e){!function(e){0===e.unreadCount&&(e.active&&(e.markedUnread=!0),(0,f.markConversationUnseen)(e.id).then((()=>{e.unreadCount=d.default.MARKED_AS_UNREAD})))}((0,_.unproxy)(e))}function S(e,t,r=(0,o.genId)()){t?e.active&&(e.markedUnread=!0):e.markedUnread=!1;var{promises:a}=e;if(a.markUnread)return a.markUnread;var i=a.markUnread=t?function(e){var t=e.getLastMsgKeyForAction();return(0,f.sendConversationUnseen)(e.id,t).then((()=>{y(e)})).catchType(u.ServerStatusCodeError,(t=>(e.markedUnread=!1,Promise.reject(t))))}(e):T(e),n=t?new o.ActionType(h.default.t(72)):new o.ActionType(h.default.t(71)),d=i.then((()=>{var a=t?h.default.t(70):h.default.t(69);return new o.ActionType(a,{actionText:h.default.t(203),actionHandler:()=>S(e,!t,r)})})).catchType(u.ServerStatusCodeError,(e=>{if(e.status>=400)return t?new o.ActionType(h.default.t(68)):new o.ActionType(h.default.t(67));throw new Error("invalid response status")})).catch((()=>{var a=t?h.default.t(68):h.default.t(67);return new o.ActionType(a,{actionText:h.default.t(199),actionHandler:()=>S(e,t,r)})}));return l.default.openToast(s.createElement(o.ActionToast,{id:r,initialAction:n,pendingAction:d})),i.then((()=>{})).catchType(u.ServerStatusCodeError,(e=>{__LOG__(3)`markUnread: got status ${e.status}`})).finally((()=>{a.markUnread=null}))}function T(e,t=!0){if(e.markedUnread||0===e.unreadCount)return String(e.markedUnread),e.unreadCount,Promise.resolve();if(!m.default.available&&t)return e.listenToOnce(m.default,"change:available",(()=>v(e))),Promise.resolve();e.unreadCount,e.pendingSeenCount;var r=e.unreadCount-e.pendingSeenCount,a=-1===e.unreadCount&&-1===r;if(r<=0&&!a)return Promise.resolve();e.disableUnreadAnchor=!0,e.pendingSeenCount=e.unreadCount,e.pendingSeenCount;var i=()=>{e.pendingSeenCount=e.pendingSeenCount-r,e.pendingSeenCount,e.pendingSeenCount<0&&(__LOG__(3)`models:chat:sendSeen unread ${e.unreadCount} pending: ${e.pendingSeenCount} delta: ${r}`,e.pendingSeenCount=0)},n=e.getLastMsgKeyForAction();return(0,f.sendConversationSeen)(e,n,r).then((t=>{p.default.supportsFeature(p.default.F.MD_BACKEND)?A(e,r):t._duplicate?i():E(e,r,!0)})).catchType(u.ServerStatusCodeError,(e=>(i(),Promise.reject(e)))).catchTypes(u.WebdDrop,c.ProtoVersionUndefined,(()=>{i(),__LOG__(3)`models:chat:sendConversationSeen dropped`}))}function A(){return b.apply(this,arguments)}function b(){return(b=(0,n.default)((function*(e,t,r=!0){var{unreadCount:a}=yield(0,g.getChatMeta)(e.id);if(e.unreadCount,e.unreadCount=a,e.unreadMsgAnchor=void 0,e.markedUnread=!1,r){var i=e.pendingSeenCount-t;e.pendingSeenCount=Math.max(0,i)}}))).apply(this,arguments)}},63860:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.setPushnameLocally=function(e){i.default.pushname=e,(0,n.setPushname)(e)};var i=a(r(79435)),n=r(66239)},89581:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.createDeviceNotifications=function(){return c.apply(this,arguments)};var i=a(r(52954)),n=r(38027),s=r(8950),o=r(25054),l=r(66239),d=r(3710),u=a(r(23045));function c(){return(c=(0,i.default)((function*(e,t,r){if(!(0,l.getGlobalSecurityNotifications)())return[];if(!(t.length>0||r.length>0))return[];var a=[];if(e.equals((0,l.getMeUser)()))try{(yield(0,n.getChatTable)().all()).forEach((e=>{e.id!==u.default.STATUS_WID&&a.push((0,o.createWid)(e.id))}))}catch(e){throw __LOG__(4,!0,new Error,!0)`get all from chat table failed`,SEND_LOGS("get all from chat table failed when creating device notification"),new Error("get all from chat table failed")}else try{var i=yield(0,n.getChatTable)().get(String(e)),c=yield(0,n.getParticipantTable)().equals(["participants"],String(e));a=c.map((e=>(0,o.createWid)(e.groupId))),i&&a.push((0,o.createWid)(i.id))}catch(e){throw __LOG__(4,!0,new Error,!0)`get chats failed`,SEND_LOGS("get chats failed when creating device notification"),new Error("get chays failed")}var p=a.map((a=>(0,s.genDeviceNotificationMsg)(a,e,t,r)));return yield Promise.all(p.map((e=>(0,d.storeMessageInTransaction)([e])))),p}))).apply(this,arguments)}},24581:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.handleADVDeviceUpdateForMessage=function(e,t,r,a,i){if(s.default.supportsFeature(s.default.F.MD_BACKEND))return function(){return y.apply(this,arguments)}(e,t,r,a,i);return Promise.reject(new Error("This call is only supported in MD mode"))},t.handleADVDeviceUpdate=function({wid:e,devices:t,type:r="update"}){if(s.default.supportsFeature(s.default.F.MD_BACKEND))return function(){return E.apply(this,arguments)}(e,t,r);return Promise.reject(new Error("This call is only supported in MD mode"))},t.handleADVDeviceSyncResult=function(e){if(s.default.supportsFeature(s.default.F.MD_BACKEND))return function(){return S.apply(this,arguments)}(e);return Promise.reject(new Error("This call is only supported in MD mode"))};var i=a(r(70417)),n=a(r(52954)),s=a(r(20468)),o=r(38027),l=r(24606),d=r(69909),u=r(8333),c=r(9557),p=r(25364),h=r(38550),f=r(70338),_=a(r(23045)),m=r(446),g=r(25054),v=a(r(86123));function E(){return(E=(0,n.default)((function*(e,t,r){var a,n=yield l.waSignalStore.getIdentity((0,d.createSignalAddress)(e).toString());if(n){var s=(0,m.toCurveKeyPubKey)((0,d.strToBuffer)(n)),{deviceList:g,keyIndex:v}=t;if(null!=g&&null!=v){var{ts:E,signedKeyIndexBytes:y}=v,S=yield(0,o.getDeviceListTable)().get(e.user);if(!(S&&(0,p.numberOrThrowIfTooLarge)(S.timestamp)>v.ts)){if("remove"===r&&S){var T=S.devices.filter((e=>e.keyIndex!==g[0].keyIndex&&e.id!==g[0].id)),A=(0,i.default)((0,i.default)({},S),{},{devices:T});return(0,u.applyDeviceUpdate)(e,A,S.devices)}var b=(0,c.decodeProto)(h.ADVSignedKeyIndexListSpec,y);if(!(0,f.verifyKeyIndexListAccountSignature)(b,s))throw new Error("handleADVDeviceUpdate: validate device failed");var C=(0,c.decodeProto)(h.ADVKeyIndexListSpec,b.details);if(null==C.timestamp||null==C.rawId)throw new Error("handleADVDeviceUpdate: missing timestamp or rawId");var P=(0,p.numberOrThrowIfTooLarge)(C.timestamp),O=C.rawId;if(null==O||null==P)throw new Error("handleADVDeviceUpdate: missing incming timestamp or rawId");if(P!==E)throw new Error("handleADVDeviceUpdate: ts mismatch device failed");S&&S.rawId!==O&&(yield(0,u.clearDeviceRecord)(e,S.devices),S=null);var w=C.currentIndex||0,M=new Map,I=new Set(C.validIndexes);I.add(0),g.forEach((e=>{null!=e.keyIndex&&I.has(e.keyIndex)&&M.set(e.id,e.keyIndex)})),S&&("add"===r?S.devices.forEach((e=>{(I.has(e.keyIndex)||e.keyIndex>w)&&M.set(e.id,e.keyIndex)})):S.devices.forEach((e=>{var t=M.get(e.id);null!=t?t<e.keyIndex&&I.has(e.keyIndex)&&M.set(e.id,e.keyIndex):e.keyIndex>w&&M.set(e.id,e.keyIndex)}))),M.set(_.default.DEVICE.PRIMARY_DEVICE,0);var R=Array.from(M.entries()).map((([e,t])=>({id:e,keyIndex:t}))),D="add"===r&&S?S.timestamp:P,N={id:e.user,rawId:O,timestamp:D,validIndexes:Array.from(I),devices:R,currentIndex:C.currentIndex};return(0,u.applyDeviceUpdate)(e,N,null===(a=S)||void 0===a?void 0:a.devices)}__LOG__(2)`getADVDeviceSignedKeyIndexList: timestamp older than stored data`}}}))).apply(this,arguments)}function y(){return(y=(0,n.default)((function*(e,t,r,a,n){var{rawId:s,timestamp:l,keyIndex:c}=t;if(null==s||null==l||null==c)throw new Error("handleADVDeviceIdentity: rawId, keyIndex, timestamp inside deviceIdentity should not be null");var h=e.device;if(null==h||h===_.default.DEVICE.PRIMARY_DEVICE)throw new Error("handleADVDeviceIdentity: called for primary device");var f=(0,g.toUserWid)(e),E=yield(0,o.getDeviceListTable)().get(f.user);if(E&&(E.rawId!==s||null==r||null!=a&&!(0,d.bufferEqual)(r,a))){if(E.timestamp>(0,p.numberOrThrowIfTooLarge)(l))throw new Error("handleADVDeviceIdentity: out-of-order timestamp detected");yield(0,u.clearDeviceRecord)(f,E.devices),E=null}var y=(0,v.default)();if(E){if(E.timestamp>=(0,p.numberOrThrowIfTooLarge)(l)&&E.validIndexes&&!E.validIndexes.includes(c))throw new Error("handleADVDeviceIdentity: out-of-order timestamp detected");var S=new Map;if(E.devices.forEach((e=>{S.set(e.id,e.keyIndex)})),!S.has(h)||!S.get(h)===c){S.set(h,c);var T=Array.from(S.entries()).map((([e,t])=>({id:e,keyIndex:t}))),A=(0,i.default)((0,i.default)({},E),{},{devices:T});yield(0,u.applyDeviceUpdate)(f,A,E.devices)}}else{a&&(yield y.saveIdentity((0,d.createSignalAddress)(f).toString(),(0,m.toSignalCurvePubKey)(a)));var b={id:e.user,rawId:s,timestamp:(0,p.numberOrThrowIfTooLarge)(l),devices:[{id:h,keyIndex:c},{id:_.default.DEVICE.PRIMARY_DEVICE,keyIndex:0}],validIndexes:null,currentIndex:null};yield(0,u.applyDeviceUpdate)(f,b,null)}yield(0,v.default)().saveIdentity((0,d.createSignalAddress)(e).toString(),(0,m.toSignalCurvePubKey)(n))}))).apply(this,arguments)}function S(){return(S=(0,n.default)((function*(e){__LOG__(2)`_handleADVDeviceSyncResult: start to handling ${e.length} updates`;var t=[],r=e.map((e=>e.wid)),a=yield l.waSignalStore.bulkGetIdentity(r.map((e=>(0,d.createSignalAddress)(e).toString()))),i=yield(0,o.getDeviceListTable)().bulkGet(r.map((e=>e.user))),n=[];e.forEach((({wid:e,devices:r},s)=>{var o,l=a[s];if(l){var u=i[s],g=(0,m.toCurveKeyPubKey)((0,d.strToBuffer)(l)),{deviceList:v,keyIndex:E}=r;if(null!=v&&null!=E){var{ts:y,signedKeyIndexBytes:S}=E;if(u&&(0,p.numberOrThrowIfTooLarge)(u.timestamp)>E.ts)__LOG__(2)`getADVDeviceSignedKeyIndexList: timestamp older than stored data for ${String(e)}`;else{var T=(0,c.decodeProto)(h.ADVSignedKeyIndexListSpec,S);if((0,f.verifyKeyIndexListAccountSignature)(T,g)){var A=(0,c.decodeProto)(h.ADVKeyIndexListSpec,T.details);if(null!=A.timestamp&&null!=A.rawId){var b=(0,p.numberOrThrowIfTooLarge)(A.timestamp),C=A.rawId;if(null!=C&&null!=b)if(b===y){u&&u.rawId!==C&&(n.push({wid:e,currentList:u.devices}),u=null);var P=A.currentIndex||0,O=new Map,w=new Set(A.validIndexes);w.add(0),v.forEach((e=>{null!=e.keyIndex&&w.has(e.keyIndex)&&O.set(e.id,e.keyIndex)})),u&&u.devices.forEach((e=>{var t=O.get(e.id);null!=t?t<e.keyIndex&&w.has(e.keyIndex)&&O.set(e.id,e.keyIndex):e.keyIndex>P&&O.set(e.id,e.keyIndex)})),O.set(_.default.DEVICE.PRIMARY_DEVICE,0);var M=Array.from(O.entries()).map((([e,t])=>({id:e,keyIndex:t}))),I={id:e.user,rawId:C,timestamp:b,validIndexes:Array.from(w),devices:M,currentIndex:A.currentIndex};t.push({wid:e,update:I,currentList:null===(o=u)||void 0===o?void 0:o.devices})}else __LOG__(4,void 0,new Error)`handleADVDeviceUpdate: ts mismatch device failed for ${String(e)}`;else __LOG__(4,void 0,new Error)`handleADVDeviceUpdate: missing incming timestamp or rawId for ${String(e)}`}else __LOG__(4,void 0,new Error)`handleADVDeviceUpdate: missing timestamp or rawId for ${String(e)}`}else __LOG__(4,void 0,new Error)`handleADVDeviceUpdate: validate device failed for ${String(e)}`}}}else __LOG__(2)`_handleADVDeviceSyncResult: missing primarykey for ${String(e)}`})),yield Promise.all(n.map((({wid:e,currentList:t})=>(0,u.clearDeviceRecord)(e,t)))),yield(0,u.bulkApplyDeviceUpdate)(t)}))).apply(this,arguments)}},8333:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.clearDeviceRecord=function(){return m.apply(this,arguments)},t.applyDeviceUpdate=function(){return g.apply(this,arguments)},t.bulkApplyDeviceUpdate=function(){return v.apply(this,arguments)};var i=a(r(52954)),n=a(r(17335)),s=a(r(23045)),o=r(5967),l=r(85841),d=r(38027),u=r(53353),c=r(20276),p=r(25054),h=r(89581),f=r(66239),_=r(60478);function m(){return(m=(0,i.default)((function*(e,t){yield Promise.all(t.filter((e=>e.id!==s.default.DEVICE.PRIMARY_DEVICE)).map((t=>(0,o.deleteIdentity)((0,p.createDeviceWidFromUserAndDevice)(e.user,t.id)))));var r=[],a=t.map((e=>e.id)).filter((e=>e!==s.default.DEVICE.PRIMARY_DEVICE)),n=function(){var t=(0,i.default)((function*(){var t=(0,h.createDeviceNotifications)(e,r,a),i=(0,c.updateGroupParticipantsInTransaction)(e,r,a),n=(0,d.getDeviceListTable)().remove(e.user).catch((()=>{throw __LOG__(4,!0,new Error,!0)`remove from device list table failed`,SEND_LOGS("remove from device list table failed when clearing device record"),new Error("remove from device list table failed")}));return(yield Promise.all([t,i,n]))[0]}));return function(){return t.apply(this,arguments)}}(),f=yield(0,l.getDeviceUpdateLock)(n);yield Promise.all(f.map((e=>(e.recvFresh=!0,e.isNewMsg=!0,(0,u.getBridge)().sendAndReceive("msg_collection","processMultipleMessages",{chatId:e.from,msgObjs:[e],meta:{isHistory:!1}})))))}))).apply(this,arguments)}function g(){return(g=(0,i.default)((function*(e,t,r){var{devices:a}=t,m=a.map((e=>e.id)),g=r?r.map((e=>e.id)):[],v=(0,n.default)(m,g).filter((e=>e!==s.default.DEVICE.PRIMARY_DEVICE)),E=(0,n.default)(g,m).filter((e=>e!==s.default.DEVICE.PRIMARY_DEVICE)),y=function(){var r=(0,i.default)((function*(){var r=(0,h.createDeviceNotifications)(e,v,E),a=(0,c.updateGroupParticipantsInTransaction)(e,v,E),i=(0,d.getDeviceListTable)().createOrReplace(t).catch((()=>{throw __LOG__(4,!0,new Error,!0)`createOrReplace into device list table failed`,SEND_LOGS("createOrReplace into device list table failed when applying device update"),new Error("createOrReplace into device list table failed")}));return(yield Promise.all([r,a,i]))[0]}));return function(){return r.apply(this,arguments)}}(),S=yield(0,l.getDeviceUpdateLock)(y);Promise.all(E.map((t=>(0,o.deleteIdentity)((0,p.createDeviceWidFromUserAndDevice)(e.user,t))))),yield Promise.all(S.map((e=>(e.recvFresh=!0,e.isNewMsg=!0,(0,u.getBridge)().sendAndReceive("msg_collection","processMultipleMessages",{chatId:e.from,msgObjs:[e],meta:{add:"after",isHistory:!1}}))))),e.user===(0,f.getMeUser)().user&&(0,_.updateMissingKeyDevices)()}))).apply(this,arguments)}function v(){return(v=(0,i.default)((function*(e){var t=[];e.forEach((({wid:e,update:r,currentList:a})=>{var{devices:i}=r,o=i.map((e=>e.id)),l=a?a.map((e=>e.id)):[],d=(0,n.default)(o,l).filter((e=>e!==s.default.DEVICE.PRIMARY_DEVICE)),u=(0,n.default)(l,o).filter((e=>e!==s.default.DEVICE.PRIMARY_DEVICE));t.push({wid:e,added:d,removed:u})}));var r=function(){var r=(0,i.default)((function*(){var r=Promise.all(t.map((({wid:e,added:t,removed:r})=>(0,h.createDeviceNotifications)(e,t,r)))),a=(0,c.bulkUpdateGroupParticipantsInTransaction)(t),i=(0,d.getDeviceListTable)().bulkCreateOrReplace(e.map((e=>e.update))).catch((()=>{throw __LOG__(4,!0,new Error,!0)`bulkCreateOrReplace into device list table failed`,SEND_LOGS("bulkCreateOrReplace into device list table failed when applying device update"),new Error("bulkCreateOrReplace into device list table failed")})),n=yield Promise.all([r,a,i]);return n[0]?n[0].flat():[]}));return function(){return r.apply(this,arguments)}}(),a=yield(0,l.getDeviceUpdateLock)(r);yield Promise.all(a.map((e=>(e.recvFresh=!0,e.isNewMsg=!0,(0,u.getBridge)().sendAndReceive("msg_collection","processMultipleMessages",{chatId:e.from,msgObjs:[e],meta:{add:"after",isHistory:!1}})))))}))).apply(this,arguments)}},20276:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.updateGroupParticipantsInTransaction=function(){return l.apply(this,arguments)},t.bulkUpdateGroupParticipantsInTransaction=function(){return d.apply(this,arguments)};var i=a(r(70417)),n=a(r(52954)),s=r(38027),o=r(25054);function l(){return(l=(0,n.default)((function*(e,t,r){var a=(yield(0,s.getParticipantTable)().equals(["participants"],String(e))).map((a=>{var n=a.rotateKey,s=new Map(a.senderKey);return t.forEach((t=>{s.set(String((0,o.createDeviceWidFromUserAndDevice)(e.user,t)),!1)})),r.forEach((t=>{s.delete(String((0,o.createDeviceWidFromUserAndDevice)(e.user,t)))})),r.length>0&&(n=!0),(0,i.default)((0,i.default)({},a),{},{senderKey:s,rotateKey:n})}));return(0,s.getParticipantTable)().bulkCreateOrReplace(a)}))).apply(this,arguments)}function d(){return(d=(0,n.default)((function*(e){if(0!==e.length){var t=yield(0,s.getParticipantTable)().anyOf(["participants"],e.map((e=>String(e.wid))));if(0!==t.length){var r=new Map;e.forEach((e=>{r.set(String(e.wid),e)}));var a=t.map((e=>{var t=e.rotateKey,a=new Map(e.senderKey);return e.participants.forEach((e=>{var i=r.get(e);if(i){var{added:n,removed:s}=i;n.forEach((e=>{a.set(String((0,o.createDeviceWidFromUserAndDevice)(i.wid.user,e)),!1)})),s.forEach((e=>{a.delete(String((0,o.createDeviceWidFromUserAndDevice)(i.wid.user,e)))})),s.length>0&&(t=!0)}})),(0,i.default)((0,i.default)({},e),{},{senderKey:a,rotateKey:t})}));return(0,s.getParticipantTable)().bulkCreateOrReplace(a)}}}))).apply(this,arguments)}},25559:(e,t,r)=>{"use strict";var a=r(14859),i=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.blockContact=function(e){return h((0,p.unproxy)(e),!0)},t.unblockContact=function(e){return h((0,p.unproxy)(e),!1)};var n=i(r(2784)),s=r(8507),o=r(11076),l=a(r(88025)),d=a(r(13277)),u=r(33576),c=a(r(38637)),p=r(47138);function h(e,t,r){var{id:a}=e,i=e.isBlocked();if(t&&i||!t&&!i)return Promise.resolve();var p=(0,o.sendSetBlock)(t,a).then((e=>{e&&(t?l.default.add({id:a}):l.default.remove(a))}));return function(e,t,r,a=(0,s.genId)()){var i={participant:e.formattedName},o=r?new s.ActionType(c.default.t(47,i)):new s.ActionType(c.default.t(202,i)),l=t.then((()=>{var t=r?c.default.t(46,i):c.default.t(201,i);return new s.ActionType(t,{actionText:c.default.t(203),actionHandler:()=>h(e,!r,a)})})).catch((t=>{if(!(t instanceof u.ServerStatusCodeError)){__LOG__(3)`action:setBlock dropped`;var n=r?c.default.t(45,i):c.default.t(200,i),o=new s.ActionType(n,{actionText:c.default.t(199),actionHandler:()=>h(e,r,a)});return Promise.reject(o)}if(t.statusCode>=400){var l=r?new s.ActionType(c.default.t(45,i)):new s.ActionType(c.default.t(200,i));return Promise.reject(l)}}));d.default.openToast(n.createElement(s.ActionToast,{id:a,initialAction:o,pendingAction:l}))}(e,p,t,r),p}},43816:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.onIsBusinessChange=function(e){var t=(0,n.unproxy)(e),{businessProfile:a,id:s}=t,o=t.isBusiness||t.isMe&&i.default.isSMB;o&&!a?t.addChild("businessProfile",r(65017).default.gadd(s)):!o&&a&&(t.stopListening(a),t.businessProfile=void 0,a.delete())};var i=a(r(79435)),n=r(47138)},68542:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.contactFindQuery=function(e){var t=performance.now(),a={};return s.default.contactFindQuery(e.retry,(e=>{a.binarySize=e.binarySize})).then((e=>{var s=e;if("preempted"===s.data)return Promise.reject("contacts preempted");a.count=s.data&&s.data.length,a.timing=Math.ceil(performance.now()-t);var o=r(43805).default;return o.trigger(i.default.COLLECTION_HAS_SYNCED,a),(0,n.mungePSAContact)(s.data),s.checksum&&(o.setChecksum(s.checksum),__LOG__(2)`Store:Contact:query update checksum ${s.checksum}`),Promise.resolve(s.data)}))};var i=a(r(23045)),n=r(74005),s=a(r(94407))},77658:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.queryIdentity=function(e){var t=(0,i.unproxy)(e),{verificationBinary:r,verificationString:a,id:o}=t;if(r&&a)return Promise.resolve();if(t.promises.queryIdentity)return t.promises.queryIdentity;t.promises.queryIdentity=n.default.queryIdentity(o).then((t=>{s(e,t)})).catch((e=>{__LOG__(3)`models:contact:queryIdentity error: ${String(e)}`})).finally((()=>{t.promises.queryIdentity=null}))},t.updateIdentity=s;var i=r(47138),n=a(r(94407));function s(e,t){var r=(0,i.unproxy)(e);t.status&&t.status>=400?(r.unset("verificationBinary"),r.unset("verificationString")):(r.verificationBinary=t.binary,r.verificationString=t.string)}},29153:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.handleNewIdentity=function(){return f.apply(this,arguments)};var i=a(r(52954)),n=a(r(20468)),s=r(11219),o=r(86301),l=r(25054),d=r(92166),u=a(r(23045)),c=a(r(61506)),p=r(89581),h=r(20276);function f(){return(f=(0,i.default)((function*(e){if(!n.default.supportsFeature(n.default.F.MD_BACKEND))return Promise.reject(new Error("This call is only supported in MD mode"));var t,r=Promise.resolve(),a=window.libsignal.SignalProtocolAddress.fromString(e).getName(),i=(0,l.createWid)((0,s.toJid)(a)),f=null!==(t=i.device)&&void 0!==t?t:u.default.DEVICE.PRIMARY_DEVICE,_=(0,l.toUserWid)(i);return f===u.default.DEVICE.PRIMARY_DEVICE?(c.default.notifyDeviceIdentityChangedOrDeleted(i,!0),yield(0,d.getStorage)().lock(["participant"],(()=>(0,h.updateGroupParticipantsInTransaction)(_,[f],[f]))),yield(0,o.addSecurityCodeChangedNotification)(_)):yield(0,p.createDeviceNotifications)(_,[f],[f]),r}))).apply(this,arguments)}},50140:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addLiveLocation=function(e,t){var r=(0,a.unproxy)(e);r.liveLocations||(r.liveLocations=[]);var{liveLocations:i}=r;i.push(t)},t.removeLiveLocation=function(e,t){var r=(0,a.unproxy)(e),{liveLocations:i}=r;if(!i)return;for(var n=i.length-1;n>=0;n--)if(i[n]===t){i.splice(n,1);break}0===i.length&&(r.liveLocations=null)};var a=r(47138)},79479:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.updatePushname=function(e,t){return s.enqueue((()=>{(0,i.getBridge)().sendAndReceive("contact_collection","updatePushname",{contactId:e,pushname:t}).then((r=>{if(r||void 0===r)return __LOG__(2)`updatePushName: set pushname for ${String(e)}`,(0,n.updateLocal)(e,{pushname:t})}))}))};var a=r(19129),i=r(53353),n=r(30421),s=new a.PromiseQueue},98701:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.resyncContacts=function(e){void 0!==i.default.checksum&&void 0!==e&&(i.default.checksum!==e?i.default.findQuery({retry:!0}).then((e=>{if(Array.isArray(e)){(0,l.mungePSAContact)(e),__LOG__(2)`Store:Contact:resync success`;var t=(0,o.getContactsToRemove)(e),r=Promise.resolve();if(s.default.supportsFeature(s.default.F.MD_BACKEND)&&t.length){var a=t.map((e=>e.id.toString()));r=(0,d.getContactTable)().bulkRemove(a).catch((()=>{throw __LOG__(4,!0,new Error,!0)`bulkRemove from contact table failed`,SEND_LOGS("bulkRemove from contact table failed when resyncing contacts"),new Error("bulkRemove from contact table failed")}))}r.then((()=>{t.forEach((e=>{e.unset("name"),e.unset("shortName")}))}))}else __LOG__(3)`Store:Contact.resync error ${JSON.stringify(e)}`})).catchType(n.WebdDrop,(()=>{})):__LOG__(2)`Store:Contact:resync checksum match`)};var i=a(r(43805)),n=r(33576),s=a(r(20468)),o=r(29877),l=r(74005),d=r(38027)},86301:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.addSecurityCodeChangedNotification=function(e){if((0,i.getGlobalSecurityNotifications)()&&n.default.supportsFeature(n.default.F.MD_BACKEND)){var t=[];if(s.default.get(e)){var r=(0,o.genSecurityCodeNotificationMsg)(e,e);t.push((0,d.handleSingleMsgMD)(e,r))}var a=e.toString(),c=(0,l.getParticipantTable)().equals(["participants"],a).then((t=>{var r=t.map((t=>{var r=(0,u.createWid)(t.groupId),a=(0,o.genSecurityCodeNotificationMsg)(r,e);return(0,d.handleSingleMsgMD)(r,a)}));return Promise.all(r)})).catch((()=>{throw __LOG__(4,!0,new Error,!0)`failed to insert notification for groups`,SEND_LOGS("failed to get participants table when adding security code change notification"),new Error("failed to insert notification for groups")}));return t.push(c),Promise.all(t)}return Promise.resolve()};var i=r(66239),n=a(r(20468)),s=a(r(85030)),o=r(8950),l=r(38027),d=r(62711),u=r(25054)},74005:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.mungePSAContact=function(e){if(Array.isArray(e)){var t=e.findIndex((e=>e&&n.default.isPSA(e.id))),r=e[t];t>-1&&r&&(r.name=i.default.t(1872),r.shortName=i.default.t(1872))}};var i=a(r(38637)),n=a(r(43926))},22984:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return d.apply(this,arguments)};var i=a(r(52954)),n=r(8950),s=r(62711),o=r(13152),l=a(r(54559));function d(){return(d=(0,i.default)((function*(e,t,r){var a=[p(e,t,r),h(e,t,r)];yield Promise.all(a.map((t=>t?(0,s.handleSingleMsgMD)(e,t):null)))}))).apply(this,arguments)}var u={CONSUMER:{CONSUMER:null,BIZ_NOT_HIGH:["biz_intro_bottom",null],BIZ_HIGH:["biz_intro_top","CURRENT"]},BIZ_NOT_HIGH:{CONSUMER:["biz_move_to_consumer_app",null],BIZ_NOT_HIGH:null,BIZ_HIGH:["biz_verified_transition_bottom_to_top","CURRENT"]},BIZ_HIGH:{CONSUMER:["biz_move_to_consumer_app",null],BIZ_NOT_HIGH:["biz_verified_transition_top_to_bottom","PREVIOUS"],BIZ_HIGH:null}};function c(e){return e.isBusiness?e.isVerifiedHigh?"BIZ_HIGH":"BIZ_NOT_HIGH":"CONSUMER"}function p(e,t,r){if(!l.default.bspSystemMessageEnabled){if(t.isVerifiedHigh&&r.isVerifiedHigh&&null!=t.verifiedName&&null!=r.verifiedName&&t.verifiedName!==r.verifiedName)return(0,n.genTealNotificationTemplateMsg)(e,"biz_name_change",[r.verifiedName]);var a=u[c(t)][c(r)];if(null!=a){var[i,s]=a,o=[];return"PREVIOUS"===s&&t.verifiedName?o.push(t.verifiedName):"CURRENT"===s&&r.verifiedName&&o.push(r.verifiedName),(0,n.genTealNotificationTemplateMsg)(e,i,o)}}}function h(e,t,r){if(l.default.bspSystemMessageEnabled){var a=(0,o.getContactPrivacyMode)(t.isBusiness,t.isEnterprise,t.privacyMode),i=(0,o.getContactPrivacyMode)(r.isBusiness,r.isEnterprise,r.privacyMode);if(a!==i)switch(i){case o.ReducedPrivacyMode.E2EE:return(0,n.genEncryptNotificationMsg)(e,"encrypt_now");case o.ReducedPrivacyMode.BSP:return(0,n.genTealNotificationTemplateMsg)(e,"biz_privacy_mode_to_bsp");case o.ReducedPrivacyMode.FB:return(0,n.genTealNotificationTemplateMsg)(e,"biz_privacy_mode_to_fb")}}}},75197:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.fetchFirstPartyStickers=function(){return h.apply(this,arguments)};var n=i(r(52954)),s=a(r(24461)),o=i(r(127)),l=i(r(38637)),d=i(r(84161)),u=i(r(22006)),c=i(r(31244)),p="https://static.whatsapp.net/sticker";function h(){return(h=(0,n.default)((function*(e,t){var r={id:e,lg:l.default.getLocale()},a=u.default.build(p,r),i=yield(0,o.default)(a,{signal:null==t?void 0:t.signal}),n=new d.default.StickerCommonQueryToStaticServer;if(n.set({httpResponseCode:i.status,params:new c.default(r).toString(),queryType:d.default.QUERY_TYPE.STICKER_PACK_DATA}),n.commit(),!i.ok)throw new s.InvalidServerResponseError(a,i.status.toString(),"Invalid response from WhatsApp stickers endpoint");var h=yield i.json();if(null==h||0===h.length)throw new s.InvalidServerResponseError(a,i.status.toString(),`Invalid response from WhatsApp stickers endpoint: ${JSON.stringify(h)}`);return h[0].stickers.map(((e,t)=>({mimetype:e.mimetype,width:e.width,height:e.height,index:t,filehash:e["file-hash"],directPath:e["direct-path"],mediaKey:e["media-key"],id:e["file-hash"],deprecatedMms3Url:e.url,encFilehash:e["enc-file-hash"],mediaKeyTimestamp:0})))}))).apply(this,arguments)}},81216:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.createGroup=function(e,t,r,a,i=!1){return E(e,t,r,a,void 0,i)},t.sendForNeededAddRequest=y;var n=i(r(70417)),s=a(r(2784)),o=r(8507),l=i(r(85030)),d=i(r(13277)),u=i(r(43805)),c=r(44122),p=r(33576),h=i(r(20468)),f=i(r(38637)),_=r(86690),m=i(r(93562)),g=i(r(2661)),v=r(25054);function E(e,t,r,a,i=(0,o.genId)(),n=!1){var u=a.map((e=>e.id)),h=void 0,v=(0,c.sendCreateGroup)(e,u,h,(0,g.default)(),!1,!1,n),S=new o.ActionType(f.default.t(98)),T=v.then((t=>(y(t,e,h),new o.ActionType(f.default.t(97))))).catchType(p.ServerStatusCodeError,(e=>406===e.status?new o.ActionType(f.default.t(93)+" "+f.default.t(94)):429===e.status?new o.ActionType(f.default.t(93)+" "+f.default.t(95)):void 0)).catch((()=>(__LOG__(3)`models:chatCollection:createGroup dropped`,new o.ActionType(f.default.t(93),{actionText:f.default.t(199),actionHandler:()=>E(e,t,r,a,i)}))));return d.default.openToast(s.createElement(o.ActionToast,{id:i,initialAction:S,pendingAction:T})),v.then((e=>{if(e.gid&&l.default.find(e.gid).then((e=>{d.default.openChatBottom(e).then((t=>{t&&d.default.focusChatTextInput(e)}))})),!e._duplicate&&t&&r){var a=m.default.gadd(e.gid);return(0,_.setProfilePic)(a,t,r)}e._duplicate&&__LOG__(3)`createGroup failed to set picture.`})).catchType(p.ServerStatusCodeError,(()=>{}))}function y(e,t,r,a){if(h.default.supportsFeature(h.default.F.GROUPS_V_4_JOIN_PERMISSION)&&e.participants){var i=a||e.gid;i||(__LOG__(4,void 0,new Error,!0)`Assertion failed!`,SEND_LOGS("Group add request was provided with undefined gid"));var s=e.participants.reduce(((e,t)=>{var r=Object.keys(t)[0];if("403"!==t[r].code)return e;var a=(0,v.createWid)(r),i=u.default.gadd(a,{silent:!0});return[...e,(0,n.default)((0,n.default)({},t[r]),{},{contact:i})]}),[]);s.length>0&&i&&d.default.openGroupV4InviteRequestFlow(s,i,t,r)}}},34330:(e,t,r)=>{"use strict";var a=r(14859),i=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.sendExitGroup=function(e){return f((0,h.unproxy)(e))},t.localExitGroup=_;var n=i(r(2784)),s=r(8507),o=a(r(13277)),l=r(33576),d=i(r(24461)),u=r(73953),c=r(66239),p=a(r(38637)),h=r(47138);function f(e){var{isGroup:t,promises:r}=e;if(!t)return Promise.reject(new d.ActionError);if(r.sendExit)return r.sendExit;var a=r.sendExit=(0,u.sendExitGroup)(e.id),i=new s.ActionType(p.default.t(108)),c=a.then((function(){return new s.ActionType(p.default.t(107))})).catchType(l.ServerStatusCodeError,(e=>{if(e.status>=400)return new s.ActionType(p.default.t(106))})).catch((function(){return __LOG__(3)`actions:chat:sendExit dropped`,new s.ActionType(p.default.t(106),{actionText:p.default.t(199),actionHandler:()=>f(e)})}));return o.default.openToast(n.createElement(s.ActionToast,{id:(0,s.genId)(),initialAction:i,pendingAction:c})),a.then((t=>{t._duplicate||_(e)})).finally((()=>{r.sendExit=null})).catchType(l.ServerStatusCodeError,(()=>{}))}function _(e){e.isGroup&&(e.groupMetadata.participants.remove((0,c.getMaybeMeUser)()),(0,u.markExited)(e.id).then((()=>{e.isReadOnly=!0})).catch((()=>{throw __LOG__(4,!0,new Error,!0)`failed to merge chat table`,SEND_LOGS("failed to merge chat table when exiting group"),new Error("failed to merge chat table")})))}},6471:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.handleGroupAction=function(e,t,r){return function(e,t,r){var{action:a}=r;switch(r.action){case o.SUBJECT:var s={name:r.subject};return e.contact.set(s),(0,i.persistGroupMetadata)(e.groupMetadata.id,{subject:r.subject});case o.ADD:case o.PROMOTE:case o.DEMOTE:var l=r.participants.map((e=>({id:e,isAdmin:"promote"===a})));e.groupMetadata.participants.add(l,{merge:!0}),"add"===a&&r.participants.forEach((t=>{n.default.trigger(`group_participant_change_${t.toString()}`,e.id)}));break;case o.REMOVE:var d=e.groupMetadata;r.participants.forEach((e=>{d.participants.remove(e)})),r.participants.forEach((t=>{n.default.trigger(`group_participant_change_${t.toString()}`,e.id)}));break;case o.MODIFY:if(t&&r.participants&&r.participants.length>0){var u=r.participants[0],c=e.groupMetadata.participants.remove(t),p=!1,h=!1;c&&c.length&&c[0]&&(p=c[0].isAdmin,h=c[0].isSuperAdmin);var f={id:u,isAdmin:p,isSuperAdmin:h};e.groupMetadata.participants.add(f)}break;case o.INVITE_CODE:r.code?e.groupMetadata.inviteCode=r.code:__LOG__(3)`model:chat:handleGroupAction:invalid invite code: ${r.code} for ${e.id.toString()}`;break;case o.DESC_ADD:return e.groupMetadata.set({desc:r.desc,descId:r.descId,descTime:r.descTime,descOwner:null==t?void 0:t.toString()}),(0,i.persistGroupMetadata)(e.groupMetadata.id,{desc:r.desc,descId:r.descId,descTime:r.descTime,descOwner:null==t?void 0:t.toString()});case o.DESC_REMOVE:if(e.groupMetadata.descId===r.descId)return e.groupMetadata.set({desc:void 0,descId:void 0,descTime:void 0,descOwner:void 0}),(0,i.persistGroupMetadata)(e.groupMetadata.id,{desc:void 0,descId:void 0,descTime:void 0,descOwner:void 0});break;case o.RESTRICT:return e.groupMetadata.restrict=!!r.value,(0,i.persistGroupMetadata)(e.groupMetadata.id,{restrict:!!r.value});case o.ANNOUNCE:return e.groupMetadata.announce=!!r.value,(0,i.persistGroupMetadata)(e.groupMetadata.id,{announce:!!r.value});case o.NO_FORWARD:return e.groupMetadata.noFrequentlyForwarded=!!r.value,(0,i.persistGroupMetadata)(e.groupMetadata.id,{noFrequentlyForwarded:!!r.value});case o.EPHEMERAL:return e.groupMetadata.ephemeralDuration=r.duration,(0,i.persistGroupMetadata)(e.groupMetadata.id,{ephemeralDuration:r.duration})}return Promise.resolve()}((0,s.unproxy)(e),t,r)},t.GROUP_ACTIONS=void 0;var i=r(7284),n=a(r(25120)),s=r(47138),o=Object.freeze({SUBJECT:"subject",ADD:"add",PROMOTE:"promote",DEMOTE:"demote",REMOVE:"remove",MODIFY:"modify",INVITE_CODE:"invite",DESC_ADD:"desc_add",DESC_REMOVE:"desc_remove",RESTRICT:"restrict",ANNOUNCE:"announce",NO_FORWARD:"no_frequently_forwarded",EPHEMERAL:"ephemeral"});t.GROUP_ACTIONS=o},12104:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.handleGroupActionWap=function(){return _.apply(this,arguments)},t.handleGroupActionMD=function(e,t){if(s.default.supportsFeature(s.default.F.MD_BACKEND))return function(){return g.apply(this,arguments)}(e,t);return Promise.reject(new Error("handleGroupActionMD: only supported on MD"))},t.handleGroupCreation=function(e,t){if(s.default.supportsFeature(s.default.F.MD_BACKEND))return function(){return m.apply(this,arguments)}(e,t);return Promise.reject(new Error("handleGroupCreation: should not be called in wap mode"))};var i=a(r(70417)),n=a(r(52954)),s=a(r(20468)),o=r(6471),l=r(30421),d=a(r(62820)),u=a(r(43805)),c=r(38027),p=r(79479),h=r(14963),f=r(92138);function _(){return(_=(0,n.default)((function*(e,t){var{chatId:a,author:i}=e,n=r(85030).default.get(a);if(n){if(t.action===o.GROUP_ACTIONS.SUBJECT){var s={name:t.subject};yield(0,l.updateLocal)(n.contact.id,s)}(0,o.handleGroupAction)(n,i,t)}else __LOG__(3)`model:chat: unknown chat for ${a.toString()}, action ${JSON.stringify(t)}`}))).apply(this,arguments)}function m(){return(m=(0,n.default)((function*(e,t){var{chatId:a,author:n,pushname:s}=e;n&&s&&(0,p.updatePushname)(n,s),yield Promise.all([(0,f.updateParticipants)(t.id,t.participants,t.pvId),(0,h.updateGroupMetadataTable)([t])]);var o=r(85030).default,l=o.get(a);if(l)return l.groupMetadata.set(t),Promise.resolve();var _=new d.default({id:a,t:t.creation});_.groupMetadata.set(t),t.subject&&[].push({id:t.id,change:{name:t.subject}});var m=(0,i.default)((0,i.default)({},_.toJSON()),{},{id:a.toString()});yield(0,c.getChatTable)().create(m),o.add(_),u.default.gadd(t.id).set({name:t.subject})}))).apply(this,arguments)}function g(){return(g=(0,n.default)((function*(e,t){var{chatId:a,author:i,pushname:n}=e;i&&n&&(0,p.updatePushname)(i,n);var s=[],l=r(85030).default.get(a);switch(t.action){case o.GROUP_ACTIONS.ADD:s.push((0,f.addParticipants)(a,t.participants,t.version,t.prevVersion));break;case o.GROUP_ACTIONS.REMOVE:s.push((0,f.removeParticipants)(a,t.participants,t.version,t.prevVersion));break;case o.GROUP_ACTIONS.DEMOTE:s.push((0,f.demoteParticipants)(a,t.participants,t.version,t.prevVersion));break;case o.GROUP_ACTIONS.PROMOTE:s.push((0,f.promoteParticipants)(a,t.participants,t.version,t.prevVersion))}yield Promise.all(s),l&&(0,o.handleGroupAction)(l,i,t)}))).apply(this,arguments)}},97825:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.queryGroupFromPhone=function(e){return(0,l.groupMetadataFindFromPhone)(e).then((t=>"ok"===t.status?t.data:"missing"!==t.status?"error"===t.status?(__LOG__(3)`model:GroupMetadata:find error ${t.info}`,Promise.reject(new Error("model:GroupMetadata:find error"))):void 0:void(0,n.default)((()=>{r(85030).default.assertGet(e).delete()}))))},t.queryGroupInviteInfo=function(e){return(0,l.sendQueryGroupInvite)(e).then((e=>{var{status:t,subject:a}=e,n=(0,i.default)(e,["status","subject"]),l=new o.default(n);s.default.gadd(l.id);var d=r(85030).default.get(l.id);return{status:t,subject:a,groupMetadata:l,inGroup:!!d&&!d.isReadOnly}}))};var i=a(r(22220)),n=a(r(98874)),s=a(r(43805)),o=a(r(27512)),l=r(12390)},14963:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.queryAndUpdateAllGroupMetadata=function(){return(0,d.queryAllGroups)().then(function(){var e=(0,n.default)((function*(e){e&&(yield h(e),yield _(e),e.forEach(p))}));return function(){return e.apply(this,arguments)}}())},t.queryAndUpdateGroupMetadataById=function(e){if(s.default.supportsFeature(s.default.F.MD_BACKEND))return(0,d.queryGroup)(e).then(function(){var e=(0,n.default)((function*(e){yield h([e]),yield _([e]),p(e)}));return function(){return e.apply(this,arguments)}}());return Promise.resolve()},t.updateGroupMetadataTable=h;var i=a(r(70417)),n=a(r(52954)),s=a(r(20468)),o=a(r(25120)),l=r(38027),d=r(33941),u=r(12390),c=r(92166);function p(e){var t;(0,u.updateSubject)(e.id,e.subject),o.default.gadd(e.id).set({id:e.id,owner:e.owner,creation:e.creation,desc:e.desc,descId:e.descId,descOwner:e.descOwner,descTime:e.descTime,restrict:e.restrict||!1,announce:e.announce||!1,noFrequentlyForwarded:e.noFrequentlyForwarded||!1,ephemeralDuration:e.ephemeralDuration||0,participants:e.participants,support:null!==(t=e.support)&&void 0!==t&&t})}function h(){return f.apply(this,arguments)}function f(){return(f=(0,n.default)((function*(e){if(s.default.supportsFeature(s.default.F.MD_BACKEND)){var t=[];return yield(0,c.getStorage)().lock(["group-metadata"],function(){var r=(0,n.default)((function*([r]){var a=yield r.bulkGet(e.map((e=>e.id.toString())));t=e.map(((e,t)=>{var r,n,s,o=a[t],l={subject:e.subject,subjectTime:e.subjectTime||0},d={announce:e.announce,a_v_id:e.a_v_id||0},u={desc:e.desc,descId:e.descId,descOwner:null===(r=e.descOwner)||void 0===r?void 0:r.toString(),descTime:e.descTime||0};if(o){var c=o.subjectTime||0,p=o.a_v_id||0,h=o.descTime||0;c>l.subjectTime&&(l={subject:o.subject,subjectTime:c}),p>d.a_v_id&&(d={announce:o.announce,a_v_id:p}),h>u.descTime&&(u={desc:o.desc,descId:o.descId,descOwner:o.descOwner,descTime:h})}return(0,i.default)((0,i.default)((0,i.default)({id:e.id.toString(),creation:e.creation,owner:null===(n=e.owner)||void 0===n?void 0:n.toString(),restrict:e.restrict,noFrequentlyForwarded:e.noFrequentlyForwarded,ephemeralDuration:e.ephemeralDuration||0,size:e.size||0,support:null!==(s=e.support)&&void 0!==s&&s},l),u),d)}))}));return function(){return r.apply(this,arguments)}}()),(0,l.getGroupMetadataTable)().bulkCreateOrMerge(t)}yield Promise.resolve()}))).apply(this,arguments)}function _(){return m.apply(this,arguments)}function m(){return(m=(0,n.default)((function*(e){if(s.default.supportsFeature(s.default.F.MD_BACKEND)){var t=yield(0,l.getParticipantTable)().bulkGet(e.map((e=>e.id.toString()))),r=new Map;t.forEach((e=>e&&r.set(e.groupId,e.senderKey)));var a=e.map((e=>{var t,a=[],i=[],n=e.id.toString(),s=r.get(n)||new Map;return null===(t=e.participants)||void 0===t||t.forEach((e=>{e.isAdmin&&i.push(e.id),a.push(e.id),s.set(String(e.id),!1)})),{groupId:n,participants:a.map(String),admins:i.map(String),senderKey:s,rotateKey:!1,deviceSyncComplete:!1}}));return(0,l.getParticipantTable)().bulkCreateOrReplace(a)}yield Promise.resolve()}))).apply(this,arguments)}},92138:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.updateParticipants=function(){return d.apply(this,arguments)},t.addParticipants=function(){return u.apply(this,arguments)},t.removeParticipants=function(e,t,a,i){if(n.default.supportsFeature(n.default.F.MD_BACKEND))return null==a?Promise.reject(new Error("removeParticipants: incoming change missing version id")):(0,o.updateParticipants)(e,{action:o.PARTICIPANT_OPERATION.REMOVE,participants:t,version:a,prevVersion:i}).catchType(o.GroupUnSyncedError,(()=>{__LOG__(3)`removeParticipants: out-of-sync group notification`,(0,r(12390).sendQueryGroup)(e)}));return Promise.resolve()},t.demoteParticipants=function(){return c.apply(this,arguments)},t.promoteParticipants=function(){return p.apply(this,arguments)};var i=a(r(52954)),n=a(r(20468)),s=r(47882),o=r(61333),l=r(25054);function d(){return(d=(0,i.default)((function*(e,t,r){if(n.default.supportsFeature(n.default.F.MD_BACKEND)){var a=[],i=[];t.forEach((e=>{e.isAdmin&&i.push(e.id),a.push(e.id)}));var s=yield h(a);return(0,o.replaceParticipants)(e,a,i,s,r)}yield Promise.resolve()}))).apply(this,arguments)}function u(){return(u=(0,i.default)((function*(e,t,a,i){if(n.default.supportsFeature(n.default.F.MD_BACKEND)){if(null==a)throw new Error("addParticipants: incoming change missing version id");var s=yield h(t);return(0,o.updateParticipants)(e,{action:o.PARTICIPANT_OPERATION.ADD,participants:t,deviceIds:s,version:a,prevVersion:i}).catchType(o.GroupUnSyncedError,(()=>{__LOG__(3)`addParticipants: out-of-sync group notification`,(0,r(12390).sendQueryGroup)(e)}))}yield Promise.resolve()}))).apply(this,arguments)}function c(){return(c=(0,i.default)((function*(e,t,a,i){if(n.default.supportsFeature(n.default.F.MD_BACKEND)){if(null==a)throw new Error("demoteParticipants: incoming change missing version id");return(0,o.updateParticipants)(e,{action:o.PARTICIPANT_OPERATION.DEMOTE,participants:t,version:a,prevVersion:i}).catchType(o.GroupUnSyncedError,(()=>{__LOG__(3)`demoteParticipants: out-of-sync group notification`,(0,r(12390).sendQueryGroup)(e)}))}yield Promise.resolve()}))).apply(this,arguments)}function p(){return(p=(0,i.default)((function*(e,t,a,i){if(n.default.supportsFeature(n.default.F.MD_BACKEND)){if(null==a)throw new Error("promoteParticipants: incoming change missing version id");return(0,o.updateParticipants)(e,{action:o.PARTICIPANT_OPERATION.PROMOTE,participants:t,version:a,prevVersion:i}).catchType(o.GroupUnSyncedError,(()=>{__LOG__(3)`promoteParticipants: out-of-sync group notification`,(0,r(12390).sendQueryGroup)(e)}))}yield Promise.resolve()}))).apply(this,arguments)}function h(){return f.apply(this,arguments)}function f(){return(f=(0,i.default)((function*(e){var t=yield(0,s.syncAndGetDeviceList)(e),r=[];return t.forEach(((t,a)=>{if(t){var{devices:i,id:n}=t;r=r.concat(i.map((e=>(0,l.createDeviceWidFromUserAndDevice)(n,e))))}else r.push(e[a])})),r}))).apply(this,arguments)}},36900:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t=!0){if(!(0,n.getMaybeMeUser)().equals(e.id)){var r=s.default.get(e.id);r&&("unsubscribe"===e.type?r.set({isSubscribed:!1,stale:!0}):(!function(e,t){var r,a=!1;void 0===t.type?t.type=e.chatstate.type||"unavailable":"paused"===t.type&&(a=!0,t.type="available");e.isGroup&&"available"!==t.type&&(t.updateTime=Date.now());if(e.isGroup){if(!t.participant)return;t.id=t.participant,t.participant=void 0,r=e.chatstates.gadd(t.id)}else r=e.chatstate;a&&"composing"!==r.type&&"recording"!==r.type||r.set(t);r.expireTimerId&&clearTimeout(r.expireTimerId);"composing"===r.type||"recording"===r.type?r.expireTimerId=setTimeout((()=>function(e){var t=e.type;"composing"!==t&&"recording"!==t||(e.type="available")}(r)),i.default.PRESENCE_COMPOSING_TIMEOUT):r.expireTimerId=void 0;var n=e.forceDisplay||e.isOnline||e.isUser&&!e.chatstate.deny;e.set({hasData:!0,forceDisplay:n})}(r,e),t&&r.set({stale:!1})))}return Promise.resolve()};var i=a(r(23045)),n=r(66239),s=a(r(93997))},30229:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.changeProfilePicThumb=function(e,t){return i.default.imageChanged(e,t),Promise.resolve()};var i=a(r(93562))},58666:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.updateMsgAck=d,t.processOrphanAck=function(e,t){var r=s.default.get(e);if(!r)return Promise.reject(`processOrphanAck: no msg found for id ${e.toString()}`);return(0,i.getHighestAck)(r).then((e=>{if(e&&e.ack!==r.ack)return d(r,t,e)})).catch((()=>{__LOG__(4,void 0,new Error,!0)`Assertion failed!`,SEND_LOGS("processOrphanAck failed")}))};var i=r(90605),n=r(53353),s=a(r(30528)),o=a(r(43926)),l=r(25054);function d(e,t,r){var{ack:a,t:i,from:s,to:d}=r,{remote:u,id:c}=e.id;e.updateAck(a,i);var p=(0,n.getBridge)();return p.sendAndReceive("msg_collection","updateLastReceipt",{wid:u,t:i}).then((()=>o.default.isUser(u)?p.sendAndReceive("msg_info_collection","updateInfo",{id:c,from:s,to:d,ack:a,participant:u,t:i}).then((()=>{if(t&&o.default.isBroadcast(t)){var e=t instanceof o.default?t:(0,l.createWid)(t);return p.sendAndReceive("msg_info_collection","updateInfo",{id:c,from:s,to:e,ack:a,participant:u,t:i})}})):o.default.isStatusV3(u)?p.sendAndReceive("msg_info_collection","updateInfo",{id:c,from:s,to:u,ack:a,participant:d,t:i}):void 0))}},29351:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.handleForActiveMessageRange=g,t._rangeContainsMessage=E,t.handleOfflineForMessageRange=function(){return y.apply(this,arguments)},t.ActiveRangeHandlerAction=t.RangeContain=void 0;var n=i(r(52954)),s=i(r(23045)),o=r(25364),l=a(r(87425)),d=r(25054),u=r(99854),c=new Set,p=r(28103).Mirrored(["DOES_NOT_CONTAIN","CONTAINS_BY_TIMESTAMP","CONTAINS_BY_ADDITIONAL"]);t.RangeContain=p;var h=r(28103).Mirrored(["DropMessage","SkipUI"]);t.ActiveRangeHandlerAction=h;var f=e=>e.reduce(((e,t)=>new Set([...e,...t])),new Set);function _(){return m.apply(this,arguments)}function m(){return(m=(0,n.default)((function*(e,t,r){switch(e.action){case"archive":return e.actionValue.archived?yield l.handleForArchive(e,r):yield l.handleForUnarchive(e,r),c;case"markChatAsRead":return yield l.handleForMarkAsReadUnread(e,r,!!e.actionValue.read),c}return c}))).apply(this,arguments)}function g(){return v.apply(this,arguments)}function v(){return(v=(0,n.default)((function*(e,t){if(s.default.SYSTEM_MESSAGE_TYPES.includes(t.type))return c;var r=(yield(0,u.getActiveMessageRanges)(e.toString())).map((e=>[e,E(e.actionValue.messageRange,t)])),a=r.filter((([,e])=>e===p.CONTAINS_BY_ADDITIONAL)).map((([e])=>e));a.forEach((e=>{e.remainingMessages--})),yield(0,u.bulkUpdateActiveMessageRanges)(a);var i=r.map((([e,r])=>_(e,t,r))),n=yield Promise.all(i);return f(n)}))).apply(this,arguments)}function E(e,t){if(null==e)return __LOG__(3)`syncd: missing message range from row.`,p.DOES_NOT_CONTAIN;var{messages:r,lastMessageTimestamp:a}=e;if(null!=t.t&&null!=a&&t.t<(0,o.numberOrThrowIfTooLarge)(a))return p.CONTAINS_BY_TIMESTAMP;var i=t.id;for(var{key:n}of r)if(null!=n&&null!=i&&n.id===i.id)return p.CONTAINS_BY_ADDITIONAL;return p.DOES_NOT_CONTAIN}function y(){return(y=(0,n.default)((function*(e){var t=new Map;e.forEach((e=>{if(!s.default.SYSTEM_MESSAGE_TYPES.includes(e.type)){var r=t.get(e.id.remote.toString());(null==r||r.t<e.t)&&t.set(e.id.remote.toString(),e)}})),yield Promise.all([...t.entries()].map((([e,t])=>g((0,d.createWid)(e),t))))}))).apply(this,arguments)}},87425:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.handleForArchive=function(){return d.apply(this,arguments)},t.handleForUnarchive=function(){return u.apply(this,arguments)},t.handleForMarkAsReadUnread=function(){return c.apply(this,arguments)};var i=a(r(52954)),n=r(99854),s=r(29351),o=a(r(85030)),l=r(25054);function d(){return(d=(0,i.default)((function*(e,t){t===s.RangeContain.DOES_NOT_CONTAIN&&(r(54064).default.setArchive([{id:e.chatId,archive:!1}]),yield(0,n.removeActiveMessageRange)(e.chatId,e.action))}))).apply(this,arguments)}function u(){return(u=(0,i.default)((function*(e,t){t!==s.RangeContain.DOES_NOT_CONTAIN&&0!==e.remainingMessages||(yield(0,n.removeActiveMessageRange)(e.chatId,e.action))}))).apply(this,arguments)}function c(){return(c=(0,i.default)((function*(e,t,a){if(t===s.RangeContain.DOES_NOT_CONTAIN)yield(0,n.removeActiveMessageRange)(e.chatId,e.action);else if(0===e.remainingMessages){var i=o.default.get((0,l.createWid)(e.chatId));if(i){var d=r(76710);a?d.markSeen(i):d.markUnseen(i)}yield(0,n.removeActiveMessageRange)(e.chatId,e.action)}}))).apply(this,arguments)}},62711:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.handleSingleMsgMD=function(){return m.apply(this,arguments)},t.handleMsgsMD=function(e,t){var r=t.length;if(!r)return Promise.resolve();if(!(e instanceof p.default))return Promise.resolve();for(var a={add:"before",isHistory:!0},i=0;i<r;i++){t[i].invis=!0}var n=(0,d.getBridge)();return n.fireAndForget("msg_collection","trigger",{name:"handle:msg_history",args:{count:t.length}}),(0,u.storeMessages)(t,e,!0).then((()=>{(0,_.checkOrphanMutations)(t.map((e=>e.id.toString())),[e.toString()])})).then((()=>n.sendAndReceive("msg_collection","processMultipleMessages",{chatId:e,msgObjs:t,meta:a,chatMsgsCollection:null}))).catchType(l.LogoutDrop,(()=>{})).catch((t=>{__LOG__(4,void 0,new Error,!0)`Msgs count: ${r} Chat: ${String(e)} Error: ${t.name}, message: ${t.message}, stack: ${t.stack}`,SEND_LOGS("msg_handler for MD: error storing/processing multiple messages")}))},t.handleInitialSyncMsgs=function(e){var t={add:"last",isHistory:!0},r=Object.keys(e).map((r=>(0,d.getBridge)().sendAndReceive("msg_collection","processMultipleMessages",{chatId:(0,h.createWid)(r),msgObjs:e[r].msgs,meta:t,chatMsgsCollection:null})));return Promise.all([...r,(0,u.storeInitialSyncMessages)(e)]).then((()=>{var t=Array.prototype.concat(...Object.keys(e).map((t=>e[t].msgs.map((e=>e.id.toString())))));return(0,_.checkOrphanMutations)(t,Object.keys(e))})).then((()=>{})).catchType(l.LogoutDrop,(()=>{})).catch((e=>{__LOG__(4,void 0,new Error,!0)`Error: ${e.name}, message: ${e.message}, stack: ${e.stack}`,SEND_LOGS("msg_handler for MD: error storing/processing multiple messages")}))},t.handleProgressiveHistorySyncMsgs=function(e,t){return Promise.resolve().then((()=>(0,u.storeRecentAndFullHistSyncMessages)(e,t,!0,!0).then((()=>{var r=t.map((e=>e)),a=e.map((e=>e.id.toString()));return(0,_.checkOrphanMutations)(a,r)})).then((()=>{})).catchType(l.LogoutDrop,(()=>{})).catch((e=>{__LOG__(4,void 0,new Error,!0)`Error: ${e.name}, message: ${e.message}, stack: ${e.stack}`,SEND_LOGS("handleProgressiveHistorySyncMsgs: error storing/processing multiple messages")}))))};var n=i(r(52954)),s=r(60266),o=r(13275),l=r(33576),d=r(53353),u=r(245),c=a(r(56179)),p=i(r(43926)),h=r(25054),f=r(29351),_=r(9365);function m(){return(m=(0,n.default)((function*(e,t,r=!1){var a,i=(0,d.getBridge)(),h=yield(0,f.handleForActiveMessageRange)(e,t);if(!h.has(f.ActiveRangeHandlerAction.DropMessage)){a=h.has(f.ActiveRangeHandlerAction.SkipUI);try{p.default.isStatusV3(e)&&(yield i.sendAndReceive("status_v3_collection","handleUpdate",{rawMsg:t,checksum:null,isMsgUpdate:!1})),r?yield(0,u.updateMessage)(t):yield(0,o.promiseLoop)(function(){var r=(0,n.default)((function*(r,a,i){var n=(0,s.delayMs)(c.expBackoff(i,12e4,1e3,.1));try{yield(0,u.storeMessages)([t],e),__LOG__(2,void 0,void 0,void 0,["handleSingleMsgMD"])`storeMessages loop`,r()}catch(e){return __LOG__(2,void 0,void 0,void 0,["handleSingleMsgMD"])`storeMessages loop: failed with error ${e}.`,i>3?(__LOG__(3)`storeMessages loop: Gave up after ${i} tries`,Promise.reject(e)):n}}));return function(){return r.apply(this,arguments)}}()),__LOG__(2,void 0,void 0,void 0,["messaging"])`handleSingleMsgMD: msgId::${t.id.id}, write message to db done, overwrite: ${r}`;try{yield(0,_.checkOrphanMutations)([t.id.toString()],[e.toString()])}catch(r){__LOG__(4,void 0,new Error)`handleSingleMsgMD: checkOrphanMutations failed during handleSingleMsgMD for: ${String(t.id)} chat: ${String(e)} Error: ${r.name}, message: ${r.message}, stack: ${r.stack}`}a||(t.recvFresh=!0,t.isNewMsg=!0,yield i.sendAndReceive("msg_collection","processMultipleMessages",{chatId:e,msgObjs:[t],meta:{add:"after",update:!1,isHistory:!1}}))}catch(r){if(r instanceof l.LogoutDrop)return;__LOG__(4,void 0,new Error,!0,["messaging"])`Msg: ${String(t.id)} chat: ${String(e)} Error: ${r.name}, message: ${r.message}, stack: ${r.stack}`,SEND_LOGS("msg_handler for MD: error storing/processing single message")}}}))).apply(this,arguments)}},39427:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.updateMsgInfo=function(e,t,r,a){if(n.default.supportsFeature(n.default.F.MD_BACKEND))return function(e,t,r,a){var i=e.id;o.default.isUser(i.remote)?function(e,t,r,a){t===l.PLAYED?(e.played.get(r)||(e.playedRemaining-=1),e.played.add({id:r,t:a})):t===l.READ?(e.read.get(r)||(e.readRemaining-=1),e.read.add({id:r,t:a})):t===l.RECEIVED&&(e.delivery.get(r)||(e.deliveryRemaining-=1),e.delivery.add({id:r,t:a}))}(e,t,r,a):function(e,t,r,a){var i=l.CLOCK;e.played.get(r)?i=l.PLAYED:e.read.get(r)?i=l.READ:e.delivery.get(r)&&(i=l.RECEIVED);if(t<=i)return;if(t>l.RECEIVED){var n=e.delivery.get(r);n?e.delivery.remove(n):e.deliveryRemaining-=1}if(t>l.READ){var s=e.read.get(r);s?e.read.remove(s):e.readRemaining-=1}t===l.PLAYED?(e.played.get(r)||(e.playedRemaining-=1),e.played.add({id:r,t:a})):t===l.READ?(e.read.get(r)||(e.readRemaining-=1),e.read.add({id:r,t:a})):t===l.RECEIVED&&(e.delivery.get(r)||(e.deliveryRemaining-=1),e.delivery.add({id:r,t:a}))}(e,t,r,a)}((0,s.unproxy)(e),t,r,a);return function(e,t,r,a){var i=e.id;if(!o.default.isUser(i.remote)){if(t!==l.RECEIVED){var n=e.delivery.get(r);n&&e.delivery.remove(n)}if(t!==l.READ){var s=e.read.get(r);s&&e.read.remove(s)}if(t!==l.PLAYED){var d=e.played.get(r);d&&e.played.remove(d)}}t===l.PLAYED?(e.played.get(r)||(e.playedRemaining-=1),e.played.add({id:r,t:a})):t===l.READ?(e.read.get(r)||(e.readRemaining-=1),e.read.add({id:r,t:a})):t===l.RECEIVED&&(e.delivery.get(r)||(e.deliveryRemaining-=1),e.delivery.add({id:r,t:a}))}((0,s.unproxy)(e),t,r,a)};var i=a(r(23045)),n=a(r(20468)),s=r(47138),o=a(r(43926)),{ACK:l}=i.default},35062:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t._processMultipleMessages=function(){return y.apply(this,arguments)};var n=i(r(52954)),s=i(r(30535)),o=i(r(99461)),l=i(r(23045)),d=r(66239),u=i(r(87838)),c=i(r(20468)),p=r(27305),h=r(60301),f=a(r(68439)),_=i(r(25150)),m=i(r(11541)),g=i(r(54559)),v=r(44042),E=i(r(43926));function y(){return(y=(0,n.default)((function*(e,t,a,i){var{filteredRecs:n,reorderRecs:y,updates:T}=(0,u.default)(e,t,a,i);yield Promise.all(T);var A,b=r(85030).default,C=r(30528).default;if(0===n.length&&0===y.length){if(e&&a.pendingMsgsDone){var P=b.get(e);P&&(P.pendingMsgs=!1)}return t.map((e=>C.get(e.id))).filter((e=>e))}if(!e)return S(n).then((()=>t.map((e=>C.get(e.id))).filter((e=>e&&!!e.chat))));if(E.default.isStatusV3(e)){var O=t[0],w=O.id.fromMe?(0,d.getMaybeMeUser)():O.author;A=r(65677).default.find(w)}else{if((0,v.shouldCreateChatWithMsgs)(t))A=b.find(e);else{var M=b.get(e);if(null==M)return[];A=Promise.resolve(M)}}var I,R,D=yield A,N=yield S(n),L="after"===a.add||"last"===a.add,k=!a.isHistory,U=!1;if("unread"===a.add?(I=i,D.msgChunks.push(I),R=a.firstUnreadKey):"last"===a.add&&a.resume?(I=i,U=!0):I="function"==typeof i?i():i,(0,s.default)(t,N,y,D,L,I||D.msgs,R,U),a.pendingMsgsDone&&(D.pendingMsgs=!1),k&&E.default.isBroadcast(e)&&!E.default.isStatusV3(e)&&N.forEach((function(e){e&&e.recvFresh&&!e.isNotification&&f.broadcastFanout(e)})),c.default.supportsFeature(c.default.F.RECENT_EMOJI_SYNC))for(var G=0;G<N.length;G++){var F=N[G];if(F&&F.isNewMsg&&F.isSentByMe&&F.containsEmoji){_.default.throttledSync();break}}if(c.default.supportsFeature(c.default.F.MD_BACKEND)){var x=N.map((e=>{if(e&&e.isSentByMe&&e.type===l.default.MSG_TYPE.STICKER){var{mediaData:t,mediaObject:r}=e,a=null==r?void 0:r.entries.entries[0];return[{id:t.filehash,directPath:t.directPath,filehash:t.filehash,encFilehash:(null==a?void 0:a.encFilehash)||t.encFilehash,mediaKey:(null==a?void 0:a.mediaKey)||t.mediaKey,mediaKeyTimestamp:null!=t.mediaKeyTimestamp?t.mediaKeyTimestamp:o.default.globalUnixTime(),width:t.fullWidth,height:t.fullHeight,size:t.size,mimetype:t.mimetype,type:h.OUTWARD_TYPES.STICKER,index:0},e.t]}})).filter(Boolean);r(11506).default.enqueue(x)}if(c.default.isRecentStickersEnabled()){var B=N.map((e=>{if(e&&e.isNewMsg&&e.isSentByMe&&e.type===l.default.MSG_TYPE.STICKER){var{mediaData:t}=e;return{id:t.filehash,directPath:t.directPath,filehash:t.filehash,encFilehash:t.encFilehash,mediaKey:t.mediaKey,mediaKeyTimestamp:null!=t.mediaKeyTimestamp?t.mediaKeyTimestamp:o.default.globalUnixTime(),width:t.fullWidth,height:t.fullHeight,size:t.size,mimetype:t.mimetype,type:h.OUTWARD_TYPES.STICKER,index:0}}})).filter(Boolean);m.default.enqueue(B)}if(g.default.webDownloadDocumentThumbMmsEnabled&&N.map((e=>e.asDoc)).filter(Boolean).forEach((e=>{(0,p.downloadMmsThumbnail)({msg:e,isPreload:!0})})),c.default.supportsFeature(c.default.F.DOWNLOAD_STATUS_THUMB_MMS)&&E.default.isStatusV3(e)){var Y=(0,d.getLastStatusUsage)();(null==Y||Date.now()-Y<12096e5)&&N.map((e=>e.asImage||e.asVideo)).filter(Boolean).forEach((e=>{(0,p.downloadStatusV3Thumbnail)({msg:e,isPreload:!0})}))}return t.map((e=>C.get(e.id))).filter((e=>e))}))).apply(this,arguments)}function S(e){var t=r(30528).default.add(e,{merge:!0});return c.default.supportsFeature(c.default.F.MD_BACKEND)&&(t=t.filter(((t,r)=>(null==t&&(__LOG__(4,void 0,new Error,!0)`Get empty message with id ${e[r].id}.`,SEND_LOGS("msgPrepWork-empty-message")),null!=t)))),Promise.all(t.map((e=>e.waitForPrep().catch((e=>{__LOG__(4,void 0,new Error,!0)`Assertion failed! ${String(e)}`,SEND_LOGS("bad-msg-prep")}))))).then((()=>t))}},30535:(e,t,r)=>{"use strict";var a=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,r,a,n,s,o,l){var d=function(e,t,r,a,i){var n,s,o,l={},d={},u=r.length,c=i;if(0===u)return{msgs:t,collection:c};for(n=0;n<u;n++)s=r[n],d[s.id]=s;for(u=t.length,n=0;n<u;n++)(s=t[n])&&(l[s.id]=s);var p=[];for(u=e.length,n=0;n<u;n++)if((s=e[n])&&((o=l[s.id])&&p.push(o),o=d[s.id]))if(o.recvFresh)p.push(o),a.removeMsg(o),o.unset("recvFresh");else{var h=a.getAllCMCs().find((function(e){return e.get(o.id)}));i&&h===i||(h?(h.forEach((function(e){p.push(e),delete d[e.id]})),h===a.msgs?(a.replaceMsgsCollection(i),c=a.msgs):(a.notifyMsgCollectionMerge(i,h,i),a.removeMsgsCollection(h))):(__LOG__(3)`models:Msg:reorder trying to merge CMC of orphaned message ${s.id}`,p.push(d[s.id])))}return{msgs:p,collection:c}}(e,t,r,a,s);i.addRecordsToChat(d.msgs,a,n,d.collection,o,l)};var i=a(r(68439))},87838:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a,i){var y=[],S=[],T=[],A=r(85030).default,b=r(30528).default;return t.forEach((function(t){var C;t.id instanceof p.default||(__LOG__(3)`_processMultipleMessages: el.id is not a MsgKey ${(new Error).stack}`,l.upload({reason:"forgot-to-create-msgkey"}),t.id=new p.default({from:t.from,to:t.to,id:t.id,participant:t.participant,selfDir:t.self})),(0,g.isString)(e)&&E.default.isBroadcast(e)&&delete t.broadcast,"ptt"===t.type&&!t.id.fromMe&&t.ack<d.default.ACK.CLOCK&&(t.ack=d.default.ACK.CLOCK),null!=t.hydratedButtons&&((C=t).buttons=new m.default,C.buttons.add(C.hydratedButtons.map(((e,t)=>{var r=`${null!=e.index?e.index:t}`;return e.quickReplyButton?new _.default({id:r,displayText:e.quickReplyButton.displayText,selectionId:e.quickReplyButton.id,subtype:"quick_reply"}):e.callButton?new _.default({id:r,displayText:e.callButton.displayText,phoneNumber:e.callButton.phoneNumber,subtype:"call"}):new _.default({id:r,displayText:e.urlButton.displayText,url:e.urlButton.url,subtype:"url"})})))),null!=t.dynamicReplyButtons&&function(e){e.replyButtons=new o.default,e.replyButtons.add(e.dynamicReplyButtons.map((({buttonId:e,buttonText:t})=>new s.default({id:e,displayText:null==t?void 0:t.displayText}))))}(t);var P=b.get(t.id);if(t.type===d.default.MSG_TYPE.PROTOCOL&&"ephemeral_setting"!==t.subtype)switch(t.subtype){case"revoke":if(P=b.get(t.protocolMessageKey)){var O=new b.constructor.model(t);E.default.equals(P.sender,O.sender)?(E.default.isStatusV3(e)&&P.msgChunk&&P.msgChunk.remove(P),(0,f.revoke)(P,O.id),E.default.isStatusV3(e)&&r(65677).default.find(P.sender).then((e=>{c.default.supportsFeature(c.default.F.QUERY_STATUS_V_3_THUMBNAIL)&&P&&P.msgChunk&&P.msgChunk.length!==e.totalCount&&v.default.statusQueryThumbnail(e.id)}))):__LOG__(3)`model:Msg:processMM revoke sender mismatch ${O.id.toString()}, ${P.id.toString()}`}break;case"ephemeral_sync_response":var w=A.get(t.id.remote);w&&(0,u.maybeUpdateEphemeralSetting)(w,t.ephemeralDuration,t.ephemeralSettingTimestamp);break;default:__LOG__(2)`unknown protocolMessage ${t.id.toString()}`}else if(P&&!P.asRevoked){for(var M in t.ack<P.ack&&delete t.ack,t)t.hasOwnProperty(M)&&void 0===t[M]&&delete t[M];t.id.fromMe&&!P.deprecatedMms3Url&&t.deprecatedMms3Url&&(t.phoneUploading=!1),a.isHistory&&(t.isNewMsg=!1);var I=P.t?(0,n.default)(t,["t","id","from","to"]):t,R=P.applyUpdate(I).then((()=>P));if(T.push(R),E.default.isBroadcast(P.id.remote)){var D=h.getBroadcastFanoutKeys(P);D&&D.forEach((e=>{var t=b.get(e);t&&T.push(t.applyUpdate(I).then((()=>P)))}))}a.isHistory&&(P.recvFresh||i)&&!P.search?(__LOG__(3)`model:Msg:handle:processMM:${P.recvFresh?"dup:":"overlap:"}${String(P.id)}`,S.push(P)):a.isHistory&&P.search?(P.search=!1,__LOG__(3)`model:Msg:handle:processMM load search as history ${String(P.id)}`,y.push({id:P.id})):"search"===a.add&&y.push({id:P.id})}else{h.typeIsMms(t)&&!t.deprecatedMms3Url&&(t.phoneUploading=t.id.fromMe&&t.ack===d.default.ACK.CLOCK);var N=A.get(t.id.remote);"search"===a.add&&(t.search=!0),a.update||y.push(t),!a.isHistory&&"search"!==a.add&&N&&function(e,t){if(!e.isNewMsg||!e.recvFresh)return __LOG__(3,void 0,void 0,!0)`processLiveMessage should not be called with history message id ${e.id.toString()}`,void SEND_LOGS("bad-process-live-message-call");e.type===d.default.MSG_TYPE.GP2&&"delete"===e.subtype&&(t.isReadOnly=!0);if(t.isUser){var r,a,i=null!==(r=e.ephemeralDuration)&&void 0!==r?r:0,n=!1;e.type===d.default.MSG_TYPE.PROTOCOL&&"ephemeral_setting"===e.subtype?a=e.t:e.ephemeralSettingTimestamp&&(a=e.ephemeralSettingTimestamp,n=!0);var s=!0;if(null!=a&&(s=(0,u.maybeUpdateEphemeralSetting)(t,i,a,n)),c.default.supportsFeature(c.default.F.MD_BACKEND)&&!h.isNotification(e.type,e.subtype)){var o,l,p=null!==(o=e.ephemeralDuration)&&void 0!==o?o:0,f=null!==(l=t.getEphemeralSetting())&&void 0!==l?l:0;e.ephemeralOutOfSync=p!==f&&!s}}}(t,N),t.ephemeralOutOfSync&&__LOG__(2)`ephemeralOutOfSync msgId=${t.id.toString()} chatId=${null==N?void 0:N.id.toString()}`}})),{filteredRecs:y,reorderRecs:S,updates:T}};var n=i(r(17620)),s=i(r(38486)),o=i(r(74123)),l=a(r(2537)),d=i(r(23045)),u=r(93572),c=i(r(20468)),p=i(r(83746)),h=a(r(68439)),f=r(89027),_=i(r(25257)),m=i(r(7323)),g=r(61864),v=i(r(94407)),E=i(r(43926))},89027:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.sendRevoke=function(e,t){return function(e,t){var{id:r,t:a}=e;if(!r.fromMe)return Promise.reject("revoking received message");var i=void 0;o.default.supportsFeature(o.default.F.MD_BACKEND)&&r.remote.isGroup()&&(i=(0,y.getMeUser)());var n=new h.default({id:(0,_.default)(),remote:e.id.remote,fromMe:!0,participant:i}),l={id:n,to:r.remote,t:a,type:s.default.MSG_TYPE.PROTOCOL,subtype:"revoke",protocolMessageKey:r,clearMedia:!!t,local:!0};return(0,u.storeMessages)([l],e.chat.id).catch((e=>{throw __LOG__(4,!0,new Error,!0)`_sendRevoke: failed to storeMessages into storage`,SEND_LOGS("storeMessages failed"),e})).then((()=>(0,m.sendMsgRecord)(new p.default(l)))).then((t=>{if(t===g.SendMsgResult.OK){var r=Math.trunc(Date.now()/1e3-e.t);return new c.default.SendRevokeMessage({messageType:e.getWamMessageType(),messageMediaType:e.getWamMediaType(),revokeSendDelay:r}).commit(),S(e,n).then((()=>g.SendMsgResult.OK))}return Promise.resolve(g.SendMsgResult.ERROR_UNKNOWN)}))}((0,v.unproxy)(e),t)},t.revoke=S;var n=i(r(8555)),s=i(r(23045)),o=i(r(20468)),l=r(14784),d=a(r(27305)),u=r(245),c=i(r(84161)),p=i(r(36169)),h=i(r(83746)),f=a(r(68439)),_=i(r(2661)),m=r(75096),g=r(87471),v=r(47138),E=i(r(43926)),y=r(66239);function S(e,t){return function(e,t){return(0,u.processRevokeMsgs)([e.id.toString()],[t.toString()]).catch((e=>{throw __LOG__(4,!0,new Error,!0)`_revoke: failed to process revoke message`,SEND_LOGS("removeMessagesFromHistory failed"),e})).then((()=>{r(62345).default.removeAllLabelsMD(e),f.typeIsMms(e)&&d.deregisterMsg(e),e.chat&&e.chat.removeFromCollection(e),e.trigger("revoked");var a=e.getCollection(),i=e.id;e.msgChunk&&e.msgChunk.replaceId(i,t),a.replaceId(i,t);var o={id:t,type:s.default.MSG_TYPE.REVOKED,body:void 0,caption:void 0,clientUrl:void 0,deprecatedMms3Url:void 0,loc:void 0,lat:void 0,lng:void 0,isLive:void 0,accuracy:void 0,speed:void 0,degrees:void 0,comment:void 0,sequence:void 0,shareDuration:void 0,finalLat:void 0,finalLng:void 0,finalAccuracy:void 0,finalThumbnail:void 0,finalSpeed:void 0,finalDegrees:void 0,finalTimeOffset:void 0,title:void 0,description:void 0,canonicalUrl:void 0,matchedText:void 0,thumbnail:void 0,richPreviewType:void 0,doNotPlayInline:void 0,quotedMsg:void 0,quotedStanzaID:void 0,quotedRemoteJid:void 0,quotedParticipant:void 0,mediaData:void 0,mentionedJidList:void 0,vcardList:void 0,star:!1};if(e.set(o),e.trigger("change:msgKey",{newKey:t,oldKey:i}),e.chat&&(e.chat.updateMediasCountOnMsg(e,!0),i.equals(e.chat.lastReceivedKey)&&(0,l.setLastReceivedKey)(e.chat.id,t).then((()=>{e.chat.lastReceivedKey=t})),e.chat.composeQuotedMsg===e&&(e.chat.composeQuotedMsg=null)),e.isLive&&r(36839).default.removeMsg(e),E.default.isBroadcast(i.remote)){var u=f.getBroadcastFanoutKeys(i),c=f.getBroadcastFanoutKeys(t);if(!u||!c||u.length!==c.length)return void __LOG__(2)`cannot fanout revoke: ${String(u)} ${String(c)}`;(0,n.default)(u,c).forEach((e=>{var t=a.get(e[0]);t&&S(t,e[1])}))}}))}((0,v.unproxy)(e),t)}},75096:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.sendMsgRecord=function(e){return(0,i.callSyncPromise)((()=>{var t,a=e.id,i=r(85030).default;i.find(a.remote).then((e=>{e.isTrusted()||(0,v.sendNotSpam)(e).catch((()=>{}))})),y.default.isBroadcast(e.to)&&(t=(0,_.broadcastFanout)(e)),e.isNewMsg=!0;var S,T=e.type===o.default.MSG_TYPE.PROTOCOL&&"revoke"===e.subtype;if(!e.isGroupMsg&&!T&&s.default.get(e.to))return Promise.reject(new l.default("Contact is blocked",d.default.assertGet(e.to)));T||(S=new h.default.WebcMessageSend({messageType:e.getWamMessageType(),messageMediaType:e.getWamMediaType(),messageIsForward:Boolean(e.isForwarded)}));var A=r(30528).default;return i.find(e.id.remote).then((t=>((0,E.sendSeen)(t),A.trigger(o.default.NEW_MSG_SENT),(0,n.promiseProps)({reply:(0,m.sendMsgRecord)(e),chat:t})))).then((({reply:r,chat:n})=>{var s=a.remote,l=(0,c.getMaybeMeUser)(),d=a.fromMe&&y.default.equals(a.remote,l)?3:r.data?r.data.ack:1;return e.updateAck(d,r.t),S&&(S.markMessageSendT(),S.commit()),e.type!==o.default.MSG_TYPE.PROTOCOL&&(0,p.setLastReceivedKey)(n.id,a).then((()=>{n.lastReceivedKey=a})),A.updateLastReceipt(s,r.t),y.default.isBroadcast(s)&&(t?t.forEach((e=>{var t=new f.default({from:l,to:e,id:a.id}),r=A.get(t);r&&(r.ack=o.default.ACK.SENT,A.updateLastReceipt(e,r.t),null==r.ephemeralStartTimestamp&&r.updateEphemeralStartTimestamp(r.t),i.find(e).then((e=>{(0,p.setLastReceivedKey)(e.id,t).then((()=>{e.lastReceivedKey=t}))})))})):__LOG__(2)`model:msg:createRecord bclist server ack, no recipients`),g.SendMsgResult.OK})).catchType(u.ServerStatusCodeError,(t=>{if(408!==t.status){var r=e.toJSON();__LOG__(2)`json.body: ${JSON.stringify(r.body)}`,r.body=void 0,__LOG__(2,!0)`Json: ${JSON.stringify(r)}`,__LOG__(4,void 0,new Error,!0)`Phone responded ${t.status}`,SEND_LOGS("send-not-200")}return g.SendMsgResult.ERROR_NETWORK})).catch((t=>(__LOG__(3)`model:msg:createRecord dropped msg: ${e.id.toString()}`,__LOG__(4,void 0,new Error,!0)`Got error ${String(t)}`,SEND_LOGS("send-msg-error"),g.SendMsgResult.ERROR_UNKNOWN)))})).finally((()=>{e.promises.sendPromise&&e.promises.sendPromise.control.settled()}))};var i=r(76331),n=r(9737),s=a(r(88025)),o=a(r(23045)),l=a(r(80206)),d=a(r(43805)),u=r(33576),c=r(66239),p=r(14784),h=a(r(84161)),f=a(r(83746)),_=r(68439),m=r(46308),g=r(87471),v=r(11212),E=r(76710),y=a(r(43926))},87471:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SendMsgResult=void 0;var a=r(28103).Mirrored(["OK","ERROR_NETWORK","ERROR_EXPIRED","ERROR_CANCELLED","ERROR_UPLOAD","ERROR_UNKNOWN"]);t.SendMsgResult=a},42643:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.queryProduct=function(e,t,r=100,a=100){return(0,l.queryProduct)(e,t,r,a)},t.queryCatalog=function(e,t,r=5,a=100,i=100,n){return(0,l.queryCatalog)(e,t,r,a,i,n)},t.queryProductList=function(e,t,r=100,a=100){return(0,l.queryProductList)(e,t,r,a)},t.appealProduct=function(e,t){return(0,l.appealProduct)(e,t)},t.reportProduct=function(e,t,r){return(0,l.reportProduct)(e,t,r)},t.createBusinessCatalog=function(){return(0,l.createCatalog)()},t.addProduct=function(e,t=100,r=100){return(0,l.addProduct)(e,t,r)},t.editProduct=function(e,t=100,r=100){return(0,l.editProduct)(e,t,r)},t.deleteProducts=function(e){return(0,l.deleteProducts)(e)},t.sendProductToChat=function(e,t,r){var{catalogWid:a}=e;if(!t)return;var l=t.productCollection.get(e.id),u=l?(0,d.unproxy)(l):(0,d.unproxy)(e);if(!u)return;var c=u.productImageCollection.head(),p=c&&c.mediaData;if(!p)return;i.default.find(a).then((function(e){n.default.openChatFromUnread(e).then((t=>{if(t){var i=(0,d.unproxy)((0,o.createProductInquiry)(u,a,p,r));e.composeQuotedMsg=i,n.default.focusChatTextInput(e),window.innerWidth<=s.default.LAYOUT_2COLUMNS_MAX_WIDTH&&n.default.closeDrawerRight()}}))}))},Object.defineProperty(t,"createProductCatalog",{enumerable:!0,get:function(){return u.default}});var i=a(r(85030)),n=a(r(13277)),s=a(r(23045)),o=r(36169),l=r(57097),d=r(47138),u=a(r(57840))},86690:(e,t,r)=>{"use strict";var a=r(14859),i=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.setProfilePic=function(e,t,r){return f((0,h.unproxy)(e),t,r)},t.deleteProfilePic=function(e){return _((0,h.unproxy)(e))};var n=i(r(2784)),s=r(8507),o=a(r(13277)),l=r(33576),d=i(r(24461)),u=r(66239),c=a(r(38637)),p=r(53319),h=r(47138);function f(e,t,r,a=(0,s.genId)()){var{id:i}=e;if(!e.canSet())return Promise.reject(new d.ActionError);var h=(0,p.sendSetPicture)(i,t,r);e.pendingPic=t;var _=(0,u.getMaybeMeUser)(),m=i.equals(_)?new s.ActionType(c.default.t(186)):new s.ActionType(c.default.t(117)),g=h.catch((()=>{throw __LOG__(3)`models:ProfilePicThumb:setPicture dropped`,i.equals(_)?new s.ActionType(c.default.t(185)):new s.ActionType(c.default.t(116))})).catchType(l.ServerStatusCodeError,(n=>{if(n.status>=400){var o=i.equals(_)?c.default.t(185):c.default.t(116);return new s.ActionType(o,{actionText:c.default.t(199),actionHandler:()=>f(e,t,r,a)})}})).then((()=>i.equals(_)?new s.ActionType(c.default.t(184)):new s.ActionType(c.default.t(115))));return o.default.openToast(n.createElement(s.ActionToast,{id:a,initialAction:m,pendingAction:g})),h.then((t=>{t._duplicate||e.set({tag:t.tag,eurl:t.eurl,token:t.token})})).finally((()=>{e.pendingPic=void 0}))}function _(e,t=(0,s.genId)()){var{id:r}=e;if(!e.canDelete())return Promise.reject(new d.ActionError);var a=(0,p.requestDeletePicture)(r);e.pendingPic=e.fallbackType;var i=(0,u.getMaybeMeUser)(),h=r.equals(i)?new s.ActionType(c.default.t(183)):new s.ActionType(c.default.t(114)),f=a.catch((()=>{throw __LOG__(3)`models:ProfilePicThumb:deletePicture dropped`,r.equals(i)?new s.ActionType(c.default.t(181)):new s.ActionType(c.default.t(112))})).catchType(l.ServerStatusCodeError,(a=>{if(a.status>=400){var n=r.equals(i)?c.default.t(181):c.default.t(112);return new s.ActionType(n,{actionText:c.default.t(199),actionHandler:()=>_(e,t)})}})).then((()=>r.equals(i)?new s.ActionType(c.default.t(182)):new s.ActionType(c.default.t(113))));return o.default.openToast(n.createElement(s.ActionToast,{id:t,initialAction:h,pendingAction:f})),a.then((t=>{t._duplicate||e.set({tag:void 0,eurl:void 0})})).finally((()=>{e.pendingPic=void 0}))}},3087:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.queryServerProps=function(){return i||(i=(0,s.queryServerProps)().then((e=>{o.default.updateProps(e)})).catchType(n.ServerStatusCodeError,(()=>{})).catchType(n.WebdDrop,(()=>{})).finally((()=>{i=null})))};var i,n=r(33576),s=r(57071),o=a(r(54559))},55814:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.setArchiveClassicSetting=function(e){return f(e)},t.setArchiveEnabledSetting=function(e){return function(e){return __LOG__(2)`Settings:setArchiveEnabledSetting value to ${e}`,Promise.resolve().then((()=>{p.default.archive.enabled!==e&&(p.default.archive=(0,n.default)((0,n.default)({},p.default.archive),{},{enabled:e}))}))}(e)};var n=i(r(70417)),s=a(r(2784)),o=r(8507),l=i(r(13277)),d=r(33576),u=i(r(38637)),c=i(r(84161)),p=i(r(34749)),h=i(r(44014));function f(e,t=(0,o.genId)()){__LOG__(2)`Settings:setArchiveClassicSetting value to ${e}`;var r=(0,h.default)(e),a=new o.ActionType(u.default.t(43)),i=Boolean(p.default.archive.classic),_=r.then((()=>{__LOG__(2)`Settings:setArchiveClassicSetting:success value sucessfully set to ${e}`;var r=e?u.default.t(41):u.default.t(44);return new o.ActionType(r,{actionText:u.default.t(203),actionHandler:()=>f(i,t)})})).catchType(d.ServerStatusCodeError,(e=>{if(__LOG__(3)`models:settings:setArchiveClassicSetting failed with server error`,e.status>=400)return new o.ActionType(u.default.t(42))})).catch((()=>{throw __LOG__(3)`models:settings:setArchiveClassicSetting dropped`,new o.ActionType(u.default.t(42),{actionText:u.default.t(199),actionHandler:()=>f(e,t)})}));return l.default.openToast(s.createElement(o.ActionToast,{id:t,initialAction:a,pendingAction:_})),r.then((()=>{p.default.archive.classic!==e&&(new c.default.ArchiveSettings({keepChatsArchived:e}).commit(),p.default.archive=(0,n.default)((0,n.default)({},p.default.archive),{},{classic:e}))}))}},88956:(e,t,r)=>{"use strict";var a=r(14859),i=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.getStatus=function(e){return(0,c.getStatus)(e).then((t=>{var a={id:e};if((0,p.isNumber)(t.status))switch(t.status){case 429:case 401:case 403:case 404:case 304:a.stale=!0;var i=r(48514).default.get(e);i&&!(0,p.isString)(i.status)&&(a.status="");break;default:a.status=""}else{var n=t.status;if(t.stale){var s=r(48514).default.get(e);s&&(n=s.status)}a.status=n}return a}))},t.setMyStatus=function e(t,a=(0,s.genId)()){var i=t.trim();if(!i)return Promise.reject(new l.ActionError);var p=(0,c.setMyStatus)(i),h=new s.ActionType(u.default.t(198)),f=(0,d.getMaybeMeUser)(),_=r(48514).default,m=_.assertGet(f).status,g=p.then((t=>200===t.status?new s.ActionType(u.default.t(196),{actionText:u.default.t(203),actionHandler:()=>e(m,a)}):t.status>=400?new s.ActionType(u.default.t(197)):void 0)).catch((()=>{throw __LOG__(3)`models:statusCollection:setMyStatus dropped`,new s.ActionType(u.default.t(197),{actionText:u.default.t(199),actionHandler:()=>e(t,a)})}));return o.default.openToast(n.createElement(s.ActionToast,{id:a,initialAction:h,pendingAction:g})),p.then((e=>{200!==e.status||e._duplicate||(_.assertGet(f).status=t)}))};var n=i(r(2784)),s=r(8507),o=a(r(13277)),l=i(r(24461)),d=r(66239),u=a(r(38637)),c=r(11428),p=r(61864)},23123:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.applyContactBusinessProps=t.updateContactBusinessProperties=void 0;var i=a(r(52954)),n=a(r(23045)),s=a(r(43805)),o=a(r(20468)),l=r(12409),d=r(25054),u=(e,t)=>{var r={};for(var a of e){var{id:i}=a;r[i.user]=a}for(var n of t){var{id:s}=n,o=r[s.user],l=Boolean(o),{level:d,name:u,isApi:c,privacyMode:h}=o||{},f={isBusiness:l,isEnterprise:Boolean(c),verifiedLevel:p(d),verifiedName:u,privacyMode:h};n.set(f)}};t.updateContactBusinessProperties=u;var c=function(){var e=(0,i.default)((function*(){if(o.default.supportsFeature(o.default.F.MD_BACKEND)){var e=(yield(0,l.getAllVerifiedNames)()).map((({id:e,name:t,level:r,isApi:a,privacyMode:i})=>({id:(0,d.createUserWid)(e),name:t,level:r,isApi:a,privacyMode:i})));u(e,s.default.toArray())}}));return function(){return e.apply(this,arguments)}}();function p(e){if(null!=e){switch(e){case"unknown":return n.default.VERIFIED_LEVEL.UNKNOWN;case"low":return n.default.VERIFIED_LEVEL.LOW;case"high":return n.default.VERIFIED_LEVEL.HIGH}return n.default.VERIFIED_LEVEL.UNKNOWN}}t.applyContactBusinessProps=c},25815:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.updateVerifiedInfo=h,t.updateContactPropertiesOnNewChat=function(e){var t=!n.default.get(e);if(d.default.supportsFeature(d.default.F.MD_BACKEND)&&t)return(0,u.default)(e).then((t=>{if(t){var{bizInfo:r}=t;if(r)return h(o.default.gadd(e),r.verifiedName)}}));return Promise.resolve()},t.updateBizPrivacyMode=function(){return f.apply(this,arguments)};var i=a(r(52954)),n=a(r(85030)),s=a(r(23045)),o=a(r(43805)),l=a(r(22984)),d=a(r(20468)),u=a(r(99935)),c=r(23123),p=r(12409);function h(e,t){var r=e.id,{name:a,level:i,isApi:n,serial:s,privacyMode:o}=t;return(0,c.updateContactBusinessProperties)([{id:r,name:a,level:i,isApi:n,privacyMode:o}],[e]),(0,p.createOrUpdateVerifiedBusinessName)(void 0,r,i,s,a,n,o)}function f(){return(f=(0,i.default)((function*(e,t){if(null!=t){var r=o.default.get(e);if(r&&!(null!=r.privacyMode&&r.privacyMode.privacyModeTs>=t.privacyModeTs)){var a={verifiedName:r.verifiedName,isVerifiedHigh:r.verifiedLevel===s.default.VERIFIED_LEVEL.HIGH,isBusiness:r.isBusiness,isEnterprise:r.isEnterprise,privacyMode:r.privacyMode};r.set({isBusiness:!0,isEnterprise:!0,privacyMode:t}),yield Promise.all([(0,p.createOrUpdateVerifiedBusinessName)(null,e,null,null,null,!0,t),(0,l.default)(e,a,{verifiedName:r.verifiedName,isVerifiedHigh:r.verifiedLevel===s.default.VERIFIED_LEVEL.HIGH,isBusiness:!0,isEnterprise:!0,privacyMode:t})])}}}))).apply(this,arguments)}},35985:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.handleVerifiedNameSync=void 0;var i=a(r(52954)),n=a(r(20468)),s=r(23123),o=r(12409),l=function(){var e=(0,i.default)((function*(e){n.default.supportsFeature(n.default.F.MD_BACKEND)&&0!==e.length&&(yield Promise.all(e.map((({id:e,verifiedName:{level:t,serial:r,name:a,isApi:i,privacyMode:n}})=>(0,o.createOrUpdateVerifiedBusinessName)(void 0,e,t,r,a,i,n)))),yield(0,s.applyContactBusinessProps)())}));return function(){return e.apply(this,arguments)}}();t.handleVerifiedNameSync=l},19663:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.handleIncomingCallOffer=function(e,t){i.default.processIncomingCall(e.call_id,e.peer_jid,{isVideo:e.isVideoCall,canHandleLocally:e.isVideoCall?s.default.isVideoCallEnabled():s.default.isVoiceCallEnabled(),offerTime:e.t}),n.default.handleIncomingSignalingMessage(e,t)},t.handleIncomingSignalingMsg=function(e,t){n.default.handleIncomingSignalingMessage(e,t)},t.handleIncomingEncRekey=function(e,t){n.default.handleIncomingSignalingMessage(e,t)};var i=a(r(40941)),n=a(r(61506)),s=a(r(6370))},88149:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sendCallOffer=function(e){return(0,a.sendCallOfferBridge)(e)},t.sendCallSignalingMsg=function(e,t){return(0,a.sendCallSignalingMsgBridge)(e,t)},t.sendCallEnd=function(e,t){return(0,a.sendCallEndBridge)(e,t)},t.sendEncRekey=function(e){return(0,a.sendEncRekeyBridge)(e)},t.queryCall=function(e,t){return(0,a.sendQueryCallBridge)(e,t)},t.prepareRetryReceipt=function(e){return(0,a.prepareRetryReceiptBridge)(e)};var a=r(35699)},77067:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.ackMatchesTemplate=function(e,t){var{type:r,from:a,participant:i,ts:n}=t;if(e.id!==t.id)return!1;if(null!=t.class&&e.class!==t.class)return!1;if(null!=r&&e.type!==r)return!1;if(null!=a&&!a.equals(e.from))return!1;if(null!=i&&!i.equals(e.participant))return!1;if(null!=n&&e.ts!==n)return!1;return!0},t.default=void 0;var i=new(a(r(45521)).default)("ack",(e=>(e.assertTag("ack"),{id:e.attrString("id"),ts:e.hasAttr("t")?e.attrString("t"):null,class:e.attrString("class"),type:e.hasAttr("type")?e.attrString("type"):null,from:e.attrWid("from"),participant:e.hasAttr("participant")?e.attrDeviceWid("participant"):null})));t.default=i},88241:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return Promise.resolve(function(e,t){var{attrs:r}=e;switch(e.tag){case"iq":return function(e){var{attrs:t,content:r}=e;if("urn:xmpp:ping"===t.xmlns)return(0,I.wap)("iq",{type:"result",to:t.from});if("md"!==t.xmlns)throw new Error(`handleIq unrecognized ${e.toString()}`);if(!Array.isArray(r)||!r.length)return;switch(r[0].tag){case"pair-device":return(0,v.default)(e);case"pair-success":return(0,E.default)(e)}}(e);case"receipt":return"retry"===r.type?(0,b.handleMessageRetryRequest)(e):"enc_rekey_retry"===r.type?(0,o.handleEncRekeyRetryRequest)(e):(0,g.default)(e);case"notification":switch(r.type){case"server_sync":return(0,P.default)(e);case"w:gp2":return(0,h.default)(e);case"picture":return(0,A.default)(e);case"business":return(0,s.handleBusinessNotification)(e);case"contacts":return(0,d.default)(e);case"devices":return(0,u.default)(e);case"mediaretry":return(0,_.default)(e);case"encrypt":var a=e.content;if(!Array.isArray(a)||!a.length)break;switch(a[0].tag){case"count":return(0,S.default)(e,t);case"identity":return(0,M.handleE2eIdentityChange)(e);case"digest":return(0,c.default)(e)}break;case"server":return(0,C.default)(e);case"status":return(0,i.default)(e);case"account_sync":return(0,n.default)(e);case"pay":return(0,y.default)(e)}if(__LOG__(3)`Comms.handleStanza unrecognized notification stanza ${e.toString()}`,r.hasOwnProperty("id"))return(0,I.wap)("ack",{id:r.id,class:"notification",from:r.to||I.DROP_ATTR,to:r.from||I.DROP_ATTR,type:r.type||I.DROP_ATTR,participant:r.participant||I.DROP_ATTR});break;case"chatstate":return(0,l.default)(e);case"presence":return(0,T.default)(e);case"message":return(0,m.default)(e);case"ib":return(0,f.default)(e);case"stream:error":return(0,O.default)(e);case"failure":return(0,p.default)(e);case"success":return(0,w.default)(e);case"call":return(0,o.handleCall)(e)}__LOG__(3)`Comms.handleStanza unrecognized stanza ${e.toString()}`}(e,t)).then((e=>null==e?"NO_ACK":e))};var i=a(r(36939)),n=a(r(77723)),s=r(96964),o=r(67470),l=a(r(3202)),d=a(r(82458)),u=a(r(69115)),c=a(r(62673)),p=a(r(5377)),h=a(r(5863)),f=a(r(60431)),_=a(r(16423)),m=a(r(35023)),g=a(r(1429)),v=a(r(1002)),E=a(r(3073)),y=a(r(20982)),S=a(r(63976)),T=a(r(67003)),A=a(r(64504)),b=r(60836),C=a(r(60758)),P=a(r(47472)),O=a(r(5801)),w=a(r(46597)),M=r(76604),I=r(35773)},7017:(e,t,r)=>{"use strict";var a=r(14859),i=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.startComms=function(e,t,r){if(T)return;T=new S(e,t,r),setTimeout(A,0)},t.stopComms=function(e){e&&p.default.onStartingLogout();var t=O("stopComms");t.socketLoop.endWithValue(),t.socket&&t.socket.close();T=null},t.openSocketLoop=A,t.openSocket=b,t.closeSocket=function(){var e=O("closeSocket").socket;e&&(__LOG__(2)`closeSocket called`,e.close())},t.onStreamErrorReceived=function(){O("onStreamErrorReceived").socketLoop.cancelReset()},t.waitForConnection=function(){O("waitForConnection").sendPing(),E||(E=new o.Resolvable);return E.promise},t.sendStanzaAndWaitForAck=function(e,t){return C(e,t).then((()=>{}))},t.sendStanzaAndReturnAck=C,t.castStanza=function(e){var t=O("castStanza");t.socket?t.castStanza(e):__LOG__(2)`Comms has no open socket`},t.sendIq=function(e,t,r){return P(e,t,!1,r)},t.sendIqWithoutRetry=function(e,t){return P(e,t,!0)},t.sendPing=function(e,t){var r=O("sendPing"),a=e.attrs.id;if(!a||"string"!=typeof a)return Promise.reject(new Error(`Comms:sendPing given iq without id: ${String(e)}`));if(!r.socketId)return __LOG__(2)`sendPing when socket dead`,Promise.resolve();if(r.activePing&&r.activePing.socketId===r.socketId)return __LOG__(2)`sendPing ping still pending`,Promise.resolve();r.activePing&&r.activePing.handler.resolve();var i=new o.Resolvable;return r.activePing={socketId:r.socketId,stanzaId:a,handler:i},r.callStanza(e),i.promise.then((e=>e&&(0,v.parseIqResponse)(t,e)))},t.startHandlingRequests=function(){return O("startHandlingRequests").startHandlingRequests()},t.singletonOrThrowIfUninitialized=O;var n=r(35773),s=r(68053),o=r(14409),l=r(35160),d=r(36916),u=r(88911),c=i(r(77067)),p=a(r(13277)),h=a(r(23045)),f=r(24461),_=r(63191),m=a(r(84689)),g=a(r(94798)),v=r(13915),E=(r(53353),null),y=1;class S{constructor(e,t,r){this.nextSocketId=1,this.pendingIqs=new Map,this.ackHandlers=[],this._recvBlocker=new o.Resolvable,this.activePing=null,this._pending=new Set,this.socketId=0,this.socket=null,this.softCloseSocket=null,this.socketLoop=new s.PromiseRetryLoop({name:"MainSocketLoop",code:b,timer:{jitter:.1,max:6e4,algo:{type:"fibonacci",first:1e4,second:1e4},relativeDelay:!0},resetDelay:3e4}),this.parseAndHandleStanza=(e,t)=>{e===this.socketId&&(this.deadSocketTimer.cancel(),E&&(E.resolve(),E=null));var r=(0,n.decodeStanza)(t,M).then((t=>{if(t){__LOG__(2,!0)`--- Receive ---\n${t.toString()}`;var r=this.activePing;return r&&r.socketId===e&&r.stanzaId===w(t)?(this.activePing=null,r.handler.resolve(t),this.maybeScheduleHealthCheck(),"NO_ACK"):this.handleStanza(t,e)}__LOG__(3)`Failure parsing stanza!`})).then((t=>{if(e===this.socketId)if("CLOSE_SOCKET"===t){__LOG__(2)`Comms: job response is CLOSE_SOCKET`;var r=this.socket;r&&r.close()}else"NO_ACK"===t?__LOG__(2)`Comms: job response is NO_ACK`:t&&this.castStanza(t)}));this._pending.add(r),r.finally((()=>{this._pending.delete(r)}))},this.handleStanza=(e,t)=>{var r=w(e);if(null!=r){var a=this.pendingIqs.get(r);a?(this.pendingIqs.delete(r),a.resolve(e),this.maybeScheduleHealthCheck()):__LOG__(4,void 0,new Error)`handleIq no handler for iq with id ${r}`}else{if("ack"!==e.tag)return"failure"===e.tag?this._handleStanza(e,t):this._recvBlocker.promise.then((()=>this._handleStanza(e,t)));this.handleAck(e)}return"NO_ACK"},this.healthCheckTimer=new l.ShiftTimer((()=>{__LOG__(2)`Comms: testing socket`,this.socketId&&this.sendPing()})),this.deadSocketTimer=new l.ShiftTimer((e=>{__LOG__(2)`Comms: Socket ${e} expired`,e===this.socketId&&this.softCloseSocket&&this.softCloseSocket()})),this._handleStanza=e,this.sendPing=t,this.socketStartOptions=r}filterPending(e){var t=[];function r(r){e(r)&&t.push(r)}return this.pendingIqs.forEach(r),this.ackHandlers.forEach(r),t}callStanza(e){this.castStanza(e),this.deadSocketTimer.onOrBefore(2e4,this.socketId),this.healthCheckTimer.cancel()}castStanza(e){var t=this.socketOrThrow("castStanza");try{__LOG__(2,!0)`--- Sending ---\n${e.toString()}`,t.sendFrame((0,n.encodeStanza)(e))}catch(e){__LOG__(3)`castStanza error ${e}`}}socketOrThrow(e){var t=this.socket;if(t)return t;throw new Error(`Comms.${e} called while no socket`)}startHandlingRequests(){return __LOG__(2)`Comms.startHandlingRequests`,this._recvBlocker.resolve(),this._recvBlocker.promise.then((()=>{}))}handleAck(e){for(var t=this.ackHandlers,r=-1,a=null;!a&&++r<t.length;)a=t[r].parseAndTest(e);if(a){var i=t[r];(0,d.removeIndexWithoutPreservingOrder)(t,r),(0,g.default)(e),i.resolve(a),this.maybeScheduleHealthCheck()}else __LOG__(3)`handleAck: unrecognized ${e}`}removeHandler(e){if("iq"===e.type){var t=e.stanza.attrs.id;if(!t||"string"!=typeof t)return;if(!this.pendingIqs.delete(t))return}else{e.type;var r=this.ackHandlers.indexOf(e);if(-1===r)return;(0,d.removeIndexWithoutPreservingOrder)(this.ackHandlers,r)}e.resolve(Promise.reject(new f.Disconnected))}maybeScheduleHealthCheck(){if(!this.healthCheckTimer.isScheduled()&&!(this.activePing||this.ackHandlers.length||this.pendingIqs.size)){var e=1e4*Math.random()+2e4;this.healthCheckTimer.onOrBefore(e)}}}var T=null;function A(){O("openSocketLoop").socketLoop.start()}function b(){var e,t=O("openSocket"),r=t.nextSocketId++;return __LOG__(2)`Comms: Socket ${r} opening, passive mode: ${!!(null===(e=t.socketStartOptions)||void 0===e?void 0:e.passive)}`,p.default.setSocketState(h.default.SOCKET_STATE.OPENING),(0,m.default)(t.socketStartOptions).then((e=>{t.socketStartOptions=null,p.default.setSocketState(h.default.SOCKET_STATE.PAIRING);var a=new o.Resolvable;return __LOG__(2)`Comms: Socket ${r} opened`,t.socketId=r,t.socket=e,t.softCloseSocket=()=>{t.softCloseSocket=null,t.socket&&(t.socket.close(),t.socket=null),a.resolve()},t.socketLoop.resetTimeoutAfter(1e4),t.deadSocketTimer.cancel(),t.maybeScheduleHealthCheck(),e.setOnFrame((e=>t.parseAndHandleStanza(r,e))),e.setOnClose((()=>{__LOG__(2)`Comms: Socket ${r} closed`,t.activePing&&r===t.activePing.socketId&&(t.activePing.handler.resolve(),t.activePing=null),t.filterPending((e=>e.attachedToSocketId===r)).forEach((e=>{t.removeHandler(e)})),r===t.socketId&&(t.socketId=0,t.socket=null,p.default.socketStreamDisconnected(),a.resolve())})),(0,_.isRegistered)()&&(p.default.setSocketState(h.default.SOCKET_STATE.CONNECTED),p.default.openSocketStream()),t.filterPending((e=>!e.attachedToSocketId)).sort(((e,t)=>e.orderedId-t.orderedId)).forEach((e=>{t.callStanza(e.stanza)})),a.promise})).catchType(f.Disconnected,(()=>{__LOG__(2)`openSocket socket closed while in noise handshake`})).catch((e=>{__LOG__(3)`openSocket failed ${e}`}))}function C(e,t){return new Promise((r=>{var a=O("sendStanzaAndWaitForAck");a.ackHandlers.push({type:"ack",parseAndTest:e=>{var r=c.default.parse(e);return!r.error&&(0,c.ackMatchesTemplate)(r.success,t)?e:null},resolve:r,stanza:e,attachedToSocketId:0,orderedId:y++}),a.socket?a.callStanza(e):__LOG__(2)`Comms has no open socket, will send stanza when socket opens`}))}function P(e,t,r,a){return new Promise((t=>{var a=O("sendIq"),i=e.attrs.id;if(!i||"string"!=typeof i)throw new Error(`Comms:sendIq given iq without id: ${String(e)}`);var n=a.socketId;!r||n?(a.pendingIqs.set(i,{type:"iq",resolve:t,stanza:e,attachedToSocketId:r?n:0,orderedId:y++}),a.socket?a.callStanza(e):__LOG__(2)`Comms has no open socket, will resend iq when socket opens`):t(Promise.reject(new f.Offline))})).then((e=>(0,v.parseIqResponse)(t,e,a)))}function O(e){if(T)return T;throw new Error(`Comms::${e} called before startComms`)}function w(e){if("iq"===e.tag){var t=e.attrs.type;if("result"===t||"error"===t)return(0,n.decodeAsString)(e.attrs.id)||null}return null}function M(e){return Promise.resolve((0,u.inflate)(e))}},45521:(e,t,r)=>{"use strict";var a=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(66514));t.default=class{constructor(e,t){this._name=e,this._parser=t}parseParsableWap(e){try{return{success:this._parser(e)}}catch(e){if(e instanceof i.XmppParsingFailure)return{error:e};throw e}}parse(e){var t=new i.default(this._name,e);return this.parseParsableWap(t)}parseOrThrow(e){var t=this.parse(e);if(t.error)throw new Error(String(t.error));return t.success}}},66514:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.convertBytesToUint=d,t.default=t.XmppParsingFailure=t.AUTHOR_SYSTEM=t.AUTHOR_ME=void 0;var a=r(35773),i=r(49244),n=r(95334),s=r(66239),o=r(25054);t.AUTHOR_ME="@me";var l="@system";function d(e,t,r=!1){for(var a=0,i=0;i<t;i++)a=256*a+e[i];return a}t.AUTHOR_SYSTEM=l;class u{constructor(e,t){this.parser=e,this.reason=t}toString(){return`XmppParsingFailure: ${this.parser}: ${this.reason}`}}t.XmppParsingFailure=u;class c{constructor(e,t){this._name=e,this._node=t,this._children=Array.isArray(t.content)?t.content.map((t=>new c(e,t))):null}hasAttr(e){return this._node.attrs.hasOwnProperty(e)}assertTag(e){this._node.tag!==e&&this.throw(`to be <${e}>`)}tag(){return this._node.tag}maybeChild(e){var t=this._children;if(!t)return null;for(var r=0;r<t.length;r++)if(t[r]._node.tag===e)return t[r];return null}hasChild(e){return!!this.maybeChild(e)}child(e){var t=this.maybeChild(e);return t||this.throw(`to have child <${e}>`)}getFirstChild(){var e=this._children;return e?e[0]:null}assertAttr(e,t){var r=this.attrString(e);r!==t&&this.throw(`to have "${e}"="${t}", but instead has "${r}"`)}assertAttrIsMe(e){var t=this.attrWid(e),r=(0,s.assertGetMe)();t.equals(r)||this.throw(`to have "${e}"=${r.toString()}, but instead has "${t.toString()}"`)}assertAttrIsMeUser(e){var t=this.attrWid(e),r=(0,s.assertGetMeUser)();t.equals(r)||this.throw(`to have "${e}"=${r.toString()}, but instead has "${t.toString()}"`)}assertFromServer(){var e=this.attrString("from");"s.whatsapp.net"!==e&&this.throw(`to have "from"="s.whatsapp.net", but instead has "${e}"`)}attrString(e){return this._node.attrs.hasOwnProperty(e)?(0,a.decodeAsString)(this._node.attrs[e]):this.throw(`to have attribute "${e}"`)}attrAuthor(e){if(!this.hasAttr(e))return l;var t=this.attrUserWid(e);return t.equals((0,s.assertGetMe)())?"@me":t}maybeAttrString(e){return this.hasAttr(e)?(0,a.decodeAsString)(this._node.attrs[e]):null}attrDeviceWid(e){var t,r=this.attrString(e);try{t=(0,o.createDeviceWid)(r)}catch(e){}return t&&t.isUser()?t:this.throw(`to have "${e}"={DeviceJid}, but instead has "${r}"`)}attrUserWid(e){var t,r=this.attrString(e);try{t=(0,o.createWid)(r)}catch(e){}return t&&t.isUser()?(0,o.toUserWid)(t):this.throw(`to have "${e}"={UserJid}, but instead has "${r}"`)}attrChatWid(e){var t,r=this.attrString(e);try{t=(0,o.createWid)(r)}catch(e){}return t?(0,o.toChatWid)(t):this.throw(`to have "${e}"={ChatJid}, but instead has "${r}"`)}attrGroupWid(e){var t,r=this.attrString(e);try{t=(0,o.createWid)(r)}catch(e){}return t&&t.isGroup()?t:this.throw(`to have "${e}"={GroupJid}, but instead has "${r}"`)}attrWid(e){var t,r=this.attrString(e);try{t=(0,o.createWid)(r)}catch(e){}return t||this.throw(`to have "${e}"={JID}, but instead has "${r}"`)}maybeAttrEnum(e,t){if(!this.hasAttr(e))return null;try{return this.attrEnum(e,t)}catch(e){return __LOG__(3)`maybeAttrEnum: value does not exist in enum`,null}}attrEnum(e,t){var r=this.attrString(e);if(!t.hasOwnProperty(r)){var a=Object.keys(t).join("|");return this.throw(`to have "${e}"={${a}} but has value "${r}"`)}return t[r]}attrEnumOrDefault(e,t,r){return this.hasAttr(e)?this.attrEnum(e,t):r}attrFlowEnum(e,t){var r=t(this.attrString(e));return null==r?this.throw("to have enum value"):r}attrFlowEnumOrDefault(e,t,r){try{return this.attrFlowEnum(e,t)}catch(e){return r}}attrInt(e,t,r){var a=this.attrString(e),i=parseInt(a,10);return Number.isNaN(i)?this.throw(`to have "${e}"={integer} but has value "${a}"`):void 0!==t&&i<t?this.throw(`to have "${e}"={at least ${t}} but has value ${i}`):void 0!==r&&i>=r?this.throw(`to have "${e}"={below ${r}} but has value ${i}`):i}maybeAttrInt(e,t,r){return this.hasAttr(e)?this.attrInt(e,t,r):null}attrTime(e){return(0,n.castToUnixTime)(this.attrInt(e))}attrFutureTime(e){var t=this.attrInt(e);return(0,n.futureUnixTime)(t)}forEachChild(e){var t=this._children;if(t)t.forEach(e);else if(this._node.content)return this.throw("to have children")}forEachChildWithTag(e,t){this.forEachChild((r=>{r._node.tag===e&&t(r)}))}mapChildren(e){var t=this._children;return!t&&this._node.content?this.throw("to have children"):t?t.map(e):[]}mapChildrenWithTag(e,t){var r=this._children;return!r&&this._node.content?this.throw("to have children"):r?r.filter((t=>t._node.tag===e)).map(t):[]}hasContent(){return!this._children&&!!this._node.content}contentUint(e){return d(this.contentBytes(e),e)}contentBytes(e=-1){if(this._children)return this.throw("to have binary content, but has children instead");if(this._node.content){var t=this._node.content;return-1!==e&&t.length!==e?this.throw(`to be ${e} bytes, but got ${t.length} instead`):t}return this.throw("to have content")}contentString(){if(this._children)return this.throw("to have string content, but has children instead");if(this._node.content){var e=new i.Binary(this._node.content);return e.readString(e.size())}return this.throw("to have content")}contentEnum(e){var t=this.contentString();if(!e.hasOwnProperty(t)){var r=Object.keys(e).join("|");return this.throw(`to have content {${r}} but has value "${t}"`)}return e[t]}throw(e){throw new u(this._name,`expected <${this._node.tag}> ${e}`)}}t.default=c},94798:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var{id:t,from:r,t:a}=e.attrs;"message"===e.attrs.class&&function(e,t,r){var a=new n.default({fromMe:!0,remote:t,id:e});(0,i.getTable)().merge(String(a),{messageRangeIndex:(0,s.craftMessageRangeIndex)(t.toString(),!1,!1,r)}).catch((e=>{throw __LOG__(4,!0,new Error,!0)`processAckForOutgoingMessage: failed to update in storage`,SEND_LOGS("message processAckForOutgoingMessage failed"),e}))}(String(t),(0,o.createWid)(String(r)),parseInt(a,10))};var i=r(43730),n=a(r(83746)),s=r(44042),o=r(25054)},31970:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.sendPing=function(){var e=(0,i.wap)("iq",{to:i.S_WHATSAPP_NET,xmlns:"w:p",type:"get",id:(0,i.generateId)()},(0,i.wap)("ping",null));(0,s.sendPing)(e,o).then((e=>{e&&e.success&&l(e.result)}))},t.blockSendPing=function(){var e=(0,i.wap)("iq",{to:i.S_WHATSAPP_NET,xmlns:"w:p",type:"get",id:(0,i.generateId)()},(0,i.wap)("ping",null));return(0,s.sendPing)(e,o).then((e=>{e&&e.success&&l(e.result)}))};var i=r(35773),n=r(95334),s=r(7017),o=new(a(r(45521)).default)("ping",(e=>e.attrTime("t")));function l(e){var t=Math.round(Date.now()/1e3-e);(0,n.setClockSkew)(t)}},13915:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseIqResponse=function(e,t,r){var n=t.content;if(n&&Array.isArray(n)&&n[0]){var s=n[0];if("error"===s.tag){var o=s.attrs||{};return{success:!1,errorCode:parseInt(o.code,10),errorText:(0,a.decodeAsString)(o.text)||"",errorType:(0,a.decodeAsString)(o.type)||"",errorBackoff:parseInt(o.backoff,10),customError:r?r.parseOrThrow(s):void 0,toString:i}}}return{success:!0,result:e.parseOrThrow(t)}},t.errorToString=i;var a=r(35773);function i(){return`IqError ${this.errorCode}: ${this.errorText}`}},29020:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.DEVICE_JID=function(e){if(!(e instanceof o.default&&e.isUser()))throw Error(`DEVICE_JID: invalid jid type: ${e instanceof o.default?e.toString():"Not an instance of WID"}`);return i.WapJid.createAD(e.user,e.agent,e.device)},t.USER_JID=function(e){if(!(e instanceof o.default&&e.isUser()))throw Error(`USER_JID: invalid jid type: ${e instanceof o.default?e.toString():"Not an instance of WID"}`);return i.WapJid.create(e.user,n.USER_JID_SUFFIX)},t.CHAT_JID=function(e){if(!(e instanceof o.default&&(e.isUser()||e.isGroup()||e.isBroadcast())))throw Error(`CHAT_JID: invalid jid type: ${e instanceof o.default?e.toString():"Not an instance of WID"}`);return i.WapJid.create(e.user,"c.us"===e.server?n.USER_JID_SUFFIX:e.server)},t.GROUP_JID=function(e){if(!(e instanceof o.default&&e.isGroup()))throw Error(`GROUP_JID: invalid jid type: ${e instanceof o.default?e.toString():"Not an instance of WID"}`);return i.WapJid.create(e.user,e.server)},t.GROUP_CALL_JID=function(e){if(!(e instanceof o.default&&e.isGroupCall()))throw Error(`GROUP_CALL_JID: invalid jid type: ${e instanceof o.default?e.toString():"Not an instance of WID"}`);return i.WapJid.create(e.user,e.server)},t.JID=function(e){if(!(e instanceof o.default))throw Error(`JID: invalid jid type: ${e instanceof o.default?e.toString():"Not an instance of WID"}`);return null!=e.device&&0!==e.device||null!=e.agent&&0!==e.agent?i.WapJid.createAD(e.user,e.agent,e.device):i.WapJid.create(e.user,e.server)},t.wapNodeToVoipXml=t.voipXmlToWapNode=void 0;var i=r(27581),n=r(58545),s=r(35773),o=a(r(43926));t.voipXmlToWapNode=e=>{if(!e||!Array.isArray(e)||3!==e.length)throw Error("Invalid VOIP xml node");return function e(t){if(!t)return null;if(Array.isArray(t)){var r=t[0],a=t[1],n=void 0;a&&Object.keys(a).map((e=>{n||(n={});var t=a[e];if(!t)throw Error("Attribute value is null");if("object"==typeof t){if(t.type!==i.WAP_JID_SUBTYPE.JID&&!i.WAP_JID_SUBTYPE.JID_AD)throw Error("Invalid attribute value type");t=new i.WapJid(t)}n[e]=t}));var o=t[2],l=null;Array.isArray(o)&&o.length>0&&(l="number"==typeof o[0]?new Uint8Array(o):o.map(e).filter((e=>e)));var d=l;return new s.WapNode(r,n,d)}return t}(e)};t.wapNodeToVoipXml=e=>function e(t){var r=[];return r.push(t.tag),r.push(t.attrs||{}),Array.isArray(t.content)&&0===t.content.filter((e=>!Array.isArray(e)))?r.push(t.content):Array.isArray(t.content)?r.push(t.content.map((t=>e(t)))):null!=t.content?t.content instanceof Uint8Array?r.push(Array.from(t.content)):r.push(t.content):r.push(null),r}(e)},81558:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.encryptServerErrorReceipt=function(e,t,r){return function(){return p.apply(this,arguments)}(e,t,function(e){__LOG__(2)`encodeServerErrorReceipt`;var t=new l.Binary;return(0,o.encodeProto)(u.ServerErrorReceiptSpec,e,t),t.readByteArray()}({stanzaId:t}),r)},t.decryptMediaRetryNotification=function(e,t,r,a){return function(){return h.apply(this,arguments)}(e,t,r,a).then((e=>(0,s.decodeProto)(u.MediaRetryNotificationSpec,e)))},t.ENC_IV_SIZE=void 0;var n=i(r(52954)),s=r(9557),o=r(76549),l=r(49244),d=a(r(25212)),u=r(83862),c=i(r(62549));function p(){return(p=(0,n.default)((function*(e,t,r,a){var i=(null==a?void 0:a.slice())||g(),{key:n,params:s}=yield _(e,t,i);return{ciphertext:yield c.default.encrypt(s,n,r),iv:i}}))).apply(this,arguments)}function h(){return(h=(0,n.default)((function*(e,t,r,a){var{key:i,params:n}=yield _(e,t,r);return c.default.decrypt(n,i,a)}))).apply(this,arguments)}var f="WhatsApp Media Retry Notification";function _(){return m.apply(this,arguments)}function m(){return(m=(0,n.default)((function*(e,t,r){var a=yield d.extractAndExpand(e,f,32),i=new l.Binary;i.write(t);var n=i.readByteArray();return{key:yield c.default.importKey("raw",new Uint8Array(a),"AES-GCM",!1,["encrypt","decrypt"]),params:{name:"AES-GCM",iv:r,additionalData:n}}}))).apply(this,arguments)}function g(){var e=new Uint8Array(12);return self.crypto.getRandomValues(e),e}t.ENC_IV_SIZE=12},90120:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseABProps=function(e){var t=new Map;e.forEach((({configCode:e,configValue:r,configExpoKey:a})=>{t.set(e,{configValue:r,configExpoKey:a})}));var r=new Map;return Object.keys(a.ABPropConfigs).map((e=>{var i=a.ABPropConfigs[e][0],n=t.get(i),s=null==n?void 0:n.configValue,o=null==n?void 0:n.configExpoKey;r.set(i,{configValue:s,configExpoKey:o})})),r};var a=r(19938)},14683:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.syncABProps=h,t.syncABPropsTask=function(){return f.apply(this,arguments)},t.default=void 0;var i=a(r(52954)),n=r(35773),s=r(92582),o=r(60266),l=r(2015),d=r(47628),u=r(6807),c=r(90120),p=r(7017);function h(e=!0){var t;e&&(t=(0,u.getHash)());var r=(0,n.wap)("iq",{xmlns:"abt",id:(0,n.generateId)(),type:"get",to:n.S_WHATSAPP_NET},(0,n.wap)("props",{protocol:"1",hash:e&&null!=t?(0,n.CUSTOM_STRING)(t):n.DROP_ATTR}));return(0,p.sendIq)(r,s.abPropsParser).then((e=>{if(e.success&&null!=e.result){var t=Date.now();if((0,u.updateAttributesLocalStorage)(e.result.abKey,e.result.hash,e.result.refresh,t),null!=e.result.hash)return(0,d.updateABPropConfigs)((0,c.parseABProps)(e.result.props)).catch((()=>{__LOG__(4,!0,new Error,!0)`update ABProps config table failed`,SEND_LOGS("update ABProps config table failed when syncing ABProps")}))}}))}function f(){return(f=(0,i.default)((function*(){for(var e=(0,u.isABPropsAfterFirstSync)(),t=3;t-- >0;)try{yield h(e),t=0}catch(e){0===t&&(__LOG__(4,!0,new Error,!0)`failed to sync ABProps`,SEND_LOGS("failed to sync ABProps")),yield(0,o.delayMs)(1e4*Math.random())}}))).apply(this,arguments)}var _=(0,l.cacheWhilePending)((()=>"abProps"),h);t.default=_},81600:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.getDevices=function(e){return(0,n.syncDeviceList)([(0,o.assertGetMe)()],e)},t.getAndUpdateProfilePicture=function(){var e=(0,l.default)(d.default.get((0,o.getMeUser)()),"ProfilePicThumbCollection.get(getMeUser())");return d.default.resyncPictures([e])},t.updatePrivacySettings=function(){return(0,c.getPrivacy)().then(function(){var e=(0,i.default)((function*(e){if(e.groupAdd===c.GROUP_ADD.contact_blacklist)try{var t=yield(0,c.getBlockedContacts)();"mismatch"===t.status&&(e.blackList=t.users)}catch(e){__LOG__(3,void 0,void 0,!0)`failed to get disallowed contact list for groupadd`,SEND_LOGS("failed to get disallowed contact list for groupadd")}(0,o.setUserPrivacySettings)(e)}));return function(){return e.apply(this,arguments)}}())},t.updateBlocklist=function(){(0,u.fetchAndUpdateBlocklist)().then((e=>{e.dhash&&(s.default.toArray().forEach((e=>s.default.remove(e))),e.wids&&e.wids.forEach((e=>{s.default.gadd(e)})))}))},t.ACCOUNT_SYNC_TYPE=void 0;var i=a(r(52954)),n=r(47882),s=a(r(88025)),o=r(66239),l=a(r(21830)),d=a(r(93562)),u=r(51),c=r(52292),p=Object.freeze({BLOCKLIST:"blocklist",DEVICES:"devices",PICTURE:"picture",PRIVACY:"privacy",STATUS:"status"});t.ACCOUNT_SYNC_TYPE=p},47882:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.syncDeviceList=h,t.syncAndGetDeviceList=function(){return _.apply(this,arguments)};var i=a(r(52954)),n=a(r(35838)),s=r(9641),o=r(24581),l=r(17063),d=r(23665),u=r(90297),c=r(25054),p=new Map;function h(){return f.apply(this,arguments)}function f(){return(f=(0,i.default)((function*(e,t,r){if(null!=r){var a=e.map((e=>e.user)),o=(yield(0,s.getDeviceIds)(a)).map((e=>e?e.devices.map((t=>(0,c.createDeviceWidFromUserAndDevice)(e.id,t))):[])),d=(0,n.default)(o,(e=>e));if(r===(yield(0,l.phashV2)(d)))return}var u=new Set,h=[];if(e.forEach((e=>{var t=p.get(e.user);t?u.add(t):h.push(e)})),0!==h.length){var f=h.map((e=>e.user)),_=(0,s.getDeviceIds)(f).then(function(){var e=(0,i.default)((function*(e){var r=e.map((e=>e?e.devices.map((t=>(0,c.createDeviceWidFromUserAndDevice)(e.id,t))):[])),a=yield Promise.all(r.map((e=>0===e.length?"":(0,l.phashV2)(e))));return m(h.map(((e,t)=>({id:e,hash:a[t]}))),t)}));return function(){return e.apply(this,arguments)}}()).catch((e=>{__LOG__(4,void 0,new Error)`Failed to sync device list with error: ${e}`})).finally((()=>{h.map((e=>{p.delete(e.user)}))}));h.map((e=>{p.set(e.user,_)})),yield Promise.all([_,...u])}}))).apply(this,arguments)}function _(){return(_=(0,i.default)((function*(e){var t=e.map((e=>e.user));return yield h(e),(0,s.getDeviceIds)(t)}))).apply(this,arguments)}function m(){return g.apply(this,arguments)}function g(){return(g=(0,i.default)((function*(e,t){if(0!==e.length){var r=(new u.USyncQuery).withContext(t||"interactive").withDeviceProtocol();e.forEach((e=>{r.withUser((new d.USyncUser).withId(e.id).withDeviceHash(String(e.hash)))}));var a=yield r.execute();if(a.error.all)throw new Error(`syncDeviceList: error ${a.error.all.errorCode}: ${a.error.all.errorText}`);a.error.devices&&__LOG__(3)`syncDeviceList: error ${a.error.devices.errorCode}: ${a.error.devices.errorText}`;var i=a.list.filter((e=>!("errorCode"in e.devices))).filter((e=>null!=e.devices.deviceList&&null!=e.devices.keyIndex)).map((e=>({wid:e.id,devices:e.devices})));return __LOG__(2)`syncDeviceList: skipping ${a.list.length-i.length} out of ${a.list.length} records`,(0,o.handleADVDeviceSyncResult)(i)}}))).apply(this,arguments)}},20174:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.blockUser=function(e){return u.default.mdBlocklistV2?function(e){return m(e,!0)}(e):function(e){var t=o.default.map((e=>e.id));return t.push(e),f((0,i.default)(t))}(e)},t.unblockUser=function(e){return u.default.mdBlocklistV2?function(e){return m(e,!1)}(e):function(e){var t=o.default.map((e=>e.id));return t.splice(t.indexOf(e),1),f((0,i.default)(t))}(e)};var i=a(r(75652)),n=r(82420),s=r(35773),o=a(r(88025)),l=r(7017),d=r(66239),u=a(r(54559)),c=r(29020),p=r(25054),h=new n.WapParser("blockUser",(e=>{if(e.hasChild("error")){var t=e.child("error"),r=t.attrInt("code"),a=t.attrString("text");return __LOG__(3)`sendBlocklist: sever response with ${r}, ${a}`,{errorCode:r,errorText:a}}__LOG__(2)`sendBlocklist: success`}));function f(e){var t=0===e.length?(0,s.wap)("list",{name:"default"}):(0,s.wap)("list",{name:"default"},e.map((e=>(0,s.wap)("item",{action:"deny",type:"jid",value:(0,c.JID)(e),order:"1"})))),r=(0,s.wap)("iq",{xmlns:"jabber:iq:privacy",from:(0,c.JID)((0,d.assertGetMe)()),type:"set",id:(0,s.generateId)()},(0,s.wap)("query",null,t));return(0,l.sendIq)(r,h).then((e=>{if(e.success)return e.result;var{errorCode:t,errorText:r}=e;return __LOG__(3)`sendBlocklist: server response with ${t}, ${r}`,{errorCode:t,errorText:r}}))}var _=new n.WapParser("blockUserV2ResponseParser",(e=>{var t;if(e.hasChild("error")){var r=e.child("error"),a=r.attrInt("code"),i=r.attrString("text");return __LOG__(3)`blockUserV2ResponseParser: server response with ${a}, ${i}`,{errorCode:a,errorText:i}}return __LOG__(2)`block/unblock user: success`,{blockedUsers:null===(t=e.child("list"))||void 0===t?void 0:t.mapChildrenWithTag("item",(e=>(0,p.userJidToUserWid)(e.attrUserJid("jid"))))}}));function m(e,t){var r=(0,s.wap)("iq",{xmlns:"blocklist",to:s.S_WHATSAPP_NET,type:"set",id:(0,s.generateId)()},(0,s.wap)("item",{action:(0,s.CUSTOM_STRING)(t?"block":"unblock"),jid:(0,c.JID)(e)}));return(0,l.sendIq)(r,_).then((e=>{if(!e.success){var{errorCode:t,errorText:r}=e;return __LOG__(3)`blockUnblockUserV2: server response with ${t}, ${r}`,{errorCode:t,errorText:r}}}))}},67280:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.clearDirtyBits=function(e){if(0===e.length)return Promise.resolve();var t=e.map((e=>(0,i.wap)("clean",{type:(0,i.CUSTOM_STRING)(e.type),timestamp:(0,i.INT)(e.timestamp)}))),r=(0,i.wap)("iq",{to:i.S_WHATSAPP_NET,type:"set",xmlns:"urn:xmpp:whatsapp:dirty",id:(0,i.generateId)()},t);return(0,n.sendIq)(r,s).then((()=>{__LOG__(2)`clearDirtyBits: success for type: ${e.map((e=>e.type)).join(",")}`})).catch((()=>{__LOG__(3)`clearDirtyBits: failed with error`}))};var i=r(35773),n=r(7017),s=new(a(r(45521)).default)("cleanDirtyReplyParser",(e=>(e.assertAttr("type","result"),{})))},74878:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.metricsCiphertextType=function(e){switch(e){case s.CiphertextType.Skmsg:return n.default.E2E_CIPHERTEXT_TYPE.SENDER_KEY_MESSAGE;case s.CiphertextType.Pkmsg:return n.default.E2E_CIPHERTEXT_TYPE.PREKEY_MESSAGE;case s.CiphertextType.Msg:return n.default.E2E_CIPHERTEXT_TYPE.MESSAGE}},t.metricsMediaType=function(e){switch(e){case s.MediaType.Photo:return n.default.MEDIA_TYPE.PHOTO;case s.MediaType.Video:return n.default.MEDIA_TYPE.VIDEO;case s.MediaType.Audio:return n.default.MEDIA_TYPE.AUDIO;case s.MediaType.Ptt:return n.default.MEDIA_TYPE.PTT;case s.MediaType.Location:return n.default.MEDIA_TYPE.LOCATION;case s.MediaType.Contact:return n.default.MEDIA_TYPE.CONTACT;case s.MediaType.Document:return n.default.MEDIA_TYPE.DOCUMENT;case s.MediaType.Url:return n.default.MEDIA_TYPE.URL;case s.MediaType.Call:return n.default.MEDIA_TYPE.CALL;case s.MediaType.Gif:return n.default.MEDIA_TYPE.GIF;case s.MediaType.Future:return n.default.MEDIA_TYPE.FUTURE;case s.MediaType.ContactArray:return n.default.MEDIA_TYPE.CONTACT_ARRAY;case s.MediaType.LiveLocation:return n.default.MEDIA_TYPE.LIVE_LOCATION;case s.MediaType.ProfilePic:return n.default.MEDIA_TYPE.PROFILE_PIC;case s.MediaType.Sticker:return n.default.MEDIA_TYPE.STICKER;case s.MediaType.Hsm:return n.default.MEDIA_TYPE.HSM;case s.MediaType.ProductImage:return n.default.MEDIA_TYPE.PRODUCT_IMAGE;case s.MediaType.Template:return n.default.MEDIA_TYPE.TEMPLATE;case s.MediaType.MdAppState:return n.default.MEDIA_TYPE.MD_APP_STATE;case s.MediaType.MdHistorySync:return n.default.MEDIA_TYPE.MD_HISTORY_SYNC;case s.MediaType.List:return n.default.MEDIA_TYPE.LIST;case s.MediaType.ListResponse:return n.default.MEDIA_TYPE.LIST_REPLY;case s.MediaType.Button:return n.default.MEDIA_TYPE.BUTTON_MESSAGE;case s.MediaType.ButtonResponse:return n.default.MEDIA_TYPE.BUTTON_RESPONSE_MESSAGE;case s.MediaType.Order:return n.default.MEDIA_TYPE.ORDER;case s.MediaType.Product:return n.default.MEDIA_TYPE.PRODUCT_IMAGE}},t.mediaTypeFromProtobuf=function e(t){if(t.deviceSentMessage){var{message:r}=t.deviceSentMessage;return r?e(r):null}if(t.ephemeralMessage){var{message:a}=t.ephemeralMessage;return a?e(a):null}if(t.viewOnceMessage){var{message:i}=t.viewOnceMessage;return i?e(i):null}return t.imageMessage?s.MediaType.Photo:t.stickerMessage?s.MediaType.Sticker:t.locationMessage?s.MediaType.LiveLocation:t.contactMessage?s.MediaType.Contact:t.contactsArrayMessage?s.MediaType.ContactArray:t.documentMessage?s.MediaType.Document:t.audioMessage?t.audioMessage.ptt?s.MediaType.Ptt:s.MediaType.Audio:t.videoMessage?t.videoMessage.gifPlayback?s.MediaType.Gif:s.MediaType.Video:t.buttonsMessage?s.MediaType.Button:t.buttonsResponseMessage?s.MediaType.ButtonResponse:t.listMessage?s.MediaType.List:t.listResponseMessage?s.MediaType.ListResponse:t.orderMessage?s.MediaType.Order:t.productMessage?s.MediaType.Product:null},t.encodeMediaType=o,t.maybeEncoder=l,t.metricsDestinationType=function(e){if(e.isUser())return n.default.E2E_DESTINATION.INDIVIDUAL;if(e.isGroup())return n.default.E2E_DESTINATION.GROUP;if(e.isStatusV3())return n.default.E2E_DESTINATION.STATUS;if(e.isBroadcast())return n.default.E2E_DESTINATION.LIST;throw new Error},t.encodeMaybeMediaType=t.CIPHERTEXT_VERSION=void 0;var i=r(35773),n=a(r(84161)),s=r(47294);function o(e){var t=(()=>{switch(e){case s.MediaType.Photo:return"image";case s.MediaType.Video:return"video";case s.MediaType.Audio:return"audio";case s.MediaType.Ptt:return"ptt";case s.MediaType.Contact:return"vcard";case s.MediaType.Document:return"document";case s.MediaType.Gif:return"gif";case s.MediaType.ContactArray:return"contact_array";case s.MediaType.LiveLocation:return"livelocation";case s.MediaType.Sticker:return"sticker";case s.MediaType.List:return"list";case s.MediaType.ListResponse:return"list_response";case s.MediaType.ButtonResponse:return"buttons_response";case s.MediaType.Order:return"order";case s.MediaType.Product:return"product";default:return null}})();if(t)return(0,i.CUSTOM_STRING)(t);throw new Error("Unsupported type")}function l(e){return t=>null==t?i.DROP_ATTR:e(t)}t.CIPHERTEXT_VERSION=2;var d=l(o);t.encodeMaybeMediaType=d},83170:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=o.parseParsableWap(e);if(t.error)throw __LOG__(4,void 0,new Error)`${t.error.toString()} parsing ${e.toString()}`,t.error;return t.success};var i=r(19999),n=a(r(45521)),s=a(r(22618)),o=new n.default("businessProfile",(e=>{var t,r=e.maybeChild("address"),a=r?r.contentString():void 0,n=e.maybeChild("description"),o=n?n.contentString():void 0,l=e.maybeChild("email"),d=l?l.contentString():void 0,u=e.maybeChild("latitude"),c=u?parseFloat(u.contentString()):void 0,p=e.maybeChild("longitude"),h=p?parseFloat(p.contentString()):void 0,f=e.maybeChild("vertical");if(f){var _=f.maybeAttrString("canonical");t={name:f.hasContent()?f.contentString():void 0,canonical:_}}var m=[];e.forEachChildWithTag("website",(e=>{m.push(e.contentString())}));var g,v=[],E=e.maybeChild("categories");E&&E.forEachChildWithTag("category",(e=>{var t=e.attrString("id");v.push({id:t,localized_display_name:e.contentString()})}));var y,S=e.maybeChild("business_hours");if(S){var T=S.maybeAttrString("timezone"),A=[];S.forEachChildWithTag("business_hours_config",(e=>{A.push({day_of_week:e.attrString("day_of_week"),mode:e.attrString("mode"),open_time:e.hasAttr("open_time")?parseInt(e.attrString("open_time"),10):0,close_time:e.hasAttr("close_time")?parseInt(e.attrString("close_time"),10):0})})),g={config:A,timezone:T}}var b=e.maybeChild("profile_options");if(b){y={};var C,P=b.maybeChild("commerce_experience");if(P)y.commerce_experience=null!==(C=i.COMMERCE_EXPERIENCE_TYPES.cast(P.contentString()))&&void 0!==C?C:i.COMMERCE_EXPERIENCE_TYPES.NONE;var O=b.maybeChild("cart_enabled");O&&(y.cart_enabled="true"===O.contentString());var w=b.maybeChild("shop_url");w&&(y.shop_url=w.contentString());var M=b.maybeChild("commerce_manager_url");M&&(y.commerce_manager_url=M.contentString())}var I=e.maybeChild("catalog_status"),R=I?I.attrString("status"):void 0,D={address:a,description:o,email:d,latitude:c,longitude:h,vertical:t,website:m,categories:v,business_hours:g,catalog_status:R,profile_options:y};return(0,s.default)(D)}))},38843:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseErrorFields=void 0;var a=new(r(82420).WapParser)("parseErrorFields",(e=>{var t=[];return e.forEachChildWithTag("field",(e=>{var r=e.hasAttr("detail")?e.maybeAttrString("detail"):null;t.push({name:e.attrString("name"),reason:e.attrString("reason"),detail:r})})),t}));t.parseErrorFields=a},55371:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=o.parseParsableWap(e);if(t.error)throw __LOG__(4,void 0,new Error)`${t.error.toString()} parsing ${e.toString()}`,t.error;return t.success};var i=r(11094),n=a(r(45521)),s=r(61563);var o=new n.default("verifiedName",(e=>{var t=e.attrEnum("verified_level",i.VERIFIED_LEVEL),r=e.hasContent()?e.contentBytes():null,a=e.maybeAttrString("serial"),{serial:n,name:o,isApi:l}=r&&function(e){var t=(0,s.getParsedProtoObjects)(e);if(t&&t.details){var{name:r,serial:a,isApi:i}=(0,s.extractCertificateDetailsParams)(t.details);return{name:r,serial:String(a),isApi:i}}}(r)||{},d=e.maybeAttrEnum("actual_actors",i.ACTUAL_ACTORS),u=e.maybeAttrEnum("host_storage",i.HOST_STORAGE),c=e.maybeAttrInt("privacy_mode_ts");return{level:t,serial:a||n,name:o,isApi:!0===l,privacyMode:null!=d&&null!=u&&null!=c?{actualActors:d,hostStorage:u,privacyModeTs:c}:null}}))},24789:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.syncNewContact=function(e){A.push(e),T?T.debounce(1e3):(T=new s.ShiftTimer((()=>{if((0,h.isRegistered)()){var e=A;A=[],T=null,__LOG__(2,void 0,void 0,void 0,["contact-sync"])`start new contact sync for ${e.length} contacts`,P(e).catch((e=>{__LOG__(4,!0,new Error,!0)`contact sync failed`,SEND_LOGS("contact sync failed: "+e)}))}}))).onOrBefore(2e4)},t.syncContactListInChunks=b,t.syncContactList=P,t.runSyncDirtyContactsJob=function(){(0,h.getShouldCheckContactSyncStatus)()&&setTimeout((function(){(0,c.getContactTable)().equals(["isContactSyncCompleted"],0).then((e=>{var t=e.map((e=>(0,S.createWid)(e.id)));return __LOG__(2,void 0,void 0,void 0,["contact-sync"])`sync dirty contacts, found ${t.length} contacts to sync`,b(t)}))}),6e4);(0,h.setShouldCheckContactSyncStatus)()},t.getContactSyncRefreshSeconds=function(){var e,t=null!==(e=(0,_.default)(p.default,"localStorage").getItem(f.default.KEY_CONTACT_SYNC_REFRESH))&&void 0!==e?e:86400;return parseInt(t,10)};var i=a(r(52954)),n=r(60266),s=r(35160),o=r(11219),l=r(9641),d=r(32619),u=r(24581),c=r(38027),p=a(r(48879)),h=r(63191),f=a(r(43312)),_=a(r(21830)),m=r(17063),g=a(r(48514)),v=r(23665),E=r(90297),y=r(35985),S=r(25054),T=null,A=[];function b(){return C.apply(this,arguments)}function C(){return(C=(0,i.default)((function*(e,t=500){__LOG__(2,void 0,void 0,void 0,["contact-sync"])`start contact sync for ${e.length} contacts in ${Math.ceil(e.length/t)} chunks, each chunk size: ${t}`;for(var r=0;r<e.length;r+=t){var a=e.slice(r,r+t);yield(0,n.delayMs)(2e4),yield P(a)}}))).apply(this,arguments)}function P(){return O.apply(this,arguments)}function O(){return(O=(0,i.default)((function*(e,t=!0){if(0!==e.length){var r=yield w(e),a=(new E.USyncQuery).withContext("background").withMode("full").withBusinessProtocol().withStatusProtocol().withPictureProtocol();t&&a.withDeviceProtocol(),r.forEach((e=>{a.withUser((new v.USyncUser).withId(e.id).withDeviceHash(String(e.hash)))}));for(var i=null,s=3;s-- >0;)try{var o=(i=yield a.execute()).error.all;if(o)throw new Error(`syncContactList: error ${o.errorCode}: ${o.errorText}`);s=0}catch(e){0===s&&(__LOG__(4,!0,new Error,!0)`failed to execute usync query`,SEND_LOGS("failed to execute usync query: "+e)),yield(0,n.delayMs)(1e4*Math.random())}if(null!=i&&!i.error.all){var l=i.refresh,d=[];for(var u of Object.keys(l))d.push(l[u]);if(d.length>0)G(Math.min(...d));yield Promise.all([t?N(i):Promise.resolve(),I(i),R(i),k(i)]),yield U(e)}}}))).apply(this,arguments)}function w(){return M.apply(this,arguments)}function M(){return(M=(0,i.default)((function*(e){var t=e.map((e=>e.user)),r=(yield(0,l.getDeviceIds)(t)).map((e=>e?e.devices.map((t=>(0,S.createDeviceWidFromUserAndDevice)(e.id,t))):[])),a=yield Promise.all(r.map((e=>0===e.length?"":(0,m.phashV2)(e))));return e.map(((e,t)=>({id:e,hash:a[t]})))}))).apply(this,arguments)}function I(e){var t=e.error.status;t?__LOG__(3)`handleSyncStatus: failed ${t.errorCode} : ${t.errorText}`:e.list.map((e=>{var t=g.default.get(e.id);t&&e.status&&t.set({status:e.status})}))}function R(){return D.apply(this,arguments)}function D(){return(D=(0,i.default)((function*(e){var t=e.list.filter((({business:e})=>Boolean(e)));yield(0,y.handleVerifiedNameSync)(t.map((({id:e,business:{verifiedName:t}})=>({id:e,verifiedName:t}))))}))).apply(this,arguments)}function N(){return L.apply(this,arguments)}function L(){return(L=(0,i.default)((function*(e){var t=e.error.devices;t&&__LOG__(3)`handleSyncDevice: error ${t.errorCode}: ${t.errorText}`;var r=e.list.filter((e=>e.devices&&null!=e.devices.deviceList&&null!=e.devices.keyIndex&&!("errorCode"in e.devices))).map((e=>({wid:e.id,devices:e.devices})));return __LOG__(2)`handleSyncDevice: skipping ${e.list.length-r.length} out of ${e.list.length} records`,yield(0,d.getAndStoreIdentityKeys)(r.map((e=>e.wid))),(0,u.handleADVDeviceSyncResult)(r)}))).apply(this,arguments)}function k(e){var t=e.error.pictures;t&&__LOG__(3)`handleSyncProfilePictures: failed ${t.errorCode} : ${t.errorText}`}function U(e){var t=e.map((e=>({id:(0,o.toJid)(e.user),isContactSyncCompleted:1})));return __LOG__(2,void 0,void 0,void 0,["contact-sync"])`mark ${t.length} contacts completed for contact sync`,(0,c.getContactTable)().bulkCreateOrMerge(t)}function G(e){isNaN(e)||e<=3600?__LOG__(3,void 0,void 0,void 0,["contact-sync"])`invalid contact sync refresh period: ${e}`:(__LOG__(2,void 0,void 0,void 0,["contact-sync"])`set contact sync refresh period: ${e}`,(0,_.default)(p.default,"localStorage").setItem(f.default.KEY_CONTACT_SYNC_REFRESH,String(e)))}},83756:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.digestKey=function(){var e=(0,i.wap)("iq",{xmlns:"encrypt",type:"get",to:i.S_WHATSAPP_NET,id:(0,i.generateId)()},(0,i.wap)("digest",null));return(0,s.sendIq)(e,c).then((e=>{if(e.success)return(t=e.result,Promise.all([l.waSignalStore.getRegistrationInfo(),l.waSignalStore.getSignedPreKey()]).then((([e,r])=>{if(!e||!r)throw new Error("validateLocalKeyBundle: No registration info is available");if(t.regId!==e.registrationId)throw new Error("validateLocalKeyBundle: registation id mismatch");var a=e.identityKeyPair.pubKey,i=r.keyPair.pubKey,s=a.byteLength+i.byteLength+r.signature.byteLength+32*t.keys.length,o=new Uint8Array(s),u=0;[a,i,r.signature].forEach((e=>{o.set(new Uint8Array(e),u),u+=e.byteLength}));var c=t.keys.map((e=>l.waSignalStore.getPreKeyById(e).then((t=>{if(!t)throw Error(`validateLocalKeyBundle: missing prekey record for id ${e}`);return t.keyPair.pubKey}))));return Promise.all(c).then((e=>(e.forEach((e=>{o.set(new Uint8Array(e),u),u+=e.byteLength})),o))).then((e=>{d.default.digest("SHA-1",e).then((e=>{var r=(0,n.encodeB64)(e),a=(0,n.encodeB64)(t.hash);if(r!==a)throw Error(`validateLocalKeyBundle: hash mismatch remote:${a} local:${r}`);__LOG__(2)`validateLocalKeyBundle: success`}))}))}))).then((()=>({shouldUploadAll:!1}))).catch((()=>({shouldUploadAll:!1})));var t,r=e.errorCode;return 404===r?(__LOG__(3)`digestKey: no record found for current user`,Promise.resolve({shouldUploadAll:!0})):(406===r?__LOG__(3)`digestKey: malformed request`:503===r?__LOG__(3)`digestKey: service unavailable`:__LOG__(3)`digestKey: server error ${r}`,Promise.resolve({shouldUploadAll:!1}))})).then((e=>{if(e.shouldUploadAll)return __LOG__(2)`digestKey: validate key bundle failed, upload prekeys again`,(0,u.uploadPreKeys)()}))};var i=r(35773),n=r(84337),s=r(7017),o=a(r(45521)),l=r(24606),d=a(r(62549)),u=r(52663),c=new o.default("digestResponseParser",(e=>{var t=e.child("digest"),r=t.child("skey");return{regId:t.child("registration").contentUint(4),type:t.child("type").contentUint(1),identity:t.child("identity").contentBytes(32),skey:{id:r.child("id").contentUint(3),pubkey:r.child("value").contentBytes(32),signature:r.child("signature").contentBytes(64)},keys:t.child("list").mapChildren((e=>e.contentUint(3))),hash:t.child("hash").contentBytes(20)}}))},14898:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){if(!s.default.isWid(e)||!e.isUser())return __LOG__(3)`getAbout: this method should only take user wid, instead it received: ${e}`,Promise.resolve({id:e});return(new n.USyncQuery).withContext("interactive").withMode("query").withStatusProtocol().withUser((new i.USyncUser).withId(e)).execute().then((t=>{if(t.error.all||t.error.status){var r=t.error.all||t.error.status;return __LOG__(3)`getAbout: failed ${r.errorCode} : ${r.errorText}`,{id:e,error:r}}var a=t.list;return a.length||Promise.reject(new Error("no status data returned for user")),{id:e,status:a[0].status}}))};var i=r(23665),n=r(90297),s=a(r(43926))},37886:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.getBlocklist=function(){return(0,n.sendIq)((0,i.wap)("iq",{xmlns:"jabber:iq:privacy",from:(0,l.JID)((0,s.assertGetMe)()),type:"get",id:(0,i.generateId)()},(0,i.wap)("query",null,(0,i.wap)("list",{name:"default"}))),d).then((e=>{if(e.success)return __LOG__(2)`getBlocklist from server`,e.result;var{errorCode:t,errorText:r}=e;return __LOG__(3)`getBlocklist: failed ${t}, ${r}`,{errorCode:t,errorText:r}}))};var i=r(35773),n=r(7017),s=r(66239),o=a(r(45521)),l=r(29020),d=new o.default("getBlocklistParser",(e=>e.hasChild("error")&&404===e.child("error").attrInt("code")?{wids:[]}:{wids:u(e)}));function u(e){return e.child("query").child("list").mapChildrenWithTag("item",(e=>e.attrUserWid("value")))}},32619:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.getAndStoreIdentityKeys=function(){return f.apply(this,arguments)},t.default=_;var i=a(r(52954)),n=r(35773),s=r(7017),o=r(446),l=a(r(45521)),d=r(24606),u=r(89308),c=r(69909),p=r(29020),h=new l.default("identityKeysParser",(e=>e.child("list").mapChildren((e=>{if(e.hasChild("error")){var t=e.child("error"),r=t.attrInt("code"),a=t.attrString("text");throw new Error(`identityKeysParser bad response: ${r} ${a}`)}return{type:e.child("type").contentBytes(1),identity:e.child("identity").contentBytes(32),user:e.attrUserWid("jid")}}))));function f(){return(f=(0,i.default)((function*(e){var t=yield d.waSignalStore.bulkGetIdentity(e.map((e=>String((0,c.createSignalAddress)(e))))),r=e.filter(((e,r)=>null==t[r]));if(0!==r.length){__LOG__(2)`getAndStoreIdentityKeys: query ${r.length} missing keys for ${e.length} contacts`;var a=(yield _(r)).map((e=>{var t=e.identity,r=(0,o.toSignalCurvePubKey)(t.buffer.slice(t.byteOffset,t.byteLength+t.byteOffset));return{identityKey:(0,c.bufferToStr)(r),identifier:(0,c.createSignalAddress)(e.user).toString()}}));return(0,u.getStorage)().lock(["identity-store"],(()=>d.waSignalStore.bulkPutIdentity(a)))}__LOG__(2)`getAndStoreIdentityKeys: got 0 missing keys`}))).apply(this,arguments)}function _(e){var t=e.map((e=>(0,n.wap)("user",{jid:(0,p.DEVICE_JID)(e)}))),r=(0,n.wap)("iq",{xmlns:"encrypt",type:"get",to:n.S_WHATSAPP_NET,id:(0,n.generateId)()},(0,n.wap)("identity",null,t));return(0,s.sendIq)(r,h).then((e=>{if(!e.success)throw new Error(`getIdentityKeys bad response ${String(e)}`);return e.result}))}},8525:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.getProfilePicPreview=function(e,t){return c(e,{preview:!0,invite:t})},t.getProfilePicFull=function(e){return c(e,{preview:!1})};var i=r(35773),n=r(7017),s=r(33576),o=a(r(45521)),l=r(29020),d={preview:"preview",image:"image"},u=new o.default("profilePicParser",(e=>{var t=e.child("picture");return{id:t.attrInt("id"),type:t.attrEnum("type",d),url:t.attrString("url")}}));function c(e,t){var{preview:r,invite:a,photoId:o}=t,d=(0,i.wap)("iq",{to:(0,l.CHAT_JID)(e),type:"get",xmlns:"w:profile:picture",id:(0,i.generateId)()},(0,i.wap)("picture",{invite:(0,i.MAYBE_CUSTOM_STRING)(a),type:r?"preview":i.DROP_ATTR,id:null!=o?(0,i.INT)(o):i.DROP_ATTR,query:"url"}));return(0,n.sendIq)(d,u).then((t=>{if(t.success){var{id:r,url:a,type:i}=t.result;return __LOG__(2)`getProfilePic: ${e.toString()} ${r}, ${i}, ${a}`,{tag:r.toString(),eurl:a,type:i}}return Promise.reject(new s.ServerStatusCodeError(t.errorCode,t.errorText))}))}},6651:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.createGroup=function(e,t,r=!1){var a=(0,n.randomHex)(8),d=(0,s.getABPropConfigValue)("groups_dogfooding_ui"),u=t.map((e=>(0,i.wap)("participant",{jid:(0,c.USER_JID)(e)})));d&&r&&u.unshift((0,i.wap)("dogfooding",null));var p=(0,i.wap)("iq",{to:i.G_US,type:"set",xmlns:"w:g2",id:(0,i.generateId)()},(0,i.wap)("create",{subject:(0,i.CUSTOM_STRING)(e),key:(0,i.CUSTOM_STRING)(a)},u));return(0,o.sendIq)(p,h).then((e=>e.success?e.result:Promise.reject(new l.ServerStatusCodeError(e.errorCode,e.errorText))))};var i=r(35773),n=r(61212),s=r(71796),o=r(7017),l=r(33576),d=a(r(45521)),u=r(1834),c=r(29020),p=r(25054),h=new d.default("createGroupReplyParser",(e=>{var t,r=e.child("group");try{t=(0,p.createWid)(`${r.attrString("id")}@g.us`)}catch(e){}if(!t||!t.isGroup)throw Error("createGroupReplyParser: invalid group id");return{wid:t,subject:r.attrString("subject"),creator:r.attrUserWid("creator"),ts:r.attrTime("creation"),participants:r.mapChildrenWithTag("participant",(e=>{var t=e.getFirstChild();return{wid:e.attrUserWid("jid"),error:e.hasAttr("error")?e.attrInt("error"):null,invite_code:t&&t.attrString("code"),invite_code_exp:t&&t.attrString("expiration"),type:e.attrEnumOrDefault("type",u.GROUP_PARTICIPANT_TYPES,"participant")}}))}}))},98034:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.leaveGroups=function(e){var t=e.map((e=>(0,i.wap)("group",{id:(0,l.GROUP_JID)(e)}))),r=(0,i.wap)("iq",{to:i.G_US,type:"set",xmlns:"w:g2",id:(0,i.generateId)()},(0,i.wap)("leave",null,t));return(0,n.sendIq)(r,d).then((e=>e.success?e.result:Promise.reject(new s.ServerStatusCodeError(e.errorCode,e.errorText))))};var i=r(35773),n=r(7017),s=r(33576),o=a(r(45521)),l=r(29020),d=new o.default("leaveGroupResultParser",(e=>(e.assertAttr("type","result"),{groups:e.child("leave").mapChildren((e=>e.attrGroupWid("id")))})))},33941:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.queryAllGroups=function(){var e=(0,n.wap)("iq",{to:n.G_US,type:"get",xmlns:"w:g2",id:(0,n.generateId)()},(0,n.wap)("participating",null,(0,n.wap)("participants",null),(0,n.wap)("description",null)));return(0,s.sendIq)(e,f).then((e=>e.success?e.result:(__LOG__(2)`queryAllGroups failed: ${e.errorCode}:${e.errorType}`,Promise.reject(new o.ServerStatusCodeError(e.errorCode,e.errorText)))))},t.queryGroup=function(e,t,r){var a=(0,n.wap)("iq",{to:(0,u.GROUP_JID)(e),type:"get",xmlns:"w:g2",id:(0,n.generateId)()},(0,n.wap)("query",{request:t||n.DROP_ATTR,phash:(0,n.MAYBE_CUSTOM_STRING)(r)}));return(0,s.sendIq)(a,h).then((e=>{if(e.success){var{result:t}=e;return t.phashMatch?Promise.reject(new Error("queryGroup: phash match case is not implemented!")):t}return __LOG__(2)`queryGroup failed: ${e.errorCode}:${e.errorType}`,Promise.reject(new o.ServerStatusCodeError(e.errorCode,e.errorText))}))},t.queryGroupInvite=function(e){var t=(0,n.wap)("iq",{to:n.G_US,type:"get",xmlns:"w:g2",id:(0,n.generateId)()},(0,n.wap)("invite",{code:(0,n.CUSTOM_STRING)(e)}));return(0,s.sendIq)(t,h).then((e=>e.success?e.result:(__LOG__(2)`queryGroupInvite failed: ${e.errorCode}:${e.errorType}`,Promise.reject(new o.ServerStatusCodeError(e.errorCode,e.errorText)))))};var i=a(r(70417)),n=r(35773),s=r(7017),o=r(33576),l=a(r(45521)),d=r(1834),u=r(29020),c=r(25054);function p(e){var t,r=function(e){if(e.hasChild("description")){var t=e.child("description");if(t.hasChild("body")){var r=t.child("body");if(r.hasContent()){var a={desc:r.contentString(),descId:t.attrString("id")};return t.hasAttr("participant")&&(a.descOwner=t.attrUserWid("participant")),t.hasAttr("t")&&(a.descTime=t.attrTime("t")),a}}}return null}(e),a=function(e){var t={subject:e.attrString("subject")};return e.hasAttr("s_o")&&(t.subjectOwner=e.attrUserWid("s_o")),e.hasAttr("s_t")&&(t.subjectTime=e.attrTime("s_t")),t}(e),n=function(e){if(e.hasChild("ephemeral")){var t=e.child("ephemeral");if(t.hasAttr("expiration"))return{ephemeralDuration:t.attrInt("expiration")}}return null}(e);try{t=(0,c.createWid)(`${e.attrString("id")}@g.us`)}catch(e){}if(!t||!t.isGroup)throw Error("createGroupReplyParser: invalid group id");var s=e.mapChildrenWithTag("participant",(e=>{var t=e.attrEnumOrDefault("type",d.GROUP_PARTICIPANT_TYPES,d.GROUP_PARTICIPANT_TYPES.participant);return{id:e.attrUserWid("jid"),isSuperAdmin:t===d.GROUP_PARTICIPANT_TYPES.superadmin,isAdmin:t===d.GROUP_PARTICIPANT_TYPES.admin||t===d.GROUP_PARTICIPANT_TYPES.superadmin}})),o={id:t,owner:e.hasAttr("creator")?e.attrUserWid("creator"):void 0,creation:e.attrTime("creation"),restrict:e.hasChild("locked"),announce:e.hasChild("announcement"),noFrequentlyForwarded:e.hasChild("no_frequently_forwarded"),participants:s,pvId:e.hasAttr("p_v_id")?e.attrInt("p_v_id"):void 0,support:e.hasChild("support")};return(0,i.default)((0,i.default)((0,i.default)((0,i.default)({},o),r),n),a)}var h=new l.default("queryGroupParser",(e=>e.hasChild("group")?p(e.child("group")):{phashMatch:!0})),f=new l.default("queryAllGroupParser",(e=>e.child("groups").mapChildren(p)))},1834:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GROUP_PARTICIPANT_TYPES=void 0;t.GROUP_PARTICIPANT_TYPES={superadmin:"superadmin",admin:"admin",participant:"participant"}},36939:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=u.parse(e);if(t.error)return __LOG__(4,void 0,new Error)`${t.error.toString()} parsing ${e.toString()}`,Promise.reject(t.error);return function(e){switch(__LOG__(2)`handleAboutNotification: received ${e.type}
for ${e.from.toString()}`,e.type){case d.SIDE_LIST_CHANGE:break;case d.CHANGE:var t=o.default.get(e.from);t?t.status=e.content:__LOG__(3)`handleAboutNotification: get status update for unknown contact ${e.from}`;break;default:__LOG__(3)`handleAboutNotification: unhandled notification of
type ${e.type}`}return(0,n.wap)("ack",{id:(0,n.CUSTOM_STRING)(e.stanzaId),to:"change"===e.type?(0,l.JID)(e.from):(0,n.CUSTOM_STRING)(e.from),class:"notification",type:"status"})}(t.success)},t.NOTIFICATION_TYPE=void 0;var i=a(r(70417)),n=r(35773),s=a(r(45521)),o=a(r(48514)),l=r(29020),d=Object.freeze({CHANGE:"change",SIDE_LIST_CHANGE:"sideListChange",UNKNOWN:"unknown"});t.NOTIFICATION_TYPE=d;var u=new s.default("incomingAboutNotification",(e=>{e.assertTag("notification");var t={stanzaId:e.attrString("id")},r=e.hasChild("set")&&e.child("set");if(r&&!r.hasAttr("hash"))return(0,i.default)({type:d.CHANGE,from:e.attrUserWid("from"),pushname:e.attrString("notify"),content:r.contentString(),ts:e.attrTime("t")},t);var a=d.UNKNOWN;return r&&r.hasAttr("hash")&&(a=d.SIDE_LIST_CHANGE),(0,i.default)({type:a,from:e.attrString("from")},t)}))},77723:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.getAndUpdateStatus=E,t.default=function(){return y.apply(this,arguments)};var i=a(r(52954)),n=a(r(70417)),s=r(35773),o=r(81600),l=r(7017),d=r(66239),u=a(r(20468)),c=a(r(45521)),p=a(r(48514)),h=r(29020),f=a(r(94757)),_=a(r(33640)),m=r(85348),g=new c.default("incomingAccountSyncNotification",(e=>{e.assertTag("notification");var t,r,a,i,s={stanzaId:e.attrString("id"),ts:e.attrTime("t"),from:e.attrUserWid("from")};if(e.hasChild("status")){var l;null===(l=e.getFirstChild())||void 0===l||l.assertTag("status");var d=e.getFirstChild(),u=(null==d?void 0:d.hasAttr("action"))?null==d?void 0:d.attrString("action"):void 0;return(0,n.default)({type:o.ACCOUNT_SYNC_TYPE.STATUS,action:u},s)}if(e.hasChild("privacy"))return null===(t=e.getFirstChild())||void 0===t||t.assertTag("privacy"),(0,n.default)({type:o.ACCOUNT_SYNC_TYPE.PRIVACY},s);if(e.hasChild("devices"))return null===(r=e.getFirstChild())||void 0===r||r.assertTag("devices"),(0,n.default)({type:o.ACCOUNT_SYNC_TYPE.DEVICES},s);if(e.hasChild("blocklist"))return null===(a=e.getFirstChild())||void 0===a||a.assertTag("blocklist"),(0,n.default)({type:o.ACCOUNT_SYNC_TYPE.BLOCKLIST},s);if(e.hasChild("picture"))return null===(i=e.getFirstChild())||void 0===i||i.assertTag("picture"),(0,n.default)({type:o.ACCOUNT_SYNC_TYPE.PICTURE},s);throw new Error("notification type not supported")})),v=new c.default("statusParser",(e=>{var t,r,a,i;return e.assertAttr("type","result"),{status:null===(t=e.child("status"))||void 0===t||null===(r=t.getFirstChild())||void 0===r?void 0:r.contentString(),t:null===(a=e.child("status"))||void 0===a||null===(i=a.getFirstChild())||void 0===i?void 0:i.attrTime("t")}}));function E(){var e=(0,s.wap)("iq",{xmlns:"status",to:s.S_WHATSAPP_NET,type:"get",id:(0,s.generateId)()},(0,s.wap)("status",null,(0,s.wap)("user",{jid:(0,h.USER_JID)((0,d.assertGetMe)())})));return(0,l.sendIq)(e,v).then((e=>{if(!(null==e?void 0:e.success))return __LOG__(3)`Error in sendIq fetching user status: ${e.errorText}`,Promise.reject(e.errorText);var{status:t}=e.result;t&&(p.default.assertGet((0,d.getMaybeMeUser)()).status=t)}))}function y(){return(y=(0,i.default)((function*(e){var t=g.parse(e);if(t.error)return __LOG__(4,void 0,new Error)`${t.error.toString()} parsing ${e.toString()}`,Promise.reject(t.error);var r=t.success,a=(0,s.wap)("ack",{id:(0,s.CUSTOM_STRING)(r.stanzaId),to:(0,h.JID)(r.from),class:"notification",type:"status"});switch(r.type){case o.ACCOUNT_SYNC_TYPE.STATUS:yield E();break;case o.ACCOUNT_SYNC_TYPE.DEVICES:if(u.default.supportsFeature(u.default.F.MD_BACKEND)){if(!_.default.isResumeFromRestartComplete())return f.default.addOfflinePendingDevice(r.from.toString(),a),"NO_ACK";if(_.default.isResumeOnSocketDisconnectInProgress())return yield(0,m.addUserToPendingDeviceSync)([r.from.toString()]),a}yield(0,o.getDevices)("notification");break;case o.ACCOUNT_SYNC_TYPE.PICTURE:yield(0,o.getAndUpdateProfilePicture)();break;case o.ACCOUNT_SYNC_TYPE.PRIVACY:(0,o.updatePrivacySettings)();break;case o.ACCOUNT_SYNC_TYPE.BLOCKLIST:(0,o.updateBlocklist)();break;default:__LOG__(2)`account sync notification of type ${r.type} not supported`}return a}))).apply(this,arguments)}},50402:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.handleVerifiedBusinessNameNotificationHash=function(){return S.apply(this,arguments)},t.handleVerifiedBusinessNameNotificationContact=function(){return T.apply(this,arguments)};var i=a(r(52954)),n=r(35773),s=r(7017),o=a(r(23045)),l=a(r(43805)),d=a(r(22984)),u=r(97282),c=a(r(45521)),p=r(92166),h=r(23123),f=r(12409),_=a(r(55371)),m=r(29020);function g(e,t,r,a,i,n,s){return(0,f.createOrUpdateVerifiedBusinessName)(e,t,r,parseInt(i||"0",10),a,n,s)}function v(e){return(0,p.getStorage)().lock(["verified-business-name"],(([t])=>{var r=[g(t,e.wid,e.level,e.verifiedName,e.serial,e.isApi,e.privacyMode)];return Promise.all(r)})).then((()=>{var t=[],r=l.default.get(e.wid);return null!=r&&t.push((0,d.default)(e.wid,{verifiedName:r.verifiedName,isVerifiedHigh:r.verifiedLevel===o.default.VERIFIED_LEVEL.HIGH,isBusiness:r.isBusiness,isEnterprise:r.isEnterprise,privacyMode:r.privacyMode},{verifiedName:e.verifiedName,isVerifiedHigh:"high"===e.level,isBusiness:!0,isEnterprise:e.isApi,privacyMode:e.privacyMode})),t.push(function(e,t,r,a,i){var n=l.default.get(e);return null!=n&&(0,h.updateContactBusinessProperties)([{id:e,name:r,level:t,isApi:a,privacyMode:i}],[n]),Promise.resolve()}(e.wid,e.level,e.verifiedName,e.isApi,e.privacyMode)),Promise.all(t).then((()=>{}))}))}var E=new c.default("verifiedNameParser",(e=>(0,_.default)(e.child("verified_name"))));function y(e){var t=(0,n.wap)("iq",{to:n.S_WHATSAPP_NET,type:"get",xmlns:"w:biz",id:(0,n.generateId)()},(0,n.wap)("verified_name",{jid:(0,m.DEVICE_JID)(e)}));return(0,s.sendIq)(t,E).then((e=>{if(!e.success){if(404===e.errorCode)return void __LOG__(3)`verified name notification not found`;throw new Error("Could not send IQ in retrieveBusinessDetails")}return e.result}))}function S(){return(S=(0,i.default)((function*(e){if("verified_name_hash"!==e.type)throw Error("Invalid notification type");var t=l.default.resolveWidsFromHash(e.hash);if(!t)return!1;var r=yield Promise.all(t.map((e=>y(e).then((t=>({wid:e,verifiedName:t}))))));return r.length&&(yield Promise.all(r.map((({wid:t,verifiedName:r})=>{if(r){var{name:a,level:i,serial:n,isApi:s,privacyMode:o}=r;return v({wid:t,verifiedName:a,level:i,stanzaId:e.stanzaId,ts:e.ts,serial:n,isApi:s,privacyMode:o})}if(void 0===r)return(0,u.handleBusinessRemoval)(t,e.stanzaId,e.ts)})))),!0}))).apply(this,arguments)}function T(){return(T=(0,i.default)((function*({jid:e,stanzaId:t,ts:r,verifiedName:a}){var i,{serial:n="",level:s,isApi:o,privacyMode:d}=a,u=a.name;if(!u)if(null!=(null===(i=l.default.get(e))||void 0===i?void 0:i.verifiedName)){var c;u=(null===(c=l.default.get(e))||void 0===c?void 0:c.verifiedName)||""}else{var p=yield y(e);if(!p)return;u=p.name}return v({verifiedName:u,level:s,stanzaId:t,ts:r,wid:e,serial:n,isApi:o,privacyMode:d})}))).apply(this,arguments)}},96964:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.handleBusinessNotification=function(e){__LOG__(2)`business notification received, node: ${e}`;var t=h.parse(e);if(t.error)return __LOG__(4,void 0,new Error)`${t.error.toString()} parsing ${e.toString()}`,Promise.reject(t.error);var r=t.success;switch(r.type){case"verified_name_hash":return(0,o.handleVerifiedBusinessNameNotificationHash)(r).then((e=>f(r.stanzaId,r.from,!e)));case"verified_name_jid":return(0,o.handleVerifiedBusinessNameNotificationContact)(r).then((()=>f(r.stanzaId,r.from,!1)));case"remove_hash":return(0,d.handleBusinessRemovalNotificationHash)(r).then((e=>f(r.stanzaId,r.from,!e)));case"remove_jid":return(0,d.handleBusinessRemovalNotificationContact)(r).then((()=>f(r.stanzaId,r.from,!1)));case"profile":return(0,l.handleBusinessProfile)(r),Promise.resolve(f(r.stanzaId,r.from,!1));case"profile_hash":return(0,l.handleBusinessProfileHash)(r).then((e=>f(r.stanzaId,r.from,!e)));default:return Promise.resolve(f(r.stanzaId,r.from,!1))}};var i=a(r(70417)),n=r(35773),s=a(r(83170)),o=r(50402),l=r(30644),d=r(97282),u=a(r(45521)),c=a(r(55371)),p=r(29020),h=new u.default("businessNotificationParser",(e=>{e.assertTag("notification");var t,r={stanzaId:e.attrString("id"),from:e.attrChatWid("from"),ts:e.attrTime("t")};if(e.hasChild("remove"))return(t=e.child("remove")).hasAttr("jid")?(0,i.default)({type:"remove_jid",jid:t.attrChatWid("jid")},r):(0,i.default)({type:"remove_hash",hash:t.attrString("hash")},r);if(e.hasChild("verified_name"))return(t=e.child("verified_name")).hasAttr("jid")?(0,i.default)({type:"verified_name_jid",jid:t.attrChatWid("jid"),verifiedName:(0,c.default)(t)},r):(0,i.default)({type:"verified_name_hash",hash:t.attrString("hash")},r);if(e.hasChild("profile")){var a=e.child("profile"),n=a.maybeAttrString("hash");if(n)return(0,i.default)({type:"profile_hash",hash:n},r);var o=(0,s.default)(a);return(0,i.default)({type:"profile",profile:o},r)}return e.throw("Expected child type to be one of: remove | verified_name | profile")}));function f(e,t,r){return r?(0,n.wap)("ack",{id:(0,n.CUSTOM_STRING)(e),to:(0,p.JID)(t),class:"notification",type:"business"},(0,n.wap)("user",{side_list:"out"})):(0,n.wap)("ack",{id:(0,n.CUSTOM_STRING)(e),to:(0,p.JID)(t),class:"notification",type:"business"})}},30644:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.handleBusinessProfileHash=t.handleBusinessProfile=void 0;var i=a(r(52954)),n=a(r(65017)),s=r(64001),o=a(r(43805));t.handleBusinessProfile=({from:e,profile:t})=>{var r=Boolean(n.default.getValid(e)),a=(0,s.parseBusinessProfile)({id:e,profile:t,queryCatalog:!1}),i=n.default.gaddUp(a);r||(i.stale=!0)};var l=function(){var e=(0,i.default)((function*({from:e,hash:t}){var r=o.default.resolveWidsFromHash(t);return!!r&&(yield Promise.all(r.map(function(){var t=(0,i.default)((function*(t){var r=Boolean(n.default.getValid(e)),a=yield n.default.update(t),i=Array.isArray(a)?a:[a];for(var s of i)r||(s.stale=!0)}));return function(){return t.apply(this,arguments)}}())),!0)}));return function(){return e.apply(this,arguments)}}();t.handleBusinessProfileHash=l},97282:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.handleBusinessRemoval=p,t.handleBusinessRemovalNotificationHash=function(){return h.apply(this,arguments)},t.handleBusinessRemovalNotificationContact=function(){return f.apply(this,arguments)};var i=a(r(52954)),n=a(r(23045)),s=a(r(43805)),o=a(r(22984)),l=r(92166);function d(e,t){return e.get(t.user).then((r=>r?(r.isBusiness=!1,r.verifiedLevel=0,r.verifiedName="",e.merge(t.user,r)):Promise.resolve()))}function u(e,t){return e.remove(t.user)}var c={isVerifiedHigh:!1,isBusiness:!1,isEnterprise:!1};function p(e){var t=s.default.get(e),r=t?{verifiedName:t.verifiedName,isVerifiedHigh:t.verifiedLevel===n.default.VERIFIED_LEVEL.HIGH,isBusiness:t.isBusiness,isEnterprise:t.isEnterprise,privacyMode:t.privacyMode}:c;return(0,l.getStorage)().lock(["contact","verified-business-name"],(([t,r])=>Promise.all([d(t,e),u(r,e)]))).then((()=>{var t=s.default.get(e);return null!=t&&t.set({isBusiness:!1,verifiedLevel:null,verifiedName:null}),(0,o.default)(e,r,c)})).then((()=>{}))}function h(){return(h=(0,i.default)((function*(e){if("remove_hash"!==e.type)throw Error("Invalid notification type");var t=s.default.resolveWidsFromHash(e.hash);return!!t&&(yield Promise.all(t.map((t=>p(t,e.stanzaId,e.ts)))),!0)}))).apply(this,arguments)}function f(){return(f=(0,i.default)((function*(e){if("remove_jid"!==e.type)throw Error("Invalid notification type");yield p(e.jid,e.stanzaId,e.ts)}))).apply(this,arguments)}},3202:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=n.parse(e);if(t.error)return __LOG__(4,void 0,new Error)`${t.error.toString()} parsing ${e.toString()}`,Promise.reject(t.error);return(0,i.default)(t.success)};var i=a(r(36900)),n=new(a(r(45521)).default)("incomingChatStateParser",(e=>{var t;if(e.assertTag("chatstate"),e.hasChild("paused"))t="paused";else{if(!e.hasChild("composing"))return e.throw("Expected child of type paused or composing");t=e.child("composing").hasAttr("media")?"recording":"composing"}return{id:e.attrChatWid("from"),type:t,participant:e.hasAttr("participant")?e.attrUserWid("participant"):void 0}}))},82458:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return C.apply(this,arguments)};var i=a(r(52954)),n=a(r(70417)),s=r(35773),o=a(r(85030)),l=r(66239),d=r(62711),u=a(r(83746)),c=a(r(21830)),p=a(r(45521)),h=a(r(93997)),f=r(56160),_=r(30229),m=a(r(2661)),g=r(88956),v=a(r(48514)),E=r(25054),y=r(23443),S=new p.default("incomingContactsNotification",(e=>{e.assertTag("notification");var t=e.attrString("id"),r={from:e.attrString("from"),ts:e.attrTime("t"),rawTs:e.attrString("t"),stanzaId:t};if(e.hasChild("update")){var a=e.child("update");return a.hasAttr("jid")?(0,n.default)({type:"update",jid:a.attrUserWid("jid")},r):(0,n.default)({type:"empty",jid:null},r)}if(e.hasChild("add")){var i=e.child("add");return(0,n.default)({type:"add",hash:i.hasContent()?i.contentBytes():null,jid:null},r)}if(e.hasChild("remove")){var s=e.child("remove");return(0,n.default)({type:"remove",jid:s.attrUserWid("jid")},r)}if(e.hasChild("modify")){var o=e.child("modify");return(0,n.default)({type:"modify",jid:o.attrUserWid("new"),oldJid:o.attrUserWid("old")},r)}if(e.hasChild("sync")){var l=e.child("sync");return(0,n.default)({type:"sync",after:l.attrTime("after"),jid:null},r)}return __LOG__(3)`Unexpected "contacts" notification`,(0,n.default)({type:"empty",jid:null},r)}));function T(e,t){var r=function(e,t){if("modify"!==t.type)throw new Error("Error: genContactChangeNotificationMsg invalid type");var r=(0,l.getMeUser)(),a=(0,c.default)(t.oldJid,"notification.oldJid"),i=(0,c.default)(t.jid,"notification.jid");return{id:new u.default({remote:e,fromMe:!1,id:(0,m.default)()}),from:e,subtype:"change_number",t:t.ts,to:r,type:"notification_template",templateParams:[a,i]}}(e,t);return(0,d.handleSingleMsgMD)(e,r)}function A(){return b.apply(this,arguments)}function b(){return(b=(0,i.default)((function*(e){if(e.oldJid){var t=e.oldJid,r=e.jid,a=[];o.default.get(t)&&a.push({id:t.toString(),changeNumberNewJid:r.toString(),changeNumberOldJid:void 0}),o.default.get(r)&&a.push({id:r.toString(),changeNumberNewJid:void 0,changeNumberOldJid:t.toString()}),(0,y.getTable)().bulkCreateOrMerge(a).then((()=>{a.forEach((e=>{var t=o.default.get(e.id);t&&(t.changeNumberNewJid=e.changeNumberNewJid?(0,E.createWid)(e.changeNumberNewJid):void 0,t.changeNumberOldJid=e.changeNumberOldJid?(0,E.createWid)(e.changeNumberOldJid):void 0)}))})),yield Promise.all([T(t,e),T(r,e)])}else __LOG__(2)`notification.oldJid is null`;return Promise.resolve()}))).apply(this,arguments)}function C(){return(C=(0,i.default)((function*(e){var t=S.parse(e);if(t.error)return __LOG__(4,void 0,new Error)`${t.error.toString()} parsing ${e.toString()}`,Promise.reject(t.error);var r=t.success,a=r.jid;switch(r.type){case"update":if(!a)return __LOG__(3)`handleContactsNotification: an update command does not include jid`,d(r);var i=h.default.get(a);i&&i.reset();var n=Promise.resolve(),o=v.default.get(a);o&&(o.set({status:""}),n=(0,g.getStatus)(a).then((e=>{o.set({status:e.status})})));var l=(0,_.changeProfilePicThumb)(r.jid,f.PROFILE_PIC_COMMAND.REMOVE);return Promise.all([l,n]).then((()=>d(r)));case"modify":return yield A(r),d(r);case"sync":return d(r);default:return __LOG__(2)`handleContactsNotification: unhandled notification of type ${r.type}`,d(r)}function d(e,t){return(0,s.wap)("ack",{id:(0,s.CUSTOM_STRING)(e.stanzaId),to:(0,s.CUSTOM_STRING)(e.from),class:"notification",type:"contacts"},t)}}))).apply(this,arguments)}},69115:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return v.apply(this,arguments)},t.DEVICE_NOTIFICATION_TYPES=void 0;var i=a(r(52954)),n=r(35773),s=r(47882),o=a(r(20468)),l=r(24581),d=a(r(45521)),u=a(r(61506)),c=r(29020),p=r(25054),h=a(r(94757)),f=a(r(33640)),_=r(85348),m={add:"add",remove:"remove",update:"update"};t.DEVICE_NOTIFICATION_TYPES=m;var g=new d.default("incomingDevicesNotification",(e=>{e.assertTag("notification"),e.assertTag("notification"),e.assertAttr("type","devices");var t,r,a,i=[];if(e.hasChild("remove"))r=m.remove,t=e.child("remove");else if(e.hasChild("add"))r=m.add,t=e.child("add");else{if(!e.hasChild("update"))throw __LOG__(3)`Unknown Devices Notification: Devices notification without "remove" and "add" nodes`,new Error("Failed to parse devices notification");r=m.update,t=e.child("update")}if(r===m.add||r===m.remove){var n=t.maybeChild("key-index-list");if(!n)throw new Error("key index node is required to handle device add or remove notification");var s=n.attrTime("ts");if(r===m.remove&&!s)throw new Error("timestamp is required to handle device remove notification");a={ts:s,signedKeyIndexBytes:r===m.add?n.contentBytes():null};var o=t.maybeChild("device"),l=null==o?void 0:o.attrWid("jid").device;if(!o||null==l)throw new Error("device node or device id is null");i=[{id:l,keyIndex:o.hasAttr("key-index")?o.attrInt("key-index"):null}]}return{type:r,stanzaId:e.attrString("id"),hash:t.attrString(r===m.update?"hash":"device_hash"),user:e.attrUserWid("from"),deviceList:i,keyIndex:a}}));function v(){return(v=(0,i.default)((function*(e){var t=g.parse(e);if(t.error)return __LOG__(4,void 0,new Error)`${t.error.toString()} parsing ${e.toString()}`,Promise.reject(t.error);var r=t.success,a=r.user,i=(0,n.wap)("ack",{to:(0,c.USER_JID)(r.user),id:(0,n.CUSTOM_STRING)(r.stanzaId),class:"notification"});if(o.default.supportsFeature(o.default.F.MD_BACKEND)){if(!f.default.isResumeFromRestartComplete())return h.default.addOfflinePendingDevice(a.toString(),i),"NO_ACK";if(f.default.isResumeOnSocketDisconnectInProgress())return yield(0,_.addUserToPendingDeviceSync)([a.toString()]),i}var d={wid:a,devices:{deviceList:r.deviceList,keyIndex:r.keyIndex},type:r.type};if(r.type===m.add){try{yield(0,l.handleADVDeviceUpdate)(d)}catch(e){__LOG__(3)`handleDevicesNotification - add error: ${e}`}return i}if(r.type===m.remove){try{var v;yield(0,l.handleADVDeviceUpdate)(d);var E=(null===(v=r.deviceList)||void 0===v?void 0:v.map((e=>e.id)))||[];yield Promise.all(E.map((e=>{var t=(0,p.createDeviceWidFromUserAndDevice)(a.user,e);u.default.notifyDeviceIdentityChangedOrDeleted(t,!0)})))}catch(e){__LOG__(3)`handleDevicesNotification - remove error: ${e}`}return i}try{yield(0,s.syncDeviceList)([a],"notification",r.hash)}catch(e){__LOG__(3)`handleDevicesNotification - update error: ${e}`}return i}))).apply(this,arguments)}},62673:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=s.parse(e);if(t.error)return __LOG__(4,void 0,new Error)`${t.error.toString()} parsing ${e.toString()}`,Promise.reject(t.error);var r=t.success,a=(0,i.wap)("ack",{to:i.S_WHATSAPP_NET,id:(0,i.CUSTOM_STRING)(r.stanzaId),class:"notification"});return(0,n.digestKey)().then((()=>a))};var i=r(35773),n=r(83756),s=new(a(r(45521)).default)("digestKeyParser",(e=>(e.assertTag("notification"),e.assertAttr("type","encrypt"),e.assertFromServer(),e.child("digest").assertTag("digest"),{stanzaId:e.attrString("id")})))},5377:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return h.apply(this,arguments)};var i=a(r(52954)),n=a(r(13277)),s=r(7017),o=a(r(23045)),l=a(r(45521)),d=r(33753),u=a(r(3472)),c=a(r(15934)),p=new l.default("failureParser",(e=>(e.assertTag("failure"),{reason:e.attrInt("reason",400,599),location:e.attrString("location"),code:e.hasAttr("code")?e.attrInt("code"):null,expire:e.hasAttr("expire")?e.attrInt("expire"):null})));function h(){return(h=(0,i.default)((function*(e){var t=p.parse(e);if(t.error)return __LOG__(4,void 0,new Error)`${t.error.toString()} parsing ${e.toString()}`,Promise.reject(t.error);switch(t.success.reason){case 401:case 403:case 406:__LOG__(2)`received failure stanza, reason: ${t.success.reason}, logging out`,yield c.default.clearCredentialsAndStoredData(),n.default.logout();break;case 405:case 409:__LOG__(2)`Client too old or bad user agent, attempting to update the app`;var r=o.default.VERSION_STR.replace(/\.[di]$/,"");"web"===d.PLATFORMS[o.default.WAM_PLATFORM]?u.default.update(r,!1,0):u.default.update(void 0,!1,0,!1),(0,s.stopComms)();break;case 402:var{code:a,expire:i}=t.success;if(null==a||null==i)throw __LOG__(4,void 0,new Error)`Incorrect temporary ban data ${a} ${i}`,new Error("handleFailure: wrong temp ban data");n.default.onTemporaryBan({banned:!0,code:a,expire:i});break;case 400:case 500:case 501:__LOG__(3)`handleFailure: got failure code ${t.success.reason}`;break;default:return __LOG__(3)`failure reason ${t.success.reason} not implemented yet`,Promise.reject(`failure reason ${t.success.reason} not implemented yet`)}}))).apply(this,arguments)}},5863:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.doesGroupExistInStorage=T,t.default=function(e){var t=S.parse(e);if(t.error)return __LOG__(4,void 0,new Error)`${t.error.toString()} parsing ${e.toString()}`,Promise.reject(t.error);var r=t.success,{chatId:a,author:i,ts:o,pushname:l,externalId:d,actions:u,offline:p}=r,h=!!p&&!E.default.isResumeFromRestartComplete(),f=(0,n.default)({chatId:a,author:i,ts:o,externalId:d},l?{pushname:l}:null);return(0,c.onMsgProcessingThread)(a.toString(),h,(()=>Promise.all(u.map((e=>function(){return b.apply(this,arguments)}(f,e,h)))).then((()=>(0,s.wap)("ack",{to:(0,m.GROUP_JID)(r.chatId),id:(0,s.CUSTOM_STRING)(r.externalId),class:"notification",participant:i?(0,m.JID)(i):s.DROP_ATTR})))))};var i=a(r(52954)),n=a(r(70417)),s=r(35773),o=r(66239),l=r(63726),d=r(6471),u=r(12104),c=r(91253),p=a(r(1730)),h=r(62711),f=a(r(45521)),_=r(1834),m=r(29020),g=r(20226),v=r(23443),E=a(r(33640)),y=Object.freeze({REMOVE:"remove",ADD:"add",DEMOTE:"demote",PROMOTE:"promote",MODIFY:"modify",CREATE:"create",SUBJECT:"subject",DESC:"description",LOCKED:"locked",UNLOCKED:"unlocked",ANNOUNCE:"announcement",NOT_ANNOUNCE:"not_announcement",NO_FREQUENTLY_FORWARDED:"no_frequently_forwarded",FREQUENTLY_FORWARDED_OK:"frequently_forwarded_ok",INVITE:"invite",EPHEMERAL:"ephemeral",NOT_EPHEMERAL:"not_ephemeral"});var S=new f.default("groupNotificationParser",(e=>{e.assertTag("notification"),e.hasAttr("to")&&e.assertAttrIsMe("to");var t=e.attrGroupWid("from"),r=e.hasAttr("participant")?e.attrUserWid("participant"):null,a=e.attrTime("t");function i(e){return{participants:e.mapChildrenWithTag("participant",(e=>e.attrUserWid("jid"))),prevVersion:e.hasAttr("prev_v_id")?e.attrInt("prev_v_id"):void 0,version:e.hasAttr("v_id")?e.attrInt("v_id"):void 0}}var s=e.mapChildren((e=>{var t=e.tag();switch(t){case y.CREATE:return function(e){var t=e.child("group"),r=t.mapChildrenWithTag("participant",(e=>{var t=e.attrEnumOrDefault("type",_.GROUP_PARTICIPANT_TYPES,"participant");return{id:e.attrUserWid("jid"),isSuperAdmin:t===_.GROUP_PARTICIPANT_TYPES.superadmin,isAdmin:t===_.GROUP_PARTICIPANT_TYPES.admin||t===_.GROUP_PARTICIPANT_TYPES.superadmin}})),a=function(e){if(e.hasChild("description")){var t=e.child("description");if(t.hasChild("body")){var r=t.child("body");if(r.hasContent())return{content:r.contentString(),id:t.attrString("id")}}}return null}(t),i=function(e){if(e.hasChild("ephemeral")){var t=e.child("ephemeral");if(t.hasAttr("expiration"))return{ephemeralDuration:t.attrInt("expiration")}}return null}(t),n={subject:t.attrString("subject"),restrict:t.hasChild("locked"),announce:t.hasChild("announcement"),noFrequentlyForwarded:t.hasChild("no_frequently_forwarded"),ephemeralDuration:i?i.ephemeralDuration:void 0,owner:t.hasAttr("creator")?t.attrUserWid("creator"):void 0,creation:t.attrTime("creation"),participants:r,desc:a?a.content:void 0,descId:a?a.id:void 0,subjectOwner:t.hasAttr("s_o")?t.attrUserWid("s_o"):void 0,subjectTime:t.hasAttr("s_t")?t.attrTime("s_t"):void 0,support:t.hasChild("support"),pvId:t.attrInt("p_v_id")};return{action:y.CREATE,isInvite:e.hasAttr("reason")&&"invite"===e.attrString("reason"),groupInfo:n}}(e);case y.ADD:return(0,n.default)((0,n.default)({action:d.GROUP_ACTIONS.ADD},i(e)),{},{isInvite:e.hasAttr("reason")&&"invite"===e.attrString("reason")});case y.REMOVE:return(0,n.default)({action:y.REMOVE},i(e));case y.PROMOTE:return(0,n.default)({action:y.PROMOTE},i(e));case y.DEMOTE:return(0,n.default)({action:y.DEMOTE},i(e));case y.MODIFY:return(0,n.default)({action:d.GROUP_ACTIONS.MODIFY},i(e));case y.SUBJECT:return{action:d.GROUP_ACTIONS.SUBJECT,subject:e.attrString("subject"),s_o:e.hasAttr("s_o")?e.attrUserWid("s_o"):null,s_t:e.hasAttr("s_t")?e.attrTime("s_t"):null};case y.DESC:return e.hasChild("delete")?{action:d.GROUP_ACTIONS.DESC_REMOVE,descId:e.attrString("id")}:{action:d.GROUP_ACTIONS.DESC_ADD,descId:e.attrString("id"),desc:e.hasChild("body")?e.child("body").contentString():null,descTime:a};case y.LOCKED:return{action:d.GROUP_ACTIONS.RESTRICT,value:!0};case y.UNLOCKED:return{action:d.GROUP_ACTIONS.RESTRICT,value:!1};case y.ANNOUNCE:return{action:d.GROUP_ACTIONS.ANNOUNCE,value:!0};case y.NOT_ANNOUNCE:return{action:d.GROUP_ACTIONS.ANNOUNCE,value:!1};case y.NO_FREQUENTLY_FORWARDED:return{action:d.GROUP_ACTIONS.NO_FORWARD,value:!0};case y.FREQUENTLY_FORWARDED_OK:return{action:d.GROUP_ACTIONS.NO_FORWARD,value:!1};case y.INVITE:return{action:d.GROUP_ACTIONS.INVITE_CODE,code:e.attrString("code")};case y.EPHEMERAL:return{action:d.GROUP_ACTIONS.EPHEMERAL,duration:e.attrInt("expiration")};case y.NOT_EPHEMERAL:return{action:d.GROUP_ACTIONS.EPHEMERAL,duration:0};default:throw new Error(`Unrecognized group action ${t}`)}}));return{externalId:e.attrString("id"),chatId:t,author:r,ts:e.attrTime("t"),pushname:e.hasAttr("notify")?e.attrString("notify"):null,offline:e.hasAttr("offline")?e.attrString("offline"):null,actions:s}}));function T(){return A.apply(this,arguments)}function A(){return(A=(0,i.default)((function*(e){var[t,r]=yield Promise.all([(0,g.getTable)().get(e.toString()),(0,v.getTable)().get(e.toString())]);return!!t||!!r&&!!r.t}))).apply(this,arguments)}function b(){return(b=(0,i.default)((function*(e,t,r=!1){if(t){__LOG__(2)`handle action ${t.action}`;var a=[];try{if(t.action===y.CREATE){var i=(0,n.default)((0,n.default)({},t.groupInfo),{},{id:e.chatId}),s=yield T(i.id);__LOG__(2,void 0,void 0,void 0,["groups"])`group id ${i.id} exists in storage = ${s}`,yield(0,u.handleGroupCreation)(e,i),s||a.push((0,l.genGroupCreationMsg)(e,i));var c=(0,o.getMaybeMeUser)();if(!c.equals(e.author)){var f={action:d.GROUP_ACTIONS.ADD,version:i.pvId,participants:[c],isInvite:t.isInvite};yield(0,u.handleGroupActionMD)(e,f),a.push((0,l.genGroupNotificationMsg)(e,f));var{ephemeralDuration:_}=i;e.author&&null!=e.ts&&null!=_&&_>0&&a.push((0,l.genGroupEphemeralSettingMsg)(e.chatId,e.ts,e.author,_))}}else yield(0,u.handleGroupActionMD)(e,t),a.push((0,l.genGroupNotificationMsg)(e,t));r?p.default.addOfflineMessage(a.map((e=>({msg:e})))):yield Promise.all(a.map((e=>(0,h.handleSingleMsgMD)(e.from,e))))}catch(e){__LOG__(3)`handleGroupNotification: failed with ${e}`}}}))).apply(this,arguments)}},84558:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return x.apply(this,arguments)},t.handleHistorySyncChunk=B;var n=i(r(70417)),s=i(r(52954)),o=r(9557),l=r(25364),d=r(49244),u=r(88911),c=r(95334),p=i(r(45026)),h=i(r(78483)),f=a(r(25064)),_=r(23443),m=i(r(84119)),g=i(r(13277)),v=r(830),E=i(r(23045)),y=r(8950),S=i(r(26082)),T=r(66239),A=r(53353),b=r(38365),C=r(22697),P=r(13185),O=r(62711),w=i(r(83746)),M=r(63191),I=i(r(21830)),R=r(44984),D=r(19173),N=i(r(94407)),L=r(25054),k=r(38027),U=i(r(43805)),G=i(r(84161)),F=r(62820);function x(){return(x=(0,s.default)((function*(e,t,r){if(e){var{downloadOptions:a}=e;if(a){var i=!!e.historySyncNotification.originalMessageId,s=i?e.historySyncNotification.originalMessageId:r,o={msgKey:new w.default({remote:t,fromMe:!0,id:s}).toString(),processed:0,downloadOptions:a,isReupload:1,historySyncStepStartedTs:(0,c.unixTimeMs)(),reuploadPending:!1,historySyncPayloadSize:e.historySyncNotification.fileLength};i||(o.syncType=e.historySyncNotification.syncType,o.chunkOrder=e.historySyncNotification.chunkOrder||0,o.isReupload=0);var l=o;switch(l.syncType){case C.HistorySyncHistorySyncType.INITIAL_BOOTSTRAP:case C.HistorySyncHistorySyncType.INITIAL_STATUS_V3:B(l);break;case C.HistorySyncHistorySyncType.PUSH_NAME:return yield(0,b.enqueueNotification)((0,n.default)((0,n.default)({},l),{},{downloadOptions:(0,n.default)({},l.downloadOptions)}),!0),void B(l);default:yield(0,b.enqueueNotification)(l)}h.default.continueProgressiveHistorySyncProcessing()}}}))).apply(this,arguments)}function B(){return Y.apply(this,arguments)}function Y(){return(Y=(0,s.default)((function*(e){var t=e.syncType===C.HistorySyncHistorySyncType.INITIAL_BOOTSTRAP?G.default.MD_BOOTSTRAP_PAYLOAD_TYPE.CRITICAL:G.default.MD_BOOTSTRAP_PAYLOAD_TYPE.NON_CRITICAL,r=new G.default.MdBootstrapHistoryDataDownloaded({mdBootstrapPayloadType:t,mdBootstrapPayloadSize:e.historySyncPayloadSize});r.mdSessionId=yield f.default.getMdSessionId();var a=yield f.default.getStorageEstimation();a.mdStorageQuotaBytes!==f.STORAGE_QUOTA_UNAVAILABLE&&(r.mdStorageQuotaUsedBytes=a.mdStorageQuotaUsedBytes,r.mdStorageQuotaBytes=a.mdStorageQuotaBytes);var i=null;try{i=yield S.default.downloadAndDecrypt((0,n.default)({signal:(new p.default).signal},e.downloadOptions))}catch(t){__LOG__(3)`history sync download failed`;var _=w.default.fromString(e.msgKey),A=new Map;return A.set(_.remote,[_.id]),W(r,e.historySyncStepStartedTs,!1),(0,v.sendAggregateReceipts)(_.remote,v.RECEIPT_TYPE.SERVER_ERROR,Date.now().toString(),A,void 0,v.RECEIPT_MSG_TYPE.PEER),void(yield(0,b.markChunkForReuploadPending)(e.msgKey))}r.mdBootstrapStepResult=G.default.MD_BOOTSTRAP_STEP_RESULT.SUCCESS;var N=new d.Binary(i);yield new Promise((e=>setTimeout(e,0)));var x=yield(0,u.inflate)(N.readByteArray());yield new Promise((e=>setTimeout(e,0)));var B=(0,o.decodeProto)(C.HistorySyncSpec,x),Y=new G.default.MdBootstrapDataApplied({mdBootstrapPayloadType:t,mdBootstrapSource:G.default.MD_BOOTSTRAP_SOURCE.HISTORY});if(Y.mdSessionId=yield f.default.getMdSessionId(),e.syncType===C.HistorySyncHistorySyncType.INITIAL_STATUS_V3&&B.statusV3Messages&&B.statusV3Messages.length>0?(r.mdBootstrapMessagesCount=B.statusV3Messages.length,W(r,e.historySyncStepStartedTs,!0),yield Promise.all(B.statusV3Messages.map(function(){var e=(0,s.default)((function*(e){if("0@s.whatsapp.net"===e.participant)return Promise.resolve();var t={type:R.MESSAGE_TYPE.OTHER_STATUS,externalId:(0,I.default)(e.key.id,"msg.key.id"),ts:(0,c.castToUnixTime)(parseInt(e.messageTimestamp,10)),edit:-1,isHsm:!1,count:null,chat:(0,L.createWid)(E.default.STATUS_WID),author:!0===e.key.fromMe?(0,T.getMeUser)():(0,L.createWid)((0,I.default)(e.participant,"msg.participant")),pushname:null,isDirect:!1},r=yield(0,D.parseMessage)(t,"skmsg",(0,I.default)(e.message,"msg.message"),void 0),a=r.renderableMsgs&&r.renderableMsgs;if(!a||1!==a.length)return Promise.resolve();var i=a[0];return(0,O.handleSingleMsgMD)(i.id.remote,i,!1)}));return function(){return e.apply(this,arguments)}}())),Y.mdTimestamp=(0,c.unixTimeMs)(),Y.commit()):e.syncType!==C.HistorySyncHistorySyncType.PUSH_NAME&&(B.conversations=B.conversations.reduce(((e,t)=>{var r=null;try{r=(0,L.createWid)(t.id)}catch(e){__LOG__(3)`history_sync_notification_handler: invalid wid`}return r?e.concat(t):e}),[])),e.syncType===C.HistorySyncHistorySyncType.INITIAL_BOOTSTRAP){var j={},V=(0,T.assertGetMe)(),$=(0,L.toUserWid)(V),q=V.getDeviceId(),z={},J=[],Q=0;B.conversations.forEach((t=>{var r,a;Q+=t.messages.length;var i=[];if(t.messages.forEach(((r,a)=>{a===t.messages.length-1&&(j[t.id]=r.msgOrderId),i.push(H(e,r.message))})),i=i.filter(Boolean).reverse(),!(0,L.createWid)(t.id).isStatusV3()){var n=(0,y.genDeviceNotificationMsg)((0,L.createWid)(t.id),$,[q],[]);i.push(n)}var s={t:(0,l.maybeNumberOrThrowIfTooLarge)(null!==(r=t.conversationTimestamp)&&void 0!==r?r:t.lastMsgTimestamp),id:(0,L.createWid)(t.id),unreadCount:t.unreadCount,ephemeralDuration:t.ephemeralExpiration,ephemeralSettingTimestamp:t.ephemeralSettingTimestamp,endOfHistoryTransferType:null!==(a=t.endOfHistoryTransferType)&&void 0!==a?a:F.ConversationEndOfHistoryTransferModelPropType.INCOMPLETE,name:t.name,notSpam:t.notSpam,pendingInitialLoading:!1};J.push(s),z[t.id]={chatInfo:s,msgs:i}})),r.mdBootstrapMessagesCount=Q,r.mdBootstrapChatsCount=B.conversations.length,W(r,e.historySyncStepStartedTs,!0),h.default.markInitialHistorySyncCountDebugStats(Q,J.length),yield(0,m.default)([{cmd:"preempt",response:J,binarySize:10}])||Promise.resolve(),yield(0,O.handleInitialSyncMsgs)(z),Y.mdTimestamp=(0,c.unixTimeMs)(),Y.commit(),(0,P.setHistoryInitialSyncBoundry)(j)}else if(e.syncType===C.HistorySyncHistorySyncType.PUSH_NAME){W(r,e.historySyncStepStartedTs,!0);var X=B.pushnames.map((e=>({id:e.id||"",pushname:e.pushname||""})));yield(0,k.getContactTable)().bulkCreateOrMerge(X);var Z=B.pushnames.map((e=>{var t=(0,L.createWid)(e.id||""),r=U.default.get(t);return{id:t,pushname:e.pushname||"",type:(null==r?void 0:r.type)||"out",name:null==r?void 0:r.name}}));U.default.add(Z,{merge:!0}),Y.mdTimestamp=(0,c.unixTimeMs)(),Y.commit()}else if(e.syncType!==C.HistorySyncHistorySyncType.INITIAL_STATUS_V3){yield new Promise((e=>setTimeout(e,0)));var ee=[],te=new Set,re=(0,P.getHistoryInitialSyncBoundry)(),ae=0;B.conversations.forEach((t=>{ae+=t.messages.length;var r=re&&re[t.id];t.messages.forEach((a=>{var i=(0,l.maybeNumberOrThrowIfTooLarge)(a.msgOrderId);if(!(null!=r&&null!=i&&i>=r)){te.add(t.id);var n=H(e,a.message);n&&ee.push(n)}}))})),r.mdBootstrapMessagesCount=ae,r.mdBootstrapChatsCount=B.conversations.length,W(r,e.historySyncStepStartedTs,!0),0!==ee.length&&(yield(0,O.handleProgressiveHistorySyncMsgs)(ee,Array.from(te))),B.conversations.forEach((e=>{var t=e.endOfHistoryTransferType;if(null!=t)return K((0,L.createWid)(e.id),t)})),Y.mdTimestamp=(0,c.unixTimeMs)(),Y.commit()}var ie,ne=w.default.fromString(e.msgKey),se=new Map;se.set(ne.remote,[ne.id]),(0,v.sendAggregateReceipts)(ne.remote,v.RECEIPT_TYPE.HISTORY_SYNC_COMPLETION,void 0,se),yield(0,b.updateCurrentlyProcessed)(e.msgKey),ie=B.progress,e.syncType===C.HistorySyncHistorySyncType.INITIAL_BOOTSTRAP?((0,M.setInitialHistorySyncComplete)(),(0,M.setHistorySyncStatus)({initialCompleted:!0}),g.default.onInitialChatHistorySynced()):e.syncType===C.HistorySyncHistorySyncType.RECENT&&100===ie?((0,M.setHistorySyncStatus)({recentCompleted:!0}),g.default.onRecentChatHistorySynced()):e.syncType===C.HistorySyncHistorySyncType.FULL&&100===ie&&((0,M.setHistorySyncStatus)({fullCompleted:!0}),g.default.onFullChatHistorySynced())}))).apply(this,arguments)}function K(){return j.apply(this,arguments)}function j(){return(j=(0,s.default)((function*(e,t){var r=t,a=(0,A.getBridge)();yield a.sendAndReceive("chat_collection","add",{things:[{id:e,endOfHistoryTransferType:r}],options:{merge:!0}}),yield(0,_.getTable)().merge(e.toString(),{endOfHistoryTransferType:r})}))).apply(this,arguments)}function W(e,t,r){e.mdTimestamp=(0,c.unixTimeMs)(),e.mdBootstrapStepDuration=(0,c.unixTimeMs)()-t,e.mdBootstrapStepResult=r?G.default.MD_BOOTSTRAP_STEP_RESULT.SUCCESS:G.default.MD_BOOTSTRAP_STEP_RESULT.FAILURE,e.commit()}function H(e,t){var r=null;try{r=N.default.parseWebMessageInfo(t,"after")}catch(e){__LOG__(4,void 0,new Error)`[history sync] parseWebMessageInfo failed with error ${null==e?void 0:e.name} and stack ${null==e?void 0:e.stack}`}return r}},21470:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.handleDirtyBits=function(e){var{supported:t,unsupported:r,protocols:a}=e;__LOG__(2)`handleDirtyBits: handle dirty bits, supported: ${t.map((e=>e.type)).join(",")}, unsupported: ${r.map((e=>e.type)).join(",")}`;var i=[...r,...t];return Promise.all(t.map((e=>{var t=e.type;return t===p.groups?(0,l.queryAndUpdateAllGroupMetadata)():t===p.account_sync?function(e=[]){var t=e;t.length||(t=Object.keys(n.ACCOUNT_SYNC_TYPE).map((e=>n.ACCOUNT_SYNC_TYPE[e])));return Promise.all(t.map((e=>"devices"===e?(0,n.getDevices)("notification"):"picture"===e?(0,n.getAndUpdateProfilePicture)():void("privacy"===e?(0,n.updatePrivacySettings)():"blocklist"===e&&(0,n.updateBlocklist)()))))}(a):t===p.syncd_app_state?(c.default.once(c.APP_STATE_SYNC_COMPLETED,(e=>{var t=e.some((e=>null!=e.patches&&e.patches.length>0||null!=e.snapshot));new u.default.MdAppStateDirtyBits({dirtyBitsFalsePositive:!t}).commit()})),(0,d.markCollectionsForSync)([...o.CollectionName.members()])):void 0}))).then((()=>(0,s.clearDirtyBits)(i)))},t.SUPPORTED_DIRTY_PROTOCOLS=t.SUPPORTED_DIRTY_TYPE=void 0;var n=r(81600),s=r(67280),o=r(17845),l=r(14963),d=r(58970),u=i(r(84161)),c=a(r(13277)),p={groups:"groups",account_sync:"account_sync",syncd_app_state:"syncd_app_state"};t.SUPPORTED_DIRTY_TYPE=p;t.SUPPORTED_DIRTY_PROTOCOLS={devices:"devices",picture:"picture",privacy:"privacy",blocklist:"blocklist"}},72327:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.handleRoutingInfo=function(e){var t=e.domain;if(!t){var r=(0,i.getRoutingInfo)();t=r?r.domain:n.fb}var s=(0,a.bytesToBuffer)(e.edgeRouting);(0,i.setRoutingInfo)({domain:t,edgeRouting:s}),__LOG__(2)`handleInfoBulletin setting and domain: ${t} and edgeRouting:`},t.DOMAINS=void 0;var a=r(61212),i=r(63191),n={fb:"fb",sl:"sl"};t.DOMAINS=n},60431:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=c.parse(e);if(t.error)return __LOG__(4,void 0,new Error)`${t.error.toString()} parsing ${e.toString()}`,Promise.reject(t.error);var r=t.success;if(r){if(r.type===l.INFO_TYPE.DIRTY)return(0,n.handleDirtyBits)(r).then((()=>"NO_ACK"));if(r.type===l.INFO_TYPE.ROUTING)return(0,s.handleRoutingInfo)(r),Promise.resolve("NO_ACK");if(r.type===l.INFO_TYPE.DOWNGRADE)return i.default.downgradeWebclient(),Promise.resolve("NO_ACK");if(r.type===l.INFO_TYPE.OFFLINE)return o.default.setOfflineSessionComplete(r.count),(0,u.reportOfflineNotifications)(),Promise.resolve("NO_ACK");if(r.type===l.INFO_TYPE.OFFLINE_PREVIEW)return o.default.setOfflineMessagePreviewCounter(r.count),Promise.resolve("NO_ACK")}else __LOG__(3)`handleInfoBulletin unrecognized info bulletin`;return Promise.resolve()};var i=a(r(13277)),n=r(21470),s=r(72327),o=a(r(33640)),l=r(63302),d=a(r(45521)),u=r(47472),c=new d.default("infoBulletinParser",(e=>{if(e.assertTag("ib"),e.assertFromServer(),e.hasChild(l.INFO_TYPE.DIRTY)){var t=[],r=[],a=[];return e.forEachChildWithTag(l.INFO_TYPE.DIRTY,(e=>{var i={type:e.attrString("type"),timestamp:e.attrInt("timestamp")};"account_sync"===i.type?(e.mapChildren((e=>e.tag())).forEach((e=>{n.SUPPORTED_DIRTY_PROTOCOLS.hasOwnProperty(e)&&a.push(e)})),r.push(i)):n.SUPPORTED_DIRTY_TYPE.hasOwnProperty(i.type)?r.push(i):t.push(i)})),{type:l.INFO_TYPE.DIRTY,supported:r,unsupported:t,protocols:a}}if(e.hasChild(l.INFO_TYPE.ROUTING)){var i=e.child(l.INFO_TYPE.ROUTING);return{type:l.INFO_TYPE.ROUTING,edgeRouting:i.child("routing_info").contentBytes(),domain:i.hasChild("dns_domain")?i.child("dns_domain").contentEnum(s.DOMAINS):null}}return e.hasChild(l.INFO_TYPE.DOWNGRADE)?{type:l.INFO_TYPE.DOWNGRADE}:e.hasChild(l.INFO_TYPE.OFFLINE)?{count:e.child(l.INFO_TYPE.OFFLINE).attrInt("count"),type:l.INFO_TYPE.OFFLINE}:e.hasChild(l.INFO_TYPE.OFFLINE_PREVIEW)?{count:{message:e.child(l.INFO_TYPE.OFFLINE_PREVIEW).attrInt("message"),receipt:e.child(l.INFO_TYPE.OFFLINE_PREVIEW).attrInt("receipt")},type:l.INFO_TYPE.OFFLINE_PREVIEW}:null}))},63302:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.INFO_TYPE=void 0;var r=Object.freeze({DIRTY:"dirty",DOWNGRADE:"downgrade_webclient",ROUTING:"edge_routing",OFFLINE:"offline",OFFLINE_PREVIEW:"offline_preview"});t.INFO_TYPE=r},16423:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return _.apply(this,arguments)};var i=a(r(52954)),n=r(35773),s=r(84337),o=r(66239),l=r(81558),d=r(83862),u=a(r(21830)),c=a(r(45521)),p=a(r(57713)),h=r(29020),f=new c.default("mediaRetryNotification",(e=>{e.assertTag("notification");var t=e.maybeChild("error");if(t)return{msgId:e.attrString("id"),ciphertext:null,iv:null,errorCode:d.MediaRetryNotificationResultType.cast(t.attrInt("code"))};var r=e.child("encrypt");return{msgId:e.attrString("id"),ciphertext:r.child("enc_p").contentBytes(),iv:r.child("enc_iv").contentBytes(l.ENC_IV_SIZE),errorCode:null}}));function _(){return(_=(0,i.default)((function*(e){var t=f.parse(e);if(t.error)throw __LOG__(4,void 0,new Error)`${t.error.toString()} parsing ${e.toString()}`,t.error;var{msgId:r,errorCode:a}=t.success,i=(0,n.wap)("ack",{id:(0,n.CUSTOM_STRING)(r),class:"notification",type:"mediaretry",to:(0,h.USER_JID)((0,o.getMeUser)())});if(null!=a)return p.default.resolveMediaReupload({msgId:r,result:a}),i;var{ciphertext:d,iv:c}=t.success,_=p.default.getMediaKey(r);if(!_)return __LOG__(3)`handleMediaRetryNotification: mediaKey is not found for msgId ${r}`,i;var{stanzaId:m,directPath:g,result:v}=yield(0,l.decryptMediaRetryNotification)((0,s.decodeB64)(_),r,(0,u.default)(c,"iv"),(0,u.default)(d,"ciphertext"));if(m!==r)throw new Error("handleMediaRetryNotification: msg id does not match");return p.default.resolveMediaReupload({msgId:r,result:v,directPath:g}),i}))).apply(this,arguments)}},11094:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HsmMismatchError=t.CATEGORY_PEER=t.ACTUAL_ACTORS=t.HOST_STORAGE=t.VERIFIED_LEVEL=t.MSG_TYPES=void 0;var a=r(71436);t.MSG_TYPES={text:"text",media:"media",pay:"pay"};t.VERIFIED_LEVEL={high:"high",low:"low",unknown:"unknown"};t.HOST_STORAGE={1:"on_premise",2:"facebook"};t.ACTUAL_ACTORS={1:"self",2:"bsp"};t.CATEGORY_PEER="peer";class i extends((0,a.customError)("HSMMismatchError")){}t.HsmMismatchError=i},22925:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.decryptE2EPayload=function(){return S.apply(this,arguments)};var n=i(r(52954)),s=r(70338),o=r(74878),l=r(11094),d=r(39764),u=r(22669),c=r(245),p=r(19173),h=i(r(84161)),f=r(28744),_=a(r(7574)),m=r(47294),g=r(44984),v=i(r(23045)),E=r(31449);function y(e,t,r){var{e2eType:a,ciphertext:i}=e;switch(a){case m.CiphertextType.Skmsg:return t.isGroup()||t.isBroadcast()?r?_.Cipher.decryptGroupSignalProto(t,r,i):Promise.reject(new Error(`['messaging'] decryptEnc: receive msg from ${t.toString()} without participant`)):Promise.reject(new Error(`['messaging'] decryptEnc: Can not do skmsg for non group ${t.toString()}`));case m.CiphertextType.Pkmsg:case m.CiphertextType.Msg:var n=t.isUser()?t:r;return n?_.Cipher.decryptSignalProto(n,a,i):Promise.reject(new Error(`['messaging'] decryptEnc: receive msg from ${t.toString()} without participant`))}}function S(){return(S=(0,n.default)((function*(e){var{bizInfo:t,msgInfo:r,paymentInfo:a,deviceIdentity:i,encs:_}=e;if(null!=r.author.device&&0!==r.author.device&&!(yield(0,s.validateADVwithEncs)(r.author,i,_)))return __LOG__(3,void 0,void 0,void 0,["messaging"])`decryptE2EPayload: msgId::${r.externalId}, validateADVIdentity failed`,{result:g.E2EProcessResult.RETRY,retryCount:_[0].retryCount};return(0,E.promiseReduce)(e.encs,((e,i)=>{if(e.result!==g.E2EProcessResult.SUCCESS)return Promise.resolve(e);var s=(0,p.getFrom)(r),_=new h.default.E2eMessageRecv({e2eCiphertextType:(0,o.metricsCiphertextType)(i.e2eType),e2eCiphertextVersion:o.CIPHERTEXT_VERSION,e2eDestination:(0,o.metricsDestinationType)(s),e2eSuccessful:!1,messageMediaType:i.mediaType?(0,o.metricsMediaType)(i.mediaType):h.default.MEDIA_TYPE.NONE,retryCount:i.retryCount});return y(i,s,r.author).then((e=>{_.e2eSuccessful=!0,_.weight=1e3,_.commit();var n={retryCount:i.retryCount,e2eType:i.e2eType,mediaType:i.mediaType};return(0,f.processDecryptedProto)(e,r,a,n,t).then((()=>({result:g.E2EProcessResult.SUCCESS})))})).catchTypes(u.SignalDecryptionError,d.UnknownMessageError,(e=>(__LOG__(3,void 0,void 0,!0,["messaging"])`decryptE2EPayload: msgId::${r.externalId}, ${e.toString()}`,SEND_LOGS("handleMsg: decryption error"),_.weight=1,_.commit(),(0,f.processPlaceholderMsg)(r,g.PlaceholderType.E2E).then((()=>({result:g.E2EProcessResult.RETRY,retryCount:i.retryCount})))))).catchType(u.SignalMessageCounterError,function(){var e=(0,n.default)((function*(e){if(__LOG__(3,void 0,void 0,void 0,["messaging"])`decryptE2EPayload: msgId::${r.externalId}, signal counter error for msg ID ${r.externalId}: ${e}`,null!=r.offline){var t=yield(0,c.getMsgByMsgKey)((0,p.messageInfoToKey)(r));if(null==t&&(yield(0,f.processPlaceholderMsg)(r,g.PlaceholderType.E2E)),null==t||t.type===v.default.MSG_TYPE.CIPHERTEXT)return __LOG__(2,void 0,void 0,void 0,["messaging"])`decryptE2EPayload: msgId::${r.externalId}, missing message for repeated signal counter`,{result:g.E2EProcessResult.RETRY,retryCount:i.retryCount}}return __LOG__(2,void 0,void 0,void 0,["messaging"])`decryptE2EPayload: msgId::${r.externalId}, ignore repeated signal counter`,{result:g.E2EProcessResult.SUCCESS}}));return function(){return e.apply(this,arguments)}}()).catchType(l.HsmMismatchError,(e=>(__LOG__(3,void 0,void 0,!0,["messaging"])`decryptE2EPayload: msgId::${r.externalId}, error: ${e.toString()}`,SEND_LOGS("handleMsg: hsm mismatch error"),_.weight=1,_.commit(),{result:g.E2EProcessResult.HSM_MISMATCH}))).catch((e=>(__LOG__(3,void 0,void 0,!0,["messaging"])`decryptE2EPayload: msgId::${r.externalId}, error: ${e.toString}`,SEND_LOGS("handleMsg: parse decrypted message error"),_.weight=1,_.commit(),{result:g.E2EProcessResult.PARSE_ERROR})))}),{result:g.E2EProcessResult.SUCCESS})}))).apply(this,arguments)}},39764:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.UnknownMessageError=t.DeviceSentMessageError=void 0;var i=r(71436),n=a(r(84161));class s extends((0,i.customError)("DeviceSentMessageError")){constructor(e,t){t===n.default.DSM_ERROR.MISSING_DSM?super("parseMessage: message should be deviceSentMessage"):t===n.default.DSM_ERROR.INVALID_SENDER?super("parseMessage: message should not be deviceSentMessage"):t===n.default.DSM_ERROR.INVALID_DSM?super("parseMessage: invalid deviceSentMessage"):super("parseMessage: unknown deviceSentMessage error"),new n.default.MdBadDeviceSentMessage({peerType:e,dsmError:t}).commit(),this.peerType=e,this.dsmError=t}}t.DeviceSentMessageError=s;class o extends((0,i.customError)("UnknownMessageError")){}t.UnknownMessageError=o},35023:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=l.default.parse(e);if(t.error)return Promise.reject(new Error(`${t.error.toString()} parsing ${e.toString()}`));var r=t.success,{msgMeta:a,msgInfo:p}=r;return null!=p.offline&&s.default.offlineStanzaReceivedAfterCompelete(),s.default.isResumeFromRestartComplete()&&delete r.msgInfo.offline,(0,o.onMsgProcessingThread)(p.chat.toString(),!!r.msgInfo.offline,(0,i.default)((function*(){if(a.isUnavailable)return __LOG__(2,void 0,void 0,void 0,["messaging"])`onMsgProcessingThread: msgId::${p.externalId}, get fanout placeholder`,yield(0,d.processPlaceholderMsg)(p,u.PlaceholderType.FANOUT),(0,c.sendReceipt)(p,a,{result:u.E2EProcessResult.BACKFILL});if(null==p.offline){__LOG__(2,void 0,void 0,void 0,["messaging"])`onMsgProcessingThread: msgId::${p.externalId}, start processing inline message`;var e=yield(0,n.decryptE2EPayload)(r);return(0,c.sendReceipt)(p,a,e)}var t=yield s.default.decryptOfflineMessage(r);return t.result!==u.E2EProcessResult.SUCCESS?(0,c.sendReceipt)(p,a,t):void 0})))};var i=a(r(52954)),n=r(22925),s=a(r(33640)),o=r(91253),l=a(r(97221)),d=r(28744),u=r(44984),c=r(19173)},97221:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(70417)),n=r(7222),s=r(11094),o=a(r(45521)),l=r(47119),d=r(65219),u=r(47294),c=r(44984),p=r(19173),h=r(25054);var f=new o.default("incomingMsgParser",(e=>{e.assertTag("message"),e.hasAttr("to")&&e.assertAttrIsMe("to");var t=e.mapChildrenWithTag("enc",(e=>({e2eType:e.attrFlowEnum("type",(e=>u.CiphertextType.cast(e))),mediaType:e.attrFlowEnumOrDefault("mediatype",(e=>u.MediaType.cast(e)),null),ciphertext:e.contentBytes(),retryCount:e.hasAttr("count")?e.attrInt("count"):0}))),r=e.maybeChild("device-identity"),a=r?r.contentBytes():null,o=function(e,t){var r,a={externalId:e.attrString("id"),ts:e.attrTime("t"),edit:e.hasAttr("edit")?e.attrInt("edit"):-1,isHsm:e.hasChild("hsm"),count:e.hasAttr("count")?e.attrInt("count"):null,pushname:e.hasAttr("notify")?e.attrString("notify"):null,category:e.hasAttr("category")?e.attrString("category"):null,offline:e.hasAttr("offline")?e.attrString("offline"):null},n=e.attrWid("from"),s=e.hasAttr("participant")?e.attrDeviceWid("participant"):null,o=e.hasAttr("recipient")?e.attrUserWid("recipient"):null,l=t.every((e=>e.e2eType!==u.CiphertextType.Skmsg)),d=t.some((e=>e.retryCount>0)),f={},_=e.maybeChild("participants");if(_){var m=[];_.forEachChildWithTag("to",(e=>{var t=e.attrUserWid("jid"),r=e.maybeAttrString("eph_setting");m.push(t),null!=r&&(f[t.toString()]=r)})),r=m}if(n.isUser())return null!=o?(0,p.isPeer)(n)?(0,i.default)((0,i.default)({type:c.MESSAGE_TYPE.CHAT},a),{},{chat:(0,h.toUserWid)(o),author:n}):e.throw("recipient on non peer chat message"):(0,i.default)((0,i.default)({type:c.MESSAGE_TYPE.CHAT},a),{},{chat:(0,h.toUserWid)(n),author:n});if(n.isGroup())return null==s?e.throw("group message with no participant"):(0,i.default)((0,i.default)({type:c.MESSAGE_TYPE.GROUP},a),{},{chat:n,author:s,isDirect:l});if(n.isBroadcast()&&!n.isStatusV3()){if(null==s)return e.throw("broadcast message with no participant");if((0,p.isPeer)(s)){if(null==r){if(!d)return e.throw("peer broadcast message with no participants node");r=[]}return(0,i.default)((0,i.default)({type:c.MESSAGE_TYPE.PEER_BROADCAST},a),{},{chat:n,author:s,isDirect:l,bclParticipants:r,bclHashValidated:!1,bclEphSettings:f})}return(0,i.default)((0,i.default)({type:c.MESSAGE_TYPE.OTHER_BROADCAST},a),{},{chat:n,author:s,isDirect:l,ephSetting:e.maybeAttrString("eph_setting")})}return n.isBroadcast()&&n.isStatusV3()?null==s?e.throw("status message with no participant"):(0,p.isPeer)(s)&&l?null==r?(0,i.default)((0,i.default)({type:c.MESSAGE_TYPE.DIRECT_PEER_STATUS},a),{},{chat:n,author:s,isDirect:l}):(0,i.default)((0,i.default)({type:c.MESSAGE_TYPE.DIRECT_PEER_STATUS},a),{},{chat:n,author:s,bclParticipants:r,bclHashValidated:!1}):(0,i.default)((0,i.default)({type:c.MESSAGE_TYPE.OTHER_STATUS},a),{},{chat:n,author:s,isDirect:l}):e.throw("Unrecognized message type")}(e,t);return{encs:t,msgInfo:o,msgMeta:function(e,t){var r=e.hasChild("unavailable");r||0!==t.length||e.throw("incomingMsgParser: to have enc node children");return{isUnavailable:r,type:e.attrEnum("type",s.MSG_TYPES),rawTs:e.attrString("t"),urlNumber:e.hasChild("url_number"),urlText:e.hasChild("url_text")}}(e,t),bizInfo:function(e){var t=e.hasChild("verified_name")?e.child("verified_name").contentBytes():null,r=e.attrEnumOrDefault("verified_level",s.VERIFIED_LEVEL,null),a=e.hasAttr("verified_name")?e.attrInt("verified_name"):-1,i=e.maybeChild("biz"),n=null;if(null!=i){var o=i.maybeAttrEnum("actual_actors",s.ACTUAL_ACTORS),l=i.maybeAttrEnum("host_storage",s.HOST_STORAGE),d=i.maybeAttrInt("privacy_mode_ts");null!=o&&null!=l&&null!=d&&(n={actualActors:o,hostStorage:l,privacyModeTs:d})}return{verifiedNameCert:t,verifiedLevel:r,verifiedNameSerial:a,privacyMode:n}}(e),paymentInfo:function(e){var t=null,r=e.hasChild("pay")&&e.child("pay"),a=e.hasChild("transaction")&&e.child("transaction");if(a){var i=(0,l.parseTransactionNode)(a);t={receiverJid:i.receiver.toString(),currency:i.currency,amount1000:i.amount1000,txnStatus:(0,d.getPaymentTxnWebStatus)(i.status),transactionTimestamp:i.ts}}else if(r&&"request"!==r.attrString("type")){var{amount1000:s,currency:o}=(0,n.getAmount1000AndCurrency)(r);t={receiverJid:r.hasAttr("receiver")?r.attrString("receiver"):e.attrString("recipient"),currency:o,amount1000:s,txnStatus:(0,d.getPaymentTxnWebStatus)(null),transactionTimestamp:e.attrInt("t")}}return t}(e),deviceIdentity:a}}));t.default=f},99262:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.updateAndGetPaymentRequestMessage=function(){return u.apply(this,arguments)};var i=a(r(70417)),n=a(r(52954)),s=r(43730),o=r(245),l=a(r(30528)),d=r(94781);function u(){return(u=(0,n.default)((function*(e,t){if(!e)return null;var r={};"payment_action_request_declined"===t?(r.paymentStatus=d.PaymentInfoStatus.REJECTED,r.paymentTxnStatus=d.PaymentInfoTxnStatus.COLLECT_REJECTED):"payment_transaction_request_cancelled"===t&&(r.paymentStatus=d.PaymentInfoStatus.CANCELLED,r.paymentTxnStatus=d.PaymentInfoTxnStatus.COLLECT_CANCELED);var a=yield(0,o.getMsgByMsgKey)(e);if(a)return yield(0,s.getTable)().merge(e.toString(),r),l.default.get(e)&&l.default.set([(0,i.default)({id:e},r)],{merge:!0}),a;Promise.reject(new Error("did not find the original payment request message"))}))).apply(this,arguments)}},28744:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.processDecryptedProto=function(){return P.apply(this,arguments)},t.processPlaceholderMsg=function(){return M.apply(this,arguments)};var n=i(r(52954)),s=r(9557),o=r(58666),l=r(11094),d=r(99429),u=r(39764),c=r(66239),p=i(r(84558)),h=r(245),f=i(r(84161)),_=r(62711),m=r(79479),g=a(r(7574)),v=r(25815),E=r(69909),y=i(r(1730)),S=r(19173),T=r(55821),A=r(44984),b=r(76581),C=r(63433);function P(){return(P=(0,n.default)((function*(e,t,r,a,i){var n=(0,E.unpad)(e),o=(0,s.decodeProto)(d.MessageSpec,n);if(null==t.offline&&__LOG__(2,void 0,void 0,void 0,["messaging"])`processDecryptedProto: msgId::${t.externalId}, message decrypted: `,!t.isHsm&&o.highlyStructuredMessage)throw new l.HsmMismatchError;var _=(0,S.getFrom)(t);if(!(yield(0,T.isFromKnownDevice)(t.author)))throw new u.UnknownMessageError(`[messaging] msgId::${t.externalId}, processDecryptedProto: reject message from unknown device`);if(t.type===A.MESSAGE_TYPE.PEER_BROADCAST&&a.retryCount>0){var v=yield(0,h.getMsgByMsgKey)((0,S.messageInfoToKey)(t));null!=(null==v?void 0:v.broadcastParticipants)&&(t.bclParticipants=v.broadcastParticipants,null!=v.broadcastEphSettings&&(t.bclEphSettings=v.broadcastEphSettings))}var y=yield(0,S.parseMessage)(t,a.e2eType,o,r),P=[];if(y.history)(0,p.default)(y.history,_,t.externalId);else if(y.securityNotificationEnabled)(0,c.setGlobalSecurityNotifications)(y.securityNotificationEnabled.isEnabled);else if(y.appStateSyncKeyShare)(0,b.handleAppStateSyncKeyShare)(y.appStateSyncKeyShare,_);else if(y.appStateSyncKeyRequest)(0,C.handleAppStateSyncKeyRequest)(y.appStateSyncKeyRequest,_);else{var w=!1;if(null==y.deviceSent?w=!0:y.deviceSent.phash?w=yield(0,T.validateBclHash)(y.deviceSent.phash,y.deviceSent.info):y.deviceSent.destination&&(w=yield(0,T.validateMsgDestination)(y.deviceSent.destination,t)),!w)throw new u.DeviceSentMessageError((0,S.getDeviceType)(t.author),f.default.DSM_ERROR.INVALID_DSM);var M=a.retryCount>0;P.push(O(y.renderableMsgs,t,r,i,M)),null!=y.storeMsg&&(0,h.storeMessages)([y.storeMsg],y.storeMsg.id.remote),null!=y.senderKey&&P.push(g.Session.createGroupSignalSession(t.author,y.senderKey.groupId,y.senderKey.key)),t.pushname&&(0,m.updatePushname)(t.author,t.pushname),yield Promise.all(P)}}))).apply(this,arguments)}function O(){return w.apply(this,arguments)}function w(){return(w=(0,n.default)((function*(e,t,r,a,i){try{if(t.offline)return void y.default.addOfflineMessage(e.map((e=>({msg:e,receiptInfo:{from:(0,S.getFrom)(t),author:t.author}}))));yield Promise.all(e.map(function(){var e=(0,n.default)((function*(e){var r=e.id.remote;(0,v.updateContactPropertiesOnNewChat)(r),(0,v.updateBizPrivacyMode)(r,a.privacyMode),yield(0,_.handleSingleMsgMD)(r,e,i),(0,o.processOrphanAck)(e.id).catch((e=>{__LOG__(3,void 0,void 0,!0,["messaging"])`processOrphanAck: msgId::${t.externalId}, failed with error: ${e}`,SEND_LOGS("processOrphanAck failed")}))}));return function(){return e.apply(this,arguments)}}()))}catch(e){__LOG__(4,void 0,new Error,!0,["messaging"])`processRenderableMsg: msgId::${t.externalId}, failed with error: ${e}`,SEND_LOGS("handle_msg: error storing/processing single message")}}))).apply(this,arguments)}function M(){return(M=(0,n.default)((function*(e,t){if(e.category!==l.CATEGORY_PEER)try{var r=yield(0,S.genPlaceholderMsg)(e,t);e.offline?y.default.addOfflineMessage(r.map((e=>({msg:e})))):yield Promise.all(r.map(function(){var e=(0,n.default)((function*(e){var t=e.id.remote;yield(0,_.handleSingleMsgMD)(t,e)}));return function(){return e.apply(this,arguments)}}()))}catch(t){__LOG__(4,void 0,new Error,!0,["messaging"])`processPlaceholderMsg: msgId::${e.externalId}, failed with error: ${t}`,SEND_LOGS("handle_msg: error storing/processing single message")}else __LOG__(2,void 0,void 0,void 0,["messaging"])`processPlaceholderMsg: msgId::${e.externalId}, skip placeholder for peer message ${e.externalId}`}))).apply(this,arguments)}},44984:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MESSAGE_TYPE=t.PlaceholderType=t.E2EProcessResult=void 0;var a=r(28103).Mirrored(["SUCCESS","RETRY","HSM_MISMATCH","BACKFILL","PARSE_ERROR"]);t.E2EProcessResult=a;var i=r(28103).Mirrored(["E2E","FANOUT"]);t.PlaceholderType=i;var n=Object.freeze({CHAT:"chat",GROUP:"group",PEER_BROADCAST:"peer_broadcast",OTHER_BROADCAST:"other_broadcast",DIRECT_PEER_STATUS:"direct_peer_status",OTHER_STATUS:"other_status"});t.MESSAGE_TYPE=n},19173:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.parseMessage=function(){return b.apply(this,arguments)},t.genPlaceholderMsg=function(){return L.apply(this,arguments)},t.generateBaseMsg=k,t.sendReceipt=function(e,t,r){var{externalId:a}=e,{rawTs:i}=t,n=B(e),d=e.type===S.MESSAGE_TYPE.CHAT&&G(e.author)?e.chat:null,u=e.type===S.MESSAGE_TYPE.CHAT?null:e.author,c=e.category===o.CATEGORY_PEER;switch(r.result){case S.E2EProcessResult.SUCCESS:return(0,v.sendDeliveryReceiptsAfterDecryption)(a,n,d,u,c);case S.E2EProcessResult.HSM_MISMATCH:return Promise.resolve();case S.E2EProcessResult.RETRY:var h=null==r.retryCount?1:r.retryCount+1;return(0,E.sendRetryReceipt)(h,n,u,d,a,i,c);default:return Promise.resolve((0,l.castStanza)((0,s.wap)("ack",{id:(0,s.CUSTOM_STRING)(a),class:"message",from:(0,T.DEVICE_JID)((0,p.assertGetMe)()),to:n?(0,T.JID)(n):s.DROP_ATTR,type:t.type,participant:u?(0,T.USER_JID)(u):s.DROP_ATTR})))}},t.isPeer=G,t.messageInfoToKey=F,t.getDeviceType=x,t.getFrom=B;var i=a(r(70417)),n=a(r(52954)),s=r(35773),o=r(11094),l=r(7017),d=a(r(23045)),u=r(67961),c=r(39764),p=r(66239),h=r(245),f=a(r(84161)),_=a(r(83746)),m=a(r(76452)),g=r(99262),v=r(8139),E=r(14233),y=r(47294),S=r(44984),T=r(29020),A=r(25054);function b(){return(b=(0,n.default)((function*(e,t,r,a){var i,n,s,o,l;if(null!=(null===(i=r.protocolMessage)||void 0===i?void 0:i.historySyncNotification))l={history:m.default.parseMsgProto(r,k(e),"relay",a).historySyncMetaData};else if(null!=(null===(n=r.protocolMessage)||void 0===n?void 0:n.initialSecurityNotificationSettingSync)){var d;l={securityNotificationEnabled:{isEnabled:null===(d=r.protocolMessage.initialSecurityNotificationSettingSync.securityNotificationEnabled)||void 0===d||d}}}else if(null!=(null===(s=r.protocolMessage)||void 0===s?void 0:s.appStateSyncKeyShare))l={appStateSyncKeyShare:r.protocolMessage.appStateSyncKeyShare};else if(null!=(null===(o=r.protocolMessage)||void 0===o?void 0:o.appStateSyncKeyRequest))l={appStateSyncKeyRequest:r.protocolMessage.appStateSyncKeyRequest};else switch(e.type){case S.MESSAGE_TYPE.CHAT:l=G(e.author)?yield C(e,r,a):yield M(e,r,a);break;case S.MESSAGE_TYPE.GROUP:l=G(e.author)&&e.isDirect?yield C(e,r,a):yield M(e,r,a);break;case S.MESSAGE_TYPE.PEER_BROADCAST:if(t===y.CiphertextType.Skmsg){if(!e.bclHashValidated)throw new Error("parseMessage: participants for peer broadcast message is not validated");l=yield M(e,r,a)}else l=yield O(e,r,a);break;case S.MESSAGE_TYPE.OTHER_BROADCAST:l=yield M(e,r,a);break;case S.MESSAGE_TYPE.DIRECT_PEER_STATUS:l=e.isDirect?yield C(e,r,a):yield O(e,r,a);break;case S.MESSAGE_TYPE.OTHER_STATUS:l=yield M(e,r,a);break;default:throw new Error("Unrecognized MESSAGE_TYPE")}return l}))).apply(this,arguments)}function C(){return P.apply(this,arguments)}function P(){return(P=(0,n.default)((function*(e,t,r){var{deviceSentMessage:a}=t;if(null==a)throw new c.DeviceSentMessageError(x(e.author),f.default.DSM_ERROR.MISSING_DSM);if(null==a.destinationJid)throw new c.DeviceSentMessageError(x(e.author),f.default.DSM_ERROR.INVALID_DSM);var{destinationJid:n}=a,s=yield R(e,a.message,r);return(0,i.default)({deviceSent:{destination:(0,A.createWid)(n)}},s)}))).apply(this,arguments)}function O(){return w.apply(this,arguments)}function w(){return(w=(0,n.default)((function*(e,t,r){var{deviceSentMessage:a}=t;if(null==a)throw new c.DeviceSentMessageError(x(e.author),f.default.DSM_ERROR.MISSING_DSM);if(null==a.phash)throw new c.DeviceSentMessageError(x(e.author),f.default.DSM_ERROR.INVALID_DSM);var{phash:n}=a,s=yield R(e,a.message,r);return(0,i.default)({deviceSent:{phash:n,info:e}},s)}))).apply(this,arguments)}function M(){return I.apply(this,arguments)}function I(){return(I=(0,n.default)((function*(e,t,r){if(null!=t.deviceSentMessage)throw new c.DeviceSentMessageError(x(e.author),f.default.DSM_ERROR.INVALID_SENDER);var a=yield R(e,t,r);return(0,i.default)({deviceSent:null},a)}))).apply(this,arguments)}function R(){return D.apply(this,arguments)}function D(){return(D=(0,n.default)((function*(e,t,r){if(null==t)return{senderKey:null,storeMsg:null,renderableMsgs:[]};var a=m.default.parseMsgProto(t,k(e),"relay",r),i=null!=t.senderKeyDistributionMessage?N(e,t.senderKeyDistributionMessage):null,n=null;if(e.type===S.MESSAGE_TYPE.PEER_BROADCAST&&(a.broadcastId=e.chat,a.broadcastParticipants=e.bclParticipants,a.broadcastEphSettings=e.bclEphSettings,n=a),e.type===S.MESSAGE_TYPE.OTHER_BROADCAST){a.broadcastId=e.chat;var s=e.ephSetting,o=a.ephemeralSharedSecret;if(null!=s&&null!=o){var{ephemeralDuration:l,ephemeralSettingTimestamp:c}=yield(0,u.decodeBroadcastEphemeralSetting)(e.chat,(0,p.getMeUser)(),e.author,s,o);a.ephemeralDuration=l,a.ephemeralSettingTimestamp=c}}var h=!1;if("payment_action_request_declined"===a.subtype||"payment_transaction_request_cancelled"===a.subtype){var f=yield(0,g.updateAndGetPaymentRequestMessage)(a.paymentRequestMessageKey,a.subtype);if(f){a.type=d.default.MSG_TYPE.NOTIFICATION_TEMPLATE;var _="payment_action_request_declined"===a.subtype&&f.paymentMessageReceiverJid.equals((0,p.getMeUser)())?f.author:f.paymentMessageReceiverJid;a.templateParams=[_,f.paymentCurrency,f.paymentAmount1000]}else h=!0}var v=[];return h||"unknown"===a.type&&null!=i||(v=e.type===S.MESSAGE_TYPE.PEER_BROADCAST?yield U(a,e.bclParticipants,e.bclEphSettings):[a]),{senderKey:i,storeMsg:n,renderableMsgs:v}}))).apply(this,arguments)}function N(e,t){if(!e.chat.isGroup()&&!e.chat.isBroadcast())throw new Error("should not have senderkey");var{groupId:r,axolotlSenderKeyDistributionMessage:a}=t;if(null==r||e.chat.toString({legacy:!0})!==r)throw new Error(`senderKeyDistributionMessage: from ${e.chat.toString()} mismatched to ${r||"null"}`);if(!a)throw new Error(`senderKeyDistributionMessage: from ${e.author.toString()} has no content`);return{groupId:r,key:a}}function L(){return(L=(0,n.default)((function*(e,t){if(e.edit===d.default.EDIT_ATTR.REVOKE&&e.type!==S.MESSAGE_TYPE.PEER_BROADCAST)return[];var r=k(e);return t===S.PlaceholderType.E2E?r.type=d.default.MSG_TYPE.CIPHERTEXT:(r.type=d.default.MSG_TYPE.UNKNOWN,r.subtype="fanout"),e.type===S.MESSAGE_TYPE.PEER_BROADCAST?(r.broadcastParticipants=e.bclParticipants,r.broadcastEphSettings=e.bclEphSettings,(0,h.storeMessages)([r],r.id.remote),e.edit===d.default.EDIT_ATTR.REVOKE?[]:yield U(r,e.bclParticipants)):[r]}))).apply(this,arguments)}function k(e){var t=F(e),r=(0,p.getMeUser)(),a={id:t,from:t.fromMe?r:t.remote,to:t.fromMe?t.remote:r,type:d.default.MSG_TYPE.UNKNOWN,t:e.ts||0,ack:d.default.ACK.SENT,author:t.participant,broadcast:!1,notifyName:e.pushname||""};return null!=e.count&&(a.count=e.count),a}function U(e,t,r){return Promise.all(t.map(function(){var t=(0,n.default)((function*(t){var a,n,s;try{a=new _.default({remote:t,fromMe:!0,id:e.id.id})}catch(e){return __LOG__(3)`drop: cannot create MsgKey: ${e.stack}`,null}var o=r?r[t.toString()]:null,l=e.ephemeralSharedSecret,d=e.broadcastId;null!=d&&null!=o&&null!=l&&({ephemeralDuration:n,ephemeralSettingTimestamp:s}=yield(0,u.decodeBroadcastEphemeralSetting)(d,t,(0,p.getMeUser)(),o,l));var c=(0,i.default)((0,i.default)({},e),{},{id:a,from:(0,p.getMeUser)(),to:t,broadcast:!0,ephemeralDuration:n,ephemeralSettingTimestamp:s});return e.protocolMessageKey&&(c.protocolMessageKey=new _.default({remote:t,fromMe:!0,id:e.protocolMessageKey.id})),c}));return function(){return t.apply(this,arguments)}}())).then((e=>e.filter(Boolean)))}function G(e){return(0,A.toUserWid)(e).equals((0,p.getMeUser)())}function F(e){return e.type===S.MESSAGE_TYPE.OTHER_BROADCAST?new _.default({remote:(0,A.toUserWid)(e.author),fromMe:!1,id:e.externalId}):e.type===S.MESSAGE_TYPE.CHAT?new _.default({remote:e.chat,fromMe:G(e.author),id:e.externalId}):new _.default({remote:e.chat,fromMe:G(e.author),participant:(0,A.toUserWid)(e.author),id:e.externalId})}function x(e){return null==e.device||e.device===d.default.DEVICE.PRIMARY_DEVICE?f.default.DEVICE_TYPE.PRIMARY:f.default.DEVICE_TYPE.COMPANION}function B(e){return e.type===S.MESSAGE_TYPE.CHAT?e.author:e.chat}},55821:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.validateMsgDestination=function(e,t){var r=t.author,a=t.chat;if(!e.equals(a))return __LOG__(4,void 0,new Error,!0)`encDestination: ${String(e)}, destination: ${a.toString()}`,SEND_LOGS("validateMsgDestination: drop due to the deviceSentMessage meta mismatch."),Promise.resolve(!1);var i=(0,u.toUserWid)(r),n=r.device||0;if(!i.equals((0,l.getMeUser)()))return __LOG__(4,void 0,new Error,!0)`sender: ${r.toString()}`,SEND_LOGS("validateMsgDestination: drop due to msg is not sent from your own device."),Promise.resolve(!1);return(0,o.hasDevice)(i,n).then((e=>(e||(__LOG__(4,void 0,new Error,!0)`no record found for sender: ${r.toString()}`,SEND_LOGS("validateMsgDestination:drop due to invalid device")),e)))},t.validateBclHash=function(e,t){var r,a=null!==(r=t.bclParticipants)&&void 0!==r?r:[];return(0,d.phashV2)(a).then((r=>r!==e?(__LOG__(4,void 0,new Error,!0)`expected: ${e}, got: ${r}`,SEND_LOGS("validateBclHash: drop due to invalid hash."),!1):(t.bclHashValidated=!0,!0)))},t.isFromKnownDevice=function(){return c.apply(this,arguments)};var i=a(r(52954)),n=r(47882),s=a(r(23045)),o=r(9641),l=r(66239),d=r(17063),u=r(25054);function c(){return(c=(0,i.default)((function*(e){var t=null==e.device?s.default.DEVICE.PRIMARY_DEVICE:e.device;if(t===s.default.DEVICE.PRIMARY_DEVICE)return!0;var[r]=yield(0,o.getDeviceIds)([e.user]),a=null!=r&&r.devices.includes(t);return a||(0,n.syncDeviceList)([(0,u.toUserWid)(e)]),a}))).apply(this,arguments)}},84665:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.handleChatSimpleAck=function(){return g.apply(this,arguments)};var i=a(r(52954)),n=r(83243),s=a(r(23045)),o=r(66239),l=a(r(33640)),d=r(59763),u=a(r(83746)),c=a(r(27659)),p=r(25054),h=r(25815),f=a(r(54559)),{ACK:_,ACK_STRING:m}=s.default;function g(){return(g=(0,i.default)((function*(e){var t,{from:r,externalIds:a,ts:i,recipient:n,ackString:s,offline:g,biz:E}=e,{ack:y}=e,S=s===m.SENDER,T=!S&&(0,p.toUserWid)(r).equals((0,o.getMeUser)());if(T||S){if(!n)throw new Error("handleChatSimpleAck: invalid sender/peer receipt without recipient");t=n}else{var A;t=(0,p.toUserWid)(r),y===_.READ&&"none"===(null===(A=(0,o.getUserPrivacySettings)())||void 0===A?void 0:A.readReceipts)&&(y=_.RECEIVED)}f.default.bspSystemMessageEnabled&&(0,h.updateBizPrivacyMode)(r,E);var b=a.map((e=>new u.default({id:e,remote:t,fromMe:!T}))),C=b.map((e=>e.toString()));if(null!=g&&l.default.offlineStanzaReceivedAfterCompelete(),null==g||l.default.isResumeFromRestartComplete()){if(!T)try{yield(0,d.updateReceiptRecords)(y,i,r,C)}catch(e){__LOG__(4,void 0,new Error,!0)`error: ${e}`,SEND_LOGS("handleChatSimpleAck: failed")}yield v(T,S,b,t,y,i)}else{if(!T)return c.default.addOfflineReceipt(y,i,r,C);if(null!=n&&s===m.READ&&a.length>0)return c.default.addOfflinePeerReadReceipt(i,C)}}))).apply(this,arguments)}function v(e,t,r,a,i,s){return i<_.RECEIVED?Promise.resolve():t?(__LOG__(2)`handleChatSimpleAck: sender receipt from peer device ${a.toString()}`,Promise.resolve()):e?(__LOG__(2)`handleChatSimpleAck: peer receipt from peer device ${a.toString()}`,i===_.READ?(0,n.updateChatPeerRead)(a,r):i===_.PLAYED?(0,n.updateMsgAcks)(r,i,s):Promise.resolve()):(0,n.updateMsgAcks)(r,i,s)}},83243:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.updateChatPeerRead=m,t.updateMsgAcks=v,t.processOrphanPeerReceipt=function(e){return _.enqueue((0,i.default)((function*(){var t=yield(0,u.getOrphanReceipt)(String(e));t?(null!=t[f.PLAYED]&&(__LOG__(2)`processOrphanPeerReceipt: orphan played ack found for incoming ${e}`,yield v([e],h.PLAYED,t[f.PLAYED])),null!=t[f.READ]&&(__LOG__(2)`processOrphanPeerReceipt: orphan read ack found for incoming ${e}`,m(e.remote,[e])),yield(0,u.removeOrphanReceipt)(String(e))):__LOG__(2)`processOrphanPeerReceipt: no orphan ack found for incoming ${e}`})))};var i=a(r(52954)),n=r(19129),s=r(58666),o=r(78391),l=a(r(23045)),d=a(r(30528)),u=r(62160),c=r(76710),p=r(43730),{ACK:h,ACK_STRING:f}=l.default,_=new n.PromiseQueue;function m(){return g.apply(this,arguments)}function g(){return(g=(0,i.default)((function*(e,t){var a=t.map(String),i=[],n=null;(yield(0,p.getTable)().bulkGet(a,!1)).forEach(((e,t)=>{e?null==e.pendingReadReceipt||null!=e.rowId&&(null==n||e.rowId>n)&&(n=e.rowId):i.push(a[t])})),_.enqueue((()=>(__LOG__(2)`updateChatPeerRead: storing ${i.length} orphan acks`,(0,u.createOrUpdateOrphanReceipt)(f.READ,0,i)))),yield(0,o.markMessageAndChatAsRead)(n,String(e));var s=r(85030).default.get(e);s&&(0,c.updateUnreadCountMD)(s,0,!1)}))).apply(this,arguments)}function v(){return E.apply(this,arguments)}function E(){return(E=(0,i.default)((function*(e,t,r){var a=[],i=[];e.forEach((e=>{var n=d.default.get(e);n?i.push((0,s.updateMsgAck)(n,null,{from:n.from,to:n.to,ack:t,t:r})):(__LOG__(2)`updateMsgAcks: no message found for incoming ack, with msgKey: ${e}`,e.fromMe||a.push(e))})),a.length>0&&_.enqueue((()=>{__LOG__(2)`updateMsgAcks: store ${a.length} orphan acks`;var e=null;if(t===h.PLAYED?e=f.PLAYED:t===h.READ&&(e=f.READ),e)return(0,u.createOrUpdateOrphanReceipt)(e,r,a.map(String))})),yield Promise.all(i)}))).apply(this,arguments)}},69590:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.handleGroupSimpleAck=function(){return E.apply(this,arguments)};var i=a(r(52954)),n=r(58666),s=r(83243),o=a(r(23045)),l=r(66239),d=a(r(33640)),u=r(59763),c=a(r(30528)),p=r(39427),h=a(r(39542)),f=a(r(83746)),_=a(r(27659)),m=r(25054),{ACK:g,ACK_STRING:v}=o.default;function E(){return(E=(0,i.default)((function*(e){var{ack:t,from:r,externalIds:a,ts:i,ackString:n,participant:s,recipient:o,offline:c}=e;if(!s)throw new Error("handleGroupSimpleAck: got group ack without participant.");var p,h=(0,l.getMeUser)(),g=(0,m.toUserWid)(s),E=n===v.SENDER,S=!E&&g.equals(h);if(S){if(!o)throw new Error("handleGroupSimpleAck: invalid sender/peer receipt without recipient");p=o}else p=h;var T=a.map((e=>new f.default({id:e,remote:r,fromMe:!S,participant:p}))),A=T.map((e=>e.toString()));if(null!=c&&d.default.offlineStanzaReceivedAfterCompelete(),null==c||d.default.isResumeFromRestartComplete()){if(!S)try{yield(0,u.updateReceiptRecords)(t,i,s,A)}catch(e){__LOG__(4,void 0,new Error,!0)`error: ${e}`,SEND_LOGS("handleGroupSimpleAck: failed")}}else{if(!S)return _.default.addOfflineReceipt(t,i,s,A);if(null!=o&&n===v.READ&&a.length>0)return _.default.addOfflinePeerReadReceipt(i,A)}yield y(S,E,T,r,t,g,i)}))).apply(this,arguments)}function y(e,t,r,a,i,o,d){return i<g.RECEIVED?Promise.resolve():t?(__LOG__(2)`handleGroupSimpleAck: sender receipt from peer device ${a.toString()}`,Promise.resolve()):e?(__LOG__(2)`handleGroupSimpleAck: peer receipt from peer device ${a.toString()}`,i===g.READ&&(0,s.updateChatPeerRead)(a,r),i===g.PLAYED?(0,s.updateMsgAcks)(r,i,d):Promise.resolve()):Promise.all(r.map((e=>{var t=c.default.get(e);if(t)return h.default.find(e).then((r=>{if(r||(__LOG__(4,void 0,new Error,!0)`Assertion failed! ${e.toString()}`,SEND_LOGS("handleGroupSimpleAck: no msgInfo found for msg:")),(0,p.updateMsgInfo)(r,i,o,d),i===g.RECEIVED&&0===r.deliveryRemaining||i===g.READ&&0===r.readRemaining||i===g.PLAYED&&0===r.playedRemaining)return(0,n.updateMsgAck)(t,null,{from:(0,l.assertGetMe)(),to:a,ack:i,t:d})}));__LOG__(2)`handleGroupSimpleAck: no message found for incoming ack, with msgKey:`}))).then((()=>{}))}},1429:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=h.default.parse(e);if(t.error)return __LOG__(4,void 0,new Error)`${t.error.toString()} parsing ${e.toString()}`,Promise.reject(t.error);var r=t.success,{ack:a,ackString:i,from:o,stanzaId:f}=r;if(r.type===h.RECEIPT_TYPE.SIMPLE){if(a===m.CONTENT_GONE)return Promise.resolve(g(o,f,i,null));var _=g(o,f,i,r.participant);return function(e){var{from:t,ack:r,stanzaId:a}=e;if(__LOG__(2)`handleSimpleAck: got receipt ${r} for msg ${a}`,r===m.MD_DOWNGRADE){var i=new p.default({id:a,remote:t,fromMe:!0,participant:t.isUser()?void 0:(0,l.getMeUser)()});return(0,c.updateLocalAndModel)(i,{mdDowngrade:!0})}if(r===m.PEER)return Promise.resolve();if(t.isStatusV3())return(0,u.handleStatusSimpleAck)(e);if(t.isUser())return(0,s.handleChatSimpleAck)(e);if(t.isGroup())return(0,d.handleGroupSimpleAck)(e);if(t.isBroadcast()){if(!e.participant)return Promise.reject(new Error(`handleSimpleAck: missing participant for broadcast receipt ${t.toString()}`));var o=(0,n.default)((0,n.default)({},e),{},{from:e.participant,participant:null});return(0,s.handleChatSimpleAck)(o)}return Promise.reject(new Error(`handleSimpleAck: unsupported type for ${t.toString()}`))}(r).then((()=>_)).catch((()=>_))}if(r.type===h.RECEIPT_TYPE.AGGREGATE){var v=g(o,f,i,null);return function(e){var{ack:t,from:r}=e;if(t===m.CONTENT_GONE)return Promise.reject("handleAggregateAck: reupload receipts cannot be aggregated");if(!r.isGroup())return Promise.reject("handleAggregateAck: aggregate receipts should come only from group JIDs");return __LOG__(3)`handleAggregateAck: not implemented`,Promise.resolve()}(r).then((()=>v)).catch((()=>v))}return __LOG__(4,void 0,new Error,!0)`type: ${r.type}`,SEND_LOGS("handleMsgReceipt: Invalid receipt type"),Promise.resolve(g(o,f,i,null))};var n=i(r(70417)),s=r(84665),o=i(r(23045)),l=r(66239),d=r(69590),u=r(34466),c=r(26495),p=i(r(83746)),h=a(r(87734)),f=r(35773),_=r(29020),{ACK:m}=o.default;function g(e,t,r,a){return(0,f.wap)("ack",{to:(0,_.JID)(e),id:(0,f.CUSTOM_STRING)(t),class:"receipt",type:(0,f.MAYBE_CUSTOM_STRING)(r),participant:a&&a!==e?(0,_.DEVICE_JID)(a):f.DROP_ATTR})}},87734:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.RECEIPT_TYPE=void 0;var i=a(r(70417)),n=r(11094),s=a(r(23045)),o=a(r(45521)),{ACK:l}=s.default,d={read:l.READ,played:l.PLAYED,inactive:l.INACTIVE,"server-error":l.CONTENT_GONE,"md-downgrade":l.MD_DOWNGRADE,sender:l.RECEIVED,"read-self":l.READ,"played-self":l.PLAYED,peer_msg:l.PEER},u={SIMPLE:"simple",AGGREGATE:"aggregate"};t.RECEIPT_TYPE=u;var c=new o.default("incomingMsgReceiptParser",(e=>{e.assertTag("receipt"),e.hasAttr("to")&&e.assertAttrIsMe("to");var t={ack:e.attrEnumOrDefault("type",d,l.RECEIVED),stanzaId:e.attrString("id"),from:e.attrWid("from"),ackString:e.hasAttr("type")?e.attrString("type"):null},r=e.maybeChild("participants");return r?function(e,t){var r=t.mapChildrenWithTag("user",(e=>{try{return{participant:e.attrDeviceWid("jid"),ts:e.attrTime("t")}}catch(e){return null}})).filter((e=>null!=e));return(0,i.default)((0,i.default)({},e),{},{type:u.AGGREGATE,externalId:t.attrString("key"),receipts:r})}(t,r):function(e,t){var r,a,s=t.hasAttr("participant")?t.attrDeviceWid("participant"):null,o=t.hasAttr("recipient")?t.attrUserWid("recipient"):null;r=t.hasChild("list")?t.child("list").mapChildrenWithTag("item",(e=>e.attrString("id"))):[];if(t.hasChild("biz")){var l=t.child("biz"),d=l.maybeAttrEnum("actual_actors",n.ACTUAL_ACTORS),u=l.maybeAttrEnum("host_storage",n.HOST_STORAGE),c=l.maybeAttrInt("privacy_mode_ts");null!=d&&null!=u&&null!=c&&(a={actualActors:d,hostStorage:u,privacyModeTs:c})}return r.push(e.stanzaId),(0,i.default)((0,i.default)({},e),{},{type:"simple",externalIds:r,participant:s,recipient:o,ts:t.attrTime("t"),offline:t.hasAttr("offline")?t.attrString("offline"):null,biz:a})}(t,e)}));t.default=c},34466:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.handleStatusSimpleAck=function(){return m.apply(this,arguments)};var i=a(r(52954)),n=r(83243),s=a(r(23045)),o=r(66239),l=r(59763),d=a(r(83746)),u=r(25054),c=a(r(65677)),p=a(r(39542)),h=r(39427),{ACK:f,ACK_STRING:_}=s.default;function m(){return(m=(0,i.default)((function*(e){var{externalIds:t,ts:r,ackString:a,ack:i,participant:n,recipient:c}=e;if(a===_.READ){var p=!!n&&(0,u.toUserWid)(n).equals((0,o.getMeUser)()),h=new d.default({id:t[0],remote:(0,u.createWid)(s.default.STATUS_WID),fromMe:!p,participant:c||(0,o.getMeUser)()}),f=[h.toString()];if(!p&&n)try{yield(0,l.updateReceiptRecords)(i,r,n,f)}catch(e){__LOG__(4,void 0,new Error,!0)`error: ${e}`,SEND_LOGS("handleStatusSimpleAck: failed")}yield g(p,h,r)}}))).apply(this,arguments)}function g(){return v.apply(this,arguments)}function v(){return(v=(0,i.default)((function*(e,t,r){var a=t.participant;if(a){if(e){var i=c.default.get(a);i&&i.handleReadStatus(t)}else{var s=yield p.default.find(t);(0,h.updateMsgInfo)(s,f.READ,a,r)}yield(0,n.updateMsgAcks)([t],f.READ,r)}}))).apply(this,arguments)}},86791:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.sendAndClearDanglingReceipts=function(){return u.apply(this,arguments)},t.clearDanglingReceipts=c;var i=a(r(52954)),n=r(95334),s=r(830),o=r(25323),l=r(31970),d=r(25054);function u(){return(u=(0,i.default)((function*(){var e=yield(0,o.getTable)().all(),t=new Map;e.forEach((e=>{var{receipts:r}=e;r.forEach((e=>{var r=(0,d.createWid)(e.from),a=(0,d.createWid)(e.author),i=t.get(r);i||(i=new Map,t.set(r,i));var n=i.get(a);n||(n=[],i.set(a,n)),n.push(e.externalId)}))}));var r=String((0,n.unixTime)());yield Promise.all(Array.from(t.keys()).map((e=>{var a=t.get(e);if(a)return(0,s.sendAggregateReceipts)(e,s.RECEIPT_TYPE.DELIVERY,r,a)}))),yield c()}))).apply(this,arguments)}function c(){return p.apply(this,arguments)}function p(){return(p=(0,i.default)((function*(){yield(0,l.blockSendPing)(),yield(0,o.getTable)().clear()}))).apply(this,arguments)}},94757:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(52954)),n=r(19129),s=r(35160),o=r(7017),l=r(85348);var d=new class{constructor(){this.pendingDeviceCache=new Set,this.pendingAcks=[],this.snapshotTimer=new s.ShiftTimer((()=>{this.createSnapshot()})),this.checkpointQueue=new n.PromiseQueue}addOfflinePendingDevice(e,t){this.pendingDeviceCache.add(e),this.pendingAcks.push(t),this.snapshotTimer.isScheduled()||(__LOG__(2)`[offline-resume][device-cache]: creating snapshot: schedule in ${3e3} ms`,this.snapshotTimer.onOrAfter(3e3))}createSnapshot(){this.snapshotTimer.isScheduled()&&this.snapshotTimer.cancel();var e=Array.from(this.pendingDeviceCache),t=this.pendingAcks;__LOG__(2)`[offline-resume][device-cache]: creating snapshot for pending devices ${e.join(",")}`,this.checkpointQueue.enqueue((0,i.default)((function*(){yield(0,l.addUserToPendingDeviceSync)(e),t.forEach(o.castStanza)}))),this.pendingDeviceCache=new Set,this.pendingAcks=[]}};t.default=d},33640:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.OfflineMessageHandler=void 0;var n=i(r(52954)),s=r(60266),o=r(13275),l=r(86791),d=i(r(13277)),u=r(22925),c=r(71715),p=r(91253),h=i(r(1730)),f=r(86123),_=i(r(27659)),m=r(44984),g=r(82714),v=i(r(15934)),E=r(85348),y=i(r(94757)),S=a(r(56179)),T=i(r(34535)),A=r(4314),b=r(14366),C=20,P=100,O=200,w=r(28103)({INIT:"INIT",RESUME_ON_RESTART:"RESUME_ON_RESTART",RESUME_WITH_OPEN_TAB:"RESUME_WITH_OPEN_TAB",COMPLETE:"COMPLETE"});class M{constructor(){this.initState(),d.default.on("logout",(()=>{this.initState()}))}initState(){this._offlineMessagePreviewCounter=-1,this._decryptedMessageCount=0,this._decryptionErrorCount=0,this._finishedDownloading=!1,this._hasMessagesToDownload=null,this._status=w.INIT}setStatus(e){e===w.RESUME_WITH_OPEN_TAB?__LOG__(2)`[resume-resume] begin RESUME_WITH_OPEN_TAB`:e===w.RESUME_ON_RESTART?__LOG__(2)`[offline-resume][handler] begin RESUME_ON_RESTART`:e===w.COMPLETE&&(this._status===w.RESUME_WITH_OPEN_TAB?__LOG__(2)`[resume-resume] finished RESUME_WITH_OPEN_TAB`:__LOG__(2)`[offline-resume][handler] finished RESUME_ON_RESTART`),this._status=e}setOfflineMessagePreviewCounter(e){this.isResumeFromRestartComplete()?(__LOG__(2)`[offline-resume][handler] Offline session is complete when receiving offline preview ib.`,this._exceedResumeWithOpenTabLimit(e.message,e.receipt)&&(__LOG__(2)`[offline-resume][handler] restart client due to exceed the LIMIT, message: ${e.message}, receipt: ${e.receipt}`,N()),T.default.restartDetection(),this.setStatus(w.RESUME_WITH_OPEN_TAB)):this._status===w.INIT?(A.OfflineResumeReporter.logOfflinePreviewT(),A.OfflineResumeReporter.logOfflineCount(e),this._offlineMessagePreviewCounter=e.message,this._decryptedMessageCount=0,T.default.restartDetection(),this.setStatus(w.RESUME_ON_RESTART),(0,f.enableMemSignalStore)()):__LOG__(2)`[offline-resume][handler] Received multiple offline preview ib during offline resume.`}getOfflineDeliveryProgress(){return this._finishedDownloading?100:-1===this._offlineMessagePreviewCounter?0:0===this._offlineMessagePreviewCounter?100:Math.min(Math.ceil(100*this._decryptedMessageCount/this._offlineMessagePreviewCounter),100)}isResumeOnSocketDisconnectInProgress(){return this._status===w.RESUME_WITH_OPEN_TAB}isResumeFromRestartComplete(){return this._status!==w.RESUME_ON_RESTART&&this._status!==w.INIT}getHasMessagesToDownload(){return this._hasMessagesToDownload}getFinishedDownloading(){return 100===this.getOfflineDeliveryProgress()}setOfflineSessionComplete(e){var t=this;return(0,n.default)((function*(){return t._status===w.COMPLETE?Promise.resolve():t._status===w.RESUME_WITH_OPEN_TAB?(yield(0,E.doPendingDeviceSync)(),t.setStatus(w.COMPLETE),Promise.resolve()):(t._hasMessagesToDownload=e>0,t._finishedDownloading=0===e,t.setStatus(w.COMPLETE),t._offlineStanzaCountAfterOfflineMarker=0,setTimeout((()=>{t._offlineStanzaCountAfterOfflineMarker>100&&(__LOG__(3)`[offline-resume][handler] ${t._offlineStanzaCountAfterOfflineMarker} received after offline completion marker. Refreshing window due to potential server issue.`,N())}),2e4),d.default.onOfflineProgressUpdate(),0===e?((0,f.enablePersistSignalStore)(),A.OfflineResumeReporter.logOfflineDecryptionErrorCount(0),(0,c.restoreChatsAndMessages)().then((()=>{D()})).catch((e=>{__LOG__(4,!0,new Error,!0)`[offline-resume][handler] _onOfflineComplete: restoreChatsAndMessages failed with error ${e}.`,SEND_LOGS("offline-resume-fatal-error"),v.default.logout()}))):t._onOfflineComplete())}))()}shouldUseOfflineResumeScreen(){return this._offlineMessagePreviewCounter>this._decryptedMessageCount}decryptOfflineMessage(e){return(0,u.decryptE2EPayload)(e).then((e=>(this._decryptedMessageCount=this._decryptedMessageCount+1,e.result===m.E2EProcessResult.RETRY&&(this._decryptionErrorCount=this._decryptionErrorCount+1),e)))}offlineStanzaReceivedAfterCompelete(){this.isResumeFromRestartComplete()&&(this._offlineStanzaCountAfterOfflineMarker=this._offlineStanzaCountAfterOfflineMarker+1)}_onOfflineComplete(){var e=this;return(0,n.default)((function*(){yield(0,p.waitForOfflineMsgThread)(),e._finishedDownloading=!0,d.default.onOfflineProgressUpdate(),A.OfflineResumeReporter.logOfflineDecryptionErrorCount(e._decryptionErrorCount),__LOG__(2)`[offline-resume][handler] _onOfflineComplete: waitForOfflineMsgThread done, total decryption error: ${e._decryptionErrorCount}`,e._decryptionErrorCount=0,yield function(){return R.apply(this,arguments)}(),__LOG__(2)`[offline-resume][handler] _onOfflineComplete: clearOfflineSnapShot done.`,(0,E.doPendingDeviceSync)(),(0,f.enablePersistSignalStore)(),(0,o.promiseLoop)(function(){var e=(0,n.default)((function*(e,t,r){var a=(0,s.delayMs)(S.expBackoff(r,12e4,1e3,.1));try{return yield(0,l.clearDanglingReceipts)(),__LOG__(2)`[offline-resume][handler] runReceiptCleanUpLoop: done.`,e()}catch(t){return __LOG__(2)`[offline-resume][handler] runReceiptCleanUpLoop: failed with error ${t}.`,r>3?(__LOG__(3)`[offline-resume][handler] runReceiptCleanUpLoop: Gave up clean up receipts ${r} tries`,e()):a}}));return function(){return e.apply(this,arguments)}}());try{__LOG__(2)`[offline-resume][handler] _onOfflineComplete: updateOfflineMsgAcks.`,yield(0,g.updateOfflineMsgAcks)(),__LOG__(2)`[offline-resume][handler] _onOfflineComplete: restoreChatsAndMessages.`,yield(0,c.restoreChatsAndMessages)()}catch(e){__LOG__(4,!0,new Error,!0)`[offline-resume][handler] _onOfflineComplete: restoreChatsAndMessages failed with error ${e}.`,SEND_LOGS("offline-resume-fatal-error"),v.default.logout()}D();try{yield(0,b.pruneExpiredMessages)()}catch(e){throw __LOG__(4,void 0,new Error)`[offline-resume][handler] _onOfflineComplete: pruneExpiredMessages message failed with error: ${e}`,e}}))()}_exceedResumeWithOpenTabLimit(e,t){return e+t>O||e>C&&e+t>P}}t.OfflineMessageHandler=M;var I=new M;function R(){return(R=(0,n.default)((function*(){h.default.createSnapshot(),_.default.createSnapshot(),y.default.createSnapshot(),yield Promise.all([h.default.checkpointQueue.wait(),_.default.checkpointQueue.wait(),y.default.checkpointQueue.wait()])}))).apply(this,arguments)}function D(){d.default.readyForMainStreamMode(),A.OfflineResumeReporter.logMainScreenLoadT(),A.OfflineResumeReporter.commit()}function N(){window.location&&window.location.reload&&window.location.reload()}t.default=I},1730:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(52954)),n=r(19129),s=r(35160),o=r(95334),l=a(r(13277)),d=r(830),u=r(25323),c=a(r(37852)),p=r(24606),h=r(89308),f=r(19012);var _=new class{constructor(){this.cache=[],this.checkpointQueue=new n.PromiseQueue,this.lastCheckpointIndex=0,this.snapshotTimer=new s.ShiftTimer((()=>{this.createSnapshot()}))}addOfflineMessage(e){this.cache.push(...e),this.snapshotTimer.isScheduled()||(__LOG__(2)`[offline-resume][msg-cache]: snapshot schedule in ${1e3} ms`,this.snapshotTimer.onOrAfter(1e3))}_addToMessageTable(e,t){var r=this;return(0,i.default)((function*(){for(var a=[],i=e;i<t;i++){var n=r.cache[i].msg;a.push(n)}yield(0,f.storeOfflineMsgs)(a)}))()}_sendAggregateReceipts(e,t){var r=this;return(0,i.default)((function*(){for(var a=new Map,i=[],n=e;n<t;n++){var s=r.cache[n].msg,l=r.cache[n].receiptInfo;if(l){var c=s.id.id,{from:p,author:h}=l,f=a.get(p);f||(f=new Map,a.set(p,f));var _=f.get(h);_||(_=[],f.set(h,_)),_.push(c),i.push({from:String(p),author:String(h),externalId:c})}}var m=String((0,o.unixTime)());Promise.all(Array.from(a.keys()).map((e=>{var t=a.get(e);if(t)return(0,d.sendAggregateReceipts)(e,d.RECEIPT_TYPE.DELIVERY,m,t)}))),yield(0,u.getTable)().createOrReplace({receipts:i})}))()}createSnapshot(){var e=this;this.snapshotTimer.isScheduled()&&this.snapshotTimer.cancel();var t=this.lastCheckpointIndex,r=this.cache.length;if(this.lastCheckpointIndex=r,__LOG__(2)`[offline-resume][msg-cache]: creating snapshot for offline ${t} to ${r}`,t!==r){var a=c.default.generateSnapshot();this.checkpointQueue.enqueue((0,i.default)((function*(){yield e._addToMessageTable(t,r),__LOG__(2)`[offline-resume][msg-cache]: creating snapshot: messages done for ${t} - ${r}`,yield(0,h.getStorage)().lock(["session-store","identity-store","prekey-store","senderkey-store"],(0,i.default)((function*(){yield Promise.all([p.waSignalStore.bulkPutSession(a.sessionUpdate),p.waSignalStore.bulkPutIdentity(a.identityUpdate),p.waSignalStore.bulkPutSenderKey(a.senderKeyUpdate),p.waSignalStore.bulkRmovePreKey(a.preKeyRemove)])}))),__LOG__(2)`[offline-resume][msg-cache]: creating snapshot: signal done for ${t} - ${r}`,yield e._sendAggregateReceipts(t,r),__LOG__(2)`[offline-resume][msg-cache]: creating snapshot: sending receipt done for ${t} - ${r}`,l.default.onOfflineProgressUpdate()})))}}};t.default=_},27659:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(52954)),n=r(19129),s=r(35160),o=a(r(23045)),l=r(15579),d=r(92166),u=r(25054),{ACK:c,ACK_STRING:p}=o.default,h=Object.freeze({[c.RECEIVED]:p.DELIVERY,[c.READ]:p.READ,[c.PLAYED]:p.PLAYED,[c.INACTIVE]:p.INACTIVE}),f=1e3;function _(e){return(0,l.getTable)().bulkCreate(e)}function m(e,t){if(null!=e&&null!=t)return Math.min(e,t);var r=null!=e?e:t;return null!=r?r:void 0}var g=new class{constructor(){this.peerReadCache=[],this.otherReceiptCache=new Map,this.snapshotTimer=new s.ShiftTimer((()=>{this.createSnapshot()})),this.checkpointQueue=new n.PromiseQueue}addOfflinePeerReadReceipt(e,t){this.peerReadCache.push({ts:e,msgKeys:t}),this.snapshotTimer.isScheduled()||(__LOG__(2)`[offline-resume][receipt-cache]: creating snapshot: schedule in ${f} ms`,this.snapshotTimer.onOrAfter(f))}addOfflineReceipt(e,t,r,a){var i,n=(0,u.toUserWid)(r).toString(),s=null!==(i=r.device)&&void 0!==i?i:o.default.DEVICE.PRIMARY_DEVICE;a.forEach((r=>{var a=h[e];if(a){var i=`${r},${n}`,o=this.otherReceiptCache.get(i);o?(a!==h[c.INACTIVE]&&(o[a]=m(o[a],t)),o.deviceDelivered.add(s)):this.otherReceiptCache.set(i,{[a]:t,deviceDelivered:new Set([s])})}else __LOG__(3)`[offline-resume][receipt-cache]: not supported ack type ${e}`})),this.snapshotTimer.isScheduled()||(__LOG__(2)`[offline-resume][receipt-cache]: creating snapshot: schedule in ${f} ms`,this.snapshotTimer.onOrAfter(f))}createSnapshot(){this.snapshotTimer.isScheduled()&&this.snapshotTimer.cancel();var e=Array.from(this.otherReceiptCache),t=this.peerReadCache;__LOG__(2)`[offline-resume][receipt-cache]: creating snapshot for ${e.length} other, ${t.length} peer`,this.checkpointQueue.enqueue((0,i.default)((function*(){var r;yield Promise.all([(r=e,(0,d.getStorage)().lock(["message-info"],function(){var e=(0,i.default)((function*([e]){var t=yield e.bulkGet(r.map((e=>e[0].split(",")))),a=t.map(((e,t)=>{var[a,i]=r[t];if(!i)return null;if(e){var n=i.deviceDelivered;return e.deviceDelivered.forEach((e=>n.add(e))),{delivery:m(e.delivery,i.delivery),read:m(e.read,i.read),played:m(e.played,i.played),msgKey:e.msgKey,receiverUserJid:e.receiverUserJid,deviceDelivered:Array.from(n),deviceNotDelivered:e.deviceNotDelivered.filter((e=>!n.has(e)))}}var[s,o]=a.split(",");return{delivery:i.delivery,read:i.read,played:i.played,msgKey:s,receiverUserJid:o,deviceDelivered:Array.from(i.deviceDelivered),deviceNotDelivered:[]}}));return e.bulkCreateOrReplace(a)}));return function(){return e.apply(this,arguments)}}())),_(t)]),__LOG__(2)`[offline-resume][receipt-cache]: creating snapshot done`}))),this.otherReceiptCache=new Map,this.peerReadCache=[]}};t.default=g},19012:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.storeOfflineMsgs=function(){return f.apply(this,arguments)};var i=a(r(52954)),n=a(r(20468)),s=r(9365),o=r(3710),l=r(44042),d=r(92166),u=r(23443),c=r(43730),p=a(r(23045)),h=r(29351);function f(){return(f=(0,i.default)((function*(e){if(n.default.supportsFeature(n.default.F.MD_BACKEND))try{var{newMsgs:t,replaceMsgs:r,revokeMsgs:a,chatsWithNewOfflineMsg:l}=yield v(e);__LOG__(2)`[offline-resume][msg-cache] storeOfflineMsgs: newMsgs: ${t.length}, replaceMsgs: ${r.length}, revokeMsgs: ${a.length}`;var u=yield _(t),p=yield(0,o.encryptMultipleMsgs)(t,!1);yield(0,c.getTable)().bulkCreateOrReplace(r),yield(0,d.getStorage)().lock(["chat","message","fts-indexing-queue"],function(){var e=(0,i.default)((function*([e,t,r]){yield e.bulkCreateOrMerge(u),yield(0,o.storeEncryptedMessage)(p,l,!1)}));return function(){return e.apply(this,arguments)}}()),yield g(a),yield(0,h.handleOfflineForMessageRange)(e),yield(0,s.checkOrphanMutations)(e.map((e=>e.id.toString())),l)}catch(e){__LOG__(4,void 0,new Error,!0)`[offline-resume] Error: ${e.name}, message: ${e.message}, stack: ${e.stack}`,SEND_LOGS("storeOfflineMsgs-error")}}))).apply(this,arguments)}function _(){return m.apply(this,arguments)}function m(){return(m=(0,i.default)((function*(e){var t=new Map;e.forEach((e=>{var r=e.id,a=r.remote.toString();if(a!==p.default.STATUS_WID&&(0,l.isUnreadTypeMsg)(e)){var i=t.get(a)||{unread:0,t:0};r.fromMe||(i.unread+=1),e.t>i.t&&(i.t=Math.max(e.t,i.t)),t.set(a,i)}}));var r=Array.from(t.keys()),a=(yield(0,u.getTable)().bulkGet(r)).map(((e,a)=>{var i=r[a],n=t.get(i),s=(null==n?void 0:n.unread)||0,o=Math.max(0,e?e.unreadCount:0),l=(null==n?void 0:n.t)||void 0;return e&&null!=e.t&&(null==l||e.t>l)&&(l=e.t),{id:i,unreadCount:o+s,t:l}}));return __LOG__(2)`[offline-resume][msg-cache]: storing chat updates: ${JSON.stringify(a)}`,a}))).apply(this,arguments)}function g(e){var t=[],r=[];return e.forEach((e=>{e.protocolMessageKey&&(t.push(String(e.protocolMessageKey)),r.push(String(e.id)))})),(0,o.processRevokeMsgs)(t,r)}function v(){return E.apply(this,arguments)}function E(){return(E=(0,i.default)((function*(e){var t=yield(0,c.getTable)().bulkGet(e.map((e=>String(e.id))),!1),r=[],a=[],i=[],n=new Set,s=new Map;return e.forEach(((e,o)=>{var d=String(e.id),u=t[o];if(u)if(y(u)){var c=(0,l.convertToMessageRowType)(e);c.t=u.t,c.internalId=u.internalId,c.rowId=u.rowId,a.push(c)}else r.push(e.id.id);else{var p=s.get(d);p&&!y(p)?r.push(e.id.id):"revoke"===e.subtype?i.push(e):(s.set(d,e),n.add(String(e.id.remote)))}})),r.length>0&&__LOG__(2)`[offline-resume] classifyOfflineMsgs: skip for ${r.length} duplicate messages, with id ${r}`,{newMsgs:Array.from(s.values()),chatsWithNewOfflineMsg:Array.from(n),replaceMsgs:a,revokeMsgs:i}}))).apply(this,arguments)}function y(e){return e.type===p.default.MSG_TYPE.UNKNOWN&&"fanout"===e.subtype||e.type===p.default.MSG_TYPE.CIPHERTEXT}},1002:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=g.parse(e);if(t.error)return __LOG__(4,void 0,new Error)`${t.error.toString()} parsing ${e.toString()}`,Promise.reject(t.error);var r=t.success;if(r&&r.refs&&Array.isArray(r.refs)&&6===r.refs.length){var{refs:a,id:i}=r;(0,l.castStanza)((0,n.wap)("iq",{to:n.S_WHATSAPP_NET,type:"result",id:(0,n.CUSTOM_STRING)(i)})),(0,o.generateADVSecretKey)(),_=a,m||(m=new s.ShiftTimer((()=>{if(!(0,c.isRegistered)()&&p.default.online&&u.default.supportsFeature(u.default.F.MD_BACKEND))if(_&&_.length){var e=6===_.length?6e4:2e4,t=_.shift();d.default.set({ref:t,refTTL:e}),f.default.state=f.STATE.UNPAIRED,m&&m.onOrAfter(e)}else m&&m.cancel(),m=null,f.default.state=f.STATE.UNPAIRED_IDLE;else m&&m.cancel(),m=null}))),m.forceRunNow()}else __LOG__(3)`handlePairDevice: wrong pair device result received from server`};var n=r(35773),s=r(35160),o=r(70338),l=r(7017),d=i(r(79435)),u=i(r(20468)),c=r(63191),p=i(r(66622)),h=i(r(45521)),f=a(r(15934)),_=[],m=null,g=new h.default("pairDeviceParser",(e=>{e.assertTag("iq"),e.assertFromServer();var t=[];return e.child("pair-device").forEachChild((e=>{e.assertTag("ref"),t.push(e.contentString())})),{refs:t,id:e.attrString("id")}}))},3073:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return I.apply(this,arguments)};var n=i(r(52954)),s=r(35773),o=r(9557),l=r(76549),d=r(84337),u=r(95334),c=i(r(47677)),p=r(38550),h=r(70338),f=r(7017),_=r(37888),m=i(r(79435)),g=r(446),v=a(r(11247)),E=r(66239),y=i(r(34601)),S=i(r(84161)),T=r(63191),A=i(r(45521)),b=r(24606),C=r(69909),P=r(25054),O=i(r(15934)),w=!1,M=new A.default("pairSuccessParser",(e=>{var t;e.assertTag("iq"),e.assertFromServer();var r=e.attrString("id"),a=e.child("pair-success"),i=null===(t=a.maybeChild("platform"))||void 0===t?void 0:t.maybeAttrString("name"),n=a.child("device"),s=a.child("device-identity").contentBytes(),o=a.maybeChild("biz"),l=o?o.attrString("name"):"";return{wid:n.attrDeviceWid("jid"),id:r,deviceIdentityBytes:s,businessName:l,platform:i}}));function I(){return(I=(0,n.default)((function*(e){if(!w&&!(0,T.isRegistered)()){w=!0;var t=(0,u.unixTime)(),r=M.parse(e);if(r.error)return __LOG__(4,void 0,new Error)`${r.error.toString()} parsing ${e.toString()}`,w=!1,Promise.reject(r.error);try{(0,_.resetCompanionReg)(),(0,E.setGlobalSecurityNotifications)(!0),(0,E.setHistorySyncEarliestDate)(t);var a=r.success,{id:i,wid:n,deviceIdentityBytes:A,platform:I}=a;m.default.blockStoreAdds=!1,I&&(m.default.platform=I);var R=(0,o.decodeProto)(p.ADVSignedDeviceIdentityHMACSpec,A),D=R.details,N=R.hmac;(0,c.default)(null!=D&&null!=N,"ADVSignedDeviceIdentityHMAC should not have empty details or hmac");var L=(0,h.getADVSecretKey)(),k=yield new y.default(L).sign(D);if((0,d.encodeB64)(k)!==(0,d.encodeB64)(N))return(0,f.castStanza)((0,s.wap)("iq",{to:s.S_WHATSAPP_NET,type:"error",id:(0,s.CUSTOM_STRING)(i)},(0,s.wap)("error",{code:"401",text:"not-authorized"}))),(0,_.logoutAfterValidationFail)(),void(w=!1);var U=(0,o.decodeProto)(p.ADVSignedDeviceIdentitySpec,D),G=U.accountSignatureKey;(0,c.default)(null!=G,"accountSignatreKey should not be null");var F=U.accountSignature;(0,c.default)(null!=F,"accountSignature should not be null");var x=yield b.waSignalStore.getRegistrationInfo();if((0,c.default)(null!=x,"Empty regInfo"),v.initDeviceLinkEvent(G,x.identityKeyPair.pubKey,t),v.setDeviceLinkPairStage(S.default.MD_LINK_DEVICE_COMPANION_STAGE.PAIR_SUCCESS_RECEIVED),!(0,h.verifyDeviceIdentityAccountSignature)(U,x.identityKeyPair.pubKey))return(0,f.castStanza)((0,s.wap)("iq",{to:s.S_WHATSAPP_NET,type:"error",id:(0,s.CUSTOM_STRING)(i)},(0,s.wap)("error",{code:"401",text:"not-authorized"}))),v.commitDeviceLinkEvent(401),(0,_.logoutAfterValidationFail)(),void(w=!1);U.deviceSignature=(0,h.generateDeviceSignature)(U,x.identityKeyPair,G),yield b.waSignalStore.putIdentity((0,C.createSignalAddress)((0,P.toUserWid)(n)).toString(),(0,C.bufferToStr)((0,g.toSignalCurvePubKey)(G))),yield(0,h.setADVSignedIdentity)(U);var B=(0,o.decodeProto)(p.ADVDeviceIdentitySpec,U.details).keyIndex;(0,c.default)(null!=B,"keyIndex should not be null"),U.accountSignatureKey=void 0;var Y=(0,l.encodeProto)(p.ADVSignedDeviceIdentitySpec,U).readByteArray();(0,f.castStanza)((0,s.wap)("iq",{to:s.S_WHATSAPP_NET,type:"result",id:(0,s.CUSTOM_STRING)(i)},(0,s.wap)("pair-device-sign",null,(0,s.wap)("device-identity",{"key-index":(0,s.INT)(B)},Y)))),v.setDeviceLinkPairStage(S.default.MD_LINK_DEVICE_COMPANION_STAGE.PAIR_DEVICE_SIGN_SENT),(0,E.setMdOptedIn)(!0),(0,E.setMe)(n),(0,T.getInitialHistorySyncComplete)()||(0,_.startInitialHistorySyncTimeout)(),w=!1}catch(e){__LOG__(4,!0,new Error,!0)`error in handlePairSuccess, ${e}`,SEND_LOGS("error in handlePairSuccess"),(0,v.commitDeviceLinkEvent)(-1),O.default.logout()}}}))).apply(this,arguments)}},7222:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getAmount1000AndCurrency=function(e){return function(e){return e.hasChild("amount")?function(e){e.assertTag("money");var t=parseFloat(e.attrString("value")),a=e.attrString("currency"),i=e.maybeAttrInt("offset");return{currency:a,amount1000:t*r/(null!=i&&0!==i?i:r)}}(e.child("amount").child("money")):{amount1000:parseFloat(e.attrString("amount"))*r,currency:e.attrString("currency")}}(e)};var r=1e3},43947:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return h.apply(this,arguments)},t.parseNotificationPaymentInfo=f;var i=a(r(52954)),n=r(43250),s=r(245),o=a(r(36169)),l=a(r(30528)),d=a(r(21830)),u=a(r(47119)),c=r(47138),p=r(65219);function h(){return(h=(0,i.default)((function*(e){var t=u.default.parse(e);if(t.error)return __LOG__(2)`${t.error.toString()} parsing ${e.toString()}`,Promise.reject(t.error);if(!t.success)return __LOG__(2)`No transaction node in the payment notification`,Promise.resolve();var r=t.success,a=(0,d.default)(r.msgKey,"info.msgKey"),i=l.default.get(a),p=i?(0,c.unproxy)(i):yield(0,n.getMsgByMsgKey)(a);if(!p)return Promise.reject(new Error(`handlePaymentNotification: no msg found for id ${(0,d.default)(r.msgKey,"info.msgKey").toString()}`));f(p,r);var h=[p instanceof o.default?p.toJSON():p];return(0,s.storeMessages)(h)}))).apply(this,arguments)}function f(e,t){t&&(null!=t.status&&(e.paymentStatus=(0,p.getPaymentWebStatus)(t.status,t.type),e.paymentTxnStatus=(0,p.getPaymentTxnWebStatus)(t.status)),e.paymentCurrency=t.currency||"",e.paymentAmount1000=(0,d.default)(t.amount1000,"mdPaymentInfo.amount1000"),e.paymentMessageReceiverJid=t.receiver,e.paymentTransactionTimestamp=(0,d.default)(t.ts,"mdPaymentInfo.ts"))}},20982:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(43947)).default;t.default=i},47119:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.parseTransactionNode=d,t.default=void 0;var i=r(7222),n=r(66239),s=a(r(83746)),o=a(r(45521)),l=r(65219);function d(e){var t=void 0,r=void 0,a=(0,n.getMeUser)(),o=e.attrWid("sender"),d=e.attrWid("receiver"),u=a.equals(o);e.hasAttr("group")?(t=e.attrWid("group"),r=e.attrWid("sender")):t=u?d:o;var c=new s.default({id:e.attrString("message-id"),fromMe:u,remote:t,participant:r}),p=(0,l.getPaymentTransactionType)(e.attrString("transaction-type"),c.fromMe),{amount1000:h,currency:f}=(0,i.getAmount1000AndCurrency)(e);return{receiver:d,currency:f,amount1000:h,status:(0,l.getNotificationTransactionStatus)(p,e.attrString("status")),ts:e.attrInt("ts"),type:p,msgKey:c}}var u=new o.default("paymentNotificationParser",(e=>e.hasChild("transaction")?d(e.child("transaction")):null));t.default=u},65219:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getPaymentWebStatus=function(e,t){if(null==e)return a.PaymentInfoStatus.UNKNOWN_STATUS;switch(e){case n.SEND_PAY_INIT:case n.SEND_PAY_PENDING:case n.RECV_PAY_INIT:case n.RECV_PAY_PENDING:case n.RECV_PAY_RETRY_ON_FAILURE:case n.REQUEST_PAY_INIT:return a.PaymentInfoStatus.PROCESSING;case n.SEND_PAY_PENDING_RECEIVER:case n.SEND_PAY_FAILURE_RECEIVER:return a.PaymentInfoStatus.SENT;case n.REQUEST_PAY_SUCCESS:return t===i.TYPE_P2P_REQ_SENT?a.PaymentInfoStatus.WAITING_FOR_PAYER:a.PaymentInfoStatus.WAITING;case n.RECV_PAY_PENDING_SETUP:return a.PaymentInfoStatus.NEED_TO_ACCEPT;case n.SEND_PAY_SUCCESS:case n.RECV_PAY_SUCCESS:case n.REQUEST_PAY_FULFILLED:return a.PaymentInfoStatus.COMPLETE;case n.SEND_PAY_FAILURE:case n.SEND_PAY_FAILURE_RISK:case n.SEND_PAY_PENDING_REFUND:case n.SEND_PAY_REFUND_PENDING:case n.SEND_PAY_REFUND_FAILED:case n.SEND_PAY_REFUND_FAILED_PROCESSING:case n.RECV_PAY_FAILURE:case n.REQUEST_PAY_FAILED:case n.REQUEST_PAY_FAILED_RISK:return a.PaymentInfoStatus.COULD_NOT_COMPLETE;case n.SEND_PAY_REFUNDED:return a.PaymentInfoStatus.REFUNDED;case n.RECV_PAY_EXPIRED:case n.REQUEST_PAY_EXPIRED:case n.SEND_PAY_AUTH_CANCELED:case n.SEND_PAY_AUTH_CANCEL_FAILED:case n.SEND_PAY_AUTH_CANCEL_FAILED_PROCESSING:return a.PaymentInfoStatus.EXPIRED;case n.REQUEST_PAY_REJECTED:return a.PaymentInfoStatus.REJECTED;case n.REQUEST_PAY_CANCELLED:return a.PaymentInfoStatus.CANCELLED;case n.STATUS_UNSET:case n.REQUEST_PAY_CANCELLING:default:return a.PaymentInfoStatus.UNKNOWN_STATUS}},t.getNotificationTransactionStatus=function(e,t){if(!t)return n.STATUS_UNSET;var r=t.toUpperCase();switch(e){case i.TYPE_P2P_SENT:case i.TYPE_P2M_SENT:case i.TYPE_DEPOSIT:switch(r){case o.PENDING_RECEIVER_SETUP:return n.SEND_PAY_PENDING_RECEIVER;case o.FAILED_DA:return n.SEND_PAY_PENDING;case o.REFUND_FAILED_DA:return n.SEND_PAY_REFUND_PENDING;case o.FAILED_RISK:return n.SEND_PAY_FAILURE_RISK;case o.INITIAL:return n.SEND_PAY_INIT;case o.SUCCESS:case o.COMPLETED:return n.SEND_PAY_SUCCESS;case o.FAILURE:case o.FAILED:return n.SEND_PAY_FAILURE;case o.REFUNDED:return n.SEND_PAY_REFUNDED;case o.REFUND_FAILED:return n.SEND_PAY_REFUND_FAILED;case o.FAILED_RECEIVER_PROCESSING:return n.SEND_PAY_FAILURE_RECEIVER;case o.REFUND_FAILED_PROCESSING:return n.SEND_PAY_REFUND_FAILED_PROCESSING;case o.FAILED_DA_FINAL:return n.SEND_PAY_PENDING_REFUND;case o.AUTH_CANCEL_FAILED_PROCESSING:return n.SEND_PAY_AUTH_CANCEL_FAILED_PROCESSING;case o.AUTH_CANCEL_FAILED:return n.SEND_PAY_AUTH_CANCEL_FAILED;case o.AUTH_CANCELED:return n.SEND_PAY_AUTH_CANCELED;case o.EXPIRED:return n.SEND_PAY_EXPIRED;case o.IN_REVIEW:return n.SEND_PAY_IN_REVIEW;case o.PENDING:return n.SEND_PAY_PENDING_PROCESSING;case o.CANCELED:return n.SEND_PAY_USER_CANCELED}break;case i.TYPE_P2P_RCVD:case i.TYPE_P2M_RCVD:switch(r){case o.PENDING_SETUP:return n.RECV_PAY_PENDING_SETUP;case o.FAILED_DA:return n.RECV_PAY_PENDING;case o.FAILED_PROCESSING:return n.RECV_PAY_RETRY_ON_FAILURE;case o.SUCCESS:case o.COMPLETED:return n.RECV_PAY_SUCCESS;case o.FAILURE:case o.FAILED:return n.RECV_PAY_FAILURE;case o.EXPIRED:return n.RECV_PAY_EXPIRED;case o.FAILED_RISK:return n.RECV_PAY_FAILURE_RISK;case o.WITHDRAWAL_PROCESSING:return n.RECV_PAY_WITHDRAWAL_PROCESSING;case o.WITHDRAWAL_FAILURE:return n.RECV_PAY_WITHDRAWAL_FAILURE;case o.WITHDRAWAL_PERMANENT_FAILED:return n.RECV_PAY_WITHDRAWAL_PERMANENT_FAILED;case o.CANCELED:return n.RECV_PAY_SENDER_CANCELED}break;case i.TYPE_P2P_REQ_SENT:case i.TYPE_P2P_REQ_RCVD:switch(r){case o.COLLECT_SUCCESS:return n.REQUEST_PAY_SUCCESS;case o.COLLECT_FAILED:return n.REQUEST_PAY_FAILED;case o.COLLECT_FAILED_RISK:return n.REQUEST_PAY_FAILED_RISK;case o.COLLECT_REJECTED:return n.REQUEST_PAY_REJECTED;case o.COLLECT_EXPIRED:return n.REQUEST_PAY_EXPIRED;case o.COLLECT_CANCELED:return n.REQUEST_PAY_CANCELLED}break;case i.TYPE_P2P_REQ_SCHEDULED_PAYMENT_RCVD:switch(r){case o.COLLECT_SUCCESS:return n.REQUEST_PAY_SCHEDULED_PAYMENT_SUCCESS;case o.AUTH_SUCCESS:return n.SEND_PAY_AUTH_SUCCESS}break;case i.TYPE_REFUND:switch(r){case o.SUCCESS:case o.COMPLETED:return n.RECV_PAY_SUCCESS}break;case i.TYPE_WITHDRAWAL:switch(r){case o.PENDING:return n.WITHDRAWAL_PENDING;case o.IN_REVIEW:return n.WITHDRAWAL_IN_REVIEW;case o.SUCCESS:case o.COMPLETED:return n.WITHDRAWAL_SUCCESS;case o.FAILED:case o.DECLINED:return n.WITHDRAWAL_FAILED;case o.CANCELED:return n.WITHDRAWAL_USER_CANCELED;case o.EXPIRED:return n.WITHDRAWAL_EXPIRED;case o.WITHDRAWAL_ACTIVE:return n.WITHDRAWAL_ACTIVE}break;default:return n.STATUS_UNSET}return n.STATUS_UNSET},t.getPaymentTxnWebStatus=function(e){if(null==e)return a.PaymentInfoTxnStatus.UNKNOWN;switch(e){case n.RECV_PAY_EXPIRED:case n.SEND_PAY_EXPIRED:return a.PaymentInfoTxnStatus.EXPIRED_TXN;case n.RECV_PAY_FAILURE:case n.SEND_PAY_FAILURE:return a.PaymentInfoTxnStatus.FAILED;case n.RECV_PAY_INIT:case n.SEND_PAY_INIT:return a.PaymentInfoTxnStatus.INIT;case n.RECV_PAY_PENDING_SETUP:return a.PaymentInfoTxnStatus.PENDING_SETUP;case n.RECV_PAY_PENDING:case n.SEND_PAY_PENDING:return a.PaymentInfoTxnStatus.FAILED_DA;case n.RECV_PAY_RETRY_ON_FAILURE:return a.PaymentInfoTxnStatus.FAILED_PROCESSING;case n.RECV_PAY_SUCCESS:case n.SEND_PAY_SUCCESS:case n.REQUEST_PAY_FULFILLED:return a.PaymentInfoTxnStatus.SUCCESS;case n.REQUEST_PAY_CANCELLED:return a.PaymentInfoTxnStatus.COLLECT_CANCELED;case n.REQUEST_PAY_CANCELLING:return a.PaymentInfoTxnStatus.COLLECT_CANCELLING;case n.REQUEST_PAY_EXPIRED:return a.PaymentInfoTxnStatus.COLLECT_EXPIRED;case n.REQUEST_PAY_FAILED_RISK:return a.PaymentInfoTxnStatus.COLLECT_FAILED_RISK;case n.REQUEST_PAY_FAILED:return a.PaymentInfoTxnStatus.COLLECT_FAILED;case n.REQUEST_PAY_INIT:return a.PaymentInfoTxnStatus.COLLECT_INIT;case n.REQUEST_PAY_REJECTED:return a.PaymentInfoTxnStatus.COLLECT_REJECTED;case n.REQUEST_PAY_SUCCESS:return a.PaymentInfoTxnStatus.COLLECT_SUCCESS;case n.SEND_PAY_AUTH_CANCELED:return a.PaymentInfoTxnStatus.AUTH_CANCELED;case n.SEND_PAY_AUTH_CANCEL_FAILED_PROCESSING:return a.PaymentInfoTxnStatus.AUTH_CANCEL_FAILED_PROCESSING;case n.SEND_PAY_AUTH_CANCEL_FAILED:return a.PaymentInfoTxnStatus.AUTH_CANCEL_FAILED;case n.SEND_PAY_FAILURE_RECEIVER:return a.PaymentInfoTxnStatus.FAILED_RECEIVER_PROCESSING;case n.SEND_PAY_FAILURE_RISK:case n.RECV_PAY_FAILURE_RISK:return a.PaymentInfoTxnStatus.FAILED_RISK;case n.SEND_PAY_PENDING_RECEIVER:return a.PaymentInfoTxnStatus.PENDING_RECEIVER_SETUP;case n.SEND_PAY_PENDING_REFUND:return a.PaymentInfoTxnStatus.FAILED_DA_FINAL;case n.SEND_PAY_REFUNDED:return a.PaymentInfoTxnStatus.REFUNDED_TXN;case n.SEND_PAY_REFUND_FAILED_PROCESSING:return a.PaymentInfoTxnStatus.REFUND_FAILED_PROCESSING;case n.SEND_PAY_REFUND_FAILED:return a.PaymentInfoTxnStatus.REFUND_FAILED;case n.SEND_PAY_REFUND_PENDING:return a.PaymentInfoTxnStatus.REFUND_FAILED_DA;case n.SEND_PAY_IN_REVIEW:return a.PaymentInfoTxnStatus.IN_REVIEW;case n.STATUS_UNSET:default:return a.PaymentInfoTxnStatus.UNKNOWN}},t.getPaymentTransactionType=function(e,t){if(e){var r=e.toLowerCase();switch(r){case s.TYPE_P2P:return t?i.TYPE_P2P_SENT:i.TYPE_P2P_RCVD;case s.TYPE_P2M:return t?i.TYPE_P2M_SENT:i.TYPE_P2M_RCVD;case s.TYPE_P2M_PAYOUT:return i.TYPE_P2M_PAYOUT;case s.TYPE_DEPOSIT:return i.TYPE_DEPOSIT;case s.TYPE_REFUND:return i.TYPE_REFUND;case s.TYPE_WITHDRAWAL:return i.TYPE_WITHDRAWAL;default:__LOG__(2)`parsePaymentTransactionType payment transaction string=${r}`}}return t?i.TYPE_P2P_SENT:i.TYPE_P2P_RCVD},t.PaymentTransactionStatusServerString=t.PaymentTransactionTypeServerString=t.NotificationTransactionStatus=t.PaymentTransactionType=void 0;var a=r(94781),i=r(28103)({TYPE_UNSET:0,TYPE_P2P_SENT:1,TYPE_P2P_RCVD:2,TYPE_P2P_GRP:3,TYPE_P2P_NO_INFO:4,TYPE_FUTURE:5,TYPE_P2P_REQ_SENT:10,TYPE_P2P_REQ_RCVD:20,TYPE_P2P_REQ_SCHEDULED_PAYMENT_RCVD:21,TYPE_P2P_REQ_GRP:30,TYPE_P2M_SENT:100,TYPE_P2M_RCVD:200,TYPE_P2M_PAYOUT:300,TYPE_MISSING_DETAILS:400,TYPE_DEPOSIT:500,TYPE_REFUND:600,TYPE_WITHDRAWAL:700});t.PaymentTransactionType=i;var n=r(28103)({STATUS_UNSET:0,REQUEST_PAY_INIT:11,REQUEST_PAY_SUCCESS:12,REQUEST_PAY_FAILED:13,REQUEST_PAY_FAILED_RISK:14,REQUEST_PAY_REJECTED:15,REQUEST_PAY_EXPIRED:16,REQUEST_PAY_FULFILLED:17,REQUEST_PAY_CANCELLED:18,REQUEST_PAY_CANCELLING:19,REQUEST_PAY_SCHEDULED_PAYMENT_SUCCESS:20,RECV_PAY_INIT:101,RECV_PAY_PENDING_SETUP:102,RECV_PAY_PENDING:103,RECV_PAY_RETRY_ON_FAILURE:104,RECV_PAY_FAILURE:105,RECV_PAY_SUCCESS:106,RECV_PAY_EXPIRED:107,RECV_PAY_FAILURE_RISK:108,RECV_PAY_WITHDRAWAL_PROCESSING:109,RECV_PAY_WITHDRAWAL_FAILURE:110,RECV_PAY_WITHDRAWAL_PERMANENT_FAILED:111,RECV_PAY_SENDER_CANCELED:112,SEND_PAY_INIT:401,SEND_PAY_PENDING_RECEIVER:402,SEND_PAY_PENDING:403,SEND_PAY_REFUND_PENDING:404,SEND_PAY_SUCCESS:405,SEND_PAY_FAILURE:406,SEND_PAY_FAILURE_RISK:407,SEND_PAY_REFUNDED:408,SEND_PAY_REFUND_FAILED:409,SEND_PAY_FAILURE_RECEIVER:410,SEND_PAY_REFUND_FAILED_PROCESSING:411,SEND_PAY_PENDING_REFUND:412,SEND_PAY_AUTH_CANCEL_FAILED_PROCESSING:413,SEND_PAY_AUTH_CANCEL_FAILED:414,SEND_PAY_AUTH_CANCELED:415,SEND_PAY_EXPIRED:416,SEND_PAY_AUTH_SUCCESS:417,SEND_PAY_AUTH_SUCCESS_CANCELING:418,SEND_PAY_IN_REVIEW:419,SEND_PAY_PENDING_PROCESSING:420,SEND_PAY_USER_CANCELED:421,WITHDRAWAL_INIT:601,WITHDRAWAL_PENDING:602,WITHDRAWAL_IN_REVIEW:603,WITHDRAWAL_SUCCESS:604,WITHDRAWAL_FAILED:605,WITHDRAWAL_USER_CANCELED:606,WITHDRAWAL_EXPIRED:607,WITHDRAWAL_ACTIVE:608});t.NotificationTransactionStatus=n;var s={TYPE_P2P:"p2p",TYPE_P2M:"p2m",TYPE_P2M_PAYOUT:"payout",TYPE_WITHDRAWAL:"withdrawal",TYPE_DEPOSIT:"deposit",TYPE_REFUND:"refund"};t.PaymentTransactionTypeServerString=s;var o={PENDING_RECEIVER_SETUP:"PENDING_RECEIVER_SETUP",PENDING_SETUP:"PENDING_SETUP",PENDING:"PENDING",INITIAL:"INITIAL",SUCCESS:"SUCCESS",COMPLETED:"COMPLETED",IN_REVIEW:"IN_REVIEW",FAILED:"FAILED",DECLINED:"DECLINED",FAILURE:"FAILURE",FAILED_RISK:"FAILED_RISK",FAILED_PROCESSING:"FAILED_PROCESSING",FAILED_RECEIVER_PROCESSING:"FAILED_RECEIVER_PROCESSING",REFUND_FAILED_PROCESSING:"REFUND_FAILED_PROCESSING",REFUNDED:"REFUNDED",REFUND_FAILED:"REFUND_FAILED",EXPIRED:"EXPIRED",CANCELED:"CANCELLED",AUTH_SUCCESS:"AUTH_SUCCESS",AUTH_CANCELED:"AUTH_CANCELED",AUTH_CANCEL_FAILED_PROCESSING:"AUTH_CANCEL_FAILED_PROCESSING",AUTH_CANCEL_FAILED:"AUTH_CANCEL_FAILED",COLLECT_SUCCESS:"COLLECT_SUCCESS",COLLECT_FAILED:"COLLECT_FAILED",COLLECT_REJECTED:"COLLECT_REJECTED",COLLECT_EXPIRED:"COLLECT_EXPIRED",COLLECT_CANCELED:"COLLECT_CANCELED",FAILED_DA:"FAILED_DA",FAILED_DA_FINAL:"FAILED_DA_FINAL",REFUND_FAILED_DA:"REFUND_FAILED_DA",COLLECT_FAILED_RISK:"COLLECT_FAILED_RISK",WITHDRAWAL_PROCESSING:"WITHDRAWAL_PROCESSING",WITHDRAWAL_FAILURE:"WITHDRAWAL_FAILURE",WITHDRAWAL_PERMANENT_FAILED:"WITHDRAWAL_PERMANENT_FAILED",WITHDRAWAL_ACTIVE:"WITHDRAWAL_ACTIVE"};t.PaymentTransactionStatusServerString=o},63976:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var r=d.parse(e);if(r.error)return __LOG__(4,void 0,new Error)`${r.error.toString()} parsing ${e.toString()}`,Promise.reject(r.error);var a=r.success,n=(0,i.wap)("ack",{to:i.S_WHATSAPP_NET,id:(0,i.CUSTOM_STRING)(a.stanzaId),class:"notification"});return l.has(t)?n:(l.add(t),s.waSignalStore.setServerHasPreKeys(!1),(0,o.uploadPreKeys)().then((()=>n)).finally((()=>{l.delete(t)})))};var i=r(35773),n=a(r(45521)),s=r(24606),o=r(52663),l=new Set,d=new n.default("lowKeyParser",(e=>(e.assertTag("notification"),e.assertAttr("type","encrypt"),e.assertFromServer(),{stanzaId:e.attrString("id"),numRemaining:e.child("count").attrInt("value")})))},67003:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=n.parse(e);if(t.error)return __LOG__(4,void 0,new Error)`${t.error.toString()} parsing ${e.toString()}`,Promise.reject(t.error);return(0,i.default)(t.success)};var i=a(r(36900)),n=new(a(r(45521)).default)("incomingPresenceParser",(e=>{e.assertTag("presence");var t=e.attrEnumOrDefault("type",{available:"available",unavailable:"unavailable",unsubscribe:"unsubscribe"},"available"),r="deny"===e.maybeAttrString("last")||void 0,a=void 0;return"unavailable"===t&&(e.hasAttr("last")?["deny","none","error"].includes(e.attrString("last"))||(a=e.attrTime("last")):a=Date.now()),{id:e.attrChatWid("from"),type:t,t:a,deny:r}}))},64504:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=p.parse(e);if(t.error)return __LOG__(4,void 0,new Error)`${t.error.toString()} parsing ${e.toString()}`,Promise.reject(t.error);var r=t.success,a=Promise.resolve();if(r.jid){var l=r.jid;switch(r.type){case"delete":case"set":var h="delete"===r.type?d.PROFILE_PIC_COMMAND.REMOVE:d.PROFILE_PIC_COMMAND.SET;a=(0,u.changeProfilePicThumb)(l,h).then((()=>{if(!l.isGroup())return Promise.resolve();var e=(0,s.genGroupPicChangeNotificationMsg)(r.jid,h,r.ts,r.author||(0,n.getMeUser)(),r.stanzaId);return(0,o.handleSingleMsgMD)(r.jid,e)}));break;case"request":break;default:__LOG__(3)`Invalid type received`}}return a.then((()=>(0,i.wap)("ack",{id:(0,i.CUSTOM_STRING)(r.stanzaId),to:(0,c.JID)(r.from),class:"notification",type:"picture"})))};var i=r(35773),n=r(66239),s=r(63726),o=r(62711),l=a(r(45521)),d=r(56160),u=r(30229),c=r(29020),p=new l.default("incomingProfilePicNotificationParser",(e=>{var t,r;if(e.assertTag("notification"),e.hasChild("delete"))t="delete",r=e.child("delete");else if(e.hasChild("set"))t="set",r=e.child("set");else{if(!e.hasChild("request"))return e.throw("Expected child type to be one of: set, delete, request");t="request",(r=e.child("request")).assertAttrIsMe("jid")}var a=e.attrString("id");return r.hasAttr("jid")?{type:t,from:e.attrChatWid("from"),jid:r.attrChatWid("jid"),author:r.hasAttr("author")?r.attrUserWid("author"):null,ts:e.attrTime("t"),rawTs:e.attrString("t"),stanzaId:a,picId:"set"===t?r.attrInt("id",1):0}:{from:e.attrUserWid("from"),jid:null,type:t,hash:r.attrString("hash"),stanzaId:a}}))},60836:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.handleMessageRetryRequest=function(){return _.apply(this,arguments)},t.handleVoipRetryRequest=function(e){return m(e).then((e=>null!=e))};var i=a(r(52954)),n=r(35773),s=a(r(23045)),o=r(9641),l=r(66239),d=a(r(84161)),u=a(r(39513)),c=r(62662),p=r(45822),h=r(29020),f=r(25054);function _(){return(_=(0,i.default)((function*(e){var t=u.default.parse(e);if(t.error)throw __LOG__(4,void 0,new Error)`${t.error.toString()} parsing ${e.toString()}`,new Error(t.error);var r=t.success,{from:a,participant:i,recipient:s,retryCount:o,stanzaId:l}=r;if(null==l)throw __LOG__(3)`Received null stanzaID when handling message retry request`,new Error("Received null stanzaID when handling message retry request");var d=(0,n.wap)("ack",{id:(0,n.CUSTOM_STRING)(l),to:(0,h.JID)(a),participant:i?(0,h.DEVICE_JID)(i):n.DROP_ATTR,class:"receipt",type:"retry"}),f=yield m(r);if(null==f)return d;var{originalMsgId:_,chat:g,requester:v}=f;try{var E=yield(0,c.getMsgIfAuthorized)(_,g,v);if(!E)return __LOG__(3)`handleMessageRetryRequest msg retry not authorized`,d;yield(0,p.sendRetry)(a,i,s,E,o)}catch(e){__LOG__(3)`handleMessageRetryRequest error: ${e}`}return d}))).apply(this,arguments)}function m(){return g.apply(this,arguments)}function g(){return(g=(0,i.default)((function*(e){var{originalMsgId:t,from:r,participant:a,recipient:i,retryCount:n,offline:l}=e;if(n>=s.default.RETRY.MAX_RETRY)__LOG__(2)`handleRetryRequest refusing retry attempt #${n}`;else{var u=v(r,i);if(u){var p=u.isUser()?r:a;if(p){var h=p.device||0;try{return(yield(0,o.hasDevice)(p,h))?(yield(0,c.updateLocalSession)(u,e),{originalMsgId:t,chat:u,requester:p}):(__LOG__(3)`handleRetryRequest: no device ${h} found for ${p.user} for incoming retry request .`,void new d.default.MdRetryFromUnknownDevice({offline:l,senderType:h===s.default.DEVICE.PRIMARY_DEVICE?d.default.DEVICE_TYPE.PRIMARY:d.default.DEVICE_TYPE.COMPANION}).commit())}catch(e){__LOG__(3)`handleRetryRequest error: ${e}`}}else __LOG__(3)`handleRetryRequest: no requester found for incoming retry request.`}else __LOG__(3)`handleRetryRequest: no chat found for incoming retry request.`}}))).apply(this,arguments)}function v(e,t){return e.isUser()?(0,f.toUserWid)(e).equals((0,l.getMeUser)())?t||(__LOG__(3)`getActualChatId: from is a peer device, but without recipient`,null):(0,f.toUserWid)(e):e}},39513:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=new(a(r(45521)).default)("retryRequestParser",(e=>{e.assertTag("receipt"),e.assertAttr("type","retry"),e.hasAttr("to")&&e.assertAttrIsMe("to");var t=e.attrWid("from"),r=e.hasAttr("participant")?e.attrDeviceWid("participant"):null,a=e.hasAttr("recipient")?e.attrUserWid("recipient"):null,i=e.child("retry"),n=e.maybeChild("keys"),s=null;if(null!=n){var o,l=n.child("skey"),d=n.child("key");s={identity:n.child("identity").contentBytes(32),deviceIdentity:null===(o=n.maybeChild("device-identity"))||void 0===o?void 0:o.contentBytes(),skey:{id:l.child("id").contentUint(3),pubkey:l.child("value").contentBytes(32),signature:l.child("signature").contentBytes(64)},key:{id:d.child("id").contentUint(3),pubkey:d.child("value").contentBytes(32)}}}return{stanzaId:e.attrString("id"),originalMsgId:i.attrString("id"),ts:e.attrTime("t"),retryCount:i.hasAttr("count")?i.attrInt("count"):0,regId:e.child("registration").contentUint(4),offline:e.hasAttr("offline"),from:t,participant:r,recipient:a,keyBundle:s}}));t.default=i},62662:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.getMsgIfAuthorized=function(){return g.apply(this,arguments)},t.processKeyBundle=v,t.updateLocalSession=function(){return y.apply(this,arguments)};var i=a(r(70417)),n=a(r(52954)),s=a(r(23045)),o=r(66239),l=r(59763),d=r(245),u=a(r(36169)),c=a(r(83746)),p=r(61333),h=r(7574),f=r(25054);function _(){return m.apply(this,arguments)}function m(){return(m=(0,n.default)((function*(e){var t=r(30528).default.get(e);if(t&&t.type!==s.default.MSG_TYPE.REVOKED)return t;var a=yield(0,d.getMsgByMsgKey)(e);return a?new u.default(a):null}))).apply(this,arguments)}function g(){return(g=(0,n.default)((function*(e,t,r){var a=new c.default({id:e,remote:t,fromMe:!0,participant:t.isUser()?void 0:(0,o.getMeUser)()}),i=yield _(a);return i?(yield(0,l.isRetryEligible)(i.id,r))?i:null:(__LOG__(3)`getMsgIfAuthorized: can not find msg ${a.toString()}.`,null)}))).apply(this,arguments)}function v(){return E.apply(this,arguments)}function E(){return(E=(0,n.default)((function*(e,t,r,a,n){return null!=r&&e&&e.key?n?null==a?(__LOG__(2)`processKeyBundle: missing session for retry`,yield h.Session.deleteRemoteInfo(t),!1):a!==r?(__LOG__(2)`processKeyBundle: delete session because reg does not match, saved: ${a}, received: ${r}`,yield h.Session.deleteRemoteInfo(t),!1):(__LOG__(2)`processKeyBundle: update local session with the retry key bundle`,yield h.Session.createSignalSession((0,i.default)({wid:t,regId:r},e)),!0):(__LOG__(2)`processKeyBundle: update local session with the retry key bundle`,yield h.Session.createSignalSession((0,i.default)({wid:t,regId:r},e)),!0):(__LOG__(2)`processKeyBundle: skip due to missing key bundle`,!1)}))).apply(this,arguments)}function y(){return(y=(0,n.default)((function*(e,t){var{from:a,keyBundle:i,offline:n,originalMsgId:l,participant:d,regId:u,retryCount:c}=t,_=d||a;if(__LOG__(2)`updateLocalSession: retryCount: ${c}, offline: ${n.toString()}, has keyBundle: ${(!!i).toString()}`,e.isGroup()){var m=r(85030).default.get(e);m&&_&&(0,p.markForgetSenderKey)(m.id,[_])}var g=yield h.Session.getRemoteRegId(_);if((0,f.toUserWid)(_).equals((0,o.getMeUser)())&&g!==u)throw new Error(`updateLocalSession: detect registration Id change remote: ${u}, local: ${g} for peer device`);return(yield v(i,_,u,g,n))||null!=g&&g!==u&&(__LOG__(2)`updateLocalSession: delete session because reg does not match, saved: ${g}, received: ${g}`,yield h.Session.deleteRemoteInfo(_)),c===s.default.RETRY.VALIDATE_OLD_SESSION?h.Session.saveSessionBaseKey(_,l):c>s.default.RETRY.VALIDATE_OLD_SESSION&&(yield h.Session.hasSameBaseKey(_,l))?(__LOG__(2)`updateLocalSession: delete local session due to same base key`,h.Session.deleteRemoteInfo(_)):void 0}))).apply(this,arguments)}},60758:(e,t,r)=>{"use strict";var a=r(14859),i=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=c.parse(e);if(t.error)return __LOG__(4,void 0,new Error)`${t.error.toString()} parsing ${e.toString()}`,Promise.reject(t.error);return function(e){var t=(0,n.wap)("ack",{id:(0,n.CUSTOM_STRING)(e.stanzaId),class:"notification",type:"server",to:(0,n.CUSTOM_STRING)(e.from)});switch(e.type){case u.LOG:return o.upload({reason:"Server request",immediate:!0,force:!0,skipSampling:!1}),Promise.resolve(t);case u.PROPS:return(0,d.queryServerProps)().then((()=>t));case u.ABPROPS:return(0,s.syncABProps)(!1).then((()=>t));default:return __LOG__(3)`Unsupported notification with type "server",
blindly ack-ing it and doing nothing`,Promise.resolve(t)}}(t.success)},t.NOTIFICATION_TYPE=void 0;var n=r(35773),s=r(14683),o=i(r(2537)),l=a(r(45521)),d=r(3087),u=Object.freeze({LOG:"log",PROPS:"props",ABPROPS:"abprops"});t.NOTIFICATION_TYPE=u;var c=new l.default("incomingServerNotificationParser",(e=>{e.assertTag("notification");var t=e.attrString("id"),r=e.attrString("from");return e.hasChild(u.LOG)?{type:u.LOG,stanzaId:t,from:r}:e.hasChild(u.PROPS)?{type:u.PROPS,stanzaId:t,from:r}:e.hasChild(u.ABPROPS)?{type:u.ABPROPS,stanzaId:t,from:r}:{type:null,stanzaId:t,from:r}}))},47472:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.reportOfflineNotifications=function(){if(c.size<1)return;var e=0;[...c.entries()].forEach((([,t])=>{e+=t-1})),new o.default.MdAppStateOfflineNotifications({redundantCount:e}).commit(),c.clear()},t.default=function(e){var t=p.parse(e);if(t.error)return __LOG__(4,void 0,new Error)`${t.error.toString()} parsing ${e.toString()}`,Promise.reject(t.error);return function(e){if(e.changedCollections){var t=e.changedCollections.map((e=>n.CollectionName.cast(e.name))).filter(Boolean);e.offline&&t.forEach((e=>{var t=c.get(e);null!=t?c.set(e,t+1):c.set(e,1)})),(0,d.markCollectionsForSync)(t)}return Promise.resolve((0,i.wap)("ack",{id:(0,i.CUSTOM_STRING)(e.stanzaId),class:"notification",type:"server_sync",to:(0,u.USER_JID)((0,s.assertGetMe)())}))}(t.success)};var i=r(35773),n=r(17845),s=r(66239),o=a(r(84161)),l=a(r(45521)),d=r(58970),u=r(29020),c=new Map,p=new l.default("serverSyncNotification",(e=>{if(e.assertTag("notification"),!e.hasChild("collection"))throw"Server sync notifcation does not contain any collections";var t=e.attrString("id");return{changedCollections:e.mapChildrenWithTag("collection",(e=>({name:e.attrString("name")}))),stanzaId:t,offline:e.hasAttr("offline")}}))},5801:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return p.apply(this,arguments)};var i=a(r(52954)),n=a(r(13277)),s=r(7017),o=r(37888),l=r(11247),d=a(r(45521)),u=a(r(15934)),c=new d.default("streamErrorParser",(e=>{if(e.assertTag("stream:error"),!e.hasChild("conflict"))return e.hasAttr("code")?{type:"code",code:e.attrInt("code")}:e.hasChild("ack")?{type:"ack",id:e.child("ack").hasAttr("id")?e.child("ack").attrString("id"):null}:(__LOG__(3)`Unrecognized stream:error: ${e.toString()}`,{type:"other"});switch(e.child("conflict").attrString("type")){case"replaced":return{type:"replaced"};case"device_removed":default:return{type:"device_removed"}}}));function p(){return(p=(0,i.default)((function*(e){var t=c.parse(e);if(t.error)return __LOG__(4,void 0,new Error)`${t.error.toString()} parsing ${e.toString()}`,Promise.reject(t.error);var r=t.success;if("code"===r.type&&r.code>=500&&r.code<600){if(515===r.code)return(0,o.startLogin)(),Promise.resolve("NO_ACK");if(516===r.code)return(0,l.commitDeviceLinkEvent)(516),(0,o.startLogout)(),Promise.resolve("NO_ACK");(0,s.onStreamErrorReceived)()}else{if("device_removed"===r.type)return(0,s.stopComms)(!0),yield u.default.clearCredentialsAndStoredData(),__LOG__(2)`stream error due to device removed, logging out`,n.default.logout(),Promise.resolve("NO_ACK");if("replaced"===r.type)return(0,s.stopComms)(),Promise.resolve("NO_ACK")}return Promise.resolve("CLOSE_SOCKET")}))).apply(this,arguments)}},46597:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=p.parse(e);if(t.error)return __LOG__(4,void 0,new Error)`handleSuccess: failed to parse ${t.error}`,Promise.reject(t.error);var r=t.success;a=r.ts,o=Math.round(Date.now()/1e3-a),(0,i.setClockSkew)(o),n.default.setSkew(o),s.default.onTemporaryBan({banned:!1});var a,o;var h=r.companionEncStatic;if(u.default.generateFinalDbEncryptionAndFtsKey(h),(0,c.generateFinalDbEncryptionAndFtsKeyForInvoker)(h),null==d.default.serverPropsVersion||d.default.serverPropsVersion<r.propsVersion)return(0,l.queryServerProps)()};var i=r(95334),n=a(r(99461)),s=a(r(13277)),o=a(r(45521)),l=r(3087),d=a(r(54559)),u=a(r(49508)),c=r(92199),p=new o.default("successParser",(e=>(e.assertTag("success"),{ts:e.attrTime("t"),propsVersion:e.attrInt("props"),companionEncStatic:e.maybeAttrString("companion_enc_static")||"NULL"})))},71908:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=_.parse(e);if(t.error)return __LOG__(4,void 0,new Error)`${t.error.toString()} parsing ${e.toString()}`,Promise.resolve("NO_ACK");var{callCreator:r,from:a,message:n,payloadTag:s,stanzaId:u}=t.success,f=(0,h.wapNodeToVoipXml)(e),g={elapsed_msec:n.elapsed_msec,epoch_msec:n.epoch_msec,is_offline:n.is_offline,payload:f[2][0],peer_app_version:n.peer_app_version,peer_platform:n.peer_platform,peer_jid:n.peer_jid?n.peer_jid.toString({legacy:!0}):void 0},v=n.call_id;switch(n.type){case p.TYPE.OFFER:return m(a,u,v,r,n.type),(0,d.getDoNotDisturb)()&&!l.default.isFocused?__LOG__(2)`handleCall: ignoring incoming call offer because do not disturb mode is enabled or screen is locked`:(0,o.handleIncomingCallOffer)(n,g),Promise.resolve("NO_ACK");case p.TYPE.ENC_REKEY:return(0,o.handleIncomingEncRekey)(n,g).then((({shouldRetry:e,retryCount:t})=>{e?(0,c.default)(u,n,t):m(a,u,v,r,p.TYPE.ENC_REKEY)})),Promise.resolve("NO_ACK");case p.TYPE.ACCEPT:case p.TYPE.REJECT:return m(a,u,v,r,n.type),(0,o.handleIncomingSignalingMsg)(n,g),Promise.resolve("NO_ACK");default:return(0,o.handleIncomingSignalingMsg)(n,g),Promise.resolve(function(e,t,r){return(0,i.wap)("ack",{to:(0,h.JID)(e),id:(0,i.CUSTOM_STRING)(t),class:"call",type:(0,i.MAYBE_CUSTOM_STRING)(r)})}(a,u,s))}};var i=r(35773),n=r(7017),s=(a(r(23045)),r(66239)),o=r(19663),l=a(r(34443)),d=r(23288),u=a(r(45521)),c=a(r(93048)),p=r(91949),h=r(29020);function f(e){return p.TYPE[e.tag().toUpperCase()]||p.TYPE.NONE}var _=new u.default("callParser",(e=>{e.assertTag("call");var t=e.attrWid("from"),r=e.getFirstChild();if(r){var a=r.attrString("call-id"),i=r.attrWid("call-creator"),n={call_id:a,call_creator:i,peer_jid:t,peer_platform:e.hasAttr("platform")?e.attrString("platform"):void 0,peer_app_version:e.hasAttr("version")?e.attrString("version"):void 0,epoch_msec:e.hasAttr("t")?String(1e3*e.attrInt("t")):void 0,elapsed_msec:e.hasAttr("e")?String(1e3*e.attrInt("e")):void 0,type:f(r),common:{call_id:a,peer_jid:t.toString(),type:String(f(r))},isVideoCall:r.hasChild("video"),t:e.attrTime("t")};return{from:e.attrWid("from"),stanzaId:e.attrString("id"),payloadTag:r.tag(),message:n,callCreator:i}}throw new Error("Unrecognized call stanza")}));function m(e,t,r,a,o){var l;switch(o){case p.TYPE.OFFER:l=(0,i.wap)("offer",{"call-id":(0,i.CUSTOM_STRING)(r),"call-creator":(0,h.JID)(a)});break;case p.TYPE.ENC_REKEY:l=(0,i.wap)("enc_rekey",{"call-id":(0,i.CUSTOM_STRING)(r),"call-creator":(0,h.JID)(a)});break;case p.TYPE.ACCEPT:l=(0,i.wap)("accept",{"call-id":(0,i.CUSTOM_STRING)(r),"call-creator":(0,h.JID)(a)});break;case p.TYPE.REJECT:l=(0,i.wap)("reject",{"call-id":(0,i.CUSTOM_STRING)(r),"call-creator":(0,h.JID)(a)})}(0,n.castStanza)((0,i.wap)("receipt",{to:(0,h.JID)(e),id:(0,i.CUSTOM_STRING)(t),from:(0,h.JID)((0,s.getMaybeMeUser)())},l))}},57876:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=u.parse(e);if(t.error)return __LOG__(4,void 0,new Error)`${t.error.toString()} parsing ${e.toString()}`,Promise.resolve();var r=t.success,a=(0,i.wap)("ack",{id:(0,i.CUSTOM_STRING)((0,s.default)(r.stanzaId,"retryInfo.stanzaId")),to:(0,d.JID)(r.from),class:"receipt",type:"enc_rekey_retry"});return(0,n.handleVoipRetryRequest)(r).then((e=>{if(!e)return __LOG__(3)`voip:handle_enc_rekey_retry_receipt: not sending enc_rekey retry`,l.default.endCall(r.originalMsgId),a;l.default.resendEncRekeyRetry(r.from.toString({legacy:!0,formatFull:!0}),r.retryCount)})).catch((()=>(__LOG__(3)`voip:handle_enc_rekey_retry_receipt: error while attempting to send enc_rekey retry`,a)))};var i=r(35773),n=r(60836),s=a(r(21830)),o=a(r(45521)),l=a(r(61506)),d=r(29020),u=new o.default("rekeyRetryReceiptParser",(e=>{e.assertTag("receipt"),e.assertAttr("type","enc_rekey_retry");var t=e.child("enc_rekey");return{from:e.attrWid("from"),originalMsgId:t.attrString("call-id"),stanzaId:e.attrString("id"),retryCount:t.hasAttr("count")?t.attrInt("count"):0,regId:e.child("registration").contentUint(4),ts:null,participant:null,recipient:null,keyBundle:null,offline:!1}}))},67470:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"handleCall",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(t,"handleEncRekeyRetryRequest",{enumerable:!0,get:function(){return n.default}});var i=a(r(71908)),n=a(r(57876))},61563:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.extractCertificateDetailsParams=function(e){return{serial:e.serial,name:e.verifiedName,isApi:"ent:wa"===e.issuer}},t.getParsedProtoObjects=function(e){if(!e)return null;var t=(0,a.decodeProto)(i.VerifiedNameCertificateSpec,e);if(!t.details)throw new Error("verifyCertificate cert missing details");if(!t.signature)throw new Error("verifyCertificate cert missing signature");var r=(0,a.decodeProto)(i.DetailsSpec,t.details);return{cert:t,details:r}};var a=r(9557),i=r(57300)},83696:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.startWebPersistedJobManager=function(){return c.apply(this,arguments)},t.newJob=function(e){function t(){var t=d.jobSerializers[e],r=t.apply(null,arguments);return h(r)}return{fireAndForget(){t.apply(null,arguments).then((e=>{(0,n.loadAndRunJobFromId)(e)}))},waitUntilPersisted(){return t.apply(null,arguments).then((e=>{(0,n.loadAndRunJobFromId)(e)}))},waitUntilCompleted(){return t.apply(null,arguments).then((e=>(0,n.loadAndRunJobFromId)(e)))}}};var i=a(r(52954)),n=r(22014),s=r(61212),o=r(95334),l=a(r(81237)),d=r(83551),u=r(8286);function c(){return(c=(0,i.default)((function*(){(0,l.default)(),yield(0,u.initialize)();var e=(0,u.getJobsTable)();(0,n.startPersistedJobManager)({accessors:p(),unfinishedJobEntries:e.all(),isRestartAfterCrash:!1,onJobStarted:()=>{},onJobFinished:()=>null,deprecatedJobs:[]})}))).apply(this,arguments)}function p(){return{deletePersistedJob:e=>(0,u.getJobsTable)().remove(e),updatePersistedJob:e=>(0,u.getJobsTable)().createOrReplace(e),readPersistedJob:e=>(0,u.getJobsTable)().get(e)}}function h(){return f.apply(this,arguments)}function f(){return(f=(0,i.default)((function*(e){var t,r,a=(0,u.getJobsTable)(),i=JSON.stringify([e.type,null!==(t=e.uniqKey)&&void 0!==t?t:(0,s.randomHex)(32)]),l={type:e.type,uniqKey:i,startTime:(0,o.unixTime)(),version:null!==(r=e.version)&&void 0!==r?r:1,original:e.args,current:e.args,step:n.UNSTARTED_JOB,waitUntil:null,stepFirstStartTime:null,stepHardStartCountAfterTimeout:0};if(null==e.uniqKey)return a.createOrReplace(l);var d=yield a.equals(["uniqKey"],[e.uniqKey]);if(0===d.length)return a.createOrReplace(l);var c=[],p=null;for(var h of d)h.step===n.FINISHED_JOB?p=h:c.push(a.remove(h.jobId));return yield Promise.all(c),null!=p?p.jobId:a.createOrReplace(l)}))).apply(this,arguments)}},76604:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.ensureE2ESessions=m,t.handleE2eIdentityChange=function(e){var t=E.parse(e);if(t.error)return __LOG__(4,void 0,new Error)`${t.error.toString()} parsing ${e.toString()}`,Promise.reject(t.error);var{wid:r,stanzaId:a,delay:s}=t.success;return p.Session.hasSignalSessions([r]).then(function(){var e=(0,i.default)((function*([e]){if(e)if(__LOG__(2)`handleE2eIdentityChange ${r.toString()} updated, establishing session`,yield p.Session.deleteRemoteInfo(r),(0,c.addSecurityCodeChangedNotification)(r),null!=s){var t=new o.ShiftTimer((()=>{m([r])}));f.set(r.toString(),t),t.onOrAfter(1e3*s)}else m([r])}));return function(){return e.apply(this,arguments)}}()),Promise.resolve((0,n.wap)("ack",{to:(0,h.DEVICE_JID)(r),id:(0,n.CUSTOM_STRING)(a),class:"notification"}))};var i=a(r(52954)),n=r(35773),s=r(19129),o=r(35160),l=r(7017),d=a(r(23045)),u=a(r(45521)),c=r(86301),p=r(7574),h=r(29020),f=new Map,_=new s.PromiseQueueMap;function m(e){var t=e.map((e=>e.toString())).join();e.forEach((e=>{var t=f.get(e.toString());t&&(t.cancel(),f.delete(e.toString()))})),__LOG__(2)`ensureE2ESession ${t}`;var r=_.waitIfPending(t);if(r)return __LOG__(2)`ensureE2ESession deduped ${t}`,r;var a=p.Session.hasSignalSessions(e).then((t=>{var r=e.filter(((e,r)=>!t[r]));if(r.length>0)return function(){return v.apply(this,arguments)}(r)}));return _.enqueueHandlers(t,a)}var g=new u.default("e2eSessionParser",(e=>e.child("list").mapChildren((e=>{if(e.hasChild("error")){var t=e.child("error"),r=t.attrInt("code"),a=t.attrString("text");throw new Error(`establishE2ESessionParser bad response: ${r} ${a}`)}var i=e.child("skey"),n=e.hasChild("key")?e.child("key"):null,s=e.hasChild("device-identity")?e.child("device-identity").contentBytes():null;return{wid:e.attrDeviceWid("jid"),regId:e.child("registration").contentUint(4),identity:e.child("identity").contentBytes(32),deviceIdentity:s,skey:{id:i.child("id").contentUint(3),pubkey:i.child("value").contentBytes(32),signature:i.child("signature").contentBytes(64)},key:n&&{id:n.child("id").contentUint(3),pubkey:n.child("value").contentBytes(32)}}}))));function v(){return(v=(0,i.default)((function*(e,t=!1){var r=e.map((e=>(0,n.wap)("user",{jid:(0,h.DEVICE_JID)(e),reason:t?"identity":n.DROP_ATTR}))),a=(0,n.wap)("iq",{id:(0,n.generateId)(),xmlns:"encrypt",type:"get",to:n.S_WHATSAPP_NET},(0,n.wap)("key",null,r)),i=yield(0,l.sendIq)(a,g);if(!i.success)throw new Error(`establishE2ESession bad response ${String(i)}`);var s=i.result;if(!s||s.length<=0)throw new Error("establishE2ESession: empty keyInfo");var o=[],u=[];s.forEach((e=>{null!=e.wid.device&&e.wid.device!==d.default.DEVICE.PRIMARY_DEVICE?u.push(e):o.push(e)}));var c=e=>p.Session.createSignalSession(e).catch((t=>{__LOG__(4,void 0,new Error,!0)`createSignalSession: failed for device ${e.wid} with error ${t}`,SEND_LOGS("createSignalSession-fail")}));yield Promise.all(o.map((e=>c(e)))),yield Promise.all(u.map((e=>c(e)))),__LOG__(2)`establishE2ESession: successfully established E2E sessions`}))).apply(this,arguments)}var E=new u.default("identityChange",(e=>{e.assertTag("notification"),e.assertAttr("type","encrypt"),e.child("identity");var t=parseInt(e.maybeAttrString("delay"),10);return{wid:e.attrDeviceWid("from"),stanzaId:e.attrString("id"),delay:isFinite(t)&&t>0?t:null}}))},8745:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.getAllContactsFromChatCollectionIntoChunks=function(e=500){var t=[],r=[],a=new Set,i=new Set;for(var n of s.default.toArray())i.size===e&&(t.push(i),i=new Set),n.isBroadcast||(n.isGroup?r.push(n.id):a.has(n.id)||(i.add(n.id),a.add(n.id)));for(var o of r){var l=s.default.get(o)||{};for(var d of null===(u=l.groupMetadata)||void 0===u?void 0:u.participants.toArray()){var u;i.size===e&&(t.push(i),i=new Set),a.has(d.id)||(i.add(d.id),a.add(d.id))}}0!==i.size&&t.push(i);return __LOG__(2,void 0,void 0,void 0,["contact-sync"])`get ${t.length} chunks of contacts from chat collection, chunk size: ${e}`,t},t.getNonAddressBookContactsAndMarkAllContactsDirty=function(){return f.apply(this,arguments)},t.getAndUpdateNonAddressBookContacts=function(){return _.apply(this,arguments)};var i=a(r(52954)),n=r(11219),s=a(r(85030)),o=r(38027),l=r(92166),d=a(r(43926)),u=r(25054);function c(){return p.apply(this,arguments)}function p(){return(p=(0,i.default)((function*(){var e=new Set;return yield(0,o.getParticipantTable)().forEach((t=>{t.participants.forEach((t=>{e.add((0,n.toJid)((0,u.createWid)(t).user))}))})),yield(0,o.getChatTable)().forEach((t=>{d.default.isUser(t.id)&&e.add((0,n.toJid)((0,u.createWid)(t.id).user))})),__LOG__(2,void 0,void 0,void 0,["contact-sync"])`found ${e.size} contacts from chat and group participant tables`,Array.from(e)}))).apply(this,arguments)}function h(e){return e.anyOf(["isAddressBookContact"],[1,0]).then((e=>{var t=new Set(e.map((e=>e.id)));return __LOG__(2,void 0,void 0,void 0,["contact-sync"])`found ${t.size} contacts with set isAddressBookContact value from contact table`,t}))}function f(){return(f=(0,i.default)((function*(){var e=yield c();return(0,l.getStorage)().lock(["contact"],function(){var t=(0,i.default)((function*([t]){var r=yield h(t),a=Array.from(e).map((e=>r.has(e)?{id:e,isContactSyncCompleted:0}:{id:e,isAddressBookContact:0,isContactSyncCompleted:0}));return __LOG__(2,void 0,void 0,void 0,["contact-sync"])`mark ${a.length} contacts dirty during the regular sync`,t.bulkCreateOrMerge(a)}));return function(){return t.apply(this,arguments)}}())}))).apply(this,arguments)}function _(){return(_=(0,i.default)((function*(){var e=yield c();return(0,l.getStorage)().lock(["contact"],function(){var t=(0,i.default)((function*([t]){var r=yield h(t),a=e.filter((e=>!r.has(e))).map((e=>({id:e,isAddressBookContact:0,isContactSyncCompleted:0})));return __LOG__(2,void 0,void 0,void 0,["contact-sync"])`get ${a.length} non-address book contacts, mark dirty, and update the contact table during the inital sync`,t.bulkCreateOrMerge(a)}));return function(){return t.apply(this,arguments)}}())}))).apply(this,arguments)}},66463:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.sendPassiveIb=function(e){var t=(0,i.wap)("ib",null,(0,i.wap)("passive",{value:(0,i.CUSTOM_STRING)(String(e))}));(0,n.castStanza)(t)},t.sendPassiveIq=function(e){var t=e?(0,i.wap)("passive",null):(0,i.wap)("active",null),r=(0,i.wap)("iq",{to:i.S_WHATSAPP_NET,xmlns:"passive",type:"set",id:(0,i.generateId)()},t);return(0,n.sendIq)(r,s).then((t=>{if(!t.success){var{errorCode:r,errorText:a}=t;return __LOG__(3)`sendPassiveIq: sever response with ${r}, ${a}`,{errorCode:r,errorText:a}}__LOG__(2)`sendPassiveIq: passive mode set to ${String(e)}`}))};var i=r(35773),n=r(7017),s=new(a(r(45521)).default)("passiveIqParser",(e=>{e.assertAttr("type","result")}))},83551:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.jobSerializers=void 0;var r={rotateKey:()=>({type:"rotateKey",args:{},uniqKey:"rotateKey"}),setAbout:e=>({type:"setAbout",args:{content:e},uniqKey:"setAbout"}),queryProductList:(e,t,r,a)=>({type:"queryProductList",args:{catalogWid:e.toString(),productIds:t,width:r,height:a},uniqKey:`queryProductList:${t.slice().sort().join(",")}:${r}:${a}`})};t.jobSerializers=r},81237:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){e={rotateKey:()=>r.e(7903).then(r.bind(r,87903)).then((e=>e.default)),setAbout:()=>r.e(2881).then(r.bind(r,82881)).then((e=>e.default)),queryProductList:()=>r.e(5929).then(r.bind(r,85929)).then((e=>e.default))},Object.keys(e).forEach((t=>{e.hasOwnProperty(t)&&(0,i.addPersistedJobImplementation)(t,e[t])}));var e},t.defineWebPersistedJob=function(e){return(0,a.definePersistedJob)(e)};var a=r(75987),i=r(22014)},93622:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,r){var a=(0,n.wap)("iq",{id:(0,n.generateId)(),to:n.S_WHATSAPP_NET,type:"set",xmlns:"w:biz:catalog"},(0,n.wap)("product_catalog_add",{v:"1"},(0,u.productModelToNode)(e),(0,n.wap)("width",null,t.toString()),(0,n.wap)("height",null,r.toString())));return(0,s.sendIq)(a,c,o.parseErrorFields).then((e=>{if(e.success)return e.result;throw null!=e.customError?new l.CatalogEditServerError(e.errorCode,e.customError):new l.ServerStatusCodeError(e.errorCode)}))},t.addProductResponse=void 0;var n=r(35773),s=r(7017),o=r(38843),l=r(33576),d=i(r(45521)),u=a(r(30504)),c=new d.default("addProductResponse",(e=>{e.assertTag("iq"),e.assertFromServer();var t=e.child("product_catalog_add").child("product");return(0,u.default)(t)}));t.addProductResponse=c},82180:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var r=(0,i.wap)("iq",{id:(0,i.generateId)(),to:i.S_WHATSAPP_NET,type:"set",xmlns:"fb:thrift_iq"},(0,i.wap)("request",{type:"appeal_product"},(0,i.wap)("reason",null,t),(0,i.wap)("id",null,e)));return(0,n.sendIq)(r,o).then((e=>{if(e.success)return e.result;throw new s.ServerStatusCodeError(e.errorCode)}))},t.appealProductResponse=void 0;var i=r(35773),n=r(7017),s=r(33576),o=new(a(r(45521)).default)("appealProductResponse",(e=>(e.assertTag("iq"),e.assertFromServer(),"true"===e.child("response").child("success").contentString())));t.appealProductResponse=o},57840:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){var e=(0,i.wap)("iq",{id:(0,i.generateId)(),to:i.S_WHATSAPP_NET,type:"set",xmlns:"w:biz:catalog"},(0,i.wap)("product_catalog_create",{version:"1"}));return(0,n.sendIq)(e,o).then((e=>{if(e.success)return e.result;throw new s.ServerStatusCodeError(e.errorCode)}))},t.productCatalogCreateResponse=void 0;var i=r(35773),n=r(7017),s=r(33576),o=new(a(r(45521)).default)("productCatalogCreateResponse",(e=>{e.assertTag("iq"),e.assertFromServer(),e.child("product_catalog_create")}));t.productCatalogCreateResponse=o},6218:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=(0,i.wap)("iq",{id:(0,i.generateId)(),to:i.S_WHATSAPP_NET,type:"set",xmlns:"w:biz:catalog"},(0,i.wap)("product_catalog_delete",{v:"1"},e.map((e=>(0,i.wap)("product",null,(0,i.wap)("id",null,e))))));return(0,n.sendIq)(t,o).then((e=>{if(e.success)return e.result;throw new s.ServerStatusCodeError(e.errorCode)}))},t.productDeleteResponse=void 0;var i=r(35773),n=r(7017),s=r(33576),o=new(a(r(45521)).default)("productDeleteResponse",(e=>(e.assertTag("iq"),e.assertFromServer(),{deletedCount:e.child("product_catalog_delete").attrInt("deleted_count")})));t.productDeleteResponse=o},46574:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,r){var a=(0,n.wap)("iq",{id:(0,n.generateId)(),to:n.S_WHATSAPP_NET,type:"set",xmlns:"w:biz:catalog"},(0,n.wap)("product_catalog_edit",{v:"1"},(0,u.productModelToNode)(e),(0,n.wap)("width",null,t.toString()),(0,n.wap)("height",null,r.toString())));return(0,s.sendIq)(a,c,o.parseErrorFields).then((e=>{if(e.success)return e.result;throw e.customError?new l.CatalogEditServerError(e.errorCode,e.customError):new l.ServerStatusCodeError(e.errorCode)}))};var n=r(35773),s=r(7017),o=r(38843),l=r(33576),d=i(r(45521)),u=a(r(30504)),c=new d.default("editProductResponse",(e=>{e.assertTag("iq"),e.assertFromServer();var t=e.child("product_catalog_edit").child("product");return(0,u.default)(t)}))},30504:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.productModelToNode=function(e){var t,r=e.id?(0,n.wap)("id",null,e.id.toString()):void 0,a=e.description?(0,n.wap)("description",null,e.description):void 0,i=e.url?(0,n.wap)("url",null,e.url):void 0,s=e.retailerId?(0,n.wap)("retailer_id",null,e.retailerId):void 0,o=null!=e.priceAmount1000?(0,n.wap)("currency",null,e.currency):void 0,l=null!=e.priceAmount1000?(0,n.wap)("price",null,e.priceAmount1000.toString()):void 0,d=[(0,n.wap)("image",null,(0,n.wap)("url",null,e.imageCdnUrl))].concat(null===(t=e.additionalImageCdnUrl)||void 0===t?void 0:t.map((e=>(0,n.wap)("image",null,(0,n.wap)("url",null,e)))));return(0,n.wap)("product",{is_hidden:e.isHidden?"true":"false"},r,(0,n.wap)("name",null,e.name),a,i,s,(0,n.wap)("media",null,d),l,o)},t.parseLegacyProductErrorReason=function(e){if(null!=e){var t=Object.keys(e)[0];return[{name:t,reason:e[t]||"",detail:e.detail}]}return[]},t.default=void 0;var i=a(r(70417)),n=r(35773),s=r(13499),o=e=>{var t,r,a,n,o,l=e.child("id").contentString(),d=e.maybeChild("url"),u="";d&&d.hasContent()&&(u=d.contentString());var c=e.child("name").contentString(),p=null!==(t=e.maybeAttrString("availability"))&&void 0!==t?t:s.ProductAvailability.UNKNOWN,h=e.maybeChild("description"),f=h?h.contentString():"",_=e.maybeChild("checkmark"),m="true"===(null==_?void 0:_.contentString())||!1,g=[],v=[],E=[],y=e.child("media"),S=!0;y.forEachChildWithTag("image",(e=>{if(S)S=!1,g.push({key:"requested",value:e.child("request_image_url").contentString()}),g.push({key:"full",value:e.child("original_image_url").contentString()}),E.push(e.child("id").contentString());else{var t=[];t.push({key:"requested",value:e.child("request_image_url").contentString()}),t.push({key:"full",value:e.child("original_image_url").contentString()}),v.push(t),E.push(e.child("id").contentString())}}));var T=e.maybeChild("status_info"),A=(null==T?void 0:T.child("status").contentString())||"APPROVED",b=null==T||null===(r=T.maybeChild("can_appeal"))||void 0===r?void 0:r.contentString(),C=e.maybeChild("currency"),P=C?C.contentString():void 0,O=e.maybeChild("price"),w=O?parseInt(O.contentString(),10):null,M=e.maybeChild("retailer_id"),I=M?M.contentString():"",R=!!e.hasAttr("is_hidden")&&"true"===e.attrString("is_hidden"),D=e.maybeChild("sale_price"),N=D&&(null===(a=D.maybeChild("price"))||void 0===a?void 0:a.contentString())?{sale_price:parseInt(D.child("price").contentString(),10),sale_start_date:null===(n=D.maybeChild("start_date"))||void 0===n?void 0:n.contentString(),sale_end_date:null===(o=D.maybeChild("end_date"))||void 0===o?void 0:o.contentString()}:null;return(0,i.default)({id:l,is_hidden:R,url:u,name:c,description:f,availability:p,additional_image_cdn_urls:v,image_cdn_urls:g,capability_to_review_status:[{key:"WHATSAPP",value:A}],whatsapp_product_can_appeal:"true"===b,image_hashes_for_whatsapp:E,currency:P,price:w,retailer_id:I,checkmark:m},N)};t.default=o},38905:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=(0,i.wap)("iq",{to:i.S_WHATSAPP_NET,type:"set",xmlns:"w:biz:catalog",smax_id:"23",id:(0,i.generateId)()},(0,i.wap)("product_visibility_update",{v:"1"},e.map((e=>(0,i.wap)("product",{is_hidden:e.isHidden?"true":"false"},(0,i.wap)("id",null,e.productId))))));return(0,n.sendIq)(t,o).then((e=>{if(e.success)return e.result;throw new s.ServerStatusCodeError(e.errorCode)}))};var i=r(35773),n=r(7017),s=r(33576),o=new(a(r(45521)).default)("visibilitySetResponse",(e=>{e.assertTag("iq"),e.assertFromServer()}))},30217:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.queryCollections=function(e,t,r,a,i,l,d){var c=t?(0,n.wap)("after",null,t):void 0,h=(0,n.wap)("iq",{to:n.S_WHATSAPP_NET,type:"get",xmlns:"w:biz:catalog",id:(0,n.generateId)(),smax_id:"35"},(0,n.wap)("collections",{biz_jid:(0,u.DEVICE_JID)(e),empty_collection:(0,n.CUSTOM_STRING)(i.toString())},(0,n.wap)("collection_limit",null,r.toString()),(0,n.wap)("item_limit",null,a.toString()),(0,n.wap)("width",null,l.toString()),(0,n.wap)("height",null,d.toString()),c));return(0,s.sendIq)(h,p).then((e=>{if(e.success)return e.result;throw new o.ServerStatusCodeError(e.errorCode)}))},t.querySingleCollection=function(e,t,r,a,i,l){var d=r?(0,n.wap)("after",null,r):void 0,c=(0,n.wap)("iq",{to:n.S_WHATSAPP_NET,type:"get",xmlns:"w:biz:catalog",id:(0,n.generateId)(),smax_id:"30"},(0,n.wap)("collection",{biz_jid:(0,u.DEVICE_JID)(e),id:(0,n.CUSTOM_STRING)(t)},(0,n.wap)("limit",null,a.toString()),(0,n.wap)("width",null,i.toString()),(0,n.wap)("height",null,l.toString()),d));return(0,s.sendIq)(c,h).then((e=>{if(e.success)return e.result;throw new o.ServerStatusCodeError(e.errorCode)}))},t.createCollection=function(e,t,r){var a=[];a.push((0,n.wap)("name",null,e)),a.push(...t.map((e=>(0,n.wap)("product",null,(0,n.wap)("id",null,e))))),a.push((0,n.wap)("catalog_session_id",null,r));var i=(0,n.wap)("iq",{to:n.S_WHATSAPP_NET,type:"set",xmlns:"w:biz:catalog",id:(0,n.generateId)(),smax_id:"36"},(0,n.wap)("collection",{op:"create"},a));return(0,s.sendIq)(i,f,_).then((e=>{if(e.success)return e.result;throw e.customError}))},t.deleteCollection=function(e){var t=(0,n.wap)("iq",{to:n.S_WHATSAPP_NET,type:"get",xmlns:"w:biz:catalog",id:(0,n.generateId)(),smax_id:"30"},(0,n.wap)("collection",{op:"delete"},(0,n.wap)("id",null,e)));return(0,s.sendIq)(t,m).then((e=>{if(!e.success)throw new o.ServerStatusCodeError(e.errorCode)}))},t.editCollection=function(e,t,r,a,i,o){var l=(0,n.wap)("iq",{to:n.S_WHATSAPP_NET,type:"set",xmlns:"w:biz:catalog",id:(0,n.generateId)(),smax_id:"40"},(0,n.wap)("collection",{op:"update"},(0,n.wap)("id",null,e),(0,n.wap)("name",null,t),(0,n.wap)("add",null,a.map((e=>(0,n.wap)("id",null,e)))),(0,n.wap)("remove",null,i.map((e=>(0,n.wap)("id",null,e)))),(0,n.wap)("catalog_session_id",null,o)));return(0,s.sendIq)(l,f,_).then((e=>{if(e.success)return e.result;throw e.customError}))};var i=r(82420),n=r(35773),s=r(7017),o=r(33576),l=a(r(45521)),d=a(r(30504)),u=r(29020),c=e=>{var t,r=e.maybeChild("status_info"),a=r?r.child("status").contentString():"APPROVED",i={id:e.child("id").contentString(),name:e.child("name").contentString(),isHidden:"TRUE"===(null===(t=e.maybeChild("is_hidden"))||void 0===t?void 0:t.contentString()),reviewStatus:a,totalItemsCount:0,products:[]};return e.forEachChildWithTag("product",(e=>{i.products.push((0,d.default)(e))})),i},p=new l.default("collectionsResponse",(e=>{e.assertTag("iq"),e.assertFromServer();var t=e.child("collections"),r=[];t.forEachChildWithTag("collection",(e=>{r.push(c(e))}));var a=t.child("paging").child("after"),i=a.hasContent()?a.contentString():"";return{collections:r,afterCursor:i}}));var h=new l.default("singleCollectionResponse",(e=>{e.assertTag("iq"),e.assertFromServer();var t=e.child("collection"),r=c(t),a=t.child("paging").child("after");return{collections:[r],afterCursor:a.hasContent()?a.contentString():""}}));var f=new l.default("createOrEditCollectionResponse",(e=>{e.assertTag("iq"),e.assertFromServer();var t=e.child("collection"),r=t.child("id").contentString(),a=t.maybeChild("status_info");return{id:r,reviewStatus:a?a.child("status").contentString():"APPROVED"}})),_=new i.WapParser("createOrEditCollectionResponseErrorParser",(e=>{var t=e.attrString("code"),r=e.attrString("text"),a=e.maybeChild("field");return{code:t,text:r,fieldName:null==a?void 0:a.attrString("name"),fieldReason:null==a?void 0:a.attrString("reason")}}));var m=new l.default("deleteCollectionResponse",(e=>{e.assertTag("iq"),e.child("response").assertAttr("name","Success")}))},51:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.fetchAndUpdateBlocklist=function(){return(c.default.mdBlocklistV2?h:l.getBlocklist)().then(function(){var e=(0,i.default)((function*(e){return null!=e.errorCode||e.dhash&&((0,d.setBlocklistHash)(e.dhash),yield(0,s.updateBlocklist)(e.wids)),e}));return function(){return e.apply(this,arguments)}}())};var i=a(r(52954)),n=r(35773),s=r(22765),o=r(7017),l=r(37886),d=r(63191),u=a(r(45521)),c=a(r(54559));var p=new u.default("blocklistParser",(e=>{var t,r,a,i={wids:[]};if(e.hasChild("error"))return t=e.child("error"),r=t&&t.maybeAttrString("code"),a=t&&t.maybeAttrString("text"),__LOG__(3,void 0,void 0,!0)`getBlocklist error: code ${r} text ${a}`,SEND_LOGS("getBlocklist"),i;e.assertAttr("type","result");var n=e.maybeChild("list");if(n){var s=n.maybeAttrString("dhash");s&&(i.dhash=s),n.hasChild("item")&&(i.wids=n.mapChildrenWithTag("item",(e=>e.attrUserWid("jid")))||[])}return i}));function h(){var e=(0,d.getBlocklistHash)(),t=(0,n.wap)("iq",{xmlns:"blocklist",to:n.S_WHATSAPP_NET,type:"get",id:(0,n.generateId)()},e?(0,n.wap)("item",{dhash:(0,n.CUSTOM_STRING)(e)}):null);return(0,o.sendIq)(t,p).then((e=>{if(e.success)return e.result?e.result:Promise.reject(new Error("response does not have blocked list"));var{errorCode:t,errorText:r}=e;return __LOG__(3)`fetchBlocklist: failed ${t}, ${r}`,{errorCode:t,errorText:r}}))}},54435:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.queryBusinessCategories=function(e){var t=(0,i.wap)("iq",{to:i.S_WHATSAPP_NET,xmlns:"fb:thrift_iq",id:(0,i.generateId)(),type:"get"},(0,i.wap)("request",{op:"typeahead",type:"catkit",v:"1"},(0,i.wap)("query",null,e)));return(0,n.sendIq)(t,o).then((e=>{if(e.success)return e.result;throw new s.ServerStatusCodeError(e.errorCode)}))};var i=r(35773),n=r(7017),s=r(33576),o=new(a(r(45521)).default)("businessCategoriesResponse",(e=>{e.assertTag("iq"),e.assertFromServer();var t=e.child("response"),r=[];t.child("not_a_biz").forEachChildWithTag("category",(e=>{var t=e.attrString("id"),a=e.contentString();r.push({id:t,localized_display_name:a,not_a_biz:!0})})),r.length=1;var a=r[0].id;return t.child("categories").forEachChildWithTag("category",(e=>{var t=e.attrString("id");if(t!==a){var i=e.contentString();r.push({id:t,localized_display_name:i,not_a_biz:!1})}})),r}))},38066:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var r=(0,i.wap)("iq",{to:i.S_WHATSAPP_NET,xmlns:"w:biz",id:(0,i.generateId)(),type:"get"},(0,i.wap)("business_profile",{v:(0,i.INT)(t)},e.map((e=>(0,i.wap)("profile",{jid:(0,d.USER_JID)(e.wid),tag:null!=e.tag?(0,i.INT)(e.tag):i.DROP_ATTR})))));return(0,s.sendIq)(r,u).then((e=>{if(e.success)return e.result;throw new o.ServerStatusCodeError(e.errorCode)}))};var i=r(35773),n=a(r(83170)),s=r(7017),o=r(33576),l=a(r(45521)),d=r(29020),u=new l.default("businessProfileResponse",(e=>{e.assertTag("iq"),e.assertFromServer();var t=e.child("business_profile"),r=[];return t.forEachChildWithTag("profile",(e=>{var t=e.attrWid("jid"),a=e.attrString("tag"),i=(0,n.default)(e);Object.keys(i).length?r.push({wid:t,tag:a,profile:i}):r.push({wid:t,tag:a})})),r}))},71096:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,r,a,o){var l=t?(0,i.wap)("after",null,t):void 0,c=(0,i.wap)("iq",{to:i.S_WHATSAPP_NET,type:"get",xmlns:"w:biz:catalog",id:(0,i.generateId)()},(0,i.wap)("product_catalog",{jid:(0,d.DEVICE_JID)(e)},(0,i.wap)("limit",null,r.toString()),(0,i.wap)("width",null,a.toString()),(0,i.wap)("height",null,o.toString()),l),undefined);return(0,n.sendIq)(c,u).then((e=>{if(e.success)return e.result;throw new s.ServerStatusCodeError(e.errorCode)}))};var i=r(35773),n=r(7017),s=r(33576),o=a(r(45521)),l=a(r(30504)),d=r(29020),u=new o.default("catalogResponse",(e=>{e.assertTag("iq"),e.assertFromServer();var t=e.child("product_catalog"),r=[];t.forEachChildWithTag("product",(e=>{e.maybeChild("id")&&r.push((0,l.default)(e))}));var a=t.child("paging"),i=a.child("before"),n=i.hasContent()?i.contentString():"",s=a.child("after"),o=s.hasContent()?s.contentString():"";return{data:r,paging:{cursors:{after:o,before:n}}}}))},72479:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,r,a){var o=(0,i.wap)("iq",{to:i.S_WHATSAPP_NET,type:"get",xmlns:"w:biz:catalog",id:(0,i.generateId)()},(0,i.wap)("product",{jid:(0,d.DEVICE_JID)(e)},(0,i.wap)("product_id",null,t),(0,i.wap)("width",null,r.toString()),(0,i.wap)("height",null,a.toString())));return(0,n.sendIq)(o,u).then((e=>{if(e.success)return{data:e.result};if(404===e.errorCode)return{error:"NOT_FOUND"};throw new s.ServerStatusCodeError(e.errorCode)}))};var i=r(35773),n=r(7017),s=r(33576),o=a(r(45521)),l=a(r(30504)),d=r(29020),u=new o.default("productResponse",(e=>{e.assertTag("iq"),e.assertFromServer();var t=e.child("product_catalog").child("product");return(0,l.default)(t)}))},701:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.queryExist=function(e){var t=(new n.USyncQuery).withContactProtocol();return t.withUser((new i.USyncUser).withPhone(e)),t.withBusinessProtocol(),t.execute().then((e=>{var t=e.error.all||e.error.contact;if(t)return Promise.reject(new a.ServerStatusCodeError(t.errorCode,t.errorText));var{list:r}=e;if(1===r.length){var{id:i,contact:n,business:s}=r[0];if(n&&"in"===n.type)return{wid:i,biz:!!s,bizInfo:s}}return null}))};var a=r(33576),i=r(23665),n=r(90297)},62246:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.mapParsedMediaConn=p,t.queryMediaConn=function(e){var t=new Date,r=(0,o.unixTime)(),a=(0,n.wap)("iq",{to:n.S_WHATSAPP_NET,xmlns:"w:m",type:"set",id:(0,n.generateId)()},(0,n.wap)("media_conn",null)),c=(0,l.sendIq)(a,s.mediaConnParser).then((e=>{if(e.success){__LOG__(2)`backend:queryMediaConn: got ${e.result.hosts.length} hosts`;var{auth:a,authTTL:n,ttl:s,hosts:o,maxBuckets:l}=p(e.result);if(!a||null==s||!o||0===o.length)throw __LOG__(2)`backend:queryMediaConnections: auth exists ${String(!!a)}`,__LOG__(2)`backend:queryMediaConnections: ttl exists ${String(!!s)}`,__LOG__(2)`backend:queryMediaConnections: hosts exists ${String(!!o)}`,o&&__LOG__(2)`backend:queryMediaConnections: hosts.length ${o.length}`,__LOG__(4,void 0,new Error,!0)`Assertion failed!`,SEND_LOGS("backend:queryMediaConnections unexpected mediaConn"),new Error("Invalid mediaConn");return(0,i.default)({queryStartTime:t,auth:a,hosts:o,ttl:s-r,maxBuckets:l},null!=n?{authTTL:n-r}:null)}throw __LOG__(4,void 0,new Error,!0)`response: ${e.errorCode} ${e.errorText}`,SEND_LOGS("backend:queryMediaConn: fail"),new d.ServerStatusCodeError(e.errorCode,e.errorText)}));return(0,u.default)(c,e)};var i=a(r(70417)),n=r(35773),s=r(12251),o=r(95334),l=r(7017),d=r(33576),u=a(r(2191));function c(e){switch(e){case"kyc-id":case"novi-image":case"novi-video":case"thumbnail-gif":case"thumbnail-link":case"ppic":return null;default:return e}}function p(e){var t,r,a=e=>{var t=[],r=e.downloadable.map(c).filter(Boolean);r.length>0&&t.push({download:r});var a=e.uploadable.map(c).filter(Boolean);a.length>0&&t.push({upload:a});var i=e.downloadBuckets.map((e=>e.toString()));return null!=i&&i.length>0&&t.push({downloadBuckets:i}),t};return{hosts:e.hosts.map((e=>({hostname:e.domain,class:e.class,type:e.isFallback?"fallback":"primary",ips:[{ip4:e.ip4,ip6:e.ip6}],rules:a(e)}))),auth:e.authToken,authTTL:null!==(t=e.authTTL)&&void 0!==t?t:void 0,ttl:e.authExpires,maxBuckets:null!==(r=e.maxBuckets)&&void 0!==r?r:void 0}}},52292:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.getBlockedContacts=function(){var e=(0,i.wap)("iq",{to:i.S_WHATSAPP_NET,type:"get",id:(0,i.generateId)(),xmlns:"privacy"},(0,i.wap)("privacy",null,(0,i.wap)("list",{name:(0,i.CUSTOM_STRING)("groupadd"),value:(0,i.CUSTOM_STRING)("contact_blacklist")})));return(0,n.sendIq)(e,p).then((e=>e.success?e.result:Promise.reject(new Error("invalid response"))))},t.getPrivacy=function(){var e=(0,i.wap)("iq",{xmlns:"privacy",to:i.S_WHATSAPP_NET,type:"get",id:(0,i.generateId)()},(0,i.wap)("privacy",null));return(0,n.sendIq)(e,c).then((e=>e.success?e.result:Promise.reject(new Error("invalid response"))))},t.GROUP_ADD=t.ALL_NONE=void 0;var i=r(35773),n=r(7017),s=a(r(45521)),o={all:"all",contacts:"contacts",none:"none",error:"error"},l={all:"all",none:"none",error:"error"};t.ALL_NONE=l;var d={all:"all",contacts:"contacts",contact_blacklist:"contact_blacklist",none:"none",error:"error"};function u(e,t){var r=t.maybeChild("error"),a=r&&r.maybeAttrString("code"),i=r&&r.maybeAttrString("text");__LOG__(3,void 0,void 0,!0)`getPrivacy error: ${e} code ${a} text ${i}`,SEND_LOGS("getPrivacy")}t.GROUP_ADD=d;var c=new s.default("privacyParser",(e=>{e.assertAttr("type","result");var t={};return e.child("privacy").forEachChildWithTag("category",(e=>{switch(e.attrString("name")){case"readreceipts":var r=e.attrEnum("value",l);"error"!==r?t.readReceipts=r:u("readreceipts",e);break;case"last":var a=e.attrEnum("value",o);"error"!==a?t.lastSeen=a:u("last",e);break;case"profile":var i=e.attrEnum("value",o);"error"!==i?t.profilePicture=i:u("profile",e);break;case"status":var n=e.attrEnum("value",o);"error"!==n?t.about=n:u("status",e);break;case"groupadd":var s=e.attrEnum("value",d);"error"!==s?t.groupAdd=s:u("groupadd",e);break;default:u("unknown type",e)}})),t})),p=new s.default("getContactsBlacklistParser",(e=>{var t=e.child("privacy").maybeChild("list");return null==t?{status:"match"}:{status:"mismatch",users:t.mapChildren((e=>e.attrUserWid("jid")))}}))},9875:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){var e=(0,i.wap)("iq",{xmlns:"w",id:(0,i.generateId)(),type:"get",to:i.S_WHATSAPP_NET},(0,i.wap)("props",null));return(0,n.sendIq)(e,s)};var i=r(35773),n=r(7017),s=new(a(r(45521)).default)("serverProps",(e=>{e.assertTag("iq"),e.assertAttr("from","s.whatsapp.net");var t=e.child("props"),r={serverPropsVersion:t.attrInt("version")};return t.forEachChildWithTag("prop",(e=>{switch(e.attrString("name")){case"bsp_system_message_enabled":r.bspSystemMessageEnabled=1===e.attrInt("value");break;case"bsp_ui":r.bspUi=e.attrInt("value");break;case"web_ctwa_context_compose_enabled":r.ctwaContextCompose=1===e.attrInt("value");break;case"ctwa_context_enabled":r.ctwaContextRender=1===e.attrInt("value")?1:0;break;case"ephemeral_messages_enabled":r.ephemeralMessages=e.attrInt("value");break;case"ephemeral_messages_setting":r.ephemeralMessagesSetting=e.attrInt("value");break;case"ephemeral_messages_allowed_values":r.ephemeralMessagesAllowedValues=e.attrString("value");break;case"ephemeral_pruning_enabled":r.ephemeralPruning=e.attrInt("value");break;case"frequently_forwarded_group_setting":r.frequentlyForwardedGroupSetting=e.attrInt("value");break;case"frequently_forwarded_max":r.frequentlyForwardedMax=e.attrInt("value");break;case"frequently_forwarded_messages":r.frequentlyForwardedMessages=e.attrInt("value");break;case"frequently_forwarded_threshold":r.frequentlyForwardedThreshold=e.attrInt("value");break;case"web_gif_search":r.gifSearch=e.attrString("value");break;case"group_call_max_participants":r.groupCallMaxParticipants=e.attrInt("value",0);break;case"group_description_length":r.groupDescLength=e.attrInt("value");break;case"image_max_edge":r.imageMaxEdge=e.attrInt("value");break;case"image_max_kbytes":r.imageMaxKbytes=e.attrInt("value");break;case"image_quality":r.imageQuality=e.attrInt("value")/100;break;case"max_participants":r.maxParticipants=e.attrInt("value");break;case"max_subject":r.maxSubject=e.attrInt("value");break;case"max_keys":r.maxKeys=e.attrInt("value");break;case"media":r.media=e.attrInt("value");break;case"multicast_limit_global":r.multicastLimitGlobal=e.attrInt("value");break;case"mute_always":r.muteAlways=e.attrInt("value");break;case"mms_media_key_ttl":r.mmsMediaKeyTTL=e.attrInt("value");break;case"new_commerce_entry_point_enabled":r.newCommerceEntryPointEnabled=e.attrInt("value");break;case"web_shops_chat_header_button_enabled":r.webShopsChatHeaderButtonEnabled=1===e.attrInt("value",0);break;case"shops_profile_drawer_entrypoint":r.shopsProfileDrawerEntrypoint=1===e.attrInt("value",0);break;case"shops_hide_catalog_attachment_entrypoint":r.shopsHideCatalogAttachmentEntrypoint=1===e.attrInt("value",0);break;case"shops_header_dropdown_menu_item":r.shopsHeaderDropdownMenuItem=1===e.attrInt("value",0);break;case"mms_hot_content_timespan_in_seconds":r.mmsHotContentTimespan=e.attrInt("value");break;case"mms_vcache_aggregation_enabled":r.mmsVCacheAggregationEnabled=1===e.attrInt("value");break;case"product_media_attachments":r.productMediaAttachments=e.attrInt("value");break;case"quick_message_search_enabled":r.quickMessageSearch=e.attrInt("value");break;case"syncd_inline_mutations_max_count":r.syncdInlineMutationsMaxCount=e.attrInt("value");break;case"syncd_patch_protobuf_max_size":r.syncdPatchProtobufMaxSize=e.attrInt("value");break;case"syncd_key_max_use_days":r.syncdKeyMaxUseDays=e.attrInt("value");break;case"syncd_wait_for_key_timeout_days":r.syncdWaitForKeyTimeoutDays=e.attrInt("value");break;case"syncd_additional_mutations":r.syncdAdditionalMutations=e.attrInt("value");break;case"syncd_anti_tampering_fatal_exception_enabled":r.syncdAntiTamperingFatalExceptionEnabled=1===e.attrInt("value");break;case"syncd_sentinel_timeout_seconds":r.syncdSentinelTimeoutSeconds=e.attrInt("value");break;case"syncd_patch_device_index_included":r.syncdPatchDeviceIndexIncluded=1===e.attrInt("value");break;case"template_doc_mime_types":r.templateDocMimeTypes=e.attrInt("value");break;case"web_biz_profile_options":r.webBizProfileOptions=e.attrInt("value");break;case"web_voip_internal_tester":r.webVoipInternalTester=1===e.attrInt("value");break;case"view_once_read":r.viewOnceRead=e.attrInt("value");break;case"view_once_write":r.viewOnceWrite=e.attrInt("value");break;case"vcard_as_document_size_kb":r.vcardAsDocumentSizeKb=e.attrInt("value");break;case"vcard_max_size_kb":r.vcardMaxSizeKb=e.attrInt("value");break;case"md_blocklist_v2":r.mdBlocklistV2=1===e.attrInt("value");break;case"web_download_document_thumb_mms_enabled":r.webDownloadDocumentThumbMmsEnabled=1===e.attrInt("value");break;case"web_download_link_thumb_mms_enabled":r.webDownloadLinkThumbMmsEnabled=1===e.attrInt("value");break;case"web_send_document_thumb_in_message_disabled":r.webSendDocumentThumbInMessageDisabled=1===e.attrInt("value");break;case"web_upload_document_thumb_mms_enabled":r.webUploadDocumentThumbMmsEnabled=1===e.attrInt("value");break;case"web_upload_link_thumb_mms_enabled":r.webUploadLinkThumbMmsEnabled=1===e.attrInt("value");break;case"web_media_custom_cropping_enabled":r.webMediaCustomCroppingEnabled=1===e.attrInt("value");break;case"web_list_message":r.webListMessage=1===e.attrInt("value");break;case"web_voip_mac_os_min_version":r.webVoipMacOsMinVersion=e.attrString("value");break;case"web_voip_windows_os_min_version":r.webVoipWindowsOsMinVersion=e.attrString("value");break;case"web_cart_enabled":r.webCart=1===e.attrInt("value");break;case"web_catalog_products_onoff":r.webCatalogProductsOnOff=1===e.attrInt("value");break;case"web_cart_v1_1_order_message_changes_enabled":r.webCartV11OrderMessageChanges=1===e.attrInt("value");break;case"mms_cat_v1_forward_hot_override_enabled":r.mmsCatV1ForwardHotOverrideEnabled=1===e.attrInt("value");break;case"web_buttons_message_enabled":r.webButtonsMessage=1===e.attrInt("value");break;case"web_product_list_message_fallback":r.webProductListMessageFallback=1===e.attrInt("value");break;case"web_product_list_message_render_kill_switch":r.webProductListMessageRenderKillSwitch=1===e.attrInt("value");break;case"web_smb_upsell_in_biz_profile_enabled":r.webSMBUpsellInBizProfile=1===e.attrInt("value");break;case"ptt_playback_speed_enabled":r.pttPlaybackSpeedEnabled=1===e.attrInt("value");break;case"ptt_playback_speed_hide_delay":r.pttPlaybackSpeedHideDelay=e.attrInt("value");break;case"web_product_list_message_page_size":r.webProductListMessagePageSize=e.attrInt("value");break;case"web_biz_profile_edit_enabled":r.webBizProfileEdit=1===e.attrInt("value");break;case"web_youtube_player_enhancements":r.webYouTubePlayerEnhancements=1===e.attrInt("value");break;case"web_server_sticker_panel":r.webServerStickerPanel=e.attrInt("value");break;case"web_collections_display_enabled":r.webCollectionsDisplay=1===e.attrInt("value")}})),r}))},830:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sendAggregateReceipts=function(e,t,r,o,l,d){var u=t===s.READ||t===s.PLAYED||t===s.READ_SELF||t===s.PLAYED_SELF;return Promise.all(Array.from(o.keys()).map((c=>{var p=o.get(c);if(p&&0!==p.length){for(var h=e.isUser()?null:c,f=[];p.length>0;){var _=p.splice(0,256),m=null;_.length>1&&(m=(0,a.wap)("list",null,_.slice(1).map((e=>(0,a.wap)("item",{id:(0,a.CUSTOM_STRING)(e)})))));var g=(0,a.wap)("receipt",{to:(0,n.JID)(e),type:t===s.DELIVERY?a.DROP_ATTR:(0,a.CUSTOM_STRING)(t),msgtype:d?(0,a.CUSTOM_STRING)(d):a.DROP_ATTR,id:(0,a.CUSTOM_STRING)(_[0]),t:null!=r?(0,a.CUSTOM_STRING)(r):a.DROP_ATTR,participant:h?(0,n.DEVICE_JID)(h):a.DROP_ATTR,recipient:l?(0,n.USER_JID)(l):a.DROP_ATTR},m);u?f.push((0,i.sendStanzaAndWaitForAck)(g,{id:_[0],from:e,class:"receipt",type:t,participant:h})):f.push((0,i.castStanza)(g))}return Promise.all(f)}}))).then((()=>{}))},t.RECEIPT_MSG_TYPE=t.RECEIPT_TYPE=void 0;var a=r(35773),i=r(7017),n=r(29020),s=Object.freeze({INACTIVE:"inactive",SENDER:"sender",DELIVERY:"delivery",READ:"read",READ_SELF:"read-self",PLAYED:"played",PLAYED_SELF:"played-self",HISTORY_SYNC_COMPLETION:"hist_sync",SERVER_ERROR:"server-error",PEER_MSG:"peer_msg"});t.RECEIPT_TYPE=s;var o=Object.freeze({PEER:"peer"});t.RECEIPT_MSG_TYPE=o},8139:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.sendDeliveryReceiptsAfterPresence=function(){if(i.default.supportsFeature(i.default.F.MD_BACKEND))return(0,o.getInactiveReceiptTable)().all().then((e=>{var t=new Map,r=Date.now().toString();return e.forEach((e=>{var{msgId:r,chatId:a,participantId:i}=e,n=(0,u.createWid)(a),s=(i?(0,u.createWid)(i):null)||n,o=t.get(n);o||(o=new Map,t.set(n,o));var l=o.get(s);l||(l=[],o.set(s,l)),l.push(r)})),Promise.all(Array.from(t.keys()).map((e=>{var a=t.get(e);if(a)return(0,n.sendAggregateReceipts)(e,n.RECEIPT_TYPE.DELIVERY,r,a)}))).then((()=>(0,o.getInactiveReceiptTable)().bulkRemove(e.map((e=>e.msgId)))))}));return Promise.resolve()},t.sendDeliveryReceiptsAfterDecryption=function(e,t,r,a,h=!1){if(i.default.supportsFeature(i.default.F.MD_BACKEND)){var f=(0,d.default)(),_=(0,l.assertGetMe)(),m=!_.getDeviceId(),g=t.isUser()&&(0,u.toUserWid)(_).equals((0,u.toUserWid)(t))||null!=a&&(0,u.toUserWid)(_).equals((0,u.toUserWid)(a)),v=g||f||m,E=Promise.resolve();if(!v){var y={msgId:e,chatId:t.toString(),participantId:a?a.toString():null};E=(0,o.getInactiveReceiptTable)().createOrReplace(y)}return E.then((()=>{if(function(e,t,r,a,i,o,l){var d=c.DROP_ATTR;l?d=(0,c.CUSTOM_STRING)(n.RECEIPT_TYPE.PEER_MSG):o?d=(0,c.CUSTOM_STRING)(n.RECEIPT_TYPE.SENDER):i||(d=(0,c.CUSTOM_STRING)(n.RECEIPT_TYPE.INACTIVE));var u=(0,c.wap)("receipt",{id:(0,c.CUSTOM_STRING)(e),to:(0,p.JID)(t),participant:(t.isGroup()||t.isBroadcast())&&a?(0,p.DEVICE_JID)(a):c.DROP_ATTR,recipient:!l&&o&&r?(0,p.USER_JID)(r):c.DROP_ATTR,type:d});(0,s.castStanza)(u)}(e,t,r,a,v,g,h),v)return(0,o.getInactiveReceiptTable)().remove(e)}))}return Promise.resolve()};var i=a(r(20468)),n=r(830),s=r(7017),o=r(38027),l=r(66239),d=a(r(33974)),u=r(25054),c=r(35773),p=r(29020)},20039:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.markChatRead=function(){return g.apply(this,arguments)},t.markStatusRead=function(){return E.apply(this,arguments)};var i=a(r(52954)),n=r(11219),s=r(95334),o=r(830),l=a(r(23045)),d=r(66239),u=r(43730),c=a(r(83746)),p=a(r(21830)),h=r(52292),f=r(25054),_=r(78391);function m(e){var t;return e.isGroup()?o.RECEIPT_TYPE.READ:(null===(t=(0,d.getUserPrivacySettings)())||void 0===t?void 0:t.readReceipts)===h.ALL_NONE.none?o.RECEIPT_TYPE.READ_SELF:o.RECEIPT_TYPE.READ}function g(){return(g=(0,i.default)((function*(e,t){var r=Date.now().toString(),a=String(e.id),i=yield(0,u.getTable)().equals(["from","pendingReadReceipt"],[a,1],{shouldDecrypt:!1});i.sort(((e,t)=>(e.rowId||0)-(t.rowId||0)));var n=t?String(t):null,s=new Map,d=i.length-1;if(n){for(;d>=0&&i[d].id!==n;d--);d<0&&(d=i.length-1)}for(var p=null;d>=0;d--){var h=i[d];null!=h.rowId&&(null==p||h.rowId>p)&&(p=h.rowId);var g=c.default.fromString(h.id);if(h.type!==l.default.MSG_TYPE.CIPHERTEXT){var v=h.broadcastId||h.from,E=h.author||h.from,y=g.id,S=(0,f.createWidFromWidLike)(E),T=(0,f.createWidFromWidLike)(v),A=s.get(T);A||(A=new Map,s.set(T,A));var b=A.get(S);b?b.push(y):A.set(S,[y])}}return yield Promise.all(Array.from(s.keys()).map((t=>{var a=s.get(t);if(a){var i=m(e.id);return(0,o.sendAggregateReceipts)(t,i,r,a)}}))),(0,_.markMessageAndChatAsRead)(p,a)}))).apply(this,arguments)}var v=(0,f.createWid)(n.STATUS_JID);function E(){return(E=(0,i.default)((function*(e){if("status"===e.remote.user){var t=String((0,s.unixTime)());yield(0,o.sendAggregateReceipts)(v,m(v),t,new Map([[(0,p.default)(e.participant,"msgKey.participant"),[e.id]]])),yield(0,u.getTable)().merge(e.toString(),{ack:l.default.ACK.READ})}else __LOG__(3)`markStatusRead: message is not a status.`}))).apply(this,arguments)}},14233:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.sendRetryReceipt=function(){return m.apply(this,arguments)},t.prepareKeysForRetry=g;var i=a(r(52954)),n=r(35773),s=r(70338),o=r(7017),l=a(r(23045)),d=r(66239),u=a(r(20468)),c=r(76295),p=r(24606),h=r(8456),f=r(29020),_=r(25054);function m(){return(m=(0,i.default)((function*(e,t,r,a,i,s,l=!1){try{var u=yield p.waSignalStore.getRegistrationInfo();if(!u)throw Error("No registration info found");var c,h,{registrationId:m,identityKeyPair:v}=u,E=yield g(e,v),y=n.DROP_ATTR,S=n.DROP_ATTR;if(t.isUser()){if(h=n.DROP_ATTR,c=(0,f.DEVICE_JID)(t),(0,d.getMeUser)().equals((0,_.toUserWid)(t)))if(l)y=(0,n.CUSTOM_STRING)("peer"),S=n.DROP_ATTR;else{if(!a)return Promise.reject("sendRetryReceipt: send retry to peer device without receipient");S=(0,f.USER_JID)(a)}}else c=(0,f.CHAT_JID)(t),h=r?(0,f.DEVICE_JID)(r):n.DROP_ATTR;var T=(0,n.wap)("receipt",{id:(0,n.CUSTOM_STRING)(i),to:c,participant:h,recipient:S,type:"retry",category:y},(0,n.wap)("retry",{v:"1",count:(0,n.INT)(e),id:(0,n.CUSTOM_STRING)(i),t:(0,n.CUSTOM_STRING)(s)}),(0,n.wap)("registration",null,(0,n.BIG_ENDIAN_CONTENT)(m)),E);return(0,o.sendStanzaAndWaitForAck)(T,{id:i,class:"receipt",from:t,participant:r,type:"retry"})}catch(e){__LOG__(4,void 0,new Error,!0)`error: ${e}`,SEND_LOGS("sendRetryReceipt: error while creating or sending the retry message")}}))).apply(this,arguments)}function g(){return v.apply(this,arguments)}function v(){return(v=(0,i.default)((function*(e,t){var[r,a]=yield E(e,t);return a&&(yield p.waSignalStore.markKeyAsUploaded(a.keyId),yield p.waSignalStore.markPreKeyAsDirectDistribution(a.keyId)),r}))).apply(this,arguments)}function E(e,t){if(e<2)return Promise.resolve([null,null]);var r=Promise.resolve(null);return u.default.supportsFeature(u.default.F.MD_ADV)&&(r=(0,s.getADVEncodedIdentity)().then((e=>(0,n.wap)("device-identity",null,e)))),Promise.all([p.waSignalStore.getSignedPreKey(),p.waSignalStore.getOrGenSinglePreKey(c.generatePreKeyPair),r]).then((([e,r,a])=>{if(!e)throw new Error("Signed pre key is not available");return[(0,n.wap)("keys",null,(0,n.wap)("type",null,l.default.KEY_BUNDLE_TYPE),(0,n.wap)("identity",null,t.pubKey),(0,h.xmppPreKey)(r),(0,h.xmppSignedPreKey)(e),a),r]})).catch((()=>{throw Error("Could not create keys section for retry")}))}},94382:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return c.apply(this,arguments)};var i=a(r(52954)),n=r(35773),s=r(84337),o=r(7017),l=r(66239),d=r(81558),u=r(29020);function c(){return(c=(0,i.default)((function*(e){var t=e.id.id,r=(0,s.decodeB64)(e.mediaKey),{ciphertext:a,iv:i}=yield(0,d.encryptServerErrorReceipt)(r,t),{chat:c}=e,p=(0,n.CUSTOM_STRING)(c.id.toString({legacy:!0})),h=c.isGroup||c.isBroadcast?(0,n.CUSTOM_STRING)(e.sender.toString({legacy:!0})):n.DROP_ATTR,f=(0,l.getMeUser)(),_=(0,n.wap)("receipt",{type:"server-error",to:(0,u.USER_JID)(f),id:(0,n.CUSTOM_STRING)(t)},(0,n.wap)("encrypt",null,(0,n.wap)("enc_p",null,a),(0,n.wap)("enc_iv",null,i)),(0,n.wap)("rmr",{jid:p,from_me:(0,n.CUSTOM_STRING)(String(e.isSentByMe)),participant:h}));return(0,o.sendStanzaAndWaitForAck)(_,{id:t,class:"receipt",type:"server-error",from:f,participant:null})}))).apply(this,arguments)}},67224:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,r){var a=(0,i.wap)("iq",{to:i.S_WHATSAPP_NET,xmlns:"fb:thrift_iq",type:"set",id:(0,i.generateId)()},(0,i.wap)("request",{type:"report_product",biz_jid:(0,l.USER_JID)(e)},r?(0,i.wap)("reason",null,r):void 0,(0,i.wap)("id",null,t)));return(0,n.sendIq)(a,d).then((e=>{if(!e.success)throw new s.ServerStatusCodeError(e.errorCode)}))};var i=r(35773),n=r(7017),s=r(33576),o=a(r(45521)),l=r(29020),d=new o.default("reportProductResponse",(e=>{e.assertTag("iq"),e.child("response").assertAttr("type","report_product")}))},56703:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.reportSpam=function(e,t){var r,a=function(e){var t=[],r=e.isGroup?null:e.id;return v(e,m,r).forEach((r=>{var a,o,l,u,p,m=r.t.toString();switch(r.type){case _.UNKNOWN:u=null,a=i.DROP_ATTR,l=i.DROP_ATTR,o=(0,i.CUSTOM_STRING)(s.CIPHERTEXT_VERSION.toString());break;case _.CIPHERTEXT:u=null,a=i.DROP_ATTR,l=i.DROP_ATTR,o=i.DROP_ATTR;break;default:var g=(0,c.createMsgProtobuf)(r,r.avParams()||{}),v=(0,s.mediaTypeFromProtobuf)(g);u=r.isViewOnce?null:(0,n.encodeProto)(d.MessageSpec,g).readByteArray(),a=(0,h.typeAttributeFromProtobuf)(g),l=v?(0,i.CUSTOM_STRING)(v):i.DROP_ATTR,o=(0,i.CUSTOM_STRING)(s.CIPHERTEXT_VERSION.toString())}if(e.isGroup){var E=i.DROP_ATTR;r.author?E=(0,f.USER_JID)(r.author):r.from.isUser()&&(E=(0,f.USER_JID)(r.from)),p=(0,i.wap)("message",{t:(0,i.CUSTOM_STRING)(m),from:(0,f.CHAT_JID)(e.id),participant:E,id:(0,i.CUSTOM_STRING)(r.id.id),type:a},(0,i.wap)("raw",{v:o,mediatype:l},u))}else p=(0,i.wap)("message",{t:(0,i.CUSTOM_STRING)(m),from:(0,f.USER_JID)(r.from),to:(0,f.USER_JID)(r.to),type:a,id:(0,i.CUSTOM_STRING)(r.id.id)},r.multicast?(0,i.wap)("multicast",null):null,r.urlNumber?(0,i.wap)("url_number",null):null,r.urlText?(0,i.wap)("url_text",null):null,r.isViewOnce?(0,i.wap)("view_once",null):null,(0,i.wap)("raw",{v:o,mediatype:l},u));t.push(p)})),t}(e);if(e.isGroup){var l=e.groupMetadata.owner&&(0,f.USER_JID)(e.groupMetadata.owner);r=(0,i.wap)("iq",{to:i.S_WHATSAPP_NET,type:"set",xmlns:"spam",id:(0,i.generateId)()},(0,i.wap)("spam_list",{creator:l||i.DROP_ATTR,subject:(0,i.CUSTOM_STRING)(e.name),jid:(0,f.CHAT_JID)(e.id),spam_flow:(0,i.CUSTOM_STRING)(String(t))},a))}else r=(0,i.wap)("iq",{to:i.S_WHATSAPP_NET,type:"set",xmlns:"spam",id:(0,i.generateId)()},(0,i.wap)("spam_list",{jid:(0,f.CHAT_JID)(e.id),spam_flow:(0,i.CUSTOM_STRING)(String(t))},a));return(0,o.sendIq)(r,E).then((e=>{if(e.success)return e.result;var{errorCode:t,errorText:r}=e;return __LOG__(3)`reportSpam: sever response with ${t}, ${r}`,{errorCode:t,errorText:r}}))};var i=r(35773),n=r(76549),s=r(74878),o=r(7017),l=a(r(23045)),d=r(99429),u=r(66239),c=r(44052),p=a(r(45521)),h=r(58443),f=r(29020),{MSG_TYPE:_}=l.default,m=5,g=new Set([_.CHAT,_.AUDIO,_.IMAGE,_.PTT,_.VIDEO,_.VCARD,_.UNKNOWN,_.CIPHERTEXT]);function v(e,t,r){for(var a=[],i=e.msgs.toArray().reverse(),n=0;n<i.length&&!(a.length>=t);n++){var s=i[n];if(g.has(s.type)&&!s.from.equals((0,u.getMaybeMeUser)())){if(r){if(e.isGroup&&!r.equals(s.author))continue;if(e.isUser&&!r.equals(s.from))continue}a.push(s)}}return a}var E=new p.default("reportUserSpam",(e=>{if(e.hasChild("error")){var t=e.child("error"),r=t.attrInt("code"),a=t.attrString("text");return __LOG__(3)`reportSpam: sever response with ${r}, ${a}`,{errorCode:r,errorText:a}}__LOG__(2)`reportSpam: success`}))},20120:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var r;switch(t){case"paused":r=(0,a.wap)("paused",null);break;case"composing":r=(0,a.wap)("composing",null);break;case"recording":r=(0,a.wap)("composing",{media:"audio"});break;default:throw new Error(`Impossible value, the default statement should never be reached for value: ${t}`)}return(0,i.castStanza)((0,a.wap)("chatstate",{to:(0,s.CHAT_JID)(e),from:(0,s.JID)((0,n.assertGetMe)())},r))};var a=r(35773),i=r(7017),n=r(66239),s=r(29020)},68551:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.encryptAndSendKeyMsg=function(){return l.apply(this,arguments)};var i=a(r(52954)),n=r(7017),s=r(19446),o=r(44052);function l(){return(l=(0,i.default)((function*(e){__LOG__(2,void 0,void 0,void 0,["messaging"])`encryptAndSendKeyMsg: sending ${e.id.toString()}`;var t=e.to,r=(0,o.createMsgProtobuf)(e),a=yield(0,s.createUserDeviceMsgStanza)(t,null,e.id,r,{type:s.MsgType.AppStateSync});return(0,n.sendStanzaAndWaitForAck)(a,{id:e.id.id,class:"message",from:t,participant:null})}))).apply(this,arguments)}},44311:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.encryptAndSendUserMsg=function(){return p.apply(this,arguments)};var i=a(r(52954)),n=a(r(20412)),s=r(47882),o=r(53),l=r(7017),d=r(29308),u=r(66239),c=a(r(84161));function p(){return(p=(0,i.default)((function*(e,t,r,a=!1){__LOG__(2,void 0,void 0,void 0,["messaging"])`encryptAndSendUserMsg: sending ${e}`;var i=(0,u.assertGetMe)(),n=yield(0,o.getFanOutList)([t,i]),l=yield _(e,t,r,n,a,{fanoutType:d.FANOUT_TYPE.CHAT}),{phash:p}=l;return p&&(__LOG__(2,void 0,void 0,void 0,["messaging"])`encryptAndSendUserMsg: phash mismatch, got server phash ${p}`,new c.default.MdDeviceSyncAck({chatType:c.default.MESSAGE_CHAT_TYPE.INDIVIDUAL,revoke:(0,o.isRevokeMsg)(r)}).commit(),(0,s.syncDeviceList)([t,i],"message",p).then((()=>h(e,t,r,a,n)))),l}))).apply(this,arguments)}function h(){return f.apply(this,arguments)}function f(){return(f=(0,i.default)((function*(e,t,r,a=!1,i){__LOG__(2,void 0,void 0,void 0,["messaging"])`resendUserMsg: resending ${e.id}`;var l=(0,u.assertGetMe)(),c=yield(0,o.getFanOutList)([t,l]),p=(0,n.default)(c,i,String);if(0!==p.length){__LOG__(2,void 0,void 0,void 0,["messaging"])`resendUserMsg: resending to devices ${p.join(",")}`;var{phash:h}=yield _(e,t,r,p,a,{fanoutType:d.FANOUT_TYPE.CHAT,disableFanout:!0});h&&(0,s.syncDeviceList)([t,l],"message",h)}else __LOG__(2,void 0,void 0,void 0,["messaging"])`resendUserMsg: skip sending to the empty list`}))).apply(this,arguments)}function _(){return m.apply(this,arguments)}function m(){return(m=(0,i.default)((function*(e,t,r,a,i=!1,n){var s=yield(0,d.createFanoutMsgStanza)(e,t,r,a,n),u=yield(0,l.sendStanzaAndReturnAck)(s,{id:e.id,class:"message",from:t,participant:null}),c=o.sendMsgAckSyncParser.parse(u);if(c.error)throw new Error("[messaging] sendMsgToDeviceList: Invalid ack from server");return c.success}))).apply(this,arguments)}},53:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.encodeAndPad=function(e){var t=(0,s.encodeProto)(d.MessageSpec,e);return(0,f.writeRandomPadMax16)(t),t.readByteArray()},t.isRevokeMsg=m,t.editAttribute=function(e){return m(e)?(0,n.CUSTOM_STRING)(String(o.default.EDIT_ATTR.REVOKE)):n.DROP_ATTR},t.getFanOutList=function(){return g.apply(this,arguments)},t.isPrimaryDevice=function(e){return null==e.device||e.device===o.default.DEVICE.PRIMARY_DEVICE},t.populateICDCMeta=function(){return E.apply(this,arguments)},t.sendMsgAckSyncParser=void 0;var i=a(r(52954)),n=r(35773),s=r(76549),o=a(r(23045)),l=r(9641),d=r(99429),u=r(66239),c=r(44052),p=r(64757),h=a(r(45521)),f=r(69909),_=r(25054);function m(e){return null!=e.protocolMessage&&e.protocolMessage.type===d.ProtocolMessageType.REVOKE}function g(){return(g=(0,i.default)((function*(e){var t=yield(0,l.getDeviceIds)(e.map((e=>e.user))),r=[],a=(0,u.assertGetMe)();return t.forEach(((t,i)=>{if(t){var{devices:n,id:s}=t;n.forEach((e=>{var t=(0,_.createDeviceWidFromUserAndDevice)(s,e);t.equals(a)||r.push(t)}))}else{__LOG__(2,void 0,void 0,void 0,["messaging"])`getFanOutList: no device is found, just send to the primary device`;var o=(0,_.toUserWid)(e[i]);o.equals(a)||r.push(o)}})),r}))).apply(this,arguments)}var v=new h.default("sendMsgAckSyncParser",(e=>(e.assertTag("ack"),{t:e.attrTime("t"),sync:e.hasAttr("sync")?e.attrString("sync"):null,phash:e.hasAttr("phash")?e.attrString("phash"):null,count:e.hasAttr("count")?e.attrInt("count"):null})));function E(){return(E=(0,i.default)((function*(e,t){var r=(0,u.getMeUser)(),a=yield(0,p.getICDCMeta)(r),i=e.equals(r)?null:yield(0,p.getICDCMeta)(e);(0,c.populateMessageContextInfo)(t,a,i)}))).apply(this,arguments)}t.sendMsgAckSyncParser=v},19446:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.createUserDeviceMsgStanza=function(){return y.apply(this,arguments)},t.createGroupDeviceMsgStanza=function(){return S.apply(this,arguments)},t.MsgType=void 0;var i=a(r(52954)),n=r(35773),s=a(r(47677)),o=r(70338),l=r(74878),d=r(53),u=r(38797),c=r(66239),p=r(44052),h=a(r(20468)),f=r(76604),_=r(47294),m=r(58443),g=r(29020),v=r(25054),E=r(28103).Mirrored(["Retry","AppStateSync"]);function y(){return(y=(0,i.default)((function*(e,t,r,a,i){var n=a;return yield(0,f.ensureE2ESessions)([e]),(0,v.toUserWid)(e).equals((0,c.getMeUser)())&&i.type!==E.AppStateSync?((0,s.default)(null!=t,"[messaging] createDeviceMsgStanza: no recipient for peer device message"),n=(0,p.createDeviceSentMessage)(a,t),yield(0,d.populateICDCMeta)((0,v.toUserWid)(t),n)):yield(0,d.populateICDCMeta)((0,v.toUserWid)(e),n),T(e,null,t,r,n,i)}))).apply(this,arguments)}function S(){return(S=(0,i.default)((function*(e,t,r,a,i){if(yield(0,f.ensureE2ESessions)([t]),i.type===E.AppStateSync)return Promise.reject(new Error("[messaging] createGroupDeviceMsgStanza: not expect for App State Sync message"));var n=(0,v.toUserWid)(t).equals((0,c.getMeUser)())?(0,p.createDeviceSentMessage)(a,e):a;return yield(0,d.populateICDCMeta)((0,v.toUserWid)(t),n),T(e,t,null,r,n,i)}))).apply(this,arguments)}function T(){return A.apply(this,arguments)}function A(){return(A=(0,i.default)((function*(e,t,r,a,i,s){var c,p=null!==(c=s.retryCount)&&void 0!==c?c:0,f=(0,l.mediaTypeFromProtobuf)(i),{type:v,ciphertext:y}=yield(0,u.encryptMsgProtobuf)(t||e,p,i),S=null;if(h.default.supportsFeature(h.default.F.MD_ADV)&&v===_.CiphertextType.Pkmsg){var T=yield(0,o.getADVEncodedIdentity)();S=(0,n.wap)("device-identity",null,T)}return(0,n.wap)("message",{id:(0,n.CUSTOM_STRING)(a.id),to:(0,g.JID)(e),participant:t?(0,g.DEVICE_JID)(t):n.DROP_ATTR,recipient:r?(0,g.USER_JID)(r):n.DROP_ATTR,type:(0,m.typeAttributeFromProtobuf)(i),edit:(0,d.editAttribute)(i),category:s.type===E.AppStateSync?(0,n.CUSTOM_STRING)("peer"):n.DROP_ATTR,push_priority:s.type===E.AppStateSync?(0,n.CUSTOM_STRING)("high"):n.DROP_ATTR},(0,n.wap)("enc",{v:(0,n.CUSTOM_STRING)(l.CIPHERTEXT_VERSION.toString()),type:(0,n.CUSTOM_STRING)(v),count:0===p?n.DROP_ATTR:(0,n.INT)(p),mediatype:(0,l.encodeMaybeMediaType)(f)},y),S)}))).apply(this,arguments)}t.MsgType=E},38797:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.encryptMsgProtobuf=function(){return c.apply(this,arguments)},t.encryptMsgSenderKey=function(){return p.apply(this,arguments)};var n=i(r(52954)),s=r(74878),o=r(53),l=i(r(84161)),d=a(r(7574)),u=r(47294);function c(){return(c=(0,n.default)((function*(e,t,r){var a=(0,s.mediaTypeFromProtobuf)(r),i=new l.default.E2eMessageSend({e2eCiphertextVersion:s.CIPHERTEXT_VERSION,e2eDestination:(0,s.metricsDestinationType)(e),messageMediaType:a?(0,s.metricsMediaType)(a):l.default.MEDIA_TYPE.NONE,retryCount:t});try{var{type:n,ciphertext:u}=yield d.Cipher.encryptSignalProto(e,(0,o.encodeAndPad)(r));return i.e2eCiphertextType=(0,s.metricsCiphertextType)(n),i.e2eSuccessful=!0,i.commit(),{type:n,ciphertext:u}}catch(t){return i.e2eSuccessful=!1,i.weight=1,i.commit(),__LOG__(3,void 0,void 0,void 0,["messaging"])`encryptMsgProtobuf: encryption fail for ${e.toString()}, ${t}`,Promise.reject(new Error(`[messaging] encryptMsgProtobuf: encryption fail for ${e.toString()}, ${t}`))}}))).apply(this,arguments)}function p(){return(p=(0,n.default)((function*(e,t){var r=new l.default.E2eMessageSend({e2eCiphertextType:(0,s.metricsCiphertextType)(u.CiphertextType.Skmsg),e2eCiphertextVersion:s.CIPHERTEXT_VERSION,e2eDestination:l.default.E2E_DESTINATION.GROUP,messageMediaType:l.default.MEDIA_TYPE.NONE,retryCount:0});try{var a=yield d.Cipher.encryptSenderKeyMsgSignalProto(e,t);return r.e2eSuccessful=!0,r.commit(),a}catch(t){return r.e2eSuccessful=!1,r.weight=1,r.commit(),__LOG__(3,void 0,void 0,void 0,["messaging"])`encryptMsgSenderKey: encryption fail for ${e.toString()}, ${t}`,Promise.reject(new Error(`[messaging] encryptMsgSenderKey: encryption fail for ${e.toString()}, ${t}`))}}))).apply(this,arguments)}},29308:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.createFanoutMsgStanza=function(){return T.apply(this,arguments)},t.FANOUT_TYPE=void 0;var i=a(r(52954)),n=r(35773),s=r(70338),o=r(53),l=r(74878),d=r(38797),u=r(66239),c=r(44052),p=a(r(20468)),h=r(76604),f=r(59763),_=r(47294),m=r(58443),g=r(29020),v=r(25054),E=Object.freeze({CHAT:"chat",GROUP_DIRECT:"groupDirect"});function y(){return S.apply(this,arguments)}function S(){return(S=(0,i.default)((function*(e,t,r,a){var s=(0,l.mediaTypeFromProtobuf)(r),p=(0,u.getMeUser)();if(a.fanoutType===E.CHAT&&1===t.length&&(0,o.isPrimaryDevice)(t[0])){var{type:h,ciphertext:f}=yield(0,d.encryptMsgProtobuf)(t[0],0,r);return{shouldHaveIdentity:h===_.CiphertextType.Pkmsg,body:(0,n.wap)("enc",{v:(0,n.CUSTOM_STRING)(l.CIPHERTEXT_VERSION.toString()),type:(0,n.CUSTOM_STRING)(h),mediatype:(0,l.encodeMaybeMediaType)(s)},f)}}var m=!1,y=t.map(function(){var t=(0,i.default)((function*(t){var i=(0,v.toUserWid)(t).equals(p)?(0,c.createDeviceSentMessage)(r,e):r,u=a.fanoutType===E.GROUP_DIRECT?(0,v.toUserWid)(t):(0,v.toUserWid)(e);yield(0,o.populateICDCMeta)(u,i);try{var{type:h,ciphertext:f}=yield(0,d.encryptMsgProtobuf)(t,0,i);return h===_.CiphertextType.Pkmsg&&(m=!0),(0,n.wap)("to",{jid:(0,g.DEVICE_JID)(t)},(0,n.wap)("enc",{v:(0,n.CUSTOM_STRING)(l.CIPHERTEXT_VERSION.toString()),type:(0,n.CUSTOM_STRING)(h),mediatype:(0,l.encodeMaybeMediaType)(s)},f))}catch(e){return(0,o.isPrimaryDevice)(t)&&(__LOG__(4,void 0,new Error,!0,["messaging"])`encryptAndSendUserMsg: encryption fail for primary device ${String(t)}`,SEND_LOGS("encryption-fail-for-primary-device")),null}}));return function(){return t.apply(this,arguments)}}()),S=(yield Promise.all(y)).filter((e=>null!=e));return S.length>0?{body:(0,n.wap)("participants",null,S),shouldHaveIdentity:m}:Promise.reject(new Error("[messaging] encryptAndSendUserMsg: encryption fail for all devices"))}))).apply(this,arguments)}function T(){return(T=(0,i.default)((function*(e,t,r,a,i){try{yield(0,h.ensureE2ESessions)(a)}catch(e){__LOG__(4,void 0,new Error,void 0,["messaging"])`ensureE2ESessions with error`}var d=a.map((t=>({msgKey:e,receiverId:t})));yield(0,f.createOrMergeReceiptRecords)(d);var u=yield y(t,a,r,i),c=i.fanoutType===E.GROUP_DIRECT?(0,n.wap)("enc",{v:(0,n.CUSTOM_STRING)(l.CIPHERTEXT_VERSION.toString()),type:(0,n.CUSTOM_STRING)(_.CiphertextType.Skmsg)}):null,v=null;if(p.default.supportsFeature(p.default.F.MD_ADV)&&u.shouldHaveIdentity){var S=yield(0,s.getADVEncodedIdentity)();v=(0,n.wap)("device-identity",null,S)}var{id:T}=e;return(0,n.wap)("message",{id:(0,n.CUSTOM_STRING)(T),to:(0,g.CHAT_JID)(t),type:(0,m.typeAttributeFromProtobuf)(r),edit:(0,o.editAttribute)(r),device_fanout:i.disableFanout?(0,n.CUSTOM_STRING)("false"):n.DROP_ATTR},u.body,c,v)}))).apply(this,arguments)}t.FANOUT_TYPE=E},8803:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.encryptAndSendGroupDirectMsg=function(){return p.apply(this,arguments)},t.resendGroupMsg=h;var i=a(r(52954)),n=a(r(20412)),s=r(47882),o=r(53),l=r(7017),d=r(29308),u=a(r(84161)),c=r(25054);function p(){return(p=(0,i.default)((function*(e,t,r,a){__LOG__(2,void 0,void 0,void 0,["messaging"])`encryptAndSendGroupDirectMsg: sending ${e} with group ${t.toString()}`;var i=yield _(e,t,r,a,{fanoutType:d.FANOUT_TYPE.GROUP_DIRECT}),{phash:n}=i;return n&&(__LOG__(2,void 0,void 0,void 0,["messaging"])`encryptAndSendGroupDirectMsg: phash mismatch, got server phash ${n}`,new u.default.MdDeviceSyncAck({chatType:u.default.MESSAGE_CHAT_TYPE.GROUP,revoke:(0,o.isRevokeMsg)(r)}).commit(),(0,s.syncDeviceList)(a,"message",n).then((()=>h(e,t,r,a)))),i}))).apply(this,arguments)}function h(){return f.apply(this,arguments)}function f(){return(f=(0,i.default)((function*(e,t,r,a){__LOG__(2,void 0,void 0,void 0,["messaging"])`resendGroupMsg: to ${t.toString()}`;var i=Array.from(new Set(a.map((e=>e.user)))).map((e=>(0,c.createUserWid)(e))),s=yield(0,o.getFanOutList)(i),l=(0,n.default)(s,a,String);0!==l.length?(__LOG__(2,void 0,void 0,void 0,["messaging"])`resendGroupMsg: resending to devices ${l.join(",")}`,yield _(e,t,r,l,{fanoutType:d.FANOUT_TYPE.GROUP_DIRECT,disableFanout:!0})):__LOG__(2,void 0,void 0,void 0,["messaging"])`resendGroupMsg: skip sending to the empty list`}))).apply(this,arguments)}function _(){return m.apply(this,arguments)}function m(){return(m=(0,i.default)((function*(e,t,r,a,i){var n=yield(0,d.createFanoutMsgStanza)(e,t,r,a,i),s=yield(0,l.sendStanzaAndReturnAck)(n,{id:e.id,class:"message",from:t,participant:null}),u=o.sendMsgAckSyncParser.parse(s);return u.error?Promise.reject(new Error("[messaging] encryptAndSendGroupDirectMsg: Invalid ack from server")):u.success}))).apply(this,arguments)}},64319:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.encryptAndSendGroupMsg=function(){return g.apply(this,arguments)};var i=a(r(52954)),n=r(8803),s=r(99429),o=a(r(20468)),l=a(r(83746)),d=r(61333),u=r(29724),c=r(25054),p=r(53),h=r(38027),f=Object.freeze({SKMSG:"skmsg",DIRECT:"direct"});function _(){return m.apply(this,arguments)}function m(){return(m=(0,i.default)((function*(e,t){var r=yield(0,d.getGroupSenderKeyList)(e),a={senderKeyList:r,type:f.SKMSG};if(t&&o.default.supportsFeature(o.default.F.MD_BACKEND)){var i=yield(0,h.getMsgInfoTable)().equals(["msgKey"],String(t));if(0===i.length)return a;var{skDistribList:n,skList:s}=r,l=new Set(n.concat(s).map((e=>String((0,c.toUserWid)(e))))),u=i.filter((e=>!l.has(e.receiverUserJid))).map((e=>(0,c.createWid)(e.receiverUserJid)));if(0===u.length)return a;var _=[...yield(0,p.getFanOutList)(u),...s,...n];return{type:f.DIRECT,deviceList:_}}return a}))).apply(this,arguments)}function g(){return(g=(0,i.default)((function*(e,t,r){__LOG__(2,void 0,void 0,void 0,["messaging"])`encryptAndSendGroupMsg: sending ${e}`;var{protocolMessage:a}=r,i=null;if((null==a?void 0:a.type)===s.ProtocolMessageType.REVOKE&&(null==a?void 0:a.key)){var{remoteJid:o,id:d,participant:p}=a.key;o&&d&&p&&(i=new l.default({remote:(0,c.createWid)(o),fromMe:!0,id:d,participant:(0,c.createWid)(p)}))}var h=yield _(t,i);if(h.type===f.DIRECT){var{deviceList:m}=h;return(0,n.encryptAndSendGroupDirectMsg)(e,t,r,m)}var{senderKeyList:g}=h;return(0,u.encryptAndSendSenderKeyMsg)(e,t,r,g)}))).apply(this,arguments)}},29724:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.encryptAndSendSenderKeyMsg=function(){return N.apply(this,arguments)};var n=i(r(52954)),s=r(35773),o=r(19129),l=r(70338),d=r(74878),u=r(53),c=r(7017),p=r(8803),h=r(38797),f=r(66239),_=i(r(20468)),m=r(76604),g=r(43730),v=r(59763),E=i(r(84161)),y=r(61333),S=r(17063),T=r(12390),A=a(r(7574)),b=r(47294),C=r(58443),P=r(29020),O=r(25054);function w(){return M.apply(this,arguments)}function M(){return(M=(0,n.default)((function*(e,t){if(0===t.length)return null;try{yield(0,m.ensureE2ESessions)(t)}catch(e){__LOG__(4,void 0,new Error,void 0,["messaging"])`ensureE2ESessions with error`}var r=yield A.Session.getGroupSenderKeyInfo(e),a={senderKeyDistributionMessage:{groupId:e.toString({legacy:!0}),axolotlSenderKeyDistributionMessage:r}},i=t.map(function(){var e=(0,n.default)((function*(e){try{yield(0,u.populateICDCMeta)((0,O.toUserWid)(e),a);var t=yield(0,h.encryptMsgProtobuf)(e,0,a);return{type:t.type,ciphertext:t.ciphertext,participant:e}}catch(t){if(__LOG__(2,void 0,void 0,void 0,["messaging"])`encryptAndSendUserMsg: encryption fail for ${e.toString()}, ${t}`,(0,u.isPrimaryDevice)(e))return Promise.reject(new Error(`[messaging] encryptAndSendUserMsg: encryption fail for primary device ${String(e)}`))}}));return function(){return e.apply(this,arguments)}}());return(yield Promise.all(i)).filter(Boolean)}))).apply(this,arguments)}function I(){return R.apply(this,arguments)}function R(){return(R=(0,n.default)((function*(e,t,r){var a=(0,u.encodeAndPad)(r),i=(0,d.mediaTypeFromProtobuf)(r),n=yield w(e,t,a),o=yield(0,h.encryptMsgSenderKey)(e,a),c=null,p=!1;n&&n.length>0&&(c=(0,s.wap)("participants",null,n.map((({type:e,ciphertext:t,participant:r})=>(e===b.CiphertextType.Pkmsg&&(p=!0),(0,s.wap)("to",{jid:(0,P.DEVICE_JID)(r)},(0,s.wap)("enc",{v:(0,s.CUSTOM_STRING)(d.CIPHERTEXT_VERSION.toString()),type:(0,s.CUSTOM_STRING)(e)},t)))))));var f=(0,s.wap)("enc",{v:(0,s.CUSTOM_STRING)(d.CIPHERTEXT_VERSION.toString()),type:(0,s.CUSTOM_STRING)(b.CiphertextType.Skmsg),mediatype:(0,d.encodeMaybeMediaType)(i)},o.ciphertext),m=null;if(_.default.supportsFeature(_.default.F.MD_ADV)&&p){var g=yield(0,l.getADVEncodedIdentity)();m=(0,s.wap)("device-identity",null,g)}return[c,f,m]}))).apply(this,arguments)}var D=new o.PromiseQueueMap;function N(){return(N=(0,n.default)((function*(e,t,r,a){__LOG__(2,void 0,void 0,void 0,["messaging"])`encryptAndSendSenderKeyMsg: sending ${e}`;var{id:i}=e,{skDistribList:o,skList:l,rotateKey:d}=a,h=l.concat(o),_=yield(0,S.phashV2)([...h,(0,f.assertGetMe)()]);yield(0,v.createOrMergeReceiptRecords)(h.map((t=>({msgKey:e,receiverId:t}))));var[m,b,O]=yield D.enqueue(t.toString(),(0,n.default)((function*(){return d&&(yield A.Session.deleteGroupSenderKeyInfo(t)),I(t,o,r)}))),w=(0,s.wap)("message",{id:(0,s.CUSTOM_STRING)(i),to:(0,P.CHAT_JID)(t),phash:(0,s.CUSTOM_STRING)(_),type:(0,C.typeAttributeFromProtobuf)(r),edit:(0,u.editAttribute)(r)},m,b,O),M=yield(0,c.sendStanzaAndReturnAck)(w,{id:i,class:"message",from:t,participant:null}),R=u.sendMsgAckSyncParser.parse(M);if(R.error)return __LOG__(3,void 0,void 0,void 0,["messaging"])`encryptAndSendSenderKeyMsg: Invalid ack from server`,Promise.reject(new Error("[messaging] encryptAndSendSenderKeyMsg: Invalid ack from server"));yield(0,y.markHasSenderKey)(t,o);var{phash:N,count:L}=R.success;return N&&N!==_&&(__LOG__(2,void 0,void 0,void 0,["messaging"])`encryptAndSendSenderKeyMsg: phash mismatch, got server phash ${N}`,new E.default.MdDeviceSyncAck({chatType:E.default.MESSAGE_CHAT_TYPE.GROUP,revoke:(0,u.isRevokeMsg)(r)}).commit(),(0,T.sendQueryGroup)(t).then((()=>{(0,p.resendGroupMsg)(e,t,r,h)}))),null!=L&&(0,g.getTable)().merge(String(e),{count:L}),R.success}))).apply(this,arguments)}},45822:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.encryptAndSendMsg=function(e){var t,r=e.id,a=e.to;if(!r||!r.id)return Promise.reject(new Error("[messaging] sending message without an id"));if(!a)return Promise.reject(new Error("[messaging] sending message without an remote id"));e.asMms&&(t=e.isUnsentPhoneMsg()?{type:e.type}:e.avParams());var l=(0,n.createMsgProtobuf)(e,t||{});if(a.isUser())return(0,i.encryptAndSendUserMsg)(r,a,l,e.multicast);if(a.isGroup())return o.default.find(a).then((()=>(0,s.encryptAndSendGroupMsg)(r,a,l)));return Promise.reject(new Error("[messaging] unsupported remote jid type"))},Object.defineProperty(t,"sendRetry",{enumerable:!0,get:function(){return l.sendRetry}}),Object.defineProperty(t,"encodeAndPad",{enumerable:!0,get:function(){return d.encodeAndPad}}),Object.defineProperty(t,"getFanOutList",{enumerable:!0,get:function(){return d.getFanOutList}});var i=r(44311),n=r(44052),s=r(64319),o=a(r(25120)),l=r(29212),d=r(53)},29212:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.sendRetry=function(){return d.apply(this,arguments)};var i=a(r(52954)),n=a(r(47677)),s=r(7017),o=r(19446),l=r(44052);function d(){return(d=(0,i.default)((function*(e,t,r,a,i){var d,u=a.id.id;__LOG__(2,void 0,void 0,void 0,["messaging"])`sendRetry: id ${u} to ${e.toString()}, requester: ${(t||e).toString()}, count: ${i}`,a.asMms&&(d=a.isUnsentPhoneMsg()?{type:a.type}:a.avParams());var c,p=(0,l.createMsgProtobuf)(a,d||{}),h={type:o.MsgType.Retry,retryCount:i};return e.isUser()?c=yield(0,o.createUserDeviceMsgStanza)(e,r,a.id,p,h):((0,n.default)(null!=t,"[messaging] sendRetry: no participant for group retry message"),c=yield(0,o.createGroupDeviceMsgStanza)(e,t,a.id,p,h)),__LOG__(2,void 0,void 0,void 0,["messaging"])`sendRetry: sending ${u} to ${e.toString()}`,(0,s.sendStanzaAndWaitForAck)(c,{id:u,class:"message",from:e,participant:t})}))).apply(this,arguments)}},37534:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,n.castStanza)((0,i.wap)("presence",{type:e,name:(0,i.MAYBE_CUSTOM_STRING)(s.default.pushname)}))};var i=r(35773),n=r(7017),s=a(r(79435))},6922:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,i.castStanza)((0,a.wap)("presence",{id:(0,a.generateId)(),to:(0,n.CHAT_JID)(e),type:"subscribe"}))};var a=r(35773),i=r(7017),n=r(29020)},91886:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return(0,n.sendIq)((0,i.wap)("iq",{to:(0,l.CHAT_JID)(e),type:"set",xmlns:"w:profile:picture",id:(0,i.generateId)()},t?(0,i.wap)("picture",{type:"image"},t):null),d).then((e=>e.success?{id:e.result.id}:Promise.reject(new s.ServerStatusCodeError(e.errorCode,e.errorText))))};var i=r(35773),n=r(7017),s=r(33576),o=a(r(45521)),l=r(29020),d=new o.default("photoResponseParser",(e=>(e.assertAttr("type","result"),e.hasChild("picture")?{id:e.child("picture").attrInt("id")}:{id:null})))},99785:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,i.castStanza)((0,a.wap)("presence",{name:(0,a.MAYBE_CUSTOM_STRING)(e)}))};var a=r(35773),i=r(7017)},4106:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var r=(0,i.wap)("iq",{to:i.S_WHATSAPP_NET,type:"set",xmlns:"w:stats",id:(0,i.generateId)()},(0,i.wap)("add",{t:(0,i.INT)(t)},e));return(0,n.sendIq)(r,s).then((e=>{if(!e.success){var{errorCode:t,errorText:r}=e;return __LOG__(3)`fieldStatsUpload: sever response with ${t}, ${r}`,{errorCode:t,errorText:r}}}))};var i=r(35773),n=r(7017),s=new(a(r(45521)).default)("uploadStats",(e=>{if(e.hasChild("error")){var t=e.child("error"),r=t.attrInt("code"),a=t.attrString("text");return __LOG__(3)`fieldStatsUpload: sever response with ${r}, ${a}`,{errorCode:r,errorText:a}}__LOG__(2)`fieldStatsUpload: success`}))},47294:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MediaType=t.CiphertextType=void 0;var a=r(28103)({Skmsg:"skmsg",Pkmsg:"pkmsg",Msg:"msg"});t.CiphertextType=a;var i=r(28103)({Photo:"photo",Video:"video",Audio:"audio",Ptt:"ptt",Location:"location",Contact:"contact",Document:"document",Url:"url",Call:"call",Gif:"gif",Future:"future",ContactArray:"contact_array",LiveLocation:"live_location",ProfilePic:"profile_pic",Sticker:"sticker",Hsm:"hsm",ProductImage:"product_image",Template:"template",MdAppState:"md_app_state",MdHistorySync:"md_history_sync",List:"list",ListResponse:"list_response",Button:"button",ButtonResponse:"button_response",Order:"order",Product:"product"});t.MediaType=i},9247:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){var e=(0,i.wap)("iq",{to:i.S_WHATSAPP_NET,type:"set",id:(0,i.generateId)(),xmlns:"md"},(0,i.wap)("remove-companion-device",{jid:(0,l.DEVICE_JID)((0,s.assertGetMe)())}));return(0,n.sendIq)(e,d).then((e=>e.success?{status:e.result.status}:{status:e.errorCode}))};var i=r(35773),n=r(7017),s=r(66239),o=a(r(45521)),l=r(29020),d=new o.default("unpairResponse",(e=>{e.assertTag("iq"),e.assertFromServer();var t=200;return"error"===e.attrString("type")&&(t=e.child("error").attrInt("code")),{status:t}}))},52663:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.uploadPreKeys=function(){var e=new n.PromiseRetryLoop({name:"uploadPreKeys",timer:f,code:e=>(__LOG__(2)`uploadPreKeys: running`,Promise.all([u.waSignalStore.getRegistrationInfo(),u.waSignalStore.getSignedPreKey()]).then((([e,t])=>{if(!e||!t)throw new Error("No signal info is available");var{registrationId:r,identityKeyPair:a}=e;return u.waSignalStore.getOrGenPreKeys(30,l.generatePreKeyPair).then((e=>{if(0===e.length)throw new Error("No preKey is available");return[(0,i.wap)("iq",{id:(0,i.generateId)(),xmlns:"encrypt",type:"set",to:i.S_WHATSAPP_NET},(0,i.wap)("registration",null,(0,i.BIG_ENDIAN_CONTENT)(r)),(0,i.wap)("type",null,o.default.KEY_BUNDLE_TYPE),(0,i.wap)("identity",null,a.pubKey),(0,i.wap)("list",null,e.map(c.xmppPreKey)),(0,c.xmppSignedPreKey)(t)),e[e.length-1].keyId]})).then((([e,t])=>(0,s.waitForConnection)().then((()=>u.waSignalStore.markKeyAsUploaded(t))).then((()=>(0,s.sendIqWithoutRetry)(e,h))).then((e=>{if(e.success)return u.waSignalStore.setServerHasPreKeys(!0),{success:!0};var t=e.errorCode;return t>=500?__LOG__(3)`_uploadPreKeys: server requested backoff ${t}`:406===t?__LOG__(3)`_uploadPreKeys: uploaded invalid keys`:__LOG__(3)`_uploadPreKeys: unrecognized error ${t}`,{errorCode:e.errorCode,errorText:e.errorText}})).catch((()=>{__LOG__(3)`_uploadPreKeys: disconnected, unclear if on server`}))))})).then((t=>{t&&t.success?e():__LOG__(2)`uploadPreKeys: retrying (after delay)`})))});return e.start(),e.promise()};var i=r(35773),n=r(68053),s=r(7017),o=a(r(23045)),l=r(76295),d=a(r(45521)),u=r(24606),c=r(8456),p={error:!1,result:!0},h=new d.default("uploadPreKeyResParser",(e=>{if(e.assertTag("iq"),e.assertFromServer(),e.attrEnum("type",p))return{success:!0};var t=e.child("error");return{errorCode:t.attrInt("code"),errorText:t.hasAttr("text")?t.attrString("text"):""}}));var f={algo:{type:"fibonacci",first:1e3,second:2e3},max:61e4}},91253:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.onMsgProcessingThread=function(){return c.apply(this,arguments)},t.waitForOfflineMsgThread=function(e){return e?u.chatQueue.wait(e):u.allChatQueue.wait()},t._online=t._waitForMainStream=void 0;var i=a(r(52954)),n=r(19129),s=a(r(13277)),o=a(r(33640)),l=new Promise((e=>{s.default.on("main_stream_mode_ready",(()=>{e()}))}));t._waitForMainStream=l;var d={allChatQueue:new n.PromiseQueue(5e3),chatQueue:new n.PromiseQueueMap};t._online=d;var u={allChatQueue:new n.PromiseQueue,chatQueue:new n.PromiseQueueMap};function c(){return(c=(0,i.default)((function*(e,t,r){return t&&!o.default.isResumeFromRestartComplete()?u.allChatQueue.enqueue((()=>u.chatQueue.enqueue(e,r))):(yield l,d.allChatQueue.enqueue((()=>d.chatQueue.enqueue(e,r))))}))).apply(this,arguments)}},73859:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return T.apply(this,arguments)};var n=i(r(52954)),s=r(35773),o=r(70338),l=r(74878),d=r(7017),u=i(r(23045)),c=i(r(20468)),p=r(76604),h=i(r(2661)),f=r(45822),_=a(r(7574)),m=r(47294),g=a(r(91949)),v=r(29020),E=i(r(43926)),y=r(25054),{VOIP_LOG_COLOR:S}=u.default;function T(){return(T=(0,n.default)((function*(e,t){var r=e.common,a=(0,y.createWid)(r.peer_jid);if(E.default.isGroupCall(a))return A((0,s.CUSTOM_STRING)(r.peer_jid),a,e);try{return A(yield C(e,a,t),a,e)}catch(e){__LOG__(3)`voip:encryptAndSendSignalingMsg: Failed to encrypt and send msg`}}))).apply(this,arguments)}function A(){return b.apply(this,arguments)}function b(){return(b=(0,n.default)((function*(e,t,r){var a=(0,v.voipXmlToWapNode)(r.payload),i=(0,h.default)(),n=(0,s.wap)("call",{to:e,id:(0,s.CUSTOM_STRING)(i)},a),o=yield(0,d.sendStanzaAndReturnAck)(n,{id:i,class:"call",from:t,participant:null});return{payload:(0,v.wapNodeToVoipXml)(o),status:200}}))).apply(this,arguments)}function C(){return P.apply(this,arguments)}function P(){return(P=(0,n.default)((function*(e,t,r){var a=e.payload[2].findIndex((e=>"destination"===e[0])),i=e.payload[2][a];if(i){e.payload[0]!==g.TYPE_STR.OFFER&&(__LOG__(4,void 0,new Error,!0)`Assertion failed!`,SEND_LOGS("call offer check"));var s=i[2].map((e=>(0,y.createDeviceWidFromUserAndDevice)(e[1].jid.user,e[1].jid.device)));try{yield(0,p.ensureE2ESessions)(s)}catch(e){__LOG__(3)`voip:encryptMsgCallKey: Could not establish E2E session with all deviceWids`}var o=!1,l=!1;return yield Promise.all(i[2].map(function(){var t=(0,n.default)((function*(t,r){if(O(t[2])){var a=R(t[2]),i=s[r];try{var{encNode:n,shouldHaveIdentity:d}=yield D(a,i,I(e.payload[2]));l=l||d,M(t[2],n)}catch(e){__LOG__(3)`voip:encryptMsgCallKey: Signal encryption failed for ${i.toString()}, ${e}`,o=!0}}}));return function(){return t.apply(this,arguments)}}())),o?(__LOG__(3)`voip:encryptMsgCallKey: Removing all enc nodes due to encryption failure`,i[2].forEach((e=>w(e)))):l&&(yield L(e.payload[2])),(0,v.USER_JID)(t)}if(!O(e.payload[2]))return(0,v.DEVICE_JID)(t);try{var d=[t];if(t.isCompanion()){var c=(0,y.createDeviceWidFromUserAndDevice)(t.user,u.default.DEVICE.PRIMARY_DEVICE);d.unshift(c)}yield(0,p.ensureE2ESessions)(d)}catch(e){__LOG__(3)`voip:encryptAndSendSignalingMsg: Could not establish E2E session with deviceWid`}var h,f,_=R(e.payload[2]);try{var m=yield D(_,t,I(e.payload[2]));h=m.encNode,f=m.shouldHaveIdentity}catch(e){if(r!==g.TYPE.OFFER)throw e;h=null,f=!1,__LOG__(3)`voip:encryptAndSendSignalingMsg: Sending offer without enc`}return M(e.payload[2],h),f&&(yield L(e.payload[2])),(0,v.DEVICE_JID)(t)}))).apply(this,arguments)}function O(e){return null!=e&&e.findIndex((e=>"enc"===e[0]))>=0}function w(e){if(null!=e){var t=e.findIndex((e=>"enc"===e[0]));e.splice(t,1)}}function M(e,t){var r=e.findIndex((e=>"enc"===e[0]));r>=0&&(e[r]=t)}function I(e){var t=e.find((e=>"enc"===e[0])),r=t&&t[1]&&t[1].count;return null!=r?r:0}function R(e){var t=e.find((e=>"enc"===e[0])),r=t&&t[2];return{call:{callKey:new Uint8Array(r)}}}function D(){return N.apply(this,arguments)}function N(){return(N=(0,n.default)((function*(e,t,r){var{type:a,ciphertext:i}=yield _.Cipher.encryptSignalProto(t,(0,f.encodeAndPad)(e));return{encNode:(0,s.wap)("enc",{v:(0,s.CUSTOM_STRING)(l.CIPHERTEXT_VERSION.toString()),type:(0,s.CUSTOM_STRING)(a),count:(0,s.INT)(r)},i),shouldHaveIdentity:a===m.CiphertextType.Pkmsg}}))).apply(this,arguments)}function L(){return k.apply(this,arguments)}function k(){return(k=(0,n.default)((function*(e){if(c.default.supportsFeature(c.default.F.MD_ADV)){var t=yield(0,o.getADVEncodedIdentity)();e.push((0,s.wap)("device-identity",null,t))}}))).apply(this,arguments)}},93364:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return o.apply(this,arguments)};var i=a(r(52954)),n=r(14233),s=r(24606);function o(){return(o=(0,i.default)((function*(e){var t,r=yield s.waSignalStore.getRegistrationInfo();if(!r)throw Error("No registration info found");var{identityKeyPair:a}=r,i=null!==(t=e[1]&&parseInt(e[1].count,10))&&void 0!==t?t:0,o=yield(0,n.prepareKeysForRetry)(i,a);return o&&e[2]&&Array.isArray(e[2])&&e[2].push(o),e}))).apply(this,arguments)}},33288:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t,r,a=e.common,u=(0,d.createWid)(a.peer_jid);u.isGroupCall()?(t=(0,l.GROUP_CALL_JID)(u),r=Promise.resolve()):(t=(0,l.DEVICE_JID)(u),r=(0,s.ensureE2ESessions)([u]));return r.then((()=>{var r=(0,l.voipXmlToWapNode)(e.payload),a=(0,o.default)(),s=(0,i.wap)("call",{to:t,id:(0,i.CUSTOM_STRING)(a)},r);return(0,n.sendStanzaAndReturnAck)(s,{id:a,class:"call",from:u,participant:null}).then((e=>({payload:(0,l.wapNodeToVoipXml)(e),status:200})))}))};var i=r(35773),n=r(7017),s=r(76604),o=a(r(2661)),l=r(29020),d=r(25054)},93048:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return u.apply(this,arguments)};var i=a(r(52954)),n=r(35773),s=r(7017),o=r(24606),l=r(91949),d=r(29020);function u(){return(u=(0,i.default)((function*(e,t,r=0){var a=yield o.waSignalStore.getRegistrationInfo();if(!a)throw Error("No registration info found");var i=(0,n.wap)("receipt",{to:(0,d.DEVICE_JID)(t.peer_jid),id:(0,n.CUSTOM_STRING)(e),type:(0,n.CUSTOM_STRING)(l.ENC_RETRY_RECEIPT_ATTRS.GROUP_CALL)},(0,n.wap)("enc_rekey",{"call-creator":(0,d.DEVICE_JID)(t.call_creator),"call-id":(0,n.CUSTOM_STRING)(t.call_id),count:(0,n.INT)(r+1)}),(0,n.wap)("registration",null,(0,n.BIG_ENDIAN_CONTENT)(a.registrationId)));(0,s.castStanza)(i)}))).apply(this,arguments)}},90826:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.getClientPayloadForLogin=function(e){var t=(0,c.assertGetMe)(),r=(0,i.default)((0,i.default)({},_(e)),{},{username:parseInt(t.user,10),device:null!=t.device?t.device:0});return(0,n.encodeProto)(f.ClientPayloadSpec,r).readByteArray()},t.getClientPayloadForRegistration=function(e,t,r){var a=m(),s=g(),o=(0,i.default)((0,i.default)({},_(r)),{},{regData:{buildHash:a,companionProps:s,eRegid:(0,l.intToBytes)(4,e.registrationId),eKeytype:(0,l.intToBytes)(1,5),eIdent:e.identityKeyPair.pubKey,eSkeyId:(0,l.intToBytes)(3,t.keyId),eSkeyVal:t.keyPair.pubKey,eSkeySig:t.signature}});return(0,n.encodeProto)(f.ClientPayloadSpec,o).readByteArray()},t.getBuildHash=m,t.getCompanionProps=g,t.getUserAgent=v,t.getPlatformTypeFromName=E,t.getWebSubPlatform=y;var i=a(r(70417)),n=r(76549),s=r(84337),o=a(r(92082)),l=r(41026),d=r(1935),u=a(r(23045)),c=r(66239),p=r(99117),h=a(r(75584)),f=r(49592);function _(e){return{passive:!!e&&e.passive,connectType:f.ClientPayloadConnectType.WIFI_UNKNOWN,connectReason:f.ClientPayloadConnectReason.USER_ACTIVATED,userAgent:v(),webInfo:{webSubPlatform:y()}}}function m(){var e=(0,s.decodeB64)((0,h.default)(u.default.VERSION_BASE));return new Uint8Array(e)}function g(){var e,t=o.default.info();if(t.version&&""!==t.version){var r=t.version.split(".");r.length>0&&t.version&&/^[0-9\.]+$/.test(t.version)&&(e={primary:parseInt(r[0],10),secondary:r.length>1?parseInt(r[1],10):void 0,tertiary:r.length>2?parseInt(r[2],10):void 0})}var a={os:t.os,version:e,platformType:E(t.name),requireFullSync:!1};return(0,n.encodeProto)(d.CompanionPropsSpec,a).readByteArray()}function v(){var e=p.deviceInfo.get(),t=f.UserAgentReleaseChannel.RELEASE;return{appVersion:{primary:u.default.VERSION.p,secondary:u.default.VERSION.s,tertiary:u.default.VERSION.t},platform:f.UserAgentPlatform.WEB,releaseChannel:t,mcc:e.mcc,mnc:e.mnc,osVersion:e.osVersion,manufacturer:e.manufacturer,device:e.device,osBuildNumber:e.osBuild,localeLanguageIso6391:e.lg,localeCountryIso31661Alpha2:e.lc}}function E(e){switch(e){case"Chrome":return d.CompanionPropsPlatformType.CHROME;case"Firefox":return d.CompanionPropsPlatformType.FIREFOX;case"IE":return d.CompanionPropsPlatformType.IE;case"Opera":return d.CompanionPropsPlatformType.OPERA;case"Safari":return d.CompanionPropsPlatformType.SAFARI;case"Edge":return d.CompanionPropsPlatformType.EDGE;case"electron":case"Desktop":return d.CompanionPropsPlatformType.DESKTOP;case"ipad":case"iPad":return d.CompanionPropsPlatformType.IPAD;case"tablet":case"Android tablet":return d.CompanionPropsPlatformType.ANDROID_TABLET;case"Ohana":return d.CompanionPropsPlatformType.OHANA;case"Aloha":return d.CompanionPropsPlatformType.ALOHA;case"Catalina":return d.CompanionPropsPlatformType.CATALINA;default:return d.CompanionPropsPlatformType.UNKNOWN}}function y(){switch(u.default.WAM_PLATFORM){case"WEB":return f.WebInfoWebSubPlatform.WEB_BROWSER;case"DARWIN":case"DARWIN_BETA":return f.WebInfoWebSubPlatform.DARWIN;case"WIN32":case"WIN32_BETA":return f.WebInfoWebSubPlatform.WIN32;case"MACSTORE":return f.WebInfoWebSubPlatform.APP_STORE;case"WINSTORE":return f.WebInfoWebSubPlatform.WIN_STORE;default:return}}},84689:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){if(!(0,y.isRegistered)())return t=e,M().then((e=>Promise.all([T.waSignalStore.getRegistrationInfo(),T.waSignalStore.getSignedPreKey(),e]))).then((([e,r,a])=>{if(!r||!e)throw new Error("Invalid signal credentials");var i=(0,m.getClientPayloadForRegistration)(e,r,t),s=(0,S.default)(E.waNoiseInfo.get(),"waNoiseInfo.get()").staticKeyPair;return Promise.all([I(s,n,a),n.encrypt(Promise.resolve(i))])})).then((([e,t])=>(n.send((0,c.encodeProto)(b.HandshakeMessageSpec,{clientFinish:{static:e,payload:t}}).readByteArray()),n.finish()))).then((e=>(__LOG__(2)`openChatSocketForRegistration success, resetting round`,e))).catch((e=>{__LOG__(3)`openChatSocketForRegistration error ${e}`}));var t;return function(e){return M().then((t=>{g.default.incrementProgress();var r=(0,S.default)(E.waNoiseInfo.get(),"waNoiseInfo.get()").staticKeyPair,a=(0,m.getClientPayloadForLogin)(e);return Promise.all([I(r,n,t),n.encrypt(Promise.resolve(a))])})).then((([e,t])=>(g.default.incrementProgress(),n.send((0,c.encodeProto)(b.HandshakeMessageSpec,{clientFinish:{static:e,payload:t}}).readByteArray()),n.finish()))).then((e=>(g.default.incrementProgress(),__LOG__(2)`openChatSocketForLogin success, resetting round`,e))).catch((e=>{__LOG__(3)`openChatSocketForLogin error ${e}`}))}(e)};var n,s=r(39760),o=r(88906),l=r(2406),d=r(26540),u=r(9557),c=r(76549),p=r(49244),h=r(84337),f=r(61212),_=r(95334),m=r(90826),g=i(r(13277)),v=a(r(446)),E=r(99117),y=r(63191),S=i(r(21830)),T=r(24606),A=i(r(32463)),b=r(49592),C=i(r(57568)),P=new Uint8Array([87,65,5,s.DICT_VERSION]),O="WhatsAppLongTerm1",w="142375574d0a587166aae71ebe516437c4a28b73e3695c6ce1f7f9545da8ee6b";function M(){var e=(0,y.getRoutingInfo)(),t=e?e.edgeRouting:null,r=t?(0,h.encodeB64UrlSafe)(t):null,a=new A.default({routingToken:r}),i=v.keyPair();return(0,C.default)(a,"change:socket").cancellable().then((()=>a.socket)).finally((()=>{a.deactivate()})).then((e=>{var r=void 0;if(t){var a=new p.Binary;a.write("ED",0,1),a.writeUint8(t.byteLength>>16),a.writeUint16(65535&t.byteLength),a.writeBuffer(t),r=a.readByteArray(),__LOG__(2)`openChatSocket preIntro ${r}`}var s=r?p.Binary.build(r,P).readByteArray():P,d=new o.FrameSocket(e,s);(n=new l.NoiseHandshake(d)).start("Noise_XX_25519_AESGCM_SHA256\0\0\0\0",P),__LOG__(2)`openChatSocket send hello`,n.authenticate(i.pubKey);var u={clientHello:{ephemeral:i.pubKey}};return n.sendAndReceive((0,c.encodeProto)(b.HandshakeMessageSpec,u).readByteArray())})).then((e=>function(e,t,r){__LOG__(2)`openChatSocket rcv hello`,__LOG__(2)`server hello content: ${(0,f.toLowerCaseHex)(t)}`;var{serverHello:a}=(0,u.decodeProto)(b.HandshakeMessageSpec,t);if(!a)throw new Error("ServerHello payload error");var{ephemeral:i,static:n,payload:s}=a;if(null==i||null==n||null==s)throw new Error("Missing server Ephemeral");__LOG__(2)`serverEphemeral: ${(0,f.toLowerCaseHex)(new Uint8Array(i))}`,__LOG__(2)`serverStaticCiphertext: ${(0,f.toLowerCaseHex)(new Uint8Array(n))}`,__LOG__(2)`certificateCiphertext: ${(0,f.toLowerCaseHex)(new Uint8Array(s))}`,e.authenticate(i),e.mixIntoKey(v.sharedSecret(i,r.privKey));var o=e.decrypt(n),l=o.then((e=>v.sharedSecret(e,r.privKey)));return e.mixIntoKey(l),Promise.all([o,e.decrypt(s),i])}(n,e,i))).then((([e,t,r])=>(__LOG__(2)`verifying certificate`,function(e,t){var r=(0,u.decodeProto)(b.NoiseCertificateSpec,e);if(!r)throw new Error("Missing server Ephemeral");var a=r.details,i=r.signature;if(!a)throw new Error("verifyCertificate cert missing details");if(!i)throw new Error("verifyCertificate cert missing signature");var n=(0,u.decodeProto)(b.DetailsSpec,a);if(n.issuer!==O)throw new Error(`verifyCertificate unrecognized issuer "${String(n.issuer)}"`);if(null!=n.expires&&(0,_.castLongIntToUnixTime)(n.expires)>(0,_.unixTime)())throw new Error("verifyCertificate cert has expired");if(!n.key)throw new Error("verifyCertificate cert has no key detail");if(!(0,d.areBuffersEqual)(n.key,t))throw new Error("verifySignature cert key does not match issuer");if(!v.verifySignature(new Uint8Array((0,f.parseHex)(w)),new Uint8Array(a),new Uint8Array(i)))throw new Error("verifyCertificate cert poorly signed!")}(t,e),r)))}function I(e,t,r){var a=Promise.resolve(e.pubKey),i=t.encrypt(a);if(!r)return Promise.reject(new Error("staticAgreement called before serverKeys"));var n=v.sharedSecret(r,e.privKey);return t.mixIntoKey(n),i}},2427:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.decryptSignalProto=function(e,t,r){var a=new window.libsignal.SessionCipher((0,s.default)(),(0,l.createSignalAddress)(e));return Promise.resolve(a).then((e=>{switch(t){case o.CiphertextType.Pkmsg:return e.decryptPreKeyWhisperMessage(r);case o.CiphertextType.Msg:return e.decryptWhisperMessage(r);default:return Promise.reject(`decryptSignalProto: Received unsupported msg type ${t}`)}})).catch((e=>{if(e&&"call_failure"===e.reason&&e.value&&"number"==typeof e.value.result)__LOG__(3)`decryptSignalProto error code ${e.value.result}`;else{if(e&&"MessageCounterError"===e.name)return Promise.reject(new i.SignalMessageCounterError(e));__LOG__(3)`decryptSignalProto js error ${e}`}return Promise.reject(new i.SignalDecryptionError(e))}))},t.encryptSignalProto=function(e,t){var r=new window.libsignal.SessionCipher((0,s.default)(),(0,l.createSignalAddress)(e));return Promise.resolve(r).then((e=>e.encrypt(t))).then((({type:e,body:t})=>(__LOG__(2)`encryptSignalProto complete, type=${e}`,{type:3===e?o.CiphertextType.Pkmsg:o.CiphertextType.Msg,ciphertext:(0,l.strToBuffer)(t)})))},t.decryptGroupSignalProto=function(e,t,r){var a=new window.libsignal.GroupCipher((0,s.default)(),e.toString({legacy:!0}),(0,l.createSignalAddress)(t));return Promise.resolve(a).then((e=>e.decryptSenderKeyMessage(r))).catch((e=>e&&"MessageCounterError"===e.name?Promise.reject(new i.SignalMessageCounterError(e)):Promise.reject(new i.SignalDecryptionError(e))))},t.encryptSenderKeyMsgSignalProto=function(e,t){var r=new window.libsignal.GroupCipher((0,s.default)(),e.toString({legacy:!0}),(0,l.createSignalAddress)((0,n.assertGetMe)()));return Promise.resolve(r).then((e=>e.encrypt(t))).then((e=>({ciphertext:(0,l.strToBuffer)(e)})))};var i=r(22669),n=r(66239),s=a(r(86123)),o=r(47294),l=r(69909)},22669:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SignalMessageCounterError=t.SignalDecryptionError=void 0;var a=r(71436);class i extends((0,a.customError)("SignalDecryptionError")){}t.SignalDecryptionError=i;class n extends((0,a.customError)("SignalMessageCounterError")){}t.SignalMessageCounterError=n},24606:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.waSignalStore=void 0;var i=a(r(13277)),n=r(35540),s=r(89308),o="signal_reg_id",l="signal_static_pubkey",d="signal_static_privkey",u="signal_next_pk_id",c="signal_last_spk_id",p="signal_first_unupload_pk_id",h="signal_sever_has_pre_keys",f="adv_signed_identity",_={name:"AES-CTR",length:128,counter:new Uint8Array(16)};function m(e){return self.crypto.subtle.generateKey({name:_.name,length:_.length},!1,["encrypt","decrypt"]).then((t=>self.crypto.subtle.encrypt(_,t,e).then((e=>({encKey:t,value:e})))))}function g(e){return self.crypto.subtle.decrypt(_,e.encKey,e.value)}var v=new class{constructor(){this.idToSignedPreKey=new Map,i.default.on("logout",(()=>{this.registrationInfo=void 0,this.idToSignedPreKey.clear()}))}getMeta(e){return(0,n.getMetaTable)().get(e).then((e=>e?e.value:null))}putMeta(e){var t=(0,n.getMetaTable)(),r=e.map((e=>t.createOrReplace(e)));return Promise.all(r).then()}setServerHasPreKeys(e){this.putMeta([{key:h,value:e}])}getServerHasPreKeys(){return this.getMeta(h)}putADVSignedIdentity(e){return this.putMeta([{key:f,value:e}])}getADVSignedIdentity(){return this.getMeta(f)}getPreKeysByRange(e,t){return(0,n.getPreKeyTable)().greaterThan(["keyId"],e-1,{limit:t})}getPreKeyById(e){return(0,n.getPreKeyTable)().get(e)}removePreKeyById(e){return(0,n.getPreKeyTable)().remove(e)}bulkRmovePreKey(e){return(0,n.getPreKeyTable)().bulkRemove(e)}putPreKeys(e){var t=(0,n.getPreKeyTable)(),r=e.map((e=>{var{keyId:r,keyPair:a,isDirectDistribution:i}=e;return t.get(r).then((e=>{if(e)throw Error(`preKey id ${r} already exists`);return t.create({keyId:r,keyPair:a,isDirectDistribution:i})}))}));return Promise.all(r).then()}markPreKeyAsDirectDistribution(e){return(0,n.getPreKeyTable)().merge(e,{isDirectDistribution:1})}getSignedPreKey(){return this.getMeta(c).then((e=>this.getSignedPreKeyById(e)))}getSignedPreKeyById(e){return this.idToSignedPreKey.has(e)?Promise.resolve(this.idToSignedPreKey.get(e)):(0,n.getSignedPreKeyTable)().get(e).then((t=>(this.idToSignedPreKey.set(e,t),t)))}putSignedPreKeys(e){var t=(0,n.getSignedPreKeyTable)(),r=e.map((e=>{var{keyId:r,keyPair:a,signature:i}=e;return t.get(r).then((e=>{if(e)throw Error(`signed preKey id ${r} already exists`);return t.create({keyId:r,keyPair:a,signature:i})}))}));return Promise.all(r).then()}putSession(e,t){return(0,n.getSessionTable)().createOrReplace({address:e,session:t})}bulkPutSession(e){return(0,n.getSessionTable)().bulkCreateOrReplace(e)}removeSession(e){return(0,n.getSessionTable)().remove(e)}getSession(e){return(0,n.getSessionTable)().get(e).then((e=>e?e.session:null))}bulkGetSession(e){return(0,n.getSessionTable)().bulkGet(e).then((e=>e.map((e=>e?e.session:null))))}putIdentity(e,t){return(0,n.getIdentityTable)().createOrReplace({identifier:e,identityKey:t})}bulkPutIdentity(e){return(0,n.getIdentityTable)().bulkCreateOrReplace(e)}bulkGetIdentity(e){return(0,n.getIdentityTable)().bulkGet(e).then((e=>e.map((e=>e?e.identityKey:null))))}getIdentity(e){return(0,n.getIdentityTable)().get(e).then((e=>e?e.identityKey:null))}removeIdentity(e){return(0,n.getIdentityTable)().remove(e)}saveBaseKey(e,t,r){return(0,n.getBaseKeyTable)().createOrReplace({address:e,originalMsgId:t,baseKey:r})}loadBaseKey(e,t){return(0,n.getBaseKeyTable)().equals(["address","originalMsgId"],[e,t]).then((e=>e&&0!==e.length?e[0].baseKey:null))}deleteBaseKey(e,t){var r=(0,n.getBaseKeyTable)();return r.equals(["address","originalMsgId"],[e,t]).then((e=>{if(e&&0!==e.length)return r.remove(e[0].id)}))}putSenderKey(e,t,r){return(0,n.getSenderKeyTable)().createOrReplace({senderKeyName:e,senderId:t,senderKey:r})}bulkPutSenderKey(e){return(0,n.getSenderKeyTable)().bulkCreateOrReplace(e)}removeSenderKey(e){return(0,n.getSenderKeyTable)().remove(e)}getSenderKey(e){return(0,n.getSenderKeyTable)().get(e).then((e=>e?e.senderKey:null))}removeSenderKeyBySenderId(e){var t=(0,n.getSenderKeyTable)();return t.equals(["senderId"],e).then((e=>t.bulkRemove(e.map((e=>e.senderKeyName)))))}clearCredential(){var e=[(0,n.getIdentityTable)(),(0,n.getMetaTable)(),(0,n.getPreKeyTable)(),(0,n.getSessionTable)(),(0,n.getSignedPreKeyTable)()];return Promise.all(e.map((e=>e.clear()))).then((()=>{}))}getRegistrationInfo(){return null!=this.registrationInfo?Promise.resolve(this.registrationInfo):Promise.all([this.getMeta(o),this.getMeta(l),this.getMeta(d)]).then((([e,t,r])=>{if(e&&t&&r)return Promise.all([g(t),g(r)]).then((([t,r])=>(this.registrationInfo={registrationId:e,identityKeyPair:{pubKey:t,privKey:r}},this.registrationInfo)))}))}setRegistrationInfo(e){return Promise.all([m(e.identityKeyPair.pubKey),m(e.identityKeyPair.privKey)]).then((([t,r])=>Promise.all([this.putMeta([{key:o,value:e.registrationId},{key:l,value:t},{key:d,value:r}])]).then()))}getOrGenPreKeys(e,t){return(0,s.getStorage)().lock(["signal-meta-store","prekey-store"],(()=>Promise.all([this.getMeta(p),this.getMeta(u)]).then((([r,a])=>{var i=r||1,n=a||1,s=n-i,o=e-s;if(o<=0)return __LOG__(2)`getPreKeys: no prekey needs to be generated, avaliable: ${s}, need: ${e}`,this.getPreKeysByRange(i,e);var l=function(e,t){for(var r=[],a=e;a<t;a++)r.push(a);return r}(n,n+o).map((e=>t(e)));return Promise.all(l).then((e=>this.savePreKeys(e))).then((()=>this.getPreKeysByRange(i,e)))}))))}getOrGenSinglePreKey(e){return this.getOrGenPreKeys(1,e).then((e=>{if(1!==e.length)throw Error("Expected to get exactly one key but got ${keys.length}");return e[0]}))}savePreKeys(e){if(0===e.length)return Promise.resolve();var t=e[e.length-1];return Promise.all([this.putMeta([{key:u,value:t.keyId+1}]),this.putPreKeys(e)]).then()}markKeyAsUploaded(e){return Promise.all([this.getMeta(p),this.getMeta(u)]).then((([t,r])=>{if(e<0||!r||e>=r)throw Error(`markKeyAsUploaded: key ${e} is out of boundary.`);var a=t?Math.max(t,e+1):e+1;return this.putMeta([{key:p,value:a}])}))}rotateSignedPreKey(e,t){return(0,s.getStorage)().lock(["signal-meta-store","signed-prekey-store"],(()=>this.getMeta(c).then((r=>{var a=null==r?1:r+1;return t(e,a).then((e=>(this.putSignedPreKeys([e]),this.putMeta([{key:c,value:a}]),e)))}))))}};t.waSignalStore=v},69909:(e,t)=>{"use strict";function r(e,t){for(var r=0;r<t;r++)e.writeUint8(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.unpad=function(e){var t=new Uint8Array(e);if(0===t.length)throw new Error("unpadPkcs7 given empty bytes");var r=t[t.length-1];if(r>t.length)throw new Error(`unpad given ${t.length} bytes, but pad is ${r}`);return new Uint8Array(t.buffer,t.byteOffset,t.length-r)},t.writeRandomPadMax16=function(e){var t=new Uint8Array(1);self.crypto.getRandomValues(t),r(e,1+(15&t[0]))},t.writePad=r,t.strToBuffer=function(e){return new window.dcodeIO.ByteBuffer.wrap(e,"binary").toArrayBuffer()},t.bufferToStr=function(e){return new window.dcodeIO.ByteBuffer.wrap(e).toString("binary")},t.bufferEqual=function(e,t){if(!e||!t)return!1;if(e.byteLength!==t.byteLength)return!1;for(var r=new DataView(e),a=new DataView(t),i=0;i<r.byteLength;i++)if(r.getUint8(i)!==a.getUint8(i))return!1;return!0},t.createSignalAddress=function(e){if(!(e.isUser()||e.isServer()||e.isPSA()))throw new Error(`Jid ${e.toString({legacy:!0})} is not fully qualified, jid.server should be "s.whatsapp.net"`);return new window.libsignal.SignalProtocolAddress(e.getSignalAddress(),0)}},7574:(e,t,r)=>{"use strict";var a=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.Session=t.Cipher=t.KeyGenerator=void 0;var i=a(r(76295)),n=a(r(2427)),s=a(r(67918)),o=i;t.KeyGenerator=o;var l=n;t.Cipher=l;var d=s;t.Session=d},76295:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.generatePreKeyPair=function(e){return window.libsignal.KeyHelper.generatePreKey(e).then((e=>{var{keyId:t,keyPair:r}=e;return{keyId:t,keyPair:(0,a.toCurveKeyPair)(r),isDirectDistribution:0}}))},t.generateSignedKeyPair=function(e,t){return window.libsignal.KeyHelper.generateSignedPreKey(e,t).then((e=>{var{keyId:t,keyPair:r,signature:i}=e;return{keyId:t,keyPair:(0,a.toCurveKeyPair)(r),signature:i}}))},t.generateIdentityKeyPair=function(){return window.libsignal.KeyHelper.generateIdentityKeyPair().then((e=>(0,a.toCurveKeyPair)(e)))};var a=r(446)},9510:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.stringifyIdentityKey=function(e){return e instanceof ArrayBuffer?(0,a.bufferToStr)(e):e};var a=r(69909)},86123:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return s},t.enableMemSignalStore=function(){s=i.default},t.enablePersistSignalStore=function(){s=n.default};var i=a(r(37852)),n=a(r(26625)),s=n.default},37852:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(52954)),n=a(r(13277)),s=r(9510),o=r(446),l=r(24606);var d=new class{constructor(){this.Direction={SENDING:1,RECEIVING:2},this.RegistrationInfo=null,this.SignedPreKeyStore=new Map,this.SessionStore=new Map,this.IdentityStore=new Map,this.PrekeyStore=new Map,this.SenderKeyStore=new Map,n.default.on("logout",(()=>{this.cleanStorage()}))}getIdentityKeyPair(){var e=this;return(0,i.default)((function*(){var t;return e.RegistrationInfo||(e.RegistrationInfo=yield l.waSignalStore.getRegistrationInfo()),(null===(t=e.RegistrationInfo)||void 0===t?void 0:t.identityKeyPair)?(0,o.toSignalCurveKeyPair)(e.RegistrationInfo.identityKeyPair):void 0}))()}getLocalRegistrationId(){var e=this;return(0,i.default)((function*(){var t;return e.RegistrationInfo||(e.RegistrationInfo=yield l.waSignalStore.getRegistrationInfo()),(null===(t=e.RegistrationInfo)||void 0===t?void 0:t.registrationId)||void 0}))()}isTrustedIdentity(){return Promise.resolve(!0)}loadIdentityKey(e){var t=this;return(0,i.default)((function*(){if(null==e)throw new Error("Tried to get identity key for undefined/null key");if(!t.IdentityStore.has(e)){var r=yield l.waSignalStore.getIdentity(e);t.IdentityStore.set(e,r)}return t.IdentityStore.get(e)||void 0}))()}saveIdentity(e,t){if(null==e)return Promise.reject(new Error("Tried to put identity key for undefined/null key"));var r=(0,s.stringifyIdentityKey)(t);return this.IdentityStore.set(e,r),Promise.resolve()}loadPreKey(e){var t=this;return(0,i.default)((function*(){if(null!=e){if(!t.PrekeyStore.has(e)){var r,a=null===(r=yield l.waSignalStore.getPreKeyById(e))||void 0===r?void 0:r.keyPair;t.PrekeyStore.set(e,{keyPair:a})}var i=t.PrekeyStore.get(e);return(null==i?void 0:i.keyPair)||void 0}}))()}removePreKey(e){return null==e?Promise.reject(new Error("Tried to remove pre key without keyId")):(this.PrekeyStore.set(e,{deleted:!0}),Promise.resolve())}loadSignedPreKey(e){var t=this;return(0,i.default)((function*(){if(null!=e){if(!t.SignedPreKeyStore.has(e)){var r,a=null===(r=yield l.waSignalStore.getSignedPreKeyById(e))||void 0===r?void 0:r.keyPair;t.SignedPreKeyStore.set(e,a)}return t.SignedPreKeyStore.get(e)||void 0}}))()}loadSession(e){var t=this;return(0,i.default)((function*(){if(null!=e){if(!t.SessionStore.has(e)){var r=yield l.waSignalStore.getSession(e);t.SessionStore.set(e,r)}return t.SessionStore.get(e)||void 0}}))()}storeSession(e,t){return null==e?Promise.reject(new Error("Tried to put session without identifier")):(this.SessionStore.set(e,t),Promise.resolve())}storeSenderKey(e,t){return null==e?Promise.reject(new Error("Tried to put session without identifier")):(this.SenderKeyStore.set(e,t),Promise.resolve())}loadSenderKey(e){var t=this;return(0,i.default)((function*(){if(null!=e){if(!t.SenderKeyStore.has(e)){var r=yield l.waSignalStore.getSenderKey(e);t.SenderKeyStore.set(e,r)}return t.SenderKeyStore.get(e)||void 0}}))()}cleanStorage(){this.RegistrationInfo=null,this.SessionStore.clear(),this.IdentityStore.clear(),this.PrekeyStore.clear(),this.SignedPreKeyStore.clear(),this.SenderKeyStore.clear()}_generateSessionUpdate(){var e=[];return Array.from(this.SessionStore.keys()).forEach((t=>{var r=this.SessionStore.get(t);r&&e.push({address:t,session:r})})),e}_generateSenderKeyUpdate(){var e=[];return Array.from(this.SenderKeyStore.keys()).forEach((t=>{var r=this.SenderKeyStore.get(t);if(r){var a=t.split("::");2===a.length&&e.push({senderKeyName:t,senderId:a[1],senderKey:r})}})),e}_generateIdentityUpdate(){var e=[];return Array.from(this.IdentityStore.keys()).forEach((t=>{var r=this.IdentityStore.get(t);r&&e.push({identifier:t,identityKey:r})})),e}_generatePreKeyUpdate(){var e=[];return Array.from(this.PrekeyStore.keys()).forEach((t=>{var r=this.PrekeyStore.get(t);r&&r.deleted&&e.push(parseInt(t,10))})),e}generateSnapshot(){return{sessionUpdate:this._generateSessionUpdate(),senderKeyUpdate:this._generateSenderKeyUpdate(),identityUpdate:this._generateIdentityUpdate(),preKeyRemove:this._generatePreKeyUpdate()}}};t.default=d},26625:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(52954)),n=r(9510),s=r(446),o=r(29153),l=r(24606);var d=new class{constructor(){this.Direction={SENDING:1,RECEIVING:2}}getIdentityKeyPair(){return(0,i.default)((function*(){var e=yield l.waSignalStore.getRegistrationInfo(),t=null==e?void 0:e.identityKeyPair;return t?(0,s.toSignalCurveKeyPair)(t):void 0}))()}getLocalRegistrationId(){return(0,i.default)((function*(){var e=yield l.waSignalStore.getRegistrationInfo();return(null==e?void 0:e.registrationId)||void 0}))()}isTrustedIdentity(){return Promise.resolve(!0)}loadIdentityKey(e){return(0,i.default)((function*(){if(null==e)throw new Error("Tried to get identity key for undefined/null key");return(yield l.waSignalStore.getIdentity(e))||void 0}))()}saveIdentity(e,t){return(0,i.default)((function*(){if(null==e)throw new Error("Tried to put identity key for undefined/null key");var r=(0,n.stringifyIdentityKey)(t),a=yield l.waSignalStore.getIdentity(e);a&&a===r||(a&&(yield(0,o.handleNewIdentity)(e)),yield l.waSignalStore.putIdentity(e,r))}))()}removeIdentity(e){return null==e?Promise.reject(new Error("Tried to remove identity key for undefined/null key")):l.waSignalStore.removeIdentity(e)}loadPreKey(e){return(0,i.default)((function*(){if(null==e)return Promise.resolve(void 0);var t=yield l.waSignalStore.getPreKeyById(e);return(null==t?void 0:t.keyPair)||void 0}))()}removePreKey(e){return null==e?Promise.reject(new Error("Tried to remove pre key without keyId")):l.waSignalStore.removePreKeyById(e)}loadSignedPreKey(e){return(0,i.default)((function*(){if(null==e)return Promise.resolve(void 0);var t=yield l.waSignalStore.getSignedPreKeyById(e);return(null==t?void 0:t.keyPair)||void 0}))()}loadSession(e){return(0,i.default)((function*(){return null==e?Promise.resolve(void 0):(yield l.waSignalStore.getSession(e))||void 0}))()}storeSession(e,t){return null==e?Promise.reject(new Error("Tried to put session without identifier")):l.waSignalStore.putSession(e,t)}removeSession(e){return null==e?Promise.reject(new Error("Tried to remove session without identifier")):l.waSignalStore.removeSession(e)}containSessions(e){return l.waSignalStore.bulkGetSession(e).then((e=>e.map((e=>!!e))))}storeSenderKey(e,t){if(null==e)return Promise.reject(new Error("Tried to put senderKey without senderKeyName"));var r=e.split("::");if(r.length<2)return Promise.reject(new Error("Tried to put senderKey with invalid senderKeyName"));var a=r[1];return l.waSignalStore.putSenderKey(e,a,t)}loadSenderKey(e){return(0,i.default)((function*(){return null==e?Promise.resolve(void 0):(yield l.waSignalStore.getSenderKey(e))||void 0}))()}};t.default=d},67918:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.createSignalSession=function(){return f.apply(this,arguments)},t.hasSignalSessions=function(e){return u.default.containSessions(e.map((e=>(0,h.createSignalAddress)(e).toString())))},t.getRemoteRegId=function(e){var t=new window.libsignal.SessionCipher(u.default,(0,h.createSignalAddress)(e));return Promise.resolve(t).then((e=>e.getRemoteRegistrationId()))},t.deleteRemoteInfo=function(e){var t=(0,h.createSignalAddress)(e).toString();return Promise.all([u.default.removeIdentity(t),u.default.removeSession(t)]).then((()=>{}))},t.saveSessionBaseKey=function(e,t){var r=(0,h.createSignalAddress)(e);return new window.libsignal.SessionInfo(u.default,r).getSessionBaseKey().then((e=>e?p.waSignalStore.saveBaseKey(r.toString(),t,e):(__LOG__(2)`saveSessionBaseKey: for ${t}, no basekey provided`,Promise.resolve())))},t.hasSameBaseKey=function(e,t){var r=(0,h.createSignalAddress)(e),a=new window.libsignal.SessionInfo(u.default,(0,h.createSignalAddress)(e));return Promise.all([a.getSessionBaseKey(),p.waSignalStore.loadBaseKey(r.toString(),t)]).then((([e,r])=>r?e?(0,h.bufferEqual)(r,e)?(__LOG__(2)`hasSameBaseKey: MsgId: ${t}, savedBaseKey and sessionBaseKey is same`,!0):(__LOG__(2)`hasSameBaseKey: MsgId: ${t}, savedBaseKey and sessionBaseKey is different `,!1):(__LOG__(2)`hasSameBaseKey: MsgId: ${t}, no session has been saved locally `,!1):(__LOG__(2)`hasSameBaseKey: MsgId: ${t}, no base key has been saved locally `,!1)))},t.createGroupSignalSession=function(e,t,r){var a=new window.libsignal.GroupCipher((0,c.default)(),t,(0,h.createSignalAddress)(e));return Promise.resolve(a).then((e=>e.decryptSenderKeyDistributionMessage(r)))},t.getGroupSenderKeyInfo=function(e){return new window.libsignal.GroupCipher(u.default,e.toString({legacy:!0}),(0,h.createSignalAddress)((0,d.assertGetMe)())).createSenderKeyDistributionMsg().then((e=>(0,h.strToBuffer)(e)))},t.deleteGroupSenderKeyInfo=function(e){var t=(0,h.createSignalAddress)((0,d.assertGetMe)()),r=`${e.toString({legacy:!0})}::${t.toString()}`;return p.waSignalStore.removeSenderKey(r)},t.deleteDeviceSenderKey=function(e){var t=String((0,h.createSignalAddress)(e));return p.waSignalStore.removeSenderKeyBySenderId(t)};var i=a(r(52954)),n=r(49244),s=r(70338),o=a(r(23045)),l=r(446),d=r(66239),u=a(r(26625)),c=a(r(86123)),p=r(24606),h=r(69909);function f(){return(f=(0,i.default)((function*(e){var t,r,a,{wid:i,identity:d,deviceIdentity:c}=e;if(__LOG__(2)`Signal::createSignalSession with `,null!=i.device&&i.device!==o.default.DEVICE.PRIMARY_DEVICE){if(!c)throw new Error("Signal::createSignalSession: expected device-identity in keyBundle for companion device");if(!(yield(0,s.validateADVwithIdentityKey)(i,c,d)))throw new Error("Signal::createSignalSession: invalid identityKey fetched")}try{t=(0,l.toSignalCurvePubKey)(new n.Binary(e.identity).readBuffer())}catch(e){throw __LOG__(4,void 0,new Error,!0)`Assertion failed!`,SEND_LOGS("Signal::createSignalSession: invalid identityKey fetched"),e}try{r=(0,l.toSignalCurvePubKey)(new n.Binary(e.skey.pubkey).readBuffer())}catch(e){throw __LOG__(4,void 0,new Error,!0)`Assertion failed!`,SEND_LOGS("Signal::createSignalSession: invalid signedPreKey fetched"),e}if(e.key)try{a=(0,l.toSignalCurvePubKey)(new n.Binary(e.key.pubkey).readBuffer())}catch(e){__LOG__(4,void 0,new Error,!0)`Assertion failed!`,SEND_LOGS("Signal::createSignalSession: invalid preKey fetched")}var p={registrationId:e.regId,identityKey:t,signedPreKey:{keyId:e.skey.id,publicKey:r,signature:new n.Binary(e.skey.signature).readBuffer()}};return e.key&&a&&(p.preKey={keyId:e.key.id,publicKey:a}),new window.libsignal.SessionBuilder(u.default,(0,h.createSignalAddress)(i)).processPreKey(p)}))).apply(this,arguments)}},8456:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.xmppSignedPreKey=function(e){return(0,a.wap)("skey",null,(0,a.wap)("id",null,(0,a.BIG_ENDIAN_CONTENT)(e.keyId,3)),(0,a.wap)("value",null,e.keyPair.pubKey),(0,a.wap)("signature",null,e.signature))},t.xmppPreKey=function(e){return(0,a.wap)("key",null,(0,a.wap)("id",null,(0,a.BIG_ENDIAN_CONTENT)(e.keyId,3)),(0,a.wap)("value",null,e.keyPair.pubKey))},t.extractIdentityKey=function(e){var t=window.dcodeIO.ByteBuffer.wrap(e);t.readUint8();try{var r=window.libsignal.Protobuf.PreKeyWhisperMessage.decode(t);return(0,i.toCurveKeyPubKey)(r.identityKey.toArrayBuffer())}catch(e){return __LOG__(3)`extractIdentityKey: parse proto failed`,null}};var a=r(35773),i=r(446)},41991:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.startBackend=F;var i=a(r(52954)),n=r(47882),s=a(r(78483)),o=r(86791),l=a(r(87538)),d=a(r(13277)),u=r(7017),c=r(24789),p=r(25323),h=r(66239),f=a(r(20468)),_=a(r(88241)),m=r(97368),g=r(38027),v=r(3060),E=r(6807),y=r(66463),S=r(31970),T=a(r(54559)),A=r(24606),b=r(58970),C=r(78141),P=r(23123),O=r(71796),w=r(52663),M=a(r(15934)),I=r(14683),R=r(83696),D=r(11247),N=a(r(84161)),L=r(4314),k=r(71715),U=r(3087),G=a(r(49508));function F(){return x.apply(this,arguments)}function x(){return(x=(0,i.default)((function*(){if(__LOG__(2)`startBackend`,A.waSignalStore.getRegistrationInfo()){try{yield Promise.all([(0,g.initialize)(),(0,m.initialize)()]),yield(0,v.initialize)()}catch(e){d.default.storageInitializationError()}var e=yield(0,p.getTable)().count(),t=yield A.waSignalStore.getServerHasPreKeys();yield Y(),yield(0,u.startComms)(_.default,S.sendPing,{passive:e>0||!t}),yield(0,u.waitForConnection)(),L.OfflineResumeReporter.logSocketConnectT();var r=[];e>0&&r.push((0,o.sendAndClearDanglingReceipts)()),t||((0,D.setDeviceLinkPairStage)(N.default.MD_LINK_DEVICE_COMPANION_STAGE.UPLOAD_PREKEYS),r.push((0,w.uploadPreKeys)().catch((e=>{__LOG__(4,!0,new Error,!0)`error while uploading prekeys, ${e}`,SEND_LOGS("error while uploading prekeys"),(0,D.commitDeviceLinkEvent)(-1)})))),yield Promise.all(r),(0,D.setDeviceLinkPairStage)(N.default.MD_LINK_DEVICE_COMPANION_STAGE.COMPLETE),(0,D.commitDeviceLinkEvent)(),yield(0,y.sendPassiveIq)(!1),(0,E.isABPropsAfterFirstSync)()||(yield(0,I.syncABPropsTask)()),yield(0,O.updateABPropsFromStorage)(),yield(0,b.initialize)(),yield(0,u.startHandlingRequests)(),yield s.default.syncCriticalDataIfNeeded(),yield s.default.continueProgressiveHistorySyncProcessing(),yield(0,R.startWebPersistedJobManager)(),yield G.default.waitForFinalDbMsgEncKey(),null==T.default.serverPropsVersion&&(yield(0,U.queryServerProps)()),(0,C.registerTasks)(),B(),(0,c.runSyncDirtyContactsJob)()}else __LOG__(2)`startBackendRegistered: chatd user not registered`}))).apply(this,arguments)}function B(){(0,P.applyContactBusinessProps)(),(0,k.restoreLabels)(),(0,k.restoreQuickReplies)(),(0,k.restoreRecentStickers)(),(0,k.restoreLabelAssociations)(),(0,k.restoreCarts)()}function Y(){return K.apply(this,arguments)}function K(){return(K=(0,i.default)((function*(){var e=r(66239),t=r(94407).default,{loadProtoVersions:a}=r(70692),i=e.getVersion(),n=i&&i.protoVersion||[0,17];yield a(),f.default.setVersion(n),t.setVersion(n,10,"EAEYASACKAEwAjgBQAFIAVgBYAFoAXgBmAEBoAEBqAEBsAECuAEBwAEByAEB0AEA2AEB4AEC8AED+AEDgAIDkAIDmAIAqAIDsAIAuAIDwAIB"),T.default.updateSelectiveProps({frequentlyForwardedMessages:1,groupDescLength:512,multicastLimitGlobal:5,frequentlyForwardedMax:5,stickers:1,mdBlocklistV2:1})}))).apply(this,arguments)}d.default.on("main_stream_mode_ready",(()=>{(l.default.startIndexer(),(0,n.syncDeviceList)([(0,h.getMeUser)()])).catch((()=>{__LOG__(2)`debug setup failed:`}))})),d.default.on("md_restart_backend",(()=>{(0,u.stopComms)(),F()})),d.default.on("storage_initialization_error",(0,i.default)((function*(){__LOG__(2)`storage initialization error, logging out`,yield M.default.clearCredentialsAndStoredData(),d.default.logout()})))},54064:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(70417)),n=a(r(52954)),s=a(r(85030)),o=r(17845),l=r(65634),d=r(30093),u=r(38027),c=a(r(21830)),p=r(25054),h=r(99854),f=r(90094),_=r(9557),m=r(76549),g=r(60608),v=r(39200);class E extends f.SyncActionBase{constructor(...e){super(...e),this.version=3}getChatJidAndMessageKey(e){var[,t]=e.index;return t||(0,v.throwInvalidActionIndex)(),{chatJid:t,messageKey:null}}setArchive(e){return(0,u.getChatTable)().bulkCreateOrMerge(e).then((()=>{e.forEach((e=>{var t=(0,p.createWid)(e.id),r=s.default.get(t);r&&(r.archive=e.archive)}))}))}validateSyncActionValue(e){var t=e.archiveChatAction;return null!=(null==t?void 0:t.archived)&&(0,d.validateMessageRange)(null==t?void 0:t.messageRange)}applyMutations(e){var t=this;return(0,n.default)((function*(){var r=new Map;yield(0,u.getChatTable)().bulkGet(e.map((e=>{var{indexParts:t}=e,[,r]=t;return r||(0,v.throwInvalidActionIndex)(),(0,p.createWid)(r).toString()}))).then((e=>e.forEach((e=>{e&&r.set(e.id,e)}))));var a=[],i=yield Promise.all(e.map(function(){var e=(0,n.default)((function*(e){try{if("set"===e.operation){var{indexParts:i,value:n}=e,[,s]=i;s||(0,v.throwInvalidActionIndex)();var l=n.archiveChatAction;if(!t.validateSyncActionValue(n))return __LOG__(3)`archive chat sync: malformed mutation`,{actionState:o.SyncActionState.Malformed};var d=(0,c.default)(null==l?void 0:l.archived,"archiveChatAction?.archived"),u=(0,c.default)(null==l?void 0:l.messageRange,"archiveChatAction?.messageRange"),h=(0,p.createWid)(s);if(!r.has(h.toString()))return{actionState:o.SyncActionState.Orphan,orphanModel:{modelType:o.SyncModelType.Chat,modelId:h.toString()}};var f=yield t._applyMutation(h,d,u,n);return f.updates&&a.push(f.updates),f.syncApplyActionResult}return __LOG__(3)`mute chat sync: REMOVE operation not supported`,{actionState:o.SyncActionState.Unsupported}}catch(e){return{actionState:o.SyncActionState.Failed}}}));return function(){return e.apply(this,arguments)}}()));return a.length>0&&(yield t.setArchive(a)),i}))()}_applyMutation(e,t,r,a){return(0,n.default)((function*(){yield(0,h.removeActiveMessageRange)(e.toString(),"archive");var i=yield(0,d.constructMessageRange)(e),n=(0,d.compareMessageRanges)(i,r),s=(0,m.encodeProto)(g.SyncActionValueSpec,a).readBuffer();switch(n){case d.MessageRangeEncloseType.RangesAreEqual:return(0,h.addActiveMessageRange)(e.toString(),"archive",s),{updates:{id:e.toString(),archive:t},syncApplyActionResult:{actionState:o.SyncActionState.Success}};case d.MessageRangeEncloseType.RangesNotEnclosing:return(0,h.addActiveMessageRange)(e.toString(),"archive",s),{syncApplyActionResult:{actionState:o.SyncActionState.Orphan,orphanModel:{modelType:o.SyncModelType.Chat,modelId:e.toString()}}};case d.MessageRangeEncloseType.RangeBEnclosesRangeA:return(0,h.addActiveMessageRange)(e.toString(),"archive",s),{updates:t?{id:e.toString(),archive:t}:void 0,syncApplyActionResult:{actionState:o.SyncActionState.Orphan,orphanModel:{modelType:o.SyncModelType.Chat,modelId:e.toString()}}};case d.MessageRangeEncloseType.RangeAEnclosesRangeB:return{updates:t?void 0:{id:e.toString(),archive:t},syncApplyActionResult:{actionState:o.SyncActionState.Success}}}}))()}_constructArchiveChatIndex(e){return JSON.stringify([o.Actions.Archive,e.toString({legacy:!0})])}getArchiveChatMutation(e,t,r){var a=this;return(0,n.default)((function*(){var i={timestamp:e,archiveChatAction:{archived:t,messageRange:yield(0,d.constructMessageRange)(r)}};return{collection:o.CollectionName.RegularLow,index:a._constructArchiveChatIndex(r),binarySyncAction:(0,m.encodeProto)(g.SyncActionValueSpec,i).readBuffer(),version:a.version,operation:l.SyncdMutationSyncdOperation.SET,timestamp:e}}))()}resolveConflicts(e,t){var r,a,n=e=>(0,_.decodeProto)(g.SyncActionValueSpec,e),s=n(e.binarySyncAction),l=n(t.binarySyncAction),u=e.timestamp,p=t.timestamp,f=(0,c.default)(s.archiveChatAction,"pendingMutationValue.archiveChatAction"),v=(0,c.default)(l.archiveChatAction,"incomingMutationValue.archiveChatAction");switch((0,d.compareMessageRanges)((0,c.default)(v.messageRange,"incomingArchiveChatAction.messageRange"),(0,c.default)(f.messageRange,"pendingArchiveChatAction.messageRange"))){case d.MessageRangeEncloseType.RangeAEnclosesRangeB:return o.ConflictResolutionState.ApplyRemoteAndDropLocal;case d.MessageRangeEncloseType.RangeBEnclosesRangeA:return o.ConflictResolutionState.SkipRemote;case d.MessageRangeEncloseType.RangesAreEqual:return u<=p?o.ConflictResolutionState.ApplyRemoteAndDropLocal:o.ConflictResolutionState.SkipRemote;case d.MessageRangeEncloseType.RangesNotEnclosing:var E=u<=p?null!==(r=v.archived)&&void 0!==r&&r:null!==(a=f.archived)&&void 0!==a&&a,y=(0,d.mergeMessageRanges)((0,c.default)(v.messageRange,"incomingArchiveChatAction.messageRange"),(0,c.default)(f.messageRange,"pendingArchiveChatAction.messageRange")),S=(0,m.encodeProto)(g.SyncActionValueSpec,(0,i.default)((0,i.default)({},l),{},{archiveChatAction:{archived:E,messageRange:y}})).readBuffer();return(0,d.lockForMessageRangeSync)([],[(0,i.default)((0,i.default)({},e),{},{binarySyncAction:S})],(()=>{var t=JSON.parse(e.index);return(0,h.addActiveMessageRange)(t[1],"archive",S)})),o.ConflictResolutionState.SkipRemoteAndDropLocal}}}var y=new E;Object.freeze(y);var S=y;t.default=S},32895:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(70417)),n=a(r(52954)),s=a(r(21830)),o=r(17845),l=r(65634),d=r(30093),u=r(38027),c=r(25054),p=r(99854),h=r(20838),f=a(r(85030)),_=r(90094),m=r(9557),g=r(76549),v=r(60608),E=r(39200);class y extends _.SyncActionBase{constructor(...e){super(...e),this.version=3}getChatJidAndMessageKey(e){var[,t]=e.index;return t||(0,E.throwInvalidActionIndex)(),{chatJid:t,messageKey:null}}applyMutations(e){var t=this;return Promise.all(e.map(function(){var e=(0,n.default)((function*(e){try{if("set"===e.operation){var r,{indexParts:a,value:i}=e,[,n,s,l]=a;n&&s&&l||(0,E.throwInvalidActionIndex)();var d=null===(r=i.clearChatAction)||void 0===r?void 0:r.messageRange;if(!d)return __LOG__(3)`clear chat sync: malformed mutation`,{actionState:o.SyncActionState.Malformed};var p=(0,c.createWid)(n),h=p.toString();return(yield(0,u.getChatTable)().get(h))?t._applyMutation(p,d,"1"===s,"0"===l):{actionState:o.SyncActionState.Orphan,orphanModel:{modelType:o.SyncModelType.Chat,modelId:h}}}return __LOG__(3)`mute chat sync: REMOVE operation not supported`,{actionState:o.SyncActionState.Unsupported}}catch(e){return{actionState:o.SyncActionState.Failed}}}));return function(){return e.apply(this,arguments)}}()))}_applyMutation(e,t,r){var a=f.default.get(e);return(0,h.clearChat)(a,!r),__LOG__(3)`apply mutation for clear chat not implemented yet.`,Promise.resolve({actionState:o.SyncActionState.Malformed})}getClearChatMutation(e,t,r,a){var i=this;return(0,n.default)((function*(){var n={timestamp:e,clearChatAction:{messageRange:yield(0,d.constructMessageRange)(t)}};return{collection:o.CollectionName.RegularLow,index:i._constructClearChatIndex(t,r,a||!1),binarySyncAction:(0,g.encodeProto)(v.SyncActionValueSpec,n).readBuffer(),version:i.version,operation:l.SyncdMutationSyncdOperation.SET,timestamp:e}}))()}_constructClearChatIndex(e,t,r){return JSON.stringify([o.Actions.ClearChat,e.toString({legacy:!0}),t?"1":"0",r?"1":"0"])}resolveConflicts(e,t){var r=e=>(0,m.decodeProto)(v.SyncActionValueSpec,e),a=r(e.binarySyncAction),n=r(t.binarySyncAction),l=e.timestamp,u=t.timestamp,c=(0,s.default)(a.clearChatAction,"pendingMutationValue.clearChatAction"),h=(0,s.default)(n.clearChatAction,"incomingMutationValue.clearChatAction");switch((0,d.compareMessageRanges)((0,s.default)(h.messageRange,"incomingClearChatAction.messageRange"),(0,s.default)(c.messageRange,"pendingClearChatAction.messageRange"))){case d.MessageRangeEncloseType.RangeAEnclosesRangeB:return o.ConflictResolutionState.ApplyRemoteAndDropLocal;case d.MessageRangeEncloseType.RangeBEnclosesRangeA:return o.ConflictResolutionState.SkipRemote;case d.MessageRangeEncloseType.RangesAreEqual:return l<=u?o.ConflictResolutionState.ApplyRemoteAndDropLocal:o.ConflictResolutionState.SkipRemote;case d.MessageRangeEncloseType.RangesNotEnclosing:var f=(0,d.mergeMessageRanges)((0,s.default)(h.messageRange,"incomingClearChatAction.messageRange"),(0,s.default)(c.messageRange,"pendingClearChatAction.messageRange")),_=(0,g.encodeProto)(v.SyncActionValueSpec,(0,i.default)((0,i.default)({},n),{},{clearChatAction:{messageRange:f}})).readBuffer();return(0,d.lockForMessageRangeSync)([],[(0,i.default)((0,i.default)({},e),{},{binarySyncAction:_})],(()=>{var t=JSON.parse(e.index);return(0,p.addActiveMessageRange)(t[1],"clearChat",_)})),o.ConflictResolutionState.SkipRemoteAndDropLocal}}}var S=new y;Object.freeze(S);var T=S;t.default=T},34555:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(70417)),n=a(r(52954)),s=r(17845),o=r(25054),l=a(r(69057)),d=a(r(43805)),u=r(38027),c=r(54815),p=r(2584),h=r(24789),f=r(90094),_=r(11219),m=r(39200);class g extends f.SyncActionBase{constructor(...e){super(...e),this.version=2}applyMutations(e){return(0,n.default)((function*(){var t=[],r=[],a=yield Promise.all(e.map((e=>{try{var a=e.indexParts,[,n]=a;n||(0,m.throwInvalidActionIndex)();var u=(0,o.createUserWid)(n);if("set"===e.operation){var p,f=e.value.contactAction;if(!f)return __LOG__(3)`contact sync: malformed mutation`,{actionState:s.SyncActionState.Malformed};var _={id:n,name:f.fullName||"",shortName:f.firstName||(null!==(p=(0,c.getShortName)(f.fullName))&&void 0!==p?p:""),type:"in",isAddressBookContact:1,isContactSyncCompleted:0};return t.push(_),d.default.add((0,i.default)((0,i.default)({},_),{},{id:u}),{merge:!0}),(0,h.syncNewContact)(u),{actionState:s.SyncActionState.Success}}if("remove"===e.operation){var g=d.default.get(u);null!=g&&g.setNotMyContact();var v=new l.default({id:u,type:"in"});return r.push(u),d.default.remove([v]),{actionState:s.SyncActionState.Success}}return __LOG__(3)`contact sync: operation not supported`,{actionState:s.SyncActionState.Unsupported}}catch(e){return{actionState:s.SyncActionState.Failed}}})));if(yield(0,u.getContactTable)().bulkCreateOrMerge(t),r.length>0){var n=r.map((e=>(0,_.toJid)(e.user)));yield(0,p.setNotAddressBookContacts)(n)}return a}))()}}var v=new g;Object.freeze(v);var E=v;t.default=E},33116:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(52954)),n=a(r(21830)),s=r(17845),o=r(65634),l=r(90094),d=r(95334),u=r(39200),c=r(38027),p=r(245),h=a(r(30528)),f=r(76549),_=r(60608),m=r(9557);class g extends l.SyncActionBase{constructor(...e){super(...e),this.version=3}applyMutations(e){return Promise.all(e.map(function(){var e=(0,i.default)((function*(e){try{if("set"===e.operation){var[,t,r,a,i]=e.indexParts;t&&r&&a&&i||(0,u.throwInvalidActionIndex)();var n=(0,u.syncKeyToMsgKey)(t,r,a,i),o=yield(0,c.getMessageTable)().get(n.toString());if(!o)return{actionState:s.SyncActionState.Orphan,orphanModel:{modelId:n.toString(),modelType:s.SyncModelType.Msg}};yield(0,p.removeMessagesFromHistory)([o.id]);var l=h.default.get(n);return l?l.delete():__LOG__(3)`delete_message_for_me_sync: msg ${n} found in storage but not in collection`,{actionState:s.SyncActionState.Success}}return __LOG__(3)`delete_message_for_me_sync: operation not supported`,{actionState:s.SyncActionState.Unsupported}}catch(e){return{actionState:s.SyncActionState.Failed}}}));return function(){return e.apply(this,arguments)}}()))}resolveConflicts(e,t){var r,a,i=e=>(0,m.decodeProto)(_.SyncActionValueSpec,e),o=(0,n.default)(null===(r=i(e.binarySyncAction).deleteMessageForMeAction)||void 0===r?void 0:r.deleteMedia,"decodeValue(localMutation.binarySyncAction).deleteMessageForMeAction?.deleteMedia");return!(0,n.default)(null===(a=i(t.binarySyncAction).deleteMessageForMeAction)||void 0===a?void 0:a.deleteMedia,"decodeValue(remoteMutation.binarySyncAction).deleteMessageForMeAction?.deleteMedia")&&o?s.ConflictResolutionState.SkipRemote:s.ConflictResolutionState.SkipRemoteAndDropLocal}getDeleteForMeMutations(e,t){var r=(0,d.unixTimeMs)();return e.map((e=>{var a={deleteMessageForMeAction:{deleteMedia:t,messageTimestamp:e.t},timestamp:r};return{collection:s.CollectionName.RegularHigh,index:JSON.stringify([s.Actions.DeleteMessageForMe,e.id.remote.toString({legacy:!0}),e.id.id,e.id.fromMe?"1":"0",e.isGroupMsg&&!e.id.fromMe?e.sender.toString({legacy:!0}):"0"]),binarySyncAction:(0,f.encodeProto)(_.SyncActionValueSpec,a).readBuffer(),version:this.version,operation:o.SyncdMutationSyncdOperation.SET,timestamp:r}}))}}var v=new g;Object.freeze(v);var E=v;t.default=E},62293:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(70417)),n=a(r(52954)),s=r(70319),o=r(17845),l=r(81249),d=r(23443),u=r(48522),c=r(25054),p=r(92166),h=r(90094),f=r(39200);class _ extends h.SyncActionBase{constructor(...e){super(...e),this.version=o.LABEL_ASSOCIATION_SYNC_VERSION}applyMutations(e){return Promise.all(e.map(function(){var e=(0,n.default)((function*(e){try{if("set"===e.operation){var t,{indexParts:a,value:n}=e,[,h,_]=a;h&&_||(0,f.throwInvalidActionIndex)();var m=null===(t=n.labelAssociationAction)||void 0===t?void 0:t.labeled;if(null==m)return __LOG__(3)`label jid sync: malformed mutation`,{actionState:o.SyncActionState.Malformed};var g=(0,c.createWid)(_),v=g.toString(),E={labelId:h,associationId:v,type:l.LabelAssociationType.Jid};if(m){var y=yield(0,d.getTable)().get(v),S=r(62820).default,T=y?null:new S({id:g});yield(0,p.getStorage)().lock(["chat","label-association"],(()=>Promise.all([(0,l.getTable)().createOrReplace(E),T?(0,d.getTable)().create((0,i.default)((0,i.default)({},T.toJSON()),{},{id:v})):null]))),T&&r(85030).default.add(T),(0,u.addToLabelCollection)(v,[h],s.LabelItemParentType.Chat)}else yield(0,l.getTable)().remove([h,v,l.LabelAssociationType.Jid]),(0,u.removeLabelFromCollection)(v,h,s.LabelItemParentType.Chat);return{actionState:o.SyncActionState.Success}}return __LOG__(3)`label jid sync: unsupported operation`,{actionState:o.SyncActionState.Unsupported}}catch(e){return{actionState:o.SyncActionState.Failed}}}));return function(){return e.apply(this,arguments)}}()))}}var m=new _;Object.freeze(m);var g=m;t.default=g},67883:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(52954)),n=r(70319),s=r(17845),o=r(81249),l=r(39200),d=r(48522),u=r(245),c=r(90094);class p extends c.SyncActionBase{constructor(...e){super(...e),this.version=s.LABEL_ASSOCIATION_SYNC_VERSION}applyMutations(e){return Promise.all(e.map(function(){var e=(0,i.default)((function*(e){try{if("set"===e.operation){var t,{indexParts:r,value:a}=e,[,i,c,p,h,f]=r;i&&c&&p&&h&&f||(0,l.throwInvalidActionIndex)();var _=null===(t=a.labelAssociationAction)||void 0===t?void 0:t.labeled;if(null==_)return __LOG__(3)`label message sync: malformed mutation`,{actionState:s.SyncActionState.Malformed};var m=(0,l.syncKeyToMsgKey)(c,p,h,f).toString();if(!(yield(0,u.getMsgByMsgKey)(m)))return{actionState:s.SyncActionState.Orphan,orphanModel:{modelId:m,modelType:s.SyncModelType.Msg}};var g={labelId:i,associationId:m,type:o.LabelAssociationType.Message};return _?(yield(0,o.getTable)().createOrReplace(g),(0,d.addToLabelCollection)(m,[i],n.LabelItemParentType.Msg)):(yield(0,o.getTable)().remove([i,m,o.LabelAssociationType.Message]),(0,d.removeLabelFromCollection)(m,i,n.LabelItemParentType.Msg)),{actionState:s.SyncActionState.Success}}return __LOG__(3)`label message sync: operation not supported`,{actionState:s.SyncActionState.Unsupported}}catch(e){return{actionState:s.SyncActionState.Failed}}}));return function(){return e.apply(this,arguments)}}()))}}var h=new p;Object.freeze(h);var f=h;t.default=f},96157:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(70417)),n=a(r(52954)),s=r(17845),o=a(r(62345)),l=r(90813),d=r(90094),u=r(39200);class c extends d.SyncActionBase{constructor(...e){super(...e),this.version=3}applyMutations(e){return Promise.all(e.map(function(){var e=(0,n.default)((function*(e){try{if("set"===e.operation){var t,{indexParts:r,value:a}=e,[,n]=r;n||(0,u.throwInvalidActionIndex)();var d=a.labelEditAction;if(!d)return __LOG__(3)`label sync: malformed mutation`,{actionState:s.SyncActionState.Malformed};if(d.deleted)return yield(0,l.getTable)().remove(n),o.default.remove(n),{actionState:s.SyncActionState.Success};var{color:c,predefinedId:p}=d,h=null!==(t=d.name)&&void 0!==t?t:"";""===h&&__LOG__(3)`labelEditAction.name is empty`,null==c&&__LOG__(3)`labelEditAction.color is empty`;var f={id:n,name:h,colorIndex:c,predefinedId:p};return yield(0,l.getTable)().createOrReplace(f),o.default.add((0,i.default)({},f),{merge:!0}),{actionState:s.SyncActionState.Success}}return __LOG__(3)`label sync: operation not supported`,{actionState:s.SyncActionState.Unsupported}}catch(e){return{actionState:s.SyncActionState.Failed}}}));return function(){return e.apply(this,arguments)}}()))}}var p=new c;Object.freeze(p);var h=p;t.default=h},7306:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(52954)),n=r(17845),s=a(r(38637)),o=a(r(23045)),l=r(90094);class d extends l.SyncActionBase{constructor(...e){super(...e),this.version=3}applyMutations(e){return Promise.all(e.map(function(){var e=(0,i.default)((function*(e){try{if("set"===e.operation){var{value:t}=e,r=t.localeSetting;if(!r)return __LOG__(3)`locale setting sync: malformed mutation`,{actionState:n.SyncActionState.Malformed};var a=r.locale;return yield s.default.setLocale(a,o.default.L10N_PRIORITY.PHONE),{actionState:n.SyncActionState.Success}}return __LOG__(3)`locale setting sync: operation not supported`,{actionState:n.SyncActionState.Unsupported}}catch(e){return{actionState:n.SyncActionState.Failed}}}));return function(){return e.apply(this,arguments)}}()))}}var u=new d;Object.freeze(u);var c=u;t.default=c},39016:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(70417)),n=a(r(52954)),s=a(r(85030)),o=r(17845),l=r(65634),d=r(30093),u=r(38027),c=a(r(21830)),p=r(25054),h=r(99854),f=r(90094),_=r(76549),m=r(9557),g=r(60608),v=r(39200);class E extends f.SyncActionBase{constructor(...e){super(...e),this.version=3}_setRead(e,t){var a=s.default.get(e);if(a){var i=r(76710);t?i.markSeen(a):i.markUnseen(a)}}validateSyncActionValue(e){var t=e.markChatAsReadAction;return null!=(null==t?void 0:t.read)&&(0,d.validateMessageRange)(null==t?void 0:t.messageRange)}applyMutations(e){var t=this;return Promise.all(e.map(function(){var e=(0,n.default)((function*(e){try{if("set"===e.operation){var r,a,{indexParts:i,value:n}=e,[,s]=i;if(s||(0,v.throwInvalidActionIndex)(),!t.validateSyncActionValue(n))return __LOG__(3)`mark chat as read sync: malformed mutation`,{actionState:o.SyncActionState.Malformed};var l=(0,c.default)(null===(r=n.markChatAsReadAction)||void 0===r?void 0:r.read,"value.markChatAsReadAction?.read"),d=(0,c.default)(null===(a=n.markChatAsReadAction)||void 0===a?void 0:a.messageRange,"value.markChatAsReadAction?.messageRange"),h=(0,p.createWid)(s),f=h.toString();return(yield(0,u.getChatTable)().get(f))?t._applyMutation(h,l,d,n):{actionState:o.SyncActionState.Orphan,orphanModel:{modelType:o.SyncModelType.Chat,modelId:f}}}return __LOG__(3)`mark chat as read sync: operation not supported`,{actionState:o.SyncActionState.Unsupported}}catch(e){return{actionState:o.SyncActionState.Failed}}}));return function(){return e.apply(this,arguments)}}()))}_applyMutation(e,t,r,a){var i=this;return(0,n.default)((function*(){yield(0,h.removeActiveMessageRange)(e.toString(),"markChatAsRead");var n=yield(0,d.constructMessageRange)(e),s=(0,d.compareMessageRanges)(n,r),l=(0,_.encodeProto)(g.SyncActionValueSpec,a).readBuffer();switch(s){case d.MessageRangeEncloseType.RangesAreEqual:return(0,h.addActiveMessageRange)(e.toString(),"markChatAsRead",l),i._setRead(e,t),Promise.resolve({actionState:o.SyncActionState.Success});case d.MessageRangeEncloseType.RangesNotEnclosing:return(0,h.addActiveMessageRange)(e.toString(),"markChatAsRead",l),Promise.resolve({actionState:o.SyncActionState.Orphan,orphanModel:{modelType:o.SyncModelType.Chat,modelId:e.toString()}});case d.MessageRangeEncloseType.RangeBEnclosesRangeA:return(0,h.addActiveMessageRange)(e.toString(),"markChatAsRead",l),i._setRead(e,t),Promise.resolve({actionState:o.SyncActionState.Orphan,orphanModel:{modelType:o.SyncModelType.Chat,modelId:e.toString()}});case d.MessageRangeEncloseType.RangeAEnclosesRangeB:return Promise.resolve({actionState:o.SyncActionState.Success})}}))()}_constructMarkChatAsReadIndex(e){return JSON.stringify([o.Actions.MarkChatAsRead,e.toString({legacy:!0})])}getMarkChatAsReadMutation(e,t,r){var a=this;return(0,n.default)((function*(){var i={timestamp:e,markChatAsReadAction:{read:t,messageRange:yield(0,d.constructMessageRange)(r)}};return{collection:o.CollectionName.RegularLow,index:a._constructMarkChatAsReadIndex(r),binarySyncAction:(0,_.encodeProto)(g.SyncActionValueSpec,i).readBuffer(),version:a.version,operation:l.SyncdMutationSyncdOperation.SET,timestamp:e}}))()}resolveConflicts(e,t){var r,a,n=e=>(0,m.decodeProto)(g.SyncActionValueSpec,e),s=n(e.binarySyncAction),l=n(t.binarySyncAction),u=e.timestamp,p=t.timestamp,f=(0,c.default)(s.markChatAsReadAction,"pendingMutationValue.markChatAsReadAction"),v=(0,c.default)(l.markChatAsReadAction,"incomingMutationValue.markChatAsReadAction");switch((0,d.compareMessageRanges)((0,c.default)(v.messageRange,"incomingMarkChatAsReadAction.messageRange"),(0,c.default)(f.messageRange,"pendingMarkChatAsReadAction.messageRange"))){case d.MessageRangeEncloseType.RangeAEnclosesRangeB:return o.ConflictResolutionState.ApplyRemoteAndDropLocal;case d.MessageRangeEncloseType.RangeBEnclosesRangeA:return o.ConflictResolutionState.SkipRemote;case d.MessageRangeEncloseType.RangesAreEqual:return u<=p?o.ConflictResolutionState.ApplyRemoteAndDropLocal:o.ConflictResolutionState.SkipRemote;case d.MessageRangeEncloseType.RangesNotEnclosing:var E=u<=p?null!==(r=v.read)&&void 0!==r&&r:null!==(a=f.read)&&void 0!==a&&a,y=(0,d.mergeMessageRanges)((0,c.default)(v.messageRange,"incomingMarkChatAsReadAction.messageRange"),(0,c.default)(f.messageRange,"pendingMarkChatAsReadAction.messageRange")),S=(0,_.encodeProto)(g.SyncActionValueSpec,(0,i.default)((0,i.default)({},l),{},{markChatAsReadAction:{read:E,messageRange:y}})).readBuffer();return(0,d.lockForMessageRangeSync)([],[(0,i.default)((0,i.default)({},e),{},{binarySyncAction:S})],(()=>{var t=JSON.parse(e.index);return(0,h.addActiveMessageRange)(t[1],"markChatAsRead",S)})),o.ConflictResolutionState.SkipRemoteAndDropLocal}}}var y=new E;Object.freeze(y);var S=y;t.default=S},30093:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.constructMessageRange=function(){return c.apply(this,arguments)},t.compareMessageRanges=function(e,t){var r=u(e,t),a=u(t,e);return r&&a?d.RangesAreEqual:r?d.RangeAEnclosesRangeB:a?d.RangeBEnclosesRangeA:d.RangesNotEnclosing},t.mergeMessageRanges=function(e,t){var r,a,i,s,o=(0,n.numberOrThrowIfTooLarge)(null!==(r=e.lastMessageTimestamp)&&void 0!==r?r:0),l=(0,n.numberOrThrowIfTooLarge)(null!==(a=t.lastMessageTimestamp)&&void 0!==a?a:0),d=Math.max(o,l),u={messages:p(e.messages,t.messages,d)};0!==d&&(u.lastMessageTimestamp=d);null==e.lastSystemMessageTimestamp&&null==t.lastSystemMessageTimestamp||(u.lastSystemMessageTimestamp=Math.max((0,n.numberOrThrowIfTooLarge)(null!==(i=e.lastSystemMessageTimestamp)&&void 0!==i?i:0),(0,n.numberOrThrowIfTooLarge)(null!==(s=t.lastSystemMessageTimestamp)&&void 0!==s?s:0)));return u},t.validateMessageRange=function(e){if(null==e)return!1;if(null!=e.lastMessageTimestamp&&0===e.messages.length)return!1;if(e.messages.filter((e=>null!=e.timestamp)).length>1e3)throw new l.SyncdFatalError("syncd: additionalMessages has >1000 messages with timestamp");return!0},t.lockForMessageRangeSync=t.MessageRangeEncloseType=void 0;var i=a(r(52954)),n=r(25364),s=r(51829),o=r(58970),l=r(83961),d=r(28103).Mirrored(["RangeAEnclosesRangeB","RangeBEnclosesRangeA","RangesAreEqual","RangesNotEnclosing"]);function u(e,t){for(var r=new Set(e.messages.map((e=>{var t;return null===(t=e.key)||void 0===t?void 0:t.id}))),a=0;a<t.messages.length;a++){var i;if(null==t.messages[a].timestamp)if(!r.has(null===(i=t.messages[a].key)||void 0===i?void 0:i.id))return!1}for(var s=0;s<t.messages.length;s++){var o,l,d;if(!r.has(null===(o=t.messages[s].key)||void 0===o?void 0:o.id)&&(0,n.numberOrThrowIfTooLarge)(null!==(l=e.lastMessageTimestamp)&&void 0!==l?l:0)<=(0,n.numberOrThrowIfTooLarge)(null!==(d=t.messages[s].timestamp)&&void 0!==d?d:0))return!1}return!0}function c(){return(c=(0,i.default)((function*(e){var t,r=yield(0,s.getLastMessageTimestamp)(e),a=yield(0,s.getLastSystemMessageTimestamp)(e),{messages:i,newLastMessageTimestamp:o}=yield(0,s.getAdditionalMessages)(e,r);(null!=o&&(r=o),null==r)&&(r=null===(t=i.sort(s.timestampComparison)[i.length-1])||void 0===t?void 0:t.timestamp);var l={messages:i};return null!=r&&(l.lastMessageTimestamp=r),null!=a&&null!=r&&a>(0,n.numberOrThrowIfTooLarge)(r)&&(l.lastSystemMessageTimestamp=a),l}))).apply(this,arguments)}function p(e,t,r){var a=new Map;return e.concat(t).forEach((e=>{var t,i,s,o=null!==(t=null===(i=e.key)||void 0===i?void 0:i.id)&&void 0!==t?t:"";if((0,n.numberOrThrowIfTooLarge)(null!==(s=e.timestamp)&&void 0!==s?s:0)>=r){var l,d,u=a.get(o);if(u)a.set(o,(0,n.numberOrThrowIfTooLarge)(null!==(l=u.timestamp)&&void 0!==l?l:0)<(0,n.numberOrThrowIfTooLarge)(null!==(d=e.timestamp)&&void 0!==d?d:0)?e:u);else a.set(o,e)}})),Array.from(a.values())}t.MessageRangeEncloseType=d;t.lockForMessageRangeSync=(e,t,r)=>(0,o.lockForSync)([...e,"message","active-message-ranges"],t,r)},54805:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(52954)),n=r(17845),s=r(65634),o=r(38027),l=a(r(96997)),d=r(25054),u=r(25364),c=r(90094),p=r(95334),h=r(60608),f=r(76549),_=r(39200);class m extends c.SyncActionBase{constructor(...e){super(...e),this.version=2}getChatJidAndMessageKey(e){var[,t]=e.index;return{chatJid:t,messageKey:null}}applyMutations(e){return Promise.all(e.map(function(){var e=(0,i.default)((function*(e){try{if("set"===e.operation){var t,{indexParts:r,value:a}=e,[,i]=r;i||(0,_.throwInvalidActionIndex)();var s=a.muteAction,c=null===(t=a.muteAction)||void 0===t?void 0:t.muted,h=(0,u.maybeNumberOrThrowIfTooLarge)(null==s?void 0:s.muteEndTimestamp);if(null==c||c&&null==h)return __LOG__(3)`mute chat sync: malformed mutation`,{actionState:n.SyncActionState.Malformed};var f=(0,d.createWid)(i).toString();if(!(yield(0,o.getChatTable)().get(f)))return{actionState:n.SyncActionState.Orphan,orphanModel:{modelType:n.SyncModelType.Chat,modelId:f}};var m=null!=h?h:0,g=m>0&&m<(0,p.unixTimeMs)()?0:Math.floor(m/1e3);return yield(0,o.getChatTable)().merge((0,d.createWid)(i).toString(),{muteExpiration:g}),l.default.add({id:(0,d.createWid)(i),expiration:g},{merge:!0}),{actionState:n.SyncActionState.Success}}return __LOG__(3)`mute chat sync: operation not supported`,{actionState:n.SyncActionState.Unsupported}}catch(e){return{actionState:n.SyncActionState.Failed}}}));return function(){return e.apply(this,arguments)}}()))}generateMuteMutation(e,t){var r=void 0!==t&&0!==t,a=(0,p.unixTimeMs)(),i=t;-1!==i&&(i*=1e3);var o={timestamp:a,muteAction:{muted:r,muteEndTimestamp:i}};return{collection:n.CollectionName.RegularHigh,index:JSON.stringify([n.Actions.Mute,e.toString({legacy:!0})]),operation:s.SyncdMutationSyncdOperation.SET,version:this.version,binarySyncAction:(0,f.encodeProto)(h.SyncActionValueSpec,o).readBuffer(),timestamp:a}}}var g=new m;Object.freeze(g);var v=g;t.default=v},43010:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(17845),n=r(65634),s=r(90094),o=r(63860),l=a(r(99785)),d=r(76549),u=r(60608);class c extends s.SyncActionBase{constructor(...e){super(...e),this.version=1}applyMutations(e){return Promise.all(e.map((e=>{try{if("set"===e.operation){var t,{value:a}=e,n=null===(t=a.pushNameSetting)||void 0===t?void 0:t.name;if(!n)return __LOG__(3)`push name sync: malformed mutation`,Promise.resolve({actionState:i.SyncActionState.Malformed});(0,l.default)(n),(0,o.setPushnameLocally)(n);var s=r(78483).default;return s.isSyncDCriticalDataSyncInProcess()&&(s.setSyncDCriticalSynced(),s.setSyncDCriticalDataSyncCompleted()),Promise.resolve({actionState:i.SyncActionState.Success})}return __LOG__(3)`push name sync: operation not supported`,Promise.resolve({actionState:i.SyncActionState.Unsupported})}catch(e){return{actionState:i.SyncActionState.Failed}}})))}getPushnameMutation(e,t){return{collection:i.CollectionName.CriticalBlock,index:JSON.stringify([i.Actions.SettingPushName]),binarySyncAction:(0,d.encodeProto)(u.SyncActionValueSpec,{timestamp:e,pushNameSetting:{name:t}}).readBuffer(),version:this.version,operation:n.SyncdMutationSyncdOperation.SET,timestamp:e}}}var p=new c;Object.freeze(p);var h=p;t.default=h},56675:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(52954)),n=r(17845),s=a(r(84553)),o=r(38027),l=r(90094),d=r(39200);class u extends l.SyncActionBase{constructor(...e){super(...e),this.version=2}applyMutations(e){return Promise.all(e.map(function(){var e=(0,i.default)((function*(e){try{if("set"===e.operation){var{indexParts:t,value:r}=e,[,a]=t;a||(0,d.throwInvalidActionIndex)();var i=r.quickReplyAction;if(!i)return __LOG__(3)`quick replies sync: malformed mutation`,{actionState:n.SyncActionState.Malformed};if(i.deleted)return yield(0,o.getQuickReplyTable)().remove(a),s.default.remove(a),{actionState:n.SyncActionState.Success};var{shortcut:l,message:u}=i;if(!l||!u)return __LOG__(3)`quick replies sync: malformed mutation`,{actionState:n.SyncActionState.Malformed};var c=i.keywords||[],p=i.count||0;return yield(0,o.getQuickReplyTable)().createOrReplace({id:a,shortcut:l,count:p,message:u,keywords:c}),s.default.add({id:a,shortcut:l,message:u,keywords:c,count:p},{merge:!0}),{actionState:n.SyncActionState.Success}}return __LOG__(3)`quick replies sync: operation not supported`,{actionState:n.SyncActionState.Unsupported}}catch(e){return{actionState:n.SyncActionState.Failed}}}));return function(){return e.apply(this,arguments)}}()))}}var c=new u;Object.freeze(c);var p=c;t.default=p},23492:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(52954)),n=r(95334),s=r(17845),o=a(r(93371)),l=r(20213),d=r(65634),u=r(90094),c=r(76549),p=r(60608);class h extends u.SyncActionBase{constructor(...e){super(...e),this.version=3}applyMutations(e){return Promise.all(e.map(function(){var e=(0,i.default)((function*(e){try{if("set"===e.operation){var t,r=null===(t=e.value.keyExpiration)||void 0===t?void 0:t.expiredKeyEpoch;return null==r?(__LOG__(4,void 0,new Error)`sentinel mutation sync: malformed mutation`,{actionState:s.SyncActionState.Malformed}):(yield o.default.expireSyncKey(r),{actionState:s.SyncActionState.Success})}return __LOG__(3)`sentinel mutation sync: operation not supported`,{actionState:s.SyncActionState.Unsupported}}catch(e){return{actionState:s.SyncActionState.Failed}}}));return function(){return e.apply(this,arguments)}}()))}getSentinelMutations(){var e=this;return(0,i.default)((function*(){var t=(0,n.unixTimeMs)(),r=Array.from(s.CollectionName.members()),a={keyExpiration:{expiredKeyEpoch:(yield(0,l.getNewestKeyPair)()).keyEpoch},timestamp:t};return r.map((r=>({collection:r,index:JSON.stringify([s.Actions.Sentinel,r]),operation:d.SyncdMutationSyncdOperation.SET,version:e.version,binarySyncAction:(0,c.encodeProto)(p.SyncActionValueSpec,a).readBuffer(),timestamp:t})))}))()}}var f=new h;Object.freeze(f);var _=f;t.default=_},48163:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(52954)),n=r(17845),s=r(38027),o=r(245),l=a(r(30528)),d=r(39200),u=r(90094),c=r(64571),p=r(65634),h=r(95334),f=r(76549),_=r(60608);class m extends u.SyncActionBase{constructor(...e){super(...e),this.version=2}getChatJidAndMessageKey(e){var[,t,r,a,i]=e.index;return t&&r&&a&&i||(0,d.throwInvalidActionIndex)(),{chatJid:t,messageKey:(0,d.syncKeyToMsgKey)(t,r,a,i).toString()}}applyMutations(e){return Promise.all(e.map(function(){var e=(0,i.default)((function*(e){try{if("set"===e.operation){var t,{indexParts:r,value:a}=e,[,i,u,c,p]=r;i&&u&&c&&p||(0,d.throwInvalidActionIndex)();var h=null===(t=a.starAction)||void 0===t?void 0:t.starred;if(null==h)return __LOG__(3)`star message sync: malformed mutation`,{actionState:n.SyncActionState.Malformed};var f=(0,d.syncKeyToMsgKey)(i,u,c,p);if(!(yield(0,s.getMessageTable)().get(f.toString())))return{actionState:n.SyncActionState.Orphan,orphanModel:{modelId:f.toString(),modelType:n.SyncModelType.Msg}};h?yield(0,o.starMessages)([f.toString()]):yield(0,o.unstarMessages)([f.toString()]);var _=l.default.get(f);return _?_.star=h:__LOG__(3)`star_message_sync: msg ${f} found in storage but not in collection`,{actionState:n.SyncActionState.Success}}return __LOG__(3)`star message sync: operation not supported`,{actionState:n.SyncActionState.Unsupported}}catch(e){return{actionState:n.SyncActionState.Failed}}}));return function(){return e.apply(this,arguments)}}()))}getStarMessageMutations(e,t){var r=(0,h.unixTimeMs)();return e.map((e=>({collection:n.CollectionName.RegularHigh,index:(0,c.constructStarMsgKey)(e),operation:p.SyncdMutationSyncdOperation.SET,version:this.version,binarySyncAction:(0,f.encodeProto)(_.SyncActionValueSpec,{timestamp:r,starAction:{starred:t}}).readBuffer(),timestamp:r})))}}var g=new m;Object.freeze(g);var v=g;t.default=v},90094:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SyncActionBase=void 0;var a=r(17845);t.SyncActionBase=class{getChatJidAndMessageKey(){}resolveConflicts(e,t){return t.timestamp>=e.timestamp?a.ConflictResolutionState.ApplyRemoteAndDropLocal:a.ConflictResolutionState.SkipRemote}dropMutationDueToCrossIndexConflict(){return Promise.resolve(!1)}}},39200:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.syncKeyToMsgKey=function(e,t,r,a){var i=void 0;(0,l.createWid)(e).isUser()||(i="1"===r?(0,n.getMeUser)():(0,l.createWid)(a));return new o.default({fromMe:"1"===r,remote:(0,l.createWid)(e),id:t,participant:i})},t.throwInvalidActionIndex=function(){throw new s.default.MdFatalError({mdFatalErrorCode:s.default.MD_SYNCD_FATAL_ERROR_CODE.INVALID_ACTION_INDEX}).commit(),new i.SyncdFatalError("invalid action index")};var i=r(83961),n=r(66239),s=a(r(84161)),o=a(r(83746)),l=r(25054)},25891:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(52954)),n=r(95334),s=r(17845),o=r(38027);class l{static loadStatesFromDb(){var e=this;return(0,i.default)((function*(){(yield(0,o.getCollectionVersionTable)().all()).forEach((t=>e.collectionStates.set(t.collection,{collection:t.collection,state:t.state,finiteFailureStartTime:t.finiteFailureStartTime})))}))()}static persistToDb(){var e=[];return this.collectionStates.forEach((t=>e.push(t))),(0,o.getCollectionVersionTable)().bulkCreateOrMerge(e)}static clean(){this.collectionStates=new Map}static getCollectionState(e){var t=this.collectionStates.get(e);return t?t.state:(this.moveCollectionsToUpToDate([e]),s.CollectionSyncState.UpToDate)}static getCollectionsInStateDirty(){var e=[];return this.collectionStates.forEach((t=>{t.state===s.CollectionSyncState.Dirty&&e.push(t.collection)})),e}static getCollectionsInStateRetry(){var e=[];return this.collectionStates.forEach((t=>{t.state===s.CollectionSyncState.FailingFiniteRetry&&e.push(t.collection)})),e}static getCollectionsInStateFatal(){var e=[];return this.collectionStates.forEach((t=>{t.state===s.CollectionSyncState.Fatal&&e.push(t.collection)})),e}static getCollectionsInStateBlocked(){var e=[];return this.collectionStates.forEach((t=>{t.state===s.CollectionSyncState.Blocked&&e.push(t.collection)})),e}static moveCollectionsToUpToDate(e){e.forEach((e=>this.collectionStates.set(e,{collection:e,state:s.CollectionSyncState.UpToDate,finiteFailureStartTime:void 0})))}static moveCollectionsToDirty(e){e.forEach((e=>this.collectionStates.set(e,{collection:e,state:s.CollectionSyncState.Dirty,finiteFailureStartTime:void 0})))}static moveCollectionsToFiniteRetry(e){e.forEach((e=>this.collectionStates.set(e,{collection:e,state:s.CollectionSyncState.FailingFiniteRetry,finiteFailureStartTime:(0,n.unixTimeMs)()})))}static moveCollectionsToFatal(e){e.forEach((e=>this.collectionStates.set(e,{collection:e,state:s.CollectionSyncState.Fatal,finiteFailureStartTime:void 0})))}static moveCollectionsToBlocked(e){e.forEach((e=>this.collectionStates.set(e,{collection:e,state:s.CollectionSyncState.Blocked,finiteFailureStartTime:void 0})))}static getExpiredCollections(){var e=[];return this.collectionStates.forEach((t=>{var r;t.state===s.CollectionSyncState.FailingFiniteRetry&&(null==t.finiteFailureStartTime?(r=1/0,__LOG__(3)`Collection ${t.collection} is in finite retry state with no failure start time`):r=t.finiteFailureStartTime,r+6048e5<(0,n.unixTimeMs)()&&e.push(t.collection))})),e}}t.default=l,l.collectionStates=new Map},17845:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SyncDataType=t.ConflictResolutionState=t.SyncModelType=t.SyncActionState=t.CollectionSyncState=t.CollectionState=t.CollectionName=t.Actions=t.LABEL_ASSOCIATION_SYNC_VERSION=t.DEFAULT_COLLECTION_VERSION=t.MAX_PATCH_SIZE=t.MIN_PATCH_SIZE=t.MAX_INLINE_MUTATIONS=t.MIN_INLINE_MUTATIONS=t.FINITE_FAILURE_EXPIRY_DURATION=t.BACKOFF_BASE=t.BACKOFF_MAX_TIMEOUT=t.BACKOFF_MIN_TIMEOUT=void 0;t.BACKOFF_MIN_TIMEOUT=1e3;t.BACKOFF_MAX_TIMEOUT=36e5;t.BACKOFF_BASE=2;t.FINITE_FAILURE_EXPIRY_DURATION=6048e5;t.MIN_INLINE_MUTATIONS=100;t.MAX_INLINE_MUTATIONS=2e3;t.MIN_PATCH_SIZE=10;t.MAX_PATCH_SIZE=100;t.DEFAULT_COLLECTION_VERSION=0;t.LABEL_ASSOCIATION_SYNC_VERSION=3;var a=r(28103)({Star:"star",Contact:"contact",Mute:"mute",Pin:"pin",SettingPushName:"setting_pushName",LabelEdit:"label_edit",LabelMessage:"label_message",LabelJid:"label_jid",QuickReply:"quick_reply",LocaleSetting:"setting_locale",Archive:"archive",MarkChatAsRead:"markChatAsRead",ClearChat:"clearChat",DeleteMessageForMe:"deleteMessageForMe",Sentinel:"sentinel"});t.Actions=a;var i=r(28103)({Generic:"generic",Regular:"regular",RegularLow:"regular_low",RegularHigh:"regular_high",CriticalBlock:"critical_block",CriticalUnblockLow:"critical_unblock_low"});t.CollectionName=i;var n=r(28103).Mirrored(["Success","SuccessHasMore","Conflict","ErrorRetry","ErrorFatal","Blocked"]);t.CollectionState=n;var s=r(28103).Mirrored(["UpToDate","Dirty","FailingFiniteRetry","Fatal","Blocked"]);t.CollectionSyncState=s;var o=r(28103).Mirrored(["Success","Malformed","Orphan","Unsupported","Skipped","Failed"]);t.SyncActionState=o;var l=r(28103).Mirrored(["Msg","Chat"]);t.SyncModelType=l;var d=r(28103).Mirrored(["ApplyRemoteAndDropLocal","SkipRemote","SkipRemoteAndDropLocal"]);t.ConflictResolutionState=d;var u=r(28103).Mirrored(["Patch","Snapshot"]);t.SyncDataType=u},41431:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EMPTY_MUTATION_MAC=t.IV_LENGTH=t.OCTET_LENGTH=t.MAC_LENGTH=t.MAX_OF_MIN_DATA_LENGTH=t.OPERATION_REMOVE_HEX=t.OPERATION_SET_HEX=t.PATCH_MAC_KEY_END=t.SNAPSHOT_MAC_KEY_END=t.VALUE_MAC_KEY_END=t.VALUE_ENCRYPTION_KEY_END=t.INDEX_KEY_END=t.PATCH_MAC_KEY_LENGTH=t.SNAPSHOT_MAC_KEY_LENGTH=t.VALUE_MAC_KEY_LENGTH=t.VALUE_ENCRYPTION_KEY_LENGTH=t.INDEX_KEY_LENGTH=t.DERIVED_KEY_LENGTH=t.HKDF_INFO=void 0;t.HKDF_INFO="WhatsApp Mutation Keys";t.DERIVED_KEY_LENGTH=160;t.INDEX_KEY_LENGTH=32;t.VALUE_ENCRYPTION_KEY_LENGTH=32;t.VALUE_MAC_KEY_LENGTH=32;t.SNAPSHOT_MAC_KEY_LENGTH=32;t.PATCH_MAC_KEY_LENGTH=32;t.INDEX_KEY_END=32;t.VALUE_ENCRYPTION_KEY_END=64;t.VALUE_MAC_KEY_END=96;t.SNAPSHOT_MAC_KEY_END=128;t.PATCH_MAC_KEY_END=160;t.OPERATION_SET_HEX="0x01";t.OPERATION_REMOVE_HEX="0x02";t.MAX_OF_MIN_DATA_LENGTH=0;t.MAC_LENGTH=32;t.OCTET_LENGTH=8;t.IV_LENGTH=16;var r=new ArrayBuffer(32);t.EMPTY_MUTATION_MAC=r},67:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.generateIndexMac=function(e,t){return new o.default(e).sign(t)},t.generateAssociatedData=function(e,t){var r;switch(e){case d.SyncdMutationSyncdOperation.SET:r=s.OPERATION_SET_HEX;break;case d.SyncdMutationSyncdOperation.REMOVE:r=s.OPERATION_REMOVE_HEX}if(r){var a=r=new Uint8Array([parseInt(r,16)]).buffer,i=new Uint8Array(r.byteLength+t.byteLength);return i.set(new Uint8Array(a)),i.set(new Uint8Array(t),a.byteLength),i.buffer}throw new Error("invalid mutation operation value")},t.generatePadding=function(e,t){var r=Math.max(0,s.MAX_OF_MIN_DATA_LENGTH-e-t),a=new Uint8Array(r);return self.crypto.getRandomValues(a),a.buffer},t.generateCipherText=function(){return f.apply(this,arguments)},t.generateMac=function(e,t,r){var a=new Uint8Array(s.OCTET_LENGTH);a.set([e.byteLength],a.byteLength-1);var i=(0,u.combine)([e,t,a.buffer]);return new l.default(r).sign(i,s.MAC_LENGTH)},t.decryptCipherText=function(){return _.apply(this,arguments)},t.generateSnapshotMac=function(e,t,r,a){return new o.default(e).sign((0,u.combine)([t,r,a]))},t.generatePatchMac=function(e,t,r,a,i){return new o.default(e).sign((0,u.combine)([t,...r,a,i]))},t.valueMacFromIndexAndValueCipherText=function(e){var t=e.byteLength;return new Uint8Array(e).slice(t-s.MAC_LENGTH).buffer},t.generateEncryptionKeys=void 0;var i=a(r(52954)),n=a(r(30733)),s=r(41431),o=a(r(34601)),l=a(r(66025)),d=r(65634),u=r(44891),c=r(84337),p=r(3408),h=(0,n.default)(p.generateEncryptionKeysUnmemoized,c.encodeB64);function f(){return(f=(0,i.default)((function*(e,t,r){var a=yield self.crypto.subtle.importKey("raw",new Uint8Array(t),"AES-CBC",!1,["encrypt"]);return yield self.crypto.subtle.encrypt({name:"AES-CBC",iv:e},a,r)}))).apply(this,arguments)}function _(){return(_=(0,i.default)((function*(e,t,r){var a=yield self.crypto.subtle.importKey("raw",new Uint8Array(t),"AES-CBC",!1,["decrypt"]);return yield self.crypto.subtle.decrypt({name:"AES-CBC",iv:e},a,r)}))).apply(this,arguments)}t.generateEncryptionKeys=h},3408:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.generateEncryptionKeysUnmemoized=function(){return l.apply(this,arguments)};var n=i(r(52954)),s=a(r(25212)),o=r(41431);function l(){return(l=(0,n.default)((function*(e){var t=yield d(e);return{indexKey:t.slice(0,o.INDEX_KEY_END),valueEncryptionKey:t.slice(o.INDEX_KEY_END,o.VALUE_ENCRYPTION_KEY_END),valueMacKey:t.slice(o.VALUE_ENCRYPTION_KEY_END,o.VALUE_MAC_KEY_END),snapshotMacKey:t.slice(o.VALUE_MAC_KEY_END,o.SNAPSHOT_MAC_KEY_END),patchMacKey:t.slice(o.SNAPSHOT_MAC_KEY_END,o.PATCH_MAC_KEY_END)}}))).apply(this,arguments)}function d(e){return s.extractAndExpand(e,o.HKDF_INFO,o.DERIVED_KEY_LENGTH)}},44891:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.combine=function(e){if(0===e.length)throw new Error("buffers length is zero");if(1===e.length)return e[0];var t,r=e.map((e=>e.byteLength)).reduce(((e,t)=>e+t)),a=new Uint8Array(r),i=0;for(t=0;t<e.length;t++)a.set(new Uint8Array(e[t]),i),i+=e[t].byteLength;return a.buffer},t.split=function(e,t,r){if(t<0||r<0)throw new Error("buffers length is zero");var a=new Array(3),i=new Uint8Array(e);return a[0]=i.slice(0,t).buffer,a[1]=i.slice(t,t+r).buffer,a[2]=i.slice(t+r).buffer,a},t.hexToUint8Array=function(e){return Uint8Array.from(e.split(" ").map((e=>parseInt(e,16))))},t.arrayBufferToHex=function(e){return[...new Uint8Array(e)].map((e=>e.toString(16))).toString().replace(/,/g," ")},t.arrayBuffersAreEqual=function(e,t){return function(e,t){if(e.byteLength!==t.byteLength)return!1;for(var r=0;r<e.byteLength;r++)if(e.getUint8(r)!==t.getUint8(r))return!1;return!0}(new DataView(e),new DataView(t))},t.to64BitNetworkOrder=function(e){var t=new ArrayBuffer(8);return new DataView(t).setUint32(4,e,!1),t},t.toUtf8=function(e){return r.encode(e)};var r=new TextEncoder},93371:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(52954)),n=r(55292),s=r(38027),o=r(92166),l=(r(60608),r(9557),new ArrayBuffer(n.KEY_LENGTH_BYTES));t.default=class{static getAllPendingMutationsRows(){return(0,s.getPendingMutationsTable)().all()}static performTransaction(e){return(0,o.getStorage)().lock(["collection-version","pending-mutations","sync-actions"],e)}static getPendingMutationsRows(e,t){return(0,s.getPendingMutationsTable)().equals(e,t)}static getPendingMutationsRowsById(e){return(0,i.default)((function*(){return(yield(0,s.getPendingMutationsTable)().bulkGet(e)).filter(Boolean)}))()}static appendPendingMutationsRows(e){return(0,s.getPendingMutationsTable)().bulkCreate(e)}static bulkUpdatePendingMutationsKeyId(e){return(0,s.getPendingMutationsTable)().bulkCreateOrMerge(e)}static bulkRemovePendingMutations(e){return(0,s.getPendingMutationsTable)().bulkRemove(e)}static getCollectionVersion(e){return(0,i.default)((function*(){var t=yield(0,s.getCollectionVersionTable)().get(e);return null==t?void 0:t.version}))()}static setCollectionVersion(e,t,r){return(0,s.getCollectionVersionTable)().createOrMerge(e,{collection:e,version:t,ltHash:r})}static getLtHash(e){return(0,i.default)((function*(){var t=yield(0,s.getCollectionVersionTable)().get(e);return(null==t?void 0:t.ltHash)||l}))()}static getSyncAction(e){return(0,s.getSyncActionsTable)().get(e)}static getSyncActionsRows(e,t){return(0,s.getSyncActionsTable)().anyOf(e,t)}static setSyncAction(e){return(0,s.getSyncActionsTable)().createOrReplace(e)}static setSyncActionRows(e){return(0,s.getSyncActionsTable)().bulkCreateOrReplace(e)}static deleteSyncActionRows(e){return(0,s.getSyncActionsTable)().bulkRemove(e)}static getSyncKey(e){return(0,s.getSyncKeysTable)().get(e)}static getAllSyncKeys(){return(0,s.getSyncKeysTable)().all()}static createSyncKey(e){return(0,s.getSyncKeysTable)().create(e)}static getSyncKeyData(e){return(0,s.getSyncKeysTable)().get(e)}static expireSyncKey(e){return(0,s.getSyncKeysTable)().equals(["keyEpoch"],e).then((e=>{e.forEach((e=>(0,s.getSyncKeysTable)().merge(e.keyId,{keyId:e.keyId,timestamp:0})))}))}static getMissingKey(e){return(0,s.getMissingKeysTable)().get(e)}static getMissingKeyCount(){return(0,s.getMissingKeysTable)().count()}static bulkGetMissingKeys(e){return(0,s.getMissingKeysTable)().bulkGet(e)}static getAllMissingKeys(){return(0,s.getMissingKeysTable)().all()}static bulkRemoveMissingKeys(e){return(0,s.getMissingKeysTable)().bulkRemove(e)}static updateMissingKey(e){return(0,s.getMissingKeysTable)().merge(e.keyId,e)}static createOrUpdateMissingKeys(e){return(0,s.getMissingKeysTable)().bulkCreateOrMerge(e)}}},9807:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.computeLtHashAndValidateSnapshot=function(){return m.apply(this,arguments)},t.computeLtHashAndValidatePatch=function(){return g.apply(this,arguments)},t.computeOutgoingSnapshotAndPatchMacs=function(){return T.apply(this,arguments)},t.computeLtHash=A;var i=a(r(52954)),n=r(67),s=a(r(93371)),o=r(83961),l=r(20213),d=r(55292),u=r(65634),c=r(44891),p=r(17845),h=a(r(54559)),f=a(r(84161)),_=new TextDecoder;function m(){return(m=(0,i.default)((function*(e,t){var{mac:r,version:a,keyId:i,records:s}=t,u=yield(0,l.getKeyData)(i.id);if(!u)throw new o.SyncdMissingKeyError;var p=s.map((e=>(0,n.valueMacFromIndexAndValueCipherText)(e.value.blob))),h=yield d.LT_HASH_ANTI_TAMPERING.add(d.EMPTY_LT_HASH,p),{snapshotMacKey:f}=yield(0,n.generateEncryptionKeys)(u),_=(0,c.to64BitNetworkOrder)(a.version),m=(0,c.toUtf8)(e).buffer;return yield v(r,f,h,_,m,!0),h}))).apply(this,arguments)}function g(){return(g=(0,i.default)((function*(e,t){var{version:r,mutations:a,snapshotMac:i,patchMac:s,keyId:d}=t,u=d.id,p=yield(0,l.getKeyData)(u);if(!p)throw new o.SyncdMissingKeyError;var{snapshotMacKey:h,patchMacKey:f}=yield(0,n.generateEncryptionKeys)(p),_=a.map((e=>({operation:e.operation,indexMac:e.record.index.blob,valueMac:(0,n.valueMacFromIndexAndValueCipherText)(e.record.value.blob)}))),m=yield A(e,_),g=(0,c.to64BitNetworkOrder)(r.version),E=(0,c.toUtf8)(e).buffer;return yield y(s,f,i,_.map((e=>e.valueMac)),g,E),yield v(i,h,m,g,E,!1),m}))).apply(this,arguments)}function v(){return E.apply(this,arguments)}function E(){return(E=(0,i.default)((function*(e,t,r,a,i,s){var l=yield(0,n.generateSnapshotMac)(t,r,a,i);if(!(0,c.arrayBuffersAreEqual)(l,e)){var d=s?f.default.MD_SYNCD_FATAL_ERROR_CODE.SNAPSHOT_MAC_MISMATCH_IN_SNAPSHOT:f.default.MD_SYNCD_FATAL_ERROR_CODE.SNAPSHOT_MAC_MISMATCH_IN_PATCH;if(new f.default.MdFatalError({mdFatalErrorCode:d}).commit(),__LOG__(3,void 0,void 0,!0)`syncd: unable to validate snapshot mac.`,SEND_LOGS("syncd: unable to validate snapshot mac."),h.default.syncdAntiTamperingFatalExceptionEnabled)throw new o.SyncdFatalError("unable to validate snapshot mac")}}))).apply(this,arguments)}function y(){return S.apply(this,arguments)}function S(){return(S=(0,i.default)((function*(e,t,r,a,i,s){var l=yield(0,n.generatePatchMac)(t,r,a,i,s);if(!(0,c.arrayBuffersAreEqual)(l,e)&&(new f.default.MdFatalError({mdFatalErrorCode:f.default.MD_SYNCD_FATAL_ERROR_CODE.MAC_MISMATCH_PATCH}).commit(),__LOG__(3,void 0,void 0,!0)`syncd: unable to validate patch mac.`,SEND_LOGS("syncd: unable to validate patch mac."),h.default.syncdAntiTamperingFatalExceptionEnabled))throw new o.SyncdFatalError("unable to validate patch mac")}))).apply(this,arguments)}function T(){return(T=(0,i.default)((function*(e,t,r,a){var i=((yield s.default.getCollectionVersion(e))||p.DEFAULT_COLLECTION_VERSION)+1,{patchMacKey:o,snapshotMacKey:l}=yield(0,n.generateEncryptionKeys)(a),d=(0,c.to64BitNetworkOrder)(i),u=(0,c.toUtf8)(e).buffer,h=yield(0,n.generateSnapshotMac)(l,t,d,u);return{snapshotMac:h,patchMac:yield(0,n.generatePatchMac)(o,h,r.map((e=>e.valueMac)),d,u)}}))).apply(this,arguments)}function A(){return b.apply(this,arguments)}function b(){return(b=(0,i.default)((function*(e,t){var r=yield s.default.getLtHash(e),a=yield C(t.map((e=>e.indexMac))),i=[],n=[];return t.forEach((e=>{var{indexMac:t,valueMac:r,operation:s}=e,o=_.decode(t),l=a.get(o);l?n.push(l):u.SyncdMutationSyncdOperation.REMOVE,s===u.SyncdMutationSyncdOperation.SET&&i.push(r)})),yield d.LT_HASH_ANTI_TAMPERING.subtractThenAdd(r,i,n)}))).apply(this,arguments)}function C(){return P.apply(this,arguments)}function P(){return(P=(0,i.default)((function*(e){var t=yield s.default.getSyncActionsRows(["indexMac"],e);return new Map(t.map((e=>[_.decode(e.indexMac),e.valueMac])))}))).apply(this,arguments)}},8711:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.maxSupportedVersion=t.ActionHandlers=void 0;var i=a(r(71644)),n=a(r(54064)),s=r(17845),o=a(r(34555)),l=a(r(62293)),d=a(r(67883)),u=a(r(96157)),c=a(r(7306)),p=a(r(39016)),h=a(r(54805)),f=a(r(43010)),_=a(r(56675)),m=a(r(48163)),g=a(r(32895)),v=a(r(33116)),E=a(r(23492)),y=new Map([[s.Actions.Star,m.default],[s.Actions.Contact,o.default],[s.Actions.Mute,h.default],[s.Actions.LabelEdit,u.default],[s.Actions.LabelMessage,d.default],[s.Actions.LabelJid,l.default],[s.Actions.QuickReply,_.default],[s.Actions.LocaleSetting,c.default],[s.Actions.SettingPushName,f.default],[s.Actions.Archive,n.default],[s.Actions.MarkChatAsRead,p.default],[s.Actions.ClearChat,g.default],[s.Actions.DeleteMessageForMe,v.default],[s.Actions.Sentinel,E.default]]);t.ActionHandlers=y;t.maxSupportedVersion=()=>(0,i.default)(Array.from(y.values()).map((e=>e.version)))},50350:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.decodeExternalBlobReference=function(e){try{return(0,i.decodeProto)(o.ExternalBlobReferenceSpec,e)}catch(e){throw new s.default.MdFatalError({mdFatalErrorCode:s.default.MD_SYNCD_FATAL_ERROR_CODE.EXTERNAL_BLOB_REFERENCE_PROTOBUF_DESERIALIZATION_FAILED}).commit(),new n.SyncdFatalError("external blob reference protobuf deserialization failed")}},t.decodeSyncdSnapshot=function(e){try{return(0,i.decodeProto)(o.SyncdSnapshotSpec,e)}catch(e){throw new s.default.MdFatalError({mdFatalErrorCode:s.default.MD_SYNCD_FATAL_ERROR_CODE.SNAPSHOT_PROTOBUF_DESERIALIZATION_FAILED}).commit(),new n.SyncdFatalError("snapshot protobuf deserialization failed")}},t.decodeSyncdPatch=function(e){try{return(0,i.decodeProto)(o.SyncdPatchSpec,e)}catch(e){throw new s.default.MdFatalError({mdFatalErrorCode:s.default.MD_SYNCD_FATAL_ERROR_CODE.PATCH_PROTOBUF_DESERIALIZATION_FAILED}).commit(),new n.SyncdFatalError("patch protobuf deserialization failed")}},t.decodeSyncdMutations=function(e){try{return(0,i.decodeProto)(o.SyncdMutationsSpec,e)}catch(e){throw new s.default.MdFatalError({mdFatalErrorCode:s.default.MD_SYNCD_FATAL_ERROR_CODE.MUTATIONS_PROTOBUF_DESERIALIZATION_FAILED}).commit(),new n.SyncdFatalError("mutations protobuf deserialization failed")}},t.decodeSyncActionData=function(e){try{return(0,i.decodeProto)(l.SyncActionDataSpec,e)}catch(e){throw new s.default.MdFatalError({mdFatalErrorCode:s.default.MD_SYNCD_FATAL_ERROR_CODE.ACTION_DATA_PROTOBUF_DESERIALIZATION_FAILED}).commit(),new n.SyncdFatalError("action data protobuf deserialization failed")}};var i=r(9557),n=r(83961),s=a(r(84161)),o=r(65634),l=r(60608)},97623:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.tryDecryptSnapshot=function(){return g.apply(this,arguments)},t.tryDecryptPatch=function(){return v.apply(this,arguments)};var i=a(r(52954)),n=r(76549),s=r(50350),o=r(41431),l=r(67),d=r(83961),u=r(20213),c=a(r(84161)),p=r(65634),h=r(60608),f=r(44891),_=a(r(41960)),m=new TextDecoder;function g(){return(g=(0,i.default)((function*(e,t){return yield Promise.all(t.records.map((t=>E(e,p.SyncdMutationSyncdOperation.SET,t))))}))).apply(this,arguments)}function v(){return(v=(0,i.default)((function*(e,t){return yield Promise.all(t.mutations.map((t=>E(e,t.operation,t.record))))}))).apply(this,arguments)}function E(){return y.apply(this,arguments)}function y(){return(y=(0,i.default)((function*(e,t,r){var a=r.keyId.id,i=yield(0,u.getKeyData)(a);if(!i){if(t===p.SyncdMutationSyncdOperation.REMOVE)throw new d.SyncdFatalError("no key data for remove mutations");throw new d.SyncdMissingKeyError}var{syncAction:s,indexMac:o,valueMac:l}=yield S(a,i,t,r),{index:c,value:f,version:_}=s,g=f?(0,n.encodeProto)(h.SyncActionValueSpec,f).readBuffer():f;return{index:m.decode(c),binarySyncAction:g,version:_,keyId:a,operation:t,indexMac:o,valueMac:l,collection:e}}))).apply(this,arguments)}function S(){return T.apply(this,arguments)}function T(){return(T=(0,i.default)((function*(e,t,r,a){var i=a.index.blob,n=a.value.blob,u=(0,l.valueMacFromIndexAndValueCipherText)(n),p=(0,f.split)(n,o.IV_LENGTH,n.byteLength-o.MAC_LENGTH-o.IV_LENGTH),h=p[0],m=p[1],g=p[2],v=yield(0,l.generateEncryptionKeys)(t),{indexKey:E,valueEncryptionKey:y,valueMacKey:S}=v,T=(0,f.combine)([h,m]),A=(0,l.generateAssociatedData)(r,e),b=yield(0,l.generateMac)(A,T,S),C=yield(0,l.decryptCipherText)(new Uint8Array(h),y,m),P=(0,s.decodeSyncActionData)(C),O=_.default.validateSyncActionDataProtobuf(P),w=yield(0,l.generateIndexMac)(E,O.index);if(!(0,f.arrayBuffersAreEqual)(i,w)||!(0,f.arrayBuffersAreEqual)(g,b))throw new c.default.MdFatalError({mdFatalErrorCode:c.default.MD_SYNCD_FATAL_ERROR_CODE.DECRYPTION_FAILED}).commit(),new d.SyncdFatalError("decryption failure");return{syncAction:O,indexMac:i,valueMac:u}}))).apply(this,arguments)}},49431:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.applyIndividualMutations=function(){return M.apply(this,arguments)},t.default=function(){return I.apply(this,arguments)};var i=a(r(52954)),n=a(r(829)),s=r(8711),o=r(9807),l=r(17845),d=a(r(93371)),u=r(97623),c=r(83961),p=r(60478),h=r(74924),f=r(52150),_=r(65634),m=r(20325),g=r(67457),v=a(r(10068)),E=a(r(32856)),y=r(46801),S=r(9557),T=r(60608),A=a(r(84161)),b=r(95334),C=r(68297),P=r(25364),O=r(64571),w=new ArrayBuffer(128);function M(){return(M=(0,i.default)((function*(e){if(0===e.length)return Promise.resolve();var t=(0,m.syncActionsToDecryptedMutation)(e);yield Promise.all(t.map(function(){var e=(0,i.default)((function*(e){var{setMutationsToPersist:t,pendingMutationsToDrop:r}=yield Y(e.collection,[e]);yield d.default.performTransaction((0,i.default)((function*(){yield d.default.setSyncActionRows(t),yield d.default.bulkRemovePendingMutations(r)})))}));return function(){return e.apply(this,arguments)}}()))}))).apply(this,arguments)}function I(){return(I=(0,i.default)((function*(e,t){var{name:r,version:a,patches:i,snapshot:n,syncedPendingMutationsId:s,syncedEncryptedMutations:o}=e;__LOG__(2)`syncd: start applying collection ${r}`;var[u,p]=yield N(r,i,n,t);try{return null!=u?(yield k(r,u,p,t),__LOG__(2)`syncd: ${r} snapshot and patches applied successfully`):null!=p?(yield G(r,p,t),__LOG__(2)`syncd: ${r} patches applied successfully`):null!=a?(yield R(r,a,s,o),__LOG__(2)`syncd: ${r} v${a} uploaded successfully`):((0,O.isBootstrap)(t)&&(yield d.default.setCollectionVersion(r,0,w)),__LOG__(2)`syncd: sync ${r} but there are no updates`),e}catch(e){var h=e.message;return e instanceof c.SyncdMissingKeyError?(__LOG__(3)`syncd key error: ${r} missing keys`,{name:r,state:l.CollectionState.Blocked}):e instanceof c.SyncdFatalError?(__LOG__(4,void 0,new Error,!0)`syncd fatal error: ${r} throws ${h}`,SEND_LOGS(`syncd fatal error: ${String(r)} throws ${h}`),{name:r,state:l.CollectionState.ErrorFatal}):(__LOG__(3)`syncd retryable error: ${r} throws ${h}`,{name:r,state:l.CollectionState.ErrorRetry})}}))).apply(this,arguments)}function R(){return D.apply(this,arguments)}function D(){return(D=(0,i.default)((function*(e,t,r,a){var n=a.map((e=>({indexMac:e.indexMac,valueMac:e.valueMac,operation:e.operation}))),s=yield(0,o.computeLtHash)(e,n),u=(0,m.encryptedUploadMutationsToSyncActions)(a.filter((e=>e.operation===_.SyncdMutationSyncdOperation.SET)),l.SyncActionState.Success);yield d.default.performTransaction((0,i.default)((function*(){yield d.default.setSyncActionRows(u),yield d.default.bulkRemovePendingMutations(r),yield d.default.setCollectionVersion(e,t,s)})))}))).apply(this,arguments)}function N(){return L.apply(this,arguments)}function L(){return(L=(0,i.default)((function*(e,t,r,a){var n=Promise.resolve(),s=0,o=(0,b.unixTimeMs)();if(null!=r){var l=v.default.validateExternalBlobReference(r);s+=(0,P.numberOrThrowIfTooLarge)(l.fileSizeBytes||0),n=(0,h.downloadSnapshot)(l)}var d,u,c=Promise.resolve();if(null!=t){var p=t.map(v.default.validatePatchProtobuf);c=Promise.all(p.map(function(){var t=(0,i.default)((function*(t){var r=t.mutations||[],a=t.externalMutations;return a&&(r=yield(0,h.downloadExternalPatch)(a),__LOG__(2)`syncd: ${e}'s external patch downloaded`,s+=(0,P.numberOrThrowIfTooLarge)(a.fileSizeBytes||0)),{mutations:r,version:t.version,snapshotMac:t.snapshotMac,patchMac:t.patchMac,keyId:t.keyId,exitCode:t.exitCode}}));return function(){return t.apply(this,arguments)}}()))}try{[d,u]=yield Promise.all([n,c]),(0,O.isBootstrap)(a)&&(0,C.commitBootstrapAppStateDownloadMetric)(e,o,s,!0)}catch(t){throw(0,O.isBootstrap)(a)&&(0,C.commitBootstrapAppStateDownloadMetric)(e,o,s,!1),t}return[d,u]}))).apply(this,arguments)}function k(){return U.apply(this,arguments)}function U(){return(U=(0,i.default)((function*(e,t,r,a){try{var n=yield(0,o.computeLtHashAndValidateSnapshot)(e,t);__LOG__(2)`syncd: collection ${e}'s snapshot validated`;var s=yield(0,u.tryDecryptSnapshot)(e,t);__LOG__(2)`syncd: collection ${e}'s snapshot decrypted`,E.default.addMutationCount(t.records.length),(0,y.logMetricsForMutations)(s),(0,g.validateNoSameIndexForMultipleMutations)(s,l.SyncDataType.Snapshot);var h=t.version.version,{setMutationsToPersist:f,pendingMutationsToDrop:_}=yield Y(e,s);__LOG__(2)`syncd: processed ${s.length} mutations in snapshot of collection ${e}`,__LOG__(2)`syncd: collection ${e}'s snapshot v${h} applied`,yield d.default.performTransaction((0,i.default)((function*(){yield d.default.setSyncActionRows(f),yield d.default.bulkRemovePendingMutations(_),yield d.default.setCollectionVersion(e,h,n)})))}catch(r){throw r instanceof c.SyncdMissingKeyError&&(yield(0,p.handleMissingKeysInSnapshot)(e,t)),r}if(r)return G(e,r,a)}))).apply(this,arguments)}function G(){return F.apply(this,arguments)}function F(){return(F=(0,i.default)((function*(e,t){if(0===t.length)return Promise.resolve();(0,g.validateNoDuplicatePatchVersionInCollection)(t);var r=(0,n.default)(t,(e=>e.version.version));try{for(var a=0;a<r.length;a++)yield x(e,r[a])}catch(t){throw t instanceof c.SyncdMissingKeyError&&(yield(0,p.handleMissingKeysInPatches)(e,r)),t}}))).apply(this,arguments)}function x(){return B.apply(this,arguments)}function B(){return(B=(0,i.default)((function*(e,t){if(t.exitCode){var r,a=t.exitCode.code;switch(a){case 100:new A.default.MdFatalError({mdFatalErrorCode:A.default.MD_SYNCD_FATAL_ERROR_CODE.TERMINAL_PATCH_MISSING_DATA}).commit();break;case 101:new A.default.MdFatalError({mdFatalErrorCode:A.default.MD_SYNCD_FATAL_ERROR_CODE.TERMINAL_PATCH_DESERIALIZATION_ERROR}).commit();break;default:new A.default.MdFatalError({mdFatalErrorCode:A.default.MD_SYNCD_FATAL_ERROR_CODE.TERMINAL_PATCH_UNKNOWN}).commit()}throw new c.SyncdFatalError(`received terminal patch with exit code:  ${String(a)} text: ${String(null===(r=t.exitCode)||void 0===r?void 0:r.text)}  `)}var n=yield(0,o.computeLtHashAndValidatePatch)(e,t),s=yield(0,u.tryDecryptPatch)(e,t);(0,y.logMetricsForMutations)(s),E.default.addMutationCount(s.length),(0,g.validateNoSameIndexForMultipleMutations)(s,l.SyncDataType.Patch);var p=H(s),h=p.filter((e=>e.operation===_.SyncdMutationSyncdOperation.REMOVE));yield j(e,h);var f=p.filter((e=>e.operation===_.SyncdMutationSyncdOperation.SET)),{setMutationsToPersist:m,pendingMutationsToDrop:v}=yield Y(e,f);__LOG__(2)`syncd: processed ${s.length} mutations in patch version ${t.version.version} of collection ${e}`;var S=t.version.version;yield d.default.performTransaction((0,i.default)((function*(){yield d.default.deleteSyncActionRows(h.map((e=>e.index))),yield d.default.setSyncActionRows(m),yield d.default.bulkRemovePendingMutations(v),yield d.default.setCollectionVersion(e,S,n)})))}))).apply(this,arguments)}function Y(){return K.apply(this,arguments)}function K(){return(K=(0,i.default)((function*(e,t){var r=[],a=(0,g.validateAndTypeSetMutations)(t),{supportedMutations:i,unsupportedMutations:n}=V(a);n.forEach((e=>r.push((0,m.setMutationToSyncAction)(e,l.SyncActionState.Unsupported))));var{remoteMutationsToApply:s,pendingMutationsToDrop:o}=yield(0,f.resolveConflict)(e,i);i.filter((e=>!s.includes(e))).forEach((e=>r.push((0,m.setMutationToSyncAction)(e,l.SyncActionState.Skipped,e.actionName))));for(var d=$(s),u=0;u<d.length;u++)for(var c=d[u][0].actionHandler,p=d[u].map((e=>({operation:"set",indexParts:e.indexArr,value:(0,S.decodeProto)(T.SyncActionValueSpec,e.binarySyncAction),timestamp:e.timestamp}))),h=yield c.applyMutations(p),_=0;_<d[u].length;_++){var v,E;r.push((0,m.setMutationToSyncAction)(d[u][_],h[_].actionState,d[u][_].actionName,null===(v=h[_].orphanModel)||void 0===v?void 0:v.modelId,null===(E=h[_].orphanModel)||void 0===E?void 0:E.modelType))}return{setMutationsToPersist:r,pendingMutationsToDrop:o}}))).apply(this,arguments)}function j(){return W.apply(this,arguments)}function W(){return(W=(0,i.default)((function*(e,t){yield Promise.all(t.map(function(){var e=(0,i.default)((function*(e){var t=q(e.index),r=l.Actions.cast(t[0]);if(r){var a=s.ActionHandlers.get(r);a?yield a.applyMutations([{operation:"remove",indexParts:t}]):__LOG__(2)`syncd: no handler for action ${r}`}else __LOG__(2)`syncd: invalid action ${t[0]}`}));return function(){return e.apply(this,arguments)}}()))}))).apply(this,arguments)}function H(e){var t=e.filter((e=>e.operation===_.SyncdMutationSyncdOperation.SET)),r=new Set(t.map((e=>e.index)));return e.filter((e=>e.operation===_.SyncdMutationSyncdOperation.REMOVE)).forEach((e=>{r.has(e.index)||t.push(e)})),t}function V(e){var t=[],r=[];return e.forEach((e=>{if(e.version>(0,s.maxSupportedVersion)())r.push(e);else{var a=q(e.index),i=l.Actions.cast(a[0]);if(!i)return __LOG__(3)`syncd: invalid action ${a[0]}`,void r.push(e);var n=s.ActionHandlers.get(i);if(!n)return __LOG__(3)`syncd: no handler for action ${i}`,void r.push(e);t.push({collection:e.collection,index:e.index,indexMac:e.indexMac,keyId:e.keyId,timestamp:e.timestamp,binarySyncAction:e.binarySyncAction,valueMac:e.valueMac,version:e.version,indexArr:a,actionName:i,actionHandler:n})}})),{supportedMutations:t,unsupportedMutations:r}}function $(e){return e.reduce(((e,t)=>(0!==e.length&&t.actionName===e[e.length-1][0].actionName?e[e.length-1].push(t):e.push([t]),e)),[])}function q(e){try{var t=JSON.parse(e);if(t.length<1)throw new Error;return t}catch(e){throw new A.default.MdFatalError({mdFatalErrorCode:A.default.MD_SYNCD_FATAL_ERROR_CODE.INVALID_ACTION_INDEX}).commit(),new c.SyncdFatalError("invalid action index")}}},74924:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.downloadSnapshot=function(){return f.apply(this,arguments)},t.downloadExternalPatch=function(){return _.apply(this,arguments)};var i=a(r(70417)),n=a(r(52954)),s=r(50350),o=r(84337),l=a(r(45026)),d=a(r(26082)),u=a(r(10068)),c=r(95378),p=a(r(84161)),h=r(83961);function f(){return(f=(0,n.default)((function*(e){try{var t=yield m(e),r=(0,s.decodeSyncdSnapshot)(t);return u.default.validateSnapshotProtobuf(r)}catch(e){if(e instanceof c.MediaNotFoundError)throw new p.default.MdFatalError({mdFatalErrorCode:p.default.MD_SYNCD_FATAL_ERROR_CODE.SNAPSHOT_EXPIRED}).commit(),new h.SyncdFatalError("snapshot expired");throw e}}))).apply(this,arguments)}function _(){return(_=(0,n.default)((function*(e){try{var t=yield m(e);return(0,s.decodeSyncdMutations)(t).mutations.map(u.default.validateMutationProtobuf)}catch(e){if(e instanceof c.MediaNotFoundError)throw new p.default.MdFatalError({mdFatalErrorCode:p.default.MD_SYNCD_FATAL_ERROR_CODE.EXTERNAL_PATCH_EXPIRED}).commit(),new h.SyncdFatalError("external patch expired");throw e}}))).apply(this,arguments)}function m(e){var{mediaKey:t,directPath:r,fileSha256:a,fileEncSha256:n}=e,s={directPath:r,encFilehash:(0,o.encodeB64)(n),filehash:(0,o.encodeB64)(a),mediaKey:(0,o.encodeB64)(t),type:"md-app-state",userDownloadAttemptCount:0};return d.default.downloadAndDecrypt((0,i.default)({signal:(new l.default).signal},s))}},52150:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.resolveConflict=function(){return l.apply(this,arguments)};var i=a(r(52954)),n=r(17845),s=a(r(93371)),o=r(1550);function l(){return(l=(0,i.default)((function*(e,t){var r=[],a=[],i=yield s.default.getPendingMutationsRows(["collection"],e),l=new Map(i.map((e=>[e.index,e])));t.forEach((e=>{var t=l.get(e.index);if(t)switch(e.actionHandler.resolveConflicts(t,e)){case n.ConflictResolutionState.SkipRemote:break;case n.ConflictResolutionState.ApplyRemoteAndDropLocal:r.push(e),a=a.concat(i.filter((t=>t.index===e.index)));break;case n.ConflictResolutionState.SkipRemoteAndDropLocal:a=a.concat(i.filter((t=>t.index===e.index)))}else r.push(e)}));for(var d=(0,o.sort)(r),u=[],c=0;c<d.length;c++){var p=d[c].actionHandler;(yield p.dropMutationDueToCrossIndexConflict(d[c],l))||u.push(d[c])}return{remoteMutationsToApply:u,pendingMutationsToDrop:a.map((e=>e.id)).filter(Boolean)}}))).apply(this,arguments)}},1550:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.sort=function(e){var t=[],r=[];try{return e.forEach((a=>{t.push(a);var i=o.get(a.actionName);null!=i&&e.forEach((e=>{e!==a&&i.includes(e.actionName)&&function(e,t){var r=e.actionHandler.getChatJidAndMessageKey(e),a=t.actionHandler.getChatJidAndMessageKey(t);if(r&&a)return r.chatJid===a.chatJid&&(null==r.messageKey||null==a.messageKey||r.messageKey===a.messageKey);return!1}(e,a)&&(e.timestamp<a.timestamp?r.push([e,a]):r.push([a,e]))}))})),i.default.array(t,r)}catch(e){throw new s.default.MdFatalError({mdFatalErrorCode:s.default.MD_SYNCD_FATAL_ERROR_CODE.CYCLIC_MUTATION_DEPENDENCY_IN_PATCH}).commit(),new n.SyncdFatalError("cyclic mutation dependency in patch")}},t._setDependency=function(e,t){o.set(e,t)};var i=a(r(95159)),n=(r(17845),r(83961)),s=a(r(84161)),o=new Map},20325:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.encryptedUploadMutationsToSyncActions=function(e,t){return e.map((e=>({index:e.index,binarySyncAction:e.binarySyncAction,actionState:t,version:e.version,keyId:e.keyId,indexMac:e.indexMac,valueMac:e.valueMac,collection:e.collection,timestamp:e.timestamp})))},t.setMutationToSyncAction=function(e,t,r,a,i){return{index:e.index,binarySyncAction:e.binarySyncAction,version:e.version,keyId:e.keyId,indexMac:e.indexMac,valueMac:e.valueMac,collection:e.collection,timestamp:e.timestamp,action:r,actionState:t,modelId:a,modelType:i}},t.syncActionsToDecryptedMutation=function(e){return e.map((e=>({collection:e.collection,index:e.index,indexMac:e.indexMac,keyId:e.keyId,operation:a.SyncdMutationSyncdOperation.SET,binarySyncAction:e.binarySyncAction,valueMac:e.valueMac,version:e.version})))};var a=r(65634)},67457:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.validateNoDuplicatePatchVersionInCollection=function(e){var t=new Set;e.forEach((e=>{var r=e.version.version;if(t.has(r))throw new o.default.MdFatalError({mdFatalErrorCode:o.default.MD_SYNCD_FATAL_ERROR_CODE.DUPLICATE_PATCH_VERSION_IN_COLLECTION}).commit(),new s.SyncdFatalError("duplicate patch version in collection");t.add(r)}))},t.validateNoSameIndexForMultipleMutations=function(e,t){var r=new Set,a=new Set;e.forEach((e=>{var i=!1;if(e.operation===l.SyncdMutationSyncdOperation.SET&&(r.has(e.index)?i=!0:r.add(e.index)),e.operation===l.SyncdMutationSyncdOperation.REMOVE&&(a.has(e.index)?i=!0:a.add(e.index)),i)switch(t){case n.SyncDataType.Patch:throw new o.default.MdFatalError({mdFatalErrorCode:o.default.MD_SYNCD_FATAL_ERROR_CODE.SAME_INDEX_FOR_MULTIPLE_MUTATIONS_IN_PATCH}).commit(),new s.SyncdFatalError("same index for multiple mutations in patch");case n.SyncDataType.Snapshot:throw new o.default.MdFatalError({mdFatalErrorCode:o.default.MD_SYNCD_FATAL_ERROR_CODE.SAME_INDEX_FOR_MULTIPLE_MUTATIONS_IN_SNAPSHOT}).commit(),new s.SyncdFatalError("same index for multiple mutations in snapshot")}}))},t.validateAndTypeSetMutations=function(e){return e.map((e=>{var t=e.binarySyncAction;if(!t)throw new o.default.MdFatalError({mdFatalErrorCode:o.default.MD_SYNCD_FATAL_ERROR_CODE.MISSING_ACTION_VALUE}).commit(),new s.SyncdFatalError("missing action value");var r=(0,d.decodeProto)(u.SyncActionValueSpec,t),a=(0,i.maybeNumberOrThrowIfTooLarge)(r.timestamp);if(null==a)throw new o.default.MdFatalError({mdFatalErrorCode:o.default.MD_SYNCD_FATAL_ERROR_CODE.MISSING_ACTION_TIMESTAMP}).commit(),new s.SyncdFatalError("missing action timestamp");return{index:e.index,version:e.version,keyId:e.keyId,indexMac:e.indexMac,valueMac:e.valueMac,collection:e.collection,binarySyncAction:t,timestamp:a}}))};var i=r(25364),n=r(17845),s=r(83961),o=a(r(84161)),l=r(65634),d=r(9557),u=r(60608)},10068:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(25364),n=r(83961),s=a(r(84161)),o=a(r(54559)),l=new ArrayBuffer(0);class d{static validateSnapshotProtobuf(e){var{version:t,records:r,mac:a,keyId:u}=e,c=null==t?void 0:t.version;if(!t||null==c)throw new s.default.MdFatalError({mdFatalErrorCode:s.default.MD_SYNCD_FATAL_ERROR_CODE.MISSING_SNAPSHOT_VERSION}).commit(),new n.SyncdFatalError("missing snapshot version");var p=r.map((e=>d.validateRecordProtobuf(e)));if(o.default.syncdAntiTamperingFatalExceptionEnabled){if(!a)throw new s.default.MdFatalError({mdFatalErrorCode:s.default.MD_SYNCD_FATAL_ERROR_CODE.MISSING_SNAPSHOT_MAC}).commit(),new n.SyncdFatalError("missing snapshot mac")}else a||(new s.default.MdFatalError({mdFatalErrorCode:s.default.MD_SYNCD_FATAL_ERROR_CODE.MISSING_SNAPSHOT_MAC}).commit(),__LOG__(3)`syncd warning: missing snapshot mac`);var h=null!=a?a:l,f=d.validateKeyIdProtobuf(u,s.default.MD_SYNCD_FATAL_ERROR_CODE.MISSING_SNAPSHOT_KEY_ID);return{version:{version:(0,i.numberOrThrowIfTooLarge)(c)},records:p,mac:h,keyId:f}}static validatePatchProtobuf(e){var{version:t,mutations:r,externalMutations:a,snapshotMac:u,patchMac:c,keyId:p,exitCode:h}=e,f=null==t?void 0:t.version;if(!t||null==f)throw new s.default.MdFatalError({mdFatalErrorCode:s.default.MD_SYNCD_FATAL_ERROR_CODE.MISSING_PATCH_VERSION}).commit(),new n.SyncdFatalError("missing patch version");if(r&&r.length>0&&a)throw new s.default.MdFatalError({mdFatalErrorCode:s.default.MD_SYNCD_FATAL_ERROR_CODE.PATCH_WITH_BOTH_INLINE_AND_EXTERNAL_MUTATIONS}).commit(),new n.SyncdFatalError("patch with both inline and external mutations");if(o.default.syncdAntiTamperingFatalExceptionEnabled){if(!u)throw new s.default.MdFatalError({mdFatalErrorCode:s.default.MD_SYNCD_FATAL_ERROR_CODE.MISSING_PATCH_SNAPSHOT_MAC}).commit(),new n.SyncdFatalError("missing patch snapshot mac");if(!c)throw new s.default.MdFatalError({mdFatalErrorCode:s.default.MD_SYNCD_FATAL_ERROR_CODE.MISSING_PATCH_MAC}).commit(),new n.SyncdFatalError("missing patch mac")}else u||(new s.default.MdFatalError({mdFatalErrorCode:s.default.MD_SYNCD_FATAL_ERROR_CODE.MISSING_SNAPSHOT_MAC}).commit(),__LOG__(3)`syncd warning:  missing snapshot mac`),c||(new s.default.MdFatalError({mdFatalErrorCode:s.default.MD_SYNCD_FATAL_ERROR_CODE.MISSING_PATCH_MAC}).commit(),__LOG__(3)`syncd warning:  missing patch mac`);var _=null!=u?u:l,m=null!=c?c:l,g=d.validateKeyIdProtobuf(p,s.default.MD_SYNCD_FATAL_ERROR_CODE.MISSING_PATCH_KEY_ID);if(a){var v=d.validateExternalBlobReference(a);return{version:{version:(0,i.numberOrThrowIfTooLarge)(f)},mutations:void 0,externalMutations:v,snapshotMac:_,patchMac:m,keyId:g}}var E=r.map(d.validateMutationProtobuf);return{version:{version:(0,i.numberOrThrowIfTooLarge)(f)},mutations:E,externalMutations:void 0,exitCode:h,snapshotMac:_,patchMac:m,keyId:g}}static validateExternalBlobReference(e){var{mediaKey:t,directPath:r,handle:a,fileSizeBytes:i,fileSha256:o,fileEncSha256:l}=e;if(!t)throw new s.default.MdFatalError({mdFatalErrorCode:s.default.MD_SYNCD_FATAL_ERROR_CODE.MISSING_EXTERNAL_BLOB_REFERENCE_MEDIA_KEY}).commit(),new n.SyncdFatalError("missing external blob reference media key");if(!r)throw new s.default.MdFatalError({mdFatalErrorCode:s.default.MD_SYNCD_FATAL_ERROR_CODE.MISSING_EXTERNAL_BLOB_REFERENCE_DIRECT_PATH}).commit(),new n.SyncdFatalError("missing external blob reference direct path");if(!o)throw new s.default.MdFatalError({mdFatalErrorCode:s.default.MD_SYNCD_FATAL_ERROR_CODE.MISSING_EXTERNAL_BLOB_REFERENCE_FILE_SHA256}).commit(),new n.SyncdFatalError("missing external blob reference file SHA256");if(!l)throw new s.default.MdFatalError({mdFatalErrorCode:s.default.MD_SYNCD_FATAL_ERROR_CODE.MISSING_EXTERNAL_BLOB_REFERENCE_FILE_ENC_SHA256}).commit(),new n.SyncdFatalError("missing external blob reference file enc SHA256");return{mediaKey:t,directPath:r,handle:a,fileSizeBytes:i,fileSha256:o,fileEncSha256:l}}static validateMutationProtobuf(e){var{operation:t,record:r}=e;if(null==t)throw new s.default.MdFatalError({mdFatalErrorCode:s.default.MD_SYNCD_FATAL_ERROR_CODE.MISSING_MUTATION_OPERATION}).commit(),new n.SyncdFatalError("missing mutation operation");if(!r)throw new s.default.MdFatalError({mdFatalErrorCode:s.default.MD_SYNCD_FATAL_ERROR_CODE.MISSING_MUTATION_RECORD}).commit(),new n.SyncdFatalError("missing mutation record");return{operation:t,record:d.validateRecordProtobuf(r)}}static validateRecordProtobuf(e){var{index:t,value:r,keyId:a}=e,i=null==t?void 0:t.blob,o=null==r?void 0:r.blob;if(!t||!i)throw new s.default.MdFatalError({mdFatalErrorCode:s.default.MD_SYNCD_FATAL_ERROR_CODE.MISSING_MUTATION_INDEX}).commit(),new n.SyncdFatalError("missing mutation index");if(!r||!o)throw new s.default.MdFatalError({mdFatalErrorCode:s.default.MD_SYNCD_FATAL_ERROR_CODE.MISSING_MUTATION_VALUE}).commit(),new n.SyncdFatalError("missing mutation value");return{index:{blob:i},value:{blob:o},keyId:d.validateKeyIdProtobuf(a,s.default.MD_SYNCD_FATAL_ERROR_CODE.MISSING_MUTATION_KEY_ID)}}static validateKeyIdProtobuf(e,t){var r=null==e?void 0:e.id;if(!e||!r)throw new s.default.MdFatalError({mdFatalErrorCode:t}).commit(),new n.SyncdFatalError("missing mutation key id");return{id:r}}}t.default=d},41960:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(83961),n=a(r(84161));t.default=class{static validateSyncActionDataProtobuf(e){var{index:t,value:r,padding:a,version:s}=e;if(!t)throw new n.default.MdFatalError({mdFatalErrorCode:n.default.MD_SYNCD_FATAL_ERROR_CODE.MISSING_ACTION_INDEX}).commit(),new i.SyncdFatalError("missing action index");if(null==s)throw new n.default.MdFatalError({mdFatalErrorCode:n.default.MD_SYNCD_FATAL_ERROR_CODE.MISSING_ACTION_VERSION}).commit(),new i.SyncdFatalError("missing action version");return{index:t,value:r,padding:a,version:s}}}},46801:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.logMetricsForMutations=function(e){e.forEach(o)};var i=a(r(84161)),n=r(9557),s=r(60608);function o(e){var t,{binarySyncAction:r}=e;if(null!=r){var a=(0,n.decodeProto)(s.SyncActionValueSpec,r);a.archiveChatAction?t=a.archiveChatAction.messageRange:a.markChatAsReadAction?t=a.markChatAsReadAction.messageRange:a.clearChatAction?t=a.clearChatAction.messageRange:a.deleteChatAction&&(t=a.deleteChatAction.messageRange),null!=t&&new i.default.MdAppStateMessageRange({additionalMessagesCount:t.messages.length}).commit()}}},68297:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.commitBootstrapAppStateDownloadMetric=function(){return c.apply(this,arguments)};var n=i(r(52954)),s=i(r(84161)),o=r(95334),l=r(17845),d=r(25364),u=a(r(25064));function c(){return(c=(0,n.default)((function*(e,t,r,a){var i=new s.default.MdBootstrapAppStateDataDownloaded({mdBootstrapPayloadType:[l.CollectionName.CriticalBlock,l.CollectionName.CriticalUnblockLow].includes(e)?s.default.MD_BOOTSTRAP_PAYLOAD_TYPE.CRITICAL:s.default.MD_BOOTSTRAP_PAYLOAD_TYPE.NON_CRITICAL,mdTimestamp:(0,o.unixTimeMs)(),mdBootstrapStepDuration:(0,o.unixTimeMs)()-t,mdBootstrapStepResult:a?s.default.MD_BOOTSTRAP_STEP_RESULT.SUCCESS:s.default.MD_BOOTSTRAP_STEP_RESULT.FAILURE,mdSessionId:yield u.default.getMdSessionId()}),n=yield u.default.getStorageEstimation();n.mdStorageQuotaBytes!==u.STORAGE_QUOTA_UNAVAILABLE&&(i.mdStorageQuotaUsedBytes=n.mdStorageQuotaUsedBytes,i.mdStorageQuotaBytes=n.mdStorageQuotaBytes);try{var c=(0,d.maybeNumberOrThrowIfTooLarge)(r);null!=c&&(i.mdBootstrapPayloadSize=c)}catch(e){}i.commit()}))).apply(this,arguments)}},63433:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.handleAppStateSyncKeyRequest=function(){return o.apply(this,arguments)};var i=a(r(52954)),n=a(r(93371)),s=r(10828);function o(){return(o=(0,i.default)((function*(e,t){var r=e.keyIds;if(r){var a=r.map((e=>e.keyId)).filter(Boolean);if(a){var o=[],l=[];return yield Promise.all(a.map(function(){var e=(0,i.default)((function*(e){var t=yield n.default.getSyncKey(new Uint8Array(e));t?o.push(t):l.push(e)}));return function(){return e.apply(this,arguments)}}())),(0,s.sendAppStateSyncKeyShare)({type:"missing_key",keys:o,orphanKeys:l,peerDeviceId:t})}}}))).apply(this,arguments)}},76581:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.handleAppStateSyncKeyShare=function(){return h.apply(this,arguments)};var i=a(r(52954)),n=r(25364),s=a(r(93371)),o=r(60478),l=r(58970),d=a(r(84161)),u=r(43179),c=r(44891),p=r(67378);function h(){return(h=(0,i.default)((function*(e,t){var r=[],a=e.keys;if(!a)return Promise.resolve();yield Promise.all(a.map(function(){var e=(0,i.default)((function*(e){var a,i=null===(a=e.keyId)||void 0===a?void 0:a.keyId,o=e.keyData,l=null==o?void 0:o.keyData;if(i){if(6!==i.byteLength)return new d.default.MdFatalError({mdFatalErrorCode:d.default.MD_SYNCD_FATAL_ERROR_CODE.INVALID_KEY_SHARE_KEY_ID}).commit(),__LOG__(4,void 0,new Error,!0)`syncd fatal error: key share key id has invalid bytelength of ${i.byteLength}`,SEND_LOGS(`syncd fatal error: key share key id has invalid bytelength of ${i.byteLength}`),(0,u.handleFatalError)();if(r.push({keyId:i,keyData:l}),__LOG__(2)`syncd: received key share key id ${(0,c.arrayBufferToHex)(i)} from device id ${t.getDeviceId()}`,o){var h,f,_,m=o.timestamp,g=null===(h=o.fingerprint)||void 0===h?void 0:h.currentIndex,v=null===(f=o.fingerprint)||void 0===f?void 0:f.rawId,E=null===(_=o.fingerprint)||void 0===_?void 0:_.deviceIndexes;if(!l||null==m||null==g||null==v||!E)return new d.default.MdFatalError({mdFatalErrorCode:d.default.MD_SYNCD_FATAL_ERROR_CODE.INVALID_KEY_SHARE_KEY_DATA}).commit(),__LOG__(4,void 0,new Error,!0)`syncd fatal error: invalid key share key data`,SEND_LOGS("syncd fatal error: invalid key share key data"),(0,u.handleFatalError)();var y=new Uint8Array(i);(yield s.default.getSyncKey(y))||(yield s.default.createSyncKey({keyId:y,keyEpoch:(0,p.getKeyEpoch)(i),keyData:l,timestamp:(0,n.numberOrThrowIfTooLarge)(m),fingerprint:{rawId:v,currentIndex:g,deviceIndexes:E}}),__LOG__(2)`syncd: stored key share key id ${(0,c.arrayBufferToHex)(i)} from device id ${t.getDeviceId()}`)}}else __LOG__(2)`syncd: received empty key share from device id ${t.getDeviceId()}`}));return function(){return e.apply(this,arguments)}}())),yield(0,o.updateMissingKeys)(r,t),(0,l.syncBlockedCollections)()}))).apply(this,arguments)}},60478:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.updateMissingKeyDevices=function(){return v.apply(this,arguments)},t.updateMissingKeys=function(e,t){var r=[],a=[];return e.forEach((e=>{var t=e.keyData,i=(0,f.arrayBufferToHex)(e.keyId);t?r.push(i):a.push(i)})),(0,_.getStorage)().lock(["missing-keys"],function(){var e=(0,n.default)((function*(){if(r.length>0&&(yield l.default.bulkRemoveMissingKeys(r),yield C()),a.length>0){var e=(yield l.default.bulkGetMissingKeys(a)).filter(Boolean),i=t.getDeviceId();e.forEach((e=>e.deviceResponses.set(i,!1))),yield l.default.createOrUpdateMissingKeys(e),yield w()}}));return function(){return e.apply(this,arguments)}}())},t.handleMissingKeysInSnapshot=function(){return E.apply(this,arguments)},t.handleMissingKeysInPatches=function(){return y.apply(this,arguments)};var i,n=a(r(52954)),s=a(r(10937)),o=r(95334),l=a(r(93371)),d=a(r(84161)),u=r(19516),c=a(r(54559)),p=r(43179),h=r(67378),f=(r(17845),r(44891)),_=r(92166),m=r(83961),g=new ArrayBuffer(0);function v(){return(v=(0,n.default)((function*(){var e=(yield(0,h.getPeerDevices)()).map((e=>e.getDeviceId()));return(0,_.getStorage)().lock(["missing-keys"],function(){var t=(0,n.default)((function*(){var t=yield l.default.getAllMissingKeys();if(0===t.length)return Promise.resolve();t.forEach((t=>{t.deviceResponses.forEach(((r,a)=>{e.includes(a)||t.deviceResponses.delete(a)}))})),yield l.default.createOrUpdateMissingKeys(t),yield w()}));return function(){return t.apply(this,arguments)}}())}))).apply(this,arguments)}function E(){return(E=(0,n.default)((function*(e,t){var r=new Set,a=(yield l.default.getAllSyncKeys()).map((e=>(0,f.arrayBufferToHex)(e.keyId.buffer)));t.records.forEach((e=>{var t=e.keyId.id;if((0,f.arrayBuffersAreEqual)(t,g))throw new m.SyncdFatalError("snapshot has empty key");var i=(0,f.arrayBufferToHex)(t);a.includes(i)||r.add(i)})),__LOG__(2)`syncd: collection ${e}'s snapshot has missing keys ${[...r]}`,yield S(r)}))).apply(this,arguments)}function y(){return(y=(0,n.default)((function*(e,t){var r=new Set,a=(yield l.default.getAllSyncKeys()).map((e=>(0,f.arrayBufferToHex)(e.keyId.buffer)));t.forEach((e=>{var t=e.keyId.id;if((0,f.arrayBuffersAreEqual)(t,g))throw new m.SyncdFatalError("patches has empty key");var i=(0,f.arrayBufferToHex)(t);a.includes(i)||r.add(i)})),__LOG__(2)`syncd: collection ${e}'s patches has missing keys ${[...r]}`,yield S(r)}))).apply(this,arguments)}function S(){return T.apply(this,arguments)}function T(){return(T=(0,n.default)((function*(e){var t=[...e],r=yield l.default.bulkGetMissingKeys(t),a=t.filter((e=>!r.includes(e)));if(0===a.length)return Promise.resolve();var i=yield(0,h.getPeerDevices)(),n=a.map((e=>(0,f.hexToUint8Array)(e).buffer));yield(0,u.sendAppStateSyncKeyRequest)(n,i),yield A(n,i.map((e=>e.getDeviceId())))}))).apply(this,arguments)}function A(){return b.apply(this,arguments)}function b(){return(b=(0,n.default)((function*(e,t){var r=e.map((e=>{return{keyHex:(0,f.arrayBufferToHex)(e),keyId:e,timestamp:(0,o.unixTimeMs)(),deviceResponses:(r=new Map,t.forEach((e=>r.set(e,null))),r)};var r}));yield l.default.createOrUpdateMissingKeys(r),yield C()}))).apply(this,arguments)}function C(){return P.apply(this,arguments)}function P(){return(P=(0,n.default)((function*(){clearTimeout(i),i=null;var e=yield l.default.getAllMissingKeys();if(0!==e.length){var t=(0,s.default)(e,(e=>e.timestamp)).timestamp,r=c.default.syncdWaitForKeyTimeoutDays*o.DAY_MILLISECONDS-(-t+(0,o.unixTimeMs)());i=setTimeout(O,r)}}))).apply(this,arguments)}function O(){new d.default.MdFatalError({mdFatalErrorCode:d.default.MD_SYNCD_FATAL_ERROR_CODE.TIMEOUT_WHILE_WAITING_FOR_MISSING_KEY}).commit(),__LOG__(4,void 0,new Error,!0)`syncd fatal error: timeout while waiting for missing key`,SEND_LOGS("syncd fatal error: timeout while waiting for missing key"),(0,p.handleFatalError)()}function w(){return M.apply(this,arguments)}function M(){return(M=(0,n.default)((function*(){var e=yield l.default.getAllMissingKeys();for(var t of e){var r=!0;for(var a of t.deviceResponses.values())if(null==a){r=!1;break}if(r)return new d.default.MdFatalError({mdFatalErrorCode:d.default.MD_SYNCD_FATAL_ERROR_CODE.MISSING_KEY_ON_ALL_CLIENTS}).commit(),__LOG__(4,void 0,new Error,!0)`syncd fatal error: missing key on all clients`,SEND_LOGS("syncd fatal error: missing key on all clients"),void(0,p.handleFatalError)()}}))).apply(this,arguments)}},20213:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.getActiveKey=g,t.getNewestKeyPair=E,t.getKeyData=function(){return S.apply(this,arguments)},t.clearSyncKeysCache=function(){m=new Map};var i=a(r(52954)),n=a(r(10937)),s=a(r(90882)),o=a(r(71644)),l=a(r(93371)),d=r(9641),u=r(82694),c=r(10828),p=r(67378),h=a(r(84161)),f=r(84337),_=r(44891),m=new Map;function g(){return v.apply(this,arguments)}function v(){return(v=(0,i.default)((function*(e=!0){var t=yield E(),r=yield(0,d.getMyDeviceList)(),{currentIndex:a,devices:i,rawId:n}=r;if(null==a)throw new Error("syncd: missing current index for own device");r={currentIndex:a,deviceIndexes:i.map((e=>e.keyIndex)),rawId:n};var s=(0,u.hasKeyExpired)(t),o=(0,u.hasADeviceBeenRemoved)(t,r);return e&&(s||o)?(t=(0,u.rotateKey)(t,r),__LOG__(2)`syncd: stored key rotation key id ${(0,_.arrayBufferToHex)(t.keyId.buffer)}`,yield l.default.createSyncKey(t),yield(0,c.sendAppStateSyncKeyShare)({type:"key_rotation",keys:[t]}),s&&(__LOG__(2)`syncd key rotation due to key expiry`,new h.default.MdAppStateKeyRotation({mdAppStateKeyRotationReason:h.default.MD_APP_STATE_KEY_ROTATION_REASON_CODE.APP_STATE_SYNC_KEY_EXPIRY}).commit()),o&&(__LOG__(2)`syncd key rotation due to device removal`,new h.default.MdAppStateKeyRotation({mdAppStateKeyRotationReason:h.default.MD_APP_STATE_KEY_ROTATION_REASON_CODE.DEVICE_DEREGISTERATION}).commit()),g(e)):{keyId:t.keyId.buffer,keyData:t.keyData}}))).apply(this,arguments)}function E(){return y.apply(this,arguments)}function y(){return(y=(0,i.default)((function*(){var e=yield l.default.getAllSyncKeys(),t=(0,o.default)(e.map((e=>(0,p.getKeyEpoch)(e.keyId.buffer)))),r=(0,s.default)(e,(e=>(0,p.getKeyEpoch)(e.keyId.buffer)===t));return(0,n.default)(r,(e=>(0,p.getKeyDeviceId)(e.keyId.buffer)))}))).apply(this,arguments)}function S(){return(S=(0,i.default)((function*(e){var t,r=m.get((0,f.encodeB64)(e));return r?r.keyData:((r=yield l.default.getSyncKeyData(new Uint8Array(e)))&&m.set((0,f.encodeB64)(e),r),null===(t=r)||void 0===t?void 0:t.keyData)}))).apply(this,arguments)}},82694:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.hasKeyExpired=function(e){var t=e.timestamp,r=Math.min(90,Math.max(1,d.default.syncdKeyMaxUseDays));return(0,n.unixTimeMs)()-t>r*n.DAY_MILLISECONDS},t.hasADeviceBeenRemoved=function(e,t){for(var r=e.fingerprint,{rawId:a,currentIndex:n,deviceIndexes:s}=t,o=new Set(r.deviceIndexes),l=r.currentIndex+1;l<=n;l++)o.add(l);return r.rawId!==a||!(0,i.default)(o,new Set(s))},t.rotateKey=function(e,t){var{keyId:r,keyEpoch:a}=function(e){var t=(0,u.getKeyEpoch)(e.keyId.buffer)+1,r=(0,l.assertGetMe)().getDeviceId();return{keyId:new Uint8Array((0,o.default)((0,s.intToBytes)(2,r).buffer,(0,s.intToBytes)(4,t).buffer)),keyEpoch:t}}(e),i=self.crypto.getRandomValues(new Uint8Array(32)).buffer,d=function(e){var{currentIndex:t,deviceIndexes:r,rawId:a}=e;return{rawId:a,currentIndex:t,deviceIndexes:r}}(t),c=(0,n.unixTimeMs)();return{keyId:r,keyEpoch:a,keyData:i,fingerprint:d,timestamp:c}};var i=a(r(18149)),n=r(95334),s=r(41026),o=a(r(36310)),l=r(66239),d=a(r(54559)),u=r(67378)},19516:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.sendAppStateSyncKeyRequest=function(){return p.apply(this,arguments)};var i=a(r(52954)),n=r(68551),s=r(66239),o=r(245),l=a(r(36169)),d=a(r(83746)),u=a(r(2661)),c=r(44891);function p(){return(p=(0,i.default)((function*(e,t){var r={keyIds:e.map((e=>({keyId:e})))},a=t.map((e=>{var t=new d.default({fromMe:!0,remote:(0,s.assertGetMe)(),id:(0,u.default)()});return new l.default({id:t,to:e,type:"protocol",subtype:"app_state_sync_key_request",appStateSyncKeyRequest:r})})),i=t.map((e=>e.getDeviceId())),p=e.map((e=>(0,c.arrayBufferToHex)(e)));__LOG__(2)`syncd: send key request key id ${p} to peer deviceIds ${i}`,yield(0,o.storeMessages)(a),yield Promise.all(a.map(n.encryptAndSendKeyMsg))}))).apply(this,arguments)}},10828:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.sendAppStateSyncKeyShare=function(){return h.apply(this,arguments)};var i=a(r(52954)),n=r(68551),s=r(66239),o=r(245),l=a(r(36169)),d=a(r(83746)),u=a(r(2661)),c=r(67378),p=r(44891);function h(){return(h=(0,i.default)((function*(e){var t,r;if("key_rotation"===e.type?(t=f(e.keys),r=yield(0,c.getPeerDevices)()):"missing_key"===e.type&&(t=f(e.keys,e.orphanKeys),r=[e.peerDeviceId]),null==r)return Promise.resolve();var a=r,i=a.map((e=>{var r=new d.default({fromMe:!0,remote:(0,s.assertGetMe)(),id:(0,u.default)()});return new l.default({id:r,to:e,type:"protocol",subtype:"app_state_sync_key_share",appStateSyncKeyShare:t})})),h=a.map((e=>e.getDeviceId())),_=e.keys.map((e=>(0,p.arrayBufferToHex)(e.keyId.buffer)));__LOG__(2)`syncd: send key share key id ${_} to peer deviceIds ${h}`,yield(0,o.storeMessages)(i),yield Promise.all(i.map(n.encryptAndSendKeyMsg))}))).apply(this,arguments)}function f(e,t){var r=e.map((e=>({keyId:{keyId:e.keyId.buffer},keyData:{keyData:e.keyData,fingerprint:{rawId:e.fingerprint.rawId,currentIndex:e.fingerprint.currentIndex,deviceIndexes:e.fingerprint.deviceIndexes},timestamp:e.timestamp}})));if(t){var a=t.map((e=>({keyId:{keyId:e},keyData:void 0})));r=r.concat(a)}return{keys:r}}},67378:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.getKeyDeviceId=function(e){return new DataView(e).getUint16(0)},t.getKeyEpoch=function(e){return new DataView(e).getUint32(2)},t.getPeerDevices=function(){return l.apply(this,arguments)};var i=a(r(52954)),n=r(9641),s=r(66239),o=r(25054);function l(){return(l=(0,i.default)((function*(){var e=[],t=(0,s.assertGetMe)().getDeviceId(),r=yield(0,n.getMyDeviceList)();return r.devices.forEach((a=>{a.id!==t&&e.push((0,o.createDeviceWidFromUserAndDevice)(r.id,a.id))})),e}))).apply(this,arguments)}},94117:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.buildSyncIqNode=function(){return b.apply(this,arguments)},t._generateMutationsToUpload=U;var i=a(r(52954)),n=a(r(829)),s=r(53470),o=r(84337),l=r(9807),d=a(r(20116)),u=a(r(93371)),c=r(49602),p=r(49184),h=r(65634),f=r(35773),_=r(20213),m=r(44891),g=r(3845),v=r(67378),E=a(r(54559)),y=a(r(32856)),S=r(17845),T=r(66239),A=a(r(77613));function b(){return(b=(0,i.default)((function*(e){var{collectionNodes:t,collectionWithEncryptedMutations:r,localCollectionVersions:a}=yield C(e);return{syncIqNode:(0,f.wap)("iq",{to:f.S_WHATSAPP_NET,xmlns:"w:sync:app:state",type:"set",id:(0,f.generateId)()},(0,f.wap)("sync",null,t)),collectionWithEncryptedMutations:r,localCollectionVersions:a}}))).apply(this,arguments)}function C(){return P.apply(this,arguments)}function P(){return(P=(0,i.default)((function*(e){var t=function(){var e=(0,i.default)((function*(e,t){var r,a,i=yield u.default.getCollectionVersion(e);if(null!=t&&t.length>0){var{patchNode:n,encryptedMutations:s}=yield O(e,t);r=n,a=s}return{collection:e,version:i,patchNode:r,encryptedMutations:a}}));return function(){return e.apply(this,arguments)}}(),r=new Map,a=new Map,n=[];return e.forEach(((e,r)=>n.push(t(r,e)))),{collectionNodes:(yield Promise.all(n)).map((e=>{var{collection:t,version:i,patchNode:n,encryptedMutations:s}=e;return s&&a.set(t,s),r.set(t,i),(0,f.wap)("collection",{name:(0,f.CUSTOM_STRING)(t),version:(0,f.INT)(null!=i?i:S.DEFAULT_COLLECTION_VERSION),return_snapshot:0===(null!=i?i:S.DEFAULT_COLLECTION_VERSION)?"true":"false"},n)})),collectionWithEncryptedMutations:a,localCollectionVersions:r}}))).apply(this,arguments)}function O(){return w.apply(this,arguments)}function w(){return(w=(0,i.default)((function*(e,t){var r,a=yield(0,_.getActiveKey)(!M(t)),n=(yield U(e,t,a)).map((e=>(0,c.encryptMutation)(e,a))),s=yield Promise.all(n),o=s.map((e=>({indexMac:e.indexMac,valueMac:e.valueMac,operation:e.operation}))),d=yield(0,l.computeLtHash)(e,o),{snapshotMac:u,patchMac:h}=yield(0,l.computeOutgoingSnapshotAndPatchMacs)(e,d,s,a.keyData),m=s.map((e=>k(e.keyId,e.operation,e.indexMac,e.indexAndValueCipherText))),g=L(m),v=function(){var e=(0,i.default)((function*(){var e=yield(0,p.uploadExternalPatch)(g);return D(yield I(e,g),a.keyId,u,h)}));return function(){return e.apply(this,arguments)}}();return(0,p.exceedInlineMutationCount)(m)?r=yield v():(r=N(m,a.keyId,u,h),(0,p.exceedPatchProtobufSize)(r)&&(r=yield v())),{patchNode:(0,f.wap)("patch",null,r),encryptedMutations:s}}))).apply(this,arguments)}function M(e){return A.default.isLogoutInProgress&&e.some((e=>JSON.parse(e.index)[0]===S.Actions.Sentinel))}function I(){return R.apply(this,arguments)}function R(){return(R=(0,i.default)((function*(e,t){var{mediaKey:r,directPath:a,encFilehash:i,handle:n}=e;if(!n)throw new Error("Missing handle after uploading external patch to mms4");var s=yield(0,d.default)(t);return{mediaKey:(0,o.decodeB64)(r),directPath:a,handle:n,fileSizeBytes:t.byteLength,fileSha256:(0,o.decodeB64)(s),fileEncSha256:(0,o.decodeB64)(i)}}))).apply(this,arguments)}function D(e,t,r,a){var i=E.default.syncdPatchDeviceIndexIncluded?(0,T.assertGetMe)().getDeviceId():void 0;return(0,s.encodeSyncdPatch)({keyId:{id:t},externalMutations:e,snapshotMac:r,patchMac:a,deviceIndex:i})}function N(e,t,r,a){var i=E.default.syncdPatchDeviceIndexIncluded?(0,T.assertGetMe)().getDeviceId():void 0;return(0,s.encodeSyncdPatch)({keyId:{id:t},mutations:e,snapshotMac:r,patchMac:a,deviceIndex:i})}function L(e){return(0,s.encodeSyncdMutations)({mutations:e})}function k(e,t,r,a){return{operation:t,record:{keyId:{id:e},index:{blob:r},value:{blob:a}}}}function U(){return G.apply(this,arguments)}function G(){return(G=(0,i.default)((function*(e,t,r){var a=yield u.default.getSyncActionsRows(["collection"],[e]),i=t,n=F(e,a,t,r.keyId),s=x(a,i=i.concat(n),r.keyId);return y.default.addKeyRotationRemoveCount(s.length),i=i.concat(s)}))).apply(this,arguments)}function F(e,t,r,a){var i=t.filter((e=>!r.map((e=>e.index)).includes(e.index)&&!(0,m.arrayBuffersAreEqual)(e.keyId,a)));i=(0,n.default)(i,(e=>(0,v.getKeyEpoch)(e.keyId)));var s=Math.min(5,Math.max(1,E.default.syncdAdditionalMutations));return i=i.slice(0,s),(0,g.syncActionsToPendingMutations)(i,h.SyncdMutationSyncdOperation.SET)}function x(e,t,r){var a=t.map((e=>e.index)),i=e.filter((e=>a.includes(e.index))).filter((e=>!(0,m.arrayBuffersAreEqual)(e.keyId,r)));return(0,g.syncActionsToPendingMutations)(i,h.SyncdMutationSyncdOperation.REMOVE)}},53470:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.encodeSyncdPatch=function(e){try{return(0,i.encodeProto)(o.SyncdPatchSpec,e).readBuffer()}catch(e){throw new s.default.MdFatalError({mdFatalErrorCode:s.default.MD_SYNCD_FATAL_ERROR_CODE.PATCH_PROTOBUF_SERIALIZATION_FAILED}).commit(),new n.SyncdFatalError("patch protobuf serialization failed")}},t.encodeSyncdMutations=function(e){try{return(0,i.encodeProto)(o.SyncdMutationsSpec,e).readBuffer()}catch(e){throw new s.default.MdFatalError({mdFatalErrorCode:s.default.MD_SYNCD_FATAL_ERROR_CODE.MUTATIONS_PROTOBUF_SERIALIZATION_FAILED}).commit(),new n.SyncdFatalError("mutations protobuf serialization failed")}},t.encodeSyncActionData=function(e){try{return(0,i.encodeProto)(l.SyncActionDataSpec,e).readBuffer()}catch(e){throw new s.default.MdFatalError({mdFatalErrorCode:s.default.MD_SYNCD_FATAL_ERROR_CODE.ACTION_DATA_PROTOBUF_SERIALIZATION_FAILED}).commit(),new n.SyncdFatalError("action data protobuf serialization failed")}};var i=r(76549),n=r(83961),s=a(r(84161)),o=r(65634),l=r(60608)},49602:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.encryptMutation=function(){return v.apply(this,arguments)};var i=a(r(70417)),n=a(r(52954)),s=r(53470),o=r(9557),l=r(41431),d=r(67),u=a(r(93371)),c=r(83961),p=a(r(84161)),h=r(65634),f=r(60608),_=r(44891),m=r(97715),g=r(20213);function v(){return(v=(0,n.default)((function*(e,t){var{index:r,operation:a}=e,n=t.keyId,s=t.keyData;switch(a){case h.SyncdMutationSyncdOperation.SET:break;case h.SyncdMutationSyncdOperation.REMOVE:var o=yield u.default.getSyncAction(r);if(!o)throw new c.SyncdFatalError("no corresponding set mutation");var l=o.keyId;n=l,s=yield(0,g.getKeyData)(l)}var{indexMac:p,indexAndValueCipherText:f}=yield E(e,n,s),_=(0,d.valueMacFromIndexAndValueCipherText)(f);return(0,i.default)((0,i.default)({},e),{},{keyId:n,keyData:s,indexMac:p,indexAndValueCipherText:f,valueMac:_})}))).apply(this,arguments)}function E(){return y.apply(this,arguments)}function y(){return(y=(0,n.default)((function*(e,t,r){try{var{index:a,binarySyncAction:i,operation:n,version:s}=e,o=(0,m.stringToArrayBuffer)(a),u=yield(0,d.generateEncryptionKeys)(r),{indexKey:h,valueEncryptionKey:f,valueMacKey:g}=u,v=yield self.crypto.getRandomValues(new Uint8Array(l.IV_LENGTH)),E=S(o,i,(0,d.generatePadding)(o.byteLength,i.byteLength),s),y=yield(0,d.generateCipherText)(v,f,E),T=(0,_.combine)([v.buffer,y]),A=(0,d.generateAssociatedData)(n,t),b=yield(0,d.generateMac)(A,T,g),C=(0,_.combine)([T,b]);return{indexMac:yield(0,d.generateIndexMac)(h,o),indexAndValueCipherText:C}}catch(e){throw new p.default.MdFatalError({mdFatalErrorCode:p.default.MD_SYNCD_FATAL_ERROR_CODE.ENCRYPTION_FAILED}).commit(),new c.SyncdFatalError("encryption failure")}}))).apply(this,arguments)}function S(e,t,r,a){return(0,s.encodeSyncActionData)({index:e,value:(0,o.decodeProto)(f.SyncActionValueSpec,t),padding:r,version:a})}},68545:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return l.apply(this,arguments)};var i=a(r(52954)),n=r(94117),s=a(r(93371)),o=r(98105);function l(){return(l=(0,i.default)((function*(e){var t=new Map,r=new Map;yield Promise.all(e.map(function(){var e=(0,i.default)((function*(e){var a=yield s.default.getPendingMutationsRows(["collection"],e),i=a.map((e=>e.id)).filter(Boolean);r.set(e,i);var n=(0,o.compactPatch)(a);t.set(e,n)}));return function(){return e.apply(this,arguments)}}()));var a=yield(0,n.buildSyncIqNode)(t);return{syncIqNode:a.syncIqNode,collectionWithPendingMutationsIds:r,collectionWithEncryptedMutations:a.collectionWithEncryptedMutations,localCollectionVersions:a.localCollectionVersions}}))).apply(this,arguments)}},49184:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.exceedInlineMutationCount=function(e){var t=Math.min(2e3,Math.max(s.default.syncdInlineMutationsMaxCount,100));return e.length>t},t.exceedPatchProtobufSize=function(e){var t=1e3*Math.min(100,Math.max(s.default.syncdPatchProtobufMaxSize,10));return e.byteLength>t},t.uploadExternalPatch=function(e){return o.default.encryptAndUpload({blob:e,signal:(new i.default).signal,type:"md-app-state",uploadOrigin:n.default.UPLOAD_ORIGIN_TYPE.UNKNOWN,userUploadAttemptCount:0,forwardedFromWeb:!1})};var i=a(r(45026)),n=a(r(84161)),s=a(r(54559)),o=a(r(7495))},3845:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.syncActionsToPendingMutations=function(e,t){return e.map((e=>({collection:e.collection,index:e.index,binarySyncAction:e.binarySyncAction,operation:t,version:e.version,timestamp:e.timestamp})))}},98105:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.compactPatch=function(e){return(0,i.default)(e.reverse(),(e=>e.index)).reverse()};var i=a(r(84636))},66421:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.syncResponseParser=void 0;var i=r(50350),n=r(17845),s=a(r(84161)),o=a(r(45521)),l=r(83961),d=new o.default("syncResponseParser",(e=>{__LOG__(2)`syncd: start parsing syncd collections`;var t=[];return e.child("sync").mapChildrenWithTag("collection",(e=>{var r={},a=n.CollectionName.cast(e.attrString("name"));if(!a)throw new l.SyncdFatalError("invalid collection name");r.name=a,r.state=function(e,t){if(!e.hasAttr("type")||"error"!==e.attrString("type"))return e.hasAttr("has_more_patches")?n.CollectionState.SuccessHasMore:n.CollectionState.Success;var r=e.child("error"),a=r.attrString("code"),i=r.attrString("text");switch(a){case"409":return n.CollectionState.Conflict;case"400":return new s.default.MdFatalError({mdFatalErrorCode:s.default.MD_SYNCD_FATAL_ERROR_CODE.XMPP_BAD_REQUEST_FOR_COLLECTION}).commit(),__LOG__(4,void 0,new Error,!0)`syncd fatal error: collection ${String(t)} throws ${i}`,SEND_LOGS(`syncd fatal error: collection ${String(t)} throws ${i}`),n.CollectionState.ErrorFatal;case"404":return new s.default.MdFatalError({mdFatalErrorCode:s.default.MD_SYNCD_FATAL_ERROR_CODE.XMPP_NOT_FOUND_FOR_COLLECTION}).commit(),__LOG__(4,void 0,new Error,!0)`syncd fatal error: collection ${String(t)} throws ${i}`,SEND_LOGS(`syncd fatal error: collection ${String(t)} throws ${i}`),n.CollectionState.ErrorFatal;default:return __LOG__(3)`syncd retryable error: collection ${String(t)} throws ${i}`,n.CollectionState.ErrorRetry}}(e,r.name),e.hasAttr("version")&&(r.version=parseInt(e.attrString("version"),10)),e.hasChild("patches")&&(r.patches=e.child("patches").mapChildrenWithTag("patch",(e=>(0,i.decodeSyncdPatch)(e.contentBytes())))),e.hasChild("snapshot")&&(r.snapshot=(0,i.decodeExternalBlobReference)(e.child("snapshot").contentBytes())),t.push(r),__LOG__(2)`syncd: successfully parsed collection ${a}`})),t}));t.syncResponseParser=d},96939:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.serverSync=h;var i=a(r(52954)),n=a(r(49431)),s=r(7017),o=r(17845),l=r(83961),d=a(r(84161)),u=a(r(68545)),c=r(66421),p=a(r(32856));function h(){return f.apply(this,arguments)}function f(){return(f=(0,i.default)((function*(e){if(0===e.length)return Promise.resolve([]);try{var{collectionDetails:t,localCollectionVersions:r}=yield _(e),a=[],i=[];t.forEach((e=>{switch(e.state){case o.CollectionState.ErrorRetry:case o.CollectionState.ErrorFatal:case o.CollectionState.Blocked:return void i.push(e);default:a.push(e)}e.state===o.CollectionState.Conflict&&p.default.incConflict()}));var s=yield Promise.all(a.map((e=>(0,n.default)(e,r.get(e.name))))),d=[];return s.forEach((e=>{switch(e.state){case o.CollectionState.SuccessHasMore:case o.CollectionState.Conflict:return void d.push(e.name);default:i.push(e)}})),i.concat(yield h(d))}catch(t){return t instanceof l.SyncdFatalError?(__LOG__(4,void 0,new Error,!0)`syncd fatal error: syncd global throws ${t.message}`,SEND_LOGS(`syncd fatal error: syncd global throws ${t.message}`),e.map((e=>({state:o.CollectionState.ErrorFatal,name:e})))):(__LOG__(3,void 0,void 0,!0)`syncd retryable error: syncd global throws ${t.message}`,SEND_LOGS(`syncd retryable error: syncd global throws ${t.message}`),e.map((e=>({state:o.CollectionState.ErrorRetry,name:e,serverBackoff:t.errorBackoff}))))}}))).apply(this,arguments)}function _(){return m.apply(this,arguments)}function m(){return(m=(0,i.default)((function*(e){var{syncIqNode:t,collectionWithPendingMutationsIds:r,collectionWithEncryptedMutations:a,localCollectionVersions:i}=yield(0,u.default)(e),n=yield(0,s.sendIq)(t,c.syncResponseParser);if(n.success){var o=n.result;return o.forEach((e=>{var t=r.get(e.name);t&&(e.syncedPendingMutationsId=t);var i=a.get(e.name);i&&(e.syncedEncryptedMutations=i)})),{collectionDetails:o,localCollectionVersions:i}}var{errorCode:l,errorText:d,errorBackoff:p}=n;throw g(l,d,p)}))).apply(this,arguments)}function g(e,t,r){switch(e){case 400:return new d.default.MdFatalError({mdFatalErrorCode:d.default.MD_SYNCD_FATAL_ERROR_CODE.XMPP_BAD_REQUEST_GLOBAL_ERROR}).commit(),new l.SyncdFatalError(t);case 404:return new d.default.MdFatalError({mdFatalErrorCode:d.default.MD_SYNCD_FATAL_ERROR_CODE.XMPP_NOT_FOUND_GLOBAL_ERROR}).commit(),new l.SyncdFatalError(t);case 405:return new d.default.MdFatalError({mdFatalErrorCode:d.default.MD_SYNCD_FATAL_ERROR_CODE.XMPP_BAD_METHOD_GLOBAL_ERROR}).commit(),new l.SyncdFatalError(t);case 406:return new d.default.MdFatalError({mdFatalErrorCode:d.default.MD_SYNCD_FATAL_ERROR_CODE.XMPP_NOT_ACCEPTABLE_GLOBAL_ERROR}).commit(),new l.SyncdFatalError(t);default:return new l.SyncdRetryableError(t,r)}}},83961:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SyncdFatalError=t.SyncdRetryableError=t.SyncdMissingKeyError=void 0;class r extends Error{constructor(...e){super(...e),this.name="SyncdMissingKeyError"}}t.SyncdMissingKeyError=r;class a extends Error{constructor(e,t){super(e),this.name="SyncdRetryableError",this.backoff=t,this.message=e}}t.SyncdRetryableError=a;class i extends Error{constructor(e){super(e),this.name="SyncdFatalError",this.message=e}}t.SyncdFatalError=i},43179:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.updateSyncdDisabledDueToFatalFlag=E,t.isSyncdDisabled=function(){return"true"===(0,_.default)(c.default,"localStorage").getItem(o.default.KEY_SYNCD_DISABLED_DUE_TO_FATAL)},t.handleFatalError=function(e){var t=(0,d.getABPropConfigValue)("should_deregister_on_syncd_fatal"),a=r(78483).default,i=[];null!=e&&(i=e.map((e=>String(e))));(function(){y.apply(this,arguments)})(i),!1!==t?(__LOG__(4,!0,new Error)`[syncd] Received fatal error and logged out`,m.default.logout()):a.isSyncDCriticalDataSyncInProcess()?(__LOG__(4,!0,new Error,!0)`critical sync failed during bootstrap`,SEND_LOGS("critical sync failed during bootstrap"),m.default.logout()):(__LOG__(4,!0,new Error)`[syncd] Received fatal error and showed fatal flag`,E(!0),s.default.handleFatalError())};var i=a(r(52954)),n=r(25054),s=(r(17845),a(r(13277))),o=a(r(23045)),l=r(68551),d=r(71796),u=r(66239),c=a(r(48879)),p=a(r(36169)),h=a(r(83746)),f=a(r(2661)),_=a(r(21830)),m=a(r(15934)),g=r(245),v=r(95334);function E(e){(0,_.default)(c.default,"localStorage").setItem(o.default.KEY_SYNCD_DISABLED_DUE_TO_FATAL,e.toString())}function y(){return(y=(0,i.default)((function*(e){var t={collectionNames:e,timestamp:(0,v.unixTimeMs)()},r=new h.default({fromMe:!0,remote:(0,u.getMeUser)(),id:(0,f.default)()}),a=new p.default({id:r,to:(0,n.createDeviceWidFromUserAndDevice)((0,u.assertGetMe)().user,0),type:"protocol",subtype:"app_state_fatal_exception_notification",appStateFatalExceptionNotification:t});return yield(0,g.storeMessages)([a]),(0,l.encryptAndSendKeyMsg)(a)}))).apply(this,arguments)}},9365:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.checkOrphanMutations=function(){return d.apply(this,arguments)},t.checkOrphanMessages=u,t.checkOrphanChats=p,t.applyAllOrphansAndUnsupported=function(){return m.apply(this,arguments)};var i=a(r(52954)),n=r(49431),s=r(43179),o=r(17845),l=a(r(93371));function d(){return(d=(0,i.default)((function*(e,t){if((0,s.isSyncdDisabled)())return Promise.resolve();yield Promise.all([u(e),p(t)])}))).apply(this,arguments)}function u(){return c.apply(this,arguments)}function c(){return(c=(0,i.default)((function*(e){yield f(e,o.SyncModelType.Msg)}))).apply(this,arguments)}function p(){return h.apply(this,arguments)}function h(){return(h=(0,i.default)((function*(e){yield f(e,o.SyncModelType.Chat)}))).apply(this,arguments)}function f(){return _.apply(this,arguments)}function _(){return(_=(0,i.default)((function*(e,t){if((0,s.isSyncdDisabled)())return Promise.resolve();var r=yield l.default.getSyncActionsRows(["modelId","modelType","actionState"],e.map((e=>[e,t,o.SyncActionState.Orphan])));yield(0,n.applyIndividualMutations)(r)}))).apply(this,arguments)}function m(){return(m=(0,i.default)((function*(){if((0,s.isSyncdDisabled)())return Promise.resolve();var e=yield l.default.getSyncActionsRows(["actionState"],[o.SyncActionState.Orphan,o.SyncActionState.Unsupported]);yield(0,n.applyIndividualMutations)(e)}))).apply(this,arguments)}},84386:(e,t,r)=>{"use strict";var a=r(14859);t.Z=function(){return d.apply(this,arguments)};var i=a(r(52954)),n=a(r(23492)),s=r(58970),o=r(17845),l=a(r(93371));function d(){return(d=(0,i.default)((function*(){var e=yield n.default.getSentinelMutations();return yield l.default.appendPendingMutationsRows(e),(0,s.markCollectionsForSync)([...o.CollectionName.members()])}))).apply(this,arguments)}},58970:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.initialize=function(){if(o.default.supportsFeature(o.default.F.MD_BACKEND))return(0,g.isSyncdDisabled)()?Promise.resolve():(e=6e4,t=(0,s.default)((0,n.default)((function*(){var e=yield(0,E.getSyncActionsTable)().count();y.default.setStoredMutationCount(e);var t=yield(0,E.getSyncActionsTable)().equals(["actionState"],d.SyncActionState.Malformed);y.default.setInvalidActionCount(t.length);var r=yield(0,E.getSyncActionsTable)().equals(["actionState"],d.SyncActionState.Unsupported);y.default.setUnsupportedActionCount(r.length);var a=yield u.default.getMissingKeyCount();y.default.setMissingKeyCount(a)})),e,{maxWait:3*e}),v.default.on(v.APP_STATE_SYNC_COMPLETED,t),l.default.loadStatesFromDb().then((()=>k())));var e,t;return Promise.reject(new Error("This call is only supported in MD mode"))},t.markCollectionsForSync=R,t.syncBlockedCollections=function(){var e=l.default.getCollectionsInStateBlocked();return l.default.moveCollectionsToDirty(e),C=new Set([...C,...b]),D()},t.lockForSync=function(e,t,r){var a=(0,h.getStorage)().lock([...e,...S],(e=>Promise.all([u.default.appendPendingMutationsRows(t),r(e)]))).then((()=>{R(t.map((e=>e.collection)))}));return Promise.resolve(a)},t.SYNCD_INTERNAL_TABLES_TO_LOCK=void 0;var n=i(r(52954)),s=i(r(54073)),o=i(r(20468)),l=i(r(25891)),d=r(17845),u=i(r(93371)),c=i(r(84161)),p=r(96939),h=r(92166),f=i(r(57568)),_=r(53353),m=r(9365),g=r(43179),v=a(r(13277)),E=r(38027),y=i(r(32856)),S=["pending-mutations"];t.SYNCD_INTERNAL_TABLES_TO_LOCK=S;var T,A=36e5,b=new Set,C=new Set,P=!1,O=0,w=0;if((0,_.isConnectedToPage)()){var M=r(96377).default,I=r(96377).StreamMode;(0,f.default)(M,"change:mode",(()=>M.mode===I.MAIN)).then((()=>{o.default.supportsFeature(o.default.F.MD_BACKEND)&&!(0,g.isSyncdDisabled)()&&((0,m.applyAllOrphansAndUnsupported)(),function(){G.apply(this,arguments)}())}))}function R(e){return o.default.supportsFeature(o.default.F.MD_BACKEND)?(e.forEach((e=>{var t=l.default.getCollectionState(e);t===d.CollectionSyncState.UpToDate?l.default.moveCollectionsToDirty([e]):t===d.CollectionSyncState.Dirty&&(C=new Set([...C,e]))})),D()):Promise.reject(new Error("This call is only supported in MD mode"))}function D(){return N.apply(this,arguments)}function N(){return(N=(0,n.default)((function*(){if((0,g.isSyncdDisabled)())return Promise.resolve();var e=l.default.getCollectionsInStateDirty(),t=new Set(e.filter((e=>!b.has(e))));if(0===t.size)return Promise.resolve();var r=[];try{b=new Set([...b,...t]),__LOG__(2)`syncd: initiate server sync`,r=yield(0,p.serverSync)([...t]),__LOG__(2)`syncd: server sync successful`;var a=r.filter((e=>e.state===d.CollectionState.ErrorRetry));a.length>0&&(w=a[0].serverBackoff||0,O=0),U(r)}catch(e){l.default.moveCollectionsToFiniteRetry([...t])}finally{l.default.persistToDb(),b=new Set([...b].filter((e=>!t.has(e)))),k(),v.default.trigger(v.APP_STATE_SYNC_COMPLETED,r)}}))).apply(this,arguments)}function L(){if(!(0,g.isSyncdDisabled)()){var e,t,r,a=new Set(l.default.getCollectionsInStateRetry());if(0!==a.size)T=setTimeout((0,n.default)((function*(){try{P=!0,O+=1,__LOG__(2)`syncd: initiate server sync retry`;var e=yield(0,p.serverSync)([...a]);__LOG__(2)`syncd: server sync retry successful`,U(e)}catch(e){l.default.moveCollectionsToFiniteRetry([...a])}finally{(t=l.default.getExpiredCollections()).length>0&&(l.default.moveCollectionsToFatal(t),__LOG__(4,void 0,new Error,!0)`syncd fatal error: expired collections`,SEND_LOGS("syncd fatal error: expired collections"),new c.default.MdFatalError({mdFatalErrorCode:c.default.MD_SYNCD_FATAL_ERROR_CODE.TOO_MANY_INTERNAL_SERVER_ERRORS_IN_7D}).commit()),l.default.persistToDb(),P=!1,k()}var t})),(e=O,t=w,r=1e3*Math.pow(2,e),Math.min(Math.max(r,t),A)))}}function k(){if(l.default.getCollectionsInStateDirty().length>0&&(C=new Set([...C].filter((e=>b.has(e)))),D()),l.default.getCollectionsInStateRetry().length>0){if(P)return;null!=T&&clearTimeout(T),L()}l.default.getCollectionsInStateFatal().length>0&&(0,g.handleFatalError)(l.default.getCollectionsInStateFatal())}function U(e){return e.forEach((e=>e.state!==d.CollectionState.Success||C.has(e.name)?e.state===d.CollectionState.ErrorRetry?l.default.moveCollectionsToFiniteRetry([e.name]):e.state===d.CollectionState.ErrorFatal?l.default.moveCollectionsToFatal([e.name]):e.state!==d.CollectionState.Blocked||C.has(e.name)?void 0:l.default.moveCollectionsToBlocked([e.name]):l.default.moveCollectionsToUpToDate([e.name])))}function G(){return(G=(0,n.default)((function*(){var e=yield u.default.getAllPendingMutationsRows(),t=l.default.getCollectionsInStateBlocked();l.default.moveCollectionsToDirty(t);var r=e.map((e=>e.collection)).concat(t);r.length>0&&R(r)}))).apply(this,arguments)}},64571:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.constructStarMsgKey=function(e){return JSON.stringify([a.Actions.Star,...i(e)])},t.constructMsgKeySegments=i,t.extractParticipantForSync=n,t.constructPinChatKey=function(e){return JSON.stringify([a.Actions.Pin,e.id.remote.toString({legacy:!0})])},t.constructMuteChatKey=function(e){return JSON.stringify([a.Actions.Mute,e.id.remote.toString({legacy:!0})])},t.isBootstrap=function(e){return null==e};var a=r(17845);function i(e){var t=n(e);return[e.id.remote.toString({legacy:!0}),e.id.id,e.id.fromMe?"1":"0",t]}function n(e){var t="0";return!e.id.participant||e.id.remote.isUser()||e.id.fromMe||(t=e.id.participant.toString({legacy:!0})),t}},32856:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(35160),n=a(r(13277)),s=a(r(84161)),o=new s.default.MdAppStateSyncDaily,l=new i.ShiftTimer((function(){var e=function(e){var t=new s.default.MdAppStateSyncDaily;e.mutationCount>0&&(t.mutationCount=e.mutationCount);e.invalidActionCount>0&&(t.invalidActionCount=e.invalidActionCount);e.unsupportedActionCount>0&&(t.unsupportedActionCount=e.unsupportedActionCount);e.keyRotationRemoveCount>0&&(t.keyRotationRemoveCount=e.keyRotationRemoveCount);e.storedMutationCount>0&&(t.storedMutationCount=e.storedMutationCount);e.uploadConflictCount>0&&(t.uploadConflictCount=e.uploadConflictCount);e.unsetActionCount>0&&(t.unsetActionCount=e.unsetActionCount);e.missingKeyCount>0&&(t.missingKeyCount=e.missingKeyCount);return t}(o);d(),e.commit()}));function d(){o=new s.default.MdAppStateSyncDaily}function u(){l.onOrBefore(3e5)}n.default.on("logout",(()=>{l.isScheduled()&&l.forceRunNow()}));var c={clear:d,addMutationCount:function(e){0!==e&&(void 0===o.mutationCount&&(o.mutationCount=0),o.mutationCount+=e,u())},setInvalidActionCount:function(e){o.invalidActionCount=e,u()},setUnsupportedActionCount:function(e){o.unsupportedActionCount=e,u()},incConflict:function(){void 0===o.uploadConflictCount&&(o.uploadConflictCount=0),o.uploadConflictCount++,u()},addKeyRotationRemoveCount:function(e){0!==e&&(void 0===o.keyRotationRemoveCount&&(o.keyRotationRemoveCount=0),o.keyRotationRemoveCount+=e,u())},setStoredMutationCount:function(e){o.storedMutationCount=e,u()},addUnsetActionCount:function(e){0!==e&&(void 0===o.unsetActionCount&&(o.unsetActionCount=0),o.unsetActionCount+=e,u())},setMissingKeyCount:function(e){o.missingKeyCount=e,u()}};t.default=c},78141:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.registerTasks=function(){i.default.supportsFeature(i.default.F.MD_BACKEND)&&((0,c.startScheduler)({scheduledTimeResolver:{get:e=>(0,u.getTaskScheduledTime)(String(e)),set:(e,t)=>(0,u.updateTaskScheduledTime)(String(e),t)}}),_.forEach((e=>{var t=function(e){switch(e){case f.SYNC_AB_PROPS:return e=>(e?Promise.resolve():(0,s.syncABPropsTask)()).then((()=>(0,d.getRefresh)()));case f.SYNC_CONTACTS:return e=>(e?Promise.resolve():(0,o.getNonAddressBookContactsAndMarkAllContactsDirty)().catch((e=>{__LOG__(4,!0,new Error)`Failed to sync non-address book contacts with error: ${e}`})).then((()=>(0,n.contactSync)())).catch((e=>{__LOG__(4,!0,new Error,!0)`contact sync failed`,SEND_LOGS("contact sync failed: "+e)}))).then((()=>(0,l.getContactSyncRefreshSeconds)()));case f.ROTATE_KEY:return e=>{var t;return e?(__LOG__(2)`RotateKeyTask skip first run`,t=Promise.resolve()):t=(0,h.newJob)("rotateKey").waitUntilCompleted(),t.then((()=>27*p.DAY_SECONDS))}}}(e);(0,c.registerTask)(e,t)})))};var i=a(r(20468)),n=r(19958),s=r(14683),o=r(8745),l=r(24789),d=r(6807),u=r(53049),c=r(85947),p=r(95334),h=r(83696),f=r(28103)({SYNC_AB_PROPS:"syncAbProps",SYNC_CONTACTS:"syncContacts",ROTATE_KEY:"rotateKey"}),_=[f.SYNC_AB_PROPS,f.SYNC_CONTACTS,f.ROTATE_KEY]},23078:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DebugMessage=void 0;var a=r(28103).Mirrored([]);t.DebugMessage=a},79268:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.businessParser=function(e){e.assertTag("business");var t=e.maybeChild("error");if(t)return{errorCode:t.attrInt("code"),errorText:t.attrString("text")};var r=e.maybeChild("verified_name");return{verifiedName:r?(0,n.default)(r):null}},t.default=void 0;var i=r(35773),n=a(r(55371));t.default=class{getQueryElement(){return(0,i.wap)("business",null,(0,i.wap)("verified_name",null))}getUserElement(){return null}}},10001:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.contactParser=function(e){e.assertTag("contact");var t=e.maybeChild("error");if(t)return{errorCode:t.attrInt("code"),errorText:t.attrString("text")};return{type:e.attrString("type")}},t.default=void 0;var a=r(35773);t.default=class{getQueryElement(){return(0,a.wap)("contact",null)}getUserElement(e){var t=e.getPhone();return t?(0,a.wap)("contact",null,t):null}}},95027:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.deviceParser=function(e){e.assertTag("devices");var t=e.maybeChild("error");if(t)return{errorCode:t.attrInt("code"),errorText:t.attrString("text")};var r=e.maybeChild("key-index-list"),a=e.maybeChild("device-list"),i=null==r?null:{ts:r.attrTime("ts"),signedKeyIndexBytes:r.contentBytes()};return{deviceList:null==a?void 0:a.mapChildrenWithTag("device",(e=>({id:e.attrInt("id"),keyIndex:e.hasAttr("key-index")?e.attrInt("key-index"):null}))),keyIndex:i}},t.default=void 0;var a=r(35773);t.default=class{getQueryElement(){return(0,a.wap)("devices",{version:(0,a.CUSTOM_STRING)(String(2))})}getUserElement(e){var t=e.getDeviceHash();return t?(0,a.wap)("devices",{device_hash:(0,a.CUSTOM_STRING)(t)}):null}}},54893:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.featureParser=function(e){e.assertTag("feature");var t=e.maybeChild("error");if(t)return{errorCode:t.attrInt("code"),errorText:t.attrString("text")};var r={};return Object.keys(i).forEach((t=>{var a=e.maybeChild(t);a&&(r[t]=a.attrString("value"))})),r},t.default=void 0;var a=r(35773),i={document:(0,a.wap)("document",null),encrypt:(0,a.wap)("encrypt",null),encrypt_blist:(0,a.wap)("encrypt_blist",null),encrypt_contact:(0,a.wap)("encrypt_contact",null),encrypt_group_gen2:(0,a.wap)("encrypt_group_gen2",null),encrypt_image:(0,a.wap)("encrypt_image",null),encrypt_location:(0,a.wap)("encrypt_location",null),encrypt_url:(0,a.wap)("encrypt_url",null),encrypt_v2:(0,a.wap)("encrypt_v2",null),voip:(0,a.wap)("voip",null),multi_agent:(0,a.wap)("multi_agent",null)};t.default=class{constructor(e){if(this.queries=e,0===e.length)throw new Error("must specify at least one query")}getQueryElement(){return(0,a.wap)("feature",null,this.queries&&this.queries.map((e=>i[e])))}getUserElement(){return null}}},90297:(e,t,r)=>{"use strict";var a=r(14859),i=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.USyncQuery=t.USYNC_SUPPORT_TYPE=void 0;var n=r(35773),s=i(r(79268)),o=r(7017),l=i(r(10001)),d=i(r(95027)),u=i(r(54893)),c=a(r(45521)),p=i(r(40427)),h=i(r(32730)),f=r(29020),_={FEATURE:"feature",DEVICE:"devices",CONTACT:"contact",PICTURE:"picture",STATUS:"status",BUSINESS:"business"};t.USYNC_SUPPORT_TYPE=_;var m={feature:u.featureParser,devices:d.deviceParser,contact:l.contactParser,picture:p.pictureParser,status:h.statusParser,business:s.businessParser};function g(e){var t=[];return e.forEachChildWithTag("user",(e=>{var r={};e.hasAttr("jid")&&(Object.keys(_).forEach((t=>{var a=_[t],i=e.maybeChild(a);i&&m[a]&&(r[a]=m[a](i))})),r.id=e.attrUserWid("jid"),t.push(r))})),t}var v=new c.default("usyncParser",(e=>{e.assertAttr("type","result");var t={error:{},refresh:{},list:[],sideList:[]},r=e.child("usync"),a=r.child("result"),i=r.child("list"),n=r.maybeChild("side_list");return Object.keys(_).forEach((e=>{var r=_[e],i=a.maybeChild(r);if(i){var n=i.maybeChild("error");n?t.error[r]={errorCode:n.attrInt("code"),errorText:n.attrString("text"),errorBackoff:n.attrInt("backoff")}:i.hasAttr("refresh")&&(t.refresh[r]=i.attrInt("refresh",0))}})),t.list=g(i),n&&(t.sideList=g(n)),__LOG__(2)`usync query success!`,t}));t.USyncQuery=class{constructor(){this.context="interactive",this.mode="query",this.protocols=[],this.users=[]}withMode(e){return this.mode=e,this}withContext(e){return this.context=e,this}withContactProtocol(){return this.protocols.push(new l.default),this}withBusinessProtocol(){return this.protocols.push(new s.default),this}withDeviceProtocol(){return this.protocols.push(new d.default),this}withPictureProtocol(){return this.protocols.push(new p.default),this}withStatusProtocol(){return this.protocols.push(new h.default),this}withFeaturesProtocol(e){return this.protocols.push(new u.default(e)),this}withUser(e){return this.users.push(e),this}_buildStanza(){if(0===this.protocols.length)throw new Error("a usync query must have at least one protocol");0===this.users.length&&__LOG__(3)`Usync warning: a usync query must have at least one user`,this.users.map((e=>e.validate()));var e=(0,n.wap)("query",null,this.protocols.map((e=>e.getQueryElement()))),t=this.users.map((e=>{var t=e.getId();return(0,n.wap)("user",{jid:t?(0,f.USER_JID)(t):n.DROP_ATTR},this.protocols.map((t=>t.getUserElement(e))))})),r=(0,n.wap)("list",null,t);return(0,n.wap)("iq",{to:n.S_WHATSAPP_NET,xmlns:"usync",type:"get",id:(0,n.generateId)()},(0,n.wap)("usync",{sid:(0,n.generateId)(),index:"0",last:"true",mode:(0,n.CUSTOM_STRING)(this.mode),context:(0,n.CUSTOM_STRING)(this.context)},e,r))}execute(){var e=this._buildStanza();return(0,o.sendIq)(e,v).then((e=>e.success?(__LOG__(2)`Usync success: ${JSON.stringify(e.result)}`,e.result):{error:{all:{errorCode:e.errorCode,errorText:e.errorText,errorType:e.errorType}},refresh:{},list:[]}))}}},40427:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.pictureParser=function(e){e.assertTag("picture");var t=e.maybeChild("error");if(t)return{errorCode:t.attrInt("code"),errorText:t.attrString("text")};return{id:e.attrInt("id")}},t.default=void 0;var a=r(35773);t.default=class{getQueryElement(){return(0,a.wap)("picture",null)}getUserElement(){return null}}},32730:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.statusParser=function(e){e.assertTag("status");var t=e.maybeChild("error");if(t)return{errorCode:t.attrInt("code"),errorText:t.attrString("text")};if(!e.hasContent())return e.hasAttr("code")&&401===e.attrInt("code")?null:n.default.t(495);return 0!==e.contentString().length?e.contentString():n.default.t(495)},t.default=void 0;var i=r(35773),n=a(r(38637));t.default=class{getQueryElement(){return(0,i.wap)("status",null)}getUserElement(){return null}}},23665:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.USyncUser=void 0;t.USyncUser=class{withId(e){return this._id=e,this}withDeviceHash(e){return this._deviceHash=e,this}withPhone(e){return this._phone=e,this}getDeviceHash(){return this._deviceHash}getPhone(){return this._phone}getId(){return this._id}validate(){if(null==this._id&&null==this._phone)throw new Error("user must have an id or a phone")}}},4602:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(49244);class i{static tag(e){return e&&e[0]}static attr(e,t){return t&&t[1]?t[1][e]:void 0}static attrs(e){return e[1]}static child(e,t){var r=t[2];if(Array.isArray(r))for(var a=r.length,i=0;i<a;i++){var n=r[i];if(Array.isArray(n)&&n[0]===e)return n}}static firstChild(e){var t=e[2];if(Array.isArray(t))return t[0]}static children(e,t){if(!t)return e&&e[2];var r=e[2];return Array.isArray(r)?r.filter((e=>e[0]===t)):void 0}static dataStr(e){if(!e)return"";var t=e[2];return"string"==typeof t?t:t instanceof ArrayBuffer?new a.Binary(t).readString(t.byteLength):""}static toString(e,t){if(!e)return"undefined";var r=function(e,t){if(e){var r="";for(var a in e){r+=" "+a+"="+("string"==typeof e[a]?t?"...":'"'+e[a]+'"':e[a])}return r}return""}(e[1],t),a=function(e,t){if(e instanceof ArrayBuffer)return"<<bin:"+e.byteLength+">>";if("string"==typeof e)return t?"<<string:"+e.length+">>":e;if(Array.isArray(e))return e.map((e=>i.toString(e,t))).join("\n");return""}(e[2],t);return"<"+e[0]+r+(a?">\n"+a+"\n</"+e[0]+">":"/>")}}t.default=i},33576:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EphemeralDrop=t.LogoutDrop=t.Server5xxDrop=t.ConventionViolationDrop=t.BrowserReplacedDrop=t.WebdDrop=t.E499=t.E404=t.E401=t.CatalogEditServerError=t.ServerStatusCodeError=void 0;var a=r(71436);class i extends((0,a.customError)("ServerStatusCodeError")){constructor(e,t){super(t),this.status=e,this.statusCode=e}}t.ServerStatusCodeError=i;class n extends((0,a.customError)("ServerStatusCodeError")){constructor(e,t,r){super(r),this.errors=t,this.status=e,this.statusCode=e}}t.CatalogEditServerError=n;class s extends((0,a.customError)("E401",!0,i)){constructor(e){super(401,e)}}t.E401=s;class o extends((0,a.customError)("E404",!0,i)){constructor(e){super(404,e)}}t.E404=o;class l extends((0,a.customError)("E499",!0,i)){constructor(e){super(499,e)}}t.E499=l;class d extends((0,a.customError)("WebdDrop")){}t.WebdDrop=d;class u extends((0,a.customError)("BrowserReplacedDrop",!0,d)){}t.BrowserReplacedDrop=u;class c extends((0,a.customError)("ConventionViolationDrop",!0,d)){}t.ConventionViolationDrop=c;class p extends((0,a.customError)("Server5xxDrop",!0,d)){}t.Server5xxDrop=p;class h extends((0,a.customError)("LogoutDrop",!0,d)){}t.LogoutDrop=h;class f extends((0,a.customError)("EphemeralDrop",!0,d)){}t.EphemeralDrop=f},64346:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(94781),i={voipIndividualOutgoing:a.WebFeaturesFlag.FORCE_UPGRADE,groupsV3:a.WebFeaturesFlag.FORCE_UPGRADE,groupsV3Create:a.WebFeaturesFlag.DEVELOPMENT,changeNumberV2:a.WebFeaturesFlag.FORCE_UPGRADE,queryStatusV3Thumbnail:a.WebFeaturesFlag.DEVELOPMENT,liveLocations:a.WebFeaturesFlag.FORCE_UPGRADE,queryVname:a.WebFeaturesFlag.FORCE_UPGRADE,voipIndividualIncoming:a.WebFeaturesFlag.FORCE_UPGRADE,quickRepliesQuery:a.WebFeaturesFlag.FORCE_UPGRADE,payments:a.WebFeaturesFlag.FORCE_UPGRADE,labelsDisplay:a.WebFeaturesFlag.FORCE_UPGRADE,labelsEdit:a.WebFeaturesFlag.FORCE_UPGRADE,stickerPackQuery:a.WebFeaturesFlag.FORCE_UPGRADE,liveLocationsFinal:a.WebFeaturesFlag.FORCE_UPGRADE,mediaUpload:a.WebFeaturesFlag.FORCE_UPGRADE,vnameV2:a.WebFeaturesFlag.FORCE_UPGRADE,videoPlaybackUrl:a.WebFeaturesFlag.FORCE_UPGRADE,statusRanking:a.WebFeaturesFlag.FORCE_UPGRADE,voipIndividualVideo:a.WebFeaturesFlag.DEVELOPMENT,thirdPartyStickers:a.WebFeaturesFlag.FORCE_UPGRADE,frequentlyForwardedSetting:a.WebFeaturesFlag.FORCE_UPGRADE,recentStickers:a.WebFeaturesFlag.FORCE_UPGRADE,recentStickersV2:a.WebFeaturesFlag.PRODUCTION,recentStickersV3:a.WebFeaturesFlag.PRODUCTION,groupsV4JoinPermission:a.WebFeaturesFlag.FORCE_UPGRADE,catalog:a.WebFeaturesFlag.FORCE_UPGRADE,starredStickers:a.WebFeaturesFlag.PRODUCTION,templateMessage:a.WebFeaturesFlag.PRODUCTION,templateMessageInteractivity:a.WebFeaturesFlag.DEVELOPMENT,ephemeralMessages:a.WebFeaturesFlag.PRODUCTION,e2ENotificationSync:a.WebFeaturesFlag.FORCE_UPGRADE,syncdRelease1:a.WebFeaturesFlag.PRODUCTION,userNotice:a.WebFeaturesFlag.PRODUCTION,syncdRelease11:a.WebFeaturesFlag.PRODUCTION,support:a.WebFeaturesFlag.PRODUCTION,groupUiiCleanup:a.WebFeaturesFlag.FORCE_UPGRADE,groupDogfoodingInternalOnly:a.WebFeaturesFlag.DEVELOPMENT,settingsSync:a.WebFeaturesFlag.PRODUCTION,ephemeralAllowGroupMembers:a.WebFeaturesFlag.PRODUCTION,ephemeral24HDuration:a.WebFeaturesFlag.DEVELOPMENT,archiveV2:a.WebFeaturesFlag.PRODUCTION,mdForceUpgrade:a.WebFeaturesFlag.FORCE_UPGRADE};t.default=i},94407:(e,t,r)=>{"use strict";var a=r(93291);Object.defineProperty(t,"__esModule",{value:!0});var i={};Object.defineProperty(t,"default",{enumerable:!0,get:function(){return n.default}});var n=a(r(65998));Object.keys(n).forEach((function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(i,e)||Object.defineProperty(t,e,{enumerable:!0,get:function(){return n[e]}}))}))},54884:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,r=i.default.isWid,a=n.createWid){var s=t;switch(e){case"author":case"broadcast":case"chat":case"descOwner":case"from":case"gid":case"id":case"jid":case"owner":case"participant":case"quotedRemoteJid":case"quotedParticipant":case"remote":case"subjectOwner":case"s_o":case"to":case"wid":case"changeNumberNewJid":case"changeNumberOldJid":case"recipient":case"paymentMessageReceiverJid":r(t)&&(s=a(t));break;default:var o=parseInt(e,10);!isNaN(o)&&r(t)&&(s=a(t))}return s};var i=a(r(43926)),n=r(25054)},70692:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loadProtoVersions=function(){return(0,a.requireLoadProtoVersions)().then((e=>{Object.assign(i,e)}))},t.default=void 0;var a=r(81725),i={};var n=i;t.default=n},82770:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(57370)),n=r(49244),s={NEW:"REQUEST_STATE_NEW",SENT:"REQUEST_STATE_SENT",WEBDACKED:"REQUEST_STATE_WEBDACKED",WILL_RETRY:"REQUEST_STATE_WILL_RETRY"};class o{constructor(e){this.state=s.NEW,this.age=0,this.resends=0;var t=e.data;this.data=t,this.isToPhone=t instanceof ArrayBuffer,this.tag=e.tag,this.clientCacheable=!!e.clientCacheable,this.serverCacheable=!!e.serverCacheable,this.retryOn5xx=!!e.retryOn5xx,this.onSend=e.onSend,this.logOnSend=e.logOnSend,this.onDrop=e.onDrop,this.binaryOpts=e.binaryOpts,this.on5xx=e.on5xx,this.resendGuard=e.resendGuard,this.onTag=e.onTag,this.tagToCancel=e.tagToCancel,this.ephemeral=!!e.ephemeral,this.ignore=!!e.ignore,this.isCallOffer=!!e.isCallOffer,this.isWap4Bridge=!!e.isWap4Bridge}getTag(){return this.tag||(this.onSend?this.onSend.tag:void 0)}getName(){return this.binaryOpts&&this.binaryOpts.metricName?this.binaryOpts.metricName.toLowerCase():`${this.data[0]}_${(0,i.default)(this.data[1])}`}toString(){var e=this.data;return this.binaryOpts?this.binaryOpts.debugString:Array.isArray(e)?0===e.length?"[]":1===e.length?`[${e[0]}]`:"query"===e[0]||"action"===e[0]?`[${e[0]}, ${e[1]}${e.length>2?", ...":""}]`:`Invalid request: ${e[0]}`:e instanceof Object?"{...}":`${String(e)}`}serialize(){var e=this.tag;if(this.binaryOpts){var t=this.binaryOpts,r=null!=t.metric?t.metric:0,a=(this.ignore?0:1)<<7|(!this.ignore&&t.ackRequest?1:0)<<6|(!0===t.available?1:0)<<5|(!1===t.available?1:0)<<4|(null!=t.expires&&0!==t.expires?1:0)<<3|(t.skipOffline?1:0)<<2;return n.Binary.build(e,",",r,a,this.data).readBuffer()}var i="string"==typeof this.data?this.data:JSON.stringify(this.data);return`${String(e)},,${String(i)}`}}t.default=o,o.STATE=s},3889:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.base64DecodeRecursively=function e(t){var r=t[2];Array.isArray(r)&&r.forEach((t=>{t&&(t[2]instanceof ArrayBuffer||"string"==typeof t[2]?t[2]=(0,o.decodeB64ToJsArray)(t[2]):t[2]&&e(t))}))},t.default=void 0;var i=a(r(13888)),n=r(9557),s=r(76549),o=r(84337),l=a(r(43805)),d=r(99429),u=r(66239),c=a(r(4602)),p=r(91949),h=r(47075);var f={formatCallOffer:function(e,t,r){var a,i,n=r.payload,o={to:r.common.peer_jid,id:t,from:(0,u.getMaybeMeUser)().toString({legacy:!0})},l=n[2];return l.forEach(((e,t)=>{switch(e[0]){case"enc":var o={call:{callKey:new Uint8Array(e[2])}},l={},u=n[1].retry_count;u&&(l.count=u);var c=["call",l,(0,h.cdataArrayBuffer)((0,s.encodeProto)(d.MessageSpec,o))];a=c,i=t;break;default:(0,h.arrayToB64Recursively)(r.payload,!0)}})),l.splice(i,1),l.push(a),n[2]=l,e.actionNode("relay",[["call",o,[n]]])},parseCallSignalingMsg:function(e){try{var t=l.default.get(e.from),r={peer_jid:e.from.toString({legacy:!0}),isContact:t&&t.isMyContact},a=["wrapper",{},e.data];switch(e.type){case"offer":var i=_("offer",a);r.peer_platform=e.platform,e.version&&e.version.length&&(r.peer_version=e.version.join(".")),this.parseCallOffer(i,r,!1);break;case"accept":var n=_("accept",a);r.type=p.TYPE.ACCEPT,r.call_id=c.default.attr("call-id",n)||"",r.peer_platform=e.platform,e.version&&e.version.length&&(r.peer_version=e.version.join("."));break;case"receipt":var s=e.data;switch(r.call_id=c.default.attr("call-id",s)||"",c.default.tag(s)){case"offer":r.type=p.TYPE.OFFER_RECEIPT;break;case"accept":r.type=p.TYPE.ACCEPT_RECEIPT;break;case"reject":default:return}break;case"terminate":var o=_("terminate",a);r.call_id=c.default.attr("call-id",o)||"",r.type=p.TYPE.TERMINATE;break;default:var d=function(e){var t=c.default.firstChild(e);if(!t)throw new Error("voip_signaling:Failed to get first child node");return t}(a);r.call_id=c.default.attr("call-id",d)}return r&&r.call_id&&this.createCommonHeader(r),r}catch(e){return void __LOG__(3)`Error parsing voip signaling message`}},parseCallOffer:function(e,t,r){if(t.type=p.TYPE.OFFER,t.call_id=c.default.attr("call-id",e)||"",r){var a=_("call",e),i=c.default.children(a);if(i instanceof ArrayBuffer){var s=(0,n.decodeProto)(d.MessageSpec,i);s.call&&s.call.callKey?this.receiveCallOfferKey(s.call.callKey,t):__LOG__(3)`voip_signaling:invalid messageProto.call`}else __LOG__(3)`voip_signaling:invalid serializedMessage`}else t.enc=this.parseRawE2EMaterial(e);var o=c.default.children(e,"video");t.video_count=Array.isArray(o)?o.length:void 0,t.isVideoCall=!!t.video_count,t.isGroupCall_DEPRECATED=!!t.group_info;var l=c.default.attr("t",e);l&&(t.t=l)},parseRawE2EMaterial:function(e){var t=c.default.child("enc",e);if(t)return(0,o.decodeB64ToJsArray)(c.default.dataStr(t));__LOG__(3)`voip_signaling:enc node not present`},receiveCallOfferKey:function(e,t){t&&(t[2]=Array.prototype.slice.call(new Uint8Array(e)))},createCommonHeader(e){e.common=(0,i.default)(e,["type","call_id","peer_jid"])}};function _(e,t){var r=c.default.child(e,t);if(!r)throw new Error(`voip_signaling:Failed to get child node ${e}`);return r}t.default=f},47075:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formatCallSignalingMsg=function(e,t){var r,a=t.common.peer_jid;s(t.payload,!1);var i=t.payload;return["call",{from:null===(r=(0,n.getMaybeMeUser)())||void 0===r?void 0:r.toString({legacy:!0}),to:a,id:e},[i]]},t.arrayToB64Recursively=s,t.cdataArrayBuffer=o,t.cdataB64=l;var a=r(49244),i=r(84337),n=r(66239);function s(e,t){var r=e[2];Array.isArray(r)&&r.forEach((e=>{e&&(e[2]instanceof Array&&!(e[2][0]instanceof Array)?e[2]=t?o(new Uint8Array(e[2])):l(new Uint8Array(e[2])):e[2]&&s(e,t))}))}function o(e){return e instanceof Uint8Array?e.buffer:e instanceof ArrayBuffer?e:e instanceof a.Binary?e.readBuffer():void 0}function l(e){return e instanceof Uint8Array||e instanceof ArrayBuffer?(0,i.encodeB64)(e):e instanceof a.Binary?(0,i.encodeB64)(e.readBuffer()):void 0}},65998:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.Wap=void 0;var n,s,o=i(r(70417)),l=r(35773),d=r(47428),u=r(9557),c=r(49244),p=r(84337),h=r(74306),f=a(r(446)),_=r(99429),m=r(33576),g=a(r(24461)),v=i(r(64346)),E=a(r(20468)),y=a(r(25212)),S=i(r(34601)),T=i(r(21830)),A=r(30504),b=i(r(70692)),C=i(r(2191)),P=i(r(2661)),O=a(r(29666)),w=i(r(54559)),M=r(61864),I=r(47075),R=r(94781),D=i(r(43926)),N=r(25054),L=i(r(15934));function k(e){return function(){if(!n)return Promise.reject(new g.ProtoVersionUndefined(`wap:${e}:not connected to phone yet`));var t=n[e];return t?t.apply(n,arguments):Promise.reject(`wap:${e}:unsupported`)}}var U=k("sendPresenceUpdate"),G=k("sendChatstateUpdate");class F{constructor(){this.setSharedSecret=(0,d.wrapSyncPromise)((function(e){__LOG__(2)`Wap:saveSharedSecret start`;var t=(0,T.default)((0,p.decodeB64ToJsArray)(e),"decodeB64ToJsArray(payload)"),r=t.slice(0,32),a=t.slice(64),i=O.get().keyPair,n=(0,T.default)(i,"keyPair").privKey;return f.sharedSecret(r,n).then((e=>y.extractAndExpand(e,"",80))).then((e=>{var i=new Uint8Array(e,0,32),n=new Uint8Array(e,32,32),s=new Uint8Array(e,64,16),o=new Uint8Array(r.concat(a));return new S.default(n).sign(o).then((e=>{var r=(0,p.encodeB64)(e),n=(0,p.encodeB64)(t.slice(32,64));if(n===r){var o=c.Binary.build(s,new Uint8Array(a)).readByteArray();return(0,h.aesCbcDecrypt)(i,o).then((e=>{var t=new Uint8Array(e,0,32),r=new Uint8Array(e,32,32);O.setSecretKeys("0.1",t,r),__LOG__(2)`Wap:saveSharedSecret done`}))}__LOG__(3)`Wap:saveSharedSecret hmac mismatch ${n} ${r}`}))}))})),this.findGroupPendingInvitesFromPhone=k("findGroupPendingInvitesFromPhone"),this.acceptGroupV4Invite=k("acceptGroupV4Invite"),this.revokeGroupV4Invite=k("revokeGroupV4Invite"),this.addContact=k("addContact"),this.groupMetadataFindFromPhone=k("groupMetadataFindFromPhone"),this.resyncMessages=k("resyncMessages"),this.resyncReceipts=k("resyncReceipts"),this.queryReceivedActions=k("queryReceivedActions"),this.addParticipants=k("addParticipants"),this.changeSubject=k("changeSubject"),this.createGroup=k("createGroup"),this.leaveGroup=k("leaveGroup"),this.removeParticipants=k("removeParticipants"),this.promoteParticipants=k("promoteParticipants"),this.demoteParticipants=k("demoteParticipants"),this.setGroupDescription=k("setGroupDescription"),this.setGroupProperty=k("setGroupProperty"),this.setGroupEphemeralDuration=k("setGroupEphemeralDuration"),this.requestMediaReupload=k("requestMediaReupload"),this.sendMedia=k("sendMedia"),this.mediaUpload=k("mediaUpload"),this.sendConversationSeen=k("sendConversationSeen"),this.sendConversationUnseen=k("sendConversationUnseen"),this.sendConversationClear=k("sendConversationClear"),this.sendConversationDelete=k("sendConversationDelete"),this.sendConversationArchive=k("sendConversationArchive"),this.sendConversationMute=k("sendConversationMute"),this.sendConversationNotSpam=k("sendConversationNotSpam"),this.sendConversationPin=k("sendConversationPin"),this.sendConversationDismissChangeNumber=k("sendConversationDismissChangeNumber"),this.sendMessagePlayed=k("sendMessagePlayed"),this.sendMessageDelete=k("sendMessageDelete"),this.sendMessageStarred=k("sendMessageStarred"),this.sendUnstarAll=k("sendUnstarAll"),this.sendSetPicture=k("sendSetPicture"),this.deletePicture=k("deletePicture"),this.sendSetStatus=k("sendSetStatus"),this.setPushname=k("setPushname"),this.statusQuery=k("statusQuery"),this.sendStatusSeen=k("sendStatusSeen"),this.statusQueryThumbnail=k("statusQueryThumbnail"),this.sendSetBlock=k("sendSetBlock"),this.sendSpamReport=k("sendSpamReport"),this.chatFindQuery=k("chatFindQuery"),this.contactFindQuery=k("contactFindQuery"),this.queryIdentity=k("queryIdentity"),this.queryVname=k("queryVname"),this.msgCreateRecord=k("msgCreateRecord"),this.msgFindQuery=k("msgFindQuery"),this.queryLinkPreview=k("queryLinkPreview"),this.queryVcard=k("queryVcard"),this.queryMsgInfo=k("queryMsgInfo"),this.recentEmojiQuery=k("recentEmojiQuery"),this.clearBPQueue=k("clearBPQueue"),this.parseWebMessageInfo=k("parseWebMessageInfo"),this.subscribeLiveLocation=k("subscribeLiveLocation"),this.unsubscribeLiveLocation=k("unsubscribeLiveLocation"),this.queryActiveLiveLocation=k("queryActiveLiveLocation"),this.disableLiveLocation=k("disableLiveLocation"),this.findGroupPendingInvitesFromPhone=k("findGroupPendingInvitesFromPhone"),this.acceptGroupV4Invite=k("acceptGroupV4Invite"),this.revokeGroupV4Invite=k("revokeGroupV4Invite"),this.sendCallOffer=k("sendCallOffer"),this.queryCall=k("queryCall"),this.sendCallEnd=k("sendCallEnd"),this.queryLabels=k("queryLabels"),this.queryNextLabelColor=k("queryNextLabelColor"),this.queryLabelPalette=k("queryLabelPalette"),this.addOrRemoveLabels=k("addOrRemoveLabels"),this.deleteLabel=k("deleteLabel"),this.createLabel=k("createLabel"),this.editLabel=k("editLabel"),this.queryQuickReplies=k("queryQuickReplies"),this.flushQuickReplyCounts=k("flushQuickReplyCounts"),this.queryStickerPacks=k("queryStickerPacks"),this.queryStickersInStickerPack=k("queryStickersInStickerPack"),this.queryRecentStickers=k("queryRecentStickers"),this.queryStarredStickers=k("queryStarredStickers"),this.queryVideoPlaybackUrl=k("queryVideoPlaybackUrl"),this.queryNoticeState=k("queryNoticeState"),this.querySettings=k("querySettings"),this.setArchiveSetting=k("setArchiveSetting")}isInitialized(){return!!s}setVersion(e,t,r){var a=e[0],i=e[1],l=[a,i,t,r].join("."),d=s!==l;if(__LOG__(2)`wap:setVersion ${l} set: ${String(d)}`,d){var u=n;switch(a){case 0:switch(i){case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 11:case 12:case 13:case 14:case 15:case 16:throw __LOG__(3)`wap:setVersion deprecated version: ${l}`,new g.DeprecatedProtocolVersion("wap_deprecated_version");case 17:(n=(0,o.default)({},b.default[i])).setSubProtocol(t);break;default:n=void 0}}if(!n)throw __LOG__(3)`wap:setVersion unknown version. attempting to update`,new g.UpdateImmediately("wap_unknown_version");s=l,n.supportsFeatureFlags&&this.processFeatureFlags(r),u&&n&&n.upgradeProtoVersion(u)}}processFeatureFlags(e){if(e){var t=(0,T.default)(n,"protoVersion"),r=t.implementedFeatures||{},a=(0,u.decodeProtoWithUnknowns)(R.WebFeaturesSpec,(0,p.decodeB64)(e)),i=(0,u.getUnknownFields)(a);for(var s in delete a.unsafeUnknownFields,r)E.default.setFeatureFromFlags(s,R.WebFeaturesFlag.FORCE_UPGRADE,R.WebFeaturesFlag.FORCE_UPGRADE);var o=Object.keys(R.WebFeaturesSpec.internalSpec),l=Object.keys(a);for(var d in o.forEach((e=>{var t=(0,E.getProtobufFeatureName)(e);!l.includes(e)&&E.default.supportsFeature(t)&&E.default.setFeature(t,!1)})),a)if(!r[d]){var c=a[d],h=v.default[d];if(c===R.WebFeaturesFlag.FORCE_UPGRADE&&h!==R.WebFeaturesFlag.FORCE_UPGRADE)throw __LOG__(3)`wap:features:${d} phone value is ${c} and web value is ${h}. updating...`,new g.UpdateImmediately("wap_feature_force_upgrade");if(E.default.setFeatureFromFlags(d,h,c),E.default.supportsFeatureFromFlags(d)){var f=b.default.features[d];f&&Object.assign(t,f)}}for(var _ in i){var m=i[_];if("number"==typeof m&&R.WebFeaturesFlag.cast(m)===R.WebFeaturesFlag.FORCE_UPGRADE)throw __LOG__(3)`wap:features:unknown: ${_}: ${m}`,new g.UpdateImmediately("wap_feature_implemented_unknown")}}}delete(){var e=n?n.delete.apply(n,arguments):void 0;return n=void 0,s=void 0,__LOG__(2)`wap:unsetVersion, which should only happen when logout`,e}cannotReachPhone(){n&&n.cannotReachPhone.apply(n,arguments)}handle(e,t,r,a){return(0,T.default)(n,"protoVersion").handle.apply(n,[e,t,r,a])}queryServerProps(){return L.default.sendEphemeral2({data:["query","props"],retryOn5xx:!1})}resyncPictures(e){var t=e.filter((e=>D.default.isWid(e.id)));return 0===t.length?Promise.resolve([]):L.default.sendEphemeral2({data:["query","resumePic",t],retryOn5xx:!0})}setRememberMe(e){return L.default.sendBasic({data:["admin","remember",!!e]})}queryMediaConnections(e){var t=new Date,r=L.default.send2({data:["query","mediaConn"]}).then((e=>{if(__LOG__(2,!0)`queryMediaConnections result: ${JSON.stringify(e)}`,200!==e.status){if(e.status>=400)throw new m.ServerStatusCodeError(e.status,"queryMediaConnections");throw new m.ServerStatusCodeError(e.status,"Invalid return status")}var{media_conn:r}=e;if(!(r&&r.auth&&r.ttl&&r.hosts&&Array.isArray(r.hosts)&&0!==r.hosts.length))throw __LOG__(2)`wap:queryMediaConnections mediaConn exists ${String(!!r)}`,r&&(__LOG__(2)`wap:queryMediaConnections mediaConn.auth exists ${String(!!r.auth)}`,__LOG__(2)`wap:queryMediaConnections mediaConn.ttl exists ${String(!!r.ttl)}`,__LOG__(2)`wap:queryMediaConnections mediaConn.hosts exists ${String(!!r.hosts)}`,__LOG__(2)`wap:queryMediaConnections mediaConn.hosts isArray ${String(Array.isArray(r.hosts))}`,r.hosts&&__LOG__(2)`wap:queryMediaConnections mediaConn.hosts.length ${r.hosts.length}`),__LOG__(4,void 0,new Error,!0)`Assertion failed!`,SEND_LOGS("wap:queryMediaConnections unexpected mediaConn"),new Error("Invalid mediaConn");var{auth:a,auth_ttl:i,ttl:n,max_buckets:s}=r;return{auth:a,authTTL:i,hosts:r.hosts.map((e=>{var t,r=null===(t=e.rules)||void 0===t?void 0:t.map((e=>e.download_buckets?{downloadBuckets:e.download_buckets}:e));return(0,o.default)((0,o.default)({},e),{},{rules:r})})),queryStartTime:t,ttl:n,maxBuckets:s}}));return(0,C.default)(r,e)}acceptGroupInvite(e){return L.default.send2({data:["action","invite",e],retryOn5xx:!0})}revokeGroupInvite(e){return L.default.send2({data:["action","inviteReset",e],retryOn5xx:!0})}contactFindBroadcast(e){return L.default.send2({data:["query","contact",e],retryOn5xx:!0})}commonGroupsFind(e){return D.default.isServer(e)?Promise.resolve({status:200,groups:[]}):L.default.send2({data:["query","group","common",e]})}getCapabilities(e){return L.default.send2({data:["query","caps",e.filter(D.default.isUser)],retryOn5xx:!0})}queryExist(e){return D.default.isUser(e)?L.default.send2({data:["query","exist",e],retryOn5xx:!0}):Promise.resolve({status:400})}queryCtwaContext(e,t,r){var a={accountNumber:(0,N.createWid)(e).toString({legacy:!0}),code:t,expectedSourceUrl:r,id:(0,l.generateId)()};return L.default.send2({data:["query","ctwa",a],retryOn5xx:!0}).then((e=>{var t,a,i,n;if(200!==e.status)throw new m.ServerStatusCodeError(e.status,`queryCtwaContext:fail ${e.status}`);var s={sourceId:e.data.source.id,sourceType:e.data.source.type,sourceUrl:e.data.source.url,description:e.data.body,title:e.data.headline,mediaType:(null===(t=e.data.video)||void 0===t?void 0:t.url)?_.ExternalAdReplyInfoMediaType.VIDEO:_.ExternalAdReplyInfoMediaType.IMAGE,isSuspiciousLink:e.data.source.url!==r,thumbnailUrl:null===(a=e.data.thumbnail)||void 0===a?void 0:a.url,mediaUrl:null===(i=e.data.video)||void 0===i?void 0:i.url};return(null===(n=e.data.thumbnail)||void 0===n?void 0:n.bytes)&&(s.thumbnail=e.data.thumbnail.bytes),s}))}queryBusinessProfile(e,t){return L.default.send2({data:["query","businessProfile",e.filter((e=>D.default.isUser(e.wid))),t],retryOn5xx:!0}).then((e=>{switch(e.status){case 200:return e.profiles;default:throw new Error(`queryBusinessProfile:fail ${e} ${e.status}`)}}))}queryBusinessCategories(e){var t={id:(0,l.generateId)(),query:e};return L.default.send2({data:["query","businessCategories",t],retryOn5xx:!0}).then((e=>{switch(e.status){case 200:var t=e.data.not_a_biz[0],r=e.data.categories.reduce(((e,r)=>(r.id!==t.id&&e.push({id:r.id,localized_display_name:r.name}),e)),[]);return r.unshift({id:t.id,localized_display_name:t.name,not_a_biz:!0}),r;default:throw new Error(`queryBusinessCategories:fail ${e} ${e.status}`)}}))}queryOrder(e,t,r,a){var i={id:(0,l.generateId)(),orderId:e,imageWidth:t.toString(),imageHeight:r.toString(),token:a};return L.default.send2({data:["query","order",i],retryOn5xx:!0}).then((e=>{switch(e.status){case 200:var{data:t}=e;try{var{currency:r,subtotal:a,total:i,tax:n}=t.price;return{currency:r,createdAt:parseInt(t.creationTS,10),products:t.products.map((e=>{var t,r;return{id:e.id,price:e.price,thumbnailId:null===(t=e.image)||void 0===t?void 0:t.id,thumbnailUrl:null===(r=e.image)||void 0===r?void 0:r.url,currency:e.currency,name:e.name,quantity:parseInt(e.quantity||0,10)}})),subtotal:a,total:i,tax:n}}catch(t){throw new m.ServerStatusCodeError(e.status,`queryOrder:response malformed ${e.status}`)}case 404:throw new m.E404;default:throw new m.ServerStatusCodeError(e.status,`queryOrder:fail ${e.status}`)}}))}createOrder(e,t){var r={product:t.map((e=>({id:e.id,name:e.name,quantity:(0,M.isNumber)(e.quantity)?e.quantity.toString():void 0,price:(0,M.isNumber)(e.priceAmount1000)?e.priceAmount1000.toString():void 0,currency:e.currency}))),bizJID:e,id:(0,l.generateId)()};return L.default.send2({data:["action","createOrder",r],retryOn5xx:!0}).then((e=>{if(200===e.status)return e.data;throw new m.ServerStatusCodeError(e.status,`createOrder:fail wap action return status: ${e.status}`)}))}refreshCart(e,t,r,a){var i=t.map((e=>({id:e}))),n={id:(0,l.generateId)(),products:i,bizJID:D.default.user(e),imageDimensions:{width:r.toString(),height:a.toString()}};return L.default.send2({data:["action","refreshOrder",n],retryOn5xx:!0}).then((e=>{if(200===e.status)return e.data;throw new m.ServerStatusCodeError(e.status,`refreshCart:fail wap action return status: ${e.status}`)}))}queryProductCatalog(e,t,r,a,i){var n={catalogWid:e,afterCursor:t,limit:r,width:a,height:i,type:w.default.webCatalogApiREH?"get_product_catalog_reh":"get_product_catalog",stanza_id:(0,l.generateId)()};return L.default.send2({data:["query","bizCatalog",n],retryOn5xx:!0}).then((e=>{switch(e.status){case 200:return"string"==typeof e.data||e.data instanceof String?JSON.parse(e.data):e.data;default:throw new m.ServerStatusCodeError(e.status,`queryProductCatalog:fail ${e.status}`)}}))}queryProductList(e,t,r,a){var i={catalogWid:e,product_ids:t,width:""+r,height:""+a,stanza_id:(0,l.generateId)()};return L.default.send2({data:["action","getProductList",i],retryOn5xx:!0}).then((e=>{switch(e.status){case 200:return e.data.data;default:throw new m.ServerStatusCodeError(e.status,`queryProductList:fail ${e.status}`)}}))}queryProduct(e,t,r,a){var i={catalogWid:e,productID:t,width:r,height:a,type:w.default.webCatalogApiREH?"get_product_reh":"get_product",stanza_id:(0,l.generateId)()};return L.default.send2({data:["query","bizCatalog",i],retryOn5xx:!0}).then((e=>{switch(e.status){case 200:return{data:"string"==typeof e.data||e.data instanceof String?JSON.parse(e.data):e.data.product};case 404:case"not_found":return{error:"NOT_FOUND"};default:throw new m.ServerStatusCodeError(e.status,`queryProduct:fail ${e.status}`)}}))}reportBusinessCatalogProduct(e,t,r){var a={id:t,jid:e.toString(),reason:r,stanza_id:(0,l.generateId)()};return L.default.send2({data:["action",w.default.webCatalogApiREH?"reportProduct_reh":"reportProduct",a],retryOn5xx:!0}).then((e=>{if(200!==e.status)throw new m.ServerStatusCodeError(e.status,`reportBusinessCatalogProduct:fail ${e.status}`)}))}deleteBusinessCatalogProduct(e){var t=w.default.webCatalogApiREH?["action","deleteProduct_reh",{product_ids:e,stanza_id:(0,l.generateId)()}]:["action","deleteProduct",e];return L.default.send2({data:t,retryOn5xx:!0}).then((e=>{if(200!==e.status)throw new m.ServerStatusCodeError(e.status,`deleteBusinessCatalogProduct:fail ${e.status}`);return{deletedCount:e.deletedCount}}))}createBusinessCatalog(){var e=w.default.webCatalogApiREH?["action","createCatalog_reh",{stanza_id:(0,l.generateId)()}]:["action","createCatalog"];return L.default.send2({data:e,retryOn5xx:!0}).then((e=>{if(200!==e.status)throw new m.ServerStatusCodeError(e.status,`createBusinessCatalog:fail ${e.status}`)}))}editBusinessCatalogProduct(e,t,r){var a={product_id:e.id,name:e.name,image_url:e.imageCdnUrl,url:e.url,additional_image_urls:e.additionalImageCdnUrl,width:t.toString(),height:r.toString(),stanza_id:(0,l.generateId)(),is_hidden:e.isHidden};return"number"==typeof e.priceAmount1000&&(a.price=(e.priceAmount1000/10).toString(),e.currency&&(a.currency=e.currency)),e.description&&(a.description=e.description),e.retailerId&&(a.retailer_id=e.retailerId),L.default.send2({data:["action",w.default.webCatalogApiREH?"editProduct_reh":"editProduct",a],retryOn5xx:!0}).then((e=>{if(200===e.status)return e.data.product;var t;throw new m.CatalogEditServerError(e.status,(0,A.parseLegacyProductErrorReason)(null==e||null===(t=e.data)||void 0===t?void 0:t.reason))}))}addBusinessCatalogProduct(e,t,r){var a={name:e.name,description:e.description||"",image_url:e.imageCdnUrl,url:e.url||"",additional_image_urls:e.additionalImageCdnUrl,retailer_id:e.retailerId||"",width:t.toString(),height:r.toString(),stanza_id:(0,l.generateId)(),is_hidden:e.isHidden};return"number"==typeof e.priceAmount1000&&(a.price=(e.priceAmount1000/10).toString(),e.currency&&(a.currency=e.currency)),L.default.send2({data:["action",w.default.webCatalogApiREH?"addProduct_reh":"addProduct",a],retryOn5xx:!0}).then((e=>{if(200===e.status)return e.data.product;var t;throw new m.CatalogEditServerError(e.status,(0,A.parseLegacyProductErrorReason)(null==e||null===(t=e.data)||void 0===t?void 0:t.reason))}))}productVisibilitySet(e){var t={product_visibility:e.map((e=>[e.productId,e.isHidden])),stanza_id:(0,l.generateId)()};return L.default.send2({data:["action","productVisibilitySet",t],retryOn5xx:!0}).then((e=>{if(200!==e.status)throw new m.ServerStatusCodeError(e.status,`productVisibilitySet:fail ${e.status}`)}))}appealCatalogProduct(e,t){var r={id:e,reason:t,stanza_id:(0,l.generateId)()};return L.default.send2({data:["action",w.default.webCatalogApiREH?"appealProduct_reh":"appealProduct",r],retryOn5xx:!0}).then((e=>{if(200===e.status)return!0;throw new m.ServerStatusCodeError(e.status,`appealCatalogProduct:fail ${e.status}`)}))}groupV4InviteRequestMetadataFind(e,t,r,a,i){return L.default.send2({data:["query","InvitedGroupMetadata",{from:e,admin:t,code:r,expiration:a,gid:i}],retryOn5xx:!1})}groupV4InviteGrpPicThumb(e,t,r,a){return L.default.send2({data:["query","AddRequestGrpProfilePicThumb",{admin:e,code:t,expiration:r,gid:a}],retryOn5xx:!0})}groupMetadataFind(e){return L.default.send2({data:["query","GroupMetadata",e],retryOn5xx:!0}).then((e=>e.status&&e.status>=400?Promise.reject(new m.ServerStatusCodeError(e.status)):e))}groupInviteInfo(e){return L.default.send2({data:["query","invite",e],retryOn5xx:!0})}groupInviteCode(e){return L.default.send2({data:["query","inviteCode",e],retryOn5xx:!0})}profilePicFind(e){return D.default.isServer(e)?Promise.resolve({status:400}):L.default.sendEphemeral2({data:["query","ProfilePicThumb",e],retryOn5xx:!0})}profilePicFindThumbFromPhone(){return n?n.profilePicFindThumbFromPhone.apply(n,arguments):Promise.reject(new g.ProtoVersionUndefined("wap:profilePicFindThumbFromPhone:not connected to phone"))}statusFind(e){return D.default.isServer(e)?Promise.resolve({status:""}):L.default.sendEphemeral2({data:["query","Status",e],retryOn5xx:!0})}sendPing(){return L.default.send2({data:["admin","test"],retryOn5xx:!0})}sendPresenceAvailable(){return U("available")}sendPresenceUnavailable(){return U("unavailable")}sendChatstateComposing(e){return G("composing",e)}sendChatstatePaused(e){return G("paused",e)}sendChatstateRecording(e){return G("recording",e)}subscribePresence(e){return L.default.send2({data:["action","presence","subscribe",e],retryOn5xx:!0})}downloadImage(){return Promise.reject("Image download is not yet implemented")}logoutToken(){var{encKey:e,macKey:t}=O.get();return new S.default((0,T.default)(t,"macKey")).sign(new Uint8Array((0,T.default)(e,"encKey"))).then(p.encodeB64)}sendGroupCallOffer(e){return this.sendCallSignalingMsg(e)}sendCallSignalingMsg(e,t){var r=t||(0,P.default)(),a=(0,I.formatCallSignalingMsg)(r,e);return a?L.default.send2({tag:r,data:["action","call",a],retryOn5xx:!0}).then((e=>e)):Promise.reject("unknown call signaling msg type")}}t.Wap=F;var x=new F;t.default=x},75512:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.queryBusinessProfile=function(e){var t,r=(0,i.getBusinessProfileQueryVersion)();n.default.supportsFeature(n.default.F.MD_BACKEND)?(t=(0,o.default)(e,r))||(t=Promise.reject(new Error("Should not reach here"))):t=s.default.queryBusinessProfile(e,r);return t};var i=r(29219),n=a(r(20468)),s=a(r(94407)),o=a(r(38066))},28143:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.queryBusinessCategories=function(e){var t;if(!i.default.supportsFeature(i.default.F.MD_BACKEND))return n.default.queryBusinessCategories(e);(t=(0,s.queryBusinessCategories)(e))||(t=Promise.reject(new Error("BusinessCategory MD query not yet implemented")));return t};var i=a(r(20468)),n=a(r(94407)),s=r(54435)},29219:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.getBusinessProfileQueryVersion=function(){return 119&i.default.webBizProfileOptions};var i=a(r(54559))},34068:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.sendChatStatePaused=function(e){return n.default.supportsFeature(n.default.F.MD_BACKEND)?((0,o.default)(e,"paused"),Promise.resolve()):s.default.sendChatstatePaused(e).then((e=>{if(200!==e.status)throw new i.ServerStatusCodeError(e.status)}))},t.sendChatStateRecording=function(e){return n.default.supportsFeature(n.default.F.MD_BACKEND)?((0,o.default)(e,"recording"),Promise.resolve()):s.default.sendChatstateRecording(e).then((e=>{if(200!==e.status)throw new i.ServerStatusCodeError(e.status)}))},t.sendChatStateComposing=function(e){return n.default.supportsFeature(n.default.F.MD_BACKEND)?((0,o.default)(e,"composing"),Promise.resolve()):s.default.sendChatstateComposing(e).then((e=>{if(200!==e.status)throw new i.ServerStatusCodeError(e.status)}))};var i=r(33576),n=a(r(20468)),s=a(r(94407)),o=a(r(20120))},20637:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.sendClear=function(e,t,a){var c;s.default.supportsFeature(s.default.F.MD_BACKEND)?(c=Promise.all([Promise.resolve().then(r.bind(r,30093)),Promise.resolve().then(r.bind(r,32895))]).then((([{lockForMessageRangeSync:t},{default:r}])=>{var n=(0,l.unixTimeMs)();return r.getClearChatMutation(n,e.id,!a).then(function(){var r=(0,i.default)((function*(r){return yield t(["message"],[r],(0,i.default)((function*(){yield(0,d.addActiveMessageRange)(e.id.toString(),"clearChat",r.binarySyncAction),yield(0,u.default)(e.id)}))),{_duplicate:null}}));return function(){return r.apply(this,arguments)}}())})))||(c=Promise.reject(new Error("md:sendClear: should not reach here"))):c=o.default.sendConversationClear(e.id,t,!a).then((e=>{if(200!==e.status)throw new n.ServerStatusCodeError(e.status);return e}));return c};var i=a(r(52954)),n=r(33576),s=a(r(20468)),o=a(r(94407)),l=r(95334),d=r(99854),u=a(r(4750))},68899:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.createLocal=function(e,t){if(n.default.supportsFeature(n.default.F.MD_BACKEND))return(0,s.getTable)().create((0,i.default)({id:e.toString()},t)).catch((e=>{if(e instanceof o.DbOnLogoutAbort)throw e;throw __LOG__(4,!0,new Error,!0)`update chat table failed`,SEND_LOGS("update chat table failed when create local"),new Error("update chat table failed")}));return Promise.resolve()};var i=a(r(70417)),n=a(r(20468)),s=r(23443),o=r(24461)},77400:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.find=function(e,t){var r=performance.now();return o.default.chatFindQuery(e,(e=>{t.binarySize=e.binarySize})).then((function(e){return"preempted"!==e&&(t.timing=Math.ceil(performance.now()-r),t.size=e.length,s.default.supportsFeature(s.default.F.MD_BACKEND))?(0,d.getTable)().bulkCreateOrMerge(e.map((e=>(0,n.default)((0,n.default)({},e),{},{id:e.id.toString()})))).then((()=>e)).catch((()=>{throw __LOG__(4,!0,new Error,!0)`bulk update chats failed`,SEND_LOGS("bulk update chats failed"),new Error("bulk update chats failed")})):e}))},t.findLocal=function(){return u.apply(this,arguments)};var i=a(r(52954)),n=a(r(70417)),s=a(r(20468)),o=a(r(94407)),l=r(96631),d=r(23443);function u(){return(u=(0,i.default)((function*(e){if(s.default.supportsFeature(s.default.F.MD_BACKEND)){var t=yield(0,d.getTable)().get(e);if(t)return(0,l.hydrateWids)(t)}return null}))).apply(this,arguments)}},14784:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setLastReceivedKey=function(){return Promise.resolve()}},36766:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.sendConversationMute=function(e,t,r){var a;if(n.default.supportsFeature(n.default.F.MD_BACKEND)){var d=l.default.generateMuteMutation(e,t);(a=(0,o.lockForSync)(["chat"],[d],(([r])=>r.merge(e.toString(),{muteExpiration:t}))).then((()=>({status:200,_duplicate:null}))))||(a=Promise.reject(new Error("Should not reach here")))}else a=s.default.sendConversationMute(e,t,r).then((e=>{if(200!==e.status)throw new i.ServerStatusCodeError(e.status);return e}));return a};var i=r(33576),n=a(r(20468)),s=a(r(94407)),o=r(58970),l=a(r(54805))},76115:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.resyncMessages=function(e){return o.default.resyncMessages(e).then((e=>{if(n.default.supportsFeature(n.default.F.MD_BACKEND)&&(!e.status||e.status<400)){var{data:t}=e,a=[],o=[];return t.forEach((e=>{r(85030).default.get(e.id)?"clear"===e.type?a.push({id:e.id.toString(),t:e.t,unreadCount:e.unreadCount,archive:e.archive,isReadOnly:e.isReadOnly,modifyTag:e.modifyTag,notSpam:e.notSpam,pin:e.pin,changeNumberOldJid:e.changeNumberOldJid,changeNumberNewJid:e.changeNumberNewJid,muteExpiration:e.muteExpiration,ephemeralDuration:e.ephemeralDuration,ephemeralSettingTimestamp:e.ephemeralSettingTimestamp}):"delete"===e.type?o.push(e.id.toString()):a.push((0,i.default)((0,i.default)({},e),{},{id:e.id.toString()})):a.push((0,i.default)((0,i.default)({},e),{},{id:e.id.toString()}))})),(0,s.getStorage)().lock(["chat"],(([e])=>e.bulkCreateOrMerge(a).then((()=>e.bulkRemove(o))))).then((()=>e)).catch((()=>{throw __LOG__(4,!0,new Error,!0)`get storage or bulk update chats failed`,SEND_LOGS("get storage or bulk update chats failedwhen re-sync messages"),new Error("get storage or bulk update chats failed")}))}return e}))};var i=a(r(70417)),n=a(r(20468)),s=r(92166),o=a(r(94407))},75662:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.sendConversationSeen=function(e,t,a){var c;n.default.supportsFeature(n.default.F.MD_BACKEND)?(c=Promise.all([Promise.resolve().then(r.bind(r,30093)),Promise.resolve().then(r.bind(r,39016))]).then((([{lockForMessageRangeSync:r},{default:i}])=>{var n=(0,d.unixTimeMs)();return(-1===a?i.getMarkChatAsReadMutation(n,!0,e.id).then((t=>{var a=e.id.toString();return r([],[t],(()=>(0,l.addActiveMessageRange)(e.id.toString(),"markChatAsRead",t.binarySyncAction))),(0,o.updateChatForMarkAsReadSync)(a)})):(0,u.markChatRead)(e,t)).then((()=>({_duplicate:!1})))})))||(c=Promise.reject(new Error("Should not reach here"))):c=s.default.sendConversationSeen(e.id,t,a).then((e=>{var{status:t,_duplicate:r}=e;return 200!==t?Promise.reject(new i.ServerStatusCodeError(t)):{_duplicate:r}}));return c},t.sendConversationUnseen=function(e,t){var a;n.default.supportsFeature(n.default.F.MD_BACKEND)?(a=Promise.all([Promise.resolve().then(r.bind(r,30093)),Promise.resolve().then(r.bind(r,39016))]).then((([{lockForMessageRangeSync:t},{default:r}])=>{var i=(0,d.unixTimeMs)();a=r.getMarkChatAsReadMutation(i,!1,e).then((r=>t([],[r],(()=>(0,l.addActiveMessageRange)(e.toString(),"markChatAsRead",r.binarySyncAction)))))})))||(a=Promise.reject(new Error("Should not reach here"))):a=s.default.sendConversationUnseen(e,t).then((e=>{var{status:t}=e;if(200!==t)return Promise.reject(new i.ServerStatusCodeError(t))}));return a},t.markConversationSeen=function(e,t){if(n.default.supportsFeature(n.default.F.MD_BACKEND))return(0,c.getChatTable)().merge(e.toString(),{unreadCount:t}).catch((e=>{if(e instanceof p.DbOnLogoutAbort)throw e;throw __LOG__(4,!0,new Error,!0)`update chat table failed`,SEND_LOGS("update chat table failed when mark convestation seen"),new Error("update chat table failed")}));return Promise.resolve()},t.markConversationUnseen=function(e){if(n.default.supportsFeature(n.default.F.MD_BACKEND))return(0,c.getChatTable)().merge(e.toString(),{unreadCount:-1}).catch((e=>{if(e instanceof p.DbOnLogoutAbort)throw e;throw __LOG__(4,!0,new Error,!0)`update chat table failed`,SEND_LOGS("update chat table failed when mark conversation as unseen"),new Error("update chat table failed")}));return Promise.resolve()};var i=r(33576),n=a(r(20468)),s=a(r(94407)),o=r(78391),l=r(99854),d=r(95334),u=r(20039),c=r(38027),p=r(24461)},90138:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.sendDeleteMsgs=function(e,t,r){var a,c=e.map((e=>e.id));if(n.default.supportsFeature(n.default.F.MD_BACKEND)){var p=d.default.getDeleteForMeMutations(e,t),h=c.map((e=>e.toString()));if(!(a=(0,l.lockForSync)(["message","label-association"],p,(()=>(0,o.removeMessagesFromHistory)(h))).then((()=>u.default.purge(h).catch((e=>{__LOG__(3)`removeMessagesFromHistory: error ${e}`})).then((()=>Promise.resolve())))).catch((()=>{throw __LOG__(4,!0,new Error,!0)`remove messages from history failed`,SEND_LOGS("remove messages from history failed when send delete messages"),new Error("remove messages from history failed")}))))return Promise.reject(new Error("Not Supported for Non-MD"))}else a=s.default.sendMessageDelete(r,c,t).then((e=>{if(200!==e.status)throw new i.ServerStatusCodeError(e.status)}));return a};var i=r(33576),n=a(r(20468)),s=a(r(94407)),o=r(245),l=r(58970),d=a(r(33116)),u=a(r(87538))},74856:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.sendStarMsgs=function(e,t,r){var a;n.default.supportsFeature(n.default.F.MD_BACKEND)?(a=c(t,r))||(a=Promise.reject(new Error("Should not reach here"))):a=s.default.sendMessageStarred(e,t.map((e=>e.id)),r).then((e=>{if(200!==e.status)return Promise.reject(new i.ServerStatusCodeError(e.status))}));return a},t.sendUnstarAll=function(e,t){var r;n.default.supportsFeature(n.default.F.MD_BACKEND)?(r=c(e,!1))||(r=Promise.reject(new Error("Should not reach here"))):r=s.default.sendUnstarAll(t).then((e=>{if(200!==e.status)return Promise.reject(new i.ServerStatusCodeError(e.status))}));return r};var i=r(33576),n=a(r(20468)),s=a(r(94407)),o=r(58970),l=r(245),d=a(r(48163)),u=a(r(32856));function c(e,t){t||u.default.addUnsetActionCount(e.length);var r=d.default.getStarMessageMutations(e,t);return(0,o.lockForSync)(["message"],r,(()=>t?(0,l.starMessages)(e.map((e=>e.id.toString()))).catch((()=>{throw __LOG__(4,!0,new Error,!0)`star messages failed`,SEND_LOGS("star messages failed"),new Error("star messages failed")})):(0,l.unstarMessages)(e.map((e=>e.id.toString()))).catch((()=>{throw __LOG__(4,!0,new Error,!0)`unstar messages failed`,SEND_LOGS("unstar messages failed"),new Error("unstar messages failed")}))))}},78413:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.updateLocal=function(e,t){if(i.default.supportsFeature(i.default.F.MD_BACKEND))return(0,n.getTable)().merge(e.toString(),t).catch((e=>{if(e instanceof s.DbOnLogoutAbort)throw e;throw __LOG__(4,!0,new Error,!0)`update chat table failed`,SEND_LOGS("update chat table failed when update local"),new Error("update chat table failed")}));return Promise.resolve()};var i=a(r(20468)),n=r(23443),s=r(24461)},11076:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.sendSetBlock=function(e,t){var r;if(n.default.supportsFeature(n.default.F.MD_BACKEND)){var a=e?(0,o.blockUser)(t):(0,o.unblockUser)(t);(r=a.then((e=>{if(e&&null!=e.errorCode)throw new i.ServerStatusCodeError(e.errorCode,e.errorText);return!0})))||(r=Promise.reject(new Error("Should not reach here")))}else r=s.default.sendSetBlock(e,[{jid:t}]).then((e=>{if(200!==e.status)throw new i.ServerStatusCodeError(e.status);return!(e._duplicate||200!==e.status)}));return r.then((r=>{if(r&&n.default.supportsFeature(n.default.F.MD_BACKEND)){var a=t.toString();return(e?(0,l.getBlocklistTable)().createOrReplace({id:a}):(0,l.getBlocklistTable)().remove(t.toString())).then((()=>r)).catch((()=>{throw __LOG__(4,!0,new Error,!0)`send set block failed`,SEND_LOGS("Failed to send set block"),new Error("send set block failed")}))}return r}))};var i=r(33576),n=a(r(20468)),s=a(r(94407)),o=r(20174),l=r(38027)},62294:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.setChecksum=function(e){i.default.supportsFeature(i.default.F.MD_BACKEND)&&(0,n.setContactChecksum)(e);return Promise.resolve()};var i=a(r(20468)),n=r(13185)},32128:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.setFrequent=function(e){var t={};Object.keys(e).forEach((r=>{t[r]=e[r].map((e=>e.toString()))})),i.default.supportsFeature(i.default.F.MD_BACKEND)&&(0,n.setFrequentContacts)(t);return Promise.resolve()};var i=a(r(20468)),n=r(13185)},29877:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.getContactsToRemove=function(e){var t=[],a={};return e.forEach((e=>{e&&(a[e.id]=!0)})),i.default.forEach((e=>{var{id:i}=e;!(e.isUser||e.isGroup&&!r(85030).default.get(i))||a[i.toString()]||e.isPSA||t.push(e)})),t};var i=a(r(43805))},65794:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.sendSpamReport=function(e,t){var r;n.default.supportsFeature(n.default.F.MD_BACKEND)?(r=(0,o.reportSpam)(e,t).then((e=>{if(e&&e.errorCode)throw new i.ServerStatusCodeError(e.errorCode,e.errorText)})))||(r=Promise.reject(new Error("Should not reach here"))):r=s.default.sendSpamReport(e.id).then((e=>{if(200!==e.status)throw new i.ServerStatusCodeError(e.status)}));return r},t.sendNotSpam=function(e){var t;t=n.default.supportsFeature(n.default.F.MD_BACKEND)?Promise.resolve():s.default.sendConversationNotSpam(e.id).then((e=>{if(200!==e.status)throw new i.ServerStatusCodeError(e.status)}));return t.then((()=>n.default.supportsFeature(n.default.F.MD_BACKEND)?(0,l.getChatTable)().merge(e.id.toString(),{notSpam:!0}).catch((()=>{throw __LOG__(4,!0,new Error,!0)`get chat table merge failed`,SEND_LOGS("get chat table merge failed when sending spam report"),new Error("get chat table merge failed")})):Promise.resolve()))};var i=r(33576),n=a(r(20468)),s=a(r(94407)),o=r(56703),l=r(38027)},30421:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.updateLocal=function(e,t){if(i.default.supportsFeature(i.default.F.MD_BACKEND))return(0,n.getTable)().merge(e.toString(),t);return Promise.resolve()};var i=a(r(20468)),n=r(79525)},19958:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.contactSync=function(){return d.apply(this,arguments)};var i=a(r(52954)),n=a(r(20468)),s=r(24789),o=r(25054),l=r(38027);function d(){return(d=(0,i.default)((function*(){if(n.default.supportsFeature(n.default.F.MD_BACKEND)){var e=yield(0,l.getContactTable)().all();if(e.length>0){var t=e.map((e=>(0,o.createWid)(e.id)));return(0,s.syncContactListInChunks)(t)}}}))).apply(this,arguments)}},44122:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.sendCreateGroup=function(e,t,r,a,l,d,u=!1){var c;if(n.default.supportsFeature(n.default.F.MD_BACKEND)){if(!(c=(0,o.createGroup)(e,t,u).then((e=>({gid:e.wid,participants:e.participants.map((e=>({[e.wid.toString()]:{code:null!=e.error?e.error.toString():"200",invite_code:e.invite_code,invite_code_exp:e.invite_code_exp}})))})))))return Promise.reject(new Error("queryGroupInvite: not supported when not build with MD_BACKEND"))}else c=s.default.createGroup(e,t,r,a,l,d,void 0,u).then((e=>200===e.status?e:Promise.reject(new i.ServerStatusCodeError(e.status))));return c};var i=r(33576),n=a(r(20468)),s=a(r(94407)),o=r(6651)},73953:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.markExited=function(e){if(n.default.supportsFeature(n.default.F.MD_BACKEND))return(0,o.getTable)().merge(e.toString(),{isReadOnly:!0});return Promise.resolve()},t.sendExitGroup=function(e){var t;if(n.default.supportsFeature(n.default.F.MD_BACKEND)){if(!(t=(0,l.leaveGroups)([e]).then((()=>({_duplicate:null})))))return Promise.reject(new Error("sendExitGroup: not supported when not build with MD_BACKEND"))}else t=s.default.leaveGroup(e).then((e=>200!==e.status?Promise.reject(new i.ServerStatusCodeError(e.status)):{_duplicate:e._duplicate}));return t};var i=r(33576),n=a(r(20468)),s=a(r(94407)),o=r(23443),l=r(98034)},12390:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.sendQueryGroup=function(e){var t;if(o.default.supportsFeature(o.default.F.MD_BACKEND)){if(__LOG__(2,void 0,void 0,void 0,["groups"])`querying server for groupMetadata of group id ${e.toString()}`,!(t=(0,p.queryGroup)(e,"interactive")))return Promise.reject(new Error("queryGroup: not supported when not build with MD_BACKEND"))}else t=c.default.groupMetadataFind(e);return t.then((t=>{if(t.id)return(0,h.updateGroupMetadataTable)([t]),f(e,t.subject),(0,d.updateParticipants)(t.id,t.participants,t.pvId).then((()=>({id:t.id,owner:t.owner,creation:t.creation,desc:t.desc,descId:t.descId,descOwner:t.descOwner,descTime:t.descTime,restrict:t.restrict||!1,announce:t.announce||!1,noFrequentlyForwarded:t.noFrequentlyForwarded||!1,ephemeralDuration:t.ephemeralDuration||0,participants:t.participants,support:o.default.supportsFeature(o.default.F.SUPPORT)&&!0===t.support})));__LOG__(3)`Store:GroupMetadata Unexpected server response`})).catchType(s.ServerStatusCodeError,(t=>{if(t.status>=400)return{id:e,stale:!1}}))},t.sendQueryGroupInvite=function(e){var t;if(o.default.supportsFeature(o.default.F.MD_BACKEND)){if(!(t=(0,p.queryGroupInvite)(e).then((e=>(0,i.default)({status:200},e)))))return Promise.reject(new Error("queryGroup: not supported when not build with MD_BACKEND"))}else t=c.default.groupInviteInfo(e).then((e=>200!==e.status?Promise.reject(new s.ServerStatusCodeError(e.status)):e));return t},t.groupMetadataFindFromPhone=function(e){if(o.default.supportsFeature(o.default.F.MD_BACKEND))return Promise.reject(new Error("groupMetadataFindFromPhone: not supported in MD_BACKEND mode"));return c.default.groupMetadataFindFromPhone(e)},t.updateSubject=f;var i=a(r(70417)),n=a(r(43805)),s=r(33576),o=a(r(20468)),l=r(61864),d=r(92138),u=r(30421),c=a(r(94407)),p=r(33941),h=r(14963);function f(e,t){(0,l.isString)(t)&&n.default.find(e).then((function(e){if(!e.name){var r={name:t};(0,u.updateLocal)(e.id,r).then((()=>{e.set(r)}))}}))}},10875:(e,t,r)=>{"use strict";var a=r(14859);t.Z=function(){if(n.default.supportsFeature(n.default.F.MD_BACKEND)){return(0,s.isRegistered)()}return!!(0,i.getLoginTokens)().server};var i=r(66239),n=a(r(20468)),s=r(63191)},24098:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var r;if(n.default.supportsFeature(n.default.F.MD_BACKEND)){t.some((e=>e instanceof d.default))&&(__LOG__(4,void 0,new Error,!0)`contact model is invalid for editLabelAssociation`,SEND_LOGS("contact model is invalid for editLabelAssociation")),(r=v(e,t.map((e=>e instanceof u.default?{labelAssociationType:_.LabelAssociationType.Message,modelId:e.id.toString(),mutationIndexSegments:(0,p.constructMsgKeySegments)(e)}:{labelAssociationType:_.LabelAssociationType.Jid,modelId:e.id.toString(),mutationIndexSegments:[e.id.toString({legacy:!0})]}))))||(r=Promise.reject(new Error("Should not reach here")))}else r=s.default.addOrRemoveLabels(e,t).then((e=>{if(200!==e.status)return Promise.reject(new i.ServerStatusCodeError(e.status))}));return r},t.editLabelAssociationMD=v;var i=r(33576),n=a(r(20468)),s=a(r(94407)),o=r(58970),l=r(95334),d=a(r(69057)),u=a(r(36169)),c=r(17845),p=r(64571),h=r(65634),f=r(9690),_=r(81249),m=r(76549),g=r(60608);function v(e,t){return(0,f.canEditLabelAssociation)()?(0,o.lockForSync)(["label-association"],function(e,t){var r=(0,l.unixTimeMs)(),a=[];return e.forEach((({id:e,type:i})=>{t.forEach((({labelAssociationType:t,mutationIndexSegments:n})=>{a.push({timestamp:r,collection:c.CollectionName.Regular,operation:h.SyncdMutationSyncdOperation.SET,index:JSON.stringify([t===_.LabelAssociationType.Message?c.Actions.LabelMessage:c.Actions.LabelJid,e,...n]),version:c.LABEL_ASSOCIATION_SYNC_VERSION,binarySyncAction:(0,m.encodeProto)(g.SyncActionValueSpec,{timestamp:r,labelAssociationAction:{labeled:"add"===i}}).readBuffer()})}))})),a}(e,t),(()=>{var r=[],a=[];return e.forEach((({id:e,type:i})=>{t.map((({modelId:t,labelAssociationType:n})=>{"add"===i?r.push({labelId:e,associationId:t,type:n}):a.push([e,t,n])}))})),Promise.all([(0,_.getTable)().bulkCreateOrReplace(r).catch((()=>{throw __LOG__(4,!0,new Error,!0)`bulkCreateOrReplace into label association table failed`,SEND_LOGS("bulkCreateOrReplace into label association table failed when saving label associations"),new Error("bulkCreateOrReplace into label association table failed")})),(0,_.getTable)().bulkRemove(a).catch((()=>{throw __LOG__(4,!0,new Error,!0)`bulkRemove from label association table failed`,SEND_LOGS("bulkRemove from label association table failed while saving label associations"),new Error("bulkRemove form label association table failed")}))])})):Promise.reject(new Error("editLabelAssociation is not supported"))}},26495:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.updateLocal=s,t.updateLocalAndModel=function(e,t){return s(e,t).then((()=>{var a=r(30528).default.get(e);a&&a.set(t)})).catch((e=>Promise.reject(new Error(`[messaging] updateLocalAndModel: failed with error ${e}`))))};var i=a(r(20468)),n=r(43730);function s(e,t){return i.default.supportsFeature(i.default.F.MD_BACKEND)?(0,n.getTable)().merge(e.toString(),t).catch((e=>{throw __LOG__(4,!0,new Error,!0)`updateLocal: failed to update in storage`,SEND_LOGS("message updateLocal failed"),e})):Promise.resolve()}},90605:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.getHighestAck=function(){return d.apply(this,arguments)};var i=a(r(52954)),n=a(r(20468)),s=a(r(23045)),o=a(r(39542)),{ACK:l}=s.default;function d(){return(d=(0,i.default)((function*(e){if(n.default.supportsFeature(n.default.F.MD_BACKEND)){var t=yield o.default.find(e.id);if(!t)return __LOG__(2)`getHighestAck: no orphan ack found for ${e.id}`,null;var r=null,a=null;return 0===t.playedRemaining&&0!==t.played.length?(a=l.PLAYED,r=t.played):0===t.readRemaining&&0!==t.read.length?(a=l.READ,r=t.read):0===t.deliveryRemaining&&0!==t.delivery.length&&(a=l.RECEIVED,r=t.delivery),null==a||null==r?(__LOG__(2)`getHighestAck: orphan ack has 0 receipt for ${e.id}`,null):(__LOG__(2)`getHighestAck: orphan ack ${a} for ${e.id}`,{ack:a,t:Math.max(...r.map((e=>e.t))),to:e.to,from:e.from})}return Promise.reject(new Error("getHighestAck: not supported for non MD"))}))).apply(this,arguments)}},87996:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.msgFindQuery=function(e,t,r,a){if(i.default.supportsFeature(i.default.F.MD_BACKEND))return(0,n.msgFindQuery)(e,t).catch((e=>{throw __LOG__(4,!0,new Error,!0)`msgFindQuery: failed to find msg in storage`,SEND_LOGS("msgFindQueryMD failed"),e}));return s.default.msgFindQuery(e,t,r,a)},t.msgFindByIds=function(e){if(i.default.supportsFeature(i.default.F.MD_BACKEND))return(0,n.getMsgsByMsgKey)(e).catch((e=>{throw __LOG__(4,!0,new Error,!0)`msgFindByIds: failed to find msg in storage`,SEND_LOGS("msgFindByIdsMD failed"),e}));return Promise.resolve([])},t.queryVcard=function(e){if(i.default.supportsFeature(i.default.F.MD_BACKEND))return(0,n.queryVcard)(e).catch((e=>{throw __LOG__(4,!0,new Error,!0)`queryVcard: failed to find vCard in storage`,SEND_LOGS("queryVcardMD failed"),e}));return s.default.queryVcard(e)};var i=a(r(20468)),n=r(245),s=a(r(94407))},28950:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.sendQueryMsgInfo=function(e){var t,{id:r}=e;o.default.supportsFeature(o.default.F.MD_BACKEND)?(t=(0,d.queryMsgInfo)(e.id).catch((e=>{throw __LOG__(4,!0,new Error,!0)`sendQueryMsgInfo: failed to find msg info in storage`,SEND_LOGS("queryMsgInfo failed"),e})))||(t=Promise.reject(new Error("Should not reach here"))):t=l.default.queryMsgInfo(r).then((e=>e.status>=400?(__LOG__(2)`model:MsgInfo:findQuery error ${e.status}`,Promise.reject(new s.ServerStatusCodeError(e.status))):e));return t.then((t=>(0,i.default)((0,i.default)({},t),{},{id:r,usePlayReceipt:e.type===n.default.MSG_TYPE.PTT||e.isViewOnce})))};var i=a(r(70417)),n=a(r(23045)),s=r(33576),o=a(r(20468)),l=a(r(94407)),d=r(59763)},40822:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.sendDeliveryReceiptsAfterPresence=function(){i.default.supportsFeature(i.default.F.MD_BACKEND)&&(0,n.sendDeliveryReceiptsAfterPresence)()};var i=a(r(20468)),n=r(8139)},46308:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.sendMsgRecord=function(e){var t=Promise.resolve();if(n.default.supportsFeature(n.default.F.MD_BACKEND)){var{encryptAndSendMsg:a}=r(45822);t=a(e).then((e=>({t:parseInt(e.t,10),data:null}))).catch((t=>(__LOG__(3,void 0,void 0,void 0,["messaging"])`sendMsgRecord: MD send failure, msg: ${e.id.toString()}`,(0,o.updateLocalAndModel)(e.id,{isSendFailure:!0}),Promise.reject(t))))}else t=s.default.msgCreateRecord(e).then((e=>200!==e.status?Promise.reject(new i.ServerStatusCodeError(e.status)):e));return t};var i=r(33576),n=a(r(20468)),s=a(r(94407)),o=r(26495)},64506:(e,t,r)=>{"use strict";var a=r(14859),i=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.setPresenceAvailable=function(){o.default.supportsFeature(o.default.F.MD_BACKEND)?(0,c.default)("available"):l.default.sendPresenceAvailable().catchType(n.WebdDrop,(()=>{})).catchType(s.ProtoVersionUndefined,(()=>{}))},t.setPresenceUnavailable=function(){o.default.supportsFeature(o.default.F.MD_BACKEND)?(0,c.default)("unavailable"):l.default.sendPresenceUnavailable().catchType(n.WebdDrop,(()=>{})).catchType(s.ProtoVersionUndefined,(()=>{}))},t.subscribePresence=function(e){var t;if(o.default.supportsFeature(o.default.F.MD_BACKEND)){var r;r=e instanceof d.default?e:(0,u.createWid)(e),(t=Promise.resolve((0,p.default)(r)))||(t=Promise.reject(new Error("md:subscribePresence: not supported when not build with MD_BACKEND")))}else t=l.default.subscribePresence(e);return t};var n=r(33576),s=i(r(24461)),o=a(r(20468)),l=a(r(94407)),d=a(r(43926)),u=r(25054),c=a(r(37534)),p=a(r(6922))},57097:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.queryProduct=function(e,t,r,a){var i;if(n.default.supportsFeature(n.default.F.MD_BACKEND))(i=(0,p.default)(e,t,r,a))||(i=Promise.reject(new Error("Should not reach here")));else{var s=e.toString({legacy:!0});i=o.default.queryProduct(s,t,r,a)}return i},t.queryCatalog=function(e,t,r,a,i,s){var l;if(n.default.supportsFeature(n.default.F.MD_BACKEND))(l=(0,h.default)(e,t,r,a,i,s))||(l=Promise.reject(new Error("Should not reach here")));else{var d=e.toString({legacy:!0});l=o.default.queryProductCatalog(d,t,r,a,i)}return l},t.queryProductList=function(e,t,r,a){if(n.default.supportsFeature(n.default.F.MD_BACKEND))return(0,v.newJob)("queryProductList").waitUntilCompleted(e,t,r,a);var i=e.toString({legacy:!0});return o.default.queryProductList(i,t,r,a)},t.reportProduct=function(e,t,r){var a;n.default.supportsFeature(n.default.F.MD_BACKEND)?(a=(0,f.default)(e,t,r))||(a=Promise.reject(new Error("Should not reach here"))):a=o.default.reportBusinessCatalogProduct(e,t,r);return a},t.appealProduct=function(e,t){var r;n.default.supportsFeature(n.default.F.MD_BACKEND)?(r=(0,c.default)(e,t))||(r=Promise.reject(new Error("Should not reach here"))):r=o.default.appealCatalogProduct(e,t);return r},t.createCatalog=function(){var e;n.default.supportsFeature(n.default.F.MD_BACKEND)?(e=(0,_.default)())||(e=Promise.reject(new Error("Should not reach here"))):e=o.default.createBusinessCatalog();return e},t.addProduct=function(e,t,r){var a;n.default.supportsFeature(n.default.F.MD_BACKEND)?(a=(0,d.default)(e,t,r).then(S))||(a=Promise.reject(new Error("Should not reach here"))):a=o.default.addBusinessCatalogProduct(e,t,r).then(S);return a},t.editProduct=function(e,t,r){var a;n.default.supportsFeature(n.default.F.MD_BACKEND)?(a=(0,u.default)(e,t,r).then(S))||(a=Promise.reject(new Error("Should not reach here"))):a=o.default.editBusinessCatalogProduct(e,t,r).then(S);return a},t.deleteProducts=function(e){var t;n.default.supportsFeature(n.default.F.MD_BACKEND)?(t=(0,m.default)(e))||(t=Promise.reject(new Error("Should not reach here"))):t=o.default.deleteBusinessCatalogProduct(e);return t},t.parseDateValue=y,t.mapProductResponseToModel=S,t.mapMsgToProductModel=function(e){var t;e.businessOwnerJid&&(t=(0,l.createWid)(e.businessOwnerJid));return{catalogWid:t,id:e.productId||"",url:e.url,name:e.title,description:e.description,imageCdnUrl:e.mediaData.renderableUrl,reviewStatus:"",currency:e.currencyCode,priceAmount1000:e.priceAmount1000,salePriceAmount1000:e.salePriceAmount1000,retailerId:e.retailerId,productMsgMediaData:e.mediaData,imageCount:null!=e.productImageCount&&0!==e.productImageCount?e.productImageCount:1,fetchedFromServer:!1,t:e.t,isHidden:!1}},t.productVisibilitySet=function(e){var t;n.default.supportsFeature(n.default.F.MD_BACKEND)?(t=(0,g.default)(e))||(t=Promise.reject(new Error("Should not reach here"))):t=o.default.productVisibilitySet(e);return t};var i=a(r(19034)),n=a(r(20468)),s=r(13499),o=a(r(94407)),l=r(25054),d=a(r(93622)),u=a(r(46574)),c=a(r(82180)),p=a(r(72479)),h=a(r(71096)),f=a(r(67224)),_=a(r(57840)),m=a(r(6218)),g=a(r(38905)),v=r(83696);function E(e){return null==e?null:n.default.supportsFeature(n.default.F.MD_BACKEND)?parseInt(e,10):10*parseInt(e,10)}function y(e){return e?i.default.utc(e,i.default.ISO_8601).unix():null}function S(e,t){var r;return{catalogWid:t,id:e.id,isHidden:e.is_hidden||!1,url:e.url||"",name:e.name,description:e.description||"",availability:null!==(r=s.ProductAvailability.cast(e.availability))&&void 0!==r?r:s.ProductAvailability.UNKNOWN,additionalImageCdnUrl:e.additional_image_cdn_urls.map((e=>e[1].value)),additionalImageHashes:e.image_hashes_for_whatsapp.slice(1),imageCdnUrl:e.image_cdn_urls[1].value,imageHash:e.image_hashes_for_whatsapp[0],reviewStatus:e.capability_to_review_status.length?e.capability_to_review_status[0].value:"",currency:e.currency,priceAmount1000:E(e.price),salePriceAmount1000:E(e.sale_price),salePriceStartDate:y(e.sale_start_date),salePriceEndDate:y(e.sale_end_date),retailerId:e.retailer_id||"",productMsgMediaData:null,imageCount:e.additional_image_cdn_urls.length+1,fetchedFromServer:!0,t:Date.now()/1e3,old:!1,canAppeal:e.whatsapp_product_can_appeal}}},53319:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.requestDeletePicture=function(e){var t;s.default.supportsFeature(s.default.F.MD_BACKEND)?(t=(0,m.default)(e,null).then((()=>({_duplicate:!1,status:200}))))||(t=Promise.reject(new Error("Should not reach here"))):t=u.default.deletePicture(e).then((e=>e.status&&200!==e.status?Promise.reject(new n.ServerStatusCodeError(e.status)):e));return t.then((t=>t._duplicate?t:s.default.supportsFeature(s.default.F.MD_BACKEND)?(0,h.getProfilePicThumbTable)().remove(e.toString()).then((()=>{(0,c.changeProfilePicThumb)(e,_.PROFILE_PIC_COMMAND.REMOVE)})).then((()=>t)):t))},t.sendSetPicture=function(e,t,r){var a;if(s.default.supportsFeature(s.default.F.MD_BACKEND)){var i=g.default.parseDataURL(r).data,o=(0,p.decodeB64)(i);(a=(0,m.default)(e,o).then((()=>(0,f.getProfilePicFull)(e).then((e=>({_duplicate:!1,tag:e.tag,eurl:e.eurl,token:"",status:200}))))))||(a=Promise.reject(new Error("Should not reach here")))}else a=u.default.sendSetPicture(e,t,r).then((e=>200!==e.status?Promise.reject(new n.ServerStatusCodeError(e.status)):e));return a.then((t=>E(e).then((r=>{if(t.token=r,t._duplicate)return t;if(s.default.supportsFeature(s.default.F.MD_BACKEND)){var a=e.toString();return(0,h.getProfilePicThumbTable)().createOrMerge(a,{id:a,tag:t.tag,eurl:t.eurl}).then((()=>{(0,c.changeProfilePicThumb)(e,_.PROFILE_PIC_COMMAND.SET)})).then((()=>t))}return t}))))},t.profilePicFindThumbFromPhone=function(e,t){return u.default.profilePicFindThumbFromPhone(e,t).then((t=>E(e).then((e=>{if(t.token=e,s.default.supportsFeature(s.default.F.MD_BACKEND)){var r=t.id.toString();return(0,h.getProfilePicThumbTable)().createOrMerge(r,{id:r,tag:t.tag,raw:t.raw}).then((()=>t))}return t}))))},t.profilePicFind=v,t.profilePicResync=function(e){if(s.default.supportsFeature(s.default.F.MD_BACKEND))return Promise.all(e.map((e=>v(e.id).then((t=>({id:e.id,eurl:t.eurl,tag:t.tag,token:t.token,previewEurl:t.previewEurl}))).catchType(n.ServerStatusCodeError,(t=>{switch(t.status){case 401:case 404:return{id:e.id,tag:"",token:""};default:return __LOG__(3)`ProfilePicThumb:resyncPictures error - ${t.status}, ${t.message}`,{id:e.id,token:""}}})))));return u.default.resyncPictures(e).then((e=>Array.isArray(e)?Promise.all(e.map((e=>E(e.id).then((t=>(0,i.default)((0,i.default)({},e),{},{token:t})))))):"number"==typeof e.status&&e.status>=400?(423!==e.status&&429!==e.status&&__LOG__(3)`ProfilePicThumbStore:resyncPictures error ${e.status}`,Promise.reject(new n.ServerStatusCodeError(e.status))):(__LOG__(3)`ProfilePicThumbStore:resyncPictures unknown reply`,Promise.reject(new Error("ProfilePicThumbStore:resyncPictures unknown reply")))))};var i=a(r(70417)),n=r(33576),s=a(r(20468)),o=a(r(21830)),l=r(29666),d=r(92166),u=a(r(94407)),c=r(30229),p=r(84337),h=r(38027),f=r(8525),_=r(56160),m=a(r(91886)),g=a(r(22006));function v(e){var t;s.default.supportsFeature(s.default.F.MD_BACKEND)?(t=Promise.all([(0,f.getProfilePicFull)(e),(0,f.getProfilePicPreview)(e)]).then((e=>{var t=e[0],r=e[1];return{tag:t.tag,eurl:t.eurl,previewEurl:r.eurl,token:""}})))||(t=Promise.reject(new Error("Should not reach here"))):t=u.default.profilePicFind(e).then((e=>null!=e.status&&200!==e.status?Promise.reject(new n.ServerStatusCodeError(e.status)):e));var r=t=>(0,d.getStorage)().lock(["profile-pic-thumb"],(([r])=>r.get(e.toString()).then((a=>a?r.merge(e.toString(),t):r.create(t))))),a={id:e.toString(),tag:void 0,eurl:void 0,raw:void 0,previewEurl:void 0};return(0,o.default)(t,"serverPromise").then((t=>E(e).then((e=>(t.token=e,s.default.supportsFeature(s.default.F.MD_BACKEND)?(a.tag=t.tag,a.eurl=t.eurl,a.raw=null,a.previewEurl=t.previewEurl,r(a).then((()=>t))):t))))).catchType(n.ServerStatusCodeError,(e=>{if(!s.default.supportsFeature(s.default.F.MD_BACKEND))throw e;return s.default.supportsFeature(s.default.F.MD_BACKEND)&&404===e.status||!s.default.supportsFeature(s.default.F.MD_BACKEND)&&401===e.status?(a.tag="",a.raw=null):(a.tag=null,a.eurl=null,a.previewEurl=null),r(a).then((()=>{throw e}))}))}function E(e){if(s.default.supportsFeature(s.default.F.MD_BACKEND))return Promise.resolve("");for(var t=String(e),r=new ArrayBuffer(2*t.length),a=new Uint16Array(r),i=0;i<t.length;i++)a[i]=t.charCodeAt(i);return Promise.resolve().then((()=>(0,l.getSecurityToken)(r)))}},99935:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t,r=`+${e.toString()}`;if(!i.default.supportsFeature(i.default.F.MD_BACKEND))return n.default.queryExist(r).then((e=>200===e.status?{wid:e.jid,biz:e.biz||!1}:null));(t=(0,s.queryExist)(r))||(t=Promise.reject(new Error("Should not reach queryExists MD")));return t};var i=a(r(20468)),n=a(r(94407)),s=r(701)},91358:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.sendQueryMediaConn=function(e){return(0,s.default)({delay:({taskDuration:e})=>{var t=1e3*c();return Math.max(t-e,0)},signal:e},(t=>{var r;if(l.default.supportsFeature(l.default.F.MD_BACKEND)){if(!(r=(0,u.queryMediaConn)(e)))return Promise.reject(new Error("sendQueryMediaConn: not supported when not build with MD_BACKEND"))}else r=d.default.queryMediaConnections(e);return r.then((e=>{var{ttl:t,authTTL:r}=e;return null==r?(r=1e3*t,t=3e5):(r*=1e3,t*=1e3),(0,i.default)((0,i.default)({},e),{},{authTTL:r,ttl:t})})).catchType(o.ServerStatusCodeError,(e=>{if(e.status>=500)return t(e);throw e}))}))};var i=a(r(70417)),n=r(56150),s=a(r(81076)),o=r(33576),l=a(r(20468)),d=a(r(94407)),u=r(62246),c=(0,n.createTimer)({algo:{type:"fibonacci",first:0,second:1},max:9e5,jitter:.25})},57071:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.queryServerProps=function(){var e;i.default.supportsFeature(i.default.F.MD_BACKEND)?(e=(0,o.default)().then((e=>e.success?e.result:Promise.reject(new s.ServerStatusCodeError(e.errorCode,e.errorText)))))||(e=Promise.reject(new Error("Should not reach here"))):e=n.default.queryServerProps();return e};var i=a(r(20468)),n=a(r(94407)),s=r(33576),o=a(r(9875))},13668:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){if(i.default.supportsFeature(i.default.F.MD_BACKEND))return s.default.requestMediaReupload(e).then((({result:e,directPath:t})=>({status:l(e),directPath:t,isMD:!0})));return n.default.requestMediaReupload(e).then((({status:e,url:t,mediaKey:r,mediaKeyTimestamp:a,encFilehash:i,directPath:n})=>({isMD:!1,status:e,url:t,mediaKey:r,mediaKeyTimestamp:a,encFilehash:i,directPath:n})))};var i=a(r(20468)),n=a(r(94407)),s=a(r(57713)),o=r(83862);function l(e){if(null!=e)switch(e){case o.MediaRetryNotificationResultType.SUCCESS:return 200;case o.MediaRetryNotificationResultType.NOT_FOUND:case o.MediaRetryNotificationResultType.DECRYPTION_ERROR:return 404;case o.MediaRetryNotificationResultType.GENERAL_ERROR:return 500}return 500}},44014:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){if(n.default.supportsFeature(n.default.F.MD_BACKEND))return Promise.resolve();return s.default.setArchiveSetting(e).then((e=>{if(e.status&&200!==e.status)throw new i.ServerStatusCodeError(e.status)}))};var i=r(33576),n=a(r(20468)),s=a(r(94407))},74476:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);t.Z=function(e,t){if(e.length,m.default.supportsFeature(m.default.F.MD_BACKEND))return function(e,t){var r=new Uint8Array((0,_.decodeB64)(e)),a=(0,o.unixTime)();return v(t,(e=>(0,g.default)(r,a).uncancellable().then((r=>{if(r&&r.errorCode){if(r.errorCode>=500)throw new u.ServerStatusCodeError(r.errorCode,r.errorText);e(t)}e(void 0)}))))}(e,t);return function(e,t){var r=new FormData;r.append("t",String((0,o.unixTime)())),r.append("v",d.default.VERSION_BASE);var a=(0,p.getLoginTokens)().server;a&&r.append("tok",a);return r.append("buffer",e),v(t,(e=>(0,c.default)(d.default.WAM_URL,{method:"POST",body:r}).then((function(r){if(200===r.status)e(void 0);else{if(r.status>=500)throw new u.ServerStatusCodeError(r.status);e(t)}}))))}(e,t)};var n=r(60266),s=r(13275),o=r(95334),l=i(r(45026)),d=i(r(23045)),u=r(33576),c=i(r(127)),p=r(66239),h=i(r(66622)),f=a(r(56179)),_=r(84337),m=i(r(20468)),g=i(r(4106));function v(e,t){return(0,s.promiseLoop)(((r,a,i)=>{var s=(0,n.delayMs)(f.expBackoff(i,12e4,1e3,.1));return h.default.waitIfOffline({signal:(new l.default).signal}).then((()=>t(r))).catch((t=>i>1?(__LOG__(3)`wam:sendLogs failure error: ${String(t)}`,r(e)):(String(t),s)))}))}},11428:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.getStatus=function(e){var t;s.default.supportsFeature(s.default.F.MD_BACKEND)?(t=(0,l.default)(e).then((e=>e.error?(__LOG__(3)`getStatus: failed ${e.error.errorCode} : ${e.error.errorText}`,{id:e.id,stale:!0,status:""}):{id:e.id,status:null!=e.status?e.status:""})))||(t=Promise.reject(new Error("getAbout: invalid when build with MD_BACKEND"))):t=o.default.statusFind(e).then((t=>({id:e,status:null!=t.status?t.status:""}))).catchType(n.WebdDrop,(()=>({id:e,stale:!0,status:""})));return t},t.setMyStatus=function(e){var t;s.default.supportsFeature(s.default.F.MD_BACKEND)?(t=(0,d.newJob)("setAbout").waitUntilCompleted(e))||(t=Promise.reject(new Error("setStatus: invalid when build with MD_BACKEND"))):t=o.default.sendSetStatus(e);return t},t.queryStatusAll=function(){var e=Promise.resolve();e=s.default.supportsFeature(s.default.F.MD_BACKEND)?(0,u.queryStatusAllMD)():o.default.statusQuery();return e},t.queryStatusUpdate=function(e,t,r){var a=Promise.resolve();if(s.default.supportsFeature(s.default.F.MD_BACKEND))return Promise.resolve([]);a=o.default.statusQuery(e,t,r,"after");return a},t.sendReadStatus=function(){return p.apply(this,arguments)};var i=a(r(52954)),n=r(33576),s=a(r(20468)),o=a(r(94407)),l=a(r(14898)),d=r(83696),u=r(12891),c=r(20039);function p(){return(p=(0,i.default)((function*(e,t){var r;if(s.default.supportsFeature(s.default.F.MD_BACKEND)){if(yield(0,c.markStatusRead)(e),null==(r=!0))throw new Error("sendReadStatus: shouldn't reach here (md_backend was disabled)!")}else r=200===(yield o.default.sendStatusSeen(e,t)).status;return r}))).apply(this,arguments)}},35699:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.sendCallOfferBridge=function(e){var t;i.default.supportsFeature(i.default.F.MD_BACKEND)?(t=(0,s.default)(e,d.TYPE.OFFER))||(t=Promise.reject(new Error("Should not reach here"))):t=e.payload[2].find((e=>"enc"===e[0]))?n.default.sendCallOffer(e):n.default.sendGroupCallOffer(e);return t},t.sendCallSignalingMsgBridge=function(e,t){var r;i.default.supportsFeature(i.default.F.MD_BACKEND)?(r=(0,o.default)(e))||(r=Promise.reject(new Error("Should not reach here"))):r=n.default.sendCallSignalingMsg(e,t);return r},t.sendQueryCallBridge=function(e,t){var r;i.default.supportsFeature(i.default.F.MD_BACKEND)?(r=Promise.resolve({status:200}))||(r=Promise.reject(new Error("Should not reach here"))):r=n.default.queryCall(e,t);return r},t.sendCallEndBridge=function(e,t){var r;i.default.supportsFeature(i.default.F.MD_BACKEND)?(r=Promise.resolve({}))||(r=Promise.reject(new Error("Should not reach here"))):r=n.default.sendCallEnd(e,t);return r},t.sendEncRekeyBridge=function(e){var t;i.default.supportsFeature(i.default.F.MD_BACKEND)?(t=(0,s.default)(e,d.TYPE.ENC_REKEY))||(t=Promise.reject(new Error("Should not reach here"))):t=n.default.sendCallSignalingMsg(e);return t},t.prepareRetryReceiptBridge=function(e){var t;i.default.supportsFeature(i.default.F.MD_BACKEND)?(t=(0,l.default)(e))||(t=Promise.reject(new Error("Should not reach here"))):t=Promise.resolve(e);return t};var i=a(r(20468)),n=a(r(94407)),s=a(r(73859)),o=a(r(33288)),l=a(r(93364)),d=r(91949)},8868:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.shift().blocklist.map((e=>({id:e}))),a=r(88025).default;i.default.supportsFeature(i.default.F.MD_BACKEND)?(0,n.getBlocklistTable)().clear().then((()=>Promise.all(t.map((({id:e})=>(0,n.getBlocklistTable)().create({id:e.toString()})))))).then((()=>a.set(t))):a.set(t)};var i=a(r(20468)),n=r(38027)},84119:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.shift(),a=r(85030).default,i=r(30528).default;if(Array.isArray(t)){var O=[],w=[],M=[],I=[];t.forEach((function(e){if("c.us"===e.id)w.push(e);else{var t=!!a.get(e.id),r=["delete","clear","ephemeral","archive","unarchive","star","unstar","spam","modify_tag","pin","modify"].includes(e.type);r?t&&r?w.push(e):__LOG__(2)`Model:chat:handle received junk chat record: ${JSON.stringify(e)}`:O.push(e)}}));var R=O.find((e=>C.default.isPSA(e.id)));null!=R&&(R.name=S.default.t(1872));var D=r(37147).default;return w.forEach((function(e){var t=e.type;if("c.us"===e.id.toString()){switch(a.disableSortListener(),t){case"clear":__LOG__(2)`Model:chat:handle:clear:all before:${String(e.before)} kind:${String(e.kind)}`,a.forEach((function(t){"number"==typeof e.before?t.deleteMsgsOlderThan(e.before,e.star,e.kind):t.deleteMsgs(e.star,e.kind)}));break;case"delete":__LOG__(2)`Model:chat:handle:delete:all`,a.toArray().forEach((function(e){e.isGroup?e.deleteMsgs(!0):M.push(e)}));break;case"archive":__LOG__(2)`Model:chat:handle:archive:all`,a.forEach((function(e){I.push({id:e.id,archive:!0,pin:void 0})}));break;case"unarchive":__LOG__(2)`Model:chat:handle:unarchive:all`,a.forEach((function(e){I.push({id:e.id,archive:!1})}));break;case"unstar":__LOG__(2)`Model:chat:handle:unstar:all`,D.delete(),a.forEach((function(e){e.unstarAll()}));break;default:__LOG__(3)`Model:chat:handle unknown ${JSON.stringify(e)}`}a.enableSortListener()}else{var r=a.get(e.id);if(!r)return;switch(t){case"ephemeral":if(null!=e.t){var n=r.getLastReceivedNonExpiredMsg(e.t);n&&(0,T.setLastReceivedKey)(r.id,n.id).then((()=>{r.lastReceivedKey=n.id}))}break;case"clear":case"star":case"unstar":if(e.keys){for(var s=e.keys.length,o="star"===t,l=[],u=[],c=[],p=!1,h=0;h<s;h++){var f=void 0,_=void 0,m=void 0,g=void 0,v=void 0,E=e.keys[h];Array.isArray(E)?([f,_,m]=E,g=new A.default({fromMe:_,remote:e.id,id:f,participant:m}),(v=i.get(g))?"clear"===t?v.delete():(v.star=o,c.push(v)):o&&(p=!0)):!(0,d.default)(E)||"star"!==t&&"unstar"!==t||(g=E.id,(v=i.get(E.id))?(v.star=o,c.push(v)):u.push(E)),l.push(g&&g.toString())}"star"!==t&&"unstar"!==t||D.process(o,u,c,p),__LOG__(2)`model:Chat:handle:messages:${[t,e.id,l.join(),e.modifyTag].join()}`}else"clear"===t?("number"==typeof e.before?r.deleteMsgsOlderThan(e.before,e.star,e.kind):r.deleteMsgs(e.star,e.kind),__LOG__(2)`model:Chat:handle cleared chat:${[e.id,e.before,e.modifyTag,e.kind].join()}`):"unstar"===t&&(r.unstarAll(),__LOG__(2)`model:Chat:handle unstarred chat: ${e.id}`);isNaN(e.modifyTag)||I.push({id:e.id,modifyTag:e.modifyTag});break;case"delete":M.push(r),__LOG__(2)`model:Chat:handle deleted chat for ${String(e.id)}`;break;case"archive":I.push({id:e.id,archive:!0,pin:void 0});break;case"unarchive":I.push({id:e.id,archive:!1});break;case"spam":I.push({id:e.id,notSpam:e.notSpam});break;case"modify_tag":I.push({id:e.id,modifyTag:e.modifyTag});break;case"pin":I.push({id:e.id,pin:e.pin});break;case"modify":I.push({id:e.id,changeNumberOldJid:e.changeNumberOldJid,changeNumberNewJid:e.changeNumberNewJid})}}})),(m.default.supportsFeature(m.default.F.MD_BACKEND)?(0,b.getStorage)().lock(["chat"],(([e])=>e.bulkCreateOrMerge(O.map((e=>(0,s.default)((0,s.default)({},e),{},{id:e.id.toString()})))).then((()=>Promise.all(I.map((t=>{var{id:r}=t,a=(0,n.default)(t,["id"]);e.merge(r.toString(),a)}))))).then((()=>e.bulkRemove(M.map((e=>e.id.toString()))))))).catch((()=>{__LOG__(4,void 0,new Error,!0)`Assertion failed!`,SEND_LOGS("ChatHandler: bulk handle error")})):Promise.resolve()).then((()=>{a.add(O,{merge:!0}),I.forEach((e=>{var{id:t}=e,r=(0,n.default)(e,["id"]),i=a.get(t);i&&i.set(r)})),M.forEach((e=>e.delete()))}))}if("leave"===t.cmd)t.gids.forEach((function(e){var t=a.get(e);t&&(0,f.localExitGroup)(t)}));else{if("preempt"===t.cmd){var N=Promise.resolve();m.default.supportsFeature(m.default.F.MD_BACKEND)&&(N=(0,P.getTable)().bulkCreateOrMerge(t.response.map((e=>(0,s.default)((0,s.default)({},e),{},{id:e.id.toString(),muteExpiration:0})))));var L=(0,g.getBridge)();return N.then((()=>L.sendAndReceive("chat_collection","add",{things:t.response,options:{merge:!0}}))).then((()=>{c.default.platform!==c.PLATFORMS.IPHONE&&c.default.platform!==c.PLATFORMS.SMBI||((0,l.default)(t.response)?L.fireAndForget("msg_collection","trigger",{name:p.default.COLLECTION_HAS_SYNCED}):setTimeout((()=>{L.fireAndForget("msg_collection","trigger",{name:p.default.COLLECTION_HAS_SYNCED})}),2500)),L.fireAndForget("chat_collection","trigger",{name:p.default.COLLECTION_HAS_SYNCED,args:{count:t.response.length,binarySize:t.binarySize}})}))}if("action"===t.cmd){var k=t.id,U=t.data;if("create"!==U[0]&&"introduce"!==U[0]){if(U.length<3)return void __LOG__(3)`model:chat: incorrect length of payload data for action ${JSON.stringify(t)}`;var G,F=t.data[0],x="unknown"===t.data[1]?null:t.data[1];return G=F===E.GROUP_ACTIONS.RESTRICT||F===E.GROUP_ACTIONS.ANNOUNCE||F===E.GROUP_ACTIONS.NO_FORWARD?{action:F,value:t.data[2]}:F===E.GROUP_ACTIONS.EPHEMERAL?{action:F,duration:t.data[2]}:(0,s.default)({action:F},t.data[2]),(0,y.handleGroupActionWap)({chatId:t.id,author:x},G)}var B=U[1],Y=U[2],K=[...(0,o.default)(Y.admins,(e=>({id:e,isAdmin:!0}))),...(0,o.default)(Y.superadmins||[],(e=>({id:e,isAdmin:!0,isSuperAdmin:!0}))),...(0,o.default)(Y.regulars,(e=>({id:e,isAdmin:!1})))];v.default.add({id:k,creation:Y.creation,owner:B,participants:K,stale:!1,desc:Y.desc,descId:Y.descId,descTime:Y.descTime,descOwner:Y.descOwner,restrict:!!Y.restrict,announce:!!Y.announce},{merge:!0}),h.default.add({id:k,name:Y.subject},{merge:!0});var j=a.get(k);if(!j)return;var W=j.msgs.last();if(!W)return;if("gp2"===W.type&&"add"===W.subtype){var H=(0,_.getMaybeMeUser)();v.default.trigger(`group_participant_change_${H.toString()}`,k),C.default.equals(W.recipients[0],H)&&u.default.alertNewMsg(W)}}else __LOG__(3)`model:chat: unknown payload: ${JSON.stringify(t)}`}};var n=i(r(22220)),s=i(r(70417)),o=i(r(16760)),l=i(r(45455)),d=i(r(29259)),u=i(r(13277)),c=a(r(79435)),p=i(r(23045)),h=i(r(43805)),f=r(34330),_=r(66239),m=i(r(20468)),g=r(53353),v=i(r(25120)),E=r(6471),y=r(12104),S=i(r(38637)),T=r(14784),A=i(r(83746)),b=r(92166),C=i(r(43926)),P=r(23443)},24413:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.shift();switch(t.type){case"picture":(0,i.changeProfilePicThumb)(t.jid,t.tag);break;default:(0,a.handle)([t])}return Promise.resolve()};var a=r(88761),i=r(30229)},1655:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t,a=e.shift();a.id="1";var i=r(94407).default,{protoVersion:p,binVersion:h,features:f}=a;if(p){d.default.setVersion(p);var _=d.default.setFeatures(f);t=!!_.KEY_PARTICIPANT,i.setVersion(p,h,f&&f.FLAGS)}if(a.initial){d.default.setPlatform(a.platform),(0,l.setLogoutToken)(a.browserToken),a.hasOwnProperty("is24h")&&s.default.setIs24Hour(a.is24h);var m=a.ref,g=a.serverToken,v=a.clientToken,E=a.connected;m&&E&&g&&(0,l.setRefTok)(m,g),(0,l.setLoginTokens)({client:v,server:g});var y=a.secret?i.setSharedSecret(a.secret):Promise.resolve();return Promise.all([(0,u.requireContactCollection)(),y]).then((([e])=>{if("true"!==a.isResponse&&c.save(),"iw"===a.lg&&(a.lg="he"),a.wid){var t=a.wid;(0,l.setMe)(t),o.default.trigger("me_ready"),a.pushname&&(o.default.pushname=a.pushname,(0,l.setPushname)(a.pushname)),e.gadd(t)}o.default.set(a)}))}return o.default.connected&&t&&(__LOG__(2)`models:Conn:participantChange:to:${String(d.default.supportsFeature(d.default.F.KEY_PARTICIPANT))}`,n.default.hardRefresh()),o.default.set(a),Promise.resolve()};var n=i(r(92082)),s=i(r(99461)),o=i(r(79435)),l=r(66239),d=i(r(20468)),u=r(81725),c=a(r(29666))},78252:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.shift();if(Array.isArray(t)){var r=e.shift();!function(e,t){var r=t&&"remove"===t.missing?(0,l.getContactsToRemove)(e):[];(0,d.mungePSAContact)(e),n.default.add(e,{merge:!0}),r.forEach((e=>{e.unset("name"),e.unset("shortName")})),t&&t.checksum&&(n.default.setChecksum(t.checksum),__LOG__(2)`handle:Contact update checksum ${t.checksum}`);__LOG__(2)`handle:Contact updated ${e.map((e=>e.id)).join()}`}(t,r)}else"preempt"===t.cmd?function(e){(0,d.mungePSAContact)(e.response),n.default.add(e.response,{merge:!0}),e.checksum&&(n.default.setChecksum(e.checksum),__LOG__(2)`Store:Contact:handle update checksum ${e.checksum}`);n.default.trigger(i.default.COLLECTION_HAS_SYNCED,{count:e.response.length,binarySize:e.binarySize})}(t):"frequent"===t.type?function(e){var t;delete e.type,t=o.default.supportsFeature(o.default.F.MD_BACKEND)?(0,s.setFrequent)(e):Promise.resolve();t.then((()=>{n.default.updateFrequentContacts(e)}))}(t):"sidelist"===t.type?function(e){var{notification:t,action:r,hash:a}=e,i=n.default.resolveWidsFromHash(a);if(!i)return;"business"===t&&"profile"===r&&i.forEach((e=>{var t=n.default.get(e);if(t)t.businessProfile&&t.businessProfile.markStale();else{var r=n.default.getUserCount(),i=n.default.contactHashLength();__LOG__(4,void 0,new Error,!0)`Hash: ${a} Users: ${r}, Hashes: ${i}`,SEND_LOGS("Stale wid in contact hash index")}}))}(t):__LOG__(3)`handle:Contact unknown: ${JSON.stringify(t)}`};var i=a(r(23045)),n=a(r(43805)),s=r(32128),o=a(r(20468)),l=r(29877),d=r(74005)},78436:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){if(!Array.isArray(e))return __LOG__(4,void 0,new Error,!0)`ws2: Invalid message, not an array`,void SEND_LOGS("ws2:invalid-msg");var t=e.shift();switch(t){case"Blocklist":return void(0,i.default)(e);case"Contact":return void(0,l.default)(e);case"Props":case"ServerProps":return void r(54559).default.handle(e);case"Location":case"LiveLocation":return void r(36839).default.handle(e);case"Chat":return void(0,n.default)(e);case"Msg":return void(0,d.default)(e);case"Stream":return void(0,p.default)(e);case"Conn":return void(0,o.default)(e);case"Cmd":return void(0,s.default)(e);case"Presence":return void(0,c.default)(e);case"MsgInfo":return void(0,u.default)(e);case"BusinessProfile":return void r(65017).default.handle(e);case"GroupMetadata":return void r(25120).default.handle(e);case"Label":return void r(62345).default.handle(e);case"QuickReply":return void r(84553).default.handle(e);case"Call":return void r(40941).default.handle(e);case"Mute":return void r(96997).default.handle(e);case"Status":return void r(48514).default.handle(e);case"StatusV3":return void r(65677).default.handle(e);default:__LOG__(4,void 0,new Error,!0)`ws2: Invalid type received: ${t}`,SEND_LOGS("ws2: Invalid type received")}};var i=a(r(8868)),n=a(r(84119)),s=a(r(24413)),o=a(r(1655)),l=a(r(78252)),d=a(r(61462)),u=a(r(83206)),c=a(r(92967)),p=a(r(5487))},61462:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function([e]){var t=r(30528).default;function a(){return i.apply(this,arguments)}function i(){return(i=(0,n.default)((function*(r,a){var i;i=f.default.isStatusV3(e.broadcast)?new h.default({from:e.from,to:e.broadcast,id:a,selfDir:e.self||"out"}):new h.default({from:e.from,to:r,id:a,participant:e.participant,selfDir:e.self||"out"});var n=t.get(i);n?yield(0,o.updateMsgAck)(n,e.broadcast,{from:e.from,to:r,ack:e.ack,t:e.t}):(__LOG__(2)`Msg:out of order ack`,t.preAck[i]=e)}))).apply(this,arguments)}if("ack"===e.cmd){var m=[e.to];if(f.default.isBroadcast(e.to)&&e.ack===u.default.ACK.SENT){var g=p.default.get(e.to);g&&Array.prototype.push.apply(m,(0,s.default)(g.participants.toArray(),"id"))}var v=m.map((t=>a(t,e.id)));return Promise.all(v)}if("acks"===e.cmd){var E=e.id.map((t=>a(e.to,t)));return Promise.all(E)}if(e.msg){if(!(e.chat instanceof f.default))return Promise.resolve();var y="update"===e.meta.add;return f.default.isStatusV3(e.chat)&&!r(65677).default.handleUpdate(e.msg,e.meta.checksum,y)?Promise.resolve():(e.msg.recvFresh=!0,e.msg.isNewMsg=!0,t.processMultipleMessages(e.chat,[e.msg],{add:"after",update:y,isHistory:!1}).catchType(c.LogoutDrop,(()=>{})).catch((t=>{__LOG__(4,void 0,new Error,!0)`Msg: ${String(e.msg.id)} chat: ${String(e.chat)} Error: ${t.name}, message: ${t.message}, stack: ${t.stack}`,SEND_LOGS("msg_handler: error storing/processing single message")})))}if(e.msgs){var S=e.msgs.length;if(!S)return Promise.resolve();var T=null;if(!(e.chat instanceof f.default))return Promise.resolve();var A=e.meta;A.isHistory=!0,"unread"===A.add&&(A.firstUnreadKey=new h.default({fromMe:A.unreadFromMe,remote:e.chat,id:A.unreadId,participant:A.unreadParticipant}),T=new l.default);for(var b=0;b<S;b++){e.msgs[b].invis=!0}return d.default.platform!==d.PLATFORMS.IPHONE&&d.default.platform!==d.PLATFORMS.SMBI||t.trigger(u.default.COLLECTION_HAS_SYNCED),t.trigger("handle:msg_history",{count:e.msgs.length,binarySize:e.binarySize}),t.processMultipleMessages(e.chat,e.msgs,A,T).catchType(c.LogoutDrop,(()=>{})).catch((t=>{__LOG__(4,void 0,new Error,!0)`Msgs count: ${S} Chat: ${String(e.chat)} Error: ${t.name}, message: ${t.message}, stack: ${t.stack}`,SEND_LOGS("msg_handler: error storing/processing multiple messages")}))}if(e.recent){var C=e.meta,P=e.binarySize;return delete e.recent,delete e.meta,delete e.binarySize,t.trigger(u.default.COLLECTION_HAS_SYNCED,{count:Object.keys(e).length,binarySize:P}),C.isHistory=!0,Promise.all(Object.keys(e).map((r=>{var a;try{a=(0,_.createWid)(r)}catch(e){return Promise.resolve()}var i=e[r];i.invis=!0;var n="last"===C.add&&C.resume?new l.default:null;t.processMultipleMessages(a,[i],C,n).catchType(c.LogoutDrop,(()=>{})).catch((()=>{__LOG__(4,void 0,new Error,!0)`Assertion failed!`,SEND_LOGS("msg_handler: error storing recent messages")}))})))}return __LOG__(2)`************** Msg else clause. something strange is going on`,Promise.resolve()};var n=i(r(52954)),s=i(r(16760)),o=r(58666),l=i(r(13649)),d=a(r(79435)),u=i(r(23045)),c=r(33576),p=i(r(25120)),h=i(r(83746)),f=i(r(43926)),_=r(25054)},83206:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.shift(),{from:r,to:a,ack:n,participant:s,t:o}=t;switch(t.cmd){case"ack":i.default.updateInfo(t.id,r,a,n,s,o);break;case"acks":t.id.forEach((e=>{i.default.updateInfo(e,r,a,n,s,o)}))}};var i=a(r(39542))},92967:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.shift();return(0,i.default)(t)};var i=a(r(36900))},5487:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){switch(e[0]){case"asleep":break;case"killsw":i.default.killServiceWorker();break;case"update":case"update_desktop":break;default:__LOG__(3)`Stream:handle unknown cmd ${e[0]}`}};var i=a(r(3472))},53353:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.setBridge=function(e){n=e},t.getBridge=function(){return(0,i.default)(n,"_bridge")},t.isConnectedToPage=function(){return true};var i=a(r(21830)),n=null},27325:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeBridge=function(){return new a.DynamicRouter};var a=r(44922)},8883:(e,t,r)=>{"use strict";var a=r(14859);t.Z=void 0;var i=r(66239),n=a(r(77613)),s=a(r(82462)),o=a(r(94854)),l={whoAmI(){var e=(0,i.getMaybeMeUser)().toString();return Promise.resolve(e)},logImpl:(e,t,r,a,i)=>(o.default.logImpl(e,t,r,a,i),Promise.resolve()),initFromStorage:()=>s.default.invoke("initFromStorage",[]),setLogoutState:e=>(n.default.isLogoutInProgress=e,s.default.invoke("setLogoutState",[e])),deleteDbEncKeyCache:()=>s.default.invoke("deleteDbEncKeyCache",[]),initDatabaseEncnKey:e=>s.default.invoke("initDatabaseEncnKey",[e]),generateFinalDbEncryptionAndFtsKey:e=>s.default.invoke("generateFinalDbEncryptionAndFtsKey",[e])};t.Z=l},47629:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=new MessageChannel,r=t.port1,a=t.port2;o.default.respondTo(r),i.default.init(),s.default.setConnectionManager(i.default),i.default.connectVia(r),e.postMessage((0,n.buildHandshakePayload)(a),[a])};var i=a(r(82554)),n=r(30105),s=a(r(82462)),o=a(r(70655))},18165:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(47629)),n=new(a(r(46907)).default);(0,i.default)(n);var s=n;t.default=s},82554:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(47677)),n=a(r(21830));var s=new class{init(){return this._promise||(this._promise=new Promise((e=>{this._resolver=e})).timeout(5e3)),this._promise}isConnected(){return null!=this._port}getPort(){return this._port}waitForConnection(){return(0,n.default)(this._promise,"ConnectionManager Initialization Promise")}connectVia(e){if(this.isConnected())throw new Error("Connection already established");(0,i.default)(this._resolver,"ConnectionManager not initialized"),this._port=e,this._resolver()}};t.default=s},77613:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={isLogoutInProgress:!1}},82462:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(47677)),n=r(61883),s=r(46181),o=a(r(21830)),l=r(382);var d=new class{constructor(){this._pending=new Map,this._onResponseReceipt=e=>{var t=(0,l.unwrapResponsePayload)(e.data);if(null!=t){var{invocationId:r,result:a}=t;if(this._pending.has(r)){var{resolve:i}=(0,o.default)(this._pending.get(r),"this._pending.get(invocationId)");i(a),this._pending.delete(r)}}}}setConnectionManager(e){this._conn=e,e.waitForConnection().then((()=>{var t=(0,o.default)(e.getPort(),"Port obtained from ConnectionManager after connection");t.addEventListener("message",this._onResponseReceipt),t.start()}))}invoke(e,t){return(0,i.default)(this._conn,"Connection has not been inited"),this._conn.waitForConnection().then((()=>{(0,i.default)(this._conn,"Connection has not been inited");var r=(0,o.default)(this._conn.getPort(),"Port obtained from ConnectionManager after connection"),a=(0,s.genInvocationId)();return r.postMessage((0,n.buildInvocationPayload)({invocationId:a,method:e,args:t})),new Promise(((e,t)=>{this._pending.set(a,{resolve:e,reject:t})}))}))}};t.default=d},70655:(e,t,r)=>{"use strict";var a=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(61883),n=a(r(27246)),s=r(382);var o=new class{constructor(){this._onMessage=(e,t)=>{var r=t.data,a=(0,i.unwrapInvocationPayload)(r);if(null!=a){var{method:o,args:l,invocationId:d}=a;n.get()[o](...l).then((t=>{e.postMessage((0,s.buildResponsePayload)(d,t))}))}}}respondTo(e){e.addEventListener("message",(t=>this._onMessage(e,t))),e.start()}};t.default=o},46181:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.genInvocationId=function(){return r++},t.extractInvocationId=function(e){if(null!=e&&"number"==typeof e)return e};var r=1},27246:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.set=function(e){i=e},t.get=l,t.sendLogs=function(){throw new Error("Not yet implemented")},t.log=void 0;var i,n=a(r(30256)),s=a(r(56028)),o=a(r(21830));function l(){return(0,o.default)(i,"InvocationInterface was not inited")}var d=(0,s.default)(((e,t=!1,r,a,i)=>(s,...o)=>{var d,u=(0,n.default)(s,o,!t);return r&&(d={name:r.name,stack:r.stack}),l().logImpl(e,u,d,a,i),u}),((e,t,r,a,i)=>r||i?null:String(e)+String(Boolean(t))+String(Boolean(a))));t.log=d},30105:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.buildHandshakePayload=function(e){return{__command:n.HANDSHAKE_COMMAND,__port:e}},t.extractPortFromHandshakePayload=function(e){if(null!=e&&null!=e.__command&&e.__command===n.HANDSHAKE_COMMAND){if(null!=e.__port)return(0,i.default)(e.__port instanceof MessagePort,"Malformed connection payload"),e.__port}};var i=a(r(47677)),n=r(88539)},61883:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.buildInvocationPayload=function({invocationId:e,method:t,args:r}){return{__id:e,__command:s.INVOCATION_COMMAND,__method:t,__args:r}},t.unwrapInvocationPayload=function(e){if(null!=e&&e.__command===s.INVOCATION_COMMAND){(0,i.default)(e.__id,"Invocation ID missing");var t=(0,n.extractInvocationId)(e.__id);(0,i.default)(null!=t&&e.__method&&"string"==typeof e.__method&&e.__id&&e.__args&&Array.isArray(e.__args),"Malformed invocation message");var r=e,a=r.__method,o=r.__args;return{method:a,args:o,invocationId:t}}};var i=a(r(47677)),n=r(46181),s=r(88539)},382:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.buildResponsePayload=function(e,t){return{__id:e,__command:s.RESPONSE_COMMAND,__result:t}},t.unwrapResponsePayload=function(e){if(null!=e&&e.__command===s.RESPONSE_COMMAND){(0,i.default)(null!=e.__id,"Invocation ID missing");var t=(0,n.extractInvocationId)(e.__id);return(0,i.default)(null!=t&&e.hasOwnProperty("__result"),"Malformed response message"),{result:e.__result,invocationId:t}}};var i=a(r(47677)),n=r(46181),s=r(88539)},88539:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RESPONSE_COMMAND=t.INVOCATION_COMMAND=t.HANDSHAKE_COMMAND=void 0;t.HANDSHAKE_COMMAND="@@handshake";t.INVOCATION_COMMAND="@@invoke";t.RESPONSE_COMMAND="@@response"},21212:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(52954)),n=a(r(70417)),s=a(r(21830)),o=a(r(49702));t.default=class{constructor(e,t){this._concurrency=e,this._groupLimits=t,this._runningTasksByGroup=new Map,this._enqueuedTasksByGroup=new Map}enqueue(e,t){var r,a,s,o=new Promise(((e,t)=>{r=e,a=t}));return this._doEnqueue((0,n.default)((0,n.default)({},t),{},{run:(s=(0,i.default)((function*(){try{var t=yield e();r(t)}catch(e){a(e)}})),function(){return s.apply(this,arguments)})})),this._runTasks(),o}_doEnqueue(e){this._getOrCreatePriorityQueueForGroup(e.group).push(e)}_doDequeue(){return this._getHighestPriorityAmongGroups()}_runTasks(){for(;this._getRunningTasksCount()<this._concurrency;){var e=this._doDequeue();if(null==e)break;this._runTask(e)}}_runTask(e){var t=this;return(0,i.default)((function*(){var{run:r,signal:a,group:i}=e,n=t._getRunningTasksForGroup(i);if(null==a?void 0:a.aborted)setTimeout(t._runTasks.bind(t),0);else{n.add(e);try{yield r()}finally{n.delete(e),t._runTasks()}}}))()}_getHighestPriorityAmongGroups(){var e,t;for(var r of this._enqueuedTasksByGroup.values()){var a=r.peek();a&&(this._isFullOfGroup(a.group)||(!t||t.priority<a.priority)&&(t=r))}return null===(e=t)||void 0===e?void 0:e.pull()}_getRunningTasksCount(){var e=0;for(var t of this._runningTasksByGroup.values())e+=t.size;return e}_getRunningTasksForGroup(e){if(!this._runningTasksByGroup.has(e)){var t=new Set;return this._runningTasksByGroup.set(e,t),t}return(0,s.default)(this._runningTasksByGroup.get(e),"this._runningTasksByGroup.get(group)")}_isFullOfGroup(e){var t=this._runningTasksByGroup.get(e);return null!=t&&t.size>=this._getLimitForGroup(e)}_getOrCreatePriorityQueueForGroup(e){if(!this._enqueuedTasksByGroup.has(e)){var t=new o.default((e=>-e.priority));this._enqueuedTasksByGroup.set(e,t)}return(0,s.default)(this._enqueuedTasksByGroup.get(e),"this._enqueuedTasksByGroup.get(group)")}_getLimitForGroup(e){var t=this._groupLimits[e];return null==t?1/0:t}}},743:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(70417)),n=a(r(48879)),s=a(r(43419)),o=r(67607).Z;self.URL=self.URL||self.webkitURL,self.AudioContext=self.AudioContext||self.webkitAudioContext,self.requestFileSystem=self.requestFileSystem||self.webkitRequestFileSystem;var l=(0,i.default)({REQUIRED_BROWSER_APIS:{getRandomValues:!(!self.crypto||!self.crypto.getRandomValues),subtleCrypto:!(!self.crypto||!self.crypto.subtle&&!self.crypto.webkitSubtle),localstorage:!!n.default,sessionstorage:!!s.default,url:!!self.URL,websocket:!!self.WebSocket,worker:!!self.Worker},BROWSER_TYPE:{CHROME:"chrome",CHROMIUM:"chromium",FIREFOX:"firefox",SAFARI:"safari",IE:"ie",OPERA:"opera",EDGE:"edge"},BROWSER_LINK:{CHROME:'<a href="https://www.google.com/chrome">Google Chrome</a>',FIREFOX:'<a href="http://www.firefox.com">Mozilla Firefox</a>',OPERA:'<a href="http://www.opera.com">Opera</a>'},OS_TYPE:{WINDOWS:"windows",MAC:"mac os",CHROMEOS:"chromium os"},LATEST_HASH:"95ac6c93ef0a0f58334649b06c7abbe5628ccce2",VERSION:{p:Number("2"),s:Number("2121"),t:Number("6")},VERSION_BASE:"2.2121.6",VERSION_STR:"2.2121.6",DYN_ORIGIN:"https://web.whatsapp.com/",PP_URL:"https://web.whatsapp.com/pp",LOGOUT_URL:"https://web.whatsapp.com/logout",WAM_URL:"https://web.whatsapp.com/wam",GROUP_DEFAULT_ICON:r(38845),USER_DEFAULT_ICON:r(56046),NOTIFICATION_TONE_PATH:r(39509),OUTGOING_MESSAGE_TONE_PATH:r(43686),PTT_MIDDLE_TONE_PATH:r(17109),PTT_END_TONE_PATH:r(79091),DRAG_TYPE_FILE:"Files",KEY_LOCAL_TAKEOVER_OK:"local-takeover-ok",SCROLL_FUDGE:100,PERMISSION_ALLOWED:"granted",PERMISSION_DEFAULT:"default",PERMISSION_DENIED:"denied",QR_EDGE:264,NUX:{SAFARI_LIMITED_SUPPORT:"safari_limited_support",REVOKE_LEGAL_DISCLAIMER_NUX:"revoke_legal_disclaimer_nux",MESSENGER_ROOM_DIALOG_NEW:"messenger_room_dialog_new",MESSENGER_ROOM_DIALOG_RETURNING:"messenger_room_dialog_returning",MESSENGER_ROOM_DIALOG_FROM_CHATLIST:"messenger_room_dialog_from_chatlist",MESSENGER_ROOM_DIALOG_FROM_ATTACH_DROPDOWN:"messenger_room_dialog_from_attach_dropdown",EPHEMERAL:"ephemeral",EPHEMERAL_VIEW_ONCE:"ephemeral_view_once",ARCHIVE:"archive"},TEXTSIZE_CLASS_MAP:[{scale:-1,classname:"textsize-small"},{scale:-2,classname:"textsize-xsmall"},{scale:-3,classname:"textsize-xxsmall"},{scale:1,classname:"textsize-large"},{scale:2,classname:"textsize-xlarge"},{scale:3,classname:"textsize-xxlarge"}],LIST_HEIGHT_TEXTSIZE_MAP:[{scale:-1,height:64},{scale:-2,height:58},{scale:-3,height:52},{scale:1,height:72},{scale:2,height:72},{scale:3,height:72}],MSG_FOCUS_SCROLL_ANIMATION_DURATION:400,WAM_PLATFORM:"WEB",FLB_PLATFORM:"web",APP_ID:"undefined"},o);t.default=l},67607:(e,t)=>{"use strict";t.Z=void 0;var r={CAPABILITY_URL:"https://web.whatsapp.com/browsers.html",STATUS_URL:"https://web.whatsapp.com/status.json",CHECK_UPDATE_URL:"https://web.whatsapp.com/check-update",NOTICE_CONTENT_ENDPOINT_URL:"https://www.whatsapp.com/user-notice/v1/",COOKIE_DOMAIN:".web.whatsapp.com",TICKET_URL:"https://web.whatsapp.com/web-contact-us",GROUP_INVITE_URL:"https://web.whatsapp.com/invite/icon/",GROUP_V4_INVITE_ICON_URL:"https://web.whatsapp.com/invite/v4/icon/",LARGE_EMOJI_URL:"https://web.whatsapp.com/img/",PP_TOK:"/pp",PP_REF:"/pp",UPLOAD_TO_CLB:1,FLAVOR_TAGS:!1,WEB_SOCKET_URL:"wss://web.whatsapp.com/ws",CHATD_WEB_SOCKET_URL:"wss://web.whatsapp.com/ws/chat",LOG_SIZE_ELECTRON:14999,LOG_SIZE_WEB:4999,MEMORY_METRIC_INTERVAL:9e5,MARK_TRANSLATIONS:!1,WAM_ENV:"PROD",WRITE_TO_CONSOLE:!1};t.Z=r},23045:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(70417)),n=a(r(743)),s=a(r(43312)),o=(0,i.default)((0,i.default)({},s.default),n.default);t.default=o},95316:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r={KEYBOARD_EVENT_KEY_VALUE:{UNIDENTIFIED:"Unidentified",ALT:"Alt",ALT_GRAPH:"AltGraph",CAPS_LOCK:"CapsLock",CONTROL:"Control",FN:"Fn",FN_LOCK:"FnLock",HYPER:"Hyper",META:"Meta",NUM_LOCK:"NumLock",SCROLL_LOCK:"ScrollLock",SHIFT:"Shift",SUPER:"Super",SYMBOL:"Symbol",SYMBOL_LOCK:"SymbolLock",OS:"OS",ENTER:"Enter",TAB:"Tab",SPACE:" ",ARROW_DOWN:"ArrowDown",ARROW_LEFT:"ArrowLeft",ARROW_RIGHT:"ArrowRight",ARROW_UP:"ArrowUp",LEFT:"Left",RIGHT:"Right",UP:"Up",DOWN:"Down",END:"End",HOME:"Home",PAGE_DOWN:"PageDown",PAGE_UP:"PageUp",BACKSPACE:"Backspace",CLEAR:"Clear",COPY:"Copy",CR_SEL:"CrSel",CRSEL:"Crsel",CUT:"Cut",DELETE:"Delete",ERASE_EOF:"EraseEof",EX_SEL:"ExSel",EXSEL:"Exsel",INSERT:"Insert",PASTE:"Paste",REDO:"Redo",UNDO:"Undo"}};t.default=r},43312:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r={ARCHIVE_NUX_MAX_VIEWS:3,IMG_THUMB_MAX_EDGE:100,DOC_THUMB_MAX_EDGE:480,VIDEO_THUMB_MAX_EDGE:480,MAX_PORTRAIT_MEDIA_CAPTION_LENGTH:500,MAX_FILES:30,FREQUENTLY_FORWARDED_SENTINEL:127,MAX_SMB_LABEL_COUNT:20,DEFAULT_SMB__NEW_LABEL_COLOR:"#d6d7d7",FB_CLB_TOKEN:"1063127757113399|745146ffa34413f9dbb5469f5370b7af",FB_CLB_CHECK_URL:"https://crashlogs.whatsapp.net/wa_fls_upload_check",FB_CLB_URL:"https://crashlogs.whatsapp.net/wa_clb_data",FAKE_USER_AGENT:"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/60.0.3112.113 Safari/537.36",G_MAPS_DIR_URL:"https://maps.google.com/maps/dir",G_MAPS_IMG_URL:"https://maps.googleapis.com/maps/api/staticmap",G_MAPS_SEARCH_URL:"https://maps.google.com/maps/search",G_MAPS_URL:"https://maps.google.com/maps",G_MAPS_DARK_MODE_STYLE:"style=element:geometry%7Ccolor:0x212121&style=element:labels.icon%7Cvisibility:off&style=element:labels.text.fill%7Ccolor:0x757575&style=element:labels.text.stroke%7Ccolor:0x212121&style=feature:administrative%7Celement:geometry%7Ccolor:0x757575&style=feature:administrative.country%7Celement:labels.text.fill%7Ccolor:0x9e9e9e&style=feature:administrative.land_parcel%7Cvisibility:off&style=feature:administrative.locality%7Celement:labels.text.fill%7Ccolor:0xbdbdbd&style=feature:poi%7Celement:labels.text.fill%7Ccolor:0x757575&style=feature:poi.park%7Celement:geometry%7Ccolor:0x181818&style=feature:poi.park%7Celement:labels.text.fill%7Ccolor:0x616161&style=feature:poi.park%7Celement:labels.text.stroke%7Ccolor:0x1b1b1b&style=feature:road%7Celement:geometry.fill%7Ccolor:0x2c2c2c&style=feature:road%7Celement:labels.text.fill%7Ccolor:0x8a8a8a&style=feature:road.arterial%7Celement:geometry%7Ccolor:0x373737&style=feature:road.highway%7Celement:geometry%7Ccolor:0x3c3c3c&style=feature:road.highway.controlled_access%7Celement:geometry%7Ccolor:0x4e4e4e&style=feature:road.local%7Celement:labels.text.fill%7Ccolor:0x616161&style=feature:transit%7Celement:labels.text.fill%7Ccolor:0x757575&style=feature:water%7Celement:geometry%7Ccolor:0x000000&style=feature:water%7Celement:labels.text.fill%7Ccolor:0x3d3d3d",FB_LEGAL_TERMS_URL:"https://www.facebook.com/legal/terms",FB_COMMERCE_POLICY_URL:"https://www.facebook.com/policies/commerce",WA_COMMERCE_POLICY_URL:"https://www.whatsapp.com/policies/commerce-policy",NOTIFICATION_PROMPT_DELAY:1e4,PTT_PLAYBACK_DELAY:400,NOTIFICATION_TIMEOUT:5e3,CALL_NOTIFICATION_TIMEOUT:45e3,IDLE_TIMEOUT:6e4,IDLE_TIMEOUT_WAIT:78e4,SEARCH_ZOOM:17,SEND_UNAVAILABLE_WAIT:15e3,SEND_PAUSED_WAIT:2500,CLEAR_CHAT_DIRTY_WAIT:2500,LOG_UPLOAD_INTERVAL:36e5,REVOKE_WINDOW:4096,WAM_ROTATE_INTERVAL:300,ALBUM_DIFF_INTERVAL:600,MAX_TXT_MSG_SIZE:65536,INITIAL_PAGE_SIZE:768,FREQUENTLY_FORWARDED_INITIAL_PAGE_SIZE:308,SUBSEQUENT_PAGE_SIZE:3072,OVERFLOWING_PAGE_THRESHOLD:.1,GROUP_DESCRIPTION_INFO_PANEL_TRUNC_LENGTH:100,GROUP_DESCRIPTION_LENGTH:0,INFO_DRAWER_MAX_ROWS:10,NUM_COLORS:20,FTS_MIN_CHARS:2,FTS_TTL:6e4,FTS_TYPING_DELAY:300,FTS_NUM_RESULTS:30,HSM_ASPECT_RATIO:1.91,TEMPLATE_DOC_MIME_TYPES:1,TEMPLATE_URL_START:64,TEMPLATE_URL_END:32,KEY_STORAGE_TEST:"storage_test",KEY_CLIENT_TOKEN:"WAToken1",KEY_SERVER_TOKEN:"WAToken2",KEY_SECRET:"WASecretKey",KEY_SECRET_BUNDLE:"WASecretBundle",KEY_SECURITY_NOTIFICATIONS:"WASecurityNotifications",KEY_BROWSER_ID:"WABrowserId",KEY_GEOCODER_LOCATION:"WAGeocoderLocation",KEY_GROUP_ASSIGNED_COLOR:"WAGroupAssignedColor",KEY_GMAPS_OVER_LIMIT:"WAGmapsOverLimit",KEY_GLOBAL_MUTE_SOUNDS:"WAGlobalSounds",KEY_OUTGOING_MESSAGE_SOUND:"WAOutgoingMessageSound",KEY_GLOBAL_MUTE_NOTIFICATIONS:"WAGlobalNotifications",KEY_GLOBAL_MUTE_IN_APP_NOTIFICATIONS:"WAGlobalInAppNotifications",KEY_GLOBAL_MUTE_PREVIEWS:"WAGlobalPreviews",KEY_GLOBAL_COLLAPSE_MUTED:"WAGlobalCollapseMuted",KEY_NOTIFICATION_SOUND:"WANotificationSound",KEY_LANG:"WALangPref",KEY_LAST_ACTIVE_EMOJI_TAB:"WALastActiveEmojiTab",KEY_LAST_SELECTED_COMPOSE_BOX_PANEL:"WALastActiveComposeBoxPanel",KEY_LAST_CHAT_MUTE_DURATION:"WALastChatMuteDuration",KEY_UNKNOWN_ID:"WAUnknownID",KEY_VERSION:"WAVersion",KEY_LOAD_RETRY_GENERATION:"WALoadRetryGeneration",KEY_WHATSAPP_MUTEX:"whatsapp-mutex",KEY_LAST_WID:"last-wid",KEY_LAST_WID_MD:"last-wid-md",KEY_SAVE_TO_CAMERA_ROLL:"save_to_camera_roll",KEY_SMB_LABEL_COLOR_PALETTE:"smb_label_color_palette",KEY_LAST_PUSHNAME:"last-pushname",KEY_PROTO_VERSION:"WAProtoVersion",KEY_PTT_PLAYBACK_RATE:"WAPttPlaybackRate",KEY_LOG_PREEMPT_CLEAN_UP:"WALogPreemptiveCleanUp",LAST_STATUS_USAGE:"last-status-usage",KEY_MD_OPTED_IN:"md-opted-in",KEY_MOBILE_PLATFORM:"mobile-platform",KEY_REMEMBER_ME:"remember-me",KEY_LOGOUT_TOKEN:"logout-token",KEY_OLD_LOGOUT_CREDS:"old-logout-cred",KEY_NO_TAKEOVER:"no-takeover",KEY_WHATSAPP_LS_VERSION:"ver",KEY_WAM_BUFFER:"wam-buffer",KEY_WAM_INFO:"wam-info",KEY_TIME_SPENT_EVENT:"WaTimeSpentEvent",KEY_VIDEO_VOLUME:"video-volume",KEY_VIDEO_MUTE:"video-mute",KEY_CONTACT_CHECKSUM:"contact-checksum",KEY_USER_PRIVACY_SETTINGS:"user-privacy-settings",KEY_IS_SMB:"is-smb",KEY_COMPOSE_CONTENTS_PREFIX:"compose-contents_",KEY_THEME:"theme",KEY_SYSTEM_THEME_MODE:"system-theme-mode",KEY_ABPROPS:"abprops",KEY_HISTORY_SYNC_EARLIEST_DATE:"history-sync-earliest-date",KEY_SYNCD_DISABLED_DUE_TO_FATAL:"syncd_disabled_due_to_fatal",KEY_SYNCD_FIRST_CLEAR_OR_DELETE:"syncd-first-clear-or-delete",KEY_CONTACT_SYNC_REFRESH:"contact-sync-refresh-seconds",COOKIE_REF:"ref",COOKIE_TOK:"tok",PAGE_SIZE:50,MSG_PRELOAD_THRESHOLD:20,MEDIA_QUERY_LIMIT:50,MIN_PIC_SIDE:192,MAX_PIC_SIDE:640,PROF_PIC_THUMB_SIDE:96,MAX_CAPTION_LENGTH:1024,MAX_CART_MESSAGE_LENGTH:1024,MAX_PRODUCT_SUBTITLE_LENGTH:70,MAX_REPLY_PRODUCT_TITLE_LENGTH:40,MAX_REPLY_PRODUCT_DESC_LENGTH:95,ALBUM_MIN_SIZE:4,ALBUM_MAX_SIZE:102,ALBUM_MAX_HEIGHT:168,ALBUM_PADDING:3,PRESENCE_COMPOSING_TIMEOUT:25e3,PRESENCE_RESEND_WAIT:1e4,MIMETYPE_OGG:"audio/ogg",IMAGE_MIMES:"image/*",WEBP_MIMES:"image/webp",VIDEO_MIMES:"video/mp4,video/3gpp,video/quicktime",KEY_LOG_CURSOR:"debugCursor",MAX_STATUS_LENGTH:139,MAX_PUSHNAME_LENGTH:25,DISP_TYPE:{CONVERSATION:"CONVERSATION",MSG_INFO:"MSG_INFO",STARRED_MSGS:"STARRED_MSGS",GALLERY:"GALLERY",REPLY_STAGE:"REPLY_STAGE",QUOTED_MSG:"QUOTED_MSG",CONTACT_CARD:"CONTACT_CARD",ORDER:"ORDER"},SEND_LOGS_MAX_EMAIL_LENGTH:320,SEND_LOGS_MAX_SUBJECT_LENGTH:50,SEND_LOGS_MIN_DESC_LENGTH:10,SEND_LOGS_MAX_DESC_LENGTH:500,SEND_LOGS_MAX_SCREENSHOTS:3,SEND_LOGS_MAX_SCREENSHOT_SIZE:10485760,CONTACT_US_MIN_DESC_LENGTH:10,CONTACT_US_MAX_DESC_LENGTH:5e3,ACK:{MD_DOWNGRADE:-7,INACTIVE:-6,CONTENT_UNUPLOADABLE:-5,CONTENT_TOO_BIG:-4,CONTENT_GONE:-3,EXPIRED:-2,FAILED:-1,CLOCK:0,SENT:1,RECEIVED:2,READ:3,PLAYED:4,PEER:5},ACK_STRING:{SENDER:"sender",DELIVERY:"delivery",READ:"read",PLAYED:"played",INACTIVE:"inactive"},RETRY:{VALIDATE_OLD_SESSION:2,MAX_RETRY:5},KEY_BUNDLE_TYPE:"",EDIT_ATTR:{REVOKE:7},DEVICE:{PRIMARY_DEVICE:0,PRIMARY_VERSION:0},BATTERY_LOW_THRESHOLD_1:15,BATTERY_LOW_THRESHOLD_2:5,BATTERY_DELAY:1e4,WAM_MAX_BUFFER_SIZE:5e4,SOCKET_STATE:{OPENING:"OPENING",PAIRING:"PAIRING",UNPAIRED:"UNPAIRED",UNPAIRED_IDLE:"UNPAIRED_IDLE",CONNECTED:"CONNECTED",TIMEOUT:"TIMEOUT",CONFLICT:"CONFLICT",UNLAUNCHED:"UNLAUNCHED",PROXYBLOCK:"PROXYBLOCK",TOS_BLOCK:"TOS_BLOCK",SMB_TOS_BLOCK:"SMB_TOS_BLOCK",DEPRECATED_VERSION:"DEPRECATED_VERSION"},SOCKET_STREAM:{DISCONNECTED:"DISCONNECTED",SYNCING:"SYNCING",RESUMING:"RESUMING",CONNECTED:"CONNECTED"},COLLECTION_HAS_SYNCED:"collection_has_synced",NEW_MSG_SENT:"new_msg_sent",DIAGNOSTIC_DELAY:18e3,ONE_BY_ONE_TRANS_GIF:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",DEFAULT_CHAT_WALLPAPER:"default_chat_wallpaper",L10N_PRIORITY:{SAVED:6,PHONE:5,PREVIOUS:4,URL:3,BROWSER:2,DEFAULT:1},RENDER_CURSOR:{RECENT_AT_TOP:"recent_at_top",RECENT_AT_BOTTOM:"recent_at_bottom",CONVERSATION:"conversation",GROUP_CONVERSATION:"group_conversation",STARRED_DRAWER:"starred_drawer"},SECURITY_LINK:"https://www.whatsapp.com/security/",SMB_TOS_LEARN_MORE_LINK:"https://www.whatsapp.com/legal/small-business-terms/",SERVER_WID:"server@c.us",PSA_WID:"0@c.us",STATUS_WID:"status@broadcast",OFFICIAL_BIZ_WID:"16505361212@c.us",VISIBILITY:{ABOVE:"above",VISIBLE:"visible",BELOW:"below"},VIDEO_STREAM_URL:"/stream/video",SPELL_CHECK_SKIP_WORDS:{en_us:new Set(["ain","couldn","didn","doesn","hadn","hasn","mightn","mustn","needn","oughtn","shan","shouldn","wasn","weren","wouldn","Ain","Couldn","Didn","Doesn","Hadn","Hasn","Mightn","Mustn","Needn","Oughtn","Shan","Shouldn","Wasn","Weren","Wouldn"]),en_gb:new Set(["ain","couldn","didn","doesn","hadn","hasn","mightn","mustn","needn","oughtn","shan","shouldn","wasn","weren","wouldn","Ain","Couldn","Didn","Doesn","Hadn","Hasn","Mightn","Mustn","Needn","Oughtn","Shan","Shouldn","Wasn","Weren","Wouldn"]),en:new Set(["ain","couldn","didn","doesn","hadn","hasn","mightn","mustn","needn","oughtn","shan","shouldn","wasn","weren","wouldn","Ain","Couldn","Didn","Doesn","Hadn","Hasn","Mightn","Mustn","Needn","Oughtn","Shan","Shouldn","Wasn","Weren","Wouldn"])},GROUP_INVITE_LINK_URL:"https://chat.whatsapp.com/",GROUP_SETTING_TYPE:{ANNOUNCEMENT:"announcement",RESTRICT:"restrict",NO_FREQUENTLY_FORWARDED:"no_frequently_forwarded",EPHEMERAL:"ephemeral"},GROUP_SETTING_TO_METADATA:{announcement:"announce",restrict:"restrict",no_frequently_forwarded:"noFrequentlyForwarded",ephemeral:"ephemeralDuration"},L10N:{DEFAULT:"en"},EMOJI:{BUCKET_SIZE:25,CATEGORIES:{SMILEYS_PEOPLE:"SMILEYS_PEOPLE",ANIMALS_NATURE:"ANIMALS_NATURE",FOOD_DRINK:"FOOD_DRINK",ACTIVITY:"ACTIVITY",TRAVEL_PLACES:"TRAVEL_PLACES",OBJECTS:"OBJECTS",SYMBOLS:"SYMBOLS",FLAGS:"FLAGS"},CATEGORY_MAPPING:{"Smileys & People":"SMILEYS_PEOPLE","Animals & Nature":"ANIMALS_NATURE","Food & Drink":"FOOD_DRINK",Activity:"ACTIVITY","Travel & Places":"TRAVEL_PLACES",Objects:"OBJECTS",Symbols:"SYMBOLS",Flags:"FLAGS"},ORDERED_CATEGORY_IDS:["SMILEYS_PEOPLE","ANIMALS_NATURE","FOOD_DRINK","ACTIVITY","TRAVEL_PLACES","OBJECTS","SYMBOLS","FLAGS"],EMOJI_TYPE:{APPLE:"APPLE",WHATSAPP:"WHATSAPP"},LARGE_EMOJI_BASE_PATH:"/img",LARGE_EMOJI_ELECTRON_BASE_PATH:"img",EMOJI_SPRITES_BASE_PATH:"/img",EMOJI_SPRITES_ELECTRON_BASE_PATH:"img"},SYSTEM_MESSAGE_TYPES:["notification","notification_template","group_notification","gp2","broadcast_notification","e2e_notification","call_log","protocol"],MSG_TYPE:{NOTIFICATION:"notification",NOTIFICATION_TEMPLATE:"notification_template",GROUP_NOTIFICATION:"group_notification",GP2:"gp2",BROADCAST_NOTIFICATION:"broadcast_notification",E2E_NOTIFICATION:"e2e_notification",CALL_LOG:"call_log",PROTOCOL:"protocol",CHAT:"chat",LOCATION:"location",PAYMENT:"payment",VCARD:"vcard",CIPHERTEXT:"ciphertext",MULTI_VCARD:"multi_vcard",REVOKED:"revoked",OVERSIZED:"oversized",GROUPS_V4_INVITE:"groups_v4_invite",HSM:"hsm",TEMPLATE_BUTTON_REPLY:"template_button_reply",DEBUG:"debug",IMAGE:"image",VIDEO:"video",AUDIO:"audio",PTT:"ptt",STICKER:"sticker",DOCUMENT:"document",PRODUCT:"product",ORDER:"order",LIST:"list",LIST_RESPONSE:"list_response",BUTTONS_RESPONSE:"buttons_response",UNKNOWN:"unknown"},TEMPLATE_BUTTON_SUBTYPE:{QUICK_REPLY:"quick_reply",CALL:"call",URL:"url"},ELECTRON_PREF:{LAST_SAVED_LOCATION:"lastSavedLocation",CONTENT_SETTINGS:"contentSettings"},TOUCHBAR_MAX_EMOJIS:8,VERIFIED_LEVEL:{UNKNOWN:0,LOW:1,HIGH:2},HOSTNAME:{YOUTUBE:"youtube.com",YOUTUBE_MOBILE:"m.youtube.com",YOUTUBE_SHORTENED:"youtu.be",INSTAGRAM:"instagram.com",STREAMABLE:"streamable.com",FACEBOOK:"facebook.com",FBWATCH:"fbwat.ch",FBWATCH_ALT:"fb.watch",LASSOVIDEOS:"lassovideos.com",LASSO_SHORTENED:"las.so",SHARECHAT:"sharechat.com"},WHATSAPP_ORIGIN:"https://whatsapp.com",SMB_SEARCH_FILTERS:{UNREAD:"unread",GROUP:"group",BROADCAST:"broadcast"},SMB_LABELS:{MAX_LABEL_LENGTH:100},PRODUCT_INQUIRY_TYPE:"product_inquiry",PRODUCT_LIST_ITEM_HEIGHT:96,LOADABLE_DELAY:200,TAB_ORDERS:{CHAT_STARRED_DRAWER:3,CHAT_LIST_SEARCH:3,CHAT_LIST:4,CHAT_CONTACT_LIST:4,CHAT_IMAGE_GALLERY:4,CHAT_SEARCH_MSG_LIST:4,PANEL_SEARCH_INPUT:5,COMPOSE_BOX_MENU_BUTTON:5,COMPOSE_BOX_INPUT:6,PTT_BUTTON:7,MESSAGE_LIST:8,CHAT_HEADER_BUTTON:9},SPEEDY_RESUME_MAX_CHATS:5e3,MEDIA_VIEWER:{ANIMATION_DURATION:500,CLOSE_ANIMATION_DURATION:200,ZOOM_IN_FACTOR:2},DEFAULT_THEME:"light",LAYOUT_2COLUMNS_MAX_WIDTH:1024,MUTE_ALWAYS_EXPIRATION_SENTINEL:-1,ANDROID_LABEL_COLOR_PALETTE:["#FF9485","#64C4FF","#FFD429","#DFAEF0","#99B6C1","#55CCB3","#FF9DFF","#D3A91D","#6D7CCE","#D7E752","#00D0E2","#FFC5C7","#93CEAC","#F74848","#00A0F2","#83E422","#FFAF04","#B5EBFF","#9BA6FF","#9368CF"],IPHONE_LABEL_COLOR_PALETTE:["#A62C71","#90A841","#C1A03F","#792138","#AE8774","#F0B330","#B6B327","#C69FCC","#8B6990","#FF8A8C","#54C265","#FF7B6B","#26C4DC","#57C9FF","#74676A","#7E90A3","#5696FF","#6E257E","#7ACBA5","#243640"],VOIP_LOG_COLOR:"#aa6627",VOIP_MAC_MINIMUM_OS_RELEASE_VERSION:"17.0.0",VOIP_WIN_MINIMUM_OS_RELEASE_VERSION:"10.0.18362",VOIP_MAX_GROUP_CALL_PARTICIPANTS:8,WAM_SYS_INFO_INIT_DELAY:5e3,KEY_NOTICE_BANNER_CLOSED_AT:"notice-banner-closed-at",KEY_NOTICE_ID:"notice-id",MARKED_AS_UNREAD:-1,MAS_APP_IDENTIFIER:"57T9237FN3.desktop.WhatsApp"};t.default=r},1509:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MMS_URL_MEDIA_TYPE_SEARCH_PARAM=t.IS_MMS_URL_SEARCH_PARAM=void 0;t.IS_MMS_URL_SEARCH_PARAM="__wa-mms";t.MMS_URL_MEDIA_TYPE_SEARCH_PARAM="mms-type"},27372:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SpamFlow=void 0;var a=r(28103)({Chat:"chat",Account:"account_info",Group:"group_info",Block:"block_dialog",Dropdown:"overflow_menu"});t.SpamFlow=a},87538:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(52954)),n=a(r(13329)),s=a(r(43079)),o=a(r(21830)),l=a(r(18165));var d=new class{constructor(){this._pendingMap=new Map}_ensureWorkerInited(){this._worker||(l.default.onerror=e=>{this._onWorkerError(e)},l.default.onmessageerror=e=>{this._onMessageError(e)},l.default.onmessage=e=>{var t=e.data;this._onWorkerResponse(t)},this._worker=l.default)}_onMessageError(){}_onWorkerError(e){__LOG__(3)`FTS:client: worker error: ${e}`}_onWorkerResponse(e){var{reqId:t}=e,r=this._pendingMap.get(t);r&&(e.error?(__LOG__(3)`FTS:client: worker completed job ${r.command.operation} with error`,r.reject(new Error("FTS worker error"))):r.resolve(e.result),this._untrackInvocation(t))}startIndexer(){return this._runCommand({operation:"start-indexer"})}indexFull(){return this._runCommand({operation:"run"})}index(){return this._runCommand({operation:"consume"})}purge(e){return this._runCommand({operation:"purge",ids:e})}reInit(){return this._runCommand({operation:"re-init"})}clearInitializationPromises(){return this._runCommand({operation:"clear-init"})}search(e,t){var r=this;return(0,i.default)((function*(){var a=yield r._runCommand({operation:"find",query:e,queryOptions:t});return r._coerceToSearchResult(a)}))()}_coerceToSearchResult(e){var t=this;return(0,i.default)((function*(){if(Array.isArray(e)||"boolean"==typeof e)return{canceled:!1,eof:!0,status:404,messages:[]};var{resolved:r,unresolved:a}=yield(0,s.default)(e.messages),{eof:i,status:n}=e;return a.length>0&&t.purge(a),{canceled:!1,eof:i,status:n,messages:r}}))()}_runCommand(e){this._ensureWorkerInited();var t=(0,n.default)();return new Promise(((r,a)=>{this._pendingMap.set(t,{resolve:r,reject:a,command:e}),this._message({command:e,reqId:t})})).finally((()=>{this._untrackInvocation(t)}))}_untrackInvocation(e){this._pendingMap.delete(e)}_message(e){(0,o.default)(this._worker,"this._worker").postMessage(e)}};t.default=d},43079:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){if(i.default.supportsFeature(i.default.F.MD_BACKEND))return(0,n.getTable)().bulkGet(e).then((t=>{var r=[],a=[];return t.forEach(((t,i)=>{t?r.push((0,s.hydrateMessage)(t)):a.push(e[i])})),{resolved:r,unresolved:a}}));return Promise.resolve({resolved:[],unresolved:[]})};var i=a(r(20468)),n=r(43730),s=r(44042)},13329:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return r++};var r=0},20468:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.getProtobufFeatureName=S,t.default=t.FEATURE_CHANGE_EVENT=void 0;var i=a(r(54073)),n=a(r(18149)),s=a(r(99686)),o=a(r(54004)),l=a(r(75652)),d=a(r(35676)),u=a(r(57370)),c=a(r(98537)),p=a(r(10017)),h=a(r(71107)),f=r(13185),_=r(94781),m=(0,p.default)(Object.keys(_.WebFeaturesSpec.internalSpec).map((e=>[S(e),!1]))),g=!1,v={RESEND_ICON:!1,MEDIA_EDITOR:!1,DELETE_MSG_CLEAR_MEDIA:!0,DEBUG_COMMANDS:!1,MD_BACKEND:g,MD_ADV:g,MD_PAYMENT:!1,MD_E2E:!1,MD_VOIP_GROUP:g,MD_SYNCD_ANTI_TAMPERING:g,CATALOG_MANAGER:!1,WEB_VOIP_VOICE_CALL:!1,WEB_VOIP_VIDEO_CALL:!1,DOWNLOAD_STATUS_THUMB_MMS:!1,MEDIA_EXISTENCE_CHECK:!1,LOG_MISSING_REQUIRED_PROPERTIES:!1,MEDIA_CUSTOM_CROPPING:!0,HIGH_QUALITY_VIDEO_THUMBNAILS:!1,PORTRAIT_MEDIA_LONG_CAPTIONS:!1},E=[[(0,c.default)(v,m),{},{},{},{ARCHIVE_BROADCAST:!0},{RECENT_EMOJI_SYNC:!0},{},{},{},{QUERY_IDENTITY:!1},{},{STARRED_GIFS:!1,INDEX_RECEIVED_VCARD:!1},{STATUS_V3_UI_SENDING:!1},{MEDIAS_COUNT:!1},{},{VOIP_VOICE_CALL:!0},{DESKTOP_VOIP_VOICE_CALL:!0,DESKTOP_VOIP_VIDEO_CALL:!0,DESKTOP_VOIP_GROUP_VOICE_CALL:!1,DESKTOP_VOIP_GROUP_VIDEO_CALL:!1}]],y={KEY_PARTICIPANT:!1,RICH_TEXT:!0};function S(e){return(0,u.default)(e).toUpperCase()}var T="feature_change";t.FEATURE_CHANGE_EVENT=T;class A extends h.default{constructor(){super(),this.FEATURE_CHANGE_EVENT=T,this.silenceChangeEvents=!0,this.triggerFeaturesChangedDebounced=(0,i.default)((()=>{this.supportsFeature(this.F.MD_BACKEND)&&((0,f.setGKProto)(this.proto),(0,f.setGKFeatures)(this.features)),this.trigger(T)}),50),this.features={};var e=(0,d.default)((0,d.default)(E).map(Object.keys)).concat(Object.keys(y));this.F=(0,p.default)((0,l.default)(e).map((e=>[e,e]))),this.setVersion([0,0]),this.silenceChangeEvents=!1}setVersion(e){if(!this.proto||this.proto.length!==e.length||this.proto[0]!==e[0]||this.proto[1]!==e[1]){this.proto=e;var t=E.slice(0,e[0]+1),r=E.slice(e[0]+1,E.length),a=t[e[0]],i=a.slice(0,e[1]+1),l=a.slice(e[1]+1,a.length);t[e[0]]=i,r.unshift(l);var u=(0,o.default)(this.features);this.features=(0,c.default)((0,s.default)((0,c.default)({},...(0,d.default)(t)),(e=>!e)),this.features||{});var h=(0,c.default)({},...(0,d.default)(r));this.features=(0,s.default)(this.features,((e,t)=>!!h[t])),this.VF=(0,p.default)(Object.keys((0,c.default)({},...(0,d.default)(t))).map((e=>[e,e]))),(0,n.default)(u,this.features)||this.triggerFeaturesChanged()}}setPlatform(e){var t=!1;switch(e){case"iphone":t=!1!==this.features.RECENT_EMOJI_SYNC||!1!==this.features.ARCHIVE_BROADCAST||!0!==this.features.RESEND_ICON||!1!==this.features.DELETE_MSG_CLEAR_MEDIA,this.features.RECENT_EMOJI_SYNC=!1,this.features.ARCHIVE_BROADCAST=!1,this.features.RESEND_ICON=!0,this.features.DELETE_MSG_CLEAR_MEDIA=!1;break;case"symbian":case"s40":case"bb":t=!1!==this.features.CHAT_MARK_UNSEEN,this.features.CHAT_MARK_UNSEEN=!1}t&&this.triggerFeaturesChanged()}setFeatureFromFlags(e,t,r){var a=!1;switch(r){case _.WebFeaturesFlag.FORCE_UPGRADE:switch(t){case _.WebFeaturesFlag.FORCE_UPGRADE:a=!0;break;case _.WebFeaturesFlag.PRODUCTION:case _.WebFeaturesFlag.DEVELOPMENT:case _.WebFeaturesFlag.NOT_STARTED:a=!1,__LOG__(4,void 0,new Error,!0)`wap:features:${e} phone value is ${r} and web value is ${t}.`,SEND_LOGS("wap_feature_unreachable_code")}break;case _.WebFeaturesFlag.PRODUCTION:switch(t){case _.WebFeaturesFlag.FORCE_UPGRADE:a=!1,__LOG__(4,void 0,new Error,!0)`wap:features:${e} phone value is ${r} and web value is ${t}.`,SEND_LOGS("wap_feature_unexpected");break;case _.WebFeaturesFlag.PRODUCTION:a=!0;break;case _.WebFeaturesFlag.DEVELOPMENT:case _.WebFeaturesFlag.NOT_STARTED:a=!1}break;case _.WebFeaturesFlag.DEVELOPMENT:switch(t){case _.WebFeaturesFlag.FORCE_UPGRADE:case _.WebFeaturesFlag.PRODUCTION:case _.WebFeaturesFlag.DEVELOPMENT:case _.WebFeaturesFlag.NOT_STARTED:a=!1}break;case _.WebFeaturesFlag.NOT_STARTED:a=!1}var i=S(e);return this.setFeature(i,a)}setFeature(e,t){var r;r=!!t;var a=this.features[e]!==r;return this.features[e]=r,a&&this.triggerFeaturesChanged(),a}setFeatures(e){var t={},r=(0,c.default)({},y,e);for(var a in r)a in this.VF||(t[a]=this.setFeature(a,r[a]));return t}supportsFeature(e){return!!this.features[e]}supportsFeatureFromFlags(e){var t=S(e);return this.supportsFeature(t)}supportsAllFeatures(...e){return e.every((e=>!!this.features[e]))}supportsAnyFeature(...e){return e.some((e=>!!this.features[e]))}resetFeatures(){this.proto=[0,0],this.features={},this.triggerFeaturesChanged()}lt(e){var t=this.proto;return e[0]>t[0]||e[0]===t[0]&&e[1]>t[1]}lte(e){var t=this.proto;return e[0]>t[0]||e[0]===t[0]&&e[1]>=t[1]}gt(e){var t=this.proto;return e[0]<t[0]||e[0]===t[0]&&e[1]<t[1]}gte(e){var t=this.proto;return e[0]<t[0]||e[0]===t[0]&&e[1]<=t[1]}triggerFeaturesChanged(){this.silenceChangeEvents||this.triggerFeaturesChangedDebounced()}overwriteDebugGKs(){}isThirdPartyStickersEnabled(){return this.supportsAllFeatures(this.F.THIRD_PARTY_STICKERS,this.F.MEDIA_UPLOAD)}isRecentStickersEnabled(){return this.supportsAnyFeature(this.F.RECENT_STICKERS_V_2,this.F.RECENT_STICKERS_V_3)&&this.supportsFeature(this.F.MEDIA_UPLOAD)}isStarredStickersEnabled(){return this.supportsFeature(this.F.STARRED_STICKERS)&&this.isRecentStickersEnabled()}isCatalogManagerEnabled(){return this.supportsAllFeatures(this.F.CATALOG_MANAGER,this.F.MD_BACKEND)}isEphemeralAllowGroupMembersEnabled(){if(this.supportsFeature(this.F.MD_BACKEND)){var{getABPropConfigValue:e}=r(71796);return e("ephemeral_allow_group_members")}return this.supportsFeature(this.F.EPHEMERAL_ALLOW_GROUP_MEMBERS)}isEphemeral24HDurationEnabled(){if(this.supportsFeature(this.F.MD_BACKEND)){var e,{getABPropConfigValue:t}=r(71796);return null!==(e=t("ephemeral_24h_duration"))&&void 0!==e&&e}return this.supportsFeature(this.F.EPHEMERAL_24_H_DURATION)}}var b=new A;t.default=b},9690:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.canDisplayLabel=function(){if(n.default.supportsFeature(n.default.F.MD_BACKEND))return i.default.isSMB;return n.default.supportsFeature(n.default.F.LABELS_DISPLAY)},t.canEditLabelAssociation=function(){if(n.default.supportsFeature(n.default.F.MD_BACKEND))return i.default.isSMB;return n.default.supportsFeature(n.default.F.LABELS_EDIT)},t.canEditLabel=function(){if(n.default.supportsFeature(n.default.F.MD_BACKEND))return!1;return n.default.supportsFeature(n.default.F.LABELS_EDIT)},t.canSendQuickReply=function(){if(n.default.supportsFeature(n.default.F.MD_BACKEND))return i.default.isSMB;return n.default.supportsFeature(n.default.F.QUICK_REPLIES_QUERY)},t.bspUiEnabled=function(){return s.default.bspUi},t.buttonsMessagesEnabled=function(){return s.default.webButtonsMessage},t.archiveV2Supported=function(){return n.default.supportsFeature(n.default.F.ARCHIVE_V_2)},t.canEditBizProfile=function(){if(o.has("BIZ_PROFILE_EDIT"))return!0;return i.default.isSMB&&s.default.webBizProfileEdit},t.canSeeSMBUpsell=function(){return s.default.webSMBUpsellInBizProfile},t.productListMessagesEnabled=function(){return s.default.webProductListMessage&&!1},t.productListMessageFallbackEnabled=function(){return s.default.webProductListMessageFallback},t.canSeeBizProfileV3=function(){if(o.has("BIZ_PROFILE_V3"))return!0;return!1},t.cartPropEnabled=function(){return s.default.webCart},t.canViewCollections=function(){return s.default.webCollectionsDisplay},t.canManageCollections=function(){return s.default.webCollectionsManagement};var i=a(r(79435)),n=a(r(20468)),s=a(r(54559)),o=new Set([])},83821:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r={pt:"pt_br",pt_ao:"pt",pt_ch:"pt",pt_cv:"pt",pt_fr:"pt",pt_gq:"pt",pt_gw:"pt",pt_lu:"pt",pt_mo:"pt",pt_mz:"pt",pt_pt:"pt",pt_st:"pt",pt_tl:"pt",zh_hans:"zh_cn",zh_hant:"zh_tw",zh_sg:"zh_cn",tl:"fil"};t.default=r},95418:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r={af:"af",ar:"ar",ar_xb:"ar-XB",az:"az",bg:"bg",bn:"bn",ca:"ca",cs:"cs",da:"da",de:"de",el:"el",en:"en",es:"es",et:"et",fa:"fa",fi:"fi",fil:"fil",fr:"fr",gu:"gu",he:"he",hi:"hi",hr:"hr",hu:"hu",id:"id",it:"it",ja:"ja",kk:"kk",kn:"kn",ko:"ko",lt:"lt",lv:"lv",mk:"mk",ml:"ml",mr:"mr",ms:"ms",nb:"nb",nl:"nl",pa:"pa",pl:"pl",pt:"pt",pt_br:"pt-BR",ro:"ro",ru:"ru",sk:"sk",sl:"sl",sq:"sq",sr:"sr",sv:"sv",sw:"sw",ta:"ta",te:"te",th:"th",tr:"tr",uk:"uk",ur:"ur",uz:"uz",vi:"vi",zh_cn:"zh-CN",zh_hk:"zh-HK",zh_tw:"zh-TW"};t.default=r},97018:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(35160),i=[],n=new a.ShiftTimer((function(){var e=i;i=[];for(var t=0;t<e.length;t++){var r=e[t];r._inAutoreleasePool=!1,0!==r._retainCount||r.released||(r.released=!0,r._releaseImpl())}}));t.default=class{constructor(){this._retainCount=1,this._inAutoreleasePool=!1,this.released=!1}retain(){if(this.released)throw __LOG__(3)`OpaqueData:retain called on released OpaqueData`,new Error("OpaqueData:retain called on released OpaqueData");this._retainCount++}autorelease(){this.released?__LOG__(3)`OpaqueData:autorelease called on released object`:0===this._retainCount?__LOG__(3)`OpaqueData:autorelease too many release calls`:1===this._retainCount?(this._retainCount=0,this._inAutoreleasePool||(this._inAutoreleasePool=!0,i.push(this),n.onOrBefore(1e3))):this._retainCount--}autoreleaseWhenPromiseCompletes(e){var t=()=>{this.autorelease()};e.then(t,t)}throwIfReleased(e){if(this.released)throw __LOG__(4,void 0,new Error)`${e} called on released OpaqueData`,new Error(`${e} called on released OpaqueData`);0===this._retainCount&&__LOG__(4,void 0,new Error)`${e} called on unretained OpaqueData`}_releaseImpl(){throw new Error("OpaqueData:_releaseImpl unimplemented")}}},50581:(e,t)=>{"use strict";function r(e){if(!e)return e;var t=e.replace(/[\u202a-\u202e\u2066-\u2069\u200E\u200F\u061C]/g,""),r=t.split(".");if(1===r.length)return t;for(var a=r.length-1;a>0;a--){var i=r[a].trim();if(i.length)return r.slice(0,a).join(".")+"."+i}return t}Object.defineProperty(t,"__esModule",{value:!0}),t.cleanFilename=r,t.cleanIncomingFilename=function(e){if(!e)return e;var t=r(e);if(e!==t&&t){var a=t.split("."),i=a.length>=2&&a.pop();["bat","exe","cmd","com","lnk","pif","scr","vb","vbe","vbs","wsh","js","ps1","hta","sh","csh","msi","app","scpt","applescript","reg","vbe","wsf","sct"].includes(i)&&__LOG__(2,!0)`cleanIncomingFilename:extension: ${i||""}`}return t}},25332:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.getImageWidthHeight=function(e){return j((t=>{var r;return t(e),new Promise(((t,a)=>{(r=new Image).onload=t,r.onabort=()=>{a(new Error("getImageWidthHeight onabort"))},r.onerror=()=>{a(new Error("getImageWidthHeight onerror"))},r.src=e.url()})).then((()=>({width:r.naturalWidth,height:r.naturalHeight})))}))},t.getImageWidthHeightNoOpaque=D,t.opaqueDataToArrayBuffer=function(e){return j((t=>{t(e);var r=e._blob;if(r)return N(r);var a=e._b64;return(0,d.decodeB64)(a)}))},t.decodeWebpToRGBANoOpaque=L,t.parseWebpNoOpaque=k,t.videoWidthHeightDuration=function(e){return j((t=>(t(e),T.videoWidthHeightDuration(e.forceToBlob()))))},t.videoWidthHeightDurationNoOpaque=U,t.processRawImage=function(){return F.apply(this,arguments)},t.processRawAudioVideo=function(){return x.apply(this,arguments)},t.getRawDocumentMimetype=B,t.processRawDocument=function(){return K.apply(this,arguments)},t.fetchMedia=function(e){return(0,E.default)(e,"GET",null,R.default.RESP_TYPE.ARRAY_BUFFER).then((e=>e?Promise.resolve({result:e.response,status:e.status}):Promise.resolve(null)))},t.canPlayOgg=function(){return!!T.canPlayOgg},t.gatherAndSetMetadata=function(){return W.apply(this,arguments)},t.gatherAndSetMetadataNoOpaque=function(e,t){return Promise.resolve().then((()=>{switch(e.type){case b.TYPE.VIDEO:return U(t).then((e=>({fullWidth:e.width,fullHeight:e.height,duration:void 0!==e.duration?`${Math.ceil(e.duration)}`:void 0,durationFloat:e.duration})));case b.TYPE.IMAGE:return null!=e.contentInfo.fullHeight&&null!=e.contentInfo.fullWidth&&e.size===t.size?null:D(t).then((e=>({fullWidth:e.width,fullHeight:e.height,size:t.size})));case b.TYPE.STICKER:return(0,f.default)().then((e=>e?(0,l.promiseProps)({widthHeight:D(t),webpData:k(t)}).then((e=>({fullWidth:e.widthHeight.width,fullHeight:e.widthHeight.height,animationDuration:e.webpData.animationDuration,firstFrameLength:e.webpData.firstFrameLength,singleLoopDuration:e.webpData.singleLoopDuration,emojis:e.webpData.emojis,isAnimated:e.webpData.animationDuration>0,size:t.size}))):k(t).then((({animationDuration:e,firstFrameLength:r,singleLoopDuration:a,emojis:i})=>e>0?{animationDuration:e,firstFrameLength:r,singleLoopDuration:a,emojis:i,isAnimated:!0,size:t.size}:L(t).then((r=>({animationDuration:e,rgbaBuffer:r.rgbaBuffer,rgbaWidth:r.width,rgbaHeight:r.height,size:t.size})))))));case b.TYPE.AUDIO:default:return{}}})).catchType(m.MediaUnsupportedError,(t=>{throw e.consolidate({}),t})).then((t=>{null!=t&&e.consolidate(t)}))},t.shouldUseMediaCache=function(e){return e===A.default.STICKER||e===A.default.IMAGE||e===A.default.PRODUCT||e===A.default.PTT||e===A.default.AUDIO},t.shouldUseLruMediaStore=function(e){var t=e===A.default.STICKER||e===A.default.IMAGE,r=e===A.default.AUDIO||e===A.default.DOCUMENT||e===A.default.GIF||e===A.default.PPIC||e===A.default.PRODUCT||e===A.default.PTT||e===A.default.VIDEO||e===A.default.TEMPLATE||e===A.default.THUMBNAIL_DOCUMENT||e===A.default.THUMBNAIL_IMAGE||e===A.default.THUMBNAIL_LINK||e===A.default.THUMBNAIL_VIDEO;return(t||r)&&(0,v.getRememberMe)()},t.getResizedThumbData=function(e,t,r,a,i){return new Promise((n=>{var s=new Image;s.setAttribute("crossorigin","anonymous"),s.onload=()=>{var e,o,l=document.createElement("canvas"),d=l.getContext("2d"),u=0,c=0;if(l.width=t,l.height=r,s.height>s.width){var p=s.height/s.width;e=t,c=-((o=p*t)-r)/2}else{var h=s.width/s.height;o=r,u=-((e=h*r)-t)/2}d.drawImage(s,u,c,e,o),n(l.toDataURL(a,i))},s.src=e}))};var n=i(r(70417)),s=i(r(52954)),o=r(76331),l=r(9737),d=r(84337),u=i(r(5025)),c=r(50581),p=i(r(23045)),h=i(r(10258)),f=i(r(17153)),_=a(r(66617)),m=a(r(24461)),g=r(48537),v=r(66239),E=i(r(84296)),y=a(r(64453)),S=r(19552),T=a(r(28119)),A=i(r(79843)),b=r(60301),C=r(6353),P=i(r(93013)),O=i(r(57436)),w=i(r(54559)),M=i(r(22006)),I=r(65999),R=i(r(1876));function D(e){return new Promise(((t,r)=>{var a=new Image,i=window.URL.createObjectURL(e);a.onload=()=>{var e={width:a.naturalWidth,height:a.naturalHeight};window.URL.revokeObjectURL(i),t(e)},a.onabort=()=>{window.URL.revokeObjectURL(i),r(new Error("getImageWidthHeight onabort"))},a.onerror=()=>{window.URL.revokeObjectURL(i),r(new Error("getImageWidthHeight onerror"))},a.src=i}))}function N(e){return(0,g.blobToArrayBuffer)(e).catch((e=>{throw __LOG__(3)`MediaUtils error: ${e}`,e}))}function L(e){return N(e).then((e=>(0,h.default)(e)))}function k(e){return N(e).then(O.default)}function U(e){return T.videoWidthHeightDuration(e)}function G(e,t){return j((r=>(r(e),T.transcode(e.forceToBlob(),t).then((e=>P.default.createFromData(e,e.type))).then((e=>(r(e),e.autorelease(),e))))))}function F(){return(F=(0,s.default)((function*(e){var t=e.forceToBlob(),{width:r,height:a,images:i}=yield y.rotateAndResize(t,w.default.imageMaxEdge,y.BLOB|y.CANVAS),{images:n}=yield y.rotateAndResize(i.canvas,p.default.IMG_THUMB_MAX_EDGE,y.DATA_URL|y.CANVAS),s=y.getResizedDataUrl(n.canvas,"image/jpeg",2e4),o=s?M.default.parseDataURL(s).data:null;return o||__LOG__(2)`processRawImage: Failed to reach max thumbnail size, preview will be null`,{blob:i.blob,width:r,height:a,preview:o}}))).apply(this,arguments)}function x(){return(x=(0,s.default)((function*(e,t,r,a,i){var s,o=e.forceToBlob(),l=yield(0,S.checkAndRepair)(o,!!a);if(!l)throw __LOG__(3)`processRawAudioVideo bad video file ${o.type}`,new m.InvalidMediaFileType;var d=l.type,u=l.file,c=a||l.isGif;switch((0,g.typeFromMimetype)(d)){case g.FILETYPE.VIDEO:if(t)throw __LOG__(4,void 0,new Error,!0)`Assertion failed!`,SEND_LOGS("media-fault: ptt became video"),new m.InvalidMediaFileType;var h={type:b.OUTWARD_TYPES.VIDEO,mediaBlob:u,mimetype:d,isGif:c,gifAttribution:c?i||0:void 0};if(r&&null!=r.duration&&null!=r.fullHeight&&0!==r.fullHeight&&null!=r.fullWidth&&0!==r.fullWidth&&r.preview)return(0,n.default)((0,n.default)({},h),{},{fullWidth:r.fullWidth,fullHeight:r.fullHeight,preview:r.preview,duration:r.duration.toString()});var{duration:f,thumbs:[_,v]}=yield y.generateVideoThumbsAndDuration({file:u,maxDimensions:[p.default.IMG_THUMB_MAX_EDGE,p.default.VIDEO_THUMB_MAX_EDGE],debugHint:"processRawAudioVideo"}),E=yield P.default.createFromBase64Jpeg(M.default.parseDataURL(v.url).data);return(0,n.default)((0,n.default)({},h),{},{fullWidth:_.fullWidth,fullHeight:_.fullHeight,preview:M.default.parseDataURL(_.url).data,fullPreviewData:E,duration:f.toString()});case g.FILETYPE.AUDIO:var T=null!==(s=null==r?void 0:r.duration)&&void 0!==s?s:yield(0,g.getAudioDuration)(u);return{type:t?b.OUTWARD_TYPES.PTT:b.OUTWARD_TYPES.AUDIO,mediaBlob:u,mimetype:d,duration:T.toString()};default:throw __LOG__(4,void 0,new Error,!0)`Assertion failed!`,SEND_LOGS("media-fault: audio/video became other"),new Error(`audio/video became ${d}`)}}))).apply(this,arguments)}function B(){return Y.apply(this,arguments)}function Y(){return(Y=(0,s.default)((function*(e,t){var r=e.type;if(r){if("*"===C.DOC_MIMES||C.DOC_MIMES.includes(r))return r;throw new m.InvalidMediaFileType(`disallowed mimetype ${r}`)}var a=yield N(e),i=(0,u.default)(new Uint8Array(a,0,Math.min(262,a.byteLength)));if(i&&i.mime){var n=(0,C.isAllowedDocumentMimetype)(i.mime,t,!0);if(n)return n}else if(t){var s=(0,g.getMimeTypeForFilepath)(t);if(s)return s}throw new m.InvalidMediaFileType(`type: ${String(e.type)} name: ${String(t)}`)}))).apply(this,arguments)}function K(){return(K=(0,s.default)((function*(e,t,r,a){var i,n,s=e.forceToBlob(),o=(0,c.cleanFilename)(s.name||t||null),l=yield B(s,o),d=r?(0,g.blobToText)(s):null,[u,p]=yield Promise.all([_.enrich(s,l),d]),h=null!==(i=null==u||null===(n=u.microThumbnail)||void 0===n?void 0:n.dataUrl)&&void 0!==i?i:null==u?void 0:u.thumbUrl,f=h?M.default.parseDataURL(h).data:null;return{type:b.OUTWARD_TYPES.DOCUMENT,mediaBlob:yield P.default.createFromData(s,l),mimetype:l,filename:o||void 0,documentPreview:u,preview:f,fullPreviewData:null==u?void 0:u.fullPreviewData,fullPreviewSize:u?{width:u.width,height:u.height}:null,pageCount:null!=a?a:null==u?void 0:u.pdfPages,isVcardOverMmsDocument:r,parsedVcards:p?(0,I.parseMultiVcard)(p):null}}))).apply(this,arguments)}function j(e){var t=[];return(0,o.callSyncPromise)(e,null,(function(e){e.retain(),t.push(e)})).finally((()=>{for(var e=0;e<t.length;e++)t[e].autorelease()}))}function W(){return(W=(0,s.default)((function*(e,t){var r,a;t.retain();try{switch(e.type){case b.TYPE.VIDEO:var i=t.forceToBlob(),{thumbs:[n],duration:s}=yield y.generateVideoThumbsAndDuration({file:i,maxDimensions:[p.default.VIDEO_THUMB_MAX_EDGE],debugHint:"gatherAndSetMetadata"}),o=yield P.default.createFromBase64Jpeg(M.default.parseDataURL(n.url).data);r={mediaBlob:t,renderableUrl:t.url(),fullWidth:n.fullWidth,fullHeight:n.fullHeight,duration:void 0!==s?`${Math.ceil(s)}`:void 0,durationFloat:s,fullPreviewData:o};break;case b.TYPE.AUDIO:var l=yield G(t);l.retain(),r={mediaBlob:l,renderableUrl:l.url()},a=()=>l.autorelease();break;default:e.type!==b.TYPE.IMAGE&&e.type!==b.TYPE.STICKER||(__LOG__(4,void 0,new Error,!0)`object type: ${e.type||""}`,SEND_LOGS("Entering gatherAndSetMetadata (with OpaqueData) unexpectedly")),r={mediaBlob:t,renderableUrl:t.url()}}e.consolidate(r)}catch(r){if(!(r instanceof m.MediaUnsupportedError))throw r;e.consolidate({mediaBlob:t,renderableUrl:t.url()})}finally{t.autorelease(),null!=a&&a()}}))).apply(this,arguments)}},93013:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(84337),n=a(r(97018)),s=r(48537);class o extends n.default{constructor(...e){super(...e),this._b64=void 0,this._blob=void 0,this._url=void 0,this._mimetype=void 0,this._released=void 0}url(){return this.throwIfReleased("OpaqueData:url"),this._url?this._url:this._b64?this._url=`data:image/jpeg;base64,${this._b64}`:this._url=window.URL.createObjectURL(this._blob)}getBase64(){return this._b64}filepath(){throw new Error("OpaqueData:filepath can not be implemented on web")}wavFilepath(){throw new Error("OpaqueData:wavFilepath can not be implemented on web")}setWavFilepath(){throw new Error("OpaqueData:setWavFilepath can not be implemented on web")}validate(){return this._released?Promise.resolve(!1):this._blob?(0,s.validateBlob)(this._blob):Promise.resolve(!0)}size(){return this.throwIfReleased("OpaqueData:size"),this._blob?this._blob.size:(0,i.sizeWhenB64Decoded)(this._b64)}formData(){return this.throwIfReleased("OpaqueData:formData"),this.forceToBlob()}type(){return this.throwIfReleased("OpaqueData:type"),this._mimetype||"undefined"}forceToBlob(){this.throwIfReleased("OpaqueData:forceToBlob");var e=this._blob;if(e)return e;var t=this._b64;if(t){this._b64=void 0,this._url=void 0;var r=this._mimetype;return this._blob=new Blob([(0,i.decodeB64)(t)],r?{type:r}:void 0)}throw new Error("OpaqueData:forceToBlob no b64 or blob")}_releaseImpl(){this._mimetype=void 0,this._blob?(this._blob=void 0,this._url&&(window.URL.revokeObjectURL(this._url),this._url=void 0)):(this._b64=void 0,this._url=void 0)}isBlobEqual(e){return e?this._blob===e._blob:!this._blob}}t.default=o,o.createFromBase64Jpeg=e=>new Promise((t=>{var r=new o;return r._b64=e,r._mimetype="image/jpeg",t(r)})),o.createFromData=(e,t)=>new Promise((r=>{var a=new o;return a._blob=e instanceof Blob&&e.type===t?e:new Blob([e],{type:t}),a._mimetype=t,r(a)}))},11159:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(94095)),n=r(27264),s=r(60301),o=a(r(84161));class l{constructor(e){this.itemCount=e.itemCount,this.purgesSoFar=e.purgesSoFar,this.sizeLimit=e.sizeLimit,this.startTime=null!=e.startTime?e.startTime:window.performance.now()}increaseItemCount(){this.itemCount++}decreaseItemCount(){this.itemCount--}increasePurgesSoFar(){this.purgesSoFar++}commitMetric(){new o.default.WebcMediaBlobCachePurge({mediaBlobCacheItemCount:this.itemCount,mediaBlobCachePurgesSoFar:this.purgesSoFar,mediaBlobCacheSizeLimit:this.sizeLimit,mediaBlobCacheUptimeT:Math.round(window.performance.now()-this.startTime)}).commit()}reset(){this.itemCount=0,this.purgesSoFar=0,this.startTime=window.performance.now()}}var d=new class{constructor(e=25e7){if(this.getOrCreateURL=e=>{if(this._filehashToUrl[e])return this.touch(e),this._filehashToUrl[e];var t=this.get(e);if(!t)throw new Error(`There is no blob matching filehash: ${e}.`);var r=window.URL.createObjectURL(t);return this._filehashToUrl[e]=r,r},this.revokeURL=(e,t)=>{if(t){if(this._filehashToUrl[e]!==t)throw new Error("The url provided does not match the filehash.");delete this._filehashToUrl[e],window.URL.revokeObjectURL(t)}},null!=e&&e<0)throw new Error("Size limit cannot be a negative number.");this._metricHelper=new l({itemCount:0,purgesSoFar:0,sizeLimit:e,startTime:null}),this._usageCounts={},this._filehashToUrl={},this._lruCache=new i.default({sizeLimit:e,getSize:e=>e.size,onEvict:e=>{this._filehashToUrl[e]&&0===this._getUsageCount(e)&&(this.revokeURL(e,this._filehashToUrl[e]),(0,n.getOrCreateMediaObject)(e).consolidate({downloadStage:s.DOWNLOAD_STAGE.INIT})),this._metricHelper.increasePurgesSoFar(),this._metricHelper.commitMetric()},onAdd:()=>{this._metricHelper.increaseItemCount()},shouldEvict:e=>0===this._getUsageCount(e),onDelete:()=>{this._metricHelper.decreaseItemCount()},onClear:()=>{this._metricHelper.reset()}})}get(e){return this._lruCache.get(e)}has(e){return this._lruCache.has(e)}touch(e){this.get(e)}put(e,t){this._lruCache.put(e,t)}clear(){this._usageCounts={},Object.keys(this._filehashToUrl).forEach((e=>{this._filehashToUrl[e]&&this.revokeURL(e,this._filehashToUrl[e])})),this._filehashToUrl={},this._lruCache.clear()}increaseUsageCount(e){this._usageCounts[e]=this._getUsageCount(e)+1}decreaseUsageCount(e){var t=this._getUsageCount(e);if(t<=0)throw new Error("Cannot decrease the usageCount to a negative number.");this._usageCounts[e]=t-1,0===this._usageCounts[e]&&delete this._usageCounts[e]}_getUsageCount(e){return this._usageCounts[e]||0}};t.default=d},49034:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.cleanJPEG=function(e){var t,r=new a.Binary(e),Y=new a.Binary(e),K=new a.Binary,j=!1,W=!1,H=!1,V=!1,$={version:257,densityUnits:0,xDensity:1,yDensity:1};if(255!==r.readUint8()||r.readUint8()!==v)throw new Error("SOI marker not at the start of the file.");Y.advance(2);var q=void 0;for(;null!=q||r.size();){if(void 0===q){var z=r.readUint8();if(255!==z)throw new Error(`0x${z.toString(16)} is not a marker prefix.`);q=r.readUint8()}switch(q){case A:if(W)t=r.readUint16(),Y.advance(t+2),r.advance(r.size()-Y.size());else{if(t=r.readUint16(),"JFIF\0"!==r.readString(5))throw new Error("APP0 marker missing 'JFIF' magic bytes.");V=!0,$.version=r.readUint16(),$.densityUnits=r.readUint8(),$.xDensity=r.readUint16(),$.yDensity=r.readUint16(),Y.advance(t+2),r.advance(r.size()-Y.size()),W=!0}break;case y:if(!H&&!V)throw new Error("Missing magic bytes marker.");r.advance(r.readUint16()-2);for(var J=void 0,Q=r.readUint8();r.size();){if(J=r.readUint8(),255===Q&&!B.includes(J)){q=J;break}Q=J}K.writeByteArray(Y.readByteArray(Y.size()-r.size()-2));continue;case b:if(t=r.readUint16(),!H&&"Exif\0\0"!==r.readString(6))throw new Error("APP1 marker missing 'EXIF' magic bytes.");H=!0,Y.advance(t+2),r.advance(r.size()-Y.size());break;case U:case x:if(!H&&!V)throw new Error("Missing magic bytes marker.");t=r.readUint16(),Y.advance(t+2),r.advance(r.size()-Y.size());break;case E:if(!H&&!V)throw new Error("Missing magic bytes marker.");j=!0,K.writeByteArray(Y.readByteArray(2));break;case i:case n:case s:case o:case d:case u:case c:case p:case h:case f:case _:case m:case g:case S:case l:case T:if(!H&&!V)throw new Error("Missing magic bytes marker.");t=r.readUint16(),K.writeByteArray(Y.readByteArray(2+t)),r.advance(r.size()-Y.size());break;case C:case P:case O:case w:case M:case I:case R:case D:case N:case L:case k:case G:case F:throw new Error(`Received unexpected APP marker 0x${q.toString(16)}`);default:throw new Error(`Did not understand marker: 0x${q.toString(16)}`)}if(q=void 0,j)break}if(!j)throw new Error("No EOI tag found.");var X=function(e){var t=new a.Binary;return t.writeBytes(255,216,255,224,0,16,74,70,73,70,0),t.writeUint16(e.version),t.writeUint8(e.densityUnits),t.writeUint16(e.xDensity),t.writeUint16(e.yDensity),t.writeBytes(0,0),t.readByteArray()}($);return new Blob([X,K.readByteArray()],{type:"image/jpeg"})};var a=r(49244),i=192,n=193,s=194,o=195,l=196,d=197,u=198,c=199,p=201,h=202,f=203,_=205,m=206,g=207,v=216,E=217,y=218,S=219,T=221,A=224,b=225,C=226,P=227,O=228,w=229,M=230,I=231,R=232,D=233,N=234,L=235,k=236,U=237,G=238,F=239,x=254,B=[0,208,209,210,211,212,213,214,215]},54865:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(22346)),n={ignoreSearch:!0,ignoreMethod:!0,ignoreVary:!0};class s extends i.default{constructor(e){super(),this._encodeKey=e=>{var t=encodeURIComponent(e);return`https://_media_cache_v2_.whatsapp.com/${encodeURIComponent(this.storeName)}_${t}`},this.storeName=e}doGet(e){var t=this._encodeKey(e);return this.cacheStore?Promise.resolve(this.cacheStore.match(t,n).then((e=>e?e.arrayBuffer():null))):(__LOG__(3)`Unable to get. This error can occur if abstract method doGet gets called.`,Promise.reject(new Error("Unable to get")))}doPut(e,t){var r=this._encodeKey(e);return this.cacheStore?Promise.resolve(this.cacheStore.put(r,new Response(t)).then((()=>t))):(__LOG__(3)`Unable to put. This error can occur if abstract method doPut gets called.`,Promise.reject(new Error("Unable to put in cache")))}doDel(e){var t=this._encodeKey(e);return this.cacheStore?this.cacheStore.delete(t,n).then((()=>{})):(__LOG__(3)`Unable to delete. This error can occur if abstract method doDel gets called.`,Promise.reject(new Error("Unable to delete")))}doClear(){return Promise.resolve(caches.delete(this.storeName).then((e=>{e||__LOG__(2)`Tried to delete a non-existent cache: ${this.storeName}`})))}doOpen(){return Promise.resolve(caches.open(this.storeName).then((e=>{this.cacheStore=e}))).catch((e=>(this.cacheStore=null,__LOG__(3)`Unable to open cache: ${this.storeName}, error: ${e}`,Promise.reject(e))))}doClose(){return this.cacheStore=null,Promise.resolve()}}t.default=s},95245:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(22346));class n extends i.default{get(){return Promise.resolve()}queryByIndex(){return Promise.resolve([])}getAll(){return Promise.resolve([])}put(e,t){return Promise.resolve(t)}del(){return Promise.resolve()}count(){return Promise.resolve(0)}clear(){return Promise.resolve()}}t.default=n},4958:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(22346)),n=a(r(53770)),s=r(77581);class o extends i.default{constructor(){super(),this._store=new n.default(s.initialize,s.IdbArrayBufferTable)}doGet(e){return this._store.get(e).then((e=>e?e.data:null))}doQueryByIndex(){throw new Error("Not implemented. Actual Arraybuffer store does not need it.")}doGetAll(){throw new Error("Not implemented. Actual Arraybuffer store does not need it.")}doPut(e,t){return this._store.put(e,{id:e,data:t}).then((e=>e.data))}doDel(e){return this._store.del(e)}doCount(){return this._store.count()}clear(){return this._store.clear()}doOpen(){return Promise.resolve()}doClose(){return Promise.resolve()}}t.default=o},79802:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.storeDataIndex=t.storePrimaryIndex=void 0;var i=a(r(49052)),n=a(r(86167)),s=a(r(44221)),o="id";t.storePrimaryIndex=o;var l="data";t.storeDataIndex=l;var d="lru-media-array-buffer";n.default.add(d).version(n.default.versions.version(0),[new s.default(o),new i.default(l)]).view((e=>({id:e.id,data:e.data})));var u=n.default.table(d);t.default=u},4285:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.metaInfoSizeIndex=t.metaInfoDateIndex=t.metaInfoPrimaryIndex=void 0;var i=a(r(49052)),n=a(r(81824)),s=a(r(86167)),o=a(r(44221));t.metaInfoPrimaryIndex="id";var l="timestamp";t.metaInfoDateIndex=l;var d="size";t.metaInfoSizeIndex=d;var u="lru-media-meta-info";s.default.add(u).version(s.default.versions.version(1),[new o.default("id"),new i.default(l),new n.default(l)]).version(s.default.versions.version(2),[new i.default(d)]).view((e=>({id:e.id,timestamp:e.timestamp,size:e.size||0})));var c=s.default.table(u);t.default=c},53770:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(22346));class n extends i.default{constructor(e,t){super(),this._initialize=e,this._table=t}doGet(e){return this._initialize().then((()=>this._table.get(e)))}doQueryByIndex(e,t){return this._initialize().then((()=>this._table.all({limit:t.limit,index:[e]})))}doGetAll(){return this._initialize().then((()=>this._table.all()))}doPut(e,t){return this._initialize().then((()=>this._table.createOrReplace(t))).then((()=>t))}doDel(e){return this._initialize().then((()=>this._table.remove(e)))}doCount(){return this._initialize().then((()=>this._table.count()))}doClear(){return this._initialize().then((()=>this._table.clear()))}doOpen(){return this._initialize()}doClose(){return Promise.resolve()}}t.default=n},86167:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(36479)),n=a(r(49195)),s=new i.default("lru-media-storage-idb"),o=new n.default(s);t.default=o},33916:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(53770)),n=r(77581),s=a(r(596));class o extends s.default{constructor(e,t){super(new i.default(n.initialize,n.IdbMetaInfoTable),{primaryIndex:n.metaInfoPrimaryIndex,dateIndex:n.metaInfoDateIndex,sizeIndex:n.metaInfoSizeIndex,maxSize:e,dispose:t})}}t.default=o},99877:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(52954)),n=a(r(77715)),s=a(r(22346)),o=r(12938),l=a(r(33013)),d=a(r(33916)),u=r(77581),c=a(r(84161)),p=a(r(21830));class h extends s.default{constructor(e){var t;super(),t=this,this._enqueue=(0,o.createEnqueue)(),this.updateMaxSizeInterval=null,this._dispose=(e,t)=>(Promise.all([(0,l.default)(),this.count()]).then((([e,r])=>{var a,i=new c.default.WebcMediaStorePurge({webcCurrentTimestampT:(new Date).getTime(),webcMediaStoreItemCount:r,webcMediaStoreQuotaBytes:this.getMaxSize(),webcMediaStoreQuotaUsedBytes:null!==(a=this.getCurrentSize())&&void 0!==a?a:void 0,webcPurgedItemTimestampT:t[u.metaInfoDateIndex]});e&&(i.webcBrowserStorageQuotaBytes=e.quota,i.webcBrowserStorageQuotaUsedBytes=e.usage),i.commit()})),this._bufferStore.del(e)),this.doPut=this._enqueue(((e,t)=>{if(t.byteLength>this.getMaxSize())return Promise.resolve(t);if(t.byteLength>3e7)return Promise.resolve(t);var r={id:e,timestamp:(new Date).getTime(),size:t.byteLength};return this._lruStore.putObject(r).then((()=>this._bufferStore.put(e,t))).catchType(n.default.AbortError,(e=>{if(e.message.includes("QuotaExceededError"))return __LOG__(2)`LruMediaStore: encounter QuotaExceededError, thus shrink the size of LruMediaStore`,void this.setMaxSize((0,p.default)(this.getCurrentSize(),"this.getCurrentSize()")/2);throw e}))})),this.doDel=this._enqueue((e=>this._lruStore.del(e))),this._updateMaxSize=(0,i.default)((function*(){var e=yield(0,l.default)();if(null!=e){var r=t.getCurrentSize();if(null!=r){var a=e.quota-e.usage,i=t._calculateTargetedBufferSize(e.quota);if(!(a>i)){var n=i-a;r<n?t._clearStoreForThisSession():t.setMaxSize(r-n)}}}else t._clearStoreForThisSession()}));var{name:r,maxSize:a,createArrayBufferStore:s}=e;this._bufferStore=s(`${r}_buffer`),this._lruStore=new d.default(a,this._dispose),this.updateMaxSizeInterval=setInterval(this._updateMaxSize,6e4)}doGet(e){return this._bufferStore.get(e).then((t=>(null!=t&&this.put(e,t),t)))}doClear(){return this._bufferStore.clear().then((()=>this._lruStore.clear()))}doCount(){return this._lruStore.count()}doOpen(){return Promise.all([this._lruStore.open(),this._bufferStore.open()]).then((()=>{}))}doClose(){return Promise.all([this._lruStore.close(),this._bufferStore.close()]).then((()=>{}))}getCurrentSize(){return this._lruStore.getCurrentSize()}getMaxSize(){return this._lruStore.getMaxSize()}setMaxSize(e){return this._lruStore.setMaxSize(e)}_calculateTargetedBufferSize(e){var t=Math.floor(.01*e);return t<1e8?1e8:t>5e8?5e8:t}_clearStoreForThisSession(){this.setMaxSize(0),this.updateMaxSizeInterval&&(clearInterval(this.updateMaxSizeInterval),this.updateMaxSizeInterval=null)}}t.default=h},77581:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"IdbMetaInfoTable",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(t,"metaInfoPrimaryIndex",{enumerable:!0,get:function(){return o.metaInfoPrimaryIndex}}),Object.defineProperty(t,"metaInfoDateIndex",{enumerable:!0,get:function(){return o.metaInfoDateIndex}}),Object.defineProperty(t,"metaInfoSizeIndex",{enumerable:!0,get:function(){return o.metaInfoSizeIndex}}),Object.defineProperty(t,"IdbArrayBufferTable",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(t,"storePrimaryIndex",{enumerable:!0,get:function(){return l.storePrimaryIndex}}),Object.defineProperty(t,"storeDataIndex",{enumerable:!0,get:function(){return l.storeDataIndex}}),t.initialize=void 0;var n=i(r(25291)),s=i(r(86167)),o=a(r(4285)),l=a(r(79802)),d=(0,n.default)((()=>s.default.initialize()));t.initialize=d},596:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(52954)),n=r(13275),s=r(35160),o=a(r(22346)),l=r(12938),d=a(r(21830));class u extends o.default{constructor(e,t){var r;if(super(),r=this,this._enqueue=(0,l.createEnqueue)(),this._purge=()=>{if(this._pendingPurgePromise)return this._pendingPurgePromise;var e=this.open().then((()=>(0,n.promiseLoop)((e=>{var t=()=>{this._pendingPurgePromise=null,e()},a=this.getCurrentSize();if(!(null==a||a<=this._maxSize))return this.queryOneByIndex(this._dateIndex).then((e=>{var a=this.getCurrentSize(),n=this._maxSize;if(!(null==a||a<=n)){if(null==e)return(0,i.default)((function*(){var e=yield r.count();__LOG__(3,void 0,void 0,!0)`SizeLruObjectStore: _purge error: No row returned but currentSize (${a}) > maxSize (${n}). Row count is ${e} (may be out of date).`,SEND_LOGS("size-lru-store-invalid-empty")}))(),Promise.reject(new Error("Query returned no result but currentSize > maxSize"));var s=e[this._primaryIndex];return this.del(s)}t()}));t()}))));return this._pendingPurgePromise=e},this._schedulePurge=()=>{this._purgeTimer.debounce(2e3)},this.doPut=this._enqueue(function(){var e=(0,i.default)((function*(e,t){if(t[r._primaryIndex]!==e)throw new Error("The key you provide does not match.");var a=yield r._store.get(e),i=null==a?0:r._getSize(a),n=r._getSize(t),s=yield r._store.put(e,t);return r._currentSize=(0,d.default)(r.getCurrentSize(),"_this.getCurrentSize()")-i+n,r._schedulePurge(),s}));return function(){return e.apply(this,arguments)}}()),this.doDel=this._enqueue(function(){var e=(0,i.default)((function*(e){var t=yield r._store.get(e);if(null!=t){try{yield r._dispose(e,t)}catch(e){throw __LOG__(3,void 0,void 0,!0)`SizeLRUObjectStore: _dispose error: ${e.message}`,SEND_LOGS("size-lru-store-dispose-error"),e}yield r._store.del(e),r._currentSize=(0,d.default)(r.getCurrentSize(),"_this.getCurrentSize()")-r._getSize(t)}}));return function(){return e.apply(this,arguments)}}()),this._store=e,this._primaryIndex=t.primaryIndex,this._dateIndex=t.dateIndex,this._sizeIndex=t.sizeIndex,t.maxSize<0)throw new Error("Cannot set max size to a negative number");this._maxSize=Math.floor(t.maxSize),this._dispose=t.dispose,this._purgeTimer=new s.ShiftTimer((()=>{this._purge().catch((e=>{__LOG__(3)`Error while purging: ${e.message}`}))}))}getCurrentSize(){return this._currentSize}getMaxSize(){return this._maxSize}setMaxSize(e){return e<0?Promise.reject("Cannot set size to a negative number"):(this._maxSize=Math.floor(e),this._purgeTimer.cancel(),this._purge().catch((e=>{__LOG__(3)`Error while purging during setMaxSize: ${e.message}`})))}putObject(e){var t=e[this._primaryIndex];return this.put(t,e)}_getSize(e){var t=e[this._sizeIndex];return"number"!=typeof t||t<0?(__LOG__(3)`Invalid size in index ${this._sizeIndex}: ${t}`,0):t}doGet(e){return this._store.get(e)}queryOneByIndex(e){return this._store.queryByIndex(e,{limit:1}).then((e=>0===e.length?null:e[0]))}doQueryByIndex(e,t){return this._store.queryByIndex(e,t)}doGetAll(){return this._store.getAll()}doClear(){var e=this;return(0,i.default)((function*(){e._purgeTimer.cancel(),yield e._store.clear(),e._currentSize=0}))()}doCount(){return this._store.count()}doOpen(){var e=this;return(0,i.default)((function*(){if(yield e._store.open(),null==e._currentSize){var t=yield e._store.doGetAll();e._currentSize=t.reduce(((t,r)=>t+e._getSize(r)),0)}}))()}doClose(){return this._currentSize=null,this._store.close()}}t.default=u},35283:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.MediaStore=void 0;var i=a(r(52954)),n=a(r(25291)),s=a(r(54865)),o=a(r(95245)),l=r(24461),d=a(r(4958)),u=a(r(7010)),c=a(r(99877)),p=a(r(83082)),h=Number.MAX_SAFE_INTEGER,f="media_lru",_="lru-media-array-buffer-cache";class m{constructor(){this._getBackingStore=(0,n.default)((0,i.default)((function*(){try{var e=function(){if(null!=u.default&&"caches"in self)return new c.default({name:f,maxSize:h,createArrayBufferStore:()=>new s.default(_)});if(null!=u.default)return new c.default({name:f,maxSize:h,createArrayBufferStore:e=>new d.default(e)})}();if(null!=e)return yield e.open(),e}catch(e){if("SecurityError"===e.name)__LOG__(3)`There was a security error attempting to open the media storage. \
This likely indicates a permissions error. Falling back to dummy \
(no-op) storage.`;else{if(e instanceof l.DbOnLogoutAbort)throw e;__LOG__(4,!0,new Error,!0)`Failed to initialize media store! Falling back to dummy (no-op) storage. Error:
${(0,p.default)(e)}`,SEND_LOGS("Failed to initialize media store")}}return new o.default})))}get(e){var t=this;return(0,i.default)((function*(){return(yield t._getBackingStore()).get(e)}))()}queryByIndex(e,t){var r=this;return(0,i.default)((function*(){return(yield r._getBackingStore()).queryByIndex(e,t)}))()}getAll(){var e=this;return(0,i.default)((function*(){return(yield e._getBackingStore()).getAll()}))()}put(e,t){var r=this;return(0,i.default)((function*(){return(yield r._getBackingStore()).put(e,t)}))()}del(e){var t=this;return(0,i.default)((function*(){var r=yield t._getBackingStore();yield r.del(e)}))()}count(){var e=this;return(0,i.default)((function*(){return(yield e._getBackingStore()).count()}))()}clear(){var e=this;return(0,i.default)((function*(){var t=yield e._getBackingStore();yield t.clear()}))()}open(){var e=this;return(0,i.default)((function*(){var t=yield e._getBackingStore();yield t.open()}))()}close(){var e=this;return(0,i.default)((function*(){var t=yield e._getBackingStore();yield t.close()}))()}}t.MediaStore=m;var g=new m;t.default=g},27305:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.downloadMsg=function(e){var{msg:t,isUserClick:r,mode:a,downloadEvenIfExpensive:i,rmrReason:n,rmrData:s}=e,{mediaObject:o}=t;return o?o.getPendingProcess("fromDisk").then((()=>(r&&o.userDownloadAttemptCount++,(0,O.downloadMedia)({mimetype:t.mimetype,mediaObject:o,downloadEvenIfExpensive:i,mediaType:(0,b.msgToMediaType)(t),rmrReason:n,rmrData:s,downloadOrigin:$(t),isVcardOverMmsDocument:t.isVcardOverMmsDocument,mode:a}).then((()=>{o.userDownloadAttemptCount=0}))))):(__LOG__(4,void 0,new Error,!0)`id: ${t.id.toString()} type: ${t.type}`,SEND_LOGS("media-fault: downloadMsg msg without mediaObject"),Promise.resolve())},t.cancelDownloadMedia=q,t.checkExistence=function(){return z.apply(this,arguments)},t.cancelDownloadMsg=function(e){e.mediaObject?q(e.mediaObject):e.mediaObject||(__LOG__(4,void 0,new Error,!0)`id: ${e.id.toString()} type: ${e.type}`,SEND_LOGS("media-fault: cancelDownloadMsg msg without mediaObject"))},t.prepRawMedia=function(e,t){var r;__LOG__(2)`Prepping raw media`,r=t.isPtt?A.OUTWARD_TYPES.PTT:t.asDocument?A.OUTWARD_TYPES.DOCUMENT:t.asGif?A.OUTWARD_TYPES.VIDEO:t.isAudio?A.OUTWARD_TYPES.AUDIO:A.OUTWARD_TYPES.UNKNOWN;var a=Promise.resolve(e).then((e=>(e.autoreleaseWhenPromiseCompletes(a),(0,D.default)(e,t))));return new V(r,a)},t.forwardMediaMsg=function(e,t,a=!1){__LOG__(2)`Prepping media msg`;var i=e.mediaObject;if(!i)return __LOG__(4,void 0,new Error,!0)`id: ${e.id.toString()} type: ${e.type}`,SEND_LOGS("media-fault: forwardMediaMsg msg without mediaObject"),Promise.reject("non initialized media");var n=e.mediaData.toJSON();n.preview&&(n.preview=i.contentInfo._preview);n.mediaBlob&&n.mediaBlob.retain();var s=n.isGif?{isGif:!0}:{};n.type===A.OUTWARD_TYPES.PTT&&(n.type=A.OUTWARD_TYPES.AUDIO);var o={businessOwnerJid:e.businessOwnerJid,productId:e.productId,currencyCode:e.currencyCode,priceAmount1000:e.priceAmount1000,salePriceAmount1000:e.salePriceAmount1000,retailerId:e.retailerId,url:e.url,productImageCount:e.productImageCount,title:e.title,description:e.description};return new V(n.type,Promise.resolve(n)).sendToChat(t,{forwardedFromWeb:!0,caption:n.type===A.OUTWARD_TYPES.DOCUMENT?e.caption:void 0,addEvenWhilePreparing:!0,placeholderProps:s,isForwarded:e.isForwarded||!e.isSentByMe,forwardingScore:e.getForwardingScoreWhenForwarded(),multicast:a,productMsgOptions:o}).then((t=>{var a;n.type===A.OUTWARD_TYPES.STICKER&&(new P.default.StickerSend({stickerSendOrigin:P.default.STICKER_SEND_ORIGIN_TYPE.FORWARD,stickerIsAnimated:Boolean(null===(a=e.mediaData)||void 0===a?void 0:a.isAnimated)}).commit(),r(11506).default.addStickerWithMediaData(n));return t}))},t.cancelUploadMedia=J,t.cancelUploadMsg=function(e){e.mediaObject?J(e.mediaObject):(__LOG__(4,void 0,new Error,!0)`id: ${e.id.toString()} type: ${e.type}`,SEND_LOGS("media-fault: cancelUploadMsg msg without mediaObject"))},t.getUploadOriginForChat=Q,t.resumeUploadMsg=function(e){var{mediaObject:t}=e;if(!t)return __LOG__(4,void 0,new Error,!0)`id: ${e.id.toString()} type: ${e.type}`,SEND_LOGS("media-fault: resumeUploadMsg msg without mediaObject"),Promise.resolve();t.userUploadAttemptCount++;var r=(0,w.uploadMedia)({mimetype:e.mimetype,mediaObject:t,mediaType:(0,b.msgToMediaType)(e),forwardedFromWeb:Boolean(e.forwardedFromWeb),uploadOrigin:Q(e.chat)}).then((({mediaEntry:r})=>{if(!r)throw new Error("upload failed: media entry was not created");t.userUploadAttemptCount=0;var a={deprecatedMms3Url:r.deprecatedMms3Url,directPath:r.directPath,mediaKey:r.mediaKey,mediaKeyTimestamp:r.mediaKeyTimestamp,filehash:t.filehash,encFilehash:r.encFilehash,size:t.size,streamingSidecar:r.sidecar,firstFrameSidecar:r.firstFrameSidecar};return ce(e,a).then((()=>e))}));return(0,U.sendMsgToChat)(e.chat,r).catch((()=>{e.ack=p.default.ACK.FAILED}))},t.mediaMetadata=function(e){var t=e.mediaObject;if(!t)throw __LOG__(4,void 0,new Error,!0)`id: ${e.id.toString()} type: ${e.type}`,SEND_LOGS("media-fault: mediaMetadata msg without mediaObject"),new Error("msg.mediaMetadata with no mediaObject");var r=t.entries.getEntryByEncFilehash({encFilehash:e.encFilehash,deprecatedMms3Url:e.deprecatedMms3Url});if(!r)throw __LOG__(4,void 0,new Error,!0)`id: ${e.id.toString()} type: ${e.type}`,SEND_LOGS("media-fault: mediaMetadata no entry"),new Error("msg.mediaMetadata with entry mismatch");var a=e.mediaData;return{url:r.deprecatedMms3Url,directPath:r.directPath,encFilehash:r.encFilehash,mediaKey:r.mediaKey,mediaKeyTimestamp:r.mediaKeyTimestamp,filehash:e.filehash,type:a.type,mimetype:a.mimetype,filename:a.filename,duration:a.duration,width:a.fullWidth,height:a.fullHeight,firstFrameLength:a.firstFrameLength,isAnimated:a.isAnimated,thumbnailDirectPath:e.thumbnailDirectPath,thumbnailSha256:e.thumbnailSha256,thumbnailEncSha256:e.thumbnailEncSha256,thumbnailHeight:e.thumbnailHeight,thumbnailWidth:e.thumbnailWidth}},t.videoStreamingInfo=function(e){var t=e.mediaObject;return t?t.videoStreamingInfo(e.id.toString()):null},t.manuallySetMedia=function({msg:e,media:t,rmrReason:r}){var a=e.mediaObject;if(!a)return;R.default.createFromData(t,e.mimetype).then((t=>{(0,O.manuallySetMedia)({mimetype:e.mimetype,mediaObject:a,mediaBlob:t,mediaType:(0,b.msgToMediaType)(e),rmrReason:r,downloadOrigin:$(e)})}))},t.clearMediaForChat=function(e){T.clearMediaForChat(e)},t.prepareMsg=function(e){var t=e.mediaObject;if(t)return t.resolveWhenConsolidated();var r=e.mediaData,a=r.preview;return!a||void 0!==r.aspectRatio||void 0!==r.fullWidth&&void 0!==r.fullHeight?Promise.resolve():(0,C.getImageWidthHeight)(a).then((({width:t,height:r})=>{e.mediaObject||e.mediaData.set({aspectRatio:t/r})}))},t.registerMsgEarly=function(e,t){e.isUnsentPhoneMsg()&&(__LOG__(4,void 0,new Error,!0)`id: ${e.id.toString()} type: ${e.type}`,SEND_LOGS("media-fault: registerMsgEarly msg without mediaObject"));for(var r={},a=0;a<A.MEDIA_MSG_PROPS.length;a++){var i=A.MEDIA_MSG_PROPS[a],n=t[i];r[i]=void 0!==n?n:e[i]}r.mimetype||r.type!==A.OUTWARD_TYPES.IMAGE||(t.mimetype=r.mimetype="image/jpeg");e.on(H,X),oe(e,r,P.default.WEBC_RMR_REASON_CODE.MSG_UPDATE);for(var s={},o=0;o<A.MSG_SPECIFIC_FIELDS.length;o++){var l=A.MSG_SPECIFIC_FIELDS[o];s[l]=r[A.MEDIA_TO_MSG[l]]}e.mediaData.set(s)},t.registerMsg=function(e){e.mimetype||e.type!==A.OUTWARD_TYPES.IMAGE||(e.mimetype="image/jpeg");e.mimetype||e.type!==A.OUTWARD_TYPES.STICKER||(e.mimetype="image/webp");e.on(H,X),Z(e,P.default.WEBC_RMR_REASON_CODE.MSG_INIT)},t.deregisterMsg=function(e){e.off(null,X);var t=e.mediaObject;t&&T.disassociateMediaFromMsg(t,e)},t.downloadMmsThumbnail=ee,t.downloadProgressiveJpegThumbnail=ae,t.downloadStatusV3Thumbnail=function(){return ne.apply(this,arguments)},t.downloadVideoThumbnail=function(){return se.apply(this,arguments)},t.registerSticker=function(e){pe(e,e.mediaObject||function(e){if(!e.filehash)return __LOG__(4,void 0,new Error,!0)`Unexpected sticker with no filehash`,void SEND_LOGS("sticker-filehash-error");var t=T.getOrCreateMediaObject(e.filehash);return T.associateMediaWithSticker(t,e),t}(e),b.default.STICKER)},t.deregisterSticker=function(e){var{mediaObject:t}=e;t&&T.disassociateMediaFromSticker(t,e)},t.registerStickerPackIcon=function(e){pe(e,e.mediaObject||function(e){if(!e.filehash)return __LOG__(4,void 0,new Error,!0)`Unexpected sticker pack with no filehash`,void SEND_LOGS("sticker-pack-filehash-error");var t=T.getOrCreateMediaObject(e.filehash);return T.associateMediaWithStickerPack(t,e),t}(e),b.default.IMAGE)},t.deregisterStickerPackIcon=function(e){var{mediaObject:t}=e;t&&T.disassociateMediaFromStickerPack(t,e)},t.downloadStickerOrStickerPackIcon=function(e,t){if(e.isPlaceholder)return e.mediaData.mediaStage=A.MEDIA_DATA_STAGE.PREPARING,Promise.resolve();var r=e.mediaObject;if(!r)return Promise.reject(new Error("media-fault: downloadStickerOrStickerPackIcon sticker/stickerPack without mediaObject"));if(r.downloadStage===A.DOWNLOAD_STAGE.RESOLVED)return Promise.resolve();var a="STICKER"===t?P.default.WEBC_RMR_REASON_CODE.STICKER_PANEL_STICKER:P.default.WEBC_RMR_REASON_CODE.STICKER_PANEL_ICON;return r.getPendingProcess("fromDisk").then((()=>{if(!m.default.supportsFeature(m.default.F.MD_BACKEND)&&!e.deprecatedMms3Url||!e.filehash||!e.mediaKey||!e.encFilehash)return h.default.rmr({mediaObject:r,signal:(new d.default).signal,rmrReason:a})})).then((()=>(0,O.downloadMedia)({mimetype:e.mimetype,mediaObject:e.mediaObject,downloadEvenIfExpensive:!0,mediaType:(0,b.msgToMediaType)({type:e.type,isGif:!1}),rmrReason:a,downloadOrigin:P.default.DOWNLOAD_ORIGIN_TYPE.STICKER_PICKER,shouldThrow:!0})))},t.prepSticker=function(e){__LOG__(2)`Prepping sticker`;var t=e.mediaObject,r=e.mediaData.toJSON();if(r.fullWidth=125,r.fullHeight=125,!t)return __LOG__(4,void 0,new Error,!0)`id: ${e.id}`,SEND_LOGS("media-fault: prepSticker sticker without mediaObject"),new V(r.type,Promise.reject("non initialized media"));return new V(r.type,Promise.resolve(r))},t.uploadProductImage=function(e,t){return(0,f.blobToArrayBuffer)(e.forceToBlob()).then((e=>v.default.unencryptedUpload({file:e,hash:t,signal:(new d.default).signal,type:b.default.PRODUCT_CATALOG_IMAGE,uploadOrigin:P.default.UPLOAD_ORIGIN_TYPE.PRODUCT_CATALOG}))).then((e=>new URL(e.directPath,"https://mmg.whatsapp.net").toString()))},t.uploadMmsThumbnail=fe,t.MediaPrep=void 0;var n=i(r(70417)),s=i(r(52954)),o=r(76331),l=i(r(47677)),d=i(r(45026)),u=r(3599),c=i(r(99461)),p=i(r(23045)),h=i(r(26082)),f=r(48537),_=r(66239),m=i(r(20468)),g=a(r(64453)),v=i(r(13139)),E=i(r(11159)),y=i(r(86619)),S=i(r(27425)),T=a(r(27264)),A=r(60301),b=a(r(79843)),C=r(25332),P=i(r(84161)),O=r(37554),w=r(58001),M=i(r(83746)),I=i(r(21830)),R=i(r(93013)),D=i(r(52313)),N=i(r(2191)),L=i(r(13415)),k=i(r(2661)),U=r(76774),G=r(87471),F=i(r(83082)),x=i(r(54559)),B=r(47138),Y=r(35112),K=r(26495),j=i(r(22006)),W=r(25054),H=`change:phoneUploading change:ack ${A.MEDIA_MSG_PROPS.map((e=>`change:${e}`)).join(" ")}`;class V{constructor(e,t){this._baseType=e,this._mediaData=new y.default({mediaStage:A.MEDIA_DATA_STAGE.PREPARING}),this._prepwork=t.then((e=>{if(this._mediaData.set(e),!e.filehash)return e.mediaBlob||(__LOG__(4,void 0,new Error,!0)`Assertion failed!`,SEND_LOGS("media-fault: no hash or blob")),(0,Y.getHash)(e.mediaBlob).then((e=>{this._mediaData.filehash=e}))}),(e=>(this._mediaData.mediaStage=A.MEDIA_DATA_STAGE.ERROR_UNSUPPORTED,Promise.reject(e))))}sendToChat(e,t){return(0,o.callSyncPromise)(ue,null,this,e,t)}waitForPrep(){return this._prepwork.then((()=>this._mediaData))}}function $(e){return e.asProduct?P.default.DOWNLOAD_ORIGIN_TYPE.PRODUCT_CATALOG:e.isStatusV3?P.default.DOWNLOAD_ORIGIN_TYPE.STATUS_USER:e.isGroupMsg?P.default.DOWNLOAD_ORIGIN_TYPE.CHAT_GROUP:P.default.DOWNLOAD_ORIGIN_TYPE.CHAT_PERSONAL}function q(e){(0,O.cancelDownloadMedia)(e)}function z(){return(z=(0,s.default)((function*(e){if(yield e.waitForPhoneUpload(),!e.mediaObject)return __LOG__(4,void 0,new Error,!0)`checkExistence msg without mediaObject, id: ${e.id.toString()} type: ${e.type}`,void SEND_LOGS("media-fault: checkExistence msg without mediaObject");yield(0,O.checkExistence)({mimetype:e.mimetype,mediaObject:e.mediaObject,mediaType:(0,b.msgToMediaType)({type:e.type,isGif:!1})})}))).apply(this,arguments)}function J(e){(0,w.cancelUploadMedia)(e)}function Q(e){return e?(0,B.unproxy)(e).isGroup?P.default.UPLOAD_ORIGIN_TYPE.CHAT_GROUP:P.default.UPLOAD_ORIGIN_TYPE.CHAT_PERSONAL:P.default.UPLOAD_ORIGIN_TYPE.UNKNOWN}function X(e){Z(e,P.default.WEBC_RMR_REASON_CODE.MSG_UPDATE)}function Z(e,t){if(e.isUnsentPhoneMsg()){e.mediaObject&&(__LOG__(4,void 0,new Error,!0)`id: ${e.id.toString()} type: ${e.type}`,SEND_LOGS("media-fault: consolidateMediaUpdate unsent message"));var r=le(e);if(r.hasOwnProperty("preview")){var a=r.preview;delete r.preview,a&&R.default.createFromBase64Jpeg(a).then((t=>{e&&e.mediaData&&e.isUnsentPhoneMsg()&&(e.mediaData.preview=t)}))}e.mediaData.set((0,n.default)((0,n.default)({},r),{},{mediaStage:e.phoneUploading?A.MEDIA_DATA_STAGE.REMOTE_UPLOADING:A.MEDIA_DATA_STAGE.REMOTE_NEED_UPLOAD}))}else oe(e,e,t)}function ee(){return te.apply(this,arguments)}function te(){return(te=(0,s.default)((function*(e){var{msg:t,isPreload:r,signal:a}=e,{thumbnailSha256:i,thumbnailEncSha256:n,thumbnailDirectPath:s}=t;if(s&&n&&i&&(t.type!==b.default.DOCUMENT||null!=t.thumbnailHeight&&null!=t.thumbnailWidth)){__LOG__(2)`media.downloadMmsThumbnail: start`;try{var o=yield h.default.downloadAndDecrypt({directPath:s,encFilehash:n,filehash:i,mediaKey:t.mediaKey,mediaKeyTimestamp:t.mediaKeyTimestamp,type:re(t),signal:a||(new d.default).signal,userDownloadAttemptCount:0,isPreload:r}),l=(0,I.default)(t.mediaObject,"mediaObject cannot be null for thumbnail download"),c={fullPreviewData:yield R.default.createFromData(o,"image/jpeg")};t.type===p.default.MSG_TYPE.DOCUMENT&&(c.fullPreviewSize={height:(0,I.default)(t.thumbnailHeight,"msg.thumbnailHeight"),width:(0,I.default)(t.thumbnailWidth,"msg.thumbnailWidth")}),l.consolidate(c),__LOG__(2)`media.downloadMmsThumbnail: success`}catch(e){if(e.name===u.ABORT_ERROR)return void __LOG__(2)`media.downloadMmsThumbnail aborted`;__LOG__(3,!0)`media.downloadMmsThumbnail: error\n${(0,F.default)(e)}`}}}))).apply(this,arguments)}function re(e){switch(e.type){case p.default.MSG_TYPE.DOCUMENT:return b.default.THUMBNAIL_DOCUMENT;case p.default.MSG_TYPE.VIDEO:return b.default.THUMBNAIL_VIDEO;case p.default.MSG_TYPE.IMAGE:return b.default.THUMBNAIL_IMAGE;case p.default.MSG_TYPE.CHAT:return b.default.THUMBNAIL_LINK;default:throw new Error("getThumbnailTypeForMsg: Unsupported msg type")}}function ae(){return ie.apply(this,arguments)}function ie(){return(ie=(0,s.default)((function*(e){var{msg:t,isPreload:r,signal:a}=e;__LOG__(2)`media.downloadProgressiveJpegThumbnail: start`;try{var i=(0,I.default)(t.scanLengths,"msg.scanLengths"),n=(0,I.default)(t.scansSidecar,"msg.scansSidecar"),s=(0,I.default)(t.mediaObject,"msg.mediaObject"),o=(0,I.default)(s.filehash,"mediaObject.filehash"),{encFilehash:l,directPath:c}=t,p=yield h.default.downloadAndDecrypt({directPath:c,encFilehash:l,filehash:o,mediaKey:t.mediaKey,mediaKeyTimestamp:t.mediaKeyTimestamp,type:b.default.IMAGE,signal:a||(new d.default).signal,userDownloadAttemptCount:0,progressiveJpegOpts:{mimetype:"image/jpeg",scansSidecar:n,scanLengths:i,scanCount:1},isPreload:r});s.consolidate({fullPreviewData:yield R.default.createFromData(p,"image/jpeg")}),__LOG__(2)`media.downloadProgressiveJpegThumbnail: success`}catch(e){if(e.name===u.ABORT_ERROR)return void __LOG__(2)`media.downloadProgressiveJpegThumbnail aborted`;__LOG__(3,void 0,void 0,!0)`media.downloadProgressiveJpegThumbnail: error\n${(0,F.default)(e)}`,SEND_LOGS("download-pjpeg-thumbnail-failed")}}))).apply(this,arguments)}function ne(){return(ne=(0,s.default)((function*(e){var{msg:t,isPreload:r,signal:a}=e,{encFilehash:i,thumbnailSha256:n,thumbnailEncSha256:s,thumbnailDirectPath:o}=t;t.type===p.default.MSG_TYPE.IMAGE&&t.scanLengths&&t.scansSidecar&&i?yield ae({msg:t,signal:a,isPreload:r}):n&&s&&o&&(yield ee({msg:t,signal:a,isPreload:r}))}))).apply(this,arguments)}function se(){return(se=(0,s.default)((function*(e){var{msg:t}=e,{encFilehash:r,filehash:a,directPath:i}=t;if(r&&a&&i){__LOG__(2)`media.downloadVideoThumbnail: start`;try{var n=Math.max(parseInt(t.mediaData.duration,10),1),s={video:{size:t.mediaData.size,duration:n},secondsToDownload:1},o=yield h.default.downloadAndDecrypt({directPath:i,encFilehash:r,filehash:a,mediaKey:t.mediaKey,mediaKeyTimestamp:t.mediaKeyTimestamp,type:b.default.VIDEO,signal:(new d.default).signal,userDownloadAttemptCount:0,partialVideoOpts:s,isPreload:!0}),l=new Blob([o],{type:"video/mp4"}),{thumbs:[u]}=yield g.generateVideoThumbsAndDuration({file:l,maxDimensions:[p.default.VIDEO_THUMB_MAX_EDGE],debugHint:"downloadVideoThumbnail"}),c=yield R.default.createFromBase64Jpeg(j.default.parseDataURL(u.url).data),f=(0,I.default)(t.mediaObject,"mediaObject cannot be null for thumbnail download"),_={fullPreviewData:c,fullWidth:u.fullWidth,fullHeight:u.fullHeight};f.consolidate(_),__LOG__(2)`media.downloadVideoThumbnail: success`}catch(e){__LOG__(3,!0)`media.downloadVideoThumbnail: error\n${(0,F.default)(e)}`}}}))).apply(this,arguments)}function oe(e,t,r){var a=le(t),i=e.mediaObject,n=t.filehash;if(i)n&&n!==i.filehash&&(__LOG__(2)`media:msg ${e.id.toString()} ${i.filehash?"changed":"added"} filehash`,T.disassociateMediaFromMsg(i,e),i=T.getOrCreateMediaObject(n),e.mediaObject=i,T.associateMediaWithMsg(i,e));else{i=n?T.getOrCreateMediaObject(n):new S.default;var s=e.mediaData;void 0!==s.aspectRatio&&(a.aspectRatio=s.aspectRatio),e.mediaObject=i,T.associateMediaWithMsg(i,e)}var o=!1,{deprecatedMms3Url:l,mediaKey:d,mediaKeyTimestamp:u,encFilehash:c,type:p,streamingSidecar:h,firstFrameSidecar:f,directPath:_,scansSidecar:m,scanLengths:g}=t;if(l||c){var v,E=~b.MEDIA_TYPE_VALUES.indexOf(p)?p:null;(o=!i.entries.has({encFilehash:c,deprecatedMms3Url:l}))?d&&E&&c?v=i.entries.addEntry({deprecatedMms3Url:l,mediaKey:d,mediaKeyTimestamp:u,encFilehash:c,type:E,sidecar:h,directPath:_,firstFrameSidecar:f,scansSidecar:m,scanLengths:g,debugHint:"consolidate"}):o=!1:d&&(v=i.entries.updateEntry({deprecatedMms3Url:l,mediaKey:d,mediaKeyTimestamp:u,encFilehash:c,type:E,sidecar:h,directPath:_,firstFrameSidecar:f,scansSidecar:m,scanLengths:g})),v||(o=!1),o&&i.downloadStage===A.DOWNLOAD_STAGE.ERROR_MISSING&&(a.downloadStage=A.DOWNLOAD_STAGE.INIT)}if(i.consolidate(a)||i.notifyMsgsAsync(),o&&i.downloadStage===A.DOWNLOAD_STAGE.NEED_POKE){var y;try{y=(0,b.msgToMediaType)(e)}catch(r){if(!t.type)throw r;y=(0,b.msgToMediaType)({type:t.type,isGif:e.isGif})}(0,O.downloadMedia)({mimetype:t.mimetype,mediaObject:i,downloadEvenIfExpensive:!1,mediaType:y,rmrReason:r,downloadOrigin:$(e)})}}function le(e){var t={};return A.MAPPED_MSG_PROPS.forEach((r=>{var a=e[r],i=A.MSG_TO_MEDIA[r];t[i]=a})),t}function de(e,t){return"product"===t.type?P.default.DOWNLOAD_ORIGIN_TYPE.PRODUCT_CATALOG:(0,B.unproxy)(e).isGroup?P.default.DOWNLOAD_ORIGIN_TYPE.CHAT_GROUP:P.default.DOWNLOAD_ORIGIN_TYPE.CHAT_PERSONAL}function ue(e,t,r){var a;__LOG__(2)`Media:sendToChat chat ${t.id.toString()}`;var i,o,d=r.caption,u=r.quotedMsg?r.quotedMsg.msgContextInfo(t.id):{},h=(0,_.getMaybeMeUser)(),f=r.productMsgOptions||{},v=void 0;if(!t.isUser&&m.default.supportsFeature(m.default.F.MD_BACKEND)&&(v=(0,W.toUserWid)(h)),x.default.ephemeralMessages){t.isEphemeralSettingOn()&&(i=t.getEphemeralSetting());var y=t.getEphemeralSettingTimestamp();null!=y&&(o=y)}var S,I,D,N=(0,n.default)({t:c.default.globalUnixTime(),from:h,isNewMsg:!0,to:t.id,self:"out",type:null!==(a=r.type)&&void 0!==a?a:e._baseType,ack:p.default.ACK.CLOCK,local:!0,id:new M.default({from:h,to:t.id,id:(0,k.default)(),participant:v,selfDir:"out"}),caption:d,quotedMsg:u.quotedMsg,quotedParticipant:u.quotedParticipant,quotedStanzaID:u.quotedStanzaID,quotedRemoteJid:u.quotedRemoteJid,mentionedJidList:r.mentionedJidList,isForwarded:r.isForwarded,forwardingScore:r.forwardingScore,multicast:r.multicast,forwardedFromWeb:r.forwardedFromWeb,ctwaContext:r.ctwaContext,ephemeralDuration:i,ephemeralSettingTimestamp:o},f),F=e.waitForPrep().then((e=>{var t=e.mediaBlob;return!t||t instanceof R.default?Promise.resolve(e):R.default.createFromData(t,t.type).then((t=>(e.mediaBlob=t,e)))})).then((e=>{var a=e.filehash;a||(__LOG__(4,void 0,new Error,!0)`Assertion failed!`,SEND_LOGS("media-fault: sendToChat filehash undefined"));var i=T.getOrCreateMediaObject(a),n=i.mediaBlob;if(n&&(n.retain(),e.mediaBlob&&e.mediaBlob.autorelease(),e.mediaBlob=n),e.mediaBlob&&(e.renderableUrl=e.mediaBlob.url()),i.consolidate(e.toJSON()),e.mediaBlob&&e.mediaBlob.autorelease(),(0,C.shouldUseMediaCache)((0,b.castToV4)(i.type))&&e.mediaBlob){var s=e.mediaBlob.formData();E.default.put(a,s)}(0,O.downloadMedia)({mimetype:e.mimetype,mediaObject:i,downloadEvenIfExpensive:!0,mediaType:(0,b.msgToMediaType)({type:e.type,isGif:e.isGif}),rmrReason:P.default.WEBC_RMR_REASON_CODE.SEND_TO_CHAT,downloadOrigin:de(t,N),mode:"manual"});var o=i.msgProps(e);return o.caption=d,d||e.type!==A.OUTWARD_TYPES.DOCUMENT||(o.caption=e.filename),x.default.viewOnceWrite&&r.isViewOnce&&(o.isViewOnce=!0),o}));function B(){return Y.apply(this,arguments)}function Y(){return(Y=(0,s.default)((function*(e){S=e;var{mediaObject:r}=e;r||(__LOG__(4,void 0,new Error,!0)`Assertion failed!`,SEND_LOGS("media-fault: incorrect media object for created msg")),(0,l.default)(r,"msg is missing mediaObject");var a=(0,b.msgToMediaType)(e),i=r.entries.getUploadEntry(),s=i?{key:i.mediaKey,timestamp:i.mediaKeyTimestamp}:(0,L.default)(),{fullPreviewData:o,fullPreviewSize:d}=r.contentInfo,u=e.body;if(he(a)&&!o&&r.contentInfo.preview){var c=yield g.base64ImageToCanvas(r.contentInfo.preview.url()),h=yield g.generateMicroThumb(c,1300,{mimetype:"image/jpeg",maxAttempts:10});o=r.contentInfo.preview,d={width:h.width,height:h.height},u=j.default.parseDataURL(h.dataUrl).data}var f=o&&he(a),_=e.safe(),m=o&&f&&_.type===p.default.MSG_TYPE.DOCUMENT?fe({thumbnail:o,mediaKeyInfo:s,mediaType:re(_),uploadOrigin:Q(t),forwardedFromWeb:Boolean(e.forwardedFromWeb)}):Promise.resolve(null),v=(0,w.uploadMedia)({mimetype:e.mimetype,mediaObject:r,mediaType:a,forwardedFromWeb:Boolean(e.forwardedFromWeb),uploadOrigin:Q(t),mediaKeyInfo:s}),[{kind:E,mediaEntry:y},T]=yield Promise.all([v,m]),A=null==T?void 0:T.mediaEntry;if(I=E,!y)throw new Error("upload failed: media entry was not created");var C={};if(f){if(!(A&&T&&d)){var P={thumbnailResultEntry:A,uploadThumbnailResult:T,fullPreviewSize:d};throw __LOG__(4,void 0,new Error,!0)`upload failed: thumbnail data incomplete\nDebug info:${JSON.stringify(P)}`,SEND_LOGS("mms-thumbnail-data-incomplete"),new Error("upload failed: thumbnail data incomplete")}C={thumbnailDirectPath:A.directPath,thumbnailSha256:T.filehash,thumbnailEncSha256:A.encFilehash,thumbnailHeight:d.height,thumbnailWidth:d.width}}return ce(S,(0,n.default)({deprecatedMms3Url:y.deprecatedMms3Url,directPath:y.directPath,mediaKey:y.mediaKey,mediaKeyTimestamp:y.mediaKeyTimestamp,filehash:r.filehash,encFilehash:y.encFilehash,size:r.size,streamingSidecar:y.sidecar,firstFrameSidecar:y.firstFrameSidecar,body:u},C))}))).apply(this,arguments)}if(r.addEvenWhilePreparing){var K=r.placeholderProps||{};D=(0,U.addAndSendMsgToChat)(t,(0,n.default)((0,n.default)({},K),N),(e=>(S=e,F.then((e=>ce(S,e))).then((()=>B(S))))))[1]}else{var H=F.then((e=>{var t=r.useBasePropsType?N.type:e.type;return(0,n.default)((0,n.default)((0,n.default)({},N),e),{},{type:t})}));D=(0,U.addAndSendMsgToChat)(t,H,B)[1]}return D.then((e=>({result:e,error:null}))).catch((e=>({result:null,error:e}))).then((({result:e,error:t})=>{var r,a;if(e===G.SendMsgResult.OK)return G.SendMsgResult.OK;var i=null===(r=S)||void 0===r||null===(a=r.mediaObject)||void 0===a?void 0:a.uploadStage;if(S&&(S.ack=p.default.ACK.FAILED),I===w.UploadMediaResultKind.CANCELLATION)return __LOG__(2)`Media:sendToChat canceled`,G.SendMsgResult.ERROR_CANCELLED;if(__LOG__(3)`Media:sendToChat error\nresult: ${e}\nuploadStage: ${i}\nuploadResultKind: ${I}\nerror: ${String(t)}`,null!=i)switch(i){case A.UPLOAD_STAGE.NEED_UPLOAD:case A.UPLOAD_STAGE.ERROR_TOO_LARGE:return G.SendMsgResult.ERROR_UPLOAD;case A.UPLOAD_STAGE.ERROR_MISSING:return G.SendMsgResult.ERROR_EXPIRED}return I===w.UploadMediaResultKind.ERROR?G.SendMsgResult.ERROR_UPLOAD:null!=e?e:G.SendMsgResult.ERROR_UNKNOWN}))}function ce(e,t){return(0,K.updateLocal)(e.id,t).then((()=>{e.set(t)}))}function pe(e,t,r){var a,i,n=(a=e,i={},A.MAPPED_STICKER_PROPS.forEach((e=>{var t=a[e],r=A.MSG_TO_MEDIA[e];i[r]=t})),i);if(e.mediaData.set(n),t){e.mediaObject=t;var{deprecatedMms3Url:s,encFilehash:o}=e;if((o||s)&&!t.entries.has({encFilehash:o,deprecatedMms3Url:s}))t.entries.addEntry({deprecatedMms3Url:s,mediaKey:e.mediaKey,mediaKeyTimestamp:e.mediaKeyTimestamp,encFilehash:o,type:r,directPath:e.directPath,debugHint:"setMediaObjectValues"})&&t.downloadStage===A.DOWNLOAD_STAGE.ERROR_MISSING&&(n.downloadStage=A.DOWNLOAD_STAGE.INIT);t.consolidate(n)}}function he(e){return x.default.webUploadDocumentThumbMmsEnabled&&e===b.default.DOCUMENT}function fe(){return _e.apply(this,arguments)}function _e(){return(_e=(0,s.default)((function*(e){var{thumbnail:t,mediaType:r,mediaKeyInfo:a,uploadOrigin:i,forwardedFromWeb:s,signal:o}=e,l=new S.default;try{var d=yield(0,N.default)((0,Y.getHash)(t),o);l.filehash=d,l.mediaBlob=t;var c=yield(0,N.default)((0,w.uploadMedia)({mimetype:"image/jpeg",mediaObject:l,mediaType:r,forwardedFromWeb:s,uploadOrigin:i,mediaKeyInfo:a}),o);return c.kind===w.UploadMediaResultKind.SUCCESS?(0,n.default)((0,n.default)({},c),{},{filehash:d}):{kind:c.kind}}catch(e){if(e.name===u.ABORT_ERROR)return J(l),{kind:w.UploadMediaResultKind.CANCELLATION};throw e}}))).apply(this,arguments)}t.MediaPrep=V},19552:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.checkAndRepair=function(e,t){var r=new n.default.WebcMediaAnalyzed;return(a={type:"prep",file:e,asGif:t},new Promise(((e,t)=>{__LOG__(2)`MediaAnalyzer:sendMessageToWorker`,o=i||new s.default,i=void 0,o.onmessage=r=>{try{r.data&&"log"===r.data.type?__LOG__(2)`(via Milan) ${r.data.msg}`:e(r.data)}catch(e){t(e)}},o.onerror=e=>{t(`Milan.onerror = ${e&&e.message?e.message:e}`)},o.postMessage(a)})).finally((()=>{o&&(o.terminate(),i=new s.default)}))).then((({type:e,result:t,error:r,filename:a,file:i})=>{switch(e){case"result":return __LOG__(2)`MediaAnalyzer:checkAndRepair approved file`,t;case"parsingError":return __LOG__(2)`trouble parsing file ${i} (fossil ${a}) ${String(r)}`,i&&(__LOG__(4,void 0,new Error,!0)`MediaAnalyzer:checkAndRepair got parsing error! ${String(r)}`,SEND_LOGS("media-parsing-error")),void __LOG__(2)`MediaAnalyzer:checkAndRepair rejected file (${String(r)})`}})).catch((e=>{__LOG__(4,void 0,new Error,!0)`MediaAnalyzer:checkAndRepair got error! ${String(e)}`,SEND_LOGS("media-detection-error")})).finally((t=>{if(r){var a=void 0;if(e.name){var i=e.name.split(".");i.length>1&&(a=i[i.length-1])}r.set({webcMediaSupported:!!t,webcMediaExtensions:a}),r.markWebcMediaAnalyzeT(),r.commit()}}));var a,o};var i,n=a(r(84161)),s=a(r(77012))},86619:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(r(70417)),s=a(r(99778)),o=r(50581),l=i(r(11159)),d=r(60301);class u extends s.default{constructor(...e){super(...e),this.type=(0,s.prop)(d.OUTWARD_TYPES.UNKNOWN),this.directPath=(0,s.prop)(),this.mediaKey=(0,s.prop)(),this.mediaKeyTimestamp=(0,s.prop)(),this.encFilehash=(0,s.prop)(),this.mediaStage=(0,s.prop)(d.MEDIA_DATA_STAGE.INIT),this.size=(0,s.prop)(),this.filehash=(0,s.prop)(),this.mimetype=(0,s.prop)(),this.mediaBlob=(0,s.prop)(),this.renderableUrl=(0,s.prop)(),this.fullHeight=(0,s.prop)(),this.fullWidth=(0,s.prop)(),this.aspectRatio=(0,s.prop)(),this.rgbaBuffer=(0,s.prop)(),this.rgbaHeight=(0,s.prop)(),this.rgbaWidth=(0,s.prop)(),this.animationDuration=(0,s.prop)(0),this.animatedAsNewMsg=(0,s.prop)(!1),this.isAnimated=(0,s.prop)(),this.singleLoopDuration=(0,s.prop)(),this.firstFrameLength=(0,s.prop)(),this.firstFrameSidecar=(0,s.prop)(),this.emojis=(0,s.prop)(),this.progressiveStage=(0,s.prop)(),this.isViewOnce=(0,s.prop)(!1),this.preview=(0,s.prop)(),this.sidecar=(0,s.prop)(),this.duration=(0,s.prop)(),this.durationFloat=(0,s.prop)(),this.isGif=(0,s.prop)(),this.gifAttribution=(0,s.prop)(),this.streamable=(0,s.derived)(this._isStreamable,["isGif","isViewOnce","mediaStage","sidecar","type","_swStreamingSupported"]),this._swStreamingSupported=(0,s.prop)(!1),this._listeningToSwSupport=(0,s.prop)(!1),this.filename=(0,s.prop)(),this.pageCount=(0,s.prop)(),this.documentPreview=(0,s.prop)(),this.isVcardOverMmsDocument=(0,s.prop)(!1),this.parsedVcards=(0,s.prop)(),this.fullPreviewSize=(0,s.prop)(),this.fullPreviewData=(0,s.prop)(),this.subtype=(0,s.prop)()}initialize(){super.initialize()}set(e,t,r){var a,i=r;return"string"==typeof e?a={[e]:t}:(a=e,i=t),a=function(e){var t=e.filename||e.caption;if(t&&e.type===c.TYPE.DOCUMENT)return t=(0,o.cleanFilename)(t),(0,n.default)((0,n.default)({},e),{},{filename:t,caption:t});return e}(a),super.set(a,i)}_isStreamable(){return this.isStreamable()}isStreamable(){return this.isStreamableType()&&this.listenToServiceWorkerSupport()&&!this.isViewOnce}_updateStreamingSupported(e){this._swStreamingSupported=e}listenToServiceWorkerSupport(){if(this._listeningToSwSupport)return this._swStreamingSupported;var e=r(55074).default;return this.listenTo(e,"change:streamingSupported",this._updateStreamingSupported),this._swStreamingSupported=Boolean(e.streamingSupported),this._listeningToSwSupport=!0,this._swStreamingSupported}isStreamableType(){return this.type===d.OUTWARD_TYPES.VIDEO&&!this.isGif&&(this.mediaStage===d.MEDIA_DATA_STAGE.INIT||this.mediaStage===d.MEDIA_DATA_STAGE.FETCHING||this.mediaStage===d.MEDIA_DATA_STAGE.DECRYPTING||this.mediaStage===d.MEDIA_DATA_STAGE.RESOLVED)&&null!=this.fullWidth&&null!=this.fullHeight&&Boolean(this.sidecar&&this.sidecar.byteLength>0)}isDownloadable(){return!this.isViewOnce&&(null!=this.renderableUrl||l.default.has(this.filehash)||this.mediaStage===d.MEDIA_DATA_STAGE.EXISTS||this.mediaStage===d.MEDIA_DATA_STAGE.PROGRESSIVE_READY)}}u.Proxy="mediaData";var c=(0,s.defineModel)(u);c.TYPE=d.OUTWARD_TYPES;var p=c;t.default=p},22611:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.MediaEntryList=t.MediaEntry=void 0;var i=r(87288),n=a(r(41790)),s=a(r(62957)),o=a(r(37009)),l=a(r(9856)),d="PROBABLY_ON_SERVER",u="PROBABLY_OFF_SERVER",c="UNKNOWN";class p{constructor(e,t,r,a,i,n,s,o,l,d){this.useBackupUrl=!1,this._encFilehashPromise=null,this.deprecatedMms3Url=e,this.mediaKey=t,this.mediaKeyTimestamp=r,this.encFilehash=a,this.serverStatus=c,this.sidecar=n,this.directPath=s,this.firstFrameSidecar=o,this.type=i,this.scansSidecar=l,this.scanLengths=d}url(e){var{useFallback:t,forceHashUrl:r}=e||{},{encFilehash:a}=this;return a?s.default.getHostsInfo({operation:o.default.DOWNLOAD,encFilehash:a,type:this.type}).then((({selectedHost:e,fallbackHost:i})=>{var s=t&&i?i:e;return(0,n.default)({directPath:r?null:this.directPath,encFilehash:a,hostname:s.hostname,type:this.type})})):Promise.reject(new Error("media_entry: encFilehash does not exist"))}markWhetherOnServer(e){this.serverStatus=e?d:u}}t.MediaEntry=p;function h(e){e.entries.sort(((e,t)=>{var r=f(t)-f(e);return 0===r?t.mediaKeyTimestamp-e.mediaKeyTimestamp:r}))}function f(e){var t=0;switch(e.serverStatus){case d:t+=200;break;case u:break;case c:t+=100}return e.encFilehash?t+=20:e._encFilehashPromise&&(t+=10),t}t.MediaEntryList=class{constructor(){this.entries=[]}_updateEntry({foundEntry:e,mediaKey:t,mediaKeyTimestamp:r,encFilehash:a,sidecar:n,directPath:s,firstFrameSidecar:o,scansSidecar:l,scanLengths:d,deprecatedMms3Url:u}){if(t&&!(0,i.b64Equal)(e.mediaKey,t)){var c=e.mediaKey.replace("=","").split("\n")[0],p=t.replace("=","").split("\n")[0];return __LOG__(4,void 0,new Error,!0)`media-fault: mediaKey changed for the same MMS3 url. type:${e.type}. equal?:${c===p}. Debug:\n${JSON.stringify({before:{hasDirectPath:Boolean(e.directPath),hasEncFilehash:Boolean(e.encFilehash),hasMediaKey:Boolean(e.mediaKey),hasDeprecatedMms3Url:Boolean(e.deprecatedMms3Url)},after:{hasDirectPath:Boolean(s),hasEncFilehash:Boolean(a),hasDeprecatedMms3Url:Boolean(u)}},null,2)}`,SEND_LOGS("media-key-mismatch-same-mms3-url"),null}return null!=r&&(e.mediaKeyTimestamp=r),n&&(e.sidecar=n),o&&(e.firstFrameSidecar=o),l&&(e.scansSidecar=l),(null==d?void 0:d.length)&&(e.scanLengths=d),e.directPath=s,e}updateEntry({deprecatedMms3Url:e,mediaKey:t,mediaKeyTimestamp:r,encFilehash:a,type:i,sidecar:n,directPath:s,firstFrameSidecar:o,scansSidecar:l,scanLengths:d}){var u=this.getEntryByEncFilehash({encFilehash:a,deprecatedMms3Url:e});if(u)return this._updateEntry({foundEntry:u,mediaKey:t,mediaKeyTimestamp:r,encFilehash:a,sidecar:n,directPath:s,firstFrameSidecar:o,scansSidecar:l,scanLengths:d,deprecatedMms3Url:e})}addEntry(e){var{deprecatedMms3Url:t,mediaKey:r,mediaKeyTimestamp:a,encFilehash:i,type:n,sidecar:s,directPath:o,firstFrameSidecar:l,scansSidecar:d,scanLengths:u,debugHint:c}=e;null==i&&(__LOG__(4,void 0,new Error,!0)`Media type ${n} from ${c} is missing encFilehash`,SEND_LOGS(`media-entry-missing-upload-hash-${n}-${c}`));var h=this.entries,f=this.getEntryByEncFilehash({encFilehash:i,deprecatedMms3Url:t}),_=f?this._updateEntry({foundEntry:f,mediaKey:r,mediaKeyTimestamp:a,encFilehash:i,sidecar:s,directPath:o,firstFrameSidecar:l,scansSidecar:d,scanLengths:u,deprecatedMms3Url:t}):null;if(_)return _;if(!r)return null;var m=new p(t,r,a,i,n,s,o,l,d,u);return h.push(m),m}_getKey({encFilehash:e,deprecatedMms3Url:t}){return null==e?`mms3:${t}`:e}has(e){return null!=this.getEntryByEncFilehash(e)}getEntryByEncFilehash(e){var t=this._getKey(e);return this.entries.find((e=>this._getKey(e)===t))}getUploadEntry(){return h(this),this.entries.find((e=>(0,l.default)(e.mediaKeyTimestamp)))||null}getDownloadEntry(){h(this);var e=this.entries[0];return e&&e.serverStatus!==u?e:null}}},27425:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.consolidate=_,t.webMediaTypeToWamMediaType=function(e){switch(e){case"VIDEO":return 3;case"IMAGE":return 2;case"AUDIO":return 4;case"STICKER":return 16;case"DOCUMENT":return 8;case"PRODUCT":return 18;default:throw new Error(`web media type is invalid: ${e}`)}},t.default=void 0;var i=a(r(70417)),n=r(35160),s=a(r(23045)),o=a(r(23130)),l=r(22611),d=a(r(79843)),u=r(60301),c=r(25332),p=(a(r(84161)),a(r(93013))),h=a(r(13668)),f=r(24144);function _(e,t){var r=e.contentInfo,a=!1,i=function(e){switch(e){case u.OUTWARD_TYPES.IMAGE:case u.OUTWARD_TYPES.PRODUCT:return u.TYPE.IMAGE;case u.OUTWARD_TYPES.VIDEO:return u.TYPE.VIDEO;case u.OUTWARD_TYPES.STICKER:return u.TYPE.STICKER;case u.OUTWARD_TYPES.AUDIO:case u.OUTWARD_TYPES.PTT:return u.TYPE.AUDIO;case u.OUTWARD_TYPES.DOCUMENT:default:return}}(t.type,t.subtype);i&&!e.type&&(e.type=i,a=!0);var{downloadStage:n,uploadStage:s}=t;n&&n!==e.downloadStage&&(e.downloadStage=n,a=!0),s&&s!==e.uploadStage&&(e.uploadStage=s,a=!0),t.resolvedPreview&&!r.preview&&(t.resolvedPreview.retain(),r.preview=t.resolvedPreview,a=!0),null!=t.progressiveStage&&t.progressiveStage!==e.progressiveStage&&(e.progressiveStage=t.progressiveStage,a=!0);var o=t.mediaBlob;o&&!o.isBlobEqual(e.mediaBlob)&&(e.mediaBlob&&e.clearBlob(),o.retain(),e.mediaBlob=o,e.size=o.size(),a=!0),null!=t.size&&(null==e.size||t.size<e.size)&&(e.size=t.size,a=!0),t.filehash&&!e.filehash&&(e.filehash=t.filehash,a=!0),t.parsedVcards&&t.parsedVcards!==e.parsedVcards&&(e.parsedVcards=t.parsedVcards,a=!0);for(var l=e.contentFields(),d=0;d<l.length;d++){var c=l[d];switch(c){case"preview":t.preview&&!r._preview&&(e.runProcessIfNotRunBefore("preview",E,t.preview),r._preview=t.preview,a=!0);break;case"fullWidth":case"fullHeight":case"aspectRatio":var p=t[c];null!=p&&0!==p&&r[c]!==p&&(r[c]=p,a=!0);break;case"animationDuration":case"singleLoopDuration":var h=t[c];null!=h&&h!==r[c]&&(r[c]=h,a=!0);break;default:var f=t[c];void 0!==f&&void 0===r[c]&&(r[c]=f,a=!0)}}return null!=r.aspectRatio&&0!==r.aspectRatio||(null!=r.fullWidth&&0!==r.fullWidth&&null!=r.fullHeight&&0!==r.fullHeight?(r.aspectRatio=r.fullWidth/r.fullHeight,a=!0):r.preview&&e.runProcessIfNotRunBefore("aspectRatio",y,r.preview)),a}function m(e,t,r){for(var a=0;a<r.length;a++){var i=r[a];e[i]=t[i]}}function g(e,t){return t.filehash?e.id.fromMe&&e.ack<s.default.ACK.SENT?(e.local||(__LOG__(4,void 0,new Error,!0)`Assertion failed!`,SEND_LOGS("media-fault: unsent media system message not local")),function(e){switch(e.uploadStage){case u.UPLOAD_STAGE.INIT:case u.UPLOAD_STAGE.PREPARING:return u.MEDIA_DATA_STAGE.PREPARING;case u.UPLOAD_STAGE.UPLOADING:return u.MEDIA_DATA_STAGE.UPLOADING;case u.UPLOAD_STAGE.NEED_UPLOAD:return u.MEDIA_DATA_STAGE.NEED_UPLOAD;case u.UPLOAD_STAGE.ERROR_MISSING:return u.MEDIA_DATA_STAGE.ERROR_MISSING;case u.UPLOAD_STAGE.ERROR_TOO_LARGE:return u.MEDIA_DATA_STAGE.ERROR_TOO_LARGE;case u.UPLOAD_STAGE.UPLOADED:return u.MEDIA_DATA_STAGE.SENDING}}(t)):v(t):u.MEDIA_DATA_STAGE.PREPARING}function v(e){switch(e.downloadStage){case u.DOWNLOAD_STAGE.INIT:return u.MEDIA_DATA_STAGE.INIT;case u.DOWNLOAD_STAGE.EXISTS:return u.MEDIA_DATA_STAGE.EXISTS;case u.DOWNLOAD_STAGE.PREPARING:return u.MEDIA_DATA_STAGE.PREPARING;case u.DOWNLOAD_STAGE.REUPLOADING:return u.MEDIA_DATA_STAGE.REUPLOADING;case u.DOWNLOAD_STAGE.FETCHING:return u.MEDIA_DATA_STAGE.FETCHING;case u.DOWNLOAD_STAGE.PROCESSING:return u.MEDIA_DATA_STAGE.DECRYPTING;case u.DOWNLOAD_STAGE.NEED_POKE:return u.MEDIA_DATA_STAGE.NEED_POKE;case u.DOWNLOAD_STAGE.ERROR_MISSING:return u.MEDIA_DATA_STAGE.ERROR_MISSING;case u.DOWNLOAD_STAGE.ERROR_UNSUPPORTED:return u.MEDIA_DATA_STAGE.ERROR_UNSUPPORTED;case u.DOWNLOAD_STAGE.RESOLVED:return u.MEDIA_DATA_STAGE.RESOLVED;case u.DOWNLOAD_STAGE.PROGRESSIVE_READY:return u.MEDIA_DATA_STAGE.PROGRESSIVE_READY}}function E(e){return p.default.createFromBase64Jpeg(e).then((e=>(e.autorelease(),{resolvedPreview:e})))}function y(e){return(0,c.getImageWidthHeight)(e).then((({width:e,height:t})=>({aspectRatio:e/t})))}t.default=class{constructor(){this._msgs=[],this._notifyTimer=new n.ShiftTimer((()=>{!function(e){var t={};m(t,e,u.FIELDS.RAW),m(t,e.contentInfo,e.contentFields()),e.mediaBlob&&(t.renderableUrl=e.mediaBlob.url());for(var r=e._msgs,a=r.length,i=0;i<a;i++){var[n,o]=r[i];if(!o){if(n.type!==s.default.MSG_TYPE.CIPHERTEXT){t.mediaStage=g(n,e);for(var l=0;l<u.MSG_SPECIFIC_FIELDS.length;l++){var d=u.MSG_SPECIFIC_FIELDS[l];t[d]=n[u.MEDIA_TO_MSG[d]]}}else{delete t.mediaStage;for(var c=0;c<u.MSG_SPECIFIC_FIELDS.length;c++)delete t[u.MSG_SPECIFIC_FIELDS[c]]}n.mediaData.set(t)}}for(var p=r.length-1;p>=0;p--)r[p][1]&&r.splice(p,1);var h=e._callOnConsolidate;!e._pendingChanges&&h&&(e._callOnConsolidate=null,h.forEach((e=>{e()})));e._saveMedia&&e._saveMedia(e)}(this),function(e){var t={};m(t,e,u.FIELDS.RAW),m(t,e.contentInfo,e.contentFields()),e.mediaBlob&&(t.renderableUrl=e.mediaBlob.url());var r=v(e);e._stickers=e._stickers.filter((([e,t])=>!t)),e._stickers.forEach((([e,a])=>{e.mediaData.set((0,i.default)((0,i.default)({},t),{},{mediaStage:r}))})),e._stickerPacks=e._stickerPacks.filter((([e,t])=>!t)),e._stickerPacks.forEach((([e,a])=>{e.mediaData.set((0,i.default)((0,i.default)({},t),{},{mediaStage:r}))})),!e._pendingChanges&&e._callOnConsolidate&&(e._callOnConsolidate.forEach((e=>{e()})),e._callOnConsolidate=null);e._saveMedia&&e._saveMedia(e)}(this)})),this._callOnConsolidate=null,this._keyedProcesses=null,this._pendingChangesCount=0,this._saveMedia=null,this._stickers=[],this._stickerPacks=[],this.entries=new l.MediaEntryList,this.downloadStage=u.DOWNLOAD_STAGE.INIT,this.uploadStage=u.UPLOAD_STAGE.INIT,this.userUploadAttemptCount=0,this.userDownloadAttemptCount=0,this.downloadPromise=null,this.uploadPromise=null,this.mediaBlob=null,this.size=void 0,this.filehash=void 0,this.contentInfo={},this.progressiveStage=void 0,this.parsedVcards=null}consolidate(e){return!!_(this,e)&&(this.notifyMsgsAsync(),!0)}clearBlob(){var e=this.mediaBlob;e&&(this.mediaBlob=null,e.autorelease())}contentFields(){var e=this.type||u.TYPE.DOCUMENT;return u.FIELDS[e]}resolveWhenConsolidated(){return this._notifyTimer.ts||this._pendingChanges?new Promise((e=>{this._callOnConsolidate?this._callOnConsolidate.push(e):this._callOnConsolidate=[e]})):Promise.resolve()}notifyMsgsAsync(){this._notifyTimer.debounce(0)}addMsg(e){for(var t=this._msgs,r=0;r<t.length;r++){var[a,i]=t[r];a!==e||i||(__LOG__(4,void 0,new Error,!0)`Assertion failed!`,SEND_LOGS("redundant-media-msg"))}t.push([e,!1]),this.notifyMsgsAsync()}removeMsg(e){for(var t=this._msgs,r=!1,a=0;!r&&a<t.length;a++){var[i,n]=t[a];i!==e||n||(t[a][1]=!0,r=!0)}}hasAssociatedMsgsOrStickers(){for(var e=this._msgs,t=0;t<e.length;t++)if(!e[t][1])return!0;return this.hasAssociatedStickers()||this.hasAssociatedStickerPacks()}associatedMsgs(){for(var e=this._msgs,t=[],r=0;r<e.length;r++){var[a,i]=e[r];i||t.push(a)}return t}rmr(e){var t=this.associatedStickers();if(t.length>0)return(0,f.rmrSticker)(this.entries,this._stickers,t[0]).then((e=>e.status));var r=this.associatedStickerPacks();if(r.length>0)return(0,f.rmrStickerPack)(this.entries,this._stickerPacks,r[0]).then((e=>e.status));var[a]=this._msgs.find((([e,t])=>!t&&!e.isUnsentPhoneMsg()))||[null];return a||(__LOG__(4,void 0,new Error,!0)`Assertion failed!`,SEND_LOGS("media-fault: rmr called on MediaObject with no msg")),a?(e.onMsgSelect(a),(0,h.default)(a).then((e=>{if(200===e.status){var{encFilehash:t}=a,r=e.isMD?this.entries.updateEntry({deprecatedMms3Url:a.deprecatedMms3Url,encFilehash:t,directPath:e.directPath}):this.entries.addEntry({deprecatedMms3Url:e.url,mediaKey:e.mediaKey||a.mediaKey,mediaKeyTimestamp:e.mediaKeyTimestamp,encFilehash:e.encFilehash,type:a.mediaData.type,directPath:e.directPath,debugHint:"rmr"});r||(__LOG__(4,void 0,new Error,!0)`Assertion failed!`,SEND_LOGS("media-fault: rmr entry can not be found")),null==r||r.markWhetherOnServer(!0)}return e.status}))):Promise.reject(new Error("rmr called on MediaObject with no msg"))}msgProps(e){var t={};m(t,this,u.FIELDS.RAW),m(t,this.contentInfo,this.contentFields()),m(t,e,u.MSG_SPECIFIC_FIELDS),t.preview=this.contentInfo._preview;var r={};for(var a in t){var i=u.MEDIA_TO_MSG[a];i&&(r[i]=t[a])}return r}delete(){this._saveMedia=null;var{cancelDownloadMedia:e,cancelUploadMedia:t}=r(27305);e(this),t(this),this.clearBlob()}runProcessIfNotRunBefore(e,t,r){var a=this._keyedProcesses;a||(a=this._keyedProcesses={}),a.hasOwnProperty(e)||(this._pendingChangesCount++,a[e]=Promise.resolve(r).then(t).then((e=>{this.consolidate(e)})).finally((()=>{this._pendingChangesCount--,0===this._pendingChangesCount&&this.notifyMsgsAsync()})))}getPendingProcess(e){return 0!==this._pendingChangesCount&&this._keyedProcesses&&this._keyedProcesses.hasOwnProperty(e)?this._keyedProcesses[e]:Promise.resolve()}videoStreamingInfo(e){if(this.type!==u.TYPE.VIDEO)return __LOG__(4,void 0,new Error,!0)`type: ${String(this.type)}`,SEND_LOGS("media-fault: media streaming info request for non-video type"),null;var t=this.entries.getDownloadEntry();return t&&t.sidecar?Promise.all([(0,o.default)(d.default.VIDEO,t.mediaKey),t.url()]).then((([r,a])=>({cryptoKeys:(0,i.default)((0,i.default)({},r),{},{cipherKey:r.encKey,sidecar:t.sidecar}),streamData:{clientUrl:a,size:this.size,msgKey:e}}))):null}addStickerPack(e){for(var t=this._stickerPacks,r=0;r<t.length;r++){var[a,i]=t[r];a!==e||i||(__LOG__(4,void 0,new Error,!0)`Assertion failed!`,SEND_LOGS("redundant-sticker-pack-add"))}t.push([e,!1]),this.notifyMsgsAsync()}addSticker(e){for(var t=this._stickers,r=0;r<t.length;r++){var[a,i]=t[r];a!==e||i||(__LOG__(4,void 0,new Error,!0)`Assertion failed!`,SEND_LOGS("redundant-sticker-add"))}t.push([e,!1]),this.notifyMsgsAsync()}removeSticker(e){for(var t=this._stickers,r=!1,a=0;!r&&a<t.length;a++){var[i,n]=t[a];i!==e||n||(t[a][1]=!0,r=!0)}}removeStickerPack(e){for(var t=this._stickerPacks,r=!1,a=0;!r&&a<t.length;a++){var[i,n]=t[a];i!==e||n||(t[a][1]=!0,r=!0)}}hasAssociatedStickers(){return this._stickers.some((([e,t])=>!t))}hasAssociatedStickerPacks(){return this._stickerPacks.some((([e,t])=>!t))}associatedStickers(){return this._stickers.reduce(((e,[t,r])=>r?e:e.concat(t)),[])}associatedStickerPacks(){return this._stickerPacks.reduce(((e,[t,r])=>r?e:e.concat(t)),[])}toJSON(){return{mediaBlob:this.mediaBlob,size:this.size,filehash:this.filehash,type:this.type,contentInfo:this.contentInfo,downloadStage:this.downloadStage,uploadStage:this.uploadStage}}}},24144:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.rmrSticker=function(e,t,r){r||(__LOG__(4,void 0,new Error,!0)`Assertion failed!`,SEND_LOGS("media-fault: rmr called on MediaObject without sticker"));return o.default.mediaUpload("sticker",r.id).tap((r=>{var a=r.sticker;if(200===r.status&&a){t.forEach((([e,t])=>{t||(e.directPath===a.directPath&&(__LOG__(4,void 0,new Error,!0)`Assertion failed!`,SEND_LOGS("rmrSticker:same-direct-path-after-rmr")),a.mediaKey=(0,n.default)((0,s.default)(a.mediaKey),"sanitizeBase64(nextSticker.mediaKey)"),e.deprecatedMms3Url=a.url,e.filehash=a.filehash,e.width=a.width,e.height=a.height,e.mediaKey=a.mediaKey,e.mediaKeyTimestamp=0,e.directPath=a.directPath,e.encFilehash=a.encFilehash,a.mimetype&&(e.mimetype=a.mimetype))}));var o=e.addEntry({deprecatedMms3Url:a.url,mediaKey:a.mediaKey,mediaKeyTimestamp:0,encFilehash:a.encFilehash,type:i.default.STICKER,directPath:a.directPath,debugHint:"rmrSticker"});o&&o.markWhetherOnServer(!0)}}))},t.rmrStickerPack=function(e,t,r){r||(__LOG__(4,void 0,new Error,!0)`Assertion failed!`,SEND_LOGS("media-fault: rmr called on MediaObject without stickerPack"));return o.default.mediaUpload("sticker-pack",r.id).tap((r=>{var a=r.stickerPack;if(200===r.status&&a){t.forEach((([e,t])=>{t||(e.directPath===a.directPath&&(__LOG__(4,void 0,new Error,!0)`Assertion failed!`,SEND_LOGS("rmrStickerPack:same-direct-path-after-rmr")),e.url=a.url,e.filehash=a.filehash,e.mediaKey=a.mediaKey,e.mediaKeyTimestamp=0,e.directPath=a.directPath,e.encFilehash=a.encFilehash,a.mimetype&&(e.mimetype=a.mimetype))}));var n=e.addEntry({deprecatedMms3Url:a.url,mediaKey:a.mediaKey,mediaKeyTimestamp:0,encFilehash:a.encFilehash,type:i.default.IMAGE,directPath:a.directPath,debugHint:"rmrStickerPack"});n&&n.markWhetherOnServer(!0)}}))};var i=a(r(79843)),n=a(r(21830)),s=a(r(32369)),o=a(r(94407))},27264:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.associateMediaWithMsg=function(e,t){e.addMsg(t)},t.disassociateMediaFromMsg=function(e,t){if(t.mediaObject=null,e.removeMsg(t),e.hasAssociatedMsgsOrStickers())return;var{filehash:r}=e;r&&delete l[r];r&&(0,s.shouldUseLruMediaStore)((0,n.msgToMediaType)(t))&&o.default.del(r);e.delete()},t.delistAndDeleteAllMedia=function(){var e=l;for(var t in l={},e)e[t].delete()},t.getOrCreateMediaObject=function(e){return l.hasOwnProperty(e)?l[e]:l[e]=new i.default},t.clearMediaForChat=function(){},t.associateMediaWithStickerPack=function(e,t){e.addStickerPack(t)},t.disassociateMediaFromStickerPack=function(e,t){if(t.mediaObject=null,e.removeStickerPack(t),e.hasAssociatedMsgsOrStickers())return;var{filehash:r}=e;r&&delete l[r];r&&o.default.del(r);e.delete()},t.associateMediaWithSticker=function(e,t){e.addSticker(t)},t.disassociateMediaFromSticker=function(e,t){if(t.mediaObject=null,e.removeSticker(t),e.hasAssociatedMsgsOrStickers())return;var{filehash:r}=e;r&&delete l[r];r&&o.default.del(r);e.delete()};var i=a(r(27425)),n=r(79843),s=r(25332),o=a(r(35283)),l={}},60301:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TYPE=t.OUTWARD_TYPES=t.MEDIA_DATA_STAGE=t.UPLOAD_STAGE=t.DOWNLOAD_STAGE=t.MSG_SPECIFIC_FIELDS=t.FIELDS=t.MEDIA_MSG_PROPS=t.MAPPED_STICKER_PROPS=t.MAPPED_MEDIA_PROPS=t.MAPPED_MSG_PROPS=t.MSG_TO_MEDIA=t.MEDIA_TO_MSG=void 0;var a=Object.freeze({preview:"body",mediaKey:"mediaKey",mediaKeyTimestamp:"mediaKeyTimestamp",size:"size",filehash:"filehash",mimetype:"mimetype",duration:"duration",pageCount:"pageCount",fullHeight:"height",fullWidth:"width",type:"type",filename:"filename",caption:"caption",isGif:"isGif",gifAttribution:"gifAttribution",sidecar:"streamingSidecar",subtype:"subtype",firstFrameLength:"firstFrameLength",firstFrameSidecar:"firstFrameSidecar",isAnimated:"isAnimated",isVcardOverMmsDocument:"isVcardOverMmsDocument",isViewOnce:"isViewOnce"});t.MEDIA_TO_MSG=a;var i=Object.freeze({body:"preview",directPath:"directPath",mediaKey:"mediaKey",mediaKeyTimestamp:"mediaKeyTimestamp",size:"size",filehash:"filehash",mimetype:"mimetype",duration:"duration",pageCount:"pageCount",height:"fullHeight",width:"fullWidth",type:"type",filename:"filename",caption:"caption",isGif:"isGif",gifAttribution:"gifAttribution",streamingSidecar:"sidecar",subtype:"subtype",firstFrameLength:"firstFrameLength",firstFrameSidecar:"firstFrameSidecar",isAnimated:"isAnimated",isVcardOverMmsDocument:"isVcardOverMmsDocument",isViewOnce:"isViewOnce"});t.MSG_TO_MEDIA=i;var n=Object.keys(i);t.MAPPED_MSG_PROPS=n;var s=Object.keys(a);t.MAPPED_MEDIA_PROPS=s;t.MAPPED_STICKER_PROPS=["filehash","height","mimetype","size","type","width"];var o=[...n,"deprecatedMms3Url","encFilehash","streamable"];t.MEDIA_MSG_PROPS=o;var l=Object.freeze({VIDEO:Object.freeze(["aspectRatio","fullWidth","fullHeight","preview","duration","durationFloat","isViewOnce","fullPreviewData"]),AUDIO:Object.freeze(["duration"]),IMAGE:Object.freeze(["aspectRatio","fullWidth","fullHeight","preview","isViewOnce","fullPreviewData"]),PRODUCT:Object.freeze(["aspectRatio","fullWidth","fullHeight","preview"]),STICKER:Object.freeze(["animationDuration","singleLoopDuration","emojis","firstFrameLength","firstFrameSidecar","isAnimated","fullWidth","fullHeight","preview","rgbaBuffer","rgbaWidth","rgbaHeight","aspectRatio"]),STICKER_PACK:Object.freeze([]),DOCUMENT:Object.freeze(["aspectRatio","pageCount","preview","isVcardOverMmsDocument","parsedVcards","fullPreviewData","fullPreviewSize"]),RAW:Object.freeze(["mediaBlob","size","filehash","progressiveStage"])});t.FIELDS=l;t.MSG_SPECIFIC_FIELDS=["type","filename","caption","isGif","gifAttribution","mimetype","pageCount","sidecar","subtype","isViewOnce"];var d=r(28103).Mirrored(["INIT","EXISTS","PREPARING","REUPLOADING","FETCHING","PROCESSING","NEED_POKE","ERROR_MISSING","ERROR_UNSUPPORTED","PROGRESSIVE_READY","RESOLVED"]);t.DOWNLOAD_STAGE=d;var u=r(28103).Mirrored(["INIT","PREPARING","UPLOADING","NEED_UPLOAD","ERROR_MISSING","ERROR_TOO_LARGE","UPLOADED"]);t.UPLOAD_STAGE=u;var c=r(28103).Mirrored(["INIT","EXISTS","PREPARING","UPLOADING","SENDING","REUPLOADING","FETCHING","DECRYPTING","RESOLVED","NEED_POKE","NEED_UPLOAD","ERROR_MISSING","ERROR_TOO_LARGE","ERROR_UNSUPPORTED","PROGRESSIVE_READY","REMOTE_UPLOADING","REMOTE_NEED_UPLOAD"]);t.MEDIA_DATA_STAGE=c;t.OUTWARD_TYPES={IMAGE:"image",VIDEO:"video",AUDIO:"audio",PTT:"ptt",STICKER:"sticker",DOCUMENT:"document",PRODUCT:"product",UNKNOWN:"unknown"};var p=Object.freeze({VIDEO:"VIDEO",IMAGE:"IMAGE",AUDIO:"AUDIO",STICKER:"STICKER",DOCUMENT:"DOCUMENT",PRODUCT:"PRODUCT"});t.TYPE=p},92441:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t;try{t=e?JSON.parse(e):i.default}catch(e){return null}var r={};return s(t,r,"",""),r};var i=a(r(11284)),n=r(61864);function s(e,t,r,a){var i=e;if(Array.isArray(i)||(0,n.isString)(i)){(0,n.isString)(i)&&(i=[i]);for(var o=0;o<i.length;o++)t[i[o]]=a+r}else for(var l in i)s(i[l],t,l,a+r)}},6353:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.isAllowedDocumentMimetype=function(e,t,r=!1){for(var a in d){var i=d[a];if("document"===i.msgType)if((r?i.signatureMimetype:a)===e&&i.canSend&&t&&t.toLowerCase().endsWith(i.ext.toLowerCase()))return a}return r?e:e||"application/octet-stream"},t.getExtension=function(e){var t=d[e];return t?"."+(t.ext||e.split("/")[1]).toLowerCase():""},t.previewType=function(e){for(var t in d)if(d.hasOwnProperty(t)){var{previewType:r,signatureMimetype:a}=d[t];if(r&&(t===e||a===e))return r}},t.getMediaMimeType=function(e,t){var r=t;r.length>262&&(r=r.subarray(0,262));var a=(0,s.default)(r);if(a)return a.mime;if("image"===e)return"image/jpeg";throw new l.MediaEncryptionError("unknown mime decrypt error for type:"+e)},t.getDocTypes=function(){return(0,n.default)(d,(e=>"document"===e.msgType))},t.EXT_TO_MIME=t.DOC_MIMES=t.MIMETYPES=t.MIMETYPE_DETERMINING_LENGTH=void 0;var n=i(r(42208)),s=i(r(5025)),o=i(r(92441)),l=a(r(24461));t.MIMETYPE_DETERMINING_LENGTH=262;var d={"text/plain":{ext:"TXT",msgType:"document",icon:"icon-doc-txt",canSend:!0},"text/rtf":{ext:"RTF",msgType:"document",icon:"icon-doc-doc",canSend:!0,signatureMimetype:"application/rtf"},"text/vcard":{ext:"VCF",msgType:"vcard"},"application/zip":{ext:"ZIP",icon:"icon-doc-generic",msgType:"document"},"application/pdf":{ext:"PDF",msgType:"document",icon:"icon-doc-pdf",canSend:!0,signatureMimetype:"application/pdf",previewType:"pdf"},"application/msword":{ext:"DOC",msgType:"document",icon:"icon-doc-doc",canSend:!0,signatureMimetype:"application/x-msi",previewType:"msoffice"},"application/vnd.ms-excel":{ext:"XLS",msgType:"document",icon:"icon-doc-xls",canSend:!0,signatureMimetype:"application/x-msi",previewType:"msoffice"},"application/vnd.ms-powerpoint":{ext:"PPT",msgType:"document",icon:"icon-doc-ppt",canSend:!0,signatureMimetype:"application/x-msi",previewType:"msoffice"},"application/vnd.openxmlformats-officedocument.wordprocessingml.document":{ext:"DOCX",msgType:"document",icon:"icon-doc-doc",canSend:!0,signatureMimetype:"application/zip",previewType:"msoffice"},"application/vnd.openxmlformats-officedocument.presentationml.presentation":{ext:"PPTX",msgType:"document",icon:"icon-doc-ppt",canSend:!0,signatureMimetype:"application/zip",previewType:"msoffice"},"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":{ext:"XLSX",msgType:"document",icon:"icon-doc-xls",canSend:!0,signatureMimetype:"application/zip",previewType:"msoffice"},"audio/aac":{msgType:"audio",ext:"AAC"},"audio/mp4":{msgType:"audio"},"audio/amr":{msgType:"audio"},"audio/mpeg":{msgType:"audio"},"audio/ogg; codecs=opus":{msgType:"audio",ext:"OGG"},"audio/wav":{msgType:"audio",ext:"wav"},"video/mp4":{msgType:"video",ext:"MP4"},"video/3gpp":{msgType:"video"},"image/jpeg":{msgType:"image"},"image/png":{msgType:"image"}},u=d;t.MIMETYPES=u;t.DOC_MIMES="*";var c=(0,o.default)();t.EXT_TO_MIME=c},79843:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.castToV4=function(e){var t;if(null==e)t=o.DOCUMENT;else{if(!(e in o))throw new Error(`castToV4: unexpected mmsv3 type ${e}`);t=o[e]}return t},t.msgToMediaType=function({type:e,isGif:t}){switch(e){case s.IMAGE:return o.IMAGE;case s.VIDEO:return t?o.GIF:o.VIDEO;case s.AUDIO:return o.AUDIO;case s.PTT:return o.PTT;case s.DOCUMENT:return o.DOCUMENT;case s.STICKER:return o.STICKER;case s.PRODUCT:return o.PRODUCT;default:throw new Error(`msg is not a media msg: ${e}, isGif=${String(t)}`)}},t.MEDIA_TYPE_VALUES=t.default=void 0;var i=a(r(98346)),n=a(r(23045)),{MSG_TYPE:s}=n.default,o=Object.freeze({AUDIO:"audio",DOCUMENT:"document",GIF:"gif",IMAGE:"image",PPIC:"ppic",PRODUCT:"product",PTT:"ptt",STICKER:"sticker",VIDEO:"video",TEMPLATE:"template",THUMBNAIL_DOCUMENT:"thumbnail-document",THUMBNAIL_IMAGE:"thumbnail-image",THUMBNAIL_VIDEO:"thumbnail-video",THUMBNAIL_LINK:"thumbnail-link",HISTORY_SYNC:"md-msg-hist",MD_APP_STATE:"md-app-state",PRODUCT_CATALOG_IMAGE:"product-catalog-image"}),l=o;t.default=l;var d=(0,i.default)(o);t.MEDIA_TYPE_VALUES=d},37009:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r={DOWNLOAD:"DOWNLOAD",UPLOAD:"UPLOAD"};t.default=r},20116:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,i.default)(e)};var i=a(r(73950))},23289:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,r){var a=16*Math.ceil(e/16),s=t.slice(0,i.IV_LENGTH+a);return new n.default(r).sign(s,i.HMAC_LENGTH)};var i=r(19262),n=a(r(34601))},19262:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var r=e instanceof ArrayBuffer?e.byteLength:e.buffer.byteLength,a=new s.default(t),l=Math.ceil((r-16)/o),d=(0,i.default)(l,(t=>{var r=t*o,i=e.slice(r,r+16+o);return a.sign(i,10)}));return Promise.all(d).then((e=>(0,n.default)(...e)))},t.HMAC_LENGTH=t.IV_LENGTH=void 0;var i=a(r(61258)),n=a(r(36310)),s=a(r(34601)),o=65536;t.IV_LENGTH=16;t.HMAC_LENGTH=10},23130:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return u.apply(this,arguments)};var n=i(r(52954)),s=r(84337),o=a(r(24461)),l=a(r(25212)),d=i(r(79843));function u(){return(u=(0,n.default)((function*(e,t){var r,a=c(e);try{r=(0,s.decodeB64)(t)}catch(e){}if(!t||!a||!r)throw new o.MediaEncryptionError(`createKeys fail: !!mediakey: ${!!t} info: ${a} type: ${e}`);return l.extractAndExpand(r,a,112).then((e=>{if(!e||e.byteLength<112)throw new o.MediaEncryptionError("computeMediaKeys: hkdf error");return{iv:e.slice(0,16),encKey:e.slice(16,48),macKey:e.slice(48,80),refKey:e.slice(80,112)}}))}))).apply(this,arguments)}function c(e){switch(e){case d.default.AUDIO:return"WhatsApp Audio Keys";case d.default.DOCUMENT:return"WhatsApp Document Keys";case d.default.GIF:return"WhatsApp Video Keys";case d.default.IMAGE:return"WhatsApp Image Keys";case d.default.PPIC:throw new Error("Cannot create media keys for profile pics");case d.default.PRODUCT:return"WhatsApp Image Keys";case d.default.PTT:return"WhatsApp Audio Keys";case d.default.STICKER:return"WhatsApp Image Keys";case d.default.VIDEO:return"WhatsApp Video Keys";case d.default.THUMBNAIL_DOCUMENT:return"WhatsApp Document Thumbnail Keys";case d.default.THUMBNAIL_IMAGE:return"WhatsApp Image Thumbnail Keys";case d.default.THUMBNAIL_VIDEO:return"WhatsApp Video Thumbnail Keys";case d.default.THUMBNAIL_LINK:return"WhatsApp Link Thumbnail Keys";case d.default.TEMPLATE:throw new Error("Cannot create media keys for template");case d.default.HISTORY_SYNC:return"WhatsApp History Keys";case d.default.MD_APP_STATE:return"WhatsApp App State Keys";case d.default.PRODUCT_CATALOG_IMAGE:throw new Error("Cannot create media keys for product catalog image")}}},18974:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function({mediaKeys:e,ciphertextHmac:t,expectedPlaintextHash:r,debugString:a}){return Promise.resolve().then((()=>{if(__LOG__(2)`decryptMedia: [${a}] start`,t.byteLength<10)throw new d.MediaDecryptionError(`ciphertext too short: ${t.byteLength}`);var p=new c.default.WebcCryptoMedia({webcCryptoType:c.default.WEBC_CRYPTO_TYPE_CODE.DECRYPT,webcCryptoLibrary:c.default.WEBC_CRYPTO_LIBRARY_CODE.WEBCRYPTO,webcCryptoFileSize:t.byteLength}),{iv:h,encKey:f,macKey:_}=e,m=(0,s.default)(Uint8Array,t),g=(0,o.default)(Uint8Array,[new Uint8Array(h),m.slice(0,-10)]);return new u.default(_).sign(g,10).then((e=>{var t=m.buffer.slice(-10);if(!(0,l.default)(e,t))throw new d.MediaDecryptionError("decryptMedia: hmac mismatch");return(0,i.aesCbcDecrypt)(f,g)})).then((e=>null==r?e:(0,n.default)(e).then((t=>{if(t!==r)throw new d.MediaDecryptionError("decryptMedia: plaintext hash mismatch");return e})))).then((e=>(__LOG__(2)`decryptMedia: [${a}] success`,p.markWebcCryptoElapsedT(),p.commit(),e))).catch((e=>{if(__LOG__(3)`decryptMedia: [${a}] error`,e instanceof d.MediaDecryptionError)throw e;throw new d.MediaDecryptionError(`decryption error: ${String(e)}; stack: ${e.stack}`)}))}))};var i=r(74306),n=a(r(20116)),s=a(r(23977)),o=a(r(28017)),l=a(r(57829)),d=r(24461),u=a(r(34601)),c=a(r(84161))},47807:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.cleanupCiphertextAndIv=t.decrypt=t.HMAC_SIZE=t.BLOCK_SIZE=void 0;var i=a(r(28017)),n=r(64960);t.BLOCK_SIZE=16;t.HMAC_SIZE=10;var s=e=>{var{ciphertext:t,iv:r,mediaKeys:a}=e,{encKey:i}=a,s={name:"AES-CBC",iv:r};return(0,n.getCrypto)().importKey("raw",new Uint8Array(i),"AES-CBC",!1,["decrypt"]).catch((e=>{throw __LOG__(2)`decryptPartialMedia:decrypt importKey error: ${String(e)}`,e})).then((e=>(0,n.getCrypto)().decrypt(s,e,t))).catch((e=>{throw __LOG__(2)`decryptPartialMedia:decrypt decrypt error: ${String(e)}`,e}))};t.decrypt=s;var o=e=>{var t,{serverRangeStart:r,ciphertext:a,mediaKeys:s}=e,o=a instanceof Uint8Array?a:new Uint8Array(a),l=o.byteLength%16==0;return 0===r?t=new Uint8Array(s.iv):(t=o.slice(0,16),o=o.slice(16)),l||(o=o.slice(0,o.byteLength-10)),l?(e=>{var{ciphertext:t,mediaKeys:r}=e,{encKey:a}=r,i={name:"AES-CBC",iv:(t instanceof Uint8Array?t:new Uint8Array(t)).slice(-16)};return(0,n.getCrypto)().importKey("raw",new Uint8Array(a),"AES-CBC",!1,["encrypt"]).catch((e=>{__LOG__(2)`decryptPartialMedia:getEncryptedPadding importKey error: ${String(e)}`})).then((e=>{var t=new Uint8Array([]);return(0,n.getCrypto)().encrypt(i,e,t)})).catch((e=>{__LOG__(2)`decryptPartialMedia:getEncryptedPadding encrypt error: ${String(e)}`}))})({ciphertext:o,mediaKeys:s}).then((e=>({ciphertext:o=(0,i.default)(Uint8Array,[o,new Uint8Array(e)]),iv:t}))):Promise.resolve({ciphertext:o,iv:t})};t.cleanupCiphertextAndIv=o;var l=({mediaKeys:e,ciphertext:t})=>o({serverRangeStart:0,ciphertext:t,mediaKeys:e}).then((({ciphertext:t,iv:r})=>s({ciphertext:t,iv:r,mediaKeys:e})));t.default=l},57111:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function({mediaKey:e,plaintext:t,type:r}){return new Promise(((a,m)=>{if(e.slice(0,10),__LOG__(2)`encryptMedia: start`,!r)throw new c.MediaEncryptionError('encryptMedia: missing "type"');if(!e)throw new c.MediaEncryptionError('encryptMedia: missing "mediaKey"');var g=new f.default.WebcCryptoMedia({webcCryptoType:f.default.WEBC_CRYPTO_TYPE_CODE.ENCRYPT,webcCryptoLibrary:f.default.WEBC_CRYPTO_LIBRARY_CODE.WEBCRYPTO});(0,u.default)(r,e).then((({iv:e,encKey:a,macKey:u})=>(0,n.aesCbcEncrypt)(a,t,e).then((a=>{var n=a.slice(e.byteLength);return new p.default(u).sign(a,10).then((e=>{var c=Promise.resolve();if(r===h.default.VIDEO||r===h.default.AUDIO){var p=(0,d.default)(a,e);c=(0,l.default)(p,u)}var f=Promise.resolve();if(r===h.default.STICKER){var{firstFrameLength:m}=(0,_.default)(t);if(null!=m){var g=(0,d.default)(a,e);f=(0,o.default)(m,g,u)}}var v=(0,d.default)(n,e);return(0,i.promiseProps)({ciphertextHmac:v,hash:(0,s.default)(v),sidecar:c,firstFrameSidecar:f})}))})))).then((e=>{g.webcCryptoFileSize=e.ciphertextHmac.byteLength,g.markWebcCryptoElapsedT(),g.commit(),__LOG__(2)`encryptMedia: success`,a(e)})).catch((e=>{if(__LOG__(3)`encryptMedia: error`,e instanceof c.MediaEncryptionError)throw e;throw new c.MediaEncryptionError(`encryption error: ${String(e)}; stack: ${e.stack}`)})).catch(m)}))};var i=r(9737),n=r(74306),s=a(r(20116)),o=a(r(23289)),l=a(r(19262)),d=a(r(36310)),u=a(r(23130)),c=r(24461),p=a(r(34601)),h=a(r(79843)),f=a(r(84161)),_=a(r(57436))},5057:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.getProgressiveMediaCacheKey=_,t.default=t.EOI_TAG=void 0;var i=a(r(52954)),n=r(71436),s=r(74306),o=a(r(28017)),l=r(54168),d=a(r(57829)),u=a(r(34601)),c=a(r(11159));class p extends((0,n.customError)("ChunkValidationError")){constructor(e){super(`Chunk ${e} does not match sidecar`)}}var h=new Uint8Array([2,2]),f=new Uint8Array([255,217]);t.EOI_TAG=f;function _(e,t){return`${e}-progressive-${t}`}t.default=class{constructor(e){this._alignedScanLengths=[],this._increasingScanLengths=[],this._lastDecryptedChunk=0,this._downloadedBytes=new ArrayBuffer(0);var{cryptoKeys:t,scanLengths:r,scansSidecar:a,filehash:i,mimetype:n,debugString:s,onProgressiveUpdate:o}=e;this._cryptoKeys=t,this._scanLengths=r,this._scansSideCar=a,this._filehash=i,this._mimetype=n,this._nextChunkIV=this._cryptoKeys.iv,this._decryptedChunks=new Array(r.length),this._onProgressiveUpdate=o,this._debugString=s}_validateSidecar(e,t){0===t&&(this._nextChunkIV=this._cryptoKeys.iv);var{macKey:r}=this._cryptoKeys,a=this._scansSideCar.slice(10*t,10*t+10),i=this._nextChunkIV;this._nextChunkIV=e.slice(-16);var n=(0,o.default)(Uint8Array,[new Uint8Array(i),new Uint8Array(e)]);return new u.default(r).sign(n,10).then((e=>(0,d.default)(e,a)?Promise.resolve():Promise.reject(new p(t))))}_cleanupCipherTextAndIV(e,t){var r,a=e,i=a.byteLength%16==0;if(0===t)r=this._cryptoKeys.iv;else{var n=this._increasingScanLengths[t-1];r=this._downloadedBytes.slice(n-16,n)}return i||(a=a.slice(0,a.byteLength-10)),i?function(e,t){var{encKey:r}=t;return(0,s.aesCbcEncrypt)(r,h,new Uint8Array(e.slice(-16))).then((e=>e.slice(-16)))}(a,this._cryptoKeys).then((e=>({cipherText:a=(0,o.default)(Uint8Array,[new Uint8Array(a),new Uint8Array(e)]),iv:r}))):Promise.resolve({cipherText:a,iv:r})}_getLastFullyLoadedChunkIndex(e){for(var t=0,r=0;r<this._alignedScanLengths.length;r++)if(e<(t+=this._alignedScanLengths[r]))return r;return this._alignedScanLengths.length}_handleChunk(e,t){return this._validateSidecar(e,t).then((()=>this._cleanupCipherTextAndIV(e,t))).then((({iv:e,cipherText:t})=>(0,s.aesCbcDecrypt)(this._cryptoKeys.encKey,(0,o.default)(Uint8Array,[new Uint8Array(e),new Uint8Array(t)])))).then((e=>(0,l.removeEncryptedPadding)(e,h.buffer))).then((e=>(__LOG__(2)`ImageStreamer: [${this._debugString}] Successfully decrypted chunk ${t} of ${this._scanLengths.length} total`,e)))}_generateBlobFromFullyLoadedChunks(e){return Promise.all(this._decryptedChunks.slice(0,e)).then((t=>{var r,a=this._scanLengths.slice(0,e).reduce(((e,t)=>e+t),0),i=(0,o.default)(Uint8Array,t.map((e=>new Uint8Array(e)))).slice(0,a),n=(0,d.default)(f.buffer,i.slice(-f.length).buffer)?i:(0,o.default)(Uint8Array,[i,f]),s=[n],l=this._mimetype?new Blob(s,{type:this._mimetype}):new Blob(s),u=_(this._filehash,e);return c.default.put(u,l),__LOG__(2)`ImageStreamer: [${this._debugString}] Generated progressive image using ${e} chunks of ${this._scanLengths.length} total`,null===(r=this._onProgressiveUpdate)||void 0===r||r.call(this,e),this._lastDecryptedChunk=e,n.buffer}))}_decryptFullyLoadedChunks(e,t){var r=this;return(0,i.default)((function*(){for(var a=0;a<t;a++)if(!r._decryptedChunks[a]){var i=0===a?0:r._increasingScanLengths[a-1],n=e.slice(i,i+r._alignedScanLengths[a]);yield Promise.all(r._decryptedChunks),r._decryptedChunks[a]||(r._decryptedChunks[a]=r._handleChunk(n,a))}}))()}handleProgress(e,t){if(!this._alignedScanLengths.length){this._alignedScanLengths=(0,l.alignChunkLengthsToMultipleOfAesBlockSize)(this._scanLengths,e);for(var r=0;r<this._alignedScanLengths.length;r++){var a=this._alignedScanLengths[r],i=0===r?a:this._increasingScanLengths[r-1]+a;this._increasingScanLengths.push(i)}}var n,s,o="string"==typeof t?t.length:t.byteLength,d=this._getLastFullyLoadedChunkIndex(o);return d<=this._lastDecryptedChunk?Promise.resolve(null):(this._downloadedBytes="string"==typeof t?(n=t,(s=new Uint8Array(n.length)).set([...n].map((e=>e.codePointAt(0)))),s.buffer):t,this._decryptFullyLoadedChunks(this._downloadedBytes,d).then((()=>this._generateBlobFromFullyLoadedChunks(d))).catch((e=>{__LOG__(3)`ImageStreamer:handleProgress error: ${e}`;var t=`${e.message}, [${this._debugString}]scanLengths length: ${this._scanLengths.length}, scansSidecar byteLength: ${this._scansSideCar.byteLength}. Stack: ${e.stack}`;e instanceof p?(__LOG__(4,void 0,new Error,!0)`Assertion failed! ${t}`,SEND_LOGS("ImageStreamer:chunk validation error")):(__LOG__(4,void 0,new Error,!0)`Assertion failed! ${t}`,SEND_LOGS("ImageStreamer:handleProgress error"))})))}}},13415:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){var e=new Uint8Array(32);return self.crypto.getRandomValues(e),{key:(0,i.encodeB64)(e),timestamp:n.default.globalUnixTime()}};var i=r(84337),n=a(r(99461))},26082:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.DownloadManager=void 0;var n=i(r(70417)),s=i(r(52954)),o=i(r(45026)),l=i(r(16840)),d=i(r(21212)),u=i(r(23130)),c=r(54168),p=i(r(18974)),h=a(r(47807)),f=r(95378),_=i(r(5057)),m=r(69016),g=r(27425),v=i(r(79843)),E=r(60301),y=r(25332),S=i(r(79823)),T=i(r(84161)),A=i(r(20540)),b=r(26779),C=i(r(21830)),P=i(r(83082)),O=i(r(35283));function w(e){var t,r,a=null===(t=e.progressiveJpegOpts)||void 0===t?void 0:t.scanCount,i=null===(r=e.progressiveJpegOpts)||void 0===r?void 0:r.scanLengths;if(null!=a&&i)return`${e.filehash}-${a}/${i.length}-scans`;if(e.partialVideoOpts){var{secondsToDownload:n}=e.partialVideoOpts;return`${e.filehash}-${n}-seconds`}return e.filehash}var M=1,I=2,R=e=>{switch(e){case v.default.THUMBNAIL_DOCUMENT:return I;case v.default.VIDEO:default:return M}};class D{constructor(){this.preloader=new d.default(10,{thumbnail:4}),this.downloadAndDecrypt=(0,l.default)((e=>w(e)),new N,(e=>e.isPreload?this.preloader.enqueue((()=>L(e)),{priority:R(e.type),group:"thumbnail",signal:e.signal}):L(e))),this.rmr=(0,S.default)((e=>e.mediaObject.filehash||""),U),this.checkExistence=(0,S.default)((e=>e.encFilehash),F)}}t.DownloadManager=D;class N{get(e,t){return(0,s.default)((function*(){if(!(0,y.shouldUseLruMediaStore)(t.type))return null;try{return yield O.default.get(w(t))}catch(e){return __LOG__(3,!0)`downloadManager.asyncCache.get error:\n${(0,P.default)(e)}`,null}}))()}set(e,t,r){return(0,s.default)((function*(){if((0,y.shouldUseLruMediaStore)(r.type))try{yield O.default.put(w(r),t)}catch(e){__LOG__(3,!0)`downloadManager.asyncCache.set error:\n${(0,P.default)(e)}`}}))()}}function L(){return k.apply(this,arguments)}function k(){return(k=(0,s.default)((function*(e){var t,r,a=new T.default.MediaDownload2({mediaId:(0,m.generateMediaEventId)(),connectionType:T.default.CONNECTION_TYPE.HOSTNAME,overallMediaType:(0,m.getMetricMediaType)(e.type),overallMmsVersion:4,networkStack:T.default.NETWORK_STACK_TYPE.NATIVE,overallDownloadMode:T.default.MEDIA_DOWNLOAD_MODE_TYPE.FULL,overallAttemptCount:e.userDownloadAttemptCount,overallDownloadOrigin:e.downloadOrigin,overallBackendStore:null!==(t=(0,m.getMetricBackendStore)(e.directPath))&&void 0!==t?t:void 0}),{directPath:i,encFilehash:n,filehash:s,mediaKey:l,onDecryptStart:d,type:g,mode:v,progressiveJpegOpts:E,partialVideoOpts:y}=e,S=e.signal||(new o.default).signal,b=s.slice(0,10);__LOG__(2)`downloadManager.download: [${b}] start`;try{var O,w,M=null==E?void 0:E.scanCount,I=null!=M&&M===(null==E||null===(O=E.scanLengths)||void 0===O?void 0:O.length)?null:M,R=null;if(E&&null!=I)R={start:0,end:(0,c.alignChunkLengthsToMultipleOfAesBlockSize)(E.scanLengths).slice(0,I).reduce(((e,t)=>e+t),0)};else if(y){var{video:{size:D,duration:N},secondsToDownload:L}=y,k=Math.max(D*L/N,131072);R={start:0,end:Math.ceil(k/h.BLOCK_SIZE)*h.BLOCK_SIZE-1}}var U,G,[F,x,Y]=yield Promise.all([(0,u.default)(g,l).then((e=>{if(E){var{scanLengths:t,scansSidecar:r,mimetype:a,onProgressiveUpdate:i}=E;w=new _.default({cryptoKeys:e,scanLengths:t,scansSidecar:r,mimetype:a,filehash:s,debugString:b,onProgressiveUpdate:i})}return e})),B({scanCount:I,directPath:i,encFilehash:n,type:g,signal:S}),A.default.download({directPath:i,encFilehash:n,type:g,signal:S,mode:v,byteRange:R,onResponseText:null==I?(e,t)=>{var r;null===(r=w)||void 0===r||r.handleProgress(e.total,t)}:null,onDownloadHostFound:({hostName:e,hostClass:t,failCount:r})=>{a.set({overallDomain:e,overallConnectionClass:t,overallRetryCount:r})},onDownloadAttemptSuccess:e=>{a.set({overallT:e})},onDownloadAttemptError:({err:e,overallT:t,failCount:r})=>{var i=new T.default.MediaDownload2(a);i.set({mediaId:(0,m.generateMediaEventId)(),overallDownloadResult:(0,m.getMetricDownloadErrorResultType)(e),overallIsFinal:!1,overallT:t,overallRetryCount:r});var n=(0,m.getStatusCode)(e);null!=n&&(a.downloadHttpCode=n),a.markOverallCumT(),i.commit(),(0,m.logErrorUnknownDetails)(i,e)},debugString:b})]);if(d&&d(),r=Y.byteLength,a.set({overallMediaSize:r,overallDownloadResult:T.default.MEDIA_DOWNLOAD_RESULT_TYPE.OK,overallIsFinal:!0,downloadHttpCode:200}),a.markOverallCumT(),a.commit(),null!=I)U=(0,C.default)(yield null===(G=w)||void 0===G?void 0:G.handleProgress(x,Y),"yield imageStreamer?.handleProgress(encryptedFileSize, ciphertextHmac)");else U=y?yield(0,h.default)({mediaKeys:F,ciphertext:Y}):yield(0,p.default)({mediaKeys:F,ciphertextHmac:Y,expectedPlaintextHash:s,debugString:b});return __LOG__(2)`downloadManager.download: [${b}] success`,U}catch(e){throw(e=>{a.set({overallDownloadResult:(0,m.getMetricDownloadErrorResultType)(e),overallIsFinal:!0});var t=(0,m.getStatusCode)(e);null!=t&&(a.downloadHttpCode=t),a.markOverallCumT(),a.commit(),(0,m.logErrorUnknownDetails)(a,e)})(e),e instanceof f.MediaNotFoundError?__LOG__(2,!0)`downloadManager.download: [${b}] expected error\n${(0,P.default)(e)}`:__LOG__(3,!0)`downloadManager.download: [${b}] error\n${(0,P.default)(e)}`,e}}))).apply(this,arguments)}function U(){return G.apply(this,arguments)}function G(){return(G=(0,s.default)((function*(e){var t,r,{mediaObject:a}=e,i=null!==(t=null===(r=a.filehash)||void 0===r?void 0:r.slice(0,10))&&void 0!==t?t:"";a.filehash,a.type,__LOG__(2)`downloadManager.rmr: [${i}] start`,a.consolidate({downloadStage:E.DOWNLOAD_STAGE.REUPLOADING});var s=performance.now(),o=new T.default.WebcMediaRmr((0,n.default)((0,n.default)({},e.rmrData),{},{webcRmrReason:e.rmrReason})),l=(0,b.getEffectiveNetworkType)();null!=l&&(o.webcBrowserNetworkType=l),a.type&&(o.messageMediaType=(0,g.webMediaTypeToWamMediaType)(a.type)),null!=a.size&&(o.webcMediaSize=a.size);try{var d=yield a.rmr({onMsgSelect:function(e){null==o.webcChatType&&e.chat&&(o.webcChatType=e.chat.getWebcChatType()),null==o.webcMessageT&&(o.webcMessageT=e.t),o.messageMediaType=e.getWamMediaType()}});if(o.webcRmrStatusCode=d,__LOG__(2)`downloadManager.rmr: [${i}] status ${d}`,404===d)throw new f.MediaNotOnPhone;if(200!==d)throw new f.ServerStatusCodeError(d)}catch(e){throw o.webcMediaRmrError=!0,e instanceof f.MediaNotOnPhone?(__LOG__(2,!0)`downloadManager.rmr: [${i}] error MediaNotOnPhone\n${(0,P.default)(e)}`,e):(__LOG__(3,!0)`downloadManager.rmr: [${i}] error ${e.status||e.message}\n${e.stack}`,new f.MediaNeedsReupload)}finally{o.webcMediaRmrT=Math.ceil(performance.now()-s),o.commit()}}))).apply(this,arguments)}function F(){return x.apply(this,arguments)}function x(){return(x=(0,s.default)((function*(e){var{directPath:t,encFilehash:r,signal:a,type:i}=e;yield A.default.checkExistence({directPath:t,encFilehash:r,type:i,signal:a||(new o.default).signal})}))).apply(this,arguments)}function B(e){var{scanCount:t,directPath:r,encFilehash:a,type:i,signal:n}=e;return null==t?Promise.resolve(null):A.default.getEncryptedMediaSize({directPath:(0,C.default)(r,"directPath is required for partial downloads"),encFilehash:(0,C.default)(a,"encFilehash is required for partial downloads"),signal:n,type:i})}var Y=new D;t.default=Y},95378:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"LogoutDrop",{enumerable:!0,get:function(){return a.LogoutDrop}}),Object.defineProperty(t,"WebdDrop",{enumerable:!0,get:function(){return a.WebdDrop}}),Object.defineProperty(t,"ServerStatusCodeError",{enumerable:!0,get:function(){return a.ServerStatusCodeError}}),Object.defineProperty(t,"AbortError",{enumerable:!0,get:function(){return i.AbortError}}),Object.defineProperty(t,"HttpNetworkError",{enumerable:!0,get:function(){return i.HttpNetworkError}}),Object.defineProperty(t,"HttpStatusCodeError",{enumerable:!0,get:function(){return i.HttpStatusCodeError}}),Object.defineProperty(t,"MMSForbiddenError",{enumerable:!0,get:function(){return i.MMSForbiddenError}}),Object.defineProperty(t,"MMSUnauthorizedError",{enumerable:!0,get:function(){return i.MMSUnauthorizedError}}),Object.defineProperty(t,"MMSThrottleError",{enumerable:!0,get:function(){return i.MMSThrottleError}}),Object.defineProperty(t,"MediaNotFoundError",{enumerable:!0,get:function(){return i.MediaNotFoundError}}),Object.defineProperty(t,"MediaDecryptionError",{enumerable:!0,get:function(){return n.MediaDecryptionError}}),Object.defineProperty(t,"MediaNeedsReupload",{enumerable:!0,get:function(){return n.MediaNeedsReupload}}),Object.defineProperty(t,"NoMediaHostsError",{enumerable:!0,get:function(){return s.NoMediaHostsError}}),t.MediaNotOnPhone=void 0;var a=r(33576),i=r(28635),n=r(24461),s=r(74475);class o extends a.ServerStatusCodeError{constructor(){super(404),this.name="MediaNotOnPhone"}}t.MediaNotOnPhone=o},74475:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"AbortError",{enumerable:!0,get:function(){return n.default}}),t.NoMediaHostsError=void 0;var i=r(71436),n=a(r(3599));class s extends((0,i.customError)("NoMediaHostsError")){}t.NoMediaHostsError=s},62957:(e,t,r)=>{"use strict";var a=r(93291);Object.defineProperty(t,"__esModule",{value:!0});var i={};Object.defineProperty(t,"default",{enumerable:!0,get:function(){return n.default}});var n=a(r(92574));Object.keys(n).forEach((function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(i,e)||Object.defineProperty(t,e,{enumerable:!0,get:function(){return n[e]}}))}))},23621:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.HOST_TYPE=void 0;var a=r(79843),i=new Set(a.MEDIA_TYPE_VALUES),n=Object.freeze({PRIMARY:"primary",FALLBACK:"fallback"});t.HOST_TYPE=n;t.default=class{constructor(e){this.hostname=e.hostname,this.ips=e.ips||[],this.type=e.type,this.class=e.class;var{downloadBuckets:t,supportedDownloadTypes:r,supportedUploadTypes:a}=function(e){var t,r,a,n,s,o=e||[];for(var l of o){var d,u;if(l.download)for(var c of(a=null!==(d=a)&&void 0!==d?d:new Set,l.download))a.add(c);if(l.upload)for(var p of(n=null!==(u=n)&&void 0!==u?u:new Set,l.upload))n.add(p);l.downloadBuckets&&(s=l.downloadBuckets.map((e=>parseInt(e,10))))}return{supportedDownloadTypes:null!==(t=a)&&void 0!==t?t:i,supportedUploadTypes:null!==(r=n)&&void 0!==r?r:i,downloadBuckets:s}}(e.rules);this.downloadBuckets=t,this._supportedDownloadTypes=r,this._supportedUploadTypes=a}isFallback(){return this.type===n.FALLBACK}supportsDownloadMediaType(e){return this._supportedDownloadTypes.has(e)}supportsUploadMediaType(e){var t="product-catalog-image"===e?"product":e;return this._supportedUploadTypes.has(t)}}},92574:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.FETCH_STATE=void 0;var i=a(r(22220)),n=a(r(52954)),s=a(r(45026)),o=r(3599),l=r(74475),d=a(r(23621)),u=a(r(79823)),c=a(r(68207)),p=r(91358),h=a(r(55334));t.FETCH_STATE={PENDING:"PENDING",SUCCESS:"SUCCESS",ERROR:"ERROR"};var f=new class{constructor(){var e=this;this._fetch=(0,u.default)((()=>"all"),function(){var t=(0,n.default)((function*({signal:t}){try{var r=yield(0,p.sendQueryMediaConn)(t);e._err=null,e._data={auth:r.auth,authExpirationTime:new Date(r.queryStartTime.getTime()+r.authTTL),authTTL:r.authTTL,hosts:r.hosts.map((e=>new d.default(e))),hostsRefreshTime:new Date(r.queryStartTime.getTime()+r.ttl),queryStartTime:r.queryStartTime,maxBuckets:r.maxBuckets}}catch(t){if(e._data=null,e._err=t,t.name===o.ABORT_ERROR)return void __LOG__(2)`mediaHosts.sendQueryMediaConn aborted`;__LOG__(3,!0)`mediaHosts.sendQueryMediaConn error: ${function(e){var{name:t,message:r,stack:a}=e,n=(0,i.default)(e,["name","message","stack"]),s=(0,c.default)(e),o=s.slice(s.indexOf("\n")+1),l=0===Object.keys(n).length?"":" "+JSON.stringify(n,((e,t)=>e&&"object"==typeof t?String(t):t));return`${e.name||"Error"}: ${e.message}${l}\n${o}`}(t)}`,__LOG__(4,void 0,new Error,!0)`Assertion failed!`,SEND_LOGS("Error fetching mms hosts")}}));return function(){return t.apply(this,arguments)}}()),this._reset()}getHostsInfo({directPath:e,encFilehash:t,operation:r,type:a,signal:i}){var o=this;return(0,n.default)((function*(){var n={signal:i||(new s.default).signal};if(yield o._refreshIfStale(n),!o._data)throw new l.NoMediaHostsError("no fetched data");var{auth:d,hosts:u,maxBuckets:c}=o._data,{selectedHost:p,fallbackHost:f}=(0,h.default)({directPath:e,encFilehash:t,hosts:u,operation:r,type:a,maxBuckets:c});if(!p)throw new l.NoMediaHostsError("no selected host");return{auth:d,selectedHost:p,fallbackHost:f}}))()}_isExpiredOrMissing(){if(!this._data)return!0;var e=this._data;return new Date>=e.authExpirationTime}_needsRefresh(){if(!this._data)return!0;var e=this._data;if(new Date>=e.hostsRefreshTime)return!0;var{authTTL:t,queryStartTime:r}=e,a=Math.floor(.8*t),i=new Date(r.getTime()+a);return new Date>=i}_refreshIfStale(e){var t=this;return(0,n.default)((function*(){return t._isExpiredOrMissing()?(t._reset(),yield t._fetch(e),!0):!!t._needsRefresh()&&(t._fetch(e),!1)}))()}_reset(){this._data=null,this._err=null}};t.default=f},55334:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function({encFilehash:e,directPath:t,hosts:r,operation:a,type:l,maxBuckets:d}){var u,c,p;if(!r.length)return{selectedHost:null,fallbackHost:null};if(a===o.DOWNLOAD){var h,f=t?t.match(/&_nc_hot=([0-9]+)/):null,_=parseInt(f&&f[1],10),m=isNaN(_)?null:Date.now()-_,{mmsHotContentTimespan:g,mmsVCacheAggregationEnabled:v}=s.default;null!=g&&g>0&&(l===n.default.STICKER||null!=m&&m<=g)?h=1:v&&null!=d&&(h=(0,i.default)(e,d)+100);var E=function(e){var t=new Map;return e.forEach((e=>{var r;null===(r=e.downloadBuckets)||void 0===r||r.forEach((r=>{t.set(r,e)}))})),t}(r),y=null==h?null:E.get(h),S=E.get(0);(null==y?void 0:y.supportsDownloadMediaType(l))?p=y:(null==S?void 0:S.supportsDownloadMediaType(l))&&(p=S)}var T=r.find((e=>e.isFallback()));return p=null!==(u=p)&&void 0!==u?u:r.find((e=>a===o.UPLOAD?e.supportsUploadMediaType(l):e.supportsDownloadMediaType(l))),{selectedHost:null!==(c=p)&&void 0!==c?c:null,fallbackHost:null!=T?T:null}},t.OPERATIONS=void 0;var i=a(r(1663)),n=a(r(79843)),s=a(r(54559)),o={DOWNLOAD:"DOWNLOAD",UPLOAD:"UPLOAD"};t.OPERATIONS=o},28635:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"AbortError",{enumerable:!0,get:function(){return a.AbortError}}),Object.defineProperty(t,"HttpNetworkError",{enumerable:!0,get:function(){return a.HttpNetworkError}}),Object.defineProperty(t,"HttpInvalidResponseError",{enumerable:!0,get:function(){return a.HttpInvalidResponseError}}),Object.defineProperty(t,"MmsDownloadFilehashMismatchError",{enumerable:!0,get:function(){return a.MmsDownloadFilehashMismatchError}}),Object.defineProperty(t,"HttpStatusCodeError",{enumerable:!0,get:function(){return a.HttpStatusCodeError}}),Object.defineProperty(t,"NoMediaHostsError",{enumerable:!0,get:function(){return i.NoMediaHostsError}}),t.MMSThrottleError=t.MMSForbiddenError=t.MMSUnauthorizedError=t.MediaInvalidError=t.MediaTooLargeError=t.MediaNotFoundError=void 0;var a=r(87243),i=r(74475);class n extends a.HttpStatusCodeError{constructor(e,t){super(404,e,t),this.name="MediaNotFoundError"}}t.MediaNotFoundError=n;class s extends a.HttpStatusCodeError{constructor(e,t){super(413,e,t),this.name="MediaTooLargeError"}}t.MediaTooLargeError=s;class o extends a.HttpStatusCodeError{constructor(e,t){super(415,e,t),this.name="MediaInvalidError"}}t.MediaInvalidError=o;class l extends a.HttpStatusCodeError{constructor(e,t){super(401,e,t),this.name="MMSUnauthorizedError"}}t.MMSUnauthorizedError=l;class d extends a.HttpStatusCodeError{constructor(e,t){super(403,e,t),this.name="MMSForbiddenError"}}t.MMSForbiddenError=d;class u extends a.HttpStatusCodeError{constructor(e,t){super(507,e,t),this.name="MMSThrottleError"}}t.MMSThrottleError=u},41790:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function({directPath:e,encFilehash:t,hostname:r,type:a,mode:l,byteRange:d}){return e?function({directPath:e,encFilehash:t,hostname:r,query:a}){var i=new URL(e,`https://${r}`);if(i.hostname!==r)throw __LOG__(4,void 0,new Error,!0)`url.hostname: ${i.hostname}, hostname: ${r}, directPath: ${e}`,SEND_LOGS("malicious directPath"),new Error("malicious directPath");var n=i.searchParams||new o.default(i.search);return n.set("hash",(0,s.default)(t)),Object.keys(a).forEach((e=>{var t=a[e];null!=t&&n.set(e,t)})),`https://${i.host}${i.pathname}?${n.toString()}`}({encFilehash:t,hostname:r,directPath:e,query:{mode:l,bytestart:null==d?void 0:d.start.toString(),byteend:null==d?void 0:d.end.toString(),[n.MMS_URL_MEDIA_TYPE_SEARCH_PARAM]:a,[n.IS_MMS_URL_SEARCH_PARAM]:""}}):(0,i.default)({hostname:r,type:a,encFilehash:t,query:{mode:l,[n.IS_MMS_URL_SEARCH_PARAM]:""}})};var i=a(r(13276)),n=r(1509),s=a(r(31962)),o=a(r(31244))},13276:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function({hostname:e,type:t,encFilehash:r,query:a}){var l=(0,i.default)(o[t],"MEDIA_TYPE_TO_PATH[type]"),d=new URL(`https://${e}${l}/${(0,n.default)(r)}`),u={};a&&Object.keys(a).forEach((e=>{null!=a[e]&&(u[e]=a[e])}));var c=new s.default(u).toString();c&&(c=`?${c}`);return`https://${d.host}${d.pathname}${c}`};var i=a(r(21830)),n=a(r(31962)),s=a(r(31244)),o={audio:"/mms/audio",document:"/mms/document",gif:"/mms/gif",image:"/mms/image",ppic:"/pps/photo",product:"/mms/image",ptt:"/mms/ptt",sticker:"/mms/sticker","thumbnail-document":"/mms/thumbnail-document","thumbnail-link":"/mms/thumbnail-link",video:"/mms/video","md-app-state":"/mms/md-app-state","product-catalog-image":"/product/image"}},73606:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function({auth:e,encFilehash:t,hostname:r,query:a,type:o}){var l=(0,i.default)({auth:e,token:(0,s.default)(t)},a);return(0,n.default)({encFilehash:t,hostname:r,type:o,query:l})};var i=a(r(70417)),n=a(r(13276)),s=a(r(31962))},20540:(e,t,r)=>{"use strict";var a=r(93291);Object.defineProperty(t,"__esModule",{value:!0});var i={};Object.defineProperty(t,"default",{enumerable:!0,get:function(){return n.default}});var n=a(r(39151));Object.keys(n).forEach((function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(i,e)||Object.defineProperty(t,e,{enumerable:!0,get:function(){return n[e]}}))}))},15892:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){if(e instanceof a.MMSThrottleError)return!1;return e instanceof a.NoMediaHostsError||e instanceof a.HttpNetworkError||e instanceof a.MMSUnauthorizedError||e instanceof a.HttpStatusCodeError&&e.status>=500};var a=r(28635)},31984:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return l.apply(this,arguments)};var i=a(r(52954)),n=r(3599),s=r(28635),o=a(r(60022));function l(){return(l=(0,i.default)((function*(e){e.encFilehash,e.type,__LOG__(2)`mmsCheckIfUploadExists: start`;try{var t=yield(0,o.default)(e);if("complete"!==t.resume)throw new s.MediaNotFoundError("mmsCheckIfUploadExists");var{directPath:r,url:a,handle:i}=t;if(!r)throw new s.HttpInvalidResponseError("mmsCheckIfUploadExists: missing directPath");if(!a)throw new s.HttpInvalidResponseError("mmsCheckIfUploadExists: missing url");return __LOG__(2)`mmsCheckIfUploadExists: success`,{directPath:r,url:a,handle:i}}catch(e){throw e instanceof s.MediaNotFoundError?__LOG__(2)`mmsCheckIfUploadExists: expected error`:e.name===n.ABORT_ERROR?__LOG__(2)`mmsCheckIfUploadExists: canceled`:__LOG__(3)`mmsCheckIfUploadExists: error`,e}}))).apply(this,arguments)}},39151:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(70417)),n=a(r(52954)),s=r(3599),o=r(28635),l=a(r(95469)),d=a(r(15892)),u=a(r(62957)),c=a(r(31984)),p=r(615),h=a(r(51150)),f=a(r(66622)),_=a(r(37009)),m={minTimeout:1e3,retries:3};function g(e){var{selectedHost:t,fallbackHost:r,failCount:a,lastFetchMadeProgress:i}=e;return a>=2&&!i&&r?r:t}function v(e,t){var{directPath:r,encFilehash:a,type:s,signal:o}=t;return __LOG__(2)`runTaskWithBackoff: start`,(0,l.default)((0,i.default)((0,i.default)({},m),{},{signal:o}),function(){var t=(0,n.default)((function*(t,i){__LOG__(2)`runMmsTaskWithBackoff: attempt #${i+1}`;try{var n=yield function(){return E.apply(this,arguments)}({operation:_.default.DOWNLOAD,directPath:r,encFilehash:a,type:s,signal:o,failCount:i});return yield e(n)}catch(e){if((0,d.default)(e))return t(e);throw e}}));return function(){return t.apply(this,arguments)}}())}function E(){return(E=(0,n.default)((function*(e){var{failCount:t,operation:r,directPath:a,encFilehash:i,type:n,signal:s}=e,{selectedHost:o,fallbackHost:l}=yield u.default.getHostsInfo({operation:r,directPath:a,encFilehash:i,type:n,signal:s});return(t>=2&&l?l:o).hostname}))).apply(this,arguments)}var y=new class{checkIfUploadExists(e){return(0,n.default)((function*(){var{encFilehash:t,signal:r,type:a}=e,p=!1;e.encFilehash,e.type,__LOG__(2)`mmsClient.checkIfUploadExists: start`;try{var h=yield(0,l.default)((0,i.default)((0,i.default)({},m),{},{signal:r}),function(){var e=(0,n.default)((function*(e,i){__LOG__(2)`mmsClient.checkIfUploadExists: attempt #${i+1}`,yield f.default.waitIfOffline({signal:r});try{var{auth:n,selectedHost:s,fallbackHost:o}=yield u.default.getHostsInfo({operation:_.default.UPLOAD,encFilehash:t,type:a,signal:r}),l=g({selectedHost:s,fallbackHost:o,failCount:i,lastFetchMadeProgress:p});return yield(0,c.default)({auth:n,encFilehash:t,hostname:l.hostname,type:a,signal:r,onProgress:()=>{p=!0}})}catch(t){if((0,d.default)(t))return e(t);throw t}}));return function(){return e.apply(this,arguments)}}());return __LOG__(2)`mmsClient.checkIfUploadExists: success`,h}catch(e){throw e instanceof o.MediaNotFoundError?__LOG__(2)`mmsClient.checkIfUploadExists: expected error`:e.name===s.ABORT_ERROR?__LOG__(2)`mmsClient.checkIfUploadExists: canceled`:__LOG__(3)`mmsClient.checkIfUploadExists: error`,e}}))()}upload(e){var{ciphertextHmac:t,encFilehash:r,type:a,signal:n,onUploadHostFound:o,onUploadAttemptSuccess:c,onUploadAttemptError:p}=e,v=!1;__LOG__(2)`mmsClient.upload: start`;var E=Date.now();return(0,l.default)((0,i.default)((0,i.default)({},m),{},{signal:n}),((e,i)=>(E=Date.now(),__LOG__(2)`mmsClient.upload: attempt #${i+1}`,f.default.waitIfOffline({signal:n}).then((()=>u.default.getHostsInfo({operation:_.default.UPLOAD,encFilehash:r,type:a,signal:n}).then((({auth:e,selectedHost:s,fallbackHost:l})=>{var d=g({selectedHost:s,fallbackHost:l,failCount:i,lastFetchMadeProgress:v});return o({hostName:d.hostname,hostClass:d.class,failCount:i}),(0,h.default)({auth:e,ciphertextHmac:t,hostname:d.hostname,encFilehash:r,type:a,signal:n,onProgress:()=>{v=!0}})})).catch((t=>{var r=(0,d.default)(t);if(!r||i===m.retries||p(t,Date.now()-E),r)return e(t);throw t}))))))).then((e=>(c(Date.now()-E),__LOG__(2)`mmsClient.upload: success`,e))).catch((e=>{throw e.name===s.ABORT_ERROR?__LOG__(2)`mmsClient.upload: canceled`:__LOG__(3)`mmsClient.upload: error`,e}))}download(e){var{directPath:t,encFilehash:r,type:a,signal:n,mode:c,byteRange:h,debugString:f,onResponseText:v,onDownloadHostFound:E,onDownloadAttemptSuccess:y,onDownloadAttemptError:S}=e,T=!1;__LOG__(2)`mmsClient.download: [${f}] start`;var A=Date.now();return(0,l.default)((0,i.default)((0,i.default)({},m),{},{signal:n}),((e,i)=>(A=Date.now(),__LOG__(2)`mmsClient.download: [${f}] attempt #${i+1}`,u.default.getHostsInfo({operation:_.default.DOWNLOAD,directPath:t,encFilehash:r,type:a,signal:n}).then((({auth:e,selectedHost:s,fallbackHost:o})=>{var l=g({selectedHost:s,fallbackHost:o,failCount:i,lastFetchMadeProgress:T});return E({hostName:l.hostname,hostClass:l.class,failCount:i}),(0,p.mms4Download)({directPath:t,encFilehash:r,hostname:l.hostname,type:a,signal:n,mode:c,byteRange:h,debugString:f,onProgress:()=>{T=!0},onResponseText:v})})).catch((t=>{var r=(0,d.default)(t);if(!r||i===m.retries||S({err:t,overallT:Date.now()-A,failCount:i}),r)return e(t);throw t}))))).then((e=>(y(Date.now()-A),__LOG__(2)`mmsClient.download: [${f}] success`,e))).catch((e=>{throw e instanceof o.MediaNotFoundError?__LOG__(2)`mmsClient.download: [${f}] expected error`:e.name===s.ABORT_ERROR?__LOG__(2)`mmsClient.download: [${f}] canceled`:__LOG__(3)`mmsClient.download: [${f}] error`,e}))}checkExistence(e){return v((t=>(0,p.mmsCheckExistence)((0,i.default)((0,i.default)({},e),{},{hostname:t}))),e)}getEncryptedMediaSize(e){return v((t=>(0,p.mmsGetEncryptedMediaSize)((0,i.default)((0,i.default)({},e),{},{hostname:t}))),e)}};t.default=y},615:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=c,t.mms4Download=function({directPath:e,encFilehash:t,hostname:r,type:a,signal:n,onProgress:o,onResponseText:l,mode:d,byteRange:p,debugString:h}){var f=(0,u.default)({directPath:e,encFilehash:t,hostname:r,type:a,mode:d,byteRange:p});return c({url:f,signal:n,onProgress:o,onResponseText:l,ciphertextValidator:p?null:function(){var e=(0,i.default)((function*(e){return(yield(0,s.default)(e))===t}));return function(){return e.apply(this,arguments)}}(),debugString:h,debug:{encFilehash:t,type:a,url:f}})},t.mms3Download=function({signal:e,deprecatedMms3Url:t,debugString:r,onProgress:a,onResponseText:i}){return c({url:t,signal:e,onProgress:a,onResponseText:i,debugString:r,debug:{deprecatedMms3Url:t}})},t.mmsCheckExistence=function(){return h.apply(this,arguments)},t.mmsGetEncryptedMediaSize=function(){return f.apply(this,arguments)},t.validateMmsResponse=_;var i=a(r(52954)),n=r(3599),s=a(r(20116)),o=r(28635),l=r(24461),d=a(r(22448)),u=a(r(41790));function c(){return p.apply(this,arguments)}function p(){return(p=(0,i.default)((function*({url:e,signal:t,onProgress:r,onResponseText:a,debug:i,debugString:s,ciphertextValidator:l}){__LOG__(2)`mmsDownload: [${s}] start`;try{var u=yield(0,d.default)(e,{signal:t,onProgress:r,onResponseText:a});yield _({response:u,functionName:"mmsDownload",url:e});var c=yield u.arrayBuffer();if(l&&!(yield l(c)))throw new o.MmsDownloadFilehashMismatchError({url:e});return __LOG__(2)`mmsDownload: [${s}] success`,c}catch(e){throw e instanceof o.MediaNotFoundError?__LOG__(2)`mmsDownload: [${s}] error ${e.name} ${e.message}`:e.name===n.ABORT_ERROR?__LOG__(2)`mmsDownload: [${s}] canceled`:__LOG__(3)`mmsDownload: [${s}] error ${String(e)}`,e}}))).apply(this,arguments)}function h(){return(h=(0,i.default)((function*(e){var{directPath:t,encFilehash:r,hostname:a,type:i,signal:n}=e;yield g({directPath:t,encFilehash:r,hostname:a,type:i,signal:n,functionName:"mmsCheckExistence"})}))).apply(this,arguments)}function f(){return(f=(0,i.default)((function*(e){var{directPath:t,encFilehash:r,hostname:a,type:i,signal:n}=e,s=(yield g({directPath:t,encFilehash:r,hostname:a,type:i,signal:n,functionName:"mmsGetEncryptedMediaSize"})).headers.get("content-length");if(!s)throw new l.UnableToGetContentLengthError;return parseInt(s,10)}))).apply(this,arguments)}function _(){return m.apply(this,arguments)}function m(){return(m=(0,i.default)((function*(e){var{response:t,url:r,functionName:a}=e;if(!t.ok)switch(t.status){case 401:throw new o.MMSUnauthorizedError(a,{url:r});case 403:if((yield t.text()).includes("URL signature expired"))throw new o.MediaNotFoundError(a,{url:r,status:t.status});throw new o.MMSForbiddenError(a,{url:r});case 404:case 410:throw new o.MediaNotFoundError(a,{url:r,status:t.status});case 507:throw new o.MMSThrottleError(a,{url:r});default:throw new o.HttpStatusCodeError(t.status,a,{url:r})}}))).apply(this,arguments)}function g(){return v.apply(this,arguments)}function v(){return(v=(0,i.default)((function*(e){var{directPath:t,encFilehash:r,hostname:a,type:i,signal:n,functionName:s}=e,o=(0,u.default)({directPath:t,encFilehash:r,hostname:a,type:i,mode:"auto"}),l=yield(0,d.default)(o,{method:"HEAD",signal:n});return yield _({response:l,functionName:s,url:o}),l}))).apply(this,arguments)}},60022:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return d.apply(this,arguments)};var i=a(r(52954)),n=r(3599),s=r(28635),o=a(r(22448)),l=a(r(73606));function d(){return(d=(0,i.default)((function*(e){var{auth:t,encFilehash:r,hostname:a,signal:i,type:d,onProgress:u}=e,c=(0,l.default)({auth:t,encFilehash:r,hostname:a,query:{resume:1},type:d});__LOG__(2)`mmsGetUploadProgress: start`;try{var p=yield(0,o.default)(c,{method:"post",signal:i,onProgress:u});if(!p.ok)switch(p.status){case 401:throw new s.MMSUnauthorizedError("mmsGetUploadProgress",{url:c});case 404:throw new s.MediaNotFoundError("mmsGetUploadProgress",{url:c});default:throw new s.HttpStatusCodeError(p.status,"mmsGetUploadProgress",{url:c})}var h=yield p.json();if(!h.resume)throw new s.HttpInvalidResponseError("mmsGetUploadProgress: missing resume",{url:c});return __LOG__(2)`mmsGetUploadProgress: success`,{directPath:h.direct_path,resume:h.resume,url:h.url,handle:h.handle}}catch(e){throw e instanceof s.MediaNotFoundError?__LOG__(2)`mmsGetUploadProgress: expected error`:e.name===n.ABORT_ERROR?__LOG__(2)`mmsGetUploadProgress: canceled`:__LOG__(3)`mmsGetUploadProgress: error`,e}}))).apply(this,arguments)}},51150:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var{auth:t,ciphertextHmac:r,encFilehash:a,hostname:l,type:d,signal:u,onProgress:c}=e,p=(0,o.default)({auth:t,encFilehash:a,hostname:l,type:d});return __LOG__(2)`mmsUpload: start`,(0,s.default)(p,{method:"post",body:r,signal:u,onProgress:c}).then((e=>{if(!e.ok)switch(e.status){case 401:throw new n.MMSUnauthorizedError("mmsUpload",{url:p});case 413:throw new n.MediaTooLargeError("mmsUpload",{url:p});case 415:throw new n.MediaInvalidError("mmsUpload: hash mismatch",{url:p});case 507:throw new n.MMSThrottleError("mmsUpload",{url:p});default:throw new n.HttpStatusCodeError(e.status,"mmsUpload",{url:p})}return e.json()})).then((e=>{if(!e.direct_path)throw new n.HttpInvalidResponseError("mmsUpload: missing direct_path");if(!e.url)throw new n.HttpInvalidResponseError("mmsUpload: missing url");return{directPath:e.direct_path,url:e.url,handle:e.handle}})).then((e=>(__LOG__(2)`mmsUpload: success`,e))).catch((e=>{throw e.name===i.ABORT_ERROR?__LOG__(2)`mmsUpload: canceled`:__LOG__(3)`mmsUpload: error`,e}))};var i=r(3599),n=r(28635),s=a(r(22448)),o=a(r(73606))},43341:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"AbortError",{enumerable:!0,get:function(){return a.AbortError}}),Object.defineProperty(t,"HttpNetworkError",{enumerable:!0,get:function(){return a.HttpNetworkError}}),Object.defineProperty(t,"HttpStatusCodeError",{enumerable:!0,get:function(){return a.HttpStatusCodeError}}),Object.defineProperty(t,"MediaNotFoundError",{enumerable:!0,get:function(){return a.MediaNotFoundError}}),Object.defineProperty(t,"MediaTooLargeError",{enumerable:!0,get:function(){return a.MediaTooLargeError}}),Object.defineProperty(t,"MediaInvalidError",{enumerable:!0,get:function(){return a.MediaInvalidError}}),Object.defineProperty(t,"MMSUnauthorizedError",{enumerable:!0,get:function(){return a.MMSUnauthorizedError}}),Object.defineProperty(t,"MediaEncryptionError",{enumerable:!0,get:function(){return i.MediaEncryptionError}}),Object.defineProperty(t,"NoMediaHostsError",{enumerable:!0,get:function(){return n.NoMediaHostsError}});var a=r(28635),i=r(24461),n=r(74475)},13139:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return i.default}});var i=a(r(7495))},7495:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(3599),n=a(r(57111)),s=r(28635),o=r(48537),l=r(69016),d=a(r(79823)),u=a(r(84161)),c=a(r(20540)),p=a(r(13415)),h=a(r(54559)),f=a(r(31244));function _(e,t,r,a){var i=new u.default.MediaUpload2({mediaId:(0,l.generateMediaEventId)(),connectionType:u.default.CONNECTION_TYPE.HOSTNAME,overallMediaType:(0,l.getMetricMediaType)(e),overallMmsVersion:4,overallAttemptCount:r,networkStack:u.default.NETWORK_STACK_TYPE.NATIVE,overallUploadMode:u.default.MEDIA_UPLOAD_MODE_TYPE.REGULAR,overallIsForward:a,overallUploadOrigin:t});return{onArrayBufferCreated:function(e){i.set({overallMediaSize:e})},onCheckExistingError:function(e){e instanceof s.HttpStatusCodeError&&i.set({resumeHttpCode:e.status})},onCheckExistingSuccess:function(){i.set({overallUploadResult:u.default.MEDIA_UPLOAD_RESULT_TYPE.DUPLICATE,overallIsFinal:!0,resumeHttpCode:200}),i.markOverallCumT(),i.commit()},onUploadHostFound:function({hostName:e,hostClass:t,failCount:r}){i.set({overallDomain:e,overallConnectionClass:t,overallRetryCount:r})},onUploadSuccess:function(){i.set({resumeHttpCode:404,overallUploadResult:u.default.MEDIA_UPLOAD_RESULT_TYPE.OK,overallIsFinal:!0,uploadHttpCode:200,finalizeHttpCode:200}),i.markOverallCumT(),i.commit()},onUploadError:function(e){i.set({overallUploadResult:(0,l.getMetricUploadErrorResultType)(e),overallIsFinal:!0});var t=(0,l.getStatusCode)(e);null!=t&&(i.uploadHttpCode=t,i.finalizeHttpCode=t),i.markOverallCumT(),i.commit(),(0,l.logErrorUnknownDetails)(i,e)},onUploadAttemptSuccess:function(e){i.set({overallT:e})},onUploadAttemptError:function(e,t,r){var a=new u.default.MediaUpload2(i);a.set({mediaId:(0,l.generateMediaEventId)(),overallUploadResult:(0,l.getMetricUploadErrorResultType)(e),overallIsFinal:!1,overallT:t,overallRetryCount:r});var n=(0,l.getStatusCode)(e);null!=n&&(i.uploadHttpCode=n),i.markOverallCumT(),a.commit(),(0,l.logErrorUnknownDetails)(i,e)}}}var m=new class{constructor(){this.checkIfAlreadyUploaded=(0,d.default)((e=>e.encFilehash),(e=>{var{encFilehash:t,type:r}=e;return __LOG__(2)`uploadManager.checkIfAlreadyUploaded: start`,c.default.checkIfUploadExists(e).catchType(s.MediaNotFoundError,(()=>null)).then((e=>(__LOG__(2)`uploadManager.checkIfAlreadyUploaded: success`,e))).catch((e=>{throw e.name===i.ABORT_ERROR?__LOG__(2)`uploadManager.checkIfAlreadyUploaded: canceled`:__LOG__(3)`uploadManager.checkIfAlreadyUploaded: error`,e}))})),this._memoizedUpload=(0,d.default)((e=>e.encFilehash),(e=>{var{ciphertextHmac:t,encFilehash:r,type:a,signal:i,onUploadHostFound:n,onUploadAttemptSuccess:s,onUploadAttemptError:o,onUploadSuccess:l}=e;return c.default.upload({ciphertextHmac:t,encFilehash:r,type:a,signal:i,onUploadHostFound:n,onUploadAttemptSuccess:s,onUploadAttemptError:o}).then((e=>(l(),e)))})),this._getExistingOrUpload=(0,d.default)((e=>e.encFilehash),(e=>{var{ciphertextHmac:t,encFilehash:r,signal:a,type:n,onCheckExistingSuccess:s,onCheckExistingError:o,onUploadHostFound:l,onUploadAttemptSuccess:d,onUploadAttemptError:u,onUploadSuccess:c}=e;return __LOG__(2)`uploadManager._getExistingOrUpload: start`,this.checkIfAlreadyUploaded({encFilehash:r,type:n,signal:a}).catch((e=>{throw o(e),e})).then((e=>e?(s(),e):this._memoizedUpload({ciphertextHmac:t,encFilehash:r,type:n,signal:a,onUploadHostFound:l,onUploadAttemptSuccess:d,onUploadAttemptError:u,onUploadSuccess:c}))).then((e=>(__LOG__(2)`uploadManager._getExistingOrUpload: success`,e))).catch((e=>{throw e.name===i.ABORT_ERROR?__LOG__(2)`uploadManager._getExistingOrUpload: canceled`:__LOG__(3)`uploadManager._getExistingOrUpload: error`,e}))}))}encryptAndUpload(e){var{blob:t,signal:r,type:a,userUploadAttemptCount:s,forwardedFromWeb:l,uploadOrigin:d}=e;__LOG__(2)`uploadManager.encryptAndUpload: start`;var{onCheckExistingSuccess:u,onCheckExistingError:c,onUploadHostFound:f,onUploadAttemptSuccess:m,onUploadAttemptError:v,onUploadSuccess:E,onArrayBufferCreated:y,onUploadError:S}=_(a,d,s,l);return(t instanceof Blob?(0,o.blobToArrayBuffer)(t):Promise.resolve(t)).then((t=>{var i,s;if(y(t.byteLength),null!=e.mediaKey&&null!=e.mediaKeyTimestamp)i=e.mediaKey,s=e.mediaKeyTimestamp;else{var o=(0,p.default)();i=o.key,s=o.timestamp}return(0,n.default)({type:a,plaintext:t,mediaKey:i}).then((({ciphertextHmac:t,hash:n,sidecar:o,firstFrameSidecar:d})=>(e.mediaKey?this._getExistingOrUpload({ciphertextHmac:t,encFilehash:n,type:a,signal:r,onCheckExistingSuccess:u,onCheckExistingError:c,onUploadHostFound:f,onUploadAttemptSuccess:m,onUploadAttemptError:v,onUploadSuccess:E}):this._memoizedUpload({ciphertextHmac:t,encFilehash:n,type:a,signal:r,onUploadHostFound:f,onUploadAttemptSuccess:m,onUploadAttemptError:v,onUploadSuccess:E})).then((e=>({directPath:l&&h.default.mmsCatV1ForwardHotOverrideEnabled?g(e.directPath):e.directPath,encFilehash:n,mediaKey:i,mediaKeyTimestamp:s,sidecar:o,firstFrameSidecar:d,url:e.url,handle:e.handle})))))})).then((e=>(__LOG__(2)`uploadManager.encryptAndUpload: success`,e))).catch((e=>{throw e.name===i.ABORT_ERROR?__LOG__(2)`uploadManager.encryptAndUpload: canceled`:__LOG__(3)`uploadManager.encryptAndUpload: error`,S(e),e}))}unencryptedUpload(e){var{file:t,hash:r,type:a,signal:i,uploadOrigin:n}=e,{onCheckExistingSuccess:s,onCheckExistingError:o,onUploadHostFound:l,onUploadAttemptSuccess:d,onUploadAttemptError:u,onUploadSuccess:c}=_(a,n,0,!1);return this._getExistingOrUpload({ciphertextHmac:t,encFilehash:r,type:a,signal:i,onCheckExistingSuccess:s,onCheckExistingError:o,onUploadHostFound:l,onUploadAttemptSuccess:d,onUploadAttemptError:u,onUploadSuccess:c})}};function g(e){var[t,r]=e.split("?"),a=new f.default(r),i=Math.round(Date.now()/1e3);return a.set("_nc_hot",String(i)),`${t}?${a.toString()}`}t.default=m},37554:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.cancelDownloadMedia=function(e){var{downloadPromise:t}=e;if(null==t)return;var r=w.get(t);if(null==r)return;w.delete(t),r()},t.manuallySetMedia=function({mimetype:e,mediaObject:t,mediaBlob:r,mediaType:a,rmrReason:i,downloadOrigin:n}){if(t.mediaBlob)return;(0,g.gatherAndSetMetadata)(t,r).then((()=>M({mimetype:e,mediaObject:t,downloadEvenIfExpensive:!1,mediaType:a,rmrReason:i,downloadOrigin:n})))},t.downloadMedia=M,t.checkExistence=function(){return I.apply(this,arguments)},Object.defineProperty(t,"MediaDecryptionError",{enumerable:!0,get:function(){return u.MediaDecryptionError}}),Object.defineProperty(t,"MediaNotOnPhone",{enumerable:!0,get:function(){return u.MediaNotOnPhone}});var n=i(r(52954)),s=r(71436),o=i(r(45026)),l=r(3599),d=i(r(26082)),u=r(95378),c=a(r(24461)),p=r(48537),h=i(r(11159)),f=a(r(28119)),_=i(r(79843)),m=r(60301),g=r(25332),v=i(r(84161)),E=r(6353),y=i(r(21830)),S=i(r(93013)),T=i(r(84174)),A=r(65999);class b extends((0,s.customError)("NoEntryAfterRMR")){}class C extends((0,s.customError)("MissingEncFilehash")){}var P=3,O=4,w=new WeakMap;function M({mimetype:e,mediaObject:t,downloadEvenIfExpensive:r,mediaType:a,signal:i,rmrReason:n,rmrData:s,downloadOrigin:v,shouldThrow:P,isVcardOverMmsDocument:O,mode:I}){if(!t)return Promise.resolve();var D=t.filehash;if(!D)return Promise.resolve();if(t.downloadPromise)return t.downloadPromise;if(t.downloadStage===m.DOWNLOAD_STAGE.ERROR_MISSING)return Promise.resolve();if(t.downloadStage===m.DOWNLOAD_STAGE.PREPARING)return Promise.resolve();if(t.mediaBlob)return t.mediaBlob.validate().then((e=>{if(!e)return t.clearBlob(),t.consolidate({downloadStage:m.DOWNLOAD_STAGE.NEED_POKE}),t.notifyMsgsAsync(),Promise.resolve();t.consolidate({downloadStage:m.DOWNLOAD_STAGE.RESOLVED})}));var N,L,k=h.default.get(D),U=new o.default;return(0,T.default)([U.signal,i].filter(Boolean),(i=>{if(k)N=Promise.resolve(k);else{var T;if(L=t.entries.getDownloadEntry())T=Promise.resolve(L);else{if(!r)return t.consolidate({downloadStage:m.DOWNLOAD_STAGE.NEED_POKE}),Promise.resolve();T=d.default.rmr({mediaObject:t,signal:i,rmrReason:n,rmrData:s}).then((()=>{if(!(L=t.entries.getDownloadEntry()))throw new b;return L}))}t.consolidate({downloadStage:m.DOWNLOAD_STAGE.FETCHING}),N=(0,y.default)(T,"entryPromise").then((r=>{L=r;var{encFilehash:n}=L;if(!n)throw L.markWhetherOnServer(!1),new C;var s=L,{scansSidecar:o,scanLengths:l}=L;return d.default.downloadAndDecrypt({directPath:s.directPath,encFilehash:n,filehash:D,mediaKey:s.mediaKey,mediaKeyTimestamp:s.mediaKeyTimestamp,signal:i,type:a,onDecryptStart:()=>{t.consolidate({downloadStage:m.DOWNLOAD_STAGE.PROCESSING})},userDownloadAttemptCount:t.userDownloadAttemptCount,downloadOrigin:v,mode:I,progressiveJpegOpts:R({scanLengths:l,scansSidecar:o,mimetype:e,mediaObject:t})}).then((t=>{var r=e||(0,E.getMediaMimeType)(a,new Uint8Array(t)),i=new Blob([t],{type:r});return!(0,g.shouldUseMediaCache)(a)||a!==_.default.PTT&&a!==_.default.AUDIO?i:f.transcode(i)}))}))}var G=N.then((e=>("text/vcard"===e.type&&O&&(0,p.blobToText)(e).then((e=>{var r=(0,A.parseMultiVcard)(e);r.length>0?t.consolidate({parsedVcards:r}):(__LOG__(4,void 0,new Error,!0)`Assertion failed!`,SEND_LOGS("vcard_over_mms:Failed to parse vcard over mms contents"))})).catch((e=>{__LOG__(4,void 0,new Error,!0)`Failed to retrieve blob text contents ${String(e)}`,SEND_LOGS(`vcard_over_mms:blobToText failed with error: ${String(e)}`)})),e))).then((e=>(0,g.shouldUseMediaCache)(a)?(h.default.put(D,e),(0,g.gatherAndSetMetadataNoOpaque)(t,e)):S.default.createFromData(e,e.type).then((e=>(0,g.gatherAndSetMetadata)(t,e))))).then((()=>(t.consolidate({downloadStage:m.DOWNLOAD_STAGE.RESOLVED}),t.downloadPromise=null,t.resolveWhenConsolidated()))).catchType(u.MediaNotFoundError,(i=>{if(!L)throw i;if(L.markWhetherOnServer(!1),!r)throw i;return d.default.rmr({mediaObject:t,signal:(new o.default).signal,rmrReason:n,rmrData:s}).then((()=>(t.downloadPromise=null,M({mimetype:e,mediaObject:t,downloadEvenIfExpensive:!1,mediaType:a,rmrReason:n,rmrData:s,downloadOrigin:v,isVcardOverMmsDocument:O,mode:I}))))})).catchType(c.MediaUnsupportedError,(r=>{if(t.consolidate({downloadStage:m.DOWNLOAD_STAGE.ERROR_UNSUPPORTED}),__LOG__(3)`downloadMedia: media unsupported error: ${r.name}, ${r.message}, ${e||""}`,__LOG__(4,void 0,new Error,!0)`Assertion failed! ${r.message}`,SEND_LOGS("downloadMedia: media unsupported error:"),P)throw r})).catchType(u.MediaNotOnPhone,(e=>{if(t.consolidate({downloadStage:m.DOWNLOAD_STAGE.ERROR_MISSING}),P)throw e})).catchTypes(b,C,(e=>{if(t.consolidate({downloadStage:m.DOWNLOAD_STAGE.ERROR_MISSING}),__LOG__(3)`Unexpected download error: ${e.name}`,__LOG__(4,void 0,new Error,!0)`Assertion failed!`,SEND_LOGS(`unexpected download error: ${e.name}`),P)throw e})).catchType(u.MediaDecryptionError,(e=>{if(t.consolidate({downloadStage:m.DOWNLOAD_STAGE.ERROR_MISSING}),P)throw e})).catch((r=>{if(t.consolidate({downloadStage:m.DOWNLOAD_STAGE.NEED_POKE}),r instanceof c.MediaLoadError){if(__LOG__(3)`downloadMedia: media unsupported error: ${r.name}, ${r.message}, ${e||""}`,__LOG__(4,void 0,new Error,!0)`Assertion failed! ${r.message}`,SEND_LOGS("downloadMedia: media load error:"),P)throw r}else if(r instanceof c.TranscodeBlobTooLargeError){if(__LOG__(3)`downloadMedia: error: ${r.message}, ${e||""}`,__LOG__(4,void 0,new Error,!0)`Assertion failed! ${r.message}`,SEND_LOGS("downloadMedia: transcode blob too large"),P)throw r}else if(r instanceof c.UnableToPlayVideoError){if(__LOG__(3)`downloadMedia: error: ${r.message}, ${e||""}`,__LOG__(4,void 0,new Error,!0)`Assertion failed! ${r.message}`,SEND_LOGS("downloadMedia: unable to play video"),P)throw r}else if(r.name!==l.ABORT_ERROR){if(__LOG__(2)`downloadMedia: error`,P)throw r}else if(P)throw r})).finally((()=>{t.downloadPromise=null}));return w.set(G,(()=>{U.abort()})),t.downloadPromise=G,G}))}function I(){return(I=(0,n.default)((function*({mimetype:e,mediaObject:t,mediaType:r}){var{filehash:a}=t;if(a&&t.downloadStage===m.DOWNLOAD_STAGE.INIT&&!(yield D(t))){var i=h.default.get(a),n=new o.default;if(i)t.downloadStage===m.DOWNLOAD_STAGE.INIT&&t.consolidate({downloadStage:m.DOWNLOAD_STAGE.EXISTS});else{var s=t.entries.getDownloadEntry();if(s){var{encFilehash:l}=s;if(!l)return s.markWhetherOnServer(!1),void(t.downloadStage===m.DOWNLOAD_STAGE.INIT&&t.consolidate({downloadStage:m.DOWNLOAD_STAGE.NEED_POKE}));try{yield d.default.checkExistence({directPath:s.directPath,encFilehash:l,signal:n.signal,type:r}),t.downloadStage===m.DOWNLOAD_STAGE.INIT&&t.consolidate({downloadStage:m.DOWNLOAD_STAGE.EXISTS})}catch(e){t.downloadStage===m.DOWNLOAD_STAGE.INIT&&t.consolidate({downloadStage:m.DOWNLOAD_STAGE.NEED_POKE}),__LOG__(2)`checkExistence: error`}}else t.downloadStage===m.DOWNLOAD_STAGE.INIT&&t.consolidate({downloadStage:m.DOWNLOAD_STAGE.NEED_POKE})}}}))).apply(this,arguments)}function R(e){var{scanLengths:t,scansSidecar:r,mimetype:a,mediaObject:i}=e;if(!function(e,t){return!!(e&&t&&e.length>=2&&10*e.length===t.byteLength)}(t,r))return null;var n=new v.default.WebcProgressiveImage({webcFirstRenderScans:0});return{mimetype:a,scansSidecar:(0,y.default)(r,"scansSidecar"),scanLengths:(0,y.default)(t,"scanLengths"),onProgressiveUpdate:e=>{i.downloadStage!==m.DOWNLOAD_STAGE.RESOLVED&&(i.consolidate({downloadStage:m.DOWNLOAD_STAGE.PROGRESSIVE_READY,progressiveStage:e}),n.webcFirstRenderScans||(n.webcFirstRenderScans=e,n.markWebcFirstRenderT()),e>=P&&!n.webcMidQualityT&&n.markWebcMidQualityT(),e!==O||n.webcFullQualityT||(n.markWebcFullQualityT(),n.commit()))}}}function D(){return N.apply(this,arguments)}function N(){return(N=(0,n.default)((function*(e){return!!e.mediaBlob&&((yield e.mediaBlob.validate())?(e.consolidate({downloadStage:m.DOWNLOAD_STAGE.RESOLVED}),!0):(e.clearBlob(),e.consolidate({downloadStage:m.DOWNLOAD_STAGE.NEED_POKE}),e.notifyMsgsAsync(),!1))}))).apply(this,arguments)}},58001:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.cancelUploadMedia=function(e){var{uploadPromise:t}=e;if(null==t)return;var r=E.get(t);if(null==r)return;E.delete(t),r()},t.uploadMedia=function({mimetype:e,mediaObject:t,mediaType:r,forwardedFromWeb:a,uploadOrigin:i,mediaKeyInfo:n}){if(t.uploadPromise)return t.uploadPromise;var m=new o.default,{signal:g}=m,T=Promise.resolve().then((()=>{t.consolidate({uploadStage:h.UPLOAD_STAGE.UPLOADING})})).then((()=>S({mediaObject:t,mimetype:e,mediaType:r,abortSignal:g,uploadOrigin:i}))).then((e=>{var o=t.entries.getUploadEntry();o&&n&&(0,s.default)(o.mediaKey===n.key,"uploadEntry.mediaKey and mediaKeyInfo.mediaKey should be the same");var l=n?n.key:null==o?void 0:o.mediaKey,d=n?n.timestamp:null==o?void 0:o.mediaKeyTimestamp;return v.default.encryptAndUpload({blob:e,mediaKey:l,mediaKeyTimestamp:d,type:r,signal:g,userUploadAttemptCount:t.userUploadAttemptCount,forwardedFromWeb:a,uploadOrigin:i}).then((({directPath:e,encFilehash:a,mediaKey:i,mediaKeyTimestamp:n,url:s,sidecar:o,firstFrameSidecar:l})=>{var d=t.entries.addEntry({deprecatedMms3Url:s,mediaKey:i,mediaKeyTimestamp:n,encFilehash:a,type:r,sidecar:o,directPath:e,firstFrameSidecar:l,debugHint:"upload"});if(!d)throw new Error("could not create media entry");if((r===f.default.PTT||r===f.default.AUDIO)&&!_.canPlayOgg())if(_.shouldUseMediaCache(r)){var u=t.filehash;if(u&&t.mediaBlob)return p.transcode(t.mediaBlob.formData()).then((e=>{c.default.put(u,e)})).then((()=>d))}else if(t.mediaBlob)return _.gatherAndSetMetadata(t,t.mediaBlob).then((()=>d));return d}))})).then((e=>{if(g.aborted)throw new u.AbortError;return t.consolidate({uploadStage:h.UPLOAD_STAGE.UPLOADED}),__LOG__(2)`MediaAlgo.uploadMedia: success`,{kind:y.SUCCESS,mediaEntry:e}})).catch((e=>{throw e.name===l.ABORT_ERROR?__LOG__(2)`MediaAlgo.uploadMedia: canceled`:__LOG__(3)`MediaAlgo.uploadMedia: error`,e})).finally((()=>{delete t.uploadPromise})).catchType(d.MediaNotOnPhone,(()=>(t.consolidate({uploadStage:h.UPLOAD_STAGE.ERROR_MISSING}),{kind:y.ERROR}))).catchType(u.MediaTooLargeError,(()=>(t.consolidate({uploadStage:h.UPLOAD_STAGE.ERROR_TOO_LARGE}),{kind:y.ERROR}))).catch((e=>(t.consolidate({uploadStage:h.UPLOAD_STAGE.NEED_UPLOAD}),e.name===l.ABORT_ERROR?{kind:y.CANCELLATION}:{kind:y.ERROR})));return E.set(T,(()=>{m.abort()})),t.uploadPromise=T,T},t.getOrDownloadBlob=S,t.getBlobFromMediaObject=A,t.UploadMediaResultKind=void 0;var n=i(r(52954)),s=i(r(47677)),o=i(r(45026)),l=r(3599),d=r(95378),u=r(43341),c=i(r(11159)),p=a(r(28119)),h=r(60301),f=i(r(79843)),_=a(r(25332)),m=i(r(84161)),g=r(37554),v=i(r(13139)),E=new WeakMap;var y={SUCCESS:"success",CANCELLATION:"cancellation",ERROR:"error"};function S(){return T.apply(this,arguments)}function T(){return(T=(0,n.default)((function*({mediaObject:e,mimetype:t,mediaType:r,abortSignal:a,uploadOrigin:i}){var n=A(e);if(n)return n;if(yield(0,g.downloadMedia)({mimetype:t,mediaObject:e,downloadEvenIfExpensive:!0,mediaType:r,signal:a,rmrReason:m.default.WEBC_RMR_REASON_CODE.UPLOAD,downloadOrigin:i===m.default.UPLOAD_ORIGIN_TYPE.CHAT_PERSONAL?m.default.DOWNLOAD_ORIGIN_TYPE.CHAT_PERSONAL:m.default.DOWNLOAD_ORIGIN_TYPE.CHAT_GROUP,mode:"manual"}),e.downloadStage===h.DOWNLOAD_STAGE.ERROR_MISSING)throw new d.MediaNotOnPhone;var s=A(e);if(s)return s;throw new Error("cant upload media w/out mediaBlob after download")}))).apply(this,arguments)}function A(e){var t=e.mediaBlob;return t?t.formData():e.filehash?c.default.get(e.filehash):void 0}t.UploadMediaResultKind=y},52313:(e,t,r)=>{"use strict";var a=r(14859),i=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var r=Promise.resolve().then((()=>{var r,a,i=e.size(),c=t.asDocument?s.FILETYPE.DOCUMENT:(0,s.typeFromMimetype)(e.type()),p=null!==(r=t.isVcardOverMmsDocument)&&void 0!==r&&r;if(i>function(e,t){if(e===s.FILETYPE.DOCUMENT)return t?1024*u.default.vcardMaxSizeKb:u.default.maxFileSize;return u.default.media}(c,p))return Promise.reject(new o.default(e));if(i<=0)return Promise.reject(new n.MediaFileEmpty);switch(null!=t.gifAttribution?a=t.gifAttribution:t.asGif&&(a=0),c){case"image":return d.processRawImage(e).then((({blob:e,width:t,height:r,preview:a})=>({type:l.OUTWARD_TYPES.IMAGE,mediaBlob:e,mimetype:"image/jpeg",fullWidth:t,fullHeight:r,preview:a})));case"video":case"audio":return d.processRawAudioVideo(e,!!t.isPtt,t.precomputedFields,t.asGif,a,e.type());case"document":return d.processRawDocument(e,t.filename,p,t.documentPageCount);default:throw new Error("Received unsupported mediaType: "+c)}}));return e.retain(),e.autoreleaseWhenPromiseCompletes(r),r};var n=i(r(24461)),s=r(48537),o=a(r(40430)),l=r(60301),d=i(r(25332)),u=a(r(54559))},57713:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.RequestMediaReuploadManager=void 0;var i=a(r(52954)),n=a(r(21830)),s=a(r(94382));class o{constructor(){var e=this;this._rmrRequests=new Map,this.requestMediaReupload=function(){var t=(0,i.default)((function*(t){var r=t.id.id,a=e._rmrRequests.get(r);if(a)return(0,n.default)(a.request,"existingRequest.request");var i=new Promise(((a,i)=>{e._rmrRequests.set(r,{resolve:a,reject:i,msg:t})}));return(0,n.default)(e._rmrRequests.get(r),"_this._rmrRequests.get(msgId)").request=i,yield(0,s.default)(t),i}));return function(){return t.apply(this,arguments)}}(),this.resolveMediaReupload=({msgId:e,result:t,directPath:r})=>{var a=this._rmrRequests.get(e);null!=a?(a.resolve({result:t,directPath:r}),this._rmrRequests.delete(e)):__LOG__(3)`resolveMediaReupload: msgId (${e}) is not found in _rmrRequests`},this.getMediaKey=e=>{var t;return null===(t=this._rmrRequests.get(e))||void 0===t?void 0:t.msg.mediaKey}}}t.RequestMediaReuploadManager=o;var l=new o;t.default=l},9856:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return i.default.globalUnixTime()-e<n.default.mmsMediaKeyTTL+Math.floor(86400*Math.random())};var i=a(r(99461)),n=a(r(54559))},38550:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ADVSignedDeviceIdentityHMACSpec=t.ADVSignedDeviceIdentitySpec=t.ADVDeviceIdentitySpec=t.ADVSignedKeyIndexListSpec=t.ADVKeyIndexListSpec=void 0;var a=r(99454),i={};t.ADVKeyIndexListSpec=i;var n={};t.ADVSignedKeyIndexListSpec=n;var s={};t.ADVDeviceIdentitySpec=s;var o={};t.ADVSignedDeviceIdentitySpec=o;var l={};t.ADVSignedDeviceIdentityHMACSpec=l,i.internalSpec={rawId:[1,a.TYPES.UINT32],timestamp:[2,a.TYPES.UINT64],currentIndex:[3,a.TYPES.UINT32],validIndexes:[4,a.FLAGS.REPEATED|a.FLAGS.PACKED|a.TYPES.UINT32]},n.internalSpec={details:[1,a.TYPES.BYTES],accountSignature:[2,a.TYPES.BYTES]},s.internalSpec={rawId:[1,a.TYPES.UINT32],timestamp:[2,a.TYPES.UINT64],keyIndex:[3,a.TYPES.UINT32]},o.internalSpec={details:[1,a.TYPES.BYTES],accountSignatureKey:[2,a.TYPES.BYTES],accountSignature:[3,a.TYPES.BYTES],deviceSignature:[4,a.TYPES.BYTES]},l.internalSpec={details:[1,a.TYPES.BYTES],hmac:[2,a.TYPES.BYTES]}},1935:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AppVersionSpec=t.CompanionPropsSpec=t.CompanionPropsPlatformType=void 0;var a=r(99454),i=r(28103)({UNKNOWN:0,CHROME:1,FIREFOX:2,IE:3,OPERA:4,SAFARI:5,EDGE:6,DESKTOP:7,IPAD:8,ANDROID_TABLET:9,OHANA:10,ALOHA:11,CATALINA:12});t.CompanionPropsPlatformType=i;var n={};t.CompanionPropsSpec=n;var s={};t.AppVersionSpec=s,n.internalSpec={os:[1,a.TYPES.STRING],version:[2,a.TYPES.MESSAGE,s],platformType:[3,a.TYPES.ENUM,i],requireFullSync:[4,a.TYPES.BOOL]},s.internalSpec={primary:[1,a.TYPES.UINT32],secondary:[2,a.TYPES.UINT32],tertiary:[3,a.TYPES.UINT32],quaternary:[4,a.TYPES.UINT32],quinary:[5,a.TYPES.UINT32]}},99429:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PaymentBackgroundSpec=t.MoneySpec=t.HydratedQuickReplyButtonSpec=t.HydratedURLButtonSpec=t.HydratedCallButtonSpec=t.HydratedTemplateButtonSpec=t.QuickReplyButtonSpec=t.URLButtonSpec=t.CallButtonSpec=t.TemplateButtonSpec=t.LocationSpec=t.PointSpec=t.InteractiveAnnotationSpec=t.DeviceListMetadataSpec=t.MessageContextInfoSpec=t.AdReplyInfoSpec=t.ExternalAdReplyInfoSpec=t.ContextInfoSpec=t.SenderKeyDistributionMessageSpec=t.ImageMessageSpec=t.InvoiceMessageSpec=t.ContactMessageSpec=t.LocationMessageSpec=t.ExtendedTextMessageSpec=t.DocumentMessageSpec=t.AudioMessageSpec=t.VideoMessageSpec=t.CallSpec=t.ChatSpec=t.ProtocolMessageSpec=t.HistorySyncNotificationSpec=t.AppStateSyncKeySpec=t.AppStateSyncKeyIdSpec=t.AppStateSyncKeyFingerprintSpec=t.AppStateSyncKeyDataSpec=t.AppStateSyncKeyShareSpec=t.AppStateSyncKeyRequestSpec=t.AppStateFatalExceptionNotificationSpec=t.InitialSecurityNotificationSettingSyncSpec=t.ContactsArrayMessageSpec=t.HSMCurrencySpec=t.HSMDateTimeComponentSpec=t.HSMDateTimeUnixEpochSpec=t.HSMDateTimeSpec=t.HSMLocalizableParameterSpec=t.HighlyStructuredMessageSpec=t.SendPaymentMessageSpec=t.RequestPaymentMessageSpec=t.DeclinePaymentRequestMessageSpec=t.CancelPaymentRequestMessageSpec=t.PaymentInviteMessageSpec=t.LiveLocationMessageSpec=t.StickerMessageSpec=t.FourRowTemplateSpec=t.HydratedFourRowTemplateSpec=t.TemplateMessageSpec=t.TemplateButtonReplyMessageSpec=t.CatalogSnapshotSpec=t.ProductSnapshotSpec=t.ProductMessageSpec=t.OrderMessageSpec=t.RowSpec=t.SectionSpec=t.ProductSpec=t.ProductSectionSpec=t.ProductListHeaderImageSpec=t.ProductListInfoSpec=t.ListMessageSpec=t.SingleSelectReplySpec=t.ListResponseMessageSpec=t.GroupInviteMessageSpec=t.DeviceSentMessageSpec=t.FutureProofMessageSpec=t.ButtonTextSpec=t.NativeFlowInfoSpec=t.ButtonSpec=t.ButtonsMessageSpec=t.ButtonsResponseMessageSpec=t.MessageSpec=t.AdReplyInfoMediaType=t.ExternalAdReplyInfoMediaType=t.InvoiceMessageAttachmentType=t.ExtendedTextMessageFontType=t.ExtendedTextMessagePreviewType=t.VideoMessageAttribution=t.ProtocolMessageType=t.HistorySyncNotificationHistorySyncType=t.HSMDateTimeComponentDayOfWeekType=t.HSMDateTimeComponentCalendarType=t.PaymentInviteMessageServiceType=t.OrderMessageOrderStatus=t.OrderMessageOrderSurface=t.ListMessageListType=t.ListResponseMessageListType=t.ButtonsMessageHeaderType=t.ButtonType=t.ButtonsResponseMessageType=void 0;var a=r(3257),i=r(99454),n=r(28103)({UNKNOWN:0,DISPLAY_TEXT:1});t.ButtonsResponseMessageType=n;var s=r(28103)({UNKNOWN:0,RESPONSE:1,NATIVE_FLOW:2});t.ButtonType=s;var o=r(28103)({UNKNOWN:0,EMPTY:1,TEXT:2,DOCUMENT:3,IMAGE:4,VIDEO:5,LOCATION:6});t.ButtonsMessageHeaderType=o;var l=r(28103)({UNKNOWN:0,SINGLE_SELECT:1});t.ListResponseMessageListType=l;var d=r(28103)({UNKNOWN:0,SINGLE_SELECT:1,PRODUCT_LIST:2});t.ListMessageListType=d;var u=r(28103)({CATALOG:1});t.OrderMessageOrderSurface=u;var c=r(28103)({INQUIRY:1});t.OrderMessageOrderStatus=c;var p=r(28103)({UNKNOWN:0,FBPAY:1,NOVI:2,UPI:3});t.PaymentInviteMessageServiceType=p;var h=r(28103)({GREGORIAN:1,SOLAR_HIJRI:2});t.HSMDateTimeComponentCalendarType=h;var f=r(28103)({MONDAY:1,TUESDAY:2,WEDNESDAY:3,THURSDAY:4,FRIDAY:5,SATURDAY:6,SUNDAY:7});t.HSMDateTimeComponentDayOfWeekType=f;var _=r(28103)({INITIAL_BOOTSTRAP:0,INITIAL_STATUS_V3:1,FULL:2,RECENT:3,PUSH_NAME:4});t.HistorySyncNotificationHistorySyncType=_;var m=r(28103)({REVOKE:0,EPHEMERAL_SETTING:3,EPHEMERAL_SYNC_RESPONSE:4,HISTORY_SYNC_NOTIFICATION:5,APP_STATE_SYNC_KEY_SHARE:6,APP_STATE_SYNC_KEY_REQUEST:7,MSG_FANOUT_BACKFILL_REQUEST:8,INITIAL_SECURITY_NOTIFICATION_SETTING_SYNC:9,APP_STATE_FATAL_EXCEPTION_NOTIFICATION:10});t.ProtocolMessageType=m;var g=r(28103)({NONE:0,GIPHY:1,TENOR:2});t.VideoMessageAttribution=g;var v=r(28103)({NONE:0,VIDEO:1});t.ExtendedTextMessagePreviewType=v;var E=r(28103)({SANS_SERIF:0,SERIF:1,NORICAN_REGULAR:2,BRYNDAN_WRITE:3,BEBASNEUE_REGULAR:4,OSWALD_HEAVY:5});t.ExtendedTextMessageFontType=E;var y=r(28103)({IMAGE:0,PDF:1});t.InvoiceMessageAttachmentType=y;var S=r(28103)({NONE:0,IMAGE:1,VIDEO:2});t.ExternalAdReplyInfoMediaType=S;var T=r(28103)({NONE:0,IMAGE:1,VIDEO:2});t.AdReplyInfoMediaType=T;var A={};t.MessageSpec=A;var b={};t.ButtonsResponseMessageSpec=b;var C={};t.ButtonsMessageSpec=C;var P={};t.ButtonSpec=P;var O={};t.NativeFlowInfoSpec=O;var w={};t.ButtonTextSpec=w;var M={};t.FutureProofMessageSpec=M;var I={};t.DeviceSentMessageSpec=I;var R={};t.GroupInviteMessageSpec=R;var D={};t.ListResponseMessageSpec=D;var N={};t.SingleSelectReplySpec=N;var L={};t.ListMessageSpec=L;var k={};t.ProductListInfoSpec=k;var U={};t.ProductListHeaderImageSpec=U;var G={};t.ProductSectionSpec=G;var F={};t.ProductSpec=F;var x={};t.SectionSpec=x;var B={};t.RowSpec=B;var Y={};t.OrderMessageSpec=Y;var K={};t.ProductMessageSpec=K;var j={};t.ProductSnapshotSpec=j;var W={};t.CatalogSnapshotSpec=W;var H={};t.TemplateButtonReplyMessageSpec=H;var V={};t.TemplateMessageSpec=V;var $={};t.HydratedFourRowTemplateSpec=$;var q={};t.FourRowTemplateSpec=q;var z={};t.StickerMessageSpec=z;var J={};t.LiveLocationMessageSpec=J;var Q={};t.PaymentInviteMessageSpec=Q;var X={};t.CancelPaymentRequestMessageSpec=X;var Z={};t.DeclinePaymentRequestMessageSpec=Z;var ee={};t.RequestPaymentMessageSpec=ee;var te={};t.SendPaymentMessageSpec=te;var re={};t.HighlyStructuredMessageSpec=re;var ae={};t.HSMLocalizableParameterSpec=ae;var ie={};t.HSMDateTimeSpec=ie;var ne={};t.HSMDateTimeUnixEpochSpec=ne;var se={};t.HSMDateTimeComponentSpec=se;var oe={};t.HSMCurrencySpec=oe;var le={};t.ContactsArrayMessageSpec=le;var de={};t.InitialSecurityNotificationSettingSyncSpec=de;var ue={};t.AppStateFatalExceptionNotificationSpec=ue;var ce={};t.AppStateSyncKeyRequestSpec=ce;var pe={};t.AppStateSyncKeyShareSpec=pe;var he={};t.AppStateSyncKeyDataSpec=he;var fe={};t.AppStateSyncKeyFingerprintSpec=fe;var _e={};t.AppStateSyncKeyIdSpec=_e;var me={};t.AppStateSyncKeySpec=me;var ge={};t.HistorySyncNotificationSpec=ge;var ve={};t.ProtocolMessageSpec=ve;var Ee={};t.ChatSpec=Ee;var ye={};t.CallSpec=ye;var Se={};t.VideoMessageSpec=Se;var Te={};t.AudioMessageSpec=Te;var Ae={};t.DocumentMessageSpec=Ae;var be={};t.ExtendedTextMessageSpec=be;var Ce={};t.LocationMessageSpec=Ce;var Pe={};t.ContactMessageSpec=Pe;var Oe={};t.InvoiceMessageSpec=Oe;var we={};t.ImageMessageSpec=we;var Me={};t.SenderKeyDistributionMessageSpec=Me;var Ie={};t.ContextInfoSpec=Ie;var Re={};t.ExternalAdReplyInfoSpec=Re;var De={};t.AdReplyInfoSpec=De;var Ne={};t.MessageContextInfoSpec=Ne;var Le={};t.DeviceListMetadataSpec=Le;var ke={};t.InteractiveAnnotationSpec=ke;var Ue={};t.PointSpec=Ue;var Ge={};t.LocationSpec=Ge;var Fe={};t.TemplateButtonSpec=Fe;var xe={};t.CallButtonSpec=xe;var Be={};t.URLButtonSpec=Be;var Ye={};t.QuickReplyButtonSpec=Ye;var Ke={};t.HydratedTemplateButtonSpec=Ke;var je={};t.HydratedCallButtonSpec=je;var We={};t.HydratedURLButtonSpec=We;var He={};t.HydratedQuickReplyButtonSpec=He;var Ve={};t.MoneySpec=Ve;var $e={};t.PaymentBackgroundSpec=$e,A.internalSpec={conversation:[1,i.TYPES.STRING],senderKeyDistributionMessage:[2,i.TYPES.MESSAGE,Me],imageMessage:[3,i.TYPES.MESSAGE,we],contactMessage:[4,i.TYPES.MESSAGE,Pe],locationMessage:[5,i.TYPES.MESSAGE,Ce],extendedTextMessage:[6,i.TYPES.MESSAGE,be],documentMessage:[7,i.TYPES.MESSAGE,Ae],audioMessage:[8,i.TYPES.MESSAGE,Te],videoMessage:[9,i.TYPES.MESSAGE,Se],call:[10,i.TYPES.MESSAGE,ye],chat:[11,i.TYPES.MESSAGE,Ee],protocolMessage:[12,i.TYPES.MESSAGE,ve],contactsArrayMessage:[13,i.TYPES.MESSAGE,le],highlyStructuredMessage:[14,i.TYPES.MESSAGE,re],fastRatchetKeySenderKeyDistributionMessage:[15,i.TYPES.MESSAGE,Me],sendPaymentMessage:[16,i.TYPES.MESSAGE,te],liveLocationMessage:[18,i.TYPES.MESSAGE,J],requestPaymentMessage:[22,i.TYPES.MESSAGE,ee],declinePaymentRequestMessage:[23,i.TYPES.MESSAGE,Z],cancelPaymentRequestMessage:[24,i.TYPES.MESSAGE,X],templateMessage:[25,i.TYPES.MESSAGE,V],stickerMessage:[26,i.TYPES.MESSAGE,z],groupInviteMessage:[28,i.TYPES.MESSAGE,R],templateButtonReplyMessage:[29,i.TYPES.MESSAGE,H],productMessage:[30,i.TYPES.MESSAGE,K],deviceSentMessage:[31,i.TYPES.MESSAGE,I],messageContextInfo:[35,i.TYPES.MESSAGE,Ne],listMessage:[36,i.TYPES.MESSAGE,L],viewOnceMessage:[37,i.TYPES.MESSAGE,M],orderMessage:[38,i.TYPES.MESSAGE,Y],listResponseMessage:[39,i.TYPES.MESSAGE,D],ephemeralMessage:[40,i.TYPES.MESSAGE,M],invoiceMessage:[41,i.TYPES.MESSAGE,Oe],buttonsMessage:[42,i.TYPES.MESSAGE,C],buttonsResponseMessage:[43,i.TYPES.MESSAGE,b],paymentInviteMessage:[44,i.TYPES.MESSAGE,Q]},b.internalSpec={selectedButtonId:[1,i.TYPES.STRING],selectedDisplayText:[2,i.TYPES.STRING],contextInfo:[3,i.TYPES.MESSAGE,Ie],type:[4,i.TYPES.ENUM,n],__oneofs__:{response:["selectedDisplayText"]}},C.internalSpec={text:[1,i.TYPES.STRING],documentMessage:[2,i.TYPES.MESSAGE,Ae],imageMessage:[3,i.TYPES.MESSAGE,we],videoMessage:[4,i.TYPES.MESSAGE,Se],locationMessage:[5,i.TYPES.MESSAGE,Ce],contentText:[6,i.TYPES.STRING],footerText:[7,i.TYPES.STRING],contextInfo:[8,i.TYPES.MESSAGE,Ie],buttons:[9,i.FLAGS.REPEATED|i.TYPES.MESSAGE,P],headerType:[10,i.TYPES.ENUM,o],__oneofs__:{header:["text","documentMessage","imageMessage","videoMessage","locationMessage"]}},P.internalSpec={buttonId:[1,i.TYPES.STRING],buttonText:[2,i.TYPES.MESSAGE,w],type:[3,i.TYPES.ENUM,s],nativeFlowInfo:[4,i.TYPES.MESSAGE,O]},O.internalSpec={name:[1,i.TYPES.STRING],paramsJson:[2,i.TYPES.STRING]},w.internalSpec={displayText:[1,i.TYPES.STRING]},M.internalSpec={message:[1,i.TYPES.MESSAGE,A]},I.internalSpec={destinationJid:[1,i.TYPES.STRING],message:[2,i.TYPES.MESSAGE,A],phash:[3,i.TYPES.STRING]},R.internalSpec={groupJid:[1,i.TYPES.STRING],inviteCode:[2,i.TYPES.STRING],inviteExpiration:[3,i.TYPES.INT64],groupName:[4,i.TYPES.STRING],jpegThumbnail:[5,i.TYPES.BYTES],caption:[6,i.TYPES.STRING],contextInfo:[7,i.TYPES.MESSAGE,Ie]},D.internalSpec={title:[1,i.TYPES.STRING],listType:[2,i.TYPES.ENUM,l],singleSelectReply:[3,i.TYPES.MESSAGE,N],contextInfo:[4,i.TYPES.MESSAGE,Ie],description:[5,i.TYPES.STRING]},N.internalSpec={selectedRowId:[1,i.TYPES.STRING]},L.internalSpec={title:[1,i.TYPES.STRING],description:[2,i.TYPES.STRING],buttonText:[3,i.TYPES.STRING],listType:[4,i.TYPES.ENUM,d],sections:[5,i.FLAGS.REPEATED|i.TYPES.MESSAGE,x],productListInfo:[6,i.TYPES.MESSAGE,k],footerText:[7,i.TYPES.STRING],contextInfo:[8,i.TYPES.MESSAGE,Ie]},k.internalSpec={productSections:[1,i.FLAGS.REPEATED|i.TYPES.MESSAGE,G],headerImage:[2,i.TYPES.MESSAGE,U],businessOwnerJid:[3,i.TYPES.STRING]},U.internalSpec={productId:[1,i.TYPES.STRING],jpegThumbnail:[2,i.TYPES.BYTES]},G.internalSpec={title:[1,i.TYPES.STRING],products:[2,i.FLAGS.REPEATED|i.TYPES.MESSAGE,F]},F.internalSpec={productId:[1,i.TYPES.STRING]},x.internalSpec={title:[1,i.TYPES.STRING],rows:[2,i.FLAGS.REPEATED|i.TYPES.MESSAGE,B]},B.internalSpec={title:[1,i.TYPES.STRING],description:[2,i.TYPES.STRING],rowId:[3,i.TYPES.STRING]},Y.internalSpec={orderId:[1,i.TYPES.STRING],thumbnail:[2,i.TYPES.BYTES],itemCount:[3,i.TYPES.INT32],status:[4,i.TYPES.ENUM,c],surface:[5,i.TYPES.ENUM,u],message:[6,i.TYPES.STRING],orderTitle:[7,i.TYPES.STRING],sellerJid:[8,i.TYPES.STRING],token:[9,i.TYPES.STRING],totalAmount1000:[10,i.TYPES.INT64],totalCurrencyCode:[11,i.TYPES.STRING],contextInfo:[17,i.TYPES.MESSAGE,Ie]},K.internalSpec={product:[1,i.TYPES.MESSAGE,j],businessOwnerJid:[2,i.TYPES.STRING],catalog:[4,i.TYPES.MESSAGE,W],contextInfo:[17,i.TYPES.MESSAGE,Ie]},j.internalSpec={productImage:[1,i.TYPES.MESSAGE,we],productId:[2,i.TYPES.STRING],title:[3,i.TYPES.STRING],description:[4,i.TYPES.STRING],currencyCode:[5,i.TYPES.STRING],priceAmount1000:[6,i.TYPES.INT64],retailerId:[7,i.TYPES.STRING],url:[8,i.TYPES.STRING],productImageCount:[9,i.TYPES.UINT32],firstImageId:[11,i.TYPES.STRING],salePriceAmount1000:[12,i.TYPES.INT64]},W.internalSpec={catalogImage:[1,i.TYPES.MESSAGE,we],title:[2,i.TYPES.STRING],description:[3,i.TYPES.STRING]},H.internalSpec={selectedId:[1,i.TYPES.STRING],selectedDisplayText:[2,i.TYPES.STRING],contextInfo:[3,i.TYPES.MESSAGE,Ie],selectedIndex:[4,i.TYPES.UINT32]},V.internalSpec={fourRowTemplate:[1,i.TYPES.MESSAGE,q],hydratedFourRowTemplate:[2,i.TYPES.MESSAGE,$],contextInfo:[3,i.TYPES.MESSAGE,Ie],hydratedTemplate:[4,i.TYPES.MESSAGE,$],__oneofs__:{format:["fourRowTemplate","hydratedFourRowTemplate"]}},$.internalSpec={documentMessage:[1,i.TYPES.MESSAGE,Ae],hydratedTitleText:[2,i.TYPES.STRING],imageMessage:[3,i.TYPES.MESSAGE,we],videoMessage:[4,i.TYPES.MESSAGE,Se],locationMessage:[5,i.TYPES.MESSAGE,Ce],hydratedContentText:[6,i.TYPES.STRING],hydratedFooterText:[7,i.TYPES.STRING],hydratedButtons:[8,i.FLAGS.REPEATED|i.TYPES.MESSAGE,Ke],templateId:[9,i.TYPES.STRING],__oneofs__:{title:["documentMessage","hydratedTitleText","imageMessage","videoMessage","locationMessage"]}},q.internalSpec={documentMessage:[1,i.TYPES.MESSAGE,Ae],highlyStructuredMessage:[2,i.TYPES.MESSAGE,re],imageMessage:[3,i.TYPES.MESSAGE,we],videoMessage:[4,i.TYPES.MESSAGE,Se],locationMessage:[5,i.TYPES.MESSAGE,Ce],content:[6,i.TYPES.MESSAGE,re],footer:[7,i.TYPES.MESSAGE,re],buttons:[8,i.FLAGS.REPEATED|i.TYPES.MESSAGE,Fe],__oneofs__:{title:["documentMessage","highlyStructuredMessage","imageMessage","videoMessage","locationMessage"]}},z.internalSpec={url:[1,i.TYPES.STRING],fileSha256:[2,i.TYPES.BYTES],fileEncSha256:[3,i.TYPES.BYTES],mediaKey:[4,i.TYPES.BYTES],mimetype:[5,i.TYPES.STRING],height:[6,i.TYPES.UINT32],width:[7,i.TYPES.UINT32],directPath:[8,i.TYPES.STRING],fileLength:[9,i.TYPES.UINT64],mediaKeyTimestamp:[10,i.TYPES.INT64],firstFrameLength:[11,i.TYPES.UINT32],firstFrameSidecar:[12,i.TYPES.BYTES],isAnimated:[13,i.TYPES.BOOL],pngThumbnail:[16,i.TYPES.BYTES],contextInfo:[17,i.TYPES.MESSAGE,Ie]},J.internalSpec={degreesLatitude:[1,i.TYPES.DOUBLE],degreesLongitude:[2,i.TYPES.DOUBLE],accuracyInMeters:[3,i.TYPES.UINT32],speedInMps:[4,i.TYPES.FLOAT],degreesClockwiseFromMagneticNorth:[5,i.TYPES.UINT32],caption:[6,i.TYPES.STRING],sequenceNumber:[7,i.TYPES.INT64],timeOffset:[8,i.TYPES.UINT32],jpegThumbnail:[16,i.TYPES.BYTES],contextInfo:[17,i.TYPES.MESSAGE,Ie]},Q.internalSpec={serviceType:[1,i.TYPES.ENUM,p],expiryTimestamp:[2,i.TYPES.INT64]},X.internalSpec={key:[1,i.TYPES.MESSAGE,a.MessageKeySpec]},Z.internalSpec={key:[1,i.TYPES.MESSAGE,a.MessageKeySpec]},ee.internalSpec={noteMessage:[4,i.TYPES.MESSAGE,A],currencyCodeIso4217:[1,i.TYPES.STRING],amount1000:[2,i.TYPES.UINT64],requestFrom:[3,i.TYPES.STRING],expiryTimestamp:[5,i.TYPES.INT64],amount:[6,i.TYPES.MESSAGE,Ve],background:[7,i.TYPES.MESSAGE,$e]},te.internalSpec={noteMessage:[2,i.TYPES.MESSAGE,A],requestMessageKey:[3,i.TYPES.MESSAGE,a.MessageKeySpec],background:[4,i.TYPES.MESSAGE,$e]},re.internalSpec={namespace:[1,i.TYPES.STRING],elementName:[2,i.TYPES.STRING],params:[3,i.FLAGS.REPEATED|i.TYPES.STRING],fallbackLg:[4,i.TYPES.STRING],fallbackLc:[5,i.TYPES.STRING],localizableParams:[6,i.FLAGS.REPEATED|i.TYPES.MESSAGE,ae],deterministicLg:[7,i.TYPES.STRING],deterministicLc:[8,i.TYPES.STRING],hydratedHsm:[9,i.TYPES.MESSAGE,V]},ae.internalSpec={default:[1,i.TYPES.STRING],currency:[2,i.TYPES.MESSAGE,oe],dateTime:[3,i.TYPES.MESSAGE,ie],__oneofs__:{paramOneof:["currency","dateTime"]}},ie.internalSpec={component:[1,i.TYPES.MESSAGE,se],unixEpoch:[2,i.TYPES.MESSAGE,ne],__oneofs__:{datetimeOneof:["component","unixEpoch"]}},ne.internalSpec={timestamp:[1,i.TYPES.INT64]},se.internalSpec={dayOfWeek:[1,i.TYPES.ENUM,f],year:[2,i.TYPES.UINT32],month:[3,i.TYPES.UINT32],dayOfMonth:[4,i.TYPES.UINT32],hour:[5,i.TYPES.UINT32],minute:[6,i.TYPES.UINT32],calendar:[7,i.TYPES.ENUM,h]},oe.internalSpec={currencyCode:[1,i.TYPES.STRING],amount1000:[2,i.TYPES.INT64]},le.internalSpec={displayName:[1,i.TYPES.STRING],contacts:[2,i.FLAGS.REPEATED|i.TYPES.MESSAGE,Pe],contextInfo:[17,i.TYPES.MESSAGE,Ie]},de.internalSpec={securityNotificationEnabled:[1,i.TYPES.BOOL]},ue.internalSpec={collectionNames:[1,i.FLAGS.REPEATED|i.TYPES.STRING],timestamp:[2,i.TYPES.INT64]},ce.internalSpec={keyIds:[1,i.FLAGS.REPEATED|i.TYPES.MESSAGE,_e]},pe.internalSpec={keys:[1,i.FLAGS.REPEATED|i.TYPES.MESSAGE,me]},he.internalSpec={keyData:[1,i.TYPES.BYTES],fingerprint:[2,i.TYPES.MESSAGE,fe],timestamp:[3,i.TYPES.INT64]},fe.internalSpec={rawId:[1,i.TYPES.UINT32],currentIndex:[2,i.TYPES.UINT32],deviceIndexes:[3,i.FLAGS.REPEATED|i.FLAGS.PACKED|i.TYPES.UINT32]},_e.internalSpec={keyId:[1,i.TYPES.BYTES]},me.internalSpec={keyId:[1,i.TYPES.MESSAGE,_e],keyData:[2,i.TYPES.MESSAGE,he]},ge.internalSpec={fileSha256:[1,i.TYPES.BYTES],fileLength:[2,i.TYPES.UINT64],mediaKey:[3,i.TYPES.BYTES],fileEncSha256:[4,i.TYPES.BYTES],directPath:[5,i.TYPES.STRING],syncType:[6,i.TYPES.ENUM,_],chunkOrder:[7,i.TYPES.UINT32],originalMessageId:[8,i.TYPES.STRING]},ve.internalSpec={key:[1,i.TYPES.MESSAGE,a.MessageKeySpec],type:[2,i.TYPES.ENUM,m],ephemeralExpiration:[4,i.TYPES.UINT32],ephemeralSettingTimestamp:[5,i.TYPES.INT64],historySyncNotification:[6,i.TYPES.MESSAGE,ge],appStateSyncKeyShare:[7,i.TYPES.MESSAGE,pe],appStateSyncKeyRequest:[8,i.TYPES.MESSAGE,ce],initialSecurityNotificationSettingSync:[9,i.TYPES.MESSAGE,de],appStateFatalExceptionNotification:[10,i.TYPES.MESSAGE,ue]},Ee.internalSpec={displayName:[1,i.TYPES.STRING],id:[2,i.TYPES.STRING]},ye.internalSpec={callKey:[1,i.TYPES.BYTES],conversionSource:[2,i.TYPES.STRING],conversionData:[3,i.TYPES.BYTES],conversionDelaySeconds:[4,i.TYPES.UINT32]},Se.internalSpec={url:[1,i.TYPES.STRING],mimetype:[2,i.TYPES.STRING],fileSha256:[3,i.TYPES.BYTES],fileLength:[4,i.TYPES.UINT64],seconds:[5,i.TYPES.UINT32],mediaKey:[6,i.TYPES.BYTES],caption:[7,i.TYPES.STRING],gifPlayback:[8,i.TYPES.BOOL],height:[9,i.TYPES.UINT32],width:[10,i.TYPES.UINT32],fileEncSha256:[11,i.TYPES.BYTES],interactiveAnnotations:[12,i.FLAGS.REPEATED|i.TYPES.MESSAGE,ke],directPath:[13,i.TYPES.STRING],mediaKeyTimestamp:[14,i.TYPES.INT64],jpegThumbnail:[16,i.TYPES.BYTES],contextInfo:[17,i.TYPES.MESSAGE,Ie],streamingSidecar:[18,i.TYPES.BYTES],gifAttribution:[19,i.TYPES.ENUM,g],viewOnce:[20,i.TYPES.BOOL],thumbnailDirectPath:[21,i.TYPES.STRING],thumbnailSha256:[22,i.TYPES.BYTES],thumbnailEncSha256:[23,i.TYPES.BYTES]},Te.internalSpec={url:[1,i.TYPES.STRING],mimetype:[2,i.TYPES.STRING],fileSha256:[3,i.TYPES.BYTES],fileLength:[4,i.TYPES.UINT64],seconds:[5,i.TYPES.UINT32],ptt:[6,i.TYPES.BOOL],mediaKey:[7,i.TYPES.BYTES],fileEncSha256:[8,i.TYPES.BYTES],directPath:[9,i.TYPES.STRING],mediaKeyTimestamp:[10,i.TYPES.INT64],contextInfo:[17,i.TYPES.MESSAGE,Ie],streamingSidecar:[18,i.TYPES.BYTES]},Ae.internalSpec={url:[1,i.TYPES.STRING],mimetype:[2,i.TYPES.STRING],title:[3,i.TYPES.STRING],fileSha256:[4,i.TYPES.BYTES],fileLength:[5,i.TYPES.UINT64],pageCount:[6,i.TYPES.UINT32],mediaKey:[7,i.TYPES.BYTES],fileName:[8,i.TYPES.STRING],fileEncSha256:[9,i.TYPES.BYTES],directPath:[10,i.TYPES.STRING],mediaKeyTimestamp:[11,i.TYPES.INT64],contactVcard:[12,i.TYPES.BOOL],thumbnailDirectPath:[13,i.TYPES.STRING],thumbnailSha256:[14,i.TYPES.BYTES],thumbnailEncSha256:[15,i.TYPES.BYTES],jpegThumbnail:[16,i.TYPES.BYTES],contextInfo:[17,i.TYPES.MESSAGE,Ie],thumbnailHeight:[18,i.TYPES.UINT32],thumbnailWidth:[19,i.TYPES.UINT32]},be.internalSpec={text:[1,i.TYPES.STRING],matchedText:[2,i.TYPES.STRING],canonicalUrl:[4,i.TYPES.STRING],description:[5,i.TYPES.STRING],title:[6,i.TYPES.STRING],textArgb:[7,i.TYPES.FIXED32],backgroundArgb:[8,i.TYPES.FIXED32],font:[9,i.TYPES.ENUM,E],previewType:[10,i.TYPES.ENUM,v],jpegThumbnail:[16,i.TYPES.BYTES],contextInfo:[17,i.TYPES.MESSAGE,Ie],doNotPlayInline:[18,i.TYPES.BOOL],thumbnailDirectPath:[19,i.TYPES.STRING],thumbnailSha256:[20,i.TYPES.BYTES],thumbnailEncSha256:[21,i.TYPES.BYTES],mediaKey:[22,i.TYPES.BYTES],mediaKeyTimestamp:[23,i.TYPES.INT64],thumbnailHeight:[24,i.TYPES.UINT32],thumbnailWidth:[25,i.TYPES.UINT32]},Ce.internalSpec={degreesLatitude:[1,i.TYPES.DOUBLE],degreesLongitude:[2,i.TYPES.DOUBLE],name:[3,i.TYPES.STRING],address:[4,i.TYPES.STRING],url:[5,i.TYPES.STRING],isLive:[6,i.TYPES.BOOL],accuracyInMeters:[7,i.TYPES.UINT32],speedInMps:[8,i.TYPES.FLOAT],degreesClockwiseFromMagneticNorth:[9,i.TYPES.UINT32],comment:[11,i.TYPES.STRING],jpegThumbnail:[16,i.TYPES.BYTES],contextInfo:[17,i.TYPES.MESSAGE,Ie]},Pe.internalSpec={displayName:[1,i.TYPES.STRING],vcard:[16,i.TYPES.STRING],contextInfo:[17,i.TYPES.MESSAGE,Ie]},Oe.internalSpec={note:[1,i.TYPES.STRING],token:[2,i.TYPES.STRING],attachmentType:[3,i.TYPES.ENUM,y],attachmentMimetype:[4,i.TYPES.STRING],attachmentMediaKey:[5,i.TYPES.BYTES],attachmentMediaKeyTimestamp:[6,i.TYPES.INT64],attachmentFileSha256:[7,i.TYPES.BYTES],attachmentFileEncSha256:[8,i.TYPES.BYTES],attachmentDirectPath:[9,i.TYPES.STRING],attachmentJpegThumbnail:[10,i.TYPES.BYTES]},we.internalSpec={url:[1,i.TYPES.STRING],mimetype:[2,i.TYPES.STRING],caption:[3,i.TYPES.STRING],fileSha256:[4,i.TYPES.BYTES],fileLength:[5,i.TYPES.UINT64],height:[6,i.TYPES.UINT32],width:[7,i.TYPES.UINT32],mediaKey:[8,i.TYPES.BYTES],fileEncSha256:[9,i.TYPES.BYTES],interactiveAnnotations:[10,i.FLAGS.REPEATED|i.TYPES.MESSAGE,ke],directPath:[11,i.TYPES.STRING],mediaKeyTimestamp:[12,i.TYPES.INT64],jpegThumbnail:[16,i.TYPES.BYTES],contextInfo:[17,i.TYPES.MESSAGE,Ie],firstScanSidecar:[18,i.TYPES.BYTES],firstScanLength:[19,i.TYPES.UINT32],experimentGroupId:[20,i.TYPES.UINT32],scansSidecar:[21,i.TYPES.BYTES],scanLengths:[22,i.FLAGS.REPEATED|i.TYPES.UINT32],midQualityFileSha256:[23,i.TYPES.BYTES],midQualityFileEncSha256:[24,i.TYPES.BYTES],viewOnce:[25,i.TYPES.BOOL],thumbnailDirectPath:[26,i.TYPES.STRING],thumbnailSha256:[27,i.TYPES.BYTES],thumbnailEncSha256:[28,i.TYPES.BYTES]},Me.internalSpec={groupId:[1,i.TYPES.STRING],axolotlSenderKeyDistributionMessage:[2,i.TYPES.BYTES]},Ie.internalSpec={stanzaId:[1,i.TYPES.STRING],participant:[2,i.TYPES.STRING],quotedMessage:[3,i.TYPES.MESSAGE,A],remoteJid:[4,i.TYPES.STRING],mentionedJid:[15,i.FLAGS.REPEATED|i.TYPES.STRING],conversionSource:[18,i.TYPES.STRING],conversionData:[19,i.TYPES.BYTES],conversionDelaySeconds:[20,i.TYPES.UINT32],forwardingScore:[21,i.TYPES.UINT32],isForwarded:[22,i.TYPES.BOOL],quotedAd:[23,i.TYPES.MESSAGE,De],placeholderKey:[24,i.TYPES.MESSAGE,a.MessageKeySpec],expiration:[25,i.TYPES.UINT32],ephemeralSettingTimestamp:[26,i.TYPES.INT64],ephemeralSharedSecret:[27,i.TYPES.BYTES],externalAdReply:[28,i.TYPES.MESSAGE,Re],entryPointConversionSource:[29,i.TYPES.STRING],entryPointConversionApp:[30,i.TYPES.STRING],entryPointConversionDelaySeconds:[31,i.TYPES.UINT32]},Re.internalSpec={title:[1,i.TYPES.STRING],body:[2,i.TYPES.STRING],mediaType:[3,i.TYPES.ENUM,S],thumbnailUrl:[4,i.TYPES.STRING],mediaUrl:[5,i.TYPES.STRING],thumbnail:[6,i.TYPES.BYTES],sourceType:[7,i.TYPES.STRING],sourceId:[8,i.TYPES.STRING],sourceUrl:[9,i.TYPES.STRING]},De.internalSpec={advertiserName:[1,i.TYPES.STRING],mediaType:[2,i.TYPES.ENUM,T],jpegThumbnail:[16,i.TYPES.BYTES],caption:[17,i.TYPES.STRING]},Ne.internalSpec={deviceListMetadata:[1,i.TYPES.MESSAGE,Le],deviceListMetadataVersion:[2,i.TYPES.INT32]},Le.internalSpec={senderKeyHash:[1,i.TYPES.BYTES],senderTimestamp:[2,i.TYPES.UINT64],senderKeyIndexes:[3,i.FLAGS.REPEATED|i.FLAGS.PACKED|i.TYPES.UINT32],recipientKeyHash:[8,i.TYPES.BYTES],recipientTimestamp:[9,i.TYPES.UINT64],recipientKeyIndexes:[10,i.FLAGS.REPEATED|i.FLAGS.PACKED|i.TYPES.UINT32]},ke.internalSpec={polygonVertices:[1,i.FLAGS.REPEATED|i.TYPES.MESSAGE,Ue],location:[2,i.TYPES.MESSAGE,Ge],__oneofs__:{action:["location"]}},Ue.internalSpec={xDeprecated:[1,i.TYPES.INT32],yDeprecated:[2,i.TYPES.INT32],x:[3,i.TYPES.DOUBLE],y:[4,i.TYPES.DOUBLE]},Ge.internalSpec={degreesLatitude:[1,i.TYPES.DOUBLE],degreesLongitude:[2,i.TYPES.DOUBLE],name:[3,i.TYPES.STRING]},Fe.internalSpec={quickReplyButton:[1,i.TYPES.MESSAGE,Ye],urlButton:[2,i.TYPES.MESSAGE,Be],callButton:[3,i.TYPES.MESSAGE,xe],index:[4,i.TYPES.UINT32],__oneofs__:{button:["quickReplyButton","urlButton","callButton"]}},xe.internalSpec={displayText:[1,i.TYPES.MESSAGE,re],phoneNumber:[2,i.TYPES.MESSAGE,re]},Be.internalSpec={displayText:[1,i.TYPES.MESSAGE,re],url:[2,i.TYPES.MESSAGE,re]},Ye.internalSpec={displayText:[1,i.TYPES.MESSAGE,re],id:[2,i.TYPES.STRING]},Ke.internalSpec={quickReplyButton:[1,i.TYPES.MESSAGE,He],urlButton:[2,i.TYPES.MESSAGE,We],callButton:[3,i.TYPES.MESSAGE,je],index:[4,i.TYPES.UINT32],__oneofs__:{hydratedButton:["quickReplyButton","urlButton","callButton"]}},je.internalSpec={displayText:[1,i.TYPES.STRING],phoneNumber:[2,i.TYPES.STRING]},We.internalSpec={displayText:[1,i.TYPES.STRING],url:[2,i.TYPES.STRING]},He.internalSpec={displayText:[1,i.TYPES.STRING],id:[2,i.TYPES.STRING]},Ve.internalSpec={value:[1,i.TYPES.INT64],offset:[2,i.TYPES.UINT32],currencyCode:[3,i.TYPES.STRING]},$e.internalSpec={id:[1,i.TYPES.STRING],fileLength:[2,i.TYPES.STRING],width:[3,i.TYPES.UINT32],height:[4,i.TYPES.UINT32],mimetype:[5,i.TYPES.STRING],placeholderArgb:[6,i.TYPES.FIXED32],textArgb:[7,i.TYPES.FIXED32],subtextArgb:[8,i.TYPES.FIXED32]}},31138:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EphemeralSettingSpec=void 0;var a=r(99454),i={};t.EphemeralSettingSpec=i,i.internalSpec={duration:[1,a.TYPES.SFIXED32],timestamp:[2,a.TYPES.SFIXED64]}},22697:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PushnameSpec=t.HistorySyncMsgSpec=t.ConversationSpec=t.HistorySyncSpec=t.ConversationEndOfHistoryTransferType=t.HistorySyncHistorySyncType=void 0;var a=r(94781),i=r(99454),n=r(28103)({INITIAL_BOOTSTRAP:0,INITIAL_STATUS_V3:1,FULL:2,RECENT:3,PUSH_NAME:4});t.HistorySyncHistorySyncType=n;var s=r(28103)({COMPLETE_BUT_MORE_MESSAGES_REMAIN_ON_PRIMARY:0,COMPLETE_AND_NO_MORE_MESSAGE_REMAIN_ON_PRIMARY:1});t.ConversationEndOfHistoryTransferType=s;var o={};t.HistorySyncSpec=o;var l={};t.ConversationSpec=l;var d={};t.HistorySyncMsgSpec=d;var u={};t.PushnameSpec=u,o.internalSpec={syncType:[1,i.FLAGS.REQUIRED|i.TYPES.ENUM,n],conversations:[2,i.FLAGS.REPEATED|i.TYPES.MESSAGE,l],statusV3Messages:[3,i.FLAGS.REPEATED|i.TYPES.MESSAGE,a.WebMessageInfoSpec],chunkOrder:[5,i.TYPES.UINT32],progress:[6,i.TYPES.UINT32],pushnames:[7,i.FLAGS.REPEATED|i.TYPES.MESSAGE,u]},l.internalSpec={id:[1,i.FLAGS.REQUIRED|i.TYPES.STRING],messages:[2,i.FLAGS.REPEATED|i.TYPES.MESSAGE,d],newJid:[3,i.TYPES.STRING],oldJid:[4,i.TYPES.STRING],lastMsgTimestamp:[5,i.TYPES.UINT64],unreadCount:[6,i.TYPES.UINT32],readOnly:[7,i.TYPES.BOOL],endOfHistoryTransfer:[8,i.TYPES.BOOL],ephemeralExpiration:[9,i.TYPES.UINT32],ephemeralSettingTimestamp:[10,i.TYPES.INT64],endOfHistoryTransferType:[11,i.TYPES.ENUM,s],conversationTimestamp:[12,i.TYPES.UINT64],name:[13,i.TYPES.STRING],pHash:[14,i.TYPES.STRING],notSpam:[15,i.TYPES.BOOL]},d.internalSpec={message:[1,i.TYPES.MESSAGE,a.WebMessageInfoSpec],msgOrderId:[2,i.TYPES.UINT64]},u.internalSpec={id:[1,i.TYPES.STRING],pushname:[2,i.TYPES.STRING]}},43874:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MsgOpaqueDataSpec=t.MsgRowOpaqueDataSpec=void 0;var a=r(99454),i={};t.MsgRowOpaqueDataSpec=i;var n={};t.MsgOpaqueDataSpec=n,i.internalSpec={currentMsg:[1,a.TYPES.MESSAGE,n],quotedMsg:[2,a.TYPES.MESSAGE,n]},n.internalSpec={body:[1,a.TYPES.STRING],caption:[3,a.TYPES.STRING],clientUrl:[4,a.TYPES.STRING],loc:[4,a.TYPES.STRING],lng:[5,a.TYPES.DOUBLE],lat:[7,a.TYPES.DOUBLE],paymentAmount1000:[8,a.TYPES.INT32],paymentNoteMsgBody:[9,a.TYPES.STRING],canonicalUrl:[10,a.TYPES.STRING],matchedText:[11,a.TYPES.STRING],title:[12,a.TYPES.STRING],description:[13,a.TYPES.STRING]}},83862:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ServerErrorReceiptSpec=t.MediaRetryNotificationSpec=t.MediaRetryNotificationResultType=void 0;var a=r(99454),i=r(28103)({GENERAL_ERROR:0,SUCCESS:1,NOT_FOUND:2,DECRYPTION_ERROR:3});t.MediaRetryNotificationResultType=i;var n={};t.MediaRetryNotificationSpec=n;var s={};t.ServerErrorReceiptSpec=s,n.internalSpec={stanzaId:[1,a.TYPES.STRING],directPath:[2,a.TYPES.STRING],result:[3,a.TYPES.ENUM,i]},s.internalSpec={stanzaId:[1,a.TYPES.STRING]}},3257:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MessageKeySpec=void 0;var a=r(99454),i={};t.MessageKeySpec=i,i.internalSpec={remoteJid:[1,a.TYPES.STRING],fromMe:[2,a.TYPES.BOOL],id:[3,a.TYPES.STRING],participant:[4,a.TYPES.STRING]}},65634:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SyncdPatchSpec=t.SyncdMutationSpec=t.SyncdMutationsSpec=t.SyncdSnapshotSpec=t.ExternalBlobReferenceSpec=t.SyncdRecordSpec=t.KeyIdSpec=t.SyncdValueSpec=t.SyncdIndexSpec=t.ExitCodeSpec=t.SyncdVersionSpec=t.SyncdMutationSyncdOperation=void 0;var a=r(99454),i=r(28103)({SET:0,REMOVE:1});t.SyncdMutationSyncdOperation=i;var n={};t.SyncdVersionSpec=n;var s={};t.ExitCodeSpec=s;var o={};t.SyncdIndexSpec=o;var l={};t.SyncdValueSpec=l;var d={};t.KeyIdSpec=d;var u={};t.SyncdRecordSpec=u;var c={};t.ExternalBlobReferenceSpec=c;var p={};t.SyncdSnapshotSpec=p;var h={};t.SyncdMutationsSpec=h;var f={};t.SyncdMutationSpec=f;var _={};t.SyncdPatchSpec=_,n.internalSpec={version:[1,a.TYPES.UINT64]},s.internalSpec={code:[1,a.TYPES.UINT64],text:[2,a.TYPES.STRING]},o.internalSpec={blob:[1,a.TYPES.BYTES]},l.internalSpec={blob:[1,a.TYPES.BYTES]},d.internalSpec={id:[1,a.TYPES.BYTES]},u.internalSpec={index:[1,a.TYPES.MESSAGE,o],value:[2,a.TYPES.MESSAGE,l],keyId:[3,a.TYPES.MESSAGE,d]},c.internalSpec={mediaKey:[1,a.TYPES.BYTES],directPath:[2,a.TYPES.STRING],handle:[3,a.TYPES.STRING],fileSizeBytes:[4,a.TYPES.UINT64],fileSha256:[5,a.TYPES.BYTES],fileEncSha256:[6,a.TYPES.BYTES]},p.internalSpec={version:[1,a.TYPES.MESSAGE,n],records:[2,a.FLAGS.REPEATED|a.TYPES.MESSAGE,u],mac:[3,a.TYPES.BYTES],keyId:[4,a.TYPES.MESSAGE,d]},h.internalSpec={mutations:[1,a.FLAGS.REPEATED|a.TYPES.MESSAGE,f]},f.internalSpec={operation:[1,a.TYPES.ENUM,i],record:[2,a.TYPES.MESSAGE,u]},_.internalSpec={version:[1,a.TYPES.MESSAGE,n],mutations:[2,a.FLAGS.REPEATED|a.TYPES.MESSAGE,f],externalMutations:[3,a.TYPES.MESSAGE,c],snapshotMac:[4,a.TYPES.BYTES],patchMac:[5,a.TYPES.BYTES],keyId:[6,a.TYPES.MESSAGE,d],exitCode:[7,a.TYPES.MESSAGE,s],deviceIndex:[8,a.TYPES.UINT32]}},60608:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SyncActionDataSpec=t.StarActionSpec=t.ContactActionSpec=t.MuteActionSpec=t.PinActionSpec=t.SecurityNotificationSettingSpec=t.PushNameSettingSpec=t.LocaleSettingSpec=t.QuickReplyActionSpec=t.LabelAssociationActionSpec=t.LabelEditActionSpec=t.RecentStickerWeightsActionSpec=t.RecentStickerMetadataSpec=t.RecentEmojiWeightsActionSpec=t.ArchiveChatActionSpec=t.DeleteMessageForMeActionSpec=t.MarkChatAsReadActionSpec=t.ClearChatActionSpec=t.DeleteChatActionSpec=t.UnarchiveChatsSettingSpec=t.SyncActionMessageRangeSpec=t.SyncActionMessageSpec=t.KeyExpirationSpec=t.SyncActionValueSpec=t.RecentEmojiWeightSpec=t.RecentStickerWeightSpec=void 0;var a=r(3257),i=r(99454),n={};t.RecentStickerWeightSpec=n;var s={};t.RecentEmojiWeightSpec=s;var o={};t.SyncActionValueSpec=o;var l={};t.KeyExpirationSpec=l;var d={};t.SyncActionMessageSpec=d;var u={};t.SyncActionMessageRangeSpec=u;var c={};t.UnarchiveChatsSettingSpec=c;var p={};t.DeleteChatActionSpec=p;var h={};t.ClearChatActionSpec=h;var f={};t.MarkChatAsReadActionSpec=f;var _={};t.DeleteMessageForMeActionSpec=_;var m={};t.ArchiveChatActionSpec=m;var g={};t.RecentEmojiWeightsActionSpec=g;var v={};t.RecentStickerMetadataSpec=v;var E={};t.RecentStickerWeightsActionSpec=E;var y={};t.LabelEditActionSpec=y;var S={};t.LabelAssociationActionSpec=S;var T={};t.QuickReplyActionSpec=T;var A={};t.LocaleSettingSpec=A;var b={};t.PushNameSettingSpec=b;var C={};t.SecurityNotificationSettingSpec=C;var P={};t.PinActionSpec=P;var O={};t.MuteActionSpec=O;var w={};t.ContactActionSpec=w;var M={};t.StarActionSpec=M;var I={};t.SyncActionDataSpec=I,n.internalSpec={filehash:[1,i.TYPES.STRING],weight:[2,i.TYPES.FLOAT]},s.internalSpec={emoji:[1,i.TYPES.STRING],weight:[2,i.TYPES.FLOAT]},o.internalSpec={timestamp:[1,i.TYPES.INT64],starAction:[2,i.TYPES.MESSAGE,M],contactAction:[3,i.TYPES.MESSAGE,w],muteAction:[4,i.TYPES.MESSAGE,O],pinAction:[5,i.TYPES.MESSAGE,P],securityNotificationSetting:[6,i.TYPES.MESSAGE,C],pushNameSetting:[7,i.TYPES.MESSAGE,b],quickReplyAction:[8,i.TYPES.MESSAGE,T],recentStickerWeightsAction:[9,i.TYPES.MESSAGE,E],recentStickerMetadata:[10,i.TYPES.MESSAGE,v],recentEmojiWeightsAction:[11,i.TYPES.MESSAGE,g],labelEditAction:[14,i.TYPES.MESSAGE,y],labelAssociationAction:[15,i.TYPES.MESSAGE,S],localeSetting:[16,i.TYPES.MESSAGE,A],archiveChatAction:[17,i.TYPES.MESSAGE,m],deleteMessageForMeAction:[18,i.TYPES.MESSAGE,_],keyExpiration:[19,i.TYPES.MESSAGE,l],markChatAsReadAction:[20,i.TYPES.MESSAGE,f],clearChatAction:[21,i.TYPES.MESSAGE,h],deleteChatAction:[22,i.TYPES.MESSAGE,p],unarchiveChatsSetting:[23,i.TYPES.MESSAGE,c]},l.internalSpec={expiredKeyEpoch:[1,i.TYPES.INT32]},d.internalSpec={key:[1,i.TYPES.MESSAGE,a.MessageKeySpec],timestamp:[2,i.TYPES.INT64]},u.internalSpec={lastMessageTimestamp:[1,i.TYPES.INT64],lastSystemMessageTimestamp:[2,i.TYPES.INT64],messages:[3,i.FLAGS.REPEATED|i.TYPES.MESSAGE,d]},c.internalSpec={unarchiveChats:[1,i.TYPES.BOOL]},p.internalSpec={messageRange:[1,i.TYPES.MESSAGE,u]},h.internalSpec={messageRange:[1,i.TYPES.MESSAGE,u]},f.internalSpec={read:[1,i.TYPES.BOOL],messageRange:[2,i.TYPES.MESSAGE,u]},_.internalSpec={deleteMedia:[1,i.TYPES.BOOL],messageTimestamp:[2,i.TYPES.INT64]},m.internalSpec={archived:[1,i.TYPES.BOOL],messageRange:[2,i.TYPES.MESSAGE,u]},g.internalSpec={weights:[1,i.FLAGS.REPEATED|i.TYPES.MESSAGE,s]},v.internalSpec={directPath:[1,i.TYPES.STRING],encFilehash:[2,i.TYPES.STRING],mediaKey:[3,i.TYPES.STRING],stanzaId:[4,i.TYPES.STRING],chatJid:[5,i.TYPES.STRING],participant:[6,i.TYPES.STRING],isSentByMe:[7,i.TYPES.BOOL]},E.internalSpec={weights:[1,i.FLAGS.REPEATED|i.TYPES.MESSAGE,n]},y.internalSpec={name:[1,i.TYPES.STRING],color:[2,i.TYPES.INT32],predefinedId:[3,i.TYPES.INT32],deleted:[4,i.TYPES.BOOL]},S.internalSpec={labeled:[1,i.TYPES.BOOL]},T.internalSpec={shortcut:[1,i.TYPES.STRING],message:[2,i.TYPES.STRING],keywords:[3,i.FLAGS.REPEATED|i.TYPES.STRING],count:[4,i.TYPES.INT32],deleted:[5,i.TYPES.BOOL]},A.internalSpec={locale:[1,i.TYPES.STRING]},b.internalSpec={name:[1,i.TYPES.STRING]},C.internalSpec={showNotification:[1,i.TYPES.BOOL]},P.internalSpec={pinned:[1,i.TYPES.BOOL]},O.internalSpec={muted:[1,i.TYPES.BOOL],muteEndTimestamp:[2,i.TYPES.INT64]},w.internalSpec={fullName:[1,i.TYPES.STRING],firstName:[2,i.TYPES.STRING]},M.internalSpec={starred:[1,i.TYPES.BOOL]},I.internalSpec={index:[1,i.TYPES.BYTES],value:[2,i.TYPES.MESSAGE,o],padding:[3,i.TYPES.BYTES],version:[4,i.TYPES.INT32]}},57300:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BizIdentityInfoSpec=t.BizAccountLinkInfoSpec=t.BizAccountPayloadSpec=t.DetailsSpec=t.VerifiedNameCertificateSpec=t.LocalizedNameSpec=t.BizIdentityInfoVerifiedLevelValue=t.BizIdentityInfoHostStorageType=t.BizIdentityInfoActualActorsType=t.BizAccountLinkInfoHostStorageType=t.BizAccountLinkInfoAccountType=void 0;var a=r(99454),i=r(28103)({ENTERPRISE:0,PAGE:1});t.BizAccountLinkInfoAccountType=i;var n=r(28103)({ON_PREMISE:0,FACEBOOK:1});t.BizAccountLinkInfoHostStorageType=n;var s=r(28103)({SELF:0,BSP:1});t.BizIdentityInfoActualActorsType=s;var o=r(28103)({ON_PREMISE:0,FACEBOOK:1});t.BizIdentityInfoHostStorageType=o;var l=r(28103)({UNKNOWN:0,LOW:1,HIGH:2});t.BizIdentityInfoVerifiedLevelValue=l;var d={};t.LocalizedNameSpec=d;var u={};t.VerifiedNameCertificateSpec=u;var c={};t.DetailsSpec=c;var p={};t.BizAccountPayloadSpec=p;var h={};t.BizAccountLinkInfoSpec=h;var f={};t.BizIdentityInfoSpec=f,d.internalSpec={lg:[1,a.TYPES.STRING],lc:[2,a.TYPES.STRING],verifiedName:[3,a.TYPES.STRING]},u.internalSpec={details:[1,a.TYPES.BYTES],signature:[2,a.TYPES.BYTES],serverSignature:[3,a.TYPES.BYTES]},c.internalSpec={serial:[1,a.TYPES.UINT64],issuer:[2,a.TYPES.STRING],verifiedName:[4,a.TYPES.STRING],localizedNames:[8,a.FLAGS.REPEATED|a.TYPES.MESSAGE,d],issueTime:[10,a.TYPES.UINT64]},p.internalSpec={vnameCert:[1,a.TYPES.MESSAGE,u],bizAcctLinkInfo:[2,a.TYPES.BYTES]},h.internalSpec={whatsappBizAcctFbid:[1,a.TYPES.UINT64],whatsappAcctNumber:[2,a.TYPES.STRING],issueTime:[3,a.TYPES.UINT64],hostStorage:[4,a.TYPES.ENUM,n],accountType:[5,a.TYPES.ENUM,i]},f.internalSpec={vlevel:[1,a.TYPES.ENUM,l],vnameCert:[2,a.TYPES.MESSAGE,u],signed:[3,a.TYPES.BOOL],revoked:[4,a.TYPES.BOOL],hostStorage:[5,a.TYPES.ENUM,o],actualActors:[6,a.TYPES.ENUM,s],privacyModeTs:[7,a.TYPES.UINT64]}},49592:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AppVersionSpec=t.UserAgentSpec=t.WebdPayloadSpec=t.WebInfoSpec=t.DNSSourceSpec=t.CompanionRegDataSpec=t.ClientPayloadSpec=t.DetailsSpec=t.NoiseCertificateSpec=t.ClientHelloSpec=t.ServerHelloSpec=t.ClientFinishSpec=t.HandshakeMessageSpec=t.ClientPayloadClientFeature=t.UserAgentPlatform=t.UserAgentReleaseChannel=t.WebInfoWebSubPlatform=t.ClientPayloadIOSAppExtension=t.ClientPayloadConnectReason=t.ClientPayloadConnectType=t.DNSSourceDNSResolutionMethod=t.ClientPayloadProduct=void 0;var a=r(99454),i=r(28103)({WHATSAPP:0,MESSENGER:1});t.ClientPayloadProduct=i;var n=r(28103)({SYSTEM:0,GOOGLE:1,HARDCODED:2,OVERRIDE:3,FALLBACK:4});t.DNSSourceDNSResolutionMethod=n;var s=r(28103)({CELLULAR_UNKNOWN:0,WIFI_UNKNOWN:1,CELLULAR_EDGE:100,CELLULAR_IDEN:101,CELLULAR_UMTS:102,CELLULAR_EVDO:103,CELLULAR_GPRS:104,CELLULAR_HSDPA:105,CELLULAR_HSUPA:106,CELLULAR_HSPA:107,CELLULAR_CDMA:108,CELLULAR_1XRTT:109,CELLULAR_EHRPD:110,CELLULAR_LTE:111,CELLULAR_HSPAP:112});t.ClientPayloadConnectType=s;var o=r(28103)({PUSH:0,USER_ACTIVATED:1,SCHEDULED:2,ERROR_RECONNECT:3,NETWORK_SWITCH:4,PING_RECONNECT:5});t.ClientPayloadConnectReason=o;var l=r(28103)({SHARE_EXTENSION:0,SERVICE_EXTENSION:1,INTENTS_EXTENSION:2});t.ClientPayloadIOSAppExtension=l;var d=r(28103)({WEB_BROWSER:0,APP_STORE:1,WIN_STORE:2,DARWIN:3,WIN32:4});t.WebInfoWebSubPlatform=d;var u=r(28103)({RELEASE:0,BETA:1,ALPHA:2,DEBUG:3});t.UserAgentReleaseChannel=u;var c=r(28103)({ANDROID:0,IOS:1,WINDOWS_PHONE:2,BLACKBERRY:3,BLACKBERRYX:4,S40:5,S60:6,PYTHON_CLIENT:7,TIZEN:8,ENTERPRISE:9,SMB_ANDROID:10,KAIOS:11,SMB_IOS:12,WINDOWS:13,WEB:14,PORTAL:15,GREEN_ANDROID:16,GREEN_IPHONE:17,BLUE_ANDROID:18,BLUE_IPHONE:19,FBLITE_ANDROID:20,MLITE_ANDROID:21,IGLITE_ANDROID:22,PAGE:23,MACOS:24,VR:25});t.UserAgentPlatform=c;var p=r(28103)({NONE:0});t.ClientPayloadClientFeature=p;var h={};t.HandshakeMessageSpec=h;var f={};t.ClientFinishSpec=f;var _={};t.ServerHelloSpec=_;var m={};t.ClientHelloSpec=m;var g={};t.NoiseCertificateSpec=g;var v={};t.DetailsSpec=v;var E={};t.ClientPayloadSpec=E;var y={};t.CompanionRegDataSpec=y;var S={};t.DNSSourceSpec=S;var T={};t.WebInfoSpec=T;var A={};t.WebdPayloadSpec=A;var b={};t.UserAgentSpec=b;var C={};t.AppVersionSpec=C,h.internalSpec={clientHello:[2,a.TYPES.MESSAGE,m],serverHello:[3,a.TYPES.MESSAGE,_],clientFinish:[4,a.TYPES.MESSAGE,f]},f.internalSpec={static:[1,a.TYPES.BYTES],payload:[2,a.TYPES.BYTES]},_.internalSpec={ephemeral:[1,a.TYPES.BYTES],static:[2,a.TYPES.BYTES],payload:[3,a.TYPES.BYTES]},m.internalSpec={ephemeral:[1,a.TYPES.BYTES],static:[2,a.TYPES.BYTES],payload:[3,a.TYPES.BYTES]},g.internalSpec={details:[1,a.TYPES.BYTES],signature:[2,a.TYPES.BYTES]},v.internalSpec={serial:[1,a.TYPES.UINT32],issuer:[2,a.TYPES.STRING],expires:[3,a.TYPES.UINT64],subject:[4,a.TYPES.STRING],key:[5,a.TYPES.BYTES]},E.internalSpec={username:[1,a.TYPES.UINT64],passive:[3,a.TYPES.BOOL],clientFeatures:[4,a.FLAGS.REPEATED|a.TYPES.ENUM,p],userAgent:[5,a.TYPES.MESSAGE,b],webInfo:[6,a.TYPES.MESSAGE,T],pushName:[7,a.TYPES.STRING],sessionId:[9,a.TYPES.SFIXED32],shortConnect:[10,a.TYPES.BOOL],iosAppExtension:[30,a.TYPES.ENUM,l],connectType:[12,a.TYPES.ENUM,s],connectReason:[13,a.TYPES.ENUM,o],shards:[14,a.FLAGS.REPEATED|a.TYPES.INT32],dnsSource:[15,a.TYPES.MESSAGE,S],connectAttemptCount:[16,a.TYPES.UINT32],agent:[17,a.TYPES.UINT32],device:[18,a.TYPES.UINT32],regData:[19,a.TYPES.MESSAGE,y],product:[20,a.TYPES.ENUM,i],fbCat:[21,a.TYPES.BYTES],fbUserAgent:[22,a.TYPES.BYTES],oc:[23,a.TYPES.BOOL]},y.internalSpec={eRegid:[1,a.TYPES.BYTES],eKeytype:[2,a.TYPES.BYTES],eIdent:[3,a.TYPES.BYTES],eSkeyId:[4,a.TYPES.BYTES],eSkeyVal:[5,a.TYPES.BYTES],eSkeySig:[6,a.TYPES.BYTES],buildHash:[7,a.TYPES.BYTES],companionProps:[8,a.TYPES.BYTES]},S.internalSpec={dnsMethod:[15,a.TYPES.ENUM,n],appCached:[16,a.TYPES.BOOL]},T.internalSpec={refToken:[1,a.TYPES.STRING],version:[2,a.TYPES.STRING],webdPayload:[3,a.TYPES.MESSAGE,A],webSubPlatform:[4,a.TYPES.ENUM,d]},A.internalSpec={usesParticipantInKey:[1,a.TYPES.BOOL],supportsStarredMessages:[2,a.TYPES.BOOL],supportsDocumentMessages:[3,a.TYPES.BOOL],supportsUrlMessages:[4,a.TYPES.BOOL],supportsMediaRetry:[5,a.TYPES.BOOL],supportsE2EImage:[6,a.TYPES.BOOL],supportsE2EVideo:[7,a.TYPES.BOOL],supportsE2EAudio:[8,a.TYPES.BOOL],supportsE2EDocument:[9,a.TYPES.BOOL],documentTypes:[10,a.TYPES.STRING],features:[11,a.TYPES.BYTES]},b.internalSpec={platform:[1,a.TYPES.ENUM,c],appVersion:[2,a.TYPES.MESSAGE,C],mcc:[3,a.TYPES.STRING],mnc:[4,a.TYPES.STRING],osVersion:[5,a.TYPES.STRING],manufacturer:[6,a.TYPES.STRING],device:[7,a.TYPES.STRING],osBuildNumber:[8,a.TYPES.STRING],phoneId:[9,a.TYPES.STRING],releaseChannel:[10,a.TYPES.ENUM,u],localeLanguageIso6391:[11,a.TYPES.STRING],localeCountryIso31661Alpha2:[12,a.TYPES.STRING],deviceBoard:[13,a.TYPES.STRING]},C.internalSpec={primary:[1,a.TYPES.UINT32],secondary:[2,a.TYPES.UINT32],tertiary:[3,a.TYPES.UINT32],quaternary:[4,a.TYPES.UINT32],quinary:[5,a.TYPES.UINT32]}},94781:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PhotoChangeSpec=t.MediaDataSpec=t.WebFeaturesSpec=t.NotificationMessageInfoSpec=t.WebNotificationsInfoSpec=t.PaymentInfoSpec=t.WebMessageInfoSpec=t.WebFeaturesFlag=t.PaymentInfoCurrency=t.PaymentInfoStatus=t.PaymentInfoTxnStatus=t.WebMessageInfoStatus=t.WebMessageInfoStubType=t.WebMessageInfoBizPrivacyStatus=void 0;var a=r(99429),i=r(3257),n=r(99454),s=r(28103)({E2EE:0,FB:2,BSP:1,BSP_AND_FB:3});t.WebMessageInfoBizPrivacyStatus=s;var o=r(28103)({UNKNOWN:0,REVOKE:1,CIPHERTEXT:2,FUTUREPROOF:3,NON_VERIFIED_TRANSITION:4,UNVERIFIED_TRANSITION:5,VERIFIED_TRANSITION:6,VERIFIED_LOW_UNKNOWN:7,VERIFIED_HIGH:8,VERIFIED_INITIAL_UNKNOWN:9,VERIFIED_INITIAL_LOW:10,VERIFIED_INITIAL_HIGH:11,VERIFIED_TRANSITION_ANY_TO_NONE:12,VERIFIED_TRANSITION_ANY_TO_HIGH:13,VERIFIED_TRANSITION_HIGH_TO_LOW:14,VERIFIED_TRANSITION_HIGH_TO_UNKNOWN:15,VERIFIED_TRANSITION_UNKNOWN_TO_LOW:16,VERIFIED_TRANSITION_LOW_TO_UNKNOWN:17,VERIFIED_TRANSITION_NONE_TO_LOW:18,VERIFIED_TRANSITION_NONE_TO_UNKNOWN:19,GROUP_CREATE:20,GROUP_CHANGE_SUBJECT:21,GROUP_CHANGE_ICON:22,GROUP_CHANGE_INVITE_LINK:23,GROUP_CHANGE_DESCRIPTION:24,GROUP_CHANGE_RESTRICT:25,GROUP_CHANGE_ANNOUNCE:26,GROUP_PARTICIPANT_ADD:27,GROUP_PARTICIPANT_REMOVE:28,GROUP_PARTICIPANT_PROMOTE:29,GROUP_PARTICIPANT_DEMOTE:30,GROUP_PARTICIPANT_INVITE:31,GROUP_PARTICIPANT_LEAVE:32,GROUP_PARTICIPANT_CHANGE_NUMBER:33,BROADCAST_CREATE:34,BROADCAST_ADD:35,BROADCAST_REMOVE:36,GENERIC_NOTIFICATION:37,E2E_IDENTITY_CHANGED:38,E2E_ENCRYPTED:39,CALL_MISSED_VOICE:40,CALL_MISSED_VIDEO:41,INDIVIDUAL_CHANGE_NUMBER:42,GROUP_DELETE:43,GROUP_ANNOUNCE_MODE_MESSAGE_BOUNCE:44,CALL_MISSED_GROUP_VOICE:45,CALL_MISSED_GROUP_VIDEO:46,PAYMENT_CIPHERTEXT:47,PAYMENT_FUTUREPROOF:48,PAYMENT_TRANSACTION_STATUS_UPDATE_FAILED:49,PAYMENT_TRANSACTION_STATUS_UPDATE_REFUNDED:50,PAYMENT_TRANSACTION_STATUS_UPDATE_REFUND_FAILED:51,PAYMENT_TRANSACTION_STATUS_RECEIVER_PENDING_SETUP:52,PAYMENT_TRANSACTION_STATUS_RECEIVER_SUCCESS_AFTER_HICCUP:53,PAYMENT_ACTION_ACCOUNT_SETUP_REMINDER:54,PAYMENT_ACTION_SEND_PAYMENT_REMINDER:55,PAYMENT_ACTION_SEND_PAYMENT_INVITATION:56,PAYMENT_ACTION_REQUEST_DECLINED:57,PAYMENT_ACTION_REQUEST_EXPIRED:58,PAYMENT_ACTION_REQUEST_CANCELLED:59,BIZ_VERIFIED_TRANSITION_TOP_TO_BOTTOM:60,BIZ_VERIFIED_TRANSITION_BOTTOM_TO_TOP:61,BIZ_INTRO_TOP:62,BIZ_INTRO_BOTTOM:63,BIZ_NAME_CHANGE:64,BIZ_MOVE_TO_CONSUMER_APP:65,BIZ_TWO_TIER_MIGRATION_TOP:66,BIZ_TWO_TIER_MIGRATION_BOTTOM:67,OVERSIZED:68,GROUP_CHANGE_NO_FREQUENTLY_FORWARDED:69,GROUP_V4_ADD_INVITE_SENT:70,GROUP_PARTICIPANT_ADD_REQUEST_JOIN:71,CHANGE_EPHEMERAL_SETTING:72,E2E_DEVICE_CHANGED:73,VIEWED_ONCE:74,E2E_ENCRYPTED_NOW:75,BLUE_MSG_BSP_FB_TO_BSP_PREMISE:76,BLUE_MSG_BSP_FB_TO_SELF_FB:77,BLUE_MSG_BSP_FB_TO_SELF_PREMISE:78,BLUE_MSG_BSP_FB_UNVERIFIED:79,BLUE_MSG_BSP_FB_UNVERIFIED_TO_SELF_PREMISE_VERIFIED:80,BLUE_MSG_BSP_FB_VERIFIED:81,BLUE_MSG_BSP_FB_VERIFIED_TO_SELF_PREMISE_UNVERIFIED:82,BLUE_MSG_BSP_PREMISE_TO_SELF_PREMISE:83,BLUE_MSG_BSP_PREMISE_UNVERIFIED:84,BLUE_MSG_BSP_PREMISE_UNVERIFIED_TO_SELF_PREMISE_VERIFIED:85,BLUE_MSG_BSP_PREMISE_VERIFIED:86,BLUE_MSG_BSP_PREMISE_VERIFIED_TO_SELF_PREMISE_UNVERIFIED:87,BLUE_MSG_CONSUMER_TO_BSP_FB_UNVERIFIED:88,BLUE_MSG_CONSUMER_TO_BSP_PREMISE_UNVERIFIED:89,BLUE_MSG_CONSUMER_TO_SELF_FB_UNVERIFIED:90,BLUE_MSG_CONSUMER_TO_SELF_PREMISE_UNVERIFIED:91,BLUE_MSG_SELF_FB_TO_BSP_PREMISE:92,BLUE_MSG_SELF_FB_TO_SELF_PREMISE:93,BLUE_MSG_SELF_FB_UNVERIFIED:94,BLUE_MSG_SELF_FB_UNVERIFIED_TO_SELF_PREMISE_VERIFIED:95,BLUE_MSG_SELF_FB_VERIFIED:96,BLUE_MSG_SELF_FB_VERIFIED_TO_SELF_PREMISE_UNVERIFIED:97,BLUE_MSG_SELF_PREMISE_TO_BSP_PREMISE:98,BLUE_MSG_SELF_PREMISE_UNVERIFIED:99,BLUE_MSG_SELF_PREMISE_VERIFIED:100,BLUE_MSG_TO_BSP_FB:101,BLUE_MSG_TO_CONSUMER:102,BLUE_MSG_TO_SELF_FB:103,BLUE_MSG_UNVERIFIED_TO_BSP_FB_VERIFIED:104,BLUE_MSG_UNVERIFIED_TO_BSP_PREMISE_VERIFIED:105,BLUE_MSG_UNVERIFIED_TO_SELF_FB_VERIFIED:106,BLUE_MSG_UNVERIFIED_TO_VERIFIED:107,BLUE_MSG_VERIFIED_TO_BSP_FB_UNVERIFIED:108,BLUE_MSG_VERIFIED_TO_BSP_PREMISE_UNVERIFIED:109,BLUE_MSG_VERIFIED_TO_SELF_FB_UNVERIFIED:110,BLUE_MSG_VERIFIED_TO_UNVERIFIED:111,BLUE_MSG_BSP_FB_UNVERIFIED_TO_BSP_PREMISE_VERIFIED:112,BLUE_MSG_BSP_FB_UNVERIFIED_TO_SELF_FB_VERIFIED:113,BLUE_MSG_BSP_FB_VERIFIED_TO_BSP_PREMISE_UNVERIFIED:114,BLUE_MSG_BSP_FB_VERIFIED_TO_SELF_FB_UNVERIFIED:115,BLUE_MSG_SELF_FB_UNVERIFIED_TO_BSP_PREMISE_VERIFIED:116,BLUE_MSG_SELF_FB_VERIFIED_TO_BSP_PREMISE_UNVERIFIED:117,E2E_IDENTITY_UNAVAILABLE:118,GROUP_CREATING:119,GROUP_CREATE_FAILED:120,GROUP_BOUNCED:121,BLOCK_CONTACT:122,EPHEMERAL_SETTING_NOT_APPLIED:123,SYNC_FAILED:124,SYNCING:125,BIZ_PRIVACY_MODE_INIT_FB:126,BIZ_PRIVACY_MODE_INIT_BSP:127,BIZ_PRIVACY_MODE_TO_FB:128,BIZ_PRIVACY_MODE_TO_BSP:129});t.WebMessageInfoStubType=o;var l=r(28103)({ERROR:0,PENDING:1,SERVER_ACK:2,DELIVERY_ACK:3,READ:4,PLAYED:5});t.WebMessageInfoStatus=l;var d=r(28103)({UNKNOWN:0,PENDING_SETUP:1,PENDING_RECEIVER_SETUP:2,INIT:3,SUCCESS:4,COMPLETED:5,FAILED:6,FAILED_RISK:7,FAILED_PROCESSING:8,FAILED_RECEIVER_PROCESSING:9,FAILED_DA:10,FAILED_DA_FINAL:11,REFUNDED_TXN:12,REFUND_FAILED:13,REFUND_FAILED_PROCESSING:14,REFUND_FAILED_DA:15,EXPIRED_TXN:16,AUTH_CANCELED:17,AUTH_CANCEL_FAILED_PROCESSING:18,AUTH_CANCEL_FAILED:19,COLLECT_INIT:20,COLLECT_SUCCESS:21,COLLECT_FAILED:22,COLLECT_FAILED_RISK:23,COLLECT_REJECTED:24,COLLECT_EXPIRED:25,COLLECT_CANCELED:26,COLLECT_CANCELLING:27,IN_REVIEW:28});t.PaymentInfoTxnStatus=d;var u=r(28103)({UNKNOWN_STATUS:0,PROCESSING:1,SENT:2,NEED_TO_ACCEPT:3,COMPLETE:4,COULD_NOT_COMPLETE:5,REFUNDED:6,EXPIRED:7,REJECTED:8,CANCELLED:9,WAITING_FOR_PAYER:10,WAITING:11});t.PaymentInfoStatus=u;var c=r(28103)({UNKNOWN_CURRENCY:0,INR:1});t.PaymentInfoCurrency=c;var p=r(28103)({NOT_STARTED:0,FORCE_UPGRADE:1,DEVELOPMENT:2,PRODUCTION:3});t.WebFeaturesFlag=p;var h={};t.WebMessageInfoSpec=h;var f={};t.PaymentInfoSpec=f;var _={};t.WebNotificationsInfoSpec=_;var m={};t.NotificationMessageInfoSpec=m;var g={};t.WebFeaturesSpec=g;var v={};t.MediaDataSpec=v;var E={};t.PhotoChangeSpec=E,h.internalDefaults={status:l.PENDING},h.internalSpec={key:[1,n.FLAGS.REQUIRED|n.TYPES.MESSAGE,i.MessageKeySpec],message:[2,n.TYPES.MESSAGE,a.MessageSpec],messageTimestamp:[3,n.TYPES.UINT64],status:[4,n.TYPES.ENUM,l],participant:[5,n.TYPES.STRING],messageC2STimestamp:[6,n.TYPES.UINT64],ignore:[16,n.TYPES.BOOL],starred:[17,n.TYPES.BOOL],broadcast:[18,n.TYPES.BOOL],pushName:[19,n.TYPES.STRING],mediaCiphertextSha256:[20,n.TYPES.BYTES],multicast:[21,n.TYPES.BOOL],urlText:[22,n.TYPES.BOOL],urlNumber:[23,n.TYPES.BOOL],messageStubType:[24,n.TYPES.ENUM,o],clearMedia:[25,n.TYPES.BOOL],messageStubParameters:[26,n.FLAGS.REPEATED|n.TYPES.STRING],duration:[27,n.TYPES.UINT32],labels:[28,n.FLAGS.REPEATED|n.TYPES.STRING],paymentInfo:[29,n.TYPES.MESSAGE,f],finalLiveLocation:[30,n.TYPES.MESSAGE,a.LiveLocationMessageSpec],quotedPaymentInfo:[31,n.TYPES.MESSAGE,f],ephemeralStartTimestamp:[32,n.TYPES.UINT64],ephemeralDuration:[33,n.TYPES.UINT32],ephemeralOffToOn:[34,n.TYPES.BOOL],ephemeralOutOfSync:[35,n.TYPES.BOOL],bizPrivacyStatus:[36,n.TYPES.ENUM,s],verifiedBizName:[37,n.TYPES.STRING],mediaData:[38,n.TYPES.MESSAGE,v],photoChange:[39,n.TYPES.MESSAGE,E]},f.internalSpec={currencyDeprecated:[1,n.TYPES.ENUM,c],amount1000:[2,n.TYPES.UINT64],receiverJid:[3,n.TYPES.STRING],status:[4,n.TYPES.ENUM,u],transactionTimestamp:[5,n.TYPES.UINT64],requestMessageKey:[6,n.TYPES.MESSAGE,i.MessageKeySpec],expiryTimestamp:[7,n.TYPES.UINT64],futureproofed:[8,n.TYPES.BOOL],currency:[9,n.TYPES.STRING],txnStatus:[10,n.TYPES.ENUM,d],useNoviFiatFormat:[11,n.TYPES.BOOL],primaryAmount:[12,n.TYPES.MESSAGE,a.MoneySpec],exchangeAmount:[13,n.TYPES.MESSAGE,a.MoneySpec]},_.internalSpec={timestamp:[2,n.TYPES.UINT64],unreadChats:[3,n.TYPES.UINT32],notifyMessageCount:[4,n.TYPES.UINT32],notifyMessages:[5,n.FLAGS.REPEATED|n.TYPES.MESSAGE,h]},m.internalSpec={key:[1,n.TYPES.MESSAGE,i.MessageKeySpec],message:[2,n.TYPES.MESSAGE,a.MessageSpec],messageTimestamp:[3,n.TYPES.UINT64],participant:[4,n.TYPES.STRING]},g.internalSpec={labelsDisplay:[1,n.TYPES.ENUM,p],voipIndividualOutgoing:[2,n.TYPES.ENUM,p],groupsV3:[3,n.TYPES.ENUM,p],groupsV3Create:[4,n.TYPES.ENUM,p],changeNumberV2:[5,n.TYPES.ENUM,p],queryStatusV3Thumbnail:[6,n.TYPES.ENUM,p],liveLocations:[7,n.TYPES.ENUM,p],queryVname:[8,n.TYPES.ENUM,p],voipIndividualIncoming:[9,n.TYPES.ENUM,p],quickRepliesQuery:[10,n.TYPES.ENUM,p],payments:[11,n.TYPES.ENUM,p],stickerPackQuery:[12,n.TYPES.ENUM,p],liveLocationsFinal:[13,n.TYPES.ENUM,p],labelsEdit:[14,n.TYPES.ENUM,p],mediaUpload:[15,n.TYPES.ENUM,p],mediaUploadRichQuickReplies:[18,n.TYPES.ENUM,p],vnameV2:[19,n.TYPES.ENUM,p],videoPlaybackUrl:[20,n.TYPES.ENUM,p],statusRanking:[21,n.TYPES.ENUM,p],voipIndividualVideo:[22,n.TYPES.ENUM,p],thirdPartyStickers:[23,n.TYPES.ENUM,p],frequentlyForwardedSetting:[24,n.TYPES.ENUM,p],groupsV4JoinPermission:[25,n.TYPES.ENUM,p],recentStickers:[26,n.TYPES.ENUM,p],catalog:[27,n.TYPES.ENUM,p],starredStickers:[28,n.TYPES.ENUM,p],voipGroupCall:[29,n.TYPES.ENUM,p],templateMessage:[30,n.TYPES.ENUM,p],templateMessageInteractivity:[31,n.TYPES.ENUM,p],ephemeralMessages:[32,n.TYPES.ENUM,p],e2ENotificationSync:[33,n.TYPES.ENUM,p],recentStickersV2:[34,n.TYPES.ENUM,p],recentStickersV3:[36,n.TYPES.ENUM,p],userNotice:[37,n.TYPES.ENUM,p],support:[39,n.TYPES.ENUM,p],groupUiiCleanup:[40,n.TYPES.ENUM,p],groupDogfoodingInternalOnly:[41,n.TYPES.ENUM,p],settingsSync:[42,n.TYPES.ENUM,p],archiveV2:[43,n.TYPES.ENUM,p],ephemeralAllowGroupMembers:[44,n.TYPES.ENUM,p],ephemeral24HDuration:[45,n.TYPES.ENUM,p],mdForceUpgrade:[46,n.TYPES.ENUM,p]},v.internalSpec={localPath:[1,n.TYPES.STRING]},E.internalSpec={oldPhoto:[1,n.TYPES.BYTES],newPhoto:[2,n.TYPES.BYTES],newPhotoId:[3,n.TYPES.UINT32]}},66239:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.setMe=function(e){var t=r(20468).default;t.supportsFeature(t.F.MD_BACKEND)?_._set(c.default.KEY_LAST_WID_MD,e):_._set(c.default.KEY_LAST_WID,e)},t.getMe=A,t.assertGetMe=b,t.assertGetMeUser=function(){return(0,f.default)(C(),"meUser")},t.getMeUser=C,t.getMaybeMeUser=function(){var e=A();return e?(0,v.toUserWid)(e):void 0},t.setPushname=function(e){_._setUser(c.default.KEY_LAST_PUSHNAME,e)},t.getPushname=function(){return _._getUser(c.default.KEY_LAST_PUSHNAME)},t.getLoginTokens=P,t.setLoginTokens=function(e){var t=e.client,r=e.server;t&&r&&!(0,l.default)(t)&&(__LOG__(2)`UserPrefs:setLoginTokens`,_._set(c.default.KEY_CLIENT_TOKEN,t),_._set(c.default.KEY_SERVER_TOKEN,r))},t.knowsPhone=function(){var e=P();return!(!e.client||!e.server)},t.setRefTok=function(e,t){O(),_.setRefTokCookies(e,t)},t.clearDeprecatedKeys=O,t.mdOptedIn=function(){return _._get(c.default.KEY_MD_OPTED_IN,p.default.permanentStorage)},t.setMdOptedIn=function(e){_._set(c.default.KEY_MD_OPTED_IN,e,p.default.permanentStorage)},t.getSecretBundle=function(){var e=_._get(c.default.KEY_SECRET_BUNDLE);if(!e)return __LOG__(3)`UserPrefs:Attempted to load non-existent secret bundle!`,null;"string"==typeof e&&(e=JSON.parse(e));return(0,o.default)(e,d.decodeB64)},t.setSecretBundle=function(e){return _._set(c.default.KEY_SECRET_BUNDLE,(0,o.default)(e,d.encodeB64))},t.clearTokens=function(){E.forEach((e=>{_._set(e,void 0)}))},t.shouldShowNUX=function(e){var t=w(e);return!t||t.views<t.maxViews},t.viewNUX=function(e){var t=w(e);if(!t)throw new Error("UserPrefs:viewNUX key "+e+" does not exist");M(e,{views:t.views+1,maxViews:t.maxViews})},t.getNUX=w,t.setNUX=M,t.removeNUX=function(e){_._setUser(e)},t.getUnknownId=function(){var e=_._get(c.default.KEY_UNKNOWN_ID);e||I(e="unknown"+Math.floor(1e10*Math.random()));return e},t.setUnknownId=I,t.getBrowserId=function(){return _._get(c.default.KEY_BROWSER_ID)},t.setBrowserId=function(e){_._set(c.default.KEY_BROWSER_ID,e)},t.getLastMobilePlatform=function(){return _._get(c.default.KEY_MOBILE_PLATFORM)},t.setLastMobilePlatform=function(e){_._set(c.default.KEY_MOBILE_PLATFORM,e)},t.setLastChatMuteDuration=function(e){_._setUser(c.default.KEY_LAST_CHAT_MUTE_DURATION,e)},t.getLastChatMuteDuration=function(){return _._getUser(c.default.KEY_LAST_CHAT_MUTE_DURATION)},t.setTheme=function(e){_._set(c.default.KEY_THEME,e)},t.getTheme=function(){return _._get(c.default.KEY_THEME)},t.setSystemThemeMode=function(e){_._set(c.default.KEY_SYSTEM_THEME_MODE,e)},t.getSystemThemeMode=function(){return _._get(c.default.KEY_SYSTEM_THEME_MODE)},t.setLastComposeBoxPanel=function(e){_._setUser(c.default.KEY_LAST_SELECTED_COMPOSE_BOX_PANEL,e)},t.getLastComposeBoxPanel=function(){return _._getUser(c.default.KEY_LAST_SELECTED_COMPOSE_BOX_PANEL)},t.setSeenGroupDesc=function(e){_._setUser(e.toString(),!0)},t.getSeenGroupDesc=function(e){return _._getUser(e.toString())},t.getGlobalSounds=function(){return!_._getUser(c.default.KEY_GLOBAL_MUTE_SOUNDS)},t.setGlobalSounds=function(e){_._setUser(c.default.KEY_GLOBAL_MUTE_SOUNDS,!e)},t.getGlobalNotifications=function(){return!_._getUser(c.default.KEY_GLOBAL_MUTE_NOTIFICATIONS)},t.setGlobalNotifications=function(e){_._setUser(c.default.KEY_GLOBAL_MUTE_NOTIFICATIONS,!e)},t.getGlobalSecurityNotifications=function(){return!_._getUser(c.default.KEY_SECURITY_NOTIFICATIONS)},t.setGlobalSecurityNotifications=function(e){_._setUser(c.default.KEY_SECURITY_NOTIFICATIONS,!e)},t.getUserPrivacySettings=function(){return _._getUser(c.default.KEY_USER_PRIVACY_SETTINGS)},t.setUserPrivacySettings=function(e){_._setUser(c.default.KEY_USER_PRIVACY_SETTINGS,e)},t.getGlobalPreviews=function(){return!_._getUser(c.default.KEY_GLOBAL_MUTE_PREVIEWS)},t.setGlobalPreviews=function(e){_._setUser(c.default.KEY_GLOBAL_MUTE_PREVIEWS,!e)},t.getCollapseMuted=function(){return _._getUser(c.default.KEY_GLOBAL_COLLAPSE_MUTED)},t.setCollapseMuted=function(e){_._setUser(c.default.KEY_GLOBAL_COLLAPSE_MUTED,e)},t.getGeocoderLocation=function(){return _._getUser(c.default.KEY_GEOCODER_LOCATION)},t.setGeocoderLocation=function(e){_._setUser(c.default.KEY_GEOCODER_LOCATION,e)},t.getMapsOverQuota=function(){return _._get(c.default.KEY_GMAPS_OVER_LIMIT)},t.setMapsOverQuota=function(e){_._set(c.default.KEY_GMAPS_OVER_LIMIT,e)},t.setSmbLabelPalette=function(e){_._set(c.default.KEY_SMB_LABEL_COLOR_PALETTE,e)},t.getSmbLabelPalette=function(){return _._getUser(c.default.KEY_SMB_LABEL_COLOR_PALETTE)},t.getGroupParticipantAssignedColor=function(e){return _._getUser(c.default.KEY_GROUP_ASSIGNED_COLOR+"-"+e.toString())},t.setGroupParticipantAssignedColor=function(e,t){_._setUser(c.default.KEY_GROUP_ASSIGNED_COLOR+"-"+e.toString(),t)},t.getMutex=function(){return _._getPSIgnoringCache(c.default.KEY_WHATSAPP_MUTEX)},t.setMutex=function(e){var t=e?S+":"+e:e;_._setPS(c.default.KEY_WHATSAPP_MUTEX,t)},t.removeMutex=function(){_._setPS(c.default.KEY_WHATSAPP_MUTEX)},t.parseMutex=function(e){var t=e?JSON.parse(e):"";return t?t.toString().split(/:/).pop():t},t.mutexFilter=function(e){if(e.key!==c.default.KEY_WHATSAPP_MUTEX)return!1;return!(e.newValue||"").includes(S)},t.localTakeoverSuccess=function(){var e=_.getRememberMe()?{}:(0,s.default)(_._getAllKeyValues(),m.LS_ONLY_KEYS);e.wa_tab_src=S,(0,f.default)(h.default,"localStorage").setItem(c.default.KEY_LOCAL_TAKEOVER_OK,JSON.stringify(e)),(0,f.default)(h.default,"localStorage").removeItem(c.default.KEY_LOCAL_TAKEOVER_OK)},t.parseTakeover=function(e){var t=e?JSON.parse(e):{};return(0,n.default)(t)?(delete t.wa_tab_src,t):{}},t.takeoverFilter=function(e){if(e.key!==c.default.KEY_LOCAL_TAKEOVER_OK)return!1;return!(e.newValue||"").includes(S)},t.getLangPref=function(){return _._get(c.default.KEY_LANG)},t.setLangPref=function(e){_._set(c.default.KEY_LANG,e)},t.getLogoutToken=function(){return _._getPS(c.default.KEY_LOGOUT_TOKEN)},t.setLogoutToken=function(e){_._setPS(c.default.KEY_LOGOUT_TOKEN,e)},t.getOldLogoutCreds=function(){return _._getPS(c.default.KEY_OLD_LOGOUT_CREDS)||[]},t.setOldLogoutCreds=function(e){_._setPS(c.default.KEY_OLD_LOGOUT_CREDS,e)},t.setNoTakeover=function(e){_._setTS(c.default.KEY_NO_TAKEOVER,e)},t.getNoTakeover=function(){return _._getTS(c.default.KEY_NO_TAKEOVER)},t.getWamBuffer=function(){return _._get(c.default.KEY_WAM_BUFFER,void 0,!0)},t.setWamBuffer=function(e){_._set(c.default.KEY_WAM_BUFFER,e,void 0,!0)},t.getWamInfo=function(){return _._get(c.default.KEY_WAM_INFO)},t.setWamInfo=function(e){_._set(c.default.KEY_WAM_INFO,e)},t.setVideoVolumeSettings=function(e,t){R(e),D(t)},t.setVideoVolumeSetting=R,t.setVideoMutedSetting=D,t.getVideoVolumeSettings=function(){return{volume:_._get(c.default.KEY_VIDEO_VOLUME),muted:!!_._get(c.default.KEY_VIDEO_MUTE)}},t.setComposeContents=function(e,t){_._setUserSession(N(e),t)},t.getComposeContents=function(e){return _._getUserSession(N(e))},t.deleteComposeContents=function(e){_._clearUserSessionItem(N(e))},t.setVersion=function(e){null!=e&&_._set(c.default.KEY_PROTO_VERSION,e)},t.getVersion=function(){return _._get(c.default.KEY_PROTO_VERSION)},t.setContactChecksum=function(e){_._setUser(c.default.KEY_CONTACT_CHECKSUM,e)},t.getContactChecksum=function(){return _._getUser(c.default.KEY_CONTACT_CHECKSUM)},t.getNoticeBannerClosedAt=function(){return _._getUser(c.default.KEY_NOTICE_BANNER_CLOSED_AT)},t.setNoticeBannerClosedAt=function(e){_._setUser(c.default.KEY_NOTICE_BANNER_CLOSED_AT,e)},t.getNoticeId=function(){return _._getUser(c.default.KEY_NOTICE_ID)},t.setNoticeId=function(e){_._setUser(c.default.KEY_NOTICE_ID,e)},t.getPttPlaybackRate=function(){var e;return null!==(e=_._get(c.default.KEY_PTT_PLAYBACK_RATE))&&void 0!==e?e:1},t.setPttPlaybackRate=function(e){_._set(c.default.KEY_PTT_PLAYBACK_RATE,e)},t.getLastStatusUsage=function(){return _._getUser(c.default.LAST_STATUS_USAGE)},t.setLastStatusUsage=function(){_._setUser(c.default.LAST_STATUS_USAGE,Date.now())},t.getOutgoingMessageSound=function(){return _._getUser(c.default.KEY_OUTGOING_MESSAGE_SOUND)},t.setOutgoingMessageSound=function(e){_._setUser(c.default.KEY_OUTGOING_MESSAGE_SOUND,e)},t.getHistorySyncEarliestDate=function(){var e=_._get(c.default.KEY_HISTORY_SYNC_EARLIEST_DATE);if(!e)return L((0,u.unixTime)());return e},t.setHistorySyncEarliestDate=L,t.setShouldPreemptivelyCleanupLogs=function(e){_._set(c.default.KEY_LOG_PREEMPT_CLEAN_UP,e)},t.getShouldPreemptivelyCleanupLogs=function(){return!1!==_._get(c.default.KEY_LOG_PREEMPT_CLEAN_UP)},Object.defineProperty(t,"getRememberMe",{enumerable:!0,get:function(){return _.getRememberMe}}),Object.defineProperty(t,"setRememberMe",{enumerable:!0,get:function(){return _.setRememberMe}}),Object.defineProperty(t,"clearAllLocalState",{enumerable:!0,get:function(){return _.clearAllLocalState}}),Object.defineProperty(t,"clearAllTemporaryStorageData",{enumerable:!0,get:function(){return _.clearAllTemporaryStorageData}}),Object.defineProperty(t,"_setAllKeyValues",{enumerable:!0,get:function(){return _._setAllKeyValues}}),Object.defineProperty(t,"getCollection",{enumerable:!0,get:function(){return _.getCollection}}),Object.defineProperty(t,"setCollection",{enumerable:!0,get:function(){return _.setCollection}}),t.thisTabId=void 0;var n=i(r(29259)),s=i(r(17620)),o=i(r(34519)),l=i(r(84336)),d=r(84337),u=r(95334),c=i(r(23045)),p=i(r(78086)),h=i(r(48879)),f=i(r(21830)),_=a(r(73656)),m=r(72293),g=i(r(43926)),v=r(25054),E=[c.default.KEY_LOGOUT_TOKEN,c.default.KEY_CLIENT_TOKEN,c.default.KEY_SERVER_TOKEN,c.default.KEY_SECRET_BUNDLE],y=[c.default.KEY_VERSION],S="x"+Math.round(1e9*Math.random()),T=S;function A(){var e=r(20468).default,t=null;return(t=e.supportsFeature(e.F.MD_BACKEND)?_._get(c.default.KEY_LAST_WID_MD):_._get(c.default.KEY_LAST_WID))&&g.default.isWid(t)?(0,v.createWid)(t):t}function b(){return(0,f.default)(A(),"me")}function C(){return(0,v.toUserWid)(b())}function P(){return{client:_._get(c.default.KEY_CLIENT_TOKEN),server:_._get(c.default.KEY_SERVER_TOKEN)}}function O(){y.forEach((function(e){p.default.permanentStorage.removeItem(e)}))}function w(e){return _._getUser(e)}function M(e,t){_._setUser(e,t)}function I(e){return _._set(c.default.KEY_UNKNOWN_ID,e)}function R(e){_._set(c.default.KEY_VIDEO_VOLUME,e)}function D(e){_._set(c.default.KEY_VIDEO_MUTE,e)}function N(e){return`${c.default.KEY_COMPOSE_CONTENTS_PREFIX}${e.toString()}`}function L(e){var t=e-90*u.DAY_SECONDS;return _._set(c.default.KEY_HISTORY_SYNC_EARLIEST_DATE,t),t}t.thisTabId=T},13185:(e,t,r)=>{"use strict";var a=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.getContactChecksum=function(){return i._getUser(n)},t.setContactChecksum=function(e){i._setUser(n,e)},t.getFrequentContacts=function(){return i._getUser(s)},t.setFrequentContacts=function(e){i._setUser(s,e)},t.setGKFeatures=function(e){i._setUser(o,e)},t.getGKFeatures=function(){return i._getUser(o)},t.setGKProto=function(e){i._setUser(l,e)},t.getGKProto=function(){return i._getUser(l)},t.setHistoryInitialSyncBoundry=function(e){i._setUser(d,JSON.stringify(e))},t.getHistoryInitialSyncBoundry=function(){var e=i._getUser(d);try{return JSON.parse(e)}catch(e){return null}};var i=a(r(73656)),n="contact_checksum",s="frequent_contacts",o="gk_features",l="gk_proto",d="history_initial_sync_boundry"},63191:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.clearRegistrationInfo=function(){var e=[h,f,_,m,g,A];p.default.supportsFeature(p.default.F.MD_BACKEND)?e.push(l.default.KEY_LAST_WID_MD):e.push(l.default.KEY_LAST_WID);e.map((e=>{u._set(e,void 0)}))},t.setNoiseInfo=function(e){var t={recoveryToken:e.recoveryToken,pubKey:e.staticKeyPair.pubKey,privKey:e.staticKeyPair.privKey};return u._set(h,(0,s.default)(t,o.encodeB64))},t.getNoiseInfo=b,t.setRoutingInfo=function(e){var{domain:t,edgeRouting:r}=e,a={domain:t,edgeRouting:r?(0,o.encodeB64)(r):null};return u._set(m,a,d.default.permanentStorage)},t.getRoutingInfo=function(){var e=u._get(m,d.default.permanentStorage);if(e){var{domain:t,edgeRouting:r}=e;return{domain:t,edgeRouting:r?(0,o.decodeB64)(r):null}}return null},t.setMdInternVersion=function(){},t.getMdInternVersion=function(){return},t.isRegistered=function(){return!(!b()||!c.getMe())},t.setInitialHistorySyncComplete=function(){return u._set(g,"true")},t.getInitialHistorySyncComplete=function(){return!!u._get(g,d.default.permanentStorage)},t.setWebEncSalt=function(e){return u._set(A,e)},t.getWebEncSalt=function(){return u._get(A,d.default.permanentStorage)},t.setHistorySyncStatus=function(e){var t,r=null!==(t=C())&&void 0!==t?t:{};u._set(E,(0,n.default)((0,n.default)({},r),e))},t.getHistorySyncStatus=C,t.setAllCriticalDataSynced=function(){return u._set(v,!0)},t.getAllCriticalDataSynced=function(){return!!u._get(v,d.default.permanentStorage)},t.setADVSecretKey=function(e){return u._set(y,e)},t.getADVSecretKey=function(){return u._get(y)},t.setBlocklistHash=function(e){return u._set(S,e)},t.getBlocklistHash=function(){return u._get(S)},t.addDebugContact=function(){},t.getDebugContact=function(){},t.setDebugReadReceipt=function(){},t.getDebugReadReceipt=function(){},t.setDebugPassiveMode=function(){},t.getDebugPassiveMode=function(){},t.setDebugEnableOfflineMock=function(){},t.getDebugEnableOfflineMock=function(){return!1},t.setDebugStanzaFilter=function(){},t.getDebugStanzaFilter=function(){},t.setDebugDecryptFail=function(){},t.getDebugDecryptFail=function(){},t.setDebugRoutingToken=function(){},t.getDebugRoutingToken=function(){},t.setDebugShownMsgs=function(){},t.setDebugDisableHistorySyncTimeout=function(){},t.getDebugDisableHistorySyncTimeout=function(){return!1},t.getDebugShownMsgs=function(){return{}},t.setShouldCheckContactSyncStatus=function(){return u._set(T,!0)},t.getShouldCheckContactSyncStatus=function(){return!!u._get(T)};var n=i(r(70417)),s=i(r(34519)),o=r(84337),l=i(r(23045)),d=i(r(78086)),u=a(r(73656)),c=a(r(66239)),p=i(r(20468)),h=(r(23078),"WANoiseInfo"),f="WAMeInfo",_="WADeviceId",m="WARoutingInfo",g="WaInitialHistorySynced",v="critical_data_synced",E="WAHistorySyncStatus",y="WaADVSecretKey",S="WABlocklistHash",T="WAShouldCheckContactSyncStatus",A="WebEncKeySalt";function b(){var e=u._get(h);if(!e)return null;var t=(0,s.default)(e,o.decodeB64);return{recoveryToken:t.recoveryToken,staticKeyPair:{pubKey:t.pubKey,privKey:t.privKey}}}function C(){return u._get(E)}},73656:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.setRefTokCookies=function(e,t){if(void 0===self.document)return;c.setCookie({name:u.default.COOKIE_REF,value:e,path:u.default.PP_REF,domain:u.default.COOKIE_DOMAIN,secure:!0});var r={name:u.default.COOKIE_TOK,value:t,path:u.default.PP_TOK,domain:u.default.COOKIE_DOMAIN,secure:!0};c.setCookie(r)},t._getKeys=v,t._setKeys=E,t._getAllKeyValues=function(){var e=w();return(0,o.default)(Object.keys(e).map((function(t){return[t,e.getItem(t)]})))},t._setAllKeyValues=function(e){var t=w();Object.keys(e).forEach((function(r){null!=e[r]&&t.setItem(r,e[r])}))},t.clearAllLocalState=function(){return S.apply(this,arguments)},t.clearAllTemporaryStorageData=function(){p.default.temporaryStorage.clear()},t._getPS=T,t._getPSIgnoringCache=function(e){return M(e,p.default.permanentStorage,!1,!0)},t._setPS=A,t._getTS=function(e){return M(e,p.default.temporaryStorage)},t._setTS=function(e,t){I(e,t,p.default.temporaryStorage)},t._setUserSession=function(e,t){var r=C();if(!r)return void __LOG__(3)`userPrefs: Me has not loaded yet.`;I((0,_.default)(R(r.toString(),e)),t,p.default.temporaryStorage)},t._getUserSession=function(e){var t=C();if(!t)return __LOG__(3)`userPrefs: Me has not loaded yet.`,null;return M((0,_.default)(R(t.toString(),e)),p.default.temporaryStorage)},t._clearUserSessionItem=function(e){var t=C();if(!t)return void __LOG__(3)`userPrefs: Me has not loaded yet.`;var r=(0,_.default)(R(t.toString(),e));p.default.temporaryStorage.removeItem(r)},t.getRememberMe=b,t.setRememberMe=function(e){var t=!!e;if(t===b())return;__LOG__(2)`UserPrefs:setRememberMe: ${String(t)}`;var r=w();A(u.default.KEY_REMEMBER_ME,t);var a=w();if(r!==a){(0,s.default)(Object.keys(r.dataStore),m.LS_ONLY_KEYS.concat(m.LS_PRESERVE_KEYS)).forEach((function(e){var t=r.getItem(e);null!=t&&(a.setItem(e,t),r.removeItem(e))}))}t||f.default.clearLogs()},t.getCollection=function(e){return P(e)},t.setCollection=function(e,t,r=!1){null==C()||r||O(e,t)},t._getMe=C,t._getUser=P,t._setUser=O,t._storage=w,t._get=M,t._set=I;var n=i(r(52954)),s=i(r(17335)),o=i(r(10017)),l=i(r(15253)),d=i(r(46150)),u=i(r(23045)),c=a(r(91354)),p=a(r(78086)),h=i(r(54884)),f=i(r(94854)),_=i(r(75584)),m=r(72293);function g(){void 0!==self.document&&(c.setCookie({name:u.default.COOKIE_REF,expirationDate:0,domain:u.default.COOKIE_DOMAIN,path:u.default.PP_REF}),c.setCookie({name:u.default.COOKIE_TOK,expirationDate:0,domain:u.default.COOKIE_DOMAIN,path:u.default.PP_TOK}))}function v(e,t,r=!1){return(0,d.default)(t,t.map((t=>e.getItem(t,r))))}function E(e,t){(0,l.default)(t,(function(t,r){e.setItem(r,t)}))}function y(){return v(p.default.permanentStorage,m.LS_PRESERVE_KEYS,!0)}function S(){return(S=(0,n.default)((function*(){var e=y(),t=[p.default.temporaryStorage.clear(),p.default.permanentStorage.clear(e)];t.push(f.default.clearLogs()),g(),yield Promise.all(t)}))).apply(this,arguments)}function T(e){return M(e,p.default.permanentStorage)}function A(e,t){I(e,t,p.default.permanentStorage)}function b(){var e=T(u.default.KEY_REMEMBER_ME),t=r(20468).default;return t.supportsFeature(t.F.MD_BACKEND)&&!1===e&&(e=!0,A(u.default.KEY_REMEMBER_ME,!0)),null===e&&(e=!0,A(u.default.KEY_REMEMBER_ME,!0)),!!e}function C(){return r(66239).getMaybeMeUser()}function P(e){var t=C();return t?M((0,_.default)(R(t.toString(),e))):(__LOG__(3)`userPrefs: Me has not loaded yet.`,null)}function O(e,t){var r=C();r?I((0,_.default)(R(r.toString(),e)),t):__LOG__(3)`userPrefs: Me has not loaded yet.`}function w(){return b()?p.default.permanentStorage:p.default.temporaryStorage}function M(e,t=w(),a=!1,i=!1){if(null==e)throw new Error("_get called with no key");var n=t.getItem(e,i);if(a||null==n)return n;try{return JSON.parse(n,h.default)}catch(a){return __LOG__(2)`userPrefs:_get(${e}) '${a}' ${n}`,r(2537).upload({reason:"userprefs-parse-error"}),void t.removeItem(e)}}function I(e,t,r=w(),a=!1){if(null==e)throw new Error("_set called with no key");if(null==t)r.removeItem(e);else if(a){if("string"!=typeof t)throw new Error("_set: expecting string because isRawString is true");r.setItem(e,t)}else r.setItem(e,JSON.stringify(t))}function R(e,t){return[e,t].join(":")}},72293:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.LS_PRESERVE_KEYS=t.LS_ONLY_KEYS=void 0;var i=a(r(23045)),n=[i.default.KEY_LOG_CURSOR,i.default.KEY_WHATSAPP_MUTEX,i.default.KEY_REMEMBER_ME,i.default.KEY_WHATSAPP_LS_VERSION];t.LS_ONLY_KEYS=n;var s=[i.default.KEY_WHATSAPP_MUTEX,i.default.KEY_REMEMBER_ME,i.default.KEY_OLD_LOGOUT_CREDS];t.LS_PRESERVE_KEYS=s},33458:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return Promise.resolve(!1)}},51739:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.generateICELiteAnswerSDP=function(e,t,r,i,n,s,o){var l=(_=e,_.ip.join(".")),d=e.port+1,u=t,c=r,p=n,h=(0,a.encodeB64)(s),f=`v=0\no=- ${(new Date).getTime()} 2 IN IP4 127.0.0.1\ns=-\nt=0 0\na=group:BUNDLE 0${o?" 1":""}\na=ice-lite\na=msid-semantic: WMS g1noOjzcjYNgtJfnKdCzBmyvTozKsCGWCleP\nm=audio ${d} RTP/SAVP 111\nc=IN IP4 0.0.0.0\na=rtcp:9 IN IP4 ${l}\na=candidate:1152096416 1 udp 2113937151 ${l} ${d} typ host generation 0 network-cost 999\na=ice-ufrag:${u}\na=ice-pwd:${c}\na=ice-options:trickle\na=setup:active\na=mid:0\na=extmap:13 http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01\na=sendrecv\na=msid:g1noOjzcjYNgtJfnKdCzBmyvTozKsCGWCleP df375ff4-7ed5-459d-b991-76c8e47ffc52\na=rtcp-mux\na=crypto:0 AES_CM_128_HMAC_SHA1_32 inline:${h}\na=rtpmap:111 opus/48000/2\na=fmtp:111 minptime=60;maxptime=60;ptime=60;useinbandfec=1\na=fmtp:111 maxplaybackrate=16000; sprop-maxcapturerate=16000\na=rtcp-fb:111 goog-remb\na=rtcp-fb:111 transport-cc\na=ssrc:${i} cname:noAs9WOptAnM/+QP\n`;var _;o&&(f+=`m=video ${d} RTP/SAVP 102\nc=IN IP4 0.0.0.0\na=rtcp:9 IN IP4 ${l}\na=candidate:1152096416 1 udp 2113937151 ${l} ${d} typ host generation 0 network-cost 999\na=ice-ufrag:${u}\na=ice-pwd:${c}\na=ice-options:trickle\na=mid:1\na=extmap:3 urn:3gpp:video-orientation\na=extmap:13 http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01\na=sendrecv\na=msid:g1noOjzcjYNgtJfnKdCzBmyvTozKsCGWCleP df375ff4-7ed5-459d-b991-76c8e47ffc52\na=rtcp-mux\na=rtcp-rsize\na=crypto:0 AES_CM_128_HMAC_SHA1_32 inline:${h}\na=rtpmap:102 VP8/90000\na=rtcp-fb:102 nack\na=rtcp-fb:102 nack pli\na=rtcp-fb:102 goog-remb\na=rtcp-fb:102 transport-cc\na=ssrc:${p} cname:rcpcNyS/Kejuq2+Y\na=ssrc:${p} msid:g1noOjzcjYNgtJfnKdCzBmyvTozKsCGWCleP df375ff4-7ed5-459d-b991-76c8e47ffc52\na=ssrc:${p} mslabel:g1noOjzcjYNgtJfnKdCzBmyvTozKsCGWCleP\na=ssrc:${p} label:df375ff4-7ed5-459d-b991-76c8e47ffc52\n`);return{type:"answer",sdp:f}},t.modifyOfferSDP=function(e,t,r,i,n){var s=e;if(s=(s=s.replace(/a=crypto:[1-9].*\r\n/g,"")).replace(/a=crypto:0.*/g,`a=crypto:0 AES_CM_128_HMAC_SHA1_32 inline:${(0,a.encodeB64)(i)}`),n){var o=s.search(/m=video/g),l=s.substring(0,o),d=s.substring(o);l=l.replace(/ssrc:\S+/g,`ssrc:${t}`),d=(d=(d=d.replace(/ssrc:\S+/g,`ssrc:${r}`)).replace(/a=extmap:13.*/g,"a=extmap:13 http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01")).replace(/a=extmap:3.*/g,"a=extmap:3 urn:3gpp:video-orientation"),s=l+d}else s=s.replace(/ssrc:\S+/g,`ssrc:${t}`);return s};var a=r(84337)},61506:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.checkVoipCapability=function(){return Promise.resolve(!1)},t.decodeB64ToUint8Array=U,t.default=void 0;var n,s=i(r(70417)),o=i(r(52954)),l=r(66239),d=i(r(81363)),u=a(r(25212)),c=r(81725),p=r(88149),h=i(r(2661)),f=r(51739),_=i(r(6370)),m=a(r(91949)),g=null,v={type:"none"},E={init:()=>(__LOG__(2)`voip:init`,Promise.resolve(!1)),updateAudioVideoSwitch:()=>{},cleanup:()=>{},refresh:()=>{},callStart:(e,t)=>{if(__LOG__(2)`voip:callStart: ${e.toString()} video: ${t.toString()}`,!_.default.isVoiceCallEnabled()&&!_.default.isVideoCallEnabled())throw new Error("voip:callStart: calling not enabled");!function(){O.apply(this,arguments)}(e,t)},groupCallStart:()=>{},sendGroupCallInvite:()=>{},endCall:()=>{if("ongoing"===v.type){var e=v;!function(){M.apply(this,arguments)}(v.callId,v.peerJid),e.pc.close(),e.stream.getTracks().forEach((e=>e.stop())),v={type:"none"}}},callEndByHandledRemotely:()=>{},acceptCall:()=>{},rejectCall:()=>{},rejectCallWithoutCallCtx:()=>{},resendEncRekeyRetry:()=>{},processMissedIncomingCall:()=>{},mute:()=>{},videoTurnCameraOn:()=>{},videoTurnCameraOff:()=>{},videoStreamPause:()=>{},videoStreamResume:()=>{},videoRequestUpgrade:()=>{},videoAcceptUpgrade:()=>{},videoRejectUpgrade:()=>{},videoCancelUpgrade:()=>{},handleIncomingSignalingMessage:(n=(0,o.default)((function*(e,t){var r=m.TYPE_NAME[e.type];__LOG__(2)`voip:handleIncomingSignalingMsg: type: "${r}" msg: `;var[a,i]=yield Promise.all([(0,c.requireCallCollection)(),(0,c.requireVoipCommonDisabled)()]),n=a.get(e.call_id);if(null==n?void 0:n.canHandleLocally)switch(e.type){case m.TYPE.OFFER:case m.TYPE.OFFER_RECEIPT:case m.TYPE.ACCEPT_RECEIPT:return;case m.TYPE.MUTE:case m.TYPE.VIDEO_STATE:break;case m.TYPE.ACCEPT:"offer-sent"===v.type&&(v.pc.setRemoteDescription(v.answer),v=(0,s.default)((0,s.default)({},v),{},{type:"ongoing"}));break;case m.TYPE.REJECT:if("offer-sent"===v.type){var o=v;o.pc.close(),o.stream.getTracks().forEach((e=>e.stop())),v={type:"none"}}break;case m.TYPE.TERMINATE:if("ongoing"===v.type){var l=v;l.pc.close(),l.stream.getTracks().forEach((e=>e.stop())),v={type:"none"}}}else i.handleIncomingSignalingMessage(e,t)})),function(){return n.apply(this,arguments)}),isInitialized:()=>!0,registerVideoCallback:()=>{},cleanupVideoBuffer:()=>{},updateNetworkMedium:()=>{},registerWebRTCCallback:e=>{g=e},notifyDeviceIdentityChangedOrDeleted:()=>{},getNumParticipantsFromCallOffer:()=>Promise.resolve(-1)};function y(){return S.apply(this,arguments)}function S(){return(S=(0,o.default)((function*(e,t,r,a){var i=new TextDecoder,n=yield u.extract(e,t);return u.expand(n,i.decode(r),a)}))).apply(this,arguments)}function T(){return A.apply(this,arguments)}function A(){return(A=(0,o.default)((function*(e,t,r){var a=new TextEncoder,i=a.encode(e).buffer,n=a.encode(t).buffer,s=new Uint32Array([r]).buffer,o=yield y(i,s,n,32);return new Uint32Array(o)[0]}))).apply(this,arguments)}function b(){return C.apply(this,arguments)}function C(){return(C=(0,o.default)((function*(e,t){var r=new TextEncoder;return(yield y(e,u.DEFAULT_SALT,r.encode(t).buffer,46)).slice(0,30)}))).apply(this,arguments)}t.default=E;function P(){var e=new Uint8Array(32);return self.crypto.getRandomValues(e),e.buffer}function O(){return(O=(0,o.default)((function*(e,t){if(!d.default)throw new Error("Unable to request Media Devices.");var r=yield(0,d.default)({audio:!0,video:t}),a=(0,h.default)().substr(0,64);__LOG__(2)`voip:generateId: ${a}`;var i=P(),n=(0,l.getMaybeMeUser)(),s=yield T(a,n.toString({legacy:!0}),0),u=yield T(a,e.toString({legacy:!0}),0),c=yield T(a,n.toString({legacy:!0}),2),p=yield T(a,e.toString({legacy:!0}),2),_=yield b(i,n.toString({legacy:!0})),m=yield b(i,e.toString({legacy:!0})),E=new RTCPeerConnection({sdpSemantics:"unified-plan"},{mandatory:{},optional:[{DtlsSrtpKeyAgreement:!1},{RtpDataChannels:!1}]});E.onnegotiationneeded=(0,o.default)((function*(){var o=yield E.createOffer();__LOG__(2,!0)`voip:original-offer: ${o.sdp}`;var{token:l,key:d,relay:h}=yield L(i,n,e.toString({legacy:!0}),a,t);yield D(h,a,n,e.toString({legacy:!0})),o.sdp=(0,f.modifyOfferSDP)(o.sdp,s,c,_,t),__LOG__(2,!0)`voip:modified-offer: ${o.sdp}`,yield E.setLocalDescription(o),__LOG__(2,!0)`voip:localDescription: `;var g=(0,f.generateICELiteAnswerSDP)(h,l,d,u,p,m,t);__LOG__(2,!0)`voip:generated-answer: ${g.sdp}`,v={type:"offer-sent",pc:E,answer:g,stream:r,callId:a,peerJid:e.toString({legacy:!0})}})),E.ontrack=e=>{if(__LOG__(2)`voip:received-track`,!g)throw new Error("No Track callback registered.");g(e)},null==r||r.getTracks().forEach((e=>E.addTrack(e,r)))}))).apply(this,arguments)}function w(e){return["terminate",{"call-id":e},null]}function M(){return(M=(0,o.default)((function*(e,t){var r=w(e),a=r[0];yield(0,p.sendCallSignalingMsg)({common:{type:a,call_id:e,call_creator_jid:"",peer_jid:t},payload:r})}))).apply(this,arguments)}function I(e,t,r,a){return["offer",{"call-id":t,"call-creator":r},[["audio",{enc:"opus",rate:"8000"},null],["audio",{enc:"opus",rate:"16000"},null]].concat(a?[["video",{orientation:"0",screen_width:"1920",screen_height:"1080",device_orientation:"0",enc:"vp8"},null]]:[]).concat([["net",{medium:"3"},null],["capability",{ver:"1"},[1,3,-1,-125,-33]],["enc",{count:"0"},Array.from(new Int8Array(e))],["encopt",{keygen:"2"},null]])]}function R(e,t,r){var a=new ArrayBuffer(6),i=new DataView(a);return i.setUint8(0,e.ip[0]),i.setUint8(1,e.ip[1]),i.setUint8(2,e.ip[2]),i.setUint8(3,e.ip[3]),i.setUint16(4,e.port),["relaylatency",{"call-id":t,"call-creator":r},[["te",{latency:"10"},Array.from(new Int8Array(a))]]]}function D(){return N.apply(this,arguments)}function N(){return(N=(0,o.default)((function*(e,t,r,a){var i=R(e,t,r),n=i[0];yield(0,p.sendCallSignalingMsg)({common:{type:n,call_id:t,call_creator_jid:"",peer_jid:a},payload:i})}))).apply(this,arguments)}function L(){return k.apply(this,arguments)}function k(){return(k=(0,o.default)((function*(e,t,r,a,i){var n=I(e,a,t,i),s=n[0];__LOG__(2)`voip:send:offer: payload:`;var o=yield(0,p.sendCallOffer)({common:{type:s,call_id:a,call_creator_jid:"",peer_jid:r},payload:n});if(!o||!o.status)throw new Error("Error receiving Offer Ack.");switch(o.status){case 200:if(o.payload){__LOG__(2)`voip:recv:offerAck:`;var l=null,d=null,u=null;for(var c of o.payload[2])if("relay"===c[0])for(var h of c[2])if("token"===h[0])l=atob(h[2]),__LOG__(2)`voip:offerAck: token: `;else if("key"===h[0])d=atob(h[2]),__LOG__(2)`voip:offerAck: key: `;else if("te2"===h[0]){var f=U(h[2]);if(6===f.length){var _=new DataView(f.buffer);u={ip:[_.getUint8(0),_.getUint8(1),_.getUint8(2),_.getUint8(3)],port:_.getUint16(4)},__LOG__(2)`voip:offerAck: relay:`}}if(null==l)throw new Error("No relay token in Offer Ack");if(null==d)throw new Error("No relay key in Offer Ack");if(null==u)throw new Error("No relay server found in Offer Ack");return{token:l=btoa(l),key:d,relay:u}}throw __LOG__(2)`voip:recv:offer_ack: no payload`,new Error("Error receiving Offer Ack: No Payload");case 409:throw __LOG__(2)`voip:recv:offer_ack: phone_busy`,new Error("Error receiving Offer Ack: Phone Busy");default:throw __LOG__(2)`voip:recv:offerAck: Unknown status:${status}`,new Error(`Error receiving Offer Ack: Unknown status:${status}`)}}))).apply(this,arguments)}function U(e){for(var t=atob(e),r=t.length,a=new Uint8Array(r),i=0;i<r;++i)a[i]=t.charCodeAt(i);return a}},6370:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(20468));var n={isVoiceCallEnabled:function(){return i.default.supportsFeature(i.default.F.WEB_VOIP_VOICE_CALL)},isVideoCallEnabled:function(){return i.default.supportsFeature(i.default.F.WEB_VOIP_VIDEO_CALL)},isGroupCallEnabled:function(){return!1,false}};t.default=n},91949:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ENC_RETRY_RECEIPT_ATTRS=t.TYPE_NAME=t.TYPE_STR=t.TYPE=void 0;t.TYPE={NONE:0,OFFER:1,OFFER_RECEIPT:2,ACCEPT:3,REJECT:4,TERMINATE:5,TRANSPORT:6,OFFER_ACK:7,OFFER_NACK:8,RELAY_LATENCY:9,RELAY_ELECTION:10,INTERRUPTION:11,MUTE:12,PREACCEPT:13,ACCEPT_RECEIPT:14,VIDEO_STATE:15,NOTIFY:16,GROUP_INFO:17,ENC_REKEY:18,PEER_STATE:19,VIDEO_STATE_ACK:20,FLOW_CONTROL:21,WEB_CLIENT:22,ACCEPT_ACK:23,GROUP_UPDATE:24,MAX:25};t.TYPE_STR={OFFER:"offer",ACCEPT:"accept",ENC_REKEY:"enc_rekey",REJECT:"reject",RECEIPT:"receipt"};t.TYPE_NAME=["NONE","OFFER","OFFER_RECEIPT","ACCEPT","REJECT","TERMINATE","TRANSPORT","OFFER_ACK","OFFER_NACK","RELAY_LATENCY","RELAY_ELECTION","INTERRUPTION","MUTE","PREACCEPT","ACCEPT_RECEIPT","VIDEO_STATE","NOTIFY","GROUP_INFO","ENC_REKEY","PEER_STATE","VIDEO_STATE_ACK","FLOW_CONTROL","WEB_CLIENT","ACCEPT_ACK","GROUP_UPDATE","MAX"];t.ENC_RETRY_RECEIPT_ATTRS={SINGLE_PARTICIPANT:"enc",GROUP_CALL:"enc_rekey_retry"}},70334:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CallNetworkMedium=t.ParticipantState=t.VideoUpgradeRequestEndedReason=t.VideoState=t.VoipSettingsType=t.CALL_LOG_RESULT_TYPE=t.CALL_LOG_RESULT=t.CALL_RESULT_TYPE=t.RENDERER_IPC_EVENTS=t.MAIN_IPC_EVENTS=t.VOIP_WINDOW_IPC_EVENTS=t.CALL_STATES=t.CALL_UI_STATES=t.WACallState=t.WACallEndReason=t.WAVideoCodecScheme=t.WACallEvent=void 0;t.WACallEvent={WANone:0,CallOfferSent:1,CallOfferReceived:2,CallOfferAckedWithRelayInfo:3,CallOfferNacked:4,CallOfferReceiptReceived:5,CallAcceptFailed:6,CallAcceptSent:7,CallAcceptReceived:8,CallPreacceptReceived:9,CallTerminateReceived:10,CallRejectReceived:11,CallOfferResend:12,AudioStreamStarted:13,P2PNegotiationSuccess:14,RelayCreateSuccess:15,CallStateChanged:16,P2PNegotiationFailed:17,MediaStreamError:18,AudioInitError:19,NoSamplingRatesForAudioRecord:20,SendOfferFailed:21,HandleOfferFailed:22,SendAcceptFailed:23,HandlePreAcceptFailed:24,HandleAcceptFailed:25,WillCreateSoundPort:26,SoundPortCreateFailed:27,TransportCandSendFailed:28,P2PTransportCreateFailed:29,P2PTransportMediaCreateFailed:30,P2PTransportStartFailed:31,P2PTransportRestartSuccess:32,MissingRelayInfo:33,ErrorGatheringHostCandidates:34,MediaStreamStartError:35,RelayLatencySendFailed:36,RelayElectionSendFailed:37,CallEnding:38,CallCaptureBufferFilled:39,CallCaptureEnded:40,RxTimeout:41,TxTimeout:42,RxTrafficStarted:43,RxTrafficStopped:44,RTCPPacketReceived:45,RTCPByeReceived:46,RelayBindsFailed:47,SoundPortCreated:48,AudioDriverRestart:49,Echo:50,SelfVideoStateChanged:51,PeerVideoStateChanged:52,VideoPortCreated:53,VideoPortCreateFailed:54,VideoDecodeStarted:55,VideoRenderStarted:56,VideoCaptureStarted:57,VideoPreviewFailed:58,VideoPreviewReady:59,VideoPreviewShouldMinimize:60,VideoStreamCreateError:61,VideoRenderFormatChanged:62,VideoCodecMismatch:63,VideoDecodePaused:64,VideoDecodeResumed:65,VideoEncodeFatalError:66,VideoDecodeFatalError:67,BatteryLevelLow:68,PeerBatteryLevelLow:69,GroupInfoChanged:70,FieldstatsReady:71,PendingCallInfoChanged:72,MuteStateChanged:73,InterruptionStateChanged:74,RxTrafficStateForPeerChanged:75,HandleAcceptReceiptFailed:76,GroupParticipantLeft:77,AudioRouteChangeRequest:78,HandleAcceptAckFailed:79,CallMissed:80,WeakWiFiSwitchedToCellular:81,CallAutoConnect:82,RejectedDecryptionFailure:83,PeerDeviceOrientationChanged:84,HandleOfferAckFailed:85,PendingCallAutoRejected:86,FDLeakDetected:87,RestartCamera:88,AudioTestReplayFinished:89,SyncDevices:90,VideoCodecStateChanged:91,CallFatal:92,UpdateJoinableCallLog:93,WAMax:94};t.WAVideoCodecScheme={VideoCodecSchemeNone:0,VideoCodecSchemeH26X:1,VideoCodecSchemeVPX:2,VideoCodecSchemeVPXH26X:3};t.WACallEndReason={WACallEndReasonUnknown:0,WACallEndReasonEndButtonTapped:1,WACallEndReasonEndButtonTappedOnBusy:2,WACallEndReasonReject:3,WACallEndReasonRejectUnavailable:4,WACallEndReasonRejectBlocked:5,WACallEndReasonTimeout:6,WACallEndReasonPeerUnavailable:7,WACallEndReasonRejectedByPeer:8,WACallEndReasonTimedoutByPeer:9,WACallEndReasonTerminatedByPeer:10,WACallEndReasonFailed:11,WACallEndReasonHandledRemotely:12};t.WACallState={WACallStateNone:0,WACallStateCalling:1,WACallStatePreacceptReceived:2,WACallStateReceivedCall:3,WACallStateAcceptSent:4,WACallStateAcceptReceived:5,WACallStateCallActive:6,WACallStateCallActiveElseWhere:7,WACallStateReceivedCallWithoutOffer:8};t.CALL_UI_STATES={NONE:"NONE",OUTGOING_RING:"OUTGOING_RING",INCOMING_RING:"INCOMING_RING",OUTGOING_CALLING:"OUTGOING_CALLING",CONNECTING:"CONNECTING",RECONNECTING:"RECONNECTING",ACTIVE:"ACTIVE",ENDED:"ENDED",REJECTED:"REJECTED",REMOTE_CALL_IN_PROGRESS:"REMOTE_CALL_IN_PROGRESS",FAILED:"FAILED"};t.CALL_STATES={INCOMING_RING:"INCOMING_RING",OUTGOING_RING:"OUTGOING_RING",OUTGOING_CALLING:"OUTGOING_CALLING",CONNECTING:"CONNECTING",CONNECTION_LOST:"CONNECTION_LOST",ACTIVE:"ACTIVE",HANDLED_REMOTELY:"HANDLED_REMOTELY",ENDED:"ENDED",REJECTED:"REJECTED",REMOTE_CALL_IN_PROGRESS:"REMOTE_CALL_IN_PROGRESS",FAILED:"FAILED",NOT_ANSWERED:"NOT_ANSWERED"};t.VOIP_WINDOW_IPC_EVENTS={INIT:"VOIP_WINDOW_INIT",UPDATE:"VOIP_WINDOW_UPDATE",REJECT:"VOIP_WINDOW_REJECT",ACCEPT:"VOIP_WINDOW_ACCEPT",IGNORE:"VOIP_WINDOW_IGNORE",END:"VOIP_WINDOW_END",RESET:"VOIP_WINDOW_RESET",TOGGLE_MUTE:"VOIP_WINDOW_TOGGLE_MUTE",TOGGLE_CAMERA:"VOIP_WINDOW_TOGGLE_CAMERA",OPEN_IN_CALL_MENU:"OPEN_IN_CALL_MENU",CLOSE_IN_CALL_MENU:"CLOSE_IN_CALL_MENU",TOGGLE_DEBUG_INFO:"TOGGLE_DEBUG_INFO",GROUP_CALL_INVITE:"GROUP_CALL_INVITE",UPGRADE_REQUEST:"UPGRADE_REQUEST",UPGRADE_ACCEPT:"UPGRADE_ACCEPT",UPGRADE_REJECT:"UPGRADE_REJECT",UPGRADE_CANCEL:"UPGRADE_CANCEL",INITIATE_WINDOW_MOVE:"INITIATE_WINDOW_MOVE",CLOSE_WINDOW_CLICK:"CLOSE_WINDOW_CLICK",MINIMIZE_WINDOW_CLICK:"MINIMIZE_WINDOW_CLICK",MAXIMIZE_WINDOW_CLICK:"MAXIMIZE_WINDOW_CLICK",UNMAXIMIZE_WINDOW_CLICK:"UNMAXIMIZE_WINDOW_CLICK",WINDOW_MAXIMIZED:"WINDOW_MAXIMIZED",WINDOW_UNMAXIMIZED:"WINDOW_UNMAXIMIZED",WINDOW_TITLE_DBL_CLICK:"WINDOW_TITLE_DBL_CLICK",WINDOW_ESC_PRESS:"WINDOW_ESC_PRESS",WINDOW_ALWAYS_ON_TOP_CHANGED:"WINDOW_ALWAYS_ON_TOP_CHANGED",L10N_UPDATE:"L10N_UPDATE"};t.MAIN_IPC_EVENTS={EVENT:"VOIP_MAIN_WINDOW_EVENT",SIGNALING:"VOIP_MAIN_WINDOW_SIGNALING",LOGGING:"VOIP_MAIN_WINDOW_LOGGING",LOG_PATH:"VOIP_MAIN_WINDOW_LOG_PATH",AV_EVENT:"AV_DEVICE_INFO_CHANGED",AV_LOG:"AV_MAIN_WINDOW_LOGGING",AV_DEVICE_CHANGE_TOAST:"AV_DEVICE_CHANGE_TOAST",AV_DEVICE_STATUS_CHANGE:"AV_DEVICE_STATUS_CHANGE"};t.RENDERER_IPC_EVENTS={ENABLE_VOIP_FEATURES:"voip:ENABLE_VOIP_FEATURES",ENABLE_VOIP_GROUP_FEATURES:"voip:ENABLE_VOIP_GROUP_FEATURES",REQUEST_NUM_PARTICIPANTS:"voip:REQUEST_NUM_PARTICIPANTS"};t.CALL_RESULT_TYPE={INVALID:0,CONNECTED:1,REJECTED_BY_USER:2,REJECTED_BY_SERVER:3,MISSED:4,BUSY:5,SETUP_ERROR:6,SERVER_NACK:7,CALL_OFFER_ACK_NOT_RECEIVED:8,MISSED_NO_RECEIPT:9,ACCEPTED_BUT_NOT_CONNECTED:10,CALL_CANCELED_CELLULAR_IN_PROGRESS:11,CALL_CANCELED_AIRPLANE_MODE_ON:12,CALL_CANCELED_NO_NETWORK:13,CALL_OFFER_ACK_CORRUPT:14,CALL_REJECTED_TOS:15,CALL_REJECTED_E2E:16,CALL_REJECTED_UNAVAILABLE:17,CALL_CANCELED_OFFER_NOT_SENT:18,PEER_SETUP_ERROR:19,ACTIVE_ELSEWHERE:20,NO_DECRYPTED_OFFER:21,ACCEPTED_ELSEWHERE:22,REJECTED_ELSEWHERE:23};t.CALL_LOG_RESULT={0:"invalid",1:"canceled",2:"missed",3:"unavailable",4:"reject",5:"connected"};t.CALL_LOG_RESULT_TYPE={INVALID:0,CANCELED:1,MISSED:2,UNAVAILABLE:3,REJECT:4,CONNECTED:5};t.VoipSettingsType={voipSettingsNone:0,voipSettingsAudio:1,voipSettingsVideo:2};t.VideoState={VideoStateDisabled:0,VideoStateEnabled:1,VideoStatePaused:2,VideoStateUpgradeRequest:3,VideoStateUpgradeAccept:4,VideoStateUpgradeReject:5,VideoStateStopped:6,VideoStateUpgradeRejectByTimeout:7,VideoStateUpgradeCancel:8,VideoStateUpgradeCancelByTimeout:9,VideoStateError:20};t.VideoUpgradeRequestEndedReason={EndedByUser:0,EndedByTimeout:1};t.ParticipantState={ParticipantStateInvalid:0,ParticipantConnected:1,ParticipantIncoming:2,ParticipantRinging:3,ParticipantRejected:4,ParticipantTerminated:5,ParticipantTimedout:6,ParticipantCreatingCall:7,ParticipantInvisible:8,ParticipantVisible:9,ParticipantCancelOffer:10};t.CallNetworkMedium={CallNetworkMediumCellular:1,CallNetworkMediumWifi:2,CallNetworkMediumNone:3}},11247:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.initDeviceLinkEvent=function(e,t,r){u=new l.default.MdLinkDeviceCompanion,c={regStartTime:r,accountSignature:e,identityKey:t}},t.setDeviceLinkMdUpgrade=function(){p=!0},t.setDeviceLinkPairStage=function(e){if(!u)return;u.set({mdLinkDeviceCompanionStage:e})},t.commitDeviceLinkEvent=function(){return _.apply(this,arguments)};var i=a(r(52954)),n=r(49244),s=r(84337),o=r(95334),l=a(r(84161)),d=a(r(62549)),u=null,c=null,p=!1;function h(){return f.apply(this,arguments)}function f(){return(f=(0,i.default)((function*(e,t){var r=new n.Binary;r.writeBuffer(e),r.write("_".charCodeAt(0)),r.writeBuffer(t);var a=r.readByteArray(),i=yield d.default.digest({name:"SHA-256"},a);return(0,s.encodeB64)(i)}))).apply(this,arguments)}function _(){return(_=(0,i.default)((function*(e){if(u&&c){var t=u,r=c,a=yield h(c.accountSignature,c.identityKey),i=(0,o.unixTime)()-r.regStartTime;t.set({mdDurationS:i,mdSessionId:a,mdTimestampS:r.regStartTime,mdWasUpgraded:p,mdLinkDeviceCompanionErrorCode:null==e?0:e}),t.commit(),u=null,c=null,p=!1}}))).apply(this,arguments)}},30380:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.logLabelOperationEvent=function(e,t,r){var a={labelOperation:e};null!=t&&Object.assign(a,{labelCount:t});r&&Object.assign(a,{labelTarget:r});new i.default.LabelEvent(a).commit()};var i=a(r(84161))},95594:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(84161)),n={document:i.default.MEDIA_TYPE.DOCUMENT,video:i.default.MEDIA_TYPE.VIDEO,gif:i.default.MEDIA_TYPE.GIF,image:i.default.MEDIA_TYPE.PHOTO,audio:i.default.MEDIA_TYPE.AUDIO};t.default=class{constructor(e,t,r){this.mediaPickerSentUnchanged=0,this.mediaPickerDeleted=0,this.mediaPickerChanged=new Set,this.mediaPickerCroppedRotated=new Set,this.mediaPickerDrawing=new Set,this.mediaPickerStickers=new Set,this.mediaPickerText=new Set,this.mediaPickerLikeDoc=0,this.mediaPickerNotLikeDoc=0,this.mediaPickerT=0,this.t0=Date.now(),this.mediaType=n[t],this.mediaPickerOrigin=r,this.medias=new Set,this.medias.add(e),this.changeTypes={mediaPickerCroppedRotated:this.mediaPickerCroppedRotated,mediaPickerDrawing:this.mediaPickerDrawing,mediaPickerStickers:this.mediaPickerStickers,mediaPickerText:this.mediaPickerText}}onAdd(e){this.medias.add(e),"document"===this.mediaType?this.mediaPickerLikeDoc++:this.mediaPickerNotLikeDoc++}onChange(e,t){this.mediaPickerChanged.add(e),this.changeTypes[t].add(e)}onDelete(e){if(this.medias.delete(e),this.mediaPickerDeleted++,0===this.medias.size)return this.onCancel()}onSend(){return this.mediaPickerSent=this.medias.size,this.mediaPickerSentUnchanged=this.mediaPickerSent-this.mediaPickerChanged.size,this.dataPreflight()}onCancel(){return this.mediaPickerSent=0,this.mediaPickerSentUnchanged=0,this.dataPreflight()}onPause(){this.mediaPickerT+=Date.now()-(this.t0||0),this.t0=null}onResume(){this.t0=null!=this.t0?this.t0:Date.now()}dataPreflight(){var e=this.mediaPickerSentUnchanged;return isNaN(e)&&(e=0,__LOG__(4,void 0,new Error,!0)`mediaPickerSentUnchange mediaPickerSent: ${null!=this.mediaPickerSent&&0!==this.mediaPickerSent?this.mediaPickerSent:"undefined"}, mediaPickerChanged: ${this.mediaPickerChanged.size||"undefined"}`,SEND_LOGS("mediaPickerSentUnchange is not a number")),{mediaPickerSent:this.mediaPickerSent,mediaPickerSentUnchanged:e,mediaPickerT:this.mediaPickerT+(Date.now()-(this.t0||0)),mediaType:this.mediaType,mediaPickerOrigin:this.mediaPickerOrigin,mediaPickerChanged:this.mediaPickerChanged.size,mediaPickerCroppedRotated:this.mediaPickerCroppedRotated.size,mediaPickerDrawing:this.mediaPickerDrawing.size,mediaPickerStickers:this.mediaPickerStickers.size,mediaPickerText:this.mediaPickerText.size,mediaPickerLikeDoc:this.mediaPickerLikeDoc,mediaPickerNotLikeDoc:this.mediaPickerNotLikeDoc,mediaPickerDeleted:this.mediaPickerDeleted}}}},18055:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.MediaPickerChangeTypes=void 0;var i=a(r(70417)),n=a(r(95594)),s=a(r(84161));t.MediaPickerChangeTypes={mediaPickerCroppedRotated:"mediaPickerCroppedRotated",mediaPickerDrawing:"mediaPickerCroppedRotated",mediaPickerStickers:"mediaPickerCroppedRotated",mediaPickerText:"mediaPickerCroppedRotated"};t.default=class{constructor(){this.mediaByTypeAndOrigin=new Map,this.mediaEventReverseIndex=new Map,this.chatRecipients=null}pauseTimer(){this.mediaByTypeAndOrigin.forEach((e=>{e.onPause()}))}resumeTimer(){this.mediaByTypeAndOrigin.forEach((e=>{e.onResume()}))}_getKey(e,t){return`${e}_${t}`}_commitLog(e){new s.default.MediaPicker((0,i.default)((0,i.default)({},e),{},{chatRecipients:this.chatRecipients})).commit()}_processNewMedia(e,t,r){var a=this._getKey(t,r),i=this.mediaByTypeAndOrigin.get(a);if(i)i.onAdd(e),this.mediaEventReverseIndex.set(e,i);else{var s=new n.default(e,t,r);this.mediaByTypeAndOrigin.set(a,s),this.mediaEventReverseIndex.set(e,s)}}logChange(e,t){var r=this.mediaEventReverseIndex.get(e);r&&r.onChange(e,t)}logDelete(e){var t=this.mediaEventReverseIndex.get(e);t&&t.onDelete(e)}logSend(){this.mediaByTypeAndOrigin.forEach((e=>{this._commitLog(e.onSend())}))}logCancel(){this.mediaByTypeAndOrigin.forEach((e=>{this._commitLog(e.onCancel())}))}logAdd(e,t,r){this.mediaEventReverseIndex.get(e)||this._processNewMedia(e,t,r)}}},69016:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.getMetricMediaType=function(e){switch(e){case"audio":return o.default.MEDIA_TYPE.AUDIO;case"document":case"thumbnail-document":return o.default.MEDIA_TYPE.DOCUMENT;case"gif":return o.default.MEDIA_TYPE.GIF;case"image":case"thumbnail-image":return o.default.MEDIA_TYPE.PHOTO;case"ppic":return o.default.MEDIA_TYPE.PROFILE_PIC;case"product":return o.default.MEDIA_TYPE.PRODUCT_IMAGE;case"ptt":return o.default.MEDIA_TYPE.PTT;case"sticker":return o.default.MEDIA_TYPE.STICKER;case"video":case"thumbnail-video":return o.default.MEDIA_TYPE.VIDEO;case"template":return o.default.MEDIA_TYPE.TEMPLATE;case"md-msg-hist":return o.default.MEDIA_TYPE.MD_HISTORY_SYNC;case"md-app-state":return o.default.MEDIA_TYPE.MD_APP_STATE;case"product-catalog-image":return o.default.MEDIA_TYPE.PRODUCT_IMAGE;case"thumbnail-link":return o.default.MEDIA_TYPE.NONE;default:throw new Error(`webMediaType is invalid: ${e}`)}},t.getMetricUploadErrorResultType=function(e){if(e instanceof s.MMSUnauthorizedError)return o.default.MEDIA_UPLOAD_RESULT_TYPE.ERROR_NO_PERMISSIONS;if(e instanceof s.MediaTooLargeError)return o.default.MEDIA_UPLOAD_RESULT_TYPE.ERROR_BAD_MEDIA;if(e instanceof s.MMSThrottleError)return o.default.MEDIA_UPLOAD_RESULT_TYPE.ERROR_THROTTLE;if(e instanceof s.HttpStatusCodeError&&e.status>=500)return o.default.MEDIA_UPLOAD_RESULT_TYPE.ERROR_SERVER;if(e instanceof n.NoMediaHostsError)return o.default.MEDIA_UPLOAD_RESULT_TYPE.ERROR_MEDIA_CONN;if(e instanceof Promise.CancellationError||e.name===i.ABORT_ERROR)return o.default.MEDIA_UPLOAD_RESULT_TYPE.ERROR_CANCEL;if(e instanceof s.HttpNetworkError)return o.default.MEDIA_UPLOAD_RESULT_TYPE.ERROR_UPLOAD;return o.default.MEDIA_UPLOAD_RESULT_TYPE.ERROR_UNKNOWN},t.getMetricDownloadErrorResultType=function(e){if(e instanceof s.MMSThrottleError)return o.default.MEDIA_DOWNLOAD_RESULT_TYPE.ERROR_THROTTLE;if(e instanceof n.NoMediaHostsError)return o.default.MEDIA_DOWNLOAD_RESULT_TYPE.ERROR_MEDIA_CONN;if(e instanceof s.HttpNetworkError)return o.default.MEDIA_DOWNLOAD_RESULT_TYPE.ERROR_NETWORK;if(e instanceof s.HttpStatusCodeError)switch(e.status){case 404:case 410:return o.default.MEDIA_DOWNLOAD_RESULT_TYPE.ERROR_TOO_OLD;case 416:return o.default.MEDIA_DOWNLOAD_RESULT_TYPE.ERROR_CANNOT_RESUME;case 401:return o.default.MEDIA_DOWNLOAD_RESULT_TYPE.ERROR_INVALID_URL;case 429:case 507:return o.default.MEDIA_DOWNLOAD_RESULT_TYPE.ERROR_THROTTLE;default:return o.default.MEDIA_DOWNLOAD_RESULT_TYPE.ERROR_UNKNOWN}if(e instanceof Promise.CancellationError||e.name===i.ABORT_ERROR)return o.default.MEDIA_DOWNLOAD_RESULT_TYPE.ERROR_CANCEL;if(e instanceof s.MmsDownloadFilehashMismatchError)return o.default.MEDIA_DOWNLOAD_RESULT_TYPE.ERROR_ENC_HASH_MISMATCH;return o.default.MEDIA_DOWNLOAD_RESULT_TYPE.ERROR_UNKNOWN},t.getStatusCode=function(e){if(e instanceof s.HttpStatusCodeError)return e.status},t.generateMediaEventId=function(){return 1+Math.floor(Number.MAX_SAFE_INTEGER*Math.random())},t.logErrorUnknownDetails=function(e,t){if(null==t)return;var r;e.overallDownloadResult===o.default.MEDIA_DOWNLOAD_RESULT_TYPE.ERROR_UNKNOWN?r=o.default.WEBC_MEDIA_OPERATION_CODE.DOWNLOAD:e.overallUploadResult===o.default.MEDIA_UPLOAD_RESULT_TYPE.ERROR_UNKNOWN&&(r=o.default.WEBC_MEDIA_OPERATION_CODE.UPLOAD);if(null==r)return;new o.default.WebcMediaErrorUnknownDetails({mediaId:e.mediaId,webcMediaOperation:r,webcMediaErrorName:t.name}).commit()},t.getMetricBackendStore=function(e){if(!e)return o.default.BACKEND_STORE_TYPE.NON_DIRECT_PATH;switch(e.slice(0,2).toLowerCase()){case"/v":return o.default.BACKEND_STORE_TYPE.EVERSTORE;case"/o":return o.default.BACKEND_STORE_TYPE.OIL}return __LOG__(4,void 0,new Error,!0)`Unrecognized direct path type`,SEND_LOGS("unrecognized-direct-path-type"),null};var i=r(3599),n=r(74475),s=r(28635),o=a(r(84161))},84161:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(70417)),n=r(12686),{BOOLEAN:s,INTEGER:o,NUMBER:l,STRING:d,TIMER:u}=n.TYPES,c=Object.freeze({NONE:1,SOFTWARE:2,BUILTIN:3}),p=Object.freeze({NONE:1,SOFTWARE:2,BUILTIN:3}),h=Object.freeze({LIMITED:0,FULL:1,LEGACY:2,LEVEL_3:3,EXTERNAL:4}),f=Object.freeze({API_1:1,API_2:2}),_=Object.freeze({NOT_AVAILABLE:1,SELF_TEST_FAILURE:2,ENC_KEY_READ_FAILURE:3,ENC_KEY_STORED_USED:4,ENC_KEY_PLAIN_DELETED:5,ENC_KEY_PLAIN_RECOVERED:6}),m=Object.freeze({JNI:1,OPENSLES:2}),g=Object.freeze({NON_DIRECT_PATH:1,EVERSTORE:2,OIL:3}),v=Object.freeze({SHOWN:1,CLICK:2,DISMISS:3,ELIGIBLE:4,REVOKED:5}),E=Object.freeze({GROUP:1,SMB_WELCOME:2,SMB_VERIFIED:3,SMB_EDIT_PROFILE:4,SMB_EDIT_DESCRIPTION:5,SMB_EDIT_CATEGORY:6,SMB_EDIT_HOURS:7,SMB_EDIT_EMAIL:8,SMB_CATALOG:9,SMB_CATALOG_SHARE_BANNER:10,CROSS_SELL_PROFILE_INTERSTITIAL:11,CROSS_SELL_CHATS_INTERSTITIAL:12,CROSS_SELL_CHATS_BANNER:13,BUSINESS_ACCOUNT_SYSTEM_MESSAGE:14,SMB_CATALOG_CART_INTERSTITIAL:15,PAYMENTS_ONBOARD_BANNER:16,SMB_DIRECTORY_UPSELL:17,SMB_CATALG_LIST_LWI_ADVERTISE_BANNER:18,SMB_LWI_AD_HUB_EDUCATIONAL_BANNER:19}),y=Object.freeze({UNKNOWN:1,SMB:2,ENT:3}),S=Object.freeze({REGISTRATION:1,SETTINGS:2}),T=Object.freeze({DESCRIPTION:1,HOURS:2,ADDRESS:3,EMAIL:4,WEBSITE:5,CATEGORY:6}),A=Object.freeze({CALLS_TAB_MISSED:1,CALLS_TAB_OUTGOING:2,SELECT_CONTACT:3,CALL_INFO:4,NOTIFICATION_MISSED:5,CONTACT_INFO:6,QUICK_CONTACT_INFO:7,CONVERSATION:8,CALLS_TAB_INCOMING:9,GROUP_CHAT_INFO:10,GROUP_CHAT_RECENT_LOCATION:11,ANDROID_BROADCAST_DETAILS:12,ANDROID_LIST_CHAT_INFO:13,ANDROID_CONTACTS_APPLICATION:14,CONTACT_VCARD:15,CALLS_TAB_NEW_CALL:16,VOICE_MAIL_CALL_BACK:17,IOS_INTENT:18,LIVE_LOCATION_MAP:19,GROUP_CALL_INFO:20,CALLS_TAB_BOTTOM_SHEET:21,STATUS_VIEWER:22,DEBUG_TOOL:23,GROUP_CHAT_PICKER:24,GROUP_CHAT_DIRECT:25,STELLA:26,CHAT_LIST:27,NEW_CHAT:28,CONVERSATION_OPTIONS:29}),b=Object.freeze({CELLULAR:1,WIFI:2,NONE:3}),C=Object.freeze({UNBOUND:1,BINDED:2}),P=Object.freeze({INVALID:0,CONNECTED:1,REJECTED_BY_USER:2,REJECTED_BY_SERVER:3,MISSED:4,BUSY:5,SETUP_ERROR:6,SERVER_NACK:7,CALL_OFFER_ACK_NOT_RECEIVED:8,MISSED_NO_RECEIPT:9,ACCEPTED_BUT_NOT_CONNECTED:10,CALL_CANCELED_CELLULAR_IN_PROGRESS:11,CALL_CANCELED_AIRPLANE_MODE_ON:12,CALL_CANCELED_NO_NETWORK:13,CALL_OFFER_ACK_CORRUPT:14,CALL_REJECTED_TOS:15,CALL_REJECTED_E2E:16,CALL_REJECTED_UNAVAILABLE:17,CALL_CANCELED_OFFER_NOT_SENT:18,PEER_SETUP_ERROR:19,ACTIVE_ELSEWHERE:20,NO_DECRYPTED_OFFER:21,ACCEPTED_ELSEWHERE:22,REJECTED_ELSEWHERE:23}),O=Object.freeze({CALL_SEGMENT_ONE_ON_ONE_ACTIVE:1,CALL_SEGMENT_GROUP_ACTIVE:2,CALL_SEGMENT_ONE_ON_ONE_HOLD_SELF:3,CALL_SEGMENT_ONE_ON_ONE_HOLD_PEER:4}),w=Object.freeze({UNKNOWN:1,CALL_ACCEPT_FAILED:2,INIT_MEDIA_STREAM_FAILED:3,START_MEDIA_STREAM_FAILED:4,AUDIO_INIT_ERROR:5,HANDLE_OFFER_FAILED:6,HANDLE_ACCEPT_FAILED:7,SOUND_PORT_CREATE_FAILED:8,P2P_TRANSPORT_CREATE_FAILED:9,P2P_TRANSPORT_MEDIA_CREATE_FAILED:10,INCOMPATIBLE_SRTP_KEY_EXCHANGE:11,SRTP_KEY_GENERATION_ERROR:12,UNSUPPORTED_AUDIO_CAPS:13,P2P_TRANSPORT_START_FAILED:14,RELAY_BIND_FAILED:15,CANNOT_INITIALIZE_AUDIO_RECORD_OBJECT:16,PEER_RELAY_BIND_FAILED:17,VIDEO_CAPTURE_INIT_FAILED:18,VIDEO_CAPTURE_START_FAILED:19,VIDEO_RENDER_INIT_FAILED:20,VIDEO_RENDER_START_FAILED:21,VIDEO_ENCODER_OPEN_FAILED:22,VIDEO_DECODER_OPEN_FAILED:23,VIDEO_STREAM_CREATE_FAILED:24,VIDEO_STREAM_SETUP_FAILED:25,PEER_SETUP_FAILED:26,HANDLE_PREACCEPT_FAILED:27}),M=Object.freeze({CALLER:1,CALLEE:2}),I=Object.freeze({ENDED_BY_USER:1,TIMEOUT:2,RECONNECTING:3,ENDED_BY_SELF:4,ENDED_BY_PEER:5,VIDEO_ENCODER_FATAL_ERROR:6,VIDEO_DECODER_FATAL_ERROR:7,AUDIO_RECORD_FATAL_ERROR:8,CRASH:9,DETECT_IDENTITY_CHANGE:10,USER_INVISIBLE:11,RELAY_BIND_FAILED:12,SETUP_FAILED:13,ACCEPTED_ELSEWHERE:14,REJECTED_ELSEWHERE:15,GROUP_CALL_ENDED:16,CALL_IS_FULL:17}),R=Object.freeze({UNKNOWN:0,P2P:1,UDP_RELAY:2,TCP_RELAY:3,MIXED:4}),D=Object.freeze({DISABLED:0,ENABLED:1,PAUSED:2,UPGRADE_REQUEST:3,MUTED:6,ERROR:20}),N=Object.freeze({NONE:0,UNKNOWN:1,APNS_PUSH:2,IOS_VOIP_PUSH:3,GCM_PUSH:4,ONLINE:5,RIM_PUSH:6}),L=Object.freeze({DEFAULT:0,TEXTURE:1,TEXTURE_FALLBACK:2}),k=Object.freeze({DEFAULT:0,CONSERVATIVE:1,STRICT:2,ERROR:11}),U=Object.freeze({ACTION_PRODUCT_ADD_CLICKED:1,ACTION_PRODUCT_ADD_SUCCESS:2,ACTION_PRODUCT_ADD_FAILED:3,ACTION_PRODUCT_EDIT_CLICKED:4,ACTION_PRODUCT_EDIT_SUCCESS:5,ACTION_PRODUCT_EDIT_FAILED:6,ACTION_PRODUCT_DELETE_CLICKED:7,ACTION_PRODUCT_DELETE_SUCCESS:8,ACTION_PRODUCT_DELETE_FAILED:9,ACTION_APPEAL_PRODUCT_CLICKED:10,ACTION_APPEAL_PRODUCT_SUCCESS:11,ACTION_APPEAL_PRODUCT_FAILED:12,ACTION_CREATE_PRODUCT_CATALOG:13,ACTION_CREATE_PRODUCT_CATALOG_SUCCESS:14,ACTION_CREATE_PRODUCT_CATALOG_FAILED:15,ACTION_CATALOG_MENU_ITEM_CLICKED:16,ACTION_PRODUCT_RESUBMIT_CLICKED:17,ACTION_START_IMPORT_FLOW:18,ACTION_IMPORT_POST:19,ACTION_CARD_IMPRESSION:20,ACTION_CARD_ITEM_CLICK:21,ACTION_CARD_MORE_CLICK:22,ACTION_LIST_IMPRESSION:23,ACTION_LIST_ITEM_CLICK:24,ACTION_DETAIL_IMAGE_CLICK:25,ACTION_DETAIL_LINK_CLICK:26,ACTION_IMAGE_LIST_IMPRESSION:27,ACTION_IMAGE_LIST_CLICK:28,ACTION_FULL_IMAGE_IMPRESSION:29,ACTION_FULL_IMAGE_SWIPE:30,ACTION_DETAIL_IMPRESSION:31,ACTION_QUOTED_PRODUCT_IN_CONVERSATION_CLICK:32,ACTION_PRODUCT_IN_CONVERSATION_CLICK:33,ACTION_SEND_PRODUCT_MESSAGE:34,ACTION_ONBOARD_IMPRESSION:35,ACTION_SHARE_CATALOG_LINK_CLICK:36,ACTION_SHARE_PRODUCT_LINK_CLICK:37,ACTION_CATALOG_IN_CONVERSATION_CLICK:38,ACTION_SHARE_CATALOG_VIA_WA_LINK_CLICK:39,ACTION_SHARE_PRODUCT_VIA_WA_LINK_CLICK:40,ACTION_SHARE_CATALOG_COPY_LINK_CLICK:41,ACTION_SHARE_PRODUCT_COPY_LINK_CLICK:42,ACTION_SEND_CATALOG_CLICK:43,ACTION_ORDER_MESSAGE_CLICK:44,ACTION_ORDER_LIST_IMPRESSION:45,ACTION_ORDER_LIST_ITEM_CLICK:46,ACTION_MESSAGE_BUSINESS_BUTTON_CLICK:47,ACTION_QUOTED_PRODUCT_MESSAGE_SEND:48,ACTION_CART_ADD_PRODUCT:49,ACTION_CART_ICON_CLICK:50,ACTION_CART_SNACKBAR_CLICK:51,ACTION_CART_LIST_IMPRESSION:52,ACTION_CART_EDIT_PRODUCT:53,ACTION_CART_DELETE_PRODUCT:54,ACTION_CART_ABANDON:55,ACTION_SEND_ORDER_MESSAGE:56,ACTION_MENU_CLICK:57,ACTION_PRODUCT_HIDE_CLICKED:58,ACTION_PRODUCT_HIDE_SUCCESS:59,ACTION_PRODUCT_HIDE_CANCELLED:60,ACTION_PRODUCT_HIDE_FAILED:61,ACTION_PRODUCT_UNHIDE_CLICKED:62,ACTION_PRODUCT_UNHIDE_SUCCESS:63,ACTION_PRODUCT_UNHIDE_CANCELLED:64,ACTION_PRODUCT_UNHIDE_FAILED:65,ACTION_CATALOG_LIST_MENU_CLICKED:66,ACTION_CATALOG_LIST_MENU_CLICKED_WITH_ADVERTISE_SHOWN:67}),G=Object.freeze({CATALOG_ENTRY_POINT_PROFILE:1,CATALOG_ENTRY_POINT_SETTINGS:2,CATALOG_ENTRY_POINT_MESSAGE:3,CATALOG_ENTRY_POINT_ATTACHMENT_PANEL:4,CATALOG_ENTRY_POINT_NUX:5,CATALOG_ENTRY_POINT_DEEPLINK:6,CATALOG_ENTRY_POINT_CHAT:7,CATALOG_ENTRY_POINT_ORDER_MESSAGE:8,CATALOG_ENTRY_POINT_INVOICE_ATTACHMENT_PANEL:9,CATALOG_ENTRY_POINT_PRODUCT_LIST_MESSAGE:10}),F=Object.freeze({ACTION_CARD_IMPRESSION:1,ACTION_CARD_ITEM_CLICK:2,ACTION_CARD_MORE_CLICK:3,ACTION_LIST_IMPRESSION:4,ACTION_LIST_ITEM_CLICK:5,ACTION_DETAIL_IMAGE_CLICK:6,ACTION_DETAIL_LINK_CLICK:7,ACTION_IMAGE_LIST_IMPRESSION:8,ACTION_IMAGE_LIST_CLICK:9,ACTION_FULL_IMAGE_IMPRESSION:10,ACTION_FULL_IMAGE_SWIPE:11,ACTION_DETAIL_IMPRESSION:12,ACTION_REPORT_PRODUCT:13,ACTION_SEND_PRODUCT_MESSAGE:14,ACTION_REPORT_PRODUCT_SUCCESS:15,ACTION_REPORT_PRODUCT_FAILURE:16,ACTION_QUOTED_PRODUCT_IN_CONVERSATION_CLICK:17,ACTION_PRODUCT_IN_CONVERSATION_CLICK:18,ACTION_SHARE_CATALOG_LINK_CLICK:19,ACTION_SHARE_PRODUCT_LINK_CLICK:20,ACTION_CATALOG_IN_CONVERSATION_CLICK:21,ACTION_SHARE_CATALOG_VIA_WA_LINK_CLICK:22,ACTION_SHARE_PRODUCT_VIA_WA_LINK_CLICK:23,ACTION_SHARE_CATALOG_COPY_LINK_CLICK:24,ACTION_SHARE_PRODUCT_COPY_LINK_CLICK:25,ACTION_CHAT_CATALOG_ICON_CLICK:26,ACTION_MESSAGE_BUSINESS_BUTTON_CLICK:27,ACTION_CART_ADD_PRODUCT:28,ACTION_CART_EDIT_PRODUCT:29,ACTION_CART_DELETE_PRODUCT:30,ACTION_CART_ABANDON:31,ACTION_CART_ICON_CLICK:32,ACTION_CART_SNACKBAR_CLICK:33,ACTION_SEND_ORDER_MESSAGE:34,ACTION_ORDER_LIST_IMPRESSION:35,ACTION_QUOTED_PRODUCT_MESSAGE_SEND:36,ACTION_CART_LIST_IMPRESSION:37,ACTION_ORDER_MESSAGE_CLICK:38,ACTION_ORDER_LIST_ITEM_CLICK:39,ACTION_PLM_CART_CTA_CLICK:40}),x=Object.freeze({OPEN:1,SELECT_FILTER:2,SEARCH_WITH_FILTER:3}),B=Object.freeze({NONE:0,OTHER_LABELS:1,UNREAD:2,GROUP:3,BROADCAST_LIST:4,NEW_CUSTOMER:5,NEW_ORDER:6,PENDING_PAYMENT:7,PAID:8,ORDER_COMPLETE:9}),Y=Object.freeze({REGULAR:1,REGULAR_LOW:2,REGULAR_HIGH:3,CRITICAL_BLOCK:4,CRITICAL_UNBLOCK_LOW:5}),K=Object.freeze({PERSON:1,PUSH:2,OTHER:3,BACKOFF:4}),j=Object.freeze({HOSTNAME:0,IP4:1,IP6:2}),W=Object.freeze({CHATD:1,MMS:2}),H=Object.freeze({PROBLEM_DESCRIPTION:1,SUGGESTED_FAQ:2,EMAIL_SEND:3,IN_APP_FAQ:4,CANCELLED:5,FAQ:6}),V=Object.freeze({DEEP_LINK_EXTERNAL:1,DEEP_LINK_WA_LINK_CLICK:2,QR_CODE_SHEET:3}),$=Object.freeze({DEEP_LINK_UNKNOWN:1,DEEP_LINK_CHAT:2,DEEP_LINK_CONTACT_QR_CODE:3,DEEP_LINK_PAYMENT:4,DEEP_LINK_PRODUCT:5,DEEP_LINK_CATALOG:6,DEEP_LINK_FUTURE_PROOF:7,DEEP_LINK_GROUP_INVITE:8,DEEP_LINK_MSG_FORWARD:9,DEEP_LINK_MESSAGE_QR_CODE:10,DEEP_LINK_OPT_IN_QR_CODE:11,DEEP_LINK_CTWA:12,DEEP_LINK_STICKERPACK:13,DEEP_LINK_NOVI_HUB:14,DEEP_LINK_NOVI_ADD_DEBIT_CARD:15,DEEP_LINK_NOVI_ADD_BANK_ACCOUNT:16,DEEP_LINK_NOVI_WITHDRAW:17,DEEP_LINK_NOVI_RESET_PASSWORD:18,DEEP_LINK_PAYMENT_SIGNUP:19,DEEP_LINK_BIZTOOLS_ACCOUNTS:20,DEEP_LINK_PAYMENT_VIRALITY:21,DEEP_LINK_SETTINGS_ACCOUNT_DELETE:22,DEEP_LINK_SETTINGS_ACCOUNT_REQUEST_INFO:23,DEEP_LINK_SETTINGS_CHATS_HISTORY:24}),q=Object.freeze({APP_SWITCH:1,BROWSER:2,CANCELLED:3}),z=Object.freeze({PRIMARY:1,COMPANION:2}),J=Object.freeze({CHAT_PERSONAL:1,CHAT_GROUP:2,STATUS_USER:3,STATUS_ADS:4,PRODUCT_CATALOG:5,GDPR:6,STICKER_PICKER:7,PROFILE_PICTURE:8,BLOKS:9,P2B:10}),Q=Object.freeze({NORMAL_QUALITY:1,MID_QUALITY:2,INELIGIBLE_IMAGE_TOO_SMALL:3,INELIGIBLE_PARTIAL_HASHES_NOT_FOUND:4,ERROR_DETERMINING_ELIGIBILITY:5,NOT_DOWNLOADED_ENOUGH_BYTES_TO_DETERMINE_ELIGIBILITY:6}),X=Object.freeze({INVALID_SENDER:1,MISSING_DSM:2,INVALID_DSM:3}),Z=Object.freeze({MESSAGE:0,PREKEY_MESSAGE:1,SENDER_KEY_MESSAGE:2}),ee=Object.freeze({INDIVIDUAL:0,GROUP:1,LIST:2,STATUS:3}),te=Object.freeze({INVALID_MESSAGE:0,LEGACY_MESSAGE:1,INVALID_VERSION:2,PRE_KEY_MESSAGE_MISSING_PRE_KEY:3,PRE_KEY_MESSAGE_INVALID_KEY:4,UNTRUSTED_IDENTITY:5,NO_SESSION_AVAILABLE:6,PLAINTEXT_BYTE_MISMATCH:7,UNKNOWN_CIPHERTEXT_TYPE:8,UNKNOWN_CIPHERTEXT_VERSION:9,INVALID_PADDING:10,INVALID_PROTOCOL_BUFFER:11,INVALID_NUMBER_OF_MESSAGE_TYPES:12,INVALID_IMAGE_FILE_LENGTH:13,INVALID_IMAGE_FILE_SHA256:14,INVALID_IMAGE_MEDIA_URL:15,INVALID_IMAGE_MEDIA_KEY:16,INVALID_IMAGE_MIME_TYPE:17,UNKNOWN_V2_TAGS:18,INVALID_EDIT_VERSION:19,INVALID_HSM_NAMESPACE:20,INVALID_HSM_ELEMENT:21,UNKNOWN_PROTOCOL_MESSAGE_TYPE:22,DUPLICATE_MESSAGE:23,FINGERPRINT_IDENTITY_MISMATCH:24,FINGERPRINT_VERSION_MISMATCH:25,INVALID_ARGUMENT:26,INVALID_KEY:27,INVALID_KEY_ID:28,INVALID_MAC:29,NO_MEMORY:30,STALE_KEY_EXCHANGE:31,VRF_SIGNATURE_VERIFICATION_FAILED:32,ERROR_MINIMUM_VALUE:33,ERROR_UNKNOWN:34,INVALID_BROADCAST_STANZA_ATTRIBUTE:35,INVALID_LIST_REPLY_MESSAGE:36,INVALID_LIST_REPLY_ROW_IDENTIFIER:37,INVALID_BUTTONS_RESPONSE_MESSAGE:38,INVALID_BUTTONS_RESPONSE_BUTTON_IDENTIFIER:39,INVALID_ORDER_MESSAGE:40}),re=Object.freeze({MY_PRIMARY:1,OTHER_PRIMARY:2,MY_COMPANION:3,OTHER_COMPANION:4}),ae=Object.freeze({ACTION_OPEN:1,ACTION_SAVE:2,ACTION_DISCARD:3,ACTION_PROFILE_FIELD_OPEN:4,ACTION_PROFILE_FIELD_SAVE:5,ACTION_PROFILE_FIELD_DISCARD:6}),ie=Object.freeze({CALL_TOO_SHORT:1}),ne=Object.freeze({ROOM_OPEN_FAILURE:1,UNKNOWN_ERROR:2}),se=Object.freeze({BOTH:1,SELF:2,PEER:3}),oe=Object.freeze({GIPHY:0,TENOR:1}),le=Object.freeze({INCOMING_CALL_SCREEN_ANSWER:1,INCOMING_CALL_SCREEN_REJECT:2,INCOMING_CALL_NOTIFICATION_ANSWER:3,INCOMING_CALL_NOTIFICATION_REJECT:4,PENDING_CALL_SCREEN_END_AND_ANSWER:5,PENDING_CALL_SCREEN_HOLD_AND_ANSWER:6,PENDING_CALL_SCREEN_REJECT:7,INCOMING_CALL_REMOTE_ANSWER:8,INCOMING_CALL_REMOTE_REJECT:9,PENDING_CALL_NOTIFICATION_END_AND_ANSWER:10,PENDING_CALL_NOTIFICATION_REJECT:11}),de=Object.freeze({DEFAULT:0,PROBING_ROTT_TO_RELAY:1,PROBING_E2E_PEER_RX:2,PROBING_E2E_RX:3,HIS_RECENT_PEER_RX:4,HIS_RECENT_RX:5,HIS_RECENT_PROBING_ROTT_TO_RELAY:6,HIS_RECENT_PROBING_E2E_PEER_RX:7,HIS_RECENT_PROBING_E2E_RX:8,ONE_SIDE_INITIAL_BANDWIDTH_ESTIMATION:9}),ue=Object.freeze({ADD:1,EDIT:2,DELETE:3,VIEW:4,CLICK_POSITIVE:5,CLICK_NEGATIVE:6,UPDATE_LABEL_COUNT:7}),ce=Object.freeze({LABEL:1,MESSAGE:2,CONTACT:3,LABELS_SCREEN:4,LABEL_DETAILS_SCREEN:5,EDIT_LABEL_DIALOG:6,DELETE_LABEL_DIALOG:7,LABEL_MESSAGE_DIALOG:8,LABEL_CHAT_DIALOG:9,ADD_LABEL_DIALOG:10,BULK_UNLABEL_DIALOG:11,LABEL_COMBINED_DIALOG:12,GROUP:13,BROADCAST:14}),pe=Object.freeze({OK:1,ERROR_UNKNOWN:2,SERVER_ERROR:3,SERVER_GOAWAY:4,NETWORK_ERROR:5,ANDROID_KEYSTORE_ERROR:6}),he=Object.freeze({APP_STATE_SYNC_KEY_EXPIRY:1,DEVICE_DEREGISTERATION:2,NO_KEYS:3}),fe=Object.freeze({CRITICAL:1,NON_CRITICAL:2}),_e=Object.freeze({APP_STATE:1,HISTORY:2}),me=Object.freeze({SUCCESS:1,FAILURE:2}),ge=Object.freeze({PAIR_SUCCESS_RECEIVED:1,PAIR_DEVICE_SIGN_SENT:2,FIRST_CONNECT:3,UPLOAD_PREKEYS:4,COMPLETE:5}),ve=Object.freeze({INITIAL_SYNC:1,RESUME_SYNC:2,REGULAR_SYNC:3}),Ee=Object.freeze({MESSAGE_RANGE_UNSET:1,MESSAGE_RANGE_LAST_SYSTEM_MESSAGE_TIMESTAMP_SET:2,MESSAGE_RANGE_MESSAGES_UNSET:3,MESSAGE_RANGE_MESSAGES_EMPTY:4,MESSAGE_RANGE_MESSAGES_CROSS_LIMIT:5,MESSAGE_RANGE_MESSAGE_KEY_UNSET:6,MESSAGE_RANGE_MESSAGE_KEY_REMOTE_JID_UNSET:7,MESSAGE_RANGE_MESSAGE_KEY_FROM_ME_UNSET:8,MESSAGE_RANGE_MESSAGE_KEY_STANZA_ID_UNSET:9}),ye=Object.freeze({TOO_MANY_INTERNAL_SERVER_ERRORS_IN_7D:1,SERVER_DATA_MISMATCH:2,PROTOBUF_DESERIALIZATION_FAILED:3,EXTERNAL_PATCH_EXPIRED:4,MISSING_OR_EMPTY_INDEX:5,SAME_INDEX_FOR_MULTIPLE_MUTATIONS_IN_PATCH:6,DECRYPTION_FAILED:7,MISSING_PATCH_VERSION:8,DUPLICATE_PATCH_VERSION_IN_COLLECTION:9,ENCRYPTION_FAILED:10,MISSING_MUTATION_VERSION:11,MISSING_MUTATION_VALUE:12,INVALID_MUTATION_INDEX:13,PATCH_WITH_BOTH_INLINE_AND_EXTERNAL_MUTATIONS:14,MISSING_MUTATION_OPERATION:15,MISSING_MUTATION_RECORD:16,MISSING_MUTATION_KEY_ID:17,PATCH_PROTOBUF_DESERIALIZATION_FAILED:18,ACTION_DATA_PROTOBUF_DESERIALIZATION_FAILED:19,MISSING_MUTATION_INDEX:20,MISSING_ACTION_INDEX:21,INVALID_ACTION_INDEX:22,MISSING_ACTION_VALUE:23,MISSING_ACTION_VERSION:24,MISSING_ACTION_TIMESTAMP:25,MUTATIONS_PROTOBUF_DESERIALIZATION_FAILED:26,MUTATIONS_PROTOBUF_SERIALIZATION_FAILED:27,PATCH_PROTOBUF_SERIALIZATION_FAILED:28,ACTION_DATA_PROTOBUF_SERIALIZATION_FAILED:29,MISSING_KEY_ON_ALL_CLIENTS:30,TIMEOUT_WHILE_WAITING_FOR_MISSING_KEY:31,MAC_MISMATCH_SNAPSHOT:33,MAC_MISMATCH_PATCH:34,DB_STORE_NOT_READY:35,TERMINAL_PATCH_MISSING_DATA:36,TERMINAL_PATCH_DESERIALIZATION_ERROR:37,TERMINAL_PATCH_UNKNOWN:38,CYCLIC_MUTATION_DEPENDENCY_IN_PATCH:39,MISSING_SNAPSHOT_VERSION:45,MISSING_SNAPSHOT_MAC:46,MISSING_PATCH_SNAPSHOT_MAC:47,MISSING_PATCH_MAC:48,MISSING_EXTERNAL_BLOB_REFERENCE_MEDIA_KEY:49,MISSING_EXTERNAL_BLOB_REFERENCE_DIRECT_PATH:50,MISSING_EXTERNAL_BLOB_REFERENCE_FILE_SHA256:51,MISSING_EXTERNAL_BLOB_REFERENCE_FILE_ENC_SHA256:52,INVALID_KEY_SHARE_KEY_ID:53,MALFORMED_PENDING_MUTATION:54,MISSING_PATCH_KEY_ID:56,INVALID_KEY_SHARE_KEY_DATA:57,SNAPSHOT_EXPIRED:58,MISSING_SNAPSHOT_KEY_ID:59,SNAPSHOT_MAC_MISMATCH_IN_PATCH:60,SNAPSHOT_MAC_MISMATCH_IN_SNAPSHOT:61,XMPP_BAD_REQUEST_FOR_COLLECTION:62,XMPP_NOT_FOUND_FOR_COLLECTION:63,XMPP_BAD_REQUEST_GLOBAL_ERROR:64,XMPP_NOT_FOUND_GLOBAL_ERROR:65,XMPP_BAD_METHOD_GLOBAL_ERROR:66,XMPP_NOT_ACCEPTABLE_GLOBAL_ERROR:67,SAME_INDEX_FOR_MULTIPLE_MUTATIONS_IN_SNAPSHOT:68,EXTERNAL_BLOB_REFERENCE_PROTOBUF_DESERIALIZATION_FAILED:69,SNAPSHOT_PROTOBUF_DESERIALIZATION_FAILED:70,REQUESTING_MISSING_KEY_WITH_NO_CLIENTS:71}),Se=Object.freeze({SYNCD:1,WEB:2}),Te=Object.freeze({BROWSER:1,DESKTOP:2}),Ae=Object.freeze({MANUAL:1,FULL:2,PREFETCH:3,HEADER:4,THUMBNAIL:5}),be=Object.freeze({OK:1,ERROR_UNKNOWN:2,ERROR_TIMEOUT:3,ERROR_DNS:4,ERROR_INSUFFICIENT_SPACE:5,ERROR_TOO_OLD:6,ERROR_CANNOT_RESUME:7,ERROR_HASH_MISMATCH:8,ERROR_INVALID_URL:9,ERROR_OUTPUT_STREAM:10,ERROR_CANCEL:11,DEDUPED:12,ERROR_ENC_HASH_MISMATCH:14,PREFETCH_END:15,ERROR_CANCEL_PROGRAMMATIC:16,ERROR_MEDIA_CONN:17,ERROR_THROTTLE:18,ERROR_SSL:19,ERROR_NETWORK:20,ERROR_CONNECT:21}),Ce=Object.freeze({CHAT_PHOTO_LIBRARY:1,CAMERA_TAB_CAPTURE:2,FORWARD:3,PASTE:4,SHARE_EXTENSION:5,EXPORT:6,MENU_CAMERA_CAPTURE:7,EXTERNAL_CAMERA:8,LINK_PREVIEW_DOWNLOAD:9,CAMERA_TAB_MEDIA_STRIP:10,CAMERA_TAB_PHOTO_LIBRARY:11,CHAT_BUTTON_CAMERA_CAPTURE:12,CHAT_BUTTON_CAMERA_MEDIA_STRIP:13,CHAT_BUTTON_CAMERA_PHOTO_LIBRARY:14,STATUS_TAB_CAMERA_CAPTURE:15,STATUS_TAB_CAMERA_MEDIA_STRIP:16,STATUS_TAB_CAMERA_PHOTO_LIBRARY:17,STATUS_REPLY_CAMERA_CAPTURE:18,STATUS_REPLY_CAMERA_MEDIA_STRIP:19,STATUS_REPLY_CAMERA_PHOTO_LIBRARY:20,MENU_CAMERA_PHOTO_LIBRARY:21,CHAT_GIF_INAPP:22,CHAT_GIF_EXTERNAL:23,STATUS_REPLY_GIF_INAPP:24,STATUS_REPLY_GIF_EXTERNAL:25,SMB_QUICK_REPLY_EDIT:26,SMB_QUICK_REPLY_SEND:27,MEDIA_BROWSER:28,CHAT_QUICK_EDIT:29,CAMERA_TAB_GIF:30,STATUS_TAB_GIF:31}),Pe=Object.freeze({NONE:1,PHOTO:2,VIDEO:3,AUDIO:4,PTT:5,LOCATION:6,CONTACT:7,DOCUMENT:8,URL:9,CALL:10,GIF:11,FUTURE:12,CONTACT_ARRAY:13,LIVE_LOCATION:14,PROFILE_PIC:15,STICKER:16,HSM:17,PRODUCT_IMAGE:18,TEMPLATE:19,MD_APP_STATE:20,MD_HISTORY_SYNC:21,CATALOG_LINK:22,PRODUCT_LINK:23,ORDER:24,LIST:25,LIST_REPLY:26,BUTTON_MESSAGE:27,BUTTON_RESPONSE_MESSAGE:28,PRODUCT_LIST:29,BUTTON_NFM:30}),Oe=Object.freeze({REGULAR:1,FAST_FORWARD_EXIST_CHECK:2,VIDEO_EXIST_CHECK:3,PRODUCT:4,MEDIA_RETRY:5,WEB_REUPLOAD:6,THUMBNAIL:7}),we=Object.freeze({OK:1,DUPLICATE:3,ERROR_UNKNOWN:2,ERROR_REQUEST:4,ERROR_UPLOAD:5,ERROR_OOM:6,ERROR_IO:7,ERROR_NO_PERMISSIONS:8,ERROR_BAD_MEDIA:9,ERROR_INSUFFICIENT_SPACE:10,ERROR_FNF:11,ERROR_CANCEL:12,ERROR_SERVER:13,ERROR_REQUEST_TIMEOUT:14,ERROR_NOT_FINALIZED:15,ERROR_OPTIMISTIC_HASH:16,ERROR_MEDIA_CONN:17,ERROR_DNS:18,ERROR_THROTTLE:19,ERROR_SSL:20,ERROR_NO_CLIENT_NETWORK:21}),Me=Object.freeze({OTHER:0,INDIVIDUAL:1,GROUP:2,STATUS:3,BROADCAST:4}),Ie=Object.freeze({OK:1,ERROR_UNKNOWN:3,ERROR_NETWORK:4,ERROR_EXPIRED:5,ERROR_CANCELLED:6,ERROR_UPLOAD:7}),Re=Object.freeze({INDIVIDUAL:1,GROUP:2,BROADCAST:3,STATUS:4}),De=Object.freeze({NATIVE:0,OK_HTTP:1,LIGER:2,APACHE:3,WATLS:4}),Ne=Object.freeze({NONE:1,SOFTWARE:2,BUILTIN:3}),Le=Object.freeze({NONE:0,OPTIMISTIC:1,OPT_USED:2,OPT_TAKEOVER:3,OPT_DISABLED:4}),ke=Object.freeze({RESUME_CHECK:1,UPLOAD:2,FINALIZE:3}),Ue=Object.freeze({NONE_NEW_CONTENT:1,NONE_EXPIRED:2,REUSED:3}),Ge=Object.freeze({CONSUMER:1,SMB:2,ENT:3}),Fe=Object.freeze({CELLULAR:1,WIFI:2,NONE:3}),xe=Object.freeze({OTHER:0,ADD:1,VIEW:2,POPULATE:3}),Be=Object.freeze({OTHER:0,INDIVIDUAL:1,GROUP:2,STATUS:3,BROADCAST:4}),Ye=Object.freeze({OTHER:0,CIPHERTEXT:1,FANOUT:2,DOWNGRADE:3}),Ke=Object.freeze({IPHONE:1,ANDROID:2,BB:3,BBX:7,S40:4,SYMBIAN:5,WP:6,WEBCLIENT:8,OSMETA:11,ENT:12,SMBA:13,KAIOS:14,SMBI:15,WINDOWS:16,WEB:17,PORTAL:18,BLOKS:19,BLUEA:20,BLUEI:21,FBLITEA:22,GREENA:23,GREENI:24,IGDA:25,IGDI:26,IGLITEA:27,MLITEA:28,MSGRA:29,MSGRI:30,MSGRP:31,MSGRW:32,IGDW:33,PAGE:34,MSGRDM:35,MSGRDW:36,MSGROM:37,MSGROC:38,TEST:9,UNKNOWN:10}),je=Object.freeze({SPEED_1:0,SPEED_1_5:1,SPEED_2:2}),We=Object.freeze({AUDIO_QUEUE:0,AVPLAYER:1,AVAUDIOPLAYER:2,OPUSPLAYER:3,ANDROIDPLAYER:4,EXOPLAYER:5}),He=Object.freeze({SENT:1,CANCELLED:2,TOO_SHORT:3}),Ve=Object.freeze({FROM_CONVERSATION:0,FROM_VOICEMAIL:1}),$e=Object.freeze({UNKNOWN:0,AAC:1,MP3:2,AMR_NB:3,AMR_WB:4,OPUS:5,MULTIPLE_TRACKS:6}),qe=Object.freeze({MANUAL:0,SEQUENTIAL:1}),ze=Object.freeze({STICKER_STORE_DATA:0,PREVIEW_IMAGE_DOWNLOAD:1,STICKER_PACK_DATA:2,STICKER_SEARCH:3}),Je=Object.freeze({ACTION_SETTINGS_IMPRESSION:1,ACTION_SETTINGS_ADD_CLICK:2,ACTION_SETTINGS_ADD_ABANDONED:3,ACTION_SETTINGS_ADDED:4,ACTION_SETTINGS_DELETED:5,ACTION_CHAT_IMPRESSION:6,ACTION_CHAT_CLICK:7,ACTION_SETTINGS_EDITED:8,ACTION_CHAT_INVALID_ATTACHMENTS:9,ACTION_SETTINGS_INVALID_ATTACHMENTS:10,ACTION_SETTINGS_MEDIA_TRANSCODE:11,ACTION_CHAT_CLICK_CANCEL:12}),Qe=Object.freeze({UNKNOWN:0,CONVERSATIONS:1,BUTTON:2,KEYBOARD:3}),Xe=Object.freeze({QUICK_REPLY_TRANSCODE_RESULT_OK:1,QUICK_REPLY_TRANSCODE_RESULT_CANCELLED:2,QUICK_REPLY_TRANSCODE_RESULT_FAIL_IMAGE_UNKNOWN:3,QUICK_REPLY_TRANSCODE_RESULT_FAIL_IMAGE_ENCODING:4,QUICK_REPLY_TRANSCODE_RESULT_FAIL_IMAGE_FILE_COPY:5,QUICK_REPLY_TRANSCODE_RESULT_FAIL_VIDEO_UNKNOWN:6}),Ze=Object.freeze({CELLULAR_UNKNOWN:0,WIFI_UNKNOWN:1,CELLULAR_EDGE:100,CELLULAR_IDEN:101,CELLULAR_UMTS:102,CELLULAR_EVDO:103,CELLULAR_GPRS:104,CELLULAR_HSDPA:105,CELLULAR_HSUPA:106,CELLULAR_HSPA:107,CELLULAR_CDMA:108,CELLULAR_1XRTT:109,CELLULAR_EHRPD:110,CELLULAR_LTE:111,CELLULAR_HSPAP:112}),et=Object.freeze({CALLS_TAB:1,GROUP_CALL_UI:2,ATTACHMENT:3,WEB_MENU:4}),tt=Object.freeze({STATIC:0,SHARED:1}),rt=Object.freeze({STICKER_SEARCH:1,FORWARD:2,STICKER_PICKER_TAB_RECENTS:3,STICKER_PICKER_TAB_FAVORITES:4,STICKER_PICKER_TAB_EMOTION:5,STICKER_PICKER_TAB_PACK:6,STICKER_PICKER_TAB_CONTEXTUAL_SUGGESTIONS:7}),at=Object.freeze({NONE:1,SPEEX:2,WEBRTC:3,MWEBRTC:4,ECHOSUPPRESSOR:5}),it=Object.freeze({OTHER:1,APP_OPEN:2,CHAT_OPEN:3,IMAGE_OPEN:4,FIRST_FTS_RESULT:5,CONTACTS_OPEN:6}),nt=Object.freeze({UNKNOWN:1,CHAT_PERSONAL:2,CHAT_GROUP:3,STATUS_USER:4,PRODUCT_CATALOG:5,STICKER_WEB:6,PAYMENTS_KYC:7,MESSAGE_HISTORY_SYNC:8}),st=Object.freeze({SUCCESS:0,UNKNOWN_ERROR:1,INVALID_ARGS:2,HTTP_ERROR:3,INVALID_RESPONSE:4,MEM_ALLOC_ERROR:5,NO_DEVICE_FOUND:6,NO_IGD_FOUND:7,NOT_ON_WIFI:100,TOO_MANY_PORTS:101,TIMEOUT:102,ERR_CODE_INVALID_ACTION:401,ERR_CODE_INVALID_ARGS:402,ERR_CODE_ACTION_FAILED:501,ERR_CODE_ACTION_NOT_AUTHORIZED:606,ERR_CODE_PINHOLE_SPACE_EXHAUSTED:701,ERR_CODE_FIREWALL_DISABLED:702,ERR_CODE_INBOUND_PINHOLE_NOT_ALLOWED:703,ERR_CODE_NO_SUCH_ENTRY:704,ERR_CODE_PROTOCOL_NOT_SUPPORTED:705,ERR_CODE_INTERNAL_PORT_WILDCARD_NOT_ALLOWED:706,ERR_CODE_PROTOCOL_WILDCARD_NOT_ALLOWED:707,ERR_CODE_WILDCARD_NOT_PERMITTED_IN_SRC_IP:708,ERR_CODE_NO_PACKET_SENT:709,ERR_CODE_SPECIFIED_ARRAY_INDEX_INVALID:713,ERR_CODE_NO_SUCH_ENTRY_IN_ARRAY:714,ERR_CODE_WILD_CARD_NOT_PERMITTED_IN_SRC_IP:715,ERR_CODE_WILD_CARD_NOT_PERMITTED_IN_EXT_PORT:716,ERR_CODE_CONFLICT_IN_MAPPING_ENTRY:718,ERR_CODE_SAME_PORT_VALUES_REQUIRED:724,ERR_CODE_ONLY_PERMANENT_LEASES_SUPPORTED:725,ERR_CODE_REMOTE_HOST_ONLY_SUPPORTS_WILDCARD:726,ERR_CODE_EXTERNAL_PORT_ONLY_SUPORTS_WILDCARD:727,ERR_CODE_NO_PORT_MAPS_AVAILABLE:728,ERR_CODE_CONFLICT_WITH_OTHER_MECHANISMS:729,ERR_CODE_WILD_CARD_NOT_PERMITTED_IN_INT_PORT:732,DISABLED:999}),ot=Object.freeze({SUCCESS:0,UNKNOWN_ERROR:1,INVALID_ARGS:2,HTTP_ERROR:3,INVALID_RESPONSE:4,MEM_ALLOC_ERROR:5,NO_DEVICE_FOUND:6,NO_IGD_FOUND:7,NOT_ON_WIFI:100,TIMEOUT:102,ERR_CODE_INVALID_ACTION:401,ERR_CODE_INVALID_ARGS:402,ERR_CODE_ACTION_FAILED:501,ERR_CODE_ACTION_NOT_AUTHORIZED:606,ERR_CODE_WILD_CARD_NOT_PERMITTED_IN_SRC_IP:715,ERR_CODE_WILD_CARD_NOT_PERMITTED_IN_EXT_PORT:716,ERR_CODE_NO_PORT_MAPS_AVAILABLE:728,ERR_CODE_CONFLICT_WITH_OTHER_MECHANISMS:729,ERR_CODE_WILD_CARD_NOT_PERMITTED_IN_INT_PORT:732,DISABLED:999}),lt=Object.freeze({INVALID_STANZA:1,JSON_FETCH:2,JSON_PARSE:3,IMAGE_FETCH:4}),dt=Object.freeze({BANNER_APPEAR:1,BANNER_SELECT:2,MODAL_APPEAR:3,MODAL_DISMISS:4,MODAL_LINK_FOLLOW:5,MODAL_ACCEPT:6,BLOCKING_MODAL_APPEAR:7,BLOCKING_MODAL_LINK_FOLLOW:8,BLOCKING_MODAL_ACCEPT:9,BANNER_DISMISS:10,EDUCATION_1_APPEAR:11,EDUCATION_1_DISMISS:12,EDUCATION_1_CONTINUE:13,MODAL_BACK:14,BLOCKING_MODAL_BACK:15}),ut=Object.freeze({ACTION_IMPRESSION:1,ACTION_CLICK_WEBSITE:2,ACTION_CLICK_LOCATION:3,ACTION_CLICK_HOURS:4,ACTION_CLICK_DESCRIPTION:5,ACTION_CLICK_EMAIL:6,ACTION_CLICK_ADDTOCONTACT:7,ACTION_CLICK_MORE_BIZ_PROFILE:8,ACTION_CLICK_MESSAGE:9,ACTION_CLICK_VOICE_CALL:10,ACTION_CLICK_VIDEO_CALL:11,ACTION_CLICK_FORWARD:12,ACTION_CLICK_CATALOG_ICON:13,ACTION_CLICK_SHOPS_ICON:14}),ct=Object.freeze({STATIC:0,SHARED:1}),pt=Object.freeze({INVALID:0,NOT_SINGLE_SEGMENT_CALL:1,NOT_START_FROM_VIDEO_CALL:2,HAS_AV_SWITCH:3,SELF_CAMERA_OFF:4,PEER_CAMERA_OFF:5,SELF_HAS_NETWORK_TRANSITION:6,PEER_HAS_NETWORK_TRANSITION:7,CALL_TOO_SHORT:8,PASS:100}),ht=Object.freeze({UNCACHED:0,IDLE:1,CHECKING:2,DOWNLOADING:3,UPDATEREADY:4,OBSOLETE:5}),ft=Object.freeze({UNCACHED:0,IDB:1,SW:2}),_t=Object.freeze({INDIVIDUAL:0,GROUP:1,BROADCAST_LIST:2}),mt=Object.freeze({WEBCRYPTO:0,CRYPTOJS:1}),gt=Object.freeze({ENCRYPT:0,DECRYPT:1}),vt=Object.freeze({PROD:0,INTERN:1,DEV:2}),Et=Object.freeze({SUCCESS:0,SILENCE:1,ZEROWIDTH:2}),yt=Object.freeze({DOWNLOAD:1,UPLOAD:2}),St=Object.freeze({OTHER:0,RESOLVED:1,NEEDS_RMR:2}),Tt=Object.freeze({NEW_GROUP:1,CREATE_A_ROOM:2,PROFILE:3,CATALOG:4,ARCHIVED:5,STARRED:6,LABELS:7,SETTINGS:8,LOG_OUT:9,CONTACT_INFO:10,SELECT_MESSAGES:11,CLOSE_CHAT:12,MUTE_NOTIFICATIONS:13,CLEAR_MESSAGES:14,DELETE_CHAT:15,REPORT_BUSINESS:16,BLOCK:17,SETTINGS_NOTIFICATIONS:18,SETTINGS_THEME:19,SETTINGS_CHAT_WALLPAPER:20,SETTINGS_BLOCKED:21,SETTINGS_HELP:22,OPEN:23,CLOSE:24}),At=Object.freeze({THREADS_SCREEN_CLICK:1,CHAT_SCREEN_CLICK:2,SETTINGS_SCREEN_CLICK:3}),bt=Object.freeze({LOAD_PREV:0,LOAD_NEXT:1,LOAD_AROUND:2}),Ct=Object.freeze({NAVIGATE_NEXT:0,RELOAD:1,BACK_FORWARD:2,UNDEFINED:255}),Pt=Object.freeze({UNKNOWN:0,USER_SCROLL:1,NEW_MESSAGE_PREFETCH:2,SEARCH_RESULT_CLICK:3}),Ot=Object.freeze({OTHER:0,MSG_CLICK:1,STICKER_PANEL_ICON:2,MEDIA_VIEWER:3,VIDEO_STREAMING:4,STATUS_V3:5,MULTI_SELECT_DOWNLOAD:6,DOCUMENT_DOWNLOAD:7,PIP:8,STICKER_PANEL_STICKER:9,SEND_TO_CHAT:10,UPLOAD:11,MSG_INIT:12,MSG_UPDATE:13,MSG_DELETE:14,MSG_RENDER:15}),wt=Object.freeze({TEXT:0,URL:1,IMAGE:2,VIDEO:3,GIF:4}),Mt=Object.freeze({MY:0,RECENT:1,VIEWED:2,MUTED:3}),It=Object.freeze({QR:0,MAIN:1,SYNCING:2,OFFLINE:3,CONFLICT:4,PROXYBLOCK:5,TOS_BLOCK:6,SMB_TOS_BLOCK:7,DEPRECATED_VERSION:8}),Rt=Object.freeze({PHONE:0,SERVER:1}),Dt=Object.freeze({GET:0,SET:1}),Nt=Object.freeze({WEB:1,WIN32:2,DARWIN:3,IOS_TABLET:4,ANDROID_TABLET:5,WINSTORE:6,MACSTORE:7,DARWIN_BETA:8,WIN32_BETA:9}),Lt=Object.freeze({SOURCE_OTHER:1,SOURCE_INSTAGRAM:2}),kt=Object.freeze({DISCONNECTED:1,CONNECTING:2,CONNECTED:3,UNKNOWN:4}),Ut=Object.freeze({DISABLED:0,ALLOC:1,ALLOC_AND_RTP:2}),Gt=(0,n.defineGlobal)({appVersion:[17,d],browser:[779,d],browserVersion:[295,d],datacenter:[2795,d],deviceName:[13,d],deviceVersion:[4505,d],mcc:[5,o],mnc:[3,o],networkIsWifi:[23,s],platform:[11,Ke],webcBucket:[875,d],webcEnv:[633,vt],webcNativeAutolaunch:[1009,s],webcNativeBetaUpdates:[1007,s],webcPhoneAppVersion:[1005,d],webcPhoneCharging:[783,s],webcPhoneDeviceManufacturer:[829,d],webcPhoneDeviceModel:[831,d],webcPhoneOsBuildNumber:[833,d],webcPhoneOsVersion:[835,d],webcPhonePlatform:[707,Ke],webcTabId:[3727,d],webcWebArch:[6605,d],webcWebDeviceManufacturer:[6599,d],webcWebDeviceModel:[6601,d],webcWebOsReleaseNumber:[6603,d],webcWebPlatform:[899,Nt]});(0,n.defineEvents)({ArchiveSettings:[2788,{keepChatsArchived:[1,s]},[1,1,1]],BannerEvent:[1578,{bannerOperation:[2,v],bannerType:[1,E]},[1,1,1]],Call:[462,{acceptAckLatencyMs:[1016,u],acceptedButNotConnectedTimeSpentMs:[1015,u],activeRelayProtocol:[412,o],allocErrorBitmap:[593,o],androidAudioRouteMismatch:[1055,s],androidCamera2MinHardwareSupportLevel:[444,h],androidCameraApi:[443,f],androidSystemPictureInPictureT:[477,u],androidTelecomTimeSpentBeforeReject:[497,u],audioCodecDecodedFecFrames:[755,o],audioCodecDecodedPlcFrames:[756,o],audioCodecEncodedFecFrames:[751,o],audioCodecEncodedNonVoiceFrames:[753,o],audioCodecEncodedVoiceFrames:[752,o],audioCodecReceivedFecFrames:[754,o],audioDeviceIssues:[860,o],audioDeviceLastIssue:[861,o],audioDeviceSwitchCount:[867,o],audioDeviceSwitchDuration:[866,u],audioFrameLoss1xMs:[724,u],audioFrameLoss2xMs:[725,u],audioFrameLoss4xMs:[726,u],audioFrameLoss8xMs:[727,u],audioGetFrameUnderflowPs:[83,o],audioInbandFecDecoded:[679,o],audioInbandFecEncoded:[678,o],audioLossPeriodCount:[722,o],audioNackReqPktsRecvd:[646,o],audioNackReqPktsSent:[645,o],audioNackRtpRetransmitDiscardCount:[649,o],audioNackRtpRetransmitFailCount:[651,o],audioNackRtpRetransmitRecvdCount:[648,o],audioNackRtpRetransmitReqCount:[647,o],audioNackRtpRetransmitSentCount:[650,o],audioNumPiggybackRxPkt:[1008,o],audioNumPiggybackTxPkt:[1007,o],audioPlayCbLatencyAvg:[1032,o],audioPlayCbLatencyMax:[1031,o],audioPlayCbLatencyMin:[1030,o],audioPlayCbLatencyStddev:[1033,o],audioPutFrameOverflowPs:[82,o],audioRecCbLatencyAvg:[1036,o],audioRecCbLatencyMax:[1035,o],audioRecCbLatencyMin:[1034,o],audioRecCbLatencyStddev:[1037,o],audioRtxPktDiscarded:[677,o],audioRtxPktProcessed:[676,o],audioRtxPktSent:[675,o],audioRxAvgFpp:[728,l],audioRxPktLossPctDuringPip:[642,l],audioTotalBytesOnNonDefCell:[450,l],avAvgDelta:[192,l],avMaxDelta:[193,l],aveNumPeersAutoPaused:[578,o],aveTimeBwResSwitches:[994,u],aveTimeBwVidRcDynCondTrue:[719,u],avgClockCbT:[139,u],avgDecodeT:[136,u],avgDiffAudioVideoFrameT:[1028,u],avgEncRestartAndKfGenT:[1048,u],avgEncRestartIntervalT:[1047,u],avgEncodeT:[135,u],avgEventQueuingDelay:[816,o],avgPlayCbT:[137,u],avgRecordCbIntvT:[495,u],avgRecordCbT:[138,u],avgRecordGetFrameT:[140,u],avgTargetBitrate:[141,l],avgTcpConnCount:[413,o],avgTcpConnLatencyInMsec:[414,u],batteryDropMatched:[355,s],batteryDropTriggered:[442,s],batteryLowMatched:[354,s],batteryLowTriggered:[441,s],batteryRulesApplied:[353,s],biDirRelayRebindLatencyMs:[843,u],biDirRelayResetLatencyMs:[844,u],builtinAecAvailable:[33,s],builtinAecEnabled:[38,s],builtinAecImplementor:[36,d],builtinAecUuid:[37,d],builtinAgcAvailable:[34,s],builtinNsAvailable:[35,s],c2DecAvgT:[302,u],c2DecFrameCount:[300,o],c2DecFramePlayed:[301,o],c2EncAvgT:[298,u],c2EncCpuOveruseCount:[299,o],c2EncFrameCount:[297,o],c2RxTotalBytes:[296,o],c2TxTotalBytes:[295,o],callAcceptFuncT:[132,u],callAecMode:[39,c],callAecOffset:[42,o],callAecTailLength:[43,o],callAgcMode:[52,p],callAndrGcmFgEnabled:[268,s],callAndroidAudioMode:[55,o],callAndroidRecordAudioPreset:[57,o],callAndroidRecordAudioSource:[56,o],callAudioEngineType:[54,m],callAudioRestartCount:[96,l],callAudioRestartReason:[97,l],callAvgAudioRxPipBitrate:[640,l],callAvgRottRx:[259,u],callAvgRottTx:[258,u],callAvgRtt:[107,u],callAvgVideoRxPipBitrate:[638,l],callBatteryChangePct:[195,l],callCalculatedEcOffset:[50,o],callCalculatedEcOffsetStddev:[51,o],callCreatorHid:[505,d],callDefNetwork:[405,b],callEcRestartCount:[99,l],callEchoEnergy:[46,l],callEchoLikelihood:[44,o],callEchoLikelihoodBeforeEc:[47,l],callEndFuncT:[130,u],callEndReconnecting:[70,s],callEndReconnectingBeforeNetworkChange:[877,s],callEndReconnectingBeforeP2pFailover:[875,s],callEndReconnectingBeforeRelayFailover:[869,s],callEndReconnectingBeforeRelayReset:[948,s],callEndReconnectingSoonAfterCallActive:[848,s],callEndReconnectingSoonAfterNetworkChange:[878,s],callEndReconnectingSoonAfterP2pFailover:[876,s],callEndReconnectingSoonAfterRelayFailover:[870,s],callEndReconnectingSoonAfterRelayReset:[949,s],callEndedDuringAudFreeze:[518,s],callEndedDuringVidFreeze:[517,s],callEndedInterrupted:[23,s],callEnterPipModeCount:[626,o],callFromUi:[2,A],callHistEchoLikelihood:[45,l],callInitialRtt:[109,u],callInterrupted:[22,s],callIsLastSegment:[388,s],callLastRtt:[108,u],callMaxRtt:[106,u],callMessagesBufferedCount:[422,o],callMinRtt:[105,u],callNetwork:[76,b],callNetworkSubtype:[77,o],callNsMode:[53,Ne],callOfferAckTimout:[159,l],callOfferDelayT:[243,u],callOfferElapsedT:[102,u],callOfferFanoutCount:[588,o],callOfferReceiptDelay:[134,u],callP2pAvgRtt:[457,u],callP2pDisabled:[18,s],callP2pMinRtt:[456,u],callPeerAppVersion:[15,d],callPeerIpStr:[10,d],callPeerIpv4:[8,o],callPeerPlatform:[5,d],callPendingCallsAcceptedCount:[501,o],callPendingCallsCount:[498,o],callPendingCallsRejectedCount:[499,o],callPendingCallsTerminatedCount:[500,o],callPipMode10sCount:[628,o],callPipMode10sT:[633,u],callPipMode120sCount:[631,o],callPipMode120sT:[636,u],callPipMode240sCount:[632,o],callPipMode240sT:[637,u],callPipMode30sCount:[629,o],callPipMode30sT:[634,u],callPipMode60sCount:[630,o],callPipMode60sT:[635,u],callPipModeT:[627,u],callPlaybackBufferSize:[59,o],callPlaybackCallbackStopped:[25,s],callPlaybackFramesPs:[93,l],callPlaybackSilenceRatio:[95,l],callRadioType:[231,Ze],callRandomId:[529,d],callRecentPlaybackFramesPs:[94,l],callRecentRecordFramesPs:[29,l],callReconnectingStateCount:[438,o],callRecordBufferSize:[58,o],callRecordCallbackStopped:[24,s],callRecordFramesPs:[28,o],callRecordMaxEnergyRatio:[98,l],callRecordSilenceRatio:[26,o],callRejectFuncT:[131,u],callRelayAvgRtt:[455,u],callRelayBindStatus:[16,C],callRelayCreateT:[104,u],callRelayMinRtt:[454,u],callRelayServer:[17,d],callResult:[63,P],callRingingT:[103,u],callRxAvgBitrate:[121,l],callRxAvgBwe:[122,l],callRxAvgJitter:[125,u],callRxAvgLossPeriod:[128,u],callRxMaxJitter:[124,u],callRxMaxLossPeriod:[127,u],callRxMinJitter:[123,u],callRxMinLossPeriod:[126,u],callRxPktLossPct:[120,l],callRxPktLossRetransmitPct:[892,l],callRxStoppedT:[100,u],callSamplingRate:[30,o],callSegmentIdx:[389,o],callSegmentType:[393,O],callSelfIpStr:[9,d],callSelfIpv4:[7,o],callServerNackErrorCode:[68,o],callSetupErrorType:[71,w],callSetupT:[101,u],callSide:[1,M],callSoundPortFuncT:[133,u],callStartFuncT:[129,u],callSwAecMode:[41,o],callSwAecType:[40,at],callT:[92,u],callTermReason:[69,I],callTestBucket:[19,d],callTestEvent:[318,o],callTonesDetectedInRecord:[49,o],callTonesDetectedInRingback:[48,o],callTransitionCount:[78,o],callTransitionCountCellularToWifi:[432,o],callTransitionCountWifiToCellular:[431,o],callTransport:[72,R],callTransportExtrayElected:[515,s],callTransportP2pToRelayFallbackCount:[80,o],callTransportPeerTcpUsed:[587,s],callTransportRelayToRelayFallbackCount:[79,o],callTransportTcpFallbackToUdp:[516,s],callTransportTcpUsed:[514,s],callTxAvgBitrate:[112,l],callTxAvgBwe:[113,l],callTxAvgJitter:[116,u],callTxAvgLossPeriod:[119,u],callTxMaxJitter:[115,u],callTxMaxLossPeriod:[118,u],callTxMinJitter:[114,u],callTxMinLossPeriod:[117,u],callTxPktErrorPct:[111,l],callTxPktLossPct:[110,l],callUserRate:[20,o],callWakeupSource:[156,N],calleeAcceptToDecodeT:[447,u],callerInContact:[476,s],callerOfferToDecodeT:[445,u],callerVidRtpToDecodeT:[446,u],cameraFormats:[765,o],cameraIssues:[850,o],cameraLastIssue:[851,o],cameraOffCount:[331,o],cameraPermission:[849,s],cameraPreviewMode:[322,L],cameraStartDuration:[852,u],cameraStartFailureDuration:[856,u],cameraStartMode:[233,k],cameraStartToFirstFrameT:[916,u],cameraStopDuration:[853,u],cameraStopFailureCount:[858,o],cameraSwitchCount:[855,o],cameraSwitchDuration:[854,u],cameraSwitchFailureDuration:[857,u],clampedBwe:[527,s],codecSamplingRate:[624,o],combinedE2eAvgRtt:[760,l],combinedE2eMaxRtt:[761,l],combinedE2eMinRtt:[759,l],confBridgeSamplingRate:[623,o],conservativeModeStopped:[974,s],conservativeRampUpExploringT:[743,u],conservativeRampUpHeldCount:[643,o],conservativeRampUpHoldingT:[741,u],conservativeRampUpRampingUpT:[742,u],createdFromGroupCallDowngrade:[519,s],dataLimitOnAltNetworkReached:[537,s],deviceBoard:[230,d],deviceHardware:[229,d],dtxRxByteFrameCount:[914,o],dtxRxCount:[912,o],dtxRxDurationT:[911,u],dtxRxTotalCount:[913,o],dtxTxByteFrameCount:[910,o],dtxTxCount:[619,o],dtxTxDurationT:[618,u],dtxTxTotalCount:[909,o],echoCancellationMsPerSec:[320,o],echoCancelledFrameCount:[940,o],echoEstimatedFrameCount:[941,o],echoSpeakerModeFrameCount:[987,o],encoderCompStepdowns:[81,o],endCallAfterConfirmation:[90,ie],failureToCreateAltSocket:[534,o],failureToCreateTestAltSocket:[532,o],fastplayMaxDurationMs:[1005,u],fastplayNumFrames:[1004,o],fastplayNumTriggers:[1006,o],fieldStatsRowType:[328,se],finishedDlBwe:[503,s],finishedOverallBwe:[528,s],finishedUlBwe:[502,s],freezeAheadBweCongestionCorrPct:[1051,l],freezeBweCongestionCorrPct:[1009,l],groupAcceptNoCriticalGroupUpdate:[1013,s],groupAcceptToCriticalGroupUpdateMs:[1014,u],groupCallCallerParticipantCountAtCallStart:[439,o],groupCallInviteCountSinceCallStart:[360,o],groupCallIsGroupCallInvitee:[357,s],groupCallIsLastSegment:[356,s],groupCallNackCountSinceCallStart:[361,o],groupCallReringCountSinceCallStart:[946,o],groupCallReringNackCountSinceCallStart:[947,o],groupCallSegmentIdx:[329,o],groupCallTotalCallTSinceCallStart:[358,u],groupCallTotalP3CallTSinceCallStart:[359,u],groupCallVideoMaximizedCount:[592,o],hasRestrictedSettingsForAudioCalls:[539,s],highPeerBweT:[884,u],hisBasedInitialTxBitrate:[342,o],hisInfoCouldBeUsedForInitBwe:[339,s],historyBasedBweActivated:[807,s],historyBasedBweEnabled:[806,s],historyBasedBweSuccess:[808,s],historyBasedBweVideoTxBitrate:[809,o],incomingCallUiAction:[387,le],initBweSource:[337,de],initialEstimatedTxBitrate:[244,l],isIpv6Capable:[91,s],isPendingCall:[976,s],isRejoin:[927,s],isRering:[945,s],isUpnpExternalIpPrivate:[260,s],isUpnpExternalIpTheSameAsReflexiveIp:[261,s],jbAvgDelay:[146,l],jbAvgDelayUniform:[644,l],jbAvgTargetSize:[1012,l],jbDiscards:[150,l],jbEmpties:[151,l],jbEmptyPeriods1x:[997,l],jbEmptyPeriods2x:[998,l],jbEmptyPeriods4x:[999,l],jbEmptyPeriods8x:[1e3,l],jbGets:[152,l],jbLastDelay:[149,l],jbLost:[277,l],jbLostEmptyDuringPip:[641,o],jbLostEmptyHighPeerBwePerSec:[777,l],jbLostEmptyLowPeerBwePerSec:[775,l],jbLostEmptyLowToHighPeerBwePerSec:[776,l],jbMaxDelay:[148,l],jbMinDelay:[147,l],jbNonSpeechDiscards:[846,l],jbPuts:[153,l],jbTotalEmptyPeriods:[996,l],joinableAfterCall:[895,s],joinableDuringCall:[894,s],joinableNewUi:[893,s],l1Locations:[986,d],lastConnErrorStatus:[415,o],libsrtpVersionUsed:[504,tt],longConnect:[21,s],lossOfAltSocket:[535,o],lossOfTestAltSocket:[533,o],lowDataUsageBitrate:[157,l],lowPeerBweT:[885,u],lowToHighPeerBweT:[886,u],malformedStanzaXpath:[452,d],maxEventQueueDepth:[558,o],mediaStreamSetupT:[448,u],micAvgPower:[253,o],micMaxPower:[252,o],micMinPower:[251,o],micPermission:[859,s],micStartDuration:[862,u],micStartToFirstCallbackT:[931,u],micStopDuration:[863,u],multipleTxRxRelaysInUse:[838,s],nativeSamplesPerFrame:[32,d],nativeSamplingRate:[31,d],neteqAcceleratedFrames:[653,o],neteqExpandedFrames:[652,o],networkMediumChangeLatencyMs:[995,u],numAsserts:[933,o],numConnectedParticipants:[330,o],numConnectedPeers:[1052,o],numCriticalGroupUpdateDropped:[567,o],numDirPjAsserts:[985,o],numInvitedParticipants:[1054,o],numL1Errors:[929,o],numL2Errors:[930,o],numOutOfOrderCriticalGroupUpdate:[625,o],numOutgoingRingingPeers:[1053,o],numPeersAutoPausedOnce:[577,o],numRenderSkipGreenFrame:[1029,o],numResSwitch:[993,o],numVidDlAutoPause:[574,o],numVidDlAutoResume:[576,o],numVidDlAutoResumeRejectBadAudio:[579,o],numVidRcDynCondTrue:[717,o],numVidUlAutoPause:[559,o],numVidUlAutoPauseFail:[560,o],numVidUlAutoPauseRejectHighSendingRate:[564,o],numVidUlAutoPauseRejectTooEarly:[565,o],numVidUlAutoPauseUserAction:[566,o],numVidUlAutoResume:[561,o],numVidUlAutoResumeFail:[562,o],numVidUlAutoResumeRejectAudioLqm:[563,o],numberOfProcessors:[27,o],offerAckLatencyMs:[1017,u],oibweDlProbingTime:[805,u],oibweE2eProbingTime:[802,u],oibweNotFinishedWhenCallActive:[868,s],oibweOibleProbingTime:[803,u],oibweUlProbingTime:[804,u],onMobileDataSaver:[525,s],onWifiAtStart:[540,s],oneSideInitRxBitrate:[507,o],oneSideInitTxBitrate:[506,o],oneSideMinPeerInitRxBitrate:[509,o],oneSideRcvdPeerRxBitrate:[508,s],opusVersion:[287,o],p2pSuccessCount:[522,o],pcntPoorAudLqmAfterPause:[599,l],pcntPoorAudLqmBeforePause:[598,l],pcntPoorVidLqmAfterPause:[597,l],pcntPoorVidLqmBeforePause:[596,l],peerCallNetwork:[264,Fe],peerCallResult:[66,P],peerTransport:[591,R],peerVideoHeight:[191,o],peerVideoWidth:[190,o],peerXmppStatus:[4,kt],pingsSent:[160,l],pongsReceived:[161,l],poolMemUsage:[510,o],poolMemUsagePadding:[511,o],presentEndCallConfirmation:[89,ie],previousCallInterval:[266,u],previousCallVideoEnabled:[265,s],previousCallWithSamePeer:[267,s],previousJoinNotEnded:[1001,s],probeAvgBitrate:[327,l],pushToCallOfferDelay:[158,l],rcMaxrtt:[155,l],rcMinrtt:[154,l],reconnectingStartsBeforeCallActive:[847,s],recordCircularBufferFrameCount:[84,o],reflectivePortsDiff:[162,l],relayBindFailureAltNetSwitchSuccess:[583,o],relayBindFailureAltNetSwitchTriggered:[582,o],relayBindFailureAltNetworkSwitchToCallEnd:[586,u],relayBindFailureFallbackCount:[581,o],relayBindFailureIpVersionSwitchToCallEnd:[585,u],relayBindFailureIpVersionSwitchTriggered:[584,o],relayBindTimeInMsec:[424,u],relayElectionTimeInMsec:[423,u],relayFallbackOnRxDataFromRelay:[481,o],relayFallbackOnStopRxDataOnP2p:[482,o],relayFallbackOnTransportStanzaNotification:[483,o],renderFreezeHighPeerBweT:[780,u],renderFreezeLowPeerBweT:[778,u],renderFreezeLowToHighPeerBweT:[779,u],rxProbeCountSuccess:[291,o],rxProbeCountTotal:[290,o],rxRelayRebindLatencyMs:[841,u],rxRelayResetLatencyMs:[842,u],rxTotalBitrate:[145,l],rxTotalBytes:[143,l],rxTpFbBitrate:[294,l],rxTrafficStartFalsePositive:[758,s],sbweAvgDowntrend:[963,l],sbweAvgUptrend:[962,l],sbweCeilingCongestionCount:[783,o],sbweCeilingCount:[781,o],sbweCeilingMissingRtcpCongestionCount:[786,o],sbweCeilingNoNewDataReceivedCongestionCount:[787,o],sbweCeilingPktLossCount:[782,o],sbweCeilingRttCongestionCount:[784,o],sbweCeilingZeroRttCongestionCount:[785,o],sbweHoldCount:[961,o],sbweRampDownCount:[960,o],sbweRampUpCount:[959,o],senderBweInitBitrate:[975,o],sfuAbnormalUplinkRttCount:[879,o],sfuAvgLqHqTargetBitrateDiff:[1002,l],sfuAvgTargetBitrate:[673,l],sfuAvgTargetBitrateHq:[943,l],sfuBwaAllParticipantDlBwUsedPct:[919,l],sfuBwaAllParticipantUlBwUsedPct:[918,l],sfuBwaChangeNumStreamCount:[928,o],sfuBwaSelfDlBwUsedPct:[1003,l],sfuBwaSelfUlBwUsedPct:[917,l],sfuBwaSimulcastDisabledCntReasonBattery:[920,o],sfuBwaSimulcastDisabledCntReasonNetMedium:[921,o],sfuBwaVidEncHqStreamScheduledT:[926,u],sfuBwaVidEncLqStreamScheduledT:[925,u],sfuDownlinkAvgCombinedBwe:[662,l],sfuDownlinkAvgPktLossPct:[667,l],sfuDownlinkAvgRemoteBwe:[661,l],sfuDownlinkAvgSenderBwe:[660,l],sfuDownlinkMaxPktLossPct:[668,l],sfuDownlinkMinPktLossPct:[666,l],sfuDownlinkSbweAvgDowntrend:[973,l],sfuDownlinkSbweAvgUptrend:[972,l],sfuDownlinkSbweCeilingCongestionCount:[797,o],sfuDownlinkSbweCeilingCount:[795,o],sfuDownlinkSbweCeilingMissingRtcpCongestionCount:[800,o],sfuDownlinkSbweCeilingNoNewDataReceivedCongestionCount:[801,o],sfuDownlinkSbweCeilingPktLossCount:[796,o],sfuDownlinkSbweCeilingRttCongestionCount:[798,o],sfuDownlinkSbweCeilingZeroRttCongestionCount:[799,o],sfuDownlinkSbweHoldCount:[971,o],sfuDownlinkSbweRampDownCount:[970,o],sfuDownlinkSbweRampUpCount:[969,o],sfuDownlinkSenderBweDiffStddev:[958,l],sfuDownlinkSenderBweStddev:[957,l],sfuFirstRxParticipantReportTime:[883,u],sfuFirstRxUplinkReportTime:[881,u],sfuMaxTargetBitrate:[674,l],sfuMaxTargetBitrateHq:[944,l],sfuMinTargetBitrate:[672,l],sfuMinTargetBitrateHq:[942,l],sfuPeerDownlinkStddevAllCombinedBwe:[813,l],sfuRxParticipantReportCount:[882,o],sfuRxUplinkReportCount:[880,o],sfuSimulcastAvgDecSessFlipTime:[833,u],sfuSimulcastAvgEncSchedEventUpdateTime:[837,u],sfuSimulcastBwaCandidateCnt:[923,o],sfuSimulcastBwaDownlinkBottleneckCount:[874,o],sfuSimulcastBwaUplinkBottleneckCount:[873,o],sfuSimulcastDecAvgKfRecvTimeSinceFlip:[952,u],sfuSimulcastDecAvgNumReplayedCachedPkt:[951,l],sfuSimulcastDecAvgNumSkippedCachedPkt:[950,l],sfuSimulcastDecNumNoKf:[953,o],sfuSimulcastDecSessFlipCount:[744,o],sfuSimulcastDecSessFlipErrorBitmap:[768,o],sfuSimulcastDecSessFlipErrorCount:[767,o],sfuSimulcastEncErrorBitmap:[766,o],sfuSimulcastEncSchedEventCount:[732,o],sfuSimulcastEncSchedEventErrorCount:[735,o],sfuSimulcastEncSchedEventSkipCount:[734,o],sfuSimulcastEncSchedEventSuccessUpdateCount:[733,o],sfuSimulcastMaxDecSessFlipTime:[832,u],sfuSimulcastMaxEncSchedEventUpdateTime:[836,u],sfuSimulcastMinDecSessFlipTime:[831,u],sfuSimulcastMinEncSchedEventUpdateTime:[835,u],sfuUplinkAvgCombinedBwe:[659,l],sfuUplinkAvgPktLossPct:[664,l],sfuUplinkAvgRemoteBwe:[658,l],sfuUplinkAvgRtt:[670,l],sfuUplinkAvgSenderBwe:[657,l],sfuUplinkMaxPktLossPct:[665,l],sfuUplinkMaxRtt:[671,l],sfuUplinkMinPktLossPct:[663,l],sfuUplinkMinRtt:[669,l],sfuUplinkSbweAvgDowntrend:[968,l],sfuUplinkSbweAvgUptrend:[967,l],sfuUplinkSbweCeilingCongestionCount:[790,o],sfuUplinkSbweCeilingCount:[788,o],sfuUplinkSbweCeilingMissingRtcpCongestionCount:[793,o],sfuUplinkSbweCeilingNoNewDataReceivedCongestionCount:[794,o],sfuUplinkSbweCeilingPktLossCount:[789,o],sfuUplinkSbweCeilingRttCongestionCount:[791,o],sfuUplinkSbweCeilingZeroRttCongestionCount:[792,o],sfuUplinkSbweHoldCount:[966,o],sfuUplinkSbweRampDownCount:[965,o],sfuUplinkSbweRampUpCount:[964,o],sfuUplinkSenderBweDiffStddev:[956,l],sfuUplinkSenderBweStddev:[955,l],simulcastAvgLqBitrateWhenHqEnabled:[1011,o],simulcastReplayVideoRenderFreeze2xT:[982,u],simulcastReplayVideoRenderFreeze4xT:[983,u],simulcastReplayVideoRenderFreeze8xT:[984,u],simulcastReplayVideoRenderFreezeT:[981,u],skippedBwaCycles:[748,o],skippedBweCycles:[747,o],smallCallButton:[6,s],speakerAvgPower:[250,o],speakerMaxPower:[249,o],speakerMinPower:[248,o],speakerStartDuration:[864,u],speakerStartToFirstCallbackT:[932,u],speakerStopDuration:[865,u],startedInitBweProbing:[900,s],switchToDefTriggeredByGoodDefNet:[538,o],switchToNonSfu:[750,o],switchToSfu:[749,o],symmetricNatPortGap:[257,o],systemNotificationOfNetChange:[541,o],telecomFrameworkCallStartDelayT:[440,u],timeEnc1280w:[992,u],timeEnc160w:[988,u],timeEnc320w:[989,u],timeEnc480w:[990,u],timeEnc640w:[991,u],timeOnNonDefNetwork:[530,u],timeOnNonDefNetworkPerSegment:[531,u],timeSinceLastRtpToCallEndInMsec:[715,u],timeVidRcDynCondTrue:[718,u],totalAudioFrameLossMs:[723,u],totalBytesOnNonDefCell:[449,l],totalTimeVidDlAutoPause:[575,u],totalTimeVidUlAutoPause:[573,u],trafficShaperAvgAudioQueueMs:[898,u],trafficShaperAvgQueueMs:[242,u],trafficShaperAvgVideoQueueMs:[899,u],trafficShaperMaxDelayViolations:[240,o],trafficShaperMinDelayViolations:[241,o],trafficShaperOverflowCount:[237,o],trafficShaperQueueEmptyCount:[238,o],trafficShaperQueuedAudioPacketCount:[896,o],trafficShaperQueuedPacketCount:[239,o],trafficShaperQueuedVideoPacketCount:[897,o],transportCurTimeInMsecAsyncWriteWaitingInQueue:[552,u],transportLastSendOsError:[555,o],transportNumAsyncWriteDispatched:[580,o],transportNumAsyncWriteQueued:[551,o],transportOvershoot10PercCount:[699,o],transportOvershoot20PercCount:[700,o],transportOvershoot40PercCount:[701,o],transportOvershootLongestStreakS:[708,o],transportOvershootSinceLast10sCount:[704,o],transportOvershootSinceLast15sCount:[705,o],transportOvershootSinceLast1sCount:[702,o],transportOvershootSinceLast30sCount:[706,o],transportOvershootSinceLast5sCount:[703,o],transportOvershootStreakAvgS:[709,l],transportOvershootTimeBetweenAvgS:[707,l],transportRtpSendErrorRate:[557,l],transportSendErrorCount:[556,o],transportSrtpRxMaxPktSize:[1038,o],transportSrtpRxRejectedBitrate:[763,l],transportSrtpRxRejectedDupPktCnt:[772,o],transportSrtpRxRejectedPktCnt:[762,o],transportSrtpTxFailedPktCnt:[774,o],transportSrtpTxMaxPktSize:[773,o],transportTotalNumSendOsError:[554,o],transportTotalTimeInMsecAsyncWriteQueueToDispatch:[553,u],transportUndershoot10PercCount:[710,o],transportUndershoot20PercCount:[711,o],transportUndershoot40PercCount:[712,o],triggeredButDataLimitReached:[536,o],txProbeCountSuccess:[289,o],txProbeCountTotal:[288,o],txRelayRebindLatencyMs:[839,u],txRelayResetLatencyMs:[840,u],txTotalBitrate:[144,l],txTotalBytes:[142,l],txTpFbBitrate:[293,l],upnpAddResultCode:[246,st],upnpRemoveResultCode:[247,ot],usedInitTxBitrate:[341,o],userDescription:[87,d],userProblems:[88,o],userRating:[86,o],vidAveSuccBurstyPktLossLength:[691,o],vidAveSuccNonBurstyPktLossLength:[692,o],vidCorrectRetxDetectPcnt:[688,o],vidFreezeTMsInSample0:[695,u],vidNumBurstyPktLoss:[689,o],vidNumFecDroppedNoHole:[696,o],vidNumFecDroppedTooBig:[697,o],vidNumNonBurstyPktLoss:[690,o],vidNumRetxDropped:[698,o],vidNumRxRetx:[757,o],vidPktRxState0:[693,d],vidRxFecRateInSample0:[694,l],vidUlAutoPausedAtCallEnd:[589,s],vidUlTimeSinceAutoPauseAtCallEnd:[590,u],vidWrongRetxDetectPcnt:[716,o],videoActiveTime:[276,u],videoAheadAvSyncDiscardedFramesAvgDeltaT:[1041,u],videoAheadAvSyncRenderedFramesAvgDeltaT:[1043,u],videoAheadNumAvSyncDiscardFrames:[1039,o],videoAveDelayLtrp:[484,u],videoAvgCombPsnr:[390,l],videoAvgEncodingPsnr:[410,l],videoAvgScalingPsnr:[408,l],videoAvgSenderBwe:[186,l],videoAvgTargetBitrate:[184,l],videoAvgTargetBitrateHq:[828,l],videoBehindAvSyncDiscardedFramesAvgDeltaT:[1042,u],videoBehindAvSyncRenderedFramesAvgDeltaT:[1044,u],videoBehindNumAvSyncDiscardFrames:[1040,o],videoCaptureAvgFps:[222,o],videoCaptureConverterTs:[226,u],videoCaptureDupFrames:[887,o],videoCaptureFrameOverwriteCount:[496,o],videoCaptureHeight:[228,o],videoCaptureWidth:[227,o],videoCodecScheme:[401,o],videoCodecSubType:[303,o],videoCodecType:[236,o],videoDecAvgBitrate:[220,o],videoDecAvgConsecutiveKfVp8:[610,l],videoDecAvgConsecutiveLtrpVp8:[611,l],videoDecAvgFps:[207,l],videoDecAvgFramesFromFoundLtrVp8:[612,l],videoDecAvgFramesFromUnfoundLtrVp8:[613,l],videoDecColorId:[205,o],videoDecCrcMismatchFrames:[419,o],videoDecErrorFrames:[174,o],videoDecErrorFramesCodecSwitch:[714,o],videoDecErrorFramesDuplicate:[713,o],videoDecErrorFramesH264:[680,o],videoDecErrorFramesIgnoreConsecutive:[478,o],videoDecErrorFramesOutoforder:[682,o],videoDecErrorFramesSpsPpsH264:[812,o],videoDecErrorFramesSpsPpsMissingAfterResolutionSwitch:[810,o],videoDecErrorFramesSpsPpsNotSupportedAfterResolutionSwitch:[811,o],videoDecErrorFramesVp8:[681,o],videoDecErrorLtrpFramesVp8:[462,o],videoDecErrorLtrpFramesVp8CrcMismatch:[479,o],videoDecErrorLtrpFramesVp8NoLtr:[480,o],videoDecErrorLtrpFramesVp8NoLtr10:[615,o],videoDecErrorLtrpFramesVp8NoLtr5:[614,o],videoDecInputFrames:[172,o],videoDecKeyframes:[175,o],videoDecLatency:[223,u],videoDecLatencyH264:[684,u],videoDecLatencyVp8:[683,u],videoDecLostPackets:[210,o],videoDecLtrpFramesVp8:[461,o],videoDecLtrpPoolCreateFailed:[490,s],videoDecName:[204,o],videoDecNumPliThrottledByAllLtrp:[915,o],videoDecNumSkippedFramesVp8:[616,o],videoDecNumSwitchesToAllLtrp:[617,o],videoDecOutputFrames:[173,o],videoDecRestart:[206,o],videoDecSkipPackets:[209,o],videoDecodePausedCount:[232,o],videoDowngradeCount:[273,o],videoEnabled:[163,s],videoEnabledAtCallStart:[270,s],videoEncAllLtrpTimeInMsec:[609,u],videoEncAvgBitrate:[221,o],videoEncAvgConsecutiveKfVp8:[605,l],videoEncAvgConsecutiveLtrpVp8:[606,l],videoEncAvgFps:[216,l],videoEncAvgFpsHq:[825,l],videoEncAvgFramesFromFoundLtrVp8:[604,l],videoEncAvgFramesFromUnfoundLtrVp8:[603,l],videoEncAvgPsnrKeyFrameVp8:[465,l],videoEncAvgPsnrLtrpFrameVp8:[469,l],videoEncAvgPsnrPFramePrevRefVp8:[474,l],videoEncAvgQpKeyFrameVp8:[466,l],videoEncAvgQpLtrpFrameVp8:[470,l],videoEncAvgQpPFramePrevRefVp8:[475,l],videoEncAvgSizeAllLtrpFrameVp8:[685,l],videoEncAvgSizeKeyFrameVp8:[464,l],videoEncAvgSizeLtrpFrameVp8:[468,l],videoEncAvgSizePFramePrevRefVp8:[473,l],videoEncAvgTargetFps:[215,l],videoEncAvgTargetFpsHq:[827,l],videoEncColorId:[213,o],videoEncDeviationAllLtrpFrameVp8:[686,l],videoEncDeviationPFramePrevRefVp8:[687,l],videoEncDiscardFrame:[217,o],videoEncDiscardFrameHq:[938,o],videoEncDropFrames:[179,o],videoEncDropFramesHq:[937,o],videoEncErrorFrames:[178,o],videoEncErrorFramesHq:[936,o],videoEncFatalErrorNum:[1049,o],videoEncInputFrames:[176,o],videoEncInputFramesHq:[934,o],videoEncKeyframes:[180,o],videoEncKeyframesHq:[939,o],videoEncKeyframesVp8:[463,o],videoEncKfErrCodecSwitchT:[731,u],videoEncKfIgnoreOldFrames:[729,o],videoEncKfQueueEmpty:[730,o],videoEncLatency:[224,u],videoEncLatencyHq:[826,u],videoEncLtrpFrameGenFailedVp8:[471,o],videoEncLtrpFramesVp8:[467,o],videoEncLtrpPoolCreateFailed:[491,s],videoEncLtrpToKfFallbackVp8:[494,o],videoEncModifyNum:[1050,o],videoEncName:[212,o],videoEncNumErrorLtrHoldFailedVp8:[600,o],videoEncNumErrorLtrHoldFailedVp810:[602,o],videoEncNumErrorLtrHoldFailedVp85:[601,o],videoEncNumSuccessHfFallbackVp8:[622,o],videoEncNumSwitchesToAllLtrp:[607,o],videoEncOutputFrames:[177,o],videoEncOutputFramesHq:[935,o],videoEncPFramePrevRefVp8:[472,o],videoEncRegularLtrpTimeInMsec:[608,u],videoEncRestart:[214,o],videoEncRestartPresetChange:[1046,o],videoEncRestartResChange:[1045,o],videoEncTimeOvershoot10PercH264:[363,u],videoEncTimeOvershoot10PercH265:[366,u],videoEncTimeOvershoot10PercVp8:[369,u],videoEncTimeOvershoot10PercVp9:[372,u],videoEncTimeOvershoot20PercH264:[364,u],videoEncTimeOvershoot20PercH265:[367,u],videoEncTimeOvershoot20PercVp8:[370,u],videoEncTimeOvershoot20PercVp9:[373,u],videoEncTimeOvershoot40PercH264:[365,u],videoEncTimeOvershoot40PercH265:[368,u],videoEncTimeOvershoot40PercVp8:[371,u],videoEncTimeOvershoot40PercVp9:[374,u],videoEncTimeSpentInFastH264Ms:[1026,u],videoEncTimeSpentInFasterH264Ms:[1025,u],videoEncTimeSpentInMediumH264Ms:[1027,u],videoEncTimeSpentInNegative10Vp8Ms:[1019,u],videoEncTimeSpentInNegative12Vp8Ms:[1018,u],videoEncTimeSpentInNegative4Vp8Ms:[1022,u],videoEncTimeSpentInNegative6Vp8Ms:[1021,u],videoEncTimeSpentInNegative8Vp8Ms:[1020,u],videoEncTimeSpentInSuperfastH264Ms:[1023,u],videoEncTimeSpentInVeryfastH264Ms:[1024,u],videoEncTimeUndershoot10PercH264:[375,u],videoEncTimeUndershoot10PercH265:[378,u],videoEncTimeUndershoot10PercVp8:[381,u],videoEncTimeUndershoot10PercVp9:[384,u],videoEncTimeUndershoot20PercH264:[376,u],videoEncTimeUndershoot20PercH265:[379,u],videoEncTimeUndershoot20PercVp8:[382,u],videoEncTimeUndershoot20PercVp9:[385,u],videoEncTimeUndershoot40PercH264:[377,u],videoEncTimeUndershoot40PercH265:[380,u],videoEncTimeUndershoot40PercVp8:[383,u],videoEncTimeUndershoot40PercVp9:[386,u],videoFecRecovered:[183,o],videoH264Time:[334,o],videoH265Time:[335,o],videoHeight:[189,o],videoInitRxBitrate16s:[904,l],videoInitRxBitrate2s:[901,l],videoInitRxBitrate4s:[902,l],videoInitRxBitrate8s:[903,l],videoInitialCodecScheme:[402,o],videoInitialCodecType:[321,o],videoLastCodecType:[404,o],videoLastSenderBwe:[185,l],videoMaxCombPsnr:[392,l],videoMaxEncodingPsnr:[411,l],videoMaxRxBitrate:[426,l],videoMaxScalingPsnr:[409,l],videoMaxTargetBitrate:[420,l],videoMaxTargetBitrateHq:[829,l],videoMaxTxBitrate:[425,l],videoMaxTxBitrateHq:[824,l],videoMinCombPsnr:[391,l],videoMinEncodingPsnr:[407,l],videoMinScalingPsnr:[406,l],videoMinTargetBitrate:[421,l],videoMinTargetBitrateHq:[830,l],videoNackSendDelay:[872,u],videoNewPktsBeforeNack:[871,o],videoNpsiGenFailed:[594,o],videoNpsiNoNack:[595,o],videoNumAvSyncDiscardFrames:[1010,o],videoNumH264Frames:[332,o],videoNumH265Frames:[333,o],videoPeerState:[275,D],videoPeerTriggeredPauseCount:[654,o],videoRenderAvgFps:[208,o],videoRenderConverterTs:[225,u],videoRenderDelayT:[196,u],videoRenderDupFrames:[888,o],videoRenderFreeze2xT:[304,u],videoRenderFreeze4xT:[305,u],videoRenderFreeze8xT:[306,u],videoRenderFreezeT:[235,u],videoRenderInitFreeze16sT:[908,u],videoRenderInitFreeze2sT:[905,u],videoRenderInitFreeze4sT:[906,u],videoRenderInitFreeze8sT:[907,u],videoRenderInitFreezeT:[526,u],videoRenderNumFreezes:[569,o],videoRenderNumSinceLastFreeze10s:[571,o],videoRenderNumSinceLastFreeze30s:[572,o],videoRenderNumSinceLastFreeze5s:[570,o],videoRenderSumTimeSinceLastFreeze:[568,u],videoRtcpAppRxFailed:[493,o],videoRtcpAppTxFailed:[492,o],videoRxBitrate:[169,l],videoRxBweHitTxBwe:[187,s],videoRxBytesRtcpApp:[489,l],videoRxFecBitrate:[219,l],videoRxFecFrames:[182,o],videoRxKfBeforeLtrpAfterRpsi:[485,o],videoRxLtrpFramesVp8:[460,o],videoRxNumCodecSwitch:[721,o],videoRxPackets:[201,o],videoRxPktErrorPct:[171,l],videoRxPktLossPct:[170,l],videoRxPktRtcpApp:[487,o],videoRxRtcpFir:[621,o],videoRxRtcpNack:[203,o],videoRxRtcpNpsi:[521,o],videoRxRtcpPli:[202,o],videoRxRtcpRpsi:[459,o],videoRxTotalBytes:[168,l],videoSelfState:[274,D],videoSenderBweDiffStddev:[954,l],videoSenderBweStddev:[348,l],videoTargetBitrateReaches1000kbpsT:[351,u],videoTargetBitrateReaches1500kbpsT:[435,u],videoTargetBitrateReaches2000kbpsT:[436,u],videoTargetBitrateReaches200kbpsT:[349,u],videoTargetBitrateReaches250kbpsT:[433,u],videoTargetBitrateReaches500kbpsT:[350,u],videoTargetBitrateReaches750kbpsT:[434,u],videoTotalBytesOnNonDefCell:[451,l],videoTxBitrate:[165,l],videoTxBitrateHq:[823,l],videoTxBytesRtcpApp:[488,l],videoTxFecBitrate:[218,l],videoTxFecFrames:[181,o],videoTxNumCodecSwitch:[720,o],videoTxPackets:[197,o],videoTxPacketsHq:[818,o],videoTxPktErrorPct:[167,l],videoTxPktErrorPctHq:[821,l],videoTxPktLossPct:[166,l],videoTxPktLossPctHq:[822,l],videoTxPktRtcpApp:[486,o],videoTxResendPackets:[198,o],videoTxResendPacketsHq:[819,o],videoTxRtcpFirEmptyJb:[620,o],videoTxRtcpNack:[200,o],videoTxRtcpNpsi:[520,o],videoTxRtcpPli:[199,o],videoTxRtcpPliHq:[820,o],videoTxRtcpRpsi:[458,o],videoTxTotalBytes:[164,l],videoTxTotalBytesHq:[817,l],videoUpdateEncoderFailureCount:[453,o],videoUpgradeCancelByTimeoutCount:[325,o],videoUpgradeCancelCount:[323,o],videoUpgradeCount:[272,o],videoUpgradeRejectByTimeoutCount:[326,o],videoUpgradeRejectCount:[324,o],videoUpgradeRequestCount:[271,o],videoWidth:[188,o],vpxLibUsed:[513,ct],waLongFreezeCount:[891,o],waReconnectFreezeCount:[890,o],waShortFreezeCount:[889,o],waVoipHistoryGetVideoTxBitrateResult:[845,o],waVoipHistoryGetVideoTxBitrateSuccess:[740,s],waVoipHistoryIpAddressNotAvailable:[834,s],waVoipHistoryIsCallRecordLoaded:[737,s],waVoipHistoryIsCallRecordSaved:[738,s],waVoipHistoryIsInitialized:[769,s],waVoipHistoryNumOfCallRecordFound:[771,o],waVoipHistoryNumOfCallRecordLoaded:[739,o],waVoipHistorySaveCallRecordConditionCheckStatus:[770,pt],warpHeaderRxTotalBytes:[656,l],warpHeaderTxTotalBytes:[655,l],warpRxPktErrorCount:[746,o],warpTxPktErrorCount:[745,o],weakCellularNetConditionDetected:[429,o],weakWifiNetConditionDetected:[430,o],weakWifiSwitchToDefNetSuccess:[397,o],weakWifiSwitchToDefNetSuccessByPeriodicalCheck:[395,o],weakWifiSwitchToDefNetTriggered:[396,o],weakWifiSwitchToDefNetTriggeredByPeriodicalCheck:[394,o],weakWifiSwitchToNonDefNetFalsePositive:[399,o],weakWifiSwitchToNonDefNetSuccess:[400,o],weakWifiSwitchToNonDefNetTriggered:[398,o],wifiRssiAtCallStart:[263,o],wpNotifyCallFailed:[64,o],wpSoftwareEcMatches:[65,s],xmppStatus:[3,kt],xorCipher:[269,Ut]},[1,1,1]],CatalogBiz:[1722,{cartToggle:[13,s],catalogAppealReason:[4,d],catalogBizAction:[1,U],catalogEntryPoint:[7,G],catalogSessionId:[3,d],deepLinkOpenFrom:[8,V],errorCode:[5,o],isOrderMsgAttached:[10,s],orderId:[9,d],productCount:[6,o],productId:[2,d],productIds:[12,d],quantity:[11,o]},[1,1,1]],CatalogView:[1630,{bizPlatform:[16,y],cartToggle:[15,s],catalogEntryPoint:[7,G],catalogEventSampled:[8,s],catalogOwnerJid:[6,d],catalogReportReasonCode:[4,d],catalogSessionId:[2,d],catalogViewAction:[1,F],deepLinkOpenFrom:[9,V],isNewProductAddedToCart:[13,s],isOrderMsgAttached:[10,s],orderId:[11,d],productId:[5,d],quantity:[12,o]},[1,1,1]],ChatFilterEvent:[1616,{actionType:[1,x],filterType:[2,B],sessionId:[3,o]},[1,1,1]],ContactSend:[2234,{channel:[1,W],isMultiVcard:[2,s],messageSendResult:[3,Ie],messageSendT:[4,u],vcardDataSize:[5,o]},[1,1,1]],ContactUsSession:[470,{contactUsAutomaticEmail:[3,s],contactUsExitState:[1,H],contactUsFaq:[2,s],contactUsLogs:[4,s],contactUsMenuFaqT:[12,u],contactUsOutage:[5,s],contactUsOutageEmail:[6,s],contactUsProblemDescription:[7,d],contactUsScreenshotC:[19,l],contactUsT:[11,u],languageCode:[21,d]},[1,1,1]],DeepLinkOpen:[2136,{deepLinkOpenFrom:[2,V],deepLinkType:[3,$],isContact:[4,s],linkOwnerType:[5,Ge]},[1,1,1]],E2eMessageRecv:[478,{e2eCiphertextType:[5,Z],e2eCiphertextVersion:[6,o],e2eDestination:[4,ee],e2eFailureReason:[2,te],e2eSenderType:[8,re],e2eSuccessful:[1,s],messageMediaType:[7,Pe],offline:[9,s],retryCount:[3,o]},[1,20,20]],E2eMessageSend:[476,{e2eCiphertextType:[5,Z],e2eCiphertextVersion:[6,o],e2eDestination:[4,ee],e2eFailureReason:[2,te],e2eReceiverType:[8,z],e2eSuccessful:[1,s],encRetryCount:[9,o],messageMediaType:[7,Pe],retryCount:[3,o]},[1,5,5]],E2eRetryAfterDelivery:[894,{deviceType:[4,z],messageType:[1,Re],msgRetryCount:[3,o],retryRevoke:[2,s]},[1,1,1]],EditBusinessProfile:[1466,{businessProfileEntryPoint:[10,S],editBusinessProfileSessionId:[2,d],editProfileAction:[1,ae],editProfileActionField:[9,T],hasAddress:[5,s],hasCategory:[4,s],hasDescription:[3,s],hasEmail:[7,s],hasHours:[6,s],hasWebsite:[8,s]},[1,1,1]],EphemeralMessageTime:[2742,{zombieStateDuration:[1,o]},[1,1,1]],EphemeralPurgeCount:[2744,{messageCount:[1,o]},[1,1,1]],EphemeralSettingChange:[2370,{chatEphemeralityDuration:[1,o]},[1,1,1]],ForwardSend:[1728,{e2eCiphertextType:[12,Z],e2eCiphertextVersion:[11,o],ephemeralityDuration:[18,o],fastForwardEnabled:[5,s],isFrequentlyForwarded:[14,s],mediaCaptionPresent:[10,s],messageForwardAgeT:[4,u],messageIsFanout:[6,s],messageIsFastForward:[3,s],messageIsInternational:[9,s],messageMediaType:[2,Pe],messageSendT:[13,u],messageType:[1,Re],resendCount:[8,o],retryCount:[7,o],wouldBeFrequentlyForwardedAt3:[16,s],wouldBeFrequentlyForwardedAt4:[17,s]},[1,1,1]],GifFromProviderSent:[1124,{gifSearchProvider:[1,oe]},[1,1,1]],GifSearchCancelled:[1126,{gifSearchProvider:[1,oe]},[1,1,1]],GifSearchNoResults:[1128,{gifSearchProvider:[1,oe],inputLanguageCode:[3,d],languageCode:[2,d]},[1,1,1]],GifSearchResultTapped:[1122,{gifSearchProvider:[1,oe],rank:[2,o]},[1,1,1]],GifSearchSessionStarted:[1134,{gifSearchProvider:[1,oe]},[1,1,1]],HfmTextSearchComplete:[2186,{},[1,1,1]],LabelEvent:[1422,{itemsLabeledCount:[5,o],labelCount:[4,o],labelOperation:[2,ue],labelTarget:[1,ce],predefinedLabelNumber:[3,o]},[1,1,1]],Login:[460,{androidKeystoreState:[10,_],connectionOrigin:[6,K],connectionT:[5,u],loginResult:[1,pe],loginT:[3,u],longConnect:[4,s],passive:[8,s],retryCount:[2,o],sequenceStep:[7,o],serverErrorCode:[9,o]},[1,1,1]],MdAppStateDirtyBits:[2520,{dirtyBitsFalsePositive:[2,s]},[1,20,1e3]],MdAppStateKeyRotation:[2518,{mdAppStateKeyRotationReason:[1,he]},[1,20,1e3]],MdAppStateMessageRange:[2522,{additionalMessagesCount:[1,o]},[1,20,1e3]],MdAppStateOfflineNotifications:[2602,{redundantCount:[1,o]},[1,20,1e3]],MdAppStateSyncDaily:[2300,{crossIndexConflictCount:[11,o],invalidActionCount:[4,o],keyRotationRemoveCount:[12,o],missingKeyCount:[9,o],mutationCount:[1,o],storedMutationCount:[7,o],unsetActionCount:[8,o],unsupportedActionCount:[5,o],uploadConflictCount:[10,o]},[1,1,1]],MdBadDeviceSentMessage:[2176,{dsmError:[2,X],peerType:[1,z]},[1,1,1]],MdBootstrapAppStateDataDownloaded:[2294,{mdBootstrapContactsCount:[5,o],mdBootstrapPayloadSize:[4,o],mdBootstrapPayloadType:[2,fe],mdBootstrapStepDuration:[6,o],mdBootstrapStepResult:[7,me],mdSessionId:[1,d],mdStorageQuotaBytes:[8,o],mdStorageQuotaUsedBytes:[9,o],mdTimestamp:[3,o]},[1,1,1]],MdBootstrapDataApplied:[2298,{collection:[5,Y],mdBootstrapContactsCount:[8,o],mdBootstrapPayloadType:[3,fe],mdBootstrapSource:[2,_e],mdBootstrapStepDuration:[6,o],mdSessionId:[1,d],mdTimestamp:[4,o],usedSnapshot:[7,s]},[1,1,1]],MdBootstrapHistoryDataDownloaded:[2296,{mdBootstrapChatsCount:[6,o],mdBootstrapMessagesCount:[5,o],mdBootstrapPayloadSize:[4,o],mdBootstrapPayloadType:[2,fe],mdBootstrapStepDuration:[7,o],mdBootstrapStepResult:[8,me],mdSessionId:[1,d],mdStorageQuotaBytes:[9,o],mdStorageQuotaUsedBytes:[10,o],mdTimestamp:[3,o]},[1,1,1]],MdCriticalEvent:[2746,{mdCriticalEventCode:[1,Ee]},[1,1,1]],MdDeviceSyncAck:[2180,{chatType:[1,Me],revoke:[2,s]},[1,1,1]],MdFatalError:[2304,{collection:[2,Y],mdFatalErrorCode:[1,ye]},[1,1,1]],MdLinkDeviceCompanion:[2576,{mdDurationS:[8,o],mdLinkDeviceCompanionErrorCode:[6,o],mdLinkDeviceCompanionStage:[4,ge],mdSessionId:[1,d],mdTimestampS:[7,o],mdWasUpgraded:[5,s]},[1,1,1]],MdPushnameValidation:[2302,{didWebUserChangeSyncd:[3,s],isSyncdPushnameEmpty:[2,s],matches:[1,s],validationCaller:[4,Se],validationStage:[5,ve],webPlatform:[6,Te]},[1,1,1e3]],MdRetryFromUnknownDevice:[2178,{offline:[2,s],senderType:[1,z]},[1,1,1]],MediaDownload2:[1590,{connectionType:[31,j],debugMediaException:[24,d],debugMediaIp:[22,d],debugUrl:[23,d],downloadBytesTransferred:[20,l],downloadConnectT:[15,u],downloadHttpCode:[18,o],downloadIsReuse:[17,s],downloadIsStreaming:[19,s],downloadNetworkT:[16,u],downloadQuality:[37,Q],downloadResumePoint:[14,o],downloadTimeToFirstByteT:[21,u],estimatedBandwidth:[36,l],mediaId:[38,o],networkStack:[30,De],overallAttemptCount:[4,o],overallBackendStore:[39,g],overallConnBlockFetchT:[10,u],overallConnectionClass:[29,d],overallCumT:[27,u],overallDecryptT:[12,u],overallDomain:[5,d],overallDownloadMode:[11,Ae],overallDownloadOrigin:[35,J],overallDownloadResult:[25,be],overallFileValidationT:[13,u],overallIsEncrypted:[28,s],overallIsFinal:[26,s],overallMediaSize:[7,l],overallMediaType:[1,Pe],overallMmsVersion:[6,o],overallQueueT:[9,u],overallRetryCount:[3,o],overallT:[8,u],usedFallbackHint:[40,d]},[1,1,1]],MediaPicker:[1038,{chatRecipients:[16,o],mediaPickerChanged:[4,o],mediaPickerCroppedRotated:[10,o],mediaPickerDeleted:[3,o],mediaPickerDrawing:[11,o],mediaPickerFilter:[18,o],mediaPickerLikeDoc:[19,o],mediaPickerNotLikeDoc:[20,o],mediaPickerOrigin:[14,Ce],mediaPickerOriginThirdParty:[21,s],mediaPickerSent:[2,o],mediaPickerSentUnchanged:[5,o],mediaPickerStickers:[12,o],mediaPickerT:[15,u],mediaPickerText:[13,o],mediaType:[1,Pe],statusRecipients:[17,o]},[1,1,1]],MediaUpload2:[1588,{connectionType:[43,j],debugMediaException:[34,d],debugMediaIp:[32,d],debugUrl:[33,d],estimatedBandwidth:[45,l],finalizeConnectT:[28,u],finalizeHttpCode:[31,o],finalizeIsReuse:[30,s],finalizeNetworkT:[29,u],mediaId:[46,o],networkStack:[42,De],overallAttemptCount:[4,o],overallConnBlockFetchT:[10,u],overallConnectionClass:[41,d],overallCumT:[37,u],overallCumUserVisibleT:[38,u],overallDomain:[5,d],overallIsFinal:[36,s],overallIsForward:[16,s],overallIsManual:[13,s],overallLastUploadRetryPhase:[11,ke],overallMediaKeyReuse:[40,Ue],overallMediaSize:[7,l],overallMediaType:[1,Pe],overallMmsVersion:[6,o],overallOptimisticFlag:[12,Le],overallQueueT:[9,u],overallRetryCount:[3,o],overallT:[8,u],overallTranscodeT:[15,u],overallUploadMode:[39,Oe],overallUploadOrigin:[44,nt],overallUploadResult:[35,we],overallUserVisibleT:[14,u],resumeConnectT:[17,u],resumeHttpCode:[20,o],resumeIsReuse:[19,s],resumeNetworkT:[18,u],uploadBytesTransferred:[27,l],uploadConnectT:[22,u],uploadHttpCode:[25,o],uploadIsReuse:[24,s],uploadIsStreaming:[26,s],uploadNetworkT:[23,u],uploadResumePoint:[21,o],usedFallbackHint:[47,d]},[1,1,1]],MemoryStat:[1336,{hasVerifiedNumber:[7,s],numMessages:[8,l],privateBytes:[3,l],processType:[5,d],sharedBytes:[4,l],uptime:[6,l],workingSetPeakSize:[2,l],workingSetSize:[1,l]},[1,1,1]],MessageReceive:[450,{messageIsInternational:[4,s],messageIsOffline:[5,s],messageMediaType:[2,Pe],messageReceiveT0:[6,u],messageReceiveT1:[7,u],messageType:[1,Re],mutedGroupMessage:[8,s],numOfWebUrlsInTextMessage:[3,o]},[1,1,1]],MessageSend:[854,{e2eCiphertextType:[10,Z],e2eCiphertextVersion:[9,o],ephemeralityDuration:[21,o],fastForwardEnabled:[15,s],isFromWamsys:[19,s],mediaCaptionPresent:[8,s],messageForwardAgeT:[14,u],messageIsFanout:[5,s],messageIsFastForward:[13,s],messageIsForward:[4,s],messageIsInternational:[7,s],messageMediaType:[3,Pe],messageSendOptUploadEnabled:[12,s],messageSendResult:[1,Ie],messageSendResultIsTerminal:[17,s],messageSendT:[11,u],messageType:[2,Re],resendCount:[16,o],retryCount:[6,o],stickerIsFirstParty:[18,s],thumbSize:[20,l]},[1,1,1]],PlaceholderActivity:[1980,{messageMediaType:[6,Pe],messageType:[5,Re],placeholderActionInd:[2,xe],placeholderChatTypeInd:[3,Be],placeholderTimePeriod:[4,o],placeholderTypeInd:[1,Ye]},[1,1,1]],Ptt:[458,{pttDuration:[5,u],pttLock:[4,s],pttResult:[1,He],pttSize:[3,l],pttSource:[2,Ve]},[1,1,1]],PttPlayback:[2044,{pttDuration:[12,u],pttMainThreadBlock:[7,s],pttPlayRequestT:[1,u],pttPlaybackFailed:[8,s],pttPlaybackOverallT:[4,u],pttPlaybackSpeed:[10,je],pttPlaybackSpeedCnt:[11,o],pttPlayer:[9,We],pttPlayerInitT:[2,u],pttPlayerPlayT:[3,u],pttSeekCnt:[13,o],pttTrigger:[5,qe],pttType:[6,$e]},[1,1,1]],QuickReply:[1468,{attachmentGifCount:[7,o],attachmentImageCount:[5,o],attachmentVideoCount:[6,o],quickReplyAction:[1,Je],quickReplyCount:[2,o],quickReplyKeywordCount:[3,o],quickReplyKeywordMatched:[4,s],quickReplyOrigin:[9,Qe],quickReplyTranscodeResult:[8,Xe]},[1,1,1]],RoomsCreationFlow:[2202,{entryResult:[3,q],errorReason:[2,ne],roomsEntryPoint:[1,et]},[1,1,1]],SendRevokeMessage:[1348,{messageMediaType:[2,Pe],messageType:[1,Re],revokeSendDelay:[3,o]},[1,1,1]],StickerCommonQueryToStaticServer:[2740,{httpResponseCode:[2,o],params:[3,d],queryType:[1,ze]},[1,1,1]],StickerSend:[1840,{stickerIsAnimated:[3,s],stickerIsFirstParty:[2,s],stickerSendOrigin:[1,rt]},[1,1,1]],UiAction:[472,{uiActionPreloaded:[2,s],uiActionT:[3,u],uiActionType:[1,it]},[1,1,1]],UserActivity:[1384,{userActivityBitmapHigh:[4,o],userActivityBitmapLen:[5,o],userActivityBitmapLow:[3,o],userActivitySessionCum:[7,o],userActivitySessionId:[1,d],userActivitySessionSeq:[6,o],userActivityStartTime:[2,o]},[1,1,1]],UserNotice:[2472,{userNoticeContentVersion:[2,o],userNoticeEvent:[3,dt],userNoticeId:[1,o]},[1,1,1]],UserNoticeError:[2474,{userNoticeContentVersion:[2,o],userNoticeErrorEvent:[3,lt],userNoticeId:[1,o]},[1,1,1]],ViewBusinessProfile:[1522,{businessProfileJid:[3,d],viewBusinessProfileAction:[1,ut],websiteSource:[2,Lt]},[1,1,1]],WebcAbpropsValidation:[2802,{abpropName:[1,d],abpropValue:[2,d],serverPropName:[3,d],serverPropValue:[4,d]},[1,1,1]],WebcAssetLoad:[1358,{webcAssetCacheType:[4,ft],webcAssetFromCache:[2,s],webcAssetLoadT:[3,u],webcAssetName:[1,d],webcAssetSize:[5,l]},[1,1,1]],WebcChatOpen:[864,{webcChatOpenBeforePaintT:[7,u],webcChatOpenPaintedT:[6,u],webcChatOpenT:[2,u],webcFinalRenderedMessageCount:[5,o],webcRenderedMessageCount:[4,o],webcUnreadCount:[1,l],webcWindowHeightFloat:[8,l]},[1,1,1]],WebcCryptoMedia:[1028,{webcCryptoElapsedT:[4,u],webcCryptoFileSize:[3,l],webcCryptoLibrary:[2,mt],webcCryptoType:[1,gt]},[1,1,1]],WebcDbOpen:[1940,{webcDbName:[1,d],webcDbOpenNumAttempts:[3,o],webcDbOpenWasSuccess:[2,s]},[1,1,1]],WebcEmojiOpen:[1166,{webcEmojiOpenTab:[1,d]},[1,1,1]],WebcFirstScreenEmojisLoad:[2144,{webcEmojisLoadT:[1,u],webcLoadedEmojisCount:[2,o]},[1,1,1]],WebcImgError:[1700,{webcImgErrorCode:[1,l]},[1,1,1]],WebcLogin:[1664,{webcBrowserNetworkType:[14,d],webcBrowserStorageQuotaBytes:[15,o],webcBrowserStorageQuotaUsedBytes:[16,o],webcLoginT:[3,u],webcPersistentLoginEnabled:[17,s],webcQrCodes:[1,o],webcQrLoadT:[2,u],webcSyncChatCount:[8,o],webcSyncChatSize:[10,o],webcSyncChatT:[9,u],webcSyncContactCount:[11,o],webcSyncContactSize:[13,o],webcSyncContactT:[12,u],webcSyncMessageCount:[5,o],webcSyncMessageSize:[7,o],webcSyncMessageT:[6,u],webcSyncT:[4,u]},[1,1,1]],WebcManualWebsocketAttempt:[896,{webcManualWebsocketAttemptSuccessful:[1,s]},[1,1,1]],WebcMediaAnalyzed:[912,{webcMediaAnalyzeT:[3,u],webcMediaExtensions:[2,d],webcMediaSupported:[1,s]},[1,1,1]],WebcMediaBlobCachePurge:[1956,{mediaBlobCacheItemCount:[4,o],mediaBlobCachePurgesSoFar:[3,o],mediaBlobCacheSizeLimit:[2,o],mediaBlobCacheUptimeT:[1,u]},[1,1,1]],WebcMediaErrorUnknownDetails:[2352,{mediaId:[1,o],webcMediaErrorName:[3,d],webcMediaOperation:[2,yt]},[1,1,1]],WebcMediaLoad:[1202,{webcMediaLoadResult:[2,Et],webcMediaLoadT:[1,u]},[1,1,1]],WebcMediaRender:[1898,{messageMediaType:[9,Pe],webcBrowserNetworkType:[7,d],webcBrowserStorageQuotaBytes:[10,o],webcBrowserStorageQuotaUsedBytes:[11,o],webcChatPosition:[1,o],webcChatType:[2,_t],webcMediaStage:[5,St],webcMessageIndex:[3,o],webcMessageT:[8,u]},[1,1,1]],WebcMediaRmr:[1906,{messageMediaType:[10,Pe],webcBrowserNetworkType:[2,d],webcBrowserStorageQuotaBytes:[11,o],webcBrowserStorageQuotaUsedBytes:[12,o],webcChatPosition:[1,o],webcChatType:[9,_t],webcMediaRmrError:[8,s],webcMediaRmrT:[6,u],webcMediaSize:[7,o],webcMessageIndex:[3,o],webcMessageT:[5,u],webcRmrReason:[14,Ot],webcRmrStatusCode:[13,o]},[1,1,1]],WebcMediaStorePurge:[2112,{webcBrowserStorageQuotaBytes:[1,o],webcBrowserStorageQuotaUsedBytes:[2,o],webcCurrentTimestampT:[7,u],webcMediaStoreItemCount:[5,o],webcMediaStoreQuotaBytes:[3,o],webcMediaStoreQuotaUsedBytes:[4,o],webcPurgedItemTimestampT:[6,u]},[1,1,1]],WebcMemoryStat:[1188,{hasVerifiedNumber:[12,s],jsHeapSizeLimit:[9,o],numMessages:[8,l],totalJsHeapSize:[10,o],uptime:[6,l],usedJsHeapSize:[11,o]},[1,1,1]],WebcMenu:[2504,{webcMenuAction:[2,At],webcMenuItemLabel:[3,Tt]},[1,1,1]],WebcMessageQuery:[1876,{webcAudioMessageCount:[14,o],webcBrowserNetworkType:[1,d],webcBrowserStorageQuotaBytes:[20,o],webcBrowserStorageQuotaUsedBytes:[21,o],webcChatPosition:[2,o],webcChatType:[13,_t],webcDocumentMessageCount:[16,o],webcEarliestMessageIndex:[11,o],webcEarliestMessageT:[12,u],webcMessageCount:[4,o],webcMessageQueryTrigger:[19,Pt],webcMessageQueryType:[3,bt],webcOtherMessageCount:[18,o],webcPhotoMessageCount:[7,o],webcPttMessageCount:[15,o],webcQueryT:[9,u],webcResponseBytes:[10,o],webcStickerMessageCount:[17,o],webcTextMessageCount:[5,o],webcVideoMessageCount:[6,o]},[1,1,1]],WebcMessageSend:[2072,{messageIsForward:[3,s],messageMediaType:[2,Pe],messageSendT:[4,u],messageType:[1,Re]},[1,1,1]],WebcOfflineResume:[2628,{chatThreadCount:[9,o],decryptErrorCount:[4,o],offlineMessageCount:[2,o],offlineReceiptCount:[3,o],offlineSizeBytes:[8,o],webcLastStanzaT:[10,u],webcMainScreenLoadT:[7,u],webcOfflinePreviewT:[6,u],webcPageLoadT:[1,u],webcSocketConnectT:[5,u]},[1,1,1]],WebcPageLoad:[642,{webcAppcacheStatus:[29,ht],webcCached:[30,s],webcConnectEnd:[10,u],webcConnectStart:[9,u],webcDomComplete:[19,u],webcDomContentLoadedEventEnd:[18,u],webcDomContentLoadedEventStart:[17,u],webcDomInteractive:[16,u],webcDomLoading:[15,u],webcDomainLookupEnd:[8,u],webcDomainLookupStart:[7,u],webcExeDone:[23,u],webcExeStart:[22,u],webcFetchStart:[6,u],webcInitialMountT:[38,u],webcInitialNavMountT:[39,u],webcInitialPanel:[42,d],webcInitialPanelMountStartT:[43,u],webcInitialPanelMountT:[40,u],webcInitialPanelRenderT:[46,u],webcJsLoadT:[37,u],webcLoadEventEnd:[21,u],webcLoadEventStart:[20,u],webcMainScriptEnd:[45,u],webcMainScriptStart:[44,u],webcNativeLoadT:[36,u],webcNavigation:[32,Ct],webcPageLoadT:[34,u],webcParallellyFetched:[41,s],webcQrCode:[31,s],webcRedirectCount:[33,l],webcRedirectEnd:[5,u],webcRedirectStart:[4,u],webcRequestStart:[12,u],webcResponseEnd:[14,u],webcResponseStart:[13,u],webcSecureConnectionStart:[11,u],webcUnloadEventEnd:[3,u],webcUnloadEventStart:[2,u],webcWsAttempts:[28,l],webcWsNormal:[27,u],webcWsOpening:[24,u],webcWsPairing:[25,u],webcWsSyncing:[26,u]},[1,1,1]],WebcPageResume:[884,{webcResumeCount:[1,o]},[1,1,1]],WebcPhoneDisconnected:[878,{webcPhoneBbarShownT:[2,u],webcPhoneDisconnectedT:[1,u]},[1,1,1]],WebcProgressiveImage:[2226,{webcFirstRenderScans:[1,o],webcFirstRenderT:[2,u],webcFullQualityT:[4,u],webcMidQualityT:[3,u]},[1,1,10]],WebcRawPlatforms:[2416,{webcRawPlatform:[1,d]},[1,1,1]],WebcResourceLoad:[688,{webcResourceCached:[3,s],webcResourceDuration:[2,u],webcResourceName:[1,d]},[1,1,1]],WebcStatusSession:[1880,{webcStatusMutedItemCount:[4,o],webcStatusMutedRowCount:[7,o],webcStatusRecentItemCount:[2,o],webcStatusRecentRowCount:[5,o],webcStatusSessionId:[1,o],webcStatusViewedItemCount:[3,o],webcStatusViewedRowCount:[6,o]},[1,1,1]],WebcStatusSync:[1878,{webcStatusMutedItemCount:[4,o],webcStatusMutedRowCount:[7,o],webcStatusRecentItemCount:[2,o],webcStatusRecentRowCount:[5,o],webcStatusSyncT:[1,u],webcStatusViewedItemCount:[3,o],webcStatusViewedRowCount:[6,o]},[1,1,1]],WebcStatusView:[1882,{webcStatusLoadT:[6,u],webcStatusLoaded:[4,s],webcStatusMediaType:[5,wt],webcStatusPlaybackT:[8,u],webcStatusReplyCount:[9,o],webcStatusRowIndex:[3,o],webcStatusRowSection:[2,Mt],webcStatusSessionId:[1,o],webcStatusUnread:[10,s],webcStatusViewT:[7,u]},[1,1,1]],WebcStorageStat:[1504,{webcStorageQuota:[2,o],webcStorageUsage:[1,o]},[1,1,1]],WebcStreamModeChange:[770,{webcStreamMode:[1,It]},[1,1,1]],WebcUiFreeze:[1836,{webcUiFreezeFps:[1,l],webcUiFreezeT:[2,u]},[1,1,1]],WebcWamUpload:[916,{webcAvailableBbarTp:[3,l],webcAvailableNormalTp:[4,l],webcAvailableTp:[2,l],webcTotalT:[1,u],webcUnavailableBbarTp:[6,l],webcUnavailableNormalTp:[7,l],webcUnavailableTp:[5,l]},[1,1,1]],WebcWapRequest:[2006,{webcWapRequestAckT:[3,u],webcWapRequestDestination:[6,Rt],webcWapRequestKind:[5,Dt],webcWapRequestName:[8,d],webcWapRequestRecvT:[4,u],webcWapRequestResponseSize:[2,o],webcWapRequestSize:[7,o],webcWapRequestStatus:[9,o]},[1,1,10]],WebcWasmSupport:[1374,{webcWasmSupported:[1,s]},[1,1,1]],WebcWsOpen:[740,{webcWsOpenT:[1,u]},[1,1,1]]});var Ft=(0,i.default)((0,i.default)({},n.events),{METRICS:n.metrics,Global:Gt,WamEvent:n.WamEvent,AEC_MODE:c,AGC_MODE:p,ANDROID_CAMERA2_SUPPORT_LEVEL:h,ANDROID_CAMERA_API:f,ANDROID_KEYSTORE_STATE_TYPE:_,AUDIO_ENGINE_TYPE:m,BACKEND_STORE_TYPE:g,BANNER_OPERATIONS:v,BANNER_TYPES:E,BIZ_PLATFORM:y,BUSINESS_PROFILE_ENTRY_POINT:S,BUSINESS_PROFILE_FIELD:T,CALL_FROM_UI:A,CALL_NETWORK_MEDIUM:b,CALL_RELAY_BIND_STATUS:C,CALL_RESULT_TYPE:P,CALL_SEGMENT_TYPE:O,CALL_SETUP_ERROR_TYPE:w,CALL_SIDE:M,CALL_TERM_REASON:I,CALL_TRANSPORT_TYPE:R,CALL_VIDEO_STATE:D,CALL_WAKEUP_SOURCE:N,CAMERA_PREVIEW_MODE:L,CAMERA_START_MODE_PARAMS:k,CATALOG_BIZ_ACTION:U,CATALOG_ENTRY_POINT:G,CATALOG_VIEW_ACTION:F,CHAT_FILTER_ACTION_TYPES:x,CHAT_FILTER_TYPES:B,COLLECTION:Y,CONNECTION_ORIGIN_TYPE:K,CONNECTION_TYPE:j,CONTACT_SEND_CHANNEL:W,CONTACT_US_EXIT_STATE:H,DEEP_LINK_OPEN_FROM:V,DEEP_LINK_TYPE:$,DESTINATION:q,DEVICE_TYPE:z,DOWNLOAD_ORIGIN_TYPE:J,DOWNLOAD_QUALITY_TYPE:Q,DSM_ERROR:X,E2E_CIPHERTEXT_TYPE:Z,E2E_DESTINATION:ee,E2E_FAILURE_REASON:te,E2E_SENDER_TYPE:re,EDIT_PROFILE_ACTION:ae,END_CALL_CONFIRMATION_TYPE:ie,ERROR_REASON:ne,FIELD_STATS_ROW_TYPE:se,GIF_SEARCH_PROVIDER:oe,INCOMING_CALL_UI_ACTION_TYPE:le,INIT_BWE_SOURCE:de,LABEL_OPERATIONS:ue,LABEL_TARGETS:ce,LOGIN_RESULT_TYPE:pe,MD_APP_STATE_KEY_ROTATION_REASON_CODE:he,MD_BOOTSTRAP_PAYLOAD_TYPE:fe,MD_BOOTSTRAP_SOURCE:_e,MD_BOOTSTRAP_STEP_RESULT:me,MD_LINK_DEVICE_COMPANION_STAGE:ge,MD_PUSHNAME_VALIDATION_STAGE_CODE:ve,MD_SYNCD_CRITICAL_EVENT_CODE:Ee,MD_SYNCD_FATAL_ERROR_CODE:ye,MD_VALIDATION_CALLER_CHANNEL:Se,MD_VALIDATION_WEB_PLATFORM:Te,MEDIA_DOWNLOAD_MODE_TYPE:Ae,MEDIA_DOWNLOAD_RESULT_TYPE:be,MEDIA_PICKER_ORIGIN_TYPE:Ce,MEDIA_TYPE:Pe,MEDIA_UPLOAD_MODE_TYPE:Oe,MEDIA_UPLOAD_RESULT_TYPE:we,MESSAGE_CHAT_TYPE:Me,MESSAGE_SEND_RESULT_TYPE:Ie,MESSAGE_TYPE:Re,NETWORK_STACK_TYPE:De,NS_MODE:Ne,OPTIMISTIC_FLAG_TYPE:Le,OVERALL_LAST_UPLOAD_RETRY_PHASE_TYPE:ke,OVERALL_MEDIA_KEY_REUSE_TYPE:Ue,OWNER_TYPE:Ge,PEER_CALL_NETWORK_MEDIUM:Fe,PLACEHOLDER_ACTION:xe,PLACEHOLDER_CHAT_TYPE:Be,PLACEHOLDER_TYPE:Ye,PLATFORM_TYPE:Ke,PTT_PLAYBACK_SPEED_TYPE:je,PTT_PLAYER_TYPE:We,PTT_RESULT_TYPE:He,PTT_SOURCE_TYPE:Ve,PTT_STREAM_TYPE:$e,PTT_TRIGGER_TYPE:qe,QUERY_TYPE:ze,QUICK_REPLY_ACTION:Je,QUICK_REPLY_ORIGIN:Qe,QUICK_REPLY_TRANSCODE_RESULT:Xe,RADIO_TYPE:Ze,ROOMS_ENTRY_POINT:et,SRTP_LIBRARY_VERSION:tt,STICKER_SEND_ORIGIN_TYPE:rt,SW_AEC_TYPE:at,UI_ACTION_TYPE:it,UPLOAD_ORIGIN_TYPE:nt,UPNP_ADD_RESULT_CODE:st,UPNP_REMOVE_RESULT_CODE:ot,USER_NOTICE_ERROR_EVENT:lt,USER_NOTICE_EVENT:dt,VIEW_BUSINESS_PROFILE_ACTION:ut,VPX_LIB:ct,WA_VOIP_HISTORY_SAVE_CALL_RECORD_CONDITION_CHECK_STATUS:pt,WEBC_APPCACHE_STATUS_CODE:ht,WEBC_ASSET_CACHE_TYPE_CODE:ft,WEBC_CHAT_TYPE:_t,WEBC_CRYPTO_LIBRARY_CODE:mt,WEBC_CRYPTO_TYPE_CODE:gt,WEBC_ENV_CODE:vt,WEBC_MEDIA_LOAD_RESULT_CODE:Et,WEBC_MEDIA_OPERATION_CODE:yt,WEBC_MEDIA_STAGE_TYPE:St,WEBC_MENU_ITEM_LABEL:Tt,WEBC_MENU_TYPE:At,WEBC_MESSAGE_QUERY_DIRECTION:bt,WEBC_NAVIGATION_TYPE:Ct,WEBC_QUERY_TRIGGER_TYPE:Pt,WEBC_RMR_REASON_CODE:Ot,WEBC_STATUS_MEDIA_TYPE:wt,WEBC_STATUS_ROW_SECTION:Mt,WEBC_STREAM_MODE_CODE:It,WEBC_WAP_REQUEST_DESTINATION_CODE:Rt,WEBC_WAP_REQUEST_KIND_CODE:Dt,WEBC_WEB_PLATFORM_TYPE:Nt,WEBSITE_SOURCE_TYPE:Lt,XMPP_STATUS:kt,XOR_CIPHER_MODE:Ut});t.default=Ft},12686:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.defineEvents=function(e){for(var t in e){var r,a=e[t],i=a[2];r=i[2],v({name:t,id:a[0],props:a[1],weight:r})}},t.defineGlobal=function(e){var t={},r=function(r){var a=e[r],i=f.defineGlobal(r,a[0],a[1]);t[r]={type:i.validator,set(e){this.commitOnSet&&u.default.set(i,e)}}};for(var a in e)r(a);return new((0,d.defineTypeHash)("Global",t,E))},t.events=t.WamEvent=t.metrics=t.Metric=t.TYPES=void 0;var n=i(r(82421)),s=i(r(23779)),o=i(r(35380)),l=i(r(21830)),d=(r(30939),a(r(84094))),u=i(r(61490)),c=Object.freeze({BOOLEAN:"boolean",INTEGER:"integer",NUMBER:"number",STRING:"string",TIMER:"timer"});function p(e){return"number"==typeof e&&e===Math.floor(e)}t.TYPES=c;class h{constructor(e,t,r){this.name=e,this.id=t,this.type=r,this.setValidator()}setValidator(){var e=this.type;if("object"==typeof e){var t=(0,o.default)(e);this.validator=e=>e in t}else e===c.INTEGER||e===c.TIMER?this.validator=p:this.validator=e}}t.Metric=h;var f=new class{constructor(){this.map={}}_key(e,t){return`${e}::${t}`}get(e,t){var r=this._key(e,t);return(0,l.default)(this.map[r],r)}define(e,t,r,a){var i=this._key(e,t);return i in this.map||(this.map[i]=new h(t,r,a)),this.map[i]}getGlobal(e){return this.get("Global",e)}defineGlobal(e,t,r){return this.define("Global",e,t,r)}};t.metrics=f;var _=1;class m extends d.default{constructor(){super(),this.instanceId=_++,this.eventTime=Date.now(),this.commitTime=void 0}commit(){u.default.commit(this)}setTime(e){this.eventTime=e||Date.now()}setSequenceNumber(e){this.sequenceNumber=e}}t.WamEvent=m;var g={};function v({name:e,id:t,weight:r,props:a}){var i={id:t,weight:r},o={},l=[];for(var u in a){var p=a[u],h=f.define(e,u,p[0],p[1]);o[u]=h.validator,p[1]===c.TIMER&&l.push(u)}var _=(0,d.defineTypeHash)(e,o,m);l.forEach((e=>{i["mark"+(0,s.default)(e)]=function(t){this[e]=Date.now()-this.eventTime;t&&t.showInTimeline}})),(0,n.default)(_.prototype,i),g[e]=_}t.events=g;class E extends d.default{constructor(...e){super(...e),this.commitOnSet=!0}}},34708:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.newMessageQueryEvent=function(e){return new n.default.WebcMessageQuery({webcResponseBytes:0,webcMessageCount:0,webcTextMessageCount:0,webcVideoMessageCount:0,webcPhotoMessageCount:0,webcAudioMessageCount:0,webcPttMessageCount:0,webcStickerMessageCount:0,webcDocumentMessageCount:0,webcOtherMessageCount:0,webcMessageQueryTrigger:e})},t.logMessageCounts=function(e,t){e.webcMessageCount+=t.length;for(var r=0,a=t[r];r<t.length;++r,a=t[r])switch(a.type){case s.CHAT:case s.LOCATION:case s.PAYMENT:case s.VCARD:case s.CIPHERTEXT:case s.MULTI_VCARD:case s.REVOKED:case s.OVERSIZED:e.webcTextMessageCount+=1;break;case s.IMAGE:case s.PRODUCT:e.webcPhotoMessageCount+=1;break;case s.VIDEO:e.webcVideoMessageCount+=1;break;case s.AUDIO:e.webcAudioMessageCount+=1;break;case s.PTT:e.webcPttMessageCount+=1;break;case s.STICKER:e.webcStickerMessageCount+=1;break;case s.DOCUMENT:e.webcDocumentMessageCount+=1;break;default:e.webcOtherMessageCount+=1}};var i=a(r(23045)),n=a(r(84161));var{MSG_TYPE:s}=i.default},4314:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.OfflineResumeReporter=void 0;var i=a(r(84161));var n=new class{constructor(){this.offlineResume=new i.default.WebcOfflineResume,this.offlineResume.offlineMessageCount=0,this.offlineResume.offlineReceiptCount=0,this.offlineResume.decryptErrorCount=0}logOfflineCount(e){this.offlineResume&&(this.offlineResume.offlineMessageCount=e.message,this.offlineResume.offlineReceiptCount=e.receipt)}logOfflineDecryptionErrorCount(e){this.offlineResume&&(this.offlineResume.decryptErrorCount=e)}logMainScreenLoadT(){this.offlineResume&&this.offlineResume.markWebcMainScreenLoadT()}logOfflinePreviewT(){this.offlineResume&&this.offlineResume.markWebcOfflinePreviewT()}logPageLoadT(){this.offlineResume&&this.offlineResume.markWebcPageLoadT()}logSocketConnectT(){this.offlineResume&&this.offlineResume.markWebcSocketConnectT()}commit(){var e=this.offlineResume;e&&(__LOG__(2)`======== offline resume perf ========
message: ${e.offlineMessageCount}
receipt: ${e.offlineReceiptCount}
decryptError: ${e.decryptErrorCount}
pageLoadT: ${e.webcPageLoadT}
connectionT: ${e.webcSocketConnectT}
offlinePreviewT: ${e.webcOfflinePreviewT}
screenLoadT: ${e.webcMainScreenLoadT}
======================================`,e.commit(),this.offlineResume=null)}};t.OfflineResumeReporter=n},35407:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.streamInfoChange=function(e,t,r){var a=Math.floor(window.performance.now());_[e]=a,r&&(_.socketSequence=t,o())},t.saveInitialPanelMountTime=function(e){n=e},t.setInitialScreen=function(e){if(null==f)return;f.set({webcInitialPanel:e})},t.onInitialRenderComplete=function(){s()},t.PageLoad=t.initialScreenTimer=t.mainScriptTimer=t.exeTimer=void 0;var n,s,o,l=i(r(84161)),d=i(r(21830)),u=a(r(30939)),c=i(r(35342)),p=i(r(61490)),h=r(61585),f=new l.default.WebcPageLoad,_={},m=new Promise((e=>s=e)),g=new Promise((e=>o=e)),v=!1;function E(e){return window.performance&&window.performance.timing&&window.performance.timing.navigationStart?e-window.performance.timing.navigationStart:null}function y(){if(window.performance&&window.performance.timing&&window.performance.navigation){if(f){var e=f,t=window.performance.timing,r=window.performance.navigation,a=t.navigationStart,i=t.loadEventEnd-a;if(i<=0)return __LOG__(2)`MetricReporter:logPageLoad delayed`,void setTimeout(y,1e4);e.set({webcPageLoadT:i,webcUnloadEventStart:s("unloadEventStart"),webcUnloadEventEnd:s("unloadEventEnd"),webcRedirectStart:s("redirectStart"),webcRedirectEnd:s("redirectEnd"),webcFetchStart:s("fetchStart"),webcDomainLookupStart:s("domainLookupStart"),webcDomainLookupEnd:s("domainLookupEnd"),webcConnectStart:s("connectStart"),webcConnectEnd:s("connectEnd"),webcSecureConnectionStart:s("secureConnectionStart"),webcRequestStart:s("requestStart"),webcResponseStart:s("responseStart"),webcResponseEnd:s("responseEnd"),webcDomLoading:s("domLoading"),webcDomInteractive:s("domInteractive"),webcDomContentLoadedEventStart:s("domContentLoadedEventStart"),webcDomContentLoadedEventEnd:s("domContentLoadedEventEnd"),webcDomComplete:s("domComplete"),webcLoadEventStart:s("loadEventStart"),webcLoadEventEnd:s("loadEventEnd"),webcCached:t.fetchStart===t.domainLookupEnd,webcNavigation:r.type,webcRedirectCount:r.redirectCount,webcWsOpening:_.OPENING,webcWsPairing:_.PAIRING,webcWsSyncing:_.SYNCING,webcWsNormal:_.NORMAL,webcWsAttempts:_.socketSequence,webcQrCode:!_.SYNCING,webcParallellyFetched:window.PARALLEL_FETCH_SCRIPT,webcInitialPanelMountT:n-a}),e.commit(),f=null}}else __LOG__(2)`MetricReporter:logPageLoad metrics not provided by browser!`;function s(e){var r=t[e];return r&&E(r)}}Promise.all([m,g]).then((()=>{y(),(0,c.default)(),(0,h.logWasmSupport)(),v||(v=!0,p.default.resumeJobs())}));class S{constructor(e){this._hasStarted=!1,this._label=e.label,this._startProperty=e.startProperty,this._endProperty=e.endProperty}start(){this._hasStarted=!0,null!=f&&(f.set({[this._startProperty]:E(Date.now())}),this._measure=u.startMeasure(this._label))}end(){null!=f&&(f.set({[this._endProperty]:E(Date.now())}),(0,d.default)(this._measure,"this._measure").end())}hasStarted(){return this._hasStarted}}var T=new S({label:"PageLoad.webcExe",startProperty:"webcExeStart",endProperty:"webcExeDone"});t.exeTimer=T;var A=new S({label:"PageLoad.webcMainScript",startProperty:"webcMainScriptStart",endProperty:"webcMainScriptEnd"});t.mainScriptTimer=A;var b=new S({label:"PageLoad.webcInitialPanelRender",startProperty:"webcInitialPanelMountStartT",endProperty:"webcInitialPanelRenderT"});t.initialScreenTimer=b;var C=(0,d.default)(f,"_PageLoad");t.PageLoad=C},19870:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=new class{constructor(){this._resetNextSet=!1,this._value=0}get(){return this._value}_checkReset(){this._resetNextSet&&(this._resetNextSet=!1,this._value=0,this.initialDisplayDate=null)}inc(){return this._checkReset(),this.set(this._value+1)}set(e){if(this._checkReset(),this._value!==e)return 1===e&&(this.initialDisplayDate=Math.floor(window.performance.now())),this._value=e,this.get()}reset(){this._resetNextSet=!0}};t.default=r},35342:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){if(!(window.performance&&window.performance.timing&&window.performance.getEntriesByType))return void __LOG__(2)`MetricReporter:logResourceLoads metrics not provided by browser!`;var e=window.performance.timing.fetchStart===window.performance.timing.domainLookupEnd,t=window.performance.getEntriesByType("resource"),r=document.createElement("a");t.forEach((function(t){"xmlhttprequest"!==t.initiatorType&&(r.href=t.name,new i.default.WebcResourceLoad({webcResourceName:r.pathname+r.search+r.hash,webcResourceDuration:Math.round(t.duration),webcResourceCached:e}).commit())}))};var i=a(r(84161))},84094:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.defineTypeHash=function(e,t,i){var n={$className:{value:e}};for(var s in t){var o=t[s];if("string"!=typeof o&&"function"!=typeof o||(o={type:o}),!o||"object"!=typeof o)throw new Error(`${e} specified with non-object ${o}`);n[s]={enumerable:!0,get:r(s),set:a(s,o)}}class l extends i{constructor(e){super(),this.all={},e&&this.set(e)}}return Object.defineProperties(l.prototype,n),l},t.default=void 0;function r(e){return function(){return this.all[e]}}function a(e,t){var r=t.type,a=t.set;return function(t){if(t!==this.all[e]){if(null==t);else if("function"==typeof r){if(!r(t))throw new TypeError(`${this.$className}.${e} type-validator fails ${t}`)}else if(typeof t!==r)throw new TypeError(`${this.$className}.${e} requires type ${r}, got ${t}`);a&&a.call(this,t),this.all[e]=t}}}t.default=class{set(e){for(var t in e)this[t]=e[t]}}},61490:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i,n,s,o,l,d,u,c,p,h,f,_,m,g,v,E=a(r(34519)),y=a(r(90882)),S=a(r(16760)),T=r(53353),A=a(r(21830)),b=null,C=!1;var P,O=0,w=[],M=!1,I=!1,R=null,D=0;function N(e,t){e.commitTime=null!=t?t:j(),e.sequenceNumber=D++}function L(e){if(!R||e){var t=n.info();R={appVersion:o.VERSION_BASE,platform:d.PLATFORM_TYPE.WEBCLIENT,browser:t.name||null,browserVersion:t.ua||null,deviceName:t.os||null,deviceVersion:t.version||null,webcPhonePlatform:l.platformField||null,webcEnv:d.WEBC_ENV_CODE[o.WAM_ENV],webcTabId:_.thisTabId,webcWebPlatform:d.WEBC_WEB_PLATFORM_TYPE[o.WAM_PLATFORM]},e&&Object.assign(R,e),d.Global.commitOnSet=!1,d.Global.set(R),d.Global.commitOnSet=!0}}class k{constructor(e){this.buffer=new i(void 0,!0),this.buffer.writeString("WAM"),this.buffer.writeUint8(3),this.eventsWritten=0,this.prevGlobals={},this.dirtyGlobals={},this.unsavedPortion=null,this.saveKey=String(1e9*Math.random()|0),e&&this.setAll(e)}size(){return this.buffer.size()}setAll(e){for(var t in e){var r=e[t];void 0!==r&&this.set(d.METRICS.getGlobal(t).id,r)}}set(e,t){this.dirtyGlobals[String(e)]=t,this.unsavedPortion&&this.unsavedPortion.set(e,t)}flushGlobals(){var e=this.dirtyGlobals,t=this.prevGlobals;for(var r in e){var a=e[r];if("boolean"==typeof a)a=a?1:0;else if(void 0===a)a=null;else if(Number.isNaN(a))continue;if(a!==t[r]){t[r]=a;var i=parseInt(r,10);x(this.buffer,i,a,0)}}this.dirtyGlobals={}}write(e){var t=this.buffer;this.set(47,e.commitTime),this.set(3433,e.sequenceNumber),this.flushGlobals();for(var r=e.all,a=Object.keys(r),i=-1,n=0;n<a.length;n++){null!=r[a[n]]&&(i=n)}x(t,e.id,-e.weight,-1===i?5:1);for(var s=0;s<=i;s++){var o=a[s],l=d.METRICS.get(e.$className,o).id,u=r[o];null!=u&&("boolean"==typeof u&&(u=u?1:0),x(t,l,u,i===s?6:2))}this.eventsWritten++,this.unsavedPortion&&this.unsavedPortion.write(e)}stringBuffer(){return this.eventsWritten>0?c(this.buffer.peek((e=>e.readByteArray()))):""}}function U(e){w.push(e),M&&v.onOrBefore(1e4)}function G(){M=!0,w.length>0&&v.onOrBefore(1e4)}function F(){M=!1,v.cancel(),Promise.resolve(w).then((function(e){L(),e.length;var t=P||new k(R);P=t;for(var r=0;r<e.length;r++){var a=e[r],[i,...n]=a;if(i){var s=n[0];t.write(s)}else{var[l,d]=n;R[l.name]=d,t.set(l.id,d)}}var c,h=j();if(t.eventsWritten>0&&(t.size()>o.WAM_MAX_BUFFER_SIZE||h>O+o.WAM_ROTATE_INTERVAL||!I)){if(!p())return t.buffer.size()>o.WAM_MAX_BUFFER_SIZE?(P=null,Promise.resolve()):Y();if(null!=u){var f=u.uploadEvent();N(f,h),f.all,t.write(f)}return m.deleteAll().catch((function(e){return __LOG__(3)`wam:sendAllLogs failed to read because ${String(e)}`,{}})).then((e=>(c=e,P&&(P.unsavedPortion&&!(P.saveKey in c)&&(P=P.unsavedPortion),c[(0,A.default)(P,"context").saveKey]=P.stringBuffer()),Promise.all((0,S.default)(c,K))))).then((function(e){var t=(0,y.default)(e);if(t.length!==e.length&&(O=j(),I=!0),P&&!t.includes(P.saveKey)&&(P=null),0===t.length)return Promise.resolve();var r=t.reduce((function(e,t){return e+c[t].length}),0);if(r<o.WAM_MAX_BUFFER_SIZE)return Promise.all((0,S.default)(t,(function(e){return m.add(e,c[e]).then((()=>{}),(()=>{}))})));P=null,__LOG__(3)`wam dropped ${t.length} buffers! (${r} bytes)`}))}return Y()})).catch((function(e){__LOG__(3)`wam:executePending error ${String(e&&e.stack?e.stack:e)}`,s.upload({reason:"wam-error"}),P=null})).then(G,G),w=[]}function x(e,t,r,a){if(null==r)0===a&&B(e,t,a);else if("number"==typeof r&&r===(0|r))0===r?B(e,t,16|a):1===r?B(e,t,32|a):-128<=r&&r<128?(B(e,t,48|a),e.writeInt8(r)):-32768<=r&&r<32768?(B(e,t,64|a),e.writeInt16(r)):(B(e,t,80|a),e.writeInt32(r));else if("number"==typeof r)B(e,t,112|a),e.writeFloat64(r);else if("string"==typeof r){var i=g(r);i<256?(B(e,t,128|a),e.writeUint8(i)):i<65536?(B(e,t,144|a),e.writeUint16(i)):(B(e,t,160|a),e.writeUint32(i)),e.writeString(r)}}function B(e,t,r){t<256?(e.writeUint8(r),e.writeUint8(t)):(e.writeUint8(8|r),e.writeUint16(t))}function Y(){if(!P)return Promise.resolve();var e=P.stringBuffer();if(!e)return Promise.resolve();var t=(0,A.default)(P,"context").unsavedPortion;if(t&&0===t.eventsWritten)return Promise.resolve();var r=(0,A.default)(P,"context").saveKey;return(t?m.update(r,e).then((function(e){return P?e?void((0,A.default)(P,"context").unsavedPortion=new k(R)):(P=P.unsavedPortion,Y()):Promise.resolve()})):m.add(r,e).then((function(){if(!P)return Promise.resolve();(0,A.default)(P,"context").unsavedPortion=new k(R)}))).catch((function(e){__LOG__(3)`wam:save WamStorage failed to save ${String(e)}`}))}function K(e,t){return""===e||"["===e[0]?Promise.resolve(void 0):h(e,t)}function j(){return Math.floor(Date.now()/1e3)}var W=(0,E.default)({commit:function(e){null==e.commitTime||0===e.commitTime?0!==e.weight&&Math.random()*e.weight>1?e.commitTime=j():(e.$className,e.all,N(e),U([!0,e])):__LOG__(3)`wam:commit redundant commit! ${e.$className}`},set:function(e,t){e.name,String(t),U([!1,e,t])},resumeJobs:G,initialize:L},(function(e){return function(...t){C?e(...t):(b||(b=[],self.setTimeout((function(){if(null!=b){c=r(84337).encodeB64,i=r(49244).Binary,g=r(49244).numUtf8Bytes,n=r(92082).default,l=r(79435).default,s=r(2537),o=r(23045).default,d=r(84161).default,f=r(35160).ShiftTimer,_=r(66239),m=r(97686).Z,p=r(10875).Z,h=r(74476).Z,(0,T.isConnectedToPage)()&&(u=r(97247)),v=new f(F);for(var e=0;e<(0,A.default)(b,"lazyJobs").length;e++)(0,A.default)(b,"lazyJobs")[e]();b=null,C=!0}}),0)),(0,A.default)(b,"lazyJobs").push((()=>{e(...t)})))}}));t.default=W},97686:(e,t,r)=>{"use strict";var a=r(14859);t.Z=void 0;var i=a(r(78086));t.Z=class{static add(e,t){return i.default.idb().then((r=>r.wam.add({key:e,buffer:t},e)))}static update(e,t){return i.default.idb().then((r=>r.wam.update(e,{key:e,buffer:t}))).then((e=>0!==e))}static deleteAll(){var e={};return i.default.idb().then((t=>t.wam.toCollection().modify((function(t){e[t.key]=t.buffer,delete this.value})))).then((()=>e))}}},97247:(e,t,r)=>{"use strict";var a=r(14859),i=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.monitor=function(e,t){p(e?t?"ab":"an":t?"ub":"un")},t.uploadEvent=function(){var e=new d.default.WebcWamUpload;if(n){p(o);var t=n.total;if(t>0){var r=n.an+n.ab,a=n.un+n.ub;e.set({webcTotalT:Math.ceil(n.total),webcAvailableTp:r/t,webcAvailableNormalTp:r?n.an/r:void 0,webcAvailableBbarTp:r?n.ab/r:void 0,webcUnavailableTp:a/t,webcUnavailableNormalTp:a?n.un/a:void 0,webcUnavailableBbarTp:a?n.ub/a:void 0})}u(o)}return e};var n,s,o,l=i(r(34535)),d=a(r(84161));function u(e){s=Date.now(),o=e,n={total:0,ab:0,an:0,ub:0,un:0}}function c(e){Date.now()-e>s?s+=e:n[o]-=e}function p(e){if(n){var t=Date.now(),r=Math.max(t-s,0);n.total+=r,n[e]+=r,s=t,o=e}else u(e),l.default.on(l.JS_HALT_EVENT,c)}},12404:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(84161));var n=new class{constructor(){this._events=new Map}logSend(e){var t=e.tag;if(t)try{var r=e.getName(),a=r.startsWith("query")?i.default.WEBC_WAP_REQUEST_KIND_CODE.GET:i.default.WEBC_WAP_REQUEST_KIND_CODE.SET,n=e.isToPhone?i.default.WEBC_WAP_REQUEST_DESTINATION_CODE.PHONE:i.default.WEBC_WAP_REQUEST_DESTINATION_CODE.SERVER,s=e.data.byteLength||JSON.stringify(e.data).length;this._createEvent(t,{kind:a,destination:n,name:r,size:s})}catch(e){__LOG__(3)`WAPReporter: fail to log send`}}logBasicSend(e,t){if(e)try{var r=i.default.WEBC_WAP_REQUEST_KIND_CODE.GET,a=i.default.WEBC_WAP_REQUEST_DESTINATION_CODE.SERVER,n=t[1].toLowerCase(),s=JSON.stringify(t).length;this._createEvent(e,{kind:r,destination:a,name:n,size:s})}catch(e){__LOG__(3)`WAPReporter: fail to log basic send`}}logAck(e){if(e){var t=this._events.get(e);t&&t.markWebcWapRequestAckT({showInTimeline:!1})}}logRecv(e,t,r){if(e){var a=this._events.get(e);a&&(a.webcWapRequestResponseSize=t,null!=r&&(a.webcWapRequestStatus=r),a.markWebcWapRequestRecvT({showInTimeline:!1}),a.commit(),this._events.delete(e))}}delete(e){e&&this._events.delete(e)}clear(){this._events.clear()}_createEvent(e,t){var r=new i.default.WebcWapRequest({webcWapRequestKind:t.kind,webcWapRequestDestination:t.destination,webcWapRequestName:t.name,webcWapRequestSize:t.size});this._events.set(e,r)}};t.default=n},61585:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.logWasmSupport=function(){var e;new i.default.WebcWasmSupport({webcWasmSupported:null!=(null===(e=window.WebAssembly)||void 0===e?void 0:e.instantiate)}).commit()};var i=a(r(84161))},14264:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getAppUserModelId=function(){return"win32"!==process.platform||process.windowsStore?null:"com.squirrel.WhatsApp.WhatsApp"}},23288:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getDoNotDisturb=function(){try{var e,t;if("darwin"===process.platform)return(null===(e=window.Native.MacOSNotificationState)||void 0===e?void 0:e.getDoNotDisturb())||(null===(t=window.Native.MacOSNotificationState)||void 0===t?void 0:t.getNotificationState())===i.SESSION_SCREEN_IS_LOCKED;if("win32"===process.platform){var r,s,o,l,d;if((null===(r=window.Native.WindowsNotificationState)||void 0===r?void 0:r.getNotificationState())!==i.QUNS_ACCEPTS_NOTIFICATIONS)return!0;var u=(0,a.getAppUserModelId)(),c=u&&"YES"===(null===(s=window.Native.WindowsFocusAssist)||void 0===s||null===(o=s.isPriority(u))||void 0===o?void 0:o.name),p=null===(l=window.Native.WindowsFocusAssist)||void 0===l?void 0:l.getFocusAssist().name;return!!(c&&p===n.ALARMS_ONLY||!c&&[n.PRIORITY_ONLY,n.ALARMS_ONLY].includes(p))||!!(null===(d=window.Native.WindowsQuiteHours)||void 0===d?void 0:d.getIsQuietHours())}}catch(e){__LOG__(3)`getDoNotDisturb failed with error ${e}`}return!1};var a=r(14264),i=r(28103).Mirrored(["UNKNOWN","SESSION_SCREEN_IS_LOCKED","SESSION_ON_CONSOLE_KEY","QUNS_NOT_PRESENT","QUNS_BUSY","QUNS_RUNNING_D3D_FULL_SCREEN","QUNS_PRESENTATION_MODE","QUNS_ACCEPTS_NOTIFICATIONS","QUNS_QUIET_TIME","QUNS_APP","UNKNOWN_ERROR"]),n=r(28103).Mirrored(["NOT_SUPPORTED","FAILED","OFF","PRIORITY_ONLY","ALARMS_ONLY"])},81910:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.playEndCallTone=function(){}},42622:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.hasPending=function(){return null!=fe&&fe.hasPending()},t.execApiCmd=ye,t.default=t.InitialEmojisCompletionContext=t.Screen=void 0;var n=i(r(25291)),s=i(r(72779)),o=r(35160),l=i(r(47677)),d=i(r(19034)),u=a(r(2784)),c=i(r(84621)),p=r(99850),h=i(r(60497)),f=(i(r(15858)),a(r(43394))),_=i(r(95419)),m=i(r(60946)),g=i(r(99461)),v=i(r(13277)),E=i(r(76176)),y=i(r(17827)),S=i(r(79435)),T=i(r(23045)),A=a(r(8379)),b=i(r(78086)),C=i(r(95199)),P=i(r(72626)),O=r(55848),w=r(10765),M=r(66239),I=i(r(20468)),R=i(r(19058)),D=i(r(11200)),N=i(r(38637)),L=i(r(4739)),k=r(81725),U=i(r(10252)),G=i(r(17465)),F=a(r(70629)),x=i(r(21830)),B=i(r(64854)),Y=r(35407),K=r(21988),j=r(70692),W=i(r(56001)),H=i(r(72257)),V=i(r(54559)),$=i(r(16595)),q=i(r(63e3)),z=i(r(37018)),J=a(r(96377)),Q=i(r(37994)),X=a(r(57750)),Z=i(r(18932)),ee=i(r(1281)),te=i(r(11018)),re=i(r(5431)),ae=i(r(3472)),ie=i(r(53271)),ne=r(33723),se=i(r(15934)),oe=a(r(33753)),le=i(r(94854)),de=r(4314),ue=i(r(58674)),ce=i(r(55556)),pe=r(7017),he=(i(r(47339)),i(r(22006)));r(47791),se.default.registerHandler((e=>{(0,k.requireHandleSocketMessage)().then((t=>t(e)))}));var fe,_e=r(28103).Mirrored(["CLIENT_EXPIRED_DIALOG","ANOTHER_SESSION","QR","SYNCING","OFFLINE","PROXYBLOCK","CONFLICT","TOS_BLOCK","SMB_TOS_BLOCK","DEPRECATED_VERSION","MAIN","STARTUP","TEMP_BAN","LOGOUT"]);t.Screen=_e;var me=!1,ge=!1;function ve(e){"initialPanelMountTRecorded"===e&&(me=!0),"initialPanelRenderTRecorded"===e&&(ge=!0),me&&ge&&(0,Y.onInitialRenderComplete)()}var Ee=(0,n.default)((()=>{(0,Y.saveInitialPanelMountTime)(Date.now()),ve("initialPanelMountTRecorded")}));function ye({cmdAndData:e,isExternal:t}){var{resultType:r,data:a}=e;return __LOG__(2)`main:execApiCmd:${r}`,(0,l.default)(null!=fe,"Attempted to exec API command before main was loaded"),fe.execApiCmd({cmd:r,untypedData:a,isExternal:t})}var Se=new P.default,Te=u.createContext(Se);t.InitialEmojisCompletionContext=Te;class Ae extends u.Component{constructor(...e){super(...e),this.contextMenuRef=u.createRef(),this.animate=!0,this.state={mode:J.default.mode,updating:J.default.clientExpired,hardExpired:J.default.hardExpired,anotherSession:!1,takingOver:!1,apiCmd:void 0,locale:N.default.getLocale(),mainLoaded:!1,socketProgressStep:0,theme:(0,X.getTheme)(),systemThemeMode:(0,X.getSystemThemeMode)(),isKeyboardUser:!1,initialLoadReady:!1,startLogout:!1,stayInSync:!se.default.hasSynced},this._unsetIsKeyboardUser=()=>{this.setState({isKeyboardUser:!1})},this._setIsKeyboardUser=()=>{this.setState({isKeyboardUser:!0})},this._handlers={up:this._setIsKeyboardUser,down:this._setIsKeyboardUser,left:this._setIsKeyboardUser,right:this._setIsKeyboardUser,home:this._setIsKeyboardUser,end:this._setIsKeyboardUser,"command+up":this._setIsKeyboardUser,"command+down":this._setIsKeyboardUser,pageUp:this._setIsKeyboardUser,pageDown:this._setIsKeyboardUser,tab:this._setIsKeyboardUser,"shift+tab":this._setIsKeyboardUser,"shift+?":this._setIsKeyboardUser},this._setModeScheduler=new o.ShiftTimer((e=>{e!==this.state.mode&&this.setState({mode:e})})),this._handleStreamModeChange=()=>{var e=J.default.mode;this.state.mode!==J.StreamMode.MAIN?this._setModeScheduler.onOrBefore(0,e):this._setModeScheduler.forceRunNow(e)},this._onClientExpired=()=>{this.state.updating!==J.default.clientExpired&&this.setState({updating:J.default.clientExpired})},this._onHardExpired=()=>{this.setState({hardExpired:J.default.hardExpired})},this.onMouseDown=e=>{this._unsetIsKeyboardUser(),v.default.windowMouseDown(e)},this.onClick=e=>{this._unsetIsKeyboardUser(),v.default.windowClick(e)},this._handleWindowClick=e=>{var t,r=e.target;if(r&&"A"===r.nodeName){var a=r.getAttribute("href");if(a)if(!(null===(t=r.dataset)||void 0===t?void 0:t.nohandle)){var i=(0,K.parseAPICmd)(a);"INVALID"!==i.resultType&&this._canExecApiCmd()&&ye({cmdAndData:i,isExternal:!0})&&e.preventDefault()}}},this._handleSetTheme=e=>{if(this.state.theme!==e){for(var t of X.THEME_ASSETS[e])f.default.loadAsset(t,f.LOAD_PRIORITY.THEME_ASSET_LOAD,!1);if(V.default.wallpapersV2){var r=_.default.get("defaultPreference");if(r&&T.default.DEFAULT_CHAT_WALLPAPER!==r.wallpaperColor){var a=(0,ne.toggleWallpaperColor)(r.wallpaperColor,this.state.theme);r.set("wallpaperColor",a)}}(0,X.setTheme)(e),this.setState({theme:e})}},this._handleSetSystemThemeMode=e=>{(0,X.setSystemThemeMode)(e),this.setState({systemThemeMode:e})},this._mdReloadPageOnTakeOver=()=>{__LOG__(2)`[md takeover] refreshing page on takeover`,window.location.reload()},this._onReadyForMainScreen=()=>{__LOG__(2)`DebouncedLoadingScreen: Ready for main screen`,this.setState({stayInSync:!1})},this._getThemeContextValue=(0,G.default)((({theme:e,systemThemeMode:t})=>({theme:e,setTheme:this._handleSetTheme,systemThemeMode:t,setSystemThemeMode:this._handleSetSystemThemeMode})))}componentDidMount(){!0===(0,M.mdOptedIn)()&&(I.default.setFeature(I.default.F.MD_BACKEND,!0),I.default.setFeature(I.default.F.MD_ADV,!0),I.default.setFeature(I.default.F.MD_VOIP_GROUP,!1));var{theme:e}=this.state;(0,X.applyThemeToUI)(e),Pe().then((t=>{f.default.setPlatform(t),f.default.loadInitialAssets(X.THEME_ASSETS[e])})),Promise.all([Promise.all([(0,k.requireMain)(),Pe()]).then((([e,t])=>{Y.mainScriptTimer.start(),fe=e(t),Y.mainScriptTimer.end()})),(0,U.default)()]).then(j.loadProtoVersions).then((()=>{v.default.mainLoaded(),this.setState({mainLoaded:!0})})).then((()=>Promise.all([(0,k.requireEmojiAssetMapCreator)(),(0,k.requireEmojiConfig)(),Pe()]))).then((([e,t,r])=>{f.default.setPlatform(r),f.default.initEmojiAsset(e(t)),Se.beginPreloadFallback()}));var{listeners:t}=this.props;t.add(v.default,"increment_progress",(()=>{this._incProgress()})),t.add(v.default,"initial_load_ready",(()=>{this.setState({initialLoadReady:!0})})),t.add(z.default,"storage_not_enough_space",(()=>{v.default.openModal(u.createElement(E.default,{onOK:()=>{se.default.logout()},okText:N.default.t(1726)},N.default.t(1698)))})),t.add(v.default,"account_temporarily_banned",(e=>{this.setState({temporaryBan:e})})),t.add(v.default,"starting_logout",(()=>{this.setState({startLogout:!0})})),I.default.supportsFeature(I.default.F.MD_BACKEND)&&de.OfflineResumeReporter.logPageLoadT();var a,i=r(3351).Z;if(t.add(window,"beforeunload",i.unloadMutex.bind(i)),t.add(window,"unload",i.unloadMutex.bind(i)),t.add(window,"storage",(e=>{i.storagePong(e)&&(I.default.supportsFeature(I.default.F.MD_BACKEND)&&(__LOG__(2)`[md takeover] tab taken over. stopping comms`,(0,pe.stopComms)()),le.default.onTakeOver(),this.setState({takingOver:!1,anotherSession:!0}))})),t.add(J.default,"change:clientExpired",this._onClientExpired),t.add(J.default,"change:hardExpired",this._onHardExpired),t.add(J.default,"change:mode",this._handleStreamModeChange),he.default.canMuckHistory()){var n=(0,K.parseAPICmd)(window.location.href);if(n.resultType!==p.APICmd.INVALID){var{url:s}=n.data;delete n.data.url,this._maybeExecApiCmd(n),window.history.replaceState({},"",s)}}t.add(N.default,"locale_change",(e=>{__LOG__(2)`App:componentDidMount:rerenderUI locale change`,(0,M.setLangPref)(e),this.animate=!1,this.setState({locale:`${N.default.getLocale()}#${d.default.locale()}`})})),this._registerYesterdayTimer(),__LOG__(2)`App:componentDidMount:visibilityState: ${document.visibilityState}`,"prerender"===document.visibilityState?(0,ie.default)(document,"visibilitychange").timeout(5e3).then((()=>this._beginMutex(0))).catch((()=>this._beginMutex(0))):this._beginMutex(0),this.props.listeners.add(window,"click",this._handleWindowClick,!0),this.props.listeners.add(window,"blur",(()=>{this._unsetIsKeyboardUser()})),oe.default.poll(oe.checkForUpdates),this._logFirstRenderMountTime(),document.createElement=(a=document.createElement.bind(document),(e,t={})=>{if("iframe"===e.toLowerCase()){__LOG__(3)`Modified a created iframe element to include sandbox attributes for security fix.`;var r=a(e,t);return r.sandbox=V.default.webYouTubePlayerEnhancements?"allow-scripts allow-same-origin allow-popups allow-popups-to-escape-sandbox":"allow-scripts allow-same-origin",r}return a(e,t)}),this.props.listeners.add(Q.default,"system_theme_change",(e=>{this.state.systemThemeMode&&this._handleSetTheme(e)}))}componentDidUpdate(e,t){!0===t.anotherSession&&!1===this.state.anotherSession?b.default.openDB().catch((e=>{__LOG__(3)`Failed to open indexeddb: ${e}`})):!1===t.anotherSession&&!0===this.state.anotherSession&&b.default.idb().then((e=>e.close())).catch((()=>{})),this._maybeExecApiCmd(this.state.apiCmd),this.state.mode!==J.StreamMode.MAIN&&(this.animate=!0),this._logFirstRenderMountTime()}componentWillUnmount(){this._setModeScheduler.cancel(),this._setWamSystemInfo&&this._setWamSystemInfo.cancel()}_beginMutex(e,t=!1){t&&ae.default.shouldForceUpdateOnTakeOver()&&ae.default.restart();var a=r(3351).Z;return(t?a.takeoverLocal(e):a.init(e)).catch((e=>(this.setState({takingOver:!0}),this._beginMutex(e,!0)))).then((e=>{le.default.isTakeOver=e,this.setState({takingOver:!1,anotherSession:e})}))}_incProgress(){this.setState({socketProgressStep:this.state.socketProgressStep+1})}_maybeExecApiCmd(e){if(e)return this._canExecApiCmd()?(ye({cmdAndData:e,isExternal:!0}),void(null!=this.state.apiCmd&&this.setState({apiCmd:null}))):void(e!==this.state.apiCmd&&this.setState({apiCmd:e}))}_canExecApiCmd(){return null!=fe&&Ce(this.state)===_e.MAIN}_logFirstRenderMountTime(){this.state.mode!==J.StreamMode.SYNCING&&Ee()}_calculateProgress(){return 20*this.state.socketProgressStep}_registerYesterdayTimer(){c.default.setLocalTimeout((()=>{__LOG__(2)`App:registerYesterdayTimer:rerenderUI relative timestamps`,__LOG__(2)`Local Clock: ${Date.now()}, Skew: ${g.default.getSkew()}`,v.default.midnight(),this._registerYesterdayTimer()}),(0,d.default)().endOf("day").valueOf())}_getTemporaryBanReason(e){var t=(0,M.getMaybeMeUser)().user;switch(e){case 101:return N.default.t(1353,{phone:t});case 102:return N.default.t(1354);case 103:return N.default.t(1355,{phone:t});case 104:return N.default.t(1356);case 106:return N.default.t(1357);default:return N.default.t(1358)}}_getUiAndIconCount(){switch(Ce(this.state)){case _e.CLIENT_EXPIRED_DIALOG:return{ui:u.createElement(w.DefaultFavicon,null,u.createElement(m.default,null)),requiresBackendCheck:!1};case _e.ANOTHER_SESSION:var e,t;return this.state.takingOver?(e=()=>{},t=N.default.t(488)):(e=()=>{I.default.supportsFeature(I.default.F.MD_BACKEND)?this._mdReloadPageOnTakeOver():this._beginMutex(0,!0)},t=N.default.t(342)),{ui:u.createElement(w.ErrorFavicon,null,u.createElement(y.default,{cancelText:N.default.t(1569),onCancel:window.open.bind(window,"https://www.whatsapp.com/","_self"),okText:t,onOK:e},N.default.t(1879))),requiresBackendCheck:!1};case _e.TEMP_BAN:var{code:r,expire:a}=this.state.temporaryBan||{},i=this._getTemporaryBanReason(r),n=d.default.duration(a,"seconds").humanize();return{ui:u.createElement(w.ErrorFavicon,null,u.createElement(y.default,{cancelText:N.default.t(929),onCancel:()=>{__LOG__(2)`Banned accounts: user selected logout`,se.default.logout()},okText:N.default.t(1685),onOK:window.open.bind(window,(0,O.getFaqUrl)())},u.createElement("div",null,i),u.createElement("div",null,N.default.t(1352,{duration:n})))),requiresBackendCheck:!0};case _e.QR:return{ui:u.createElement(w.DefaultFavicon,null,u.createElement(F.default,{type:F.ModalType,key:"modal-manager"}),u.createElement(H.default,{key:"qr-code",apiCmd:this.state.apiCmd})),extraClasses:h.default.isQR,requiresBackendCheck:!0};case _e.STARTUP:case _e.SYNCING:if(I.default.supportsFeature(I.default.F.MD_BACKEND)){var s=u.createElement(ce.default,{initialLoadReady:this.state.initialLoadReady,onReady:this._onReadyForMainScreen});return{ui:u.createElement(w.DefaultFavicon,null,s),requiresBackendCheck:!0}}return{ui:u.createElement(w.DefaultFavicon,null,u.createElement(q.default,{progress:this._calculateProgress()})),requiresBackendCheck:!0};case _e.OFFLINE:return{ui:u.createElement(w.ErrorFavicon,null,u.createElement(B.default,null)),requiresBackendCheck:!0};case _e.PROXYBLOCK:return{ui:u.createElement(w.ErrorFavicon,null,u.createElement(W.default,null)),requiresBackendCheck:!0};case _e.CONFLICT:return{ui:u.createElement(w.ErrorFavicon,null,u.createElement(y.default,{cancelText:N.default.t(929),onCancel:()=>se.default.logout(),okText:N.default.t(342),onOK:()=>se.default.takeover()},N.default.t(1135))),requiresBackendCheck:!0};case _e.TOS_BLOCK:return{ui:u.createElement(w.ErrorFavicon,null,u.createElement(ee.default,{description:N.default.t(1831)})),requiresBackendCheck:!0};case _e.SMB_TOS_BLOCK:return{ui:u.createElement(w.ErrorFavicon,null,u.createElement(ee.default,{description:N.default.t(1804)},u.createElement($.default,null))),requiresBackendCheck:!0};case _e.DEPRECATED_VERSION:return{ui:u.createElement(w.ErrorFavicon,null,u.createElement(C.default,null)),requiresBackendCheck:!0};case _e.LOGOUT:return{ui:u.createElement(w.DefaultFavicon,null,u.createElement(F.default,{type:F.ModalType,key:"modal-manager"}),u.createElement(ue.default,{key:"logout"})),requiresBackendCheck:!0};case _e.MAIN:var{MainComponent:o}=(0,x.default)(fe,"Main");return{ui:[u.createElement(Z.default,{key:"toast-manager"}),u.createElement(F.default,{contextMenuRef:this.contextMenuRef,type:F.ModalType,key:"main-modal-manager"}),u.createElement(F.default,{type:F.MediaType,key:"media-modal-manager"}),u.createElement(A.default,{ref:this.contextMenuRef,type:A.Type.MENU,key:"context-menu-manager"}),u.createElement(A.default,{type:A.Type.TOOLTIP,key:"tooltip-manager"}),u.createElement(Te.Provider,{key:"main",value:Se},u.createElement(o,{conn:S.default,animate:this.animate}))],extraClasses:h.default.isMain,requiresBackendCheck:!0}}}render(){!function(e){if(Y.initialScreenTimer.hasStarted())return;var t=Ce(e);if(!function(e){return e!==_e.SYNCING}(t))return;(0,Y.setInitialScreen)(t),Y.initialScreenTimer.start(),window.requestAnimationFrame((()=>{Y.initialScreenTimer.end(),ve("initialPanelRenderTRecorded")}))}(this.state);var{isKeyboardUser:e}=this.state,{ui:t,extraClasses:r,requiresBackendCheck:a}=this._getUiAndIconCount(),i=(0,s.default)(h.default.wrapper,r,{"app-wrapper-web":!0,"safari-fix":te.default.isSafari,"edge-fix":te.default.isTrident,"font-fix":te.default.browser===T.default.BROWSER_TYPE.CHROME||te.default.browser===T.default.BROWSER_TYPE.OPERA,"os-mac":te.default.os===T.default.OS_TYPE.MAC,"os-win":te.default.os===T.default.OS_TYPE.WINDOWS,"keyboard-user":e});return a&&null!=fe&&!(0,M.knowsPhone)()&&fe.notificationBackend.shutdownAsNeeded(),u.createElement(X.default.Provider,{value:this._getThemeContextValue({theme:this.state.theme,systemThemeMode:this.state.systemThemeMode})},u.createElement(D.default.Provider,{value:e},u.createElement(re.default,{displayName:"App",uimState:re.default.State.INACTIVE},u.createElement(R.default,{handlers:this._handlers,className:i,onMouseDownCapture:this.onMouseDown,onClickCapture:this.onClick},undefined,undefined,t))))}}Ae.displayName="App";var be=(0,L.default)(Ae);function Ce(e){var{anotherSession:t,updating:r,hardExpired:a,mainLoaded:i,mode:n}=e;if(I.default.supportsFeature(I.default.F.MD_BACKEND)){var s;if(null===(s=e.temporaryBan)||void 0===s?void 0:s.banned)return _e.TEMP_BAN;if(e.startLogout)return _e.LOGOUT}if(r||a)return _e.CLIENT_EXPIRED_DIALOG;if(t)return _e.ANOTHER_SESSION;switch(n){case J.StreamMode.QR:return _e.QR;case J.StreamMode.SYNCING:return _e.SYNCING;case J.StreamMode.OFFLINE:return _e.OFFLINE;case J.StreamMode.PROXYBLOCK:return _e.PROXYBLOCK;case J.StreamMode.CONFLICT:return _e.CONFLICT;case J.StreamMode.TOS_BLOCK:return _e.TOS_BLOCK;case J.StreamMode.SMB_TOS_BLOCK:return _e.SMB_TOS_BLOCK;case J.StreamMode.DEPRECATED_VERSION:return _e.DEPRECATED_VERSION;case J.StreamMode.MAIN:return i?I.default.supportsFeature(I.default.F.MD_BACKEND)&&e.stayInSync?_e.SYNCING:_e.MAIN:_e.STARTUP}throw new Error(`app:render Error invalid StreamMode: ${n}`)}function Pe(){return S.default.platform?Promise.resolve(S.default.platform):new Promise((e=>{var t=()=>{var{platform:r}=S.default;null!=r&&(S.default.off("change:platform",t),e(r))};S.default.on("change:platform",t)}))}t.default=be},88135:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default=class{constructor(e,t,r){this.retryCount=0,this.asset=e,this.resolution=t,this.priority=r}getLoadUrlPromise(){return this._loadUrlPromise}setLoadUrlPromise(e){this._loadUrlPromise=e}getConsumerPromise(){return this._consumerPromise}setConsumerPromise(e){this._consumerPromise=e}getConsumerPromiseResolve(){return this._consumerPromiseResolve}setConsumerPromiseResolve(e){this._consumerPromiseResolve=e}}},47490:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){if(!r(55074).default.supported)return;var t=!0===e.estimateStorage,a=r(3715).default,c=r(96623).default,p=navigator.serviceWorker;(0,s.default)().then((t=>{var r=(0,i.default)(e.keep,(e=>[e[n.default.RES.LOW],e[n.default.RES.HIGH]])).map((e=>{var r,a=null===(r=e[t&&e[u]?u:d])||void 0===r?void 0:r.split("/");return null!=a?a[a.length-1]:null}));p&&p.controller&&a.request(p.controller,c.CLEAN_ASSETS,r).catch((()=>{}))})).then((()=>t?(0,l.default)():null)).then((e=>{e&&new o.default.WebcStorageStat({webcStorageUsage:e.usage,webcStorageQuota:e.quota}).commit()}))};var i=a(r(35838)),n=a(r(58160)),s=a(r(17153)),o=a(r(84161)),l=a(r(33013)),d="default",u="webp"},51703:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.getEmojiTypeFromPlatform=h,t.default=function(e){return t=>p(t,e)};var i=a(r(98346)),n=a(r(75652)),s=a(r(30733)),o=r(79435),l=a(r(23045)),d=r(20409),{EMOJI:{EMOJI_TYPE:u,BUCKET_SIZE:c}}=l.default,p=(0,s.default)(((e,t)=>{for(var r=new Map,a=h(e),s=t[a],o=s.SELECTOR,l=Math.ceil((0,n.default)((0,i.default)(s.UNICODE_TO_EMOJI)).length/c),u=0;u<l;u+=1){var p=`emoji-${o}-b${u}`;r.set(p,{id:p,selectors:[`.emoji.${o}.b${u}`,`.emojik.${o}.b${u}`],low:{default:(0,d.getEmojiSpritesPath)(a,u,40,"png"),webp:(0,d.getEmojiSpritesPath)(a,u,40,"webp")},high:{default:(0,d.getEmojiSpritesPath)(a,u,64,"png"),webp:(0,d.getEmojiSpritesPath)(a,u,64,"webp")}})}return r}));function h(e){switch(e){case o.PLATFORMS.IPHONE:case o.PLATFORMS.SMBI:case o.PLATFORMS.IPAD:case o.PLATFORMS.IPOD:return u.APPLE;default:return u.WHATSAPP}}},72626:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(43394)),n=a(r(84161));t.default=class{constructor(){this._loadingEmojisCount=0,this._hasTriggeredEmojiPreload=!1,this.beginPreload=(e=!1)=>{this._hasTriggeredEmojiPreload||(this._hasTriggeredEmojiPreload=!0,window.setTimeout((()=>{i.default.loadEmojis()}),e?1e3:0))},this.beginPreloadFallback=()=>{window.setTimeout((()=>{this.beginPreload(!1)}),5e3)},this.incrementLoadingEmojisCount=()=>{this._hasTriggeredEmojiPreload||(this._firstScreenEmojisLoadEvent||(this._firstScreenEmojisLoadEvent=new n.default.WebcFirstScreenEmojisLoad({webcLoadedEmojisCount:0})),this._firstScreenEmojisLoadEvent.webcEmojisLoadT||(this._firstScreenEmojisLoadEvent.webcLoadedEmojisCount+=1),this._loadingEmojisCount+=1)},this.decrementLoadingEmojisCount=()=>{if(!this._hasTriggeredEmojiPreload){this._loadingEmojisCount-=1;var e=this._firstScreenEmojisLoadEvent;if(0===this._loadingEmojisCount&&e){this.beginPreload(!0),e.markWebcEmojisLoadT(),e.commit();var t=e.webcEmojisLoadT;__LOG__(2)`EmojiCompletionTracker:firstScreenEmojis complete in ${t} ms`}}}}}},43394:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.AssetLoaderClass=t.default=t.AssetLoader=t.LOAD_PRIORITY=void 0;var n=i(r(98346)),s=i(r(18149)),o=i(r(47677)),l=i(r(88135)),d=i(r(47490)),u=i(r(23045)),c=i(r(58160)),p=i(r(42189)),h=i(r(31615)),f=r(51703),_=a(r(76125)),m=i(r(84161)),g=i(r(21830)),v=i(r(49702)),E=a(r(56179)),y={INITIAL_EMOJI_LOAD:1,INITIAL_ASSET_LOAD:2,THEME_ASSET_LOAD:2,HELP_ANIMATED_DOODLE:2,LAZY_LOAD_EMOJI:2,NOTIFICATION_ICON:2};t.LOAD_PRIORITY=y;var{EMOJI_TYPE:S}=u.default.EMOJI;class T{constructor(e=90){this._assetStyle=new p.default("asset-style"),this._requestedAssets={},this._loadingDataMap={},this._getEmojiForPlatform=null,this._currentResolution=c.default.currentRes,this._currentlyLoadingCount=0,this._queue=new v.default((e=>-e.priority)),this._hasLoggedDecrementBelowZero=!1,this._handleDpiChange=()=>{var e=c.default.currentRes,t=this._currentResolution;e!==t&&(this._currentResolution=e,Object.keys(this._requestedAssets).forEach((e=>{this._cancelLoad(e,t)})),this._loadAssets((0,n.default)(this._requestedAssets),y.INITIAL_EMOJI_LOAD,{forceCheck:!1}).catchType(Promise.CancellationError,(()=>{})))},this._maxConcurrentRequests=e,window.addEventListener("dpichange",this._handleDpiChange)}initEmojiAsset(e){this._getEmojiForPlatform=e}loadInitialAssets(e){var t=new m.default.WebcAssetLoad({webcAssetName:"initial-assets",webcAssetFromCache:!1,webcAssetCacheType:m.default.WEBC_ASSET_CACHE_TYPE_CODE.UNCACHED});this._loadAssets(e,y.INITIAL_ASSET_LOAD,{estimateStorage:!0}).then((()=>{t.markWebcAssetLoadT(),t.commit();var e=t.webcAssetLoadT;__LOG__(2)`AssetLoader:loadInitialAssets complete in ${e}ms`})).catchType(Promise.CancellationError,(()=>{__LOG__(2)`AssetLoader:loadInitialAssets cancelled by more recent request.`}))}loadEmoji(e,t){if(this._getEmojiForPlatform&&this._currentPlatform){var r=this._getEmojiForPlatform(this._currentPlatform),a=h.default.getBucket(e),i=this._getEmojiPrefix(),n=r.get(`${i}b${a}`),s=this._currentResolution;return n?this.loadAsset(n,t,!1).catchType(Promise.CancellationError,(()=>{__LOG__(2)`AssetLoader: loadEmoji Cancelled by more recent request: ${n.id}-${s}`})):Promise.reject(new Error("The given emoji glyph id was not found"))}return Promise.reject(new Error("emojiForPlatform or currentPlatform are not set"))}loadEmojis(){var e=(0,g.default)(this._currentPlatform,"this._currentPlatform");(0,o.default)(null!=this._getEmojiForPlatform,"Emojis were loaded before initializing the emoji assets!");var t=[...this._getEmojiForPlatform(e).values()],r=new m.default.WebcAssetLoad({webcAssetName:"emojis",webcAssetFromCache:!1,webcAssetCacheType:m.default.WEBC_ASSET_CACHE_TYPE_CODE.UNCACHED});this._loadAssets(t,y.INITIAL_EMOJI_LOAD,{estimateStorage:!0}).then((()=>{r.markWebcAssetLoadT(),r.commit();var e=r.webcAssetLoadT;__LOG__(2)`AssetLoader:loadEmojis complete in ${e}ms`})).catchType(Promise.CancellationError,(()=>{__LOG__(2)`AssetLoader:loadEmojis cancelled by more recent request.`}))}loadAsset(e,t,r=!0){var{id:a}=e,i=c.default.currentRes,n=this._requestedAssets[a];if(n&&!(0,s.default)(e,n))return Promise.reject(new Error(["Attempted to load an asset using an already used ID"].join("\n")));this._requestedAssets[a]=e,this._loadingDataMap[a]=this._loadingDataMap[a]||{};var o="high"===i?"low":"high";this._cancelLoad(a,o);var d=this._loadingDataMap[a][i];if(d&&!r)return d.promise;var u=new l.default(e,i,t),p=this._buildPromise(u).uncancellable().tap((t=>{var{selectors:r}=e;r&&this._assetStyle.setRule(`${r.join(", ")}`,{"background-image":`url('${t}')`})})).catch((e=>{var t=this._loadingDataMap[a][i],r=h!==t;if(r||(this._loadingDataMap[a][i]=null),e instanceof Promise.CancellationError&&(__LOG__(2)`Asset load cancelled by more recent request: ${a}-${i}`,r&&t))return t.promise;throw e}));u.setConsumerPromise(p);var h={promise:p,cancel:e=>{this._cancelUrlPromise(u,e)}};return this._loadingDataMap[a][i]=h,d&&d.cancel(!1),this._startLoad(),p}_buildPromise(e){return new Promise((t=>{e.setConsumerPromiseResolve(t),this._queue.push(e)})).cancellable()}_startLoad(){var e=this;if(!(this._currentlyLoadingCount>=this._maxConcurrentRequests))for(var t=function(){var t=e._queue.pull();if(!t)return{v:void 0};e._currentlyLoadingCount+=1,(0,_.default)(t).then((()=>{e._decrementCurrentlyLoadingCount(),e._startLoad()})).catchType(Promise.CancellationError,(()=>{e._decrementCurrentlyLoadingCount(),e._startLoad()})).catch((r=>{e._decrementCurrentlyLoadingCount(),t.retryCount+=1;var a=E.expBackoff(t.retryCount,12e4,1e3,.1);setTimeout((()=>{e._queue.push(t),e._startLoad()}),a),e._startLoad(),(0,_.getSupportedImageFormatUrl)(t).then((e=>{var t=e.split("/");__LOG__(3)`Asset: ${t[t.length-1]} failed. Retrying... ${r.toString()}`}))}))},r=0;r<this._maxConcurrentRequests-this._currentlyLoadingCount;r++){var a=t();if("object"==typeof a)return a.v}}_cancelUrlPromise(e,t=!0){var r=e.getLoadUrlPromise();if(r){r.cancel();var a=e.getConsumerPromise();t&&a&&a.cancel()}this._startLoad()}_cancelLoad(e,t){var r=this._loadingDataMap[e]&&this._loadingDataMap[e][t];r&&(this._loadingDataMap[e][t]=null,r.promise.isPending()&&r.cancel(!0))}setPlatform(e){if(e!==this._currentPlatform){this._currentPlatform=e;var t=((0,f.getEmojiTypeFromPlatform)(e)===S.APPLE?S.WHATSAPP:S.APPLE)===S.APPLE?"emoji-apple-":"emoji-wa-";if(Object.keys(this._requestedAssets).forEach((e=>{e.startsWith(t)&&(this._cancelLoad(e,"high"),this._cancelLoad(e,"low"))})),null!=this._getEmojiForPlatform){var r=[...this._getEmojiForPlatform(e).values()];this._loadAssets(r,y.INITIAL_EMOJI_LOAD,{forceCheck:!1})}}}_getEmojiPrefix(){return(0,f.getEmojiTypeFromPlatform)(this._currentPlatform)===S.APPLE?"emoji-apple-":"emoji-wa-"}_loadAssets(e,t,r){var a=!1!==(r&&r.forceCheck),i=!0===(r&&r.estimateStorage);return Promise.all(e.map((e=>this.loadAsset(e,t,a)))).then((e=>((0,d.default)({keep:(0,n.default)(this._requestedAssets),estimateStorage:i}),e)))}_decrementCurrentlyLoadingCount(){this._currentlyLoadingCount<=0&&!this._hasLoggedDecrementBelowZero&&(this._hasLoggedDecrementBelowZero=!0,__LOG__(4,void 0,new Error,!0)`Assertion failed!`,SEND_LOGS("Tried to decrease _loadingCount below zero, would have been negative.")),this._currentlyLoadingCount=Math.max(0,this._currentlyLoadingCount-1)}}t.AssetLoader=T;var A=new T;t.default=A;var b=T;t.AssetLoaderClass=b},76125:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.getSupportedImageFormatUrl=h,t.default=function(e){var t=new n.default,r=h(e).then((r=>{var a;return l.default.waitIfOffline({signal:(new n.default).signal}).then((()=>(a=Date.now(),(0,o.default)(r,{signal:t.signal})))).cancellable().catchType(Promise.CancellationError,(e=>(t.abort(),Promise.reject(e)))).then((t=>{var i=e.getConsumerPromiseResolve();if(!t.ok||!i)return Promise.reject(new p(r,t.status,Date.now()-a));i(r)})).cancellable()}));return e.setLoadUrlPromise(r),r},t.LoadUrlError=void 0;var i=r(71436),n=a(r(45026)),s=a(r(17153)),o=a(r(22448)),l=a(r(66622)),d=a(r(21830)),u="default",c="webp";class p extends((0,i.customError)("LoadUrlError")){constructor(e,t,r){super(`Failed to load url. StatusCode: ${t}. Duration: ${r} ms`),this.url=e,this.statusCode=t}}function h(e){return(0,s.default)().cancellable().then((t=>{var{asset:r,resolution:a}=e,i=t&&r[a][c]?c:u;return(0,d.default)(r[a][i],"asset[resolution][format]")}))}t.LoadUrlError=p},95147:(e,t,r)=>{var a=r(52954);function i(){return(i=a((function*(){window.Promise=r(97733).Z,(0,r(27630).default)(),r(94854).default.clearLogsPreemptive(),window.__LOG__=r(94854).log,window.SEND_LOGS=r(2537).sendLogs,window.onerror=r(74060).HC,window.Promise.onPossiblyUnhandledRejection=r(74060).e2;var{requireMain:e}=r(81725);e();var{exeTimer:t}=r(35407);t.start();var i=r(21830).default,n=r(28316),s=r(2784),o=r(11018).default;o.isSafari&&o.browserVersion.startsWith("13.")&&(i(document.body,"document.body").className+=" text-rendering-bug-fix"),r(14389),window.Velocity=r(86534),r(64928),window.WebFont=r(75310),r(95754);var l=r(27246),d=r(8883).Z;l.set(d);var{isFunction:u}=r(61864);["getSelection","open","focus"].forEach((function(e){var t=Object.getPrototypeOf(window)[e];u(t)&&window[e]!==t&&(window[e]=t)}));var c=r(2537);window.Debug||(window.Debug={}),window.Debug.uploadLogs=c.upload;try{var p=r(78086).default;yield p.loadUserIdb()}finally{var h=r(38637).default;h.init(r(66239).getLangPref()).then(a((function*(){(yield Promise.resolve().then(r.bind(r,99461))).default.setIs24HourBasedOnLocale()}))),r(94854).default;var{default:f,hasPending:_}=r(42622),m=r(23045).default;window.Debug.VERSION=m.VERSION_STR,window.Debug.DESKTOP_BETA=void 0;var g=r(92082).default;window.onbeforeunload=function(){if(g.isDownloading())g.clearDownloading();else if(__LOG__(2)`webclient close/reload triggered`,__LOG__(2)`latest hash: ${m.LATEST_HASH}`,__LOG__(2)`version: ${m.VERSION_STR}`,!(g.promptUnloadGuards>0))return _()?h.t(472):void 0},window.addEventListener("dragover",(function(e){e.preventDefault()})),window.addEventListener("drop",(function(e){e.preventDefault()})),r(70601).loadSVGData(),(0,r(57766).Z)()||(n.render(s.createElement(f,null),i(document.getElementById("app"),"document.getElementById('app')")),t.end())}if(window.navigator.serviceWorker&&!window.navigator.serviceWorker.controller)try{window.navigator.serviceWorker.register("/serviceworker.js",{scope:"/"})}catch(e){}}))).apply(this,arguments)}!function(){i.apply(this,arguments)}()},8507:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.genId=function(e){return(0,n.default)(e||"action_toast")},t.ActionToast=t.ActionType=t.ToastPosition=void 0;var n=i(r(74930)),s=r(60266),o=a(r(2784)),l=i(r(13277)),d=r(97025),u={LEFT:"LEFT",RIGHT:"RIGHT"};t.ToastPosition=u;t.ActionType=class{constructor(e,t){if(!e)throw new Error("ActionType must have text!");this.text=e,t&&(this.action=t.actionText,this.handler=t.actionHandler)}};class c extends o.Component{constructor(...e){super(...e),this.state={currentInitialAction:this.props.initialAction,actionType:this.props.initialAction,pending:!0},this._actionPromise=null,this.onAction=()=>{this.state.actionType&&this.state.actionType.handler&&this.state.actionType.handler().catch((()=>{}))},this.onDismiss=()=>{l.default.closeToast(this)}}static getDerivedStateFromProps(e,t){var r=e.initialAction;return r!==t.currentInitialAction?{currentInitialAction:r,actionType:r,pending:!0}:null}componentDidMount(){this._runAction(this.props.pendingAction)}componentDidUpdate(e){e.pendingAction!==this.props.pendingAction&&this._runAction(this.props.pendingAction)}_runAction(e){var t={};this._actionPromise&&this._actionPromise.control.cancel(),this._actionPromise=e.addRejectControl("cancel",(()=>t)).then((e=>{this.setState({actionType:e,pending:!1})})).catchConditional((e=>e!==t),(e=>{this.setState({actionType:e,pending:!1})})).then((()=>(0,s.delayMs)(this.props.settleDuration))).addRejectControl("cancel",(()=>t)).then((()=>{l.default.closeToast(this)})).catchConditional((e=>e===t),(()=>{})).endWithControls("cancel")}render(){var e,t,{actionType:r}=this.state;return r?(r.action&&r.handler&&(t=o.createElement(d.ToastActionBtn,{buttonText:r.action,onClick:this.onAction})),this.state.pending||(e=o.createElement(d.ToastDismissBtn,{onClick:this.onDismiss})),o.createElement(d.ToastBody,{toastPosition:this.props.toastPosition,actionText:r.text,actionBtn:t,dismissBtn:e})):null}}t.ActionToast=c,c.defaultProps={settleDuration:5e3,toastPosition:u.LEFT},c.displayName="ActionToast"},36171:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(r(58527)),s=i(r(72779)),o=a(r(2784)),l=i(r(32944)),d=i(r(7479)),u=r(66368),c=i(r(68267)),p=i(r(45713)),h=i(r(49143)),f=i(r(37766));var _=function({a8nText:e,children:t,className:r,disabled:a,onClick:i,nowrap:_,spinner:m,type:g}){var v,[E,y]=(0,f.default)(i,{disabled:a}),[S,T]=(0,p.default)(),A=(0,h.default)(E,S);switch(g){case"primary":v="white";break;case"secondary":case"plain-white":case"simplified":v="highlight";break;default:v="default"}return a&&(v="default"),o.createElement("div",(0,n.default)({},y,{"data-a8n":l.default.key(e),className:(0,s.default)(d.default.button,{[d.default.primary]:"primary"===g,[d.default.secondary]:"secondary"===g,[d.default.plainWhite]:"plain-white"===g,[d.default.disabled]:a,[d.default.nowrap]:_,[d.default.simplified]:"simplified"===g,[d.default.warning]:"warning"===g,[d.default.strong]:"strong"===g,[d.default.strongPrimary]:"strong-primary"===g,[d.default.itemFocused]:T},r),ref:A}),o.createElement(u.FlexRow,{align:"center",justify:"center"},o.createElement(u.FlexItem,{a8nText:l.default.key("content")},null!=t?t:null),m?o.createElement(u.FlexItem,{a8nText:l.default.key("spinner"),className:d.default.spinner},o.createElement(c.default,{color:v,size:16})):null))};t.default=_},30430:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var{children:t,href:r,onClick:a,title:i,className:l}=e;return s.createElement("a",{className:(0,n.default)(l,o.default.link),href:null!=r?r:void 0,onClick:e=>{null!=r&&(e.metaKey||e.altKey)||(e.preventDefault(),a(e))},role:"button",rel:"noreferrer noopener",target:"_blank",title:i},t)};var n=i(r(72779)),s=a(r(2784)),o=i(r(78640))},13277:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.Cmd=t.APP_STATE_SYNC_COMPLETED=void 0;var i=a(r(70417)),n=a(r(54073)),s=a(r(47677)),o=a(r(45026)),l=r(3599),d=a(r(23045)),u=a(r(48977)),c=a(r(71107)),p=a(r(20468)),h=r(47138);t.APP_STATE_SYNC_COMPLETED="app_state_sync_completed";class f extends c.default{constructor(...e){var t,r,a;super(...e),this.isMainLoaded=!1,this.uiBusy=0,this._clearUiBusy=(0,n.default)((()=>{this.uiBusy&&(__LOG__(2)`cmd:clearUIBusy uibusy timeout`,this.uiBusy=0,this._triggerIdleEvent())}),1e3,{maxWait:5e3}),this._triggerIdleEvent=(t=()=>{(0,s.default)(0===this.uiBusy,`ui_idle triggered when uiBusy is ${this.uiBusy}`),0===this.uiBusy&&(this._clearUiBusy.cancel(),this.trigger("ui_idle"))},(a=()=>{if(!r){r=new o.default;var{signal:e}=r;(0,u.default)({signal:e}).then((()=>{e.aborted||(r=null,t())}),(e=>{if(e.name!==l.ABORT_ERROR)throw e}))}}).cancel=()=>{r&&(r.abort(),r=null)},a)}mainLoaded(){this.isMainLoaded=!0,this.trigger("main_loaded")}incrementProgress(){__LOG__(2)`Cmd: incrementProgress`,this.trigger("increment_progress")}initialLoadReady(){__LOG__(2)`Cmd: initialLoadReady`,this.trigger("initial_load_ready")}logSocketSummary(){this.trigger("log_socket_summary")}muteAll(e,t){this.trigger("mute_all",e,t)}muteChat(e,t){this.trigger("mute_chat",(0,h.unproxy)(e),t)}muteChats(e,t,r){var a=e.map((e=>(0,h.unproxy)(e)));this.trigger("mute_chats",a,t,r)}deleteOrExitChat(e,t){this.trigger("delete_or_exit_chat",(0,h.unproxy)(e),t)}clearChat(e,t){this.trigger("clear_chat",(0,h.unproxy)(e),t)}archiveChat(e,t){this.trigger("archive_chat",(0,h.unproxy)(e),t)}pinChat(e,t){this.trigger("pin_chat",(0,h.unproxy)(e),t)}pinChats(e,t){var r=e.map((e=>(0,h.unproxy)(e)));this.trigger("pin_chats",r,t)}markChatUnread(e,t){this.trigger("mark_chat_unread",(0,h.unproxy)(e),t)}msgInfoDrawer(e){this.trigger("msg_info_drawer",(0,h.unproxy)(e))}chatSearch(e){this.trigger("chat_search",(0,h.unproxy)(e))}chatInfoDrawer(e,t){this.trigger("chat_info_drawer",(0,h.unproxy)(e),t)}attachMediaDrawer(e){var t=(0,i.default)((0,i.default)({},e),{},{chat:(0,h.unproxy)(e.chat)});this.trigger("attach_media_drawer",t)}attachProduct(e){this.trigger("attach_product",e)}verificationDrawer(e){this.trigger("verification_drawer",e)}liveLocationDrawer(e,t){this.trigger("live_location_drawer",e,t)}expiredLocationDrawer(e){this.trigger("expired_location_drawer",e)}mediaViewerModal(e){var{msg:t,getZoomNode:r,currentTime:a,highlightedMsgIds:i}=e;this.trigger("media_viewer_modal",{msg:t,getZoomNode:r,currentTime:a,highlightedMsgIds:i})}openMediaViewerForAlbumMedia(e){this.trigger("open_media_viewer_for_album_media",e)}productImageViewerModal(e,t){this.trigger("product_image_viewer_modal",e,t)}ephemeralDrawer(e){this.trigger("ephemeral_drawer",e)}sendStarMsgs(e,t,r,a){this.trigger("send_star_msgs",(0,h.unproxy)(e),t,r,a)}sendUnstarMsgs(e,t,r,a){this.trigger("send_unstar_msgs",(0,h.unproxy)(e),t,r,a)}sendDeleteMsgs(e,t,r,a,i){this.trigger("send_delete_msgs",(0,h.unproxy)(e),t,r,a,i)}sendRevokeMsgs(e,t,r,a,i){this.trigger("send_revoke_msgs",(0,h.unproxy)(e),t,r,a,i)}_openChat(e,t){var r=(0,h.unproxy)(e);return new Promise((e=>{this.trigger("open_chat",r,t,e)})).addCancelControl().catch((e=>{throw __LOG__(2)`Unexpected openChat error: ${String(e)}`,e}))}openChatAt(e,t){var r=(0,h.unproxy)(e);if(!t)return this.openChatBottom(r);this.setUiBusy(!0,"open_chat_at");var a=this._openChat(r,t).then((e=>{var t,r;if(e)if(e.wasVisible)t=()=>this._scrollToFocusedMsg({pos:"offset",offset:e.offset}),r=()=>this._scrollToFocusedMsg({pos:"center",animate:!0,duration:d.default.MSG_FOCUS_SCROLL_ANIMATION_DURATION,easing:[.7,0,.3,1]});else switch(t=()=>this._scrollToFocusedMsg({pos:e.alignAt}),e.alignAt){case"top":case"bottom":r=()=>this._scrollToFocusedMsg({pos:"center",animate:!0,duration:d.default.MSG_FOCUS_SCROLL_ANIMATION_DURATION,easing:[.88,.64,.13,.99]});break;case"center":default:r=()=>Promise.resolve()}else t=()=>this._scrollToFocusedMsg({pos:"center"}),r=()=>Promise.resolve();return t().then(r)})).then((()=>{this.flashFocusedMsg()})).then((()=>!0)).catchType(Promise.CancellationError,(()=>!1));return a.finally((()=>{this.setUiBusy(!1,"open_chat_at")})),a}openChatFromUnread(e){var t,r=(0,h.unproxy)(e);if(r.unreadMsgAnchor&&(t={collection:r.unreadMsgAnchor.msgChunk,promise:Promise.resolve(),msg:r.unreadMsgAnchor,isUnreadDivider:r.shouldShowUnreadDivider}),t||r.unreadCount>0){this.setUiBusy(!0,"open_from_unread");var a=this._openChat(r,t).then((()=>this._scrollToFocusedMsg({pos:"top",offset:-120}))).then((()=>!0)).catchType(Promise.CancellationError,(()=>!1));return a.finally((()=>{this.setUiBusy(!1,"open_from_unread")})),a}return this.openChatBottom(r)}openChatBottom(e){var t,r=(0,h.unproxy)(e);this.setUiBusy(!0,"open_bottom"),r.msgs.length>0&&(t={collection:r.msgs,msg:r.msgs.last(),isUnreadDivider:!1});var a=this._openChat(r,t).then((()=>this._scrollChatToBottom())).then((()=>!0)).catchType(Promise.CancellationError,(()=>!1));return a.finally((()=>{this.setUiBusy(!1,"open_bottom")})),a}scrollToPtt(e){var t=(0,h.unproxy)(e.chat),r={collection:e.chat.msgs,msg:e,key:e.id,highlightMsg:!1};this.setUiBusy(!0,"open_chat_at");var a=this._openChat(t,r).then((()=>this._scrollToFocusedMsg({pos:"center",animate:!0,duration:d.default.MSG_FOCUS_SCROLL_ANIMATION_DURATION,easing:[.7,0,.3,1]}))).then((()=>!0)).catchType(Promise.CancellationError,(()=>!1));return a.finally((()=>{this.setUiBusy(!1,"open_chat_at")})),a}_scrollToFocusedMsg(e){return new Promise((t=>{this.trigger("scroll_to_focused_msg",t,e)})).catch((e=>{__LOG__(3)`Unexpected scrollToFocusedMsg error: ${String(e)}`}))}_scrollChatToBottom(){return new Promise((e=>{this.trigger("scroll_chat_to_bottom",e)})).catch((e=>{__LOG__(3)`Unexpected scrollChatToBottom error: ${String(e)}`}))}flashFocusedMsg(){setTimeout((()=>{this.trigger("flash_focused_msg")}),0)}updateChatlistSelection(e){var t=(0,h.unproxy)(e);this.trigger("update_chatlist_selection",t)}closeChat(e){var t=(0,h.unproxy)(e);this.trigger("close_chat",t)}focusChatTextInput(e){var t=(0,h.unproxy)(e);t?this.trigger("focus_chat_text_input_"+t.id.toString()):this.trigger("focus_chat_text_input")}setChatCtwaContextLinkData(e,t){this.trigger("chat_set_ctwa_context_link_data_"+e.id.toString(),t)}focusShowMsg(e){this.trigger("focus_show_msg",e)}enterChatTextInput(e){var t=(0,h.unproxy)(e);this.trigger("enter_chat_text_input_"+t.id.toString())}focusNextChat(e){this.trigger("focus_next_chat",e)}focusPrevChat(e){this.trigger("focus_prev_chat",e)}focusChatList(){this.trigger("focus_chat_list")}focusChatSearch(){this.trigger("focus_chat_search")}pasteChatTextInput(e,t){var r=(0,h.unproxy)(e);this.trigger("paste_chat_text_input_"+r.id.toString(),t)}startGroupCall(e,t){var r=(0,h.unproxy)(e);this.trigger("voip_start_group_call",r,t)}closeStatusViewer(){this.trigger("close_status_viewer")}sendPasteToCompose(e,t){var r=(0,h.unproxy)(e);this.trigger("send_paste_to_compose_"+r.id.toString(),t)}login(e){this.trigger("login",e)}logout(){var e=p.default.supportsFeature(p.default.F.MD_BACKEND);p.default.resetFeatures(),p.default.setFeature(p.default.F.MD_BACKEND,e),p.default.setFeature(p.default.F.MD_ADV,e),p.default.setFeature(p.default.F.MD_VOIP_GROUP,e&&!1),this.trigger("logout")}openContextMenu(e,t){this.trigger("open_context_menu",e,t)}closeContextMenu(e){this.trigger("close_context_menu",e)}openTooltip(e,t){this.trigger("open_tooltip",e,t)}closeTooltip(e){this.trigger("close_tooltip",e)}openToast(e){this.trigger("open_toast",e)}closeToast(e){this.trigger("close_toast",e)}alertNewMsg(e){this.trigger("alert_new_msg",e)}newMediaMsg(e){this.trigger("new_media_msg",e)}alertCall(e,t,r,a){this.trigger("alert_call",e,t,r,a)}cancelCall(e){this.trigger("cancel_call",e)}windowError(){}cannotReachPhone(){}sentPing(){}openModal(e,t){this.trigger("open_modal",e,t)}closeModal(e){this.trigger("close_modal",e)}openModalMedia(e,t){this.trigger("open_media",e,t)}closeModalMedia(){this.trigger("close_media")}setDrawerContext(e,t){this.trigger(`update_context_${e}`,t)}openDrawerRight(e,t,r,a){this.trigger("open_drawer_right",e,t,r,void 0,a)}openDrawerMid(e,t,r,a,i){this.trigger("open_drawer_mid",e,t,r,a,i)}openDrawerLeft(e,t,r,a){this.trigger("open_drawer_left",e,t,r,void 0,a)}existsDrawerRight(e){this.trigger("exists_drawer_right",e)}existsDrawerMid(e){this.trigger("exists_drawer_mid",e)}existsDrawerLeft(e){this.trigger("exists_drawer_left",e)}closeDrawerRight(){this.trigger("close_drawer_right")}closeDrawerMid(){this.trigger("close_drawer_mid")}closeDrawerLeft(){this.trigger("close_drawer_left")}onPanesWillChange(e){this.trigger("panes_will_change",e)}onPanesDidChange(e){this.trigger("panes_did_change",e)}openGroupInviteModal(e){this.trigger("open_group_invite_modal",e)}openGroupV4InviteRequestFlow(e,t,r,a){this.trigger("open_group_v4_invite_request_flow",e,t,r,a)}mediaPlaying(e){this.trigger("mediaPlaying",e)}pttRecording(){this.trigger("pttRecording")}pttPlaying(e){this.trigger("pttPlaying",e)}uiResize(){this.trigger("resize")}setUiBusy(e){var t=this.uiBusy||0;e?(++t,this._clearUiBusy(),this._triggerIdleEvent.cancel()):t&&--t,this.uiBusy=t,0===t&&(this._clearUiBusy.cancel(),this._triggerIdleEvent())}windowMouseDown(e){this.trigger("window_mousedown",e)}windowClick(e){this.trigger("window_click",e)}midnight(){this.trigger("midnight")}textsizeChange(e){this.trigger("textsize_change",e)}scrollMessages(){this.trigger("scroll_messages")}getConversationHeaderOffset(e){this.trigger("get_conversation_header_offset",e)}floaterEscapeOverlap(e,t){this.trigger("floater_escape_overlap",e,t)}autoplayPTT(e){this.trigger("sequential_playback_ptt",e)}refreshMessages(){this.trigger("refresh_messages")}serverPropsUpdated(){this.trigger("server_props_updated")}storageInitializationError(){this.trigger("storage_initialization_error")}restartBackend(){this.trigger("md_restart_backend")}downgradeWebclient(){this.trigger("md_downgrade_webclient")}upgradeToMDInternal(){this.trigger("upgrade_to_md")}upgradeToMDProd(){this.trigger("upgrade_to_md_prod")}refreshQR(){this.trigger("md_refresh_qr")}setSocketState(e){this.trigger("set_socket_state",e)}socketStreamDisconnected(){this.trigger("socket_stream_disconnected")}openSocketStream(){this.trigger("open_socket_stream")}readyForMainStreamMode(){this.trigger("main_stream_mode_ready")}onInitialChatHistorySynced(){this.trigger("on_initial_chat_synced")}onRecentChatHistorySynced(){this.trigger("on_recent_chat_history_synced")}onFullChatHistorySynced(){this.trigger("on_full_chat_history_synced")}onOfflineProgressUpdate(){this.trigger("offline_progress_update")}criticalSyncDone(){this.trigger("on_critical_sync_done")}onTemporaryBan(e){this.trigger("account_temporarily_banned",e)}onStartingLogout(){this.trigger("starting_logout")}handleFatalError(){this.trigger("handle_fatal_error")}}t.Cmd=f;var _=new f;t.default=_},8379:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.ContextMenuManager=t.Type=void 0;var n=i(r(70417)),s=a(r(2784)),o=i(r(13277)),l=a(r(81407)),d=i(r(4739)),u=i(r(86541)),c=i(r(97212)),p=i(r(82838)),h={MENU:"MENU",TOOLTIP:"TOOLTIP"};t.Type=h;var f={originX:0,originY:0,offsetX:0,offsetY:0,dirX:l.DirX.RIGHT,dirY:l.DirY.BOTTOM,type:l.MenuType.dropdown};class _ extends s.Component{constructor(...e){super(...e),this.state={},this._setRefMenuContainer=e=>{this._refMenuContainer=e},this._setRefDropdown=e=>{this._refDropdown=e},this.onClose=e=>{(!e||this.state.menu&&this.state.menu.uim===e)&&this.setState({menu:void 0})},this._onOpen=(e,t)=>{var{menu:r}=this.state;r&&r.uim&&r.uim.pop(),r=(0,n.default)((0,n.default)((0,n.default)({},f),e),{},{key:Math.random(),isTemporaryRender:!0}),e.event&&(r=(0,n.default)((0,n.default)({},r),{},{originX:e.event.clientX,originY:e.event.clientY,offsetX:null!=e.offsetX?e.offsetX:10,offsetY:null!=e.offsetY?e.offsetY:10}),e.event.stopPropagation()),this.setState({menu:r},(()=>{var e;t(null===(e=this._refMenuContainer)||void 0===e?void 0:e.getElement()),this._setDirection()}))},this.isOpen=()=>null!=this.state.menu}componentDidMount(){var e=this.props.type===h.MENU?"open_context_menu":"open_tooltip";this.props.listeners.add(o.default,e,this._onOpen);var t=this.props.type===h.MENU?"close_context_menu":"close_tooltip";this.props.listeners.add(o.default,t,this.onClose)}_setDirection(){if(this._refDropdown){var e=this._refDropdown.clientWidth,t=this._refDropdown.clientHeight+10,r=window.innerWidth,a=window.innerHeight;if(this.state.menu){var{anchor:i,originX:s,originY:o,offsetX:d,offsetY:u,dirX:c,dirY:p}=this.state.menu,h=s,f=s,_=o,m=o;if(i&&i instanceof HTMLElement){var g=i.getBoundingClientRect();h=g.left,f=g.right,m=g.bottom,_=g.top}var v=c;v===l.DirX.RIGHT&&h+e>r&&f-e>0?v=l.DirX.LEFT:v===l.DirX.LEFT&&f-e<0&&h+e<r&&(v=l.DirX.RIGHT);var E=p;E===l.DirY.BOTTOM&&m+t+u>a&&_-t>0?E=l.DirY.TOP:E===l.DirY.TOP&&_-t<0&&m+t+u<a&&(E=l.DirY.BOTTOM);var y,S=v===l.DirX.RIGHT?h:f;y=E===l.DirY.TOP?_:m;var T=d,A=u;i||(v===l.DirX.LEFT&&(T=0),E===l.DirY.TOP&&(A=0)),this.setState({menu:(0,n.default)((0,n.default)({},this.state.menu),{},{dirX:v,dirY:E,originX:S,originY:y,offsetX:T,offsetY:A,isTemporaryRender:!1})})}}}render(){var e,t="dropdown";if(this.state.menu){var{menu:r,key:a,originX:i,originY:n,offsetX:o,offsetY:d,dirX:h,dirY:f,type:_,autoFocus:m,findFirstItem:g,horizontal:v,isTemporaryRender:E,theme:y}=this.state.menu,S=Array.isArray(r)?r.map((e=>s.cloneElement(e,{theme:y}))):r;e=s.createElement(l.default,{origin:{x:i+o,y:n+d},onRef:this._setRefDropdown,type:_,key:"key-"+a,dirX:h,dirY:f,horizontal:v,autoFocus:m,findFirstItem:g,isTemporaryRender:E},s.createElement(u.default,{ref:this._setRefMenuContainer},S)),t="picker"===_?"dropdown-picker":"dropdown"}return s.createElement(c.default.Consumer,null,(r=>s.createElement(c.default.Provider,{value:this.state.menu&&this.state.menu.uim||r},s.createElement(p.default,{transitionName:t},e))))}}t.ContextMenuManager=_,_.displayName="ContextMenuManager";var m=(0,d.default)(_);t.default=m},60100:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.APP_TEXT_MIMETYPE=void 0;var i=a(r(2689)),n=a(r(11403)),s=r(74409),o=a(r(70994)),l=a(r(62084)),d=a(r(12949)),u=a(r(50719)),c=r(64812);t.APP_TEXT_MIMETYPE="application/whatsapp";class p{constructor(e){this._value=e||""}append(e,t=""){return this._value=[this.toString(),e].filter((e=>e)).join(t),this}prepend(e,t=""){return this._value=[e,this.toString()].filter((e=>e)).join(t),this}toString(){return this._value}}class h{static fromEl(e,t=(0,s.isCopyable)(e)){var r=t?(0,s.getAppTextTemplateData)(e):null;return new h("",r)}static getTemplate(e){var t=e;if(!t)return null;if(!(t instanceof HTMLElement)){if(!t.parentElement)return null;t=t.parentElement}for(var r=new h("${appText}"),a=t,i=5,n=0,o=!1;a&&n<i;)a instanceof HTMLElement&&(0,s.isCopyable)(a)?(r=h.fromEl(a,!0).append(r.toString()),o=o||!r.isPlainText(),i=5):n++,a=a.parentElement;return o?r.toString():null}constructor(e="",t){this._innerAppText=new p(e),this._appTextTemplate=t}append(e,t=""){return this._innerAppText.append(e,t),this}prepend(e,t=""){return this._innerAppText.prepend(e,t),this}isPlainText(){return Boolean(!this._appTextTemplate&&""!==this._appTextTemplate)}toString(){return this._appTextTemplate||""===this._appTextTemplate?this._appTextTemplate.replace(/\$\{appText\}/g,this._innerAppText.toString()):this._innerAppText.toString()}}class f{constructor(e,t){var r=e||"";this._plainText=new p(r),t&&(this._appText=new h(r,t))}static _copyableChildrenToClipboard(e){var t=(0,s.findCopyableChildren)(e);return(0,n.default)(t,((e,t)=>e.prepend(this.fromEl(t),"\n")),new f)}static _pruneRangeNodes(e,t,r){for(var a=t.cloneContents().childNodes,i=(0,l.default)(t),n=[],s=[],o=0;o<a.length;o++){var d=a[o],u=i[o]&&i[o].parentElement;(r||(0,c.isSelectable)(i[o])||(0,c.hasSelectableChildren)(d))&&(e.contains(i[o])||u&&u.contains(e))&&(n.push(d),s.push(i[o]))}i=s;var p=r;if(1===(a=n).length){var h=a[0];(p=p||(0,c.isSelectable)(i[0]))||(a=(0,c.findSelectableChildren)(h,p),p=!1)}return{rangeNodes:a,parentIsSelectable:p}}static fromCopyableEl(e,t=!1){var r=(0,s.getPrePlainTextData)(e)||"",a=new f(r),i=(0,s.getPlainTextData)(e),o=(0,s.getAppTextTemplateData)(e),l=new f("",o);return i||""===i?(l.appendPlainText(i),a.append(l)):t||(0,c.isSelectable)(e)?((0,n.default)(e.childNodes,((e,t)=>{var r=(0,d.default)(t,"div")?"\n":"";return e.prepend(this.fromSelectableNode(t),r)}),l),a.append(l)):(l.append(this._copyableChildrenToClipboard(e)),a.append(l))}static fromEl(e,t=!1){return(0,s.isCopyable)(e)||t?this.fromCopyableEl(e,t):this._copyableChildrenToClipboard(e)}static fromNode(e,t){return e instanceof HTMLElement?this.fromEl(e,t):t?this.fromSelectableNode(e):new f}static fromRange(e,t){var r=t.commonAncestorContainer,a=h.getTemplate(r),i=new f("",a),s=(0,c.isSelectAll)(r)?r:(0,c.findSelectAllParent)(r);if(s instanceof HTMLElement)return i.append(this.fromCopyableEl(s));var{parentIsSelectable:o,rangeNodes:l}=this._pruneRangeNodes(e,t,(0,c.isSelectable)(r));return(0,n.default)(l,((e,t)=>{var r=o?"":"\n",a=this.fromNode(t,o);return e.prepend(a,r)}),i)}static fromSelectableNode(e){if((0,u.default)(e))return new f(e.textContent);if(!(e instanceof HTMLElement))return new f;var t=new f;return(0,o.default)(e,(e=>(0,u.default)(e)||(0,s.isCopyable)(e)?[]:Array.from(e.childNodes)),(e=>{var r;(0,s.isCopyable)(e)&&e instanceof HTMLElement?(r=this.fromCopyableEl(e,!0),t.append(r)):(0,u.default)(e)&&t.appendPlainText(e.textContent)})),t}static fromSelection(e,t){var r=new f;return(0,i.default)(t.rangeCount).map((r=>{var a=t.getRangeAt(r);return this.fromRange(e,a)})).reduce(((e,t)=>e.append(t,"\n")),r)}append(e,t=""){return e.hasAppText()?(this._appText=this._appText||new h(this.toPlainString()),this._appText.append(e.toAppString(),t)):this.hasAppText()&&this._appText.append(e.toAppString(),t),this._plainText.append(e.toPlainString(),t),this}appendPlainText(e,t=""){return this.append(new f(e)),this}prepend(e,t=""){return e.hasAppText()?(this._appText=this._appText||new h(this.toPlainString()),this._appText.prepend(e.toAppString(),t)):this.hasAppText()&&this._appText.prepend(e.toAppString(),t),this._plainText.prepend(e.toPlainString(),t),this}hasAppText(){return Boolean(this._appText)}toAppText(){return this.hasAppText()?this._appText:new h(this.toPlainString())}toPlainString(){return this._plainText.toString()}toAppString(){return this.hasAppText()?this._appText.toString():this.toPlainString()}}t.default=f},74409:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.isCopyable=function(e){return e instanceof HTMLElement&&(0,c.default)(e,f)},t.getPrePlainTextData=function(e){return e.dataset[v]},t.getPlainTextData=function(e){return e.dataset[m]},t.getAppTextTemplateData=function(e){return e.dataset[y]},t.findCopyableChildren=function(e){var t=Array.from(e.querySelectorAll(f));return t.filter((e=>!t.some((t=>t!==e&&t.contains(e)))))},t.CopyableCode=function(e){return d.createElement("code",A(e))},t.CopyableDel=function(e){return d.createElement("del",A(e))},t.CopyableDiv=function(e){return d.createElement("div",A(e))},t.CopyableEm=function(e){return d.createElement("em",A(e))},t.CopyableLink=function(e){var t=A(e),r=t.href;if(r&&!p.default.hasValidUrlScheme(r))return d.createElement("span",null);return d.createElement("a",t)},t.CopyableSpan=function(e){return d.createElement("span",A(e))},t.CopyableStrong=function(e){return d.createElement("strong",A(e))},t.CopyableUl=function(e){return d.createElement("ul",A(e))},t.default=t.CopyableImg=t.PLAIN_TEXT_DATA_ATTR=t.COPYABLE_CSS_SELECTOR=t.COPYABLE_CSS_CLASS=void 0;var n=i(r(70417)),s=i(r(58527)),o=i(r(22220)),l=i(r(72779)),d=a(r(2784)),u=i(r(76170)),c=i(r(42954)),p=i(r(22006)),h="copyable-text";t.COPYABLE_CSS_CLASS=h;var f=".copyable-text";t.COPYABLE_CSS_SELECTOR=f;var _="data-plain-text",m=(0,u.default)(_);t.PLAIN_TEXT_DATA_ATTR=m;var g="data-pre-plain-text",v=(0,u.default)(g),E="data-app-text-template",y=(0,u.default)(E);var S=d.forwardRef(((e,t)=>{var r,{forwardedRef:a}=e,i=A((0,o.default)(e,["forwardedRef"]));return d.createElement("img",(0,s.default)({ref:null!=a?a:t},i,{alt:null!==(r=i.alt)&&void 0!==r?r:""}))}));t.CopyableImg=S;var T=d.forwardRef((function(e,t){var{element:r}=e,a=(0,o.default)(e,["element"]);return d.createElement(r,(0,s.default)({},A(a),{ref:t}))}));function A(e){var{plainText:t,prePlainText:r,appTextTemplate:a}=e,i=(0,o.default)(e,["plainText","prePlainText","appTextTemplate"]),s=(0,n.default)({},i);return s.className=(0,l.default)(i.className,h),null!=t&&(s[_]=t),null!=r&&(s[g]=r),null!=a&&(s[E]=a),s}t.default=T},96670:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(r(58527)),s=i(r(70417)),o=i(r(22220)),l=i(r(72779)),d=a(r(2784)),u=a(r(60100)),c=i(r(42314)),p=d.forwardRef((function(e,t){var{canCut:r,children:a,className:i}=e,u=(0,o.default)(e,["canCut","children","className"]),p=(0,s.default)((0,s.default)({},u),{},{className:(0,l.default)(i,c.default.noop,"copyable-area"),onCopy:f,onCut:r?_:void 0});return d.createElement("div",(0,n.default)({},p,{ref:t}),a)}));function h(e){var t=e.currentTarget;if(!(t instanceof HTMLElement))return!1;var r=u.default.fromSelection(t,window.getSelection());e.clipboardData.setData("text/plain",r.toPlainString());try{e.clipboardData.setData(u.APP_TEXT_MIMETYPE,r.toAppString())}catch(e){}return!0}function f(e){h(e,window.getSelection())&&(e.stopPropagation(),e.preventDefault())}function _(e){var t=window.getSelection();h(e)&&(t.deleteFromDocument(),e.stopPropagation(),e.preventDefault(),e.target.dispatchEvent(new Event("input",{bubbles:!0,cancelable:!0})))}t.default=p},64812:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.createSelectableElement=function(e,t){var r=document.createElement(e);r.setAttribute("class",f),(t||""===t)&&(r.dataset[d.PLAIN_TEXT_DATA_ATTR]=t);return r},t.isSelectable=E,t.isSelectAll=y,t.findSelectableChildren=function(e,t){if(!(e instanceof HTMLElement))return[];if(t||E(e))return Array.from(e.childNodes);var r=Array.from(e.querySelectorAll(_));return r.filter((e=>!r.some((t=>t!==e&&t.contains(e)))))},t.hasSelectableChildren=function(e){if(!(e instanceof HTMLElement))return!1;return!!e.querySelector(_)},t.findSelectAllParent=function(e){if(!S(e))return null;var t,r=e,a=0;for(;r&&a<5;){if(y(r)&&r instanceof HTMLElement){t=r;break}r=r.parentElement,a++}return t},t.SelectableCode=function(e){var t=b(e);return e.selectable?l.createElement(d.CopyableCode,t):l.createElement("code",t)},t.SelectableDel=function(e){var t=b(e);return e.selectable?l.createElement(d.CopyableDel,t):l.createElement("del",t)},t.SelectableDiv=function(e){var t=b(e);return e.selectable?l.createElement(d.CopyableDiv,t):l.createElement("div",t)},t.SelectableEm=function(e){var t=b(e);return e.selectable?l.createElement(d.CopyableEm,t):l.createElement("em",t)},t.SelectableLink=function(e){var t=b(e),r=e.href;if(r&&!p.default.hasValidUrlScheme(r))return l.createElement("span",null);return e.selectable?l.createElement(d.CopyableLink,t):l.createElement("a",t)},t.SelectableSpan=function(e){var t=b(e);return e.selectable?l.createElement(d.CopyableSpan,t):l.createElement("span",t)},t.SelectableStrong=function(e){var t=b(e);return e.selectable?l.createElement(d.CopyableStrong,t):l.createElement("strong",t)},t.SelectableUl=function(e){var t=b(e);return e.selectable?l.createElement(d.CopyableUl,t):l.createElement("ul",t)},t.default=t.SelectableImg=t.SELECTABLE_INPUT_CSS_CLASS=t.SELECTABLE_CSS_SELECTOR=t.SELECTABLE_CSS_CLASS=void 0;var n=i(r(58527)),s=i(r(22220)),o=i(r(72779)),l=a(r(2784)),d=a(r(74409)),u=i(r(42954)),c=i(r(60249)),p=i(r(22006)),h="selectable-text";t.SELECTABLE_CSS_CLASS=h;var f=`${d.COPYABLE_CSS_CLASS} selectable-text`,_=".selectable-text";t.SELECTABLE_CSS_SELECTOR=_;var m=f;t.SELECTABLE_INPUT_CSS_CLASS=m;var g="select-all",v=".select-all";function E(e){return!!e&&(e instanceof HTMLElement?(0,u.default)(e,_)||(0,u.default)(e,".selectable-text *"):E(e.parentElement))}function y(e){return!!e&&(e instanceof HTMLElement?(0,u.default)(e,v):y(e.parentElement))}function S(e){return!!e&&(e instanceof HTMLElement?(0,u.default)(e,".select-all *"):S(e.parentElement))}var T=l.forwardRef(((e,t)=>{var r,{forwardedRef:a}=e,i=(0,s.default)(e,["forwardedRef"]),o=b(i);return i.selectable?l.createElement(d.CopyableImg,(0,n.default)({forwardedRef:t},o)):l.createElement("img",(0,n.default)({ref:t},o,{alt:null!==(r=i.alt)&&void 0!==r?r:""}))}));t.SelectableImg=T;var A=l.forwardRef((function(e,t){var{element:r}=e,a=(0,s.default)(e,["element"]),i=b(a);return a.selectable?l.createElement(d.default,(0,n.default)({element:r},i,{ref:t})):l.createElement(r,(0,n.default)({},i,{ref:t}))}));function b(e){var{className:t,plainText:r,prePlainText:a,appTextTemplate:i,selectable:n,selectAll:l}=e,d=(0,s.default)(e,["className","plainText","prePlainText","appTextTemplate","selectable","selectAll"]);return n&&(d.plainText=r,d.prePlainText=a,d.appTextTemplate=i),d.className=(0,o.default)(t,c.default.noop,{[h]:n,[g]:n&&l}),d}t.default=A},81407:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.DirY=t.DirX=t.MenuType=t.EMOJI_PICKER_WIDTH=void 0;var n=i(r(98537)),s=i(r(72779)),o=a(r(2784)),l=i(r(13277)),d=i(r(60508)),u=i(r(94330)),c=i(r(5338)),p=i(r(18792)),h=i(r(62536)),f=i(r(19058)),_=i(r(38637)),m=i(r(21830)),g=parseInt(u.default["-emoji-picker-width"].replace(/px$/,""),10);t.EMOJI_PICKER_WIDTH=g;t.MenuType={dropdown:"dropdown",dropdown_menu:"dropdown_menu",dropdown_text:"dropdown_text",menu:"menu",picker:"picker",emoji_picker:"emoji_picker",sticker_picker:"sticker_picker",color_picker:"color_picker",tooltip:"tooltip"};var v={RIGHT:"RIGHT",LEFT:"LEFT"};t.DirX=v;var E={TOP:"TOP",BOTTOM:"BOTTOM"};t.DirY=E;class y extends o.Component{constructor(...e){super(...e),this.state={showShortcuts:!1,keyboard:!1,selected:null},this._setRefDropdown=e=>{this._refDropdown=e,this.props.onRef&&this.props.onRef(e)},this._setRefList=e=>{this._refList=e},this._floaterEscapeOverlap=()=>{this._refList&&this._refDropdown&&!this.props.isTemporaryRender&&l.default.floaterEscapeOverlap(this._refDropdown,10)},this.onMouseMove=()=>{p.default.focus(this._refDropdown),this.setState({keyboard:!1})},this._selectPrevious=e=>{S(e);var{activeChildren:t,currentlyFocusedIndex:r}=this._getActiveChildren();0!==t.length&&this._focusNewActiveChild(t,r-1)},this.selectNext=e=>{S(e);var{activeChildren:t,currentlyFocusedIndex:r}=this._getActiveChildren();0!==t.length&&this._focusNewActiveChild(t,r+1)},this._getActiveChildren=()=>{var e=[...(0,m.default)(this._refList,"this._refList").querySelectorAll("li:not(.dropdown-item-disabled)")];return{activeChildren:e,currentlyFocusedIndex:e.indexOf(this.state.selected)}},this._focusNewActiveChild=(e,t)=>{var r=(t<0?e.length-1:t)%e.length;p.default.focus(e[r]),this.setState({keyboard:!0,selected:e[r]})},this.close=e=>{e.preventDefault();var{uim:t}=this.props;t&&t.uie.requestDismiss()},this.default=e=>{var t=this.props.onDefault;if(t){c.default.shouldIndicateFocus();var{uim:r}=this.props;r&&r.uie.requestDismiss(),t(e)}},this._resetSelected=e=>{e.stopPropagation(),p.default.focus(this._refDropdown),this.setState({selected:void 0})}}getElement(){return this._refDropdown}_allowKeyboard(){var e=this.props.type;return"emoji_picker"!==e&&"sticker_picker"!==e&&"color_picker"!==e&&"dropdown_text"!==e}componentDidMount(){if(this._floaterEscapeOverlap(),this._allowKeyboard()){var{autoFocus:e,children:t,findFirstItem:r}=this.props;if(e){var a,i,n=null===(a=this._refList)||void 0===a?void 0:a.querySelector("[tabindex]");r&&n||this._refList&&this._refList.firstChild instanceof HTMLDivElement&&n?i=n:this._refList&&this._refList.children.length>0?i=this._refList.children[0]:null!=t&&(i=o.Children.toArray(t)[0]),p.default.focus(i),this.setState({keyboard:!0,selected:i})}else p.default.focus(this._refDropdown)}}componentDidUpdate(e){e.isTemporaryRender&&!this.props.isTemporaryRender&&this._floaterEscapeOverlap()}getStyle(){var e=this.props,t={},r=e.flipOnRTL&&_.default.isRTL()?e.dirX===v.LEFT?v.RIGHT:v.LEFT:e.dirX,a=e.dirY,i=r===v.RIGHT?v.LEFT:v.RIGHT,s=a===E.TOP?E.BOTTOM:E.TOP;if(t[d.default.prefix("transformOrigin")]=s+" "+i,!e.origin)return(0,n.default)(t,e.style);if(r===v.RIGHT?t.left=e.origin.x:t.right=window.innerWidth-e.origin.x,a===E.BOTTOM){var o;t.top=e.origin.y;var l=null===(o=this._refDropdown)||void 0===o?void 0:o.offsetHeight;if(null!=l){var u=window.innerHeight-l-32;t.top=Math.min(u,(0,m.default)(e.origin,"p.origin").y)}}else t.bottom=window.innerHeight-e.origin.y;return(0,n.default)(t,e.style)}render(){var e=this.props,t=e.type,r=(0,s.default)({[u.default.container]:"dropdown"===t||"dropdown_menu"===t||"emoji_picker"===t||"sticker_picker"===t||"color_picker"===t||"dropdown_text"===t,[u.default.right]:"dropdown_menu"===t,[u.default.icons]:"menu"===t,[u.default.picker]:"picker"===t,[u.default.emoji]:"emoji_picker"===t,[u.default.sticker]:"sticker_picker"===t,[u.default.colorPicker]:"color_picker"===t,[u.default.text]:"dropdown_text"===t,[u.default.tooltip]:"tooltip"===t,[u.default.inverse]:("picker"===t||"emoji_picker"===t||"sticker_picker"===t||"color_picker"===t||"dropdown_text"===t||"tooltip"===t)&&e.dirX===v.LEFT,[u.default.inverseVertical]:("emoji_picker"===t||"sticker_picker"===t||"color_picker"===t||"dropdown_text"===t)&&e.dirY===E.TOP}),a="picker"===t||"emoji_picker"===t||"sticker_picker"===t||"dropdown_text"===t||"tooltip"===t?o.createElement("div",{className:u.default.nib,"data-animate-dropdown-nib":!0}):null;if(this._allowKeyboard()){var i={enter:this.default,tab:S,"shift+tab":S,up:()=>{},down:()=>{}};return e.horizontal?(i[_.default.LR("left","right")]=this._selectPrevious,i[_.default.LR("right","left")]=this.selectNext,i[_.default.LR("up","down")]=this._selectPrevious,i[_.default.LR("down","up")]=this.selectNext):(i.up=this._selectPrevious,i.down=this.selectNext,i[_.default.LR("left","right")]=this.close,i[_.default.LR("right","left")]=this.default),o.createElement(f.default,{onRef:this._setRefDropdown,handlers:i,className:r,style:this.getStyle(),onMouseMove:this.state.keyboard?this.onMouseMove:null,onMouseUp:this._resetSelected},o.createElement("ul",{ref:this._setRefList,className:u.default.items},e.children),a)}return o.createElement("div",{ref:this._setRefDropdown,className:r,style:this.getStyle()},e.children,a)}}function S(e){e.stopPropagation(),e.preventDefault()}y.defaultProps={type:"dropdown",dirX:v.RIGHT,dirY:E.BOTTOM},y.displayName="Dropdown";var T=(0,h.default)(y);t.default=T},4170:(e,t,r)=>{"use strict";var a=r(14859),i=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.openExternalLink=function(e){if(!d.default.hasValidUrlScheme(e))return void(e.toLowerCase().startsWith("javascript:")&&(__LOG__(4,void 0,new Error,!0)`Bad url: ${e}`,SEND_LOGS("URL error")));var t=document.createElement("a");t.href=e,t.target="_blank",t.rel="noopener noreferrer",t.style.display="none",document&&document.body&&document.body.appendChild(t);t.click(),document&&document.body&&document.body.removeChild(t)},t.default=void 0;var n=i(r(2784)),s=a(r(23045)),o=(a(r(76887)),a(r(9676))),l=r(89874),d=a(r(22006));class u extends n.PureComponent{constructor(...e){super(...e),this._elRef=n.createRef(),this._onKeyDown=e=>{var t;(0,o.default)(e)&&(null===(t=this._elRef.current)||void 0===t||t.click())}}render(){var{children:e,className:t,href:r,isLongTemplateUrl:a,onClick:i}=this.props;return d.default.hasValidUrlScheme(r)?a?n.createElement("a",{ref:this._elRef,rel:"noopener noreferrer",className:t,href:r,target:"_blank",onClick:i,onKeyDown:this._onKeyDown},(0,l.substring)(r,0,s.default.TEMPLATE_URL_START),n.createElement("span",null,""),(0,l.substring)(r,r.length-s.default.TEMPLATE_URL_END,r.length)):n.createElement("a",{ref:this._elRef,rel:"noopener noreferrer",className:t,href:r,target:"_blank",onClick:i,onKeyDown:this._onKeyDown},e):(r.toLowerCase().startsWith("javascript:")&&(__LOG__(4,void 0,new Error,!0)`Bad url: ${r}`,SEND_LOGS("URL error")),n.createElement("a",null))}}t.default=u,u.displayName="ExternalLink"},10765:(e,t,r)=>{"use strict";var a=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.DefaultFavicon=s,t.ErrorFavicon=o;var i=a(r(2784)),n=r(16120);function s({children:e}){return i.useEffect((()=>{(0,n.setTitleAndIcon)(0)}),[]),e}function o({children:e}){return i.useEffect((()=>{(0,n.setTitleAndIcon)(-1)}),[]),e}s.displayName="DefaultFavicon",o.displayName="ErrorFavicon"},66368:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"FlexItem",{enumerable:!0,get:function(){return d.FlexItem}}),t.FlexColumn=t.FlexRow=t.FlexContainer=void 0;var n=i(r(58527)),s=i(r(72779)),o=a(r(2784)),l=i(r(5947)),d=r(13583),u=o.forwardRef((function(e,t){var{align:r="start",as:a="div",direction:i,justify:n="start",wrap:d="nowrap",children:u,className:c,style:p}=e;return o.createElement(a,{className:(0,s.default)({[l.default.flex]:!0,[l.default.justifyStart]:"start"===n,[l.default.justifyCenter]:"center"===n,[l.default.justifyEnd]:"end"===n,[l.default.justifyAll]:"all"===n,[l.default.justifyAround]:"around"===n,[l.default.justifyEvenly]:"evenly"===n,[l.default.directionVertical]:"vertical"===i,[l.default.directionHorizontal]:"horizontal"===i,[l.default.directionVerticalReverse]:"vertical-reverse"===i,[l.default.directionHorizontalReverse]:"horizontal-reverse"===i,[l.default.alignStart]:"start"===r,[l.default.alignCenter]:"center"===r,[l.default.alignEnd]:"end"===r,[l.default.alignStretch]:"stretch"===r,[l.default.alignBaseline]:"baseline"===r,[l.default.wrap]:"wrap"===d,[l.default.wrapReverse]:"wrap-reverse"===d},c),ref:t,style:p},u)}));t.FlexContainer=u,u.displayName="FlexContainer";var c=o.forwardRef((function(e,t){return o.createElement(u,(0,n.default)({},e,{direction:"horizontal",ref:t}),e.children)}));t.FlexRow=c,c.displayName="FlexRow";var p=o.forwardRef((function(e,t){return o.createElement(u,(0,n.default)({},e,{direction:"vertical",ref:t}),e.children)}));t.FlexColumn=p,p.displayName="FlexColumn"},13583:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.FlexItem=void 0;var n=i(r(70417)),s=i(r(72779)),o=a(r(2784)),l=i(r(18929)),d=i(r(92312)),u=o.forwardRef((function(e,t){var{a8nText:r,align:a="auto",as:i="div",basis:u,className:c,children:p,order:h,grow:f,shrink:_,style:m}=e,g={flexBasis:"string"==typeof u||null==u?u:`${u}px`,flexGrow:f,flexShrink:_,order:h};return o.createElement(i,{className:(0,s.default)({[d.default.flexItem]:!0,[d.default.alignAuto]:"auto"===a,[d.default.alignStart]:"start"===a,[d.default.alignCenter]:"center"===a,[d.default.alignEnd]:"end"===a,[d.default.alignStretch]:"stretch"===a},c),"data-a8n":r,ref:t,style:(0,n.default)((0,n.default)({},m),(0,l.default)(g))},p)}));t.FlexItem=u,u.displayName="FlexItem"},45713:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){var[e,t]=(0,a.useState)(!1),r=(0,n.useFocusVisibility)();return[(0,i.useFocus)({onFocusChange:t}),e&&r]};var a=r(2784),i=r(44794),n=r(36895)},528:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){var e=(0,a.useRef)(!1);return(0,a.useEffect)((()=>(e.current=!0,()=>{e.current=!1})),[]),(0,a.useCallback)((()=>e.current),[])};var a=r(2784)},78578:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.useListener=function(e,t,r,a){var n=(0,i.useRef)(r),o=(0,i.useRef)(null);return(0,i.useEffect)((()=>{n.current=r}),[r]),(0,i.useEffect)((()=>s(o,e,t,((...e)=>{var t;null===(t=n.current)||void 0===t||t.call(n,...e)}),a)),[e,t]),()=>{var e;null===(e=o.current)||void 0===e||e.disengage()}},t.useListenerRef=function(e,t,r,a){var n=(0,i.useRef)(r),o=(0,i.useRef)(null);return(0,i.useEffect)((()=>{n.current=r}),[r]),(0,i.useEffect)((()=>{var r=e.current;if(null!=r)return s(o,r,t,((...e)=>{var t;null===(t=n.current)||void 0===t||t.call(n,...e)}),a)}),[e,t]),()=>{var e;null===(e=o.current)||void 0===e||e.disengage()}};var i=r(2784),n=a(r(45387));function s(e,t,r,a,i){if(null==t)return e.current=null,()=>{};var s=new n.default(t,r,a,i);return s.engage(),e.current=s,()=>{s.disengage(),e.current=null}}},49143:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(...e){return(0,a.useMemo)((function(){return t=>{for(var r of e)null!=r&&("function"!=typeof r?"object"!=typeof r?(__LOG__(4,void 0,new Error,!0)`mergeRefs cannot handle refs that are not a function or a react ref`,SEND_LOGS("react-bad-ref")):r.current=t:r(t))}}),[...e])};var a=r(2784)},37766:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var r,a=(0,i.useRef)(),o=!0===(null==t?void 0:t.disabled),l=o?s:e;return[e=>{a.current=e},{"aria-disabled":null!==(r=null==t?void 0:t.disabled)&&void 0!==r?r:void 0,onClick:l,onKeyPress:function(e){var t;(0,n.default)(e)&&(e.stopPropagation(),e.preventDefault(),null===(t=a.current)||void 0===t||t.click())},role:"button",tabIndex:o?-1:0}]};var i=r(2784),n=a(r(9676));function s(){}},87958:(e,t,r)=>{"use strict";var a=r(14859),i=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.Component=void 0;var n=i(r(2784)),s=a(r(23045)),o=i(r(24461)),l=a(r(85185)),d=a(r(53606)),u=a(r(4011)),c=r(64812),p=a(r(22006)),h=new u.default;class f extends n.Component{static getDerivedStateFromProps(e,t){return e.src!==t.src?{src:e.src,available:!0}:null}constructor(e){super(e),this._refNative=n.createRef(),this.getElement=()=>this._refNative.current,this.onLoad=e=>{var{target:t}=e;if(t instanceof HTMLImageElement){var r=this.getImgElement();r&&r.complete&&this._showImgElement(r),this.props.onLoad&&this.props.onLoad({target:t}),this.setState({loading:!1})}},this.onError=e=>{this.setState({available:!1});var{src:t,crossOrigin:r,noXHR:a,hasPrivacyChecks:i}=this.props;if(t&&function(e){return"/"===e[0]||p.default.isHttp(e)}(t)){var n,s=this.retry;if(s)if(_(s,this.props)){if(!s.noXHR)return;n=s}else{s.release()&&h.remove(s),n=new d.default(t,r,a,i)}else n=new d.default(t,r,a,i);this.retry=n,h.enqueue(n).checkpoint(this.props.rejectOnUnmount()).then((()=>{n===this.retry&&this.setState({available:!0})})).catchTypes(o.ServerStatusError,o.GaveUpRetry,(e=>{n===this.retry&&(this.props.rejectOnUnmount().isRejected()||(this.setState({available:!1,error:e}),this.props.onError&&this.props.onError(e)))})).catchTypes(o.Unmount,Promise.CancellationError,(()=>{}))}else this.setState({error:e.error})},this.onContextMenu=e=>{this.props.disableContextMenu&&e.preventDefault()},this.state={src:e.src,available:!0,error:null,loading:!0}}componentDidMount(){if(this.props.src){var e=this.getImgElement();e&&!e.complete&&this._hideImgElement(e)}}componentDidUpdate(e){if(_(e,this.props)||this._cancelRetry(),this.props.src){var t=this.getImgElement();t&&!t.complete&&this._hideImgElement(t)}}componentWillUnmount(){this._cancelRetry()}_cancelRetry(){if(this.retry){var e=this.retry;e.release()&&h.remove(e)}}getImgElement(){return this._refNative.current}_showImgElement(e){"visible"!==e.style.visibility&&(e.style.visibility="visible")}_hideImgElement(e){"hidden"!==e.style.visibility&&(e.style.visibility="hidden")}render(){var{alt:e,className:t,crossOrigin:r,draggable:a,onClick:i,onMouseMove:o,plainText:l,selectable:d,src:u,style:p,renderLoading:h,renderError:f}=this.props,{available:_,error:m,loading:g}=this.state;if(m&&f)return f(m);var v=Boolean(_&&u);return n.createElement(n.Fragment,null,n.createElement(c.SelectableImg,{ref:this._refNative,plainText:l||"",selectable:Boolean(d),crossOrigin:r?"anonymous":void 0,onError:v?this.onError:()=>{},onLoad:v?this.onLoad:()=>{},src:v&&null!=u?u:s.default.ONE_BY_ONE_TRANS_GIF,alt:e,className:t,draggable:a,onClick:i,onMouseMove:o,style:p,onContextMenu:this.onContextMenu}),g&&h&&h())}}function _(e,t){return e.src===t.src&&e.crossOrigin===t.crossOrigin&&e.noXHR===t.noXHR&&e.hasPrivacyChecks===t.hasPrivacyChecks}f.defaultProps={crossOrigin:!0,noXHR:!1,hasPrivacyChecks:!0},f.displayName="Img";var m=f;t.Component=m;var g=(0,l.default)(f);t.default=g},53606:(e,t,r)=>{"use strict";var a=r(14859),i=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(r(24461)),s=a(r(84161)),o=a(r(1876));t.default=class{constructor(e,t,r,a){this.src=e,this.crossOrigin=t,this.noXHR=r,this.hasPrivacyChecks=a,this.generation=0,this.refCount=0,this.inProgress=!1}key(){return`co:${this.crossOrigin?"Y":"N"},noXHR:${this.noXHR?"Y":"N"},src:${this.src}`}sendXHR(){if(this.noXHR)return Promise.resolve(!0);var e=this.src;return this.inProgress=!0,this._xhrPromise=o.default.get(e).timeout(3e4,"ImgRetryTimeout"),this._xhrPromise.then((t=>{var{status:r}=t;if(r>=200&&r<400)return!0;if(r>=500)return __LOG__(2)`Img:Retry ${e} failed with error code ${r}. Retrying.`,new s.default.WebcImgError({webcImgErrorCode:r}).commit(),!1;throw __LOG__(2)`Img:Retry ${e} failed with error code ${r}. Not retrying.`,new s.default.WebcImgError({webcImgErrorCode:r}).commit(),new n.ServerStatusError(null,e,r)})).catch((e=>{if(e instanceof n.ServerStatusError)throw e;return!1})).finally((()=>{this.inProgress=!1}))}release(){return this.refCount--,this.refCount<=0&&(this._xhrPromise&&this._xhrPromise.cancel(),!0)}shouldRetain(){return this.refCount>0}}},4011:(e,t,r)=>{"use strict";var a=r(14859),i=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(r(24461)),s=a(r(45026)),o=r(31046),l=a(r(66622)),d=i(r(56179)),u=a(r(21830));class c{constructor(){this._queue=new Map,this._inDelay=new Map,this._numInProgress=0}static maxInProgressRetry(){return 20}enqueue(e){var t=this._queue.get(e.key());if(t){if(e.hasPrivacyChecks!==t.hasPrivacyChecks){var r=`Img:hasPrivacyChecks shouldn't change ${e.key()}`;return Promise.reject(r)}return t.refCount++,t.promise}return e.promise=new Promise(((t,r)=>{e.resolve=t,e.reject=r})),e.refCount++,this._addToQueue(e),e.promise}remove(e){var t=e.key();this._queue.delete(t);var r=this._inDelay.get(t);r&&(r.cancel(),this._inDelay.delete(t))}_addToQueue(e){var t=e.generation;if(e.generation++,t>10){var r=`Stop retrying ${e.src} after 10 times`;throw new n.GaveUpRetry(r)}var a=e.key();if(0===t)this._queue.set(a,e),this._startProcessing();else{var i=d.expDelaySec(t,60,0).cancellable().catchType(Promise.CancellationError,(()=>{}));this._inDelay.set(e.key(),i),i.then((()=>{this._inDelay.delete(a),this._queue.set(a,e),this._startProcessing()}))}}_startProcessing(){this._waitPromise||(this._waitPromise=l.default.waitIfOffline({signal:(new s.default).signal}).then((()=>{this._waitPromise=null,o.UIBusyTasks.enqueue((()=>{this._processRetries()}))})))}_processRetries(){for(var e,t=this._queue.values();(e=t.next())&&!e.done&&!(this._numInProgress>c.maxInProgressRetry());){var r=e.value;this._processRetry((0,u.default)(r,"retry"))}}_processRetry(e){e.inProgress||(e.promise.isPending()?(this._numInProgress++,e.sendXHR().then((t=>{this._queue.delete(e.key()),t?e.resolve():e.shouldRetain()&&this._addToQueue(e)})).catch((t=>{this._queue.delete(e.key()),e.reject(t)})).finally((()=>{this._numInProgress--}))):this._queue.delete(e.key()))}}t.default=c},2739:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(r(45455)),s=a(r(2784)),o=i(r(38637)),l=r(64812),d=/(.*?)__(\w+?)__/g;class u extends s.PureComponent{translate(){var e,t,{id:r,plural:a,params:i}=this.props,l=o.default.t(r,{_plural:a});if(!i||(0,n.default)(i))return l;for(var u=[];e=d.exec(l);){var c=e;u.push(c[1]);var p=c[2];if(p&&null!=i[p]){var h=Array.isArray(i[p])?i[p].map(((e,t)=>s.createElement(s.Fragment,{key:`child_${t}`},e))):s.createElement(s.Fragment,{key:p},i[p]);u.push(h)}t=c.index+c[0].length}return"number"==typeof t&&t<l.length&&u.push(l.slice(t)),0===u.length?l:u}render(){var{onClick:e,wrapInHiddenToken:t}=this.props;return s.createElement(l.SelectableSpan,{dir:o.default.isRTL()?"rtl":"ltr",selectable:!t,onClick:e},this.translate())}}t.default=u,u.defaultProps={wrapInHiddenToken:!0},u.displayName="L10n"},80450:(e,t,r)=>{"use strict";var a=r(14859),i=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(r(2784)),s=a(r(6242));t.default=({max:e=100,value:t})=>n.createElement("progress",{value:t,max:e,dir:"ltr",className:s.default.progress})},19556:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(r(72779)),s=a(r(2784)),o=i(r(58160)),l=i(r(87958)),d=i(r(4739)),u=i(r(74073)),c=i(r(68267)),p=i(r(18779)),h=i(r(82838)),f={low:r(89293),high:r(67634)},_={low:r(45361),high:r(64229)},m="FIRST_OPEN",g="READY",v="LOADING",E="FIRST_PLAY",y="ENDED",S="REPLAY";class T extends s.Component{constructor(...e){super(...e),this.playerRef=s.createRef(),this.state={state:m},this._onPosterLoad=()=>{this.setState({state:g})},this._onFirstPlay=e=>{this.setState({state:v}),e.stopPropagation(),e.preventDefault()},this.onCanPlay=()=>{this.state.state===v&&this.setState({state:E})},this.onEnded=()=>{this.setState({state:y})},this._onReplay=()=>{this.setState({state:S});var e=this.playerRef&&this.playerRef.current;e&&e.play()}}componentDidMount(){this.props.listeners.add(window,"dpichange",(()=>{this.forceUpdate()}))}render(){var e,t,r=this.state.state;r===m&&(e=s.createElement("div",{className:u.default.overlay},s.createElement(c.default,{size:32})),t=this._onPosterLoad);var a,i,d=r===m||r===g||r===v?s.createElement(l.default,{className:(0,n.default)(u.default.poster,{[u.default.hidden]:r===m}),src:_[o.default.currentRes],key:"poster",onLoad:t}):null,E=f[o.default.currentRes],S=r!==m&&r!==g?s.createElement("video",{autoPlay:!0,className:u.default.player,controls:!0,controlsList:"nodownload",key:o.default.currentRes,onCanPlayThrough:this.onCanPlay,onEnded:this.onEnded,ref:this.playerRef},s.createElement("source",{src:E,type:"video/mp4"})):null;switch(r){case g:i=this._onFirstPlay,a=s.createElement(b,null);break;case v:a=s.createElement(c.default,{color:"white",size:32});break;case y:i=this._onReplay,a=s.createElement(p.default,{name:"refresh-large"})}var T=a?s.createElement("div",{className:u.default.overlay,role:"button",onClick:i},s.createElement("div",{className:u.default.button},a)):null;return s.createElement("div",{className:u.default.video},s.createElement("div",{className:u.default.container},s.createElement(h.default,{transitionName:"fade"},e,T,d),S))}}T.displayName="Video";var A=(0,d.default)(T);t.default=A;var b=()=>s.createElement("div",{className:u.default.play},s.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"28",height:"34",viewBox:"0 0 28 34"},s.createElement("path",{fill:"#FFF",d:"M1 4.983v24.034a2.982 2.982 0 0 0 4.564 2.53L24.792 19.53a2.981 2.981 0 0 0 0-5.058L5.563 2.454A2.983 2.983 0 0 0 1 4.983z"})))},72257:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(r(72779)),s=a(r(2784)),o=i(r(32944)),l=r(99850),d=i(r(92082)),u=i(r(13277)),c=i(r(76176)),p=i(r(79435)),h=i(r(23045)),f=i(r(4170)),_=r(55848),m=r(66239),g=i(r(20468)),v=i(r(38637)),E=i(r(2739)),y=i(r(4739)),S=i(r(66622)),T=i(r(19870)),A=i(r(88120)),b=i(r(61910)),C=a(r(97022)),P=r(64812),O=i(r(68267)),w=i(r(18779)),M=i(r(75632)),I=i(r(82838)),R=i(r(94407)),D=a(r(15934)),N=i(r(19556)),L=r(99117),k=r(84337),U=r(24606),G=r(70338);class F extends s.Component{constructor(e){super(e),this.onStateChange=()=>{this.setState({offline:!S.default.online,expired:D.default.state===D.STATE.UNPAIRED_IDLE,refValid:D.default.state===D.STATE.UNPAIRED})},this._onQRExpiry=()=>{g.default.supportsFeature(g.default.F.MD_BACKEND)?u.default.refreshQR():D.default.poke()},this._onRememberMeChange=e=>{D.default.isIncognito||R.default.setRememberMe(e.target.checked).catch((()=>{})),(0,m.setRememberMe)(e.target.checked),this.setState({rememberMe:(0,m.getRememberMe)()})},this.state={rememberMe:(0,m.getRememberMe)(),expired:D.default.state===D.STATE.UNPAIRED_IDLE,offline:!S.default.online,refValid:D.default.state===D.STATE.UNPAIRED}}componentDidMount(){this.props.listeners.add(D.default,"change:state change:online",this.onStateChange)}render(){var e;e=this.state.offline?s.createElement(B,null,s.createElement("div",{className:b.default.qrButton,key:"expiry"},s.createElement("div",{className:b.default.qrButtonIcon},s.createElement(w.default,{name:"connection"})),v.default.t(444))):this.state.expired?s.createElement(B,null,s.createElement("button",{className:b.default.qrButton,key:"expiry",onClick:this._onQRExpiry},s.createElement("div",{className:b.default.qrButtonIcon},s.createElement(w.default,{name:"refresh-large"})),v.default.t(880))):this.state.refValid?s.createElement(B,null):s.createElement("div",{className:b.default.qrcode},s.createElement(O.default,null));var t,r=this.state.rememberMe?null:s.createElement("div",{className:(0,n.default)(b.default.tip,b.default.rememberMeTip)},v.default.t(791));if(this.props.apiCmd)switch(this.props.apiCmd.resultType){case l.APICmd.GROUP_INVITE:t=s.createElement("div",{className:b.default.groupInviteTip},s.createElement("div",{className:b.default.tip},v.default.t(734)));break;case l.APICmd.MSG_SEND:t=s.createElement("div",{className:b.default.groupInviteTip},s.createElement("div",{className:b.default.tip},v.default.t(991)))}var a=s.createElement("strong",null,s.createElement(E.default,{id:879,params:{android_menu_icon:s.createElement(K,null)}})),i=s.createElement("strong",null,s.createElement(E.default,{id:882,params:{iphone_settings_icon:s.createElement(j,null)}})),o=s.createElement("strong",null,v.default.t(888)),d=s.createElement(E.default,{id:884,params:{android_menu:a,iphone_settings:i,whatsapp_web_menu_item:o}}),u=s.createElement("div",{className:"landing-header"},s.createElement(W,null),s.createElement("div",{className:"landing-headerTitle"},v.default.t(887))),c=s.createElement(N.default,null);return s.createElement("div",{className:"landing-wrapper"},u,s.createElement("div",{className:"landing-window"},s.createElement("div",{className:"landing-main"},s.createElement("div",{className:b.default.qrWrapper},s.createElement("div",{className:b.default.text},s.createElement("div",{className:(0,n.default)("landing-title",b.default.headline)},v.default.t(886)),s.createElement("ol",{className:b.default.list},s.createElement("li",{className:b.default.listItem},v.default.t(883)),s.createElement("li",{className:b.default.listItem},d),s.createElement("li",{className:b.default.listItem},v.default.t(885)))),s.createElement("div",{className:b.default.qr},t,e),s.createElement(f.default,{href:(0,_.getLoginFaqUrl)(),className:b.default.hint},v.default.t(881)),g.default.supportsFeature(g.default.F.MD_BACKEND)?null:s.createElement("div",{className:b.default.toggle},s.createElement(I.default,{transitionName:"fade_sifo"},r),s.createElement("label",null,s.createElement("input",{type:"checkbox",name:"rememberMe",checked:this.state.rememberMe,onChange:this._onRememberMeChange}),v.default.t(928))))),undefined,undefined,c,undefined,undefined,undefined))}}F.displayName="QRCode";class x extends s.Component{constructor(e){super(e),this._setRefContainer=e=>{this._containerElement=e},this._genQR=()=>{var e=this._containerElement;return null==e?Promise.resolve():this.getData().then((t=>{t&&(T.default.inc(),this.qr?this.qr.makeCode(t):this.qr=new A.default(e,{text:t,colorDark:"#122e31",width:h.default.QR_EDGE,height:h.default.QR_EDGE,correctLevel:A.default.CorrectLevel.L}),e.removeAttribute("title"),e.setAttribute("data-ref",t))}))},this.copy=()=>{var e=window.getSelection(),t=document.getElementsByClassName(b.default.codeCopy).item(0);t&&(e.selectAllChildren(t),document.execCommand("copy")),u.default.closeModal()},this.onMouseMove=()=>{this.state.disableCursor&&this.setState({disableCursor:!1}),this._disableCursor()},this.onMouseLeave=()=>{this._disableCursor.cancel(),this.setState({disableCursor:!1})},this.onContextMenu=e=>{e.stopPropagation(),e.preventDefault(),this.getData().then((e=>{u.default.openModal(s.createElement(c.default,{onOK:this.copy,okText:"Copy to Clipboard"},s.createElement(P.SelectableSpan,{className:b.default.codeCopy,selectable:!0},e)))}))},this._disableCursor=this.props.debounce((()=>{this.setState({disableCursor:!0})}),100),this.state={disableCursor:!1}}componentDidMount(){this._genQR(),this.props.listeners.add(p.default,"change:ref",this._genQR),u.default.initialLoadReady()}componentWillUnmount(){T.default.reset()}getData(){if(p.default.connected)return Promise.resolve(void 0);var e=p.default.ref;if(g.default.supportsFeature(g.default.F.MD_BACKEND))return U.waSignalStore.getRegistrationInfo().then((t=>{var r=L.waNoiseInfo.get();if(!r||!r.staticKeyPair||!t)return __LOG__(4,void 0,new Error,!0)`Assertion failed!`,SEND_LOGS("Empty noiseInfo or empty regInfo"),null;var a=(0,k.encodeB64)(r.staticKeyPair.pubKey),i=(0,k.encodeB64)(t.identityKeyPair.pubKey),n=(0,G.getADVSecretKey)();return e+","+a+","+i+","+n}));var t=d.default.id();return Promise.resolve().then((()=>{var r=C.getOrGenerate();return e+","+r+","+t}))}render(){var e=this.props.children,t=(0,n.default)(b.default.qrcode,{[b.default.idle]:!!e}),r=this.state.disableCursor&&null==e?{cursor:"none"}:null;return s.createElement("div",{ref:this._setRefContainer,"data-a8n":o.default.key("qrcode"),className:t,onContextMenu:null,style:r,onMouseMove:this.onMouseMove,onMouseLeave:this.onMouseLeave},s.createElement(I.default,{transitionName:"scale"},e),s.createElement("div",{className:b.default.codeLogo},s.createElement(H,null)))}}x.displayName="Qrcode";var B=(0,M.default)((0,y.default)(x)),Y=(0,y.default)(F);t.default=Y;var K=()=>s.createElement("span",{className:b.default.icon},s.createElement("svg",{height:"24px",viewBox:"0 0 24 24",width:"24px"},s.createElement("rect",{fill:"#f2f2f2",height:"24",rx:"3",width:"24"}),s.createElement("path",{d:"m12 15.5c.825 0 1.5.675 1.5 1.5s-.675 1.5-1.5 1.5-1.5-.675-1.5-1.5.675-1.5 1.5-1.5zm0-2c-.825 0-1.5-.675-1.5-1.5s.675-1.5 1.5-1.5 1.5.675 1.5 1.5-.675 1.5-1.5 1.5zm0-5c-.825 0-1.5-.675-1.5-1.5s.675-1.5 1.5-1.5 1.5.675 1.5 1.5-.675 1.5-1.5 1.5z",fill:"#818b90"}))),j=()=>s.createElement("span",{className:b.default.icon},s.createElement("svg",{width:"24",height:"24",viewBox:"0 0 24 24"},s.createElement("rect",{fill:"#F2F2F2",width:"24",height:"24",rx:"3"}),s.createElement("path",{d:"M12 18.69c-1.08 0-2.1-.25-2.99-.71L11.43 14c.24.06.4.08.56.08.92 0 1.67-.59 1.99-1.59h4.62c-.26 3.49-3.05 6.2-6.6 6.2zm-1.04-6.67c0-.57.48-1.02 1.03-1.02.57 0 1.05.45 1.05 1.02 0 .57-.47 1.03-1.05 1.03-.54.01-1.03-.46-1.03-1.03zM5.4 12c0-2.29 1.08-4.28 2.78-5.49l2.39 4.08c-.42.42-.64.91-.64 1.44 0 .52.21 1 .65 1.44l-2.44 4C6.47 16.26 5.4 14.27 5.4 12zm8.57-.49c-.33-.97-1.08-1.54-1.99-1.54-.16 0-.32.02-.57.08L9.04 5.99c.89-.44 1.89-.69 2.96-.69 3.56 0 6.36 2.72 6.59 6.21h-4.62zM12 19.8c.22 0 .42-.02.65-.04l.44.84c.08.18.25.27.47.24.21-.03.33-.17.36-.38l.14-.93c.41-.11.82-.27 1.21-.44l.69.61c.15.15.33.17.54.07.17-.1.24-.27.2-.48l-.2-.92c.35-.24.69-.52.99-.82l.86.36c.2.08.37.05.53-.14.14-.15.15-.34.03-.52l-.5-.8c.25-.35.45-.73.63-1.12l.95.05c.21.01.37-.09.44-.29.07-.2.01-.38-.16-.51l-.73-.58c.1-.4.19-.83.22-1.27l.89-.28c.2-.07.31-.22.31-.43s-.11-.35-.31-.42l-.89-.28c-.03-.44-.12-.86-.22-1.27l.73-.59c.16-.12.22-.29.16-.5-.07-.2-.23-.31-.44-.29l-.95.04c-.18-.4-.39-.77-.63-1.12l.5-.8c.12-.17.1-.36-.03-.51-.16-.18-.33-.22-.53-.14l-.86.35c-.31-.3-.65-.58-.99-.82l.2-.91c.03-.22-.03-.4-.2-.49-.18-.1-.34-.09-.48.01l-.74.66c-.39-.18-.8-.32-1.21-.43l-.14-.93a.426.426 0 00-.36-.39c-.22-.03-.39.05-.47.22l-.44.84-.43-.02h-.22c-.22 0-.42.01-.65.03l-.44-.84c-.08-.17-.25-.25-.48-.22-.2.03-.33.17-.36.39l-.13.88c-.42.12-.83.26-1.22.44l-.69-.61c-.15-.15-.33-.17-.53-.06-.18.09-.24.26-.2.49l.2.91c-.36.24-.7.52-1 .82l-.86-.35c-.19-.09-.37-.05-.52.13-.14.15-.16.34-.04.51l.5.8c-.25.35-.45.72-.64 1.12l-.94-.04c-.21-.01-.37.1-.44.3-.07.2-.02.38.16.5l.73.59c-.1.41-.19.83-.22 1.27l-.89.29c-.21.07-.31.21-.31.42 0 .22.1.36.31.43l.89.28c.03.44.1.87.22 1.27l-.73.58c-.17.12-.22.31-.16.51.07.2.23.31.44.29l.94-.05c.18.39.39.77.63 1.12l-.5.8c-.12.18-.1.37.04.52.16.18.33.22.52.14l.86-.36c.3.31.64.58.99.82l-.2.92c-.04.22.03.39.2.49.2.1.38.08.54-.07l.69-.61c.39.17.8.33 1.21.44l.13.93c.03.21.16.35.37.39.22.03.39-.06.47-.24l.44-.84c.23.02.44.04.66.04z",fill:"#818b90"}))),W=()=>s.createElement("span",{className:b.default.icon},s.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"39",height:"39",viewBox:"0 0 39 39"},s.createElement("path",{fill:"#00E676",d:"M10.7 32.8l.6.3c2.5 1.5 5.3 2.2 8.1 2.2 8.8 0 16-7.2 16-16 0-4.2-1.7-8.3-4.7-11.3s-7-4.7-11.3-4.7c-8.8 0-16 7.2-15.9 16.1 0 3 .9 5.9 2.4 8.4l.4.6-1.6 5.9 6-1.5z"}),s.createElement("path",{fill:"#FFF",d:"M32.4 6.4C29 2.9 24.3 1 19.5 1 9.3 1 1.1 9.3 1.2 19.4c0 3.2.9 6.3 2.4 9.1L1 38l9.7-2.5c2.7 1.5 5.7 2.2 8.7 2.2 10.1 0 18.3-8.3 18.3-18.4 0-4.9-1.9-9.5-5.3-12.9zM19.5 34.6c-2.7 0-5.4-.7-7.7-2.1l-.6-.3-5.8 1.5L6.9 28l-.4-.6c-4.4-7.1-2.3-16.5 4.9-20.9s16.5-2.3 20.9 4.9 2.3 16.5-4.9 20.9c-2.3 1.5-5.1 2.3-7.9 2.3zm8.8-11.1l-1.1-.5s-1.6-.7-2.6-1.2c-.1 0-.2-.1-.3-.1-.3 0-.5.1-.7.2 0 0-.1.1-1.5 1.7-.1.2-.3.3-.5.3h-.1c-.1 0-.3-.1-.4-.2l-.5-.2c-1.1-.5-2.1-1.1-2.9-1.9-.2-.2-.5-.4-.7-.6-.7-.7-1.4-1.5-1.9-2.4l-.1-.2c-.1-.1-.1-.2-.2-.4 0-.2 0-.4.1-.5 0 0 .4-.5.7-.8.2-.2.3-.5.5-.7.2-.3.3-.7.2-1-.1-.5-1.3-3.2-1.6-3.8-.2-.3-.4-.4-.7-.5h-1.1c-.2 0-.4.1-.6.1l-.1.1c-.2.1-.4.3-.6.4-.2.2-.3.4-.5.6-.7.9-1.1 2-1.1 3.1 0 .8.2 1.6.5 2.3l.1.3c.9 1.9 2.1 3.6 3.7 5.1l.4.4c.3.3.6.5.8.8 2.1 1.8 4.5 3.1 7.2 3.8.3.1.7.1 1 .2h1c.5 0 1.1-.2 1.5-.4.3-.2.5-.2.7-.4l.2-.2c.2-.2.4-.3.6-.5s.4-.4.5-.6c.2-.4.3-.9.4-1.4v-.7s-.1-.1-.3-.2z"}))),H=()=>s.createElement("span",{className:b.default.icon},s.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"64",height:"64",viewBox:"0 0 64 64"},s.createElement("path",{fill:"#FFF",d:"M6.525 43.936a29.596 29.596 0 0 1-3.039-13.075C3.494 14.568 16.755 1.313 33.05 1.313c7.904.004 15.328 3.082 20.91 8.666 5.581 5.586 8.653 13.01 8.65 20.907-.007 16.294-13.266 29.549-29.558 29.549a29.648 29.648 0 0 1-12.508-2.771L1.391 62.687l5.134-18.751z"}),s.createElement("path",{fill:"#123033",d:"M50.801 13.135c-4.739-4.742-11.039-7.354-17.752-7.357-13.837 0-25.094 11.253-25.099 25.085a25.039 25.039 0 0 0 3.349 12.541l-3.56 12.999 13.304-3.488a25.084 25.084 0 0 0 11.996 3.054h.011c13.83 0 25.088-11.256 25.095-25.087.002-6.703-2.607-13.005-7.344-17.747zM33.05 51.733h-.008a20.866 20.866 0 0 1-10.62-2.906l-.762-.452-7.894 2.07 2.108-7.694-.497-.789a20.802 20.802 0 0 1-3.189-11.097c.004-11.496 9.361-20.85 20.87-20.85a20.73 20.73 0 0 1 14.746 6.115 20.733 20.733 0 0 1 6.104 14.752c-.006 11.497-9.363 20.851-20.858 20.851z"}),s.createElement("path",{fill:"#123033",d:"M25.429 19.26a8.65 8.65 0 0 0-1.028.011 2.352 2.352 0 0 0-.95.255c-.221.114-.427.277-.75.582-.305.288-.481.54-.668.782a6.974 6.974 0 0 0-1.443 4.291l.001.003a8.243 8.243 0 0 0 .844 3.607c1.043 2.307 2.763 4.746 5.035 7.008a24.676 24.676 0 0 0 1.657 1.6 24.145 24.145 0 0 0 9.814 5.229s.751.179 1.391.218c.021.001.04.003.061.003a9.207 9.207 0 0 0 1.422-.033 5.086 5.086 0 0 0 2.129-.59c.423-.225.623-.337.978-.561 0 0 .11-.072.319-.23.345-.257.558-.438.845-.736.211-.22.394-.479.534-.772.2-.417.401-1.213.481-1.874.061-.505.042-.781.036-.952-.011-.275-.238-.558-.487-.678l-1.486-.668s-2.222-.967-3.581-1.587a1.278 1.278 0 0 0-.452-.104c-.341-.021-.723.068-.966.324v-.004c-.013-.001-.182.145-2.031 2.385-.102.122-.341.387-.754.362a1.086 1.086 0 0 1-.185-.029 3.402 3.402 0 0 1-.49-.17c-.316-.134-.427-.185-.643-.278l-.013-.006a15.361 15.361 0 0 1-4.013-2.556 15.88 15.88 0 0 1-.927-.885c-1.074-1.041-1.953-2.148-2.607-3.24-.035-.06-.09-.146-.15-.242-.107-.174-.225-.381-.262-.523-.095-.376.157-.678.157-.678s.622-.68.911-1.05c.278-.356.518-.704.671-.952.301-.484.39-.982.238-1.37a216.767 216.767 0 0 0-2.219-5.215c-.156-.339-.598-.589-1.005-.636a6.284 6.284 0 0 0-.414-.041"})))},53373:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(r(829)),s=a(r(2784)),o=i(r(5338)),l=i(r(18792)),d=i(r(79962)),u=i(r(33567));class c extends s.Component{constructor(...e){super(...e),this._refRotateFocus=s.createRef(),this.getElement=()=>this._refRotateFocus.current,this.onKeyDown=e=>{if(!e.metaKey&&!e.ctrlKey){if("Tab"===e.key)return this.onRotateFocus(e);var t=this._refRotateFocus.current;if(t&&t===document.activeElement){var r=t.querySelector("input[data-tab]");r&&(o.default.shouldIndicateFocus(),p(r))}}},this.onRotateFocus=e=>{var t=1;e&&(e.stopPropagation(),e.preventDefault(),t=e.shiftKey?-1:1,o.default.shouldIndicateFocus());var r=this._refRotateFocus.current;if(r){var a=Array.from(r.querySelectorAll("[data-tab]"));if(a.length){a=(0,n.default)(a,(e=>parseInt(e.getAttribute("data-tab"),10)||0));var i=0,s=document.activeElement;s&&(i=(0,d.default)(a,a.findIndex((e=>e.contains(s)))+t));var l=a[i];o.default.shouldIndicateFocus(),p(l)}}}}render(){return s.createElement("div",{ref:this._refRotateFocus,style:this.props.style,className:u.default.container,onKeyDown:this.onKeyDown,tabIndex:"-1"},this.props.children)}}function p(e){e.restoreFocus?e.restoreFocus():l.default.focus(e)}t.default=c,c.displayName="RotateFocus"},51131:(e,t,r)=>{"use strict";var a=r(14859),i=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(r(2784)),s=r(65712),o=a(r(95316)),l=a(r(46602)),d=r(28103).Mirrored(["FORWARD","REVERSE"]);class u extends n.Component{constructor(...e){super(...e),this._refRotateFocus=n.createRef(),this.getElement=()=>this._refRotateFocus.current,this.onKeyDown=e=>{if(!e.metaKey&&!e.ctrlKey)return e.key===o.default.KEYBOARD_EVENT_KEY_VALUE.TAB?this.onRotateFocus(e):void 0},this.onRotateFocus=e=>{var t=this._refRotateFocus.current;if(t){var r=e.shiftKey?d.REVERSE:d.FORWARD,a=(0,s.tabbable)(t);if(!(a.length<1)){var i=a[0],n=a[a.length-1],o=document.activeElement;r===d.FORWARD&&o===n?(e.preventDefault(),i.focus()):r!==d.REVERSE||o!==i&&o!==t||(e.preventDefault(),n.focus())}}}}render(){return n.createElement("div",{ref:this._refRotateFocus,className:l.default.container,onKeyDown:this.onKeyDown,tabIndex:"-1",onBlur:this.props.onBlur,role:"dialog"},this.props.children)}}t.default=u,u.displayName="RotateFocusModal"},16595:(e,t,r)=>{"use strict";var a=r(14859),i=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(r(2784)),s=a(r(30430)),o=a(r(23045)),l=r(4170),d=a(r(38637)),u=a(r(22006));t.default=()=>{var e=u.default.build(o.default.SMB_TOS_LEARN_MORE_LINK,{lg:d.default.getLocale()});return n.createElement(s.default,{href:e,onClick:t=>{t.preventDefault(),setTimeout((()=>(0,l.openExternalLink)(e)),10)}},d.default.t(835))}},68267:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.colorOptions=t.styleThemeOptions=void 0;var n=i(r(72779)),s=a(r(2784)),o=i(r(89765)),l=i(r(56517)),d=(0,o.default)({noop:null});t.styleThemeOptions=d;var u=(0,o.default)({default:null,highlight:null,solidwhite:null,white:null,accent:null});t.colorOptions=u;class c extends s.PureComponent{componentDidMount(){}render(){var{size:e,stroke:t,styleThemes:r,color:a,outgoingMsg:i}=this.props,o=40+t,d=(0,n.default)(l.default.path,l.default[a],{[l.default.in]:!1===i,[l.default.out]:i});return s.createElement("svg",{className:(0,n.default)(l.default.container,r&&r.map((e=>l.default[e]))),width:e,height:e,viewBox:"0 0 "+o+" "+o,role:"status"},s.createElement("circle",{className:d,cx:o/2,cy:o/2,r:20,fill:"none",strokeWidth:t}))}}t.default=c,c.defaultProps={color:u.default,size:65,stroke:4},c.displayName="Spinner"},37018:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.StorageCommand=void 0;var i=a(r(71107));class n extends i.default{}t.StorageCommand=n;var s=new n;t.default=s},18779:(e,t,r)=>{"use strict";var a=r(14859),i=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var{className:t,color:r,directional:a,display:i,containerRef:l,name:d,"aria-label":u,title:c,style:p}=e;return n.createElement(o.default,{"aria-label":u,className:t,color:r,containerRef:l,isRTL:!!a&&s.default.isRTL(),display:i,name:d,title:c,style:p})};var n=i(r(2784)),s=a(r(38637)),o=a(r(70601))},70601:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.loadSVGData=_,t.loadSpecificSVG=function(e){return _().then((()=>n[e]))},t.default=void 0;var n,s,o=i(r(58527)),l=i(r(22220)),d=i(r(72779)),u=r(60266),c=r(13275),p=a(r(2784)),h=i(r(25534)),f=a(r(56179));function _(){return s||(s=(0,c.promiseLoop)(((e,t,a)=>{var i=(0,u.delayMs)(f.expBackoff(a,12e4,1e3,.1));return r.e(5512).then(r.bind(r,64421)).then((t=>{n=t.default,e()})).catch((()=>i))})))}class m extends p.PureComponent{constructor(...e){super(...e),this.state={loaded:!!n}}componentDidMount(){this.state.loaded||(this.loading=_().cancellable().then((()=>{this.setState({loaded:!0})})).catch((()=>{})))}componentWillUnmount(){this.loading&&this.loading.cancel()}render(){var e=this.props,{"aria-label":t,name:r,isRTL:a,className:i,display:s,containerRef:u}=e,c=(0,l.default)(e,["aria-label","name","isRTL","className","display","containerRef"]);if(n&&!n[r])throw new Error("Missing SVG for '"+r+"'!");var f=n?{__html:n[r]}:void 0,_=this.props.color?h.default[this.props.color]:null,m=(0,d.default)(_,i,{[h.default.reverse]:a,[h.default.inline]:"inline"===s});return p.createElement("span",(0,o.default)({"data-testid":r,"aria-label":t,ref:u,"data-icon":r,className:m,dangerouslySetInnerHTML:f},c))}}t.default=m,m.displayName="SVGBase"},74315:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=u,t.TextHeader=function(e){var{level:t="1"}=e,r=(0,s.default)(e,["level"]);return o.createElement(u,(0,n.default)({as:c[t]},r))},t.TextParagraph=function(e){return o.createElement(u,(0,n.default)({as:"p"},e))},t.TextDiv=function(e){return o.createElement(u,(0,n.default)({as:"div"},e))},t.TextSpan=function(e){return o.createElement(u,(0,n.default)({as:"span"},e))};var n=i(r(58527)),s=i(r(22220)),o=a(r(2784)),l=i(r(72779)),d=i(r(73128));function u(e){var t,r,a,i,n=null!==(t=e.as)&&void 0!==t?t:"span",s=e.theme?d.default[e.theme]:null,u=e.color?d.default[`color-${e.color}`]:null,c=d.default[`weight-${null!==(r=e.weight)&&void 0!==r?r:"normal"}`],p=null!=e.customSize?null:null!==(a=e.size)&&void 0!==a?a:"14",h=null!=p?d.default[`size-${p}`]:null;return null!=e.customSize&&(i={fontSize:"string"==typeof e.customSize?e.customSize:`${e.customSize}px`}),o.createElement(n,{className:(0,l.default)(s,u,h,c,e.className),style:i},e.children)}var c={1:"h1",2:"h2",3:"h3",4:"h4",5:"h5",6:"h6"}},97025:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.genId=function(e){return(0,n.default)(e||"toast")},t.default=t.ToastBody=t.ToastDismissBtn=t.ToastActionBtn=t.Toast=void 0;var n=i(r(74930)),s=i(r(72779)),o=a(r(2784)),l=i(r(13277)),d=i(r(18779)),u=i(r(75632)),c=i(r(19677));class p extends o.PureComponent{constructor(...e){super(...e),this.delay=this.props.setTimeout((()=>{l.default.closeToast(this)}),this.props.duration),this.onDismiss=()=>{l.default.closeToast(this),this.props.onDismiss&&this.props.onDismiss()}}getId(){return this.props.id}restartDelay(){this.props.clearTimeout(this.delay),this.delay=this.props.setTimeout((()=>{l.default.closeToast(this)}),this.props.duration)}render(){var e,{msg:t,action:r}=this.props;return r&&(e=o.createElement(h,{buttonText:r.actionText,onClick:r.dismiss?this.onDismiss:r.onAction,theme:r.theme})),o.createElement(_,{actionText:t,actionBtn:e})}}t.Toast=p,p.defaultProps={duration:4e3},p.displayName="Toast";var h=({buttonText:e,onClick:t,theme:r})=>o.createElement("button",{className:(0,s.default)(c.default.button,{[c.default.btnSuccess]:"success"===r}),onClick:t},e);t.ToastActionBtn=h,h.displayName="ToastActionBtn";var f=({buttonText:e,onClick:t})=>o.createElement("button",{className:c.default.close,onClick:t},o.createElement(d.default,{name:"x-alt"}));t.ToastDismissBtn=f,f.displayName="ToastDismissBtn";var _=({toastPosition:e,actionText:t,actionBtn:r,dismissBtn:a})=>{var i=(0,s.default)(c.default.toast,{[c.default.right]:"RIGHT"===e});return o.createElement("div",{className:i},o.createElement("span",null,t),r,a)};t.ToastBody=_,_.displayName="ToastBody";var m=(0,u.default)(p);t.default=class extends m{restartDelay(){var e=this.getComponent();e&&e.restartDelay()}}},18932:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(r(829)),s=i(r(17620)),o=i(r(72779)),l=a(r(2784)),d=i(r(13277)),u=i(r(4739)),c=i(r(89868)),p=i(r(97025)),h=i(r(65481)),f=i(r(11018)),_=i(r(82838));class m extends l.Component{constructor(...e){super(...e),this.state={toasts:{}},this._refToasts=new Map,this._setRefToast=(e,t)=>{t?this._refToasts.set(e,t):this._refToasts.delete(e)},this._setToastRefCache=new c.default(this._setRefToast),this.openToast=e=>{var t;(t=this._refToasts.get(e.props.id))&&t instanceof p.default?t.restartDelay():(this.state.toasts[e.props.id]=e,this.setState({toasts:this.state.toasts}))},this.closeToast=e=>{var t=this.state.toasts;t[e.props.id]&&this.setState({toasts:(0,s.default)(t,e.props.id)})}}componentDidMount(){this.props.listeners.add(d.default,"open_toast",this.openToast),this.props.listeners.add(d.default,"close_toast",this.closeToast)}componentDidUpdate(e,t){this._animateEnter=Object.keys(t.toasts).length>Object.keys(this.state.toasts).length}render(){var e=this._animateEnter,t=(0,n.default)(this.state.toasts,"id").reverse().map(((t,r)=>{var a=r<3?h.default[`slide${r}`]:h.default.slide3;return 0!==r||e||(a=""),l.createElement("div",{key:t.props.id,ref:this._setToastRefCache.getRefSetter(t.props.id),className:(0,o.default)(h.default.wrapper,a)},l.cloneElement(t))})),r=f.default.isTrident?"fade_sifo":"toast-transition";return l.createElement(_.default,{transitionName:r},t)}}m.displayName="ToastManager";var g=(0,u.default)(m);t.default=g},5431:(e,t,r)=>{"use strict";var a=r(14859),i=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(r(2784)),s=a(r(76338)),o=a(r(569)),l=a(r(97212)),d=null;class u extends n.Component{constructor(e,t){super(e,t),this._didMount=!1,this._pendingRequestFocus=!1,this._requestFocusTimeout=null,this._refAnchorElement=n.createRef(),this._setRefChild=e=>{var t="function"==typeof(null==e?void 0:e.getComponent)?e.getComponent():e;this._refChild=t,this.props.children&&"function"==typeof this.props.children.ref&&this.props.children.ref(t)},this.uim=this.context?this.context.branch(this):new o.default(void 0,this)}componentDidUpdate(e){e.uimState!==this.props.uimState&&(this.uim.state=this.props.uimState)}componentWillUnmount(){d&&this._requestFocusTimeout===d&&(clearTimeout(d),d=null),this.uim.pop(!0,this.props.requestRecentFocusOnUnmount)}activate(){this.uim.activate()}popable(){return this.props.popable}escapable(){return this.props.escapable}requestDismiss(e){this.props.requestDismiss&&this.props.requestDismiss(e)}componentDidMount(){var{requestFocus:e}=this.props;this._didMount=!0,e&&this._pendingRequestFocus&&this._maybeCallRequestFocus()}requestFocus(){var{requestFocus:e}=this.props;e&&this._didMount?this._maybeCallRequestFocus():this._pendingRequestFocus=!0}getDisplayName(){return this.props.displayName}getRef(){return this._refChild}getUIMState(){return this.props.uimState}getNode(){var e=this._refChild;if(null!=e){if(e instanceof HTMLElement)return e;var t="";try{var r=e.getElement();if(null==r||r instanceof HTMLElement)return r;t=`Non HTML element received:\n${(0,s.default)(r.constructor)}`}catch(e){t=`${e.message}:\n${e.stack}`}__LOG__(4,void 0,new Error,!0)`UIE received a child component that does not have a compatible API:\n${t}`,SEND_LOGS("uie-bad-child-api");var a=this._refAnchorElement.current;if((null==a?void 0:a.previousElementSibling)instanceof HTMLElement)return a.previousElementSibling}return null}render(){var{children:e}=this.props;if(!e)return null;var t=n.cloneElement(e,{ref:this._setRefChild});return n.createElement(l.default.Provider,{value:this.uim},t,n.createElement("div",{ref:this._refAnchorElement,style:{display:"none"},hidden:!0}))}_maybeCallRequestFocus(){var{requestFocus:e}=this.props;e&&(d&&clearTimeout(d),this._requestFocusTimeout=d=setTimeout((()=>{e(),this._requestFocusTimeout=d=null}),0))}}t.default=u,u.State=o.default.State,u.defaultProps={uimState:o.default.State.ACTIVE,requestRecentFocusOnUnmount:!0},u.contextType=l.default,u.displayName="UIE"},86541:(e,t,r)=>{"use strict";var a=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(2784)),n=i.forwardRef((function({children:e},t){var r=i.useRef();return i.useImperativeHandle(t,(()=>({getElement:()=>r.current}))),i.createElement("div",{ref:r},e)}));t.default=n},76338:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return"string"==typeof e?e:e&&(e.displayName||e.name)||"Component"}},5370:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.GetRef=function(e){return t=>{t?"function"==typeof t._getComponent?e(t._getComponent()):e(t):e(void 0)}},t._getComponent=function(){var e=this.component||this.refs.component;if("function"==typeof e._getComponent)return e._getComponent();return e},t.WrappedComponent=t.HOCRef=void 0;var n=i(r(70417)),s=a(r(2784)),o=i(r(21830));t.HOCRef="component";class l extends s.Component{constructor(e){super(e),this.setComponent=e=>{this.component=e},this.state=(0,n.default)({},this.state)}static getDerivedStateFromError(){return{hasError:!0}}componentDidCatch(e,t){__LOG__(4,void 0,new Error,!0)`${e.stack}\n${t.componentStack}`,SEND_LOGS("component-did-catch")}getComponent(){return this.component instanceof l?this.component.getComponent():(0,o.default)(this.component,"this.component")}}t.WrappedComponent=l},4739:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t,r,a;return r=t=class extends p.WrappedComponent{constructor(...e){super(...e),this.listeners=new f}componentDidMount(){this.listeners.internalUseOnlyMarkMounted()}componentWillUnmount(){this.listeners.internalUseOnlyMarkUnmounted()}_getComponent(){return p._getComponent.call(this)}render(){return this.state.hasError?null:s.createElement(e,(0,n.default)({ref:this.setComponent},this.props,{listeners:this.listeners}))}},t.defaultProps=null!==(a=e.defaultProps)&&void 0!==a?a:void 0,t.displayName=`Listener(${(0,c.default)(e)})`,r},t.Listeners=void 0;var n=i(r(58527)),s=a(r(2784)),o=i(r(45026)),l=r(3599),d=i(r(13277)),u=i(r(48977)),c=i(r(76338)),p=r(5370),h=i(r(45387));class f{constructor(){this._mounted=!1,this._unmounted=!1,this._listeners=new Set,this._remove=e=>{e.disengage(),this._listeners.delete(e)}}_add(e){this._unmounted?__LOG__(3)`Listener added after unmounting`:(this._listeners.add(e),this._mounted&&e.engage())}internalUseOnlyMarkMounted(){this._mounted=!0,this._listeners.forEach((e=>{e.engage()}))}internalUseOnlyMarkUnmounted(){this._unmounted=!0,this._listeners.forEach(this._remove),this._abortController&&this._abortController.abort()}add(e,t,r,a){var i=this,n=new h.default(e,t,(function(){i._unmounted||r.apply(this,arguments)}),a,r);this._add(n)}addOnce(e,t,r,a){var i=this,n=new h.default(e,t,(function(){i._remove(n),i._unmounted||r.apply(this,arguments)}),a,r);this._add(n)}remove(e,t,r,a){this._listeners.forEach((i=>{i.represents(e,t,r,a)&&this._remove(i)}))}uiIdle(e){d.default.uiBusy?this.addOnce(d.default,"ui_idle",e):(this._abortController=this._abortController||new o.default,(0,u.default)({signal:this._abortController.signal}).then((()=>{e()}),(e=>{if(e.name!==l.ABORT_ERROR)throw e})))}testsOnlyGetListeners(){return this._listeners}}t.Listeners=f},85185:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t,r,a;return r=t=class extends d.WrappedComponent{constructor(...e){super(...e),this._isUnmounted=!1,this.rejectOnUnmount=()=>(this._rejectPromise||(this._rejectPromise=new Promise(((e,t)=>{this._rejector=t})),this._rejectPromise.catch((()=>{})),this._isUnmounted&&this._rejector(new o.Unmount)),this._rejectPromise)}componentWillUnmount(){this._isUnmounted=!0,this._rejectPromise&&this._rejector(new o.Unmount)}_getComponent(){return d._getComponent.call(this)}render(){return this.state.hasError?null:s.createElement(e,(0,n.default)({ref:this.setComponent,rejectOnUnmount:this.rejectOnUnmount},this.props))}},t.defaultProps=null!==(a=e.defaultProps)&&void 0!==a?a:void 0,t.displayName=`Promise(${(0,l.default)(e)})`,r};var n=i(r(58527)),s=a(r(2784)),o=a(r(24461)),l=i(r(76338)),d=r(5370)},47138:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.unproxy=function(e){return(null==e?void 0:e.$ProxyState$state)?e.$ProxyState$state:e}},75632:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t,r;return r=t=class extends u.WrappedComponent{constructor(...e){super(...e),this._timers=new Map,this._timerId=0,this._unmounted=!1,this.setInterval=(e,t)=>{this._unmounted&&(__LOG__(4,void 0,new Error,!0)`Assertion failed!`,SEND_LOGS("Setting interval after unmount"));var r=++this._timerId,a=window.setInterval(e,t);return this._timers.set(r,(()=>{window.clearInterval(a),this._timers.delete(r)})),r},this.clearInterval=e=>{var t=this._timers.get(e);t&&t()},this.setTimeout=(e,t)=>{this._unmounted&&(__LOG__(4,void 0,new Error,!0)`Assertion failed!`,SEND_LOGS("Setting timeout after unmount"));var[r,a]=this._cbWrapper(e),i=window.setTimeout(a,t);return this._timers.set(r,(()=>{window.clearTimeout(i),this._timers.delete(r)})),r},this.clearTimeout=e=>{var t=this._timers.get(e);t&&t()},this.requestAnimationFrame=e=>{this._unmounted&&(__LOG__(4,void 0,new Error,!0)`Assertion failed!`,SEND_LOGS("Requesting animation frame after unmount"));var[t,r]=this._cbWrapper(e),a=window.requestAnimationFrame(r);return this._timers.set(t,(()=>{window.cancelAnimationFrame(a),this._timers.delete(t)})),t},this.cancelAnimationFrame=e=>{var t=this._timers.get(e);t&&t()},this.throttle=(e,t,r)=>{this._unmounted&&(__LOG__(4,void 0,new Error,!0)`Assertion failed!`,SEND_LOGS("Throttling after unmount"));var[a,i]=this._cbWrapper(e),n=(0,o.default)(i,t,r),s=n.cancel.bind(n);n.cancel=()=>{s(),this._timers.delete(a)};var l=(...e)=>{this._unmounted||(this._timers.set(a,n.cancel),n(...e))};return l.cancel=n.cancel,l.flush=n.flush,l},this.debounce=(e,t,r)=>{this._unmounted&&(__LOG__(4,void 0,new Error,!0)`Assertion failed!`,SEND_LOGS("Debouncing after unmount"));var[a,i]=this._cbWrapper(e),n=(0,s.default)(i,t,r),o=n.cancel.bind(n),l=n.flush.bind(n);n.cancel=()=>{o(),this._timers.delete(a)},n.flush=()=>{l()};var d=(...e)=>{this._unmounted||(this._timers.set(a,n.cancel),n(...e))};return d.cancel=n.cancel,d.flush=n.flush,d},this._cbWrapper=e=>{var t=++this._timerId;return[t,(...r)=>{this._timers.delete(t),e(...r)}]}}_getComponent(){return u._getComponent.call(this)}componentWillUnmount(){this._unmounted=!0,this._timers.forEach((e=>e()))}render(){return this.state.hasError?null:l.createElement(e,(0,n.default)({ref:this.setComponent,setInterval:this.setInterval,clearInterval:this.clearInterval,setTimeout:this.setTimeout,clearTimeout:this.clearTimeout,requestAnimationFrame:this.requestAnimationFrame,cancelAnimationFrame:this.cancelAnimationFrame,debounce:this.debounce,throttle:this.throttle},this.props))}},t.displayName=`Timer(${(0,d.default)(e)})`,r};var n=i(r(58527)),s=i(r(54073)),o=i(r(12436)),l=a(r(2784)),d=i(r(76338)),u=r(5370)},81725:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.requireMain=function(){return l().then((e=>e.requireMain()))},t.requireContactCollection=function(){return l().then((e=>e.requireContactCollection()))},t.requireLoadProtoVersions=function(){return l().then((e=>e.requireLoadProtoVersions()))},t.requireHandleSocketMessage=function(){return l().then((e=>e.requireHandleSocketMessage()))},t.requireEmojiConfig=function(){return l().then((e=>e.requireEmojiConfig()))},t.requireEmojiAssetMapCreator=function(){return l().then((e=>e.requireEmojiAssetMapCreator()))},t.requireStatusV3Collection=function(){return l().then((e=>e.requireStatusV3Collection()))},t.requireClearAppStates=function(){return l().then((e=>e.requireClearAppStates()))},t.requireHandleVideoStreamingRequest=function(){return l().then((e=>e.requireHandleVideoStreamingRequest()))},t.requireLabelCollection=function(){return l().then((e=>e.requireLabelCollection()))},t.requireChatCollection=function(){return l().then((e=>e.requireChatCollection()))},t.requireMsgCollection=function(){return l().then((e=>e.requireMsgCollection()))},t.requireStickerPackCollection=function(){return l().then((e=>e.requireStickerPackCollection()))},t.requireCallCollection=function(){return l().then((e=>e.requireCallCollection()))},t.requireVoip=function(){return l().then((e=>e.requireVoip()))},t.requireVoipCommonDisabled=function(){return l().then((e=>e.requireVoipCommonDisabled()))},t.requireSetHandlers=function(){return l().then((e=>e.requireSetHandlers()))};var i=a(r(25291)),n=a(r(45026)),s=a(r(95469));var o={minTimeout:1e3,maxTimeout:12e4,retries:1/0,signal:(new n.default).signal};var l=(0,i.default)((function(){return(0,s.default)(o,((e,t)=>Promise.all([r.e(2101),r.e(7964)]).then(r.bind(r,54097)).catch((r=>(__LOG__(3)`failed to load main bundle`,10===t&&(__LOG__(4,void 0,new Error,!0)`Assertion failed!`,SEND_LOGS("failed to load main bundle")),e(r))))))}))},10252:(e,t,r)=>{"use strict";var a=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){if(String.prototype.normalize)return Promise.resolve();return(0,n.promiseLoop)(((e,t,a)=>{var n=(0,i.delayMs)(s.expBackoff(a,12e4,1e3,.1));return r.e(6110).then(r.t.bind(r,58216,23)).then((()=>e())).catch((()=>n))}))};var i=r(60266),n=r(13275),s=a(r(56179))},45387:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(60508)),n=a(r(71107));function s(e){return e instanceof n.default}t.default=class{constructor(e,t,r,a,n){this._hasEngaged=!1,this._hasDisengaged=!1,this.source=e,this.cb=r,this.capture=a,this._cbIdentifier=n,s(e)||"function"==typeof e.on?this.event=t:this.event=i.default.prefix(t,e)}engage(){if(!this._hasEngaged&&!this._hasDisengaged){this._hasEngaged=!0;var e=this.source,t=this.event;s(e)||"function"==typeof e.on?(e.on(t,this.cb),"function"==typeof e.incObservers&&e.incObservers()):this.capture?e.addEventListener(t,this.cb,this.capture):e.addEventListener(t,this.cb)}}disengage(){if(!this._hasDisengaged&&(this._hasDisengaged=!0,this._hasEngaged)){var e=this.source,t=this.event;s(e)||"function"==typeof e.off?(e.off(this.event,this.cb),"function"==typeof e.decObservers&&e.decObservers()):this.capture?e.removeEventListener(t,this.cb,this.capture):e.removeEventListener(t,this.cb)}}represents(e,t,r,a){if(this.source!==e)return!1;if(this.event!==t)return!1;if(this._cbIdentifier!==r)return!1;if(a&&"object"==typeof a){var i=this.capture;return!(!i||"object"!=typeof i)&&(i.passive===a.passive&&i.capture===a.capture)}return this.capture===a}}},47339:()=>{},60946:(e,t,r)=>{"use strict";var a=r(14859),i=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(r(2784)),s=a(r(28673)),o=a(r(38637)),l=a(r(64828)),d=a(r(68267)),u=a(r(3472));class c extends n.Component{componentDidMount(){u.default.restart(!0).then((()=>{u.default.restart()}))}render(){return n.createElement(l.default,{cover:!0,title:o.default.t(1402)},n.createElement("div",null,o.default.t(1401)),n.createElement("div",{className:s.default.pending},n.createElement(d.default,{stroke:4,size:40,color:"highlight"})))}}c.displayName="ClientExpiredDialog";var p=c;t.default=p},76176:(e,t,r)=>{"use strict";var a=r(14859),i=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(r(2784)),s=a(r(36171)),o=a(r(19058)),l=a(r(38637)),d=a(r(64828));class u extends n.Component{constructor(...e){super(...e),this._setRefEl=e=>{this._refEl=e},this.onOK=e=>{e.stopPropagation(),e.preventDefault(),this.props.onOK&&this.props.onOK()},this.onCancel=e=>{e.stopPropagation(),e.preventDefault(),this.props.onCancel&&this.props.onCancel()}}getElement(){this._refEl}render(){var e=this.props.onOK?n.createElement(s.default,{a8nText:"popup-controls-ok",type:"primary",onClick:this.onOK,disabled:this.props.okDisabled,spinner:!0===this.props.okSpinner},this.props.okText||l.default.t(1726)):null,t=this.props.onCancel?n.createElement(s.default,{a8nText:"popup-controls-cancel",type:this.props.onOK?"secondary":"primary",onClick:this.onCancel},this.props.cancelText||l.default.t(1558)):null,r={escape:this.props.onCancel?this.onCancel:()=>{}},a=n.createElement(n.Fragment,null,t,e);return n.createElement(o.default,{handlers:r,onRef:this._setRefEl},n.createElement(d.default,{actions:a,children:this.props.children,cover:this.props.cover,onDragChange:this.props.onDragChange,onDrop:this.props.onDrop,type:this.props.type,title:this.props.title}))}}t.default=u,u.displayName="ConfirmPopup"},17827:(e,t,r)=>{"use strict";var a=r(14859),i=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(r(2784)),s=a(r(76176));class o extends n.Component{render(){return n.createElement(s.default,{cover:!0,children:this.props.children,cancelText:this.props.cancelText,onCancel:this.props.onCancel,okText:this.props.okText,onOK:this.props.onOK})}}t.default=o,o.displayName="Conflict"},43813:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(r(70417)),s=r(60266),o=a(r(2784)),l=i(r(13277)),d=i(r(33640)),u=a(r(65343)),c=i(r(528)),p=r(78578),h=i(r(15934)),f=r(28103).Mirrored(["INITIAL_LOAD","CONNECTING","FAKE_FILL","DOWNLOADING","ORGANIZING"]),_=r(28103).Mirrored(["NOT_STARTED","STARTED","PAST_MIN_TIME"]),m=({onReady:e,onLogout:t,initialLoadReady:r})=>{var a=(0,c.default)(),i=o.useRef(!1),[m,g]=o.useState(r?u.Stage.CONNECTING:u.Stage.INITIAL_LOAD),[v,E]=o.useState({INITIAL_LOAD:r?_.PAST_MIN_TIME:_.NOT_STARTED,CONNECTING:_.NOT_STARTED,FAKE_FILL:_.NOT_STARTED,DOWNLOADING:_.NOT_STARTED,ORGANIZING:_.NOT_STARTED}),[y,S]=o.useState(0),[T,A]=o.useState(null);(0,p.useListener)(l.default,"offline_progress_update",(()=>{v.CONNECTING===_.PAST_MIN_TIME&&S(d.default.getOfflineDeliveryProgress());var e=d.default.getHasMessagesToDownload();null==T&&null!=e&&A(e)}));var b=o.useCallback(((e,t)=>(E((t=>(0,n.default)((0,n.default)({},t),{},{[e]:_.STARTED}))),__LOG__(2)`DebouncedLoadingScreen: ${e} - starts minimum display time`,(0,s.delayMs)(t).then((()=>{a()&&(E((t=>(0,n.default)((0,n.default)({},t),{},{[e]:_.PAST_MIN_TIME}))),__LOG__(2)`DebouncedLoadingScreen: ${e} - ends minimum display time`)})))),[a]),{CONNECTING:C,DOWNLOADING:P,ORGANIZING:O,FAKE_FILL:w,INITIAL_LOAD:M}=v;return o.useEffect((()=>{if(O===_.PAST_MIN_TIME)i.current||(e(),i.current=!0);else if(P===_.PAST_MIN_TIME&&y>=100&&O===_.NOT_STARTED)(0,s.delayMs)(450).then((()=>{a()&&(g(u.Stage.ORGANIZING),b(f.ORGANIZING,800))}));else if(C===_.PAST_MIN_TIME&&null!=T&&P===_.NOT_STARTED&&w===_.NOT_STARTED){var t=d.default.getFinishedDownloading();T&&!t?(g(u.Stage.DOWNLOADING),S(d.default.getOfflineDeliveryProgress()),b(f.DOWNLOADING,450)):(S(100),b(f.FAKE_FILL,450).then((()=>{a()&&(h.default.hasSynced?i.current||(e(),i.current=!0):(g(u.Stage.ORGANIZING),b(f.ORGANIZING,800)))})))}else r&&M===_.PAST_MIN_TIME&&C===_.NOT_STARTED?(g(u.Stage.CONNECTING),b(f.CONNECTING,1500)):M===_.NOT_STARTED&&b(f.INITIAL_LOAD,500)}),[y,e,T,b,a,r,C,P,O,w,M]),o.useMemo((()=>o.createElement(u.default,{stage:m,progress:y,onLogout:t})),[m,y,t])};m.displayName="DebouncedLoadingScreen";var g=m;t.default=g},95199:(e,t,r)=>{"use strict";var a=r(14859),i=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(r(2784)),s=a(r(76176)),o=a(r(38637)),l=a(r(15934));t.default=()=>n.createElement(s.default,{cover:!0,cancelText:o.default.t(929),onCancel:l.default.logout.bind(l.default,!0),okText:o.default.t(878),onOK:l.default.poke.bind(l.default)},o.default.t(1137))},23352:(e,t,r)=>{"use strict";var a=r(14859),i=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(r(2784)),s=a(r(18050));class o extends n.PureComponent{constructor(...e){super(...e),this.state={isDragging:!1,fromDrop:!1,blockDrop:!1},this.onDragStart=()=>{this.props.disableFromWithin&&this.setState({blockDrop:!0})},this.onDragEnd=()=>{this.props.disableFromWithin&&this.setState({blockDrop:!1})},this.onDrop=e=>{e.preventDefault(),e.stopPropagation(),this.setState({isDragging:!1,fromDrop:!0}),this.props.onDrop&&!this.state.blockDrop&&this.props.onDrop(e)},this.onDragOver=e=>{e.preventDefault(),e.stopPropagation(),this.state.isDragging||this.state.blockDrop||(this.setState({isDragging:!0,fromDrop:!1}),function(e){if(e.dataTransfer){try{if(!e.dataTransfer.dropEffect)return}catch(e){return}e.dataTransfer.effectAllowed&&(e.nativeEvent.dataTransfer.dropEffect="copy")}}(e))},this.onDragLeave=e=>{e.preventDefault(),e.stopPropagation(),this.state.isDragging&&this.setState({isDragging:!1,fromDrop:!1})}}componentDidUpdate(e,t){var{isDragging:r,fromDrop:a}=this.state,{onDragChange:i}=this.props;t.isDragging!==r&&i&&i(r,a)}render(){return n.createElement("div",{key:"mask",className:s.default.mask,style:this.state.isDragging?{}:{display:"none"},onDragLeave:this.onDragLeave,onDrop:this.onDrop})}}t.default=o,o.displayName="DragAndDrop"},65343:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.Stage=void 0;var n=i(r(72779)),s=a(r(2784)),o=i(r(36171)),l=i(r(38637)),d=i(r(2739)),u=i(r(52497)),c=i(r(80450)),p=r(28103).Mirrored(["INITIAL_LOAD","CONNECTING","DOWNLOADING","ORGANIZING"]);t.Stage=p;var h=e=>{s.useEffect((()=>{var e=document.getElementById("initial_startup");e&&e.parentNode&&e.parentNode.removeChild(e)}),[]);var t,r=e.stage===p.INITIAL_LOAD,a=(0,n.default)(u.default.container,{[u.default.containerFixed]:!e.debug,[u.default.initialLoad]:r}),i=e.stage===p.ORGANIZING,h=e.stage===p.DOWNLOADING,m=(0,n.default)(u.default.graphic,{[u.default.organizing]:i,[u.default.shimmering]:r||i}),g=(0,n.default)(u.default.logout,{[u.default.showWarning]:h}),v=(0,n.default)(u.default.warning,{[u.default.showWarning]:h});switch(e.stage){case p.INITIAL_LOAD:t=l.default.t(1877);break;case p.CONNECTING:t=l.default.t(488);break;case p.DOWNLOADING:t=s.createElement(d.default,{id:896,params:{progress:e.progress}});break;case p.ORGANIZING:t=l.default.t(1127)}return s.createElement("div",{className:a},s.createElement("div",{className:m},s.createElement(f,null)),s.createElement("div",{className:u.default.progress},s.createElement(c.default,{value:e.progress,max:100})),s.createElement("div",{className:u.default.main},t),s.createElement("div",{className:u.default.secondary},s.createElement(_,null)," ",l.default.t(559)),null!=e.onLogout&&s.createElement("div",{className:g},s.createElement(o.default,{type:"plain-white",onClick:e.onLogout},l.default.t(929))),s.createElement("div",{className:v},l.default.t(897)))};h.displayName="LoadingScreen";var f=()=>s.createElement("span",null,s.createElement("svg",{width:"250px",height:"52px",viewBox:"0 0 250 52",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},s.createElement("g",{className:u.default.dots},s.createElement("circle",{fill:"#B6B6B6",cx:"65.7636689",cy:"21.1046108",r:"3.65625"}),s.createElement("circle",{fill:"#B6B6B6",cx:"81.0791876",cy:"19.3283142",r:"3.65625"}),s.createElement("circle",{fill:"#B6B6B6",cx:"96.3947063",cy:"17.7846275",r:"3.65625"}),s.createElement("circle",{fill:"#B6B6B6",cx:"111.710225",cy:"17.5274031",r:"3.65625"}),s.createElement("circle",{fill:"#B6B6B6",cx:"127.025744",cy:"17.6118619",r:"3.65625"}),s.createElement("circle",{fill:"#B6B6B6",cx:"142.341262",cy:"18.4196288",r:"3.65625"}),s.createElement("circle",{fill:"#B6B6B6",cx:"157.656781",cy:"19.9893339",r:"3.65625"}),s.createElement("circle",{fill:"#B6B6B6",cx:"172.9723",cy:"22.0657859",r:"3.65625"})),s.createElement("path",{className:u.default.laptop,d:"M190.14097 4.7518926h48.227869l.281462-.00596781c1.058365-.00288774 2.664865.25185461 2.695721 2.87464716.142823 12.13996425 0 22.28077555 0 34.40910725 0 .06028-.024112.168784-.036168.217008l-16.394805-.0086927c-12.47317.0007215-24.136918.0136044-37.78743-.0033633l-.010915-6.2953341c-.030319-9.5718533-.105914-18.2714581.010915-28.31872515.033356-2.86867935 1.976535-2.91690333 3.013351-2.86867935zm20.097267 4.28597465l-19.256815-.00079524.002426 4.98254029c-.000422 6.5558423-.012657 12.8111695-.002954 19.3619492l.011919 4.9777941h46.536157l.008754-4.9777414c.010547-8.1882109.002637-15.913459.002637-24.3331514l-27.302124-.01059555zM179.195421 44.6572387c.397848-.036168.807752-.024112 1.2056-.024112 9.620684 0 19.241369-.012056 28.862053 0 .132616.4701838.54252 1.6393289 1.036816 1.6393289 3.255119.012056 4.510238 0 7.765357 0 .542519.036168.988591-1.1450331 1.133263-1.6513849 9.910029 0 19.820057.012056 29.730086.012056.084392.012056.265232.036168.349624.048224-.016075.2571945-.016075 1.0085894 0 2.2541846 0 1.4209691-1.193544 1.8201689-1.965128 2.1215688-.421959.1205599-.868031.1326159-1.289991.1928959h-63.560505c-.651024-.072336-1.350272-.108504-1.916904-.4701838-.566631-.2893439-1.000647-.7595278-1.350271-1.2779356v-2.8446419z",fill:"currentColor"}),s.createElement("path",{className:u.default.logo,d:"M37.7314595,31.1612046 C37.0876293,30.8391042 33.9223475,29.2816062 33.332139,29.0666255 C32.7419305,28.8517683 32.3127104,28.7444016 31.8834903,29.3887258 C31.4542703,30.0332973 30.2204788,31.4835521 29.8447567,31.91339 C29.4692818,32.3428571 29.0936834,32.3968494 28.4499768,32.0745019 C27.8060232,31.7521544 25.7314595,31.0723707 23.272278,28.8787027 C21.3582085,27.171583 20.0661004,25.0632896 19.6905019,24.4185946 C19.315027,23.7741467 19.6505946,23.4257297 19.9729421,23.1046178 C20.2625483,22.8161235 20.6167722,22.352556 20.9386255,21.9767104 C21.2606023,21.6007413 21.3678456,21.3320154 21.5824556,20.9026718 C21.7970657,20.472834 21.6898224,20.0968649 21.528834,19.7746409 C21.3678456,19.452417 20.0801853,16.2831815 19.543722,14.993915 C19.0210965,13.7387491 18.4903166,13.9087567 18.0950733,13.8887413 C17.7199691,13.870085 17.2902548,13.8661313 16.8611583,13.8661313 C16.4319382,13.8661313 15.7343629,14.0272433 15.144278,14.6716911 C14.5540695,15.3163861 12.8908108,16.8740077 12.8908108,20.0429961 C12.8908108,23.2121081 15.1978996,26.2734826 15.5198765,26.7031969 C15.8417297,27.1330348 20.0597992,33.6360772 26.5184865,36.4250193 C28.05461,37.0883707 29.2539305,37.4846023 30.1888494,37.7811274 C31.7312742,38.2713822 33.1348263,38.2021931 34.2440772,38.0363861 C35.4810811,37.8515521 38.0533127,36.478888 38.5898996,34.9750116 C39.1263629,33.470888 39.1263629,32.1818687 38.9653745,31.91339 C38.8045097,31.6447876 38.3752896,31.4835521 37.7314595,31.1612046 M25.9838765,47.2013591 L25.9752278,47.2013591 C22.1322625,47.1998763 18.3629343,46.1674749 15.0745946,44.2160926 L14.2926332,43.7519074 L6.18674906,45.8782394 L8.35027028,37.9751042 L7.84111198,37.1648494 C5.69723552,33.7549343 4.56500386,29.8139923 4.56660833,25.767166 C4.57130502,13.9587954 14.1789652,4.35187645 25.9924016,4.35187645 C31.7128649,4.35385328 37.0902239,6.58458689 41.1338378,10.6327722 C45.1773282,14.680834 47.4028724,20.0618996 47.4007737,25.7843398 C47.3959539,37.5936988 37.7882934,47.2013591 25.9838765,47.2013591 M44.2112742,7.556695 C39.3464092,2.68614672 32.8767258,0.00271814672 25.9836293,0 C11.7809421,0 0.221652509,11.5584247 0.215969112,25.7654363 C0.21411583,30.3069652 1.40058687,34.7397683 3.65553668,38.6475984 L-4.61852778e-14,52 L13.6596757,48.4167413 C17.4233205,50.4695597 21.6607876,51.5516293 25.9733745,51.5531121 L25.9838765,51.5531121 L25.984,51.5531121 C40.1852046,51.5531121 51.7456062,39.9934517 51.7512912,25.7860695 C51.7538842,18.9011274 49.0761392,12.4271197 44.2112742,7.556695",fill:"currentColor"}))),_=()=>s.createElement("span",null,s.createElement("svg",{width:"10px",height:"12px",viewBox:"0 0 10 12",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},s.createElement("path",{d:"M5.00847986,1.6 C6.38255462,1.6 7.50937014,2.67435859 7.5940156,4.02703389 L7.59911976,4.1906399 L7.599,5.462 L7.75719976,5.46214385 C8.34167974,5.46214385 8.81591972,5.94158383 8.81591972,6.53126381 L8.81591972,9.8834238 C8.81591972,10.4731038 8.34167974,10.9525438 7.75719976,10.9525438 L2.25767996,10.9525438 C1.67527998,10.9525438 1.2,10.4731038 1.2,9.8834238 L1.2,6.53126381 C1.2,5.94158383 1.67423998,5.46214385 2.25767996,5.46214385 L2.416,5.462 L2.41679995,4.1906399 C2.41679995,2.81636129 3.49135449,1.68973395 4.84478101,1.60510326 L5.00847986,1.6 Z M5.00847986,2.84799995 C4.31163824,2.84799995 3.73624912,3.38200845 3.6709675,4.06160439 L3.6647999,4.1906399 L3.663,5.462 L6.35,5.462 L6.35111981,4.1906399 C6.35111981,3.53817142 5.88169076,2.99180999 5.26310845,2.87228506 L5.13749818,2.85416626 L5.00847986,2.84799995 Z",fill:"currentColor"}))),m=h;t.default=m},58674:(e,t,r)=>{"use strict";var a=r(14859),i=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(r(2784)),s=a(r(38637)),o=a(r(22371)),l=a(r(68267)),d=r(74315),u=()=>n.createElement("div",{className:o.default.background},n.createElement("div",{className:o.default.mainWrapper},n.createElement(l.default,{size:50,stroke:4,color:"highlight"}),n.createElement(d.TextDiv,{className:o.default.logoutTitle,size:"32"},s.default.t(1689)),n.createElement(d.TextDiv,{theme:"muted"},s.default.t(1690))));u.displayName="LogoutLoadingScreen";var c=u;t.default=c},64828:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.TowerModalType=t.FlexModalType=t.BoxModalType=void 0;var n=i(r(45455)),s=i(r(72779)),o=a(r(2784)),l=i(r(32944)),d=i(r(96670)),u=i(r(23352)),c=i(r(55027)),p="box",h="flex",f="guide",_="tower",m="auto",g="invite";class v extends o.PureComponent{constructor(...e){super(...e),this.setDragAndDropRef=e=>{this.dragAndDropRef=e},this.onDragOver=e=>{this.dragAndDropRef&&this.dragAndDropRef.onDragOver(e)},this.onDragStart=e=>{this.dragAndDropRef&&this.dragAndDropRef.onDragStart(e)},this.onDragEnd=e=>{this.dragAndDropRef&&this.dragAndDropRef.onDragEnd(e)}}render(){var{props:e}=this,t=null!=e.title?o.createElement("div",{"data-a8n":l.default.key("popup-title"),className:c.default.popupTitle},e.title):null,r=(0,s.default)(c.default.popup,{[c.default.popupFlexInvite]:e.type===g,[c.default.popupBox]:e.type===p,[c.default.popupFlex]:e.type===h,[c.default.popupTower]:e.type===_,[c.default.popupAuto]:e.type===m}),a=(0,n.default)(e.actions)?null:o.createElement("div",{className:c.default.popupControls},e.actions),i=(0,s.default)("overlay",c.default.backdrop,{[c.default.backdropCover]:e.cover,[c.default.popupGuide]:e.type===f}),v=o.createElement("div",{className:c.default.popupContainer},o.createElement("div",{className:r,"data-animate-modal-popup":!0},o.createElement("div",{className:c.default.popupBody,"data-animate-modal-body":!0},t,o.createElement("div",{"data-a8n":l.default.key("popup-contents"),className:c.default.popupContents},e.children),a)));return o.createElement(d.default,{className:i,onDragOver:this.onDragOver,onDragStart:this.onDragStart,onDragEnd:this.onDragEnd,ref:e.onRef,"data-animate-modal-backdrop":!0},e.onDrop&&o.createElement(u.default,{ref:this.setDragAndDropRef,disableFromWithin:!0,onDragChange:e.onDragChange,onDrop:e.onDrop}),v)}}v.displayName="Modal";var E=p;t.BoxModalType=E;var y=h;t.FlexModalType=y;var S=_;t.TowerModalType=S;var T=v;t.default=T},70629:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.MediaType=t.ModalType=void 0;var n=i(r(23779)),s=i(r(74930)),o=a(r(2784)),l=i(r(13277)),d=i(r(18792)),u=i(r(4739)),c=i(r(53373)),p=i(r(51131)),h=i(r(5431)),f=i(r(97212)),_=i(r(82838)),m="modal",g="none",v="modal";t.ModalType=v;t.MediaType="media";class E extends o.Component{constructor(...e){super(...e),this.state={flow:void 0,modalId:null,transition:m,uim:void 0,blockClose:!1},this.setRefUIE=e=>{this.refUIE=e},this.openFlow=(e,t={})=>{var r=t.transition||m,{uim:a,blockClose:i}=t;this.state.flow&&(r=g);var n=(0,s.default)(`ModalManager${this.props.type}`),l=e;this.props.type===v&&(l=o.cloneElement(e,{requestFocus:this._focusOnContainer})),this.setState({flow:l,modalId:n,transition:r,uim:a,blockClose:i})},this.closeFlow=e=>{if(this.state.flow){var t={flow:void 0,modalId:null};e&&(t.transition=e),this.setState(t)}},this.requestFocus=()=>{if(this.refUIE){var e=this.refUIE.getNode();e&&!e.contains(document.activeElement)&&d.default.focus(e)}},this._focusOnContainer=()=>{if(this.refUIE){var e=this.refUIE.getNode();e&&d.default.focus(e)}},this.requestDismiss=e=>{e===this.state.modalId&&this.closeFlow()},this.shouldRequestFocus=e=>{var t,r=e.relatedTarget,a=null===(t=this.props.contextMenuRef)||void 0===t?void 0:t.current,i=!!a&&a.getComponent().isOpen();return r instanceof HTMLElement&&!e.currentTarget.contains(r)&&!i},this._onBlurHandler=e=>{this.shouldRequestFocus(e)&&this.requestFocus()}}componentDidMount(){this.props.listeners.add(l.default,`open_${this.props.type}`,this.openFlow),this.props.listeners.add(l.default,`close_${this.props.type}`,this.closeFlow)}componentDidUpdate(e){e.type!==this.props.type&&(e.listeners.remove(l.default,`open_${e.type}`,this.openFlow),e.listeners.remove(l.default,`close_${e.type}`,this.closeFlow),this.props.listeners.add(l.default,`open_${this.props.type}`,this.openFlow),this.props.listeners.add(l.default,`close_${this.props.type}`,this.closeFlow))}render(){var{flow:e,modalId:t,transition:r,blockClose:a}=this.state;return e&&(e=o.createElement(h.default,{displayName:`Modal${(0,n.default)(this.props.type)}`,escapable:!a,key:t,ref:this.setRefUIE,requestFocus:this.requestFocus,requestDismiss:this.requestDismiss.bind(null,t)},this.props.type===v?o.createElement(p.default,{onBlur:this._onBlurHandler},e):o.createElement(c.default,null,e))),o.createElement(f.default.Consumer,null,(t=>o.createElement(f.default.Provider,{value:this.state.uim||t},o.createElement(_.default,{transitionName:r},e))))}}E.displayName="ModalManager";var y=(0,u.default)(E);t.default=y},64854:(e,t,r)=>{"use strict";var a=r(14859),i=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(r(2784)),s=a(r(38637)),o=a(r(64828));t.default=()=>n.createElement(o.default,{title:s.default.t(468),cover:!0},s.default.t(890))},56001:(e,t,r)=>{"use strict";var a=r(14859),i=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(r(2784)),s=a(r(76176)),o=r(4170),l=r(55848),d=a(r(38637));function u(){(0,o.openExternalLink)((0,l.getCannotConnectFaqUrl)())}t.default=()=>n.createElement(s.default,{cover:!0,title:d.default.t(352),okText:d.default.t(835),onOK:u},d.default.t(467))},63e3:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(r(98874)),s=i(r(19034)),o=a(r(2784)),l=i(r(76176)),d=r(4170),u=r(55848),c=i(r(38637)),p=i(r(4739)),h=a(r(65343)),f=i(r(46984)),_=a(r(96377)),m=i(r(75632)),g=i(r(15934));class v extends o.PureComponent{constructor(e){super(e),this._forceUpdate=()=>{this.forceUpdate()},this._retried=()=>{null!=this.timeout&&(this.props.clearTimeout(this.timeout),this.timeout=null),null!=this.interval&&(this.props.clearInterval(this.interval),this.interval=null),this.setState({retriable:!1}),this.startTimeout()},this._allowRetry=()=>{this.setState({retriable:!0}),this.interval=this.props.setInterval(this._forceUpdate,1e3)},this.retry=()=>{g.default.poke(),this._retried()},this._onLearnMoreClick=()=>{(0,d.openExternalLink)((0,u.getCannotConnectFaqUrl)())},this.state={retriable:!1}}componentDidMount(){this.startTimeout();var e=document.getElementById("initial_startup");e&&e.parentNode&&e.parentNode.removeChild(e),this.props.listeners.add(_.default,"change:displayInfo",this._forceUpdate),this.props.listeners.add(g.default,"change:retryTimestamp",this._retried)}startTimeout(){this.timeout=this.props.setTimeout(this._allowRetry,3e3)}logout(){__LOG__(2)`Startup: user selected logout`,g.default.logout()}render(){var e,t,r,a,{progress:i}=this.props;switch(_.default.displayInfo){case _.StreamInfo.OPENING:e=c.default.t(489),t=c.default.t(890),a=this.logout;break;case _.StreamInfo.PAIRING:case _.StreamInfo.TIMEOUT:e=c.default.t(1365),t=o.createElement("span",null,c.default.t(891),"",o.createElement("span",{className:f.default.action,onClick:this._onLearnMoreClick,role:"button"},c.default.t(835))),a=this.logout;break;case _.StreamInfo.SYNCING:case _.StreamInfo.CONNECTING:return o.createElement(h.default,{progress:i,stage:h.Stage.INITIAL_LOAD});default:return _.default.mode===_.StreamMode.MAIN?o.createElement(h.default,{progress:i,stage:h.Stage.INITIAL_LOAD}):null}var d=this.state.retriable;if(d){var u=g.default.retryTimestamp-Date.now();if(isNaN(u)||u<1)r=c.default.t(1223),(0,n.default)((()=>g.default.poke()));else if(u<6e4){var p=Math.ceil(u/1e3);r=c.default.t(1225,{number:p,_plural:p})}else r=c.default.t(1224,{duration:s.default.duration(u).humanize()})}else r=c.default.t(1223);return o.createElement(l.default,{cover:!0,title:e,okText:c.default.t(1221),onOK:d?this.retry:()=>{},cancelText:a?c.default.t(929):null,onCancel:a},r,o.createElement("hr",{className:f.default.divider}),o.createElement("div",{className:f.default.textTip},t))}}v.displayName="Startup";var E=(0,m.default)((0,p.default)(v));t.default=E},55556:(e,t,r)=>{"use strict";var a=r(14859),i=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(r(2784)),s=a(r(76176)),o=a(r(43813)),l=a(r(38637)),d=a(r(4739)),u=a(r(64411)),c=i(r(96377)),p=a(r(75632)),h=a(r(15934));class f extends n.PureComponent{constructor(e){super(e),this._forceUpdate=()=>{this.forceUpdate()},this._startInterval=()=>{this.interval=this.props.setInterval(this._forceUpdate,1e3)}}componentDidMount(){this.startTimeout();var e=document.getElementById("initial_startup");e&&e.parentNode&&e.parentNode.removeChild(e),this.props.listeners.add(c.default,"change:displayInfo",this._forceUpdate)}startTimeout(){this.timeout=this.props.setTimeout(this._startInterval,6e3)}logout(){__LOG__(2)`Startup: user selected logout`,h.default.logout()}render(){var e,t;switch(c.default.displayInfo){case c.StreamInfo.OPENING:case c.StreamInfo.PAIRING:case c.StreamInfo.TIMEOUT:e=l.default.t(489),t=l.default.t(890);break;case c.StreamInfo.SYNCING:case c.StreamInfo.CONNECTING:return n.createElement(o.default,{initialLoadReady:this.props.initialLoadReady,onReady:this.props.onReady,onLogout:this.logout});default:return c.default.mode===c.StreamMode.MAIN?n.createElement(o.default,{initialLoadReady:this.props.initialLoadReady,onReady:this.props.onReady,onLogout:this.logout}):null}return n.createElement(s.default,{cover:!0,title:e,cancelText:l.default.t(929),onCancel:this.logout},n.createElement("hr",{className:u.default.divider}),n.createElement("div",{className:u.default.textTip},t))}}f.displayName="StartupMd";var _=(0,p.default)((0,d.default)(f));t.default=_},1281:(e,t,r)=>{"use strict";var a=r(14859),i=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(r(2784)),s=a(r(76176)),o=a(r(38637)),l=a(r(15934));class d extends n.Component{render(){return n.createElement(s.default,{cover:!0,cancelText:o.default.t(929),onCancel:l.default.logout.bind(l.default,!0),okText:o.default.t(878),onOK:l.default.poke.bind(l.default)},this.props.description,"",this.props.children)}}d.displayName="TOS";var u=d;t.default=u},74060:(e,t,r)=>{"use strict";var a=r(14859),i=r(93291);t.HC=function(e,t,a,i,s){if(l.some((({partialUserAgent:t,partialMsg:r})=>d.includes(t)&&String(e).includes(r))))return __LOG__(3)`Ignored Error: ${e||(s||"").toString()}`,!0;try{r(569).default.pprint(!0)}catch(e){__LOG__(3)`UIM Print Failed!`}var c;c=t&&"number"==typeof a?` (${t}:${a}:${i})`:t?` (${t})`:"";if("Script error."===e&&!s)return o.default.logUncaughtError(`${c} ${e}`),t&&n.upload({reason:"script-error",hasTaggedMessage:!0}),!1;var p=s instanceof Error&&s.stack?s:`${e||`Given: ${String(s)}`}`;if(o.default.logUncaughtError(p),!u(s))return!0;return n.upload({reason:null,hasTaggedMessage:!0}),!0},t.e2=function(e,t){if(o.default.logUncaughtError(e,t),!u(e))return;var r=e instanceof Error&&e.stack?null:`unhandled-rejection: ${e}`;n.upload({reason:r,hasTaggedMessage:!0})};var n=i(r(2537)),s=r(24461),o=a(r(94854)),l=[{partialUserAgent:"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/60.0.3112.113 Safari/537.36",partialMsg:"Cannot read property 'style' of null"},{partialUserAgent:"Mozilla/5.0 (Windows NT 6.2; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/60.0.3112.78 Safari/537.36",partialMsg:"Unexpected token :"},{partialUserAgent:"Firefox/52.0,,Mozilla/5.0 (X11; U; Linux i686; en-US; rv:1.9.0.4) Gecko/20100101 Firefox/52.0",partialMsg:"Cannot read property 'style' of undefined"},{partialUserAgent:"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_5) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.1.1 Safari/605.1.15",partialMsg:"is not an object"},{partialUserAgent:"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/60.0.3112.113 Safari/537.36",partialMsg:"Cannot read property 'getElementsByTagName' of undefined"},{partialUserAgent:"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/67.0.3396.99 Safari/537.36",partialMsg:"Can't find variable: dismissKeyboard"},{partialUserAgent:"Mozilla/5.0 (Windows NT 6.2; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/60.0.3112.78 Safari/537.36",partialMsg:"ReferenceError: None is not defined"},{partialUserAgent:"Chrome",partialMsg:"ResizeObserver loop limit exceeded"}],d=window.navigator.userAgent;function u(e){return!(e instanceof s.DbOnLogoutAbort)}},57750:(e,t,r)=>{"use strict";var a=r(14859),i=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.getTheme=function(){var e;if(c())return l.default.currentTheme;return null!==(e=(0,o.getTheme)())&&void 0!==e?e:s.default.DEFAULT_THEME},t.setTheme=u,t.getSystemThemeMode=c,t.setSystemThemeMode=p,t.applyThemeToUI=h,t.default=t.THEME_ASSETS=void 0;var n=i(r(2784)),s=a(r(23045)),o=r(66239),l=a(r(37994)),d={light:[{id:"bg-chat-light",selectors:["[data-asset-chat-background-light]"],low:{default:r(95431)},high:{default:r(95431)}},{id:"bg-chat-dark",selectors:["[data-asset-chat-background-dark]"],low:{default:r(2794)},high:{default:r(2794)}},{id:"intro-connection-light",selectors:["[data-asset-intro-image-light]"],low:{default:r(82823)},high:{default:r(64921)}}],dark:[{id:"bg-chat-dark",selectors:["[data-asset-chat-background-dark]"],low:{default:r(2794)},high:{default:r(2794)}},{id:"intro-connection-dark",selectors:["[data-asset-intro-image-dark]"],low:{default:r(7059)},high:{default:r(76658)}}]};function u(e){(0,o.setTheme)(e),h(e)}function c(){var e;return null===(e=(0,o.getSystemThemeMode)())||void 0===e||e}function p(e){(0,o.setSystemThemeMode)(e)}function h(e){var t=document.body;t&&("dark"===e?t.classList.add("dark"):t.classList.remove("dark"))}t.THEME_ASSETS=d;var f={theme:l.default.currentTheme,systemThemeMode:!0,setTheme:u,setSystemThemeMode:p},_=n.createContext(f);t.default=_},25713:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.ATTACH_MEDIA_STATE=void 0;var n=i(r(70417)),s=a(r(99778)),o=a(r(24461)),l=r(48537),d=r(27305),u=i(r(40430)),c=i(r(84161)),p=r(36169),h=i(r(93013)),f=(r(87471),{READY:"ready",PROCESSING:"processing",ERROR:"error"});t.ATTACH_MEDIA_STATE=f;class _ extends s.default{constructor(...e){super(...e),this.id=(0,s.prop)(),this.file=(0,s.prop)(),this.uiProcessed=(0,s.prop)(!1),this.fileOrigin=(0,s.prop)(),this.isVcardOverMmsDocument=(0,s.prop)(!1),this.state=(0,s.session)(),this.mediaPrep=(0,s.session)(),this.mimetype=(0,s.session)(),this.originalMimetype=(0,s.session)(),this.processPromise=(0,s.session)(),this.exception=(0,s.session)(),this.caption=(0,s.session)(),this.type=(0,s.session)(p.TYPE.UNKNOWN),this.mediaEditorData=(0,s.session)(),this.editedFile=(0,s.session)(),this._mediaEditorUndoStack=(0,s.session)((()=>[])),this._mediaEditorRedoStack=(0,s.session)((()=>[])),this.preview=(0,s.session)(),this.fullPreview=(0,s.session)(),this.fullPreviewSize=(0,s.session)(),this.filename=(0,s.session)(),this.documentPageCount=(0,s.session)(),this.isGif=(0,s.session)(),this.gifAttribution=(0,s.session)(),this.previewable=(0,s.derived)(this._previewable,["preview","fullPreview","type","filename","fullPreviewSize","mimetype"]),this.filesize=(0,s.derived)(this._filesize,["file"]),this.fileExt=(0,s.derived)(this._fileExt,["filename"])}_previewable(){if(!this.type||!this.mimetype||!this.fullPreview)return!1;switch(this.type){case p.TYPE.DOCUMENT:return!!this.filename;case p.TYPE.IMAGE:case p.TYPE.VIDEO:return!(!this.fullPreviewSize||!this.preview);case p.TYPE.AUDIO:case p.TYPE.PTT:case p.TYPE.UNKNOWN:return!0;default:throw new Error(`Unsupported attach media type ${this.type}`)}}_filesize(){return this.file instanceof h.default?this.file.size():this.file instanceof Blob?this.file.size:null}_fileExt(){return this.filename?(0,l.getFileExtension)(this.filename):null}initialize(){if(super.initialize(),!(this.file instanceof Promise))throw new Error("cannot process non-promise file");this.processAttachment(this.file)}processAttachment(e){this.state=f.PROCESSING,this.processPromise=this._processAttachmentPromiseHelper(e).then((()=>{}))}_processAttachmentData(e){if(this.fileOrigin===c.default.MEDIA_PICKER_ORIGIN_TYPE.CHAT_PHOTO_LIBRARY){var t=e.file.name;return(0,l.copyFile)(e.file).then((r=>(0,n.default)((0,n.default)({},e),{},{filename:t,file:r})))}return Promise.resolve(e)}_processAttachmentPromiseHelper(e){return e.then((e=>this._processAttachmentData(e))).then((e=>{this.set(e);var t={},{file:r,filename:a,isGif:i,gifAttribution:n,isVcardOverMmsDocument:s,documentPageCount:o}=e;i?(t.asGif=!0,t.gifAttribution=n):e.type===l.FILETYPE.DOCUMENT&&(t.asDocument=!0,t.filename=a,t.isVcardOverMmsDocument=s,t.documentPageCount=o),t.precomputedFields={fullHeight:e.fullPreviewSize?e.fullPreviewSize.height:void 0,fullWidth:e.fullPreviewSize?e.fullPreviewSize.width:void 0,preview:e.preview,duration:e.duration};var u=h.default.createFromData(r,r.type),c=(0,d.prepRawMedia)(u,t);return this.set({mediaPrep:c}),c.waitForPrep().then((t=>{var r=t.documentPreview,a=t.mediaBlob instanceof h.default?window.URL.createObjectURL(t.mediaBlob.forceToBlob()):window.URL.createObjectURL(t.mediaBlob),i={file:t.mediaBlob,fullPreview:a,type:t.type,filename:t.filename,mimetype:t.mimetype,originalMimetype:e.mimetype,preview:t.preview,state:f.READY,isGif:t.isGif,fullPreviewSize:void 0,documentPageCount:o,isVcardOverMmsDocument:t.isVcardOverMmsDocument};t.fullWidth&&t.fullHeight&&(i.fullPreviewSize={height:t.fullHeight,width:t.fullWidth}),t.type===p.TYPE.IMAGE&&(i.preview=a),t.type===p.TYPE.DOCUMENT&&r&&(i.fullPreview=r.url,i.preview=r.thumbUrl,i.fullPreviewSize={height:r.height,width:r.width},i.documentPageCount=r.pdfPages),this.set(i),this.previewable||(__LOG__(4,void 0,new Error,!0)`Invariant violated, processed file is not previewable`,SEND_LOGS("AttachMedia processFile"))}))})).catchTypes(o.InvalidMediaFileType,o.InvalidImageFileType,(t=>{if(this.isGif||this.type===l.FILETYPE.DOCUMENT)throw t;return this._processAttachmentPromiseHelper(e.then((e=>(e.type=l.FILETYPE.DOCUMENT,e))))})).catchTypes3(u.default,o.MediaFileFailedLoad,o.MediaFileEmpty,(e=>(this.set({exception:e,state:f.ERROR}),this))).catch((()=>(__LOG__(3)`AttachMedia:processFile convert unexpected error to InvalidMediaFileType:`,this.set({exception:new o.InvalidMediaFileType,state:f.ERROR}),this)))}sendToChat(e,t){if(!this.mediaPrep)return Promise.reject(new Error("MediaPrep not available"));if(this.state===f.ERROR)return Promise.reject(new Error(this.exception));if(!(this.state!==f.PROCESSING||this.previewable&&t.addEvenWhilePreparing))return Promise.reject(new Error("Media still processing"));if(this.state===f.READY)return this.mediaPrep.sendToChat(e,t);var r={mimetype:this.mimetype};switch(this.type){case p.TYPE.VIDEO:r.isGif=this.isGif,r.gifAttribution=this.gifAttribution;case p.TYPE.IMAGE:r.width=this.fullPreviewSize.width,r.height=this.fullPreviewSize.height,r.body=this.preview,t.placeholderProps=r;break;case p.TYPE.DOCUMENT:r.pageCount=this.documentPageCount,r.filename=this.filename,r.body=this.preview,t.placeholderProps=r;break;case p.TYPE.AUDIO:case p.TYPE.PTT:}return this.mediaPrep.sendToChat(e,t)}getFileType(){if(!(this.file instanceof Blob||this.file instanceof File))throw new Error("expected file to be a Blob or File");return(0,l.typeFromMimetype)(this.file.type)}isViewableOnce(){return new Set([p.TYPE.IMAGE,p.TYPE.VIDEO]).has(this.type)&&!this.isGif}delete(){this.fullPreview&&window.URL.revokeObjectURL(this.fullPreview),super.delete()}updateMediaEditorData(e,t){return this.mediaEditorData===e||(t.undoable&&(this._mediaEditorUndoStack.push(this.mediaEditorData),this._mediaEditorRedoStack=[]),this.mediaEditorData=e),this.mediaEditorData}undoMediaEditorData(){this.canUndoMediaEditorData()&&(this._mediaEditorRedoStack.push(this.mediaEditorData),this.mediaEditorData=this._mediaEditorUndoStack.pop())}redoMediaEditorData(){this.canRedoMediaEditorData()&&(this._mediaEditorUndoStack.push(this.mediaEditorData),this.mediaEditorData=this._mediaEditorRedoStack.pop())}canUndoMediaEditorData(){return this._mediaEditorUndoStack.length>0}canRedoMediaEditorData(){return this._mediaEditorRedoStack.length>0}updateEditedFile(e){this.editedFile=e}updatePreview(e){window.URL.revokeObjectURL(this.preview),this.preview=e}updateFullPreview(e){window.URL.revokeObjectURL(this.fullPreview),this.fullPreview=e}updateCaption(e){this.caption=e}}_.Proxy="attachMedia";var m=(0,s.defineModel)(_);t.default=m},63256:(e,t,r)=>{"use strict";var a=r(14859),i=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(r(25713)),s=a(r(18641)),o=a(r(23045)),l=i(r(24461)),d=r(48537),u=a(r(38637)),c=a(r(18055)),p=a(r(40430)),h=a(r(54559)),f=a(r(99979)),{IMAGE:_,VIDEO:m,DOCUMENT:g,AUDIO:v}=d.FILETYPE,{READY:E,ERROR:y,PROCESSING:S}=n.ATTACH_MEDIA_STATE,T=1;class A extends s.default{constructor({chatParticipantCount:e}){super(),this.errorMsgs=null,this.ignored=0,this.mediaPickerStatsLogger=new c.default,this.selection=new f.default([],(e=>e.id),"prev"),this.mediaPickerStatsLogger.chatRecipients=e,this.listenTo(this.selection,"all",this._handleSelectionEvents.bind(this))}_handleSelectionEvents(e,t){"focus"!==t&&!1!==t||this.trigger("active-change")}removeSingleton(e,t){e&&(t||this.mediaPickerStatsLogger.logDelete(e.id),e.url&&window.URL.revokeObjectURL(e.url),e.original&&e.original.url&&window.URL.revokeObjectURL(e.original.url))}remove(e,t){var r=super.remove(e,t);return r.forEach((e=>this.removeSingleton(e,t))),this.selection.init(this.getPreviewableMedias(),!0),r}delete(){super.delete(),this.forEach((e=>this.removeSingleton(e))),this.selection.init(this.getPreviewableMedias(),!0)}reorder(e,t){return this.reorderMutate(e,t),this.selection.init(this.getPreviewableMedias(),!0),this.getPreviewableMedias()}replace(e,t){var r=this.get(e);if(r){var a=this.indexOf(r),i=r.caption;this.remove(r,{silent:!0}),r.delete();var s=new n.default({id:e,caption:i,file:this._normalizeAttachment(t)});return this.add(s,a?{at:a}:{}),s.processPromise}}getValidMedias(){return this.filter((e=>e.state===E||e.state===S))}getPreviewableMedias(){return this.filter((e=>e.previewable))}getActive(){return this.selection.getVal()}setActive(e){this.selection.setVal(e)}unsetActive(){this.selection.unset()}setNextAsActive(){var e=this.selection.list.length-1;return-1===this.selection.index||this.selection.index===e||this.selection.setNext(),this.selection.getVal()}setPrevAsActive(){return-1===this.selection.index||0===this.selection.index||this.selection.setPrev(),this.selection.getVal()}processAttachments(e,t){var r=this.getPreviewableMedias().length,a=e.length+r>o.default.MAX_FILES?Math.max(o.default.MAX_FILES-r,0):e.length,i=e.length-a;0===a?i&&this.trigger("max_upload_limit",i):this.ignore(i);var s=e.slice(0,a).map((e=>new n.default({id:T++,file:this._normalizeAttachment(e),fileOrigin:t})));this.add(s);var l=this.getActive();return this.unsetActive(),Promise.all(e).then((()=>{this._attemptToSetNextActiveFromAdded(s,l)})),Promise.all(s.map((e=>e.processPromise))).then((()=>(s.forEach((e=>this._logMediaAdd(e,t))),this._attemptToSetNextActiveFromAdded(s,l))))}_attemptToSetNextActiveFromAdded(e,t){if(!this.getActive()&&!this.getModelsArray().some((e=>e.state===S&&!e.previewable))){var r=e.find((e=>e.previewable));r||(r=t),this.selection.init(this.getPreviewableMedias()),r&&this.setActive(r)}}_logMediaAdd(e,t){if(null!=t){var r=e.isGif?"gif":e.type;this.mediaPickerStatsLogger.logAdd(e.id,r,t)}}_normalizeAttachment(e){return Promise.resolve(e).then((e=>(e.filename||(e.filename=e.file.name),e.mimetype||(e.mimetype=e.file.type),e.type||(e.type=(0,d.typeFromMimetype)(e.file.type)),!e.type&&e.mimetype&&(e.type=(0,d.typeFromMimetype)(e.mimetype)),e)))}ignore(e){e>0&&(this.ignored+=e)}uiProcessMsgs(){var e,t=[],r=0,a=0,i=0,n=0,s=0,d=0,c=0,f=0,E=0,T=0,A=0,b=!1,C=u.default.filesize(h.default.media),P=u.default.filesize(h.default.maxFileSize),O=u.default.filesize(1024*h.default.vcardMaxSizeKb);if(this.forEach((t=>{if(!t.uiProcessed&&(!e&&t.previewable&&(e=t),t.state!==S&&(t.uiProcessed=!0,t.state===y)))if(t.exception instanceof p.default)switch(t.getFileType()){case _:r+=1;break;case m:a+=1;break;case v:i+=1;break;case g:t.isVcardOverMmsDocument?s+=t.documentPageCount:n+=1}else if(t.exception instanceof l.MediaFileEmpty)switch(t.getFileType()){case _:d+=1;break;case m:c+=1;break;case v:f+=1;break;case g:t.isVcardOverMmsDocument?T+=t.documentPageCount:E+=1}else t.exception instanceof l.MediaFileFailedLoad?b=!0:A+=1})),r>0&&t.push(u.default.t(801,{number:r,_plural:r,maxSize:C})),a>0&&t.push(u.default.t(1430,{number:a,_plural:a,maxSize:C})),i>0&&t.push(u.default.t(250,{number:i,_plural:i,maxSize:C})),n>0&&t.push(u.default.t(548,{number:n,_plural:n,maxSize:P})),s>0&&t.push(u.default.t(499,{_plural:s,maxSize:O})),d>0&&t.push(u.default.t(793,{number:d,_plural:d})),c>0&&t.push(u.default.t(1428,{number:c,_plural:c})),f>0&&t.push(u.default.t(245,{number:f,_plural:f})),E>0&&t.push(u.default.t(547,{number:E,_plural:E})),T>0&&t.push(u.default.t(498,{number:T,_plural:T})),A>0&&t.push(u.default.t(660,{number:A,_plural:A})),b&&(t=[]).push(u.default.t(920)),t.length>1){t=[];var w=r+a+i+n,M=d+c+f+E,I=w+M+A;0===A?(0!==w&&t.push(u.default.t(661,{number:w,_plural:w,maxSize:P})),0!==M&&t.push(u.default.t(657,{number:M,_plural:M}))):t.push(u.default.t(659,{number:I,_plural:I}))}var R=t.join(" ");this.errorMsgs=R,this.ignore(this.getPreviewableMedias().length-o.default.MAX_FILES);var D=this.ignored;return this.ignored=0,D&&this.trigger("max_upload_limit",D),A>0&&this.trigger("files_not_supported"),{errorMsgs:R}}canSend(){return!this.getModelsArray().some((e=>e.state===S&&!e.previewable))}}t.default=A,A.model=n.default},60344:(e,t,r)=>{"use strict";var a=r(14859),i=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(r(99778)),s=a(r(43926));class o extends n.default{constructor(...e){super(...e),this.id=(0,n.prop)()}contact(){return r(43805).default.gadd(this.id)}getCollection(){return r(88025).default}}o.Proxy="blocklist",o.idClass=s.default;var l=(0,n.defineModel)(o);t.default=l},88025:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.BlocklistCollection=void 0;var i=a(r(18641)),n=a(r(60344));class s extends i.default{constructor(){super(),this.listenTo(this,"add",this.blockContact),this.listenTo(this,"remove",this.unblockContact)}blockContact(e){e.contact().isContactBlocked=!0}unblockContact(e){e.contact().isContactBlocked=!1}}t.BlocklistCollection=s,s.model=n.default;var o=new s;t.default=o},83194:(e,t,r)=>{"use strict";var a=r(14859),i=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.BUSINESS_CATEGORY_EMPTY_STR_ID=void 0;var n=i(r(99778)),s=a(r(43926));t.BUSINESS_CATEGORY_EMPTY_STR_ID="__empty_query__";class o extends n.default{constructor(...e){super(...e),this.id=(0,n.prop)(),this.categories=(0,n.prop)()}getCollection(){return r(20156).default}}o.Proxy="BusinessCategoriesResult",o.idClass=s.default;var l=(0,n.defineModel)(o);t.default=l},20156:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.BusinessCategoriesResultCollection=void 0;var i=a(r(18641)),n=a(r(83194)),s=r(52894);class o extends i.default{_find(e){return(0,s.queryBusinessCategories)(e).then((t=>new n.default({id:e,categories:t})))}}t.BusinessCategoriesResultCollection=o,o.model=n.default,o.staleCollection=!0;var l=new o;t.default=l},36953:(e,t,r)=>{"use strict";var a=r(14859),i=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULTS=t.default=t.MAX_BUSINESS_CATEGORIES=void 0;var n=i(r(99778)),s=a(r(43926));t.MAX_BUSINESS_CATEGORIES=3;class o extends n.default{constructor(...e){super(...e),this.id=(0,n.prop)(),this.tag=(0,n.prop)(),this.description=(0,n.prop)(),this.categories=(0,n.prop)(),this.profileOptions=(0,n.prop)(),this.email=(0,n.prop)(),this.website=(0,n.prop)(),this.latitude=(0,n.prop)(),this.longitude=(0,n.prop)(),this.businessHours=(0,n.prop)(),this.catalogStatus=(0,n.prop)(),this.address=(0,n.prop)(),this.structuredAddress=(0,n.prop)(),this.stale=(0,n.session)(!0)}markStale(){this.stale=!0,this.hasObservers()&&this.getCollection().find(this.id)}getCollection(){return r(65017).default}isValid(){return Array.isArray(this.categories)}}o.Proxy="businessProfile",o.idClass=s.default;var l=(0,n.defineModel)(o);t.default=l;t.DEFAULTS={description:null,email:null,website:null}},65017:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.BusinessProfileCollection=t.CATALOG_EXISTS=void 0;var i=a(r(70417)),n=a(r(18641)),s=a(r(36953)),o=r(52894),l=r(64001);t.CATALOG_EXISTS="catalog_exists";class d extends n.default{_find(e){return this._findAndParse(e,{queryCatalog:!0})}_update(e){return this._findAndParse(e,{queryCatalog:!1})}_findAndParse(e,{queryCatalog:t}){var r=this.gadd(e);return(0,o.queryBusinessProfile)([{wid:r.id,tag:r.tag}]).then((r=>{if(!Array.isArray(r))return __LOG__(3)`Received invalid business profile response`,null;if(0===r.length)return __LOG__(2)`Store:BusinessProfile:find No businessProfile found for ${String(e)}`,{id:e};var a=r[0],{wid:n,tag:s}=a,o={id:n,tag:s},{profile:d}=a;return d?(0,i.default)((0,i.default)({},(0,l.parseBusinessProfile)({id:a.wid,profile:d,queryCatalog:t})),o):o}))}onResume(){this.filter((e=>e.stale&&e.hasObservers())).map((e=>this.find(e.id)))}handle([e]){e&&null!=e.tag||__LOG__(3)`Store:BusinessProfile:handle Received invalid update from server`;var t=this.gadd(e.wid);e.tag!==t.tag&&t.markStale()}getValid(e){var t=this.get(e);if(null==t?void 0:t.isValid())return t}}t.BusinessProfileCollection=d,d.model=s.default,d.staleCollection=!0;var u=new d;t.default=u},19999:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.COMMERCE_EXPERIENCE_TYPES=t.BUSINESS_HOUR_MODES=t.DAYS_OF_WEEK=void 0;t.DAYS_OF_WEEK=["sun","mon","tue","wed","thu","fri","sat"];t.BUSINESS_HOUR_MODES={OPEN_24H:"open_24h",SPECIFIC_HOURS:"specific_hours",APPOINTMENT_ONLY:"appointment_only"};var a=r(28103)({CATALOG:"catalog",NONE:"none",SHOP:"shop"});t.COMMERCE_EXPERIENCE_TYPES=a},64001:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.parseBusinessProfile=t.goToCommerceManager=t.goToShop=t.hasShop=t.hasCatalog=t.CATALOG_EXISTS=void 0;var n=i(r(70417)),s=i(r(22220)),o=i(r(92082)),l=a(r(36953)),d=r(19999),u=i(r(89962)),c=i(r(43805)),p="catalog_exists";t.CATALOG_EXISTS=p;var h=e=>{var t,r;return e&&e instanceof l.default?(null===(r=e.profileOptions)||void 0===r?void 0:r.commerceExperience)===d.COMMERCE_EXPERIENCE_TYPES.CATALOG||e.catalogStatus===p:(null==e||null===(t=e.profile_options)||void 0===t?void 0:t.commerce_experience)===d.COMMERCE_EXPERIENCE_TYPES.CATALOG||(null==e?void 0:e.catalog_status)===p};t.hasCatalog=h;t.hasShop=e=>{var t,r;return(null==e||null===(t=e.profileOptions)||void 0===t?void 0:t.commerceExperience)===d.COMMERCE_EXPERIENCE_TYPES.SHOP&&Boolean(null==e||null===(r=e.profileOptions)||void 0===r?void 0:r.shopURL)};t.goToShop=e=>{var t,r=null==e||null===(t=e.profileOptions)||void 0===t?void 0:t.shopURL;r&&o.default.open(r)};t.goToCommerceManager=e=>{var t,r=null==e||null===(t=e.profileOptions)||void 0===t?void 0:t.commerceManagerURL;o.default.open(r||"https://business.facebook.com/commerce_manager/")};t.parseBusinessProfile=({profile:e,id:t,queryCatalog:r})=>{if(!e)return{id:t};var{business_hours:a,catalog_status:i,structured_address:o,profile_options:p,address:f}=e,_=(0,s.default)(e,["business_hours","catalog_status","structured_address","profile_options","address"]),m={};return m.businessHours=a?(({config:e,timezone:t})=>{var r={};return e.forEach((e=>{var{day_of_week:t,mode:a}=e;if(a===d.BUSINESS_HOUR_MODES.SPECIFIC_HOURS){var{open_time:i,close_time:n}=e;r[t]||(r[t]={mode:a,hours:[]}),null!=i&&null!=n&&r[t].hours&&r[t].hours.push([i,n])}else r[t]={mode:a}})),{config:r,timezone:t}})(a):null,p&&(m.profileOptions={},m.profileOptions.commerceExperience=p.commerce_experience,m.profileOptions.cartEnabled=p.cart_enabled,null!=p.shop_url&&(m.profileOptions.shopURL=p.shop_url),null!=p.commerce_manager_url&&(m.profileOptions.commerceManagerURL=p.commerce_manager_url)),h(e)&&(m.catalogStatus=i,r&&u.default.findCarouselCatalog(t).then((e=>{var r=Array.isArray(e)?e[0]:e;c.default.assertGet(t).businessCatalog=r})).catch((()=>__LOG__(3)`Store:BusinessProfile:missing catalog`))),o?m.structuredAddress={streetAddress:o.street_address,cityId:o.city_id,localizedCityName:o.localized_city_name,zipCode:o.zip_code}:m.address=f||null,(0,n.default)((0,n.default)((0,n.default)((0,n.default)({},l.DEFAULTS),_),m),{},{id:t})}},38486:(e,t,r)=>{"use strict";var a=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(99778));class n extends i.default{constructor(...e){super(...e),this.id=(0,i.prop)(),this.displayText=(0,i.prop)(),this.selected=(0,i.session)(!1)}}n.Proxy="replyButton";var s=(0,i.defineModel)(n);t.default=s},74123:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.ButtonCollection=void 0;var i=a(r(18641)),n=a(r(38486));class s extends i.default{}t.ButtonCollection=s,s.model=n.default;var o=s;t.default=o},59177:(e,t,r)=>{"use strict";var a=r(14859),i=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,s=i(r(99778)),o=a(r(26021)),l=a(r(13277)),d=a(r(79435)),u=a(r(6370)),c=r(70334);class p extends s.default{constructor(...e){super(...e),this.id=(0,s.prop)(),this.peerJid=(0,s.prop)(),this.offerTime=(0,s.prop)(),this.isVideo=(0,s.prop)(!1),this.isGroup=(0,s.prop)(!1),this.groupCallParticipants=(0,s.prop)(),this.canHandleLocally=(0,s.prop)(!1),this.outgoing=(0,s.prop)(!1),this.webClientShouldHandle=(0,s.prop)(!1),this.participants=(0,s.collection)(o.default),this.callInfo=(0,s.prop)(),this._state=(0,s.prop)(),this._ringTimeout=(0,s.prop)()}getState(){return this._state}setState(e){var t,a=e;(t=this._state,a in f[t||"EMPTY"])&&(this.webClientShouldHandle||a===c.CALL_STATES.INCOMING_RING||(a=c.CALL_STATES.HANDLED_REMOTELY,n||(n=r(61506).default),n.callEndByHandledRemotely(this.id)),this._state=a,this.handleNotification())}handleNotification(){var e=this.getState();!d.default.tosShowCallNotification||!this.peerJid||u.default.isVoiceCallEnabled()&&!this.isVideo||u.default.isVideoCallEnabled()&&this.isVideo||(e===c.CALL_STATES.INCOMING_RING?l.default.alertCall(this.peerJid,this.id,this.isVideo,this.canHandleLocally):l.default.cancelCall(this.peerJid))}getCollection(){return r(40941).default}}p.Proxy="call";var h=(0,s.defineModel)(p);t.default=h;var f={EMPTY:{[c.CALL_STATES.INCOMING_RING]:!0,[c.CALL_STATES.OUTGOING_CALLING]:!0,[c.CALL_STATES.CONNECTING]:!0,[c.CALL_STATES.REJECTED]:!0,[c.CALL_STATES.HANDLED_REMOTELY]:!0,[c.CALL_STATES.ENDED]:!0,[c.CALL_STATES.FAILED]:!0},INCOMING_RING:{[c.CALL_STATES.HANDLED_REMOTELY]:!0,[c.CALL_STATES.CONNECTING]:!0,[c.CALL_STATES.ACTIVE]:!0,[c.CALL_STATES.REJECTED]:!0,[c.CALL_STATES.ENDED]:!0,[c.CALL_STATES.REMOTE_CALL_IN_PROGRESS]:!0,[c.CALL_STATES.FAILED]:!0},OUTGOING_CALLING:{[c.CALL_STATES.OUTGOING_RING]:!0,[c.CALL_STATES.CONNECTING]:!0,[c.CALL_STATES.ENDED]:!0,[c.CALL_STATES.FAILED]:!0,[c.CALL_STATES.ACTIVE]:!0,[c.CALL_STATES.NOT_ANSWERED]:!0,[c.CALL_STATES.REMOTE_CALL_IN_PROGRESS]:!0},OUTGOING_RING:{[c.CALL_STATES.CONNECTING]:!0,[c.CALL_STATES.ACTIVE]:!0,[c.CALL_STATES.REJECTED]:!0,[c.CALL_STATES.ENDED]:!0,[c.CALL_STATES.FAILED]:!0,[c.CALL_STATES.NOT_ANSWERED]:!0},CONNECTING:{[c.CALL_STATES.ACTIVE]:!0,[c.CALL_STATES.ENDED]:!0,[c.CALL_STATES.REMOTE_CALL_IN_PROGRESS]:!0,[c.CALL_STATES.FAILED]:!0},CONNECTION_LOST:{[c.CALL_STATES.ACTIVE]:!0,[c.CALL_STATES.ENDED]:!0,[c.CALL_STATES.FAILED]:!0},ACTIVE:{[c.CALL_STATES.ENDED]:!0,[c.CALL_STATES.FAILED]:!0,[c.CALL_STATES.CONNECTION_LOST]:!0},HANDLED_REMOTELY:{},ENDED:{},REJECTED:{},REMOTE_CALL_IN_PROGRESS:{},FAILED:{},NOT_ANSWERED:{}}},40941:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.CallCollection=void 0;var n=i(r(70417)),s=i(r(98537)),o=i(r(99686)),l=i(r(18641)),d=i(r(59177)),u=i(r(23045)),c=i(r(20468)),p=i(r(33458)),h=i(r(34443)),f=r(23288),_=i(r(54559)),m=i(r(6370)),g=a(r(3889)),v=r(91949),E=r(81910),y=r(70334),{VOIP_LOG_COLOR:S}=u.default,T=null,A=null;class b extends l.default{constructor(...e){super(...e),this.pendingOffers={},this.pendingVoipCapChecks={}}handleQuery(){return Promise.resolve()}handle(e){T&&A||(T=r(61506).default,A=r(61506).checkVoipCapability);var t=e.shift();if(t.data&&t.data[0]){var a=g.default.parseCallSignalingMsg(t);if(!a)return;var i={};(c.default.supportsFeature(c.default.F.DESKTOP_VOIP_VOICE_CALL)||_.default.webVoip)&&(Array.isArray(t.data[0])&&(t.data=t.data[0]),(0,g.base64DecodeRecursively)(t.data),i={peer_jid:a.peer_jid,payload:t.data,peer_platform:a.peer_platform,peer_app_version:a.peer_version,epoch_msec:null!=a.t?String(1e3*a.t):void 0,elapsed_msec:null!=a.e?String(1e3*a.e):void 0,is_offline:t.data[1].offline});var s=a.call_id,o=null,l=null,d=null,u=JSON.parse(JSON.stringify(t)),E=u.data[2]&&u.data[2].find((e=>"enc"===e[0]));E&&(E[2]="xxx bytes"),__LOG__(2)`voip:incoming_signaling(peer):${JSON.stringify(a)}:`;var S=!1;switch(a.type){case v.TYPE.OFFER:if((0,f.getDoNotDisturb)()&&!h.default.isFocused)return void __LOG__(2)`CallCollection:handle: ignoring incoming call offer because do not disturb mode is enabled or screen is locked`;if(S=!0,o=a.isVideoCall,l=a.isGroupCall_DEPRECATED,d=a.t,T.isInitialized()){this.pendingVoipCapChecks[s]=Promise.all([A((0,n.default)({},a)),(0,p.default)()]).then((([e,t])=>e&&t));var b=t.data[2]&&t.data[2].find((e=>"enc"===e[0]));this.pendingOffers[s]=Promise.sit("receivedKey",(e=>{g.default.receiveCallOfferKey(e,b)})).endWithControls("receivedKey")}}this.pendingVoipCapChecks[s]?this.pendingVoipCapChecks[s].then((e=>{var r,n;(r=!l&&(o?e&&(m.default.isVideoCallEnabled()||_.default.webVoip):e),this.processIncomingCall(s,t.from,{isVideo:o,isGroupCall:l,canHandleLocally:r,offerTime:d}),r&&this.pendingOffers[s]&&(m.default.isVoiceCallEnabled()||_.default.webVoip))?this.pendingOffers[s].then((()=>{var e;null===(e=T)||void 0===e||e.handleIncomingSignalingMessage(a,i)})):(this.cleanupPendingOffer(s),null===(n=T)||void 0===n||n.handleIncomingSignalingMessage(a,i))})).finally((()=>{delete this.pendingVoipCapChecks[s]})):this.pendingOffers[s]?(S&&this.processIncomingCall(s,t.from),(m.default.isVoiceCallEnabled()||_.default.webVoip)&&this.pendingOffers[s].then((()=>{var e;null===(e=T)||void 0===e||e.handleIncomingSignalingMessage(a,i)}))):(S&&this.processIncomingCall(s,t.from,{isVideo:o,isGroupCall:l,canHandleLocally:!1,offerTime:d}),T.handleIncomingSignalingMessage(a,i))}else switch(__LOG__(2)`voip:incoming_signaling(paired phone):${JSON.stringify(t)}:`,t.type){case"offer_key":var C=this.pendingOffers[t.id];C?C.control.receivedKey(t.key):__LOG__(3)`received offer_key: no pending offer`;break;case"accept":case"reject":case"terminate":var P=this.get(t.id);P&&P.setState(y.CALL_STATES.ENDED),this.cleanupPendingOffer(t.id)}}processIncomingCall(e,t,r){if(null==this.get(e)){var a=r,i={id:e};null!=t&&(i.peerJid=t),a&&(a=(0,o.default)(a,(e=>null==e)),(0,s.default)(i,a)),this.add(i,{merge:!0})}else __LOG__(2)`voip:processIncomingCall: Attempting to add existing call with call ID`}cleanupPendingOffer(e){delete this.pendingOffers[e]}setActiveCall(e){var t,r=this.activeCall&&!e,a=null===(t=this.activeCall)||void 0===t?void 0:t.webClientShouldHandle;this.activeCall=e,this.trigger("change:activeCall",e),r&&a&&(0,E.playEndCallTone)()}}t.CallCollection=b,b.model=d.default;var C=new b;t.default=C},1085:(e,t,r)=>{"use strict";var a=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(99778));class n extends i.default{constructor(...e){super(...e),this.id=(0,i.prop)(),this.callId=(0,i.prop)(),this.isIncoming=(0,i.prop)(!1),this.isRinging=(0,i.prop)(!1),this.isInterrupted=(0,i.prop)(!1),this.isMuted=(0,i.prop)(!1),this.isTrafficStopped=(0,i.prop)(!1),this.isInvitingToGroupCall=(0,i.prop)(!1),this.isVideoStopped=(0,i.prop)(!1),this.isVideoPaused=(0,i.prop)(!1),this.isVideoDecodePaused=(0,i.prop)(!1),this.isVideoDecodeStarted=(0,i.prop)(!1),this.isOfferingVideoUpgrade=(0,i.prop)(!1)}}n.Proxy="callParticipant";var s=(0,i.defineModel)(n);t.default=s},26021:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(26834)),n=a(r(18641)),s=a(r(1085));class o extends n.default{}t.default=o,o.model=s.default,o.comparator=(e,t)=>e.id===t.id?0:(0,i.default)(e.id,t.id)?-1:1},1566:(e,t,r)=>{"use strict";var a=r(14859),i=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(r(99778)),s=a(r(20873));class o extends n.default{constructor(...e){super(...e),this.id=(0,n.prop)(),this.products=(0,n.prop)(),this.itemCount=(0,n.prop)(),this.total=(0,n.prop)(),this.currency=(0,n.prop)(),this.message=(0,n.prop)()}countTotals(){var e=this.cartItemCollection.reduce(((e,t)=>{var r;return e.currency.add(t.currency),{itemCount:e.itemCount+t.quantity,total:e.total+t.quantity*(null!==(r=t.priceAmount1000)&&void 0!==r?r:0),currency:e.currency}}),{itemCount:0,total:0,currency:new Set}),t=1===e.currency.size,r={itemCount:e.itemCount,total:t?e.total:null,currency:t?e.currency.values().next().value:null};this.set(r,{silent:!0})}initialize(){super.initialize(),this.cartItemCollection=new s.default,this.listenTo(this,"change:cartItemCollection",this.countTotals)}getCollection(){return r(59544).default}}o.Proxy="cart";var l=(0,n.defineModel)(o);t.default=l},59544:(e,t,r)=>{"use strict";var a=r(14859),i=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.CartCollection=void 0;var n=i(r(18641)),s=a(r(1566)),o=a(r(79435)),l=r(66239),d=a(r(20468));class u extends n.default{constructor(e,t){super(),this.imageWidth=100,this.imageHeight=100,null!=e&&(this.imageWidth=e),null!=t&&(this.imageHeight=t)}saveToCache(){if(!d.default.supportsFeature(d.default.F.MD_BACKEND))try{if(!o.default.shouldSaveToCache())return;var e=this.reduce(((e,t)=>{var{cartItemCollection:r,itemCount:a,total:i,currency:n,id:s,message:o}=t,l=r.map((e=>({id:e.id,priceAmount1000:e.priceAmount1000,currency:e.currency,name:e.name,quantity:e.quantity,imageHash:e.imageHash})));return l.length>0&&e.push({id:s,products:l,itemCount:a,total:i,currency:n,message:o}),e}),[]);!0,(0,l.setCollection)(u.cachePolicy.id,e,true)}catch(e){__LOG__(3)`Error while saving carts to cache, ${String(e)}`}}initializeFromCache(e){try{(e||[]).forEach((e=>{var t=new s.default({id:e.id,itemCount:e.itemCount,total:e.total,currency:e.currency,message:e.message});t.cartItemCollection.add(e.products),this.add(t,{merge:!0})}))}catch(e){__LOG__(3)`Error while restoring carts from cache, ${String(e)}`}}findCart(e){return this.gadd(e)}}t.CartCollection=u,u.model=s.default,u.cachePolicy={id:"cart_collection",policy:n.CACHE_POLICY.LOAD,delay:2e3};var c=new u;t.default=c},45537:(e,t,r)=>{"use strict";var a=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.MAX_QUANTITY=void 0;var i=a(r(99778));t.MAX_QUANTITY=99;class n extends i.default{constructor(...e){super(...e),this.id=(0,i.prop)(),this.priceAmount1000=(0,i.prop)(),this.currency=(0,i.prop)(),this.name=(0,i.prop)(),this.quantity=(0,i.prop)(),this.imageHash=(0,i.prop)(),this.imageCdnUrl=(0,i.prop)()}getCollection(){return r(59544).default}}n.Proxy="cart-item";var s=(0,i.defineModel)(n);t.default=s},20873:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.CartItemCollection=void 0;var i=a(r(18641)),n=a(r(45537));class s extends i.default{}t.CartItemCollection=s,s.model=n.default;var o=s;t.default=o},62820:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.getForwardedMessageFields=Oe,t.default=t.CHAT_KIND=t.KIND=t.ConversationEndOfHistoryTransferModelPropType=void 0;var n=i(r(52954)),s=i(r(17620)),o=i(r(67304)),l=i(r(15253)),d=i(r(17335)),u=i(r(34498)),c=i(r(54004)),p=i(r(45455)),h=i(r(54073)),f=r(60266),_=r(13275),m=a(r(2784)),g=r(8507),v=i(r(84621)),E=r(41153),y=r(99778),S=i(r(36900)),T=i(r(69783)),A=i(r(48084)),b=i(r(50060)),C=i(r(13649)),P=i(r(48717)),O=i(r(44641)),w=i(r(99461)),M=i(r(13277)),I=i(r(79435)),R=i(r(23045)),D=i(r(80206)),N=i(r(43805)),L=i(r(10346)),k=r(33576),U=i(r(33013)),G=a(r(24461)),F=r(66239),x=i(r(20468)),B=i(r(68749)),Y=i(r(38637)),K=r(48522),j=i(r(75584)),W=r(27305),H=i(r(84161)),V=i(r(36169)),$=i(r(30528)),q=r(34708),z=i(r(83746)),J=r(68439),Q=i(r(96997)),X=r(26779),Z=i(r(21830)),ee=r(11968),te=i(r(93997)),re=r(51642),ae=i(r(93562)),ie=i(r(2661)),ne=r(89027),se=r(90138),oe=r(76774),le=(r(87471),r(11212)),de=r(74856),ue=i(r(54559)),ce=r(55814),pe=a(r(37147)),he=i(r(68473)),fe=a(r(56179)),_e=r(30421),me=r(78413),ge=r(5916),ve=i(r(57568)),Ee=i(r(94407)),ye=i(r(43926)),Se=i(r(15934)),Te=r(83243),Ae=r(78391),be=r(28103)({COMPLETE_BUT_MORE_MESSAGES_REMAIN_ON_PRIMARY:0,COMPLETE_AND_NO_MORE_MESSAGE_REMAIN_ON_PRIMARY:1,INCOMPLETE:2});t.ConversationEndOfHistoryTransferModelPropType=be;var Ce={GROUP:"group",BROADCAST:"broadcast",CHAT:"chat"};t.CHAT_KIND=t.KIND=Ce;class Pe extends he.default{constructor(...e){super(...e),this.id=(0,y.prop)(),this.t=(0,y.prop)(),this.unreadCount=(0,y.prop)(0),this.archive=(0,y.prop)(),this.isReadOnly=(0,y.prop)(),this.isAnnounceGrpRestrict=(0,y.prop)(),this.modifyTag=(0,y.prop)(),this.muteExpiration=(0,y.prop)(0),this.name=(0,y.prop)(),this.notSpam=(0,y.prop)(),this.pin=(0,y.prop)(),this.labels=(0,y.prop)(),this.changeNumberOldJid=(0,y.prop)(),this.changeNumberNewJid=(0,y.prop)(),this.lastReceivedKey=(0,y.prop)(),this.ephemeralDuration=(0,y.prop)(),this.ephemeralSettingTimestamp=(0,y.prop)(),this.createdLocally=(0,y.session)(),this.pendingAction=(0,y.session)(),this.formattedTitle=(0,y.session)(),this.active=(0,y.session)(),this.pausedTimerId=(0,y.session)(),this.presenceResendTimerId=(0,y.session)(),this.recording=(0,y.session)(),this.typing=(0,y.session)(),this.colors=(0,y.session)(),this.composeContents=(0,y.session)((()=>({}))),this.attachMediaContents=(0,y.session)(),this.squelch=(0,y.session)(),this.pendingSeenCount=(0,y.session)(0),this.unreadMsgAnchor=(0,y.session)(),this.markedUnread=(0,y.session)(),this.trusted=(0,y.session)(),this.canSend=(0,y.session)(),this.promises=(0,y.session)((()=>({}))),this.ftsCache=(0,y.session)((()=>({}))),this.composeQuotedMsg=(0,y.session)(),this.composeQuotedMsgRemoteJid=(0,y.session)(),this.quotedMsgAdminGroupJid=(0,y.session)(),this.groupMetadata=(0,y.session)(),this.presence=(0,y.session)(),this.mute=(0,y.session)(),this.contact=(0,y.session)(),this.liveLocation=(0,y.session)(),this.liveLocationQueried=(0,y.session)(!1),this.ackedProps=(0,y.session)((()=>({}))),this.mediaCount=(0,y.session)(0),this.linkCount=(0,y.session)(0),this.docCount=(0,y.session)(0),this.productCount=(0,y.session)(0),this.msgUnsyncedButtonReplyMsgs=(0,y.prop)(),this.vcardDismissed=(0,y.session)(!1),this.endOfHistoryTransfer=(0,y.session)(!1),this.endOfHistoryTransferType=(0,y.prop)(),this.hasEstablishedE2EESession=(0,y.session)(!1),this.pendingInitialLoading=(0,y.session)(!0),this.kind=(0,y.derived)(this._kind),this.isUser=(0,y.derived)(this._isUser),this.isPSA=(0,y.derived)(this._isPSA),this.isGroup=(0,y.derived)(this._isGroup),this.isBroadcast=(0,y.derived)(this._isBroadcast),this.canUnread=(0,y.derived)(this._canUnread),this.hasUnread=(0,y.derived)(this._hasUnread,["unreadCount"]),this.optimisticUnreadCount=(0,y.derived)(this._optimisticUnreadCount,["unreadCount","pendingSeenCount"]),this.shouldShowUnreadDivider=(0,y.derived)(this._shouldShowUnreadDivider,["unreadCount","unreadMsgAnchor"]),this.shouldAppearInList=(0,y.derived)(this._shouldAppearInList,["createdLocally","msgs","msgsLength"]),this.previewMessage=(0,y.derived)(this._previewMessage,["msgs","msgsChanged"]),this.showChangeNumberNotification=(0,y.derived)(this._showChangeNumberNotification,["changeNumberOldJid","changeNumberNewJid","id","isUser"]),this.shouldShowUnreadInTitle=(0,y.derived)(this._shouldShowUnreadInTitle,["isGroup","archive","optimisticUnreadCount","muteExpiration"])}initialize(){super.initialize(),this.addQueue=new B.default,this.sendQueue=new B.default,this._ephemeralMessagesToDelete=new Set,this._ephemeralMessageTimerIds=new Map,this._promises=null,this.msgs.msgLoadState.contextLoaded=!0,this.addChild("presence",te.default.gadd(this.id));var e=Q.default.get(this.id);if(e?this.addChild("mute",e):this.addChild("mute",Q.default.gadd({id:this.id,expiration:this.muteExpiration})),this.listenTo(this.mute,"change:expiration",this.updateMuteExpiration),this.addChild("contact",N.default.gadd(this.id)),this.name&&!this.contact.name){var t={name:this.name};this.isGroup?this.contact.set(t):(0,_e.updateLocal)(this.contact.id,t).then((()=>{this.contact.set(t)}))}if(this.listenTo(this.contact,"change:name",this.updateTitle),this.listenTo(this.contact,"change:isContactBlocked",this.updateCanSend),this.isGroup&&(this.trusted=!0),this.isGroup||this.isBroadcast){var r,a=this.getGroupMetadataCollection();this.isBroadcast&&!a.get(this.id)&&(r=!0),this.addChild("groupMetadata",a.gadd(this.id)),this.listenTo(this.groupMetadata,"change:stale change:announce",this.updateIsAnnounceGrpRestrict),this.listenTo(this.groupMetadata.participants,"change:isAdmin add remove",this.updateIsAnnounceGrpRestrict),this.listenTo(this.groupMetadata,"change:trusted change:stale",this.isTrusted),this.listenTo(this.groupMetadata,"change:participants change:stale",this.updateReadOnly),this.listenTo(this.groupMetadata.participants,"change:contact.formattedShortName",this.updateTitle),this.updateReadOnly(),this.updateIsAnnounceGrpRestrict();var i=this.id;this.listenTo(this,"change:isReadOnly",(function(){this.isTrusted(),this.updateCanSend(),ae.default.update(i).catchType(k.WebdDrop,(()=>{})),a.update(i).catchType(k.WebdDrop,(()=>{}))})),this.listenTo(this,"change:isAnnounceGrpRestrict",this.updateCanSend),this.listenTo(this,"change:archive",(()=>{!0===this.archive&&(0,E.shouldEnableArchiveV2)()&&(0,ce.setArchiveEnabledSetting)(!0)})),r&&a.update(i).catchType(k.WebdDrop,(()=>{}))}else this.listenTo(this.presence,"change:isOnline",(()=>(0,ee.presenceOnlineChanged)(this))),this.listenTo(this.contact,"change:isMyContact",this.isTrusted);var n=this.getCollection();n.notSpam[this.id]&&!this.notSpam&&(0,le.sendNotSpam)(this).catch((()=>{})),n.notSpam[this.id]=!!this.notSpam,this.notSpam||this.listenTo(this,"change:notSpam",this.onNotSpamChange),this.updateTitle(),this.isTrusted(),this.updateCanSend(),this.listenTo(this.msgs,"add",this.onNewMsg),this.listenTo(this.msgs,"update_sort_time",this.updateSortTime),this.listenTo(this.msgs,"bulk_add",this.addMediaMsgs),this.listenTo(this.msgs,"add",this._deregisterExpiredViewOnceMessage),this.listenTo(this.msgs,"bulk_add",this.deregisterExpiredViewOnceBulkMessages),this.listenTo(this.msgs,"add remove change:ephemeralExpirationTimestamp",this._resetEphemeralMessageExpirationTimer),this.listenTo(this.msgs,"bulk_add",(e=>{e.forEach((e=>{this._resetEphemeralMessageExpirationTimer(e)}))})),this.listenTo(this,"change:msgs",this.resetMediaMsgs),this._saveAssignedColors=(0,h.default)(this.saveAssignedColors,1e3),this.listenTo(this,"change:active",this.onActiveUpdate),this.pendingAction=0,this.listenTo(this,"change:t change:modifyTag",this._clearFtsCache),this.listenTo(Y.default,"locale_change",(()=>{this.updateTitle()})),I.default.isSMB&&(0,K.initializeLabels)(this)}_kind(){return ye.default.isGroup(this.id)?Ce.GROUP:ye.default.isBroadcast(this.id)?Ce.BROADCAST:ye.default.isUser(this.id)?Ce.CHAT:void __LOG__(2)`chat:unknown kind id:${this.id.toString()}`}_isUser(){return ye.default.isUser(this.id)}_isPSA(){return ye.default.isPSA(this.id)}_isGroup(){return ye.default.isGroup(this.id)}_isBroadcast(){return ye.default.isBroadcast(this.id)}isSupportGroup(){return this.isGroup&&this.groupMetadata.support}_canUnread(){return!this.isBroadcast}_hasUnread(){return 0!==this.unreadCount}_optimisticUnreadCount(){var{unreadCount:e,pendingSeenCount:t}=this;return e===R.default.MARKED_AS_UNREAD?e:Math.max(0,e-t)}_shouldShowUnreadDivider(){if(0===this.unreadCount)return!1;if(this.unreadMsgAnchor){var{msgChunk:e}=this.unreadMsgAnchor,t=e?e.getModelsArray():[];return this.unreadMsgAnchor!==t.find((e=>e.isUnreadType))}return!this.msgs.msgLoadState.noEarlierMsgs||this.msgs.filter((e=>e.isUnreadType)).length!==this.unreadCount}_shouldAppearInList(){if(x.default.supportsFeature(x.default.F.MD_BACKEND)&&this.isBroadcast)return!1;if(this._shouldAppearInListLatched)return!0;if(ye.default.isStatusV3(this.id))return!1;var e=this.msgs.some((e=>{var t=e.type===R.default.MSG_TYPE.GROUPS_V4_INVITE&&e.from.equals((0,F.getMaybeMeUser)()),r=e.type===R.default.MSG_TYPE.E2E_NOTIFICATION&&"encrypt"===e.subtype;return!t&&!r&&e.type!==R.default.MSG_TYPE.CALL_LOG&&!e.isBizNotification&&"change_number"!==e.subtype}));return this._shouldAppearInListLatched=!this.createdLocally||e,this._shouldAppearInListLatched}_previewMessage(){for(var e=this.msgs.length-1;e>=0;e--){var t=this.msgs.at(e);if(t&&t.type!==R.default.MSG_TYPE.E2E_NOTIFICATION)return t}if(this.msgs.length>0)return this.msgs.last()}_showChangeNumberNotification(){if(!x.default.supportsFeature(x.default.F.CHANGE_NUMBER_V_2))return!1;var{changeNumberOldJid:e,changeNumberNewJid:t,id:r,isUser:a}=this;if(!a)return!1;if(!e&&!t)return!1;var i=N.default.get(t||r);return!i||!i.isMyContact}_shouldShowUnreadInTitle(){var e=!!this.muteExpiration;if(this.archive)return!1;if(this.optimisticUnreadCount<=0)return!1;if(!this.isGroup)return!e;if(!e)return!0;if(!this.msgs||0===this.msgs.length)return!1;for(var t=!1,r=this.msgs,a=this.optimisticUnreadCount,i=Math.max(0,r.length-a);i<r.length;i++){var n=this.msgs.at(i);if(n){var s=(0,F.getMaybeMeUser)();if(n.isMentioned(s)||n.isQuoted(s)){var o=this.getCollection().get(n.sender);if(!o||!o.muteExpiration){t=!0;break}}}}return t}set(e,t,r){return"string"==typeof e?"muteExpiration"===e&&this.mute&&this.mute.setMute(t):e.hasOwnProperty("muteExpiration")&&this.mute&&this.mute.setMute(e.muteExpiration),super.set(e,t,r)}addPendingAction(e){if(e.isPending()){var t=()=>{this.decPending()};e.then(t,t),this.pendingAction++}}decPending(){this.pendingAction>0?this.pendingAction--:(__LOG__(2)`chat:onPendingActionUpdate pendingAction value is invalid`,this.pendingAction=0)}onActiveUpdate(){this.isGroup&&this.active&&(this.squelch=-1),this.presence.chatActive=this.active,this.active||(this.msgs.filter((e=>(0,ge.isExpired)(e.safe()))).forEach(W.deregisterMsg),this._ephemeralMessagesToDelete.forEach((e=>{this._ephemeralMessagesToDelete.delete(e),e.delete({skipUpdatingSortTime:!0,doNotResetLastReceived:!0})})))}onPendingActionUpdate(){this.pendingAction<0&&(__LOG__(2)`chat:onPendingActionUpdate pendingAction value is invalid`,this.pendingAction=0)}onNotSpamChange(){this.getCollection().notSpam[this.id]=this.notSpam,this.isTrusted(),this.notSpam&&this.stopListening(this,"change:notSpam")}hasMaybeSentMsgToChat(){return this.getAllMsgs().some((e=>e.isSentByMe))}isTrusted(){var e=!1;return this.isGroup?e=this.isReadOnly||this.notSpam||this.groupMetadata.isTrusted():this.isBroadcast?e=!0:this.isUser&&(e=this.notSpam||this.contact.isMyContact),!e&&this.hasMaybeSentMsgToChat()&&(e=!0),this.trusted=e}updateMuteExpiration(){var e=Number(this.mute.expiration);(0,me.updateLocal)(this.id,{muteExpiration:e}).then((()=>this.muteExpiration=e))}updateTitle(){this.isBroadcast?this.formattedTitle=this.contact.name||this.groupMetadata.participants.map((function(e){return e.contact.formattedShortName})).join(", "):this.isUser?this.formattedTitle=this.contact.getFormattedUser()||"":this.isGroup&&(this.formattedTitle=this.contact.name)}title(){return this.isGroup?this.formattedTitle||Y.default.t(1374):this.formattedTitle}updateCanSend(){return this.isReadOnly||this.isAnnounceGrpRestrict?this.canSend=!1:this.isUser?this.canSend=!(this.contact.isContactBlocked||this.isPSA):this.canSend=!0}delete(){super.delete(),this.getCollection().remove(this.id),this.cancelPendingPromises(),this.presence.delete(),this.liveLocation&&this.liveLocation.delete(),M.default.closeChat(this),this.groupMetadata&&this.groupMetadata.delete(),this.mediaMsgs&&this.mediaMsgs.delete(),this.linkMsgs&&this.linkMsgs.delete(),this.docMsgs&&this.docMsgs.delete(),this.productMsgs&&this.productMsgs.delete();var e=this.starredMsgs;e&&(e.delete(),e.stopListening(),e.reset()),this.receivedVcardMsgs&&this.receivedVcardMsgs.delete(),(0,F.deleteComposeContents)(this.id)}isDirty(){return 0!==this.unreadCount}resetMediaMsgs(){var{mediaMsgs:e,linkMsgs:t,docMsgs:r,productMsgs:a}=this;e&&(e.delete(),e.queryMedia({chat:this})),t&&(t.delete(),t.queryLinks(this)),r&&(r.delete(),r.queryDocs(this)),a&&(a.delete(),a.queryProducts(this))}isMsgForMediaCollection(e){return e.isMedia&&!e.isViewOnce}addMediaMsgs(e,t){if(e){var r=Array.isArray(e)?e:[e],a=[],i=[],n=[],s=[];r.forEach((e=>{this.isMsgForMediaCollection(e)&&a.push(e),e.asDoc&&n.push(e),e.linkPreview&&i.push(e),null!=e.asProduct&&s.push(e)})),this.mediaMsgs&&a.length&&this.mediaMsgs.add(a,t),this.linkMsgs&&i.length&&this.linkMsgs.add(i,t),this.docMsgs&&n.length&&this.docMsgs.add(n,t),this.productMsgs&&s.length&&this.productMsgs.add(s,t)}}onNewMsg(e){var t=this;if(e){var r=Promise.resolve();e.isSentByMe&&!this.notSpam&&(r=(0,me.updateLocal)(this.id,{notSpam:!0}).then((()=>this.notSpam=!0))),"i"!==e.eventType&&r.then((()=>{var r={};return x.default.supportsFeature(x.default.F.MD_BACKEND)||(r.t=e.t),this.promises.updateSortTime&&this.promises.updateSortTime.cancel(),this.updateMediasCountOnMsg(e),this.archive&&(0,E.shouldUnarchiveChat)(e.isSentByMe)&&(r.archive=!1),this.promises.setArchive&&this.promises.setArchive.cancel(),e.isSentByMe?this.markedUnread=!1:((0,S.default)({id:this.id,participant:e.author,type:"paused"},!1),x.default.supportsFeature(x.default.F.MD_BACKEND)||"a"!==e.eventType&&"d"!==e.eventType||(r.unreadCount=this.unreadCount+1||1)),(0,me.updateLocal)(this.id,r).then((0,n.default)((function*(){if(x.default.supportsFeature(x.default.F.MD_BACKEND))try{var{unreadCount:e,timestamp:a}=yield(0,Ae.getChatMeta)(t.id);r.t=a,r.unreadCount=e}catch(e){__LOG__(4,void 0,new Error)`onNewMsg: unable to find metadata from chat table for id:${t.id.toString()}`}return r})))})).then((t=>{e.isSentByMeFromWeb&&e.promises.sendPromise?this.setAndKeepPrevious(t,e.promises.sendPromise):this.set(t);var r=L.default.get(this.id);if(r&&(r.timestamp=w.default.globalUnixTime()),"gp2"!==e.type||"add"!==e.subtype&&"create"!==e.subtype||this.getGroupMetadataCollection().trigger(`group_participant_change_${(0,F.getMaybeMeUser)().toString()}`,this.id),!e.isSentByMe){switch(e.eventType){case"d":case"a":"d"===e.eventType&&M.default.alertNewMsg(e),this.msgs.length<R.default.MSG_PRELOAD_THRESHOLD&&this.loadEarlierMsgs(void 0,H.default.WEBC_QUERY_TRIGGER_TYPE.NEW_MESSAGE_PREFETCH).catchType(k.E404,(()=>{})).catch((e=>{__LOG__(2)`chat:onNewMsg failed\n${e}`}));break;case"n":e.type===R.default.MSG_TYPE.CALL_LOG&&M.default.alertNewMsg(e);break;case"s":if("gp2"===e.type&&"add"===e.subtype&&(0,F.getMaybeMeUser)().equals(e.recipients[0])&&!this.contact.name)return;M.default.alertNewMsg(e),this.getGroupMetadataCollection().trigger(`group_participant_change_${(0,F.getMaybeMeUser)().toString()}`,this.id)}var a=e.mediaData;!a||"image"!==a.type&&"video"!==a.type||M.default.newMediaMsg(e),x.default.supportsFeature(x.default.F.MD_BACKEND)&&t.unreadCount&&(0,Te.processOrphanPeerReceipt)(e.id)}}))}}canPin(){if(this.archive)return!1;var e=this.promises&&this.promises.setArchive;return!e||!e.archive}canArchive(){return!this.isBroadcast||x.default.supportsFeature(x.default.F.ARCHIVE_BROADCAST)}sendDismissChangeNumber(){if(this.promises.sendDismissChangeNumber)return this.promises.sendDismissChangeNumber;var e=x.default.supportsFeature(x.default.F.MD_BACKEND)?Promise.resolve({status:200,_duplicate:null}):Ee.default.sendConversationDismissChangeNumber(this.id);this.promises.sendDismissChangeNumber=e;var t=new g.ActionType(Y.default.t(66)),r=e.then((e=>200===e.status?new g.ActionType(Y.default.t(65)):e.status>=400?new g.ActionType(Y.default.t(64)):void 0)).catch((()=>(__LOG__(3)`models:chat:sendDismissChangeNumber dropped`,new g.ActionType(Y.default.t(64),{actionText:Y.default.t(199),actionHandler:this.sendDismissChangeNumber.bind(this)}))));return M.default.openToast(m.createElement(g.ActionToast,{id:(0,g.genId)(),initialAction:t,pendingAction:r})),e.then((e=>{if(200===e.status&&!e._duplicate)return(0,me.updateLocal)(this.id,{changeNumberNewJid:void 0,changeNumberOldJid:void 0}).then((()=>{this.changeNumberOldJid=this.changeNumberNewJid=void 0}))})).finally((()=>{this.promises.sendDismissChangeNumber=null}))}setComposeContents(e){this.composeContents=e}getSessionPersistedComposeContents(){return(0,F.getComposeContents)(this.id)}getComposeContents(){return(0,p.default)(this.composeContents)?this.getSessionPersistedComposeContents()||{}:this.composeContents}setAttachMediaContents(e){this.attachMediaContents=e}preload(){1===this.msgs.length&&this.loadEarlierMsgs().catchType(k.E404,(()=>{})).catch((e=>{__LOG__(2)`chat:preload failed\n${e}`}))}onEmptyMRM(){__LOG__(2)`models:Chat:removeMsg 0 messages left, querying...`,this.loadEarlierMsgs().catchType(k.E404,(()=>{})).catch((e=>{__LOG__(2)`chat:onEmptyMRM failed\n${e}`}))}loadEarlierMsgs(e,t){var r=this;return(0,n.default)((function*(){x.default.supportsFeature(x.default.F.MD_BACKEND)&&(yield r.waitForChatLoading());var a=e,i=null!=t?t:H.default.WEBC_QUERY_TRIGGER_TYPE.USER_SCROLL;if(a||(a=r.msgs),a.msgLoadState.noEarlierMsgs)return Promise.resolve();if(a.msgLoadState.isLoadingEarlierMsgs)return a.loadEarlierPromise;var n=a?a.head():null;return r._loadMsgs("before",a,i).then((e=>{var t=n?n.msgChunk:a;return t&&Array.isArray(e)&&e.length<R.default.PAGE_SIZE&&(t.msgLoadState.noEarlierMsgs=!x.default.supportsFeature(x.default.F.MD_BACKEND)||r.endOfHistoryTransferType!==be.INCOMPLETE),t&&r.isMostRecentCMC(t)&&r.trigger("msgs:loadEarlier"),e}))}))()}isMostRecentCMC(e){return this.msgs===e}loadRecentMsgs(e){var t=e;return t||(t=this.msgs),this.isMostRecentCMC(t)?Promise.resolve():t.msgLoadState.isLoadingRecentMsgs?t.loadRecentPromise:this._loadMsgs("after",t,H.default.WEBC_QUERY_TRIGGER_TYPE.USER_SCROLL)}_loadMsgs(e,t,r){var a,i={};(a="after"===e?t.last():t.head())?i=a.id.clone():i.remote=this.id,i.count=R.default.PAGE_SIZE,i.direction=e;var n=(0,q.newMessageQueryEvent)(r);return this._loadMsgsPromiseLoop(a,t,$.default.findQuery.bind($.default,i,{logOnSend:e=>{n.webcResponseBytes+=e.binarySize}}),e,n)}_updateMsgLoadState(e,t,r){var a=e&&e.msgChunk&&e.msgChunk!==t;t.msgLoadState.contextLoaded=!0,e&&a&&((0,Z.default)(e.msgChunk,"msg.msgChunk").msgLoadState.contextLoaded=!0),"after"===r?t.msgLoadState.isLoadingRecentMsgs=!1:"before"===r?t.msgLoadState.isLoadingEarlierMsgs=!1:"around"===r&&(t.msgLoadState.isLoadingAroundMsgs=!1)}_loadMsgsPromiseLoop(e,t,r,a,i,n=!0){var s=performance.now();"after"===a?(t.msgLoadState.isLoadingRecentMsgs=!0,i.webcMessageQueryType=H.default.WEBC_MESSAGE_QUERY_DIRECTION.LOAD_NEXT):"before"===a?(t.msgLoadState.isLoadingEarlierMsgs=!0,i.webcMessageQueryType=H.default.WEBC_MESSAGE_QUERY_DIRECTION.LOAD_PREV):"around"===a&&(t.msgLoadState.isLoadingAroundMsgs=!0,i.webcMessageQueryType=H.default.WEBC_MESSAGE_QUERY_DIRECTION.LOAD_AROUND),i.webcBrowserNetworkType=(0,X.getEffectiveNetworkType)(),i.webcChatType=this.getWebcChatType(),"number"==typeof this.initialIndex&&(i.webcChatPosition=this.initialIndex);var o=(0,_.promiseLoop)(((n,o,l)=>{var d=(0,f.delayMs)(fe.expBackoff(l,12e4,1e3,.1)),u=Promise.resolve();return x.default.supportsFeature(x.default.F.MD_BACKEND)||"CONNECTED"===Se.default.stream||(u=(0,ve.default)(Se.default,"change:stream",(()=>"CONNECTED"===Se.default.stream))),u.then((()=>this.regCancellablePromise(r()).then((r=>{var o;i.webcQueryT=Math.ceil(performance.now()-s),Array.isArray(r[0])?(o=r[0][0],r.forEach((e=>(0,q.logMessageCounts)(i,e)))):(o=r[0],(0,q.logMessageCounts)(i,r)),o&&(i.webcEarliestMessageT=o.t,o.msgChunk===this.msgs&&(i.webcEarliestMessageIndex=this.msgs.length-1)),(0,U.default)().then((e=>{e&&(i.webcBrowserStorageQuotaBytes=e.quota,i.webcBrowserStorageQuotaUsedBytes=e.usage)})).finally((()=>i.commit())),this._updateMsgLoadState(e,t,a),n(r)})))).catchConditional((e=>!(e instanceof Promise.CancellationError)),(r=>l>3||404===r?(this._updateMsgLoadState(e,t,a),__LOG__(3)`chat:loadMsgs:error ${String(r)}`,404===r?Promise.reject(new k.E404):Promise.reject(new G.GaveUpRetry(`Gave up msg fetch after ${l} tries`))):d))}),0).catchType(G.GaveUpRetry,(()=>[])).catchType(k.E404,(e=>{if(n)return[];throw e}));return"after"===a?t.loadRecentPromise=o:"before"===a?t.loadEarlierPromise=o:"around"===a&&(t.loadAroundPromise=o),o}getSearchContext(e,t){var r,a=null;e instanceof V.default?a=e:e instanceof z.default&&(r=e);var i=a?a.msgChunk:void 0,n=Math.trunc(R.default.PAGE_SIZE/3*2);if(!i||!i.msgLoadState.contextLoaded){i||(i=new C.default,this.msgChunks.push(i),a&&i.add(a));var s=a?a.id.clone():r.clone();s.count=n;var o=function(){if(a)return a.msgChunk;if(null!=r){var e=$.default.get(r);return e&&e.msgChunk?e.msgChunk:i}return i},l=(0,q.newMessageQueryEvent)(H.default.WEBC_QUERY_TRIGGER_TYPE.SEARCH_RESULT_CLICK);this._loadMsgsPromiseLoop(a,i,$.default.getContext.bind($.default,s,o,(e=>{l.webcResponseBytes+=e.binarySize})),"around",l,null==t).then((e=>{var t=o();t&&i&&t!==i&&this.notifyMsgCollectionMerge(t,i,t);var s=e[0],l=r?$.default.get(r):a;l&&Array.isArray(s)&&s.length<n&&((0,Z.default)(l.msgChunk,"loadedMsg.msgChunk").msgLoadState.noEarlierMsgs=!x.default.supportsFeature(x.default.F.MD_BACKEND)||this.endOfHistoryTransferType!==be.INCOMPLETE,i&&l.msgChunk!==i&&(i.msgLoadState.noEarlierMsgs=!x.default.supportsFeature(x.default.F.MD_BACKEND)||this.endOfHistoryTransferType!==be.INCOMPLETE))})).catch((()=>{t&&(t.isQuotedMsgAvailable=!1)}))}return{collection:i,msg:a,key:r,highlightMsg:!0}}sendStarMsgs(e,t){return this.promises.sendStarMsgs?this.promises.sendStarMsgs:this.promises.sendStarMsgs=(0,de.sendStarMsgs)(this.id,e,t).then((()=>{e.forEach((e=>{e.set("star",t)})),t?(0,pe.addStarredMsgs)(e):(0,pe.removeStarredMsgs)(e)})).finally((()=>{this.promises.sendStarMsgs=null}))}sendRevokeMsgs(e,t){return this.promises.sendRevokeMsgs?this.promises.sendRevokeMsgs:this.promises.sendRevokeMsgs=Promise.all(e.map((e=>(0,ne.sendRevoke)(e,t)))).finally((()=>{this.promises.sendRevokeMsgs=null}))}sendDeleteMsgs(e,t){return this.promises.sendDeleteMsgs||(this.promises.sendDeleteMsgs=(0,se.sendDeleteMsgs)(e,t,this.id).then((()=>(e.forEach((e=>{e.delete()})),e.length))).catchType(k.ServerStatusCodeError,(()=>{var t=0;return e.forEach((e=>{(e.ack===R.default.ACK.FAILED||e.isExpired())&&(e.delete(),t++)})),t})).finally((()=>{this.promises.sendDeleteMsgs=null}))),this.promises.sendDeleteMsgs}deleteMsgs(e,t){this.deleteMsgsBeforeMsgInclusive(void 0,!e,t)}deleteMsgsOlderThan(e,t,r){var a=this.msgs,i=a.head();!i||i.t>=e||((i=a.last())&&i.t<e?this.deleteMsgs(t,r):this.deleteMsgsPartial((function(a){return a&&(r&&!(0,J.msgMatchesType)(a,r)||a.star&&!t||a.t>=e||a.isPersistent)})))}deleteMsgsBeforeMsgInclusive(e,t=!1,r){var a;if(e){if(!this.msgs.get(e.id))return;a=this.msgs.indexOf(e)}else a=this.msgs.length;this.deleteMsgsPartial((function(e,i){return r&&!(0,J.msgMatchesType)(e,r)||e.msgChunk===this.msgs&&i>a||t&&e.star||e.isPersistent&&t}),!0)}deleteMsgsPartial(e,t=!1){var r=this.unreadCount;if(this.getAllCMCs().forEach((r=>{var a=r.filter(((t,r,a)=>!e.apply(this,[t,r,a])));r.remove(a,void 0,t),a.forEach((e=>{e.delete()}))})),(0,c.default)(this.msgChunks).forEach((e=>{0===e.length&&this.removeMsgsCollection(e)})),this.msgs.length>0){var a=r>this.msgs.length?this.msgs.length:r;(0,me.updateLocal)(this.id,{unreadCount:a}).then((()=>{this.unreadCount=a,this.msgs.msgLoadState.noEarlierMsgs=!x.default.supportsFeature(x.default.F.MD_BACKEND)||this.endOfHistoryTransferType!==be.INCOMPLETE}))}}getFirstMsgWithStatus(){return this.msgs.getModelsArray().find((function(e){return!e.isNotification&&(e.isSentByMe||e.type===R.default.MSG_TYPE.PTT||e.isViewOnce||e.isEphemeral)}))}getLastReceivedMsg(){for(var e=this.msgs.length-1;e>=0;e--){var t=this.msgs.at(e);if(t&&(!t.local||t.ack>R.default.ACK.CLOCK))return t}}getLastReceivedNonExpiredMsg(e){for(var t=this.msgs.length-1;t>=0;t--){var r=this.msgs.at(t);if(r&&(!r.local||r.ack>R.default.ACK.CLOCK)&&(!r.isEphemeral||null!=r.ephemeralExpirationTimestamp&&r.ephemeralExpirationTimestamp>e))return r}}getLastMsgKeyForAction(){var e,t=this.msgs.last();return t&&(e=!this.lastReceivedKey||t.id.fromMe&&t.local&&t.ack===R.default.ACK.CLOCK?t.id:this.lastReceivedKey),e||void 0}getLastTimestampMsg(){for(var e=this.msgs.length-1;e>=0;e--){var t=this.msgs.at(e);if(t&&"i"!==(0,J.eventTypeFromMsgType)(t))return t}}getWebcChatType(){switch(this.kind){case Ce.CHAT:return H.default.WEBC_CHAT_TYPE.INDIVIDUAL;case Ce.GROUP:return H.default.WEBC_CHAT_TYPE.GROUP;case Ce.BROADCAST:return H.default.WEBC_CHAT_TYPE.BROADCAST_LIST;default:throw new TypeError(`Invalid Chat.kind ${String(this.kind)}`)}}deregisterExpiredViewOnceBulkMessages(e){e.forEach(this._deregisterExpiredViewOnceMessage)}_deregisterExpiredViewOnceMessage(e){(0,ge.isExpired)(e.safe())&&(0,W.deregisterMsg)(e)}_resetEphemeralMessageExpirationTimer(e){if(ue.default.ephemeralMessages){v.default.clearTimeout(this._ephemeralMessageTimerIds.get(e)),this._ephemeralMessageTimerIds.delete(e),this._ephemeralMessagesToDelete.delete(e);var{ephemeralExpirationTimestamp:t}=e;if(null!=t&&this.msgs.includes(e)){var r=()=>{this._ephemeralMessageTimerIds.delete(e),this.active?this._ephemeralMessagesToDelete.add(e):e.delete({skipUpdatingSortTime:!0,doNotResetLastReceived:!0})};if(e.isExpired())r();else{var a=v.default.setGlobalTimeout(r,1e3*t);this._ephemeralMessageTimerIds.set(e,a)}}}}sendProductMessage(e,t){var r=this;return(0,n.default)((function*(){yield(0,re.sendProductMessage)(r,e,t)}))()}sendGroupInviteMessage(e,t,r,a,i,n){var s=(0,F.getMaybeMeUser)(),o={ack:R.default.ACK.CLOCK,from:s,id:new z.default({from:s,to:this.id,id:(0,ie.default)(),participant:void 0,selfDir:"out"}),local:!0,self:"out",t:w.default.globalUnixTime(),to:this.id,type:"groups_v4_invite",isNewMsg:!0,inviteGrpJpegThum:n,inviteCode:r,inviteCodeExp:a,inviteGrp:e,inviteGrpName:t,comment:i};return(0,oe.addAndSendMsgToChat)(this,o)[1]}_isMediaMsg(e){return Boolean(e.asMms&&!e.ctwaContext)}_forwardMessageAndSendToChat(e,t,r=!1){if(this._isMediaMsg(e))return(0,W.forwardMediaMsg)(e,this,r).then(void 0);var a=Oe(e),i=(0,F.getMaybeMeUser)(),n=new z.default({from:i,to:t,id:(0,ie.default)(),participant:void 0,selfDir:"out"});return e.ctwaContext&&(a.body=e.ctwaContext.sourceUrl,a.type=R.default.MSG_TYPE.CHAT,a.mediaObject=void 0),ue.default.ephemeralMessages&&(this.isEphemeralSettingOn()&&(a.ephemeralDuration=this.getEphemeralSetting()),a.ephemeralSettingTimestamp=this.getEphemeralSettingTimestamp()),Object.assign(a,{id:n,from:i,t:w.default.globalUnixTime(),to:t,ack:R.default.ACK.CLOCK,participant:void 0,local:!0,self:"out",isNewMsg:!0,star:!1,isForwarded:e.isForwarded||!e.isSentByMe,forwardedFromWeb:!0,forwardingScore:e.getForwardingScoreWhenForwarded(),multicast:r}),(0,oe.addAndSendMsgToChat)(this,a),Promise.resolve()}forwardMessages(e,t=!1){var r=this;return(0,n.default)((function*(){var a=r.id,i=r.contact;if(i.isUser&&i.isBlocked())throw new D.default("Forwarded to contact is blocked",i);var n=[];for(var s of e)try{yield r._forwardMessageAndSendToChat(s,a,t)}catch(e){r._isMediaMsg(s)&&n.push(s)}return n}))()}updateReadOnly(){if(!this.isSupportGroup()||!this.isReadOnly){var e=Promise.resolve();if(this.isGroup&&!this.groupMetadata.stale){var t=!1;t=x.default.supportsFeature(x.default.F.MD_BACKEND)?!this.groupMetadata.participants.get((0,F.getMeUser)()):!this.groupMetadata.participants.get((0,F.getMaybeMeUser)()),e=(0,me.updateLocal)(this.id,{isReadOnly:t}).then((()=>this.isReadOnly=t))}e.then((()=>{this.isBroadcast&&this.updateTitle()}))}}updateIsAnnounceGrpRestrict(){if(this.isGroup&&!this.groupMetadata.stale){var e=this.groupMetadata.participants.get((0,F.getMaybeMeUser)()),t=e&&!e.isAdmin&&this.groupMetadata.announce;(0,me.updateLocal)(this.id,{isAnnounceGrpRestrict:t}).then((()=>this.isAnnounceGrpRestrict=t))}}sortMsgs(e){var t=e.map((e=>{var t=(0,Z.default)(e.msgChunk,"msg.msgChunk");return{msg:e,chunkT:(0,Z.default)(t.at(0),"chunk.at(0)").t,index:t.indexOf(e)}}));return(0,u.default)(t,["chunkT","index"]).map((e=>e.msg))}waitForChatLoading(){var e=Promise.resolve();return x.default.supportsFeature(x.default.F.MD_BACKEND)&&this.pendingInitialLoading&&(e=(0,ve.default)(this,"change:pendingInitialLoading",(()=>!this.pendingInitialLoading))),e}_updateAssignedColor(){if(this.colors){var e=this.groupMetadata.participants,t=this.colors,r=(0,d.default)(Object.keys(t),e.map((e=>e.id.toString())).map(j.default));r.forEach((function(e){delete t[e]})),r.length&&this._saveAssignedColors()}}loadAssignedColors(){return this.groupMetadata&&this.listenTo(this.groupMetadata.participants,"remove reset",this._updateAssignedColor),(0,F.getGroupParticipantAssignedColor)(this.id)||{}}saveAssignedColors(){var e=this.colors;e&&(0,F.setGroupParticipantAssignedColor)(this.id,e)}assignedColor(e){var t,r=this.colors||(this.colors=this.loadAssignedColors()),a=(0,j.default)(e.toString());if(t=r[a])return t;var i={};(0,l.default)(r,((e,t)=>{i[e]?i[e].push(t):i[e]=[t]}));for(var n=Number.POSITIVE_INFINITY,s=1;s<R.default.NUM_COLORS;s++){if(!i[s]){t=s;break}i[s].length<n&&(n=i[s].length,t=s)}return r[a]=t,this._saveAssignedColors(),t}unstarAll(){var e=this.getAllMsgs();e.forEach((e=>{e&&(e.star=!1)})),(0,pe.removeStarredMsgs)(e)}constructMediaMsgs(e){return e?e.isViewOnce?new b.default:(this.getMediaMsgs().includes(e)||e.msgChunk===this.msgs?(t=this.getMediaMsgs()).hasMediaAfter=!1:t=new b.default,t.includes(e)||(e.msgChunk?t.add(e.msgChunk.filter(this.isMsgForMediaCollection)):t.add(e)),t):this.getMediaMsgs();var t}fts(e,t=1,r){if(1===t){var a=this.ftsCache[e];if(a)return a;var i=$.default.search(e,t,r,this.id);this.ftsCache[e]=i;var n=()=>{this.ftsCache[e]=null};return setTimeout(n,3e5),i.catch(n),i}return $.default.search(e,t,r,this.id)}_clearFtsCache(){this.ftsCache={}}updateSortTime(){this.promises.updateSortTime||(this.promises.updateSortTime=this.regCancellablePromise((0,f.delayMs)(0)).then((()=>{var e=this.getLastTimestampMsg();return e?(this.t=e.t,Promise.resolve()):this.msgs.msgLoadState.noEarlierMsgs||this.pendingMsgs?Promise.resolve():this.loadEarlierMsgs()})).then((e=>{if(e){var t=this.getLastTimestampMsg();this.t=t?t.t:void 0}})).catch((()=>{})).finally((()=>{this.promises.updateSortTime=void 0})))}removeFromCollection(e){e.star&&(0,pe.removeStarredMsgs)([e]),e.isMedia&&this.mediaMsgs?this.mediaMsgs.remove(e):e.getLinks().length&&this.linkMsgs?this.linkMsgs.remove(e):e.asDoc&&this.docMsgs?this.docMsgs.remove(e):null!=e.asProduct&&this.productMsgs&&this.productMsgs.remove(e),this.updateMediasCountOnMsg(e,!0)}getMediaMsgs(){return this.mediaMsgs||(this.mediaMsgs=new b.default),this.mediaMsgs}getLinkMsgs(){return this.linkMsgs||(this.linkMsgs=new A.default),this.linkMsgs}getDocMsgs(){return this.docMsgs||(this.docMsgs=new T.default),this.docMsgs}getParticipantCount(){var e;return(null===(e=this.groupMetadata)||void 0===e?void 0:e.participants.length)||1}getProductMsgs(){return this.productMsgs||(this.productMsgs=new P.default),this.productMsgs}getReceivedVcardMsgs(){return this.contact.isMyContact||!this.contact.isUser?null:(this.receivedVcardMsgs||(this.receivedVcardMsgs=new O.default,this.receivedVcardMsgs.parent=this),this.receivedVcardMsgs)}dismissVcard(){this.vcardDismissed=!0}updateMediasCountOnMsg(e,t=!1){if(x.default.supportsFeature(x.default.F.MEDIAS_COUNT)){var r=t?-1:1;e.isMedia&&(this.mediaCount+=r);var a=e.getLinks().length;a&&(this.linkCount+=r*a),e.asDoc&&(this.docCount+=r)}}resetMediasCount(e){x.default.supportsFeature(x.default.F.MEDIAS_COUNT)&&(null!=e.mediaCount&&(this.mediaCount=e.mediaCount),null!=e.linkCount&&(this.linkCount=e.linkCount),null!=e.docCount&&(this.docCount=e.docCount))}getStarredMsgs(){var e=this.starredMsgs;return e||(this.starredMsgs=e=new pe.StarredMsgCollection,this.starredMsgs.add(pe.default.filter((e=>e.chat===this)))),e}setAndKeepPrevious(e,t){var r=Object.keys(e);r.forEach((e=>{e in this.ackedProps||(this.ackedProps[e]=this[e])})),t.finally((()=>{r.forEach((e=>{delete this.ackedProps[e]}))})),this.set(e)}getAckedPhoneProps(){return{wid:this.id,mute:this.mute.expiration,active:this.active,isReadOnly:this.isReadOnly,modifyTag:this.modifyTag,unreadCount:this.unreadCount,ephemeralDuration:this.ephemeralDuration,ephemeralSettingTimestamp:this.ephemeralSettingTimestamp,changeNumberOldJid:this.changeNumberOldJid,changeNumberNewJid:this.changeNumberNewJid,archive:"archive"in this.ackedProps?this.ackedProps.archive:this.archive,notSpam:"notSpam"in this.ackedProps?this.ackedProps.notSpam:this.notSpam,pin:"pin"in this.ackedProps?this.ackedProps.pin:this.pin}}regCancellablePromise(e){return this._promises||(this._promises=[]),this._promises.push(e),e.cancellable().finally((()=>{this._promises=(0,o.default)(this._promises,e),this._promises&&0===this._promises.length&&(this._promises=null)}))}cancelPendingPromises(){this._promises&&this._promises.length>0&&(this._promises.forEach((function(e){e.cancel()})),this._promises=null)}matchFilter(e={}){return!!(0,p.default)(e)||(e.label?this.labels&&this.labels.includes(e.label):e.kind===R.default.SMB_SEARCH_FILTERS.UNREAD?!!this.hasUnread:e.kind===this.kind)}getEphemeralSetting(){if(!ue.default.ephemeralMessages)return null;var e=this.isGroup?this.groupMetadata.ephemeralDuration:this.ephemeralDuration;return null==e||0===e?null:e}getEphemeralSettingTimestamp(){return ue.default.ephemeralMessages?this.isGroup||0===this.ephemeralSettingTimestamp?null:this.ephemeralSettingTimestamp:null}isEphemeralSettingOn(){if(!ue.default.ephemeralMessages)return!1;var e=this.getEphemeralSetting();return null!=e&&0!==e}shouldShowEphemeralSetting(){if(!ue.default.ephemeralMessages)return!1;if(!ue.default.ephemeralMessagesSetting)return!1;if(!x.default.supportsAnyFeature(x.default.F.EPHEMERAL_MESSAGES,x.default.F.MD_BACKEND))return!1;if(this.isGroup){var e=this.groupMetadata.participants.getSuperAdmin();if(e&&e.contact.isEnterprise)return!1;if(!this.groupMetadata.canSetEphemeralSetting()&&!this.isEphemeralSettingOn())return!1}return!this.isBroadcast&&!this.contact.isEnterprise}getCollection(){return r(85030).default}getGroupMetadataCollection(){return r(25120).default}}function Oe(e){var t,r=["buttons","caption","broadcast","ephemeralDuration","ephemeralSettingTimestamp","ephemeralStartTimestamp","ephemeralOutOfSync","dynamicReplyButtons","replyButtons"];return!0===e.isDynamicReplyButtonsMsg&&e.type===R.default.MSG_TYPE.CHAT||(r=["footer",...r]),(null===(t=e.quotedMsg)||void 0===t?void 0:t.type)!==R.default.MSG_TYPE.PRODUCT&&(r=["quotedMsg","quotedParticipant","quotedRemoteJid","quotedStanzaID",...r]),(0,s.default)(e.toJSON(),r)}Pe.Proxy="chat",Pe.idClass=ye.default;var we=(0,y.defineModel)(Pe);t.default=we},28546:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=(e,t)=>{var r=e.pin||0,a=t.pin||0;if(r||a)return r!==a?r>a?-1:1:e.id.toString()<t.id.toString()?-1:1;var i=e.t||0,n=t.t||0;return i!==n?i>n?-1:1:e.id.toString()<t.id.toString()?-1:1};t.default=r},85030:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.ChatCollection=void 0;var n=i(r(52954)),s=i(r(42208)),o=i(r(60417)),l=i(r(90882)),d=i(r(16760)),u=i(r(45455)),c=i(r(54073)),p=r(60266),h=r(9737),f=a(r(18641)),_=r(25559),m=i(r(62820)),g=i(r(28546)),v=a(r(79435)),E=i(r(23045)),y=i(r(43805)),S=r(68899),T=r(33576),A=r(77400),b=i(r(99532)),C=i(r(81131)),P=r(66239),O=i(r(20468)),w=r(31046),M=i(r(62345)),I=i(r(83746)),R=i(r(79569)),D=i(r(84553)),N=i(r(11541)),L=r(76115),k=r(98701),U=r(966),G=i(r(34749)),F=i(r(89348)),x=i(r(87966)),B=r(30421),Y=i(r(57568)),K=i(r(43926)),j=a(r(15934));class W extends f.default{constructor(){super(),this.notSpam={},this.promises={sendUnstarAll:null},this._sortEnabled=!1,this._viewOnceCleanupTaskQueue=new Set,this.enableSortListener(),this.listenTo(j.default,"change:stream",(()=>{j.default.stream===j.STREAM.RESUMING&&this.forEach((e=>{e.pendingMsgs=!1}))})),this.listenToOnce(this,"sort",(0,c.default)(this.setIndexes,100)),this._scheduleViewOnceMediaCleanup()}_scheduleViewOnceMediaCleanup(){clearTimeout(this._viewOnceCleanupTimeout),this._viewOnceCleanupTimeout=setTimeout((()=>{w.IdleCallbackTasks.enqueue((()=>{this._runViewOnceMediaCleanup(),this._scheduleViewOnceMediaCleanup()}))}),18e5)}_runViewOnceMediaCleanup(){this.forEach((e=>{var t=e.id;this._viewOnceCleanupTaskQueue.has(t)||(w.IdleCallbackTasks.enqueue((()=>{this._viewOnceCleanupTaskQueue.delete(t);var e=this.get(t);!1===(null==e?void 0:e.active)&&e.deregisterExpiredViewOnceBulkMessages(e.msgs)})),this._viewOnceCleanupTaskQueue.add(t))}))}enableSortListener(e){this._sortEnabled||(this.listenTo(this,"change:t change:pin change:shouldAppearInList",this.sort),e&&this.sort(),this._sortEnabled=!0)}disableSortListener(){this._sortEnabled&&(this.stopListening(null,null,this.sort),this._sortEnabled=!1)}setIndexes(){this.forEach(((e,t)=>{e.initialIndex=t}))}active(){var e=this.filter((e=>e.active))[0];return e||void 0}find(e){return O.default.supportsFeature(O.default.F.MD_BACKEND)?this._findMD(e):super.find(e)}_find(e){return Promise.resolve({id:e,createdLocally:!0})}_findQuery(e){var t=this,a={};return(0,A.find)(!!e.retry,a).then((function(e){if("preempted"===e)return Promise.reject("chats preempted");if(v.default.platform===v.PLATFORMS.IPHONE||v.default.platform===v.PLATFORMS.SMBI){var i=r(30528).default;(0,u.default)(e)?i.trigger(E.default.COLLECTION_HAS_SYNCED):setTimeout((()=>{i.trigger(E.default.COLLECTION_HAS_SYNCED)}),2500)}return t.trigger(E.default.COLLECTION_HAS_SYNCED,a),Promise.resolve(e)}))}_findMD(e){var t=()=>super.find,r=this;return(0,n.default)((function*(){var a=r.get(e);return a||((a=yield(0,A.findLocal)(String(e)))?r.gadd(a):((a=yield t().call(r,e))&&(yield(0,S.createLocal)(a.id,{id:a.id.toString(),t:a.t,unreadCount:a.unreadCount,archive:a.archive,isReadOnly:a.isReadOnly,modifyTag:a.modifyTag,notSpam:a.notSpam,pin:a.pin,changeNumberOldJid:null!=a.changeNumberOldJid?a.changeNumberOldJid.toString():void 0,changeNumberNewJid:null!=a.changeNumberNewJid?a.changeNumberNewJid.toString():void 0,muteExpiration:a.muteExpiration,endOfHistoryTransferType:a.endOfHistoryTransferType})),a))}))()}sync(){this.findQuery({}).catchType(T.WebdDrop,(()=>{}));var e=r(30528).default;return Promise.all([(0,Y.default)(this,E.default.COLLECTION_HAS_SYNCED),e.hasSynced()])}getKeysForResyncMsgs(){return this.filter((function(e){return e.shouldAppearInList})).map((function(e){var t=e.getAckedPhoneProps(),r=e.lastReceivedKey;return r&&(t.id=r.id,t.fromMe=r.fromMe.toString(),t.participant=r.participant),t}))}resyncMessages(){__LOG__(2)`ChatStore:resyncMessages`;var e=this.getKeysForResyncMsgs();return(0,L.resyncMessages)(e).then((e=>{if(e.status>=400)return __LOG__(3)`ChatStore:resyncMessages resume error ${e.status}`,Promise.reject(new Error("ChatStore:resyncMessages resume error "+e.status));__LOG__(2)`ChatStore:resyncMessages resume success`;try{this.disableSortListener(),e.data.forEach((e=>{if(e.disableUnreadAnchor=!1,e.firstUnreadKey=void 0,e.keys&&1===e.keys.length){var t=e.keys[0];e.firstUnreadKey=new I.default({id:t[0],fromMe:t[1],participant:t[2],remote:e.id})}if("delete"!==e.type&&!K.default.isPSA(e.id)){var r=y.default.get(e.id);if(r){if(e.name){var a={name:e.name};(0,B.updateLocal)(r.id,a).then((()=>{r.set(a)}))}}else y.default.add({id:e.id,name:e.name})}var i=this.get(e.id);if(i)if("clear"===e.type){i.resetMediaMsgs();var n=[];i.msgs.forEach((e=>n.push(e))),i.msgChunks.length&&i.msgChunks.forEach((e=>{e.forEach((e=>n.push(e)))})),i.set({t:e.t,unreadCount:e.unreadCount,createdLocally:!1,archive:e.archive,isReadOnly:e.isReadOnly,modifyTag:e.modifyTag,msgs:[],notSpam:e.notSpam,unreadMsgAnchor:void 0,disableUnreadAnchor:e.disableUnreadAnchor,pendingMsgs:e.pendingMsgs,pin:e.pin,changeNumberOldJid:e.changeNumberOldJid,changeNumberNewJid:e.changeNumberNewJid,muteExpiration:e.muteExpiration,ephemeralDuration:e.ephemeralDuration,ephemeralSettingTimestamp:e.ephemeralSettingTimestamp}),n.forEach((e=>{e.delete()})),__LOG__(2)`model:chat:resume: cleared chat for ${e.id}`}else"delete"===e.type?(i.delete(),__LOG__(2)`model:chat:resume: deleted chat for ${e.id}`):i.set(e,{merge:!0});else this.add(e)})),this.enableSortListener(!0)}catch(e){__LOG__(3)`model:chat:resume error in processing reply:${String(e)}`}(0,p.delayMs)(100).then((()=>{O.default.supportsFeature(O.default.F.USER_NOTICE)&&R.default.sync(!0),O.default.supportsFeature(O.default.F.SETTINGS_SYNC)&&G.default.sync(!0),e.checksum&&(0,k.resyncContacts)(e.checksum),e.statusChecksum&&r(65677).default.sync(e.statusChecksum),e.quickRepliesChecksum&&D.default.sync(e.quickRepliesChecksum),e.labelsChecksum&&M.default.sync(e.labelsChecksum),e.stickerPackChecksum&&x.default.sync(e.stickerPackChecksum),null!=e.recentStickersChecksum&&N.default.sync(e.recentStickersChecksum),null!=e.starredStickersChecksum&&F.default.sync(e.starredStickersChecksum)})).catch((e=>{__LOG__(3)`model:chat:resume error in processing checksum:${String(e)}`}))})).catchType(T.WebdDrop,(function(e){return __LOG__(3)`ChatStore:resyncMessages resume dropped`,Promise.reject(e)}))}unstarAllMessages(e,t){return(0,U.unstarAllMessages)(e,t)}forwardMessagesToChats(e,t){var a=Promise.all(e.map((e=>(0,h.promiseProps)({message:e,canForward:e.canForward()&&(null!=r(30528).default.get(e.id)||e.isEphemeral)}))));return Promise.all(t.filter((e=>e.canSend)).map((e=>{var t;return t=e.isUser&&e.contact.isBlocked()?(0,_.unblockContact)(e.contact):Promise.resolve(!0),Promise.all([a,t]).spread((t=>{var r=(0,d.default)((0,l.default)(t,{canForward:!0}),"message"),a=(0,d.default)((0,l.default)(t,{canForward:!1}),"message");return(0,h.promiseProps)({chat:e,undelivered:e.forwardMessages(r,!0),canForward:r,cannotForward:a})}))}))).then((e=>{var t=(0,o.default)(e.map((({chat:e,undelivered:t,canForward:r,cannotForward:a})=>{var i=null;return(t.length||a.length)&&(i=(0,b.default)({chat:e,undelivered:t,canForward:r,cannotForward:a})),i?{chat:e,reason:i}:null})));if(t.length)throw new C.default(t);return!0}))}saveToCache(){if(v.default.shouldSaveToCache()){var{id:e}=W.cachePolicy;__LOG__(2)`ChatCollection:saveToCache save: ${String(e)}`;var t=this.map(((e,t)=>{var r=e.toJSON(),a=t<20?Math.min(e.unreadCount+20,50):Math.min(Math.max(3,e.unreadCount),20);return r.msgs=e.msgs?e.msgs.slice(-a).map((e=>(0,s.default)(e.toJSON(),(e=>void 0!==e)))):[],r}));(0,P.setCollection)(e,t,!0)}}onResume(){var e=this.active();e&&e.presence.subscribe()}delete(){super.delete(),this.listenToOnce(this,"sort",(0,c.default)(this.setIndexes,100))}}t.ChatCollection=W,W.model=m.default,W.comparator=g.default,W.cachePolicy={id:"chat",policy:f.CACHE_POLICY.IMMEDIATE,trigger:"add sort remove reset change:id change:t change:unreadCount change:archive change:isReadOnly change:isAnnounceGrpRestrict change:modifyTag change:muteExpiration change:name change:notSpam change:pin change:changeNumberOldJid change:changeNumberNewJid change:lastReceivedKey change:msg:ack msgs:loadEarlier"};var H=new W;t.default=H},69783:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(r(18641)),s=i(r(23045)),o=r(33576),l=a(r(24461)),d=i(r(36169)),u=i(r(30528));class c extends n.default{constructor(...e){super(...e),this.hasDocBefore=!0}delete(){super.delete(),this.stopListening(),this.reset()}queryDocs(e,t){if(t)return this.queryDocBefore||(this.queryDocBefore=u.default.queryMedia(t.id.remote,s.default.MEDIA_QUERY_LIMIT,"before",t.id,"document").then((e=>((!e||e.length<s.default.MEDIA_QUERY_LIMIT)&&(this.hasDocBefore=!1),this.add(e.filter(p),{at:0}),{length:e.length}))).catchTypes(o.WebdDrop,l.ProtoVersionUndefined,(()=>{})).catchEqualTo(404,(()=>{})).finally((()=>{this.queryDocBefore=null,this.trigger("query_doc_before")})),this.trigger("query_doc_before")),this.queryDocBefore;var r=e.msgs;if(0===this.length){if(!r||0===r.length)return this.hasDocBefore=!1,new Promise((e=>{e({eof:!0})}));this.add(r.filter(p),{at:0})}if(e.msgs.msgLoadState.noEarlierMsgs)return this.hasDocBefore=!1,new Promise((e=>{e({eof:!0})}));if(this.length<=2*s.default.MEDIA_QUERY_LIMIT){var a=0===this.length?r.head():this.head();return this.queryDocs(e,a)}return new Promise((e=>{e({eof:!1})}))}}function p(e){return null!=e.asDoc&&!e.isVcardOverMmsDocument}t.default=c,c.model=d.default},48084:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(13275),s=i(r(18641)),o=i(r(23045)),l=r(33576),d=a(r(24461)),u=i(r(36169)),c=i(r(30528));class p extends s.default{constructor(...e){super(...e),this.hasLinkBefore=!0}delete(){super.delete(),this.stopListening(),this.reset()}queryLinks(e,t){if(t)return this.queryLinkBefore||(this.queryLinkBefore=c.default.queryMedia(t.id.remote,o.default.MEDIA_QUERY_LIMIT,"before",t.id,"url").then((e=>((!e||e.length<o.default.MEDIA_QUERY_LIMIT)&&(this.hasLinkBefore=!1),this.add(e,{at:0}),this.createLinksAndAddMsgs(e),{length:e.length}))).catchTypes(l.WebdDrop,d.ProtoVersionUndefined,(()=>{})).catchEqualTo(404,(()=>{})).finally((()=>{this.queryLinkBefore=null,this.trigger("query_link_before")})),this.trigger("query_link_before")),this.queryLinkBefore;var r=e.msgs.getModelsArray();if(0===this.length){if(!r||0===r.length)return this.hasLinkBefore=!1,new Promise((e=>{e({eof:!0})}));this.add(r.filter((e=>e.getLinks().length>0)),{at:0}),this.createLinksAndAddMsgs(r)}if(e.msgs.msgLoadState.noEarlierMsgs)return this.hasLinkBefore=!1,new Promise((e=>{e({eof:!0})}));if(this.length<=2*o.default.MEDIA_QUERY_LIMIT){var a=0===this.length?e.msgs.head():this.head();return this.queryLinks(e,a)}return new Promise((e=>{e({eof:!1})}))}createLinksAndAddMsgs(e){var t=[];(0,n.promiseLoop)(((r,a,i)=>{e.length===i&&r();var n=e[i];n.getLinks().length&&t.push(n)})).then((()=>{this.add(t),this.trigger("query_link_before")}))}}t.default=p,p.model=u.default,p.comparator=(e,t)=>e.t-t.t},50060:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(r(18641)),s=i(r(23045)),o=r(33576),l=a(r(24461)),d=i(r(36169)),u=i(r(30528)),c="before",p="after";function h(e){return e.isMedia&&!e.isViewOnce}class f extends n.default{constructor(...e){super(...e),this.hasMediaBefore=!0,this.hasMediaAfter=!0}delete(){super.delete(),this.stopListening()}getAfter(e){var t=this.indexOf(e);return t<0||t===this.length-1?null:this.at(t+1)}getBefore(e){var t=this.indexOf(e);return t<=0?null:this.at(t-1)}loadEarlierMedias(){var e=this.head();e&&this.queryMedia({msg:e})}loadRecentMedias(){var e=this.last();e&&this.queryMedia({msg:e,direction:p})}loadMoreAroundIfNeeded(e){if(e&&!e.isViewOnce){var t=this.indexOf(e);t<20&&this.hasMediaBefore&&this.loadEarlierMedias(),this.length-t<20&&this.hasMediaAfter&&this.loadRecentMedias()}}queryMedia(e){var t,{chat:r,msg:a}=e,i=null!==(t=e.direction)&&void 0!==t?t:c;if(!a&&r){var n=r.msgs;if(!n||0===n.length)return this.hasMediaBefore=!1,new Promise((e=>{e({eof:!0})}));this.add(n.filter(h),{at:0});var d=this.toArray();if(r.msgs.msgLoadState.noEarlierMsgs)return this.hasMediaBefore=!1,new Promise((e=>{e({eof:!0})}));if(d.length<=2*s.default.MEDIA_QUERY_LIMIT){var f=0===d.length?n.head():d[0];return this.queryMedia({chat:r,msg:f})}return new Promise((e=>{e({eof:!1})}))}if(a&&i===c){if(this.queryMediaBefore)return this.queryMediaBefore;var _=0;return this.queryMediaBefore=u.default.queryMedia(a.id.remote,s.default.MEDIA_QUERY_LIMIT,i,a.isMedia?a.id:void 0).then((e=>{var t=e.messages;(!t||t.length<s.default.MEDIA_QUERY_LIMIT)&&(this.hasMediaBefore=!1);var a=[];t&&t.length>0&&(a=t.filter(h)),this.add(a,{at:0});var i={mediaCount:e.mediaCount,linkCount:e.linkCount,docCount:e.docCount};return r&&r.resetMediasCount(i),{length:_=a.length}})).catchTypes(o.WebdDrop,l.ProtoVersionUndefined,(()=>{})).catchEqualTo(404,(()=>{})).finally((()=>{this.queryMediaBefore=null,this.trigger("query_media_before",_)})),this.trigger("query_media_before",0),this.queryMediaBefore}if(a&&i===p)return this.queryMediaAfter?this.queryMediaAfter:this.queryMediaAfter=u.default.queryMedia(a.id.remote,s.default.MEDIA_QUERY_LIMIT,i,a.id).then((e=>{var t=e.messages;(!t||t.length<s.default.MEDIA_QUERY_LIMIT)&&(this.hasMediaAfter=!1);var a=[];t&&t.length>0&&(a=t.filter(h)),this.add(a);var i={mediaCount:e.mediaCount,linkCount:e.linkCount,docCount:e.docCount};return r&&r.resetMediasCount(i),{length:a.length}})).catchTypes(o.WebdDrop,l.ProtoVersionUndefined,(()=>{})).catchEqualTo(404,(()=>{})).finally((()=>{this.queryMediaAfter=null,this.trigger("query_media_after")}))}}t.default=f,f.model=d.default},13649:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.MsgLoadState=void 0;var n=i(r(47677)),s=i(r(18641)),o=a(r(99778)),l=i(r(36169));class d extends o.default{constructor(...e){super(...e),this.noEarlierMsgs=(0,o.prop)(),this.isLoadingEarlierMsgs=(0,o.prop)(),this.isLoadingRecentMsgs=(0,o.prop)(),this.isLoadingAroundMsgs=(0,o.prop)(),this.contextLoaded=(0,o.prop)()}}d.Proxy="msgLoad";var u=(0,o.defineModel)(d);t.MsgLoadState=u;class c extends s.default{constructor(){super(),this.msgLoadState=new u({noEarlierMsgs:!1,isLoadingEarlierMsgs:!1,isLoadingRecentMsgs:!1,isLoadingAroundMsgs:!1,contextLoaded:!1}),this.listenTo(this,"add remove reset sort",this.triggerChangeLast)}delete(){this.stopListening(),super.delete(),this.msgLoadState.delete()}triggerChangeLast(e,t,r){var a=this.last();if(this._last!==a){this._last=a;var i=!1;t&&t.includes(e)&&r&&r.add&&!r.remove&&(i=!0),this.trigger("change:last",a,i)}}add(e,t){var a=super.add(e,t);return r(30528).default.add(a,t).forEach((e=>{e&&this.isModel(e)&&(e.msgChunk=this)})),a&&this.trigger("bulk_add",a,t),a}remove(e,t={},r=!1){var a=super.remove(e,t),i=!!t&&t.silent,n=a.filter((e=>!!e));return n.length&&!i&&(this.trigger("remove_msgs",n,t),r||this.trigger("update_sort_time")),a}replace(e){this.msgLoadState=e.msgLoadState,this.loadRecentPromise=e.loadRecentPromise,this.loadEarlierPromise=e.loadEarlierPromise,this.loadAroundPromise=e.loadAroundPromise;var t=e.getModelsArray();this.set(t,{silent:!0,merge:!1}),t.forEach((e=>{this.isModel(e)&&(e.msgChunk=this)})),this.trigger("bulk_add",t)}onMsgLoadStateChange(e){var t,r=()=>{e()},a=()=>{(0,n.default)(null!=t,"prevMsgLoadState cannot be null after bulk_add"),t.off("change",r);var a=this.msgLoadState;a.on("change",r),t=a,e()};(t=this.msgLoadState).on("change",r),this.on("bulk_add",a);var i=()=>{(0,n.default)(null!=t,"prevMsgLoadState cannot be null when unsubscribing"),this.off("bulk_add",a),t.off("change",r)};return()=>{var e=i;e&&(i=null,e())}}}t.default=c,c.model=l.default},95059:(e,t,r)=>{"use strict";var a=r(14859),i=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.DEFAULT_PREFERENCE=void 0;var n=i(r(99778)),s=a(r(43926)),o="defaultPreference";t.DEFAULT_PREFERENCE=o;class l extends n.default{constructor(...e){super(...e),this.id=(0,n.prop)(),this.wallpaperColor=(0,n.prop)(),this.saveToCameraRoll=(0,n.prop)(),this.showDoodle=(0,n.prop)()}getCollection(){return r(95419).default}}l.Proxy="chatPreference",l.idClass=s.default,l.allowedIds=[o];var d=(0,n.defineModel)(l);t.default=d},95419:(e,t,r)=>{"use strict";var a=r(14859),i=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(r(18641)),s=i(r(95059)),o=a(r(23045));class l extends n.default{initializeFromCache(e){this.add([{id:s.DEFAULT_PREFERENCE,wallpaperColor:o.default.DEFAULT_CHAT_WALLPAPER,saveToCameraRoll:!0,showDoodle:!0},...e||[]],{merge:!0})}get(e){return super.get(e)||super.get(s.DEFAULT_PREFERENCE)}delete(){super.delete(),this.add({id:s.DEFAULT_PREFERENCE,wallpaperColor:o.default.DEFAULT_CHAT_WALLPAPER,saveToCameraRoll:!0,showDoodle:!0})}}l.model=s.default,l.cachePolicy={id:"chat_preference",policy:n.CACHE_POLICY.LOAD,delay:1e3};var d=new l;t.default=d},48717:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(18641)),n=a(r(36169));class s extends i.default{constructor(...e){super(...e),this.hasProductBefore=!0}delete(){super.delete(),this.stopListening(),this.reset()}queryProducts(e){var t=e.msgs;return this.hasProductBefore=!1,this.add(t.filter((e=>null!=e.asProduct)),{at:0}),Promise.resolve()}}t.default=s,s.model=n.default,s.comparator=(e,t)=>e.t-t.t},44641:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(18641)),n=r(33576),s=a(r(20468)),o=a(r(36169)),l=a(r(30528));class d extends i.default{constructor(...e){super(...e),this.syncPromise=null,this.isSynced=!1}onResume(){this.isSynced=!1,this.sync(this.parent)}sync(e){return s.default.supportsFeature(s.default.F.INDEX_RECEIVED_VCARD)?this.isSynced?Promise.resolve():(this.syncPromise||(this.syncPromise=l.default.queryVcard(e.id).then((e=>this.add(e))).catchType(n.E499,(()=>{})).catch((()=>{})).finally((()=>{this.isSynced=!0,this.syncPromise=null}))),this.syncPromise):(this.isSynced=!0,Promise.resolve())}}t.default=d,d.model=o.default,d.resumeOnAvailable=!0},36457:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return o.apply(this,arguments)};var i=a(r(52954)),n=a(r(70109)),s=a(r(35283));function o(){return(o=(0,i.default)((function*(){(yield Promise.allSettled([(0,n.default)(),s.default.clear()])).forEach((e=>{if("rejected"===e.status)throw e.reason}))}))).apply(this,arguments)}},88761:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.handle=function([e]){switch(e.type){case"const":o.default[e.key]=e.value;break;case"read":if(e.isStatus){f.default.handle([e]);break}case"unread":var t=n.default.get(e.jid);t&&("read"===e.type?(0,_.markSeen)(t):"unread"===e.type&&(0,_.markUnseen)(t));break;case"log":s.upload({reason:"server-requested",immediate:!0,force:!0,isHighPri:!0});break;case"privacy":if(e.jid){var r=c.default.get(e.jid);r&&r.reset(),p.default.update(e.jid).catchType(d.WebdDrop,(()=>{})),h.default.update(e.jid).catchType(d.WebdDrop,(()=>{}))}else __LOG__(3)`Store:Cmd:handle:privacy no jid`;break;case"identity":if(e.jid){var a=l.default.get(e.jid);a?(0,u.updateIdentity)(a,e):__LOG__(3)`Store:Cmd:handle:identity no contact`}else __LOG__(3)`Store:Cmd:handle:identity no jid`;break;default:__LOG__(3)`Store:Cmd:handle:unknown ${e.type}`}};var n=i(r(85030)),s=a(r(2537)),o=i(r(23045)),l=i(r(43805)),d=r(33576),u=r(77658),c=i(r(93997)),p=i(r(93562)),h=i(r(48514)),f=i(r(65677)),_=r(76710)},79435:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.Conn=t.PLATFORMS=void 0;var n=i(r(54073)),s=i(r(75652)),o=a(r(99778)),l=i(r(13277)),d=i(r(23045)),u=r(66239),c=i(r(20468)),p=i(r(33458)),h=i(r(38637)),f=r(81725),_=i(r(84161)),m=i(r(6370)),g={ANDROID:"android",BB:"bb",BBX:"bbx",IPAD:"ipad",IPHONE:"iphone",IPOD:"ipod",S40:"s40",SMBA:"smba",SMBI:"smbi",SYMBIAN:"symbian",WP7:"wp7"};t.PLATFORMS=g;class v extends o.default{constructor(...e){super(...e),this.id=(0,o.prop)(),this.ref=(0,o.prop)(),this.refTTL=(0,o.prop)(),this.refId=(0,o.prop)(),this.wid=(0,o.prop)(),this.connected=(0,o.prop)(),this.protoVersion=(0,o.prop)(),this.clientToken=(0,o.prop)(),this.serverToken=(0,o.prop)(),this.secret=(0,o.prop)(),this.isResponse=(0,o.prop)(),this.battery=(0,o.prop)(),this.plugged=(0,o.prop)(),this.lc=(0,o.prop)(),this.lg=(0,o.prop)(),this.locales=(0,o.prop)(),this.is24h=(0,o.prop)(),this.platform=(0,o.prop)(),this.phone=(0,o.prop)(),this.tos=(0,o.prop)(),this.smbTos=(0,o.prop)(0),this.pushname=(0,o.prop)(),this.blockStoreAdds=(0,o.session)(!1),this.isVoipInitialized=(0,o.session)(!1),this.refExpiry=(0,o.derived)(this._refExpiry,["ref","refTTL"]),this.locale=(0,o.derived)(this._locale,["lg","lc"]),this.localesList=(0,o.derived)(this._localesList,["locales","lg","lc"]),this.allLocales=(0,o.derived)(this._allLocales,["localesList"]),this.allLanguages=(0,o.derived)(this._allLanguages,["localesList"]),this.platformField=(0,o.derived)(this._platformField,["platform"]),this.tosShowCallNotification=(0,o.derived)(this._tosShowCallNotification,["tos"]),this.isSMB=(0,o.derived)(this._isSMB,["platform"])}_refExpiry(){return Date.now()+this.refTTL}_locale(){return this.formatLocale(this.lg,this.lc)}_localesList(){return this.locales&&this.locales.length?this.locales.split(",").map((e=>{var[t,r]=e.split("-");return t?[t,r]:null})).filter(Boolean):this.lg?[[this.lg,this.lc]]:[]}_allLocales(){return(0,s.default)(this.localesList.map((([e,t])=>this.formatLocale(e,t)))).filter(Boolean)}_allLanguages(){return(0,s.default)(this.localesList.map((([e,t])=>e)))}_platformField(){return"wp7"===this.platform?_.default.PLATFORM_TYPE.WP:this.platform&&_.default.PLATFORM_TYPE[this.platform.toUpperCase()]||_.default.PLATFORM_TYPE.UNKNOWN}_tosShowCallNotification(){return c.default.supportsFeature(c.default.F.MD_BACKEND)||this.tos<2}_isSMB(){return this.platform===g.SMBA||this.platform===g.SMBI}initialize(){o.default.prototype.initialize.call(this),this.listenTo(this,"change:locale",(function(e,t){h.default.setLocale(t,d.default.L10N_PRIORITY.PHONE)})),this.listenTo(this,"change:plugged",(0,n.default)((()=>{_.default.Global.webcPhoneCharging=this.plugged}),5e3,{leading:!0})),this.listenTo(this,"change:phone",(()=>{!function(e={}){var{mcc:t,mnc:r}=e;t&&"string"==typeof t&&(t=parseInt(t,10));r&&"string"==typeof r&&(r=parseInt(r,10));_.default.Global.set({mcc:null!=t?t:null,mnc:null!=r?r:null,webcPhoneDeviceManufacturer:e.device_manufacturer||null,webcPhoneDeviceModel:e.device_model||null,webcPhoneOsBuildNumber:e.os_build_number||null,webcPhoneOsVersion:e.os_version||null,webcPhoneAppVersion:e.wa_version||null})}(this.phone)})),this.listenTo(this,"me_ready",this.updateVoipAvailability),this.listenTo(c.default,c.default.FEATURE_CHANGE_EVENT,this.updateVoipAvailability),this.listenTo(this,"change:platform",this.handlePlatformChange),this.listenTo(l.default,"server_props_updated",this.updateVoipAvailability)}delete(){(0,u.setPushname)(),(0,u.setVersion)(),this.clear()}canSetMyPushname(){return!this.isSMB}updateVoipAvailability(){__LOG__(2)`Conn: updateVoipAvailability`,(0,f.requireVoip)().then((e=>{if(!m.default.isVoiceCallEnabled()&&!m.default.isVideoCallEnabled())return __LOG__(2)`Conn: updateVoipAvailability, Voip GK false`,e.cleanup(),void(this.isVoipInitialized=!1);this.id&&(0,u.getMaybeMeUser)()?(0,p.default)().then((t=>{t?(__LOG__(2)`Conn: updateVoipAvailability, isSystemCapableOfVoip true`,e.init().then((t=>{__LOG__(2)`Conn: updateVoipAvailability, Voip initialized`,this.isVoipInitialized=t,t&&e.updateAudioVideoSwitch()}))):(__LOG__(2)`Conn: updateVoipAvailability, isSystemCapableOfVoip false`,e.cleanup(),this.isVoipInitialized=!1)})):(__LOG__(2)`Conn: updateVoipAvailability, getMaybeMeUser undefined`,e.cleanup(),this.isVoipInitialized=!1)}))}handlePlatformChange(){__LOG__(2)`Conn: platform change: ${this.platform}`,this.platform&&(0,u.setLastMobilePlatform)(this.platform)}formatLocale(e,t){return e?t?e.toLowerCase()+"-"+t.toUpperCase():e.toLowerCase():null}shouldSaveToCache(){return!!(0,u.getMe)()&&!!this.id}}t.Conn=v,v.Proxy="conn";var E=new((0,o.defineModel)(v))({id:"1"});t.default=E},48605:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=new RegExp("[A-Za-z-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------]");t.default=r},69057:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(r(48605)),s=a(r(99778)),o=i(r(88025)),l=r(43816),d=i(r(79435)),u=i(r(23045)),c=r(61461),p=r(66239),h=r(9690),f=i(r(38637)),_=r(48522),m=i(r(75584)),g=i(r(93562)),v=r(54815),E=i(r(48514)),y=i(r(43926)),S=i(r(58025)),T=/^[^0-9]+$/;class A extends s.default{constructor(...e){super(...e),this.id=(0,s.prop)(),this.name=(0,s.prop)(),this.shortName=(0,s.prop)(),this.pushname=(0,s.prop)(),this.type=(0,s.prop)("in"),this.verifiedName=(0,s.prop)(),this.isBusiness=(0,s.prop)(),this.isEnterprise=(0,s.prop)(),this.verifiedLevel=(0,s.prop)(),this.privacyMode=(0,s.prop)(),this.statusMute=(0,s.prop)(),this.sectionHeader=(0,s.prop)(),this.labels=(0,s.prop)(),this.isContactBlocked=(0,s.session)(!1),this.verificationString=(0,s.session)(),this.verificationBinary=(0,s.session)(),this.pendingAction=(0,s.session)(),this.promises=(0,s.session)((()=>({}))),this.status=(0,s.session)(),this.profilePicThumb=(0,s.session)(),this.businessProfile=(0,s.session)(),this.commonGroups=(0,s.session)(),this.liveLocations=(0,s.session)(),this.businessCatalog=(0,s.session)(),this.locale=(0,s.session)(),this.notifyName=(0,s.derived)(this._notifyNameFunction,["pushname","isBusiness","verifiedLevel","verifiedName"]),this.mentionName=(0,s.derived)(this._mentionName,["isMyContact","isBusiness","verifiedLevel","name","notifyName"]),this.displayName=(0,s.derived)(this._displayName,["id","mentionName","isMe"]),this.userid=(0,s.derived)(this._userid),this.userhash=(0,s.derived)(this._userhash),this.searchName=(0,s.derived)(this._searchName,["name","id","locale"]),this.searchVerifiedName=(0,s.derived)(this._searchVerifiedName,["verifiedLevel","verifiedName"]),this.header=(0,s.derived)(this._header,["name"]),this.isMe=(0,s.derived)(this._isMe),this.isUser=(0,s.derived)(this._isUser),this.isGroup=(0,s.derived)(this._isGroup),this.isBroadcast=(0,s.derived)(this._isBroadcast),this.isPSA=(0,s.derived)(this._isPSA),this.formattedShortNameWithNonBreakingSpaces=(0,s.derived)(this._formattedShortNameWithNonBreakingSpaces,["shortName","formattedName","id","locale"]),this.formattedShortName=(0,s.derived)(this._formattedShortName,["shortName","formattedName","id","locale"]),this.formattedName=(0,s.derived)(this._formattedName,["name","id","locale","verifiedLevel","verifiedName"]),this.formattedUser=(0,s.derived)(this._formattedUser,["name","id","locale","verifiedLevel","verifiedName"]),this.isWAContact=(0,s.derived)(this._isWAContact,["type"]),this.isMyContact=(0,s.derived)(this._isMyContact,["name"]),this.showBusinessCheckmarkAsPrimary=(0,s.derived)(this._showBusinessCheckmarkAsPrimary,["isBusiness","verifiedLevel","name","verifiedName"]),this.showBusinessCheckmarkAsSecondary=(0,s.derived)(this._showBusinessCheckmarkAsSecondary,["isBusiness","verifiedLevel","name","verifiedName"])}_notifyNameFunction(){return this.isBusiness&&this.verifiedLevel!==u.default.VERIFIED_LEVEL.HIGH?this.verifiedName:this.pushname}_mentionName(){return!this.isMyContact&&this.isBusiness&&this.verifiedLevel!==u.default.VERIFIED_LEVEL.HIGH?null:this.name||this.notifyName}_displayName(){return this.isMe&&d.default.pushname?d.default.pushname:this.mentionName||(0,S.default)(this.id)}_userid(){return this.isUser?y.default.user(this.id):null}_userhash(){return this.isUser?(0,m.default)((this.id.user||"")+"WA_ADD_NOTIF"):null}_searchName(){return y.default.isPSA(this.id)?f.default.accentFold(f.default.t(1872)):this.name?f.default.accentFold(this.name):null}_searchVerifiedName(){return this.verifiedLevel!==u.default.VERIFIED_LEVEL.HIGH?null:this.verifiedName?f.default.accentFold(this.verifiedName):null}_header(){if(this.name){var e=this.name.toLowerCase(),t=n.default.exec(e);if(t&&0===t.index||t&&T.test(e.slice(t.index))){var r=t[0],a=f.default.removeAccents(r);return(0,c.getCollator)().compare(a,r)?r:a}return"#"}}_isMe(){return this.id.equals((0,p.getMaybeMeUser)())}_isUser(){return y.default.isUser(this.id)}_isGroup(){return y.default.isGroup(this.id)}_isBroadcast(){return y.default.isBroadcast(this.id)}_isPSA(){return y.default.isPSA(this.id)}_formattedShortNameWithNonBreakingSpaces(){return this.id?this.isMe?f.default.t(1861):this.shortName||this.formattedName&&this.formattedName.replace(/\s/g," "):""}_formattedShortName(){return this.id?this.isMe?f.default.t(1861):this.shortName||this.formattedName:""}_formattedName(){return this.id?this.isMe?f.default.t(1861):y.default.isPSA(this.id)?f.default.t(1872):this.name?this.name:this.verifiedLevel===u.default.VERIFIED_LEVEL.HIGH&&this.verifiedName?this.verifiedName:this.isUser?(0,S.default)(this.id):"":""}_formattedUser(){return this.getFormattedUser()}_isWAContact(){return this.isUser&&"in"===this.type}_isMyContact(){return!!(this.isUser&&this.name&&this.name.length)}_showBusinessCheckmarkAsPrimary(){return this.isBusiness&&this.verifiedLevel===u.default.VERIFIED_LEVEL.HIGH&&(this.name===this.verifiedName||!this.name)}_showBusinessCheckmarkAsSecondary(){return this.isBusiness&&this.verifiedLevel===u.default.VERIFIED_LEVEL.HIGH&&Boolean(this.name)&&this.name!==this.verifiedName}initialize(){super.initialize(),this.id&&(this.isMe&&this.addChild("status",E.default.gadd(this.id)),this.isMe&&this.addChild("profilePicThumb",g.default.gadd(this.id)),(this.isBusiness||this.isMe&&d.default.isSMB)&&this.addChild("businessProfile",r(65017).default.gadd(this.id)),this.listenTo(this,"change:isBusiness",(()=>(0,l.onIsBusinessChange)(this))),this.isMe&&this.listenTo(d.default,"change:pushname",(()=>{this.set({pushname:d.default.pushname})})),this.listenTo(f.default,"locale_change",(()=>{this.locale=f.default.getLocale()})),this.listenTo(this,"change:name",this.updateShortName),this.isContactBlocked=!!o.default.get(this.id),this.pendingAction=0,d.default.isSMB&&(0,_.initializeLabels)(this))}updateShortName(){if(this.isUser&&this.name&&!this.shortName){var e=(0,v.getShortName)(this.name);e&&this.set("shortName",e)}}getStatus(){return y.default.user(this.id)||__LOG__(2)`contact:getStatus for non-user ${this.id.toString()}`,this.status=E.default.gadd(this.id)}getProfilePicThumb(){return this.profilePicThumb=g.default.gadd(this.id)}addPendingAction(e){if(e.isPending()){var t=()=>{this.decPending()};e.then(t,t),this.pendingAction++}return e}decPending(){this.pendingAction>0?this.pendingAction--:(__LOG__(2)`contact:onPendingActionUpdate pendingAction value is invalid`,this.pendingAction=0)}isBlocked(){return!!o.default.get(this.id)}searchMatch(e,t,r){var a;return(0,h.canDisplayLabel)()&&r?!(e&&this.searchName&&!this.searchName.includes(e))&&Boolean(null===(a=this.labels)||void 0===a?void 0:a.includes(r)):!!e&&(!(!this.searchName||!this.searchName.includes(e))||(!(!this.userid||!this.userid.includes(e))||(!!(t&&this.userid&&this.userid.includes(t))||(!(!this.searchVerifiedName||!this.searchVerifiedName.includes(e))||!(!this.pushname||!f.default.accentFold(this.pushname).includes(e))))))}getFormattedUser(){return this.id?y.default.isPSA(this.id)?f.default.t(1872):this.name?this.name:this.verifiedLevel===u.default.VERIFIED_LEVEL.HIGH&&this.verifiedName?this.verifiedName:(0,S.default)(this.id):""}set(e,t,r){var a=super.set(e,t,r);if("string"!=typeof e&&t&&t.merge&&a){if(a.isPSA)return a;!e.name&&a.name&&(a.unset("name"),a.unset("shortName")),!e.verifiedName&&a.verifiedName&&a.unset("verifiedName")}return a}getCollection(){return r(43805).default}setNotMyContact(){this.name&&this.set("name",void 0)}}A.Proxy="contact",A.idClass=y.default;var b=(0,s.defineModel)(A);t.default=b},43805:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.ContactCollection=void 0;var n=i(r(54073)),s=a(r(18641)),o=r(62294),l=i(r(23045)),d=i(r(69057)),u=i(r(61461)),c=r(33576),p=r(68542),h=r(32128),f=r(66239),_=i(r(38637)),m=i(r(13520)),g=i(r(57568)),v=a(r(15934));class E extends s.default{constructor(){super(),this._contactHashes=new m.default,this.checksum=void 0,this._frequentContacts={},this._sort=(0,n.default)((()=>super.sort()),1e3),this._silentSort=(0,n.default)((()=>super.sort({silent:!0})),1e3),this.listenTo(_.default,"locale_change",this.sort),this.listenTo(this,"change:name",this.sort),this.listenTo(v.default,"change:stream",(()=>{v.default.stream===v.STREAM.RESUMING&&this.forEach((e=>{e.unset("verificationString"),e.unset("verificationBinary")}))})),this.listenTo(this,"add",this.contactAdded),this.listenTo(this,"remove",this.contactRemoved)}sort(e){return e&&e.silent?this._silentSort():this._sort()}ensureSorted(){this._sort.flush()}initializeFromCache(e){e&&(__LOG__(2)`Store:Contact init from cache`,this.add(e,{silent:!0,merge:!0}))}contactAdded(e){this._contactHashes.put(e)}contactRemoved(e){this._contactHashes.remove(e)}contactHashLength(){return this._contactHashes.length}delete(){super.delete(),this.setChecksum(),delete this.checksum,this._frequentContacts={},(0,h.setFrequent)({}).catch((()=>{})),this._contactHashes.clear()}isFilteredContact(e){return!!e.name&&!e.isMe&&!e.isPSA&&e.isWAContact}getFilteredContacts(){return this.filter((function(e){return e.name&&!e.isMe&&!e.isPSA&&e.isWAContact}))}_find(e){var t=this.get(e);return t?Promise.resolve(t):Promise.resolve({id:e})}_findQuery(e){return(0,p.contactFindQuery)(e)}sync(){return this.findQuery({}).catchType(c.WebdDrop,(()=>{})),(0,g.default)(this,l.default.COLLECTION_HAS_SYNCED)}updateFrequentContacts(e){this._frequentContacts=e}frequentContacts(e,t){var r=e&&this._frequentContacts[e];if(r||(r=this._frequentContacts.message),!r)return[];var a=t&&t.id;return r.map((e=>this.get(e))).filter((e=>!!e&&!e.id.equals(a)))}getUserCount(){return this.map((e=>e.isUser?1:0)).reduce(((e,t)=>e+t),0)}setChecksum(e){this.checksum=e,(0,f.setContactChecksum)(this.checksum),(0,o.setChecksum)(e).catch((()=>{}))}resolveWidsFromHash(e){return this._contactHashes.get(e)}}t.ContactCollection=E,E.model=d.default,E.comparator=u.default,E.cachePolicy={id:"contact",policy:s.CACHE_POLICY.IMMEDIATE,trigger:"add\n        sort\n        remove\n        reset\n        change:id\n        change:name\n        change:shortName\n        change:pushname\n        change:type\n        change:verifiedName\n        change:isBusiness\n        change:isEnterprise\n        change:verifiedLevel\n        change:statusMute\n        change:sectionHeader\n        change:isContactBlocked\n        change:labels"};var y=new E;t.default=y},61461:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.getCollator=function(){return i},t.default=void 0;var i,n=a(r(13277)),s=a(r(23045)),o=r(66239);l(),n.default.on("set_locale",l);function l(e=s.default.L10N.DEFAULT){if(self.Intl&&self.Intl.Collator){var t=self.Intl.Collator([e],{sensitivity:"base"});i={compare(e,r){try{return t.compare(e,r)}catch(e){return 0}}}}else i={compare:(e,t)=>e.localeCompare(t)}}var d=(e,t)=>{var r=e.id.toString(),a=t.id.toString(),n=(0,o.getMaybeMeUser)(),s=n&&n.toString();if(r===s)return 1;if(a===s)return-1;var l=e.name,d=t.name;if(!l&&d)return 1;if(l&&!d)return-1;if(l&&d&&e.header&&t.header){var u=i.compare(e.header,t.header);return 0===u?i.compare(l,d):u}return r&&a?r.localeCompare(a):-1};t.default=d},54815:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.getShortName=function(e){if(null==e)return null;var[t]=e.split(/\s/);if(i.default.exec(t))return t;return __LOG__(2)`[short-name] unable to get short name for contact: ${e}`,null};var i=a(r(48605))},13520:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(64116)),n=a(r(21830)),s=a(r(43926));class o{constructor(){this._map={},this.length=0}static getSidelistHash(e){return e.isUser?"string"==typeof e.userhash&&e.userhash.slice?e.userhash.slice(0,4):(__LOG__(3)`Store:Contact can't call slice on contact.userhash`,null):null}put(e){var t=o.getSidelistHash(e);if(t&&!this._map[t]){if(this._map[t]){var r=this._map[t];r instanceof s.default?this._map[t]=[r,e.id]:r instanceof Array&&r.push(e.id)}else this._map[t]=e.id;this.length++}}remove(e){var t=o.getSidelistHash(e);if(t&&this._map[t]){var r=(0,n.default)(this._map[t],"this._map[hash]");r instanceof s.default?delete this._map[t]:r instanceof Array&&(0,i.default)(r,(t=>t.equals(e.id))),this.length++}}get(e){var t=this._map[e];return t instanceof s.default?[t]:t}clear(){this._map={},this.length=0}}t.default=o},59205:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.ConversionTupleExpiry=t.default=void 0;var n=r(49244),s=i(r(84621)),o=a(r(99778)),l=i(r(99461)),d=i(r(43926)),u=604800;t.ConversionTupleExpiry=u;class c extends o.default{constructor(...e){super(...e),this.id=(0,o.prop)(),this.conversionData=(0,o.prop)(),this.conversionSource=(0,o.prop)(),this.timestamp=(0,o.prop)((()=>l.default.globalUnixTime())),this.alarmId=(0,o.session)()}initialize(){super.initialize(),this.listenTo(this,"change:timestamp",this._setExpiryTimer),this._setExpiryTimer()}_setExpiryTimer(){var e=this.timestamp+u;if(e<0)return __LOG__(3)`Invalid conversionTuple timer`,void this.delete();this.alarmId=s.default.setLocalTimeout((()=>{this.delete()}),1e3*e,this.alarmId)}_clearAlarm(){this.alarmId&&(s.default.clearTimeout(this.alarmId),this.alarmId=void 0)}elapsedSeconds(){return l.default.globalUnixTime()-this.timestamp}formatTuple(){var e={conversionDelaySeconds:this.elapsedSeconds()};return this.conversionData&&(e.conversionData=this.conversionData),this.conversionSource&&(e.conversionSource=this.conversionSource),e}toJSON(){var e=this.serialize(),t=e.conversionData;if(t instanceof ArrayBuffer){var r=new n.Binary(t);e.conversionData=r.readString(t.byteLength)}return e}delete(){super.delete(),this.getCollection().remove(this.id),this._clearAlarm()}getCollection(){return r(10346).default}}c.Proxy="conversionTuple",c.idClass=d.default;var p=(0,o.defineModel)(c);t.default=p},10346:(e,t,r)=>{"use strict";var a=r(14859),i=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(r(18641)),s=a(r(99461)),o=i(r(59205)),l=r(21988);class d extends n.default{initializeFromCache(e){if(e){var t=s.default.globalUnixTime()-o.ConversionTupleExpiry,r=e.filter((e=>e.timestamp-t>0)).map((e=>{var t=(0,l.parseConversionData)(e.conversionData);return t?e.conversionData=t:delete e.conversionData,e}));this.add(r),this.saveToCache()}}}d.model=o.default,d.cachePolicy={id:"conversion_tuple",policy:n.CACHE_POLICY.LOAD,delay:1e3};var u=new d;t.default=u},51155:(e,t,r)=>{"use strict";var a=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(99778));class n extends i.default{constructor(...e){super(...e),this.id=(0,i.prop)(),this.weight=(0,i.prop)()}}n.Proxy="recentEmoji";var s=(0,i.defineModel)(n);t.default=s},25150:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.RecentEmojiCollection=void 0;var n=i(r(12436)),s=i(r(54073)),o=a(r(18641)),l=i(r(31615)),d=r(33576),u=i(r(20468)),c=i(r(51155)),p=r(61864),h=i(r(94407));class f extends o.default{constructor(){super(),this.dirty=!1,this._throttledSync=(0,n.default)((function(e){e.sync()}),36,{leading:!1}),this.listenTo(this,"change:weight change:length",(0,s.default)(this._sortTrimScale,100))}_sortTrimScale(){var e=this.length;e&&(this.sort(),e>36&&this.remove(this.models.slice(36)))}delete(){super.delete(),this.dirty=!1,this._throttledSync.cancel()}sync(){return this.findQuery({},{set:!0}).finally((()=>{this.dirty=!1})).catchType(d.WebdDrop,(()=>{})).catchConditional(p.isString,(()=>{}))}_findQuery(){return u.default.supportsFeature(u.default.F.RECENT_EMOJI_SYNC)&&!u.default.supportsFeature(u.default.F.MD_BACKEND)?h.default.recentEmojiQuery(this.dirty?this.toArray():void 0).then((function(e){return Array.isArray(e)?(e.forEach((function(e){e.id=l.default.normalizeAllEmojis(e.id)})),Promise.resolve(e)):(__LOG__(3)`models:recentEmoji:findQuery error`,Promise.reject("recent emoji fetch error"))})):Promise.reject("gk recent emoji sync unsupported")}throttledSync(){u.default.supportsFeature(u.default.F.RECENT_EMOJI_SYNC)&&(__LOG__(2)`models:RecentEmoji:throttledSync dirty: ${String(this.dirty)}`,this._throttledSync(this))}increment(e){var t=l.default.getSkinToneBase(e)||e;this.get(t)||this.add({id:t,weight:0}),this.forEach((e=>{e.id===t?e.weight+=1:e.weight*=.9})),this.dirty=!0,this.throttledSync()}}t.RecentEmojiCollection=f,f.cachePolicy={id:"recent_emoji_collection",policy:o.CACHE_POLICY.LOAD,delay:2e3},f.comparator=(e,t)=>e.weight>t.weight?-1:1,f.model=c.default;var _=new f;t.default=_},27512:(e,t,r)=>{"use strict";var a=r(14859),i=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(r(99778)),s=a(r(23045)),o=a(r(43805)),l=r(33576),d=r(66239),u=a(r(20468)),c=a(r(92719)),p=a(r(21061)),h=a(r(94407)),f=a(r(43926));class _ extends n.default{constructor(...e){super(...e),this.participants=(0,n.collection)(c.default),this.pendingParticipants=(0,n.collection)(p.default),this.id=(0,n.prop)(),this.creation=(0,n.prop)(),this.owner=(0,n.prop)(),this.desc=(0,n.prop)(),this.descId=(0,n.prop)(),this.descTime=(0,n.prop)(),this.descOwner=(0,n.prop)(),this.restrict=(0,n.prop)(),this.announce=(0,n.prop)(),this.noFrequentlyForwarded=(0,n.prop)(),this.ephemeralDuration=(0,n.prop)(),this.size=(0,n.prop)(),this.support=(0,n.prop)(),this.stale=(0,n.session)(!0),this.trusted=(0,n.session)(!0),this.inviteCode=(0,n.session)(),this.groupInviteCodePromise=(0,n.session)(),this.revokeGroupInvitePromise=(0,n.session)(),this.revokeGroupV4AddInvitePromise=(0,n.session)(),this.groupInviteLink=(0,n.derived)(this._groupInviteLink,["inviteCode"])}_groupInviteLink(){return this.inviteCode?`${s.default.GROUP_INVITE_LINK_URL}${this.inviteCode}`:null}delete(){super.delete(),this.getCollection().remove(this.id),this.participants.delete()}canSetSubject(){return!!this.participants.iAmMember()&&((this.participants.iAmAdmin()||!u.default.supportsFeature(u.default.F.GROUPS_V_3)||!0!==this.restrict)&&!this.support)}canSetDescription(){return!!u.default.supportsFeature(u.default.F.GROUPS_V_3)&&(!(!this.participants.iAmMember()||!this.participants.iAmAdmin()&&this.restrict)&&!this.support)}canSetGroupProperty(){return!!u.default.supportsFeature(u.default.F.GROUPS_V_3)&&(!!this.participants.iAmAdmin()&&!this.support)}canSetEphemeralSetting(){return u.default.isEphemeralAllowGroupMembersEnabled()?!(!this.participants.iAmMember()||!this.participants.iAmAdmin()&&this.restrict)&&!this.support:this.participants.iAmAdmin()&&!this.support}initialize(){n.default.prototype.initialize.call(this),this.listenTo(this.participants,"change:isAdmin change:isSuperAdmin change:contact.isMyContact sort remove reset",this.isTrusted),this.listenTo(this.participants,"add remove reset",this.triggerParticipantsChange),this.listenTo(this,"change:owner",this.isTrusted),this.isTrusted()}triggerParticipantsChange(){this.trigger("change:participants")}isTrusted(){if(this.stale)return this.trusted;if(!this.owner)return this.trusted=!1;if(this.support)return this.trusted=!0;var e=(0,d.getMaybeMeUser)();if(f.default.equals(this.owner,e))return this.trusted=!0;if(this.owner){var t=o.default.get(this.owner);if(t&&t.isMyContact)return this.trusted=!0}return this.trusted=!1}revokeGroupV4AddInvite(e){if(this.revokeGroupV4AddInvitePromise)return this.revokeGroupV4AddInvitePromise;var t=this.id.toString(),r=(0,d.getMaybeMeUser)().toString(),{pendingParticipants:a}=this;return this.revokeGroupV4AddInvitePromise=h.default.revokeGroupV4Invite(e,t,r).then((t=>(t.status>=200&&t.status<300&&a.remove(e),t.status))).catch((()=>{__LOG__(3)`models:groupMetadata:participantCollection:revokeGroupV4AddInvite failed`})).finally((()=>{this.revokeGroupV4AddInvitePromise=null}))}queryGroupV4PendingInvite(){if(u.default.supportsFeature(u.default.F.MD_BACKEND))return Promise.resolve();var e=(0,d.getMaybeMeUser)().toString(),t=this.id.toString();return h.default.findGroupPendingInvitesFromPhone(e,t).then((e=>{this.collection&&this.collection.add({id:this.id,pendingParticipants:e.participants},{merge:!0})})).catchType(l.WebdDrop,(()=>{}))}getCollection(){return r(25120).default}}_.Proxy="groupMetadata",_.idClass=f.default;var m=(0,n.defineModel)(_);t.default=m},25120:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(r(26139)),s=i(r(18641)),o=i(r(85030)),l=r(33576),d=a(r(24461)),u=i(r(20468)),c=r(7284),p=i(r(27512)),h=r(97825),f=r(12390),_=i(r(94407)),m=i(r(43926)),g=r(25054);class v extends s.default{onResume(){(0,n.default)(o.default.where({active:!0}).filter((e=>e.isGroup||e.isBroadcast)),o.default.where({isBroadcast:!0})).forEach((e=>{this.find(e.id).catchTypes(l.WebdDrop,d.ProtoVersionUndefined,(()=>{}))}))}_find(e){if(m.default.isGroup(e)){var t=r(85030).default.get(e);return t&&t.isReadOnly?u.default.supportsFeature(u.default.F.MD_BACKEND)?(__LOG__(3)`queryGroupFromPhone: not implemented for MD`,Promise.resolve({id:e})):(0,h.queryGroupFromPhone)(e):(0,c.getGroupMetadataFromStorage)(e).then((t=>t?Promise.resolve(t):(0,f.sendQueryGroup)(e)))}return m.default.isBroadcast(e)?u.default.supportsFeature(u.default.F.MD_BACKEND)?(__LOG__(3)`contactFindBroadcast: not implemented for MD`,Promise.resolve({id:e})):_.default.contactFindBroadcast(e).then((t=>{if(200===t.status){var r=this.get(e);return r&&!r.stale?Promise.resolve(r):{id:e,participants:t.recipients}}return 404===t.status?(__LOG__(3)`models:GroupMetadataCollection:_find:False broadcast list query`,{id:e}):(__LOG__(3)`models:GroupMetadataCollection:_find:bclist error: ${t.status}`,Promise.reject(new Error("models:GroupMetadataCollection:_find:bclist error: "+t.status)))})):(__LOG__(2)`groupMetadata:find trying to fetch non-group/bclist wid ${e.toString()}`,Promise.reject(new Error(`groupMetadata:find trying to fetch non-group/bclist wid ${e.toString()}`)))}_handle(e){return e}handlePendingInvite(e){var{gid:t,participants:r}=e;this.add({id:(0,g.createWid)(t),pendingParticipants:r},{merge:!0})}}v.model=p.default,v.staleCollection=!0;var E=new v;t.default=E},88255:(e,t,r)=>{"use strict";var a=r(14859),i=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(r(99778)),s=a(r(43805)),o=a(r(43926));class l extends n.default{constructor(...e){super(...e),this.id=(0,n.prop)(),this.isAdmin=(0,n.prop)(),this.isSuperAdmin=(0,n.prop)(),this.contact=(0,n.session)(),this.hasSenderKey=(0,n.session)(!1)}initialize(){super.initialize(),this.addChild("contact",s.default.gadd(this.id))}}l.Proxy="participant",l.idClass=o.default;var d=(0,n.defineModel)(l);t.default=d},92719:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(54073)),n=a(r(85030)),s=a(r(21981)),o=r(81216),l=r(66239),d=a(r(20468)),u=a(r(38637)),c=a(r(88255)),p=a(r(55426));class h extends s.default{constructor(e,t={}){super(e,t),this._debouncedSort=(0,i.default)((()=>this.sort()),1e3),this.sendForNeededAddRequest=e=>{var t=this.parent.id,r=n.default.assertGet(t),a=r.groupMetadata.desc;(0,o.sendForNeededAddRequest)(e,r.formattedTitle||r.name,a,this.parent.id)},this.listenTo(this,"change:contact.name",this._debouncedSort),this.listenTo(u.default,"locale_change",this._debouncedSort)}delete(){this.forEach((function(e){e.delete()})),this.stopListening(),this.reset()}ensureSorted(){this._debouncedSort.flush()}set(e,t){var r=t||{};return r.isParticipantCollectionAdd||(r.remove=!0),super.set(e,r)}add(e,t){var r=t||{};return r.isParticipantCollectionAdd=!0,super.add(e,r)}canAdd(){return!!this.iAmAdmin()}canPromote(e){return!!e&&(!(0,l.getMaybeMeUser)().equals(e.id)&&(!!this.iAmAdmin()&&!e.isAdmin))}canDemote(e){return!!e&&(!!this.iAmAdmin()&&(!(0,l.getMaybeMeUser)().equals(e.id)&&(!(d.default.supportsFeature(d.default.F.GROUPS_V_3)&&e.isSuperAdmin)&&!!e.isAdmin)))}canRemove(e){return!!e&&(!(0,l.getMaybeMeUser)().equals(e.id)&&!!this.iAmAdmin())}canVerifyIdentity(e){return!!d.default.supportsFeature(d.default.F.QUERY_IDENTITY)&&(!!e&&!(0,l.getMaybeMeUser)().equals(e.id))}iAmMember(){return 1===this.filter((e=>e.id.equals((0,l.getMaybeMeUser)()))).length}iAmRestrictedMember(){var e=this.parent.id;return n.default.assertGet(e).groupMetadata.restrict&&!this.iAmAdmin()}iAmAdmin(){return 1===this.filter((e=>e.id.equals((0,l.getMaybeMeUser)())&&e.isAdmin)).length}iAmSuperAdmin(){return 1===this.filter((e=>e.id.equals((0,l.getMaybeMeUser)())&&e.isSuperAdmin)).length}getAdmins(){return this.where({isAdmin:!0})}getSuperAdmin(){return this.findFirst((e=>e.isSuperAdmin))}}t.default=h,h.model=c.default,h.comparator=p.default},55426:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(61461)),n=(e,t)=>(0,i.default)(e.contact,t.contact);t.default=n},21061:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(54073)),n=a(r(21981)),s=a(r(38637)),o=a(r(88255)),l=a(r(55426));class d extends n.default{constructor(e,t={}){super(e,t),this._debouncedSort=(0,i.default)((()=>this.sort()),1e3),this.listenTo(this,"change:contact.name",this._debouncedSort),this.listenTo(s.default,"locale_change",this._debouncedSort)}delete(){this.forEach((function(e){e.delete()})),this.stopListening(),this.reset()}ensureSorted(){this._debouncedSort.flush()}set(e,t={}){return t.isParticipantCollectionAdd||(t.remove=!0),super.set(e,t)}add(e,t={}){return t.isParticipantCollectionAdd=!0,super.add(e,t)}}t.default=d,d.model=o.default,d.comparator=l.default},6420:(e,t,r)=>{"use strict";var a=r(14859),i=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.intColorToHex=p,t.default=void 0;var n=i(r(99778)),s=i(r(79435)),o=a(r(23045)),l=a(r(20468)),d=a(r(90895)),u=r(70319);class c extends n.default{constructor(...e){super(...e),this.id=(0,n.prop)(),this.name=(0,n.prop)(),this.colorIndex=(0,n.prop)(),this.color=(0,n.prop)(),this.count=(0,n.prop)(),this.stale=(0,n.session)(!0),this.hexColor=(0,n.derived)(this._hexColor,["color","colorIndex"])}initialize(){super.initialize(),this.labelItemCollection=new d.default,this._triggerLabelUpdate(),this.listenTo(this,"change:name",this._triggerLabelUpdate),this.listenTo(this,"change:color",this._triggerLabelUpdate),this.listenTo(this,"change:colorIndex",this._triggerLabelUpdate),this.listenTo(this,"change:count",this._triggerLabelUpdate),l.default.supportsFeature(l.default.F.MD_BACKEND)&&(this.listenTo(this.labelItemCollection,"add",this._handleLabelItemCollectionUpdate),this.listenTo(this.labelItemCollection,"remove",this._handleLabelItemCollectionUpdate))}_hexColor(){if(l.default.supportsFeature(l.default.F.MD_BACKEND)){var e=this.colorIndex;if(null==e)return;return s.default.platform===s.PLATFORMS.SMBI?o.default.IPHONE_LABEL_COLOR_PALETTE[e]:o.default.ANDROID_LABEL_COLOR_PALETTE[e]}if(this.color)return p(this.color)}_find(e){return Promise.resolve({id:e})}_triggerLabelUpdate(){this.name&&r(62345).default.trigger(`label_updated_${this.id}`)}_handleLabelItemCollectionUpdate(){var e=this.labelItemCollection.filter((e=>e.parentType!==u.LabelItemParentType.Contact)).length;this.count=String(e)}}function p(e){return`#${(parseInt(e,10)>>>0).toString(16).slice(-6)}`}c.Proxy="label";var h=(0,n.defineModel)(c);t.default=h},62345:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.LabelCollection=t.LABEL_PROPERTIES=void 0;var n=i(r(64116)),s=r(60266),o=r(13275),l=a(r(2784)),d=r(8507),u=i(r(18641)),c=i(r(13277)),p=i(r(79435)),h=i(r(24098)),f=r(33576),_=a(r(24461)),m=r(66239),g=i(r(38637)),v=i(r(6420)),E=r(30380),y=r(70319),S=r(48522),T=i(r(84161)),A=a(r(56179)),b=i(r(57568)),C=i(r(94407)),P=i(r(15934)),O=r(81249),w=i(r(20468)),M=Object.freeze({NAME:"name",COLOR:"color"});t.LABEL_PROPERTIES=M;var I=Object.freeze({UPDATING:"updating",SUCCEEDED:"succeeded",FAILED:"failed"});class R extends u.default{constructor(){super(),this.checksum=void 0,this.listenTo(this,"remove",this.handleRemove)}initializeAssociationsFromCache(e){e.forEach((({labelId:e,associationId:t,type:r})=>{(0,S.addToLabelCollection)(t,[e],r===O.LabelAssociationType.Jid?y.LabelItemParentType.Chat:y.LabelItemParentType.Msg)}))}addNewLabel(e,t){(0,E.logLabelOperationEvent)(T.default.LABEL_OPERATIONS.ADD,1,T.default.LABEL_TARGETS.LABEL);var r=C.default.createLabel(e,t),a=new d.ActionType(g.default.t(40,{labelName:e})),i=(0,d.genId)(),n=r.then((({status:t})=>200===t?new d.ActionType(g.default.t(158,{labelName:e})):new d.ActionType(g.default.t(157,{labelName:e})))).catch((()=>(__LOG__(3)`addingNewLabel dropped`,new d.ActionType(g.default.t(157,{labelName:e})))));return c.default.openToast(l.createElement(d.ActionToast,{id:i,initialAction:a,pendingAction:n})),r}removeAllLabelsMD(e){return this.addOrRemoveLabelsMD((e.labels||[]).map((e=>({type:"remove",id:e}))),[e])}addOrRemoveLabelsMD(e,t){w.default.supportsFeature(w.default.F.MD_BACKEND)&&e.forEach((({id:e,type:r})=>{t.forEach((t=>{var a=(0,S.getParentTypeFromModel)(t),i=t.id.toString();"add"===r?(0,S.addToLabelCollection)(i,[e],a):(0,S.removeLabelFromCollection)(i,e,a)}))}))}addOrRemoveLabels(e,t){var r=(0,d.genId)(),a=new d.ActionType(g.default.t(37,{count:e.length,_plural:e.length})),i=(0,h.default)(e,t).then((()=>{this.addOrRemoveLabelsMD(e,t)})).then((()=>new d.ActionType(g.default.t(39,{count:e.length,_plural:e.length})))).catch((()=>(__LOG__(3)`addingNewLabel dropped`,new d.ActionType(g.default.t(38)))));c.default.openToast(l.createElement(d.ActionToast,{id:r,initialAction:a,pendingAction:i}))}deleteLabel(e){(0,E.logLabelOperationEvent)(T.default.LABEL_OPERATIONS.DELETE,1,T.default.LABEL_TARGETS.LABEL);var t=C.default.deleteLabel(e),r=this.get(e);if(r){var{name:a}=r,i=new d.ActionType(g.default.t(92,{labelName:a})),n=(0,d.genId)(),s=t.then((({status:e})=>200===e?new d.ActionType(g.default.t(91,{labelName:a})):new d.ActionType(g.default.t(90,{labelName:a})))).catch((()=>(__LOG__(3)`addingNewLabel dropped`,new d.ActionType(g.default.t(90,{labelName:a})))));return c.default.openToast(l.createElement(d.ActionToast,{id:n,initialAction:i,pendingAction:s})),t}__LOG__(2)`deleteLabel - label does not exist`}_getActionLabelUpdateString(e,t){switch(e){case M.NAME:return t===I.UPDATING?g.default.t(131):t===I.SUCCEEDED?g.default.t(133):g.default.t(132);case M.COLOR:return t===I.UPDATING?g.default.t(128):t===I.SUCCEEDED?g.default.t(130):g.default.t(129)}return""}updateLabel(e,t){(0,E.logLabelOperationEvent)(T.default.LABEL_OPERATIONS.EDIT,1,T.default.LABEL_TARGETS.LABEL);var r=C.default.editLabel(e.id,e.name,e.color),a=new d.ActionType(this._getActionLabelUpdateString(t,I.UPDATING)),i=(0,d.genId)(),n=r.then((({status:e})=>200===e?new d.ActionType(this._getActionLabelUpdateString(t,I.SUCCEEDED)):new d.ActionType(this._getActionLabelUpdateString(t,I.FAILED)))).catch((()=>(__LOG__(3)`updatingLabel dropped`,new d.ActionType(this._getActionLabelUpdateString(t,I.FAILED)))));return c.default.openToast(l.createElement(d.ActionToast,{id:i,initialAction:a,pendingAction:n})),r}getNewLabelColor(){return C.default.queryNextLabelColor().then((e=>e.labelColors[0].color)).catch((()=>{}))}getLabelColorPalette(){return this.labelColorPalette=this.labelColorPalette||(0,m.getSmbLabelPalette)(),this.labelColorPalette&&this.labelColorPalette.waVersion===p.default.phone.wa_version?Promise.resolve(this.labelColorPalette.colors):this._getColorPaletteLoop().then((e=>{var t=e.labelColors.map((({color:e})=>e));return(0,m.setSmbLabelPalette)({colors:t,waVersion:p.default.phone.wa_version}),t})).catch((()=>{}))}_getColorPaletteLoop(){return(0,o.promiseLoop)(((e,t,r)=>{var a=(0,s.delayMs)(A.expBackoff(r,12e4,1e3,.1));return("CONNECTED"===P.default.stream?Promise.resolve():(0,b.default)(P.default,"change:stream",(()=>"CONNECTED"===P.default.stream))).then((()=>C.default.queryLabelPalette().then((t=>{e(t)})))).catchConditional((e=>!(e instanceof Promise.CancellationError)),(e=>r>3||404===e?(__LOG__(3)`labels:loadLabelPalette:error ${String(e)}`,404===e?Promise.reject(new f.E404):Promise.reject(new _.GaveUpRetry(`Gave up loading label palette ${r} tries`))):a))}),0)}handleRemove(e){var{labelItemCollection:t}=e;t.toArray().forEach((e=>{var{parentId:t,parentType:r,labelId:a}=e,i=(0,S.getParentCollection)(r).get(t);i&&(i.labels=(0,n.default)(i.labels,(e=>e!==a)))}))}onResume(){this.filter((e=>e.hasObservers())).forEach((e=>{this.find(e.id).catchType(f.WebdDrop,(()=>{}))}))}delete(){super.delete(),delete this.checksum}sync(e){if(!e||this.checksum!==e)return this.findQuery({}).catchTypes(f.WebdDrop,_.ProtoVersionUndefined,(()=>{}))}handle(e){var t;if(e.checksum&&this.updateChecksum(e.checksum),e.labels&&e.labels[0]&&e.labels[0].labelUpdates)return e.labels[0].labelUpdates.forEach((e=>{e.collection.forEach((r=>{r!==y.LabelItemParentType.Msg&&r!==y.LabelItemParentType.Chat||(t=!0);var a=e.id,i=(0,S.getParentCollection)(r).get(e.id);i&&(i.labels&&i.labels.forEach((t=>{e.labels.includes(t)||(0,S.removeLabelFromCollection)(a,t,r)})),i.labels=e.labels)}))})),void(t&&this.trigger("bulk_msg_chat_label_change"));var r=[],a=[];e.labels.forEach((e=>{"delete"===e.type?r.push(e.label):a.push(e.label)})),this.remove(r.map((({id:e})=>e))),this.add(a,{merge:!0})}_findQuery(){return C.default.queryLabels().then((e=>(e.checksum&&this.updateChecksum(e.checksum),e.labels)))}_find(){return this._findQuery()}updateChecksum(e){this.checksum=e}getLabelsForModel(e,t){return this.filter((r=>r.labelItemCollection.get((0,S.createLabelItemId)(e,r.id,t)))).map((e=>e.id))}}t.LabelCollection=R,R.model=v.default,R.staleCollection=!0,R.resumeOnAvailable=!0;var D=new R;t.default=D},38041:(e,t,r)=>{"use strict";var a=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(99778));r(70319);class n extends i.default{constructor(...e){super(...e),this.id=(0,i.prop)(),this.parentType=(0,i.prop)(),this.parentId=(0,i.prop)(),this.labelId=(0,i.prop)()}}n.Proxy="labelItem";var s=(0,i.defineModel)(n);t.default=s},90895:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.LabelItemCollection=void 0;var i=a(r(67304)),n=a(r(18641)),s=a(r(20468)),o=a(r(38041)),l=r(48522);class d extends n.default{constructor(){super(),s.default.supportsFeature(s.default.F.MD_BACKEND)&&(this.listenTo(this,"add",this._handleAdd),this.listenTo(this,"remove",this._handleRemove))}_handleAdd(e){this._handleChange(e,!0)}_handleRemove(e){this._handleChange(e,!1)}_handleChange(e,t){var r=(0,l.getParentCollection)(e.parentType).get(e.parentId);if(r){var a=r.labels||[];t?a.includes(e.labelId)||(r.labels=[e.labelId].concat(a)):r.labels=(0,i.default)(a,e.labelId)}}}t.LabelItemCollection=d,d.model=o.default;var u=d;t.default=u},18641:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"CACHE_POLICY",{enumerable:!0,get:function(){return d.CACHE_POLICY_TYPE}}),t.default=void 0;var n=i(r(70417)),s=i(r(74930)),o=i(r(60417)),l=i(r(92070)),d=r(75200),u=i(r(21981)),c=i(r(79435)),p=r(33576),h=a(r(24461)),f=r(66239),_=i(r(96377)),m=r(61864),g=a(r(15934)),v="QUERY",E="FIND",y="UPDATE",S=(new Object).toString(),T={id:"none",policy:d.CACHE_POLICY_TYPE.NONE};class A extends u.default{constructor(){super(),this._inflight={},this._cachePolicy=(0,d.createCachePolicy)(this,this.constructor.cachePolicy||T),this._staleCollection=this.constructor.staleCollection||!1,this._resumeOnAvailable=this.constructor.resumeOnAvailable||!1,(!0===this._staleCollection||(0,m.isFunction)(this.onResume))&&(this.listenTo(g.default,"change:stream",this._handleStreamChange),this.listenTo(g.default,"didResume",this._onResume),this._resumeOnAvailable&&this.listenTo(_.default,"change:available",(()=>{_.default.available&&this._needsUpdate&&this._onResume()}))),this._cachePolicy.enableCaching(),this._cachePolicy.constructor.policy===d.CACHE_POLICY_TYPE.LOAD&&this.listenTo(c.default,"me_ready",this._updateFromCache)}initializeFromCache(e){this.add(e)}saveToCache(){if(c.default.shouldSaveToCache()){var{id:e}=this._cachePolicy;__LOG__(2)`baseCollection:saveToCache save: ${String(e)}`,(0,f.setCollection)(e,this.toJSON(),this._cachePolicy.constructor.policy===d.CACHE_POLICY_TYPE.IMMEDIATE)}}add(e,t){if(e){if(c.default.blockStoreAdds)throw new p.LogoutDrop("adding to store when blocking store adds");var r=Array.isArray(e)?e:[e];if(r.every((e=>e&&e.isState))){var a=(0,l.default)(r,(e=>this.get(e.id)));return a.length&&super.add(a,t),r}}return super.add(e,t)}findQuery(e,t){return this._query(v,e,t)}find(e,t){return e?this._query(E,e,t):(__LOG__(4,void 0,new Error,!0)`Called find without an id`,SEND_LOGS("find-without-id"),Promise.reject("called find without an id"))}update(e,t){return e?this._query(y,e,t):(__LOG__(4,void 0,new Error,!0)`Called update without an id`,SEND_LOGS("update-without-id"),Promise.reject("called update without an id"))}handle(e){var t=this._handle(e.shift());if(this._staleCollection){var r=Array.isArray(t)?t:[t];(0,o.default)(r).forEach((e=>{e.stale=!1}))}this.add(t,{merge:!0})}gadd(e,t){if(this.modelClass.prototype.isIdType(e)){var r=this.get(e);return r||this.add({id:e},t)[0]}if(e&&e.id){var a=t||{};return a.merge=!0,this.add(e,a)[0]}throw new Error("gadd called without an id attr (id)")}gaddUp(e){var t,r=this._staleCollection;if(this.modelClass.prototype.isIdType(e)){var a={stale:r,id:e};t=this.get(e)||this.add(a,{merge:!0})[0]}else e&&e.id&&(this.get(e.id)&&(r=!1),e=(0,n.default)({stale:r},e),t=this.add(e,{merge:!0})[0]);if(t){var i=t;return t.stale&&this.find(t.id).catchType(p.WebdDrop,(()=>{})),i}throw new Error(".gaddUp called without an id attr (id)")}delete(){this._inflight={},this.reset()}isStateStale(e){var t=this.get(e);return!!t&&t.stale}_handleResume(){switch(g.default.stream){case g.STREAM.DISCONNECTED:if(!this._staleCollection)return;this.forEach((e=>{e&&(e.stale=!0)}));break;case g.STREAM.RESUMING:case g.STREAM.SYNCING:case g.STREAM.CONNECTED:}}_onResume(){(0,m.isFunction)(this.onResume)&&(this._resumeOnAvailable&&!_.default.available?this._needsUpdate=!0:(this.onResume(),this._needsUpdate=!1))}_query(e,t,r){var a=(0,m.isString)(t)?t:t.toString();a===S&&(a=(0,s.default)("collection_query_"));var i=e===v?void 0:this.get(t),n="force-"+a;return(this._inflight[n]&&e===E||e===y)&&(a=n),this._inflight[a]?e===E&&i&&!i.stale?Promise.resolve(i):this._inflight[a]:!i||i&&i.stale||e===y?this._inflight[a]=this._serverQuery(e,t,r).finally((()=>{delete this._inflight[a]})).catchType(p.LogoutDrop,(e=>{__LOG__(3)`LogoutDrop error: ${e.toString()}`})).catchConditional(m.isString,(function(e){__LOG__(2)`baseCollection:query query promise rejected: ${String(e)}`})).catchType(p.WebdDrop,(function(e){throw __LOG__(3)`WebdDrop error: ${e.toString()}`,e})):Promise.resolve(i)}_serverQuery(e,t,r){var a;if(e===y)a=this._update(t);else if(e===E)a=this._find(t);else{var i=r&&r.logOnSend;a=this._findQuery(t,i)}return a.then((e=>{if(this._staleCollection){var t=Array.isArray(e)?e:[e];(0,o.default)(t).forEach((function(e){void 0===e.stale&&(e.stale=!1)}))}var a;if(a=r&&r.set?this.set(e):this.add(e,{merge:!0}),Array.isArray(e))return a;if(a[0])return a[0];throw new h.ModelCreateError("Unknown",e)}))}_update(e){return this._find(e)}_handleStreamChange(){this._handleResume(),this._cachePolicy.constructor.policy===d.CACHE_POLICY_TYPE.LOAD&&this._updateFromCache()}_updateFromCache(){var{id:e}=this._cachePolicy;this._cachePolicy.disableCaching(),c.default.shouldSaveToCache()&&(__LOG__(2)`baseCollection:initFromCache load: ${String(e)}`,this.initializeFromCache((0,f.getCollection)(e)),this._cachePolicy.enableCaching())}}t.default=A},66180:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.genMirrorMask=function(e){var t={},r=0,a=e=>{t[`change:${e}`]=r++};e.props&&Object.keys(e.props).forEach(a);e.session&&Object.keys(e.session).forEach(a);e.derived&&Object.keys(e.derived).forEach(a);return t},t.genBitMask=function(e,t){for(var r=[],a=0;a<t.length;a++){var i=e[`change:${t[a]}`],n=Math.floor(i/32);s(r,n+1),r[n]|=1<<i%32}return r},t.default=void 0;var i=a(r(8555));function n(e,t){e[t]=e[e.length-1],e.pop()}function s(e,t){if(!(t<=e.length))for(var r=t-e.length,a=0;a<r;a++)e.push(0)}t.default=class{constructor(e){this.state=e}destructor(){this.state.off("all",this.onGatherEvent,this)}initListener(){this.state.on("all",this.onGatherEvent,this),this.masks=[],this.listeners=[],this.changeEvents=[]}onGatherEvent(e){if("change"===e){if(!this.changeEvents.filter(Boolean).length)return;this.onChange(),this.changeEvents=[]}else{var t=this.state.mirrorMask[e];if(void 0===t)return;var r=t/32|0;s(this.changeEvents,r+1),this.changeEvents[r]|=1<<(t%32|0)}}onChange(){var e=this.state,t=this.changeEvents;(0,i.default)(this.masks,this.listeners).forEach((([r,a])=>{for(var i=Math.min(t.length,r.length),n=0;n<i;n++)if(t[n]&r[n]){var[s,o]=a;null!=s&&null!=o&&s(o,e);break}}))}addListener(e,t,r){this.listeners||this.initListener(),this.masks.push(t),this.listeners.push([e,r])}removeListener(e){for(var t=this.listeners,r=0;r<t.length;r++)t[r][0]===e&&(t[r][0]=null,t[r][1]=null,n(this.masks,r),n(t,r))}}},99778:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.defineModel=function(e){var t=(0,f.convert)(e),r=(0,f.stateExtend)(v,t);if(e.Proxy){var a=(0,u.genMirrorMask)(t);r.prototype.mirrorMask=a,r.prototype.proxyName=e.Proxy,(0,_.default)(e.Proxy,t,a)}return r},Object.defineProperty(t,"prop",{enumerable:!0,get:function(){return f.prop}}),Object.defineProperty(t,"session",{enumerable:!0,get:function(){return f.session}}),Object.defineProperty(t,"derived",{enumerable:!0,get:function(){return f.derived}}),Object.defineProperty(t,"collection",{enumerable:!0,get:function(){return f.collection}}),t.default=void 0;var n=i(r(70417)),s=i(r(46150)),o=i(r(15253)),l=i(r(84336)),d=i(r(99686)),u=a(r(66180)),c=i(r(13277)),p=r(33576),h=i(r(71107)),f=r(70524),_=i(r(4651)),m=r(61864),g=/^change:/;class v extends h.default{constructor(e,t={}){if(super(),this.stale=(0,f.session)(!1),this.__fired=null,this.__changes=null,this.__initialized=!1,!t._internalInitializationDoNotUse){this.stale=e&&e.stale||this.getDefault("stale"),this.parent=t.parent,this.collection=t.collection,this._initDeriveds(),this._initCollections();var r=this.__defaults,a=r?(0,n.default)((0,n.default)({},r),e):e;a&&!function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}(a)&&this.set(a,(0,n.default)({silent:!0},t)),this.initialize(),this.__initialized=!0}}initialize(){if(this.collection&&this.id&&!this.collection.modelClass.prototype.isIdType(this.id))throw new Error(`Model id:${String(this.id)} is wrong type`);this._uiObservers=0,this.mirrorMask&&(this.mirror=new u.default(this))}_refreshStaleModel(){if(this._uiObservers||!this.stale){if(!this.getCollection)throw new Error("base_model:_refreshStaleModel getCollection does not exist");this.getCollection().find(this.id).catch(p.WebdDrop,(()=>{}))}}incObservers(e){(this._uiObservers++,e)||r(66622).default.online&&this.stale&&(c.default.uiBusy?this.listenToOnce(c.default,"ui_idle",this._refreshStaleModel):this._refreshStaleModel())}decObservers(){this._uiObservers>0&&this._uiObservers--,0===this._uiObservers&&this.stopListening(c.default,"ui_idle",this._refreshStaleModel)}hasObservers(){return this._uiObservers>0}addChild(e,t){var r={};r[e]=t,this.set(r,{silent:!0}),this.listenTo(t,"all",this._getCachedEventBubblingHandler(e))}get(e){return this[e]}set(e,t,r){var a=r;return"string"==typeof e?this._set(e,t,a):(a=t)&&a.merge?this._set((0,d.default)(e,l.default),a):this._set(e,a)}_markChange(e){this.__initialized&&(this._getChanges().push(e),this.__fired&&(this.__fired[e]=!1))}_set(e,t,r){for(var a=this,i=!!this.__changes,[n,s]=(0,m.isString)(e)?[{[e]:t},r]:[e,t],o=Object.keys(n).reduce(((e,t)=>{var r=this._setKV(t,n[t],s);return r&&e.push(...r),e}),[]),l=0,d=function(){if(l++>5)throw new Error("Circular derived properties / event listeners");var e=a._topo;if(!e)throw new Error("_topo unexpectedly undefined");var t,r,i=(t=e,r=new Set(o),t.filter((e=>r.has(e))));o=i.reduce(((e,t,r)=>{var n=a._setD(t,i.slice(r+1));return n&&e.push(...n),e}),[])};o&&o.length>0;)d();if(!(s&&s.silent)&&this.hasUnfiredChanges()){for(var u=this.__fired={},c=this._getChanges(),p=c.length;c.length;){var h=c.shift();if(!u[h]){u[h]=!0;var f=this._definition[h].evt;(this.isListening(f)||this.isListening("all"))&&this.trigger(f,this,this[h])}}(p&&this.isListening("change")||this.isListening("all"))&&this.trigger("change",this)}return i||(this.__changes&&(this.__changes=null),this.__fired&&(this.__fired=null)),this}_setKV(e,t,r){if(this._collections[e])this[e].set(t,r);else{var a=this._definition[e];if(a){if(a.attr===f.Attr.DERIVED)throw new Error(`Attempting to directly set derived property: ${e}`);var i=a.sk;if(t!==this[e]){this[i]=t,this._markChange(e);var n=this._deps;return n&&n[e]?n[e]:void 0}}else this[e]=t}}_setD(e,t){var r,a,i=this._definition[e],n=i.sk,s=i.fn.call(this);if(this[n]!==s&&(this[n]=s,this._markChange(e),this._deps&&this._deps[e])){var o=(r=this._deps[e],a=new Set(t),r.filter((e=>!a.has(e))));if(o.length)return o}}hasUnfiredChanges(){var e=this.__fired,t=this.__changes;if(!t)return!1;if(!e)return!0;for(var r=0;r<t.length;r++)if(!e[t[r]])return!0;return!1}_getChanges(){return this.__changes||(this.__changes=[])}_initDeriveds(){this.__derived.forEach((e=>{this[this._definition[e].sk]=f.INIT}))}_initCollections(){(0,o.default)(this._collections,((e,t)=>{this[t]=new e(null,{parent:this})}))}unset(e,t){var r=Array.isArray(e)?e:[e];this.set((0,s.default)(r),t)}clear(){this.unset([...this.__props,...this.__session])}delete(){this.stopListening()}reset(){this.set(this.__defaults)}toJSON(){return this.serialize()}serialize(){for(var e={},t=0;t<this.__props.length;t++)e[this.__props[t]]=this[this.__props[t]];return(0,o.default)(this._collections,((t,r)=>{e[r]=this[r].serialize()})),e}getDefault(e){var t=this._definition[e];if(t){var r=t.default;return(0,m.isFunction)(r)?r():r}}_getCachedEventBubblingHandler(e){return function(t,r,a){g.test(t)?this.trigger("change:"+e+"."+t.split(":")[1],r,a):"change"===t&&this.trigger("change",this)}.bind(this)}static isIdType(e){return!(!this.allowedIds||!this.allowedIds.includes(e))||(this.idClass?e instanceof this.idClass:"string"==typeof e)}}t.default=v},58805:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.CACHE_POLICY_TYPE=void 0;var i=a(r(71107)),n={LOAD:"LOAD",IMMEDIATE:"IMMEDIATE",NONE:"NONE"};t.CACHE_POLICY_TYPE=n;class s extends i.default{constructor(e,t){super(),this._collection=e,this._id=t}enableCaching(){}disableCaching(){}get collection(){return this._collection}get id(){return this._id}}t.default=s,s.policy=n.NONE},61901:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(r(54073)),s=a(r(58805)),o=i(r(20468));class l extends s.default{constructor(e,t){super(e,t.id),this._trigger=t.trigger||"all",this._saveToCache=(0,n.default)(this.saveToCache,0)}saveToCache(){o.default.supportsFeature(o.default.F.MD_BACKEND)}enableCaching(){this.listenTo(this.collection,this._trigger,this._saveToCache)}disableCaching(){this.stopListening(this.collection,this._trigger,this._saveToCache)}}t.default=l,l.policy=s.CACHE_POLICY_TYPE.IMMEDIATE},75200:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.createCachePolicy=function(e,t){switch(t.policy){case"LOAD":return new s.default(e,t);case"IMMEDIATE":return new n.default(e,t);case"NONE":return new o.default(e,t)}return new o.default(e,{id:"none",policy:"NONE"})},Object.defineProperty(t,"CACHE_POLICY_TYPE",{enumerable:!0,get:function(){return i.CACHE_POLICY_TYPE}});var i=r(58805),n=a(r(61901)),s=a(r(49903)),o=a(r(61347))},49903:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(r(54073)),s=a(r(58805));class o extends s.default{constructor(e,t){super(e,t.id),this._trigger=t.trigger||"all",this._delay=t.delay,this._saveToCache=(0,n.default)(this.saveToCache,this._delay)}saveToCache(){this.collection.saveToCache()}enableCaching(){this.listenTo(this.collection,this._trigger,this._saveToCache)}disableCaching(){this.stopListening(this.collection,this._trigger,this._saveToCache)}}t.default=o,o.policy=s.CACHE_POLICY_TYPE.LOAD},61347:(e,t,r)=>{"use strict";var a=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(58805));class n extends i.default{constructor(e,t){super(e,t.id)}}t.default=n,n.policy=i.CACHE_POLICY_TYPE.NONE},21981:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(70417)),n=r(73580),s=a(r(71107));class o extends s.default{constructor(e,t={}){super(),t.parent&&(this.parent=t.parent);var{model:r,comparator:a}=this.constructor;if(!r)throw new Error("Collection initialized without model!");this.modelClass=r,a&&(this._comparator=a),this._reset()}add(e,t){var r;return r=Array.isArray(e)?e.slice():e?[e]:[],this.set(r,(0,i.default)({merge:!1,add:!0,remove:!1},t))}set(e,t){if(!e)return __LOG__(3)`collection:set called with no models`,[];for(var r,a,n,s,o,l=(0,i.default)({add:!0,remove:!0,merge:!0},t),d=this._comparator&&!1!==l.sort,u=[],c=[],p={},{add:h,merge:f,remove:_}=l,m=null!=l.at?l.at:void 0,g=!(d||!h||!_)&&[],v=0,E=e.length;v<E;v++)if(s=e[v],this.isModel(s)&&(a=s),r=s.id){if(n=this.get(r)){var y=n;_&&(p[n.id.toString()]=!0),f&&(s=a&&s===a?a.attributes:s,y.set(s,l)),e[v]=y}else if(h){if(!(a=e[v]=this._prepareModel(s,l)))continue;var S=a;u.push(S),this._addReference(S)}if(a=n||a){var T=a;!g||a.id&&p[a.id.toString()]||g.push(T),p[T.id.toString()]=!0}}else __LOG__(3)`collection:set model has no id`;if(_){for(var A=0,b=this.length;A<b;A++){var C=a=this._models[A];p[a.id.toString()]||c.push(C)}c.length&&this.remove(c,(0,i.default)({},l))}if(u.length||g&&g.length)if(d&&(o=!0),"number"==typeof m)this._models.splice(m,0,...u);else for(var P=g||u,O=0,w=P.length;O<w;O++)this._models.push(P[O]);if(o&&this.sort({silent:!0}),!l.silent){for(var M=0,I=u.length;M<I;M++)(a=u[M]).trigger?a.trigger("add",a,this,l):this.trigger("add",a,this,l);(o||g&&g.length)&&this.trigger("sort",this,l)}return e}remove(e,t={}){for(var r,a,i,n,s=Array.isArray(e)?e.slice():[e],o=[],l=0,d=s.length;l<d;l++)if((n=s[l])&&(i=n instanceof this.modelClass?n.id:n,r=o[l]=this.get(i))){var u=r;this._deIndex(r),a=this._models.indexOf(r),this._models.splice(a,1),t.silent||(t.index=a,u.trigger?u.trigger("remove",r,this,t):this.trigger("remove",r,this,t)),this._removeReference(u)}return o}reset(){for(var e=0,t=this._models.length;e<t;e++)this._removeReference(this._models[e]);this._reset(),this.trigger("reset",this)}sort(e={}){if(!this._comparator)throw new Error("Cannot sort without comparator");return this._models.sort(this._comparator.bind(this)),e.silent||this.trigger("sort",this,e),this}replaceId(e,t){var r=this.get(e);r&&(this._removeFromIndex(e),r.set({id:t}),this._addIndex(r))}reorderMutate(e,t){(0,n.arrayMoveMutate)(this._models,e,t)}get(e){return this._index[e]}assertGet(e){var t=this._index[e];return t||(__LOG__(4,void 0,new Error,!0)`Assertion failed!`,SEND_LOGS("Collection:assertGet no result")),t}at(e){return this._models[e]}get length(){return this._models.length}get isCollection(){return!0}get models(){return this._models}serialize(){return this.map((e=>e.toJSON()))}toJSON(){return this.serialize()}isModel(e){return e instanceof this.modelClass}includes(e,t=0){return 0===t?e instanceof this.modelClass&&null!=this.get(e.id):this._models.includes(e,t)}indexOf(e,t){return this._models.indexOf(e,t)}lastIndexOf(e,t){return this._models.lastIndexOf(e,t)}every(e){return this._models.every(e)}some(e){return this._models.some(e)}forEach(e){this._models.forEach(e)}map(e){return this._models.map(e)}filter(e){return this._models.filter(e)}findFirst(e){return this._models.find(e)}reduce(e,t){return this._models.reduce(e,t)}slice(e,t){return this._models.slice(e,t)}where(e){return this.filter((t=>{for(var r in e)if(e[r]!==t.get(r))return!1;return!0}))}head(){return this._models[0]}last(){return this._models[this._models.length-1]}toArray(){return this._models.slice()}getModelsArray(){return this._models}reorder(e,t){return(0,n.arrayMove)(this._models,e,t)}_reset(){this._models=[],this._index={}}_prepareModel(e,t){if(this.isModel(e))return e.collection||(e.collection=this),e;var r=(0,i.default)((0,i.default)({},t),{},{collection:this});try{return new this.modelClass(e,r)}catch(e){return void __LOG__(3)`collection:_prepareModel exception: ${e.stack}`}}_addReference(e){this._addIndex(e),e.collection||(e.collection=this),e.on&&e.on("all",this._onModelEvent,this)}_removeReference(e){this===e.collection&&delete e.collection,this._deIndex(e),e.off&&e.off("all",this._onModelEvent,this)}_addIndex(e){this._index[e.id]=e}_deIndex(e){delete this._index[e.id]}_removeFromIndex(e){this.get(e)&&delete this._index[e]}_onModelEvent(e,t,r,a){var i=e.indexOf(":"),n=-1===i?e:e.slice(0,i);("add"!==n&&"remove"!==n||r===this)&&("destroy"===n&&this.remove(t,a),this.trigger.apply(this,arguments))}}t.default=o},70524:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.prop=function(e=h){return{default:e,type:f}},t.session=function(e=h){return{default:e,type:_}},t.derived=function(e,t){return{fn:e,deps:t,type:m}},t.collection=function(e){return{val:e,type:g}},t.convert=function(e){var t=new e({},{_internalInitializationDoNotUse:!0}),r={name:e.name||"Unknown",props:{},session:{},derived:{},collections:{},isIdType:e.isIdType};e.Collection&&(r.Collection=e.Collection);e.idClass&&(r.idClass=e.idClass);e.allowedIds&&(r.allowedIds=e.allowedIds);var a=new Set(["constructor"]),i=new Set(["collection","parent","__changes","__fired","__initialized"]);(function(e){var t=[];for(var r in e)"function"!=typeof e[r]&&t.push([r,e[r]]);return t})(t).forEach((([t,n])=>{if(!i.has(t))switch(n.type){case f:r.props[t]=v(n);break;case _:r.session[t]=v(n);break;case m:r.derived[t]=(0,s.default)(n,"type"),a.add(n.fn.name);break;case g:r.collections[t]=n.val;break;default:throw new Error(`Invalid defineModel Class type for ${e.name}:${t}.`)}}));var n=function(e){var t={},r=Object.getPrototypeOf({}),a=e;Object.getOwnPropertyNames(a).forEach((e=>{"function"==typeof a[e]&&(t[e]=a[e])}));for(;(a=Object.getPrototypeOf(a))&&a!==r;)Object.getOwnPropertyNames(a).forEach((e=>{e in t||(t[e]=a[e])}));return t}(t);return a.forEach((e=>{delete n[e]})),Object.assign(r,n),r},t.stateExtend=function(e,t){var r=(0,d.default)(t.name,"protoDef.name");delete t.name;var a=function(e,t){return{[t]:class extends e{}}[t]}(e,r),o=a.prototype,u=o.__props=[],h=o.__session=[],f=o.__derived=[],_=o._collections={},m=o._definition={},g=o._derived={};(0,n.default)(t.props,(function(e,t){u.push(t),y(o,t,e,p.PROP)})),(0,n.default)(t.session,(function(e,t){h.push(t),y(o,t,e,p.SESSION)})),(0,n.default)(t.derived,(function(e,t){f.push(t),function(e,t,r){var a=E(t),i=r.fn;e._definition[t]=e._derived[t]={sk:a,evt:"change:"+t,attr:p.DERIVED,fn:i,deps:r.deps},Object.defineProperty(e,t,{get(){var e=this[a];if(e!==c)return e;var t=i.call(this);return this[a]=t,t},set(){throw new TypeError(`'${t}' is a derived property, it can't be set directly.`)}})}(o,t,e)})),(0,n.default)(t.collections,(function(e,t){_[t]=e})),Object.assign(o,(0,s.default)(t,["props","session","derived","collections"]));var v=u.concat(h),S=v.length;Object.defineProperties(o,{attributes:{get(){for(var e={},t=0;t<S;++t)e[v[t]]=this[v[t]];return e}},isState:{get:()=>!0,set(){throw new Error("attempt to set isState")}}});for(var T={},A=0;A<S;A++){var b=v[A];"default"in m[b]&&(T[b]=c)}(0,i.default)(T)||(o.__defaults=T);if(f.length){var C=[],P={},O={};(0,n.default)(g,((e,t)=>{O[t]=!0,(0,n.default)(e.deps,(e=>{O[e]=!0,(P[e]||(P[e]=[])).push(t),C.push([t,e])}))})),C.length&&(o._deps=P,o._topo=l.default.array(Object.keys(O),C).reverse())}return a},t.NO_DEFAULT_VALUE=t.Attr=t.INIT=void 0;var i=a(r(45455)),n=a(r(15253)),s=a(r(17620)),o=a(r(29259)),l=a(r(95159)),d=a(r(21830)),u=r(61864),c={sentinel:"DEFAULT VALUE PLACEHOLDER"};t.INIT=c;var p={PROP:"PROP",SESSION:"SESSION",DERIVED:"DERIVED"};t.Attr=p;var h=Symbol("NO_DEFAULT_VALUE");t.NO_DEFAULT_VALUE=h;var f="Props",_="Session",m="Derived",g="Collection";function v(e){var t=e.default;return t===h?{}:{default:t}}function E(e){return"__x_"+e}function y(e,t,r,a){if(!(0,o.default)(r))throw new Error("Invalid Prop/Session definition.");var i={sk:E(t),evt:`change:${t}`,attr:a};void 0!==r.default&&(i.default=r.default),e._definition[t]=i;var n=(0,u.isFunction)(i.default);if(null!=i.default&&!n){if(Array.isArray(i.default))throw new Error("Do not return mutable types as default values as they are shared. Type: Array provided.");if((0,o.default)(i.default))throw new Error("Do not return mutable types as default values as they are shared. Type: $FlowFixMeObjectType provided.")}var s=i.sk;Object.defineProperty(e,t,{set(e){this.set(t,e)},get(){var e=this[s];return e!==c?e:n?this[s]=i.default():i.default}})}},4651:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.ProxyStates=void 0;var i=a(r(22220)),n={};t.ProxyStates=n;t.default=(e,t,r)=>{var{props:a,session:s,collections:o,derived:l}=t,d=(0,i.default)(t,["props","session","collections","derived"]);function u(e){this.$ProxyState$state=e}var c={};[a,s,o,l].forEach((e=>{e&&Object.keys(e).forEach((e=>{c[e]={get(){return __LOG__(4,void 0,new Error,!0)`Cannot read proxy property "${e}" created in <${this.$ProxyState$ComponentName}/>. Make sure it is in your list of concerns.`,SEND_LOGS("Invalid ProxyState Access"),this.$ProxyState$state[e]},set(t){__LOG__(4,void 0,new Error,!0)`Cannot write proxy property "${e}" created in <${this.$ProxyState$ComponentName}/>. Make sure it is in your list of concerns.`,SEND_LOGS("Invalid ProxyState Write"),this.$ProxyState$state[e]=t}}}))})),c.proxyName={value:e},c.mirrorMask={value:r},c.isProxyOf={value(e){return this.$ProxyState$state===e}},["set","get",...Object.keys(d)].forEach((e=>{c[e]={value(){var t=this.$ProxyState$state;return t[e].apply(t,arguments)}}})),u.prototype=Object.create(null,c),u.prototype.constructor=u,n[e]=u}},32825:(e,t,r)=>{"use strict";var a=r(14859),i=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(r(2784)),s=r(8507),o=i(r(99778)),l=a(r(85030)),d=a(r(13277)),u=r(33576),c=i(r(24461)),p=r(66239),h=a(r(38637)),f=a(r(75497)),_=a(r(94407)),m=a(r(43926));class g extends o.default{constructor(...e){super(...e),this.id=(0,o.prop)(),this.duration=(0,o.prop)(),this.participants=(0,o.collection)(f.default),this.active=(0,o.session)(!1),this.keepAliveTimer=(0,o.session)(),this.stopPromise=(0,o.session)()}initialize(){super.initialize(),this.listenTo(this.participants,"remove reset",(()=>{this.hasParticipants()||this.delete()}));var e=l.default.get(this.id);e&&!e.liveLocation&&(e.liveLocation=this)}delete(){super.delete(),this.stopViewingMap(),this.participants.delete(),this.getCollection().remove(this.id);var e=l.default.get(this.id);e&&(e.liveLocation=void 0)}hasParticipants(){return this.participants.length>0}startViewingMap(){this.active||(this.active=!0,this._updateLiveLocations(),this._startKeepAlive())}stopViewingMap(){this.active&&(this.active=!1,this._pauseLiveLocations(),this._stopKeepAlive())}userHasLiveLocation(e){return!!this.participants.get(e)}iHaveLiveLocation(){return this.userHasLiveLocation((0,p.getMaybeMeUser)())}stopMyLiveLocation(e){if(!this.iHaveLiveLocation())return Promise.reject(new c.ActionError);if(this.stopPromise)return this.stopPromise;var t=this.stopPromise=_.default.disableLiveLocation(this.id),r=new s.ActionType(h.default.t(138)),a=e||(0,s.genId)(),i=t.then((e=>200===e.status?new s.ActionType(h.default.t(137)):e.status>=400?new s.ActionType(h.default.t(134)):void 0)).catch((()=>(__LOG__(3)`models:liveLocation:disableLiveLocation dropped`,new s.ActionType(h.default.t(134),{actionText:h.default.t(199),actionHandler:this.stopMyLiveLocation.bind(this,a)}))));return d.default.openToast(n.createElement(s.ActionToast,{id:a,initialAction:r,pendingAction:i})),t.then((e=>{if(200===e.status&&!e._duplicate){var t=this.participants.get((0,p.getMaybeMeUser)());t&&t.disable()}})).finally((()=>{this.stopPromise=null}))}_updateLiveLocations(){this.getCollection().update(this.id).catch((()=>{}))}_pauseLiveLocations(){_.default.unsubscribeLiveLocation(this.id).catchType(u.WebdDrop,(()=>{}))}_sendKeepAlive(){_.default.subscribeLiveLocation(this.id,!1).catchType(u.WebdDrop,(()=>{}))}_startKeepAlive(){if(null==this.keepAliveTimer){var e=this.duration;null!=e&&0!==e&&(this.keepAliveTimer=window.setInterval(this._sendKeepAlive.bind(this),1e3*e))}}_stopKeepAlive(){null!=this.keepAliveTimer&&(window.clearInterval(this.keepAliveTimer),this.keepAliveTimer=null)}getCollection(){return r(36839).default}}g.Proxy="liveLocation",g.idClass=m.default;var v=(0,o.defineModel)(g);t.default=v},36839:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.LiveLocationCollection=void 0;var i=a(r(70417)),n=a(r(18641)),s=a(r(99461)),o=a(r(23045)),l=a(r(43805)),d=r(33576),u=a(r(32825)),c=r(61864),p=a(r(94407)),h=a(r(43926));class f extends n.default{_find(e){return h.default.isUser(e)||h.default.isGroup(e)?p.default.subscribeLiveLocation(e,!0).then((t=>{if(t.status&&t.status>=400)return 499===t.status?__LOG__(2)`liveLocation:subscribe query not implemented on the phone`:__LOG__(3)`model:LiveLocation:_find error ${t.status}`,Promise.reject(t.status);var r=(0,c.isNumber)(t.duration)?t.duration:void 0,a=t.participants?t.participants.map((e=>(0,i.default)((0,i.default)({},this._extractLocationFields(e)),{},{id:e.id,expiration:0===e.expiration?1/0:e.expiration}))):[];return{id:e,duration:r,participants:a}})):Promise.reject(new Error("invalid wid for live location: "+e))}getActive(e){return h.default.isUser(e)||h.default.isGroup(e)?p.default.queryActiveLiveLocation(e).then((t=>{if(t.status&&t.status>=400)return 499===t.status?__LOG__(2)`liveLocation:participant query not implemented on the phone`:__LOG__(3)`model:LiveLocation:getActive error ${t.status}`,Promise.reject(t.status);if(t.participants&&t.participants.length){var r=t.participants.map((e=>({id:e.id,expiration:0===e.expiration?1/0:e.expiration})));this.add({id:e,participants:r},{merge:!0})}})).catchType(d.WebdDrop,(()=>{})):Promise.reject(new Error("invalid wid for live location: "+e))}onResume(){this.filter((e=>e.active&&e.hasParticipants())).forEach((e=>{this.update(e.id)}))}handle(e){Array.isArray(e)?e.forEach((e=>{switch(e.type){case"update":var t=this._extractLocationFields(e),r=l.default.get(e.jid);r&&r.liveLocations&&r.liveLocations.forEach((e=>e.set(t)));break;case"disable":var a=this.get(e.chat);if(a){var i=a.participants.get(e.jid);i&&(e.seq>i.sequence||-1===e.seq)&&i.disable()}break;default:__LOG__(3)`models:liveLocation:handle unknown type: ${e.type}`}})):__LOG__(3)`models:liveLocation:handle unrecognized payload`}processMsg(e,t=!1){e.type===o.default.MSG_TYPE.LOCATION&&e.isLive||(__LOG__(4,void 0,new Error,!0)`Assertion failed!`,SEND_LOGS("collection:liveLocation trying to process non live-location msg"));var r=e.id.remote,{lat:a,lng:i,accuracy:n,speed:l,degrees:d,sequence:u,comment:c,shareDuration:p,t:h}=e;if(h&&p){var f=h+p;if(!(f<=s.default.globalUnixTime())){var _={id:e.sender,lat:a,lng:i,accuracy:n,speed:l,degrees:d,sequence:u,comment:c,expiration:f,lastUpdated:h,msg:e};-1===u&&delete _.sequence;var m=this.get(r);if(m){var g=m.participants.get(_.id);if(t)return void(g&&g.lastUpdated<=_.lastUpdated&&g.set(_));if(g&&m.participants.removeParticipant(g),m.hasParticipants())return void m.participants.add(_)}this.add({id:r,participants:[_]})}}}removeMsg(e){e.type===o.default.MSG_TYPE.LOCATION&&e.isLive||(__LOG__(4,void 0,new Error,!0)`Assertion failed!`,SEND_LOGS("collection:liveLocation trying to remove non live-location msg"));var t=e.id.remote,r=e.sender,a=this.get(t);a&&a.participants.remove(r)}_extractLocationFields(e){return void 0===e.lat||void 0===e.lng?{}:{lastUpdated:s.default.globalUnixTime()-e.elapsed,lat:e.lat,lng:e.lng,accuracy:e.accuracy,speed:e.speed,degrees:e.degrees,comment:e.comment}}}t.LiveLocationCollection=f,f.model=u.default,f.staleCollection=!0,f.resumeOnAvailable=!0;var _=new f;t.default=_},23936:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(r(84621)),s=a(r(99778)),o=i(r(99461)),l=i(r(43805)),d=r(66239),u=r(50140),c=r(61864),p=i(r(43926));class h extends s.default{constructor(...e){super(...e),this.id=(0,s.prop)(),this.msg=(0,s.prop)(),this.lat=(0,s.prop)(),this.lng=(0,s.prop)(),this.accuracy=(0,s.prop)(),this.speed=(0,s.prop)(),this.degrees=(0,s.prop)(),this.sequence=(0,s.prop)(),this.comment=(0,s.prop)(),this.expiration=(0,s.prop)(),this.lastUpdated=(0,s.prop)(),this.contact=(0,s.session)(),this.expireTimerId=(0,s.session)(),this.disabled=(0,s.session)(!1),this.isMe=(0,s.derived)(this._isMe,["id"]),this.valid=(0,s.derived)(this._valid,["lat","lng"])}_isMe(){return this.id.equals((0,d.getMaybeMeUser)())}_valid(){return t=this.lat,(0,c.isNumber)(t)&&t>=-90&&t<=90&&(e=this.lng,(0,c.isNumber)(e)&&e>=-180&&e<=180);var e,t}initialize(){super.initialize(),this.addChild("contact",l.default.gadd(this.id)),(0,u.addLiveLocation)(this.contact,this),this.listenTo(this,"change:expiration",this._setExpireTimer),this._setExpireTimer()}delete(){super.delete(),this._disableMsg(),(0,u.removeLiveLocation)(this.contact,this),this._clearExpireTimer()}remainingTime(){return this.expiration-o.default.globalUnixTime()}elapsedTime(){return o.default.globalUnixTime()-this.lastUpdated}disable(){this.disabled=!0}_disableMsg(){var e=this.msg;e&&(e.shareDuration=o.default.globalUnixTime()-e.t-1)}_setExpireTimer(){this.expiration&&(this.remainingTime()<=0?this._expire():this.expireTimerId=n.default.setGlobalTimeout(this._expire.bind(this),1e3*this.expiration,this.expireTimerId))}_clearExpireTimer(){n.default.clearTimeout(this.expireTimerId),this.expireTimerId=null}_expire(){this.disable()}}h.Proxy="liveLocationParticipant",h.idClass=p.default;var f=(0,s.defineModel)(h);t.default=f},75497:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(18641)),n=a(r(61461)),s=r(66239),o=a(r(23936));class l extends i.default{constructor(){super(),this.listenTo(this,"change:disabled",(e=>{e.disabled&&this.removeParticipant(e)}))}delete(){this.forEach((e=>this.removeParticipant(e)))}validLocations(){return this.filter((e=>e.valid))}removeParticipant(e){this.remove(e),e.delete()}}t.default=l,l.model=o.default,l.comparator=(e,t)=>{var r=(0,s.getMaybeMeUser)();return e.contact.id.equals(r)?-1:t.contact.id.equals(r)?1:(0,n.default)(e.contact,t.contact)}},34443:(e,t,r)=>{"use strict";var a=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(99778));class n extends i.default{constructor(...e){super(...e),this.isFocused=(0,i.session)(!0)}initialize(){super.initialize(),this._onFocus=this._onFocus.bind(this),this._onBlur=this._onBlur.bind(this)}delete(){super.delete()}_onFocus(){this.isFocused=!0}_onBlur(){this.isFocused=!1}}n.Proxy="mainWindowState";var s=new((0,i.defineModel)(n));t.default=s},36169:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.createProductInquiry=function(e,t,r,a){var i=function(e){return new Q(e)}({ack:g.default.ACK.CLOCK,id:new L.default({id:"product_inquiry",remote:t,fromMe:!0}),from:t,t:f.default.globalUnixTime(),type:z.PRODUCT,title:e.name,description:e.description,businessOwnerJid:t.toString({legacy:!0}),productId:e.id.toString(),url:e.url,productImageCount:e.productImageCollection.length,body:r.preview&&r.preview._b64,currencyCode:e.currency,priceAmount1000:e.priceAmount1000,salePriceAmount1000:e.salePriceAmount1000,sessionId:a});return i.mediaData.set(r),i},t.default=t.TYPE=void 0;var n=i(r(52954)),s=i(r(17620)),o=i(r(84636)),l=i(r(45455)),d=i(r(36585)),u=r(19129),c=a(r(57643)),p=a(r(99778)),h=r(51322),f=i(r(99461)),_=i(r(13277)),m=i(r(79435)),g=i(r(23045)),v=i(r(43805)),E=r(99429),y=i(r(31615)),S=r(93572),T=i(r(33013)),A=r(66239),b=r(74739),C=i(r(20468)),P=i(r(38637)),O=r(48522),w=r(14784),M=a(r(63428)),I=a(r(27305)),R=i(r(86619)),D=r(60301),N=i(r(84161)),L=i(r(83746)),k=a(r(68439)),U=r(26779),G=i(r(21830)),F=r(75096),x=r(87471),B=i(r(54559)),Y=r(61864),K=r(89874),j=r(26495),W=r(65999),H=r(5916),V=i(r(57568)),$=i(r(43926)),q=i(r(58025)),{MSG_TYPE:z}=g.default;t.TYPE=z;class J extends p.default{constructor(...e){super(...e),this.id=(0,p.prop)(),this.body=(0,p.prop)(),this.type=(0,p.prop)(),this.subtype=(0,p.prop)(),this.t=(0,p.prop)(),this.notifyName=(0,p.prop)(),this.from=(0,p.prop)(),this.to=(0,p.prop)(),this.author=(0,p.prop)(),this.self=(0,p.prop)("in"),this.ack=(0,p.prop)(),this.invis=(0,p.prop)(),this.isNewMsg=(0,p.prop)(),this.star=(0,p.prop)(!1),this.recvFresh=(0,p.prop)(),this.caption=(0,p.prop)(),this.interactiveAnnotations=(0,p.prop)(),this.clientUrl=(0,p.prop)(),this.loc=(0,p.prop)(),this.lat=(0,p.prop)(),this.lng=(0,p.prop)(),this.isLive=(0,p.prop)(),this.accuracy=(0,p.prop)(),this.speed=(0,p.prop)(),this.degrees=(0,p.prop)(),this.comment=(0,p.prop)(),this.sequence=(0,p.prop)(),this.shareDuration=(0,p.prop)(),this.finalLat=(0,p.prop)(),this.finalLng=(0,p.prop)(),this.finalAccuracy=(0,p.prop)(),this.finalThumbnail=(0,p.prop)(),this.finalSpeed=(0,p.prop)(),this.finalDegrees=(0,p.prop)(),this.finalTimeOffset=(0,p.prop)(),this.deprecatedMms3Url=(0,p.prop)(),this.directPath=(0,p.prop)(),this.mimetype=(0,p.prop)(),this.duration=(0,p.prop)(),this.filehash=(0,p.prop)(),this.encFilehash=(0,p.prop)(),this.size=(0,p.prop)(),this.filename=(0,p.prop)(),this.streamingSidecar=(0,p.prop)(),this.mediaKey=(0,p.prop)(),this.mediaKeyTimestamp=(0,p.prop)(),this.pageCount=(0,p.prop)(),this.isGif=(0,p.prop)(),this.gifAttribution=(0,p.prop)(),this.isViewOnce=(0,p.prop)(),this.streamable=(0,p.prop)(),this.width=(0,p.prop)(),this.height=(0,p.prop)(),this.thumbnailDirectPath=(0,p.prop)(),this.thumbnailSha256=(0,p.prop)(),this.thumbnailEncSha256=(0,p.prop)(),this.thumbnailHeight=(0,p.prop)(),this.thumbnailWidth=(0,p.prop)(),this.scanLengths=(0,p.prop)(),this.scansSidecar=(0,p.prop)(),this.isFromTemplate=(0,p.prop)(!1),this.devicesAdded=(0,p.prop)(),this.devicesRemoved=(0,p.prop)(),this.isThisDeviceAdded=(0,p.prop)(),this.firstFrameLength=(0,p.prop)(),this.firstFrameSidecar=(0,p.prop)(),this.isAnimated=(0,p.prop)(),this.canonicalUrl=(0,p.prop)(),this.matchedText=(0,p.prop)(),this.thumbnail=(0,p.prop)(),this.richPreviewType=(0,p.prop)(),this.doNotPlayInline=(0,p.prop)(),this.title=(0,p.prop)(),this.description=(0,p.prop)(),this.businessOwnerJid=(0,p.prop)(),this.productId=(0,p.prop)(),this.currencyCode=(0,p.prop)(),this.priceAmount1000=(0,p.prop)(),this.salePriceAmount1000=(0,p.prop)(),this.retailerId=(0,p.prop)(),this.url=(0,p.prop)(),this.productImageCount=(0,p.prop)(),this.sessionId=(0,p.prop)(),this.recipients=(0,p.prop)(),this.broadcast=(0,p.prop)(),this.quotedMsg=(0,p.prop)(),this.quotedStanzaID=(0,p.prop)(),this.quotedRemoteJid=(0,p.prop)(),this.quotedParticipant=(0,p.prop)(),this.mentionedJidList=(0,p.prop)(),this.footer=(0,p.prop)(),this.hydratedButtons=(0,p.prop)(),this.buttons=(0,p.prop)(),this.selectedId=(0,p.prop)(),this.selectedIndex=(0,p.prop)(),this.multicast=(0,p.prop)(),this.urlText=(0,p.prop)(),this.urlNumber=(0,p.prop)(),this.clearMedia=(0,p.prop)(),this.isVcardOverMmsDocument=(0,p.prop)(!1),this.vcardList=(0,p.prop)(),this.vcardFormattedName=(0,p.prop)(),this.protocolMessageKey=(0,p.prop)(),this.templateParams=(0,p.prop)(),this.textColor=(0,p.prop)(),this.backgroundColor=(0,p.prop)(),this.font=(0,p.prop)(),this.isForwarded=(0,p.prop)(!1),this.forwardingScore=(0,p.prop)(),this.labels=(0,p.prop)(),this.paymentCurrency=(0,p.prop)(),this.paymentAmount1000=(0,p.prop)(),this.paymentMessageReceiverJid=(0,p.prop)(),this.paymentTransactionTimestamp=(0,p.prop)(),this.paymentStatus=(0,p.prop)(),this.paymentTxnStatus=(0,p.prop)(),this.paymentNoteMsg=(0,p.prop)(),this.paymentRequestMessageKey=(0,p.prop)(),this.paymentExpiryTimestamp=(0,p.prop)(),this.ephemeralStartTimestamp=(0,p.prop)(),this.ephemeralDuration=(0,p.prop)(),this.ephemeralSettingTimestamp=(0,p.prop)(),this.ephemeralOutOfSync=(0,p.prop)(),this.ephemeralSharedSecret=(0,p.prop)(),this.bizPrivacyStatus=(0,p.prop)(),this.verifiedBizName=(0,p.prop)(),this.inviteCode=(0,p.prop)(),this.inviteCodeExp=(0,p.prop)(),this.inviteGrp=(0,p.prop)(),this.inviteGrpName=(0,p.prop)(),this.inviteGrpJpegThum=(0,p.prop)(),this.sellerJid=(0,p.prop)(),this.message=(0,p.prop)(),this.orderTitle=(0,p.prop)(),this.itemCount=(0,p.prop)(),this.orderId=(0,p.prop)(),this.surface=(0,p.prop)(),this.status=(0,p.prop)(),this.token=(0,p.prop)(),this.totalAmount1000=(0,p.prop)(),this.totalCurrencyCode=(0,p.prop)(),this.historySyncMetaData=(0,p.prop)(),this.mdDowngrade=(0,p.prop)(),this.isSendFailure=(0,p.prop)(),this.appStateSyncKeyShare=(0,p.prop)(),this.appStateSyncKeyRequest=(0,p.prop)(),this.appStateFatalExceptionNotification=(0,p.prop)(),this.broadcastParticipants=(0,p.prop)(),this.broadcastEphSettings=(0,p.prop)(),this.broadcastId=(0,p.prop)(),this.ctwaContext=(0,p.prop)(),this.list=(0,p.prop)(),this.listResponse=(0,p.prop)(),this.productListItemCount=(0,p.prop)(),this.promises=(0,p.session)((()=>({}))),this.local=(0,p.session)(),this.search=(0,p.session)(),this.msgChunk=(0,p.session)(),this.phoneUploading=(0,p.session)(),this.startOfDay=(0,p.session)(),this.startOfDaySkew=(0,p.session)(),this._quotedMsgObj=(0,p.session)(),this.isQuotedMsgAvailable=(0,p.session)(!0),this.senderObj=(0,p.session)(),this.mediaData=(0,p.session)(),this.forwardedFromWeb=(0,p.session)(!1),this.isDynamicReplyButtonsMsg=(0,p.prop)(!1),this.dynamicReplyButtons=(0,p.prop)(),this.replyButtons=(0,p.prop)(),this.buttonsResponse=(0,p.prop)(),this.selectedButtonId=(0,p.prop)(),this._links=(0,p.session)((()=>[])),this._headerLinks=(0,p.session)((()=>[])),this._footerLinks=(0,p.session)((()=>[])),this.linksIndexParsed=(0,p.session)(0),this.chat=(0,p.derived)(this._chat),this.hasTemplateButtons=(0,p.derived)(this._hasTemplateButtons,["buttons"]),this.ephemeralExpirationTimestamp=(0,p.derived)(this._ephemeralExpirationTimestamp,["t","subtype","ephemeralStartTimestamp","ephemeralDuration"]),this.isEphemeral=(0,p.derived)(this._isEphemeral,["ephemeralDuration","type","subtype"]),this.isQuickReply=(0,p.derived)(this._isQuickReply,["buttons"]),this.isFutureproof=(0,p.derived)(this._isFutureproof,["type","subtype"]),this.isGroupMsg=(0,p.derived)(this._isGroupMsg),this.isStatusV3=(0,p.derived)(this._isStatusV3),this.isPSA=(0,p.derived)(this._isPSA),this.isRTL=(0,p.derived)(this._isRTL,["dir"]),this.asProductInquiry=(0,p.derived)(this._asProductInquiry),this.statusV3TextBg=(0,p.derived)(this._statusV3TextBg),this.isSentByMe=(0,p.derived)(this._isSentByMe),this.isSentByMeFromWeb=(0,p.derived)(this._isSentByMeFromWeb,["isUserCreatedType"]),this.isNotification=(0,p.derived)(this._isNotification,["type","subtype"]),this.asGroupNotification=(0,p.derived)(this._asGroupNotification,["type"]),this.asBroadcastNotification=(0,p.derived)(this._asBroadcastNotification,["type"]),this.isBizNotification=(0,p.derived)(this._isBizNotification,["type","subtype"]),this.asProduct=(0,p.derived)(this._asProduct,["type"]),this.asAlbumAsset=(0,p.derived)(this._asAlbumAsset,["type","isNotification","caption","isForwarded","asRevoked","isGif","quotedMsg","ctwaContext","isViewOnce"]),this.asGroupedSticker=(0,p.derived)(this._asGroupedSticker,["type","isNotification","asRevoked","quotedMsg","ctwaContext"]),this.isMedia=(0,p.derived)(this._isMedia,["type"]),this.asDoc=(0,p.derived)(this._asDoc,["type"]),this.asImage=(0,p.derived)(this._asImage,["type"]),this.asVideo=(0,p.derived)(this._asVideo,["type"]),this.asMms=(0,p.derived)(this._asMms,["type"]),this.asRevoked=(0,p.derived)(this._asRevoked,["type"]),this.asViewOnce=(0,p.derived)(this._asViewOnce,["type","isViewOnce"]),this.asVisualMedia=(0,p.derived)(this._asVisualMedia,["type"]),this.numTimesForwarded=(0,p.derived)(this._numTimesForwarded,["isForwarded","forwardingScore"]),this.isFrequentlyForwarded=(0,p.derived)(this._isFrequentlyForwarded,["numTimesForwarded"]),this.eventType=(0,p.derived)(this._eventType,["type","invis","isNewMsg"]),this.sender=(0,p.derived)(this._sender),this.text=(0,p.derived)(this._text,["type","body","caption","comment","isLive","paymentNoteMsg","subtype"]),this.containsEmoji=(0,p.derived)(this._containsEmoji,["text"]),this.isFailed=(0,p.derived)(this._isFailed,["isSentByMe","ack","mdDowngrade","isSendFailure"]),this.vcard=(0,p.derived)(this._vcard,["type","body"]),this.isUnsentMedia=(0,p.derived)(this._isUnsentMedia,["ack","asMms","isSentByMe"]),this.dir=(0,p.derived)(this._dir,["type","text","subtype"]),this.rtl=(0,p.derived)(this._rtl,["type","text","subtype"]),this.linkPreview=(0,p.derived)(this._linkPreview,["matchedText","body","title","description"]),this.isGroupsV4InviteExpired=(0,p.derived)(this._isGroupsV4InviteExpired,["type","inviteCode","inviteCodeExp"]),this.isPersistent=(0,p.derived)(this._isPersistent),this.isUnreadType=(0,p.derived)(this._isUnreadType,["type"]),this.isUserCreatedType=(0,p.derived)(this._isUserCreatedType,["type"]),this.supportsMessageFooter=(0,p.derived)(this._supportsMessageFooter,["isDynamicReplyButtonsMsg","isFromTemplate"]),this.supportsMessageFooterLinks=(0,p.derived)(this._supportsMessageFooterLinks,["type","isDynamicReplyButtonsMsg"]),this.hasBodyOrFooter=(0,p.derived)(this._hasBodyOrFooter,["text","footer"]),this.initialPageSize=(0,p.derived)(this._initialPageSize,["isFrequentlyForwarded"])}_chat(){return this._getChatCollection().get(this.id.remote)}_hasTemplateButtons(){return this.isFromTemplate&&null!=this.buttons&&this.buttons.length>0}_ephemeralExpirationTimestamp(){var{ephemeralDuration:e,ephemeralStartTimestamp:t,t:r,subtype:a,id:{fromMe:i}}=this;return(0,b.getEphemeralExpirationTimestamp)(e,t,r,a,i)}_isEphemeral(){return(this.type!==z.PROTOCOL||"ephemeral_setting"!==this.subtype)&&(null!=this.ephemeralDuration&&0!==this.ephemeralDuration)}_isQuickReply(){if(!this.hasTemplateButtons)return!1;if(null==this.buttons)return!1;var e=this.buttons.at(0);return null!=e&&e.subtype===g.default.TEMPLATE_BUTTON_SUBTYPE.QUICK_REPLY}_isFutureproof(){return this.type===z.UNKNOWN||this.type===z.PAYMENT&&"futureproof"===this.subtype}_isGroupMsg(){return $.default.isGroup(this.from)||$.default.isGroup(this.to)}_isStatusV3(){return $.default.isStatusV3(this.id.remote)}_isPSA(){return $.default.isPSA(this.id.remote)}_isRTL(){return"rtl"===this.dir||void 0===this.dir&&P.default.isRTL()}_asProductInquiry(){var e=this.safe();return e.type===g.default.MSG_TYPE.PRODUCT&&e.id&&e.id.id===g.default.PRODUCT_INQUIRY_TYPE?e:null}_statusV3TextBg(){if(!this.isStatusV3)return null;var e=this.backgroundColor;return e?`rgba(${e>>16&255}, ${e>>8&255}, ${255&e}, ${e>>24&255})`:null}_isSentByMe(){return"in"!==this.id.self&&!this.isNotification&&$.default.equals(this.from,(0,A.getMaybeMeUser)())}_isSentByMeFromWeb(){return this.id.fromMe&&this.local&&this.isUserCreatedType}_isNotification(){return k.isNotification(this.type,this.subtype)}_asGroupNotification(){var e=this.safe();switch(e.type){case z.GROUP_NOTIFICATION:case z.GP2:return e;default:return null}}_asBroadcastNotification(){var e=this.safe();return e.type===z.BROADCAST_NOTIFICATION?e:null}_isBizNotification(){if(this.type===z.NOTIFICATION_TEMPLATE){if(h.BIZ_SYSTEM_MSG_SUBTYPES_V2.includes(this.subtype))return!0;switch(this.subtype){case"verified_initial_unknown":case"verified_initial_low":case"verified_initial_high":case"verified_transition_any_to_none":case"verified_transition_any_to_high":case"verified_transition_high_to_low":case"verified_transition_high_to_unknown":case"verified_transition_unknown_to_low":case"verified_transition_low_to_unknown":case"verified_transition_none_to_low":case"verified_transition_none_to_unknown":case"biz_verified_transition_top_to_bottom":case"biz_verified_transition_bottom_to_top":case"biz_intro_top":case"biz_intro_bottom":case"biz_name_change":case"biz_move_to_consumer_app":case"biz_two_tier_migration_top":case"biz_two_tier_migration_bottom":return!0;default:return!1}}return!1}_asProduct(){var e=this.safe();return"product"===e.type?e:null}_asAlbumAsset(){var e=this.safe();return e.type!==g.default.MSG_TYPE.IMAGE&&(e.type!==g.default.MSG_TYPE.VIDEO||!0===e.isGif)||e.isNotification||e.caption||e.asRevoked||e.quotedMsg||e.ctwaContext||e.isViewOnce?null:e}_asGroupedSticker(){var e=this.safe();return e.type!==g.default.MSG_TYPE.STICKER||e.isNotification||e.asRevoked||e.quotedMsg||e.ctwaContext?null:e}_isMedia(){return["image","video","audio"].includes(this.type)}_asDoc(){var e=this.safe();return e.type===g.default.MSG_TYPE.DOCUMENT?e:null}_asImage(){var e=this.safe();return e.type===g.default.MSG_TYPE.IMAGE?e:null}_asVideo(){var e=this.safe();return e.type===g.default.MSG_TYPE.VIDEO?e:null}_asMms(){var e=this.safe();return(0,k.typeIsMms)(e)?e:null}_asRevoked(){var e=this.safe();return e.type===z.REVOKED?e:null}_asViewOnce(){var e=this.asVisualMedia;return(null==e?void 0:e.isViewOnce)?e:null}_asVisualMedia(){var e=this.safe();return e.type===g.default.MSG_TYPE.IMAGE||e.type===g.default.MSG_TYPE.VIDEO?e:null}_numTimesForwarded(){return this.forwardingScore?this.forwardingScore||0:this.isForwarded?1:0}_isFrequentlyForwarded(){return this.numTimesForwarded>=g.default.FREQUENTLY_FORWARDED_SENTINEL}_eventType(){if(!this.isNewMsg)return"i";var e=(0,k.eventTypeFromMsgType)(this);return this.invis?"i"===e?"i":"n":e}_sender(){return this.isSentByMe?this.from:this.isGroupMsg||this.isStatusV3?this.author:this.from}_text(){var e;if(this.isFromTemplate||this.isDynamicReplyButtonsMsg)return this.type===z.CHAT?this.body:this.caption;switch(this.type){case z.CHAT:return this.body;case z.IMAGE:case z.VIDEO:return this.caption;case z.LOCATION:return this.isLive?this.comment:void 0;case z.PAYMENT:var{paymentNoteMsg:t}=this;return t?t.body:void 0;case z.GROUPS_V4_INVITE:return this.comment;case z.LIST:return null===(e=this.list)||void 0===e?void 0:e.description;case z.PRODUCT:return(0,d.default)(this.title,{length:g.default.MAX_REPLY_PRODUCT_TITLE_LENGTH});case z.HSM:case z.TEMPLATE_BUTTON_REPLY:return this.body;default:return}}_containsEmoji(){var{text:e}=this;return!!e&&y.default.containsEmoji(e)}_isFailed(){var e=this.isSentByMe&&this.ack<g.default.ACK.CLOCK;return C.default.supportsFeature(C.default.F.MD_BACKEND)?e||!!this.mdDowngrade||!!this.isSendFailure:e}_vcard(){if(this.type===z.VCARD)try{return(0,W.parseVcard)(this.body)}catch(e){return}}_isUnsentMedia(){return this.ack<g.default.ACK.SENT&&null!=this.asMms&&this.isSentByMe}_dir(){return this.type===z.VCARD?this.subtype?c.dir(this.subtype):void 0:this.text?c.dir(this.text):void 0}_rtl(){return this.type===z.VCARD?!!this.subtype&&"rtl"===c.dir(this.subtype):!!this.text&&"rtl"===c.dir(this.text)}_linkPreview(){return(0,Y.isString)(this.matchedText)&&(!(0,l.default)(this.title)||!(0,l.default)(this.description))&&this.body.includes(this.matchedText)}_isGroupsV4InviteExpired(){if(this.type!==g.default.MSG_TYPE.GROUPS_V4_INVITE)return!1;if(!this.inviteCode)return!0;var e=(new Date).getTime()/1e3;return parseInt(e,10)>=parseInt(this.inviteCodeExp,10)}_isPersistent(){return this.type===z.E2E_NOTIFICATION&&"encrypt"===this.subtype}_isUnreadType(){return[z.CHAT,z.IMAGE,z.VIDEO,z.AUDIO,z.PTT,z.DOCUMENT,z.VCARD,z.LOCATION,z.CIPHERTEXT,z.OVERSIZED,z.MULTI_VCARD,z.REVOKED,z.UNKNOWN,z.STICKER,z.PRODUCT,z.GROUPS_V4_INVITE].includes(this.type)}_isUserCreatedType(){return[z.PROTOCOL,z.CHAT,z.LOCATION,z.VCARD,z.MULTI_VCARD,z.IMAGE,z.VIDEO,z.AUDIO,z.PTT,z.DOCUMENT,z.STICKER,z.PRODUCT,z.GROUPS_V4_INVITE].includes(this.type)}_supportsMessageFooter(){return this.isFromTemplate||this.isDynamicReplyButtonsMsg}_supportsMessageFooterLinks(){return this.isDynamicReplyButtonsMsg||this.type===z.LIST}_hasBodyOrFooter(){return null!=this.text||null!=this.footer}_initialPageSize(){return this.isFrequentlyForwarded?g.default.FREQUENTLY_FORWARDED_INITIAL_PAGE_SIZE:g.default.INITIAL_PAGE_SIZE}initialize(){if(super.initialize(),this._pendingAckUpdate=new u.PromiseQueue,this.sender)this.addChild("senderObj",v.default.gadd(this.sender));else switch(this.type){case z.NOTIFICATION:case z.NOTIFICATION_TEMPLATE:case z.GROUP_NOTIFICATION:case z.GP2:case z.BROADCAST_NOTIFICATION:case z.E2E_NOTIFICATION:case z.CALL_LOG:case z.PROTOCOL:break;default:__LOG__(2)`msg:msg with no sender id:${this.id.toString()}, from:${this.from.toString()}, author:${this.author&&this.author.toString()}, type:${this.type}`}var e;this.mentionedJidList=this.mentionedJidList||[],this.mentionedJidList.forEach((e=>v.default.gadd(e)));var t=this.getCollection();(e=t.preAck[this.id])&&(__LOG__(2)`Msg:initialize updating msg with out of order ack`,this.updateAck(e.ack,e.t),delete t.preAck[this.id]),this.type===z.CIPHERTEXT&&this.listenToOnce(this,"change:type",this.onCiphertextDecrypted),this.mediaObject=void 0,k.typeIsMms(this)&&(this._createMediaDataChild(),this.isViewOnce&&!(0,H.isUnviewed)(this.safe())||I.registerMsg(this)),this.isSentByMeFromWeb&&(this.promises.sendPromise=Promise.sit("settled").finally((()=>{this.promises.sendPromise=null})).endWithControls("settled")),this.isLive&&r(36839).default.processMsg(this,!1),m.default.isSMB&&(0,O.initializeLabels)(this),this.isViewOnce&&(this.listenTo(this,"change:ack",this.onViewOnceMediaStatusChanged),this.listenTo(this.mediaData,"change:mediaStage",this.onViewOnceMediaStatusChanged))}_getLinks(e,t=[],r=0,a=1/0){if(r>=a)return[t,a];var i=(0,K.firstNCodepoints)(e,a),n=M.findLinks(i,false,this.sender);if((0,K.numCodepoints)(e)>a&&n.length>0){var s=n[n.length-1];(0,K.numCodepoints)(i.slice(0,s.index))+(0,K.numCodepoints)(s.url)===a&&(n=M.findLinks(e,false,this.sender))}return[n,a]}getLinks(e=this.initialPageSize+1){var{text:t}=this;if(null==t)return this._links;var[r,a]=this._getLinks(t,this._links,this.linksIndexParsed,e);return this.linksIndexParsed=a,this._links=r}getHeaderLinks(){if(!1===this.isDynamicReplyButtonsMsg||null==this.title)return[];if(this._headerLinks.length>0)return this._headerLinks;var[e]=this._getLinks(this.title,this._headerLinks);return this._headerLinks=e}getFooterLinks(){if(!this.supportsMessageFooterLinks||null==this.footer)return[];if(this._footerLinks.length>0)return this._footerLinks;var[e]=this._getLinks(this.footer,this._footerLinks);return this._footerLinks=e}getGalleryLinks(){return(0,o.default)(this.getLinks(),"href").filter((e=>e.isHttp))}getSuspiciousLinks(){return this.getLinks().filter((e=>e.suspiciousCharacters&&e.suspiciousCharacters.size))}_createMediaDataChild(){this.addChild("mediaData",new R.default)}hasSymbol(){return["image","video","audio","ptt","location","vcard","multi_vcard","document","ciphertext","oversized","unknown","call_log","revoked","sticker","payment","groups_v4_invite","product","order"].includes(this.type)}mayFail(){return this.isSentByMe&&this.ack<g.default.ACK.SENT}isUnsentPhoneMsg(){return!this.local&&this.isSentByMe&&this.ack<g.default.ACK.SENT}canReply(){return!(this.type===z.LIST&&!(0,k.listMsgCanRender)(this))&&(this.chat.canSend&&!this.mayFail()&&!this.isNotification&&this.type!==z.UNKNOWN&&this.type!==z.CIPHERTEXT&&this.type!==z.OVERSIZED&&this.type!==z.REVOKED&&this.interactiveButtonsReleased())}canPrivateReply(){return!this.mayFail()&&!this.isNotification&&this.type!==z.UNKNOWN&&this.type!==z.CIPHERTEXT&&this.type!==z.OVERSIZED&&this.type!==z.REVOKED&&!this.isSentByMe&&this.isGroupMsg&&this.interactiveButtonsReleased()}canPrivateReplyInRestrictedGrp(){return!!this.chat.isAnnounceGrpRestrict&&!this.chat.isReadOnly&&!this.mayFail()&&!this.isSentByMe&&!this.isNotification&&this.type!==z.UNKNOWN&&this.type!==z.CIPHERTEXT&&this.type!==z.OVERSIZED&&this.type!==z.REVOKED&&this.interactiveButtonsReleased()}canForward(){var e;if(this.type===z.CIPHERTEXT)return!1;if(this.type===z.OVERSIZED)return!1;if(this.type===z.REVOKED)return!1;if(this.type===z.UNKNOWN)return!1;if(this.type===z.PAYMENT)return!1;if(this.type===z.LIST)return(null===(e=this.list)||void 0===e?void 0:e.listType)===E.ListMessageListType.PRODUCT_LIST&&(0,k.listMsgCanRender)(this);if(this.type===z.GROUPS_V4_INVITE)return!1;if(this.type===z.LOCATION&&this.isLive)return!1;if(this.type===z.ORDER)return!1;if(!this.interactiveButtonsReleased())return!1;if(this.ack<g.default.ACK.SENT&&this.isSentByMe)return!1;if(this.asMms){var t=this.mediaData;if(t.mediaStage===D.MEDIA_DATA_STAGE.EXISTS)return!0;if(t.mediaStage===D.MEDIA_DATA_STAGE.ERROR_MISSING)return!1;if(t.mediaStage===D.MEDIA_DATA_STAGE.ERROR_UNSUPPORTED)return!1;if(t.mediaStage!==D.MEDIA_DATA_STAGE.RESOLVED&&(this.type===z.IMAGE||this.type===z.VIDEO||this.type===z.PTT))return!1;if(this.isViewOnce)return!1;if(this.isUnsentMedia)return!1}return!0}canQuickForward(){return!(!this.canForward()||this.isFrequentlyForwarded||0!==this.getSuspiciousLinks().length||this.type===g.default.MSG_TYPE.PTT||this.type===g.default.MSG_TYPE.STICKER||!this.interactiveButtonsReleased())&&(null!=this.asMms||this.linkPreview||this.type===g.default.MSG_TYPE.VCARD||this.type===g.default.MSG_TYPE.LOCATION||null!=this.ctwaContext)}canStar(){return!(this.type===z.LIST&&!(0,k.listMsgCanRender)(this))&&(!this.isNotification&&!this.isFutureproof&&!this.isViewOnce&&this.type!==z.REVOKED&&!(this.ack<g.default.ACK.SENT&&this.isSentByMe)&&this.interactiveButtonsReleased())}interactiveButtonsReleased(){return this.isFromTemplate||!this.hasTemplateButtons&&this.type!==g.default.MSG_TYPE.TEMPLATE_BUTTON_REPLY}isGroupLeave(){return"gp2"===this.type&&("leave"===this.subtype||"remove"===this.subtype)&&$.default.equals(this.recipients[0],(0,A.getMaybeMeUser)())}isTrusted(){return!!$.default.equals(this.sender,(0,A.getMaybeMeUser)())||(!(!this.senderObj||!this.senderObj.isMyContact)||(this.isGroupMsg?this.chat.isTrusted():this.chat.notSpam))}getVcardWids(){return this.type!==z.VCARD?null:(0,W.vcardWids)(this.vcard)}getLocObject(){var e=this.loc;if(e){var[t,r=null]=e.split("\n");return{name:t,addr:r}}return null}resumeRemoteUpload(){return this.isUnsentPhoneMsg()&&!this.phoneUploading&&((0,F.sendMsgRecord)(this).then((e=>{e!==x.SendMsgResult.OK&&(this.phoneUploading=!1)})),this.phoneUploading=!0),this.downloadMedia({downloadEvenIfExpensive:!0,rmrReason:N.default.WEBC_RMR_REASON_CODE.MSG_CLICK,isUserInitiated:!0})}forceRMR(){return Promise.reject(new Error("unimplemented forceRMR"))}isForcingRMR(){return!1}cancelDownload(){I.cancelDownloadMsg(this)}resumeUpload(){return this.mediaData.mediaStage!==D.MEDIA_DATA_STAGE.NEED_UPLOAD&&(__LOG__(4,void 0,new Error,!0)`resumeUpload called while state was ${this.mediaData.mediaStage}`,SEND_LOGS("resume-non-need-upload")),I.resumeUploadMsg(this)}cancelUpload(){I.cancelUploadMsg(this)}logInitialRender(){if(this.asMms&&this.mediaData&&!this.isStatusV3&&!this._renderEvent){var e=this._renderEvent=new N.default.WebcMediaRender({messageMediaType:this.getWamMediaType(),webcChatType:this.chat.getWebcChatType(),webcChatPosition:this.chat.initialIndex,webcBrowserNetworkType:(0,U.getEffectiveNetworkType)(),webcMessageT:this.t}),{msgChunk:t}=this;t&&t===this.chat.msgs&&(e.webcMessageIndex=t.length-t.indexOf(this)-1);var r=()=>{switch(this.mediaData.mediaStage){case D.MEDIA_DATA_STAGE.INIT:case D.MEDIA_DATA_STAGE.PREPARING:case D.MEDIA_DATA_STAGE.FETCHING:case D.MEDIA_DATA_STAGE.DECRYPTING:case D.MEDIA_DATA_STAGE.REMOTE_UPLOADING:case D.MEDIA_DATA_STAGE.REUPLOADING:case D.MEDIA_DATA_STAGE.UPLOADING:case D.MEDIA_DATA_STAGE.SENDING:return;case D.MEDIA_DATA_STAGE.RESOLVED:e.webcMediaStage=N.default.WEBC_MEDIA_STAGE_TYPE.RESOLVED;break;case D.MEDIA_DATA_STAGE.NEED_POKE:e.webcMediaStage=N.default.WEBC_MEDIA_STAGE_TYPE.NEEDS_RMR;break;default:e.webcMediaStage=N.default.WEBC_MEDIA_STAGE_TYPE.OTHER}this._logStorageEstimate(e).finally((()=>{e.commit(),this.stopListening(this.mediaData,"change:mediaStage",r)}))};this.listenToAndRun(this.mediaData,"change:mediaStage",r)}}waitForPhoneUpload(){var e=this;return(0,n.default)((function*(){if(!Boolean(e.mediaData.filehash)||e.isUnsentPhoneMsg()){if(e.promises.waitForPhoneUploadPromise)return e.promises.waitForPhoneUploadPromise;e.promises.waitForPhoneUploadPromise=(0,V.default)(e.mediaData,"change:mediaStage change:filehash",(()=>Boolean(e.mediaData.filehash)&&!e.isUnsentPhoneMsg())),yield e.promises.waitForPhoneUploadPromise,e.promises.waitForPhoneUploadPromise=null}}))()}downloadMedia(e){if(this.asRevoked)return Promise.resolve();var{downloadEvenIfExpensive:t,rmrReason:r,isUserInitiated:a}=e;if(this.asMms||(__LOG__(4,void 0,new Error,!0)`id: ${this.id.toString()} type: ${this.type}`,SEND_LOGS("media-fault: downloadMedia msg is not mms type")),this.isUnsentPhoneMsg()){var i=this.promises.waitForPhoneUploadPromise;return i||(i=this.promises.waitForPhoneUploadPromise=(0,V.default)(this.mediaData,"change:mediaStage change:filehash",(()=>!!this.mediaData.filehash&&!this.isUnsentPhoneMsg())).then((()=>{this.promises.waitForPhoneUploadPromise=null}))),i.then((()=>this.downloadMedia(e)))}return I.downloadMsg({msg:this,isUserClick:r===N.default.WEBC_RMR_REASON_CODE.MSG_CLICK,downloadEvenIfExpensive:t,rmrReason:r,rmrData:this._getRmrData(r),mode:a?"manual":"auto"})}_getRmrData(e){var t={webcRmrReason:e,webcMessageT:this.t},r=this.chat;if(r){t.webcChatType=r.getWebcChatType(),null!=r.initialIndex&&(t.webcChatPosition=r.initialIndex);var{msgChunk:a}=this;a&&a===r.msgs&&(t.webcMessageIndex=a.length-a.indexOf(this)-1)}return t}applyUpdate(e){return e.type&&this.type!==e.type&&k.typeIsMms(e)?(this.type!==z.CIPHERTEXT&&(__LOG__(4,void 0,new Error,!0)`updated ${this.id.toString()} from ${this.type} to ${String(e.type)}`,SEND_LOGS("invalid-type-update")),this._createMediaDataChild(),I.registerMsgEarly(this,e),I.prepareMsg(this).then((()=>{this.set(e)})).catch((e=>{__LOG__(4,void 0,new Error,!0)`error = ${String(e)}`,SEND_LOGS("preregister-error")}))):(this.set(e),this.isLive&&r(36839).default.processMsg(this,!0),this.paymentTransactionTimestamp&&this.getCollection().updateLastTransactionTime(this.id.remote,this.paymentTransactionTimestamp),Promise.resolve())}waitForPrep(){return k.typeIsMms(this)?I.prepareMsg(this):Promise.resolve()}delete(e){super.delete(),r(37147).default.remove(this),this.isLive&&r(36839).default.removeMsg(this),this.getCollection().remove(this.id),this.msgChunk&&this.msgChunk.remove(this.id,{},Boolean(e&&e.skipUpdatingSortTime)),k.typeIsMms(this)&&I.deregisterMsg(this),r(62345).default.removeAllLabelsMD(this);var t=this._getChatCollection().get(this.id.remote);if(t){if(t.unreadMsgAnchor===this&&(t.unreadMsgAnchor=void 0),(!e||!e.doNotResetLastReceived)&&t.lastReceivedKey===this.id){var a=void 0,i=t.getLastReceivedMsg();i&&(a=i.id),(0,w.setLastReceivedKey)(t.id,a).then((()=>{t.lastReceivedKey=a}))}t.composeQuotedMsg===this&&(t.composeQuotedMsg=null)}}quotedMsgObj(){if(!this.quotedMsg&&!this.paymentRequestMessageKey)return null;if(this._quotedMsgObj){var e=this.getCollection();return k.getOriginalQuotedMsgIfPossible(this._quotedMsgObj,e)}if(this.quotedMsg)this._quotedMsgObj=this._getQuotedMsgObj();else{if(!this.paymentRequestMessageKey)return null;this._quotedMsgObj=this._getQuotedPaymentRequestMsg()}var t=this.getCollection();return k.getOriginalQuotedMsgIfPossible(this._quotedMsgObj,t)}_getQuotedMsgObj(){var e=(0,A.getMaybeMeUser)(),t=!this.quotedParticipant||$.default.equals(this.quotedParticipant,e),r=t?"out":"in",a=this.quotedRemoteJid?this.quotedRemoteJid:this.id.remote,i={id:this.quotedStanzaID,from:t?e:a,to:t?a:e,self:r,author:(0,G.default)(this.quotedParticipant,"this.quotedParticipant"),remote:a};return!($.default.isGroup(i.from)||$.default.isGroup(i.to))&&!$.default.isStatusV3(a)||$.default.equals(e,this.quotedParticipant)&&!C.default.supportsFeature(C.default.F.MD_BACKEND)||(i.participant=(0,G.default)(this.quotedParticipant,"this.quotedParticipant")),Object.assign(i,this.quotedMsg),k.createQuotedMsg(i)}_getQuotedPaymentRequestMsg(){if(!this.paymentRequestMessageKey)return null;var e=this.paymentRequestMessageKey.remote?this.paymentRequestMessageKey.remote:this.id.remote,t=this.paymentRequestMessageKey.fromMe,r=null!=this.paymentRequestMessageKey.self?this.paymentRequestMessageKey.self:t?"out":"in",a=this.paymentRequestMessageKey.participant||this.paymentMessageReceiverJid,i={id:this.paymentRequestMessageKey.id,from:t?(0,A.getMaybeMeUser)():e,to:t?e:(0,A.getMaybeMeUser)(),self:r,participant:a,author:a,remote:e,amount1000:this.paymentAmount1000,currency:this.paymentCurrency,receiverJid:this.sender,type:this.type,subtype:"request"};return k.createQuotedMsg(i)}getQuotedMsgAdminGroupJid(){return null==this.quotedMsg?this.quotedRemoteJid:null}msgContextInfo(e){var t=(0,s.default)(this.toJSON(),["id","t","notifyName","from","to","author","self","ack","invis","isNewMsg","star","recvFresh","recipients","broadcast","quotedMsg","quotedStanzaID","quotedRemoteJid","quotedParticipant","senderObj","multicast","replyButtons"]),r=null;return e&&!this.id.remote.equals(e)&&(r=this.id.remote),{quotedMsg:t,quotedParticipant:this.sender,quotedStanzaID:this.id.id,quotedRemoteJid:r}}displayName(e,t){if(!this.sender)return"";if(this.sender.equals((0,A.getMaybeMeUser)()))return P.default.t(1861);var r=this.senderObj,a=e?r.shortName:void 0;if(a)return a;if(r.name)return r.name;var i=t&&this.notifyName?" ~"+this.notifyName:"";return(0,q.default)(this.sender)+i}isQuoted(e){var t=this.quotedMsgObj();return!!t&&t.sender.equals(e)}isMentioned(e){return!!this.mentionedJidList&&this.mentionedJidList.findIndex((t=>t.equals(e)))>-1}mentionMap(){if(!this.mentionedJidList)return null;if(!this.mentionedJidList.length)return null;var e={};return this.mentionedJidList.forEach((t=>{e[`@${$.default.user(t)||""}`]=v.default.gadd(t)})),e}updateAck(e,t){if(C.default.supportsFeature(C.default.F.MD_BACKEND))this.updateAckMD(e,t);else{var r=this.ack;(0,Y.isNumber)(e)&&(void 0===r||e>r||e===g.default.ACK.FAILED)?(this.ack=e,e>=1&&null!=t&&null==this.ephemeralStartTimestamp&&this.updateEphemeralStartTimestamp(t),"ephemeral_setting"===this.subtype&&1===e&&null!=t&&(0,S.updateEphemeralSettingTimestamp)(this.chat,t)):e===g.default.ACK.FAILED&&this.ack===g.default.ACK.CLOCK&&(this.ack=g.default.ACK.FAILED,this.phoneUploading=!1)}}updateAckMD(e,t){var r=this;this._pendingAckUpdate.enqueue((0,n.default)((function*(){var a=r.ack;(0,Y.isNumber)(e)&&(void 0===a||e>a||e===g.default.ACK.FAILED)?(yield(0,j.updateLocal)(r.id,{ack:e}),r.ack=e,e>=1&&null!=t&&null==r.ephemeralStartTimestamp&&r.updateEphemeralStartTimestamp(t),"ephemeral_setting"===r.subtype&&1===e&&null!=t&&(0,S.updateEphemeralSettingTimestamp)(r.chat,t)):e===g.default.ACK.FAILED&&r.ack===g.default.ACK.CLOCK&&(yield(0,j.updateLocal)(r.id,{ack:g.default.ACK.FAILED}),r.ack=g.default.ACK.FAILED,r.phoneUploading=!1)})))}avParams(){return I.mediaMetadata(this)}resend(){return this.isFailed?(this._pendingAckUpdate.enqueue((()=>(0,j.updateLocal)(this.id,{ack:g.default.ACK.CLOCK}).then((()=>{this.ack=g.default.ACK.CLOCK})))),this.asMms?this.isSentByMeFromWeb?this.resumeUpload():this.resumeRemoteUpload():(0,F.sendMsgRecord)(this)):Promise.resolve()}onCiphertextDecrypted(){if(!this.isStatusV3){var e=this.chat,t=e.msgs.length,r=e.msgs.indexOf(this);-1!==r&&t-r<=10&&_.default.alertNewMsg(this)}}onViewOnceMediaStatusChanged(){if(this.isViewOnce){var e=this.isSentByMe&&this.ack>=g.default.ACK.SENT&&this.mediaData.mediaStage===D.MEDIA_DATA_STAGE.RESOLVED,t=!this.isSentByMe&&this.ack>=g.default.ACK.PLAYED;(e||t)&&(I.deregisterMsg(this),this.stopListening(this,"change:ack",this.onViewOnceMediaStatusChanged),this.stopListening(this.mediaData,"change:mediaStage",this.onViewOnceMediaStatusChanged))}}canRevoke(){return this.id.fromMe&&this.isUserCreatedType&&(!$.default.isBroadcast(this.id.remote)||"iphone"===m.default.platform)&&!this.broadcast&&Math.trunc(+new Date/1e3)-this.t<=g.default.REVOKE_WINDOW&&!this.isUnsentPhoneMsg()&&!this.isUnsentMedia}getWamMessageType(){return this.isStatusV3?N.default.MESSAGE_TYPE.STATUS:this.isGroupMsg?N.default.MESSAGE_TYPE.GROUP:$.default.isBroadcast(this.id.remote)?N.default.MESSAGE_TYPE.BROADCAST:N.default.MESSAGE_TYPE.INDIVIDUAL}getWamMediaType(){var e,t;if(!0===this.isDynamicReplyButtonsMsg)return N.default.MEDIA_TYPE.BUTTON_MESSAGE;switch(this.type){case z.IMAGE:return N.default.MEDIA_TYPE.PHOTO;case z.VIDEO:return this.mediaData.isGif?N.default.MEDIA_TYPE.GIF:N.default.MEDIA_TYPE.VIDEO;case z.AUDIO:return N.default.MEDIA_TYPE.AUDIO;case z.PTT:return N.default.MEDIA_TYPE.PTT;case z.DOCUMENT:return N.default.MEDIA_TYPE.DOCUMENT;case z.UNKNOWN:return N.default.MEDIA_TYPE.FUTURE;case z.LOCATION:return this.isLive?N.default.MEDIA_TYPE.LIVE_LOCATION:N.default.MEDIA_TYPE.LOCATION;case z.VCARD:return N.default.MEDIA_TYPE.CONTACT;case z.MULTI_VCARD:return N.default.MEDIA_TYPE.CONTACT_ARRAY;case z.CHAT:return this.linkPreview?N.default.MEDIA_TYPE.URL:N.default.MEDIA_TYPE.NONE;case z.STICKER:return N.default.MEDIA_TYPE.STICKER;case z.PRODUCT:return N.default.MEDIA_TYPE.PRODUCT_IMAGE;case z.LIST:switch(null!==(e=null===(t=this.list)||void 0===t?void 0:t.listType)&&void 0!==e?e:E.ListMessageListType.UNKNOWN){case E.ListMessageListType.SINGLE_SELECT:return N.default.MEDIA_TYPE.LIST;case E.ListMessageListType.PRODUCT_LIST:return N.default.MEDIA_TYPE.PRODUCT_LIST;default:return N.default.MEDIA_TYPE.NONE}case z.LIST_RESPONSE:return N.default.MEDIA_TYPE.LIST_REPLY;case z.BUTTONS_RESPONSE:return N.default.MEDIA_TYPE.BUTTON_RESPONSE_MESSAGE;case z.ORDER:return N.default.MEDIA_TYPE.ORDER;default:return N.default.MEDIA_TYPE.NONE}}getForwardingScoreWhenForwarded(){if(!B.default.frequentlyForwardedMessages)return this.numTimesForwarded;var e=this.numTimesForwarded+(this.id.fromMe?0:1);return e>=B.default.frequentlyForwardedThreshold?g.default.FREQUENTLY_FORWARDED_SENTINEL:e}updateEphemeralStartTimestamp(e){return(0,j.updateLocal)(this.id,{ephemeralStartTimestamp:e}).then((()=>{this.ephemeralStartTimestamp=e}))}isExpired(){return null!=this.ephemeralExpirationTimestamp&&this.ephemeralExpirationTimestamp<=f.default.globalUnixTime()}_logStorageEstimate(e){return(0,T.default)().then((t=>{t&&(e.webcBrowserStorageQuotaBytes=t.quota,e.webcBrowserStorageQuotaUsedBytes=t.usage)}))}getCollection(){return r(30528).default}_getChatCollection(){return r(85030).default}isDownloadable(){var e;return!this.asRevoked&&(!this.isViewOnce&&(this.type===g.default.MSG_TYPE.VCARD||this.type===g.default.MSG_TYPE.MULTI_VCARD||!!(null===(e=this.mediaData)||void 0===e?void 0:e.isDownloadable())&&this.type!==g.default.MSG_TYPE.STICKER))}safe(){return this}unsafe(){return this}}J.Proxy="msg",J.idClass=L.default;var Q=(0,p.defineModel)(J),X=Q;t.default=X},70947:(e,t,r)=>{"use strict";var a=r(14859),i=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(r(99778)),s=a(r(83746));class o extends n.default{constructor(...e){super(...e),this.id=(0,n.prop)(),this.unsyncedButtonReplies=(0,n.prop)()}}o.Proxy="msgButtonReplyMsg",o.idClass=s.default;var l=(0,n.defineModel)(o);t.default=l},68980:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(18641)),n=a(r(70947));class s extends i.default{}t.default=s,s.model=n.default},30528:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.MsgCollection=void 0;var n=i(r(70417)),s=r(9737),o=i(r(18641)),l=i(r(23045)),d=r(99429),u=r(33576),c=r(87996),p=r(66239),h=i(r(36169)),f=i(r(68980)),_=i(r(83746)),m=i(r(21830)),g=r(35062),v=i(r(13754)),E=r(61864),y=i(r(57568)),S=i(r(94407)),T=i(r(43926)),A=r(25054),b=a(r(15934));class C extends o.default{constructor(){super(),this.lastReceivedReceipt={},this.lastReceivedPaymentTransaction={},this.preAck={},this.pendingAdd={},this.ftsCache={},this.productListMessagesPrefetchChain=Promise.resolve([]),this.onSearchTag=e=>{this.pendingSearchTag=e},this.listenTo(b.default,"change:stream",(function(){b.default.stream===b.STREAM.DISCONNECTED&&(this.preAck={})})),this.listenTo(this,"remove",this.removeFromCollection)}removeFromCollection(e){e.chat&&e.chat.removeFromCollection(e)}_findQuery(e,t){var a,i=this;switch(e.direction){case"before":case"after":a=e.direction;break;default:a="before"}var n={add:a,isHistory:!0};return(0,c.msgFindQuery)(a,e,t,void 0).then((t=>t.status>=400?(__LOG__(3)`model:Msg:findQuery error ${t.status}`,Promise.reject(t.status)):(t.forEach((function(e){e.invis=!0})),__LOG__(2)`model:Msg:findQuery:got:${t.length}:${e.direction}`,i.processMultipleMessages(e.remote,t,n,(function(){var t=i.get(e),a=r(85030).default.get(e.remote);return t?t.msgChunk:a?a.msgs:void 0})))))}add(e,t){var r=(Array.isArray(e)?e:[e]).filter((e=>null==e.ephemeralDuration||0===e.ephemeralDuration||!new h.default(e).isExpired())),a=super.add(r,t);return this._syncTemplateButtonClickState(a),this._syncQuickReplyButtonClickState(a),this._prefetchProductListMessages(a),a}_prefetchProductListMessages(e){var t=r(27617).default;this.productListMessagesPrefetchChain=e.filter((e=>{var t,r;return null!=e&&e.isNewMsg&&e.type===l.default.MSG_TYPE.LIST&&(null===(t=e.list)||void 0===t?void 0:t.listType)===d.ListMessageListType.PRODUCT_LIST&&null!=(null===(r=e.list)||void 0===r?void 0:r.productListInfo)})).reduce(((e,r)=>{var a,i;if(null==r)return e;var n=r.isForwarded?r.businessOwnerJid:r.from.toString({legacy:!0}),s=null===(a=r.list)||void 0===a?void 0:a.productListInfo;if(null==n||null==s)return e;var o=t.getOrAdd(r.id,s,n,null===(i=r.list)||void 0===i?void 0:i.title);return null==o||0!==o.productCollection.getModelsArray().length||o.isFetching()?e:e.then((()=>t.update(o.id)))}),this.productListMessagesPrefetchChain)}_syncTemplateButtonClickState(e){for(var t=this,r=function(r){var a=e[r];if(!a)return"continue";var i=a.chat;if(a.type===l.default.MSG_TYPE.TEMPLATE_BUTTON_REPLY&&null!=a.selectedIndex&&a.sender.equals((0,p.getMaybeMeUser)())){null==i.msgUnsyncedButtonReplyMsgs&&(i.msgUnsyncedButtonReplyMsgs=new f.default);var{msgUnsyncedButtonReplyMsgs:n}=i,s=a.quotedMsgObj();if(!s)return"continue";var o=n.get(s.id);o||(n.add({id:s.id,unsyncedButtonReplies:new v.default}),o=n.get(s.id));var{unsyncedButtonReplies:d}=(0,m.default)(o,"buttonReplyMsg");d.add(a);var u=t.get(s.id);if(u&&u.buttons){var c=u.buttons.get(`${(0,m.default)(a.selectedIndex,"msg.selectedIndex")}`);c&&(c.selected=!0),d.remove(a)}}else if(a.isFromTemplate&&a.buttons){var{msgUnsyncedButtonReplyMsgs:h}=i;if(null==h)return"continue";var _=h.get(a.id);_&&(_.unsyncedButtonReplies.forEach((e=>{var t=(0,m.default)(a.buttons,"msg.buttons").get(`${(0,m.default)(e.selectedIndex,"replyMsg.selectedIndex")}`);t&&(t.selected=!0)})),_.unsyncedButtonReplies.delete())}},a=0;a<e.length;a++)r(a)}_syncQuickReplyButtonClickState(e){for(var t=this,r=function(r){var a=e[r];if(!a)return"continue";if(a.type===l.default.MSG_TYPE.BUTTONS_RESPONSE&&null!=a.selectedButtonId&&a.sender.equals((0,p.getMaybeMeUser)())){var i=a.quotedMsgObj();if(!i)return"continue";var n=t.get(i.id);if(n&&n.replyButtons){var s=n.replyButtons.get(a.selectedButtonId);s&&(s.selected=!0)}}else if(a.isDynamicReplyButtonsMsg&&a.replyButtons&&a.replyButtons.every((e=>!e.selected))&&a.chat){var o=Math.max(0,a.chat.msgs.models.length-1e3);a.chat.msgs.getModelsArray().slice(o).filter((e=>{var t;return e.type===l.default.MSG_TYPE.BUTTONS_RESPONSE&&null!=e.selectedButtonId&&e.sender.equals((0,p.getMaybeMeUser)())&&(null===(t=e.quotedMsgObj())||void 0===t?void 0:t.id.toString())===a.id.toString()})).map((({selectedButtonId:e})=>e)).forEach((e=>{var t,r=null===(t=a.replyButtons)||void 0===t?void 0:t.get(e);null!=r&&(r.selected=!0)}))}},a=0;a<e.length;a++)r(a)}getStarred(e,t,r,a){var i={count:"number"!=typeof t||isNaN(t)?l.default.PAGE_SIZE:t,chat:e||void 0,remote:r&&r.remote,id:r&&r.id,fromMe:r&&r.fromMe,participant:r&&r.participant,media:a?"gif":void 0},n={add:"search"};return(0,c.msgFindQuery)("star",i).then((e=>{var t=e.status;return e.status>=400?(499===t?__LOG__(2)`model:Msg:getStarred error 499 (unimplemented)`:__LOG__(3)`model:Msg:getStarred error ${t}`,Promise.reject(t)):this.processMultipleMessages(void 0,e,n)}))}getMessagesById(e){return(0,c.msgFindByIds)(e).then((e=>(0,s.promiseProps)({messages:this.processMultipleMessages(void 0,e,{add:"search"}),eof:!0,canceled:!1})))}queryVcard(e){return(0,c.queryVcard)(e).then((e=>499===e.status?(__LOG__(2)`model:Msg:queryVcard error 499 (unimplemented)`,Promise.reject(new u.E499)):this.processMultipleMessages(void 0,e,{add:"search"})))}incrementalStarredUpdate(e){return this.processMultipleMessages(void 0,e,{add:"search"})}search(e,t=1,r,a,i={}){var n=`${e}__${i.label||i.kind||""}`;if(1!==t||a)return this._search(e,t,r,a,i.label,i.kind);var s=this.ftsCache[n];if(s)return s;var o=this._search(e,t,r,a,i.label,i.kind);this.ftsCache[n]=o;var d=()=>{this.ftsCache[n]=null};return setTimeout(d,l.default.FTS_TTL),o.catch(d),o}_search(e,t,r,a,i,n){var o={searchTerm:e,page:(0,E.isNumber)(t)&&0!==t?t:1,count:(0,E.isNumber)(r)&&0!==r?r:l.default.PAGE_SIZE,remote:a,tagToCancel:a?this.pendingSearchTag:void 0,label:i,kind:n},d={add:"search"};return(0,c.msgFindQuery)("search",o,void 0,this.onSearchTag).then((e=>{if(o.tagToCancel===this.pendingSearchTag&&(this.pendingSearchTag=void 0),499===e.status)return(0,s.promiseProps)({messages:Promise.resolve([]),eof:!1,canceled:!0});if(404===e.status)return Promise.reject(new u.E404);if(e.status>=400)return __LOG__(3)`model:Msg:search error ${e.status}`,Promise.reject(e.status);var t=Array.isArray(e)?e:e.messages,r=!!Array.isArray(e)||e.eof;return(0,s.promiseProps)({messages:this.processMultipleMessages(void 0,t,d),eof:r,canceled:!1})}))}queryMedia(e,t,r,a,i){var n={remote:e,count:(0,E.isNumber)(t)&&0!==t?t:l.default.PAGE_SIZE,id:a&&a.id,fromMe:a&&a.fromMe,participant:a&&a.participant,direction:r||"before",media:i},o={add:"search"};return(0,c.msgFindQuery)("media",n).then((e=>e.status>=400?(__LOG__(3)`model:Msg:media error ${e.status}`,Promise.reject(e.status)):i?this.processMultipleMessages(void 0,e,{add:"search"}):(0,s.promiseProps)({docCount:e.docCount,linkCount:e.linkCount,mediaCount:e.mediaCount,messages:this.processMultipleMessages(void 0,e.messages,o)})))}getContext(e,t,r){var a=this.get(e);if(a)return Promise.all([(0,c.msgFindQuery)("before",e,r),(0,c.msgFindQuery)("after",e,r)]).spread(((r,i)=>Array.isArray(r)&&Array.isArray(i)?(a.search=!1,Promise.all([this.processMultipleMessages(e.remote,r,{add:"before",isHistory:!0},t),this.processMultipleMessages(e.remote,i,{add:"after",isHistory:!0},t)])):(__LOG__(3)`model:msg:getContext fetch error`,Promise.reject(r.status||i.status))));var i={add:"after",isHistory:!0};return(0,c.msgFindQuery)("after",e,r).then((r=>Array.isArray(r)?T.default.isStatusV3(r[0].id.remote)?Promise.reject("statusV3, stop querying before the msg"):this.processMultipleMessages(e.remote,r,i,t):(__LOG__(3)`model:msg:getContext:after fetch error`,Promise.reject(r.status)))).then((t=>{var a=(0,m.default)(t[0],"after[0]"),i=a.id.clone();i.count=e.count+1;var n={add:"before",isHistory:!0};return Promise.all([(0,c.msgFindQuery)("before",i,r).then((t=>Array.isArray(t)?t[t.length-1].id.equals(e)?this.processMultipleMessages(e.remote,t,n,(function(){return a.msgChunk})):(__LOG__(3)`model:msg:getContext:before ctx message mismatch`,Promise.reject(405)):(__LOG__(3)`model:msg:getContext:before fetch error`,Promise.reject(t.status)))),Promise.resolve(t)])}))}hasSynced(){return(0,y.default)(this,l.default.COLLECTION_HAS_SYNCED)}delete(){super.delete(),this.lastReceivedReceipt={},this.lastReceivedPaymentTransaction={},this.preAck={}}getKeysForResyncReceipts(){var e=[],t=(0,n.default)((0,n.default)({},this.lastReceivedReceipt),this.lastReceivedPaymentTransaction);for(var a in t){var i=(0,A.createWid)(a),s=r(85030).default.get(i),o=void 0;if(s&&(o=s.getFirstMsgWithStatus()),o){var l=o.id;l.t=this.lastReceivedReceipt[i]||o.t||0,l.payT=this.lastReceivedPaymentTransaction[i],e.push(l)}else __LOG__(3)`Msg:resyncReceipts wid in lastReceivedReceipt, but no msg: ${i.toString()}`}return e}resyncReceipts(){__LOG__(2)`Msg:resyncReceipts`;var e=this.getKeysForResyncReceipts();return 0===e.length?Promise.resolve():S.default.resyncReceipts(e).then((e=>{Array.isArray(e)?(__LOG__(2)`Msg:resyncReceipts success`,e.forEach((e=>{this.updateLastReceipt(e.id,e.t),this.updateLastTransactionTime(e.id,e.payT),e.acks.forEach((t=>{var{id:r,fromMe:a,participant:i,status:n,t:s}=t;if(null!=r&&null!=a&&null!=n){var o=new _.default({fromMe:a,remote:e.id,id:r,participant:i}),l=this.get(o);l&&(l.isEphemeral&&s?l.updateEphemeralStartTimestamp(s):l.updateAck(n))}else __LOG__(3)`Msg:resyncReceipts invalid response: ${JSON.stringify(t)}`})),e.msgs.length>0&&this.processMultipleMessages(e.id,e.msgs,{update:!0,isHistory:!1}).catchType(u.LogoutDrop,(()=>{}))}))):__LOG__(3)`Msg:resyncReceipts error`})).catchTypes3(u.LogoutDrop,u.EphemeralDrop,u.BrowserReplacedDrop,(()=>{})).catch((e=>{throw __LOG__(3)`Msg:resyncReceipts dropped ${String(e)} ${e?e.stack:"no stack"}`,new Error("Msg:resyncReceipts dropped")}))}updateLastReceipt(e,t){var r=this.lastReceivedReceipt[e];t&&(!r||t>r)&&(this.lastReceivedReceipt[e]=t)}updateLastTransactionTime(e,t){var r=this.lastReceivedPaymentTransaction[e];t&&(!r||t>r)&&(this.lastReceivedPaymentTransaction[e]=t)}processMultipleMessages(e,t,r,a){var i=()=>(0,g._processMultipleMessages)(e,t,r,a);if(e){var n,s=this.pendingAdd[e];return(n=s?s.then(i):i()).finally((()=>{e&&this.pendingAdd[e]===n&&(this.pendingAdd[e]=null)})).catch((()=>{})),this.pendingAdd[e]=n}return i()}markAllAsStale(){this.forEach((e=>e.unset("recvFresh")))}}t.MsgCollection=C,C.model=h.default;var P=new C;t.default=P},92112:(e,t,r)=>{"use strict";var a=r(14859),i=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.ParticipantCollection=t.MsgInfoParticipant=void 0;var n=i(r(99778)),s=a(r(21981)),o=a(r(43805)),l=a(r(61461)),d=a(r(83746)),u=a(r(43926));class c extends n.default{constructor(...e){super(...e),this.id=(0,n.prop)(),this.t=(0,n.prop)(),this.contact=(0,n.session)()}initialize(){super.initialize(),this.addChild("contact",o.default.gadd(this.id))}}c.Proxy="msgInfoParticipant",c.idClass=u.default;var p=(0,n.defineModel)(c);t.MsgInfoParticipant=p;class h extends s.default{}t.ParticipantCollection=h,h.model=p,h.comparator=(e,t)=>(0,l.default)(e.contact,t.contact);class f extends n.default{constructor(...e){super(...e),this.id=(0,n.prop)(),this.usePlayReceipt=(0,n.prop)(),this.playedRemaining=(0,n.prop)(0),this.readRemaining=(0,n.prop)(0),this.deliveryRemaining=(0,n.prop)(0),this.played=(0,n.collection)(h),this.read=(0,n.collection)(h),this.delivery=(0,n.collection)(h),this.settled=(0,n.derived)(this._settled,["usePlayReceipt","playedRemaining","readRemaining"])}_settled(){return this.usePlayReceipt?!this.playedRemaining:!this.readRemaining}getCollection(){return r(39542).default}}f.Proxy="msgInfo",f.idClass=d.default;var _=(0,n.defineModel)(f);t.default=_},39542:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.MsgInfoCollection=void 0;var n=i(r(18641)),s=i(r(92112)),o=r(28950),l=r(39427),d=i(r(83746)),u=a(r(15934));class c extends n.default{_initializeStaleCollection(){this.listenTo(u.default,"change:stream",(()=>{u.default.stream===u.STREAM.DISCONNECTED&&this.forEach((e=>{e.settled||e.set("stale",!0)}))}))}_find(e){var t=r(30528).default.get(e);return t?t.isSentByMe?(0,o.sendQueryMsgInfo)(t):Promise.reject("message not sent by me"):Promise.reject(`No message found for id: ${e}`)}updateInfo(e,t,r,a,i,n){var s=new d.default({from:t,to:r,id:e,participant:i}),o=new d.default({from:t,to:r,id:e}),u=this.get(s)||this.get(o);if(u)return(0,l.updateMsgInfo)(u,a,i,n)}}t.MsgInfoCollection=c,c.model=s.default,c.staleCollection=!0;var p=new c;t.default=p},44052:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.createDeviceSentMessage=function(e,t){return{deviceSentMessage:{destinationJid:t.toString({legacy:!0}),message:e}}},t.populateMessageContextInfo=function(e,t,r){if(!t&&!r)return;e.messageContextInfo={deviceListMetadata:{senderKeyHash:null==t?void 0:t.keyHash,senderTimestamp:null==t?void 0:t.timestamp,recipientKeyHash:null==r?void 0:r.keyHash,recipientTimestamp:null==r?void 0:r.timestamp}}},t.createViewOnceFutureProofMessage=c,t.createMsgProtobuf=function(e,t){var r,a=function(e){var t=e.id,r=e.toJSON();delete r.status,delete r.mimetype,delete r.height,delete r.width,delete r.recipients,delete r.chat,delete r.broadcast,delete r.ack,delete r.invis,delete r.filehash,delete r.recvFresh,delete r.mediaData,d.default.isHttp(e.clientUrl)||delete r.clientUrl;d.default.isHttp(e.deprecatedMms3Url)||delete r.deprecatedMms3Url;for(var a in r)null==r[a]&&delete r[a];var i=n.default.get(t.remote);i&&(r.conversionTuple=i.serialize());return r}(e);if(a.quotedMsg){var i=a.quotedMsg.mentionedJidList,s=Array.isArray(i)&&i.length>0?{mentionedJid:i.map(h)}:void 0;r={stanzaId:a.quotedStanzaID,remoteJid:h(a.quotedRemoteJid),participant:h(a.quotedParticipant),quotedMessage:p(a.quotedMsg,{duration:a.quotedMsg.duration,directPath:a.quotedMsg.directPath,encFilehash:a.quotedMsg.encFilehash,filehash:a.quotedMsg.filehash,height:a.quotedMsg.height,mediaKey:a.quotedMsg.mediaKey,mediaKeyTimestamp:(0,l.isNumber)(a.quotedMsg.mediaKeyTimestamp)?a.quotedMsg.mediaKeyTimestamp:void 0,mimetype:a.quotedMsg.mimetype,url:a.quotedMsg.clientUrl||a.quotedMsg.deprecatedMms3Url,width:a.quotedMsg.width},s)}}else a.quotedRemoteJid&&(r={remoteJid:h(a.quotedRemoteJid)});if(a.mentionedJidList&&a.mentionedJidList.length>0){var o=a.mentionedJidList;(r=r||{}).mentionedJid=o.map(h)}a.conversionTuple&&(r=r||{},Object.assign(r,a.conversionTuple));a.isForwarded&&((r=r||{}).isForwarded=a.isForwarded);a.forwardingScore&&((r=r||{}).forwardingScore=a.forwardingScore);a.ephemeralDuration&&((r=r||{}).expiration=a.ephemeralDuration);a.ephemeralSettingTimestamp&&((r=r||{}).ephemeralSettingTimestamp=a.ephemeralSettingTimestamp);a.ctwaContext&&((r=r||{}).externalAdReply={sourceUrl:a.ctwaContext.sourceUrl,sourceId:a.ctwaContext.sourceId,sourceType:a.ctwaContext.sourceType,body:a.ctwaContext.description,title:a.ctwaContext.title,thumbnailUrl:a.ctwaContext.thumbnailUrl,thumbnail:a.ctwaContext.thumbnail?f(a.ctwaContext.thumbnail):void 0,mediaType:a.ctwaContext.mediaType,mediaUrl:a.ctwaContext.mediaUrl});return p(a,t,r)},t.createMessageKey=function(e){return{remoteJid:h(e.to),fromMe:!0,id:e.id.id}};var i=r(84337),n=a(r(10346)),s=r(99429),o=a(r(20468)),l=r(61864),d=a(r(22006)),u=a(r(43926));function c(e){return{viewOnceMessage:{message:e}}}function p(e,t={},r,a){var i=a||{},n=e.mimetype||t.mimetype||void 0,o=t.duration;switch(e.type){case"chat":"url"===e.subtype||e.quotedMsg||e.quotedRemoteJid||Array.isArray(e.mentionedJidList)&&e.mentionedJidList.length>0||e.conversionTuple||e.isForwarded||e.forwardingScore||e._isPaymentNoteMsg||e.ephemeralDuration||e.ephemeralSettingTimestamp||e.ctwaContext?i.extendedTextMessage={text:e.body,matchedText:e.matchedText,canonicalUrl:e.canonicalUrl,description:e.description,title:e.title,jpegThumbnail:f(e.thumbnail),previewType:e.richPreviewType,contextInfo:r,mediaKey:f(e.mediaKey),mediaKeyTimestamp:(0,l.isNumber)(e.mediaKeyTimestamp)?e.mediaKeyTimestamp:void 0,thumbnailDirectPath:e.thumbnailDirectPath,thumbnailSha256:f(e.thumbnailSha256),thumbnailEncSha256:f(e.thumbnailEncSha256),thumbnailHeight:e.thumbnailHeight,thumbnailWidth:e.thumbnailWidth}:i.conversation=e.body;break;case"groups_v4_invite":i.groupInviteMessage={inviteCode:e.inviteCode,inviteExpiration:parseInt(e.inviteCodeExp,10),groupJid:e.inviteGrp,groupName:e.inviteGrpName,caption:e.comment,jpegThumbnail:f(e.inviteGrpJpegThum)};break;case"sticker":if("image/webp"!==t.mimetype)throw __LOG__(3)`invalid sticker mimetype: ${t.mimetype}`,new Error("invalid sticker mimetype");i.stickerMessage={url:t.url,mimetype:t.mimetype,directPath:t.directPath||void 0,fileSha256:f(t.filehash),fileEncSha256:f(t.encFilehash),mediaKey:f(t.mediaKey),mediaKeyTimestamp:(0,l.isNumber)(t.mediaKeyTimestamp)?t.mediaKeyTimestamp:void 0,fileLength:(0,l.isNumber)(e.size)?e.size:void 0,height:e.height,width:e.width,firstFrameLength:t.firstFrameLength||void 0,firstFrameSidecar:e.firstFrameSidecar||void 0,isAnimated:t.isAnimated,contextInfo:r},_(e.type,i.stickerMessage);break;case"location":var d={degreesLatitude:parseFloat(e.lat)||void 0,degreesLongitude:parseFloat(e.lng)||void 0,jpegThumbnail:f(e.body),contextInfo:r};if(e.loc&&(0,l.isString)(e.loc)){var u=e.loc.split("\n");d.name=u[0],d.address=u[1],d.url=e.clientUrl}i.locationMessage=d;break;case"vcard":i.contactMessage={displayName:e.vcardFormattedName,vcard:e.body,contextInfo:r};break;case"multi_vcard":i.contactsArrayMessage={displayName:e.subtype,contacts:e.vcardList.map((e=>e)),contextInfo:r};break;case"image":i.imageMessage={url:t.url,mimetype:n,caption:e.caption,directPath:t.directPath||void 0,fileSha256:f(t.filehash),fileEncSha256:f(t.encFilehash),height:t.height,width:t.width,fileLength:(0,l.isNumber)(e.size)?e.size:void 0,mediaKey:f(t.mediaKey),mediaKeyTimestamp:(0,l.isNumber)(t.mediaKeyTimestamp)?t.mediaKeyTimestamp:void 0,jpegThumbnail:e.isViewOnce?void 0:f(e.body),contextInfo:r,viewOnce:e.isViewOnce},_(e.type,i.imageMessage);break;case"product":i.productMessage={product:{productImage:{url:t.url,mimetype:n,caption:e.caption,directPath:t.directPath||void 0,fileSha256:f(t.filehash),fileEncSha256:f(t.encFilehash),height:t.height,width:t.width,fileLength:(0,l.isNumber)(e.size)?e.size:void 0,mediaKey:f(t.mediaKey),mediaKeyTimestamp:(0,l.isNumber)(t.mediaKeyTimestamp)?t.mediaKeyTimestamp:void 0,jpegThumbnail:f(e.body)},productId:e.productId,title:e.title,description:e.description,currencyCode:e.currencyCode,priceAmount1000:e.priceAmount1000||void 0,salePriceAmount1000:e.salePriceAmount1000||void 0,retailerId:e.retailerId,url:e.url,productImageCount:e.productImageCount},businessOwnerJid:e.businessOwnerJid,contextInfo:r};break;case"document":var m={url:t.url,mimetype:n,title:e.caption,directPath:t.directPath||void 0,fileSha256:f(t.filehash),fileEncSha256:f(t.encFilehash),fileName:t.filename,fileLength:(0,l.isNumber)(e.size)?e.size:void 0,mediaKey:f(t.mediaKey),mediaKeyTimestamp:(0,l.isNumber)(t.mediaKeyTimestamp)?t.mediaKeyTimestamp:void 0,jpegThumbnail:f(e.body),contextInfo:r,contactVcard:e.isVcardOverMmsDocument,thumbnailDirectPath:t.thumbnailDirectPath,thumbnailSha256:f(t.thumbnailSha256),thumbnailEncSha256:f(t.thumbnailEncSha256),thumbnailHeight:t.thumbnailHeight,thumbnailWidth:t.thumbnailWidth};(0,l.isNumber)(e.pageCount)&&!isNaN(e.pageCount)&&(m.pageCount=e.pageCount),i.documentMessage=m;break;case"ptt":case"audio":o=(0,l.isString)(o)?parseInt(o,10):o,i.audioMessage={url:t.url,mimetype:n,directPath:t.directPath||void 0,fileSha256:f(t.filehash),fileEncSha256:f(t.encFilehash),seconds:o,ptt:"ptt"===e.type,fileLength:(0,l.isNumber)(e.size)?e.size:void 0,mediaKey:f(t.mediaKey),mediaKeyTimestamp:(0,l.isNumber)(t.mediaKeyTimestamp)?t.mediaKeyTimestamp:void 0,contextInfo:r,streamingSidecar:e.streamingSidecar},_(e.type?"ptt":"audio",i.audioMessage);break;case"video":o=(0,l.isString)(o)?parseInt(o,10):o,i.videoMessage={url:t.url,mimetype:n,directPath:t.directPath||void 0,fileSha256:f(t.filehash),fileEncSha256:f(t.encFilehash),height:t.height,width:t.width,seconds:o,caption:e.caption,fileLength:(0,l.isNumber)(e.size)?e.size:void 0,mediaKey:f(t.mediaKey),mediaKeyTimestamp:(0,l.isNumber)(t.mediaKeyTimestamp)?t.mediaKeyTimestamp:void 0,jpegThumbnail:e.isViewOnce?void 0:f(e.body),gifPlayback:e.isGif,gifAttribution:e.gifAttribution,contextInfo:r,streamingSidecar:e.streamingSidecar,viewOnce:e.isViewOnce},_(e.type,i.videoMessage);break;case"protocol":var g;switch(e.subtype){case"revoke":var v=e.protocolMessageKey;g={key:{remoteJid:h(v.remote),fromMe:v.fromMe,id:v.id,participant:h(v.participant)},type:s.ProtocolMessageType.REVOKE};break;case"ephemeral_setting":g={type:s.ProtocolMessageType.EPHEMERAL_SETTING,ephemeralExpiration:e.ephemeralDuration};break;case"ephemeral_sync_response":g={type:s.ProtocolMessageType.EPHEMERAL_SYNC_RESPONSE,ephemeralExpiration:e.ephemeralDuration,ephemeralSettingTimestamp:e.ephemeralSettingTimestamp};break;case"app_state_sync_key_share":g={type:s.ProtocolMessageType.APP_STATE_SYNC_KEY_SHARE,appStateSyncKeyShare:e.appStateSyncKeyShare};break;case"app_state_sync_key_request":g={type:s.ProtocolMessageType.APP_STATE_SYNC_KEY_REQUEST,appStateSyncKeyRequest:e.appStateSyncKeyRequest};break;case"app_state_fatal_exception_notification":g={type:s.ProtocolMessageType.APP_STATE_FATAL_EXCEPTION_NOTIFICATION,appStateFatalExceptionNotification:e.appStateFatalExceptionNotification}}g&&(i.protocolMessage=g);break;case"payment":var E={};E.stanzaId=e.quotedStanzaID,E.mentionedJid=e.mentionedJidList&&e.mentionedJidList.map(h),E.isForwarded=e.isForwarded,E.forwardingScore=e.forwardingScore,E.participant=h(e.quotedParticipant),e.quotedMsg&&(E.quotedMessage=p(e.quotedMsg));var y=e.paymentNoteMsg?p(Object.assign(e.paymentNoteMsg,{_isPaymentNoteMsg:!0}),E):void 0;switch(e.subtype){case"send":var S=e.paymentRequestMessageKey?{fromMe:e.paymentRequestMessageKey.fromMe,remoteJid:h(e.paymentRequestMessageKey.remote),id:e.paymentRequestMessageKey.id,participant:h(e.paymentRequestMessageKey.participant)}:void 0;i.sendPaymentMessage={requestMessageKey:S,noteMessage:y};break;case"request":i.requestPaymentMessage={amount1000:e.amount1000,expiryTimestamp:e._paymentExpiryTimestamp,requestFrom:e._paymentRequestFrom,currencyCodeIso4217:e._currencyCodeIso4217,noteMessage:y}}break;case"template_button_reply":i.templateButtonReplyMessage={selectedId:e.selectedId,selectedIndex:e.selectedIndex,selectedDisplayText:e.body,contextInfo:r};break;case"template":return"text"===e.subtype?(e.type="chat",e.title&&(e.body="*"+e.title+"*\n"+e.body)):e.type=e.subtype,p(e,t,r,i);case"list":i.listMessage=e.list,i.listMessage.contextInfo=r;break;case"list_response":i.listResponseMessage=e.listResponse,i.listResponseMessage.contextInfo=r;break;case"buttons_response":i.buttonsResponseMessage=e.buttonsResponse,i.buttonsResponseMessage.contextInfo=r;break;case"order":e.itemCount||e.message||e.orderId||e.orderTitle||e.sellerJid||e.status||e.surface||e.thumbnail||e.token||e.totalAmount1000||e.totalCurrencyCode?i.orderMessage={itemCount:e.itemCount,message:e.message,orderId:e.orderId,orderTitle:e.orderTitle,sellerJid:e.sellerJid,status:e.status,surface:e.surface,thumbnail:f(e.thumbnail),token:e.token,totalAmount1000:e.totalAmount1000,totalCurrencyCode:e.totalCurrencyCode}:i.conversation=e.body}return!0===e.isDynamicReplyButtonsMsg&&(i=function(e,t,r){var{documentMessage:a,imageMessage:i,locationMessage:n,videoMessage:o}=e;if(t.isForwarded&&(a||i||n||o))return e;var l={buttons:!0===t.isForwarded?void 0:t.dynamicReplyButtons,footerText:t.footer,contextInfo:r};return a?(l.documentMessage=a,l.headerType=s.ButtonsMessageHeaderType.DOCUMENT,l.contentText=t.caption):i?(l.imageMessage=i,l.headerType=s.ButtonsMessageHeaderType.IMAGE,l.contentText=t.caption):n?(l.locationMessage=n,l.headerType=s.ButtonsMessageHeaderType.LOCATION,l.contentText=t.caption):o?(l.videoMessage=o,l.headerType=s.ButtonsMessageHeaderType.VIDEO,l.contentText=t.caption):t.title?(l.text=t.title,l.headerType=s.ButtonsMessageHeaderType.TEXT,l.contentText=t.body):(l.contentText=t.body,l.headerType=s.ButtonsMessageHeaderType.EMPTY),{buttonsMessage:l}}(i,e,r)),e.isViewOnce&&(i=c(i)),i}function h(e){return e instanceof u.default?e.toString({legacy:!0}):(0,l.isString)(e)?e.replace(/@c.us$/,"@s.whatsapp.net"):void 0}function f(e){return e?(0,i.decodeB64)(e):void 0}function _(e,t){o.default.supportsFeature(o.default.F.LOG_MISSING_REQUIRED_PROPERTIES)&&(t.viewOnce||(null==t.directPath&&(__LOG__(2,void 0,void 0,!0)`directPath missing from msg type ${e}`,SEND_LOGS("outgoing-media-message-missing-direct-path")),null==t.fileSha256&&(__LOG__(2,void 0,void 0,!0)`fileSha256 missing from msg type ${e}`,SEND_LOGS("outgoing-media-message-missing-file-sha")),null==t.fileEncSha256&&(__LOG__(2,void 0,void 0,!0)`fileEncSha256 missing from msg type ${e}`,SEND_LOGS("outgoing-media-message-missing-file-enc-sha")),null==t.url&&(__LOG__(2,void 0,void 0,!0)`url(deprecatedMms3Url) missing from msg type ${e}`,SEND_LOGS("outgoing-media-message-missing-mms3-url"))))}},76452:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.convertToTextWithoutSpecialEmojis=O,t.default=void 0;var n=i(r(70417)),s=i(r(30733)),o=r(84337),l=r(50581),d=i(r(99461)),u=a(r(79435)),c=i(r(23045)),p=r(99429),h=i(r(31615)),f=r(66239),_=i(r(20468)),m=r(9690),g=r(53353),v=a(r(63428)),E=i(r(83746)),y=i(r(32369)),S=i(r(54559)),T=r(61864),A=i(r(22006)),b=i(r(43926)),C=r(25054),P=(0,s.default)((function(e){if((0,g.isConnectedToPage)())return A.default.hostname(e);if(!e)return"";var t=A.default.isHttp(e)?e:"http://"+e;return new self.URL(t).hostname}));function O(e){return e?u.default.platform===u.PLATFORMS.ANDROID?e:h.default.convertToTextWithoutSpecialEmojis(e):e}function w(e,t){var r;_.default.supportsFeature(_.default.F.LOG_MISSING_REQUIRED_PROPERTIES)&&e.id&&("status"===(null===(r=e.id.remote)||void 0===r?void 0:r.user)&&b.default.isPSA(e.author)||e.id.fromMe||(null==t.directPath&&null==t.fileEncSha256?(__LOG__(2,void 0,void 0,!0)`directPath and fileEncSha256 missing from msg type ${e.type}`,SEND_LOGS("media-message-missing-direct-path-and-file-enc")):null==t.directPath?(__LOG__(2,void 0,void 0,!0)`directPath missing from msg type ${e.type}`,SEND_LOGS("media-message-missing-direct-path")):null==t.fileEncSha256&&(__LOG__(2,void 0,void 0,!0)`fileEncSha256 missing from msg type ${e.type}`,SEND_LOGS("media-message-missing-file-enc")),null==t.url&&(__LOG__(2,void 0,void 0,!0)`url(deprecatedMms3Url) is missing from msg type ${e.type}`,SEND_LOGS("media-message-missing-mms3-url")),null==t.mediaKey&&(__LOG__(2,void 0,void 0,!0)`mediaKey is missing from msg type ${e.type}`,SEND_LOGS("media-message-missing-media-key"))))}var M={parseMsgProto:function(e,t,r,a,i,n){if(!e)return __LOG__(4,void 0,new Error,!0)`drop: not Message`,SEND_LOGS("null-message"),t;var{conversation:s,imageMessage:o,contactMessage:l,locationMessage:d,liveLocationMessage:u,extendedTextMessage:p,documentMessage:h,audioMessage:f,videoMessage:m,stickerMessage:g,contactsArrayMessage:v,protocolMessage:E,sendPaymentMessage:y,requestPaymentMessage:A,declinePaymentRequestMessage:b,cancelPaymentRequestMessage:C,productMessage:P,groupInviteMessage:w,viewOnceMessage:M,ephemeralMessage:I,templateMessage:R,templateButtonReplyMessage:D,orderMessage:N,listMessage:L,listResponseMessage:k,buttonsResponseMessage:U,buttonsMessage:G}=e,F=void 0;if((0,T.isString)(s)&&this.parseConversationProto(t,s),w&&this.parseGroupInviteMessageProto(t,w),o&&(this.parseImageMessageProto(t,o),F=o.contextInfo),g&&(this.parseStickerMessageProto(t,g),F=g.contextInfo),l&&(this.parseContactMessageProto(t,l),F=l.contextInfo),v&&(this.parseContactsArrayMessageProto(t,v),F=v.contextInfo),d&&(this.parseLocationMessageProto(t,d),F=d.contextInfo),u&&(this.parseLiveLocationMessageProto(t,u,i),F=u.contextInfo),y&&(F=y&&y.noteMessage&&y.noteMessage.extendedTextMessage&&y.noteMessage.extendedTextMessage.contextInfo,this.parseSendPaymentMessageProto(t,y,a)),A&&(F=A&&A.noteMessage&&A.noteMessage.extendedTextMessage&&A.noteMessage.extendedTextMessage.contextInfo,this.parseRequestPaymentMessageProto(t,A,a)),b&&this.parseDeclinePaymentRequestMessageProto(t,b),C&&this.parseCancelPaymentRequestMessageProto(t,C),p&&(this.parseExtendedTextMessageProto(t,p),F=p.contextInfo),h&&(this.parseDocumentMessageProto(t,h),F=h.contextInfo),f&&(this.parseAudioMessageProto(t,f),F=f.contextInfo),m&&(this.parseVideoMessageProto(t,m),F=m.contextInfo),E&&this.parseProtocolMessageProto(t,E,r),P&&(this.parseProductMessageProto(t,P),F=P.contextInfo),w&&this.parseGroupInviteMessageProto(t,w),N&&(this.parseOrderMessageProto(t,N),F=N.contextInfo),L&&(this.parseListMessageProto(t,L),F=L.contextInfo),k&&(this.parseListResponseMessageProto(t,k),F=k.contextInfo),M&&this.parseViewOnceFutureProofMessageProto(t,M),I&&this.parseEphemeralFutureProofMessageProto(t,I),G&&this.parseButtonsMessageProto(t,G),U&&(this.parseButtonsResponseMessageProto(t,U),F=U.contextInfo),_.default.supportsFeature(_.default.F.MD_BACKEND)){var{deviceSentMessage:x,highlyStructuredMessage:B}=e;x&&this.parseDeviceSentMessage(t,x,r),B&&(t.type=c.default.MSG_TYPE.HSM,B.hydratedHsm&&B.hydratedHsm.hydratedTemplate&&(t.body=O(B.hydratedHsm.hydratedTemplate.hydratedContentText)))}return R&&(_.default.supportsFeature(_.default.F.MD_BACKEND)&&R.hydratedTemplate?this.parseTemplateMessage(t,R.hydratedTemplate):this.parseTemplateMessage(t,R.hydratedFourRowTemplate)),D&&(this.parseTemplateButtonReplyMessage(t,D),F=D.contextInfo,t.type=c.default.MSG_TYPE.TEMPLATE_BUTTON_REPLY),F&&(this.parseContextInfoProto(t,F,n),F.externalAdReply&&S.default.ctwaContextRender&&this.parseCtwaContextProto(t,F.externalAdReply)),t},parseConversationProto:function(e,t){e.type=c.default.MSG_TYPE.CHAT,e.body=O(t)},parseImageMessageProto:function(e,t){e.type=c.default.MSG_TYPE.IMAGE,e.deprecatedMms3Url=this.decodeUrl(t.url),e.directPath=t.directPath||"",e.mimetype=t.mimetype||"",e.caption=O(t.caption),e.filehash=this.decodeBytes(t.fileSha256),e.encFilehash=this.decodeBytes(t.fileEncSha256),e.size=t.fileLength||0,e.height=t.height||0,e.width=t.width||0,e.mediaKey=this.decodeBytes(t.mediaKey),e.mediaKeyTimestamp=null!=t.mediaKeyTimestamp?t.mediaKeyTimestamp:d.default.globalUnixTime(),e.body=this.decodeBytes(t.jpegThumbnail)||"",e.interactiveAnnotations=t.interactiveAnnotations,e.scanLengths=t.scanLengths,e.scansSidecar=t.scansSidecar,e.isViewOnce=!0===t.viewOnce,e.thumbnailDirectPath=t.thumbnailDirectPath,e.thumbnailSha256=this.decodeBytes(t.thumbnailSha256),e.thumbnailEncSha256=this.decodeBytes(t.thumbnailEncSha256),w(e,t)},parseStickerMessageProto:function(e,t){e.type=c.default.MSG_TYPE.STICKER,e.deprecatedMms3Url=this.decodeUrl(t.url),e.directPath=t.directPath||"",e.mimetype=t.mimetype||"",e.filehash=this.decodeBytes(t.fileSha256),e.encFilehash=this.decodeBytes(t.fileEncSha256),e.mediaKey=(0,y.default)(this.decodeBytes(t.mediaKey)),e.mediaKeyTimestamp=null!=t.mediaKeyTimestamp?t.mediaKeyTimestamp:d.default.globalUnixTime(),e.height=t.height||0,e.width=t.width||0,e.firstFrameLength=t.firstFrameLength,e.firstFrameSidecar=t.firstFrameSidecar,e.isAnimated=t.isAnimated,w(e,t)},parseContactMessageProto:function(e,t){e.type=c.default.MSG_TYPE.VCARD,e.vcardFormattedName=t.displayName,e.body=t.vcard},parseContactsArrayMessageProto:function(e,t){var r=t.contacts;e.type=c.default.MSG_TYPE.MULTI_VCARD,e.vcardFormattedName=t.displayName,e.vcardList=Array.isArray(r)?r.map((e=>({displayName:e.displayName,vcard:e.vcard}))):[]},parseLocationMessageProto:function(e,t){var r=t.name&&t.address?`${t.name}\n${t.address}`:t.name||t.address||"";e.type=c.default.MSG_TYPE.LOCATION,e.lat=void 0!==t.degreesLatitude?t.degreesLatitude:void 0,e.lng=void 0!==t.degreesLongitude?t.degreesLongitude:void 0,e.loc=r,e.body=this.decodeBytes(t.jpegThumbnail)||"",e.clientUrl=t.url},parseExtendedTextMessageProto:function(e,t){var r=t.matchedText||t.canonicalUrl||t.description||t.title;if(r){var a=P(t.canonicalUrl||""),i=P(t.matchedText||"");e.canonicalUrl=a===i||""===a?t.canonicalUrl:i}e.type=c.default.MSG_TYPE.CHAT,e.subtype=r?"url":void 0,e.body=O(t.text||""),e.matchedText=t.matchedText,e.description=t.description,e.title=t.title,e.thumbnail=this.decodeBytes(t.jpegThumbnail)||"",e.richPreviewType=t.previewType,e.doNotPlayInline=t.doNotPlayInline,e.textColor=t.textArgb,e.backgroundColor=t.backgroundArgb,e.mediaKey=this.decodeBytes(t.mediaKey),e.mediaKeyTimestamp=t.mediaKeyTimestamp,e.thumbnailDirectPath=t.thumbnailDirectPath,e.thumbnailSha256=this.decodeBytes(t.thumbnailSha256),e.thumbnailEncSha256=this.decodeBytes(t.thumbnailEncSha256),e.thumbnailHeight=t.thumbnailHeight,e.thumbnailWidth=t.thumbnailWidth;var n=p.ExtendedTextMessageFontType;if(null!=t.font)switch(t.font){case n.SANS_SERIF:case n.SERIF:case n.NORICAN_REGULAR:case n.BRYNDAN_WRITE:case n.BEBASNEUE_REGULAR:case n.OSWALD_HEAVY:e.font=t.font}},parseDocumentMessageProto:function(e,t){e.type=c.default.MSG_TYPE.DOCUMENT,e.deprecatedMms3Url=this.decodeUrl(t.url),e.directPath=t.directPath,e.mimetype=t.mimetype,e.filehash=this.decodeBytes(t.fileSha256),e.encFilehash=this.decodeBytes(t.fileEncSha256),e.size=t.fileLength||0,e.pageCount=t.pageCount||0,e.mediaKey=this.decodeBytes(t.mediaKey),e.mediaKeyTimestamp=null!=t.mediaKeyTimestamp?t.mediaKeyTimestamp:d.default.globalUnixTime(),e.filename=(0,l.cleanIncomingFilename)(t.fileName||t.title),e.caption=e.filename,e.body=this.decodeBytes(t.jpegThumbnail)||"",e.isVcardOverMmsDocument=Boolean(t.contactVcard)&&e.size<=1024*S.default.vcardMaxSizeKb,e.thumbnailDirectPath=t.thumbnailDirectPath,e.thumbnailSha256=this.decodeBytes(t.thumbnailSha256),e.thumbnailEncSha256=this.decodeBytes(t.thumbnailEncSha256),e.thumbnailHeight=t.thumbnailHeight,e.thumbnailWidth=t.thumbnailWidth},parseAudioMessageProto:function(e,t){e.type=t.ptt?c.default.MSG_TYPE.PTT:c.default.MSG_TYPE.AUDIO,e.deprecatedMms3Url=this.decodeUrl(t.url),e.directPath=t.directPath,e.mimetype=t.mimetype,e.filehash=this.decodeBytes(t.fileSha256),e.encFilehash=this.decodeBytes(t.fileEncSha256),e.size=t.fileLength||0,e.duration=`${t.seconds||0}`,e.mediaKey=this.decodeBytes(t.mediaKey),e.mediaKeyTimestamp=null!=t.mediaKeyTimestamp?t.mediaKeyTimestamp:d.default.globalUnixTime(),e.streamingSidecar=t.streamingSidecar,w(e,t)},parseVideoMessageProto:function(e,t){e.type=c.default.MSG_TYPE.VIDEO,e.deprecatedMms3Url=this.decodeUrl(t.url),e.directPath=t.directPath,e.mimetype=t.mimetype,e.filehash=this.decodeBytes(t.fileSha256),e.encFilehash=this.decodeBytes(t.fileEncSha256),e.size=t.fileLength||0,e.height=t.height,e.width=t.width,e.duration=`${t.seconds||0}`,e.mediaKey=this.decodeBytes(t.mediaKey),e.mediaKeyTimestamp=null!=t.mediaKeyTimestamp?t.mediaKeyTimestamp:d.default.globalUnixTime(),e.caption=O(t.caption),e.body=this.decodeBytes(t.jpegThumbnail)||"",e.isGif=t.gifPlayback,e.gifAttribution=t.gifAttribution,e.streamingSidecar=t.streamingSidecar,e.interactiveAnnotations=t.interactiveAnnotations,e.isViewOnce=!0===t.viewOnce,e.thumbnailDirectPath=t.thumbnailDirectPath,e.thumbnailSha256=this.decodeBytes(t.thumbnailSha256),e.thumbnailEncSha256=this.decodeBytes(t.thumbnailEncSha256),w(e,t)},parseContextInfoProto:function(e,t,r){var a=t.quotedMessage,i=t.mentionedJid;e.quotedMsg=a&&this.parseMsgProto(a,{type:c.default.MSG_TYPE.UNKNOWN}),e.quotedMsg&&"payment"===e.quotedMsg.type&&r&&__LOG__(2)`parseContextInfoProto: payment not supported`,e.quotedStanzaID=t.stanzaId,e.quotedParticipant=this.decodeJid(t.participant),e.quotedRemoteJid=this.decodeJid(t.remoteJid),e.mentionedJidList=Array.isArray(i)?i.map(this.decodeJid):i,e.isForwarded=t.isForwarded,e.forwardingScore=t.forwardingScore,null!=t.expiration&&(e.ephemeralDuration=t.expiration),null!=t.ephemeralSettingTimestamp&&(e.ephemeralSettingTimestamp=t.ephemeralSettingTimestamp),null!=t.ephemeralSharedSecret&&(e.ephemeralSharedSecret=t.ephemeralSharedSecret)},parseCtwaContextProto:function(e,t){var r=v.findLink(t.sourceUrl||"",!1,e.from);e.ctwaContext={sourceUrl:t.sourceUrl,description:t.body,title:t.title,thumbnail:t.thumbnail?this.decodeBytes(t.thumbnail):null,thumbnailUrl:t.thumbnailUrl,mediaType:t.mediaType,mediaUrl:t.mediaUrl,isSuspiciousLink:r&&r.suspiciousCharacters&&r.suspiciousCharacters.size>0}},_getMsgKey:function(e,t){if(!e)throw new Error("parseProtocolMessageProto: no message key is defined for protocol message");var{id:r}=e;if(!r)throw new Error("parseProtocolMessageProto: no message id is defined for protocol message");return _.default.supportsFeature(_.default.F.MD_BACKEND)?new E.default({id:r,fromMe:t.id.fromMe,remote:t.id.remote,participant:t.id.participant}):new E.default({id:r,fromMe:e.fromMe,remote:this.decodeJid(e.remoteJid),participant:this.decodeJid(e.participant)})},parseProtocolMessageProto:function(e,t,r){if("relay"===r||t.type===p.ProtocolMessageType.EPHEMERAL_SETTING){var{key:a,type:i}=t,n=null;if(e.type=c.default.MSG_TYPE.PROTOCOL,null!=i)switch(i){case p.ProtocolMessageType.REVOKE:n=this._getMsgKey(a,e),e.protocolMessageKey=n,e.subtype="revoke";break;case p.ProtocolMessageType.EPHEMERAL_SETTING:e.subtype="ephemeral_setting",e.ephemeralDuration=t.ephemeralExpiration;break;case p.ProtocolMessageType.EPHEMERAL_SYNC_RESPONSE:e.subtype="ephemeral_sync_response",e.ephemeralDuration=t.ephemeralExpiration,e.ephemeralSettingTimestamp=t.ephemeralSettingTimestamp;break;case p.ProtocolMessageType.HISTORY_SYNC_NOTIFICATION:e.subtype="history_sync_notification";var{historySyncNotification:s}=t;if(s){var o={directPath:s.directPath,encFilehash:this.decodeBytes(s.fileEncSha256),filehash:this.decodeBytes(s.fileSha256),mediaKey:this.decodeBytes(s.mediaKey),type:"md-msg-hist"};e.historySyncMetaData={historySyncNotification:t.historySyncNotification,downloadOptions:o}}break;case p.ProtocolMessageType.APP_STATE_SYNC_KEY_REQUEST:case p.ProtocolMessageType.APP_STATE_SYNC_KEY_SHARE:case p.ProtocolMessageType.MSG_FANOUT_BACKFILL_REQUEST:case p.ProtocolMessageType.INITIAL_SECURITY_NOTIFICATION_SETTING_SYNC:case p.ProtocolMessageType.APP_STATE_FATAL_EXCEPTION_NOTIFICATION:e.subtype="unknown"}}},decodeJid:function(e){return b.default.isWid(e)?(0,C.createWid)(e):e},decodeUrl:function(e){return e&&!e.includes("/u/")?e:void 0},decodeBytes:function(e){return e?(0,o.encodeB64)(e):void 0},parseDeviceSentMessage:function(e,t,r){var a=this.decodeJid(t.destinationJid);e.id.remote=a,e.to=a,this.parseMsgProto(t.message,e,r)},parseTemplateMessage:function(e,t){var{documentMessage:r,imageMessage:a,locationMessage:i,videoMessage:n}=t;e.isFromTemplate=!0,r?this.parseDocumentMessageProto(e,r):a?this.parseImageMessageProto(e,a):i?this.parseLocationMessageProto(e,i):n?this.parseVideoMessageProto(e,n):(e.type=c.default.MSG_TYPE.CHAT,t.hydratedContentText&&(e.body=O(t.hydratedContentText))),t.hydratedButtons&&this.parseButtons(e,t),t.hydratedContentText&&(e.caption=O(t.hydratedContentText)),t.hydratedFooterText&&(e.footer=O(t.hydratedFooterText)),t.hydratedTitleText&&(e.title=O(t.hydratedTitleText))},parseButtons:function(e,t){var{hydratedButtons:r}=t;r.length&&(e.hydratedButtons=r)},parseTemplateButtonReplyMessage:function(e,t){e.body=O(t.selectedDisplayText),e.selectedIndex=t.selectedIndex,e.selectedId=t.selectedId},parseProductMessageProto:function(e,t){var{product:r}=t;r&&(r.productImage&&this.parseImageMessageProto(e,r.productImage),e.type=c.default.MSG_TYPE.PRODUCT,e.businessOwnerJid=t.businessOwnerJid,e.productId=r.productId,e.currencyCode=r.currencyCode,e.priceAmount1000=r.priceAmount1000,e.salePriceAmount1000=r.salePriceAmount1000,e.retailerId=r.retailerId,e.url=r.url,e.productImageCount=r.productImageCount,e.title=r.title,e.description=r.description)},parseLiveLocationMessageProto:function(){__LOG__(2)`parseLiveLocationMessageProto: not supported`},_getPaymentRequestMessageKey:function(e,t){var{id:r}=e;if(!r)throw new Error("parseProtocolMessageProto: no message id is defined for payment request message key");var a=!t.id.fromMe;return t.id.remote.isGroup()&&(t.id.fromMe||this.decodeJid(e.participant).equals((0,f.getMeUser)())||(a=!1)),new E.default({fromMe:a,remote:t.id.remote,id:r,participant:this.decodeJid(e.participant)})},parseSendPaymentMessageProto:function(){__LOG__(2)`parseSendPaymentMessageProto: not supported`},parseRequestPaymentMessageProto:function(){__LOG__(2)`parseRequestPaymentMessageProto: not supported`},_getDeclinePaymentRequestMessageKey:function(e,t){if(!e)throw new Error("parseProtocolMessageProto: no message key is defined for decline payment request message");var r,{id:a}=e;if(!a)throw new Error("parseProtocolMessageProto: no message id is defined for decline payment request message");if(t.id.remote.isGroup()){if(!t.id.fromMe&&!this.decodeJid(e.participant).equals((0,f.getMeUser)())&&"send"!==t.subtype)return null;r=this.decodeJid(e.participant)}return new E.default({fromMe:!t.id.fromMe,remote:t.id.remote,id:a,participant:r})},parseDeclinePaymentRequestMessageProto:function(){__LOG__(2)`parseRequestPaymentMessageProto: not supported`},_getCancelPaymentRequestMessageKey:function(e,t){if(!e)throw new Error("parseProtocolMessageProto: no message key is defined for cancel payment request message");var{id:r}=e;if(!r)throw new Error("parseProtocolMessageProto: no message id is defined for cancel payment request message");var a=void 0;if(t.id.remote.isGroup())if(a=t.id.participant,t.id.fromMe)a=this.decodeJid(t.author);else if(!this.decodeJid(e.participant).equals((0,f.getMeUser)()))return null;return new E.default({id:r,fromMe:t.id.fromMe,remote:t.id.remote,participant:a})},parseCancelPaymentRequestMessageProto:function(){__LOG__(2)`parseDeclinePaymentRequestMessageProto: not supported`},parseGroupInviteMessageProto:function(){__LOG__(2)`parseGroupInviteMessageProto: not supported`},parseOrderMessageProto:function(e,t){e.type=c.default.MSG_TYPE.ORDER,e.thumbnail=this.decodeBytes(t.thumbnail),e.message=t.message||"",e.orderId=t.orderId,e.itemCount=t.itemCount||0,e.status=t.status,e.surface=t.surface,e.sellerJid=t.sellerJid,e.orderTitle=t.orderTitle||"",e.token=t.token||"",e.totalAmount1000=t.totalAmount1000,e.totalCurrencyCode=t.totalCurrencyCode,e.body=""},parseListMessageProto:function(e,t){var r,a;S.default.webListMessage&&t.listType===p.ListMessageListType.SINGLE_SELECT||(0,m.productListMessagesEnabled)()&&t.listType===p.ListMessageListType.PRODUCT_LIST?(e.type=c.default.MSG_TYPE.LIST,e.list=t,e.footer=t.footerText,t.listType===p.ListMessageListType.PRODUCT_LIST&&(e.businessOwnerJid=null===(r=t.productListInfo)||void 0===r?void 0:r.businessOwnerJid,e.productListItemCount=null===(a=t.productListInfo)||void 0===a?void 0:a.productSections.reduce(((e,t)=>e+t.products.length),0))):(t.listType===p.ListMessageListType.PRODUCT_LIST&&(0,m.productListMessageFallbackEnabled)()&&(e.subtype="phone_only_feature"),e.type=c.default.MSG_TYPE.UNKNOWN)},parseListResponseMessageProto:function(e,t){if(S.default.webListMessage&&t.listType===p.ListResponseMessageListType.SINGLE_SELECT){e.type=c.default.MSG_TYPE.LIST_RESPONSE,e.listResponse=(0,n.default)((0,n.default)({},t),{},{contextInfo:void 0});var r=t.title||"";t.description&&(r+="\n"+t.description),e.body=O(r)}},parseButtonsResponseMessageProto:function(e,{selectedDisplayText:t,selectedButtonId:r,type:a}){(0,m.buttonsMessagesEnabled)()&&a===p.ButtonsResponseMessageType.DISPLAY_TEXT?(e.type=c.default.MSG_TYPE.BUTTONS_RESPONSE,e.selectedButtonId=r,e.body=O(t)):e.type=c.default.MSG_TYPE.UNKNOWN},parseViewOnceFutureProofMessageProto:function(e,t){S.default.viewOnceRead?this.parseMsgProto(t.message,e):(e.type=c.default.MSG_TYPE.UNKNOWN,e.subtype="phone")},parseEphemeralFutureProofMessageProto:function(e,t){S.default.ephemeralMessages?this.parseMsgProto(t.message,e):(e.type=c.default.MSG_TYPE.UNKNOWN,e.subtype="phone")},parseButtonsMessageProto:function(e,t){if((0,m.buttonsMessagesEnabled)()){var{documentMessage:r,imageMessage:a,locationMessage:i,videoMessage:s,contentText:o,footerText:l,text:d,buttons:u,headerType:h}=t;if([p.ButtonsMessageHeaderType.EMPTY,p.ButtonsMessageHeaderType.TEXT,p.ButtonsMessageHeaderType.DOCUMENT,p.ButtonsMessageHeaderType.IMAGE,p.ButtonsMessageHeaderType.VIDEO,p.ButtonsMessageHeaderType.LOCATION].includes(h)){if(u.some((e=>e.type===p.ButtonType.NATIVE_FLOW)))return e.type=c.default.MSG_TYPE.UNKNOWN,void(e.subtype="phone_only_feature");a?this.parseImageMessageProto(e,a):r?this.parseDocumentMessageProto(e,r):i?this.parseLocationMessageProto(e,(0,n.default)((0,n.default)({},i),{},{name:void 0,address:void 0})):s?this.parseVideoMessageProto(e,s):(e.type=c.default.MSG_TYPE.CHAT,o&&(e.body=O(o)),d&&(e.title=O(d))),e.isDynamicReplyButtonsMsg=!0,null!=h&&(e.headerType=h),u&&(e.dynamicReplyButtons=u),o&&(e.caption=O(o)),l&&(e.footer=O(l))}else e.type=c.default.MSG_TYPE.UNKNOWN}else e.type=c.default.MSG_TYPE.UNKNOWN}};t.default=M},58443:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.typeAttributeFromProtobuf=function e(t){if(t.ephemeralMessage){var{message:r}=t.ephemeralMessage;return r?e(r):"text"}if(t.deviceSentMessage){var{message:a}=t.deviceSentMessage;return a?e(a):"text"}return t.conversation||t.extendedTextMessage||t.templateButtonReplyMessage||t.protocolMessage?"text":"media"},t.protobufToMsgKey=function(e){var{fromMe:t,id:r,participant:a,remoteJid:i}=e;(0,n.default)(null!=t&&null!=i&&null!=r,"fromMe, remoteJid, and id should be set");var l=null!=a&&(0,d.isWidlike)(a)?(0,d.createWid)(a):void 0,u=(0,d.createWid)(i);(u.isGroup()||u.isBroadcast())&&t&&(l=(0,s.getMaybeMeUser)());return new o.default({fromMe:t,id:r,participant:l,remote:(0,d.createWid)(i)})},t.msgKeyToProtobuf=function(e){var t;return{fromMe:e.fromMe,id:e.id,participant:e.fromMe||null===(t=e.participant)||void 0===t?void 0:t.toString({legacy:!0}),remoteJid:e.remote.toString({legacy:!0})}},t.parseMsgPaymentInfo=function(e,t){t&&(e.paymentStatus=t.status,e.paymentTxnStatus=t.txnStatus,e.paymentCurrency=t.currency||"",e.paymentAmount1000=(0,l.default)((0,i.maybeNumberOrThrowIfTooLarge)(t.amount1000),"maybeNumberOrThrowIfTooLarge(paymentInfo.amount1000)"),e.paymentMessageReceiverJid=(0,d.createWid)((0,l.default)(t.receiverJid,"paymentInfo.receiverJid")),e.paymentExpiryTimestamp=(0,i.maybeNumberOrThrowIfTooLarge)(t.expiryTimestamp),e.paymentTransactionTimestamp=(0,l.default)((0,i.maybeNumberOrThrowIfTooLarge)(t.transactionTimestamp),"maybeNumberOrThrowIfTooLarge(paymentInfo.transactionTimestamp)"))};var i=r(25364),n=a(r(47677)),s=r(66239),o=a(r(83746)),l=a(r(21830)),d=r(25054)},68439:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.typeIsMms=function(e){return"image"===e.type||"video"===e.type||"audio"===e.type||"ptt"===e.type||"sticker"===e.type||"document"===e.type||"product"===e.type||"protocol"===e.type&&"history_sync_notification"===e.subtype},t.msgMatchesType=function(e,t){switch(t){case"text":return e.type===o.default.MSG_TYPE.CHAT&&"url"!==e.subtype;case"image":return e.type===o.default.MSG_TYPE.IMAGE;case"video":return e.type===o.default.MSG_TYPE.VIDEO&&!e.isGif;case"gif":return e.type===o.default.MSG_TYPE.VIDEO&&e.isGif;case"audio":return e.type===o.default.MSG_TYPE.AUDIO;case"ptt":return e.type===o.default.MSG_TYPE.PTT;case"document":return e.type===o.default.MSG_TYPE.DOCUMENT;case"location":return e.type===o.default.MSG_TYPE.LOCATION;case"vcard":return e.type===o.default.MSG_TYPE.VCARD||e.type===o.default.MSG_TYPE.MULTI_VCARD;case"url":return e.type===o.default.MSG_TYPE.CHAT&&"url"===e.subtype;case"sticker":return e.type===o.default.MSG_TYPE.STICKER;case void 0:default:return!1}},t.createQuotedMsg=function(e){if(!e)return null;var t=new f.default({from:e.from,to:e.to,id:e.id,participant:e.participant,selfDir:e.self});return e.id=t,new(0,r(36169).default)(e).safe()},t.getOriginalQuotedMsgIfPossible=function(e,t){var r;if(!e)return e;var a=null===(r=t.get(e.id))||void 0===r?void 0:r.safe();return a&&!a.asRevoked?a:e},t.listMsgCanRender=function(e){var t;return(null===(t=e.list)||void 0===t?void 0:t.listType)!==l.ListMessageListType.PRODUCT_LIST||(0,c.productListMessagesEnabled)()&&!_.default.webProductListMessageRenderKillSwitch},t.getBroadcastFanoutKeys=g,t.broadcastFanout=function(e){var t;if(!e.invis){var a=g(e);a&&(t=a.map((e=>e.remote)),a.forEach((t=>{var a=r(30528).default;if(!a.some((0,n.default)({id:t}))){var i=S(e);i.to=t.remote,i.id=t,i.broadcast=!0;var s=a.add(i,{merge:!0});r(85030).default.find(t.remote).then((function(e){_.default.ephemeralMessages&&s.forEach((t=>{if(t.type!==o.default.MSG_TYPE.PROTOCOL){e.isEphemeralSettingOn()&&(t.ephemeralDuration=e.getEphemeralSetting());var r=e.getEphemeralSettingTimestamp();null!=r&&(t.ephemeralSettingTimestamp=r)}})),v(s,e,!0)}))}})))}return t},t.addRecordsToChat=v,t.isNotification=function(e,t){switch(e){case o.default.MSG_TYPE.GROUP_NOTIFICATION:case o.default.MSG_TYPE.GP2:case o.default.MSG_TYPE.BROADCAST_NOTIFICATION:case o.default.MSG_TYPE.NOTIFICATION:case o.default.MSG_TYPE.NOTIFICATION_TEMPLATE:case o.default.MSG_TYPE.E2E_NOTIFICATION:case o.default.MSG_TYPE.CALL_LOG:return!0;case o.default.MSG_TYPE.PROTOCOL:return"ephemeral_setting"===t;default:return!1}},t.eventTypeFromMsgType=function(e){var t,r=e.type,a=e.subtype,i=(0,u.getMaybeMeUser)();t=r===o.default.MSG_TYPE.GP2||r===o.default.MSG_TYPE.GROUP_NOTIFICATION?"subject"===a?"n":"add"===a||"invite"===a?e.recipients&&m.default.equals(e.recipients[0],i)?"s":"i":"remove"===a?e.recipients&&m.default.equals(e.recipients[0],i)?"n":"i":"create"===a?"n":"i":r===o.default.MSG_TYPE.BROADCAST_NOTIFICATION||r===o.default.MSG_TYPE.NOTIFICATION||r===o.default.MSG_TYPE.E2E_NOTIFICATION?"create"===a?"n":"i":r===o.default.MSG_TYPE.GROUPS_V4_INVITE&&e.from.equals(i)?"i":r===o.default.MSG_TYPE.CALL_LOG?"n":e.broadcast?m.default.isBroadcast(e.id.remote)?"n":"i":r===o.default.MSG_TYPE.REVOKED?"i":m.default.isPSA(e.id.remote)?e.ack===o.default.ACK.RECEIVED?"d":"a":r===o.default.MSG_TYPE.CIPHERTEXT||r===o.default.MSG_TYPE.OVERSIZED?"a":r===o.default.MSG_TYPE.NOTIFICATION_TEMPLATE||r===o.default.MSG_TYPE.PROTOCOL&&"ephemeral_setting"===a?"i":"d";return t};var i=a(r(72960)),n=a(r(45126)),s=a(r(16760)),o=a(r(23045)),l=r(99429),d=r(33576),u=r(66239),c=r(9690),p=a(r(54884)),h=r(14784),f=a(r(83746)),_=a(r(54559)),m=a(r(43926));function g(e){var t,a,i;if(e instanceof r(36169).default)a=e,i=e.id;else{if(!(e instanceof f.default))return void __LOG__(3)`model:msgs:broadcastFanout: unknown msgOrKey: ${String(e)}`;i=e}if(!m.default.isStatusV3(i.remote)){if(a&&a.recipients&&0!==a.recipients.length)t=a.recipients;else{var n=r(25120).default.get(i.remote);n?t=(0,s.default)(S(n.participants),"id"):__LOG__(2)`model:msgs:broadcastFanout no group_metadata rec for bclist, cant fanout: ${i.remote.toString()}`}return t?t.map((e=>new f.default({fromMe:i.fromMe,remote:e,id:i.id}))):void 0}}function v(e,t,a,i,n,s){var o=i||t.msgs;if(0!==e.length){var l=o===t.msgs;if(s)if(l)__LOG__(2)`models:msg:store:resetMostRecentMsgs .msgs === cmc !`,E(t,o,e);else l=!0,E(t,o,e).then((()=>{var e=new(0,r(13649).default);e.replace(t.msgs),t.msgChunks.push(e),t.replaceMsgsCollection(o),t.msgs.trigger("change:last",t.msgs.last())}));else a?l?E(t,o,e):y(o,e):y(o,e,{at:0,silent:e.every(T)});var d=r(30528).default;if(a&&l||!d.lastReceivedReceipt[t.id])for(var u=e.length-1;u>=0;u--){var c=e[u],p=c.id;if(p.fromMe&&!c.isNotification){d.updateLastReceipt(p.remote,c.t);break}}if(a&&l||!d.lastReceivedPaymentTransaction[t.id])for(var h=e.length-1;h>=0;h--){var f=e[h],_=f.id;f.paymentTransactionTimestamp&&d.updateLastTransactionTime(_.remote,f.paymentTransactionTimestamp)}var m=n;m&&!t.unreadMsgAnchor&&(t.disableUnreadAnchor?t.disableUnreadAnchor=!1:t.unreadMsgAnchor=e.find((function(e){return e.id.toString()===m.toString()})))}}function E(e,t,r){var a=(0,i.default)(r,(e=>!!e));return a?(y(t,r),(0,h.setLastReceivedKey)(e.id,a.id).then((()=>{e.lastReceivedKey=a.id}))):Promise.resolve()}function y(e,t,r){try{e.add(t,r)}catch(e){if(!(e instanceof d.LogoutDrop))throw e;__LOG__(3)`setRecords LogoutDrop: ${e.toString()}`}}function S(e){return null!=e&&"object"==typeof e?JSON.parse(JSON.stringify(e),p.default):e}function T(e){return"i"===e.eventType}},33014:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.GLOBAL_MUTE=void 0;var n=i(r(19034)),s=a(r(2784)),o=r(8507),l=i(r(84621)),d=a(r(99778)),u=i(r(13277)),c=a(r(24461)),p=i(r(38637)),h=r(36766),f=r(61864),_=i(r(43926)),m="global_mute";t.GLOBAL_MUTE=m;class g extends d.default{constructor(...e){super(...e),this.id=(0,d.prop)(),this.expiration=(0,d.prop)(0),this._unmuteTimer=(0,d.session)(),this.promises=(0,d.session)((function(){return{}})),this.isMuted=(0,d.derived)(this._isMuted,["expiration"])}_isMuted(){return!!this.expiration}initialize(){super.initialize(),null!=this.expiration&&0!==this.expiration&&this.mute(this.expiration)}setMute(e,t){(e||this.expiration)&&e!==this.expiration&&(e?this.mute(e,t):this.unmute(t))}mute(e,t,r){var a=e;if(!(0,f.isNumber)(a))return __LOG__(2)`models:Mute:mute called with invalid expiration ${a}`,Promise.reject(new c.ActionError);(a=Math.round(a))>2e9&&__LOG__(2)`models:Mute:mute called with wrong units?${this.id.toString()} exp:${a}`;var i=function(){if(this.isMuted&&(l.default.clearTimeout(this._unmuteTimer),this.unset("_unmuteTimer")),-1===a)__LOG__(2)`models:Mute:mute ${this.id.toString()} muted, no expiration`;else{var e=a-(0,n.default)().unix();__LOG__(2)`models:Mute:mute ${this.id.toString()} duration:${e}`,this._unmuteTimer=l.default.setGlobalTimeout(this.unmute.bind(this),1e3*a)}this.set({expiration:a})}.bind(this),d=_.default.isGroup(this.id);if(t){if(this.promises.mute)return this.promises.mute;var m=this.promises.mute=(0,h.sendConversationMute)(this.id,a,this.expiration),g=d?new o.ActionType(p.default.t(120)):new o.ActionType(p.default.t(75)),v=r||(0,o.genId)(),E=this.promises.mute.catch((()=>{__LOG__(3)`models:Mute:mute dropped`;var e=d?p.default.t(118):p.default.t(73);throw new o.ActionType(e,{actionText:p.default.t(199),actionHandler:this.mute.bind(this,a,t,v)})})).then((e=>{if(200===e.status){var r=d?p.default.t(119):p.default.t(74);return new o.ActionType(r,{actionText:p.default.t(203),actionHandler:this.unmute.bind(this,t,v)})}if(e.status>=400)throw d?new o.ActionType(p.default.t(118)):new o.ActionType(p.default.t(73))}));return u.default.openToast(s.createElement(o.ActionToast,{id:v,initialAction:g,pendingAction:E})),m.then((function(e){200!==e.status||e._duplicate||i()})).finally((()=>{this.promises.mute=null}))}return i(),Promise.resolve()}canMute(){var e=!1;if(_.default.isGroup(this.id)){var t=r(25120).default.get(this.id);t&&(e=t.participants.iAmMember())}return e||_.default.isUser(this.id)}_clearUnmuteTimer(){l.default.clearTimeout(this._unmuteTimer),this.unset("_unmuteTimer"),this.expiration=0}unmute(e,t){var r=function(){__LOG__(2)`models:Mute:unmute ${this.id.toString()}`,this._clearUnmuteTimer()}.bind(this),a=_.default.isGroup(this.id);if(e){if(this.promises.unmute)return this.promises.unmute;var i=this.promises.unmute=(0,h.sendConversationMute)(this.id,0,this.expiration),n=a?new o.ActionType(p.default.t(127)):new o.ActionType(p.default.t(86)),l=t||(0,o.genId)(),d=this.promises.unmute.catch((()=>{__LOG__(3)`models:Mute:unmute dropped`;var t=a?p.default.t(125):p.default.t(84);return Promise.reject(new o.ActionType(t,{actionText:p.default.t(199),actionHandler:this.unmute.bind(this,e,l)}))})).then((e=>{if(200===e.status)return a?new o.ActionType(p.default.t(126)):new o.ActionType(p.default.t(85));if(e.status>=400)throw a?new o.ActionType(p.default.t(125)):new o.ActionType(p.default.t(84))}));return u.default.openToast(s.createElement(o.ActionToast,{id:l,initialAction:n,pendingAction:d})),i.then((function(e){200!==e.status||e._duplicate||r()})).finally((()=>{this.promises.unmute=null}))}return r(),Promise.resolve()}delete(){super.delete(),this.getCollection().remove(this.id),this._clearUnmuteTimer()}getCollection(){return r(96997).default}}g.Proxy="mute",g.idClass=_.default,g.allowedIds=[m];var v=(0,d.defineModel)(g);t.default=v},96997:(e,t,r)=>{"use strict";var a=r(14859),i=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.MuteCollection=void 0;var n=i(r(18641)),s=a(r(79435)),o=r(66239),l=a(r(20468)),d=i(r(33014)),u=!0,c=!0,p=!0,h=!1,f=!1;class _ extends n.default{initializeFromCache(e){this.add(e),this.setGlobalNotifications((0,o.getGlobalNotifications)()),this.setGlobalSounds((0,o.getGlobalSounds)()),this.setGlobalPreviews((0,o.getGlobalPreviews)()),this.setCollapseMuted((0,o.getCollapseMuted)()),this.setOutgoingMessageSound((0,o.getOutgoingMessageSound)())}saveToCache(){if(s.default.shouldSaveToCache()&&!l.default.supportsFeature(l.default.F.MD_BACKEND)){var e=this.constructor.cachePolicy.id;__LOG__(2)`models:mute:cache-save: ${String(e)}`;var t=this.get(d.GLOBAL_MUTE);t?(0,o.setCollection)(e,t.toJSON()):__LOG__(3)`models:mute:cache-save: globalMuteModel does not exist`}}globalMute(){var e=this.get(d.GLOBAL_MUTE);return e||this.add({id:d.GLOBAL_MUTE})[0]}getGlobalSounds(){return u}setGlobalSounds(e){u=e,(0,o.setGlobalSounds)(e)}getGlobalNotifications(){return c}setGlobalNotifications(e){c=e,(0,o.setGlobalNotifications)(e)}getGlobalPreviews(){return p}setGlobalPreviews(e){p=e,(0,o.setGlobalPreviews)(e)}getCollapseMuted(){return h}setCollapseMuted(e){h=e,(0,o.setCollapseMuted)(e),this.trigger("change:collapseMuted",h)}getOutgoingMessageSound(){return f}setOutgoingMessageSound(e){f=e,(0,o.setOutgoingMessageSound)(e)}handle(e){e.forEach((e=>{var t=r(85030).default.get(e.id);t&&"mute"===e.type&&t.mute.setMute(e.muteExpiration)}))}}t.MuteCollection=_,_.model=d.default,_.cachePolicy={id:"mute",policy:n.CACHE_POLICY.LOAD,delay:1e3};var m=new _;t.default=m},79569:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(r(70417)),s=r(56150),o=r(71436),l=i(r(77884)),d=r(20595),u=i(r(45026)),c=r(3599),p=i(r(81076)),h=a(r(99778)),f=i(r(79435)),_=i(r(23045)),m=r(33576),g=r(87243),v=i(r(127)),E=r(66239),y=i(r(20468)),S=i(r(38637)),T=i(r(84161)),A=i(r(21830)),b=i(r(54559)),C=i(r(22006));class P extends((0,o.customError)("NoticeJsonParseError")){}var O=["logout","refresh"],w=(0,s.createTimer)({algo:{type:"constant",delay:432e5}}),M=(0,s.createTimer)({algo:{type:"fibonacci",first:0,second:1},max:18e6});class I extends h.default{constructor(...e){super(...e),this.id=(0,h.prop)(),this.noticeId=(0,h.prop)(),this.blocking=(0,h.prop)(),this.policyVersion=(0,h.prop)(),this.banner=(0,h.prop)(),this.blockingModal=(0,h.prop)(),this.shouldShowButterBar=(0,h.session)(!0),this.backgroundFetches=(0,h.session)()}initialize(){super.initialize(),this.fetchNoticeData=this.fetchNoticeData.bind(this),this.listenTo(S.default,"locale_change",this.fetchNoticeData)}dismissButterBarNotice(){0!==b.default.greenAlertBannerDuration&&(new T.default.UserNotice({userNoticeId:this.noticeId,userNoticeContentVersion:this.policyVersion,userNoticeEvent:T.default.USER_NOTICE_EVENT.BANNER_DISMISS}).commit(),this._dismissAndStartButterBarTimer(b.default.greenAlertBannerDuration),(0,E.setNoticeBannerClosedAt)(Date.now()))}_dismissAndStartButterBarTimer(e){this.shouldShowButterBar=!1,this._clearButterBarTimer(),this._butterBarTimeoutHandler=window.setTimeout((()=>{this.shouldShowButterBar=!0,(0,E.setNoticeBannerClosedAt)(null)}),e)}delete(){this.resetNotice(),super.delete()}sanitizeBlockingModal(e){if(!e)return null;var t=e=>{if(!e)return null;var t=e.action;if(t){var r=O.find((e=>`whatsapp:user-notice?action=${e}`===t));if(r)return e.action=r,e;__LOG__(3)`Notice: Unknown action type ${t}`}return null};return e.primaryButton=t(e.primaryButton),e.secondaryButton=t(e.secondaryButton),e}_isoFromCallingCode(e){var t=parseInt(e,10),r=l.default[t];return(0,A.default)(r,"isoFromCC")}validateResponseFields(e,t){e.forEach((e=>{if(!(e in t))throw new Error(`Missing field ${e} in notice content.`)}))}extractBlockingModal(e){if(e)return this.validateResponseFields(["icon","iconDescription","title","body","primaryButton"],e),this.validateResponseFields(["light","dark"],e.icon),{icon:{light:e.icon.light,dark:e.icon.dark},iconSvg:{light:"",dark:""},iconDescription:e.iconDescription,title:e.title,body:e.body,primaryButton:e.primaryButton,secondaryButton:e.secondaryButton}}extractBanner(e){if(e)return this.validateResponseFields(["icon","iconDescription","text"],e),this.validateResponseFields(["light","dark"],e.icon),{icon:{light:e.icon.light,dark:e.icon.dark},iconDescription:e.iconDescription,text:e.text,iconSvg:{light:"",dark:""}}}extractUserNoticeContent(e){var{policyVersion:t}=e;if(!t)throw new Error("Missing field policyVersion in notice content.");__LOG__(2)`Notice:fetchNoticeData successful for policyVersion ${t}`;var r=e.banner&&this.extractBanner(e.banner),a=e["blocking-modal"]&&this.extractBlockingModal(e["blocking-modal"]),i=a&&this.sanitizeBlockingModal(a);this.set({policyVersion:t,blockingModal:i,banner:r}),this.makeIconFetch(r,i)}resetBackgroundFetches(){var e;null===(e=this.backgroundFetches)||void 0===e||e.forEach((e=>{__LOG__(2)`Notice: aborting fetches`,e.abort()}))}resetNotice(){this.resetBackgroundFetches(),this.unset(["banner","blocking","blockingModal","noticeId","policyVersion"]),(0,E.setNoticeId)(null),(0,E.setNoticeBannerClosedAt)(null),this._clearButterBarTimer(),this.shouldShowButterBar=!0}_clearButterBarTimer(){var e=this._butterBarTimeoutHandler;null!=e&&window.clearTimeout(e)}fetchNoticeData(){if(this.noticeId&&y.default.supportsFeature(y.default.F.USER_NOTICE)){var e,t;this.resetBackgroundFetches(),this.set({blockingModal:void 0,banner:void 0});var r=(0,E.getMeUser)(),a=(0,d.findCC)(r.user),i=this._isoFromCallingCode(a),n=C.default.build(_.default.NOTICE_CONTENT_ENDPOINT_URL,{id:this.noticeId,lg:null!==(e=f.default.lg)&&void 0!==e?e:"zz",lc:null!==(t=f.default.lc)&&void 0!==t?t:"ZZ",cc:i,platform:f.default.isSMB?"smbweb":"web"});this.makeContentFetch(n)}}_shouldUpdateVersion(e,t){return null==e||null!=t&&t>e}handleResponse(e){if(y.default.supportsFeature(y.default.F.USER_NOTICE))if(e.length){var{blocking:t,id:r,version:a}=e[0],i=this.noticeId,n=this._shouldUpdateVersion(this.policyVersion,a);__LOG__(2)`Notice: received notice id: ${r}, blocking: ${t}, version: ${a}`,this.set({blocking:t,noticeId:r,policyVersion:n?a:this.policyVersion}),(r!==i||n)&&this.fetchNoticeData(),r!==(0,E.getNoticeId)()&&((0,E.setNoticeId)(r),(0,E.setNoticeBannerClosedAt)(null),this._clearButterBarTimer(),this.shouldShowButterBar=!0),e.length>1&&(__LOG__(4,void 0,new Error,!0)`Notice: more than one notice from phone response`,SEND_LOGS("notice-unallowed-length"))}else __LOG__(2)`Notice: received empty notice`,this.resetNotice()}sync(e){!0!==e&&this._initializeShouldShowButterBar();var t="Notice:sync"+(e?" resume":"");return __LOG__(2)`${t}`,(0,r(94407).default.queryNoticeState)(e).then((e=>{200===e.status?(__LOG__(2)`${t} success`,this.handleResponse(e.notices)):__LOG__(3)`${t} error receive status code ${e.status}`})).catchType(m.WebdDrop,(function(){__LOG__(3)`${t} dropped`})).catch((e=>{__LOG__(4,void 0,new Error,!0)`${t} failed with error: ${e}`,SEND_LOGS("notice-query-failed")}))}_initializeShouldShowButterBar(){var e=(0,E.getNoticeBannerClosedAt)();if(null!=e&&0!==b.default.greenAlertBannerDuration){var t=e+b.default.greenAlertBannerDuration-Date.now();if(t>0)return void this._dismissAndStartButterBarTimer(t)}this.shouldShowButterBar=!0}makeContentFetch(e){return this.attemptFirstFetchAndRetriesAfter(e).then((e=>{try{var t=e&&JSON.parse(e);t&&this.extractUserNoticeContent(t)}catch(e){throw new T.default.UserNoticeError({userNoticeId:this.noticeId,userNoticeContentVersion:this.policyVersion,userNoticeErrorEvent:T.default.USER_NOTICE_ERROR_EVENT.JSON_PARSE}).commit(),new P(`Received invalid User Notice content for id ${this.noticeId}`)}})).catch((e=>{if(e.name!==c.ABORT_ERROR){if("NoticeJsonParseError"!==e.name)new T.default.UserNoticeError({userNoticeId:this.noticeId,userNoticeContentVersion:this.policyVersion,userNoticeErrorEvent:T.default.USER_NOTICE_ERROR_EVENT.JSON_FETCH}).commit();this.resetNotice(),__LOG__(4,void 0,new Error,!0)`Notice: Error Message : ${e.message}`,SEND_LOGS("notice-content-error")}}))}makeIconFetch(e,t){var r=[null==e?void 0:e.icon.light,null==e?void 0:e.icon.dark,null==t?void 0:t.icon.light,null==t?void 0:t.icon.dark].map((e=>e?this.attemptFirstFetchAndRetriesAfter(e):Promise.resolve(null)));return Promise.all(r).then((([e,t,r,a])=>{var i=this.banner,s=this.blockingModal;this.banner&&e&&t&&(i=(0,n.default)((0,n.default)({},this.banner),{iconSvg:{light:e,dark:t}})),this.blockingModal&&r&&a&&(s=(0,n.default)((0,n.default)({},this.blockingModal),{iconSvg:{light:r,dark:a}})),this.set({banner:i,blockingModal:s})})).catch((e=>{e.name!==c.ABORT_ERROR&&(new T.default.UserNoticeError({userNoticeId:this.noticeId,userNoticeContentVersion:this.policyVersion,userNoticeErrorEvent:T.default.USER_NOTICE_ERROR_EVENT.IMAGE_FETCH}).commit(),__LOG__(4,void 0,new Error,!0)`Notice: Icon fetch error : ${e.message}`,SEND_LOGS("notice-icon-fetch-error"))}))}shouldRetry(e){return 404===e||429===e||e>=500}attemptFirstFetchAndRetriesAfter(e){var t,r=new u.default,a=r.signal,i=null!==(t=this.backgroundFetches)&&void 0!==t?t:[];return this.backgroundFetches=[...i,r],(0,v.default)(e,{signal:a}).then((e=>{if(!e.ok){var t=e.status;throw this.shouldRetry(t)?new g.HttpStatusCodeError(t,"noticeFetchErr"):new Error("contentResponseUnhandledError")}return e.text()})).catch((t=>{if("HttpStatusCodeError"===t.name)return this.retryFetch(e,t.status);throw t}))}retryFetch(e,t){var r,a,i,n=new u.default,s=n.signal,o=null!==(r=this.backgroundFetches)&&void 0!==r?r:[];return this.backgroundFetches=[...o,n],404===t?(i=2,a=({taskDuration:e})=>{var t=w();return Math.max(t-e,0)}):(i=8,a=({taskDuration:e})=>{var t=36e5*M();return Math.max(t-e,0)}),(0,p.default)({delay:a,retries:i,signal:s},(t=>(__LOG__(2)`Notice: Fetch Retry attempt`,(0,v.default)(e,{signal:s}).then((e=>{if(!e.ok){if(__LOG__(3)`Notice: Could Not download`,this.shouldRetry(e.status))return t(new Error("retryFailed"));throw new Error("contentResponseUnhandledError")}return e.text()})))))}}I.Proxy="notice";var R=new((0,h.defineModel)(I))({id:"default_notice_id"});t.default=R},86982:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.Chatstate=t.default=t.ChatstateCollection=void 0;var n=i(r(54073)),s=i(r(18641)),o=a(r(99778)),l=i(r(99461)),d=i(r(43805)),u=i(r(38637)),c=i(r(43926));class p extends o.default{constructor(...e){super(...e),this.id=(0,o.prop)(),this.type=(0,o.prop)(),this.t=(0,o.prop)(),this.deny=(0,o.prop)(),this.updateTime=(0,o.session)(),this.expireTimerId=(0,o.session)()}}p.Proxy="chatstate",p.idClass=c.default;var h=(0,o.defineModel)(p);t.Chatstate=h;class f extends s.default{}t.ChatstateCollection=f,f.model=h;class _ extends o.default{constructor(...e){super(...e),this.id=(0,o.prop)(),this.isOnline=(0,o.session)(!1),this.stale=(0,o.session)(!0),this.hasData=(0,o.session)(!1),this.isSubscribed=(0,o.session)(!1),this.withholdDisplay=(0,o.session)(!0),this.forceDisplay=(0,o.session)(!1),this.chatActive=(0,o.session)(!1),this.withholdDisplayTimer=(0,o.session)(),this.forceDisplayTimer=(0,o.session)(),this.chatstate=(0,o.session)(),this.chatstates=(0,o.collection)(f),this.isGroup=(0,o.derived)(this._isGroup),this.isUser=(0,o.derived)(this._isUser)}_isGroup(){return c.default.isGroup(this.id)}_isUser(){return c.default.isUser(this.id)}initialize(){super.initialize();var e=this.isGroup?{id:"",type:"unavailable"}:{id:this.id};this.addChild("chatstate",new h(e)),this.isGroup?this.listenTo(this.chatstates,"add change",(0,n.default)((()=>{var e,t=!1;this.chatstates.forEach((r=>{"composing"!==r.type&&"recording"!==r.type||e&&!(e.updateTime<r.updateTime)||(e=r),t=t||"unavailable"!==r.type})),this.set({isOnline:t}),this.chatstate.set({id:e?e.id:"",type:e?e.type:"unavailable"})}))):this.listenTo(this.chatstate,"change:type",(()=>{this.isOnline="unavailable"!==this.chatstate.type})),this.listenTo(this,"change:chatActive",this.onChatActiveChange)}delete(){super.delete(),this.getCollection().remove(this.id),this.chatstate.delete(),this.chatstates.forEach((e=>e.delete()))}reset(){this.hasData=!1,this.isGroup?this.chatstates.forEach((e=>{e.type="unavailable"})):this.isUser&&(this.chatstate.unset("t"),this.chatstate.unset("deny")),this.chatstate.set({id:this.isGroup?"":this.id,type:"unavailable",t:void 0,deny:void 0})}isActive(){var e=this.chatstate.type;return this.hasData&&("composing"===e||"recording"===e)}getFormattedString(){if(!this.hasData)return null;if(this.isGroup){var e=this.chatstate.id;if(!e)return null;var t=d.default.get(e);if(!t)return null;var r=t.formattedShortName;return"composing"===this.chatstate.type?u.default.t(1584,{participant:r}):u.default.t(1585,{participant:r})}if(!this.isUser)return null;var a=this.chatstate;switch(a.type){case"available":return u.default.t(1577);case"composing":return u.default.t(1578);case"recording":return u.default.t(1579);case"unavailable":return a.deny||null==a.t?null:l.default.lastSeenStr(a.t)}}onChatActiveChange(){this.chatActive?(this.hasData?this.withholdDisplay=!1:this.withholdDisplayTimer=setTimeout((()=>{this.set({withholdDisplay:!1,withholdDisplayTimer:void 0})}),1500),this.forceDisplayTimer=setTimeout((()=>{this.set({forceDisplay:!0,forceDisplayTimer:void 0})}),2e3)):(this.withholdDisplayTimer&&(clearTimeout(this.withholdDisplayTimer),this.withholdDisplayTimer=void 0),this.forceDisplayTimer&&(clearTimeout(this.forceDisplayTimer),this.forceDisplayTimer=void 0))}subscribe(){return this.getCollection().find(this.id)}getCollection(){return r(93997).default}}_.Proxy="presence",_.idClass=c.default;var m=(0,o.defineModel)(_);t.default=m},93997:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.PresenceCollection=void 0;var i=a(r(18641)),n=a(r(86982)),s=r(64506),o=a(r(43926));class l extends i.default{_find(e){return!this.gadd(e).isUser||o.default.isServer(e)||o.default.isPSA(e)?Promise.resolve({id:e}):(0,s.subscribePresence)(e).then((()=>({id:e})))}clearAllPresence(){this.forEach((e=>{e.reset(),e.set({stale:!0,isSubscribed:!1})}))}}t.PresenceCollection=l,l.model=n.default,l.staleCollection=!0;var d=new l;t.default=d},94660:(e,t,r)=>{"use strict";var a=r(14859),i=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(r(99778)),s=a(r(21830)),o=a(r(56811)),l=r(42643),d=r(57097),u=a(r(44089)),c=a(r(27582)),p=a(r(43926));class h extends n.default{constructor(...e){super(...e),this.id=(0,n.prop)(),this.afterCursor=(0,n.prop)(),this.index=(0,n.prop)(),this.fetchedFromServer=(0,n.session)(),this._products=(0,n.session)(),this._msgs=(0,n.session)()}initialize(){super.initialize(),this.productCollection=new c.default,this.msgProductCollection=new c.default,this.collections=new u.default,this.listenTo(this,"change:_products",this.triggerProductUpdate),this.listenTo(this,"change:_msgs",this.triggerMsgUpdate),this.triggerProductUpdate(),this.triggerMsgUpdate()}triggerProductUpdate(){this._products&&this.productCollection.add(this._products,{merge:!0}),this._products=void 0}triggerMsgUpdate(){this._msgs&&this.msgProductCollection.add(this._msgs,{merge:!0}),this._msgs=void 0}markProductCollectionOld(){this.productCollection.forEach((e=>e.markOld()))}addProduct(e){var{id:t}=this;return(0,l.addProduct)(e).then((e=>{var r=this.productCollection.at(0);e.catalogWid=t,e.index=r?r.index-1:0;var a=this.productCollection.add(e,{merge:!0,at:0})[0];return(0,s.default)(a,"addedProduct")}))}editProduct(e){return(0,l.editProduct)(e).then((e=>{var t=this.productCollection.add(e,{merge:!0})[0];return(0,s.default)(t,"editedProduct")}))}pullProduct(e){return(0,l.queryProduct)(this.id,e).then((t=>{if("NOT_FOUND"===t.error&&this.productCollection.remove(e),null!=t.data){var r=new o.default((0,d.mapProductResponseToModel)(t.data,this.id));this.updateProduct(r)}}))}updateProduct(e){this.productCollection.add(e,{merge:!1})}getCollection(){return r(89962).default}}h.Proxy="catalog",h.idClass=p.default;var f=(0,n.defineModel)(h);t.default=f},89962:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.CatalogCollection=t.STATIC_WHATSAPP_IMAGE_URI=void 0;var i=a(r(52954)),n=a(r(18641)),s=a(r(94660)),o=r(33576),l=r(42643),d=r(57097),u=r(61864),c=r(25054),p="https://static.whatsapp.net";t.STATIC_WHATSAPP_IMAGE_URI=p;class h extends n.default{addMsgAsProduct(e){var t=e.businessOwnerJid&&(0,c.createWid)(e.businessOwnerJid);if(t){var r=this.get(t),a=r&&e.productId&&r.msgProductCollection.get(e.productId),i=r&&e.productId&&r.productCollection.get(e.productId);if(!(i&&i.t&&i.t>=e.t||a&&a.fetchedFromServer)){var n=(0,d.mapMsgToProductModel)(e);return super.add({id:t,afterCursor:void 0,_msgs:[n],stale:!0,fetchedFromServer:!!i},{merge:!0})}}}_queryProduct({catalogWid:e,productId:t,productMsgMediaData:r,width:a,height:i}){return(0,l.queryProduct)(e,t,a,i).then((a=>{if("NOT_FOUND"===a.error){var i=this.get(e);return null==i||i.productCollection.remove(t),Promise.reject(new o.E404("CatalogCollection:findProduct:_queryProduct NOT_FOUND"))}if(!a.data)return super.add({id:e,afterCursor:void 0});var{data:n}=a;if(!n.image_cdn_urls||n.image_cdn_urls[0].value.includes(p))return Promise.reject(new Error("CatalogCollection:findProduct:_queryProduct "+(n.image_cdn_urls?"Product image contains static image":"Could not find image_cdn_urls for product")));var s=(0,d.mapProductResponseToModel)(n,e);s.productMsgMediaData=r;var l=[s];return super.add({id:e,afterCursor:void 0,_products:l,_msgs:l},{merge:!0})}))}findProduct({catalogWid:e,productId:t,productMsgMediaData:r}){return t?this._queryProduct({catalogWid:e,productId:t,productMsgMediaData:r}):Promise.reject(new Error("CatalogCollection:findProduct Received productId type "+(void 0===t?"undefined":"null")))}_queryCatalog(e,t,r,a){var i=e?e.index:0;return(0,l.queryCatalog)(t,r,10,void 0,void 0,a).then((e=>{if(!e.data.length)return{id:t,afterCursor:void 0};var r=[];return e.data.forEach((e=>{e.image_cdn_urls&&!e.image_cdn_urls[0].value.includes(p)&&r.push((0,d.mapProductResponseToModel)(e,t))})),{id:t,afterCursor:e.paging.cursors.after,_products:r,fetchedFromServer:!0,index:i+r.length}}))}_findQuery(e){var t=this.get(e),r=t&&!t.stale?t.afterCursor:void 0;return this._queryCatalog(t,e,r)}_find(e){return this._findQuery(e)}findCarouselCatalog(e){var t=this.get(e),r=(0,u.isString)(e)?(0,c.createWid)(e):e;return t&&t.set({index:0}),this._queryCatalog(t,r,void 0).then((e=>(t&&t.markProductCollectionOld(),super.add(e,{merge:!0}))))}findNextProductPage(e){return this.update(e).then((e=>(Array.isArray(e)?e[0]:e).productCollection.getProductModels()))}findCollectionMembership(e,t){var r=()=>super.add,a=this;return(0,i.default)((function*(){var i=a.get(e),n=(0,u.isString)(e)?(0,c.createWid)(e):e,s=i&&!i.stale?i.afterCursor:void 0,o=yield a._queryCatalog(i,n,s,t);r().call(a,o,{merge:!0}),(i=a.get(e))&&(i.stale=!1)}))()}}t.CatalogCollection=h,h.model=s.default,h.staleCollection=!0;var f=new h;t.default=f},56811:(e,t,r)=>{"use strict";var a=r(14859),i=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.MAX_PRODUCT_IMAGES=t.MAX_PRICE=t.MIN_PRICE=void 0;var n=i(r(99778)),s=r(48537),o=a(r(86619)),l=r(60301),d=a(r(56224));t.MIN_PRICE=0;t.MAX_PRICE=4503599627370496;t.MAX_PRODUCT_IMAGES=10;class u extends n.default{constructor(...e){super(...e),this.old=(0,n.session)(!1),this.checkmark=(0,n.session)(!1),this.id=(0,n.prop)(),this.isHidden=(0,n.prop)(),this.catalogWid=(0,n.prop)(),this.url=(0,n.prop)(),this.name=(0,n.prop)(),this.description=(0,n.prop)(),this.availability=(0,n.prop)(),this.reviewStatus=(0,n.prop)(),this.canAppeal=(0,n.prop)(),this.currency=(0,n.prop)(),this.priceAmount1000=(0,n.prop)(),this.salePriceAmount1000=(0,n.prop)(),this.salePriceStartDate=(0,n.prop)(),this.salePriceEndDate=(0,n.prop)(),this.retailerId=(0,n.prop)(),this.productImageCollection=(0,n.session)(),this.imageCount=(0,n.prop)(),this.index=(0,n.prop)(),this.additionalImageCdnUrl=(0,n.prop)(),this.additionalImageHashes=(0,n.prop)(),this.imageCdnUrl=(0,n.prop)(),this.imageHash=(0,n.prop)(),this.productMsgMediaData=(0,n.session)(),this.fetchedFromServer=(0,n.session)(),this.t=(0,n.prop)()}initialize(){super.initialize(),this.productImageCollection=new d.default,this.listenTo(this,"change:imageCdnUrl",this.triggerImageUpdate),this.listenTo(this,"change:additionalImageCdnUrl",this.triggerImageUpdate),this.triggerImageUpdate()}triggerImageUpdate(){if(this.markProductImagesOld(),this.fetchedFromServer||!this.productMsgMediaData)this.imageCdnUrl&&this.productImageCollection.gadd({id:"_0",mediaUrl:this.imageCdnUrl,fetchedFromServer:this.fetchedFromServer,old:!1},{merge:!0}),this.additionalImageCdnUrl&&this.additionalImageCdnUrl.forEach(((e,t)=>{this.productImageCollection.gadd({id:`_${t+1}`,mediaUrl:e,fetchedFromServer:this.fetchedFromServer,old:!1},{merge:!0})}));else for(var e=0;e<this.imageCount;e++)this.productImageCollection.gadd({id:`_${e}`,type:"product",mediaData:new o.default({mediaStage:l.MEDIA_DATA_STAGE.PREPARING}),fetchedFromServer:this.fetchedFromServer,old:!1},{merge:!0})}markOld(){this.old=!0}markProductImagesOld(){this.productImageCollection.forEach((e=>e.markOld()))}getHeadImageFile(){var e,{productImageCollection:t,name:r}=this,a=t.head();if(a&&(a.mediaData&&a.mediaData.mediaBlob&&a.mediaData.mediaBlob._blob&&(e=a.mediaData.mediaBlob._blob),e))return(0,s.createFile)([e],`${r}.jpg`,{type:"image/jpeg"})}evictImagesFromCache(){this.productImageCollection.forEach((e=>e.evictFromCache()))}getPreviewImage(){return this.productImageCollection.head()}}u.Proxy="product";var c=(0,n.defineModel)(u);t.default=c},51642:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.createProductMsgSnapshot=v,t.sendProductMessage=function(){return E.apply(this,arguments)};var n=i(r(52954)),s=i(r(70417)),o=a(r(2784)),l=r(25713),d=i(r(63256)),u=i(r(13277)),c=i(r(23045)),p=i(r(38637)),h=i(r(84161)),f=i(r(21830)),_=r(13113),m=a(r(97025));function g(e,t){var r=(0,f.default)(new d.default({chatParticipantCount:t}),"new AttachMediaCollection({\n  chatParticipantCount\n})");return r.processAttachments([{file:e}],h.default.MEDIA_PICKER_ORIGIN_TYPE.CHAT_PHOTO_LIBRARY).then((()=>{if(r.canSend()){var e=r.getPreviewableMedias();if(1===e.length){var[t]=e;return t.caption||(t.caption=void 0),t}}}))}function v(e){return(0,s.default)((0,s.default)({businessOwnerJid:e.catalogWid.toString({legacy:!0}),productId:e.id.toString(),url:e.url,productImageCount:e.productImageCollection.length,title:e.name,description:e.description},0===e.priceAmount1000?{priceAmount1000:null,currencyCode:null}:{currencyCode:e.currency,priceAmount1000:e.priceAmount1000}),{},{salePriceAmount1000:(0,_.isSalePriceActive)(e)?e.salePriceAmount1000:null})}function E(){return(E=(0,n.default)((function*(e,t,r){var a=t.getHeadImageFile();if(!a)throw u.default.openToast(o.createElement(m.default,{msg:p.default.t(1161),id:(0,m.genId)()})),new Error("Tried to send product message. Media file is not available.");var i=e.getParticipantCount(),n=yield g(a,i);if(!n)throw u.default.openToast(o.createElement(m.default,{msg:p.default.t(1161),id:(0,m.genId)()})),new Error("Tried to send product message. Media data is not available.");var d={quotedMsg:r,caption:n.caption,addEvenWhilePreparing:n.previewable&&n.state===l.ATTACH_MEDIA_STATE.PROCESSING,useBasePropsType:!0};n.sendToChat(e,(0,s.default)((0,s.default)({},d),{},{type:c.default.MSG_TYPE.PRODUCT,productMsgOptions:v(t)}))}))).apply(this,arguments)}},79077:(e,t,r)=>{"use strict";var a=r(14859),i=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(r(99778)),s=a(r(27582));class o extends n.default{constructor(...e){super(...e),this.id=(0,n.prop)(),this.name=(0,n.prop)(),this.isHidden=(0,n.prop)(),this.reviewStatus=(0,n.prop)(),this.totalItemsCount=(0,n.prop)(),this.afterCursor=(0,n.prop)()}initialize(){super.initialize(),this.productCollection=new s.default}addProducts(e){this.productCollection.add(e,{merge:!0})}}o.Proxy="productColl";var l=(0,n.defineModel)(o);t.default=l},44089:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.ProductCollCollection=void 0;var i=a(r(52954)),n=a(r(18641)),s=r(57097),o=a(r(79077)),l=r(30217),d=100,u=e=>({id:e.id,name:e.name,reviewStatus:e.reviewStatus,totalItemsCount:e.totalItemsCount});class c extends n.default{constructor(...e){super(...e),this.afterCursor=""}_findQuery(e){return(0,l.queryCollections)(e,this.afterCursor,10,0,!0,d,d).then((e=>(this.afterCursor=e.afterCursor,e.collections)))}_find(e){return this._findQuery(e)}findCollectionsList(e,t,r){var a=this;return(0,i.default)((function*(){var i=yield(0,l.queryCollections)(e,a.afterCursor,10,t,r,d,d);a.afterCursor=i.afterCursor,a.add(i.collections.map(u),{merge:!0}),i.collections.forEach((t=>{var r=a.get(t.id);r&&r.addProducts(t.products.map((t=>(0,s.mapProductResponseToModel)(t,e))))}))}))()}getCollectionModels(e){var t=this.toArray();return e?t:t.filter((e=>!e.isHidden&&"APPROVED"===e.reviewStatus))}findCollectionProducts(e,t){var r=this;return(0,i.default)((function*(){var a=r.get(t),i=a?a.afterCursor:void 0,n=yield(0,l.querySingleCollection)(e,t,i,10,d,d);1===n.collections.length&&(r.add(n.collections.map(u),{merge:!0}),(a=r.get(t))&&(a.addProducts(n.collections[0].products.map((t=>(0,s.mapProductResponseToModel)(t,e)))),a.afterCursor=n.afterCursor))}))()}}t.ProductCollCollection=c,c.model=o.default,c.staleCollection=!0;var p=c;t.default=p},27582:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.ProductCollection=t.PRODUCT_REVIEW_STATUS=void 0;var i=a(r(18641)),n=a(r(56811)),s=a(r(54559)),o={NO_REVIEW:"NO_REVIEW",PENDING:"PENDING",REJECTED:"REJECTED",APPROVED:"APPROVED",OUTDATED:"OUTDATED"};t.PRODUCT_REVIEW_STATUS=o;class l extends i.default{getProductModels(e=!1){var t=super.toArray();if(super.length<1)return t;var r=super.head();if(!(r&&r.catalogWid))return t;var a=e?new Set([o.OUTDATED,o.NO_REVIEW,o.APPROVED,o.REJECTED,o.PENDING]):new Set([o.APPROVED]),i=super.filter((e=>a.has(e.reviewStatus)&&!e.old));return s.default.webCatalogProductsOnOff&&!e?i.filter((e=>!e.isHidden)):i}add(e,t){var r=t?super.add(e,t):super.add(e);return this.sort(),r}evictImagesFromCache(e){var t=this.get(e);t&&t.evictImagesFromCache()}}t.ProductCollection=l,l.model=n.default,l.comparator=function(e,t){return e.index-t.index};var d=l;t.default=d},18737:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(r(52954)),s=i(r(70417)),o=r(56150),l=i(r(45026)),d=i(r(81076)),u=a(r(99778)),c=r(24461),p=r(27305),h=i(r(86619)),f=r(60301),_=r(25332),m=i(r(93013)),g=r(35112),v=i(r(35283)),E=(0,o.createTimer)({algo:{type:"fibonacci",first:0,second:1},jitter:.25,max:9e5});function y(e){return"_productimage_"+new URL(e).pathname}class S extends u.default{constructor(...e){super(...e),this.id=(0,u.prop)(),this.type=(0,u.prop)(),this.mediaUrl=(0,u.prop)(),this.blobUrl=(0,u.session)(),this.mediaData=(0,u.session)(),this.fetchedFromServer=(0,u.prop)(),this.old=(0,u.session)(!1)}initialize(){super.initialize(),this.listenTo(this,"change:mediaUrl change:fetchedFromServer",this.triggerImageUpdate),this.triggerImageUpdate()}_processAndUpdateMediaData(e){var t={},r=m.default.createFromData(e,"image/jpeg");(0,p.prepRawMedia)(r,{}).waitForPrep().then((e=>(t=(0,s.default)((0,s.default)({},t),{},{mediaBlob:e.mediaBlob,type:e.type,mimetype:e.mimetype,fullWidth:e.fullWidth,fullHeight:e.fullHeight}),Promise.all([m.default.createFromBase64Jpeg(e.preview),m.default.createFromData(e.mediaBlob),(0,g.getHash)(e.mediaBlob)])))).then((e=>{var[r,a,i]=e;if(t=(0,s.default)((0,s.default)({},t),{},{preview:r,mediaBlob:a,renderableUrl:a.url(),mediaStage:f.MEDIA_DATA_STAGE.RESOLVED,filehash:i}),i===this.mediaData.filehash)return Promise.resolve();this.mediaData.set(t)}))}triggerImageUpdate(){var e=this;return(0,n.default)((function*(){if(e.fetchedFromServer&&e.mediaUrl){e.mediaData||e.addChild("mediaData",new h.default({mediaStage:f.MEDIA_DATA_STAGE.PREPARING}));var t=y(e.mediaUrl),r=yield v.default.get(t);if(r)return e._processAndUpdateMediaData(r);var a={delay:({taskDuration:e})=>{var t=1e3*E();return Math.max(t-e,0)},signal:(new l.default).signal,retries:10};return(0,d.default)(a,(t=>(0,_.fetchMedia)(e.mediaUrl).then((e=>e&&e.status>=200&&e.status<300?e:t(new c.CatalogImageDownloadError))))).then((r=>{var a=r.result;v.default.put(t,a),e._processAndUpdateMediaData(a)})).catch((()=>{__LOG__(3)`Failed to fetch ${e.mediaUrl}`,e.mediaData.set({mediaStage:f.MEDIA_DATA_STAGE.ERROR_MISSING})}))}}))()}markOld(){this.old=!0}evictFromCache(){if(this.mediaUrl){var e=y(this.mediaUrl);v.default.del(e)}}}S.Proxy="productImage";var T=(0,u.defineModel)(S);t.default=T},56224:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.ProductImageCollection=void 0;var i=a(r(18641)),n=a(r(18737));class s extends i.default{toArray(){return super.filter((e=>e.old?(this.remove(e),!1):e))}}t.ProductImageCollection=s,s.model=n.default;var o=s;t.default=o},72008:(e,t,r)=>{"use strict";var a=r(14859),i=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.INVALID_PRODUCT_TOKEN=void 0;var n=i(r(99778)),s=r(89962),o=a(r(83746)),l=r(57097),d=a(r(27582)),u=r(81534),c=a(r(54559)),p="DELETED";t.INVALID_PRODUCT_TOKEN=p;var h=["ERROR","SUCCESS"];class f extends n.default{constructor(...e){super(...e),this.id=(0,n.prop)(),this.catalogId=(0,n.prop)(),this.title=(0,n.prop)(),this._productsLoadingStatus=(0,n.session)(),this._productList=(0,n.session)(),this._products=(0,n.session)()}initialize(){super.initialize(),this.productCollection=new d.default,this._productsLoadingStatus=new Map,this.listenTo(this,"change:_products",this.triggerProductUpdate),this.triggerProductUpdate()}triggerProductUpdate(){null!=this._products&&(this._products.forEach((e=>{var t=this._getFetchStatus(e);this.setProductLoadingStatus(e.id,t),"DELETED"!==e.status&&"ERROR"!==t&&this.productCollection.add((0,l.mapProductResponseToModel)(e,this.catalogId),{merge:!0})})),this._products=void 0)}getNextProductBatchToLoad(){var e=this.getPageSize(),t=this._productList.productSections.reduce(((e,{products:t})=>[...e,...t.map((({productId:e})=>e)).filter(Boolean).filter((e=>"NONE"===this.getProductLoadingStatus(e)))]),[]).slice(0,e);return t.forEach((e=>this.setProductLoadingStatus(e,"PENDING"))),t}getPageSize(){var e=c.default.webProductListMessagePageSize||u.PRODUCT_PAGE_SIZE,t=this.getProductSize();return t<3*e?t:2*e}getProductSize(){return this._productList.productSections.reduce(((e,{products:t})=>e+t.length),0)}setProductLoadingStatus(e,t){this._productsLoadingStatus.set(e,t)}getProductLoadingStatus(e){return this._productsLoadingStatus.get(e)||"NONE"}getTotalProductsFetchedOrFailed(){return Array.from(this._productsLoadingStatus).filter((([e,t])=>h.includes(t))).length}getProductList(){return this._productList}getSections(){return this._productList.productSections}getSectionsCount(){return this._productList.productSections.reduce(((e,{title:t})=>null!=t&&""!==t?e+1:e),0)}isFetching(){var e=!1;return this._productsLoadingStatus.forEach((t=>{"PENDING"===t&&(e=!0)})),e}_getFetchStatus(e){return e.status===p||!e.image_cdn_urls||e.image_cdn_urls[0].value.includes(s.STATIC_WHATSAPP_IMAGE_URI)?"ERROR":"SUCCESS"}}f.Proxy="product_list",f.idClass=o.default;var _=(0,n.defineModel)(f);t.default=_},27617:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.ProductMessageListCollection=void 0;var i=a(r(18641)),n=r(42643),s=a(r(72008)),o=r(25054);class l extends i.default{_queryProductList(e){var t=e.catalogId;return(0,n.queryProductList)(t,e.getNextProductBatchToLoad()).then((t=>({id:e.id,_products:t,fetchedFromServer:!0})))}_findQuery(e){var t=this.get(e);return null==t?Promise.resolve({id:e}):this._queryProductList(t)}_find(e){return this._findQuery(e)}getOrAdd(e,t,r,a){var i=this.get(e);if(null!=i)return i;if(null==r)return null;var n=(0,o.createWid)(r);return null!=(i=this.add({id:e,catalogId:n,_productList:t,title:a})[0])?i:null}}t.ProductMessageListCollection=l,l.model=s.default,l.staleCollection=!0;var d=new l;t.default=d},81534:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PRODUCT_PAGE_SIZE=void 0;t.PRODUCT_PAGE_SIZE=6},13113:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getActivePrice=t.isSalePriceActive=void 0;var r=e=>null!=e.salePriceAmount1000&&(null==e.salePriceStartDate||e.salePriceStartDate<=Date.now())&&(null==e.salePriceEndDate||e.salePriceEndDate>Date.now());t.isSalePriceActive=r;t.getActivePrice=e=>r(e)?e.salePriceAmount1000:e.priceAmount1000},13499:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ProductAvailability=void 0;var a=r(28103)({IN_STOCK:"in stock",OUT_OF_STOCK:"out of stock",UNKNOWN:"unknown"});t.ProductAvailability=a},56160:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PROFILE_PIC_COMMAND=void 0;var r=Object.freeze({REMOVE:"remove",SET:"set"});t.PROFILE_PIC_COMMAND=r},48438:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.FALLBACK=void 0;var n=i(r(70417)),s=a(r(99778)),o=i(r(23045)),l=r(66239),d=i(r(20468)),u=i(r(22006)),c=i(r(43926)),p=i(r(55074)),h={SINGLE:"SINGLE",GROUP:"GROUP"};t.FALLBACK=h;class f extends s.default{constructor(...e){super(...e),this.id=(0,s.prop)(),this.token=(0,s.prop)(),this.tag=(0,s.prop)(),this.raw=(0,s.prop)(),this.eurl=(0,s.prop)(),this.previewEurl=(0,s.prop)(),this.stale=(0,s.session)(!0),this.eurlStale=(0,s.session)(!1),this.pendingPic=(0,s.session)(),this.img=(0,s.derived)(this._img,["tag","raw","stale","eurl","eurlStale","previewEurl"]),this.imgFull=(0,s.derived)(this._imgFull,["tag","raw","stale","eurl","eurlStale"]),this.fallbackType=(0,s.derived)(this._fallbackType,["id"])}_img(){return this.raw?"data:image/jpeg;base64,"+this.raw:!this.tag&&this.stale?null:this.tag?d.default.supportsFeature(d.default.F.MD_BACKEND)?this.previewEurl:this.generateUrl("s"):void 0}_imgFull(){return!this.raw&&this.tag||!this.stale?!this.raw&&this.tag?d.default.supportsFeature(d.default.F.MD_BACKEND)?this.eurl:this.generateUrl("l"):void 0:null}_fallbackType(){return c.default.isUser(this.id)?h.SINGLE:(c.default.isGroup(this.id),h.GROUP)}markStale(e){this.stale=!0,e&&e.eurl&&(this.eurlStale=!0)}validate(){if(this.stale||this.eurlStale)return this.getCollection().update(this.id)}generateUrl(e){var t={t:e,u:this.id.toString(),i:this.tag||"",n:this.token||""};return this.token||(__LOG__(4,void 0,new Error,!0)`Assertion failed!`,SEND_LOGS("profilePicThumb::generateUrl: empty token for profile pic")),p.default.alive&&this.eurl&&!this.eurlStale&&(t=(0,n.default)({e:this.eurl},t)),u.default.build(o.default.PP_URL,t)}canSet(){if(c.default.isGroup(this.id)){var e=r(85030).default.get(this.id);return!(e&&e.groupMetadata&&e.groupMetadata.participants.iAmRestrictedMember())}return!!this.id.equals((0,l.getMaybeMeUser)())}canDelete(){if(c.default.isGroup(this.id)&&this.tag){var e=r(85030).default.assertGet(this.id);return!(e&&e.groupMetadata&&e.groupMetadata.participants.iAmRestrictedMember())}return!(!this.id.equals((0,l.getMaybeMeUser)())||!this.tag)}getCollection(){return r(93562).default}}f.Proxy="profilePicThumb",f.idClass=c.default;var _=(0,s.defineModel)(f);t.default=_},93562:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.ProfilePicThumbCollection=void 0;var n=i(r(45455)),s=a(r(18641)),o=i(r(79435)),l=r(33576),d=a(r(24461)),u=r(66239),c=i(r(20468)),p=i(r(75584)),h=r(56160),f=r(53319),_=i(r(48438)),m=r(65999),g=i(r(43926)),v=r(25054);class E extends s.default{get(e){var t=super.get(e);if(!this.modelClass.prototype.isIdType(e))return t;var r=super.get((0,p.default)(e.toString()));if(r){if(this.remove(r,{silent:!0}),t&&t.tag)return t;var a=r.toJSON();return a.id=e,this.add(a,{silent:!0,merge:!0})[0]}return t||void 0}saveToCache(){if(o.default.shouldSaveToCache()){var e=E.cachePolicy.id,t=this.filter((e=>g.default.isWid(e.id)&&!!e.eurl&&!!e.token));t=t.map((function(e){var t=e.toJSON();return t.id=(0,p.default)(t.id.toString()),t})),__LOG__(2)`models:profilePic:cache-save: ${String(e)}`,(0,u.setCollection)(e,t)}}initializeFromCache(e){if(this.length&&e){var t=this.reduce(((e,t)=>(e[(0,p.default)(t.id.toString())]=t.id.toString(),e)),new Object);if(!(0,n.default)(t)){var r=e.reduce(((e,r)=>(t[r.id]&&(r.id=(0,v.createWid)(t[r.id]),r.stale=!0,r.token&&e.push(r)),e)),[]);this.add(r,{merge:!0})}}}onResume(){var e=this.filter((e=>{var t=r(85030).default.get(e.id);return e.hasObservers()&&e.stale&&(g.default.isUser(e.id)||g.default.isGroup(e.id))&&!(t&&t.isReadOnly)})).map((e=>(e.tag||e.unset("tag",{silent:!0}),e)));this.resyncPictures(e)}_find(e){var t=r(85030).default.get(e);if(t&&t.isReadOnly)return c.default.supportsFeature(c.default.F.MD_BACKEND)?Promise.resolve({id:e,stale:!0}):(0,f.profilePicFindThumbFromPhone)(e,this.get(e)).then((e=>(e.tag||e.raw||(e.eurl=null,e.tag=null,e.raw=null,e.eurlStale=!1),e))).catchType(d.ProtoVersionUndefined,(()=>({id:e,stale:!0})));if(g.default.isUser(e)||g.default.isGroup(e)){var a={id:e};return(0,f.profilePicFind)(e).then((e=>(a.tag=e.tag,a.raw=null,a.eurl=e.eurl,a.eurlStale=!1,a.token=e.token,c.default.supportsFeature(c.default.F.MD_BACKEND)&&(a.previewEurl=e.previewEurl),a))).catchType(l.ServerStatusCodeError,(e=>{switch(e.status){case 401:a.tag="",a.raw=void 0;break;case 423:case 429:a.stale=!0;break;default:a.tag=null,a.eurl=null,a.eurlStale=!1}return Promise.resolve(a)})).catchType(l.WebdDrop,(function(){return{id:e,stale:!0}}))}return Promise.resolve({id:e,tag:null})}imageChanged(e,t){var r=this.get(e);r&&(t===h.PROFILE_PIC_COMMAND.REMOVE?r.set({tag:void 0,eurl:void 0}):t!==h.PROFILE_PIC_COMMAND.SET&&r.tag===t||this.update(r.id).catchType(l.WebdDrop,(()=>{})))}resyncPictures(e){return 0===e.length?Promise.resolve():(0,f.profilePicResync)(e.map((function(e){return{id:e.id,tag:e.tag}}))).then((t=>{__LOG__(2)`ProfilePicThumbStore:resyncPictures success`,t.forEach((t=>{var r=this.get(t.id);r&&r.set({tag:t.tag,token:t.token,raw:void 0,stale:!1,eurl:t.eurl,eurlStale:!1,previewEurl:t.previewEurl}),e.forEach((e=>{e.eurlStale&&this.update(e.id)})),e.forEach((e=>{e.stale=!1}))}))})).catchType(l.WebdDrop,(()=>{})).catchType(l.ServerStatusCodeError,(e=>{423===e.status||429===e.status?__LOG__(3)`ProfilePicThumbStore:resyncPictures blocked ${e.status}`:e.status>=400&&__LOG__(3)`ProfilePicThumbStore:resyncPictures dropped: ${String(e)}`})).catch((function(e){__LOG__(3)`ProfilePicThumbStore:resyncPictures dropped: ${String(e)}`}))}findThumbnailWid(e){return e.find((e=>{var t;return null===(t=this.get(e))||void 0===t?void 0:t.img}))}getThumbnailWidFromVcard(e){if(!e)return null;var t=(0,m.vcardWids)(e);if(t){var r=this.findThumbnailWid(t);return r||(t.length?t[0]:null)}}}t.ProfilePicThumbCollection=E,E.model=_.default,E.staleCollection=!0,E.resumeOnAvailable=!0,E.cachePolicy={id:"profile_pic_thumb",trigger:"change:tag change:raw",policy:s.CACHE_POLICY.LOAD,delay:5e3};var y=new E;t.default=y},89934:(e,t,r)=>{"use strict";var a=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(99778));class n extends i.default{constructor(...e){super(...e),this.id=(0,i.prop)(),this.shortcut=(0,i.prop)(),this.message=(0,i.prop)(),this.count=(0,i.prop)(),this.keywords=(0,i.prop)(),this.pendingCount=(0,i.session)(0),this.totalCount=(0,i.derived)(this._totalCount,["count","pendingCount"])}_totalCount(){return this.count+this.pendingCount}useOnce(){this.pendingCount+=1,this.getCollection().periodicFlush()}getCollection(){return r(84553).default}}n.Proxy="quickReply";var s=(0,i.defineModel)(n);t.default=s},84553:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.QuickReplyCollection=void 0;var i=r(35160),n=a(r(18641)),s=r(33576),o=a(r(20468)),l=a(r(89934)),d=a(r(94407));class u extends n.default{constructor(...e){super(...e),this.checksum=void 0,this.flushCountsTimer=new i.ShiftTimer((()=>{this.hasPendingCounts()&&this.flushCounts()})),this.sortQuickReply=(e,t)=>e.totalCount===t.totalCount?e.id<t.id?-1:1:e.totalCount>t.totalCount?-1:1,this.onCountsFlushed=({id:e,count:t})=>{var r=this.get(e);r&&(r.count=t,r.pendingCount=0)}}delete(){super.delete(),delete this.checksum}filterShortcuts(e){return this.filter((({shortcut:t})=>t.toLowerCase().startsWith(e.toLowerCase()))).sort(this.sortQuickReply)}sync(e){o.default.supportsFeature(o.default.F.QUICK_REPLIES_QUERY)&&(this.synced()&&this.checksum===e?this.hasPendingCounts()&&this.flushCounts():this.findQuery({}).catchType(s.WebdDrop,(()=>{})))}periodicFlush(){o.default.supportsFeature(o.default.F.QUICK_REPLIES_QUERY)&&this.flushCountsTimer.debounceAndCap(2e3,5e3)}updateChecksum(e){this.checksum=e}synced(){return void 0!==this.checksum}hasPendingCounts(){return this.some((({pendingCount:e})=>e>0))}getAllPendingCounts(){var e={};return this.forEach((({id:t,pendingCount:r})=>{r>0&&(e[t]=r)})),e}flushCounts(){var e=this.getAllPendingCounts();d.default.flushQuickReplyCounts(e).then((t=>{t.checksum&&this.updateChecksum(t.checksum),t.data.filter((({id:t})=>void 0!==e[t])).forEach(this.onCountsFlushed)})).catchType(s.WebdDrop,(()=>{}))}_findQuery(){var e=this.getAllPendingCounts();return d.default.queryQuickReplies(e).then((t=>(t.checksum&&this.updateChecksum(t.checksum),t.data.filter((({id:t})=>void 0!==e[t])).forEach(this.onCountsFlushed),t.data)))}handle(e){e.checksum&&this.updateChecksum(e.checksum);var t=[],r=[];e.quickReplies.forEach((e=>{"delete"===e.type?t.push(e):r.push(e)})),this.remove(t.map((({id:e})=>e))),this.add(r,{merge:!0})}}t.QuickReplyCollection=u,u.model=l.default;var c=new u;t.default=c},5916:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.isUnviewed=function(e){return!d(e)&&!u(e)},t.isViewed=d,t.isExpired=u,t.VIEW_ONCE_EXPIRE_AFTER=void 0;var i=a(r(99461)),n=a(r(23045)),s=r(47138),o=1209600;function l(e){var t=(0,s.unproxy)(e);return null!=t?t.asViewOnce:null}function d(e){var t;return(null===(t=l(e))||void 0===t?void 0:t.ack)===n.default.ACK.PLAYED}function u(e){var t=l(e);if(null==t)return!1;var r=i.default.globalUnixTime()-(0,s.unproxy)(t).t;return!d(t)&&r>=o}t.VIEW_ONCE_EXPIRE_AFTER=o},54559:(e,t,r)=>{"use strict";var a=r(14859),i=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.ServerProps=void 0;var n=i(r(99778)),s=a(r(13277)),o=a(r(84161)),l=r(81534),d=r(69389),u=a(r(31244)),c=a(r(20468)),p={imageMaxKBytes:function(e){if("number"==typeof e&&e>0)return 1024*e},maxParticipants:function(e){if("number"==typeof e&&e>0)return e-1},media:f,maxFileSize:f,groupDescLength:_,googleMapsDoNotAuth:m,googleMapsKeyless:m,frequentlyForwardedMessages:m,frequentlyForwardedGroupSetting:m,quickMessageSearch:m,ephemeralMessagesSetting:m,ephemeralMessages:m,ephemeralPruning:m,statusVideoMaxDuration:_,muteAlways:m,viewOnceRead:m,viewOnceWrite:m,ctwaContextRender:m,serverPropsVersion:_,newCommerceEntryPointEnabled:m,wallpapersV2:m,hfmStringChanges:m,bspUi:m,webServerStickerPanel:m};class h extends n.default{constructor(...e){super(...e),this.serverPropsVersion=(0,n.prop)(),this.gifSearch=(0,n.prop)(!1),this.imageMaxEdge=(0,n.prop)(1600),this.imageMaxKBytes=(0,n.prop)(1048576),this.maxParticipants=(0,n.prop)(101),this.maxSubject=(0,n.prop)(25),this.media=(0,n.prop)(16777216),this.maxFileSize=(0,n.prop)(104857600),this.groupDescLength=(0,n.prop)(0),this.googleMapsDoNotAuth=(0,n.prop)(!0),this.googleMapsKeyless=(0,n.prop)(!1),this.multicastLimitGlobal=(0,n.prop)(5),this.frequentlyForwardedMessages=(0,n.prop)(!1),this.frequentlyForwardedThreshold=(0,n.prop)(5),this.frequentlyForwardedMax=(0,n.prop)(1),this.frequentlyForwardedGroupSetting=(0,n.prop)(!1),this.quickMessageSearch=(0,n.prop)(!1),this.ephemeralMessagesSetting=(0,n.prop)(!1),this.ephemeralMessages=(0,n.prop)(!0),this.ephemeralPruning=(0,n.prop)(!0),this.ephemeralMessagesAllowedValues=(0,n.prop)("604800"),this.stickerSearchEnabled=(0,n.prop)(!1),this.productMediaAttachments=(0,n.prop)(!1),this.muteAlways=(0,n.prop)(!1),this.viewOnceRead=(0,n.prop)(!1),this.viewOnceWrite=(0,n.prop)(!1),this.wallpapersV2=(0,n.prop)(!1),this.hfmStringChanges=(0,n.prop)(!1),this.mmsVCacheAggregationEnabled=(0,n.prop)(!1),this.mmsHotContentTimespan=(0,n.prop)(0),this.mmsCatV1ForwardHotOverrideEnabled=(0,n.prop)(!1),this.pttPlaybackSpeedEnabled=(0,n.prop)(!1),this.pttPlaybackSpeedHideDelay=(0,n.prop)(1500),this.templateDocMimeTypes=(0,n.prop)(1),this.mmsMediaKeyTTL=(0,n.prop)(1/0),this.vcardAsDocumentSizeKb=(0,n.prop)(0),this.vcardMaxSizeKb=(0,n.prop)(1e3),this.mmsVcardAutodownloadSizeKb=(0,n.prop)(1024),this.webUploadDocumentThumbMmsEnabled=(0,n.prop)(!1),this.webDownloadDocumentThumbMmsEnabled=(0,n.prop)(!1),this.webSendDocumentThumbInMessageDisabled=(0,n.prop)(!1),this.webUploadLinkThumbMmsEnabled=(0,n.prop)(!1),this.webDownloadLinkThumbMmsEnabled=(0,n.prop)(!1),this.webVoipInternalTester=(0,n.prop)(!1),this.webVoip=(0,n.prop)(!1),this.groupCallMaxParticipants=(0,n.prop)(0),this.statusVideoMaxDuration=(0,n.prop)(30),this.webVoipMacOsMinVersion=(0,n.prop)(""),this.webVoipWindowsOsMinVersion=(0,n.prop)(""),this.ctwaContextRender=(0,n.prop)(!1),this.ctwaContextCompose=(0,n.prop)(!1),this.syncdInlineMutationsMaxCount=(0,n.prop)(1e3),this.syncdPatchProtobufMaxSize=(0,n.prop)(100),this.syncdKeyMaxUseDays=(0,n.prop)(30),this.syncdWaitForKeyTimeoutDays=(0,n.prop)(7),this.syncdAdditionalMutations=(0,n.prop)(1),this.syncdAntiTamperingFatalExceptionEnabled=(0,n.prop)(!1),this.syncdSentinelTimeoutSeconds=(0,n.prop)(3),this.syncdPatchDeviceIndexIncluded=(0,n.prop)(!1),this.webBizProfileOptions=(0,n.prop)(3),this.webBizProfileEdit=(0,n.prop)(!1),this.mdBlocklistV2=(0,n.prop)(!1),this.newCommerceEntryPointEnabled=(0,n.prop)(!1),this.webShopsChatHeaderButtonEnabled=(0,n.prop)(!1),this.shopsProfileDrawerEntrypoint=(0,n.prop)(!1),this.shopsHideCatalogAttachmentEntrypoint=(0,n.prop)(!1),this.shopsHeaderDropdownMenuItem=(0,n.prop)(!1),this.bspSystemMessageEnabled=(0,n.prop)(!1),this.bspUi=(0,n.prop)(!1),this.webMediaCustomCroppingEnabled=(0,n.prop)(!1),this.webListMessage=(0,n.prop)(!1),this.webCart=(0,n.prop)(!1),this.webCartV11OrderMessageChanges=(0,n.prop)(!1),this.webButtonsMessage=(0,n.prop)(!1),this.webCatalogApiREH=(0,n.prop)(!1),this.greenAlertBannerDuration=(0,n.prop)(0),this.webSMBUpsellInBizProfile=(0,n.prop)(!1),this.webProductListMessageFallback=(0,n.prop)(!1),this.webProductListMessage=(0,n.prop)(!1),this.webProductListMessageRenderKillSwitch=(0,n.prop)(!1),this.webProductListMessagePageSize=(0,n.prop)(l.PRODUCT_PAGE_SIZE),this.webCatalogProductsOnOff=(0,n.prop)(!1),this.webYouTubePlayerEnhancements=(0,n.prop)(!1),this.webServerStickerPanel=(0,n.prop)(!1),this.webCollectionsDisplay=(0,n.prop)(!1),this.webCollectionsManagement=(0,n.prop)(!1)}delete(){super.delete(),this.updateProps({})}initialize(){super.initialize()}set(e,t,r){if("string"==typeof e)(0,d.setServerPropInElectron)(e,t);else{var a=e,i=t;Object.keys(a).forEach((e=>{var t=a[e];(null==i?void 0:i.merge)&&void 0===t||(0,d.setServerPropInElectron)(e,t)}))}return super.set(e,t,r)}updateProps(e){var t=e;for(var r in o.default.Global.webcBucket=t.bucket||null,this.__props.forEach((e=>{var r=t[e];void 0===r?r="serverPropsVersion"===e?this.serverPropsVersion:this.getDefault(e):p[e]&&void 0===(r=p[e](r))&&(r=this.getDefault(e)),this.set(e,r)})),c.default.F)void 0!==t[r]&&c.default.setFeature(r,t[r]);s.default.serverPropsUpdated()}updateSelectiveProps(e){var t=e;for(var r in o.default.Global.webcBucket=t.bucket||null,this.__props.forEach((e=>{var r=t[e];void 0!==r&&(p[e]&&void 0===(r=p[e](r))&&(r=this.getDefault(e)),this.set(e,r))})),c.default.F)void 0!==t[r]&&c.default.setFeature(r,e[r]);s.default.serverPropsUpdated()}extendAndOverrideFromURLParams(e){var t=new u.default(window.location.search),r=e;return this.__props.forEach((e=>{var a=`sp_${e}`;if(!0===t.has(a)){var i=t.get(a);if(null==i)return;"true"===i||"false"===i?r[e]="true"===i:isNaN(i)||isNaN(parseFloat(i))?r[e]=i:r[e]=parseFloat(i)}})),r}handlePayload(e){"number"==typeof e.status&&e.status>=400||this.updateProps(e)}handle(e){var t=e.shift();this.handlePayload(t)}getWebVoipInternalTester(){return this.webVoipInternalTester}getWebVoip(){return this.webVoip}getGroupCallMaxParticipants(){return this.groupCallMaxParticipants}getEphemeralMessagesAllowedValues(){return this.ephemeralMessagesAllowedValues.split(",").map((e=>parseInt(e,10)))}}function f(e){if("number"==typeof e&&e>0)return 1024*e*1024}function _(e){if("number"==typeof e&&e>0)return e}function m(e){if("number"==typeof e)return!!e}t.ServerProps=h,h.Proxy="serverProps";var g=new((0,n.defineModel)(h))({id:"1"});t.default=g},34749:(e,t,r)=>{"use strict";var a=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(99778)),n=r(33576),s=r(9690),o={classic:!1,enabled:!1};class l extends i.default{constructor(...e){super(...e),this.id=(0,i.prop)(),this.archive=(0,i.prop)(),this.showArchiveV2=(0,i.derived)(this._showArchiveV2,["archive","enabled"])}delete(){this.set({archive:o}),super.delete()}_showArchiveV2(){return!!this.archive.enabled&&!this.archive.classic}handleResponse(e){e.length?e.forEach((e=>{switch(__LOG__(2)`Settings: received setting type : ${e.type}`,e.type){case"Archive":var t;if(!(0,s.archiveV2Supported)()){__LOG__(4,void 0,new Error,!0)`Settings:handleResponse archive settings response is unsupported`,SEND_LOGS("archive-setting-unsupported");break}this.set({archive:{classic:e.value.classic,enabled:null!==(t=e.value.enabled)&&void 0!==t?t:this.archive.enabled}})}})):__LOG__(2)`Settings: received empty settings`}sync(e){var t="Settings:sync"+(e?" resume":"");return __LOG__(2)`${t}`,(0,r(94407).default.querySettings)(e).then((e=>{200===e.status?(__LOG__(2)`${t} success`,this.handleResponse(e.settings)):__LOG__(3)`${t} error receive status code ${e.status}`})).catchType(n.WebdDrop,(function(){__LOG__(3)`${t} dropped`})).catch((e=>{__LOG__(4,void 0,new Error,!0)`${t} failed with error: ${e}`,SEND_LOGS("settings-query-failed")}))}}l.Proxy="settings";var d=new((0,i.defineModel)(l))({id:"default_settings_id",archive:o});t.default=d},79090:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(r(74186)),s=i(r(29036)),o=i(r(90882)),l=i(r(18641)),d=i(r(20468)),u=i(r(36169)),c=i(r(30528)),p=a(r(15934));class h extends l.default{constructor(){super(),this.syncPromise=null,this.isSynced=!1,this.listenTo(p.default,"change:stream",(()=>{p.default.stream===p.STREAM.DISCONNECTED&&(this.isSynced=!1)}))}onResume(){this.isSynced=!1,this.sync()}maySync(){return d.default.supportsFeature(d.default.F.STARRED_GIFS)}sync(){return this.isSynced?Promise.resolve():this.syncPromise?this.syncPromise:this.maySync()?(this.syncPromise=c.default.getStarred(void 0,void 0,void 0,!0).then((e=>{var t=[];e&&e.length&&(t=(0,o.default)(e,(e=>e&&e.isGif&&!e.isUnsentMedia))),this.set(t)})).catch((e=>{499!==e&&__LOG__(3)`starred gif msgs sync error: `})).finally((()=>{this.syncPromise=null,this.isSynced=!0})),this.syncPromise):Promise.resolve()}add(e,t){if(!e||!this.maySync()||!this.isSynced)return[];var r=this.isModel(e)?[e]:e;return r=(0,s.default)((0,o.default)(r,(e=>e.isGif)),this.toArray(),((e,t)=>e.body===t.body)),super.add(r,t)}remove(e,t){if(!e||!this.maySync()||!this.isSynced)return[];var r=this.isModel(e)?[e]:e;return r=(0,n.default)((0,o.default)(r,(e=>e.isGif)),this.toArray(),((e,t)=>e.body===t.body)),super.remove(r,t)}}h.model=u.default,h.comparator=function(e,t){return t.t-e.t};var f=new h;t.default=f},37147:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.addStarredMsgs=function(e){n.add(e),e.forEach((e=>{e.chat.starredMsgs&&e.chat.starredMsgs.add(e)})),c.default.add(e)},t.removeStarredMsgs=f,t.default=t.StarredMsgCollection=void 0;var n,s=i(r(18641)),o=i(r(23045)),l=i(r(36169)),d=i(r(30528)),u=i(r(21830)),c=i(r(79090)),p=a(r(15934));class h extends s.default{constructor(){super(),this.syncPromise=null,this.isSynced=!1,this.listenTo(p.default,"change:stream",(()=>{p.default.stream===p.STREAM.DISCONNECTED?this.isSynced=!1:p.default.stream===p.STREAM.CONNECTED&&this.delete()}))}process(e,t,r,a){a?this.delete():this.updateMsgs(e,t,r)}sync(e){if(this.isSynced)return Promise.resolve();if(null!=this.syncPromise)return this.syncPromise;var t,r=this,a=this.last();return a&&(t=a.id),this.syncPromise=d.default.getStarred(e,o.default.PAGE_SIZE,t).then((function(e){e.length&&r.add(e,{silent:!0}),e.length<o.default.PAGE_SIZE&&(r.isSynced=!0)})).catch((function(){__LOG__(3)`starred msg sync error: `})).finally((()=>{r.syncPromise=null,r.trigger("sync")})),this.trigger("sync"),(0,u.default)(this.syncPromise,"syncPromise can not be null")}updateMsgs(e,t,r){var a=this.syncPromise||Promise.resolve();this.syncPromise=a.then((()=>e?(t.length>0?d.default.incrementalStarredUpdate(t):Promise.resolve([])).then((e=>{var t=e.concat(r);this.isSynced&&(this.add(t,{silent:!0}),c.default.add(e)),t.forEach((e=>{e.chat.starredMsgs&&e.chat.starredMsgs.add(e)})),this.trigger("sync")})).catch((()=>{__LOG__(3)`models:starred:update:error: `})):(f(t.concat(r).filter((e=>!e.star))),Promise.resolve()))).finally((()=>{this.syncPromise=null}))}delete(){this.isSynced=!1,super.delete()}}function f(e){n.remove(e),e.forEach((e=>{e.chat.starredMsgs&&e.chat.starredMsgs.remove(e)}))}t.StarredMsgCollection=h,h.model=l.default,h.comparator=(e,t)=>t.t-e.t;var _=n=new h;t.default=_},94069:(e,t,r)=>{"use strict";var a=r(14859),i=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(r(99778)),s=a(r(43926));class o extends n.default{constructor(...e){super(...e),this.id=(0,n.prop)(),this.status=(0,n.prop)(),this.stale=(0,n.session)(!0)}getCollection(){return r(48514).default}}o.Proxy="status",o.idClass=s.default;var l=(0,n.defineModel)(o);t.default=l},48514:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.StatusCollection=void 0;var i=a(r(18641)),n=r(33576),s=a(r(94069)),o=r(88956),l=a(r(43926)),d=r(25054);class u extends i.default{onResume(){this.filter((e=>e.hasObservers())).forEach((e=>{this.find(e.id).catchType(n.WebdDrop,(()=>{}))}))}_find(e){var t=e instanceof l.default?e:(0,d.createWid)(e);return(0,o.getStatus)(t)}handle([e]){var t=this.get(e.id);t&&(t.status=e.status,t.stale=!1)}}t.StatusCollection=u,u.model=s.default,u.idClass=l.default,u.staleCollection=!0,u.resumeOnAvailable=!0;var c=new u;t.default=c},72451:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(84621)),n=r(99778),s=a(r(99461)),o=a(r(23045)),l=a(r(43805)),d=r(11428),u=a(r(68473)),c=a(r(43926));class p extends u.default{constructor(...e){super(...e),this.id=(0,n.prop)(),this.t=(0,n.prop)(),this.unreadCount=(0,n.prop)(0),this.totalCount=(0,n.prop)(0),this.pic=(0,n.prop)(),this._msgs=(0,n.prop)((()=>[])),this.readKeys=(0,n.session)((()=>({}))),this.contact=(0,n.session)(),this.expireTimer=(0,n.session)(),this.expireTs=(0,n.session)(),this.hasUnread=(0,n.derived)(this._hasUnread,["unreadCount"]),this.readCount=(0,n.derived)(this._readCount,["unreadCount","totalCount"]),this.lastStatus=(0,n.derived)(this._lastStatus,["msgsChanged","totalCount"])}_hasUnread(){return this.unreadCount>0}_readCount(){var e=this.totalCount-this.unreadCount;return Number.isFinite(e)?e:(__LOG__(3)`Bad status v3 read count, ${this.totalCount}, ${this.unreadCount}`,0)}_lastStatus(){return this.msgs.last()}initialize(){super.initialize(),this.addChild("contact",l.default.gadd(this.id)),this.listenTo(this.msgs,"add bulk_add",(()=>{window.setTimeout((()=>{this.setupStatusExpiration()}))})),this.listenTo(this,"change:lastStatus",(()=>{this.lastStatus&&(this.t=this.lastStatus.t)}))}setupStatusExpiration(){var e=this.msgs.at(0);if(e&&!("number"==typeof this.expireTs&&this.expireTs<=e.t)){var t=e.t+86400+1;t<s.default.globalUnixTime()?window.setTimeout((()=>{this.expireMsg()})):(this.expireTimer=i.default.setGlobalTimeout(this.expireMsg.bind(this),1e3*t,this.expireTimer),this.expireTs=e.t)}}expireMsg(){for(var e=this.msgs;e.length>0;){var t=e.at(0);if(!t)break;if(t.t+86400>s.default.globalUnixTime())break;this.unreadCount>this.totalCount-1&&this.unreadCount--,this.totalCount--,e.remove(t),t.delete()}this.expireTs=void 0,this.expireTimer=void 0,0!==this.totalCount&&this.setupStatusExpiration()}delete(){__LOG__(2)`Status v3 deleted with total count: ${this.totalCount}`,super.delete(),this.expireTimer&&i.default.clearTimeout(this.expireTimer),null!=this.expireTs&&(this.expireTs=void 0),this.getCollection().remove(this.id)}onEmptyMRM(){__LOG__(2)`Status V3 onEmptyMRM with total count: ${this.totalCount}, noEarlierMsgs: ${this.msgs.msgLoadState.noEarlierMsgs?"true":"false"}`,this.msgs.msgLoadState.noEarlierMsgs&&0===this.totalCount?this.delete():this.totalCount>0&&this.loadMore().catch((()=>{})).finally((()=>{this.msgs.length||this.delete()}))}loadMore(e=o.default.PAGE_SIZE){if(this.msgs.msgLoadState.noEarlierMsgs)return Promise.resolve();if(this.msgs.msgLoadState.isLoadingEarlierMsgs)return this.msgs.loadEarlierPromise;var t=0!==e?e:o.default.PAGE_SIZE;return this.getCollection().loadMore(this.id,t,this.msgs.last()).then((e=>(Array.isArray(e)&&e.length<t&&(this.msgs.msgLoadState.noEarlierMsgs=!0),e))).catch((e=>(404===e&&this.delete(),Promise.reject(e))))}handleReadStatus(e){this.readKeys[e]||(this.readKeys[e]=!0,this.unreadCount>0&&this.unreadCount--)}sendReadStatus(e,t){return(0,d.sendReadStatus)(e,t).then((t=>{t&&this.handleReadStatus(e)}))}getCollection(){return r(65677).default}}p.Proxy="statusV3",p.idClass=c.default;var h=(0,n.defineModel)(p);t.default=h},65677:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.StatusV3Collection=void 0;var i=a(r(45455)),n=a(r(90882)),s=a(r(16760)),o=a(r(94030)),l=a(r(18641)),d=a(r(99461)),u=a(r(23045)),c=r(33576),p=r(66239),h=a(r(20468)),f=a(r(84161)),_=a(r(30528)),m=a(r(93013)),g=r(11428),v=a(r(72451)),E=r(25054);class y extends l.default{delete(){super.delete(),delete this.checksum}_find(e){return Promise.resolve({id:e})}findQuery(e,t){return super.findQuery(e,t).then((e=>{var t=e||[];return Promise.all(t.map((e=>{if(e){var t=0;return e.msgs.forEach((r=>{t<e._msgs.length&&e._msgs[t].id.toString()===r.id.toString()?++t:r.delete()})),e._msgs.length>0?this.addStatusMessages(e.id,e._msgs):Promise.resolve()}}))).then((()=>t))}))}_findQuery(){return(0,g.queryStatusAll)().then((e=>(this.checksum=e.checksum,Promise.all(e.statuses.map((e=>{e.totalCount!==e._msgs.length&&e.totalCount<=20&&__LOG__(3)`Received ${e._msgs.length} status V3 messages when total count is ${e.totalCount} for ${e.id}`;var t=e.pic;return t?m.default.createFromData(t,"image/jpeg").then((t=>(e.pic=t,e))):e}))))))}loadMore(e,t,r){return(0,g.queryStatusUpdate)(e,t,r&&r.id).then((e=>e.status>=400?(__LOG__(3)`model:statusv3:findQuery error ${e.status}`,Promise.reject(e.status)):(e.forEach((function(e){e.invis=!0})),__LOG__(2)`model:statusv3:loadMore:${e.length}`,_.default.processMultipleMessages((0,E.createWid)(u.default.STATUS_WID),e,{add:"after",isHistory:!0}))))}sync(e){var t=window.performance.now();return!e||this.checksum&&this.checksum!==e?this.findQuery({},{set:this.hasSynced()}).catchType(c.WebdDrop,(()=>{})).finally((()=>{this.trigger("sync")})).tap((()=>{var e=window.performance.now(),r=Math.round(e-t);this.logMetrics({type:"sync",syncTime:r}),this.forEach((e=>{e.msgs.length>e.totalCount&&__LOG__(2)`Total count: ${e.totalCount}, msgs length: ${e.msgs.length}`}))})):Promise.resolve(void 0)}logMetrics(e){var t;t="sync"===e.type?new f.default.WebcStatusSync({webcStatusSyncT:e.syncTime}):new f.default.WebcStatusSession({webcStatusSessionId:e.sessionId});var r=this.filter((e=>!e.contact.isMe)),a=r.filter((e=>!e.contact.statusMute)),i=a.filter((e=>e.hasUnread)),n=a.filter((e=>!e.hasUnread)),s=r.filter((e=>e.contact.statusMute)),l=(0,o.default)(a.map((e=>e.unreadCount))),d=(0,o.default)(a.map((e=>e.readCount))),u=(0,o.default)(s.map((e=>e.totalCount)));t.webcStatusRecentItemCount=l,t.webcStatusRecentRowCount=i.length,t.webcStatusViewedItemCount=d,t.webcStatusViewedRowCount=n.length,t.webcStatusMutedItemCount=u,t.webcStatusMutedRowCount=s.length,t.commit()}hasSynced(){return!!h.default.supportsFeature(h.default.F.MD_BACKEND)||!!this.checksum}handleUpdate(e,t,r){var a=e.id.fromMe?(0,p.getMaybeMeUser)():e.author;if(this.updateChecksum(t),this.hasSynced()){if(r)return!0;var i=this.get(a);if(i){var n=h.default.supportsFeature(h.default.F.MD_BACKEND)||i.totalCount===i.msgs.length;if("revoke"===e.subtype){var o=i.msgs.toArray().slice(0,i.totalCount-i.unreadCount),l=(0,s.default)(o,(e=>e.id.toString())),d={totalCount:i.totalCount-1};l.find((t=>t===e.protocolMessageKey.toString()))||i.readKeys[e.protocolMessageKey.toString()]||(d.unreadCount=i.unreadCount-1),i.set(d)}else{var u={totalCount:i.totalCount+1};e.invis||(u.unreadCount=i.unreadCount+1),u.t=e.t,i.set(u)}return!n&&e.body&&m.default.createFromBase64Jpeg(e.body).then((e=>{i.pic=e})),n}return this.add({id:a,t:e.t,unreadCount:e.invis?0:1,totalCount:1}),!0}return!1}updateChecksum(e){e?this.hasSynced()&&(this.checksum=e):__LOG__(2)`models:statusV3:no_checksum`}handle(e){var t=e.shift();if(Array.isArray(t))__LOG__(3)`models:statusV3:unexpected update`;else switch(t.type){case"read":this.updateChecksum(t.checksum);var r=this.get(t.chat);r?r.handleReadStatus(t.key):__LOG__(2)`models:statusV3:read:no_status:${[t.chat,t.key].join()}`;break;default:__LOG__(3)`models:statusV3:unknown:${t.type}`}}addStatusMessages(e,t){return _.default.processMultipleMessages((0,E.createWid)(u.default.STATUS_WID),t,{add:"after",isHistory:!0})}getUnexpired(e){var t=this.filter((e=>e.totalCount>0&&d.default.globalUnixTime()-e.t<=86400&&e.contact.isMyContact&&!e.contact.isMe&&!e.contact.isPSA));return e?(0,n.default)(t,(e=>e.unreadCount>0)):(0,n.default)(t,(e=>0===e.unreadCount))}getMyStatus(){var e=this.filter((e=>e.contact.isMe));if((0,i.default)(e));else if(!(d.default.globalUnixTime()-e[0].t>86400))return e[0]}}t.StatusV3Collection=y,y.model=v.default,y.comparator=(e,t)=>t.t-e.t;var S=new y;t.default=S},49755:(e,t,r)=>{"use strict";var a=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(99778));class n extends i.default{constructor(...e){super(...e),this.id=(0,i.prop)(),this.sticker=(0,i.prop)(),this.timestamp=(0,i.prop)()}}n.Proxy="recentSticker";var s=(0,i.defineModel)(n);t.default=s},11541:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.RecentStickerCollection=t.RECENT_STICKERS_LIMIT=void 0;var n=i(r(70417)),s=i(r(22220)),o=i(r(18641)),l=a(r(79435)),d=i(r(20468)),u=i(r(21830)),c=i(r(32369)),p=i(r(27850)),h=i(r(94407)),f=32;t.RECENT_STICKERS_LIMIT=f;class _ extends o.default{constructor(...e){super(...e),this._checksum="",this._syncStatus="NONE",this._weightMap=new Map,this._sortTrimScale=()=>{var e=this.length;if(e){if(this.sort(),e>f){for(var t=f;t<e;t++)this._weightMap.delete((0,u.default)(this.at(t),"this.at(i)").id);this.remove(this.models.slice(f))}var r=this.head(),a=this.last();r&&a&&this._getWeight(r)<10&&this._getWeight(a)>.01||this.forEach(((t,r)=>{this._weightMap.set(t.id,1+(e-r)/e*3)}))}}}_comparator(e,t){return l.default.platform===l.PLATFORMS.ANDROID?this._getWeight(t)-this._getWeight(e):e.index>t.index?1:-1}_getWeight(e){return(0,u.default)(this._weightMap.get(e.id),"this._weightMap.get(sticker.id)")}_findQuery(){return d.default.isRecentStickersEnabled()?h.default.queryRecentStickers().then((({checksum:e,stickers:t})=>(this.setChecksum(e),l.default.platform===l.PLATFORMS.ANDROID&&(this._weightMap.clear(),t.forEach((({id:e,weight:t})=>{this._weightMap.set(e,t)}))),t.map(((e,t)=>{var{weight:r}=e,a=(0,s.default)(e,["weight"]);return(0,n.default)((0,n.default)({},a),{},{mediaKey:(0,c.default)(a.mediaKey),index:t})}))))):Promise.reject(new Error("gk recent sticker sync unsupported"))}enqueue(e){d.default.isRecentStickersEnabled()&&0!==e.length&&(l.default.platform===l.PLATFORMS.ANDROID?this._enqueueAndroid(e):this._enqueueiOS(e))}_enqueueAndroid(e){e.forEach((e=>{this.get(e.id)||(this._weightMap.set(e.id,0),this.add(e)),this.forEach((t=>{var r=this._getWeight(t);t.id===e.id?r+=1:r*=.9,this._weightMap.set(t.id,Math.round(1e3*r)/1e3)}))})),this._sortTrimScale()}_enqueueiOS(e){this.forEach(((e,t)=>{e.index=f+t}));var t=new Set(e.map((e=>e.id)));e.reduce(((e,r)=>t.has(r.id)?(t.delete(r.id),[r].concat(e)):e),[]).slice(0,f).forEach(((e,t)=>{var r=this.get(e.id);r?r.index=t:this.add({id:e.id,deprecatedMms3Url:e.deprecatedMms3Url,directPath:e.directPath,filehash:e.filehash,encFilehash:e.encFilehash,mediaKey:e.mediaKey,mediaKeyTimestamp:e.mediaKeyTimestamp,width:e.width,height:e.height,size:e.size,mimetype:e.mimetype,type:e.type,index:t})})),this.sort(),this.remove(this.slice(f))}setChecksum(e){this._checksum=e}sync(e){return d.default.isRecentStickersEnabled()&&(null==e||e!==this._checksum)?this._sync():Promise.resolve()}_sync(){return"INPROGRESS"===this._syncStatus?Promise.resolve():(this._syncStatus="INPROGRESS",this.findQuery({},{set:!0}).then((()=>{this.sort(),this._syncStatus="SUCCESS"})).catch((()=>{__LOG__(3)`collection:recent_sticker:_sync error `,this._syncStatus="FAILURE"})))}isSynced(){return"SUCCESS"===this._syncStatus||"FAILURE"===this._syncStatus}reset(){return this._syncStatus="NONE",this._weightMap.clear(),super.reset()}}t.RecentStickerCollection=_,_.model=p.default;var m=new _;t.default=m},11506:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.RecentStickerCollection=t.RECENT_STICKERS_LIMIT=void 0;var i=a(r(52954)),n=a(r(18641)),s=a(r(99461)),o=r(60301),l=a(r(49755)),d=a(r(27850)),u=r(31046),c=r(38027);t.RECENT_STICKERS_LIMIT=32;class p extends n.default{_comparator(e,t){return e.timestamp<t.timestamp?1:-1}_modelToDbData(e){return{id:e.id||e.filehash,index:e.index||0,width:e.width,height:e.height,size:e.size,mimetype:e.mimetype,filehash:e.filehash,directPath:e.directPath,mediaKey:e.mediaKey,mediaKeyTimestamp:null!=e.mediaKeyTimestamp?e.mediaKeyTimestamp:s.default.globalUnixTime(),encFilehash:e.encFilehash,deprecatedMms3Url:e.deprecatedMms3Url,type:o.OUTWARD_TYPES.STICKER}}_dbDataToModel(e){return new l.default({id:e.id,timestamp:e.timestamp,sticker:new d.default(e.sticker)})}_addSaveTask(){this._idleTaskId&&u.IdleCallbackTasks.isInQueue(this._idleTaskId)||(this._idleTaskId=u.IdleCallbackTasks.enqueue((()=>{this._saveToDb()})))}_saveToDb(){var e=this;return(0,i.default)((function*(){var t=[];if(e.toArray().forEach((r=>{var a={id:r.id,timestamp:r.timestamp,sticker:e._modelToDbData(r.sticker)};t.push(a)})),0!==t.length)try{var r=(0,c.getRecentStickersTable)();yield r.clear(),yield r.bulkCreateOrReplace(t)}catch(e){__LOG__(4,void 0,new Error,!0)`RecentStickerCollection attempt to save to database failed`,SEND_LOGS(e)}else __LOG__(4,void 0,new Error)`RecentStickerCollection._saveToDb called with empty collection`}))()}addStickerWithMediaData(e){this.addNewSticker(new d.default(e))}addNewSticker(e){e.id||(e.id=e.filehash),this.enqueue([[e,s.default.globalUnixTime()]])}enqueue(e){if(0!==e.length){var t=new Set(e.map((e=>e[0].id))),r=e.reduce(((e,[r,a])=>t.has(r.id)?(t.delete(r.id),[[r,a]].concat(e)):e),[]),a=[],i=!1;r.forEach((([e,t])=>{var r=this.get(e.id);if(r)r.timestamp<=t&&(r.timestamp=t,i=!0);else{var n=this._dbDataToModel({id:e.id,timestamp:t,sticker:e});i=!0,a.push(n)}})),i&&(this.addAndSort(a),this._addSaveTask())}}initializeFromCache(e){var t=e.map(this._dbDataToModel);this.addAndSort(t)}maybeRemove(e){var t=this.get(e);t&&this.remove(t)}addAndSort(e){this.add(e),this.sort(),this.length>32&&this.set(this.toArray().slice(0,32))}delete(){super.delete()}}t.RecentStickerCollection=p,p.model=l.default;var h=new p;t.default=h},89348:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.StarredStickerCollection=t.STARRED_STICKERS_PAGE_SIZE=void 0;var i=a(r(70417)),n=a(r(18641)),s=a(r(20468)),o=a(r(32369)),l=a(r(27850)),d=a(r(94407));t.STARRED_STICKERS_PAGE_SIZE=24;class u extends n.default{constructor(...e){super(...e),this._checksum="",this._syncStatus="NONE",this._currentPage=0,this._total=0}_findQuery(){return s.default.isStarredStickersEnabled()?d.default.queryStarredStickers(this._currentPage+1,24).then((({checksum:e,total:t,stickers:r})=>(this._checksum=e,this._currentPage+=1,this._total=t,r.map(((e,t)=>(0,i.default)((0,i.default)({},e),{},{mediaKey:(0,o.default)(e.mediaKey),index:this.length+t})))))):Promise.reject(new Error("gk starred sticker sync unsupported"))}add(e,t,r){return r&&(this._total+=1),super.add(e,t)}remove(e,t={}){return this._total-=1,super.remove(e,t)}syncNextPage(){return this.canLoadMore()?this._sync(!1).then((()=>{this.trigger("next_page_sync")})):Promise.resolve()}sync(e){return s.default.isStarredStickersEnabled()&&(null==e||e!==this._checksum)?(this.reset(),this._sync(!0).then((()=>{this.trigger("sync")}))):Promise.resolve()}_sync(e){return"INPROGRESS"===this._syncStatus?Promise.resolve():(this._syncStatus="INPROGRESS",this.findQuery({},{set:e}).then((()=>{this._syncStatus="SUCCESS"})).catch((()=>{__LOG__(3)`collection:starred_sticker:_sync error `,this._syncStatus="FAILURE"})))}isSynced(){return"SUCCESS"===this._syncStatus||"FAILURE"===this._syncStatus}canLoadMore(){return 0!==this._total&&this.length<this._total}getRemaining(){return this._total-this.length}reset(){return this._syncStatus="NONE",this._currentPage=0,this._checksum="",this._total=0,super.reset()}}t.StarredStickerCollection=u,u.model=l.default,u.comparator=(e,t)=>e.index>=t.index?1:-1;var c=new u;t.default=c},27850:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.Sticker=void 0;var n=i(r(25291)),s=a(r(99778)),o=a(r(27305)),l=i(r(86619)),d=r(60301),u=i(r(84161)),c=r(68571),p=(r(87471),i(r(20468))),h=(0,n.default)((()=>new _({id:"placeholder",isPlaceholder:!0})));class f extends s.default{constructor(...e){super(...e),this.id=(0,s.prop)(),this.mediaData=(0,s.session)(),this.mediaObject=(0,s.prop)(),this.deprecatedMms3Url=(0,s.prop)(),this.directPath=(0,s.prop)(),this.filehash=(0,s.prop)(),this.height=(0,s.prop)(),this.index=(0,s.prop)(),this.mediaKey=(0,s.prop)(),this.mediaKeyTimestamp=(0,s.prop)(),this.mimetype=(0,s.prop)(),this.size=(0,s.prop)(),this.type=(0,s.prop)(d.OUTWARD_TYPES.STICKER),this.encFilehash=(0,s.prop)(),this.width=(0,s.prop)(),this.isPlaceholder=(0,s.prop)()}initialize(){super.initialize(),this.addChild("mediaData",new l.default),this.isPlaceholder||o.registerSticker(this)}downloadMedia(){return o.downloadStickerOrStickerPackIcon(this,"STICKER").catch((e=>{__LOG__(4,void 0,new Error,!0)`id: ${this.id}, error: ${String(e.stack||e)}`,SEND_LOGS("sticker-panel:sticker download failed")}))}sendToChat(e,t){r(11541).default.enqueue([this]),p.default.supportsFeature(p.default.F.MD_BACKEND)&&r(11506).default.addNewSticker(this),this.mediaData&&this.mediaData.mediaBlob&&this.mediaData.mediaBlob.retain();var{ctwaContextLinkData:a,ctwaContext:i}=e.getComposeContents(),n={quotedMsg:e.composeQuotedMsg,ctwaContext:(0,c.prepareCtwaContextSend)(a,i)};return e.composeQuotedMsg=null,(0,o.prepSticker)(this).sendToChat(e,n).then((e=>{var r=new u.default.StickerSend({stickerSendOrigin:t.stickerSendOrigin,stickerIsAnimated:Boolean(this.mediaData.isAnimated)});return null!=t.stickerIsFirstParty&&(r.stickerIsFirstParty=t.stickerIsFirstParty),r.commit(),e}))}delete(){super.delete(),o.deregisterSticker(this)}}t.Sticker=f,f.Proxy="sticker",f.getPlaceholder=h;var _=(0,s.defineModel)(f);_.getPlaceholder=h;var m=_;t.default=m},22579:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.StickerCollection=t.FETCH_STATE=void 0;var i=a(r(18641)),n=a(r(27850));t.FETCH_STATE={PENDING:"PENDING",SUCCESS:"SUCCESS",ERROR:"ERROR"};class s extends i.default{fetch(){throw new Error(`${this.constructor.name}.fetch is not implemented`)}}t.StickerCollection=s,s.model=n.default;var o=new s;t.default=o},71933:(e,t,r)=>{"use strict";var a=r(14859),i=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.StickerPack=t.PRE_PLACEHOLDER_ID=void 0;var n=i(r(99778)),s=a(r(86619)),o=r(60301),l=a(r(1266)),d="placeholder:";t.PRE_PLACEHOLDER_ID=d;var u=({index:e,page:t})=>new p({id:`placeholder:${e}`,index:e,page:t});class c extends n.default{constructor(...e){super(...e),this.id=(0,n.prop)(),this.index=(0,n.prop)(),this.name=(0,n.prop)(),this.page=(0,n.prop)(),this.url=(0,n.prop)(),this.mimetype=(0,n.prop)("image/png"),this.mediaData=(0,n.session)(),this.mediaObject=(0,n.prop)(),this.directPath=(0,n.prop)(),this.filehash=(0,n.prop)(),this.mediaKey=(0,n.prop)(),this.mediaKeyTimestamp=(0,n.prop)(),this.size=(0,n.prop)(),this.type=(0,n.prop)(o.OUTWARD_TYPES.IMAGE),this.encFilehash=(0,n.prop)(),this.deprecatedMms3Url=(0,n.derived)(this._deprecatedMms3Url,["url","isFirstParty"]),this.stickers=(0,n.derived)(this._getStickersCollection,["id"]),this.isPlaceholder=(0,n.derived)(this._isPlaceholder,["id"]),this.isFirstParty=(0,n.derived)(this._isFirstParty,["url","mediaKey"])}_deprecatedMms3Url(){return this.isFirstParty?"":this.url}_isPlaceholder(){return c.isPlaceholderId(this.id)}_isFirstParty(){return Boolean(this.url)&&!this.mediaKey}_getStickersCollection(){return this._stickers=this._stickers||new l.default(this.id.split("#")[0],this.isFirstParty),this._stickers}initialize(){super.initialize(),this.isPlaceholder||this.isFirstParty||(this.addChild("mediaData",new s.default({renderableUrl:""})),r(27305).registerStickerPackIcon(this))}downloadMedia(){return this.isPlaceholder||this.isFirstParty?Promise.resolve():r(27305).downloadStickerOrStickerPackIcon(this,"STICKER_PACK").catch((e=>{__LOG__(4,void 0,new Error,!0)`id: ${this.id}, error: ${String(e.stack||e)}`,SEND_LOGS("sticker-panel:sticker-pack download failed")}))}delete(){super.delete(),r(27305).deregisterStickerPackIcon(this)}}t.StickerPack=c,c.Proxy="stickerPack",c.createPlaceholder=u,c.isPlaceholderId=e=>new RegExp("^placeholder:").test(e);var p=(0,n.defineModel)(c),h=p;t.default=h,p.createPlaceholder=u,p.isPlaceholderId=c.isPlaceholderId},87966:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.StickerPackCollection=t.PAGE_FETCH_STATE=t.PAGE_SIZE_POPUP=t.PAGE_SIZE_COMPOSE_BOX=void 0;var i=a(r(70417)),n=a(r(52954)),s=a(r(61258)),o=a(r(13888)),l=a(r(18641)),d=a(r(71933)),u=a(r(94407));t.PAGE_SIZE_COMPOSE_BOX=9;t.PAGE_SIZE_POPUP=6;var c={PENDING:"PENDING",SUCCESS:"SUCCESS",ERROR:"ERROR"};t.PAGE_FETCH_STATE=c;class p extends l.default{constructor(){super(),this.checksum=null,this._pageFetchPromises={},this.pageFetchStates={},this._handleChecksumChange=()=>{Object.keys(this.pageFetchStates).forEach((e=>this._resetFetchPageStateAndPromise(parseInt(e,10)))),this._resetRangeWithPlaceholders(0,this.length),this.fetchAt(0,!1,!0)},this.listenTo(this,"change:checksum",this._handleChecksumChange)}createPlaceholder(e){return p.createPlaceholder(e)}preFetch(){var e=this;return(0,n.default)((function*(){yield e.fetchAt(0).then((()=>Promise.all(e.filter((e=>e.isFirstParty)).map((e=>e.stickers.fetch())))))}))()}fetchAt(e,t,r){return this._fetchPageWithIndex(e,Boolean(t),Boolean(r))}hasFetchedData(){return Object.keys(this.pageFetchStates).some((e=>this.pageFetchStates[parseInt(e,10)]===c.SUCCESS))}isFetchingData(){return Object.keys(this.pageFetchStates).some((e=>this.pageFetchStates[parseInt(e,10)]===c.PENDING))}pageWithIndex(e){return p.pageWithIndex(e)}reset(){return this.setChecksum(null,{silent:!0}),Object.keys(this.pageFetchStates).forEach((e=>this._resetFetchPageStateAndPromise(parseInt(e,10)))),super.reset()}sync(e){this.setChecksum(e)}setChecksum(e,t){return this.checksum!==e&&(this.checksum=e,t&&t.silent||this.trigger("change:checksum",e),!0)}_fetchPageWithIndex(e,t,r){var a=this.pageWithIndex(e);return this._fetchPage(a,t,r)}_fetchPage(e,t,r){var a,i=this.pageFetchStates[e];if(t&&i!==c.PENDING&&(a=this._pageFetchPromises[e])&&(a.cancel(),delete this._pageFetchPromises[e]),a=this._pageFetchPromises[e])return a;var n=this.length;return this._insertPagePlaceholders(e),this._setFetchPageState(e,c.PENDING),this._pageFetchPromises[e]=u.default.queryStickerPacks(e,9).cancellable().then((t=>{var a=this._parseStickerPacksRes(e,t),i=r||this.setChecksum(t.checksum,{silent:!0}),s=9*(e-1),o=9*(e+0);this._resetRange(s,o,a),i&&(this._resetRangeWithPlaceholders(0,s),this._resetRangeWithPlaceholders(Math.min(s+a.length,o),t.count));var l=this.length;n!==l&&this.trigger("change:length",l),this._setFetchPageState(e,c.SUCCESS)})).catch((t=>{if(t instanceof Promise.CancellationError)return __LOG__(2)`StickerPack page fetch promise cancelled: ${e}`,void this._unsetFetchPageStateAndPromise(e);this._setFetchPageState(e,c.ERROR)})),this._pageFetchPromises[e]}_insertPagePlaceholders(e){var t=e-1;this._resetRangeWithPlaceholders(9*t,9*(t+1))}_parseStickerPacksRes(e,t){if(200!==t.status||!t.data)throw new Error("sticker packs query error");return t.data.map(((t,r)=>(0,i.default)((0,i.default)({},(0,o.default)(t,["id","mimetype","name","url","mediaKey","filehash","directPath"])),{},{encFilehash:t.encFilehash,page:e,index:9*(e-1)+r})))}_resetRangeWithPlaceholders(e,t){this._resetRange(e,t,(0,s.default)(t-e,(t=>p.createPlaceholder(e+t))))}_resetRange(e,t,r){this._forEachInRange(e,t,((t,a)=>{var i=r[a-e];if(t)if(i)t.id===i.id?(this.remove(t,{silent:!0}),this.add(i)):(this.remove(t),this.add(i));else for(var n=t;n;)this.remove(n),n=this.at(a);else i&&this.add(i)}))}_forEachInRange(e,t,r){for(var a=e;a<t;a++){r(this.at(a),a)}}_resetFetchPageStateAndPromise(e){e in this.pageFetchStates&&(this.pageFetchStates[e]===c.PENDING?this._pageFetchPromises[e].cancel():this._unsetFetchPageStateAndPromise(e))}_setFetchPageState(e,t){this.pageFetchStates[e]!==t&&(this.pageFetchStates[e]=t,this.trigger("change:pageFetchStates",e,t))}_unsetFetchPageState(e){e in this.pageFetchStates&&(delete this.pageFetchStates[e],this.trigger("change:pageFetchStates",e))}_unsetFetchPageStateAndPromise(e){delete this._pageFetchPromises[e],this._unsetFetchPageState(e)}}t.StickerPackCollection=p,p.model=d.default,p.comparator=function(e,t){return e.index<t.index?-1:e.index>t.index?1:0},p.createPlaceholder=function(e){return d.default.createPlaceholder({index:e,page:this.pageWithIndex(e)})},p.pageWithIndex=function(e){return Math.floor(e/9)+1};var h=new p;t.default=h},1266:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"FETCH_STATE",{enumerable:!0,get:function(){return d.FETCH_STATE}}),t.default=void 0;var i=a(r(70417)),n=a(r(13888)),s=r(75197),o=r(22579),l=a(r(94407)),d=r(22579);class u extends o.StickerCollection{constructor(e,t){super(),this._parseStickersRes=e=>{if(200!==e.status||!e.data)throw new Error("sticker pack stickers query error");return e.data.map(((e,t)=>(0,i.default)((0,i.default)({},(0,n.default)(e,["directPath","mimetype","mediaKey","filehash","width","height"])),{},{index:t,id:e.filehash,deprecatedMms3Url:e.url,encFilehash:e.encFilehash,mediaKeyTimestamp:0})))},this.stickerPackId=e,this.isFirstParty=t;var r,a=u._cache[this.stickerPackId];if(a)return a;var s=this;Object.defineProperty(this,"fetchState",{get:()=>r,set(e){r!==e&&(r=e,s.trigger("change:fetchState",e))}})}fetch(e){return e&&this.fetchState!==o.FETCH_STATE.PENDING&&delete this._fetchPromise,this._fetchPromise?this._fetchPromise:(this.fetchState=o.FETCH_STATE.PENDING,r(71933).default.isPlaceholderId(this.stickerPackId)?(this._fetchPromise=new Promise((()=>{})),this._fetchPromise):(t=this.isFirstParty?(0,s.fetchFirstPartyStickers)(this.stickerPackId):l.default.queryStickersInStickerPack(this.stickerPackId).then(this._parseStickersRes),this._fetchPromise=t.then((e=>{var t=Math.max(this.length||e.length);this._resetRange(0,t,e),this.fetchState=o.FETCH_STATE.SUCCESS})).catch((()=>{this.fetchState=o.FETCH_STATE.ERROR})),this._fetchPromise));var t}_resetRange(e,t,r){this._forEachInRange(e,t,((t,a)=>{var i=r[a-e];t?i?t.id===i.id?t.set(i):(this.remove(t),this.add(i)):this.remove(t):i&&this.add(i)}))}_forEachInRange(e,t,r){for(var a=e;a<t;a++){r(this.at(a),a)}}}t.default=u,u._cache={},u.comparator=(e,t)=>e.index<t.index?-1:e.index>t.index?1:0},96377:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.Obscurity=t.StreamMode=t.StreamInfo=void 0;var n=i(r(54073)),s=r(35160),o=a(r(99778)),l=i(r(13277)),d=i(r(23045)),u=r(66239),c=i(r(20468)),p=i(r(84161)),h=i(r(66622)),f=r(35407),_=a(r(30939)),m=r(11968),g=i(r(3472)),v=r(97247),E=i(r(49809)),y=a(r(15934)),S=r(63191),T=r(28103).Mirrored(["OFFLINE","OPENING","PAIRING","SYNCING","RESUMING","CONNECTING","NORMAL","TIMEOUT"]);t.StreamInfo=T;var A=r(28103).Mirrored(["QR","MAIN","SYNCING","OFFLINE","CONFLICT","PROXYBLOCK","TOS_BLOCK","SMB_TOS_BLOCK","DEPRECATED_VERSION"]);t.StreamMode=A;var b=r(28103).Mirrored(["SHOW","OBSCURE","HIDE"]);t.Obscurity=b;class C extends o.default{constructor(...e){super(...e),this.info=(0,o.session)(T.NORMAL),this.mode=(0,o.session)(A.SYNCING),this.obscurity=(0,o.session)(b.HIDE),this.needsUpdate=(0,o.session)(),this.clientExpired=(0,o.session)(!1),this.hardExpired=(0,o.session)(!1),this.lastSyncStart=(0,o.session)(w()),this.couldForce=(0,o.session)(),this.uiActive=(0,o.session)(),this.available=(0,o.session)(!0),this.unavailableShiftTimer=(0,o.session)(),this.unavailableLogoutTimer=(0,o.session)(),this.unobscureShiftTimer=(0,o.session)(),this.timeoutEvent=(0,o.session)(),this.resumeCount=(0,o.session)(0),this.phoneAuthed=(0,o.session)(!1),this._activeModeMeasure=(0,o.session)(),this.displayInfo=(0,o.derived)(this._displayInfo,["info","obscurity"])}_displayInfo(){return function(e,t){switch(t){case b.SHOW:return e;case b.HIDE:return y.default.hasSynced?T.NORMAL:T.CONNECTING;case b.OBSCURE:switch(e){case T.OPENING:case T.PAIRING:case T.SYNCING:case T.RESUMING:return T.CONNECTING;default:return e}}return __LOG__(3)`Stream:unknown obscure level:`,e}(this.info,this.obscurity)}initialize(){super.initialize(),c.default.supportsFeature(c.default.F.MD_BACKEND)&&!(0,S.isRegistered)()&&(this.mode=A.QR),this._activeModeMeasure=_.startMeasure(`Stream.mode: ${this.mode}`),__LOG__(2)`Stream:rememberMe: ${String((0,u.getRememberMe)())}`,this.unavailableShiftTimer=new s.ShiftTimer((()=>this.markUnavailable())),this.unobscureShiftTimer=new s.ShiftTimer((()=>this.unobscure())),this.unavailableLogoutTimer=new s.ShiftTimer((function(){(0,u.getRememberMe)()||(__LOG__(2)`Stream:unavailableLogoutTimer logout due to inactivity`,y.default.logout())})),this.listenTo(y.default,"change:state change:stream change:hasSynced",this.onSocketUpdate),this.listenTo(h.default,"change:online",this.onSocketUpdate),this.listenTo(this,"change:available",this.onAvailableUpdate),this.listenTo(this,"change:phoneAuthed",this.onPhoneAuthedUpdate),this.listenTo(this,"change:info change:displayInfo change:mode",(0,n.default)(this.onSelfUpdate)),this.listenTo(this,"change:info",this.logPageResume),this.listenTo(this,"change:info",this.updateWamLog),this.listenTo(this,"change:mode",this.logModeChange),this.listenTo(this,"change:available change:uiActive",this.updateCouldForce),this.listenTo(l.default,"midnight",this.updateHardExpire.bind(this)),c.default.supportsFeature(c.default.F.MD_BACKEND)&&this.listenTo(l.default,"socket_stream_disconnected",(()=>{r(93997).default.clearAllPresence()})),window.document&&document.addEventListener("visibilitychange",this.updateCouldForce),this.updateCouldForce(),this.updateHardExpire()}delete(){}markAvailable(){this.unavailableShiftTimer.cancel(),this.available=!0,(0,v.monitor)(!0,this.displayInfo===T.TIMEOUT)}markUnavailable(e){null!=e&&0!==e?this.unavailableShiftTimer.onOrBefore(e):(this.unavailableShiftTimer.cancel(),this.available=!1,(0,v.monitor)(!1,this.displayInfo===T.TIMEOUT))}onSelfUpdate(){__LOG__(2)`Stream:onSelfUpdate mode:${this.mode} info:${this.info} view:${this.displayInfo}`;var e=this.timeoutEvent;if(this.info===T.TIMEOUT)e||(this.timeoutEvent=e=new p.default.WebcPhoneDisconnected),this.displayInfo===T.TIMEOUT&&null==this._bbarTime&&(this._bbarTime=Date.now());else if(e){e.markWebcPhoneDisconnectedT();var t=this._bbarTime;null!=t&&(e.webcPhoneBbarShownT=Date.now()-t),e.commit(),this.timeoutEvent=null,this._bbarTime=null}}onSocketUpdate(){var e={},t=function(){switch(y.default.state){case y.STATE.TIMEOUT:return T.TIMEOUT;case y.STATE.OPENING:return h.default.online?T.OPENING:T.OFFLINE;case y.STATE.PAIRING:return y.default.hasSynced?T.RESUMING:T.PAIRING;case y.STATE.CONNECTED:return y.default.stream!==y.STREAM.CONNECTED?y.default.hasSynced?T.NORMAL:T.SYNCING:T.NORMAL;case y.STATE.UNLAUNCHED:case y.STATE.PROXYBLOCK:default:return T.NORMAL}}();if(e.info=t,e.mode=function(){var e=!1;e=c.default.supportsFeature(c.default.F.MD_BACKEND)?(0,S.isRegistered)():(0,u.knowsPhone)();if(!e&&y.default.state!==y.STATE.PROXYBLOCK)return A.QR;var t=y.default.hasSynced;switch(y.default.state){case y.STATE.PROXYBLOCK:return A.PROXYBLOCK;case y.STATE.CONFLICT:return A.CONFLICT;case y.STATE.TOS_BLOCK:return A.TOS_BLOCK;case y.STATE.SMB_TOS_BLOCK:return A.SMB_TOS_BLOCK;case y.STATE.DEPRECATED_VERSION:return A.DEPRECATED_VERSION;case y.STATE.UNLAUNCHED:return A.SYNCING;case y.STATE.UNPAIRED_IDLE:case y.STATE.UNPAIRED:return A.QR;case y.STATE.OPENING:if(!h.default.online&&!y.default.hasSynced)return A.OFFLINE;default:return t||y.default.stream===y.STREAM.CONNECTED?A.MAIN:A.SYNCING}}(),e.phoneAuthed=y.default.stream!==y.STREAM.DISCONNECTED,t===T.NORMAL)this.unobscureShiftTimer.cancel(),e.obscurity=b.HIDE;else if(t===T.OFFLINE)this.unobscureShiftTimer.cancel(),e.obscurity=b.OBSCURE;else switch(this.obscurity){case b.HIDE:this.unobscureShiftTimer.onOrBefore(d.default.DIAGNOSTIC_DELAY);break;case b.OBSCURE:this.unobscureShiftTimer.onOrBefore(3e3);break;case b.SHOW:}this.set(e)}unobscure(){this.obscurity=b.SHOW}onPhoneAuthedUpdate(){this.phoneAuthed&&(this.sendAvailability(!0),r(25150).default.sync())}onAvailableUpdate(){var e=this.available;if(__LOG__(2)`Stream:onAvailableUpdate user ${e?"available":"unavailable"}`,e||(0,u.getRememberMe)()?this.unavailableLogoutTimer.cancel():this.unavailableLogoutTimer.onOrBefore(d.default.IDLE_TIMEOUT_WAIT),this.sendAvailability(!1),c.default.supportsFeature(c.default.F.MD_BACKEND))if(e){var{sendDeliveryReceiptsAfterPresence:t}=r(40822);t()}else{r(93997).default.clearAllPresence()}}sendAvailability(e){(e||this.uiActive)&&(this.available?(0,m.sendPresenceAvailable)():(0,m.sendPresenceUnavailable)())}updateCouldForce(){this.couldForce=!this.uiActive||!this.available&&document.hidden}updateHardExpire(){g.default.isExpired()&&(this.hardExpired=!0,g.default.restart(!0))}logPageResume(){this.info===T.RESUMING&&(this.resumeCount++,new p.default.WebcPageResume({webcResumeCount:this.resumeCount}).commit())}updateWamLog(){var e=this.info===T.NORMAL;(0,f.streamInfoChange)(this.info,E.default.numSocketsAttempted,e),e&&this.stopListening(this,"change:info",this.updateWamLog)}logModeChange(){this._activeModeMeasure&&this._activeModeMeasure.end(),this.mode===A.SYNCING&&(this.lastSyncStart=w()),this._activeModeMeasure=_.startMeasure(`Stream.mode: ${this.mode}`),new p.default.WebcStreamModeChange({webcStreamMode:P(this.mode)}).commit()}}function P(e){switch(e){case A.QR:return p.default.WEBC_STREAM_MODE_CODE.QR;case A.MAIN:return p.default.WEBC_STREAM_MODE_CODE.MAIN;case A.SYNCING:return p.default.WEBC_STREAM_MODE_CODE.SYNCING;case A.OFFLINE:return p.default.WEBC_STREAM_MODE_CODE.OFFLINE;case A.CONFLICT:return p.default.WEBC_STREAM_MODE_CODE.CONFLICT;case A.PROXYBLOCK:return p.default.WEBC_STREAM_MODE_CODE.PROXYBLOCK;case A.DEPRECATED_VERSION:return p.default.WEBC_STREAM_MODE_CODE.DEPRECATED_VERSION;case A.TOS_BLOCK:case A.SMB_TOS_BLOCK:return p.default.WEBC_STREAM_MODE_CODE.TOS_BLOCK}}C.Proxy="stream";var O=new((0,o.defineModel)(C));function w(){return Math.floor(window.performance.now())}t.default=O},68473:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(r(67304)),s=i(r(35676)),o=a(r(99778)),l=i(r(13649));class d extends o.default{constructor(...e){super(...e),this.id=(0,o.prop)(),this.pendingMsgs=(0,o.prop)(),this.labels=(0,o.prop)(),this.msgChunks=(0,o.session)((()=>[])),this.lastReceivedKey=(0,o.session)(),this.unreadMsgAnchor=(0,o.session)(),this.disableUnreadAnchor=(0,o.session)(),this.msgsLength=(0,o.session)(),this.msgsChanged=(0,o.session)(0),this.msgs=(0,o.collection)(l.default)}initialize(){super.initialize(),this.listenTo(this.msgs,"change:last",(()=>{this.msgsChanged++})),this.listenTo(this.msgs,"add remove bulk_add",(()=>{this.msgsChanged++,this.msgsLength=this.msgs.length}))}onEmptyMRM(){throw new Error("onEmptyMRM not implemented")}delete(){super.delete(),this.getAllCMCs().forEach((e=>{e.forEach((e=>{e.delete()})),e.delete()}))}removeMsg(e){var t=e.msgChunk;t&&(t.indexOf(e)<0||(__LOG__(2)`models:Chat:removeMsg ${e.get("id")}`,t.remove(e),0===t.length&&(t===this.msgs?this.onEmptyMRM():this.removeMsgsCollection(t))))}getAllCMCs(){return this.msgChunks.concat([this.msgs])}getAllMsgs(){return(0,s.default)(this.getAllCMCs().map((e=>e.getModelsArray())))}replaceMsgsCollection(e){__LOG__(2)`model:Chat:replaceMsgsCollection:${this.id.toString()}`;var t={msg:e.last()};this.msgs.replace(e),this.notifyMsgCollectionMerge(e,this.msgs,this.msgs,t),this.msgChunks=(0,n.default)(this.msgChunks,e),e.delete()}removeMsgsCollection(e){this.msgChunks=(0,n.default)(this.msgChunks,e),e.delete()}notifyMsgCollectionMerge(e,t,r,a){this.trigger("change:cmc:merge",e,t,r,a)}}t.default=d},25257:(e,t,r)=>{"use strict";var a=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(99778));class n extends i.default{constructor(...e){super(...e),this.id=(0,i.prop)(),this.displayText=(0,i.prop)(),this.subtype=(0,i.prop)(),this.url=(0,i.prop)(),this.phoneNumber=(0,i.prop)(),this.selectionId=(0,i.prop)(),this.selected=(0,i.session)(!1)}}n.Proxy="templateButton";var s=(0,i.defineModel)(n);t.default=s},7323:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.TemplateButtonCollection=void 0;var i=a(r(18641)),n=a(r(25257));class s extends i.default{}t.TemplateButtonCollection=s,s.model=n.default,s.comparator=(e,t)=>e.id<t.id?-1:e.id>t.id?1:0;var o=s;t.default=o},13754:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(18641)),n=a(r(36169));class s extends i.default{}t.default=s,s.model=n.default,s.comparator=function(e,t){return t.t-e.t}},90608:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={cache:{},delete:function(){this.cache={}}}},15934:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.STREAM=t.STATE=void 0;var n=i(r(52954)),s=i(r(45126)),o=i(r(67304)),l=i(r(90882)),d=i(r(15253)),u=i(r(17335)),c=i(r(29259)),p=i(r(13888)),h=i(r(16760)),f=i(r(45455)),_=r(60266),m=r(13275),g=r(7355),v=r(49244),E=r(71436),y=r(84337),S=i(r(49833)),T=i(r(19034)),A=r(71796),b=a(r(99778)),C=i(r(92082)),P=a(r(2537)),O=i(r(36457)),w=i(r(87538)),M=i(r(99461)),I=i(r(13277)),R=i(r(79435)),D=i(r(1655)),N=i(r(23045)),L=r(33576),k=a(r(24461)),U=r(94784),G=r(66239),F=i(r(20468)),x=r(9690),B=r(27246),Y=r(81725),K=r(38027),j=i(r(79569)),W=r(3060),H=a(r(20951)),V=i(r(82770)),$=a(r(29666)),q=i(r(34749)),z=i(r(64301)),J=i(r(20073)),Q=i(r(24307)),X=a(r(56179)),Z=i(r(3472)),ee=i(r(12404)),te=a(r(32725)),re=r(49809),ae=i(r(51538)),ie=r(63191),ne=r(92199),se=i(r(9247)),oe=r(7017),le=r(35540),de=r(64261),ue=i(r(54559)),{FLAVOR_TAGS:ce,VERSION:pe,LOGOUT_URL:he,SOCKET_STATE:fe,SOCKET_STREAM:_e,SPEEDY_RESUME_MAX_CHATS:me}=N.default;t.STREAM=_e,t.STATE=fe;class ge extends((0,E.customError)("ExternalPoke")){}class ve extends((0,E.customError)("MustExitLoop")){}class Ee extends((0,E.customError)("Denied401Failed")){}class ye extends((0,E.customError)("Denied409Conflict")){}class Se extends((0,E.customError)("DeniedTOS")){}class Te extends((0,E.customError)("DeniedTOSGDPR",!0,Se)){}class Ae extends((0,E.customError)("DeniedTOSSMB",!0,Se)){}class be extends((0,E.customError)("DeniedUnknown")){}class Ce extends((0,E.customError)("ForcedRefresh")){}class Pe extends((0,E.customError)("TooManyRefRequest")){}class Oe extends((0,E.customError)("UILogout")){}class we extends((0,E.customError)("WindowOffline")){}class Me extends((0,E.customError)("PhoneFailedPing")){}class Ie extends((0,E.customError)("AssertionFailed")){}class Re extends((0,E.customError)("TakeoverRequested")){}class De extends((0,E.customError)("PhoneReplacedClient")){}class Ne extends((0,E.customError)("NoSecretBundle")){}class Le extends((0,E.customError)("PhoneKickedClient")){}class ke extends((0,E.customError)("TempServerError")){}var Ue={SYNC_INFO:["Conn",z.default.OBJECT],CHALLENGE:["Cmd",{type:"challenge",challenge:z.default.STRING}],DISCONNECT:["Cmd",{type:"disconnect",kind:void 0}],HARD_REFRESH:["Cmd",{type:"update"}],UPGRADE_MD_FOR_INTERNAL_USER:["Cmd",{type:"upgrade_md"}],UPGRADE_MD_FOR_PROD:["Cmd",{type:"upgrade_md_prod",version:void 0}],PONG:["Pong",z.default.BOOLEAN]},Ge={TAG:e=>new z.default({tag:e,data:z.default.ANY,binarySize:z.default.ANY}),SYNC_INFO:new z.default({tag:z.default.ANY,data:Ue.SYNC_INFO,binarySize:z.default.ANY}),CHALLENGE:new z.default({tag:z.default.ANY,data:Ue.CHALLENGE,binarySize:z.default.ANY}),DISCONNECT:new z.default({tag:z.default.ANY,data:Ue.DISCONNECT,binarySize:z.default.ANY}),HARD_REFRESH:new z.default({tag:z.default.ANY,data:Ue.HARD_REFRESH,binarySize:z.default.ANY}),UPGRADE_MD_FOR_INTERNAL_USER:new z.default({tag:z.default.ANY,data:Ue.UPGRADE_MD_FOR_INTERNAL_USER,binarySize:z.default.ANY}),UPGRADE_MD_FOR_PROD:new z.default({tag:z.default.ANY,data:Ue.UPGRADE_MD_FOR_PROD,binarySize:z.default.ANY}),PONG:new z.default({tag:z.default.ANY,data:Ue.PONG,binarySize:z.default.ANY})},Fe=new z.default({status:e=>"number"==typeof e&&e>=500,_:void 0}),xe=new z.default({status:e=>"number"==typeof e&&499===e,_:void 0}),Be=new z.default({status:e=>"number"==typeof e,_:void 0});class Ye extends b.default{constructor(...e){super(...e),this.socketPreload=(0,b.session)(),this.socket=(0,b.session)(),this.launchGeneration=(0,b.session)(0),this.backoffGeneration=(0,b.session)(0),this.hasSynced=(0,b.session)(),this.state=(0,b.session)(fe.UNLAUNCHED),this.stream=(0,b.session)(_e.DISCONNECTED),this.canSend=(0,b.session)(),this.sendQueue=(0,b.session)(),this.sendHash=(0,b.session)(),this.cancelHash=(0,b.session)(),this.doubleAckHash=(0,b.session)(),this.sequence=(0,b.session)(0),this.shortTagBase=(0,b.session)(),this.socketWatcher=(0,b.session)(),this.refWatcher=(0,b.session)(),this.phoneWatchdog=(0,b.session)(),this.pendingPhoneReqs=(0,b.session)(0),this.isIncognito=(0,b.session)(),this.runPromise=(0,b.session)(),this.streamPromise=(0,b.session)(),this.conflictPromise=(0,b.session)(),this.resumePromise=(0,b.session)(),this.logoutMutex=(0,b.session)(0),this.retryTimestamp=(0,b.session)(),this.pokeable=(0,b.session)(),this.launched=(0,b.session)(),this.mustExitLoop=(0,b.session)(),this.syncTag=(0,b.session)(),this.lastPhoneMessage=(0,b.session)(),this.shouldForceReconnect=(0,b.session)(!1),this.shouldUpgradeToMDIntern=(0,b.session)(!1),this.shouldUpgradeToMDPord=(0,b.session)(!1)}initialize(){F.default.supportsFeature(F.default.F.MD_BACKEND)||(this.sendQueue=[],this.sendHash={},this.cancelHash={},this.doubleAckHash={},this.phoneWatchdog=new te.default({waitAlgorithm:(0,te.fibonacci)(3e3,3e3,36e5),onTimeout:this.phoneTimedOut.bind(this),onActivated:this.onPhoneWatchdogActivated.bind(this),onFed:this.onPhoneWatchdogFed.bind(this),onDeactivated:this.onPhoneWatchdogDeactivated.bind(this)})),this.listenTo(this,"change:state",this.onStateChange.bind(this)),this.listenTo(this,"change:stream",this.onStreamChange.bind(this)),(0,_.delayMs)(0).then(H.determineIncognito).then((e=>{this.isIncognito=e})),this.listenTo(I.default,"log_socket_summary",this.summary),this.listenTo(I.default,"set_socket_state",(e=>{this.state=e})),this.listenTo(I.default,"open_socket_stream",(()=>{this.openStream(),this.hasSynced&&this.set({stream:_e.CONNECTED})})),this.listenTo(I.default,"socket_stream_disconnected",(()=>{this.set({stream:_e.DISCONNECTED})})),this.listenTo(I.default,"on_critical_sync_done",(()=>{__LOG__(2)`[ws2] observed on_critical_sync_done`,this.onCriticalSyncDone()})),this.listenTo(I.default,"main_stream_mode_ready",(()=>{__LOG__(2)`[ws2] observed main_stream_mode_ready`,!F.default.supportsFeature(F.default.F.MD_BACKEND)||(0,ie.getAllCriticalDataSynced)()||F.default.supportsFeature(F.default.F.MD_E2E)?(__LOG__(2)`[ws2] moving to main screen from main_stream_mode_ready`,this.set({hasSynced:!0,stream:_e.CONNECTED})):__LOG__(2)`[ws2] did not meet conditions to move to main screen`})),this.listenTo(I.default,"socket_stream_disconnected",(()=>{this.stream=_e.DISCONNECTED}))}preload(){F.default.supportsFeature(F.default.F.MD_BACKEND)||(this.socketPreload=new J.default)}send(e){var t=new V.default(e);this.sendQueue.push(t),this.flushQueue()}send2(e){return new Promise(((t,r)=>{var a=new V.default(e);a.onSend=t,a.onDrop=r,this.sendQueue.push(a),this.flushQueue()}))}shortTag(){return this.shortTagBase||(this.shortTagBase=((0,T.default)().unix()%1e3).toString()),`${this.shortTagBase}.--${this.sequence++}`}tag(e){var t=`${(0,T.default)().unix()}.--${this.sequence++}`;return e&&ce?t+"-"+e:t}launch(e,t=0){__LOG__(2)`ws2:Launch gen${this.launchGeneration} (backoff gen${this.backoffGeneration})`;var r=300*X.expBackoff(this.backoffGeneration,100),a=Date.now()+r;if(this.launched){var i=new Error("Redundant Launch");return __LOG__(3,!0)`ws2:launch redundantly called!\n${i.stack}`,void P.upload({reason:"redundant-launch"})}function n(){__LOG__(2)`ws2:socket loop closed`,this.socketPreload&&this.socketPreload.deactivate(),this.clearState(),this.set({state:fe.UNLAUNCHED,mustExitLoop:!1,launched:!1,socketPreload:null})}this.mustExitLoop?n.call(this):(this.launched=!0,this.run(t,e).then((function(e){return[e,!1]})).catchType(ve,(()=>(this.mustExitLoop=!0,[!1,!1]))).catchType(Re,(function(){return[!1,!0]})).catch((e=>(__LOG__(3,!0)`ws2:run error unknown!\n${e.stack}`,P.upload({reason:"unknown-error-in-ws-loop"}),this.clearState(),[!0,!1]))).spread(((e,t)=>{if(this.mustExitLoop)n.call(this);else{var i=Date.now();this.launchGeneration++,this.backoffGeneration=e&&i<a+6e4?this.backoffGeneration+1:0;var s=i<a?Math.min(a-i,r):0;this.launched=!1,this.launch(t,s)}})))}poke(){this.pokeable?this.pokeable.poke():this.phoneWatchdog.forceTimeout()}takeover(){if(!this.conflictPromise)throw"Takeover called without conflict!";this.conflictPromise.cancel(new Re)}exitLoop(e){this.mustExitLoop=!0,this.runPromise&&this.runPromise.cancel(e||new ve)}clearCredentialsAndStoredData(){var e=this;return(0,n.default)((function*(){try{yield e.destroyStorage()}catch(e){__LOG__(4,void 0,new Error,!0)`destroyStorage: failed with error ${e}`,SEND_LOGS("Logout destroyStorage failed")}return F.default.supportsFeature(F.default.F.MD_BACKEND)&&(0,A.clearABPropConfigs)(),e.clearCredentials()}))()}destroyStorage(){return(0,n.default)((function*(){var e=[(0,K.destroy)()];F.default.supportsFeature(F.default.F.MD_BACKEND)&&(e.push((0,U.destroy)()),e.push((0,W.destroy)()),e.push(w.default.clearInitializationPromises())),yield Promise.all(e)}))()}logout(e){var t,a=this;(0,B.get)().setLogoutState(!0),F.default.supportsFeature(F.default.F.MD_BACKEND)?I.default.onStartingLogout():t=this.runPromise,__LOG__(2)`ws2:user logged out`;var i=Promise.resolve();if(F.default.supportsFeature(F.default.F.MD_BACKEND)){var s=Math.min(20,Math.max(0,ue.default.syncdSentinelTimeoutSeconds));i=(0,g.timeout)(r(84386).Z(),1e3*s).catch((()=>__LOG__(3)`ws2: multi-device logout did not manage to send sentinel patch`))}(0,g.timeout)(i.then((()=>{this.stream===_e.DISCONNECTED||e?this.sendCurrentLogout():this.sendCurrentLogout(this.socket)})).catch(function(){var e=(0,n.default)((function*(e){__LOG__(4,void 0,new Error)`ws2: [logout error] sendCurrentLogoutPromise errored with ${e}`,yield a.clearCredentialsAndStoredData(),I.default.logout()}));return function(){return e.apply(this,arguments)}}()),3e3,"network request took more than 3 seconds").then((0,n.default)((function*(){yield a.clearCredentialsAndStoredData(),t&&t.cancel(new Oe),a.state===fe.OPENING&&a.trigger("change:state"),I.default.logout()}))).catch(function(){var e=(0,n.default)((function*(e){__LOG__(4,void 0,new Error)`ws2: [logout error] sentinelPromise or sendCurrentLogoutPromise timed out with ${e}`,yield a.clearCredentialsAndStoredData(),I.default.logout()}));return function(){return e.apply(this,arguments)}}()).finally((()=>{(0,B.get)().setLogoutState(!1)}))}summary(){__LOG__(2)`ws:summary --------------------------------`,__LOG__(2)`ws state           ${this.state}`,__LOG__(2)`wd online:         ${String(navigator.onLine)}`,__LOG__(2)`ws socket id:      ${this.socket?this.socket.id:"n/a"}`,__LOG__(2)`ws queue:`,(0,f.default)(this.sendQueue)||S.default.print((0,h.default)(this.sendQueue,(function(e){var t=(0,p.default)(e,"tag","state","age","ephemeral","isToPhone");return e&&e.toString&&(t.debug=e.toString()),t}))).split(/\n/).forEach((function(e){__LOG__(2)`${e}`})),__LOG__(2)`ws hash:`,(0,f.default)(this.sendHash)||S.default.print((0,h.default)(this.sendHash,(function(e){var t=(0,p.default)(e,"tag","state","age","ephemeral","isToPhone");return e&&e.toString&&(t.debug=e.toString()),t}))).split(/\n/).forEach((function(e){__LOG__(2)`${e}`}))}registerHandler(e){F.default.supportsFeature(F.default.F.MD_BACKEND)||(this.handler&&(__LOG__(4,void 0,new Error,!0)`Assertion failed!`,SEND_LOGS("ws2: attempting to register handler multiple times")),this.handler=e)}onStateChange(){__LOG__(2)`ws2:state change: ${this.state}`}onStreamChange(){__LOG__(2)`ws2:stream change: ${this.stream}`,this.stream===_e.DISCONNECTED&&(F.default.supportsFeature(F.default.F.MD_BACKEND)?ee.default.clear():this.onRefCycle(),this.unset("resumePromise"))}onRefCycle(){__LOG__(2)`ws2:onRefCycle`,this.sendQueue.forEach((function(e){e.state=V.default.STATE.NEW,e.age=0})),this.clearSendHash()}onActivity(e){if(e){var t=e.data;if(Ge.UPGRADE_MD_FOR_INTERNAL_USER.test(e))__LOG__(2)`ws2: can upgrade to md! (flow for internal users)`,this.shouldUpgradeToMDIntern=!0,this.exitLoop();else if(Ge.UPGRADE_MD_FOR_PROD.test(e)){if(__LOG__(2)`ws2: upgrade to md! (flow for external users)`,t&&Array.isArray(t)&&2===t.length&&t[1]&&t[1].type&&t[1].version){var r="string"==typeof t[1].version&&t[1].version,a=r&&new ae.default(r),i=N.default.VERSION_STR.replace(/\.[di]$/,""),n=new ae.default(i);if(a&&n.lt(a))return(0,G.setMdOptedIn)(!0),Z.default.restart(!0),void this.exitLoop()}this.shouldUpgradeToMDPord=!0,this.exitLoop()}else if(Ge.HARD_REFRESH.test(e))__LOG__(2)`ws2:hard refresh!`,Z.default.restart(!0);else if(t){var s=Array.isArray(t)?` [${String(t[0])}, ...]`:"",o=(0,c.default)(t)&&"number"==typeof t.status?t.status:null;ee.default.logRecv(e.tag,e.binarySize,o);var l=null!=o?`,{status:${o}}`:"";__LOG__(2)`    recv: ${e.tag}${s}${l}`}else ee.default.logAck(e.tag),__LOG__(2)`     ack: ${e.tag}`}else M.default.setSkew(this.socket.timeSkew||0);this.sendRemainingLogouts()}onPhoneWatchdogActivated(){}onPhoneWatchdogFed(){this.state=fe.CONNECTED}onPhoneWatchdogDeactivated(){}flushQueue(){if(this.sendQueue.length){var e=this.sendQueue.filter((e=>e.state===V.default.STATE.NEW&&this.canRequestBeSent(e))),t=M.default.localUnixTime(),r=[],a=[];e.forEach((e=>{!function(e,t){return!(!e.resendGuard||e.resendGuard())||!(!e.binaryOpts||null==e.binaryOpts.expires||0===e.binaryOpts.expires)&&t-e.binaryOpts.expires>120}(e,t)?a.push(e):r.push(e)})),this.sendQueue=(0,u.default)(this.sendQueue,r),r.forEach((e=>{delete this.sendHash[e.tag],delete this.doubleAckHash[e.tag],ee.default.delete(e.tag),e.onSend({status:408})})),a.length&&a.forEach((e=>{this._send(e)}))}}phoneTimedOut(){var e=this.phoneWatchdog.failGeneration;if(1===e){__LOG__(3)`ws2:Phone timed out`;var t=(0,h.default)(this.sendHash,"tag");__LOG__(3)`ws2:Outstanding Reqs: ${t.join(",")}`}I.default.sentPing(e);var r=this.phoneWatchdog.waitAlgorithm(this.phoneWatchdog);return this.set({state:fe.TIMEOUT,retryTimestamp:Date.now()+r}),this._basicSend({tag:this.tag("ping"),data:["admin","test"]},"ping"),!0}clearSendHash(e){if(e)(0,d.default)(this.sendHash,(function(e){e.resendTimer&&clearTimeout(e.resendTimer),e.onDrop(new L.LogoutDrop(e.toString()))}));else{var t=(0,l.default)(this.sendHash,"ephemeral");__LOG__(3)`Ephemeral Drop: ${(0,h.default)(t,"tag").join(",")}`,t.forEach((function(e){e.resendTimer&&clearTimeout(e.resendTimer),e.onDrop(new L.EphemeralDrop(e.toString()))}))}this.sendHash={},this.doubleAckHash={},this.pendingPhoneReqs=0,this.phoneWatchdog&&this.phoneWatchdog.deactivate(),ee.default.clear()}_basicSend(e,t){__LOG__(2)`low-send: ${t} ${String(e.tag)}`,ee.default.logBasicSend(e.tag,e.data),this.socket.cast(`${String(e.tag)},${String(JSON.stringify(e.data))}`)}_send(e){e.tag=e.getTag()||this.shortTag(),e.onTag&&e.onTag(e.tag),this.sendHash[e.tag]=e,e.tagToCancel&&(this.cancelHash[e.tag]=e.tagToCancel),(e.isCallOffer||e.isWap4Bridge)&&(this.doubleAckHash[e.tag]=e),e.binaryOpts?e.binaryOpts.debugObj:e.data,ee.default.logSend(e),__LOG__(2)`    send: ${String(e.tag)}, ${e.toString()}`,this.socket.send(e.serialize()),e.isToPhone&&this.pendingPhoneReqs++,e.state=V.default.STATE.SENT}sendBasic(e){return this.socket?(e.tag=this.tag(),this._basicSend(e,"external"),this.socket.nextMessage(Ge.TAG(e.tag))):Promise.reject("socket not open")}sendEphemeral(e){e.ephemeral=!0;var t=new V.default(e);this.canRequestBeSent(t)?this._send(t):t.onDrop(new L.EphemeralDrop(t.toString()))}sendEphemeral2(e){return new Promise(((t,r)=>{var a=new V.default(e);a.ephemeral=!0,this.canRequestBeSent(a)?(a.onSend=t,a.onDrop=r,this._send(a)):r(new L.EphemeralDrop(a.toString()))}))}sendEphemeralIgnore(e){e.ephemeral=!0,e.ignore=!0,e.tag=this.tag();var t=new V.default(e);if(this.canRequestBeSent(t)){var r=t.serialize();this.socket.send(r),__LOG__(2)`sending: ${String(t.tag)}, ${t.toString()}`}else t.onDrop(new L.EphemeralDrop(t.toString()))}on5xx(e){__LOG__(3)`ws2:onMessage 5xx error ${String(e.tag)}`,e.on5xx&&e.on5xx(),e.resends>=5?(__LOG__(3)`ws2:onMessage dropping ${String(e.tag)}`,e.onDrop(new L.Server5xxDrop),delete this.sendHash[e.tag],ee.default.delete(e.tag),this.sendQueue=(0,o.default)(this.sendQueue,e)):this.maybeResendRequestEventually(e)}onMessage(e){var t=e.tag,a=e.data,i=e.binarySize;if(Ke(a)&&(this.lastPhoneMessage=(0,T.default)().unix()),Ge.PONG.test(e))if(a[1]){var n=0,s=!1;(0,d.default)(this.sendHash,(function(e){if(e.isToPhone){var t=++e.age;40===t?(s=!0,__LOG__(4,void 0,new Error)`${e.tag+" likely dead: "+e.toString()}`,I.default.cannotReachPhone("("+e.tag+") "+e.toString()),r(94407).default.cannotReachPhone()):t<40&&n++}})),this.pendingPhoneReqs=n,this.phoneWatchdog.feed(),0===n&&this.phoneWatchdog.deactivate(),s&&__LOG__(3)`ws2:error-cannot-reach-phone`}else this.state!==fe.TIMEOUT?__LOG__(3)`ws2:Pang while not timed-out`:this.runPromise.cancel(new Me);else{var l=this.sendHash[t];if(l)if(a){if(l.retryOn5xx&&Fe.test(a))this.on5xx(l,a);else{var u=!0;if(this.doubleAckHash[t]&&(delete this.doubleAckHash[t],!l.isCallOffer&&!l.isWap4Bridge||200!==a.status||a.payload||(u=!1)),u){var c;try{l.logOnSend&&l.logOnSend(e),c=l.onSend(a)}catch(e){if(e instanceof L.E401)return void this.logout();__LOG__(3)`ws2:onMessage error`,l.onDrop(e)}if(Fe.test(c)?this.on5xx(l,c):(delete this.sendHash[t],this.sendQueue=(0,o.default)(this.sendQueue,l)),xe.test(a)){var p=this.cancelHash[t];if(p){var h=this.sendHash[p];delete this.cancelHash[t],delete this.sendHash[p],this.sendQueue=(0,o.default)(this.sendQueue,h)}}}}l.isToPhone&&(l.age<40&&this.pendingPhoneReqs--,this.phoneWatchdog.feed(),0===this.pendingPhoneReqs&&this.phoneWatchdog.deactivate())}else l.state=V.default.STATE.WEBDACKED,l.isToPhone&&this.phoneWatchdog.activate();else if(a){if(Be.test(a))__LOG__(3)`ws2: unexpected response status`;else if(a instanceof ArrayBuffer)r(94407).default.handle(a,this,t,i).catchType(L.WebdDrop,(()=>{}));else try{this.handler?this.handler(a):__LOG__(3)`ws2: received message, but no handler is registered`}catch(e){if(e instanceof k.UpdateImmediately)this.exitLoop(e);else{if(!(e instanceof k.DeprecatedProtocolVersion))throw e;this.runPromise&&this.runPromise.cancel(e)}}Ke(a)&&this.phoneWatchdog.feed()}}}run(e,t){var r=this;return this.runPromise=Q.default.resolve(e).cancellable().then((e=>{if(this.state=fe.OPENING,I.default.incrementProgress(),e>0){__LOG__(2)`ws2:Run Backoff ${e}ms`;var t=(0,_.delayMs)(e).cancellable().catchType(ge,(()=>{}));return this.setPokeable(t,Date.now()+e),t}})).finally((()=>{this.unset("pokeable"),this.unset("retryTimestamp")})).then((()=>(I.default.incrementProgress(),__LOG__(2)`ws2:Running`,this.openSocket()))).then((e=>{if(I.default.incrementProgress(),e.onactivity=this.onActivity.bind(this),this.socket=e,this.socketWatcher=H.attachWatcher(this.runPromise,this.throwOnClose()),this.state=fe.PAIRING,void 0===this.isIncognito)return H.waitForBBEvent(this,"change:isIncognito")})).then((()=>{I.default.incrementProgress(),this.shortTagBase=((0,T.default)().unix()%1e3).toString();var e=this.initConn();if((0,G.knowsPhone)()){var r=this.requestSync(t),a=Promise.all([e,r]).finally((function(){e.cancel(),r.cancel()})),i=(0,Y.requireChatCollection)().then((e=>{this.hasSynced&&e.length<=me&&!F.default.supportsFeature(F.default.F.MD_BACKEND)&&(this.resumePromise=this.runResume(!0))}));return Promise.all([a,i])}return e.then((()=>{this.set({state:fe.UNPAIRED,refWatcher:H.attachWatcher(this.runPromise,this.manageRef())})}))})).then((()=>this.waitForSyncInfo())).finally((()=>{this.refWatcher&&(this.refWatcher.cancel(),this.unset("refWatcher"))})).then((e=>(I.default.incrementProgress(),__LOG__(2)`ws2:completed ${this.hasSynced?"re-auth":"auth"}`,this.state=fe.CONNECTED,R.default.blockStoreAdds=!1,R.default.platform=e.platform,H.waitForMain().then((()=>e))))).then((function(e){return __LOG__(2)`ws2:main loaded`,e.initial=!0,(0,D.default)([e])})).then((()=>(0,K.initialize)().catch((e=>{__LOG__(3)`Error initializing database during sync: ${e}`,__LOG__(4,void 0,new Error,!0)`Assertion failed!`,SEND_LOGS("Error initializing database during sync")})))).then((()=>{var e=this.openStream();return this.streamPromise=e,e})).then((function(){return new Q.default})).catchType(k.SocketClosed,(function(e){throw e.event instanceof Oe?e.event:e})).catch((e=>{__LOG__(3)`ws2:run loop interrupt: ${e}`,this.set({canSend:!1,stream:_e.DISCONNECTED,runPromise:null}),this.phoneWatchdog.deactivate(),this.streamPromise&&(this.streamPromise.cancel(),this.unset("streamPromise")),this.socketWatcher&&(this.socketWatcher.cancel(),this.unset("socketWatcher"));var t=this.socket;return t&&t.state!==re.STATE.CLOSED&&(t.detachCallbacks(),t.close(!0,e)),this.unset("socket"),this.shouldUpgradeToMDIntern?(I.default.upgradeToMDInternal(),!1):this.shouldUpgradeToMDPord?(I.default.upgradeToMDProd(),!1):Promise.reject(e)})).catchType(k.UpdateImmediately,(e=>{throw this.updateImmediately(e.message),new ve})).catchType(k.DeprecatedProtocolVersion,(()=>this.deprecatedVersion())).catchTypes(L.E401,Me,(function(){return!1})).catchType(Ce,(()=>(this.clearState(),!1))).catchTypes3(k.SocketClosed,k.SocketError,ke,(()=>!0)).catchType(be,(()=>(__LOG__(3)`ws2:sync rejected, logging out`,this.sendCurrentLogout().then((0,n.default)((function*(){return yield r.clearCredentialsAndStoredData(),I.default.logout(),!1})))))).catchTypes(Ee,Le,function(){var e=(0,n.default)((function*(e){return __LOG__(2)`ws2:phone disassociated via ${String(e)}`,yield r.clearCredentialsAndStoredData(),I.default.logout(),!1}));return function(){return e.apply(this,arguments)}}()).catchType(Ne,(0,n.default)((function*(){return __LOG__(3)`ws2:No secret bundle!`,yield r.clearCredentialsAndStoredData(),P.upload({reason:"no-secret-bundle"}),I.default.logout(),!1}))).catchType(Pe,(()=>(this.state=fe.UNPAIRED_IDLE,this.setPokeable(H.waitForOfflineNaive().throw(new we).catchType(ge,(()=>!1)))))).catchType(k.BlockedByProxy,(()=>(C.default.promptUnloadGuards++,this.state=fe.PROXYBLOCK,this.setPokeable((new Q.default).catchType(ge,(()=>!1)).finally((function(){C.default.promptUnloadGuards--})))))).catchType(Se,(e=>{__LOG__(2)`ws2:denied tos`;var t=this.setPokeable((new Q.default).cancellable().catchType(ge,(()=>!1))).cancellable(),r=e instanceof Te?fe.TOS_BLOCK:fe.SMB_TOS_BLOCK;return this.clearState(),this.set({state:r,runPromise:t}),t})).catchTypes(ye,De,(e=>{e instanceof ye?__LOG__(2)`ws2:phone denied (conflict)`:__LOG__(2)`ws2:phone replaced`;var t=(new Q.default).cancellable();return this.set({state:fe.CONFLICT,conflictPromise:t,runPromise:t}),this.clearState(),t})).finally((()=>{this.conflictPromise&&this.conflictPromise.cancel()})).catchTypes(Oe,we,(function(){return!1}))}openSocket(){var e=this.socketPreload;if(this.socketPreload=null,e&&e.socket&&e.socket.state===re.STATE.OPEN)return Promise.resolve(e.socket);var t=e&&e.active?e:new J.default,r=()=>{this.retryTimestamp=t.retryTimestamp};t.on("change:retryTimestamp",r),this.pokeable=t;var a=H.waitForBBEvent(t,"change:socket").cancellable().then((()=>t.socket)).finally((()=>{t.off("change:retryTimestamp",r),t.onerror=null,t.deactivate(),this.pokeable=null}));return t.onerror=e=>{a.cancel(e)},a}initConn(){return new Promise(((e,t)=>{var r=pe,a=this.tag("init"),i=C.default.info();return this._basicSend({tag:a,data:["admin","init",[r.p,r.s,r.t],[i.os||"Unknown",i.name||"Unknown",i.version||"Unknown"],C.default.id(),!this.isIncognito&&!!(0,G.getRememberMe)()]},"init"),this.socket.nextMessage(Ge.TAG(a)).get("data").catch(t).then(e)})).then((function(e){M.default.setSkew(Date.now()-e.time),(0,D.default)([{id:"1",ref:e.ref,refTTL:e.ttl}])}))}manageRef(){return(0,m.promiseLoop)(((e,t,r)=>{var a=R.default.refExpiry-Date.now()-500;return(0,_.delayMs)(Math.max(a,0)).cancellable().then((()=>{if(r>=5)throw new Pe;__LOG__(2)`ws2:Requesting Ref Update`;var e=this.tag("qr"+r);return this._basicSend({tag:e,data:["admin","Conn","reref"]},"reref"),this.socket.nextMessage(Ge.TAG(e))})).then((t=>{var r=t.data;switch(r.status){case 200:return __LOG__(2)`ws2:Updating Ref`,void(0,D.default)([{ref:r.ref,refTTL:r.ttl}]);case 304:return __LOG__(2)`ws2:Keeping Ref`,void e();case 429:throw __LOG__(2)`ws2:Server denied new ref`,new Pe;default:throw __LOG__(3)`ws2:Bad Ref Response!`,new Ie("unrecognized ref request status ("+r.status+")")}}))})).cancellable()}requestSync(e){if(this.syncTag=this.tag("sync"),!$.load())return Promise.reject(new Ne);var{client:t,server:r}=(0,G.getLoginTokens)(),a=["admin","login",t,r,C.default.id()];e?a.push("takeover"):this.hasSynced&&(a.push(this.shouldForceReconnect?"force_reconnect":"reconnect"),a.push((0,G.getMaybeMeUser)()));var i=()=>(this._basicSend({tag:this.syncTag,data:a},"sync"),!0),n=new te.default({waitAlgorithm:(0,te.fibonacci)(0,8500,6e4),onTimeout:i});n.on("change:ts",(()=>{this.retryTimestamp=n.ts})),this.pokeable=n,n.activate(),i();var s=this.socket.nextMessage(Ge.TAG(this.syncTag)),o=this.lookForAndHandleChallenge().catchType(Promise.CancellationError,(()=>{})).catch(s.cancel.bind(s));return s.then((e=>{__LOG__(2)`ws2:login`;var t=e.data;switch(t.status){case 200:return e;case 401:return Promise.reject(new Ee);case 403:var r;return r=t.tos>=2?new Te:t.smbTos?new Ae:new be,Promise.reject(r);case 405:return __LOG__(3)`ws2:Already authorized!`,P.upload({reason:"already-authorized"}),Promise.reject(new Ce);case 409:return Promise.reject(new ye);case 500:return Promise.reject(new ke);default:return __LOG__(3)`ws2:unknown error! status:${t.status}`,Promise.reject(new be)}})).finally((()=>{o.cancel(),n.deactivate(),this.unset("pokeable"),this.unset("retryTimestamp")}))}waitForSyncInfo(){return this.socket.nextMessage(Ge.SYNC_INFO).then((function(e){return e.data[1]}))}lookForAndHandleChallenge(){return this.socket.nextMessage(Ge.CHALLENGE).then((function(e){__LOG__(2)`ws2:challenged!`;var t=(0,y.decodeB64)(e.data[1].challenge);return $.getSecurityToken(t)})).then((e=>{var t=(0,G.getLoginTokens)(),r=t?t.server:void 0;if(!r)return __LOG__(3)`ws2:handleChallenge no server token!`,Promise.reject(new Error("Handle challenge no server token"));var a=this.tag("challenge");return this._basicSend({tag:a,data:["admin","challenge",e,r,C.default.id()]},"challenge"),this.socket.nextMessage(Ge.TAG(a))})).then((function(e){return e.data.status>=500?Promise.reject(new ke):e.data.status>=400?(__LOG__(3)`ws2:handleChallenge failed challenge!`,Promise.reject(new Ee)):void __LOG__(2)`ws2:handleChallenge passed challenge`}))}throwOnClose(){return this.socket.nextMessage(Ge.DISCONNECT).then((function(e){throw"replaced"===e.data[1].kind?new De:new Le}))}onCriticalSyncDone(){F.default.supportsFeature(F.default.F.MD_BACKEND)&&(__LOG__(2)`[ws2] moving to main screen from onCriticalSyncDone`,this.set({hasSynced:!0,stream:_e.CONNECTED}))}openStream(){if(F.default.supportsFeature(F.default.F.MD_BACKEND))return(0,Y.requireStatusV3Collection)().then((e=>{e.sync()})),(0,Y.requireContactCollection)().then((e=>{var t=(0,G.getMeUser)();t&&(R.default.blockStoreAdds=!1,R.default.id="1",R.default.trigger("me_ready")),e.gadd(t)}));var e;if(this.canSend=!0,this.hasSynced)this.resumePromise||(this.resumePromise=this.runResume(!1)),e=this.resumePromise.finally((()=>{this.unset("resumePromise")}));else{var t=(0,Y.requireContactCollection)().then((e=>e.sync()));if(e=(0,Y.requireChatCollection)().then((e=>e.sync())).cancellable().then((()=>(this.set({hasSynced:!0,stream:_e.CONNECTED}),(0,Y.requireStickerPackCollection)().then((e=>{e.preFetch()})).catch((e=>{__LOG__(3)`Error: prefetch StickerPacks\n${e.stack}`})),F.default.supportsFeature(F.default.F.USER_NOTICE)&&j.default.sync(),F.default.supportsFeature(F.default.F.SETTINGS_SYNC)&&q.default.sync(),t))).catch((e=>(this.set({hasSynced:!1,stream:_e.DISCONNECTED}),Promise.reject(e)))).catchType(Promise.CancellationError,(()=>{})),(0,Y.requireStatusV3Collection)().then((e=>{e.sync()})),R.default.isSMB){if(F.default.supportsFeature(F.default.F.QUICK_REPLIES_QUERY))r(84553).default.sync();(0,x.canDisplayLabel)()&&(0,Y.requireLabelCollection)().then((e=>{e.sync()}))}}return(0,Y.requireMsgCollection)().cancellable().then((e=>{e.markAllAsStale()})).then((()=>(this.stream=this.hasSynced?_e.RESUMING:_e.SYNCING,this.socket.onmessage=this.onMessage.bind(this),this.socket.releaseMessages(),e))).catchType(Promise.CancellationError,(function(){e.cancel()}))}queryReceivedActions(){var e=this,t=(0,l.default)(this.sendQueue,"clientCacheable"),a=(0,h.default)(t,"tag").filter((function(e){return e}));return __LOG__(2)`ws2:queryReceivedActions`,0===a.length?Promise.resolve():r(94407).default.queryReceivedActions(a).then((function(r){Array.isArray(r)?r.forEach((function(t){var r=function(e,t){for(var r=t;r<e.length;r++){var a=e[r];if(a.tag)return a}}(e.sendQueue,parseInt(t.id,10)||0);if(r)if(__LOG__(2)`ws2:queryReceivedActions found dup: ${t.id},${t.code}`,delete e.sendHash[t.id],ee.default.delete(t.id),e.sendQueue=(0,o.default)(e.sendQueue,r),r.onSend){var a=r.onSend({status:t.code,_duplicate:!0});Fe.test(a)&&r.onDrop(new L.Server5xxDrop)}else __LOG__(3)`ws2:queryReceivedActions onSendDup undefined; should be defined: ${t.id}`,r.onDrop(new L.ConventionViolationDrop);else __LOG__(3)`ws2:queryReceivedActions unknown tag in response: ${t.id}`})):"replaced"===r?(t.forEach((function(e){e.onDrop(new L.BrowserReplacedDrop)})),e.sendQueue=(0,u.default)(e.sendQueue,t)):__LOG__(3)`ws2:queryReceivedActions error`}))}runResume(e){return Promise.all([this.queryReceivedActions(),(0,Y.requireChatCollection)().then((e=>e.resyncMessages())),(0,Y.requireMsgCollection)().then((e=>e.resyncReceipts()))]).then((()=>{this.trigger("didResume"),this.flushQueue(),this.stream=_e.CONNECTED})).catchTypes(L.WebdDrop,Promise.CancellationError,(()=>{this.stream=_e.DISCONNECTED})).catch((t=>{if(!e)throw __LOG__(3,!0)`ws2:error during resume, resyncing: ${String(t)}\n${t.stack}`,P.upload({reason:"error-on-resume"}),this.stream=_e.DISCONNECTED,new Ce;if(this.canSend)return this.runResume(!1);this.unset("resumePromise")}))}setPokeable(e,t=this.retryTimestamp){return this.set({pokeable:{poke(){e.cancel(new ge)}},retryTimestamp:t}),e}clearCredentials(){var e=this;return(0,n.default)((function*(){try{yield e.clearState()}catch(e){}try{(0,G.setBrowserId)()}catch(e){}try{(0,G.setUnknownId)()}catch(e){}try{(0,G.setMe)()}catch(e){}if(F.default.supportsFeature(F.default.F.MD_BACKEND)){try{(0,ie.clearRegistrationInfo)()}catch(e){}try{yield(0,le.destroy)()}catch(e){}try{yield(0,ne.deleteEncKeysAndCache)(),(0,de.deleteSalt)()}catch(e){}}else{try{(0,G.clearTokens)()}catch(e){}try{$.clear()}catch(e){}}try{yield(0,G.clearAllLocalState)()}catch(e){}window.location.reload()}))()}clearState(){var e=this;return(0,n.default)((function*(){__LOG__(2)`ws2:clearState`,e.sendQueue=[],e.clearSendHash(!0),e.unset("hasSynced");try{(yield(0,Y.requireClearAppStates)())()}catch(e){e instanceof k.DbOnLogoutAbort?__LOG__(3)`ws2:clearState failed due to DB operations aborted: ${e.stack}`:(__LOG__(4,void 0,new Error,!0)`ws2:clearState error ${e.stack}`,SEND_LOGS("clear_session_app_state"))}try{yield(0,O.default)()}catch(e){e instanceof k.DbOnLogoutAbort?__LOG__(3)`ws2:clearState failed due to DB operations aborted: ${e.stack}`:(__LOG__(4,void 0,new Error,!0)`ws2:clearState error ${e.stack}`,SEND_LOGS("clear_persistent_app_state"))}}))()}maybeResendRequestEventually(e){var t=300*X.expBackoff(e.resends,100);__LOG__(2)`ws2:Resending ${e.toString()} in ${t}ms`,e.state=V.default.STATE.WILL_RETRY,e.resendTimer=setTimeout((()=>{e.resends++,e.resendTimer=void 0,this.sendHash[e.tag]===e&&(!e.resendGuard||e.resendGuard()?this._send(e):e.onSend({status:408}))}),t)}sendCurrentLogout(e){var t;F.default.supportsFeature(F.default.F.MD_BACKEND)?(t=(0,se.default)().then((e=>{200!==e.status&&__LOG__(3)`ws2:multi-device logout failed with error code ${e.status}`,(0,oe.stopComms)()})).catch((e=>{__LOG__(4,!0,new Error)`[CRITICAL] unpairDevice failed with error, preoceed with local logout \n${e.stack}`})))||(t=Promise.reject(new Error("sendCurrentLogout: should not reach"))):t=($.load()?r(94407).default.logoutToken().then((e=>{var t={t:(0,G.getLogoutToken)(),m:e},r=(0,G.getOldLogoutCreds)();return r.push(t),(0,G.setOldLogoutCreds)(r),t})):Promise.resolve({})).then((t=>{if(e&&e.state===re.STATE.OPEN){var r=this.logoutMutex;this.logoutMutex=r<=0?r=1:++r,__LOG__(2)`ws2:logout through socket`,e.partingSend(new Oe,'goodbye,,["admin","Conn","disconnect"]',(e=>0===e.indexOf("goodbye,"))).then((function(e){e?(__LOG__(2)`ws2:logout through socket success`,je(t)):__LOG__(3)`ws2:logout through socket failure, will POST`})).finally((()=>{this.logoutMutex===r&&(this.logoutMutex=0)}))}else this.logoutMutex<0&&(this.logoutMutex=0),this.sendRemainingLogouts()}));return t}sendRemainingLogouts(){var e=this.logoutMutex;if(0===e){var t=r(1876).default,a=(0,G.getOldLogoutCreds)();0!==a.length?(this.logoutMutex=e=1,Promise.all((0,h.default)(a,(function(e){return __LOG__(2)`ws2:POST logout`,t.post(he,e).then((function(){je(e)})).catch((function(){__LOG__(3)`ws2:POST logout failure`}))}))).finally((()=>{e===this.logoutMutex&&(this.logoutMutex=0)}))):this.logoutMutex=-1}}updateImmediately(e){P.upload({reason:e,immediate:!0}).finally((()=>{Z.default.restart(!0)}))}deprecatedVersion(){__LOG__(2)`ws2:deprecated version`,P.upload({reason:"ws2:deprecated version",immediate:!0});var e=this.setPokeable((new Q.default).cancellable().catchType(ge,(()=>!1))).cancellable();return this.clearState(),this.set({state:fe.DEPRECATED_VERSION,runPromise:e}),e}canRequestBeSent(e){return!!this.canSend||Boolean(this.socket)&&(0,G.knowsPhone)()&&e.serverCacheable}}function Ke(e){return e instanceof v.Binary}function je(e){var t=(0,G.getOldLogoutCreds)(),r=(0,s.default)(e);(0,G.setOldLogoutCreds)((0,l.default)(t,(e=>!r(e))))}var We=new((0,b.defineModel)(Ye));t.default=We},94784:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.initialize=function(){null==i&&((0,o.createStorage)(),(0,s.addTable)(),(0,l.addTable)(),i=(0,o.getStorage)().initialize().catch((e=>{throw __LOG__(4,!0,new Error,!0)`Assertion failed!`,SEND_LOGS("Failed to initialize fts storage"),e})));return i},t.destroy=function(){return(0,o.destroyStorage)().catch((()=>d.resolve(new n.default(o.DATABASE_NAME).delete()))).finally((()=>(i=null,d.resolve(new n.default("fts-storage-dogfooding").delete()))))},t.clearInitializePromise=function(){i=null},Object.defineProperty(t,"getManifestTable",{enumerable:!0,get:function(){return s.getTable}}),Object.defineProperty(t,"getIndexV1Table",{enumerable:!0,get:function(){return l.getTable}});var i,n=a(r(77715)),s=r(46822),o=r(12128),l=r(31126),d=r(97733).Z},46822:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.addTable=function(){(0,n.getStorage)().add(l).version((0,o.manifestCreateTable)(),[new s.default("key"),new i.default("tokenizerVersion"),new i.default("schemaVersion"),new i.default("isCurrent"),new i.default("lastMsgKeyViaFullIndexer"),new i.default("isFullIndexingComplete")]).view((e=>e||null))},t.getTable=function(){return(0,n.getStorage)().table(l)},t.ManifestKeys=t.TABLE_NAME=void 0;var i=a(r(49052)),n=r(12128),s=a(r(44221)),o=r(43019),l="manifest";t.TABLE_NAME=l;var d=Object.freeze({PREV_VERSION:"prev.version",CURR_VERSION:"curr.version",NEXT_VERSION:"next.version"});t.ManifestKeys=d},31126:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.addTable=function(){(0,o.getStorage)().add(u).version((0,d.ftsIndexCreateTable)(),[new l.default("blindIndex"),new s.default("messages"),new n.default("messages"),new s.default("blindIndices"),new n.default("blindIndices"),new s.default("msgKeys"),new n.default("msgKeys")]).view((e=>e?new c(e.blindIndices,e.messages):null))},t.getTable=function(){return(0,o.getStorage)().table(u)},t.FtsIndexEntry=t.TABLE_NAME=void 0;var i=a(r(84636)),n=a(r(54423)),s=a(r(49052)),o=r(12128),l=a(r(44221)),d=r(43019),u="fts-v1-index";t.TABLE_NAME=u;class c{constructor(e,t){if(this.messages=t||[],this.msgKeys=this.messages.map((([e])=>e)),!e||0===e.length)throw new Error("FtsIndexEntry: Expected non-empty blindIndices in constructor");this.blindIndices=e,this.blindIndex=e[e.length-1]}addMessageIds(e){null!=e&&(this.messages=(0,i.default)([...this.messages,...e],(([e])=>e)),this.msgKeys=this.messages.map((([e])=>e)))}}t.FtsIndexEntry=c},12128:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.createStorage=function(){var e=new s.default(d);(u=new o.default(e)).addErrorHandler(i.default.AbortError,(e=>{e.message.includes("QuotaExceededError")&&l.default.trigger("storage_not_enough_space")}))},t.getStorage=function(){return(0,n.default)(null!=u,"[fts-storage] Storage should be created first before being accessed"),u},t.destroyStorage=function(){if(null==u)return Promise.reject(new Error("[fts-storage] Storage should be created first before being destroyed"));return u.purge().then((()=>{u=null})).catch((e=>{throw u=null,e}))},t.DATABASE_NAME=void 0;var i=a(r(77715)),n=a(r(47677)),s=a(r(36479)),o=a(r(49195)),l=a(r(37018)),d="fts-storage";t.DATABASE_NAME=d;var u=null},43019:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ftsIndexCreateTable=function(){return(0,a.getStorage)().versions.version(0)},t.manifestCreateTable=function(){return(0,a.getStorage)().versions.version(1)};var a=r(12128)},97368:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.initialize=function(){null==i&&(i=n.default.initialize().catch((e=>{throw __LOG__(4,!0,new Error,!0)`Assertion failed!`,SEND_LOGS("Failed to initialize hsm storage"),e})));return i},Object.defineProperty(t,"HsmLanguagePackRequestInfo",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(t,"HsmTranslation",{enumerable:!0,get:function(){return o.default}});var i,n=a(r(19852)),s=a(r(28999)),o=a(r(14087))},28999:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(49052)),n=a(r(9818)),s=a(r(19852)),o=a(r(44221));s.default.add("hsm-language-pack-request-info").version(s.default.versions.version(0),[new o.default("id"),new i.default("namespace"),new i.default("phoneLg"),new i.default("phoneLc"),new i.default("lg"),new i.default("lc"),new i.default("resultLg"),new i.default("resultLc"),new i.default("hash"),new i.default("responseTime"),new n.default(["namespace","phoneLc","phoneLg"])]).view((e=>({id:e.id,namespace:e.namespace,phoneLg:e.phoneLg,phoneLc:e.phoneLc,lg:e.lg,lc:e.lc,resultLg:e.resultLg,resultLc:e.resultLc,hash:e.hash,responseTime:e.responseTime})));var l=s.default.table("hsm-language-pack-request-info");t.default=l},14087:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(49052)),n=a(r(81824)),s=a(r(19852)),o=a(r(44221));s.default.add("hsm-translation").version(s.default.versions.version(1),[new o.default("id"),new i.default("languagePackId"),new n.default("languagePackId"),new i.default("translation")]).view((e=>({id:e.id,languagePackId:e.languagePackId,translation:e.translation})));var l=s.default.table("hsm-translation");t.default=l},19852:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(77715)),n=a(r(36479)),s=a(r(49195)),o=a(r(37018)),l=new n.default("hsm-storage"),d=new s.default(l);d.addErrorHandler(i.default.AbortError,(e=>{e.message.includes("QuotaExceededError")&&o.default.trigger("storage_not_enough_space")}));var u=d;t.default=u},8286:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.initialize=function(){null==i&&((0,s.createStorage)(),(0,o.addTable)(),i=(0,s.getStorage)().initialize().catch((e=>{throw __LOG__(4,!0,new Error,!0)`Assertion failed!`,SEND_LOGS("Failed to initialize jobs storage"),e})));return i},t.destroy=function(){return(0,s.destroyStorage)().catch((()=>l.resolve(new n.default(s.DATABASE_NAME).delete()))).finally((()=>{i=null}))},Object.defineProperty(t,"getJobsTable",{enumerable:!0,get:function(){return o.getTable}});var i,n=a(r(77715)),s=r(13158),o=r(17755),l=r(97733).Z},17755:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.addTable=function(){(0,o.getStorage)().add("jobs-store").version((0,l.jobsCreateTable)(),[new s.default("jobId"),new i.default("type"),new i.default("uniqKey"),new n.default("uniqKey"),new i.default("original"),new i.default("current"),new i.default("step"),new i.default("startTime"),new i.default("endTime"),new i.default("stepHardStartCountAfterTimeout"),new i.default("stepFirstStartTime"),new i.default("waitUntil"),new i.default("backedOffCount"),new i.default("version")]).view((e=>({jobId:e.jobId,type:e.type,uniqKey:e.uniqKey,original:e.original,current:e.current,step:e.step,startTime:e.startTime,endTime:e.endTime,stepHardStartCountAfterTimeout:e.stepHardStartCountAfterTimeout,stepFirstStartTime:e.stepFirstStartTime,waitUntil:e.waitUntil,backedOffCount:e.backedOffCount,version:e.version})))},t.getTable=function(){return(0,o.getStorage)().table("jobs-store")};var i=a(r(49052)),n=a(r(81824)),s=a(r(23026)),o=r(13158),l=r(30868)},13158:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.createStorage=function(){var e=new s.default(d);(u=new o.default(e)).addErrorHandler(i.default.AbortError,(e=>{e.message.includes("QuotaExceededError")&&l.default.trigger("storage_not_enough_space")}))},t.getStorage=function(){return(0,n.default)(null!=u,"[jobs-storage] Storage should be created first before being accessed"),u},t.destroyStorage=function(){if(null==u)return Promise.reject(new Error("[jobs-storage] Storage should be created first before being destroyed"));return u.purge().then((()=>{u=null})).catch((e=>{throw u=null,e}))},t.DATABASE_NAME=void 0;var i=a(r(77715)),n=a(r(47677)),s=a(r(36479)),o=a(r(49195)),l=a(r(37018)),d="jobs-storage";t.DATABASE_NAME=d;var u=null},30868:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.jobsCreateTable=function(){return(0,a.getStorage)().versions.version(0)};var a=r(13158)},36479:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i,n=a(r(52954)),s=r(31449),o=a(r(77715)),l=a(r(47677)),d=r(97594),u=a(r(21830)),c=r(11273),p=null;p=r(49508).default,i=r(49508).DB_ENCRYPTION_CIPHER;var h=r(97733).Z;function f(){return(f=(0,n.default)((function*(e,t,r,a){if(!p)throw new Error("feature is not yet implemented");var n=a?p.dbMsgEncKeys[p.dbMsgEncKeys.length-1]:p.encKeys[p.encKeys.length-1],s=new Uint8Array(16);self.crypto.getRandomValues(s);var l=r===d.ENCRYPTED_VALUE_TYPE.STRING?(new TextEncoder).encode(e):e;try{var u=self.crypto.subtle.encrypt({iv:s,name:i},n.key,l),c=null==o.default.currentTransaction?u:o.default.waitFor(u);return{_data:yield h.resolve(c),iv:s,_keyId:n.id}}catch(r){throw T(r,"encryptDbMaterial",null,e,t),r}}))).apply(this,arguments)}function _(){return(_=(0,n.default)((function*(e,t,r,a){if(!p)throw new Error("feature is not yet implemented");var{_data:n,iv:s,_keyId:u}=e,c=a?p.dbMsgEncKeys.filter((e=>e.id===u))[0]:p.encKeys.filter((e=>e.id===u))[0];if((0,l.default)(null!=c,"Encryption key id not found"),null==n)return n;try{var f=self.crypto.subtle.decrypt({iv:s,name:i},c.key,n),_=null==o.default.currentTransaction?f:o.default.waitFor(f),m=yield h.resolve(_);return r===d.ENCRYPTED_VALUE_TYPE.STRING?new TextDecoder("utf-8").decode(m):m}catch(e){throw T(e,"encryptDbMaterial",null,t),e}}))).apply(this,arguments)}class m{constructor(e,t,r,a,i,n){this.table=e,this.view=r,this.db=t,this.propFilter=a,this.tableEncryptedColumns=new Map(Object.keys(i).map((e=>[e,i[e]]))),this.shouldUseDbMsgEncKeyForEncryptedCol=n}asyncView(e){var t=this;return(0,n.default)((function*(){if(!t._hasEncryptedColumn())return t.view(e);var r=yield t._decryptColumns(e);return t.view(r)}))()}_decryptColumns(e){var t=this;return(0,n.default)((function*(){(0,l.default)("object"==typeof e,"Called `_decryptColumns` with primitive value");var r=Array.from(t.tableEncryptedColumns.entries()).map((([r,a])=>{var i=e[r];return(null==i?void 0:i._data)&&(null==i?void 0:i.iv)?function(){return _.apply(this,arguments)}(i,r,a,t.shouldUseDbMsgEncKeyForEncryptedCol).then((t=>{e[r]=t})):i}));return yield Promise.all(r),e}))()}_encryptColumns(e){var t=Array.from(this.tableEncryptedColumns.entries()).map((([t,r])=>{var a=e[t];return null==a?a:function(){return f.apply(this,arguments)}(a,t,r,this.shouldUseDbMsgEncKeyForEncryptedCol).then((r=>{e[t]=r}))}));return Promise.all(t).then((()=>e))}_addAndEncrypt(e){var t=this;return(0,n.default)((function*(){if(!t._hasEncryptedColumn())return t.table.add(e);var r=yield t._encryptSingleUpdate(e);return t.table.add(r)}))()}_putAndEncrypt(e){var t=this;return(0,n.default)((function*(){if(!t._hasEncryptedColumn())return t.table.put(e);var r=yield t._encryptColumns(e);return t.table.put(r)}))()}_bulkAddAndEncrypt(e){return this._hasEncryptedColumn()?this._encryptBulkUpdates(e).then((e=>this.table.bulkAdd(e))):this.table.bulkAdd(e)}_bulkPutAndEncrypt(e){return this._hasEncryptedColumn()?o.default.waitFor(this._encryptBulkUpdates(e)).then((e=>this.table.bulkPut(e))):this.table.bulkPut(e)}_encryptBulkUpdates(e){if(!this._hasEncryptedColumn())return h.resolve(e);var t=[],r=e.map(((e,r)=>this._encryptColumns(e).then((e=>{t[r]=e}))));return Promise.all(r).then((()=>t))}_encryptSingleUpdate(e){var t=this;return(0,n.default)((function*(){return t._hasEncryptedColumn()?yield t._encryptColumns(e):e}))()}asyncViewMap(e,t=!0){if(!this._hasEncryptedColumn()||!t)return Promise.resolve(e.map((e=>e?this.view(e):null)));var r=e.map((e=>null!=e?this.asyncView(e):h.resolve(null)));return h.resolve(null==o.default.currentTransaction?Promise.all(r):o.default.waitFor(Promise.all(r)))}preflightEncryptSingleRecord(e){return this.tableEncryptedColumns,Object.keys(e).forEach((t=>{this.tableEncryptedColumns.has(t)||delete e[t]})),this._encryptColumns(e)}postflightDecryptSingleRecord(e){var t=this;return(0,n.default)((function*(){var r=yield t._decryptColumns(e);return t.view(r)}))()}bulkCreateWith_ALREADY_ENCRYPTED_RECORDS_ONLY(e){return A(e,this.tableEncryptedColumns),h.resolve(this.table.bulkAdd(e)).catch((t=>{throw T(t,"bulkCreateWith_ALREADY_ENCRYPTED_RECORDS_ONLY",this.table.name,e),t}))}bulkCreateOrReplace_ALREADY_ENCRYPTED_RECORDS_ONLY(e){return A(e,this.tableEncryptedColumns),h.resolve(this.table.bulkPut(e)).catch((t=>{throw T(t,"bulkCreateOrReplace",this.table.name,e),t}))}create(e){var t=this.propFilter(e);return h.resolve(this._addAndEncrypt(t)).catch((t=>{throw T(t,"create",this.table.name,e),t}))}createOrReplace(e){var t=this.propFilter(e);return h.resolve(this._putAndEncrypt(t)).catch((t=>{throw T(t,"createOrReplace",this.table.name,e),t}))}createOrMerge(e,t){var r=this;return(0,n.default)((function*(){var a=r.propFilter(t),i=yield r._encryptColumns(a);return h.resolve(r.db.transaction("rw",r.table,(()=>{r.table.where(":id").equals(e).modify((e=>{Object.assign(e,i)})).then((e=>{if(1!==e)return r.table.add(i)}))})).then((()=>{}))).catch((a=>{throw T(a,"createOrMerge",r.table.name,e,t),a}))}))()}get(e){return h.resolve(this.table.get(e)).then((e=>e?this.asyncView(e):null)).catch((t=>{throw T(t,"get",this.table.name,e),t}))}merge(e,t){var r=this;return(0,n.default)((function*(){var a=r.propFilter(t),i=yield r._encryptSingleUpdate(a);return h.resolve(r.table.update(e,i)).catch((a=>{throw T(a,"merge",r.table.name,e,t),a}))}))()}remove(e){return h.resolve(this.table.delete(e)).catch((t=>{throw T(t,"remove",this.table.name,e),t}))}bulkCreate(e){var t=e.map((e=>this.propFilter(e)));return h.resolve(this.db.transaction("rw",this.table,(()=>this._bulkAddAndEncrypt(t)))).catch((t=>{throw T(t,"bulkCreate",this.table.name,e),t}))}bulkCreateOrReplace(e){var t=e.map((e=>this.propFilter(e)));return h.resolve(this.db.transaction("rw",this.table,(()=>this._bulkPutAndEncrypt(t)))).catch((t=>{throw T(t,"bulkCreateOrReplace",this.table.name,e),t}))}bulkCreateOrMerge(e){var t=this;return(0,n.default)((function*(){var r=new Map,a=t._primaryKey();function i(){return(i=(0,n.default)((function*(e){var r=t.table.where(":id").anyOf(Array.from(e.keys()));return yield r.modify((t=>{Object.assign(t,e.get(t[a])),e.delete(t[a])})),Array.from(e.values())}))).apply(this,arguments)}return(yield t._encryptBulkUpdates(e)).forEach((e=>{var i=t.propFilter(e);(0,l.default)(a in i,"Called `bulkCreateOrMerge` with item(s) not including the primary key"),r.set(i[a],i)})),h.resolve(t.db.transaction("rw",t.table,(()=>function(){return i.apply(this,arguments)}(r).then((e=>0===e.length?h.resolve():t.table.bulkPut(e)))))).catch((r=>{throw T(r,"bulkCreateOrMerge",t.table.name,e),r}))}))()}bulkGet(e,t=!0){return h.resolve(this.db.transaction("r",this.table,(()=>{var t=e.map((e=>this.table.get(e)));return o.default.Promise.all(t)}))).then((e=>this.asyncViewMap(e,t))).catch((t=>{throw T(t,"bulkGet",this.table.name,e),t}))}bulkRemove(e){return h.resolve(this.db.transaction("rw",this.table,(()=>this.table.bulkDelete(e)))).catch((t=>{throw T(t,"bulkRemove",this.table.name,e),t}))}all(e,t){var r=y(this.table.orderBy(e&&e.index?E(e.index):":id"),e);t&&(r=r.until(t));var a=null;switch(null==e?void 0:e.returnKeyType){case"keys":a=h.resolve(r.keys());break;case"primary_key":a=h.resolve(r.primaryKeys());break;default:a=h.resolve(r.toArray()).then((t=>this.asyncViewMap(t,null==e?void 0:e.shouldDecrypt)))}return a.catch((t=>{throw T(t,"all",this.table.name,e),t}))}count(){return h.resolve(this.table.count()).catch((e=>{throw T(e,"count",this.table.name),e}))}equals(e,t,r){return h.resolve(y(this.table.where(E(e)).equals(t),r).toArray()).then((e=>this.asyncViewMap(e,null==r?void 0:r.shouldDecrypt))).catch((a=>{throw T(a,"equals",this.table.name,e,t,r),a}))}anyOf(e,t,r){return h.resolve(y(this.table.where(E(e)).anyOf(t),r).toArray()).then((e=>this.asyncViewMap(e,null==r?void 0:r.shouldDecrypt))).catch((a=>{throw T(a,"anyOf",this.table.name,e,t,r),a}))}greaterThan(e,t,r){var a=r&&r.inclusive?this.table.where(E(e)).aboveOrEqual(t):this.table.where(E(e)).above(t);return h.resolve(y(a,r).toArray()).then((e=>this.asyncViewMap(e,null==r?void 0:r.shouldDecrypt))).catch((a=>{throw T(a,"greaterThan",this.table.name,e,t,r),a}))}lessThan(e,t,r){var a=r&&r.inclusive?this.table.where(E(e)).belowOrEqual(t):this.table.where(E(e)).below(t);return h.resolve(y(a,r).toArray()).then((e=>this.asyncViewMap(e))).catch((a=>{throw T(a,"lessThan",this.table.name,e,t,r),a}))}between(e,t,r,a,i){var n=y(this.table.where(E(e)).between(t,r,!(!a||!a.lowerInclusive),!(!a||!a.upperInclusive)),a),s=null;switch(null==a?void 0:a.returnKeyType){case"keys":s=h.resolve(n.keys());break;case"primary_key":s=h.resolve(n.primaryKeys());break;default:s=i?h.resolve(n.until(i).toArray()).then((()=>[])):h.resolve(n.toArray()).then((e=>this.asyncViewMap(e,null==a?void 0:a.shouldDecrypt)))}return s.catch((i=>{throw T(i,"between",this.table.name,e,t,r,a),i}))}forEachSortedBy(e,t){var r=this;return this.table.orderBy(e).each(function(){var e=(0,n.default)((function*(e){var a=yield r._decryptColumns(e);return t(a)}));return function(){return e.apply(this,arguments)}}()).catch((r=>{throw T(r,"forEachSortedBy",this.table.name,e,t),r}))}forEach(e){var t=this;return this.table.each(function(){var r=(0,n.default)((function*(r){var a=yield t._decryptColumns(r);return e(a)}));return function(){return r.apply(this,arguments)}}()).catch((t=>{throw T(t,"forEach",this.table.name,e),t}))}clear(){return h.resolve(this.table.clear()).catch((e=>{throw T(e,"clear",this.table.name),e}))}_primaryKey(){return this.table.schema.primKey.name}_hasEncryptedColumn(){return this.tableEncryptedColumns.size>0}}function g(e){if(e.length>1)return e.forEach((e=>{(0,l.default)(e.primaryKey&&e.primaryKey===c.PRIMARY_KEY_TYPE.COMPOSITE,"Invalid column passed to `formatPrimaryKey`")})),`[${e.map((e=>e.name)).join("+")}]`;var t=e[0];return(0,l.default)(t.primaryKey&&t.primaryKey!==c.PRIMARY_KEY_TYPE.COMPOSITE,"Invalid column passed to `formatPrimaryKey`"),t.primaryKey===c.PRIMARY_KEY_TYPE.AUTO_INCREMENT?`${t.name}++`:t.name}function v(e){switch(e.type){case c.INDEX_TYPE.SIMPLE:return e.column;case c.INDEX_TYPE.COMPOSITE:return`[${e.columns.join("+")}]`;case c.INDEX_TYPE.ARRAY:return`*${e.column}`;case c.INDEX_TYPE.UNIQUE:return`&${e.column}`}throw new Error(`Cannot format index of type "${e.type}"`)}function E(e){return 1===e.length?e[0]:`[${e.join("+")}]`}function y(e,t){var r=e;return t&&t.reverse&&(r=r.reverse()),t&&null!=t.offset&&(r=r.offset(t.offset)),t&&null!=t.limit&&0!==t.limit&&(r=r.limit(t.limit)),r}function S(e){return h.resolve(e)}function T(e,t,r,...a){__LOG__(3,!0)`idb faild to do Operation: ${t} on Table: ${r}. Failed with error ${e}`}function A(e,t){var r=Array.from(t.entries());e.forEach((()=>{r.forEach((([t,r])=>{if(e[t]&&!(e[t]._keyId&&e[t]._data&&e[t].iv))throw new Error("[CRITICAL] Records contain unencrypted field")}))}))}t.default=class{constructor(e,t=S){this.tableNames=new Map,this.tableColumns=new Map,this.tableEncryptedColumns=new Map,this.errorHandlers=new Map,this.name=e,this.db=new o.default(this.name),this.transformSchema=t}initialize(e,t,r,a){return a&&(this.errorHandlers=a),function(e,t,r,a,i){return(0,s.promiseReduce)(e,((e,n)=>i((0,c.cloneSchema)(n)).then((i=>{if((0,l.default)(!(i.name in e),"Multiple tables resulted in the same transformed name"),i.deleted)return e[i.name]=null,e;t.set(n.name,i.name),r.set(n.name,i.columns.map((e=>e.name))),a.set(n.name,i.encryptedColumns||{});var s=i.columns.filter((e=>e.primaryKey));(0,l.default)(s.length>=1,`No primary key was defined for "${n.name}"`);var o=[g(s)].concat(i.indexes.map(v)).join(", ");return e[i.name]=o,e}))),{})}(t,this.tableNames,this.tableColumns,this.tableEncryptedColumns,this.transformSchema).then((t=>{this.db.version(e+1).stores(t).upgrade((e=>{var t;if(r)return null===(t=e[r.name])||void 0===t?void 0:t.toCollection().modify(r.callback)}))}))}open(){return h.resolve(this.db.open())}transact(e,t,r="rw"){return h.resolve(this.db.transaction(r,e,(()=>t()))).catch((e=>{var t=this.errorHandlers.get(e.name);if(!t)throw e;t(e)}))}close(){return this.db.close(),h.resolve()}view(e,t,r,a){(0,l.default)(this.tableNames.has(e),`Attemped to get view for uninitialized table "${e}"`),(0,l.default)(this.tableColumns.has(e),`Attemped to get columns for uninitialized table "${e}"`);var i=r?function(e){if(!e)return e=>e;return t=>{var r={};return e.forEach((e=>{t.hasOwnProperty(e)&&(r[e]=t[e])})),r}}(this.tableColumns.get(e)):e=>e;return new m(this.db.table(this.tableNames.get(e)),this.db,t,i,(0,u.default)(this.tableEncryptedColumns.get(e),"this.tableEncryptedColumns.get(table)"),a)}available(){return h.resolve(!0)}reset(){return this.tableNames=new Map,h.resolve(this.db.delete())}}},57002:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(24461),n=a(r(77613));t.default=class{constructor(e,t){this.errorHandlers=new Map,this._view=e,t&&(this.errorHandlers=t)}_maybeHandleError(e){var t=this.errorHandlers.get(e.name);t&&t(e)}_read(e){return n.default.isLogoutInProgress?Promise.reject(new i.DbOnLogoutAbort("dropping db read operation due to logout")):e(this._view()).catch((e=>{throw this._maybeHandleError(e),e}))}_write(e){return n.default.isLogoutInProgress?Promise.reject(new i.DbOnLogoutAbort("dropping db write operation due to logout")):e(this._view()).catch((e=>{throw this._maybeHandleError(e),e}))}create(e){return this._write((t=>t.create(e)))}preflightEncryptSingleRecord(e){return this._write((t=>t.preflightEncryptSingleRecord(e)))}postflightDecryptSingleRecord(e){return this._write((t=>t.postflightDecryptSingleRecord(e)))}bulkCreateWith_ALREADY_ENCRYPTED_RECORDS_ONLY(e){return this._write((t=>t.bulkCreateWith_ALREADY_ENCRYPTED_RECORDS_ONLY(e)))}bulkCreateOrReplace_ALREADY_ENCRYPTED_RECORDS_ONLY(e){return this._write((t=>t.bulkCreateOrReplace_ALREADY_ENCRYPTED_RECORDS_ONLY(e)))}createOrReplace(e){return this._write((t=>t.createOrReplace(e)))}createOrMerge(e,t){return this._write((r=>r.createOrMerge(e,t)))}get(e){return this._read((t=>t.get(e)))}merge(e,t){return this._write((r=>r.merge(e,t)))}remove(e){return this._write((t=>t.remove(e)))}bulkCreate(e){return this._write((t=>t.bulkCreate(e)))}bulkCreateOrReplace(e){return this._write((t=>t.bulkCreateOrReplace(e)))}bulkCreateOrMerge(e){return this._write((t=>t.bulkCreateOrMerge(e)))}bulkGet(e,t){return this._read((r=>r.bulkGet(e,t)))}bulkRemove(e){return this._write((t=>t.bulkRemove(e)))}all(e,t){return this._read((r=>r.all(e,t)))}count(){return this._read((e=>e.count()))}equals(e,t,r){return this._read((a=>a.equals(e,t,r)))}anyOf(e,t,r){return this._read((a=>a.anyOf(e,t,r)))}greaterThan(e,t,r){return this._read((a=>a.greaterThan(e,t,r)))}lessThan(e,t,r){return this._read((a=>a.lessThan(e,t,r)))}between(e,t,r,a,i){return this._read((n=>n.between(e,t,r,a,i)))}forEachSortedBy(e,t){return this._read((r=>r.forEachSortedBy(e,t)))}forEach(e){return this._read((t=>t.forEach(e)))}clear(){return this._write((e=>e.clear()))}}},89740:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(47677)),n=a(r(61457));class s extends n.default{constructor(e){super(),(0,i.default)("AbstractPrimaryKey"!==this.constructor.name,"Cannot instantiate abstract class AbstractPrimaryKey"),Array.isArray(e)?this.columns=[...e]:this.columns=[e]}validate(e){(0,i.default)(0===e.columns.length,"Attempted to add primary key after other columns")}apply(){throw new Error("Subclass of `AbstractPrimaryKey` must implement `apply` method")}}t.default=s},54423:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(47677)),n=a(r(61457)),s=r(11273);class o extends n.default{constructor(e){super(),this.column=e}validate(e){var t=e.columns.find((e=>e.name===this.column));(0,i.default)(t,`Attempted to add index on non-existent column "${this.column}" in "${e.name}"`),(0,i.default)(t&&(!t.primaryKey||t.primaryKey===s.PRIMARY_KEY_TYPE.COMPOSITE),`Cannot add index on primary key on table "${e.name}"`),(0,i.default)(!e.indexes.some((e=>(e.type===s.INDEX_TYPE.ARRAY||e.type===s.INDEX_TYPE.SIMPLE||e.type===s.INDEX_TYPE.UNIQUE)&&(0,s.indexContainsColumn)(e,this.column))),`Attempted to add index "${this.column}" which already exists in "${e.name}"`)}apply(e){var t=(0,s.cloneSchema)(e);return t.indexes.push(this._getIndex()),t}_getIndex(){return{type:s.INDEX_TYPE.ARRAY,column:this.column}}}t.default=o},49052:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(47677)),n=a(r(61457)),s=r(11273);class o extends n.default{constructor(e){super(),this.name=e}validate(e){(0,i.default)(!e.columns.find((e=>e.name===this.name)),`Attempted to add column "${this.name}" to "${e.name}" but it already exists`)}apply(e){var t=(0,s.cloneSchema)(e);return t.columns.push({name:this.name}),t}}t.default=o},9818:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(47677)),n=a(r(61457)),s=r(11273);class o extends n.default{constructor(e){super(),this.columns=[...e]}validate(e){this.columns.forEach((t=>{(0,i.default)(e.columns.find((e=>e.name===t)),`Attempted to add index on non-existent column "${t}" in "${e.name}"`)})),(0,i.default)(this.columns.length>1,"Attempted to add composite index for only 1 column"),(0,i.default)(-1===(0,s.findIndex)(e,this._getIndex()),`Attempted to add index [${String(this.columns)}], which already exists in "${e.name}"`);var t=e.columns.filter((e=>e.primaryKey&&e.primaryKey===s.PRIMARY_KEY_TYPE.COMPOSITE)).map((e=>e.name));(0,i.default)(t.length!==this.columns.length||t.some((e=>!this.columns.includes(e))),`Attempted to add index [${String(this.columns)}], which already is the primary key in "${e.name}"`)}apply(e){var t=(0,s.cloneSchema)(e);return t.indexes.push(this._getIndex()),t}_getIndex(){return{type:s.INDEX_TYPE.COMPOSITE,columns:this.columns}}}t.default=o},97594:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.ENCRYPTED_VALUE_TYPE=void 0;var i=a(r(47677)),n=a(r(61457)),s=r(11273),o=Object.freeze({STRING:"String",ARRAY_BUFFER:"ArrayBuffer"});t.ENCRYPTED_VALUE_TYPE=o;class l extends n.default{constructor(e,t){super(),this.name=e,this.dataType=t}validate(e){(0,i.default)(!e.columns.find((e=>e.name===this.name)),`Attempted to add encrypted column "${this.name}" to "${e.name}" but it already exists`)}apply(e){var t=(0,s.cloneSchema)(e);return t.columns.push({name:this.name}),t.encryptedColumns[this.name]=this.dataType,t}}t.default=l},81824:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(47677)),n=a(r(61457)),s=r(11273);class o extends n.default{constructor(e){super(),this.keyPath=e,this.column=e.split(".")[0]}validate(e){var t=e.columns.find((e=>e.name===this.column));(0,i.default)(t,`Attempted to add index on non-existent column "${this.column}" in "${e.name}"`),(0,i.default)(t&&(!t.primaryKey||t.primaryKey===s.PRIMARY_KEY_TYPE.COMPOSITE),`Cannot add index on primary key on table "${e.name}"`),(0,i.default)(!e.indexes.some((e=>(e.type===s.INDEX_TYPE.ARRAY||e.type===s.INDEX_TYPE.SIMPLE||e.type===s.INDEX_TYPE.UNIQUE)&&(0,s.indexContainsColumn)(e,this.column))),`Attempted to add index "${this.column}" which already exists in "${e.name}"`)}apply(e){var t=(0,s.cloneSchema)(e);return t.indexes.push(this._getIndex()),t}_getIndex(){return{type:s.INDEX_TYPE.SIMPLE,column:this.keyPath}}}t.default=o},34450:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(47677)),n=a(r(61457)),s=r(11273);class o extends n.default{constructor(e){super(),this.column=e}validate(e){var t=e.columns.find((e=>e.name===this.column));(0,i.default)(t,`Attempted to add index on non-existent column "${this.column}" in "${e.name}"`),(0,i.default)(t&&(!t.primaryKey||t.primaryKey===s.PRIMARY_KEY_TYPE.COMPOSITE),`Cannot add index on primary key on table "${e.name}"`),(0,i.default)(!e.indexes.some((e=>(e.type===s.INDEX_TYPE.ARRAY||e.type===s.INDEX_TYPE.SIMPLE||e.type===s.INDEX_TYPE.UNIQUE)&&(0,s.indexContainsColumn)(e,this.column))),`Attempted to add index "${this.column}" which already exists in "${e.name}"`)}apply(e){var t=(0,s.cloneSchema)(e);return t.indexes.push(this._getIndex()),t}_getIndex(){return{type:s.INDEX_TYPE.UNIQUE,column:this.column}}}t.default=o},23026:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(47677)),n=a(r(89740)),s=r(11273);class o extends n.default{validate(e){super.validate(e),(0,i.default)(this.columns&&1===this.columns.length,"Attempted to add UserDefinedPrimaryKey over wrong number of columns")}apply(e){var t=(0,s.cloneSchema)(e);return t.columns.unshift({name:this.columns[0],primaryKey:s.PRIMARY_KEY_TYPE.AUTO_INCREMENT}),t}}t.default=o},92554:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(47677)),n=a(r(89740)),s=r(11273);class o extends n.default{validate(e){super.validate(e),(0,i.default)(this.columns&&this.columns.length>1,"Attempted to add composite primary key for only 1 column")}apply(e){var t=(0,s.cloneSchema)(e);return this.columns.forEach((e=>{t.columns.push({name:e,primaryKey:s.PRIMARY_KEY_TYPE.COMPOSITE})})),t}}t.default=o},61457:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(47677));t.default=class{constructor(){(0,i.default)("Mutation"!==this.constructor.name,"Cannot instantiate abstract class Mutation")}validate(){throw new Error("Subclasses of Mutaton must implement `validate`")}apply(){throw new Error("Subclasses of Mutaton must implement `apply`")}}},10719:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(47677)),n=a(r(61457)),s=r(11273);class o extends n.default{constructor(e){super(),this.column=e}validate(e){(0,i.default)(-1!==(0,s.findIndex)(e,this._getIndex()),`Attempted to remove non-existent index "${this.column}" on "${e.name}"`)}apply(e){var t=(0,s.cloneSchema)(e),r=(0,s.findIndex)(e,this._getIndex());return t.indexes.splice(r,1),t}_getIndex(){return{type:s.INDEX_TYPE.ARRAY,column:this.column}}}t.default=o},91757:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(47677)),n=a(r(61457)),s=r(11273);class o extends n.default{constructor(e){super(),this.name=e}validate(e){var t=e.columns.find((e=>e.name===this.name));(0,i.default)(t,`Attempted to remove column "${this.name}" from "${e.name}" but it doesn't exist`),(0,i.default)(!t.primaryKey,`Attempted to remove primary key column "${this.name}". Removing primary keys is not supported.`),(0,i.default)(!e.indexes.some((e=>(0,s.indexContainsColumn)(e,this.name))),`Attempted to remove column "${this.name}" from "${e.name}" but an index exists with the column`)}apply(e){var t=(0,s.cloneSchema)(e);return t.columns.splice(t.columns.findIndex((e=>e.name===this.name)),1),t}}t.default=o},99194:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(47677)),n=a(r(61457)),s=r(11273);class o extends n.default{constructor(e){super(),this.columns=[...e].sort()}validate(e){(0,i.default)(-1!==(0,s.findIndex)(e,this._getIndex()),`Attempted to remove non-existent index [${String(this.columns)}] on "${e.name}"`)}apply(e){var t=(0,s.cloneSchema)(e),r=(0,s.findIndex)(e,this._getIndex());return t.indexes.splice(r,1),t}_getIndex(){return{type:s.INDEX_TYPE.COMPOSITE,columns:this.columns}}}t.default=o},99297:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(47677)),n=a(r(61457)),s=r(11273);class o extends n.default{constructor(e){super(),this.column=e}validate(e){(0,i.default)(-1!==(0,s.findIndex)(e,this._getIndex()),`Attempted to remove non-existent index "${this.column}" on "${e.name}"`)}apply(e){var t=(0,s.cloneSchema)(e),r=(0,s.findIndex)(e,this._getIndex());return t.indexes.splice(r,1),t}_getIndex(){return{type:s.INDEX_TYPE.SIMPLE,column:this.column}}}t.default=o},44221:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(47677)),n=a(r(89740)),s=r(11273);class o extends n.default{validate(e){super.validate(e),(0,i.default)(this.columns&&1===this.columns.length,"Attempted to add UserDefinedPrimaryKey over wrong number of columns")}apply(e){var t=(0,s.cloneSchema)(e);return t.columns.unshift({name:this.columns[0],primaryKey:s.PRIMARY_KEY_TYPE.USER_DEFINED}),t}}t.default=o},81962:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.sortMutations=function(e){return[...e].sort(E)};var i=a(r(47677)),n=a(r(54423)),s=a(r(49052)),o=a(r(9818)),l=a(r(97594)),d=a(r(81824)),u=a(r(34450)),c=a(r(23026)),p=a(r(92554)),h=a(r(10719)),f=a(r(91757)),_=a(r(99194)),m=a(r(99297)),g=a(r(44221)),v=[_.default,h.default,m.default,f.default,c.default,g.default,p.default,s.default,d.default,n.default,o.default,u.default,l.default];function E(e,t){var r=v.indexOf(e.constructor),a=v.indexOf(t.constructor);return(0,i.default)(-1!==r,`Mutation ${e.constructor.name} is not a known mutation type`),(0,i.default)(-1!==a,`Mutation ${e.constructor.name} is not a known mutation type`),r-a}},11273:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.emptySchema=function(e){return{name:e,columns:[],indexes:[],encryptedColumns:{}}},t.cloneSchema=function(e){return{name:e.name,columns:e.columns.map((e=>(0,i.default)({},e))),indexes:e.indexes.map(d),encryptedColumns:(0,i.default)({},e.encryptedColumns||{}),deleted:e.deleted}},t.freezeSchema=function(e){return Object.freeze({name:e.name,columns:Object.freeze(e.columns.map(Object.freeze)),indexes:Object.freeze(e.indexes.map(l)),encryptedColumns:Object.freeze((0,i.default)({},e.encryptedColumns||{})),deleted:e.deleted})},t.findIndex=function(e,t){return e.indexes.findIndex((e=>function(e,t){if(e.type!==t.type)return!1;switch(e.type){case o.SIMPLE:case o.ARRAY:case o.UNIQUE:return(0,n.default)(t.type===e.type,"Index types are not equal"),e.column===t.column;case o.COMPOSITE:return(0,n.default)(t.type===e.type,"Index types are not equal"),e.columns.length===t.columns.length&&!e.columns.some((e=>!t.columns.includes(e)))}throw new Error(`cannot compare unknown indexes of types: ${e.type}, ${t.type}`)}(t,e)))},t.indexContainsColumn=function(e,t){switch(e.type){case o.SIMPLE:case o.ARRAY:case o.UNIQUE:return e.column===t;case o.COMPOSITE:return!!e.columns.find((e=>e===t))}throw new Error(`cannot check indexes of unknown index type: ${e.type}`)},t.INDEX_TYPE=t.PRIMARY_KEY_TYPE=void 0;var i=a(r(70417)),n=a(r(47677)),s=Object.freeze({AUTO_INCREMENT:"auto-increment",USER_DEFINED:"user-defined",COMPOSITE:"composite"});t.PRIMARY_KEY_TYPE=s;var o=Object.freeze({SIMPLE:"simple",COMPOSITE:"composite",ARRAY:"array",UNIQUE:"unique"});function l(e){switch(e.type){case o.SIMPLE:return Object.freeze({type:o.SIMPLE,column:e.column});case o.ARRAY:return Object.freeze({type:o.ARRAY,column:e.column});case o.COMPOSITE:return Object.freeze({type:o.COMPOSITE,columns:Object.freeze(e.columns.map(Object.freeze))});case o.UNIQUE:return Object.freeze({type:o.UNIQUE,column:e.column})}throw new Error(`cannot freeze index of unknown type: ${e.type}`)}function d(e){switch(e.type){case o.SIMPLE:return{type:o.SIMPLE,column:e.column};case o.UNIQUE:return{type:o.UNIQUE,column:e.column};case o.COMPOSITE:return{type:o.COMPOSITE,columns:e.columns.map((e=>e))};case o.ARRAY:return{type:o.ARRAY,column:e.column}}throw new Error(`cannot clone unknown index type: ${e.type}`)}t.INDEX_TYPE=o},3020:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.MissingVersionError=t.InvalidVersionError=t.DuplicateVersionError=void 0;class r extends Error{constructor(...e){super(...e),this.name="DuplicateVersionError"}}t.DuplicateVersionError=r;class a extends Error{constructor(...e){super(...e),this.name="InvalidVersionError"}}t.InvalidVersionError=a;class i extends Error{constructor(...e){super(...e),this.name="MissingVersionError"}}t.MissingVersionError=i;t.default=class{constructor(){this.versions=new Set,this._max=-1}claim(e){if(e<0)throw new a("Versions must by greater than or equal to zero!");if(this.versions.has(e))throw new r(`Version #${e} has already been claimed!`);this.versions.add(e),this._max=Math.max(this.max,e)}version(e){if(e<0)throw new a("Versions must by greater than or equal to zero!");return e}validate(){for(var e=0;e<=this.max;++e)if(!this.versions.has(e))throw new i(`Schema version #${e} is missing!`)}get max(){return this._max}}},49195:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.NotInitializedError=t.NoSuchTableError=t.NoSuchDatabaseError=t.NoFallbackError=t.DuplicateTableError=t.DuplicateDatabaseError=t.AlreadyInitializedError=void 0;var i=a(r(52954)),n=a(r(57002)),s=a(r(3020)),o=a(r(48281));class l extends Error{constructor(...e){super(...e),this.name="AlreadyInitializedError"}}t.AlreadyInitializedError=l;class d extends Error{constructor(...e){super(...e),this.name="DuplicateDatabaseError"}}t.DuplicateDatabaseError=d;class u extends Error{constructor(...e){super(...e),this.name="DuplicateTableError"}}t.DuplicateTableError=u;class c extends Error{constructor(...e){super(...e),this.name="NoFallbackError"}}t.NoFallbackError=c;class p extends Error{constructor(...e){super(...e),this.name="NoSuchDatabaseError"}}t.NoSuchDatabaseError=p;class h extends Error{constructor(...e){super(...e),this.name="NoSuchTableError"}}t.NoSuchTableError=h;class f extends Error{constructor(...e){super(...e),this.name="NotInitializedError"}}t.NotInitializedError=f;t.default=class{constructor(e){this.tables=new Map,this.views=new Map,this.state=1,this.versions=new s.default,this.errorHandlers=new Map,this._database=e}addErrorHandler(e,t){var r=(new e).name;this.errorHandlers.set(r,t)}add(e){if(this.tables.has(e))throw new u(`Table "${e}" already added. Reuse the definition.`);var t=new o.default(e,this.versions);return this.tables.set(e,t),t}_getBackingDB(){return this._database}_unsafeGetOrCreateView(e){if(this.views.has(e))return this.views.get(e);var t=this._database.view(e.name,e.rowview,e.shouldEnablePropFilter,e.shouldUseDbMsgEncKeyForEncryptedCol);return this.views.set(e,t),t}_guardInitializedThunk(e){return()=>{if(3&this.state)throw new f("Storage must be initialized before accessing a table!");return e()}}table(e){var t=this.tables.get(e);if(!t)throw new h(`Unknown table ${e} requested, ensure table is defined!`);if(!this._getBackingDB())throw new p(`Unable to find associated database with table "${e}"`);return new n.default(this._guardInitializedThunk((()=>this._unsafeGetOrCreateView(t))),this.errorHandlers)}lock(e,t){if(3&this.state)return Promise.reject(new f("Initialize storage before attempting to lock tables!"));for(var r=0;r<e.length;++r)if(!this.tables.has(e[r]))return Promise.reject(new h(`Requested lock of unknown table "${e[r]}"`));var a=e.map((e=>{var t=this.tables.get(e);if(t)return t;throw new h(`Requested lock of unknown table "${e}"`)})).map((e=>this._unsafeGetOrCreateView(e)));return this._getBackingDB().transact(e,(()=>t(a)))}_getUpgraderForCurrentVersion(e,t){for(var r=0;r<e.length;r++)if(e[r].maxVersion===t){var a=e[r].upgraders.get(t);if(a)return{name:e[r].name,callback:a}}}_applyDatabaseVersion(e,t,r){var a=t,i=r.map((e=>e.schema(a))).filter(Boolean);return e.initialize(t,i,this._getUpgraderForCurrentVersion(r,a),this.errorHandlers)}initialize(){var e=this;return(0,i.default)((function*(){if(4&e.state)throw new l("Storage instance has already been initialized");if(e.versions.validate(),!e._database)throw new p(`"${e._database.constructor.name}" failed availability check!`);yield e._database.available();var t=Array.from(e.tables.values()),r=e._getBackingDB();if(t&&r){for(var a=0;a<=e.versions.max;a++)yield e._applyDatabaseVersion(r,a,t);yield r.open(),e.state=4}}))()}purge(){return this.state=2,this.views=new Map,this._getBackingDB().reset().then((()=>{}))}}},48281:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(70417)),n=a(r(47677)),s=r(11273),o=r(81962);function l(e){return e}t.default=class{constructor(e,t){this.maxVersion=-1,this.versions=new Map,this.upgraders=new Map,this.shouldEnablePropFilter=!0,this.shouldUseDbMsgEncKeyForEncryptedCol=!1,this.name=e,this.versionManager=t}version(e,t,r){this.versionManager.claim(e),(0,n.default)(!this.versions.has(e),`Table "${this.name}" already has version #${+e} defined!`),(0,n.default)(e>this.maxVersion,`Versions for table ${this.name} must be defined in order`),this.maxVersion=e;var a=this.schema(e)||(0,s.emptySchema)(this.name),i=(0,o.sortMutations)(t).reduce(((e,t)=>(t.validate(e),t.apply(e))),(0,s.cloneSchema)(a));return this.versions.set(e,(0,s.freezeSchema)(i)),this.upgraders.set(e,r),this}delete(e){this.versionManager.claim(e),(0,n.default)(!this.versions.has(e),`Table "${this.name}" already has version #${+e} defined!`),(0,n.default)(e>this.maxVersion,`Versions for table ${this.name} must be defined in order`),this.maxVersion=e;var t=this.schema(e)||(0,s.emptySchema)(this.name),r=(0,i.default)((0,i.default)({},t),{},{deleted:!0});return this.versions.set(e,(0,s.freezeSchema)(r)),this}view(e){return this.rowview=e,this}enablePropFilter(e){return this.shouldEnablePropFilter=e,this}useDbMsgEncKeyForEncryptedCol(e){return this.shouldUseDbMsgEncKeyForEncryptedCol=e,this}schema(e){var t=this.versions.get(e);if(t)return t;var r=Array.from(this.versions.keys()).map(l).sort(((e,t)=>e-t)).filter((t=>t<e)).pop();return r||0===r?this.versions.get(r)||(0,s.emptySchema)(this.name):null}}},47628:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.getABPropConfigs=function(){return(0,o.initializeWithoutGKs)().then((()=>(0,n.getTable)().all().then((e=>e))))},t.parseConfigValue=d,t.getConfigValue=function(e){var t=s.ABPropConfigs[e];if(null==t)return __LOG__(4,!0,new Error,!0)`invalid ABProps config name`,SEND_LOGS("invalid ABProps config name: "+e),Promise.reject(new Error("invalid ABProps config name"));var[r,a,i]=t;return(0,o.initializeWithoutGKs)().then((()=>(0,n.getTable)().get(String(r)).then((e=>e?d(e.configValue,a,i):i))))},t.updateABPropConfigs=function(e){var t=[];return e.forEach(((e,r)=>{t.push({configCode:String(r),configValue:e.configValue,configExpoKey:e.configExpoKey})})),(0,l.getStorage)().lock(["abpropConfigs"],function(){var e=(0,i.default)((function*([e]){yield e.clear(),yield e.bulkCreate(t)}));return function(){return e.apply(this,arguments)}}())};var i=a(r(52954)),n=r(45155),s=r(19938),o=r(41856),l=r(92166);function d(e,t,r){return null==e||null==t?r:"bool"===t?"1"===e||"True"===e||"true"===e:"int"===t?parseInt(e,10):"float"===t?parseFloat(e):e}},99854:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.addActiveMessageRange=function(){return _.apply(this,arguments)},t.removeActiveMessageRange=function(e,t){return h.removeRange(e,t)},t.updateActiveMessageRange=function(e){return h.createOrReplaceRange(e)},t.bulkUpdateActiveMessageRanges=function(e){return h.bulkCreateOrReplaceRanges(e)},t.getActiveMessageRanges=function(e){return h.getRangesForChat(e)},t._cache=void 0;var i,n=a(r(70417)),s=a(r(52954)),o=a(r(21830)),l=r(41856),d=r(51829),u=r(9557),c=r(60608),p=new Map,h={reset:()=>{p=new Map},removeRange:function(e,t){var r;return null===(r=p.get(e))||void 0===r||r.delete(t),(0,l.getActiveMessageRangesTable)().remove([e,t])},createOrReplaceRange:function(e){var t=p.get(e.chatId);return null==t&&(t=new Map,p.set(e.chatId,t)),t.set(e.action,e),(0,l.getActiveMessageRangesTable)().createOrReplace(e)},bulkCreateOrReplaceRanges:function(e){return e.forEach((e=>{var t=p.get(e.chatId);null==t&&(t=new Map,p.set(e.chatId,t)),t.set(e.action,e)})),(0,l.getActiveMessageRangesTable)().bulkCreateOrReplace(e)},getRangesForChat:(i=(0,s.default)((function*(e){var t=p.get(e);if(null==t){var r=yield(0,l.getActiveMessageRangesTable)().anyOf(["chatId"],[e]);t=new Map(r.map((e=>[e.action,e]))),p.set(e,t)}return[...t.values()]})),function(){return i.apply(this,arguments)})};function f(e,t){switch(e){case"archive":return{action:"archive",actionValue:(0,o.default)(t.archiveChatAction,"syncActionValue.archiveChatAction")};case"markChatAsRead":return{action:"markChatAsRead",actionValue:(0,o.default)(t.markChatAsReadAction,"syncActionValue.markChatAsReadAction")};case"clearChat":return{action:"clearChat",actionValue:(0,o.default)(t.clearChatAction,"syncActionValue.clearChatAction")};default:throw new Error(`unsupported action for message ranges: ${String(e)}`)}}function _(){return(_=(0,s.default)((function*(e,t,r){var a,i=(0,u.decodeProto)(c.SyncActionValueSpec,r),{actionValue:s}=f(t,i),o=(null===(a=s.messageRange)||void 0===a?void 0:a.messages)||[],l=yield(0,d.filterReceivedMessagesInRange)(e,o),p=Math.max(0,o.length-l.length);return h.createOrReplaceRange((0,n.default)((0,n.default)({chatId:e},f(t,i)),{},{remainingMessages:p}))}))).apply(this,arguments)}t._cache=h},22765:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.getBlocklist=function(){var e=Promise.resolve([]);return i.default.supportsFeature(i.default.F.MD_BACKEND)?e=(0,n.getTable)().all().then((e=>e.map((e=>(0,o.createUserWid)(e.id))))):e},t.updateBlocklist=function(e){var t=Promise.resolve(!1);if(i.default.supportsFeature(i.default.F.MD_BACKEND)&&e){var r=e.map((e=>({id:e.toString()})));return t=(0,s.getStorage)().lock(["blocklist"],(([e])=>e.clear().then((()=>e.bulkCreate(r).then((()=>Promise.resolve(!0)))))))}return t};var i=a(r(20468)),n=r(5710),s=r(92166),o=r(25054)},78391:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.getChatMeta=function(){return d.apply(this,arguments)},t.updateChatForMarkAsReadSync=function(e){return(0,n.getStorage)().lock(["chat"],function(){var t=(0,i.default)((function*([t]){var r=yield t.get(e);if(null!=r)return-1===r.unreadCount?t.createOrMerge(e,{id:e,unreadCount:0}):void 0;__LOG__(4,void 0,new Error)`updateMarkChatAsReadSync: could not find chat with id ${e}`}));return function(){return t.apply(this,arguments)}}())},t.markMessageAndChatAsRead=function(e,t){return(0,n.getStorage)().lock(["message","chat"],function(){var r=(0,i.default)((function*([r,a]){var i=yield(0,l.getTable)().equals(["from","pendingReadReceipt"],[t,1],{shouldDecrypt:!1}),n=[],s=0;i.forEach((t=>{null==e||null!=t.rowId&&t.rowId>e?s++:n.push({id:t.id,ack:Math.max(t.ack,o.default.ACK.READ),pendingReadReceipt:null})}));var d=[a.createOrMerge(t,{id:t,unreadCount:s})];n.length>0&&d.push((0,l.getTable)().bulkCreateOrMerge(n)),yield Promise.all(d)}));return function(){return r.apply(this,arguments)}}())};var i=a(r(52954)),n=r(92166),s=r(23443),o=a(r(23045)),l=r(43730);function d(){return(d=(0,i.default)((function*(e){var t=yield(0,s.getTable)().get(e.toString());return t?{unreadCount:t.unreadCount,timestamp:t.t}:Promise.reject(new Error("Failed to find row in chat table with id:"+e.toString()))}))).apply(this,arguments)}},2584:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.setNotAddressBookContacts=function(e){if(i.default.supportsFeature(i.default.F.MD_BACKEND))return(0,s.getStorage)().lock(["contact"],(()=>{var t=e.map((e=>({id:e,isAddressBookContact:0,name:void 0})));return(0,n.getContactTable)().bulkCreateOrMerge(t)}));return Promise.resolve()};var i=a(r(20468)),n=r(38027),s=r(92166)},9641:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.hasDevice=function(e,t){return o.default.supportsFeature(o.default.F.MD_BACKEND)?t===s.default.DEVICE.PRIMARY_DEVICE?Promise.resolve(!0):p([e.user]).then((([e])=>!!e&&!!e.devices.includes(t))):Promise.resolve(!1)},t.getDeviceIds=p,t.doesDeviceHashMatch=function(e,t){if(o.default.supportsFeature(o.default.F.MD_BACKEND))return null==t?Promise.resolve(!0):p([e.user]).then(function(){var e=(0,i.default)((function*(e){var r=e.map((e=>e?e.devices.map((t=>(0,u.createDeviceWidFromUserAndDevice)(e.id,t))):[])),a=(0,n.default)(r,(e=>e));return(yield(0,c.phashV2)(a))!==t}));return function(){return e.apply(this,arguments)}}());return Promise.resolve(!1)},t.getMyDeviceList=function(){return h.apply(this,arguments)};var i=a(r(52954)),n=a(r(35838)),s=a(r(23045)),o=a(r(20468)),l=r(66239),d=r(6011),u=r(25054),c=r(17063);function p(e){return o.default.supportsFeature(o.default.F.MD_BACKEND)?(0,d.getTable)().bulkGet(e).then((e=>e.map((e=>{if(e){var t=e.devices.map((e=>e.id));return{id:e.id,devices:t}}return null})))):Promise.reject(new Error("getDeviceIds: not supported without model storage and md backend"))}function h(){return(h=(0,i.default)((function*(){var e=(0,l.assertGetMe)(),t=yield(0,d.getTable)().get(e.user);if(!t)throw new Error("syncd: cannot find my device list");return t}))).apply(this,arguments)}},7284:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.persistGroupMetadata=function(e,t){if(n.default.supportsFeature(n.default.F.MD_BACKEND))return(0,s.getTable)().merge(e.toString(),t);return Promise.resolve()},t.getGroupMetadataFromStorage=function(e){if(n.default.supportsFeature(n.default.F.MD_BACKEND))return(0,o.getStorage)().lock(["group-metadata","participant"],function(){var t=(0,i.default)((function*([t,r]){var a=yield t.get(e.toString());if(a){var i=yield r.get(e.toString());if(i&&i.deviceSyncComplete){var s;__LOG__(2,void 0,void 0,void 0,["groups"])`found groupMetadata in storage for group id ${e.toString()}`;var o=new Set(i.admins);return{id:e,owner:a.owner&&(0,l.createWid)(a.owner),creation:a.creation,desc:a.desc,descId:a.descId,descOwner:a.descOwner&&(0,l.createWid)(a.descOwner),descTime:a.descTime,restrict:a.restrict||!1,announce:a.announce||!1,noFrequentlyForwarded:a.noFrequentlyForwarded||!1,ephemeralDuration:a.ephemeralDuration||0,participants:null===(s=i.participants)||void 0===s?void 0:s.map((e=>({id:(0,l.createWid)(e),isAdmin:o.has(e),isSuperAdmin:!1}))),support:n.default.supportsFeature(n.default.F.SUPPORT)&&!0===a.support}}}return __LOG__(2,void 0,void 0,void 0,["groups"])`did not find groupMetadata in storage for group id ${e.toString()}`,null}));return function(){return t.apply(this,arguments)}}());return Promise.resolve(null)};var i=a(r(52954)),n=a(r(20468)),s=r(20226),o=r(92166),l=r(25054)},38365:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.getNextUnProcessedNotification=d,t.updateCurrentlyProcessed=function(e){var t;if(s.default.supportsFeature(s.default.F.MD_BACKEND)){if(l.delete(e),!(t=(0,o.getTable)().remove(e)))return Promise.reject(new Error("updateCurrentProcessed history sync notification: not supported for non MD"))}else t=Promise.reject("updateCurrentProcessed for history sync notification: not supported without md backend");return t},t.markChunkForReuploadPending=function(e){return l.delete(e),(0,o.getTable)().merge(e,{reuploadPending:!0})},t.getByChunkOrderNumber=function(e,t){var r;if(s.default.supportsFeature(s.default.F.MD_BACKEND)){if(!(r=(0,o.getTable)().equals(["chunkOrder","syncType"],[e,t])))return Promise.reject(new Error("getNotificationForChunk history sync notification: not supported for non MD"))}else r=Promise.reject("getNotificationForChunk for history sync notification: not supported without md backend");return r},t.addNotification=u,t.enqueueNotification=function(){return c.apply(this,arguments)},t.fetchNextHitorySyncChunkForProcessing=function(){return p.apply(this,arguments)};var i=a(r(52954)),n=a(r(70417)),s=a(r(20468)),o=r(48516),l=new Set;function d(){var e;if(s.default.supportsFeature(s.default.F.MD_BACKEND)){if(!(e=(0,o.getTable)().equals(["processed"],0).then((e=>{var t=e.filter((e=>!l.has(e.msgKey)&&!e.reuploadPending)).sort(((e,t)=>e.syncType<t.syncType?1:e.syncType>t.syncType?-1:e.syncType===t.syncType&&null!=e.chunkOrder&&null!=t.chunkOrder?e.chunkOrder-t.chunkOrder:0));return t.length>0?t[0]:void 0}))))return Promise.reject(new Error("getNextUnProcessed history sync notification: not supported for non MD"))}else e=Promise.reject("getNextUnProcessed for history sync notification: not supported without md backend");return e}function u(e){var t;if(s.default.supportsFeature(s.default.F.MD_BACKEND)){var r=e.downloadOptions.mediaKey;e.downloadOptions.mediaKey="";var a=(0,n.default)((0,n.default)({},e),{},{chunkEncryptionKey:r});if(e.processed=0,!(t=(0,o.getTable)().createOrMerge(e.msgKey,a)))return Promise.reject(new Error("add history sync notification: not supported for non MD"))}else t=Promise.reject("add history sync notification: not supported without md backend");return t}function c(){return(c=(0,i.default)((function*(e,t=!1){yield u(e),t&&l.add(e.msgKey)}))).apply(this,arguments)}function p(){return(p=(0,i.default)((function*(){if(l.size>0)return null;var e=yield d();return e&&(e.downloadOptions.mediaKey=e.chunkEncryptionKey,delete e.chunkEncryptionKey,l.add(e.msgKey)),e}))).apply(this,arguments)}},18867:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.queryLocalLabelAssociation=s,t.default=function(){return o.apply(this,arguments)};var i=a(r(52954)),n=r(81249);function s(e){return(0,n.getTable)().anyOf(["associationId","type"],e.map((({associationId:e,type:t})=>[e,t])))}function o(){return(o=(0,i.default)((function*(e){var t=yield s(e);yield(0,n.getTable)().bulkRemove(t.map((({labelId:e,associationId:t,type:r})=>[e,t,r])))}))).apply(this,arguments)}},85841:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.getDeviceUpdateLock=function(e){if(!i.default.supportsFeature(i.default.F.MD_BACKEND))return Promise.reject("This call is only supported in MD mode");Promise.resolve();var t=["participant","device-list"];(0,s.getGlobalSecurityNotifications)()&&(t=[...t,"message","chat"]);return(0,n.getStorage)().lock(t,(t=>e(t)))};var i=a(r(20468)),n=r(92166),s=r(66239)},59763:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.createOrMergeReceiptRecords=function(e){if(s.default.supportsFeature(s.default.F.MD_BACKEND)){var t=new Map;return e.forEach((e=>{var r,{msgKey:a,receiverId:i}=e,n=(0,c.toUserWid)(i).toString(),s=a.toString(),l=`${s},${n}`,d=null!==(r=i.device)&&void 0!==r?r:o.default.DEVICE.PRIMARY_DEVICE,u=t.get(l);u?u.deviceNotDelivered.push(d):t.set(l,{msgKey:s,receiverUserJid:n,deviceDelivered:[],deviceNotDelivered:[d]})})),(0,d.getStorage)().lock(["message-info"],function(){var e=(0,n.default)((function*([e]){var r=Array.from(t.values()).map((e=>[e.msgKey,e.receiverUserJid]));return(yield e.anyOf(["msgKey","receiverUserJid"],r)).forEach((e=>{var r=`${e.msgKey},${e.receiverUserJid}`,a=t.get(r);a&&t.set(r,(0,i.default)((0,i.default)({},e),{},{deviceNotDelivered:[...e.deviceNotDelivered,...a.deviceNotDelivered]}))})),(0,p.getTable)().bulkCreateOrReplace(Array.from(t.values()))}));return function(){return e.apply(this,arguments)}}())}return Promise.reject(new Error("createOrMergeReceiptRecords: not supported for non MD"))},t.updateReceiptRecords=function(e,t,r,a){if(s.default.supportsFeature(s.default.F.MD_BACKEND)){var i=_[e],n=(0,c.toUserWid)(r).toString(),o=r.device||0;return i?function(e,t,r,a,i){if(0===i.length)return Promise.resolve();return(0,d.getStorage)().lock(["message-info"],(([n])=>{var s=i.map((e=>[e,r]));return n.bulkGet(s).then((s=>{var o=[];return i.forEach(((i,n)=>{var l=s[n];if(!l)return __LOG__(2)`updateReceiptRecords: got receipt for peer msg ${i},${r}`,void o.push({msgKey:i,receiverUserJid:r,[e]:t,deviceDelivered:[],deviceNotDelivered:[]});if(e!==_[h.INACTIVE]){var d=l[e];(null==l[e]||d>t)&&(l[e]=t)}l.deviceNotDelivered.length>0&&(l.deviceDelivered.push(a),l.deviceDelivered=l.deviceDelivered.filter(((e,t,r)=>r.indexOf(e)===t)),l.deviceNotDelivered=l.deviceNotDelivered.filter((e=>e!==a))),o.push(l)})),n.bulkCreateOrReplace(o)}))}))}(i,t,n,o,a):Promise.reject(new Error(`updateReceiptRecords: not supported ack type ${e}`))}return Promise.reject(new Error("updateReceiptRecords: not supported for non MD"))},t.isRetryEligible=function(e,t){if(s.default.supportsFeature(s.default.F.MD_BACKEND)){var r=(0,c.toUserWid)(t).toString(),a=t.device||0;return(0,p.getTable)().get([e.toString(),r]).then((t=>t?!!t.deviceNotDelivered.includes(a)||(__LOG__(2)`MessageInfoStore: ${e.toString()},${r}:${a} has been delivered`,!1):(__LOG__(2)`MessageInfoStore: missing record for ${e.toString()},${r}`,!1)))}return Promise.resolve(!1)},t.queryMsgInfo=function(e){if(s.default.supportsFeature(s.default.F.MD_BACKEND)){var t=String(e);return(0,l.getTable)().get(t).then((t=>{var r=t?t.count:null;return(0,p.getTable)().equals(["msgKey"],e.toString()).then((t=>{var a={delivery:[],deliveryRemaining:0,played:[],playedRemaining:0,read:[],readRemaining:0},i=0;t.forEach((e=>{var t=(0,c.createWid)(e.receiverUserJid);if(!(0,u.getMeUser)().equals(t)){!function(e){var t=e.read;null!=t&&(null==e.delivery||e.delivery>t)&&(e.delivery=t)}(e);for(var r=0;r<m.length;r++){var n=m[r],s=e[n];if(null!=s){a[n].push({id:t,t:s});break}}i+=1}}));var n=null!=r&&0!==r?r:i;return __LOG__(2)`queryMsgInfo: ${e}, ack count: ${r}, receiver: ${n},
played: ${a.played.length}, read: ${a.read.length}, delivery: ${a.delivery.length}`,a.playedRemaining=n-a.played.length,a.readRemaining=a.playedRemaining-a.read.length,a.deliveryRemaining=a.readRemaining-a.delivery.length,a}))}))}return Promise.reject(new Error("queryMsgInfo: not supported without model storage"))};var i=a(r(70417)),n=a(r(52954)),s=a(r(20468)),o=(a(r(43926)),a(r(23045))),l=r(43730),d=r(92166),u=r(66239),c=r(25054),p=r(86653),{ACK:h,ACK_STRING:f}=o.default,_={[h.RECEIVED]:f.DELIVERY,[h.READ]:f.READ,[h.PLAYED]:f.PLAYED,[h.INACTIVE]:f.INACTIVE},m=[f.PLAYED,f.READ,f.DELIVERY]},57861:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.removeMessagesFromHistory=function(e){if(i.default.supportsFeature(i.default.F.MD_BACKEND))return(0,n.initializeWithoutGKs)().then((()=>(0,d.getStorage)().lock(["message","label-association"],(()=>{var t=(0,l.default)(e.map((e=>({associationId:e,type:s.LabelAssociationType.Message}))));return Promise.all([(0,o.getTable)().bulkRemove(e),t])})))).then((()=>{})).catch((e=>{throw __LOG__(4,void 0,new Error)`removeMessagesFromHistory: error ${e}`,e}));return Promise.resolve()};var i=a(r(20468)),n=r(41856),s=r(81249),o=r(43730),l=a(r(18867));r(18165);var d=r(92166)},14366:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.pruneExpiredMessages=function(){if(i.default.supportsFeature(i.default.F.MD_BACKEND)&&o.default.ephemeralPruning)return(0,s.getTable)().lessThan(["expiredTimestamp"],n.default.globalUnixTime()).then((e=>{(0,s.getTable)().bulkRemove(e.map((e=>e.id)))}));return Promise.resolve()};var i=a(r(20468)),n=a(r(99461)),s=r(43730),o=a(r(54559))},43250:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.msgFindQuery=function(e,t){if(null!=t.label)return Promise.resolve([]);if("before"===e)return function(e,t=20){if(i.default.supportsFeature(i.default.F.MD_BACKEND)&&e instanceof n.default){var r=e.remote.toString();return(0,o.getTable)().equals(["id"],e.toString()).then((a=>{if(0===a.length)return __LOG__(3)`Anchor message ${e.toString()} does not exist in message table`,Promise.reject(new l(e.toString()));var i=a[0],n=(0,s.getInChatMsgId)(i.internalId||""),o=Math.max(0,n-t),d=(0,s.craftInternalId)(r,o),u=(0,s.craftInternalId)(r,n);return(0,s.queryChatMessageHelper)(d,u,{lowerInclusive:!0,upperInclusive:!1}).then((e=>e.map(s.hydrateMessage)))}))}return Promise.resolve([])}(t,t.count);if("after"===e)return function(e,t=20){if(i.default.supportsFeature(i.default.F.MD_BACKEND)&&e instanceof n.default){var r=e.remote.toString();return(0,o.getTable)().equals(["id"],e.toString()).then((a=>{if(0===a.length)return __LOG__(3)`Anchor message ${e.toString()} does not exist in message table`,Promise.reject(new l(e.toString()));var i=a[0],n=(0,s.getInChatMsgId)(i.internalId||""),o=(0,s.craftInternalId)(r,n),d=(0,s.craftInternalId)(r,n+t);return(0,s.queryChatMessageHelper)(o,d,{lowerInclusive:!1,upperInclusive:!0}).then((e=>e.map(s.hydrateMessage)))}))}return Promise.resolve([])}(t,t.count).catchType(l,(()=>({status:404})));if("star"===e){var a=null==t.id?void 0:new n.default(t);return null!=t.chat?function(e,t,r){if(i.default.supportsFeature(i.default.F.MD_BACKEND))return Promise.resolve().then((()=>{if(null!=r)return(0,o.getTable)().get(r.toString())})).then((r=>{var a=null==r?[(0,s.endOfChat)(e),1/0]:[r.internalId,r.isStarred],i=[(0,s.beginningOfChat)(e),0];return(0,o.getTable)().between(["internalId","isStarred"],i,a,{lowerInclusive:!1,upperInclusive:!1,reverse:!0,limit:t}).then((e=>e.map(s.hydrateMessage)))}));return Promise.resolve([])}(t.chat,t.count,a):function(e,t){if(i.default.supportsFeature(i.default.F.MD_BACKEND))return Promise.resolve().then((()=>{if(null!=t)return(0,o.getTable)().get(t.toString())})).then((t=>{var r=null==t?1/0:t.isStarred;return(0,o.getTable)().between(["isStarred"],0,r,{lowerInclusive:!1,upperInclusive:!1,reverse:!0,limit:e}).then((e=>e.map(s.hydrateMessage)))}));return Promise.resolve([])}(t.count,a)}if("search"===e){var u={};t.remote&&(u.remote=t.remote.toString()),t.count&&t.page>=0&&(u.limit=t.count,u.page=t.page);var{default:c}=r(87538);return c.search(t.searchTerm,u)}if("media"===e){var p=t.remote,h=null==t.id?void 0:new n.default(t);return"document"===t.media?d(p,t.count,t.direction,"isDocMsg",h).then((e=>e.map(s.hydrateMessage))):"url"===t.media?d(p,t.count,t.direction,"hasLink",h).then((e=>e.map(s.hydrateMessage))):Promise.all([d(p,t.count,t.direction,"isMediaMsg",h).then((e=>e.map(s.hydrateMessage))),d(p,t.count,t.direction,"isDocMsg",h).then((e=>e.map(s.hydrateMessage))),d(p,t.count,t.direction,"hasLink",h).then((e=>e.map(s.hydrateMessage)))]).then((([e,t,r])=>{var a=[e,r,t].flat();return{docCount:t.length,linkCount:r.length,mediaCount:e.length,messages:a}}))}return __LOG__(3)`Message query type ${e} not implemented.`,Promise.reject(new Error(`Message query type ${e} not implemented.`))},t.queryVcard=function(e){if(i.default.supportsFeature(i.default.F.MD_BACKEND))return(0,o.getTable)().equals(["vcardWAids"],e.toString()).then((e=>e.map(s.hydrateMessage)));return Promise.resolve()},t.getMsgByMsgKey=function(e){if(i.default.supportsFeature(i.default.F.MD_BACKEND)){var t;return t=e instanceof n.default?e.toString():e,(0,o.getTable)().get(t).then((e=>e?(0,s.hydrateMessage)(e):null))}return Promise.resolve(null)},t.getMsgsByMsgKey=function(e){if(i.default.supportsFeature(i.default.F.MD_BACKEND))return(0,o.getTable)().bulkGet(e).then((e=>e.filter(Boolean).map(s.hydrateMessage)));return Promise.resolve([])};var i=a(r(20468)),n=a(r(83746)),s=r(44042),o=r(43730);class l extends Error{constructor(e){super(`Anchor message ${e} does not exist in message table`),this.name="NoAnchorMessageError"}}function d(e,t,r,a,n){return i.default.supportsFeature(i.default.F.MD_BACKEND)?(null==n?Promise.resolve(void 0):(0,o.getTable)().equals(["id"],n.toString())).then((i=>{if(n&&null!=i&&0===i.length)return __LOG__(3)`Anchor message ${n&&n.toString()} does not exist in message table`,Promise.reject(new l(n&&n.toString()));var d,u,c=i&&i[0];return"before"===r?(d=(0,s.beginningOfChat)(e),u=null==c?(0,s.endOfChat)(e):(0,s.craftInternalId)(e.toString(),(0,s.getInChatMsgId)(c.internalId||""))):(d=null==c?(0,s.beginningOfChat)(e):(0,s.craftInternalId)(e.toString(),(0,s.getInChatMsgId)(c.internalId||"")),u=(0,s.endOfChat)(e)),(0,o.getTable)().between(["internalId",a],[d,0],[u,1/0],{lowerInclusive:!1,upperInclusive:!1,limit:t})})):Promise.resolve([])}},245:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"storeMessages",{enumerable:!0,get:function(){return a.storeMessages}}),Object.defineProperty(t,"storeInitialSyncMessages",{enumerable:!0,get:function(){return a.storeInitialSyncMessages}}),Object.defineProperty(t,"starMessages",{enumerable:!0,get:function(){return a.starMessages}}),Object.defineProperty(t,"unstarMessages",{enumerable:!0,get:function(){return a.unstarMessages}}),Object.defineProperty(t,"updateMessage",{enumerable:!0,get:function(){return a.updateMessage}}),Object.defineProperty(t,"processRevokeMsgs",{enumerable:!0,get:function(){return a.processRevokeMsgs}}),Object.defineProperty(t,"storeRecentAndFullHistSyncMessages",{enumerable:!0,get:function(){return a.storeRecentAndFullHistSyncMessages}}),Object.defineProperty(t,"msgFindQuery",{enumerable:!0,get:function(){return i.msgFindQuery}}),Object.defineProperty(t,"getMsgByMsgKey",{enumerable:!0,get:function(){return i.getMsgByMsgKey}}),Object.defineProperty(t,"getMsgsByMsgKey",{enumerable:!0,get:function(){return i.getMsgsByMsgKey}}),Object.defineProperty(t,"queryVcard",{enumerable:!0,get:function(){return i.queryVcard}}),Object.defineProperty(t,"removeMessagesFromHistory",{enumerable:!0,get:function(){return n.removeMessagesFromHistory}});var a=r(3710),i=r(43250),n=r(57861)},51829:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.getLastMessageTimestamp=function(e){return(0,n.getTable)().between(["messageRangeIndex"],(0,d.beginningOfMessageRange)(e,d.MessagePropertyType.IncomingChatMessage),(0,d.endOfMessageRange)(e,d.MessagePropertyType.IncomingChatMessage),{lowerInclusive:!0,reverse:!0,limit:1}).then((e=>{var t;return(0,d.extractC2STimestampFromMessageRangeIndex)(null===(t=e[0])||void 0===t?void 0:t.messageRangeIndex)}))},t.getLastSystemMessageTimestamp=function(e){return(0,n.getTable)().between(["messageRangeIndex"],(0,d.beginningOfMessageRange)(e,d.MessagePropertyType.SystemMessage),(0,d.endOfMessageRange)(e,d.MessagePropertyType.SystemMessage),{lowerInclusive:!0,reverse:!0,limit:1}).then((e=>{var t;return(0,d.extractC2STimestampFromMessageRangeIndex)(null===(t=e[0])||void 0===t?void 0:t.messageRangeIndex)}))},t.getAdditionalMessages=function(){return c.apply(this,arguments)},t.filterReceivedMessagesInRange=function(){return p.apply(this,arguments)},t.timestampComparison=f,t._test=void 0;var i=a(r(52954)),n=r(43730),s=a(r(83746)),o=a(r(21830)),l=r(58443),d=r(44042),u=r(25364);function c(){return(c=(0,i.default)((function*(e,t,r=1e3){var a=(0,n.getTable)().between(["messageRangeIndex"],(0,d.beginningOfMessageRange)(e,d.MessagePropertyType.Outgoing,t),(0,d.endOfMessageRange)(e,d.MessagePropertyType.Outgoing),{reverse:!0}),i=(0,n.getTable)().anyOf(["messageRangeIndex"],[(0,d.beginningOfMessageRange)(e,d.MessagePropertyType.IncomingChatMessage,t),(0,d.beginningOfMessageRange)(e,d.MessagePropertyType.Outgoing,t),(0,d.beginningOfMessageRange)(e,d.MessagePropertyType.Outgoing)],{reverse:!0}),o=yield Promise.all([a,i]).then((([e,t])=>e.concat(t).filter((e=>-1!==e.ack)).map((e=>{var t,r=s.default.fromString(e.id),a=null!==(t=(0,d.extractC2STimestampFromMessageRangeIndex)(e.messageRangeIndex))&&void 0!==t?t:void 0;return{key:(0,l.msgKeyToProtobuf)(r),timestamp:a}})))),{messages:u,newLastMessageTimestamp:c}=h(o,r);return{messages:u,newLastMessageTimestamp:c}}))).apply(this,arguments)}function p(){return(p=(0,i.default)((function*(e,t){if(0===t.length)return t;var r=t.map((e=>(0,l.protobufToMsgKey)((0,o.default)(e.key,"syncActionMessage.key")).toString())),a=yield(0,n.getTable)().bulkGet(r);return t.filter(((e,t)=>null!=a[t]))}))).apply(this,arguments)}function h(e,t){var r=[],a=[];if(e.forEach((e=>{null!=e.timestamp?r.push(e):a.push(e)})),r.length<t)return{messages:e};var i=r.sort(f).slice(0,t),n=i[i.length-1];return{messages:i.concat(a),newLastMessageTimestamp:(0,u.numberOrThrowIfTooLarge)((0,o.default)(n.timestamp,"smallestTimestampMessage.timestamp"))}}function f(e,t){var[r,a]=[e,t].map((e=>(0,u.numberOrThrowIfTooLarge)((0,o.default)(e.timestamp,"syncActionMessage.timestamp"))));return a-r}var _={limitAdditionalMessages:h};t._test=_},3710:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.storeInitialSyncMessages=function(){return O.apply(this,arguments)},t.storeRecentAndFullHistSyncMessages=function(){return w.apply(this,arguments)},t.storeMessages=function(){return M.apply(this,arguments)},t.updateMessage=function(e){if(o.default.supportsFeature(o.default.F.MD_BACKEND)){delete e.t;var t=(0,u.convertToMessageRowType)(e);return(0,_.getTable)().createOrMerge(t.id,t)}return Promise.resolve()},t.starMessages=function(e){if(o.default.supportsFeature(o.default.F.MD_BACKEND))return(0,_.getTable)().bulkGet(e).then((e=>{var t=e.filter(Boolean).map((e=>({id:e.id,isStarred:e.rowId})));return(0,_.getTable)().bulkCreateOrMerge(t)}));return Promise.resolve()},t.unstarMessages=function(e){if(o.default.supportsFeature(o.default.F.MD_BACKEND))return(0,_.getTable)().bulkCreateOrMerge(e.map((e=>({id:e,isStarred:void 0}))));return Promise.resolve()},t.processRevokeMsgs=function(e,t){if(o.default.supportsFeature(o.default.F.MD_BACKEND))return(0,C.getStorage)().lock(["message"],function(){var r=(0,n.default)((function*([r]){var a=yield(0,_.getTable)().bulkGet(e,!1),i=[];a.forEach(((r,a)=>{if(null==r)return __LOG__(4,!0,new Error,!0)`processRevokeMsg: old message key does not exist`,void SEND_LOGS("RevokeMsg-not-found-error");i.push({id:t[a],to:r.to,author:r.author,type:p.default.MSG_TYPE.REVOKED,protocolMessageKey:e[a],from:r.from,t:r.t,rowId:r.rowId,internalId:r.internalId})})),yield(0,_.getTable)().bulkRemove(e),yield(0,_.getTable)().bulkCreateOrReplace(i)}));return function(){return r.apply(this,arguments)}}());return Promise.resolve()},t.encryptMultipleMsgs=D,t.storeEncryptedMessage=L,t.storeMessageInTransaction=k;var i=a(r(70417)),n=a(r(52954)),s=a(r(15253)),o=a(r(20468)),l=r(74739),d=r(68439),u=r(44042),c=r(65999),p=a(r(23045)),h=r(11219),f=r(27860),_=r(43730),m=r(25054),g=a(r(87538)),v=a(r(15934)),E=a(r(83746)),y=a(r(49508)),S=a(r(77613)),T=a(r(77715)),A=r(99387),b=r(63428),C=r(92166),P=1e9;function O(){return(O=(0,n.default)((function*(e){if(o.default.supportsFeature(o.default.F.MD_BACKEND)){yield y.default.waitForFinalDbMsgEncKey();var t=0;(0,s.default)(e,(({msgs:e})=>t+=e.length));var r=Object.keys(e).reduce(((t,r)=>{var a=t.nextRowId,i=P-e[r].msgs.length,n=G(e[r].chatInfo.unreadCount||0,e[r].msgs),s=e[r].msgs.map((e=>(a++,i++,x((0,u.convertToMessageRowType)(e),(0,m.createWid)(r).toString(),!!(0,b.findLink)(e.body,!0),a,i,n.has(String(e.id))))));return{nextRowId:a,messages:t.messages.concat(s)}}),{nextRowId:P-t,messages:[]});return(0,C.getStorage)().lock(["message"],(([e])=>e.bulkCreate(r.messages).catch((t=>{if(__LOG__(3)`Error storing MD initial sync messages with error ${t}`,t instanceof T.default.BulkError||t instanceof T.default.ConstraintError)return __LOG__(2,void 0,void 0,void 0,["History sync"])`Retrying initial sync bulk add on error`,e.bulkCreateOrMerge(r.messages);throw t})))).then((()=>{T.default.ignoreTransaction((()=>{(0,A.getTable)().bulkCreate(r.messages.map((e=>({id:e.id})))).then((()=>{g.default.index()}))}))})).catch((e=>{__LOG__(3)`Error storing MD initial sync messages with error ${e} after retry`}))}return Promise.resolve()}))).apply(this,arguments)}function w(){return(w=(0,n.default)((function*(e,t,r=!1,a=!1){return o.default.supportsFeature(o.default.F.MD_BACKEND)?L(yield D(e,r),t,a).catch((()=>{__LOG__(3)`Error storing MD initial sync messages`})):Promise.resolve()}))).apply(this,arguments)}function M(){return(M=(0,n.default)((function*(e,t,r=!1){return o.default.supportsFeature(o.default.F.MD_BACKEND)?(yield y.default.waitForFinalDbMsgEncKey(),Promise.resolve(k(e,t,r)).catchType(T.default.BulkError,(()=>{var r=null==t?e[0].id.remote:t,a=e.map((e=>x((0,u.convertToMessageRowType)(e),r.toString(),!!(0,b.findLink)(e.body,!0))));return(0,_.getTable)().bulkCreateOrMerge(a)})).then((()=>{g.default.index()})).catch((e=>{throw __LOG__(3)`Error storing messages`,e}))):Promise.resolve()}))).apply(this,arguments)}function I(){return R.apply(this,arguments)}function R(){return(R=(0,n.default)((function*(e,t){if(S.default.isLogoutInProgress)return Promise.reject(new Error("dropping processAndEncryptSingleMsgRow due to logout"));null!=t&&(yield(0,f.asyncSleepAfterGivenLoopIteration)(t,150));var r=(0,_.getTable)(),a=B(e),n=(0,u.convertToMessageRowType)(e),s=yield r.preflightEncryptSingleRecord((0,i.default)({},n));return[(0,i.default)((0,i.default)((0,i.default)({},n),s),{},{vcardWAids:a}),!!(0,b.findLink)(e.body,!0)]}))).apply(this,arguments)}function D(){return N.apply(this,arguments)}function N(){return(N=(0,n.default)((function*(e,t=!1){var r;if(yield y.default.waitForFinalDbMsgEncKey(),yield new Promise((e=>setTimeout(e,0))),t){r=[];for(var a=0;a<e.length;a++){var i=e[a],s=yield I(i,a);r.push(s)}}else r=yield Promise.all(e.map(function(){var e=(0,n.default)((function*(e){return yield I(e)}));return function(){return e.apply(this,arguments)}}()));return r}))).apply(this,arguments)}function L(e,t,r=!1){return(0,C.getStorage)().lock(["message"],function(){var a=(0,n.default)((function*([a]){var i=yield a.all({reverse:!r,limit:1,index:["rowId"],returnKeyType:"keys"}).then((e=>0===e.length?P:e[0])),n={};yield Promise.all(t.map((e=>{var t=(0,m.createWid)(e),i=(0,u.beginningOfChat)(t),s=(0,u.endOfChat)(t);return a.between(["internalId"],i,s,{limit:1,reverse:!r,returnKeyType:"keys"}).then((e=>n[t.toString()]=0===e.length?P:(0,u.getInChatMsgId)(e[0])))})));var s=r?-1:1,o=e.map((([e,t],a)=>{var o=E.default.fromString(e.id),l=o.remote.toString(),d=n[l]+1*s;n[l]=d;var u=!r&&U(o,e);return x(e,l,t,i+s*(a+1),d,u)}));return a.bulkCreateWith_ALREADY_ENCRYPTED_RECORDS_ONLY(o).catch((e=>{if(r&&e instanceof T.default.BulkError)return __LOG__(4,void 0,new Error)`[storeEncryptedMessage] BulkError in bulkCreate, retrying with bulk create or replace`,a.bulkCreateOrReplace_ALREADY_ENCRYPTED_RECORDS_ONLY(o);throw e})).then((()=>o))}));return function(){return a.apply(this,arguments)}}()).then((e=>{T.default.ignoreTransaction((()=>{(0,A.getTable)().bulkCreate(e.map((e=>({id:e.id})))).then((()=>{g.default.index()}))}))}))}function k(e,t,r=!1){var a=null==t?e[0].id.remote:t,i=(0,u.beginningOfChat)(a),s=(0,u.endOfChat)(a);return(0,C.getStorage)().lock(["chat","message"],function(){var t=(0,n.default)((function*([t,n]){var o=yield t.get(a.toString());if(!a.isStatusV3()&&(null!=o||(0,u.shouldCreateChatWithMsgs)(e))){var l=yield function(){return F.apply(this,arguments)}(o,e,a);yield t.createOrMerge(a.toString(),l)}var d=n.all({reverse:!r,limit:1,index:["rowId"],returnKeyType:"keys"}).then((e=>0===e.length?P:e[0])),c=n.between(["internalId"],i,s,{limit:1,reverse:!r,returnKeyType:"keys"}).then((e=>0===e.length?P:(0,u.getInChatMsgId)(e[0]))),[p,h]=yield Promise.all([d,c]),f=r?p-e.length:p+1,_=r?h-e.length:h+1,m=e.map(((e,t)=>{var i=(0,u.convertToMessageRowType)(e),n=!r&&U(e.id,e);return x(i,a.toString(),!!(0,b.findLink)(e.body,!0),f+t,_+t,n)}));return n.bulkCreate(m).then((()=>m))}));return function(){return t.apply(this,arguments)}}()).then((e=>{T.default.ignoreTransaction((()=>{(0,A.getTable)().bulkCreate(e.map((e=>({id:e.id}))))}))}))}function U(e,t){if(e.fromMe||e.remote.isStatusV3())return!1;var r=(0,d.eventTypeFromMsgType)(t);return"a"===r||"d"===r}function G(e,t){for(var r=e,a=new Set,i=t.length-1;i>=0&&!(r<=0);i--){var n=t[i];U(n.id,n)&&(r--,a.add(String(n.id)))}return a}function F(){return(F=(0,n.default)((function*(e,t,r){var a=void 0,i=Math.max(0,e?e.unreadCount:0);return t.forEach((e=>{var t=(0,d.eventTypeFromMsgType)(e);"i"!==t&&(e&&null!=e.t&&(null==a||e.t>a)&&(a=e.t),"a"!==t&&"d"!==t||e.id.fromMe||(i+=1))})),e&&null!=e.t&&(null==a||e.t>a)&&(a=e.t),{id:r.toString(),unreadCount:i,t:a}}))).apply(this,arguments)}function x(e,t,r,a,n,s){var o=[p.default.MSG_TYPE.IMAGE,p.default.MSG_TYPE.VIDEO,p.default.MSG_TYPE.AUDIO].includes(e.type),l=(0,i.default)((0,i.default)({},e),{},{vcardWAids:e.vcardWAids||B(e),id:e.id.toString(),isStarred:e.star?a:void 0,hasLink:"chat"===e.type&&r?a:void 0,isMediaMsg:o?a:void 0,isDocMsg:e.type===p.default.MSG_TYPE.DOCUMENT?a:void 0,expiredTimestamp:Y(e)});null!=a&&(l.rowId=a),null!=n&&(l.internalId=(0,u.craftInternalId)(t,n)),s&&t!==h.STATUS_JID&&(l.pendingReadReceipt=1);var d,c=e.c2sTimestamp;e.id.fromMe&&!v.default.hasSynced?c=null!==(d=e.c2sTimestamp)&&void 0!==d?d:e.t:c=e.t;try{l.messageRangeIndex=(0,u.craftMessageRangeIndex)(t,!E.default.fromString(e.id).fromMe,p.default.SYSTEM_MESSAGE_TYPES.includes(e.type),c)}catch(e){__LOG__(4,void 0,new Error)`[process-msg] craftMessageRangeIndex failed with error ${e}`}return l}function B(e){var t=[];if("vcard"===e.type)t=[e.body];else{if("multi_vcard"!==e.type)return;t=e.vcardList.map((e=>e.vcard))}return t.filter(Boolean).reduce(((e,t)=>{var r=(0,c.vcardWids)((0,c.parseVcard)(t));return e.concat(r.map((e=>e.toString())))}),[])}function Y(e){var{ephemeralDuration:t,ephemeralStartTimestamp:r,t:a,subtype:i,id:{fromMe:n}}=e,s=(0,l.getEphemeralExpirationTimestamp)(t,r,a,i,n);return null!=s?s:void 0}},4750:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return o.apply(this,arguments)};var i=a(r(52954)),n=r(43730),s=r(44042);function o(){return(o=(0,i.default)((function*(e){var t=(0,s.beginningOfChat)(e),r=(0,s.endOfChat)(e),a=yield(0,n.getTable)().between(["internalId"],t,r,{lowerInclusive:!1,upperInclusive:!1,returnKeyType:"primary_key"});yield(0,n.getTable)().bulkRemove(a)}))).apply(this,arguments)}},44042:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.convertToMessageRowType=function(e){var t,r=(0,n.default)({},e);e.quotedMsg&&(r.quotedMsg=(0,n.default)({},e.quotedMsg));(null===(t=e.quotedMsg)||void 0===t?void 0:t.paymentNoteMsg)&&(r.quotedMsg.paymentNoteMsg=(0,n.default)({},e.quotedMsg.paymentNoteMsg));e.paymentNoteMsg&&(r.paymentNoteMsg=(0,n.default)({},e.paymentNoteMsg));r.id=e.id.toString(),e.from&&(r.from=e.from.toString());e.protocolMessageKey&&(r.protocolMessageKey=e.protocolMessageKey.toString());e.paymentRequestMessageKey&&(r.paymentRequestMessageKey=e.paymentRequestMessageKey.toString());return delete r.notifyName,delete r.local,delete r.isNewMsg,delete r.clearMedia,delete r.multicast,delete r.urlNumber,delete r.urlText,delete r.linkPreview,delete r.star,delete r.forwardedFromWeb,r=function(e){var t,r,a,i={currentMsg:{},quotedMsg:{}};if(null===(t=e.paymentNoteMsg)||void 0===t?void 0:t.body){var n;i.currentMsg.paymentNoteMsgBody=e.paymentNoteMsg.body,null===(n=e.paymentNoteMsg)||void 0===n||delete n.body}(null===(r=e.quotedMsg)||void 0===r||null===(a=r.paymentNoteMsg)||void 0===a?void 0:a.body)&&(i.quotedMsg.paymentNoteMsgBody=e.quotedMsg.paymentNoteMsg.body,delete e.quotedMsg.paymentNoteMsg.body);f.forEach((t=>{i.currentMsg[t]=e[t],delete e[t]})),e.quotedMsg&&f.forEach((t=>{i.quotedMsg[t]=e.quotedMsg[t],delete e.quotedMsg[t]}));var s=(0,o.encodeProto)(u.MsgRowOpaqueDataSpec,i);return e.msgRowOpaqueData=s.readBuffer(),e}(r)},t.hydrateMessage=function(e){var t,r=(0,n.default)({},e);e.quotedMsg&&(r.quotedMsg=(0,n.default)({},e.quotedMsg));(null===(t=e.quotedMsg)||void 0===t?void 0:t.paymentNoteMsg)&&(r.quotedMsg.paymentNoteMsg=(0,n.default)({},e.quotedMsg.paymentNoteMsg));e.paymentNoteMsg&&(r.paymentNoteMsg=(0,n.default)({},e.paymentNoteMsg));var a=c.default.fromString(r.id),i=r.protocolMessageKey?c.default.fromString(r.protocolMessageKey):void 0,o=r.paymentRequestMessageKey?c.default.fromString(r.paymentRequestMessageKey):void 0,d=(0,p.hydrateWids)(r);d.id=a,i&&(d.protocolMessageKey=i);o&&(d.paymentRequestMessageKey=o);return r.star=void 0!==r.isStarred,delete r.internalId,delete r.rowId,delete r.isStarred,delete r.count,delete r.hasLink,delete r.isMediaMsg,delete r.isDocMsg,delete r.expiredTimestamp,delete r.pendingReadReceipt,r=function(e){E(e)&&e.id.fromMe&&null!=e.ack&&e.ack===l.default.ACK.CLOCK&&(e.isSendFailure=!0);return e}(r=function(e){var t=(0,s.decodeProto)(u.MsgRowOpaqueDataSpec,e.msgRowOpaqueData);if(t.currentMsg){var r;if(t.currentMsg.paymentNoteMsgBody&&e.paymentNoteMsg)e.paymentNoteMsg.body=null===(r=t.currentMsg)||void 0===r?void 0:r.paymentNoteMsgBody;f.forEach((r=>{var a;e[r]=null===(a=t.currentMsg)||void 0===a?void 0:a[r]}))}e.quotedMsg&&t.quotedMsg&&(t.quotedMsg.paymentNoteMsgBody&&(e.quotedMsg.paymentNoteMsg.body=t.quotedMsg.paymentNoteMsgBody),f.forEach((r=>{var a;e.quotedMsg[r]=null===(a=t.quotedMsg)||void 0===a?void 0:a[r]})));return e}(r))},t.craftMessageRangeIndex=function(e,t,r,a){var i;i=r?_.SystemMessage:t?_.IncomingChatMessage:_.Outgoing;return`${e}_${i}_${null!=a?m(a):""}`},t.extractC2STimestampFromMessageRangeIndex=function(e){if(e){var t=e.split("_")[2];return t?g(t):null}return null},t.beginningOfMessageRange=function(e,t,r){var a=null!=r?m(r):"";return`${e.toString()}_${t}_${a}`},t.endOfMessageRange=function(e,t){return`${e.toString()}_${t}_g`},t.craftInternalId=function(e,t){var r=m(t);return`${e}_${r}_m`},t.getInChatMsgId=function(e){return g(e.split("_")[1])},t.beginningOfChat=function(e){return`${e.toString()}_/`},t.endOfChat=function(e){return`${e.toString()}_g`},t.queryChatMessageHelper=function(){return v.apply(this,arguments)},t.isUnreadTypeMsg=E,t.getKeyMsgsFromChatHistory=function(e,t){if(d.default.supportsFeature(d.default.F.MD_BACKEND)){var r,a=e.unreadCount,i=void 0,n=void 0,s=void 0;return(0,h.getTable)().between(["internalId"],`${e.id}_/`,`${e.id}_g`,{reverse:!0},(e=>(s||(s=e.id),!t||(n||(n=e),i||e.type!==l.default.MSG_TYPE.E2E_NOTIFICATION&&e.type!==l.default.MSG_TYPE.PROTOCOL&&(i=e),!(0!==a||!i)||!!(a>0&&E(e)&&0===(a-=1))&&(r=e.id.toString(),!0))))).then((()=>({anchor:r,previewMsg:i||n,lastReceivedKey:s})))}return Promise.resolve({anchor:void 0,previewMsg:void 0,lastReceivedKey:void 0})},t.shouldCreateChatWithMsgs=function(e){return e.some((e=>e.type!==l.default.MSG_TYPE.NOTIFICATION_TEMPLATE))},t.MessagePropertyType=t.MSG_OPAQUE_DATA_KEYS=void 0;var i=a(r(52954)),n=a(r(70417)),s=r(9557),o=r(76549),l=a(r(23045)),d=a(r(20468)),u=r(43874),c=a(r(83746)),p=r(96631),h=r(43730),f=["body","caption","clientUrl","loc","lng","lat","paymentAmount1000","canonicalUrl","matchedText","title","description"];t.MSG_OPAQUE_DATA_KEYS=f;var _=r(28103)({IncomingChatMessage:"1",Outgoing:"2",SystemMessage:"3"});function m(e){var t=e.toString(16);return(t.length-1).toString(16)+t}function g(e){return parseInt(e.substring(1),16)}function v(){return(v=(0,i.default)((function*(e,t,r){return d.default.supportsFeature(d.default.F.MD_BACKEND)?y(yield(0,h.getTable)().between(["internalId"],e,t,r)):Promise.resolve([])}))).apply(this,arguments)}function E(e){return[l.default.MSG_TYPE.CHAT,l.default.MSG_TYPE.IMAGE,l.default.MSG_TYPE.VIDEO,l.default.MSG_TYPE.AUDIO,l.default.MSG_TYPE.PTT,l.default.MSG_TYPE.DOCUMENT,l.default.MSG_TYPE.VCARD,l.default.MSG_TYPE.LOCATION,l.default.MSG_TYPE.CIPHERTEXT,l.default.MSG_TYPE.OVERSIZED,l.default.MSG_TYPE.MULTI_VCARD,l.default.MSG_TYPE.UNKNOWN,l.default.MSG_TYPE.STICKER,l.default.MSG_TYPE.PRODUCT,l.default.MSG_TYPE.GROUPS_V4_INVITE].includes(e.type)}function y(e){return e.filter((e=>e.type!==l.default.MSG_TYPE.DEBUG))}t.MessagePropertyType=_},62160:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.removeOrphanReceipt=function(e){if(i.default.supportsFeature(i.default.F.MD_BACKEND))return(0,n.getTable)().remove(e);return Promise.reject(new Error("removeOrphanReceipt: not supported for non MD"))},t.getOrphanReceipt=function(e){if(i.default.supportsFeature(i.default.F.MD_BACKEND))return(0,n.getTable)().get(e);return Promise.reject(new Error("getOrphanReceipt: not supported for non MD"))},t.createOrUpdateOrphanReceipt=function(e,t,r){if(i.default.supportsFeature(i.default.F.MD_BACKEND))return(0,s.getStorage)().lock(["orphan-receipt"],(([a])=>a.bulkGet(r).then((i=>{var n=r.reduce(((r,a,n)=>{var s=i[n];s||(s={msgKey:a});var o=s[e];return(null==o||o>t)&&(s[e]=t,r.push(s)),r}),[]);return a.bulkCreateOrReplace(n)}))));return Promise.reject(new Error("updateReceiptRecords: not supported for non MD"))};var i=a(r(20468)),n=r(78889),s=r(92166)},61333:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.getGroupSenderKeyList=function(e){var t;if(n.default.supportsFeature(n.default.F.MD_BACKEND)){var r=e.toString();if(!(t=(0,l.getTable)().get(r).then((e=>{var t=[],r=[];if(!e)return{skDistribList:t,skList:r,rotateKey:!1};var{senderKey:a,rotateKey:i}=e;return Array.from(a.keys()).forEach((e=>{a.get(e)?r.push((0,d.createWid)(e)):t.push((0,d.createWid)(e))})),i?{skDistribList:t.concat(r),skList:[],rotateKey:i}:{skDistribList:t,skList:r,rotateKey:i}}))))return Promise.reject(new Error("getGroupSenderKeyList: not supported"))}else t=Promise.reject("getGroupSenderKeyList: not supported without model storage and md backend");return t},t.markHasSenderKey=function(e,t){var r;if(n.default.supportsFeature(n.default.F.MD_BACKEND)){var a=e.toString();if(!(r=(0,o.getStorage)().lock(["participant"],(([e])=>e.get(a).then((r=>{if(r)return e.createOrReplace(h(r,t,!0));__LOG__(2)`markHasSenderKey: group participant info missing for group ${a}`}))))))return Promise.reject(new Error("markHasSenderKey: not supported"))}else r=Promise.reject("markHasSenderKey: not supported without model storage and md backend");return r},t.markForgetSenderKey=function(e,t){var r;if(n.default.supportsFeature(n.default.F.MD_BACKEND)){var a=e.toString();if(!(r=(0,o.getStorage)().lock(["participant"],(([e])=>e.get(a).then((r=>{if(r)return e.createOrReplace(h(r,t,!1));__LOG__(2)`markForgetSenderKey: group participant info missing for group ${a}`}))))))return Promise.reject(new Error("markForgetSenderKey: not supported"))}else r=Promise.reject("markForgetSenderKey: not supported without model storage and md backend");return r},t.updateParticipants=function(e,t){var r;if(n.default.supportsFeature(n.default.F.MD_BACKEND)){var{participants:a,version:l,prevVersion:h}=t,f=e.toString();if(!(r=(0,o.getStorage)().lock(["participant"],function(){var e=(0,i.default)((function*([e]){var r=yield e.get(f);if(!r)throw new u(`updateParticipants: group participant info missing for group ${f}, action ${t.action}`);if(r.version&&(null==h||h!==r.version))throw new u(`updateParticipants: prevVersion info missing for group ${f}, action ${t.action}`);switch(t.action){case c.ADD:return e.createOrReplace(function(e,t,r,a){var i=new Map(e.senderKey);return r.forEach((e=>{if(!e.equals((0,s.assertGetMe)())){var t=String(e);i.set(t,!1)}})),{groupId:e.groupId,senderKey:i,participants:e.participants.concat(t.map(String)),admins:e.admins,rotateKey:e.rotateKey,version:a,deviceSyncComplete:e.deviceSyncComplete}}(r,a,t.deviceIds,l));case c.REMOVE:return e.createOrReplace(function(e,t,r){var a=new Map(e.senderKey);Array.from(a.keys()).forEach((e=>{var r=(0,d.createWid)(e).user;t.some((e=>e.user===r))?a.delete(e):a.set(e,!1)}));var i=t.map(String);return{groupId:e.groupId,senderKey:a,participants:e.participants.filter((e=>!i.includes(e))),admins:e.admins.filter((e=>!i.includes(e))),rotateKey:!0,version:r,deviceSyncComplete:e.deviceSyncComplete}}(r,a,l));case c.DEMOTE:return e.createOrReplace(p(r,a,l,c.DEMOTE));case c.PROMOTE:return e.createOrReplace(p(r,a,l,c.PROMOTE));default:throw new Error(`updateParticipants: failed with unknown action ${t.action}`)}}));return function(){return e.apply(this,arguments)}}())))return Promise.reject(new Error("addParticipantRecord: not supported"))}else r=Promise.reject(new Error("updateParticipants: not supported without model storage and md backend"));return r},t.replaceParticipants=function(e,t,r,a,i){var l;if(!n.default.supportsFeature(n.default.F.MD_BACKEND))return Promise.reject(new Error("replaceParticipants: not supported without model storage and md backend"));var d=e.toString();if(!(l=(0,o.getStorage)().lock(["participant"],(([e])=>e.get(d).then((n=>n?e.createOrReplace(function(e,t,r,a,i){var n=e.rotateKey,o=e.senderKey,l=new Map;a.forEach((e=>{if(!e.equals((0,s.assertGetMe)())){var t=String(e),r=o.get(t);null==r?l.set(t,!1):(l.set(t,r),o.delete(t))}})),0!==o.size&&(n=!0);return{groupId:e.groupId,senderKey:l,participants:t.map(String),admins:r.map(String),rotateKey:n,version:i,deviceSyncComplete:!0}}(n,t,r,a,i)):e.create(function(e,t,r,a,i){var n=new Map;return a.forEach((e=>{if(!e.equals((0,s.assertGetMe)())){var t=String(e);n.has(t)||n.set(t,!1)}})),{groupId:e,senderKey:n,participants:t.map(String),admins:r.map(String),rotateKey:!1,version:i,deviceSyncComplete:!0}}(d,t,r,a,i))))))))return Promise.reject(new Error("replaceParticipants: not supported"));return l},t.PARTICIPANT_OPERATION=t.GroupUnSyncedError=void 0;var i=a(r(52954)),n=a(r(20468)),s=r(66239),o=r(92166),l=r(7040),d=r(25054);class u extends Error{constructor(...e){super(...e),this.name="GroupUnSyncedError"}}t.GroupUnSyncedError=u;var c=Object.freeze({ADD:"add",REMOVE:"remove",DEMOTE:"demote",PROMOTE:"promote"});function p(e,t,r,a){var i=e.admins,n=t.map(String);return a===c.DEMOTE?i=e.admins.filter((e=>!n.includes(e))):a===c.PROMOTE&&(i=e.admins.concat(n)),{groupId:e.groupId,senderKey:e.senderKey,participants:e.participants,admins:i,rotateKey:e.rotateKey,version:r,deviceSyncComplete:e.deviceSyncComplete}}function h(e,t,r){var a=new Map(e.senderKey),i=!1;return t.forEach((e=>{if(!e.equals((0,s.assertGetMe)())){var t=String(e);a.has(t)?a.set(t,r):i=!0}})),{groupId:e.groupId,senderKey:a,participants:e.participants,admins:e.admins,rotateKey:i,deviceSyncComplete:e.deviceSyncComplete}}t.PARTICIPANT_OPERATION=c},12891:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.queryStatusAllMD=function(){var e=(0,u.createWid)(s.default.STATUS_WID);return o.default.waitForFinalDbMsgEncKey().then((()=>(0,d.queryChatMessageHelper)((0,d.beginningOfChat)(e),(0,d.endOfChat)(e),{lowerInclusive:!1,upperInclusive:!1}).then((e=>{var t=[],r=[];e.forEach((e=>{(0,n.happenedWithin)((0,n.castToUnixTime)(e.t),n.DAY_SECONDS)&&e.type!==s.default.MSG_TYPE.REVOKED?r.push((0,d.hydrateMessage)(e)):e.author?t.push(e.id):__LOG__(3)`Author is null for status v3 message`})),(0,l.getTable)().bulkRemove(t);var a=(0,i.default)(r,(e=>e.author.toString())),o=[];for(var c in a){var p=a[c],h=p.filter((e=>e.ack<s.default.ACK.READ)).length,f=p[p.length-1].t;o.push({id:(0,u.createWid)(c),unreadCount:h,totalCount:p.length,t:f,_msgs:p})}return{statuses:o}}))))};var i=a(r(3440)),n=r(95334),s=a(r(23045)),o=a(r(49508)),l=r(43730),d=r(44042),u=r(25054)},53049:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getTaskScheduledTime=function(e){return(0,i.getTable)().get(e).then((e=>null==e?void 0:e.time))},t.updateTaskScheduledTime=function(e,t){return(0,a.getStorage)().lock(["tasks-scheduled-time"],(([r])=>r.createOrReplace({taskName:e,time:t})))};var a=r(92166),i=r(29207)},96631:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.hydrateWids=function e(t){if(Array.isArray(t))return t.map(((t,r)=>e((0,i.default)(r,t,n.isWidlike,n.createWidFromWidLike))));if(t&&"object"==typeof t){for(var r=Object.keys(t),a=0;a<r.length;a++){var s=r[a];t[s]=e((0,i.default)(s,t[s],n.isWidlike,n.createWidFromWidLike))}return t}return t};var i=a(r(54884)),n=r(25054)},12409:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.hasBusinessNameVerificationChanged=function(e,t,r){var a=Promise.resolve(!1);a=i.default.supportsFeature(i.default.F.MD_BACKEND)?(0,n.getTable)().get(e.user).then((e=>!e||e.serial!==r||e.level!==t)):Promise.reject("hasBusinessNameVerificationChanged: not supported without md backend");return a},t.getAllVerifiedNames=function(){var e=Promise.resolve([]);e=i.default.supportsFeature(i.default.F.MD_BACKEND)?(0,n.getTable)().all():Promise.reject(new Error("getAllVerifiedNames: not supported without md backend"));return e},t.createOrUpdateVerifiedBusinessName=function(e,t,r,a,o,l,d){var u;if(i.default.supportsFeature(i.default.F.MD_BACKEND)){var c=(0,s.toUserWid)(t).user,p=e||(0,n.getTable)();if(!(u=p.createOrReplace({id:c,level:r,serial:a,name:o,isApi:l,privacyMode:d})))return Promise.reject(new Error("createOrUpdateVerifiedBusinessName: not supported for non MD"))}else u=Promise.reject("createOrUpdateVerifiedBusinessName: not supported without md backend");return u};var i=a(r(20468)),n=r(13433),s=r(25054)},38027:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0});var i={initialize:!0};t.initialize=function(){if(!n.default.supportsFeature(n.default.F.MD_BACKEND))return Promise.resolve();return(0,s.initializeWithoutGKs)()};var n=a(r(20468)),s=r(41856);Object.keys(s).forEach((function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(i,e)||Object.defineProperty(t,e,{enumerable:!0,get:function(){return s[e]}}))}))},41856:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.initializeWithoutGKs=function(){null==i&&((0,l.createStorage)(),(0,u.addTable)(),(0,c.addTable)(),(0,p.addTable)(),(0,h.addTable)(),(0,f.addTable)(),(0,_.addTable)(),(0,m.addTable)(),(0,g.addTable)(),(0,v.addTable)(),(0,E.addTable)(),(0,y.addTable)(),(0,S.addTable)(),(0,T.addTable)(),(0,A.addTable)(),(0,b.addTable)(),(0,C.addTable)(),(0,P.addTable)(),(0,O.addTable)(),(0,M.addTable)(),(0,I.addTable)(),(0,R.addTable)(),(0,D.addTable)(),(0,N.addTable)(),(0,L.addTable)(),(0,w.addTable)(),(0,o.addTable)(),(0,s.addTable)(),(0,d.addTable)(),i=(0,l.getStorage)().initialize().catch((e=>{throw __LOG__(4,!0,new Error,!0)`Assertion failed!`,SEND_LOGS("Failed to initialize model storage"),e})));return i},t.destroy=function(){return(0,l.destroyStorage)().catch((()=>k.resolve(new n.default(l.DATABASE_NAME).delete()))).finally((()=>{i=null}))},t.clearInitializePromise=function(){i=null},Object.defineProperty(t,"getCollectionVersionTable",{enumerable:!0,get:function(){return s.getTable}}),Object.defineProperty(t,"getPendingMutationsTable",{enumerable:!0,get:function(){return o.getTable}}),Object.defineProperty(t,"getSyncActionsTable",{enumerable:!0,get:function(){return d.getTable}}),Object.defineProperty(t,"getABPropConfigsTable",{enumerable:!0,get:function(){return u.getTable}}),Object.defineProperty(t,"getTasksScheduledTimeTable",{enumerable:!0,get:function(){return c.getTable}}),Object.defineProperty(t,"getContactTable",{enumerable:!0,get:function(){return p.getTable}}),Object.defineProperty(t,"getBlocklistTable",{enumerable:!0,get:function(){return h.getTable}}),Object.defineProperty(t,"getProfilePicThumbTable",{enumerable:!0,get:function(){return f.getTable}}),Object.defineProperty(t,"getChatTable",{enumerable:!0,get:function(){return _.getTable}}),Object.defineProperty(t,"getMessageTable",{enumerable:!0,get:function(){return m.getTable}}),Object.defineProperty(t,"getMsgInfoTable",{enumerable:!0,get:function(){return g.getTable}}),Object.defineProperty(t,"getParticipantTable",{enumerable:!0,get:function(){return v.getTable}}),Object.defineProperty(t,"getOrphanReceiptTable",{enumerable:!0,get:function(){return E.getTable}}),Object.defineProperty(t,"getDeviceListTable",{enumerable:!0,get:function(){return y.getTable}}),Object.defineProperty(t,"getLabelTable",{enumerable:!0,get:function(){return S.getTable}}),Object.defineProperty(t,"getLabelAssociationTable",{enumerable:!0,get:function(){return T.getTable}}),Object.defineProperty(t,"getInactiveReceiptTable",{enumerable:!0,get:function(){return A.getTable}}),Object.defineProperty(t,"getVerifiedBusinessNameTable",{enumerable:!0,get:function(){return b.getTable}}),Object.defineProperty(t,"getHistorySyncNotificationTable",{enumerable:!0,get:function(){return C.getTable}}),Object.defineProperty(t,"getEncryptedMutationsTable",{enumerable:!0,get:function(){return P.getTable}}),Object.defineProperty(t,"getQuickReplyTable",{enumerable:!0,get:function(){return O.getTable}}),Object.defineProperty(t,"getRecentStickersTable",{enumerable:!0,get:function(){return w.getTable}}),Object.defineProperty(t,"getGroupMetadataTable",{enumerable:!0,get:function(){return M.getTable}}),Object.defineProperty(t,"getSyncKeysTable",{enumerable:!0,get:function(){return I.getTable}}),Object.defineProperty(t,"getActiveMessageRangesTable",{enumerable:!0,get:function(){return R.getTable}}),Object.defineProperty(t,"getFtsIndexingQueueTable",{enumerable:!0,get:function(){return D.getTable}}),Object.defineProperty(t,"getCartTable",{enumerable:!0,get:function(){return N.getTable}}),Object.defineProperty(t,"getMissingKeysTable",{enumerable:!0,get:function(){return L.getTable}});var i,n=a(r(77715)),s=r(44941),o=r(31948),l=r(92166),d=r(81899),u=r(45155),c=r(29207),p=r(79525),h=r(5710),f=r(27182),_=r(23443),m=r(43730),g=r(86653),v=r(7040),E=r(78889),y=r(6011),S=r(90813),T=r(81249),A=r(86679),b=r(13433),C=r(48516),P=r(40418),O=r(98606),w=r(65931),M=r(20226),I=r(1027),R=r(49125),D=r(99387),N=r(65473),L=r(67033),k=r(97733).Z},45155:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.addTable=function(){(0,n.getStorage)().add("abpropConfigs").version((0,o.abpropsConfigCreateTable)(),[new s.default("configCode"),new i.default("configValue"),new i.default("configExpoKey")]).view((e=>({configCode:e.configCode,configValue:e.configValue,configExpoKey:e.configExpoKey})))},t.getTable=function(){return(0,n.getStorage)().table("abpropConfigs")};var i=a(r(49052)),n=r(92166),s=a(r(44221)),o=r(26141)},49125:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.addTable=function(){(0,o.getStorage)().add("active-message-ranges").version((0,l.activeMessageRangesCreateTable)(),[new s.default(["chatId","action"]),new n.default("chatId"),new i.default("actionValue"),new i.default("remainingMessages")]).view((e=>e))},t.getTable=function(){return(0,o.getStorage)().table("active-message-ranges")};var i=a(r(49052)),n=a(r(81824)),s=a(r(92554)),o=r(92166),l=r(26141)},5710:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.addTable=function(){(0,i.getStorage)().add("blocklist").version((0,s.blocklistCreateTable)(),[new n.default("id")]).view((e=>({id:e.id})))},t.getTable=function(){return(0,i.getStorage)().table("blocklist")};var i=r(92166),n=a(r(44221)),s=r(26141)},65473:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.addTable=function(){(0,n.getStorage)().add("cart").version((0,o.cartCreateTable)(),[new s.default("id"),new i.default("products"),new i.default("message"),new i.default("total"),new i.default("currency"),new i.default("itemCount")]).view((e=>e))},t.getTable=function(){return(0,n.getStorage)().table("cart")};var i=a(r(49052)),n=r(92166),s=a(r(44221)),o=r(26141)},23443:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.addTable=function(){(0,n.getStorage)().add("chat").version((0,o.chatCreateTable)(),[new s.default("id"),new i.default("t"),new i.default("unreadCount"),new i.default("archive"),new i.default("isReadOnly"),new i.default("isAnnounceGrpRestrict"),new i.default("modifyTag"),new i.default("muteExpiration"),new i.default("name"),new i.default("notSpam"),new i.default("pin"),new i.default("changeNumberOldJid"),new i.default("changeNumberNewJid"),new i.default("ephemeralDuration"),new i.default("ephemeralSettingTimestamp"),new i.default("unreadMsgAnchorId"),new i.default("endOfHistoryTransferType")]).view((e=>({id:e.id,t:e.t,unreadCount:e.unreadCount,unreadMsgAnchorId:e.unreadMsgAnchorId,archive:e.archive,isReadOnly:e.isReadOnly,isAnnounceGrpRestrict:e.isAnnounceGrpRestrict,modifyTag:e.modifyTag,muteExpiration:e.muteExpiration,name:e.name,notSpam:e.notSpam,pin:e.pin,changeNumberOldJid:e.changeNumberOldJid,changeNumberNewJid:e.changeNumberNewJid,endOfHistoryTransfer:e.endOfHistoryTransfer,endOfHistoryTransferType:e.endOfHistoryTransferType,ephemeralDuration:e.ephemeralDuration,ephemeralSettingTimestamp:e.ephemeralSettingTimestamp})))},t.getTable=function(){return(0,n.getStorage)().table("chat")};var i=a(r(49052)),n=r(92166),s=a(r(44221)),o=r(26141)},44941:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.addTable=function(){(0,n.getStorage)().add("collection-version").version((0,o.collectionVersionCreateTable)(),[new s.default("collection"),new i.default("version"),new i.default("state"),new i.default("finiteFailureStartTime"),new i.default("ltHash")]).view((e=>e))},t.getTable=function(){return(0,n.getStorage)().table("collection-version")};var i=a(r(49052)),n=r(92166),s=a(r(44221)),o=r(26141)},79525:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.addTable=function(){(0,s.getStorage)().add("contact").version((0,l.contactCreateTable)(),[new o.default("id"),new i.default("name"),new i.default("shortName"),new i.default("pushname"),new i.default("type"),new i.default("verifiedName"),new i.default("isBusiness"),new i.default("isEnterprise"),new i.default("verifiedLevel"),new i.default("statusMute"),new i.default("sectionHeader"),new i.default("isAddressBookContact"),new n.default("isAddressBookContact")]).version((0,l.contactAddIsContactSyncCompleted)(),[new i.default("isContactSyncCompleted"),new n.default("isContactSyncCompleted")]).view((e=>e))},t.getTable=function(){return(0,s.getStorage)().table("contact")};var i=a(r(49052)),n=a(r(81824)),s=r(92166),o=a(r(44221)),l=r(26141)},6011:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.addTable=function(){(0,n.getStorage)().add("device-list").version((0,o.deviceListCreateTable)(),[new s.default("id"),new i.default("devices"),new i.default("nextVersion"),new i.default("rawId"),new i.default("timestamp"),new i.default("validIndexes"),new i.default("currentIndex")]).view((e=>e))},t.getTable=function(){return(0,n.getStorage)().table("device-list")};var i=a(r(49052)),n=r(92166),s=a(r(44221)),o=r(26141)},40418:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.addTable=function(){(0,s.getStorage)().add("encrypted-mutations").version((0,o.encryptedMutationsCreateTable)(),[new n.default("id"),new i.default("collectionName"),new i.default("keyId"),new i.default("indexMac"),new i.default("operation"),new i.default("indexAndValueCipherText")]).view((e=>e))},t.getTable=function(){return(0,s.getStorage)().table("encrypted-mutations")};var i=a(r(49052)),n=a(r(23026)),s=r(92166),o=r(26141)},99387:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.addTable=function(){(0,i.getStorage)().add("fts-indexing-queue").version((0,s.ftsIndexingQueueCreateTable)(),[new n.default("id")]).view((e=>e))},t.getTable=function(){return(0,i.getStorage)().table("fts-indexing-queue")};var i=r(92166),n=a(r(44221)),s=r(26141)},20226:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.addTable=function(){(0,n.getStorage)().add("group-metadata").version((0,o.groupMetadataCreateTable)(),[new s.default("id"),new i.default("subject"),new i.default("subjectTime"),new i.default("creation"),new i.default("owner"),new i.default("desc"),new i.default("descId"),new i.default("descTime"),new i.default("descOwner"),new i.default("restrict"),new i.default("announce"),new i.default("a_v_id"),new i.default("noFrequentlyForwarded"),new i.default("ephemeralDuration"),new i.default("size"),new i.default("support")]).view((e=>e))},t.getTable=function(){return(0,n.getStorage)().table("group-metadata")};var i=a(r(49052)),n=r(92166),s=a(r(44221)),o=r(26141)},48516:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.addTable=function(){(0,l.getStorage)().add("history-sync-notification").version((0,u.historySyncNotificationsCreateTable)(),[new d.default("msgKey"),new n.default("downloadOptions"),new n.default("syncType"),new s.default("chunkEncryptionKey",s.ENCRYPTED_VALUE_TYPE.STRING),new n.default("chunkOrder"),new n.default("processed"),new o.default("syncType"),new o.default("chunkOrder"),new o.default("processed"),new n.default("isReupload"),new n.default("historySyncStepStartedTs"),new n.default("historySyncPayloadSize"),new n.default("reuploadPending")]).view((e=>e)).useDbMsgEncKeyForEncryptedCol(!0)},t.getTable=function(){return(0,l.getStorage)().table("history-sync-notification")};var n=i(r(49052)),s=a(r(97594)),o=i(r(81824)),l=r(92166),d=i(r(44221)),u=r(26141)},86679:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.addTable=function(){(0,n.getStorage)().add("inactive-receipt").version((0,o.inactiveReceiptCreateTable)(),[new s.default("msgId"),new i.default("chatId"),new i.default("participantId")]).view((e=>e))},t.getTable=function(){return(0,n.getStorage)().table("inactive-receipt")};var i=a(r(49052)),n=r(92166),s=a(r(44221)),o=r(26141)},81249:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.addTable=function(){(0,o.getStorage)().add("label-association").version((0,l.labelAssociationCreateTable)(),[new s.default(["labelId","associationId","type"]),new n.default("labelId"),new i.default(["associationId","type"])]).view((e=>e))},t.getTable=function(){return(0,o.getStorage)().table("label-association")},t.LabelAssociationType=void 0;var i=a(r(9818)),n=a(r(81824)),s=a(r(92554)),o=r(92166),l=r(26141),d=r(28103)({Jid:"jid",Message:"message"});t.LabelAssociationType=d},90813:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.addTable=function(){(0,n.getStorage)().add("label").version((0,o.labelCreateTable)(),[new s.default("id"),new i.default("name"),new i.default("colorIndex"),new i.default("predefinedId")]).view((e=>e))},t.getTable=function(){return(0,n.getStorage)().table("label")};var i=a(r(49052)),n=r(92166),s=a(r(44221)),o=r(26141)},86653:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.addTable=function(){(0,o.getStorage)().add("message-info").version((0,l.messageInfoCreateTable)(),[new s.default(["msgKey","receiverUserJid"]),new i.default("delivery"),new i.default("read"),new i.default("played"),new i.default("deviceDelivered"),new i.default("deviceNotDelivered"),new n.default("msgKey")]).view((e=>e))},t.getTable=function(){return(0,o.getStorage)().table("message-info")};var i=a(r(49052)),n=a(r(81824)),s=a(r(92554)),o=r(92166),l=r(26141)},43730:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.addTable=function(){(0,c.getStorage)().add("message").version((0,h.messageCreateTable)(),[new p.default("id"),new s.default("internalId"),new u.default("internalId"),new s.default("rowId"),new u.default("rowId"),new s.default("type"),new s.default("subtype"),new s.default("t"),new s.default("notifyName"),new s.default("from"),new s.default("to"),new s.default("author"),new s.default("self"),new s.default("ack"),new s.default("invis"),new s.default("isStarred"),new d.default("isStarred"),new s.default("mentionedJidList"),new s.default("count"),new s.default("devicesAdded"),new s.default("devicesRemoved"),new s.default("isThisDeviceAdded"),new s.default("recipients"),new s.default("protocolMessageKey"),new s.default("templateParams"),new o.default(["internalId","isStarred"]),new s.default("vcardWAids"),new n.default("vcardWAids"),new s.default("hasLink"),new s.default("isMediaMsg"),new s.default("isDocMsg"),new o.default(["internalId","isMediaMsg"]),new o.default(["internalId","isDocMsg"]),new o.default(["internalId","hasLink"]),new s.default("ephemeralStartTimestamp"),new s.default("ephemeralDuration"),new s.default("ephemeralSettingTimestamp"),new s.default("ephemeralOutOfSync"),new s.default("expiredTimestamp"),new d.default("expiredTimestamp"),new s.default("directPath"),new s.default("mimetype"),new s.default("duration"),new s.default("filehash"),new s.default("uploadhash"),new s.default("size"),new s.default("filename"),new s.default("streamingSidecar"),new s.default("mediaKey"),new s.default("mediaKeyTimestamp"),new s.default("pageCount"),new s.default("isGif"),new s.default("gifAttribution"),new s.default("isViewOnce"),new s.default("width"),new s.default("height"),new s.default("scanLengths"),new s.default("scansSidecar"),new s.default("interactiveAnnotations"),new s.default("firstFrameLength"),new s.default("firstFrameSidecar"),new s.default("isAnimated"),new s.default("thumbnail"),new s.default("richPreviewType"),new s.default("doNotPlayInline"),new s.default("broadcast"),new s.default("broadcastParticipants"),new s.default("broadcastId"),new s.default("quotedMsg"),new s.default("quotedStanzaID"),new s.default("quotedRemoteJid"),new s.default("quotedParticipant"),new s.default("footer"),new s.default("hydratedButtons"),new s.default("selectedId"),new s.default("selectedIndex"),new s.default("vcardFormattedName"),new s.default("isVcardOverMmsDocument"),new s.default("businessOwnerJid"),new s.default("productId"),new s.default("currencyCode"),new s.default("priceAmount1000"),new s.default("retailerId"),new s.default("url"),new s.default("productImageCount"),new s.default("paymentCurrency"),new s.default("paymentMessageReceiverJid"),new s.default("paymentTransactionTimestamp"),new s.default("paymentStatus"),new s.default("paymentNoteMsg"),new s.default("paymentRequestMessageKey"),new s.default("paymentExpiryTimestamp"),new s.default("message"),new s.default("orderTitle"),new s.default("itemCount"),new s.default("orderId"),new s.default("surface"),new s.default("status"),new s.default("token"),new s.default("textColor"),new s.default("backgroundColor"),new s.default("font"),new s.default("isForwarded"),new s.default("forwardingScore"),new s.default("ctwaContext"),new s.default("mdDowngrade"),new s.default("messageRangeIndex"),new d.default("messageRangeIndex"),new s.default("vcardList"),new s.default("totalAmount1000"),new s.default("totalCurrencyCode"),new s.default("list"),new s.default("listResponse"),new s.default("isDynamicReplyButtonsMsg"),new s.default("dynamicReplyButtons"),new s.default("selectedButtonId"),new s.default("sellerJid"),new s.default("deprecatedMms3Url"),new s.default("encFilehash"),new l.default("msgRowOpaqueData",l.ENCRYPTED_VALUE_TYPE.ARRAY_BUFFER),new s.default("thumbnailDirectPath"),new s.default("thumbnailSha256"),new s.default("thumbnailEncSha256"),new s.default("thumbnailHeight"),new s.default("thumbnailWidth"),new s.default("pendingReadReceipt"),new o.default(["from","pendingReadReceipt"])]).version((0,h.messageAddIsSendFailureProperties)(),[new s.default("isSendFailure")]).version((0,h.messageAddPaymentTxnStatus)(),[new s.default("paymentTxnStatus")]).version((0,h.messageAddProductListPreviewInfo)(),[new s.default("productListItemCount")]).view((e=>e)).enablePropFilter(!0).useDbMsgEncKeyForEncryptedCol(!0)},t.getTable=function(){return(0,c.getStorage)().table("message")};var n=i(r(54423)),s=i(r(49052)),o=i(r(9818)),l=a(r(97594)),d=i(r(81824)),u=i(r(34450)),c=r(92166),p=i(r(44221)),h=r(26141)},67033:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.addTable=function(){(0,n.getStorage)().add("missing-keys").version((0,o.missingKeysCreateTable)(),[new s.default("keyHex"),new i.default("keyId"),new i.default("timestamp"),new i.default("deviceResponses")]).view((e=>e))},t.getTable=function(){return(0,n.getStorage)().table("missing-keys")};var i=a(r(49052)),n=r(92166),s=a(r(44221)),o=r(26141)},78889:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.addTable=function(){(0,n.getStorage)().add("orphan-receipt").version((0,o.orphanReceiptCreateTable)(),[new s.default("msgKey"),new i.default("delivery"),new i.default("read"),new i.default("played")]).view((e=>e))},t.getTable=function(){return(0,n.getStorage)().table("orphan-receipt")};var i=a(r(49052)),n=r(92166),s=a(r(44221)),o=r(26141)},7040:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.addTable=function(){(0,s.getStorage)().add("participant").version((0,l.participantCreateTable)(),[new o.default("groupId"),new n.default("senderKey"),new n.default("participants"),new n.default("admins"),new n.default("rotateKey"),new n.default("version"),new i.default("participants"),new n.default("deviceSyncComplete")]).view((e=>e))},t.getTable=function(){return(0,s.getStorage)().table("participant")};var i=a(r(54423)),n=a(r(49052)),s=r(92166),o=a(r(44221)),l=r(26141)},31948:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.addTable=function(){(0,o.getStorage)().add("pending-mutations").version((0,l.pendingMutationsCreateTable)(),[new s.default("id"),new i.default("collection"),new i.default("index"),new n.default("index"),new i.default("timestamp"),new n.default("collection"),new i.default("version"),new i.default("operation"),new i.default("binarySyncAction")]).view((e=>e))},t.getTable=function(){return(0,o.getStorage)().table("pending-mutations")};var i=a(r(49052)),n=a(r(81824)),s=a(r(23026)),o=r(92166),l=r(26141)},27182:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.addTable=function(){(0,n.getStorage)().add("profile-pic-thumb").version((0,o.profilePicThumbCreateTable)(),[new s.default("id"),new i.default("tag"),new i.default("raw"),new i.default("eurl"),new i.default("previewEurl")]).view((e=>({id:e.id,tag:e.tag,raw:e.raw,eurl:e.eurl,previewEurl:e.previewEurl})))},t.getTable=function(){return(0,n.getStorage)().table("profile-pic-thumb")};var i=a(r(49052)),n=r(92166),s=a(r(44221)),o=r(26141)},98606:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.addTable=function(){(0,n.getStorage)().add("quick-reply").version((0,o.quickReplyCreateTable)(),[new s.default("id"),new i.default("shortcut"),new i.default("message"),new i.default("count"),new i.default("keywords")]).view((e=>e))},t.getTable=function(){return(0,n.getStorage)().table("quick-reply")};var i=a(r(49052)),n=r(92166),s=a(r(44221)),o=r(26141)},65931:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.addTable=function(){(0,n.getStorage)().add("recent-stickers").version((0,o.recentStickersCreateTable)(),[new s.default("id"),new i.default("timestamp"),new i.default("sticker")]).view((e=>e))},t.getTable=function(){return(0,n.getStorage)().table("recent-stickers")};var i=a(r(49052)),n=r(92166),s=a(r(44221)),o=r(26141)},81899:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.addTable=function(){(0,o.getStorage)().add("sync-actions").version((0,d.syncActionsCreateTable)(),[new l.default("index"),new i.default("keyId"),new i.default("version"),new i.default("actionState"),new s.default("actionState"),new i.default("modelId"),new i.default("modelType"),new n.default(["modelId","modelType","actionState"]),new i.default("valueMac"),new i.default("indexMac"),new s.default("indexMac"),new i.default("collection"),new s.default("collection"),new i.default("timestamp"),new i.default("action"),new s.default("action"),new i.default("binarySyncAction")]).view((e=>e))},t.getTable=function(){return(0,o.getStorage)().table("sync-actions")};var i=a(r(49052)),n=a(r(9818)),s=a(r(81824)),o=(r(17845),r(92166)),l=a(r(44221)),d=r(26141)},1027:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.addTable=function(){(0,l.getStorage)().add("sync-keys").version((0,u.syncKeysCreateTable)(),[new d.default("keyId"),new n.default("timestamp"),new n.default("fingerprint"),new s.default("keyData",s.ENCRYPTED_VALUE_TYPE.ARRAY_BUFFER),new n.default("keyEpoch"),new o.default("keyEpoch")]).view((e=>e))},t.getTable=function(){return(0,l.getStorage)().table("sync-keys")};var n=i(r(49052)),s=a(r(97594)),o=i(r(81824)),l=r(92166),d=i(r(44221)),u=r(26141)},29207:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.addTable=function(){(0,n.getStorage)().add("tasks-scheduled-time").version((0,o.tasksScheduledTimeCreateTable)(),[new s.default("taskName"),new i.default("time")]).view((e=>e))},t.getTable=function(){return(0,n.getStorage)().table("tasks-scheduled-time")};var i=a(r(49052)),n=r(92166),s=a(r(44221)),o=r(26141)},13433:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.addTable=function(){(0,s.getStorage)().add("verified-business-name").version((0,l.verifiedBusinessNameCreateTable)(),[new o.default("id"),new i.default("serial"),new i.default("name"),new i.default("isApi"),new i.default("level"),new i.default("actualActors"),new i.default("hostStorage"),new i.default("privacyModeTs")]).version((0,l.verifiedBusinessNameAddPrivacyMode)(),[new i.default("privacyMode"),new n.default("actualActors"),new n.default("hostStorage"),new n.default("privacyModeTs")]).view((e=>e))},t.getTable=function(){return(0,s.getStorage)().table("verified-business-name")};var i=a(r(49052)),n=a(r(91757)),s=r(92166),o=a(r(44221)),l=r(26141)},92166:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.createStorage=function(){var e=new s.default(d);(u=new o.default(e)).addErrorHandler(i.default.AbortError,(e=>{e.message.includes("QuotaExceededError")&&l.default.trigger("storage_not_enough_space")}))},t.getStorage=function(){return(0,n.default)(null!=u,"[model-storage] Storage should be created first before being accessed"),u},t.destroyStorage=function(){if(null==u)return Promise.reject(new Error("[model-storage] Storage should be created first before being destroyed"));return u.purge().then((()=>{u=null})).catch((e=>{throw u=null,e}))},t.DATABASE_NAME=void 0;var i=a(r(77715)),n=a(r(47677)),s=a(r(36479)),o=a(r(49195)),l=a(r(37018)),d="model-storage";t.DATABASE_NAME=d;var u=null},71715:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.restoreGroupsContactsAndProfilePics=function(){__LOG__(2)`[InitFromStorage] will attempt to initialize from storage`,h.default.trigger("me_ready");var e=(0,_.getPushname)(),t=(0,_.getLastMobilePlatform)();if(null==t)return Promise.reject(new Error("platform not found in UserPrefs."));return h.default.pushname=e,h.default.platform=t,__LOG__(2)`[InitFromStorage] important metadata loaded`,(0,m.initializeWithoutGKs)().then((()=>{var e=Promise.resolve(),t=Promise.resolve();e=(0,x.getTable)().all().then((e=>{R.default.checksum=(0,O.getContactChecksum)()||"",R.default.add(e.map(b.hydrateWids),{silent:!0})})),t=(0,G.getTable)().all().then((e=>{N.default.add(e.map(b.hydrateWids),{silent:!0}),e.forEach((e=>(0,M.updateSubject)((0,P.createWidFromWidLike)(e.id),e.subject)))}));var r=(0,y.getTable)().all().then((e=>{S.default.add(e.map(b.hydrateWids),{silent:!0})}));return Promise.all([e,t,r])})).then((()=>{}))},t.restoreBlocklist=function(){return(0,l.getTable)().all().then((e=>{d.default.initializeFromCache(e.map(b.hydrateWids))}))},t.restoreChatsAndMessages=function(){return Q.apply(this,arguments)},t.restoreLabels=function(){if((0,L.canDisplayLabel)())return(0,B.getTable)().all().then((e=>{k.default.initializeFromCache(e)}));return Promise.resolve()},t.restoreLabelAssociations=function(){if((0,L.canDisplayLabel)())return(0,Y.getTable)().all().then((e=>{k.default.initializeAssociationsFromCache(e)}));return Promise.resolve()},t.restoreQuickReplies=function(){if((0,L.canSendQuickReply)())return(0,K.getTable)().all().then((e=>{U.default.initializeFromCache(e)}));return Promise.resolve()},t.restoreRecentStickers=function(){if(H.default.supportsFeature(H.default.F.MD_BACKEND)&&w.default.webServerStickerPanel)return(0,j.getTable)().all().then((e=>D.default.initializeFromCache(e)));return Promise.resolve()},t.restoreCarts=function(){if((0,L.cartPropEnabled)())return(0,F.getTable)().all().then((e=>{I.default.initializeFromCache(e.map(b.hydrateWids))}));return Promise.resolve()};var i=a(r(52954)),n=a(r(70417)),s=r(19129),o=r(95334),l=r(5710),d=a(r(88025)),u=r(23443),c=a(r(85030)),p=a(r(13649)),h=a(r(79435)),f=a(r(23045)),_=r(66239),m=r(41856),g=r(43730),v=a(r(30528)),E=a(r(83746)),y=r(27182),S=a(r(93562));r(18165);var T=r(44042),A=r(82714),b=r(96631),C=r(13433),P=r(25054),O=r(13185),w=a(r(54559)),M=r(12390),I=a(r(59544)),R=a(r(43805)),D=a(r(11506)),N=a(r(25120)),L=r(9690),k=a(r(62345)),U=a(r(84553)),G=r(20226),F=r(65473),x=r(79525),B=r(90813),Y=r(81249),K=r(98606),j=r(65931),W=a(r(49508)),H=a(r(20468));function V(e){return null!=e.t&&(0,o.happenedWithin)((0,o.castToUnixTime)(e.t),o.DAY_SECONDS)||null!=e.pin&&e.pin>0}function $(e){var{tasks:t,lastMessageKeys:r}=function(e){var t=[],r=[];return e.forEach((({chat:e,previewMsg:a,lastReceivedKey:i})=>{V(e)?t.push(function(e,t){return V(e)?e.unreadCount>=20?q(e,t).then((()=>function(e){if(!e.unreadMsgAnchorId)return __LOG__(3)`unreadMsgAnchorId is not defined`,Promise.resolve();return(0,g.getTable)().equals(["id"],e.unreadMsgAnchorId).then((t=>{if(0!==t.length){var r=(0,T.getInChatMsgId)(t[0].internalId||""),a=Math.max(0,r-5);return(0,T.queryChatMessageHelper)((0,T.craftInternalId)(e.id,a),(0,T.craftInternalId)(e.id,r+5),{lowerInclusive:!0,upperInclusive:!1}).then((t=>{if(!(t.length-5<0)){var r=t[t.length-5].id,a=t.map((e=>{var t=(0,T.hydrateMessage)(e);return t.invis=!0,t}));return v.default.processMultipleMessages((0,P.createWidFromWidLike)(e.id),a,{pendingMsgsDone:!0,resume:!1,add:"unread",isHistory:!0,firstUnreadKey:E.default.fromString(r)},new p.default)}})).then()}__LOG__(3)`Unread anchor message does not exist in message table`}))}(e))):0===e.unreadCount?q(e,t):(__LOG__(2)`restoreMessagesForChat: restoring last ${e.unreadCount+5} messages.`,(0,T.queryChatMessageHelper)(`${e.id}_/`,`${e.id}_g`,{reverse:!0,limit:e.unreadCount+5}).then((t=>v.default.processMultipleMessages((0,P.createWidFromWidLike)(e.id),t.map(T.hydrateMessage).reverse(),{pendingMsgsDone:!0,resume:!1,add:"last",isHistory:!0}))).then()):q(e)}(e,a).then((()=>{if(e.unreadMsgAnchorId){var t=E.default.fromString(e.unreadMsgAnchorId),r=v.default.get(t);if(!r)return void __LOG__(3)`Unread anchor message is not in message collection.`;var a=c.default.get((0,P.createWidFromWidLike)(e.id));a&&(a.unreadMsgAnchor=r)}}))):r.push(String(i))})),{tasks:t,lastMessageKeys:r}}(e);return t.push(function(e){return(0,g.getTable)().bulkGet(e).then(function(){var e=(0,i.default)((function*(e){yield Promise.all(e.map((e=>{if(!e)return Promise.resolve();var t=(0,T.hydrateMessage)(e);return t.invis=!0,v.default.processMultipleMessages(t.from,[t],{pendingMsgsDone:!1,resume:!1,add:"last",isHistory:!0})})))}));return function(){return e.apply(this,arguments)}}()).catch((e=>{throw __LOG__(4,void 0,new Error)`loadLastMessagesFromDB: failed with error: ${e}`,e}))}(r)),Promise.all(t)}function q(){return z.apply(this,arguments)}function z(){return(z=(0,i.default)((function*(e,t){var r;r=t&&t.internalId?yield(0,T.queryChatMessageHelper)(t.internalId,`${e.id}_g`,{lowerInclusive:!0}):yield(0,T.queryChatMessageHelper)(`${e.id}_/`,`${e.id}_g`,{reverse:!0,limit:1}),__LOG__(2)`processPreviewMessageInChat: restoring ${r.length} message.`,v.default.processMultipleMessages((0,P.createWidFromWidLike)(e.id),r.map((e=>{var t=(0,T.hydrateMessage)(e);return t.invis=!0,t})),{pendingMsgsDone:!1,resume:!1,add:"last",isHistory:!0})}))).apply(this,arguments)}function J(e){switch(e){case"unknown":return f.default.VERIFIED_LEVEL.UNKNOWN;case"low":return f.default.VERIFIED_LEVEL.LOW;case"high":return f.default.VERIFIED_LEVEL.HIGH;default:return f.default.VERIFIED_LEVEL.UNKNOWN}}function Q(){return(Q=(0,i.default)((function*(){return yield W.default.waitForFinalDbMsgEncKey(),(0,m.initializeWithoutGKs)().then(A.updateUnreadCount).then((0,i.default)((function*(){var e=yield(0,u.getTable)().all();e.sort(((e,t)=>{var r,a;return-((null!==(r=e.t)&&void 0!==r?r:0)-(null!==(a=t.t)&&void 0!==a?a:0))})),c.default.add(e.map((e=>(0,b.hydrateWids)((0,n.default)({},e)))),{silent:!0,merge:!0});var[t]=yield X(e,100);return t}))).then(Z).catch((e=>{throw __LOG__(4,void 0,new Error)`restoreChatsAndMessages: failed with error: ${e}`,e}))}))).apply(this,arguments)}function X(e,t){if(0===e.length)return[Promise.resolve()];for(var r=[],a=new s.PromiseQueue,o=function(s){var o=e.slice(s,s+t),l=a.enqueue((0,i.default)((function*(){var e=yield function(e){return Promise.all(e.map((e=>{var t=V(e);return(0,T.getKeyMsgsFromChatHistory)(e,t).then((({anchor:r,previewMsg:a,lastReceivedKey:i})=>({chat:(0,n.default)((0,n.default)({},e),{},{unreadMsgAnchorId:t?r:void 0}),anchor:r,previewMsg:a,lastReceivedKey:i})))}))).then((e=>{var t=e.map((({chat:e,anchor:t,previewMsg:r})=>e));return(0,u.getTable)().bulkCreateOrMerge(t).then((()=>e.map((({chat:e,anchor:t,previewMsg:r,lastReceivedKey:a})=>({chat:e,previewMsg:r,lastReceivedKey:a})))))}))}(o);yield $(e),e.forEach((({chat:e})=>{var t=c.default.get(e.id);t&&t.set({pendingInitialLoading:!1})}))})));r.push(l)},l=0;l<e.length;l+=t)o(l);return r}function Z(){return ee.apply(this,arguments)}function ee(){return(ee=(0,i.default)((function*(){(yield(0,C.getTable)().all()).forEach((e=>{var t;try{t=(0,P.createUserWid)(e.id)}catch(e){return __LOG__(4,void 0,new Error,!0)`restore-business-info: invalid wid`,void SEND_LOGS("restore-business-info: invalid wid")}var r=c.default.get(t);if(r){var a={isBusiness:!0,isEnterprise:e.isApi,verifiedName:e.name,verifiedLevel:J(e.level||"unknown"),privacyMode:e.privacyMode};r.contact.set(a),"high"===e.level&&e.name&&!r.contact.name&&r.contact.set({name:e.name})}}))}))).apply(this,arguments)}},26141:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.pendingMutationsCreateTable=function(){return(0,a.getStorage)().versions.version(0)},t.collectionVersionCreateTable=function(){return(0,a.getStorage)().versions.version(1)},t.syncActionsCreateTable=function(){return(0,a.getStorage)().versions.version(2)},t.contactCreateTable=function(){return(0,a.getStorage)().versions.version(3)},t.blocklistCreateTable=function(){return(0,a.getStorage)().versions.version(4)},t.profilePicThumbCreateTable=function(){return(0,a.getStorage)().versions.version(5)},t.chatCreateTable=function(){return(0,a.getStorage)().versions.version(6)},t.messageCreateTable=function(){return(0,a.getStorage)().versions.version(7)},t.messageInfoCreateTable=function(){return(0,a.getStorage)().versions.version(8)},t.participantCreateTable=function(){return(0,a.getStorage)().versions.version(9)},t.orphanReceiptCreateTable=function(){return(0,a.getStorage)().versions.version(10)},t.deviceListCreateTable=function(){return(0,a.getStorage)().versions.version(11)},t.inactiveReceiptCreateTable=function(){return(0,a.getStorage)().versions.version(12)},t.verifiedBusinessNameCreateTable=function(){return(0,a.getStorage)().versions.version(13)},t.historySyncNotificationsCreateTable=function(){return(0,a.getStorage)().versions.version(14)},t.encryptedMutationsCreateTable=function(){return(0,a.getStorage)().versions.version(15)},t.labelCreateTable=function(){return(0,a.getStorage)().versions.version(16)},t.labelAssociationCreateTable=function(){return(0,a.getStorage)().versions.version(17)},t.quickReplyCreateTable=function(){return(0,a.getStorage)().versions.version(18)},t.abpropsConfigCreateTable=function(){return(0,a.getStorage)().versions.version(19)},t.groupMetadataCreateTable=function(){return(0,a.getStorage)().versions.version(20)},t.syncKeysCreateTable=function(){return(0,a.getStorage)().versions.version(21)},t.tasksScheduledTimeCreateTable=function(){return(0,a.getStorage)().versions.version(22)},t.activeMessageRangesCreateTable=function(){return(0,a.getStorage)().versions.version(23)},t.ftsIndexingQueueCreateTable=function(){return(0,a.getStorage)().versions.version(24)},t.cartCreateTable=function(){return(0,a.getStorage)().versions.version(25)},t.missingKeysCreateTable=function(){return(0,a.getStorage)().versions.version(26)},t.messageAddIsSendFailureProperties=function(){return(0,a.getStorage)().versions.version(27)},t.contactAddIsContactSyncCompleted=function(){return(0,a.getStorage)().versions.version(28)},t.messageAddPaymentTxnStatus=function(){return(0,a.getStorage)().versions.version(29)},t.messageAddProductListPreviewInfo=function(){return(0,a.getStorage)().versions.version(30)},t.recentStickersCreateTable=function(){return(0,a.getStorage)().versions.version(31)},t.verifiedBusinessNameAddPrivacyMode=function(){return(0,a.getStorage)().versions.version(32)};var a=r(92166)},85348:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.doPendingDeviceSync=function(){return d.apply(this,arguments)},t.addUserToPendingDeviceSync=function(e){if(n.default.supportsFeature(n.default.F.MD_BACKEND))return(0,s.getTable)().bulkCreateOrMerge(e.map((e=>({id:e}))));return Promise.resolve()};var i=a(r(52954)),n=a(r(20468)),s=r(37454),o=r(47882),l=r(25054);function d(){return(d=(0,i.default)((function*(){if(n.default.supportsFeature(n.default.F.MD_BACKEND))try{var e=yield(0,s.getTable)().all();(0,o.syncDeviceList)(e.map((e=>(0,l.createWid)(e.id)))),yield(0,s.getTable)().bulkRemove(e.map((e=>e.id)))}catch(e){__LOG__(4,!0,new Error,!0)`doPendingDeviceSync failed during RESUME_WITH_OPEN_TAB`,SEND_LOGS(`doPendingDeviceSync failed during RESUME_WITH_OPEN_TAB ${e}`)}yield Promise.resolve()}))).apply(this,arguments)}},3060:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.initialize=function(){null==i&&((0,u.createStorage)(),(0,o.addTable)(),(0,s.addTable)(),(0,l.addTable)(),(0,d.addTable)(),i=(0,u.getStorage)().initialize().catch((e=>{throw __LOG__(4,!0,new Error,!0)`Assertion failed!`,SEND_LOGS("Failed to initialize offd storage"),e})));return i},t.destroy=function(){return(0,u.destroyStorage)().catch((()=>c.resolve(new n.default(u.DATABASE_NAME).delete()))).finally((()=>{i=null}))};var i,n=a(r(77715)),s=r(25323),o=r(95036),l=r(15579),d=r(37454),u=r(22362),c=r(97733).Z},25323:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.addTable=function(){(0,s.getStorage)().add("dangling-receipt").version((0,s.getStorage)().versions.version(1),[new n.default("id"),new i.default("receipts")]).view((e=>({id:e.id,receipts:e.receipts})))},t.getTable=function(){return(0,s.getStorage)().table("dangling-receipt")};var i=a(r(49052)),n=a(r(23026)),s=r(22362)},15579:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.addTable=function(){(0,s.getStorage)().add("peer-read-receipt").version((0,s.getStorage)().versions.version(2),[new n.default("id"),new i.default("msgKeys"),new i.default("ts")]).view((e=>({id:e.id,ts:e.ts,msgKeys:e.msgKeys})))},t.getTable=function(){return(0,s.getStorage)().table("peer-read-receipt")};var i=a(r(49052)),n=a(r(23026)),s=r(22362)},37454:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.addTable=function(){(0,i.getStorage)().add("pending-device-sync").version((0,i.getStorage)().versions.version(4),[new n.default("id")]).view((e=>({id:e.id})))},t.getTable=function(){return(0,i.getStorage)().table("pending-device-sync")};var i=r(22362),n=a(r(44221))},95036:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.addTable=function(){(0,n.getStorage)().add("read-receipt").version((0,n.getStorage)().versions.version(0),[new s.default("id"),new i.default("externalIds")]).delete((0,n.getStorage)().versions.version(3)).view((e=>({id:e.id,externalIds:e.externalIds})))},t.getTable=function(){return(0,n.getStorage)().table("read-receipt")};var i=a(r(49052)),n=r(22362),s=a(r(44221))},22362:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.createStorage=function(){var e=new s.default(d);(u=new o.default(e)).addErrorHandler(i.default.AbortError,(e=>{e.message.includes("QuotaExceededError")&&l.default.trigger("storage_not_enough_space")}))},t.getStorage=function(){return(0,n.default)(null!=u,"[offd-storage] Storage should be created first before being accessed"),u},t.destroyStorage=function(){if(null==u)return Promise.reject(new Error("[model-storage] Storage should be created first before being destroyed"));return u.purge().then((()=>{u=null})).catch((e=>{throw u=null,e}))},t.DATABASE_NAME=void 0;var i=a(r(77715)),n=a(r(47677)),s=a(r(36479)),o=a(r(49195)),l=a(r(37018)),d="offd-storage";t.DATABASE_NAME=d;var u=null},82714:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.updateOfflineMsgAcks=function(){return c.apply(this,arguments)},t.updateUnreadCount=function(){return h.apply(this,arguments)};var i=a(r(52954)),n=a(r(20468)),s=r(15579),o=a(r(23045)),l=r(43730),d=a(r(83746)),u=r(23443);function c(){return(c=(0,i.default)((function*(){if(n.default.supportsFeature(n.default.F.MD_BACKEND)){var e=(yield(0,s.getTable)().all()).reduce(((e,t)=>e.concat(t.msgKeys.map((e=>({id:e,ack:o.default.ACK.READ,pendingReadReceipt:null}))))),[]);yield(0,l.getTable)().bulkCreateOrMerge(e)}return Promise.resolve()}))).apply(this,arguments)}function p(){var e=new Map;return(0,s.getTable)().forEach((t=>{t.msgKeys.forEach((t=>{var r=d.default.fromString(t).remote.toString();if(r!==o.default.STATUS_WID){var a=(e.get(r)||0)+1;e.set(r,a)}}))})).then((()=>(0,s.getTable)().clear())).then((()=>e))}function h(){return(h=(0,i.default)((function*(){if(n.default.supportsFeature(n.default.F.MD_BACKEND)){var e=yield p(),t=Array.from(e.keys()),r=(yield(0,u.getTable)().bulkGet(t)).map(((r,a)=>{var i=e.get(t[a])||0,n=r?r.unreadCount:0;return{id:t[a],unreadCount:Math.max(n-i,0)}}));yield(0,u.getTable)().bulkCreateOrMerge(r)}return Promise.resolve()}))).apply(this,arguments)}},35540:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.initialize=function(){null==i&&((0,s.createStorage)(),(0,o.addTable)(),(0,l.addTable)(),(0,d.addTable)(),(0,u.addTable)(),(0,c.addTable)(),(0,p.addTable)(),(0,h.addTable)(),i=(0,s.getStorage)().initialize().catch((e=>{throw __LOG__(4,!0,new Error,!0)`Assertion failed!`,SEND_LOGS("Failed to initialize signal storage"),e})));return i},t.destroy=function(){return(0,s.destroyStorage)().catch((()=>f.resolve(new n.default(s.DATABASE_NAME).delete()))).finally((()=>{i=null}))},Object.defineProperty(t,"getBaseKeyTable",{enumerable:!0,get:function(){return o.getTable}}),Object.defineProperty(t,"getIdentityTable",{enumerable:!0,get:function(){return l.getTable}}),Object.defineProperty(t,"getMetaTable",{enumerable:!0,get:function(){return d.getTable}}),Object.defineProperty(t,"getPreKeyTable",{enumerable:!0,get:function(){return u.getTable}}),Object.defineProperty(t,"getSenderKeyTable",{enumerable:!0,get:function(){return c.getTable}}),Object.defineProperty(t,"getSessionTable",{enumerable:!0,get:function(){return p.getTable}}),Object.defineProperty(t,"getSignedPreKeyTable",{enumerable:!0,get:function(){return h.getTable}});var i,n=a(r(77715)),s=r(89308),o=r(36884),l=r(76573),d=r(25882),u=r(64070),c=r(6129),p=r(8698),h=r(95363),f=r(97733).Z},36884:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.addTable=function(){(0,o.getStorage)().add("baseKey-store").version((0,l.baseKeyCreateTable)(),[new s.default("id"),new i.default("address"),new i.default("originalMsgId"),new i.default("baseKey"),new n.default(["address","originalMsgId"])]).view((e=>({id:e.id,address:e.address,originalMsgId:e.originalMsgId,baseKey:e.baseKey})))},t.getTable=function(){return(0,o.getStorage)().table("baseKey-store")};var i=a(r(49052)),n=a(r(9818)),s=a(r(23026)),o=r(89308),l=r(33502)},76573:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.addTable=function(){(0,n.getStorage)().add("identity-store").version((0,o.identityCreateTable)(),[new s.default("identifier"),new i.default("identityKey")]).view((e=>({identifier:e.identityKey,identityKey:e.identityKey})))},t.getTable=function(){return(0,n.getStorage)().table("identity-store")};var i=a(r(49052)),n=r(89308),s=a(r(44221)),o=r(33502)},25882:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.addTable=function(){(0,n.getStorage)().add("signal-meta-store").version((0,o.metaCreateTable)(),[new s.default("key"),new i.default("value")]).view((e=>({key:e.key,value:e.value})))},t.getTable=function(){return(0,n.getStorage)().table("signal-meta-store")};var i=a(r(49052)),n=r(89308),s=a(r(44221)),o=r(33502)},64070:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.addTable=function(){(0,s.getStorage)().add("prekey-store").version((0,o.preKeyCreateTable)(),[new n.default("keyId"),new i.default("keyPair"),new i.default("isDirectDistribution")]).view((e=>({keyId:e.keyId,keyPair:e.keyPair,isDirectDistribution:e.isDirectDistribution})))},t.getTable=function(){return(0,s.getStorage)().table("prekey-store")};var i=a(r(49052)),n=a(r(23026)),s=r(89308),o=r(33502)},6129:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.addTable=function(){(0,s.getStorage)().add("senderkey-store").version((0,l.senderKeyCreateTable)(),[new o.default("senderKeyName"),new i.default("senderKey"),new i.default("senderId"),new n.default("senderId")]).view((e=>({senderKeyName:e.senderKeyName,senderKey:e.senderKey,senderId:e.senderId})))},t.getTable=function(){return(0,s.getStorage)().table("senderkey-store")};var i=a(r(49052)),n=a(r(81824)),s=r(89308),o=a(r(44221)),l=r(33502)},8698:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.addTable=function(){(0,n.getStorage)().add("session-store").version((0,o.sessionCreateTable)(),[new s.default("address"),new i.default("session")]).view((e=>({address:e.address,session:e.session})))},t.getTable=function(){return(0,n.getStorage)().table("session-store")};var i=a(r(49052)),n=r(89308),s=a(r(44221)),o=r(33502)},95363:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.addTable=function(){(0,s.getStorage)().add("signed-prekey-store").version((0,o.signedPreKeyCreateTable)(),[new n.default("keyId"),new i.default("keyPair"),new i.default("signature")]).view((e=>({keyId:e.keyId,keyPair:e.keyPair,signature:e.signature})))},t.getTable=function(){return(0,s.getStorage)().table("signed-prekey-store")};var i=a(r(49052)),n=a(r(23026)),s=r(89308),o=r(33502)},89308:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.createStorage=function(){var e=new s.default(d);(u=new o.default(e)).addErrorHandler(i.default.AbortError,(e=>{e.message.includes("QuotaExceededError")&&l.default.trigger("storage_not_enough_space")}))},t.getStorage=function(){return(0,n.default)(null!=u,"[signal-storage] Storage should be created first before being accessed"),u},t.destroyStorage=function(){if(null==u)return Promise.reject(new Error("[signal-storage] Storage should be created first before being destroyed"));return u.purge().then((()=>{u=null})).catch((e=>{throw u=null,e}))},t.DATABASE_NAME=void 0;var i=a(r(77715)),n=a(r(47677)),s=a(r(36479)),o=a(r(49195)),l=a(r(37018)),d="signal-storage";t.DATABASE_NAME=d;var u=null},33502:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.identityCreateTable=function(){return(0,a.getStorage)().versions.version(0)},t.metaCreateTable=function(){return(0,a.getStorage)().versions.version(1)},t.preKeyCreateTable=function(){return(0,a.getStorage)().versions.version(2)},t.sessionCreateTable=function(){return(0,a.getStorage)().versions.version(3)},t.signedPreKeyCreateTable=function(){return(0,a.getStorage)().versions.version(4)},t.baseKeyCreateTable=function(){return(0,a.getStorage)().versions.version(5)},t.senderKeyCreateTable=function(){return(0,a.getStorage)().versions.version(6)};var a=r(89308)},70109:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return n.apply(this,arguments)};var i=a(r(52954));function n(){return(n=(0,i.default)((function*(){var e=window.caches;if(null!=e){var t=yield e.keys();yield Promise.all(t.map((t=>e.delete(t))))}}))).apply(this,arguments)}},96623:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r={REQUEST_STREAMING_INFO:"GET_STREAMING_INFO",REQUEST_RMR:"REQUEST_RMR",SEND_STREAMING_CHUNK:"SEND_STREAMING_CHUNK",EXP_BACKOFF:"EXP_BACKOFF",LOG:"LOG",UPLOAD_LOGS:"UPLOAD_LOGS",REQUEST_DOCUMENT_DOWNLOAD:"REQUEST_DOCUMENT_DOWNLOAD",SET_L10N:"SET_L10N",STREAMING_SUPPORTED:"STREAMING_SUPPORTED",REMOVE_PP:"REMOVE_PP",LOGOUT:"LOGOUT",CLEAN_ASSETS:"CLEAN_ASSETS",PRELOAD_LAZY_LOADED_BUNDLES:"PRELOAD_LAZY_LOADED_BUNDLES"};t.default=r},3715:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;class r{constructor(e){this.onMessage=e=>{if(e.data&&e.data.action){var t=e.data;if(e.ports&&0!==e.ports.length){var a=e.ports;if(r.isSW()||!window.navigator.serviceWorker||e.source===window.navigator.serviceWorker.controller)("function"==typeof e.waitUntil?t=>e.waitUntil(t):()=>{})(Promise.resolve(this.requestHandler(t)).then((e=>{a[0].postMessage(e)})).catch((e=>{a[0].postMessage({error:e&&e.toString()})})))}}},this.requestHandler=e}init(){var e=r.isSW()?self:window.navigator.serviceWorker;try{if(!e)return;e.addEventListener("message",this.onMessage)}catch(e){}}static isSW(){return"undefined"==typeof window}static getRequestor(e){return r.isSW()?"string"==typeof e?self.clients.get(e):Promise.resolve(e):window.navigator.serviceWorker?window.navigator.serviceWorker.ready.then((()=>window.navigator.serviceWorker?window.navigator.serviceWorker.controller:null)):Promise.resolve(null)}static broadcast(e,t){return r.isSW()?self.clients.matchAll().then((a=>0===a.length?Promise.reject("No clients available."):Promise.all(a.map((a=>r.request(a,e,t)))))):Promise.reject(new Error("Broadcast called from non-serviceworker."))}static request(e,t,a){var i=new MessageChannel;return new Promise(((n,s)=>(i.port1.onmessage=e=>{e.data&&e.data.error?s(e.data.error):n(e.data)},r.getRequestor(e).then((e=>{if(!e)return s("No ServiceWorker controlling this client.");e.postMessage({action:t,message:a,version:"2.2121.6"},[i.port2])})))))}}t.default=r},47791:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859),n=i(r(96623)),s=i(r(13277)),o=r(81725),l=i(r(94854)),d=i(r(3715)),u=i(r(96377)),c=i(r(55074)),p=a(r(15934));if(c.default.supported){var h=function(){try{var e=navigator.serviceWorker;e&&e.controller&&e.controller.addEventListener("error",(e=>{p.default.state!==p.STATE.UNLAUNCHED&&__LOG__(3)`ServiceWorker controller error: ${e.error}`}))}catch(e){__LOG__(3)`Unable to add "error" event listener to service worker, error: ${e}`}};try{var f=navigator.serviceWorker;f&&f.addEventListener("controllerchange",(()=>{h(),p.default.state===p.STATE.UNLAUNCHED&&(u.default.needsUpdate=!0)}))}catch(e){__LOG__(3)`Unable to add "controllerchange" event listener to service worker container, error: ${e}`}try{var _=navigator.serviceWorker;_&&_.addEventListener("error",(e=>{p.default.state!==p.STATE.UNLAUNCHED&&__LOG__(3)`ServiceWorker container error: ${e.error}`}))}catch(e){__LOG__(3)`Unable to add "error" event listener to service worker container, error: ${e}`}h();var m=function(e,t){e.buffer.forEach((e=>{var r,a=null!==(r=e.message[0])&&void 0!==r?r:"",i=function(e){switch(e){case"info":return 1;case"log":return 2;case"warn":return 3;case"error":return 4}throw new Error(`Invalid level: ${e}`)}(e.level.match(/^(.*?)(?:Verbose)?$/i)[1]);l.default.logImpl(i,`ServiceWorker (${t}): ${a}`,e.error,e.attachedToSendLogs,e.extraTags)}))};new d.default((({action:e,message:t,version:a})=>{switch(e){case n.default.REQUEST_STREAMING_INFO:case n.default.EXP_BACKOFF:case n.default.REQUEST_RMR:case n.default.SEND_STREAMING_CHUNK:return(0,o.requireHandleVideoStreamingRequest)().then((r=>r({action:e,message:t})));case n.default.LOG:if(p.default.state===p.STATE.UNLAUNCHED)return;return t&&m(t,a),{test:!0};case n.default.UPLOAD_LOGS:return t&&m(t,a),r(2537).upload({reason:"Requested by Service Worker"}).then((()=>{}));default:return Promise.reject(`Invalid Action: ${e}`)}})).init(),s.default.on("logout",(()=>{var e=navigator.serviceWorker;e&&e.controller&&d.default.request(e.controller,n.default.LOGOUT).catch((()=>{}))}))}},69263:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default=class{open(){return this._openPromise?this._openPromise:this._closePromise?(this._openPromise=this._closePromise.catch((e=>{throw this._openPromise=null,e})).then((()=>(this._openPromise=null,this.open()))),this._openPromise):(this._openPromise=this.doOpen().catch((e=>{throw this._openPromise=null,e})).then((()=>{this._openPromise=null})),this._openPromise)}close(){return this._closePromise?this._closePromise:this._openPromise?(this._closePromise=this._openPromise.catch((e=>{throw this._closePromise=null,e})).then((()=>(this._closePromise=null,this.close()))),this._closePromise):(this._closePromise=this.doClose().catch((e=>{throw this._closePromise=null,e})).then((()=>{this._closePromise=null})),this._closePromise)}doOpen(){throw new Error("Not implemented")}doClose(){throw new Error("Not implemented")}}},22346:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(69263));class n extends i.default{get(e){return this.open().then((()=>this.doGet(e)))}queryByIndex(e,t){return this.open().then((()=>this.doQueryByIndex(e,t)))}getAll(){return this.open().then((()=>this.doGetAll()))}put(e,t){return this.open().then((()=>this.doPut(e,t)))}del(e){return this.open().then((()=>this.doDel(e)))}count(){return this.open().then((()=>this.doCount()))}clear(){return this.open().then((()=>this.doClear()))}doGet(){throw new Error("Not implemented")}doQueryByIndex(){throw new Error("Not implemented")}doGetAll(){throw new Error("Not implemented")}doPut(){throw new Error("Not implemented")}doDel(){throw new Error("Not implemented")}doCount(){throw new Error("Not implemented")}doClear(){throw new Error("Not implemented")}doOpen(){throw new Error("Not implemented")}doClose(){throw new Error("Not implemented")}}t.default=n},55074:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(96623)),n=a(r(71107)),s=a(r(3715)),o=a(r(11018)),l="Modernizr"in window;class d extends n.default{constructor(){super(),this.supported=l?Modernizr.serviceworker:"serviceWorker"in navigator,this._checkAlive=()=>{var e=navigator.serviceWorker&&navigator.serviceWorker.controller;return Boolean(e)},this._checkStreamingSupport=()=>{if(this.supported&&this.alive&&!o.default.isSafari){if(this._streamingSupportedPromise)return this._streamingSupported;var e=navigator.serviceWorker&&navigator.serviceWorker.controller;e&&(this._streamingSupportedPromise=s.default.request(e,i.default.STREAMING_SUPPORTED).timeout(100).catch((()=>!1)).then((e=>(delete this._streamingSupportedPromise,this.streamingSupported=e,e))))}else this._streamingSupported=!1},this._setSupported=e=>{this.supported=e},l&&Modernizr.on("serviceworker",this._setSupported);var e=this;Object.defineProperty(this,"streamingSupported",{get:()=>(e._checkStreamingSupport(),e._streamingSupported),set(t){t!==e._streamingSupported&&e.trigger("change:streamingSupported",t),e._streamingSupported=t}}),Object.defineProperty(this,"alive",{get:()=>e._checkAlive()})}}var u=new d;t.default=u},32944:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r={key(e){}};t.default=r},19938:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ABPropConfigs=void 0;t.ABPropConfigs={groups_dogfooding_ui:[308,"bool",!1],md_icdc_enabled:[309,"bool",!1],md_icdc_hash_length:[310,"int",10],played_self_enabled:[361,"bool",!1],ephemeral_24h_duration:[407,"bool",!1],disappearing_mode:[536,"bool",!1],ephemeral_allow_group_members:[432,"bool",!1],business_profile_refresh_m1_enabled:[470,"bool",!1],web_test_bool2:[220,"bool",!1],web_test_int2:[221,"int",0],web_test_float2:[222,"float",0],web_test_string2:[223,"string","test_string_value"],test_web_biz_profile_options:[285,"int",3],test_web_ctwa_context_compose_enabled:[286,"int",1],test_web_gif_search:[287,"string","giphy"],test_web_list_message:[288,"int",1],test_web_voip_internal_tester:[289,"int",1],test_web_ctwa_context_compose_enabled_2:[298,"bool",!0],test_web_list_message_2:[299,"bool",!0],test_web_voip_internal_tester_2:[300,"bool",!0],should_deregister_on_syncd_fatal:[383,"bool",!0],stop_abprops_traffic_in_serverprops_response:[315,"bool",!1],enable_biz_activity_report_request:[455,"bool",!1],plm_products_max_batch_fetch_size:[464,"int",18]}},6807:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.updateAttributesLocalStorage=function(e,t,r,a){var d,u,c=null;null!=r&&((c=r)<600?c=600:c>o&&(c=o));var p=l()||{},h={abKey:null!=e?e:p.abKey,hash:null!=t?t:p.hash,refresh:null!==(d=null===(u=c)||void 0===u?void 0:u.toString())&&void 0!==d?d:p.refresh,lastSyncTime:a};(0,s.default)(i.default,"localStorage").setItem(n.default.KEY_ABPROPS,JSON.stringify(h))},t.isABPropsAfterFirstSync=function(){return null!=l()},t.getABKey=function(){var e=l();return null==e?void 0:e.abKey},t.getHash=function(){var e=l();return null==e?void 0:e.hash},t.getLastSyncTime=function(){var e=l(),t=null==e?void 0:e.lastSyncTime;if(null==t)return null;return parseInt(t,10)},t.getRefresh=function(){var e,t=l();return parseInt(null!==(e=null==t?void 0:t.refresh)&&void 0!==e?e:86400,10)};var i=a(r(48879)),n=a(r(43312)),s=a(r(21830)),o=604800;function l(){var e=(0,s.default)(i.default,"localStorage").getItem(n.default.KEY_ABPROPS);return null==e?null:JSON.parse(e)}},71796:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.clearABPropConfigs=function(){return c()},t.getAllABPropConfigs=function(){return f()},t.getABPropConfigValue=function(e){var t;o.default.supportsFeature(o.default.F.MD_BACKEND)||(__LOG__(4,!0,new Error,!0)`[ABProps] getABPropConfigValue() should not be called by non-MD build, config name: ${e}`,SEND_LOGS(`[ABProps] getABPropConfigValue() should not be called by non-MD build, config name: ${e}`));var r=s.ABPropConfigs[e],[a,,i]=r;return null!==(t=h(a))&&void 0!==t?t:i},t.updateABPropsFromStorage=function(){return _.apply(this,arguments)};var i=a(r(52954)),n=r(47628),s=r(19938),o=a(r(20468)),l=new Map,d=!1,u={};Object.keys(s.ABPropConfigs).forEach((e=>{var[t]=s.ABPropConfigs[e];u[t]=e}));var c=()=>{l.clear(),d=!1},p=function(e){e.forEach((e=>{l.set(e.configCode,e)})),d=!0},h=function(e){var t;return d?null===(t=l.get(e))||void 0===t?void 0:t.configValue:(__LOG__(4,!0,new Error,!0)`[ABProps] configs need to be initialized before its first access, config code: ${e}`,SEND_LOGS(`[ABProps] configs need to be initialized before its first access, config code: ${e}`),null)},f=function(){return Array.from(l.values())};function _(){return(_=(0,i.default)((function*(){try{var e=(yield(0,n.getABPropConfigs)()).map((e=>{var t=u[e.configCode];if(null!=t){var r=s.ABPropConfigs[t],[a,i,o]=r;return{configCode:a,configValue:(0,n.parseConfigValue)(e.configValue,i,o),configExpoKey:null}}__LOG__(4,!0,new Error,!0)`[ABProps] Should not store an ABProp (code: ${e.configCode}) that is unavailable for this client version`,SEND_LOGS(`[ABProps] Should not store an ABProp (code: ${e.configCode}) that is unavailable for this client version`)}));p(e)}catch(e){__LOG__(4,!0,new Error,!0)`[ABProps] Failed to update ABProps configs cache from storage`,SEND_LOGS("[ABProps] Failed to update ABProps configs cache from storage: "+e)}}))).apply(this,arguments)}},84621:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(r(74930)),s=a(r(99461)),o=a(r(34535)),l=Math.pow(2,31)-1;var d=new class{constructor(){this._alarms=new Map;var e=()=>{this._alarms.size>0&&this._validateTimeouts()};o.default.on(o.JS_HALT_EVENT,e),o.default.on(o.CLOCK_CHANGE_BACKWARDS_EVENT,e),s.default.on(s.SKEW_CHANGE_EVENT,this._resetGlobalTimeouts.bind(this))}setLocalTimeout(e,t,r){return this._setTimeout(!1,e,t,r)}setGlobalTimeout(e,t,r){return this._setTimeout(!0,e,t,r)}clearTimeout(e){if(e){var t=this._alarms.get(e);t&&(window.clearTimeout(t.timeoutId),this._alarms.delete(e))}}_setTimeout(e,t,r,a){a&&this.clearTimeout(a);var i=a||(0,n.default)("alarm_timer_"),s=r-this._getTimeInMS(e),d=Math.min(s,l);if(s<0)return __LOG__(2)`Alarm:setTimeout:Cannot set alarm in the past.`,t(),i;var u=window.setTimeout((()=>{r-this._getTimeInMS(e)<o.DEFAULT_THRESHOLD?(this._alarms.delete(i),t()):this._setTimeout(e,t,r,i)}),d);return this._alarms.set(i,{isGlobal:e,fn:t,expiration:r,timeoutId:u}),i}_validateTimeouts(){new Map(this._alarms).forEach(((e,t)=>{var{isGlobal:r,fn:a,expiration:i}=e;i<this._getTimeInMS(r)?(this.clearTimeout(t),a()):this._setTimeout(r,a,i,t)}))}_resetGlobalTimeouts(){new Map(this._alarms).forEach(((e,t)=>{var{isGlobal:r,fn:a,expiration:i}=e;r&&this._setTimeout(r,a,i,t)}))}_getTimeInMS(e=!1){return 1e3*(e?s.default.globalUnixTime():s.default.localUnixTime())}};t.default=d},77369:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.URL=void 0;t.URL="https://web.whatsapp.com/"},99850:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isWAURL=function(e){return r.test(e)},t.APICmd=void 0;t.APICmd={GROUP_INVITE:"GROUP_INVITE",MSG_SEND:"MSG_SEND",INVALID:"INVALID",CATALOG:"CATALOG",PRODUCT:"PRODUCT"};var r=/^whatsapp:\/\/.*/i},21988:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.parseConversionData=m,t.parseAPICmd=function(e){if("string"!=typeof e)return{resultType:l.APICmd.INVALID,data:void 0};var t=(e=>{var t=e.match(c);if(t)return{code:t[2],url:t[1]||"/"};if(t=e.match(p))return{code:t[1]};if(t=e.match(h))return{code:t[1]};if(t=e.match(f))return{code:t[1]}})(e);if(t)return{resultType:l.APICmd.GROUP_INVITE,data:t};var r=function(e){var t=e.match(C)||e.match(P);if(t)return w(t);if(t=e.match(O))return(0,n.default)((0,n.default)({},w(t)),{},{url:"/"})}(e);if(r)return{resultType:l.APICmd.CATALOG,data:r};var a=function(e){var t=e.match(T)||e.match(A);if(t)return M(t);if(t=e.match(b))return(0,n.default)((0,n.default)({},M(t)),{},{url:"/"})}(e);if(a)return{resultType:l.APICmd.PRODUCT,data:a};var i=(e=>{var t=e.match(v);if(t){var r=g(t[2]);if(r)return r.url=t[1]||"/",r}if(t=e.match(E))return g(t[1]);if(t=e.match(y))return g(t[1]);if(t=e.match(S)){var a;if(t[1]&&(a={phone:`${t[1]}@c.us`}),t[2]){var i=g(t[2]);i&&(a=(0,n.default)((0,n.default)({},a),i))}return a}})(e);if(i)return{resultType:l.APICmd.MSG_SEND,data:i};return{resultType:l.APICmd.INVALID,data:void 0}};var i,n=a(r(70417)),s=r(49244),o=r(77369),l=r(99850),d=a(r(31244)),u=(i=o.URL,i.replace(/\/+$/,"")).replace(/[\/\.]/g,"\\$&"),c=new RegExp(`^${u}((?:/\\w+)*)/accept/?\\?code=(\\w+)$`,"i"),p=/^https?:\/\/chat\.whatsapp\.com\/invite\/(\w+)$/i,h=/^https?:\/\/chat\.whatsapp\.com\/(\w+)$/i,f=/^whatsapp:\/\/chat\/?\?code=(\w+)$/i,_={text:"text",phone:"phone",data:"data",source:"source",context:"context",icebreaker:"icebreaker",source_url:"source_url"};function m(e){if(e&&"string"==typeof e){var t=s.Binary.build(e);if(!(t.size()>512))return t.readBuffer()}}function g(e){var t={};if(new d.default(e).forEach(((e,r)=>{var a=r.toLowerCase();if(a===_.data){var i=m(e);if(!i)return;t.conversionTuple||(t.conversionTuple={}),t.conversionTuple.conversionData=i}else if(a===_.source){var n=e;if((0,s.numUtf8Bytes)(n)>32)return;t.conversionTuple||(t.conversionTuple={}),t.conversionTuple.conversionSource=n}else a===_.source_url?(t.ctwaContextLinkData=t.ctwaContextLinkData||{},t.ctwaContextLinkData.sourceUrl=e):a===_.context?(t.ctwaContextLinkData=t.ctwaContextLinkData||{},t.ctwaContextLinkData.context=e):a===_.icebreaker?(t.ctwaContextLinkData=t.ctwaContextLinkData||{},t.ctwaContextLinkData.icebreaker=e):_[a]&&(t[a]=e)})),t.phone&&(t.phone=t.phone.replace(/\D/g,"")+"@c.us",t.ctwaContextLinkData&&(t.ctwaContextLinkData.phone=t.phone)),t.phone||t.text)return t}var v=new RegExp(`^${u}((?:/\\w+)*)/send/?\\?(.+)$`,"i"),E=/^https?:\/\/api\.whatsapp\.com\/send\/?\?(.+)$/i,y=/^whatsapp:\/\/send\/?\?(.*)$/i,S=/^https?:\/\/wa\.me\/?([0-9]{0,20})?\/?\??(.+)?$/i,T=/^https?:\/\/wa\.me\/p\/([0-9]{0,20})\/([0-9]{0,20})$/i,A=/^whatsapp:\/\/product\/([0-9]{0,20})\/([0-9]{0,20})$/i,b=new RegExp(`^${u}(?:(?:/\\w+)*)/product/([0-9]{0,20})/([0-9]{0,20})$`,"i"),C=/^https?:\/\/wa\.me\/c\/([0-9]{0,20})$/i,P=/^whatsapp:\/\/catalog\/([0-9]{0,20})$/i,O=new RegExp(`^${u}(?:(?:/\\w+)*)/catalog/([0-9]{0,20})$`,"i");function w(e){return{catalogOwnerJid:`${e[1]}@s.whatsapp.net`}}function M(e){return{productId:e[1],businessOwnerJid:`${e[2]}@s.whatsapp.net`}}},3351:(e,t,r)=>{"use strict";var a=r(14859);t.Z=void 0;var i=a(r(84621)),n=r(66239),s=a(r(79628)),o=a(r(15934)),l=r(53271).default,d=6e5,u="init",c="ping",p="pong",h="local-takeover";var f=new class{init(e=0){var t=e+1;if(t>3)return Promise.resolve(!0);var r=(0,n.getNoTakeover)();return(0,n.setNoTakeover)(),o.default.preload(),this._pingForOtherLocalSession().then((e=>e?(this._updateMutex(),(0,s.default)(!r).then((()=>!1))):!!r||Promise.reject(t)))}takeoverLocal(e){return(0,n.getMutex)()?((0,n.setMutex)(h),l(window,"storage",n.takeoverFilter).timeout(3e4,"takeoverLocalTimeout").then((t=>{var r=(0,n.parseTakeover)(t.newValue);return(0,n.getRememberMe)()||(0,n._setAllKeyValues)(r),o.default.mustExitLoop=!1,(0,n.removeMutex)(),this.init(e)})).catchType(Promise.TimeoutError,(()=>(__LOG__(3)`app:takeoverLocal timeout`,o.default.mustExitLoop=!1,(0,n.removeMutex)(),this.init(e))))):this.init(e)}unloadMutex(){var e=(0,n.getMutex)();e&&this._ourMutex&&e.includes(this._ourMutex)&&(0,n.removeMutex)()}storagePong(e){if((0,n.mutexFilter)(e)){var t=(0,n.parseMutex)(e.newValue);if(t)return t===h?(this._clearMutexTimer(),o.default.exitLoop(),(0,n.localTakeoverSuccess)(),!0):void(0===t.indexOf(c)&&(0,n.setMutex)(p+Math.random()))}}_clearMutexTimer(){this._updateMutexTimerID&&i.default.clearTimeout(this._updateMutexTimerID)}_updateMutex(){this._clearMutexTimer();var e=Date.now();(0,n.setMutex)(this._ourMutex=u+"_"+e),this._updateMutexTimerID=i.default.setLocalTimeout(this._updateMutex.bind(this),e+d)}_pingForOtherLocalSession(){var e=(0,n.getMutex)();if(e){var t=1e4;if((e+="").indexOf("_")>0){var r=e.split("."),a=parseInt(r[r.length-1],10);if(Number.isFinite(a))a<Date.now()-9e5&&(__LOG__(2)`app:_pingForOtherLocalSession stale mutex`,t=1e3)}var i=l(window,"storage",n.mutexFilter).timeout(t,"waitForOtherLocalSessionTimeout").then((()=>!1)).catchType(Promise.TimeoutError,(function(){return __LOG__(3)`app:_pingForOtherLocalSession mutex timeout`,!0}));return(0,n.setMutex)(c+Math.random()),i}return Promise.resolve(!0)}};t.Z=f},41153:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.shouldUnarchiveChat=function(e){if((0,i.archiveV2Supported)()){if(s.default.showArchiveV2)return!1;if(!s.default.archive.enabled&&!e)return(0,n.setArchiveEnabledSetting)(!0),!1}return!0},t.shouldEnableArchiveV2=function(){var e=r(85030).default.filter((e=>e.archive));return(0,i.archiveV2Supported)()&&!s.default.archive.enabled&&1===e.length};var i=r(9690),n=r(55814),s=a(r(34749))},36310:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(...e){var t=e.reduce(((e,t)=>e+t.byteLength),0),r=new Uint8Array(t),a=0;return e.forEach((e=>{r.set(new Uint8Array(e),a),a+=e.byteLength})),r.buffer}},57829:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(e.byteLength!==t.byteLength)return!1;for(var r=new DataView(e),a=new DataView(t),i=0;i<r.byteLength;i++)if(r.getUint8(i)!==a.getUint8(i))return!1;return!0}},73580:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.arrayMove=t.arrayMoveMutate=void 0;var r=function(e,t,r){var a=r<0?e.length+r:r,i=e.splice(t,1)[0];e.splice(a,0,i)};t.arrayMoveMutate=r;t.arrayMove=function(e,t,a){var i=e.slice();return r(i,t,a),i}},79962:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return t>e.length-1?0:t<0?e.length-1:t}},69058:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){for(var r=[],a=e.length,i=t.length,n=Math.max(a,i),s=0;s<n;s++)s<a&&r.push(e[s]),s<i&&r.push(t[s]);return r}},12150:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;return e.every(((e,r)=>e===t[r]))}},22331:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r={equal:(e,t)=>{if(e!==t)throw new Error(`${String(e)} !== ${String(t)}`)}};t.default=r},27860:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.asyncSleepAfterGivenLoopIteration=function(){return n.apply(this,arguments)};var i=a(r(52954));function n(){return(n=(0,i.default)((function*(e,t=200,r=200){e>0&&e%t==0&&(yield new Promise((e=>setTimeout(e,r))))}))).apply(this,arguments)}},87288:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.b64Equal=function(e,t){var r=e.length,a=t.length;switch(r-a){case-2:return 61===t.charCodeAt(r)&&61===t.charCodeAt(r+1)&&t.substr(0,r)===e;case-1:return 61===t.charCodeAt(r)&&t.substr(0,r)===e;case 0:return e===t;case 1:return 61===e.charCodeAt(a)&&e.substr(0,a)===t;case 2:return 61===e.charCodeAt(a)&&61===e.charCodeAt(a+1)&&e.substr(0,a)===t;default:return!1}}},1663:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){for(var r=atob(e),a=0,i=0;i<r.length;i++){var n=r.charCodeAt(i);a=(((a=((a<<4)+(n>>4))%t)<<4)+(15&n))%t}return a}},32369:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){if(!e)return null;var t=e.replace(/\s+$/,"");e!==t&&Math.random()<.001&&(__LOG__(3,void 0,void 0,!0)`base64 sanitized due to extra whitespace`,SEND_LOGS("media-key-sanitize"));return t}},31962:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return e.replace(/\//g,"_").replace(/\+/g,"-")}},81405:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.CLOCK_CHANGE_BACKWARDS_EVENT=t.JS_HALT_EVENT=void 0;var i=a(r(71107)),n="js_halt";t.JS_HALT_EVENT=n;var s="clock_change_backwards";t.CLOCK_CHANGE_BACKWARDS_EVENT=s;class o extends i.default{constructor(e,t){super(),this._interval=e,this._threshold=t}startDetection(){if(!this._intervalId){var e=Date.now();this._intervalId=setInterval((()=>{var t=Date.now(),r=t-e-this._interval;r>this._threshold?this.trigger(n,r):r<-this._threshold&&this.trigger(s,r),e=t}),this._interval),__LOG__(2)`JsHaltDetector:detection started`}}stopDetection(){this._intervalId&&(clearInterval(this._intervalId),this._intervalId=null,__LOG__(2)`JsHaltDetector:detection stopped`)}restartDetection(){this.stopDetection(),this.startDetection(),__LOG__(2)`JsHaltDetector:detection restarted`}}t.default=o},67329:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default=class{constructor(e){if(e<=0)throw new RangeError("BitArray:numBits should be positive");this._numBits=e,this._array=new Uint8Array(Math.ceil(this._numBits/8))}get(e){var[t,r]=this._getArrayIndexOffset(e);return Boolean(this._array[t]>>r&1)}set(e){var[t,r]=this._getArrayIndexOffset(e);this._array[t]|=1<<r}unset(e){var[t,r]=this._getArrayIndexOffset(e);this._array[t]&=~(1<<r)}toggle(e){var[t,r]=this._getArrayIndexOffset(e);this._array[t]^=1<<r}clear(){this._array=new Uint8Array(Math.ceil(this._numBits/8))}toArray(){for(var e=[],t=0;t<this._numBits;t++)e.push(this.get(t));return e}toString(){return this.toArray().map((e=>e?"1":"0")).join("")}get length(){return this._numBits}_getArrayIndexOffset(e){if(e<0||e>=this._numBits)throw new RangeError("BitArray:index out of bounds");var t=Math.floor(e/8);return[t,e-8*t]}}},51322:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BIZ_SYSTEM_MSG_SUBTYPES_V2=void 0;t.BIZ_SYSTEM_MSG_SUBTYPES_V2=["biz_privacy_mode_init_fb","biz_privacy_mode_init_bsp","biz_privacy_mode_to_fb","biz_privacy_mode_to_bsp"]},78483:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(52954)),n=a(r(70417)),s=r(81600),o=a(r(13277)),l=r(60266),d=r(17845),u=r(77723),c=r(63191),p=r(8745),h=r(14963),f=r(58970),_=a(r(15934)),m=r(24789),g=r(47882),v=a(r(84161)),E=a(r(25064)),y=r(95334),S=r(38365),T=r(84558),A=r(43179),b=a(r(93371)),C=a(r(92082)),P=r(28103).Mirrored(["NotStarted","InProcess","Completed"]),O={initialChatHistory:!1,readReceipts:!1,syncdCritical:!1},w={initialChatHistoryTotalMsg:-1,initialChatHistoryTotalChats:-1};var M=new class{constructor(){this._criticalState={},this._debugOnlyState={},this._progressiveHistorySyncRemainingIteration=5,this._progressiveHistorySyncInFlight=!1,this._allCriticalDataSynced=!1,this.initState()}initState(){this._criticalState=(0,n.default)({},O),this._debugOnlyState=(0,n.default)({},w),this._syncDCritcalDataState=P.NotStarted}_isCriticalSyncDoneThisSession(){for(var e in this._criticalState)if(!this._criticalState[e])return!1;return!0}_setSynced(e){__LOG__(2)`[bootstrap] completed sync for ${e}`,this._criticalState[e]=!0,this._isCriticalSyncDoneThisSession()&&(__LOG__(2)`[bootstrap] critical sync done`,(0,c.setAllCriticalDataSynced)(),o.default.criticalSyncDone(),this.syncNonCriticalData())}_syncContactsInChunks(e,t){return(0,i.default)((function*(){__LOG__(2,void 0,void 0,void 0,["contact-sync"])`start contact sync for ${e?t.length+1:0} chunks of contacts during the inital sync`,null!=e&&(yield(0,m.syncContactList)(Array.from(e),!1));for(var r=0;r<t.length;r++){var a=Array.from(t[r]);yield(0,l.delayMs)(2e4),yield(0,m.syncContactList)(a)}__LOG__(2,void 0,void 0,void 0,["contact-sync"])`inital contact sync completes`}))()}_syncDeviceList(e){if(null==e)return __LOG__(2,void 0,void 0,void 0,["contact-sync"])`syncMostRecentDevices has no contact to sync during bootstrap`,Promise.resolve();__LOG__(2,void 0,void 0,void 0,["contact-sync"])`sync ${e.size} contacts for device info during the initial sync`;var t=Array.from(e);return(0,g.syncDeviceList)(t).catch((e=>{__LOG__(4,!0,new Error,!0)`Sync device failed`,SEND_LOGS("Sync device failed: "+e)}))}setReadReceiptsSynced(){this._setSynced("readReceipts")}setInitialChatHistorySynced(){this._setSynced("initialChatHistory")}setSyncDCriticalSynced(){this._criticalState.syncdCritical||this._setSynced("syncdCritical")}syncNonCriticalData(){var e=[];(0,h.queryAndUpdateAllGroupMetadata)().then((()=>{e=(0,p.getAllContactsFromChatCollectionIntoChunks)(),this._syncDeviceList(e[0]),(0,p.getAndUpdateNonAddressBookContacts)()})).then((()=>{setTimeout(function(){this._syncContactsInChunks(e[0],e.slice(1,e.length))}.bind(this),4e4)})),(0,u.getAndUpdateStatus)(),(0,s.getAndUpdateProfilePicture)(),(0,s.updateBlocklist)(),(0,f.markCollectionsForSync)([d.CollectionName.Regular,d.CollectionName.RegularLow,d.CollectionName.RegularHigh]).then((0,i.default)((function*(){new v.default.MdBootstrapDataApplied({mdBootstrapPayloadType:v.default.MD_BOOTSTRAP_PAYLOAD_TYPE.NON_CRITICAL,mdBootstrapSource:v.default.MD_BOOTSTRAP_SOURCE.APP_STATE,mdSessionId:yield E.default.getMdSessionId(),mdTimestamp:(0,y.unixTimeMs)()}).commit()})))}markInitialHistorySyncCountDebugStats(e,t){this._debugOnlyState={initialChatHistoryTotalMsg:e,initialChatHistoryTotalChats:t}}isSyncDCriticalDataSyncInProcess(){return this._syncDCritcalDataState===P.InProcess}setSyncDCriticalDataSyncCompleted(){this._syncDCritcalDataState=P.Completed}getCriticialSyncDebugSummary(){return(0,c.getAllCriticalDataSynced)()?"-------\nAll critical data synced\n-------\n\n":`-------\n Initial history sync complete: ${(0,c.getHistorySyncStatus)()?"true":this._criticalState.initialChatHistory.toString()}\n Initial msgs: ${this._debugOnlyState.initialChatHistoryTotalMsg}, initial chats: ${this._debugOnlyState.initialChatHistoryTotalChats}\n Receipt sync complete: ${this._criticalState.readReceipts.toString()} \n Critical collection sync complete: ${this._criticalState.syncdCritical.toString()} \n-------\n`}syncCriticalDataIfNeeded(){var e=this;return(0,i.default)((function*(){if(e._allCriticalDataSynced=(0,c.getAllCriticalDataSynced)(),e._allCriticalDataSynced)__LOG__(2)`[bootstrap] need to sync critical data: false`;else{__LOG__(2)`[bootstrap] need to sync critical data: true`,__LOG__(2)`[bootstrap] ${e.getCriticialSyncDebugSummary()}`;var t=(0,s.updatePrivacySettings)().then((()=>{e.setReadReceiptsSynced()})).catch((()=>{__LOG__(4,!0,new Error,!0)`failed to sync privacy settings`,SEND_LOGS("failed to update privacy settings from privacy request to webd"),_.default.logout()}));(0,A.updateSyncdDisabledDueToFatalFlag)(!1),e._syncDCritcalDataState=P.InProcess;var r=(0,f.markCollectionsForSync)([d.CollectionName.CriticalBlock,d.CollectionName.CriticalUnblockLow]).then((0,i.default)((function*(){if(!e._criticalState.syncdCritical){var t=yield b.default.getSyncActionsRows(["action"],[d.Actions.SettingPushName]);t.length>0&&t.find((e=>e.actionState===d.SyncActionState.Success))&&(e.setSyncDCriticalSynced(),e.setSyncDCriticalDataSyncCompleted())}new v.default.MdBootstrapDataApplied({mdBootstrapPayloadType:v.default.MD_BOOTSTRAP_PAYLOAD_TYPE.CRITICAL,mdBootstrapSource:v.default.MD_BOOTSTRAP_SOURCE.APP_STATE,mdSessionId:yield E.default.getMdSessionId(),mdTimestamp:(0,y.unixTimeMs)()}).commit()})));(0,c.getInitialHistorySyncComplete)()&&e.setInitialChatHistorySynced(),yield Promise.all([t,r])}}))()}continueProgressiveHistorySyncProcessing(){__LOG__(2)`[history sync] continueProgressiveHistorySyncProcessing`;var e="Safari"!==C.default.info().name;this._initNextProgressiveHistorySyncRunLoop(e)}_progressiveHistorySyncRun(){var e=this;return(0,i.default)((function*(){if(!e._allCriticalDataSynced&&!0!==e._criticalState.initialChatHistory)return __LOG__(2)`[history sync] Skip processLoop, until initial sync is complete`,void e._progressiveHistorySyncRemainingIteration++;var t=yield(0,S.fetchNextHitorySyncChunkForProcessing)();t&&(__LOG__(2)`[history sync] processLoop picked up chunk`,e._progressiveHistorySyncRemainingIteration++,yield(0,T.handleHistorySyncChunk)(t))}))()}_initNextProgressiveHistorySyncRunLoop(e=!1){var t=this;return(0,i.default)((function*(){if(e&&t._progressiveHistorySyncRemainingIteration++,!t._progressiveHistorySyncInFlight&&t._progressiveHistorySyncRemainingIteration>0){t._progressiveHistorySyncRemainingIteration--,t._progressiveHistorySyncInFlight=!0;try{yield t._progressiveHistorySyncRun()}catch(e){__LOG__(4,void 0,new Error)`[History sync] _progressiveHistorySyncRun failed with ${null==e?void 0:e.message}, stack: ${null==e?void 0:e.stack}`}t._progressiveHistorySyncInFlight=!1,yield new Promise((e=>setTimeout(e,5e4))),t._initNextProgressiveHistorySyncRunLoop()}}))()}};o.default.on("on_initial_chat_synced",(()=>{M.setInitialChatHistorySynced()})),o.default.on("logout",(()=>{M.initState()}));var I=M;t.default=I},92082:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(54073)),n=r(84337),s=a(r(11018)),o=!1,l=(0,i.default)((()=>o=!1),500),d={id:function(){var e=r(66239),t=e.getBrowserId();if(t)return t;var a=new Uint8Array(16);return self.crypto.getRandomValues(a),t=(0,n.encodeB64)(a),e.setBrowserId(t),t},info:function(){var e=s.default.parser.getResult();return{os:e.os.name,version:e.os.version,name:e.browser.name,ua:e.browser.name+" "+e.browser.version}},hardRefresh:function(e,t=!0){(this.promptUnloadGuards++,e)&&r(66239).setNoTakeover(!0);location.reload(t)},startDownloading:function(){o=!0,l()},clearDownloading:function(){o=!1},isDownloading:function(){return o},promptUnloadGuards:0,open:function(e){window.open(e,"_blank","noopener,noreferrer")}};t.default=d},41026:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.intToBytes=function(e,t){for(var r=t,a=new Uint8Array(e),i=e-1;i>=0;i--)a[i]=255&r,r>>>=8;return a},t.uint8ArrayToBuffer=function(e){return e.buffer.slice(e.byteOffset,e.byteLength+e.byteOffset)}},95754:()=>{!function(e){var t=e.HTMLCanvasElement&&e.HTMLCanvasElement.prototype,r=e.Blob&&function(){try{return Boolean(new Blob)}catch(e){return!1}}(),a=r&&e.Uint8Array&&function(){try{return 100===new Blob([new Uint8Array(100)]).size}catch(e){return!1}}(),i=e.BlobBuilder||e.WebKitBlobBuilder||e.MozBlobBuilder||e.MSBlobBuilder,n=(r||i)&&e.atob&&e.ArrayBuffer&&e.Uint8Array&&function(e){var t,n,s,o,l,d,u,c,p;if(!(t=e.match(/^data:((.*?)(;charset=.*?)?)(;base64)?,/)))throw new Error("invalid data URI");for(n=t[2]?t[1]:"text/plain"+(t[3]||";charset=US-ASCII"),s=!!t[4],o=e.slice(t[0].length),l=s?atob(o):decodeURIComponent(o),d=new ArrayBuffer(l.length),u=new Uint8Array(d),c=0;c<l.length;c+=1)u[c]=l.charCodeAt(c);return r?new Blob([a?u:d],{type:n}):((p=new i).append(d),p.getBlob(n))};e.HTMLCanvasElement&&!t.toBlob&&(t.mozGetAsFile?t.toBlob=function(e,r,a){a&&t.toDataURL&&n?e(n(this.toDataURL(r,a))):e(this.mozGetAsFile("blob",r))}:t.toDataURL&&n&&(t.toBlob=function(e,t,r){e(n(this.toDataURL(t,r)))})),e.dataURLtoBlob=n}(window)},2537:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.upload=A,t.uploadUserReport=function(){return w.apply(this,arguments)},t.sendLogs=function(){return R.apply(this,arguments)};var i=a(r(70417)),n=a(r(52954)),s=a(r(12436)),o=a(r(22331)),l=a(r(13277)),d=a(r(79435)),u=a(r(23045)),c=r(66239),p=r(79702),h=a(r(94854)),f=a(r(84161)),_=a(r(569)),m=a(r(22006)),g=a(r(61490)),v=a(r(1876)),E=a(r(20468)),y=e=>new Promise((t=>setTimeout(t,e))),S=r(28103)({CRASHLOG:"crashlog",SUPPORT:"support"}),T=(0,s.default)(C,u.default.LOG_UPLOAD_INTERVAL);function A(){return b.apply(this,arguments)}function b(){return(b=(0,n.default)((function*({reason:e,immediate:t=!1,force:r=!1,persist:a=!1,isHighPri:i=!1,nativeCrash:n,voipLog:s,skipSampling:o=!1,hasTaggedMessage:c=!1,ticketId:h}){var f=a?S.SUPPORT:S.CRASHLOG;l.default.logSocketSummary(),__LOG__(2)`Focus at time of upload:`,_.default.pprint(),__LOG__(2)`==================================================`,__LOG__(2)`wa:uploadLogs ref: ${d.default.ref||"no conn"}`,__LOG__(2)`wa:uploadLogs hash: ${u.default.LATEST_HASH}`,__LOG__(2)`wa:uploadLogs version: ${u.default.VERSION_BASE}`,__LOG__(2)`wa:uploadLogs userAgent: ${navigator.userAgent}`,__LOG__(2)`wa:uploadLogs platform: ${d.default.platform||"no platform"}`,__LOG__(2)`wa:uploadLogs webPlatform: ${u.default.FLB_PLATFORM||"web"}`,__LOG__(2)`wa:uploadLogs appId: ${u.default.APP_ID}`,__LOG__(2)`wa:uploadLogs url: ${location.href}`,__LOG__(2)`wa:uploadLogs distribution: ${(0,p.getDistribution)()}`,__LOG__(2)`wa:uploadLogs mdOptIn: ${E.default.supportsFeature(E.default.F.MD_BACKEND)}`,c&&__LOG__(2)`wa:uploadLogs hasTaggedMessage`;var m=null;if(void 0===e)f=S.SUPPORT,__LOG__(2)`reason for logs: manual-upload`,m=!0;else if(e){var g=e;E.default.supportsFeature(E.default.F.MD_BACKEND)&&(g=`[MD] ${e}`),__LOG__(2)`reason for logs: ${g}`}__LOG__(2)`==================================================`;var v=C;if(!m&&!r){if(!(Math.random()<u.default.UPLOAD_TO_CLB))return void __LOG__(2)`wa:uploadLogs squelched logs`;v=T}try{return yield v({isHighPri:i,immediate:t,logType:f,nativeCrash:n,voipLog:s,skipSampling:o,ticketId:h})}catch(e){__LOG__(2)`wa:uploadLogs error uploading: ${e}`}}))).apply(this,arguments)}function C(){return P.apply(this,arguments)}function P(){return(P=(0,n.default)((function*({isHighPri:e,immediate:t,logType:r,nativeCrash:a,voipLog:i,skipSampling:n=!1,ticketId:s}){yield y(t?0:500);var l=O({isHighPri:e}),d=yield v.default.post(M(r),l);o.default.equal(d.status,200);var u=O({isHighPri:e}),c=(yield h.default.getLogs()).join("\n"),p=new Blob([c],{type:"text/plain"});u.append("file",p,"logs.txt"),s&&u.append("ticket_id",s),a&&(u.append("attachment",new Blob([a.contents],{type:"application/octet-stream"}),a.filename),u.set("agent",a.agent),u.append("tags","electron_native"),i&&u.append("voip_log",new Blob([i.contents],{type:"text/plain"}),i.filename));var f=yield v.default.post(I(r),u);return o.default.equal(f.status,200),f.getResponseHeader("X-Uploaded-File-Id")}))).apply(this,arguments)}function O({isHighPri:e}){var t=new FormData;e&&t.append("forced","true");var a=(0,c.getMe)();a&&(t.append("from",a.user),t.append("from_jid",a.toString()));var i=r(92082).default.info(),n=(0,p.getLogUserAgent)({device:i.os,browser:i.ua,appVersion:u.default.VERSION_BASE});return t.append("agent",n),t.append("app_id",u.default.APP_ID),E.default.supportsFeature(E.default.F.MD_BACKEND)&&t.append("md_opt_in","true"),t}function w(){return(w=(0,n.default)((function*(e,t,r,a,n){try{__LOG__(2)`CLB:uploadUserReport uploading`,__LOG__(2,!0)`CLB:uploadUserReport description: ${a}`;var s=yield A({reason:"user-report",immediate:!0,force:!0,persist:!0}),o=(0,c.getLoginTokens)().server,l=new FormData;o&&l.append("tok",o),null!=e&&l.append("user",String(e)),l.append("email",t),s&&l.append("crashlog",s),l.append("desc",a),n.map(((e,t)=>{l.append(`screenshot-${t}`,e)})),g.default.initialize();var p=(0,i.default)((0,i.default)({subject:r},f.default.Global.all),{},{webcWebPlatform:u.default.FLB_PLATFORM,webcPhonePlatform:d.default.platform,webcProtoVersion:String(d.default.protoVersion)}),h=(0,c.getMe)();h&&(p.deviceID=h.toString());var _={};for(var m in p){var E=p[m];null!=E&&(_[m]=E)}l.append("info",JSON.stringify(_)),__LOG__(2)`CLB:uploadUserReport submitting`,yield v.default.post(u.default.TICKET_URL,l),__LOG__(2)`CLB:uploadUserReport succeeded`}catch(e){__LOG__(2)`CLB:uploadUserReport failed ${String(e)}`}}))).apply(this,arguments)}function M(e){return m.default.build(u.default.FB_CLB_CHECK_URL,{type:String(e),access_token:u.default.FB_CLB_TOKEN})}function I(e){return m.default.build(u.default.FB_CLB_URL,{type:String(e),access_token:u.default.FB_CLB_TOKEN})}function R(){return(R=(0,n.default)((function*(e){yield A({reason:e,hasTaggedMessage:!0})}))).apply(this,arguments)}},99461:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.HOUR24_FORMAT_CHANGE_EVENT=t.SKEW_CHANGE_EVENT=void 0;var i=a(r(70417)),n=a(r(19034)),s=r(15195),o=a(r(23045)),l=a(r(71107)),d=a(r(38637)),u=["fi","id","ms","ms-my"],c="skew_change";t.SKEW_CHANGE_EVENT=c;var p="hour24_format_change";t.HOUR24_FORMAT_CHANGE_EVENT=p;class h extends l.default{constructor(){if(super(),this.is24h=!1,this.skewMS=0,this.skew=0,Intl&&Intl.DateTimeFormat&&Intl.DateTimeFormat().resolvedOptions){var e=Intl.DateTimeFormat().resolvedOptions().timeZone;switch(e?__LOG__(2)`Intl.DateTimeFormat().resolvedOptions().timeZone is ${e}`:__LOG__(2)`Intl.DateTimeFormat().resolvedOptions().timeZone does not exist`,e){case"America/Sao_Paulo":this.timeZoneHardCode="America/Belem";break;case"America/Campo_Grande":case"America/Cuiaba":this.timeZoneHardCode="America/Porto_Velho"}}}getIs24Hour(){return this.is24h}setIs24Hour(e){e!==this.is24h&&(this.is24h=e,this.trigger(p))}setIs24HourBasedOnLocale(){this.setIs24Hour(s.LOCALES_THAT_PREFER_24HOUR_TIME.has(d.default.getLocale()))}setSkew(e){Math.abs(e)>6e4&&__LOG__(2)`Setting large clockskew: ${e}ms`;var t=this.skewMS;this.skewMS=e,this.skew=Math.round(e/1e3),Math.abs(t-this.skewMS)>1e3&&this.trigger(c)}getSkew(){return this.skew}localUnixTime(e){return void 0!==e?e+this.skew:Math.floor(Date.now()/1e3)}globalUnixTime(e){return void 0!==e?e-this.skew:Math.floor((Date.now()-this.skewMS)/1e3)}relativeStr(e){var t=e+this.skew;return t>=(0,n.default)().startOf("day").unix()?this._timestampStr(t):this._dateRelativeStr(t,!1)}relativeDateStr(e){return this._dateRelativeStr(e+this.skew,!1)}relativeDateAndTimeStr(e){return this._dateRelativeStr(e+this.skew,!0)}timeStr(e){if(this.shouldUseIntlDateTimeFormat()){var t=1e3*(e+this.skew),r={hour12:!this.is24h,hour:"numeric",minute:"numeric"},a={year:"numeric",month:"numeric",day:"numeric"};return null!=this.timeZoneHardCode&&(r=(0,i.default)((0,i.default)({},r),{},{timeZone:this.timeZoneHardCode}),a=(0,i.default)((0,i.default)({},a),{},{timeZone:this.timeZoneHardCode})),`${Intl.DateTimeFormat(n.default.locale(),r).format(t)}, ${Intl.DateTimeFormat(n.default.locale(),a).format(t)}`}return n.default.unix(e+this.skew).format(this.is24h?`HH${this._hmsSeparator()}mm, l`:"LT, l")}timestampStr(e){return this._timestampStr(e+this.skew)}timestampStrFormat(){return this.is24h?`HH${this._hmsSeparator()}mm`:"LT"}timestampHour(e){var t=e+this.skew,r=n.default.unix(t).hour();return this.is24h?r:r%12}createdStr(e,t){var r=this.daysDelta(e),a=e+this.skew,i=this._timestampStr(a);if(0===r)return t?d.default.t(1622,{time:i}):d.default.t(1621,{time:i});if(1===r)return t?d.default.t(1626,{time:i}):d.default.t(1625,{time:i});if(r<7){var n=this._dateRelativeStr(a,!1);return t?d.default.t(1624,{day:n,time:i}):d.default.t(1623,{day:n,time:i})}var s=this._dateRelativeStr(a,!1);return t?d.default.t(1620,{date:s,time:i}):d.default.t(1619,{date:s,time:i})}untilStr(e){if(e===o.default.MUTE_ALWAYS_EXPIRATION_SENTINEL)return d.default.t(1002);var t=this.daysDelta(e),r=e+this.skew,a=this._timestampStr(r);if(0===t)return d.default.t(1391,{time:a});if(1===t)return d.default.t(1392,{time:a});if(t<7){var i=this._dateRelativeStr(r,!1);return d.default.t(1393,{day:i,time:a})}var n=this._dateRelativeStr(r,!1);return d.default.t(1390,{date:n,time:a})}lastSeenStr(e){var t=this.daysDelta(e),r=e+this.skew,a=this._timestampStr(r);if(0===t)return d.default.t(1581,{time:a});if(1===t)return d.default.t(1583,{time:a});if(t<7){var i=this._dateRelativeStr(r,!1);return d.default.t(1582,{date:i,time:a})}var n=this._dateRelativeStr(r,!1);return d.default.t(1580,{date:n,time:a})}daysDelta(e,t){var r=n.default.unix(e).startOf("day"),a=(void 0===t?(0,n.default)().startOf("day"):n.default.unix(t).startOf("day")).diff(r,"days");return Math.abs(a)}durationStr(e){var t="string"==typeof e?parseInt(e,10):e,r=n.default.utc(1e3*t);if(r.isValid()){var a=t<3600?"m:ss":"H:mm:ss";return r.format(a)}return""}paymentTimestampStr(e){var t=e+this.skew,r=n.default.unix(t),a=r.startOf("day"),i=(0,n.default)().startOf("day").diff(a,"days");if(0===i)return d.default.t(1833);if(1===i)return d.default.t(1859);if(!(i<7)){var s=r.format("MMMM d");return d.default.t(1768,{date:s})}switch(r.day()){case 0:default:return d.default.t(1769);case 1:return d.default.t(1766);case 2:return d.default.t(1771);case 3:return d.default.t(1772);case 4:return d.default.t(1770);case 5:return d.default.t(1765);case 6:return d.default.t(1767)}}liveLocationLastUpdatedStr(e){var t=e+this.skew,r=this._timestampStr(t),a=n.default.unix(t).startOf("day"),i=(0,n.default)().startOf("day").diff(a,"days");if(0===i)return d.default.t(846,{time:r});if(1===i)return d.default.t(848,{time:r});if(i<6){var s=this._dateRelativeStr(t,!1);return d.default.t(847,{date:s,time:r})}var o=this._dateRelativeStr(t,!1);return d.default.t(845,{date:o,time:r})}_timestampStr(e){if(this.shouldUseIntlDateTimeFormat()){var t={hour12:!this.is24h,hour:"numeric",minute:"numeric"};null!=this.timeZoneHardCode&&(t=(0,i.default)((0,i.default)({},t),{},{timeZone:this.timeZoneHardCode}));var r=Intl.DateTimeFormat(n.default.locale(),t).format(1e3*e);return this.is24h?r.replace(/^24/,"00"):r.replace(/^0/,"12")}return n.default.unix(e).format(this.timestampStrFormat())}_dateStr(e){if(this.shouldUseIntlDateTimeFormat()){var t={year:"numeric",month:"numeric",day:"numeric"};return null!=this.timeZoneHardCode&&(t=(0,i.default)((0,i.default)({},t),{},{timeZone:this.timeZoneHardCode})),Intl.DateTimeFormat(n.default.locale(),t).format(1e3*e)}return n.default.unix(e).format("l")}_dateRelativeStr(e,t){var r=(0,n.default)().startOf("day"),a=n.default.unix(e).startOf("day"),i=r.diff(a,"days"),s=this._timestampStr(e);if(0===i)return t?d.default.t(1834,{time:s}):d.default.t(1833);if(1===i)return t?d.default.t(1860,{time:s}):d.default.t(1859);if(!t&&Math.abs(i)<7)return n.default.unix(e).format("dddd");var o=this._dateStr(e);return t?d.default.t(1832,{date:o,time:s}):o}_hmsSeparator(){var e=n.default.locale();return u.includes(e)?".":":"}shouldUseIntlDateTimeFormat(){return Intl&&Intl.DateTimeFormat&&!s.LOCALE_DATE_TIME_CUSTOMIZATIONS[n.default.locale()]&&!s.SHOULD_USE_MOMENT_LOCALE_FORMAT.has(n.default.locale())}}var f=new h;t.default=f},37888:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.resetCompanionReg=function(){h=!1,f=!1},t.startLogin=function(){if(h||f)return;(0,d.setDeviceLinkPairStage)(c.default.MD_LINK_DEVICE_COMPANION_STAGE.FIRST_CONNECT),h=!0,(0,o.clearADVSecretKey)(),l.default.restartBackend()},t.startLogout=m,t.logoutAfterValidationFail=function(){new s.ShiftTimer((()=>{m()})).onOrAfter(1e3)},t.startInitialHistorySyncTimeout=function(){if(null==i){i=setTimeout(_,12e4),(new u.default).listenTo(l.default,"on_initial_chat_synced",(()=>{clearTimeout(i)}))}};var i,n=a(r(52954)),s=r(35160),o=r(70338),l=a(r(13277)),d=r(11247),u=a(r(71107)),c=a(r(84161)),p=a(r(15934)),h=!1,f=!1;function _(){__LOG__(4,void 0,new Error)`initialHistorySyncTimeout - logout due to no history data`,p.default.logout()}function m(){return g.apply(this,arguments)}function g(){return(g=(0,n.default)((function*(){h||f||(f=!0,yield p.default.clearCredentialsAndStoredData(),(0,o.clearADVSecretKey)(),l.default.restartBackend())}))).apply(this,arguments)}},60508:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r="animation",a="transition",i={_normalize:function(e,t,r){var a=e.toLowerCase().indexOf(t),i=e.slice(0,a).toLowerCase();return 0===e.indexOf(t)?i+e.slice(a)+r.toLowerCase():i+e.slice(a)+r},prefix:function(e,t){var i;if(0===e.indexOf(r)){i=e.substring(r.length);var n=window.Modernizr?window.Modernizr.prefixed(r):r;return this._normalize(n,r,i)}if(0===e.indexOf(a)){i=e.substring(a.length);var s=window.Modernizr?window.Modernizr.prefixed(a):a;return this._normalize(s,a,i)}return window.Modernizr.prefixed(e,t,!1)||e}};t.default=i},80206:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(71436);class i extends((0,a.customError)("ContactBlocked")){constructor(e,t){super(e),this.contact=t}}t.default=i},91354:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setCookie=function(e){e.session&&delete e.expirationDate;var t=[];["name","value","domain","path","secure","session","expirationDate"].forEach((r=>{var a=e[r];if(void 0!==a&&"value"!==r)switch(r){case"expirationDate":var i=new Date(e.expirationDate);t.push(`expires=${i.toUTCString()}`);break;case"secure":t.push("secure");break;case"name":var n=e.value||"";t.push(`${String(a)}=${n}`);break;default:t.push(`${r}=${String(a)}`)}})),document.cookie=t.join(";")},t.getCookie=function(e){var t=document.cookie.match(new RegExp("(^| )"+e+"=([^;]+)"));return t?t[2]:void 0},t.deleteCookie=function(e){document.cookie=e+"=; expires=Thu, 01 Jan 1970 00:00:01 GMT;"}},54168:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.encryptAndMac=function(e,t,r){return(0,s.aesCbcEncrypt)(e,new Uint8Array(r)).then((e=>new l.default(t).sign(e).then((t=>i.Binary.build(t,e).readBuffer()))))},t.macAndDecrypt=function(e,t,r){return Promise.resolve(new Uint8Array(r)).then((r=>{var a=(0,n.encodeB64)(r.subarray(0,32)),i=r.subarray(32);return new l.default(t).sign(i).then((t=>{var r=(0,n.encodeB64)(t);if(a!==r)throw __LOG__(3)`crypto:macAndDecrypt HMAC don't match ${a} vs. ${r}`,new Error("macAndDecrypt HMAC mismatch");return(0,s.aesCbcDecrypt)(e,i)}))}))},t.alignChunkSizeToMultipleAesBlockSize=d,t.alignChunkLengthsToMultipleOfAesBlockSize=function(e,t){for(var r=[],a=0,i=0,n=0,s=0;s<e.length;++s){if(a+=e[s],s===e.length-1&&null!=t){a>i?r.push(t-i):(r.pop(),r.push(t-n));break}if(a>i){var o=d(a-i);n=i,r.push(o),i+=o}}return r},t.removeEncryptedPadding=function(e,t){var r=e.slice(-t.byteLength);if((0,o.default)(r,t))return e.slice(0,e.byteLength-t.byteLength);return e};var i=r(49244),n=r(84337),s=r(74306),o=a(r(57829)),l=a(r(34601));function d(e){return 16*parseInt((e+15)/16,10)}},74306:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.aesCbcDecrypt=function(e,t){return Promise.resolve().then((()=>{var r=t.slice(0,16),a=t.slice(16),n=o(r);return Promise.resolve(s.default.importKey("raw",(0,i.default)(Uint8Array,e),"AES-CBC",!1,["decrypt"])).then((e=>s.default.decrypt(n,e,a)))}))},t.aesCbcEncrypt=function(e,t,r){return Promise.resolve().then((()=>{var a;r?a=(0,i.default)(Uint8Array,r):(a=new Uint8Array(16),self.crypto.getRandomValues(a));var l=o(a);return Promise.resolve(s.default.importKey("raw",(0,i.default)(Uint8Array,e),"AES-CBC",!1,["encrypt"])).then((e=>s.default.encrypt(l,e,t))).then((e=>(0,n.default)(Uint8Array,[a,new Uint8Array(e)]).buffer))}))};var i=a(r(23977)),n=a(r(28017)),s=a(r(62549));function o(e){return{name:"AES-CBC",iv:(0,i.default)(Uint8Array,e)}}},41059:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(23977)),n=a(r(62549));t.default=class{constructor(e,t){this._algo=e,this._key=(0,i.default)(Uint8Array,t)}sign(e,t){return Promise.resolve(n.default.importKey("raw",this._key,this._algo,!1,["sign"])).then((t=>n.default.sign(this._algo,t,e))).then((e=>null!=t&&0!==t?e.slice(0,t):e))}}},2273:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(41059)),n={name:"HMAC",hash:{name:"SHA-1"}};class s extends i.default{constructor(e){super(n,e)}}t.default=s},34601:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(41059)),n={name:"HMAC",hash:{name:"SHA-256"}};class s extends i.default{constructor(e){super(n,e)}}t.default=s},66025:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(41059)),n={name:"HMAC",hash:{name:"SHA-512"}};class s extends i.default{constructor(e){super(n,e)}}t.default=s},55292:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.LT_HASH_ANTI_TAMPERING=t.default=t.EMPTY_LT_HASH=t.KEY_LENGTH_BYTES=void 0;var n=i(r(52954)),s=a(r(25212)),o=128;t.KEY_LENGTH_BYTES=o;var l=new ArrayBuffer(o);t.EMPTY_LT_HASH=l;class d{constructor(e){this.salt=e}add(e,t){var r=this;return t.reduce(function(){var e=(0,n.default)((function*(e,t){return r._addSingle(yield e,t)}));return function(){return e.apply(this,arguments)}}(),Promise.resolve(e))}subtract(e,t){var r=this;return t.reduce(function(){var e=(0,n.default)((function*(e,t){return r._subtractSingle(yield e,t)}));return function(){return e.apply(this,arguments)}}(),Promise.resolve(e))}subtractThenAdd(e,t,r){var a=this;return(0,n.default)((function*(){return a.add(yield a.subtract(e,r),t)}))()}_addSingle(e,t){var r=this;return(0,n.default)((function*(){var a=yield s.extractAndExpand(t,r.salt,o);return r.performPointwiseWithOverflow(e,a,((e,t)=>e+t))}))()}_subtractSingle(e,t){var r=this;return(0,n.default)((function*(){var a=yield s.extractAndExpand(t,r.salt,o);return r.performPointwiseWithOverflow(e,a,((e,t)=>e-t))}))()}performPointwiseWithOverflow(e,t,r){for(var a=new DataView(e),i=new DataView(t),n=new ArrayBuffer(a.byteLength),s=new DataView(n),o=0;o<a.byteLength;o+=2)s.setUint16(o,r(a.getUint16(o,!0),i.getUint16(o,!0)),!0);return n}}t.default=d;var u=new d("WhatsApp Patch Integrity");t.LT_HASH_ANTI_TAMPERING=u},73950:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return Promise.resolve(n.default.digest({name:"SHA-256"},e).then(i.encodeB64))};var i=r(84337),n=a(r(62549))},47397:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r="whatsapp is da best",a=new Uint8Array(r.split("").map((e=>e.charCodeAt(0)))),i={name:"HMAC",hash:"SHA-256"},n={name:"AES-CBC",length:256},s={name:"ECDH",namedCurve:"P-256"};function o(){return Promise.resolve().then((()=>self.crypto.subtle||self.crypto.webkitSubtle))}var l={supportsHmacSha256:function(){return o().then((e=>e.generateKey(i,!1,["sign","verify"]).then((t=>e.sign(i,t,a).then((r=>e.verify(i,t,r,a.buffer))).catch((e=>(__LOG__(2)`CryptoSupport:HMAC-SHA256 signing failed: ${e}`,!1))).then((e=>e?(__LOG__(2)`CryptoSupport:HMAC-SHA256 is verified`,!0):(__LOG__(2)`CryptoSupport:HMAC-SHA256 is not verified`,!1))).catch((e=>(__LOG__(2)`CryptoSupport:HMAC-SHA256 verification failed: ${e}`,!1))))).catch((e=>(__LOG__(2)`CryptoSupport:HMAC-SHA256 key generation failed: ${e}`,!1))))).catch((e=>(__LOG__(2)`CryptoSupport:HMAC-SHA256: ${e}`,!1)))},supportsAesCbc:function(){return o().then((e=>e.generateKey(n,!1,["encrypt","decrypt"]).then((t=>Promise.resolve(self.crypto).then((e=>({name:"AES-CBC",iv:e.getRandomValues(new Uint8Array(16))}))).then((i=>e.encrypt(i,t,a).then((r=>e.decrypt(i,t,r))).catch((e=>(__LOG__(2)`CryptoSupport:AES-CBC encryption failed: ${e}`,!1))).then((e=>{var t,a=new Uint8Array(e);return t=a,Array.prototype.slice.call(t).map((e=>String.fromCharCode(e))).join("")===r?(__LOG__(2)`CryptoSupport:AES-CBC encryption/decryption is correct`,!0):(__LOG__(2)`CryptoSupport:AES-CBC encryption/decryption is incorrect`,!1)})).catch((e=>(__LOG__(2)`CryptoSupport:AES-CBC decryption failed: ${e}`,!1))))))).catch((e=>(__LOG__(2)`CryptoSupport:AES-CBC key generation failed: ${e}`,!1))))).catch((e=>(__LOG__(2)`CryptoSupport:AES-CBC: ${e}`,!1)))},supportsEcdh:function(){return o().then((e=>e.generateKey(s,!1,["deriveKey"]).then((t=>e.generateKey(s,!1,["deriveKey"]).then((r=>{var a={name:"ECDH",namedCurve:"P-256",public:r.publicKey};return e.deriveKey(a,t.privateKey,n,!1,["encrypt","decrypt"]).then((()=>(__LOG__(2)`CryptoSupport:ECDH key derivation succeeded`,!0))).catch((e=>(__LOG__(2)`CryptoSupport:ECDH key derivation failed: ${e}`,!1)))})).catch((e=>(__LOG__(2)`CryptoSupport:ECDH key generation #2 failed: ${e}`,!1))))).catch((e=>(__LOG__(2)`CryptoSupport:ECDH key generation #1 failed: ${e}`,!1))))).catch((e=>(__LOG__(2)`CryptoSupport:ECDH: ${e}`,!1)))},supportsWebCrypto:function(){return this.webCryptoPromise||(this.webCryptoPromise=Promise.all([this.supportsHmacSha256(),this.supportsAesCbc()])),this.webCryptoPromise.spread(((e,t)=>Promise.resolve(e&&t)))}};t.default=l},446:(e,t,r)=>{"use strict";var a;Object.defineProperty(t,"__esModule",{value:!0}),t.keyPair=function(e){var t;void 0===e?(t=new Uint8Array(32),self.crypto.getRandomValues(t)):t=new Uint8Array(e);return t[0]&=248,t[31]&=127,t[31]|=64,l({pubKey:32,privKey:t,basepoint:i},(function(e){var r=a._curve25519_donna(e.pubKey,e.privKey,e.basepoint);if(r)throw new Error(`Curve25519:keyPair Error Code ${r}`);return{pubKey:o(e.pubKey,32),privKey:t.buffer}}))},t.sharedSecret=function(e,t){return Promise.resolve().then((()=>l({sharedKey:32,pubKey:e,privKey:t},(function(e){var t=a._curve25519_donna(e.sharedKey,e.privKey,e.pubKey);if(t)throw new Error(`Curve25519:sharedSecret Error Code ${t}`);return o(e.sharedKey,32)}))))},t.toSignalCurveKeyPair=function(e){if(32!==e.pubKey.byteLength||32!==e.privKey.byteLength)throw new Error("Invalid key pair type");var t=n(e.pubKey),r=new Uint8Array(32);return r.set(new Uint8Array(e.privKey)),{pubKey:t,privKey:r.buffer}},t.toSignalCurvePubKey=n,t.toCurveKeyPair=function(e){if(33!==e.pubKey.byteLength||32!==e.privKey.byteLength)throw new Error("Invalid key pair type");var t=new Uint8Array(32),r=new Uint8Array(32);return t.set(new Uint8Array(e.pubKey).subarray(1)),r.set(new Uint8Array(e.privKey)),{pubKey:t.buffer,privKey:r.buffer}},t.toCurveKeyPubKey=function(e){if(33!==e.byteLength)throw new Error("Invalid key type");var t=new Uint8Array(32);return t.set(new Uint8Array(e).subarray(1)),t.buffer},t.verifySignature=function(e,t,r){if(32!==e.byteLength)throw new Error(`Invalid public key length: ${e.byteLength}`);var a=new Uint8Array(33);return a[0]=5,a.set(e,1),!1===window.libsignal.Curve.verifySignature(a,t,r)};var i=new Uint8Array(32);i[0]=9;function n(e){if(32!==e.byteLength)throw new Error("Invalid key type");var t=new Uint8Array(33);return t[0]=5,t.set(new Uint8Array(e),1),t.buffer}function s(e){if("number"==typeof e)return a._malloc(e);var t=new Uint8Array(e.buffer||e),r=a._malloc(t.length);return a.HEAPU8.set(t,r),r}function o(e,t){var r=new Uint8Array(t);return r.set(a.HEAPU8.subarray(e,e+t)),r.buffer}function l(e,t){a||(a=r(26819));var i={};try{for(var n in e)i[n]=s(e[n]);return t(i)}finally{for(var o in i)a._free(i[o])}}},94095:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.Node=void 0;var i=a(r(12436)),n=a(r(47677));class s{constructor(e,t){this.key=e,this.value=t,this.prev=null,this.next=null}}t.Node=s;t.default=class{constructor(e){var t;this.schedulePurge=(0,i.default)((()=>{this.purgeNow()}),1e3,{leading:!1}),this._keyToNode={},this._sizeLimit=e.sizeLimit,this._getSize=e.getSize,this._onPurge=e.onPurge,this._shouldEvict=null!==(t=e.shouldEvict)&&void 0!==t?t:()=>!0,this._onEvict=e.onEvict,this._onAdd=e.onAdd,this._onDelete=e.onDelete,this._currentSize=0,this._dummyHead=new s("dummy-head",null),this._dummyTail=new s("dummy-tail",null),this._dummyHead.next=this._dummyTail,this._dummyTail.prev=this._dummyHead}get(e){if(!this._keyToNode.hasOwnProperty(e))return null;var t=this._keyToNode[e];if(null==t)return null;var r=t.prev,a=t.next;r&&(r.next=a),a&&(a.prev=r);var i=this._dummyHead.next;if(null==i)throw new Error("The linked list is not constructed properly.");return this._dummyHead.next=t,i.prev=t,t.prev=this._dummyHead,t.next=i,t.value}has(e){return this._keyToNode.hasOwnProperty(e)}touch(e){this.get(e)}put(e,t){0!==this._sizeLimit&&(this._getSize(t)>this._sizeLimit?__LOG__(3)`Blob size is larger than the limit of the whole store.`:(this.delete(e),this._add(e,t),this.schedulePurge()))}_add(e,t){var r=new s(e,t);this._keyToNode[e]=r;var a=this._dummyHead.next;if(null==a)throw new Error("The linked list is not constructed properly.");this._dummyHead.next=r,a.prev=r,r.prev=this._dummyHead,r.next=a,this._currentSize+=this._getSize(t),this._onAdd&&this._onAdd(e,t)}delete(e){if(this._keyToNode.hasOwnProperty(e)){var t=this._keyToNode[e];if(null!=t){this._currentSize-=this._getSize(t.value);var r=t.prev,a=t.next;r&&(r.next=a),a&&(a.prev=r),delete this._keyToNode[e],this._onDelete&&this._onDelete(e,t.value)}}}clear(){this._keyToNode={},this._currentSize=0,this._dummyHead.next=this._dummyTail,this._dummyTail.prev=this._dummyHead,this._onClear&&this._onClear()}purgeNow(){for(var e=this._dummyTail.prev;this._currentSize>this._sizeLimit&&e!==this._dummyHead;e=e?e.prev:null){(0,n.default)(null!=e,"The linked list is not constructed properly.");var{key:t,value:r}=e;this._shouldEvict(t,r)&&(this.delete(t),this._onEvict&&this._onEvict(t,r))}this._onPurge&&this._onPurge(this._keyToNode)}}},49702:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default=class{constructor(e,t){this._valueFn=e,this._heap=[],this._load(t)}_load(e){e&&e.length&&e.forEach((e=>{this.push(e)}))}_swap(e,t){var r=this._heap[t];this._heap[t]=this._heap[e],this._heap[e]=r}_siftUp(e=0){if(0!==e){var t=this._getParent(e),r=2*t+1,a=2*t+2,i=this._heap.length;if(!(e>=i)){var n=this._getVal(t),s=t;if(r<i){var o=this._getVal(r);n>o&&(s=r,n=o)}if(a<i)n>this._getVal(a)&&(s=a);s!==t&&(this._swap(s,t),this._siftUp(t))}}}_doHeapify(e=0){var t=2*e+1,r=2*e+2,a=this._heap.length;if(!(e>=a)){var i=this._getVal(e),n=e;if(t<a){var s=this._getVal(t);i>s&&(n=t,i=s)}if(r<a)i>this._getVal(r)&&(n=r);n!==e&&this._swap(n,e),t<a&&this._doHeapify(t),r<a&&this._doHeapify(r)}}_getVal(e){return this._valueFn(this._heap[e])}_getParent(e){return e%2==0?(e-2)/2:(e-1)/2}push(e){this._heap.push(e);var t=this._heap.length-1;this._siftUp(t)}pull(){var e=this._heap.shift();return this.heapify(),e}heapify(){this._doHeapify(0)}peek(){return this._heap[0]}}},96800:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(21830));class n{constructor(e){this._children={},this._indices=[],e&&(this._data=e)}static fromBackwardsStrings(e,t){return e.reduce(((e,t,r)=>e.addBackwardsString(t,r)),new n(t))._optimize()}addBackwardsString(e,t){for(var r=e.length-1,a=this;r>=0;){var i=e.charAt(r);a._addIndex(t),a=a.get(i)||a.set(i,new n),r--}return a._addIndex(t),this}static fromForwardsStrings(e,t){return e.reduce(((e,t,r)=>e.addForwardsString(t,r)),new n(t))._optimize()}addForwardsString(e,t){for(var r=0,a=this;r<e.length;){var i=e.charAt(r);a._addIndex(t),a=a.get(i)||a.set(i,new n),r++}return a._addIndex(t),this}set(e,t){return this._children[e]=t,t}get(e){return this._children[e]}getChildren(){return Object.keys(this._children).map((e=>({prefix:e,node:(0,i.default)(this.get(e),"this.get(prefix)")})))}hasChildren(){return!function(e){for(var t in e)return!1;return!0}(this._children)}search(e){var t=this._data;if(!t)return[];for(var r=this,a=0;a<e.length&&r;a++){var i=e[a];r=r.get(i)}return r?r.getIndices().map((e=>t[e])):[]}_addIndex(e){this._indices.push(e)}getIndices(){var e=this._indices,t=Object.keys(this._children);return 1===t.length&&0===this._indices.length?this._children[t[0]].getIndices():e}_optimize(){if(!this.hasChildren())return this;var e=Object.keys(this._children),t=this._children[e[0]]._indices;return e.forEach((e=>{this._children[e]._optimize()})),1===e.length&&this._indices.length===t.length&&(this._indices=[]),this}testOnlyGetChildrenProperty(){return this._children}testOnlyGetIndicesProperty(){return this._indices}}t.default=n},78086:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(52954)),n=a(r(15253)),s=a(r(77715)),o=a(r(19034)),l=a(r(23045)),d=a(r(48879)),u=a(r(84161)),c=a(r(21830)),p=a(r(43419)),h=r(61864),f=a(r(11018)),_={ERROR:"error",OPENING:"opening",BLOCKED:"blocked",OPEN:"open",CLOSED:"closed",FAILED:"failed"},m=!1,g=null;function v(){this.initializeStorage(),this._dbName="wawc",this._db=new s.default(this._dbName),this._db.on("versionchange",(e=>{e&&null!=e.newVersion&&e.newVersion!==e.oldVersion&&(m=!0,g&&g())})),this._db.version(1).stores({logs:"line,log"}),this._db.version(2).stores({logs:"line,log",assets:"key,hash,data"}),this._db.version(3).stores({logs:"line,log",assets:"key,hash,data",wam:",buffer,prevValues,lastSend"}),this._db.version(4).stores({logs:"line,log",assets:"key,hash,data",wam:",key,buffer",l10n:"key,hash,t"}).upgrade((function(e){e.wam.toCollection().modify((function(e){e.key=e.lastSend,delete e.prevValues,delete e.lastSend}))})),this._db.version(5).stores({logs:"line,log",assets:null,wam:",key,buffer",l10n:"key,hash,t"}),this._db.version(6).stores({logs:"line,log,timestamp",wam:",key,buffer",l10n:"key,hash,t"}).upgrade((e=>{e.logs.toCollection().count().then((()=>{e.logs.toCollection().modify((e=>{var{log:t}=e;e.timestamp=1e3*(0,o.default)(t.slice(5,28),"YYYY-MM-DD HH:mm:ss.SSS").unix()}))}))})),this._db.version(7).stores({logs:"line,log,timestamp",wam:",key,buffer",l10n:"key,hash,t",user:"key"}),this.openAttempt=0,this.openDB().catch((e=>{__LOG__(3)`openDB failed: ${e}`})),this._dbState=_.OPENING}class E{constructor(){this.dataStore={}}setItem(e,t){this.dataStore[e]=t,null!=d.default&&d.default.setItem(e,t),r(78086).default.idb().then((r=>r.user.put({key:e,value:t}))).catch((e=>{__LOG__(3)`db:setItem:Error ${e}`}))}getItem(e,t=!1){if(void 0===this.dataStore[e]||t){if(null!=d.default){var r=d.default.getItem(e);return null!=r&&this.setItem(e,r),r}return null}return this.dataStore[e]}removeItem(e){delete this.dataStore[e],null!=d.default&&d.default.removeItem(e),r(78086).default.idb().then((t=>t.user.delete(e))).catch((e=>{__LOG__(3)`db:removeItem:Error ${e}`}))}clear(e){var t=this;return(0,i.default)((function*(){t.dataStore={},null!=d.default&&(d.default.clear(),e&&(0,n.default)(e,(function(e,t){d.default.setItem(t,e)})));var a=r(78086).default;yield a.idb().then((e=>e.user.clear())).catch((e=>{__LOG__(3)`db:clear:Error ${e}`}))}))()}}v.prototype.initializeStorage=function(){this.temporaryStorage=this._hasSessionStorage()?{dataStore:{},setItem:function(e,t){this.dataStore[e]=t,(0,c.default)(p.default,"sessionStorage").setItem(e,t)},getItem:function(e,t=!1){return null==this.dataStore[e]||t?(0,c.default)(p.default,"sessionStorage").getItem(e):this.dataStore[e]},removeItem:function(e){delete this.dataStore[e],(0,c.default)(p.default,"sessionStorage").removeItem(e)},clear:function(){return this.dataStore={},(0,c.default)(p.default,"sessionStorage").clear(),Promise.resolve()}}:{dataStore:{},setItem:function(e,t){this.dataStore[e]=t},getItem:function(e){return void 0===this.dataStore[e]?null:this.dataStore[e]},removeItem:function(e){delete this.dataStore[e]},clear:function(){return this.dataStore={},Promise.resolve()}},this.permanentStorage=new E},v.prototype._hasSessionStorage=function(){try{var e=(0,c.default)(p.default,"sessionStorage");return e.setItem(l.default.KEY_STORAGE_TEST,l.default.KEY_STORAGE_TEST),(0,h.isFunction)(e.clear)}catch(e){return!1}},v.prototype.loadUserIdb=function(){return this.idb().then((e=>e.transaction("rw",e.user,(()=>e.user.toArray().then((e=>e.forEach((e=>{this.permanentStorage.dataStore[e.key]=e.value})))))))).catch((e=>{__LOG__(3)`db:loadUserIdb:Error ${e}`}))},v.prototype.openDB=function(){this._db.isOpen()&&this._db.close();var e=Promise.resolve(this._db.open()).timeout(1e4).then((()=>(__LOG__(2)`db: Successfully opened db`,new u.default.WebcDbOpen({webcDbName:this._dbName,webcDbOpenWasSuccess:!0,webcDbOpenNumAttempts:this.openAttempt}).commit(),this._dbState=_.OPEN,_.OPEN))).catchType(Promise.TimeoutError,(()=>(__LOG__(2)`db:openDB blocked`,new u.default.WebcDbOpen({webcDbName:this._dbName,webcDbOpenWasSuccess:!1,webcDbOpenNumAttempts:this.openAttempt}).commit(),this._dbState=_.BLOCKED,_.BLOCKED))).catch((e=>(__LOG__(3)`db:openDB:Error ${e}`,this.openAttempt>1||f.default.isSafari?(this.opening=void 0,this._dbState=_.ERROR,new u.default.WebcDbOpen({webcDbName:this._dbName,webcDbOpenWasSuccess:!1,webcDbOpenNumAttempts:this.openAttempt}).commit(),Promise.reject(_.ERROR)):(this.openAttempt+=1,this._db.delete().catch((e=>(__LOG__(3)`db:deleteDB:Error ${e}`,this.opening=void 0,this._dbState=_.ERROR,Promise.reject(_.ERROR)))).then((()=>this.openDB())))))).then((e=>(this.opening=void 0,e===_.BLOCKED?Promise.reject(_.BLOCKED):this._db)));return this.opening||(this.opening=e),e},v.prototype.idb=function(){return this._db.isOpen()?Promise.resolve(this._db):this._db.hasFailed()?Promise.reject(_.FAILED):this._dbState===_.BLOCKED?Promise.reject(_.BLOCKED):this.opening?this.opening:Promise.reject(_.CLOSED)},v.prototype.onVersionChange=function(e){g=e,m&&g()},v.prototype.State=_;var y=new v;t.default=y},49508:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.DB_ENCRYPTION_CIPHER=t.ENC_KEY_TTL=t.ENC_KEY_TABLE_NAME=t.ENC_KEY_DB_NAME=void 0;var n=i(r(70417)),s=i(r(52954)),o=i(r(77715)),l=a(r(24461)),d=r(14409),u=r(84337),c=r(95334),p=i(r(47677)),h=r(97733).Z,f="wawc_db_enc";t.ENC_KEY_DB_NAME=f;var _="keys";t.ENC_KEY_TABLE_NAME=_;var m={name:"HKDF"},g={hash:"SHA-256"},v=4*c.WEEK_MILLISECONDS*24;t.ENC_KEY_TTL=v;var E="fts_hmac_keys",y="AES-CBC";t.DB_ENCRYPTION_CIPHER=y;function S(){var e=new Uint8Array(128);return self.crypto.getRandomValues(e),self.crypto.subtle.importKey("raw",e,m,!1,["deriveKey"])}var T=new class{constructor(){var e=this;this._waitUntilFinalDbEncKeyReady=new d.Resolvable,this._waitUntilFinalFtsHmacKeyReady=new d.Resolvable,this._getOrUpdateEncKeys=e=>this._getDbOrThrow().keys.orderBy("id").toArray().then((t=>{if(!t||0===t.length)return this._addNewEncKey(e);var r=t[t.length-1]._expiration;if(null!=r&&r<=(new Date).getTime())return this._addNewEncKey(e);this._ephemeralLocalEncSalt=e;var a=t.map(function(){var t=(0,s.default)((function*(t){var r=yield self.crypto.subtle.deriveKey((0,n.default)((0,n.default)((0,n.default)({},m),g),{},{salt:e,info:new Uint8Array(1)}),t.key,{name:y,length:128},!1,["encrypt","decrypt"]);return(0,n.default)((0,n.default)({},t),{},{key:r})}));return function(){return t.apply(this,arguments)}}());return Promise.all(a).then((e=>{this._keys=e}))})),this._getOrUpdateFtsKey=()=>this._getDbOrThrow().fts_hmac_keys.orderBy("id").toArray().then((e=>{if(!e||0===e.length)return this._addNewFtsHMACKey();if(e.length>1)throw new l.DBInvalidFtsHMACKey;this._ftsHMACKey=e[e.length-1]})),this._addNewEncKey=e=>S().then((t=>this._getDbOrThrow().keys.add({key:t,_expiration:(new Date).getTime()+v}).then((()=>this._getOrUpdateEncKeys(e))))),this._addNewFtsHMACKey=()=>S().then((e=>this._getDbOrThrow().fts_hmac_keys.add({key:e}).then((()=>this._getOrUpdateFtsKey())))),this.generateFinalDbEncryptionAndFtsKey=e=>{var t=(0,u.decodeB64)(e);return this._generateFinalFtsHmacKey(t),this._generateFinalDbMsgEncryptionKey(t),Promise.resolve()},this._generateFinalDbMsgEncryptionKey=t=>this._getDbOrThrow().keys.orderBy("id").toArray().then((r=>{var a=r.map(function(){var r=(0,s.default)((function*(r){var a;(0,p.default)(null!=e._ephemeralLocalEncSalt,"DB msg encryption key faiiled due to _ephemeralLocalEncSalt");try{a=yield self.crypto.subtle.deriveKey((0,n.default)((0,n.default)((0,n.default)({},m),g),{},{salt:t,info:new Uint8Array(e._ephemeralLocalEncSalt||0)}),r.key,{name:y,length:128},!1,["encrypt","decrypt"])}catch(t){throw e._ephemeralLocalEncSalt=null,t}return(0,n.default)((0,n.default)({},r),{},{key:a})}));return function(){return r.apply(this,arguments)}}());return Promise.all(a).then((e=>{this._ephemeralLocalEncSalt=null,this._finalDbMsgEncKeys=e,this._waitUntilFinalDbEncKeyReady.resolve()}))})).finally((()=>{this._ephemeralLocalEncSalt=null})),this._generateFinalFtsHmacKey=function(){var t=(0,s.default)((function*(t){if(!e._ftsHMACKey||null==e._ftsHMACKey.key||null==e._ftsHMACKey.id)throw __LOG__(2)`Base ftsHMACKey is null in _generateFinalFtsHmacKey`,new l.DBInvalidFtsHMACKey;var[r,a]=[e._ftsHMACKey.id,e._ftsHMACKey.key],i=yield self.crypto.subtle.deriveKey((0,n.default)((0,n.default)((0,n.default)({},m),g),{},{salt:t,info:new Uint8Array(0)}),a,{name:"HMAC",hash:"SHA-1"},!1,["sign"]);e._finalFtsHmacKey={id:r,key:i},e._waitUntilFinalFtsHmacKeyReady.resolve()}));return function(){return t.apply(this,arguments)}}()}init(e){if(this._db)return h.resolve();this._db=new o.default(f),this._getDbOrThrow().version(1).stores({[_]:"++id, _expirtation",[E]:"++id"});var t=e.buffer.slice(e.byteOffset,e.byteLength+e.byteOffset);return h.resolve(this._getDbOrThrow().open()).then((()=>Promise.all([this._getOrUpdateEncKeys(t),this._getOrUpdateFtsKey()])))}_getDbOrThrow(){if(null==this._db)throw new Error("[db_encryption_key] db is not initialized");return this._db}deleteKeys(){return Promise.all([this._getDbOrThrow().table(_).clear(),this._getDbOrThrow().table(E).clear()]).then((()=>{})).finally((()=>(this._db=null,h.resolve(o.default.delete(f)).catch((()=>o.default.delete(f))))))}deleteKeyCache(){this._keys=null,this._ftsHMACKey=null,this._finalDbMsgEncKeys=null,this._waitUntilFinalDbEncKeyReady=new d.Resolvable,this._waitUntilFinalFtsHmacKeyReady=new d.Resolvable,this._finalFtsHmacKey=null,this._ephemeralLocalEncSalt=null}waitForFinalDbMsgEncKey(){return this._waitUntilFinalDbEncKeyReady.promise}waitForFinalFtsHmacKey(){return this._waitUntilFinalFtsHmacKeyReady.promise}get encKeys(){if(!this._keys)throw new l.DbEncKeyNotLoaded(_);return this._keys}get dbMsgEncKeys(){if(!this._finalDbMsgEncKeys)throw new l.DbMsgEncKeyNotLoaded(_);return this._finalDbMsgEncKeys}get ftsHMACKey(){if(!this._finalFtsHmacKey)throw new l.DbEncKeyNotLoaded(E);return this._finalFtsHmacKey}};t.default=T},70994:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function e(t,r,a){r(t).forEach((t=>e(t,r,a))),a(t)}},48977:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=function(e){if(null==e)return d();if(!(e instanceof Promise))return e;var t=new n.default;e.isFulfilled()||e.isRejected()?t.abort():e.catch((()=>{})).then((()=>{t.abort()}));return t.signal}(e&&e.signal);return new Promise(((e,r)=>{var a,i,n;t.aborted?r(new s.default):(o.push(u),t.addEventListener("abort",c),1===o.length&&(n=requestAnimationFrame((()=>{i=setTimeout((()=>{l()}),0)})),a=()=>{cancelAnimationFrame(n),clearTimeout(i)}));function d(){t.removeEventListener("abort",c);var e=o.indexOf(u);-1!==e&&o.splice(e,1),0===o.length&&null!=a&&(a(),a=null)}function u(){d(),e()}function c(){d(),r(new s.default)}}))},t.resolveAllForTestingOnly=void 0;var i=a(r(25291)),n=a(r(45026)),s=a(r(3599)),o=[];function l(){for(;o.length>0;){o.shift()()}}t.resolveAllForTestingOnly=()=>(l(),Promise.resolve());var d=(0,i.default)((()=>(new n.default).signal))},66617:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.enrich=function(e,t){var r;switch((0,i.previewType)(t)){case"pdf":r=s(e);break;case"msoffice":r=Promise.resolve();break;default:r=Promise.resolve()}return r.timeout(3e3,"Document enrichment timeout").catch((()=>null))},t.enrichPdf=s;var i=r(6353),n=a(r(47683));function s(e){var t;return n.default.fileToPdf(e).then((e=>(t=e,n.default.pdfToImg(e,1)))).catch((()=>(__LOG__(2)`pdf preview generation failed`,null))).finally((()=>{t&&n.default.releasePdf(t)}))}},76170:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,i.default)(e.replace(/^data-/,""))};var i=a(r(96009))},12949:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return e instanceof HTMLElement&&e.tagName.toLowerCase()===t.toLowerCase()}},42954:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(!(e instanceof HTMLElement))return!1;return r.call(e,t)};var r=Element.prototype.matches||Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector},50719:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return Boolean(e&&3===e.nodeType)}},62084:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){if(e.collapsed)return[];if(e.startContainer===e.endContainer)return(0,n.default)(e.startContainer)?[e.startContainer]:Array.prototype.slice.call(e.startContainer.childNodes,e.startOffset,e.endOffset);var t,r,a=e.commonAncestorContainer.childNodes;t=e.commonAncestorContainer===e.startContainer?a[0]:s(e.commonAncestorContainer,e.startContainer);(0,i.default)(t,"range is invalid: start missing"),r=e.commonAncestorContainer===e.endContainer?a[a.length-1]:s(e.commonAncestorContainer,e.endContainer);(0,i.default)(r,"range is invalid: end missing");var o=r,l=e=>e&&e.nextSibling,d=[],u=t;for(;u&&u!==o;)d.push(u),u=l(u)||l(u.parentNode);return d.push(o),d};var i=a(r(47677)),n=a(r(50719));function s(e,t){for(var r=t;r.parentNode!==e;){if(!r.parentNode)return null;r=r.parentNode}return r}},58160:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r={LOW:"low",HIGH:"high"},a=window.matchMedia("\n    only screen and (-webkit-min-device-pixel-ratio: 2),\n    only screen and (min-device-pixel-ratio: 2),\n    only screen and (min-resolution: 2dppx)\n"),i={RES:r,currentRes:a.matches?r.HIGH:r.LOW};a.addListener((function(e){var t=e.matches?r.HIGH:r.LOW;if(t!==i.currentRes){i.currentRes=t;var a=document.createEvent("Event");a.initEvent("dpichange",!0,!0),window.dispatchEvent(a)}}));var n=i;t.default=n},42189:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(96009)),n=a(r(15253)),s=a(r(16760)),o=a(r(74930));t.default=class{constructor(e){this.rules={},this.styleSheet=this.createStyleSheet(e)}createStyleSheet(e){var t=e||(0,o.default)("dynamic-style-"),r=document.createElement("style");return r.id=t,r.type="text/css",document.head&&document.head.appendChild(r),r=r.sheet}addRule(e,t){var r=this.styleSheet.cssRules.length,a=(0,s.default)(t,((e,t)=>`${t}: ${e};`)).join(" ");return this.styleSheet.insertRule(`${e} { ${a} }`,r),this.rules[e]=this.styleSheet.cssRules[r],this.rules[e]}updateRule(e,t){var r=this.rules[e];return(0,n.default)(t,((e,t)=>{r.style[(0,i.default)(t)]=e})),r}setRule(e,t){return this.rules[e]?this.updateRule(e,t):this.addRule(e,t)}}},6203:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return s(null,n.default.fromForwardsStrings(e.sort(((e,t)=>t.length-e.length)).map((e=>`${e}${o}`))),null,0)};var i=a(r(89166)),n=a(r(96800));function s(e,t,r,a,n){var d=[],u=!1,c=n;null==c&&(e&&1===a?l.has(e)&&(c=!0):e&&r&&2===a&&(c=l.has(r+e)));t.getChildren().forEach((t=>{t.prefix!==o?d.push(s(t.prefix,t.node,e,a+1,c)):u=!0}));var p=""!==e||null==r||c?(0,i.default)(e||""):"?",h=0===d.length?"":`(?:${d.join("|")})`;return h&&u&&(h+="?"),`${p}${h}`}var o="\n",l=new Set(["","","","","",""])},63917:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.HEART_EMOJIS=t.VARIATION_CATEGORY=t.CATEGORY_ORDERING=t.LARGE_EMOJI_SIZE=t.EMOJI_WIDTH=t.EMOJI_TYPE=void 0;var i=a(r(23045)),{EMOJI:{ORDERED_CATEGORY_IDS:n}}=i.default;t.EMOJI_TYPE={APPLE:"APPLE",WHATSAPP:"WHATSAPP"};t.EMOJI_WIDTH={small:20,large:32};var s=r(28103).Mirrored(["MEDIUM","LARGE","XLARGE"]);t.LARGE_EMOJI_SIZE=s;var o=[...n,"VARIATION"];t.CATEGORY_ORDERING=o;var l=o.indexOf("VARIATION");t.VARIATION_CATEGORY=l;t.HEART_EMOJIS=["","","","","","","","","","","","","",""]},7522:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={APPLE:["1d5e731","529580c","d5735d4","3964227","60856da","fcef0ee","8e3414f","50659eb","8b6c76f","3b3d6b8","54fa2d7","0f873e5","83c57e6","54d4a36","05f819b","08b10df","1eda693","24f071f","43c7f1e","4673bc1","ad8e7a0","3b84c7f","47138e6","f7cf586","4609a68","eafe075","9fca360","4ff00ff","0e91b1d","958420b","194fdde","6c4a311","2c0b6d6","3b923f5","95f9182","f0b652b","5eef5f5","e2d60bb","3eb3a31","9b46eb8","e02b8ca","ccdb9d0","0204c19","e00c36f","59e20f3","585516e","3dfd1eb","265211d","44410d4","1937682","00b6dfb","c7b2566","b5308c2","3726c3f","32e0b8a","c70c8c9","929723c","3f5711a","7acb2c4","094645b","7d3f66d","e5962c7","ae792a7","76de187","bb980fd","2ec44f0","0cd59e3","1f800d7","969aa1f","20e8b4c","4fdae5e","ed4ad5f","5d67f78","9530353","5caffb3","59682ab","27b2426","b3a1edd","ab61b6f","ef4f27f","19e3281","14f4ada","70cf125","f408ea6","43ac328","c8c0ba6","39f813e","7cc745e","ce99005","4930013","d7a4068","7a46e3b","0c9c29f","56bf54b","17ac67d","dd192f7","c812d02","813dbc5","23c9c52","435e976","2bbd0df","625aadb","b9222f6","da65d5f","06ed4e2","ee050c5","9945226","84e64af","1696d42","d0e076e","cebbc40","61d3b8d","57d59fb","654bb14","f8c09c1","e52c442","7bf95b0","250df50","7dbc57b","298d700","4886b3a","640c1b4","b4254db","42b05a6","c0b44e2","024aeae","48b76e4","e06653f","70c4701","451b05c","37dc131","5a6cd0e","10fb6f0"],WHATSAPP:["275ab2d","2daeeb8","2224eba","0b9fe45","17c7395","a55d276","72434c2","1dd3846","c010a8c","ea9208b","3789cf9","1dcf7fa","6158b5d","01fd086","acc727e","6193968","17db773","bc40265","a4c2a1b","3ef52a3","2543ee4","ca1f104","4e1c931","c3a2f48","07cf04f","8b61961","9745348","5038cd6","7749b45","71b967c","45e7af0","c9cf572","c9bf2df","83cde5f","613025d","865dd57","e14a64a","4042dd6","8eab52b","91915f2","815b7ef","f8e0fb5","74b6b53","ac288a6","59306d9","f76ad56","f31dda5","2cdd785","8016aef","5df7b0d","22d0178","8c0c7e3","c32047b","b67ba4c","11629aa","33d67ff","84811ea","cfe754f","702917c","b2d2eb4","7d099c5","e09e035","741bdfc","33f9a55","279c1fa","a4d0c95","7b9ccb6","c817f7b","8c06d9c","7ebc665","a4fae04","54098a2","0a997bf","c65e655","0b02db6","59ecb60","53e46d5","6767439","22df2e4","ba186c8","6163a99","58bc633","a1b8d2e","02a99d5","c952246","eb4b44f","359629e","ea498fd","46e372a","3341cbb","204cc1a","b8ae509","b4cb2c1","6f6f3ee","9208a05","b5ed726","2199bf0","cf22dae","dd9c307","761ba89","9ed7247","02e2a9d","4cf10ee","c9ad573","43a26e5","38760e0","24e2ebd","da05a9f","4331754","b8bad41","34566f5","8449706","a0ee6b0","0d0dbc3","1ebbe36","dc97ce2","ca7d8e1","753afda","4663f0e","2e20ac0","a69f27b","b47fa5e"]}},20409:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,r){return{low:u(`${t}-${"large"===r?"40":"64"}.png`,e.toLowerCase()),high:u(`${t}-64.png`,e.toLowerCase())}},t.getEmojiSpritesPath=function(e,t,r,a){var i=(0,o.default)(s.default[e][t],"emojiSpriteHashes[emojiType][bucketId]");return`${d}/emoji-${t}-${r}_${i}.${a}`};var i=a(r(23045)),n=r(215),s=a(r(7522)),o=a(r(21830)),{EMOJI:{LARGE_EMOJI_BASE_PATH:l,EMOJI_SPRITES_BASE_PATH:d}}=i.default;function u(e,t){return`${l}/${n.prefixHash}_${t.slice(0,1)}_${e}`}},31615:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.isBaseCoupleEmoji=function(e){return E.includes(e)},t.default=t.getPermutations=void 0;var i=a(r(45861)),n=a(r(30733)),s=a(r(72779)),o=a(r(47677)),l=a(r(67329)),d=a(r(6203)),u=a(r(23045)),c=r(63917),p=a(r(20409)),h=a(r(21830)),f=a(r(7743)),_=a(r(19705)),m=["","","","",""],g=new RegExp(m.join("|"),"g"),v=u.default.EMOJI.BUCKET_SIZE,E=["","","",""],y=c.HEART_EMOJIS.map((e=>e)),S=new Set(["","","","","","","","","","","","","","","",""]),T=e=>e.replace(/\uFE0F/g,""),A=(0,n.default)(((e,t)=>function r(a=[]){if(a.length===t)return[a];for(var i=[],n=0;n<e.length;n++){var s=[...a];s.push(e[n]),i=i.concat(r(s))}return i}()),((e,t)=>e.toString()+t));t.getPermutations=A;function b(e){return e.every((t=>t===e[0]))?e[0]:e.join("")}var C=new class{constructor(){var e=this;this.skinToneVariations=m,this._specialEmojiRegex=null,this.emojiRegex=()=>{var e=this._createEmojiRegexIfNeeded();return e.lastIndex=0,e},this._createEmojiRegexIfNeeded=(0,f.default)((()=>{var e=this._getEmojiRegexSource();return new RegExp("("+e+")","g")})),this.onlyEmojiRegex=()=>{var e=this._createOnlyEmojiRegexIfNeeded();return e.lastIndex=0,e},this._createOnlyEmojiRegexIfNeeded=(0,f.default)((()=>{var e=this._getEmojiRegexSource();return new RegExp("^("+e+")+$","g")})),this.convertToTextWithoutSpecialEmojis=e=>{if(!this._specialEmojiRegex){var t=(0,d.default)(Object.keys(_.default));this._specialEmojiRegex=new RegExp(`(${t})`,"g")}return this._specialEmojiRegex.lastIndex=0,e.replace(this._specialEmojiRegex,(e=>_.default[e]))},this.splitEmojis=e=>!1===this.containsOnlyEmoji(e)?null:e.split(this.emojiRegex()).filter(Boolean),this.containsEmoji=e=>this.emojiRegex().test(e),this.containsOnlyEmoji=e=>this.onlyEmojiRegex().test(e),this.matchLargeEmojiPattern=e=>{if(e.length>50||e.includes(" "))return null;var t=this._getLargeEmojisRegex().exec(e);return t?t.filter(Boolean).slice(1):null},this.normalizeEmojiFromString=e=>this.normalizeEmoji(e),this.normalizeEmoji=e=>{var t=T(e),{unqualifiedToNormalizedEmoji:r}=this._getDerivedMaps();return r.get(t)},this.normalizeAllEmojis=(0,n.default)((e=>e?e.replace(this.emojiRegex(),((e,t)=>{var r;return S.has(t)?"":null!==(r=this.normalizeEmoji(t))&&void 0!==r?r:""})):"")),this.getSkinToneVariant=(e,t)=>{var r=this._getBaseToSkinToneEmojis().get(e);if(null==r)return null;var a=b(t);return r.get(a)},this._getDerivedMaps=(0,f.default)((()=>{var{orderedEmojis:e,legacyToEmoji:t}=this._getConfig(),r=new Map,a=new Map,n=new Map,s=0;return e.forEach(((e,t)=>{""!==e&&null!=e&&((Array.isArray(e)?e:[e]).forEach((e=>{a.set(e,t);var r=T(e);n.set(r,e)})),r.set(t,s),s++)})),(0,i.default)(t).forEach((([e,t])=>{a.set(e,t);var r=T(e);n.set(r,e)})),{emojiToGlyphId:a,glyphIdToIndex:r,unqualifiedToNormalizedEmoji:n}})),this._getBaseToSkinToneEmojis=(0,f.default)((()=>{var{emojiToGlyphId:t}=this._getDerivedMaps(),r=new Map,a=function(t){var a=void 0,i=t.replace(g,(e=>(null==a&&(a=[]),a.push(e),"")));if(null==a)return"continue";var n=a,s=void 0;s=""===i?"":""===i?"":""===i?"":i;var o=e.normalizeEmoji(s);if(null==o)return"continue";var l=r.get(o);null==l&&((l=new Map).set("",o),r.set(o,l));var d=b(n);l.set(d,t)};for(var i of t.keys())a(i);return r})),this._getSkinToneEmojisToBase=(0,f.default)((()=>{var e=new Map;for(var[t,r]of this._getBaseToSkinToneEmojis().entries())for(var a of r.values())e.set(a,t);return e})),this._getEmojiRegexSource=(0,f.default)((()=>{var{emojiToGlyphId:e}=this._getDerivedMaps();return(0,d.default)([...e.keys(),...S].filter(Boolean))})),this._createLargeEmojisRegexIfNeeded=(0,f.default)((()=>{var e=this._getEmojiRegexSource();return new RegExp(`^(${e})(${e})?(${e})?$`)})),this.getEmojisInCategory=e=>{var t;return null!==(t=this._getConfig().categorizedEmojis[e])&&void 0!==t?t:[]},this._getEmojiToCategory=(0,f.default)((()=>{var{categorizedEmojis:e}=this._getConfig(),t=new Map;return Object.keys(e).forEach((r=>{var a=c.CATEGORY_ORDERING.indexOf(r);e[r].forEach((e=>{var r=this.normalizeEmoji(e);null!=r&&t.set(r,a)}))})),t})),this.getGlyphId=e=>{var t=this.normalizeEmoji(e);if(null==t)return null;var{emojiToGlyphId:r}=this._getDerivedMaps();return r.get(t)},this.getGlyphPath=(e,t)=>(0,p.default)(this._getConfig().emojiType,e,t),this.isGlyphCached=e=>{var t=this._getGlyphIndex(e);return this._getCachedGlyphs().get(t)},this.markGlyphCached=e=>{var t=this._getGlyphIndex(e);this._getCachedGlyphs().set(t)},this._getCachedGlyphs=(0,f.default)((()=>new l.default(this._getGlyphCount()))),this.getCssClasses=(e,t="small")=>(0,s.default)(`b${this.getBucket(e)}`,"small"===t?"emoji":"emojik",this._getConfig().emojiType===c.EMOJI_TYPE.APPLE?"apple":"wa"),this.getStyle=(e,t="small")=>{var{xpos:r,ypos:a}=this._getCoordinates(e,t);return{backgroundPosition:`-${r}px -${a}px`}},this.getBucket=e=>{var t=this._getGlyphIndex(e);return`${Math.floor(t/v)}`},this.getHeartEmojis=(0,f.default)((()=>y.map(this.normalizeEmoji).filter(Boolean))),this._getLastBucketId=(0,f.default)((()=>{var e=this._getGlyphCount();return e-e%v})),this._getLastBucketCols=(0,f.default)((()=>Math.floor(Math.sqrt(this._getGlyphCount()-this._getLastBucketId()))))}configure(e){e!==this._config&&(this._config=e,this.getHeartEmojis.reset(),this._specialEmojiRegex=null,this._createEmojiRegexIfNeeded.reset(),this._createLargeEmojisRegexIfNeeded.reset(),this._createOnlyEmojiRegexIfNeeded.reset(),this._getEmojiRegexSource.reset(),this._getCachedGlyphs.reset(),this._getSkinToneEmojisToBase.reset(),this._getBaseToSkinToneEmojis.reset(),this._getEmojiToCategory.reset(),this._getLastBucketId.reset(),this._getLastBucketCols.reset(),this._getDerivedMaps.reset())}_getConfig(){return(0,o.default)(null!=this._config,"Attempt to use EmojiUtil before it's been configured"),this._config}isEmoji(e){return null!=this.normalizeEmoji(e)}getSkinToneBase(e){var t,r=this.normalizeEmoji(e);return null==r?null:null!==(t=this._getSkinToneEmojisToBase().get(r))&&void 0!==t?t:null}_getLargeEmojisRegex(){var e=this._createLargeEmojisRegexIfNeeded();return e.lastIndex=0,e}_getGlyphCount(){var{glyphIdToIndex:e}=this._getDerivedMaps();return e.size}_getCoordinates(e,t){var r=this._getGlyphIndex(e),a=r%v,i=r>=this._getLastBucketId()?this._getLastBucketCols():Math.floor(Math.sqrt(v)),n=c.EMOJI_WIDTH[t],s=Math.floor(a/i);return{xpos:Math.floor(a%i)*n,ypos:s*n,width:n}}_getGlyphIndex(e){var{glyphIdToIndex:t}=this._getDerivedMaps();return(0,h.default)(t.get(e),"glyphIdToIndex.get(glyphId)")}};t.default=C},92199:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.initEncSalt=function(){return u.apply(this,arguments)},t.initEncSaltForInvoker=function(){return c.apply(this,arguments)},t.generateFinalDbEncryptionAndFtsKeyForInvoker=function(e){return(0,o.get)().generateFinalDbEncryptionAndFtsKey(e)},t.deleteEncKeysAndCache=function(){var e;return Promise.all([null===(e=i)||void 0===e?void 0:e.deleteKeys(),(0,o.get)().deleteDbEncKeyCache()]).then((()=>{}))};var i,n=a(r(52954)),s=r(64261),o=r(27246),l=a(r(13277));i=r(49508).default;var d=null;function u(){return(u=(0,n.default)((function*(){var e;null==d&&(d=(0,s.getOrGenSalt)());var t=yield d;if(t&&t.constructor===Uint8Array)return null===(e=i)||void 0===e?void 0:e.init(t)}))).apply(this,arguments)}function c(){return(c=(0,n.default)((function*(){null==d&&(d=(0,s.getOrGenSalt)());var e=yield d;e&&e.constructor===Uint8Array&&(0,o.get)().initDatabaseEncnKey(e)}))).apply(this,arguments)}l.default.on("logout",(()=>{d=Promise.resolve(null)}))},64261:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.getOrGenSalt=function(){var e=!!(0,i.getMaybeMeUser)(),t=null;e||(t=new Uint8Array(128),self.crypto.getRandomValues(t),t=btoa(String.fromCharCode(...new Uint8Array(t))),(0,n.setWebEncSalt)(t));null==(t=(0,n.getWebEncSalt)())&&(__LOG__(4,void 0,new Error)`[DB ENC CRITICAL ERROR] null returned for local enc salt`,s.default.logout());return t=Uint8Array.from(atob(t),(e=>e.charCodeAt(0))),Promise.resolve(t)},t.deleteSalt=function(){(0,n.setWebEncSalt)(null)};var i=r(66239),n=r(63191),s=a(r(15934))},67961:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.decodeBroadcastEphemeralSetting=function(e,t,r,d,u){var c=e.toString({legacy:!0}),p=t.toString({legacy:!0}),h=r.toString({legacy:!0}),f=i.Binary.build(`Ephemeral ${p} ${c}`).readByteArray(),_=new Uint8Array(u),m=(0,n.decodeB64)(d),g=i.Binary.build(h).readBuffer();return function(e,t){return self.crypto.subtle.importKey("raw",e,"HKDF",!1,["deriveKey"]).then((e=>self.crypto.subtle.deriveKey({name:"HKDF",hash:"SHA-256",salt:l,info:t},e,{name:"HMAC",hash:"SHA-256"},!0,["verify"]))).then((e=>self.crypto.subtle.exportKey("raw",e)))}(_,f).then((e=>function(e,t,r){var a=e.slice(0,12),i=e.slice(12,44);return self.crypto.subtle.importKey("raw",i,"AES-GCM",!1,["decrypt"]).then((e=>self.crypto.subtle.decrypt({name:"AES-GCM",iv:new Uint8Array(a),additionalData:r},e,t)))}(e,m,g))).then((e=>{var{duration:t,timestamp:r}=(0,a.decodeProto)(o.EphemeralSettingSpec,e);return null==t||null==r?Promise.reject(new Error("ephSetting decoded into malformed proto")):{ephemeralDuration:t,ephemeralSettingTimestamp:(0,s.castLongIntToUnixTime)(r)}}))};var a=r(9557),i=r(49244),n=r(84337),s=r(95334),o=r(31138),l=new Uint8Array(32)},97488:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.generateEphemeralSystemMessage=function(e,t){if(i.default.supportsFeature(i.default.F.MD_BACKEND)){var a=r(62711).handleSingleMsgMD,u={id:new l.default({id:(0,d.default)(),remote:e.id,fromMe:!1}),from:e.id,to:(0,o.getMaybeMeUser)(),t:n.default.globalUnixTime(),type:s.default.MSG_TYPE.PROTOCOL,subtype:"ephemeral_setting",ephemeralDuration:t,isNewMsg:!0};a(e.id,u)}};var i=a(r(20468)),n=a(r(99461)),s=a(r(23045)),o=r(66239),l=a(r(83746)),d=a(r(2661))},74739:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getEphemeralExpirationTimestamp=function(e,t,r,a,i){if("ephemeral_setting"===a)return null;if(null==e||0===e)return null;if(i&&null!=t)return t+e;return r+e}},34891:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.isEphemeralDurationAllowed=function(e){return!(e<0)&&(0===e||i.default.getEphemeralMessagesAllowedValues().includes(e))};var i=a(r(54559))},18555:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.shouldUpdateEphemeralSetting=function(e){var{oldDuration:t,oldSettingTimestamp:r,newDuration:i,newSettingTimestamp:n,chatId:s}=e;return n>r||!(n<r)&&(t!==i&&!(0,a.getMaybeMeUser)().isLessThan(s))};var a=r(66239)},33013:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return n.apply(this,arguments)};var i=a(r(52954));function n(){return(n=(0,i.default)((function*(){var e=navigator.storage;if(null==(null==e?void 0:e.estimate))return null;var{usage:t,quota:r}=yield e.estimate();return{usage:t,quota:r}}))).apply(this,arguments)}},71107:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(74930)),n=a(r(45455)),s=a(r(25291)),o=/\s+/;t.default=class{on(e,t,r){if(!t)return this;if("function"!=typeof t)throw new Error("Callback parameter passed is not a function");return this._multiEvent(this.on,...arguments)||this._getOrCreateEvents(e).push({callback:t,context:r,ctx:r||this}),this}once(e,t,r){if(!t)return this;if(this._multiEvent(this.once,...arguments))return this;var a=this,i=(0,s.default)((function(){a.off(e,i),t.apply(this,arguments)}));return i._callback=t,this.on(e,i,r)}off(e,t,r){var a=this._events;if(!a)return this;if(this._multiEvent(this.off,...arguments))return this;if(!e&&!t&&!r)return this._events=void 0,this;for(var i=e?[e]:Object.keys(a),n=0;n<i.length;n++){var s=i[n],o=a[s];if(o){if(a[s]=[],t||r)for(var l=0;l<o.length;l++){var d=o[l];(t&&t!==d.callback&&t!==d.callback._callback||r&&d.context!==r)&&a[s].push(d)}a[s].length||delete a[s]}}return this}trigger(e,...t){if(!this._events)return this;if(this._multiEvent(this.trigger,...arguments))return this;var r=this._getEvents(e),a=this._getEvents("all");return r&&this._triggerEvents(r,t),a&&this._triggerEvents(a,arguments),this}stopListening(e,t,r){var a=this._listeningTo;if(!a)return this;var i=e&&e._listenId,s=i?{[i]:e}:a;for(var o in s){var l=s[o];l.off(t,r,this),(!t&&!r||(0,n.default)(l._events))&&delete a[o]}return(0,n.default)(this._listeningTo)&&delete this._listeningTo,this}listenTo(e,t,r){return r?(this._addListeningTo(e),e.on(t,r,this),this):this}listenToOnce(e,t,r){return this._addListeningTo(e),e.once(t,r,this),this}listenToAndRun(e,t,r){return this.listenTo.apply(this,arguments),r.apply(this),this}isListening(e){var t=this._events;return!!t&&("string"==typeof e?!!t[e]:(0,n.default)(t))}_addListeningTo(e){(this._listeningTo||(this._listeningTo={}))[e._listenId||(e._listenId=(0,i.default)("l"))]=e}_getOrCreateEvents(e){var t=this._events||(this._events={});return t[e]||(t[e]=[])}_getEvents(e){if(e){var t=this._events;if(t)return t[e]}}_multiEvent(e,t,...r){if(o.test(t)){for(var a=t.split(o),i=0;i<a.length;i++)e.call(this,a[i],...r);return!0}return!1}_triggerEvents(e,t){var r,a=-1,i=e.length,n=t[0],s=t[1],o=t[2];switch(t.length){case 0:for(;++a<i;)(r=e[a]).callback.call(r.ctx);return;case 1:for(;++a<i;)(r=e[a]).callback.call(r.ctx,n);return;case 2:for(;++a<i;)(r=e[a]).callback.call(r.ctx,n,s);return;case 3:for(;++a<i;)(r=e[a]).callback.call(r.ctx,n,s,o);return;default:for(;++a<i;)(r=e[a]).callback.apply(r.ctx,t)}}bind(){return this.on(...arguments)}unbind(){return this.off(...arguments)}removeListener(){return this.off(...arguments)}removeAllListeners(){return this.off()}emit(e,...t){return this.trigger(arguments)}}},24461:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GUM=t.UnableToGetContentLengthError=t.SourceUnavailableError=t.AbortError=t.NotFoundError=t.OverconstrainedError=t.ConstraintNotSatisfiedError=t.NotAllowedError=t.NotSupportedError=t.GUMError=t.ActiveChatChanged=t.Unmount=t.ActionError=t.CanNotSendUnencrypted=t.CapabilityUnknown=t.CapabilityInvalid=t.CapabilityError=t.DeprecatedProtocolVersion=t.UpdateImmediately=t.ProtoVersionUndefined=t.DBInvalidFtsHMACKey=t.DbOnLogoutAbort=t.DbMsgEncKeyNotLoaded=t.DbEncKeyNotLoaded=t.ModelCreateError=t.ModelError=t.MediaUnsupportedError=t.MediaDragDropError=t.UnableToPlayVideoError=t.TranscodeBlobTooLargeError=t.MediaLoadError=t.MediaMissing=t.MediaNeedsReupload=t.BingServerError=t.InvalidServerResponseError=t.ServerStatusError=t.DecodeWebpResultsError=t.ImageError=t.BlockedByProxy=t.SocketNotOpen=t.SocketClosed=t.SocketError=t.MediaFileEmpty=t.MediaFileFailedLoad=t.MediaDecryptionError=t.MediaEncryptionError=t.InvalidMediaFileType=t.InvalidImageFileType=t.MediaFileError=t.CatalogImageDownloadError=t.GaveUpRetry=t.ShouldLoop=t.Offline=t.Disconnected=t.QueryDrop=t.UnimplementedMethod=void 0;var a=r(71436);class i extends((0,a.customError)("UnimplementedMethod")){}t.UnimplementedMethod=i;class n extends((0,a.customError)("QueryDrop")){}t.QueryDrop=n;class s extends((0,a.customError)("Disconnected")){}t.Disconnected=s;class o extends((0,a.customError)("Offline")){}t.Offline=o;class l extends((0,a.customError)("ShouldLoop")){}t.ShouldLoop=l;class d extends((0,a.customError)("GaveUpRetry")){}t.GaveUpRetry=d;class u extends((0,a.customError)("CatalogImageDownloadError")){}t.CatalogImageDownloadError=u;class c extends((0,a.customError)("MediaFileError")){}t.MediaFileError=c;class p extends((0,a.customError)("InvalidImageFileType",!0,c)){}t.InvalidImageFileType=p;class h extends((0,a.customError)("InvalidMediaFileType",!0,c)){}t.InvalidMediaFileType=h;class f extends((0,a.customError)("MediaEncryptionError",!0,c)){}t.MediaEncryptionError=f;class _ extends((0,a.customError)("MediaDecryptionError",!0,c)){}t.MediaDecryptionError=_;class m extends((0,a.customError)("MediaFileFailedLoad",!0,c)){}t.MediaFileFailedLoad=m;class g extends((0,a.customError)("MediaFileEmpty",!0,c)){}function v(e){try{return JSON.stringify(e)}catch(t){return e.toString()}}t.MediaFileEmpty=g;class E extends((0,a.customError)("SocketError")){constructor(e){super("string"==typeof e?e:v(e)),this.event=e}}t.SocketError=E;class y extends((0,a.customError)("SocketClosed")){constructor(e){super("string"==typeof e?e:v(e)),this.event=e}}t.SocketClosed=y;class S extends((0,a.customError)("SocketNotOpen")){constructor(e){super(`socket not open, is ${e}`)}}t.SocketNotOpen=S;class T extends((0,a.customError)("BlockedByProxy")){}t.BlockedByProxy=T;class A extends((0,a.customError)("ImageError")){constructor(e,t){super("Image failed to load."),this.src=e,this.status=t,this.target={src:e,status:t}}}t.ImageError=A;class b extends((0,a.customError)("DecodeWebpResultsError")){constructor(e,t){super(e),this.event=t}}t.DecodeWebpResultsError=b;class C extends((0,a.customError)("ServerStatusError")){constructor(e,t,r){super(`${e||"Server replied with a failed status code"}: ${r}`),this.url=t,this.status=r}}t.ServerStatusError=C;class P extends((0,a.customError)("InvalidServerResponseError")){constructor(e,t,r){var a=`Invalid response for ${e}, with status ${t}`;r&&(a=`${a}: ${r}`),super(a)}}t.InvalidServerResponseError=P;class O extends((0,a.customError)("BingServerError",!0,C)){constructor(e,t,r){super(`Error ${t} for ${e}: ${JSON.stringify(r)}`,e,t)}}t.BingServerError=O;class w extends((0,a.customError)("MediaNeedsReupload")){}t.MediaNeedsReupload=w;class M extends((0,a.customError)("MediaMissing")){}t.MediaMissing=M,M.message="Media is no longer available on your phone";class I extends((0,a.customError)("MediaLoadError")){constructor(e){super(e),this.src=e}}t.MediaLoadError=I;class R extends((0,a.customError)("TranscodeBlobTooLargeError")){constructor(){super("Transcode blob too large")}}t.TranscodeBlobTooLargeError=R;class D extends((0,a.customError)("UnableToPlayVideoError")){constructor(e){super(`Unable to play video. Reason: ${String(e)}`)}}t.UnableToPlayVideoError=D;class N extends((0,a.customError)("MediaDragDropError",!0,I)){constructor(e){super(e)}}t.MediaDragDropError=N;class L extends((0,a.customError)("MediaUnsupportedError")){}t.MediaUnsupportedError=L,L.message="Media format is unsupported";class k extends((0,a.customError)("ModelError")){}t.ModelError=k;class U extends((0,a.customError)("ModelCreateError")){constructor(e,t){super(e),this.model=t}}t.ModelCreateError=U;class G extends((0,a.customError)("DbEncKeyNotLoadedError")){constructor(e){super(`MasterDatabaseEncryptionKey.${e} was accessed before init`)}}t.DbEncKeyNotLoaded=G;class F extends((0,a.customError)("DbMsgEncKeyNotLoadedError")){constructor(e){super(`MasterDatabaseMessageEncryptionKey.${e} was accessed before init`)}}t.DbMsgEncKeyNotLoaded=F;class x extends((0,a.customError)("DbOnLogoutAbortError")){}t.DbOnLogoutAbort=x,x.message="DB operation was dropped due to logout activity";class B extends((0,a.customError)("DBExpiredFtsHMACKey")){}t.DBInvalidFtsHMACKey=B,B.message="MasterDatabaseEncryptionKey.fts_hmac_keys is in an invalid state";class Y extends((0,a.customError)("ProtoVersionUndefined")){}t.ProtoVersionUndefined=Y;class K extends((0,a.customError)("UpdateImmediately")){}t.UpdateImmediately=K;class j extends((0,a.customError)("DeprecatedProtocolVersion")){}t.DeprecatedProtocolVersion=j;class W extends((0,a.customError)("CapabilityError")){}t.CapabilityError=W;class H extends((0,a.customError)("CapabilityInvalid",!0,W)){}t.CapabilityInvalid=H;class V extends((0,a.customError)("CapabilityUnknown",!0,W)){}t.CapabilityUnknown=V;class $ extends((0,a.customError)("CanNotSendUnencrypted")){}t.CanNotSendUnencrypted=$;class q extends((0,a.customError)("ActionError")){}t.ActionError=q,q.message="Could not perform action.";class z extends((0,a.customError)("Unmount")){}t.Unmount=z;class J extends((0,a.customError)("ActiveChatChanged")){}t.ActiveChatChanged=J;class Q extends((0,a.customError)("GUMError")){}t.GUMError=Q;class X extends((0,a.customError)("NotSupportedError",!0,Q)){}t.NotSupportedError=X,X.message="The operation is not supported.";class Z extends((0,a.customError)("NotAllowedError",!0,Q)){}t.NotAllowedError=Z,Z.message="The user did not grant permission for the operation";class ee extends((0,a.customError)("ConstraintNotSatisfiedError",!0,Q)){}t.ConstraintNotSatisfiedError=ee,ee.message="One of the mandatory Constraints could not be satisfied.";class te extends((0,a.customError)("OverconstrainedError",!0,Q)){}t.OverconstrainedError=te,te.message="Due to changes in the environment, one or more mandatory constraints can no longer be satisfied.";class re extends((0,a.customError)("NotFoundError",!0,Q)){}t.NotFoundError=re,re.message="The object can not be found here.";class ae extends((0,a.customError)("AbortError",!0,Q)){}t.AbortError=ae,ae.message="The operation was aborted.";class ie extends((0,a.customError)("SourceUnavailableError",!0,Q)){}t.SourceUnavailableError=ie,ie.message="The source of the MediaStream could not be accessed due to a hardware error (e.g. lock from another process).";class ne extends((0,a.customError)("UnableToGetContentLengthError")){}t.UnableToGetContentLengthError=ne,ne.message="Failed to get media contentLength from mms";var se={GUMError:Q,NotSupportedError:X,NotAllowedError:Z,ConstraintNotSatisfiedError:ee,OverconstrainedError:te,NotFoundError:re,AbortError:ae,SourceUnavailableError:ie};t.GUM=se},55848:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.getFaqUrl=function(){return`${n}/web?lang=${i.default.getLocale()}`},t.getBusinessFaqUrl=function(){return o("general/chats/about-chatting-with-businesses")},t.getCannotConnectFaqUrl=function(){return o("web/troubleshooting/cant-connect-to-whatsapp-web-or-desktop")},t.getCiphertextFaqUrl=function(){return o("general/security-and-privacy/seeing-waiting-for-this-message-this-may-take-a-while")},t.getCodeChangeFaqUrl=function(){return o("general/security-and-privacy/security-code-change-notification")},t.getMDCodeChangeFaqUrl=function(){return`${n}/${i.default.getLocale()}/web/26000361`},t.getE2EFaqUrl=function(){return o("general/security-and-privacy/end-to-end-encryption")},t.getE2EEnterpriseFaqUrl=function(){return o("general/security-and-privacy/end-to-end-encryption-for-business-messages")},t.getFrequentlyForwardedFaqUrl=function(){return o("general/coronavirus-product-changes/about-forwarding-limits")},t.getLoginFaqUrl=function(){return o("general/download-and-installation/how-to-log-in-or-out")},t.getNonVerifiedTransitionFaqUrl=function(){return o("general/business-account-becomes-a-standard-account")},t.getNotificationChromeFaqUrl=function(){return o("web/troubleshooting/cant-receive-notifications-on-chrome")},t.getNotificationEdgeFaqUrl=function(){return o("web/troubleshooting/cant-receive-notifications-on-microsoft-edge")},t.getNotificationFirefoxFaqUrl=function(){return o("web/troubleshooting/cant-receive-notifications-on-firefox")},t.getNotificationOperaFaqUrl=function(){return o("web/troubleshooting/cant-receive-notifications-on-opera")},t.getNotificationSafariFaqUrl=function(){return o("web/troubleshooting/cant-receive-notifications-on-safari")},t.getRevokeFaqUrl=function(){return o("web/chats/how-to-delete-messages")},t.getSuspiciousLinkFaqUrl=function(){return o("web/chats/suspicious-links")},t.getUnverifiedTransitionFaqUrl=function(){return o("general/business-account-becomes-unverified")},t.getVerifiedHighFaqUrl=function(){return o("general/verified-business-account")},t.getVerifiedLowUnknownFaqUrl=function(){return o("general/unverified-business-account")},t.getVerifiedTransitionFaqUrl=function(){return o("general/business-account-becomes-verified")},t.getEphemeralFaqUrl=function(){return o("general/chats/about-disappearing-messages")},t.getViewOnceFaqUrl=function(){return o("general/chats/about-view-once")},t.getSupportChatFaqUrl=function(){return o("general/what-information-does-whatsapp-collect-when-you-contact-support")},t.getContactFormDeviceInfoShareFaqUrl=function(){return o("general/security-and-privacy/learn-more-about-device-information")},t.PLATFORM=t.FAQ_BASE_URL=void 0;var i=a(r(38637)),n="https://faq.whatsapp.com";t.FAQ_BASE_URL=n;var s="web";function o(e){return`${n}/${e}?lang=${i.default.getLocale()}`}t.PLATFORM=s},17153:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return r};var r=new Promise((e=>{Modernizr.on("webp",e)})).then((e=>!(!e||!e.valueOf()))).timeout(5e3).catch((()=>!1))},48537:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.blobToArrayBuffer=o,t.validateBlob=function(e){return o(e.webkitSlice?e.webkitSlice(0,1):e.slice(0,1)).then((e=>1===e.byteLength)).catch((()=>!1))},t.getAudioDuration=function(e){var t,r;return new Promise(((a,i)=>{(t=document.createElement("audio")).addEventListener("loadeddata",a),t.addEventListener("error",(()=>{i(new Error("getAudioDuration: error loading audio"))})),t.src=r=URL.createObjectURL(e)})).then((()=>~~t.seekable.end(0))).finally((()=>{r&&URL.revokeObjectURL(r)}))},t.typeFromMimetype=function(e){var t=e.split("/")[0];switch(t){case s.IMAGE:case s.VIDEO:case s.AUDIO:return t;default:return s.DOCUMENT}},t.getMimeTypeForFilepath=function(e){var t=d(e),r=(0,n.isAllowedDocumentMimetype)(n.EXT_TO_MIME&&t&&n.EXT_TO_MIME[t],e,!1);if(r)return r},t.removeTrailingDots=l,t.getFileExtension=d,t.createFile=u,t.copyFile=function(e){return o(e).then((t=>{var{lastModified:r,type:a,name:i}=e;return u([t],i,{lastModified:r,type:a})}))},t.blobToText=function(){return c.apply(this,arguments)},t.FILETYPE=void 0;var i=a(r(52954)),n=r(6353),s=Object.freeze({IMAGE:"image",VIDEO:"video",AUDIO:"audio",DOCUMENT:"document"});function o(e){var t;return new Promise(((r,a)=>{(t=new FileReader).onload=r,t.onerror=e=>{a(new Error(`blobToArrayBuffer error: ${String(e)}`))},t.onabort=e=>{a(new Error(`blobToArrayBuffer abort: ${String(e)}`))},t.readAsArrayBuffer(e)})).then((()=>t.result))}function l(e){return e.replace(/\.+$/,"")}function d(e){var t=l(e.trimRight()).split(".");return t.length>1?t[t.length-1].toLowerCase():null}function u(e,t,r){var a=new Blob(e,r||{});return a.name=t,a}function c(){return(c=(0,i.default)((function*(e){if("function"==typeof e.text)return e.text();var t=new FileReader;if(yield new Promise(((r,a)=>{t.onload=r,t.onerror=e=>{a(new Error(`blobToText error: ${String(e)}`))},t.onabort=e=>{a(new Error(`blobToText abort: ${String(e)}`))},t.readAsText(e)})),t.result instanceof ArrayBuffer)throw new TypeError("blobToText error: Invalid result type: ArrayBuffer");if(null==t.result)throw new TypeError("blobToText: Invalid result type: null");return t.result}))).apply(this,arguments)}t.FILETYPE=s},18929:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return Object.keys(e).reduce(((t,r)=>(null!=e[r]&&(t[r]=e[r]),t)),{})}},72100:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.forbiddenFindDOMNode=i,t.forbiddenAssertDOMNode=function(e,t=window.HTMLElement){var r=i(e,t);if(r)return r;throw new Error(`[ForbiddenAssertDOMNode] findDOMNode returned ${String(r)} with component ${String(e)}`)};var a=r(28316);function i(e,t=window.HTMLElement){var r=(0,a.findDOMNode)(e);if(r){if(r instanceof t)return r;throw new Error(`[forbiddenFindDOMNode] returned node not instance of ${String(t)}`)}return r}},5338:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(78178));var n=new class{constructor(){this.shouldIndicateFocusTimestamp=0}shouldIndicateFocus(){this.shouldIndicateFocusTimestamp=Date.now()}maybeIndicateFocus(e,t=i.default.focusAnimation){Date.now()-this.shouldIndicateFocusTimestamp>200||this.indicateFocus(e,t)}indicateFocus(e,t=i.default.focusAnimation){e&&(e.classList.remove(t),e.offsetWidth,e.classList.add(t))}};t.default=n},18792:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(35160),n=a(r(25568)),s=[],o=!1;var l=new i.ShiftTimer((function(){s=[],o=!1})),d=!n.default||{capture:!0,passive:!0};document.addEventListener("keydown",(()=>{l.forceRunNow()}),d);var u={focus(e,t){if(e&&(!s.length||e!==s[s.length-1])){if(o=o||null!=window.event,function(e){5===s.length&&s.shift(),s.push(e)}(e),function(){if(s.length<5)return!1;for(var e=new Set,t=0;t<s.length;t++){if(e.has(s[t]))return!0;e.add(s[t])}return!1}()&&!o)return __LOG__(4,void 0,new Error,!0)`Focus loop encountered.`,void SEND_LOGS("focus-loop");l.onOrBefore(75),e.focus(t)}}};t.default=u},99532:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function({chat:e,undelivered:t,canForward:r,cannotForward:a}){var s=r.length-t.length,o=a.length+t.length,l=e.isUser?{contact:e.formattedTitle}:{};if(s>0)return t.length?a.length?n.default.t(349,(0,i.default)({count:o,_plural:o},l)):n.default.t(348,{count:o,_plural:o}):n.default.t(346,{count:o,_plural:o,contact:e.formattedTitle});if(t.length)return a.length?n.default.t(350,l):n.default.t(351);return n.default.t(347,l)};var i=a(r(70417)),n=a(r(38637))},30256:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,r,a=String){var n=(0,i.default)(e,t.map(a)).join(""),s=r?4e3:Number.POSITIVE_INFINITY;n.length>s&&(n=n.slice(0,s).replace(/\s+$/," [truncated]"));return n};var i=a(r(69058))},81131:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(71436);class i extends((0,a.customError)("ForwardError")){constructor(e){super(),this.reasons=e}}t.default=i},30020:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.aspectRatioScaled=function(e,t){return"number"!=typeof e||e<0||e!=e?{width:t,height:t}:e>1?{width:t,height:Math.max(t/e,1)}:{width:Math.max(t*e,1),height:t}},t.boundHeightWidth=function(e,t,r){var a=null!=t?t:r,i=null!=e?e:r;a>i?a>r&&(i*=r/a,a=r):i>r&&(a*=r/i,i=r);return{width:Math.max(a,1),height:Math.max(i,1)}},t.rotatePoint=function(e,t,r){var a=r*Math.PI/180;return{x:Math.cos(a)*e+Math.sin(a)*t,y:-Math.sin(a)*e+Math.cos(a)*t}}},29699:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=document.getElementById("hard_expire_time"),a=r&&r.dataset&&r.dataset.time;a||(__LOG__(3)`hard expire time not found on dom, using fallback of 1572566400 (2019/11/1)`,a="1572566400");var i=a;t.default=i},25212:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.extract=o,t.expand=l,t.extractAndExpand=function(e,t,r){return o(e,s).then((e=>l(e,t,r)))},t.DEFAULT_SALT=void 0;var i=r(49244),n=a(r(34601)),s=new Uint8Array(32).buffer;function o(e,t){return new n.default(new Uint8Array(t)).sign(new Uint8Array(e))}function l(e,t,r){if(r<0||r>8160)return Promise.reject(new Error(`HKDF::expand given bad length ${r}`));for(var a=Math.ceil(r/32),s=i.Binary.build(t).readByteArray(),o=new i.Binary,l=new n.default(e),d=Promise.resolve(new Uint8Array(0)),u=function(e){d=d.then((t=>{var r=new Uint8Array(t.length+s.length+1);return r.set(t),r.set(s,t.length),r[t.length+s.length]=e,l.sign(r)})).then((e=>{var t=new Uint8Array(e);return o.writeByteArray(t),t}))},c=1;c<=a;c++)u(c);return d.then((()=>o.readBuffer(r)))}t.DEFAULT_SALT=s},19058:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.SpecialKeyMap=void 0;var n=i(r(58527)),s=i(r(22220)),o=i(r(98346)),l=a(r(2784)),d=i(r(569)),u={alt:"Alt",ctrl:"Control",meta:"Meta",shift:"Shift"},c=(0,o.default)(u),p={backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,capslock:20,esc:27,space:32,pageup:33,pagedown:34,end:35,home:36,left:37,up:38,right:39,down:40,ins:45,del:46,meta:224};t.SpecialKeyMap=p;var h={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},f={option:"alt",command:"meta",return:"enter",escape:"esc",plus:"+"};class _ extends l.Component{constructor(...e){super(...e),this._setRef=e=>{this._ref=e,this.props.onRef&&this.props.onRef(e)},this.getElement=()=>this._ref,this.focused=!1,this.onKeyDown=e=>{var{handlers:t}=this.props;t&&Object.keys(t).forEach((r=>{var a=t[r];if(null!=a){var i=this.normalizeKM(r),[n]=i;h[n]&&this.matchHandler(i,e)&&(e.persist(),a(e))}}))},this.onKeyPress=e=>{var{handlers:t}=this.props;t&&Object.keys(t).forEach((r=>{var a=t[r];if(null!=a){var i=this.normalizeKM(r),[n]=i;h[n]||this.matchHandler(i,e)&&(e.persist(),a(e))}}))},this.onFocus=e=>{this.focused=!0,this.props.onFocus(e)},this.onBlur=e=>{this.focused=!1,this.props.onBlur(e)}}matchHandler([e,t],r){return e===r.which&&c.every((e=>t&&e===t?r.getModifierState(t):!r.getModifierState(e)))}normalizeKM(e){var[t,r]=e.toLowerCase().split("+");f[t]&&(t=f[t]),f[r]&&(r=f[r]);var a,i=t;return r?(i=r,void 0===(a=u[t])?__LOG__(3)`Invalid HotKey Modifier: ${t}`:void 0===i&&__LOG__(3)`Invalid HotKey Key: ${r}`):void 0===i&&__LOG__(3)`Invalid HotKey Key: ${t}`,[p[i]||i.charCodeAt(0),a]}componentDidMount(){this.focused=!1}componentWillUnmount(){if(!0===this.focused){var e=document.activeElement;this._ref===e&&d.default.Manager.refocusTopUie()}}render(){var e=this.props,{component:t,handlers:r,children:a,onRef:i}=e,o=(0,s.default)(e,["component","handlers","children","onRef"]),d=r&&Object.keys(r).some((e=>null!=r[e]));return l.createElement(t,(0,n.default)({ref:this._setRef,tabIndex:"-1",onKeyPress:d?this.onKeyPress:null,onKeyDown:d?this.onKeyDown:null},o,{onFocus:this.onFocus,onBlur:this.onBlur}),a)}}t.default=_,_.defaultProps={component:"div",onFocus:()=>{},onBlur:()=>{}},_.flashFocus=Date.now(),_.displayName="Hotkeys"},48943:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MmsDownloadFilehashMismatchError=t.default=void 0;var a=r(71436);class i extends((0,a.customError)("HttpInvalidResponseError")){constructor(e,t){super(null!=t&&null!=t.url?`${e}: ${t.url}`:e)}}t.default=i;t.MmsDownloadFilehashMismatchError=class extends i{constructor(e){super("mmsDownload: filehash mismatch",e),this.name="MmsDownloadFilehashMismatchError"}}},28281:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(71436);class i extends((0,a.customError)("HttpNetworkError")){constructor(e,t){super(null!=t&&null!=t.url?`${e}: ${t.url}`:e)}}t.default=i},48054:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(71436);class i extends((0,a.customError)("HttpStatusCodeError")){constructor(e,t,r){super(null!=r&&null!=r.url?`${t}: ${e} ${r.url}`:`${t}: ${e}`),this.status=e}}t.default=i},11995:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(28281));class n extends i.default{constructor(e,t){super(e,t),this.name="HttpTimedOutError"}}t.default=n},87243:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"AbortError",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(t,"HttpInvalidResponseError",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(t,"MmsDownloadFilehashMismatchError",{enumerable:!0,get:function(){return s.MmsDownloadFilehashMismatchError}}),Object.defineProperty(t,"HttpNetworkError",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(t,"HttpStatusCodeError",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(t,"HttpTimedOutError",{enumerable:!0,get:function(){return d.default}});var n=i(r(3599)),s=a(r(48943)),o=i(r(28281)),l=i(r(48054)),d=i(r(11995))},22448:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t={}){return p(e,t).catch((e=>{if(e.name===s.ABORT_ERROR)throw new s.default;if(e instanceof l.HttpNetworkError)throw e;throw new l.HttpNetworkError(e.message)}))},t.sharedFetch=p;var n=i(r(70417)),s=a(r(3599)),o=i(r(12588)),l=r(87243),d=i(r(27745)),u=i(r(11204)),c=i(r(70856));function p(e,t={}){return new Promise(((r,a)=>{if(t.signal&&t.signal.aborted)a(new o.default("AbortError"));else{var i=new XMLHttpRequest;if(t.signal){var s=t.signal;s.addEventListener("abort",(function e(){s.removeEventListener("abort",e),i.onreadystatechange=()=>{},i.abort(),a(new o.default("AbortError"))}))}var{onProgress:p,onResponseText:h}=t;(null!=p||h)&&(i.onprogress=e=>{h&&h(e,i.responseText),p&&p(e)}),i.onreadystatechange=()=>{if(0===i.readyState)a(new Error("fetch error: not sent"));else if(4===i.readyState){if(null==i.status)return void a(new Error("fetch error: no status"));if(0===i.status||i.status>=12e3)return void a(new Error(`fetch error: unexpected status ${i.status}`));r(_())}},i.onerror=()=>a(new Error("fetch error: error")),i.ontimeout=()=>{a(new l.HttpTimedOutError("fetch error: timedout",{url:e.toString()}))},i.withCredentials="include"===t.credentials,null!=t.timeout&&(i.timeout=t.timeout),i.open(t.method||"get",e.toString(),!0);var f=new u.default(t.headers||{});(0,d.default)(f.keys(),(e=>{var t=f.get(e);null!=t&&i.setRequestHeader(e,t)})),h?i.overrideMimeType("text/plain; charset=x-user-defined"):i.responseType="arraybuffer",i.send(t.body||null)}function _(){var e=new u.default((0,c.default)(i.getAllResponseHeaders()));return(0,n.default)((0,n.default)({ok:200<=i.status&&i.status<300,statusText:i.statusText,status:i.status,url:i.responseURL},h?{text:()=>Promise.resolve(i.responseText),json:()=>Promise.resolve(JSON.parse(i.responseText)),arrayBuffer:()=>{return Promise.resolve((e=i.responseText,(t=new Uint8Array(e.length)).set([...e].map((e=>e.codePointAt(0)))),t.buffer));var e,t}}:{text:()=>m(),json:()=>m().then((e=>JSON.parse(e))),arrayBuffer:()=>i.response}),{},{blob:()=>Promise.resolve(new Blob([i.response],{type:e.get("content-type")||""})),clone:_,headers:e})}function m(){return Promise.resolve(String.fromCharCode(...new Uint8Array(i.response)))}}))}},70856:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(e||"").trim().toLowerCase().split("\n").reduce(((e,t)=>{if(!t.trim())return e;var r=t.indexOf(":"),a=t.substr(0,r).trim(),i=t.substr(r+1).trim().replace(/;$/,"");return e[a]?Array.isArray(e[a])?e[a].push(i):e[a]+=`, ${i}`:e[a]=i,e}),{})}},5967:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.deleteIdentity=function(e){return Promise.all([(0,a.deleteRemoteInfo)(e),(0,a.deleteDeviceSenderKey)(e)]).catch((()=>{__LOG__(2)`handleDevicesNotification: failed to clean the signal info for ${e.user}`})).then((()=>{}))};var a=r(67918)},70338:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.generateADVSecretKey=function(){var e=new Uint8Array(32);self.crypto.getRandomValues(e);var t=(0,l.encodeB64)(e);return(0,_.setADVSecretKey)(t),t},t.getADVSecretKey=function(){var e=(0,_.getADVSecretKey)();if(null==e)throw new Error("MD secretKey is null or undefined");return e},t.setADVSignedIdentity=function(e){if(null==e)return Promise.reject(new Error("MD advSignedDeviceIdentity is null or undefined"));if(null==e.deviceSignature)return Promise.reject(new Error("MD advSignedDeviceIdentity is missing deviceSignature"));return m.waSignalStore.putADVSignedIdentity(e)},t.getADVEncodedIdentity=function(){return b.apply(this,arguments)},t.verifyDeviceIdentityAccountSignature=C,t.generateDeviceSignature=function(e,t,r){var a=e.details,i=o.Binary.build(T,a,t.pubKey,r).readByteArray().buffer;return window.libsignal.Curve.calculateSignature(t.privKey,i)},t.verifyDeviceSignature=P,t.clearADVSecretKey=function(){(0,_.setADVSecretKey)(void 0)},t.validateADVwithIdentityKey=O,t.validateADVwithEncs=function(e,t,r){if(!h.default.supportsFeature(h.default.F.MD_ADV))return Promise.resolve(!0);var a=r.find((e=>e.e2eType===g.CiphertextType.Pkmsg));if(!a)return Promise.resolve(!0);__LOG__(2)`validateADVwithEncs: start validate prekey msg `;try{(0,d.default)(null!=e,"author should not be null");var i=(0,v.extractIdentityKey)(a.ciphertext);return(0,d.default)(null!=i,"identityKey should not be null"),O(e,t,new Uint8Array(i))}catch(e){return __LOG__(3)`validateADVwithEncs: failed ${e}`,Promise.resolve(!1)}},t.verifyKeyIndexListAccountSignature=function(e,t){var r=e.details,a=e.accountSignature;(0,d.default)(null!=a,"accountSignature should not be null");var i=o.Binary.build(A,r).readByteArray();return(0,p.verifySignature)(new Uint8Array(t),i,new Uint8Array(a))};var i=a(r(52954)),n=r(9557),s=r(76549),o=r(49244),l=r(84337),d=a(r(47677)),u=r(38550),c=r(41026),p=r(446),h=a(r(20468)),f=r(24581),_=r(63191),m=r(24606),g=r(47294),v=r(8456),E=r(69909),y=r(25054),S=new Uint8Array([6,0]),T=new Uint8Array([6,1]),A=new Uint8Array([6,2]);function b(){return(b=(0,i.default)((function*(){var e=yield m.waSignalStore.getADVSignedIdentity();if(null==e)throw new Error("MD advSignedDeviceIdentity is null or undefined");if(null==e.deviceSignature)throw new Error("MD advSignedDeviceIdentity is missing deviceSignature");return(0,s.encodeProto)(u.ADVSignedDeviceIdentitySpec,e).readByteArray()}))).apply(this,arguments)}function C(e,t,r){var a=e.details,i=e.accountSignatureKey||r;(0,d.default)(null!=i,"accountSignatureKey should not be null");var n=e.accountSignature;(0,d.default)(null!=n,"accountSignature should not be null");var s=o.Binary.build(S,a,t).readByteArray();return(0,p.verifySignature)(new Uint8Array(i),s,new Uint8Array(n))}function P(e,t,r){var a=e.details,i=e.deviceSignature;(0,d.default)(null!=i,"deviceSignature should not be null");var n=e.accountSignatureKey||r;(0,d.default)(null!=n,"accountSignatureKey should not be null");var s=o.Binary.build(T,a,t,n).readByteArray();return(0,p.verifySignature)(new Uint8Array(t),s,new Uint8Array(i))}function O(){return w.apply(this,arguments)}function w(){return(w=(0,i.default)((function*(e,t,r){if(!h.default.supportsFeature(h.default.F.MD_ADV))return!0;try{var a=(0,c.uint8ArrayToBuffer)(r),i=yield m.waSignalStore.getIdentity((0,E.createSignalAddress)(e).toString());if(i){var s=(0,p.toCurveKeyPubKey)((0,E.strToBuffer)(i));if((0,E.bufferEqual)(s,a))return!0}var o=(0,n.decodeProto)(u.ADVSignedDeviceIdentitySpec,t);(0,d.default)(null!=o,"advSignedDeviceIdentity should not be null");var l=yield m.waSignalStore.getIdentity((0,E.createSignalAddress)((0,y.toUserWid)(e)).toString()),_=l?(0,p.toCurveKeyPubKey)((0,E.strToBuffer)(l)):null;if(!C(o,a,_))return __LOG__(3)`validateADVIdentity: invalid account signature`,!1;if(!P(o,a,_))return __LOG__(3)`validateADVIdentity: invalid device signature`,!1;var g=(0,n.decodeProto)(u.ADVDeviceIdentitySpec,o.details);(0,d.default)(null!=g,"advDeviceIdentity should not be null");try{yield(0,f.handleADVDeviceUpdateForMessage)(e,g,_,o.accountSignatureKey,a)}catch(e){return __LOG__(3)`validateADVIdentity: process adv device identity failed`,!1}return __LOG__(2)`validateADVIdentity: successfully verified accountSignature and deviceSignature`,!0}catch(e){return __LOG__(3)`validateADVIdentity: failed`,!1}}))).apply(this,arguments)}},64757:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.getICDCMeta=function(){return m.apply(this,arguments)},t.computeIdentityHash=g;var i=a(r(52954)),n=r(37444),s=r(95334),o=r(71796),l=a(r(23045)),d=r(446),u=r(6011),c=r(66239),p=a(r(26625)),h=a(r(62549)),f=r(48324),_=r(25054);function m(){return(m=(0,i.default)((function*(e){if(!1===(0,o.getABPropConfigValue)("md_icdc_enabled"))return null;var t=yield(0,u.getTable)().get(e.user);if(!t)return null;var r={keyHash:void 0,timestamp:void 0},{timestamp:a,devices:i}=t,n=i.some((e=>e.id!==l.default.DEVICE.PRIMARY_DEVICE));if(n){var s=i.map((e=>(0,_.createDeviceWidFromUserAndDevice)(t.id,e.id))).filter((e=>!e.equals((0,c.assertGetMe)()))),h=yield(0,f.getAllIdentityKeysBytes)(s);if((0,c.assertGetMe)().user===e.user){var m=yield p.default.getIdentityKeyPair();if(!m)return null;h.push(new Uint8Array(m.pubKey))}var v=E();r.keyHash=yield g(h.map((e=>new Uint8Array((0,d.toCurveKeyPubKey)(e.buffer)))),v)}return(n||y(a))&&(r.timestamp=a),r}))).apply(this,arguments)}function g(){return v.apply(this,arguments)}function v(){return(v=(0,i.default)((function*(e,t){var r=(0,f.identityKeysToBinary)(e),a=yield h.default.digest({name:"SHA-256"},r),i=new Uint8Array(a);return(0,n.sliceBytes)(i,0,t)}))).apply(this,arguments)}function E(){var e=(0,o.getABPropConfigValue)("md_icdc_hash_length");return Math.max(e,8)}function y(e){return(0,s.unixTime)()-e<2592e3}},48324:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.getAllIdentityKeysBytes=function(){return d.apply(this,arguments)},t.identityKeysToBinary=function(e){var t=new n.Binary;return e.sort(l).forEach((e=>{t.writeByteArray(e)})),t.readByteArray()};var i=a(r(52954)),n=r(49244),s=r(24606),o=r(69909);function l(e,t){for(var r=0;r<e.length&&r<t.length;++r)if(e[r]!==t[r])return e[r]-t[r];return e.length-t.length}function d(){return(d=(0,i.default)((function*(e){for(var t=yield s.waSignalStore.bulkGetIdentity(e.map((e=>(0,o.createSignalAddress)(e).toString()))),r=[],a=0;a<t.length;a++){var i=t[a];if(null==i)throw new Error(`getAllIdentityKeys: missing identity key for device ${String(e[a])}`);r.push(new Uint8Array((0,o.strToBuffer)(i)))}return r}))).apply(this,arguments)}},31046:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UIBusyTasks=t.IdleCallbackTasks=t.IdleEnum=void 0;var a=r(35160),i=r(50788),n=r(28103).Mirrored(["IDLE_CALLBACK","UI_BUSY"]);t.IdleEnum=n;class s{constructor(e){this.busyMap=new Map,this.busyId=0,this._clearBusyMap=()=>{this.busyMap.clear()},this._taskMap=new Map,this.taskId=0,this.runIdleLoop=()=>{this.idleType===n.IDLE_CALLBACK?this.idleCallbackId=(0,i.requestIdleCallback)(this._ricOnIdle):this.isIdle()&&this._uiBusyOnIdle()},this._ricOnIdle=e=>{for(var t,r=this._taskMap.entries();(t=r.next())&&!t.done;){var[a,i]=t.value;if(i(),this._taskMap.delete(a),e.timeRemaining()<=0)break}this._taskMap.size>0&&this.runIdleLoop()},this.idleType=e}setBusy(e){var t=e;return null!=t&&this.busyMap.has(t)?this.busyMap.set(t,this.busyMap.get(t)+1):(t=++this.busyId,this.busyMap.set(t,1)),this.busyTimer||(this.busyTimer=new a.ShiftTimer(this._clearBusyMap)),this.busyTimer.debounce(1e3),t}decBusy(e){if(null!=e){var t=this.busyMap.get(e);null!=t&&0!==t&&(1===t?this.clearBusy(e):this.busyMap.set(e,t-1))}}clearBusy(e){null!=this.busyMap.get(e)&&this.busyMap.delete(e),this.isIdle()&&(this.busyTimer.cancel(),this._taskMap.size>0&&window.setTimeout(this.runIdleLoop,0))}isIdle(){return 0===this.busyMap.size}isBusy(){return this.busyMap.size>0}cancelIdleLoop(){this.idleType===n.IDLE_CALLBACK&&null!=this.idleCallbackId&&(0,i.cancelIdleCallback)(this.idleCallbackId)}_uiBusyOnIdle(){for(var e,t=this._taskMap.entries();(e=t.next())&&!e.done;){var[r,a]=e.value;if(a(),this._taskMap.delete(r),this.isBusy())break}}enqueue(e){return this._taskMap.set(++this.taskId,e),1===this._taskMap.size&&this.runIdleLoop(),this.taskId}dequeue(e){var t=this._taskMap.delete(e);return t&&0===this._taskMap.size&&this.cancelIdleLoop(),t}isInQueue(e){return this._taskMap.has(e)}}var o=new s(n.UI_BUSY);t.UIBusyTasks=o;var l=new s(n.IDLE_CALLBACK);t.IdleCallbackTasks=l},64453:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.generateVideoThumbsAndDuration=function(){return A.apply(this,arguments)},t.crop=function(e,t,r,a,i,n,o,l=E){return(e instanceof HTMLCanvasElement?Promise.resolve(e):f.loadImage(e)).then((e=>{var d=document.createElement("canvas"),u=d.getContext("2d");null==n||null==o?(d.height=i,d.width=a,u.drawImage(e,t,r,a,i)):(d.height=o,d.width=n,u.drawImage(e,t,r,a,i,0,0,n,o));var c={};return P(c,d,l),(0,s.promiseProps)(c).then((e=>({images:e,width:a,height:i})))}))},t.toDataUrlWithRoundedCorners=function(e){return(e instanceof HTMLCanvasElement?Promise.resolve(e):f.loadImage(e)).then((e=>{var t=document.createElement("canvas"),r=t.getContext("2d");t.height=e.height,t.width=e.width;var a=Math.min(e.width,e.height);return r.beginPath(),r.arc(e.width/2,e.height/2,a/2,0,2*Math.PI,!0),r.clip(),r.closePath(),r.drawImage(e,0,0),t.toDataURL("image/png")}))},t.generateLinkPreview=function(e){return f.loadImage(e).then((e=>{var t=140;if(e.width<100||e.height<100)return __LOG__(2)`Image size too small for link preview`,null;var r=document.createElement("canvas"),a=r.getContext("2d");r.height=t,r.width=t;var i=Math.min(e.width,e.height),n=(e.width-i)/2,s=(e.height-i)/2;return a.drawImage(e,n,s,i,i,0,0,t,t),r.toDataURL("image/jpeg").replace(/^data:image\/jpeg;base64,/,"")})).catch((()=>(__LOG__(2)`link preview image generation failed: `,null)))},t.toDataUrl=function(e){return f.loadImage(e).then((e=>{var t=document.createElement("canvas"),r=t.getContext("2d");return t.height=e.height,t.width=e.width,r.drawImage(e,0,0),t.toDataURL("image/jpeg").replace(/^data:image\/jpeg;base64,/,"")})).catch((()=>(__LOG__(2)`data URL conversion failed: `,null)))},t.rotateAndResize=function(e,t,r){var a,i,n,l=new ArrayBuffer(0);e instanceof HTMLCanvasElement?(i=Promise.resolve(e),n=Promise.resolve(l)):(a=window.URL.createObjectURL(e),i=f.loadImage(a),n=(0,c.blobToArrayBuffer)(e).catch((e=>(__LOG__(3)`ImageUtils::rotateAndResize error: ${e}`,l))));return(0,s.promiseProps)({buffer:n,image:i}).then((({buffer:e,image:a})=>{var i={};try{i=(0,o.default)(e)}catch(e){}var n=0;switch(i.orientation||"UNKNOWN"){case"right-top":n=1;break;case"left-bottom":n=-1;break;case"bottom-right":n=2}var l=document.createElement("canvas"),d=a.naturalWidth||a.width,u=a.naturalHeight||a.height,c=l.getContext("2d"),f={};if(!n){var _,m,g=(0,p.boundHeightWidth)(u,d,t),v=r&y;if(e&&v&&d===g.width&&u===g.height)try{var E=(0,h.cleanJPEG)(e);f.blob=E,v=!1,_=d,m=u}catch(e){__LOG__(2)`Could not parse JPEG: ${e.message}`}return(v||r&~y)&&(l.width=g.width,l.height=g.height,_=l.width,m=l.height,w(l),c.drawImage(a,0,0,_,m),P(f,l,r)),(0,s.promiseProps)(f).then((e=>({width:_,height:m,images:e})))}switch(n){case 1:case-1:var S=Math.max(d,u),T=S/2;l.width=l.height=S,w(l),O(c,{x:T,y:T,degrees:90*n}),1===n?c.drawImage(a,0,S-u):c.drawImage(a,S-d,0),O(c,{x:T,y:T,degrees:-90*n}),function(e,t,r){var a=e.getContext("2d"),i=a.getImageData(0,0,t,r);e.width=t,e.height=r,a.putImageData(i,0,0)}(l,u,d);var A=function(e,t){var{width:r,height:a}=(0,p.boundHeightWidth)(e.height,e.width,t);if(r>e.width&&a>e.height)return e;var i=document.createElement("canvas"),n=i.getContext("2d");return i.width=r,i.height=a,n.drawImage(e,0,0,r,a),i}(l,t);return P(f,A,r),(0,s.promiseProps)(f).then((e=>({width:A.width,height:A.height,images:e})));case 2:var b=(0,p.boundHeightWidth)(u,d,t),C=l.width=b.width,M=l.height=b.height;return w(l),O(c,{x:C/2,y:M/2,degrees:90*n}),c.drawImage(a,0,0,C,M),O(c,{x:C/2,y:M/2,degrees:-90*n}),P(f,l,r),(0,s.promiseProps)(f).then((e=>({width:l.width,height:l.height,images:e})))}})).finally((()=>{a&&window.URL.revokeObjectURL(a)}))},t.canvasToBlob=b,t.urlToFile=function(e){return f.loadImage(e).then((e=>{var t=document.createElement("canvas");t.width=e.naturalWidth,t.height=e.naturalHeight;var r=t.getContext("2d");return w(t),r.drawImage(e,0,0),b(t)})).catch((()=>Promise.reject(new d.MediaDragDropError("unable to render image",e))))},t.isCached=function(e){if(!e)return!1;var t=new Image;return t.src=e,!!t.complete},t.getResizedDataUrl=function(e,t="image/jpeg",r){var a=e.toDataURL(t);if(window.dataURLtoBlob(a).size<=r)return e.toDataURL(t);for(var i=.9;i>=.1;i-=.1){var n=e.toDataURL(t,i);if(window.dataURLtoBlob(n).size<=r)return n}return null},t.generateMicroThumb=function(){return C.apply(this,arguments)},t.base64ImageToCanvas=function(){return I.apply(this,arguments)},t.CANVAS=t.BLOB=t.DATA_URL=void 0;var n=i(r(52954)),s=r(9737),o=i(r(86120)),l=i(r(45026)),d=a(r(24461)),u=i(r(95469)),c=r(48537),p=r(30020),h=r(49034),f=a(r(28119)),_=i(r(93013)),m=i(r(11018)),g=2,v=4,E=1;t.DATA_URL=E;var y=g;t.BLOB=y;var S=v;t.CANVAS=S;var T=({video:e,fullWidth:t,fullHeight:r,maxDimension:a})=>{var i=document.createElement("canvas"),{width:n,height:s}=(0,p.boundHeightWidth)(r,t,a);i.width=n,i.height=s;var o=i.getContext("2d");o.drawImage(e,0,0,n,s);var l=o.getImageData(0,0,n,s);return{thumb:{url:i.toDataURL("image/jpeg"),width:n,height:s,fullWidth:t,fullHeight:r},imageData:l}};function A(){return(A=(0,n.default)((function*(e){var{file:t,maxDimensions:r,debugHint:a}=e,{video:i,fullWidth:n,fullHeight:s}=yield f.loadVideo(t,!0),o=e=>{for(var t=e.width*e.height/4,r=0;r<=1;r+=.25){var a=4*Math.round(t*r);if(0!==e.data[a])return!1;if(0!==e.data[a+1])return!1;if(0!==e.data[a+2])return!1;var i=e.data[a+3];if(0!==i&&255!==i)return!1}return!0};if(m.default.isBuggyVideoLoad){return(0,u.default)({minTimeout:50,maxTimeout:50,retries:100,signal:(new l.default).signal,factor:1},((e,t)=>{var l,d=[];for(l of r){var{thumb:u,imageData:c}=T({video:i,fullHeight:s,fullWidth:n,maxDimension:l});if(o(c)){if(t<100)return t>0&&(__LOG__(2)`generateVideoThumbsAndDuration: Setting video.currentTime to 0 to attempt to unblock the video`,i.currentTime=0),e(new Error("retry"));__LOG__(4,void 0,new Error,!0)`generateVideoThumbsAndDuration: Failed to generate video thumbnail from ${a}`,SEND_LOGS(`thumbnail-generation-failed-${a}`)}d.push(u)}var p={duration:~~i.seekable.end(0),thumbs:d};return f.disposeVideo(i),Promise.resolve(p)}))}try{var d=r.map((e=>{var{thumb:t,imageData:r}=T({video:i,fullHeight:s,fullWidth:n,maxDimension:e});return o(r)&&(__LOG__(4,void 0,new Error,!0)`generateVideoThumbsAndDuration: Failed to generate video thumbnail from ${a}`,SEND_LOGS(`thumbnail-generation-failed-${a}`)),t}));return{duration:~~i.seekable.end(0),thumbs:d}}finally{f.disposeVideo(i)}}))).apply(this,arguments)}function b(e,t="image/jpeg"){return e.toBlob?new Promise((function(t){e.toBlob(t,"image/jpeg")})):Promise.resolve(window.dataURLtoBlob(e.toDataURL("image/jpeg")))}function C(){return(C=(0,n.default)((function*(e,t,r){for(var a,i,n=r||{},s=null!==(a=n.mimetype)&&void 0!==a?a:"image/jpeg",o=null!==(i=n.maxAttempts)&&void 0!==i?i:10,l=.5,d=e,u=yield b(d,s),c=0;c<o&&!(u.size<=t);c++){var p=Math.floor(e.width*l),h=Math.floor(e.height*l);(d=M(p,h)).getContext("2d").drawImage(e,0,0,p,h),u=yield b(d,s),l*=.5}return{opaqueData:yield _.default.createFromData(u,s),width:d.width,height:d.height,dataUrl:d.toDataURL("image/jpeg")}}))).apply(this,arguments)}function P(e,t,r){!e.blob&&r&y&&(e.blob=b(t)),!e.dataUrl&&r&E&&(e.dataUrl=Promise.resolve(t.toDataURL("image/jpeg"))),!e.canvas&&r&S&&(e.canvas=Promise.resolve(t))}function O(e,t){var r=t.x||0,a=t.y||0;t.degrees&&(t.radians=t.degrees*(Math.PI/180)),e.translate(r,a),e.rotate(t.radians),e.translate(-r,-a)}function w(e){var t=e.getContext("2d");t.fillStyle="rgb(247,247,247)",t.fillRect(0,0,e.width,e.height)}function M(e,t){var r=document.createElement("canvas");return r.width=e,r.height=t,r}function I(){return(I=(0,n.default)((function*(e){var t=yield f.loadImage(e),r=M(t.width,t.height);return r.getContext("2d").drawImage(t,0,0),r}))).apply(this,arguments)}},68749:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default=class{constructor(){this._lastPromise=Promise.resolve(),this._pending=[]}enqueue(e){e.catch((()=>{}));var t=()=>e;this._lastPromise=this._lastPromise.then(t,t);var r=this._lastPromise.cancellable();return this._pending.push(r),r.finally((()=>{this._pending.length>0&&this._pending[0]===r&&this._pending.shift()}))}cancelAll(e){var t=this._pending;this._pending=[],t.forEach((t=>{t.cancel(e)}))}}},7010:(e,t)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;try{r=self.indexedDB}catch(e){}var a=r;t.default=a},99117:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.waNoiseInfo=t.deviceInfo=void 0;var a=r(63191);var i=new class{get(){return{osVersion:"0.1",osBuild:"0.1",hardware:"desktop",manufacturer:"",device:"Desktop",lg:"en",lc:"en",mcc:"000",mnc:"000",sim_mnc:"000",sim_mcc:"000"}}};t.deviceInfo=i;var n=new class{get(){return(0,a.getNoiseInfo)()}set(e){return(0,a.setNoiseInfo)(e)}};t.waNoiseInfo=n},9676:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=0,r=e.charCode,a=e.keyCode;null!=r&&0!==r?t=r:null!=a&&0!==a&&(t=a);return i.has(t)};var a=r(19058),i=new Set([a.SpecialKeyMap.enter,a.SpecialKeyMap.space])},14891:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(28817));class n extends i.default{constructor(e){super(),this._array=e.slice()}_next(){return 0===this._array.length?this.return():{done:!1,value:this._array.shift()}}}t.default=n},82819:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.defaults=void 0;var i=a(r(70417)),n=a(r(83794)),s={factor:2,jitter:0,maxTimeout:1/0};t.defaults=s;class o extends n.default{constructor(e){super(null==e.factor?s.factor:e.factor),this._opts=(0,i.default)((0,i.default)({},s),e),this._retryCount=0}_next(){var{jitter:e,maxTimeout:t,minTimeout:r,retries:a}=this._opts,i=super._next();if(i.done)return i;if(this._retryCount++,this._retryCount>a)return this.return();var n=r*i.value;return n*=Math.random()*e*2-e+1,{done:!1,value:n=Math.min(n,t)}}}t.default=o},83794:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(28817));class n extends i.default{constructor(e){super(),this._base=e,this._value=1}_next(){var e=this._value;return this._value=e*this._base,{done:!1,value:e}}}t.default=n},27745:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var r=0,a=e.next();for(;!a.done;)t(a.value,r,e),a=e.next(),r++}},28817:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i,n=a(r(88329));i=n.default.iterator;t.default=class{constructor(){this._done=!1}[i](){return this}next(){return this._done?{done:!0,value:void 0}:this._next()}_next(){throw new Error("unimplemented")}return(){return this._done=!0,this.next()}}},89799:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return new n(e,t)};var i=a(r(28817));class n extends i.default{constructor(e,t){super(),this._iterator=e,this._mapper=t,this._n=0}_next(){var e=this._iterator.next();if(e.done)return this.return();var t=this._mapper(e.value,this._n,this._iterator);return this._n++,{done:!1,value:t}}}},34535:(e,t,r)=>{"use strict";var a=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"CLOCK_CHANGE_BACKWARDS_EVENT",{enumerable:!0,get:function(){return i.CLOCK_CHANGE_BACKWARDS_EVENT}}),Object.defineProperty(t,"JS_HALT_EVENT",{enumerable:!0,get:function(){return i.JS_HALT_EVENT}}),t.default=t.DEFAULT_INTERVAL=t.DEFAULT_THRESHOLD=void 0;var i=a(r(81405));t.DEFAULT_THRESHOLD=3e3;t.DEFAULT_INTERVAL=1e4;var n=new i.default(1e4,3e3);n.startDetection();var s=n;t.default=s},89765:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t={};for(var r in e)e.hasOwnProperty(r)&&(t[r]=r);return t}},11200:(e,t,r)=>{"use strict";var a=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(2784)).createContext(!1);t.default=i},15195:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.LOCALES_THAT_PREFER_24HOUR_TIME=t.LOCALE_CUSTOMIZATIONS=t.SHOULD_USE_MOMENT_LOCALE_FORMAT=t.LOCALE_DATE_TIME_CUSTOMIZATIONS=t.default=void 0;var i=a(r(70417)),n=a(r(42164)),s=a(r(52850)),o=a(r(19034)),l=a(r(23045)),d=a(r(71107)),u=r(4648),c=a(r(83821)),p=a(r(10288)),h=a(r(95418)),f=new Set(["",""]),_=new Set(["ar","ar-XB","fa","ur","he","dv","ku"]),m=new Set(["ar","ar-XB","fa"]),g="".split("");function v(e){return g[parseInt(e,10)]}var E=new Error("Unimplemented method");class y extends d.default{constructor(e,t,r){if(super(),!e||!t)throw E;this._locale=e,this.localeStrings={},this.localeStrings[l.default.L10N.DEFAULT]=t,this.markTranslations=r,this.customizeMoment()}getLocale(){throw E}setLocale(){throw E}normalizeLocale(e){var t=e.replace(/-/g,"_").toLowerCase(),r=this._getTranslationFilename(t);if(r)return r;for(var a=t;a;){var i=(a=a.split("_").slice(0,-1).join("_"))&&this._getTranslationFilename(a);if(i)return i}}isLocaleSupported(e){return!!e&&!!this.normalizeLocale(e)}_getTranslationFilename(e){var t=c.default[e]||e;return h.default[t]}lng(){var e=this.getLocale();return h.default[e]||e}isRTL(e=this.getLocale()){return _.has(e)}LR(e,t){return this.isRTL()?t:e}embedDir(e,t=this.isRTL()){return t?this.embedRTL(e):this.embedLTR(e)}forceDir(e,t=this.isRTL()){return t?this.forceRTL(e):this.forceLTR(e)}embedLTR(e){return""+e+""}embedRTL(e){return""+e+""}isolateLTR(e){return""+e+""}isolateRTL(e){return""+e+""}forceLTR(e){return""+e}forceRTL(e){return""+e}t(e,t,r){"number"!=typeof e&&__LOG__(3)`l10n.t was called with an unprocessed id (${e}). If you just added a string on local, restarting your build may address the issue.`;var a=e,i=null!=t?t._plural:null,n=r||this.getLocale();this.localeStrings[n]||(n=l.default.L10N.DEFAULT);var s=this._getString(a,n,i);for(var o in this.markTranslations&&(s?n===l.default.L10N.DEFAULT&&(s="["+s+"]"):(s="!!"+a+"!!",__LOG__(2)`l10n:t string key "${a}" not found`)),s||(s=this._getString(a,l.default.L10N.DEFAULT,i)),s||__LOG__(2)`l10n:t string key "${a}" fallback failed`,t)if(t.hasOwnProperty(o)&&"_plural"!==o){var d=new RegExp("__"+o+"__","g"),u=void 0;u="string"==typeof t[o]&&f.has(t[o].slice(0,1))?t[o]:this.n(t[o],n),s=s.replace(d,u)}return s}_getString(e,t,r){var a=this.localeStrings[t]||this.localeStrings[l.default.L10N.DEFAULT];if(null==a)throw new Error(`Couldn't find translations for locale ${t} or default (${l.default.L10N.DEFAULT})`);if(!Array.isArray(a))throw new Error("Unexpected locale format.");var[i,n]=a,s=i[e]||"";if(null==r)return s;var o=p.default[t];if(null==o)return s;var d=o.numbers[o.plurals(r)];return 1===d?s:n[2===o.numbers.length&&2===d?e.toString():`${e}_${d}`]||s}useArabicScriptDigits(e){return m.has(e||this.getLocale())}isLatinAlphabetLanguage(e){return s.default.isLatin(this.removeAccents(e))}n(e,t){var r=e;return isNaN(r)||(r=r.toString()),this.useArabicScriptDigits(t)?r.toString().replace(/[0-9]/g,v):r}filesize(e){var t=this;return this.n((0,n.default)(e,{base:2,round:0,suffixes:{B:t.t(662),kB:t.t(664),MB:t.t(665),GB:t.t(663)}}))}normalizeForm(e=""){return(0,u.normalizeForm)(e)}removeAccents(e=""){return(0,u.removeAccents)(e)}accentFold(e=""){return this.removeAccents(e).toLowerCase()}customizeMoment(){o.default.relativeTimeRounding(Math.floor),o.default.relativeTimeThreshold("s",60),o.default.relativeTimeThreshold("m",60),o.default.relativeTimeThreshold("h",24)}}t.default=y;var S={"zh-tw":{longDateFormat:{LT:"Ah:mm",LTS:"Ah:m:s",L:"YYYYMMMD",LL:"YYYYMMMD",LLL:"YYYYMMMDLT",LLLL:"YYYYMMMDddddLT",l:"YYYYMMMD",ll:"YYYYMMMD",lll:"YYYYMMMDLT",llll:"YYYYMMMDddddLT"}},"zh-cn":{longDateFormat:{LT:"Ah:mm",LTS:"Ah:m:s",L:"YYYY-MM-DD",LL:"YYYYMMMD",LLL:"YYYYMMMDLT",LLLL:"YYYYMMMDddddLT",l:"YYYYMMMD",ll:"YYYYMMMD",lll:"YYYYMMMDLT",llll:"YYYYMMMDddddLT"}},ar:{longDateFormat:{LT:"h:mm A",LTS:"HH:mm:ss",L:"YYYY/MM/DD",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd D MMMM YYYY LT"}},ta:{longDateFormat:{LT:"h:mm A",LTS:"h:mm:ss A",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY h:mm A",LLLL:"dddd, D MMMM YYYY, h:mm A"},preparse:null,postformat:null,meridiem:null,meridiemHour:null},nl:{longDateFormat:{l:"DD-MM-YYYY",L:"DD-MM-YYYY"}},"en-ie":{longDateFormat:{l:"DD/MM/YYYY",L:"DD/MM/YYYY"}},hi:{preparse:null,postformat:null,longDateFormat:{LT:"A h:mm ",LTS:"A h:mm:ss ",LLL:"D MMMM YYYY A h:mm ",LLLL:"dddd, D MMMM YYYY, A h:mm "},meridiem:(e,t)=>0===e&&0===t?"":e>=20||e<4?"":e>=4&&e<12?"":e>=12&&e<16?"":""}};t.LOCALE_DATE_TIME_CUSTOMIZATIONS=S;var T=new Set(["ur"]);t.SHOULD_USE_MOMENT_LOCALE_FORMAT=T;var A=(0,i.default)((0,i.default)({},S),{"pt-pt":{weekdays:["Domingo","Segunda-feira","Tera-feira","Quarta-feira","Quinta-feira","Sexta-feira","Sbado"]}});t.LOCALE_CUSTOMIZATIONS=A;var b=new Set(["af","az","ca","cs","da","de","el","et","fi","fr","he","hr","hu","id","it","kk","lt","mk","nb","pl","pt","pt_br","ro","ru","sl","sr","sv","tr","uk"]);t.LOCALES_THAT_PREFER_24HOUR_TIME=b},4648:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.normalizeForm=n,t.removeAccents=function(e=""){return(0,i.default)(n(e).replace(/(?:[\^`\xA8\xAF\xB4\xB7\xB8\u02B0-\u034E\u0350-\u0357\u035D-\u0362\u0374\u0375\u037A\u0384\u0385\u0483-\u0487\u0559\u0591-\u05A1\u05A3-\u05BD\u05BF\u05C1\u05C2\u05C4\u064B-\u0652\u0657\u0658\u06DF\u06E0\u06E5\u06E6\u06EA-\u06EC\u0730-\u074A\u07A6-\u07B0\u07EB-\u07F5\u0818\u0819\u08E3-\u08FE\u093C\u094D\u0951-\u0954\u0971\u09BC\u09CD\u0A3C\u0A4D\u0ABC\u0ACD\u0AFD-\u0AFF\u0B3C\u0B4D\u0B55\u0BCD\u0C4D\u0CBC\u0CCD\u0D3B\u0D3C\u0D4D\u0DCA\u0E47-\u0E4C\u0E4E\u0EBA\u0EC8-\u0ECC\u0F18\u0F19\u0F35\u0F37\u0F39\u0F3E\u0F3F\u0F82-\u0F84\u0F86\u0F87\u0FC6\u1037\u1039\u103A\u1063\u1064\u1069-\u106D\u1087-\u108D\u108F\u109A\u109B\u135D-\u135F\u17C9-\u17D3\u17DD\u1939-\u193B\u1A75-\u1A7C\u1A7F\u1AB0-\u1ABD\u1B34\u1B44\u1B6B-\u1B73\u1BAA\u1BAB\u1C36\u1C37\u1C78-\u1C7D\u1CD0-\u1CE8\u1CED\u1CF4\u1CF7-\u1CF9\u1D2C-\u1D6A\u1DC4-\u1DCF\u1DF5-\u1DF9\u1DFD-\u1DFF\u1FBD\u1FBF-\u1FC1\u1FCD-\u1FCF\u1FDD-\u1FDF\u1FED-\u1FEF\u1FFD\u1FFE\u2CEF-\u2CF1\u2E2F\u302A-\u302F\u3099-\u309C\u30FC\uA66F\uA67C\uA67D\uA67F\uA69C\uA69D\uA6F0\uA6F1\uA700-\uA721\uA788-\uA78A\uA7F8\uA7F9\uA8C4\uA8E0-\uA8F1\uA92B-\uA92E\uA953\uA9B3\uA9C0\uA9E5\uAA7B-\uAA7D\uAABF-\uAAC2\uAAF6\uAB5B-\uAB5F\uAB69-\uAB6B\uABEC\uABED\uFB1E\uFE20-\uFE2F\uFF3E\uFF40\uFF70\uFF9E\uFF9F\uFFE3]|\uD800\uDEE0|\uD802[\uDEE5\uDEE6]|\uD803[\uDD22-\uDD27\uDF46-\uDF50]|\uD804[\uDCB9\uDCBA\uDD33\uDD34\uDD73\uDDC0\uDDCA-\uDDCC\uDE35\uDE36\uDEE9\uDEEA\uDF3C\uDF4D\uDF66-\uDF6C\uDF70-\uDF74]|\uD805[\uDC42\uDC46\uDCC2\uDCC3\uDDBF\uDDC0\uDE3F\uDEB6\uDEB7\uDF2B]|\uD806[\uDC39\uDC3A\uDD3D\uDD3E\uDD43\uDDE0\uDE34\uDE47\uDE99]|\uD807[\uDC3F\uDD42\uDD44\uDD45\uDD97]|\uD81A[\uDEF0-\uDEF4\uDF30-\uDF36]|\uD81B[\uDF8F-\uDF9F\uDFF0\uDFF1]|\uD834[\uDD67-\uDD69\uDD6D-\uDD72\uDD7B-\uDD82\uDD85-\uDD8B\uDDAA-\uDDAD]|\uD838[\uDD30-\uDD36\uDEEC-\uDEEF]|\uD83A[\uDCD0-\uDCD6\uDD44-\uDD46\uDD48-\uDD4A])/g,""))};var i=a(r(52850));function n(e=""){return e.normalize("NFKD")}},38637:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(r(52954)),s=r(60266),o=r(13275),l=i(r(19034)),d=a(r(15195)),u=i(r(23045)),c=r(53353),p=a(r(56179)),h=i(r(11018)),f=self.location.href;f&&f.includes("/%F0%9F%8C%90/")&&Promise.resolve().then(r.bind(r,22006)).then((({default:e})=>{e.canMuckHistory()&&window.history.replaceState({},"","/")}));var _="en-gb",m={LTR:"LTR",RTL:"RTL"},g={LTR:"style",RTL:"style_rtl"},v=u.default.L10N_PRIORITY;class E extends d.default{constructor(){super({l:u.default.L10N.DEFAULT,priority:v.DEFAULT,loc:u.default.L10N.DEFAULT},r(58299).default,u.default.MARK_TRANSLATIONS);var e=function(){if((0,c.isConnectedToPage)())return document.querySelector("html").getAttribute("loc")}(),t={};this._considerLocale(t,e,v.PREVIOUS)&&this.downloadAndSetTranslation(t)}getLocale(){return this._locale.l}getFullLocale(){return this._locale.loc.replace("_","-")}normalizeForm(e=""){if(!h.default.isTrident)return e.normalize("NFKD");try{return e.normalize("NFKD")}catch(t){return e}}setLocale(e,t){var r=this;return(0,n.default)((function*(){var a={l:r._locale.l,priority:r._locale.priority,loc:r._locale.l};return r._considerLocale(a,e,t)?r.downloadAndSetTranslation(a):Promise.resolve()}))()}isLocaleSupported(e){try{return super.isLocaleSupported(e)&&(!self.Intl||Array.isArray(self.Intl.Collator.supportedLocalesOf(e)))}catch(e){return!1}}init(e){var t,r={l:u.default.L10N.DEFAULT,priority:v.DEFAULT,loc:u.default.L10N.DEFAULT};if(this._considerLocale(r,e,v.PREVIOUS),this._considerLocale(r,(t=(f||self.location.href||"").split("/%F0%9F%8C%90/")).length>1?t[1].split("/")[0]:void 0,v.URL),this._considerLocale(r,navigator.language,v.BROWSER),navigator.languages&&navigator.languages.length)for(var a=0;a<navigator.languages.length&&!this._considerLocale(r,navigator.languages[a],v.BROWSER);a++);return this.downloadAndSetTranslation(r)}_considerLocale(e,t,r){if(!(null!=e.priority&&r<e.priority)&&null!=t&&t!==this.getLocale()){var a=this.normalizeLocale(t);return a?(e.l=a,e.priority=r,e.loc=t,e):void 0}}downloadAppLocale(e){return this.localeStrings[e]?Promise.resolve(this.localeStrings[e]):(0,o.promiseLoop)(function(){var t=(0,n.default)((function*(t,a,i){var n=(0,s.delayMs)(p.expBackoff(i,12e4,1e3,.1));return(yield r(48729)(`./${e}`)).default().then((([e])=>t(e))).catch((()=>(10===i&&(__LOG__(4,void 0,new Error,!0)`${i} times, locale is ${e}`,SEND_LOGS("downadAppLocale failure")),n)))}));return function(){return t.apply(this,arguments)}}())}downloadMomentLocale(e){var{l:t,loc:a}=e;return l.default.locale()===a?Promise.resolve():(0,o.promiseLoop)(function(){var e=(0,n.default)((function*(e,i,n){var o=(0,s.delayMs)(p.expBackoff(n,12e4,1e3,.1)),l=()=>Promise.resolve();if(a!==u.default.L10N.DEFAULT)try{l=(yield r(77062)(`./${a}`)).default}catch(e){try{l=(yield r(77062)(`./${a}`)).default}catch(e){l=()=>Promise.resolve()}}return l().then((()=>e())).catch((()=>(10===n&&(__LOG__(4,void 0,new Error,!0)`${n} times, locale is (${t}, ${a})`,SEND_LOGS("downloadMomentLocale failure")),o)))}));return function(){return e.apply(this,arguments)}}())}downloadAndSetTranslation(e){var{l:t,loc:a}=this._locale,{l:i,loc:n}=e,s=this.isRTL(i),o=s?m.RTL:m.LTR;if((0,c.isConnectedToPage)()&&i===t&&document.getElementById(g[o])&&n===a)return Promise.resolve();this._fetchPromise&&this._fetchPromise.cancel();var d,p,h=self.performance.now();return this._fetchPromise=Promise.all([this.downloadAppLocale(i),this.downloadMomentLocale(e)]).then((([t])=>{d=self.performance.now(),this.localeStrings[i]=t,this._locale=e,this.trigger("set_collator",i);var r=[n,i,_].filter((e=>!!e));l.default.locale(r),this.customizeMomentLocale(l.default.locale()),(0,c.isConnectedToPage)()&&(document.documentElement&&document.documentElement.setAttribute("lang",e.l),document.documentElement&&document.documentElement.setAttribute("dir",o)),this.trigger("locale_change",i)})).then((()=>{if(p=self.performance.now(),__LOG__(2)`l10n:locale updated: (${t}, ${a}) > (${i}, ${n}), Fetch: ${d-h}ms, Apply: ${p-d}ms`,r(55074).default.supported){var e=r(3715).default,o=r(96623).default;navigator.serviceWorker&&navigator.serviceWorker.controller&&e.request(navigator.serviceWorker.controller,o.SET_L10N,{isRTL:s,locale:i}).catch((()=>{}))}})).catch((()=>(__LOG__(2)`l10n:locale update error: (${t}, ${a}) > (${i}, ${n})`,this.downloadAndSetTranslation({l:u.default.L10N.DEFAULT,priority:v.DEFAULT,loc:u.default.L10N.DEFAULT}))))}_updateElectronMain(){}customizeMomentLocale(e){var t=d.LOCALE_CUSTOMIZATIONS[e];t&&l.default.locale(e,t)}}E.Dir=m;var y=new E;t.default=y},10288:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r={ach:{name:"Acholi",numbers:[1,2],plurals:e=>Number(e>1)},af:{name:"Afrikaans",numbers:[1,2],plurals:e=>Number(1!=e)},ak:{name:"Akan",numbers:[1,2],plurals:e=>Number(e>1)},am:{name:"Amharic",numbers:[1,2],plurals:e=>Number(e>1)},an:{name:"Aragonese",numbers:[1,2],plurals:e=>Number(1!=e)},ar:{name:"Arabic",numbers:[0,1,2,3,11,100],plurals:e=>Number(0===e?0:1==e?1:2==e?2:e%100>=3&&e%100<=10?3:e%100>=11?4:5)},arn:{name:"Mapudungun",numbers:[1,2],plurals:e=>Number(e>1)},ast:{name:"Asturian",numbers:[1,2],plurals:e=>Number(1!=e)},ay:{name:"Aymar",numbers:[1],plurals:()=>0},az:{name:"Azerbaijani",numbers:[1,2],plurals:e=>Number(1!=e)},be:{name:"Belarusian",numbers:[1,2,5],plurals:e=>Number(e%10==1&&e%100!=11?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2)},bg:{name:"Bulgarian",numbers:[1,2],plurals:e=>Number(1!=e)},bn:{name:"Bengali",numbers:[1,2],plurals:e=>Number(1!=e)},bo:{name:"Tibetan",numbers:[1],plurals:()=>0},br:{name:"Breton",numbers:[1,2],plurals:e=>Number(e>1)},bs:{name:"Bosnian",numbers:[1,2,5],plurals:e=>Number(e%10==1&&e%100!=11?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2)},ca:{name:"Catalan",numbers:[1,2],plurals:e=>Number(1!=e)},cgg:{name:"Chiga",numbers:[1],plurals:()=>0},cs:{name:"Czech",numbers:[1,2,5],plurals:e=>Number(1==e?0:e>=2&&e<=4?1:2)},csb:{name:"Kashubian",numbers:[1,2,5],plurals:e=>Number(1==e?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2)},cy:{name:"Welsh",numbers:[1,2,3,8],plurals:e=>Number(1==e?0:2==e?1:8!=e&&11!=e?2:3)},da:{name:"Danish",numbers:[1,2],plurals:e=>Number(1!=e)},de:{name:"German",numbers:[1,2],plurals:e=>Number(1!=e)},dz:{name:"Dzongkha",numbers:[1],plurals:()=>0},el:{name:"Greek",numbers:[1,2],plurals:e=>Number(1!=e)},en:{name:"English",numbers:[1,2],plurals:e=>Number(1!=e)},eo:{name:"Esperanto",numbers:[1,2],plurals:e=>Number(1!=e)},es:{name:"Spanish",numbers:[1,2],plurals:e=>Number(1!=e)},es_ar:{name:"Argentinean Spanish",numbers:[1,2],plurals:e=>Number(1!=e)},et:{name:"Estonian",numbers:[1,2],plurals:e=>Number(1!=e)},eu:{name:"Basque",numbers:[1,2],plurals:e=>Number(1!=e)},fa:{name:"Persian",numbers:[1],plurals:()=>0},fi:{name:"Finnish",numbers:[1,2],plurals:e=>Number(1!=e)},fil:{name:"Filipino",numbers:[1,2],plurals:e=>Number(e>1)},fo:{name:"Faroese",numbers:[1,2],plurals:e=>Number(1!=e)},fr:{name:"French",numbers:[1,2],plurals:e=>Number(e>1)},fur:{name:"Friulian",numbers:[1,2],plurals:e=>Number(1!=e)},fy:{name:"Frisian",numbers:[1,2],plurals:e=>Number(1!=e)},ga:{name:"Irish",numbers:[1,2,3,7,11],plurals:e=>Number(1==e?0:2==e?1:e<7?2:e<11?3:4)},gd:{name:"Scottish Gaelic",numbers:[1,2,3,20],plurals:e=>Number(1==e||11==e?0:2==e||12==e?1:e>2&&e<20?2:3)},gl:{name:"Galician",numbers:[1,2],plurals:e=>Number(1!=e)},gu:{name:"Gujarati",numbers:[1,2],plurals:e=>Number(1!=e)},gun:{name:"Gun",numbers:[1,2],plurals:e=>Number(e>1)},ha:{name:"Hausa",numbers:[1,2],plurals:e=>Number(1!=e)},he:{name:"Hebrew",numbers:[1,2],plurals:e=>Number(1!=e)},hi:{name:"Hindi",numbers:[1,2],plurals:e=>Number(1!=e)},hr:{name:"Croatian",numbers:[1,2,5],plurals:e=>Number(e%10==1&&e%100!=11?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2)},hu:{name:"Hungarian",numbers:[1,2],plurals:e=>Number(1!=e)},hy:{name:"Armenian",numbers:[1,2],plurals:e=>Number(1!=e)},ia:{name:"Interlingua",numbers:[1,2],plurals:e=>Number(1!=e)},id:{name:"Indonesian",numbers:[1],plurals:()=>0},is:{name:"Icelandic",numbers:[1,2],plurals:e=>Number(e%10!=1||e%100==11)},it:{name:"Italian",numbers:[1,2],plurals:e=>Number(1!=e)},ja:{name:"Japanese",numbers:[1],plurals:()=>0},jbo:{name:"Lojban",numbers:[1],plurals:()=>0},jv:{name:"Javanese",numbers:[0,1],plurals:e=>Number(0!==e)},ka:{name:"Georgian",numbers:[1],plurals:()=>0},kk:{name:"Kazakh",numbers:[1],plurals:()=>0},km:{name:"Khmer",numbers:[1],plurals:()=>0},kn:{name:"Kannada",numbers:[1,2],plurals:e=>Number(1!=e)},ko:{name:"Korean",numbers:[1],plurals:()=>0},ku:{name:"Kurdish",numbers:[1,2],plurals:e=>Number(1!=e)},kw:{name:"Cornish",numbers:[1,2,3,4],plurals:e=>Number(1==e?0:2==e?1:3==e?2:3)},ky:{name:"Kyrgyz",numbers:[1],plurals:()=>0},lb:{name:"Letzeburgesch",numbers:[1,2],plurals:e=>Number(1!=e)},ln:{name:"Lingala",numbers:[1,2],plurals:e=>Number(e>1)},lo:{name:"Lao",numbers:[1],plurals:()=>0},lt:{name:"Lithuanian",numbers:[1,2,10],plurals:e=>Number(e%10==1&&e%100!=11?0:e%10>=2&&(e%100<10||e%100>=20)?1:2)},lv:{name:"Latvian",numbers:[0,1,2],plurals:e=>Number(e%10==1&&e%100!=11?0:0!==e?1:2)},mai:{name:"Maithili",numbers:[1,2],plurals:e=>Number(1!=e)},mfe:{name:"Mauritian Creole",numbers:[1,2],plurals:e=>Number(e>1)},mg:{name:"Malagasy",numbers:[1,2],plurals:e=>Number(e>1)},mi:{name:"Maori",numbers:[1,2],plurals:e=>Number(e>1)},mk:{name:"Macedonian",numbers:[1,2],plurals:e=>Number(1==e||e%10==1?0:1)},ml:{name:"Malayalam",numbers:[1,2],plurals:e=>Number(1!=e)},mn:{name:"Mongolian",numbers:[1,2],plurals:e=>Number(1!=e)},mnk:{name:"Mandinka",numbers:[0,1,2],plurals:e=>Number(0===e?0:1==e?1:2)},mr:{name:"Marathi",numbers:[1,2],plurals:e=>Number(1!=e)},ms:{name:"Malay",numbers:[1],plurals:()=>0},mt:{name:"Maltese",numbers:[1,2,11,20],plurals:e=>Number(1==e?0:0===e||e%100>1&&e%100<11?1:e%100>10&&e%100<20?2:3)},nah:{name:"Nahuatl",numbers:[1,2],plurals:e=>Number(1!=e)},nap:{name:"Neapolitan",numbers:[1,2],plurals:e=>Number(1!=e)},nb:{name:"Norwegian Bokmal",numbers:[1,2],plurals:e=>Number(1!=e)},ne:{name:"Nepali",numbers:[1,2],plurals:e=>Number(1!=e)},nl:{name:"Dutch",numbers:[1,2],plurals:e=>Number(1!=e)},nn:{name:"Norwegian Nynorsk",numbers:[1,2],plurals:e=>Number(1!=e)},no:{name:"Norwegian",numbers:[1,2],plurals:e=>Number(1!=e)},nso:{name:"Northern Sotho",numbers:[1,2],plurals:e=>Number(1!=e)},oc:{name:"Occitan",numbers:[1,2],plurals:e=>Number(e>1)},or:{name:"Oriya",numbers:[2,1],plurals:e=>Number(1!=e)},pa:{name:"Punjabi",numbers:[1,2],plurals:e=>Number(1!=e)},pap:{name:"Papiamento",numbers:[1,2],plurals:e=>Number(1!=e)},pl:{name:"Polish",numbers:[1,2,5],plurals:e=>Number(1==e?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2)},pms:{name:"Piemontese",numbers:[1,2],plurals:e=>Number(1!=e)},ps:{name:"Pashto",numbers:[1,2],plurals:e=>Number(1!=e)},pt:{name:"Portuguese",numbers:[1,2],plurals:e=>Number(1!=e)},"pt-BR":{name:"Brazilian Portuguese",numbers:[1,2],plurals:e=>Number(1!=e)},rm:{name:"Romansh",numbers:[1,2],plurals:e=>Number(1!=e)},ro:{name:"Romanian",numbers:[1,2,20],plurals:e=>Number(1==e?0:0===e||e%100>0&&e%100<20?1:2)},ru:{name:"Russian",numbers:[1,2,5],plurals:e=>Number(e%10==1&&e%100!=11?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2)},sah:{name:"Yakut",numbers:[1],plurals:()=>0},sco:{name:"Scots",numbers:[1,2],plurals:e=>Number(1!=e)},se:{name:"Northern Sami",numbers:[1,2],plurals:e=>Number(1!=e)},si:{name:"Sinhala",numbers:[1,2],plurals:e=>Number(1!=e)},sk:{name:"Slovak",numbers:[1,2,5],plurals:e=>Number(1==e?0:e>=2&&e<=4?1:2)},sl:{name:"Slovenian",numbers:[5,1,2,3],plurals:e=>Number(e%100==1?1:e%100==2?2:e%100==3||e%100==4?3:0)},so:{name:"Somali",numbers:[1,2],plurals:e=>Number(1!=e)},son:{name:"Songhay",numbers:[1,2],plurals:e=>Number(1!=e)},sq:{name:"Albanian",numbers:[1,2],plurals:e=>Number(1!=e)},sr:{name:"Serbian",numbers:[1,2,5],plurals:e=>Number(e%10==1&&e%100!=11?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2)},su:{name:"Sundanese",numbers:[1],plurals:()=>0},sv:{name:"Swedish",numbers:[1,2],plurals:e=>Number(1!=e)},sw:{name:"Swahili",numbers:[1,2],plurals:e=>Number(1!=e)},ta:{name:"Tamil",numbers:[1,2],plurals:e=>Number(1!=e)},te:{name:"Telugu",numbers:[1,2],plurals:e=>Number(1!=e)},tg:{name:"Tajik",numbers:[1,2],plurals:e=>Number(e>1)},th:{name:"Thai",numbers:[1],plurals:()=>0},ti:{name:"Tigrinya",numbers:[1,2],plurals:e=>Number(e>1)},tk:{name:"Turkmen",numbers:[1,2],plurals:e=>Number(1!=e)},tr:{name:"Turkish",numbers:[1,2],plurals:e=>Number(e>1)},tt:{name:"Tatar",numbers:[1],plurals:()=>0},ug:{name:"Uyghur",numbers:[1],plurals:()=>0},uk:{name:"Ukrainian",numbers:[1,2,5],plurals:e=>Number(e%10==1&&e%100!=11?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2)},ur:{name:"Urdu",numbers:[1,2],plurals:e=>Number(1!=e)},uz:{name:"Uzbek",numbers:[1,2],plurals:e=>Number(e>1)},vi:{name:"Vietnamese",numbers:[1],plurals:()=>0},wa:{name:"Walloon",numbers:[1,2],plurals:e=>Number(e>1)},wo:{name:"Wolof",numbers:[1],plurals:()=>0},yo:{name:"Yoruba",numbers:[1,2],plurals:e=>Number(1!=e)},zh:{name:"Chinese",numbers:[1],plurals:()=>0}};t.default=r},70319:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LabelItemParentType=void 0;var a=r(28103).Mirrored(["Chat","Contact","Msg"]);t.LabelItemParentType=a},48522:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.initializeLabels=function(e){var t=o(e);if(i.default.supportsFeature(i.default.F.MD_BACKEND))e.labels=r(62345).default.getLabelsForModel(e.id.toString(),t);else{var a=()=>{s(e.id.toString(),e.labels,t)};a(),e.listenTo(e,"change:labels",a)}},t.addToLabelCollection=s,t.removeLabelFromCollection=function(e,t,a){var s=r(62345).default.get(t),o=null==s?void 0:s.labelItemCollection;if(!o)return void __LOG__(3)`labelItemCollection does not exist for lableId ${t}`;o.remove(l(e,t,a)),i.default.supportsFeature(i.default.F.MD_BACKEND)&&a===n.LabelItemParentType.Chat&&o.remove(l(e,t,n.LabelItemParentType.Contact))},t.getParentCollection=function(e){switch(e){case n.LabelItemParentType.Chat:return r(85030).default;case n.LabelItemParentType.Contact:return r(43805).default;case n.LabelItemParentType.Msg:return r(30528).default}},t.getParentTypeFromModel=o,t.createLabelItemId=l;var i=a(r(20468)),n=r(70319);function s(e,t,a){if(t&&t.length>0){var s=r(62345).default;t.forEach((t=>{var r=s.gadd({id:t});r.labelItemCollection.gadd({id:l(e,t,a),labelId:t,parentId:e,parentType:a}),i.default.supportsFeature(i.default.F.MD_BACKEND)&&a===n.LabelItemParentType.Chat&&r.labelItemCollection.gadd({id:l(e,t,n.LabelItemParentType.Contact),labelId:t,parentId:e,parentType:n.LabelItemParentType.Contact})}))}}function o(e){if(e instanceof r(62820).default)return n.LabelItemParentType.Chat;if(e instanceof r(69057).default)return n.LabelItemParentType.Contact;if(e instanceof r(36169).default)return n.LabelItemParentType.Msg;throw new Error("getParentTypeFromModel: model is invalid")}function l(e,t,r){return`${e}_${t}_${r}`}},79628:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=O;var i=a(r(52954)),n=(a(r(94854)),a(r(15934))),s=a(r(20468)),o=r(27325),l=r(53353),d=r(81725),u=(a(r(95419)),r(66239)),c=a(r(23045)),p=r(71715),h=r(92199),f=r(38027),_=r(35540),m=r(63191),g=r(41991),v=a(r(88241)),E=r(31970),y=r(7017),S=r(39832),T=a(r(13277)),A=a(r(78436)),b=r(11247),C=a(r(77613));function P(){return(0,y.startComms)(v.default,E.sendPing),(0,y.waitForConnection)().then((()=>(0,y.startHandlingRequests)()))}function O(e){var t=(0,o.makeBridge)();(0,l.setBridge)(t),(0,d.requireSetHandlers)().then((e=>e(t)));var r=Promise.resolve();return s.default.supportsFeature(s.default.F.MD_BACKEND)?r=(0,h.initEncSalt)().then((()=>(0,h.initEncSaltForInvoker)())).then((()=>(0,_.initialize)())).catch((e=>{__LOG__(4,void 0,new Error,void 0,["launch_socket"])`storageInitializationError triggered logout: ${(null==e?void 0:e.message)||(null==e?void 0:e.name)}.`,T.default.storageInitializationError()})).then((()=>C.default.isLogoutInProgress?Promise.reject(new Error("aborting launchSocket due to logout")):(0,m.isRegistered)()?(T.default.initialLoadReady(),(0,f.initialize)().catch((()=>T.default.storageInitializationError())).then((()=>{T.default.incrementProgress(),(0,p.restoreGroupsContactsAndProfilePics)()})).then((()=>(0,p.restoreBlocklist)())).then((()=>{T.default.incrementProgress(),(0,g.startBackend)()}))):(T.default.incrementProgress(),Promise.all([(0,S.refreshNoiseCredentials)(),(0,S.refreshSignalCredentials)()]).then((()=>{T.default.incrementProgress(),P()}))))):n.default.launch(e),r}T.default.on("md_downgrade_webclient",(0,i.default)((function*(){(0,y.stopComms)(),yield(0,h.deleteEncKeysAndCache)(),n.default.set({launched:!1,stream:c.default.SOCKET_STREAM.DISCONNECTED,mustExitLoop:!1,shouldUpgradeToMD:!1}),(0,u.setMdOptedIn)(!1),s.default.setFeature(s.default.F.MD_BACKEND,!1),s.default.setFeature(s.default.F.MD_ADV,!1),s.default.setFeature(s.default.F.MD_VOIP_GROUP,!1),n.default.initialize(),n.default.handler||n.default.registerHandler(A.default),O(!0)}))),T.default.on("upgrade_to_md",(()=>{s.default.setFeature(s.default.F.MD_BACKEND,!0),s.default.setFeature(s.default.F.MD_ADV,!0),s.default.setFeature(s.default.F.MD_VOIP_GROUP,!1),O(!0),(0,b.setDeviceLinkMdUpgrade)()})),T.default.on("upgrade_to_md_prod",(()=>{s.default.setFeature(s.default.F.MD_BACKEND,!0),s.default.setFeature(s.default.F.MD_ADV,!0),s.default.setFeature(s.default.F.MD_VOIP_GROUP,!1),O(!0),(0,b.setDeviceLinkMdUpgrade)()})),T.default.on("md_refresh_qr",(()=>{(0,y.stopComms)(),P()})),T.default.on("logout",(()=>{s.default.supportsFeature(s.default.F.MD_BACKEND)&&O(!0)}))},90311:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(52954));t.default=class{constructor({name:e,handler:t=null,interval:r=3600,restingInterval:a=18e3,sleepWhileResting:i=!1,randomIntervalExtension:n=0}){if(this._running=!1,this._slowDown=!1,this._name=e,this._interval=1e3*r,this._restingInterval=1e3*a,this._sleepWhileResting=i,this._randomIntervalExtension=1e3*n,this._rest(),"function"==typeof t)this.poll(t);else if(null!=t)throw new Error("Poll handler must be a function or null")}_getRandomExtension(){return Math.ceil(Math.random()*this._randomIntervalExtension)}_getInterval(){return(this._slowDown?this._restingInterval:this._interval)+this._getRandomExtension()}_rest(){document.addEventListener("visibilitychange",(()=>{this._lock||(document.hidden?this._sleepWhileResting?(__LOG__(2)`LazyPoll[${this._name}]: Inactive paused`,this._pause()):(__LOG__(2)`LazyPoll[${this._name}]: Inactive slowing down`,this._slowDown=!0):this._callback&&(__LOG__(2)`LazyPoll[${this._name}]: Active Resuming`,this._resume()))}),!1)}_isDue(){return!this._lastPoll||Date.now()-this._lastPoll>=this._getInterval()}_pause(){clearTimeout(this._timer),this._running=!1}_resume(){this._slowDown=!1,this._running=!0,this._cycle()}_cycle(){var e=this;return(0,i.default)((function*(){e._running&&(e._isDue()&&(__LOG__(2)`LazyPoll[${e._name}]: Polling...`,yield e._callback(),e._lastPoll=Date.now()),clearTimeout(e._timer),e._timer=setTimeout((()=>e._cycle()),e._getInterval()))}))()}poll(e){null==this._callback?(this._callback=e,this._running=!0,this._cycle()):this.resume()}pause(){__LOG__(2)`LazyPoll[${this._name}]: Manually Paused`,this._lock=!0,this._pause()}resume(){__LOG__(2)`LazyPoll[${this._name}]: Manually Resumed`,this._lock=!1,this._resume()}}},63428:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.findLinks=function(e,t=!1,r){if(!T.test(e))return[];S.lastIndex=0;var a,i=[];for(;a=A(e);){var n=C(a,t,r);n&&i.push(n)}return i},t.findLink=b,t.validateEmail=function(e){var t=b(e);return t&&t.url===e&&"mailto:"===t.scheme&&t.username&&!t.params&&!t.anchor?t:null};var i=r(11219),n=r(16680),s=a(r(79435)),o=r(66239),l=r(84666),d=/^https?:\/\/$/gi,u="\\w|[^\\s\0-]|%[0-9a-f][0-9a-f]",c=`(?:${u})|(?:${u})(?:${u}|-)*(?:${u})`,p=`(?:${u}|[^\\s%])`,h=`[+@!.?,(\\[{<:]*(?!${p}|#)`,f="0-9a-z!#$%&'*+/=?^_`{|}~\\-",_=`(^|\\W\\.|[^/\\w.]|_)((?:http|https)://|mailto:)?(${`\\b\\w[${f}]*(?:\\.[${f}]+)*`}@)?(${`(?!_)(?:(?:${c})\\.)+(?:${l.TLD})(?!\\.${c})`})(?:(?!${c})|(?=_))(?:(?=[^:/?#])|(:\\d{1,5})?(${`/${p}*?`})?(${`\\?(?!${h})${p}*?`})?(${`#${p}*?`})?(?=${h}))`,m=6,g=7,v=8,E=new Map([[34,34],[41,40],[62,60],[93,91],[125,123],[187,171],[8217,8216],[8221,8220]]),y=new Map([[34,34],[40,41],[60,62],[91,93],[123,125],[171,187],[8216,8217],[8220,8221]]),S=new RegExp(`${_}`,"ig"),T=new RegExp(`\\.(?:${l.TLD})`,"i");function A(e){try{return S.exec(e)}catch(t){return __LOG__(4,void 0,new Error,!0)`text size: ${e.length}, error: ${String(t)}`,SEND_LOGS("linkify-regex-error"),null}}function b(e,t=!1,r){return S.lastIndex=0,C(A(e),t,r)}function C(e,t=!1,r){if(!e)return null;var a=e[1].length,l=e[0],u=e.index+a,{index:c}=e;if("_"===e[1]&&c-1&&/\S/.test(e.input[c-1]))return null;if(e[5]){var p=parseInt(e[5].slice(1),10);if("0"===e[5][1]||!(0<p&&p<65536))return null}var h=[v,g,m].find((t=>e&&e[t]))||0;if(h){var f=[],_=e[h];"_"===_.slice(-1)&&"_"===l[u-1]&&(l=l.slice(0,-1),e[h]=_=_.slice(0,-1));for(var T=0,A=0,b=0;b<_.length;b++){var C=_.charCodeAt(b);C===A?0===(A=f.pop()||0)&&(T=b):y.has(C)?(0!==A&&f.push(A),A=y.get(C)):E.has(C)||0===A&&(T=b)}for(;0!==f.length;)f.pop();T!==_.length-1?(l=e.slice(2,h).filter((e=>e)).join("")+_.slice(0,T+1),S.lastIndex=u+l.length):l=l.slice(a)}else l=l.slice(a);var P=l,O=e[2],w=Boolean(O&&O.match(d));if(t&&!w)return null;O?O=O.toLowerCase():(O=0===P.toLowerCase().indexOf("irc.")?"irc://":0===P.toLowerCase().indexOf("ftp.")?"ftp://":e[3]?"mailto:":"http://",P=O+P);var M=e[4],I=(0,o.getMaybeMeUser)();return{href:P,url:l,index:u,input:e.input,scheme:O,username:e[3],domain:M,port:e[5],path:e[m],params:e[g],anchor:e[v],isHttp:w,suspiciousCharacters:r&&I?(0,n.findSuspiciousCharacters)(M,(0,i.toJid)(r.user),(0,i.toJid)(I.user),s.default.allLanguages):void 0}}},48879:(e,t)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;try{r=window.localStorage}catch(e){}var a=r;t.default=a},94854:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.log=t.default=void 0;var i=a(r(52954)),n=a(r(16760)),s=r(35160),o=a(r(19034)),l=a(r(23045)),d=a(r(30256)),u=a(r(56028)),c=a(r(68207)),p=l.default.LOG_SIZE_WEB,h=Date.now(),f="LTSXOo+_*-=.<^!#?".split("");function _(){return f[Math.round(Math.random()*(f.length-1))]}var m=_()+_()+_()+_(),g={};g[g.ALL=0]="all",g[g.INFO=1]="info",g[g.LOG=2]="log",g[g.WARN=3]="warn",g[g.ERROR=4]="error",g[g.OFF=5]="off";function v(e){switch(e){case g.INFO:case g.LOG:case g.WARN:case g.ERROR:return g[e];default:throw new Error(`Unexpected numeric log level: ${e}`)}}var E=new class{constructor(){this.logs=[],this.localCursor=0,this.pending=void 0,this.timer=new s.ShiftTimer((()=>this._persistIdb())),this.isTakeOver=!1,this.log=(0,u.default)(((e,t=!1,r,a,i)=>(n,...s)=>{var o=(0,d.default)(n,s,!t);return this.logImpl(e,o,r,a,i),o}),((e,t,r,a,i)=>r||i?null:String(e)+String(Boolean(t))+String(Boolean(a))))}logImpl(e,t,r,a,i){var n=(0,o.default)().locale("en").format("YYYY-MM-DD HH:mm:ss.SSS:"),s=r?`\n${(0,c.default)(r,!0)}`:"",l=[v(e),a?"sendlogs":null,...null!=i?i:[]].filter(Boolean).map((e=>`[${e}]`)).join(""),d=`${m} ${n}`+(l?`${l} `:"")+t+s;this.logs.push(d),this.isTakeOver||(this.logs.length>p&&(this.logs.shift(),this.localCursor--),this.timer.debounceAndCap(250,1e3))}logUncaughtError(e,t){var r,a=e instanceof Error&&e.stack?e:void 0;if(r=a?String(e):t?`Promise rejected: ${String(e)}`:`Error: ${String(e)}`,this.logImpl(g.ERROR,r,a,!0,["uncaught"]),null!=t){var i=String(t);this.logImpl(g.WARN,i)}}onTakeOver(){this.isTakeOver=!0}getLogs(){var e=r(78086).default,t=[];return this.pending&&t.push(this.pending),this.timer.isScheduled()&&(this.timer.forceRunNow(),this.pending&&t.push(this.pending)),Promise.all(t).then((()=>e.idb())).then(function(){var e=(0,i.default)((function*(e){var t=[];return yield e.logs.orderBy("timestamp").each((e=>{e.log=e.log.slice(0,2500),t.push(e)})),t}));return function(){return e.apply(this,arguments)}}()).then((e=>(0,n.default)(e,"log"))).catch((()=>this.logs))}clearLogs(){var e=this;return(0,i.default)((function*(){var t=r(78086).default;yield t.idb().then((e=>e.logs.clear())).catch((()=>{})),e._setCursor(0),e.localCursor=0,e.logs=[]}))()}clearLogsPreemptive(){var e=this;return(0,i.default)((function*(){var{getShouldPreemptivelyCleanupLogs:t,setShouldPreemptivelyCleanupLogs:a}=r(66239);t()&&(yield e.clearLogs(),a(!1))}))()}_optimisticallyAdvanceCursor(e,t){this.localCursor+=t,this._setCursor((e+t)%p)}_persistIdb(){var e=r(78086).default,t=this.logs.slice(Math.max(this.localCursor,0),this.logs.length);t.length&&(this.pending=e.idb().then((e=>e.transaction("rw",e.logs,e.user,(()=>{var r=this._getCursor();this._optimisticallyAdvanceCursor(r,t.length),t.forEach((t=>{r=(r+1)%p,e.logs.put({line:r,log:t,timestamp:performance&&performance.now()+h||Date.now()})}))})))).catch((()=>{})).finally((()=>{this.pending=void 0})))}_getCursor(){var e=r(78086).default;try{return JSON.parse(e.permanentStorage.getItem(l.default.KEY_LOG_CURSOR))||Math.max(this.localCursor,0)}catch(e){return Math.max(this.localCursor,0)}}_setCursor(e){return r(78086).default.permanentStorage.setItem(l.default.KEY_LOG_CURSOR,String(e))}},y=E;t.default=y;var S=E.log;t.log=S},75584:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(30733)),n=r(84337);function s(e,t){var r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r}function o(e,t,r,a,i,n){return s((o=s(s(t,e),s(a,n)))<<(l=i)|o>>>32-l,r);var o,l}function l(e,t,r,a,i,n,s){return o(t&r|~t&a,e,t,i,n,s)}function d(e,t,r,a,i,n,s){return o(t&a|r&~a,e,t,i,n,s)}function u(e,t,r,a,i,n,s){return o(t^r^a,e,t,i,n,s)}function c(e,t,r,a,i,n,s){return o(r^(t|~a),e,t,i,n,s)}function p(e){return function(e,t){var r,a,i,n;e[t>>5]|=128<<t%32,e[14+(t+64>>>9<<4)]=t;for(var o=1732584193,p=-271733879,h=-1732584194,f=271733878,_=0;_<e.length;_+=16)r=o,a=p,i=h,n=f,o=l(o,p,h,f,e[_],7,-680876936),f=l(f,o,p,h,e[_+1],12,-389564586),h=l(h,f,o,p,e[_+2],17,606105819),p=l(p,h,f,o,e[_+3],22,-1044525330),o=l(o,p,h,f,e[_+4],7,-176418897),f=l(f,o,p,h,e[_+5],12,1200080426),h=l(h,f,o,p,e[_+6],17,-1473231341),p=l(p,h,f,o,e[_+7],22,-45705983),o=l(o,p,h,f,e[_+8],7,1770035416),f=l(f,o,p,h,e[_+9],12,-1958414417),h=l(h,f,o,p,e[_+10],17,-42063),p=l(p,h,f,o,e[_+11],22,-1990404162),o=l(o,p,h,f,e[_+12],7,1804603682),f=l(f,o,p,h,e[_+13],12,-40341101),h=l(h,f,o,p,e[_+14],17,-1502002290),o=d(o,p=l(p,h,f,o,e[_+15],22,1236535329),h,f,e[_+1],5,-165796510),f=d(f,o,p,h,e[_+6],9,-1069501632),h=d(h,f,o,p,e[_+11],14,643717713),p=d(p,h,f,o,e[_],20,-373897302),o=d(o,p,h,f,e[_+5],5,-701558691),f=d(f,o,p,h,e[_+10],9,38016083),h=d(h,f,o,p,e[_+15],14,-660478335),p=d(p,h,f,o,e[_+4],20,-405537848),o=d(o,p,h,f,e[_+9],5,568446438),f=d(f,o,p,h,e[_+14],9,-1019803690),h=d(h,f,o,p,e[_+3],14,-187363961),p=d(p,h,f,o,e[_+8],20,1163531501),o=d(o,p,h,f,e[_+13],5,-1444681467),f=d(f,o,p,h,e[_+2],9,-51403784),h=d(h,f,o,p,e[_+7],14,1735328473),o=u(o,p=d(p,h,f,o,e[_+12],20,-1926607734),h,f,e[_+5],4,-378558),f=u(f,o,p,h,e[_+8],11,-2022574463),h=u(h,f,o,p,e[_+11],16,1839030562),p=u(p,h,f,o,e[_+14],23,-35309556),o=u(o,p,h,f,e[_+1],4,-1530992060),f=u(f,o,p,h,e[_+4],11,1272893353),h=u(h,f,o,p,e[_+7],16,-155497632),p=u(p,h,f,o,e[_+10],23,-1094730640),o=u(o,p,h,f,e[_+13],4,681279174),f=u(f,o,p,h,e[_],11,-358537222),h=u(h,f,o,p,e[_+3],16,-722521979),p=u(p,h,f,o,e[_+6],23,76029189),o=u(o,p,h,f,e[_+9],4,-640364487),f=u(f,o,p,h,e[_+12],11,-421815835),h=u(h,f,o,p,e[_+15],16,530742520),o=c(o,p=u(p,h,f,o,e[_+2],23,-995338651),h,f,e[_],6,-198630844),f=c(f,o,p,h,e[_+7],10,1126891415),h=c(h,f,o,p,e[_+14],15,-1416354905),p=c(p,h,f,o,e[_+5],21,-57434055),o=c(o,p,h,f,e[_+12],6,1700485571),f=c(f,o,p,h,e[_+3],10,-1894986606),h=c(h,f,o,p,e[_+10],15,-1051523),p=c(p,h,f,o,e[_+1],21,-2054922799),o=c(o,p,h,f,e[_+8],6,1873313359),f=c(f,o,p,h,e[_+15],10,-30611744),h=c(h,f,o,p,e[_+6],15,-1560198380),p=c(p,h,f,o,e[_+13],21,1309151649),o=c(o,p,h,f,e[_+4],6,-145523070),f=c(f,o,p,h,e[_+11],10,-1120210379),h=c(h,f,o,p,e[_+2],15,718787259),p=c(p,h,f,o,e[_+9],21,-343485551),o=s(o,r),p=s(p,a),h=s(h,i),f=s(f,n);return new Uint8Array([255&o,o>>>8&255,o>>>16&255,o>>>24&255,255&p,p>>>8&255,p>>>16&255,p>>>24&255,255&h,h>>>8&255,h>>>16&255,h>>>24&255,255&f,f>>>8&255,f>>>16&255,f>>>24&255])}(function(e){var t,r=[];for(r[(e.length>>2)-1]=0,t=0;t<r.length;t+=1)r[t]=0;var a=8*e.length;for(t=0;t<a;t+=8)r[t>>5]|=(255&e.charCodeAt(t/8))<<t%32;return r}(e),8*e.length)}var h=(0,i.default)((e=>(0,n.encodeB64)(p(e))));t.default=h},56784:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.genCurrentSessionId=function(){return f.apply(this,arguments)},t.genSessionId=_;var i=a(r(52954)),n=r(49244),s=r(84337),o=r(446),l=r(66239),d=a(r(21830)),u=a(r(26625)),c=r(24606),p=a(r(62549)),h=r(69909);function f(){return(f=(0,i.default)((function*(){var e=(0,h.createSignalAddress)((0,l.getMeUser)()).toString(),t=(0,d.default)(yield c.waSignalStore.getIdentity(e),"yield waSignalStore.getIdentity(primaryDeviceIdentifier)"),r=(0,o.toCurveKeyPubKey)((0,h.strToBuffer)(t)),a=(0,d.default)(yield u.default.getIdentityKeyPair(),"yield SignalProtocolStore.getIdentityKeyPair()");return _(r,(0,o.toCurveKeyPubKey)(a.pubKey))}))).apply(this,arguments)}function _(){return m.apply(this,arguments)}function m(){return(m=(0,i.default)((function*(e,t){if(32!==e.byteLength)throw new Error(`genSessionId: primary identity public key is ${e.byteLength} bytes, should be 32!`);if(32!==t.byteLength)throw new Error(`genSessionId: companion identity public key is ${e.byteLength} bytes, should be 32!`);var r=new n.Binary;r.writeBuffer(e),r.write("_".charCodeAt(0)),r.writeBuffer(t);var a=r.readByteArray(),i=yield p.default.digest({name:"SHA-256"},a);return(0,s.encodeB64)(i)}))).apply(this,arguments)}},25064:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.STORAGE_QUOTA_UNAVAILABLE=void 0;var i=a(r(52954)),n=a(r(33013)),s=r(56784);t.STORAGE_QUOTA_UNAVAILABLE=-1;var o=new class{constructor(){this._storageEstimation={mdStorageQuotaBytes:-2,mdStorageQuotaUsedBytes:-2},this._mdSessionId=null}getStorageEstimation(){var e=this;return(0,i.default)((function*(){if(-2!==e._storageEstimation.mdStorageQuotaBytes)return Promise.resolve(e._storageEstimation);var t=yield(0,n.default)();return e._storageEstimation={mdStorageQuotaBytes:t?t.quota:-1,mdStorageQuotaUsedBytes:t?t.usage:-1},e._storageEstimation}))()}getMdSessionId(){var e=this;return(0,i.default)((function*(){return null!=e._mdSessionId||(e._mdSessionId=yield(0,s.genCurrentSessionId)()),e._mdSessionId}))()}};t.default=o},40430:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(71436),i=r(24461);class n extends((0,a.customError)("MediaFileTooLarge",!0,i.MediaFileError)){constructor(e){super(`File (${e.type()}) size = ${e.size()}`),this.opaqueData=e}}t.default=n},28119:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.getMediaTagErrorReason=_,t.loadImage=m,t.image=function(e){return m(e).then((e=>e&&e.naturalWidth>0?{img:e,fullWidth:e.naturalWidth,fullHeight:e.naturalHeight}:Promise.reject(new o.MediaLoadError("image loaded with zero width")))).catch((()=>Promise.reject(new o.MediaLoadError("unable to render image"))))},t.loadVideo=g,t.videoWidthHeightDuration=function(e){return g(e,!0).then((({video:e,fullWidth:t,fullHeight:r,duration:a})=>(v(e),{width:t,height:r,duration:a})))},t.disposeVideo=v,t.transcode=function(e,t){var r=t||e.type;return r&&r.includes(s.default.MIMETYPE_OGG)&&!p?e.size<=3e5?new u.default(e).generateBlob():Promise.reject(new o.TranscodeBlobTooLargeError):Promise.resolve(e)},t.canPlayOgg=void 0;var n=r(60266),s=i(r(23045)),o=a(r(24461)),l=i(r(24584)),d=i(r(84161)),u=i(r(17039)),c=i(r(11018)),p=(new Audio).canPlayType("audio/ogg");t.canPlayOgg=p;var h=0,f=Promise.resolve();function _(e){if(!e||!e.error)return null;var t=e.error,r=Object.keys(l.default).find((e=>l.default[e]===t.code));r=r||`UNKNOWN CODE ${t.code}`;var a=t.message&&~t.message.indexOf(":")?t.message.split(":")[0]:"";return a?`${r}: ${a}`:r}function m(e,t=!0){var r;return new Promise((function(a,i){r=new Image;var n=/^(?:data|blob):/.test(e);t&&!n&&r.setAttribute("crossOrigin","anonymous"),r.onload=a,r.onabort=()=>{i(new Error("loadImage onabort"))},r.onerror=()=>{i(new o.InvalidImageFileType("Image tag load error"))},r.src=e})).then((()=>r))}function g(e,t=!1){var r=f.then((()=>function(e,t=!1){var r,a,i=new d.default.WebcMediaLoad,s=null,l=++h;function u(){r&&s&&(document.body&&document.body.removeChild(s),s=null)}var p=new Promise((function(i,n){__LOG__(2)`MediaLoad:video called (#${l}). Should wait for a first frame: ${t}`;var d=!1,u=!1;if((r=document.createElement("video")).volume=0,r.muted=!0,r.playsinline=!0,r.onloadedmetadata=()=>{__LOG__(2)`MediaLoad:video.onloadedmetadata #${l}. Video ready: ${u}. Video width: ${r.videoWidth}`,d=!0,!u&&t||i()},r.onloadeddata=()=>{__LOG__(2)`MediaLoad:video.onloadeddata #${l}`},r.onprogress=()=>{__LOG__(2)`MediaLoad:video.onprogress #${l}`},r.oncanplay=()=>{__LOG__(2)`MediaLoad:video.oncanplay #${l}. Metadata loaded: ${d}. Video width: ${r.videoWidth}`,u=!0,d&&t&&i()},r.onerror=()=>{var t=r.error?r.error.message:"no error message";__LOG__(3)`MediaLoad:video.onerror #${l}: ${String(t)}\n Blob info -> size:${e.size}, type: ${e.type}`;var a=_(r);n(new o.UnableToPlayVideoError(a))},r.src=a=window.URL.createObjectURL(e),c.default.isSafari||c.default.isBuggyVideoLoad){var p=s=document.createElement("div");p.style="opacity: 0.004",p.appendChild(r),document.body&&document.body.appendChild(p)}r.load()}));setTimeout((()=>{u(),p.isPending()&&(__LOG__(3)`unable to load video #${l} (${e.size} bytes)`,new d.default.WebcMediaLoad({webcMediaLoadResult:d.default.WEBC_MEDIA_LOAD_RESULT_CODE.SILENCE}).commit())}),8e3);var f=p.then((()=>(0,n.delayMs)(10))).then((()=>{if(i.markWebcMediaLoadT(),__LOG__(2)`MediaLoad:video #${l} successful`,r.pause(),r.videoWidth>0)return i.webcMediaLoadResult=d.default.WEBC_MEDIA_LOAD_RESULT_CODE.SUCCESS,i.commit(),{video:r,fullWidth:r.videoWidth,fullHeight:r.videoHeight,duration:r.duration};throw r.duration>0?(__LOG__(3)`MediaLoad:video #${l} dimensions are not defined. Video readyState: ${r.readyState}. Video width: ${r.videoWidth}`,new o.MediaUnsupportedError("video loaded with duration but no dims")):(i.webcMediaLoadResult=d.default.WEBC_MEDIA_LOAD_RESULT_CODE.ZEROWIDTH,i.commit(),new o.MediaLoadError("video loaded with zero width"))})).finally((()=>{u(),r&&(r.onloadedmetadata=null,r.onloadeddata=null,r.onplay=null,r.onerror=null),a&&window.URL.revokeObjectURL(a)}));return f.catch((()=>{v(r)})),f}(e,t)));return f=r.timeout(1e3).then((()=>{}),(()=>{})),r}function v(e){try{e.pause(),e.src="",e.load()}catch(e){__LOG__(4,void 0,new Error,!0)`Error: ${String(e)}`,SEND_LOGS("dispose-video-error")}}},27630:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){i.default.Cache=s},t.clearAllMemoizeCache=function(){n.forEach((e=>e.clear()))},t.MemoizeCache=void 0;var i=a(r(30733)),n=[];class s extends Map{constructor(){super(),n.push(this)}}t.MemoizeCache=s},56028:(e,t)=>{"use strict";function r(e,t){var a=function(...r){var i=t?t.apply(this,r):r[0];if(!i)return e.apply(this,r);var n=a.cache;if(n.has(i))return n.get(i);var s=e.apply(this,r);return a.cache=n.set(i,s)||n,s};return a.cache=new(r.Cache||Map),a}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,r.Cache=Map;var a=r;t.default=a},17465:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t=i.default){var r=null,a=function(a){return null!=r&&t(r.params,a)?r.params=a:r={params:a,result:e.call(this,a)},r.result};return a.clear=()=>{r=null},a};var i=a(r(88665))},83746:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(66239),n=a(r(20468)),s=a(r(62691)),o=a(r(43926)),l=r(25054);class d{constructor(e){var t=e;if(!t)throw new Error("MsgKey error: obj is null/undefined");t.id instanceof d&&(t=t.id,__LOG__(3)`MsgKey error: id is already a MsgKey`);var r,a,s,l,u,c,p,h=t.from&&t.to&&t.id,f=void 0!==t.fromMe&&t.remote&&t.id,_=(0,i.getMaybeMeUser)();if(!_)throw new Error("MsgKey error: me is undefined");if(h&&f)throw __LOG__(3)`Unclear constructor MsgKey: ${JSON.stringify(t)}`,new Error("MsgKey error: unclear which constructor to use");if(!h&&!f)throw __LOG__(3)`No matching constructor MsgKey: ${JSON.stringify(t)}`,new Error("MsgKey error: don't have a matching constructor");if(h){if(({from:r,to:a,id:s,participant:l,selfDir:u}=t),!(r instanceof o.default)||!(a instanceof o.default)||l&&!(l instanceof o.default))throw __LOG__(3)`Incorrect Wid MsgKey: from:${String(r)} to:${String(a)} p:${String(l)}`,new Error("MsgKey error: something is not a wid");u=o.default.equals(r,a)?u:void 0,o.default.equals(r,a)&&o.default.equals(r,_)?(c="out"===u,p=_):o.default.equals(r,_)?(c=!0,p=a):o.default.equals(a,_)?(c=!1,p=r):o.default.equals(r,a)&&(o.default.isGroup(r)||o.default.isBroadcast(r))?(c=!0,p=r):__LOG__(3)`MsgKey case error: ${[r,a,s,_].join()}`,void 0!==c&&(this.fromMe=c),p&&(this.remote=p),s&&(this.id=s)}else if(f){if(({fromMe:c,remote:p,id:s,participant:l}=t),!(p instanceof o.default)||l&&!(l instanceof o.default))throw __LOG__(3)`Incorrect Wid MsgKey: remote:${String(p)} p:${String(l)}`,new Error("MsgKey error: something is not a wid");o.default.equals(_,p)&&(u=c?"out":"in"),void 0!==c&&(this.fromMe=c),p&&(this.remote=p),s&&(this.id=s)}var m=[this.fromMe,this.remote,this.id];void 0!==u&&(this.self=u,m.push(this.self)),n.default.supportsAnyFeature(n.default.F.KEY_PARTICIPANT,n.default.F.MD_BACKEND)&&void 0!==l&&(this.participant=l,m.push(this.participant)),this._serialized=m.join("_")}toString(){return this._serialized}clone(){return new d({fromMe:this.fromMe,remote:this.remote,id:this.id,participant:this.participant})}equals(e){return e instanceof d&&this.toString()===e.toString()}static fromString(e){var{fromMe:t,remote:r,id:a,participant:i}=(0,s.default)(e);return new d({fromMe:t,remote:(0,l.createWid)(r),id:a,participant:i?(0,l.createWid)(i):void 0})}}t.default=d},62691:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){if(!e||!(0,a.isString)(e))throw new Error("MsgKey fromString error: str is null or not a string");var t=e.split("_"),r=void 0;t.length<3?__LOG__(3)`MsgKey error: cannot create MsgKey from ${e}`:4===t.length?"out"!==t[3]&&"in"!==t[3]&&(r=t[3]):5===t.length&&(r=t[4]);return{fromMe:"true"===t[0],remote:t[1],id:t[2],participant:r}};var a=r(61864)},66622:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(r(52954)),s=a(r(99778)),o=i(r(23045)),l=i(r(84296)),d=i(r(79823));class u extends s.default{constructor(...e){super(...e),this.online=(0,s.session)(!0),this.waitIfOffline=(0,d.default)((()=>"all"),(0,n.default)((function*(){this.online||(__LOG__(2)`waitIfOffline: Waiting...`,yield new Promise((e=>{this.listenToOnce(this,"change:online",(()=>{__LOG__(2)`waitIfOffline: Continuing...`,e()}))})))}))),this.checkOnline=(0,d.default)((()=>"all"),(0,n.default)((function*(){__LOG__(2)`NetworkStatus:checkOnline checking`;try{var e=yield(0,l.default)(o.default.STATUS_URL);this.online=!!e,__LOG__(2)`NetworkStatus:checkOnline response ${String(this.online)}`}catch(e){__LOG__(3)`NetworkStatus:checkOnline errored! ${String(e)}`}})))}initialize(){this.listenTo(this,"change:online",this._logOnlineOffline),this._logOnlineOffline()}_logOnlineOffline(){var e=this.online;__LOG__(2)`NetworkStatus ${e?"online":"offline"}`}}var c=new((0,s.defineModel)(u));t.default=c},26779:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getEffectiveNetworkType=function(){return navigator.connection&&"string"==typeof navigator.connection.effectiveType?navigator.connection.effectiveType:null}},68207:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t=!1){var{name:r,message:a,stack:n}=e,s=n.indexOf("\n"),o=n.slice(0,s).match(new RegExp(`(${(0,i.default)(r)}|Error)(:|$)`));if(null!=o){if(!t)return n;var l=o.index+o[0].length,d=null==a?-1:n.indexOf(a,l),u=null==a||-1===d?-1:d+a.length,c=Math.max(0,s,l,u);return n.slice(c).replace(/^\n+/,"")}return t?n:a?`${r}: ${a}\n${n}`:`${r}\n${n}`};var i=a(r(89166))},16120:(e,t,r)=>{"use strict";var a=r(14859),i=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.setTitleAndIcon=function(e){var t=l.default.t(1877);e>0&&(t="("+l.default.n(e)+") "+l.default.t(1877));clearTimeout(n),document.title=document.title+" ",n=setTimeout((()=>{document.title=t}),0),c(e)},t.setIcon=c;var n,s=i(r(43394)),o=a(r(68749)),l=a(r(38637)),d=a(r(11018));var u=new o.default;function c(e){if(!d.default.isSafari){var t,a={id:t=-1===e?"favicon-error2":0===e?"favicon":e<10?"f0"+e:e<100?"f"+e:"f00",low:{default:r(16290)(`./${t}.png`)},high:{default:r(8893)(`./${t}.png`)}};u.enqueue(s.default.loadAsset(a,s.LOAD_PRIORITY.NOTIFICATION_ICON,!1)).then((e=>{var r,a=document.getElementById("favicon");(r=a)&&r.parentNode&&r.parentNode.removeChild(r);var i=document.createElement("link");i.setAttribute("id","favicon"),i.setAttribute("rel","shortcut icon"),i.setAttribute("type","image/png"),i.setAttribute("href",e),i.setAttribute("src",e);var n=document.getElementsByTagName("head");n&&n[0]&&n[0].appendChild(i),__LOG__(2)`Favicon updated: ${t}`})).catchType(Promise.CancellationError,(()=>{}))}}},21830:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t="?"){if(null==e)throw new Error(`Unexpected null or undefined: ${t}`);return e}},22618:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,i.default)(e,n)};var i=a(r(99686)),n=e=>null==e},7743:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=r,a=function(...a){return t===r&&(t=e.call(this,...a)),t};return a.reset=()=>{t=r},a};var r={}},48846:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.openSocket=function(e){return new WebSocket(e)}},17039:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i,n=r(49244),s=r(48537),o=a(r(10601)),l=0;t.default=class{constructor(e){this.oggBlob=e}generateBlob(){return this.oggBlobToWAVBlob(this.oggBlob,1)}oggBlobToWAVBlob(e,t=2){var r=t;return new Promise((t=>{var a=new o.default,n=[],d=[],u=(l++,i||new window.AudioContext),c={outputBufferSampleRate:u.sampleRate,bufferLength:4096};a.onmessage=e=>{if(null==e.data){for(var a=function(e){n.forEach((t=>{for(var r=t[e]||t[0],a=0;a<r.length;a++)d.push(r[a])}))},s=0;s<r;s++)a(s);var o=this.encodeWAV(d,u,r),c=new Blob([o.readByteArray()],{type:"audio/wav"});0==--l&&i&&(i.close&&i.close(),i=void 0),t(c)}else n.push(e.data),r=n[0].length},a.postMessage({command:"decode-init",config:c}),(0,s.blobToArrayBuffer)(e).then((e=>{a.postMessage({command:"decode",pages:new Uint8Array(e)}),a.postMessage({command:"decode-done"})})).catch((e=>{__LOG__(3)`Player::oggBlobToWAVBlob error: ${e}`}))}))}encodeWAV(e,t,r){var a=new n.Binary(void 0,!0);a.ensureCapacity(44+2*e.length),a.writeString("RIFF"),a.writeUint32(36+2*e.length),a.writeString("WAVE"),a.writeString("fmt "),a.writeUint32(16),a.writeUint16(1),a.writeUint16(r),a.writeUint32(t.sampleRate),a.writeUint32(t.sampleRate*r*2),a.writeUint16(2*r),a.writeUint16(16),a.writeString("data"),a.writeUint32(2*e.length);for(var i=0;i<e.length;i++){var s=Math.max(-1,Math.min(e[i],1));s*=s>0?32767:32768,a.writeInt16(Math.floor(s))}return a}}},47683:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(r(52954)),s=r(60266),o=r(13275),l=r(9737),d=i(r(28421)),u=i(r(23045)),c=a(r(64453)),p=i(r(93013)),h=i(r(54559)),f=a(r(56179));t.default=class{static fileToPdf(e){var t=URL.createObjectURL(e);return(0,o.promiseLoop)((function(e,t,a){var i=(0,s.delayMs)(f.expBackoff(a,12e4,0,0));return r.e(2974).then(r.t.bind(r,38664,23)).then((t=>{t.GlobalWorkerOptions.workerSrc=d.default,e(t.default)})).catch((()=>i))})).then((e=>e.getDocument(t).promise))}static releasePdf(e){return e.destroy()}static pdfToImg(e,t){var r=document.createElement("canvas");return e.getPage(t).then((e=>{var t=e.getViewport({scale:1}),a=r.getContext("2d");return r.height=t.height,r.width=t.width,e.render({canvasContext:a,viewport:t}).promise})).then((()=>(0,l.promiseProps)({blob:c.canvasToBlob(r),thumbnail:c.rotateAndResize(r,u.default.DOC_THUMB_MAX_EDGE,c.DATA_URL|c.CANVAS|c.BLOB),microThumbnail:h.default.webUploadDocumentThumbMmsEnabled?c.generateMicroThumb(r,1300,{mimetype:"image/jpeg",maxAttempts:10}):Promise.resolve(null)}))).then((e=>e)).then(function(){var t=(0,n.default)((function*({blob:t,thumbnail:r,microThumbnail:a}){return{url:URL.createObjectURL(t),thumbUrl:r.images.dataUrl,width:r.images.canvas.width,height:r.images.canvas.height,fullPreviewData:yield p.default.createFromData(r.images.blob,"image/jpeg"),fullPreviewSize:{width:r.images.canvas.width,height:r.images.canvas.height},pdfPages:e.numPages,microThumbnail:a}}));return function(){return t.apply(this,arguments)}}())}}},30939:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.startMeasure=function(e){return r;if(!a)return r;var t=(i.get(e)||0)+1;i.set(e,t);var s=n(1===t?e:`${e} (${t})`),o=`${s}: Start`,l=`${s}: End`;performance.mark(o);var d=!1;return{end(){if(!d){d=!0;var t=i.get(e)||0;t>1?i.set(e,t-1):i.delete(e),performance.mark(l),performance.measure(s,o,l)}}}},t.formatMeasureLabel=n;var r={end(){}},a=performance&&performance.mark&&performance.measure,i=new Map;function n(e){return` ${e}`}},17063:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.phashV1=function(e){for(var t=e.map((e=>(0,s.toUserWid)(e).toString({legacy:!0}))).sort().join(""),r=[],a=0;a<t.length;a++)r.push(t.charCodeAt(a));var o=new Uint8Array(r);return n.default.digest({name:"SHA-1"},o).then((e=>`1:${(0,i.encodeB64)(e.slice(0,6))}`))},t.phashV2=function(e){for(var t=e.map((e=>e.toString({legacy:!0,formatFull:!0}))).sort().join(""),r=[],a=0;a<t.length;a++)r.push(t.charCodeAt(a));var s=new Uint8Array(r);return n.default.digest({name:"SHA-256"},s).then((e=>`2:${(0,i.encodeB64)(e.slice(0,6))}`))};var i=r(84337),n=a(r(62549)),s=r(25054)},45026:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(39136)),n=a(r(57481)),s="AbortController"in self?AbortController:class{constructor(){this.signal=new i.default}abort(){var e=new n.default("abort");this.signal.dispatchEvent(e)}};t.default=s},39136:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(20151)),n=class extends i.default{constructor(){super(),this.aborted=!1}dispatchEvent(e){return"abort"===e.type&&(this.aborted=!0,"function"==typeof this.onabort&&this.onabort.call(this,e)),super.dispatchEvent(e)}toString(){return"[object AbortSignal]"}};t.default=n},12588:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(42685),i="DomException"in window?DOMException:a.DOMException;t.default=i},57481:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=Event;t.default=r},20151:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(71107));t.default=class{constructor(){this._emitter=new i.default}addEventListener(e,t){this._emitter.on(e,t,this)}removeEventListener(e,t){this._emitter.off(e,t,this)}dispatchEvent(e){return this._emitter.trigger(e.type),!0}}},127:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(70417)),n=r(22448),s=()=>{},o="fetch"in window?fetch:function(e,t={}){return(0,n.sharedFetch)(e,(0,i.default)((0,i.default)({},t),{},{onProgress:s}))};t.default=o},81363:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(11018));["webkitGetUserMedia"].forEach((function(e){var t=Object.getPrototypeOf(navigator)[e];t&&navigator[e]!==t&&(navigator[e]=t)}));var n=function(){var e;if(i.default.isBrokenGetUserMedia)return null;var t=null===(e=navigator.mediaDevices)||void 0===e?void 0:e.getUserMedia;if(t)return t.bind(navigator.mediaDevices);var r=navigator.getUserMedia||navigator.mozGetUserMedia||navigator.webkitGetUserMedia;return r?function(e){return new Promise((function(t,a){r.call(navigator,e,t,a)}))}:null}();t.default=n},11204:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i,n=a(r(14891)),s=a(r(27745)),o=a(r(89799)),l=a(r(88329)),d="Headers"in window&&Headers?Headers:(i=l.default.iterator,class e{constructor(t){var r=this;if(this._headers={},t instanceof e)(0,s.default)(t.entries(),(e=>{var[t,r]=e;r.split(", ").forEach((e=>{this.append(t,e)}))}));else if("object"==typeof t){var a=function(e){t[e].split(", ").forEach((t=>{r.append(e,t)}))};for(var i in t)a(i)}}append(e,t){var r=e.toLowerCase();r in this._headers?this._headers[r].push(t):this._headers[r]=[t]}delete(e){var t=e.toLowerCase();delete this._headers[t]}entries(){var e=Object.keys(this._headers).map((e=>[e,this.get(e)||""]));return new n.default(e)}get(e){var t=e.toLowerCase();return t in this._headers?this._headers[t].join(", "):null}has(e){return e.toLowerCase()in this._headers}keys(){return(0,o.default)(this.entries(),(([e])=>e))}set(e,t){var r=e.toLowerCase();this._headers[r]=[t]}values(){return(0,o.default)(this.entries(),(([e,t])=>t))}[i](){return this.entries()}toString(){return"[Object Headers]"}});t.default=d},50788:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.cancelIdleCallback=t.requestIdleCallback=void 0;var r=window.requestIdleCallback,a=window.cancelIdleCallback,i="requestIdleCallback"in window?r:function(e){return setTimeout((()=>{var t=Date.now();e({didTimeout:!1,timeRemaining:()=>Math.max(0,50-(Date.now()-t))})}),1)};t.requestIdleCallback=i;var n="cancelIdleCallback"in window?a:function(e){clearTimeout(e)};t.cancelIdleCallback=n},24584:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=window.MediaError||{MEDIA_ERR_ABORTED:1,MEDIA_ERR_NETWORK:2,MEDIA_ERR_DECODE:3,MEDIA_ERR_SRC_NOT_SUPPORTED:4};t.default=r},62549:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=self.crypto,a=r&&(r.subtle||r.webkitSubtle||r.subtle);t.default=a},88329:(e,t)=>{"use strict";var r,a;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i="Symbol"in window?Symbol:(a=r=class{},r.iterator="@@iterator",a);t.default=i},31244:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,r(31125);var a=URLSearchParams;t.default=a},68571:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.prepareCtwaContextSend=function(e,t){if(t)return(0,n.default)({},t);if(e&&e.sourceUrl){var r=e.sourceUrl;if(null==r||""===r)return;var a=l.findLink(e.sourceUrl,!1,(0,o.getMaybeMeUser)());return{sourceUrl:r,sourceType:"",sourceId:"",mediaType:s.ExternalAdReplyInfoMediaType.NONE,isSuspiciousLink:!!(a&&a.suspiciousCharacters&&a.suspiciousCharacters.size>0)}}return};var n=i(r(70417)),s=r(99429),o=r(66239),l=a(r(63428))},79702:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getDistribution=function(){return"prod","web_prod"},t.getLogUserAgent=function({appVersion:e,browser:t,device:r}){return`WhatsApp/${e} ${"Web/"+t} Device/${r}`}},3599:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ABORT_ERROR=t.default=void 0;var a=r(71436);class i extends((0,a.customError)("AbortError")){}t.default=i;t.ABORT_ERROR="AbortError"},16840:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,r){return(0,n.default)(e,(function(a){if(a.signal.aborted)throw new i.default;var n=e(a);return t.get(n,a).then((e=>{if(a.signal.aborted)throw new i.default;return null!=e?e:r(a).then((e=>{if(a.signal.aborted)throw new i.default;return t.set(n,e,a).then((()=>e))}))}))}))};var i=a(r(3599)),n=a(r(79823))},18268:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var{signal:r,timeoutIterator:a,timeoutIncludesTaskDuration:l}=(0,i.default)((0,i.default)({},o),e);return(0,n.default)((({retry:e,failCount:r})=>new Promise(((i,n)=>{var o=Date.now();try{t((function(e){return Promise.reject(new s.default(e))}),r).then(i).catch(d)}catch(e){return void d(e)}function d(t){if(t instanceof s.default){var r=a.next();if(r.done)n(t.source);else{var i=Date.now()-o,d=l?Math.max(r.value-i,0):r.value;e(d)}}else n(t)}}))),r)},t.defaults=void 0;var i=a(r(70417)),n=a(r(99594)),s=a(r(53797)),o=Object.freeze({timeoutIncludesTaskDuration:!0});t.defaults=o},81076:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return d.apply(this,arguments)};var i=a(r(70417)),n=a(r(52954)),s=a(r(53797)),o=a(r(88975)),l={retries:1/0};function d(){return(d=(0,n.default)((function*(e,t){var r,{delay:a,signal:n,retries:d}=(0,i.default)((0,i.default)({},l),e),u=0,c=Date.now(),p=null,h=e=>Promise.reject(new s.default(e));try{return c=Date.now(),yield t(h,u,n)}catch(r){if(u++,!(r instanceof s.default))throw r;p=r}for(;u<=d;){var f=a({iterationCount:u,taskDuration:Date.now()-c});yield(0,o.default)(f,n);try{return c=Date.now(),yield t(h,u,n)}catch(r){if(u++,!(r instanceof s.default))throw r;p=r}}if(!p)throw new Error("assert: backoff completed without error or result");throw p.source}))).apply(this,arguments)}},12938:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createEnqueue=function(){var e={};return function(t,r){return function a(...i){var n=(r||((...e)=>String(e[0])))(...i);if(e[n]){var s=e[n].then((()=>(delete e[n],a(...i))));return e[n]=s,s}var o=t.apply(this,i).then((t=>(e[n]===o&&delete e[n],t)));return e[n]=o,o}}}},95469:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var r=(0,s.default)((0,s.default)({},d),e),{signal:a,timeoutIncludesTaskDuration:i}=r,u=(0,n.default)(r,["signal","timeoutIncludesTaskDuration"]),c=new l.default(u);return(0,o.default)({signal:a,timeoutIterator:c,timeoutIncludesTaskDuration:i},t)};var n=i(r(22220)),s=i(r(70417)),o=a(r(18268)),l=a(r(82819)),d=(0,s.default)((0,s.default)({},l.defaults),o.defaults)},79823:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var r=new Map;return function(a){if(a.signal.aborted)return Promise.reject(new s.default);var d=e.call(this,a),u=r.get(d);if(null==u||u.aggregator.signal.aborted){var c=new l.default,p=(0,i.default)((0,i.default)({},a),{},{signal:c.signal});u={aggregator:c,promise:t.call(this,p).finally((()=>{c.dispose(),r.delete(d)}))},r.set(d,u)}var h=a.signal||(new n.default).signal;return u.aggregator.add(h),(0,o.default)(u.promise,h)}};var i=a(r(70417)),n=a(r(45026)),s=a(r(3599)),o=a(r(2191)),l=a(r(87618))},2191:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(null==t)return e;var r,a=t.aborted?Promise.reject(new i.default):new Promise(((e,a)=>{var n=()=>{a(new i.default)};t.addEventListener("abort",n),r=()=>{t.removeEventListener("abort",n)}}));return Promise.race([a,e]).finally((()=>{var e;null===(e=r)||void 0===e||e(),r=null}))};var i=a(r(3599))},84174:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var r,a=new i.default;if(e.some((e=>e.aborted)))a.abort();else{r=()=>{for(var t of e)t.removeEventListener("abort",n);r=null};var n=()=>{var e;null===(e=r)||void 0===e||e(),a.abort()};for(var s of e)s.addEventListener("abort",n)}return t(a.signal).finally((()=>{var e;null===(e=r)||void 0===e||e()}))};var i=a(r(45026))},99594:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return new Promise(((r,a)=>{var n,s=0,o=!1;if(t){var l=()=>{t.removeEventListener("abort",l),o=!0,null!=n&&clearTimeout(n),a(new i.default)};if(t.aborted)return void l();t.addEventListener("abort",l)}!function t(){var i=!1,l=!1;n=null;try{var d=e({retry:e=>{if(!o&&!l){if(i=!0,s++,null==e)return t();n=setTimeout(t,e)}},failCount:s});if(!(d instanceof Promise))throw new TypeError("task must return a promise");d.then((e=>{o||i||(l=!0,r(e))})).catch((e=>{o||i||(l=!0,a(e))}))}catch(e){if(o||i)return;a(e)}}()}))};var i=a(r(3599))},53797:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(71436);class i extends((0,a.customError)("RetryableError")){constructor(e){super("see error at this.source"),this.source=e}}t.default=i},87618:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(45026));t.default=class{constructor(){this._disposed=!1,this._controller=new i.default,this._signals=new Set,this.signal=this._controller.signal,this._handleAbort=e=>{this.delete(e.currentTarget),this._checkAborted()}}add(...e){for(var t of(this._throwIfDisposed(),e))t.aborted||(t.addEventListener("abort",this._handleAbort),this._signals.add(t));this._checkAborted()}_checkAborted(){this._disposed||[...this._signals].every((e=>e.aborted))&&(this.dispose(),this._controller.abort())}delete(...e){this._throwIfDisposed(),this._delete(...e)}_delete(...e){var t=!1;for(var r of e)this._signals.delete(r)&&(t=!0,r.removeEventListener("abort",this._handleAbort));t&&this._checkAborted()}_throwIfDisposed(){if(this._disposed)throw new Error("Attempt to modify disposed SignalAggregator")}dispose(){if(!this._disposed)for(var e of(this._disposed=!0,this._signals))this._delete(e)}}},88975:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(3599)),n=(e,t)=>new Promise(((r,a)=>{if(t&&t.aborted)throw new i.default;var n=setTimeout((function(){t&&t.removeEventListener("abort",s),r()}),e);function s(){t&&t.removeEventListener("abort",s),clearTimeout(n),a(new i.default)}t&&t.addEventListener("abort",s)}));t.default=n},67354:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return t.catchType(Promise.CancellationError,(()=>{})).catch((function(t){e.cancel(t)})),t}},94305:(e,t,r)=>{"use strict";var a=r(14859),i=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return new Promise((function(e){function t(){e(!1)}if(self.requestFileSystem)self.requestFileSystem(window.TEMPORARY,1,t,(function(t){e("SecurityError"===t.name)}));else if(s.default){var r=s.default.open("pb_detect");r?(r.onsuccess=t,r.onerror=function(t){t.preventDefault(),window.InvalidStateError?e(t instanceof window.InvalidStateError):e(!0)}):t()}else l.default.isTrident?e(!0):t()})).then((function(e){if(e)return e;if(!o.default)return!1;try{return o.default.setItem("INCOG","0"),o.default.removeItem("INCOG"),!1}catch(e){return"QuotaExceededError"===e.name||Promise.reject(e)}})).timeout(100,"detectIncognitoTimeout").catchType(Promise.TimeoutError,(function(){return!1})).catch((function(e){return __LOG__(3)`promiseUtil:determineIncognito failed check: ${String(e)}`,n.upload({reason:"incog-throw"}),!1}))};var n=i(r(2537)),s=a(r(7010)),o=a(r(48879)),l=a(r(11018))},84296:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t="GET",r,a){var i=new XMLHttpRequest;return new Promise((function(n){function s(){n(i.status&&i.status<12e3?i:null)}a&&(i.responseType=a),i.onload=s,i.onreadystatechange=function(){4===i.readyState?s():0===i.readyState&&n(null)},i.onerror=()=>n(null),i.ontimeout=()=>n(null),i.open(t,e,!0),r?i.send(r):i.send()})).addRawControl("cancel",((e,t)=>{i.abort(),t(new Promise.CancellationError("Aborted XHR"))}),!0).endWithControls("cancel")}},20951:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"attachWatcher",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(t,"getResponseIfOnline",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(t,"waitForOfflineNaive",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(t,"waitForEvent",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(t,"waitForBBEvent",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(t,"determineIncognito",{enumerable:!0,get:function(){return d.default}}),Object.defineProperty(t,"waitForSkip",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(t,"waitForMain",{enumerable:!0,get:function(){return c.default}});var i=a(r(67354)),n=a(r(84296)),s=a(r(17279)),o=a(r(53271)),l=a(r(57568)),d=a(r(94305)),u=a(r(8300)),c=a(r(78994))},57568:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,r){var a,i=r;return new Promise((function(r){a=i?function(){i.apply(this,arguments)&&r(arguments)}:function(){r(arguments)},e.on(t,a)})).cancellable().finally((function(){e.off(t,a)}))}},53271:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,r){var a,i=r;return new Promise((function(r){a=i?function(){i.apply(this,arguments)&&r.apply(this,arguments)}:r,e&&e.addEventListener&&e.addEventListener(t,a)})).cancellable().finally((function(){e&&e.removeEventListener&&e.removeEventListener(t,a)}))}},78994:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return i.default.isMainLoaded?Promise.resolve():(0,n.default)(i.default,"main_loaded")};var i=a(r(13277)),n=a(r(57568))},17279:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return(0,i.default)(window,"offline")};var i=a(r(53271))},8300:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){var e,t;return new Promise((function(r){!function a(){t&&t+1e4<Date.now()?r(!0):(t=Date.now(),e=setTimeout(a,1e3))}()})).cancellable().finally((function(){clearTimeout(e)}))}},2661:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){var e=new Uint8Array(8);self.crypto.getRandomValues(e);for(var t=new Array(16),a=0,i=0;a<e.length;a++,i+=2){var n=e[a];t[i]=r[n>>4],t[i+1]=r[15&n]}return"3EB0"+String.fromCharCode.apply(String,t)},t.randomId=function(){var e=new Uint8Array(16);self.crypto.getRandomValues(e);for(var t=new Array(32),a=0,i=0;a<e.length;a++,i+=2){var n=e[a];t[i]=r[n>>4],t[i+1]=r[15&n]}return String.fromCharCode.apply(String,t)};var r=[48,49,50,51,52,53,54,55,56,57,65,66,67,68,69,70]},57766:(e,t,r)=>{"use strict";var a=r(14859);t.Z=function(){if(o(n.default.REQUIRED_BROWSER_APIS))return!0;return(0,i.promiseProps)({cryptoSha256:s.default.supportsHmacSha256(),cryptoAesCbc:s.default.supportsAesCbc()}).then(o),!1};var i=r(9737),n=a(r(23045)),s=a(r(47397));function o(e){var t=[];for(var r in e)e[r]||t.push(r);if(t.length>0){var a=`${n.default.CAPABILITY_URL}?missing=${t.join(",")}`;return window.location.replace?window.location.replace(a):window.location.href=a,!0}return!1}},39832:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.refreshNoiseCredentials=function(){var e=(0,l.keyPair)(),t=new Uint8Array(24);return self.crypto.getRandomValues(t),Promise.resolve(d.waNoiseInfo.set({recoveryToken:t.buffer,staticKeyPair:e}))},t.refreshSignalCredentials=function(){var e=window.libsignal.KeyHelper.generateRegistrationId();return h.waSignalStore.clearCredential().then((()=>(0,u.generateIdentityKeyPair)().then((t=>Promise.all([h.waSignalStore.setRegistrationInfo({registrationId:e,identityKeyPair:t}),h.waSignalStore.rotateSignedPreKey((0,l.toSignalCurveKeyPair)(t),u.generateSignedKeyPair)]).then((()=>{}))))))},t.setRoutingInfo=function(e,t){var r={domain:e,edgeRouting:t?(0,n.decodeB64)(t):null};return __LOG__(2)`set routingInfo:`,Promise.resolve((0,p.setRoutingInfo)(r))},t.register=function(e,t,r,a){return Promise.all([h.waSignalStore.getRegistrationInfo(),h.waSignalStore.getSignedPreKey()]).then((([n,s])=>{var l=d.waNoiseInfo.get(),u=d.deviceInfo.get();if(!l)throw new Error("Invalid noise credentials");if(!n||!s)throw new Error("Invalid signal credentials");if(!u)throw new Error("Invalid device info");var c={id:g(l.recoveryToken),authkey:g(l.staticKeyPair.pubKey),e_regid:g((0,o.intToBytes)(4,n.registrationId)),e_keytype:g((0,o.intToBytes)(1,5)),e_ident:g(n.identityKeyPair.pubKey),e_skey_id:g((0,o.intToBytes)(3,s.keyId)),e_skey_val:g(s.keyPair.pubKey),e_skey_sig:g(s.signature)};null!=a&&0!==a&&(c.device_id=a.toString());var p=y(m,"/v2/register",(0,i.default)({cc:e,in:t,lg:u.lg,lc:u.lc,code:r,"x-whatsapp-ua":E()},c));return fetch(p).then((e=>e.json())).catch((()=>({status:"fail",reason:"network_error"})))}))},t.requestCode=function(e,t,r){return Promise.all([h.waSignalStore.getRegistrationInfo(),h.waSignalStore.getSignedPreKey()]).then((([a,l])=>{var u=d.waNoiseInfo.get(),p=d.deviceInfo.get();if(!u)throw new Error("Invalid noise credentials");if(!a||!l)throw new Error("Invalid signal credentials");if(!p)throw new Error("Invalid device info");var h={id:g(u.recoveryToken),authkey:g(u.staticKeyPair.pubKey),e_regid:g((0,o.intToBytes)(4,a.registrationId)),e_keytype:g((0,o.intToBytes)(1,5)),e_ident:g(a.identityKeyPair.pubKey),e_skey_id:g((0,o.intToBytes)(3,l.keyId)),e_skey_val:g(l.keyPair.pubKey),e_skey_sig:g(l.signature)};return function(e){var t=(0,n.decodeB64)((0,c.default)(v)),r=(0,s.toLowerCaseHex)(new Uint8Array(t));__LOG__(2)`build hash: ${r}`;var a=(0,n.decodeB64)((0,c.default)(["NvzsLFWNdEheK8VyC0LcidMVlsQhaD95lPVtO1mM",r,e].join(""))),i=(0,s.toLowerCaseHex)(new Uint8Array(a));return __LOG__(2)`token: ${i}`,Promise.resolve(i)}(t).then((a=>{var n=y(m,"/v2/code",(0,i.default)({cc:e,in:t,mcc:p.mcc,mnc:p.mnc,sim_mnc:p.sim_mnc,sim_mcc:p.sim_mcc,lg:p.lg,lc:p.lc,method:r,token:a,"x-whatsapp-ua":E()},h));return fetch(n).then((e=>e.json())).catch((()=>({status:"fail",reason:"network_error"})))}))}))},t.buildUrl=y;var i=a(r(70417)),n=r(84337),s=r(61212),o=r(41026),l=r(446),d=r(99117),u=r(76295),c=a(r(75584)),p=r(63191),h=r(24606),f=a(r(11018)),_=a(r(31962)),m="https://v.whatsapp.net";function g(e){return(0,_.default)((0,n.encodeB64)(e))}var v="0.3.2555";function E(){return`WhatsApp/0.3.2555 Web/${`${f.default.browser}-${f.default.browserVersion}`.replace(" ","_")} Device/${`${f.default.os}-${f.default.osVersion}`.replace(" ","_")}`}function y(e,t,r){if(!/^https:\/\/[-\w.]+\.\w+$/.test(e))throw new Error(`buildUrl given invalid host "${e}"`);if(!t.startsWith("/"))throw new Error(`buildUrl given invalid path "${t}"`);var a=r,i=`${e}${t}`;if(!a)return i;var n=Object.keys(a).map((e=>{var t=a[e];t instanceof ArrayBuffer&&(t=new Uint8Array(t));var r=t instanceof Uint8Array?Array.prototype.slice.call(t).map((e=>`%${e.toString(16)}`)).join(""):encodeURIComponent(t);return`${encodeURIComponent(e)}=${r}`}));if(n.length>0){var s=n.join("&");return i.includes("?")?`${i}&${s}`:`${i}?${s}`}return i}},74491:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(49244),i=r(35160),n=1e4;t.default=class{constructor(e){this.performSendStep=()=>{var e=!1,t=n;if(this.remainingChunk){var r=this.remainingChunk;if(r.length>=n){var i=a.Binary.build(210,128,r),s=i.readBuffer(n);this.remainingChunk=i.readByteArray(),e=!0,t=0,this._send(s)}else{var o=a.Binary.build(211,128,r);this.remainingChunk=null,e=!0,t-=o.size(),this._send(o.readBuffer())}}for(var l=this.queue;l.length&&t>2;){var d=l.shift();if("string"==typeof d)d.length<=t||!e?(e=!0,t-=d.length,this._send(d)):(t=0,l.unshift(d));else if(d.byteLength<t)e=!0,t-=d.byteLength,this._send(d);else{var u=a.Binary.build(208,128,d),c=u.readBuffer(t);this.remainingChunk=u.readByteArray(),e=!0,t=0,this._send(c)}}this.isQueueing()&&this.timer.onOrBefore(250)},this.watchedSocket=e,this.queue=[],this.remainingChunk=null,this.timer=new i.ShiftTimer(this.performSendStep)}isQueueing(){return this.queue.length>0||!!this.remainingChunk}cancel(){this.timer.cancel()}_send(e){this.watchedSocket.socket.send(e)}send(e){this.isQueueing()?this.queue.push(e):function(e){return"string"==typeof e?e.length:e.byteLength}(e)<=n?this._send(e):(this.queue.push(e),this.timer.forceRunNow())}}},29666:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.set=d,t.clear=function(){i=void 0},t.get=function(){return(0,l.default)(i,"BUNDLE")},t.getBundle=function(){return i},t.getSecurityToken=function(e){if(!i)return __LOG__(3)`secret_bundle:getSecurityToken: no secret bundle`,Promise.reject("secret_bundle:getSecurityToken: no secret bundle");return new o.default(i.key).sign(new Uint8Array(e)).then(n.encodeB64)},t.setSecretKeys=function(e,t,r){"0.1"===e?i&&t&&r?(i.encKey=t,i.macKey=r,i.key=r):__LOG__(3)`secret_bundle:setSecretKeys v${e} ${String(t)} ${String(r)}`:__LOG__(2)`secret_bundle:setSecretKeys unknown version: v${e}`},t.load=function(){var e=(0,s.getSecretBundle)();if(!e)return __LOG__(2)`secret_bundle:load: attempted to load non-existent secret bundle!`,null;return d(e),e},t.save=function(){if(!i)return void __LOG__(2)`secret_bundle:save: trying to save empty secret bundle!`;delete i.keyPair,(0,s.setSecretBundle)(i)};var i,n=r(84337),s=r(66239),o=a(r(34601)),l=a(r(21830));function d(e){i=e}},97022:(e,t,r)=>{"use strict";var a=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.getOrGenerate=function(){var e=n.getBundle();if(e&&e.key&&e.keyPair)return(0,i.encodeB64)(e.key);var t=s.keyPair(),r=(0,i.encodeB64)(t.pubKey),a={key:t.pubKey,keyPair:t,encKey:void 0,macKey:void 0};return n.set(a),r};var i=r(84337),n=a(r(29666)),s=a(r(446))},83082:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var{name:t,message:r,stack:a}=e,s=(0,i.default)(e,["name","message","stack"]),o=(0,n.default)({name:t,message:"",stack:a}),l=o.slice(o.indexOf("\n")+1),d=0===Object.keys(s).length?"":" "+JSON.stringify(s,((e,t)=>e&&"object"==typeof t?String(t):t));return`${t||"Error"} - ${r||""}${d}\n${l}`};var i=a(r(22220)),n=a(r(68207))},69389:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setServerPropInElectron=function(){}},43419:(e,t)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;try{r=window.sessionStorage}catch(e){}var a=r;t.default=a},89868:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default=class{constructor(e){this.cache=new Map,this.howBig=0,this.fn=e}getKeyString(e){return"string"==typeof e?e:e.join("_")}getRefSetter(e){var t=this.getKeyString(e),r=this.cache.get(t);return r||(r=r=>{this.fn(e,r),r||this.cache.delete(t)},this.cache.set(t,r),Math.floor(this.cache.size/500)>this.howBig&&(__LOG__(4,void 0,new Error)`[SetRefCache] Large cache detected with ${this.cache.size} entries`,this.howBig=Math.floor(this.cache.size/500))),r}}},64301:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(4335)),n=a(r(29259)),s=a(r(11403)),o=a(r(15253)),l=r(61864);function d(e){switch(typeof e){case"object":return null==e?e=>null===e:function(e){var t=[],r=!1,a=0;(0,o.default)(e,(function(e,i){if(void 0!==e){a++;var n=d(e);t.push((function(e){return e.hasOwnProperty(i)&&n&&n(e[i])}))}else r=!0}));var i=(0,s.default)(t,(function(e,t){return e?function(r){return t(r)&&e(r)}:t}));return function(e){if("object"!=typeof e||null==e)return!1;var t=Object.keys(e).length;return!(t<a)&&!(!r&&t>a)&&i(e)}}(e);case"function":return e;case"boolean":case"undefined":case"number":case"string":return function(t){return t===e};default:throw new TypeError("Unknown Template type: "+typeof e)}}class u{constructor(e){this.predicate=d(e)}test(e){return this.predicate(e)}}t.default=u,u.ANY=()=>!0,u.OBJECT=n.default,u.STRING=l.isString,u.BOOLEAN=i.default},64960:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getCrypto=function(){return self.crypto.subtle||self.crypto.webkitSubtle}},99979:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(45455)),n=a(r(71107));class s extends n.default{constructor(e=[],t,r="next"){super(),this.list=e,this.index=-1,this.value=void 0,this.getter=t||(e=>e),this.deleteDir=r}init(e=[],t=!1){var r,a,n=t;if(this.list=e,this.value)if((0,i.default)(e))this.unset();else{if((r=e.indexOf(this.value))>-1){if(r===this.index)return;a=!0,n=!1}else if(!n||this.index<0)r=-1;else{var s="prev"===this.deleteDir?-1:0;r=this.index+s,r=Math.max(r,0),a=(r=Math.min(r,e.length-1))>-1}this.set(r,n,a)}}unset(){var e=this.value;this.value=void 0,this.index=-1,e&&this.trigger(this.getter(e),!1)}reset(e=!0){this.index<0||this.value&&this.trigger(this.getter(this.value),"focus",e)}set(e,t=!0,r=!0){if(this.list.length){var a=Math.min(Math.max(e,-1),this.list.length-1),i=this.value,n=a>-1?this.list[a]:void 0;n?(this.value=n,this.trigger(this.getter(n),t?"focus":"select")):r&&(this.value=void 0),r&&i&&i!==n&&this.trigger(this.getter(i),!1),this.index=a}}getVal(){return this.value}setVal(e,t=!0){var r=this.list.indexOf(e);r>-1?this.set(r,t):(this.unset(),this.value=e)}setFirst(e=!0){(0,i.default)(this.list)||this.set(0,e,!0)}setLast(e=!0){(0,i.default)(this.list)||this.set(this.list.length-1,e,!0)}setPrev(e=!0){(0,i.default)(this.list)||this.set(this.prev(),e,!0)}setNext(e=!0){(0,i.default)(this.list)||this.set(this.next(),e,!0)}prev(){return(0,i.default)(this.list)||-1===this.index?-1:this.index-1}next(){return(0,i.default)(this.list)?-1:Math.min(this.index+1,this.list.length-1)}}var o=s;t.default=o},20073:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(r(4889)),s=r(49244),o=i(r(45026)),l=a(r(99778)),d=a(r(2537)),u=i(r(23045)),c=a(r(34535)),p=i(r(54884)),h=i(r(66622)),f=i(r(88975)),_=i(r(57568)),m=r(84478),g=a(r(32725)),v=r(49809),E=3e5,y=18e4,S=(0,g.fibonacci)(8e3,4e3,3e5);class T extends l.default{constructor(...e){super(...e),this.active=(0,l.prop)(!0),this.socket=(0,l.prop)(),this.sockets=(0,l.prop)(),this.attempts=(0,l.prop)(0),this.startId=(0,l.prop)(0),this.controller=(0,l.prop)(),this.retryTimestamp=(0,l.prop)(),this.tsListener=(0,l.prop)(),this.onerror=(0,l.prop)()}initialize(){this.sockets=[],new Promise(((e,t)=>{this._resolve=e,this._reject=t})).then((e=>{__LOG__(2)`SocketOpener set to socket ${e.id}`,this.set({active:!1,socket:e}),h.default.online=!0})).finally((()=>{this.stopListening(),__LOG__(2)`SocketOpener closing socket opener`,this.active=!1,this.sockets.forEach((e=>{e.cancel()}));var e=this.controller;e&&(e.deactivate(),this.controller=null)})).catchType(Promise.CancellationError,(()=>{})).catch((e=>{if(__LOG__(3)`SocketOpener deadly error! ${String(e)}`,!this.onerror)return Promise.reject(e);this.onerror(e)})),this.tsListener=e=>{this.retryTimestamp=e.ts},this.listenTo(h.default,"change:online",this.onOnlineChange),this.listenTo(c.default,c.JS_HALT_EVENT,this.onJsHalt),this.onOnlineChange()}attemptOpen(){if(!this.active)return __LOG__(2)`attemptOpen called while not active!`,void d.upload({reason:"rogue-opener"});var e=(0,v.open)({url:u.default.WEB_SOCKET_URL,msgParser:b});this.attempts=this.sockets.push(e);var t=!1,r=function(){if(t)return Promise.resolve();t=!0;var e=(new o.default).signal;return h.default.checkOnline({signal:e})},a=new o.default;(0,f.default)(6e3,a.signal).then((()=>r())).catch((()=>{})),e.then(this._resolve).finally((()=>a.abort())).catchType(Promise.CancellationError,(()=>{})).catch((()=>r()))}poke(){this.controller&&this.controller.forceTimeout()}onOnlineChange(){if(this.active){var e=this.controller,t=h.default.online?this.onlineController():this.offlineController();e&&(e.off("change:ts",this.tsListener),e.deactivate()),t.on("change:ts",this.tsListener),t.activate(),this.controller=t}}onlineController(){return __LOG__(2)`SocketOpener:onlineController activating`,new g.default({waitAlgorithm:S,jitter:.2,onActivated:()=>{this.attemptOpen()},onTimeout:()=>(this.attemptOpen(),!0)})}offlineController(){__LOG__(2)`SocketOpener:offlineController activating`;var e,t=0;return new g.default({waitAlgorithm:a=>(e&&e.cancel(),navigator.onLine?t++<2?(__LOG__(2)`SocketOpener:offline... quick poll`,e=null,6e3):(__LOG__(2)`SocketOpener:offline... heuristic poll`,e=A(a,[(0,m.waitForOnlineNaive)(),(0,_.default)(c.default,c.JS_HALT_EVENT),(0,_.default)(r(96377).default,"change:available")]),E):(__LOG__(2)`SocketOpener:offline... wait for navigator`,t=0,e=A(a,[(0,m.waitForOnlineNaive)()]),E)),jitter:.2,onActivated:()=>{0===this.pendingAttempts()&&this.attemptOpen()},onDeactivated:()=>{e&&e.cancel()},onTimeout:()=>(this.attemptOpen(),!0)})}deactivate(){this._reject(new Promise.CancellationError)}pendingAttempts(){return(0,n.default)(this.sockets,(e=>e.isPending()?1:0))}onJsHalt(e){var t=this.controller;t&&e>y&&(__LOG__(2)`js halt longer than ${y} ms detected, resetting watchdog fail generation`,t.resetGeneration())}}function A(e,t){return Promise.any(t).cancellable().then((()=>{e.forceTimeout()})).finally((()=>{t.forEach((e=>{e.cancel()}))})).catchType(Promise.CancellationError,(()=>{}))}function b(e){var t,r,a,i=e.data;if(i instanceof ArrayBuffer){for(var n,o=[],l=new s.Binary(i);44!==(n=l.readUint8());)o.push(n);t=String.fromCharCode.apply(String,o),r=l.readBuffer(),a=i.byteLength}else{if("string"!=typeof i)throw new Error("Unexpected message event type");var d=i.indexOf(",");t=i.slice(0,d),r=(r=i.slice(d+1))?JSON.parse(r,p.default):void 0,a=new Blob([i]).size}return{tag:t,data:r,binarySize:a}}var C=(0,l.defineModel)(T);t.default=C},32463:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(r(4889)),s=i(r(45026)),o=a(r(99778)),l=i(r(23045)),d=a(r(34535)),u=i(r(66622)),c=i(r(88975)),p=i(r(57568)),h=r(84478),f=a(r(32725)),_=r(64334),m=3e5,g=18e4,v=(0,f.fibonacci)(8e3,4e3,3e5);class E extends o.default{constructor(...e){super(...e),this.active=(0,o.prop)(!0),this.socket=(0,o.prop)(),this.sockets=(0,o.prop)(),this.attempts=(0,o.prop)(0),this.controller=(0,o.prop)(),this.retryTimestamp=(0,o.prop)(),this.tsListener=(0,o.prop)(),this.onerror=(0,o.prop)()}initialize(){this.sockets=[],new Promise(((e,t)=>{this._resolve=e,this._reject=t})).then((e=>{__LOG__(2)`SocketOpenerMD set to socket ${e.id}`,this.set({active:!1,socket:e}),u.default.online=!0})).finally((()=>{this.stopListening(),__LOG__(2)`SocketOpenerMD closing socket opener`,this.active=!1,this.sockets.forEach((e=>{e.cancel()}));var e=this.controller;e&&(e.deactivate(),this.controller=null)})).catchType(Promise.CancellationError,(()=>{})).catch((e=>{if(__LOG__(3)`SocketOpenerMD deadly error! ${String(e)}`,!this.onerror)return Promise.reject(e);this.onerror(e)})),this.tsListener=e=>{this.retryTimestamp=e.ts},this.listenTo(u.default,"change:online",this.onOnlineChange),this.listenTo(d.default,d.JS_HALT_EVENT,this.onJsHalt),this.onOnlineChange()}attemptOpen(){if(this.active){var e=(0,_.open)(this.routingToken?`${l.default.CHATD_WEB_SOCKET_URL}?ED=${this.routingToken}`:l.default.CHATD_WEB_SOCKET_URL);this.attempts=this.sockets.push(e);var t=!1,r=function(){if(t)return Promise.resolve();t=!0;var e=(new s.default).signal;return u.default.checkOnline({signal:e})},a=new s.default;(0,c.default)(6e3,a.signal).then((()=>r())).catch((()=>{})),e.then(this._resolve).finally((()=>a.abort())).catchType(Promise.CancellationError,(()=>{})).catch((()=>r()))}else __LOG__(2)`attemptOpen called while not active!`}poke(){this.controller&&this.controller.forceTimeout()}onOnlineChange(){if(this.active){var e=this.controller,t=u.default.online?this.onlineController():this.offlineController();e&&(e.off("change:ts",this.tsListener),e.deactivate()),t.on("change:ts",this.tsListener),t.activate(),this.controller=t}}onlineController(){return __LOG__(2)`SocketOpenerMD:onlineController activating`,new f.default({waitAlgorithm:v,jitter:.2,onActivated:()=>{this.attemptOpen()},onTimeout:()=>(this.attemptOpen(),!0)})}offlineController(){__LOG__(2)`SocketOpenerMD:offlineController activating`;var e,t=0;return new f.default({waitAlgorithm:a=>(e&&e.cancel(),navigator.onLine?t++<2?(__LOG__(2)`SocketOpenerMD:offline... quick poll`,e=null,6e3):(__LOG__(2)`SocketOpenerMD:offline... heuristic poll`,e=y(a,[(0,h.waitForOnlineNaive)(),(0,p.default)(d.default,d.JS_HALT_EVENT),(0,p.default)(r(96377).default,"change:available")]),m):(__LOG__(2)`SocketOpenerMD:offline... wait for navigator`,t=0,e=y(a,[(0,h.waitForOnlineNaive)()]),m)),jitter:.2,onActivated:()=>{0===this.pendingAttempts()&&this.attemptOpen()},onDeactivated:()=>{e&&e.cancel()},onTimeout:()=>(this.attemptOpen(),!0)})}deactivate(){this._reject(new Promise.CancellationError)}pendingAttempts(){return(0,n.default)(this.sockets,(e=>e.isPending()?1:0))}onJsHalt(e){var t=this.controller;t&&e>g&&(__LOG__(2)`js halt longer than ${g} ms detected, resetting watchdog fail generation`,t.resetGeneration())}}function y(e,t){return Promise.any(t).cancellable().then((()=>{e.forceTimeout()})).finally((()=>{t.forEach((e=>{e.cancel()}))})).catchType(Promise.CancellationError,(()=>{}))}var S=(0,o.defineModel)(E);t.default=S},35112:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.getHash=function(e){return(e instanceof f.default?(0,c.opaqueDataToArrayBuffer)(e):(0,d.blobToArrayBuffer)(e)).then((e=>(0,_.default)(e))).catch((t=>{var r={error:`${t}`,blobSize:e.size,isOpaqueData:e instanceof f.default};__LOG__(3,void 0,void 0,!0)`SubtleCrypto::getHash error. Debug:\n${JSON.stringify(r,null,2)}`,SEND_LOGS("subtle-crypto-get-hash-error")}))},t.decrypt=m,t.decryptE2EMedia=function(e,t,r,a){var i,n=Promise.resolve().then((()=>{if(!e)throw new l.MediaEncryptionError('decrypt async, missing "type"');if(!(t instanceof ArrayBuffer))throw new l.MediaEncryptionError('decrypt async, missing "payload"');if(!r)throw new l.MediaEncryptionError('decrypt async, missing "mediaKey"');if(i=new p.default.WebcCryptoMedia({webcCryptoType:p.default.WEBC_CRYPTO_TYPE_CODE.DECRYPT,webcCryptoLibrary:p.default.WEBC_CRYPTO_LIBRARY_CODE.WEBCRYPTO,webcCryptoFileSize:t.byteLength}),t.byteLength<10)throw new l.MediaEncryptionError(`ciphertext too short: ${t.byteLength}`);return(0,o.default)(e,r).then((({iv:r,encKey:i,macKey:n})=>{var s=t.byteLength-10,o=new Uint8Array(t,s),l=new Uint8Array(t,0,s);return m(new Uint8Array(i),new Uint8Array(r),l,new Uint8Array(n),o,a||(t=>(0,h.getMediaMimeType)(e,t)))}))})).tap((e=>{e.autoreleaseWhenPromiseCompletes(n),i.markWebcCryptoElapsedT(),i.commit()})).catchConditional((e=>!(e instanceof l.MediaEncryptionError)),(e=>{var t=e instanceof Error?`encryption error: ${String(e)}; stack: ${e.stack}`:`encryption error: ${String(e)};`;throw new l.MediaEncryptionError(t)}));return n};var n=r(49244),s=r(74306),o=i(r(23130)),l=a(r(24461)),d=r(48537),u=i(r(34601)),c=r(25332),p=i(r(84161)),h=r(6353),f=i(r(93013)),_=i(r(73950));function m(e,t,r,a,i,o){return Promise.resolve().then((()=>{if(!(10<=i.length&&i.length<=32))throw new l.MediaEncryptionError("Given bad expected hmac");var o=n.Binary.build(t,r).readByteArray();return new u.default(a).sign(o).then((t=>{for(var r=new Uint8Array(t,0,i.length),a=!1,n=0;n<r.length;n++)r[n]!==i[n]&&(a=!0);if(a)throw new l.MediaEncryptionError("hmac check failure");return(0,s.aesCbcDecrypt)(e,o)}))})).then((e=>{var t="string"==typeof o?o:o(new Uint8Array(e));return f.default.createFromData(e,t)}))}},25568:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=!1;try{var a={get passive(){r=!0}};window.addEventListener("test",null,a)}catch(e){}var i=r;t.default=i},8950:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.genSecurityCodeNotificationMsg=function(e,t){var r=(0,n.getMeUser)();return{id:new s.default({fromMe:t.equals(r),remote:e,id:(0,o.default)()}),t:(0,i.unixTime)(),type:"e2e_notification",subtype:"identity",from:e,to:r,body:t.toString()}},t.genDeviceNotificationMsg=function(e,t,r,a){var d=(0,n.assertGetMe)(),u=new s.default({fromMe:t.equals((0,l.toUserWid)(d)),remote:e,id:(0,o.default)()}),c=u.fromMe&&r.includes(d.getDeviceId());return{id:u,t:(0,i.unixTime)(),type:"e2e_notification",subtype:"device",from:e,to:(0,l.toUserWid)(d),body:t.toString(),devicesAdded:r.length,devicesRemoved:a.length,isThisDeviceAdded:c}},t.genEncryptNotificationMsg=function(e,t="encrypt"){return d(e,"e2e_notification",t,[])},t.genTealNotificationTemplateMsg=function(e,t,r=[]){return d(e,"notification_template",t,r)},t.genNotificationMsg=d;var i=r(95334),n=r(66239),s=a(r(83746)),o=a(r(2661)),l=r(25054);function d(e,t,r,a){var l=(0,n.getMeUser)();return{id:new s.default({fromMe:e.equals(l),remote:e,id:(0,o.default)()}),t:(0,i.unixTime)(),type:t,subtype:r,from:e,to:l,templateParams:a}}},63726:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.genGroupCreationMsg=function(e,t){var r,a,n,{chatId:l,externalId:d}=e;if(!d)throw new Error(`handleGroupCreationMD: no externalId for group action ${JSON.stringify(e)}, ${JSON.stringify(t)}`);var u=null!==(r=null!==(a=t.owner)&&void 0!==a?a:e.author)&&void 0!==r?r:(0,i.getMaybeMeUser)(),c=t.subject;return{id:new s.default({remote:l,fromMe:!1,participant:u,id:(0,o.default)()}),author:u,body:c,from:l,recipients:[],self:"in",subtype:"create",t:null!==(n=t.creation)&&void 0!==n?n:e.ts,type:"gp2"}},t.genGroupNotificationMsg=function(e,t){var{chatId:r,externalId:a}=e,i=e.author&&(0,l.toUserWid)(e.author)||void 0;if(!a)throw new Error(`handleGroupActionMD: no externalId for group action ${JSON.stringify(e)}, ${JSON.stringify(t)}`);var o=null,d=[],u=i,c=t.action,p=null;switch(t.action){case n.GROUP_ACTIONS.SUBJECT:o=t.subject;break;case n.GROUP_ACTIONS.MODIFY:d=t.participants;break;case n.GROUP_ACTIONS.ADD:t.isInvite&&(c="invite");case n.GROUP_ACTIONS.PROMOTE:case n.GROUP_ACTIONS.DEMOTE:case n.GROUP_ACTIONS.REMOVE:1===(d=t.participants).length&&(u=d[0]),t.action===n.GROUP_ACTIONS.REMOVE&&1===d.length&&i===u&&(c="leave");break;case n.GROUP_ACTIONS.INVITE_CODE:c="revoke_invite";break;case n.GROUP_ACTIONS.DESC_ADD:c="description",o=t.desc;break;case n.GROUP_ACTIONS.DESC_REMOVE:c="description";break;case n.GROUP_ACTIONS.RESTRICT:case n.GROUP_ACTIONS.ANNOUNCE:case n.GROUP_ACTIONS.NO_FORWARD:p=t.value?["on"]:["off"],o=p[0];break;case n.GROUP_ACTIONS.EPHEMERAL:i&&(p=[`${t.duration}`,i])}var h={id:new s.default({remote:r,fromMe:!1,participant:u,id:a}),author:i,from:r,recipients:d.map(l.toUserWid)||[],self:"in",subtype:c,t:e.ts,type:"gp2"};o&&(h.body=o);p&&(h.templateParams=p);return h},t.genGroupPicChangeNotificationMsg=function(e,t,r,a,i){return{type:"gp2",self:"in",subtype:"picture",t:r,author:a,body:t,recipients:[],from:e,id:new s.default({remote:e,fromMe:!1,id:i})}},t.genGroupEphemeralSettingMsg=function(e,t,r,a){return{id:new s.default({remote:e,fromMe:!1,participant:r,id:(0,o.default)()}),author:r,from:e,recipients:[],self:"in",subtype:"ephemeral",t,type:"gp2",templateParams:[`${a}`]}};var i=r(66239),n=r(6471),s=a(r(83746)),o=a(r(2661)),l=r(25054)},13152:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getContactPrivacyMode=function(e,t,r){return e&&t?null==r||"self"===r.actualActors&&"on_premise"===r.hostStorage?a.E2EE:"facebook"===r.hostStorage?a.FB:a.BSP:a.E2EE},t.ReducedPrivacyMode=void 0;var a=r(28103).Mirrored(["E2EE","BSP","FB"]);t.ReducedPrivacyMode=a},37994:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(71107));class n extends i.default{constructor(){super(),this.mediaQuery=window.matchMedia("(prefers-color-scheme: dark)"),this.theme=this.currentTheme,this.handleThemeChange=()=>{var e=this.currentTheme;e!==this.theme&&(this.theme=e,this.trigger("system_theme_change",e))},this.mediaQuery.addListener(this.handleThemeChange)}get currentTheme(){return this.mediaQuery.matches?"dark":"light"}}var s=new n;t.default=s},24307:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r={ROOT:1,THENABLE:2,FINALLY:3,META:4},a={PENDING:1,FULFILLED:2,REJECTED:3};function i(){var e,t;switch(this._parent=null,this._subs=[],this._catchTypes=null,this._onResolve=null,this._onReject=null,this.type=r.ROOT,this.state=a.PENDING,this.value=void 0,this._forceable=!1,this._cancellable=!1,arguments.length){case 0:break;case 1:e=arguments[0];break;case 2:t=arguments[0],e=arguments[1];break;default:throw new Error("TightPromise constructor with "+arguments.length+" arguments")}if(this.context=t,arguments.length>0)try{e.call(t,s.bind(this),o.bind(this))}catch(e){o.call(this,e)}}function n(...e){var t=new i;return t.type=r.THENABLE,t._onReject=arguments[arguments.length-1],arguments.length>1&&(t._catchTypes=Array.prototype.slice.call(arguments,0,arguments.length-1),t._catchTypes.forEach((function(e){if("function"!=typeof e)throw new Error("expected type, got "+e)}))),this._addChild(t),t}function s(e){var t;this.state===a.PENDING&&("object"!=typeof(t=e)&&"function"!=typeof t||"function"!=typeof t.then?(this.value=e,this.state=a.FULFILLED,this._notifySubs()):e.then(s.bind(this),o.bind(this)))}function o(e){this.state===a.PENDING&&(this.value=e,this.state=a.REJECTED,this._notifySubs())}i.STATE=a,i.TYPE=r,i.prototype={isPending:function(){return this.state===a.PENDING},then:function(e,t){if(!e&&!t)return this;var a=new i;return a.type=r.THENABLE,a._onResolve=e||null,a._onReject=t||null,this._addChild(a),a},catch:n,catchType:n,catchTypes:n,catchTypes3:n,catchEqualTo:n,catchConditional:n,finally:function(e){var t=new i;return t.type=r.FINALLY,t._onResolve=e,this._addChild(t),t},bind:function(e){var t=new i;return t.type=r.META,this._addChild(t),t.context=e,t},spread:function(e){return this.then((function(t){e.apply(this,t)}))},get:function(e){return this.then((function(t){return t[e]}))},forceable:function(){var e=new i;return e.context=this.context,e.type=r.META,this._addChild(e),e._forceable=!0,e},cancellable:function(){var e=new i;return e.context=this.context,e.type=r.META,this._addChild(e),e._cancellable=!0,e},force:function(e){if(this._forceable){for(var t=this;t.type===r.META;){var i=t._parent;if(!i||!i._forceable||i.state!==a.PENDING)break;t=i}s.call(this,e)}},cancel:function(e){var t=e;if(this._cancellable){t=t||new Promise.CancellationError;var r=this,i=!1;do{var n=r._parent;n&&n._cancellable&&n.state===a.PENDING?r=n:i=!0}while(!i);o.call(r,t)}},timeout:function(e,t){var n=new i;return n.type=r.META,this._addChild(n),n.state===a.PENDING&&setTimeout(o.bind(n,new Promise.TimeoutError(t)),e),n},loosen:function(){return Promise.resolve(this)},_run:function(e,t){var r;try{r=e.call(this.context,t)}catch(e){return void o.call(this,e)}s.call(this,r)},_handle:function(){if(this.state===a.PENDING){var e=this._parent;switch(this.type){case r.THENABLE:if(e.state===a.FULFILLED){var t=this._onResolve;t?this._run(t,e.value):s.call(this,e.value)}else if(this._onReject){var i=this._catchTypes,n=i?i.length:0,l=e.value;if(0===n)return void this._run(this._onReject,l);for(var d=0;d<n;d++)if(l instanceof i[d])return void this._run(this._onReject,l);o.call(this,l)}else o.call(this,e.value);return;case r.FINALLY:try{this._onResolve.call(this.context)}catch(e){!function(e){setTimeout((function(e){throw e}),0,e)}(e)}default:e.state===a.FULFILLED?s.call(this,e.value):o.call(this,e.value)}}},_addChild:function(e){e._parent=this,e.context=this.context,e._cancellable=this._cancellable,e.type===r.META&&(e._forceable=this._forceable),this.state===a.PENDING?this._subs.push(e):e._handle()},_notifySubs:function(){this._subs.forEach((function(e){e._handle()}))}},i.delay=function(...e){var t,r;switch(arguments.length){case 0:t=0;break;case 1:t=arguments[0];break;default:t=arguments[1],r=arguments[0]}return new i((function(e){setTimeout(e.bind(null,r),t)}))},i.resolve=function(e){var t=new i;return s.call(t,e),t},i.reject=function(e){var t=new i;return o.call(t,e),t};var l=i;t.default=l},56179:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.expBackoff=i,t.expDelaySec=function(e,t,r,n=.1){return(0,a.delayMs)(Math.floor(1e3*i(e,t,r,n)))};var a=r(60266);function i(e,t,r,a=.1){var i;return i=0===e?r||0:Math.pow(2,e),Number.isFinite(t)&&i>t&&(i=t),"number"==typeof r&&Number.isFinite(r)&&i<r&&(i=r),a&&(i*=1+a*Math.random()),i}},84666:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TLD=void 0;t.TLD="abb|abbott|ac|academy|accountant|accountants|ad|adult|ae|aero|af|africa|ag|agency|ai|al|am|amsterdam|anz|ao|apartments|app|apple|ar|archi|army|art|as|asia|associates|at|au|auction|audio|auto|aws|ax|axa|az|ba|baby|band|bank|bar|barclays|basketball|bayern|bb|bbva|bd|be|beauty|beer|berlin|best|bet|bf|bg|bh|bi|bible|bid|bike|bingo|bio|biz|bj|black|blog|blue|bm|bn|bnpparibas|bo|bond|bot|boutique|box|br|bradesco|brother|brussels|bs|bt|build|builders|business|buzz|bw|by|bz|bzh|ca|cab|cafe|cam|camera|camp|canon|capetown|capital|cards|care|careers|cars|casa|cash|casino|cat|cba|cbs|cc|cd|center|ceo|cern|cf|cg|ch|charity|chat|cheap|chrome|church|ci|citic|city|ck|cl|claims|cleaning|click|clinic|clothing|cloud|club|cm|cn|co|coach|codes|coffee|college|cologne|com|community|company|computer|construction|consulting|cool|coop|country|coupons|courses|cr|credit|creditcard|cricket|cu|cv|cw|cx|cy|cymru|cyou|cz|dance|data|date|dating|de|deals|degree|delivery|deloitte|dental|dentist|desi|design|dev|dhl|diet|digital|direct|directory|discount|dj|dk|do|doctor|dog|domains|download|dz|earth|ec|eco|edu|education|ee|eg|email|energy|engineering|equipment|es|estate|et|eu|eus|events|exchange|expert|exposed|express|extraspace|fage|fail|faith|family|fan|fans|farm|fashion|feedback|fi|film|finance|financial|fish|fit|fitness|fj|flights|florist|flowers|fm|fo|football|forex|forsale|forum|foundation|fox|fr|fun|fund|furniture|futbol|fyi|ga|gal|gallery|game|games|garden|gd|gdn|ge|gg|gh|gi|gift|gifts|gives|gl|glass|gle|global|globo|gm|gmbh|gold|golf|goog|google|gop|gov|gp|gq|gr|graphics|gratis|green|group|gs|gt|guide|guru|gy|haus|health|healthcare|help|helsinki|here|hiphop|hk|hn|hockey|holdings|holiday|homes|honda|horse|host|hosting|house|how|hr|hsbc|ht|hu|icu|id|ie|il|im|immo|in|inc|industries|info|ink|institute|insure|int|international|investments|io|iq|ir|is|ist|istanbul|it|jcb|je|jewelry|jm|jo|jobs|jp|ke|kg|kh|ki|kim|kitchen|kiwi|km|koeln|kp|kpmg|kr|krd|kred|kw|ky|kyoto|kz|la|land|lat|law|lawyer|lb|lc|leclerc|legal|lgbt|li|life|lighting|limited|link|live|lk|llc|loan|loans|lol|london|love|lr|ls|lt|ltd|ltda|lu|luxury|lv|ly|ma|madrid|management|market|marketing|markets|mba|md|me|media|melbourne|men|menu|mg|miami|mil|mk|ml|mm|mn|mo|mobi|moda|moe|moi|mom|monash|money|monster|mortgage|moscow|movie|mp|mq|mr|ms|msd|mt|mu|museum|mv|mw|mx|my|mz|na|name|nc|ne|net|network|neustar|news|nf|ng|ngo|ni|nico|ninja|nl|no|np|nr|nrw|nu|nyc|nz|observer|office|okinawa|om|one|ong|onl|online|ooo|orange|org|organic|ovh|pa|page|paris|partners|parts|party|pe|pet|pf|pg|ph|pharmacy|photo|photography|photos|physio|pics|pictures|pink|pizza|pk|pl|place|plumbing|plus|pm|pn|poker|porn|post|pr|press|pro|prod|productions|promo|properties|ps|pt|pub|pw|py|qa|quebec|quest|racing|radio|re|realtor|realty|recipes|red|reise|ren|rent|rentals|repair|report|rest|restaurant|review|reviews|rich|rip|ro|rocks|rodeo|rs|ru|rugby|run|rw|sa|sale|salon|sandvik|sap|saxo|sb|sbi|sc|scb|school|schule|science|scot|sd|se|security|services|ses|sex|sexy|sg|sh|sharp|shell|shiksha|shoes|shop|shopping|show|si|site|sk|ski|skin|sl|sm|sn|sncf|so|soccer|social|softbank|software|solar|solutions|sony|soy|space|sport|sr|st|storage|store|stream|studio|study|style|su|sucks|supply|support|surf|sv|swiss|sx|sy|sydney|systems|sz|taipei|tatar|tattoo|tax|taxi|tc|td|team|tech|technology|tel|tennis|tf|tg|th|theater|tickets|tips|tj|tk|tl|tm|tn|to|today|tokyo|tools|top|toshiba|tours|town|toyota|toys|tr|trade|trading|training|travel|tt|tube|tv|tw|tz|ua|ug|uk|university|uno|us|uy|uz|va|vanguard|vc|ve|vegas|ventures|vet|vg|vi|video|vin|vip|vision|vn|voyage|vu|wales|wang|watch|webcam|weber|website|wedding|weir|wf|wien|wiki|win|wine|woodside|work|works|world|ws|wtf|xyz|yandex|ye|yoga|youtube|yt|za|zip|zm|zone|zw|||||||||||||||"},23682:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(86534)),n=[.1,.82,.25,1],s=[.69,0,.79,.14],o=[.84,.07,.93,.46];i.default.RegisterEffect("attach.Up",{defaultDuration:300,calls:[[{opacity:[1,0],translateY:["0%","150%"],scaleX:[1,.3],scaleY:[1,.3]},1,{easing:[300,22]}]]}),i.default.RegisterEffect("attach.Down",{defaultDuration:200,easing:s,calls:[[{opacity:[0,1],translateY:["100%","0%"],scaleX:[.3,1],scaleY:[.3,1]},1,{easing:[.33,0,.39,.91]}]]}),i.default.RegisterEffect("dropdown.Down",{defaultDuration:200,easing:n,calls:[[{opacity:[1,0],translateY:["0%","-15px"]},1,{easing:n}]]});var l={pop:{duration:200,easing:o,enter:{props:{scaleX:[1,.5],scaleY:[1,.5],opacity:[1,0]}},leave:{props:{scaleX:[.5,1],scaleY:[.5,1],opacity:[0,1]}}},slide:{duration:200,easing:n,enter:{props:"slideDown"},leave:{props:"slideUp"}},scaleY:{duration:200,easing:n,enter:{props:{scaleY:[1,0],transformOrigin:"center"}},leave:{props:{scaleY:[0,1],transformOrigin:"center"}}},scale:{duration:500,easing:n,enter:{props:{scaleX:[1,0],scaleY:[1,0]}},leave:{props:{scaleX:[0,1],scaleY:[0,1]}}},fade:{duration:200,easing:n,enter:{props:{opacity:[1,0]}},leave:{props:{opacity:[0,1]}}},"fade-fast":{easing:"ease",enter:{props:{opacity:[1,0]},duration:150},leave:{props:{opacity:[0,1]},duration:100}},fade_sifo:{enter:{props:{opacity:[1,0]},duration:250},leave:{props:{opacity:[0,1]},duration:100}},capture:{enter:{props:{opacity:[1,0]},duration:350},leave:[{selector:"[data-animate-capture-snapshot]",props:"transition.bounceDownOut",duration:700},{selector:"[data-animate-capture-webcam]",props:{opacity:[0,1]},duration:100,easing:"ease"}]},butterbar:{enter:{props:"slideDown",easing:n,duration:700},leave:{props:"slideUp",easing:s,duration:350}},modal:{enter:[{selector:"[data-animate-modal-backdrop]",props:{opacity:[1,0]},duration:300,easing:[.19,.73,.28,1]},{selector:"[data-animate-modal-popup]",props:{scaleX:[1,0],scaleY:[1,0],opacity:[1,0]},easing:[.19,.73,.28,1],delay:180,duration:200},{selector:"[data-animate-modal-popup]",props:{opacity:[0,0]},duration:180}],leave:[{selector:"[data-animate-modal-backdrop]",props:{opacity:[0,1]},duration:300,easing:s,delay:100},{selector:"[data-animate-modal-popup]",props:{scaleX:[0,1],scaleY:[0,1]},easing:s,duration:200}]},"modal-flow":{enter:[{selector:"[data-animate-modal-backdrop]",props:{opacity:[1,0]},duration:300,easing:[.19,.73,.28,1]},{selector:"[data-animate-modal-popup]",props:{scaleX:[1,0],scaleY:[1,0],opacity:[1,1]},easing:[.19,.73,.28,1],delay:180,duration:200},{selector:"[data-animate-modal-popup]",props:{opacity:[0,0]},duration:180}],leave:[{selector:"[data-animate-modal-backdrop]",props:{opacity:[0,1]},duration:300,easing:s,delay:100},{selector:"[data-animate-modal-popup]",props:{scaleX:[0,1],scaleY:[0,1]},easing:s,duration:200}]},"flow-transition-modal-push":{duration:300,easing:n,enter:{props:{opacity:[1,0]}},leave:{props:{opacity:[0,1]}}},"flow-transition-modal-pop":{duration:300,easing:n,enter:{props:{opacity:[1,0]}},leave:{props:{opacity:[0,1]}}},"flow-transition-box-size-drawer-push":{duration:300,easing:n,enter:[{selector:"[data-animate-modal-body]",props:{translateX:["0%","100%"]}}],leave:[{props:{background:["transparent","transparent"]}},{selector:"[data-animate-modal-popup]",props:{background:["transparent","transparent"],boxShadow:["none","none"]}},{selector:"[data-animate-modal-body]",props:{translateX:["-100%","0%"]}}]},"flow-transition-box-size-drawer-pop":{duration:300,easing:n,enter:[{selector:"[data-animate-modal-body]",props:{translateX:["0%","-100%"]}}],leave:[{props:{background:["transparent","transparent"]}},{selector:"[data-animate-modal-popup]",props:{background:["transparent","transparent"],boxShadow:["none","none"]}},{selector:"[data-animate-modal-body]",props:{translateX:["100%","0%"]}}]},"flow-transition-drawer-push":{duration:300,easing:n,enter:{props:{translateX:["0%","100%"]}},leave:{props:{translateX:["-100%","0%"]}}},"flow-transition-drawer-pop":{duration:300,easing:n,enter:{props:{translateX:["0%","-100%"]}},leave:{props:{translateX:["100%","0%"]}}},"drawer-left":{enter:[{props:{translateX:["0%","-100%"]},duration:300,easing:n},{selector:"[data-animate-drawer-title]",props:{translateX:[0,-50],opacity:[1,0]},duration:500,easing:"easeOut"}],leave:[{props:{translateX:["-100%","0%"]},duration:300,easing:s}]},"drawer-left-rtl":{enter:[{props:{translateX:["0%","100%"]},duration:300,easing:n},{selector:"[data-animate-drawer-title]",props:{translateX:[0,50],opacity:[1,0]},duration:500,easing:"easeOut"}],leave:[{props:{translateX:["100%","0%"]},duration:300,easing:s}]},dropdown:{duration:300,easing:n,enter:[{selector:"[data-animate-dropdown-item]",props:"dropdown.Down",delay:50,duration:375,stagger:25,drag:!0},{props:{scale:[1,0]}},{props:{opacity:[1,0]},duration:100}],leave:{props:{scaleX:[0,1],scaleY:[0,1],opacity:[0,1]}}},"dropdown-picker":{duration:300,easing:n,enter:[{selector:"[data-animate-dropdown-item]",props:{opacity:[1,0]},delay:50,duration:200},{selector:"[data-animate-dropdown-nib]",props:{opacity:[1,0],rotateZ:["45deg"],translateY:["0%","-100%"]}},{props:{scale:[1,0]}},{props:{opacity:[1,0]},duration:100}],leave:[{selector:"[data-animate-dropdown-item]",props:{opacity:[1,0]},duration:100},{selector:"[data-animate-dropdown-nib]",props:{opacity:[1,0]},duration:150},{props:{scaleX:[0,1],scaleY:[0,1],opacity:[0,1]}}]},"profile-viewer":{duration:500,easing:[.1,1.03,.28,.99],leave:[{delay:400,props:{opacity:[0,1]}},{selector:"[data-animate-profile-viewer]",props:{borderRadius:["50%","0%"]}}]},"media-viewer":{duration:300,easing:[.1,1.03,.28,.99],leave:{selector:"[data-animate-media-viewer]",props:{opacity:[0,1]}}},"status-v3-quoted-msg":{enter:{props:{translateY:["0%","100%"],opacity:[1,0]},duration:200,easing:[.1,.82,.25,1]},leave:{props:{translateY:["100%","0%"],opacity:[0,1]},duration:200,easing:[.1,.82,.25,1]}},"status-v3-modal":{easing:[.55,.085,.68,.53],enter:{duration:100,selector:"[data-animate-status-v3-modal-background]",props:{opacity:[1,0]}},leave:{duration:100,selector:"[data-animate-status-v3-modal-background]",props:{opacity:[0,1]}}},"quoted-status-v3-modal":{easing:[.55,.085,.68,.53],enter:{duration:100,selector:"[data-animate-status-v3-viewer]",props:{opacity:[1,0]}},leave:{duration:100,selector:"[data-animate-status-v3-viewer]",props:{opacity:[0,1]}}},"status-v3-player":{easing:[.55,.085,.68,.53],enter:{duration:200,props:{opacity:[1,0]}},leave:{duration:200,props:{opacity:[0,1]}}},menu:{enter:{selector:"[data-animate-menu-icons-item]",props:"attach.Up",duration:700,stagger:30,drag:!1},leave:{selector:"[data-animate-menu-icons-item]",props:"attach.Down",duration:200,stagger:30}},emoji:{duration:300,easing:n,enter:{props:{height:[291,0]}},leave:{props:{height:[0,291]}}},ptt:{enter:[{selector:"[data-animate-btn-border]",easing:"easeInOut",props:{scaleX:[1,.5],scaleY:[1,.5],opacity:[1,0]},duration:250,delay:100},{selector:"[data-animate-ptt-counter]",easing:"easeInOut",props:{scaleX:[1,.8],scaleY:[1,.8],opacity:[1,0]},duration:250,delay:100},{props:{opacity:[1,0]},duration:150,easing:n}],leave:[{selector:"[data-animate-btn-border]",easing:n,props:{scaleX:[.5,1],scaleY:[.5,1],opacity:[0,1]},duration:250},{selector:"[data-animate-ptt-counter]",easing:n,props:{scaleX:[.5,1],scaleY:[.5,1],opacity:[0,1]},duration:250},{props:{opacity:[0,1]},duration:300,easing:n}]},"slide-left":{duration:300,easing:n,enter:{props:{translateX:["0%","100%"]}},leave:{props:{translateX:["100%","0%"]}}},"slide-left-rtl":{duration:300,easing:n,enter:{props:{translateX:["0%","-100%"]}},leave:{props:{translateX:["-100%","0%"]}}},"slide-forward":{duration:200,easing:[.19,.93,.18,.99],enter:{props:{translateX:["0%","100%"]}},leave:{props:{translateX:["-100%","0%"]}}},"slide-back":{duration:200,easing:[.19,.93,.18,.99],enter:{props:{translateX:["0%","-100%"]}},leave:{props:{translateX:["100%","0%"]}}},"media-slide-forward":{duration:200,easing:[.19,.93,.18,.99],enter:[{selector:"[data-animate-attach-media]",props:{opacity:[1,0],translateX:["0%","30%"]}},{selector:"[data-animate-media-caption]",props:{opacity:[1,0]}}],leave:[{selector:"[data-animate-attach-media]",props:{opacity:[0,1],translateX:["-30%","0%"]}},{selector:"[data-animate-media-caption]",props:{opacity:[0,1]}}]},"media-slide-back":{duration:200,easing:[.19,.93,.18,.99],enter:[{selector:"[data-animate-attach-media]",props:{opacity:[1,0],translateX:["0%","-30%"]}},{selector:"[data-animate-media-caption]",props:{opacity:[1,0]}}],leave:[{selector:"[data-animate-attach-media]",props:{opacity:[0,1],translateX:["30%","0%"]}},{selector:"[data-animate-media-caption]",props:{opacity:[0,1]}}]},"slide-down-date":{duration:300,enter:{props:{translateY:["0%","-130%"],opacity:[1,0]},easing:n},leave:{props:{translateY:["-130%","0%"],opacity:[0,1]},easing:s}},"slide-down-test":{duration:300,easing:n,enter:{props:{height:["auto","0"],opacity:[1,0]}},leave:{props:{translateY:["-130%","0%"],opacity:[0,1]}}},"pop-fast-reverse":{duration:75,easing:[.14,.62,.33,.9],enter:[{selector:"[data-js-context-icon]",props:{translateX:["0%","-100%"]}},{props:{opacity:[1,.5]}}],leave:[{selector:"[data-js-context-icon]",props:{translateX:["-100%","0%"]}},{props:{opacity:[0,1]}}]},"pop-fast":{duration:75,easing:[.14,.62,.33,.9],enter:[{selector:"[data-js-context-icon]",props:{translateX:["0%","100%"]}},{props:{opacity:[1,.5]}}],leave:[{selector:"[data-js-context-icon]",props:{translateX:["100%","0%"]}},{props:{opacity:[0,1]}}]},"pop-fast-chat":{duration:75,easing:[.14,.62,.33,.9],enter:[{props:{width:["20px","5px"],opacity:[1,.5]}}],leave:[{props:{width:["5px","20px"],opacity:[0,1]}}]},"toast-transition":{duration:300,easing:n,cleanOnComplete:!0,enter:{props:{translateY:["0%","100%"],opacity:[1,0]}},leave:{props:{opacity:[0,1]}}},"slide-up-down":{duration:300,easing:n,enter:{props:{translateY:["0%","100%"]}},leave:{props:{translateY:["100%","0%"]}}},"slide-up-down-footer":{duration:200,easing:n,enter:[{props:{translateY:["0%","100%"]}},{selector:"[data-animate-btn]",props:{opacity:[1,0],scale:[1,0]},delay:200,duration:300}],leave:[{props:{translateY:["100%","0%"]},delay:200},{selector:"[data-animate-btn]",props:{opacity:[0,1],scale:[.6,1]},duration:200}]},"slide-up":{duration:300,easing:n,enter:{props:{translateY:["0%","100%"]}},leave:{props:{translateY:["100%","0%"]}}},"slide-down":{duration:300,easing:n,enter:{props:{translateY:["0%","-100%"]}},leave:{props:{translateY:["-100%","0%"]}}},"emoji-search-slide-away":{duration:300,enter:{easing:"easeOutCubic",props:{translateY:["0%","-100%"]}},leave:{easing:"easeInCubic",props:{translateY:["-100%","0%"]}}},"emoji-search-slide-away-fast":{duration:80,enter:{easing:"easeOutCubic",props:{translateY:["0%","-100%"]}},leave:{easing:"easeInCubic",props:{translateY:["-100%","0%"]}}},"emoji-search-panel-slide-up":{duration:300,easing:n,enter:{props:{translateY:["0%","100%"],opacity:[1,0]}},leave:{props:{translateY:["100%","0%"],opacity:[0,1]}}},none:{},btn:{duration:300,easing:n,enter:{props:{scale:[1,0],opacity:[1,0]}},leave:{props:{scale:[0,1],opacity:[0,1]}}},pop_delay:{duration:300,enter:[{props:{scale:[1,0],opacity:[1,0]},delay:500,easing:n}],leave:{props:"transition.expandOut",easing:s}},"delay-leave":{duration:1,enter:{props:{opacity:[1,1]}},leave:{props:{opacity:[1,1]},delay:300}},"media-caption":{enter:[{props:{opacity:[0,0],translateY:["100%","100%"]},duration:200},{props:{opacity:[1,0],translateY:["0%","100%"]},easing:n,delay:200,duration:300}],leave:{props:{opacity:[0,1]},easing:"ease",duration:300}},"media-scale":{enter:[{selector:"[data-animate-media-caption]",props:{opacity:[0,0],translateY:["100%","100%"]},duration:200},{selector:"[data-animate-media-caption]",props:{opacity:[1,0],translateY:["0%","100%"]},easing:n,delay:200,duration:300},{selector:"[data-animate-attach-media]",props:{opacity:[0,0]},duration:200},{selector:"[data-animate-attach-media]",props:{opacity:[1,0],scale:[1,.625],display:"flex"},delay:200,duration:300,easing:n}],leave:[{selector:"[data-animate-media-caption]",props:{opacity:[0,1]},easing:"ease",duration:300},{selector:"[data-animate-attach-media]",props:{opacity:[0,1],scale:[.5,1],display:"flex"},delay:0,duration:200,easing:s}]},"thumb-scale":{duration:400,easing:n,enter:{props:"transition.expandIn"},leave:{props:"transition.expandOut"}},"thumb-scale-flex":{duration:400,easing:n,enter:{props:{scale:[1,0],display:"flex"}},leave:{duration:200,props:{scale:[0,1],display:"flex"}}},default:{duration:300,enter:{props:{opacity:[1,0]}},leave:{props:{opacity:[0,1]}}},noop:{duration:0},"noop-full-opacity":{duration:0,enter:{props:{opacity:[1,1]}},leave:{props:{opacity:[1,1]}}},pip:{enter:{props:{opacity:[1,0]},duration:400},leave:{props:{scaleX:[.5,1],scaleY:[.5,1],opacity:[0,1]},duration:200,easing:o}},voip:{enter:{props:{opacity:[1,0]},duration:400},leave:{props:{scaleX:[.5,1],scaleY:[.5,1],opacity:[0,1]},duration:200,easing:o}},"replace-fade":{enter:[{props:{opacity:[0,0]},duration:400},{props:{opacity:[1,0]},duration:400,delay:400}],leave:{props:{opacity:[0,1]},duration:400}}};t.default=l},23977:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(t instanceof e)return t;if("string"==typeof t)return new e((0,a.decodeB64)(t));return new e(t)};var a=r(84337)},28017:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var r=t.reduce(((e,t)=>e+t.length),0),a=new e(r),i=0;return t.forEach((e=>{a.set(e,i),i+=e.length})),a}},61864:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isFunction=function(e){return"function"==typeof e},t.isNumber=function(e){return"number"==typeof e},t.isString=function(e){return"string"==typeof e},t.isBoolean=function(e){return"boolean"==typeof e}},11018:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.gteVersion=s,t.ltVersion=o,t.parseUA=l,t.default=void 0;var i=a(r(46353));function n(e,t){var r,a,i=/(\.0)+[^\.]*$/,n=(e+"").replace(i,"").split("."),s=(t+"").replace(i,"").split("."),o=Math.min(n.length,s.length);for(r=0;r<o;r++)if(0!==(a=parseInt(n[r],10)-parseInt(s[r],10)))return a;return n.length-s.length}function s(e,t){return n(e,t)>=0}function o(e,t){return n(e,t)<0}function l(e){var t=new i.default;t.setUA(e||"");var r=(t.getBrowser().name||"").toUpperCase(),a=t.getBrowser().version||"0.0.0",n=(t.getEngine().name||"").toUpperCase(),l=(t.getOS().name||"").toUpperCase(),d=t.getOS().version||"0.0.0",u="SAFARI"===r,c="CHROME"===r,p="GECKO"===n,h=!1;switch(l){case"MAC OS":c?h=s(d,"10.10")&&s(a,"41.0.0"):s(d,"10.7")&&(h=!0);break;case"WINDOWS":s(d,"8.1")&&(p||c&&s(a,"41.0.0"))&&(h=!0)}var f=u||c&&o(a,"76");return{isWebkit:!n||"WEBKIT"===n,isGecko:p,isTrident:"TRIDENT"===n||"EDGEHTML"===n,isSafari:u,isElectron:!1,isBuggyVideoLoad:c&&s(a,"76")||"BLINK"===n&&!c,hasEmoji:h,troublesWithLotsOfVideos:c,supportsEmojiEllipsification:!f,isBrokenGetUserMedia:c&&o(a,"50"),os:l.toLowerCase(),osVersion:d,browser:r.toLowerCase(),browserVersion:a,parser:t}}var d=l("undefined"!=typeof self?self.navigator.userAgent:null);t.default=d},62536:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t,r,a;return r=t=class extends l.WrappedComponent{render(){return this.state.hasError?null:s.createElement(u.default.Consumer,null,(t=>s.createElement(e,(0,n.default)({ref:this.setComponent},this.props,{uim:(0,d.default)(t,"uim")}))))}},t.defaultProps=null!==(a=e.defaultProps)&&void 0!==a?a:void 0,t.displayName=`UIM(${(0,o.default)(e)})`,r};var n=i(r(58527)),s=a(r(2784)),o=i(r(76338)),l=r(5370),d=i(r(21830)),u=i(r(97212))},569:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.UIMState=void 0;var i=a(r(55324)),n=a(r(64116)),s=r(28103).Mirrored(["ACTIVE","PASSIVE","INACTIVE","DEAD"]);t.UIMState=s;class o{static maybePreventScroll(e){var t=o.Manager.top&&o.Manager.top.uie.getNode();e.target instanceof HTMLElement&&t&&!t.contains(e.target)&&(e.preventDefault(),e.stopPropagation())}constructor(e,t){this.shouldRequestFocus=!0,this.parent=e||this,e||(o.Manager.root&&(__LOG__(4,void 0,new Error,!0)`Attempting to set multiple UIM tree roots. Expecting only one.`,SEND_LOGS("multiple-uim-roots")),o.Manager.root=this),this.uie=t,this.children=[],this.state=t.getUIMState()}get state(){return this._state}set state(e){switch(e){case s.ACTIVE:this.lastActive=Date.now(),o.Manager.top=this;break;case s.PASSIVE:this.lastActive=Date.now(),this._state!==s.ACTIVE&&(o.Manager.top=o.findMostRecentlyActiveFocusable());break;case s.INACTIVE:this._state&&this._state!==e&&(o.Manager.top=o.findMostRecentlyActiveFocusable());break;case s.DEAD:}this._state=e}activate(){this.state=this._state}branch(e){var t=new o(this,e);return this.children.push(t),o.pprint(),t}pop(e=!1,t=!0){if(this.state!==s.DEAD){this._invalidateAndDismissChildren(this.children,e),(0,n.default)(this.parent.children,(e=>e===this));var r=o.findMostRecentlyActiveFocusable(this);r&&(r.shouldRequestFocus=t),o.Manager.top=r,o.pprint()}}_invalidateAndDismissChildren(e,t){e.forEach((e=>{e.state=s.DEAD,e.uie.requestDismiss(t),this._invalidateAndDismissChildren(e.children,t)}))}static findMostRecentlyActiveFocusable(e){var{root:t}=o.Manager;if(t)return l(t,e,(e=>e.state===s.ACTIVE||e.state===s.PASSIVE))}static findMostRecentlyActiveDismissable(e){var{root:t}=o.Manager;if(t)return l(t,e,(e=>e.state===s.ACTIVE))||l(t,e,(e=>e.state===s.PASSIVE))}static pprint(e){if(e||o.Manager.verbose){var{root:t}=o.Manager;t&&__LOG__(2)`${u(t,[])}`}}}function l(e,t,r){if(!e.children.length)return e;var a=e.children.filter((e=>e!==t)).map((e=>l(e,t,r))).concat([e]).filter(Boolean).filter(r);return(0,i.default)(a,"lastActive")}o.State=s,o.Manager={_top:void 0,set top(e){e&&(e.lastActive=Date.now()),e&&this._top!==e&&e.state!==s.INACTIVE&&e.state!==s.DEAD&&e.shouldRequestFocus&&e.uie.requestFocus(),e&&(e.shouldRequestFocus=!0),this._top&&this._top.uie.popable()&&window.removeEventListener("wheel",o.maybePreventScroll,!0),e&&e.uie.popable()&&window.addEventListener("wheel",o.maybePreventScroll,!0),this._top=e},get top(){return this._top},refocusTopUie(){setTimeout((()=>{this._top&&document.activeElement===document.body&&this._top.uie.requestFocus()}),0)},root:void 0,verbose:!1};function d(e,t,r,a){var i;i=r&&a?"":r&&!a?"":!r&&a?"":"",e===o.Manager.root&&(i="");var n=e.uie.getDisplayName();e===o.Manager.top&&(n=`${n} `);var l=`(${function(e){switch(e){case s.ACTIVE:return"A";case s.PASSIVE:return"P";case s.INACTIVE:return"I";case s.DEAD:return"D"}}(e.state)})${a?"\n":""}`;return`${t.join("")}${i} ${n} ${l}`}function u(e,t,r){return d(e,t,r,!!e.children.length)+e.children.map(((a,i)=>{var n=i<e.children.length-1;return u(a,r?t.concat([" "]):t.concat(["  "]),n)})).join("\n")}window.addEventListener("keydown",(e=>{if(27===e.keyCode){var{top:t}=o.Manager,r=t&&t.state===s.ACTIVE?t:o.findMostRecentlyActiveDismissable();r&&r.uie.escapable()&&(e.stopPropagation(),e.preventDefault(),r&&r.uie.requestDismiss(!1))}}),{capture:!0});var c=null;function p(e,t){var r=e&&e.state===s.ACTIVE&&e.uie.popable()?e:o.findMostRecentlyActiveDismissable();if(!r||!r.uie.popable())return null;var a=r.uie.getNode();return a&&t.target instanceof Node&&a.contains(t.target)?null:r}window.addEventListener("mousedown",(e=>{if(c=null,e.screenX&&e.screenY){var t=p(o.Manager.top,e);t&&2===e.button?t.uie.requestDismiss():c=t}}),{capture:!0}),window.addEventListener("mouseup",(e=>{if(e.screenX&&e.screenY){var t=p(o.Manager.top,e);t&&t===c&&setTimeout((()=>t.uie.requestDismiss()),0),c=null}else c=null}),{capture:!0});var h=o;t.default=h},97212:(e,t,r)=>{"use strict";var a=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(2784)).createContext(null);t.default=i},89874:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.firstNCodepoints=function(e,t){return i(e||"",0,t)},t.numCodepoints=function(e){return(0,a.length)(e||"")},t.substring=i,t.toArray=n,t.codePointAt=function(e,t=0){if(e.codePointAt)return e.codePointAt(t);var r=e.charCodeAt(t);if(r>=55296&&r<=56319){var a=e.charCodeAt(t+1);a>=56320&&a<=57343&&(r=65536+(r-55296<<10)+(a-56320))}return r},t.firstNEncodedBytes=function(e,t){if(null==t)return e;if(encodeURI(e).length<=t)return e;for(var r=0,a=n(e),s=a.length,o=0;o<s;o++){var l=a[o],d=encodeURI(l).length;if(r+d>t)return i(e,0,o);r+=d}return e};var a=r(64491);function i(e,t,r){if(!e)return"";var i=t||0,n=null==r?1/0:r;return e.length,0===i&&n===1/0?e:e.length>=5e3&&n/e.length<=.5?function(e,t,r){var i,n=new RegExp(a.astralRange),s="",o=0;do{(i=n.exec(e))&&(s+=i[0]),o++}while(i&&o<r);return s}(e,0,n):(0,a.substring)(e,i,n)}function n(e,t,r){var i=e||"",n=t||0,s=null==r?1/0:r;return i.length>=5e3&&s/i.length<=.5?function(e,t,r){var i,n=new RegExp(a.astralRange),s=[];do{(i=n.exec(e))&&s.push(i[0])}while(i&&s.length<r);return s}(i,0,s):(0,a.toArray)(i).slice(n,s)}},33753:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.checkForUpdates=function(){return c.apply(this,arguments)},t.default=t.hasUpdate=t.PLATFORMS=void 0;var i=a(r(52954)),n=a(r(23045)),s=a(r(127)),o=a(r(90311)),l=a(r(3472)),d={WEB:"web",DARWIN:"darwin",WIN32:"win32",MACSTORE:"darwin",WINSTORE:"win32",DARWIN_BETA:"darwin-beta",WIN32_BETA:"win32-beta"};t.PLATFORMS=d;var u=e=>[e.isBroken,e.isBelowSoft,e.isBelowHard,e.beta].some(Boolean);function c(){return(c=(0,i.default)((function*(){var e=d[n.default.WAM_PLATFORM],t=n.default.VERSION_STR.replace(/\.[di]$/,""),a=null;try{var i=yield(0,s.default)(`${n.default.CHECK_UPDATE_URL}?version=${t}&platform=${e}`);if(!i.ok)throw Error(i.statusText);a=yield i.json();var o=(new Date).toISOString();__LOG__(2)`Updater: Checked at ${o} ${JSON.stringify({response:a,version:t})}`}catch(e){__LOG__(4,void 0,new Error)`Updater: Version check failed`}if(!a||!u(a))return!1;var{isBelowHard:c,isBelowSoft:p,hardUpdateTime:h,currentVersion:f,isBroken:_,beta:m}=a;__LOG__(2)`Updater: App will update. ${JSON.stringify({response:a,version:t})}`;var g=c?h:null;return"web"===e?l.default.update(f,p,g):_?r(96377).default.needsManualDownload=!0:l.default.update(void 0,p,g,m),!0}))).apply(this,arguments)}t.hasUpdate=u;var p=new o.default({name:"updater",interval:1800,restingInterval:3600,randomIntervalExtension:180});t.default=p},29493:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.DownloadState=void 0;var i=a(r(84621)),n=a(r(99461)),s=a(r(23045)),o=a(r(78086)),l=a(r(71107)),d=r(24461),u=a(r(29699)),c=a(r(51538)),p=r(28103).Mirrored(["UPDATE_DOWNLOADED","UPDATE_NOT_AVAILABLE","ERROR"]);t.DownloadState=p;class h extends l.default{constructor(){super(),this._forceUpdateOnTakeOver=!1,this.latestUpdateIteration=0,this.activeVersion=new c.default(s.default.VERSION_BASE),o.default.onVersionChange((()=>this.setForceUpdateOnTakeOver()))}setForceUpdateOnTakeOver(){this._forceUpdateOnTakeOver=!0}shouldForceUpdateOnTakeOver(){var e=this._forceUpdateOnTakeOver;return this._forceUpdateOnTakeOver=!1,!!e}isExpired(){return n.default.globalUnixTime()>Number(u.default)}clearHardExpiration(){this.hardExpirationTimer&&(i.default.clearTimeout(this.hardExpirationTimer),this.hardExpirationTimer=void 0),this.stopListening(r(96377).default,"change:couldForce")}update(){throw new d.UnimplementedMethod("Updater::update")}restart(){throw new d.UnimplementedMethod("Updater::restart")}manualDownload(){throw new d.UnimplementedMethod("Updater::manualDownload")}killServiceWorker(){throw new d.UnimplementedMethod("Updater::killServiceWorker")}}t.default=h},3472:(e,t,r)=>{"use strict";var a=r(14859),i=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.Updater=void 0;var n=i(r(29493)),s=a(r(51538)),o=a(r(84621)),l=a(r(92082)),d=a(r(55074));class u extends n.default{update(e,t,a){__LOG__(2)`AppUpdate:update current: ${String(this.activeVersion)} latest: ${String(e)}`;var i=++this.latestUpdateIteration,l=e?new s.default(e):void 0;this.clearHardExpiration();var d=r(96377).default;return"number"==typeof a&&(this.hardExpirationTimer=o.default.setLocalTimeout((()=>(d.clientExpired=!0,this._update(l).then((e=>{e===n.DownloadState.UPDATE_DOWNLOADED&&this.restart()})))),Date.now()+a)),this.updateInProgress=Promise.resolve(this.updateInProgress).then((()=>this._update(l))).tap((e=>{this.updateInProgress=void 0,i===this.latestUpdateIteration&&e!==n.DownloadState.ERROR&&e!==n.DownloadState.UPDATE_NOT_AVAILABLE&&((t||"number"==typeof a)&&(d.needsUpdate=!0),"number"==typeof a&&this.listenToAndRun(d,"change:couldForce",(()=>{d.couldForce&&this.restart()})))}))}_update(e){if(!this.activeVersion.equals(e)&&d.default.alive)return this._swUpdate();var t=this.activeVersion.equals(e)?n.DownloadState.UPDATE_NOT_AVAILABLE:n.DownloadState.UPDATE_DOWNLOADED;return Promise.resolve(t)}killServiceWorker(){if(!d.default.alive)return Promise.resolve();var e=navigator.serviceWorker;return e?(__LOG__(2)`Killing service worker`,e.ready.then((e=>e.unregister())).then((e=>{__LOG__(2)`Service worker unregistration status: ${String(e)}`}))):Promise.resolve()}_swUpdate(){var e=navigator.serviceWorker;return e?e.ready.then((t=>new Promise((r=>{function a(e){s(),__LOG__(3)`Unable to update service worker to version. Error: ${String(e)}`}function i(){s(),r(n.DownloadState.UPDATE_DOWNLOADED)}function s(){e.removeEventListener("error",a),e.removeEventListener("controllerchange",i)}e.addEventListener("error",a),e.addEventListener("controllerchange",i),t.update().then((()=>{t.installing||r(n.DownloadState.UPDATE_NOT_AVAILABLE)})).catch((e=>{a(e),r(n.DownloadState.ERROR)}))})))).catch((e=>(__LOG__(3)`Unable to update serviceworker, error: ${e}`,n.DownloadState.ERROR))):Promise.resolve(n.DownloadState.ERROR)}restart(e){return e?this.update(void 0,!0,0):(l.default.hardRefresh(void 0,!1),Promise.resolve(n.DownloadState.UPDATE_DOWNLOADED))}}t.Updater=u;var c=new u;t.default=c},51538:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(71436);class i extends((0,a.customError)("InvalidVersion")){}class n{constructor(e){var t=e.split(".");if(3!==t.length)throw new i("Version format does not contain 3 numbers.");if(this.primary=Number.parseInt(t[0],10),this.secondary=Number.parseInt(t[1],10),this.tertiary=Number.parseInt(t[2],10),Number.isNaN(this.primary)||Number.isNaN(this.secondary)||Number.isNaN(this.tertiary))throw new i("Version contains a non-parseable string.")}lt(e){var t=e;return"string"==typeof t&&(t=new n(t)),this.primary<t.primary||this.primary===t.primary&&this.secondary<t.secondary||this.primary===t.primary&&this.secondary===t.secondary&&this.tertiary<t.tertiary}equals(e){var t=e;return!!t&&("string"==typeof t&&(t=new n(t)),this.primary===t.primary&&this.secondary===t.secondary&&this.tertiary===t.tertiary)}toString(){return`${this.primary}.${this.secondary}.${this.tertiary}`}}t.default=n},22006:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.URL_REGEX=void 0;var i,n=a(r(30733)),s=a(r(15253)),o=r(49244),l=r(84337),d=a(r(883)),u=r(48537),c=r(53353),p=a(r(2273)),h=r(61864),f=a(r(31244)),_=/^(https?:\/\/(?:www\.|(?!www))[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\.[^\s]{2,}|www\.[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\.[^\s]{2,}|https?:\/\/(?:www\.|(?!www))[a-zA-Z0-9]+\.[^\s]{2,}|www\.[a-zA-Z0-9]+\.[^\s]{2,})/;t.URL_REGEX=_;var m={build:function(e,t){var r=new f.default;return(0,s.default)(t||{},((e,t)=>{r.set(t,e)})),`${e}?${r.toString()}`},canMuckHistory:function(){return!!((0,c.isConnectedToPage)()&&window.history&&window.history.pushState&&self.location)},relToAbs:function(e){return i||(i=document.createElement("a")),i.href=e,i.href},hostname:(0,n.default)((function(e){return i||(i=document.createElement("a")),i.href=this.isHttp(e)?e:"http://"+e,i.hostname})),withoutWww:function(e){return e.split("www.").join("")},isHttp:function(e){return e&&("https://"===e.toLowerCase().substring(0,8)||"http://"===e.toLowerCase().substring(0,7))},isHttps:function(e){return e&&"https://"===e.toLowerCase().substring(0,8)},hasValidUrlScheme:function(e){var t=e.trim();return["irc://","ftp://","mailto:","http://","https://"].some((e=>0===t.toLowerCase().indexOf(e)))},isBlob:function(e){return(0,h.isString)(e)&&"blob:"===e.substring(0,5)},isData:function(e){return(0,h.isString)(e)&&"data:"===e.substring(0,5)},isEncryptedMedia:function(e){return e&&(0,h.isString)(e)&&e.endsWith(".enc")},parseDataURL:function(e){var t=e.indexOf(":"),r=e.indexOf(";"),a=e.indexOf(",");return{mimetype:e.substring(t+1,r),data:e.substring(a+1)}},dataURLtoFile:function(e){var t=this.parseDataURL(e).mimetype;return(0,u.createFile)([window.dataURLtoBlob(e)],"",{type:t})},GSM_NAME:"gme-whatsappinc",GSM_NUMS:"LM4NgcjF-X_EedaZ6MwPVSH0Sac=",gsmURL:function(e,t){var r=t.replace(/\-/g,"+").replace(/_/g,"/"),a=(0,l.decodeB64)(r),i=d.default.parse(e).path,n=o.Binary.build(i).readByteArray();return new p.default(a).sign(n).then((t=>`${e}&signature=${(0,l.encodeB64UrlSafe)(t)}`))},thumbToCSSURL:function(e){return`url("${this.isHttp(e)||e.startsWith("data:")?e:`data:image/jpeg;base64,${e}`}")`},thumbAsBackgroundImage:function(e){return e?{backgroundImage:this.thumbToCSSURL(e)}:{}},isValid:e=>_.test(e)};t.default=m},33974:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){if((0,a.isConnectedToPage)()){return r(96377).default.available}return!1};var a=r(53353)},65999:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.vcardGetDate=function(e){var t=e;return(0,o.default)([/-([^-]*)-([^-]*)-([^-]*)/,/([^-]*)-([^-]*)-([^-]*)/],(r=>{var a=e.match(r);if(a){var i=!a[1].length||"1604"===a[1],n=i?"0000":a[1];return t=(0,u.default)(`${n}-${a[2]}-${a[3]}`).format("l"),i&&(t=t.replace(/[.,-\/\s]*0000[.,-\/\s]*/,"")),!1}})),t},t.vcardGetOrganizationString=function(e){var t=e.ORG&&e.ORG[0],r=e.TITLE&&e.TITLE[0];if(t&&Array.isArray(t.value)&&t.value.length>0){var a=null;r&&r.value&&(a=`${r.value}`.trim());var[i,...n]=t.value;n.push(i);var s=n.map((e=>(0,h.isString)(e)?e.trim():"")).filter((e=>e.length)).join(c.default.t(577));return(a||"")+(a&&a.length&&s.length?" - ":"")+s}return""},t.vcardGetType=function(e){var t={jabber:c.default.t(1416),"skype-username":c.default.t(1421),skype:c.default.t(1421),msn:c.default.t(1418),aim:c.default.t(1406),yahoo:c.default.t(1424),icq:c.default.t(1414),"wa-biz-description":c.default.t(1408),[y]:c.default.t(1409)},r=e.properties["X-ABLabel"]||t[e.type.toLowerCase()];if(r)return function(e){if(!e)return;return e.replace(/^_\$!<([^>]*)>!\$_$/,"$1").replace(/\\,/,",").replace(/\\;/,";").replace(/\\\\/,"\\")}(r);var a={TEL:[[["cell"],c.default.t(1410)],[["iphone"],c.default.t(1415)],[["main"],c.default.t(1417)],[["home","fax"],c.default.t(1413)],[["work","fax"],c.default.t(1423)],[["home"],c.default.t(1412)],[["work"],c.default.t(1422)],[["pager"],c.default.t(1420)],[[],c.default.t(1412)]],EMAIL:[[["home"],c.default.t(1412)],[["work"],c.default.t(1422)],[["internet"],c.default.t(1411)]],URL:[[["home"],c.default.t(1412)],[["work"],c.default.t(1422)]],ADR:[[["home"],c.default.t(1412)],[["work"],c.default.t(1422)]]};return r=e.type,(0,d.default)(a,(t=>{if(t){var[a,i]=t;if(0===(0,s.default)(a,(0,n.default)(e.properties.type,(e=>e.toLowerCase()))).length)return r=i,!1}})),r},t.vcardWids=function(e){var t=[];e&&e.TEL&&e.TEL.forEach((e=>{e.properties&&e.properties.waid&&e.properties.waid.length>0&&(t=t.concat((0,n.default)(e.properties.waid,m.createUserWid)))}));return t},t.parseVcard=C,t.vcardSerialize=function(e){return e.map((function(e){return e.line.replace(/(.{75,75})/g,"$1\n ").replace(/\n^-$/gm,"")})).join("\n")},t.vcardThumbnail=function(e){if(!e)return;var{PHOTO:t}=e;if(t&&t[0]&&f.default.isData(t[0].value))return t[0].value},t.vcardGetName=P,t.vcardGetNameFromParsed=function(e){var t=null,{FN:r,NICKNAME:a,TEL:i}=e;if(r&&r[0])t=r[0].value;else if(a&&a[0])t=a[0].value;else if(i&&i[0]){var n,s=i[0],o=null===(n=s.properties.waid)||void 0===n?void 0:n[0];t=o?(0,_.default)(o):s.value}return t},t.vcardFromContactModel=function(e){var t,r=b(e.formattedName),a=["BEGIN:VCARD","VERSION:3.0",`N:${P(e)}`,`FN:${r}`,`TEL;type=CELL;waid=${String(e.userid)}:${(0,_.default)(e.userid)}`,e.isBusiness?`X-WA-BIZ-NAME:${r}`:null,(null===(t=e.businessProfile)||void 0===t?void 0:t.description)?`X-WA-BIZ-DESCRIPTION:${b(e.businessProfile.description)}`:null,"END:VCARD"].filter(Boolean);return{displayName:r,vcard:a.join("\n"),isMultiVcard:!1}},t.getNameString=O,t.getNameStringFromNames=w,t.mergeVcards=function(e){if(0===e.length)throw new Error("No vcards provided");return 1===e.length?e[0]:{displayName:O(e),vcard:e.map((e=>e.vcard)).join("\n"),isMultiVcard:!0}},t.parseMultiVcard=function(e){var t=e.match(/BEGIN:VCARD([\s\S]*?)END:VCARD/g);return t?t.map((e=>C(e))).filter(Boolean):[]},t.vcardIsBiz=function(e){return(e.SERVICE||[]).some((e=>e.type.toLowerCase()===y&&e.value))},t.Field=void 0;var i=a(r(90882)),n=a(r(16760)),s=a(r(17335)),o=a(r(59756)),l=a(r(829)),d=a(r(15253)),u=a(r(19034)),c=a(r(38637)),p=a(r(21830)),h=r(61864),f=a(r(22006)),_=a(r(58025)),m=r(25054),g=/X-([^;:]+)(?:;[^:]+)*:(.+)/,v={"X-ABLabel":[/X-ABLabel(?:;([^:]+))*:(.+)/,1],ADR:[/ADR(?:;([^:]+))*:;;(.*);(.*);(.*);(.*);(.*)/,5],"X-ABADR":[/X-ABADR(?:;([^:]+))*:(.*)/,1],URL:[/URL(?:;([^:]+))*:(.*)/,1],EMAIL:[/EMAIL(?:;([^:]+))*:(.+)/,1],TEL:[/TEL(?:;([^:]+))*:(.+)/,1]},E={N:[/N(?:;([^:]+))*:([^;]*);([^;]*);([^;]*);([^;]*);(.*)/,5],FN:[/FN(?:;([^:]+))*:(.*)/,1],NICKNAME:[/NICKNAME(?:;([^:]+))*:(.*)/,1],"X-PHONETIC-FIRST-NAME":[/X-PHONETIC-FIRST-NAME(?:;([^:]+))*:(.*)/,1],"X-PHONETIC-LAST-NAME":[/X-PHONETIC-LAST-NAME(?:;([^:]+))*:(.*)/,1],ORG:[/ORG(?:;([^:]+))*:([^;]*)(?:;(.*))*/,2],TITLE:[/TITLE(?:;([^:]+))*:(.*)/,1],TEL:[/TEL(?:;([^:]+))*:(.*)/,1],PHOTO:[/PHOTO(?:;([^:]+))*:(.*)/,1],BDAY:[/BDAY(?:;([^:]+))*:(.*)/,1],URL:[/URL(?:;([^:]+))*:(.+)/,1],EMAIL:[/EMAIL(?:;([^:]+))*:(.+)/,1]},y="wa-biz-name";class S{constructor(e,t,r,a){this.type=e,this.index=t,this.properties=r||{},this.value=a}}function T(e,t,r){e[t]||(e[t]=[]),e[t].push(r)}function A(e){var t={};return e?(e.split(";").forEach((e=>{var r=e.split(/=/);if(1===r.length){var a=r[0];T(t,a.toLowerCase(),!0)}else if(2===r.length){var[i,n]=r;T(t,i.toLowerCase(),n.toLowerCase())}})),t):t}function b(e){return e?e.replace(/\\/g,"\\\\").replace(/;/g,"\\;").replace(/,/g,"\\,"):""}function C(e){var t=e.replace(/\r?\n|\r/g,"\n").replace(/\n^[ \t]/gm,"").split("\n").filter((e=>0!==e.trim().length)),r={},a={};if(!(t.length<3)){var i=t[0].trim().toUpperCase(),n=t[1].trim().toUpperCase(),s=t[t.length-1].trim().toUpperCase(),o="VERSION:2.1"===n||"VERSION:3.0"===n||"VERSION:4.0"===n;if("BEGIN:VCARD"!==i||!o||"END:VCARD"!==s)return __LOG__(4,void 0,new Error,!0)`vcard:parse failed because the vCard is not formatted as expected:
Header as expected? ${String("BEGIN:VCARD"===i)}
Version as expected? ${String(o)}
Footer as expected? ${String("END:VCARD"===s)}
Lines: ${t.length}`,void SEND_LOGS("vcard-fault");for(var u=2;u<t.length-1;u++){var c=t[u],f=c.match(/item(\d+)\.(.*)/),_=f?f[2]:c,m=(0,p.default)(_.match(/([^:;]*)[:;].*/),"field.match(/([^:;]*)[:;].*/)")[1],y=f?v:E,b=m,C=m,P=void 0,O=void 0;if(y[b]){var[w,M]=y[b],I=_.match(w);I&&(P=A(I[1]),O=1===M?O=I[2]:I.slice(2,2+M))}else{var R=_.match(g);R&&(C="SERVICE",b=R[1],O=R[2],P={})}if((Array.isArray(O)?O:[O]).some((e=>e&&(0,h.isString)(e)&&e.trim())))if(f){var D=f[1];a[D]?a[D].fields.push(new S(b,null,P,O)):a[D]={type:b,index:u,key:C,properties:P,value:O,fields:[]}}else T(r,C,new S(b,u,P,O))}return Object.keys(a).forEach((e=>{var{key:t,index:i,type:n,value:s,properties:o,fields:l}=a[e];l.forEach((e=>{o[e.type]=e.value})),T(r,t,new S(n,i,o,s))})),function(e){var t={};return(0,d.default)(e,((e,r)=>{t[r]=(0,l.default)(e,(e=>e.index))})),t}(r)}}function P(e){var t=(0,i.default)(e.formattedName.split(e.formattedShortName)),r=t.length?t[0].trim():void 0,a=r?e.formattedShortName:e.formattedName;return`${b(r)};${b(a)};;;`}function O(e){return w(e.map((e=>e.displayName)))}function w(e){var t=e.find((e=>!!e));return e.length?t?1===e.length?t:c.default.t(992,{contactName:t,count:e.length-1,_plural:e.length-1}):c.default.t(994,{count:e.length,_plural:e.length}):c.default.t(993)}t.Field=S},61671:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,r,...a){if(!e)return Promise.resolve();if("string"==typeof t&&(t===o||t===l))return(0,s.default)(e,t,r,...a);u(e,(e=>{var t=d.get(e)||0;d.set(e,t+1)}));var i=t;if("object"==typeof r&&"object"==typeof i){var c;"function"==typeof r.begin&&(c=r.begin),r.begin=e=>{for(var t in i){var r=i[t];Array.isArray(r)&&(0,s.hook)(e,t,r[1])}c&&c(e)}}return(0,s.default)(e,t,r,...a).then((e=>(u(e,(e=>{var t=(d.get(e)||1)-1;0===t?(d.delete(e),function(e){var t=s.default.Utilities.data(e),{delayedElements:r}=s.default.State;(0,n.default)(r,((t,a)=>{"count"!==a&&(t!==e&&t||delete r[a])})),t&&t.velocity&&t.velocity.tweensContainer&&(t.velocity.tweensContainer.element=null);s.default.Utilities.removeData(e,["fxqueue","velocity"])}(e)):d.set(e,t)})),e)))};var n=i(r(15253)),s=a(r(86534)),o="finish",l="stop",d=new Map;function u(e,t){Array.isArray(e)?e.forEach((e=>{t(e)})):t(e)}},82838:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(r(70417)),s=i(r(22220)),o=i(r(17620)),l=i(r(45455)),d=a(r(2784)),u=r(9448),c=i(r(13277)),p=a(r(24461)),h=r(72100),f=r(31046),_=i(r(23682)),m=r(61864),g=i(r(61671)),v="enter",E="leave",y="appear";class S extends d.Component{constructor(...e){super(...e),this._isUnmounted=!1,this.setBusy=()=>{this.busyId=f.UIBusyTasks.setBusy(this.busyId),this.isBusy||(this.isBusy=!0,c.default.setUiBusy(!0,"vtg"))},this.unsetBusy=()=>{null!=this.busyId&&(f.UIBusyTasks.clearBusy(this.busyId),delete this.busyId),this.isBusy&&(this.uiBusy=!1,c.default.setUiBusy(!1,"vtg"))},this.componentWillAppear=e=>{this.animateIfEnabled(y,e)},this.componentWillEnter=e=>{this.animateIfEnabled(v,e)},this.componentWillLeave=e=>{this.animateIfEnabled(E,e)}}_getTransition(){var{transitionName:e}=this.props;if(e&&!_.default[e])throw __LOG__(4,void 0,new Error,!0)` ${e} wasn't found in VelocityTransitionGroupChild transitions.`,SEND_LOGS("transition-name"),new Error("Invalid transitionName");return e?_.default[e]:_.default.default}animateIfEnabled(e,t){var r=!1;switch(e){case v:r=this.props.transitionEnter;break;case E:r=this.props.transitionLeave;break;case y:r=this.props.transitionAppear}r?(this.setBusy(),this.animateTransitions(e).finally((()=>{this.unsetBusy()})).checkpoint(this.rejectOnUnmount()).then((()=>{(0,m.isFunction)(t)&&t()})).catchType(p.Unmount,(()=>{}))):t()}getTransitionNodes(e,t){var r=t;Array.isArray(r)||(r=[r]);var a={};return r.map((t=>{var r,{selector:i}=t,o=(0,s.default)(t,["selector"]);return r=i?i in a?a[i]:a[i]=e?Array.from(e.querySelectorAll(i)):void 0:e,(0,l.default)(r)?void 0:(0,n.default)({nodes:r},o)})).filter(Boolean)}blockAction(e){e.preventDefault(),e.stopPropagation()}animateTransitions(e){var t=e,{delay:r=0,children:a,onAnimationComplete:i}=this.props,{staggerDelay:n}=d.Children.only(a);t===y&&(t=v);var s=this._getTransition(),l=s[t];if(!s||!l)return Promise.resolve();var u=(0,o.default)(s,E,v),c=(0,h.forbiddenFindDOMNode)(this,window.Node),p=this.getTransitionNodes(c,l);return t===E&&c&&c.setAttribute&&c.addEventListener&&(c.setAttribute("pointerEvents","none",c),c.addEventListener("keypress",this.blockAction,!0),c.addEventListener("keydown",this.blockAction,!0)),Promise.all(p.map((e=>{var{nodes:t,props:a,easing:i,duration:s,delay:o,stagger:l,drag:d}=e;return(0,g.default)(t,a,{easing:i||u.easing||"easeInSine",duration:s||u.duration||0,delay:n||r||o||u.delay||0,queue:u.queue||!1,stagger:l||!1,drag:d||!1})}))).finally((()=>{u.cleanOnComplete&&t===v&&p.forEach((e=>{var t=e.nodes;(Array.isArray(t)?t:[t]).forEach((e=>e.removeAttribute("style")))})),t===E&&c&&c.removeEventListener&&(c.removeEventListener("keypress",this.blockAction,!0),c.removeEventListener("keydown",this.blockAction,!0)),i&&i()}))}componentWillUnmount(){this._isUnmounted=!0,this._rejectPromise&&this._rejector(new p.Unmount);var e=(0,h.forbiddenFindDOMNode)(this,window.Node);(0,g.default)(e,"finish")}rejectOnUnmount(){return this._rejectPromise||(this._rejectPromise=new Promise(((e,t)=>{this._rejector=t})),this._rejectPromise.catch((()=>{})),this._isUnmounted&&this._rejector(new p.Unmount)),this._rejectPromise}render(){return d.Children.only(this.props.children)}}S.defaultProps={transitionAppear:!1,transitionEnter:!0,transitionLeave:!0},S.displayName="VelocityTransitionGroupChild";class T extends d.Component{constructor(...e){super(...e),this._wrapChild=e=>d.createElement(S,this.props,e)}render(){return d.createElement(u.TransitionGroup,{childFactory:this._wrapChild,className:this.props.className,transitionName:this.props.transitionName,component:this.props.component,children:this.props.children})}}t.default=T,T.defaultProps={transitionAppear:!1,transitionEnter:!0,transitionLeave:!0},T.displayName="VelocityTransitionGroup"},84478:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.waitForOnlineNaive=function(){return(0,n.default)(self,"online").then((()=>(0,i.delayMs)(100)))};var i=r(60266),n=a(r(53271))},33723:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.getWallpaperColors=p,t.toggleWallpaperColor=function(e,t){var r=p(t);if(e===i.default.DEFAULT_CHAT_WALLPAPER)return i.default.DEFAULT_CHAT_WALLPAPER;if(n.default.wallpapersV2){var a=r.findIndex((t=>t.toUpperCase()===e.toUpperCase()));if(-1!==a)return"light"===t?c[a]:u[a]}return e},t.colorExistsInTheme=function(e,t){var r=p(t);return e===i.default.DEFAULT_CHAT_WALLPAPER||r.some((t=>t.toUpperCase()===e.toUpperCase()))},t.getWallpaperColorPropValue=h,t.getDoodleOpacity=function(e,t){if(n.default.wallpapersV2){var r=h(e,t,"opacity");if(r)return r}return"0.06"},t.getDoodleAssetName=function(e,t){if(n.default.wallpapersV2&&"light"===t&&e!==i.default.DEFAULT_CHAT_WALLPAPER){var r=h(e,t,"doodle");if(r)return`data-asset-chat-background-${r}`}return`data-asset-chat-background-${t}`},t.invertTransparentWallpaperColors=function(e,t){if(n.default.wallpapersV2)return"light"===e&&t!==i.default.DEFAULT_CHAT_WALLPAPER&&!!h(t,e,"invertTransparentWallpaperColors");var r=o.includes(t);return!!p(e).includes(t)&&(r?"light"===e:"dark"===e)};var i=a(r(23045)),n=a(r(54559)),s=["#ccebdc","#aed8c7","#7acba5","#c7e9eb","#a9dbd8","#68d5d9","#6ec3d4","#f2dad5","#f2d5e1","#fbcad2","#ffa7a8","#cbdaec","#d7d3eb","#e5c0eb","#d0deb1","#dee0b4","#e6dfa8","#f7e9a8","#ffd1a4","#ff8a8c","#ff5978","#f56056","#dc6e4f","#e6e365","#73c780","#2293a4","#219ed9","#2b5aa6","#74676a","#48324d","#dee3e9","#d9dade","#c0c1c4","#7e90a3","#55626f","#243640","#162127"],o=["#ff8a8c","#ff5978","#f56056","#dc6e4f","#73c780","#2293a4","#219ed9","#2b5aa6","#74676a","#48324d","#7e90a3","#55626f","#243640","#162127"],l={"#BBE4E5":{doodle:"dark",opacity:"0.42"},"#AED8C7":{doodle:"dark",opacity:"0.3"},"#7ACBA5":{doodle:"dark",opacity:"0.26"},"#CBDAEC":{doodle:"dark",opacity:"0.42"},"#66D2D5":{doodle:"dark",opacity:"0.26"},"#63BDCF":{doodle:"dark",opacity:"0.26"},"#D6D0F0":{doodle:"dark",opacity:"0.36"},"#CECECE":{doodle:"dark",opacity:"0.36"},"#D1DABE":{doodle:"dark",opacity:"0.36"},"#E6E1B1":{doodle:"dark",opacity:"0.42"},"#FEEFA9":{doodle:"light",opacity:"0.06"},"#FED297":{doodle:"dark",opacity:"0.42"},"#FD9A9B":{doodle:"dark",opacity:"0.26"},"#FD6769":{doodle:"dark",opacity:"0.26"},"#FB4668":{doodle:"dark",opacity:"0.26"},"#922040":{doodle:"dark",opacity:"0.17",invertTransparentWallpaperColors:!0},"#DC6E4F":{doodle:"dark",opacity:"0.2"},"#644D52":{doodle:"dark",opacity:"0.13",invertTransparentWallpaperColors:!0},"#517E7E":{doodle:"dark",opacity:"0.13"},"#3190BB":{doodle:"dark",opacity:"0.13"},"#35558A":{doodle:"dark",opacity:"0.1",invertTransparentWallpaperColors:!0},"#55626F":{doodle:"dark",opacity:"0.1",invertTransparentWallpaperColors:!0},"#1D2326":{doodle:"dark",opacity:"0.1",invertTransparentWallpaperColors:!0},"#301E34":{doodle:"dark",opacity:"0.1",invertTransparentWallpaperColors:!0},"#ECF0F1":{doodle:"light",opacity:"0.06"},"#FFFEA2":{doodle:"light",opacity:"0.06"},"#E7E8D2":{doodle:"light",opacity:"0.06"}},d={"#0F2424":{doodle:"dark",opacity:"0.05"},"#12261F":{doodle:"dark",opacity:"0.055"},"#11241C":{doodle:"dark",opacity:"0.055"},"#111E27":{doodle:"dark",opacity:"0.06"},"#0F2224":{doodle:"dark",opacity:"0.06"},"#0E2125":{doodle:"dark",opacity:"0.055"},"#1F1D25":{doodle:"dark",opacity:"0.06"},"#212121":{doodle:"dark",opacity:"0.055"},"#1F211C":{doodle:"dark",opacity:"0.055"},"#23231B":{doodle:"dark",opacity:"0.055"},"#262419":{doodle:"dark",opacity:"0.055"},"#261F17":{doodle:"dark",opacity:"0.055"},"#261717":{doodle:"dark",opacity:"0.055"},"#260F10":{doodle:"dark",opacity:"0.06"},"#260A10":{doodle:"dark",opacity:"0.07"},"#19050B":{doodle:"dark",opacity:"0.075"},"#21100C":{doodle:"dark",opacity:"0.07"},"#0F0C0C":{doodle:"dark",opacity:"0.065"},"#101919":{doodle:"dark",opacity:"0.06"},"#0A1D25":{doodle:"dark",opacity:"0.055"},"#0D1523":{doodle:"dark",opacity:"0.065"},"#0D0F11":{doodle:"dark",opacity:"0.07"},"#0A0C0D":{doodle:"dark",opacity:"0.07"},"#110B12":{doodle:"dark",opacity:"0.07"},"#1E1F1F":{doodle:"dark",opacity:"0.055"},"#262618":{doodle:"dark",opacity:"0.055"},"#23231F":{doodle:"dark",opacity:"0.055"}},u=Object.keys(l),c=Object.keys(d);function p(e){return n.default.wallpapersV2?"light"===e?u:c:s}function h(e,t,r){var a="light"===t?l:d;for(var i in a)if(i.toUpperCase()===e.toUpperCase())return a[i][r];return null}},32725:(e,t,r)=>{"use strict";var a=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.fibonacci=function(e,t,r){if("number"==typeof r){var a=r;return function(r){switch(r.failGeneration){case 0:return Math.min(a,t);case 1:return Math.min(a,e+t);default:return Math.min(a,r.waitDuration+r.prevWaitDuration)}}}return function(r){switch(r.failGeneration){case 0:return t;case 1:return e+t;default:return r.waitDuration+r.prevWaitDuration}}},t.default=void 0;var i=r(35160),n=a(r(99778)),s=a(r(2537));class o extends n.default{constructor(...e){super(...e),this.failGeneration=(0,n.session)(0),this.ts=(0,n.session)(),this.waitDuration=(0,n.session)(0),this.prevWaitDuration=(0,n.session)(0),this.jitter=(0,n.session)(0),this.shiftTimer=(0,n.session)(),this.waitAlgorithm=(0,n.session)(),this.onActivated=(0,n.session)(),this.onDeactivated=(0,n.session)(),this.onFed=(0,n.session)(),this.onTimeout=(0,n.session)()}initialize(){this.shiftTimer=new i.ShiftTimer((()=>d.call(this)))}activate(){this.shiftTimer.isScheduled()||(this._run(!0),this.onActivated&&this.onActivated(this))}deactivate(){this.shiftTimer.isScheduled()&&(this.shiftTimer.cancel(),this.onDeactivated&&this.onDeactivated(this))}feed(){this.shiftTimer.isScheduled()&&(this._run(!0),this.onFed&&this.onFed(this))}forceTimeout(e){this.shiftTimer.isScheduled()?null!=e&&0!==e?(this.shiftTimer.onOrBefore(e),this.ts=this.shiftTimer.ts):this.shiftTimer.forceRunNow():__LOG__(3)`forced non-running watchdog!`}poke(){this.forceTimeout.apply(this,arguments)}resetGeneration(){this.failGeneration=0}_run(e){e&&this.resetGeneration();var t=this.waitAlgorithm(this),r=this.jitter*Math.random()*t;this.shiftTimer.debounce(t+r),this.set({ts:this.shiftTimer.ts,waitDuration:t,prevWaitDuration:this.waitDuration})}}var l=(0,n.defineModel)(o);function d(){var e=this.onTimeout;if(!e)return __LOG__(3)`Watchdog timed-out without handler!`,void s.upload({reason:"watchdog-no-handler"});this.failGeneration++,e(this)&&this._run(!1)}t.default=l},49809:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.open=function(e){var t,r;try{t=new T(e)}catch(e){return __LOG__(3)`WatchedSocket error constructing: ${e}`,_.default.reject(e)}return new _.default(t,(function(e,t){this.id=(T.numSocketsAttempted++).toString(),__LOG__(2)`WatchedSocket opening socket ${this.id}`,r=new c.default.WebcWsOpen;var a=(0,p.openSocket)(this.url);a.binaryType="arraybuffer",a.onopen=e,a.onclose=a.onerror=function(e){t(new d.SocketError(e))},this.socket=a})).cancellable().catch((function(e){if(__LOG__(2)`WatchedSocket error on open of ${this.id}: ${e}`,this.socket){var t=this.socket;switch(t.readyState){case WebSocket.CONNECTING:t.onopen=null;case WebSocket.OPEN:t.onerror=null,t.onclose=null,t.close();break;case WebSocket.CLOSING:case WebSocket.CLOSED:t.onerror=null,t.onclose=null}}throw e})).then((function(){__LOG__(2)`WatchedSocket opened socket ${this.id}`,r.markWebcWsOpenT(),r.commit();var e=this.socket;return e.onmessage=this._onMessage.bind(this),e.onerror=this._onCloseOrError.bind(this,!0),e.onclose=this._onCloseOrError.bind(this,!1),this._offlineListener=(0,g.default)().then(this.close.bind(this,!1,"offline")).catchType(Promise.CancellationError,(()=>{})),this._pingTimer.onOrAfter(b()),this.state=y.OPEN,this}))},t.default=t.STATE=void 0;var n=i(r(67304)),s=r(35160),o=a(r(99778)),l=a(r(2537)),d=a(r(24461)),u=a(r(34535)),c=i(r(84161)),p=r(48846),h=i(r(74491)),f=i(r(64301)),_=i(r(24307)),m=i(r(11018)),g=i(r(17279)),v=18e4;function E(e,t){var r=-1,a=e.find((e=>(r++,t(e))));return void 0===a?void 0:{index:r,value:a}}var y={OPEN:"OPEN",CLOSED:"CLOSED"};t.STATE=y;class S extends o.default{constructor(...e){super(...e),this.id=(0,o.session)(),this.url=(0,o.session)(),this.onmessage=(0,o.session)(),this.onactivity=(0,o.session)(),this.timeSkew=(0,o.session)(),this.msgParser=(0,o.session)(),this.state=(0,o.session)(),this.error=(0,o.session)(),this.socket=(0,o.session)(),this.isQueueing=(0,o.session)(!0),this.maxQueueSize=(0,o.session)(),this.messageQueue=(0,o.session)(),this._offlineListener=(0,o.session)(),this._msgListeners=(0,o.session)(),this._pingTimer=(0,o.session)(),this._killTimer=(0,o.session)()}initialize(){this._msgListeners=[],this.messageQueue=[],this.safariSplitter=m.default.isSafari?new h.default(this):null,this._pingTimer=new s.ShiftTimer((()=>this._ping())),this._killTimer=new s.ShiftTimer((()=>this._killSocket())),u.default.on(u.JS_HALT_EVENT,this._onJsHalt,this)}_onJsHalt(e){e>v&&(__LOG__(2)`js halt longer than ${v} ms detected, killing socket`,this._killTimer.cancel(),this._killTimer.onOrBefore(0))}_ping(){this.send("?,,"),this._killTimer.onOrAfter(C())}_killSocket(){__LOG__(3)`WatchedSocket ${this.id} Timeout!`,this.close(!0,"stale")}detachCallbacks(){this.set({onactivity:void 0,onmessage:void 0})}send(e){this.cast(e),this._pingTimer.cancel(),this._killTimer.onOrAfter(C())}cast(e){if(this.state!==y.OPEN)throw new d.SocketNotOpen(this.state);if("string"==typeof e&&/\[object ArrayBuffer\]/.test(e))throw new TypeError("converted ArrayBuffer to string prematurely");if(this.safariSplitter)this.safariSplitter.send(e);else try{this.socket.send(e)}catch(e){__LOG__(3)`exception sending: ${e}\n${e.stack}`,l.upload({reason:"send-exception"}),this.close(!0,e)}}partingSend(e,t,r){var a=this,i=this.socket;return new Promise((function(n){function s(){n(void 0)}i.onclose=s,i.onerror=s,i.onmessage=function(e){var t=e.data;r&&!r(t)||n(t)},a.send(t),a._onCloseOrError(!1,e)})).timeout(2e4,"paringSendTimeout").catch((()=>{})).finally((function(){i.onclose=void 0,i.onerror=void 0,i.onmessage=void 0,i.readyState===WebSocket.OPEN&&i.close()}))}close(e,t){var r,a=this.socket;if(this._onCloseOrError(e,t||"unspecified"),a&&((r=a.readyState)===WebSocket.CONNECTING||r===WebSocket.OPEN))try{a.close()}catch(e){__LOG__(3)`WatchedSocket:exception closing: ${e}\n${e.stack}`}}_onMessage(e){this._pingTimer.onOrAfter(b()),this._killTimer.cancel();var t=e.data;if("string"==typeof t&&"!"===t.charAt(0)){var r=parseInt(t.slice(1),10);return r==r&&(this.timeSkew=Date.now()-r),void(this.onactivity&&this.onactivity())}var a=this.msgParser(e);this.onactivity&&this.onactivity(a),this._onParsedMsg(a)}_onParsedMsg(e){var t=E(this._msgListeners,(function(t){return!t.filter||t.filter(e)}));t?(this._msgListeners.splice(t.index,1),t.value.removed=!0,t.value.promise.force(e)):this.isQueueing?(__LOG__(3)`watchedSocket:enqueued`,this.messageQueue.push(e),void 0!==this.maxQueueSize&&this.messageQueue.length>this.maxQueueSize&&this.close(!0,"Queue Overflow")):this.onmessage?this.onmessage(e):__LOG__(3)`watchedSocket:dropped!`}_onCloseOrError(e,t){if(this.state!==y.CLOSED){this.safariSplitter&&this.safariSplitter.cancel(),this.socket&&(this.socket.onclose=void 0,this.socket.onerror=void 0,this.socket.onmessage=void 0),this._offlineListener&&this._offlineListener.cancel(),__LOG__(3)`Socket ${this.id} closing: ${t.toString()}`,u.default.off(u.JS_HALT_EVENT,this._onJsHalt,this),this._pingTimer.cancel(),this._killTimer.cancel(),this.set({state:y.CLOSED,error:e?t:void 0});var r=this._msgListeners,a=e?new d.SocketError(t):new d.SocketClosed(t);this._msgListeners=[],r.forEach((function(e){e.removed=!0,e.promise.cancel(a)}))}}holdMessages(e){var t=this.isQueueing&&void 0!==e&&this.messageQueue>e;this.set({isQueueing:!0,messageQueue:this.messageQueue||[],maxQueueSize:e}),t&&this.close(!0,"Queue Overflow")}releaseMessages(e){if(this.isQueueing){var t=this.messageQueue;this.set({isQueueing:!1,messageQueue:[]}),e?t.length>0&&__LOG__(3)`WatchedSocket:releaseMessages dropping ${t.length} messages.`:t.forEach((e=>{this._onParsedMsg(e)}))}else __LOG__(3)`WatchedSocket:releaseMessages not queued!`}nextMessage(e){if(this.state!==y.OPEN)return _.default.reject(new d.SocketNotOpen(this.state)).cancellable();var t;if(t=e instanceof f.default?e.test.bind(e):e,this.isQueueing){var r;if(t){var a=E(this.messageQueue,t);a&&(r=a.value,this.messageQueue.splice(a.index,1))}else this.messageQueue.length>0&&(r=this.messageQueue.shift());if(r)return _.default.resolve(r).cancellable()}var i=(new _.default).cancellable().forceable(),s={removed:!1,filter:t,promise:i};return this._msgListeners.push(s),i.catch((()=>{s.removed||(this._msgListeners=(0,n.default)(this._msgListeners,s))})),i}}var T=(0,o.defineModel)(S);T.numSocketsAttempted=0;var A=T;function b(){return 2e4*Math.random()+1e4}function C(){return 7e4*Math.random()+2e4}t.default=A},64334:(e,t,r)=>{"use strict";var a=r(14859),i=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.open=function(e){var t;try{t=new f(e)}catch(e){return __LOG__(3)`WatchedSocketMD error constructing: ${e}`,u.default.reject(e)}return new u.default(t,(function(e,t){f.numSocketsAttempted++,this.id=f.numSocketsAttempted,__LOG__(2)`WatchedSocketMD opening socket ${this.id}`;var r=(0,d.openSocket)(this.url);r.binaryType="arraybuffer",r.onopen=e,r.onclose=r.onerror=function(e){t(new o.SocketError(e))},this.socket=r})).cancellable().catch((function(e){if(__LOG__(2)`WatchedSocketMD error on open of ${this.id}: ${e}`,this.socket){var t=this.socket;switch(t.readyState){case WebSocket.CONNECTING:t.onopen=null;case WebSocket.OPEN:t.onerror=null,t.onclose=null,t.close();break;case WebSocket.CLOSING:case WebSocket.CLOSED:t.onerror=null,t.onclose=null}}throw e})).then((function(){__LOG__(2)`WatchedSocketMD opened socket ${this.id}`;var e=this.socket;return e.onmessage=this._onMessage.bind(this),e.onerror=this._onCloseOrError.bind(this,!0),e.onclose=this._onCloseOrError.bind(this,!1),this._offlineListener=(0,c.default)().then(this.close.bind(this,!1,"offline")).catchType(Promise.CancellationError,(()=>{})),this.state=h.OPEN,this}))},t.default=t.STATE=void 0;var n=r(49244),s=r(35160),o=i(r(24461)),l=i(r(34535)),d=r(48846),u=a(r(24307)),c=a(r(17279)),p=18e4,h={OPEN:"OPEN",CLOSED:"CLOSED"};t.STATE=h;class f{constructor(e){this.onError=null,this.dataToSend=new n.Binary,this.url=e,this._killTimer=new s.ShiftTimer((()=>this._killSocket())),l.default.on(l.JS_HALT_EVENT,this._onJsHalt,this)}_onJsHalt(e){e>p&&(__LOG__(2)`js halt longer than ${p} ms detected, killing socket`,this._killTimer.cancel(),this._killTimer.onOrBefore(0))}_killSocket(){__LOG__(3)`WatchedSocketMD ${this.id} Timeout!`,this.close(!0,"stale")}detachCallbacks(){this.socket.onmessage=_}close(e=!1,t){var r,a=this.socket;if(this._onCloseOrError(e,t||"unspecified"),a&&((r=a.readyState)===WebSocket.CONNECTING||r===WebSocket.OPEN))try{a.close()}catch(e){__LOG__(3)`WatchedSocketMD:exception closing: ${e}\n${e.stack}`}}requestSend(){if(this.state!==h.OPEN)throw new o.SocketNotOpen(this.state);if(this.dataToSend.size())try{this.socket.send(this.dataToSend.readByteArray())}catch(e){__LOG__(3)`exception sending: ${e}\n${e.stack}`,this.close(!0,e)}}_onMessage(e){if(!(e.data instanceof ArrayBuffer))throw new TypeError("expected ArrayBuffer from the socket");this.onData&&(0,this.onData)(new Uint8Array(e.data))}_onCloseOrError(e,t){this.state!==h.CLOSED&&(this.socket&&(this.socket.onclose=_,this.socket.onerror=_,this.socket.onmessage=_),this._offlineListener&&this._offlineListener.cancel(),__LOG__(3)`Socket ${this.id} closing: ${t.toString()}`,l.default.off(l.JS_HALT_EVENT,this._onJsHalt,this),this._killTimer.cancel(),this.state=h.CLOSED,this.error=e?t:void 0,null!=this.onClose&&this.onClose())}}function _(){}t.default=f,f.numSocketsAttempted=0},10258:(e,t,r)=>{"use strict";var a=r(93291),i=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return new Promise(((t,r)=>{var a=new n.default;a.onerror=function(e){a.terminate(),r(new s.DecodeWebpResultsError("worker error",e))},a.onmessageerror=function(e){a.terminate(),r(new s.DecodeWebpResultsError("worker message error",e))},a.onmessage=e=>{a.terminate();var r=e.data;t(r)},a.postMessage({webpBuffer:e},[e])}))};var n=i(r(11888)),s=a(r(24461))},57436:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.getTotalAnimationDuration=s,t.default=function(e){var t=new Uint8Array(e);if(!p(t))return __LOG__(2)`Sticker file not extended format.`,u;if(!h(t))return(0,i.default)((0,i.default)({},u),{},{emojis:c(t)});var r,a=0,l=44;for(;(0,n.default)(t.slice(l,l+4),d);){var f=l+20,_=t.slice(f,f+3);if(3!==_.length)return u;a+=o(_);var m=l+4,g=t.slice(m,m+4);if(4!==g.length)return u;l+=8+o(g),null==r&&(r=l)}var v=s(a),E=c(t);return{animationDuration:v,firstFrameLength:r,singleLoopDuration:a,emojis:E}},t.getCorrespondingEmojis=c,t.isExtendedFile=p,t.isAnimatedWebp=h,t.MAX_DURATION=t.MAX_LOOPS=void 0;var i=a(r(70417)),n=a(r(12150));t.MAX_LOOPS=3;function s(e){if(0===e)return 0;var t=Math.min(Math.floor(5e3/e),3);return Math.max(t,1)*e}function o(e){return e.reduce(((e,t,r)=>e+(t<<8*r)),0)}t.MAX_DURATION=5e3;var l=new Uint8Array([86,80,56,88]),d=new Uint8Array([65,78,77,70]),u={animationDuration:0,singleLoopDuration:0,emojis:[]};function c(e){if(null==TextDecoder)return[];var t=String.fromCharCode(0),r=new TextDecoder,a=0;for(a+=12;a<e.byteLength;){var i=r.decode(e.slice(a,a+4)),n=o(e.slice(a+4,a+4+4));if(n%2!=0&&(n+=1),"EXIF"===i||"XMP"===i){for(var s=e.slice(a,e.byteLength),l=r.decode(s),d=void 0,u=void 0,c=l.length;c>0;--c)if(null==u&&"}"===l[c])u=c;else if(null!=u&&l[c]===t){d=c+1;break}if(null==d||null==u)return __LOG__(3)`JSON not found in sticker file`,[];var p=l.substring(d,u+1);try{var h=JSON.parse(p);return Array.isArray(h.emojis)?h.emojis:[]}catch(e){return __LOG__(2)`Failed to parse emojis out of sticker, returning array.`,[]}}a+=8+n}return[]}function p(e){var t=e.slice(12,16);return(0,n.default)(t,l)}function h(e){var t=new Uint8Array(e);return p(t)&&0!=(2&t[20])}},43926:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(23045)),n=r(61864),s=/(?:^([^.:@]+))(?:\.([0-9]{1,2}))?(?:\:([0-9]{1,2}))?@(s\.whatsapp\.net|c\.us|g\.us|broadcast|call|b\.whatsapp\.net)$/i,o=["name","short","notify"];class l{constructor(e,t){if(!(t&&t.intentionallyUsePrivateConstructor))throw new Error("You should use WidFactory.createWid() instead of the Wid constructor. If you absolutely must use the constructor, pass {intentionallyUsePrivateConstructor: true} as a second parameter.");var r=e.match(s);if(!r)throw new Error(`wid error: invalid wid: ${e}`);var a,i=[],n=r[1],o=r[2],l=r[3],d=r[4].toLowerCase();switch(d){case"s.whatsapp.net":a="c.us";break;default:a=d}if(this.server=a,this.user=n,i.push(this.user),o){if("c.us"!==this.server)throw new Error(`wid error: wrong server for wid with agent present: ${e}`);var u=parseInt(o,10);if(isNaN(u))throw new Error(`wid error: NaN agent: ${o} wid: ${e}`);if(u>255)throw new Error(`wid error: agent>255 : ${u} wid: ${e}`);u&&(i.push("."),i.push(u),this.agent=u)}if(l){if("c.us"!==this.server)throw new Error(`wid error: wrong server for wid with device present: ${e}`);var c=parseInt(l,10);if(isNaN(c))throw new Error(`wid error: NaN device: ${l} wid: ${e}`);if(c>255)throw new Error(`wid error: device>255 : ${c} wid: ${e}`);c&&(i.push(":"),i.push(c),this.device=c)}i.push("@"),i.push(this.server),this._serialized=i.join("")}toString(e){if(e){var t,r,a=e.legacy&&"c.us"===this.server?"@s.whatsapp.net":this.server;if(e.formatFull?(t=`.${this.agent||0}`,r=`:${this.device||0}`):(t=null!=this.agent&&0!==this.agent?`.${this.agent}`:"",r=null!=this.device&&0!==this.device?`:${this.device}`:""),e.formatFull||e.legacy&&"c.us"===this.server)return[this.user,t,r,a].join("")}return this._serialized}toJid(){return this.toString({legacy:!0})}getSignalAddress(){var e=null!=this.agent&&0!==this.agent?`_${this.agent}`:"",t=null!=this.device&&0!==this.device?`:${this.device}`:"";return[this.user,e,t].join("")}getDeviceId(){var e=this.device;return null==e?0:e}equals(e){return e instanceof l&&this.toString()===e.toString()}isLessThan(e){return e instanceof l&&this.toString()<e.toString()}isGreaterThan(e){return e instanceof l&&this.toString()>e.toString()}isCompanion(){return null!=this.device&&this.device!==i.default.DEVICE.PRIMARY_DEVICE}isUser(){return"c.us"===this.server}isBroadcast(){return"broadcast"===this.server}isOfficialBizAccount(){return this.toString()===i.default.OFFICIAL_BIZ_WID}isGroup(){return"g.us"===this.server}isGroupCall(){return"call"===this.server}isServer(){return"server"===this.user&&"c.us"===this.server}isPSA(){return"0"===this.user&&"c.us"===this.server}isStatusV3(){return"status"===this.user&&"broadcast"===this.server}toJSON(){return this.toString()}static isXWid(e,t){return(0,n.isString)(t)?t.split("@")[1]===e:t instanceof l?t.server===e:(void 0!==t&&__LOG__(2)`wid:isXWid called on nonstring: + ${String(t)}`,!1)}static isUser(e){return l.isXWid("c.us",e)}static isBroadcast(e){return l.isXWid("broadcast",e)}static isGroup(e){return l.isXWid("g.us",e)}static isGroupCall(e){return l.isXWid("call",e)}static isWid(e){return(0,n.isString)(e)?s.test(e):e instanceof l}static canBeWid(e){return!e||!o.includes(e)}static isServer(e){return(0,n.isString)(e)?e.toLowerCase()===i.default.SERVER_WID:e instanceof l&&e.isServer()}static isPSA(e){return(0,n.isString)(e)?e.toLowerCase()===i.default.PSA_WID:e instanceof l&&e.isPSA()}static isStatusV3(e){return(0,n.isString)(e)?e.toLowerCase()===i.default.STATUS_WID:e instanceof l&&e.isStatusV3()}static isOfficialBizAccount(e){return(0,n.isString)(e)?e.toLowerCase()===i.default.OFFICIAL_BIZ_WID:e instanceof l&&e.isOfficialBizAccount()}static user(e){return(0,n.isString)(e)?e.split("@")[0]:e instanceof l?e.user:void 0}static equals(e,t){return e instanceof l||t instanceof l?e instanceof l&&e.equals(t):e===t}static isLessThan(e,t){return e instanceof l&&t instanceof l&&e.toString()<t.toString()}static isGreaterThan(e,t){return e instanceof l&&t instanceof l&&e.toString()>t.toString()}}t.default=l},58025:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){if(e){var t;if(e instanceof l.default?t=e.user:(0,o.isString)(e)&&(t=e.split("@")[0]),t){var r=t;return s.default.isRTL()?s.default.isolateLTR(d(r)):d(r)}}return""};var i=a(r(30733)),n=r(20595),s=a(r(38637)),o=r(61864),l=a(r(43926)),d=(0,i.default)((e=>"Server"===e?e:(0,n.formatPhone)(e)))},25054:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.createWid=o,t.createWidFromWidLike=function(e){return o("string"==typeof e?e:e._serialized)},t.isWidlike=function(e){return!!e&&(!!n.default.isWid(e)||!(!e||"object"!=typeof e||!n.default.isWid(e._serialized)))},t.createDeviceWidFromUserAndDevice=function(e,t){return l(`${e}:${t}@c.us`)},t.createDeviceWid=l,t.createUserWid=d,t.toUserWid=u,t.toChatWid=function(e){if(e.isUser())return u(e);return e},t.userJidToUserWid=function(e){return u(o(e))};var i=r(61864),n=a(r(43926)),s=a(r(90608));function o(e){var t;return s.default&&s.default.cache?(t=s.default.cache[e])||(t=new n.default(e,{intentionallyUsePrivateConstructor:!0}),s.default.cache[e]=t):t=new n.default(e,{intentionallyUsePrivateConstructor:!0}),t}function l(e){return o(e)}function d(e,t){var r;if(!(null!=(r=o(r=(0,i.isString)(e)&&(e.endsWith("@c.us")||e.endsWith("@s.whatsapp.net"))?e:`${e}@${t||"c.us"}`)).device&&0!==r.device||null!=r.agent&&0!==r.agent))return r;throw new Error("createUserWid is called with invalid user string")}function u(e){if(!e.isUser())throw new Error("asUserWid: wid is not a user wid");return null!=e.device&&0!==e.device||null!=e.agent&&0!==e.agent?d(e.user):e}},1876:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r(22006)),n={GET:"GET",POST:"POST",HEAD:"HEAD",PUT:"PUT"};function s(e,t){for(var r in t)e.setRequestHeader(r,t[r])}function o(e,t,r,a,o,l){var d=new XMLHttpRequest,u=new Promise(((u,c)=>{if(d.onload=function(e){4===d.readyState?u(d):c(e)},d.onerror=c,d.ontimeout=c,o&&(d.onprogress=o),d.onabort=c,r instanceof FormData)d.open(t||n.POST,e,!0),a&&(d.responseType=a),l&&s(d,l),d.send(r);else if(r instanceof Object){var p=i.default.build(e,r);d.open(t||n.GET,p,!0),a&&(d.responseType=a),l&&s(d,l),d.send()}else d.open(t||n.GET,e,!0),a&&(d.responseType=a),l&&s(d,l),d.send()})).cancellable();return u.catchType(Promise.CancellationError,(()=>{d.abort()})).catch((()=>{})),u}var l={head:function(e){return o(e,n.HEAD)},get:function(e,t,r=null){return o(e,n.GET,null,t,void 0,r)},post:function(e,t){return o(e,n.POST,t)},request:o,VERB:n,RESP_TYPE:{ARRAY_BUFFER:"arraybuffer",BLOB:"blob",JSON:"json"}};t.default=l},2794:(e,t,r)=>{e.exports=r.p+"img/bg-chat-tile-dark_a4be512e7195b6b733d9110b408f075d.png"},95431:(e,t,r)=>{e.exports=r.p+"img/bg-chat-tile-light_04fcacde539c58cca6745483d4858c52.png"},28112:(e,t,r)=>{e.exports=r.p+"img/f00_50f7c47f611e65a746f1d8328172af4c.png"},42528:(e,t,r)=>{e.exports=r.p+"img/f01_3d1e81d38917ed4427168024350d8df6.png"},36694:(e,t,r)=>{e.exports=r.p+"img/f02_c83a3786caa656cdcea06396bbc6c1fc.png"},11362:(e,t,r)=>{e.exports=r.p+"img/f03_dc76f32180586199d7e1872dd004832c.png"},79236:(e,t,r)=>{e.exports=r.p+"img/f04_f13406e16c2b6a8dda89763cf005b02b.png"},91319:(e,t,r)=>{e.exports=r.p+"img/f05_566b33dfb23660bf5fa83125a9dd8218.png"},71016:(e,t,r)=>{e.exports=r.p+"img/f06_f564cba48589a560af4b6e8408ae1718.png"},63232:(e,t,r)=>{e.exports=r.p+"img/f07_ae76e3caeb9dde2ad18eab0ce141d223.png"},92282:(e,t,r)=>{e.exports=r.p+"img/f08_59c98baa006f5eac6629be0957fd73f2.png"},59766:(e,t,r)=>{e.exports=r.p+"img/f09_1a7f295d0fa98fa1d2a63f8dc4600341.png"},76390:(e,t,r)=>{e.exports=r.p+"img/f10_53c9084de35f9f003ed395e1d120d9b6.png"},45881:(e,t,r)=>{e.exports=r.p+"img/f11_c129c05bc58cad686e0934357d6194fb.png"},4403:(e,t,r)=>{e.exports=r.p+"img/f12_bf90fa5257d34005ad5b75ffebb9b74c.png"},55227:(e,t,r)=>{e.exports=r.p+"img/f13_156bc51d4150b9b257fa4e2e774ce985.png"},93864:(e,t,r)=>{e.exports=r.p+"img/f14_95fa7d926a8cf1638985d3cd551fac31.png"},43571:(e,t,r)=>{e.exports=r.p+"img/f15_454f1add82fcb11fbb4086c8be3b1bd9.png"},8372:(e,t,r)=>{e.exports=r.p+"img/f16_9ca6324f98317f9d73084696719d2b9b.png"},83798:(e,t,r)=>{e.exports=r.p+"img/f17_9376c16fcd9b554de8a081973bebe9aa.png"},34761:(e,t,r)=>{e.exports=r.p+"img/f18_cc883fb28c32b1652826de5dc16feee0.png"},53916:(e,t,r)=>{e.exports=r.p+"img/f19_c448ba8ef94abcf763e25003aa15d27d.png"},47737:(e,t,r)=>{e.exports=r.p+"img/f20_4ebcff229b29e651b73640d0cd8eccb2.png"},34996:(e,t,r)=>{e.exports=r.p+"img/f21_54d02a1f6ad665760923ecfae9c9ff25.png"},85843:(e,t,r)=>{e.exports=r.p+"img/f22_ca38cbb571fbddb6900518455b8a20b9.png"},90334:(e,t,r)=>{e.exports=r.p+"img/f23_851a6d2ec552319ddaac7ff8ff37263e.png"},16270:(e,t,r)=>{e.exports=r.p+"img/f24_7806bc8ea69d9441ff27032fbaf52907.png"},1603:(e,t,r)=>{e.exports=r.p+"img/f25_68d927d9d12aef33387b683be6341340.png"},92957:(e,t,r)=>{e.exports=r.p+"img/f26_eb28a47950f61dc80827a74063d8786a.png"},70475:(e,t,r)=>{e.exports=r.p+"img/f27_d53f3b6cf583d7a41f3434d18fe4456e.png"},41844:(e,t,r)=>{e.exports=r.p+"img/f28_245f3d8d8dae33bdc04373918922c5a8.png"},67025:(e,t,r)=>{e.exports=r.p+"img/f29_31c6170329c4cf5808fe773488b5d143.png"},88471:(e,t,r)=>{e.exports=r.p+"img/f30_105e340803065abb74841ce2fff42b4b.png"},20366:(e,t,r)=>{e.exports=r.p+"img/f31_db46b1350eb553583212866aa44e2ac0.png"},77828:(e,t,r)=>{e.exports=r.p+"img/f32_4c358e4136bab81e06b7fd7171a7908c.png"},86365:(e,t,r)=>{e.exports=r.p+"img/f33_5a8f246313db052d67853a40f77a6427.png"},4299:(e,t,r)=>{e.exports=r.p+"img/f34_8588016a836bc826824d0656c8b7b0bc.png"},97300:(e,t,r)=>{e.exports=r.p+"img/f35_8aefe3b46c378109f0f780b6954e18db.png"},12406:(e,t,r)=>{e.exports=r.p+"img/f36_793fc72fadaf963507fc6802a9470970.png"},29499:(e,t,r)=>{e.exports=r.p+"img/f37_8d8f6653cbe1f6dd3783174a8af618da.png"},82859:(e,t,r)=>{e.exports=r.p+"img/f38_54b8f37e9f1251bfe9a2a2ef88a31912.png"},70754:(e,t,r)=>{e.exports=r.p+"img/f39_23a6e90aa9166a2fb981cc171abe8513.png"},9070:(e,t,r)=>{e.exports=r.p+"img/f40_923f39f07df4b8ad006e1115dcb206ec.png"},61137:(e,t,r)=>{e.exports=r.p+"img/f41_87448793e4bcea7fae3cfa7532e45033.png"},82323:(e,t,r)=>{e.exports=r.p+"img/f42_cd0e42183cff2e75bdde0c139bbb641a.png"},59839:(e,t,r)=>{e.exports=r.p+"img/f43_9f44150edcf010967cf272c80bd4ff14.png"},32250:(e,t,r)=>{e.exports=r.p+"img/f44_7f5d4a3e29f21bd5d5572a1543448949.png"},19392:(e,t,r)=>{e.exports=r.p+"img/f45_04c55805346c4afbc7f8084570a2cd48.png"},89641:(e,t,r)=>{e.exports=r.p+"img/f46_1e9f9b05193093b5d0d80d9c936bcb36.png"},90300:(e,t,r)=>{e.exports=r.p+"img/f47_152a85c5e9ff12d5f85050ecad1d4313.png"},36824:(e,t,r)=>{e.exports=r.p+"img/f48_bd6d89500662b8605997f54027b2e650.png"},38324:(e,t,r)=>{e.exports=r.p+"img/f49_42185158c0bfff92c70f417c74297ce7.png"},81036:(e,t,r)=>{e.exports=r.p+"img/f50_d825d156222c0d93428f4ecd78564c75.png"},60222:(e,t,r)=>{e.exports=r.p+"img/f51_51e116016636d309962001419e70d5f1.png"},11776:(e,t,r)=>{e.exports=r.p+"img/f52_5296e30be9bec98ccf173a9be6e711a9.png"},98408:(e,t,r)=>{e.exports=r.p+"img/f53_f81b7a3702779e190aeefb7e2183e636.png"},78995:(e,t,r)=>{e.exports=r.p+"img/f54_37b3eb612da7ad6c0b20b65e4fdae582.png"},76414:(e,t,r)=>{e.exports=r.p+"img/f55_0c3d912e971e18d6fe8946550262d0e6.png"},19850:(e,t,r)=>{e.exports=r.p+"img/f56_97a65c1c44dced234e0fbb5f78cb277f.png"},76436:(e,t,r)=>{e.exports=r.p+"img/f57_88b41898da1ce86274ee318e1713f437.png"},12327:(e,t,r)=>{e.exports=r.p+"img/f58_56649fe103006ec4fc5bdea5c69f7828.png"},5683:(e,t,r)=>{e.exports=r.p+"img/f59_1dd065a271b58e1ecb9bb3b6c261107f.png"},28979:(e,t,r)=>{e.exports=r.p+"img/f60_4b277b056575663ee9dbf81fecce989e.png"},38941:(e,t,r)=>{e.exports=r.p+"img/f61_ef3fba8c7e6d895afacfb334e7a746ff.png"},12717:(e,t,r)=>{e.exports=r.p+"img/f62_edecb61bfd5cd13895dd8134898d4402.png"},89157:(e,t,r)=>{e.exports=r.p+"img/f63_245e85a3728d5fed6ff9acf1182f4797.png"},58185:(e,t,r)=>{e.exports=r.p+"img/f64_48df8c352924ef1153bb8fd56f5af198.png"},22789:(e,t,r)=>{e.exports=r.p+"img/f65_162b82a8adaf7d2815129f38f265bfb6.png"},43712:(e,t,r)=>{e.exports=r.p+"img/f66_c626c592461087351ad719fa3118959d.png"},58176:(e,t,r)=>{e.exports=r.p+"img/f67_daa263ddff773a14e3ababc4b485a7c9.png"},38042:(e,t,r)=>{e.exports=r.p+"img/f68_ec21f5c8c90ec3bbf634290d6e6025c0.png"},84607:(e,t,r)=>{e.exports=r.p+"img/f69_549a880f1517135abf8914b4cb31fa92.png"},56743:(e,t,r)=>{e.exports=r.p+"img/f70_a69c6599124e3c33d7fac368b07c0249.png"},71475:(e,t,r)=>{e.exports=r.p+"img/f71_4aceb1dc5eaeb5f9cdddf4975e45a841.png"},91638:(e,t,r)=>{e.exports=r.p+"img/f72_f4ed6835609bf3831a20437e8e47d2dc.png"},60680:(e,t,r)=>{e.exports=r.p+"img/f73_94b8b5d2760e6afd967fd74a008cfae0.png"},99319:(e,t,r)=>{e.exports=r.p+"img/f74_2cd31cfe47f05fabb12f9b9f76fc2b6b.png"},72673:(e,t,r)=>{e.exports=r.p+"img/f75_25366bc618fe77d5dfd9db90133f2766.png"},90371:(e,t,r)=>{e.exports=r.p+"img/f76_1347ad29de86f3d0ceb3bf329b06a0a7.png"},99235:(e,t,r)=>{e.exports=r.p+"img/f77_6749eab5d350640476c8ec39ebc3e4db.png"},74681:(e,t,r)=>{e.exports=r.p+"img/f78_9effc679939e4458adafae48294a5db5.png"},44017:(e,t,r)=>{e.exports=r.p+"img/f79_36df3d2cd225fa6b3a6c84c69b72bed1.png"},91078:(e,t,r)=>{e.exports=r.p+"img/f80_f94a52bb981c25a9f8643a55d023be59.png"},85463:(e,t,r)=>{e.exports=r.p+"img/f81_fb74d3d4cc5a27e62e93586c7d09e47e.png"},50693:(e,t,r)=>{e.exports=r.p+"img/f82_2741f2d09772f3e9e836f2c50fb0bf99.png"},60668:(e,t,r)=>{e.exports=r.p+"img/f83_f8586167f3fde3b1e0c7dbb479e5c0ab.png"},70206:(e,t,r)=>{e.exports=r.p+"img/f84_f5b79393aa7e2979b376c76f46d39b52.png"},33578:(e,t,r)=>{e.exports=r.p+"img/f85_7ea40f8452fb838a747fb0881ffd5980.png"},23854:(e,t,r)=>{e.exports=r.p+"img/f86_486fdf332fda50c1cd7c4b9bd8a3f993.png"},61471:(e,t,r)=>{e.exports=r.p+"img/f87_91e88bfc16e4baddaf2fc4f881c3efc5.png"},32960:(e,t,r)=>{e.exports=r.p+"img/f88_286401f05def8a122db7f4686e383691.png"},21810:(e,t,r)=>{e.exports=r.p+"img/f89_658f39d559719b5b6208346f6a7753b9.png"},90864:(e,t,r)=>{e.exports=r.p+"img/f90_d5612bad79e603d92135c3bbfbcd14d1.png"},56928:(e,t,r)=>{e.exports=r.p+"img/f91_58bb429f953c740a98bcab0c032e8e25.png"},80801:(e,t,r)=>{e.exports=r.p+"img/f92_970e0969177b051897bdd55bf12ee3ae.png"},59496:(e,t,r)=>{e.exports=r.p+"img/f93_4776ec98a5d48ae85b24621ad1eac6eb.png"},36441:(e,t,r)=>{e.exports=r.p+"img/f94_296c4ae16a836cf0903cc5ef0476333c.png"},74101:(e,t,r)=>{e.exports=r.p+"img/f95_888ec2f78b312aed756a8d7008dc979b.png"},42428:(e,t,r)=>{e.exports=r.p+"img/f96_5b97286be655dbd4f5aa79f5f008c5ce.png"},18281:(e,t,r)=>{e.exports=r.p+"img/f97_b4ff99d92592c44b5d8a5b501fc24da6.png"},89327:(e,t,r)=>{e.exports=r.p+"img/f98_0922d228059acde80cc489a2879fe864.png"},13:(e,t,r)=>{e.exports=r.p+"img/f99_c608e2edac2f741a5a39b814ba36c287.png"},55626:(e,t,r)=>{e.exports=r.p+"img/favicon-error_ac2b4ac0b3a8a9d2256d517e69a3e272.png"},80115:(e,t,r)=>{e.exports=r.p+"img/favicon-error2_fb2afa4bfd23495c7bd2555bb080bb35.png"},85010:(e,t,r)=>{e.exports=r.p+"img/favicon_c5088e888c97ad440a61d247596f88e5.png"},3696:(e,t,r)=>{e.exports=r.p+"img/f00_81a748c30861e19178cb90ab8b31c9e4.png"},60002:(e,t,r)=>{e.exports=r.p+"img/f01_78cd893586564a736b94f919cd2851f7.png"},94662:(e,t,r)=>{e.exports=r.p+"img/f02_4bfcfe058a11109e81b7e9cbdfdeb02a.png"},46862:(e,t,r)=>{e.exports=r.p+"img/f03_577fd59324f5db48af17efcba0a23ea5.png"},17483:(e,t,r)=>{e.exports=r.p+"img/f04_841c20c722f90620ba13762ae73f6143.png"},84503:(e,t,r)=>{e.exports=r.p+"img/f05_c1bde74d642126370c5da5fb0de680c6.png"},86666:(e,t,r)=>{e.exports=r.p+"img/f06_eb85be6945aa4a51c3e05d97ecb1c290.png"},65819:(e,t,r)=>{e.exports=r.p+"img/f07_4d1031e781a9619d0579571eb2049ee6.png"},78503:(e,t,r)=>{e.exports=r.p+"img/f08_4d61c3d691066fa829ad43af1d6063ca.png"},80492:(e,t,r)=>{e.exports=r.p+"img/f09_f9d4e1b3266f81e8952251520de80711.png"},9838:(e,t,r)=>{e.exports=r.p+"img/f10_1f2eeb1340d4c4b4d423117d47d5f56e.png"},58230:(e,t,r)=>{e.exports=r.p+"img/f11_699424412fed1628d27e04957a284d2e.png"},9829:(e,t,r)=>{e.exports=r.p+"img/f12_ef4dd9b4bc88503d33fde312a57af7f9.png"},87798:(e,t,r)=>{e.exports=r.p+"img/f13_0bf1895a611a2187f9758ac305e87d2e.png"},9622:(e,t,r)=>{e.exports=r.p+"img/f14_df2ad83835b022116ce26f030de1a13d.png"},81371:(e,t,r)=>{e.exports=r.p+"img/f15_cffc8769d0c2ef7f8f8d5fc16e339cab.png"},89379:(e,t,r)=>{e.exports=r.p+"img/f16_8b958a65cb9dbf5c7716f1c865391473.png"},11568:(e,t,r)=>{e.exports=r.p+"img/f17_83147bc30e9d1cfe9ae417bf4afc2f77.png"},84963:(e,t,r)=>{e.exports=r.p+"img/f18_9595be739a769411763ad68c24cb245f.png"},84031:(e,t,r)=>{e.exports=r.p+"img/f19_2b465cf764fb53292292e003e070268a.png"},47363:(e,t,r)=>{e.exports=r.p+"img/f20_a781e4e7a5b4d97c226843b0f2d1472d.png"},15072:(e,t,r)=>{e.exports=r.p+"img/f21_b03a1e45532edd017ebbda6b8e2566bb.png"},55882:(e,t,r)=>{e.exports=r.p+"img/f22_809ee1be83cf9aba76ecde6bf3e65e58.png"},52906:(e,t,r)=>{e.exports=r.p+"img/f23_e2c0fa78795ee79b68fdbdca50a960ae.png"},27643:(e,t,r)=>{e.exports=r.p+"img/f24_3832927a08d4eec1867a7d7c4ba2fcd7.png"},24808:(e,t,r)=>{e.exports=r.p+"img/f25_0ade03b46b6e8819de9523bc8ff6a7cd.png"},39778:(e,t,r)=>{e.exports=r.p+"img/f26_e38c0e2c62dae55d9cdf26d8c22b6b9d.png"},62918:(e,t,r)=>{e.exports=r.p+"img/f27_b4871a7570313a9f599b1911f339413d.png"},46203:(e,t,r)=>{e.exports=r.p+"img/f28_1b3971aa7b75218570c3d9940aa4a73d.png"},12124:(e,t,r)=>{e.exports=r.p+"img/f29_f2c7a605126e29e8885601cdc65e6aa0.png"},40921:(e,t,r)=>{e.exports=r.p+"img/f30_712d71bfb048818a771a9d144b40d9aa.png"},36075:(e,t,r)=>{e.exports=r.p+"img/f31_1d19e90516ce464192bd7016d05a2dba.png"},50820:(e,t,r)=>{e.exports=r.p+"img/f32_9a70dc1de944f622b350752076a6310d.png"},41557:(e,t,r)=>{e.exports=r.p+"img/f33_1f3382e82a8abe7cdce46f789f7c4ede.png"},54244:(e,t,r)=>{e.exports=r.p+"img/f34_29dc69ea8e91117dae46fcf7e7f58417.png"},86200:(e,t,r)=>{e.exports=r.p+"img/f35_fa478612d2487e2fead293b7005566ea.png"},35886:(e,t,r)=>{e.exports=r.p+"img/f36_bb827e69f0979553e18c0fd1cb192b02.png"},45892:(e,t,r)=>{e.exports=r.p+"img/f37_b06f5850d2c8eda0c51ad5491779af6c.png"},89059:(e,t,r)=>{e.exports=r.p+"img/f38_0b370e976457b876910c4a638ac302e2.png"},14235:(e,t,r)=>{e.exports=r.p+"img/f39_a09d7dfecc70b04ec35edc2967c60a30.png"},85310:(e,t,r)=>{e.exports=r.p+"img/f40_ed134cdcd59bb430218f2be2cdd20aa1.png"},1883:(e,t,r)=>{e.exports=r.p+"img/f41_a785dbfd120b89c2e8616357b9722163.png"},81712:(e,t,r)=>{e.exports=r.p+"img/f42_4149402ff16c6de0b1b06eff01619455.png"},11176:(e,t,r)=>{e.exports=r.p+"img/f43_d543d1bc6a09014ac24d7189b0ced761.png"},64735:(e,t,r)=>{e.exports=r.p+"img/f44_9ffa8beb4bd1c21f328fdd822cba19a7.png"},55380:(e,t,r)=>{e.exports=r.p+"img/f45_0c3cea68945b437380dacd15cbe90ded.png"},60416:(e,t,r)=>{e.exports=r.p+"img/f46_58320ab4676a6287d9dec0790f0d88fc.png"},82479:(e,t,r)=>{e.exports=r.p+"img/f47_5f2ac6f7a9fe79dc3d9a701872c0d0f8.png"},26559:(e,t,r)=>{e.exports=r.p+"img/f48_5fdbdf26d5c581f2a84ebfa50355bd2d.png"},64524:(e,t,r)=>{e.exports=r.p+"img/f49_7bd9cdf5a225ef778b0abd7c9b5310ba.png"},90832:(e,t,r)=>{e.exports=r.p+"img/f50_f4b49b8b3eb729c1fd7c991958aa67b7.png"},14502:(e,t,r)=>{e.exports=r.p+"img/f51_cccd95bad4c9b8e03d05f634e91d2cc8.png"},40316:(e,t,r)=>{e.exports=r.p+"img/f52_8cc8a9757166f53c59a5a1c5e2ebeb00.png"},6347:(e,t,r)=>{e.exports=r.p+"img/f53_623900497390a42269ea6c7ffd812ecc.png"},10348:(e,t,r)=>{e.exports=r.p+"img/f54_c114021c7945464df273df92403987cb.png"},7667:(e,t,r)=>{e.exports=r.p+"img/f55_bcfef9ad8bf26d250613af9b04c918cf.png"},44117:(e,t,r)=>{e.exports=r.p+"img/f56_76dd317a660aa4927e72484ef9d903fb.png"},9713:(e,t,r)=>{e.exports=r.p+"img/f57_72ed0f17ab92bb06761245cb5a7fd73b.png"},26541:(e,t,r)=>{e.exports=r.p+"img/f58_8b9aa917870bcfabc296989c8a810446.png"},7986:(e,t,r)=>{e.exports=r.p+"img/f59_1a64de23c9ec094314b18a18108319ce.png"},70184:(e,t,r)=>{e.exports=r.p+"img/f60_4926d3e8b53f38a3c792cb7b3e07d48d.png"},53531:(e,t,r)=>{e.exports=r.p+"img/f61_08509dff37749613925fe8b16a84ba56.png"},53737:(e,t,r)=>{e.exports=r.p+"img/f62_0869c06452d4ebecdc99f7192ebc702f.png"},95851:(e,t,r)=>{e.exports=r.p+"img/f63_6083f333c2239cba7bbde44e7607a67c.png"},85713:(e,t,r)=>{e.exports=r.p+"img/f64_5d2e1af055fb2cb08326de8e4a844eab.png"},79963:(e,t,r)=>{e.exports=r.p+"img/f65_c863d05c20e4ff179c46170a5311afaf.png"},64784:(e,t,r)=>{e.exports=r.p+"img/f66_1971ad2c6440b2fc909759d8614ef901.png"},40143:(e,t,r)=>{e.exports=r.p+"img/f67_8817a536067dadbc7dc0b1ce0c7cca51.png"},24041:(e,t,r)=>{e.exports=r.p+"img/f68_11393ba2b52ac23a884f923672858aa3.png"},49811:(e,t,r)=>{e.exports=r.p+"img/f69_6a31bf9a0987d546a53d7e8e148d9fa3.png"},69809:(e,t,r)=>{e.exports=r.p+"img/f70_6a12b8c8cf306de335b3174c92c7d63d.png"},13510:(e,t,r)=>{e.exports=r.p+"img/f71_363e1241dbcac22f3bebce9bb5e03e85.png"},11034:(e,t,r)=>{e.exports=r.p+"img/f72_ae6ac1146134ea79656c595a1a2d0e8b.png"},60956:(e,t,r)=>{e.exports=r.p+"img/f73_c9b6d05e598e5adf69ceab85f5db96ac.png"},30816:(e,t,r)=>{e.exports=r.p+"img/f74_67c9ceb4623d37c005ae86e28e4e9fbe.png"},89456:(e,t,r)=>{e.exports=r.p+"img/f75_62cbd93e646a20f624123b595584f2a2.png"},56194:(e,t,r)=>{e.exports=r.p+"img/f76_6862123772ba72af8d1f307c0d2b4895.png"},29022:(e,t,r)=>{e.exports=r.p+"img/f77_78710dcf8b6d89f3951e7887f95408bf.png"},26478:(e,t,r)=>{e.exports=r.p+"img/f78_59e408dc54ae0bd33f3617f7ee9bb2e0.png"},35114:(e,t,r)=>{e.exports=r.p+"img/f79_6682dcc8dd4b1c197e7ec7b9b3deb601.png"},33618:(e,t,r)=>{e.exports=r.p+"img/f80_0d13bdc19570b4c3577062fd0a3a1428.png"},65771:(e,t,r)=>{e.exports=r.p+"img/f81_bfb32e248b9a30d62e32a1f7ea4e7e98.png"},31596:(e,t,r)=>{e.exports=r.p+"img/f82_286f2cdea929dc7b1565aad502aaf165.png"},93862:(e,t,r)=>{e.exports=r.p+"img/f83_4984ad9c5348e8717965f575ac7ea534.png"},58916:(e,t,r)=>{e.exports=r.p+"img/f84_4d4303666006c977553c896dd850fc1b.png"},80998:(e,t,r)=>{e.exports=r.p+"img/f85_10cbc8d1444126f654a032456a74a72c.png"},91920:(e,t,r)=>{e.exports=r.p+"img/f86_03d43f57ad876d0367274524fd27b4ec.png"},18343:(e,t,r)=>{e.exports=r.p+"img/f87_610b9a8f68249032da365af5a664fc41.png"},85191:(e,t,r)=>{e.exports=r.p+"img/f88_5ad6ef9e65165c4bb4c670ce875a5fb5.png"},18011:(e,t,r)=>{e.exports=r.p+"img/f89_e049c6b076ab9212a901406939d7274e.png"},37855:(e,t,r)=>{e.exports=r.p+"img/f90_88c16bdd2fd8228ad1ec89ce3f0cb118.png"},37567:(e,t,r)=>{e.exports=r.p+"img/f91_78d445d5baae7479cac968c11f6724dc.png"},22297:(e,t,r)=>{e.exports=r.p+"img/f92_34f845f9fa2a3667d8d747453f63ad68.png"},16206:(e,t,r)=>{e.exports=r.p+"img/f93_2f324509fe48d002f5a944b003cd180d.png"},82379:(e,t,r)=>{e.exports=r.p+"img/f94_c406ffa6170c14bcbe3158ab7879ce16.png"},59353:(e,t,r)=>{e.exports=r.p+"img/f95_7ce72143c371f981d394ab9b3391f5ea.png"},68161:(e,t,r)=>{e.exports=r.p+"img/f96_bc32095dc9dab040674f58592e10451b.png"},72202:(e,t,r)=>{e.exports=r.p+"img/f97_eedf5849b413d903c4cc72cca6ce0576.png"},18133:(e,t,r)=>{e.exports=r.p+"img/f98_8d47ec83349711222b6d9346049676f1.png"},91681:(e,t,r)=>{e.exports=r.p+"img/f99_d27a48329dde7e88d3d7cd348d745f91.png"},98973:(e,t,r)=>{e.exports=r.p+"img/favicon-error_ef91873fcda4eda22679f675ebf6ed24.png"},33805:(e,t,r)=>{e.exports=r.p+"img/favicon-error2_7ce1b67dbef23e87862b3c12b9b32676.png"},23238:(e,t,r)=>{e.exports=r.p+"img/favicon_94e99ab189284094867d2e1220e42e9f.png"},38845:(e,t,r)=>{e.exports=r.p+"img/icon-group-default_92b8a80d57227e2f342bd57ccf6382d8.png"},56046:(e,t,r)=>{e.exports=r.p+"img/icon-user-default_bfb4ec026499f5b2d80e673a1a3a5bd7.png"},7059:(e,t,r)=>{e.exports=r.p+"img/intro-connection-dark_0ee01153183b5ebd9b296399cc2104b0.jpg"},76658:(e,t,r)=>{e.exports=r.p+"img/intro-connection-hq-dark_f8cb12a6fc73afaf9d5903b7849bebd6.jpg"},64921:(e,t,r)=>{e.exports=r.p+"img/intro-connection-hq-light_9466a20e6d2921a21ac7ab82419be157.jpg"},82823:(e,t,r)=>{e.exports=r.p+"img/intro-connection-light_c98cc75f2aa905314d74375a975d2cf2.jpg"},64229:(e,t,r)=>{e.exports=r.p+"img/qr-video-hq_96cc4255e20a97852c14cbc15995bc0d.jpg"},45361:(e,t,r)=>{e.exports=r.p+"img/qr-video_07f8d2958696dceefa4f4676aeb4663e.jpg"},39509:(e,t,r)=>{e.exports=r.p+"notification_2a485d84012c106acef03b527bb54635.mp3"},43686:(e,t,r)=>{e.exports=r.p+"send_message_98602e277c84944aafc41098fa4dd8d8.m4a"},79091:(e,t,r)=>{e.exports=r.p+"sequential-ptt-end_62ed28be622237546fd39f9468a76a49.mp3"},17109:(e,t,r)=>{e.exports=r.p+"sequential-ptt-middle_7fa161964e93db72b8d00ae22189d75f.mp3"},67634:(e,t,r)=>{e.exports=r.p+"whatsapp-webclient-login-hq_10ce945f706bbd216466cd05f672164d.mp4"},89293:(e,t,r)=>{e.exports=r.p+"whatsapp-webclient-login_a0f99e8cbba9eaa747ec23ffb30d63fe.mp4"},60497:(e,t,r)=>{"use strict";r.r(t),t.default={wrapper:"_3h3LX",isQR:"_1dqoA",isQr:"_1dqoA",draggableHeader:"_3WvPc",isMain:"_34ybp"}},15858:(e,t,r)=>{"use strict";r.r(t)},7479:(e,t,r)=>{"use strict";r.r(t),t.default={button:"_1dwBj",plainWhite:"_2EcSg",primary:"_3xWLK",secondary:"Spzqc",strongPrimary:"_1l_x_",warning:"_1BFEX",itemFocused:"_3nDx1",disabled:"JVgjR",nowrap:"_2V1EM",simplified:"_2ewuV",spinner:"_1G_dx",strong:"_1OaoY"}},78640:(e,t,r)=>{"use strict";r.r(t),t.default={link:"_24xcm"}},42314:(e,t,r)=>{"use strict";r.r(t),t.default={noop:"_3wXwX"}},60249:(e,t,r)=>{"use strict";r.r(t),t.default={noop:"_3-8er"}},94330:(e,t,r)=>{"use strict";r.r(t),t.default={"-emoji-picker-width":"388px",emojiPickerWidth:"388px",container:"_1qAEq",right:"_11bi2",picker:"_9lBgK",tooltip:"_1o8x9",items:"_19rjv",nib:"nlx4A",inverse:"_1rzcO",colorPicker:"_1In2E",emoji:"_2iHK1",sticker:"_1zmqw",inverseVertical:"gYkeG",text:"IBBBs",icons:"_3BZyX"}},76887:(e,t,r)=>{"use strict";r.r(t)},5947:(e,t,r)=>{"use strict";r.r(t),t.default={flex:"_3NCXc",directionHorizontal:"_FUG3",directionVertical:"_2EBj2",directionHorizontalReverse:"_1NF4-",directionVerticalReverse:"_3uUjW",justifyStart:"_1epIK",justifyCenter:"_1Yw2u",justifyEnd:"_2SPxy",justifyAll:"_2E7Hg",justifyAround:"_2dV6s",justifyEvenly:"_3tjJI",alignCenter:"_2HGw4",alignStart:"_3Ti0R",alignEnd:"JP43o",alignStretch:"eKyMO",alignBaseline:"_2L34J",wrap:"_2KzS4",wrapReverse:"OE8lY"}},92312:(e,t,r)=>{"use strict";r.r(t),t.default={flexItem:"VtaVl",alignAuto:"-TvKO",alignStart:"_2PYOl",alignCenter:"_3hCgp",alignEnd:"_1BZaG",alignStretch:"_7Uh2Y"}},6242:(e,t,r)=>{"use strict";r.r(t),t.default={progress:"_2Ps9W"}},74073:(e,t,r)=>{"use strict";r.r(t),t.default={video:"_3UUj0",container:"_2epc6",player:"_3fERx",poster:"_1vpd2",hidden:"_34HJw",overlay:"_2cwBX",button:"_3khBQ",play:"_1Sw8v"}},61910:(e,t,r)=>{"use strict";r.r(t),t.default={qrWrapper:"_3870-",text:"_29lv_",qr:"O1rXL",headline:"_24CXv",list:"_2yDOs",listItem:"ZJ0wv",hint:"_1Id11",toggle:"_37xqU",tip:"_2-pPz",rememberMeTip:"_1a-np",codeCopy:"_2fkxk",qrcode:"_3jid7",codeLogo:"-A_bA",idle:"_267ZZ",qrButton:"_3DeCQ",qrButtonIcon:"_2tiyK",groupInviteTip:"_2bTE0",icon:"_2zr6K"}},33567:(e,t,r)=>{"use strict";r.r(t),t.default={container:"_1sMV6"}},46602:(e,t,r)=>{"use strict";r.r(t),t.default={container:"_1XTIr"}},56517:(e,t,r)=>{"use strict";r.r(t),t.default={container:"_132Kx","rotate-ltr":"_1kCJK",rotateLtr:"_1kCJK",path:"_2EU5z",dash:"_3mEDO",default:"_2ZoUA",white:"_3ET3C",solidwhite:"_3ZJnR",highlight:"_39w8M",accent:"_3jpnp",in:"_3p1-X",out:"_3H_WX",noop:"_3JV-p","rotate-rtl":"_8Bv1n",rotateRtl:"_8Bv1n"}},25534:(e,t,r)=>{"use strict";r.r(t),t.default={reverse:"_1XP9x",inline:"_2nw-x",white:"_1xoWz",black:"_1-09X"}},73128:(e,t,r)=>{"use strict";r.r(t),t.default={"weight-light":"_3-Or1",weightLight:"_3-Or1","weight-normal":"_29Iga",weightNormal:"_29Iga","weight-medium":"_4Jchm",weightMedium:"_4Jchm","weight-semibold":"_391r4",weightSemibold:"_391r4","weight-bold":"jPHDz",weightBold:"jPHDz","size-8":"VLT8j",size8:"VLT8j","size-9":"_4992K",size9:"_4992K","size-10":"_1DyoB",size10:"_1DyoB","size-11":"_3y9sF",size11:"_3y9sF","size-12":"_2KWXe",size12:"_2KWXe","size-13":"qsTJT",size13:"qsTJT","size-14":"_1AJnI",size14:"_1AJnI","size-15":"_3ja-N",size15:"_3ja-N","size-16":"_3EsAO",size16:"_3EsAO","size-17":"rOUL-",size17:"rOUL-","size-18":"u_30I",size18:"u_30I","size-19":"_1TtmI",size19:"_1TtmI","size-20":"_1q4r_",size20:"_1q4r_","size-22":"_18JQV",size22:"_18JQV","size-24":"_1p6Pw",size24:"_1p6Pw","size-26":"_1I9yQ",size26:"_1I9yQ","size-28":"BKJMV",size28:"BKJMV","size-30":"_2NHuO",size30:"_2NHuO","size-32":"_3Q2nA",size32:"_3Q2nA","size-36":"_2Asix",size36:"_2Asix","size-48":"_2VwSE",size48:"_2VwSE","size-60":"_3VzdB",size60:"_3VzdB",title:"_1Kn3o",large:"qpqWq","section-title":"_3weD7",sectionTitle:"_3weD7","section-title-larger":"_3HZiZ",sectionTitleLarger:"_3HZiZ",small:"_201BQ",muted:"_37Hn4","muted-small":"_3iU5s",mutedSmall:"_3iU5s",plain:"_3yN28","popup-title":"_5Z9lA",popupTitle:"_5Z9lA","color-accent":"yeBCZ",colorAccent:"yeBCZ","color-danger":"_2xgD1",colorDanger:"_2xgD1","color-dark":"vCuIB",colorDark:"vCuIB","color-secondary":"cpeB8",colorSecondary:"cpeB8","color-muted":"lXktD",colorMuted:"lXktD","color-success":"_21bUp",colorSuccess:"_21bUp"}},19677:(e,t,r)=>{"use strict";r.r(t),t.default={toast:"AWZA-",right:"_29Ru9",close:"_19Mz6",button:"_2FSIK",btnSuccess:"_1QEPz"}},65481:(e,t,r)=>{"use strict";r.r(t),t.default={wrapper:"_3IsEX",slide0:"_5D0tR",slide1:"V4D9s",slide2:"_1NOem",slide3:"QyChF"}},28673:(e,t,r)=>{"use strict";r.r(t),t.default={pending:"_160LO"}},18050:(e,t,r)=>{"use strict";r.r(t),t.default={mask:"_1vPu0"}},52497:(e,t,r)=>{"use strict";r.r(t),t.default={container:"_2sWIa",containerFixed:"_1one0",graphic:"_3419W",logo:"_2Pv5M",dots:"_1eMR9",laptop:"_2dUbm",shimmering:"vQA16","shimmer-ltr":"_3M73Q",shimmerLtr:"_3M73Q","shimmer-rtl":"_1wVsi",shimmerRtl:"_1wVsi",initialLoad:"_1F05l",logout:"-F86p",organizing:"k_UuR",progress:"_15P0N",main:"_2ISCK",secondary:"_1azin",warning:"_1wYCT",showWarning:"_2_alf",dot:"_28y4i"}},22371:(e,t,r)=>{"use strict";r.r(t),t.default={background:"_2oJcB",mainWrapper:"_2Da41",logoutTitle:"_15Ayf"}},55027:(e,t,r)=>{"use strict";r.r(t),t.default={backdrop:"_1814Z",popupContainer:"_1gmLA",popup:"_3NCh_",popupBody:"_3B-ht",popupTitle:"_1ENRV",backdropCover:"_3Ku9S",popupContents:"_3SRfO",popupBox:"_2LViW",popupFlex:"_3wAow",popupAuto:"_2ekDq",popupControls:"_1uJw_",popupFlexInvite:"_2ty1W",popupTower:"_1MNyt",popupGuide:"_3pCPi"}},46984:(e,t,r)=>{"use strict";r.r(t),t.default={action:"_3NY9P",textTip:"_3NYCH",divider:"_38rGi"}},64411:(e,t,r)=>{"use strict";r.r(t),t.default={textTip:"_1H__B",divider:"_35dIr"}},78178:(e,t,r)=>{"use strict";r.r(t),t.default={focusAnimation:"_2N0S3",focusAnimationKeyframes:"_13Lpl"}},77012:(e,t,r)=>{"use strict";function a(){return new Worker(r.p+"milan.cc914959e7923719f571.worker.js")}r.r(t),r.d(t,{default:()=>a})},46907:(e,t,r)=>{"use strict";function a(){return new Worker(r.p+"index.353e39d0ed1e1fb1b75e.worker.js")}r.r(t),r.d(t,{default:()=>a})},10601:(e,t,r)=>{"use strict";function a(){return new Worker(r.p+"opus.ffc66730dae3bb9cd237.worker.js")}r.r(t),r.d(t,{default:()=>a})},11888:(e,t,r)=>{"use strict";function a(){return new Worker(r.p+"webp_to_rgba.worker.32ef9bdf0474e15ac046.worker.js")}r.r(t),r.d(t,{default:()=>a})}},e=>{"use strict";e.O(0,[1174],(()=>{return t=95147,e(e.s=t);var t}));e.O()}]);