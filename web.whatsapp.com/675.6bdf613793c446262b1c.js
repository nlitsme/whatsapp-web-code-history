/*! Copyright (c) 2023 WhatsApp Inc. All Rights Reserved. */
(self.webpackChunkwhatsapp_web_client=self.webpackChunkwhatsapp_web_client||[]).push([[675],{273925:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.JobBuilder=void 0,t.definePersistedJob=function(){return new o([])};var r=n(811158),i=n(632157);class o{constructor(e){this.steps=e}step(e,t){return this._stepWithOptions(e,"function"==typeof t?{code:t}:t)}_stepWithOptions(e,t){const{stopRetryIf:n,requirements:c,code:l}=t;let a=u(c,l,n);if(n){const{timePassedSeconds:e,appCrashed:t,onStopRetry:o}=n,c=u(null,function(e){return(t,n,i)=>Promise.resolve(e(t,n,i)).then((e=>e instanceof r.InterruptJob?e:new r.InterruptJob(e)))}(o),n);null!=e&&(a=s(((t,n,r)=>{let{jobStartTime:o}=r;return(0,i.happenedWithin)(o,e)}),a,c)),t&&(a=s(((e,t,n)=>{let{afterCrash:r}=n;return!r}),a,c))}return new o([...this.steps,{stepName:e,info:a}])}finalStep(e,t){const n=this.step(e,t);return{end:()=>n.steps}}}function s(e,t,n){return(r,i,o)=>e(r,i,o)?t(r,i,o):n(r,i,o)}function u(e,t,n){const r={requirements:e,code:t,stopRetryIf:n};return()=>r}t.JobBuilder=o},193182:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.defineWebPersistedJob=function(){return(0,r.definePersistedJob)()};var r=n(273925)},220675:(e,t,n)=>{"use strict";var r=n(595318);Object.defineProperty(t,"__esModule",{value:!0}),t.primaryActionClickInQuickPromotion=void 0;var i=r(n(81109)),o=r(n(348926)),s=n(193182),u=n(658265),c=n(732011);const l=(0,s.defineWebPersistedJob)().finalStep("saveToDb",(function(e){let{id:t,ts:n}=e;return(0,c.getStorage)().lock(["quick-promotions"],function(){var e=(0,o.default)((function*(e){let[r]=e;const o=yield r.get(t);if(null==o)return void __LOG__(3)`primaryActionClickInQuickPromotion: promotion not found`;const s=(0,i.default)((0,i.default)({},o.tracking),{},{primaryClicks:o.tracking.primaryClicks+1}),{lastPrimaryClickTs:u}=s;(null==u||n>u)&&(s.lastPrimaryClickTs=n),yield r.merge(t,{tracking:s})}));return function(){return e.apply(this,arguments)}}()).then(u.loadQuickPromotions)})).end();t.primaryActionClickInQuickPromotion=l}}]);
//# sourceMappingURL=https://web.whatsapp.com/675.6bdf613793c446262b1c.js.map
