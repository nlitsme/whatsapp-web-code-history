/*! Copyright (c) 2023 WhatsApp Inc. All Rights Reserved. */
(self.webpackChunkwhatsapp_web_client=self.webpackChunkwhatsapp_web_client||[]).push([[675],{220675:(t,e,n)=>{"use strict";var i=n(595318);Object.defineProperty(e,"__esModule",{value:!0}),e.primaryActionClickInQuickPromotion=void 0;var o=i(n(81109)),r=i(n(348926)),c=n(400538),a=n(193182),l=n(658265),s=n(732011);function u(){return(u=(0,r.default)((function*(t,e){let{id:n,ts:i}=e;const o=yield(0,c.sendEventRPC)({eventType:"primary_click",eventPromotionId:n,eventTimestampSec:i,eventLogdata:""});"EventResponseSuccess"!==o.name&&(o.name,__LOG__(4,void 0,new Error)`primaryActionClickInQuickPromotion: unable to log`)}))).apply(this,arguments)}const p=(0,a.defineWebPersistedJob)().step("saveToDb",(function(t){let{id:e,ts:n}=t;return(0,s.getStorage)().lock(["quick-promotions"],function(){var t=(0,r.default)((function*(t){let[i]=t;const r=yield i.get(e);if(null==r)return void __LOG__(3)`primaryActionClickInQuickPromotion: promotion not found`;const c=(0,o.default)((0,o.default)({},r.tracking),{},{primaryClicks:r.tracking.primaryClicks+1}),{lastPrimaryClickTs:a}=c;(null==a||n>a)&&(c.lastPrimaryClickTs=n),yield i.merge(e,{tracking:c})}));return function(){return t.apply(this,arguments)}}()).then(l.loadQuickPromotions)})).finalStep("reportToComms",(function(){return u.apply(this,arguments)})).end();e.primaryActionClickInQuickPromotion=p}}]);
//# sourceMappingURL=https://web.whatsapp.com/675.2cbbdddf2287658d8590.js.map
