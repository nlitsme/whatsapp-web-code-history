/*! Copyright (c) 2021 WhatsApp Inc. All Rights Reserved. */
(self.webpackChunkwhatsapp_web_client=self.webpackChunkwhatsapp_web_client||[]).push([[8169],{15115:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.definePersistedJob=function(){return new i([])},t.JobBuilder=void 0;var r=n(57148),s=n(55329);class i{constructor(e){this.steps=e}step(e,t){return this._stepWithOptions(e,"function"==typeof t?{code:t}:t)}_stepWithOptions(e,t){const{stopRetryIf:n,requirements:a,code:d}=t;let c=u(a,d,n);if(n){const{timePassedSeconds:e,appCrashed:t,onStopRetry:i}=n,a=u(null,function(e){return(t,n,r)=>Promise.resolve(e(t,n,r)).then((e=>e instanceof s.InterruptJob?e:new s.InterruptJob(e)))}(i),n);null!=e&&(c=o(((t,n,{jobStartTime:s})=>(0,r.happenedWithin)(s,e)),c,a)),t&&(c=o(((e,t,{afterCrash:n})=>!n),c,a))}return new i([...this.steps,{stepName:e,info:c}])}finalStep(e,t){const n=this.step(e,t);return{end:()=>n.steps}}}function o(e,t,n){return(r,s,i)=>e(r,s,i)?t(r,s,i):n(r,s,i)}function u(e,t,n){const r={requirements:e,code:t,stopRetryIf:n};return()=>r}t.JobBuilder=i},50113:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.defineWebPersistedJob=function(){return(0,r.definePersistedJob)()};var r=n(15115)},68169:(e,t,n)=>{"use strict";var r=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=r(n(48926)),i=n(10817),o=n(84922),u=n(50113),a=r(n(81771)),d=n(49438),c=n(12825),p=n(89573);const l=new a.default("getPublicKeyResponse",(e=>{var t,n;return e.assertTag("iq"),e.assertFromServer(),{certificate:null===(t=e.maybeChild("public_key"))||void 0===t||null===(n=t.maybeChild("pem"))||void 0===n?void 0:n.contentString()}}));var f=(0,u.defineWebPersistedJob)().finalStep("sendStanza",function(){var e=(0,s.default)((function*({businessJid:e}){const t=(0,i.wap)("iq",{to:i.S_WHATSAPP_NET,type:"get",smax_id:"52",xmlns:"w:biz:catalog",id:(0,i.generateId)()},(0,i.wap)("public_key",{jid:(0,d.USER_JID)((0,p.createWid)(e))})),n=yield(0,o.sendIq)(t,l);if(n.success)return n.result;throw new c.ServerStatusCodeError(n.errorCode)}));return function(){return e.apply(this,arguments)}}()).end();t.default=f}}]);