/*! Copyright (c) 2022 WhatsApp Inc. All Rights Reserved. */
(self.webpackChunkwhatsapp_web_client=self.webpackChunkwhatsapp_web_client||[]).push([[275],{26004:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.cartItemCollection.reset(),e.set("message",void 0),e.trigger("change:cartItemCollection"),(0,i.default)(e)};var i=n(a(83622))},97783:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){const a=i.CartCollection.findCart(e);return a.cartItemCollection.remove(t),a.trigger("change:cartItemCollection"),(0,s.default)(a),a.itemCount};var i=a(25523),s=n(a(83622))},30833:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.parsePrice=C,t.isPriceMatch=_,t.createProductFromRefreshCartItem=x,t.matchCartItemsToProducts=function(e,t){const a=s.CatalogCollection.get((0,m.createWid)(e.id)),n=[],i=[];let c=!0;a&&e.cartItemCollection.forEach((s=>{const r=a.productCollection.get(s.id);let o=t&&t.products.find((e=>e.id===s.id));if(o=function(e,t){if(e&&"deleted"===e.status)return void t.productCollection.remove(e.id);return e}(o,a),!t&&r){const e=function(e,t){const a=function(e,t){return e.priceAmount1000===(0,h.getActivePrice)(t)&&e.currency===t.currency&&e.name===t.name&&e.imageHash===t.imageHash}(e,t);a||e.set({priceAmount1000:(0,h.getActivePrice)(t),currency:t.currency,name:t.name,imageHash:t.imageHash},{silent:!0});return a}(s,r);c=c&&e,n.push({product:r,cartItem:s})}else if(o){const t=function(e,t){const a=!t||function(e,t){var a,n;const i=(0,h.getActivePrice)(v(t));return _(e.priceAmount1000,i)&&(!(0,p.isString)(e.currency)&&!(0,p.isString)(t.currency)||e.currency===t.currency)&&e.name===t.name&&e.imageHash===(null===(a=t.media)||void 0===a||null===(n=a.image)||void 0===n?void 0:n.id)}(e,t);if(!a&&t){const a=v(t);e.set({priceAmount1000:(0,h.getActivePrice)(a),currency:a.currency,name:a.name,imageHash:a.imageHash},{silent:!0})}return a}(s,o);c=c&&t,n.push({product:x(o,e.id),cartItem:s})}else c=!1,i.push(s.id)})),a||(0,r.default)(e);c||(i.length&&e.cartItemCollection.remove(i),e.trigger("change:cartItemCollection"),o.Cmd.openModal((0,g.jsx)(l.default,{onOK:()=>{o.Cmd.closeModal()},children:d.default.t(429)})));return(0,f.default)(e),n};var i=n(a(81109)),s=a(60028),r=n(a(26004)),o=a(69162),l=n(a(75940)),d=n(a(2408)),c=a(78150),u=a(94583),h=a(60952),f=n(a(83622)),p=a(74289),m=a(89573),g=a(85893);function v(e){var t,a,n,i,s,r,o,l;return{id:e.id,name:null!==(t=e.name)&&void 0!==t?t:"",imageCdnUrl:null===(a=e.media)||void 0===a||null===(n=a.image)||void 0===n?void 0:n.request_image_url,imageHash:null===(i=e.media)||void 0===i||null===(s=i.image)||void 0===s?void 0:s.id,currency:e.currency,priceAmount1000:C(e.price),salePriceAmount1000:C(null===(r=e.sale_price)||void 0===r?void 0:r.price),salePriceStartDate:(0,u.parseDateValue)(null===(o=e.sale_price)||void 0===o?void 0:o.start_date),salePriceEndDate:(0,u.parseDateValue)(null===(l=e.sale_price)||void 0===l?void 0:l.end_date)}}function C(e){return"string"==typeof e?e.length>0?parseInt(e,10):null:e}function _(e,t){const a=C(e),n=C(t);return(0,p.isNumber)(a)&&(0,p.isNumber)(n)?a===n:!(0,p.isNumber)(a)&&!(0,p.isNumber)(n)}function x(e,t){return new c.Product((0,i.default)((0,i.default)({},v(e)),{},{catalogWid:(0,m.createWid)(t),productMsgMediaData:null,imageCount:1,fetchedFromServer:!0,t:Date.now()/1e3,old:!1}))}},32973:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){if(0===e.cartItemCollection.length)return Promise.resolve({products:[],price:{}});const t=e.cartItemCollection.map((e=>e.id));return(0,n.refreshCart)((0,s.createWid)(e.id),t,i.CartCollection.imageWidth,i.CartCollection.imageHeight)};var n=a(62010),i=a(25523),s=a(89573)},33764:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return h.apply(this,arguments)};var i=n(a(48926)),s=a(60028),r=n(a(52937)),o=a(70225),l=n(a(58679)),d=n(a(83622)),c=a(89573);function u(e){var t,a;const n=e.cartItemCollection.at(0);if(null==n)return"";const i=s.CatalogCollection.get((0,c.createWid)(e.id)),o=null==i?void 0:i.productCollection.get(n.id),l=null==o||null===(t=o.getProductImageCollectionHead())||void 0===t?void 0:t.mediaData;return null==l?"":l.preview instanceof r.default&&null!==(a=l.preview.getBase64())&&void 0!==a?a:""}function h(){return(h=(0,i.default)((function*(e,t){const a=yield(0,o.createOrder)(t.id,e.cartItemCollection.toArray());return yield(0,l.default)(t,a,e.itemCount,u(e),e.message),(0,d.default)(e),a.id}))).apply(this,arguments)}},75878:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){e.set("message",t),(0,i.default)(e)};var i=n(a(83622))},48133:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a){const n=i.CartCollection.findCart(e),r=n.cartItemCollection.get(t.id);null==r||r.set("quantity",a),n.trigger("change:cartItemCollection"),(0,s.default)(n)};var i=a(25523),s=n(a(83622))},58679:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return f.apply(this,arguments)};var i=n(a(48926)),s=a(25142),r=n(a(55454)),o=a(86723),l=n(a(77043)),d=a(17754),c=a(35339),u=a(88300),h=n(a(69635));function f(){return(f=(0,i.default)((function*(e,t,a,n,i){const s=(0,o.getMaybeMeUser)(),r=p(e,t,a,n,i);if(h.default.equals(e.id,s))return(0,c.addAndSendMsgToChat)(e,r)[0].then((()=>{})).catch((e=>{throw __LOG__(3)`Order message send to chat failure: ${e}`,e}));try{const t=yield(0,c.addAndSendMsgToChat)(e,r)[1];if(!t||t!==u.SendMsgResult.OK)throw new Error("Order message SendMsgResult failure status")}catch(e){throw __LOG__(3)`Order message send to chat failure: ${e}`,e}}))).apply(this,arguments)}function p(e,t,a,n,i){const c=(0,o.getMaybeMeUser)(),u={type:"order",ack:r.default.ACK.CLOCK,from:c,id:new l.default({from:c,to:e.id,id:(0,d.newTag)(),participant:void 0,selfDir:"out"}),local:!0,isNewMsg:!0,self:"out",t:s.Clock.globalUnixTime(),to:e.id,orderId:t.id,token:t.token,orderTitle:e.name||e.formattedTitle,sellerJid:e.id.toString({legacy:!0}),thumbnail:n,itemCount:a,message:i},h=t.price.total;return h&&h.length>0&&(u.totalAmount1000=parseInt(h,10)),t.price.currency&&t.price.currency.length>0&&(u.totalCurrencyCode=t.price.currency),u}},17959:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.setPushname=function(e){return p(e)};var i=n(a(48926)),s=a(61295),r=a(6467),o=a(69162),l=a(9322),d=n(a(2408)),c=n(a(66743)),u=a(14403),h=a(12825),f=a(85893);function p(){return m.apply(this,arguments)}function m(){return(m=(0,i.default)((function*(e,t=(0,r.genId)()){const a=(0,c.default)(e),n=new r.ActionType(d.default.t(132)),i=l.Conn.pushname,m=a.then((()=>new r.ActionType(d.default.t(130),{actionText:d.default.t(144),actionHandler:()=>p(i,t)}))).catch((0,s.filteredCatch)(h.ServerStatusCodeError,(e=>{if(e.status>=400)return new r.ActionType(d.default.t(131))}))).catch((()=>{throw __LOG__(3)`models:conn:setPushname dropped`,new r.ActionType(d.default.t(131),{actionText:d.default.t(140),actionHandler:()=>p(status,t)})}));o.Cmd.openToast((0,f.jsx)(r.ActionToast,{id:t,initialAction:n,pendingAction:m}));(yield a)._duplicate||(0,u.setPushnameLocally)(e)}))).apply(this,arguments)}},88253:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){i.Cmd.openToast((0,o.jsx)(r.Toast,{msg:s.default.t(437),duration:6e3,id:(0,r.genId)()}))};var i=a(69162),s=n(a(2408)),r=a(49201),o=a(85893)},51902:(e,t,a)=>{"use strict";var n=a(20862),i=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return E.apply(this,arguments)};var s=i(a(48926)),r=a(78167),o=a(60028),l=a(25142),d=i(a(55454)),c=a(86723),u=i(a(99441)),h=i(a(77043)),f=i(a(2297)),p=i(a(52937)),m=a(9930),g=a(17754),v=a(35339),C=a(88300),_=i(a(69635)),x=a(89573),S=n(a(88643));function y(e,t){var a,n;if(null==t)return"";const i=o.CatalogCollection.get((0,x.createWid)(e)),s=null==i?void 0:i.productCollection.get(t),r=null==s||null===(a=s.getProductImageCollectionHead())||void 0===a?void 0:a.mediaData.preview;return r instanceof p.default&&null!==(n=r.getBase64())&&void 0!==n?n:""}function E(){return(E=(0,s.default)((function*(e){var t;const a=(0,c.getMaybeMeUser)(),{order:n,chat:i,message:s,discount:o,shipping:p,tax:x}=e,E=1e3,j=(0,r.randomHex)(16).substring(0,10),I=null===(t=n.orderItemCollection.head())||void 0===t?void 0:t.id,T=y(n.sellerJid,I),b=n.orderItemCollection.map((e=>({retailer_id:e.id,name:e.name,amount:{value:e.price,offset:E},quantity:e.quantity}))),P={reference_id:j,currency:n.currency,total_amount:{value:Number(n.total),offset:E},order:{status:m.OrderStatus.Pending,items:b,subtotal:{value:Number(n.subtotal),offset:E},tax:{value:Number(x),offset:E},shipping:{value:Number(p),offset:E},discount:{value:Number(o),offset:E}}},M={type:d.default.MSG_TYPE.INTERACTIVE,ack:d.default.ACK.CLOCK,from:a,id:new h.default({from:a,to:i.id,id:(0,g.newTag)(),participant:void 0,selfDir:"out"}),local:!0,isNewMsg:!0,self:"out",t:l.Clock.globalUnixTime(),to:i.id,caption:s,nativeFlowName:f.default.ORDER_DETAILS,interactiveHeader:{title:void 0,subtitle:void 0,mediaType:void 0,hasMediaAttachment:!1,thumbnail:T},interactiveType:u.default.NATIVE_FLOW,interactivePayload:{buttons:[{name:"review_and_pay",buttonParamsJson:S.stringify(P)}],messageVersion:1}};if(_.default.equals(i.id,a))try{return void(yield(0,v.addAndSendMsgToChat)(i,M)[0])}catch(e){throw __LOG__(3)`Order message send to chat failure: ${e}`,e}try{const e=yield(0,v.addAndSendMsgToChat)(i,M)[1];if(!e||e!==C.SendMsgResult.OK)throw new Error("Order message SendMsgResult failure status")}catch(e){throw __LOG__(3)`Order message send to chat failure: ${e}`,e}}))).apply(this,arguments)}},59603:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.privacyWebNameToServerName=function(e){switch(e){case"readReceipts":return"readreceipts";case"groupAdd":return"groupadd";case"profilePicture":return"profile";case"about":return"status";case"lastSeen":return"last"}},t.setPrivacyForOneCategory=function(){return p.apply(this,arguments)};var i=n(a(81109)),s=n(a(48926)),r=a(86723),o=n(a(91619)),l=a(29518),d=a(20749),c=a(94226),u=a(12825);function h(e){switch(e){case"readreceipts":return"readReceipts";case"groupadd":return"groupAdd";case"profile":return"profilePicture";case"status":return"about";case"last":return"lastSeen"}}function f(e){switch(e){case"status":return l.PrivacyDisallowedListType.About;case"groupadd":return l.PrivacyDisallowedListType.GroupAdd;case"last":return l.PrivacyDisallowedListType.LastSeen;case"profile":return l.PrivacyDisallowedListType.ProfilePicture;default:throw new Error("castToPrivacyDisallowedListType: invalid name")}}function p(){return(p=(0,s.default)((function*(e,t){const a=yield(0,d.setPrivacy)([e]);if(1!==a.length)throw new Error("setPrivacy should return one response");const n=a[0];if(n instanceof u.ServerStatusCodeError)throw 409===n.statusCode&&"contact_blacklist"===e.value&&(yield(0,c.syncSinglePrivacyDisallowedList)(f(e.name))),n;const{name:s,value:p}=e,m=h(s);if((0,r.setUserPrivacySettings)((0,i.default)((0,i.default)({},(0,r.getUserPrivacySettings)()),{},{[m]:p})),"contact_blacklist"===p){const e={id:f(s),disallowedList:(0,o.default)(t,"contactExceptList").map((e=>e.toString())),dhash:(0,o.default)(n.dhash,"response.dhash")};yield(0,l.getTable)().createOrReplace(e)}}))).apply(this,arguments)}},88515:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getIdentityVerificationDataJob=function(e){return(0,s.NonPersistJob)("getIdentityVerificationData",(e=>(0,i.getIdentityVerificationData)(e)),{priority:n.JOB_PRIORITY.SKIP}).waitUntilCompleted({jid:e})};var n=a(33500),i=a(51670),s=a(65344)},20749:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.setPrivacy=function(){return h.apply(this,arguments)},t.PrivacyUserAction=void 0;var i=n(a(48926)),s=a(10817),r=a(41118),o=a(84922),l=a(49438),d=a(12825);const c=new r.WapParser("setPrivacyParser",(e=>e.child("privacy").mapChildrenWithTag("category",(e=>{if("error"===e.attrString("value")){const t=e.child("error");return new d.ServerStatusCodeError(t.attrInt("code"),t.attrString("text"))}return{name:e.attrString("name"),value:e.attrString("value"),dhash:e.maybeAttrString("dhash")}})))),u=a(54302)({Add:"add",Remove:"remove"});function h(){return(h=(0,i.default)((function*(e){const t=e.map((e=>{const{name:t,value:a,users:n,dhash:i}=e;return(0,s.wap)("category",{name:(0,s.CUSTOM_STRING)(t),value:(0,s.CUSTOM_STRING)(a),dhash:null==n?s.DROP_ATTR:(0,s.CUSTOM_STRING)(null!=i?i:"none")},null==n?null:n.map((({action:e,wid:t})=>(0,s.wap)("user",{action:(0,s.CUSTOM_STRING)(e),jid:(0,l.JID)(t)}))))})),a=yield(0,o.sendIq)((0,s.wap)("iq",{to:s.S_WHATSAPP_NET,type:"set",xmlns:"privacy",id:(0,s.generateId)()},(0,s.wap)("privacy",null,t)),c);if(!0===a.success)return a.result;throw new d.ServerStatusCodeError(a.errorCode,a.errorText)}))).apply(this,arguments)}t.PrivacyUserAction=u},66557:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.sendSupportRequest=function(){return f.apply(this,arguments)};var i=n(a(48926)),s=a(10817),r=a(41118),o=a(28047),l=a(84922),d=a(86723),c=a(49438);function u(e,t){__LOG__(3,void 0,void 0,!0)`supportRequest error: code=${e} message=${null!=t?t:""}`,SEND_LOGS("supportRequest")}const h=new r.WapParser("supportResponse",(e=>{const t=e.child("response");if(t.hasAttr("error_code")){return{type:"error",errorCode:t.attrInt("error_code",0,1e3)}}t.assertAttr("status","ok");return{type:"success",message:t.child("message").contentString(),ticketId:t.child("ticket_id").contentString()}}));function f(){return(f=(0,i.default)((function*(e,t){const a=(0,s.wap)("iq",{from:(0,c.USER_JID)((0,d.getMeUser)()),id:(0,s.generateId)(),smax_id:"3",to:s.S_WHATSAPP_NET,type:"set",xmlns:"fb:thrift_iq"},(0,s.wap)("description",null,e),null!=t?(0,s.wap)("debug_information_json",null,t):null),n=yield(0,l.sendIq)(a,h);let i;if(n.success){var r;const{result:e}=n;return"success"===e.type?(null!=t&&(__LOG__(2)`InAppSupport: Uploading logs for ticketId=${e.ticketId}`,(0,o.upload)({reason:"user-report",immediate:!0,force:!0,persist:!0,ticketId:e.ticketId}).then((t=>{__LOG__(2)`InAppSupport: Logs upload complete for ticketId=${e.ticketId}, logsId=${t}`}))),{type:"success",message:e.message,ticketId:e.ticketId}):(i=null!==(r=e.errorCode)&&void 0!==r?r:400,u(i),{type:"error",errorCode:i})}return u(n.errorCode,n.errorText),{type:"error",errorCode:n.errorCode}}))).apply(this,arguments)}},51670:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.getIdentityVerificationData=function(){return S.apply(this,arguments)};var i=n(a(48926)),s=a(31509),r=a(29292),o=a(96178),l=a(85103),d=a(86723),c=a(28535),u=n(a(59e3)),h=a(88165);const f=/^([17]|2[07]|3[0123469]|4[013456789]|5[12345678]|6[0123456]|8[1246]|9[0123458]|\d{3})\d*?(\d{4,6})$/;function p(e){const t=f.exec(function(e){return e.user.split("@")[0]}(e));return s.Binary.build(t?t[1]+t[2]:e.toString()).readByteArray()}function m(e,t){return`00000${256*e.getUint32(t,!1)+e.getUint8(t+4)}`.slice(-5)}function g(){return v.apply(this,arguments)}function v(){return(v=(0,i.default)((function*(e,t){let a=Promise.resolve(s.Binary.build(0,0,t,e).readByteArray());for(let e=0;e<5200;e++)a=a.then((e=>self.crypto.subtle.digest({name:"SHA-512"},s.Binary.build(e,t).readByteArray())));const n=yield a,i=new DataView(n instanceof ArrayBuffer?n.slice(0,30):n.slice(0,30).buffer);return[m(i,0),m(i,5),m(i,10),m(i,15),m(i,20),m(i,25)].join("")}))).apply(this,arguments)}function C(){return _.apply(this,arguments)}function _(){return(_=(0,i.default)((function*(e,t,a,n){return(yield Promise.all([g(e,t),g(a,n)])).sort().join("")}))).apply(this,arguments)}function x(e,t,a,n){const i=new s.Binary;return(0,r.encodeProtobuf)(l.CombinedFingerprintSpec,{version:0,localFingerprint:{publicKey:t,identifier:e},remoteFingerprint:{publicKey:n,identifier:a}},i),i.readBuffer()}function S(){return(S=(0,i.default)((function*({jid:e}){const t=(0,d.assertGetMe)(),a=yield(0,o.getFanOutListJob)([e,t]);try{yield(0,c.ensureE2ESessions)(a)}catch(e){__LOG__(4,void 0,new Error)`ensureE2ESessions with error`}const n=[],i=[];a.forEach((e=>{e.user===t.user?i.push(e):n.push(e)}));try{const t=yield(0,h.getAllIdentityKeysBytesOrThrow)(n),a=yield(0,h.getAllIdentityKeysBytesOrThrow)(i),s=yield u.default.getIdentityKeyPair();if(!s)return __LOG__(3)`getIdentityVerificationData: missing identity for device verification`,null;a.push(new Uint8Array(s.pubKey));const r=(0,h.identityKeysToBinary)(a),o=(0,h.identityKeysToBinary)(t),l=p((0,d.getMeUser)()),c=p(e),f=yield Promise.all([C(l,r,c,o),x(l,r,c,o)]);if(null==f)return null;const[m,g]=f;return{binary:g,string:m}}catch(e){return __LOG__(3)`getIdentityVerificationData: error ${e} when trying to generate identtiy QR code`,null}}))).apply(this,arguments)}},85148:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.editBusinessCompliance=t.editBusinessProfile=void 0;var i=a(18149),s=a(12950),r=a(26311),o=a(60805),l=a(77828),d=n(a(865));t.editBusinessProfile=e=>{let t;return(0,r.qplPointProfileSave)("datasource_start"),s.GK.supportsFeature(s.GK.F.MD_BACKEND)?(t=(0,i.editBusinessProfile)(e),t||(t=Promise.reject(new Error("md business profile edit not supported")))):t=(0,l.editBusinessProfile)(e),t.then((()=>{(0,r.qplPointProfileSave)("datasource_end")})),t};t.editBusinessCompliance=e=>{let t;return s.GK.supportsFeature(s.GK.F.MD_BACKEND)?(t=(0,o.setMerchantCompliance)(e),t||(t=Promise.reject(new Error("md business compliance profile called from a non-md build")))):t=d.default.editBusinessComplianceWebd(e),t}},77828:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.editBusinessProfile=t.convertProfileToRequestData=void 0;var i=n(a(81109)),s=n(a(48926)),r=n(a(4321)),o=a(12825),l=a(72787);const d=e=>{if(!e)return;return{category:e.map((({id:e})=>({id:e})))}},c=e=>{if(!e)return;const{note:t,timezone:a,config:n}=e,i=[];for(const e in n){const t=n[e],{mode:a,hours:s}=t;if(s)for(const[t,n]of s)i.push({day_of_week:e,mode:a,open_time:t,close_time:n});else i.push({day_of_week:e,mode:a})}return{timezone:a,business_hours_note:t,business_hours_config:i}},u=({address:e,description:t,email:a,website:n,businessHours:i,categories:s})=>{const o=(0,r.default)({address:e,description:t,email:a,website:n,business_hours:c(i),categories:d(s)});return Object.keys(o).length>0?o:void 0};t.convertProfileToRequestData=u;const h=function(){var e=(0,s.default)((function*(e){const t=u(e);if(!t)return void __LOG__(3)`empty profile received, ignoring save`;const a=(0,i.default)({v:2},t);try{const e=yield l.Socket.send2({data:["action","editBusinessProfile",a],retryOn5xx:!0}),{status:t}=e;if((e=>e>=200&&e<=299)(t))return;throw __LOG__(3)`error editing business profile webd: ${t}`,new o.ServerStatusCodeError(t,"edit business profile")}catch(e){const t=e;throw __LOG__(3)`error editing business profile: ${t}`,t}}));return function(){return e.apply(this,arguments)}}();t.editBusinessProfile=h},66743:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return h.apply(this,arguments)};var i=n(a(48926)),s=a(18616),r=a(12950),o=n(a(72363)),l=n(a(59961)),d=a(78487),c=n(a(865)),u=a(12825);function h(){return(h=(0,i.default)((function*(e){if(r.GK.supportsFeature(r.GK.F.MD_BACKEND)&&e){const t=(0,s.unixTimeMs)(),a=o.default.getPushnameMutation(t,e);return(0,l.default)(e),(0,d.lockForSync)([],[a],(()=>Promise.resolve())).then((()=>({_duplicate:null})))}const t=yield c.default.setPushname(e);if(t.status&&200!==t.status)throw new u.ServerStatusCodeError(t.status);return{_duplicate:t._duplicate}}))).apply(this,arguments)}},88281:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LoadType=t.EditType=void 0;const n=a(54302).Mirrored(["EDITING","PENDING","DONE","ERROR"]);t.EditType=n;const i=a(54302).Mirrored(["PENDING","DONE","ERROR"]);t.LoadType=i},85103:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CombinedFingerprintSpec=t.FingerprintDataSpec=void 0;var n=a(73371);const i={};t.FingerprintDataSpec=i;const s={};t.CombinedFingerprintSpec=s,i.internalSpec={publicKey:[1,n.TYPES.BYTES],identifier:[2,n.TYPES.BYTES]},s.internalSpec={version:[1,n.TYPES.UINT32],localFingerprint:[2,n.TYPES.MESSAGE,i],remoteFingerprint:[3,n.TYPES.MESSAGE,i]}},10297:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.BusinessAddressField=function({businessProfile:e,activeField:t,rawBusinessProfile:a,sessionId:n,value:i,validate:r,error:l,lowProfile:h=!0,onActive:f,onChange:p,onSaveBusinessProfile:g,onError:v,onCancel:C}){const _=(0,c.jsx)(s.BusinessProfileFormField,{activeField:t,fieldKey:"address",fieldMetric:d.default.BUSINESS_PROFILE_FIELD.ADDRESS,formatForSave:()=>({address:i}),lowProfile:h,originalValue:e.address,placeholder:o.default.t(385),rawBusinessProfile:a,sessionId:n,textFieldConfig:{maxLength:u.ADDRESS},value:i,validate:r,error:l,onActive:f,onChange:p,onSaveBusinessProfile:g,onError:v,onCancel:C}),{latitude:x,longitude:S}=e,y=null!=x&&null!=S?(0,c.jsx)(m,{activeField:t,value:i,latitude:x,longitude:S}):null;return(0,c.jsxs)(c.Fragment,{children:[_,y]})};var i=n(a(56720)),s=a(60731),r=n(a(55454)),o=n(a(2408)),l=n(a(23958)),d=n(a(4231)),c=a(85893);const{BUSINESS_PROFILE_FIELDS_LENGTH:u}=r.default,h={position:"g0rxnol2",display:"p357zi0d",alignItems:"gndfcl4n",justifyContent:"ac2vgrno",paddingTop:"ppypbuwx",paddingEnd:"fhfm09ip",paddingBottom:"s8gyl5p1",paddingStart:"mjn2akup",marginTop:"c6axuxzh",marginEnd:"jnwc1y2a",marginBottom:"mpdn4nr2",marginStart:"svoq16ka"},f={position:"lhggkp7q",top:"qq0sjtgm",right:"grt5ktjy",bottom:"jxacihee",left:"tukmaf4q",display:"p357zi0d",alignItems:"gndfcl4n",justifyContent:"ac2vgrno"},p={paddingTop:"fbgy3m38",paddingEnd:"bcymb0na",paddingBottom:"oq31bsqd",paddingStart:"e8k79tju",fontSize:"f8jlpxt4",color:"o4oavg8t",textTransform:"ofejerhi",backgroundColor:"o8fg3bdd",borderTop:"dl47i6rc",borderEnd:"pdo9fnbd",borderBottom:"n8n2xqzm",borderStart:"hqx4twni",borderTopStartRadius:"g1jn521u",borderTopEndRadius:"mrnekr2l",borderBottomEndRadius:"wu0i2wpa",borderBottomStartRadius:"bbs9k8l5"};function m({activeField:e,latitude:t,longitude:a,value:n}){const s="address"===(null==e?void 0:e.fieldKey)?(0,c.jsx)("div",{className:(0,i.default)(f),children:(0,c.jsx)("div",{className:(0,i.default)(p),children:o.default.t(391)})}):null;return(0,c.jsxs)("div",{style:{height:96},className:(0,i.default)(h),children:[s,(0,c.jsx)(l.default,{lat:t,lng:a,name:n,width:312,height:96})]})}},88743:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{businessHours:{note:t,timezone:a}}=e,[n,E]=(0,o.useState)(e.businessHours.mode||S),[j,I]=(0,o.useState)((()=>{const{days:t}=e.businessHours,a={};for(const{dayKey:e,closed:n,hours:i,dayName:s}of t)a[e]={closed:n,hours:i||[y()],dayKey:e,dayName:s};return a})),T=(e,t)=>{const a=j[e];I((0,s.default)((0,s.default)({},j),{},{[e]:(0,s.default)((0,s.default)({},a),t)}))},b=(e,t,a,n)=>{const i=[...e],s=a===x.START?0:1,r=[...i[n]];return r[s]=t,i[n]=r,i},P=({dayKey:e})=>`${e}_business_hours`,M=e=>(0,_.jsx)("div",{className:l.default.timeWrapper,children:(0,_.jsx)(c.default,{"aria-label":r.fbt._("Add additional hours",null,{hk:"1RUQxq"}),label:u.default.t(159),onClick:()=>{(e=>{const t=j[e],{hours:a}=t;T(e,{hours:[...a,y()]})})(e)},prefixIcon:"status-ciphertext",iconTheme:"padded-svg"})}),w=e=>(0,_.jsx)("div",{className:l.default.timeWrapper,children:(0,_.jsx)(m.default,{title:u.default.t(1560),"aria-label":u.default.t(1560),name:"x-alt",onClick:()=>{(e=>{const t=j[e],{hours:a}=t,n=[...a];n.pop(),T(e,{hours:n})})(e)}})}),L=e=>{const{closed:t,dayKey:a}=e,n=P(e);return(0,_.jsx)("div",{className:l.default.dayCheckbox,children:(0,_.jsx)(d.CheckBox,{id:n,checked:!t,onChange:()=>{const e=j[a];T(a,{closed:!e.closed})}})})},k=(e,t,a,n)=>{const i=(0,C.isValidTime)(t)?null:" ";return(0,_.jsx)("div",{className:l.default.timeWrapper,children:(0,_.jsx)(v.TextInput,{managed:!0,value:t,theme:"small",maxLength:15,customStyleThemes:["desaturated","noErrorInfo"],error:i,onChange:t=>{const i=j[e],{hours:s}=i;T(e,{hours:b(s,t,a,n)})},onBlur:()=>{((e,t,a)=>{const n=j[e],{hours:i}=n,s=t===x.START?0:1,r=i[a][s],o=(0,C.timeStringToMinutes)(r);void 0!==o&&T(e,{hours:b(i,(0,C.minutesToTime)(o),t,a)})})(e,a,n)}})},`${e}-${a}-${n}`)},O=e=>{const{closed:t}=e;let a;return t?a=u.default.t(351):n===f.BUSINESS_HOUR_MODES.APPOINTMENT_ONLY?a=u.default.t(349):n===f.BUSINESS_HOUR_MODES.OPEN_24H&&(a=u.default.t(364)),a?(0,_.jsx)("div",{className:l.default.dayInfoText,children:a}):f.BUSINESS_HOUR_MODES.SPECIFIC_HOURS&&!e.closed?(({dayKey:e,hours:t})=>{const a=[],n=t.length>=2?w(e):M(e);return t.forEach((([t,n],i)=>{i>0&&a.push((0,_.jsx)("div",{className:l.default.hoursAnd,children:u.default.t(348)})),a.push(k(e,t,x.START,i),k(e,n,x.END,i))})),(0,_.jsxs)("div",{className:l.default.hoursMain,children:[a,n]})})(e):null},A=e=>{const{dayName:t}=e,a=P(e);return(0,_.jsxs)("div",{className:l.default.dayInfo,children:[(0,_.jsx)("label",{htmlFor:a,children:t}),O(e)]})},D=(()=>{const{businessHours:{days:t}}=e;return(0,_.jsxs)("div",{children:[(0,_.jsx)(g.default,{onSelect:e=>{E(e);const t={};if(n===f.BUSINESS_HOUR_MODES.OPEN_24H){for(const e of f.DAYS_OF_WEEK)t[e]=(0,s.default)((0,s.default)({},j[e]),{},{closed:!1});I(t)}},selectedId:n,tabConfigs:[{title:u.default.t(361),id:f.BUSINESS_HOUR_MODES.SPECIFIC_HOURS},{title:u.default.t(357),id:f.BUSINESS_HOUR_MODES.OPEN_24H},{title:u.default.t(358),id:f.BUSINESS_HOUR_MODES.APPOINTMENT_ONLY}]}),(0,_.jsx)("div",{className:l.default.editMain,children:t.map((({dayKey:e})=>{const t=j[e];return a=t,(0,_.jsxs)("div",{className:l.default.dayMain,children:[L(a),A(a)]},`day-${a.dayKey}`);var a}))})]})})();return(0,_.jsx)(p.default,{title:u.default.t(359),isValid:(0,C.isValidBusinessHours)(n,j),doSave:(0,i.default)((function*(){(0,h.qplStartProfileSave)("bizHours"),yield e.saveBusinessProfile((0,C.convertToRawBusinessProfile)({mode:n,dayValues:j,note:t,timezone:a}))})),afterSave:e.afterSave,onCancel:e.onCancel,children:D})};var i=n(a(48926)),s=n(a(81109)),r=a(48360),o=a(67294),l=n(a(87009)),d=a(33287),c=n(a(70775)),u=n(a(2408)),h=a(90676),f=a(25349),p=n(a(33215)),m=n(a(40858)),g=n(a(20128)),v=a(29458),C=a(83607),_=a(85893);const x=a(54302).Mirrored(["START","END"]),S=f.BUSINESS_HOUR_MODES.SPECIFIC_HOURS,y=()=>[(0,C.minutesToTime)(540),(0,C.minutesToTime)(1080)]},25349:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"RawBusinessProfile",{enumerable:!0,get:function(){return n.RawBusinessProfile}}),Object.defineProperty(t,"BUSINESS_HOUR_MODES",{enumerable:!0,get:function(){return i.BUSINESS_HOUR_MODES}}),Object.defineProperty(t,"DAYS_OF_WEEK",{enumerable:!0,get:function(){return i.DAYS_OF_WEEK}});var n=a(47094),i=a(4650)},83607:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"minutesToTime",{enumerable:!0,get:function(){return i.minutesToTime}}),Object.defineProperty(t,"timeStringToMinutes",{enumerable:!0,get:function(){return i.timeStringToMinutes}}),t.convertToRawBusinessProfile=t.isValidBusinessHours=t.isValidTime=void 0;var n=a(25349),i=a(13822);const s=e=>void 0!==(0,i.timeStringToMinutes)(e);t.isValidTime=s;t.isValidBusinessHours=(e,t)=>{if(e===n.BUSINESS_HOUR_MODES.SPECIFIC_HOURS)for(const e in t){const a=t[e],{closed:n,hours:i}=a;if(!n)for(const[e,t]of i)if(!s(e)||!s(t))return!1}return!0};t.convertToRawBusinessProfile=({mode:e,dayValues:t,note:a,timezone:s})=>{const r={};for(const a in t){const s=t[a],{closed:o,hours:l}=s;if(!o){const t={mode:e};e===n.BUSINESS_HOUR_MODES.SPECIFIC_HOURS&&(t.hours=l.map((([e,t])=>[(0,i.timeStringToMinutes)(e)||0,(0,i.timeStringToMinutes)(t)||0]))),r[a]=t}}return{businessHours:{config:r,note:a,timezone:s||Intl.DateTimeFormat().resolvedOptions().timeZone}}}},60731:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.BusinessProfileFormField=function({activeField:e,error:t,fieldKey:a,fieldMetric:n,formatForSave:c,lowProfile:u,originalValue:h,placeholder:f,rawBusinessProfile:p,sessionId:m,startActive:g,textFieldConfig:v,validate:C,value:_,onActive:x,onChange:S,onError:y,onSaveBusinessProfile:E,onCancel:j}){const I=(null==e?void 0:e.fieldKey)===a,T=_?void 0:f;return(0,d.jsx)(l.TextInput,(0,i.default)({value:_,editable:!e||I,pending:I&&(null==e?void 0:e.editType)===o.EditType.PENDING,showRemaining:!0,onBeginEdit:()=>{null!=m&&(0,s.logProfileFieldOpen)(n,p,m),x({fieldKey:a,editType:o.EditType.EDITING})},onChange:S,onSave:()=>{(0,r.qplStartProfileSave)(a),null!=m&&(0,s.logProfileFieldSave)(n,p,m),x({fieldKey:a,editType:o.EditType.PENDING}),E(c()).then((()=>{x()}),(()=>{x()}))},onCancel:()=>{null!=m&&(0,s.logProfileFieldDiscard)(n,p,m),S(h),x(),null==j||j()},lockable:!0,lowProfile:u,multiline:!0,inputPlaceholder:T,theme:"text-input",validate:C,onError:y,error:t,a8n:`biz-profile-${a}-input`,fieldName:f,startActive:g},v))};var i=n(a(81109)),s=a(31661),r=a(90676),o=(n(a(4231)),a(47094)),l=a(29458),d=a(85893)},55409:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const[t,a]=(0,o.useState)(e.initialCategories),[n,i]=(0,o.useState)(!1),[r,l]=(0,o.useState)(!1),[h,m]=(0,o.useState)([]),g=()=>{p.Cmd.openToast((0,T.jsx)(j.Toast,{id:(0,j.genId)(),msg:C.default.t(379)}))},v=e=>{for(let a=0;a<t.length;a++)if(t[a].id===e)return!0;return!1},E=e=>{const n=h.find((e=>e.not_a_biz)),i=t.find((e=>e.id===(null==n?void 0:n.id)));let s=t;t.length>0&&(e.not_a_biz&&!i?(s=[],g()):!e.not_a_biz&&i&&(s=t.filter((e=>e.id!==i.id)),g())),v(e.id)?a(s.filter((t=>t.id!==e.id))):a([...s,e])},I=t=>{l(!0),e.searchCategories(t||d.BUSINESS_CATEGORY_EMPTY_STR_ID).then((e=>{let a=e.categories;""!==t&&(a=a.filter((e=>!e.not_a_biz))),l(!1),m(a),(0,x.qplAnnotateProfileCatsView)(a.length),(0,x.qplEndProfileCatsView)(S.QuickLogActionType.SUCCESS)})).catch((()=>{p.Cmd.openToast((0,T.jsx)(j.Toast,{id:(0,j.genId)(),msg:C.default.t(378)})),l(!1),m([]),(0,x.qplEndProfileCatsView)(S.QuickLogActionType.FAIL)}))};return(0,o.useEffect)((()=>{I("")}),[]),(0,T.jsxs)(y.default,{title:C.default.t(380),isValid:t.length>0,doSave:(0,s.default)((function*(){(0,x.qplStartProfileSave)("categories"),yield e.saveBusinessProfile({categories:t})})),afterSave:()=>{i(!0),e.afterSave()},onCancel:()=>{i(!0),e.onCancel()},children:[(0,T.jsx)("div",{className:u.default.searchBackground,children:(0,T.jsx)(_.default,{onSearch:e=>{r||n||((0,x.qplStartProfileCatsView)("Search"),I(e))},placeholder:C.default.t(401)})}),(0,T.jsxs)("div",{className:u.default.editMain,children:[(0,T.jsx)("div",{className:u.default.list,children:(0,T.jsx)(M,{isLoading:r,results:h,isSelected:v,isDisabled:e=>!e.not_a_biz&&!v(e.id)&&t.length>=c.MAX_BUSINESS_CATEGORIES,toggleResultById:e=>{const t=h.filter((t=>t.id===e))[0];t&&E(t)}})}),t&&(0,T.jsx)(f.default,{categories:t,onRemoveItem:e=>{const a=t.filter((t=>t.id===e))[0];a&&E(a)}})]})]})};var i=n(a(81109)),s=n(a(48926)),r=n(a(94184)),o=a(67294),l=n(a(76610)),d=a(32816),c=a(42097),u=n(a(50743)),h=a(33287),f=n(a(52349)),p=a(69162),m=a(86025),g=n(a(19257)),v=n(a(67893)),C=n(a(2408)),_=n(a(55325)),x=a(90676),S=a(21125),y=n(a(33215)),E=a(46714),j=a(49201),I=n(a(79939)),T=a(85893);function b({category:e,toggleResultById:t}){return(0,T.jsxs)("div",{className:u.default.rowMain,children:[(0,T.jsx)("div",{className:u.default.rowCheckbox,children:(0,T.jsx)(h.CheckBox,{id:`${e.id}`,onChange:()=>{!e.disabled&&t(e.id)},checked:e.selected,disabled:e.disabled})}),(0,T.jsx)("label",{"data-a8n":l.default.key("category-list-item"),className:(0,r.default)(u.default.rowLabel,{[u.default.disabled]:e.disabled}),htmlFor:e.id,children:e.localized_display_name})]})}function P({label:e}){return(0,T.jsxs)("div",{className:u.default.rowMain,children:[(0,T.jsx)("div",{className:u.default.rowCheckbox}),e]})}function M({isLoading:e,results:t,isSelected:a,isDisabled:n,toggleResultById:s}){const r=(0,I.default)((()=>new v.default));if(e)return(0,T.jsx)("div",{className:u.default.loadingSpinner,children:(0,T.jsx)(E.Spinner,{color:"highlight",size:44,stroke:6})});if(!t||0===t.length)return(0,T.jsx)(P,{label:C.default.t(399)});const o=t.map((e=>(0,i.default)((0,i.default)({},e),{},{id:e.id,itemKey:e.id.toString(),disabled:n(e),selected:a(e.id)})));return(0,T.jsx)(g.default,{flatListControllers:[r.current],children:(0,T.jsx)(m.FlatList,{data:o,flatListController:r.current,direction:"vertical",renderItem:e=>(0,T.jsx)(b,{category:e,toggleResultById:s}),defaultItemHeight:48})})}},50586:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a(81109)),s=a(26593),r=a(67294),o=n(a(56720)),l=n(a(76610)),d=a(10297),c=a(54100),u=n(a(95103)),h=n(a(88743)),f=a(60731),p=a(4650),m=n(a(55409)),g=a(69162),v=a(47898),C=n(a(55454)),_=n(a(25061)),x=n(a(76482)),S=a(86723),y=a(78615),E=a(14179),j=n(a(2408)),I=a(31661),T=a(90676),b=n(a(4231)),P=(a(47094),a(72274)),M=a(1458),w=a(81465),L=a(85893);const k={color:"ky3f94nk",fontSize:"f8jlpxt4",textTransform:"ofejerhi"},O={flexGrow:"gj6qtt9u",flexShrink:"m0h2a7mj",flexBasis:"rjo8vgbg",textTransform:"aprpv14t"},A={display:"p357zi0d"},D={flexGrow:"a6lcuizr",flexShrink:"m0h2a7mj",flexBasis:"rjo8vgbg"},R={color:"t35qvd06",fontSize:"dsh4tgtl",lineHeight:"jgi8eev7",marginTop:"dkeqio29"},{BUSINESS_PROFILE_FIELDS_LENGTH:N}=C.default;t.default=({businessProfile:e,saveBusinessProfile:t,sessionId:a,verifiedName:n})=>{const[C,F]=(0,r.useState)(),[B,U]=(0,r.useState)(),[H,G]=(0,r.useState)(),[V,W]=(0,r.useState)(),[z,K]=(0,r.useState)(),[q,Y]=(0,r.useState)(),[Q,X]=(0,r.useState)(),[Z,$]=(0,r.useState)(),[J,ee]=(0,r.useState)(),[te,ae]=(0,r.useState)(!1),ne=(0,S.getMeUser)(),ie=(0,y.canSeeECommerceComplianceIndiaHardEnforcementBusinessJourney)(ne.user),[se,re]=(0,r.useState)();(0,r.useEffect)((()=>{const t=(0,P.convertRawBusinessProfile)(e);F(t.description),G(t.email),U(t.address),W(t.primaryWebsite),K(t.secondaryWebsite),Y(Boolean(t.primaryWebsite&&!t.secondaryWebsite))}),[e]),(0,r.useEffect)((()=>{(0,w.validateEmail)(H)&&X(null)}),[H]),(0,r.useEffect)((()=>{(0,w.validateURL)(V)&&$(null)}),[V]),(0,r.useEffect)((()=>{(0,w.validateURL)(z)&&ee(null)}),[z]);const oe=()=>{const e=[];return V&&e.push(V),z&&e.push(z),{website:e.map(((e,t)=>{if(!M.URL.isHttps(e)&&!M.URL.isHttp(e)){const a=`https://${e}`;return 0===t?W(a):K(a),a}return e}))}},le=e=>(0,L.jsx)(E.IconSection,(0,i.default)((0,i.default)({},e),{},{hideEditIcon:Boolean(se)})),de=(e,t,a)=>{if(t)return j.default.t(351);switch(e){case p.BUSINESS_HOUR_MODES.SPECIFIC_HOURS:return(0,L.jsx)(L.Fragment,{children:a&&a.map((([e,t],a)=>(0,L.jsxs)("div",{className:(0,o.default)(0!==a&&s.uiMargin.top16),"data-a8n":l.default.key("business-hours-time"),children:[e," - ",t]},a)))});case p.BUSINESS_HOUR_MODES.APPOINTMENT_ONLY:return j.default.t(349);case p.BUSINESS_HOUR_MODES.OPEN_24H:return j.default.t(364);default:return null}},ce=(0,r.useCallback)((()=>ie?(0,u.default)():void 0),[ie]),ue=(0,P.convertRawBusinessProfile)(e);let he,fe=j.default.t(396);return(0,y.canSeeBizProfileV3)()&&(fe=null,he=x.default.noPaddingTop),(0,L.jsxs)(_.default,{title:fe,theme:"refresh",className:he,children:[(e=>{if(!e)return null;const t=(0,y.canSeeBizProfileV3)()?E.IconSectionTheme.NoMargin:void 0;return le({theme:t,icon:"account-box",iconClass:x.default.verifiedNameIcon,content:(0,L.jsxs)("div",{children:[(0,L.jsx)("div",{children:e}),(0,L.jsx)("div",{className:(0,o.default)(R),children:j.default.t(398)})]})})})(n),le({icon:"business-description",content:(0,L.jsx)(f.BusinessProfileFormField,{activeField:se,fieldKey:"description",fieldMetric:b.default.BUSINESS_PROFILE_FIELD.DESCRIPTION,formatForSave:()=>({description:C}),lowProfile:!0,originalValue:ue.description,placeholder:j.default.t(388),rawBusinessProfile:e,sessionId:a,textFieldConfig:{maxLength:N.DESCRIPTION,supportsEmoji:!0},value:C,onActive:re,onChange:F,onSaveBusinessProfile:t})}),le({icon:"business-category",type:"container",emptyText:j.default.t(387),content:(pe=ue.categories,0===pe.length?null:(0,L.jsx)("div",{"data-a8n":l.default.key("biz-profile-category-input"),children:pe.map((e=>e.localized_display_name)).join(j.default.t(772))})),fieldName:j.default.t(387),onEdit:()=>{(0,T.qplStartProfileCatsView)("Profile"),(0,I.logProfileFieldOpen)(b.default.BUSINESS_PROFILE_FIELD.CATEGORY,e,a),g.Cmd.openModal((0,L.jsx)(m.default,{initialCategories:ue.categories,saveBusinessProfile:t,searchCategories:e=>c.BusinessCategoriesResultCollection.find(e),afterSave:()=>(0,I.logProfileFieldSave)(b.default.BUSINESS_PROFILE_FIELD.CATEGORY,e,a),onCancel:()=>{(0,I.logProfileFieldDiscard)(b.default.BUSINESS_PROFILE_FIELD.CATEGORY,e,a)}}))}}),le({icon:"business-address",content:(0,L.jsx)(d.BusinessAddressField,{businessProfile:ue,activeField:se,rawBusinessProfile:e,sessionId:a,value:B,onActive:re,onChange:U,onSaveBusinessProfile:t,validate:e=>(0,v.existsField)(e,ne),onError:ce})}),le({icon:"business-hours",type:"container",emptyText:j.default.t(386),content:(({mode:e,days:t})=>null==e?null:(0,L.jsx)("div",{children:t.map((({dayName:t,dayKey:a,closed:n,hours:i},r)=>(0,L.jsxs)("div",{className:(0,o.default)(A,0!==r&&s.uiMargin.top28),"data-a8n":l.default.key("business-hours-section-row"),children:[(0,L.jsx)("div",{className:(0,o.default)(O),children:t}),(0,L.jsx)("div",{className:(0,o.default)(D),children:de(e,n,i)})]},a)))}))(ue.hours),fieldName:j.default.t(386),onEdit:()=>{(0,I.logProfileFieldOpen)(b.default.BUSINESS_PROFILE_FIELD.HOURS,e,a),g.Cmd.openModal((0,L.jsx)(h.default,{businessHours:ue.hours,saveBusinessProfile:t,onCancel:()=>{(0,I.logProfileFieldDiscard)(b.default.BUSINESS_PROFILE_FIELD.HOURS,e,a)},afterSave:()=>(0,I.logProfileFieldSave)(b.default.BUSINESS_PROFILE_FIELD.HOURS,e,a)}))}}),le({icon:"business-email",content:(0,L.jsx)(f.BusinessProfileFormField,{activeField:se,error:Q,fieldKey:"email",fieldMetric:b.default.BUSINESS_PROFILE_FIELD.EMAIL,formatForSave:()=>({email:H}),lowProfile:!1,originalValue:ue.email,placeholder:j.default.t(389),rawBusinessProfile:e,sessionId:a,textFieldConfig:{maxLength:N.EMAIL},validate:e=>(0,w.validateEmail)(e),value:H,onActive:re,onChange:G,onError:()=>{X(j.default.t(838))},onSaveBusinessProfile:t})}),(n=>{const i=(0,L.jsx)(f.BusinessProfileFormField,{activeField:se,error:Z,fieldKey:"primaryWebsite",fieldMetric:b.default.BUSINESS_PROFILE_FIELD.WEBSITE,formatForSave:oe,lowProfile:!1,originalValue:n.primaryWebsite,placeholder:j.default.t(397),rawBusinessProfile:e,sessionId:a,textFieldConfig:{maxLength:N.WEBSITE},validate:w.validateURL,value:V,onActive:re,onChange:W,onError:()=>{$(j.default.t(846))},onSaveBusinessProfile:t});return le({icon:"business-website",theme:E.IconSectionTheme.SmallMargin,content:(0,L.jsx)("div",{children:i})})})(ue),(n=>{if(!n.primaryWebsite)return null;if(z||!q){const i=(0,L.jsx)(f.BusinessProfileFormField,{activeField:se,error:J,fieldKey:"secondaryWebsite",fieldMetric:b.default.BUSINESS_PROFILE_FIELD.WEBSITE,formatForSave:oe,lowProfile:!1,originalValue:n.secondaryWebsite,placeholder:j.default.t(397),rawBusinessProfile:e,sessionId:a,startActive:te,textFieldConfig:{maxLength:N.WEBSITE},validate:w.validateURL,value:z,onActive:re,onChange:K,onError:()=>{ee(j.default.t(846))},onSaveBusinessProfile:t});return le({icon:"business-website",theme:E.IconSectionTheme.NoMargin,content:(0,L.jsx)("div",{children:i})})}{const e=(0,L.jsx)("button",{className:(0,o.default)(k),onClick:()=>{Y(!1),ae(!0)},children:j.default.t(384)});return le({theme:E.IconSectionTheme.NoMargin,content:(0,L.jsx)("div",{children:e})})}})(ue)]});var pe}},80223:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){const[e,t]=(0,s.useState)(C.LoadType.PENDING),[a,n]=(0,s.useState)(),r=(0,s.useRef)(Math.floor(2147483648*Math.random()).toString()),p=function(){var e=(0,i.default)((function*(){t(C.LoadType.PENDING);try{const e=yield j();n(e),t(C.LoadType.DONE),(0,g.logProfileOpen)(e,r.current)}catch(e){t(C.LoadType.ERROR)}}));return function(){return e.apply(this,arguments)}}();if((0,s.useEffect)((()=>{p()}),[]),e===C.LoadType.PENDING)return(0,y.jsx)("div",{className:h.default.loadingSpinner,children:(0,y.jsx)(x.Spinner,{color:"default",size:24,stroke:6})});if(e===C.LoadType.ERROR)return(0,y.jsx)(c.default,{title:m.default.t(396),theme:"refresh",children:(0,y.jsxs)(f.FlexRow,{align:"center",justify:"center",children:[(0,y.jsx)(f.FlexItem,{children:m.default.t(394)}),(0,y.jsx)(f.FlexItem,{xstyle:E.retryButton,children:(0,y.jsx)(l.default,{onClick:()=>{p()},type:"simplified",children:m.default.t(1602)})})]})});if(e===C.LoadType.DONE&&a)return(0,y.jsx)(u.default,{verifiedName:d.Conn.pushname||void 0,sessionId:r.current,businessProfile:a,saveBusinessProfile:function(){var e=(0,i.default)((function*(e){try{yield(0,o.editBusinessProfile)(e)}catch(e){throw(0,S.showError)(m.default.t(395)),(0,v.qplEndProfileSave)(_.QuickLogActionType.FAIL),__LOG__(3,void 0,void 0,!0)`business_profile:edit_form save failed`,SEND_LOGS(`businessProfile edit handled server error - ${e.status}`),e}try{const e=yield I();return n(e),(0,v.qplEndProfileSave)(_.QuickLogActionType.SUCCESS),e}catch(e){throw(0,S.showError)(m.default.t(394)),(0,v.qplEndProfileSave)(_.QuickLogActionType.FAIL),e}}));return function(){return e.apply(this,arguments)}}()});return null};var i=n(a(48926)),s=a(67294),r=(n(a(56720)),a(8581)),o=a(85148),l=n(a(69991)),d=a(9322),c=n(a(25061)),u=n(a(50586)),h=n(a(62389)),f=a(63290),p=a(86723),m=n(a(2408)),g=a(31661),v=a(90676),C=a(47094),_=a(21125),x=a(46714),S=a(59641),y=a(85893);const E={retryButton:{height:"epwkujcx",marginStart:"nzcjdldu"}},j=function(){var e=(0,i.default)((function*(){const e=(0,p.getMeUser)(),t=r.BusinessProfileCollection.get(e);t&&t.markStale();return(yield r.BusinessProfileCollection.find(e)).serialize()}));return function(){return e.apply(this,arguments)}}(),I=function(){var e=(0,i.default)((function*(){const e=(0,p.getMeUser)(),t=yield r.BusinessProfileCollection.update(e);return(Array.isArray(t)?t[0]:t).serialize()}));return function(){return e.apply(this,arguments)}}()},31661:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.getProfilePopulatedFields=r,t.logProfileOpen=function(e,t){const a=new s.default.EditBusinessProfile((0,i.default)({editProfileAction:s.default.EDIT_PROFILE_ACTION.ACTION_OPEN,businessProfileEntryPoint:s.default.BUSINESS_PROFILE_ENTRY_POINT.SETTINGS,editBusinessProfileSessionId:t},r(e)));a&&a.commit()},t.logProfileFieldOpen=function(e,t,a){const n=new s.default.EditBusinessProfile((0,i.default)({editProfileAction:s.default.EDIT_PROFILE_ACTION.ACTION_PROFILE_FIELD_OPEN,businessProfileEntryPoint:s.default.BUSINESS_PROFILE_ENTRY_POINT.SETTINGS,editProfileActionField:e,editBusinessProfileSessionId:a},r(t)));n&&n.commit()},t.logProfileFieldSave=function(e,t,a){const n=new s.default.EditBusinessProfile((0,i.default)({editProfileAction:s.default.EDIT_PROFILE_ACTION.ACTION_PROFILE_FIELD_SAVE,businessProfileEntryPoint:s.default.BUSINESS_PROFILE_ENTRY_POINT.SETTINGS,editProfileActionField:e,editBusinessProfileSessionId:a},r(t)));n&&n.commit()},t.logProfileFieldDiscard=function(e,t,a){const n=new s.default.EditBusinessProfile((0,i.default)({editProfileAction:s.default.EDIT_PROFILE_ACTION.ACTION_PROFILE_FIELD_DISCARD,businessProfileEntryPoint:s.default.BUSINESS_PROFILE_ENTRY_POINT.SETTINGS,editProfileActionField:e,editBusinessProfileSessionId:a},r(t)));n&&n.commit()};var i=n(a(81109)),s=n(a(4231));function r(e){var t;return{hasDescription:null!=e.description,hasCategory:!!(e.categories&&e.categories.length>0),hasHours:null!=(null===(t=e.businessHours)||void 0===t?void 0:t.config),hasEmail:null!=e.email,hasAddress:null!=e.address,hasWebsite:null!=e.website}}},47094:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"EditType",{enumerable:!0,get:function(){return n.EditType}}),Object.defineProperty(t,"LoadType",{enumerable:!0,get:function(){return n.LoadType}});var n=a(88281)},72274:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.convertRawBusinessProfile=void 0;var n=a(13822);t.convertRawBusinessProfile=e=>{const{description:t,email:a,address:i,website:s,categories:r,businessHours:o,latitude:l,longitude:d}=e,[c,u]=s||[];return{description:t,email:a,address:i,primaryWebsite:c,secondaryWebsite:u,hours:(0,n.getBusinessHoursForEdit)(o),categories:r||[],latitude:l,longitude:d}}},59641:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.showError=void 0;var n=a(69162),i=a(49201),s=a(85893);t.showError=e=>{n.Cmd.openToast((0,s.jsx)(i.Toast,{msg:e,duration:6e3,id:(0,i.genId)()}))}},48720:(e,t,a)=>{"use strict";var n=a(20862),i=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.CartDetailDrawer=function(e){const{onBack:t,sellerJid:a,chat:n,closeDrawerRightOnSend:i,onProductCatalog:z,onProductDetail:K}=e,q=(0,o.useContext)(y.DrawerContext),Y=(0,o.useMemo)((()=>h.CartCollection.findCart(a)),[a]),Q=(0,o.useRef)(null),X=(0,o.useRef)(null),Z=(0,H.default)((()=>new r.PromiseQueue)),$=(0,H.default)((()=>new j.default)),[J,ee]=(0,o.useState)(!0),[te,ae]=(0,o.useState)(void 0),[ne,ie]=(0,o.useState)([]),[se,re]=(0,o.useState)(Y.message),oe=function(){var e=(0,s.default)((function*(e){const[t,a]=yield Promise.all([e?(0,O.default)(Y):Promise.resolve(),d.BusinessProfileCollection.find(n.id)]);t&&(X.current=t);const i=(0,w.matchCartItemsToProducts)(Y,X.current);ee(!1),ae(a),ie(i)}));return function(){return e.apply(this,arguments)}}();(0,G.useListener)(Y,"change:cartItemCollection",(()=>{Z.current.enqueue((()=>oe()))})),(0,o.useEffect)((()=>{let e=!0;(0,M.qplAnnotateCartView)(Y.id.toString()!==a,Y.itemCount),oe(!0).then((()=>{e=!1,(0,M.qplEndCartView)(A.QuickLogActionType.FAIL),(0,P.logCartListImpression)(Y.id.toString(),(0,k.getProductCatalogContext)(q))})).catch((()=>{__LOG__(4,!0,new Error,!0)`Unable to open the cart`,SEND_LOGS("openCart: failed to open the cart"),(0,R.default)(),(0,m.default)(Y)})).finally((()=>{e&&(0,M.qplEndCartView)(A.QuickLogActionType.FAIL),ee(!1)}))}),[]);const le=()=>{ee(!0),(0,M.qplStartOrderCreate)(Y.itemCount),(0,N.default)(Y,n).then((e=>{const a=Boolean(Y.message);(0,b.logSendOrderMessage)({orderId:e,catalogOwnerJid:Y.id,catalogContext:(0,k.getProductCatalogContext)(q),isOrderMsgAttached:a,quantity:Y.itemCount}),t(),(0,m.default)(Y),Y.message=void 0,i&&g.Cmd.existsDrawerRight((e=>{e&&g.Cmd.closeDrawerRight()})),(0,M.qplEndOrderCreate)(A.QuickLogActionType.SUCCESS)})).catch((()=>{__LOG__(4,!0,new Error,!0)`Unable to create catalog order`,SEND_LOGS("submitOrder: order creation or order message send error"),(0,R.default)(),oe(!0),(0,M.qplEndOrderCreate)(A.QuickLogActionType.FAIL)})).finally((()=>{ee(!1)}))},de=e=>{re(e),(0,U.default)(Y,e)},ce=()=>{g.Cmd.openModal((0,W.jsx)(v.default,{title:T.default.t(433),onOK:()=>{g.Cmd.closeModal()},okText:T.default.t(2192),children:T.default.t(432)}))};return(0,W.jsxs)(x.default,{onDrop:t,theme:"striped",children:[(0,W.jsx)(E.DrawerHeader,{title:T.default.t(424),type:E.DRAWER_HEADER_TYPE.SMALL,onBack:t}),(0,W.jsx)(S.default,{flatListControllers:[$.current],children:(()=>{if(J)return(0,W.jsx)(I.default,{});const e=Y.itemCount,t=e>0;let i,s;if(t){const t=T.default.t(1080,{count:e,_plural:e});i=(0,W.jsx)(B.TextDiv,{theme:"title",children:t})}null!=Y.total&&null!=Y.currency?s=(0,W.jsx)(B.TextDiv,{theme:"muted-small",children:T.default.t(1430,{subtotal:_.formatAmount1000(Y.currency,Y.total)})}):e>0&&(s=(0,W.jsx)(B.TextDiv,{theme:"muted-small",children:T.default.t(1417)}));const r=(0,W.jsx)(V.default,{transitionName:"media-caption",className:f.default.cartMessage,children:(0,W.jsx)(L.default,{ref:Q,chat:n,maxLength:C.default.MAX_CART_MESSAGE_LENGTH,multiline:!0,onEnter:le,onChange:de,onMaxPasteExceeded:ce,placeholder:T.default.t(431),showRemaining:!0,spellCheck:!0,supportsEmoji:!0,value:se})}),o=(0,W.jsx)("button",{"data-a8n":l.default.key("cart-send-button"),className:f.default.btnSend,tabIndex:"-1",onClick:le,title:T.default.t(436),children:(0,W.jsx)(D.Round,{large:!0,children:(0,W.jsx)(F.default,{name:"send",directional:!0})})});return(0,W.jsxs)(W.Fragment,{children:[!t&&(0,W.jsxs)("div",{className:f.default.emptyCartContainer,children:[(0,W.jsx)(F.default,{name:"shopping-cart-empty"}),(0,W.jsx)(B.TextDiv,{className:f.default.emptyCardHeader,theme:"large",children:T.default.t(425)}),(0,W.jsx)(B.TextDiv,{className:f.default.emptyCardText,theme:"plain",children:T.default.t(426)}),(0,c.hasCatalog)(te)&&(0,W.jsx)(u.default,{onClick:z,type:"primary",children:T.default.t(1496)})]}),(0,W.jsxs)("div",{className:f.default.info,children:[i,s]}),(0,W.jsx)(p.default,{flatListController:$.current,onProductDetail:K,cart:Y,sellerJid:a,cartProductItems:ne}),t&&(0,W.jsxs)("div",{className:f.default.footer,children:[r,(0,W.jsx)(V.default,{transitionAppear:!0,transitionName:"btn",children:o})]})]})})()})]})};var s=i(a(48926)),r=a(16265),o=a(67294),l=i(a(76610)),d=a(8581),c=a(47874),u=i(a(69991)),h=a(25523),f=i(a(19453)),p=i(a(12756)),m=i(a(26004)),g=a(69162),v=i(a(75940)),C=i(a(55454)),_=n(a(61447)),x=i(a(17747)),S=i(a(9042)),y=a(79864),E=a(55588),j=i(a(67893)),I=i(a(52715)),T=i(a(2408)),b=a(1236),P=a(20232),M=a(90676),w=a(30833),L=i(a(84627)),k=a(70790),O=i(a(32973)),A=a(21125),D=a(3132),R=i(a(88253)),N=i(a(33764)),F=i(a(2966)),B=a(97504),U=i(a(75878)),H=i(a(79939)),G=a(61192),V=i(a(82669)),W=a(85893)},12756:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{cartProductItems:t,onProductDetail:a,sellerJid:n}=e;return(0,d.jsx)(l.default,{flatListControllers:[e.flatListController],children:(0,d.jsx)(o.FlatList,{flatListController:e.flatListController,direction:"vertical",forceConsistentRenderCount:!1,data:t.map((e=>({itemKey:e.cartItem.id,contentKey:(0,i.default)("cartItem"),product:e.product,cartItem:e.cartItem}))),renderItem:e=>{const t={productId:e.cartItem.id,businessOwnerJid:n};return(0,d.jsx)(s.default,{cartId:n,product:e.product,quantity:e.cartItem.quantity,onClick:()=>a(t)})},defaultItemHeight:r.default.PRODUCT_LIST_ITEM_HEIGHT})})};var i=n(a(73955)),s=n(a(31355)),r=n(a(55454)),o=a(86025),l=n(a(19257)),d=a(85893)},31355:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t;const{product:a,onClick:n}=e,C=(0,v.jsx)(c.EmojiText,{text:a.name,ellipsify:!0,titlify:!0}),_=null===(t=a.getPreviewImage())||void 0===t?void 0:t.mediaData;let x;x=_?(0,v.jsx)(m.ProductThumb,{theme:"list",mediaData:_}):(0,v.jsx)(v.Fragment,{});const S=(0,v.jsx)(p.default,{className:i.default.price,product:a,fallback:u.default.t(427)});return(0,v.jsx)(r.default,{image:x,customImage:!0,primary:C,secondary:S,theme:"cart-product",onClick:n,detail:(0,v.jsx)(d.DrawerContext.Consumer,{children:t=>(0,v.jsxs)("div",{className:i.default.actions,children:[(0,v.jsx)(s.default,{quantity:e.quantity,onChange:a=>function(t,a){const{cartId:n,product:i}=e;(0,g.default)(n,i,t),(0,h.logEditProduct)(i,a,t)}(a,(0,f.getProductCatalogContext)(t))}),(0,v.jsx)("div",{className:i.default.deleteIcon,children:(0,v.jsx)(o.default,{onClick:a=>function(t,a){const{cartId:n,product:i}=e,s=(0,l.default)(n,i.id.toString());(0,l.default)(n,i.id.toString()),(0,h.logDeleteProduct)(i,a),0===s&&(0,h.logCartAbandon)(i.catalogWid.toString(),a),function(e){e.preventDefault(),e.stopPropagation()}(t)}(a,(0,f.getProductCatalogContext)(t))})})]})}),className:i.default.cartListItem},a.id.toString())};var i=n(a(65324)),s=n(a(84054)),r=n(a(55092)),o=n(a(6235)),l=n(a(97783)),d=a(79864),c=a(85051),u=n(a(2408)),h=a(20232),f=a(70790),p=n(a(22986)),m=a(84241),g=n(a(48133)),v=a(85893)},84054:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,r.jsx)("div",{className:s.default.select,children:(0,r.jsx)("select",{onClick:function(e){e.preventDefault(),e.stopPropagation()},value:e.quantity,onChange:function(t){const a=t.target;a instanceof HTMLSelectElement&&e.onChange(parseInt(a.value,10))},children:function(){const e=[];for(let t=1;t<=i.MAX_QUANTITY;t++)e.push((0,r.jsx)("option",{value:t,children:t},t));return e}()})})};var i=a(53685),s=n(a(5323)),r=a(85893)},6235:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,o.jsx)(r.default,{"aria-label":s.default.t(1526),name:"delete",title:s.default.t(1526),className:i.default.deleteIcon,onClick:e.onClick})};var i=n(a(33776)),s=n(a(2408)),r=n(a(40858)),o=a(85893)},62069:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a(76610)),s=n(a(55092)),r=a(25142),o=n(a(8959)),l=a(85893);t.default=({title:e,icon:t,t:a})=>{const n=null!=a?r.Clock.relativeDateAndTimeStr(a):"-",d=(0,l.jsxs)("div",{className:o.default.title,"data-a8n":i.default.key("msg-info-title"),children:[t,e]});return(0,l.jsx)(s.default,{primary:d,secondary:n,theme:"plain",idle:!0})}},95005:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const t=(0,l.useModelValues)(e.msg,["numTimesForwarded","isFrequentlyForwarded"]),{numTimesForwarded:a,isFrequentlyForwarded:n}=t;if(a<=0||n)return null;const c=(0,d.jsx)(r.default,{name:"forwarded",display:"inline",className:s.default.icon}),u=i.default.t(874,{count:a,_plural:a});return(0,d.jsxs)("div",{className:s.default.title,children:[c,(0,d.jsx)(o.TextSpan,{theme:"title",className:s.default.text,children:u})]})};var i=n(a(2408)),s=n(a(78749)),r=n(a(2966)),o=a(97504),l=a(76006),d=a(85893)},13531:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(67294),s=n(a(53407)),r=a(75381),o=a(84758),l=n(a(55454)),d=a(70521),c=n(a(15308)),u=a(86025),h=a(39e3),f=n(a(2408)),p=n(a(37314)),m=n(a(16967)),g=n(a(79939)),v=n(a(37110)),C=a(85893);function _(e,t){const{contacts:a,frequentContacts:n,onFocusSearch:_,onClick:x,showPersonGroupDivisionHeader:S}=e,y=(0,i.useRef)(null),E=(0,g.default)((()=>new m.default([],(e=>e.id.toString())))),j=()=>{E.current.setFirst(!0)};(0,i.useImperativeHandle)(t,(()=>({focusFirst:j})));const I=(e,t)=>{const a=(t?d.FREQUENT_PREFIX:"")+e.id.toString();if(e.isGroup){const n=o.ChatCollection.get(e.id);return n?{itemKey:a,data:n,type:3,frequent:t}:null}return{itemKey:a,data:e,type:2,frequent:t}},T=(0,i.useMemo)((()=>{const e=[];return null==n||n.forEach((t=>{const a=I(t,!0);a&&e.push(a)})),e}),[n]),b=(0,v.default)((e=>{if(0===e.length)return[];const t=e[0].isGroup?"group":"contact",a=[],n=e.length>10;let i="XXX";for(let s=0;s<e.length;s++){const r=e[s];if(n&&r.header){const n=r.header;if(n!==i){const r=s<e.length-1&&n!==e[s+1].header;a.push({itemKey:`header-${t}-${n}`,data:n,separator:r,type:1}),i=n}}const o=I(r);o&&a.push(o)}return a})),P=(0,i.useMemo)((()=>{const e=[],t=[],n=[];T.length&&(e.push({itemKey:"frequent-contacts-header",type:0}),e.push(...T)),a.forEach((e=>{e.isGroup?n.push(e):t.push(e)}));const i=b(t),s=b(n);if(S&&i.length>0){const t=f.default.t(2017);e.push({itemKey:`header-${t}`,data:t,separator:!0,type:1})}if(e.push(...i),S&&s.length>0){const t=f.default.t(2135);e.push({itemKey:`header-${t}`,data:t,separator:!0,type:1})}return e.push(...s),e}),[a,T,b,S]);return E.current.init((()=>{const e=[],t=[];return a.forEach((a=>{if(a.isGroup){const e=o.ChatCollection.get(a.id);e&&t.push(e)}else e.push(a)})),(n||[]).concat(e).concat(t)})()),(0,C.jsx)(h.HotKeys,{onRef:e=>{y.current=e},handlers:{down:e=>{e.preventDefault(),e.stopPropagation(),E.current.setNext(!0)},up:e=>{e.preventDefault(),e.stopPropagation();const t=E.current;t.prev()>-1?t.setPrev(!0):(t.unset(),_(e))}},onFocus:e=>{if(e.target!==y.current)return;const t=E.current;t.index<0?j():t.reset(!0)},"data-tab":l.default.TAB_ORDERS.CHAT_CONTACT_LIST,"data-testid":"contact-list-key",children:(0,C.jsx)(u.FlatList,{data:P,renderItem:function(e){switch(e.type){case 0:return(0,C.jsx)(p.default,{header:f.default.t(2048)},"frequent-contacts-header");case 3:const{data:t,frequent:a}=e;return((e,t)=>(0,C.jsx)(r.Chat,{active:E.current,chat:e,mode:r.Mode.INFO,noContext:!0,onClick:x,frequent:t}))(t,a);case 2:const{data:n,frequent:i}=e;return((e,t)=>{let a;return e.isBlocked()&&(a=f.default.t(672)),(0,C.jsx)(d.Contact,{active:E.current,contact:e,onClick:x,secondary:a,frequent:t,waitIdle:!0})})(n,i);case 1:const{data:o,separator:l}=e;return(0,C.jsxs)("div",{className:c.default.header,children:[l?(0,C.jsx)(s.default,{},`separator-${o}`):null,(0,C.jsx)(p.default,{header:o})]});default:throw new u.UnknownDataError(e)}},flatListController:e.flatListController,direction:"vertical"})})}var x=(0,i.forwardRef)(_);t.default=x},4337:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a(35161)),s=a(67294),r=a(70521),o=a(39e3),l=n(a(2408)),d=n(a(16967)),c=n(a(79939)),u=a(85893);function h(e,t){const{contacts:a,onFocusSearch:n,onDelete:h}=e,f=(0,c.default)((()=>new d.default(a,(e=>e.id)))),p=()=>{(null==a?void 0:a.length)&&f.current.setLast(!0)},m=e=>{e.preventDefault(),e.stopPropagation();f.current.prev()>-1&&f.current.setPrev(!0)},g=e=>{e.preventDefault(),e.stopPropagation();const t=f.current.next();f.current.index===t?(f.current.unset(),n&&n(e)):f.current.setNext(!0)},v=e=>{e.preventDefault(),e.stopPropagation();const t=f.current.getVal();if(t){const n=a.find(t);n&&h&&h(e,n)}},C=(e,t)=>{f.current.setVal(t)};if((0,s.useEffect)((()=>{f.current.init(a,!0)}),[a,f]),(0,s.useImperativeHandle)(t,(()=>({focusLast:p}))),!a)return null;const _=a.length?(0,i.default)(a,(t=>(0,u.jsx)(r.Contact,{contact:t,active:f.current,onDelete:e.onDelete,onClick:C,type:r.Type.SMALL,theme:e.theme,waitIdle:!0},t.id.toString()))):null,x={up:m,down:g};e.onDelete&&(x[l.default.LR("left","right")]=m,x[l.default.LR("right","left")]=g,x.backspace=v);const S=(0,u.jsx)("ul",{children:_});return(0,u.jsx)(o.HotKeys,{handlers:x,children:S})}var f=(0,s.forwardRef)(h);t.default=f},12064:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{ids:t,size:a,onClick:n,showCount:l,square:d,border:c}=e,u=t.length;if(0===u)return null;if(1===u)return(0,o.jsx)(r.DetailImage,{id:t[0],size:40,onClick:n,border:c});const h=t.slice(0,4).map(((e,t)=>(0,o.jsx)("div",{className:(0,i.default)(s.default.avatar,{[s.default.first]:0===t,[s.default.second]:1===t,[s.default.third]:2===t,[s.default.fourth]:3===t}),children:(0,o.jsx)(r.DetailImage,{id:e,size:a,square:!0})},`avatar-combo-image-${t}`))),f=(0,i.default)(s.default.container,{[s.default.square]:d,[s.default.border]:c},{[s.default.two]:2===u,[s.default.three]:3===u,[s.default.four]:u>=4}),p=(0,r.getSize)(a),m={height:p,width:p,cursor:n?"pointer":void 0},g=l?(0,o.jsx)("div",{className:s.default.count,style:m,children:t.length}):null;return(0,o.jsxs)("div",{className:f,style:m,onClick:n,children:[h,g]})};var i=n(a(94184)),s=n(a(72084)),r=a(88419),o=a(85893)},78899:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,r.jsxs)("div",{className:s.default.overlay,children:[(0,r.jsx)("div",{className:s.default.icon,children:e.icon}),(0,r.jsx)("div",{"data-a8n":i.default.key("avatar-text"),className:s.default.text,children:e.text})]},"avatar-overlay")};var i=n(a(76610)),s=n(a(79169)),r=a(85893)},61567:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a(81109)),s=n(a(6479)),r=a(67294),o=n(a(56720)),l=a(85893);const d={boxSizing:"cm280p3y",flexShrink:"oq44ahr5",position:"g0rxnol2"};function c(e,t){let{breakpoint:a,inverseToContainer:n=!1,maxWidth:r,minWidth:c,xstyle:u}=e,h=(0,s.default)(e,["breakpoint","inverseToContainer","maxWidth","minWidth","xstyle"]);return(0,l.jsx)("div",(0,i.default)((0,i.default)({},h),{},{className:(0,o.default)(d,u),ref:t,style:{maxWidth:r,minWidth:c,width:n?`calc((${a}px - 100%) * 9999)`:`calc((100% - ${a-.1}px) * 9999)`}}))}var u=(0,r.forwardRef)(c);t.default=u},70775:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{onClick:t,label:a,prefixIcon:n,postfixIcon:u,xstyle:h}=e,f="padded-svg"===e.iconTheme,p=[c.iconSvg,f?c.paddedSvg:s.uiPadding.all4],m={width:f?20:16,height:f?20:16};return(0,d.jsxs)(l.default,{xstyle:[c.container,s.uiPadding.vert8,s.uiPadding.horiz12,null!=n&&s.uiPadding.start36,null!=u&&s.uiPadding.end36,h],onClick:t,"aria-label":e["aria-label"],children:[n&&(0,d.jsx)(o.default,(0,i.default)({name:n,xstyle:[c.icon,c.prefixIcon,s.uiMargin.start5],iconXstyle:p},m)),(0,d.jsx)("div",{className:(0,r.default)(c.content),children:a}),u&&(0,d.jsx)(o.default,(0,i.default)({name:u,xstyle:[c.icon,s.uiMargin.start5],iconXstyle:p},m))]})};var i=n(a(81109)),s=a(26593),r=n(a(56720)),o=n(a(2966)),l=n(a(89135)),d=a(85893);const c={container:{position:"g0rxnol2",color:"nuiuantz",backgroundColor:"jvy3y6qh",borderTopStartRadius:"g130k69c",borderTopEndRadius:"k1a7joe8",borderBottomEndRadius:"dc5qina8",borderBottomStartRadius:"kfr1vweg"},content:{display:"l7jjieqr"},icon:{display:"l7jjieqr",position:"lhggkp7q",right:"rsmgdaqi",top:"mvf5n2qr"},iconSvg:{color:"nuiuantz"},prefixIcon:{left:"lidbxt4q"},paddedSvg:{paddingTop:"qbqilfqo",paddingEnd:"iqx13udk",paddingBottom:"a15vwmim",paddingStart:"qiohso4h"}}},5481:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function({children:e,download:t,file:a,extension:n}){return(0,r.jsx)(s.default,{xstyle:o.button,onClick:()=>{null!=a&&i.FileSaver.downloadData(a,t,n)},children:e})};n(a(56720));var i=a(97227),s=n(a(89135)),r=a(85893);const o={button:{display:"f804f6gw"}}},58151:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e=200,t=window){const a=(0,n.useRef)(null);(0,i.useListener)(t,"mousedown",(()=>{a.current=performance.now()})),(0,i.useListener)(t,"mouseup",(()=>{a.current=null}));return(0,n.useCallback)((()=>{const t=a.current;return null!=t&&performance.now()-t>=e}),[e])};var n=a(67294),i=a(61192)},51402:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const t=(0,n.useRef)(null),a=(0,n.useRef)(!1);return(0,n.useEffect)((()=>{if(null==e)return;function n(e){const a=t.current;return!!a&&(e instanceof Node&&!a.contains(e))}function i(e){if(e.isPrimary){const t=n(e.target);a.current=t}}function s(e){"touch"!==e.pointerType&&"pen"!==e.pointerType||(a.current=!1)}function r(t){const i=n(t.target);a.current&&i&&t.isPrimary&&e(t),a.current=!1}function o(t){n(t.target)&&e(t)}const l="PointerEvent"in window;return l?(document.addEventListener("pointerdown",i),document.addEventListener("pointermove",s),document.addEventListener("pointerup",r)):document.addEventListener("click",o),()=>{l?(document.removeEventListener("pointerdown",i),document.removeEventListener("pointermove",s),document.removeEventListener("pointerup",r)):document.removeEventListener("click",o)}}),[e]),t};var n=a(67294)},24516:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a(35161)),s=n(a(48158)),r=n(a(94184)),o=a(67294),l=n(a(55454)),d=a(73554),c=n(a(40854)),u=n(a(47193)),h=a(39e3),f=n(a(58780)),p=n(a(2408)),m=n(a(47822)),g=n(a(16967)),v=a(46714),C=n(a(89135)),_=n(a(79939)),x=n(a(16297)),S=a(85893);function y(e,t){const{onImageClick:a,isLoadingMore:n,canLoadMore:y,onRequestMoreImages:E,onFocusPrev:j,thumbnails:I}=e,T=(0,o.useRef)(null),b=(0,_.default)((()=>new Map)),P=(0,o.useRef)(null),M=(0,_.default)((()=>new g.default(I,(e=>e.id)))),[w,L]=(0,o.useState)(null),k=(0,o.useCallback)(((e=!1,t=!1)=>{const a=M.current,n=a.getVal();if(n&&w!==n&&(L(n),a.index>-1)){const e=b.current.get(`${a.index}`);u.default.focus(e),t&&e&&(0,d.scrollIntoViewIfNeeded)(e,!1)}}),[b,w,M]);(0,o.useEffect)((()=>{k()}),[]);const O=new m.default(((e,t)=>{t?b.current.set(e,t):b.current.delete(e)})),A=e=>{const t=e.target;a&&1===t.nodeType&&"IMG"===t.tagName&&a(t.src)},D=(0,o.useCallback)((()=>{if(!n&&y&&E){if(!T.current)throw new Error("Requesting more images when body not rendered");T.current.scrollTop+l.default.SCROLL_FUDGE>T.current.scrollHeight-T.current.clientHeight&&E()}}),[y,n,E]),R=(0,x.default)(D,100),N=()=>{M.current.unset(),L(void 0)};(0,o.useEffect)((()=>{D(),M.current.init(I,!1),k()}),[D,M,I,k]);const F=()=>{P.current&&P.current.focus()};(0,o.useImperativeHandle)(t,(()=>({focus:F,handleRequestDismiss:N})));const B=(0,i.default)(e.thumbnails,(({id:e,name:t,thumbUrl:a},n)=>{const i=!!w&&w.id===e,s=(0,r.default)(f.default.imageGalleryItem,{[f.default.selected]:i}),o=(0,S.jsx)("div",{className:f.default.imageGalleryItemOverlay});return(0,S.jsxs)("div",{ref:O.getRefSetter(`${n}`),className:s,tabIndex:-1,children:[o,(0,S.jsx)(C.default,{onClick:A,children:(0,S.jsx)("img",{alt:p.default.t(7,{name:t}),className:f.default.imageGalleryItemImage,src:a})})]},e)})),U=e.isLoadingMore?(0,S.jsx)("div",{tabIndex:-1,className:f.default.imageGalleryFooter,children:(0,S.jsx)(v.Spinner,{stroke:6,size:24})}):null;return(0,S.jsx)(h.HotKeys,{className:f.default.imageGallery,"data-tab":l.default.TAB_ORDERS.CHAT_IMAGE_GALLERY,handlers:{down:e=>{e.preventDefault(),e.stopPropagation(),M.current.set(M.current.index+3,!1,!1),k(!0,!0)},enter:()=>{const e=M.current.getVal();e||(__LOG__(4,void 0,new Error,!0)`Assertion failed!`,SEND_LOGS("No value selected, but enter clicked")),a&&e&&a(e.thumbUrl)},left:e=>{e.preventDefault(),e.stopPropagation(),M.current.setPrev(!1),k(!0,!0)},right:e=>{e.preventDefault(),e.stopPropagation(),M.current.setNext(!1),k(!0,!0)},up:e=>{if(e.preventDefault(),e.stopPropagation(),0===M.current.index&&j)j();else{const e=Math.max(M.current.index-3,0);M.current.set(e,!1,!1),k(!0,!0)}}},onFocus:e=>{e.stopPropagation(),e.preventDefault(),(null==M.current.index||M.current.index<0)&&M.current.setFirst(!1),k(!0,!1);const t=(0,s.default)(b.current.get(`${M.current.index}`),"imagesRef.current.get(`${selectionRef.current.index}`)").getElementsByClassName(f.default.imageGalleryItemOverlay);if(1!==t.length)throw new Error(`Unexpected number of overlay elements ${t.length}`);c.default.maybeIndicateFocus(t[0],f.default.focusAnimation)},onMouseDown:e=>{e.preventDefault(),e.stopPropagation()},onRef:e=>{P.current=e},children:(0,S.jsxs)("div",{ref:T,className:f.default.imageGalleryList,onScroll:R,children:[B,(0,S.jsx)("div",{tabIndex:-1,className:f.default.imageGalleryItemSpacer}),(0,S.jsx)("div",{tabIndex:-1,className:f.default.imageGalleryItemSpacer}),(0,S.jsx)("div",{tabIndex:-1,className:f.default.imageGalleryItemSpacer}),U]})})}var E=(0,o.forwardRef)(y);t.default=E},44419:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(67294),i=a(71998);const s=(e,t)=>{const[a,s]=(0,i.useLottie)(e);return(0,n.useImperativeHandle)(t,(()=>s)),a};var r=(0,n.forwardRef)(s);t.default=r},71998:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.useLottie=function({autoplay:e=!1,data:t,direction:a=1,fallback:n=null,loop:c=!1,path:u,placeholder:h=null,renderer:f=d.SVG,speed:p=1,xstyle:m}){(0,i.default)(null==t&&null!=u||null!=t&&null==u,"These opts are mutually exclusive");const g=(0,r.useRef)(),v=(0,r.useRef)(),[C,_]=(0,r.useState)(!0),[x,S]=(0,r.useState)(!1),y=(0,r.useCallback)((()=>{var e;null===(e=g.current)||void 0===e||e.play()}),[]),E=(0,r.useCallback)((()=>{var e;null===(e=g.current)||void 0===e||e.stop()}),[]),j=(0,r.useCallback)((()=>{var e;null===(e=g.current)||void 0===e||e.pause()}),[]),I=(0,r.useCallback)(((e,t)=>{var a;null===(a=g.current)||void 0===a||a.goToAndPlay(e,t)}),[]),T=(0,r.useCallback)(((e,t)=>{var a;null===(a=g.current)||void 0===a||a.goToAndStop(e,t)}),[]),b=(0,r.useCallback)((e=>{var t;null===(t=g.current)||void 0===t||t.getDuration(e)}),[]);(0,r.useEffect)((()=>{const a=s.default.loadAnimation({container:v.current,animationData:t,path:u,renderer:f,loop:c,autoplay:e});g.current=a;const n=[{name:"data_ready",handler:()=>_(!1)},{name:"data_failed",handler:()=>S(!0)}].map((e=>(a.addEventListener(e.name,e.handler),()=>a.removeEventListener(e.name,e.handler))));return()=>{n.forEach((e=>e())),a.destroy()}}),[t,u,f,c,e]),(0,r.useEffect)((()=>{var e;null===(e=g.current)||void 0===e||e.setSpeed(p)}),[p]),(0,r.useEffect)((()=>{var e;null===(e=g.current)||void 0===e||e.setDirection(a)}),[a]);return[(0,l.jsxs)("div",{className:(0,o.default)(m),ref:v,children:[C&&!x?h:null,x?n:null]}),{play:y,stop:E,pause:j,goToAndPlay:I,goToAndStop:T,getDuration:b}]},t.Renderer=void 0;var i=n(a(41143)),s=n(a(11248)),r=a(67294),o=n(a(56720)),l=a(85893);const d=a(54302)({SVG:"svg",Canvas:"canvas"});t.Renderer=d},84627:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a(94184)),s=a(48360),r=a(67294),o=a(69162),l=n(a(75940)),d=a(9492),c=a(91137),u=a(22252),h=a(39e3),f=n(a(2408)),p=n(a(45689)),m=n(a(38376)),g=a(2904),v=n(a(2966)),C=a(63477),_=n(a(68062)),x=a(49002),S=n(a(82669)),y=a(85893);const E=()=>{o.Cmd.openModal((0,y.jsx)(l.default,{title:f.default.t(423),onOK:()=>{o.Cmd.closeModal()},okText:f.default.t(2192),children:f.default.t(422)}))};function j(e,t){const{value:a,focusOnMount:n,onBlur:o,onFocus:l,maxLength:j=25,onMaxPasteExceeded:I=E}=e,T=(0,r.useRef)(null),b=(0,r.useRef)(null),P=(0,r.useRef)(null),[M,w]=(0,r.useState)(!1),[L,k]=(0,r.useState)(null),O=(0,x.numCodepoints)(e.value||""),A=()=>{var e;null===(e=T.current)||void 0===e||e.focus()};(0,r.useEffect)((()=>{n&&A()}),[]);const D=()=>{k(null)},R=e=>{const t=T.current;t&&(t.focus(!1),t.replaceSelection(e)),D()},N=()=>{var e;null===(e=P.current)||void 0===e||e.restoreFocus()},F=e=>{M&&w(!1),o&&o(e)},B=e=>{e.stopPropagation(),M||w(!0),l&&l(e)};(0,r.useImperativeHandle)(t,(()=>({handleBlur:F,handleFocus:B,refInput:T.current})));const U=e.supportsEmoji?(0,y.jsx)("button",{className:m.default.inputEmoji,onClick:e=>{e&&(e.preventDefault(),e.stopPropagation());const t=(0,y.jsx)(c.EmojiPanel,{ref:P,onEmoji:R,onFocusNext:A,onFocusPrev:A});k({menu:t,dirY:d.DirY.TOP,type:"emoji_picker",anchor:e.target}),A()},children:(0,y.jsx)(v.default,{"aria-label":s.fbt._("Open emojis panel",null,{hk:"3IEMY6"}),name:"emoji-input"})}):void 0;let H=null;H=a&&""!==a?(0,y.jsx)("div",{role:"button",className:m.default.clearInput,onClick:()=>{var e;null===(e=T.current)||void 0===e||e.reset()},children:(0,y.jsx)(v.default,{name:"x-alt"})}):null;const G=e.showRemaining?(0,y.jsx)("div",{className:(0,i.default)(m.default.buttonContainer,m.default.charCounter,{[m.default.charCounterWithClearBtn]:!!H}),children:(0,y.jsx)("div",{className:m.default.charCounter,children:j-O<50?f.default.n(j-O):null})}):null;let V;L&&(V=(0,y.jsx)(C.UIE,{displayName:"EmojiPicker",escapable:!0,popable:!0,requestDismiss:D,requestFocus:N,children:(0,y.jsx)(_.default,{contextMenu:L})}));const W=(0,i.default)(m.default.textInput,{[m.default.noPlaceholder]:!e.placeholder,[m.default.active]:!0}),z=(0,i.default)(m.default.labelText,{[m.default.float]:!!e.value});return(0,y.jsxs)(h.HotKeys,{className:W,onFocus:A,children:[(0,y.jsx)("span",{className:z,children:e.placeholder}),(0,y.jsx)("div",{className:m.default.spacer}),(0,y.jsx)("div",{className:m.default.suggestionsPositioner,children:(0,y.jsxs)("div",{className:m.default.suggestionsContainer,children:[(0,y.jsx)(p.default.MentionSuggestions,{chat:e.chat,theme:g.ThemeOptions.MEDIA_CAPTION}),(0,y.jsx)(p.default.EmojiSuggestions,{chat:e.chat,theme:u.ThemeOptions.MEDIA_CAPTION})]})}),(0,y.jsxs)("div",{className:(0,i.default)(m.default.wrapper,{[m.default.textActive]:M}),children:[(0,y.jsx)(p.default,{ref:T,initialValue:e.value,initialSelection:b.current,readOnly:!1,spellCheck:e.spellCheck,multiline:e.multiline,maxLength:e.maxLength,onEnter:e.onEnter,onMaxPasteExceeded:I,onFiles:e.onFiles,onChange:e.onChange,onSelect:e=>{b.current=e},theme:"media-caption"}),(0,y.jsxs)("div",{className:m.default.inputControls,children:[(0,y.jsxs)(S.default,{transitionName:"pop",component:"div",className:m.default.buttonContainer,children:[H,U]}),G]})]}),V]})}var I=(0,r.forwardRef)(j);t.default=I},69704:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(67294),s=n(a(55454)),r=n(a(98213)),o=n(a(20487)),l=a(76006),d=a(85893);function c(e,t){const a=(0,i.useRef)(null),n=(0,l.useModelValues)(e.chatPreference,["wallpaperColor","showDoodle"]);(0,i.useImperativeHandle)(t,(()=>({get container(){return a.current}})));const{wallpaperColor:c,showDoodle:u}=n;let h={};return c!==s.default.DEFAULT_CHAT_WALLPAPER&&(h={backgroundColor:c}),(0,d.jsx)("div",{className:o.default.container,ref:a,children:(0,d.jsxs)("div",{className:o.default.body,style:h,children:[(0,d.jsx)(r.default,{wallpaperColor:c,showDoodle:u}),e.children]})})}var u=(0,i.forwardRef)(c);t.default=u},29827:(e,t,a)=>{"use strict";var n=a(20862),i=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=i(a(63105)),r=a(48360),o=a(67294),l=i(a(76610)),d=i(a(78899)),c=i(a(89545)),u=a(69162),h=i(a(75940)),f=i(a(55454)),p=a(17025),m=i(a(84286)),g=a(47452),v=i(a(42155)),C=a(57085),_=i(a(47193)),x=i(a(22079)),S=i(a(52087)),y=a(39e3),E=i(a(72739)),j=i(a(13985)),I=i(a(2408)),T=n(a(42856)),b=a(79475),P=i(a(90904)),M=i(a(5582)),w=i(a(76870)),L=i(a(25817)),k=i(a(2966)),O=i(a(80750)),A=a(35371),D=a(63477),R=i(a(68062)),N=i(a(82669)),F=a(85893);class B extends o.Component{constructor(...e){super(...e),this.state={img:this.props.startImage,hover:!1,imageSize:null},this._setRefImageContainer=e=>{this._refImageContainer=e},this._setRefImageInput=e=>{this._refImageInput=e},this._handleUpload=()=>{const e=this._refImageInput;if(e)return e.click(),!0},this._removeImage=()=>{this.props.onImageSet(),u.Cmd.closeModal()},this._handleRemove=()=>{let e;switch(this.props.type){case w.default.GROUP:e=I.default.t(1563);break;case w.default.COMMUNITY:e=I.default.t(1561);break;case w.default.PROFILE:e=I.default.t(1566)}u.Cmd.openModal((0,F.jsx)(h.default,{onOK:this._removeImage,okText:I.default.t(1560),onCancel:()=>u.Cmd.closeModal(),cancelText:I.default.t(1999),children:e}))},this._handleView=()=>{const e=this._refImageContainer,{id:t,attachToChat:a}=this.props;if(!e||!t)return;const n=p.ContactCollection.assertGet(t),i={transition:"profile-viewer"};a&&(i.uim=this.props.uim),u.Cmd.openModalMedia((0,F.jsx)(L.default,{contact:n,profilePicThumb:n.getProfilePicThumb(),animateBorderRadius:!0,getZoomNode:t=>{t(e)}}),i)},this.handlePaste=e=>{if(!this.state.contextMenu)return;const t=new m.default(e.clipboardData),a=(0,s.default)(t.getFiles(),(e=>"image"===(0,C.typeFromMimetype)(e.type)));if(!a.length)return;e.preventDefault(),e.stopPropagation(),this.closeContextMenu();const n=a[0];this._handleImagePick(n)},this.handleImageSelected=e=>{this.closeContextMenu();const t=e.target.files[0];if(!t)return!1;this._handleImagePick(t),e.target.value="",this._refImageContainer&&_.default.focus(this._refImageContainer)},this._handleImageReceived=(e,t)=>{e?T.loadImage(e).then((()=>{this.setState({img:e}),this.props.onImageSet(e,t)})).catch((e=>{let t;switch(__LOG__(3)`PhotoPicker:onImageReceived failed to load image: ${String(e)}`,this.props.type){case w.default.GROUP:t=I.default.t(73);break;case w.default.COMMUNITY:t=I.default.t(54);break;case w.default.PROFILE:t=I.default.t(127)}u.Cmd.openModal((0,F.jsx)(h.default,{onOK:()=>u.Cmd.closeModal(),children:t}))})):this.setState({img:null,imageSize:null})},this.handleSearch=()=>{u.Cmd.openModal((0,F.jsx)(b.Modal,{type:b.ModalTheme.Box,children:(0,F.jsx)(E.default,{onFinished:this._handleImageReceived})}))},this._handleImagePick=e=>{const t=URL.createObjectURL(e);T.loadImage(t).then((t=>{t&&(t.width<f.default.MIN_PIC_SIDE||t.height<f.default.MIN_PIC_SIDE)?u.Cmd.openModal((0,F.jsx)(h.default,{onOK:()=>u.Cmd.closeModal(),children:I.default.t(1544,{size:f.default.MIN_PIC_SIDE,_plural:f.default.MIN_PIC_SIDE})})):u.Cmd.openModal((0,F.jsx)(b.Modal,{type:b.ModalTheme.Box,children:(0,F.jsx)(v.default,{img:e,onFinished:this._handleImageReceived,onRetake:this._handleUpload})}))})).catch((()=>{let e;switch(this.props.type){case w.default.GROUP:e=I.default.t(73);break;case w.default.COMMUNITY:e=I.default.t(54);break;case w.default.PROFILE:e=I.default.t(127)}u.Cmd.openModal((0,F.jsx)(h.default,{onOK:()=>u.Cmd.closeModal(),children:e}))})).finally((()=>{URL.revokeObjectURL(t)}))},this._createMenu=()=>{const e=[];return this.props.id&&this.state.img&&e.push((0,F.jsx)(g.DropdownItem,{a8n:"mi-view-photo",action:this._handleView,children:I.default.t(1878)},"view")),x.default&&e.push((0,F.jsx)(O.default,{onImageTake:this._handleImageReceived},"take")),e.push((0,F.jsx)(g.DropdownItem,{a8n:"mi-upload-photo",action:this._handleUpload,children:I.default.t(1831)},"upload")),A.UA.isElectron&&(this.props.type!==w.default.GROUP&&this.props.type!==w.default.COMMUNITY||e.push((0,F.jsx)(g.DropdownItem,{a8n:"mi-search-photo",action:this.handleSearch,children:I.default.t(2256)},"search"))),this.state.img&&e.push((0,F.jsx)(g.DropdownItem,{a8n:"mi-remove-photo",action:this._handleRemove,children:I.default.t(1565)},"remove")),e},this.handleImageKeypress=()=>{const e=this._createMenu();this.setState({contextMenu:{menu:e,anchor:this._refImageContainer}})},this.handleImageClick=e=>{if(this.props.readOnly)return void(this.state.img&&this._handleView());e.stopPropagation(),e.preventDefault();const t=this._createMenu();this.setState({contextMenu:{menu:t,event:e}})},this.closeContextMenu=()=>{this.setState({contextMenu:null})},this.handleMouseOver=()=>{this.state.hover||this.setState({hover:!0})},this.handleMouseEnter=()=>{this.state.hover||this.setState({hover:!0})},this.handleMouseLeave=()=>{this.state.hover&&this.setState({hover:!1})},this.handleLoad=e=>{const t=e.target.clientWidth,a=e.target.clientHeight;this.setState({imageSize:{width:t,height:a}})}}static getDerivedStateFromProps(e){return e.startImage?{img:e.startImage}:{img:e.startImage,imageSize:null}}_getContainerStyle(){return null!=this.props.size?{width:this.props.size,height:this.props.size}:void 0}render(){let e,t;this.state.img&&(e=(0,F.jsx)(P.default,{type:"cover",size:this.state.imageSize,children:(0,F.jsx)(j.default,{src:this.state.img,crossOrigin:!1,style:{height:"100%",width:"100%"},onLoad:this.handleLoad})})),(this.props.pending||this.state.img&&!this.state.imageSize)&&(t=(0,F.jsx)(c.default,{}));let a=null;if(!this.props.pending&&!this.props.readOnly&&(!this.state.img||this.state.imageSize)&&(!this.state.img||this.state.contextMenu||this.state.hover)){let e="";switch(this.props.type){case w.default.GROUP:e=this.state.img?I.default.t(506):I.default.t(151);break;case w.default.COMMUNITY:e=this.state.img?I.default.t(505):I.default.t(148);break;case w.default.PROFILE:e=this.state.img?I.default.t(511):I.default.t(158)}a=(0,F.jsx)(d.default,{icon:(0,F.jsx)(k.default,{name:"camera"}),text:e})}const n=this.props.pending||!this.state.imageSize&&this.state.img?()=>{}:this.handleImageClick;let i,s;if(this.state.contextMenu&&(i=(0,F.jsx)(D.UIE,{displayName:"PhotoPickerContextMenu",escapable:!0,popable:!0,requestDismiss:this.closeContextMenu,children:(0,F.jsx)(R.default,{contextMenu:this.state.contextMenu})})),this.props.pending||!this.state.img||this.state.img&&!this.state.imageSize){const e=this.props.type===w.default.PROFILE?"default-user":"default-group";s=(0,F.jsx)("div",{className:M.default.defaultIcon,children:(0,F.jsx)(k.default,{name:e})})}return(0,F.jsxs)(y.HotKeys,{className:M.default.container,style:this._getContainerStyle(),handlers:{space:this.handleImageKeypress,enter:this.handleImageKeypress},children:[(0,F.jsxs)("div",{className:M.default.body,onClick:n,onMouseOver:this.handleMouseOver,onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,onPaste:this.handlePaste,onFocus:this.handleMouseEnter,onBlur:this.handleMouseLeave,ref:this._setRefImageContainer,title:r.fbt._("Photo Picker",null,{hk:"3TURye"}),dir:"ltr",tabIndex:0,role:"button","data-a8n":l.default.key(this.props.a8nText),children:[(0,F.jsxs)("div",{className:M.default.imageContainer,children:[e,s]}),(0,F.jsxs)(N.default,{transitionName:"fade",children:[t,a]})]}),(0,F.jsx)("input",{ref:this._setRefImageInput,type:"file",accept:"image/gif,image/jpeg,image/jpg,image/png",style:{display:"none"},onChange:this.handleImageSelected}),i]})}}B.displayName="PhotoPicker";var U=(0,S.default)(B);t.default=U},45689:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a(68635)),s=a(28856),r=a(22252),o=n(a(99818)),l=a(31719),d=n(a(1718)),c=a(2904),u=n(a(34701));const h=new o.default,f=new i.default;class p extends((0,l.PluggableInput)([s.EmojiPlugin,f,h,d.default])){}t.default=p,p.MentionSuggestions=(0,u.default)(c.Suggestions,{plugin:h}),p.EmojiSuggestions=(0,u.default)(r.EmojiSuggestions,{plugin:f})},86537:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a(94184)),s=a(3132),r=n(a(18312)),o=a(85893);var l=({ariaLabel:e,large:t,a8nText:a,onClick:n,icon:l,count:d,disabled:c})=>(0,o.jsxs)("div",{className:(0,i.default)(r.default.container,{[r.default.disabled]:c}),children:[(0,o.jsx)(s.Round,{label:e,large:t,a8nText:a,onClick:n,disabled:c,children:l}),null!=d&&(0,o.jsx)("div",{className:(0,i.default)(r.default.count,{[r.default.large]:t}),children:(0,o.jsx)("span",{children:d})})]});t.default=l},33215:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a(81109)),s=a(67294),r=a(69162),o=n(a(75940)),l=a(55588),d=n(a(2408)),c=a(79475),u=a(88281),h=a(85893);t.default=({doSave:e,afterSave:t,isValid:a,children:n,modalConfig:f,onError:p,title:m,onCancel:g})=>{const[v,C]=(0,s.useState)(u.EditType.EDITING),_=(0,h.jsx)(l.DrawerHeader,{title:m,type:l.DRAWER_HEADER_TYPE.POPUP,onCancel:()=>{r.Cmd.closeModal(),g&&g()}});return(0,h.jsx)(o.default,(0,i.default)({children:n,okText:d.default.t(1614),type:c.ModalTheme.Auto,onOK:()=>{C(u.EditType.PENDING),e().then((()=>{C(u.EditType.DONE),t&&t(),r.Cmd.closeModal()}),(e=>{C(u.EditType.ERROR),p&&p(e)}))},okSpinner:v===u.EditType.PENDING,okDisabled:v===u.EditType.PENDING||!a,title:_},f))}},20128:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(67294),s=n(a(56720)),r=a(39e3),o=n(a(2887)),l=n(a(69509)),d=a(85893);const c={tabContainer:{display:"p357zi0d",backgroundColor:"rv6u8h8g"},tab:{boxSizing:"cm280p3y",display:"p357zi0d",flexGrow:"ggj6brxn",flexDirection:"f8m0rgwh",alignItems:"gndfcl4n",justifyContent:"ac2vgrno",height:"qmp0wt83",color:"a633jkfz",textTransform:"ofejerhi"},focused:{boxShadow:"lgn58c33"},selected:{paddingTop:"eujn52yf",color:"ky3f94nk",borderBottom:"qldwl5fi"}};var u=({tabConfigs:e,selectedId:t,onSelect:a,tabXstyle:n,xstyle:o})=>{const l=(0,i.useRef)(t),u=(0,i.useRef)([]),f=e.map((({id:e})=>e)),p=f.length-1;return(0,d.jsx)(r.HotKeys,{handlers:{right:()=>{const e=f.indexOf(l.current),t=e===p?0:e+1,a=u.current[t];a&&a.focus()},left:()=>{const e=f.indexOf(l.current),t=0===e?p:e-1,a=u.current[t];a&&a.focus()}},children:(0,d.jsx)("div",{role:"tablist",className:(0,s.default)(c.tabContainer,o),children:e.map((({title:e,id:i},s)=>(0,d.jsx)(h,{ref:e=>{u.current[s]=e},selected:i===t,onSelect:()=>a(i),onFocus:()=>{l.current=i},xstyle:n,children:e},e)))})})};t.default=u;const h=(0,i.forwardRef)((({selected:e,onSelect:t,onFocus:a,children:n,xstyle:i},r)=>{const[u,h]=(0,o.default)(),f=(0,l.default)(r,u);return(0,d.jsx)("button",{ref:f,role:"tab",tabIndex:e?0:-1,"aria-selected":Boolean(e),title:n,className:(0,s.default)(c.tab,h&&c.focused,e&&c.selected,i),onClick:()=>{e||t()},onFocus:a,children:n})}))},80750:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{onImageTake:t}=e;return(0,l.jsx)(s.DropdownItem,{action:()=>{i.Cmd.openModal((0,l.jsx)(r.EditCaptureFlowLoadable,{onFinished:t}))},a8n:"mi-take-photo",disabled:e.disabled,children:o.default.t(1762)})};var i=a(69162),s=a(47452),r=a(28174),o=n(a(2408)),l=a(85893)},7795:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function({className:e}){let t=r.default.VERSION_STR;return(0,c.jsxs)(l.SelectableDiv,{"data-a8n":s.default.key("version"),className:(0,i.default)(d.default.versionInfo,e),selectable:!0,children:[o.default.t(1853,{version:""}),(0,c.jsx)("span",{dir:"LTR",children:t}),null,null]})};var i=n(a(94184)),s=(n(a(30381)),n(a(76610))),r=n(a(55454)),o=(a(4919),n(a(12542)),n(a(2408))),l=a(20845),d=n(a(6935)),c=a(85893)},43348:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(84758),s=a(69162),r=n(a(75940)),o=a(85051),l=n(a(99942)),d=n(a(47193)),c=n(a(75730)),u=n(a(2408)),h=a(97449),f=a(85893);class p extends l.default{constructor(...e){super(...e),this.filter=e=>{const t=e.groupMetadata;return!(!e.isGroup||e.isGroup&&!(null==t?void 0:t.participants.iAmMember()))&&((null==t?void 0:t.participants.get(this.props.contact.id))?u.default.t(164):!!(null==t?void 0:t.participants.iAmAdmin())||u.default.t(532))},this._confirmAddToGroup=e=>{this.props.requestFocus&&this.props.requestFocus(),this.push((0,f.jsx)(r.default,{cancelText:u.default.t(1999),okText:u.default.t(152),onOK:this._addToGroup.bind(null,e),onCancel:this._pop,children:(0,f.jsx)(o.EmojiText,{text:u.default.t(641,{participant:this.props.contact.formattedName,subject:e.contact.name})})}))},this.requestFocus=()=>{if(!this.refUIE)return;const e=this.refUIE.getNode();e&&!e.contains(document.activeElement)&&d.default.focus(e)},this._addToGroup=e=>{(0,h.addParticipants)(e,[this.props.contact]).then((()=>{s.Cmd.openChatFromUnread(e).then((t=>{t&&s.Cmd.focusChatTextInput(e)}))})).catch((()=>{})),this.end()},this._pop=()=>{this.pop()}}componentDidMount(){this.push((0,f.jsx)(c.default,{chats:i.ChatCollection.filter((e=>e.isGroup)),filter:this.filter,onCancel:this._pop,onGroup:this._confirmAddToGroup}))}}t.default=p},9679:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a(81629)),s=n(a(51463)),r=a(73754),o=a(69162),l=a(45801),d=n(a(99942)),c=a(12950),u=n(a(92235)),h=a(88340),f=a(35371),p=a(85893);class m extends d.default{constructor(...e){super(...e),this._setRefMediaEditor=e=>{this._refMediaEditor=e},this.onCancel=()=>{this.props.onComplete&&this.props.onComplete(!1),this._clearAttachMedia(),this.props.mediaCollection.mediaPickerStatsLogger.logCancel(),this.end()},this.onFailedMedias=e=>{const t=e.filter((e=>e.isGif));if(t.length>0){const e=t.map((e=>e.filename));o.Cmd.once("ui_idle",(()=>{o.Cmd.pasteChatTextInput(this.props.chat,e.join(" "))})),this.props.onComplete&&this.props.onComplete(!1),this._clearAttachMedia(),this.props.mediaCollection.mediaPickerStatsLogger.logCancel(),this.end()}},this._sendMediaWithMentions=(e,t={})=>{const{initCaptionUsed:a,isViewOnce:n}=t,{chat:i}=this.props;o.Cmd.once("ui_idle",(()=>{e.forEach(((e,t)=>{var a;const s=e.media,o={};if(0===t&&(o.quotedMsg=i.composeQuotedMsg,i.composeQuotedMsg=null),o.isViewOnce=n,o.mentionedJidList=e.mentionedJidList,o.caption=s.caption,o.addEvenWhilePreparing=s.previewable&&s.state===r.ATTACH_MEDIA_STATE.PROCESSING,null===(a=this.props.initCaption)||void 0===a?void 0:a.ctwaContextLinkData){const{ctwaContextLinkData:e,ctwaContext:t}=this.props.initCaption;o.ctwaContext=(0,h.prepareCtwaContextSend)(e,t)}s.sendToChat(i,o)})),this._clearAttachMedia()})),this.props.onComplete&&this.props.onComplete(!0,{initCaptionUsed:a}),this.props.mediaCollection.mediaPickerStatsLogger.logSend(),this.end()},this.setText=e=>{null!=e&&o.Cmd.once("ui_idle",(()=>{o.Cmd.pasteChatTextInput(this.props.chat,e)})),this.end()},this.handleRequestDismiss=e=>{var t;(null===(t=this._refMediaEditor)||void 0===t?void 0:t.handleRequestDismiss())&&(!1===e&&this.onCancel(),super.handleRequestDismiss())},this._clearAttachMedia=()=>{this.props.chat&&this.props.chat.setAttachMediaContents(null)}}componentDidMount(){o.Cmd.closeContextMenu(),o.Cmd.closeTooltip(),this.push((0,p.jsx)(u.default,{theme:"attach",ref:this._setRefMediaEditor,chat:this.props.chat,onClose:this.onCancel,initCaption:this.props.initCaption,onSendMedia:(0,s.default)(this._sendMediaWithMentions),mediaCollection:this.props.mediaCollection,onDropText:(0,s.default)(this.setText),sendAsSticker:this.props.sendAsSticker})),c.GK.supportsFeature(c.GK.F.MD_BACKEND)&&(0,l.eagerlyEstablishE2EESessionForMedia)(this.props.chat)}componentWillUnmount(){f.UA.isGecko?(0,i.default)((()=>o.Cmd.focusChatTextInput(this.props.chat))):o.Cmd.focusChatTextInput(this.props.chat)}}t.default=m},91338:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(69162),s=n(a(99942)),r=n(a(2408)),o=a(30333),l=a(19273),d=n(a(63389)),c=a(40307),u=a(85893);class h extends s.default{constructor(...e){super(...e),this.requestFocus=()=>{var e;const t=null===(e=this.refUIE)||void 0===e?void 0:e.getRef();null!=t&&(t instanceof HTMLElement||"function"!=typeof t.onFocusList||t.onFocusList())},this._sendProducts=e=>{const{chat:t}=this.props;(0,l.qplStartProductSendMessage)("Attachment",e.length);const a=e.map(((e,a)=>{const n=0===a?t.composeQuotedMsg:null;return t.sendProductMessage(e,n).then((()=>{(0,o.logProductMessageSent)({product:e,catalogSessionId:this.props.sessionId})}))}));(0,l.qplEndProductMessageSend)(Promise.all(a)),t.composeQuotedMsg=null,this.end()},this._shareCatalog=e=>{const{chat:t}=this.props,a=(0,c.createCatalogLink)(e.id.user),n=`${r.default.t(1493)} ${a}`;i.Cmd.pasteChatTextInput(t,n),(0,o.logSendCatalogClick)({catalogOwnerWid:e.id,catalogSessionId:this.props.sessionId}),this.end()},this._pop=()=>{this.pop()},this._popNone=()=>{this.pop("none")}}componentDidMount(){this.push((0,u.jsx)(d.default,{onCancel:this._pop,onConfirm:this._sendProducts,onShare:this._shareCatalog}))}}var f=h;t.default=f},68050:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a(81109)),s=n(a(99942)),r=n(a(2408)),o=a(57774),l=n(a(16875)),d=a(65565),c=n(a(45953)),u=a(85893);class h extends s.default{constructor(...e){super(...e),this._confirmSendContacts=e=>{this.push((0,u.jsx)(c.default,{contactList:e,onSend:()=>this._sendContacts(e),onBack:this._popNone,chat:this.props.chat}),"none"),this.contacts=e},this._sendContacts=e=>{const{chat:t}=this.props,a=t.composeQuotedMsg,n=t.getComposeContents().ctwaContext||void 0;(0,l.default)(e,t,a,n),t.composeQuotedMsg=null,this.props.onContactsSent(),this.end()},this._getContacts=()=>this.contacts,this._pop=()=>{this.pop()},this._popNone=()=>{this.pop("none")}}componentDidMount(){const e=this.props.serverProps.maxParticipants;this.contacts=[],this.push((0,u.jsx)(o.SelectModal,{title:r.default.t(1654),onCancel:this._pop,onConfirm:this._confirmSendContacts,getInitialItems:this._getContacts,listType:o.ListType.CONTACT_SELECT_MODAL,maxItems:e,allowBlockedContacts:!0}))}}t.default=e=>(0,u.jsx)(h,(0,i.default)((0,i.default)({},e),{},{serverProps:d.ServerProps}))},40993:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a(66578)),s=n(a(99942)),r=a(57990),o=a(85893);class l extends s.default{constructor(...e){super(...e),this.sendMedia=({getImg:e,caption:t,isViewOnce:a,mentionedJidList:n})=>{const i=this.props.chat,s=i.composeQuotedMsg;i.composeQuotedMsg=null;const o=i.getComposeContents().ctwaContext||void 0;(0,r.prepRawMedia)(e,{}).sendToChat(i,{caption:t,mentionedJidList:n,quotedMsg:s,ctwaContext:o,isViewOnce:a}),this.props.onCaptureSent(),this.end()}}componentDidMount(){this.push((0,o.jsx)(i.default,{onBack:()=>{this.end()},chat:this.props.chat,caption:!0,theme:"capture-contain",onSend:this.sendMedia,stream:this.props.stream,disposeStream:this.props.disposeStream}))}}t.default=l},58665:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(48720),s=a(69162),r=a(79864),o=n(a(99942)),l=a(78615),d=a(90676),c=n(a(4231)),u=a(70790),h=a(62002),f=a(21125),p=a(71578),m=a(85893);class g extends o.default{constructor(...e){super(...e),this.onProductCatalog=()=>{const{sellerJid:e,chat:t}=this.props;(0,l.canViewCollections)()&&f.QPL.markerStart(p.QuickLogMarkerId.WHATSAPP_CATALOG_COLLECTIONS_VIEW,{string:{EntryPoint:"Cart"}}),this.push((0,m.jsx)(h.ProductDetailsFlowLoadable,{chat:t,catalogOwnerJid:e}))},this.onProductDetail=e=>{const{chat:t}=this.props;(0,d.qplStartProductView)("Cart"),this.push((0,m.jsx)(h.ProductDetailsFlowLoadable,{refreshCarousel:!0,chat:t,productInfo:e,onEnd:this._pop}))},this._end=()=>{this.end(!0)},this._pop=()=>{this.pop()}}componentDidMount(){const{sellerJid:e,chat:t}=this.props;this.push((0,m.jsx)(r.DrawerContext.Consumer,{children:a=>{const{entryPoint:n}=(0,u.getProductCatalogContext)(a);return(0,m.jsx)(i.CartDetailDrawer,{chat:t,sellerJid:e,onProductDetail:this.onProductDetail,onProductCatalog:this.onProductCatalog,onBack:this._end,closeDrawerRightOnSend:n===c.default.CATALOG_ENTRY_POINT.CATALOG_ENTRY_POINT_PRODUCT_LIST_MESSAGE})}})),s.Cmd.existsDrawerLeft((e=>{e&&s.Cmd.closeDrawerLeft()})),s.Cmd.existsDrawerMid((e=>{e&&s.Cmd.closeDrawerMid()}))}}t.default=g},85445:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a(81109)),s=n(a(48926)),r=a(61295),o=a(67294),l=a(8581),d=a(60028),c=n(a(17663)),u=a(65571),h=n(a(64305)),f=a(69162),p=a(70458),m=n(a(34114)),g=a(10504),v=a(47898),C=a(17025),_=n(a(17747)),x=n(a(9042)),S=a(79864),y=a(55588),E=n(a(69105)),j=n(a(2466)),I=n(a(99942)),T=a(86723),b=a(78615),P=n(a(2408)),M=a(30333),w=a(59562),L=a(83952),k=n(a(60879)),O=a(78150),A=a(94583),D=a(70790),R=n(a(83153)),N=a(27370),F=a(21125),B=a(71578),U=a(68598),H=n(a(64883)),G=a(49201),V=a(12825),W=a(85893);const z=a(54302).Mirrored(["YES","NO","PENDING"]);class K extends I.default{constructor(...e){var t;super(...e),t=this,this._isComplianceFormVisible=!1,this._isProductListVisible=!1,this._blockCartInterstitial=()=>this.props.mustCompleteCompliance!==z.NO,this._isCreatingCatalog=()=>this.props.isCreatingCatalog,this._showProductList=()=>{const e=(0,b.canManageCollections)()?(0,W.jsx)(h.default,{contact:this.props.contact,onCatalogLinkClick:this._onCatalogShare,onProductShare:this.onProductShare,onProductDetail:this.onEditProduct,onAddProduct:this._onAddProduct,onRemoveProduct:this._onRemoveProduct,catalogId:this.props.catalogId,onBack:this._end,onCartClick:this.onCartClick,businessProfile:null,headerType:y.DRAWER_HEADER_TYPE.LARGE,onCollectionSeeAll:this.onCollectionSeeAll,canManageCatalog:!0,autoUpdate:!0,onOpenCollections:this.onOpenCollections,onOpenMerchantDetailsForm:this._handleOpenMerchantDetailsForm,onEditCollection:this._onEditCollection,onOpenSettings:this.onOpenSettings,blockCartInterstitialFn:this._blockCartInterstitial}):(0,W.jsx)(N.ProductListDrawer,{contact:this.props.contact,onCatalogLinkClick:this._onCatalogShare,onProductShare:this.onProductShare,onProductDetail:this.onEditProduct,onAddProduct:this._onAddProduct,onRemoveProduct:this._onRemoveProduct,catalogId:this.props.catalogId,onBack:this._end,onCartClick:this.onCartClick,businessProfile:null,headerType:y.DRAWER_HEADER_TYPE.LARGE,canManageCatalog:!0,autoUpdate:!0,onOpenSettings:this.onOpenSettings,blockCartInterstitialFn:this._blockCartInterstitial});this.push(e)},this._handleOpenMerchantDetailsForm=()=>{const e=(0,T.getMeUser)();this.push((0,W.jsx)(L.MerchantDetailsFormFlowLoadable,{contactId:e,onBack:this.pop}))},this.onEditProduct=e=>{const t=d.CatalogCollection.assertGet(this.props.catalogId);f.Cmd.openDrawerMid((0,W.jsx)(j.default,{catalog:t,product:e}),"slide-left",void 0,void 0,this.props.context,U.FocusType.TABBABLE)},this.onCartClick=e=>{(0,H.default)(e,void 0,this.props.context)},this.onCollectionSeeAll=e=>{this.push((0,W.jsx)(p.CollectionContentDrawer,{contact:this.props.contact,onProductDetail:this.onEditProduct,onProductShare:this.onProductShare,catalogId:this.props.catalogId,onBack:this._pop,onCatalogLinkClick:this._onCatalogShare,onCartClick:this.onCartClick,collection:e,canManageCatalog:!0,headerType:y.DRAWER_HEADER_TYPE.LARGE,onEditCollection:this._onEditCollection}))},this._onEditCollection=e=>{const t=d.CatalogCollection.get(this.props.catalogId);e||(0,w.logCollectionCreateClicked)((0,D.getProductCatalogContext)(this.props.context)),t&&this.push((0,W.jsx)(E.default,{onBack:this._pop,collection:e,catalog:t}))},this._onCatalogShare=(e,t)=>{f.Cmd.openDrawerMid((0,W.jsx)(c.default,{onCancel:()=>{f.Cmd.closeDrawerMid()},catalog:e,contact:t,prompt:P.default.t(501),onSend:()=>f.Cmd.closeDrawerMid(),centerDrawer:!0}),"slide-left",void 0,void 0,this.props.context,U.FocusType.TABBABLE)},this.onProductShare=e=>{f.Cmd.openDrawerMid((0,W.jsx)(R.default,{onCancel:()=>{f.Cmd.closeDrawerMid()},product:e,prompt:P.default.t(501),onSend:()=>f.Cmd.closeDrawerMid(),centerDrawer:!0,sendProductMsg:!0}),"slide-left",void 0,void 0,this.props.context,U.FocusType.TABBABLE)},this.onOpenCollections=()=>{F.QPL.markerStart(B.QuickLogMarkerId.WHATSAPP_COLLECTIONS_MANAGEMENT_VIEW),this.push((0,W.jsx)(m.default,{onBack:this._pop,editCollection:this.editCollection,onSeeCollection:this.onSeeCollection})),(0,w.logCollectionMenuClicked)((0,D.getProductCatalogContext)(this.props.context))},this.onSeeCollection=e=>{const t=a(85445).default;this.push((0,W.jsx)(t,{catalogId:this.props.catalogId,collection:e,product:null}))},this.editCollection=e=>{const t=d.CatalogCollection.get(this.props.catalogId);e||(0,w.logCollectionCreateClicked)((0,D.getProductCatalogContext)(this.props.context)),t&&this.push((0,W.jsx)(E.default,{onBack:this._pop,collection:e,catalog:t}))},this.onOpenSettings=()=>{this.push((0,W.jsx)(u.CatalogSettingsDrawer,{onBack:this._pop}))},this._onAddProduct=()=>this.props.onAddProduct(),this._onAddFirstProduct=()=>this.props.onAddFirstProduct(),this._onRemoveProduct=()=>this.props.onRemoveProduct(),this._onAddProductFromBusinessDetails=(0,s.default)((function*(){t._pop(),t._isComplianceFormVisible=!1,yield t.props.onComplianceFormClosed();d.CatalogCollection.get(t.props.catalogId)?t._onAddProduct():t._onAddFirstProduct()})),this._pop=()=>{this.pop(),f.Cmd.closeDrawerMid()},this._end=()=>{this.end(!0),f.Cmd.closeDrawerMid()}}componentDidMount(){null!=this.props.collection?this.onCollectionSeeAll(this.props.collection):null!=this.props.catalog?(this._showProductList(),null!=this.props.product&&this.onEditProduct(this.props.product)):this._showNewCatalog()}componentDidUpdate(){this.props.showComplianceForm&&!this._isComplianceFormVisible?(this._isComplianceFormVisible=!0,this._showComplianceForm()):this.props.showProductList&&!this._isProductListVisible&&(this._isProductListVisible=!0,this._showProductList())}_showNewCatalog(){this.push((0,W.jsx)(k.default,{isCreatingCatalogFn:this._isCreatingCatalog,onBack:this._pop,onAddProductClick:this._onAddFirstProduct}))}_showComplianceForm(){this.push((0,W.jsx)(L.MerchantDetailsFormFlowLoadable,{contactId:this.props.contact.id,enableCatalogCreationContext:!0,enableBusinessProfileAddress:!0,onAddProduct:this._onAddProductFromBusinessDetails,onBack:()=>{this._pop(),this._isComplianceFormVisible=!1,this.props.onComplianceFormClosed()},onUnmount:()=>{this._isComplianceFormVisible=!1,this.props.onComplianceFormClosed()}}))}}t.default=e=>{const t=(0,o.useContext)(S.DrawerContext),[a,n]=(0,o.useState)(z.PENDING),c=C.ContactCollection.get(e.catalogId),[u,h]=(0,o.useState)(!1),[p,m]=(0,o.useState)(!1),[E,I]=(0,o.useState)(!1),[T,w]=(0,o.useState)(!1),L=(0,o.useCallback)((()=>d.CatalogCollection.get(e.catalogId)),[e.catalogId]),k=(0,o.useCallback)((0,s.default)((function*(){var e;if(!c)return __LOG__(4,void 0,new Error,!0)`Cannot update compliance for non existing user`,void SEND_LOGS("catalog-management-flow-compliance-no-contact-error");n(z.PENDING);const t=null===(e=l.BusinessProfileCollection.get(c.id))||void 0===e?void 0:e.address;let a=z.NO;const i=L();!(0,b.canSeeECommerceComplianceIndiaHardEnforcementBusinessJourney)(c.id.user)||i&&i.productCollection.length||(0,v.isBusinessCompliant)(t,yield(0,g.getLegalEntityDetails)(c.id),c.id)||(a=z.YES),n(a)})),[c,L]),R=(0,o.useCallback)((()=>{const e=L();if(a===z.YES)h(!0);else if(a===z.PENDING)I(!0);else if(e){const a=new O.Product({catalogWid:e.id,additionalImageCdnUrl:[]});f.Cmd.openDrawerMid((0,W.jsx)(j.default,{catalog:e,product:a,newProduct:!0}),"slide-left",void 0,void 0,t,U.FocusType.TABBABLE)}}),[a,t,L]),N=(0,o.useCallback)((0,s.default)((function*(){w(!0);const a=(0,D.getProductCatalogContext)(t);(0,M.logCreateProductCatalogClick)(a),F.QPL.markerStart(B.QuickLogMarkerId.WHATSAPP_CATALOG_CREATE);let n=!0;try{yield(0,A.createCatalog)(),(0,M.logCreateProductCatalogSuccess)(a),n=!1,F.QPL.markerEnd(B.QuickLogMarkerId.WHATSAPP_CATALOG_CREATE,F.QuickLogActionType.SUCCESS);try{yield d.CatalogCollection.find(e.catalogId),m(!0),R()}catch(e){(0,r.filteredCatch)(V.ServerStatusCodeError,(()=>{__LOG__(3)`Failed to fetch product catalog from server`}))}}catch(e){(0,r.filteredCatch)(V.ServerStatusCodeError,(e=>{(0,M.logCreateProductCatalogFailed)(a,e.statusCode),f.Cmd.openToast((0,W.jsx)(G.Toast,{msg:P.default.t(835),id:(0,G.genId)("err_catalog_already_created")})),m(!0)}))}finally{n&&F.QPL.markerEnd(B.QuickLogMarkerId.WHATSAPP_CATALOG_CREATE,F.QuickLogActionType.FAIL)}w(!1)})),[e.catalogId,t,R]),H=(0,o.useCallback)((0,s.default)((function*(){a===z.YES?h(!0):a===z.PENDING?I(!0):yield N()})),[a,N]),q=(0,o.useCallback)((0,s.default)((function*(){yield k()})),[k]);return(0,o.useEffect)((()=>{k()}),[]),(0,o.useEffect)((()=>{const e=L();E&&a!==z.PENDING&&(I(!1),a===z.YES?h(!0):e?R():N()),a===z.YES&&f.Cmd.closeDrawerMid()}),[E,a,L,N,R]),c?E?(0,W.jsxs)(_.default,{children:[(0,W.jsx)(y.DrawerHeader,{title:P.default.t(440),onCancel:()=>{h(!1),I(!1)},type:y.DRAWER_HEADER_TYPE.LARGE}),(0,W.jsx)(x.default,{theme:"center-content",children:(0,W.jsx)(g.ComplianceInfoLoading,{})})]}):(0,W.jsx)(S.DrawerContext.Consumer,{children:t=>(0,W.jsx)(K,(0,i.default)({contact:c,context:t,mustCompleteCompliance:a,showComplianceForm:u,showProductList:p,isCreatingCatalog:T,onAddProduct:R,onAddFirstProduct:H,onRemoveProduct:q,onComplianceFormClosed:()=>(h(!1),k())},e))}):null}},64732:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a(79353)),s=n(a(99942)),r=a(62002),o=a(85893);class l extends s.default{constructor(...e){super(...e),this.onProductClick=e=>{this.push((0,o.jsx)(r.ProductDetailsFlowLoadable,{refreshCarousel:!0,chat:this.props.msg.chat,product:e,onEnd:this._pop}))},this._pop=()=>{this.pop()}}componentDidMount(){this.push((0,o.jsx)(i.default,{msg:this.props.msg,onProductClick:this.onProductClick}))}}t.default=l},50179:(e,t,a)=>{"use strict";var n=a(20862),i=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=a(61295),r=i(a(66578)),o=a(69162),l=a(7158),d=n(a(13540)),c=i(a(99942)),u=a(47683),h=n(a(10214)),f=a(79475),p=i(a(40630)),m=a(85893);class g extends c.default{constructor(...e){super(...e),this._refCaptureDrawer=null,this._setRefCaptureDrawer=e=>{this._refCaptureDrawer=e},this._pushPermissionModal=()=>{this.push((0,m.jsx)(u.GuidePopup,{messaging:u.Messaging.CAMERA,type:u.TYPE.GUIDE_ALLOW,onConfirm:this._popModal}),"modal")},this._popModal=()=>{this.pop("modal")},this._startCaptureDrawer=()=>{var e;null===(e=this._disposeStream)||void 0===e||e.call(this);const{asyncStream:t,disposeStream:a}=h.start("camera",this._pushPermissionModal);this._disposeStream=a,t.then((e=>{this._refCaptureDrawer||this._popModal(),e&&this._refCaptureDrawer&&this._refCaptureDrawer.loadNewStream(e,a)})).catch((0,s.filteredCatch)(d.GUM.NotAllowedError,(()=>{this.cleanUp(),o.Cmd.openModal((0,m.jsx)(u.GuidePopup,{messaging:u.Messaging.CAMERA_FAIL,type:u.TYPE.GUIDE_UNBLOCK}))}))).catch((0,s.filteredCatch)(d.GUM.GUMError,(()=>{this.cleanUp(),o.Cmd.openModal((0,m.jsx)(u.GuidePopup,{messaging:u.Messaging.CAMERA_MISSING,type:u.TYPE.GUIDE_NONE}))})))},this.onFinished=(e,t)=>{this.props.onFinished(e,t),this.cleanUp()},this.cleanUp=()=>{this.end()},this.onRetake=()=>{this.pop("flow-transition-box-size-drawer-pop"),this._startCaptureDrawer()},this.onCaptured=e=>{this.push((0,m.jsx)(f.Modal,{type:f.ModalTheme.Box,children:(0,m.jsx)(l.EditImageDrawer,{onRetake:this.onRetake,retryText:l.RETRY_OPTIONS.RETAKE,onFinished:this.onFinished,onCancel:this.cleanUp,img:e})}),"flow-transition-box-size-drawer-push")},this.handleRequestDismiss=e=>{!1===e&&this.stackSize()>1?this.onRetake():this.cleanUp()}}componentDidMount(){this.push((0,m.jsx)(f.Modal,{type:f.ModalTheme.Box,children:(0,m.jsx)(r.default,{ref:this._setRefCaptureDrawer,stream:void 0,disposeStream:void 0,caption:!1,theme:"capture-cover",onBack:this.cleanUp,onSend:null,onCaptured:this.onCaptured,chat:void 0})})),this._startCaptureDrawer()}componentWillUnmount(){var e;null===(e=this._disposeStream)||void 0===e||e.call(this)}}var v=(0,p.default)(g);t.default=v},42155:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(7158),s=n(a(99942)),r=a(85893);class o extends s.default{constructor(...e){super(...e),this.onEnd=()=>{this.end()},this.onFinished=(e,t)=>{this.props.onFinished(e,t),this.end()}}componentDidMount(){this.push((0,r.jsx)(i.EditImageDrawer,{onCancel:this.onEnd,onFinished:this.onFinished,onRetake:this.props.onRetake,retryText:i.RETRY_OPTIONS.RESTART,img:this.props.img}))}}t.default=o},2466:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(69162),s=a(74659),r=n(a(99942)),o=n(a(2408)),l=a(90676),d=a(21792),c=n(a(83153)),u=a(85893);class h extends r.default{constructor(...e){super(...e),this._onEditSuccess=e=>{(0,l.qplStartProductView)("EditProduct"),this._showInfoDrawer(e)},this._showInfoDrawer=e=>{const{catalog:t}=this.props;this.push((0,u.jsx)(d.ProductInfoDrawer,{catalog:t,product:e,onCancel:this.end,onEditProduct:this._onProductEdit,onShareProduct:this.onShareProduct}))},this.onShareProduct=e=>{this.push((0,u.jsx)(c.default,{onBack:this._pop,product:e,prompt:(0,u.jsx)("div",{children:o.default.t(501)}),onSend:()=>i.Cmd.closeDrawerMid(),centerDrawer:!0,sendProductMsg:!0}))},this._onProductEdit=e=>{this.push((0,u.jsx)(s.EditProductDrawer,{catalog:this.props.catalog,onBack:this._pop,onEditSuccess:this._onEditSuccess,product:e,onDelete:this.props.onDelete}))},this._pop=()=>{this.pop()},this._end=()=>{this.end(!0)}}componentDidMount(){const{catalog:e,product:t,onCreate:a,newProduct:n}=this.props;n?this.push((0,u.jsx)(s.EditProductDrawer,{onCancel:this._pop,onEditSuccess:e=>{a&&a(),this._onEditSuccess(e)},catalog:e,product:t,newProduct:!0})):this._showInfoDrawer(t)}}t.default=h},65682:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(61295),s=a(84758),r=a(69162),o=n(a(75940)),l=n(a(55454)),d=n(a(99942)),c=n(a(9324)),u=n(a(49461)),h=n(a(2408)),f=a(57774),p=a(65565),m=a(85893);class g extends d.default{constructor(...e){super(...e),this.requestFocus=()=>{var e;const t=null===(e=this.refUIE)||void 0===e?void 0:e.getRef();null!=t&&(t instanceof HTMLElement||"function"!=typeof t.onFocusList||t.onFocusList())},this.onForwardConfirmed=e=>{const{msgs:t,onForward:a}=this.props;s.ChatCollection.forwardMessagesToChats(t,e).catch((0,i.filteredCatch)(c.default,(e=>{this._showMediaSendError(e.reasons)}))),this.end(),a&&a(t),r.Cmd.openChatFromUnread(e[0])},this._showMediaSendError=e=>{const t=e.map((({chat:e,reason:t})=>(0,m.jsxs)("p",{children:[e.formattedTitle," : ",t]},e.id.toString())));r.Cmd.openModal((0,m.jsx)(o.default,{onOK:()=>r.Cmd.closeModal(),okText:h.default.t(2192),children:t}),void 0)}}componentDidMount(){const{msgs:e}=this.props,t=h.default.t(872,{_plural:e.length||1}),a=e[0],n=a.chat;let i;i="video"!==a.type&&"image"!==a.type?"message":a.type;const s=e.some((e=>e.isFrequentlyForwarded)),r=e.filter((e=>!e.isFrequentlyForwarded&&e.getForwardingScoreWhenForwarded()===l.default.FREQUENTLY_FORWARDED_SENTINEL));let o;r.length&&(o=(0,m.jsx)(u.default,{frequentlyForwardedCount:r.length,totalCount:e.length}));const d=s?p.ServerProps.frequentlyForwardedMax:p.ServerProps.multicastLimitGlobal;this.push((0,m.jsx)(f.SelectModal,{onConfirm:this.onForwardConfirmed,maxItems:d,excludeChat:n,excludeBroadcast:!0,msgType:i,title:t,listType:f.ListType.CHAT_SELECT_MODAL,customHeader:o,hasFrequentlyForwarded:s,ephemeralIcon:"chat-list"}))}}t.default=g},56396:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a(99942)),s=n(a(2251)),r=a(85893);class o extends i.default{componentDidMount(){this.push((0,r.jsx)(s.default,{chat:this.props.chat,onConfirm:this.props.onConfirm}))}}t.default=o},12158:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a(99942)),s=n(a(62286)),r=a(62002),o=a(85893);class l extends i.default{constructor(...e){super(...e),this.onProductClick=e=>{this.push((0,o.jsx)(r.ProductDetailsFlowLoadable,{refreshCarousel:!0,chat:this.props.msg.chat,product:e,onEnd:this._pop}))},this._pop=()=>{this.pop()}}componentDidMount(){this.push((0,o.jsx)(s.default,{msg:this.props.msg,onProductClick:this.onProductClick}))}}t.default=l},50731:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a(48926)),s=a(69162),r=n(a(75940)),o=a(62238),l=n(a(99942)),d=n(a(75798)),c=n(a(82981)),u=n(a(2408)),h=n(a(86245)),f=a(78972),p=a(88300),m=a(49201),g=a(85893);class v extends l.default{constructor(...e){var t;super(...e),t=this,this.onSendInvite=(e="",a)=>{s.Cmd.closeModal(),Promise.all(this.props.participantNeedInvite.map(function(){var n=(0,i.default)((function*(n){const{contact:i,invite_code:s,invite_code_exp:r}=n,l=yield(0,o.findChat)(i.id),c=t.props.groupGid.toString(),u=d.default.assertGet(c);return(yield l.sendGroupInviteMessage(c,t.props.subject,s||"",r,e,a))===p.SendMsgResult.OK&&(u.pendingParticipants.add({id:i.id}),!0)}));return function(){return n.apply(this,arguments)}}())).then((e=>{const t=e.filter(Boolean).length;s.Cmd.openToast((0,g.jsx)(m.Toast,{msg:u.default.t(2133,{num:t,_plural:t}),id:(0,m.genId)()}))}))},this._addInviteCommment=e=>{this.push((0,g.jsx)(c.default,{participants:e,gid:this.props.groupGid,subject:this.props.subject,groupDesc:this.props.groupDesc,onClose:this._pop,onSend:this.onSendInvite}))},this._pop=()=>{this.pop()}}componentDidMount(){const{participantNeedInvite:e}=this.props,t=this._getFormattedNames(e.map((e=>e.contact)),!0),a=u.default.t(988,{participant:t,_plural:e.length});this.push((0,g.jsx)(r.default,{onOK:this._addInviteCommment.bind(this,e),okText:u.default.t(2132),onCancel:this._pop,cancelText:u.default.t(1999),children:a}))}_getFormattedName(e,t=!1){return t?e.formattedUser:(0,g.jsx)(f.Name,{contact:e})}_getFormattedNames(e,t=!1){if(!Array.isArray(e))return this._getFormattedName(e,t);const a=e.map((e=>this._getFormattedName(e,t)));return(0,h.default)(a,t)}}t.default=v,v.defaultProps={removeTopDrawer:!0,pushTransition:"none",popTransition:"none"}},72739:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(7158),s=n(a(99942)),r=n(a(51642)),o=a(85893);class l extends s.default{constructor(...e){super(...e),this.onImageSelected=(e,t)=>{this.push((0,o.jsx)(i.EditImageDrawer,{onCancel:this._handleCancel,attributionUrl:t,onFinished:this.onFinished,onRetake:this._pop,retryText:i.RETRY_OPTIONS.NONE,img:e}))},this._handleCancel=()=>{this.end()},this._pop=()=>{this.pop()},this.onFinished=(e,t)=>{this.props.onFinished(e,t),this.end()}}componentDidMount(){this.push((0,o.jsx)(r.default,{onCancel:this._pop,onImageSelected:this.onImageSelected}))}}t.default=l},92243:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a(22011)),s=a(69162),r=n(a(75940)),o=n(a(55454)),l=n(a(99942)),d=n(a(2408)),c=a(59606),u=n(a(26456)),h=n(a(35355)),f=a(22555),p=a(85893);class m extends l.default{constructor(...e){super(...e),this.onDeleteLabel=e=>{e.forEach((({id:e})=>{c.LabelCollection.deleteLabel(e)}))},this._onManageLabels=e=>{s.Cmd.openModal((0,p.jsx)(f.ManageLabelFlowLoadable,{modelsToUpdate:e}))},this.onEditLabel=e=>{s.Cmd.openModal((0,p.jsx)(i.default,{labelId:e,onUpdateLabel:this.onUpdateLabel,onCancel:s.Cmd.closeModal()}))},this.onLabelClick=e=>{const t=a(19049).Z;this.push((0,p.jsx)(t,{openLabelColorDrawer:this.openLabelColorDrawer,labelId:e,onManageLabels:this._onManageLabels,onClose:this._pop,onRemoveLabel:this.onRemoveLabel,onEditLabel:this.onEditLabel}))},this.openAddLabel=()=>{c.LabelCollection.toArray().length>=o.default.MAX_SMB_LABEL_COUNT?s.Cmd.openModal((0,p.jsx)(r.default,{okText:d.default.t(1399),onOK:()=>s.Cmd.closeModal(),children:d.default.t(2360,{count:o.default.MAX_SMB_LABEL_COUNT})})):s.Cmd.openModal((0,p.jsx)(i.default,{onAddLabel:this.onAddLabel,onCancel:s.Cmd.closeModal()}))},this.onUpdateLabel=(e,t)=>{c.LabelCollection.updateLabel(e,t)},this.openLabelColorDrawer=(e,t)=>{this.push((0,p.jsx)(u.default,{labelId:e,onClose:this._pop,onUpdateColor:this.onUpdateLabel,currentColor:t}))},this._pop=()=>{this.pop()}}componentDidMount(){this.push((0,p.jsx)(h.default,{onDeleteLabel:this.onDeleteLabel,onLabelClick:this.onLabelClick,onClose:this._pop,openAddLabel:this.openAddLabel}))}onAddLabel(e,t){c.LabelCollection.addNewLabel(e,t)}onRemoveLabel(e,t){c.LabelCollection.addOrRemoveLabels([{id:e,type:"remove"}],t)}}t.default=m},19273:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.qplStartProductSendMessage=function(e,t,a){const s=i.QuickLogMarkerId.WHATSAPP_PRODUCT_MESSAGE_SEND;n.QPL.markerStart(s,{string:{EntryPoint:e}}),void 0!==t&&n.QPL.markerAnnotate(s,{int:{ProductCount:t}}),void 0!==a&&n.QPL.markerAnnotate(s,{int:{ContactCount:a}})},t.qplEndProductMessageSend=function(e){const t=i.QuickLogMarkerId.WHATSAPP_PRODUCT_MESSAGE_SEND;e.then((()=>{n.QPL.markerEnd(t,n.QuickLogActionType.SUCCESS)})).catch((()=>{n.QPL.markerEnd(t,n.QuickLogActionType.FAIL)}))};var n=a(21125),i=a(71578)},4255:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a(22011)),s=a(58380),r=a(69162),o=n(a(75940)),l=n(a(55454)),d=n(a(99942)),c=n(a(2408)),u=a(59606),h=a(12735),f=n(a(64827)),p=n(a(4231)),m=a(85893);class g extends d.default{constructor(...e){super(...e),this._newlyAddedLabels=new Set,this._logWamEvent=()=>{const e=this.props.modelsToUpdate.length;this._labelViewType=1===e?this.props.modelsToUpdate[0]instanceof s.Chat?p.default.LABEL_TARGETS.LABEL_CHAT_DIALOG:p.default.LABEL_TARGETS.LABEL_MESSAGE_DIALOG:p.default.LABEL_TARGETS.LABEL_COMBINED_DIALOG,(0,h.logLabelOperationEvent)(p.default.LABEL_OPERATIONS.VIEW,e,this._labelViewType)},this.onLabelUpdateComplete=()=>{this.props.onLabelUpdateComplete&&this.props.onLabelUpdateComplete(),this._pop()},this.onAddLabel=(e,t)=>{u.LabelCollection.addNewLabel(e,t).then((()=>{this._newlyAddedLabels.add(e)}))},this.shouldScrollIntoViewAndSelect=e=>this._newlyAddedLabels.has(e)?(this._newlyAddedLabels.delete(e),{shouldScrollIntoView:!0,shouldSelect:!0}):{shouldScrollIntoView:!1,shouldSelect:!1},this.onAddNewLabel=()=>{u.LabelCollection.toArray().length>=l.default.MAX_SMB_LABEL_COUNT?r.Cmd.openModal((0,m.jsx)(o.default,{okText:c.default.t(1399),onOK:()=>r.Cmd.closeModal(),children:c.default.t(2360,{count:l.default.MAX_SMB_LABEL_COUNT})})):this.push((0,m.jsx)(i.default,{onAddLabel:this.onAddLabel,onCancel:this._pop}))},this._popAndLogEvent=()=>{this._labelViewType&&(0,h.logLabelOperationEvent)(p.default.LABEL_OPERATIONS.CLICK_NEGATIVE,this.props.modelsToUpdate.length,this._labelViewType),this.pop()},this._pop=()=>{this.pop()}}componentDidMount(){this._logWamEvent(),this.push((0,m.jsx)(f.default,{shouldScrollIntoViewAndSelect:this.shouldScrollIntoViewAndSelect,onAddNewLabel:this.onAddNewLabel,onLabelUpdateComplete:this.onLabelUpdateComplete,onCancel:this._popAndLogEvent,modelsToUpdate:this.props.modelsToUpdate}))}}t.default=g,g.defaultProps={removeTopDrawer:!0,pushTransition:"none",popTransition:"none"}},76820:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a(81109)),s=n(a(48926)),r=a(99623),o=a(67294),l=(n(a(56720)),a(10297)),d=n(a(22882)),c=a(8581),u=a(85148),h=a(69162),f=a(10504),p=a(47898),m=n(a(55454)),g=n(a(17747)),v=n(a(9042)),C=a(55588),_=n(a(25061)),x=n(a(50508)),S=n(a(99942)),y=a(86723),E=a(78615),j=a(14179),I=n(a(2408)),T=a(97504),b=a(29458),P=a(81465),M=a(85893);const w={complianceInfoHelpCenterBanner:{color:"hp667wtd",paddingTop:"nlnf8xo7",paddingEnd:"bcymb0na",paddingBottom:"r219jyu0",paddingStart:"e8k79tju"},formContainer:{paddingTop:"a4bywxmn",paddingEnd:"bcymb0na",paddingBottom:"ekpn4oxx",paddingStart:"e8k79tju",marginBottom:"brac1wpa"},formTitle:{paddingTop:"i5tg98hk",paddingEnd:"f9ovudaz",paddingBottom:"przvwfww",paddingStart:"gx1rr48f",marginBottom:"oqp0d33z"},formTitleWithSubtitle:{paddingTop:"i5tg98hk",paddingEnd:"f9ovudaz",paddingBottom:"przvwfww",paddingStart:"gx1rr48f",marginBottom:"inww9tbj"},subtitle:{color:"hp667wtd",marginBottom:"oqp0d33z"},containingBlock:{transform:"cgi16xlc"}};class L extends S.default{componentDidMount(){this.push((0,M.jsx)(B,{contactId:this.props.contactId,enableCatalogCreationContext:this.props.enableCatalogCreationContext,enableBusinessProfileAddress:this.props.enableBusinessProfileAddress,onBack:()=>{this.props.onBack()},onAddProduct:this.props.onAddProduct}))}componentWillUnmount(){var e,t;null===(e=(t=this.props).onUnmount)||void 0===e||e.call(t)}}t.default=L;const k=e=>e?w.formTitleWithSubtitle:w.formTitle,O=()=>I.default.t(327),A=()=>I.default.t(323),D=e=>e?I.default.t(838):I.default.t(324),R=()=>I.default.t(325),N=e=>!e||(0,r.isPotentiallyPhoneNumber)(e),F=(0,y.getMeUser)(),B=(0,o.forwardRef)((({contactId:e,onBack:t,enableCatalogCreationContext:a,enableBusinessProfileAddress:n,onAddProduct:r},l)=>{const S=(0,o.useRef)(null);(0,o.useImperativeHandle)(l,(()=>({getElement:()=>S.current})));const[y,j]=(0,o.useState)({}),[b,L]=(0,o.useState)({}),[B,H]=(0,o.useState)(!0),[V,W]=(0,o.useState)(!1),[z,K]=(0,o.useState)(),[q,Y]=(0,o.useState)(!1);(0,o.useEffect)((()=>{let t=!0;return(0,s.default)((function*(){const[a,n]=yield Promise.all([(0,f.getLegalEntityDetails)(e),c.BusinessProfileCollection.find(e)]);t&&(j(a),K(n.serialize()),H(!1))}))(),()=>{t=!1}}),[e]),(0,o.useEffect)((()=>{Y(!Object.keys(b).length&&(0,p.isBusinessCompliant)(null==z?void 0:z.address,y,e))}),[y,b,null==z?void 0:z.address,e]);const Q=function(){var e=(0,s.default)((function*(e){yield(0,u.editBusinessCompliance)(e);const t=yield c.BusinessProfileCollection.update(F,{getMerchantCompliance:!0});return(Array.isArray(t)?t[0]:t).serialize().legalEntityDetails}));return function(){return e.apply(this,arguments)}}(),X=(0,o.useCallback)(function(){var e=(0,s.default)((function*(e,t){const a={[e]:t,isRegistered:null==y?void 0:y.isRegistered};j((0,i.default)((0,i.default)({},y),a));const n=yield Q(a);j(n)}));return function(){return e.apply(this,arguments)}}(),[y]),Z=(0,o.useCallback)(((e,t)=>{L((a=>(0,i.default)((0,i.default)({},a),{},{[`${e}.${t}`]:!0})))}),[]),$=(0,o.useCallback)(((e,t)=>{L((a=>{const n=(0,i.default)({},a);return delete n[`${e}.${t}`],n}))}),[]),J=(0,o.useCallback)(function(){var e=(0,s.default)((function*(e,t,a){const n={[e]:{[t]:a},isRegistered:null==y?void 0:y.isRegistered};j((0,i.default)((0,i.default)({},y),{},{[e]:(0,i.default)((0,i.default)({},null==y?void 0:y[e]),n[e])}));try{Z(e,t);const a=yield Q(n);j(a),$(e,t)}catch(e){throw new Error(e)}}));return function(){return e.apply(this,arguments)}}(),[y,Z,$]),ee=(0,o.useCallback)(function(){var e=(0,s.default)((function*(e){K(e),yield c.BusinessProfileCollection.update(F)}));return function(){return e.apply(this,arguments)}}(),[]),te=(0,o.useCallback)(function(){var t=(0,s.default)((function*(t,a){j(yield(0,f.getLegalEntityDetails)(e)),$(t,a)}));return function(){return t.apply(this,arguments)}}(),[e,$]),ae=(0,o.useCallback)(function(){var e=(0,s.default)((function*(e,t,a){if(e||t){W(!0);const n=yield Q({entityType:e,entityTypeCustom:t,isRegistered:a});W(!1),j(n)}}));return function(){return e.apply(this,arguments)}}(),[]),{entityName:ne,customerCareDetails:ie,grievanceOfficerDetails:se}=y||{},re=(0,o.useMemo)((()=>(0,p.getEntityTypeText)(y)),[y]),oe=(0,o.useCallback)((t=>(0,p.existsField)(t,e)),[e]),le=(0,o.useRef)(null),de=(0,E.canSeeECommerceComplianceIndiaHardEnforcementBusinessJourney)(F.user);return(0,M.jsx)("div",{ref:S,children:(0,M.jsxs)(g.default,{xstyle:w.containingBlock,children:[(0,M.jsx)(C.DrawerHeader,{title:I.default.t(322),onBack:t,type:C.DRAWER_HEADER_TYPE.LARGE}),(0,M.jsx)(v.default,{theme:B?"center-content":void 0,ref:le,children:B?(0,M.jsx)(f.ComplianceInfoLoading,{}):(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(f.ComplianceInfoHelpCenterBanner,{xstyle:w.complianceInfoHelpCenterBanner}),(0,M.jsxs)(_.default,{titleXStyle:w.formTitle,xstyle:[w.formContainer],children:[(0,M.jsx)(U,{value:ne,maxLength:m.default.COMPLIANCE_INFO_LENGTH.ENTITY_NAME,placeholder:I.default.t(337),icon:"info",validate:oe,errorFn:O,onSave:e=>X("entityName",e)}),(0,M.jsx)(U,{value:re,placeholder:I.default.t(338),icon:"account-balance",onFocus:()=>h.Cmd.showMerchantDetailsEntityTypePopup(y,ae),isLoading:V}),de?(0,M.jsx)(G,{rawBusinessProfile:z,validate:oe,onAfterSave:ee,errorFn:A}):null]}),(0,M.jsxs)(_.default,{title:I.default.t(317),titleXStyle:k(de),xstyle:[w.formContainer],children:[de?(0,M.jsx)(T.TextDiv,{xstyle:w.subtitle,children:I.default.t(321)}):null,(0,M.jsx)(U,{value:null==ie?void 0:ie.mobileNumber,maxLength:m.default.COMPLIANCE_INFO_LENGTH.MOBILE_NUMBER,placeholder:I.default.t(320),icon:"phone",validate:t=>(0,p.existsCustomerCareDetailsContact)(ie,e,"mobileNumber",t)&&N(t),onSave:e=>J("customerCareDetails","mobileNumber",e),onCancel:()=>te("customerCareDetails","mobileNumber"),onError:t=>(0,f.handleCustomerCareDetailsError)(ie,e,"mobileNumber",t),errorFn:t=>(0,p.getCustomerCareDetailsError)(ie,"mobileNumber",t,I.default.t(328),e)}),(0,M.jsx)(U,{value:null==ie?void 0:ie.landlineNumber,maxLength:m.default.COMPLIANCE_INFO_LENGTH.LANDLINE_NUMBER,placeholder:I.default.t(319),icon:"phone",validate:t=>(0,p.existsCustomerCareDetailsContact)(ie,e,"landlineNumber",t)&&N(t),onSave:e=>J("customerCareDetails","landlineNumber",e),onCancel:()=>te("customerCareDetails","landlineNumber"),onError:t=>(0,f.handleCustomerCareDetailsError)(ie,e,"landlineNumber",t),errorFn:t=>(0,p.getCustomerCareDetailsError)(ie,"landlineNumber",t,I.default.t(326),e)}),(0,M.jsx)(U,{value:null==ie?void 0:ie.email,maxLength:m.default.COMPLIANCE_INFO_LENGTH.EMAIL,placeholder:I.default.t(318),icon:"business-email",validate:e=>oe(e)&&(0,P.validateEmail)(e),onSave:e=>J("customerCareDetails","email",e),errorFn:D})]}),(0,M.jsxs)(_.default,{title:I.default.t(329),titleXStyle:k(de),xstyle:[w.formContainer],children:[de?(0,M.jsx)(T.TextDiv,{xstyle:w.subtitle,children:I.default.t(334)}):null,(0,M.jsx)(U,{value:null==se?void 0:se.name,maxLength:m.default.COMPLIANCE_INFO_LENGTH.GRIEVANCE_OFFICER_NAME,placeholder:I.default.t(333),validate:oe,icon:"assignment-ind",onSave:e=>J("grievanceOfficerDetails","name",e),errorFn:R}),(0,M.jsx)(U,{value:null==se?void 0:se.mobileNumber,maxLength:m.default.COMPLIANCE_INFO_LENGTH.MOBILE_NUMBER,placeholder:I.default.t(332),icon:"phone",validate:t=>(0,p.existsGrievanceOfficerDetailsContact)(se,e,"mobileNumber",t)&&N(t),onSave:e=>J("grievanceOfficerDetails","mobileNumber",e),onCancel:()=>te("grievanceOfficerDetails","mobileNumber"),onError:t=>(0,f.handleGrievanceOfficerDetailsError)(se,e,"mobileNumber",t),errorFn:t=>(0,p.getGrievanceOfficerDetailsError)(se,"mobileNumber",t,I.default.t(328),e)}),(0,M.jsx)(U,{value:null==se?void 0:se.landlineNumber,maxLength:m.default.COMPLIANCE_INFO_LENGTH.LANDLINE_NUMBER,placeholder:I.default.t(331),icon:"phone",validate:t=>(0,p.existsGrievanceOfficerDetailsContact)(se,e,"landlineNumber",t)&&N(t),onSave:e=>J("grievanceOfficerDetails","landlineNumber",e),onCancel:()=>te("grievanceOfficerDetails","landlineNumber"),onError:t=>(0,f.handleGrievanceOfficerDetailsError)(se,e,"landlineNumber",t),errorFn:t=>(0,p.getGrievanceOfficerDetailsError)(se,"landlineNumber",t,I.default.t(326),e)}),(0,M.jsx)(U,{value:null==se?void 0:se.email,maxLength:m.default.COMPLIANCE_INFO_LENGTH.EMAIL,placeholder:I.default.t(330),icon:"business-email",validate:t=>(0,p.existsGrievanceOfficerDetailsContact)(se,e,"email",t)&&(0,P.validateEmail)(t),onSave:e=>J("grievanceOfficerDetails","email",e),onError:t=>(0,f.handleGrievanceOfficerDetailsError)(se,e,"email",t),errorFn:t=>(0,p.getGrievanceOfficerDetailsError)(se,"email",t,I.default.t(838),e)})]}),null!=a&&null!=r?(0,M.jsx)(x.default,{disabled:!q,rootRef:le.current,onClick:()=>(0,d.default)(r),children:I.default.t(310)}):null]})})]})})}));function U({value:e="",maxLength:t,placeholder:a,icon:n,isLoading:i=!1,validate:r,errorFn:l,onChange:d,onSave:c,onCancel:u,onError:h,onFocus:f}){const[p,m]=(0,o.useState)(e),[g,v]=(0,o.useState)(),[C,_]=(0,o.useState)(i);return(0,o.useEffect)((()=>{m(e)}),[e]),(0,o.useEffect)((()=>{(null==r?void 0:r(p))&&v(null)}),[p,r,l]),(0,o.useEffect)((()=>{_(i)}),[i]),(0,M.jsx)(j.IconSection,{icon:n,theme:j.IconSectionTheme.NoMargin,content:(0,M.jsx)(b.TextInput,{value:p,editable:!0,maxLength:t,pending:C,inputPlaceholder:a,showRemaining:!0,managedError:!0,validate:r,error:g,onChange:m,onSave:(0,s.default)((function*(){_(!0);try{yield null==c?void 0:c(p)}catch(e){l&&v(l(p))}_(!1)})),onCancel:()=>{m(e),v(null),null==u||u()},onError:()=>{l&&v(l(p)),null==h||h(p)},theme:"text-input",onFocus:f,blockFocusOnLock:!!f,lockable:!0})})}function H(e,t,a){return{address:e,categories:[],hours:{days:[]},longitude:t,latitude:a}}function G({rawBusinessProfile:e,validate:t,onAfterSave:a,errorFn:n}){const[r,d]=(0,o.useState)(),[c,h]=(0,o.useState)(null==e?void 0:e.address),[f,p]=(0,o.useState)(),{longitude:m,latitude:g}=e||{},[v,C]=(0,o.useState)(H(c,m,g));return(0,o.useEffect)((()=>C(H(c,m,g))),[c,m,g]),(0,o.useEffect)((()=>{t(c)&&p(null)}),[c,t]),null==e||null==v?null:(0,M.jsx)(j.IconSection,{icon:"business-address",theme:j.IconSectionTheme.NoMargin,content:(0,M.jsx)(l.BusinessAddressField,{businessProfile:v,activeField:r,rawBusinessProfile:e,value:c,validate:t,error:f,lowProfile:!1,onActive:d,onChange:h,onCancel:()=>{h(e.address)},onSaveBusinessProfile:(0,s.default)((function*(){yield(0,u.editBusinessProfile)({address:c}),yield a((0,i.default)((0,i.default)({},e),{},{address:c}))})),onError:()=>{n&&p(n(c))}})})}},58716:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(69162),s=a(17025),r=n(a(18670)),o=a(62238),l=n(a(99942)),d=n(a(2408)),c=a(20917),u=n(a(91142)),h=n(a(63982)),f=a(85893);class p extends l.default{constructor(...e){super(...e),this._handleClick=(e,t)=>{(0,o.findChat)(t.id).then(i.Cmd.openChatFromUnread.bind(i.Cmd)),this.end()},this._handleNewGroup=()=>{this.push((0,f.jsx)(h.default,{onBack:this.pop,onContinue:this._handleSetGroupInfo}))},this._handleNewCommunity=()=>{i.Cmd.openDrawerLeft((0,f.jsx)(c.NewCommunityFlowLoadable,{}))},this._handleSetGroupInfo=e=>{this.push((0,f.jsx)(u.default,{participants:e,onBack:()=>{this.popAndUpdate({participants:e})},onContinue:this.end}))}}componentDidMount(){s.ContactCollection.ensureSorted(),this.push((0,f.jsx)(r.default,{title:d.default.t(1360),onBack:this.end,onClick:this._handleClick,onNewGroup:this._handleNewGroup,onNewCommunity:this._handleNewCommunity}))}}t.default=p},84943:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a(99942)),s=n(a(70718)),r=a(85893);class o extends i.default{constructor(...e){super(...e),this._handleCommunityDrawer=()=>{this.push((0,r.jsx)(s.default,{handleBack:this._pop,handleContinue:this._handleContinue}))},this._pop=()=>{this.pop()},this._handleContinue=()=>{}}componentDidMount(){this._handleCommunityDrawer()}}t.default=o},44692:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(17025),s=n(a(99942)),r=n(a(91142)),o=n(a(63982)),l=a(85893);class d extends s.default{constructor(...e){super(...e),this.onSetGroupInfo=e=>{this.push((0,l.jsx)(r.default,{participants:e,onBack:()=>{this.popAndUpdate({participants:e})},onContinue:this.end}))}}componentDidMount(){i.ContactCollection.ensureSorted(),this.push((0,l.jsx)(o.default,{onBack:this.end,onContinue:this.onSetGroupInfo}))}}t.default=d},48105:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=D;var i=n(a(81109)),s=n(a(48926)),r=a(67294),o=a(8581),l=n(a(38859)),d=n(a(17663)),c=n(a(64305)),u=a(69162),h=a(70458),f=n(a(75940)),p=a(17025),m=a(79864),g=n(a(99942)),v=a(78615),C=n(a(2408)),_=a(30333),x=n(a(15540)),S=n(a(79354)),y=n(a(17813)),E=n(a(22120)),j=a(70790),I=n(a(35154)),T=a(7127),b=n(a(83153)),P=a(27370),M=a(36873),w=n(a(22685)),L=n(a(64883)),k=a(89573),O=a(85893);class A extends g.default{constructor(...e){var t;super(...e),t=this,this.scrollOffset=0,this.setScrollOffset=e=>{this.scrollOffset=e},this.onCollectionSeeAll=e=>{const{catalogOwnerJid:t,chat:a,product:n,productInfo:i,sellerJid:s}=this.props,r=t||(null==n?void 0:n.catalogWid.toString())||(null==i?void 0:i.businessOwnerJid)||s;this.push((0,O.jsx)(D,{chat:a,catalogOwnerJid:r,collection:e,isAllItems:!e}))},this._pushProductDetails=(e,t)=>{const{chat:a,refreshCarousel:n}=this.props,i=(0,O.jsx)(I.default,{chat:a,product:e,onEnd:this._end,onBack:this._popAndUpdate,onProductDetail:this.onProductDetail,onProductCatalog:this.onProductCatalogHeaderClick,onProductLinkClick:this._onProductLinkClick,onProductMoreInformation:this.onProductMoreInformation,refreshCarousel:n,onCartClick:this._onCartClick,collectionId:t});this.push(i)},this._pushProductMoreInformation=e=>{const t=(0,O.jsx)(w.default,{product:e,onBack:this._popAndUpdate});this.push(t)},this._pushProductDetailsWithDeepLink=e=>{const t=(0,O.jsx)(T.ProductDetailsWithDeepLink,{chat:this.props.chat,productInfo:e,onEnd:this._end,onBack:this._pop,onProductDetail:this.onProductDetail,onProductCatalog:this.onProductCatalogHeaderClick,onProductLinkClick:this._onProductLinkClick,onProductMoreInformation:this.onProductMoreInformation,onCartClick:this._onCartClick});this.push(t)},this.pushProductCatalog=function(){var e=(0,s.default)((function*(e){const a=p.ContactCollection.gadd(e),n=yield o.BusinessProfileCollection.find(e),i=(0,v.canViewCollections)()?(0,O.jsx)(c.default,{contact:a,onProductDetail:t.onProductDetail,catalogId:e,onBack:t._pop,businessProfile:n,scrollOffset:t.scrollOffset,setScrollOffset:t.setScrollOffset,onCatalogLinkClick:t._onCatalogLinkClick,onCartClick:t._onCartClick,onCollectionSeeAll:t.onCollectionSeeAll}):(0,O.jsx)(P.ProductListDrawer,{contact:a,onProductDetail:t.onProductDetail,catalogId:e,onBack:t._pop,businessProfile:n,setScrollOffset:t.setScrollOffset,onCatalogLinkClick:t._onCatalogLinkClick,onCartClick:t._onCartClick});t.push(i)}));return function(){return e.apply(this,arguments)}}(),this._pushCartOrderDetail=(e,t,a,n,i,s,r)=>{const o=(0,O.jsx)(l.default,{orderId:e,token:t,sellerJid:a,userIsCartOwner:n,onProductDetail:this._onProductDetailFromInfo,onOrderCreate:this.onOrderCreate,onOrderCancel:this._handleOrderCancel,ownerHasReviewed:i,orderMessage:s,chat:r});this.push(o)},this._pushProductList=(e,t)=>{const a=p.ContactCollection.gadd(t),n=(0,O.jsx)(M.ProductMessageListDrawer,{contact:a,productListId:e,onProductDetail:this.onProductDetail,onCartClick:this._onCartClick,onBack:this._pop,onEnd:this._end,setScrollOffset:this.setScrollOffset});this.push(n)},this._handleProductSummaryClick=e=>{this._pushOrderDetailProductList(e)},this._handleOrderStatusUpdateClick=()=>{this._pushOrderStatusUpdate()},this.onOrderCreate=e=>{this._pushOrderCreate(e)},this.cancelOrder=()=>{const{orderId:e,token:t,sellerJid:a,userIsCartOwner:n,orderMessage:i,chat:s}=this.props;null!=e&&null!=t&&null!=a&&null!=n&&this._pushCartOrderDetail(e,t,a,n,!0,i,s),u.Cmd.closeModal()},this._handleOrderCancel=()=>{u.Cmd.openModal((0,O.jsx)(f.default,{onCancel:()=>{u.Cmd.closeModal()},cancelText:C.default.t(2189),onOK:this.cancelOrder,okText:C.default.t(1421),title:C.default.t(1424),children:C.default.t(1423)}))},this.onProductDetail=(e,t)=>{this._pushProductDetails(e,t)},this.onProductMoreInformation=e=>{this._pushProductMoreInformation(e)},this._onProductDetailFromInfo=e=>{this._pushProductDetailsWithDeepLink(e)},this.onProductCatalogHeaderClick=(e,t)=>{(0,_.logCarouselViewMoreClick)({catalogOwnerWid:e,catalogContext:t}),this.pushProductCatalog(e)},this._onProductLinkClick=e=>{this.push((0,O.jsx)(b.default,{product:e,onBack:this._pop}))},this._onCatalogLinkClick=(e,t)=>{this.push((0,O.jsx)(d.default,{catalog:e,contact:t,onBack:this._pop}))},this._onCartClick=e=>{const t=(0,j.getProductCatalogContext)(this.props.context),a=(0,L.default)(e,this.props.chat,t);a&&this.push(a)},this._pop=()=>{this.pop()},this._end=()=>{this.end(!0)},this._popAndUpdate=()=>{this.popAndUpdate({scrollOffset:this.scrollOffset})}}componentDidMount(){const{catalogOwnerJid:e,orderId:t,product:a,productInfo:n,productListId:i,collection:s,collectionId:r,isAllItems:o,token:l,sellerJid:d,userIsCartOwner:c,orderMessage:u,chat:h,orderInfo:f}=this.props;if(e)s||o?this.pushCollectionContent((0,k.createWid)(e)):null!=i?this._pushProductList(i,(0,k.createWid)(e)):this.pushProductCatalog((0,k.createWid)(e));else if(a)this._pushProductDetails(a,r);else if(n)this._pushProductDetailsWithDeepLink(n);else if(t)null!=l&&null!=d&&null!=c&&this._pushCartOrderDetail(t,l,d,c,!1,u,h);else{if(null==f||null==d)throw new Error("ProductDetailsFlow:no-product");this._pushOrderDetail(f,(0,k.createWid)(d))}}pushCollectionContent(e){const t=p.ContactCollection.gadd(e);this.push((0,O.jsx)(h.CollectionContentDrawer,{contact:t,onProductDetail:this.onProductDetail,catalogId:e,onBack:this._pop,onCatalogLinkClick:this._onCatalogLinkClick,onCartClick:this._onCartClick,scrollOffset:this.scrollOffset,setScrollOffset:this.setScrollOffset,collection:this.props.collection}))}_pushOrderCreate(e){this.push((0,O.jsx)(x.default,{chat:this.props.chat,onBack:this._pop,order:e,onProductSummaryClick:this._handleProductSummaryClick}))}_pushOrderDetailProductList(e){this.push((0,O.jsx)(y.default,{onBack:this._pop,productItems:e}))}_pushOrderDetail(e,t){this.push((0,O.jsx)(S.default,{onBack:this._pop,orderInfo:e,sellerWid:t,onProductSummaryClick:this._handleProductSummaryClick,onOrderStatusUpdateClick:this._handleOrderStatusUpdateClick}))}_pushOrderStatusUpdate(){this.push((0,O.jsx)(E.default,{chat:this.props.chat,onBack:this._pop}))}}function D(e){const t=(0,r.useContext)(m.DrawerContext);return(0,O.jsx)(A,(0,i.default)({context:t},e))}},18833:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a(48926)),s=n(a(70735)),r=a(69162),o=a(17025),l=n(a(99942)),d=n(a(2408)),c=a(29518),u=a(57774),h=a(85854),f=a(20749),p=a(59603),m=a(49201),g=a(12825),v=a(89573),C=a(85893);function _(e){switch(e){case"about":return d.default.t(1025);case"profilePicture":return d.default.t(1027);case"lastSeen":return d.default.t(1026);case"groupAdd":return d.default.t(1472)}}class x extends l.default{constructor(...e){var t;super(...e),t=this,this._excludedContacts=[],this._handleConfirm=function(){var e=(0,i.default)((function*(e,a){const n=t._excludedContacts.map((e=>e.id)),i=e.map((e=>e.id)),o=[...(0,s.default)(i,n,(e=>e.toString())).map((e=>({action:f.PrivacyUserAction.Add,wid:e}))),...(0,s.default)(n,i,(e=>e.toString())).map((e=>({action:f.PrivacyUserAction.Remove,wid:e})))],l=(0,p.privacyWebNameToServerName)(t.props.category);if("readreceipts"===l)throw new Error("select_contacts_except_flow: name can not be readreceipts");try{yield(0,p.setPrivacyForOneCategory)({value:"contact_blacklist",users:o,dhash:a,name:l},i),t.props.onConfirm()}catch(e){e instanceof g.ServerStatusCodeError&&409===e.statusCode||(__LOG__(3,void 0,void 0,!0)`select_contacts_except_flow: set visiblity option failed ${e.stack}`,SEND_LOGS("select_contacts_except_flow: set visiblity option failed")),r.Cmd.openToast((0,C.jsx)(m.Toast,{id:(0,m.genId)(),msg:d.default.t(853)}))}t.pop()}));return function(){return e.apply(this,arguments)}}()}componentDidMount(){this._pushSelectModalToFlow()}_pushSelectModalToFlow(){var e=this;return(0,i.default)((function*(){const{category:t}=e.props;let a=null;try{const n=yield(0,c.getTable)().get(function(e){switch(e){case"about":return c.PrivacyDisallowedListType.About;case"profilePicture":return c.PrivacyDisallowedListType.ProfilePicture;case"lastSeen":return c.PrivacyDisallowedListType.LastSeen;case"groupAdd":return c.PrivacyDisallowedListType.GroupAdd}}(t));null!=n&&(e._excludedContacts=n.disallowedList.map((e=>o.ContactCollection.gadd((0,v.createWid)(e)))),a=n.dhash)}catch(t){return __LOG__(4,void 0,new Error,!0)`error: ${String(t.stack)}`,SEND_LOGS("SelectContactsExceptFlow:failed to get privacyDisallowedList"),r.Cmd.openToast((0,C.jsx)(m.Toast,{id:(0,m.genId)(),msg:d.default.t(852)})),void e.pop()}const n=new Set(e._excludedContacts.map((e=>e.id.toString())));e.push((0,C.jsx)(u.SelectModal,{title:_(t),onCancel:()=>e.pop(),onConfirm:t=>{e._handleConfirm(t,a)},getInitialItems:()=>e._excludedContacts,listType:u.ListType.CONTACT_SELECT_MODAL,maxItems:64e3,singleSelectionFooterType:h.FooterType.CONFIRM,multipleSelectionFooterType:h.FooterType.CONFIRM,useAllContacts:!0,filter:e=>n.has(e.id.toString())||o.ContactCollection.isFilteredContact(e),getSelectionSummary:S,enableSelectAll:!0,activeWithoutSelection:!0}))}))()}}function S(e){const t=e.length;return d.default.t(1473,{count:t,_plural:t})}t.default=x},25571:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a(81109)),s=n(a(99942)),r=n(a(2408)),o=a(57774),l=n(a(16875)),d=a(65565),c=a(85893);class u extends s.default{constructor(...e){super(...e),this._handleForwardConfirmed=e=>{0===e.length&&this.end(),this._chatsToForwardTo=e,this._sendContactToChats(e)},this._sendContactToChats=e=>{for(const t of e)(0,l.default)(this.props.contacts,t),t.composeQuotedMsg=null;this.props.onContactsSent(e[0]),this.end()},this._popNone=()=>{this.pop("none")},this._handleCancel=()=>{this.end()}}componentDidMount(){const e=null==this.props.maxItems?this.props.serverProps.maxParticipants:this.props.maxItems;this.push((0,c.jsx)(o.SelectModal,{onConfirm:this._handleForwardConfirmed,maxItems:e,title:r.default.t(1654),listType:o.ListType.CHAT_SELECT_MODAL,onCancel:this._handleCancel}))}}t.default=e=>(0,c.jsx)(u,(0,i.default)((0,i.default)({},e),{},{serverProps:d.ServerProps}))},57825:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t;const{chat:a}=e,n=(0,i.default)(null===(t=a.groupMetadata)||void 0===t?void 0:t.groupInviteLink,"chat.groupMetadata?.groupInviteLink"),l=`${s.default.t(981)} ${n}`;return(0,o.jsx)(r.default,{title:s.default.t(955),text:l,pushTransition:"none",popTransition:"none"})};var i=n(a(48158)),s=n(a(2408)),r=n(a(24024)),o=a(85893)},45510:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a(81109)),s=n(a(48926)),r=a(38512),o=a(69162),l=n(a(99942)),d=n(a(2408)),c=a(57774),u=a(30239),h=a(65565),f=a(85893);class p extends l.default{constructor(...e){var t;super(...e),t=this,this.onForwardConfirmed=e=>{const a=this.props.msgText;if(1===e.length){let n;const i=e[0];n=i.isUser&&i.contact.isBlocked()?(0,r.unblockContact)(i.contact):Promise.resolve(!0),n.then(function(){var e=(0,s.default)((function*(){if(a){if(i.urlText=t.props.urlText,i.active)return void o.Cmd.pasteChatTextInput(i,a);i.setComposeContents({text:a})}(yield o.Cmd.openChatFromUnread(i))&&o.Cmd.focusChatTextInput(i)}));return function(){return e.apply(this,arguments)}}())}else Promise.all(e.map((e=>{let t;t=e.isUser&&e.contact.isBlocked()?(0,r.unblockContact)(e.contact):Promise.resolve(!0),t.then((()=>{e.urlText=this.props.urlText,(0,u.sendTextMsgToChat)(e,a)}))}))),o.Cmd.openChatFromUnread(e[0]);this.end()}}componentDidMount(){this.push((0,f.jsx)(c.SelectModal,{onConfirm:this.onForwardConfirmed,maxItems:this.props.serverProps.multicastLimitGlobal,title:d.default.t(1270),listType:c.ListType.CHAT_SELECT_MODAL}))}}t.default=e=>(0,f.jsx)(p,(0,i.default)((0,i.default)({},e),{},{serverProps:h.ServerProps}))},1483:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a(48926)),s=a(38512),r=a(69162),o=n(a(55454)),l=n(a(99942)),d=n(a(2408)),c=a(19273),u=a(57774),h=a(65565),f=a(85893);class p extends l.default{constructor(...e){var t;super(...e),t=this,this._handleForwardConfirmed=e=>{(0,c.qplStartProductSendMessage)("Forward",void 0,e.length);const a=e.map(function(){var e=(0,i.default)((function*(e){return e.isUser&&e.contact.isBlocked()&&(yield(0,s.unblockContact)(e.contact)),t._sendProduct(e)}));return function(){return e.apply(this,arguments)}}());(0,c.qplEndProductMessageSend)(Promise.all(a)),this.end(),1===e.length&&(r.Cmd.openChatFromUnread(e[0]),window.innerWidth<=o.default.LAYOUT_2COLUMNS_MAX_WIDTH&&r.Cmd.closeDrawerRight()),this.props.onSend&&this.props.onSend()},this._handleCancel=()=>{this.end()},this._sendProduct=e=>{const{product:t}=this.props;return new Promise(((a,n)=>{r.Cmd.once("ui_idle",(()=>{e.sendProductMessage(t).then((()=>a())).catch((e=>n(e)))}))}))}}componentDidMount(){r.Cmd.closeContextMenu(),r.Cmd.closeTooltip(),this.push((0,f.jsx)(u.SelectModal,{onConfirm:this._handleForwardConfirmed,maxItems:h.ServerProps.multicastLimitGlobal,title:d.default.t(1270),listType:u.ListType.CHAT_SELECT_MODAL,onCancel:this._handleCancel}))}}t.default=p},55310:(e,t,a)=>{"use strict";var n=a(20862),i=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=i(a(53427)),r=i(a(33322)),o=n(a(28047)),l=a(69162),d=a(9322),c=a(17025),u=i(a(99942)),h=a(86723),f=i(a(50792)),p=i(a(53683)),m=i(a(64170)),g=i(a(88616)),v=i(a(4879)),C=a(86618),_=a(2606),x=a(3165),S=i(a(7883)),y=i(a(87947)),E=i(a(24148)),j=a(22360),I=i(a(63252)),T=i(a(12824)),b=a(85893);class P extends u.default{constructor(...e){super(...e),this._showWallpaperDrawer=()=>{this.push((0,b.jsx)(T.default,{onClose:this._pop}))},this._showArchiveSettingsDrawer=()=>{this.push((0,b.jsx)(s.default,{settings:y.default,onClose:this._pop}))},this._showBlockedDrawer=()=>{this.push((0,b.jsx)(r.default,{onClose:this._pop}))},this._showProfileDrawer=()=>{const e=(0,h.getMaybeMeUser)(),t=j.StatusCollection.assertGet(e),a=x.ProfilePicThumbCollection.assertGet(e),n=c.ContactCollection.assertGet(e);this.push((0,b.jsx)(_.ProfileDrawerFlowLoadable,{status:t,profilePicThumb:a,contact:n,conn:d.Conn,onClose:this._pop}))},this._showNotifications=()=>{this.push((0,b.jsx)(g.default,{onClose:this._pop}))},this._showMediaAutoDownload=()=>{this.push((0,b.jsx)(m.default,{onClose:this._pop}))},this._showSecurity=()=>{this.push((0,b.jsx)(S.default,{onClose:this._pop}))},this._showPrivacyVisibilityEditDrawer=e=>{this.push((0,b.jsx)(C.PrivacyVisibilityEditDrawer,{onClose:this._pop,category:e}))},this._showPrivacyDrawer=()=>{this.push((0,b.jsx)(v.default,{onClose:this._pop,onOpenVisibilityEditDrawer:this._showPrivacyVisibilityEditDrawer,onOpenBlockedContacts:this._showBlockedDrawer}))},this._showDesktopSettingsDrawer=()=>{},this._showHelp=()=>{o.upload({reason:"help-page-opened",isHighPri:!0}),this.push((0,b.jsx)(f.default,{onClose:this._pop}))},this._showThemePopup=()=>{l.Cmd.openModal((0,b.jsx)(I.default,{}))},this.showKeyboardShortcuts=()=>{l.Cmd.openModal((0,b.jsx)(p.default,{}))},this._pop=()=>{this.pop()}}componentDidMount(){this.push((0,b.jsx)(E.default,{profileId:(0,h.getMaybeMeUser)(),onWallpaper:this._showWallpaperDrawer,onBlocked:this._showBlockedDrawer,onProfile:this._showProfileDrawer,onNotifications:this._showNotifications,onMediaAutoDownload:this._showMediaAutoDownload,onSecurity:this._showSecurity,onPrivacy:this._showPrivacyDrawer,onDesktopSettings:()=>{},onHelp:this._showHelp,onThemeSettings:this._showThemePopup,onKeyboardShortcuts:this.showKeyboardShortcuts,onClose:this._pop,settings:y.default,onArchiveSettings:this._showArchiveSettingsDrawer}))}}t.default=P},34524:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(69162),s=n(a(99942)),r=a(71681),o=n(a(32417)),l=n(a(28486)),d=a(85893);class c extends s.default{constructor(...e){super(...e),this.sessionId=Math.round(1e9*Math.random()),this._openStatusViewer=(e,t,a)=>{this.push((0,d.jsx)(l.default,{initialStatusV3:e,initialStatusMsg:t,closeStatusViewer:this.closeStatusViewer,sessionId:this.sessionId,rowIdx:a}),"none")},this.closeStatusViewer=e=>{e?this.end():this.pop("none")}}componentDidMount(){this.push((0,d.jsx)(o.default,{onOpenStatus:this._openStatusViewer,closeStatusViewer:this.closeStatusViewer,sessionId:this.sessionId}),"status-v3-modal"),this.props.listeners.add(i.Cmd,"close_status_viewer",(()=>{this.closeStatusViewer(!0)}))}componentWillUnmount(){this.props.onFlowEnd()}}var u=(0,r.ListenerHOC)(c);t.default=u},91035:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(69162),s=n(a(99942)),r=n(a(4231)),o=n(a(67868)),l=n(a(47779)),d=n(a(14053)),c=a(85893);class u extends s.default{constructor(...e){super(...e),this._scrollOffset=0,this._handleScrollOffsetChange=e=>{this._scrollOffset=e},this.handleStickerStore=()=>{const e=(0,c.jsx)(d.default,{onStickerPackDetails:this.handleStickerPackDetails,onClose:this._pop,onScrollOffsetChange:this._handleScrollOffsetChange});this.push(e)},this.handleStickerPackDetails=e=>{const t=(0,c.jsx)(l.default,{stickerPack:e,onStickerClick:this.handleStickerDetails,onStickerEnter:this.handleStickerDetails,onBack:this._handleBackStickerPackDetails});this.push(t)},this.handleStickerPackDetailsById=e=>{const t=(0,c.jsx)(l.default,{stickerPackId:e,onStickerClick:this.handleStickerDetails,onStickerEnter:this.handleStickerDetails,onClose:this._end});this.push(t)},this.handleStickerDetails=(e,t)=>{const a=(0,c.jsx)(o.default,{sticker:e,stickerPack:t,onSend:this.handleStickerSend,onBack:this._pop});this.push(a)},this.handleStickerSend=e=>{this._pop(),i.Cmd.once("ui_idle",(()=>{this.props.onSticker(e,{stickerSendOrigin:r.default.STICKER_SEND_ORIGIN_TYPE.STICKER_STORE})}))},this._pop=()=>{this.pop()},this._end=()=>{this.end(!0)},this._handleBackStickerPackDetails=()=>{this.popAndUpdate({scrollOffset:this._scrollOffset})}}componentDidMount(){const{stickerPackId:e}=this.props;e?this.handleStickerPackDetailsById(e):this.handleStickerStore()}}t.default=u},16909:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{label:t,label:a}=e,n=(0,c.default)();(0,u.useListener)(l.LabelCollection,`label_updated_${a}`,(()=>{n()}));const f=l.LabelCollection.get(t);if(!f||!f.name)return null;if("label-list"===e.theme){const a=(0,h.jsx)(d.Labels,{renderAsCircle:"label-list"===e.theme,theme:e.theme,labels:[t]}),n=(0,h.jsx)(s.EmojiText,{text:f.name,ellipsify:!0,titlify:!0});return(0,h.jsx)(i.default,{theme:(0,r.canEditLabel)()?"chat-checkbox":void 0,image:a,primary:n,secondary:o.default.t(1080,{count:parseInt(f.count||0,10),_plural:parseInt(f.count||0,10)})})}{const e=(0,d.renderLabelSvg)(f.hexColor),t=(0,h.jsx)(s.EmojiText,{text:f.name,ellipsify:!0,titlify:!0});return(0,h.jsx)(i.default,{theme:"label-selection",image:e,primary:t})}};var i=n(a(55092)),s=a(85051),r=a(78615),o=n(a(2408)),l=a(59606),d=a(84498),c=n(a(45172)),u=a(61192),h=a(85893)},99385:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{shouldScrollIntoViewAndSelect:t,selectedLabels:a,onMultiSelect:n,renderContext:f,onLabelClick:p,initialLabelState:m={}}=e,[g,v]=(0,i.useState)((()=>l.LabelCollection.toArray())),C=(0,i.useRef)(null),_=(e,t,i)=>{a&&a.setVal(e,t,i),n&&n(e.id)};return(0,u.useListener)(l.LabelCollection,"add remove",((e,a,n)=>{if(v(l.LabelCollection.toArray()),n.add&&t){const{shouldScrollIntoView:a,shouldSelect:n}=t(e.name);a&&C.current&&C.current.scrollIntoView({behavior:"smooth"}),n&&_(e,!0,!1)}})),(0,h.jsx)("div",{children:(()=>{const t=e.SelectableState||new c.default(!0);return(r.GK.supportsFeature(r.GK.F.MD_BACKEND)?[...g].sort(((e,t)=>{const a=parseInt(e.id,10),n=parseInt(t.id,10);return isNaN(a)||isNaN(n)?0:a-n})):g).reduce(((e,n,i)=>{const r=l.LabelCollection.assertGet(n.id);if(!n.name)return e;const c="label-selection"===f||(0,o.canEditLabel)()?(0,h.jsx)(s.default,{theme:f,model:r,initialSelection:m[n.id]||0,multiSelection:a,selectableState:t,onSelect:_,children:(0,h.jsx)(d.default,{label:n.id})}):(0,h.jsx)(d.default,{label:n.id,theme:f});return[...e,(0,h.jsx)("div",{ref:i===g.length-1?C:()=>{},onClick:p?p.bind(null,n.id):()=>{},children:c},`label_item_${n.id}`)]}),[])})()})};var i=a(67294),s=n(a(46806)),r=a(12950),o=a(78615),l=a(59606),d=n(a(16909)),c=n(a(23721)),u=a(61192),h=a(85893)},78418:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"LiveLocationDrawer",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(t,"ExpiredLocationDrawer",{enumerable:!0,get:function(){return s.default}});var i=n(a(32129)),s=n(a(82701))},83952:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.MerchantDetailsFormFlowLoadable=void 0;var i=n(a(48926)),s=n(a(68356)),r=n(a(55454)),o=n(a(6615)),l=n(a(33961)),d=a(85893);const c=(0,l.default)((0,i.default)((function*(){return(yield Promise.all([a.e(8295),a.e(1702),a.e(9488),a.e(275)]).then(a.bind(a,76820))).default})),"MerchantDetailsFormFlow"),u=(0,s.default)({loader:c,loading:e=>(0,d.jsx)(o.default,{error:Boolean(e.error)}),delay:r.default.LOADABLE_DELAY});t.MerchantDetailsFormFlowLoadable=u},61627:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(67294),s=a(20519),r=n(a(55454)),o=n(a(63856)),l=a(84208),d=a(47971),c=a(85893);function u({layer:e,outlineLayer:t,dimension:a,removeBackground:n,scale:u,visible:h},f){const p=(0,i.useRef)(),m=(0,i.useRef)();if((0,i.useImperativeHandle)(f,(()=>({toCanvas(){var e;const t=null===(e=m.current)||void 0===e?void 0:e.getBoundingRect(),a=p.current;if(!t||!a||t.size.isEmpty())return;const{x:n,y:i,width:o,height:l}=t;var d;null===(d=m.current)||void 0===d||d.show();const c=a.toCanvas({x:n,y:i,width:o,height:l,pixelRatio:1/u});var h;null===(h=m.current)||void 0===h||h.hide();const f=Math.max(c.width,c.height)/r.default.STICKER_DIMENSION,g=r.default.STICKER_BORDER_WIDTH*f,v=Math.max(Math.ceil(g),2),C=(0,s.addBorder)(c,v);return(0,s.trim)(C)}}))),!e||!t)return null;const g=e.frame.getCenter();return(0,c.jsxs)(d.Group,{ref:p,visible:h,children:[(0,c.jsx)(d.Group,{x:g.x,y:g.y,offsetX:e.width/2,offsetY:e.height/2,width:e.width,height:e.height,rotation:e.rotation,scaleX:e.scale,scaleY:e.scale,children:(0,c.jsx)(o.default,{layer:e})}),(0,c.jsx)(l.Outline,{ref:m,layer:t,dimension:a})]})}var h=(0,i.forwardRef)(u);t.default=h},26785:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CanvasContext=void 0;const n={transforming:!1,dragging:!1,editing:!1},i=(0,a(67294).createContext)(n);t.CanvasContext=i},1590:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.CanvasLayer=function({layer:e,scale:t,editing:a,selected:n,editable:_,hidden:x,textBackgroundShadow:S,dimension:y,selectedGroupRef:E,transformerRef:j,stageWidth:I,stageHeight:T,onSelect:b,onDoubleClick:P,onDragStart:M,onDragEnd:w,onDragMove:L,onTransformStart:k,onTransformEnd:O}){const[A,D]=(0,i.useState)(!1),R=(0,i.useContext)(s.CanvasContext);let N,F,B,U;_&&n&&!a&&(F=(0,v.jsx)(p.default,{layer:e}),U=(0,v.jsx)(f.Transformer,{ref:j,anchorStroke:"blue",anchorFill:"white",anchorSize:8,anchorCornerRadius:4,borderEnabled:!1,centeredScaling:!0,enabledAnchors:["bottom-right"],resizeEnabled:!0,rotateAnchorOffset:12,rotateEnabled:!0,rotationSnaps:C,ignoreStroke:!0,rotationSnapTolerance:10,boundBoxFunc:(a,n)=>{const i=n.width/t,s=n.height/t;return e instanceof g.TextLayer&&(i<=18||s<=18)||i<=36||s<=36?a:n}},"transformer"));_&&A&&!n&&(B=(0,v.jsx)(o.default,{layer:e}));e instanceof d.ImageLayer?N=(0,v.jsx)(l.default,{layer:e}):e instanceof r.DrawLayer?e.type===r.DrawLayerType.Paint?N=(0,v.jsx)(h.default,{layer:e}):e.type===r.DrawLayerType.Outline&&(N=(0,v.jsx)(u.Outline,{layer:e,dimension:y})):e instanceof g.TextLayer&&!a&&(N=(0,v.jsx)(m.default,{layer:e,shadow:S}));x&&(N=(0,v.jsx)(f.Rect,{width:e.width,height:e.height}));(0,i.useEffect)((()=>{a&&D(!1)}),[a,D]);const H=e.frame.getCenter();return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsxs)(f.Group,{ref:n?E:null,x:H.x,y:H.y,offsetX:e.width/2,offsetY:e.height/2,width:e.width,height:e.height,rotation:e.rotation,scaleX:e.scale,scaleY:e.scale,draggable:_,dragBoundFunc:e=>{let{x:t,y:a}=e;return t<0?t=0:t>I&&(t=I),a<0?a=0:a>T&&(a=T),{x:t,y:a}},onMouseEnter:t=>{!e.editable||R.dragging||R.transforming||(t.cancelBubble=!0,D(!0))},onMouseLeave:t=>{e.editable&&(t.cancelBubble=!0,D(!1))},onMouseDown:t=>{e.editable&&(t.cancelBubble=!0,b(e))},onDblClick:()=>P(e),onDragStart:()=>M(e),onDragEnd:t=>{const a=(0,c.getPointFromGroup)(t);w(e,a)},onDragMove:t=>L(e,t),onTransformStart:()=>k(e),onTransformEnd:t=>{if(!n)return;const a=(0,c.getRotationFromGroup)(t),i=(0,c.getScaleFromGroup)(t);O(e,a,i)},children:[N,F,B]}),U]})};var i=a(67294),s=a(26785),r=a(22443),o=n(a(68327)),l=n(a(63856)),d=a(85499),c=a(40302),u=a(84208),h=n(a(61577)),f=a(47971),p=n(a(6650)),m=n(a(10456)),g=a(4301),v=a(85893);const C=[0,45,90,135,180,225,270,315]},89067:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.EditableText=void 0;var i=n(a(81109)),s=n(a(18446)),r=a(67294),o=a(9492),l=n(a(54115)),d=n(a(96962)),c=a(91137),u=a(57528),h=n(a(2408)),f=n(a(2966)),p=a(56130),m=a(63477),g=n(a(68062)),v=n(a(51402)),C=n(a(35523)),_=n(a(82275)),x=a(85893);const S=(0,d.default)(),y=(0,r.forwardRef)((({text:e,layer:t,layerCenter:a,scale:n,onSave:d,onUnselect:p,onOutsideClick:y},I)=>{const[T,b]=(0,r.useState)(e),[P,M]=(0,r.useState)(),w=(0,r.useRef)(),L=(0,r.useCallback)((()=>{d(T.replace(/^\n+/,"").replace(/\n+$/,""))}),[d,T]);(0,r.useImperativeHandle)(I,(()=>({save:()=>{L(),p()}})),[L,p]);const k=(0,v.default)((e=>{P||!1===(null==y?void 0:y(e))||(L(),p())})),O=e=>{const t=w.current;t&&t.replaceSelection(e)},A=()=>{M(null)},[D,R]=(0,_.default)((e=>{M({menu:(0,x.jsx)(c.EmojiPanel,{onEmoji:O,onFocusNext:A,onFocusPrev:A}),anchor:e.target})}));(0,r.useEffect)((()=>{var e,t;null===(e=w.current)||void 0===e||null===(t=e.refInput)||void 0===t||t.focus()}),[]);const N=Math.max(t.scale*n,1.2),F={borderWidth:2/N,padding:t.styles.layerPadding-2,transform:`scale(${N})`},B={left:a.x*n,top:a.y*n},U={color:t.textColor.toHex(),fontFamily:(0,u.getFontStyle)(t.font).fontFamily,fontSize:t.fontSize,lineHeight:`${t.lineHeight+2*t.styles.lineVerticalPadding}px`,textAlign:E(t.alignment),paddingLeft:t.styles.lineHorizontalPadding+1,paddingRight:t.styles.lineHorizontalPadding+1,paddingTop:1,paddingBottom:1,borderWidth:0,borderRadius:6,margin:0,boxSizing:"border-box",backgroundColor:t.textBackground?t.textBackgroundColor.toHex():void 0},H=t.styles.backgroundShadow,G={boxShadow:t.textBackground?`${H.offsetX}px ${H.offsetY}px ${H.radius}px ${H.spread}px ${H.color.toRgbaString()}`:void 0},V=function(e){const t=(0,C.default)(e),a=(0,r.useRef)(0);t&&!(0,s.default)(t,e)&&(a.current+=1);return a.current}(U),W=(0,i.default)((0,i.default)({},U),{},{fontSize:15,paddingRight:8,fontFamily:void 0}),z=20-t.fontSize,K=t.styles.lineVerticalPadding-z,q=`\n    .${l.default.inputContainer} .emoji.emoji.emoji {\n      margin: ${K}px ${-z/2}px 0 ${-z/2}px;\n      transform: scale(${t.fontSize/20});\n    }\n  `;return(0,x.jsxs)("div",{className:l.default.positioner,style:B,children:[(0,x.jsxs)("div",{className:l.default.container,style:F,children:[(0,x.jsx)("style",{children:q}),(0,x.jsxs)("div",{className:l.default.resizableInput,ref:k,children:[(0,x.jsx)("div",(0,i.default)((0,i.default)({className:l.default.emojiButton},R),{},{ref:D,style:{transform:`scale(${1/N}) translateX(-${50*N}%)`,top:28*(1-1/N)/2-40},children:(0,x.jsx)("div",{className:l.default.buttonIconWrapper,children:(0,x.jsx)(f.default,{name:"smiley"})})})),(0,x.jsx)("div",{className:l.default.inputContainer,style:G,children:(0,x.jsx)(S,{style:U,ref:w,initialValue:T,onChange:e=>{let t=e;t=e.match(/\n\n$/)?t.replace(/\n\n$/,"\n"):t.replace(/\n$/,""),b(t)},onEnter:L,multiline:!0,theme:"media-editor-text-input",placeholder:h.default.t(1201)},V)}),(0,x.jsx)(j,{layer:t,text:T||h.default.t(1201),style:T?U:W})]})]}),P&&(0,x.jsx)(m.UIE,{displayName:"EmojiPicker",escapable:!0,popable:!0,requestDismiss:A,children:(0,x.jsx)(g.default,{contextMenu:(0,i.default)({dirY:o.DirY.TOP,type:"emoji_picker"},P)})})]})}));function E(e){switch(e){case u.TextAlignment.LEFT:return"left";case u.TextAlignment.CENTER:return"center";case u.TextAlignment.RIGHT:return"right"}}function j({text:e,style:t,layer:a}){return(0,x.jsx)("div",{className:l.default.hiddenText,style:t,children:(0,p.getLines)(e,a.font,a.fontSize,0).map(((e,t)=>(0,x.jsx)("div",{className:l.default.hiddenTextLine,children:0===e.words.length?" ":e.words.map(((e,t)=>e.emojiPath?(0,x.jsx)("span",{className:l.default.emojiPlaceholder},t):e.text))},t)))})}t.EditableText=y},68327:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function({layer:e}){const t=e instanceof i.ImageLayer&&(e.isSticker()||e.isBackground());return(0,r.jsx)(s.Rect,{width:e.width,height:e.height,stroke:o.toRgbaString(),strokeWidth:2,cornerRadius:t?40:5,strokeScaleEnabled:!1})};var n=a(33845),i=a(85499),s=a(47971),r=a(85893);const o=new n.Color(82,248,24,1)},63856:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{layer:t}=e;return(0,i.jsx)(n.Image,{width:t.width,height:t.height,image:t.image})};var n=a(47971),i=a(85893)},64193:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a(81109)),s=n(a(18446)),r=a(67294),o=n(a(61627)),l=a(26785),d=a(1590),c=a(33845),u=a(89067),h=a(40302),f=n(a(82763)),p=n(a(14219)),m=a(47971),g=a(4301),v=a(45139),C=n(a(59388)),_=a(85893);const x="#52F818";function S(e,t){var a;const{inPaintMode:n=!1,inOutlineMode:S=!1,paintColor:y=c.Color.White,paintThickness:E=v.THICKNESS.MEDIUM,outlineSmoothing:j=!0,canEditLayer:I=!0,canEditBackground:T=!1,outlineEnabled:b=!1,currentlyEditingTextLayer:P=null,draftTextLayer:M=null,onLayerSelect:w=(()=>{}),onLayerUnselect:L=(()=>{}),onLayerTranslate:k=(()=>{}),onLayerTransform:O=(()=>{}),onTextEditingStart:A=(()=>{}),onTextEditingEnd:D=(()=>{}),onTextInputOutsideClick:R=(()=>!0),onPaintDrawEnd:N=(()=>{}),onOutlineDrawEnd:F=(()=>{}),onOutlineDone:B=(()=>{}),scale:U,data:H}=e,G=(0,r.useRef)(null),V=(0,r.useRef)(null),W=(0,r.useRef)(null),z=(0,r.useRef)(null),K=(0,r.useRef)(null),q=(0,r.useRef)(null),Y=(0,r.useRef)(null),Q=(0,r.useRef)(null),X=(0,r.useRef)(null),Z=(0,r.useRef)({dragging:!1,transforming:!1,editing:!1}),[$,J]=(0,r.useState)({horizontal:null,vertical:null}),[ee,te]=(0,r.useState)(!1),[ae,ne]=(0,r.useState)(!1),[ie,se]=(0,r.useState)("crosshair"),re=()=>{Z.current.dragging=!0,te(!0)},oe=(e,t)=>{Z.current.dragging=!1,k(e,t),J({vertical:null,horizontal:null}),te(!1)},le=()=>{Z.current.transforming=!0,ne(!0)},de=(e,t,a)=>{Z.current.transforming=!1,O(e,t,a),ne(!1)},ce=()=>{if(!G.current)throw new Error("MediaEditorCanvas:stage is not initialized");return G.current.getStage()},ue=(e,t)=>{var a,n,i,r;const o=[{position:ce().width()/2,orientation:"v"},{position:ce().height()/2,orientation:"h"}],l=t.target,d=l.absolutePosition(),c=[{position:d.y,orientation:"h"},{position:d.x,orientation:"v"}],u=[];for(const e of c)for(const t of o){if(e.orientation!==t.orientation)continue;const a=Math.abs(t.position-e.position);a<=15&&u.push({guide:t,distance:a})}u.sort(((e,t)=>e.distance-t.distance));let h=null,f=null;for(const{guide:e}of u)"v"!==e.orientation||h?"h"!==e.orientation||f||(f=e):h=e;l.absolutePosition({x:null!==(a=null===(n=h)||void 0===n?void 0:n.position)&&void 0!==a?a:d.x,y:null!==(i=null===(r=f)||void 0===r?void 0:r.position)&&void 0!==i?i:d.y});const p={horizontal:f,vertical:h};(0,s.default)($,p)||J(p)},he=e=>{e instanceof g.TextLayer&&A(e)},fe=e=>{M&&D(M,e)},pe=e=>{w(e)},me=(e,t={})=>{const{hidden:a=!1}=t,i=H.selectedLayer===e&&P!==e,s=H.screenWidth*U,r=H.screenHeight*U,o=H.cropSize.dimension,l=e.editable&&I&&!n&&!S&&!P;return(0,_.jsx)(d.CanvasLayer,{layer:e,scale:U,textBackgroundShadow:!ee,dimension:o,editing:P===e,selected:i,editable:l,stageHeight:r,stageWidth:s,selectedGroupRef:e=>{V.current=e},transformerRef:e=>{W.current=e},onSelect:pe,onDoubleClick:he,onDragMove:ue,onDragStart:re,onDragEnd:oe,onTransformStart:le,onTransformEnd:de,hidden:a},String(e.id))};(0,r.useEffect)((()=>{var e,t,a;V.current&&(null===(e=W.current)||void 0===e||e.nodes([V.current]),null===(t=W.current)||void 0===t||null===(a=t.getLayer())||void 0===a||a.batchDraw())}));const ge=()=>{var e,t,a,n,i,s,r,o,l,d,c;null===(e=W.current)||void 0===e||e.hide(),null===(t=V.current)||void 0===t||null===(a=t.getChildren()[1])||void 0===a||a.hide(),null===(n=V.current)||void 0===n||null===(i=n.getChildren()[2])||void 0===i||i.hide(),null===(s=z.current)||void 0===s||s.hide(),null===(r=q.current)||void 0===r||r.toggleCursor(!1),null===(o=Y.current)||void 0===o||o.hide(),null===(l=W.current)||void 0===l||null===(d=l.getLayer())||void 0===d||d.batchDraw(),null===(c=K.current)||void 0===c||c.hide();const u=ce().toDataURL({mimetype:"image/png",quality:1,pixelRatio:1/U});var h,f,p,m,g,v,C,_,x,S,y;return null===(h=W.current)||void 0===h||h.show(),null===(f=V.current)||void 0===f||null===(p=f.getChildren()[1])||void 0===p||p.show(),null===(m=V.current)||void 0===m||null===(g=m.getChildren()[2])||void 0===g||g.show(),null===(v=z.current)||void 0===v||v.show(),null===(C=q.current)||void 0===C||C.toggleCursor(!0),null===(_=Y.current)||void 0===_||_.show(),null===(x=W.current)||void 0===x||null===(S=x.getLayer())||void 0===S||S.batchDraw(),null===(y=K.current)||void 0===y||y.show(),u},ve=()=>{var e;return null===(e=X.current)||void 0===e?void 0:e.toCanvas()},Ce=()=>{var e;null===(e=Q.current)||void 0===e||e.save()},_e=()=>(ee||ae)&&H.selectedLayer===H.background;(0,r.useImperativeHandle)(t,(()=>({getStage:ce,getDataUrl:ge,endTextEditing:Ce,getBackground:ve})));const xe=H.screenWidth/2,Se=H.screenHeight/2,ye=H.toScreenPoint(H.cropCenter),Ee=H.toScreenPoint(H.canvasCenter),je=xe-(ye.x-Ee.x),Ie=Se-(ye.y-Ee.y),Te=H.cropSize.dimension;return(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(m.Stage,{ref:G,width:H.screenWidth*U,height:H.screenHeight*U,onMouseDown:e=>{P||(0,h.isEventOnAnchor)(e)||L()},scaleX:U,scaleY:U,style:(0,i.default)({cursor:n?"none":S?ie:"default"},null!==(a=e.style)&&void 0!==a?a:{}),children:(0,_.jsxs)(l.CanvasContext.Provider,{value:Z.current,children:[b&&(0,_.jsx)(m.Layer,{x:je,y:Ie,offsetX:H.width/2,offsetY:H.height/2,rotation:H.rotation,children:(0,_.jsx)(C.default,{ref:K,width:H.width,height:H.height})},"transparent"),(0,_.jsx)(m.Layer,{x:je,y:Ie,offsetX:H.width/2,offsetY:H.height/2,rotation:H.rotation,children:(0,_.jsx)(o.default,{ref:X,layer:H.background,outlineLayer:H.outlineLayer,dimension:Te,removeBackground:b&&!S,scale:U,visible:!_e()})},"background"),(0,_.jsx)(m.Layer,{x:je,y:Ie,offsetX:H.width/2,offsetY:H.height/2,rotation:H.rotation,children:(()=>{const e=[];if(H.paintLayer&&!Z.current.dragging){const t=me(H.paintLayer);e.push(t)}if(T&&H.background){const t=me(H.background,{hidden:!_e()});e.push(t)}if(H.paintLayer&&Z.current.dragging){const t=me(H.paintLayer);e.push(t)}return e.push(...H.layers.map((e=>me(e)))),e})()},"edits"),(()=>{const{vertical:e,horizontal:t}=$;if(!e&&!t)return null;const a=ce();return(0,_.jsxs)(m.Layer,{ref:z,children:[e&&(0,_.jsx)(m.Line,{x:e.position/U,y:0,points:[0,0,0,a.height()/U],stroke:x,strokeWidth:1,strokeScaleEnabled:!1},"vertical"),t&&(0,_.jsx)(m.Line,{x:0,y:t.position/U,points:[0,0,a.width()/U,0],stroke:x,strokeWidth:1,strokeScaleEnabled:!1},"horizontal")]},"guides")})(),n&&(0,_.jsx)(p.default,{ref:q,width:H.screenWidth,height:H.screenHeight,scale:U,pathStyle:{color:y,thickness:(0,v.getThicknessValue)(E),smoothing:!1},data:H,onDrawEnd:N}),S&&(0,_.jsx)(f.default,{ref:Y,width:H.screenWidth,height:H.screenHeight,scale:U,data:H,smoothing:j,onDrawEnd:F,onDone:B,onCursorChange:e=>{se(e)}})]})}),(()=>{if(!M)return null;const e=H.toScreenPoint(M.frame.getCenter());return(0,_.jsx)(u.EditableText,{ref:Q,layer:M,layerCenter:e,text:M.text,scale:U,onSave:fe,onUnselect:L,onOutsideClick:R})})()]})}var y=(0,r.forwardRef)(S);t.default=y},84208:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.Outline=void 0;var i=n(a(94654)),s=a(67294),r=n(a(55454)),o=a(47971),l=n(a(8873)),d=a(85893);function c({layer:e,dimension:t},a){const n=(0,s.useRef)(),c=(0,s.useRef)();(0,s.useImperativeHandle)(a,(()=>({show(){var e;null===(e=n.current)||void 0===e||e.show()},hide(){var e;null===(e=n.current)||void 0===e||e.hide()},getBoundingRect(){const t=c.current;if(!t)return;const{x:a,y:n,width:i,height:s}=t.getClientRect();return l.default.create({x:a,y:n,width:i,height:s,rotation:e.rotation,scale:e.scale})}})));const u=(0,i.default)(e.getAllPoints(),(e=>[e.x,e.y]));return(0,d.jsx)(o.Group,{ref:n,width:e.width,height:e.height,visible:!1,children:(0,d.jsx)(o.Line,{ref:c,points:u,closed:!0,fill:"white",lineCap:"round",lineJoin:"round",tension:r.default.MEDIA_EDITOR_OUTLINE_TENSION,globalCompositeOperation:"destination-in"})})}const u=(0,s.forwardRef)(c);t.Outline=u},82763:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a(81109)),s=n(a(94654)),r=a(67294),o=a(33845),l=n(a(55454)),d=(a(12950),a(47971)),c=n(a(55301)),u=a(85893);const h="dot-first",f="dot-last";function p({width:e,height:t,scale:a,data:n,smoothing:p,onDrawEnd:m,onDone:v,onCursorChange:C},_){var x;const S=(0,r.useRef)(),y=(0,r.useRef)(!1),E=(0,r.useRef)("crosshair");(0,r.useEffect)((()=>{C("crosshair")}),[]),(0,r.useImperativeHandle)(_,(()=>({show(){var e;null===(e=S.current)||void 0===e||e.show()},hide(){var e;null===(e=S.current)||void 0===e||e.hide()}})));const{cursorPosition:j,points:I,handlers:T}=(0,c.default)({onDrawStart:()=>{y.current=!0},onDrawEnd:e=>{y.current=!1,m(e)},onDone:v,onMouseMove:e=>{const t=e.target.name()===h,a=y.current,n=t&&!a?"pointer":"crosshair";n!==E.current&&(E.current=n,C(n))},data:n,stage:null===(x=S.current)||void 0===x?void 0:x.getStage(),minPointDistance:12/a,clickThreshold:200,boundToStage:!0,doneTargets:{mousedown:[h,f],mouseup:[h]},pathStyle:{color:o.Color.White,thickness:0,smoothing:p}}),b=n.outlineLayer.getAllPoints().map((e=>n.toScreenPoint(e)));!p&&b.length&&b.push(b[b.length-1]);Boolean(I.length)&&b.push(I[0]),b.push(...I);const P=[...b];!p&&P.length&&P.push(P[P.length-1]),j&&P.push(j);const M=(0,s.default)(P,(e=>[e.x,e.y]));return(0,u.jsxs)(d.Layer,(0,i.default)((0,i.default)({ref:S},T),{},{width:e,height:t,children:[(0,u.jsx)(d.Rect,{x:0,y:0,width:e,height:t,fill:"rgba(0,0,0,0)"}),(0,u.jsx)(d.Line,{points:M,lineCap:"round",lineJoin:"round",stroke:"#FA6533",strokeWidth:3/a,dash:[12/a,6/a],tension:l.default.MEDIA_EDITOR_OUTLINE_TENSION}),(0,u.jsx)(g,{points:b,scale:a})]}),"paintCursor")}var m=(0,r.forwardRef)(p);function g({points:e,scale:t}){if(!e.length)return null;const a=e[0],n=e[e.length-1],i=3/t;return(0,u.jsxs)(u.Fragment,{children:[undefined,(0,u.jsx)(d.Circle,{name:f,x:n.x,y:n.y,radius:i}),(0,u.jsx)(d.Circle,{x:a.x,y:a.y,radius:i,stroke:"white"}),(0,u.jsx)(d.Circle,{name:h,x:a.x,y:a.y,radius:4*i})]})}t.default=m},61577:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function({layer:e}){const t=(0,n.useMemo)((()=>{const t=document.createElement("canvas");return t.width=Math.max(e.width,1),t.height=Math.max(e.height,1),t}),[e.width,e.height]),a=(0,n.useRef)();return(0,n.useEffect)((()=>{var n,i;t.getContext("2d").clearRect(0,0,t.width,t.height),e.paths.forEach((e=>function(e,t){const{points:a}=t;if(!a.length)return;const n=e.getContext("2d"),i={color:t.color,thickness:t.thickness,smoothing:!1};(function(e,t){e.lineCap="round",e.lineJoin="round",e.lineWidth=t.thickness,e.strokeStyle=t.color.toHex()})(n,i),n.beginPath(),n.moveTo(a[0].x,a[0].y),a.forEach((e=>n.lineTo(e.x,e.y))),n.stroke()}(t,e))),null===(n=a.current)||void 0===n||null===(i=n.getLayer())||void 0===i||i.batchDraw()}),[e.paths,t]),(0,s.jsx)(i.Image,{ref:a,width:e.width,height:e.height,image:t})};var n=a(67294),i=a(47971),s=a(85893)},14219:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a(81109)),s=n(a(94654)),r=a(67294),o=a(47971),l=n(a(55301)),d=a(85893);const c=({width:e,height:t,scale:a,pathStyle:n,data:c,onDrawEnd:u},h)=>{var f;const p=(0,r.useRef)(),m=(0,r.useRef)();(0,r.useImperativeHandle)(h,(()=>({toggleCursor(e){const t=m.current;t&&(e?t.show():t.hide())}})));const{cursorPosition:g,points:v,handlers:C}=(0,l.default)({onDrawEnd:u,data:c,pathStyle:n,stage:null===(f=p.current)||void 0===f?void 0:f.getStage()}),_=(0,s.default)(v,(e=>[e.x,e.y]));return(0,d.jsxs)(o.Layer,(0,i.default)((0,i.default)({ref:p},C),{},{width:e,height:t,children:[(0,d.jsx)(o.Rect,{width:e,height:t,fill:"rgba(0, 0, 0, 0)"}),g&&(0,d.jsx)(o.Circle,{ref:m,x:g.x,y:g.y,radius:n.thickness/2,fill:n.color.toRgbaString()}),(0,d.jsx)(o.Line,{points:_,lineCap:"round",lineJoin:"round",stroke:n.color.toRgbaString(),strokeWidth:n.thickness})]}),"paintCursor")};var u=(0,r.forwardRef)(c);t.default=u},6650:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function({layer:e}){const t=e instanceof i.ImageLayer&&(e.isSticker()||e.isBackground());return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(s.Rect,{width:e.width,height:e.height,fill:l.toRgbaString(),stroke:o.toRgbaString(),strokeWidth:2,cornerRadius:t?40:5,strokeScaleEnabled:!1})})};var n=a(33845),i=a(85499),s=a(47971),r=a(85893);const o=new n.Color(82,248,24,1),l=new n.Color(82,248,24,.1)},10456:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function({layer:e,shadow:t}){const a=function(e){const t=[];for(const a of e)for(const{emojiPath:e}of a.words)e&&t.push(e);return function(e){const t=[...new Set(e)],a=t.join(""),i=(0,n.useRef)({}),[,s]=(0,n.useState)(0);return(0,n.useEffect)((()=>{i.current={},s(0),t.forEach((e=>{const t=new Image;t.onload=()=>{i.current[e]=t,s(Object.keys(i.current).length)},t.src=e}))}),[s,a]),i.current}(t)}(e.lines),l=t=>{const n=Math.max(...e.lineWidths);let l=0;switch(e.alignment){case i.TextAlignment.LEFT:l=0;break;case i.TextAlignment.CENTER:l=(n-t.width)/2;break;case i.TextAlignment.RIGHT:l=n-t.width}let d=0;return t.words.map((({text:t,emojiPath:n,width:c},u)=>{const h=l+e.styles.lineHorizontalPadding+d,f=e.styles.lineVerticalPadding;let p;if(n){const t=a[n];p=t?(0,o.jsx)(s.Image,{x:h,y:f,width:e.lineHeight,height:e.lineHeight,image:t},u):(0,o.jsx)(s.Rect,{x:h,y:f,width:e.lineHeight,height:e.lineHeight,fill:"rgba(0,0,0,0)"},u)}else{const a=(0,r.getTextBounds)(e.font,e.fontSize);p=(0,o.jsx)(o.Fragment,{children:(0,o.jsx)(s.Text,{x:h,y:f-a.top+(a.top+a.bottom)/2,width:c,height:e.lineHeight,text:t,fill:e.textColor.toHex(),fontFamily:(0,i.getFontStyle)(e.font).fontFamily,fontSize:e.fontSize},u)})}return d+=c,p}))},d=e.lines.map(((t,a)=>{const n=t.width+2*e.styles.lineHorizontalPadding,i=e.lineHeight+2*e.styles.lineVerticalPadding;return(0,o.jsx)(s.Group,{width:n,height:i,y:a*i,children:l(t)},a)})),{backgroundShadow:c}=e.styles;return(0,o.jsx)(s.Group,{visible:0!==e.width,width:e.width,height:e.height,children:(0,o.jsxs)(s.Group,{x:e.styles.layerPadding,y:e.styles.layerPadding,children:[e.textBackground&&(t?(0,o.jsx)(s.Path,{data:e.backgroundPath,stroke:e.textBackgroundColor.toHex(),fill:e.textBackgroundColor.toHex(),shadowColor:c.color.toHex(),shadowBlur:c.radius,shadowOffset:{x:c.offsetX,y:c.offsetY},shadowOpacity:c.color.alpha},"1"):(0,o.jsx)(s.Path,{data:e.backgroundPath,stroke:e.textBackgroundColor.toHex(),fill:e.textBackgroundColor.toHex()},"2")),d]})})};var n=a(67294),i=a(57528),s=a(47971),r=a(56130),o=a(85893)},59388:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(67294),i=a(33845),s=a(47971),r=a(85893);const o=new i.Color(230,230,230).toRgbString(),l=new i.Color(255,255,255).toRgbString();function d({width:e,height:t},a){const i=(0,n.useRef)();(0,n.useImperativeHandle)(a,(()=>({hide(){var e;null===(e=i.current)||void 0===e||e.hide()},show(){var e;null===(e=i.current)||void 0===e||e.show()}})));const d=(0,n.useMemo)((()=>{const a=document.createElement("canvas");return a.width=Math.max(e,1),a.height=Math.max(t,1),a}),[e,t]);return(0,n.useEffect)((()=>{var a,n;const s=d.getContext("2d");s.clearRect(0,0,d.width,d.height);const r=20,c=Math.ceil(e/r),u=Math.ceil(t/r);for(let e=0;e<u;e++)for(let t=0;t<c;t++){const a=(e+t)%2==0?l:o;s.beginPath(),s.rect(t*r,e*r,r,r),s.fillStyle=a,s.fill()}null===(a=i.current)||void 0===a||null===(n=a.getLayer())||void 0===n||n.batchDraw()}),[d,e,t]),(0,r.jsx)(s.Image,{ref:i,width:e,height:t,image:d})}var c=(0,n.forwardRef)(d);t.default=c},55301:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function({onDrawStart:e,onDrawEnd:t,onDone:a,onMouseMove:n,data:c,endOnMouseLeave:u=!0,minPointDistance:h=0,clickThreshold:f=0,boundToStage:p=!1,pathStyle:m={},stage:g,doneTargets:v={}}){const[C,_]=(0,s.useState)(),x=(0,s.useRef)([]),S=(0,s.useRef)(!1),y=(0,o.default)(),E=(0,l.default)(f),j=(0,s.useRef)(!1);return(0,d.useListener)(window,"mouseup",(()=>{if(S.current=!1,0!==x.current.length){const e=x.current.map((e=>c.toCanvasPoint(e)));t((0,i.default)({points:e},m)),x.current=[],y()}})),(0,d.useListener)(window,"mousemove",(e=>{const t=(0,r.getPointFromStage)(e,g,p),a=p&&S.current;if(_(a?(0,r.getPointFromStage)(e,g,!0):t),S.current){const e=x.current,a=e[e.length-1];(!a||a.distance(t)>=h&&E()||(0,r.isStageCorner)(t,g))&&e.push(t)}})),(0,s.useEffect)((()=>{j.current&&(null==a||a(),j.current=!1)})),{cursorPosition:C,points:x.current,handlers:{onMouseDown:t=>{var n;if(null==e||e(),null===(n=v.mousedown)||void 0===n?void 0:n.includes(t.target.name()))return void(null==a||a());const i=(0,r.getPointFromStage)(t.evt,g,p);x.current.push(i),S.current=!0,y()},onMouseUp:e=>{var t;const a=null===(t=v.mouseup)||void 0===t?void 0:t.includes(e.target.name()),n=1===x.current.length;a&&!n&&(j.current=!0)},onMouseMove:e=>{null==n||n(e)}}}};var i=n(a(81109)),s=a(67294),r=a(40302),o=n(a(45172)),l=n(a(58151)),d=a(61192)},8731:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{caption:t,setCaptionInputRef:a,onEnter:n}=e,y=(0,s.useRef)(null),E=(0,s.useRef)(null),[j,I]=(0,s.useState)(null),{refreshedAppUI:T}=(0,s.useContext)(v.ThemeContext),b=()=>{var e;null===(e=y.current)||void 0===e||e.focus()};(0,s.useEffect)((()=>{b()}),[]);const P=()=>{I(null)},M=e=>{const t=y.current;t&&(t.focus(!1),t.replaceSelection(e))},w=(0,x.numCodepoints)(e.caption||""),L=o.default.MAX_CAPTION_LENGTH-w<50,k=(0,S.jsx)("div",{role:"button",className:u.default.inputEmoji,onClick:e=>{e.preventDefault(),e.stopPropagation();const t=(0,S.jsx)(d.EmojiPanel,{onEmoji:M,onFocusNext:b,onFocusPrev:b});I({menu:t,dirY:l.DirY.TOP,type:"emoji_picker",anchor:e.target}),b()},children:(0,S.jsx)(g.default,{name:"emoji-input"})}),O=t&&""!==t?(0,S.jsx)("div",{role:"button",className:u.default.clearBtn,onClick:()=>{var e;null===(e=y.current)||void 0===e||e.reset(),b()},children:(0,S.jsx)(g.default,{name:"x-alt"})}):null,A=L&&(0,S.jsx)("div",{className:u.default.charCounter,children:h.default.n(o.default.MAX_CAPTION_LENGTH-w)});let D,R=null;j&&(R=(0,S.jsx)(C.UIE,{displayName:"EmojiPicker",escapable:!0,popable:!0,ref:E,requestDismiss:P,children:(0,S.jsx)(_.default,{contextMenu:j})}));p.ServerProps.viewOnceWrite&&(D=(0,S.jsx)("div",{className:u.default.secondaryButtonContainer,children:(0,S.jsx)(r.default,{disabled:e.viewOnceDisabled,isOn:Boolean(e.viewOnce),mediaType:e.msgType,onChange:e.onToggleViewOnce,noMargin:!0})}));return(0,S.jsxs)(c.FlexRow,{className:(0,i.default)(u.default.container,{[u.default.videoCaption]:"video"===e.theme,[u.default.refreshedAppUI]:T}),align:"center",justify:"center",children:[(0,S.jsx)("div",{className:u.default.suggestionsPositioner,children:(0,S.jsxs)("div",{className:u.default.suggestionsContainer,children:[(0,S.jsx)(f.default.MentionSuggestions,{chat:e.chat,theme:m.ThemeOptions.MEDIA_CAPTION}),(0,S.jsx)(f.default.EmojiSuggestions,{chat:e.chat,theme:m.ThemeOptions.MEDIA_CAPTION})]})}),(0,S.jsxs)(c.FlexRow,{align:"start",className:u.default.inputContainer,children:[(0,S.jsx)(f.default,{ref:e=>{y.current=e,a(e)},initialValue:t,placeholder:h.default.t(1786),onChange:e.onChange,onEnter:e=>{var t;(null===(t=y.current)||void 0===t?void 0:t.isFocused())&&n(e)},onFiles:e.onFiles,theme:"media-caption",maxLength:o.default.MAX_CAPTION_LENGTH,multiline:!0,spellCheck:!0}),(0,S.jsxs)(c.FlexRow,{className:u.default.buttonContainer,align:"center",children:[A,O,k]})]}),D,R]})};var i=n(a(94184)),s=a(67294),r=n(a(73895)),o=n(a(55454)),l=a(9492),d=a(91137),c=a(63290),u=n(a(71488)),h=n(a(2408)),f=n(a(45689)),p=a(65565),m=a(2904),g=n(a(2966)),v=a(13038),C=a(63477),_=n(a(68062)),x=a(49002),S=a(85893)},45139:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getAllThicknesses=function(){return Object.keys(a)},t.getThicknessValue=function(e){return n[e]},t.THICKNESS=void 0;const a=Object.freeze({SMALL:"SMALL",MEDIUM:"MEDIUM",LARGE:"LARGE",XLARGE:"XLARGE"});t.THICKNESS=a;const n={[a.SMALL]:8,[a.MEDIUM]:12,[a.LARGE]:18,[a.XLARGE]:24}},37620:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{onClick:t,onClose:a,forwardRef:n,id:i}=e,o=(0,h.useModelValues)(e.attachMedia,["mimetype","preview","type","fullPreview","fullPreviewSize","documentPageCount"]);return(0,f.jsxs)("div",{className:(0,s.default)(r.default.thumb,{[r.default.active]:e.active}),onClick:e=>{t((0,c.unproxy)(o),e)},tabIndex:"-1",ref:e=>{n(i,e)},children:[(0,f.jsx)("div",{className:r.default.btnDelete,onClick:e=>{a((0,c.unproxy)(o),e)},role:"button",children:(0,f.jsx)(u.default,{name:"x-alt"})}),(0,f.jsx)("div",{className:r.default.bodyWrapper,children:(()=>{let e;if(o.type===p)e=o.preview;else if(o.type===m)e=`data:image/jpeg;base64,${o.preview}`;else if("pdf"===(0,d.previewType)(o.mimetype)){o.fullPreview&&o.fullPreviewSize&&null!=o.documentPageCount&&o.documentPageCount>0&&(e=o.fullPreview)}if(e)return(0,f.jsx)("div",{className:r.default.body,children:(0,f.jsx)("img",{src:e,alt:l.default.t(2246)})});const t=(0,s.default)(r.default.body,r.default.bodyIcon,g[o.mimetype]?g[o.mimetype].icon:"icon-doc-generic");return(0,f.jsx)("div",{className:t})})()})]})};var i=n(a(35937)),s=n(a(94184)),r=n(a(99062)),o=n(a(55454)),l=n(a(2408)),d=a(38961),c=a(15298),u=n(a(2966)),h=a(76006),f=a(85893);const{IMAGE:p,VIDEO:m}=o.default.MSG_TYPE,g=(0,i.default)(d.MIMETYPES,(e=>"document"===(null==e?void 0:e.msgType)))},17893:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(67294),s=a(99420),r=n(a(37620)),o=n(a(55454)),l=a(85893);const d=(0,s.SortableElement)((({children:e})=>e)),c=(0,s.SortableContainer)((({children:e})=>e));class u extends i.Component{constructor(e){super(e),this._handleSortEnd=({oldIndex:e,newIndex:t})=>{const{mediaCollection:a}=this.props,n=a.reorder(e,t);this.setState({medias:n})},this.state={medias:this.props.mediaCollection.getPreviewableMedias()}}static getDerivedStateFromProps(e){return{medias:e.mediaCollection.getPreviewableMedias()}}render(){const{mediaCollection:e,className:t,forwardRef:a}=this.props,n=this.state.medias;return(0,l.jsx)(c,{onSortEnd:this._handleSortEnd,axis:"x",helperClass:"SortableHelper",distance:10,children:(0,l.jsx)("div",{className:t,children:n.map(((t,n)=>{var i;return(0,l.jsx)(d,{index:n,children:(0,l.jsx)(r.default,{id:t.id,attachMedia:t,active:t===e.getActive(),previewMode:(null===(i=e.getActive())||void 0===i?void 0:i.type)!==o.default.MSG_TYPE.IMAGE,onClick:this.props.onClick,onClose:this.props.onClose,forwardRef:a})},t.id)}))})})}}t.default=u,u.displayName="DragAndDrop"},66737:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a(23279)),s=n(a(94184)),r=a(67294),o=a(73754),l=n(a(91420)),d=n(a(64193)),c=n(a(8731)),u=n(a(40156)),h=a(91940),f=a(96532),p=n(a(23742)),m=a(63290),g=a(64603),v=a(57528),C=a(33237),_=n(a(4104)),x=a(85499),S=n(a(2408)),y=a(71681),E=n(a(35087)),j=a(92954),I=a(62866),T=n(a(7668)),b=n(a(60738)),P=a(50240),M=n(a(79485)),w=n(a(2966)),L=a(4301),k=n(a(55154)),O=n(a(98417)),A=a(45139),D=a(1458),R=a(85893);const N=new b.default({width:200,height:200});class F extends r.PureComponent{constructor(e){super(e),this._setRefCanvasContainer=e=>this._refCanvasContainer=e,this._setRefHeaderContainer=e=>this._refHeaderContainer=e,this._setRefFooterContainer=e=>this._refFooterContainer=e,this._setRefCanvas=e=>this._refCanvas=e,this._refTextColorToolbar=(0,r.createRef)(),this._refFontToolbar=(0,r.createRef)(),this._handleGlobalMouseDown=e=>{this._outsideClickTarget=e.target},this._handleResize=()=>{if(!this._refCanvasContainer)return;const e=this._refCanvasContainer.getBoundingClientRect(),t=new b.default({width:e.width-40,height:e.height-40});this.setState({containerSize:t})},this._handleGlobalClick=()=>{this._outsideClickTarget!==this._refCanvasContainer&&this._outsideClickTarget!==this._refFooterContainer&&this._outsideClickTarget!==this._refHeaderContainer||this.resetUIState()},this._handleLayerDelete=()=>{const{selectedLayer:e}=this.props.attachMedia.mediaEditorData;e&&this.props.onLayerDelete(e)},this._handleGlobalKeydown=e=>{"Backspace"!==e.code||e.target instanceof HTMLInputElement||e.target instanceof HTMLDivElement&&"true"===e.target.contentEditable||this.state.inCropRotateMode||this._handleLayerDelete()},this._updatePreviewDebounced=(0,i.default)((()=>{this._ricId&&((0,C.cancelIdleCallback)(this._ricId),this._ricId=null),this._ricId=(0,C.requestIdleCallback)(this._updatePreview)}),1e3),this._updatePreview=()=>{if(null!=this._refCanvas){const{width:e,height:t}=this._refCanvas.getStage().attrs;if(0!==e&&0!==t){const e=this._getFile(),t=window.URL.createObjectURL(e);this.props.attachMedia.updateEditedFile(e),this.props.attachMedia.updatePreview(t),this.props.attachMedia.updateFullPreview(t)}}},this._handleTextEditingStart=e=>{this.setState({isEditing:!0}),this.props.onTextEditingStart(e)},this._handleTextEditingEnd=(e,t)=>{this.setState({isEditing:!1}),this.props.onTextEditingEnd(e,t)},this._handleClickDone=()=>{if(this.state.inCropRotateMode)this._toggleCropRotateMode();else if(this.state.inPaintMode)this._togglePaintMode();else if(this.state.inOutlineMode)this.props.onOutlineDone(),this._toggleOutlineMode();else if(this.props.draftTextLayer){var e;null===(e=this._refCanvas)||void 0===e||e.endTextEditing()}else this._getData().selectedLayer&&this.props.onLayerUnselect()},this._handlePaintSelect=()=>{this._togglePaintMode(),this.props.onPaintSelect()},this._handleCropRotateSelect=()=>{this._toggleCropRotateMode()},this._handleRotateCanvas=e=>{this.props.onCropRotateCanvas(this._getData().rotation+e,this._getData().cropOrigin,this._getData().cropSize)},this._handleResetCropRotate=()=>{this.props.onCropRotateCanvas(0,new T.default({x:0,y:0}),this._getData().size)},this._handleCropChange=(e,t)=>{this.props.onCropRotateCanvas(this._getData().rotation,e,t)},this._handleOutlineSelect=()=>{this._toggleOutlineMode(),this.props.onOutlineSelect()},this._handleToggleEmojiPanel=e=>{this.setState({isEmojiPanelVisible:e})},this._handleToggleStickerPanel=e=>{this.setState({isStickerPanelVisible:e})},this._handleTextInputOutsideClick=e=>{var t,a;const n=e.target;return!(n instanceof HTMLElement&&n.closest(`.${_.default.footer}`)&&n!==this._refFooterContainer||(null===(t=this._refTextColorToolbar.current)||void 0===t?void 0:t.isPanelVisible())||(null===(a=this._refFontToolbar.current)||void 0===a?void 0:a.isMenuVisible()))},this.state={containerSize:b.default.empty(),isEditing:!1,inPaintMode:!1,inCropRotateMode:!1,inOutlineMode:!1,isEmojiPanelVisible:!1,isStickerPanelVisible:!1}}_togglePaintMode(){this.setState((({inPaintMode:e})=>({inPaintMode:!e})))}_getData(){return this.props.attachMedia.mediaEditorData}_toggleCropRotateMode(){!this.state.inCropRotateMode&&this._getData().selectedLayer&&this.props.onLayerUnselect(),this.setState((({inCropRotateMode:e})=>({inCropRotateMode:!e})),this._handleResize)}_inPaintMode(){return this.state.inPaintMode}_inCropRotateMode(){return this.state.inCropRotateMode}_inOutlineMode(){return this.state.inOutlineMode}_toggleOutlineMode(){this.setState((({inOutlineMode:e})=>({inOutlineMode:!e})))}resetUIState(){if(this._inPaintMode())this._togglePaintMode();else if(this._inCropRotateMode())this._toggleCropRotateMode();else if(this._inOutlineMode())this.props.onOutlineDone(),this._toggleOutlineMode();else{if(!this.props.attachMedia.mediaEditorData.selectedLayer||this.props.draftTextLayer)return!1;this.props.onLayerUnselect()}return!0}_getDataUrl(){if(!this._refCanvas)throw new Error("MediaEditor:canvas is not initialized");return this._refCanvas.getDataUrl()}_getFile(){const e=this._getDataUrl();return D.URL.dataURLtoFile(e)}updatePreview(e){(null==e?void 0:e.immediately)?this._updatePreview():this._updatePreviewDebounced()}componentDidMount(){window.addEventListener("resize",this._handleResize),window.addEventListener("keydown",this._handleGlobalKeydown),this._handleResize(),this.props.listeners.add(window,"mousedown",this._handleGlobalMouseDown),this.props.listeners.add(window,"click",this._handleGlobalClick)}componentWillUnmount(){window.removeEventListener("resize",this._handleResize),window.removeEventListener("keydown",this._handleGlobalKeydown),this.updatePreview({immediately:!0})}undoAction(e,t){e===o.MediaEditorAction.OutlineDone?(this.resetUIState(),this._toggleOutlineMode()):e===o.MediaEditorAction.Outline?(this._inOutlineMode()&&this._toggleOutlineMode(),t===o.MediaEditorAction.Outline&&this._toggleOutlineMode()):e===o.MediaEditorAction.CropRotateCanvas&&(this.resetUIState(),t===o.MediaEditorAction.CropRotateCanvas&&this._toggleCropRotateMode())}redoAction(e,t){e===o.MediaEditorAction.OutlineDone?this.resetUIState():e===o.MediaEditorAction.Outline?this._inOutlineMode()||this._toggleOutlineMode():e===o.MediaEditorAction.CropRotateCanvas?(this.resetUIState(),this._toggleCropRotateMode()):t===o.MediaEditorAction.CropRotateCanvas&&e!==o.MediaEditorAction.CropRotateCanvas&&this.resetUIState()}getCanvasScale(){const e=this.props.attachMedia.mediaEditorData;return(0,P.calculateContainScale)(e.screenWidth,e.screenHeight,this.state.containerSize,N)}getBackground(){var e;return null===(e=this._refCanvas)||void 0===e?void 0:e.getBackground()}render(){const{attachMedia:e,paintColor:t,paintThickness:a,outlineSmoothing:n}=this.props,{inPaintMode:i,inCropRotateMode:r,inOutlineMode:o}=this.state,C=e.mediaEditorData,y=this.props.draftTextLayer||C.selectedLayer;let T;if(r)T=(0,R.jsx)(f.CropRotateToolbar,{canReset:C.isRotated()||C.isCropped(),onRotateCanvas:this._handleRotateCanvas,onReset:this._handleResetCropRotate});else if(o)T=(0,R.jsx)(I.OutlineToolbar,{smoothing:this.props.outlineSmoothing,onSmoothingToggle:this.props.onOutlineSmoothingToggle,canReset:C.isOutlined(),onReset:this.props.onOutlineReset});else if(y){const e=y instanceof x.ImageLayer&&y.isBackground();if(y instanceof L.TextLayer){const e=(0,h.getAllColors)().map((e=>{const t=(0,h.getColorValue)(e),a=(0,h.getColorValue)(t.isLight()?h.COLORS.BLACK:h.COLORS.WHITE);return{primaryColor:t,secondaryColor:a}}));T=(0,R.jsxs)(R.Fragment,{children:[(0,R.jsx)(u.default,{ref:this._refTextColorToolbar,colors:e,onColorSelect:this.props.onTextColorSelect,selectedColor:y.textColor}),(0,R.jsx)(g.Font,{ref:this._refFontToolbar,fonts:(0,v.getAllFonts)(),selectedFont:y.font,selectedAlignment:y.alignment,onFontSelect:this.props.onFontSelect,onAlignmentSelect:this.props.onAlignmentSelect}),(0,R.jsx)(k.default,{checked:y.textBackground,onBackgroundToggle:this.props.onTextBackgroundToggle}),(0,R.jsx)(l.default,{icon:"delete",title:S.default.t(1189),onClick:this._handleLayerDelete})]})}else e||(T=(0,R.jsx)(R.Fragment,{children:(0,R.jsx)(l.default,{icon:"delete",title:S.default.t(1189),onClick:this._handleLayerDelete})}))}else i&&(T=(0,R.jsxs)(R.Fragment,{children:[(0,R.jsx)(u.default,{colors:(0,h.getAllColors)().map((e=>({primaryColor:(0,h.getColorValue)(e)}))),onColorSelect:this.props.onPaintColorSelect,selectedColor:t}),(0,R.jsx)(O.default,{thicknesses:(0,A.getAllThicknesses)(),onThicknessSelect:this.props.onPaintThicknessSelect,selectedThickness:a})]}));const b=!T&&!this.props.draftTextLayer&&!this.props.sendAsSticker,P=(0,R.jsx)(m.FlexRow,{className:(0,s.default)(_.default.captionInputContainer,{[_.default.captionInputHidden]:!b}),justify:"center",children:(0,R.jsx)(c.default,{chat:this.props.chat,caption:e.caption,viewOnce:this.props.viewOnce,viewOnceDisabled:this.props.viewOnceDisabled,msgType:j.TYPE.IMAGE,theme:"image",onToggleViewOnce:this.props.onToggleViewOnce,onChange:this.props.onCaptionChange,onEnter:this.props.onEnter,onFiles:this.props.onFiles,setCaptionInputRef:t=>{this.props.setCaptionInputRef(e.id,t)}},e.id)}),M=(0,R.jsxs)(m.FlexRow,{justify:"center",align:"center",className:_.default.footer,ref:this._setRefFooterContainer,children:[T&&(0,R.jsx)(m.FlexRow,{justify:"center",align:"center",className:_.default.bottomToolbar,children:T}),P]});let D=null;r&&(D=(0,R.jsx)(p.default,{data:C,rotation:this._getData().rotation,cropOrigin:this._getData().cropOrigin,cropSize:this._getData().cropSize,onCropChange:this._handleCropChange,containerSize:this.state.containerSize,keepRatio:this.props.sendAsSticker,sendAsSticker:this.props.sendAsSticker}));const N=r||i||o||this.state.isEmojiPanelVisible||this.state.isStickerPanelVisible||Boolean(this.props.draftTextLayer)||Boolean(this._getData().selectedLayer);return(0,R.jsxs)("div",{className:_.default.container,children:[(0,R.jsxs)(m.FlexRow,{className:_.default.header,ref:this._setRefHeaderContainer,children:[this.props.onClose?(0,R.jsx)("div",{onClick:this.props.onClose,className:_.default.closeButton,children:(0,R.jsx)(w.default,{name:"x"})}):(0,R.jsx)("div",{className:_.default.closeButtonPlaceholder}),(0,R.jsx)(E.default,{selectedLayer:y,inPaintMode:i,inCropRotateMode:r,inTextEditingMode:Boolean(this.props.draftTextLayer),inOutlineMode:o,canUndo:this.props.canUndo,canRedo:this.props.canRedo,onPaintSelect:this._handlePaintSelect,onCropRotateSelect:this._handleCropRotateSelect,onOutlineSelect:this._handleOutlineSelect,onTextSelect:this.props.onTextSelect,onEmojiSelect:this.props.onEmojiSelect,onStickerSelect:this.props.onStickerSelect,onToggleEmojiPanel:this._handleToggleEmojiPanel,onToggleStickerPanel:this._handleToggleStickerPanel,onUndo:this.props.onUndo,onRedo:this.props.onRedo,showOutline:this.props.sendAsSticker}),(0,R.jsx)(m.FlexRow,{className:_.default.headerRight,justify:"end",children:N&&(0,R.jsx)(l.default,{onClick:this._handleClickDone,children:S.default.t(1179)})})]}),(0,R.jsxs)("div",{ref:this._setRefCanvasContainer,className:(0,s.default)(_.default.canvasContainer,{[_.default.cropRotateContainer]:r}),children:[(0,R.jsx)("div",{className:_.default.canvas,style:{display:r?"none":"unset"},children:(0,R.jsx)(d.default,{ref:this._setRefCanvas,data:C,inPaintMode:i,inOutlineMode:o,paintColor:t,paintThickness:a,outlineSmoothing:n,currentlyEditingTextLayer:this.props.currentlyEditingTextLayer,draftTextLayer:this.props.draftTextLayer,scale:this.getCanvasScale(),onLayerSelect:this.props.onLayerSelect,onLayerUnselect:this.props.onLayerUnselect,onLayerTranslate:this.props.onLayerTranslate,onLayerTransform:this.props.onLayerTransform,onTextEditingStart:this._handleTextEditingStart,onTextEditingEnd:this._handleTextEditingEnd,onTextInputOutsideClick:this._handleTextInputOutsideClick,onPaintDrawEnd:this.props.onPaintDrawEnd,onOutlineDrawEnd:this.props.onOutlineDrawEnd,onOutlineDone:this._handleClickDone,canEditBackground:this.props.sendAsSticker,outlineEnabled:this.props.sendAsSticker})}),D]}),M]})}}F.CONCERNS={attachMedia:["mediaEditorData","caption","id"]},F.displayName="ImageBodyBase";const B=(0,y.ListenerHOC)((0,M.default)(F,F.CONCERNS));t.default=class extends B{constructor(...e){super(...e),this.updatePreview=e=>this.getComponent().updatePreview(e)}undoAction(e,t){return this.getComponent().undoAction(e,t)}redoAction(e,t){return this.getComponent().redoAction(e,t)}getCanvasScale(){return this.getComponent().getCanvasScale()}resetUIState(){return this.getComponent().resetUIState()}getBackground(){return this.getComponent().getBackground()}}},92235:(e,t,a)=>{"use strict";var n=a(20862),i=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=i(a(48926)),r=a(61295),o=i(a(48158)),l=i(a(94184)),d=a(48360),c=a(67294),u=a(73754),h=i(a(11725)),f=a(69162),p=a(91940),m=i(a(55454)),g=i(a(51144)),v=i(a(84286)),C=a(6002),_=i(a(17893)),x=i(a(17747)),S=i(a(9042)),y=a(2561),E=a(54432),j=n(a(13540)),I=i(a(74711)),T=a(57085),b=a(63290),P=i(a(47193)),M=a(57528),w=a(39e3),L=i(a(66737)),k=a(85499),O=i(a(44532)),A=i(a(2408)),D=a(71681),R=a(75571),N=i(a(4231)),F=a(38961),B=i(a(39110)),U=i(a(7668)),H=i(a(86537)),G=a(65565),V=a(46714),W=i(a(40858)),z=i(a(2966)),K=a(4301),q=a(45139),Y=a(49201),Q=i(a(27988)),X=i(a(94252)),Z=i(a(85472)),$=a(85893);const{IMAGE:J,VIDEO:ee,AUDIO:te,STICKER:ae}=m.default.MSG_TYPE,ne=3*K.DEFAULT_FONT_SIZE;class ie extends c.Component{constructor(e){var t,a;super(e),t=this,this._setRefCanvasContainer=e=>{this._refCanvasContainer=e},this._setRefCanvas=e=>{this._refCanvas=e},this._setRefImageBody=e=>{this._refImageBody=e},this._setRefFileInput=e=>{this._refFileInput=e},this._setRefCaptionInput=e=>{this.props.mediaCollection.getActive()&&!e||(this._refCaptionInput=e)},this._setRefSendButton=e=>{this._refSendButton=e},this._mediaThumbRefMap=new Map,this._setRefMediaThumb=(e,t)=>{this._mediaThumbRefMap.set(e,t)},this._captionInputRefMap=new Map,this._setRefCaptionInput=(e,t)=>{this.props.mediaCollection.getActive()&&!t||this._captionInputRefMap.set(e,t)},this._setRefHotKeys=e=>{this._refHotKeys=e},this._update=(e,t)=>{if(e===this._getData())return;const a=this.state.activeMedia;var n,i,s;a&&(a.updateMediaEditorData(e,{undoable:null!==(n=null==t?void 0:t.undoable)&&void 0!==n&&n,lastAction:null!==(i=null==t?void 0:t.lastAction)&&void 0!==i?i:null}),this._updateUndoRedoState());(null==t?void 0:t.updatePreview)&&(null===(s=this._refImageBody)||void 0===s||s.updatePreview());__LOG__(2)`MediaEditor: Updated MediaEditorData`},this._getData=()=>{const{activeMedia:e}=this.state;return null==e?g.default.create():e.mediaEditorData},this._getBackground=()=>{var e;return null===(e=this._refImageBody)||void 0===e?void 0:e.getBackground()},this._handleUndo=()=>{const{activeMedia:e}=this.state;if(e&&e.canUndoMediaEditorData()){var t,a;const n=e.lastMediaEditorAction;e.undoMediaEditorData();const i=e.lastMediaEditorAction;this._updateUndoRedoState(),null===(t=this._refImageBody)||void 0===t||t.updatePreview(),null===(a=this._refImageBody)||void 0===a||a.undoAction(n,i)}},this._handleRedo=()=>{const{activeMedia:e}=this.state;if(e&&e.canRedoMediaEditorData()){var t,a;const n=e.lastMediaEditorAction;e.redoMediaEditorData();const i=e.lastMediaEditorAction;this._updateUndoRedoState(),null===(t=this._refImageBody)||void 0===t||t.updatePreview(),null===(a=this._refImageBody)||void 0===a||a.redoAction(i,n)}},this._updateUndoRedoState=()=>{this.setState((e=>{var t,a,n,i;const s=null!==(t=null===(a=this.state.activeMedia)||void 0===a?void 0:a.canUndoMediaEditorData())&&void 0!==t&&t,r=null!==(n=null===(i=this.state.activeMedia)||void 0===i?void 0:i.canRedoMediaEditorData())&&void 0!==n&&n;return e.canUndo!==s||e.canRedo!==r?{canUndo:s,canRedo:r}:null}))},this._addImageLayer=(e,t,a,n,i)=>{const s=(0,o.default)(this._refImageBody,"this._refImageBody").getCanvasScale(),r=t.width*s,l=t.width*s,d=Math.min(i/r,i/l),c=this._getData().addImageLayerToCenter({type:e,image:t,editable:!0,scale:d});this._update(c,{updatePreview:!0,undoable:!0})},this._handleEmojiSelect=function(){var e=(0,s.default)((function*(e){try{const a=y.EmojiUtil.getGlyphId(e);if(null==a)return;const n=y.EmojiUtil.getGlyphPath(a,"xlarge").high,i=yield re(n),s=t.state.sendAsSticker?128:64;t._addImageLayer(k.ImageLayerType.Emoji,i,i.width,i.height,s),t.state.sendAsSticker&&new N.default.WebcStickerMakerEvents({stickerMakerEventName:N.default.WEBC_STICKER_MAKER_EVENT_NAME_TYPE.EMOJI_ADDED}).commit()}catch(e){f.Cmd.openToast((0,$.jsx)(Y.Toast,{msg:A.default.t(1180),id:(0,Y.genId)()}))}}));return function(){return e.apply(this,arguments)}}(),this._handleStickerSelect=function(){var e=(0,s.default)((function*(e){try{let a;const n=e.mediaData.fullWidth,i=e.mediaData.fullHeight;if(yield(0,C.detectWebpSupport)()){const t=e.mediaData.filehash,n=R.MediaBlobCache.getOrCreateURL(t);a=yield re(n)}else a=yield function(){return oe.apply(this,arguments)}(e.mediaData);t._addImageLayer(k.ImageLayerType.Sticker,a,n,i,128),t.state.sendAsSticker&&new N.default.WebcStickerMakerEvents({stickerMakerEventName:N.default.WEBC_STICKER_MAKER_EVENT_NAME_TYPE.STICKER_ADDED}).commit()}catch(e){f.Cmd.openToast((0,$.jsx)(Y.Toast,{msg:A.default.t(1180),id:(0,Y.genId)()}))}}));return function(){return e.apply(this,arguments)}}(),this._handlePaintSelect=()=>{const e=this._getData().clearSelectedLayer();this._update(e)},this._handleOutlineSelect=()=>{const e=this._getData().clearSelectedLayer();this._update(e)},this._handleOutlineDone=()=>{const e=this._getBackground(),t=this._getData();if(!e||t.outlineLayer.isEmpty())return;const a=t.cropCenter,{width:n,height:i}=e,s=new U.default({x:a.x-n/2,y:a.y-i/2}),r=-t.rotation,o=Math.max(n,i),l=t.cropSize.dimension*((m.default.STICKER_DIMENSION-2*m.default.STICKER_PADDING)/m.default.STICKER_DIMENSION),d=t.updateBackground(e,s,r,l/o).clearOutlinePaths();this._update(d,{undoable:!0,updatePreview:!0,lastAction:u.MediaEditorAction.OutlineDone}),this.state.sendAsSticker&&new N.default.WebcStickerMakerEvents({stickerMakerEventName:N.default.WEBC_STICKER_MAKER_EVENT_NAME_TYPE.IMAGE_OUTLINED}).commit()},this._handleOutlineReset=()=>{const e=this._getData().clearOutlinePaths();this._update(e,{undoable:!0,updatePreview:!0})},this._handleCropRotateCanvas=(e,t,a)=>{const n=this._getData().setRotation(e).setCrop(t,a);this._update(n,{undoable:!0,updatePreview:!0,lastAction:u.MediaEditorAction.CropRotateCanvas}),this.state.sendAsSticker&&new N.default.WebcStickerMakerEvents({stickerMakerEventName:N.default.WEBC_STICKER_MAKER_EVENT_NAME_TYPE.IMAGE_CROPPED}).commit()},this._handlePaintColorSelect=e=>{this.setState({paintColor:e})},this._handlePaintThicknessSelect=e=>{this.setState({paintThickness:e})},this._handleOutlineSmoothingToggle=e=>{this.setState({outlineSmoothing:e})},this._handleTextSelect=()=>{if(this.state.currentlyEditingTextLayer)return;this._handleLayerUnselect();let e=1.2/(0,o.default)(this._refImageBody,"this._refImageBody").getCanvasScale();if(this.state.sendAsSticker){const t=this._getData().cropSize.dimension;e=ne*t/m.default.STICKER_DIMENSION/K.DEFAULT_FONT_SIZE}const t={origin:this._getData().cropCenter,text:"",textColor:this.state.textColor,textBackground:this.state.textBackground,alignment:this.state.alignment,font:this.state.font,scale:e},a=this._getData().addTextLayer(t),n=(0,o.default)(a.lastTextLayer,"data.lastTextLayer");this.setState({draftTextLayer:n,currentlyEditingTextLayer:null})},this._handleFontSelect=e=>{this.setState({font:e});const{selectedLayer:t}=this._getData(),{draftTextLayer:a}=this.state;if(a)this.setState({draftTextLayer:a.setFont(e)});else if(t&&t instanceof K.TextLayer){const a=this._getData().setFont(t,e);this._update(a,{updatePreview:!0,undoable:!0})}},this._handleAlignmentSelect=e=>{this.setState({alignment:e});const{selectedLayer:t}=this._getData(),{draftTextLayer:a}=this.state;if(a)this.setState({draftTextLayer:a.setAlignment(e)});else if(t&&t instanceof K.TextLayer){const a=this._getData().setAlignment(t,e);this._update(a,{updatePreview:!0,undoable:!0})}},this._handleTextColorSelect=e=>{this.setState({textColor:e});const{selectedLayer:t}=this._getData(),{draftTextLayer:a}=this.state;if(a)this.setState({draftTextLayer:a.setTextColor(e)});else if(t&&t instanceof K.TextLayer){const a=this._getData().setTextColor(t,e);this._update(a,{updatePreview:!0,undoable:!0})}},this._handleTextBackgroundToggle=()=>{const e=!this.state.textBackground;this.setState({textBackground:e});const{selectedLayer:t}=this._getData(),{draftTextLayer:a}=this.state;if(a)this.setState({draftTextLayer:a.setTextBackground(e)});else if(t&&t instanceof K.TextLayer){const a=this._getData().setTextBackground(t,e);this._update(a,{updatePreview:!0,undoable:!0})}},this._handleTextEditingStart=e=>{this.setState({draftTextLayer:e,currentlyEditingTextLayer:e})},this._handleTextEditingEnd=(e,t)=>{var a;if(t){let e=this._getData();const a=(0,o.default)(this.state.draftTextLayer,"this.state.draftTextLayer").setText(t);this.state.currentlyEditingTextLayer?e=e.updateLayer((0,o.default)(this.state.currentlyEditingTextLayer,"this.state.currentlyEditingTextLayer"),a):(e=e.addTextLayer(a),this.state.sendAsSticker&&new N.default.WebcStickerMakerEvents({stickerMakerEventName:N.default.WEBC_STICKER_MAKER_EVENT_NAME_TYPE.TEXT_ADDED}).commit()),this._update(e,{updatePreview:!0,undoable:!0})}else{const{currentlyEditingTextLayer:t}=this.state;t&&this._update(this._getData().deleteLayer(t),{updatePreview:!0,undoable:Boolean(e.text)})}setTimeout((()=>{this.setState({draftTextLayer:null,currentlyEditingTextLayer:null})}),0),null===(a=this._refHotKeys)||void 0===a||a.focus()},this._handlePaintDrawEnd=e=>{this._update(this._getData().addPaintPath(e),{undoable:!0,updatePreview:!0})},this._handleOutlineDrawEnd=e=>{this._update(this._getData().addOutlinePath(e),{undoable:!0,updatePreview:!0,lastAction:u.MediaEditorAction.Outline})},this._handleLayerUnselect=()=>{this._update(this._getData().clearSelectedLayer())},this._handleLayerSelect=e=>{if(!e.editable)return;const t=this._getData().setSelectedLayer(e);this._update(t),e instanceof K.TextLayer&&this.setState({textColor:e.textColor,textBackground:e.textBackground,font:e.font})},this._handleLayerTranslate=(e,t)=>{e instanceof k.ImageLayer&&e.isBackground()?this._update(this._getData().translateBackground(t),{updatePreview:!0,undoable:!0}):this._update(this._getData().translateLayer(e,t),{updatePreview:!0,undoable:!0})},this._handleLayerTransform=(e,t,a)=>{e instanceof k.ImageLayer&&e.isBackground()?this._update(this._getData().transformBackground(t,a),{updatePreview:!0,undoable:!0}):this._update(this._getData().transformLayer(e,t,a),{updatePreview:!0,undoable:!0})},this._handleLayerDelete=e=>{const t=this._getData().deleteLayer(e);this._update(t,{updatePreview:!0,undoable:!0})},this._handleMediaProcessUpdate=()=>{const{mediaCollection:e}=this.props;if(!e.canSend())return;const{errorMsgs:t}=e.uiProcessMsgs();t&&(f.Cmd.openToast((0,$.jsx)(Y.Toast,{msg:t,id:(0,Y.genId)()})),0===e.getPreviewableMedias().length&&this.props.onClose()),this.forceUpdate()},this._handleDrop=e=>{this.state.viewOnce||this.state.sendAsSticker||this._handleFilePick(e)},this._handleDragChange=(e,t)=>{this.state.viewOnce||this.state.sendAsSticker||(this.setState({isDragging:e}),e||t||this.props.mediaCollection.length||this.props.onClose())},this._handleCaptionChange=e=>{const{activeMedia:t,isInitCaptionUsed:a}=this.state;if(!t)return;const n=this.props.mediaCollection.indexOf(t);t.updateCaption(e),0===n&&""===e&&a&&this.setState({isInitCaptionUsed:!1})},this._handlePaste=e=>{e.preventDefault(),e.stopPropagation();const t=new v.default(e.clipboardData);t.hasFiles()&&this._handleFiles(t)},this._handleFiles=e=>{const t=e.getFiles().filter((e=>{const t=(0,T.typeFromMimetype)(e.type);return"image"===t||"video"===t})).map((e=>({file:e})));this.props.mediaCollection.processAttachments(t,N.default.MEDIA_PICKER_ORIGIN_TYPE.PASTE)},this._handleAddFileClick=()=>{if(this._refFileInput){this._refFileInput.click()}},this._handleFilePick=e=>{const t=this.props.getUnmountSignal();(0,E.getFiles)(e).then((a=>{if(t.aborted)return;let n;return e.shiftKey&&e.altKey&&1===a.length&&(this.setState({sendAsSticker:!0,paintThickness:q.THICKNESS.XLARGE}),n=!0),this.props.mediaCollection.processAttachments(a.map((e=>({file:e,stickerMaker:n}))),N.default.MEDIA_PICKER_ORIGIN_TYPE.CHAT_PHOTO_LIBRARY)})).catch((0,r.filteredCatch)(j.MediaDragDropError,(e=>{this.props.mediaCollection.length||this.props.onDropText(e.src)}))),e.target.value&&(e.target.value="")},this._handleEnter=e=>{var t;if(!this.state.activeMedia)return;if(e.repeat)return;if(e.shiftKey)return;if(this.state.draftTextLayer)return;const{selectedLayer:a}=this._getData();if(a instanceof K.TextLayer)return e.preventDefault(),e.stopPropagation(),void this._handleTextEditingStart(a);(null===(t=this._refImageBody)||void 0===t?void 0:t.resetUIState())||this._handleSendFromMediaEditor()},this._handleArrowKey=(e,t)=>{var a;if(!this.state.activeMedia||t.repeat||this.state.draftTextLayer)return;const{activeMedia:n}=this.state,i=n&&!n.caption,s=null===(a=this._refCaptionInput)||void 0===a?void 0:a.refInput;(i||s&&!s.isFocused()||s&&s.cursorIsAtStart())&&("left"===e?this._handlePrev():this._handleNext())},this._handlePrev=()=>{this.props.mediaCollection.setPrevAsActive()&&(this._refSendButton&&!this.state.draftTextLayer&&P.default.focus(this._refSendButton),this._scrollIntoView())},this._handleNext=()=>{this.props.mediaCollection.setNextAsActive()&&(this._refSendButton&&!this.state.draftTextLayer&&P.default.focus(this._refSendButton),this._scrollIntoView())},this._scrollIntoView=()=>{const{activeMedia:e}=this.state;if(!e)return;const t=this._mediaThumbRefMap.get(e.id);t&&t.scrollIntoView()},this._handleSelectThumb=e=>{this.props.mediaCollection.setActive(e)},this._handleRemoveThumb=(e,t)=>{t.stopPropagation(),t.preventDefault(),this.props.mediaCollection.remove(e),0===this.props.mediaCollection.getValidMedias().length?this._delayedClose=setTimeout((()=>{this.props.onClose()}),200):this._refSendButton&&P.default.focus(this._refSendButton)},this._handleSendFromMediaEditor=e=>{var t;null==e||e.preventDefault(),null==e||e.stopPropagation();const{mediaCollection:a}=this.props;if(!a.canSend())return;const n=a.getPreviewableMedias();if(0===n.length)return void this.props.onClose();var i;((null===(t=this.state.activeMedia)||void 0===t?void 0:t.mediaEditorData.hasEdits())||this.state.sendAsSticker)&&(null===(i=this._refImageBody)||void 0===i||i.updatePreview({immediately:!0}));const s=new Map,r=[];n.forEach((e=>{const t=e.caption,n=this._captionInputRefMap.get(e.id);if(t&&n){const a=n.serialize(t);s.set(e.id,a)}if(e.editedFile&&(e.mediaEditorData.hasEdits()||this.state.sendAsSticker)){const t=a.replace(e.id,{file:e.editedFile,asSticker:this.state.sendAsSticker});r.push(t)}})),Promise.all(r).then((()=>{const e=a.getPreviewableMedias();if(0===e.length)return;const t=e.map((e=>{var t;let a=e.caption,n=[];const i=s.get(e.id);if(i){const[e,t]=[i[0].trim(),i[1]];e.length&&(a=e,n=t.mentionedJidList||[])}return e.caption=null!==(t=a)&&void 0!==t?t:void 0,{media:e,mentionedJidList:n}}));this.props.onSendMedia(t,{initCaptionUsed:this.state.isInitCaptionUsed,isViewOnce:this._canViewOnce()&&this.state.viewOnce}),this._commitMediaEditorSendMetric(n)}))},this._handleToggleViewOnce=e=>{this.setState({viewOnce:e})},this._handleToggleStickerMaker=()=>{const e=!this.state.sendAsSticker&&this._canSendAsSticker();this.setState({sendAsSticker:e,paintThickness:e?q.THICKNESS.XLARGE:q.THICKNESS.SMALL})},this._canViewOnce=()=>{var e;const{chat:t,mediaCollection:a}=this.props,n=t.contact.isEnterprise;return G.ServerProps.viewOnceWrite&&1===a.length&&!0===(null===(e=a.at(0))||void 0===e?void 0:e.isViewableOnce())&&!n&&!this.props.sendAsSticker},this._canSendAsSticker=()=>{var e;const{mediaCollection:t}=this.props;return 1===t.length&&(null===(e=t.at(0))||void 0===e?void 0:e.type)===J},this._getMediaBody=e=>{let t=null;const{paintColor:a,paintThickness:n,outlineSmoothing:i,canUndo:s,canRedo:r}=this.state,o=G.ServerProps.viewOnceWrite?this.state.viewOnce:null;switch(e.type){case ae:case J:t=(0,$.jsx)(L.default,{ref:this._setRefImageBody,attachMedia:e,chat:this.props.chat,onCaptionChange:this._handleCaptionChange,onClose:"capture"===this.props.theme?null:this.props.onClose,onEnter:this._handleSendFromMediaEditor,setCaptionInputRef:this._setRefCaptionInput,paintColor:a,paintThickness:n,outlineSmoothing:i,canUndo:s,canRedo:r,currentlyEditingTextLayer:this.state.currentlyEditingTextLayer,draftTextLayer:this.state.draftTextLayer,viewOnce:o,viewOnceDisabled:!this._canViewOnce(),sendAsSticker:this.state.sendAsSticker,onPaintSelect:this._handlePaintSelect,onOutlineSelect:this._handleOutlineSelect,onOutlineDone:this._handleOutlineDone,onOutlineReset:this._handleOutlineReset,onTextSelect:this._handleTextSelect,onTextBackgroundToggle:this._handleTextBackgroundToggle,onEmojiSelect:this._handleEmojiSelect,onStickerSelect:this._handleStickerSelect,onLayerSelect:this._handleLayerSelect,onLayerUnselect:this._handleLayerUnselect,onLayerDelete:this._handleLayerDelete,onLayerTranslate:this._handleLayerTranslate,onLayerTransform:this._handleLayerTransform,onTextEditingStart:this._handleTextEditingStart,onTextEditingEnd:this._handleTextEditingEnd,onTextColorSelect:this._handleTextColorSelect,onFontSelect:this._handleFontSelect,onAlignmentSelect:this._handleAlignmentSelect,onPaintColorSelect:this._handlePaintColorSelect,onPaintThicknessSelect:this._handlePaintThicknessSelect,onOutlineSmoothingToggle:this._handleOutlineSmoothingToggle,onCropRotateCanvas:this._handleCropRotateCanvas,onUndo:this._handleUndo,onRedo:this._handleRedo,onPaintDrawEnd:this._handlePaintDrawEnd,onOutlineDrawEnd:this._handleOutlineDrawEnd,onToggleViewOnce:this._handleToggleViewOnce,onFiles:this._handleFiles},e.mediaEditorData.id);break;case ee:t=(0,$.jsx)(X.default,{attachMedia:e,chat:this.props.chat,viewOnce:o,viewOnceDisabled:!this._canViewOnce(),setCaptionInputRef:this._setRefCaptionInput,onCaptionChange:this._handleCaptionChange,onClose:this.props.onClose,onEnter:this._handleSendFromMediaEditor,onToggleViewOnce:this._handleToggleViewOnce,onFiles:this._handleFiles},e.id);break;case te:t=(0,$.jsx)(h.default,{item:e,onClose:this.props.onClose},e.id);break;default:t="pdf"===(0,F.previewType)(e.mimetype)?(0,$.jsx)(B.default,{item:e,onClose:this.props.onClose},e.id):(0,$.jsx)(I.default,{mimeType:e.mimetype,filesize:e.filesize,filename:e.filename,fileExt:e.fileExt,onClose:this.props.onClose},e.id)}return t},this.getThumbs=()=>{const{mediaCollection:e}=this.props;return(0,$.jsx)(_.default,{className:O.default.thumbs,mediaCollection:e,onClick:this._handleSelectThumb,onClose:this._handleRemoveThumb,forwardRef:this._setRefMediaThumb})},this.state={paintColor:(0,p.getColorValue)(p.COLORS.BLUE),paintThickness:e.sendAsSticker?q.THICKNESS.XLARGE:q.THICKNESS.SMALL,outlineSmoothing:!0,textColor:(0,p.getColorValue)(p.COLORS.BLACK),font:M.FONTS.SANS_SERIF,textBackground:!0,alignment:M.TextAlignment.CENTER,isDragging:!1,canUndo:!1,canRedo:!1,activeMedia:null,prevActiveMedia:null,isInitCaptionUsed:!1,initCaption:null===(a=this.props.initCaption)||void 0===a?void 0:a.text,currentlyEditingTextLayer:null,draftTextLayer:null,viewOnce:!1,sendAsSticker:e.sendAsSticker}}static getDerivedStateFromProps(e,t){var a,n;const i=e.mediaCollection.getActive(),s=t.initCaption;let r=t.isInitCaptionUsed;return r||t.activeMedia||!s||!i||i.type!==J&&i.type!==ee||(i.caption=s,r=!0),{prevActiveMedia:i,activeMedia:i,canUndo:null!==(a=null==i?void 0:i.canUndoMediaEditorData())&&void 0!==a&&a,canRedo:null!==(n=null==i?void 0:i.canRedoMediaEditorData())&&void 0!==n&&n,isInitCaptionUsed:r}}componentDidMount(){var e;const{mediaCollection:t,listeners:a}=this.props;t.isStickerMaker=this.state.sendAsSticker,a.add(t,"add remove reset",(()=>{this.forceUpdate()})),a.add(t,"active-change change:state change:previewable",this._handleMediaProcessUpdate),a.add(f.Cmd,"toggle_sticker_maker",this._handleToggleStickerMaker),null===(e=this._refHotKeys)||void 0===e||e.focus()}componentDidUpdate(){this.props.mediaCollection.isStickerMaker=this.state.sendAsSticker}componentWillUnmount(){this._delayedClose&&clearTimeout(this._delayedClose)}handleRequestDismiss(){var e;return!(null===(e=this._refImageBody)||void 0===e?void 0:e.resetUIState())&&(!this.state.draftTextLayer||(this.setState({currentlyEditingTextLayer:null,draftTextLayer:null}),!1))}_commitMediaEditorSendMetric(e){if(this.state.sendAsSticker)return new N.default.StickerSend({stickerSendOrigin:N.default.STICKER_SEND_ORIGIN_TYPE.STICKER_MAKER,stickerIsAnimated:!1,stickerIsFirstParty:!1,stickerIsFromStickerMaker:!0}).commit(),void new N.default.WebcStickerMakerEvents({stickerMakerEventName:N.default.WEBC_STICKER_MAKER_EVENT_NAME_TYPE.SEND_STICKER}).commit();let t=0,a=0,n=0,i=0,s=0,r=0;e.forEach((e=>{const o=e.mediaEditorData;e.type===J&&(t++,o.hasEdits()&&a++,o.paintLayer.paths.length>0&&n++),o.layers.forEach((e=>{e instanceof k.ImageLayer?(e.isEmoji()&&i++,e.isSticker()&&s++):e instanceof K.TextLayer&&r++}))})),new N.default.WebcMediaEditorSend({imageCount:t,editedImageCount:a,paintedImageCount:n,emojiLayerCount:i,stickerLayerCount:s,textLayerCount:r}).commit()}render(){const{mediaCollection:e}=this.props,{activeMedia:t}=this.state;let a,n=e.getPreviewableMedias();n.length>m.default.MAX_FILES&&(n=n.slice(0,m.default.MAX_FILES)),e.canSend()?t&&(a=this._getMediaBody(t)):a=(0,$.jsx)("div",{className:O.default.spinner,children:(0,$.jsx)(V.Spinner,{color:"highlight"},"processing")});const i=this.state.isDragging?(0,$.jsx)("div",{className:O.default.dropOverlay,children:(0,$.jsx)("div",{className:O.default.dropOverlayOutline,children:A.default.t(750)})},"container"):null,s={enter:this._handleEnter,left:e=>this._handleArrowKey("left",e),right:e=>this._handleArrowKey("right",e)},r="*"===F.DOC_MIMES?"*":[m.default.IMAGE_MIMES].join();let o;if(null!=a){let t;if(n.length>0&&(t=(0,$.jsx)("div",{className:O.default.sendButton,tabIndex:"-1",ref:this._setRefSendButton,onKeyPress:e=>e.preventDefault(),children:(0,$.jsx)(H.default,{ariaLabel:d.fbt._("Send",null,{hk:"2JJUaP"}),large:!0,icon:(0,$.jsx)(z.default,{name:"send",directional:!0}),count:1===n.length?null:n.length,onClick:this._handleSendFromMediaEditor,disabled:!e.canSend()})})),"capture"===this.props.theme)o=(0,$.jsx)("div",{className:O.default.captureFooter,children:t});else{const e=!this.state.viewOnce&&!this.state.sendAsSticker&&n.length<m.default.MAX_FILES,a="add-alt",i=this.state.sendAsSticker?null:(0,$.jsx)(W.default,{className:(0,l.default)(O.default.addMediaButton,{[O.default.addMediaButtonDisabled]:!e}),disabled:!e,name:a,title:d.fbt._("Add file",null,{hk:"4Gvj3D"}),onClick:this._handleAddFileClick,"aria-label":d.fbt._("Add file",null,{hk:"4Gvj3D"})},"media-more");let s;n.length>0&&(s=(0,$.jsxs)(b.FlexRow,{className:O.default.filmstripContainer,justify:"center",align:"start",children:[this.getThumbs(),i]})),o=(0,$.jsxs)("div",{className:O.default.footer,children:[s,t]})}}const c=(0,l.default)(O.default.container,{[O.default.previewOnly]:t&&t.type!==J});let u=(0,$.jsxs)(b.FlexColumn,{className:c,align:"stretch",children:[i,a,o,(0,$.jsx)("input",{ref:this._setRefFileInput,type:"file",accept:r,style:{display:"none"},onChange:this._handleFilePick,multiple:!0})]});return"attach"===this.props.theme&&(u=(0,$.jsx)(x.default,{theme:"media",onDrop:this._handleDrop,onDragChange:this._handleDragChange,children:(0,$.jsx)(S.default,{tabIndex:"-1",overflow:"hidden",onPaste:this._handlePaste,children:u})},"attach-image-modal")),(0,$.jsx)(w.HotKeys,{handlers:s,onRef:this._setRefHotKeys,children:u})}}ie.defaultProps={onClose:()=>{},theme:"attach",sendAsSticker:!1},ie.displayName="MediaEditor";const se=(0,Q.default)((0,D.ListenerHOC)(ie));function re(e){return new Promise(((t,a)=>{const n=new Image;n.onload=()=>{t(n)},n.onerror=a,n.src=e}))}function oe(){return(oe=(0,s.default)((function*(e){let t=e.rgbaBuffer;if(!t){const a=R.MediaBlobCache.get(e.filehash);if(!a)throw new Error("Failed to get media blob");const n=yield(0,T.blobToArrayBuffer)(a),i=(yield(0,Z.default)(n)).frames[0];if(!i)throw new Error("Failed to get sticker first frame.");t=i.rgbaBuffer}const a=e.fullWidth,n=e.fullHeight,i=document.createElement("canvas");i.width=a,i.height=n;const s=i.getContext("2d"),r=s.createImageData(a,n);return r.data.set(new Uint8Array(t)),s.putImageData(r,0,0),i}))).apply(this,arguments)}t.default=class extends se{handleRequestDismiss(){return this.getComponent().handleRequestDismiss()}}},11725:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function({onClose:e,item:t}){const{mimetype:a,fullPreview:n}=t;return(0,o.jsxs)("div",{className:r.default.container,children:[(0,o.jsx)(s.default,{onClose:e}),(0,o.jsx)(i.default,{mimeType:a,url:n})]})};var i=n(a(59732)),s=n(a(77903)),r=n(a(81419)),o=a(85893)},23742:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function({data:e,rotation:t,cropOrigin:a,cropSize:n,containerSize:g,keepRatio:v,onCropChange:C,sendAsSticker:_}){const x=e.resetCropRotate().setRotation(t),S=(0,i.useRef)(),y=(0,i.useRef)(),{width:E,height:j}=n,{x:I,y:T}=a,b=(0,i.useRef)(n),P=E/b.current.width,M=j/b.current.height,w=e.width,L=e.height,{width:k,height:O}=p(w,L,t),A=new d.default({width:g.width-20,height:g.height-20}),D=(0,c.calculateContainScale)(t%180?L:w,t%180?w:L,A,h),R=f/D,N=new d.default({width:w+2*R,height:L+2*R}),{width:F,height:B}=p(N.width,N.height,t),U=N.width/2,H=N.height/2;(0,i.useEffect)((()=>{const e=S.current,t=y.current;var a;e&&t&&0===e.nodes().length&&(e.nodes([t]),null===(a=t.getLayer())||void 0===a||a.batchDraw())}));const G=e=>{const{target:t}=e,a=Math.round(t.x()),n=Math.round(t.y()),i=Math.min(Math.round(t.width()*t.scaleX()),w-a),s=Math.min(Math.round(t.height()*t.scaleY()),L-n);C(new o.default({x:a,y:n}),new d.default({width:i,height:s}))},V=["top-left","top-right","bottom-left","bottom-right"];v||V.push("top-center","middle-right","middle-left","bottom-center");return(0,u.jsxs)("div",{className:r.default.container,children:[(0,u.jsx)(s.default,{data:x,scale:D,canEditLayer:!1,style:{padding:f},outlineEnabled:_}),(0,u.jsx)(l.Stage,{className:r.default.cropperContainer,width:Math.round(F*D),height:Math.round(B*D),scaleX:D,scaleY:D,children:(0,u.jsx)(l.Layer,{rotation:t,offsetX:U,offsetY:H,x:F/2,y:B/2,children:(0,u.jsxs)(l.Group,{x:R,y:R,children:[(0,u.jsx)(l.Rect,{x:0,y:0,width:w,height:L,fill:"black",opacity:.6}),(0,u.jsx)(l.Rect,{ref:y,fill:"red",x:I,y:T,width:b.current.width,height:b.current.height,scaleX:P,scaleY:M,draggable:!0,dragBoundFunc:e=>{const{width:a,height:n}=p(E,j,t);let{x:i,y:s}=function(e,t,a,n,i){switch((i%360+360)%360){case 0:return{x:e,y:t};case 90:return{x:e-a,y:t};case 180:return{y:t-n,x:e-a};case 270:return{x:e,y:t-n};default:throw new Error("Unsupported angle")}}(e.x,e.y,a*D,n*D,t);i<f?i=f:(i-f)/D+a>k&&(i=Math.round(k-a+R)*D),s<f?s=f:(s-f)/D+n>O&&(s=Math.round(O-n+R)*D);return function(e,t,a,n,i){switch((i%360+360)%360){case 0:return{x:e,y:t};case 90:return{x:e+a,y:t};case 180:return{y:t+n,x:e+a};case 270:return{x:e,y:t+n};default:throw new Error("Unsupported angle")}}(i,s,a*D,n*D,t)},onTransformEnd:G,onDragEnd:G,globalCompositeOperation:"destination-out"}),(0,u.jsx)(l.Transformer,{ref:S,anchorStroke:"blue",anchorFill:"white",anchorSize:10,anchorCornerRadius:5,borderEnabled:!1,centeredScaling:!1,resizeEnabled:!0,rotateEnabled:!1,ignoreStroke:!0,boundBoxFunc:(e,a)=>{const n=w*D+20,i=L*D+20,s=m(e,n,i,t,-t),r=m(a,n,i,t,-t);return Math.round(r.x)<f?(r.x=f,r.width=s.width+(s.x-f)):Math.round(r.width)<20?(r.x=s.x,r.width=s.width):Math.round(r.x+r.width)>Math.round(n)-f&&(r.width=n-r.x-f),Math.round(r.y)<f?(r.y=f,r.height=s.height+(s.y-f)):Math.round(r.height)<20?(r.y=s.y,r.height=s.height):Math.round(r.y+r.height)>Math.round(i)-f&&(r.height=i-r.y-f),m(r,n,i,0,t)},keepRatio:v,enabledAnchors:V},"transformer")]})},"cropper")})]})};var i=a(67294),s=n(a(64193)),r=n(a(70905)),o=n(a(7668)),l=a(47971),d=n(a(60738)),c=a(50240),u=a(85893);const h=new d.default({width:200,height:200}),f=10;function p(e,t,a){return{width:a%180==0?e:t,height:a%180==0?t:e}}function m(e,t,a,n,i){const s=Math.max(t,a),r=p(t,a,n),l=(s-r.width)/2,d=(s-r.height)/2,c=new o.default({x:e.x+l,y:e.y+d}),u=new o.default({x:s/2,y:s/2}),h=c.rotate(u,i),f=p(t,a,n+i),m=(s-f.width)/2,g=(s-f.height)/2;return{x:h.x-m,y:h.y-g,width:e.width,height:e.height,rotation:e.rotation}}},74711:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function({onClose:e,filename:t,filesize:a,fileExt:n,mimeType:h}){var f;const p=null!=a?l.default.filesize(a):"",m=null!==(f=u[h])&&void 0!==f?f:"preview-generic";return(0,c.jsxs)("div",{className:o.default.container,children:[(0,c.jsx)(r.default,{onClose:e,filename:t}),(0,c.jsx)(s.FlexColumn,{className:i.default.body,align:"center",justify:"center",children:(0,c.jsxs)(s.FlexColumn,{className:i.default.previewContainer,align:"center",justify:"center",children:[(0,c.jsx)("div",{className:i.default.previewIcon,children:(0,c.jsx)(d.default,{name:m})}),(0,c.jsx)("div",{className:i.default.header,children:l.default.t(1186)}),(0,c.jsxs)("div",{className:i.default.metadata,children:[p,n?` - ${n.toUpperCase()}`:null]})]})})]})};var i=n(a(2482)),s=a(63290),r=n(a(77903)),o=n(a(81419)),l=n(a(2408)),d=n(a(2966)),c=a(85893);const u={"text/plain":"preview-txt","text/rtf":"preview-doc","application/msword":"preview-doc","application/vnd.openxmlformats-officedocument.wordprocessingml.document":"preview-doc","text/csv":"preview-sheet","application/vnd.ms-excel":"preview-sheet","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":"preview-sheet","application/vnd.ms-powerpoint":"preview-slides","application/vnd.openxmlformats-officedocument.presentationml.presentation":"preview-slides","audio/aac":"preview-audio","audio/mp4":"preview-audio","audio/amr":"preview-audio","audio/mpeg":"preview-audio","audio/ogg; codecs=opus":"preview-audio","audio/wav":"preview-audio","application/zip":"preview-compressed"}},77903:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{filename:t,pageCount:a}=e;let n=null;null!=a&&a>0&&(n=r.default.t(182,{count:a,_plural:a}));return(0,l.jsxs)("div",{className:(0,s.default)(d),children:[(0,l.jsx)("button",{"aria-label":i.fbt._("Close",null,{hk:"17RE2w"}),onClick:e.onClose,className:(0,s.default)(f),children:(0,l.jsx)(o.default,{"aria-hidden":!0,color:"secondary",name:"x"})}),(0,l.jsxs)("div",{className:(0,s.default)(c),children:[t&&(0,l.jsx)("span",{className:(0,s.default)(u),children:t}),null!=n&&(0,l.jsx)("span",{className:(0,s.default)(h),children:n})]})]})};var i=a(48360),s=n(a(56720)),r=n(a(2408)),o=n(a(2966)),l=a(85893);const d={display:"p357zi0d",alignItems:"gndfcl4n",justifyContent:"o4u7okr9",minHeight:"cl7oiv0o",paddingTop:"fbgy3m38",paddingEnd:"l9g3jx6n",paddingBottom:"oq31bsqd",paddingStart:"lyvj5e2u",backgroundColor:"ej3x2ktq"},c={display:"p357zi0d",flexGrow:"ggj6brxn",flexShrink:"m0h2a7mj",flexBasis:"rjo8vgbg",flexDirection:"f8m0rgwh",alignItems:"gndfcl4n"},u={fontSize:"f8jlpxt4",color:"tl2vja3b"},h={marginTop:"hymafltn",fontSize:"dsh4tgtl",color:"pm5hny62"},f={cursor:"ajgl1lbb"}},39110:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function({onClose:e,item:t}){const{mimetype:a,fullPreview:n,fullPreviewSize:d,documentPageCount:c,filename:u}=t;if(!(n&&d&&null!=c&&c>0))return(0,l.jsx)(s.default,{mimeType:t.mimetype,filesize:t.filesize,filename:t.filename,fileExt:t.fileExt,onClose:e});return(0,l.jsxs)("div",{className:o.default.container,children:[(0,l.jsx)(r.default,{onClose:e,filename:u,pageCount:c}),(0,l.jsx)(i.default,{fullPreview:n,fullPreviewSize:d,pageCount:c,showPageCount:!1,showBorder:!0,mimeType:a,filename:u})]})};var i=n(a(12218)),s=n(a(74711)),r=n(a(77903)),o=n(a(81419)),l=a(85893)},94252:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function({attachMedia:e,onClose:t,chat:a,viewOnce:n,viewOnceDisabled:i,onCaptionChange:f,onEnter:p,setCaptionInputRef:m,onToggleViewOnce:g,onFiles:v}){const{caption:C}=(0,d.useModelValues)(e,["caption"]);return(0,u.jsxs)("div",{className:c.default.container,children:[(0,u.jsx)(o.default,{onClose:t}),(0,u.jsx)(s.default,{mimeType:e.mimetype,url:e.fullPreview,isGif:e.isGif,size:e.fullPreviewSize,processing:e.state===h,preview:e.preview}),(0,u.jsx)("div",{className:c.default.footer,children:(0,u.jsx)(r.default,{chat:a,caption:C,viewOnce:n,viewOnceDisabled:i,msgType:l.TYPE.VIDEO,theme:"video",onToggleViewOnce:g,onChange:f,onEnter:p,onFiles:v,setCaptionInputRef:t=>{m(e.id,t)}},e.id)})]})};var i=a(73754),s=n(a(51427)),r=n(a(8731)),o=n(a(77903)),l=a(92954),d=a(76006),c=n(a(43232)),u=a(85893);const{PROCESSING:h}=i.ATTACH_MEDIA_STATE},91420:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{children:t,onClick:a,icon:n,caret:d,disabled:c,title:u,selected:h}=e;let f,p;if("string"==typeof n)switch(n){case"sans-serif":f=(0,l.jsx)(o.default,{name:"panel-emoji-flags",display:"inline"});break;case"checked":f=(0,l.jsx)(o.default,{name:"checkmark",display:"inline"});break;case"unchecked":f=(0,l.jsx)(o.default,{name:"x",display:"inline"});break;default:n&&(f=(0,l.jsx)(o.default,{name:n,display:"inline"}))}else n&&(f=n);if(d)switch(d){case"up":p=(0,l.jsx)(o.default,{name:"chevron-down-alt",display:"inline",className:s.default.rotate});break;case"down":p=(0,l.jsx)(o.default,{name:"chevron-down-alt",display:"inline"})}return(0,l.jsxs)("div",{role:"button",tabIndex:"-1",onClick:a,className:(0,i.default)(s.default.container,e.className,{[s.default.disabled]:c,[s.default.selected]:h}),title:u,children:[f&&(0,l.jsx)(r.FlexRow,{align:"center",justify:"center",className:s.default.icon,children:f}),t&&(0,l.jsx)("span",{className:s.default.body,children:t}),p&&(0,l.jsx)("span",{className:s.default.caret,children:p})]})};var i=n(a(94184)),s=n(a(35588)),r=a(63290),o=n(a(2966)),l=a(85893)},40156:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(67294),s=n(a(91420)),r=n(a(78055)),o=n(a(96701)),l=n(a(87482)),d=a(9492),c=a(63290),u=n(a(2408)),h=a(63477),f=n(a(68062)),p=a(85893);function m(e,t){const{colors:a,onColorSelect:n,selectedColor:m}=e,[g,v]=(0,i.useState)(null),C=()=>{v(null)},_=()=>Boolean(g);(0,i.useImperativeHandle)(t,(()=>({isPanelVisible:_})));const x=a.map((({primaryColor:e,secondaryColor:t})=>(0,p.jsx)(o.default,{primaryColor:e,onSelect:()=>n(e),selected:Boolean(m&&m.equals(e))},e.toString())));let S=null;return g&&(S=(0,p.jsx)(h.UIE,{displayName:"ColorPicker",escapable:!0,popable:!0,requestDismiss:C,children:(0,p.jsx)(f.default,{contextMenu:g})})),(0,p.jsxs)("div",{className:r.default.container,children:[(0,p.jsx)(c.FlexRow,{className:r.default.colorChipsContainer,children:x}),(0,p.jsx)(s.default,{onClick:e=>{e.preventDefault(),e.stopPropagation();const t={menu:(0,p.jsx)(l.default,{onColorSelect:n,selectedColor:m,onColorPickerClose:C}),dirX:u.default.isRTL()?d.DirX.RIGHT:d.DirX.LEFT,dirY:d.DirY.BOTTOM,type:"color_picker",anchor:e.target};v(t)},caret:g?"down":"up"}),S]})}var g=(0,i.forwardRef)(m);t.default=g},96701:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{primaryColor:t,secondaryColor:a,onSelect:n,selected:l,withBorder:d}=e,[c,u]=(0,s.useState)(!1),[h,f]=(0,s.useState)(!1);return(0,o.jsx)("div",{onClick:n,onMouseEnter:()=>{u(!0)},onMouseLeave:()=>{u(!1)},onMouseDown:()=>{f(!0)},onMouseUp:()=>{f(!1)},className:(0,i.default)(r.default.colorButton,{[r.default.selected]:l,[r.default.hover]:c,[r.default.active]:h}),style:{backgroundColor:h&&!l?t.withAlpha(.2).toRgbaString():"transparent"},children:(0,o.jsx)("div",{className:(0,i.default)(r.default.primaryColorChip,{[r.default.colorChipWithBorder]:d&&t.isWhite(),[r.default.primaryColorChipMedium]:"medium"===e.theme}),style:{backgroundColor:t.toRgbaString()},children:a&&l&&(0,o.jsx)("div",{className:r.default.secondaryColorChip,style:{backgroundColor:a.toRgbaString()}})})})};var i=n(a(94184)),s=a(67294),r=n(a(89471)),o=a(85893)},63097:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(67294),s=a(33845),r=n(a(96701)),o=n(a(95698)),l=a(30905),d=a(39e3),c=a(20845),u=a(85893);class h extends i.Component{constructor(...e){super(...e),this._setRefHexColorInput=e=>this._refHexColorInput=e,this.state={inputColorVal:this.props.color.toHex(),selectedColor:this.props.color},this._handleInputChange=e=>{const t=e.target.value;if(this.setState({inputColorVal:t}),!t||t&&!(0,s.isValidHex)(t))return;const a=s.Color.fromHex(t);this.props.onChangeColor(a)},this._handleEnter=()=>{this.props.onColorPickerClose()}}static getDerivedStateFromProps(e,t){const a={};return e.color!==t.selectedColor&&((0,s.compareHex)(t.inputColorVal,e.color.toHex())||(a.inputColorVal=e.color.toHex()),a.selectedColor=e.color),a}render(){const{color:e}=this.props,{inputColorVal:t}=this.state;return(0,u.jsxs)("div",{className:o.default.container,style:{width:l.CONTAINER_WIDTH,height:l.INPUT_HEIGHT},children:[(0,u.jsx)(r.default,{withBorder:!0,primaryColor:e,selected:!1,theme:"medium"}),(0,u.jsx)(d.HotKeys,{handlers:{enter:this._handleEnter},children:(0,u.jsx)(c.SelectableDiv,{selectable:!0,children:(0,u.jsx)("input",{type:"text",ref:this._setRefHexColorInput,className:o.default.input,value:t,onChange:this._handleInputChange})})})]})}}t.default=h,h.displayName="ColorPickerInput"},31557:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{color:t,onChangeSelectedColor:a,onChangeCanvasColor:n}=e,u=(0,i.useRef)(null),[h,f]=(0,i.useState)(!1);(0,i.useEffect)((()=>{const e=u.current;if(!e)return;const t=e.getContext("2d");let a=t.createLinearGradient(0,0,e.width,0);a.addColorStop(0,"#ff0000"),a.addColorStop(1/6,"#ffff00"),a.addColorStop(1/6*2,"#00ff00"),a.addColorStop(.5,"#00ffff"),a.addColorStop(1/6*4,"#0000ff"),a.addColorStop(1/6*5,"#ff00ff"),a.addColorStop(1,"#ff0000"),t.fillStyle=a,t.fillRect(0,0,e.width,e.height),a=t.createLinearGradient(0,0,0,e.height),a.addColorStop(0,"rgba(255, 255, 255, 1)"),a.addColorStop(.5,"rgba(255, 255, 255, 0)"),a.addColorStop(1,"rgba(255, 255, 255, 0)"),t.fillStyle=a,t.fillRect(0,0,e.width,e.height),a=t.createLinearGradient(0,0,0,e.height),a.addColorStop(0,"rgba(0, 0, 0, 0)"),a.addColorStop(.5,"rgba(0, 0, 0, 0)"),a.addColorStop(1,"rgba(0, 0, 0, 1)"),t.fillStyle=a,t.fillRect(0,0,e.width,e.height)}),[]);const p=(0,l.getPositionFromColor)(t),m=(0,d.default)(a,o.THROTTLE_WAIT_TIME),g=(e,t)=>{null!=t&&f(t);const{x:a,y:i}=(e=>{const t=u.current;if(!t)return{x:0,y:0};const a=t.getBoundingClientRect();let n=e.clientX-a.left,i=e.clientY-a.top;return n>a.width&&(n=a.width-.1),n<0&&(n=0),i>a.height&&(i=a.height),i<0&&(i=.1),n-=o.CURSOR_SIZE/2,i-=o.CURSOR_SIZE/2,{x:n,y:i}})(e),r=(e=>{const t=u.current;if(!t)return new s.Color(0,0,0);const a=e.x+o.CURSOR_SIZE/2,n=e.y+o.CURSOR_SIZE/2,i=t.getContext("2d").getImageData(a,n,1,1).data;return new s.Color(i[0],i[1],i[2])})({x:a,y:i});m(r),n(r)};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("canvas",{width:o.CONTAINER_WIDTH,height:o.CANVAS_HEIGHT,className:r.default.canvas,ref:u,onMouseDown:e=>{g(e,!0)},onMouseMove:e=>{h&&(e.stopPropagation(),e.preventDefault(),g(e))},onMouseUp:e=>{g(e,!1)}}),(0,c.jsx)("div",{className:r.default.cursor,style:{width:o.CURSOR_SIZE,height:o.CURSOR_SIZE,left:p.x,top:p.y,backgroundColor:t.toRgbaString()}})]})};var i=a(67294),s=a(33845),r=n(a(56347)),o=a(30905),l=a(39350),d=n(a(16297)),c=a(85893)},30905:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.THROTTLE_WAIT_TIME=t.DEFAULT_COLOR=t.CURSOR_SIZE=t.INPUT_HEIGHT=t.CANVAS_HEIGHT=t.CONTAINER_HEIGHT=t.CONTAINER_WIDTH=void 0;var n=a(33845);t.CONTAINER_WIDTH=334;t.CONTAINER_HEIGHT=203;const i=150.22;t.CANVAS_HEIGHT=i;t.INPUT_HEIGHT=52.78;t.CURSOR_SIZE=20;const s=new n.Color(210,252,86);t.DEFAULT_COLOR=s;t.THROTTLE_WAIT_TIME=900},87482:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{selectedColor:t,onColorSelect:a}=e,[n,c]=(0,i.useState)(null!=t?t:o.DEFAULT_COLOR),u=e=>{c(e)},h=e=>{a(e)};return(0,d.jsxs)("div",{className:l.default.container,style:{width:o.CONTAINER_WIDTH,height:o.CONTAINER_HEIGHT},children:[(0,d.jsx)(r.default,{color:n,onChangeCanvasColor:u,onChangeSelectedColor:h}),(0,d.jsx)(s.default,{color:n,onChangeColor:e=>{u(e),h(e)},onColorPickerClose:e.onColorPickerClose})]})};var i=a(67294),s=n(a(63097)),r=n(a(31557)),o=a(30905),l=n(a(58510)),d=a(85893)},96532:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.CropRotateToolbar=function({canReset:e,onRotateCanvas:t,onReset:a}){return(0,l.jsxs)(r.FlexRow,{className:s.default.container,children:[(0,l.jsx)(i.default,{className:s.default.rotateLeftButton,icon:"media-editor-rotate-left",title:o.default.t(1196),onClick:()=>t(-90)}),(0,l.jsx)(i.default,{icon:"media-editor-rotate-right",title:o.default.t(1197),onClick:()=>t(90)}),(0,l.jsx)(i.default,{onClick:a,disabled:!e,children:o.default.t(1187)})]})};var i=n(a(91420)),s=n(a(57775)),r=a(63290),o=n(a(2408)),l=a(85893)},64603:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.Font=void 0;var i=n(a(81109)),s=a(67294),r=n(a(91420)),o=a(63290),l=n(a(50918)),d=n(a(9079)),c=a(57528),u=a(63477),h=n(a(68062)),f=n(a(82669)),p=a(85893);function m(e,t){const{selectedFont:a,fonts:n,onFontSelect:i,onAlignmentSelect:o,selectedAlignment:m}=e,g=(0,s.useRef)(null),[C,_]=(0,s.useState)(null),x=()=>{_(null)},S=()=>Boolean(C);(0,s.useImperativeHandle)(t,(()=>({isMenuVisible:S})));const y=Boolean(C);let E;return C&&(E=(0,p.jsx)(u.UIE,{displayName:"MediaEditorFontDropdown",escapable:!0,popable:!0,requestDismiss:x,children:(0,p.jsx)(h.default,{contextMenu:C})})),(0,p.jsxs)("div",{ref:g,className:l.default.container,children:[(0,p.jsx)(r.default,{onClick:()=>{C||g.current&&_({menu:(0,p.jsx)(d.default,{fonts:n,selectedFont:a,selectedAlignment:m,onFontSelect:i,onAlignmentSelect:o}),anchor:g.current})},icon:(0,p.jsx)(v,{font:a}),selected:y,caret:y?"down":"up",children:(0,p.jsx)("span",{className:l.default.fontLabel,children:(0,c.getFontTranslation)(a)})}),(0,p.jsx)(f.default,{transitionName:"dropdown",children:E})]})}const g=(0,s.forwardRef)(m);function v({font:e}){return(0,p.jsx)(o.FlexRow,{className:l.default.icon,style:(0,i.default)({},(0,c.getFontStyle)(e)),justify:"center",align:"center",children:(0,p.jsx)("div",{"aria-hidden":"true",children:"A"})})}t.Font=g},9079:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{onFontSelect:t,onAlignmentSelect:a,selectedFont:n,selectedAlignment:p}=e;(0,s.useEffect)((()=>{d.default.loadAllFonts()}),[]);return(0,h.jsxs)("div",{children:[e.fonts.map((e=>{let a;n===e&&(a=(0,h.jsx)("span",{className:l.default.selected,children:(0,h.jsx)(u.default,{name:"checkmark",display:"inline"})}));const i=(0,c.getFontTranslation)(e);let s;switch(e){case c.FONTS.SANS_SERIF:s=l.default.sansSerif;break;case c.FONTS.SERIF:s=l.default.serif;break;case c.FONTS.NORICAN_REGULAR:s=l.default.noricanRegular;break;case c.FONTS.BRYNDAN_WRITE:s=l.default.bryndanWrite;break;case c.FONTS.OSWALD_HEAVY:s=l.default.oswaldHeavy}return(0,h.jsx)(r.DropdownItem,{action:a=>((e,a)=>{e.stopPropagation(),t(a)})(a,e),children:(0,h.jsxs)("div",{role:"button",className:l.default.item,style:(0,c.getFontStyle)(e),children:[(0,h.jsx)("span",{className:s,children:i}),a]})},e)})),(0,h.jsx)(o.FlexRow,{className:l.default.alignmentContainer,justify:"around",align:"center",children:f.map((({alignment:e,icon:t})=>(0,h.jsx)(o.FlexItem,{children:(0,h.jsx)(r.DropdownItem,{action:t=>((e,t)=>{e.stopPropagation(),a(t)})(t,e),children:(0,h.jsx)(u.default,{name:t,className:(0,i.default)(l.default.alignmentIcon,{[l.default.alignmentIconSelected]:e===p})})})},t)))},"alignment")]})};var i=n(a(94184)),s=a(67294),r=a(47452),o=a(63290),l=n(a(67024)),d=n(a(32397)),c=a(57528),u=n(a(2966)),h=a(85893);const f=[{alignment:c.TextAlignment.LEFT,icon:"align-left"},{alignment:c.TextAlignment.CENTER,icon:"align-center"},{alignment:c.TextAlignment.RIGHT,icon:"align-right"}]},35087:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function({selectedLayer:e,inPaintMode:t,inCropRotateMode:a,inTextEditingMode:n,inOutlineMode:_,canUndo:x,canRedo:S,onPaintSelect:y,onCropRotateSelect:E,onTextSelect:j,onEmojiSelect:I,onToggleEmojiPanel:T,onStickerSelect:b,onToggleStickerPanel:P,onOutlineSelect:M,onUndo:w,onRedo:L,showOutline:k}){const[O,A]=(0,i.useState)(),[D,R]=(0,i.useState)(),N=(0,i.useRef)({});N.current={inPaintMode:t,onEmojiSelect:I,onStickerSelect:b,onPaintSelect:y};const F=()=>{a?E():t?y():_&&M()},B=()=>{A(null),T(!1)},U=()=>{R(null),P(!1)};return(0,C.jsxs)(u.MenuBar,{theme:"media-editor",children:[k&&(0,C.jsx)(u.MenuBarItem,{icon:(0,C.jsx)(p.default,{name:"scissors"}),a8nText:"outline-button",title:c.default.t(1191),onClick:e=>{e.preventDefault(),_||F(),M()},selected:_},"outline"),(0,C.jsx)(u.MenuBarItem,{icon:(0,C.jsx)(p.default,{name:"media-editor-emoji"}),a8nText:"emoji-button",title:c.default.t(1190),onClick:e=>{e.preventDefault(),e.stopPropagation(),F();const t=(0,C.jsx)(r.EmojiPanel,{onEmoji:e=>{N.current.inPaintMode&&N.current.onPaintSelect(),N.current.onEmojiSelect(e),B()},onFocusNext:B,onFocusPrev:B});A({menu:t,dirY:s.DirY.TOP,type:"emoji_picker",anchor:e.target}),T(!0)},selected:Boolean(O)||e instanceof l.ImageLayer&&e.isEmoji()},"emoji"),(0,C.jsx)(u.MenuBarItem,{icon:(0,C.jsx)(p.default,{name:"media-editor-sticker"}),a8nText:"sticker-button",title:c.default.t(1198),onClick:e=>{e.preventDefault(),e.stopPropagation(),F();const t=e=>{N.current.inPaintMode&&N.current.onPaintSelect(),N.current.onStickerSelect(e),U()};let a;o.GK.supportsFeature(o.GK.F.MD_BACKEND)?h.ServerProps.webServerStickerPanel&&(a=(0,C.jsx)(d.default,{onSticker:t,onFocusNext:U,onFocusPrev:U})):a=(0,C.jsx)(f.default,{onSticker:t,onFocusNext:U,onFocusPrev:U}),a&&(R({menu:a,dirY:s.DirY.TOP,type:"sticker_picker",anchor:e.target}),P(!0))},selected:Boolean(D)||e instanceof l.ImageLayer&&e.isSticker()},"sticker"),(0,C.jsx)(u.MenuBarItem,{icon:(0,C.jsx)(p.default,{name:"media-editor-text"}),a8nText:"text-button",title:c.default.t(1199),onClick:e=>{e.preventDefault(),F(),j()},selected:n||e instanceof m.TextLayer},"text"),(0,C.jsx)(u.MenuBarItem,{icon:(0,C.jsx)(p.default,{name:"media-editor-drawing"}),a8nText:"paint-button",title:c.default.t(1194),onClick:e=>{e.preventDefault(),t||F(),y()},selected:t},"paint"),(0,C.jsx)(u.MenuBarItem,{icon:(0,C.jsx)(p.default,{name:"media-editor-crop-rotate"}),a8nText:"crop-rotate-button",title:c.default.t(1188),onClick:e=>{e.preventDefault(),a||F(),E()},selected:a},"crop-rotate"),(0,C.jsx)(u.MenuBarItem,{icon:(0,C.jsx)(p.default,{name:"media-editor-undo"}),a8nText:"undo-button",title:c.default.t(1200),disabled:!x,onClick:w},"undo"),(0,C.jsx)(u.MenuBarItem,{icon:(0,C.jsx)(p.default,{name:"media-editor-redo"}),a8nText:"redo-button",title:c.default.t(1195),disabled:!S,onClick:L},"redo"),D&&(0,C.jsx)(g.UIE,{displayName:"StickerPicker",escapable:!0,popable:!0,requestDismiss:U,children:(0,C.jsx)(v.default,{contextMenu:D})}),O&&(0,C.jsx)(g.UIE,{displayName:"EmojiPicker",escapable:!0,popable:!0,requestDismiss:B,children:(0,C.jsx)(v.default,{contextMenu:O})})]})};var i=a(67294),s=a(9492),r=a(91137),o=a(12950),l=a(85499),d=n(a(30023)),c=n(a(2408)),u=a(47941),h=a(65565),f=n(a(3754)),p=n(a(2966)),m=a(4301),g=a(63477),v=n(a(68062)),C=a(85893)},62866:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.OutlineToolbar=function({smoothing:e,onSmoothingToggle:t,canReset:a,onReset:n}){return(0,l.jsxs)(r.FlexRow,{children:[(0,l.jsx)(s.default,{className:(0,i.default)(d),icon:"outline-smooth",title:o.default.t(1192),selected:e,onClick:()=>t(!0)}),(0,l.jsx)(s.default,{className:(0,i.default)(d),icon:"outline-straight",title:o.default.t(1193),selected:!e,onClick:()=>t(!1)}),(0,l.jsx)(s.default,{className:(0,i.default)(d),onClick:n,disabled:!a,children:o.default.t(1187)})]})};var i=n(a(56720)),s=n(a(91420)),r=a(63290),o=n(a(2408)),l=a(85893);const d={marginTop:"tt8xd2xn",marginEnd:"bugiwsl0",marginBottom:"mpdn4nr2",marginStart:"fooq7fky"}},55154:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function({checked:e,onBackgroundToggle:t}){const a=(0,d.jsx)("div",{className:(0,i.default)(l.default.cirle,{[l.default.circleFilled]:e}),children:e?(0,d.jsx)("div",{className:l.default.checked,children:(0,d.jsx)(o.default,{name:"checkmark"})}):(0,d.jsx)("div",{className:l.default.unchecked})});return(0,d.jsx)(s.default,{icon:a,onClick:t,children:r.default.t(1178)})};var i=n(a(94184)),s=n(a(91420)),r=n(a(2408)),o=n(a(2966)),l=n(a(53964)),d=a(85893)},98417:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const t=e.thicknesses.map(((t,a)=>(0,o.jsx)(l,{thickness:t,onThicknessSelect:e.onThicknessSelect,selectedThickness:e.selectedThickness},a)));return(0,o.jsx)("div",{className:s.default.container,children:t})};var i=n(a(94184)),s=n(a(65251)),r=a(45139),o=a(85893);function l(e){return(0,o.jsx)("div",{onClick:()=>e.onThicknessSelect(e.thickness),className:(0,i.default)(s.default.thicknessButton,{[s.default.selected]:e.selectedThickness&&e.selectedThickness===e.thickness}),children:(0,o.jsx)("div",{className:s.default.thicknessChip,style:{height:(0,r.getThicknessValue)(e.thickness),width:(0,r.getThicknessValue)(e.thickness)}})},e.thickness.toString())}},39350:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getPositionFromColor=function(e){const t=e.toHsl(),a=n.CONTAINER_WIDTH*t.hue-n.CURSOR_SIZE/2,i=n.CANVAS_HEIGHT*(1-t.lightness)-n.CURSOR_SIZE/2;return{x:a,y:i}};var n=a(30905)},40302:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.getPointFromStage=function(e,t,a=!1){if(!t)return new i.default({x:0,y:0});const{x:n,y:s}=t.getAbsoluteScale(),r=t.content.getBoundingClientRect();let o=e.clientX-r.left,l=e.clientY-r.top;a&&(o=Math.min(Math.max(0,o),r.width),l=Math.min(Math.max(0,l),r.height));return new i.default({x:o/n,y:l/s})},t.getPointFromGroup=function(e){return new i.default({x:e.target.x()-e.target.offsetX(),y:e.target.y()-e.target.offsetY()})},t.getRotationFromGroup=function(e){return e.target.rotation()},t.getScaleFromGroup=function(e){return e.target.scaleX()},t.isEventOnAnchor=function(e){var t,a;return null!==(t=null===(a=e.target.attrs.name)||void 0===a?void 0:a.includes("anchor"))&&void 0!==t&&t},t.isStageCorner=function(e,t){if(!t)return!1;const{x:a,y:n}=t.getAbsoluteScale(),{width:i,height:s}=t.content.getBoundingClientRect();return 0===e.x&&0===e.y||0===e.x&&e.y===s/n||e.x===i/a&&0===e.y||e.x===i/a&&e.y===s/n};var i=n(a(7668))},47971:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"Circle",{enumerable:!0,get:function(){return n.Circle}}),Object.defineProperty(t,"Group",{enumerable:!0,get:function(){return n.Group}}),Object.defineProperty(t,"Image",{enumerable:!0,get:function(){return n.Image}}),Object.defineProperty(t,"Layer",{enumerable:!0,get:function(){return n.Layer}}),Object.defineProperty(t,"Line",{enumerable:!0,get:function(){return n.Line}}),Object.defineProperty(t,"Path",{enumerable:!0,get:function(){return n.Path}}),Object.defineProperty(t,"Rect",{enumerable:!0,get:function(){return n.Rect}}),Object.defineProperty(t,"Stage",{enumerable:!0,get:function(){return n.Stage}}),Object.defineProperty(t,"Text",{enumerable:!0,get:function(){return n.Text}}),Object.defineProperty(t,"Transformer",{enumerable:!0,get:function(){return n.Transformer}}),a(7643),a(71298),a(27149),a(87339),a(75244),a(23787),a(29516);var n=a(77201)},50240:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.calculateContainScale=function(e,t,a,n){if(0===e||0===t)return 1;if(!a.isEmpty()&&(e>a.width||t>a.height))return Math.min(a.width/e,a.height/t);if(!n.isEmpty()&&e<n.width&&t<n.height)return Math.min(n.width/e,n.height/t);return 1}},22011:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{labelId:t,onAddLabel:a,onUpdateLabel:n,onCancel:_}=e,x=(0,v.default)((()=>t?u.LabelCollection.assertGet(t):void 0)),[S,y]=(0,i.useState)((()=>{var e;return(null===(e=x.current)||void 0===e?void 0:e.color)||void 0})),[E,j]=(0,i.useState)((()=>{var e;return(null===(e=x.current)||void 0===e?void 0:e.name)||""})),[I,T]=(0,i.useState)(void 0),b=e=>{let t=!0,a=null;return e&&""!==e.trim()||(t=!1),x.current&&x.current.name===e||0===u.LabelCollection.where({name:e}).length||(t=!1,a=d.default.t(154)),{passed:t,error:a}};(0,i.useEffect)((()=>{a?(u.LabelCollection.getNewLabelColor().then((e=>{y(e||l.default.DEFAULT_SMB__NEW_LABEL_COLOR)})),(0,h.logLabelOperationEvent)(p.default.LABEL_OPERATIONS.VIEW,1,p.default.LABEL_TARGETS.ADD_LABEL_DIALOG)):n&&(0,h.logLabelOperationEvent)(p.default.LABEL_OPERATIONS.VIEW,1,p.default.LABEL_TARGETS.EDIT_LABEL_DIALOG)}),[]);const P=()=>{if(I)return;(0,h.logLabelOperationEvent)(p.default.LABEL_OPERATIONS.CLICK_POSITIVE,1,a?p.default.LABEL_TARGETS.ADD_LABEL_DIALOG:p.default.LABEL_TARGETS.EDIT_LABEL_DIALOG);const e=E&&E.trim(),i=b(e||"");i.passed?(t&&n?n({id:t,color:S,name:E},u.LABEL_PROPERTIES.NAME):a&&a(E||"",S),_?_():r.Cmd.closeModal()):T(i.error)},M=!b(E.trim()).passed;return(0,C.jsx)(o.default,{title:e.onUpdateLabel?d.default.t(758):d.default.t(157),okText:d.default.t(2192),onOK:P,okDisabled:M,onCancel:()=>{(0,h.logLabelOperationEvent)(p.default.LABEL_OPERATIONS.CLICK_NEGATIVE,1,a?p.default.LABEL_TARGETS.ADD_LABEL_DIALOG:p.default.LABEL_TARGETS.EDIT_LABEL_DIALOG),_?_():r.Cmd.closeModal()},children:(0,C.jsxs)("div",{className:s.default.inputContainer,children:[(0,C.jsx)("div",{className:s.default.label,children:S?(0,f.renderLabelSvg)((0,c.intColorToHex)(S)):(0,C.jsx)(m.Spinner,{stroke:5,size:20})}),(0,C.jsx)("div",{className:s.default.input,children:(0,C.jsx)(g.TextInput,{a8n:"add-new-label-name-input",focusOnMount:!0,hideFloatingLabel:!0,showRemaining:!0,supportsEmoji:!0,value:E,error:I,maxLength:l.default.SMB_LABELS.MAX_LABEL_LENGTH,onChange:e=>{const t=b(e);j(e),T(t.passed?void 0:t.error)},onEnter:e=>{e.stopPropagation(),P()},placeholder:d.default.t(156)})})]})})};var i=a(67294),s=n(a(84978)),r=a(69162),o=n(a(75940)),l=n(a(55454)),d=n(a(2408)),c=a(14137),u=a(59606),h=a(12735),f=a(84498),p=n(a(4231)),m=a(46714),g=a(29458),v=n(a(79939)),C=a(85893)},12716:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{product:t,sessionId:a}=e,[n,S]=(0,s.useState)(!1),[y,E]=(0,s.useState)(!1),[j,I]=(0,s.useState)(""),T=e=>{I(e)},b=()=>{(0,u.logAppealProductCatalogClick)(a),S(!0);let e=!0;p.QPL.markerStart(m.QuickLogMarkerId.WHATSAPP_PRODUCT_APPEAL),(0,h.appealProduct)(t.id.toString(),j).then((()=>{t.canAppeal=!1,t.reviewStatus=f.PRODUCT_REVIEW_STATUS.PENDING,(0,u.logAppealProductCatalogSuccess)(a),S(!1),E(!0),e=!1,p.QPL.markerEnd(m.QuickLogMarkerId.WHATSAPP_PRODUCT_APPEAL,p.QuickLogActionType.SUCCESS)})).catch((0,i.filteredCatch)(_.ServerStatusCodeError,(e=>{r.Cmd.openToast((0,x.jsx)(C.Toast,{msg:c.default.t(441),id:(0,C.genId)("catalog_appeal_submission_failed")})),(0,u.logAppealProductCatalogFailed)(a,e.status),S(!1)}))).finally((()=>{e&&p.QPL.markerEnd(m.QuickLogMarkerId.WHATSAPP_PRODUCT_APPEAL,p.QuickLogActionType.FAIL)}))},P=()=>{r.Cmd.closeModal()};return y?(0,x.jsx)(o.default,{title:c.default.t(1599),onOK:P,children:(0,x.jsx)(g.TextDiv,{children:c.default.t(472)})}):(0,x.jsx)(o.default,{title:c.default.t(1599),onOK:b,onCancel:P,okDisabled:n,children:(0,x.jsxs)("form",{children:[(0,x.jsx)(v.TextInput,{a8n:"confirm-popup-text-input",placeholder:c.default.t(1087),onChange:T,value:j,maxLength:1e3}),(0,x.jsx)(d.ExternalLink,{href:l.default.WA_COMMERCE_POLICY_URL,children:c.default.t(1091)})]})})};var i=a(61295),s=a(67294),r=a(69162),o=n(a(75940)),l=n(a(55454)),d=a(4919),c=n(a(2408)),u=a(30333),h=a(68793),f=a(26491),p=a(21125),m=a(71578),g=a(97504),v=a(29458),C=a(49201),_=a(12825),x=a(85893)},59732:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function({mimeType:e,url:t}){return(0,s.jsx)("div",{className:i.default.container,"data-animate-attach-media":!0,children:(0,s.jsx)("div",{className:i.default.media,children:(0,s.jsx)("audio",{controls:!0,type:e,src:t})})})};var i=n(a(46771)),s=a(85893)},12048:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function({mimeType:e,filename:t}){var a,n;const l=(0,i.default)(s.default.icon,null!==(a=null===(n=r.DOCUMENT_MIMETYPES[e])||void 0===n?void 0:n.icon)&&void 0!==a?a:"icon-doc-generic");return(0,o.jsx)("div",{className:s.default.container,"data-animate-attach-media":!0,children:(0,o.jsx)("div",{className:s.default.media,children:(0,o.jsxs)("div",{className:s.default.document,children:[(0,o.jsx)("div",{className:l}),(0,o.jsx)("div",{className:s.default.text,children:t})]})})})};var i=n(a(94184)),s=n(a(56342)),r=a(38961),o=a(85893)},51427:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function({mimeType:e,url:t,isGif:a,size:n,processing:s,preview:d}){let m;switch(p[e].msgType){case"image":m=(0,f.jsx)("img",{alt:l.default.t(2246),src:t,className:o.default.img});break;case"video":const n=a?{loop:!s,autoPlay:!s,muted:!1,controls:!1}:{},c=s?(0,f.jsx)("div",{className:o.default.spinner,children:(0,f.jsx)(u.Spinner,{color:u.colorOptions.white,size:50,stroke:3})}):null,p=d?(0,f.jsx)("img",{alt:l.default.t(2246),className:o.default.staticPreview,src:`data:image/jpeg;base64,${d}`}):null,g=s?null:(0,f.jsx)(h.default,(0,i.default)((0,i.default)({controls:!0,controlsList:"nodownload nofullscreen",className:o.default.video},n),{},{src:t}));m=(0,f.jsxs)("div",{className:(0,r.default)(o.default.img,o.default.videoContainer),children:[c,g,p]});break;case"audio":m=(0,f.jsx)("audio",{controls:!0,className:o.default.audio,type:e,src:t})}return(0,f.jsx)("div",{className:o.default.container,"data-animate-attach-media":!0,children:(0,f.jsx)("div",{className:o.default.media,children:(0,f.jsx)(c.default,{type:"scaleDown",size:n,children:m})})})};var i=n(a(81109)),s=n(a(35937)),r=n(a(94184)),o=n(a(13149)),l=n(a(2408)),d=a(38961),c=n(a(90904)),u=a(46714),h=n(a(92018)),f=a(85893);const p=(0,s.default)(d.MIMETYPES,(e=>"image"===(null==e?void 0:e.msgType)||"video"===(null==e?void 0:e.msgType)))},12218:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function({fullPreview:e,fullPreviewSize:t,pageCount:a,mimeType:n,filename:c,showPageCount:u=!0,showBorder:h=!1}){if(e&&t&&null!=a&&a>0){const n=o.default.t(182,{count:a,_plural:a});return(0,d.jsxs)("div",{className:r.default.container,"data-js-attach-preview":!0,children:[(0,d.jsx)("div",{className:r.default.preview,children:(0,d.jsx)(l.default,{type:"scaleDown",size:t,children:(0,d.jsx)("img",{alt:o.default.t(2246),src:e,className:(0,i.default)(r.default.img,{[r.default.imgBorder]:h})})})}),u&&(0,d.jsx)("div",{className:r.default.caption,children:n})]})}return(0,d.jsx)(s.default,{mimeType:n,filename:c})};var i=n(a(94184)),s=n(a(12048)),r=n(a(28469)),o=n(a(2408)),l=n(a(90904)),d=a(85893)},73895:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function({disabled:e,isOn:t,mediaType:a,onChange:n,noMargin:C}){const[_,x]=(0,s.useState)((0,c.shouldShowNUX)(d.default.NUX.EPHEMERAL_VIEW_ONCE));return(0,s.useEffect)((()=>{if(!t)return;if(_){const e=(0,g.jsx)(o.default,{onOkClick:()=>{x(!1),l.Cmd.closeModal()}});return void l.Cmd.openModal(e)}const e=a===h.TYPE.VIDEO?u.default.t(1872):u.default.t(1869),n=(0,g.jsx)(p.Toast,{msg:e,id:(0,p.genId)("view-once-toast")});return l.Cmd.openToast(n),()=>{l.Cmd.closeToast(n)}}),[_,a,t]),(0,g.jsx)(m.default,{a8nText:r.default.key("view-once-toggle"),xstyle:[v.btnViewOnce,C&&v.btnNoMargin,e&&v.btnDisabled],disabled:e,onClick:()=>n(!t),"aria-pressed":t,children:(0,g.jsx)(f.default,{"aria-label":t?i.fbt._("Turn off view once",null,{hk:"3cl8Dn"}):i.fbt._("Turn on view once",null,{hk:"3pd2lD"}),name:t?"view-once-media-select-on":"view-once-media-select",height:26,width:26})})};var i=a(48360),s=a(67294),r=(n(a(56720)),n(a(76610))),o=n(a(41011)),l=a(69162),d=n(a(55454)),c=a(86723),u=n(a(2408)),h=a(92954),f=n(a(2966)),p=a(49201),m=n(a(89135)),g=a(85893);const v={btnViewOnce:{display:"f804f6gw",marginTop:"c46o30wg",marginEnd:"bugiwsl0",marginStart:"eab7llgz",color:"svlsagor"},btnNoMargin:{marginTop:"tt8xd2xn",marginEnd:"jnwc1y2a",marginBottom:"mpdn4nr2",marginStart:"svoq16ka"},btnDisabled:{cursor:"h2qzpyga",opacity:"notw83rv"}}},41011:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{onOkClick:t}=e;return(0,i.useEffect)((()=>()=>{(0,u.setNUX)(o.default.NUX.EPHEMERAL_VIEW_ONCE,{views:1,maxViews:1})}),[]),(0,m.jsx)(r.default,{onOK:t,cancelText:h.default.t(1091),onCancel:()=>{(0,l.openExternalLink)((0,d.getViewOnceFaqUrl)())},children:(0,m.jsxs)(c.FlexColumn,{children:[(0,m.jsx)(c.FlexItem,{xstyle:g.graphic,align:"center",children:(0,m.jsx)(f.default,{name:"view-once-sender-nux",width:195,height:177})}),(0,m.jsx)(p.TextHeader,{className:(0,s.default)(g.text),theme:"popup-title",children:h.default.t(1867)}),(0,m.jsx)(p.TextParagraph,{className:(0,s.default)(g.text),color:"secondary",children:h.default.t(1866)})]})})};var i=a(67294),s=n(a(56720)),r=n(a(75940)),o=n(a(55454)),l=a(4919),d=a(57092),c=a(63290),u=a(86723),h=n(a(2408)),f=n(a(2966)),p=a(97504),m=a(85893);const g={text:{marginBottom:"or9x5nie"},graphic:{marginBottom:"t4zgqcuo"}}},92508:(e,t,a)=>{"use strict";var n=a(95318),i=a(20862);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){const[e,t]=(0,s.useState)(r.getAutoDownloadPhotos),[a,n]=(0,s.useState)(r.getAutoDownloadAudio),[i,u]=(0,s.useState)(r.getAutoDownloadVideos),[h,f]=(0,s.useState)(r.getAutoDownloadDocuments);return(0,c.jsxs)(l.SettingsCheckList,{children:[(0,c.jsx)(l.SettingsCheckListItem,{a8nText:"option-photos",id:"photos",checked:e,onChange:()=>t((e=>{const t=!e;return r.setAutoDownloadPhotos(t),t})),children:o.default.t(1414)}),(0,c.jsx)(l.SettingsCheckListItem,{a8nText:"option-audio",id:"audio",checked:a,onChange:()=>n((e=>{const t=!e;return r.setAutoDownloadAudio(t),t})),children:o.default.t(1403)}),(0,c.jsx)(l.SettingsCheckListItem,{a8nText:"option-videos",id:"videos",checked:i,onChange:()=>u((e=>{const t=!e;return r.setAutoDownloadVideos(t),t})),children:o.default.t(1416)}),(0,c.jsx)(l.SettingsCheckListItem,{a8nText:"option-documents",id:"documents",checked:h,onChange:()=>f((e=>{const t=!e;return r.setAutoDownloadDocuments(t),t})),children:o.default.t(1407)}),(0,c.jsx)(l.SettingsCheckListSection,{children:(0,c.jsx)(d.TextDiv,{theme:"muted",children:o.default.t(1176)})})]})};var s=a(67294),r=i(a(86723)),o=n(a(2408)),l=a(31051),d=a(97504),c=a(85893)},33322:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a(51463)),s=a(67294),r=n(a(76610)),o=a(38512),l=n(a(53939)),d=a(15701),c=a(69162),u=n(a(75940)),h=a(70521),f=a(17025),p=n(a(18260)),m=n(a(17747)),g=n(a(9042)),v=n(a(17061)),C=a(55588),_=a(92231),x=a(86025),S=n(a(19257)),y=n(a(67893)),E=n(a(2408)),j=a(71681),I=n(a(2966)),T=a(85893);class b extends s.Component{constructor(...e){super(...e),this.flatListController=new y.default,this._handleBlockConfirm=e=>{(0,o.blockContact)(e).catch((()=>{})),c.Cmd.closeModal()},this.handleBlock=()=>{c.Cmd.openModal((0,T.jsx)(p.default,{title:E.default.t(147),filter:function(e){return!!f.ContactCollection.isFilteredContact(e)&&(!d.BlocklistCollection.get(e.id)||E.default.t(1448))},onCancel:()=>c.Cmd.closeModal(),onSelect:(0,i.default)(this._handleBlockConfirm)}))},this._handleUnblockConfirm=e=>{(0,o.unblockContact)(e).catch((()=>{})),c.Cmd.closeModal()},this._handleUnblockCancel=()=>{c.Cmd.closeModal()},this._handleUnblock=(e,t)=>{c.Cmd.openModal((0,T.jsx)(u.default,{okText:E.default.t(1789),onOK:this._handleUnblockConfirm.bind(this,t),cancelText:E.default.t(1999),onCancel:this._handleUnblockCancel,children:E.default.t(1790,{contact:t.formattedName})}))},this.renderItem=e=>{const{blocklist:t}=e,a=t.contact();return(0,T.jsx)(h.Contact,{contact:a,onClick:this._handleUnblock,onDelete:this._handleUnblock,waitIdle:!0},a.id.toString())}}componentDidMount(){this.props.listeners.add(d.BlocklistCollection,"add remove",(()=>{this.forceUpdate()}))}getData(){return d.BlocklistCollection.map((e=>({itemKey:e.id.toString(),blocklist:e})))}render(){let e,t;return d.BlocklistCollection.length>0?(e=(0,T.jsx)(S.default,{flatListControllers:[this.flatListController],className:l.default.list,children:(0,T.jsx)(x.FlatList,{flatListController:this.flatListController,direction:"vertical",data:this.getData(),renderItem:this.renderItem})}),t=(0,T.jsx)("div",{"data-a8n":r.default.key("blocked-description"),className:l.default.hint,children:E.default.t(146)})):e=(0,T.jsx)(_.Blocked,{}),(0,T.jsxs)(m.default,{children:[(0,T.jsx)(C.DrawerHeader,{title:E.default.t(241),onBack:this.props.onClose,type:C.DRAWER_HEADER_TYPE.LARGE}),(0,T.jsx)("div",{className:l.default.button,children:(0,T.jsx)(v.default,{a8nText:"li-add-blocked",onClick:this.handleBlock,icon:(0,T.jsx)(I.default,{name:"add-user",directional:!0}),children:E.default.t(147)})}),(0,T.jsxs)(g.default,{children:[e,t]})]})}}b.displayName="BlockedDrawer";var P=(0,j.ListenerHOC)(b);t.default=P},95103:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(69162),s=a(10504),r=n(a(75940)),o=n(a(2408)),l=a(85893);var d=()=>{i.Cmd.openModal((0,l.jsx)(r.default,{okText:o.default.t(2192),onOK:()=>i.Cmd.closeModal(),children:(0,l.jsx)(s.ComplianceInfoHelpCenterBanner,{})}))};t.default=d},22882:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(69162),s=n(a(75940)),r=n(a(2408)),o=a(85893);var l=e=>{i.Cmd.openModal((0,o.jsx)(s.default,{title:r.default.t(314),okText:r.default.t(2192),onOK:()=>{null==e||e(),i.Cmd.closeModal()},cancelText:r.default.t(311),onCancel:()=>i.Cmd.closeModal(),children:(0,o.jsxs)(o.Fragment,{children:[r.default.t(312),(0,o.jsx)("br",{}),(0,o.jsx)("br",{}),r.default.t(313)]})}))};t.default=l},66578:(e,t,a)=>{"use strict";var n=a(20862),i=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=a(61295),r=i(a(48158)),o=a(58695),l=i(a(94184)),d=a(67294),c=i(a(62202)),u=i(a(73895)),h=a(20519),f=i(a(55386)),p=a(69162),m=i(a(55454)),g=i(a(17747)),v=i(a(9042)),C=a(55588),_=n(a(13540)),x=a(57085),S=a(47683),y=i(a(2408)),E=a(89537),j=i(a(84627)),I=n(a(10214)),T=i(a(92235)),b=i(a(4231)),P=i(a(90904)),M=i(a(52937)),w=a(3132),L=a(65565),k=a(46714),O=i(a(2966)),A=a(1458),D=i(a(79939)),R=i(a(82669)),N=i(a(92018)),F=a(85893);const B="ANIMATING",U="LOADING",H="RECORDING",G="SENDING";function V(e,t){const{chat:a,disposeStream:n,onCaptured:i,onBack:V,onSend:W}=e,z=(0,d.useRef)(null),K=(0,d.useRef)(null),q=(0,d.useRef)(null),Y=(0,d.useRef)(null),Q=(0,d.useRef)(null),[X,Z]=(0,d.useState)(void 0),[$,J]=(0,d.useState)(void 0),[ee,te]=(0,d.useState)(!1),[ae,ne]=(0,d.useState)(void 0),[ie,se]=(0,d.useState)(B),[re,oe]=(0,d.useState)(void 0),le=(e,t)=>{var a;e?(null===(a=K.current)||void 0===a||a.call(K),K.current=t,se(U),oe(e),(0,I.isSrcObjectInVideoElement)()||(e?(window.URL.revokeObjectURL(q.current),q.current=window.URL.createObjectURL(e)):(window.URL.revokeObjectURL(q.current),q.current=void 0))):ie===B&&se(U)},de=(0,D.default)((()=>new o.ShiftTimer((({stream:e,disposeStream:t})=>{le(e,t)})))),ce=(0,D.default)((()=>new o.ShiftTimer((({stream:e,disposeStream:t})=>{var a;e&&t&&(null===(a=K.current)||void 0===a||a.call(K));(0,I.isSrcObjectInVideoElement)()||(q.current=window.URL.revokeObjectURL(q.current))})))),ue=()=>{a&&a.setAttachMediaContents(null)};(0,d.useEffect)((()=>(de.current.onOrBefore(300,{stream:e.stream,disposeStream:e.disposeStream}),()=>{de.current.cancel(),q.current&&window.URL.revokeObjectURL(q.current),null==n||n(),z.current&&z.current.logCancel(),ue()})),[]);const he=(e,t)=>{de.current.forceRunNow({stream:e,disposeStream:t})};(0,d.useImperativeHandle)(t,(()=>({loadNewStreamTimerUpdate:he,loadNewStream:le})));const fe=()=>{var e;const t=null===(e=Q.current)||void 0===e?void 0:e.underlyingVideo();if(!t)return;const s=document.createElement("canvas");s.height=t.videoHeight,s.width=t.videoWidth;const o=s.getContext("2d");if(o)if(o.translate(s.width,0),o.scale(-1,1),o.drawImage(t,0,0,t.videoWidth,t.videoHeight),i)(0,h.canvasToBlob)(s).then((e=>{i(e)}));else{ce.current.onOrBefore(500,{stream:re,disposeStream:n});const e=new E.MediaPickerStatsLogger;e.logAdd("CAPTURE_MEDIA","image",b.default.MEDIA_PICKER_ORIGIN_TYPE.MENU_CAMERA_CAPTURE),e.chatRecipients=(null==a?void 0:a.groupMetadata)?a.groupMetadata.participants.length:1,z.current=e;const t=s.toDataURL("image/jpeg"),i=window.dataURLtoBlob(t);if(a){a.attachMediaContents||a.setAttachMediaContents(new c.default({chatParticipantCount:a.getParticipantCount()}));(0,r.default)(a.attachMediaContents,"chat.attachMediaContents").processAttachments([{file:(0,x.createFile)([i],"",{type:"image/jpeg"})}])}J(t),se(G),oe(void 0)}else __LOG__(3)`CaptureDrawer:onCapture can not get 2d context`},pe=e=>{se(H),ne({width:e.videoWidth,height:e.videoHeight})},me=()=>{Z(void 0),se(U),ue();const{asyncStream:e,disposeStream:t}=I.start("camera");K.current=t,e.then((e=>{e&&((0,I.isSrcObjectInVideoElement)()||(q.current=window.URL.createObjectURL(e)),oe(e))})).catch((0,s.filteredCatch)(_.GUM.NotAllowedError,(()=>{V(),p.Cmd.openModal((0,F.jsx)(S.GuidePopup,{messaging:S.Messaging.CAMERA_FAIL,type:S.TYPE.GUIDE_UNBLOCK}))}))).catch((0,s.filteredCatch)(_.GUM.GUMError,(()=>{V(),p.Cmd.openModal((0,F.jsx)(S.GuidePopup,{messaging:S.Messaging.CAMERA_MISSING,type:S.TYPE.GUIDE_NONE}))})))},ge=()=>{let e=X;if(W)if($){var t,a;const n=null===(t=Y.current)||void 0===t?void 0:t.refInput;let i=[];if(X&&n){const t=n.serialize(X),[a,s]=[t[0].trim(),t[1]];a.length&&(e=a,i=s.mentionedJidList||[])}W({caption:e,getImg:M.default.createFromBase64Jpeg(A.URL.parseDataURL($).data),isViewOnce:ee,mentionedJidList:i}),null===(a=z.current)||void 0===a||a.logSend()}else __LOG__(4,void 0,new Error,!0)`Assertion failed!`,SEND_LOGS("capture-drawer-no-img");else __LOG__(4,void 0,new Error,!0)`Assertion failed!`,SEND_LOGS("capture-drawer-no-onSend")},ve=e=>{Z(e)},Ce=()=>{const e=null==a?void 0:a.contact.isEnterprise;return L.ServerProps.viewOnceWrite&&!e},_e=e=>{te(e)},xe=(e,t={})=>{const{isViewOnce:a}=t;if(W)if(0===e.length)__LOG__(4,void 0,new Error,!0)`Assertion failed!`,SEND_LOGS("capture-drawer-no-img");else{const{media:t,mentionedJidList:s}=(0,r.default)(e[0],"medias[0]"),o=t.file;var n,i;if(o instanceof Blob)W({getImg:M.default.createFromData(o,o.type),caption:null!==(n=t.caption)&&void 0!==n?n:void 0,isViewOnce:a,mentionedJidList:s}),null===(i=z.current)||void 0===i||i.logSend();ue()}else __LOG__(4,void 0,new Error,!0)`Assertion failed!`,SEND_LOGS("capture-drawer-no-onSend")};let Se,ye,Ee,je,Ie;const Te="capture-cover"===e.theme?"cover":"contain";switch(ie){case B:case U:if(Ie=(0,F.jsx)(k.Spinner,{stroke:4,size:50}),ie===B)break;case H:const t=(0,l.default)(f.default.video,{[f.default.videoInactive]:re&&ie===U}),n=re?(0,F.jsx)(N.default,{autoPlay:!0,ref:Q,onPlay:pe,src:q.current?q.current:void 0,srcObject:q.current?void 0:re}):null;Ee=re?(0,F.jsx)("div",{children:(0,F.jsx)(P.default,{type:Te,size:ae,children:(0,F.jsx)("div",{className:t,"data-animage-capture-webcam":!0,children:n})})},"webcam"):null,Se=ie===H?(0,F.jsx)("div",{className:f.default.btn,children:(0,F.jsx)(w.Round,{large:!0,onClick:fe,children:(0,F.jsx)(O.default,{name:"camera"})})},"btn-capture"):null;break;case G:if(Ee=(0,F.jsx)(P.default,{type:Te,size:ae,children:(0,F.jsx)("img",{alt:"",className:f.default.image,"data-animate-capture-snapshot":!0,src:$})}),a){const e=(0,r.default)(a.attachMediaContents,"chat.attachMediaContents");Ee=(0,F.jsx)(T.default,{theme:"capture",chat:a,initCaption:null,mediaCollection:e,onDropText:()=>{},onSendMedia:xe})}Se=(0,F.jsx)("div",{className:(0,l.default)(f.default.btn,f.default.btnSend),children:(0,F.jsx)(w.Round,{large:!0,onClick:ge,children:(0,F.jsx)(O.default,{name:"send",directional:!0})})},"btn-send"),ye=(0,F.jsxs)("div",{className:f.default.retakeBtn,onClick:me,children:[(0,F.jsx)("div",{className:f.default.retakeIcon,children:(0,F.jsx)(O.default,{name:"return"})}),y.default.t(1601)]}),je=e.chat?(0,F.jsxs)("div",{className:f.default.captionInput,children:[(0,F.jsx)(j.default,{ref:Y,chat:e.chat,maxLength:m.default.MAX_CAPTION_LENGTH,multiline:!0,onEnter:ge,onChange:ve,placeholder:y.default.t(145),showRemaining:!0,spellCheck:!0,supportsEmoji:!0,value:X}),L.ServerProps.viewOnceWrite?(0,F.jsx)(u.default,{disabled:!Ce(),isOn:ee,mediaType:"image",onChange:_e}):null]}):null;break;default:__LOG__(2)`captureDrawer:render Unhandled video capture state ${ie}`}const be=e.caption?(0,F.jsx)(R.default,{transitionName:"media-caption",className:f.default.caption,children:je}):null;let Pe=(0,F.jsxs)("div",{className:f.default.footer,children:[be,(0,F.jsx)(R.default,{transitionName:"pop_delay",children:Se})]});return ie===G&&(Pe=null),(0,F.jsxs)(g.default,{theme:e.theme,children:[(0,F.jsx)(C.DrawerHeader,{title:y.default.t(1762),type:C.DRAWER_HEADER_TYPE.OFFSET,onCancel:e.onBack,children:ye}),(0,F.jsxs)(v.default,{overflow:"hidden",children:[(0,F.jsxs)("div",{className:f.default.container,children:[Ie,(0,F.jsx)("div",{className:f.default.body,children:(0,F.jsx)(R.default,{transitionName:"capture",className:f.default.videoContainer,children:Ee})})]}),Pe]})]},"attach-capture-modal")}V.defaultProps={caption:!1};var W=(0,d.forwardRef)(V);t.default=W},52349:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,l.jsx)("div",{className:(0,i.default)(d.container),children:(0,l.jsx)(o.FlexRow,{align:"start",justify:"start",wrap:"wrap",children:e.categories.map((t=>(0,l.jsx)(r.default,{"aria-label":s.fbt._("Unselect category",null,{hk:"2Swokr"}),onClick:()=>e.onRemoveItem(t.id),label:t.localized_display_name,postfixIcon:"round-x-inv",xstyle:d.chip},t.id.toString())))})})};var i=n(a(94184)),s=a(48360),r=(n(a(56720)),n(a(70775))),o=a(63290),l=a(85893);const d={container:{paddingTop:"b7n2qyd4",paddingEnd:"iffbo4e8",paddingBottom:"s8gyl5p1",paddingStart:"khscay3k",backgroundColor:"sjyhwr5o",borderTop:"dl47i6rc"},chip:{marginTop:"dj1c3cmq",marginEnd:"bugiwsl0",marginBottom:"mpdn4nr2",marginStart:"svoq16ka"}}},18670:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(67294),s=n(a(53407)),r=n(a(55092)),o=a(17025),l=n(a(71889)),d=n(a(13531)),c=n(a(17747)),u=n(a(9042)),h=a(55588),f=a(92231),p=n(a(67893)),m=n(a(40854)),g=n(a(47193)),v=a(78615),C=a(39e3),_=n(a(2408)),x=n(a(55325)),S=n(a(70422)),y=n(a(80091)),E=n(a(2966)),j=n(a(38853)),I=a(85893);var T=(0,i.forwardRef)(((e,t)=>{const{title:a,onBack:n,onClick:T,onNewGroup:b,onNewCommunity:P}=e,[M,w]=(0,i.useState)(""),L=(0,i.useRef)(),k=(0,i.useRef)(),O=(0,i.useRef)(),A=(0,i.useMemo)((()=>o.ContactCollection.frequentContacts("message")),[o.ContactCollection.length]),D=Boolean(M),R=(0,i.useMemo)((()=>D?[]:A),[D,A]),[N]=(0,i.useState)((()=>new p.default)),F=(0,i.useCallback)((e=>{o.ContactCollection.ensureSorted();const t="string"==typeof e?e:M;if(!t)return o.ContactCollection.getFilteredContacts();const a=o.ContactCollection.getFilteredContacts().concat(o.ContactCollection.filter((e=>e.name&&!e.isMe&&!e.isPSA&&!e.isWAContact))),n=_.default.accentFold(t),i=(0,S.default)(n);return a.filter((function(e){return e.searchMatch(n,i)}))}),[M]);(0,i.useEffect)((()=>{g.default.focus(L.current)}),[]);const B=(0,i.useCallback)((()=>{m.default.shouldIndicateFocus(),g.default.focus(L.current)}),[]),U=(0,i.useCallback)((e=>{const t=k.current;null!=t&&(e.preventDefault(),e.stopPropagation(),m.default.shouldIndicateFocus(),t.focusFirst())}),[]),H=(0,j.default)((e=>w(e)),100),G=(0,i.useCallback)((e=>{O.current=e,H(e)}),[H]),V=(0,i.useCallback)((e=>{e.preventDefault(),e.stopPropagation();const t=R[0];if(t)return m.default.shouldIndicateFocus(),void T(e,t);const a=F(O.current)[0];a&&(m.default.shouldIndicateFocus(),T(e,a))}),[T,F,R]);let W,z,K;const q=F();if(W=0===q.length?M?(0,f.SearchWithKeyword)(M):(0,f.SearchWithoutKeyword)():(0,I.jsx)(d.default,{ref:k,contacts:q,flatListController:N,frequentContacts:R,onClick:T,onFocusSearch:B,showPersonGroupDivisionHeader:!!M}),!M){const e=(0,I.jsx)(y.default,{children:(0,I.jsx)(E.default,{name:"new-group",directional:!0})});z=(0,I.jsx)("div",{"data-list-scroll-offset":!0,children:(0,I.jsxs)("div",{className:l.default.newGroupButton,children:[(0,I.jsx)(r.default,{image:e,primary:_.default.t(2172),onClick:b}),(0,I.jsx)(s.default,{})]})}),K=(0,v.communitiesEnabled)()?(0,I.jsx)("div",{"data-list-scroll-offset":!0,children:(0,I.jsxs)("div",{className:l.default.newGroupButton,children:[(0,I.jsx)(r.default,{image:e,primary:_.default.t(1361),onClick:P}),(0,I.jsx)(s.default,{})]})}):null}return(0,I.jsxs)(c.default,{ref:t,children:[(0,I.jsx)(h.DrawerHeader,{title:a,type:h.DRAWER_HEADER_TYPE.LARGE,onBack:n}),(0,I.jsx)(C.HotKeys,{handlers:{down:U},children:(0,I.jsx)(x.default,{ref:L,onSearch:G,onEnter:V,placeholder:_.default.t(1617)})}),(0,I.jsxs)(u.default,{flatListControllers:[N],children:[z,K,W]})]},"contact-modal")}));t.default=T},79353:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(67294),s=n(a(94822)),r=a(69162),o=n(a(55454)),l=n(a(62069)),d=n(a(13550)),c=n(a(17747)),u=n(a(9042)),h=a(55588),f=n(a(25061)),p=a(78615),m=n(a(52087)),g=n(a(45530)),v=n(a(2408)),C=a(71681),_=a(51435),x=n(a(4231)),S=a(45472),y=a(57636),E=n(a(95005)),j=n(a(69704)),I=a(65565),T=a(46714),b=n(a(79485)),P=n(a(2966)),M=a(49201),w=n(a(27988)),L=a(61211),k=a(85893);class O extends i.Component{constructor(e){super(e),this.setRefScrollable=e=>{this.refScrollable=e},this.state={msgInfo:void 0,unimplemented:!1},this._refWrapper=(0,i.createRef)(),this.isMsgVisible=(e,t=!1)=>e===this.props.msg.id&&(!!t||this.getMsgComponent()),this.handleClose=()=>{this.props.uim.uie.requestDismiss()},this._uiActionEvent=new x.default.UiAction({uiActionType:x.default.UI_ACTION_TYPE.MSG_INFO_OPEN,uiActionPreloaded:!0})}componentDidMount(){var e;y.MsgInfoCollection.find(this.props.msg.id).then((e=>{this.props.getUnmountSignal().aborted||(this.setState({msgInfo:e}),this.props.listeners.add(e.played,"add remove",(()=>{this.forceUpdate()})),this.props.listeners.add(e.read,"add remove",(()=>{this.forceUpdate()})),this.props.listeners.add(e.delivery,"add remove",(()=>{this.forceUpdate()})))})).catch((()=>{this.setState({unimplemented:!0}),r.Cmd.openToast((0,k.jsx)(M.Toast,{msg:v.default.t(1268),id:(0,M.genId)("msg_info_failed")}))}));const t=null===(e=this.refScrollable)||void 0===e?void 0:e.container;this.props.msg.type===o.default.MSG_TYPE.IMAGE&&t&&(t.scrollTop=t.scrollHeight),this.props.listeners.add(this.props.msg,"remove",((e,t)=>{t===S.MsgCollection&&this.props.uim.uie.requestDismiss()}));const a=this._uiActionEvent;a&&(a.markUiActionT(),a.commit(),this._uiActionEvent=void 0)}getMsgComponent(){var e;return null===(e=this._refWrapper.current)||void 0===e?void 0:e.getMsgComponentRef()}render(){const{msg:e}=this.props,{msgInfo:t,unimplemented:a}=this.state;let n,i,r;if(t){var m,C,x;const a=[];let s,r,c;const u=e.type===o.default.MSG_TYPE.PTT;var S;if(u||e.isViewOnce)i=u?v.default.t(1241):v.default.t(1243),s=t.played.head(),r=null===(S=s)||void 0===S?void 0:S.t,c=(0,k.jsx)("span",{className:d.default.icon,children:(0,k.jsx)(P.default,{name:u?"status-ptt":"view-once-viewed",className:d.default.statusBlue})}),a.push((0,k.jsx)(l.default,{title:u?v.default.t(1236):v.default.t(1245),t:r,icon:c},"played"));s=t.read.head(),r=null===(m=s)||void 0===m?void 0:m.t,c=(0,k.jsx)("span",{className:d.default.icon,children:(0,k.jsx)(P.default,{name:"status-dblcheck",className:d.default.ack})}),i=null!==(C=i)&&void 0!==C?C:v.default.t(1238),a.push((0,k.jsx)(l.default,{title:i,t:r,icon:c},"read")),s=t.delivery.head(),r=null===(x=s)||void 0===x?void 0:x.t,c=(0,k.jsx)("span",{className:d.default.icon,children:(0,k.jsx)(P.default,{name:"status-dblcheck"})}),a.push((0,k.jsx)(l.default,{title:v.default.t(1234),t:r,icon:c},"delivery")),!I.ServerProps.hfmStringChanges&&e.numTimesForwarded>0&&!e.isFrequentlyForwarded&&a.push((0,k.jsx)(E.default,{msg:e},"forward")),n=(0,k.jsx)(f.default,{theme:"padding",children:a})}t||a||(r=(0,k.jsx)("div",{className:d.default.spinner,children:(0,k.jsx)(T.Spinner,{size:50,stroke:4})},"spinner"));let y=null;return e.labels&&e.labels.length>0&&(0,p.canDisplayLabel)()&&(y=(0,k.jsx)(f.default,{theme:"padding",children:(0,k.jsx)(g.default,{labels:e.labels})})),(0,k.jsxs)(c.default,{theme:"striped",children:[(0,k.jsx)(h.DrawerHeader,{title:v.default.t(1233),type:h.DRAWER_HEADER_TYPE.SMALL,onCancel:this.handleClose}),(0,k.jsx)(j.default,{ref:this.setRefScrollable,chatPreference:s.default.assertGet("defaultPreference"),children:(0,k.jsx)(L.Wrapper,{msg:e,ref:this._refWrapper,displayType:o.default.DISP_TYPE.MSG_INFO,isMsgVisible:this.isMsgVisible,position:_.MsgPosition.END,onProductClick:this.props.onProductClick})}),(0,k.jsxs)(u.default,{children:[y,(0,k.jsxs)("div",{className:d.default.body,children:[r,n]})]})]},"message-info-modal")}}O.CONCERNS={msg:["id","star","type","isGif","isViewOnce","labels","numTimesForwarded","isFrequentlyForwarded"]},O.displayName="ContactMsgInfoDrawer";var A=(0,m.default)((0,w.default)((0,C.ListenerHOC)((0,b.default)(O,O.CONCERNS))));t.default=A},16926:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{supportTag:t,onSend:a,onFailure:n,onCancel:M,onEmail:w}=e,L=(0,I.default)(),[k,O]=(0,r.useState)(""),[A,D]=(0,r.useState)(null),[R,N]=(0,r.useState)(!0),[F,B]=(0,r.useState)(!1),U=(0,r.useRef)(null);(0,r.useEffect)((()=>{var e;null===(e=U.current)||void 0===e||e.restoreFocus()}),[]);const H=e=>e.length>=u.default.CONTACT_US_MIN_DESC_LENGTH,G=()=>{if(H(k)){let e=(0,i.default)((0,i.default)({},j.UA.parser.getResult()),{},{"Device ID":(0,m.assertGetMe)()});t&&(e=(0,i.default)((0,i.default)({},e),{},{context:t}));const r=R?JSON.stringify(e):void 0;B(!0),null==a||a({description:k}),__LOG__(2)`InAppSupport: Sending support request with deviceInfo=${R}:${null!=r?r:"n/a"}`,(0,_.default)((0,x.sendSupportRequest)(k,r),L).then((e=>{null!=e.message?(d.Cmd.closeModal(),d.Cmd.openToast((0,T.jsx)(E.Toast,{msg:C.default.t(1742),id:(0,E.genId)()}))):n&&n({description:k})})).catch((0,s.catchAbort)((()=>{}))).finally((()=>{B(!1)}))}else D(C.default.t(1673))},V=()=>{null==M||M(),d.Cmd.closeModal()},W=()=>{w&&(d.Cmd.closeModal(),w({description:k}))},z=e=>{O(e)},K=()=>{N(!R)},q=e=>{e.stopPropagation()},Y={enter:q};F&&(Y.esc=q);if(g.GK.supportsFeature(g.GK.F.MD_BACKEND)){const e="contact-us-include-device";return(0,T.jsx)(c.default,{title:C.default.t(1743),okDisabled:!H(k)||F,okSpinner:F,okText:C.default.t(1657),onOK:G,onCancel:F?void 0:V,children:(0,T.jsx)(v.HotKeys,{handlers:Y,children:(0,T.jsxs)(p.FlexColumn,{align:"stretch",children:[(0,T.jsx)(y.TextInput,{error:A,maxLength:b,onChange:z,placeholder:C.default.t(1741),ref:U,value:k}),(0,T.jsx)(p.FlexItem,{xstyle:P.deviceInfo,grow:1,children:(0,T.jsx)(S.TextParagraph,{theme:"muted-small",children:C.default.t(1739)})}),(0,T.jsxs)(p.FlexRow,{children:[(0,T.jsx)(p.FlexItem,{xstyle:P.deviceInfoLabel,grow:1,children:(0,T.jsx)("label",{htmlFor:e,children:(0,T.jsxs)(S.TextParagraph,{theme:"plain",children:[C.default.t(1740)," ",(0,T.jsx)(h.ExternalLink,{href:(0,f.getSupportChatFaqUrl)(),children:C.default.t(1091)})]})})}),(0,T.jsx)(p.FlexItem,{xstyle:P.deviceInfoCheckbox,grow:0,children:(0,T.jsx)(o.CheckBox,{checked:R,id:e,onChange:K})})]}),(0,T.jsx)(p.FlexRow,{children:(0,T.jsx)(p.FlexItem,{xstyle:P.emailLink,grow:1,children:(0,T.jsx)(l.default,{onClick:W,children:C.default.t(889)})})})]})})})}return(0,T.jsx)(c.default,{okText:C.default.t(2192),onOK:()=>d.Cmd.closeModal(),title:C.default.t(1743),children:(0,T.jsx)(S.TextParagraph,{theme:"plain",children:C.default.t(1744)})})};var i=n(a(81109)),s=a(96502),r=a(67294),o=(n(a(56720)),a(33287)),l=n(a(44683)),d=a(69162),c=n(a(75940)),u=n(a(55454)),h=a(4919),f=a(57092),p=a(63290),m=a(86723),g=a(12950),v=a(39e3),C=n(a(2408)),_=n(a(79267)),x=a(66557),S=a(97504),y=a(29458),E=a(49201),j=a(35371),I=n(a(29579)),T=a(85893);const{CONTACT_US_MAX_DESC_LENGTH:b}=u.default,P={deviceInfo:{marginBottom:"t4zgqcuo",marginTop:"opp68qpq"},deviceInfoCheckbox:{minWidth:"r7yn1a4o"},deviceInfoLabel:{paddingEnd:"l9g3jx6n"},emailLink:{marginTop:"opp68qpq"}}},58362:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(67294),s=a(25142),r=a(69162),o=a(78615),l=n(a(2408)),d=a(80959),c=a(31051),u=a(15298),h=a(97504),f=a(76006),p=a(85893);var m=e=>{const t=(0,f.useModelValues)(e.mute,["isMuted","expiration","isCallMuted","callExpiration"]),a=(0,f.useModelValues)(e.reactionsMute,["isMuted","expiration","isCallMuted","callExpiration"]),[n,m]=(0,i.useState)((()=>d.MuteCollection.getGlobalNotifications())),[g,v]=(0,i.useState)((()=>d.MuteCollection.getOutgoingMessageSound())),[C,_]=(0,i.useState)((()=>d.MuteCollection.getGlobalSounds())),[x,S]=(0,i.useState)((()=>d.MuteCollection.getGlobalCallRingtone())),[y,E]=(0,i.useState)((()=>d.MuteCollection.getGlobalPreviews())),[j,I]=(0,i.useState)((()=>d.MuteCollection.getCollapseMuted())),T=()=>{m((e=>{const t=!e;return d.MuteCollection.setGlobalNotifications(t),t}))},b=()=>{E((e=>{const t=!e;return d.MuteCollection.setGlobalPreviews(t),t}))},P=()=>{r.Cmd.muteAll((0,u.unproxy)(a),!a.isMuted,!0)},M=[];let w;window.Notification&&(M.push((0,p.jsx)(c.SettingsCheckListItem,{a8nText:"option-desktop-notifications",id:"desktop-notifications",checked:n,onChange:T,children:l.default.t(1406)},0)),M.push((0,p.jsxs)(c.SettingsCheckListItem,{a8nText:"options-msg-previews",disabled:!n,id:"msg-previews",checked:y,onChange:b,children:[l.default.t(1410),(0,p.jsx)(h.TextDiv,{theme:"muted",children:l.default.t(1411)})]},1)));const{expiration:L,callExpiration:k,isMuted:O,isCallMuted:A}=t;if((0,o.receiveReactionsEnabled)()){const{expiration:e,isMuted:t}=a;w=(0,p.jsxs)(c.SettingsCheckListItem,{a8nText:"option-reactions-mute-desktop-notifications",id:"reactions-mute-desktop-notifications",checked:t,onChange:P,children:[l.default.t(1784),t&&null!=e?(0,p.jsx)(h.TextDiv,{theme:"muted",children:s.Clock.untilStr(e)}):null]})}return(0,p.jsxs)(c.SettingsCheckList,{children:[(0,p.jsx)(c.SettingsCheckListItem,{a8nText:"option-sounds",id:"sounds",checked:C,onChange:()=>{_((e=>{const t=!e;return d.MuteCollection.setGlobalSounds(t),t}))},children:l.default.t(1415)}),undefined,undefined,M,undefined,w,(0,p.jsxs)(c.SettingsCheckListItem,{a8nText:"option-mute-desktop-notifications",id:"mute-desktop-notifications",checked:O,onChange:()=>{r.Cmd.muteAll((0,u.unproxy)(t),!t.isMuted,!1)},children:[l.default.t(1782),O&&null!=L?(0,p.jsx)(h.TextDiv,{theme:"muted",children:s.Clock.untilStr(L)}):null]}),null,null]})};t.default=m},36560:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return(0,r.jsx)("div",{className:i.default.dropOverlay,children:(0,r.jsx)("div",{className:i.default.dropOverlayOutline,children:s.default.t(750)})},"container")};var i=n(a(86088)),s=n(a(2408)),r=a(85893)},50508:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function({rootRef:e,disabled:t,onClick:a,children:n}){const[u,h,f]=function(e){const[t,a]=(0,i.useState)(),[n,s]=(0,i.useState)(),[r,{isIntersecting:o}]=(0,l.default)({root:e,rootMargin:null!=t?`-${t.offsetHeight}px`:void 0});return(0,i.useEffect)((()=>{if(null!=e&&null!=t&&null!=n){if(o)t.style.removeProperty("right");else{const a=e.offsetWidth-(e.clientWidth+2*e.clientLeft);t.style.setProperty("right",`${a}px`)}n.style.setProperty("min-height",`${t.offsetHeight}px`)}}),[o,e,t,n]),[o,e=>{r(e),s(e)},a]}(e);return(0,d.jsx)("div",{ref:h,className:(0,s.default)(c.ctaPlaceholder),children:(0,d.jsx)(o.default,{onRef:f,xstyle:[u?null:c.ctaContainerSticky],theme:"sticky-button-section",children:(0,d.jsx)(r.default,{type:"primary",onClick:a,disabled:t,className:(0,s.default)(c.ctaButton),children:n})})})};var i=a(67294),s=n(a(56720)),r=n(a(69991)),o=n(a(25061)),l=n(a(39406)),d=a(85893);const c={ctaContainerSticky:{position:"ly2gu7o9",bottom:"jxacihee",left:"tukmaf4q",boxShadow:"th8ck7tu"},ctaButton:{display:"f804f6gw",marginBottom:"pel5o5rz"},ctaPlaceholder:{marginBottom:"brac1wpa"}}},41024:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.E2EChangeModal=function(e){const t=(0,o.useModelValues)(e.contact,["formattedShortName"]),a=r.default.t(2192),n=t.formattedShortName,d=r.default.t(2166,{contactName:n}),c=r.default.t(2165,{contactName:n});return(0,l.jsx)(s.default,{title:d,onOK:()=>i.Cmd.closeModal(),okText:a,children:c})};var i=a(69162),s=n(a(75940)),r=n(a(2408)),o=a(76006),l=a(85893)},7158:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.EditImageDrawer=function(e){var t;const{attributionUrl:a,onRetake:n,retryText:T,onFinished:b}=e,P=(0,x.default)(),M=(0,i.useRef)(),w=(0,i.useRef)(null),L=(0,S.default)((()=>new f.default)),[k,O]=(0,i.useState)(!1),[A,D]=(0,i.useState)({width:500,height:361}),[R]=(0,i.useState)((()=>new d.default(e.img)));(0,y.useListener)(L.current,"change:isInitialized",(()=>{P()}));const N=(e,t)=>{var a;null===(a=M.current)||void 0===a||a.drawCanvas(e,t)},F=k?(0,j.jsx)("div",{className:l.default.btnSend,children:(0,j.jsx)(g.Round,{large:!0,onClick:()=>{var e,t;null===(t=M.current)||void 0===t||t.saveCanvas(),null===(e=w.current)||void 0===e||e.crop().then((({thumb:e,full:t})=>{b(e,t),R.cleanUp()}))},children:(0,j.jsx)(v.default,{name:"checkmark-large"})})},"btn-send"):null;let B;L.current.isInitialized&&(B=(0,j.jsx)(m.default,{editedMedia:R,stage:L.current.stage,cropOverlay:L.current.cropOverlay,mediaContainer:L.current.mediaContainer,drawCanvas:N,ref:w}));const U=(0,j.jsx)(h.default,{className:l.default.mediaElement,editedMedia:R,mediaEditController:L.current,fitType:"cover",ref:M});let H;if(n){let e;switch(T){case I.NONE:e=null;break;case I.RETAKE:e=u.default.t(1601);break;case I.RESTART:default:e=u.default.t(1604)}H=(0,j.jsxs)("button",{className:l.default.retake,onClick:n,children:[(0,j.jsx)("div",{className:l.default.retakeIcon,children:(0,j.jsx)(v.default,{name:"return"})}),e]})}const G=a?(0,j.jsxs)("div",{className:l.default.attribution,children:[(0,j.jsx)(c.ExternalLink,{className:l.default.attributionLink,href:a,children:_.URL.hostname(a)}),(0,j.jsxs)("span",{children:[u.default.t(1031)," ",(0,j.jsx)(c.ExternalLink,{href:(0,C.getTosUrl)(),children:u.default.t(1037)})]})]}):null,V=(0,j.jsxs)("div",{className:l.default.footer,children:[(0,j.jsx)(E.default,{transitionName:"btn",children:F}),G]}),W=null!==(t=e.imageSize)&&void 0!==t?t:{width:500,height:361};return(0,j.jsxs)(s.default,{theme:"edit",children:[(0,j.jsx)(o.DrawerHeader,{title:u.default.t(162),type:"offset",onCancel:e.onCancel,children:H}),(0,j.jsxs)(r.default,{overflow:"hidden",children:[(0,j.jsxs)("div",{className:l.default.mediaBody,children:[B,(0,j.jsx)("div",{className:l.default.containerBackground,children:(0,j.jsx)(E.default,{transitionName:"capture",children:(0,j.jsx)(p.default,{type:"cover",size:W,onObjectLoad:e=>{null!=e&&e instanceof HTMLElement&&(!A||A.width===e.clientWidth&&A.height===e.clientHeight||D({width:e.clientWidth,height:e.clientHeight}),k||O(!0))},children:U})})})]}),V]})]},"attach-edit-modal")},t.RETRY_OPTIONS=void 0;var i=a(67294),s=n(a(17747)),r=n(a(9042)),o=a(55588),l=n(a(51236)),d=n(a(21893)),c=a(4919),u=n(a(2408)),h=n(a(59381)),f=n(a(11750)),p=n(a(90904)),m=n(a(1179)),g=a(3132),v=n(a(2966)),C=a(66317),_=a(1458),x=n(a(45172)),S=n(a(79939)),y=a(61192),E=n(a(82669)),j=a(85893);const I={NONE:"none",RETAKE:"retake",RESTART:"restart"};t.RETRY_OPTIONS=I},21893:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a(82492)),s=a(57085),r=a(1458);class o{constructor(e,t,a,n){this.updateEditData=e=>{this.saveEdits(),this.editData=(0,i.default)({},this.editData,e)},this.updateEditItems=(e,t)=>{this.saveEdits();const a=[];this.editData.items&&this.editData.items.forEach((e=>{e!==t&&a.push(e)})),a.push(e),this.editData.items=a},this.saveEdits=()=>{const e=new o(this.media,this.originalImage,this.editData,this.previous);this.previous=e},this.revertEdit=()=>{this.previous&&(this.editData=this.previous.editData,this.previous=this.previous.previous)},this.saveEditsFromCanvas=e=>{const t=e.toDataURL();this.editedImage||(this.editedImage=new Image),this.editedImage.src=t},this.exportEditedMedia=()=>{if(this.hasEdits()&&this.editedImage){const e=this.editedImage.src;return r.URL.dataURLtoFile(e)}return this.media instanceof File?this.media:(0,s.createFile)([this.media],"",{type:this.media.type})},this.hasEdits=()=>!!this.previous&&this.editedImage,this.cleanUp=()=>{window.URL.revokeObjectURL(this.originalImage.src)},this.media=e,t?this.originalImage=t:(this.originalImage=new Image,this.originalImage.src=window.URL.createObjectURL(e)),this.previous=n,this.editData={height:0,width:0,offsetX:0,offsetY:0,rotation:0,scale:1,items:[],baseItem:null},(0,i.default)(this.editData,a)}}t.default=o},59381:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(76304),s=a(71730),r=a(67294),o=n(a(95884)),l=n(a(90904)),d=n(a(92489)),c=n(a(75169)),u=a(85893);function h(e,t){const{mediaEditController:a,editedMedia:n,mediaPickerStatsLogger:h,activeMediaId:f}=e,p=(0,r.useRef)(null),m=(0,r.useRef)(null),g=(0,r.useRef)(null),v=(0,r.useRef)(null),[C,_]=(0,r.useState)({height:1,width:1}),[x,S]=(0,r.useState)(null),[y,E]=(0,r.useState)(null),j=(e,t)=>{if(!p.current||!p.current.refCanvas)return;const r=p.current.refCanvas;t&&h&&h.logChange(f||-1,t);const o=n.editData,l=(e=>{let t;return x?t=x:(t=new i.Easel.Stage(e),t.enableMouseOver()),a.stage=t,t})(r);e&&(r.width=o.width,r.height=o.height),l.removeAllChildren(),null!=o.baseItem&&l.addChild(o.baseItem),o.items&&l.addChild(...o.items);const d=n.originalImage.naturalWidth,c=n.originalImage.naturalHeight;l.regX=d/2,l.regY=c/2,l.rotation=o.rotation,(0,s.isNonZeroNumber)(o.width)&&(0,s.isNonZeroNumber)(o.height)&&(l.x=o.width/2+o.scale*o.offsetX,l.y=o.height/2+o.scale*o.offsetY),l.scaleX=o.scale,l.scaleY=o.scale,l.update(),_({width:r.width,height:r.height}),S(l)},I=()=>{const e=n.editData;n.editedImage=null;const t=n.originalImage;if(e.width||e.height||(e.width=t.naturalWidth,e.height=t.naturalHeight),!e.baseItem){const a=new i.Easel.Bitmap(t);e.baseItem=a}j(!0)},T=()=>{var e;j(!0);const t=null===(e=p.current)||void 0===e?void 0:e.refCanvas;t&&n.saveEditsFromCanvas(t)},b=e=>{e&&(e.children.forEach((e=>{e.removeAllEventListeners()})),e.removeAllEventListeners(),e.removeAllChildren(),e.enableMouseOver(0),e.clear())};(0,r.useEffect)((()=>{(()=>{const e=n.originalImage;e.complete?I():e.onload=I})(),E(m.current),v.current=new i.Easel.Stage(g.current),v.current.autoClear=!1,v.current.enableMouseOver(),m.current&&(a.mediaContainer=m.current),a.cropOverlay=v.current}),[]),(0,c.default)((()=>{const e=n.originalImage;e.complete||(e.onload=void 0),T(),b(x),b(v.current)}));const P=(e,t)=>{_({width:e,height:t})};(0,r.useImperativeHandle)(t,(()=>({saveCanvas:T,drawCanvas:j,updateCanvasSize:P})));const M=(0,u.jsx)("canvas",{ref:g,className:o.default.cropOverlay});return(0,u.jsx)("div",{className:e.className,ref:m,children:(0,u.jsxs)(l.default,{type:e.fitType||"scaleDown",size:C,children:[M,(0,u.jsx)(d.default,{ref:p,className:o.default.mediaViewerImg})]})})}var f=(0,r.forwardRef)(h);t.default=f},11750:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(57283);class i extends n.BaseModel{constructor(...e){super(...e),this.stage=(0,n.prop)(),this.cropOverlay=(0,n.prop)(),this.mediaContainer=(0,n.prop)(),this.isInitialized=(0,n.derived)(this._isInitialized,["stage","cropOverlay","mediaContainer"])}_isInitialized(){return!!this.stage&&!!this.cropOverlay&&!!this.mediaContainer}clearStage(e){e&&(e.children.forEach((e=>{e.removeAllEventListeners()})),e.removeAllEventListeners(),e.removeAllChildren(),e.clear())}}var s=(0,n.defineModel)(i);t.default=s},1179:(e,t,a)=>{"use strict";var n=a(20862),i=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=i(a(48926)),r=a(76304),o=a(67294),l=i(a(55454)),d=n(a(49288)),c=i(a(46475)),u=i(a(2966)),h=a(61192),f=a(85893);const p=1.1;function m(e,t){const{editedMedia:a,cropOverlay:n,drawCanvas:i}=e,m=(0,o.useRef)(0),g=e=>{const t=m.current,n=a.editData,i=Math.max(2*t/n.width,2*t/n.height),s=Math.max(e,i);if(n.width*e<t||n.height*e<t)return!1;const r=-t/s+n.width/2,o=t/s-n.width/2,l=-t/s+n.height/2,d=t/s-n.height/2;return{scale:s,offsetX:Math.min(Math.max(n.offsetX,o),r),offsetY:Math.min(Math.max(n.offsetY,d),l)}},v=(e=1.1)=>{const t=a.editData,n=0!==e?e:p,s=g(t.scale*n);s&&(t.scale=s.scale,t.offsetX=s.offsetX,t.offsetY=s.offsetY,i())},C=(e=1.1)=>{const t=a.editData,n=0!==e?e:p,s=g(t.scale/n);s&&(t.scale=s.scale,t.offsetX=s.offsetX,t.offsetY=s.offsetY,i())};(0,h.useListener)(n.canvas,"mousewheel",(e=>{e.deltaY>0?v(1.02):C(1.02)}));const _=(e,t)=>{const n=a.editData,s=e.stageX-t.x,r=e.stageY-t.y,o=n.offsetX+s/n.scale,l=n.offsetY+r/n.scale,d=((e,t)=>{const n=m.current,i=a.editData,s=(e-i.width/2)*i.scale,r=(e+i.width/2)*i.scale,o=(t+i.height/2)*i.scale;return{x:s<-n&&r>n,y:(t-i.height/2)*i.scale<-n&&o>n}})(o,l);d.x&&(n.offsetX=o),d.y&&(n.offsetY=l),t.x=e.stageX,t.y=e.stageY,i()};(0,o.useEffect)((()=>{a.saveEdits();const e=a.editData,t=n.canvas;let i;i=e.baseItem?e.baseItem.getBounds():{width:0,height:0},t.style.display="block",t.width=i.width,t.height=i.height;const s=new r.Easel.Shape;s.graphics.beginFill("rgba(0, 0, 0, 0.1)"),s.graphics.drawRect(0,0,i.width,i.height),s.regX=i.width/2,s.regY=i.height/2,s.x=i.width/2,s.y=i.height/2,s.on("mousedown",(e=>{const t={x:e.stageX,y:e.stageY},a=s.on("pressmove",_,null,!1,t);s.on("pressup",(()=>{s.off("pressmove",a)}),null,!0)})),s.cursor="move";const o=t.getContext("2d"),l=t.width,d=t.height,c=l/d>500/361?d/361:l/500;m.current=Math.min(361,500)/2*.9*c;const u=m.current;o.fillStyle="rgba(0, 0, 0, 0.5)",o.fillRect(0,0,l,d),o.globalCompositeOperation="destination-out",o.beginPath(),o.arc(l/2,d/2,u,0,2*Math.PI,!0),o.fillStyle="#ffffff",o.fill(),n.addChild(s),n.update()}),[]);const x=function(){var e=(0,s.default)((function*(){var e;const t=a.editData,n=null===(e=a.editedImage)||void 0===e?void 0:e.src,i=m.current;if(!n)throw new Error("empty image");const s=2*i;let r=s;s>l.default.MAX_PIC_SIDE?r=l.default.MAX_PIC_SIDE:s<l.default.MIN_PIC_SIDE&&(r=l.default.MIN_PIC_SIDE);const o=yield d.crop(n,(t.width-2*i)/2,(t.height-2*i)/2,2*i,2*i,r,r,d.DATA_URL|d.CANVAS),c=o.images.dataUrl;return{thumb:(yield d.crop(o.images.canvas,0,0,l.default.PROF_PIC_THUMB_SIDE,l.default.PROF_PIC_THUMB_SIDE)).images.dataUrl,full:c}}));return function(){return e.apply(this,arguments)}}();return(0,o.useImperativeHandle)(t,(()=>({crop:x}))),(0,f.jsxs)("div",{className:c.default.scaler,children:[(0,f.jsx)("div",{className:c.default.scalerButton,onClick:()=>{v()},children:(0,f.jsx)(u.default,{name:"plus"})}),(0,f.jsx)("div",{className:c.default.scalerButton,onClick:()=>{C()},children:(0,f.jsx)(u.default,{name:"minus"})})]})}var g=(0,o.forwardRef)(m);t.default=g},92489:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(67294),i=a(85893);class s extends n.Component{constructor(...e){super(...e),this._setRefCanvas=e=>{this.refCanvas=e}}shouldComponentUpdate(){return!1}render(){return(0,i.jsx)("canvas",{className:this.props.className,ref:this._setRefCanvas})}}t.default=s,s.displayName="StaticCanvas"},57597:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const[t,a]=(0,i.useState)(e.initialDuration),[n,C]=(0,i.useState)((0,h.shouldShowNUX)(l.default.NUX.EPHEMERAL));(0,i.useEffect)((()=>{(0,h.setNUX)(l.default.NUX.EPHEMERAL,{views:1,maxViews:1})}),[]);const _=e=>a(parseInt(e.target.value,10));let x;x=n?(0,g.jsx)(d.default,{fromMe:!0}):(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(m.TextParagraph,{xstyle:v.explanation,children:p.default.t(810)}),(0,f.getAllDurations)().map((({value:e,label:a})=>(0,g.jsx)("div",{className:(0,s.default)(v.option),children:(0,g.jsxs)("label",{className:(0,s.default)(v.label),children:[(0,g.jsx)("input",{type:"radio",className:(0,s.default)(v.input),value:String(e),checked:e===t,onChange:_}),a]})},`option-${e}`)))]});return(0,g.jsx)(o.default,{title:n?void 0:p.default.t(972),onOK:n?()=>{C(!1)}:()=>{e.onDurationSelected(t),r.Cmd.closeModal()},onCancel:n?()=>{(0,c.openExternalLink)((0,u.getEphemeralFaqUrl)())}:()=>{r.Cmd.closeModal()},cancelText:n?p.default.t(1091):p.default.t(1999),children:x})};var i=a(67294),s=n(a(56720)),r=a(69162),o=n(a(75940)),l=n(a(55454)),d=n(a(64241)),c=a(4919),u=a(57092),h=a(86723),f=a(33906),p=n(a(2408)),m=a(97504),g=a(85893);const v={option:{display:"p357zi0d",alignItems:"gndfcl4n",height:"sai7fuui"},label:{display:"f804f6gw",cursor:"ajgl1lbb"},input:{marginEnd:"claouzo6",verticalAlign:"neme6l2y"},explanation:{marginBottom:"t4zgqcuo"}}},49461:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function({frequentlyForwardedCount:e,totalCount:t}){const a=(0,c.jsxs)("span",{className:o.default.text,children:[1===e&&1===t?l.default.t(878):l.default.t(877)," ",(0,c.jsx)(s.ExternalLink,{href:(0,r.getFrequentlyForwardedFaqUrl)(),children:l.default.t(1091)})]});return(0,c.jsxs)("div",{className:o.default.wrapper,children:[(0,c.jsx)("div",{className:o.default.icon,children:(0,c.jsx)(d.default,{name:"highly-forwarded"})}),(0,c.jsx)(i.default,{theme:"plain",primary:a,idle:!0})]})};var i=n(a(55092)),s=a(4919),r=a(57092),o=n(a(65813)),l=n(a(2408)),d=n(a(2966)),c=a(85893)},90581:(e,t,a)=>{"use strict";var n=a(20862),i=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=a(96502),r=a(61295),o=a(44213),l=a(67294),d=i(a(55092)),c=a(69162),u=i(a(55059)),h=a(88419),f=i(a(17747)),p=i(a(9042)),m=i(a(17061)),g=a(55588),v=a(85051),C=a(92231),_=n(a(13540)),x=a(70991),S=i(a(32521)),y=i(a(56396)),E=a(70788),j=i(a(2408)),I=i(a(79267)),T=a(20845),b=a(70475),P=i(a(5646)),M=i(a(2966)),w=a(49201),L=a(76006),k=i(a(29579)),O=a(12825),A=a(85893);const D="group-invite-link-anchor",R=0,N=1,F=2;function B(e,t){const{onBack:a,chat:n}=e,[i,B]=(0,l.useState)(R),U=(0,k.default)(),H=(0,L.useModelValues)(e.groupMetadata,["inviteCode","groupInviteLink"]),G=e=>{switch(e){case 401:return j.default.t(942);case 403:return j.default.t(943);case 404:return j.default.t(944);case 436:return j.default.t(946);default:return j.default.t(945)}};(0,l.useEffect)((()=>{(0,I.default)((0,x.queryGroupInviteCode)(H),U).then((()=>{B(F)})).catch((0,r.filteredCatch)(O.ServerStatusCodeError,(e=>{(e=>{const t=G(e);a(),436===e&&(0,E.openGrowthLockedModal)(!0),c.Cmd.openToast((0,A.jsx)(w.Toast,{msg:t,id:(0,w.genId)()}))})(e.statusCode)}))).catch((0,s.catchAbort)((()=>{})))}),[]);const V=()=>{B(N);const e=(0,x.revokeGroupInvite)(H);(0,o.delayMs)(500).then((()=>e)).then((()=>{c.Cmd.openToast((0,A.jsx)(w.Toast,{msg:j.default.t(954),id:(0,w.genId)()})),B(F)})).catch((0,r.filteredCatch)(O.ServerStatusCodeError,(e=>{(e=>{const t=G(e);a(),c.Cmd.openToast((0,A.jsx)(w.Toast,{msg:t,id:(0,w.genId)()}))})(e.statusCode)}))).catch((0,r.filteredCatch)(_.Unmount,(()=>{})))},W=()=>{c.Cmd.openModal((0,A.jsx)(y.default,{pushTransition:"none",popTransition:"none",chat:n,onConfirm:V}),{transition:"modal-flow"})},z=()=>{c.Cmd.openModal((0,A.jsx)(b.SendGroupInviteFlowLoadable,{chat:n}),{transition:"modal-flow"})};return(0,A.jsxs)(f.default,{ref:t,children:[(0,A.jsx)(g.DrawerHeader,{title:j.default.t(934),onBack:e.onBack,type:g.DRAWER_HEADER_TYPE.SMALL}),(()=>{let e;if(i===R)e=(0,A.jsx)(C.LoadingWithText,{text:j.default.t(930)});else if(i===N)e=(0,A.jsx)(C.LoadingWithText,{text:j.default.t(953,{groupName:n.contact.name})});else{const t=H.groupInviteLink;let a=null;document.queryCommandSupported("copy")&&(a=(0,A.jsx)(u.default,{elementId:D}));const i=(0,A.jsx)(h.DetailImage,{id:n.id,size:82,quality:h.DETAIL_IMAGE_QUALITY.HIGH}),s=(0,A.jsx)("span",{className:S.default.linkContainer,children:(0,A.jsx)(T.SelectableLink,{id:D,href:t,selectable:!0,children:t})});e=(0,A.jsxs)(p.default,{children:[(0,A.jsx)(d.default,{image:i,primary:(0,A.jsx)(v.EmojiText,{text:n.contact.name,direction:"auto"}),theme:"identity",secondary:s}),(0,A.jsx)("div",{className:S.default.descContainer,children:j.default.t(935)}),(0,A.jsx)(P.default,{onClick:z}),a,(0,A.jsx)(m.default,{a8nText:"li-revoke-link",icon:(0,A.jsx)(M.default,{name:"revoke",className:S.default.icon}),onClick:W,children:j.default.t(932)})]})}return e})()]})}var U=(0,l.forwardRef)(B);t.default=U},2251:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{onConfirm:t}=e;return(0,l.jsx)(s.default,{title:o.default.t(932),onOK:()=>{t(),i.Cmd.closeModal()},okText:o.default.t(932),onCancel:()=>{i.Cmd.closeModal()},cancelText:o.default.t(1999),children:(0,l.jsx)("div",{className:r.default.confirmationText,children:o.default.t(952,{groupName:e.chat.contact.name})})})};var i=a(69162),s=n(a(75940)),r=n(a(56081)),o=n(a(2408)),l=a(85893)},62286:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a(48158)),s=a(67294),r=n(a(76610)),o=n(a(94822)),l=a(69162),d=n(a(55454)),c=n(a(17747)),u=n(a(9042)),h=a(55588),f=n(a(25061)),p=a(86025),m=n(a(67893)),g=a(78615),v=n(a(75798)),C=n(a(51314)),_=n(a(23533)),x=n(a(33677)),S=a(12009),y=n(a(52087)),E=n(a(45530)),j=n(a(2408)),I=a(71681),T=a(51435),b=n(a(4231)),P=a(45472),M=a(57636),w=n(a(95005)),L=n(a(69704)),k=n(a(16211)),O=a(65565),A=a(46714),D=n(a(79485)),R=n(a(2966)),N=a(97504),F=a(49201),B=n(a(27988)),U=a(61211),H=a(85893);class G extends s.Component{constructor(e){super(e),this.flatListController=new m.default,this.setRefScrollable=e=>{this.refScrollable=e},this.state={msgInfo:void 0,unimplemented:!1},this._refWrapper=(0,s.createRef)(),this.isMsgVisible=(e,t=!1)=>e===this.props.msg.id&&(!!t||this.getMsgComponent()),this.handleClose=()=>{this.props.uim.uie.requestDismiss()},this._getHeaderAtSection=e=>{let t,a;switch(e){case S.SECTIONS.PLAYED_HEADER:a=(0,H.jsx)(R.default,{name:"status-ptt",className:_.default.statusBlue}),t=j.default.t(1237);break;case S.SECTIONS.READ_HEADER:a=(0,H.jsx)(R.default,{name:"status-dblcheck",className:_.default.ack}),t=j.default.t(1239);break;case S.SECTIONS.SEEN_HEADER:a=(0,H.jsx)(R.default,{name:"status-dblcheck",className:_.default.ack}),t=this.props.msg.isViewOnce?j.default.t(1244):j.default.t(1242);break;case S.SECTIONS.DELIVERED_HEADER:a=(0,H.jsx)(R.default,{name:"status-dblcheck"}),t=j.default.t(1235);break;case S.SECTIONS.VIEWED_HEADER:a=(0,H.jsx)(R.default,{name:"view-once-viewed",className:_.default.statusBlue}),t=j.default.t(1246);break;default:return __LOG__(4,void 0,new Error)`Invalid SECTION for group message info section header`,null}return a=(0,H.jsx)("div",{className:_.default.titleIcon,children:a}),(0,H.jsx)("div",{"data-a8n":r.default.key("msg-info-title"),className:_.default.title,children:(0,H.jsx)(k.default,{side:a,ellipsify:!0,children:(0,H.jsx)(N.TextSpan,{theme:"section-title",children:t})})})},this._getFooterAtSection=e=>{const t=(0,i.default)(this.state.msgInfo,"this.state.msgInfo");return(0,H.jsx)(x.default,{section:e,msgInfo:t},e)},this.renderItem=e=>{if("row"===e.kind)return this._getInfoCell(e.participant);if(e.type===S.SECTIONS.FORWARD_COUNT)return this._getForwardCount();switch(e.type){case S.SECTIONS.PLAYED_HEADER:case S.SECTIONS.READ_HEADER:case S.SECTIONS.SEEN_HEADER:case S.SECTIONS.DELIVERED_HEADER:case S.SECTIONS.VIEWED_HEADER:return this._getHeaderAtSection(e.type);default:return this._getFooterAtSection(e.type)}},this._uiActionEvent=new b.default.UiAction({uiActionType:b.default.UI_ACTION_TYPE.MSG_INFO_OPEN,uiActionPreloaded:!0})}componentDidMount(){var e;M.MsgInfoCollection.find(this.props.msg.id).then((e=>{this.props.getUnmountSignal().aborted||(this.setState({msgInfo:e}),this.props.listeners.add(e.played,"add remove",(()=>{this.forceUpdate()})),this.props.listeners.add(e.read,"add remove",(()=>{this.forceUpdate()})),this.props.listeners.add(e.delivery,"add remove",(()=>{this.forceUpdate()})))})).catch((()=>{this.setState({unimplemented:!0}),l.Cmd.openToast((0,H.jsx)(F.Toast,{msg:j.default.t(1268),id:(0,F.genId)("msg_info_failed")}))}));const t=null===(e=this.refScrollable)||void 0===e?void 0:e.container;this.props.msg.type===d.default.MSG_TYPE.IMAGE&&t&&(t.scrollTop=t.scrollHeight),this.props.listeners.add(this.props.msg,"remove",((e,t)=>{t===P.MsgCollection&&this.props.uim.uie.requestDismiss()}));const a=this._uiActionEvent;if(a){var n;const e=null===(n=v.default.get(this.props.msg.chat.id))||void 0===n?void 0:n.cachedDeviceSizeBucket;null!=e&&(a.sizeBucket=e),a.markUiActionT(),a.commit(),this._uiActionEvent=void 0}}getAnimateEnterClass(e){return`animate-enter${-1===e?"":e}`}getMsgComponent(){var e;return null===(e=this._refWrapper.current)||void 0===e?void 0:e.getMsgComponentRef()}_getInfoCell(e){return(0,H.jsx)(C.default,{msgInfoParticipant:e,contact:e.contact,theme:"drawer-list"},e.id.toString())}_getForwardCount(){return O.ServerProps.hfmStringChanges?null:(0,H.jsx)("div",{className:_.default.forwardCount,children:(0,H.jsx)(w.default,{msg:this.props.msg})})}getData(){const{msg:e}=this.props,{msgInfo:t}=this.state,a=[],n=e.type===d.default.MSG_TYPE.PTT,i=n||e.isViewOnce;if(t&&i){let e=n?S.SECTIONS.PLAYED_HEADER:S.SECTIONS.VIEWED_HEADER;a.push({kind:"section",type:e,itemKey:e,height:50}),a.push(...t.played.map((e=>({participant:e,kind:"row",itemKey:e.id.toString(),height:p.DEFAULT_ITEM_HEIGHT})))),t.playedRemaining>0&&(e=n?S.SECTIONS.PLAYED_FOOTER:S.SECTIONS.VIEWED_FOOTER,a.push({kind:"section",type:e,itemKey:e,height:50}))}return t&&(t.read.length>0||t.playedRemaining>0)&&(a.push({kind:"section",type:i?S.SECTIONS.SEEN_HEADER:S.SECTIONS.READ_HEADER,itemKey:S.SECTIONS.READ_HEADER,height:50}),a.push(...t.read.map((e=>({participant:e,kind:"row",itemKey:e.id.toString(),height:p.DEFAULT_ITEM_HEIGHT})))),t.readRemaining>0&&a.push({kind:"section",type:S.SECTIONS.READ_FOOTER,itemKey:i?S.SECTIONS.SEEN_FOOTER:S.SECTIONS.READ_FOOTER,height:50})),t&&(t.delivery.length>0||t.deliveryRemaining>0)&&(a.push({kind:"section",type:S.SECTIONS.DELIVERED_HEADER,itemKey:S.SECTIONS.DELIVERED_HEADER,height:50}),a.push(...t.delivery.map((e=>({participant:e,kind:"row",itemKey:e.id.toString(),height:p.DEFAULT_ITEM_HEIGHT})))),t.deliveryRemaining>0&&a.push({kind:"section",type:S.SECTIONS.DELIVERED_FOOTER,itemKey:S.SECTIONS.DELIVERED_FOOTER,height:50})),e.numTimesForwarded>0&&!e.isFrequentlyForwarded&&a.push({kind:"section",type:S.SECTIONS.FORWARD_COUNT,itemKey:S.SECTIONS.FORWARD_COUNT,height:60}),a}render(){const{msg:e}=this.props,{msgInfo:t,unimplemented:a}=this.state;let n;t||a||(n=(0,H.jsx)("div",{className:_.default.spinner,children:(0,H.jsx)(A.Spinner,{size:50,stroke:4})},"spinner"));const i=this.getData(),s=i.length?(0,H.jsx)(p.FlatList,{flatListController:this.flatListController,direction:"vertical",forceConsistentRenderCount:!1,data:i,renderItem:this.renderItem}):null;let r=null;return e.labels&&e.labels.length>0&&(0,g.canDisplayLabel)()&&(r=(0,H.jsx)(f.default,{theme:"padding",children:(0,H.jsx)(E.default,{labels:e.labels})})),(0,H.jsxs)(c.default,{theme:"striped",children:[(0,H.jsx)(h.DrawerHeader,{title:j.default.t(1233),type:h.DRAWER_HEADER_TYPE.SMALL,onCancel:this.handleClose}),(0,H.jsx)(L.default,{ref:this.setRefScrollable,chatPreference:o.default.assertGet("defaultPreference"),children:(0,H.jsx)(U.Wrapper,{msg:e,ref:this._refWrapper,displayType:d.default.DISP_TYPE.MSG_INFO,isMsgVisible:this.isMsgVisible,position:T.MsgPosition.END,onProductClick:this.props.onProductClick})}),(0,H.jsxs)(u.default,{flatListControllers:[this.flatListController],children:[r,n,(0,H.jsx)("div",{className:_.default.list,children:s})]})]},"message-info-modal")}}G.CONCERNS={msg:["id","star","type","isGif","isViewOnce","labels","numTimesForwarded","isFrequentlyForwarded","chat"]},G.displayName="GroupMsgInfoDrawer";var V=(0,y.default)((0,B.default)((0,I.ListenerHOC)((0,D.default)(G,G.CONCERNS))));t.default=V},33677:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const t=(0,d.useModelValues)(e.msgInfo,["playedRemaining","readRemaining","deliveryRemaining"]);let a,n,u;switch(e.section){case r.SECTIONS.PLAYED_FOOTER:case r.SECTIONS.VIEWED_FOOTER:a=t.playedRemaining,n=t.playedRemaining;break;case r.SECTIONS.READ_FOOTER:case r.SECTIONS.SEEN_FOOTER:a=t.readRemaining,n=t.readRemaining;break;case r.SECTIONS.DELIVERED_FOOTER:a=t.deliveryRemaining,n=t.deliveryRemaining;break;default:return __LOG__(4,void 0,new Error)`Invalid SECTION for group message info section footer`,null}if(null==a||0===a)return null;u={count:a,_plural:n};const h=o.default.t(1240,u);return(0,c.jsx)("div",{"data-a8n":i.default.key("msg-info-remaining"),className:s.default.footer,children:(0,c.jsx)(l.TextSpan,{theme:"muted",children:h})})};var i=n(a(76610)),s=n(a(23533)),r=a(12009),o=n(a(2408)),l=a(97504),d=a(76006),c=a(85893)},12009:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SECTIONS=void 0;const n=a(54302).Mirrored(["DELIVERED_FOOTER","DELIVERED_HEADER","FORWARD_COUNT","PLAYED_FOOTER","PLAYED_HEADER","READ_FOOTER","READ_HEADER","SEEN_FOOTER","SEEN_HEADER","VIEWED_FOOTER","VIEWED_HEADER"]);t.SECTIONS=n},82981:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{onClose:t,gid:a,onSend:n}=e,E=(0,i.useRef)(null),j=(0,i.useRef)(null),[I,T]=(0,i.useState)(p.default.t(985)),b=(0,y.jsx)(C.Round,{a8nText:"group-participants-btn",large:!0,onClick:()=>{(()=>{const e=v.ProfilePicThumbCollection.get(a);return new Promise((t=>{e&&e.img?(0,h.default)(e.img).then((e=>{if(e.ok)return e.blob();t(void 0)})).then((e=>{if(!e)return;const a=new FileReader;a.onloadend=function(){const e=a.result;if(null==e)return void t(void 0);const n=e.toString().split(",")[1];t(n)},a.readAsDataURL(e)})).catch((()=>t(void 0))):t(void 0)}))})().then((e=>{n(I,e)}))},children:(0,y.jsx)(_.default,{name:"send",directional:!0})}),P=(0,y.jsx)(o.DetailImage,{id:e.gid}),M=(0,y.jsx)(u.EmojiText,{text:e.subject});return(0,y.jsx)(m.Modal,{type:m.ModalTheme.Invite,children:(0,y.jsxs)(l.default,{theme:"invite",children:[(0,y.jsx)(c.DrawerHeader,{type:c.DRAWER_HEADER_TYPE.POPUP,title:p.default.t(994),onCancel:()=>{t()}}),(0,y.jsxs)(d.default,{children:[(0,y.jsx)("div",{className:f.default.search,children:(0,y.jsx)("div",{"data-list-scroll-container":!0,children:(0,y.jsx)(g.default,{ref:E,theme:"list-names",contacts:e.participants.map((e=>e.contact))})})}),(0,y.jsx)("div",{className:f.default.commentInput,children:(0,y.jsx)(x.TextInput,{a8n:"groups-v4-invite-add-comment-input",ref:j,value:I,showRemaining:!0,maxLength:r.default.MAX_CAPTION_LENGTH,onChange:e=>{T(e)},theme:"v4-invite-caption",supportsEmoji:!0})}),(0,y.jsx)(S.default,{transitionName:"btn",className:f.default.onSendInvite,children:b}),(0,y.jsx)("div",{className:f.default.groupInfo,children:(0,y.jsx)(s.default,{idle:!0,image:P,primary:M,secondary:p.default.t(989),theme:"group_v4_invite"})})]})]})})};var i=a(67294),s=n(a(55092)),r=n(a(55454)),o=a(88419),l=n(a(17747)),d=n(a(9042)),c=a(55588),u=a(85051),h=n(a(89178)),f=n(a(2021)),p=n(a(2408)),m=a(79475),g=n(a(4337)),v=a(3165),C=a(3132),_=n(a(2966)),x=a(29458),S=n(a(82669)),y=a(85893)},75730:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a(23279)),s=n(a(63105)),r=n(a(35161)),o=a(44213),l=a(67294),d=a(75381),c=a(92231),u=n(a(2408)),h=n(a(15058)),f=n(a(70422)),p=n(a(16967)),m=a(85893);class g extends l.Component{getElement(){this._refEl}constructor(e){super(e),this._setRefEl=e=>{this._refEl=e},this.handleSelect=(e,t)=>{if(!(t instanceof d.Mode))return;const a=t.props.chat;!0===this.props.filter(a)&&this.props.onGroup(t.props.chat)},this.handleSearch=(0,i.default)((e=>{this.setState({searchText:e})}),100),this.renderItem=e=>{const{onGroup:t,filter:a}=this.props;let n,i;const s=a(e.chat),r="boolean"!=typeof s;return r&&(n=s,i="group-modal"),(0,m.jsx)(d.Chat,{chat:e.chat,contact:e.chat.contact,mode:d.Mode.INFO,active:this.selection,secondary:n,noContext:!0,theme:i,onClick:r?void 0:t.bind(null,e.chat)})},this.selection=new p.default,this.state={loading:!0,searchText:void 0}}componentDidMount(){const{chats:e}=this.props;(0,o.delayMs)(300).then((()=>Promise.all((0,r.default)((0,s.default)(e,(e=>{var t;return null===(t=e.groupMetadata)||void 0===t?void 0:t.stale})),(e=>{var t;return a(75798).default.update(null===(t=e.groupMetadata)||void 0===t?void 0:t.id).catch((()=>{}))}))))).then((()=>this.setState({loading:!1})))}getData(){const{chats:e,filter:t}=this.props,{loading:a,searchText:n}=this.state;if(a)return[];const i=u.default.accentFold(n),s=(0,f.default)(i),r=e.filter((e=>t(e)&&(!i||i&&e.contact.searchMatch(i,s))));return this.selection.init(r.filter((e=>!0===t(e))).map((e=>e.id))),r.map((e=>({chat:e,itemKey:e.id.toString()})))}render(){const{onCancel:e}=this.props,{loading:t}=this.state,a=t?(0,m.jsx)(c.Loading,{}):(0,m.jsx)(c.SearchGroups,{});return(0,m.jsx)(h.default,{title:u.default.t(2135),data:this.getData(),renderItem:this.renderItem,emptyState:a,selection:this.selection,onCancel:e,onSearch:this.handleSearch,onSelect:this.handleSelect,onRef:this._setRefEl,searchPlaceholder:u.default.t(1620)})}}t.default=g,g.defaultProps={filter:()=>!0},g.displayName="GroupsModal"},50792:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const t=(0,i.useRef)(-1),a=(0,i.useRef)(!1),n=(e,n)=>{(0,C.logSessionEvent)(e,t.current,n),a.current=!0};(0,i.useEffect)((()=>(t.current=performance.now(),r.AssetLoader.loadAsset(j,r.LOAD_PRIORITY.HELP_ANIMATED_DOODLE),()=>{a.current||n(_.default.CONTACT_US_EXIT_STATE.CANCELLED)})),[]);const s=()=>{n(_.default.CONTACT_US_EXIT_STATE.PROBLEM_DESCRIPTION)},I=e=>{n(_.default.CONTACT_US_EXIT_STATE.EMAIL_SEND,e)},T=()=>{},b=()=>{o.Cmd.openModal((0,E.jsx)(v.LicensesPopupLoadable,{onOk:T}))};let P;S.UA.isElectron&&(P=(0,E.jsx)(u.default,{a8nText:"li-licenses",onClick:b,children:g.default.t(1092)}));return(0,E.jsxs)(d.default,{children:[(0,E.jsx)(h.DrawerHeader,{a8n:"drawer-title-help",title:g.default.t(1021),onBack:e.onClose,type:h.DRAWER_HEADER_TYPE.LARGE}),(0,E.jsxs)(c.default,{children:[(0,E.jsx)("div",{className:m.default.animation}),(0,E.jsx)(y.default,{className:m.default.versionInfo}),(0,E.jsx)(u.default,{a8nText:"li-faq",onClick:()=>{(0,f.openExternalLink)((0,p.getFaqUrl)()),n(_.default.CONTACT_US_EXIT_STATE.FAQ)},children:g.default.t(2263)}),(0,E.jsx)(u.default,{a8nText:"li-contact-us",onClick:()=>{o.Cmd.openModal((0,E.jsx)(l.default,{onCancel:s,onSend:I}))},children:g.default.t(1671)}),P,(0,E.jsx)(u.default,{a8nText:"li-tos",onClick:()=>{a.current=!0,(0,f.openExternalLink)((0,x.getTosUrl)())},children:g.default.t(1770)}),undefined,undefined]})]})};var i=a(67294),s=n(a(11959)),r=a(61970),o=a(69162),l=n(a(64800)),d=n(a(17747)),c=n(a(9042)),u=n(a(17061)),h=a(55588),f=a(4919),p=a(57092),m=n(a(51298)),g=n(a(2408)),v=a(51434),C=a(36042),_=n(a(4231)),x=a(66317),S=a(35371),y=n(a(7795)),E=a(85893);const j={id:"animated-doodle",selectors:[`.${m.default.animation}`],low:{default:s.default},high:{default:s.default}}},51642:(e,t,a)=>{"use strict";var n=a(20862),i=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{onImageSelected:t}=e,a=(0,k.default)(),n=(0,d.useRef)(null),i=(0,d.useRef)(null),D=(0,d.useRef)(null),R=(0,d.useRef)(!1),N=(0,d.useRef)(null),[F,B]=(0,d.useState)({}),[U,H]=(0,d.useState)(!1),[G,V]=(0,d.useState)(0),[W,z]=(0,d.useState)(""),[K,q]=(0,d.useState)([]),[Y,Q]=(0,d.useState)(0),X=(0,L.default)(((e,t)=>{R.current=!1;const a=new c.default,n=u.search(e,t).then((t=>{var i;if(a.signal.aborted)throw new l.AbortError;n===(null===(i=N.current)||void 0===i?void 0:i.promise)&&(((e,t)=>{const a=(0,o.default)(t.value,(e=>e.thumbnailUrl)),n=(0,r.default)(t.value,(e=>({id:e.imageId,name:e.name,thumbUrl:e.thumbnailUrl}))),i=t.value.length;var l,d;W===e?(V(t.nextOffset?t.nextOffset:G+i),q((0,s.default)(K,n)),Q(null!==(l=t.totalEstimatedMatches)&&void 0!==l?l:0),B(Object.assign(a,F))):(B(a),V(t.nextOffset?t.nextOffset:G+i),z(W),q(n),Q(null!==(d=t.totalEstimatedMatches)&&void 0!==d?d:0)),B({}),H(!1),V(0),z(""),q([]),Q(0)})(e,t),H(!1))})).catch((0,l.catchAbort)((()=>{}))).catch((()=>{var e;__LOG__(3,!0)`Image search failed`,h.Cmd.openToast((0,A.jsx)(P.Toast,{msg:I.default.t(1032),id:(0,P.genId)()})),n===(null===(e=N.current)||void 0===e?void 0:e.promise)&&H(!1)})).finally((()=>{var e;n===(null===(e=N.current)||void 0===e?void 0:e.promise)&&(N.current=null)}));N.current={promise:n,controller:a},H(!0)}),750),Z=()=>{X.cancel(),R.current&&(R.current=!1),N.current&&N.current.controller.abort()},$=()=>{B({}),H(!1),V(0),z(""),q([]),Q(0)},J=(e,t=0)=>{R.current=!0,X(e,t)},ee=()=>{R.current||N.current||!Y||G>=Y||J(W,G)},te=e=>{const n=F[e];if(!n)return;const i=n.contentUrl;let s;if(M.UA.isElectron)s=(0,b.default)((()=>(0,_.default)(i))).then((e=>{if(200!==e.status)throw new C.ServerStatusError(null,i,e.status);return e.blob()}));else{if(y.GK.supportsFeature(y.GK.F.MD_BACKEND))throw new Error("This call is only supported in non-MD mode");s=O.default.downloadImage(i)}s.then((e=>{if(!a.aborted){if(!(e instanceof Blob))throw new C.ImageError("Server did not respond with image bytes",i);t(e,n.hostPageUrl)}})).catch((()=>{__LOG__(3,!0)`Image search failed`,h.Cmd.openToast((0,A.jsx)(P.Toast,{msg:I.default.t(1029),id:(0,P.genId)()}))}))},ae=()=>{x.default.shouldIndicateFocus(),S.default.focus(n.current)},ne=g.DRAWER_HEADER_TYPE.POPUP;let ie;ie=0===K.length?U?(0,A.jsx)(v.SearchingImages,{}):W?(0,A.jsx)(v.ImageSearchEmpty,{}):(0,A.jsx)(v.BeforeImageSearch,{}):(0,A.jsx)(j.default,{ref:D,canLoadMore:G<Y,isLoadingMore:U,thumbnails:K,onFocusPrev:ae,onImageClick:te,onRequestMoreImages:ee});return(0,A.jsxs)(p.default,{children:[(0,A.jsx)(g.DrawerHeader,{title:I.default.t(1036),type:ne,onBack:e.onBack,onCancel:e.onCancel}),(0,A.jsxs)(m.default,{children:[(0,A.jsx)(E.HotKeys,{onRef:e=>{i.current=e},handlers:{down:e=>{e.repeat||D.current&&n.current&&n.current.cursorIsAtEnd()&&(e.preventDefault(),e.stopPropagation(),x.default.shouldIndicateFocus(),null!=D.current&&S.default.focus(D.current))}},onFocus:()=>{x.default.maybeIndicateFocus(i.current)},children:(0,A.jsx)(T.default,{ref:n,placeholder:I.default.t(1033),onSearch:e=>{const t=(e||"").trim();if(!t)return Z(),void $();(0,w.numCodepoints)(t)<f.default.FTS_MIN_CHARS||t!==W&&(Z(),$(),J(t))},loading:U})}),ie]})]})};var s=i(a(57043)),r=i(a(35161)),o=i(a(24350)),l=a(96502),d=a(67294),c=i(a(14505)),u=n(a(61379)),h=a(69162),f=i(a(55454)),p=i(a(17747)),m=i(a(9042)),g=a(55588),v=a(92231),C=n(a(13540)),_=i(a(89178)),x=i(a(40854)),S=i(a(47193)),y=a(12950),E=a(39e3),j=i(a(24516)),I=i(a(2408)),T=i(a(55325)),b=i(a(17605)),P=a(49201),M=a(35371),w=a(49002),L=i(a(38853)),k=i(a(29579)),O=i(a(865)),A=a(85893)},26456:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t;const a=(0,v.default)(),[n,s]=(0,r.useState)(null===(t=h.LabelCollection.labelColorPalette)||void 0===t?void 0:t.colors),u=(0,r.useRef)(null);(0,r.useEffect)((()=>((0,p.default)(h.LabelCollection.getLabelColorPalette(),a).then((e=>{s(e)})).catch((0,i.catchAbort)((()=>{}))),()=>{var e;null===(e=u.current)||void 0===e||e.cancel()})),[]);let g=(0,C.jsx)(m.Spinner,{stroke:6,size:24});n&&(g=(0,C.jsx)(x,{labelId:e.labelId,onBack:e.onClose,onUpdateColor:e.onUpdateColor,colors:n,currentColor:e.currentColor}));return(0,C.jsxs)(o.default,{children:[(0,C.jsx)(d.DrawerHeader,{title:c.default.t(1078),onBack:e.onClose,type:d.DRAWER_HEADER_TYPE.LARGE}),(0,C.jsx)(l.default,{children:(0,C.jsx)("div",{className:f.default.container,children:g})})]})};var i=a(96502),s=n(a(94184)),r=a(67294),o=n(a(17747)),l=n(a(9042)),d=a(55588),c=n(a(2408)),u=a(14137),h=a(59606),f=n(a(45227)),p=n(a(79267)),m=a(46714),g=n(a(2966)),v=n(a(29579)),C=a(85893);function _(e){const{onUpdateColor:t,labelId:a,colorInt:n,onBack:i}=e,[o,l]=(0,r.useState)(!1),d=e.isSelected?(0,C.jsx)(g.default,{name:"checkmark-medium"}):null,c=()=>{o||l(!0)},p=(0,s.default)(f.default.wallpaperColorCanvas,{[f.default.canvasHover]:o,[f.default.canvasActive]:e.isSelected});return(0,C.jsx)("span",{className:p,style:{backgroundColor:(0,u.intColorToHex)(e.colorInt)},onMouseOver:c,onMouseEnter:c,onMouseLeave:()=>{o&&l(!1)},onClick:()=>{t({id:a,color:n},h.LABEL_PROPERTIES.COLOR),i()},children:d})}function x(e){const{currentColor:t,colors:a}=e,n=a.map((a=>(0,C.jsx)(_,{onUpdateColor:e.onUpdateColor,colorInt:a,onBack:e.onBack,labelId:e.labelId,isSelected:t===a},a)));for(let e=0;e<2;e++)n.push((0,C.jsx)("div",{className:f.default.wallpaperColorEmpty},"emptyEl"+e));return n}},35355:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{onDeleteLabel:t}=e,[a,n]=(0,i.useState)(0),y=(0,x.default)((()=>new v.default([],(e=>e.id))));(0,i.useEffect)((()=>{(0,f.logLabelOperationEvent)(p.default.LABEL_OPERATIONS.VIEW,void 0,p.default.LABEL_TARGETS.LABELS_SCREEN)}),[]);const E=()=>{const e=y.current.getSelected();(0,f.logLabelOperationEvent)(p.default.LABEL_OPERATIONS.VIEW,e.length,p.default.LABEL_TARGETS.DELETE_LABEL_DIALOG),s.Cmd.openModal((0,S.jsx)(r.default,{okText:u.default.t(2335),cancelText:u.default.t(2189),onCancel:()=>{(0,f.logLabelOperationEvent)(p.default.LABEL_OPERATIONS.CLICK_NEGATIVE,1,p.default.LABEL_TARGETS.DELETE_LABEL_DIALOG),s.Cmd.closeModal()},onOK:()=>{(0,f.logLabelOperationEvent)(p.default.LABEL_OPERATIONS.CLICK_POSITIVE,1,p.default.LABEL_TARGETS.DELETE_LABEL_DIALOG),(e=>{s.Cmd.closeModal(),y.current.unsetAll(),t(e)})(e)},children:u.default.t(709,{_plural:e.length})}))},j=()=>{y.current.unsetAll(),n(0)};let I=null;I=a>0?(0,S.jsx)(m.default,{selectedModels:y.current,onCancel:j,onDelete:E,theme:"drawer-header"}):(0,S.jsx)(d.DrawerHeader,{title:u.default.t(1089),onBack:e.onClose,type:d.DRAWER_HEADER_TYPE.LARGE});const T=(0,c.canEditLabel)()&&(0,S.jsx)("div",{className:h.default.addLabelBtContainer,children:(0,S.jsx)(C.Round,{large:!0,onClick:e.openAddLabel,children:(0,S.jsx)(_.default,{name:"plus-large"})})});return(0,S.jsxs)(o.default,{theme:"settings",children:[I,(0,S.jsx)(l.default,{children:(0,S.jsx)(g.default,{shouldScrollIntoViewAndSelect:()=>({shouldScrollIntoView:!0,shouldSelect:!1}),selectedLabels:y.current,renderContext:"label-list",onMultiSelect:()=>{const e=y.current.getSelected().length;n(e)},onLabelClick:e.onLabelClick})}),T]})};var i=a(67294),s=a(69162),r=n(a(75940)),o=n(a(17747)),l=n(a(9042)),d=a(55588),c=a(78615),u=n(a(2408)),h=n(a(44676)),f=a(12735),p=n(a(4231)),m=n(a(904)),g=n(a(99385)),v=n(a(66329)),C=a(3132),_=n(a(2966)),x=n(a(79939)),S=a(85893)},19049:(e,t,a)=>{"use strict";var n=a(95318);t.Z=function(e){const{labelId:t,openLabelColorDrawer:a,onEditLabel:n,onRemoveLabel:u}=e,h=(0,I.default)(),f=(0,T.default)((()=>new y.default([],(e=>e.id.toString())))).current;(0,b.useListener)(f,"all",(()=>h())),(0,i.useEffect)((()=>{(0,g.logLabelOperationEvent)(_.default.LABEL_OPERATIONS.VIEW,void 0,_.default.LABEL_TARGETS.LABEL_DETAILS_SCREEN)}),[]);const C=()=>{f.unsetAll()},j=()=>{const e=f.getSelected();(0,g.logLabelOperationEvent)(_.default.LABEL_OPERATIONS.CLICK_NEGATIVE,e.length,_.default.LABEL_TARGETS.BULK_UNLABEL_DIALOG),r.Cmd.closeModal()},w=(e=>{let t,a;for(let n=0;n<e.length;n++){if(e[n]instanceof S.Msg?a=!0:t=!0,t&&a)return!0}return!1})(f.getSelected()),L=f.getSelected().length>0?(0,P.jsx)(x.default,{labelEditEnabled:!w,onRemoveLabel:()=>{const e=f.getSelected();if(!u)return;const a=m.LabelCollection.assertGet(t);(0,g.logLabelOperationEvent)(_.default.LABEL_OPERATIONS.VIEW,e.length,_.default.LABEL_TARGETS.BULK_UNLABEL_DIALOG),r.Cmd.openModal((0,P.jsx)(o.default,{title:p.default.t(1564,{count:e.length,labelName:a.name,_plural:e.length}),okText:p.default.t(2192),cancelText:p.default.t(1999),onCancel:j,onOK:()=>((e,t)=>{r.Cmd.closeModal(),C(),u(e,t),(0,g.logLabelOperationEvent)(_.default.LABEL_OPERATIONS.CLICK_POSITIVE,t.length,_.default.LABEL_TARGETS.BULK_UNLABEL_DIALOG)})(t,e)}))},selectedModels:f,onCancel:C,theme:"drawer-header"}):(0,P.jsx)(c.DrawerHeader,{onBack:e.onClose,menu:(0,P.jsx)(M,{openColorPicker:()=>{const e=m.LabelCollection.assertGet(t);a(t,e.color)},openEditLabel:()=>{n&&n(t)}}),type:c.DRAWER_HEADER_TYPE.LABELS,children:(0,P.jsx)(v.Labels,{labels:[e.labelId],renderAsCircle:!0,showName:!0,theme:"drawer-title"})});return(0,P.jsxs)(l.default,{theme:"settings",children:[L,(0,P.jsx)(d.default,{children:(0,P.jsx)(s.default,{hideMultiSelectBar:!0,multiSelection:f,labelFilter:e.labelId,settings:E.default,selectable:!0})})]})};var i=a(67294),s=n(a(48392)),r=a(69162),o=n(a(75940)),l=n(a(17747)),d=n(a(9042)),c=a(55588),u=a(9492),h=a(47452),f=a(78615),p=n(a(2408)),m=a(59606),g=a(12735),v=a(84498),C=a(47941),_=n(a(4231)),x=n(a(904)),S=a(92954),y=n(a(66329)),E=n(a(87947)),j=n(a(2966)),I=n(a(45172)),T=n(a(79939)),b=a(61192),P=a(85893);function M({openColorPicker:e,openEditLabel:t}){return(0,f.canEditLabel)()?(0,P.jsx)(C.MenuBarItem,{a8nText:"starred-menu",icon:(0,P.jsx)(j.default,{name:"menu"}),title:p.default.t(1225),children:(0,P.jsxs)(u.Dropdown,{type:"dropdown_menu",flipOnRTL:!0,dirX:u.DirX.LEFT,children:[(0,P.jsx)(h.DropdownItem,{a8n:"menu-item",action:e,children:p.default.t(1078)}),(0,P.jsx)(h.DropdownItem,{a8n:"menu-item",action:t,children:p.default.t(758)})]},"labelChooseColor")}):null}},75402:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{onOk:t}=e,[a,n]=(0,i.useState)(void 0);let f,p;(0,i.useEffect)((()=>{}),[]),a||(f=(0,h.jsx)("div",{className:l.default.spinner,children:(0,h.jsx)(c.Spinner,{size:50,stroke:4})},"spinner"));a&&(p=(0,h.jsx)("div",{className:l.default.textContainer,children:a}));return(0,h.jsx)(r.default,{okText:o.default.t(2192),onOK:()=>{null==t||t(),s.Cmd.closeModal()},type:d.ModalTheme.Flex,children:(0,h.jsxs)("div",{className:l.default.container,children:[(0,h.jsx)(u.TextSpan,{theme:"popup-title",children:o.default.t(1092)}),p,f]})})};var i=a(67294),s=a(69162),r=n(a(75940)),o=n(a(2408)),l=n(a(64677)),d=a(79475),c=a(46714),u=a(97504),h=a(85893)},66951:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.Cluster=t.ID_SEPARATOR=void 0;var i=n(a(55765)),s=a(20651);t.ID_SEPARATOR=",";t.Cluster=class{constructor(...e){this.participants=new i.default,e.forEach((e=>this.add(e)))}get id(){return this.participants.map((({id:e})=>e.toString())).join(",")}get center(){const e=this.participants.map((({lat:e})=>e)),t=this.participants.map((({lng:e})=>e));return{lat:(Math.min(...e)+Math.max(...e))/2,lng:(Math.min(...t)+Math.max(...t))/2}}get lat(){return this.center.lat}get lng(){return this.center.lng}get length(){return this.participants.length}get northeast(){const e=this.participants.map((({lat:e})=>e)),t=this.participants.map((({lng:e})=>e));return{lat:Math.max(...e),lng:Math.max(...t)}}get southwest(){const e=this.participants.map((({lat:e})=>e)),t=this.participants.map((({lng:e})=>e));return{lat:Math.min(...e),lng:Math.min(...t)}}add(e){this.participants.add(e)}hasSingleParticipant(){return 1===this.length}fits(e,t,a){const{lat:n,lng:i}=this.center,{lat:r,lng:o}=e,l=(0,s.getMetersBetweenLatLngs)(n,i,n,o),d=(0,s.getMetersBetweenLatLngs)(n,i,r,i),c=(0,s.getMetersPerPixel)(n,t);return l/c<=a&&d/c<=a}}},84871:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{onParticipantSelected:t,participants:a}=e,n=(0,p.default)((()=>new d.default));return(0,m.jsxs)("div",{className:i.default.container,children:[(0,m.jsxs)("div",{className:i.default.header,children:[(0,m.jsx)("div",{className:i.default.left,children:(0,m.jsx)("span",{className:i.default.close,onClick:e.onClearSelected,children:(0,m.jsx)(h.default,{name:"x"})})}),(0,m.jsx)("div",{className:i.default.right,children:c.default.t(1098,{count:e.participants.length,_plural:e.participants.length})})]}),(0,m.jsx)(l.default,{className:i.default.list,flatListControllers:[n.current],children:(0,m.jsx)(o.FlatList,{data:a.map((e=>({itemKey:e.id.toString(),participant:e}))),flatListController:n.current,direction:"vertical",defaultItemHeight:48,renderItem:e=>{const{participant:a}=e,n=a.isMe?(0,m.jsx)("div",{className:i.default.time,children:(0,m.jsx)(r.default,{reason:"live-location-time",children:(0,m.jsx)(f.default,{participant:a})})}):null;return(0,m.jsxs)("div",{className:i.default.item,onClick:()=>t(a.contact.id.toString()),children:[(0,m.jsx)("div",{className:i.default.left,children:(0,m.jsx)(s.DetailImage,{id:a.contact.id,size:28})}),(0,m.jsxs)("div",{className:i.default.right,children:[(0,m.jsx)("div",{className:i.default.name,children:(0,m.jsx)(u.Name,{contact:a.contact,titlify:!0,ellipsify:!0,you:!0})}),n]})]})}})})]})};var i=n(a(14395)),s=a(88419),r=n(a(34295)),o=a(86025),l=n(a(19257)),d=n(a(67893)),c=n(a(2408)),u=a(78972),h=n(a(2966)),f=n(a(95395)),p=n(a(79939)),m=a(85893)},11103:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.cluster=function(e,t,a,n){const r=new Map;if(!e.length)return r;const o=e.filter((e=>e!==a)).sort(((e,t)=>e.lat-t.lat));for(let e=0;e<o.length;e++){const a=o[e];let l;if(r.forEach((e=>{!l&&e.fits(a,t,n)&&(l=e)})),l){const e=l,t=l.id;r.delete(t),e.add(a)}else l=new s.Cluster(a);r.set((0,i.default)(l,"clusterToAdd").id,(0,i.default)(l,"clusterToAdd"))}if(a&&e.length!==o.length){const e=new s.Cluster(a);r.set(e.id,e)}return r},t.participantInCluster=function(e,t){return e.split(s.ID_SEPARATOR).includes(t.toString())},t.singleParticipantClusterId=function(e){return!e.includes(s.ID_SEPARATOR)},t.findClusterForParticipant=function(e,t){let a;const n=e.values();for(;(a=n.next())&&!a.done;){const e=a.value;if(e.participants.get(t))return e}return null};var i=n(a(48158)),s=a(66951)},32295:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getSmallestElapsedTime=a,t.isStale=function(e){return a(e)>=600},t.MARKER_SIZE=t.AVATAR_SIZE=t.PIN_SIZE=t.GLOW_SIZE=t.IMAGE_BORDER_SIZE=t.IMAGE_SIZE=t.STALE_THRESHOLD=void 0;t.STALE_THRESHOLD=600;t.IMAGE_SIZE=40;t.IMAGE_BORDER_SIZE=2;t.GLOW_SIZE=4;t.PIN_SIZE=4;t.AVATAR_SIZE=44;function a(e){const t=e.participants.map((e=>e.elapsedTime()));return Math.min(...t)}t.MARKER_SIZE=52},82701:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(67294),s=a(25142),r=n(a(17747)),o=n(a(9042)),l=a(55588),d=n(a(52087)),c=n(a(34600)),u=n(a(2408)),h=a(71681),f=n(a(28526)),p=a(38665),m=n(a(93233)),g=n(a(40298)),v=n(a(79485)),C=n(a(2966)),_=a(85893);class x extends i.PureComponent{constructor(e){super(e),this.onClose=()=>{this.props.onClose?this.props.onClose():this.props.uim.uie.requestDismiss()},this.onRoadmapSelected=()=>{this.setState({mapType:p.MapType.ROADMAP})},this.onSatelliteSelected=()=>{this.setState({mapType:p.MapType.SATELLITE})},this.onTerrainSelected=()=>{this.setState({mapType:p.MapType.TERRAIN})},this.onTrafficToggled=()=>{this.setState((e=>({showTraffic:!e.showTraffic})))},this.onMarkerSelected=e=>{this.setState({markerSelected:e})},this.state={mapType:p.MapType.ROADMAP,showTraffic:!1,markerSelected:!1,online:g.default.online}}componentDidMount(){this.props.listeners.add(g.default,"change:online",(()=>{this.setState({online:g.default.online})}))}render(){const e=(0,_.jsx)(m.default,{onRoadmapSelected:this.onRoadmapSelected,onSatelliteSelected:this.onSatelliteSelected,onTerrainSelected:this.onTerrainSelected,onTrafficToggled:this.onTrafficToggled,showTraffic:this.state.showTraffic}),{finalLat:t,finalLng:a,finalTimeOffset:n,lat:i,lng:d,senderObj:h,t:p}=this.props.msg,{mapType:g,showTraffic:v,markerSelected:x,online:S}=this.state;let y,E,j,I;return void 0===t||void 0===a||void 0===n?(y=i,E=d,j=p):(y=t,E=a,j=p+n),I=S?(0,_.jsxs)("div",{className:c.default.wrapper,children:[(0,_.jsx)(f.default,{contact:h,lat:y,lng:E,mapType:g,showTraffic:v,markerSelected:x,onMarkerSelected:this.onMarkerSelected}),(0,_.jsxs)("div",{className:c.default.notification,children:[(0,_.jsx)("div",{className:c.default.ended,children:u.default.t(1099)}),(0,_.jsx)("div",{className:c.default.lastUpdated,children:s.Clock.liveLocationLastUpdatedStr(j)})]})]}):(0,_.jsx)("div",{className:c.default.offline,children:(0,_.jsxs)("div",{children:[(0,_.jsx)("div",{className:c.default.circle,children:(0,_.jsx)(C.default,{name:"live-location-disconnected"})}),(0,_.jsx)("div",{className:c.default.text,children:u.default.t(1151)})]})}),(0,_.jsxs)(r.default,{children:[(0,_.jsx)(l.DrawerHeader,{title:u.default.t(1100),type:l.DRAWER_HEADER_TYPE.SMALL,menu:e,onCancel:this.onClose}),(0,_.jsx)(o.default,{children:I})]})}}x.CONCERNS={msg:["finalLat","finalLng","finalTimeOffset","lat","lng","senderObj","t"]},x.displayName="ExpiredLocationDrawer";var S=(0,d.default)((0,h.ListenerHOC)((0,v.default)(x,x.CONCERNS)));t.default=S},28526:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(58695),s=a(67294),r=a(33458),o=a(38665),l=n(a(42599)),d=a(85893);class c extends s.Component{constructor(e){super(e),this.setMap=e=>this.map=e,this.mapOnClick=()=>{this.dismissMarkerTimer.debounceAndCap(50,100)},this.markerOnClick=()=>{this.dismissMarkerTimer.isScheduled()&&this.dismissMarkerTimer.cancel(),this.props.onMarkerSelected(!0)},this.getPixelPositionOffset=(e,t)=>({x:-e/2,y:-t}),this.dismissMarkerTimer=new i.ShiftTimer((()=>{this.props.markerSelected&&this.props.onMarkerSelected(!1)}))}componentWillUnmount(){this.dismissMarkerTimer.isScheduled()&&this.dismissMarkerTimer.cancel()}getMapPaneName(){return r.OverlayView.OVERLAY_MOUSE_TARGET}getMarkers(){const{lat:e,lng:t,contact:a,markerSelected:n}=this.props;return(0,d.jsx)(l.default,{marker:{isLive:!1,contact:a,lat:e,lng:t,selected:n,onClick:e=>this.markerOnClick(e)}})}getTrafficLayer(){return this.props.showTraffic?(0,d.jsx)(r.TrafficLayer,{autoRefresh:!0}):null}render(){const{lat:e,lng:t}=this.props;return(0,d.jsxs)(r.GoogleMap,{ref:this.setMap,defaultCenter:{lat:e,lng:t},defaultOptions:this.props.getMapOptions(),defaultZoom:o.INITIAL_ZOOM,mapTypeId:this.props.mapType,onClick:this.mapOnClick,children:[this.getMarkers(),this.getTrafficLayer()]})}}c.displayName="ExpiredLocationMap";var u=(0,o.withConfig)((0,r.withScriptjs)((0,r.withGoogleMap)(c)));t.default=u},32129:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a(41609)),s=n(a(23493)),r=n(a(94184)),o=a(67294),l=n(a(84871)),d=a(11103),c=a(69162),u=a(32295),h=n(a(17747)),f=n(a(9042)),p=a(55588),m=n(a(52087)),g=n(a(85529)),v=n(a(2408)),C=a(71681),_=n(a(70998)),x=n(a(82930)),S=a(38665),y=n(a(93233)),E=n(a(40298)),j=n(a(34060)),I=n(a(39860)),T=n(a(79485)),b=a(15298),P=n(a(2966)),M=n(a(69217)),w=a(49201),L=n(a(69635)),k=a(89573),O=a(85893);const A=["click","mousedown","mousemove","scroll"],D="ACTIVE",R="INACTIVE",N="OFFLINE";class F extends o.PureComponent{constructor(e){super(e),this._onParticipantAdd=()=>{const{zoomLevel:e,selectedParticipantId:t}=this.state;this._updateMinZoomClusters(),this.setState({clusters:this._getClusters(e,t)})},this.onParticipantRemove=e=>{const{selectedClusterId:t,selectedParticipantId:a,zoomLevel:n}=this.state;this._updateMinZoomClusters();let i=t,s=a;t&&(0,d.participantInCluster)(t,e.id)&&(i=null),L.default.equals(a,e.id)&&(s=null),this.setState({selectedClusterId:i,selectedParticipantId:s,clusters:this._getClusters(n,s)})},this._onParticipantDisable=e=>{if(!e.isMe){const t=e.contact.formattedName;c.Cmd.openToast((0,O.jsx)(w.Toast,{msg:v.default.t(1124,{name:t}),id:(0,w.genId)()}))}},this.onLocationChanged=()=>{const{zoomLevel:e,selectedParticipantId:t}=this.state;this._updateMinZoomClusters(),this.setState({clusters:this._getClusters(e,t)})},this.onIdle=()=>{const{liveLocation:e}=this.props.chat;e&&(e.stopViewingMap(),this.setState({status:R}))},this.onActivity=(0,s.default)((()=>{this._removeIdleTimeout(),this._addIdleTimeout()}),250),this._onRefresh=()=>{const{liveLocation:e}=this.props.chat;e&&(e.startViewingMap(),this.setState({status:D}))},this.onClose=()=>{this.props.onClose?this.props.onClose():this.props.uim.uie.requestDismiss()},this.onMarkerSelected=e=>{e?(0,d.singleParticipantClusterId)(e)?this.onParticipantSelected(e):this._onClusterSelected(e):this.onClearSelected()},this.onClearSelected=()=>{const{selectedParticipantId:e,selectedClusterId:t,zoomLevel:a}=this.state;(e||t)&&this.setState({selectedParticipantId:null,selectedClusterId:null,clusters:this._getClusters(a)})},this._onClusterSelected=e=>{this.state.selectedClusterId!==e&&this.setState({selectedParticipantId:null,selectedClusterId:e})},this.onParticipantSelected=e=>{const{selectedParticipantId:t,zoomLevel:a}=this.state,n=(0,k.createWid)(e);L.default.equals(t,n)||this.setState({selectedParticipantId:n,selectedClusterId:null,clusters:this._getClusters(a,n)})},this.onStopSharing=e=>{e.preventDefault(),e.stopPropagation();const{chat:t}=this.props;c.Cmd.openModal((0,O.jsx)(_.default,{chat:t}))},this.onRoadmapSelected=()=>{this.setState({mapType:S.MapType.ROADMAP})},this.onSatelliteSelected=()=>{this.setState({mapType:S.MapType.SATELLITE})},this.onTerrainSelected=()=>{this.setState({mapType:S.MapType.TERRAIN})},this.onTrafficToggled=()=>{this.setState((e=>({showTraffic:!e.showTraffic})))},this._onBackToCenter=()=>{this.setState({selectedParticipantId:null,selectedClusterId:null,atCenter:!0,clusters:this._getClusters(this.state.zoomLevel)})},this.onMapMoved=(e,t)=>{this.setState((a=>{const n={};if(a.zoomLevel!==e){const t=this._getClusters(e,a.selectedParticipantId);Object.assign(n,{zoomLevel:e,clusters:t})}return this._hasValidParticipants()&&a.atCenter!==t&&Object.assign(n,{atCenter:t}),(0,i.default)(n)?null:n}))},this._updateMinZoomClusters(),this.state={clusters:this._getClusters(S.INITIAL_ZOOM),selectedClusterId:null,selectedParticipantId:null,mapType:S.MapType.ROADMAP,showTraffic:!1,zoomLevel:S.INITIAL_ZOOM,atCenter:!0,status:E.default.online?D:N}}componentDidMount(){this._listenToModelChange(),this._listenToNetworkChange(),this._startCheckingForIdle();const{liveLocation:e}=this.props.chat;e&&(e.startViewingMap(),this._addParticipantListeners(e))}componentWillUnmount(){this.onActivity.cancel();const{liveLocation:e}=this.props.chat;e&&e.stopViewingMap()}_addParticipantListeners(e){this.props.listeners.add(e.participants,"add",this._onParticipantAdd),this.props.listeners.add(e.participants,"remove",this.onParticipantRemove),this.props.listeners.add(e.participants,"change:disabled",this._onParticipantDisable),this.props.listeners.add(e.participants,"change:valid",this.onLocationChanged)}_removeParticipantListeners(e){this.props.listeners.remove(e.participants,"add",this._onParticipantAdd),this.props.listeners.remove(e.participants,"remove",this.onParticipantRemove),this.props.listeners.remove(e.participants,"change:disabled",this._onParticipantDisable),this.props.listeners.remove(e.participants,"change:valid",this.onLocationChanged)}_listenToModelChange(){const{chat:e}=this.props;this.props.listeners.add((0,b.unproxy)(e),"change:liveLocation",(()=>{const{liveLocation:t}=e;t&&(this._removeParticipantListeners(t),this._addParticipantListeners(t));const{zoomLevel:a}=this.state;this.setState({clusters:this._getClusters(a)})}))}_listenToNetworkChange(){this.props.listeners.add(E.default,"change:online",(()=>{E.default.online||this._stopCheckingForIdle(),this.setState({status:E.default.online?D:N})}))}_startCheckingForIdle(){this._addIdleTimeout(),this._addActivityListeners()}_stopCheckingForIdle(){this._removeIdleTimeout(),this._removeActivityListeners()}_addIdleTimeout(){this._idleTimeoutId=this.props.setTimeout(this.onIdle,18e4)}_removeIdleTimeout(){null!=this._idleTimeoutId&&this.props.clearTimeout(this._idleTimeoutId),this._idleTimeoutId=null}_addActivityListeners(){A.forEach((e=>{this.props.listeners.add(document,e,this.onActivity)}))}_removeActivityListeners(){A.forEach((e=>{this.props.listeners.remove(document,e,this.onActivity)}))}_updateMinZoomClusters(){const e=this.getParticipants(),t=e?e.validLocations():[];this._minZoomClusters=(0,d.cluster)(t,S.MIN_ZOOM,null,u.MARKER_SIZE)}getParticipants(){const{liveLocation:e}=this.props.chat;return e?e.participants:null}_hasValidParticipants(){const e=this.getParticipants();return!!e&&!!e.validLocations().length}_getOpenFromCluster(){const e=this.getParticipants();if(!e||0===e.length)return null;const{openFrom:t}=this.props;let a=null;if(t)a=t;else{const t=e.at(0);t&&(a=t.id)}return a?(0,d.findClusterForParticipant)(this._minZoomClusters,a):null}_getClusters(e,t){const a=this.getParticipants();let n=null,i=[];a&&(t&&(n=a.get(t)),i=a.validLocations());let s=i,r=[];if(this._minZoomClusters.size>1){const e=this._getOpenFromCluster();if(e){const t=e.participants;s=t.validLocations(),r=i.filter((({id:e})=>!t.get(e)))}}return{primary:(0,d.cluster)(s,e,n,u.MARKER_SIZE),secondary:(0,d.cluster)(r,e,n,u.MARKER_SIZE)}}_getList(){const{clusters:e,selectedClusterId:t}=this.state,a=this.getParticipants();let n;if(null==a?void 0:a.length){if(t){const a=e.primary.get(t)||e.secondary.get(t);if(a){const e=a.participants;n=(0,O.jsx)(l.default,{participants:e,onParticipantSelected:this.onParticipantSelected,onClearSelected:this.onClearSelected})}}n||(n=(0,O.jsx)(j.default,{participants:a,onParticipantSelected:this.onParticipantSelected,onStopSharing:this.onStopSharing}))}return n}render(){let e,t;this.props.isFirstLevel?e=this.onClose:t=this.onClose;const{selectedParticipantId:a,selectedClusterId:n,mapType:i,showTraffic:s,atCenter:o,status:l}=this.state,d=l===D?(0,O.jsx)(y.default,{onRoadmapSelected:this.onRoadmapSelected,onSatelliteSelected:this.onSatelliteSelected,onTerrainSelected:this.onTerrainSelected,onTrafficToggled:this.onTrafficToggled,showTraffic:s}):null;let c,u;if(l===D||l===R){const e=a&&a.toString()||n;c=(0,O.jsxs)("div",{className:g.default.wrapper,children:[(0,O.jsx)("div",{className:(0,r.default)(g.default.backToCenter,{[g.default.visible]:!o}),onClick:this._onBackToCenter,children:(0,O.jsx)(P.default,{name:"return"})}),(0,O.jsx)(x.default,{clusters:this.state.clusters.primary,secondaryClusters:this.state.clusters.secondary,selectedMarkerId:e,openFrom:this.props.openFrom,mapType:i,showTraffic:s,atCenter:o,onMarkerSelected:this.onMarkerSelected,onClearSelected:this.onClearSelected,onLocationChanged:this.onLocationChanged,onMapMoved:this.onMapMoved}),this._getList()]})}if(l===R||l===N){const e=l===R,t=e?"live-location-refresh":"live-location-disconnected",a=e?v.default.t(1112):v.default.t(1151);u=(0,O.jsx)(I.default,{inactive:e,svgName:t,text:a,onClick:e?this._onRefresh:void 0})}return(0,O.jsxs)(h.default,{children:[(0,O.jsx)(p.DrawerHeader,{title:v.default.t(1125),type:p.DRAWER_HEADER_TYPE.SMALL,menu:d,onBack:t,onCancel:e}),(0,O.jsxs)(f.default,{children:[c,u]})]})}}F.CONCERNS={chat:["id","liveLocation"]},F.displayName="LiveLocationDrawer";var B=(0,m.default)((0,M.default)((0,C.ListenerHOC)((0,T.default)(F,F.CONCERNS))));t.default=B},82930:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a(23279)),s=a(58695),r=a(67294),o=a(33458),l=a(38665),d=n(a(42599)),c=a(20651),u=a(85893);const h=1e-4;class f extends r.Component{constructor(e){super(e),this.setMap=e=>this.map=e,this.handleLocationChanged=e=>{const{clusters:t,atCenter:a,selectedMarkerId:n}=this.props;if(this.props.onLocationChanged(),!n&&a)this._viewAllClusters();else if(n&&n===e){const e=t.get(n);e&&this._viewSingleCluster(e)}},this.handleIdle=(0,i.default)((()=>{const e=this.map;if(!e)return;const t=e.getZoom();if(this._zoomingToAllClusters){this._defaultZoomLevel=t,this._zoomingToAllClusters=!1;const e=this._zoomHistory;if(e.prev.preZoom===e.curr.postZoom&&e.prev.postZoom===e.curr.preZoom)return}this.props.onMapMoved(t,this.atCenter())}),100),this.handleDragStart=()=>{const e=this.map;if(!e)return;const t=e.getZoom();this.props.onMapMoved(t,!1)},this.handleResize=(0,i.default)((()=>{this._setMapLatLngDiff()}),250),this.mapOnClick=()=>{this.dismissMarkerTimer.debounceAndCap(50,100)},this.markerOnClick=(e,t)=>{this.dismissMarkerTimer.isScheduled()&&this.dismissMarkerTimer.cancel(),this.props.onMarkerSelected(t)},this.dismissMarkerTimer=new s.ShiftTimer((()=>{this.props.selectedMarkerId&&this.props.onClearSelected()})),this._defaultLatDiff=this._defaultLngDiff=.01,this._defaultZoomLevel=-1,this._zoomingToAllClusters=!1,this._zoomHistory={prev:{preZoom:-1,postZoom:-1},curr:{preZoom:-1,postZoom:-1}}}componentWillUnmount(){this.handleIdle.cancel(),this.handleResize.cancel(),window.removeEventListener("resize",this.handleResize),this.dismissMarkerTimer.isScheduled()&&this.dismissMarkerTimer.cancel()}componentDidMount(){window.addEventListener("resize",this.handleResize),this._setMapLatLngDiff(),this._viewAllClusters()}componentDidUpdate(e){const{clusters:t,secondaryClusters:a,selectedMarkerId:n,atCenter:i}=this.props,{selectedMarkerId:s}=e;if(this._setMapLatLngDiff(),t.size&&(!s||n||i))if(n&&s!==n){const e=t.get(n)||a.get(n);e&&this._viewSingleCluster(e)}else!n&&i&&this._viewAllClusters()}_viewAllClusters(){const{clusters:e}=this.props;0===e.size||this.atCenter()||(this._zoomToFitAllClusters(e),this._centerAllClusters(e))}_viewSingleCluster(e){this._zoomToFitSingleCluster(e),this._centerSingleCluster(e)}_zoomToFitAllClusters(e){const t=this.map;if(!t)return;this._zoomingToAllClusters=!0,this._zoomHistory.prev.preZoom=this._zoomHistory.curr.preZoom,this._zoomHistory.curr.preZoom=t.getZoom();const a=this.getBounds(e),n=e.entries().next();if(1!==e.size||n.done)this._boundsTooSmall(a)?t.fitBounds(this._getDefaultBounds(a.getCenter())):t.fitBounds(a);else{const[,e]=n.value;this._zoomToFitSingleCluster(e,!1)}this._zoomHistory.prev.postZoom=this._zoomHistory.curr.postZoom,this._zoomHistory.curr.postZoom=t.getZoom()}_zoomToFitSingleCluster(e,t=!0){const a=this.map;if(!a)return;if(t&&this._boundsTooSmall(a.getBounds()))return;const n=e.northeast,i=e.southwest,s=new google.maps.LatLng(n.lat,n.lng),r=new google.maps.LatLng(i.lat,i.lng),o=new google.maps.LatLngBounds(r,s);this._boundsTooSmall(o)?a.fitBounds(this._getDefaultBounds(o.getCenter())):a.fitBounds(o)}_centerAllClusters(e){const t=this.getBounds(e).getCenter();this._centerMap(t)}_centerSingleCluster(e){const t=new google.maps.LatLng(e.center);this._centerMap(t)}_centerMap(e){const t=this.map;t&&(t.getCenter().equals(e)||t.panTo(e))}_getInitialCenter(){return this.getBounds(this.props.clusters).getCenter()}getBounds(e){const t=new google.maps.LatLngBounds;return e.forEach((e=>{t.extend({lat:e.lat,lng:e.lng})})),t}_boundsTooSmall(e){const t=e.getNorthEast(),a=e.getSouthWest(),n=t.lat()-a.lat(),i=t.lng()-a.lng(),s=Math.abs(n)<this._defaultLatDiff,r=Math.abs(i)<this._defaultLngDiff;return s||r}_getDefaultBounds(e){const t=new google.maps.LatLng(e.lat()-this._defaultLatDiff/2,e.lng()-this._defaultLngDiff/2),a=new google.maps.LatLng(e.lat()+this._defaultLatDiff/2,e.lng()+this._defaultLngDiff/2);return new google.maps.LatLngBounds(t,a)}atCenter(){const e=this.map;if(!e)return!0;const t=e.getCenter(),a=this._getInitialCenter(),n=t.lat()-a.lat(),i=t.lng()-a.lng();return Math.abs(n)<h&&Math.abs(i)<h&&this._defaultZoomLevel===e.getZoom()}_setMapLatLngDiff(){const e=this.map;if(!e)return;const t=e.getCenter(),a=e.getDiv(),n=(0,c.getMetersPerPixel)(t.lat(),l.INITIAL_ZOOM),i=a.offsetWidth*n,s=a.offsetHeight*n;this._defaultLatDiff=(0,c.getLatDiff)(s),this._defaultLngDiff=(0,c.getLngDiff)(i,t.lat())}getMarkers(){const{clusters:e,secondaryClusters:t,selectedMarkerId:a}=this.props,n=[],i=(e,t)=>{n.push((0,u.jsx)(d.default,{marker:{isLive:!0,cluster:e,onLocationChanged:()=>this.handleLocationChanged(t),selected:a===t,onClick:e=>this.markerOnClick(e,t)}},t))};return e.forEach(i),t.forEach(i),n}getTrafficLayer(){return this.props.showTraffic?(0,u.jsx)(o.TrafficLayer,{autoRefresh:!0}):null}render(){return(0,u.jsxs)(o.GoogleMap,{ref:this.setMap,defaultCenter:this._getInitialCenter(),defaultOptions:this.props.getMapOptions(),defaultZoom:l.INITIAL_ZOOM,mapTypeId:this.props.mapType,onClick:this.mapOnClick,onDragStart:this.handleDragStart,onIdle:this.handleIdle,children:[this.getMarkers(),this.getTrafficLayer()]})}}f.displayName="LiveLocationMap";var p=(0,l.withConfig)((0,o.withScriptjs)((0,o.withGoogleMap)(f)));t.default=p},38665:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.withConfig=function(e){return class extends s.Component{constructor(...e){super(...e),this.state={authFailed:!0===window.gm_authFailed},this._onAuthFailed=()=>{window.gm_authFailed=!0,this.setState({authFailed:!0});const e=this._getUrl();__LOG__(4,void 0,new Error,!0)`url: ${e}\ntarget: ${"web"}`,SEND_LOGS("google-map-auth-failed")}}componentDidMount(){window.gm_authFailure=this._onAuthFailed}componentWillUnmount(){window.gm_authFailure=void 0}_getUrl(){const e={client:"gme-whatsappinc",v:"3",libraries:"geometry,drawing,places",t:Math.floor(Date.now()/864e5)};return d.URL.build("https://maps.googleapis.com/maps/api/js",e)}getMapOptions(){return{clickableIcons:!1,fullscreenControl:!1,keyboardShortcuts:!1,mapTypeControl:!1,minZoom:3,streetViewControl:!1,zoomControl:!0,zoomControlOptions:{position:google.maps.ControlPosition.TOP_RIGHT}}}render(){if(this.state.authFailed)return(0,c.jsx)("div",{className:o.default.authFailed,children:r.default.t(915)});const t=this._getUrl(),a=(0,c.jsx)("div",{className:o.default.loading,children:(0,c.jsx)(l.Spinner,{color:"highlight"})}),n=(0,c.jsx)("div",{className:o.default.container}),s=(0,c.jsx)("div",{className:o.default.map});return(0,c.jsx)(e,(0,i.default)({googleMapURL:t,loadingElement:a,containerElement:n,mapElement:s,getMapOptions:this.getMapOptions},this.props))}}},t.MIN_ZOOM=t.INITIAL_ZOOM=t.MapType=void 0;var i=n(a(81109)),s=a(67294),r=n(a(2408)),o=n(a(98057)),l=a(46714),d=a(1458),c=a(85893);const u=a(54302)({ROADMAP:"roadmap",SATELLITE:"satellite",TERRAIN:"terrain"});t.MapType=u;t.INITIAL_ZOOM=15;t.MIN_ZOOM=3},42599:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a(94184)),s=a(67294),r=a(33458),o=n(a(12064)),l=a(32295),d=a(71681),c=n(a(48347)),u=n(a(89369)),h=n(a(69217)),f=n(a(64029)),p=a(85893);class m extends s.Component{constructor(e){super(e),this._setOverlay=e=>{this.overlay=e},this.handleLocationChanged=()=>{this.props.marker.isLive&&this.props.marker.onLocationChanged()},this._handleLastUpdatedTimeChanged=()=>{if(!this.props.marker.isLive)return;null!=this.timeoutId&&(this.props.clearTimeout(this.timeoutId),this.timeoutId=null);const e=(0,l.isStale)(this.props.marker.cluster);this.state.stale!==e&&this.setState({stale:e}),e||this._setStaleTimeout()},this._getPixelPositionOffset=(e,t)=>({x:-e/2,y:-t}),this.state={stale:!e.marker.isLive||(0,l.isStale)(e.marker.cluster)}}_setStaleTimeout(){if(!this.props.marker.isLive)return;const{cluster:e}=this.props.marker,t=l.STALE_THRESHOLD-(0,l.getSmallestElapsedTime)(e);t<=0||(this.timeoutId=this.props.setTimeout((()=>this.setState({stale:!0})),1e3*t))}componentDidMount(){if(!this.props.marker.isLive)return;const{cluster:e}=this.props.marker;(0,l.isStale)(e)||this._setStaleTimeout();e.participants.forEach((e=>{this.props.listeners.add(e,"change:lat change:lng",this.handleLocationChanged),this.props.listeners.add(e,"change:lastUpdated",this._handleLastUpdatedTimeChanged)}))}_getMapPaneName(){return this.props.marker.onClick?r.OverlayView.OVERLAY_MOUSE_TARGET:r.OverlayView.OVERLAY_LAYER}render(){let e,t,a,n;const{onClick:s,selected:d}=this.props.marker,{stale:h}=this.state;if(this.props.marker.isLive){const{cluster:n}=this.props.marker;e=n.lat,t=n.lng,a=n.participants.map((({id:e})=>e))}else e=this.props.marker.lat,t=this.props.marker.lng,a=[this.props.marker.contact.id];if(d){let a,i,s;if(this.props.marker.isLive){const{cluster:e}=this.props.marker,t=e.participants,n=e.hasSingleParticipant()?t.at(0):null;n&&(a=n.id,i=n.accuracy,s=n.isMe)}else{const{contact:e}=this.props.marker;a=e.id,s=e.isMe}a&&(n=(0,p.jsx)(u.default,{id:a,lat:e,lng:t,accuracy:i,isMe:s||!1,markerSize:l.MARKER_SIZE}))}return(0,p.jsx)(r.OverlayView,{ref:this._setOverlay,position:{lat:e,lng:t},mapPaneName:this._getMapPaneName(),getPixelPositionOffset:this._getPixelPositionOffset,children:(0,p.jsx)(f.default.Provider,{value:this.context,children:(0,p.jsxs)("div",{className:(0,i.default)(c.default.container,{[c.default.selected]:d}),onClick:s,children:[n,(0,p.jsx)("div",{className:(0,i.default)(c.default.glow,{[c.default.stale]:h,[c.default.expired]:!this.props.marker.isLive}),style:{height:l.AVATAR_SIZE,width:l.AVATAR_SIZE,padding:l.GLOW_SIZE},children:(0,p.jsx)("div",{children:(0,p.jsx)(o.default,{ids:a,size:l.IMAGE_SIZE,border:!0,showCount:!0})})}),(0,p.jsx)("div",{className:(0,i.default)(c.default.pin,{[c.default.selected]:d}),style:{height:l.PIN_SIZE,width:l.PIN_SIZE,marginLeft:(l.MARKER_SIZE-l.PIN_SIZE)/2}})]})})})}}m.contextType=f.default,m.displayName="LiveLocationMarker";var g=(0,h.default)((0,d.ListenerHOC)(m));t.default=g},93233:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,d.jsx)(o.MenuBarItem,{a8nText:"live-location-map-menu",icon:(0,d.jsx)(l.default,{name:"menu"}),title:r.default.t(1225),children:(0,d.jsxs)(i.Dropdown,{type:"dropdown_menu",flipOnRTL:!0,dirX:i.DirX.LEFT,dirY:i.DirY.BOTTOM,children:[(0,d.jsx)(s.DropdownItem,{a8n:"mi-roadmap-view menu-item",action:e.onRoadmapSelected,children:r.default.t(1106)}),(0,d.jsx)(s.DropdownItem,{a8n:"mi-satellite-view menu-item",action:e.onSatelliteSelected,children:r.default.t(1107)}),(0,d.jsx)(s.DropdownItem,{a8n:"mi-terrain-view menu-item",action:e.onTerrainSelected,children:r.default.t(1108)}),(0,d.jsx)(s.DropdownItem,{a8n:"mi-traffic menu-item",action:e.onTrafficToggled,children:e.showTraffic?r.default.t(1109):r.default.t(1110)})]})})};var i=a(9492),s=a(47452),r=n(a(2408)),o=a(47941),l=n(a(2966)),d=a(85893)},34060:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{onParticipantSelected:t,onStopSharing:a,participants:n}=e,m=(0,f.default)((()=>new d.default)),g=(0,i.useMemo)((()=>n.map((e=>({itemKey:e.id.toString(),contentKey:e.valid?"valid":"invalid",participant:e})))),[n]);return(0,p.jsx)(l.default,{className:u.default.list,flatListControllers:[m.current],children:(0,p.jsx)(o.FlatList,{data:g,renderItem:e=>{const{participant:n}=e,i=n.valid?(0,p.jsx)(r.default,{reason:"live-location-time",children:(0,p.jsx)(h.default,{participant:n})}):c.default.t(1133),o=n.valid?()=>t(n.contact.id.toString()):null,l=n.isMe?(0,p.jsx)("div",{onClick:a,className:u.default.stopSharingButton,children:c.default.t(1123)}):null;return(0,p.jsx)(s.Contact,{contact:n.contact,secondary:i,onClick:o,detail:l})},flatListController:m.current,direction:"vertical"})})};var i=a(67294),s=a(70521),r=n(a(34295)),o=a(86025),l=n(a(19257)),d=n(a(67893)),c=n(a(2408)),u=n(a(67493)),h=n(a(95395)),f=n(a(79939)),p=a(85893)},89369:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a(94184)),s=a(67294),r=a(69162),o=n(a(91547)),l=a(17025),d=a(47452),c=a(4919),u=a(62238),h=n(a(2408)),f=a(25281),p=a(78972),m=n(a(85753)),g=n(a(2966)),v=a(63477),C=n(a(68062)),_=a(85893);class x extends s.Component{constructor(e){super(e),this.mouseEnter=()=>{this.state.hover||this.setState({hover:!0})},this.mouseLeave=()=>{this.state.hover&&this.setState({hover:!1})},this._handleDirection=()=>{const{lat:e,lng:t}=this.props;(0,c.openExternalLink)((0,f.getDirectionUrl)(e,t))},this.handleMessage=()=>{const{id:e}=this.props;(0,u.findChat)(e).then((e=>{e.active&&r.Cmd.existsDrawerRight((e=>{e&&2===o.default.column&&r.Cmd.closeDrawerRight()})),r.Cmd.openChatFromUnread(e).then((t=>{t&&r.Cmd.focusChatTextInput(e)}))}))},this._handleContextOpen=e=>{const t=null==e?void 0:e.target;this.setState({contextMenu:{menu:this._getContextMenu(),anchor:t}})},this.handleContextClose=()=>{this.setState({contextMenu:!1})},this.state={hover:!1,contextMenu:!1}}_getContextMenu(){const e=[];return e.push((0,_.jsx)(d.DropdownItem,{a8n:"get-directions",action:this._handleDirection,children:h.default.t(882)},"direction")),e.push((0,_.jsx)(d.DropdownItem,{a8n:"send-message",action:this.handleMessage,children:h.default.t(1226)},"message")),e}render(){const{id:e,accuracy:t,isMe:a,markerSize:n}=this.props,s=l.ContactCollection.assertGet(e),r=(0,_.jsx)("div",{className:m.default.name,children:(0,_.jsx)(p.Name,{ellipsify:!0,you:!0,contact:s})}),o=null!=t?(0,_.jsx)("div",{className:m.default.status,children:h.default.t(1097,{accuracy:t,_plural:t})}):null,d=a?null:(0,_.jsx)("div",{onClick:this._handleContextOpen,className:m.default.menuButton,children:(0,_.jsx)(g.default,{name:"down"})}),c=(0,_.jsx)("div",{className:m.default.triangle}),u=!a&&this.state.contextMenu?(0,_.jsx)(v.UIE,{displayName:"LiveLocationPopupContextMenu",escapable:!0,popable:!0,requestDismiss:this.handleContextClose,children:(0,_.jsx)(C.default,{contextMenu:this.state.contextMenu})}):null;return(0,_.jsxs)("div",{className:(0,i.default)(m.default.container,{[m.default.twoLines]:!!o}),style:{transform:`translateX(calc(-50% + ${n/2}px))`},children:[(0,_.jsxs)("div",{className:m.default.popup,onMouseOver:this.mouseEnter,onMouseEnter:this.mouseEnter,onMouseDown:this.mouseLeave,onMouseUp:this.mouseEnter,onMouseLeave:this.mouseLeave,children:[r,o,d]}),c,u]})}}t.default=x,x.displayName="LiveLocationPopup"},39860:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,r.jsx)("div",{className:e.inactive?i.default.inactive:i.default.offline,onClick:e.onClick,children:(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:i.default.circle,children:(0,r.jsx)(s.default,{name:e.svgName})}),(0,r.jsx)("div",{className:i.default.text,children:e.text})]})})};var i=n(a(85529)),s=n(a(2966)),r=a(85893)},95395:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(67294),s=n(a(2408)),r=n(a(50589)),o=a(61192),l=a(33156),d=a(85893);const c=(e,t=!1)=>{let a=e;t&&(a+=59);const n=a%3600;return{hours:Math.floor(a/3600),minutes:Math.floor(n/60)}},u=e=>e.isMe?(e=>{const{hours:t,minutes:a}=c(e,!0);return t>0?a>0?s.default.t(1114,{hours:t,minutes:a}):s.default.t(1113,{hours:t,_plural:t}):s.default.t(1115,{minutes:a,_plural:a})})(e.remainingTime()):(e=>{const{hours:t,minutes:a}=c(e);return t>0?a>0?s.default.t(1127,{hours:t,minutes:a}):s.default.t(1126,{hours:t,_plural:t}):a>0?s.default.t(1129,{minutes:a,_plural:a}):s.default.t(1128)})(e.elapsedTime());var h=({participant:e})=>{const[t,a]=(0,i.useState)((()=>u(e)));(0,o.useListener)(e,e.isMe?"change:expiration":"change:lastUpdated",(e=>a(u(e))));const[n,s]=(0,r.default)((()=>a(u(e))),6e4),[c]=(0,l.useManualTimeout)((()=>{a(u(e)),n()})),{expiration:h,lastUpdated:f}=e;return(0,i.useEffect)((()=>{const t=(e=>e.isMe?e.remainingTime():e.elapsedTime())(e)%60;s(),c(1e3*t)}),[h,f]),(0,d.jsx)("span",{children:t})};t.default=h},20651:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getMetersBetweenLatLngs=function(e,t,i,s){const r=n(i-e),o=n(s-t),l=Math.sin(r/2)*Math.sin(r/2)+Math.cos(n(e))*Math.cos(n(i))*Math.sin(o/2)*Math.sin(o/2),d=2*Math.atan2(Math.sqrt(l),Math.sqrt(1-l));return a*d},t.getMetersPerPixel=function(e,t){return 156543.03392*Math.cos(e*Math.PI/180)*(1/2**t)},t.getLatDiff=function(e){return i(e/a)},t.getLngDiff=function(e,t){const s=a*Math.cos(n(t));return i(e/s)};const a=6371e3;function n(e){return e*(Math.PI/180)}function i(e){return e*(180/Math.PI)}},64827:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{modelsToUpdate:t,onLabelUpdateComplete:a}=e,n=(0,y.default)((()=>new C.default([],(e=>e.id)))),b=(0,s.useRef)(new Set),P=n.current,M=b.current,w=(0,S.default)(),L=(0,s.useMemo)((()=>{const e=(()=>{const e={};return t.forEach((t=>{const a=(0,_.unproxy)(t);a.labels&&a.labels.forEach((t=>{e[t]=e[t]?++e[t]:1}))})),e})();return(0,i.default)(e,(e=>e===t.length?I:e>0?T:j))}),[]),k=(0,E.jsx)(r.default,{a8nText:"popup-controls-ok",type:"primary",disabled:0===M.size,onClick:()=>{(0,f.logLabelOperationEvent)(m.default.LABEL_OPERATIONS.CLICK_POSITIVE,t.length,m.default.LABEL_TARGETS.LABEL_COMBINED_DIALOG);const e=P.list,n=P.selected,i=e.map(((e,t)=>({id:e.id,type:n[t]?"add":"remove"})));h.LabelCollection.addOrRemoveLabels(i,t),a&&a()},children:u.default.t(1614)},1),O=(0,E.jsx)(r.default,{a8nText:"popup-controls-cancel",type:"secondary",onClick:e.onCancel,children:u.default.t(1999)},0),A=(0,c.canEditLabel)()&&(0,E.jsx)("div",{className:p.default.newLabelBtn,children:(0,E.jsxs)(r.default,{a8nText:"popup-controls-cancel",type:"simplified",onClick:e.onAddNewLabel,children:[(0,E.jsx)(x.default,{name:"plus-large",className:p.default.plus,display:"inline"}),u.default.t(155)]},2)});return(0,E.jsx)(g.Modal,{type:g.ModalTheme.Tower,children:(0,E.jsxs)(o.default,{theme:"labels",children:[(0,E.jsx)(d.DrawerHeader,{title:u.default.t(1081),type:d.DRAWER_HEADER_TYPE.POPUP,onCancel:e.onCancel}),(0,E.jsx)(l.default,{"data-list-scroll-container":!0,theme:"padding",children:(0,E.jsx)(v.default,{shouldScrollIntoViewAndSelect:e.shouldScrollIntoViewAndSelect,initialLabelState:L,selectedLabels:P,renderContext:"label-selection",onLabelClick:e.onLabelClick,onMultiSelect:e=>{e&&(L[e]===T?M.add("{labelId}_changed"):M.has(e)?M.delete(e):M.add(e),w())}})}),A,(0,E.jsxs)("div",{className:p.default.actionBtns,children:[O,k]})]},"mange_label_modal")})};var i=n(a(66604)),s=a(67294),r=n(a(69991)),o=n(a(17747)),l=n(a(9042)),d=a(55588),c=a(78615),u=n(a(2408)),h=a(59606),f=a(12735),p=n(a(76747)),m=n(a(4231)),g=a(79475),v=n(a(99385)),C=n(a(66329)),_=a(15298),x=n(a(2966)),S=n(a(45172)),y=n(a(79939)),E=a(85893);const j=0,I=1,T=2},64170:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(67294),s=n(a(92508)),r=n(a(17747)),o=n(a(9042)),l=a(55588),d=n(a(2408)),c=a(85893);var u=(0,i.forwardRef)(((e,t)=>(0,c.jsxs)(r.default,{ref:t,children:[(0,c.jsx)(l.DrawerHeader,{a8n:"drawer-title-auto-download",title:d.default.t(194),onBack:e.onClose,type:l.DRAWER_HEADER_TYPE.LARGE}),(0,c.jsx)(o.default,{children:(0,c.jsx)(s.default,{},"auto-download")})]})));t.default=u},70718:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a(51463)),s=a(67294),r=n(a(56720)),o=n(a(76610)),l=n(a(17747)),d=n(a(9042)),c=a(55588),u=n(a(25061)),h=n(a(61136)),f=n(a(2408)),p=a(45605),m=n(a(76870)),g=a(3132),v=a(65565),C=n(a(2966)),_=a(29458),x=n(a(82669)),S=a(85893);const y={marginTop:"ignnouf6",marginEnd:"bcfko8ch",marginBottom:"bibl1e27",marginStart:"dl2ettod"},E={zIndex:"b9fczbqn",display:"p357zi0d",justifyContent:"j1p1mz06",paddingBottom:"hjz8m82x",marginTop:"ignnouf6",textAlign:"qfejxiq4"};var j=(0,s.forwardRef)((e=>{const t=(0,s.useRef)(null),[a,n]=(0,s.useState)(""),[j,I]=(0,s.useState)(""),[T,b]=(0,s.useState)();(0,s.useEffect)((()=>{var e;null===(e=t.current)||void 0===e||e.restoreFocus()}),[]);const P=()=>{const t=(0,h.default)(a.trim());e.handleContinue(t,j,T)},M=a.trim().length>0,w=M?(0,S.jsx)("div",{className:(0,r.default)(E),children:(0,S.jsx)(g.Round,{a8nText:"create-group-btn",onClick:(0,i.default)(P),children:(0,S.jsx)(C.default,{name:"checkmark-medium"})})}):null;return(0,S.jsxs)(l.default,{children:[(0,S.jsx)(c.DrawerHeader,{title:f.default.t(1361),type:c.DRAWER_HEADER_TYPE.LARGE,onBack:e.handleBack}),(0,S.jsxs)(d.default,{children:[(0,S.jsxs)(u.default,{children:[(0,S.jsx)("div",{className:(0,r.default)(y),children:(0,S.jsx)(p.PhotoPickerLoadable,{type:m.default.COMMUNITY,attachToChat:!1,startImage:T,onImageSet:(e,t)=>{b(t)}})}),(0,S.jsx)("div",{"data-a8n":o.default.key("community-subject"),className:(0,r.default)(y),children:(0,S.jsx)(_.TextInput,{ref:e=>{t.current=e},value:a,maxLength:25,showRemaining:!0,onChange:e=>{n(e)},placeholder:f.default.t(637),onEnter:M?(0,i.default)(P):()=>{},supportsEmoji:!0})}),(0,S.jsx)("div",{"data-a8n":o.default.key("community-description"),className:(0,r.default)(y),children:(0,S.jsx)(_.TextInput,{value:j,maxLength:v.ServerProps.groupDescLength,showRemaining:!0,onChange:e=>{I(e)},placeholder:f.default.t(636),onEnter:M?(0,i.default)(P):()=>{}})})]}),(0,S.jsx)(x.default,{transitionName:"btn",children:w})]})]})}));t.default=j},91142:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{participants:t,onContinue:a}=e,n=(0,s.useRef)(null),[c,C]=(0,s.useState)(e.subject||""),[T,L]=(0,s.useState)(e.thumb),[k,O]=(0,s.useState)(e.full),[A,D]=(0,s.useState)((()=>{var e,t;let a;if((0,x.isDisappearingModeEnabled)()){const e=(0,g.getMaybeMeUser)();e&&(a=(0,v.getDisappearingModeSettingForUser)(e))}return null!==(e=null===(t=a)||void 0===t?void 0:t.duration)&&void 0!==e?e:0}));(0,s.useEffect)((()=>{var e;null===(e=n.current)||void 0===e||e.restoreFocus()}),[]);const R=()=>{const e=(0,p.default)(c.trim());(0,l.createGroup)(e,T,k,t,A),a()},N=c.trim().length>0,F=N?(0,M.jsx)("div",{className:S.default.nextButton,children:(0,M.jsx)(j.Round,{a8nText:"create-group-btn",onClick:(0,i.default)(R),children:(0,M.jsx)(I.default,{name:"checkmark-medium"})})}):null;return(0,M.jsxs)(d.default,{children:[(0,M.jsx)(h.DrawerHeader,{title:_.default.t(1362),type:h.DRAWER_HEADER_TYPE.LARGE,onBack:e.onBack}),(0,M.jsxs)(u.default,{children:[(0,M.jsxs)(f.default,{children:[(0,M.jsx)("div",{className:S.default.section,children:(0,M.jsx)(y.PhotoPickerLoadable,{type:E.default.GROUP,attachToChat:!1,startImage:k,onImageSet:(e,t)=>{L(e),O(t)}})}),(0,M.jsx)("div",{"data-a8n":r.default.key("group-subject"),className:S.default.section,children:(0,M.jsx)(b.TextInput,{ref:e=>{n.current=e},value:c,maxLength:25,showRemaining:!0,onChange:e=>{C(e)},placeholder:_.default.t(984),onEnter:N?(0,i.default)(R):()=>{},supportsEmoji:!0})})]}),(0,M.jsx)(w,{ephemeralDuration:A,handleEphemeralDurationClick:()=>{o.Cmd.openModal((0,M.jsx)(m.default,{initialDuration:A,onDurationSelected:D}))}}),(0,M.jsx)(P.default,{transitionName:"btn",children:F})]})]})};var i=n(a(51463)),s=a(67294),r=n(a(76610)),o=a(69162),l=a(48492),d=n(a(17747)),c=n(a(92787)),u=n(a(9042)),h=a(55588),f=n(a(25061)),p=n(a(61136)),m=n(a(57597)),g=a(86723),v=a(20572),C=a(31140),_=n(a(2408)),x=a(21134),S=n(a(4448)),y=a(45605),E=n(a(76870)),j=a(3132),I=n(a(2966)),T=a(97504),b=a(29458),P=n(a(82669)),M=a(85893);function w({ephemeralDuration:e,handleEphemeralDurationClick:t}){if(!(0,x.isDisappearingModeEnabled)())return null;let a;a=e>0?(0,x.isEphemeral24HDurationEnabled)()?(0,C.getDisappearingMessageDurationString)(e):_.default.t(828):_.default.t(827);const n=(0,M.jsx)(I.default,{className:S.default.chevronIcon,name:"chevron-right-alt",directional:!0});return(0,M.jsx)(f.default,{children:(0,M.jsxs)(c.default,{onClick:t,side:n,multiline:!0,children:[(0,M.jsx)("div",{className:S.default.header,children:(0,M.jsx)(T.TextHeader,{level:"3",theme:"title",children:_.default.t(972)})}),(0,M.jsx)(T.TextParagraph,{theme:"muted",children:a})]})})}},63982:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a(63105)),s=n(a(41609)),r=n(a(91966)),o=n(a(94184)),l=a(48360),d=a(67294),c=n(a(76610)),u=a(38512),h=a(69162),f=n(a(75940)),p=a(17025),m=n(a(13531)),g=n(a(17747)),v=n(a(9042)),C=a(55588),_=a(92231),x=n(a(19257)),S=n(a(67893)),y=n(a(40854)),E=n(a(47193)),j=a(39e3),I=n(a(2408)),T=n(a(95575)),b=n(a(70422)),P=n(a(4337)),M=a(3132),w=a(20845),L=a(65565),k=a(46714),O=n(a(2966)),A=a(49201),D=n(a(27988)),R=n(a(82669)),N=a(85893);const F=(0,A.genId)("max_participant_toast");class B extends d.Component{constructor(...e){super(...e),this.state={searchText:"",participants:this.props.participants,shouldFocus:!0,isBusy:!1},this.flatListController=new S.default,this.setRefParticipantList=e=>{this.refParticipantList=e},this.setRefList=e=>{this.refList=e},this.handleKeyDown=e=>{if("Backspace"===e.key&&!this.state.searchText&&!(0,s.default)(this.state.participants)){e.preventDefault();const t=this.state.participants;this.setState({participants:t.slice(0,t.length-1),shouldFocus:!0})}},this.handleInput=e=>{this.setState({searchText:e.target.value})},this.handleReset=()=>{this.setState({searchText:"",shouldFocus:!0})},this.focus=()=>{E.default.focus(this.refInput)},this.handleBack=()=>{this.props.onBack()},this.handleContinue=()=>{this.props.onContinue(this.state.participants)},this.handleDelete=(e,t)=>{const a=(0,i.default)(this.state.participants,(e=>!e.id.equals(t.id)));this.setState({participants:a,shouldFocus:!a.length})},this.handleContactClick=(e,t)=>{this.state.participants.find((e=>e.id.equals(t.id)))?this._removeContact(t):t.isBlocked()?h.Cmd.openModal((0,N.jsx)(f.default,{title:I.default.t(147),onOK:()=>{this._unblockAndAddContact(t),h.Cmd.closeModal()},onCancel:()=>h.Cmd.closeModal(),okText:I.default.t(2335),cancelText:I.default.t(2189),children:l.fbt._("The contact you have selected is blocked. Would you like to unblock them and add them to the group?",null,{hk:"3i4hjJ"})})):this.addContact(t)},this.handleFocusList=e=>{this.refList&&(e.preventDefault(),e.stopPropagation(),y.default.shouldIndicateFocus(),this.refList&&this.refList.focusFirst())},this._handleFocusParticipants=e=>{e.repeat||this.refInput&&0!==this.refInput.selectionStart||this.refParticipantList&&(e.preventDefault(),e.stopPropagation(),j.HotKeys.flashFocus=0,this.refParticipantList&&this.refParticipantList.focusLast())},this.handleSelectFirst=e=>{e.preventDefault(),e.stopPropagation();const t=this.getFilteredContacts()[0];t&&this.handleContactClick(e,t)},this.handleFocusSearch=()=>{y.default.shouldIndicateFocus(),E.default.focus(this.refInput)},this.setRefInput=e=>{this.refInput=e},this._setRefSizer=e=>{this._refSizer=e}}componentDidMount(){this.focus()}componentDidUpdate(){this._adjustInput()}getFilteredContacts(){const e=(0,r.default)(p.ContactCollection.getFilteredContacts(),this.state.participants);let t=this.state.searchText;if(!t)return e;t=I.default.accentFold(t);const a=(0,b.default)(t);return e.filter((e=>e.searchMatch(t,a)))}_adjustInput(){if(this.refInput){const e=this.refInput.offsetParent.offsetWidth-10,t=this._refSizer.offsetWidth,a=t>e?e:t;let n;this.refInput.style.width=a+"px",n=e-this.refInput.offsetLeft-a>0?e-this.refInput.offsetLeft:e,this.refInput.style.width=n+"px",this.state.shouldFocus&&this.focus()}}addContact(e){const t=this.state.participants;if(t.length>=L.ServerProps.maxParticipants){const e=I.default.t(60,{max:L.ServerProps.maxParticipants});h.Cmd.openToast((0,N.jsx)(A.Toast,{msg:e,id:F}))}else this.setState({participants:t.concat(e),searchText:"",shouldFocus:!0})}_removeContact(e){const t=this.state.participants;this.setState({participants:(0,i.default)(t,(t=>!e.id.equals(t.id))),shouldFocus:!0})}_unblockAndAddContact(e){this.setState({isBusy:!0}),(0,u.unblockContact)(e).then((()=>{this.props.getUnmountSignal().aborted||(this.addContact(e),this.setState({isBusy:!1}))})).catch((()=>{this.setState({isBusy:!1})}))}render(){var e,t,a;let n;this.state.isBusy?n=(0,N.jsx)("div",{className:T.default.spinner,children:(0,N.jsx)(k.Spinner,{stroke:6,size:24})}):(null===(e=this.state.participants)||void 0===e?void 0:e.length)&&(n=(0,N.jsx)(M.Round,{a8nText:"group-participants-btn",onClick:this.handleContinue,children:(0,N.jsx)(O.default,{name:"arrow-forward",directional:!0})}));const i=(null===(t=this.state.participants)||void 0===t?void 0:t.length)?" ":I.default.t(969),s={down:this.handleFocusList,enter:this.state.searchText?this.handleSelectFirst:(null===(a=this.state.participants)||void 0===a?void 0:a.length)?this.handleContinue:()=>{},up:this._handleFocusParticipants};s[I.default.LR("left","right")]=this._handleFocusParticipants;const r=this.getFilteredContacts();let l;return l=0===r.length?(0,N.jsx)(_.SearchContacts,{}):(0,N.jsx)(m.default,{ref:this.setRefList,flatListController:this.flatListController,contacts:r,onClick:this.handleContactClick,onFocusSearch:this.handleFocusSearch,showPersonGroupDivisionHeader:!1}),(0,N.jsxs)(g.default,{children:[(0,N.jsx)(C.DrawerHeader,{title:I.default.t(153),type:C.DRAWER_HEADER_TYPE.LARGE,onBack:this.handleBack}),(0,N.jsxs)(v.default,{children:[(0,N.jsx)("div",{className:T.default.search,children:(0,N.jsx)("div",{children:(0,N.jsxs)(j.HotKeys,{handlers:s,className:T.default.inputLine,children:[(0,N.jsx)("div",{"data-list-scroll-container":!0,children:(0,N.jsx)(P.default,{ref:this.setRefParticipantList,theme:"list-names",contacts:this.state.participants,onDelete:this.handleDelete,onFocusSearch:this.handleFocusSearch})}),(0,N.jsx)("input",{"data-a8n":c.default.key("inputarea"),className:(0,o.default)(T.default.inputarea,w.SELECTABLE_INPUT_CSS_CLASS),ref:this.setRefInput,placeholder:i,onKeyDown:this.handleKeyDown,onChange:this.handleInput,value:this.state.searchText,type:"text"}),(0,N.jsx)("span",{className:T.default.inputareaSizer,ref:this._setRefSizer,children:this.state.searchText})]})})}),(0,N.jsx)(x.default,{className:T.default.contacts,flatListControllers:[this.flatListController],children:l}),(0,N.jsx)(R.default,{transitionName:"btn",className:T.default.drawerSection,children:n})]})]})}}B.defaultProps={participants:[]},B.displayName="NewGroupParticipantsDrawer";var U=(0,D.default)(B);t.default=U},88616:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(67294),s=n(a(58362)),r=n(a(17747)),o=n(a(9042)),l=a(55588),d=n(a(2408)),c=a(80959),u=a(85893);var h=(0,i.forwardRef)(((e,t)=>(0,u.jsxs)(r.default,{ref:t,children:[(0,u.jsx)(l.DrawerHeader,{a8n:"drawer-title-notifications",title:d.default.t(1383),onBack:e.onClose,type:l.DRAWER_HEADER_TYPE.LARGE}),(0,u.jsx)(o.default,{children:(0,u.jsx)(s.default,{mute:c.MuteCollection.globalMute(),reactionsMute:c.MuteCollection.globalReactionsMute()},"notifications")})]})));t.default=h},4879:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a(81109)),s=n(a(48926)),r=a(67294),o=n(a(56720)),l=n(a(14505)),d=a(42056),c=a(15701),u=a(33287),h=a(69162),f=n(a(17747)),p=n(a(9042)),m=a(55588),g=n(a(33249)),v=n(a(25061)),C=a(86723),_=n(a(2408)),x=n(a(6615)),S=a(80459),y=a(83097),E=a(59603),j=n(a(2966)),I=a(49201),T=a(61192),b=a(85893);const P={drawerTitle:{paddingTop:"hc2u0oym",paddingEnd:"f9ovudaz",paddingBottom:"myel2vfb",paddingStart:"gx1rr48f"},chevronRightIcon:{color:"g4ti3y4y",height:"qgpfrw6h"},readReceiptsCheckBoxWrapper:{width:"jswlwoyz",display:"p357zi0d",justifyContent:"ac2vgrno"}};function M(e,t){var a,n,i,E;const[j,M]=(0,r.useState)((()=>L((0,C.getUserPrivacySettings)()))),[A,D]=(0,r.useState)({status:null,groupadd:null,last:null,profile:null});function R(e){const t=L(e.privacySettings);if(null==t)throw new Error(`Incomplete privacy settings: ${Object.keys((0,C.getUserPrivacySettings)()).join(", ")}`);M(t),D((0,S.disallowedRowsToLists)(e.privacyDisallowedRows))}(0,r.useEffect)((()=>{const t=new l.default;return null==j&&(0,s.default)((function*(){try{const e=yield(0,d.updatePrivacySettings)();if(t.signal.aborted)return;R(e)}catch(t){__LOG__(4,void 0,new Error,!0)`privacy_settings_drawer: get privacy settings failed ${t.stack}`,SEND_LOGS("privacy_settings_drawer: get privacy settings failed"),e.onClose(),h.Cmd.openToast((0,b.jsx)(I.Toast,{id:(0,I.genId)(),msg:_.default.t(1477)}))}}))(),()=>t.abort()}),[]),(0,r.useEffect)((()=>{const e=new l.default;return(0,s.default)((function*(){const t=yield(0,S.queryDisallowedLists)();e.signal.aborted||D(t)}))(),()=>e.abort()}),[]),(0,T.useListener)(h.Cmd,"account_sync_for_privacy",(e=>{R(e)}));const N=_.default.t(1467);if(!j)return(0,b.jsx)(x.default,{title:N,error:!1});const{lastSeen:F,profilePicture:B,about:U,groupAdd:H,readReceipts:G}=j;return(0,b.jsxs)(f.default,{ref:t,children:[(0,b.jsx)(m.DrawerHeader,{a8n:"drawer-title-privacy",title:N,onBack:e.onClose,type:m.DRAWER_HEADER_TYPE.LARGE}),(0,b.jsxs)(p.default,{children:[(0,b.jsxs)(v.default,{title:_.default.t(1486),titleXStyle:P.drawerTitle,theme:"padding-no-vertical",animation:!1,ellipsify:!1,children:[(0,b.jsx)(w,{title:_.default.t(1482),onClick:()=>{e.onOpenVisibilityEditDrawer("lastSeen")},children:(0,b.jsx)("span",{children:k(F,null===(a=A.last)||void 0===a?void 0:a.disallowedList.length)})}),(0,b.jsx)(w,{title:_.default.t(1483),onClick:()=>{e.onOpenVisibilityEditDrawer("profilePicture")},children:(0,b.jsx)("span",{children:k(B,null===(n=A.profile)||void 0===n?void 0:n.disallowedList.length)})}),(0,b.jsx)(w,{title:_.default.t(1479),onClick:()=>{e.onOpenVisibilityEditDrawer("about")},children:(0,b.jsx)("span",{children:k(U,null===(i=A.status)||void 0===i?void 0:i.disallowedList.length)})}),(0,b.jsx)(g.default,{title:_.default.t(1484),icon:(0,b.jsx)("div",{className:(0,o.default)(P.readReceiptsCheckBoxWrapper),children:(0,b.jsx)(u.CheckBox,{checked:G===y.ALL_NONE.all,stopPropagation:!0,onChange:()=>{}})}),theme:"privacy",isLastItem:!0,onClick:()=>{!function(){O.apply(this,arguments)}(j,M,G)},children:(0,b.jsx)("span",{children:_.default.t(1485)})})]}),(0,b.jsxs)(v.default,{theme:"padding-no-vertical",animation:!1,children:[(0,b.jsx)(w,{title:_.default.t(1481),onClick:()=>{e.onOpenVisibilityEditDrawer("groupAdd")},children:(0,b.jsx)("span",{children:k(H,null===(E=A.groupadd)||void 0===E?void 0:E.disallowedList.length)})}),(0,b.jsx)(w,{title:_.default.t(1480),isLastItem:!0,onClick:e.onOpenBlockedContacts,children:(0,b.jsx)("span",{children:0===c.BlocklistCollection.length?_.default.t(238):c.BlocklistCollection.length})})]})]})]})}function w({title:e,onClick:t,isLastItem:a,children:n}){return(0,b.jsx)(g.default,{title:e,theme:"privacy",icon:(0,b.jsx)(j.default,{name:_.default.isRTL()?"chevron-left":"chevron-right",iconXstyle:P.chevronRightIcon}),onClick:t,isLastItem:a,children:n})}function L(e){const{about:t,groupAdd:a,lastSeen:n,profilePicture:i,readReceipts:s}=e;if(null!=t&&null!=a&&null!=n&&null!=i&&null!=s)return{about:t,groupAdd:a,lastSeen:n,profilePicture:i,readReceipts:s}}function k(e,t){switch(e){case y.VISIBILITY.all:return _.default.t(1474);case y.VISIBILITY.contacts:return _.default.t(1471);case y.VISIBILITY.contact_blacklist:return null==t?"":_.default.t(1473,{count:t,_plural:t});case y.VISIBILITY.none:return _.default.t(1475);default:return""}}function O(){return(O=(0,s.default)((function*(e,t,a){const n=a===y.ALL_NONE.all?y.ALL_NONE.none:y.ALL_NONE.all;t((0,i.default)((0,i.default)({},e),{},{readReceipts:n}));try{n===y.ALL_NONE.none?yield(0,E.setPrivacyForOneCategory)({name:"readreceipts",value:"none"}):yield(0,E.setPrivacyForOneCategory)({name:"readreceipts",value:"all"})}catch(e){__LOG__(3,void 0,void 0,!0)`privacy_settings_drawer: set readreceipts failed ${e.stack}`,SEND_LOGS("privacy_settings_drawer: set readreceipts failed"),h.Cmd.openToast((0,b.jsx)(I.Toast,{id:(0,I.genId)(),msg:_.default.t(1478)}))}}))).apply(this,arguments)}var A=(0,r.forwardRef)(M);t.default=A},86618:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.PrivacyVisibilityEditDrawer=void 0;var i=n(a(48926)),s=a(67294),r=n(a(56720)),o=n(a(88540)),l=a(69162),d=n(a(17747)),c=n(a(9042)),u=a(55588),h=n(a(25061)),f=a(86723),p=a(78615),m=n(a(2408)),g=a(83097),v=n(a(18833)),C=a(59603),_=a(49201),x=n(a(89135)),S=a(12825),y=a(85893);const E={description:{marginTop:"c46o30wg",marginEnd:"jnwc1y2a",marginBottom:"du8bjn1j",marginStart:"svoq16ka",fontSize:"f8jlpxt4",color:"eruf1vka",lineHeight:"r5qsrrlp"},visibilityOption:{display:"f804f6gw",paddingTop:"a71rq12o",paddingEnd:"f9ovudaz",paddingBottom:"pcbmd69e",paddingStart:"gx1rr48f",textAlign:"ml4r5409"},visibilityOptionText:{fontSize:"enbbiyaj",lineHeight:"r5qsrrlp",display:"l7jjieqr"},visibilityOptionSpace:{display:"l7jjieqr",width:"m0s4cjtr"}};function j({category:e,onClose:t},a){const[n,o]=(0,s.useState)((()=>{var t,a,n,i;const s=(0,f.getUserPrivacySettings)();switch(e){case"about":return null!==(t=s.about)&&void 0!==t?t:g.VISIBILITY.all;case"profilePicture":return null!==(a=s.profilePicture)&&void 0!==a?a:g.VISIBILITY.all;case"lastSeen":return null!==(n=s.lastSeen)&&void 0!==n?n:g.VISIBILITY.all;case"groupAdd":return null!==(i=s.groupAdd)&&void 0!==i?i:g.VISIBILITY.all}}));function x(){return j.apply(this,arguments)}function j(){return(j=(0,i.default)((function*(t){if(t===n)return;o(t);const a=(0,C.privacyWebNameToServerName)(e);if("readreceipts"===a)throw new Error("visibility_edit_drawer: category can not be readreceipts");try{switch(t){case g.VISIBILITY.none:if("groupadd"===a)throw new Error("visibility_edit_drawer: groupadd can not be none");return void(yield(0,C.setPrivacyForOneCategory)({name:a,value:"none"}));case g.VISIBILITY.contacts:return void(yield(0,C.setPrivacyForOneCategory)({name:a,value:"contacts"}));case g.VISIBILITY.all:yield(0,C.setPrivacyForOneCategory)({name:a,value:"all"})}}catch(e){o(n);e instanceof S.ServerStatusCodeError&&409===e.statusCode||(__LOG__(3,void 0,void 0,!0)`visibility_edit_drawer: set visiblity option failed ${e.stack}`,SEND_LOGS("visibility_edit_drawer: set visiblity option failed")),l.Cmd.openToast((0,y.jsx)(_.Toast,{id:(0,_.genId)(),msg:m.default.t(853)}))}}))).apply(this,arguments)}const P=(0,y.jsx)(b,{text:m.default.t(1474),selected:n===g.VISIBILITY.all,onClick:()=>{x(g.VISIBILITY.all)}}),M=(0,y.jsx)(b,{text:m.default.t(1471),selected:n===g.VISIBILITY.contacts,onClick:()=>{x(g.VISIBILITY.contacts)}}),w="groupAdd"===e||(0,p.privacyAllowContactsExceptEnabled)()?(0,y.jsx)(b,{text:m.default.t(1472),selected:n===g.VISIBILITY.contact_blacklist,onClick:()=>{l.Cmd.openModal((0,y.jsx)(v.default,{category:e,onConfirm:()=>{o(g.VISIBILITY.contact_blacklist)}}))}}):null,L="groupAdd"===e?null:(0,y.jsx)(b,{text:m.default.t(1475),selected:n===g.VISIBILITY.none,onClick:()=>{x(g.VISIBILITY.none)}}),k="groupAdd"===e?(0,y.jsx)("div",{className:(0,r.default)(E.description),children:m.default.t(1469)}):null;return(0,y.jsxs)(d.default,{ref:a,children:[(0,y.jsx)(u.DrawerHeader,{a8n:`drawer-title-${e}`,title:I(e),onBack:t,type:u.DRAWER_HEADER_TYPE.LARGE}),(0,y.jsx)(c.default,{children:(0,y.jsxs)(h.default,{theme:"padding-no-vertical",animation:!1,children:[(0,y.jsx)("div",{className:(0,r.default)(E.description),children:T(e)}),P,M,w,L,k]})})]})}function I(e){switch(e){case"about":return m.default.t(1479);case"profilePicture":return m.default.t(1483);case"lastSeen":return m.default.t(1482);case"groupAdd":return m.default.t(1481)}}function T(e){switch(e){case"about":return m.default.t(1466);case"profilePicture":return m.default.t(1476);case"lastSeen":return m.default.t(1470);case"groupAdd":return m.default.t(1468)}}function b({text:e,selected:t,onClick:a}){return(0,y.jsxs)(x.default,{xstyle:E.visibilityOption,onClick:a,children:[(0,y.jsx)(o.default,{checked:t,radio:!0,hover:!1,systemUncheckedColor:!0,onChange:a}),(0,y.jsx)("span",{className:(0,r.default)(E.visibilityOptionSpace)}),(0,y.jsx)("span",{className:(0,r.default)(E.visibilityOptionText),children:e})]})}const P=(0,s.forwardRef)(j);t.PrivacyVisibilityEditDrawer=P},28682:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a(81109)),s=a(48360),r=a(67294),o=(n(a(56720)),n(a(76610))),l=a(47874),d=n(a(69991)),c=a(60028),u=a(77512),h=a(69162),f=n(a(75940)),p=a(9322),m=n(a(55454)),g=n(a(77392)),v=n(a(17747)),C=n(a(9042)),_=a(79864),x=a(55588),S=n(a(25061)),y=n(a(80223)),E=n(a(61136)),j=a(63290),I=n(a(99942)),T=a(86723),b=a(78615),P=n(a(52087)),M=a(14179),w=n(a(2408)),L=a(83952),k=n(a(4231)),O=a(70790),A=n(a(65587)),D=a(90277),R=n(a(66915)),N=n(a(8497)),F=a(21125),B=a(71578),U=a(20845),H=a(17959),G=n(a(79485)),V=a(650),W=n(a(2966)),z=a(97504),K=a(29458),q=n(a(27988)),Y=n(a(98532)),Q=a(85893);class X extends I.default{constructor(...e){super(...e),this.openMerchantDetailsForm=()=>{const e=(0,T.getMeUser)();this.push((0,Q.jsx)(L.MerchantDetailsFormFlowLoadable,{contactId:e,onBack:this.pop}))},this.openCatalogDetailsForm=()=>{(0,b.canManageCollections)()&&F.QPL.markerStart(B.QuickLogMarkerId.WHATSAPP_CATALOG_COLLECTIONS_VIEW,{string:{EntryPoint:"Profile"}}),(0,u.createCatalogManagementFlowObject)(((e,t)=>{e?this.push((0,Q.jsx)(u.CatalogManagementFlowLoadable,{catalog:e,catalogId:t,product:null,onBack:this.pop})):this.push((0,Q.jsx)(u.CatalogManagementFlowLoadable,{catalogId:t,product:null,onBack:this.pop}))}))}}componentDidMount(){this.push((0,Q.jsx)(J,{openMerchantDetailsForm:this.openMerchantDetailsForm,openCatalogDetailsForm:this.openCatalogDetailsForm,conn:this.props.conn,contact:this.props.contact,profilePicThumb:this.props.profilePicThumb,status:this.props.status,onClose:this.pop}))}}t.default=X;const Z={businessComplianceIconWrapper:{paddingEnd:"htg54gjl",color:"s4k44ver"},businessComplianceText:{flexGrow:"ggj6brxn",color:"tviruh8d"},businessComplianceRightAltIcon:{color:"cs9t9or5"}};class $ extends r.Component{constructor(e){super(e),this.handleBack=()=>{this.props.onClose?this.props.onClose():this.props.uim.uie.requestDismiss()},this._validateStatus=e=>!!(e||"").trim(),this._handleStatusBegin=()=>{this._isEditingStatus=!0},this._handleSetStatusError=()=>{h.Cmd.openModal((0,Q.jsx)(f.default,{onOK:()=>h.Cmd.closeModal(),okText:w.default.t(2192),children:w.default.t(136)}))},this._handleSetStatus=()=>{if(null==this.state.status)return void this._handleCancelStatus();this._isEditingStatus=!1;const e=this.props.status.status,t=(0,E.default)(this.state.status);if(t===e)return this.setState({status:t});this.setState({pendingStatus:!0}),(0,V.setMyStatus)((0,E.default)(this.state.status)).then((()=>{this.props.getUnmountSignal().aborted||this.setState({pendingStatus:!1})}))},this.handleStatusChange=e=>{this.setState({status:e})},this._handleCancelStatus=()=>{this._isEditingStatus=!1,this.setState({status:this.props.status.status})},this._handlePushnameBegin=()=>{this._isEditingPushname=!0},this._validatePushname=()=>{let e,{pushname:t}=this.state;return t=(t||"").trim(),t?/[\u2714\u2705\u2611]/g.test(t)&&(e=s.fbt._("That emoji isn't allowed in your name",null,{hk:"1JrVVd"})):e=w.default.t(129),!e||(this._handleSetPushnameError(e),!1)},this._handleSetPushname=()=>{if(this._isEditingPushname=!1,!p.Conn.canSetMyPushname())return;let{pushname:e}=this.state;e=(0,E.default)((e||"").trim());if(e===this.props.conn.pushname)return this.setState({pushname:e});this.setState({pendingPushname:!0}),(0,H.setPushname)(e).then((()=>{this.props.getUnmountSignal().aborted||this.setState({pendingPushname:!1})}))},this._handleSetPushnameError=e=>{h.Cmd.openModal((0,Q.jsx)(f.default,{onOK:()=>h.Cmd.closeModal(),okText:w.default.t(2192),children:e}))},this._handlePushnameChange=e=>{this.setState({pushname:e})},this._handleCancelPushname=()=>{this._isEditingPushname=!1,this.setState({pushname:this.props.conn.pushname})},this.state={pushname:e.conn.pushname,status:e.status.status,pendingPushname:!1,pendingStatus:!1,catalog:null}}componentDidMount(){if(!p.Conn.isSMB)return;c.CatalogCollection.findCarouselCatalog((0,T.getMeUser)()).then((e=>{const t=Array.isArray(e)?e[0]:e;this.setState({catalog:t})})).catch((()=>{}));const{session:e}=(0,O.getProductCatalogContext)(this.context);e.isAccidental()&&h.Cmd.setDrawerContext("left",(0,O.buildProductCatalogContext)(new D.ProductCatalogSession,k.default.BIZ_PLATFORM.SMB,k.default.CATALOG_ENTRY_POINT.CATALOG_ENTRY_POINT_SETTINGS))}renderProductCatalogSection(){if((0,b.blockCatalogCreationECommerceComplianceIndia)(this.props.contact.businessProfile))return null;const e=this.props.contact.businessProfile;if((0,b.bannedShopsEnabled)()&&(0,l.hasShop)(e)&&(0,l.isShopBanned)(e))return(0,Q.jsx)(S.default,{theme:"padding-large",children:(0,Q.jsxs)("div",{className:R.default.content,children:[(0,Q.jsx)("div",{className:R.default.bannedShopInfoText,children:w.default.t(2363)}),(0,Q.jsx)(d.default,{type:"primary",onClick:function(){(0,b.bannedShopsEnabled)()&&(0,l.goToCommerceManager)(e)},children:w.default.t(635)})]})});const{session:t}=(0,O.getProductCatalogContext)(this.context);return t.isAccidental()?null:(0,Q.jsx)(A.default,{businessProfile:this.props.contact.businessProfile,catalog:this.state.catalog,openCatalog:this.props.openCatalogDetailsForm})}renderMerchantDetailsFormSection(){return(0,Q.jsx)(S.default,{title:(0,Q.jsxs)(j.FlexRow,{align:"center",children:[(0,Q.jsx)(j.FlexItem,{xstyle:Z.businessComplianceIconWrapper,children:(0,Q.jsx)(W.default,{name:"business"})}),(0,Q.jsx)(j.FlexItem,{xstyle:Z.businessComplianceText,children:w.default.t(322)}),(0,Q.jsx)(j.FlexItem,{children:(0,Q.jsx)(W.default,{xstyle:Z.businessComplianceRightAltIcon,name:"chevron-right-alt",directional:!0})})]}),theme:"refresh-padding-title",titleOnClick:this.props.openMerchantDetailsForm})}_renderAboutInput(){const{status:e}=this.props,t=this._isEditingStatus||this.state.pendingStatus?this.state.status:e.status;return(0,Q.jsx)(K.TextInput,{a8n:"col-main-profile-input",value:t,editable:!0,pending:this.state.pendingStatus,showRemaining:!0,validate:this._validateStatus,maxLength:m.default.MAX_STATUS_LENGTH,onBeginEdit:this._handleStatusBegin,onChange:this.handleStatusChange,onSave:this._handleSetStatus,onError:this._handleSetStatusError,onCancel:this._handleCancelStatus,theme:"text-input",fieldName:s.fbt._("About",null,{hk:"2FinUX"}),supportsEmoji:!0,lockable:!0,lowProfile:!0,constrainedWidth:!0})}_renderStandardEditSection(){const{conn:e}=this.props,t=this._isEditingPushname||this.state.pendingPushname?this.state.pushname:e.pushname,a=p.Conn.isSMB?w.default.t(373):w.default.t(1548),n=(0,Q.jsx)(S.default,{a8nText:"col-main-profile",title:w.default.t(2276),theme:"padding",children:this._renderAboutInput()});return(0,Q.jsxs)(Q.Fragment,{children:[(0,Q.jsx)(S.default,{a8nText:"col-main-profile",title:w.default.t(1547),theme:"padding",children:(0,Q.jsx)(K.TextInput,{a8n:"col-main-profile-input",value:t,editable:p.Conn.canSetMyPushname(),pending:this.state.pendingPushname,showRemaining:!0,validate:this._validatePushname,maxLength:m.default.MAX_PUSHNAME_LENGTH,onBeginEdit:this._handlePushnameBegin,onChange:this._handlePushnameChange,onSave:this._handleSetPushname,onCancel:this._handleCancelPushname,supportsEmoji:!0,lockable:!0,lowProfile:!0,constrainedWidth:!0})}),(0,Q.jsx)("div",{"data-a8n":o.default.key("pushname-description"),className:R.default.nameWrapper,children:(0,Q.jsx)(z.TextSpan,{theme:"muted",children:a})}),n]})}_renderSection(e){return(0,Q.jsx)(M.IconSection,(0,i.default)({},e))}_renderAboutSection(){const e=this._renderSection({icon:"info",content:this._renderAboutInput()}),t=this._renderSection({icon:"call-phone",iconClass:R.default.phoneIcon,content:(0,Q.jsxs)("div",{children:[(0,Q.jsx)(U.SelectableDiv,{className:R.default.phoneField,selectable:!0,children:(0,Y.default)((0,T.assertGetMe)())}),(0,Q.jsx)("div",{className:R.default.infoText,children:w.default.t(393)})]})});return(0,Q.jsxs)(S.default,{title:w.default.t(383),theme:"refresh",children:[e,t]})}_renderEditBizProfileEditSection(){return(0,Q.jsxs)("div",{children:[(0,Q.jsx)(y.default,{}),(0,b.canSeeECommerceComplianceIndiaBusinessJourney)(this.props.contact.id.user)&&this.renderMerchantDetailsFormSection(),this.renderProductCatalogSection(),this._renderAboutSection()]})}_renderCoverPhoto(){return(0,Q.jsx)(S.default,{theme:"padding-no-margin",children:(0,Q.jsx)(g.default,{contact:this.props.contact,editable:!0,profilePicThumb:this.props.profilePicThumb,hideStatusV3:!0})})}_renderProfilePicture(){return(0,Q.jsx)("div",{className:R.default.photoPickerWrapper,children:(0,Q.jsx)(N.default,{profilePicThumb:this.props.profilePicThumb})})}render(){const e=(0,b.canSeeBizProfileV3)()&&p.Conn.isSMB?this._renderCoverPhoto():this._renderProfilePicture(),t=p.Conn.isSMB?this._renderEditBizProfileEditSection():this._renderStandardEditSection(),a=w.default.t(1217);return(0,Q.jsxs)(v.default,{children:[(0,Q.jsx)(x.DrawerHeader,{a8n:"drawer-title-profile",title:a,onBack:this.handleBack,type:x.DRAWER_HEADER_TYPE.LARGE}),(0,Q.jsxs)(C.default,{children:[e,t]})]})}}$.contextType=_.DrawerContext,$.CONCERNS={contact:["businessProfile","id","statusMute"],profilePicThumb:["imgFull","id"],status:["status"],conn:["pushname"]},$.displayName="ProfileDrawer";const J=(0,P.default)((0,q.default)((0,G.default)($,$.CONCERNS)))},28981:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,r.jsx)(i.default,{primary:e.choiceText,onClick:e.onChoose,theme:"radio-button-row",image:(0,r.jsx)(s.default,{checked:e.isChosen,hover:!1,radio:!0,onChange:e.onChoose,systemUncheckedColor:!0})})};var i=n(a(55092)),s=n(a(88540)),r=a(85893)},7883:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const[t,a]=(0,i.useState)(p.getGlobalSecurityNotifications),n=v.ServerProps.bspSystemMessageEnabled;let E=n?m.default.t(1641):m.default.t(1639);(0,s.getABPropConfigValue)("adv_v2_m6")&&(E=m.default.t(1640));return(0,S.jsxs)(o.default,{children:[(0,S.jsx)(d.DrawerHeader,{a8n:"drawer-title-security",title:m.default.t(1646),onBack:e.onClose,type:d.DRAWER_HEADER_TYPE.LARGE}),(0,S.jsx)(l.default,{children:(0,S.jsxs)(c.default,{theme:"padding-large",animation:!1,children:[(0,S.jsxs)(f.FlexColumn,{xstyle:y.icon,align:"center",justify:"center",children:[(0,S.jsx)(f.FlexItem,{children:(0,S.jsx)(_.default,{name:"security-shield"})}),(0,S.jsx)(f.FlexColumn,{xstyle:y.iconLock,align:"center",justify:"center",children:(0,S.jsx)(f.FlexItem,{children:(0,S.jsx)(_.default,{name:"security-lock"})})})]}),(0,S.jsxs)("div",{className:g.default.text,children:[n?m.default.t(1645):m.default.t(1644)," ",(0,S.jsx)(u.ExternalLink,{href:(0,C.securityUrl)(),children:m.default.t(1091)})]}),(0,S.jsxs)(f.FlexRow,{xstyle:y.controls,children:[(0,S.jsx)("div",{className:g.default.checkbox,children:(0,S.jsx)(r.CheckBox,{onChange:()=>{const e=!t;(0,p.setGlobalSecurityNotifications)(e),a(e)},checked:t})}),(0,S.jsxs)(f.FlexItem,{children:[(0,S.jsx)("div",{className:g.default.header,children:(0,S.jsx)(x.TextSpan,{theme:"title",children:m.default.t(1643)})}),(0,S.jsxs)(x.TextDiv,{theme:"muted",children:[E," ",(0,S.jsx)(u.ExternalLink,{href:(0,h.getCodeChangeFaqUrl)(),children:m.default.t(1091)})]})]})]})]})})]})};var i=a(67294),s=(n(a(56720)),a(70359)),r=a(33287),o=n(a(17747)),l=n(a(9042)),d=a(55588),c=n(a(25061)),u=a(4919),h=a(57092),f=a(63290),p=a(86723),m=n(a(2408)),g=n(a(4662)),v=a(65565),C=a(62701),_=n(a(2966)),x=a(97504),S=a(85893);const y={icon:{position:"g0rxnol2",boxSizing:"cm280p3y",width:"cnprk2g9",height:"j74n1y92",paddingTop:"n1yiu2zv",marginTop:"tt8xd2xn",marginEnd:"k1jo73ug",marginBottom:"mpdn4nr2",marginStart:"isfiuinm",color:"t63vcusb",backgroundColor:"je90h8md",borderTopStartRadius:"g9p5wyxn",borderTopEndRadius:"i0tg5vk9",borderBottomEndRadius:"aoogvgrq",borderBottomStartRadius:"o2zu3hjb"},iconLock:{position:"lhggkp7q",start:"tkdu00h0",end:"ebjesfe0",top:"qq0sjtgm",bottom:"lrw9n60e",color:"ml33x45x"},controls:{paddingBottom:"sq87qsu4",marginTop:"ignnouf6"}}},84653:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{onOK:t}=e,a=e.name||o.default.t(665),n=o.default.t(1678,{name:a});return(0,l.jsx)(s.default,{onOK:()=>{i.Cmd.closeModal(),t()},okText:o.default.t(2192),children:(0,l.jsx)("div",{children:(0,l.jsx)(r.EmojiText,{text:n})})})};var i=a(69162),s=n(a(75940)),r=a(85051),o=n(a(2408)),l=a(85893)},31051:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.SettingsCheckList=function(e){return(0,l.jsx)("div",{className:o.default.container,children:e.children})},t.SettingsCheckListSection=d,t.SettingsCheckListItem=function(e){return(0,l.jsxs)(d,{disabled:e.disabled,children:[(0,l.jsx)("div",{"data-a8n":s.default.key(e.a8nText),className:o.default.control,children:(0,l.jsx)(r.CheckBox,{id:e.id,onChange:e.onChange,checked:e.checked,disabled:e.disabled})}),(0,l.jsx)("label",{className:o.default.label,htmlFor:e.id,children:e.children})]})};var i=n(a(94184)),s=n(a(76610)),r=a(33287),o=n(a(96601)),l=a(85893);function d(e){return(0,l.jsx)("div",{className:(0,i.default)(o.default.section,{[o.default.disabled]:e.disabled}),children:e.children})}},24148:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(67294),s=(n(a(56720)),n(a(55092))),r=(a(69162),a(9322)),o=a(88419),l=n(a(17747)),d=n(a(9042)),c=n(a(17061)),u=a(55588),h=a(85051),f=a(86723),p=a(12950),m=a(78615),g=n(a(2408)),v=n(a(77898)),C=n(a(2966)),_=a(76006),x=a(85893);const S={privacyIcon:{width:"i94gqilv",height:"bmot90v7"}};function y(e,t){const a=(0,_.useModelValues)(e.settings,["archive"]),n=(0,x.jsx)(v.default,{id:e.profileId}),i=(0,x.jsx)(o.DetailImage,{id:(0,f.getMaybeMeUser)(),size:82,quality:o.DETAIL_IMAGE_QUALITY.HIGH}),y=(0,x.jsx)(h.EmojiText,{text:r.Conn.pushname,ellipsify:!0,titlify:!0}),E=(0,m.privacySettingsEnabled)();let j,I,T,b;!p.GK.supportsFeature(p.GK.F.MD_BACKEND)&&(0,m.archiveV2Supported)()&&a.archive.enabled&&(T=(0,x.jsx)(c.default,{icon:(0,x.jsx)(C.default,{name:"archived"}),onClick:e.onArchiveSettings,children:g.default.t(170)})),p.GK.supportsFeature(p.GK.F.MD_BACKEND)&&(j=(0,x.jsx)(c.default,{a8nText:"li-security",icon:(0,x.jsx)(C.default,{name:"settings-security"}),onClick:e.onSecurity,children:g.default.t(1219)})),E&&(I=(0,x.jsx)(c.default,{a8nText:"li-privacy",icon:(0,x.jsx)(C.default,{name:"security-lock",iconXstyle:S.privacyIcon}),onClick:e.onPrivacy,children:g.default.t(1215)})),(0,m.webMediaAutoDownloadEnabled)()&&(b=(0,x.jsx)(c.default,{a8nText:"li-media-auto-download",icon:(0,x.jsx)(C.default,{name:"media-download"}),onClick:e.onMediaAutoDownload,children:g.default.t(1213)}));const P=(0,x.jsx)(c.default,{a8nText:"li-keyboard-shortcuts",icon:(0,x.jsx)(C.default,{name:"settings-keyboard"}),onClick:e.onKeyboardShortcuts,children:g.default.t(1075)});const M=E?null:(0,x.jsx)(c.default,{a8nText:"li-blocked",icon:(0,x.jsx)(C.default,{name:"settings-blocked"}),onClick:e.onBlocked,children:g.default.t(1207)});return(0,x.jsxs)(l.default,{ref:t,theme:"settings",children:[(0,x.jsx)(u.DrawerHeader,{title:g.default.t(1682),onBack:e.onClose,type:u.DRAWER_HEADER_TYPE.LARGE}),(0,x.jsxs)(d.default,{children:[(0,x.jsx)(s.default,{onClick:e.onProfile,image:i,primary:y,theme:"identity",secondary:n}),(0,x.jsx)(c.default,{a8nText:"li-notifications",icon:(0,x.jsx)(C.default,{name:"settings-notifications"}),onClick:e.onNotifications,children:g.default.t(1214)}),I,j,(0,x.jsx)(c.default,{icon:(0,x.jsx)(C.default,{name:"settings-theme"}),onClick:e.onThemeSettings,children:g.default.t(1222)}),(0,x.jsx)(c.default,{icon:(0,x.jsx)(C.default,{name:"settings-wallpaper"}),onClick:e.onWallpaper,children:g.default.t(1223)}),T,M,b,undefined,P,(0,x.jsx)(c.default,{a8nText:"li-help",icon:(0,x.jsx)(C.default,{name:"settings-help"}),onClick:e.onHelp,children:g.default.t(1209)}),undefined,undefined,undefined,undefined,undefined,undefined]})]})}var E=(0,i.forwardRef)(y);t.default=E},72403:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a(23493)),s=a(67294),r=a(58380),o=a(25142),l=a(69162),d=n(a(55454)),c=n(a(52384)),u=n(a(17747)),h=n(a(9042)),f=a(55588),p=a(92231),m=n(a(47193)),g=a(86723),v=a(12950),C=n(a(52087)),_=a(39e3),x=n(a(2408)),S=a(71681),y=a(47941),E=n(a(42321)),j=n(a(16967)),I=a(46714),T=n(a(96363)),b=n(a(94602)),P=n(a(14784)),M=n(a(2966)),w=n(a(27988)),L=n(a(82669)),k=a(85893);class O extends s.Component{constructor(e){super(e),this._msgRefs={},this._setRefHotKeys=e=>{this._refHotKeys=e},this._refScrollContainer=(0,s.createRef)(),this._getInitialState=()=>{const{starredMsgs:e}=this.props;return{cursor:E.default.create({msgCollection:e,type:d.default.RENDER_CURSOR.STARRED_DRAWER}).loadAfter(e,{count:d.default.MSG_PRELOAD_THRESHOLD})}},this._handleStarChange=()=>{this._initSelectionObjects(),this.forceUpdate()},this._initSelectionObjects=()=>{const e=this.props.starredMsgs.toArray();this._currSelection.init(e,!0),this._activeSelection.init(e)},this.setRefMsgComponent=(e,t)=>{t?this._msgRefs[e.id.toString()]=t:delete this._msgRefs[e.id.toString()]},this.loadEarlierMsgs=()=>{var e;const t=this.state.cursor,a=null===(e=this.props.chat)||void 0===e?void 0:e.id,{starredMsgs:n}=this.props,i=this.props.getUnmountSignal(),s=n.models;if(t.getEnd(n)<s.length)this.setState({cursor:t.loadAfter(n)});else{if(n.isSynced)return;this.props.starredMsgs.sync(a).then((()=>{i.aborted||t.hasAfter(n)&&this.setState({cursor:t.loadAfter(n)})})).catch((e=>{__LOG__(2)`StarredDrawer:loadEarlierMsgs failed\n${e}`}))}},this.handleClose=()=>{this.props.onClose?this.props.onClose():this.props.uim.uie.requestDismiss()},this.focus=()=>{this._refHotKeys&&m.default.focus(this._refHotKeys)},this.handleFocusGain=e=>{if(!this._refHotKeys)return;(e?e.target:document.activeElement)===this._refHotKeys&&(this._currSelection.index<0?this._currSelection.setFirst(!0):this._currSelection.reset(!1))},this._handleNextMsg=e=>{e&&(e.preventDefault(),e.stopPropagation());const t=this._currSelection.next();this._currSelection.index!==t&&this._currSelection.setNext(!0)},this._handlePrevMsg=e=>{e&&(e.stopPropagation(),e.preventDefault());this._currSelection.prev()>-1&&this._currSelection.setPrev(!0)},this.onScroll=e=>{this.handleScroll(e.currentTarget)},this._handleScroll=e=>{this.updateMsgListInfo(),function(e){return e.scrollTop+d.default.SCROLL_FUDGE>e.scrollHeight-e.clientHeight}(e)&&this.loadEarlierMsgs()},this._selectMsg=e=>{this._currSelection.setVal(e),this._activeSelection.setVal(e),l.Cmd.openChatAt(e.chat,e.chat.getSearchContext(e)),l.Cmd.focusShowMsg(e.id)},this._getMsgList=()=>{const e=this.state.cursor,{starredMsgs:t}=this.props;let a=t.toArray();const n=t.isSynced?e.getEnd(t):Math.min(e.getEnd(t),a.length);return a=a.slice(e.getStart(t),n),this.length=a.length,a},this.getMsgVisibility=e=>{if(!e)return d.default.VISIBILITY.BELOW;const t=this._refScrollContainer.current;if(!t)return;const a=t.previousSibling;if(!(a&&a instanceof HTMLElement))return;const n=a.clientHeight,i=t.scrollTop+n,s=i+t.clientHeight,r=e.getContainerElement();return r?r.offsetTop+r.clientHeight<=i?d.default.VISIBILITY.ABOVE:r.offsetTop>=s?d.default.VISIBILITY.BELOW:d.default.VISIBILITY.VISIBLE:d.default.VISIBILITY.BELOW},this.isMsgVisible=(e,t=!1)=>!!this._msgListInfo.visibleMsgs[e.toString()]&&(!!t||this.getMsgComponent(e)),this.getMsgComponent=e=>{const t=this._msgRefs[e.toString()];if(!t)return;const a=t.getWrapperRef();return a&&"function"==typeof a.getMsgComponentRef?a.getMsgComponentRef():void 0},this._updateMsgListInfo=()=>{const e=this._getMsgList(),t={};let a=0,n=this.length-1;for(;a<n;){const t=Math.floor((a+n)/2),i=this._msgRefs[e[t].id.toString()];this.getMsgVisibility(i)===d.default.VISIBILITY.ABOVE?a=t+1:n=t}for(let n=a;n<e.length;n++){const a=this._msgRefs[e[n].id.toString()];if(this.getMsgVisibility(a)!==d.default.VISIBILITY.VISIBLE)break;t[e[n].id.toString()]=!0}this.pauseHiddenGifs(this._msgListInfo.visibleMsgs,t),this._msgListInfo.visibleMsgs=t},this.pauseHiddenGifs=(e,t)=>{for(const a in e)if(!t[a]){const e=this.props.starredMsgs.get(a);if(null==e?void 0:e.isGif){const e=this.getMsgComponent(a);e&&e.getPlayCount()&&e.pause()}}},this.handleScroll=(0,i.default)(this._handleScroll,100),this.updateMsgListInfo=(0,i.default)(this._updateMsgListInfo,100),this._msgListInfo={visibleMsgs:{}},this.state=this._getInitialState(),this._currSelection=new j.default([],(e=>e.id.toString())),this._activeSelection=new j.default([],(e=>e.id.toString())),this._initSelectionObjects()}componentDidMount(){this.focus(),this.props.listeners.add(window,"resize",this.updateMsgListInfo),!this.props.starredMsgs.isSynced&&this.props.starredMsgs.length<d.default.PAGE_SIZE&&this.props.listeners.uiIdle(this.loadEarlierMsgs),this.props.listeners.add(this.props.starredMsgs,"reset sync",(()=>{this._initSelectionObjects(),this.forceUpdate()})),this.props.listeners.add(this.props.starredMsgs,"add remove",this._handleStarChange),this.handleFocusGain(),this.props.listeners.add(this.props.starredMsgs,"reset",(()=>{this._msgListInfo={visibleMsgs:{}},this.setState(this._getInitialState()),this.loadEarlierMsgs()}))}componentWillUnmount(){this.handleScroll.cancel(),this.updateMsgListInfo.cancel()}componentDidUpdate(){this.updateMsgListInfo()}render(){const e=this._getMsgList(),t=this.state.cursor,{starredMsgs:a}=this.props,n=this.props.chat||null;let i,s;if(s=a.isSynced&&t.getEnd(a)>=e.length?null:this.props.starredMsgs.syncPromise?(0,k.jsx)("div",{className:T.default.more,title:x.default.t(1134),children:(0,k.jsx)(I.Spinner,{stroke:6,size:24})}):(0,k.jsx)("div",{className:T.default.more,children:(0,k.jsx)("div",{title:x.default.t(1131),onClick:this.loadEarlierMsgs,children:(0,k.jsx)(M.default,{name:"refresh"})})}),e.length>0){const t=e.map((e=>{const t=e.type===d.default.MSG_TYPE.IMAGE||e.type===d.default.MSG_TYPE.VIDEO||e.type===d.default.MSG_TYPE.AUDIO;return(0,k.jsx)(P.default,{ref:t=>{this.setRefMsgComponent(e,t)},msg:e,isMsgVisible:t?this.isMsgVisible:()=>{},currSelection:this._currSelection,activeSelection:this._activeSelection,onClickMsg:this._selectMsg},e.id.toString())}));i=(0,k.jsx)(L.default,{transitionName:"slide",children:t})}else this.props.starredMsgs.isSynced?i=(0,k.jsx)(p.StarredMsgs,{}):(i=(0,k.jsx)(p.Loading,{}),s=null);const l={down:this._handleNextMsg,up:this._handlePrevMsg},m=e.length>0?(0,k.jsx)(y.MenuBarItem,{a8nText:"starred-menu",icon:(0,k.jsx)(M.default,{name:"menu"}),title:x.default.t(1225),children:(0,k.jsx)(b.default,{chat:n,msgs:e})}):null;let C;if(v.GK.supportsFeature(v.GK.F.MD_BACKEND)&&(!n||n&&n.endOfHistoryTransferType===r.ConversationEndOfHistoryTransferModelPropType.COMPLETE_BUT_MORE_MESSAGES_REMAIN_ON_PRIMARY)){const e=o.Clock.relativeDateStr((0,g.getHistorySyncEarliestDate)());C=(0,k.jsx)(c.default,{theme:"md-chat-search-list",children:x.default.t(688,{date:e})})}return(0,k.jsx)(u.default,{theme:"gallery",children:(0,k.jsxs)(_.HotKeys,{className:T.default.hotKeyWraper,handlers:l,onFocus:this.handleFocusGain,"data-tab":d.default.TAB_ORDERS.CHAT_STARRED_DRAWER,onRef:this._setRefHotKeys,children:[(0,k.jsx)(f.DrawerHeader,{title:x.default.t(1703),onBack:this.handleClose,type:f.DRAWER_HEADER_TYPE.LARGE,menu:m}),(0,k.jsxs)(h.default,{onScroll:this.onScroll,ref:this._refScrollContainer,children:[i,s,C]})]})})}}O.displayName="StarredDrawer";var A=(0,C.default)((0,w.default)((0,S.ListenerHOC)(O)));t.default=A},94602:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(67294),s=a(69162),r=a(9492),o=a(47452),l=n(a(2408)),d=n(a(36798)),c=a(85893);function u(e,t){const{msgs:a,chat:n}=e,u=(0,i.useRef)(null);return(0,i.useImperativeHandle)(t,(()=>({getElement:()=>u.current}))),(0,c.jsx)(r.Dropdown,{onRef:e=>{u.current=e},type:"dropdown_menu",flipOnRTL:!0,dirX:r.DirX.LEFT,children:(0,c.jsx)(o.DropdownItem,{a8n:"mi-unstar-all menu-item",action:()=>{s.Cmd.openModal((0,c.jsx)(d.default,{msgs:a,chat:n}))},disabled:0===a.length,children:l.default.t(1798)})},"StarredDrawerHeader")}var h=(0,i.forwardRef)(u);t.default=h},34763:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{onOpenStatus:t}=e,a=(0,y.default)((()=>new f.default)),n=()=>{const e=C.StatusV3Collection.getUnexpired(!0),t=C.StatusV3Collection.getUnexpired(!1);return{unread:e,read:t,muted:[...e,...t].filter((e=>e.contact.statusMute))}},{unread:i,read:r,muted:o}=(0,s.useMemo)(n,[]),[d,p]=(0,s.useState)((()=>i.filter((e=>!e.contact.statusMute)))),[m,x]=(0,s.useState)((()=>r.filter((e=>!e.contact.statusMute)))),[S,w]=(0,s.useState)(o),[L,k]=(0,s.useState)((()=>C.StatusV3Collection.getMyStatus())),[O,A]=(0,s.useState)(!1);(0,E.useListener)(C.StatusV3Collection,"add remove bulk_add sort change:msgsChanged change:hasUnread",(()=>{const{unread:e,read:t,muted:a}=n();p(e.filter((e=>!e.contact.statusMute))),x(t.filter((e=>!e.contact.statusMute))),w(a),k(C.StatusV3Collection.getMyStatus())})),(0,E.useListener)(l.ContactCollection,"change:statusMute",(()=>{const{unread:e,read:t,muted:a}=n();p(e.filter((e=>!e.contact.statusMute))),x(t.filter((e=>!e.contact.statusMute))),w(a),k(C.StatusV3Collection.getMyStatus())}));const D=()=>{A(!O)},R=e=>{switch(e.type){case I:return(0,j.jsxs)("div",{className:_.default.listSectionSep,children:[(0,j.jsx)("hr",{}),(0,j.jsx)("div",{className:_.default.listSectionText,children:(0,j.jsx)("span",{children:g.default.t(1714)})})]});case T:return(0,j.jsxs)("div",{className:_.default.listSectionSep,children:[(0,j.jsx)("hr",{}),(0,j.jsx)("div",{className:_.default.listSectionText,children:(0,j.jsx)("span",{children:g.default.t(1721)})})]});case b:return(0,j.jsxs)("div",{className:_.default.listSectionSep,children:[(0,j.jsx)("hr",{}),(0,j.jsxs)("div",{className:_.default.listSectionText,children:[(0,j.jsx)("span",{children:g.default.t(1710)}),(0,j.jsx)("button",{className:_.default.listSectionAction,onClick:D,children:e.expanded?g.default.t(1707):g.default.t(1708)})]})]});case P:return(0,j.jsx)(v.default,{statusV3:e.status,onClick:()=>t(e.status,void 0,e.index),contact:e.status.contact});default:throw new u.UnknownDataError(e)}},N=(0,s.useMemo)((()=>{const e=[];return d.length>0&&(e.push({type:I,itemKey:"section-unread",height:48}),e.push(...d.map(((e,t)=>({type:P,itemKey:e.id.toString(),height:64,status:e,index:t}))))),m.length>0&&(e.push({type:T,itemKey:"section-read",height:48}),e.push(...m.map(((e,t)=>({type:P,itemKey:e.id.toString(),height:64,status:e,index:t}))))),S.length>0&&(e.push({type:b,itemKey:"section-muted",height:48,expanded:O}),O&&e.push(...S.map(((e,t)=>({type:P,itemKey:e.id.toString(),height:64,status:e,index:t}))))),e}),[d,m,S,O]);let F;F=C.StatusV3Collection.hasSynced()&&N.length>0?(0,j.jsx)(u.FlatList,{className:"statusList",itemEnterAnimationsEnabled:!0,flatListController:a.current,direction:"vertical",data:N,renderItem:R}):(0,j.jsx)(c.ListStatus,{});return(0,j.jsxs)("div",{className:_.default.listPanel,children:[(0,j.jsx)(M,{statusV3:L,onOpenStatus:e.onOpenStatus}),(0,j.jsx)(h.default,{className:_.default.listBody,flatListControllers:[a.current],children:F})]})};var i=n(a(48158)),s=a(67294),r=n(a(76610)),o=a(25142),l=a(17025),d=a(88419),c=a(92231),u=a(86025),h=n(a(19257)),f=n(a(67893)),p=a(86723),m=a(12950),g=n(a(2408)),v=n(a(55922)),C=a(70173),_=n(a(66246)),x=n(a(51130)),S=n(a(2966)),y=n(a(79939)),E=a(61192),j=a(85893);const I="SEC_UNREAD",T="SEC_READ",b="SEC_MUTED",P="ROW_STATUS";function M(e){var t;let a;const n=e.statusV3;let s,l;n&&(l=n.msgs);const c=()=>{const t=null==n?void 0:n.msgs;n&&(null==t?void 0:t.length)&&e.onOpenStatus(n,t.head(),0)};let u,h,f,v;if(n&&(null===(t=l)||void 0===t?void 0:t.length)){a=(0,j.jsx)(x.default,{statusV3:n,contact:n.contact,onClick:c});const e=(0,i.default)(l.last(),"myMsgs.last()").t;s=(0,j.jsx)("span",{className:_.default.secondaryHeaderText,children:o.Clock.relativeDateAndTimeStr(e)}),h={cursor:"pointer"},u=c}else a=(0,j.jsx)(d.DetailImage,{id:(0,p.getMaybeMeUser)(),theme:"status_v3",size:40}),s=(0,j.jsx)("span",{"data-a8n":r.default.key("status-no-updates"),className:_.default.secondaryHeaderText,children:g.default.t(1712)});m.GK.supportsFeature(m.GK.F.STATUS_V3_UI_SENDING)&&(f=(0,j.jsx)(S.default,{name:"menu"}),v=(0,j.jsx)(S.default,{name:"status-v3-create"}));const C=(0,j.jsx)("span",{"data-a8n":r.default.key("my-status"),className:_.default.primaryHeaderText,children:g.default.t(1711)});return(0,j.jsxs)("div",{className:_.default.panelHeader,style:h,onClick:u,children:[(0,j.jsx)("div",{className:_.default.headerButtonsPrimary,children:a}),(0,j.jsxs)("div",{className:_.default.headerText,children:[C,s]}),(0,j.jsxs)("div",{className:_.default.headerButtonsSecondary,children:[v,f]})]})}},32417:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a(94184)),s=a(67294),r=a(69162),o=a(86723),l=a(71681),d=a(70173),c=n(a(34763)),u=n(a(82616)),h=n(a(75666)),f=n(a(2966)),p=a(85893);class m extends s.Component{constructor(e){super(e),this._handleStatusAddRemove=()=>{this.setState({status:d.StatusV3Collection.getMyStatus()})},this.state={status:d.StatusV3Collection.getMyStatus()}}shouldComponentUpdate(e,t){return t.status!==this.state.status}componentDidMount(){const{sessionId:e,listeners:t}=this.props;(0,o.setLastStatusUsage)(),t.add(d.StatusV3Collection,"add remove",this._handleStatusAddRemove),t.add(r.Cmd,"dismiss_status_v3_viewer",(()=>{this.props.closeStatusViewer(!0)})),null!=e&&d.StatusV3Collection.logMetrics({type:"session",sessionId:e}),r.Cmd.onStatusViewerOpen()}render(){const{onOpenStatus:e}=this.props,t=(0,i.default)(u.default.v3_x,{});return(0,p.jsx)("div",{className:u.default.modalBackground,"data-animate-status-v3-modal-background":!0,children:(0,p.jsxs)("div",{className:u.default.mainWrapper,children:[(0,p.jsx)(c.default,{onOpenStatus:e}),(0,p.jsx)(h.default,{status:this.state.status,onOpenStatus:e}),(0,p.jsx)("button",{className:t,onClick:()=>this.props.closeStatusViewer(!0),children:(0,p.jsx)(f.default,{name:"x-viewer"})})]})})}}m.displayName="StatusV3Main";var g=(0,l.ListenerHOC)(m);t.default=g},75666:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const t=(0,_.jsx)(S,{statusV3:e.status,onOpenStatus:e.onOpenStatus});let a,n;d.GK.supportsFeature(d.GK.F.STATUS_V3_UI_SENDING)&&(a=(0,_.jsxs)("div",{className:f.default.updateWrapper,children:[(0,_.jsx)("div",{className:f.default.updateTitle,children:c.default.t(1717)}),(0,_.jsxs)("div",{className:f.default.uploadButtons,children:[(0,_.jsxs)("div",{className:f.default.buttonContainer,children:[(0,_.jsx)(g.default,{name:"status-v3-upload",className:f.default.buttonIcon}),c.default.t(1718)]}),(0,_.jsxs)("div",{className:f.default.buttonContainer,children:[(0,_.jsx)(g.default,{name:"status-v3-camera",className:f.default.buttonIcon}),c.default.t(1706)]})]})]}),n=(0,_.jsx)("hr",{}));return(0,_.jsxs)("div",{className:f.default.outStatusPanel,children:[a,n,t]})};var i=a(61295),s=a(67294),r=n(a(76610)),o=a(25142),l=a(88419),d=a(12950),c=n(a(2408)),u=a(71681),h=a(57636),f=n(a(15617)),p=n(a(50539)),m=n(a(51130)),g=n(a(2966)),v=n(a(27988)),C=a(12825),_=a(85893);class x extends s.Component{constructor(...e){super(...e),this.rerender=()=>{this.forceUpdate()}}componentDidMount(){const{statusV3:e,listeners:t}=this.props;e&&(t.add(e,"change:msgsChanged",this.rerender),e.loadMore(e.totalCount).catch((e=>{__LOG__(3)`error while loading all out status: ${String(e)}`})))}componentDidUpdate(e){const{listeners:t,statusV3:a}=this.props,{statusV3:n}=e;n!==a&&(n&&t.remove(n,"change:msgsChanged",this.rerender),a&&t.add(a,"change:msgsChanged",this.rerender))}render(){const e=this.props.statusV3;if(e&&e.msgs.length>0){const t=e.msgs.map((t=>(0,_.jsx)(E,{msg:t,status:e,onOpenStatus:this.props.onOpenStatus},t.id.toString())));return(0,_.jsxs)("div",{className:f.default.viewWrapper,children:[(0,_.jsx)("div",{className:f.default.viewTitle,children:c.default.t(1720)}),(0,_.jsx)("div",{className:f.default.viewUpdates,children:t})]})}return(0,_.jsxs)("div",{className:f.default.viewWrapper,children:[(0,_.jsx)("div",{className:f.default.placeholderIcon,children:(0,_.jsx)(g.default,{name:"status-v3-placeholder"})}),(0,_.jsx)("div",{"data-a8n":r.default.key("status-placeholder"),className:f.default.placeholderText,children:c.default.t(1713)})]})}}x.displayName="StatusV3OutViewerImpl";const S=(0,u.ListenerHOC)(x);class y extends s.Component{constructor(){super(...arguments),this.state={}}componentDidMount(){h.MsgInfoCollection.find(this.props.msg.id).then((e=>{this.props.getUnmountSignal().aborted||(this.props.listeners.add(e.read,"add remove",(()=>{this.setState({seenCount:e.read.length})})),this.setState({seenCount:e.read.length}))})).catch((0,i.filteredCatch)(C.EphemeralDrop,(()=>{})))}render(){const{msg:e,status:t}=this.props,a=(0,_.jsx)(l.DetailImage,{id:e.sender,theme:"status_v3",size:80});return(0,_.jsxs)("div",{className:f.default.outDetail,children:[(0,_.jsx)(m.default,{statusV3:t,msg:e,onClick:()=>this.props.onOpenStatus(t,e),contact:t.contact,role:"button",theme:"status-panel",thumbnailPlaceholder:a}),(0,_.jsx)("div",{className:f.default.seen,children:(0,_.jsx)(p.default,{seenCount:this.state.seenCount})}),(0,_.jsx)("div",{className:f.default.timestamp,children:o.Clock.relativeDateAndTimeStr(e.t)})]})}}y.displayName="StatusV3OutDetailImpl";const E=(0,v.default)((0,u.ListenerHOC)(y))},67868:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(67294),s=n(a(56720)),r=n(a(94589)),o=n(a(17747)),l=n(a(9042)),d=a(55588),c=n(a(25061)),u=n(a(67893)),h=n(a(2408)),f=a(14817),p=n(a(29430)),m=n(a(79939)),g=a(85893);const v={stickerContainer:{display:"p357zi0d",justifyContent:"ac2vgrno",marginTop:"hv5pdlef",marginBottom:"gdaqao4w",width:"ln8gz9je"},controlsContainer:{display:"p357zi0d",justifyContent:"ac2vgrno",marginBottom:"fhelu9n7"},controlsButton:{marginStart:"nzcjdldu",marginEnd:"gqi0zhd6"}};function C(e,t){const a=(0,m.default)((()=>new u.default)),{sticker:n,stickerPack:i,onSend:C,onBack:_}=e;return(0,g.jsxs)(o.default,{theme:"sticker-store",ref:t,children:[(0,g.jsx)(d.DrawerHeader,{title:h.default.t(1733),type:d.DRAWER_HEADER_TYPE.SMALL,onBack:_}),(0,g.jsx)(l.default,{flatListControllers:[a.current],children:(0,g.jsxs)(c.default,{animation:!1,theme:"padding-no-margin",shadow:!1,children:[(0,g.jsx)("div",{className:(0,s.default)(v.stickerContainer),children:(0,g.jsx)(p.default,{sticker:n,theme:"stickerDetails"},n.id)}),(0,g.jsx)(f.StickerDetailsStickerPackInfo,{name:i.name,publisher:i.publisher,theme:f.Theme.StickerStore}),(0,g.jsx)("div",{className:(0,s.default)(v.controlsContainer),children:(0,g.jsx)(r.default,{icon:"send",label:h.default.t(1736),a8nText:"sticker-action send-button",xstyle:v.controlsButton,theme:"new-chat-info",onClick:()=>{C(n)}})})]})})]},"sticker-details-modal")}var _=(0,i.forwardRef)(C);t.default=_},47779:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(67294),s=n(a(56720)),r=n(a(17747)),o=n(a(9042)),l=a(55588),d=n(a(25061)),c=a(85051),u=n(a(67893)),h=n(a(2408)),f=a(46714),p=n(a(95492)),m=n(a(29430)),g=a(45822),v=n(a(2966)),C=a(97504),_=n(a(79976)),x=n(a(79939)),S=n(a(20994)),y=a(85893);const E={titleContainer:{display:"p357zi0d",alignItems:"gndfcl4n",marginBottom:"or9x5nie"},title:{flexGrow:"tvf2evcx"},spinner:{display:"p357zi0d",alignItems:"gndfcl4n",justifyContent:"ac2vgrno",minHeight:"h2zl7k75"},animatedIcon:{marginStart:"oz0g9ue8",color:"kw851w1p"},contentContainer:{marginBottom:"dblt22a0",color:"hp667wtd",fontSize:"f8jlpxt4",lineHeight:"jgi8eev7"},stickersContainer:{display:"btb1m7bk",gridTemplateColumns:"dr6m1ylk",gridTemplateRows:"kenirpp9",gridColumnGap:"zqptfkjs",gridRowGap:"lhjw8glk",justifyContent:"o4u7okr9",width:"ln8gz9je",height:"ppled2lx"},emptyContainer:{display:"p357zi0d",justifyContent:"ac2vgrno",marginTop:"hv5pdlef",marginBottom:"gdaqao4w",width:"ln8gz9je"},emptySticker:{width:"sr23wnuw",height:"rjxfi64q",marginBottom:"dblt22a0",backgroundRepeat:"sxl192xd",backgroundSize:"hbhfgwk1"},emptyText:{textAlign:"qfejxiq4",marginBottom:"fhelu9n7"}};function j(e,t){const a=(0,x.default)((()=>new u.default)),{stickerPack:n,stickerPackId:j,onStickerClick:I,onStickerEnter:T,onBack:b,onClose:P}=e,M=function(e,t){return(0,_.default)(g.StickerPackCollectionMd,"add remove reset",(()=>e||(t?g.StickerPackCollectionMd.get(t):null)))||(null==t?null:void g.StickerPackCollectionMd.fetchStickerPack(t))}(n,j),w=function(e){return(0,_.default)(null==e?void 0:e.stickers,"add remove reset",(()=>null==e?void 0:e.stickers.toArray()))}(M),L=function(e){return(0,_.default)(g.StickerPackCollectionMd,"change:packFetchState",(()=>e?g.StickerPackCollectionMd.packFetchState.get(e):null))}(j),k=(0,S.default)();(0,i.useEffect)((()=>{k((()=>{null==M||M.stickers.fetch()}))}),[null==M?void 0:M.stickers,k]);const O=(e,t)=>{M&&I(e,M,t)},A=(e,t)=>{M&&T(e,M,t)};let D;return(j&&L===g.FETCH_STATE.PENDING||0===(null==w?void 0:w.length))&&(D=(0,y.jsx)(C.TextDiv,{theme:"plain",xstyle:E.spinner,children:(0,y.jsx)(f.Spinner,{size:50,stroke:4})})),(0,y.jsxs)(r.default,{theme:"sticker-store",ref:t,children:[(0,y.jsx)(l.DrawerHeader,{title:h.default.t(1733),type:l.DRAWER_HEADER_TYPE.SMALL,onBack:b,onCancel:P}),(0,y.jsx)(o.default,{flatListControllers:[a.current],children:(0,y.jsxs)(d.default,{animation:!1,theme:"padding-no-margin",shadow:!1,children:[M?(0,y.jsxs)(y.Fragment,{children:[(0,y.jsxs)(C.TextDiv,{theme:"title",xstyle:E.titleContainer,children:[(0,y.jsx)(c.EmojiText,{xstyle:E.title,text:M.name,ellipsify:!0,titlify:!0}),M.animated?(0,y.jsx)(v.default,{name:"round-play",className:(0,s.default)(E.animatedIcon),width:16,height:16}):null]}),M.publisher&&(0,y.jsx)(C.TextDiv,{theme:"plain",xstyle:E.contentContainer,children:(0,y.jsx)(c.EmojiText,{text:h.default.t(1722,{name:M.publisher})})}),M.description&&(0,y.jsx)(C.TextDiv,{theme:"plain",xstyle:E.contentContainer,children:(0,y.jsx)(c.EmojiText,{text:M.description})}),D,(0,y.jsx)("div",{className:(0,s.default)(E.stickersContainer),children:null==w?void 0:w.map((e=>(0,y.jsx)(m.default,{sticker:e,theme:"stickerStore",onClick:O,onEnter:A,dontShowViewPack:!0},e.id)))})]}):null,!M&&j&&L===g.FETCH_STATE.PENDING?D:null,M||j&&L===g.FETCH_STATE.PENDING?null:(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)("div",{className:(0,s.default)(E.emptyContainer),children:(0,y.jsx)("div",{className:(0,s.default)(E.emptySticker),style:{backgroundImage:`url(${p.default})`}})}),(0,y.jsx)(C.TextDiv,{theme:"plain",xstyle:[E.contentContainer,E.emptyText],children:(0,y.jsx)(c.EmojiText,{text:h.default.t(1735)})})]})]})})]},"sticker-pack-details-modal")}var I=(0,i.forwardRef)(j);t.default=I},14053:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(67294),s=(n(a(56720)),n(a(17747))),r=n(a(9042)),o=a(55588),l=n(a(25061)),d=n(a(67893)),c=n(a(2408)),u=a(46714),h=a(45822),f=n(a(25189)),p=a(97504),m=n(a(79976)),g=n(a(79939)),v=a(85893);const C={spinner:{display:"p357zi0d",alignItems:"gndfcl4n",justifyContent:"ac2vgrno",minHeight:"h2zl7k75"}};function _(e,t){const a=(0,m.default)(h.StickerPackCollectionMd,"add remove reset",(()=>h.StickerPackCollectionMd.filter((e=>null!=e.index)))),n=(0,g.default)((()=>new d.default));let i;return 0===a.length&&(i=(0,v.jsx)(p.TextDiv,{theme:"plain",xstyle:C.spinner,children:(0,v.jsx)(u.Spinner,{size:50,stroke:4})})),(0,v.jsxs)(s.default,{theme:"sticker-store",ref:t,children:[(0,v.jsx)(o.DrawerHeader,{title:c.default.t(1734),type:o.DRAWER_HEADER_TYPE.SMALL,onCancel:e.onClose}),(0,v.jsx)(r.default,{flatListControllers:[n.current],onScroll:t=>{var a;null===(a=e.onScrollOffsetChange)||void 0===a||a.call(e,t.currentTarget.scrollTop)},scrollOffset:e.scrollOffset,children:(0,v.jsxs)(l.default,{animation:!1,theme:"no-padding",shadow:!1,children:[i,(0,v.jsx)(f.default,{stickerPacks:a,onStickerPackDetails:e.onStickerPackDetails})]})})]},"sticker-store-modal")}var x=(0,i.forwardRef)(_);t.default=x},63252:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){const e=(0,i.useContext)(c.ThemeContext),[t,a]=(0,i.useState)(e.systemThemeMode?"system":e.theme),n=e=>{const t=e.target.value;"light"!==t&&"dark"!==t&&"system"!==t||a(t)};return(0,u.jsxs)(r.default,{title:o.default.t(1773),onOK:()=>{"system"===t?(e.setSystemThemeMode(!0),e.setTheme(d.default.currentTheme)):(e.setSystemThemeMode(!1),e.setTheme(t)),s.Cmd.closeModal()},onCancel:()=>{s.Cmd.closeModal()},children:[(0,u.jsx)("form",{children:(0,u.jsxs)("ol",{children:[(0,u.jsx)("li",{children:(0,u.jsxs)("label",{className:l.default.label,children:[(0,u.jsx)("input",{type:"radio",name:"theme",value:"light",className:l.default.input,checked:"light"===t,onChange:n}),o.default.t(1772)]})},"light"),(0,u.jsx)("li",{children:(0,u.jsxs)("label",{className:l.default.label,children:[(0,u.jsx)("input",{type:"radio",name:"theme",value:"dark",className:l.default.input,checked:"dark"===t,onChange:n}),o.default.t(1771)]})},"dark"),(0,u.jsx)("li",{children:(0,u.jsxs)("label",{className:l.default.label,children:[(0,u.jsx)("input",{type:"radio",name:"theme",value:"system",className:l.default.input,checked:"system"===t,onChange:n}),o.default.t(1774)]})},"system")]})}),null,null]})};var i=a(67294),s=a(69162),r=n(a(75940)),o=n(a(2408)),l=n(a(25232)),d=n(a(45812)),c=a(13038),u=a(85893)},36798:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{chat:t,msgs:a}=e;return(0,d.jsx)(r.default,{onOK:()=>{t&&t.pendingAction++,i.ChatCollection.unstarAllMessages(a,t).finally((()=>{t&&t.pendingAction--})),s.Cmd.closeModal()},okText:l.default.t(1799),onCancel:c,children:(0,d.jsx)("div",{children:(0,d.jsx)(o.EmojiText,{text:l.default.t(1800)})})})};var i=a(84758),s=a(69162),r=n(a(75940)),o=a(85051),l=n(a(2408)),d=a(85893);const c=()=>{s.Cmd.closeModal()}},45953:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{contactList:t,onSend:a,onBack:n,chat:m}=e;let _;switch(m.kind){case i.CHAT_KIND.CHAT:_=c.default.t(652,{chat:m.title(),count:c.default.n(t.length),_plural:t.length});break;case i.CHAT_KIND.GROUP:_=c.default.t(653,{chat:m.title(),count:c.default.n(t.length),_plural:t.length});break;case i.CHAT_KIND.BROADCAST:_=c.default.t(651,{chat:m.title(),count:c.default.n(t.length),_plural:t.length})}const x=_?(0,v.jsx)(l.EmojiText,{text:_,direction:"auto",titlify:!0,ellipsify:!0}):null;return(0,v.jsx)(u.Modal,{type:u.ModalTheme.Box,children:(0,v.jsxs)(s.default,{children:[(0,v.jsx)(o.DrawerHeader,{type:o.DRAWER_HEADER_TYPE.POPUP,onBack:n,children:x}),(0,v.jsx)(r.default,{children:(0,v.jsx)(d.HotKeys,{children:(0,v.jsx)("div",{className:p.default.body,children:t.map(((e,t)=>(0,v.jsx)(C,{contact:(0,g.vcardFromContactModel)(e)},t.toString())))})})}),(0,v.jsx)("div",{className:p.default.btnContainer,children:(0,v.jsx)("div",{className:p.default.btnPosition,children:(0,v.jsx)(h.Round,{large:!0,onClick:a,children:(0,v.jsx)(f.default,{name:"send",directional:!0})})})})]})})};var i=a(58380),s=n(a(17747)),r=n(a(9042)),o=a(55588),l=a(85051),d=a(39e3),c=n(a(2408)),u=a(79475),h=a(3132),f=n(a(2966)),p=n(a(83314)),m=n(a(46873)),g=a(50313),v=a(85893);function C({contact:e}){const t=(0,g.parseVcard)(e.vcard);return t?(0,v.jsx)("div",{className:p.default.vcardWrapper,children:(0,v.jsx)(m.default,{parsedVcard:t,thumbnail:(0,g.vcardThumbnail)(t)})}):null}},409:(e,t,a)=>{"use strict";var n=a(20862),i=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=a(61295),r=i(a(94184)),o=a(18400),l=i(a(31339)),d=a(67294),c=a(70359),u=i(a(78899)),h=i(a(69991)),f=a(69162),p=i(a(55454)),m=a(17025),g=i(a(5481)),v=i(a(17747)),C=i(a(9042)),_=a(55588),x=a(41024),S=n(a(13540)),y=a(4919),E=a(57092),j=a(97227),I=a(85103),T=a(86723),b=i(a(22079)),P=a(12950),M=a(47683),w=i(a(52087)),L=a(16719),k=i(a(2408)),O=a(71681),A=n(a(10214)),D=i(a(37360)),R=a(20845),N=i(a(84653)),F=a(46714),B=i(a(79485)),U=i(a(2966)),H=a(97504),G=i(a(69217)),V=i(a(27988)),W=a(88515),z=i(a(17040)),K=i(a(92018)),q=a(85893);class Y extends d.Component{constructor(...e){super(...e),this.state={hover:!1,currentQRBinary:null,currentQRData:null},this.handleMouseOver=()=>{this.state.hover||this.setState({hover:!0})},this.handleMouseEnter=()=>{this.state.hover||this.setState({hover:!0})},this.handleMouseLeave=()=>{this.state.hover&&this.setState({hover:!1})},this._setRefQRCodeContainer=e=>{this._refQRCodeContainer=e}}componentDidMount(){this.props.binary&&this._generateQRCode()}componentDidUpdate(){this._generateQRCode()}shouldComponentUpdate(e,t){return!(this._compareBinary(e.binary,this.props.binary)&&this._compareBinary(t.currentQRBinary,this.state.currentQRBinary)&&e.visible===this.props.visible&&t.hover===this.state.hover&&t.currentQRData===this.state.currentQRData)}_fingerprintsMatched(e,t){return!!e&&!!t&&ue(e.publicKey,t.publicKey)&&ue(e.identifier,t.identifier)}_compareBinary(e,t){if(!e&&!t)return!0;const a=(0,o.decodeProtobuf)(I.CombinedFingerprintSpec,e),n=(0,o.decodeProtobuf)(I.CombinedFingerprintSpec,t);if(!a&&!n)return!0;if(!(null!=a.version||null!=n.version||a.localFingerprint||n.localFingerprint||a.remoteFingerprint||n.remoteFingerprint))return!0;if(a.version!==n.version)return!1;const i=this._fingerprintsMatched(a.localFingerprint,n.localFingerprint),s=this._fingerprintsMatched(a.remoteFingerprint,n.remoteFingerprint);return i&&s}_generateQRCode(){const e=this._refQRCodeContainer,t=this.props.binary;if(!e||!t)return void this.setState({currentQRBinary:null,currentQRData:null});if(this._compareBinary(this.state.currentQRBinary,t))return;for(this.qr&&delete this.qr;e.firstChild;)e.removeChild(e.firstChild);this.qr=new D.default(e,{text:t,width:p.default.QR_EDGE/2,height:p.default.QR_EDGE/2,correctLevel:D.default.CorrectLevel.L}),this.setState({currentQRBinary:t});const a=e.getElementsByTagName("canvas")[0];a?this._storeQRData(a):this.setState({currentQRData:null})}_storeQRData(e){const t=document.createElement("canvas");t.width=e.width+10,t.height=e.height+10;const a=t.getContext("2d");a.fillStyle="white",a.fillRect(0,0,t.width,t.height),a.drawImage(e,5,5),t.toBlob((e=>this.setState({currentQRData:e})),"image/png")}render(){let e=null;if(this.props.visible){let t=null;if(this.state.hover&&this.state.currentQRData){const e=this.props.contact.formattedUser||"",a=m.ContactCollection.assertGet((0,T.getMaybeMeUser)()).formattedUser;t=(0,q.jsx)(g.default,{file:this.state.currentQRData,download:"Verification Code between "+a+" and "+e,extension:j.AllowedFileExtensions.PNG,children:(0,q.jsx)(u.default,{text:k.default.t(2321)})})}e=(0,q.jsxs)("div",{onMouseOver:this.handleMouseOver,onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,children:[t,(0,q.jsx)("div",{className:z.default.circle,ref:this._setRefQRCodeContainer})]})}return e}}function Q({visible:e}){let t=null;return e&&(t=(0,q.jsx)("div",{className:z.default.circle,children:(0,q.jsx)("div",{className:z.default.spinner,children:(0,q.jsx)(F.Spinner,{size:52,stroke:4})})})),t}function X({binary:e,contact:t,visible:a}){let n=null;return a&&(n=(0,q.jsxs)("div",{className:(0,r.default)(z.default.container,z.default.circleContainer),children:[(0,q.jsx)(Y,{visible:!!e,binary:e,contact:t}),(0,q.jsx)(Q,{visible:!e})]})),n}Y.defaultProps={binary:null},Y.displayName="VerificationQRCode";class Z extends d.Component{shouldComponentUpdate(e){return e.string!==this.props.string}_numDigitsInVerificationString(){return 60}render(){if(!this.props.string)return(0,q.jsx)("div",{children:k.default.t(1133)});const e=this.props.string;if(e.length!==this._numDigitsInVerificationString())return __LOG__(3)`verificationString:render this.props.stringshould be ${this._numDigitsInVerificationString()} characters long instead of ${e.length}.`,(0,q.jsx)("div",{children:k.default.t(2327)});const t=[];for(let a=0;a<3;a++){const n=[];for(let t=0;t<4;t++){const i=[];for(let n=0;n<5;n++){const s=e.charAt(5*a*4+5*t+n);i.push((0,q.jsx)("span",{className:z.default.digit,children:s},n))}n.push((0,q.jsx)("span",{className:z.default.block,children:i},t))}t.push((0,q.jsx)(R.SelectableDiv,{className:z.default.row,selectable:!0,children:n},a))}return(0,q.jsx)(R.SelectableDiv,{selectable:!0,children:t})}}function $({visible:e}){let t=null;return e&&(t=(0,q.jsx)("div",{className:(0,r.default)(z.default.container,z.default.checkmarkContainer),children:(0,q.jsx)("div",{className:z.default.checkmark,children:"✓ "})})),t}function J({visible:e}){let t=null;return e&&(t=(0,q.jsx)("div",{className:(0,r.default)(z.default.container,z.default.errorContainer),children:(0,q.jsx)("div",{className:z.default.error,children:"!"})})),t}function ee({children:e}){return(0,q.jsx)("div",{className:z.default.errorBanner,children:e})}Z.defaultProps={string:null},Z.displayName="VerificationString";class te extends d.Component{constructor(...e){super(...e),this._refVerificationVideo=(0,d.createRef)(),this.handleVideoLoaded=()=>{null==this._captureInterval&&(this._adjustOverlayPosition(),this._captureInterval=this.props.setInterval(this.capture,200))},this.capture=()=>{var e;const t=null===(e=this._refVerificationVideo.current)||void 0===e?void 0:e.underlyingVideo();if(!t)return;const a=document.createElement("canvas");a.width=t.videoWidth/2,a.height=t.videoHeight/2;a.getContext("2d").drawImage(t,a.width/2,a.height/2,a.width,a.height,0,0,a.width,a.height),a.toBlob((e=>{const t=window.URL.createObjectURL(e);__LOG__(2)`objectURL: ${t}`,this.props.onCapture(t)}),"image/jpeg",1)},this._adjustOverlayPosition=()=>{var e;const t=null===(e=this._refVerificationVideo.current)||void 0===e?void 0:e.underlyingVideo(),a=this._refVerificationOverlay;if(!t||!a)return;const n=t.offsetHeight,i=t.offsetWidth,s=i/3,r=s;a.style.width=s+"px",a.style.height=r+"px",a.style.margin=(n-r)/2+"px "+(i-s)/2+"px"},this._setRefVerificationOverlay=e=>{this._refVerificationOverlay=e}}componentDidMount(){this.props.listeners.add(window,"resize",this._adjustOverlayPosition),(0,A.isSrcObjectInVideoElement)()||(this._videoURL=window.URL.createObjectURL(this.props.stream))}componentWillUnmount(){var e,t;null!=this._captureInterval&&this.props.clearInterval(this._captureInterval),this.props.stream&&(null===(e=(t=this.props).disposeStream)||void 0===e||e.call(t),this._videoURL&&window.URL.revokeObjectURL(this._videoURL))}render(){let e=null;return this.props.stream&&(e=(0,q.jsxs)("div",{className:z.default.webcam,children:[(0,q.jsx)("div",{className:z.default.webcamVideo,children:(0,q.jsx)(K.default,{autoPlay:!0,ref:this._refVerificationVideo,onPlay:this.handleVideoLoaded,src:this._videoURL?this._videoURL:void 0,srcObject:this._videoURL?void 0:this.props.stream,width:"100%"})}),(0,q.jsx)("div",{className:z.default.overlay,ref:this._setRefVerificationOverlay}),(0,q.jsx)("button",{onClick:this.props.onClose,className:z.default.btnClose,children:(0,q.jsx)(U.default,{name:"x-alt"})})]})),e}}te.displayName="VerificationWebcamComponent";const ae=(0,O.ListenerHOC)((0,G.default)(te)),ne=0,ie=1,se=2,re=3,oe=4,le=5;class de extends d.Component{constructor(...e){super(...e),this.state={circleVisible:!0,checkmarkVisible:!1,errorIconVisible:!1,webcamVisible:!1,bannerVisible:!1,bannerText:null,stream:null,isDragging:!1,binaryMD:null,stringMD:null},this._handleIdentityKeyMissing=()=>{f.Cmd.openModal((0,q.jsx)(N.default,{name:this.props.contact.formattedUser,onOK:()=>{this.props.onClose?this.props.onClose():this.props.uim.uie.requestDismiss()}}))},this.handleDragChange=e=>{this.setState({isDragging:e})},this.handleDrop=e=>{this.props.contact.verificationBinary&&this.props.contact.verificationString&&this._handleUploadSelect(e)},this._setIdentityState=()=>{(0,W.getIdentityVerificationDataJob)(this.props.contact.id).then((e=>{this.props.getUnmountSignal().aborted||(e?(ue(this.state.binaryMD,e.binary)&&!e.string!==this.state.stringMD||(null!=this.state.binaryMD&&f.Cmd.openModal((0,q.jsx)(x.E2EChangeModal,{contact:this.props.contact})),this.setState({binaryMD:e.binary,stringMD:e.string})),this._refreshTimer=this.props.setTimeout((()=>{this._setIdentityState()}),1e3)):(null!=this._refreshTimer&&this.props.clearTimeout(this._refreshTimer),this._handleIdentityKeyMissing()))}))},this._showWebcamHint=()=>{this.state.webcamVisible&&!this.state.bannerVisible&&this._showBanner(k.default.t(2331))},this._handleWebcamOpen=()=>{const{asyncStream:e,disposeStream:t}=A.start("camera");this._disposeStream=t,e.then((e=>this._showWebcamStream(e))).catch((0,s.filteredCatch)(S.GUM.NotAllowedError,(()=>{f.Cmd.openModal((0,q.jsx)(M.GuidePopup,{messaging:M.Messaging.CAMERA_FAIL,type:M.TYPE.GUIDE_UNBLOCK}))}))).catch((0,s.filteredCatch)(S.GUM.GUMError,(()=>{f.Cmd.openModal((0,q.jsx)(M.GuidePopup,{messaging:M.Messaging.CAMERA_MISSING,type:M.TYPE.GUIDE_NONE}))})))},this._handleWebcamClose=()=>{this.setState({webcamVisible:!1,bannerVisible:!1,stream:null}),this._disposeStream=null},this._handleWebcamCapture=e=>{this._verifyImage(e,!0)},this._handleUploadClick=()=>{const e=this._refVerificationFilePickerInput;e&&e.click()},this._handleUploadSelect=e=>{e.stopPropagation();const t=e.target.files||e.dataTransfer.files;if(!t||!t[0])return;const a=t[0],n=URL.createObjectURL(a);this._verifyImage(n,!1);const i=this._refVerificationFilePickerForm;i&&i.reset()},this.handleClose=()=>{this.props.onClose?this.props.onClose():this.props.uim.uie.requestDismiss()},this._hideCheckmark=()=>{this.state.errorIconVisible||this.setState({circleVisible:!0}),this.setState({checkmarkVisible:!1})},this._hideError=()=>{this.state.checkmarkVisible||this.setState({circleVisible:!0}),this.setState({errorIconVisible:!1})},this._hideBanner=()=>{this.setState({bannerVisible:!1})},this._setRefVerificationFilePickerForm=e=>{this._refVerificationFilePickerForm=e},this._setRefVerificationFilePickerInput=e=>{this._refVerificationFilePickerInput=e}}componentDidMount(){P.GK.supportsFeature(P.GK.F.MD_BACKEND)?this._setIdentityState():(0,L.queryIdentity)(this.props.contact)}componentDidUpdate(e){e.contact===this.props.contact||P.GK.supportsFeature(P.GK.F.MD_BACKEND)||(0,L.queryIdentity)(this.props.contact)}componentWillUnmount(){var e;null===(e=this._disposeStream)||void 0===e||e.call(this)}_showWebcamStream(e){this.setState({webcamVisible:!0,circleVisible:!0,checkmarkVisible:!1,errorIconVisible:!1,stream:e}),null!=this._hintTimer&&(this.props.clearTimeout(this._hintTimer),delete this._hintTimer),this._hintTimer=this.props.setTimeout(this._showWebcamHint,7e3)}_getErrorBannerText(e){let t;const a=this.props.contact.formattedShortName;switch(e){case se:t=k.default.t(2325,{contact:a});break;case re:case oe:t=k.default.t(2324,{contact:a});break;case le:default:t=k.default.t(2323)}return t}_showCheckmark(){this._handleWebcamClose(),this.setState({circleVisible:!1,checkmarkVisible:!0,errorIconVisible:!1,bannerVisible:!1}),null!=this._iconTimer&&(this.props.clearTimeout(this._iconTimer),delete this._iconTimer),this._iconTimer=this.props.setTimeout(this._hideCheckmark,3e3)}_showErrorIcon(){this._handleWebcamClose(),this.setState({circleVisible:!1,checkmarkVisible:!1,errorIconVisible:!0,bannerVisible:!1}),null!=this._iconTimer&&(this.props.clearTimeout(this._iconTimer),delete this._iconTimer),this._iconTimer=this.props.setTimeout(this._hideError,3e3)}_showErrorBanner(e){const t=this._getErrorBannerText(e);this._showBanner(t)}_showBanner(e){this.setState({circleVisible:!0,checkmarkVisible:!1,errorIconVisible:!1,bannerVisible:!0,bannerText:e}),null!=this._bannerTimer&&(this.props.clearTimeout(this._bannerTimer),delete this._bannerTimer),this._bannerTimer=this.props.setTimeout(this._hideBanner,5e3)}_validateFingerprint(e){var t,a,n,i,s,r,l,d,c,u,h,f;if(!e||0===!e.version||!e.localFingerprint||!e.remoteFingerprint)return le;let p=new ArrayBuffer(0);p=P.GK.supportsFeature(P.GK.F.MD_BACKEND)?this.state.binaryMD:this.props.contact.verificationBinary;const m=(0,o.decodeProtobuf)(I.CombinedFingerprintSpec,p);if(ue(null===(t=e.localFingerprint)||void 0===t?void 0:t.identifier,null===(a=m.localFingerprint)||void 0===a?void 0:a.identifier)&&ue(null===(n=e.remoteFingerprint)||void 0===n?void 0:n.identifier,null===(i=m.remoteFingerprint)||void 0===i?void 0:i.identifier))return ne;const g=ue(null===(s=e.remoteFingerprint)||void 0===s?void 0:s.identifier,null===(r=m.localFingerprint)||void 0===r?void 0:r.identifier),v=ue(null===(l=e.localFingerprint)||void 0===l?void 0:l.identifier,null===(d=m.remoteFingerprint)||void 0===d?void 0:d.identifier);if(!g&&!v)return oe;if(!g)return se;if(!v)return re;const C=ue(null===(c=e.remoteFingerprint)||void 0===c?void 0:c.publicKey,null===(u=m.localFingerprint)||void 0===u?void 0:u.publicKey),_=ue(null===(h=e.localFingerprint)||void 0===h?void 0:h.publicKey,null===(f=m.remoteFingerprint)||void 0===f?void 0:f.publicKey);return C&&_?ne:ie}_decodeQRCode(e){return new Promise(((t,a)=>{l.default.callback=(e,n)=>{if(n)a(n);else if(e.length<1)a("QR decoder did not return decoded binary");else{const a=new Uint8Array(e[0]);t(a)}},l.default.decode(e)}))}_verifyImage(e,t){this._decodeQRCode(e).then((e=>(0,o.decodeProtobuf)(I.CombinedFingerprintSpec,e))).then((e=>{const a=this._validateFingerprint(e);a?t&&a===le||(this.setState({errorType:a}),a===ie?this._showErrorIcon():this._showErrorBanner(a)):this._showCheckmark()})).catch((()=>{t||(this.setState({errorType:le}),this._showErrorBanner(le))})).finally((()=>{window.URL.revokeObjectURL(e)}))}render(){let e=null,t=null,a=null,n=null,i=null,s=null,r=new ArrayBuffer(0),o="";return P.GK.supportsFeature(P.GK.F.MD_BACKEND)?(r=this.state.binaryMD,o=this.state.stringMD,s=(0,c.getABPropConfigValue)("adv_v2_m6")?k.default.t(2170,{contactName:this.props.contact.formattedShortName}):k.default.t(2169,{contactName:this.props.contact.formattedShortName})):(r=this.props.contact.verificationBinary,o=this.props.contact.verificationString,s=k.default.t(2326)),r&&(b.default&&(e=(0,q.jsx)("div",{className:z.default.section,children:(0,q.jsx)(h.default,{type:"primary",onClick:this.state.webcamVisible?this._handleWebcamClose:this._handleWebcamOpen,children:this.state.webcamVisible?k.default.t(2330):k.default.t(2332)})})),t=(0,q.jsxs)("div",{className:z.default.section,children:[(0,q.jsx)(h.default,{type:"primary",onClick:this._handleUploadClick,children:k.default.t(2329)}),(0,q.jsx)("p",{className:z.default.dragAndDropExplanation,children:this.state.isDragging?k.default.t(2322):null})]}),a=(0,q.jsx)("form",{ref:this._setRefVerificationFilePickerForm,children:(0,q.jsx)("input",{ref:this._setRefVerificationFilePickerInput,accept:"image/*",type:"file",style:{display:"none"},onChange:this._handleUploadSelect,onClick:e=>e.stopPropagation()})})),this.state.webcamVisible&&this.state.stream&&(n=(0,q.jsx)(ae,{stream:this.state.stream,disposeStream:this._disposeStream,onCapture:this._handleWebcamCapture,onClose:this._handleWebcamClose})),this.state.bannerVisible&&(i=(0,q.jsx)(ee,{children:this.state.bannerText})),(0,q.jsxs)(v.default,{onDrop:this.handleDrop,onDragChange:this.handleDragChange,children:[(0,q.jsxs)(_.DrawerHeader,{type:_.DRAWER_HEADER_TYPE.SMALL,onBack:this.handleClose,children:[(0,q.jsx)(H.TextDiv,{theme:"title",children:k.default.t(2328)}),(0,q.jsxs)(H.TextDiv,{theme:"small",children:[k.default.t(2338),", ",this.props.contact.formattedUser]})]}),n,i,(0,q.jsx)(C.default,{children:(0,q.jsxs)("div",{className:z.default.form,children:[(0,q.jsxs)("div",{className:z.default.photo,children:[(0,q.jsx)(X,{binary:r,contact:this.props.contact,visible:this.state.circleVisible}),(0,q.jsx)($,{visible:this.state.checkmarkVisible}),(0,q.jsx)(J,{visible:this.state.errorIconVisible})]}),(0,q.jsx)("div",{className:z.default.section,children:(0,q.jsx)("div",{className:z.default.code,children:(0,q.jsx)(Z,{string:o})})}),(0,q.jsx)("div",{className:z.default.section,children:(0,q.jsxs)("p",{className:z.default.explanation,children:[(0,q.jsxs)("span",{children:[s," "]}),(0,q.jsx)(y.ExternalLink,{href:(0,E.getE2EFaqUrl)(),children:k.default.t(1091)})]})}),e,t,a]})})]})}}de.CONCERNS={contact:["verificationBinary","verificationString","formattedUser","formattedShortName","id"]},de.displayName="VerificationDrawer";var ce=(0,w.default)((0,V.default)((0,G.default)((0,B.default)(de,de.CONCERNS))));function ue(e,t){if(!e||!t)return!1;const a=new Uint8Array(e),n=new Uint8Array(t),i=a.length;if(i!==n.length)return!1;for(let e=0;e<i;e++)if(a[e]!==n[e])return!1;return!0}t.default=ce},12824:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a(94184)),s=a(67294),r=n(a(76610)),o=n(a(94822)),l=a(33287),d=a(69162),c=n(a(55454)),u=n(a(17747)),h=n(a(9042)),f=a(55588),p=n(a(2408)),m=a(65565),g=n(a(79485)),v=a(97504),C=a(13038),_=a(49201),x=a(62437),S=n(a(26163)),y=a(85893);class E extends s.Component{constructor(...e){super(...e),this.state={hover:!1},this.handleClick=()=>{const e=this._encodeColor(),t=o.default.get("defaultPreference");t&&e!==t.wallpaperColor&&(t.set("wallpaperColor",e),d.Cmd.openToast((0,y.jsx)(_.Toast,{msg:p.default.t(1974),id:(0,_.genId)()})))},this.handleMouseOver=()=>{this.state.hover||(this.setState({hover:!0}),o.default.trigger("wallpaper_color_preview",this._encodeColor()))},this.handleMouseEnter=()=>{this.state.hover||(this.setState({hover:!0}),o.default.trigger("wallpaper_color_preview",this._encodeColor()))},this.handleMouseLeave=()=>{this.state.hover&&(this.setState({hover:!1}),o.default.trigger("wallpaper_color_preview"))},this._encodeColor=()=>{const{colorHex:e,isDefault:t}=this.props;return t?c.default.DEFAULT_CHAT_WALLPAPER:e}}render(){const e=this.props.isDefault?(0,y.jsx)("span",{className:S.default.wallpaperDefaultTitle,"data-a8n":r.default.key("wallpaper-default-title"),children:p.default.t(699)}):null,t=(0,i.default)(S.default.wallpaperColorCanvas,{[S.default.canvasHover]:this.state.hover,[S.default.canvasActive]:this.props.isSelected,[S.default.canvasDefault]:this.props.isDefault});return(0,y.jsx)("span",{className:t,style:{backgroundColor:this.props.colorHex},onMouseOver:this.handleMouseOver,onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,onClick:this.handleClick,title:this.props.isDefault?p.default.t(699):null,children:e})}}E.displayName="ColorCanvas";class j extends s.Component{constructor(...e){super(...e),this._handleWallpaperDoodleChange=()=>{const{chatPreference:e}=this.props;if(e){const t=!e.showDoodle;e.set("showDoodle",t),d.Cmd.openToast((0,y.jsx)(_.Toast,{msg:t?p.default.t(1975):p.default.t(1976),id:(0,_.genId)()}))}}}render(){let e;const{chatPreference:t,colors:a}=this.props,n=null==t?void 0:t.wallpaperColor,i=null==t?void 0:t.showDoodle,s=a.map((e=>(0,y.jsx)(E,{colorHex:e,isSelected:n===e,isDefault:!1},e))),r=(0,y.jsx)(E,{isSelected:n===c.default.DEFAULT_CHAT_WALLPAPER,isDefault:!0},c.default.DEFAULT_CHAT_WALLPAPER);s.unshift(r);for(let e=0;e<2;e++)s.push((0,y.jsx)("div",{className:S.default.wallpaperColorEmpty},"emptyEl"+e));return m.ServerProps.wallpapersV2&&(e=(0,y.jsxs)("div",{className:S.default.wallpaperApplyDoodle,children:[(0,y.jsx)(l.CheckBox,{onChange:this._handleWallpaperDoodleChange,checked:!!i}),(0,y.jsx)(v.TextSpan,{className:S.default.checkboxLabel,theme:"small",children:p.default.t(1973)})]})),(0,y.jsxs)(y.Fragment,{children:[e,(0,y.jsx)("div",{className:S.default.wallpaperColorGrid,children:s})]})}}j.CONCERNS={chatPreference:["wallpaperColor","showDoodle"]},j.displayName="ColorGridClass";const I=(0,g.default)(j,j.CONCERNS);class T extends s.Component{componentWillUnmount(){o.default.trigger("wallpaper_color_preview"),m.ServerProps.wallpapersV2&&o.default.trigger("wallpaper_drawer_close")}componentDidMount(){m.ServerProps.wallpapersV2&&o.default.trigger("wallpaper_drawer_open")}render(){return(0,y.jsxs)(u.default,{children:[(0,y.jsx)(f.DrawerHeader,{title:p.default.t(1977),onBack:this.props.onClose,type:f.DRAWER_HEADER_TYPE.LARGE}),(0,y.jsx)(h.default,{children:(0,y.jsx)(I,{colors:(0,x.getWallpaperColors)(this.context.theme),chatPreference:o.default.get("defaultPreference")})})]})}}t.default=T,T.contextType=C.ThemeContext,T.displayName="WallpaperDrawer"},38859:(e,t,a)=>{"use strict";var n=a(20862),i=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{userIsCartOwner:t,orderId:a,token:n,sellerJid:i,onProductDetail:R,onOrderCreate:N,ownerHasReviewed:F,chat:B,orderMessage:U,onOrderCancel:H}=e,[G,V]=(0,o.useState)(!0),[W,z]=(0,o.useState)("PENDING"),[K,q]=(0,o.useState)(null),[Y,Q]=(0,o.useState)(""),X=(0,k.default)((()=>new _.default));(0,o.useEffect)((()=>{T.OrderCollection.findOrder(a,i,n).then((e=>{V(!1),z("SUCCESS"),q(e),(0,E.qplAnnotateOrderView)((null==K?void 0:K.products.length)||0),(0,E.qplEndOrderView)(M.QuickLogActionType.SUCCESS)})).catch((0,s.filteredCatch)(O.E404,(()=>{c.Cmd.openModal((0,D.jsx)(u.default,{onOK:()=>{c.Cmd.closeModal()},okText:y.default.t(2192),children:y.default.t(1425)})),V(!1),z("ERROR"),(0,E.qplDropOrderView)()}))).catch((()=>{V(!1),z("ERROR"),__LOG__(4,!0,new Error,!0)`Catalog Order Display failed`,SEND_LOGS("OrderDetails: failed to display"),(0,E.qplEndOrderView)(M.QuickLogActionType.FAIL)}))}),[]);const Z=()=>{c.Cmd.closeDrawerRight()},$=()=>{if(Z(),null!=U){const e=y.default.t(1422)+"\n"+Y;(0,w.sendTextMsgToChat)(B,e,{quotedMsg:new j.Msg(U)})}c.Cmd.openChatFromUnread(B)},J=()=>{if(!(0,S.orderDetailsFromCartEnabled)()||F)return null;if(!(0,A.createUserWid)(i).equals((0,x.getMaybeMeUser)()))return null;const e=null==K?void 0:K.products.some((e=>null==e.price));return(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(v.default,{children:(0,D.jsx)(m.default,{disabled:e,a8nText:"order-create",color:"dark",onClick:()=>N((0,I.default)(K,"order")),children:y.default.t(1418)})}),(0,D.jsx)(v.default,{children:(0,D.jsx)(m.default,{a8nText:"order-decline",color:"dark",onClick:H,children:y.default.t(1420)})})]})};return(0,D.jsxs)(f.default,{theme:"striped",onDrop:Z,children:[(0,D.jsx)(g.DrawerHeader,{title:t?y.default.t(435):y.default.t(434),type:g.DRAWER_HEADER_TYPE.SMALL,onBack:Z}),(0,D.jsx)(p.default,{flatListControllers:[X.current],children:(()=>{if(G||null==K)return(0,D.jsx)(C.default,{fetchState:W});let e="";e=K.products.length>0?y.default.t(1080,{count:K.totalItemCount||0,_plural:K.totalItemCount||0}):y.default.t(1435);const t=(0,D.jsx)(L.TextDiv,{theme:"title",children:e});let a=null;a=null!=K.total&&0!==K.total?y.default.t(1430,{subtotal:h.formatAmount1000(K.currency,K.total)}):y.default.t(1417);const n=(0,D.jsx)(L.TextDiv,{theme:"muted-small",children:a});let s=null;if(null!=K.createdAt){const e=d.Clock.timeStr(K.createdAt);s=(0,D.jsx)(L.TextSpan,{theme:"muted-small",children:`${e}`})}return(0,D.jsxs)(D.Fragment,{children:[(0,D.jsxs)(v.default,{children:[(0,D.jsx)(C.default,{fetchState:W}),(0,D.jsxs)("div",{className:l.default.info,children:[t,n]}),(0,D.jsx)(P.default,{flatListController:X.current,onProductDetail:R,order:K,sellerJid:i}),(0,D.jsx)("div",{className:l.default.date,children:s}),F?(0,D.jsx)("div",{className:l.default.composerWrapper,children:(0,D.jsx)(b.default,{chat:B,onChange:Q,onSubmit:$,value:Y,placeholder:r.fbt._("Add a cancelation note (Optional)",null,{hk:"3wINsP"})})}):null]}),J()]})})()})]})};var s=a(61295),r=a(48360),o=a(67294),l=i(a(22880)),d=a(25142),c=a(69162),u=i(a(75940)),h=n(a(61447)),f=i(a(17747)),p=i(a(9042)),m=i(a(17061)),g=a(55588),v=i(a(25061)),C=i(a(8212)),_=i(a(67893)),x=a(86723),S=a(78615),y=i(a(2408)),E=a(90676),j=a(92954),I=i(a(91619)),T=a(98052),b=i(a(87106)),P=i(a(50320)),M=a(21125),w=a(30239),L=a(97504),k=i(a(79939)),O=a(12825),A=a(89573),D=a(85893)},15540:(e,t,a)=>{"use strict";var n=a(20862),i=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=i(a(81109)),r=a(26593),o=a(48360),l=a(67294),d=(i(a(56720)),a(69162)),c=n(a(61447)),u=i(a(17747)),h=i(a(9042)),f=a(55588),p=i(a(25061)),m=a(63290),g=i(a(2408)),v=i(a(42590)),C=a(35045),_=a(80257),x=i(a(63035)),S=i(a(86544)),y=i(a(6618)),E=i(a(24430)),j=i(a(87106)),I=i(a(51902)),T=a(97504),b=a(89573),P=a(85893);function M({children:e}){return(0,P.jsx)(T.TextSpan,{color:"secondary",size:"16",children:e})}function w(e){for(const t in e)if(null!=e[t])return!0;return!1}const L={orderProductSummaryContainer:{marginTop:"jdreu547",marginEnd:"jnwc1y2a",marginBottom:"n5a6z3tu",marginStart:"svoq16ka"},orderFieldsValueContainer:{gap:"od95x2mx"},orderFieldsContainer:{gap:"sxkbojvh"}};function k(e,t){const{chat:a,order:n}=e,[i,k]=(0,l.useState)(_.PERCENTAGE_SYMBOL),[O,A]=(0,l.useState)(_.PERCENTAGE_SYMBOL),[D,R]=(0,l.useState)(""),[N,F]=(0,l.useState)(""),[B,U]=(0,l.useState)(""),[H,G]=(0,l.useState)(""),[V,W]=(0,l.useState)({discount:void 0,shipping:void 0,tax:void 0}),z=c.formatAmount1000(n.currency,n.subtotal),K=(0,_.calculateOrderTotal)({orderSubtotal:n.subtotal,discountType:i,discountText:D,taxType:O,taxText:B,shippingText:N}),q=c.formatAmount(n.currency,K),Y=n.orderItemCollection.toArray(),Q=Y.map((e=>e.name)).join(g.default.t(772));return(0,P.jsxs)(u.default,{onDrop:e.onBack,ref:t,children:[(0,P.jsx)(f.DrawerHeader,{title:g.default.t(1419),onBack:e.onBack,type:f.DRAWER_HEADER_TYPE.SMALL}),(0,P.jsxs)(h.default,{children:[(0,P.jsx)(p.default,{xstyle:[r.uiPadding.top20,r.uiPadding.horiz16,r.uiPadding.bottom15],theme:"refresh-padding-title",children:(0,P.jsxs)(S.default,{children:[(0,P.jsx)(y.default,{sellerWid:(0,b.createWid)(n.sellerJid),orderStatus:(0,P.jsx)(E.default,{children:o.fbt._("Order pending",null,{hk:"2MPJmw"})})}),(0,P.jsx)(m.FlexColumn,{align:"stretch",xstyle:L.orderProductSummaryContainer,children:(0,P.jsx)(x.default,{productMediaData:Y[0].mediaData,totalItemCount:n.totalItemCount,label:Q,onClick:()=>{var t;null===(t=e.onProductSummaryClick)||void 0===t||t.call(e,Y)}})}),(0,P.jsxs)(m.FlexRow,{justify:"all",children:[(0,P.jsx)(M,{children:o.fbt._("Subtotal",null,{hk:"4ciFet"})}),(0,P.jsx)(M,{children:z})]}),(0,P.jsxs)(m.FlexColumn,{align:"stretch",xstyle:L.orderFieldsContainer,children:[(0,P.jsxs)(m.FlexRow,{justify:"all",align:"center",children:[(0,P.jsx)(M,{children:o.fbt._("Discount",null,{hk:"1Ujmwj"})}),(0,P.jsxs)(m.FlexRow,{xstyle:L.orderFieldsValueContainer,children:[(0,P.jsx)(C.OrderDetailAmountTypeSelector,{currency:n.currency,defaultIndex:0,onChange:({value:e})=>{k(e)}}),(0,P.jsx)(v.default,{value:D,onChange:({value:e,error:t})=>{R(e),W((e=>(0,s.default)((0,s.default)({},e),{},{discount:t})))}})]})]}),(0,P.jsxs)(m.FlexRow,{justify:"all",align:"center",children:[(0,P.jsx)(M,{children:o.fbt._("Shipping",null,{hk:"1bRWJs"})}),(0,P.jsx)(v.default,{value:N,onChange:({value:e,error:t})=>{F(e),W((e=>(0,s.default)((0,s.default)({},e),{},{shipping:t})))}})]}),(0,P.jsxs)(m.FlexRow,{justify:"all",align:"center",children:[(0,P.jsx)(M,{children:o.fbt._("Taxes",null,{hk:"1oHHVR"})}),(0,P.jsxs)(m.FlexRow,{xstyle:L.orderFieldsValueContainer,children:[(0,P.jsx)(C.OrderDetailAmountTypeSelector,{currency:n.currency,defaultIndex:0,onChange:({value:e})=>{A(e)}}),(0,P.jsx)(v.default,{value:B,onChange:({value:e,error:t})=>{U(e),W((e=>(0,s.default)((0,s.default)({},e),{},{tax:t})))}})]})]})]})]})}),(0,P.jsxs)(p.default,{xstyle:[r.uiPadding.top20,r.uiPadding.horiz16],theme:"refresh-padding-title",children:[(0,P.jsxs)(m.FlexRow,{justify:"all",children:[(0,P.jsx)(T.TextSpan,{theme:"title",weight:"medium",children:o.fbt._("Total",null,{hk:"7xRrT"})}),(0,P.jsx)(T.TextSpan,{theme:"title",weight:"medium",children:q})]}),(0,P.jsx)(j.default,{chat:e.chat,placeholder:o.fbt._("Add a note",null,{hk:"1wBSMx"}),value:H,onChange:G,onSubmit:function(){(0,I.default)({order:n,chat:a,message:H,discount:D,shipping:N,tax:B}),d.Cmd.closeDrawerRight()},buttonTitle:g.default.t(1419),a8nTextButton:"order-create-button",disabled:w(V)})]})]})]})}var O=(0,l.forwardRef)(k);t.default=O},42590:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function({value:e,onChange:t,validate:a}){const n=i.fbt._("Add",null,{hk:"1Ifmhl"});return(0,o.jsx)("div",{className:(0,s.default)(d),children:(0,o.jsx)(r.TextInput,{managed:!0,constrainedWidth:!0,hideFloatingLabel:!0,placeholder:n,value:e,theme:"small",maxLength:12,customStyleThemes:["noErrorInfo"],onChange:e=>{t({value:e,error:l(e)})},error:l(e)})})};var i=a(48360),s=n(a(56720)),r=a(29458),o=a(85893);function l(e){return function(e){const t=Number(e);return Number.isFinite(t)&&t>=0}(e)?null:" "}const d={textAlign:"ljrqcn24",width:"mh8l8k0y",overflowX:"gfz4du6o",overflowY:"r7fjleex",marginTop:"obt84bhp"}},35045:(e,t,a)=>{"use strict";var n=a(95318),i=a(20862);Object.defineProperty(t,"__esModule",{value:!0}),t.OrderDetailAmountTypeSelector=function({defaultIndex:e,onChange:t,currency:a}){const n=r.formatLocalSymbol(a),i=s.fbt._("Select amount type",null,{hk:"1xddkG"}),c=[{id:"percentage",label:s.fbt._("by Percentage ({percentage-symbol})",[s.fbt._param("percentage-symbol",o.PERCENTAGE_SYMBOL)],{hk:"3fQwM3"}),value:o.PERCENTAGE_SYMBOL},{id:"flat-amount",label:s.fbt._("by Flat amount ({currency-symbol})",[s.fbt._param("currency-symbol",n)],{hk:"duPhj"}),value:n}];return(0,d.jsx)(l.default,{"aria-label":i,options:c,defaultIndex:e,onChange:t})};var s=a(48360),r=i(a(61447)),o=a(80257),l=n(a(47334)),d=a(85893)},79354:(e,t,a)=>{"use strict";var n=a(20862),i=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=a(26593),r=a(48360),o=a(67294),l=(i(a(56720)),n(a(61447))),d=i(a(17747)),c=i(a(9042)),u=i(a(17061)),h=a(55588),f=i(a(25061)),p=a(63290),m=i(a(63035)),g=i(a(86544)),v=i(a(6618)),C=i(a(24430)),_=i(a(2966)),x=a(97504),S=i(a(81925)),y=a(85893);function E({children:e}){return(0,y.jsx)(x.TextSpan,{color:"secondary",children:e})}const j={orderProductSummaryContainer:{marginTop:"jdreu547",marginEnd:"jnwc1y2a",marginBottom:"n5a6z3tu",marginStart:"svoq16ka"},fieldContainer:{gap:"fbvzomvk"}};function I(e,t){const{orderInfo:a,sellerWid:n}=e,i=(0,S.default)(n),{discount:o=0,tax:I=0,shipping:T=0,subtotal:b,totalAmount:P}=a;if(null==i||null==b)return null;const M=i.productCollection.getProductModels().reduce(((e,t)=>(e[t.id.toString()]=t,e)),{}),w=a.items.map((e=>{var t,n;const i=null!=e.amount?1e3*e.amount:null;return{id:e.id,name:e.name,quantity:e.quantity,price:i,currency:a.currency,mediaData:null===(t=M[e.id])||void 0===t||null===(n=t.getPreviewImage())||void 0===n?void 0:n.mediaData}}));return(0,y.jsxs)(d.default,{onDrop:e.onBack,ref:t,children:[(0,y.jsx)(h.DrawerHeader,{title:r.fbt._("Order details",null,{hk:"2HeBLz"}),onBack:e.onBack,type:h.DRAWER_HEADER_TYPE.SMALL}),(0,y.jsxs)(c.default,{children:[(0,y.jsx)(f.default,{xstyle:[s.uiPadding.top20,s.uiPadding.horiz16,s.uiPadding.bottom15],children:(0,y.jsxs)(g.default,{children:[(0,y.jsx)(v.default,{orderId:a.referenceId,sellerWid:n,orderStatus:(0,y.jsx)(C.default,{children:r.fbt._("Order pending",null,{hk:"2MPJmw"})})}),(0,y.jsx)(p.FlexColumn,{align:"stretch",xstyle:j.orderProductSummaryContainer,children:(0,y.jsx)(m.default,{productMediaData:w[0].mediaData,totalItemCount:a.quantity,label:a.title,onClick:()=>{var t;null===(t=e.onProductSummaryClick)||void 0===t||t.call(e,w)}})}),(0,y.jsxs)(p.FlexColumn,{align:"stretch",xstyle:j.fieldContainer,children:[(0,y.jsxs)(p.FlexRow,{justify:"all",children:[(0,y.jsx)(E,{children:r.fbt._("Subtotal",null,{hk:"4ciFet"})}),(0,y.jsx)(E,{children:l.formatAmount(a.currency,b)})]}),(0,y.jsxs)(p.FlexRow,{justify:"all",children:[(0,y.jsx)(E,{children:r.fbt._("Discount",null,{hk:"ITgTG"})}),(0,y.jsx)(E,{children:l.formatAmount(a.currency,o)})]}),(0,y.jsxs)(p.FlexRow,{justify:"all",children:[(0,y.jsx)(E,{children:r.fbt._("Shipping",null,{hk:"269x6X"})}),(0,y.jsx)(E,{children:l.formatAmount(a.currency,T)})]}),(0,y.jsxs)(p.FlexRow,{justify:"all",children:[(0,y.jsx)(E,{children:r.fbt._("Tax",null,{hk:"1ZWlTS"})}),(0,y.jsx)(E,{children:l.formatAmount(a.currency,I)})]})]}),(0,y.jsxs)(p.FlexRow,{justify:"all",children:[(0,y.jsx)(x.TextSpan,{theme:"title",children:r.fbt._("Total",null,{hk:"7xRrT"})}),(0,y.jsx)(x.TextSpan,{theme:"title",children:l.formatAmount(a.currency,P)})]})]})}),(0,y.jsx)(f.default,{children:(0,y.jsx)(u.default,{icon:(0,y.jsx)(_.default,{color:"teal",width:20,name:"status-ciphertext"}),a8nText:"order-status-update",color:"dark",onClick:()=>{var t;null===(t=e.onOrderStatusUpdateClick)||void 0===t||t.call(e)},children:r.fbt._("Update order status",null,{hk:"2OKVmc"})})})]})]})}var T=(0,o.forwardRef)(I);t.default=T},80257:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.calculateOrderTotal=function({orderSubtotal:e,discountType:t,discountText:i,taxType:s,taxText:r,shippingText:o}){const l=e/1e3,d=n({type:t,value:i,total:l}),c=n({type:s,value:r,total:l-d}),u=a(Number(o));return l-d+u+c},t.PERCENTAGE_SYMBOL=void 0;function a(e){return Number.isNaN(e)?0:e}function n({type:e,value:t,total:n}){return a("%"===e?Number(t)/100*n:Number(t))}t.PERCENTAGE_SYMBOL="%"},27471:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{productItems:t}=e,a=t.map((e=>({itemKey:e.id.toString(),product:e})));return(0,o.jsx)(s.default,{flatListControllers:[e.flatListController],children:(0,o.jsx)(i.FlatList,{a8nKey:"order-detail-product-list",flatListController:e.flatListController,direction:"vertical",forceConsistentRenderCount:!1,data:a,renderItem:function({product:e}){return(0,o.jsx)(r.default,{product:e})},defaultItemHeight:60})})};var i=a(86025),s=n(a(19257)),r=n(a(74967)),o=a(85893)},17813:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a(48360)),s=a(67294),r=(n(a(56720)),n(a(17747))),o=n(a(9042)),l=a(55588),d=n(a(25061)),c=n(a(67893)),u=n(a(27471)),h=n(a(79939)),f=a(85893);const p={container:{paddingTop:"emrlamx0",paddingEnd:"folpon7g",paddingBottom:"aiput80m",paddingStart:"lyvj5e2u"}};function m(e,t){const{productItems:a}=e,n=(0,h.default)((()=>new c.default));return(0,f.jsxs)(r.default,{onDrop:e.onBack,ref:t,children:[(0,f.jsx)(l.DrawerHeader,{title:i.default._("Items",null,{hk:"3B8pMI"}),onBack:e.onBack,type:l.DRAWER_HEADER_TYPE.SMALL}),(0,f.jsx)(o.default,{flatListControllers:[n.current],children:(0,f.jsx)(d.default,{xstyle:p.container,theme:"refresh-padding-title",children:(0,f.jsx)(u.default,{flatListController:n.current,productItems:a})})})]})}var g=(0,s.forwardRef)(m);t.default=g},74967:(e,t,a)=>{"use strict";var n=a(20862),i=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{product:t}=e,a=(0,h.jsx)(l.EmojiText,{text:t.name,ellipsify:!0,titlify:!0}),n=t.mediaData?(0,h.jsx)(c.ProductThumb,{mediaData:t.mediaData,theme:"squareThumb"}):null;let i=null;if(t.quantity){const e=d.default.t(1431,{quantity:t.quantity.toString()});i=(0,h.jsx)(u.TextSpan,{children:e})}let f=null;f=(0,s.isNonZeroNumber)(t.price)?o.formatAmount1000(t.currency,t.price):d.default.t(427);const p=(0,h.jsx)(u.TextSpan,{children:f});return(0,h.jsx)(r.default,{image:n,customImage:!0,primary:a,secondary:i,detail:p,theme:"media"})};var s=a(71730),r=i(a(55092)),o=n(a(61447)),l=a(85051),d=i(a(2408)),c=a(84241),u=a(97504),h=a(85893)},63035:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function({label:e,totalItemCount:t,productMediaData:a,onClick:n}){const u=r.default.t(1080,{count:t,_plural:t});return(0,c.jsx)(i.default,{image:a?(0,c.jsx)(o.ProductThumb,{mediaData:a,theme:"squareThumb"}):null,customImage:!0,primary:(0,c.jsx)(d.TextSpan,{size:"16",children:(0,c.jsx)(s.EmojiText,{text:e,ellipsify:!0})}),secondary:u,detail:(0,c.jsx)(l.default,{name:"chevron-right",color:"secondary",width:20}),theme:"media",onClick:n})};var i=n(a(55092)),s=a(85051),r=n(a(2408)),o=a(84241),l=n(a(2966)),d=a(97504),c=a(85893)},53353:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function({label:e,checked:t,onClick:a}){return(0,l.jsx)(o.default,{onClick:a,children:(0,l.jsxs)(r.FlexRow,{children:[(0,l.jsx)(r.FlexColumn,{xstyle:i.uiPadding.horiz24,children:(0,l.jsx)(s.default,{checked:t,radio:!0,hover:!1,systemUncheckedColor:!0,onChange:()=>{a()}})}),e]})})};var i=a(26593),s=n(a(88540)),r=a(63290),o=n(a(89135)),l=a(85893)},86544:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function({children:e}){return(0,o.jsx)(r.FlexColumn,{xstyle:l.container,align:"stretch",children:i.Children.map(e,((e,t)=>(0,o.jsxs)(o.Fragment,{children:[0!==t?(0,o.jsx)("div",{className:(0,s.default)(l.separator)}):null,e]})))})};var i=a(67294),s=n(a(56720)),r=a(63290),o=a(85893);const l={container:{gap:"mqqyhd6v"},separator:{height:"bbl9m3t3",borderTop:"iupwfssi"}}},47334:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function({defaultIndex:e=0,options:t,onChange:a,"aria-label":n}){const f=(0,i.useRef)(null),[p,m]=(0,i.useState)(!1),[g,v]=(0,i.useState)(e),C=t.map(((e,t)=>{const{id:n,label:i}=e;return(0,u.jsx)(o.DropdownItem,{a8n:`mi-${n}`,action:()=>{a(e),v(t)},children:(0,u.jsx)("div",{className:(0,s.default)(h),role:"button","aria-label":i,children:t===g?(0,u.jsx)(l.TextSpan,{weight:"bold",children:i}):i})},n)}));return(0,u.jsxs)("div",{ref:f,children:[(0,u.jsx)(r.default,{"aria-label":n,postfixIcon:"down",label:t[g].value,onClick:()=>m((e=>!e))}),p&&f.current&&(0,u.jsx)(d.UIE,{displayName:"ValuePicker",escapable:!0,popable:!0,requestDismiss:()=>m(!1),children:(0,u.jsx)(c.default,{contextMenu:{menu:C,anchor:f.current}})})]})};var i=a(67294),s=n(a(56720)),r=n(a(70775)),o=a(47452),l=a(97504),d=a(63477),c=n(a(68062)),u=a(85893);const h={boxSizing:"cm280p3y",color:"tviruh8d",cursor:"ajgl1lbb",fontSize:"f8jlpxt4",height:"lniyxyh2",lineHeight:"gz7w46tb",overflowX:"gfz4du6o",overflowY:"r7fjleex",paddingStart:"sta02ykp",paddingEnd:"pnfw7ual",paddingTop:"lqdozo90",textOverflow:"lhj4utae",whiteSpace:"le5p0ye3",position:"g0rxnol2"}},6618:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function({orderId:e,orderStatus:t,sellerWid:a}){const n=s.ContactCollection.get(a),u=n?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(o.FlexRow,{children:(0,d.jsx)(r.DetailImage,{id:a,size:48})}),(0,d.jsxs)(o.FlexColumn,{align:"center",children:[(0,d.jsx)(l.TextDiv,{theme:"large",weight:"medium",children:n.name}),null!=e?(0,d.jsx)(l.TextDiv,{color:"secondary",weight:"medium",xstyle:c.uppercase,children:i.fbt._("order #{order-id}",[i.fbt._param("order-id",e)],{hk:"83OWH"})}):null]})]}):null;return(0,d.jsxs)(o.FlexColumn,{align:"center",xstyle:c.container,children:[u,t]})};var i=a(48360),s=(n(a(56720)),a(17025)),r=a(88419),o=a(63290),l=a(97504),d=a(85893);const c={container:{gap:"nypubj7v"},uppercase:{textTransform:"ofejerhi"}}},24430:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function({children:e}){return(0,r.jsxs)(s.TextDiv,{theme:"small",xstyle:o.container,children:[(0,r.jsx)(i.default,{width:12,name:"status-ciphertext",display:"inline",xstyle:o.icon}),e]})};n(a(56720));var i=n(a(2966)),s=a(97504),r=a(85893);const o={container:{color:"de33c33s",backgroundColor:"i16jpgpt",display:"i86elurf",alignItems:"gndfcl4n",fontSize:"dsh4tgtl",paddingTop:"i5tg98hk",paddingEnd:"ft2m32mm",paddingBottom:"przvwfww",paddingStart:"k4wy2cgb",borderTopStartRadius:"g130k69c",borderTopEndRadius:"k1a7joe8",borderBottomEndRadius:"dc5qina8",borderBottomStartRadius:"kfr1vweg"},icon:{marginTop:"dwvzf427",marginEnd:"mw4yctpw"}}},87106:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(c.default,{transitionName:"media-caption",className:(0,i.default)(h),children:(0,u.jsx)(o.default,{chat:e.chat,maxLength:r.default.MAX_CART_MESSAGE_LENGTH,placeholder:e.placeholder,value:e.value,onEnter:()=>{!0!==e.disabled&&e.onSubmit()},onChange:t=>{e.onChange(t)},multiline:!0,showRemaining:!0,spellCheck:!0,supportsEmoji:!0})}),(0,u.jsx)(c.default,{transitionAppear:!0,transitionName:"btn",children:(0,u.jsx)("button",{disabled:e.disabled,"data-a8n":s.default.key(e.a8nTextButton),className:(0,i.default)(f),tabIndex:"-1",onClick:()=>e.onSubmit(),title:e.buttonTitle,children:(0,u.jsx)(l.Round,{disabled:e.disabled,children:(0,u.jsx)(d.default,{width:18,name:"send",directional:!0})})})})]})};var i=n(a(56720)),s=n(a(76610)),r=n(a(55454)),o=n(a(84627)),l=a(3132),d=n(a(2966)),c=n(a(82669)),u=a(85893);const h={display:"p357zi0d",flexDirection:"f8m0rgwh",width:"ln8gz9je",zIndex:"mb8var44",position:"g0rxnol2",marginBottom:"mggyuyyy"},f={color:"svlsagor",marginTop:"tt8xd2xn",marginEnd:"jnwc1y2a",marginBottom:"mpdn4nr2",marginStart:"svoq16ka",opacity:"axi1ht8l",paddingTop:"i5tg98hk",paddingEnd:"f9ovudaz",paddingBottom:"przvwfww",paddingStart:"gx1rr48f",position:"lhggkp7q",right:"q82cfhbg",bottom:"efio351b",textAlign:"qfejxiq4"}},50320:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{order:t,onProductDetail:a,sellerJid:n}=e,f=e=>{const a=t.orderItemCollection.toArray();return(0,l.logOrderListImpression)({catalogContext:e,orderId:t.id,productCount:a.length,catalogOwnerJid:n}),a.map((e=>({itemKey:e.id.toString(),product:e})))};return(0,h.jsx)(s.DrawerContext.Consumer,{children:t=>{const n=(0,u.getProductCatalogContext)(t);return(0,h.jsx)(o.default,{flatListControllers:[e.flatListController],children:(0,h.jsx)(r.FlatList,{a8nKey:"order-product-list",flatListController:e.flatListController,direction:"vertical",forceConsistentRenderCount:!1,data:f(n),renderItem:t=>((t,n)=>{const{sellerJid:i}=e,{product:s}=t,r={productId:s.id,businessOwnerJid:i};return(0,h.jsx)(c.default,{product:s,onClick:()=>{(0,d.qplStartProductView)("Order"),(0,l.logOrderListItemClick)({catalogContext:n,orderId:e.order.id,catalogOwnerJid:i}),a(r)}})})(t,n),defaultItemHeight:i.default.PRODUCT_LIST_ITEM_HEIGHT})})}})};var i=n(a(55454)),s=a(79864),r=a(86025),o=n(a(19257)),l=a(1236),d=a(90676),c=n(a(7148)),u=a(70790),h=a(85893)},7148:(e,t,a)=>{"use strict";var n=a(20862),i=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{product:t,onClick:a}=e,n=(0,f.jsx)(l.EmojiText,{text:t.name,ellipsify:!0,titlify:!0}),i=(0,f.jsx)(u.ProductThumb,{mediaData:t.mediaData,theme:"list"}),p=d.default.t(1431,{quantity:t.quantity.toString()});let m=null;t.quantity&&(m=(0,f.jsx)(h.TextSpan,{className:c.default.quantity,children:p}));let g=null;g=(0,s.isNonZeroNumber)(t.price)?o.formatAmount1000(t.currency,t.price):d.default.t(427);const v=(0,f.jsx)(h.TextSpan,{className:c.default.price,children:g});let C=null;null!=m&&(C=(0,f.jsx)("span",{className:c.default.separator,children:"•"}));const _=(0,f.jsxs)("div",{children:[v,C,m]});return(0,f.jsx)(r.default,{image:i,customImage:!0,primary:n,secondary:_,theme:"order-product",onClick:a},t.id.toString())};var s=a(71730),r=i(a(55092)),o=n(a(61447)),l=a(85051),d=i(a(2408)),c=i(a(20295)),u=a(84241),h=a(97504),f=a(85893)},22120:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(26593),s=a(48360),r=a(67294),o=(n(a(56720)),n(a(17747))),l=n(a(9042)),d=a(55588),c=n(a(25061)),u=a(63290),h=n(a(53353)),f=n(a(87106)),p=a(9930),m=a(85893);const g=[{label:s.fbt._("Processing",null,{hk:"2s6DMw"}),status:p.OrderStatus.Processing},{label:s.fbt._("Shipped",null,{hk:"1vhmcK"}),status:p.OrderStatus.Shipped},{label:s.fbt._("Completed",null,{hk:"1skg0X"}),status:p.OrderStatus.Complete},{label:s.fbt._("Cancel",null,{hk:"1nr4IF"}),status:p.OrderStatus.Canceled}],v={checkboxContainer:{gap:"n8lfltvd"}};function C(e,t){const[a,n]=(0,r.useState)(""),[C,_]=(0,r.useState)(p.OrderStatus.Processing),x=s.fbt._("Add a note (Optional)",null,{hk:"zuRG"});return(0,m.jsxs)(o.default,{onDrop:e.onBack,ref:t,children:[(0,m.jsx)(d.DrawerHeader,{title:s.fbt._("Update order status",null,{hk:"1inFTM"}),onBack:e.onBack,type:d.DRAWER_HEADER_TYPE.SMALL}),(0,m.jsxs)(l.default,{children:[(0,m.jsx)(c.default,{xstyle:[i.uiPadding.vert20,i.uiPadding.horiz16],theme:"refresh-padding-title",children:(0,m.jsx)(u.FlexColumn,{xstyle:v.checkboxContainer,children:g.map((function({label:e,status:t}){return(0,m.jsx)(h.default,{label:e,checked:C===t,onClick:()=>{_(t)}})}))})}),(0,m.jsx)(c.default,{xstyle:[i.uiPadding.top8,i.uiPadding.horiz16],theme:"refresh-padding-title",children:(0,m.jsx)(f.default,{chat:e.chat,placeholder:x,value:a,onChange:n,onSubmit:function(){},buttonTitle:x,a8nTextButton:"order-status-update-button"})})]})]})}var _=(0,r.forwardRef)(C);t.default=_},65571:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.CatalogSettingsDrawer=function(e){const{onBack:t}=e,[a,n]=(0,s.useState)(!0),[r,d]=(0,s.useState)(!1),p=(0,I.default)();(0,s.useEffect)((()=>{(0,x.default)(o.BusinessProfileCollection.fetchBizProfile((0,v.getMeUser)()),p).then((e=>{const t=e.profileOptions;n(!1),d(null!=t&&t.cartEnabled)})).catch((0,i.catchAbort)((()=>{}))).catch((()=>{__LOG__(4,!0,new Error)`Error fetching the business profile.`,c.Cmd.openToast((0,T.jsx)(j.Toast,{msg:C.default.t(494),duration:6e3,id:(0,j.genId)()})),t()}))}),[]);const m=e=>{d(e)};return(0,T.jsxs)(u.default,{theme:"catalog",onDrop:e.onBack,children:[(0,T.jsx)(f.DrawerHeader,{title:C.default.t(495),type:f.DRAWER_HEADER_TYPE.LARGE,onBack:e.onBack}),(0,T.jsx)(h.default,{children:a?(0,T.jsx)("div",{className:l.default.loadingSpinner,children:(0,T.jsx)(y.Spinner,{})}):(0,T.jsx)(b,{cartEnabled:r,setCartEnabled:m})})]})};var i=a(96502),s=a(67294),r=a(98216),o=a(8581),l=n(a(93543)),d=n(a(44683)),c=a(69162),u=n(a(17747)),h=n(a(9042)),f=a(55588),p=n(a(25061)),m=a(4919),g=a(57092),v=a(86723),C=n(a(2408)),_=n(a(663)),x=n(a(79267)),S=n(a(28981)),y=a(46714),E=a(97504),j=a(49201),I=n(a(29579)),T=a(85893);function b({cartEnabled:e,setCartEnabled:t}){const a=a=>{t(a),(0,r.updateCartEnabled)(a).catch((()=>{__LOG__(4,!0,new Error,!0)`Failed to update cartEnabled value`,SEND_LOGS("updateCartEnabled: cartEnabled toggle error"),c.Cmd.openToast((0,T.jsx)(j.Toast,{msg:C.default.t(491),duration:6e3,id:(0,j.genId)()})),t(e)}))},n=(0,g.getCatalogCartOnOffFaqUrl)(),i=(0,T.jsx)(d.default,{href:n,onClick:e=>{e.preventDefault(),(0,m.openExternalLink)(n)},children:C.default.t(1091)}),s=(0,T.jsx)(_.default,{id:493,params:{learn_more_link:i}});return(0,T.jsxs)(T.Fragment,{children:[(0,T.jsxs)(p.default,{title:C.default.t(492),theme:"title-larger",animation:!1,children:[(0,T.jsx)(S.default,{isChosen:e,onChoose:()=>{a(!0)},choiceText:C.default.t(497)}),(0,T.jsx)(S.default,{isChosen:!e,onChoose:()=>{a(!1)},choiceText:C.default.t(496)})]}),(0,T.jsx)(E.TextDiv,{theme:"plain",className:l.default.descriptionText,children:s})]})}},81925:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const[t,a]=(0,s.useState)((()=>r.CatalogCollection.get(e))),n=(0,o.default)();return(0,s.useEffect)((()=>{const s=r.CatalogCollection.get(e);s!==t&&(null!=s?a(s):(0,i.default)((function*(){const t=yield r.CatalogCollection.find(e);n()&&a(t)}))())}),[e,t,n]),t};var i=n(a(48926)),s=a(67294),r=a(60028),o=n(a(76428))},8730:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{selections:t,active:a,onSelectionChanged:n,catalog:d}=e,c=e=>{((e,i,s)=>{t.setVal(e,i,s),a.setVal(e,s),n()})(e,!t.isSelected(e),!1)};return(0,l.jsx)(r.default,{flatListControllers:[e.flatListController],children:(0,l.jsx)(s.FlatList,{flatListController:e.flatListController,direction:"vertical",forceConsistentRenderCount:!1,data:d.productCollection.getProductModels(!0).map((e=>({itemKey:e.id.toString(),product:e}))),renderItem:e=>{const{product:n}=e;return(0,l.jsx)(o.default,{product:n,selections:t,onClick:()=>c(n),active:a},n.id.toString())},defaultItemHeight:i.default.PRODUCT_LIST_ITEM_HEIGHT})})};var i=n(a(55454)),s=a(86025),r=n(a(19257)),o=n(a(65161)),l=a(85893)},69105:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t;const{catalog:a,collection:n,onBack:D}=e,R=(0,L.default)((()=>new T.default([],(e=>e.id)))),N=(0,L.default)((()=>new S.default([],(e=>e.id.toString())))),F=(0,L.default)((()=>new v.default)),B=(0,w.default)(),U=(0,O.default)(),[H,G]=(0,o.useState)(null),[V,W]=(0,o.useState)(null),[z,K]=(0,o.useState)(null==n?void 0:n.name),[q,Y]=(0,o.useState)(null==n?void 0:n.name),[Q,X]=(0,o.useState)(null),[Z,$]=(0,o.useState)(!1),[J,ee]=(0,o.useState)(!0);(0,o.useEffect)((()=>{(()=>{const e=new d.CollectionsContentDataSource(a,u.default.PRODUCT_LIST_ITEM_HEIGHT,null==n?void 0:n.id),t=new d.CatalogListItemScrollHelper(e);G(e),W(t),e.loadInitialItems().then((()=>{if(U.aborted)throw new s.AbortError;ee(!1),B()})).catch((0,s.catchAbort)((()=>{})))})()}),[]);const te=e=>{K(e),X(Q&&e?null:Q)},ae=(0,k.default)((e=>{const t=e.currentTarget;(null==V?void 0:V.willLoadMore(t))&&ee(!0),null==V||V.onScroll(e,t).then((e=>{ee(!1),e&&ee(!1)})).catch((e=>{throw ee(!1),e}))}),100),ne=function(){var e=(0,i.default)((function*(e){const t=(0,y.getProductCatalogContext)(e);if(z&&""!==z.trim()){E.QPL.markerStart(j.QuickLogMarkerId.WHATSAPP_COLLECTION_EDIT),$(!0);const{added:e,removed:i}=(()=>{const e=a.productCollection.getProductModels(!0),t=[],n=[];return e.forEach((e=>{const a=N.current.isSelected(e);e.checkmark!==a&&(a?n.push(e):t.push(e))})),{added:n,removed:t}})(),s=z!==q;E.QPL.markerAnnotate(j.QuickLogMarkerId.WHATSAPP_COLLECTION_EDIT,{bool:{IsNew:!n},int:{ProductsAdded:e.length}}),n&&E.QPL.markerAnnotate(j.QuickLogMarkerId.WHATSAPP_COLLECTION_EDIT,{bool:{Renamed:s},int:{ProductsDeleted:i.length}});try{if(yield(0,l.handleCollectionSave)(a,n,z||"",e,i,t)){D();const a=null==n?void 0:n.id;a&&s&&((0,x.logCollectionRenamed)({catalogContext:t,collectionId:a}),Y(z)),n&&(0,x.logCollectionItemsAssignment)({collectionId:n.id,addedCount:e.length,removedCount:i.length,catalogContext:t}),E.QPL.markerEnd(j.QuickLogMarkerId.WHATSAPP_COLLECTION_EDIT,E.QuickLogActionType.SUCCESS)}else $(!1),E.QPL.markerDrop(j.QuickLogMarkerId.WHATSAPP_COLLECTION_EDIT)}catch(e){$(!1),E.QPL.markerEnd(j.QuickLogMarkerId.WHATSAPP_COLLECTION_EDIT,E.QuickLogActionType.FAIL)}}else X(_.default.t(453))}));return function(){return e.apply(this,arguments)}}(),ie=e=>{let t;const i=(()=>{const e=a.productCollection.getProductModels(!0);let t=0;return e.forEach((e=>{N.current.isInList(e)?e.checkmark!==N.current.isSelected(e)&&t++:N.current.setVal(e,e.checkmark)})),t})();if(i>0||n&&z!==n.name){const a=_.default.t(452,{updated:i,_plural:i});t=(0,A.jsxs)("div",{className:g.default.footer,children:[a,(0,A.jsx)("div",{className:g.default.saveButton,children:(0,A.jsx)(I.Round,{large:!0,onClick:()=>{ne(e)},children:(0,A.jsx)(P.default,{name:"checkmark-medium"})})})]})}return t},se=(0,r.default)(g.default.container,{[g.default.isSending]:Z}),re=(null===(t=e.collection)||void 0===t?void 0:t.name)||_.default.t(455);return(0,A.jsxs)(h.default,{theme:"products",onDrop:e.onBack,children:[(0,A.jsx)(m.DrawerHeader,{title:re,type:m.DRAWER_HEADER_TYPE.LARGE,onBack:e.onBack,menu:(0,A.jsx)(A.Fragment,{})}),(0,A.jsx)(f.default,{className:se,flatListControllers:[F.current],onScroll:ae,children:(()=>{const e=Z?(0,A.jsx)("div",{className:g.default.spinner,children:(0,A.jsx)(b.Spinner,{size:50,stroke:3})}):null;return(0,A.jsx)(p.DrawerContext.Consumer,{children:t=>{const i=(0,y.getProductCatalogContext)(t);return(0,A.jsxs)(A.Fragment,{children:[e,(0,A.jsxs)("div",{className:g.default.nameContainer,children:[(0,A.jsx)("span",{className:g.default.nameIcon,children:(0,A.jsx)(P.default,{name:"collections_folder"})}),(0,A.jsx)("span",{className:g.default.nameEdit,children:(0,A.jsx)(M.TextInput,{editable:!0,focusOnMount:!0,showRemaining:!0,value:z,onChange:te,inputPlaceholder:_.default.t(446),theme:"text-input",error:Q,maxLength:30})})]}),(0,A.jsx)("div",{className:g.default.operation,children:n?_.default.t(457):_.default.t(442)}),(0,A.jsxs)("div",{className:g.default.listContainer,children:[(0,A.jsx)(c.default,{catalog:a,flatListController:F.current,active:R.current,selections:N.current,onSelectionChanged:()=>B()}),J&&(0,A.jsx)("div",{className:g.default.loadingSpinner,children:(0,A.jsx)(C.default,{})})]}),ie(i)]})}})})()})]})};var i=n(a(48926)),s=a(96502),r=n(a(94184)),o=a(67294),l=a(96470),d=a(16156),c=n(a(8730)),u=n(a(55454)),h=n(a(17747)),f=n(a(9042)),p=a(79864),m=a(55588),g=n(a(78518)),v=n(a(67893)),C=n(a(52715)),_=n(a(2408)),x=a(59562),S=n(a(66329)),y=a(70790),E=a(21125),j=a(71578),I=a(3132),T=n(a(16967)),b=a(46714),P=n(a(2966)),M=a(29458),w=n(a(45172)),L=n(a(79939)),k=n(a(16297)),O=n(a(29579)),A=a(85893)},74659:(e,t,a)=>{"use strict";var n=a(20862),i=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.ComplianceInfoFields=J,t.EditProductDrawer=t.EditProductDrawerImpl=void 0;var s=i(a(81109)),r=i(a(48926)),o=a(61295),l=i(a(48158)),d=i(a(94184)),c=a(48360),u=a(67294),h=(i(a(56720)),a(96470)),f=i(a(69991)),p=a(60028),m=a(33287),g=a(69162),v=a(10504),C=a(47898),_=i(a(55454)),x=a(27546),S=a(94910),y=n(a(61447)),E=i(a(36560)),j=i(a(17747)),I=i(a(9042)),T=a(79864),b=a(55588),P=i(a(37201)),M=a(63290),w=a(86723),L=a(78615),k=i(a(52087)),O=i(a(2408)),A=a(71681),D=a(30333),R=a(78150),N=a(94583),F=a(70790),B=i(a(65248)),U=i(a(40630)),H=a(21125),G=a(71578),V=a(46714),W=i(a(79485)),z=a(97504),K=a(29458),q=a(49201),Y=a(1458),Q=a(12825),X=a(85893);const Z={complianceInfoHelpCenterBanner:{paddingTop:"nlnf8xo7",paddingEnd:"f9ovudaz",paddingBottom:"jzp2c175",paddingStart:"gx1rr48f"}};class $ extends u.Component{constructor(e){var t;super(e),t=this,this._imagePanelRef=(0,u.createRef)(),this._handleNameChange=e=>{this.setState({name:e,nameError:""===e.trim()?O.default.t(840):"",isModified:!0})},this.getServerPrice=e=>parseInt(parseFloat(e).toFixed(2).toString().replace(/\.|,/g,""),10),this._handlePriceChange=e=>{const t=y.valueFromString(this.state.currency,e);let a="";""===e||y.validatePriceString(this.state.currency,e,R.MIN_PRICE,R.MAX_PRICE)||(a=O.default.t(841)),this.setState({priceAmount1000:""===e?null:t,priceStr:`${e}`,priceError:a,isModified:!0})},this.handleDescriptionChange=e=>{this.setState({description:e,isModified:!0})},this._handleUrlChange=e=>{let t="";""===e||Y.URL.isValid(e)||(t=O.default.t(846)),this.setState({url:e,urlError:t,isModified:!0})},this._handleUrlBlur=()=>{const{url:e}=this.state;""===e||Y.URL.isHttps(e)||Y.URL.isHttp(e)||this.setState({url:`https://${e}`})},this._handleRetailerIdChange=e=>{this.setState({retailerId:e,retailerIdError:"",isModified:!0})},this._showComplianceInfoImporterAddress=()=>{var e;const t=null===(e=this.state.complianceInfo)||void 0===e?void 0:e.countryCodeOrigin;return!!t&&t!==_.default.COMPLIANCE_INFO_CODES.INDIA},this._handleComplianceInfoChange=function(){var e=(0,r.default)((function*(e,a){var n;const i=(0,s.default)((0,s.default)({},t.state.complianceInfo),{},{importerAddress:(0,s.default)({},null===(n=t.state.complianceInfo)||void 0===n?void 0:n.importerAddress)});"countryCodeOrigin"===e&&(i.countryNameOrigin=yield(0,x.getCountryName)(a),i.countryCodeOriginError=""),"importerName"===e&&(i.importerNameError=(0,C.existsField)(a,(0,w.getMeUser)())||!t.shouldComplianceBeHardEnforced()?"":O.default.t(1512)),i[e]=a||void 0,t.setState({complianceInfo:i,isModified:!0})}));return function(){return e.apply(this,arguments)}}(),this._getImporterAddressFieldValueOnChange=(e,t,a)=>{const{importerAddress:n}=this.state.complianceInfo||{};return t===e?a:n[e]},this._handleComplianceInfoImporterAddressChange=function(){var e=(0,r.default)((function*(e,a){var n;const i=t._getImporterAddressFieldValueOnChange("street1",e,a),r=t._getImporterAddressFieldValueOnChange("street2",e,a),o=t._getImporterAddressFieldValueOnChange("postalCode",e,a),l=t._getImporterAddressFieldValueOnChange("city",e,a),d=t._getImporterAddressFieldValueOnChange("region",e,a),c=t._getImporterAddressFieldValueOnChange("countryCode",e,a),u=[i,r,o,l,d,c].some((e=>e))||t.shouldComplianceBeHardEnforced(),h=(0,s.default)((0,s.default)({},t.state.complianceInfo),{},{importerAddress:(0,s.default)({},null===(n=t.state.complianceInfo)||void 0===n?void 0:n.importerAddress)});"countryCode"===e&&(h.importerAddress.countryName=(yield(0,x.getCountryName)(a))||void 0),h.importerAddress[e]=a||void 0,h.importerAddress.street1Error=u&&!(0,C.existsFieldIgnoreHardEnforcement)(i)?O.default.t(1509):"",h.importerAddress.cityError=u&&!(0,C.existsFieldIgnoreHardEnforcement)(l)?O.default.t(1503):"",h.importerAddress.countryCodeError=u&&!(0,C.existsFieldIgnoreHardEnforcement)(c)?O.default.t(1505):"",t.setState({complianceInfo:h,isModified:!0})}));return function(){return e.apply(this,arguments)}}(),this._handleHiddenChange=()=>{this.setState({isHidden:!this.state.isHidden})},this._getProductChanges=()=>{const{catalog:e,product:t}=this.props,{name:a,priceAmount1000:n,currency:i,description:s,url:r,retailerId:o,complianceInfo:l,isHidden:d}=this.state;return new R.Product({id:t.id,priceAmount1000:n,currency:i,description:s||"",imageCdnUrl:t.imageCdnUrl,additionalImageCdnUrl:t.additionalImageCdnUrl,name:a,retailerId:o,url:r,isHidden:d,complianceInfo:(0,L.canSeeECommerceComplianceIndiaBusinessJourney)(e.id.user)?{countryCodeOrigin:null==l?void 0:l.countryCodeOrigin,importerName:null==l?void 0:l.importerName,importerAddress:{street1:null==l?void 0:l.importerAddress.street1,street2:null==l?void 0:l.importerAddress.street2,postalCode:null==l?void 0:l.importerAddress.postalCode,city:null==l?void 0:l.importerAddress.city,region:null==l?void 0:l.importerAddress.region,countryCode:null==l?void 0:l.importerAddress.countryCode}}:void 0})},this._handleSaveItem=()=>{const{catalog:e,product:t,newProduct:a}=this.props;let n=!0;const i=this._getProductChanges();var s;this.errorsRevealed()||(a?(0,D.logAddProductClick)((0,F.getProductCatalogContext)(this.context)):(0,D.logEditProductClick)(t,(0,F.getProductCatalogContext)(this.context)),this.setState({isUpdating:!0}),a||this.state.isModified?(H.QPL.markerStart(G.QuickLogMarkerId.WHATSAPP_PRODUCT_SAVE,{bool:{isNewProduct:!!a}}),null===(s=this._imagePanelRef.current)||void 0===s||s.uploadImages().then((t=>{n=!1,i.imageCdnUrl=t[0],i.additionalImageCdnUrl=t.slice(1);(a?e.addProduct:e.editProduct).call(e,i).then((e=>{this._handleEditSuccess(e),n=!1,H.QPL.markerEnd(G.QuickLogMarkerId.WHATSAPP_PRODUCT_SAVE,H.QuickLogActionType.SUCCESS)})).catch((0,o.filteredCatch)(Q.CatalogEditServerError,(e=>{n=!1,this._handleEditError(e,G.QuickLogMarkerId.WHATSAPP_PRODUCT_SAVE)}))).finally((()=>{n&&H.QPL.markerEnd(G.QuickLogMarkerId.WHATSAPP_PRODUCT_SAVE,H.QuickLogActionType.FAIL),this.setState({isUpdating:!1})}))})).catch((e=>{throw H.QPL.markerEnd(G.QuickLogMarkerId.WHATSAPP_PRODUCT_SAVE,H.QuickLogActionType.FAIL),this.setState({isUpdating:!1}),e}))):(H.QPL.markerStart(G.QuickLogMarkerId.WHATSAPP_PRODUCT_SET_VISIBLE,{string:{EntryPoint:"Product"},bool:{isVisible:!i.isHidden}}),(0,N.productVisibilitySet)([{productId:t.id.toString(),isHidden:i.isHidden}]).then((()=>{t.isHidden=i.isHidden,this._handleEditSuccess(t),n=!1,H.QPL.markerEnd(G.QuickLogMarkerId.WHATSAPP_PRODUCT_SET_VISIBLE,H.QuickLogActionType.SUCCESS)})).catch((0,o.filteredCatch)(Q.CatalogEditServerError,(e=>{n=!1,this._handleEditError(e,G.QuickLogMarkerId.WHATSAPP_PRODUCT_SET_VISIBLE)}))).finally((()=>{n&&H.QPL.markerEnd(G.QuickLogMarkerId.WHATSAPP_PRODUCT_SET_VISIBLE,H.QuickLogActionType.FAIL),this.setState({isUpdating:!1})}))))},this._handleEditError=(e,t)=>{this.props.newProduct?(0,D.logAddProductFailed)((0,F.getProductCatalogContext)(this.context)):(0,D.logEditProductFailed)(this.props.product,(0,F.getProductCatalogContext)(this.context),e.statusCode);let a=O.default.t(489);null!=e.errors&&(e.errors.filter((e=>"duplicate"===e.reason)).length>0?H.QPL.markerDrop(t):H.QPL.markerEnd(t,H.QuickLogActionType.FAIL),e.errors.map((e=>{"media"===e.name&&"duplicate"===e.reason&&this.setState({imageError:O.default.t(836)}),"retailer_id"!==e.name&&"retailer-id"!==e.name||"duplicate"!==e.reason||this.setState({retailerIdError:O.default.t(837)}),(0,L.hideUnsupportedCurrency)()&&"currency"===e.name&&"invalid-data"===e.reason&&(a=O.default.t(488))}))),g.Cmd.openToast((0,X.jsx)(q.Toast,{msg:a,id:(0,q.genId)("catalog_save_item_failed")}))},this._handleEditSuccess=e=>{const{catalog:t,onEditSuccess:a,newProduct:n,onCreate:i}=this.props;t.productCollection.add(e,{merge:!0}),this.props.newProduct?(0,D.logAddProductSuccess)((0,F.getProductCatalogContext)(this.context)):(0,D.logEditProductSuccess)(this.props.product,(0,F.getProductCatalogContext)(this.context)),g.Cmd.openToast((0,X.jsx)(q.Toast,{msg:O.default.t(478),id:(0,q.genId)("catalog_item_saved")})),a(e),null!=n&&i&&i()},this._handleDeleteItem=()=>{const{catalog:e,product:t,onDelete:a}=this.props;(0,h.handleProductDelete)(e,t,(0,F.getProductCatalogContext)(this.context),"Product").then((e=>{e&&(g.Cmd.closeDrawerMid(),a&&a())}))},this._handleImageChange=e=>{let t="";0===e.length&&(t=O.default.t(839)),this.setState({imageError:t,hasImages:e.length>0,isModified:!0})},this.handleDrop=e=>{var t;null===(t=this._imagePanelRef.current)||void 0===t||t.handleFilePick(e)},this.handleDragChange=e=>{this.setState({isDragging:e})};const{product:a}=this.props;let n=!1,i=null!=a.currency?a.currency:y.currencyForCountryShortcode((0,S.getCountryShortcodeByPhone)((0,w.getMeUser)().user)),l=null==a.priceAmount1000?null:a.priceAmount1000,d="";if(null!=l&&null!=a.currency){const e=y.formatAmount1000ToParts(a.currency,l);d=`${e.integer}${e.decimal}`}this.canDisplayPrice(i)||(d="",i="",l=null,n=!0),this.state={name:a.name||"",priceAmount1000:l,description:a.description||"",url:a.url||"",retailerId:a.retailerId||"",priceStr:d,currency:i,isUpdating:!1,nameError:"",priceError:"",urlError:"",retailerIdError:"",imageError:"",hasImages:!!a.imageCdnUrl,isDragging:!1,isHidden:a.isHidden,isModified:n,isComplianceInfoAvailable:!1,complianceInfo:void 0}}componentDidMount(){const{listeners:e,catalog:t,product:a}=this.props;(0,L.canSeeECommerceComplianceIndiaBusinessJourney)(t.id.user)&&this.setComplianceInfo(),e.add(a,"change:isHidden",(()=>{this.setState({isHidden:this.props.product.isHidden})}))}setComplianceInfo(){var e=this;return(0,r.default)((function*(){const{product:t,catalog:a,newProduct:n}=e.props;if(n)e.setState({isComplianceInfoAvailable:!0});else{yield p.CatalogCollection.findProduct({catalogWid:a.id,productId:t.id.toString(),shouldFetchComplianceFields:!0});const n=(0,l.default)(a,"catalog").productCollection.get(t.id),{countryCodeOrigin:i,importerName:s,importerAddress:r}=(null==n?void 0:n.complianceInfo)||{},o=i&&(yield(0,x.getCountryName)(i)),d=(null==r?void 0:r.countryCode)&&(yield(0,x.getCountryName)(r.countryCode));e.setState({isComplianceInfoAvailable:!0,complianceInfo:{countryCodeOrigin:i,countryNameOrigin:o,countryCodeOriginError:"",importerName:s,importerNameError:"",importerAddress:{street1:null==r?void 0:r.street1,street1Error:"",street2:null==r?void 0:r.street2,postalCode:null==r?void 0:r.postalCode,city:null==r?void 0:r.city,cityError:"",region:null==r?void 0:r.region,countryCode:null==r?void 0:r.countryCode,countryName:d,countryCodeError:""}}})}}))()}isValid(){const{name:e,nameError:t,priceError:a,urlError:n,retailerIdError:i,imageError:s,hasImages:r,complianceInfo:o}=this.state;if(""===e.trim()||!1===r)return!1;const l=[t,a,n,i,s];return this._showComplianceInfoImporterAddress()&&l.push(null==o?void 0:o.importerNameError,null==o?void 0:o.importerAddress.street1Error,null==o?void 0:o.importerAddress.cityError,null==o?void 0:o.importerAddress.countryCodeError),this.shouldComplianceBeHardEnforced()&&l.push(null==o?void 0:o.countryCodeOriginError),l.every((e=>!e))}canDisplayPrice(e){return!(0,L.hideUnsupportedCurrency)()||y.isSupportedCurrency(e)}shouldComplianceBeHardEnforced(){const{catalog:e}=this.props;return(0,L.canSeeECommerceComplianceIndiaHardEnforcementBusinessJourney)(e.id.user)}errorsRevealed(){var e;const t=(0,w.getMeUser)(),a=this.state.isComplianceInfoAvailable;if(!this.shouldComplianceBeHardEnforced()||!a)return!1;const n=(0,s.default)((0,s.default)({},this.state.complianceInfo),{},{importerAddress:(0,s.default)({},null===(e=this.state.complianceInfo)||void 0===e?void 0:e.importerAddress)});if(!(0,C.existsField)(n.countryCodeOrigin,t))return n.countryCodeOriginError=O.default.t(1500),this.setState({complianceInfo:n}),!0;if(!this._showComplianceInfoImporterAddress())return!1;const{importerName:i,importerAddress:{street1:r,city:o,countryCode:l}}=n;let d=!1;return(0,C.existsField)(i,t)||(n.importerNameError=O.default.t(1512),d=!0),(0,C.existsFieldIgnoreHardEnforcement)(r)||(n.importerAddress.street1Error=O.default.t(1509),d=!0),(0,C.existsFieldIgnoreHardEnforcement)(o)||(n.importerAddress.cityError=O.default.t(1503),d=!0),(0,C.existsFieldIgnoreHardEnforcement)(l)||(n.importerAddress.countryCodeError=O.default.t(1505),d=!0),!!d&&(this.setState({complianceInfo:n}),!0)}render(){const{catalog:e,product:t,onBack:a,onCancel:n,newProduct:i}=this.props,{isUpdating:s,isDragging:r,currency:o,nameError:l,priceError:u,urlError:h,retailerIdError:p,imageError:g,complianceInfo:v,isComplianceInfoAvailable:C}=this.state,_=(0,X.jsx)(f.default,{type:"primary",onClick:this._handleSaveItem,disabled:!this.isValid(),a8nText:"product-edit-drawer-save-button",children:i?O.default.t(160):O.default.t(1614)}),x=(0,X.jsxs)("div",{className:P.default.drawerHeader,children:[(0,X.jsx)(z.TextHeader,{level:"2",weight:"normal",customSize:"inherit",children:i?O.default.t(502):O.default.t(503)}),(0,X.jsx)("div",{className:P.default.drawerHeaderButtonContainer,children:_})]}),S=i?null:(0,X.jsx)("div",{className:P.default.deleteButtonContainer,children:(0,X.jsx)(f.default,{type:"warning",onClick:this._handleDeleteItem,a8nText:"product-edit-drawer-delete-button",children:O.default.t(708)})}),T=(0,d.default)(P.default.productWrapper,{[P.default.isSending]:s}),M=r?(0,X.jsx)(E.default,{}):null,w=s?(0,X.jsx)("div",{className:P.default.spinner,children:(0,X.jsx)(V.Spinner,{size:50,stroke:3})}):null,k=(0,X.jsxs)("div",{className:P.default.hiddenContainer,children:[(0,X.jsx)(m.CheckBox,{id:"product-hidden-check",onChange:this._handleHiddenChange,checked:this.state.isHidden,disabled:!1}),(0,X.jsx)("label",{className:P.default.hiddenLabel,htmlFor:"product-hidden-check",children:O.default.t(474)}),(0,X.jsx)("div",{className:P.default.hiddenDescr,children:O.default.t(473)})]});return(0,X.jsxs)(j.default,{theme:"catalog",onDrop:this.handleDrop,onDragChange:this.handleDragChange,children:[M,(0,X.jsx)(b.DrawerHeader,{a8n:"catalog-link-title",title:x,type:b.DRAWER_HEADER_TYPE.SMALL,onBack:a,onCancel:n,focusBackOrCancel:!0}),(0,X.jsx)(I.default,{children:(0,X.jsxs)("div",{className:T,children:[w,(0,X.jsx)(B.default,{product:t,maxImageCount:R.MAX_PRODUCT_IMAGES,onChange:this._handleImageChange,ref:this._imagePanelRef,error:g}),(0,X.jsx)(K.TextInput,{a8n:"product-edit-drawer-name-input",value:this.state.name,placeholder:O.default.t(1085),onChange:this._handleNameChange,theme:"small",customStyleThemes:["desaturated"],maxLength:150,error:l,title:c.fbt._("Name",null,{hk:"47pzCN"})}),this.canDisplayPrice(this.state.currency)&&(0,X.jsx)(K.TextInput,{a8n:"product-edit-drawer-price-input",value:this.state.priceStr,placeholder:O.default.t(1086,{currencySymbol:y.formatAmount1000ToParts(o,0).symbol}),onChange:this._handlePriceChange,theme:"small",maxLength:30,customStyleThemes:["desaturated"],error:u,title:c.fbt._("Price",null,{hk:"1q6KRK"})}),(0,X.jsx)(K.TextInput,{a8n:"product-edit-drawer-description-input",value:this.state.description,placeholder:O.default.t(1083),onChange:this.handleDescriptionChange,theme:"small",maxLength:5e3,customStyleThemes:["desaturated"],multiline:!0,title:c.fbt._("Description",null,{hk:"2sGitZ"})}),(0,X.jsx)(K.TextInput,{a8n:"product-edit-drawer-link-input",value:this.state.url,placeholder:O.default.t(1084),onChange:this._handleUrlChange,onBlur:this._handleUrlBlur,theme:"small",customStyleThemes:["desaturated"],maxLength:75,error:h,managed:!0,title:c.fbt._("Link",null,{hk:"1yLSRM"})}),(0,X.jsx)(K.TextInput,{a8n:"product-edit-drawer-retailer-id-input",value:this.state.retailerId,placeholder:O.default.t(1082),onChange:this._handleRetailerIdChange,theme:"small",customStyleThemes:["desaturated"],maxLength:100,error:p,title:c.fbt._("Item code",null,{hk:"6trPE"})}),(0,L.canSeeECommerceComplianceIndiaBusinessJourney)(e.id.user)?(0,X.jsx)(J,{isComplianceHardEnforced:this.shouldComplianceBeHardEnforced(),isComplianceInfoAvailable:C,showComplianceInfoImporterAddress:this._showComplianceInfoImporterAddress(),complianceInfo:v,onComplianceInfoChange:this._handleComplianceInfoChange,onComplianceInfoImporterAddressChange:this._handleComplianceInfoImporterAddressChange}):null,k,S]})})]},"catalog-link-drawer")}}function J({isComplianceInfoAvailable:e,isComplianceHardEnforced:t,showComplianceInfoImporterAddress:a,complianceInfo:n,onComplianceInfoChange:i,onComplianceInfoImporterAddressChange:s}){const r=e=>`${e} (${O.default.t(1514)})`,o=e=>!n||Object.values(n.importerAddress).every((e=>!e))?r(e):e;return e?(0,X.jsxs)("div",{a8n:"product-edit-drawer-compliance",children:[(0,X.jsx)(K.TextInput,{a8n:"product-edit-drawer-compliance-country-of-origin-input",value:null==n?void 0:n.countryNameOrigin,placeholder:O.default.t(1497),onChange:()=>{},theme:"small",customStyleThemes:["desaturated"],managed:!0,onFocus:()=>g.Cmd.showCountrySelector(O.default.t(1497),null==n?void 0:n.countryCodeOrigin,(e=>{i("countryCodeOrigin",e)})),error:null==n?void 0:n.countryCodeOriginError}),a&&(0,X.jsxs)(X.Fragment,{children:[(0,X.jsx)(K.TextInput,{a8n:"product-edit-drawer-compliance-importer-name-input",value:null==n?void 0:n.importerName,placeholder:o(O.default.t(1511)),onChange:e=>{i("importerName",e)},theme:"small",customStyleThemes:["desaturated"],maxLength:_.default.COMPLIANCE_INFO_LENGTH.IMPORTER_NAME,error:null==n?void 0:n.importerNameError}),(0,X.jsx)(K.TextInput,{a8n:"product-edit-drawer-compliance-importer-address-street-1-input",value:null==n?void 0:n.importerAddress.street1,placeholder:o(O.default.t(1508)),onChange:e=>{s("street1",e)},theme:"small",customStyleThemes:["desaturated"],maxLength:_.default.COMPLIANCE_INFO_LENGTH.STREET1,error:null==n?void 0:n.importerAddress.street1Error}),(0,X.jsx)(K.TextInput,{a8n:"product-edit-drawer-compliance-importer-address-street-2-input",value:null==n?void 0:n.importerAddress.street2,placeholder:r(O.default.t(1510)),onChange:e=>{s("street2",e)},theme:"small",customStyleThemes:["desaturated"],maxLength:_.default.COMPLIANCE_INFO_LENGTH.STREET2}),(0,X.jsx)(K.TextInput,{a8n:"product-edit-drawer-compliance-importer-address-city-input",value:null==n?void 0:n.importerAddress.city,placeholder:o(O.default.t(1502)),onChange:e=>{s("city",e)},theme:"small",customStyleThemes:["desaturated"],maxLength:_.default.COMPLIANCE_INFO_LENGTH.CITY,error:null==n?void 0:n.importerAddress.cityError}),(0,X.jsx)(K.TextInput,{a8n:"product-edit-drawer-compliance-importer-address-region-input",value:null==n?void 0:n.importerAddress.region,placeholder:r(O.default.t(1507)),onChange:e=>{s("region",e)},theme:"small",customStyleThemes:["desaturated"],maxLength:_.default.COMPLIANCE_INFO_LENGTH.REGION}),(0,X.jsx)(K.TextInput,{a8n:"product-edit-drawer-compliance-importer-address-country-code-input",value:null==n?void 0:n.importerAddress.countryName,placeholder:o(O.default.t(1504)),onChange:()=>{},theme:"small",customStyleThemes:["desaturated"],managed:!0,onFocus:()=>g.Cmd.showCountrySelector(O.default.t(1504),null==n?void 0:n.importerAddress.countryCode,(e=>{s("countryCode",e)})),error:null==n?void 0:n.importerAddress.countryCodeError}),(0,X.jsx)(K.TextInput,{a8n:"product-edit-drawer-compliance-importer-address-postal-code-input",value:null==n?void 0:n.importerAddress.postalCode,placeholder:r(O.default.t(1506)),onChange:e=>{s("postalCode",e)},theme:"small",customStyleThemes:["desaturated"],maxLength:_.default.COMPLIANCE_INFO_LENGTH.POSTAL_CODE}),(0,X.jsx)(v.ComplianceInfoHelpCenterBanner,{xstyle:Z.complianceInfoHelpCenterBanner})]})]}):(0,X.jsx)(M.FlexRow,{align:"center",justify:"center",children:(0,X.jsx)(M.FlexItem,{children:(0,X.jsx)(V.Spinner,{})})})}t.EditProductDrawerImpl=$,$.contextType=T.DrawerContext,$.CONCERNS={product:["id","additionalImageCdnUrl","name","priceAmount1000","description","productImageCollection","reviewStatus","url","imageCdnUrl","retailerId","currency","isHidden","complianceInfo"]},$.displayName="EditProductDrawerImpl";const ee=(0,k.default)((0,U.default)((0,W.default)((0,A.ListenerHOC)($),$.CONCERNS)));t.EditProductDrawer=ee},60879:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{onBack:t,onAddProductClick:a,isCreatingCatalogFn:n}=e,S=n(),y=(0,x.jsx)("div",{className:v.default.placeholderIcon}),E=(0,x.jsx)(o.default,{href:l.default.FB_LEGAL_TERMS_URL,onClick:e=>{e.preventDefault(),(0,p.openExternalLink)(l.default.FB_LEGAL_TERMS_URL)},children:m.default.t(856)}),j=(0,x.jsx)(o.default,{href:l.default.FB_COMMERCE_POLICY_URL,onClick:e=>{e.preventDefault(),(0,p.openExternalLink)(l.default.FB_COMMERCE_POLICY_URL)},children:m.default.t(855)}),I=(0,x.jsx)(o.default,{href:l.default.WA_COMMERCE_POLICY_URL,onClick:e=>{e.preventDefault(),(0,p.openExternalLink)(l.default.WA_COMMERCE_POLICY_URL)},children:m.default.t(2343)}),T=(0,x.jsx)(g.default,{id:468,params:{fb_product_link:E,fb_commerce_link:j,wa_commerce_policy_link:I}}),b=(0,i.default)({[v.default.isLoading]:S}),P=S?(0,x.jsx)("div",{className:v.default.spinner,children:(0,x.jsx)(C.Spinner,{size:50,stroke:3})}):null,M=S?(0,x.jsx)(s.default,{onClick:()=>{},theme:"default",idle:!!S}):(0,x.jsx)(u.DrawerContext.Consumer,{children:()=>(0,x.jsx)(s.default,{onClick:()=>{a()},theme:"default",idle:!1})});return(0,x.jsxs)(d.default,{children:[(0,x.jsx)(h.DrawerHeader,{title:m.default.t(1495),type:h.DRAWER_HEADER_TYPE.LARGE,onBack:t}),(0,x.jsx)(c.default,{className:b,children:(0,x.jsxs)(f.default,{theme:"padding-small",animation:!1,children:[P,(0,x.jsx)(_.TextDiv,{theme:"title",children:m.default.t(439)}),M,(0,x.jsx)(_.TextDiv,{theme:"plain",children:T}),(0,x.jsxs)("div",{className:v.default.placeholderContainer,children:[(0,x.jsx)(r.default,{theme:"add-item-placeholder",image:y,customImage:!0,className:v.default.addItemPlaceholder,primary:"",secondary:"",idle:!0}),(0,x.jsx)("div",{className:v.default.divider}),(0,x.jsx)(r.default,{theme:"add-item-placeholder",image:y,customImage:!0,className:v.default.addItemPlaceholder,primary:"",secondary:"",idle:!0}),(0,x.jsx)("div",{className:v.default.divider})]})]})})]},"catalog-link-drawer")};var i=n(a(94184)),s=n(a(32179)),r=n(a(55092)),o=n(a(44683)),l=n(a(55454)),d=n(a(17747)),c=n(a(9042)),u=a(79864),h=a(55588),f=n(a(25061)),p=a(4919),m=n(a(2408)),g=n(a(663)),v=n(a(97721)),C=a(46714),_=a(97504),x=a(85893)},21792:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.ProductInfoDrawer=t.ProductInfoDrawerImpl=void 0;var i=a(67294),s=n(a(69991)),r=n(a(17747)),o=n(a(9042)),l=a(79864),d=a(55588),c=n(a(25061)),u=n(a(52715)),h=a(86723),f=n(a(52087)),p=n(a(2408)),m=a(30333),g=a(90676),v=a(68793),C=a(70790),_=a(26491),x=n(a(45858)),S=n(a(10462)),y=n(a(43368)),E=n(a(29513)),j=n(a(51587)),I=a(21125),T=n(a(79485)),b=a(22360),P=a(97504),M=a(85893);class w extends i.Component{constructor(e){super(e),this.handleEditProduct=()=>{const{product:e}=this.props;this.props.onEditProduct&&this.props.onEditProduct(e)},this.handleShareProduct=()=>{const{product:e}=this.props;this.props.onShareProduct&&this.props.onShareProduct(e)},this.handleSendChat=()=>{this.props.onCancel(),(0,v.sendProductToChat)(this.props.product,this.props.catalog),(0,m.logProductMessageBusinessClick)(this.props.product,(0,C.getProductCatalogContext)(this.context))},this.state={isLoading:!0}}componentDidMount(){const{catalog:e,product:t,collectionId:a}=this.props,n=(0,h.getMaybeMeUser)();(0,g.qplAnnotateProductView)(!(null==n?void 0:n.equals(t.catalogWid))),e.pullProduct(t.id.toString()).then((()=>{(0,g.qplEndProductView)(I.QuickLogActionType.SUCCESS)})).catch((()=>{(0,g.qplEndProductView)(I.QuickLogActionType.FAIL)})).finally((()=>{this.setState({isLoading:!1})})),(0,m.logProductDetailView)({product:t,catalogContext:(0,C.getProductCatalogContext)(this.context),collectionId:a})}render(){const{product:e,onCancel:t,collectionId:a}=this.props,n=(0,h.getMaybeMeUser)(),i=b.StatusCollection.get(n),l=(0,M.jsx)(P.TextDiv,{theme:"muted",className:S.default.businessInfoTitle,children:p.default.t(372)}),f=e.reviewStatus!==_.PRODUCT_REVIEW_STATUS.APPROVED||e.isHidden,m=(0,M.jsxs)("div",{children:[(0,M.jsx)("div",{className:S.default.buttonSeparator,children:(0,M.jsx)(s.default,{type:"strong",onClick:this.handleEditProduct,a8nText:"product-info-drawer edit-button",children:p.default.t(755)})}),(0,M.jsx)(s.default,{type:"strong-primary",onClick:this.handleShareProduct,disabled:f,a8nText:"product-info-drawer share-button",children:p.default.t(2264)})]}),g=(0,M.jsxs)("div",{className:S.default.drawerHeader,children:[(0,M.jsx)("div",{className:S.default.productName,children:e.name}),(0,M.jsx)("div",{className:S.default.drawerHeaderButtonContainer,children:m})]}),v=i?(0,M.jsx)(c.default,{title:l,theme:"no-padding",children:(0,M.jsx)(j.default,{status:i})}):null,C=this.state.isLoading?(0,M.jsx)(u.default,{}):(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(E.default,{product:e,isAvailable:!0,fetching:!1}),(0,M.jsx)(y.default,{product:e}),(0,M.jsx)(x.default,{product:e,collectionId:a,onSendChat:this.handleSendChat,isAvailable:!0})]});return(0,M.jsxs)(r.default,{theme:"catalog",children:[(0,M.jsx)(d.DrawerHeader,{a8n:"catalog-product-title",title:g,type:d.DRAWER_HEADER_TYPE.SMALL,onCancel:t,headingLevel:"2",focusBackOrCancel:!0}),(0,M.jsxs)(o.default,{children:[(0,M.jsx)(c.default,{theme:"center-column-fixed-width",children:C}),(0,M.jsx)("div",{className:S.default.productWrapper,children:v})]})]},"catalog-link-drawer")}}t.ProductInfoDrawerImpl=w,w.contextType=l.DrawerContext,w.CONCERNS={product:["id","catalogWid","name","priceAmount1000","description","productImageCollection","reviewStatus","url","canAppeal","imageCdnUrl","retailerId","currency","isHidden"]},w.displayName="ProductInfoDrawerImpl";const L=(0,f.default)((0,T.default)(w,w.CONCERNS));t.ProductInfoDrawer=L},43368:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{product:t}=e;const a=(0,C.jsx)(r.default,{href:l.default.WA_COMMERCE_POLICY_URL,onClick:e=>{e.preventDefault(),(0,c.openExternalLink)(l.default.WA_COMMERCE_POLICY_URL)},children:u.default.t(1091)});if(t.reviewStatus===p.PRODUCT_REVIEW_STATUS.APPROVED)return t.isHidden?(0,C.jsxs)("div",{className:m.default.root,children:[(0,C.jsx)("div",{className:m.default.icon,children:(0,C.jsx)(g.default,{name:"hide"})}),(0,C.jsx)("div",{className:m.default.text,children:(0,C.jsx)(v.TextDiv,{children:u.default.t(1518)})})]}):null;if(t.reviewStatus===p.PRODUCT_REVIEW_STATUS.REJECTED){if(!0===t.canAppeal){const e=(0,C.jsx)(h.default,{id:476,params:{learn_more_link:a}}),n=(0,C.jsx)(r.default,{onClick:function(){o.Cmd.openModal((0,C.jsx)(d.DrawerContext.Consumer,{children:e=>(0,C.jsx)(s.default,{product:t,sessionId:(0,f.getProductCatalogSessionId)(e)})}))},a8n:"product-appeal-button",children:u.default.t(477)}),l=(0,C.jsx)(h.default,{id:469,params:{request_review_link:n},className:m.default.appealText,tabIndex:"0"});return(0,C.jsxs)("div",{className:m.default.root,"data-a8n":i.default.key("product-appeal-rejected-initial-review"),children:[(0,C.jsx)("div",{className:m.default.icon,children:(0,C.jsx)(g.default,{name:"info"})}),(0,C.jsxs)("div",{className:m.default.text,children:[e,l]})]})}{const e=(0,C.jsx)(h.default,{id:471,params:{learn_more_link:a}});return(0,C.jsx)("div",{className:m.default.root,"data-a8n":i.default.key("product-appeal-rejected-final"),children:e})}}if(t.reviewStatus===p.PRODUCT_REVIEW_STATUS.NO_REVIEW||t.reviewStatus===p.PRODUCT_REVIEW_STATUS.OUTDATED){const e=t.isHidden?(0,C.jsx)(h.default,{id:486,params:{learn_more_link:a}}):(0,C.jsx)(h.default,{id:485,params:{learn_more_link:a}});return(0,C.jsx)("div",{className:m.default.root,"data-a8n":i.default.key("product-appeal-pending-initial-review"),children:e})}if(!1===t.canAppeal){const e=u.default.t(470);return(0,C.jsx)("div",{className:m.default.root,"data-a8n":i.default.key("product-appeal-pending-appeal"),children:e})}return null};var i=n(a(76610)),s=n(a(12716)),r=n(a(44683)),o=a(69162),l=n(a(55454)),d=a(79864),c=a(4919),u=n(a(2408)),h=n(a(663)),f=a(70790),p=a(26491),m=n(a(72974)),g=n(a(2966)),v=a(97504),C=a(85893)},51587:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(67294),s=n(a(55092)),r=a(9322),o=a(88419),l=a(86723),d=n(a(52087)),c=n(a(79485)),u=a(85893);class h extends i.Component{render(){const{status:e}=this.props;return(0,u.jsx)(s.default,{image:(0,u.jsx)(o.DetailImage,{id:(0,l.getMaybeMeUser)()}),primary:r.Conn.pushname,secondary:e.status,idle:!0})}}h.CONCERNS={status:["status"]},h.displayName="ProfileLockup";var f=(0,d.default)((0,c.default)(h,h.CONCERNS));t.default=f},65587:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function({businessProfile:e,catalog:t,openCatalog:a=m}){const n=(0,r.hasShop)(e),l=Boolean(n&&h.ServerProps.shopsProductGrid);if((0,s.useEffect)((()=>{(0,c.logShopsManagementEvent)(u.default.SHOPS_MANAGEMENT_ACTION.ACTION_SHOPS_PRODUCT_PREVIEW_VISIBLE,{shouldLogJid:!1,isShopsProductPreviewVisible:l})}),[l]),n)return l?(0,p.jsx)(f.default,{isEditMode:!0,subtitle:d.default.t(1153),businessProfile:e,catalog:t,productsToShow:3}):null;return(0,p.jsx)(o.default,{catalog:t,onProductDetail:a,onProductCatalog:a,productsToShow:3,catalogEntryLabel:null==t?i.fbt._("Add catalog",null,{hk:"2iihM5"}):d.default.t(1877),showProductPlaceholders:!0,seeMoreOverlay:!0,sectionTheme:"refresh"})};var i=a(48360),s=a(67294),r=a(47874),o=n(a(22715)),l=a(77512),d=n(a(2408)),c=a(29931),u=n(a(4231)),h=a(65565),f=n(a(56605)),p=a(85893);function m(){(0,l.openCatalogManagementFlow)(null,u.default.CATALOG_ENTRY_POINT.CATALOG_ENTRY_POINT_PROFILE)}},38265:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(67294),s=n(a(91749)),r=n(a(48567)),o=a(47452),l=a(85051),d=n(a(2408)),c=n(a(2966)),u=a(63477),h=n(a(68062)),f=a(85893);function p(e){const{collection:t,theme:a,onDelete:n,onEdit:p,onSeeCollection:m,canManage:g}=e,[v]=(0,i.useState)(!1),[C,_]=(0,i.useState)(null),x=e=>{e.preventDefault(),e.stopPropagation(),n&&n(t)},S=e=>{e.preventDefault(),e.stopPropagation(),p&&p(t)},y=()=>{_(null)},E=(0,f.jsx)("div",{className:r.default.collectionIcon,children:(0,f.jsx)("div",{className:r.default.iconContainer,children:(0,f.jsx)(c.default,{name:"collections_folder"})})}),j=(0,f.jsx)(l.EmojiText,{text:t.name,ellipsify:!0,titlify:!0});let I;return C&&(I=(0,f.jsx)(u.UIE,{displayName:"CollectionContextMenu",escapable:!0,popable:!0,requestDismiss:y,children:(0,f.jsx)(h.default,{contextMenu:C})})),(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(s.default,{customImage:!0,image:E,primary:j,theme:a,active:v,contextEnabled:()=>e.canManage,onContext:e=>{if(C)return void _(null);const t=[];g&&(t.push((0,f.jsx)(o.DropdownItem,{a8n:"mi-show-label",action:S,children:d.default.t(451)},"EditLabel")),t.push((0,f.jsx)(o.DropdownItem,{a8n:"mi-show-label",action:x,children:d.default.t(449)},"DeleteLabel"))),_({menu:t,event:e.event,anchor:e.anchor})},onClick:e=>{e.preventDefault(),e.stopPropagation(),m&&m(t)}},t.id.toString()),I]})}p.defaultProps={theme:"collection-edit",isMuted:!1};var m=p;t.default=m},81772:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{data:t,canManage:a,onEditCollection:n,onSeeCollection:p}=e,m=(0,h.useModelValues)(e.catalog,["collections"]);return(0,f.jsx)(d.default,{flatListControllers:[e.flatListController],children:(0,f.jsx)(l.FlatList,{flatListController:e.flatListController,direction:"vertical",forceConsistentRenderCount:!1,data:(()=>{const e=[];return t.forEach((t=>{t.collection&&e.push({itemKey:t.collection.id,collection:t.collection})})),e})(),renderItem:({collection:e})=>(0,f.jsx)(o.DrawerContext.Consumer,{children:t=>(0,f.jsx)(s.default,{collection:e,canManage:a,onDelete:()=>((e,t)=>{(0,i.handleCollectionDelete)((0,u.unproxy)(m),e,t)})(e,(0,c.getProductCatalogContext)(t)),onEdit:n,onSeeCollection:p})}),defaultItemHeight:r.default.PRODUCT_LIST_ITEM_HEIGHT})})};var i=a(96470),s=n(a(38265)),r=n(a(55454)),o=a(79864),l=a(86025),d=n(a(19257)),c=a(70790),u=a(15298),h=a(76006),f=a(85893)},34114:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{setScrollOffset:t,editCollection:a,onSeeCollection:n}=e,I=(0,S.default)(),T=(0,x.default)((()=>I()),100),b=(0,y.default)((()=>new p.default)),[P,M]=(0,i.useState)(!0),[w,L]=(0,i.useState)(null),[k,O]=(0,i.useState)(null),A=(0,i.useMemo)((()=>{const e=(0,g.getMeUser)();return r.CatalogCollection.get(e)}),[]);(0,i.useEffect)((()=>{if(A){const e=new o.CollectionsDataSource(A,!0,c.default.PRODUCT_LIST_ITEM_HEIGHT);A.collections.on("add remove",T);const t=new o.CatalogListItemScrollHelper(e);L(e),O(t),e.loadInitialItems().then((()=>{M(!1),C.QPL.markerEnd(_.QuickLogMarkerId.WHATSAPP_COLLECTIONS_MANAGEMENT_VIEW,C.QuickLogActionType.SUCCESS)})).catch((()=>{C.QPL.markerEnd(_.QuickLogMarkerId.WHATSAPP_COLLECTIONS_MANAGEMENT_VIEW,C.QuickLogActionType.FAIL)}))}}),[]);const D=(0,E.default)((e=>{const a=e.currentTarget;t&&t(a.scrollTop),(null==k?void 0:k.willLoadMore(a))&&M(!0),null==k||k.onScroll(e,a).then((e=>{e&&M(!1)})).catch((e=>{throw M(!1),e}))}),100);return(0,j.jsxs)(u.default,{theme:"products",onDrop:e.onBack,children:[(0,j.jsx)(f.DrawerHeader,{title:v.default.t(458),type:f.DRAWER_HEADER_TYPE.LARGE,onBack:e.onBack,menu:(0,j.jsx)(j.Fragment,{})}),(0,j.jsx)(h.default,{onScroll:D,flatListControllers:[b.current],scrollOffset:e.scrollOffset,children:A&&w?(0,j.jsxs)("div",{children:[(0,j.jsx)(s.default,{onClick:()=>{a(null)},theme:"collections",title:v.default.t(454)}),(0,j.jsx)(l.default,{canManage:!0,catalog:A,onEditCollection:a,data:w.getData(),flatListController:b.current,onSeeCollection:n}),P&&(0,j.jsx)("div",{className:d.default.loadingSpinner,children:(0,j.jsx)(m.default,{})})]}):null})]})};var i=a(67294),s=n(a(32179)),r=a(60028),o=a(16156),l=n(a(81772)),d=n(a(12156)),c=n(a(55454)),u=n(a(17747)),h=n(a(9042)),f=a(55588),p=n(a(67893)),m=n(a(52715)),g=a(86723),v=n(a(2408)),C=a(21125),_=a(71578),x=n(a(38853)),S=n(a(45172)),y=n(a(79939)),E=n(a(16297)),j=a(85893)},65248:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(48360),s=a(67294),r=(n(a(56720)),a(73754)),o=a(69162),l=n(a(55454)),d=a(54432),c=n(a(2408)),u=a(57990),h=a(90672),f=a(92954),p=n(a(52937)),m=n(a(62831)),g=a(84241),v=a(21125),C=a(71578),_=n(a(2966)),x=a(49201),S=n(a(89135)),y=n(a(82669)),E=a(85893);const j={btnDelete:{position:"lhggkp7q",top:"hdpg1tjz",end:"ltcz4qz9",zIndex:"mb8var44",color:"k17s6i4e",filter:"rhe1kc9j"},btnAdd:{display:"p357zi0d",flexDirection:"f8m0rgwh",alignItems:"gndfcl4n",justifyContent:"ac2vgrno",width:"jkv2xdwy",height:"sptw4ec9",fontSize:"lak21jic",fontWeight:"hnx8ox4h",lineHeight:"gz7w46tb",letterSpacing:"hql59cr1"}};function I({images:e,deleteImage:t}){return e.filter((e=>e.mediaData)).map(((e,a)=>(0,E.jsxs)("div",{className:m.default.imageTile,children:[(0,E.jsx)(S.default,{xstyle:j.btnDelete,"aria-label":c.default.t(6,{imageNumber:a+1}),a8nText:"delete-image",onClick:()=>t(e),children:(0,E.jsx)(_.default,{className:m.default.deleteIcon,name:"x-alt"})}),(0,E.jsx)(g.ProductThumb,{mediaData:e.mediaData,className:m.default.imageThumb})]},e.mediaData.filehash)))}function T({inputRef:e,handleFilePick:t}){return(0,E.jsx)("input",{ref:e,type:"file",accept:l.default.IMAGE_MIMES,style:{display:"none"},onChange:t,multiple:!0})}function b(e,t){const{maxImageCount:a,onChange:n,error:g,product:b}=e,P=(0,s.useRef)(null),[M,w]=(0,s.useState)((()=>b.productImageCollection.filter((e=>!e.old)).map((e=>({url:e.mediaUrl,mediaData:e.mediaData}))))),L=()=>{if(P.current){P.current.click()}},k=e=>{e.mediaPrep.waitForPrep().then((t=>{if((e=>!(M.filter((t=>t.mediaData.filehash===e.filehash)).length>0&&(o.Cmd.openToast((0,E.jsx)(x.Toast,{id:(0,x.genId)(),msg:c.default.t(836)})),1)))(t)){t.mediaStage=h.MEDIA_DATA_STAGE.RESOLVED,t.renderableUrl=e.fullPreview;const a=t.mediaBlob;!a||a instanceof p.default||p.default.createFromData(a,a.type).then((e=>{t.mediaBlob=e}));const i=[...M,{url:null,mediaData:t}];w(i),null==n||n(i)}}))},O=e=>{(0,d.getFiles)(e,l.default.IMAGE_MIMES).then((e=>{const t=a-M.length;e.length>t&&o.Cmd.openToast((0,E.jsx)(x.Toast,{msg:c.default.t(1157),duration:6e3,action:{onAction:()=>{},actionText:c.default.t(916),dismiss:!0,theme:"success"},id:(0,x.genId)()})),e.slice(0,a-M.length).map((e=>({file:e,filename:e.name,mimetype:e.type,type:f.TYPE.PRODUCT}))).map((e=>{var t;const a=new r.AttachMedia({file:Promise.resolve(e)});return null===(t=a.processPromise)||void 0===t?void 0:t.then((()=>{k(a)}))}))})),e.target.value&&(e.target.value="")},A=()=>{const e=M.filter((e=>null==e.url)).length;v.QPL.markerAnnotate(C.QuickLogMarkerId.WHATSAPP_PRODUCT_SAVE,{int:{imagesCount:e}}),v.QPL.markerPoint(C.QuickLogMarkerId.WHATSAPP_PRODUCT_SAVE,"images_upload_start");const t=M.filter((e=>null==e.url)).map((e=>{const{mediaData:{mediaBlob:t,filehash:a}}=e;return t instanceof p.default?(0,u.uploadProductImage)(t,a).then((t=>{e.url=t})):null})).filter(Boolean);return Promise.all(t).then((()=>(v.QPL.markerPoint(C.QuickLogMarkerId.WHATSAPP_PRODUCT_SAVE,"images_upload_end"),M.map((e=>e.url||"")))))};return(0,s.useImperativeHandle)(t,(()=>({uploadImages:A,handleFilePick:O}))),(0,E.jsxs)("div",{className:m.default.panel,children:[(0,E.jsxs)("div",{className:m.default.tileContainer,children:[(0,E.jsxs)(y.default,{transitionAppear:!0,transitionName:"thumb-scale-flex",children:[(0,E.jsx)(I,{images:M,deleteImage:e=>{const t=M.filter((t=>t!==e));w(t),null==n||n(t)}}),M.length<a?(0,E.jsx)("div",{className:m.default.btnAddContainer,children:(0,E.jsxs)(S.default,{xstyle:j.btnAdd,"aria-label":i.fbt._("Add additional image",null,{hk:"1zIuu3"}),onClick:L,a8nText:"add-image",children:[(0,E.jsx)(_.default,{name:"camera"}),(0,E.jsx)("div",{className:m.default.btnAddText,children:c.default.t(438)})]})}):null]}),(0,E.jsx)(T,{inputRef:P,handleFilePick:O})]}),(0,E.jsx)("div",{className:m.default.errorMessage,role:"alert",children:g})]})}var P=(0,s.forwardRef)(b);t.default=P},38666:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function({flatListController:e,onProductDetail:t,productMessageList:a}){const n=a.productCollection.getProductModels(),x=a.getSections(),S=a.getSectionsCount()>0,y=a.getTotalProductsFetchedOrFailed(),E=a.getProductSize()===y&&0===n.length,j=[];x.forEach((({title:e,products:t},a)=>{const i=[];t.forEach((({productId:e})=>{const t=n.find((t=>t.id===e));null!=t&&i.push({itemKey:`section-${a}-${t.id.toString()}`,product:t,type:"product",height:o.default.PRODUCT_LIST_ITEM_HEIGHT})})),i.length>0&&(null!=e&&""!==e&&j.push({itemKey:`header-${a}-${e}`,label:e,type:"section",height:72}),j.push(...i))}));const I=(0,s.useCallback)(((e,a)=>((0,u.logCatalogListDetailClick)({product:(0,C.unproxy)(e),catalogContext:a}),(0,h.qplStartProductView)("ProductListMessages"),t(e))),[t]),T=(0,s.useCallback)((e=>{let t=null;switch(e.type){case"section":const{label:a}=e;t=(0,_.jsx)(v.default,{header:a});break;case"product":const{product:n}=e;t=(0,_.jsx)(l.DrawerContext.Consumer,{children:e=>(0,_.jsx)(p.default,{product:n,onClick:()=>I(n,(0,f.getProductCatalogContext)(e)),canManageCatalog:!1})})}return t}),[I]);return(0,s.useEffect)((()=>{E&&r.Cmd.openModal((0,_.jsx)(g.default,{onConfirm:()=>{r.Cmd.closeDrawerRight(),r.Cmd.closeModal()}}))}),[E]),(0,_.jsx)("div",{className:(0,i.default)({[m.default.list]:!0,[m.default.noSections]:!S}),children:(0,_.jsx)(c.default,{flatListControllers:[e],children:(0,_.jsx)(d.FlatList,{flatListController:e,direction:"vertical",forceConsistentRenderCount:!1,data:j,renderItem:T,itemEnterAnimationsEnabled:!0})})})};var i=n(a(94184)),s=a(67294),r=a(69162),o=n(a(55454)),l=a(79864),d=a(86025),c=n(a(19257)),u=a(30333),h=a(90676),f=a(70790),p=n(a(34290)),m=n(a(30781)),g=n(a(72126)),v=n(a(37314)),C=a(15298),_=a(85893)},36873:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.ProductMessageListDrawer=t.ProductMessageListDrawerImpl=void 0;var i=n(a(48926)),s=n(a(23493)),r=a(67294),o=a(25523),l=n(a(5221)),d=n(a(39618)),c=n(a(55454)),u=n(a(17747)),h=n(a(9042)),f=a(79864),p=a(55588),m=a(85051),g=a(28379),v=n(a(8212)),C=n(a(67893)),_=n(a(52715)),x=n(a(2408)),S=a(71681),y=a(20232),E=a(90676),j=a(47941),I=a(70790),T=n(a(38666)),b=a(97038),P=n(a(31025)),M=a(21125),w=a(71578),L=n(a(79485)),k=a(74289),O=n(a(27988)),A=a(85893);class D extends r.Component{constructor(e){super(e),this._productListFlatListController=new C.default,this._handleScroll=e=>{this.state.loadingMore||e.scrollTop+c.default.SCROLL_FUDGE>e.scrollHeight-e.clientHeight&&this._loadMoreProduct()},this.handleScroll=(0,s.default)(this._handleScroll,100),this._loadMoreProduct=e=>{const{productListId:t}=this.props,a=this.props.getUnmountSignal(),{stopLoading:n,loadedProducts:i}=this.state,s=b.ProductMessageListCollection.assertGet(t),r=s.getTotalProductsFetchedOrFailed(),o=s.getProductSize();if(n||r===o)return e&&(M.QPL.markerAnnotate(w.QuickLogMarkerId.WHATSAPP_PLM_DETAILS_VIEW,{int:{ProductsFetched:0,TotalProductsLoaded:r,TotalProductSize:o}}),M.QPL.markerEnd(w.QuickLogMarkerId.WHATSAPP_PLM_DETAILS_VIEW,M.QuickLogActionType.SUCCESS)),void this.setState({stopLoading:!0});this.setState({loadingMore:!0,loadedProducts:r});const l=e?w.QuickLogMarkerId.WHATSAPP_PLM_DETAILS_VIEW:void 0;b.ProductMessageListCollection.update(t,{markerId:l}).then((t=>{if(a.aborted)return void(e&&M.QPL.markerDrop(w.QuickLogMarkerId.WHATSAPP_PLM_DETAILS_VIEW));this.setState({loadingMore:!1});const n=(Array.isArray(t)?t[0]:t).getTotalProductsFetchedOrFailed();n===i&&this.setState({stopLoading:!0}),e&&(M.QPL.markerAnnotate(w.QuickLogMarkerId.WHATSAPP_PLM_DETAILS_VIEW,{int:{ProductsFetched:n-r,TotalProductsLoaded:n,TotalProductSize:o}}),M.QPL.markerEnd(w.QuickLogMarkerId.WHATSAPP_PLM_DETAILS_VIEW,M.QuickLogActionType.SUCCESS)),r*c.default.PRODUCT_LIST_ITEM_HEIGHT<window.innerHeight&&this._loadMoreProduct()})).catch((()=>{this.setState({loadingMore:!1,stopLoading:!0}),e&&M.QPL.markerEnd(w.QuickLogMarkerId.WHATSAPP_PLM_DETAILS_VIEW,M.QuickLogActionType.FAIL)}))},this.onScroll=e=>{this.handleScroll(e.currentTarget),this.props.setScrollOffset&&this.props.setScrollOffset(e.currentTarget.scrollTop)},this._handleCartChange=()=>{const e=this.state.cart.itemCount;this.state.cartCount!==e&&this.setState({cartCount:e})},this._handleCartClick=()=>{const{contact:e,onCartClick:t}=this.props;(0,E.qplStartCartView)("PLM"),t&&t(e.id.toString())};const t=b.ProductMessageListCollection.get(this.props.productListId),a=o.CartCollection.findCart(this.props.contact.id.toString());this.state={loadingMore:!1,loadedProducts:0,stopLoading:!1,productMessageList:t,cart:a,cartCount:a.itemCount,cartEnabled:!1,productMessageListFetchState:t?"SUCCESS":"NONE"}}componentDidMount(){const{listeners:e,contact:t}=this.props,a=this.props.getUnmountSignal();e.add(this.state.cart,"all",this._handleCartChange),this.state.productMessageList?this._loadMoreProduct(!0):this._findProductMessageList(),(0,d.default)(t.id).then((e=>{a.aborted||this.setState({cartEnabled:e})}))}_findProductMessageList(){var e=this;return(0,i.default)((function*(){try{const t=e.props.getUnmountSignal(),a=yield b.ProductMessageListCollection.find(e.props.productListId);if(t.aborted)return void M.QPL.markerDrop(w.QuickLogMarkerId.WHATSAPP_PLM_DETAILS_VIEW);e.setState({productMessageList:a,productMessageListFetchState:"SUCCESS"}),e._loadMoreProduct(!0)}catch(t){(0,g.parseErrorState)(t,(t=>e.setState({productMessageListFetchState:t}))),M.QPL.markerEnd(w.QuickLogMarkerId.WHATSAPP_PLM_DETAILS_VIEW,M.QuickLogActionType.FAIL)}}))()}_getDrawerContent(){const{productMessageList:e}=this.state;return e?(0,A.jsx)(A.Fragment,{children:(0,A.jsxs)("div",{children:[(0,A.jsx)(T.default,{productMessageList:e,flatListController:this._productListFlatListController,onProductDetail:this.props.onProductDetail}),this.state.loadingMore&&(0,A.jsx)(_.default,{})]})}):(0,A.jsx)(v.default,{fetchState:this.state.productMessageListFetchState})}_getCartIcon(){const{onCartClick:e,contact:t}=this.props;if(e&&this.state.cartEnabled){const e=this.state.cartCount,a=(0,k.isNumber)(e)&&e>0?e.toString():void 0,n=(0,y.getOnCartClickWithLog)(this._handleCartClick,t.id.toString(),(0,I.getProductCatalogContext)(this.context));return(0,A.jsx)(j.MenuBarItem,{a8nText:"menu-bar-cart-link",icon:(0,A.jsx)(l.default,{theme:"inherit-color"}),text:a,title:x.default.t(424),onClick:n})}return null}render(){const{productMessageList:e}=this.state;return(0,A.jsxs)(u.default,{theme:"products",onDrop:this.props.onBack,children:[(0,A.jsx)(p.DrawerHeader,{title:(0,A.jsx)("div",{className:P.default.title,children:(0,A.jsx)(m.EmojiText,{text:null==e?void 0:e.title,ellipsify:!0})}),type:p.DRAWER_HEADER_TYPE.SMALL,onBack:this.props.onBack,menu:this._getCartIcon()}),(0,A.jsx)(h.default,{onScroll:this.onScroll,flatListControllers:[this._productListFlatListController],scrollOffset:this.props.scrollOffset,children:this._getDrawerContent()})]})}}t.ProductMessageListDrawerImpl=D,D.contextType=f.DrawerContext,D.CONCERNS={contact:["id"]},D.displayName="ProductMessageListDrawerImpl";const R=(0,O.default)((0,S.ListenerHOC)((0,L.default)(D,D.CONCERNS)));t.ProductMessageListDrawer=R},72126:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function({onConfirm:e}){return(0,o.jsx)(i.default,{onOK:e,okText:r.default.t(2192),children:(0,o.jsx)(s.EmojiText,{text:r.default.t(1521)})})};var i=n(a(75940)),s=a(85051),r=n(a(2408)),o=a(85893)},63389:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a(48158)),s=a(67294),r=a(60028),o=n(a(2408)),l=a(57774),d=n(a(11546)),c=a(85893);const u=(e,t)=>{const[a,n]=(0,s.useState)(!1),[u,h]=(0,s.useState)([]),f=(0,c.jsx)(d.default,{disabled:!a,onClick:()=>{var t;const a=(0,i.default)(null===(t=u[0])||void 0===t?void 0:t.catalogWid,"products[0]?.catalogWid"),n=(0,i.default)(r.CatalogCollection.get(a),"CatalogCollection.get(catalogWid)");e.onShare(n)}});return(0,c.jsx)(l.SelectModal,{ref:t,title:o.default.t(1680),onCancel:e.onCancel,onConfirm:e.onConfirm,listType:l.ListType.PRODUCT_SELECT_MODAL,enableSearchBox:!1,customHeader:f,onSelectionChanged:(e,t,a)=>{n(0===a.length)},onDataLoaded:e=>{const t=e;h(t),n(t.length>0)}})};var h=(0,s.forwardRef)(u);t.default=h},11546:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const t=e.disabled?o.default.disabled:"",a=e.disabled?null:e.onClick,n=(0,d.jsx)("span",{className:o.default.title,children:s.default.t(1492)}),c=(0,d.jsx)(r.default,{theme:"compact",disabled:e.disabled,children:(0,d.jsx)(l.default,{name:"catalog"})});return(0,d.jsx)(i.default,{image:c,onClick:a,primary:n,theme:"list-button-compact",className:t})};var i=n(a(55092)),s=n(a(2408)),r=n(a(80091)),o=n(a(42082)),l=n(a(2966)),d=a(85893)},55922:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const t=(0,c.useModelValues)(e.statusV3,["id","t","hasUnread","unreadCount","totalCount","contact"]),a=(0,c.useModelValues)(e.contact,["formattedName","statusMute","isPSA"]),n=(0,i.default)({[o.default.dimmed]:a.statusMute}),h=r.Clock.relativeDateAndTimeStr(t.t);let f=a.formattedName;a.isPSA&&(f=(0,u.jsxs)("span",{className:o.default.verified,children:[a.formattedName,(0,u.jsx)("div",{className:o.default.icon,children:(0,u.jsx)(d.default,{name:"psa-verified"})})]}));return(0,u.jsx)(s.default,{className:n,customImage:!0,theme:"status-list",image:(0,u.jsx)(l.default,{statusV3:t,contact:a,onClick:e.onClick}),primary:f,secondary:h,onClick:e.onClick,contextEnabled:()=>!1},t.id.toString())};var i=n(a(94184)),s=n(a(91749)),r=a(25142),o=n(a(44710)),l=n(a(51130)),d=n(a(2966)),c=a(76006),u=a(85893)},51130:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{theme:t,thumbnailPlaceholder:a,msg:n}=e,s=(0,u.useModelValues)(e.statusV3,["lastStatus"]),o=(0,u.useModelValues)(e.contact,["statusMute"]),d=null!=n?n:s.lastStatus,h=p(t);let m;m=null!=a?a:d?(0,f.jsx)(r.DetailImage,{id:d.sender,theme:"status_v3",size:40}):null;return(0,f.jsxs)("div",{className:(0,i.default)(c.default.container,h),role:e.role||"",onContextMenu:null,onClickCapture:t=>{var a;null===(a=e.onClick)||void 0===a||a.call(e),t.stopPropagation(),t.preventDefault()},children:[o.statusMute||"status-panel"===t?null:(0,f.jsx)(l.StatusV3ImageRing,{statusV3:s}),(0,f.jsx)(g,{msg:d,theme:t,thumbnailPlaceholder:m})]})};var i=n(a(94184)),s=n(a(55454)),r=a(88419),o=n(a(30183)),l=(a(15298),a(46929)),d=a(14168),c=n(a(84080)),u=a(76006),h=n(a(69635)),f=a(85893);function p(e){return"status-panel"===e?c.default.thumbSizeLarge:c.default.thumbSizeSmall}function m(e){const{msg:t,theme:a}=e;return(0,f.jsx)("div",{className:(0,i.default)(c.default.statusImage,p(a)),style:{backgroundColor:t.statusV3TextBg},children:(0,f.jsx)("div",{className:(0,i.default)(c.default.textThumb,p(a)),children:(0,f.jsx)(d.StatusV3Text,{msg:t,theme:null!=a?a:"status-thumbnail"})})})}function g(e){const{msg:t,theme:a,thumbnailPlaceholder:n}=e,r=p(a),l=c.default.statusImage;return t?h.default.isPSA(t.sender)?(0,f.jsx)("div",{className:(0,i.default)(c.default.thumbContainer,r,c.default.statusImageFallbackBackground),children:n}):t.type===s.default.MSG_TYPE.CHAT?(0,f.jsx)(m,{msg:t,theme:a}):(0,f.jsx)(o.default,{containerClassName:(0,i.default)(c.default.thumbContainer,r,c.default.statusImageFallbackBackground),childClassName:(0,i.default)(l,r),msg:t,thumbnailPlaceholder:n}):(0,f.jsx)("div",{className:(0,i.default)(l,r,c.default.statusImageFallbackBackground)})}},62893:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.StickerIcon=function({url:e,xstyle:t}){const[a,{isIntersecting:n}]=(0,o.default)({root:null,rootMargin:"0px",threshold:0}),u=(0,i.useRef)(n);return u.current=u.current||n,(0,l.jsx)("div",{ref:a,className:(0,s.default)(d,t),children:u.current&&(0,l.jsx)(r.ImgWithFallback,{fallbackSVG:"sticker",wrapOptions:{centerWrapperChild:!0,wrapperClassName:""},className:(0,s.default)(c),size:"NONE",roundContainer:!1,imgProps:{src:e,draggable:!1},theme:r.Theme.Transparent})})};var i=a(67294),s=n(a(56720)),r=a(47357),o=n(a(39406)),l=a(85893);const d={boxSizing:"cm280p3y",height:"graaj7av",width:"jgly3g7g",minHeight:"lignnmtc",minWidth:"j3e9rhaw",position:"g0rxnol2"},c={width:"ln8gz9je",height:"ppled2lx"}},25189:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{stickerPacks:t,onStickerPackDetails:a}=e,n=(0,u.default)((()=>new l.default)),f=(0,i.useMemo)((()=>t.map((e=>({itemKey:e.id,stickerPack:e})))),[t]);return(0,h.jsx)(o.default,{flatListControllers:[n.current],children:(0,h.jsx)(r.FlatList,{flatListController:n.current,direction:"vertical",forceConsistentRenderCount:!1,data:f,renderItem:e=>(0,h.jsx)(c.default,{data:e,onClick:a}),defaultItemHeight:s.default.STICKER_LIST_ITEM_HEIGHT,keyOrder:d.KeyOrder.INVERSE})})};var i=a(67294),s=n(a(55454)),r=a(86025),o=n(a(19257)),l=n(a(67893)),d=a(82474),c=n(a(37939)),u=n(a(79939)),h=a(85893)},37939:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{stickerPack:t}=e.data,a=(0,u.jsxs)("div",{className:(0,s.default)(h.title),children:[(0,u.jsx)(l.EmojiText,{text:t.name,ellipsify:!0,titlify:!0}),t.animated?(0,u.jsx)(c.default,{name:"round-play",className:(0,s.default)(h.animatedIcon),width:16,height:16}):null]}),n=[],f=Math.min(6,t.previewImageIds.length);for(let e=0;e<f;e++){const a=t.previewImageIds[e];n.push((0,u.jsxs)(i.Fragment,{children:[(0,u.jsx)(r.default,{breakpoint:94*(e+1)-22,inverseToContainer:!0,maxWidth:"100%",minWidth:0}),(0,u.jsx)(d.StickerIcon,{url:`https://static.whatsapp.net/sticker?cat=sticker_preview_png&id=${a}`,xstyle:h.stickerIcon})]},a))}const p=(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(l.EmojiText,{text:t.publisher,ellipsify:!0}),(0,u.jsx)("div",{className:(0,s.default)(h.stickerIconsContainer),children:n})]});return(0,u.jsx)(o.default,{a8n:"sticker-pack-list-item",theme:"sticker-pack",primary:a,secondary:p,onClick:()=>{e.onClick(t)},className:(0,s.default)(h.stickerPack),contextEnabled:()=>!1},t.id)};var i=a(67294),s=n(a(56720)),r=n(a(61567)),o=n(a(91749)),l=a(85051),d=a(62893),c=n(a(2966)),u=a(85893);const h={stickerPack:{paddingStart:"lyvj5e2u",color:"h15s16sg"},title:{display:"p357zi0d",alignItems:"gndfcl4n"},animatedIcon:{marginStart:"oz0g9ue8",color:"kw851w1p"},stickerIconsContainer:{display:"p357zi0d",flexDirection:"sap93d0t",flexWrap:"dnb887gk",marginTop:"dj1c3cmq"},stickerIcon:{marginEnd:"gwq3iy2m"}}},61379:(e,t,a)=>{"use strict";var n=a(20862),i=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.search=function(){return m.apply(this,arguments)};var s=i(a(48926)),r=n(a(13540)),o=i(a(2408)),l=a(1458),d=i(a(40138));const c="https://www.bingapis.com/api/v6/images/search",u="D41D8CD98F00B204E9800998ECF8427E4F4A7492",h="Square",f="Medium",p={ar:"ar-SA",da:"da-DK",de:"de-DE",en:"en-US",es:"es-US",fi:"fi-FI",fr:"fr-FR",it:"it-IT",ko:"ko-KR",nl:"nl-NL",pl:"pl-PL","pt-BR":"pt-BR",ru:"ru-RU",sv:"sv-SE",tr:"tr-TR","zh-CN":"zh-CN","zh-TW":"zh-TW","zh-HK":"zh-HK"};function m(){return(m=(0,s.default)((function*(e,t,a=30){const n={q:e,SafeSearch:"Strict",appid:u,mkt:p[o.default.getLocale()]||p.en,size:f,aspect:h,count:a,offset:t},i=l.URL.build(c,n),s=yield d.default.get(i,d.default.RESP_TYPE.JSON);if(!s.response.hasOwnProperty("_type"))throw new r.InvalidServerResponseError(i,status,`Not a valid Bing response: ${JSON.stringify(s.response)}`);if("ErrorResponse"===s.response._type){const t=s.response;throw new r.BingServerError(e,s.status,t)}if("Images"!==s.response._type)throw new r.InvalidServerResponseError(i,status,`Did not receive an image search response, potentially malformed query ${JSON.stringify(s.response)}`);return s.response}))).apply(this,arguments)}},17605:(e,t,a)=>{"use strict";var n=a(20862),i=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,l.promiseLoop)(function(){var t=(0,s.default)((function*(t,a,n){const i=(0,o.delayMs)(d.expBackoff(n,6e4,void 0,.1));try{yield u.Socket.state===u.STATE.CONNECTED?Promise.resolve():(0,c.default)(u.Socket,"change:state",(0,r.default)({state:u.STATE.CONNECTED}));const a=yield e();if(a.status>=500&&a.status<600)return i;t(a)}catch(e){return i}}));return function(){return t.apply(this,arguments)}}())};var s=i(a(48926)),r=i(a(6410)),o=a(44213),l=a(50669),d=n(a(77062)),c=i(a(18051)),u=a(72787)},66317:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.getTosUrl=function(){return`${s}?lg=${i.default.getLocale()}`},t.TOS_BASE_URL=void 0;var i=n(a(2408));const s="https://www.whatsapp.com/legal/";t.TOS_BASE_URL=s},81465:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.validateURL=t.validateEmail=t.EMAIL_REGEX=void 0;var n=a(1458);const i=new RegExp(/^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?/);t.EMAIL_REGEX=i;t.validateEmail=e=>!e||i.test(e);t.validateURL=e=>!e||n.URL_REGEX.test(e)},11959:(e,t,a)=>{e.exports=a.p+"img/animated-doodle_600127bdb5f7627ede5cd4ef320f55b0.png"},95492:(e,t,a)=>{e.exports=a.p+"img/sticker-pack-empty_9f0c66fc3aec33b2f78f0ae1721e053b.png"},87009:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});const n={editMain:"_2I1Ow",dayMain:"JQF0C",timeWrapper:"_3MRIR",hoursAnd:"_2JxoB",hoursMain:"_28Fp0",dayCheckbox:"_2TA8L",dayInfo:"_1nLa3",dayInfoText:"_3nHg5"}},50743:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});const n={editMain:"_3JLJ7",list:"_2E4iI",rowMain:"uomL_",rowCheckbox:"x3Vkl",rowLabel:"_2H7gl",disabled:"_2rN2h",loadingSpinner:"_2ZkHo",searchBackground:"kkGAP"}},76482:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});const n={verifiedNameIcon:"vr8kz",noPaddingTop:"_3-G7O"}},62389:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});const n={loadingSpinner:"_3YfhH"}},19453:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});const n={info:"_3_VBJ",footer:"_1fPbz",emptyCartContainer:"_2o_Dj",emptyCardHeader:"_3hoSO",emptyCardText:"_8jb_l",btnSend:"_5P7L4",cartMessage:"_2F64R"}},65324:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});const n={price:"JOk72",actions:"_31IdY",deleteIcon:"_2fSr8",cartListItem:"_1kVL7"}},5323:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});const n={select:"_1xCOB"}},33776:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});const n={deleteIcon:"_19lTm"}},8959:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});const n={title:"_3Q5hz"}},78749:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});const n={title:"_13MJe",text:"hM3sj",icon:"_1p9YY"}},15308:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});const n={header:"_1vhuQ"}},72084:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});const n={container:"_2RE0a",border:"_3t6bN",square:"_36Gk7",avatar:"_1b8fw",count:"_1gLP4",two:"_1EzI5",first:"JOgRb",second:"_3Q0g1",three:"_33l2L",third:"_1MivT",four:"_18BoY",fourth:"_1P7KC"}},79169:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});const n={overlay:"gDU26",icon:"_28Ee5",text:"_3D1Iu"}},58780:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});const n={imageGallery:"_3uMAp",imageGalleryList:"_1WX5F",imageGalleryItem:"MkTEt",imageGalleryItemSpacer:"_2ppZW",imageGalleryItemImage:"_6CxGV",imageGalleryItemOverlay:"_7mUkD",selected:"_1KnO5",imageGalleryFooter:"PYlBE",focusAnimation:"_30mp5",focusAnimationKeyframes:"_3i50e"}},38376:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});const n={inputEmoji:"_2qGIa",wrapper:"_2AyZ_",textInput:"_35rEL",labelText:"bQgYT",clearInput:"_36AI6",float:"_5Y8X5",textActive:"_1sGCj",suggestionsPositioner:"vVBJc",suggestionsContainer:"_1odWc",charCounter:"rPbGr",inputControls:"_1vkjc",charCounterWithClearBtn:"G6w7m",spacer:"kcc20",noPlaceholder:"_2bRbC",buttonContainer:"nyoY0",active:"_6FdZt"}},20487:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});const n={container:"_3cOtp",body:"_1YLvc"}},18312:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});const n={container:"_1w1m1",disabled:"_3Sg2g",count:"ItnCt",large:"_3OTTU"}},6935:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});const n={versionInfo:"AwT3E"}},54115:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});const n={positioner:"_388vZ",container:"ewANj",resizableInput:"_1L8rJ",emojiButton:"_3tKNQ",buttonIconWrapper:"_1F5dF",inputContainer:"_3DCJ3",hiddenText:"_269u7",hiddenTextLine:"_3F7_-",emojiPlaceholder:"_39TQD"}},71488:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});const n={container:"_2nStn",inputContainer:"_1VmmK",videoCaption:"_2M4pc",buttonContainer:"_26J91",clearBtn:"_3EUIt",inputEmoji:"I1HlI",charCounter:"_3HWI2",suggestionsPositioner:"_3-qS1",suggestionsContainer:"_1Uy4i",secondaryButtonContainer:"_3g507",refreshedAppUI:"_1054P",refreshedAppUi:"_1054P"}},99062:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});const n={thumb:"_2AkjL",active:"_31gut",bodyWrapper:"_1iECW",body:"_1hZLd",bodyIcon:"_299B_",btnDelete:"_1By33"}},4104:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});const n={container:"_34aQy",header:"qAj2u",headerRight:"_3PqRX",canvasContainer:"_1PFn9",cropRotateContainer:"_3zRbB",closeButton:"_1gvdP",closeButtonPlaceholder:"_1Ao72",canvas:"_153i9",footer:"_1nPzf",bottomToolbar:"_1nNuD",captionInputContainer:"_1iQr1",captionInputHidden:"_6dYhh"}},44532:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});const n={container:"_1Mcu-",previewOnly:"_2NB7f",dropOverlay:"_1PdGl",dropOverlayOutline:"_2HexZ",spinner:"pzFG8",footer:"_1HI4Y",addMediaButton:"_1xotB",addMediaButtonDisabled:"WAMhx",filmstripContainer:"_1vAZI",thumbs:"_7Tfhi",sendButton:"_33pCO",captureFooter:"_1z1Aw"}},70905:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});const n={container:"_3gx1m",cropperContainer:"_2mSFk"}},2482:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});const n={body:"_25wph",previewContainer:"OW_mU",previewIcon:"_4FGL4",header:"_1Xi6x",metadata:"_3QpE7"}},81419:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});const n={container:"jcXC6"}},43232:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});const n={container:"_2SXhH",footer:"UJ-0N"}},35588:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});const n={container:"_2wtUo",selected:"_3z23o",disabled:"wZyqj",icon:"ZZ0GN",rotate:"_2X1cd",body:"_2O4Bw",caret:"_104hn"}},78055:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});const n={container:"_3eK79",colorChipsContainer:"_1E-L7"}},89471:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});const n={colorButton:"_2J8i-",primaryColorChip:"fteqj",primaryColorChipMedium:"_1Rjww",secondaryColorChip:"_1H9V5",active:"_3Jsf_",hover:"_1jiBu",selected:"_1lanH",colorChipWithBorder:"_2WYx6"}},95698:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});const n={container:"_1uNZ6",input:"_1bDiJ"}},56347:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});const n={canvas:"_3ZCwl",cursor:"_1YJQa"}},58510:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});const n={container:"fZGUF"}},57775:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});const n={container:"_1LRKO",rotateLeftButton:"_3dKFO"}},50918:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});const n={container:"QUfeO",fontLabel:"_3OMGG",icon:"_3SJCV"}},67024:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});const n={item:"_1j1xr",selected:"_2DKLD",sansSerif:"_106wS",serif:"_1yqqW",noricanRegular:"bzq8z",bryndanWrite:"_3Pj9c",oswaldHeavy:"ah3iR",alignmentContainer:"_2lKFu",alignmentIcon:"mi3vs",alignmentIconSelected:"_1KlZW"}},53964:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});const n={cirle:"_10ZsU",circleFilled:"_1ZATr",unchecked:"_1B4g5",checked:"_3s-4-"}},65251:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});const n={container:"_1_bv-",thicknessButton:"_3bAiP",thicknessChip:"_3iRrK",selected:"_32C9L"}},84978:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});const n={inputContainer:"XVAlv",label:"_3zFV7",input:"_3RaCQ"}},46771:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});const n={container:"JKr_m",media:"_3R3yC"}},56342:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});const n={container:"_3fFxj",media:"_3lqv9",document:"hH6sl",text:"eAWMI",icon:"fDWKK"}},13149:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});const n={container:"_1ULgK",media:"_2gN82",img:"OunMM",audio:"_3ZDt1",videoContainer:"_33jN5",spinner:"_1-L7X",video:"_2Vd8_",staticPreview:"sWhPU"}},28469:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});const n={container:"_2nVq-",preview:"_1K_xd",caption:"_3xLDc",img:"_2zsdh",imgBorder:"_2Cuay"}},53939:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});const n={list:"_2i0C9",hint:"_3sZ4R",button:"AoASc"}},55386:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});const n={container:"_3zKdl",body:"Sy3TC",captionInput:"_32AUO",footer:"_11gZr",retakeBtn:"rKFEM",retakeIcon:"_2rZzC",caption:"_1sxcB",videoContainer:"_2xIhM",video:"_2jZjN",btn:"_2kkeT",videoInactive:"_2eCp4",btnSend:"_1103Z",image:"_288ya",snapshot:"_3sE1m"}},71889:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});const n={newGroupButton:"EptxG"}},13550:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});const n={icon:"_2WtuC",body:"_3TCJd",spinner:"_1PKms",ack:"YYcY9",statusBlue:"_13UwK"}},86088:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});const n={dropOverlay:"PHaD9",dropOverlayOutline:"WsbTY"}},51236:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});const n={btnSend:"_1WEiG",attributionLink:"_4yicW",mediaBody:"_1YZ48",attribution:"_1nd00",footer:"iajo1",containerBackground:"_3rPvK",retake:"_3r-Fa",retakeIcon:"_3SS26",mediaElementBase:"_3ULIF",mediaElement:"_38bBM _3ULIF"}},95884:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});const n={mediaViewerImg:"_2rSfC",cropOverlay:"pKKiG"}},46475:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});const n={scaler:"_3QxRj",scalerButton:"P6r3N"}},65813:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});const n={wrapper:"fvxZ_",icon:"_3kxe5",text:"sfUBV"}},32521:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});const n={linkContainer:"_3eSYR",descContainer:"_1r8tU",icon:"_3qnQ8"}},56081:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});const n={confirmationText:"_2rM2V"}},23533:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});const n={title:"_3X4ur",titleIcon:"_3v5-C",ack:"_3hJA9",statusBlue:"_31P1q",forwardCount:"_36jfD",spinner:"_3pJTm",list:"_34Zzk",footer:"W5HdQ"}},2021:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});const n={commentInput:"_2_o99",search:"_1Plju",groupInfo:"_2wLei",onSendInvite:"_2-WpU"}},51298:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});const n={animation:"o43XS","play-ltr":"_1-zyO",playLtr:"_1-zyO","play-rtl":"_27Hce",playRtl:"_27Hce",versionInfo:"_1hWGI"}},45227:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});const n={container:"srSIT",wallpaperColorCanvas:"_33YuY",wallpaperColorEmpty:"_1BHKm",canvasActive:"_3o6gY",canvasHover:"_3zuY0"}},44676:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});const n={addLabelBtContainer:"ohbFn"}},64677:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});const n={container:"_2BtE_",textContainer:"_2Tvyf",spinner:"HYKvS"}},14395:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});const n={container:"_2136P",list:"C1Dd9",header:"K1c_P",item:"_16f8P",right:"DMk3i",left:"_1mO8w",close:"_38Gu8",name:"_2z4ea",time:"_4VLPt"}},34600:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});const n={wrapper:"_9Gs_R",offline:"_3rEcJ",circle:"_2Xn1u",text:"_1nFpn",notification:"p9CjV",ended:"_2OrJW",lastUpdated:"_3VPfk"}},85529:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});const n={wrapper:"_26J0I",inactive:"_2ZG5x",offline:"Pc7bU",circle:"_1487t",text:"_2WNWn",backToCenter:"_3LWZ9",visible:"_2Ozk7"}},98057:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});const n={container:"_2BPRJ",map:"_312iE",authFailed:"xgGDH",loading:"L5P7F"}},48347:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});const n={container:"_3rs7K",selected:"_10G_J",glow:"h5TUN",stale:"_3WyhQ",expired:"_1HO_K",pin:"_2JeQm"}},67493:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});const n={list:"D0Q5P",stopSharingButton:"_8wYL"}},85753:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});const n={popup:"_1O7kH",container:"_1qWAL",twoLines:"_2dn9y",name:"_2UN5N",status:"_1fM0V",menuButton:"_2UenO",triangle:"_1NoUg"}},76747:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});const n={actionBtns:"_1s6Xm",newLabelBtn:"_3bYuL",plus:"_2ZM_7"}},4448:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});const n={nextButton:"_1Opmc",section:"_1p7Ee",header:"_1AdYi",chevronIcon:"_3Xfdv"}},95575:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});const n={spinner:"_27bPO",search:"_3zFPA",inputarea:"_1x9wV",inputLine:"etp_f",contacts:"_2DdHI",drawerSection:"_37Xh5",inputareaSizer:"_2-opG"}},66915:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});const n={photoPickerWrapper:"_1Mc0y",scale:"_55HVY",nameWrapper:"_2LTDQ","well-animation":"_1EgwP",wellAnimation:"_1EgwP",phoneIcon:"_9P72S",phoneField:"_1zywm",infoText:"_3FDYs",bannedShopInfoText:"_1EFZ5",content:"_3XR9y"}},4662:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});const n={text:"_2QEzO",checkbox:"_3xbR9",header:"_1_8IZ"}},96601:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});const n={container:"_1J075",section:"_2BZQN",control:"_1iSYt",label:"_3AXj8",disabled:"_1Aj3d"}},96363:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});const n={more:"_394Lu",hotKeyWraper:"_3lwKF"}},83314:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});const n={body:"nWPOn",vcardWrapper:"j80SY",btnContainer:"_386ov",btnPosition:"_3o41r"}},26163:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});const n={wallpaperApplyDoodle:"_1aWJq",checkboxLabel:"XvSmy",wallpaperColorGrid:"KzJy3",wallpaperColorCanvas:"Iwkc0",wallpaperDefaultTitle:"_2jzUd",wallpaperColorEmpty:"_1qqLM",canvasHover:"_3Mp8z",canvasActive:"_2MCR7",canvasDefault:"GRVkn"}},22880:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});const n={date:"_3mIC0",info:"_2HSFB",composerWrapper:"_32xxD"}},20295:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});const n={price:"_3VVtW",separator:"I8-Ql",quantity:"_3hg85"}},93543:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});const n={descriptionText:"HZZS9",loadingSpinner:"_1D_wr"}},78518:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});const n={nameContainer:"_29TgP",nameIcon:"_2VsX7",nameEdit:"ajaQb",listContainer:"g5Pwo",footer:"gsAan",saveButton:"_2992-",operation:"Ky876",spinner:"_10Kpf",isSending:"_2saS4",container:"g0kY2",loadingSpinner:"_1mBPZ"}},37201:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});const n={productWrapper:"nwLZK",drawerHeader:"_9loHN",drawerHeaderButtonContainer:"_3UHa1",deleteButtonContainer:"_1GJGf",isSending:"R3KoU",spinner:"_3Of6S",hiddenLabel:"_1wTLv",hiddenDescr:"_133oH",hiddenContainer:"dhIGH"}},97721:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});const n={addItemPlaceholder:"_13K6_",placeholderIcon:"_21z7W",placeholderContainer:"j43hv",divider:"_1fHvf",isLoading:"_3cWYA",spinner:"_3skoT"}},10462:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});const n={drawerHeader:"_361UW",productName:"_3oqif",buttonSeparator:"_1dmnE",drawerHeaderButtonContainer:"G-hW5",productWrapper:"_2OajO",businessInfoTitle:"_2Wol_"}},72974:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});const n={root:"_28jDA",appealText:"Cifen",icon:"_3fJrr",text:"_2ZAuC"}},48567:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});const n={collectionIcon:"_1hToA",iconContainer:"_16Vdq"}},12156:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});const n={loadingSpinner:"_15oXt"}},62831:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});const n={panel:"_2k6IR",tileContainer:"hFwyO",imageTile:"_37Ag3",imageThumb:"_2gPsu",deleteIcon:"_2ICL9",btnAddContainer:"_JDHz",btnAddText:"_1rMC8",errorMessage:"_3Ueu_"}},30781:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});const n={list:"_3hjFg",noSections:"_3UBYX"}},31025:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});const n={title:"jm-c-"}},42082:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});const n={disabled:"_29h2z",title:"_2AWxj"}},44710:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});const n={dimmed:"khEuM",verified:"_3e7DF",icon:"_3OVY5"}},84080:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});const n={textThumb:"qgEhU",thumbSizeSmall:"_14N8a",thumbSizeLarge:"_2dKet",statusImage:"_37ckN",statusImageFallbackBackground:"_14MS9",container:"_3xFA4",thumbContainer:"_1cDhn"}}}]);
//# sourceMappingURL=https://web.whatsapp.com/lazy_loaded_low_priority_components.e46ab53523fd0bb9cb80.js.map
