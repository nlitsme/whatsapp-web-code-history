/*! Copyright (c) 2021 WhatsApp Inc. All Rights Reserved. */
(self.webpackChunkbuild=self.webpackChunkbuild||[]).push([[275],{57614:(e,t,a)=>{"use strict";var s=a(14859),i=a(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.setPushname=function(e){return p(e)};var r=i(a(2784)),l=a(8507),n=s(a(13277)),o=s(a(79435)),d=a(33576),c=s(a(38637)),u=s(a(40595)),h=a(63860);function p(e,t=(0,l.genId)()){var a=(0,u.default)(e),s=new l.ActionType(c.default.t(191)),i=o.default.pushname,f=a.then((()=>new l.ActionType(c.default.t(188),{actionText:c.default.t(203),actionHandler:()=>p(i,t)}))).catchType(d.ServerStatusCodeError,(e=>{if(e.status>=400)return new l.ActionType(c.default.t(189))})).catch((()=>{throw __LOG__(3)`models:conn:setPushname dropped`,new l.ActionType(c.default.t(189),{actionText:c.default.t(199),actionHandler:()=>p(status,t)})}));return n.default.openToast(r.createElement(l.ActionToast,{id:t,initialAction:s,pendingAction:f})),a.then((t=>{t._duplicate||(0,h.setPushnameLocally)(e)}))}},95877:(e,t,a)=>{"use strict";var s=a(93291),i=a(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a,s){var i=e.map(C.vcardFromContactModel),n=1===i.length?i[0]:(0,C.mergeVcards)(i),o=`${n.displayName}.vcf`,c=(0,h.createFile)([n.vcard],o,{type:S}),m=c.size/1024;if(0!==E.default.vcardAsDocumentSizeKb&&m>E.default.vcardAsDocumentSizeKb)return void function(){y.apply(this,arguments)}(c,e.length,t,a,s);!function(e,t,a,s,i){var n=s&&s.msgContextInfo(t.id),o=(0,p.getMaybeMeUser)(),c=(0,r.default)((0,r.default)({ack:u.default.ACK.CLOCK,from:o,id:new f.default({from:o,to:t.id,id:(0,v.default)(),participant:void 0,selfDir:"out"}),local:!0,isNewMsg:!0,self:"out",t:d.default.globalUnixTime(),to:t.id},n),{},{ctwaContext:i}),h=1===e.length?(0,r.default)((0,r.default)({type:"vcard",vcardFormattedName:e[0].displayName,body:e[0].vcard},c),I(t)):(0,r.default)((0,r.default)({type:"multi_vcard",vcardList:e},c),I(t));(0,l.default)((function*(){try{yield(0,g.addAndSendMsgToChat)(t,h)[1]}catch(e){throw __LOG__(2)`Error sending contact: ${e}`,e}}))()}(i,t,0,a,s)};var r=i(a(70417)),l=i(a(52954)),n=s(a(2784)),o=i(a(63256)),d=i(a(99461)),c=i(a(13277)),u=i(a(23045)),h=a(48537),p=a(66239),f=i(a(83746)),m=i(a(21830)),v=i(a(2661)),g=a(76774),E=i(a(54559)),_=s(a(97025)),C=a(65999),S="text/vcard";function y(){return(y=(0,l.default)((function*(e,t,a,s,i){var r={file:e,type:u.default.MSG_TYPE.DOCUMENT,filename:e.name,mimetype:S,isVcardOverMmsDocument:!0,documentPageCount:t},d=new o.default({chatParticipantCount:a.getParticipantCount()});yield d.processAttachments([r]);var{errorMsgs:h}=d.uiProcessMsgs();if(h)c.default.openToast(n.createElement(_.default,{msg:h,id:(0,_.genId)()}));else{var p=(0,m.default)(d.getValidMedias()[0],"collection.getValidMedias()[0]");(0,l.default)((function*(){try{yield p.sendToChat(a,{quotedMsg:s,ctwaContext:i})}catch(e){throw __LOG__(2)`Error sending contact: ${e}`,e}}))()}}))).apply(this,arguments)}function I(e){var t={};if(E.default.ephemeralMessages){e.isEphemeralSettingOn()&&(t.ephemeralDuration=e.getEphemeralSetting());var a=e.getEphemeralSettingTimestamp();null!=a&&(t.ephemeralSettingTimestamp=a)}return t}},81359:(e,t,a)=>{"use strict";var s=a(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.editBusinessProfile=function({address:e,description:t,categories:a,email:s,website:o,businessHours:d}){var c=(0,i.wap)("iq",{to:i.S_WHATSAPP_NET,xmlns:"w:biz",id:(0,i.generateId)(),type:"set"},(0,i.wap)("business_profile",{v:"3",mutation_type:"delta"},void 0!==e?(0,i.wap)("address",null,e):null,void 0!==t?(0,i.wap)("description",null,t):null,void 0!==s?(0,i.wap)("email",null,s):null,o&&0===o.length?(0,i.wap)("website",null):null,o&&o.length>0?(0,i.wap)("website",null,o[0]):null,o&&o.length>1?(0,i.wap)("website",null,o[1]):null,a?(0,i.wap)("categories",null,a.map((e=>(0,i.wap)("category",{id:(0,i.CUSTOM_STRING)(e.id)})))):null,d?function({note:e,timezone:t,config:a}){var s=[];for(var r in a){var l=a[r],{mode:n,hours:o}=l;if(o)for(var[d,c]of o)s.push({day_of_week:r,mode:n,open_time:d,close_time:c});else s.push({day_of_week:r,mode:n})}var u=[];e&&u.push((0,i.wap)("business_hours_note",null,e));return u.push(...s.map((e=>(0,i.wap)("business_hours_config",{day_of_week:(0,i.CUSTOM_STRING)(e.day_of_week),mode:e.mode,open_time:e.open_time?(0,i.CUSTOM_STRING)(e.open_time.toString()):i.DROP_ATTR,close_time:e.close_time?(0,i.CUSTOM_STRING)(e.close_time.toString()):i.DROP_ATTR})))),(0,i.wap)("business_hours",{timezone:t?(0,i.CUSTOM_STRING)(t):i.DROP_ATTR},u)}(d):null));return(0,r.sendIq)(c,n).then((e=>{if(!e.success)throw new l.ServerStatusCodeError(e.errorCode)}))};var i=a(35773),r=a(7017),l=a(33576),n=new(s(a(45521)).default)("businessProfileResponse",(e=>{e.assertTag("iq"),e.assertFromServer()}))},29083:(e,t,a)=>{"use strict";var s=a(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.sendSupportRequest=function(e,t){var a=(0,i.wap)("iq",{from:(0,d.USER_JID)((0,n.getMeUser)()),id:(0,i.generateId)(),smax_id:"3",to:i.S_WHATSAPP_NET,type:"set",xmlns:"fb:thrift_iq"},(0,i.wap)("description",null,e),null!=t?(0,i.wap)("debug_information_json",null,t):null);return(0,l.sendIq)(a,u).then((e=>{var a;if(e.success){var s,{result:i}=e;return"success"===i.type?(null!=t&&(__LOG__(2)`InAppSupport: Uploading logs for ticketId=${i.ticketId}`,(0,r.upload)({reason:"user-report",immediate:!0,force:!0,persist:!0,ticketId:i.ticketId}).then((e=>{__LOG__(2)`InAppSupport: Logs upload complete for ticketId=${i.ticketId}, logsId=${e}`}))),{type:"success",message:i.message,ticketId:i.ticketId}):(c(a=null!==(s=i.errorCode)&&void 0!==s?s:400),{type:"error",errorCode:a})}return c(e.errorCode,e.errorText),{type:"error",errorCode:e.errorCode}}))};var i=a(35773),r=a(2537),l=a(7017),n=a(66239),o=s(a(45521)),d=a(29020);function c(e,t){__LOG__(3,void 0,void 0,!0)`supportRequest error: code=${e} message=${null!=t?t:""}`,SEND_LOGS("supportRequest")}var u=new o.default("supportResponse",(e=>{var t=e.child("response");return t.hasAttr("error_code")?{type:"error",errorCode:t.attrInt("error_code",0,1e3)}:(t.assertAttr("status","ok"),{type:"success",message:t.child("message").contentString(),ticketId:t.child("ticket_id").contentString()})}))},25668:(e,t,a)=>{"use strict";var s=a(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.editBusinessProfile=void 0;var i=s(a(20468)),r=s(a(61994)),l=a(81359);t.editBusinessProfile=e=>{var t;return i.default.supportsFeature(i.default.F.MD_BACKEND)?(t=(0,l.editBusinessProfile)(e))||(t=Promise.reject(new Error("md business profile edit not supported"))):t=(0,r.default)(e),t}},61994:(e,t,a)=>{"use strict";var s=a(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.convertProfileToRequestData=void 0;var i=s(a(70417)),r=s(a(52954)),l=a(33576),n=s(a(22618)),o=s(a(15934)),d=e=>{if(e)return{category:e.map((({id:e})=>({id:e})))}},c=e=>{if(e){var{note:t,timezone:a,config:s}=e,i=[];for(var r in s){var l=s[r],{mode:n,hours:o}=l;if(o)for(var[d,c]of o)i.push({day_of_week:r,mode:n,open_time:d,close_time:c});else i.push({day_of_week:r,mode:n})}return{timezone:a,business_hours_note:t,business_hours_config:i}}},u=({address:e,description:t,email:a,website:s,businessHours:i,categories:r})=>{var l=(0,n.default)({address:e,description:t,email:a,website:s,business_hours:c(i),categories:d(r)});return Object.keys(l).length>0?l:void 0};t.convertProfileToRequestData=u;var h=function(){var e=(0,r.default)((function*(e){var t=u(e);if(t){var a=(0,i.default)({v:2},t);try{var s=yield o.default.send2({data:["action","editBusinessProfile",a],retryOn5xx:!0}),{status:r}=s;if((e=>e>=200&&e<=299)(r))return;throw __LOG__(3)`error editing business profile webd: ${r}`,new l.ServerStatusCodeError(r,"edit business profile")}catch(e){var n=e;throw __LOG__(3)`error editing business profile: ${n}`,n}}else __LOG__(3)`empty profile received, ignoring save`}));return function(){return e.apply(this,arguments)}}();t.default=h},40595:(e,t,a)=>{"use strict";var s=a(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){if(r.default.supportsFeature(r.default.F.MD_BACKEND)&&e){var t=(0,n.unixTimeMs)(),a=d.default.getPushnameMutation(t,e);return(0,o.default)(e),(0,c.lockForSync)([],[a],(()=>Promise.resolve())).then((()=>({_duplicate:null})))}return l.default.setPushname(e).then((e=>{if(e.status&&200!==e.status)throw new i.ServerStatusCodeError(e.status);return{_duplicate:e._duplicate}}))};var i=a(33576),r=s(a(20468)),l=s(a(94407)),n=a(95334),o=s(a(99785)),d=s(a(43010)),c=a(58970)},85871:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CombinedFingerprintSpec=t.FingerprintDataSpec=void 0;var s=a(99454),i={};t.FingerprintDataSpec=i;var r={};t.CombinedFingerprintSpec=r,i.internalSpec={publicKey:[1,s.TYPES.BYTES],identifier:[2,s.TYPES.BYTES]},r.internalSpec={version:[1,s.TYPES.UINT32],localFingerprint:[2,s.TYPES.MESSAGE,i],remoteFingerprint:[3,s.TYPES.MESSAGE,i]}},5623:(e,t,a)=>{"use strict";var s=a(93291),i=a(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(a(52954)),l=i(a(70417)),n=s(a(2784)),o=i(a(46136)),d=i(a(93257)),c=i(a(27018)),u=i(a(38637)),h=a(46401),p=i(a(61482)),f=i(a(48282)),m=i(a(29984)),v=i(a(92915)),g=a(85289),E=a(28103).Mirrored(["START","END"]),_=h.BUSINESS_HOUR_MODES.SPECIFIC_HOURS,C=()=>[(0,g.minutesToTime)(540),(0,g.minutesToTime)(1080)];class S extends n.Component{constructor(...e){super(...e),this.state=(({businessHours:{mode:e,days:t}})=>{var a={};for(var{dayKey:s,closed:i,hours:r,dayName:l}of t)a[s]={closed:i,hours:r||[C()],dayKey:s,dayName:l};return{mode:e||_,dayValues:a}})(this.props)}_buildDayId({dayKey:e}){return`${e}_business_hours`}_renderCheckbox(e){var{closed:t,dayKey:a}=e,s=this._buildDayId(e);return n.createElement("div",{className:o.default.dayCheckbox},n.createElement(d.default,{id:s,checked:!t,onChange:()=>{var{dayValues:e}=this.state,t=e[a];this._updateDayValue(a,{closed:!t.closed})}}))}_renderTabs(){var{mode:e}=this.state;return n.createElement(m.default,{onSelect:e=>{if(e===h.BUSINESS_HOUR_MODES.OPEN_24H){var{dayValues:t}=this.state;for(var a of h.DAYS_OF_WEEK)t[a]=(0,l.default)((0,l.default)({},t[a]),{},{closed:!1});this.setState({mode:e,dayValues:t})}else this.setState({mode:e})},selectedId:e,tabConfigs:[{title:u.default.t(302),id:h.BUSINESS_HOUR_MODES.SPECIFIC_HOURS},{title:u.default.t(298),id:h.BUSINESS_HOUR_MODES.OPEN_24H},{title:u.default.t(299),id:h.BUSINESS_HOUR_MODES.APPOINTMENT_ONLY}]})}_updateValueToUserTimeFormat(e,t,a){var{dayValues:s}=this.state,i=s[e],{hours:r}=i,l=t===E.START?0:1,n=r[a][l],o=(0,g.timeStringToMinutes)(n);void 0!==o&&this._updateDayValue(e,{hours:this._updateHoursValue(r,(0,g.minutesToTime)(o),t,a)})}_updateHoursValue(e,t,a,s){var i=[...e],r=a===E.START?0:1,l=[...i[s]];return l[r]=t,i[s]=l,i}_renderTimeInput(e,t,a,s){var i=(0,g.isValidTime)(t)?null:" ";return n.createElement("div",{key:`${e}-${a}-${s}`,className:o.default.timeWrapper},n.createElement(v.default,{managed:!0,value:t,theme:"small",maxLength:15,customStyleThemes:["desaturated","noErrorInfo"],error:i,onChange:t=>{var{dayValues:i}=this.state,r=i[e],{hours:l}=r;this._updateDayValue(e,{hours:this._updateHoursValue(l,t,a,s)})},onBlur:()=>{this._updateValueToUserTimeFormat(e,a,s)}}))}_updateDayValue(e,t){var{dayValues:a}=this.state,s=a[e];this.setState({dayValues:(0,l.default)((0,l.default)({},a),{},{[e]:(0,l.default)((0,l.default)({},s),t)})})}_addHours(e){var{dayValues:t}=this.state,a=t[e],{hours:s}=a;this._updateDayValue(e,{hours:[...s,C()]})}_removeHours(e){var{dayValues:t}=this.state,a=t[e],{hours:s}=a,i=[...s];i.pop(),this._updateDayValue(e,{hours:i})}_renderAdd(e){return n.createElement("div",{className:o.default.timeWrapper},n.createElement(c.default,{"aria-label":u.default.t(1),label:u.default.t(220),onClick:()=>{this._addHours(e)},prefixIcon:"status-ciphertext",iconTheme:"padded-svg"}))}_renderRemove(e){return n.createElement("div",{className:o.default.timeWrapper},n.createElement(f.default,{title:u.default.t(1200),"aria-label":u.default.t(1200),name:"x-alt",onClick:()=>{this._removeHours(e)}}))}_renderHours({dayKey:e,hours:t}){var a=[],s=t.length>=2?this._renderRemove(e):this._renderAdd(e);return t.forEach((([t,s],i)=>{i>0&&a.push(n.createElement("div",{className:o.default.hoursAnd},u.default.t(292))),a.push(this._renderTimeInput(e,t,E.START,i),this._renderTimeInput(e,s,E.END,i))})),n.createElement("div",{className:o.default.hoursMain},a,s)}_renderDayValues(e,t){var a,{closed:s}=e;return s?a=u.default.t(294):t===h.BUSINESS_HOUR_MODES.APPOINTMENT_ONLY?a=u.default.t(293):t===h.BUSINESS_HOUR_MODES.OPEN_24H&&(a=u.default.t(305)),a?n.createElement("div",{className:o.default.dayInfoText},a):h.BUSINESS_HOUR_MODES.SPECIFIC_HOURS&&!e.closed?this._renderHours(e):null}_renderDayInfo(e,t){var{dayName:a}=e,s=this._buildDayId(e);return n.createElement("div",{className:o.default.dayInfo},n.createElement("label",{htmlFor:s},a),this._renderDayValues(e,t))}_renderDay(e){var{mode:t}=this.state;return n.createElement("div",{key:`day-${e.dayKey}`,className:o.default.dayMain},this._renderCheckbox(e),this._renderDayInfo(e,t))}_renderBusinessHours(){var{businessHours:{days:e}}=this.props;return n.createElement("div",null,this._renderTabs(),n.createElement("div",{className:o.default.editMain},e.map((({dayKey:e})=>{var t=this.state.dayValues[e];return this._renderDay(t)}))))}render(){var e=this,t=this._renderBusinessHours(),{mode:a,dayValues:s}=this.state,{businessHours:{note:i,timezone:l}}=this.props;return n.createElement(p.default,{title:u.default.t(300),isValid:(0,g.isValidBusinessHours)(a,s),doSave:(0,r.default)((function*(){yield e.props.saveBusinessProfile((0,g.convertToRawBusinessProfile)({mode:a,dayValues:s,note:i,timezone:l}))})),afterSave:this.props.afterSave,onCancel:this.props.onCancel},t)}}t.default=S,S.displayName="BusinessHours"},41352:(e,t,a)=>{"use strict";var s=a(93291),i=a(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(a(52954)),l=i(a(70417)),n=i(a(72779)),o=s(a(2784)),d=a(83194),c=a(36953),u=i(a(97670)),h=i(a(93257)),p=i(a(53236)),f=i(a(13277)),m=i(a(85530)),v=i(a(36893)),g=i(a(14076)),E=i(a(38637)),_=i(a(11085)),C=i(a(61482)),S=i(a(68267)),y=s(a(97025));class I extends o.Component{constructor(...e){super(...e),this.state=(({initialCategories:e})=>({selectedCategories:e,searchText:"",isLoading:!1}))(this.props),this.flatListController=new g.default,this.setRefList=e=>{this.list=e},this.renderItem=e=>{var t=o.createElement(h.default,{id:`${e.id}`,onChange:()=>{!e.disabled&&this._toggleResultById(e.id)},checked:e.selected,disabled:e.disabled}),a=o.createElement("label",{className:(0,n.default)(u.default.rowLabel,{[u.default.disabled]:e.disabled}),htmlFor:e.id},e.localized_display_name);return this._renderRow(a,t)},this._removeById=e=>{var t=this.state.selectedCategories.filter((t=>t.id===e))[0];t&&this.toggle(t)},this._toggleResultById=e=>{var t,a=null===(t=this.state.results)||void 0===t?void 0:t.filter((t=>t.id===e))[0];a&&this.toggle(a)},this.toggle=e=>{var t,a=null===(t=this.state.results)||void 0===t?void 0:t.find((e=>e.not_a_biz)),s=this.state.selectedCategories.find((e=>e.id===(null==a?void 0:a.id))),i=this.state.selectedCategories;this.state.selectedCategories.length>0&&(e.not_a_biz&&!s?(i=[],this._showConflictWarning()):!e.not_a_biz&&s&&(i=this.state.selectedCategories.filter((e=>e.id!==s.id)),this._showConflictWarning())),this.isSelected(e.id)?this.setState({selectedCategories:i.filter((t=>t.id!==e.id))}):this.setState({selectedCategories:[...i,e]})},this.setSearchText=e=>{this._getResults(e)},this.onRemoveItem=e=>{this.setState({selectedCategories:this.state.selectedCategories.filter((t=>t.id!==e.id))})}}componentDidMount(){this._getResults("")}renderList(){if(this.state.isLoading)return o.createElement("div",{className:u.default.loadingSpinner},o.createElement(S.default,{color:"highlight",size:44,stroke:6}));if(!this.state.results||0===this.state.results.length)return this._renderRow(E.default.t(339),null);var e=this.state.results.map((e=>(0,l.default)((0,l.default)({},e),{},{id:e.id,itemKey:e.id.toString(),disabled:this.isDisabled(e),selected:this.isSelected(e.id)})));return o.createElement(v.default,{flatListControllers:[this.flatListController]},o.createElement(m.default,{ref:this.setRefList,data:e,flatListController:this.flatListController,direction:"vertical",renderItem:this.renderItem,defaultItemHeight:48}))}_renderRow(e,t){return o.createElement("div",{className:u.default.rowMain},o.createElement("div",{className:u.default.rowCheckbox},t),e)}_renderSearchBox(){return o.createElement(_.default,{onSearch:this.setSearchText,placeholder:E.default.t(341)})}_renderFooter(){return this.state&&this.state.selectedCategories?o.createElement(p.default,{categories:this.state.selectedCategories,onRemoveItem:this._removeById}):null}_showConflictWarning(){f.default.openToast(o.createElement(y.default,{id:(0,y.genId)(),msg:E.default.t(319)}))}isSelected(e){for(var{selectedCategories:t}=this.state,a=0;a<t.length;a++)if(t[a].id===e)return!0;return!1}isDisabled(e){return!e.not_a_biz&&!this.isSelected(e.id)&&this.state.selectedCategories.length>=c.MAX_BUSINESS_CATEGORIES}_getResults(e){this.setState({isLoading:!0}),this.props.searchCategories(e||d.BUSINESS_CATEGORY_EMPTY_STR_ID).then((t=>{var a=t.categories;""!==e&&(a=a.filter((e=>!e.not_a_biz))),this.setState({isLoading:!1,results:a})})).catch((()=>{f.default.openToast(o.createElement(y.default,{id:(0,y.genId)(),msg:E.default.t(318)})),this.setState({isLoading:!1,results:[]})}))}render(){var e,t=this;return this.state.selectedCategories.length&&(e=this._renderFooter()),o.createElement(C.default,{title:E.default.t(320),isValid:this.state.selectedCategories.length>0,doSave:(0,r.default)((function*(){yield t.props.saveBusinessProfile({categories:t.state.selectedCategories})})),afterSave:this.props.afterSave,onCancel:this.props.onCancel},o.createElement("div",{className:u.default.searchBackground},this._renderSearchBox()),o.createElement("div",{className:u.default.editMain},o.createElement("div",{className:u.default.list},this.renderList()),e))}}t.default=I,I.displayName="Categories"},40274:(e,t,a)=>{"use strict";var s=a(93291),i=a(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(a(58527)),l=s(a(2784)),n=i(a(20156)),o=i(a(5623)),d=a(19999),c=i(a(41352)),u=i(a(13277)),h=i(a(84340)),p=i(a(62894)),f=a(9690),m=i(a(19813)),v=i(a(38637)),g=a(3914),E=i(a(9528)),_=i(a(84161)),C=a(59612),S=a(54840),y=i(a(92915)),I=i(a(22006)),M=a(25041),{useState:P,useEffect:T}=l,L=256,b=512,N=128,D=256;t.default=({businessProfile:e,saveBusinessProfile:t,sessionId:a,verifiedName:s})=>{var[i,w]=P(),[O,k]=P(),[R,A]=P(),[x,F]=P(),[U,B]=P(),[G,H]=P(),[V,j]=P(),[W,K]=P(),[z,q]=P(),[Y,Z]=P(!1),[$,Q]=P();T((()=>{var t=(0,S.convertRawBusinessProfile)(e);w(t.description),A(t.email),k(t.address),F(t.primaryWebsite),B(t.secondaryWebsite),H(Boolean(t.primaryWebsite&&!t.secondaryWebsite))}),[e]),T((()=>{(0,M.validateEmail)(R)&&j(null)}),[R]),T((()=>{(0,M.validateURL)(x)&&K(null)}),[x]),T((()=>{(0,M.validateURL)(U)&&q(null)}),[U]);var X,J=()=>{var e=[];return x&&e.push(x),U&&e.push(U),{website:e.map(((e,t)=>{if(!I.default.isHttps(e)&&!I.default.isHttp(e)){var a=`https://${e}`;return 0===t?F(a):B(a),a}return e}))}},ee=e=>l.createElement(m.default,(0,r.default)({},e,{hideEditIcon:Boolean($)})),te=({setValue:s,value:i,fieldKey:n,fieldMetric:o,originalValue:d,textFieldConfig:c,formatForSave:u,validate:h,onError:p,error:f,lowProfile:m,placeholder:v,startActive:E})=>{var _=(null==$?void 0:$.fieldKey)===n,S=i?void 0:v;return l.createElement(y.default,(0,r.default)({value:i,editable:!$||_,pending:_&&(null==$?void 0:$.editType)===C.EditType.PENDING,showRemaining:!0,onBeginEdit:()=>{(0,g.logProfileFieldOpen)(o,e,a),Q({fieldKey:n,editType:C.EditType.EDITING})},onChange:s,onSave:()=>{(0,g.logProfileFieldSave)(o,e,a),Q({fieldKey:n,editType:C.EditType.PENDING}),t(u()).then((()=>{Q()}),(()=>{Q()}))},onCancel:()=>{(0,g.logProfileFieldDiscard)(o,e,a),s(d),Q()},lockable:!0,lowProfile:m,multiline:!0,inputPlaceholder:S,theme:"text-input",validate:h,onError:p,error:f,a8n:`biz-profile-${n}-input`,startActive:E},c))},ae=(0,S.convertRawBusinessProfile)(e),se=v.default.t(336),ie=void 0;return(0,f.canSeeBizProfileV3)()&&(se=null,ie=p.default.noPaddingTop),l.createElement(h.default,{title:se,theme:"refresh",className:ie},(e=>{if(!e)return null;var t=(0,f.canSeeBizProfileV3)()?"no-margin":void 0;return ee({theme:t,icon:"account-box",iconClass:p.default.verifiedNameIcon,content:l.createElement("div",null,l.createElement("div",null,e),l.createElement("div",{className:p.default.infoText},v.default.t(338)))})})(s),ee({icon:"business-description",content:te({value:i,setValue:w,originalValue:ae.description,fieldKey:"description",fieldMetric:_.default.BUSINESS_PROFILE_FIELD.DESCRIPTION,placeholder:v.default.t(328),textFieldConfig:{maxLength:b,supportsEmoji:!0},lowProfile:!0,formatForSave:()=>({description:i})})}),ee({icon:"business-category",type:"container",emptyText:v.default.t(327),content:(X=ae.categories,0===X.length?null:l.createElement("div",null,X.map((e=>e.localized_display_name)).join(v.default.t(586)))),onEdit:()=>{(0,g.logProfileFieldOpen)(_.default.BUSINESS_PROFILE_FIELD.CATEGORY,e,a),u.default.openModal(l.createElement(c.default,{initialCategories:ae.categories,saveBusinessProfile:t,searchCategories:e=>n.default.find(e),afterSave:()=>(0,g.logProfileFieldSave)(_.default.BUSINESS_PROFILE_FIELD.CATEGORY,e,a),onCancel:()=>{(0,g.logProfileFieldDiscard)(_.default.BUSINESS_PROFILE_FIELD.CATEGORY,e,a)}}))}}),ee({icon:"business-address",content:(e=>{var t,a=te({value:O,placeholder:v.default.t(325),setValue:k,originalValue:e.address,fieldKey:"address",fieldMetric:_.default.BUSINESS_PROFILE_FIELD.ADDRESS,textFieldConfig:{maxLength:D},lowProfile:!0,formatForSave:()=>({address:O})}),{latitude:s,longitude:i}=e;return null!=s&&null!=i&&(t=((e,t)=>{var a;return"address"===(null==$?void 0:$.fieldKey)&&(a=l.createElement("div",{className:p.default.mapOverlay},l.createElement("div",{className:p.default.overlayHint},v.default.t(331)))),l.createElement("div",{style:{height:96},className:p.default.businessMap},a,l.createElement(E.default,{lat:e,lng:t,name:O,width:312,height:96}))})(s,i)),l.createElement(l.Fragment,null,a,t)})(ae)}),ee({icon:"business-hours",type:"container",emptyText:v.default.t(326),content:(({mode:e,days:t})=>null==e?null:l.createElement("div",null,t.map((({dayName:t,dayKey:a,closed:s,hours:i})=>l.createElement("div",{key:a,className:p.default.businessHoursSection},l.createElement("div",{className:p.default.businessHoursDayColumn},t),l.createElement("div",{className:p.default.businessHoursTimeColumn},((e,t,a)=>{if(t)return v.default.t(294);switch(e){case d.BUSINESS_HOUR_MODES.SPECIFIC_HOURS:return l.createElement(l.Fragment,null,a&&a.map((([e,t],a)=>l.createElement("div",{key:a,className:p.default.businessHoursTime},e," - ",t))));case d.BUSINESS_HOUR_MODES.APPOINTMENT_ONLY:return v.default.t(293);case d.BUSINESS_HOUR_MODES.OPEN_24H:return v.default.t(305);default:return null}})(e,s,i)))))))(ae.hours),onEdit:()=>{(0,g.logProfileFieldOpen)(_.default.BUSINESS_PROFILE_FIELD.HOURS,e,a),u.default.openModal(l.createElement(o.default,{businessHours:ae.hours,saveBusinessProfile:t,onCancel:()=>{(0,g.logProfileFieldDiscard)(_.default.BUSINESS_PROFILE_FIELD.HOURS,e,a)},afterSave:()=>(0,g.logProfileFieldSave)(_.default.BUSINESS_PROFILE_FIELD.HOURS,e,a)}))}}),ee({icon:"business-email",content:te({value:R,placeholder:v.default.t(329),originalValue:ae.email,setValue:A,fieldKey:"email",fieldMetric:_.default.BUSINESS_PROFILE_FIELD.EMAIL,textFieldConfig:{maxLength:N},error:V,lowProfile:!1,formatForSave:()=>({email:R}),validate:e=>(0,M.validateEmail)(e),onError:()=>{j(v.default.t(652))}})}),(e=>{var t=te({value:x,placeholder:v.default.t(337),originalValue:e.primaryWebsite,setValue:F,fieldKey:"primaryWebsite",fieldMetric:_.default.BUSINESS_PROFILE_FIELD.WEBSITE,textFieldConfig:{maxLength:L},formatForSave:J,lowProfile:!1,validate:M.validateURL,onError:()=>{K(v.default.t(660))},error:W});return ee({icon:"business-website",theme:"small-margin",content:l.createElement("div",null,t)})})(ae),(e=>{if(!e.primaryWebsite)return null;if(U||!G){var t=te({placeholder:v.default.t(337),value:U,originalValue:e.secondaryWebsite,setValue:B,fieldKey:"secondaryWebsite",fieldMetric:_.default.BUSINESS_PROFILE_FIELD.WEBSITE,textFieldConfig:{maxLength:L},formatForSave:J,lowProfile:!1,validate:M.validateURL,onError:()=>{q(v.default.t(660))},error:z,startActive:Y});return ee({icon:"business-website",theme:"no-margin",content:l.createElement("div",null,t)})}var a=l.createElement("button",{className:p.default.addAnotherWebsite,onClick:()=>{H(!1),Z(!0)}},v.default.t(324));return ee({theme:"no-margin",content:l.createElement("div",null,a)})})(ae))}},94773:(e,t,a)=>{"use strict";var s=a(93291),i=a(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(a(52954)),l=s(a(2784)),n=i(a(65017)),o=a(25668),d=i(a(36171)),c=i(a(79435)),u=i(a(84340)),h=i(a(40274)),p=i(a(3151)),f=a(66368),m=a(66239),v=i(a(38637)),g=a(3914),E=a(59612),_=i(a(68267)),C=a(80781),{useState:S,useEffect:y}=l,I=function(){var e=(0,r.default)((function*(){var e=(0,m.getMeUser)(),t=n.default.get(e);return t&&t.markStale(),(yield n.default.find(e)).serialize()}));return function(){return e.apply(this,arguments)}}(),M=function(){var e=(0,r.default)((function*(){var e=(0,m.getMeUser)(),t=yield n.default.update(e);return(Array.isArray(t)?t[0]:t).serialize()}));return function(){return e.apply(this,arguments)}}();function P(){var[e,t]=S(E.LoadType.PENDING),[a,s]=S(),i=l.useRef(Math.floor(2147483648*Math.random()).toString()),n=function(){var e=(0,r.default)((function*(){t(E.LoadType.PENDING);try{var e=yield I();s(e),t(E.LoadType.DONE),(0,g.logProfileOpen)(e,i.current)}catch(e){t(E.LoadType.ERROR)}}));return function(){return e.apply(this,arguments)}}();return y((()=>{n()}),[]),e===E.LoadType.PENDING?l.createElement("div",{className:p.default.loadingSpinner},l.createElement(_.default,{color:"default",size:24,stroke:6})):e===E.LoadType.ERROR?l.createElement(u.default,{title:v.default.t(336),theme:"refresh"},l.createElement(f.FlexRow,{align:"center",justify:"center"},l.createElement(f.FlexItem,null,v.default.t(334)),l.createElement(f.FlexItem,{className:p.default.retryButton},l.createElement(d.default,{onClick:()=>{n()},type:"simplified"},v.default.t(1230))))):e===E.LoadType.DONE&&a?l.createElement(h.default,{verifiedName:c.default.pushname||void 0,sessionId:i.current,businessProfile:a,saveBusinessProfile:function(){var e=(0,r.default)((function*(e){try{yield(0,o.editBusinessProfile)(e)}catch(e){throw(0,C.showError)(v.default.t(335)),__LOG__(3,void 0,void 0,!0)`business_profile:edit_form save failed`,SEND_LOGS(`businessProfile edit handled server error - ${e.status}`),e}try{var t=yield M();return s(t),t}catch(e){throw(0,C.showError)(v.default.t(334)),e}}));return function(){return e.apply(this,arguments)}}()}):null}P.displayName="BusinessProfileEdit";var T=P;t.default=T},3914:(e,t,a)=>{"use strict";var s=a(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.getProfilePopulatedFields=l,t.logProfileOpen=function(e,t){var a=new r.default.EditBusinessProfile((0,i.default)({editProfileAction:r.default.EDIT_PROFILE_ACTION.ACTION_OPEN,businessProfileEntryPoint:r.default.BUSINESS_PROFILE_ENTRY_POINT.SETTINGS,editBusinessProfileSessionId:t},l(e)));a&&a.commit()},t.logProfileFieldOpen=function(e,t,a){var s=new r.default.EditBusinessProfile((0,i.default)({editProfileAction:r.default.EDIT_PROFILE_ACTION.ACTION_PROFILE_FIELD_OPEN,businessProfileEntryPoint:r.default.BUSINESS_PROFILE_ENTRY_POINT.SETTINGS,editProfileActionField:e,editBusinessProfileSessionId:a},l(t)));s&&s.commit()},t.logProfileFieldSave=function(e,t,a){var s=new r.default.EditBusinessProfile((0,i.default)({editProfileAction:r.default.EDIT_PROFILE_ACTION.ACTION_PROFILE_FIELD_SAVE,businessProfileEntryPoint:r.default.BUSINESS_PROFILE_ENTRY_POINT.SETTINGS,editProfileActionField:e,editBusinessProfileSessionId:a},l(t)));s&&s.commit()},t.logProfileFieldDiscard=function(e,t,a){var s=new r.default.EditBusinessProfile((0,i.default)({editProfileAction:r.default.EDIT_PROFILE_ACTION.ACTION_PROFILE_FIELD_DISCARD,businessProfileEntryPoint:r.default.BUSINESS_PROFILE_ENTRY_POINT.SETTINGS,editProfileActionField:e,editBusinessProfileSessionId:a},l(t)));s&&s.commit()};var i=s(a(70417)),r=s(a(84161));function l(e){var t;return{hasDescription:null!=e.description,hasCategory:!!(e.categories&&e.categories.length>0),hasHours:null!=(null===(t=e.businessHours)||void 0===t?void 0:t.config),hasEmail:null!=e.email,hasAddress:null!=e.address,hasWebsite:null!=e.website}}},54840:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.convertRawBusinessProfile=void 0;var s=a(16123);t.convertRawBusinessProfile=e=>{var{description:t,email:a,address:i,website:r,categories:l,businessHours:n,latitude:o,longitude:d}=e,[c,u]=r||[];return{description:t,email:a,address:i,primaryWebsite:c,secondaryWebsite:u,hours:(0,s.getBusinessHoursForEdit)(n),categories:l||[],latitude:o,longitude:d}}},80781:(e,t,a)=>{"use strict";var s=a(14859),i=a(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.showError=void 0;var r=i(a(2784)),l=s(a(13277)),n=i(a(97025));t.showError=e=>{l.default.openToast(r.createElement(n.default,{msg:e,duration:6e3,id:(0,n.genId)()}))}},19813:(e,t,a)=>{"use strict";var s=a(93291),i=a(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(a(72779)),l=s(a(2784)),n=i(a(22154)),o=i(a(38637)),d=i(a(48282)),c=i(a(18779));t.default=({icon:e,iconClass:t,content:a,onEdit:s,type:i="field",emptyText:u,hideEditIcon:h,theme:p})=>{var f=s?l.createElement("div",{className:(0,r.default)(n.default.sectionEditIcon,{[n.default.hidden]:h})},l.createElement(d.default,{"aria-label":o.default.t(569),name:"pencil",className:n.default.editPencil,directional:!0,title:o.default.t(569),onClick:()=>{s()}})):void 0,m=u&&!a,v=m?u:a,g=e?l.createElement(c.default,{name:e}):null;return l.createElement("div",{className:(0,r.default)(n.default.section,{[n.default.smallMargin]:"small-margin"===p,[n.default.noMargin]:"no-margin"===p})},l.createElement("div",{className:(0,r.default)(n.default.sectionPrimaryIcon,t,{[n.default.fieldPrimaryIcon]:"field"===i})},g),l.createElement("div",{className:(0,r.default)(n.default.sectionMain,{[n.default.sectionContainerMain]:"container"===i,[n.default.sectionEmptyText]:m})},v),f)}},39348:(e,t,a)=>{"use strict";var s=a(93291),i=a(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.CartDetailDrawer=void 0;var r=i(a(52954)),l=a(19129),n=s(a(2784)),o=i(a(65017)),d=a(64001),c=i(a(36171)),u=a(79930),h=i(a(59544)),p=i(a(65829)),f=i(a(58592)),m=i(a(13277)),v=i(a(76176)),g=i(a(23045)),E=s(a(18528)),_=i(a(3123)),C=i(a(96881)),S=i(a(84755)),y=s(a(32597)),I=s(a(24461)),M=i(a(14076)),P=i(a(13663)),T=i(a(38637)),L=i(a(4739)),b=a(84347),N=a(84982),D=i(a(9962)),w=a(55439),O=i(a(85185)),k=i(a(19432)),R=i(a(18779)),A=a(74315),x=i(a(82838));class F extends n.Component{constructor(e){var t;super(e),t=this,this._cartFlatListController=new M.default,this.updateData=function(){var e=(0,r.default)((function*(e){var[a,s]=yield Promise.all([e?(0,u.pullCartUpdate)(t.state.cart):Promise.resolve(),o.default.find(t.props.chat.id)]);a&&(t.refreshedCart=a);var i=(0,u.matchCartItemsToProducts)(t.state.cart,t.refreshedCart);t.setState({businessProfile:s,cartProductItems:i,isLoading:!1})}));return function(){return e.apply(this,arguments)}}(),this.onSend=()=>{var{cart:e}=this.state;this.setState({isLoading:!0}),(0,u.submitOrder)(e,this.props.chat).then((t=>{var a=Boolean(e.message);(0,b.logSendOrderMessage)({orderId:t,catalogOwnerJid:e.id,catalogContext:(0,w.getProductCatalogContext)(this.context),isOrderMsgAttached:a,quantity:e.itemCount}),this.props.onBack(),(0,u.clearCart)(e),e.message=void 0,this.props.closeDrawerRightOnSend&&this._closeDrawerRight()})).catch((()=>{__LOG__(4,!0,new Error,!0)`Unable to create catalog order`,SEND_LOGS("submitOrder: order creation or order message send error"),(0,u.showGenericErrorToast)(),this.updateData(!0)})).finally((()=>{this.setState({isLoading:!1})}))},this.onChange=e=>{var{cart:t}=this.state;this.setState({cartMessage:e},(()=>{(0,u.updateCartMessage)(t,e)}))},this._setRefMessageInput=e=>{this._refMessageInput=e},this.onMaxPasteExceeded=()=>{m.default.openModal(n.createElement(v.default,{title:T.default.t(368),onOK:()=>{m.default.closeModal()},okText:T.default.t(1738)},T.default.t(367)))},this.updateDataQueue=new l.PromiseQueue;var a=h.default.findCart(this.props.sellerJid);this.state={isLoading:!0,businessProfile:void 0,cartProductItems:[],cartMessage:a.message,cart:a}}_closeDrawerRight(){m.default.existsDrawerRight((e=>{e&&m.default.closeDrawerRight()}))}componentDidMount(){var{cart:e}=this.state,{listeners:t,rejectOnUnmount:a}=this.props;t.add(e,"change:cartItemCollection",(()=>{this.updateDataQueue.enqueue((()=>this.updateData()))})),this.updateData(!0).checkpoint(a()).then((()=>{(0,N.logCartListImpression)(e.id.toString(),(0,w.getProductCatalogContext)(this.context))})).catchType(I.Unmount,(()=>{})).catch((()=>{__LOG__(4,!0,new Error,!0)`Unable to open the cart`,SEND_LOGS("openCart: failed to open the cart"),(0,u.showGenericErrorToast)(),(0,u.clearCart)(e)})).finally((()=>{this.setState({isLoading:!1})}))}_emptyCartContent(){return n.createElement("div",{className:p.default.emptyCartContainer},n.createElement(R.default,{name:"shopping-cart-empty"}),n.createElement(A.TextDiv,{className:p.default.emptyCardHeader,theme:"large"},T.default.t(360)),n.createElement(A.TextDiv,{className:p.default.emptyCardText,theme:"plain"},T.default.t(361)),(0,d.hasCatalog)(this.state.businessProfile)&&n.createElement(c.default,{onClick:this.props.onProductCatalog,type:"primary"},T.default.t(1163)))}_getDrawerContent(){var{chat:e,sellerJid:t}=this.props,{cart:a}=this.state;if(this.state.isLoading)return n.createElement(P.default,null);var s,i,r=a.itemCount,l=r>0;if(l){var o=T.default.t(833,{count:r,_plural:r});s=n.createElement(A.TextDiv,{theme:"title"},o)}null!=a.total&&null!=a.currency?i=n.createElement(A.TextDiv,{theme:"muted-small"},T.default.t(1130,{subtotal:E.format(a.currency,a.total)})):r>0&&(i=n.createElement(A.TextDiv,{theme:"muted-small"},T.default.t(1126)));var d=n.createElement(x.default,{transitionName:"media-caption",className:p.default.cartMessage},n.createElement(D.default,{ref:this._setRefMessageInput,chat:e,maxLength:g.default.MAX_CART_MESSAGE_LENGTH,multiline:!0,onEnter:this.onSend,onChange:this.onChange,onMaxPasteExceeded:this.onMaxPasteExceeded,placeholder:T.default.t(366),showRemaining:!0,spellCheck:!0,supportsEmoji:!0,value:this.state.cartMessage})),c=n.createElement("button",{className:p.default.btnSend,tabIndex:"-1",onClick:this.onSend,title:T.default.t(371)},n.createElement(k.default,{large:!0},n.createElement(R.default,{name:"send",directional:!0})));return n.createElement(n.Fragment,null,!l&&this._emptyCartContent(),n.createElement("div",{className:p.default.info},s,i),n.createElement(f.default,{flatListController:this._cartFlatListController,onProductDetail:this.props.onProductDetail,cart:a,sellerJid:t,cartProductItems:this.state.cartProductItems}),l&&n.createElement("div",{className:p.default.footer},d,n.createElement(x.default,{transitionAppear:!0,transitionName:"btn"},c)))}render(){var{onBack:e}=this.props;return n.createElement(_.default,{onDrop:e,theme:"striped"},n.createElement(y.default,{title:T.default.t(359),type:y.DRAWER_HEADER_TYPE.SMALL,onBack:e}),n.createElement(C.default,{flatListControllers:[this._cartFlatListController]},this._getDrawerContent()))}}t.CartDetailDrawer=F,F.contextType=S.default,F.displayName="CartDetailDrawer";var U=(0,O.default)((0,L.default)(F));t.default=U},58592:(e,t,a)=>{"use strict";var s=a(93291),i=a(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(a(74930)),l=s(a(2784)),n=i(a(76994)),o=i(a(23045)),d=i(a(85530)),c=i(a(36893));class u extends l.PureComponent{constructor(...e){super(...e),this.getData=()=>this.props.cartProductItems.map((e=>({itemKey:e.cartItem.id,contentKey:(0,r.default)("cartItem"),product:e.product,cartItem:e.cartItem}))),this.renderItem=e=>{var{onProductDetail:t,sellerJid:a}=this.props,s={productId:e.cartItem.id,businessOwnerJid:a};return l.createElement(n.default,{cartId:a,product:e.product,quantity:e.cartItem.quantity,onClick:()=>t(s)})}}render(){return l.createElement(c.default,{flatListControllers:[this.props.flatListController]},l.createElement(d.default,{flatListController:this.props.flatListController,direction:"vertical",forceConsistentRenderCount:!1,data:this.getData(),renderItem:this.renderItem,defaultItemHeight:o.default.PRODUCT_LIST_ITEM_HEIGHT}))}}t.default=u,u.displayName="CartProductList"},76994:(e,t,a)=>{"use strict";var s=a(14859),i=a(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=E;var r=i(a(2784)),l=a(79930),n=s(a(8641)),o=s(a(27421)),d=s(a(78523)),c=s(a(53602)),u=s(a(84755)),h=s(a(30905)),p=s(a(38637)),f=a(84982),m=a(55439),v=s(a(22935)),g=s(a(91100));function E(e){var t,a,{product:s,onClick:i}=e,E=r.createElement(h.default,{text:s.name,ellipsify:!0,titlify:!0}),_=null===(t=s.getPreviewImage())||void 0===t?void 0:t.mediaData;function C(){return r.createElement(u.default.Consumer,null,(t=>r.createElement("div",{className:n.default.actions},r.createElement(o.default,{quantity:e.quantity,onChange:a=>function(t,a){var{cartId:s,product:i}=e;(0,l.updateProductQuantity)(s,i,t),(0,f.logEditProduct)(i,a,t)}(a,(0,m.getProductCatalogContext)(t))}),r.createElement("div",{className:n.default.deleteIcon},r.createElement(c.default,{onClick:a=>function(t,a){var{cartId:s,product:i}=e,r=(0,l.deleteProductFromCart)(s,i.id.toString());(0,l.deleteProductFromCart)(s,i.id.toString()),(0,f.logDeleteProduct)(i,a),0===r&&(0,f.logCartAbandon)(i.catalogWid.toString(),a),function(e){e.preventDefault(),e.stopPropagation()}(t)}(a,(0,m.getProductCatalogContext)(t))})))))}a=_?r.createElement(g.default,{theme:"list",mediaData:_}):r.createElement(r.Fragment,null),C.displayName="_renderDetail";var S=r.createElement(v.default,{className:n.default.price,product:s,fallback:p.default.t(362)});return r.createElement(d.default,{key:s.id.toString(),image:a,customImage:!0,primary:E,secondary:S,theme:"cart-product",onClick:i,detail:C(),className:n.default.cartListItem})}E.displayName="CartProductListItem"},27421:(e,t,a)=>{"use strict";var s=a(14859),i=a(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=o;var r=i(a(2784)),l=a(45537),n=s(a(31720));function o(e){function t(){for(var e=[],t=1;t<=l.MAX_QUANTITY;t++)e.push(r.createElement("option",{key:t,value:t},t));return e}return t.displayName="_renderOptions",r.createElement("div",{className:n.default.select},r.createElement("select",{onClick:function(e){e.preventDefault(),e.stopPropagation()},value:e.quantity,onChange:function(t){var a=t.target;a instanceof HTMLSelectElement&&e.onChange(parseInt(a.value,10))}},t()))}o.displayName="CartProductQuantity"},53602:(e,t,a)=>{"use strict";var s=a(14859),i=a(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=d;var r=i(a(2784)),l=s(a(45356)),n=s(a(38637)),o=s(a(48282));function d(e){return r.createElement(o.default,{"aria-label":n.default.t(1174),name:"delete",title:n.default.t(1174),className:l.default.deleteIcon,onClick:e.onClick})}d.displayName="DeleteIcon"},11277:(e,t,a)=>{"use strict";var s=a(14859),i=a(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(a(2784)),l=s(a(32944)),n=s(a(78523)),o=s(a(99461)),d=s(a(39287));t.default=({title:e,icon:t,t:a})=>{var s=null!=a?o.default.relativeDateAndTimeStr(a):"-",i=r.createElement("div",{className:d.default.title,"data-a8n":l.default.key("msg-info-title")},t,e);return r.createElement(n.default,{primary:i,secondary:s,theme:"plain",idle:!0})}},66286:(e,t,a)=>{"use strict";var s=a(14859),i=a(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(a(2784)),l=s(a(87962)),n=s(a(99461)),o=s(a(51045)),d=s(a(30905)),c=s(a(90720)),u=s(a(90370));class h extends r.PureComponent{render(){var e,{contact:t,msgInfoParticipant:a}=this.props,s=r.createElement(o.default,{id:t.id}),i=n.default.relativeDateAndTimeStr(a.t),u=r.createElement("span",{title:i},i);return!t.name&&t.notifyName&&(e=r.createElement(d.default,{className:c.default.notifyName,direction:"auto",text:t.notifyName})),r.createElement(l.default,{contextEnabled:()=>!1,image:s,primary:r.createElement(d.default,{direction:"auto",text:t.formattedName,titlify:!0,ellipsify:!0}),secondary:u,secondaryDetail:e,style:{cursor:"auto"},theme:"drawer-list",idle:!0})}}h.CONCERNS={msgInfoParticipant:["t"],contact:["id","name","formattedName","notifyName"]},h.displayName="GroupMsgInfoCell";var p=(0,u.default)(h,h.CONCERNS);t.default=p},69650:(e,t,a)=>{"use strict";var s=a(14859),i=a(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(a(2784)),l=s(a(38637)),n=s(a(85686)),o=s(a(90370)),d=s(a(18779)),c=a(74315);class u extends r.PureComponent{render(){var{numTimesForwarded:e,isFrequentlyForwarded:t}=this.props.msg;if(e<=0||t)return null;var a=r.createElement(d.default,{name:"forwarded",display:"inline",className:n.default.icon}),s=l.default.t(683,{count:e,_plural:e});return r.createElement("div",{className:n.default.title},a,r.createElement(c.TextSpan,{theme:"title",className:n.default.text},s))}}u.CONCERNS={msg:["numTimesForwarded","isFrequentlyForwarded"]},u.displayName="MsgInfoForwardCount";var h=(0,o.default)(u,u.CONCERNS);t.default=h},74311:(e,t,a)=>{"use strict";var s=a(14859),i=a(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(a(2784)),l=s(a(92515)),n=i(a(40953)),o=s(a(85030)),d=s(a(23045)),c=i(a(10453)),u=s(a(3941)),h=i(a(85530)),p=s(a(19058)),f=s(a(38637)),m=s(a(87653)),v=s(a(99979));class g extends r.PureComponent{constructor(...e){super(...e),this.selection=new v.default([],(e=>e.id.toString())),this._getSelectionList=()=>{var{contacts:e,frequentContacts:t}=this.props,a=[],s=[];return e.forEach((e=>{if(e.isGroup){var t=o.default.get(e.id);t&&s.push(t)}else a.push(e)})),(t||[]).concat(a).concat(s)},this.onFocusGain=e=>{e.target===this.refList&&(this.selection.index<0?this.focusFirst():this.selection.reset(!0))},this.focusFirst=()=>{this.selection.setFirst(!0)},this._onNextContact=e=>{e.preventDefault(),e.stopPropagation(),this.selection.setNext(!0)},this._onPrevContact=e=>{e.preventDefault(),e.stopPropagation(),this.selection.prev()>-1?this.selection.setPrev(!0):(this.selection.unset(),this.props.onFocusSearch(e))},this.setRefHotKeys=e=>{this.refList=e},this._renderContact=(e,t)=>{var a;return e.isBlocked()&&(a=f.default.t(503)),r.createElement(c.default,{active:this.selection,contact:e,onClick:this.props.onClick,secondary:a,frequent:t,waitIdle:!0})},this.renderItem=e=>{switch(e.type){case 0:return r.createElement(m.default,{key:"frequent-contacts-header",header:f.default.t(1615)});case 3:var{data:t,frequent:a}=e;return this._renderChat(t,a);case 2:var{data:s,frequent:i}=e;return this._renderContact(s,i);case 1:var{data:n,separator:o}=e;return r.createElement("div",{className:u.default.header},o?r.createElement(l.default,{key:`separator-${n}`}):null,r.createElement(m.default,{header:n}));default:throw new h.UnknownDataError(e)}}}_renderChat(e,t){return r.createElement(n.default,{active:this.selection,chat:e,mode:n.Mode.INFO,noContext:!0,onClick:this.props.onClick,frequent:t})}_getFrequentContactsData(e){var t=[];return e.forEach((e=>{var a=this._getContactDataItem(e,!0);a&&t.push(a)})),t}_getContactDataItem(e,t){var a=(t?c.FREQUENT_PREFIX:"")+e.id.toString();if(e.isGroup){var s=o.default.get(e.id);return s?{itemKey:a,data:s,type:3,frequent:t}:null}return{itemKey:a,data:e,type:2,frequent:t}}getData(){var{frequentContacts:e}=this.props,t=[],a=[],s=[];e&&e.length&&(t.push({itemKey:"frequent-contacts-header",type:0}),t.push(...this._getFrequentContactsData(e))),this.props.contacts.forEach((e=>{e.isGroup?s.push(e):a.push(e)}));var i=this._getDataFromContacts(a),r=this._getDataFromContacts(s);if(this.props.showPersonGroupDivisionHeader&&i.length>0){var l=f.default.t(1586);t.push({itemKey:`header-${l}`,data:l,separator:!0,type:1})}if(t.push(...i),this.props.showPersonGroupDivisionHeader&&r.length>0){var n=f.default.t(1693);t.push({itemKey:`header-${n}`,data:n,separator:!0,type:1})}return t.push(...r),t}_getDataFromContacts(e){if(0===e.length)return[];for(var t=e[0].isGroup?"group":"contact",a=[],s=e.length>10,i="XXX",r=0;r<e.length;r++){var l=e[r];if(s&&l.header){var n=l.header;if(n!==i){var o=r<e.length-1&&n!==e[r+1].header;a.push({itemKey:`header-${t}-${n}`,data:n,separator:o,type:1}),i=n}}var d=this._getContactDataItem(l);d&&a.push(d)}return a}render(){this.selection.init(this._getSelectionList());var e={down:this._onNextContact,up:this._onPrevContact};return r.createElement(p.default,{onRef:this.setRefHotKeys,handlers:e,onFocus:this.onFocusGain,"data-tab":d.default.TAB_ORDERS.CHAT_CONTACT_LIST},r.createElement(h.default,{data:this.getData(),renderItem:this.renderItem,flatListController:this.props.flatListController,direction:"vertical"}))}}t.default=g,g.displayName="ContactList"},56322:(e,t,a)=>{"use strict";var s=a(93291),i=a(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(a(16760)),l=s(a(2784)),n=s(a(10453)),o=i(a(19058)),d=i(a(38637)),c=i(a(99979));class u extends l.PureComponent{constructor(e){super(e),this.focusLast=()=>{this.props.contacts&&this.props.contacts.length&&this.selection.setLast(!0)},this._focusPrev=e=>{e.preventDefault(),e.stopPropagation(),this.selection.prev()>-1&&this.selection.setPrev(!0)},this._focusNext=e=>{e.preventDefault(),e.stopPropagation();var{onFocusSearch:t}=this.props,a=this.selection.next();this.selection.index===a?(this.selection.unset(),t&&t(e)):this.selection.setNext(!0)},this._deleteContact=e=>{e.preventDefault(),e.stopPropagation();var{onDelete:t}=this.props,a=this.selection.getVal();if(a){var s=this.props.contacts.find(a);s&&t&&t(e,s)}},this.onParticipantClick=(e,t)=>{this.selection.setVal(t)},this.selection=new c.default(e.contacts,(e=>e.id))}componentDidUpdate(){this.selection.init(this.props.contacts,!0)}render(){var e=this.props.contacts;if(!e)return null;var t=e.length?(0,r.default)(e,(e=>l.createElement(n.default,{contact:e,active:this.selection,onDelete:this.props.onDelete,onClick:this.onParticipantClick,type:n.Type.SMALL,key:e.id.toString(),theme:this.props.theme,waitIdle:!0}))):null,a={up:this._focusPrev,down:this._focusNext};this.props.onDelete&&(a[d.default.LR("left","right")]=this._focusPrev,a[d.default.LR("right","left")]=this._focusNext,a.backspace=this._deleteContact);var s=l.createElement("ul",null,t);return l.createElement(o.default,{handlers:a},s)}}t.default=u,u.displayName="ParticipantList"},91710:(e,t,a)=>{"use strict";var s=a(93291),i=a(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=d;var r=i(a(72779)),l=s(a(2784)),n=i(a(20189)),o=s(a(51045));function d(e){var{ids:t,size:a,onClick:s,showCount:i,square:d,border:c}=e,u=t.length;if(0===u)return null;if(1===u)return l.createElement(o.default,{id:t[0],size:40,onClick:s,border:c});var h=t.slice(0,4).map(((e,t)=>l.createElement("div",{key:`avatar-combo-image-${t}`,className:(0,r.default)(n.default.avatar,{[n.default.first]:0===t,[n.default.second]:1===t,[n.default.third]:2===t,[n.default.fourth]:3===t})},l.createElement(o.default,{id:e,size:a,square:!0})))),p=(0,r.default)(n.default.container,{[n.default.square]:d,[n.default.border]:c},{[n.default.two]:2===u,[n.default.three]:3===u,[n.default.four]:u>=4}),f=(0,o.getSize)(a),m={height:f,width:f,cursor:s?"pointer":void 0},v=i?l.createElement("div",{className:n.default.count,style:m},t.length):null;return l.createElement("div",{className:p,style:m,onClick:s},h,v)}d.displayName="AvatarCombo"},75956:(e,t,a)=>{"use strict";var s=a(14859),i=a(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(a(2784)),l=s(a(32944)),n=s(a(92098));class o extends r.Component{render(){return r.createElement("div",{className:n.default.overlay,key:"avatar-overlay"},r.createElement("div",{className:n.default.icon},this.props.icon),r.createElement("div",{"data-a8n":l.default.key("avatar-text"),className:n.default.text},this.props.text))}}t.default=o,o.displayName="AvatarOverlay"},27018:(e,t,a)=>{"use strict";var s=a(93291),i=a(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=c;var r=i(a(72779)),l=s(a(2784)),n=i(a(66262)),o=i(a(18779)),d=i(a(78126));function c(e){var{onClick:t,className:a,label:s,prefixIcon:i,postfixIcon:c}=e,u=(0,r.default)(n.default.icon,{[n.default.paddedIcon]:"padded-svg"===e.iconTheme});return l.createElement(d.default,{className:(0,r.default)(a,n.default.container,{[n.default.hasPrefixIcon]:null!=i,[n.default.hasPostfixIcon]:null!=c}),onClick:t,"aria-label":e["aria-label"]},i&&l.createElement(o.default,{name:i,className:(0,r.default)(u,n.default.prefixIcon)}),l.createElement("div",{className:n.default.content},s),c&&l.createElement(o.default,{name:c,className:u}))}c.displayName="ChipButton"},42394:(e,t,a)=>{"use strict";var s=a(14859),i=a(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=d;var r=i(a(2784)),l=s(a(68097)),n=s(a(78046)),o=s(a(78126));function d({children:e,download:t,file:a,extension:s}){return r.createElement(o.default,{className:l.default.download_button,onClick:()=>{null!=a&&n.default.downloadData(a,t,s)}},e)}d.displayName="DownloadableLink"},39277:(e,t,a)=>{"use strict";var s=a(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a){var s=(0,r.useRef)(e);s.current=e;var l=(0,r.useMemo)((()=>(0,i.default)(((...e)=>s.current(...e)),t,a)),[t,a]);return(0,r.useEffect)((()=>l.cancel),[]),l};var i=s(a(54073)),r=a(2784)},23699:(e,t,a)=>{"use strict";var s=a(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t=0,a){var{immediate:s=!1}=null!=a?a:{},r=i.useRef(e);r.current=e;var l=i.useRef(),n=i.useCallback((()=>{l.current&&clearTimeout(l.current)}),[]),o=i.useCallback((()=>{n(),l.current=setTimeout((()=>r.current()),t)}),[n,t]);return i.useEffect((()=>(s&&o(),n)),[s,o,n]),[o,n]};var i=s(a(2784))},93517:(e,t,a)=>{"use strict";var s=a(93291),i=a(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(a(16760)),l=i(a(72779)),n=s(a(2784)),o=i(a(23045)),d=a(41863),c=i(a(5338)),u=i(a(18792)),h=i(a(19058)),p=i(a(39116)),f=i(a(38637)),m=i(a(21830)),v=i(a(89868)),g=i(a(99979)),E=i(a(68267)),_=i(a(75632)),C=i(a(78126));class S extends n.PureComponent{constructor(...e){super(...e),this.state={},this._setRefBody=e=>{this._refBody=e},this._refImages=new Map,this.setRefImage=(e,t)=>{t?this._refImages.set(e,t):this._refImages.delete(e)},this._setImageRefCache=new v.default(this.setRefImage),this.selection=new g.default(this.props.thumbnails,(e=>e.id)),this._handleHotKeysRef=e=>{this._refHotKeys=e},this.handleMouseDown=e=>{e.preventDefault(),e.stopPropagation()},this.handleClick=e=>{var t=e.target;this.props.onImageClick&&1===t.nodeType&&"IMG"===t.tagName&&this.props.onImageClick(t.src)},this.handleEnter=()=>{var e=this.selection.getVal();e||(__LOG__(4,void 0,new Error,!0)`Assertion failed!`,SEND_LOGS("No value selected, but enter clicked")),this.props.onImageClick&&e&&this.props.onImageClick(e.thumbUrl)},this._requestMoreImagesIfNeeded=()=>{if(!this.props.isLoadingMore&&this.props.canLoadMore&&this.props.onRequestMoreImages){if(!this._refBody)throw new Error("Requesting more images when body not rendered");this._refBody.scrollTop+o.default.SCROLL_FUDGE>this._refBody.scrollHeight-this._refBody.clientHeight&&this.props.onRequestMoreImages()}},this.handleScroll=this.props.throttle(this._requestMoreImagesIfNeeded,100),this._selectPrev=e=>{e.preventDefault(),e.stopPropagation(),this.selection.setPrev(!1),this._updateSelected(!0,!0)},this.selectNext=e=>{e.preventDefault(),e.stopPropagation(),this.selection.setNext(!1),this._updateSelected(!0,!0)},this._selectPrevRow=e=>{if(e.preventDefault(),e.stopPropagation(),0===this.selection.index&&this.props.onFocusPrev)this.props.onFocusPrev();else{var t=Math.max(this.selection.index-3,0);this.selection.set(t,!1,!1),this._updateSelected(!0,!0)}},this._selectNextRow=e=>{e.preventDefault(),e.stopPropagation(),this.selection.set(this.selection.index+3,!1,!1),this._updateSelected(!0,!0)},this._handleFocus=e=>{e.stopPropagation(),e.preventDefault(),(null==this.selection.index||this.selection.index<0)&&this.selection.setFirst(!1),this._updateSelected(!0,!1);var t=(0,m.default)(this._refImages.get(`${this.selection.index}`),"this._refImages.get(`${this.selection.index}`)").getElementsByClassName(p.default.imageGalleryItemOverlay);if(1!==t.length)throw new Error(`Unexpected number of overlay elements ${t.length}`);c.default.maybeIndicateFocus(t[0],p.default.focusAnimation)},this.handleRequestDismiss=()=>{this.selection.unset(),this.setState({selectedImage:void 0})}}componentDidMount(){this._updateSelected()}componentDidUpdate(){this._requestMoreImagesIfNeeded(),this.selection.init(this.props.thumbnails,!1),this._updateSelected()}focus(){this._refHotKeys&&this._refHotKeys.focus()}_updateSelected(e=!1,t=!1){var a=this.selection.getVal();if(a&&this.state.selectedImage!==a&&(this.setState({selectedImage:a}),this.selection.index>-1)){var s=this._refImages.get(`${this.selection.index}`);u.default.focus(s),t&&s&&(0,d.scrollIntoViewIfNeeded)(s,!1)}}render(){var e={down:this._selectNextRow,enter:this.handleEnter,left:this._selectPrev,right:this.selectNext,up:this._selectPrevRow},t=(0,r.default)(this.props.thumbnails,(({id:e,name:t,thumbUrl:a},s)=>{var i=!!this.state.selectedImage&&this.state.selectedImage.id===e,r=(0,l.default)(p.default.imageGalleryItem,{[p.default.selected]:i}),o=n.createElement("div",{className:p.default.imageGalleryItemOverlay});return n.createElement("div",{key:e,ref:this._setImageRefCache.getRefSetter(`${s}`),className:r,tabIndex:-1},o,n.createElement(C.default,{onClick:this.handleClick},n.createElement("img",{alt:f.default.t(28,{name:t}),className:p.default.imageGalleryItemImage,src:a})))})),a=this.props.isLoadingMore?n.createElement("div",{tabIndex:-1,className:p.default.imageGalleryFooter},n.createElement(E.default,{stroke:6,size:24})):null;return n.createElement(h.default,{className:p.default.imageGallery,"data-tab":o.default.TAB_ORDERS.CHAT_IMAGE_GALLERY,handlers:e,onFocus:this._handleFocus,onMouseDown:this.handleMouseDown,onRef:this._handleHotKeysRef},n.createElement("div",{ref:this._setRefBody,className:p.default.imageGalleryList,onScroll:this.handleScroll},t,n.createElement("div",{tabIndex:-1,className:p.default.imageGalleryItemSpacer}),n.createElement("div",{tabIndex:-1,className:p.default.imageGalleryItemSpacer}),n.createElement("div",{tabIndex:-1,className:p.default.imageGalleryItemSpacer}),a))}}S.defaultProps={thumbnails:[]},S.displayName="ImageGallery";var y=(0,_.default)(S);t.default=class extends y{focus(){this.getComponent().focus()}}},9962:(e,t,a)=>{"use strict";var s=a(93291),i=a(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(a(72779)),l=s(a(2784)),n=i(a(13277)),o=i(a(76176)),d=a(81407),c=i(a(1626)),u=a(46269),h=i(a(19058)),p=i(a(38637)),f=i(a(74903)),m=i(a(52425)),v=a(65129),g=i(a(18779)),E=i(a(5431)),_=i(a(43195)),C=a(89874),S=i(a(82838));class y extends l.Component{constructor(...e){super(...e),this.state={active:!1,emojiPicker:null},this._refEmojiPanel=l.createRef(),this.onEmojiPicker=e=>{e&&(e.preventDefault(),e.stopPropagation());var t=l.createElement(c.default,{ref:this._refEmojiPanel,onEmoji:this.onEmoji,onFocusNext:this.restoreFocus,onFocusPrev:this.restoreFocus});this.setState({emojiPicker:{menu:t,dirY:d.DirY.TOP,type:"emoji_picker",anchor:e.target}}),this.restoreFocus()},this.onEmojiPickerClose=()=>{this.setState({emojiPicker:null})},this.onRestoreEmojiPickerFocus=()=>{var e;null===(e=this._refEmojiPanel.current)||void 0===e||e.restoreFocus()},this.onEmoji=e=>{var t=this.refInput;t&&(t.focus(!1),t.replaceSelection(e)),this.onEmojiPickerClose()},this.setRefInput=e=>{this.refInput=e},this.onSelectionChange=e=>{this.selection=e},this.restoreFocus=()=>{this.refInput&&this.refInput.focus()},this.onBlur=e=>{this.state.active&&this.setState({active:!1}),this.props.onBlur&&this.props.onBlur(e)},this.onFocus=e=>{e.stopPropagation(),this.state.active||this.setState({active:!0}),this.props.onFocus&&this.props.onFocus(e)},this.onReset=()=>{this.refInput&&this.refInput.reset()}}componentDidMount(){this.props.focusOnMount&&this.restoreFocus()}render(){var e,t=this.props.maxLength,a=(0,C.numCodepoints)(this.props.value||""),s=(0,r.default)(m.default.textInput,{[m.default.noPlaceholder]:!this.props.placeholder,[m.default.active]:!0}),i=(0,r.default)(m.default.labelText,{[m.default.float]:!!this.props.value}),n=this.props.supportsEmoji?l.createElement("button",{className:m.default.inputEmoji,onClick:this.onEmojiPicker},l.createElement(g.default,{"aria-label":p.default.t(22),name:"emoji-input"})):void 0,{value:o}=this.props;e=o&&""!==o?l.createElement("div",{role:"button",className:m.default.clearInput,onClick:this.onReset},l.createElement(g.default,{name:"x-alt"})):null;var d,c=this.props.showRemaining?l.createElement("div",{className:(0,r.default)(m.default.buttonContainer,m.default.charCounter,{[m.default.charCounterWithClearBtn]:!!e})},l.createElement("div",{className:m.default.charCounter},t-a<50?p.default.n(t-a):null)):null;return this.state.emojiPicker&&(d=l.createElement(E.default,{displayName:"EmojiPicker",escapable:!0,popable:!0,requestDismiss:this.onEmojiPickerClose,requestFocus:this.onRestoreEmojiPickerFocus},l.createElement(_.default,{contextMenu:this.state.emojiPicker}))),l.createElement(h.default,{className:s,onFocus:this.restoreFocus},l.createElement("span",{className:i},this.props.placeholder),l.createElement("div",{className:m.default.spacer}),l.createElement("div",{className:m.default.suggestionsPositioner},l.createElement("div",{className:m.default.suggestionsContainer},l.createElement(f.default.MentionSuggestions,{chat:this.props.chat,theme:v.ThemeOptions.MEDIA_CAPTION}),l.createElement(f.default.EmojiSuggestions,{chat:this.props.chat,theme:u.ThemeOptions.MEDIA_CAPTION}))),l.createElement("div",{className:(0,r.default)(m.default.wrapper,{[m.default.textActive]:this.state.active})},l.createElement(f.default,{ref:this.setRefInput,initialValue:this.props.value,initialSelection:this.selection,readOnly:!1,spellCheck:this.props.spellCheck,multiline:this.props.multiline,maxLength:this.props.maxLength,onEnter:this.props.onEnter,onMaxPasteExceeded:this.props.onMaxPasteExceeded,onFiles:this.props.onFiles,onChange:this.props.onChange,onSelect:this.onSelectionChange,theme:"media-caption"}),l.createElement("div",{className:m.default.inputControls},l.createElement(S.default,{transitionName:"pop",component:"div",className:m.default.buttonContainer},e,n),c)),d)}}t.default=y,y.defaultProps={maxLength:25,onMaxPasteExceeded:()=>{n.default.openModal(l.createElement(o.default,{title:p.default.t(358),onOK:()=>{n.default.closeModal()},okText:p.default.t(1738)},p.default.t(357)))}},y.displayName="MediaCaptionTextInput"},68536:(e,t,a)=>{"use strict";var s=a(14859),i=a(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(a(2784)),l=s(a(23045)),n=s(a(1877)),o=s(a(26561)),d=s(a(90370));class c extends r.Component{constructor(...e){super(...e),this._setRefContainer=e=>{this._refContainer=e}}getContainer(){return this._refContainer}render(){var{chatPreference:e}=this.props,{wallpaperColor:t,showDoodle:a}=e,s={};return t!==l.default.DEFAULT_CHAT_WALLPAPER&&(s={backgroundColor:t}),r.createElement("div",{className:o.default.container,ref:this._setRefContainer},r.createElement("div",{className:o.default.body,style:s},r.createElement(n.default,{wallpaperColor:t,showDoodle:a}),this.props.children))}}c.CONCERNS={chatPreference:["wallpaperColor","showDoodle"]},c.displayName="MsgPreview";var u=(0,d.default)(c,c.CONCERNS);t.default=class extends u{get container(){return this.getComponent().getContainer()}}},12718:(e,t,a)=>{"use strict";var s=a(93291),i=a(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(a(90882)),l=s(a(2784)),n=i(a(75956)),o=i(a(46818)),d=i(a(13277)),c=i(a(76176)),u=i(a(23045)),h=i(a(43805)),p=i(a(21941)),f=i(a(77508)),m=i(a(43629)),v=a(48537),g=i(a(81363)),E=i(a(62536)),_=i(a(11128)),C=i(a(87958)),S=i(a(38637)),y=s(a(28119)),I=s(a(64828)),M=i(a(29986)),P=i(a(85895)),T=i(a(49398)),L=i(a(70219)),b=i(a(18779)),N=i(a(96517)),D=i(a(11018)),w=i(a(5431)),O=i(a(43195)),k=i(a(82838));class R extends l.Component{constructor(...e){super(...e),this.state={img:this.props.startImage,hover:!1,imageSize:null},this._setRefImageContainer=e=>{this._refImageContainer=e},this._setRefImageInput=e=>{this._refImageInput=e},this._onUpload=()=>{var e=this._refImageInput;if(e)return e.click(),!0},this._removeImage=()=>{this.props.onImageSet(),d.default.closeModal()},this._onRemove=()=>{var e=this.props.type===T.default.GROUP?S.default.t(1201):S.default.t(1204);d.default.openModal(l.createElement(c.default,{onOK:this._removeImage,okText:S.default.t(1200),onCancel:()=>d.default.closeModal(),cancelText:S.default.t(1569)},e))},this._onView=()=>{var e=this._refImageContainer,{id:t,attachToChat:a}=this.props;if(e&&t){var s=h.default.assertGet(t),i={transition:"profile-viewer"};a&&(i.uim=this.props.uim),d.default.openModalMedia(l.createElement(L.default,{contact:s,profilePicThumb:s.getProfilePicThumb(),animateBorderRadius:!0,getZoomNode:t=>{t(e)}}),i)}},this.onPaste=e=>{if(this.state.contextMenu){var t=new p.default(e.clipboardData),a=(0,r.default)(t.getFiles(),(e=>"image"===(0,v.typeFromMimetype)(e.type)));if(a.length){e.preventDefault(),e.stopPropagation(),this.closeContextMenu();var s=a[0];this._onImagePick(s)}}},this.onImageSelected=e=>{this.closeContextMenu();var t=e.target.files[0];if(!t)return!1;this._onImagePick(t),e.target.value=""},this._onImageReceived=(e,t)=>{e?y.loadImage(e).then((()=>{this.setState({img:e}),this.props.onImageSet(e,t)})).catch((e=>{__LOG__(3)`PhotoPicker:onImageReceived failed to load image: ${String(e)}`;var t=this.props.type===T.default.GROUP?S.default.t(116):S.default.t(185);d.default.openModal(l.createElement(c.default,{onOK:()=>d.default.closeModal()},t))})):this.setState({img:null,imageSize:null})},this.onSearch=()=>{d.default.openModal(l.createElement(I.default,{type:I.BoxModalType},l.createElement(_.default,{onFinished:this._onImageReceived})))},this._onImagePick=e=>{var t=URL.createObjectURL(e);y.loadImage(t).then((t=>{t&&(t.width<u.default.MIN_PIC_SIDE||t.height<u.default.MIN_PIC_SIDE)?d.default.openModal(l.createElement(c.default,{onOK:()=>d.default.closeModal()},S.default.t(1192,{size:u.default.MIN_PIC_SIDE,_plural:u.default.MIN_PIC_SIDE}))):d.default.openModal(l.createElement(I.default,{type:I.BoxModalType},l.createElement(m.default,{img:e,onFinished:this._onImageReceived,onRetake:this._onUpload})))})).catch((()=>{var e=this.props.type===T.default.GROUP?S.default.t(116):S.default.t(185);d.default.openModal(l.createElement(c.default,{onOK:()=>d.default.closeModal()},e))})).finally((()=>{URL.revokeObjectURL(t)}))},this.onImageClick=e=>{if(this.props.readOnly)this.state.img&&this._onView();else{e.stopPropagation(),e.preventDefault();var t=[];this.props.id&&this.state.img&&t.push(l.createElement(f.default,{a8n:"mi-view-photo",key:"view",action:this._onView},S.default.t(1455))),g.default&&t.push(l.createElement(N.default,{key:"take",onImageTake:this._onImageReceived})),t.push(l.createElement(f.default,{a8n:"mi-upload-photo",key:"upload",action:this._onUpload},S.default.t(1414))),D.default.isElectron&&this.props.type===T.default.GROUP&&t.push(l.createElement(f.default,{a8n:"mi-search-photo",key:"search",action:this.onSearch},S.default.t(1798))),this.state.img&&t.push(l.createElement(f.default,{a8n:"mi-remove-photo",key:"remove",action:this._onRemove},S.default.t(1203))),e.persist(),this.setState({contextMenu:{menu:t,event:e}})}},this.closeContextMenu=()=>{this.setState({contextMenu:null})},this.onMouseOver=()=>{this.state.hover||this.setState({hover:!0})},this.onMouseEnter=()=>{this.state.hover||this.setState({hover:!0})},this.onMouseLeave=()=>{this.state.hover&&this.setState({hover:!1})},this.onLoad=e=>{var t=e.target.clientWidth,a=e.target.clientHeight;this.setState({imageSize:{width:t,height:a}})}}static getDerivedStateFromProps(e){return e.startImage?{img:e.startImage}:{img:e.startImage,imageSize:null}}render(){var e,t;this.state.img&&(e=l.createElement(M.default,{type:"cover",size:this.state.imageSize},l.createElement(C.default,{src:this.state.img,crossOrigin:!1,style:{height:"100%",width:"100%"},onLoad:this.onLoad}))),(this.props.pending||this.state.img&&!this.state.imageSize)&&(t=l.createElement(o.default,null));var a=null;if(!this.props.pending&&!this.props.readOnly&&(!this.state.img||this.state.imageSize)&&(!this.state.img||this.state.contextMenu||this.state.hover)){var s="";switch(this.props.type){case T.default.GROUP:s=this.state.img?S.default.t(422):S.default.t(212);break;case T.default.PROFILE:s=this.state.img?S.default.t(427):S.default.t(219)}a=l.createElement(n.default,{icon:l.createElement(b.default,{name:"camera"}),text:s})}var i,r,d=this.props.pending||!this.state.imageSize&&this.state.img?()=>{}:this.onImageClick;if(this.state.contextMenu&&(i=l.createElement(w.default,{displayName:"PhotoPickerContextMenu",escapable:!0,popable:!0,requestDismiss:this.closeContextMenu},l.createElement(O.default,{contextMenu:this.state.contextMenu}))),this.props.pending||!this.state.img||this.state.img&&!this.state.imageSize){var c=this.props.type===T.default.PROFILE?"default-user":"default-group";r=l.createElement("div",{className:P.default.defaultIcon},l.createElement(b.default,{name:c}))}var u=null!=this.props.size?{width:this.props.size,height:this.props.size}:null;return l.createElement("div",{className:P.default.container,style:u},l.createElement("div",{className:P.default.body,onClick:d,onMouseOver:this.onMouseOver,onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,onPaste:this.onPaste,ref:this._setRefImageContainer,dir:"ltr"},l.createElement("div",{className:P.default.imageContainer},e,r),l.createElement(k.default,{transitionName:"fade"},t,a)),l.createElement("input",{ref:this._setRefImageInput,type:"file",accept:"image/gif,image/jpeg,image/jpg,image/png",style:{display:"none"},onChange:this.onImageSelected}),i)}}R.displayName="PhotoPicker";var A=(0,E.default)(R);t.default=A},74903:(e,t,a)=>{"use strict";var s=a(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(a(143)),r=s(a(9371)),l=s(a(46269)),n=s(a(83897)),o=s(a(64791)),d=s(a(48067)),c=s(a(65129)),u=s(a(18263)),h=new n.default,p=new i.default;class f extends((0,o.default)([r.default,p,h,d.default])){}t.default=f,f.MentionSuggestions=(0,u.default)(c.default,{plugin:h}),f.EmojiSuggestions=(0,u.default)(l.default,{plugin:p})},61482:(e,t,a)=>{"use strict";var s=a(93291),i=a(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(a(58527)),l=s(a(2784)),n=i(a(13277)),o=i(a(76176)),d=s(a(32597)),c=i(a(38637)),u=a(90758),{useState:h}=l;t.default=({doSave:e,afterSave:t,isValid:a,children:s,modalConfig:i,onError:p,title:f,onCancel:m})=>{var[v,g]=h(u.EditType.EDITING),E=l.createElement(d.default,{title:f,type:d.DRAWER_HEADER_TYPE.POPUP,onCancel:()=>{n.default.closeModal(),m&&m()}});return l.createElement(o.default,(0,r.default)({children:s,okText:c.default.t(1241),type:"auto",onOK:()=>{g(u.EditType.PENDING),e().then((()=>{g(u.EditType.DONE),t&&t(),n.default.closeModal()}),(e=>{g(u.EditType.ERROR),p&&p(e)}))},okSpinner:v===u.EditType.PENDING,okDisabled:v===u.EditType.PENDING||!a,title:E},i))}},29984:(e,t,a)=>{"use strict";var s=a(14859),i=a(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(a(2784)),l=s(a(72779)),n=s(a(19058)),o=s(a(6889)),{useRef:d}=r,c=({tabConfigs:e,selectedId:t,onSelect:a,tabClass:s,className:i})=>{var c=d(t),u=d([]),h=e.map((({id:e})=>e)),p=h.length-1;return r.createElement(n.default,{handlers:{right:()=>{var e=h.indexOf(c.current),t=e===p?0:e+1,a=u.current[t];a&&a.focus()},left:()=>{var e=h.indexOf(c.current),t=0===e?p:e-1,a=u.current[t];a&&a.focus()}}},r.createElement("div",{role:"tablist",className:(0,l.default)(o.default.tabContainer,i)},e.map(((e,i)=>(({title:e,id:i},n)=>{var d=i===t;return r.createElement("button",{role:"tab",tabIndex:d?0:-1,"aria-selected":Boolean(d),title:e,className:(0,l.default)(o.default.tab,{[o.default.selected]:d},s),onClick:()=>{d||a(i)},onFocus:()=>{c.current=i},ref:e=>u.current[n]=e,key:e},e)})(e,i)))))};c.displayName="Tabs";var u=c;t.default=u},96517:(e,t,a)=>{"use strict";var s=a(14859),i=a(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(a(2784)),l=s(a(13277)),n=s(a(77508)),o=s(a(93815)),d=s(a(38637));class c extends r.Component{constructor(...e){super(...e),this.onCapture=()=>{l.default.openModal(r.createElement(o.default,{onFinished:this.props.onImageTake}))}}render(){return r.createElement(n.default,{action:this.onCapture,a8n:"mi-take-photo",disabled:this.props.disabled},d.default.t(1362))}}t.default=c,c.displayName="TakePhotoMenuItem"},21975:(e,t,a)=>{"use strict";var s=a(93291),i=a(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=h;var r=i(a(72779)),l=s(a(2784)),n=i(a(32944)),o=i(a(23045)),d=i(a(38637)),c=a(64812),u=i(a(16643));function h({className:e}){var t=o.default.VERSION_STR;return l.createElement(c.SelectableDiv,{"data-a8n":n.default.key("version"),className:(0,r.default)(u.default.versionInfo,e),selectable:!0},d.default.t(1436,{version:""}),l.createElement("span",{dir:"LTR"},t),null,null)}h.displayName="VersionInfo"},60302:(e,t,a)=>{"use strict";var s=a(14859),i=a(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(a(2784)),l=s(a(85030)),n=s(a(13277)),o=s(a(76176)),d=s(a(30905)),c=s(a(94751)),u=s(a(18792)),h=s(a(15946)),p=s(a(38637)),f=a(30371);class m extends c.default{constructor(...e){super(...e),this.filter=e=>{var t=e.groupMetadata;return!(!e.isGroup||e.isGroup&&!t.participants.iAmMember())&&(t.participants.get(this.props.contact.id)?p.default.t(224):!!t.participants.iAmAdmin()||p.default.t(446))},this._confirmAddToGroup=e=>{this.props.requestFocus&&this.props.requestFocus(),this.push(r.createElement(o.default,{cancelText:p.default.t(1569),okText:p.default.t(213),onOK:this._addToGroup.bind(null,e),onCancel:this._pop},r.createElement(d.default,{text:p.default.t(478,{participant:this.props.contact.formattedName,subject:e.contact.name})})))},this.requestFocus=()=>{if(this.refUIE){var e=this.refUIE.getNode();e&&!e.contains(document.activeElement)&&u.default.focus(e)}},this._addToGroup=e=>{(0,f.addParticipants)(e,[this.props.contact]).then((()=>{n.default.openChatFromUnread(e).then((t=>{t&&n.default.focusChatTextInput(e)}))})).catch((()=>{})),this.end()},this._pop=()=>{this.pop()}}componentDidMount(){this.push(r.createElement(h.default,{chats:l.default.filter((e=>e.isGroup)),filter:this.filter,onCancel:this._pop,onGroup:this._confirmAddToGroup}))}}t.default=m},52735:(e,t,a)=>{"use strict";var s=a(93291),i=a(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(a(98874)),l=i(a(25291)),n=s(a(2784)),o=a(25713),d=i(a(19303)),c=i(a(13277)),u=i(a(94751)),h=a(68571),p=i(a(11018));class f extends u.default{constructor(){super(...arguments),this.onCancel=()=>{this.props.onComplete&&this.props.onComplete(!1),this._clearAttachMedia(),this.props.mediaCollection.mediaPickerStatsLogger.logCancel(),this.end()},this.onFailedMedias=e=>{var t=e.filter((e=>e.isGif));if(t.length>0){var a=t.map((e=>e.filename));c.default.once("ui_idle",(()=>{c.default.pasteChatTextInput(this.props.chat,a.join(" "))})),this.props.onComplete&&this.props.onComplete(!1),this._clearAttachMedia(),this.props.mediaCollection.mediaPickerStatsLogger.logCancel(),this.end()}},this._sendMediaWithMentions=(e,t,a)=>{var{chat:s}=this.props;c.default.once("ui_idle",(()=>{e.forEach(((e,t)=>{var i=e.media,r={};if(0===t&&(r.quotedMsg=s.composeQuotedMsg,s.composeQuotedMsg=null),r.isViewOnce=a,r.mentionedJidList=e.mentionedJidList,r.caption=i.caption,r.addEvenWhilePreparing=i.previewable&&i.state===o.ATTACH_MEDIA_STATE.PROCESSING,this.props.initCaption&&this.props.initCaption.ctwaContextLinkData){var{ctwaContextLinkData:l,ctwaContext:n}=this.props.initCaption;r.ctwaContext=(0,h.prepareCtwaContextSend)(l,n)}i.sendToChat(s,r)})),this._clearAttachMedia()})),this.props.onComplete&&this.props.onComplete(!0,t),this.props.mediaCollection.mediaPickerStatsLogger.logSend(),this.end()},this.setText=e=>{null!=e&&c.default.once("ui_idle",(()=>{c.default.pasteChatTextInput(this.props.chat,e)})),this.end()},this._clearAttachMedia=()=>{this.props.chat&&this.props.chat.setAttachMediaContents(null)},this.handleRequestDismiss=this.handleRequestDismiss.bind(this)}componentDidMount(){c.default.closeContextMenu(),c.default.closeTooltip(),this.push(n.createElement(d.default,{chat:this.props.chat,onBack:this.onCancel,initCaption:this.props.initCaption,onSendMedia:(0,l.default)(this._sendMediaWithMentions),onDropText:(0,l.default)(this.setText),onFailedMedias:this.onFailedMedias,mediaCollection:this.props.mediaCollection}))}componentWillUnmount(){p.default.isGecko?(0,r.default)((()=>c.default.focusChatTextInput(this.props.chat))):c.default.focusChatTextInput(this.props.chat)}handleRequestDismiss(e){!1===e&&(this._clearAttachMedia(),this.props.mediaCollection.mediaPickerStatsLogger.logCancel()),super.handleRequestDismiss()}}t.default=f},73550:(e,t,a)=>{"use strict";var s=a(14859),i=a(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(a(2784)),l=s(a(13277)),n=s(a(94751)),o=s(a(38637)),d=a(57934),c=s(a(88322)),u=a(4704);class h extends n.default{constructor(...e){super(...e),this.requestFocus=()=>{var e,t=null===(e=this.refUIE)||void 0===e?void 0:e.getRef();null!=t&&(t instanceof HTMLElement||"function"!=typeof t.onFocusList||t.onFocusList())},this._sendProducts=e=>{var{chat:t}=this.props;e.forEach(((e,a)=>{var s=0===a?t.composeQuotedMsg:null;t.sendProductMessage(e,s).then((()=>{(0,d.logProductMessageSent)({product:e,catalogSessionId:this.props.sessionId})}))})),t.composeQuotedMsg=null,this.end()},this._shareCatalog=e=>{var{chat:t}=this.props,a=(0,u.createCatalogLink)(e.id.user),s=`${o.default.t(1160)} ${a}`;l.default.pasteChatTextInput(t,s),(0,d.logSendCatalogClick)({catalogOwnerWid:e.id,catalogSessionId:this.props.sessionId}),this.end()},this._pop=()=>{this.pop()},this._popNone=()=>{this.pop("none")}}componentDidMount(){this.push(r.createElement(c.default,{onCancel:this._pop,onConfirm:this._sendProducts,onShare:this._shareCatalog}))}}var p=h;t.default=p},37892:(e,t,a)=>{"use strict";var s=a(93291),i=a(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(a(58527)),l=s(a(2784)),n=i(a(94751)),o=i(a(38637)),d=s(a(55231)),c=i(a(95877)),u=i(a(54559)),h=i(a(67428));class p extends n.default{constructor(...e){super(...e),this._confirmSendContacts=e=>{this.push(l.createElement(h.default,{contactList:e,onSend:()=>this._sendContacts(e),onBack:this._popNone,chat:this.props.chat}),"none"),this.contacts=e},this._sendContacts=e=>{var{chat:t}=this.props,a=t.composeQuotedMsg,s=t.getComposeContents().ctwaContext||void 0;(0,c.default)(e,t,a,s),t.composeQuotedMsg=null,this.props.onContactsSent(),this.end()},this._getContacts=()=>this.contacts,this._pop=()=>{this.pop()},this._popNone=()=>{this.pop("none")}}componentDidMount(){var e=this.props.serverProps.maxParticipants;this.contacts=[],this.push(l.createElement(d.default,{title:o.default.t(1277),onCancel:this._pop,onConfirm:this._confirmSendContacts,getInitialItems:this._getContacts,listType:d.ListType.CONTACT_SELECT_MODAL,maxItems:e,allowBlockedContacts:!0}))}}t.default=e=>l.createElement(p,(0,r.default)({},e,{serverProps:u.default}))},75655:(e,t,a)=>{"use strict";var s=a(14859),i=a(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(a(2784)),l=s(a(45416)),n=s(a(94751)),o=a(27305);class d extends n.default{constructor(...e){super(...e),this.sendMedia=({getImg:e,caption:t,isViewOnce:a,mentionedJidList:s})=>{var i=this.props.chat,r=i.composeQuotedMsg;i.composeQuotedMsg=null;var l=i.getComposeContents().ctwaContext||void 0;(0,o.prepRawMedia)(e,{}).sendToChat(i,{caption:t,mentionedJidList:s,quotedMsg:r,ctwaContext:l,isViewOnce:a}),this.props.onCaptureSent(),this.end()}}componentDidMount(){this.push(r.createElement(l.default,{onBack:()=>{this.end()},chat:this.props.chat,caption:!0,theme:"capture-contain",onSend:this.sendMedia,stream:this.props.stream,disposeStream:this.props.disposeStream}))}}t.default=d},31461:(e,t,a)=>{"use strict";var s=a(14859),i=a(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(a(2784)),l=s(a(39348)),n=s(a(13277)),o=s(a(84755)),d=s(a(94751)),c=s(a(84161)),u=a(55439),h=s(a(42638));class p extends d.default{constructor(...e){super(...e),this.onProductCatalog=()=>{var{sellerJid:e,chat:t}=this.props;this.push(r.createElement(h.default,{chat:t,catalogOwnerJid:e}))},this.onProductDetail=e=>{var{chat:t}=this.props;this.push(r.createElement(h.default,{refreshCarousel:!0,chat:t,productInfo:e,onEnd:this._pop}))},this._end=()=>{this.end(!0)},this._pop=()=>{this.pop()}}componentDidMount(){var{sellerJid:e,chat:t}=this.props;this.push(r.createElement(o.default.Consumer,null,(a=>{var{entryPoint:s}=(0,u.getProductCatalogContext)(a);return r.createElement(l.default,{chat:t,sellerJid:e,onProductDetail:this.onProductDetail,onProductCatalog:this.onProductCatalog,onBack:this._end,closeDrawerRightOnSend:s===c.default.CATALOG_ENTRY_POINT.CATALOG_ENTRY_POINT_PRODUCT_LIST_MESSAGE})}))),n.default.existsDrawerLeft((e=>{e&&n.default.closeDrawerLeft()})),n.default.existsDrawerMid((e=>{e&&n.default.closeDrawerMid()}))}}t.default=p},79538:(e,t,a)=>{"use strict";var s=a(93291),i=a(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(a(58527)),l=s(a(2784)),n=a(30557),o=i(a(89962)),d=i(a(38024)),c=i(a(45411)),u=i(a(13277)),h=i(a(58322)),p=i(a(36733)),f=i(a(43805)),m=i(a(84755)),v=a(32597),g=i(a(46419)),E=i(a(96042)),_=a(33576),C=i(a(94751)),S=a(66239),y=a(9690),I=i(a(38637)),M=i(a(71429)),P=i(a(56811)),T=i(a(13692)),L=i(a(82773));class b extends C.default{constructor(...e){super(...e),this._handleAddFirstProduct=()=>{this._showProductList(),o.default.find(this.props.catalogId).then((()=>{this._onAddProduct()})).catchType(_.ServerStatusCodeError,(()=>{__LOG__(3)`Failed to fetch product catalog from server`}))},this._showProductList=()=>{var e=f.default.get(this.props.catalogId);if(e){var t=(0,y.canManageCollections)()?l.createElement(c.default,{contact:e,onCatalogLinkClick:this._onCatalogShare,onProductShare:this.onProductShare,onProductDetail:this.onEditProduct,onAddProduct:this._onAddProduct,catalogId:this.props.catalogId,onBack:this._end,onCartClick:this.onCartClick,businessProfile:null,headerType:v.DRAWER_HEADER_TYPE.LARGE,onCollectionSeeAll:this.onCollectionSeeAll,canManageCatalog:!0,autoUpdate:!0,onOpenCollections:this.onOpenCollections,onEditCollection:this._onEditCollection}):l.createElement(L.default,{contact:e,onCatalogLinkClick:this._onCatalogShare,onProductShare:this.onProductShare,onProductDetail:this.onEditProduct,onAddProduct:this._onAddProduct,catalogId:this.props.catalogId,onBack:this._end,onCartClick:this.onCartClick,businessProfile:null,headerType:v.DRAWER_HEADER_TYPE.LARGE,canManageCatalog:!0,autoUpdate:!0});this.push(t)}},this.onEditProduct=e=>{var t=o.default.assertGet(this.props.catalogId);u.default.openDrawerMid(l.createElement(E.default,{catalog:t,product:e}),"slide-left",void 0,void 0,this.props.context)},this.onCartClick=e=>{(0,n.showCartFlow)(e,void 0,this.props.context)},this.onCollectionSeeAll=e=>{var t=this.props.catalogId,a=f.default.gadd(t);this.push(l.createElement(h.default,{contact:a,onProductDetail:this.onEditProduct,catalogId:t,onBack:this._pop,onCatalogLinkClick:this._onCatalogShare,onCartClick:this.onCartClick,collection:e,canManageCatalog:!0,headerType:v.DRAWER_HEADER_TYPE.LARGE,onEditCollection:this._onEditCollection}))},this._onEditCollection=e=>{var t=(0,S.getMeUser)(),a=o.default.get(t);a&&this.push(l.createElement(g.default,{onBack:this._pop,collection:e,catalog:a}))},this._onAddProduct=()=>{var e=o.default.assertGet(this.props.catalogId),t=new P.default({catalogWid:e.id,additionalImageCdnUrl:[]});u.default.openDrawerMid(l.createElement(E.default,{catalog:e,product:t,newProduct:!0}),"slide-left",void 0,void 0,this.props.context)},this._onCatalogShare=(e,t)=>{u.default.openDrawerMid(l.createElement(d.default,{onCancel:()=>{u.default.closeDrawerMid()},catalog:e,contact:t,prompt:I.default.t(418),onSend:()=>u.default.closeDrawerMid(),centerDrawer:!0}),"slide-left",void 0,void 0,this.props.context)},this.onProductShare=e=>{u.default.openDrawerMid(l.createElement(T.default,{onCancel:()=>{u.default.closeDrawerMid()},product:e,prompt:I.default.t(418),onSend:()=>u.default.closeDrawerMid(),centerDrawer:!0,sendProductMsg:!0}),"slide-left",void 0,void 0,this.props.context)},this.onOpenCollections=()=>{u.default.openDrawerLeft(l.createElement(p.default,null))},this._pop=()=>{this.pop(),u.default.closeDrawerMid()},this._end=()=>{this.end(!0),u.default.closeDrawerMid()}}componentDidMount(){null!=this.props.catalog?(this._showProductList(),null!=this.props.product&&this.onEditProduct(this.props.product)):this._showNewCatalog()}_showNewCatalog(){this.push(l.createElement(M.default,{onBack:this._pop,onAddProductClick:this._handleAddFirstProduct,onCatalogAlreadyCreated:this._showProductList}))}}t.default=e=>l.createElement(m.default.Consumer,null,(t=>l.createElement(b,(0,r.default)({context:t},e))))},36733:(e,t,a)=>{"use strict";var s=a(14859),i=a(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(a(2784)),l=s(a(89962)),n=s(a(13277)),o=s(a(11151)),d=s(a(46419)),c=s(a(94751)),u=a(66239);class h extends c.default{constructor(...e){super(...e),this.editCollection=e=>{var t=(0,u.getMeUser)(),a=l.default.get(t);a&&this.push(r.createElement(d.default,{onBack:this._pop,collection:e,catalog:a}))},this._pop=()=>{this.pop(),n.default.closeDrawerMid()},this._end=()=>{this.end(!0),n.default.closeDrawerMid()}}componentDidMount(){this.showCollectionsList()}showCollectionsList(){this.push(r.createElement(o.default,{onBack:this._pop,editCollection:this.editCollection}))}}t.default=h},92396:(e,t,a)=>{"use strict";var s=a(14859),i=a(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(a(2784)),l=s(a(22808)),n=s(a(94751)),o=s(a(42638));class d extends n.default{constructor(...e){super(...e),this.onProductClick=e=>{this.push(r.createElement(o.default,{refreshCarousel:!0,chat:this.props.msg.chat,product:e,onEnd:this._pop}))},this._pop=()=>{this.pop()}}componentDidMount(){this.push(r.createElement(l.default,{msg:this.props.msg,onProductClick:this.onProductClick}))}}t.default=d},16844:(e,t,a)=>{"use strict";var s=a(14859),i=a(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(a(2784)),l=s(a(45416)),n=s(a(13277)),o=i(a(39931)),d=i(a(24461)),c=s(a(94751)),u=i(a(10313)),h=i(a(46229)),p=i(a(64828)),f=s(a(85185));class m extends c.default{constructor(...e){super(...e),this._refCaptureDrawer=null,this._setRefCaptureDrawer=e=>{this._refCaptureDrawer=e},this._pushPermissionModal=()=>{this.push(r.createElement(u.default,{messaging:u.Messaging.CAMERA,type:u.default.TYPE.GUIDE_ALLOW,onConfirm:this._popModal}),"modal")},this._popModal=()=>{this.pop("modal")},this._startCaptureDrawer=()=>{var e;null===(e=this._disposeStream)||void 0===e||e.call(this);var{asyncStream:t,disposeStream:a}=h.start("camera",this._pushPermissionModal);this._disposeStream=a,t.then((e=>{this._refCaptureDrawer||this._popModal(),e&&this._refCaptureDrawer&&this._refCaptureDrawer.loadNewStream(e,a)})).catchType(d.GUM.NotAllowedError,(()=>{this.cleanUp(),n.default.openModal(r.createElement(u.default,{messaging:u.Messaging.CAMERA_FAIL,type:u.default.TYPE.GUIDE_UNBLOCK}))})).catchType(d.GUM.GUMError,(()=>{this.cleanUp(),n.default.openModal(r.createElement(u.default,{messaging:u.Messaging.CAMERA_MISSING,type:u.default.TYPE.GUIDE_NONE}))}))},this.onFinished=(e,t)=>{this.props.onFinished(e,t),this.cleanUp()},this.cleanUp=()=>{this.end()},this.onRetake=()=>{this.pop("flow-transition-box-size-drawer-pop"),this._startCaptureDrawer()},this.onCaptured=e=>{this.push(r.createElement(p.default,{type:p.BoxModalType},r.createElement(o.default,{onRetake:this.onRetake,retryText:o.RETRY_OPTIONS.RETAKE,onFinished:this.onFinished,onCancel:this.cleanUp,img:e})),"flow-transition-box-size-drawer-push")},this.handleRequestDismiss=e=>{!1===e&&this.stackSize()>1?this.onRetake():this.cleanUp()}}componentDidMount(){this.push(r.createElement(p.default,{type:p.BoxModalType},r.createElement(l.default,{ref:this._setRefCaptureDrawer,stream:void 0,disposeStream:void 0,caption:!1,theme:"capture-cover",onBack:this.cleanUp,onSend:null,onCaptured:this.onCaptured,chat:void 0}))),this._startCaptureDrawer()}componentWillUnmount(){var e;null===(e=this._disposeStream)||void 0===e||e.call(this)}}var v=(0,f.default)(m);t.default=v},43629:(e,t,a)=>{"use strict";var s=a(14859),i=a(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(a(2784)),l=i(a(39931)),n=s(a(94751));class o extends n.default{constructor(...e){super(...e),this.onEnd=()=>{this.end()},this.onFinished=(e,t)=>{this.props.onFinished(e,t),this.end()}}componentDidMount(){this.push(r.createElement(l.default,{onCancel:this.onEnd,onFinished:this.onFinished,onRetake:this.props.onRetake,retryText:l.RETRY_OPTIONS.RESTART,img:this.props.img}))}}t.default=o},96042:(e,t,a)=>{"use strict";var s=a(14859),i=a(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(a(2784)),l=s(a(13277)),n=s(a(18457)),o=s(a(94751)),d=s(a(38637)),c=s(a(84802)),u=s(a(13692));class h extends o.default{constructor(...e){super(...e),this._showInfoDrawer=e=>{var{catalog:t}=this.props;this.push(r.createElement(c.default,{catalog:t,product:e,onCancel:this.end,onEditProduct:this._onProductEdit,onShareProduct:this.onShareProduct}))},this.onShareProduct=e=>{this.push(r.createElement(u.default,{onBack:this._pop,product:e,prompt:r.createElement("div",null,d.default.t(418)),onSend:()=>l.default.closeDrawerMid(),centerDrawer:!0,sendProductMsg:!0}))},this._onProductEdit=e=>{this.push(r.createElement(n.default,{catalog:this.props.catalog,onBack:this._pop,onEditSuccess:this._showInfoDrawer,product:e,onDelete:this.props.onDelete}))},this._pop=()=>{this.pop()},this._end=()=>{this.end(!0)}}componentDidMount(){var{catalog:e,product:t,onCreate:a,newProduct:s}=this.props;s?this.push(r.createElement(n.default,{onCancel:this._pop,onEditSuccess:e=>{a&&a(),this._showInfoDrawer(e)},catalog:e,product:t,newProduct:!0})):this._showInfoDrawer(t)}}t.default=h},11930:(e,t,a)=>{"use strict";var s=a(14859),i=a(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(a(2784)),l=s(a(85030)),n=s(a(13277)),o=s(a(76176)),d=s(a(23045)),c=s(a(94751)),u=s(a(81131)),h=s(a(51638)),p=s(a(38637)),f=i(a(55231)),m=s(a(54559));class v extends c.default{constructor(...e){super(...e),this.requestFocus=()=>{var e,t=null===(e=this.refUIE)||void 0===e?void 0:e.getRef();null!=t&&(t instanceof HTMLElement||"function"!=typeof t.onFocusList||t.onFocusList())},this.onForwardConfirmed=e=>{var{msgs:t,onForward:a}=this.props;l.default.forwardMessagesToChats(t,e).catchType(u.default,(e=>{this._showMediaSendError(e.reasons)})),this.end(),a&&a(t),n.default.openChatFromUnread(e[0])},this._showMediaSendError=e=>{var t=e.map((({chat:e,reason:t})=>r.createElement("p",{key:e.id.toString()},e.formattedTitle," : ",t)));n.default.openModal(r.createElement(o.default,{onOK:()=>n.default.closeModal(),okText:p.default.t(1738)},t),void 0)}}componentDidMount(){var e,{msgs:t}=this.props,a=p.default.t(681,{_plural:t.length||1}),s=t[0],i=s&&s.chat;e="video"!==s.type&&"image"!==s.type?"message":s.type;var l,n=t.some((e=>e.isFrequentlyForwarded)),o=t.filter((e=>!e.isFrequentlyForwarded&&e.getForwardingScoreWhenForwarded()===d.default.FREQUENTLY_FORWARDED_SENTINEL));m.default.frequentlyForwardedMessages&&o.length&&(l=r.createElement(h.default,{frequentlyForwardedCount:o.length,totalCount:t.length}));var c=m.default.frequentlyForwardedMessages&&n?m.default.frequentlyForwardedMax:m.default.multicastLimitGlobal;this.push(r.createElement(f.default,{onConfirm:this.onForwardConfirmed,maxItems:c,excludeChat:i,excludeBroadcast:!0,msgType:e,title:a,listType:f.ListType.CHAT_SELECT_MODAL,customHeader:l,hasFrequentlyForwarded:n,showEphemeralIcon:!0}))}}t.default=v},38957:(e,t,a)=>{"use strict";var s=a(14859),i=a(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(a(2784)),l=s(a(94751)),n=s(a(39426));class o extends l.default{componentDidMount(){this.push(r.createElement(n.default,{chat:this.props.chat,onConfirm:this.props.onConfirm}))}}t.default=o},26901:(e,t,a)=>{"use strict";var s=a(14859),i=a(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(a(2784)),l=s(a(94751)),n=s(a(57604)),o=s(a(42638));class d extends l.default{constructor(...e){super(...e),this.onProductClick=e=>{this.push(r.createElement(o.default,{refreshCarousel:!0,chat:this.props.msg.chat,product:e,onEnd:this._pop}))},this._pop=()=>{this.pop()}}componentDidMount(){this.push(r.createElement(n.default,{msg:this.props.msg,onProductClick:this.onProductClick}))}}t.default=d},46075:(e,t,a)=>{"use strict";var s=a(14859),i=a(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(a(2784)),l=s(a(85030)),n=s(a(13277)),o=s(a(76176)),d=s(a(94751)),c=s(a(25120)),u=s(a(72349)),h=s(a(38637)),p=s(a(12489)),f=s(a(26553)),m=a(87471),v=i(a(97025));class g extends d.default{constructor(...e){super(...e),this.onSendInvite=(e="",t)=>{n.default.closeModal(),Promise.all(this.props.participantNeedInvite.map((a=>{var{contact:s,invite_code:i,invite_code_exp:r}=a;return l.default.find(s.id).then((a=>{var l=this.props.groupGid.toString(),n=c.default.assertGet(l);return a.sendGroupInviteMessage(l,this.props.subject,i||"",r,e,t).then((e=>e===m.SendMsgResult.OK&&(n.pendingParticipants.add({id:s.id}),!0)))}))}))).then((e=>{var t=e.filter(Boolean).length;n.default.openToast(r.createElement(v.default,{msg:h.default.t(1691,{num:t,_plural:t}),id:(0,v.genId)()}))}))},this._addInviteCommment=e=>{this.push(r.createElement(u.default,{participants:e,gid:this.props.groupGid,subject:this.props.subject,groupDesc:this.props.groupDesc,onClose:this._pop,onSend:this.onSendInvite}))},this._pop=()=>{this.pop()}}componentDidMount(){var{participantNeedInvite:e}=this.props,t=this._getFormattedNames(e.map((e=>e.contact)),!0),a=h.default.t(763,{participant:t,_plural:e.length});this.push(r.createElement(o.default,{onOK:this._addInviteCommment.bind(this,e),okText:h.default.t(1690),onCancel:this._pop,cancelText:h.default.t(1569)},a))}_getFormattedName(e,t=!1){return t?e.formattedUser:r.createElement(f.default,{contact:e})}_getFormattedNames(e,t=!1){if(!Array.isArray(e))return this._getFormattedName(e,t);var a=e.map((e=>this._getFormattedName(e,t)));return(0,p.default)(a,t)}}t.default=g,g.defaultProps={removeTopDrawer:!0,pushTransition:"none",popTransition:"none"}},11128:(e,t,a)=>{"use strict";var s=a(14859),i=a(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(a(39931)),l=s(a(94751)),n=s(a(72909)),o=i(a(2784));class d extends l.default{constructor(...e){super(...e),this.onImageSelected=(e,t)=>{this.push(o.createElement(r.default,{onCancel:this._handleCancel,attributionUrl:t,onFinished:this.onFinished,onRetake:this._pop,retryText:r.RETRY_OPTIONS.NONE,img:e}))},this._handleCancel=()=>{this.end()},this._pop=()=>{this.pop()},this.onFinished=(e,t)=>{this.props.onFinished(e,t),this.end()}}componentDidMount(){this.push(o.createElement(n.default,{onCancel:this._pop,onImageSelected:this.onImageSelected}))}}t.default=d},19614:(e,t,a)=>{"use strict";var s=a(14859),i=a(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(a(2784)),l=s(a(98473)),n=s(a(13277)),o=s(a(76176)),d=s(a(23045)),c=s(a(94751)),u=s(a(38637)),h=s(a(62345)),p=s(a(68409)),f=s(a(81868)),m=s(a(18698));class v extends c.default{constructor(...e){super(...e),this.onDeleteLabel=e=>{e.forEach((({id:e})=>{h.default.deleteLabel(e)}))},this._onManageLabels=e=>{n.default.openModal(r.createElement(m.default,{modelsToUpdate:e}))},this.onEditLabel=e=>{n.default.openModal(r.createElement(l.default,{labelId:e,onUpdateLabel:this.onUpdateLabel,onCancel:n.default.closeModal()}))},this.onLabelClick=e=>{var t=a(92919).Z;this.push(r.createElement(t,{openLabelColorDrawer:this.openLabelColorDrawer,labelId:e,onManageLabels:this._onManageLabels,onClose:this._pop,onRemoveLabel:this.onRemoveLabel,onEditLabel:this.onEditLabel}))},this.openAddLabel=()=>{h.default.toArray().length>=d.default.MAX_SMB_LABEL_COUNT?n.default.openModal(r.createElement(o.default,{okText:u.default.t(1115),onOK:()=>n.default.closeModal()},u.default.t(1897,{count:d.default.MAX_SMB_LABEL_COUNT}))):n.default.openModal(r.createElement(l.default,{onAddLabel:this.onAddLabel,onCancel:n.default.closeModal()}))},this.onUpdateLabel=(e,t)=>{h.default.updateLabel(e,t)},this.openLabelColorDrawer=(e,t)=>{this.push(r.createElement(p.default,{labelId:e,onClose:this._pop,onUpdateColor:this.onUpdateLabel,currentColor:t}))},this._pop=()=>{this.pop()}}componentDidMount(){this.push(r.createElement(f.default,{onDeleteLabel:this.onDeleteLabel,onLabelClick:this.onLabelClick,onClose:this._pop,openAddLabel:this.openAddLabel}))}onAddLabel(e,t){h.default.addNewLabel(e,t)}onRemoveLabel(e,t){h.default.addOrRemoveLabels([{id:e,type:"remove"}],t)}}t.default=v},25198:(e,t,a)=>{"use strict";var s=a(14859),i=a(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(a(2784)),l=s(a(98473)),n=s(a(62820)),o=s(a(13277)),d=s(a(76176)),c=s(a(23045)),u=s(a(94751)),h=s(a(38637)),p=s(a(62345)),f=a(30380),m=s(a(4770)),v=s(a(84161));class g extends u.default{constructor(...e){super(...e),this._newlyAddedLabels=new Set,this._logWamEvent=()=>{var e=this.props.modelsToUpdate.length;this._labelViewType=1===e?this.props.modelsToUpdate[0]instanceof n.default?v.default.LABEL_TARGETS.LABEL_CHAT_DIALOG:v.default.LABEL_TARGETS.LABEL_MESSAGE_DIALOG:v.default.LABEL_TARGETS.LABEL_COMBINED_DIALOG,(0,f.logLabelOperationEvent)(v.default.LABEL_OPERATIONS.VIEW,e,this._labelViewType)},this.onLabelUpdateComplete=()=>{this.props.onLabelUpdateComplete&&this.props.onLabelUpdateComplete(),this._pop()},this.onAddLabel=(e,t)=>{p.default.addNewLabel(e,t).then((()=>{this._newlyAddedLabels.add(e)}))},this.shouldScrollIntoViewAndSelect=e=>this._newlyAddedLabels.has(e)?(this._newlyAddedLabels.delete(e),{shouldScrollIntoView:!0,shouldSelect:!0}):{shouldScrollIntoView:!1,shouldSelect:!1},this.onAddNewLabel=()=>{p.default.toArray().length>=c.default.MAX_SMB_LABEL_COUNT?o.default.openModal(r.createElement(d.default,{okText:h.default.t(1115),onOK:()=>o.default.closeModal()},h.default.t(1897,{count:c.default.MAX_SMB_LABEL_COUNT}))):this.push(r.createElement(l.default,{onAddLabel:this.onAddLabel,onCancel:this._pop}))},this._popAndLogEvent=()=>{this._labelViewType&&(0,f.logLabelOperationEvent)(v.default.LABEL_OPERATIONS.CLICK_NEGATIVE,this.props.modelsToUpdate.length,this._labelViewType),this.pop()},this._pop=()=>{this.pop()}}componentDidMount(){this._logWamEvent(),this.push(r.createElement(m.default,{shouldScrollIntoViewAndSelect:this.shouldScrollIntoViewAndSelect,onAddNewLabel:this.onAddNewLabel,onLabelUpdateComplete:this.onLabelUpdateComplete,onCancel:this._popAndLogEvent,modelsToUpdate:this.props.modelsToUpdate}))}}t.default=g,g.defaultProps={removeTopDrawer:!0,pushTransition:"none",popTransition:"none"}},11400:(e,t,a)=>{"use strict";var s=a(14859),i=a(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(a(2784)),l=s(a(85030)),n=s(a(13277)),o=s(a(43805)),d=s(a(74598)),c=s(a(94751)),u=s(a(38637)),h=s(a(93156)),p=s(a(46183));class f extends c.default{constructor(...e){super(...e),this.onClick=(e,t)=>{l.default.find(t.id).then(n.default.openChatFromUnread.bind(n.default)),this.end()},this.onNewGroup=()=>{this.push(r.createElement(p.default,{onBack:this.pop,onContinue:this.onSetGroupInfo}))},this.onSetGroupInfo=e=>{this.push(r.createElement(h.default,{participants:e,onBack:()=>{this.popAndUpdate({participants:e})},onContinue:this.end}))}}componentDidMount(){o.default.ensureSorted(),this.push(r.createElement(d.default,{title:u.default.t(1089),onBack:this.end,onClick:this.onClick,onNewGroup:this.onNewGroup}))}}t.default=f},82356:(e,t,a)=>{"use strict";var s=a(14859),i=a(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(a(2784)),l=s(a(43805)),n=s(a(94751)),o=s(a(93156)),d=s(a(46183));class c extends n.default{constructor(...e){super(...e),this.onSetGroupInfo=e=>{this.push(r.createElement(o.default,{participants:e,onBack:()=>{this.popAndUpdate({participants:e})},onContinue:this.end}))}}componentDidMount(){l.default.ensureSorted(),this.push(r.createElement(d.default,{onBack:this.end,onContinue:this.onSetGroupInfo}))}}t.default=c},55693:(e,t,a)=>{"use strict";var s=a(93291),i=a(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=L;var r=i(a(58527)),l=i(a(52954)),n=s(a(2784)),o=i(a(65017)),d=a(79930),c=i(a(38024)),u=i(a(45411)),h=i(a(58322)),p=i(a(43805)),f=i(a(84755)),m=i(a(94751)),v=a(9690),g=a(57934),E=i(a(91915)),_=a(55439),C=i(a(85387)),S=i(a(3956)),y=i(a(13692)),I=i(a(82773)),M=i(a(91934)),P=a(25054);class T extends m.default{constructor(...e){var t;super(...e),t=this,this.scrollOffset=0,this.setScrollOffset=e=>{this.scrollOffset=e},this.onCollectionSeeAll=e=>{this.push(n.createElement(L,{chat:this.props.chat,catalogOwnerJid:this.props.catalogOwnerJid,collection:e,isAllItems:!e}))},this._pushProductDetails=e=>{var{chat:t,refreshCarousel:a}=this.props,s=n.createElement(C.default,{chat:t,product:e,onEnd:this._end,onBack:this._popAndUpdate,onProductDetail:this.onProductDetail,onProductCatalog:this.onProductCatalogHeaderClick,onProductLinkClick:this._onProductLinkClick,refreshCarousel:a,onCartClick:this._onCartClick});this.push(s)},this._pushProductDetailsWithDeepLink=e=>{var t=n.createElement(S.default,{chat:this.props.chat,productInfo:e,onEnd:this._end,onBack:this._pop,onProductDetail:this.onProductDetail,onProductCatalog:this.onProductCatalogHeaderClick,onProductLinkClick:this._onProductLinkClick,onCartClick:this._onCartClick});this.push(t)},this.pushProductCatalog=function(){var e=(0,l.default)((function*(e){var a=p.default.gadd(e),s=yield o.default.find(e),i=(0,v.canViewCollections)()?n.createElement(u.default,{contact:a,onProductDetail:t.onProductDetail,catalogId:e,onBack:t._pop,businessProfile:s,scrollOffset:t.scrollOffset,setScrollOffset:t.setScrollOffset,onCatalogLinkClick:t._onCatalogLinkClick,onCartClick:t._onCartClick,onCollectionSeeAll:t.onCollectionSeeAll}):n.createElement(I.default,{contact:a,onProductDetail:t.onProductDetail,catalogId:e,onBack:t._pop,businessProfile:s,setScrollOffset:t.setScrollOffset,onCatalogLinkClick:t._onCatalogLinkClick,onCartClick:t._onCartClick});t.push(i)}));return function(){return e.apply(this,arguments)}}(),this._pushOrderDetail=(e,t,a,s)=>{var i=n.createElement(E.default,{orderId:e,token:t,sellerJid:a,userIsCartOwner:s,onProductDetail:this._onProductDetailFromInfo});this.push(i)},this._pushProductList=(e,t)=>{var a=p.default.gadd(t),s=n.createElement(M.default,{contact:a,productListId:e,onProductDetail:this.onProductDetail,onCartClick:this._onCartClick,onBack:this._pop,onEnd:this._end,setScrollOffset:this.setScrollOffset});this.push(s)},this.onProductDetail=e=>{this._pushProductDetails(e)},this._onProductDetailFromInfo=e=>{this._pushProductDetailsWithDeepLink(e)},this.onProductCatalogHeaderClick=(e,t)=>{(0,g.logCarouselViewMoreClick)({catalogOwnerWid:e,catalogContext:t}),this.pushProductCatalog(e)},this._onProductLinkClick=e=>{this.push(n.createElement(y.default,{product:e,onBack:this._pop}))},this._onCatalogLinkClick=(e,t)=>{this.push(n.createElement(c.default,{catalog:e,contact:t,onBack:this._pop}))},this._onCartClick=e=>{var t=(0,_.getProductCatalogContext)(this.props.context),a=(0,d.showCart)(e,this.props.chat,t);a&&this.push(a)},this._pop=()=>{this.pop()},this._end=()=>{this.end(!0)},this._popAndUpdate=()=>{this.popAndUpdate({scrollOffset:this.scrollOffset})}}componentDidMount(){var{catalogOwnerJid:e,orderId:t,product:a,productInfo:s,productListId:i,collection:r,isAllItems:l}=this.props;if(e)r||l?this.pushCollectionContent((0,P.createWid)(e)):null!=i?this._pushProductList(i,(0,P.createWid)(e)):this.pushProductCatalog((0,P.createWid)(e));else if(a)this._pushProductDetails(a);else if(s)this._pushProductDetailsWithDeepLink(s);else{if(!t)throw new Error("ProductDetailsFlow:no-product");var{token:n,sellerJid:o,userIsCartOwner:d}=this.props;null!=n&&null!=o&&null!=d&&this._pushOrderDetail(t,n,o,d)}}pushCollectionContent(e){var t=p.default.gadd(e);this.push(n.createElement(h.default,{contact:t,onProductDetail:this.onProductDetail,catalogId:e,onBack:this._pop,onCatalogLinkClick:this._onCatalogLinkClick,onCartClick:this._onCartClick,scrollOffset:this.scrollOffset,setScrollOffset:this.setScrollOffset,collection:this.props.collection}))}}function L(e){var t=(0,n.useContext)(f.default);return n.createElement(T,(0,r.default)({context:t},e))}L.displayName="ProductDetailsFlow"},36194:(e,t,a)=>{"use strict";var s=a(93291),i=a(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(a(58527)),l=s(a(2784)),n=i(a(94751)),o=i(a(38637)),d=s(a(55231)),c=i(a(95877)),u=i(a(54559));class h extends n.default{constructor(...e){super(...e),this._handleForwardConfirmed=e=>{0===e.length&&this.end(),this._chatsToForwardTo=e,this._sendContactToChats(e)},this._sendContactToChats=e=>{for(var t of e)(0,c.default)(this.props.contacts,t),t.composeQuotedMsg=null;this.props.onContactsSent(e[0]),this.end()},this._popNone=()=>{this.pop("none")},this._handleCancel=()=>{this.end()}}componentDidMount(){var e=null==this.props.maxItems?this.props.serverProps.maxParticipants:this.props.maxItems;this.push(l.createElement(d.default,{onConfirm:this._handleForwardConfirmed,maxItems:e,title:o.default.t(1277),listType:d.ListType.CHAT_SELECT_MODAL,onCancel:this._handleCancel}))}}t.default=e=>l.createElement(h,(0,r.default)({},e,{serverProps:u.default}))},59648:(e,t,a)=>{"use strict";var s=a(14859),i=a(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=d;var r=i(a(2784)),l=s(a(38637)),n=s(a(21830)),o=s(a(73041));function d(e){var{chat:t}=e,a=(0,n.default)(t.groupMetadata.groupInviteLink,"chat.groupMetadata.groupInviteLink"),s=`${l.default.t(757)} ${a}`;return r.createElement(o.default,{title:l.default.t(742),text:s,pushTransition:"none",popTransition:"none"})}d.displayName="SendGroupInviteFlow"},84189:(e,t,a)=>{"use strict";var s=a(93291),i=a(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(a(58527)),l=s(a(2784)),n=a(25559),o=i(a(13277)),d=i(a(94751)),c=i(a(38637)),u=s(a(55231)),h=a(24256),p=i(a(54559));class f extends d.default{constructor(...e){super(...e),this.onForwardConfirmed=e=>{var t=this.props.msgText;if(1===e.length){var a=e[0];(a.isUser&&a.contact.isBlocked()?(0,n.unblockContact)(a.contact):Promise.resolve(!0)).then((()=>{if(t){if(a.urlText=this.props.urlText,a.active)return void o.default.pasteChatTextInput(a,t);a.setComposeContents({text:t})}return o.default.openChatFromUnread(a).then((e=>{e&&o.default.focusChatTextInput(a)}))}))}else Promise.all(e.map((e=>{(e.isUser&&e.contact.isBlocked()?(0,n.unblockContact)(e.contact):Promise.resolve(!0)).then((()=>{e.urlText=this.props.urlText,(0,h.sendTextMsgToChat)(e,t)}))}))),o.default.openChatFromUnread(e[0]);this.end()}}componentDidMount(){this.push(l.createElement(u.default,{onConfirm:this.onForwardConfirmed,maxItems:this.props.serverProps.multicastLimitGlobal,title:c.default.t(999),listType:u.ListType.CHAT_SELECT_MODAL}))}}t.default=e=>l.createElement(f,(0,r.default)({},e,{serverProps:p.default}))},65156:(e,t,a)=>{"use strict";var s=a(93291),i=a(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(a(52954)),l=s(a(2784)),n=a(25559),o=i(a(13277)),d=i(a(23045)),c=i(a(94751)),u=i(a(38637)),h=s(a(55231)),p=i(a(54559));class f extends c.default{constructor(...e){var t;super(...e),t=this,this._handleForwardConfirmed=e=>{e.forEach(function(){var e=(0,r.default)((function*(e){e.isUser&&e.contact.isBlocked()&&(yield(0,n.unblockContact)(e.contact)),t._sendProduct(e)}));return function(){return e.apply(this,arguments)}}()),this.end(),1===e.length&&(o.default.openChatFromUnread(e[0]),window.innerWidth<=d.default.LAYOUT_2COLUMNS_MAX_WIDTH&&o.default.closeDrawerRight()),this.props.onSend&&this.props.onSend()},this._handleCancel=()=>{this.end()},this._sendProduct=e=>{var{product:t}=this.props;o.default.once("ui_idle",(()=>{e.sendProductMessage(t)}))}}componentDidMount(){o.default.closeContextMenu(),o.default.closeTooltip(),this.push(l.createElement(h.default,{onConfirm:this._handleForwardConfirmed,maxItems:p.default.multicastLimitGlobal,title:u.default.t(999),listType:h.ListType.CHAT_SELECT_MODAL,onCancel:this._handleCancel}))}}t.default=f},80929:(e,t,a)=>{"use strict";var s=a(14859),i=a(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(a(2784)),l=s(a(65236)),n=s(a(44956)),o=i(a(2537)),d=s(a(13277)),c=s(a(79435)),u=s(a(43805)),h=s(a(94751)),p=a(66239),f=s(a(26805)),m=s(a(1237)),v=s(a(13087)),g=s(a(60912)),E=s(a(93562)),_=s(a(34749)),C=s(a(77953)),S=s(a(48514)),y=s(a(63985)),I=s(a(4643)),M=s(a(11537));class P extends h.default{constructor(...e){super(...e),this._showWallpaperDrawer=()=>{this.push(r.createElement(I.default,{onClose:this._pop}))},this._showArchiveSettingsDrawer=()=>{this.push(r.createElement(l.default,{settings:_.default,onClose:this._pop}))},this._showBlockedDrawer=()=>{this.push(r.createElement(n.default,{onClose:this._pop}))},this._showProfileDrawer=()=>{var e=(0,p.getMaybeMeUser)(),t=S.default.assertGet(e),a=E.default.assertGet(e),s=u.default.assertGet(e);this.push(r.createElement(g.default,{status:t,profilePicThumb:a,contact:s,conn:c.default,onClose:this._pop}))},this._showNotifications=()=>{this.push(r.createElement(v.default,{onClose:this._pop}))},this._showSecurity=()=>{this.push(r.createElement(M.default,{onClose:this._pop}))},this._showHelp=()=>{o.upload({reason:"help-page-opened",isHighPri:!0}),this.push(r.createElement(f.default,{onClose:this._pop}))},this._showThemePopup=()=>{d.default.openModal(r.createElement(y.default,null))},this.showKeyboardShortcuts=()=>{d.default.openModal(r.createElement(m.default,null))},this._pop=()=>{this.pop()}}componentDidMount(){this.push(r.createElement(C.default,{profileId:(0,p.getMaybeMeUser)(),onWallpaper:this._showWallpaperDrawer,onBlocked:this._showBlockedDrawer,onProfile:this._showProfileDrawer,onNotifications:this._showNotifications,onSecurity:this._showSecurity,onHelp:this._showHelp,onThemeSettings:this._showThemePopup,onKeyboardShortcuts:this.showKeyboardShortcuts,onClose:this._pop,settings:_.default,onArchiveSettings:this._showArchiveSettingsDrawer}))}}t.default=P},11863:(e,t,a)=>{"use strict";var s=a(14859),i=a(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(a(2784)),l=s(a(13277)),n=s(a(94751)),o=s(a(4739)),d=s(a(33903)),c=s(a(33715));class u extends n.default{constructor(...e){super(...e),this.sessionId=Math.round(1e9*Math.random()),this._openStatusViewer=(e,t,a)=>{this.push(r.createElement(c.default,{initialStatusV3:e,initialStatusMsg:t,closeStatusViewer:this.closeStatusViewer,sessionId:this.sessionId,rowIdx:a}),"none")},this.closeStatusViewer=e=>{e?this.end():this.pop("none")}}componentDidMount(){this.push(r.createElement(d.default,{onOpenStatus:this._openStatusViewer,closeStatusViewer:this.closeStatusViewer,sessionId:this.sessionId}),"status-v3-modal"),this.props.listeners.add(l.default,"close_status_viewer",(()=>{this.closeStatusViewer(!0)}))}componentWillUnmount(){this.props.onFlowEnd()}}var h=(0,o.default)(u);t.default=h},98385:(e,t,a)=>{"use strict";var s=a(14859),i=a(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(a(2784)),l=s(a(78523)),n=s(a(30905)),o=a(9690),d=s(a(38637)),c=s(a(62345)),u=i(a(30520)),h=s(a(4739));class p extends r.PureComponent{constructor(...e){super(...e),this._updateLabels=()=>{this.forceUpdate()}}componentDidMount(){this.props.listeners.add(c.default,`label_updated_${this.props.label}`,this._updateLabels)}render(){var{label:e}=this.props,t=c.default.get(e);if(!t||!t.name)return null;if("label-list"===this.props.theme){var a=r.createElement(u.default,{renderAsCircle:"label-list"===this.props.theme,theme:this.props.theme,labels:[e]}),s=r.createElement(n.default,{text:t.name,ellipsify:!0,titlify:!0});return r.createElement(l.default,{theme:(0,o.canEditLabel)()?"chat-checkbox":void 0,image:a,primary:s,secondary:d.default.t(833,{count:parseInt(t.count||0,10),_plural:parseInt(t.count||0,10)})})}var i=(0,u.renderLabelSvg)(t.hexColor),h=r.createElement(n.default,{text:t.name,ellipsify:!0,titlify:!0});return r.createElement(l.default,{theme:"label-selection",image:i,primary:h})}}p.displayName="LabelListItem";var f=(0,h.default)(p);t.default=f},84568:(e,t,a)=>{"use strict";var s=a(14859),i=a(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(a(2784)),l=s(a(40664)),n=s(a(20468)),o=a(9690),d=s(a(62345)),c=s(a(98385)),u=s(a(4739)),h=s(a(32158));class p extends r.PureComponent{constructor(){super(),this._refLastLabel=null,this.updateData=(e,t,a)=>{var{shouldScrollIntoViewAndSelect:s}=this.props;this.setState({labels:d.default.toArray()},(()=>{if(a.add&&s){var{shouldScrollIntoView:t,shouldSelect:i}=s(e.name);t&&this._refLastLabel&&this._refLastLabel.scrollIntoView({behavior:"smooth"}),i&&this.onMultiSelect(e,!0,!1)}}))},this._setRefLastLabel=e=>{this._refLastLabel=e},this.onMultiSelect=(e,t,a)=>{var{selectedLabels:s,onMultiSelect:i}=this.props;s&&s.setVal(e,t,a),i&&i(e.id)},this._renderLabelRow=()=>{var{renderContext:e,onLabelClick:t,initialLabelState:a={}}=this.props,s=this.props.SelectableState||new h.default(!0),i=n.default.supportsFeature(n.default.F.MD_BACKEND)?[...this.state.labels].sort(((e,t)=>{var a=parseInt(e.id,10),s=parseInt(t.id,10);return isNaN(a)||isNaN(s)?0:a-s})):this.state.labels;return i.reduce(((n,u,h)=>{var p=d.default.assertGet(u.id);if(!u.name)return n;var f="label-selection"===e||(0,o.canEditLabel)()?r.createElement(l.default,{theme:e,model:p,initialSelection:a[u.id]||0,multiSelection:this.props.selectedLabels,selectableState:s,onSelect:this.onMultiSelect},r.createElement(c.default,{label:u.id})):r.createElement(c.default,{label:u.id,theme:e});return[...n,r.createElement("div",{key:`label_item_${u.id}`,ref:h===i.length-1?this._setRefLastLabel:()=>{},onClick:t?t.bind(null,u.id):()=>{}},f)]}),[])},this.state={labels:d.default.toArray()}}componentDidMount(){this.props.listeners.add(d.default,"add remove",this.updateData)}render(){return r.createElement("div",null,this._renderLabelRow())}}p.displayName="MultiSelectLabelList";var f=(0,u.default)(p);t.default=f},65688:(e,t,a)=>{"use strict";var s=a(14859);Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"LiveLocationDrawer",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(t,"ExpiredLocationDrawer",{enumerable:!0,get:function(){return r.default}});var i=s(a(53793)),r=s(a(1503))},310:(e,t,a)=>{"use strict";var s=a(14859),i=a(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.requireBundle=void 0;var r=i(a(2784)),l=s(a(89028)),n=s(a(23045)),o=s(a(38637)),d=s(a(98381)),c=(0,s(a(91163)).default)((()=>Promise.all([a.e(8295),a.e(1702),a.e(9488),a.e(275)]).then(a.bind(a,25655)).then((e=>e.default))),"ContactUsModal");t.requireBundle=c;var u=(0,l.default)({loader:c,loading:e=>r.createElement(d.default,{title:o.default.t(1350),okText:o.default.t(1280),error:Boolean(e.error)}),delay:n.default.LOADABLE_DELAY});t.default=u},26004:(e,t,a)=>{"use strict";var s=a(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(a(98537)),r=a(48537),l=s(a(22006));class n{constructor(e,t,a,s){this.updateEditData=e=>{this.saveEdits(),this.editData=(0,i.default)({},this.editData,e)},this.updateEditItems=(e,t)=>{this.saveEdits();var a=[];this.editData.items&&this.editData.items.forEach((e=>{e!==t&&a.push(e)})),a.push(e),this.editData.items=a},this.saveEdits=()=>{var e=new n(this.media,this.originalImage,this.editData,this.previous);this.previous=e},this.revertEdit=()=>{this.previous&&(this.editData=this.previous.editData,this.previous=this.previous.previous)},this.saveEditsFromCanvas=e=>{var t=e.toDataURL();this.editedImage||(this.editedImage=new Image),this.editedImage.src=t},this.exportEditedMedia=()=>{if(this.hasEdits()&&this.editedImage){var e=this.editedImage.src;return l.default.dataURLtoFile(e)}return this.media instanceof File?this.media:(0,r.createFile)([this.media],"",{type:this.media.type})},this.hasEdits=()=>!!this.previous&&this.editedImage,this.cleanUp=()=>{window.URL.revokeObjectURL(this.originalImage.src)},this.media=e,t?this.originalImage=t:(this.originalImage=new Image,this.originalImage.src=window.URL.createObjectURL(e)),this.previous=s,this.editData={height:0,width:0,offsetX:0,offsetY:0,rotation:0,scale:1,items:[],baseItem:null},(0,i.default)(this.editData,a)}}t.default=n},38965:(e,t,a)=>{"use strict";var s=a(14859),i=a(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.Component=void 0;var r=a(37426),l=i(a(2784)),n=s(a(23045)),o=i(a(64453)),d=s(a(4739)),c=s(a(32547)),u=s(a(18779)),h=1.1;class p extends l.Component{constructor(...e){super(...e),this._validateTranslate=(e,t)=>{var a=this.props.editedMedia.editData,s=(e-a.width/2)*a.scale,i=(e+a.width/2)*a.scale,r=(t+a.height/2)*a.scale,l=(t-a.height/2)*a.scale;return{x:s<-this._cropRadius&&i>this._cropRadius,y:l<-this._cropRadius&&r>this._cropRadius}},this._validateScale=e=>{var t=this.props.editedMedia.editData,a=Math.max(2*this._cropRadius/t.width,2*this._cropRadius/t.height),s=Math.max(e,a);if(t.width*e<this._cropRadius||t.height*e<this._cropRadius)return!1;var i=-this._cropRadius/s+t.width/2,r=this._cropRadius/s-t.width/2,l=-this._cropRadius/s+t.height/2,n=this._cropRadius/s-t.height/2;return{scale:s,offsetX:Math.min(Math.max(t.offsetX,r),i),offsetY:Math.min(Math.max(t.offsetY,n),l)}},this._onPressMove=(e,t)=>{var a=this.props.editedMedia.editData,s=e.stageX-t.x,i=e.stageY-t.y,r=a.offsetX+s/a.scale,l=a.offsetY+i/a.scale,n=this._validateTranslate(r,l);n.x&&(a.offsetX=r),n.y&&(a.offsetY=l),t.x=e.stageX,t.y=e.stageY,this.props.drawCanvas()},this._onEnlarge=(e=1.1)=>{var t=this.props.editedMedia.editData,a=0!==e?e:h,s=this._validateScale(t.scale*a);s&&(t.scale=s.scale,t.offsetX=s.offsetX,t.offsetY=s.offsetY,this.props.drawCanvas())},this._onReduce=(e=1.1)=>{var t=this.props.editedMedia.editData,a=0!==e?e:h,s=this._validateScale(t.scale/a);s&&(t.scale=s.scale,t.offsetX=s.offsetX,t.offsetY=s.offsetY,this.props.drawCanvas())},this.crop=()=>{var e,t=this.props.editedMedia,a=t.editData,s=t.editedImage&&t.editedImage.src;if(!s)return Promise.reject("empty image");var i=2*this._cropRadius,r=i;return i>n.default.MAX_PIC_SIDE?r=n.default.MAX_PIC_SIDE:i<n.default.MIN_PIC_SIDE&&(r=n.default.MIN_PIC_SIDE),o.crop(s,(a.width-2*this._cropRadius)/2,(a.height-2*this._cropRadius)/2,2*this._cropRadius,2*this._cropRadius,r,r,o.DATA_URL|o.CANVAS).then((({images:t})=>(e=t.dataUrl,o.crop(t.canvas,0,0,n.default.PROF_PIC_THUMB_SIDE,n.default.PROF_PIC_THUMB_SIDE)))).then((({images:t})=>({thumb:t.dataUrl,full:e})))}}render(){return l.createElement("div",{className:c.default.scaler},l.createElement("div",{className:c.default.scalerButton,onClick:()=>{this._onEnlarge()}},l.createElement(u.default,{name:"plus"})),l.createElement("div",{className:c.default.scalerButton,onClick:()=>{this._onReduce()}},l.createElement(u.default,{name:"minus"})))}componentDidMount(){this.props.editedMedia.saveEdits();var e,t=this.props.editedMedia.editData,a=this.props.cropOverlay,s=a.canvas;e=t.baseItem?t.baseItem.getBounds():{width:0,height:0},s.style.display="block",s.width=e.width,s.height=e.height;var i=new r.Easel.Shape;i.graphics.beginFill("rgba(0, 0, 0, 0.1)"),i.graphics.drawRect(0,0,e.width,e.height),i.regX=e.width/2,i.regY=e.height/2,i.x=e.width/2,i.y=e.height/2,i.on("mousedown",(e=>{var t={x:e.stageX,y:e.stageY},a=i.on("pressmove",this._onPressMove,null,!1,t);i.on("pressup",(()=>{i.off("pressmove",a)}),null,!0)})),i.cursor="move",this.props.listeners.add(s,"mousewheel",(e=>{e.deltaY>0?this._onEnlarge(1.02):this._onReduce(1.02)}));var l=s.getContext("2d"),n=s.width,o=s.height,d=n/o>500/361?o/361:n/500;this._cropRadius=Math.min(361,500)/2*.9*d,l.fillStyle="rgba(0, 0, 0, 0.5)",l.fillRect(0,0,n,o),l.globalCompositeOperation="destination-out",l.beginPath(),l.arc(n/2,o/2,this._cropRadius,0,2*Math.PI,!0),l.fillStyle="#ffffff",l.fill(),a.addChild(i),a.update()}}p.displayName="ProfileCropTool";var f=p;t.Component=f;var m=(0,d.default)(p);t.default=m},98473:(e,t,a)=>{"use strict";var s=a(14859),i=a(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(a(2784)),l=s(a(15081)),n=s(a(13277)),o=s(a(76176)),d=s(a(23045)),c=s(a(38637)),u=a(6420),h=i(a(62345)),p=a(30380),f=a(30520),m=s(a(84161)),v=s(a(68267)),g=s(a(92915));class E extends r.Component{constructor(e){super(e),this._labelModel=null,this.onOk=()=>{var{labelName:e,labelColor:t,labelNameError:a}=this.state;if(!a){(0,p.logLabelOperationEvent)(m.default.LABEL_OPERATIONS.CLICK_POSITIVE,1,this.props.onAddLabel?m.default.LABEL_TARGETS.ADD_LABEL_DIALOG:m.default.LABEL_TARGETS.EDIT_LABEL_DIALOG);var s=e&&e.trim(),i=this._validateLabelName(s||"");i.passed?(this.props.labelId&&this.props.onUpdateLabel?this.props.onUpdateLabel({id:this.props.labelId,color:t,name:e},h.LABEL_PROPERTIES.NAME):this.props.onAddLabel&&this.props.onAddLabel(e||"",t),this.props.onCancel?this.props.onCancel():n.default.closeModal()):this.setState({labelNameError:i.error})}},this.onCancel=()=>{(0,p.logLabelOperationEvent)(m.default.LABEL_OPERATIONS.CLICK_NEGATIVE,1,this.props.onAddLabel?m.default.LABEL_TARGETS.ADD_LABEL_DIALOG:m.default.LABEL_TARGETS.EDIT_LABEL_DIALOG),this.props.onCancel?this.props.onCancel():n.default.closeModal()},this._onLabelNameChange=e=>{var t=this._validateLabelName(e);this.setState({labelName:e,labelNameError:t.passed?void 0:t.error})},this._validateLabelName=e=>{var t=!0,a=null;return e&&""!==e.trim()||(t=!1),this._labelModel&&this._labelModel.name===e||0===h.default.where({name:e}).length||(t=!1,a=c.default.t(215)),{passed:t,error:a}},this._handleKeyEnter=e=>{e.stopPropagation(),this.onOk()},this.props.labelId&&(this._labelModel=h.default.assertGet(this.props.labelId)),this.state={labelColor:this._labelModel&&this._labelModel.color||void 0,labelName:this._labelModel&&this._labelModel.name||"",labelNameError:void 0}}componentDidMount(){this.props.onAddLabel?(h.default.getNewLabelColor().then((e=>{this.setState({labelColor:e||d.default.DEFAULT_SMB__NEW_LABEL_COLOR})})),(0,p.logLabelOperationEvent)(m.default.LABEL_OPERATIONS.VIEW,1,m.default.LABEL_TARGETS.ADD_LABEL_DIALOG)):this.props.onUpdateLabel&&(0,p.logLabelOperationEvent)(m.default.LABEL_OPERATIONS.VIEW,1,m.default.LABEL_TARGETS.EDIT_LABEL_DIALOG)}render(){var e=!this._validateLabelName(this.state.labelName.trim()).passed;return r.createElement(o.default,{title:this.props.onUpdateLabel?c.default.t(572):c.default.t(218),okText:c.default.t(1738),onOK:this.onOk,okDisabled:e,onCancel:this.onCancel},r.createElement("div",{className:l.default.inputContainer},r.createElement("div",{className:l.default.label},this.state.labelColor?(0,f.renderLabelSvg)((0,u.intColorToHex)(this.state.labelColor)):r.createElement(v.default,{stroke:5,size:20})),r.createElement("div",{className:l.default.input},r.createElement(g.default,{a8n:"add-new-label-name-input",focusOnMount:!0,hideFloatingLabel:!0,showRemaining:!0,supportsEmoji:!0,value:this.state.labelName,error:this.state.labelNameError,maxLength:d.default.SMB_LABELS.MAX_LABEL_LENGTH,onChange:this._onLabelNameChange,onEnter:this._handleKeyEnter,placeholder:c.default.t(217)}))))}}t.default=E,E.displayName="AddOrEditLabelPopup"},13e3:(e,t,a)=>{"use strict";var s=a(14859),i=a(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(a(2784)),l=s(a(13277)),n=s(a(76176)),o=s(a(23045)),d=a(33576),c=s(a(4170)),u=s(a(38637)),h=a(57934),p=a(42643),f=a(27582),m=a(74315),v=s(a(92915)),g=i(a(97025));class E extends r.PureComponent{constructor(...e){super(...e),this.state={isSubmitting:!1,submitted:!1,reason:""},this._onInputChange=e=>{this.setState({reason:e})},this._handleOk=()=>{var{product:e,sessionId:t}=this.props;(0,h.logAppealProductCatalogClick)(t),this.setState({isSubmitting:!0}),(0,p.appealProduct)(e.id.toString(),this.state.reason).then((()=>{e.canAppeal=!1,e.reviewStatus=f.PRODUCT_REVIEW_STATUS.PENDING,(0,h.logAppealProductCatalogSuccess)(t),this.setState({isSubmitting:!1,submitted:!0})})).catchType(d.ServerStatusCodeError,(e=>{l.default.openToast(r.createElement(g.default,{msg:u.default.t(376),id:(0,g.genId)("catalog_appeal_submission_failed")})),(0,h.logAppealProductCatalogFailed)(t,e.status),this.setState({isSubmitting:!1})}))},this._handleCancel=()=>{l.default.closeModal()}}render(){var{submitted:e,isSubmitting:t,reason:a}=this.state;return e?r.createElement(n.default,{title:u.default.t(1227),onOK:this._handleCancel},r.createElement(m.TextDiv,null,u.default.t(400))):r.createElement(n.default,{title:u.default.t(1227),onOK:this._handleOk,onCancel:this._handleCancel,okDisabled:t},r.createElement("form",null,r.createElement(v.default,{a8n:"confirm-popup-text-input",placeholder:u.default.t(840),onChange:this._onInputChange,value:a,maxLength:1e3}),r.createElement(c.default,{href:o.default.WA_COMMERCE_POLICY_URL},u.default.t(844))))}}t.default=E,E.displayName="AppealProductPopup"},19303:(e,t,a)=>{"use strict";var s=a(93291),i=a(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(a(72779)),l=s(a(2784)),n=a(25713),o=i(a(55672)),d=i(a(35365)),c=i(a(26713)),u=i(a(70368)),h=i(a(14202)),p=i(a(47729)),f=i(a(99479)),m=i(a(10145)),v=i(a(30430)),g=i(a(13277)),E=i(a(76176)),_=i(a(23045)),C=i(a(21941)),S=i(a(71699)),y=i(a(3123)),I=i(a(96881)),M=s(a(32597)),P=a(15740),T=s(a(24461)),L=a(48537),b=i(a(18792)),N=i(a(19058)),D=i(a(38637)),w=i(a(4739)),O=i(a(9962)),k=i(a(84161)),R=a(6353),A=i(a(85185)),x=i(a(19432)),F=i(a(54559)),U=i(a(68267)),B=i(a(18779)),G=s(a(97025)),H=i(a(82838)),{IMAGE:V,VIDEO:j,DOCUMENT:W,AUDIO:K}=_.default.MSG_TYPE,{PROCESSING:z}=n.ATTACH_MEDIA_STATE;class q extends l.Component{static getDerivedStateFromProps(e,t){var a=e.mediaCollection.getActive(),s=e.initCaption&&e.initCaption.text,i=t.isInitCaptionUsed;return i||t.activeMedia||!s||!a||a.type!==V&&a.type!==j||(a.caption=s,i=!0),{prevActiveMedia:t.activeMedia,activeMedia:a,isInitCaptionUsed:i}}constructor(e){super(e),this._attachMediaRefMap=new Map,this.setRefContainer=e=>{this.refContainer=e},this.setRefInput=e=>{this.refInput=e},this._setAttachMediaRef=(e,t)=>{this._attachMediaRefMap.set(e,t)},this._onMediaProcessUpdate=()=>{var{mediaCollection:e}=this.props;if(e.canSend()){clearTimeout(this._mediaProcessTimer),this._mediaProcessTimer=null,this.setState({showLoadingState:!1});var{errorMsgs:t}=e.uiProcessMsgs(),a=e.getPreviewableMedias();t&&a.length>0&&g.default.openToast(l.createElement(G.default,{msg:t,id:(0,G.genId)()})),this.forceUpdate()}else this._mediaProcessTimer||(this._mediaProcessTimer=setTimeout((()=>{this._mediaProcessTimer=null,this.setState({showLoadingState:!0})}),500))},this._onFilesNotSupported=()=>{var e=this.props.mediaCollection.filter((e=>e.exception));e.length>0&&this.props.onFailedMedias(e)},this._showIgnoredToast=e=>{if(e>0){var t=D.default.t(1375,{number:e,_plural:e});g.default.openToast(l.createElement(G.default,{msg:t,id:(0,G.genId)()}))}},this.onDrop=e=>{this.state.isViewOnce||this.onFilePick(e)},this.onDragLeave=()=>{this.props.mediaCollection.length||this.props.onBack()},this.onDragChange=(e,t)=>{this.state.isViewOnce||(this.setState({isDragging:e}),e||t||this.props.mediaCollection.length||this.props.onBack())},this.onEnter=e=>{this.state.activeMedia&&(e.repeat||e.shiftKey||this.onSend())},this._onArrowLeft=e=>{if(this.state.activeMedia&&!e.repeat){var t=this.state.activeMedia&&!this.state.activeMedia.caption,a=this.refCaptionInput&&this.refCaptionInput.refInput;(t||a&&!a.isFocused()||a&&a.cursorIsAtStart())&&this.onPrev()}},this._onArrowRight=e=>{if(this.state.activeMedia&&!e.repeat){var t=this.state.activeMedia&&!this.state.activeMedia.caption,a=this.refCaptionInput&&this.refCaptionInput.refInput;(t||a&&!a.isFocused()||a&&a.cursorIsAtEnd())&&this.onNext()}},this.onNext=()=>{this.props.mediaCollection.setNextAsActive()&&(this._refSendButton&&b.default.focus(this._refSendButton),this._scrollIntoView())},this.onPrev=()=>{this.props.mediaCollection.setPrevAsActive()&&(this._refSendButton&&b.default.focus(this._refSendButton),this._scrollIntoView())},this._scrollIntoView=()=>{var e=this.props.mediaCollection.getActive();if(e){var t=this._attachMediaRefMap.get(e.id);t&&t.scrollIntoView()}},this.onSelectThumb=e=>{this.props.mediaCollection.setActive(e)},this.onSend=e=>{e&&e.preventDefault(),e&&e.shiftKey||this.props.mediaCollection.canSend()&&Promise.all([]).then((()=>{var e=this.props.mediaCollection.getPreviewableMedias();if(0!==e.length){var t=e.map((e=>{var t=e.caption,a=[],s=this.refCaptionInput&&this.refCaptionInput.refInput;if(t&&s){var i=s.serialize(t),[r,l]=[i[0].trim(),i[1]];r.length&&(t=r,a=l.mentionedJidList||[])}return e.caption=t||void 0,{media:e,mentionedJidList:a}}));this.props.onSendMedia(t,this.state.isInitCaptionUsed,this.state.isViewOnce)}}))},this.onAddFileClick=()=>{this.refInput&&this.refInput.click()},this.onFilePick=e=>{(0,P.getFiles)(e).then((e=>this.props.mediaCollection.processAttachments(e.map((e=>({file:e}))),k.default.MEDIA_PICKER_ORIGIN_TYPE.CHAT_PHOTO_LIBRARY))).checkpoint(this.props.rejectOnUnmount()).catchType(T.Unmount,(()=>{})).catchType(T.MediaDragDropError,(e=>{this.props.mediaCollection.length||this.props.onDropText(e.src)})),e.target&&e.target.value&&(e.target.value="")},this._onRemoveThumb=(e,t)=>{t.stopPropagation(),t.preventDefault(),this.props.mediaCollection.remove(e),0===this.props.mediaCollection.getValidMedias().length?this._delayedClose=setTimeout((()=>{this.props.onBack()}),200):this._refSendButton&&b.default.focus(this._refSendButton)},this.onCaptionChange=e=>{var{activeMedia:t,isInitCaptionUsed:a}=this.state;if(t){var s=this.props.mediaCollection.indexOf(t);t.caption=e,0===s&&""===e&&a?this.setState({isInitCaptionUsed:!1}):this.forceUpdate()}},this.onPaste=e=>{e.preventDefault(),e.stopPropagation();var t=new C.default(e.clipboardData);t.hasFiles()&&this.onFiles(t)},this.onFiles=e=>{var t=e.getFiles().filter((e=>{var t=(0,L.typeFromMimetype)(e.type);return"image"===t||"video"===t})).map((e=>({file:e})));this.props.mediaCollection.processAttachments(t,k.default.MEDIA_PICKER_ORIGIN_TYPE.PASTE)},this._onViewOnceChange=e=>{this.setState({isViewOnce:e})},this.setRefCaptionInput=e=>{this.state.activeMedia&&!e||(this.refCaptionInput=e)},this._canViewOnce=()=>{var e,{mediaCollection:t}=this.props;return F.default.viewOnceWrite&&1===t.length&&!0===(null===(e=t.at(0))||void 0===e?void 0:e.isViewableOnce())},this._getMedia=e=>{var t,a,s;switch(e.type){case V:case j:t||(t=l.createElement(p.default,{mimeType:e.mimetype,url:e.fullPreview,isGif:e.isGif,size:e.fullPreviewSize,processing:e.state===z,preview:e.preview})),a=l.createElement("div",{className:o.default.captionInput,"data-animate-media-caption":!0},l.createElement(O.default,{ref:this.setRefCaptionInput,value:e.caption,placeholder:D.default.t(204),maxLength:_.default.MAX_CAPTION_LENGTH,onEnter:this.onSend,onChange:this.onCaptionChange,onFiles:this.onFiles,chat:this.props.chat,showRemaining:!0,spellCheck:!0,multiline:!0,supportsEmoji:!0}),this._canViewOnce()?l.createElement(m.default,{isOn:this.state.isViewOnce,mediaType:e.type,onChange:this._onViewOnceChange}):null);break;case K:t=l.createElement(c.default,{mimeType:e.mimetype,url:e.fullPreview});break;case W:switch((0,R.previewType)(e.mimetype)){case"pdf":t=l.createElement(f.default,{fullPreview:e.fullPreview,fullPreviewSize:e.fullPreviewSize,pageCount:e.documentPageCount,mimeType:e.mimetype,filename:e.filename});break;case"msoffice":t=l.createElement(u.default,{fullPreview:e.fullPreview,fullPreviewSize:e.fullPreviewSize,mimeType:e.mimetype,filename:e.filename});break;default:t=l.createElement(h.default,{mimeType:e.mimetype,filename:e.filename})}}return"image/gif"===e.originalMimetype&&(s=l.createElement("div",{className:o.default.mediaWarning,"data-animate-attach-media":!0},D.default.t(930)," ",l.createElement(v.default,{onClick:this._onWarningCtaClick},D.default.t(844)))),l.createElement("div",{className:o.default.mediaBody,key:e.id},t,s,a)},this._onWarningCtaClick=e=>{e.preventDefault(),g.default.openModal(l.createElement(E.default,{onOK:()=>g.default.closeModal()},D.default.t(698)))},this.getThumbs=e=>e.map((e=>l.createElement(d.default,{id:e.id,key:"media-"+e.id,active:e===this.state.activeMedia,attachMedia:e,onClick:this.onSelectThumb,onClose:this._onRemoveThumb,onRef:this._setAttachMediaRef}))),this._setRefSendButton=e=>{this._refSendButton=e},this.state={activeMedia:null,prevActiveMedia:null,isDragging:!1,isInitCaptionUsed:!1,isViewOnce:!1,showLoadingState:!1}}componentDidMount(){var{mediaCollection:e,listeners:t}=this.props;t.add(e,"add remove reset",(()=>{this.forceUpdate()})),t.add(e,"active-change change:state change:previewable",this._onMediaProcessUpdate),t.add(e,"files_not_supported",this._onFilesNotSupported),t.add(e,"max_upload_limit",this._showIgnoredToast),e.mediaPickerStatsLogger.resumeTimer()}componentDidUpdate(e,t){!t.activeMedia&&this.state.activeMedia&&this.refCaptionInput?this.props.listeners.uiIdle((()=>{this.refCaptionInput&&this.refCaptionInput.restoreFocus()})):this._refSendButton&&this.refContainer&&!this.refContainer.contains(document.activeElement)&&b.default.focus(this._refSendButton)}componentWillUnmount(){this._delayedClose&&clearTimeout(this._delayedClose),this._mediaProcessTimer&&clearTimeout(this._mediaProcessTimer),this.props.mediaCollection.mediaPickerStatsLogger.pauseTimer()}render(){var e,t,a,{mediaCollection:s}=this.props,{activeMedia:i,prevActiveMedia:n}=this.state,d=0,c=s.getPreviewableMedias();c.length>_.default.MAX_FILES&&(c=c.slice(0,_.default.MAX_FILES)),this.state.showLoadingState?e=l.createElement(U.default,{key:"processing",color:"highlight"}):i?e=this._getMedia(i):0===c.length&&s.errorMsgs&&(e=l.createElement("div",{className:o.default.invalidContainer,key:"pending"},l.createElement("div",{className:o.default.invalidMedia},s.errorMsgs))),c.length>0&&(t=this.getThumbs(c),d=1===c.length?400:400+(150+15*c.length),a=this.state.showLoadingState?null:l.createElement("div",{className:o.default.btnSend,tabIndex:"-1",ref:this._setRefSendButton,onKeyPress:e=>e.preventDefault()},l.createElement(x.default,{large:!0,onClick:this.onSend},l.createElement(B.default,{name:"send",directional:!0}))));var u=this.state.isDragging?l.createElement(S.default,null):null,h=c.length<_.default.MAX_FILES?l.createElement("div",{className:(0,r.default)(o.default.btnAdd,{[o.default.btnAddDisabled]:this.state.isViewOnce}),key:"media-more",onClick:this.state.isViewOnce?void 0:this.onAddFileClick,role:"button"},l.createElement(B.default,{name:"add-alt"}),l.createElement("div",{className:o.default.btnAddText},D.default.t(210))):null,p={enter:this.onEnter,left:this._onArrowLeft,right:this._onArrowRight},f="*"===R.DOC_MIMES?"*":[_.default.IMAGE_MIMES,_.default.VIDEO_MIMES,R.DOC_MIMES].join(),m="media-scale";return i&&n&&i!==n&&(m=s.indexOf(i)>s.indexOf(n)?"media-slide-forward":"media-slide-back"),l.createElement(N.default,{handlers:p,onRef:this.setRefContainer},l.createElement(y.default,{key:"attach-image-modal",theme:"media",onDrop:this.onDrop,onDragChange:this.onDragChange},l.createElement(M.default,{title:D.default.t(1789),type:M.DRAWER_HEADER_TYPE.OFFSET,onCancel:this.props.onBack}),l.createElement(I.default,{tabIndex:"-1",overflow:"hidden",onPaste:this.onPaste},u,l.createElement("div",{className:o.default.body},l.createElement(H.default,{transitionName:m},e)),l.createElement("div",{className:o.default.thumbs},l.createElement(H.default,{transitionAppear:!0,transitionName:"thumb-scale",className:o.default.thumbsContainer},t),h),l.createElement(H.default,{transitionAppear:!0,transitionName:"btn",delay:d},a),l.createElement("input",{ref:this.setRefInput,type:"file",accept:f,style:{display:"none"},onChange:this.onFilePick,multiple:!0}))))}}q.displayName="AttachMediaDrawer";var Y=(0,A.default)((0,w.default)(q));t.default=Y},35365:(e,t,a)=>{"use strict";var s=a(93291),i=a(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(a(42208)),l=i(a(72779)),n=s(a(2784)),o=i(a(57077)),d=i(a(23045)),c=a(6353),u=i(a(90370)),h=a(47138),p=i(a(18779)),{IMAGE:f,VIDEO:m,DOCUMENT:v,AUDIO:g}=d.default.MSG_TYPE,E=(0,r.default)(c.MIMETYPES,(e=>e.msgType===v));class _ extends n.PureComponent{constructor(...e){super(...e),this._onClick=e=>{this.props.onClick&&this.props.onClick((0,h.unproxy)(this.props.attachMedia),e)},this._onClose=e=>{this.props.onClose&&this.props.onClose((0,h.unproxy)(this.props.attachMedia),e)},this.setRef=e=>{e&&this.props.onRef(this.props.id,e)}}_renderBody(){var e,t,a,s=this.props.attachMedia;switch(s.type){case f:a={backgroundImage:`url(${s.preview})`},e=n.createElement("div",{className:o.default.body,style:a});break;case m:a={backgroundImage:`url(data:image/jpeg;base64,${s.preview})`},e=n.createElement("div",{className:o.default.body,style:a});break;case g:e=n.createElement("div",{className:(0,l.default)(o.default.body,"attach-media-audio-thumb")});break;case v:if(__LOG__(2)`media is`,s.preview){var i={backgroundImage:"url("+s.preview+")"};e=n.createElement("div",{className:o.default.body,style:i});break}E[s.mimetype]&&(t=E[s.mimetype].icon);default:t=(0,l.default)(o.default.body,o.default.bodyDoc,t,{"icon-doc-generic":!t}),e=n.createElement("div",{className:t})}return e}render(){var e=(0,l.default)(o.default.thumb,{[o.default.active]:this.props.active});return n.createElement("div",{className:e,onClick:this._onClick,role:"button",ref:this.setRef},n.createElement("div",{className:o.default.btnDelete,onClick:this._onClose,role:"button"},n.createElement(p.default,{name:"x-alt"})),this._renderBody())}}_.CONCERNS={attachMedia:["mimetype","preview","type"]},_.displayName="AttachMediaThumb";var C=(0,u.default)(_,_.CONCERNS);t.default=C},26713:(e,t,a)=>{"use strict";var s=a(14859),i=a(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=n;var r=i(a(2784)),l=s(a(2107));function n({mimeType:e,url:t}){return r.createElement("div",{className:l.default.container,"data-animate-attach-media":!0},r.createElement("div",{className:l.default.media},r.createElement("audio",{controls:!0,type:e,src:t})))}n.displayName="AttachMediaTypeAudio"},70368:(e,t,a)=>{"use strict";var s=a(14859),i=a(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=c;var r=i(a(2784)),l=s(a(39480)),n=s(a(14202)),o=s(a(38637)),d=s(a(29986));function c({fullPreview:e,fullPreviewSize:t,mimeType:a,filename:s}){return e&&t?r.createElement("div",{className:l.default.container,"data-animate-attach-media":!0},r.createElement("div",{className:l.default.preview},r.createElement(d.default,{type:"scaleDown",size:t},r.createElement("img",{alt:o.default.t(1789),src:e,className:l.default.img})))):r.createElement(n.default,{mimeType:a,filename:s})}c.displayName="AttachMediaTypeDoc"},14202:(e,t,a)=>{"use strict";var s=a(93291),i=a(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=u;var r=i(a(42208)),l=s(a(2784)),n=i(a(72779)),o=i(a(90108)),d=a(6353),c=(0,r.default)(d.MIMETYPES,(e=>"document"===e.msgType));function u({mimeType:e,filename:t}){var a=(0,n.default)(o.default.icon,c[e]?c[e].icon:"icon-doc-generic");return l.createElement("div",{className:o.default.container,"data-animate-attach-media":!0},l.createElement("div",{className:o.default.media},l.createElement("div",{className:o.default.document},l.createElement("div",{className:a}),l.createElement("div",{className:o.default.text},t))))}u.displayName="AttachMediaTypeFile"},47729:(e,t,a)=>{"use strict";var s=a(93291),i=a(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=v;var r=i(a(58527)),l=i(a(42208)),n=i(a(72779)),o=s(a(2784)),d=i(a(85738)),c=i(a(38637)),u=a(6353),h=i(a(29986)),p=s(a(68267)),f=i(a(58060)),m=(0,l.default)(u.MIMETYPES,(e=>"image"===e.msgType||"video"===e.msgType));function v({mimeType:e,url:t,isGif:a,size:s,processing:i,preview:l}){var u;switch(m[e].msgType){case"image":u=o.createElement("img",{alt:c.default.t(1789),src:t,className:d.default.img});break;case"video":var v=a?{loop:!i,autoPlay:!i,muted:!1,controls:!1}:{},g=i?o.createElement("div",{className:d.default.spinner},o.createElement(p.default,{color:p.colorOptions.white,size:50,stroke:3})):null,E=l?o.createElement("img",{alt:c.default.t(1789),className:d.default.staticPreview,src:`data:image/jpeg;base64,${l}`}):null,_=i?null:o.createElement(f.default,(0,r.default)({controls:!0,controlsList:"nodownload nofullscreen",className:d.default.video},v,{src:t}));u=o.createElement("div",{className:(0,n.default)(d.default.img,d.default.videoContainer)},g,_,E);break;case"audio":u=o.createElement("audio",{controls:!0,className:d.default.audio,type:e,src:t})}return o.createElement("div",{className:d.default.container,"data-animate-attach-media":!0},o.createElement("div",{className:d.default.media},o.createElement(h.default,{type:"scaleDown",size:s},u)))}v.displayName="AttachMediaTypeMedia"},99479:(e,t,a)=>{"use strict";var s=a(93291),i=a(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=u;var r=i(a(72779)),l=s(a(2784)),n=i(a(14202)),o=i(a(38540)),d=i(a(38637)),c=i(a(29986));function u({fullPreview:e,fullPreviewSize:t,pageCount:a,mimeType:s,filename:i,showPageCount:u=!0,showBorder:h=!1}){if(e&&t&&null!=a&&a>0){var p=d.default.t(241,{count:a,_plural:a});return l.createElement("div",{className:o.default.container,"data-js-attach-preview":!0},l.createElement("div",{className:o.default.preview},l.createElement(c.default,{type:"scaleDown",size:t},l.createElement("img",{alt:d.default.t(1789),src:e,className:(0,r.default)(o.default.img,{[o.default.imgBorder]:h})}))),u&&l.createElement("div",{className:o.default.caption},p))}return l.createElement(n.default,{mimeType:s,filename:i})}u.displayName="AttachMediaTypePdf"},10145:(e,t,a)=>{"use strict";var s=a(93291),i=a(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function({isOn:e,mediaType:t,onChange:a,noMargin:s}){var[i,E]=n.useState((0,h.shouldShowNUX)(u.default.NUX.EPHEMERAL_VIEW_ONCE));return n.useEffect((()=>{if(e){if(!i){var a=t===f.TYPE.VIDEO?p.default.t(1450):p.default.t(1448),s=n.createElement(v.default,{msg:a,id:(0,v.genId)("view-once-toast")});return c.default.openToast(s),()=>{c.default.closeToast(s)}}var r=n.createElement(d.default,{onOkClick:()=>{E(!1),c.default.closeModal()}});c.default.openModal(r)}}),[i,t,e]),n.createElement(g.default,{a8nText:l.default.key("view-once-toggle"),className:(0,r.default)(o.default.btnViewOnce,{[o.default.noMargin]:s}),onClick:()=>a(!e),"aria-pressed":e},n.createElement(m.default,{"aria-label":e?p.default.t(35):p.default.t(36),name:e?"view-once-select":"view-once"}))};var r=i(a(72779)),l=i(a(32944)),n=s(a(2784)),o=i(a(25902)),d=i(a(46322)),c=i(a(13277)),u=i(a(23045)),h=a(66239),p=i(a(38637)),f=a(36169),m=i(a(18779)),v=s(a(97025)),g=i(a(78126))},46322:(e,t,a)=>{"use strict";var s=a(14859),i=a(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=v;var r=i(a(2784)),l=s(a(46945)),n=s(a(76176)),o=s(a(23045)),d=a(4170),c=a(55848),u=a(66368),h=a(66239),p=s(a(38637)),f=s(a(18779)),m=a(74315);function v(e){return r.useEffect((()=>()=>{(0,h.setNUX)(o.default.NUX.EPHEMERAL_VIEW_ONCE,{views:1,maxViews:1})}),[]),r.createElement(n.default,{onOK:e.onOkClick,cancelText:p.default.t(844),onCancel:()=>{(0,d.openExternalLink)((0,c.getViewOnceFaqUrl)())}},r.createElement(u.FlexColumn,null,r.createElement(u.FlexItem,{className:l.default.graphic,align:"center"},r.createElement(f.default,{name:"view-once-sender-nux"})),r.createElement(m.TextHeader,{className:l.default.text,theme:"popup-title"},p.default.t(1446)),r.createElement(m.TextParagraph,{className:l.default.text,color:"secondary"},p.default.t(1445))))}v.displayName="AttachMediaViewOnceNux"},44956:(e,t,a)=>{"use strict";var s=a(93291),i=a(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(a(25291)),l=s(a(2784)),n=i(a(32944)),o=a(25559),d=i(a(9745)),c=i(a(88025)),u=i(a(13277)),h=i(a(76176)),p=i(a(10453)),f=i(a(43805)),m=i(a(86708)),v=i(a(3123)),g=i(a(96881)),E=i(a(73018)),_=s(a(32597)),C=a(83251),S=i(a(85530)),y=i(a(36893)),I=i(a(14076)),M=i(a(38637)),P=i(a(4739)),T=i(a(18779));class L extends l.Component{constructor(...e){super(...e),this.flatListController=new I.default,this._onBlockConfirm=e=>{(0,o.blockContact)(e).catch((()=>{})),u.default.closeModal()},this.onBlock=()=>{u.default.openModal(l.createElement(m.default,{title:M.default.t(207),filter:function(e){return!!f.default.isFilteredContact(e)&&(!c.default.get(e.id)||M.default.t(1140))},onCancel:()=>u.default.closeModal(),onSelect:(0,r.default)(this._onBlockConfirm)}))},this._onUnblockConfirm=e=>{(0,o.unblockContact)(e).catch((()=>{})),u.default.closeModal()},this._onUnblockCancel=()=>{u.default.closeModal()},this._onUnblock=(e,t)=>{u.default.openModal(l.createElement(h.default,{okText:M.default.t(1382),onOK:this._onUnblockConfirm.bind(this,t),cancelText:M.default.t(1569),onCancel:this._onUnblockCancel},M.default.t(1383,{contact:t.formattedName})))},this.renderItem=e=>{var{blocklist:t}=e,a=t.contact();return l.createElement(p.default,{contact:a,key:a.id.toString(),onClick:this._onUnblock,onDelete:this._onUnblock,waitIdle:!0})}}componentDidMount(){this.props.listeners.add(c.default,"add remove",(()=>{this.forceUpdate()}))}getData(){return c.default.map((e=>({itemKey:e.id.toString(),blocklist:e})))}render(){var e,t;return c.default.length>0?(e=l.createElement(y.default,{flatListControllers:[this.flatListController],className:d.default.list},l.createElement(S.default,{flatListController:this.flatListController,direction:"vertical",data:this.getData(),renderItem:this.renderItem})),t=l.createElement("div",{"data-a8n":n.default.key("blocked-description"),className:d.default.hint},M.default.t(206))):e=l.createElement(C.Blocked,null),l.createElement(v.default,null,l.createElement(_.default,{title:M.default.t(284),onBack:this.props.onClose,type:_.DRAWER_HEADER_TYPE.LARGE}),l.createElement("div",{className:d.default.button},l.createElement(E.default,{a8nText:"li-add-blocked",onClick:this.onBlock,icon:l.createElement(T.default,{name:"add-user",directional:!0})},M.default.t(207))),l.createElement(g.default,null,e,t))}}L.displayName="BlockedDrawer";var b=(0,P.default)(L);t.default=b},45416:(e,t,a)=>{"use strict";var s=a(93291),i=a(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(a(72779)),l=a(35160),n=s(a(2784)),o=i(a(10145)),d=i(a(6686)),c=i(a(13277)),u=i(a(23045)),h=i(a(3123)),p=i(a(96881)),f=s(a(32597)),m=s(a(24461)),v=s(a(10313)),g=a(5370),E=s(a(64453)),_=i(a(38637)),C=i(a(18055)),S=i(a(9962)),y=s(a(46229)),I=i(a(84161)),M=i(a(29986)),P=i(a(93013)),T=i(a(85185)),L=i(a(19432)),b=i(a(54559)),N=i(a(68267)),D=i(a(18779)),w=i(a(22006)),O=i(a(82838)),k=i(a(58060)),R="ANIMATING",A="LOADING",x="RECORDING",F="SENDING";class U extends n.PureComponent{constructor(...e){super(...e),this.state={caption:void 0,img:void 0,isViewOnce:!1,state:R,stream:void 0,videoSize:void 0},this.videoRef=null,this._startTimer=new l.ShiftTimer((({stream:e,disposeStream:t})=>{this.loadNewStream(e,t)})),this.loadNewStreamTimerUpdate=(e,t)=>{this._startTimer.forceRunNow({stream:e,disposeStream:t})},this.loadNewStream=(e,t)=>{var a;e?(null===(a=this._disposeStream)||void 0===a||a.call(this),this._disposeStream=t,this.setState({state:A,stream:e}),(0,y.isSrcObjectInVideoElement)()||(e?(window.URL.revokeObjectURL(this.url),this.url=window.URL.createObjectURL(e)):(window.URL.revokeObjectURL(this.url),this.url=void 0))):this.state.state===R&&this.setState({state:A})},this._stopStreamTimer=new l.ShiftTimer((({stream:e,disposeStream:t})=>{e&&t&&t(),(0,y.isSrcObjectInVideoElement)()||(this.url=window.URL.revokeObjectURL(this.url))})),this.onCapture=()=>{if(this.videoRef){var e=this.videoRef.underlyingVideo();if(e){var{chat:t}=this.props,a=document.createElement("canvas");a.height=e.videoHeight,a.width=e.videoWidth;var s=a.getContext("2d");if(s){s.translate(a.width,0),s.scale(-1,1),s.drawImage(e,0,0,e.videoWidth,e.videoHeight);var i=this.props.onCaptured;if(i)E.canvasToBlob(a).then((e=>{i(e)}));else{this._stopStreamTimer.onOrBefore(500,{stream:this.state.stream,disposeStream:this._disposeStream}),this._mediaLogger=new C.default,this._mediaLogger.logAdd("CAPTURE_MEDIA","image",I.default.MEDIA_PICKER_ORIGIN_TYPE.MENU_CAMERA_CAPTURE),this._mediaLogger.chatRecipients=t&&t.groupMetadata?t.groupMetadata.participants.length:1;var r=a.toDataURL("image/jpeg");window.dataURLtoBlob(r),this.setState({state:F,stream:void 0,img:r})}}else __LOG__(3)`CaptureDrawer:onCapture can not get 2d context`}}},this.onVideoLoaded=e=>{this.setState({state:x,videoSize:{width:e.videoWidth,height:e.videoHeight}})},this.onRetake=()=>{this.setState({state:A,caption:void 0});var{asyncStream:e,disposeStream:t}=y.start("camera");this._disposeStream=t,e.then((e=>{e&&((0,y.isSrcObjectInVideoElement)()||(this.url=window.URL.createObjectURL(e)),this.setState({stream:e}))})).catchType(m.GUM.NotAllowedError,(()=>{this.props.onBack(),c.default.openModal(n.createElement(v.default,{messaging:v.Messaging.CAMERA_FAIL,type:v.default.TYPE.GUIDE_UNBLOCK}))})).catchType(m.GUM.GUMError,(()=>{this.props.onBack(),c.default.openModal(n.createElement(v.default,{messaging:v.Messaging.CAMERA_MISSING,type:v.default.TYPE.GUIDE_NONE}))}))},this.onSend=()=>{var{img:e,caption:t}=this.state,a=this.props.onSend;if(a)if(e){var s=this.refCaptionInput&&this.refCaptionInput.refInput,i=[];if(t&&s){var r=s.serialize(t),[l,n]=[r[0].trim(),r[1]];l.length&&(t=l,i=n.mentionedJidList||[])}a({caption:t,getImg:P.default.createFromBase64Jpeg(w.default.parseDataURL(e).data),isViewOnce:this.state.isViewOnce,mentionedJidList:i}),this._mediaLogger.logSend()}else __LOG__(4,void 0,new Error,!0)`Assertion failed!`,SEND_LOGS("capture-drawer-no-img");else __LOG__(4,void 0,new Error,!0)`Assertion failed!`,SEND_LOGS("capture-drawer-no-onSend")},this.onCaptionChange=e=>{this.setState({caption:e})},this._canViewOnce=()=>b.default.viewOnceWrite,this._onViewOnceChange=e=>{this.setState({isViewOnce:e})},this.setRefCaptionInput=e=>{this.refCaptionInput=e}}componentDidMount(){this._startTimer.onOrBefore(300,{stream:this.props.stream,disposeStream:this.props.disposeStream})}componentWillUnmount(){var e;this._startTimer.cancel(),this.url&&window.URL.revokeObjectURL(this.url),null===(e=this._disposeStream)||void 0===e||e.call(this),this._mediaLogger&&this._mediaLogger.logCancel()}render(){var e,t,a,s,i,l="capture-cover"===this.props.theme?"cover":"contain";switch(this.state.state){case R:case A:if(i=n.createElement(N.default,{stroke:4,size:50}),this.state.state===R)break;case x:var c=(0,r.default)(d.default.video,{[d.default.videoInactive]:this.state.stream&&this.state.state===A}),m=this.state.stream?n.createElement(k.default,{autoPlay:!0,ref:(0,g.GetRef)((e=>{this.videoRef=e})),onPlay:this.onVideoLoaded,src:this.url?this.url:void 0,srcObject:this.url?void 0:this.state.stream}):null;a=this.state.stream?n.createElement("div",{key:"webcam"},n.createElement(M.default,{type:l,size:this.state.videoSize},n.createElement("div",{className:c,"data-animage-capture-webcam":!0},m))):null,e=this.state.state===x?n.createElement("div",{className:d.default.btn,key:"btn-capture"},n.createElement(L.default,{large:!0,onClick:this.onCapture},n.createElement(D.default,{name:"camera"}))):null;break;case F:a=n.createElement(M.default,{type:l,size:this.state.videoSize},n.createElement("img",{alt:"",className:d.default.image,"data-animate-capture-snapshot":!0,src:this.state.img})),e=n.createElement("div",{className:(0,r.default)(d.default.btn,d.default.btnSend),key:"btn-send"},n.createElement(L.default,{large:!0,onClick:this.onSend},n.createElement(D.default,{name:"send",directional:!0}))),t=n.createElement("div",{className:d.default.retakeBtn,onClick:this.onRetake},n.createElement("div",{className:d.default.retakeIcon},n.createElement(D.default,{name:"return"})),_.default.t(1229)),s=this.props.chat?n.createElement("div",{className:d.default.captionInput},n.createElement(S.default,{ref:this.setRefCaptionInput,chat:this.props.chat,maxLength:u.default.MAX_CAPTION_LENGTH,multiline:!0,onEnter:this.onSend,onChange:this.onCaptionChange,placeholder:_.default.t(204),showRemaining:!0,spellCheck:!0,supportsEmoji:!0,value:this.state.caption}),this._canViewOnce()?n.createElement(o.default,{isOn:this.state.isViewOnce,mediaType:"image",onChange:this._onViewOnceChange}):null):null;break;default:__LOG__(2)`captureDrawer:render Unhandled video capture state ${this.state.state}`}var v=this.props.caption?n.createElement(O.default,{transitionName:"media-caption",className:d.default.caption},s):null,E=n.createElement("div",{className:d.default.footer},v,n.createElement(O.default,{transitionName:"pop_delay"},e));return n.createElement(h.default,{key:"attach-capture-modal",theme:this.props.theme},n.createElement(f.default,{title:_.default.t(1362),type:f.DRAWER_HEADER_TYPE.OFFSET,onCancel:this.props.onBack},t),n.createElement(p.default,{overflow:"hidden"},n.createElement("div",{className:d.default.container},i,n.createElement("div",{className:d.default.body},n.createElement(O.default,{transitionName:"capture",className:d.default.videoContainer},a))),E))}}U.defaultProps={caption:!1},U.displayName="CaptureDrawer";var B=(0,T.default)(U);t.default=class extends B{constructor(...e){super(...e),this.loadNewStream=(e,t)=>{this.getComponent().loadNewStreamTimerUpdate(e,t)}}}},53236:(e,t,a)=>{"use strict";var s=a(93291),i=a(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=u;var r=i(a(72779)),l=s(a(2784)),n=i(a(27018)),o=i(a(75557)),d=a(66368),c=i(a(38637));function u(e){return l.createElement("div",{className:(0,r.default)(o.default.container)},l.createElement(d.FlexRow,{align:"start",justify:"start",wrap:"wrap"},e.categories.map((t=>l.createElement(n.default,{"aria-label":c.default.t(33),key:t.id.toString(),className:o.default.chip,onClick:()=>e.onRemoveItem(t.id),label:t.localized_display_name,postfixIcon:"round-x-inv"})))))}u.displayName="ChipSelectorFooter"},74598:(e,t,a)=>{"use strict";var s=a(14859),i=a(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(a(2784)),l=s(a(92515)),n=s(a(78523)),o=s(a(43805)),d=s(a(42072)),c=s(a(74311)),u=s(a(3123)),h=s(a(96881)),p=i(a(32597)),f=a(83251),m=s(a(14076)),v=s(a(5338)),g=s(a(18792)),E=s(a(19058)),_=s(a(38637)),C=s(a(11085)),S=s(a(45632)),y=s(a(71673)),I=s(a(18779)),M=s(a(39277)),P=(0,r.forwardRef)(((e,t)=>{var{title:a,onBack:s,onClick:i,onNewGroup:P}=e,[T,L]=(0,r.useState)(""),b=(0,r.useRef)(),N=(0,r.useRef)(),D=(0,r.useRef)(),w=(0,r.useMemo)((()=>o.default.frequentContacts("message")),[o.default.length]),O=Boolean(T),k=(0,r.useMemo)((()=>O?[]:w),[O,w]),[R]=(0,r.useState)((()=>new m.default)),A=(0,r.useCallback)((e=>{o.default.ensureSorted();var t="string"==typeof e?e:T;if(!t)return o.default.getFilteredContacts();var a=o.default.getFilteredContacts().concat(o.default.filter((e=>e.name&&!e.isMe&&!e.isPSA&&!e.isWAContact))),s=_.default.accentFold(t),i=(0,S.default)(s);return a.filter((function(e){return e.searchMatch(s,i)}))}),[T]);(0,r.useEffect)((()=>{g.default.focus(b.current)}),[]);var x,F,U=(0,r.useCallback)((()=>{v.default.shouldIndicateFocus(),g.default.focus(b.current)}),[]),B=(0,r.useCallback)((e=>{var t=N.current;null!=t&&(e.preventDefault(),e.stopPropagation(),v.default.shouldIndicateFocus(),t.focusFirst())}),[]),G=(0,M.default)((e=>L(e)),100),H=(0,r.useCallback)((e=>{D.current=e,G(e)}),[G]),V=(0,r.useCallback)((e=>{e.preventDefault(),e.stopPropagation();var t=k[0];if(t)return v.default.shouldIndicateFocus(),void i(e,t);var a=A(D.current)[0];a&&(v.default.shouldIndicateFocus(),i(e,a))}),[i,A,k]),j=A();if(x=0===j.length?T?(0,f.SearchWithKeyword)(T):(0,f.SearchWithoutKeyword)():r.default.createElement(c.default,{ref:N,contacts:j,flatListController:R,frequentContacts:k,onClick:i,onFocusSearch:U,showPersonGroupDivisionHeader:!!T}),!T){var W=r.default.createElement(y.default,null,r.default.createElement(I.default,{name:"new-group",directional:!0}));F=r.default.createElement("div",{"data-list-scroll-offset":!0},r.default.createElement("div",{className:d.default.newGroupButton},r.default.createElement(n.default,{image:W,primary:_.default.t(1717),onClick:P}),r.default.createElement(l.default,null)))}return r.default.createElement(u.default,{ref:t,key:"contact-modal"},r.default.createElement(p.default,{title:a,type:p.DRAWER_HEADER_TYPE.LARGE,onBack:s}),r.default.createElement(E.default,{handlers:{down:B}},r.default.createElement(C.default,{ref:b,onSearch:H,onEnter:V,placeholder:_.default.t(1243)})),r.default.createElement(h.default,{flatListControllers:[R]},F,x))}));t.default=P},22808:(e,t,a)=>{"use strict";var s=a(14859),i=a(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(a(2784)),l=s(a(95419)),n=s(a(13277)),o=s(a(23045)),d=s(a(11277)),c=s(a(92035)),u=s(a(3123)),h=s(a(96881)),p=i(a(32597)),f=s(a(84340)),m=i(a(24461)),v=a(9690),g=s(a(62536)),E=a(5370),_=s(a(1126)),C=s(a(38637)),S=s(a(4739)),y=a(11141),I=s(a(30528)),M=s(a(39542)),P=s(a(69650)),T=s(a(68536)),L=s(a(85185)),b=s(a(54559)),N=s(a(68267)),D=s(a(90370)),w=s(a(18779)),O=i(a(97025)),k=s(a(24782));class R extends r.Component{constructor(...e){super(...e),this.setRefScrollable=e=>{this.refScrollable=e},this.state={msgInfo:void 0,unimplemented:!1},this.wrapper=null,this.isMsgVisible=(e,t=!1)=>e===this.props.msg.id&&(!!t||this.getMsgComponent()),this.onClose=()=>{this.props.uim.uie.requestDismiss()}}componentDidMount(){var e;M.default.find(this.props.msg.id).checkpoint(this.props.rejectOnUnmount()).then((e=>{this.setState({msgInfo:e}),this.props.listeners.add(e.played,"add remove",(()=>{this.forceUpdate()})),this.props.listeners.add(e.read,"add remove",(()=>{this.forceUpdate()})),this.props.listeners.add(e.delivery,"add remove",(()=>{this.forceUpdate()}))})).catchType(m.Unmount,(()=>{})).catch((()=>{this.setState({unimplemented:!0}),n.default.openToast(r.createElement(O.default,{msg:C.default.t(997),id:(0,O.genId)("msg_info_failed")}))}));var t=null===(e=this.refScrollable)||void 0===e?void 0:e.container;this.props.msg.type===o.default.MSG_TYPE.IMAGE&&t&&(t.scrollTop=t.scrollHeight),this.props.listeners.add(this.props.msg,"remove",((e,t)=>{t===I.default&&this.props.uim.uie.requestDismiss()}))}getMsgComponent(){var e=this.wrapper;if(e)return e.getMsgComponentRef()}render(){var e,t,a,{msg:s}=this.props,{msgInfo:i,unimplemented:n}=this.state;if(i){var m,g,S,I,M=[],L=s.type===o.default.MSG_TYPE.PTT;(L||s.isViewOnce)&&(t=C.default.t(966),S=(g=i.played.head())&&g.t,I=r.createElement("span",{className:c.default.icon},r.createElement(w.default,{name:L?"status-ptt":"view-once-viewed",className:c.default.statusBlue})),M.push(r.createElement(d.default,{title:L?C.default.t(961):C.default.t(967),t:S,icon:I,key:"played"}))),S=(g=i.read.head())&&g.t,I=r.createElement("span",{className:c.default.icon},r.createElement(w.default,{name:"status-dblcheck",className:c.default.ack})),t=null!==(m=t)&&void 0!==m?m:C.default.t(963),M.push(r.createElement(d.default,{title:t,t:S,icon:I,key:"read"})),S=(g=i.delivery.head())&&g.t,I=r.createElement("span",{className:c.default.icon},r.createElement(w.default,{name:"status-dblcheck"})),M.push(r.createElement(d.default,{title:C.default.t(959),t:S,icon:I,key:"delivery"})),!b.default.hfmStringChanges&&b.default.frequentlyForwardedMessages&&s.numTimesForwarded>0&&!s.isFrequentlyForwarded&&M.push(r.createElement(P.default,{key:"forward",msg:s})),e=r.createElement(f.default,{theme:"padding"},M)}i||n||(a=r.createElement("div",{className:c.default.spinner,key:"spinner"},r.createElement(N.default,{size:50,stroke:4})));var D=null;return s.labels&&s.labels.length&&(0,v.canDisplayLabel)()&&(D=r.createElement(f.default,{theme:"padding"},r.createElement(_.default,{labels:s.labels}))),r.createElement(u.default,{key:"message-info-modal",theme:"striped"},r.createElement(p.default,{title:C.default.t(958),type:p.DRAWER_HEADER_TYPE.SMALL,onCancel:this.onClose}),r.createElement(T.default,{ref:this.setRefScrollable,chatPreference:l.default.assertGet("defaultPreference")},r.createElement(k.default,{msg:s,ref:(0,E.GetRef)((e=>{this.wrapper=e})),displayType:o.default.DISP_TYPE.MSG_INFO,isMsgVisible:this.isMsgVisible,position:y.MsgPosition.END,onProductClick:this.props.onProductClick})),r.createElement(h.default,null,D,r.createElement("div",{className:c.default.body},a,e)))}}R.CONCERNS={msg:["id","star","type","isGif","isViewOnce","labels","numTimesForwarded","isFrequentlyForwarded"]},R.displayName="ContactMsgInfoDrawer";var A=(0,g.default)((0,L.default)((0,S.default)((0,D.default)(R,R.CONCERNS))));t.default=A},25655:(e,t,a)=>{"use strict";var s=a(14859),i=a(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(a(2784)),l=s(a(13277)),n=s(a(76176)),o=s(a(23045)),d=s(a(20468)),c=s(a(38637)),u=a(74315),h=a(29083),p=s(a(93257)),f=s(a(4170)),m=a(66368),v=s(a(92915)),g=i(a(97025)),E=a(55848),_=s(a(19058)),C=s(a(28427)),S=s(a(11018)),{CONTACT_US_MAX_DESC_LENGTH:y}=o.default;class I extends r.Component{constructor(...e){super(...e),this.state={description:"",includeDeviceInfo:!0,isSending:!1},this._setDescriptionRef=e=>{this._descriptionInput=e},this.onSend=()=>{var{description:e,includeDeviceInfo:t}=this.state;if(this.validateDescription(e)){var a=t?JSON.stringify(S.default.parser.getResult()):void 0;this.setState({isSending:!0}),this.props.onSend&&this.props.onSend({description:e}),__LOG__(2)`InAppSupport: Sending support request with deviceInfo=${t}:${null!=a?a:"n/a"}`,this._sendRequest=(0,h.sendSupportRequest)(e,a).then((e=>{null!=e.message&&(l.default.closeModal(),l.default.openToast(r.createElement(g.default,{msg:c.default.t(1349),id:(0,g.genId)()})))})).finally((()=>{this._sendRequest=void 0,this.setState({isSending:!1})}))}else this.setState({descriptionError:c.default.t(1296)})},this.onCancel=()=>{this.props.onCancel&&this.props.onCancel(),l.default.closeModal()},this.onDescriptionChange=e=>{this.setState({description:e,descriptionError:this.validateDescription(e)?void 0:this.state.descriptionError})},this._onIncludeDeviceInfoChange=()=>{this.setState({includeDeviceInfo:!this.state.includeDeviceInfo})},this.validateDescription=e=>e.length>=o.default.CONTACT_US_MIN_DESC_LENGTH,this.stopPropagation=e=>{e.stopPropagation()}}componentWillUnmount(){var e,t;!0===(null===(e=this._sendRequest)||void 0===e?void 0:e.isPending())&&(null===(t=this._sendRequest)||void 0===t||t.cancel())}componentDidMount(){var e;null===(e=this._descriptionInput)||void 0===e||e.restoreFocus()}render(){var{isSending:e}=this.state,t={enter:this.stopPropagation};if(e&&(t.esc=this.stopPropagation),d.default.supportsFeature(d.default.F.MD_BACKEND)){var a="contact-us-include-device";return r.createElement(n.default,{title:c.default.t(1350),okDisabled:!this.validateDescription(this.state.description)||e,okSpinner:e,okText:c.default.t(1280),onOK:this.onSend,onCancel:e?void 0:this.onCancel},r.createElement(_.default,{handlers:t},r.createElement(m.FlexColumn,{align:"stretch"},r.createElement(v.default,{error:this.state.descriptionError,maxLength:y,onChange:this.onDescriptionChange,placeholder:c.default.t(1348),ref:this._setDescriptionRef,value:this.state.description}),r.createElement(m.FlexItem,{className:C.default.deviceInfo,grow:1},r.createElement(u.TextParagraph,{theme:"muted-small"},c.default.t(1346))),r.createElement(m.FlexRow,null,r.createElement(m.FlexItem,{className:C.default.deviceInfoLabel,grow:1},r.createElement("label",{htmlFor:a},r.createElement(u.TextParagraph,{theme:"plain"},c.default.t(1347)," ",r.createElement(f.default,{href:(0,E.getContactFormDeviceInfoShareFaqUrl)()},c.default.t(844))))),r.createElement(m.FlexItem,{className:C.default.deviceInfoCheckbox,grow:0},r.createElement(p.default,{checked:this.state.includeDeviceInfo,id:a,onChange:this._onIncludeDeviceInfoChange}))))))}return r.createElement(n.default,{okText:c.default.t(1738),onOK:()=>l.default.closeModal(),title:c.default.t(1350)},r.createElement(u.TextParagraph,{theme:"plain"},c.default.t(1351)))}}t.default=I,I.displayName="ContactUsModal"},2629:(e,t,a)=>{"use strict";var s=a(93291),i=a(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(a(72779)),l=s(a(2784)),n=i(a(32944)),o=i(a(93257)),d=i(a(99461)),c=i(a(13277)),u=i(a(89426)),h=i(a(38637)),p=i(a(96997)),f=i(a(90370)),m=a(47138),v=a(74315);function g(e){return l.createElement("div",{className:(0,r.default)(u.default.section,{[u.default.disabled]:e.disabled})},l.createElement("div",{"data-a8n":n.default.key(e.a8nText),className:u.default.control},l.createElement(o.default,{id:e.id,onChange:e.onChange,checked:e.checked,disabled:e.disabled})),l.createElement("label",{className:u.default.label,htmlFor:e.id},e.children))}g.displayName="NotificationSetting";class E extends l.Component{constructor(...e){super(...e),this.state={notifications:p.default.getGlobalNotifications(),outgoingMessageSound:p.default.getOutgoingMessageSound(),sounds:p.default.getGlobalSounds(),previews:p.default.getGlobalPreviews(),collapseMuted:p.default.getCollapseMuted()},this._onSounds=()=>{var e=!this.state.sounds;this.setState({sounds:e}),p.default.setGlobalSounds(e)},this._onOutgoingMessageSound=()=>{var e=!this.state.outgoingMessageSound;this.setState({outgoingMessageSound:e}),p.default.setOutgoingMessageSound(e)},this.onNotifications=()=>{var e=!this.state.notifications;this.setState({notifications:e}),p.default.setGlobalNotifications(e)},this._onPreviews=()=>{var e=!this.state.previews;this.setState({previews:e}),p.default.setGlobalPreviews(e)},this._onCollapseMuted=()=>{var e=!this.state.collapseMuted;this.setState({collapseMuted:e}),p.default.setCollapseMuted(e)},this.onClose=()=>{c.default.closeModal()},this._onMuteDesktopNotifications=()=>{c.default.muteAll((0,m.unproxy)(this.props.mute),!this.props.mute.isMuted)}}render(){var e=[];window.Notification&&(e.push(l.createElement(g,{key:0,a8nText:"option-desktop-notifications",id:"desktop-notifications",checked:this.state.notifications,onChange:this.onNotifications},h.default.t(1120))),e.push(l.createElement(g,{key:1,a8nText:"options-msg-previews",disabled:!this.state.notifications,id:"msg-previews",checked:this.state.previews,onChange:this._onPreviews},h.default.t(1121),l.createElement(v.TextDiv,{theme:"muted"},h.default.t(1122)))));var t,a=this.props.mute.expiration,s=this.props.mute.isMuted,i=h.default.t(1377);if(s&&null!=a){var r=d.default.untilStr(a);t=l.createElement(v.TextDiv,{theme:"muted"},r)}return l.createElement("div",{className:u.default.container},l.createElement(g,{a8nText:"option-sounds",id:"sounds",checked:this.state.sounds,onChange:this._onSounds},h.default.t(1125)),undefined,e,undefined,l.createElement(g,{a8nText:"option-mute-desktop-notifications",id:"mute-desktop-notifications",checked:s,onChange:this._onMuteDesktopNotifications},i,t))}}E.CONCERNS={mute:["isMuted","expiration"]},E.displayName="DoNotDisturbSettings";var _=(0,f.default)(E,E.CONCERNS);t.default=_},71699:(e,t,a)=>{"use strict";var s=a(14859),i=a(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=o;var r=i(a(2784)),l=s(a(34966)),n=s(a(38637));function o(){return r.createElement("div",{key:"container",className:l.default.dropOverlay},r.createElement("div",{className:l.default.dropOverlayOutline},n.default.t(567)))}o.displayName="DragAndDropMask"},66166:(e,t,a)=>{"use strict";var s=a(14859),i=a(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.E2EChangeModal=t.E2EChangeModalClass=void 0;var r=i(a(2784)),l=s(a(13277)),n=s(a(76176)),o=s(a(38637)),d=s(a(90370));class c extends r.Component{render(){var e=o.default.t(1738),t=this.props.contact.formattedShortName,a=o.default.t(1900,{contactName:t}),s=o.default.t(1901,{contactName:t});return r.createElement(n.default,{title:a,onOK:()=>l.default.closeModal(),okText:e},s)}}t.E2EChangeModalClass=c,c.CONCERNS={contact:["formattedShortName"]},c.displayName="E2EChangeModalClass";var u=(0,d.default)(c,c.CONCERNS);t.E2EChangeModal=u},39931:(e,t,a)=>{"use strict";var s=a(93291),i=a(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.Component=t.RETRY_OPTIONS=void 0;var r=i(a(45455)),l=s(a(2784)),n=i(a(3123)),o=i(a(96881)),d=i(a(32597)),c=i(a(90347)),u=i(a(26004)),h=i(a(4170)),p=i(a(38637)),f=i(a(4739)),m=i(a(99641)),v=i(a(55085)),g=i(a(29986)),E=i(a(38965)),_=i(a(19432)),C=i(a(18779)),S=a(75976),y=i(a(22006)),I=i(a(82838)),M={NONE:"none",RETAKE:"retake",RESTART:"restart"};t.RETRY_OPTIONS=M;class P extends l.Component{constructor(e){super(e),this._onDoneEditing=()=>{var e=this.state.editedMedia;this.saveCanvas(),this._refProfileCropTool&&this._refProfileCropTool.getComponent().crop().then((({thumb:t,full:a})=>{this.props.onFinished(t,a),e.cleanUp()}))},this._onObjectLoad=e=>{if(e&&e instanceof HTMLElement){var t={};!this.state.editorSize||this.state.editorSize.width===e.clientWidth&&this.state.editorSize.height===e.clientHeight||(t.editorSize={width:e.clientWidth,height:e.clientHeight}),this.state.loaded||(t.loaded=!0),(0,r.default)(t)||this.setState(t)}},this.setRefMediaEditCanvas=e=>{this.mediaEditCanvas=e},this._setRefProfileCropTool=e=>{this._refProfileCropTool=e},this.drawCanvas=(e,t)=>{this.mediaEditCanvas&&this.mediaEditCanvas.drawCanvas(e,t)},this.saveCanvas=()=>{this.mediaEditCanvas&&this.mediaEditCanvas.saveCanvas()},this.updateCanvasSize=(e,t)=>{this.mediaEditCanvas&&this.mediaEditCanvas.updateCanvasSize(e,t)},this.onCanvasInitialized=()=>{this.forceUpdate()},this.state={doneEditing:!1,loaded:!1,editorSize:{width:500,height:361},editedMedia:new u.default(e.img)},this.mediaEditController=new v.default}componentDidMount(){this.props.listeners.add(this.mediaEditController,"change:isInitialized",this.onCanvasInitialized)}render(){var e,{attributionUrl:t,onRetake:a,retryText:s}=this.props,i=this.state.loaded?l.createElement("div",{className:c.default.btnSend,key:"btn-send"},l.createElement(_.default,{large:!0,onClick:this._onDoneEditing},l.createElement(C.default,{name:"checkmark-large"}))):null;this.mediaEditController.isInitialized&&(e=l.createElement(E.default,{editedMedia:this.state.editedMedia,stage:this.mediaEditController.stage,cropOverlay:this.mediaEditController.cropOverlay,mediaContainer:this.mediaEditController.mediaContainer,drawCanvas:this.drawCanvas,ref:this._setRefProfileCropTool}));var r,u=l.createElement(m.default,{className:c.default.mediaElement,editedMedia:this.state.editedMedia,mediaEditController:this.mediaEditController,fitType:"cover",ref:this.setRefMediaEditCanvas});if(a){var f;switch(s){case M.NONE:f=null;break;case M.RETAKE:f=p.default.t(1229);break;case M.RESTART:default:f=p.default.t(1232)}r=l.createElement("button",{className:c.default.retake,onClick:a},l.createElement("div",{className:c.default.retakeIcon},l.createElement(C.default,{name:"return"})),f)}var v=t?l.createElement("div",{className:c.default.attribution},l.createElement(h.default,{className:c.default.attributionLink,href:t},y.default.hostname(t)),l.createElement("span",null,p.default.t(803)," ",l.createElement(h.default,{href:(0,S.getTosUrl)()},p.default.t(809)))):null,P=l.createElement("div",{className:c.default.footer},l.createElement(I.default,{transitionName:"btn"},i),v),T=this.props.imageSize?this.props.imageSize:{width:500,height:361};return l.createElement(n.default,{key:"attach-edit-modal",theme:"edit"},l.createElement(d.default,{title:p.default.t(222),type:"offset",onCancel:this.props.onCancel},r),l.createElement(o.default,{overflow:"hidden"},l.createElement("div",{className:c.default.mediaBody},e,l.createElement("div",{className:c.default.containerBackground},l.createElement(I.default,{transitionName:"capture"},l.createElement(g.default,{type:"cover",size:T,onObjectLoad:this._onObjectLoad},u)))),P))}}P.displayName="EditImageDrawer";var T=P;t.Component=T;var L=(0,f.default)(P);t.default=L},51638:(e,t,a)=>{"use strict";var s=a(14859),i=a(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=h;var r=i(a(2784)),l=s(a(78523)),n=s(a(4170)),o=a(55848),d=s(a(10552)),c=s(a(38637)),u=s(a(18779));function h({frequentlyForwardedCount:e,totalCount:t}){var a=r.createElement("span",{className:d.default.text},1===e&&1===t?c.default.t(687):c.default.t(686)," ",r.createElement(n.default,{href:(0,o.getFrequentlyForwardedFaqUrl)()},c.default.t(844)));return r.createElement("div",{className:d.default.wrapper},r.createElement("div",{className:d.default.icon},r.createElement(u.default,{name:"highly-forwarded"})),r.createElement(l.default,{theme:"plain",primary:a,idle:!0}))}h.displayName="FrequentlyForwardedWarning"},25061:(e,t,a)=>{"use strict";var s=a(14859),i=a(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(60266),l=i(a(2784)),n=s(a(78523)),o=s(a(13277)),d=s(a(42579)),c=i(a(51045)),u=s(a(3123)),h=s(a(96881)),p=s(a(73018)),f=i(a(32597)),m=s(a(30905)),v=a(83251),g=a(33576),E=i(a(24461)),_=a(60501),C=s(a(16411)),S=s(a(38957)),y=s(a(38637)),I=s(a(85185)),M=a(64812),P=s(a(52501)),T=s(a(21120)),L=s(a(90370)),b=s(a(18779)),N=i(a(97025)),D="group-invite-link-anchor",w=0,O=1,k=2;class R extends l.Component{constructor(...e){super(...e),this.state={state:w},this._getErrorMessageFromStatusCode=e=>{switch(e){case 401:return y.default.t(735);case 403:return y.default.t(736);case 404:return y.default.t(737);default:return y.default.t(738)}},this._handleLoadingErrorStatusCode=e=>{var t=this._getErrorMessageFromStatusCode(e);this.props.onBack(),o.default.openToast(l.createElement(N.default,{msg:t,id:(0,N.genId)()}))},this._handleRevokeGroupInvite=()=>{o.default.openModal(l.createElement(S.default,{pushTransition:"none",popTransition:"none",chat:this.props.chat,onConfirm:this._handleConfirmRevokeGroupInvite}),{transition:"modal-flow"})},this._handleRevokingErrorStatusCode=e=>{var t=this._getErrorMessageFromStatusCode(e);this.props.onBack(),o.default.openToast(l.createElement(N.default,{msg:t,id:(0,N.genId)()}))},this._handleConfirmRevokeGroupInvite=()=>{this.setState({state:O});var e=(0,_.revokeGroupInvite)(this.props.groupMetadata);(0,r.delayMs)(500).then((()=>e)).checkpoint(this.props.rejectOnUnmount()).then((()=>{o.default.openToast(l.createElement(N.default,{msg:y.default.t(741),id:(0,N.genId)()})),this.setState({state:k})})).catchType(g.ServerStatusCodeError,(e=>{this._handleRevokingErrorStatusCode(e.statusCode)})).catchType(E.Unmount,(()=>{}))},this._handleSendGroupInviteLink=()=>{o.default.openModal(l.createElement(P.default,{chat:this.props.chat}),{transition:"modal-flow"})},this.handleClickGroupInviteLinkCapture=e=>{e.preventDefault(),e.stopPropagation()},this._renderDrawerBody=()=>{var e,t=this.props.groupMetadata;if(this.state.state===w)e=l.createElement(v.LoadingWithText,{text:y.default.t(728)});else if(this.state.state===O)e=l.createElement(v.LoadingWithText,{text:y.default.t(740,{groupName:this.props.chat.contact.name})});else{var a=t.groupInviteLink,s=null;document.queryCommandSupported("copy")&&(s=l.createElement(d.default,{elementId:D}));var i=l.createElement(c.default,{id:this.props.chat.id,size:82,quality:c.DETAIL_IMAGE_QUALITY.HIGH}),r=l.createElement("span",{className:C.default.linkContainer},l.createElement(M.SelectableLink,{id:D,href:a,selectable:!0},a));e=l.createElement(h.default,null,l.createElement(n.default,{image:i,primary:l.createElement(m.default,{text:this.props.chat.contact.name,direction:"auto"}),theme:"identity",secondary:r}),l.createElement("div",{className:C.default.descContainer},y.default.t(733)),l.createElement(T.default,{onClick:this._handleSendGroupInviteLink}),s,l.createElement(p.default,{a8nText:"li-revoke-link",icon:l.createElement(b.default,{name:"revoke",className:C.default.icon}),onClick:this._handleRevokeGroupInvite},y.default.t(730)))}return e}}componentDidMount(){(0,_.queryGroupInviteCode)(this.props.groupMetadata).checkpoint(this.props.rejectOnUnmount()).then((()=>{this.setState({state:k})})).catchType(g.ServerStatusCodeError,(e=>{this._handleLoadingErrorStatusCode(e.statusCode)})).catchType(E.Unmount,(()=>{}))}render(){return l.createElement(u.default,null,l.createElement(f.default,{title:y.default.t(732),onBack:this.props.onBack,type:f.DRAWER_HEADER_TYPE.SMALL}),this._renderDrawerBody())}}R.CONCERNS={groupMetadata:["inviteCode","groupInviteLink"]},R.displayName="GroupInviteLinkDrawer";var A=(0,I.default)((0,L.default)(R,R.CONCERNS));t.default=A},39426:(e,t,a)=>{"use strict";var s=a(14859),i=a(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(a(2784)),l=s(a(13277)),n=s(a(76176)),o=s(a(72879)),d=s(a(38637));class c extends r.Component{constructor(...e){super(...e),this._handleCancel=()=>{l.default.closeModal()},this._handleOK=()=>{this.props.onConfirm(),l.default.closeModal()}}render(){return r.createElement(n.default,{title:d.default.t(730),onOK:this._handleOK,okText:d.default.t(730),onCancel:this._handleCancel,cancelText:d.default.t(1569)},r.createElement("div",{className:o.default.confirmationText},d.default.t(739,{groupName:this.props.chat.contact.name})))}}t.default=c,c.displayName="GroupInviteRevokeModal"},57604:(e,t,a)=>{"use strict";var s=a(14859),i=a(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(a(2784)),l=s(a(32944)),n=s(a(95419)),o=s(a(13277)),d=s(a(23045)),c=s(a(3123)),u=s(a(96881)),h=i(a(32597)),p=s(a(84340)),f=i(a(24461)),m=i(a(85530)),v=s(a(14076)),g=a(9690),E=s(a(66286)),_=s(a(62439)),C=s(a(48396)),S=a(69236),y=s(a(62536)),I=a(5370),M=s(a(1126)),P=s(a(38637)),T=s(a(4739)),L=a(11141),b=s(a(30528)),N=s(a(39542)),D=s(a(69650)),w=s(a(68536)),O=s(a(21830)),k=s(a(85185)),R=s(a(71946)),A=s(a(54559)),x=s(a(68267)),F=s(a(90370)),U=s(a(18779)),B=a(74315),G=i(a(97025)),H=s(a(24782));class V extends r.Component{constructor(...e){super(...e),this.flatListController=new v.default,this.setRefScrollable=e=>{this.refScrollable=e},this.state={msgInfo:void 0,unimplemented:!1},this.wrapper=null,this.isMsgVisible=(e,t=!1)=>e===this.props.msg.id&&(!!t||this.getMsgComponent()),this.onClose=()=>{this.props.uim.uie.requestDismiss()},this._getHeaderAtSection=e=>{var t,a;switch(e){case S.SECTIONS.PLAYED_HEADER:a=r.createElement(U.default,{name:"status-ptt",className:_.default.statusBlue}),t=P.default.t(962);break;case S.SECTIONS.READ_HEADER:a=r.createElement(U.default,{name:"status-dblcheck",className:_.default.ack}),t=P.default.t(964);break;case S.SECTIONS.DELIVERED_HEADER:a=r.createElement(U.default,{name:"status-dblcheck"}),t=P.default.t(960);break;case S.SECTIONS.VIEWED_HEADER:a=r.createElement(U.default,{name:"view-once-viewed",className:_.default.statusBlue}),t=P.default.t(968);break;default:return __LOG__(4,void 0,new Error)`Invalid SECTION for group message info section header`,null}return a=r.createElement("div",{className:_.default.titleIcon},a),r.createElement("div",{"data-a8n":l.default.key("msg-info-title"),className:_.default.title},r.createElement(R.default,{side:a,ellipsify:!0},r.createElement(B.TextSpan,{theme:"section-title"},t)))},this._getFooterAtSection=e=>{var t=(0,O.default)(this.state.msgInfo,"this.state.msgInfo");return r.createElement(C.default,{key:e,section:e,msgInfo:t})},this.renderItem=e=>"row"===e.kind?this._getInfoCell(e.participant):e.type===S.SECTIONS.FORWARD_COUNT?this._getForwardCount():e.type===S.SECTIONS.PLAYED_HEADER||e.type===S.SECTIONS.READ_HEADER||e.type===S.SECTIONS.DELIVERED_HEADER||e.type===S.SECTIONS.VIEWED_HEADER?this._getHeaderAtSection(e.type):this._getFooterAtSection(e.type)}componentDidMount(){var e;N.default.find(this.props.msg.id).checkpoint(this.props.rejectOnUnmount()).then((e=>{this.setState({msgInfo:e}),this.props.listeners.add(e.played,"add remove",(()=>{this.forceUpdate()})),this.props.listeners.add(e.read,"add remove",(()=>{this.forceUpdate()})),this.props.listeners.add(e.delivery,"add remove",(()=>{this.forceUpdate()}))})).catchType(f.Unmount,(()=>{})).catch((()=>{this.setState({unimplemented:!0}),o.default.openToast(r.createElement(G.default,{msg:P.default.t(997),id:(0,G.genId)("msg_info_failed")}))}));var t=null===(e=this.refScrollable)||void 0===e?void 0:e.container;this.props.msg.type===d.default.MSG_TYPE.IMAGE&&t&&(t.scrollTop=t.scrollHeight),this.props.listeners.add(this.props.msg,"remove",((e,t)=>{t===b.default&&this.props.uim.uie.requestDismiss()}))}getAnimateEnterClass(e){return`animate-enter${-1===e?"":e}`}getMsgComponent(){var e=this.wrapper;if(e)return e.getMsgComponentRef()}_getInfoCell(e){return r.createElement(E.default,{msgInfoParticipant:e,contact:e.contact,key:e.id.toString()})}_getForwardCount(){return A.default.hfmStringChanges?null:r.createElement("div",{className:_.default.forwardCount},r.createElement(D.default,{msg:this.props.msg}))}getData(){var{msg:e}=this.props,{msgInfo:t}=this.state,a=[],s=e.type===d.default.MSG_TYPE.PTT;if(t&&(s||e.isViewOnce)){var i=s?S.SECTIONS.PLAYED_HEADER:S.SECTIONS.VIEWED_HEADER;a.push({kind:"section",type:i,itemKey:i,height:50}),a.push(...t.played.map((e=>({participant:e,kind:"row",itemKey:e.id.toString(),height:m.DEFAULT_ITEM_HEIGHT})))),t.playedRemaining>0&&(i=s?S.SECTIONS.PLAYED_FOOTER:S.SECTIONS.VIEWED_FOOTER,a.push({kind:"section",type:i,itemKey:i,height:50}))}return t&&(t.read.length>0||t.playedRemaining>0)&&(a.push({kind:"section",type:S.SECTIONS.READ_HEADER,itemKey:S.SECTIONS.READ_HEADER,height:50}),a.push(...t.read.map((e=>({participant:e,kind:"row",itemKey:e.id.toString(),height:m.DEFAULT_ITEM_HEIGHT})))),t.readRemaining>0&&a.push({kind:"section",type:S.SECTIONS.READ_FOOTER,itemKey:S.SECTIONS.READ_FOOTER,height:50})),t&&(t.delivery.length>0||t.deliveryRemaining>0)&&(a.push({kind:"section",type:S.SECTIONS.DELIVERED_HEADER,itemKey:S.SECTIONS.DELIVERED_HEADER,height:50}),a.push(...t.delivery.map((e=>({participant:e,kind:"row",itemKey:e.id.toString(),height:m.DEFAULT_ITEM_HEIGHT})))),t.deliveryRemaining>0&&a.push({kind:"section",type:S.SECTIONS.DELIVERED_FOOTER,itemKey:S.SECTIONS.DELIVERED_FOOTER,height:50})),A.default.frequentlyForwardedMessages&&e.numTimesForwarded>0&&!e.isFrequentlyForwarded&&a.push({kind:"section",type:S.SECTIONS.FORWARD_COUNT,itemKey:S.SECTIONS.FORWARD_COUNT,height:60}),a}render(){var e,{msg:t}=this.props,{msgInfo:a,unimplemented:s}=this.state;a||s||(e=r.createElement("div",{className:_.default.spinner,key:"spinner"},r.createElement(x.default,{size:50,stroke:4})));var i=this.getData(),l=i.length?r.createElement(m.default,{flatListController:this.flatListController,direction:"vertical",forceConsistentRenderCount:!1,data:i,renderItem:this.renderItem}):null,o=null;return t.labels&&t.labels.length&&(0,g.canDisplayLabel)()&&(o=r.createElement(p.default,{theme:"padding"},r.createElement(M.default,{labels:t.labels}))),r.createElement(c.default,{key:"message-info-modal",theme:"striped"},r.createElement(h.default,{title:P.default.t(958),type:h.DRAWER_HEADER_TYPE.SMALL,onCancel:this.onClose}),r.createElement(w.default,{ref:this.setRefScrollable,chatPreference:n.default.assertGet("defaultPreference")},r.createElement(H.default,{msg:t,ref:(0,I.GetRef)((e=>{this.wrapper=e})),displayType:d.default.DISP_TYPE.MSG_INFO,isMsgVisible:this.isMsgVisible,position:L.MsgPosition.END,onProductClick:this.props.onProductClick})),r.createElement(u.default,{flatListControllers:[this.flatListController]},o,e,r.createElement("div",{className:_.default.list},l)))}}V.CONCERNS={msg:["id","star","type","isGif","isViewOnce","labels","numTimesForwarded","isFrequentlyForwarded"]},V.displayName="GroupMsgInfoDrawer";var j=(0,y.default)((0,k.default)((0,T.default)((0,F.default)(V,V.CONCERNS))));t.default=j},48396:(e,t,a)=>{"use strict";var s=a(14859),i=a(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(a(2784)),l=s(a(32944)),n=s(a(62439)),o=a(69236),d=s(a(38637)),c=s(a(90370)),u=a(74315);class h extends r.Component{render(){var e,t,a;switch(this.props.section){case o.SECTIONS.PLAYED_FOOTER:case o.SECTIONS.VIEWED_FOOTER:e=this.props.msgInfo.playedRemaining,t=this.props.msgInfo.playedRemaining;break;case o.SECTIONS.READ_FOOTER:e=this.props.msgInfo.readRemaining,t=this.props.msgInfo.readRemaining;break;case o.SECTIONS.DELIVERED_FOOTER:e=this.props.msgInfo.deliveryRemaining,t=this.props.msgInfo.deliveryRemaining;break;default:return __LOG__(4,void 0,new Error)`Invalid SECTION for group message info section footer`,null}a=null!=e&&0!==e?{count:e,_plural:t}:{_plural:t};var s=d.default.t(965,a);return r.createElement("div",{"data-a8n":l.default.key("msg-info-remaining"),className:n.default.footer},r.createElement(u.TextSpan,{theme:"muted"},s))}}h.CONCERNS={msgInfo:["playedRemaining","readRemaining","deliveryRemaining"]},h.displayName="GroupMsgInfoSectionFooter";var p=(0,c.default)(h,h.CONCERNS);t.default=p},69236:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SECTIONS=void 0;var s=a(28103).Mirrored(["DELIVERED_FOOTER","DELIVERED_HEADER","FORWARD_COUNT","PLAYED_FOOTER","PLAYED_HEADER","READ_FOOTER","READ_HEADER","VIEWED_FOOTER","VIEWED_HEADER"]);t.SECTIONS=s},72349:(e,t,a)=>{"use strict";var s=a(14859),i=a(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(a(2784)),l=s(a(78523)),n=s(a(23045)),o=s(a(51045)),d=s(a(3123)),c=s(a(96881)),u=i(a(32597)),h=s(a(30905)),p=s(a(127)),f=s(a(91512)),m=s(a(38637)),v=s(a(64828)),g=s(a(56322)),E=s(a(93562)),_=s(a(85185)),C=s(a(19432)),S=s(a(18779)),y=s(a(92915)),I=s(a(82838));class M extends r.Component{constructor(...e){super(...e),this.state={isBusy:!1,inviteComment:m.default.t(760)},this.setRefParticipantList=e=>{this.refParticipantList=e},this.onClose=()=>{var{onClose:e}=this.props;e()},this._getGroupThumbBase64=()=>{var{gid:e}=this.props,t=E.default.get(e);return new Promise((e=>{t&&t.img?(0,p.default)(t.img).then((t=>{if(t.ok)return t.blob();e(void 0)})).then((t=>{if(t){var a=new FileReader;a.onloadend=function(){var t=a.result;if(null!=t){var s=t.toString().split(",")[1];e(s)}else e(void 0)},a.readAsDataURL(t)}})).catch((()=>e(void 0))):e(void 0)}))},this.onSend=()=>{var{onSend:e}=this.props,{inviteComment:t}=this.state;this._getGroupThumbBase64().then((a=>{e(t,a)}))},this._onInviteCommentChange=e=>{this.setState({inviteComment:e})},this.setRefEmojiInput=e=>{this.refEmojiInput=e}}render(){var e=r.createElement(C.default,{a8nText:"group-participants-btn",large:!0,onClick:this.onSend},r.createElement(S.default,{name:"send",directional:!0})),t=r.createElement(o.default,{id:this.props.gid}),a=r.createElement(h.default,{text:this.props.subject});return r.createElement(v.default,{type:"invite"},r.createElement(d.default,{theme:"invite"},r.createElement(u.default,{type:u.DRAWER_HEADER_TYPE.POPUP,title:m.default.t(769),onCancel:this.onClose}),r.createElement(c.default,null,r.createElement("div",{className:f.default.search},r.createElement("div",{"data-list-scroll-container":!0},r.createElement(g.default,{ref:this.setRefParticipantList,theme:"list-names",contacts:this.props.participants.map((e=>e.contact))}))),r.createElement("div",{className:f.default.commentInput},r.createElement(y.default,{a8n:"groups-v4-invite-add-comment-input",ref:this.setRefEmojiInput,value:this.state.inviteComment,showRemaining:!0,maxLength:n.default.MAX_CAPTION_LENGTH,onChange:this._onInviteCommentChange,theme:"v4-invite-caption",supportsEmoji:!0})),r.createElement(I.default,{transitionName:"btn",className:f.default.onSendInvite},e),r.createElement("div",{className:f.default.groupInfo},r.createElement(l.default,{idle:!0,image:t,primary:a,secondary:m.default.t(764),theme:"group_v4_invite"})))))}}M.displayName="GroupV4InviteAddComment";var P=(0,_.default)(M);t.default=P},15946:(e,t,a)=>{"use strict";var s=a(93291),i=a(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(a(54073)),l=i(a(90882)),n=i(a(16760)),o=a(60266),d=s(a(2784)),c=s(a(40953)),u=a(83251),h=i(a(38637)),p=i(a(17474)),f=i(a(45632)),m=i(a(99979));class v extends d.Component{getElement(){this._refEl}constructor(e){super(e),this._setRefEl=e=>{this._refEl=e},this.onSelect=(e,t)=>{if(t instanceof c.Mode){var a=t.props.chat;!0===this.props.filter(a)&&this.props.onGroup(t.props.chat)}},this.onSearch=(0,r.default)((e=>{this.setState({searchText:e})}),100),this.renderItem=e=>{var t,a,{onGroup:s,filter:i}=this.props,r=i(e.chat),l="boolean"!=typeof r;return l&&(t=r,a="group-modal"),d.createElement(c.default,{chat:e.chat,contact:e.chat.contact,mode:c.Mode.INFO,active:this.selection,secondary:t,noContext:!0,theme:a,onClick:l?void 0:s.bind(null,e.chat)})},this.selection=new m.default,this.state={loading:!0,searchText:void 0}}componentDidMount(){var{chats:e}=this.props;(0,o.delayMs)(300).then((()=>Promise.all((0,n.default)((0,l.default)(e,(e=>e.groupMetadata.stale)),(e=>a(25120).default.update(e.groupMetadata.id).catch((()=>{}))))))).then((()=>this.setState({loading:!1})))}getData(){var{chats:e,filter:t}=this.props,{loading:a,searchText:s}=this.state;if(a)return[];var i=h.default.accentFold(s),r=(0,f.default)(i),l=e.filter((e=>t(e)&&(!i||i&&e.contact.searchMatch(i,r))));return this.selection.init(l.filter((e=>!0===t(e))).map((e=>e.id))),l.map((e=>({chat:e,itemKey:e.id.toString()})))}render(){var{onCancel:e}=this.props,{loading:t}=this.state,a=t?d.createElement(u.Loading,null):d.createElement(u.SearchGroups,null);return d.createElement(p.default,{title:h.default.t(1693),data:this.getData(),renderItem:this.renderItem,emptyState:a,selection:this.selection,onCancel:e,onSearch:this.onSearch,onSelect:this.onSelect,onRef:this._setRefEl,searchPlaceholder:h.default.t(1246)})}}t.default=v,v.defaultProps={filter:function(){return!0}},v.displayName="GroupsModal"},26805:(e,t,a)=>{"use strict";var s=a(14859),i=a(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(a(2784)),l=s(a(48520)),n=i(a(43394)),o=s(a(13277)),d=s(a(310)),c=s(a(3123)),u=s(a(96881)),h=s(a(73018)),p=i(a(32597)),f=a(4170),m=a(55848),v=s(a(20468)),g=s(a(14748)),E=s(a(38637)),_=s(a(89286)),C=a(20662),S=s(a(84161)),y=s(a(20656)),I=a(75976),M=s(a(11018)),P=s(a(21975)),T={id:"animated-doodle",selectors:[`.${g.default.animation}`],low:{default:l.default},high:{default:l.default}};class L extends r.Component{constructor(...e){super(...e),this.openTime=-1,this._actionsTaken=!1,this._onTOS=()=>{this._actionsTaken=!0,(0,f.openExternalLink)((0,I.getTosUrl)())},this._onHelpCenter=()=>{(0,f.openExternalLink)((0,m.getFaqUrl)()),this._logSessionEvent(S.default.CONTACT_US_EXIT_STATE.FAQ)},this._onContactUs=()=>{o.default.openModal(v.default.supportsFeature(v.default.F.SUPPORT)?r.createElement(d.default,{onCancel:this.onContactUsCancel}):r.createElement(y.default,{onCancel:this.onContactUsCancel,onSend:this.onContactUsSend}))},this._onLicenses=()=>{o.default.openModal(r.createElement(_.default,{onOk:this._onLicensesOk}))},this.onContactUsCancel=()=>{this._logSessionEvent(S.default.CONTACT_US_EXIT_STATE.PROBLEM_DESCRIPTION)},this.onContactUsSend=e=>{this._logSessionEvent(S.default.CONTACT_US_EXIT_STATE.EMAIL_SEND,e)},this._onLicensesOk=()=>{}}componentDidMount(){this.openTime=performance.now(),n.default.loadAsset(T,n.LOAD_PRIORITY.HELP_ANIMATED_DOODLE)}componentWillUnmount(){this._actionsTaken||this._logSessionEvent(S.default.CONTACT_US_EXIT_STATE.CANCELLED)}_logSessionEvent(e,t){(0,C.logSessionEvent)(e,this.openTime,t),this._actionsTaken=!0}render(){var e;return M.default.isElectron&&(e=r.createElement(h.default,{a8nText:"li-licenses",onClick:this._onLicenses},E.default.t(845))),r.createElement(c.default,null,r.createElement(p.default,{a8n:"drawer-title-help",title:E.default.t(796),onBack:this.props.onClose,type:p.DRAWER_HEADER_TYPE.LARGE}),r.createElement(u.default,null,r.createElement("div",{className:g.default.animation}),r.createElement(P.default,{className:g.default.versionInfo}),r.createElement(h.default,{a8nText:"li-faq",onClick:this._onHelpCenter},E.default.t(1805)),r.createElement(h.default,{a8nText:"li-contact-us",onClick:this._onContactUs},E.default.t(1294)),e,r.createElement(h.default,{a8nText:"li-tos",onClick:this._onTOS},E.default.t(1370)),undefined,undefined))}}t.default=L,L.displayName="HelpDrawer"},72909:(e,t,a)=>{"use strict";var s=a(93291),i=a(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.Component=void 0;var r=i(a(22487)),l=i(a(16760)),n=i(a(87622)),o=s(a(2784)),d=s(a(25682)),c=i(a(13277)),u=i(a(23045)),h=i(a(3123)),p=i(a(96881)),f=s(a(32597)),m=a(83251),v=s(a(24461)),g=i(a(127)),E=i(a(5338)),_=i(a(18792)),C=i(a(19058)),S=i(a(93517)),y=i(a(38637)),I=i(a(11085)),M=i(a(85185)),P=i(a(6909)),T=i(a(75632)),L=s(a(97025)),b=i(a(11018)),N=a(89874),D=i(a(94407));class w extends o.Component{constructor(e){super(e),this.setRefSearch=e=>{this.refSearch=e},this._setRefSearchHotkeys=e=>{this._refSearchHotkeys=e},this._setRefGallery=e=>{this._refGallery=e},this._search=(e,t)=>{this._hasPendingSearch=!1;var a=d.search(e,t).cancellable().then((t=>{a===this._searchPromise&&(this._addSearchResults(e,t),this.setState({isSearching:!1}))})).catchType(Promise.CancellationError,(()=>{})).catch((()=>{__LOG__(3,!0)`Image search failed`,c.default.openToast(o.createElement(L.default,{msg:y.default.t(804),id:(0,L.genId)()})),a===this._searchPromise&&this.setState({isSearching:!1})})).finally((()=>{a===this._searchPromise&&(this._searchPromise=null)}));this._searchPromise=a,this.setState({isSearching:!0})},this._handleUserInput=e=>{var t=(e||"").trim();if(!t)return this._cancelSearch(),void this._resetState();(0,N.numCodepoints)(t)<u.default.FTS_MIN_CHARS||t!==this.state.query&&(this._cancelSearch(),this._resetState(),this._requestSearch(t))},this._handleRequestMoreImages=()=>{this._hasPendingSearch||this._searchPromise||!this.state.totalEstimatedMatches||this.state.nextOffset>=this.state.totalEstimatedMatches||this._requestSearch(this.state.query,this.state.nextOffset)},this._handleImageClick=e=>{var t=this.state.imageData[e];if(t){var a=t.contentUrl;(b.default.isElectron?(0,P.default)((()=>(0,g.default)(a))).then((e=>{if(200!==e.status)throw new v.ServerStatusError(null,a,e.status);return e.blob()})):D.default.downloadImage(a)).checkpoint(this.props.rejectOnUnmount()).then((e=>{if(!(e instanceof Blob))throw new v.ImageError("Server did not respond with image bytes",a);this.props.onImageSelected(e,t.hostPageUrl)})).catchType(v.Unmount,(()=>{})).catch((()=>{__LOG__(3,!0)`Image search failed`,c.default.openToast(o.createElement(L.default,{msg:y.default.t(801),id:(0,L.genId)()}))}))}},this._focusSearch=()=>{E.default.shouldIndicateFocus(),_.default.focus(this.refSearch)},this._focusGallery=e=>{e.repeat||this._refGallery&&this.refSearch&&this.refSearch.cursorIsAtEnd()&&(e.preventDefault(),e.stopPropagation(),E.default.shouldIndicateFocus(),null!=this._refGallery&&_.default.focus(this._refGallery))},this._handleSearchFocus=()=>{E.default.maybeIndicateFocus(this._refSearchHotkeys)},this.state={imageData:{},isSearching:!1,nextOffset:0,query:"",thumbnails:[],totalEstimatedMatches:0},this._hasPendingSearch=!1,this._searchPromise=null,this._debouncedSearch=this.props.debounce(this._search,750)}componentWillUnmount(){this._cancelSearch()}_requestSearch(e,t=0){this._hasPendingSearch=!0,this._debouncedSearch(e,t)}_cancelSearch(){this._hasPendingSearch&&(this._debouncedSearch.cancel(),this._hasPendingSearch=!1),this._searchPromise&&this._searchPromise.cancel()}_resetState(){this.setState({imageData:{},isSearching:!1,nextOffset:0,query:"",thumbnails:[],totalEstimatedMatches:0})}_addSearchResults(e,t){this.setState((a=>{var s=(0,n.default)(t.value,(e=>null==e?void 0:e.thumbnailUrl)),i=(0,l.default)(t.value,(e=>({id:e.imageId,name:e.name,thumbUrl:e.thumbnailUrl}))),o=t.value.length,d={};return a.query===e?(d.nextOffset=t.nextOffset?t.nextOffset:a.nextOffset+o,d.thumbnails=(0,r.default)(a.thumbnails,i),d.totalEstimatedMatches=t.totalEstimatedMatches,d.imageData=Object.assign(s,a.imageData)):(d.imageData=s,d.nextOffset=t.nextOffset?t.nextOffset:o,d.query=e,d.thumbnails=i,d.totalEstimatedMatches=t.totalEstimatedMatches),d}))}render(){var e,t=f.DRAWER_HEADER_TYPE.POPUP,a={down:this._focusGallery};return e=0===this.state.thumbnails.length?this.state.isSearching?o.createElement(m.SearchingImages,null):this.state.query?o.createElement(m.ImageSearchEmpty,null):o.createElement(m.BeforeImageSearch,null):o.createElement(S.default,{ref:this._setRefGallery,canLoadMore:this.state.nextOffset<this.state.totalEstimatedMatches,isLoadingMore:this.state.isSearching,thumbnails:this.state.thumbnails,onFocusPrev:this._focusSearch,onImageClick:this._handleImageClick,onRequestMoreImages:this._handleRequestMoreImages}),o.createElement(h.default,null,o.createElement(f.default,{title:y.default.t(808),type:t,onBack:this.props.onBack,onCancel:this.props.onCancel}),o.createElement(p.default,null,o.createElement(C.default,{onRef:this._setRefSearchHotkeys,handlers:a,onFocus:this._handleSearchFocus},o.createElement(I.default,{ref:this.setRefSearch,placeholder:y.default.t(805),onSearch:this._handleUserInput,loading:this.state.isSearching})),e))}}w.displayName="ImageSearchDrawer";var O=w;t.Component=O;var k=(0,T.default)((0,M.default)(w));t.default=k},68409:(e,t,a)=>{"use strict";var s=a(93291),i=a(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(a(72779)),l=s(a(2784)),n=i(a(3123)),o=i(a(96881)),d=s(a(32597)),c=i(a(38637)),u=a(6420),h=s(a(62345)),p=i(a(76814)),f=i(a(68267)),m=i(a(18779));class v extends l.Component{constructor(...e){super(...e),this.state={hover:!1},this.onClick=()=>{this.props.onUpdateColor({id:this.props.labelId,color:this.props.colorInt},h.LABEL_PROPERTIES.COLOR),this.props.onBack()},this._disableHover=()=>{this.state.hover&&this.setState({hover:!1})},this._enableHover=()=>{this.state.hover||this.setState({hover:!0})}}render(){var e=this.props.isSelected?l.createElement(m.default,{name:"checkmark-medium"}):null,t=(0,r.default)(p.default.wallpaperColorCanvas,{[p.default.canvasHover]:this.state.hover,[p.default.canvasActive]:this.props.isSelected});return l.createElement("span",{className:t,style:{backgroundColor:(0,u.intColorToHex)(this.props.colorInt)},onMouseOver:this._enableHover,onMouseEnter:this._enableHover,onMouseLeave:this._disableHover,onClick:this.onClick},e)}}v.displayName="ColorCanvas";class g extends l.Component{render(){for(var{currentColor:e,colors:t}=this.props,a=t.map((t=>l.createElement(v,{onUpdateColor:this.props.onUpdateColor,colorInt:t,onBack:this.props.onBack,labelId:this.props.labelId,isSelected:e===t,key:t}))),s=0;s<2;s++)a.push(l.createElement("div",{key:"emptyEl"+s,className:p.default.wallpaperColorEmpty}));return a}}g.displayName="ColorGrid";class E extends l.Component{constructor(){super(),this._getColorPromise=null,this.state={colors:h.default.labelColorPalette&&h.default.labelColorPalette.colors}}componentWillUnmount(){this._getColorPromise&&this._getColorPromise.cancel()}render(){var e=l.createElement(f.default,{stroke:6,size:24});return this.state.colors?e=l.createElement(g,{labelId:this.props.labelId,onBack:this.props.onClose,onUpdateColor:this.props.onUpdateColor,colors:this.state.colors,currentColor:this.props.currentColor}):(this._getColorPromise=h.default.getLabelColorPalette(),this._getColorPromise.cancellable().then((e=>{this.setState({colors:e})}))),l.createElement(n.default,null,l.createElement(d.default,{theme:this.state.colors?void 0:"center-content",title:c.default.t(832),onBack:this.props.onClose,type:d.DRAWER_HEADER_TYPE.LARGE}),l.createElement(o.default,null,l.createElement("div",{className:p.default.container},e)))}}t.default=E,E.displayName="LabelColorDrawer"},81868:(e,t,a)=>{"use strict";var s=a(14859),i=a(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(a(2784)),l=s(a(13277)),n=s(a(76176)),o=s(a(3123)),d=s(a(96881)),c=i(a(32597)),u=a(9690),h=s(a(38637)),p=s(a(55126)),f=a(30380),m=s(a(4739)),v=s(a(84161)),g=s(a(47306)),E=s(a(84568)),_=s(a(94548)),C=s(a(19432)),S=s(a(18779));class y extends r.PureComponent{constructor(){super(),this.onMultiSelect=()=>{var e=this.multiSelection.getSelected().length;this.setState({selectedCount:e})},this.shouldScrollIntoViewAndSelect=()=>({shouldScrollIntoView:!0,shouldSelect:!1}),this.onDeleteLabel=e=>{l.default.closeModal(),this.multiSelection.unsetAll(),this.props.onDeleteLabel(e)},this._confirmDeleteSelectedLabels=()=>{var e=this.multiSelection.getSelected();(0,f.logLabelOperationEvent)(v.default.LABEL_OPERATIONS.VIEW,e.length,v.default.LABEL_TARGETS.DELETE_LABEL_DIALOG),l.default.openModal(r.createElement(n.default,{okText:h.default.t(1872),cancelText:h.default.t(1733),onCancel:()=>{(0,f.logLabelOperationEvent)(v.default.LABEL_OPERATIONS.CLICK_NEGATIVE,1,v.default.LABEL_TARGETS.DELETE_LABEL_DIALOG),l.default.closeModal()},onOK:()=>{(0,f.logLabelOperationEvent)(v.default.LABEL_OPERATIONS.CLICK_POSITIVE,1,v.default.LABEL_TARGETS.DELETE_LABEL_DIALOG),this.onDeleteLabel(e)}},h.default.t(535,{_plural:e.length})))},this.onCancelSelection=()=>{this.multiSelection.unsetAll(),this.setState({selectedCount:0})},this.multiSelection=new _.default([],(e=>e.id)),this.state={selectedCount:0}}componentDidMount(){(0,f.logLabelOperationEvent)(v.default.LABEL_OPERATIONS.VIEW,void 0,v.default.LABEL_TARGETS.LABELS_SCREEN)}render(){var{selectedCount:e}=this.state,t=null;t=e>0?r.createElement(g.default,{selectedModels:this.multiSelection,onCancel:this.onCancelSelection,onDelete:this._confirmDeleteSelectedLabels,theme:"drawer-header"}):r.createElement(c.default,{title:h.default.t(842),onBack:this.props.onClose,type:c.DRAWER_HEADER_TYPE.LARGE});var a=(0,u.canEditLabel)()&&r.createElement("div",{className:p.default.addLabelBtContainer},r.createElement(C.default,{large:!0,onClick:this.props.openAddLabel},r.createElement(S.default,{name:"plus-large"})));return r.createElement(o.default,{theme:"settings"},t,r.createElement(d.default,null,r.createElement(E.default,{shouldScrollIntoViewAndSelect:this.shouldScrollIntoViewAndSelect,selectedLabels:this.multiSelection,renderContext:"label-list",onMultiSelect:this.onMultiSelect,onLabelClick:this.props.onLabelClick})),a)}}y.displayName="LabelDrawer";var I=(0,m.default)(y);t.default=I},92919:(e,t,a)=>{"use strict";var s=a(14859),i=a(93291);t.Z=void 0;var r=i(a(2784)),l=s(a(49791)),n=s(a(13277)),o=s(a(76176)),d=s(a(3123)),c=s(a(96881)),u=i(a(32597)),h=s(a(81407)),p=s(a(77508)),f=a(9690),m=s(a(38637)),v=s(a(62345)),g=a(30380),E=s(a(30520)),_=s(a(4739)),C=a(58868),S=s(a(84161)),y=s(a(47306)),I=s(a(36169)),M=s(a(94548)),P=s(a(34749)),T=s(a(18779));function L({openColorPicker:e,openEditLabel:t}){return(0,f.canEditLabel)()?r.createElement(C.MenuBarItem,{a8nText:"starred-menu",icon:r.createElement(T.default,{name:"menu"}),title:m.default.t(950)},r.createElement(h.default,{type:"dropdown_menu",flipOnRTL:!0,key:"labelChooseColor",dirX:"LEFT"},r.createElement(p.default,{a8n:"menu-item",action:e},m.default.t(832)),r.createElement(p.default,{a8n:"menu-item",action:t},m.default.t(572)))):null}L.displayName="LabelItemMenu";class b extends r.PureComponent{constructor(){super(),this._openColorPicker=()=>{var{labelId:e}=this.props,t=v.default.assertGet(e);this.props.openLabelColorDrawer(this.props.labelId,t.color)},this._openEditLabel=()=>{this.props.onEditLabel&&this.props.onEditLabel(this.props.labelId)},this.onCancelLabelSelection=()=>{this.multiSelection.unsetAll()},this.onRemoveLabel=()=>{var e=this.multiSelection.getSelected(),{onRemoveLabel:t,labelId:a}=this.props;if(t){var s=v.default.assertGet(a);(0,g.logLabelOperationEvent)(S.default.LABEL_OPERATIONS.VIEW,e.length,S.default.LABEL_TARGETS.BULK_UNLABEL_DIALOG),n.default.openModal(r.createElement(o.default,{title:m.default.t(1202,{count:e.length,labelName:s.name,_plural:e.length}),okText:m.default.t(1738),cancelText:m.default.t(1569),onCancel:this._closeModal,onOK:this._onRemoveLabelConfirmed.bind(null,a,e)}))}},this._closeModal=()=>{var e=this.multiSelection.getSelected();(0,g.logLabelOperationEvent)(S.default.LABEL_OPERATIONS.CLICK_NEGATIVE,e.length,S.default.LABEL_TARGETS.BULK_UNLABEL_DIALOG),n.default.closeModal()},this._onRemoveLabelConfirmed=(e,t)=>{n.default.closeModal(),this.onCancelLabelSelection(),this.props.onRemoveLabel(e,t),(0,g.logLabelOperationEvent)(S.default.LABEL_OPERATIONS.CLICK_POSITIVE,t.length,S.default.LABEL_TARGETS.BULK_UNLABEL_DIALOG)},this.multiSelection=new M.default([],(e=>e.id.toString()))}componentDidMount(){this.props.listeners.add(this.multiSelection,"all",(()=>this.forceUpdate())),(0,g.logLabelOperationEvent)(S.default.LABEL_OPERATIONS.VIEW,void 0,S.default.LABEL_TARGETS.LABEL_DETAILS_SCREEN)}_hasMixedSelection(e){for(var t,a,s=0;s<e.length;s++){if(e[s]instanceof I.default?a=!0:t=!0,t&&a)return!0}return!1}render(){var e=this.multiSelection.getSelected(),t=this._hasMixedSelection(e),a=this.multiSelection.getSelected().length>0?r.createElement(y.default,{labelEditEnabled:!t,onRemoveLabel:this.onRemoveLabel,selectedModels:this.multiSelection,onCancel:this.onCancelLabelSelection,theme:"drawer-header"}):r.createElement(u.default,{onBack:this.props.onClose,menu:r.createElement(L,{openColorPicker:this._openColorPicker,openEditLabel:this._openEditLabel}),type:u.DRAWER_HEADER_TYPE.LABELS},r.createElement(E.default,{labels:[this.props.labelId],renderAsCircle:!0,showName:!0,theme:"drawer-title"}));return r.createElement(d.default,{theme:"settings"},a,r.createElement(c.default,null,r.createElement(l.default,{hideMultiSelectBar:!0,multiSelection:this.multiSelection,labelFilter:this.props.labelId,settings:P.default,selectable:!0})))}}b.displayName="LabelItemDrawer";var N=(0,_.default)(b);t.Z=N},73976:(e,t,a)=>{"use strict";var s=a(14859),i=a(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(a(2784)),l=s(a(13277)),n=s(a(76176)),o=s(a(38637)),d=s(a(88609)),c=a(64828),u=s(a(68267)),h=a(74315);class p extends r.Component{constructor(...e){super(...e),this.state={licensesText:void 0},this.onOk=()=>{this.props.onOk&&this.props.onOk(),l.default.closeModal()}}componentDidMount(){}render(){var e,t;return this.state.licensesText||(e=r.createElement("div",{className:d.default.spinner,key:"spinner"},r.createElement(u.default,{size:50,stroke:4}))),this.state.licensesText&&(t=r.createElement("div",{className:d.default.textContainer},this.state.licensesText)),r.createElement(n.default,{okText:o.default.t(1738),onOK:this.onOk,type:c.FlexModalType},r.createElement("div",{className:d.default.container},r.createElement(h.TextSpan,{theme:"popup-title"},o.default.t(845)),t,e))}}t.default=p,p.displayName="LicensesPopup"},81302:(e,t,a)=>{"use strict";var s=a(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.ID_SEPARATOR=void 0;var i=s(a(75497)),r=a(78103);t.ID_SEPARATOR=",";t.default=class{constructor(...e){this.participants=new i.default,e.forEach((e=>this.add(e)))}get id(){return this.participants.map((({id:e})=>e.toString())).join(",")}get center(){var e=this.participants.map((({lat:e})=>e)),t=this.participants.map((({lng:e})=>e));return{lat:(Math.min(...e)+Math.max(...e))/2,lng:(Math.min(...t)+Math.max(...t))/2}}get lat(){return this.center.lat}get lng(){return this.center.lng}get length(){return this.participants.length}get northeast(){var e=this.participants.map((({lat:e})=>e)),t=this.participants.map((({lng:e})=>e));return{lat:Math.max(...e),lng:Math.max(...t)}}get southwest(){var e=this.participants.map((({lat:e})=>e)),t=this.participants.map((({lng:e})=>e));return{lat:Math.min(...e),lng:Math.min(...t)}}add(e){this.participants.add(e)}hasSingleParticipant(){return 1===this.length}fits(e,t,a){var{lat:s,lng:i}=this.center,{lat:l,lng:n}=e,o=(0,r.getMetersBetweenLatLngs)(s,i,s,n),d=(0,r.getMetersBetweenLatLngs)(s,i,l,i),c=(0,r.getMetersPerPixel)(s,t);return o/c<=a&&d/c<=a}}},21494:(e,t,a)=>{"use strict";var s=a(14859),i=a(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(a(2784)),l=s(a(84312)),n=s(a(51045)),o=s(a(70450)),d=s(a(85530)),c=s(a(36893)),u=s(a(14076)),h=s(a(38637)),p=s(a(26553)),f=s(a(18779)),m=s(a(9681));class v extends r.Component{constructor(...e){super(...e),this.flatListController=new u.default,this.renderListItem=e=>{var{participant:t}=e,a=t.isMe?r.createElement("div",{className:l.default.time},r.createElement(o.default,{reason:"live-location-time"},r.createElement(m.default,{participant:t}))):null;return r.createElement("div",{className:l.default.item,onClick:()=>this.props.onParticipantSelected(t.contact.id.toString())},r.createElement("div",{className:l.default.left},r.createElement(n.default,{id:t.contact.id,size:28})),r.createElement("div",{className:l.default.right},r.createElement("div",{className:l.default.name},r.createElement(p.default,{contact:t.contact,titlify:!0,ellipsify:!0,you:!0})),a))}}getListData(){return this.props.participants.map((e=>({itemKey:e.id.toString(),participant:e})))}render(){return r.createElement("div",{className:l.default.container},r.createElement("div",{className:l.default.header},r.createElement("div",{className:l.default.left},r.createElement("span",{className:l.default.close,onClick:this.props.onClearSelected},r.createElement(f.default,{name:"x"}))),r.createElement("div",{className:l.default.right},h.default.t(851,{count:this.props.participants.length,_plural:this.props.participants.length}))),r.createElement(c.default,{className:l.default.list,flatListControllers:[this.flatListController]},r.createElement(d.default,{data:this.getListData(),flatListController:this.flatListController,direction:"vertical",defaultItemHeight:48,renderItem:this.renderListItem})))}}t.default=v,v.displayName="LiveLocationClusterList"},71278:(e,t,a)=>{"use strict";var s=a(14859),i=a(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a,s){var i=new Map;if(!e.length)return i;for(var n=e.filter((e=>e!==a)).sort(((e,t)=>e.lat-t.lat)),o=function(e){var a=n[e],o=void 0;if(i.forEach((e=>{!o&&e.fits(a,t,s)&&(o=e)})),o){var d=o,c=o.id;i.delete(c),d.add(a)}else o=new r.default(a);i.set((0,l.default)(o,"clusterToAdd").id,(0,l.default)(o,"clusterToAdd"))},d=0;d<n.length;d++)o(d);if(a&&e.length!==n.length){var c=new r.default(a);i.set(c.id,c)}return i},t.participantInCluster=function(e,t){return e.split(r.ID_SEPARATOR).includes(t.toString())},t.singleParticipantClusterId=function(e){return!e.includes(r.ID_SEPARATOR)},t.findClusterForParticipant=function(e,t){var a,s=e.values();for(;(a=s.next())&&!a.done;){var i=a.value;if(i.participants.get(t))return i}return null};var r=i(a(81302)),l=s(a(21830))},60319:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getSmallestElapsedTime=a,t.isStale=function(e){return a(e)>=600},t.MARKER_SIZE=t.AVATAR_SIZE=t.PIN_SIZE=t.GLOW_SIZE=t.IMAGE_BORDER_SIZE=t.IMAGE_SIZE=t.STALE_THRESHOLD=void 0;t.STALE_THRESHOLD=600;t.IMAGE_SIZE=40;t.IMAGE_BORDER_SIZE=2;t.GLOW_SIZE=4;t.PIN_SIZE=4;t.AVATAR_SIZE=44;function a(e){var t=e.participants.map((e=>e.elapsedTime()));return Math.min(...t)}t.MARKER_SIZE=52},1503:(e,t,a)=>{"use strict";var s=a(14859),i=a(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(a(2784)),l=s(a(99461)),n=s(a(3123)),o=s(a(96881)),d=i(a(32597)),c=s(a(62536)),u=s(a(87519)),h=s(a(38637)),p=s(a(4739)),f=s(a(58343)),m=a(72369),v=s(a(9433)),g=s(a(66622)),E=s(a(90370)),_=s(a(18779));class C extends r.PureComponent{constructor(e){super(e),this.onClose=()=>{this.props.onClose?this.props.onClose():this.props.uim.uie.requestDismiss()},this.onRoadmapSelected=()=>{this.setState({mapType:m.MapType.ROADMAP})},this.onSatelliteSelected=()=>{this.setState({mapType:m.MapType.SATELLITE})},this.onTerrainSelected=()=>{this.setState({mapType:m.MapType.TERRAIN})},this.onTrafficToggled=()=>{this.setState((e=>({showTraffic:!e.showTraffic})))},this.onMarkerSelected=e=>{this.setState({markerSelected:e})},this.state={mapType:m.MapType.ROADMAP,showTraffic:!1,markerSelected:!1,online:g.default.online}}componentDidMount(){this.props.listeners.add(g.default,"change:online",(()=>{this.setState({online:g.default.online})}))}render(){var e,t,a,s,i=r.createElement(v.default,{onRoadmapSelected:this.onRoadmapSelected,onSatelliteSelected:this.onSatelliteSelected,onTerrainSelected:this.onTerrainSelected,onTrafficToggled:this.onTrafficToggled,showTraffic:this.state.showTraffic}),{finalLat:c,finalLng:p,finalTimeOffset:m,lat:g,lng:E,senderObj:C,t:S}=this.props.msg,{mapType:y,showTraffic:I,markerSelected:M,online:P}=this.state;return void 0===c||void 0===p||void 0===m?(e=g,t=E,a=S):(e=c,t=p,a=S+m),s=P?r.createElement("div",{className:u.default.wrapper},r.createElement(f.default,{contact:C,lat:e,lng:t,mapType:y,showTraffic:I,markerSelected:M,onMarkerSelected:this.onMarkerSelected}),r.createElement("div",{className:u.default.notification},r.createElement("div",{className:u.default.ended},h.default.t(852)),r.createElement("div",{className:u.default.lastUpdated},l.default.liveLocationLastUpdatedStr(a)))):r.createElement("div",{className:u.default.offline},r.createElement("div",null,r.createElement("div",{className:u.default.circle},r.createElement(_.default,{name:"live-location-disconnected"})),r.createElement("div",{className:u.default.text},h.default.t(899)))),r.createElement(n.default,null,r.createElement(d.default,{title:h.default.t(853),type:d.DRAWER_HEADER_TYPE.SMALL,menu:i,onCancel:this.onClose}),r.createElement(o.default,null,s))}}C.CONCERNS={msg:["finalLat","finalLng","finalTimeOffset","lat","lng","senderObj","t"]},C.displayName="ExpiredLocationDrawer";var S=(0,c.default)((0,p.default)((0,E.default)(C,C.CONCERNS)));t.default=S},58343:(e,t,a)=>{"use strict";var s=a(14859),i=a(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(35160),l=i(a(2784)),n=a(60238),o=a(72369),d=s(a(55601));class c extends l.Component{constructor(e){super(e),this.setMap=e=>this.map=e,this.mapOnClick=()=>{this.dismissMarkerTimer.debounceAndCap(50,100)},this.markerOnClick=()=>{this.dismissMarkerTimer.isScheduled()&&this.dismissMarkerTimer.cancel(),this.props.onMarkerSelected(!0)},this.getPixelPositionOffset=(e,t)=>({x:-e/2,y:-t}),this.dismissMarkerTimer=new r.ShiftTimer((()=>{this.props.markerSelected&&this.props.onMarkerSelected(!1)}))}componentWillUnmount(){this.dismissMarkerTimer.isScheduled()&&this.dismissMarkerTimer.cancel()}getMapPaneName(){return n.OverlayView.OVERLAY_MOUSE_TARGET}getMarkers(){var{lat:e,lng:t,contact:a,markerSelected:s}=this.props;return l.createElement(d.default,{marker:{isLive:!1,contact:a,lat:e,lng:t,selected:s,onClick:e=>this.markerOnClick(e)}})}getTrafficLayer(){return this.props.showTraffic?l.createElement(n.TrafficLayer,{autoRefresh:!0}):null}render(){var{lat:e,lng:t}=this.props;return l.createElement(n.GoogleMap,{ref:this.setMap,defaultCenter:{lat:e,lng:t},defaultOptions:this.props.getMapOptions(),defaultZoom:o.INITIAL_ZOOM,mapTypeId:this.props.mapType,onClick:this.mapOnClick},this.getMarkers(),this.getTrafficLayer())}}c.displayName="ExpiredLocationMap";var u=(0,o.withConfig)((0,n.withScriptjs)((0,n.withGoogleMap)(c)));t.default=u},53793:(e,t,a)=>{"use strict";var s=a(93291),i=a(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(a(45455)),l=i(a(12436)),n=i(a(72779)),o=s(a(2784)),d=i(a(21494)),c=s(a(71278)),u=i(a(13277)),h=a(60319),p=i(a(3123)),f=i(a(96881)),m=s(a(32597)),v=i(a(62536)),g=i(a(49639)),E=i(a(38637)),_=i(a(4739)),C=i(a(2057)),S=i(a(58952)),y=a(72369),I=i(a(9433)),M=i(a(66622)),P=i(a(62505)),T=i(a(26608)),L=i(a(90370)),b=a(47138),N=i(a(18779)),D=i(a(75632)),w=s(a(97025)),O=i(a(43926)),k=a(25054),R=["click","mousedown","mousemove","scroll"],A="ACTIVE",x="INACTIVE",F="OFFLINE";class U extends o.PureComponent{constructor(e){super(e),this._onParticipantAdd=()=>{var{zoomLevel:e,selectedParticipantId:t}=this.state;this._updateMinZoomClusters(),this.setState({clusters:this._getClusters(e,t)})},this.onParticipantRemove=e=>{var{selectedClusterId:t,selectedParticipantId:a,zoomLevel:s}=this.state;this._updateMinZoomClusters();var i=t,r=a;t&&(0,c.participantInCluster)(t,e.id)&&(i=null),O.default.equals(a,e.id)&&(r=null),this.setState({selectedClusterId:i,selectedParticipantId:r,clusters:this._getClusters(s,r)})},this._onParticipantDisable=e=>{if(!e.isMe){var t=e.contact.formattedName;u.default.openToast(o.createElement(w.default,{msg:E.default.t(876,{name:t}),id:(0,w.genId)()}))}},this.onLocationChanged=()=>{var{zoomLevel:e,selectedParticipantId:t}=this.state;this._updateMinZoomClusters(),this.setState({clusters:this._getClusters(e,t)})},this.onIdle=()=>{var{liveLocation:e}=this.props.chat;e&&(e.stopViewingMap(),this.setState({status:x}))},this.onActivity=(0,l.default)((()=>{this._removeIdleTimeout(),this._addIdleTimeout()}),250),this._onRefresh=()=>{var{liveLocation:e}=this.props.chat;e&&(e.startViewingMap(),this.setState({status:A}))},this.onClose=()=>{this.props.onClose?this.props.onClose():this.props.uim.uie.requestDismiss()},this.onMarkerSelected=e=>{e?(0,c.singleParticipantClusterId)(e)?this.onParticipantSelected(e):this._onClusterSelected(e):this.onClearSelected()},this.onClearSelected=()=>{var{selectedParticipantId:e,selectedClusterId:t,zoomLevel:a}=this.state;(e||t)&&this.setState({selectedParticipantId:null,selectedClusterId:null,clusters:this._getClusters(a)})},this._onClusterSelected=e=>{this.state.selectedClusterId!==e&&this.setState({selectedParticipantId:null,selectedClusterId:e})},this.onParticipantSelected=e=>{var{selectedParticipantId:t,zoomLevel:a}=this.state,s=(0,k.createWid)(e);O.default.equals(t,s)||this.setState({selectedParticipantId:s,selectedClusterId:null,clusters:this._getClusters(a,s)})},this.onStopSharing=e=>{e.preventDefault(),e.stopPropagation();var{chat:t}=this.props;u.default.openModal(o.createElement(C.default,{chat:t}))},this.onRoadmapSelected=()=>{this.setState({mapType:y.MapType.ROADMAP})},this.onSatelliteSelected=()=>{this.setState({mapType:y.MapType.SATELLITE})},this.onTerrainSelected=()=>{this.setState({mapType:y.MapType.TERRAIN})},this.onTrafficToggled=()=>{this.setState((e=>({showTraffic:!e.showTraffic})))},this._onBackToCenter=()=>{this.setState({selectedParticipantId:null,selectedClusterId:null,atCenter:!0,clusters:this._getClusters(this.state.zoomLevel)})},this.onMapMoved=(e,t)=>{this.setState((a=>{var s={};if(a.zoomLevel!==e){var i=this._getClusters(e,a.selectedParticipantId);Object.assign(s,{zoomLevel:e,clusters:i})}return this._hasValidParticipants()&&a.atCenter!==t&&Object.assign(s,{atCenter:t}),(0,r.default)(s)?null:s}))},this._updateMinZoomClusters(),this.state={clusters:this._getClusters(y.INITIAL_ZOOM),selectedClusterId:null,selectedParticipantId:null,mapType:y.MapType.ROADMAP,showTraffic:!1,zoomLevel:y.INITIAL_ZOOM,atCenter:!0,status:M.default.online?A:F}}componentDidMount(){this._listenToModelChange(),this._listenToNetworkChange(),this._startCheckingForIdle();var{liveLocation:e}=this.props.chat;e&&(e.startViewingMap(),this._addParticipantListeners(e))}componentWillUnmount(){this.onActivity.cancel();var{liveLocation:e}=this.props.chat;e&&e.stopViewingMap()}_addParticipantListeners(e){this.props.listeners.add(e.participants,"add",this._onParticipantAdd),this.props.listeners.add(e.participants,"remove",this.onParticipantRemove),this.props.listeners.add(e.participants,"change:disabled",this._onParticipantDisable),this.props.listeners.add(e.participants,"change:valid",this.onLocationChanged)}_removeParticipantListeners(e){this.props.listeners.remove(e.participants,"add",this._onParticipantAdd),this.props.listeners.remove(e.participants,"remove",this.onParticipantRemove),this.props.listeners.remove(e.participants,"change:disabled",this._onParticipantDisable),this.props.listeners.remove(e.participants,"change:valid",this.onLocationChanged)}_listenToModelChange(){var{chat:e}=this.props;this.props.listeners.add((0,b.unproxy)(e),"change:liveLocation",(()=>{var{liveLocation:t}=e;t&&(this._removeParticipantListeners(t),this._addParticipantListeners(t));var{zoomLevel:a}=this.state;this.setState({clusters:this._getClusters(a)})}))}_listenToNetworkChange(){this.props.listeners.add(M.default,"change:online",(()=>{M.default.online||this._stopCheckingForIdle(),this.setState({status:M.default.online?A:F})}))}_startCheckingForIdle(){this._addIdleTimeout(),this._addActivityListeners()}_stopCheckingForIdle(){this._removeIdleTimeout(),this._removeActivityListeners()}_addIdleTimeout(){this._idleTimeoutId=this.props.setTimeout(this.onIdle,18e4)}_removeIdleTimeout(){null!=this._idleTimeoutId&&this.props.clearTimeout(this._idleTimeoutId),this._idleTimeoutId=null}_addActivityListeners(){R.forEach((e=>{this.props.listeners.add(document,e,this.onActivity)}))}_removeActivityListeners(){R.forEach((e=>{this.props.listeners.remove(document,e,this.onActivity)}))}_updateMinZoomClusters(){var e=this.getParticipants(),t=e?e.validLocations():[];this._minZoomClusters=(0,c.default)(t,y.MIN_ZOOM,null,h.MARKER_SIZE)}getParticipants(){var{liveLocation:e}=this.props.chat;return e?e.participants:null}_hasValidParticipants(){var e=this.getParticipants();return!!e&&!!e.validLocations().length}_getOpenFromCluster(){var e=this.getParticipants();if(!e||0===e.length)return null;var{openFrom:t}=this.props,a=null;if(t)a=t;else{var s=e.at(0);s&&(a=s.id)}return a?(0,c.findClusterForParticipant)(this._minZoomClusters,a):null}_getClusters(e,t){var a=this.getParticipants(),s=null,i=[];a&&(t&&(s=a.get(t)),i=a.validLocations());var r=i,l=[];if(this._minZoomClusters.size>1){var n=this._getOpenFromCluster();if(n){var o=n.participants;r=o.validLocations(),l=i.filter((({id:e})=>!o.get(e)))}}return{primary:(0,c.default)(r,e,s,h.MARKER_SIZE),secondary:(0,c.default)(l,e,s,h.MARKER_SIZE)}}_getList(){var e,{clusters:t,selectedClusterId:a}=this.state,s=this.getParticipants();if(s&&s.length){if(a){var i=t.primary.get(a)||t.secondary.get(a);if(i){var r=i.participants;e=o.createElement(d.default,{participants:r,onParticipantSelected:this.onParticipantSelected,onClearSelected:this.onClearSelected})}}e||(e=o.createElement(P.default,{participants:s,onParticipantSelected:this.onParticipantSelected,onStopSharing:this.onStopSharing}))}return e}render(){var e,t;this.props.isFirstLevel?e=this.onClose:t=this.onClose;var a,s,{selectedParticipantId:i,selectedClusterId:r,mapType:l,showTraffic:d,atCenter:c,status:u}=this.state,h=u===A?o.createElement(I.default,{onRoadmapSelected:this.onRoadmapSelected,onSatelliteSelected:this.onSatelliteSelected,onTerrainSelected:this.onTerrainSelected,onTrafficToggled:this.onTrafficToggled,showTraffic:d}):null;if(u===A||u===x){var v=i&&i.toString()||r;a=o.createElement("div",{className:g.default.wrapper},o.createElement("div",{className:(0,n.default)(g.default.backToCenter,{[g.default.visible]:!c}),onClick:this._onBackToCenter},o.createElement(N.default,{name:"return"})),o.createElement(S.default,{clusters:this.state.clusters.primary,secondaryClusters:this.state.clusters.secondary,selectedMarkerId:v,openFrom:this.props.openFrom,mapType:l,showTraffic:d,atCenter:c,onMarkerSelected:this.onMarkerSelected,onClearSelected:this.onClearSelected,onLocationChanged:this.onLocationChanged,onMapMoved:this.onMapMoved}),this._getList())}if(u===x||u===F){var _=u===x,C=_?"live-location-refresh":"live-location-disconnected",y=_?E.default.t(864):E.default.t(899);s=o.createElement(T.default,{inactive:_,svgName:C,text:y,onClick:_?this._onRefresh:void 0})}return o.createElement(p.default,null,o.createElement(m.default,{title:E.default.t(877),type:m.DRAWER_HEADER_TYPE.SMALL,menu:h,onBack:t,onCancel:e}),o.createElement(f.default,null,a,s))}}U.CONCERNS={chat:["id","liveLocation"]},U.displayName="LiveLocationDrawer";var B=(0,v.default)((0,D.default)((0,_.default)((0,L.default)(U,U.CONCERNS))));t.default=B},58952:(e,t,a)=>{"use strict";var s=a(93291),i=a(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(a(54073)),l=a(35160),n=s(a(2784)),o=a(60238),d=a(72369),c=i(a(55601)),u=a(78103),h=1e-4;class p extends n.Component{constructor(e){super(e),this.setMap=e=>this.map=e,this.onLocationChanged=e=>{var{clusters:t,atCenter:a,selectedMarkerId:s}=this.props;if(this.props.onLocationChanged(),!s&&a)this._viewAllClusters();else if(s&&s===e){var i=t.get(s);i&&this._viewSingleCluster(i)}},this.onIdle=(0,r.default)((()=>{var e=this.map;if(e){var t=e.getZoom();if(this._zoomingToAllClusters){this._defaultZoomLevel=t,this._zoomingToAllClusters=!1;var a=this._zoomHistory;if(a.prev.preZoom===a.curr.postZoom&&a.prev.postZoom===a.curr.preZoom)return}this.props.onMapMoved(t,this.atCenter())}}),100),this.onDragStart=()=>{var e=this.map;if(e){var t=e.getZoom();this.props.onMapMoved(t,!1)}},this.onResize=(0,r.default)((()=>{this._setMapLatLngDiff()}),250),this.mapOnClick=()=>{this.dismissMarkerTimer.debounceAndCap(50,100)},this.markerOnClick=(e,t)=>{this.dismissMarkerTimer.isScheduled()&&this.dismissMarkerTimer.cancel(),this.props.onMarkerSelected(t)},this.dismissMarkerTimer=new l.ShiftTimer((()=>{this.props.selectedMarkerId&&this.props.onClearSelected()})),this._defaultLatDiff=this._defaultLngDiff=.01,this._defaultZoomLevel=-1,this._zoomingToAllClusters=!1,this._zoomHistory={prev:{preZoom:-1,postZoom:-1},curr:{preZoom:-1,postZoom:-1}}}componentWillUnmount(){this.onIdle.cancel(),this.onResize.cancel(),window.removeEventListener("resize",this.onResize),this.dismissMarkerTimer.isScheduled()&&this.dismissMarkerTimer.cancel()}componentDidMount(){window.addEventListener("resize",this.onResize),this._setMapLatLngDiff(),this._viewAllClusters()}componentDidUpdate(e){var{clusters:t,secondaryClusters:a,selectedMarkerId:s,atCenter:i}=this.props,{selectedMarkerId:r}=e;if(this._setMapLatLngDiff(),t.size&&(!r||s||i))if(s&&r!==s){var l=t.get(s)||a.get(s);l&&this._viewSingleCluster(l)}else!s&&i&&this._viewAllClusters()}_viewAllClusters(){var{clusters:e}=this.props;0===e.size||this.atCenter()||(this._zoomToFitAllClusters(e),this._centerAllClusters(e))}_viewSingleCluster(e){this._zoomToFitSingleCluster(e),this._centerSingleCluster(e)}_zoomToFitAllClusters(e){var t=this.map;if(t){this._zoomingToAllClusters=!0,this._zoomHistory.prev.preZoom=this._zoomHistory.curr.preZoom,this._zoomHistory.curr.preZoom=t.getZoom();var a=this.getBounds(e),s=e.entries().next();if(1!==e.size||s.done)this._boundsTooSmall(a)?t.fitBounds(this._getDefaultBounds(a.getCenter())):t.fitBounds(a);else{var[,i]=s.value;this._zoomToFitSingleCluster(i,!1)}this._zoomHistory.prev.postZoom=this._zoomHistory.curr.postZoom,this._zoomHistory.curr.postZoom=t.getZoom()}}_zoomToFitSingleCluster(e,t=!0){var a=this.map;if(a&&(!t||!this._boundsTooSmall(a.getBounds()))){var s=e.northeast,i=e.southwest,r=new google.maps.LatLng(s.lat,s.lng),l=new google.maps.LatLng(i.lat,i.lng),n=new google.maps.LatLngBounds(l,r);this._boundsTooSmall(n)?a.fitBounds(this._getDefaultBounds(n.getCenter())):a.fitBounds(n)}}_centerAllClusters(e){var t=this.getBounds(e).getCenter();this._centerMap(t)}_centerSingleCluster(e){var t=new google.maps.LatLng(e.center);this._centerMap(t)}_centerMap(e){var t=this.map;t&&(t.getCenter().equals(e)||t.panTo(e))}_getInitialCenter(){return this.getBounds(this.props.clusters).getCenter()}getBounds(e){var t=new google.maps.LatLngBounds;return e.forEach((e=>{t.extend({lat:e.lat,lng:e.lng})})),t}_boundsTooSmall(e){var t=e.getNorthEast(),a=e.getSouthWest(),s=t.lat()-a.lat(),i=t.lng()-a.lng(),r=Math.abs(s)<this._defaultLatDiff,l=Math.abs(i)<this._defaultLngDiff;return r||l}_getDefaultBounds(e){var t=new google.maps.LatLng(e.lat()-this._defaultLatDiff/2,e.lng()-this._defaultLngDiff/2),a=new google.maps.LatLng(e.lat()+this._defaultLatDiff/2,e.lng()+this._defaultLngDiff/2);return new google.maps.LatLngBounds(t,a)}atCenter(){var e=this.map;if(!e)return!0;var t=e.getCenter(),a=this._getInitialCenter(),s=t.lat()-a.lat(),i=t.lng()-a.lng();return Math.abs(s)<h&&Math.abs(i)<h&&this._defaultZoomLevel===e.getZoom()}_setMapLatLngDiff(){var e=this.map;if(e){var t=e.getCenter(),a=e.getDiv(),s=(0,u.getMetersPerPixel)(t.lat(),d.INITIAL_ZOOM),i=a.offsetWidth*s,r=a.offsetHeight*s;this._defaultLatDiff=(0,u.getLatDiff)(r),this._defaultLngDiff=(0,u.getLngDiff)(i,t.lat())}}getMarkers(){var{clusters:e,secondaryClusters:t,selectedMarkerId:a}=this.props,s=[],i=(e,t)=>{s.push(n.createElement(c.default,{key:t,marker:{isLive:!0,cluster:e,onLocationChanged:()=>this.onLocationChanged(t),selected:a===t,onClick:e=>this.markerOnClick(e,t)}}))};return e.forEach(i),t.forEach(i),s}getTrafficLayer(){return this.props.showTraffic?n.createElement(o.TrafficLayer,{autoRefresh:!0}):null}render(){return n.createElement(o.GoogleMap,{ref:this.setMap,defaultCenter:this._getInitialCenter(),defaultOptions:this.props.getMapOptions(),defaultZoom:d.INITIAL_ZOOM,mapTypeId:this.props.mapType,onClick:this.mapOnClick,onDragStart:this.onDragStart,onIdle:this.onIdle},this.getMarkers(),this.getTrafficLayer())}}p.displayName="LiveLocationMap";var f=(0,d.withConfig)((0,o.withScriptjs)((0,o.withGoogleMap)(p)));t.default=f},72369:(e,t,a)=>{"use strict";var s=a(93291),i=a(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.withConfig=function(e){return class extends l.Component{constructor(...e){super(...e),this.state={authFailed:!0===window.gm_authFailed},this._onAuthFailed=()=>{window.gm_authFailed=!0,this.setState({authFailed:!0});var e=this._getUrl(),t=String(d.default.googleMapsDoNotAuth),a=String(d.default.googleMapsKeyless);__LOG__(4,void 0,new Error,!0)`url: ${e}\ntarget: ${"web"}\nprops; ${t} & ${a}`,SEND_LOGS("google-map-auth-failed")}}componentDidMount(){window.gm_authFailure=this._onAuthFailed}componentWillUnmount(){window.gm_authFailure=void 0}_getUrl(){var e={client:"gme-whatsappinc",v:"3",libraries:"geometry,drawing,places",t:Math.floor(Date.now()/864e5)};return u.default.build("https://maps.googleapis.com/maps/api/js",e)}getMapOptions(){return{clickableIcons:!1,fullscreenControl:!1,keyboardShortcuts:!1,mapTypeControl:!1,minZoom:3,streetViewControl:!1,zoomControl:!0,zoomControlOptions:{position:google.maps.ControlPosition.TOP_RIGHT}}}render(){if(this.state.authFailed)return l.createElement("div",{className:o.default.authFailed},n.default.t(716));var t=this._getUrl(),a=l.createElement("div",{className:o.default.loading},l.createElement(c.default,{color:"highlight"})),s=l.createElement("div",{className:o.default.container}),i=l.createElement("div",{className:o.default.map});return l.createElement(e,(0,r.default)({googleMapURL:t,loadingElement:a,containerElement:s,mapElement:i,getMapOptions:this.getMapOptions},this.props))}}},t.MIN_ZOOM=t.INITIAL_ZOOM=t.MapType=void 0;var r=i(a(58527)),l=s(a(2784)),n=i(a(38637)),o=i(a(20512)),d=i(a(54559)),c=i(a(68267)),u=i(a(22006)),h=a(28103)({ROADMAP:"roadmap",SATELLITE:"satellite",TERRAIN:"terrain"});t.MapType=h;t.INITIAL_ZOOM=15;t.MIN_ZOOM=3},55601:(e,t,a)=>{"use strict";var s=a(93291),i=a(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(a(72779)),l=s(a(2784)),n=a(60238),o=i(a(91710)),d=a(60319),c=i(a(4739)),u=i(a(58512)),h=i(a(20621)),p=i(a(75632)),f=i(a(97212));class m extends l.Component{constructor(e){super(e),this._setOverlay=e=>{this.overlay=e},this.onLocationChanged=()=>{this.props.marker.isLive&&this.props.marker.onLocationChanged()},this._onLastUpdatedTimeChanged=()=>{if(this.props.marker.isLive){null!=this.timeoutId&&(this.props.clearTimeout(this.timeoutId),this.timeoutId=null);var e=(0,d.isStale)(this.props.marker.cluster);this.state.stale!==e&&this.setState({stale:e}),e||this._setStaleTimeout()}},this._getPixelPositionOffset=(e,t)=>({x:-e/2,y:-t}),this.state={stale:!e.marker.isLive||(0,d.isStale)(e.marker.cluster)}}componentDidMount(){if(this.props.marker.isLive){var{cluster:e}=this.props.marker;(0,d.isStale)(e)||this._setStaleTimeout(),e.participants.forEach((e=>{this.props.listeners.add(e,"change:lat change:lng",this.onLocationChanged),this.props.listeners.add(e,"change:lastUpdated",this._onLastUpdatedTimeChanged)}))}}_setStaleTimeout(){if(this.props.marker.isLive){var{cluster:e}=this.props.marker,t=d.STALE_THRESHOLD-(0,d.getSmallestElapsedTime)(e);t<=0||(this.timeoutId=this.props.setTimeout((()=>this.setState({stale:!0})),1e3*t))}}_getMapPaneName(){return this.props.marker.onClick?n.OverlayView.OVERLAY_MOUSE_TARGET:n.OverlayView.OVERLAY_LAYER}render(){var e,t,a,s,{onClick:i,selected:c}=this.props.marker,{stale:p}=this.state;if(this.props.marker.isLive){var{cluster:m}=this.props.marker;e=m.lat,t=m.lng,a=m.participants.map((({id:e})=>e))}else e=this.props.marker.lat,t=this.props.marker.lng,a=[this.props.marker.contact.id];if(c){var v,g,E;if(this.props.marker.isLive){var{cluster:_}=this.props.marker,C=_.participants,S=_.hasSingleParticipant()?C.at(0):null;S&&(v=S.id,g=S.accuracy,E=S.isMe)}else{var{contact:y}=this.props.marker;v=y.id,E=y.isMe}v&&(s=l.createElement(h.default,{id:v,lat:e,lng:t,accuracy:g,isMe:E||!1,markerSize:d.MARKER_SIZE}))}return l.createElement(n.OverlayView,{ref:this._setOverlay,position:{lat:e,lng:t},mapPaneName:this._getMapPaneName(),getPixelPositionOffset:this._getPixelPositionOffset},l.createElement(f.default.Provider,{value:this.context},l.createElement("div",{className:(0,r.default)(u.default.container,{[u.default.selected]:c}),onClick:i},s,l.createElement("div",{className:(0,r.default)(u.default.glow,{[u.default.stale]:p,[u.default.expired]:!this.props.marker.isLive}),style:{height:d.AVATAR_SIZE,width:d.AVATAR_SIZE,padding:d.GLOW_SIZE}},l.createElement("div",null,l.createElement(o.default,{ids:a,size:d.IMAGE_SIZE,border:!0,showCount:!0}))),l.createElement("div",{className:(0,r.default)(u.default.pin,{[u.default.selected]:c}),style:{height:d.PIN_SIZE,width:d.PIN_SIZE,marginLeft:(d.MARKER_SIZE-d.PIN_SIZE)/2}}))))}}m.contextType=f.default,m.displayName="LiveLocationMarker";var v=(0,p.default)((0,c.default)(m));t.default=v},9433:(e,t,a)=>{"use strict";var s=a(14859),i=a(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=u;var r=i(a(2784)),l=i(a(81407)),n=s(a(77508)),o=s(a(38637)),d=a(58868),c=s(a(18779));function u(e){return r.createElement(d.MenuBarItem,{a8nText:"live-location-map-menu",icon:r.createElement(c.default,{name:"menu"}),title:o.default.t(950)},r.createElement(l.default,{type:"dropdown_menu",flipOnRTL:!0,dirX:l.DirX.LEFT,dirY:l.DirY.BOTTOM},r.createElement(n.default,{a8n:"mi-roadmap-view menu-item",action:e.onRoadmapSelected},o.default.t(859)),r.createElement(n.default,{a8n:"mi-satellite-view menu-item",action:e.onSatelliteSelected},o.default.t(860)),r.createElement(n.default,{a8n:"mi-terrain-view menu-item",action:e.onTerrainSelected},o.default.t(861)),r.createElement(n.default,{a8n:"mi-traffic menu-item",action:e.onTrafficToggled},e.showTraffic?o.default.t(862):o.default.t(863))))}u.displayName="LiveLocationMenu"},62505:(e,t,a)=>{"use strict";var s=a(14859),i=a(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(a(2784)),l=s(a(10453)),n=s(a(70450)),o=s(a(85530)),d=s(a(36893)),c=s(a(14076)),u=s(a(38637)),h=s(a(36161)),p=s(a(9681));class f extends r.Component{constructor(...e){super(...e),this.flatListController=new c.default,this.renderListItem=e=>{var{participant:t}=e,a=t.valid?r.createElement(n.default,{reason:"live-location-time"},r.createElement(p.default,{participant:t})):u.default.t(885),s=t.valid?()=>this.props.onParticipantSelected(t.contact.id.toString()):null,i=t.isMe?r.createElement("div",{onClick:this.props.onStopSharing,className:h.default.stopSharingButton},u.default.t(875)):null;return r.createElement(l.default,{contact:t.contact,secondary:a,onClick:s,detail:i})}}getListData(){return this.props.participants.map((e=>({itemKey:e.id.toString(),contentKey:e.valid?"valid":"invalid",participant:e})))}render(){var e=this.getListData();return r.createElement(d.default,{className:h.default.list,flatListControllers:[this.flatListController]},r.createElement(o.default,{data:e,renderItem:this.renderListItem,flatListController:this.flatListController,direction:"vertical"}))}}f.displayName="LiveLocationParticipants";var m=f;t.default=m},20621:(e,t,a)=>{"use strict";var s=a(93291),i=a(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(a(72779)),l=s(a(2784)),n=i(a(85030)),o=i(a(13277)),d=i(a(3986)),c=i(a(43805)),u=i(a(77508)),h=a(4170),p=i(a(38637)),f=a(9613),m=i(a(26553)),v=i(a(15592)),g=i(a(18779)),E=i(a(5431)),_=i(a(43195));class C extends l.Component{constructor(e){super(e),this.mouseEnter=()=>{this.state.hover||this.setState({hover:!0})},this.mouseLeave=()=>{this.state.hover&&this.setState({hover:!1})},this._onDirection=()=>{var{lat:e,lng:t}=this.props;(0,h.openExternalLink)((0,f.getDirectionUrl)(e,t))},this.onMessage=()=>{var{id:e}=this.props;n.default.find(e).then((e=>{e.active&&o.default.existsDrawerRight((e=>{e&&2===d.default.column&&o.default.closeDrawerRight()})),o.default.openChatFromUnread(e).then((t=>{t&&o.default.focusChatTextInput(e)}))}))},this._onContextOpen=e=>{var t=e&&e.target;this.setState({contextMenu:{menu:this._getContextMenu(),anchor:t}})},this.onContextClose=()=>{this.setState({contextMenu:!1})},this.state={hover:!1,contextMenu:!1}}_getContextMenu(){var e=[];return e.push(l.createElement(u.default,{key:"direction",a8n:"get-directions",action:this._onDirection},p.default.t(691))),e.push(l.createElement(u.default,{key:"message",a8n:"send-message",action:this.onMessage},p.default.t(951))),e}render(){var{id:e,accuracy:t,isMe:a,markerSize:s}=this.props,i=c.default.assertGet(e),n=l.createElement("div",{className:v.default.name},l.createElement(m.default,{ellipsify:!0,you:!0,contact:i})),o=null!=t?l.createElement("div",{className:v.default.status},p.default.t(850,{accuracy:t,_plural:t})):null,d=a?null:l.createElement("div",{onClick:this._onContextOpen,className:v.default.menuButton},l.createElement(g.default,{name:"down"})),u=l.createElement("div",{className:v.default.triangle}),h=!a&&this.state.contextMenu?l.createElement(E.default,{displayName:"LiveLocationPopupContextMenu",escapable:!0,popable:!0,requestDismiss:this.onContextClose},l.createElement(_.default,{contextMenu:this.state.contextMenu})):null;return l.createElement("div",{className:(0,r.default)(v.default.container,{[v.default.twoLines]:!!o}),style:{transform:`translateX(calc(-50% + ${s/2}px))`}},l.createElement("div",{className:v.default.popup,onMouseOver:this.mouseEnter,onMouseEnter:this.mouseEnter,onMouseDown:this.mouseLeave,onMouseUp:this.mouseEnter,onMouseLeave:this.mouseLeave},n,o,d),u,h)}}t.default=C,C.displayName="LiveLocationPopup"},26608:(e,t,a)=>{"use strict";var s=a(14859),i=a(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=o;var r=i(a(2784)),l=s(a(49639)),n=s(a(18779));function o(e){return r.createElement("div",{className:e.inactive?l.default.inactive:l.default.offline,onClick:e.onClick},r.createElement("div",null,r.createElement("div",{className:l.default.circle},r.createElement(n.default,{name:e.svgName})),r.createElement("div",{className:l.default.text},e.text)))}o.displayName="RetryOverlay"},9681:(e,t,a)=>{"use strict";var s=a(14859),i=a(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(a(2784)),l=s(a(38637)),n=s(a(42237)),o=a(78578),d=s(a(23699)),c=(e,t=!1)=>{var a=e;t&&(a+=59);var s=a%3600;return{hours:Math.floor(a/3600),minutes:Math.floor(s/60)}},u=e=>e.isMe?(e=>{var{hours:t,minutes:a}=c(e,!0);return t>0?a>0?l.default.t(866,{hours:t,minutes:a}):l.default.t(865,{hours:t,_plural:t}):l.default.t(867,{minutes:a,_plural:a})})(e.remainingTime()):(e=>{var{hours:t,minutes:a}=c(e);return t>0?a>0?l.default.t(879,{hours:t,minutes:a}):l.default.t(878,{hours:t,_plural:t}):a>0?l.default.t(881,{minutes:a,_plural:a}):l.default.t(880)})(e.elapsedTime()),h=e=>e.isMe?e.remainingTime():e.elapsedTime(),p=({participant:e})=>{var[t,a]=r.useState((()=>u(e))),[s,i]=r.useState((()=>h(e))),{expiration:l,lastUpdated:c}=e;r.useEffect((()=>{i(h(e)%60)}),[l,c]),(0,o.useListener)(e,e.isMe?"change:expiration":"change:lastUpdated",(e=>a(u(e))));var[p,f]=(0,n.default)((()=>a(u(e))),6e4),[m]=(0,d.default)((()=>{a(u(e)),p()}),1e3*s);return r.useEffect((()=>{f(),m()}),[s,m,f]),r.createElement("span",null,t)};p.displayName="LiveLocationTime";var f=p;t.default=f},78103:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getMetersBetweenLatLngs=function(e,t,i,r){var l=s(i-e),n=s(r-t),o=Math.sin(l/2)*Math.sin(l/2)+Math.cos(s(e))*Math.cos(s(i))*Math.sin(n/2)*Math.sin(n/2),d=2*Math.atan2(Math.sqrt(o),Math.sqrt(1-o));return a*d},t.getMetersPerPixel=function(e,t){var a=Math.cos(e*Math.PI/180),s=1/Math.pow(2,t);return 156543.03392*a*s},t.getLatDiff=function(e){return i(e/a)},t.getLngDiff=function(e,t){var r=a*Math.cos(s(t));return i(e/r)};var a=6371e3;function s(e){return e*(Math.PI/180)}function i(e){return e*(180/Math.PI)}},4770:(e,t,a)=>{"use strict";var s=a(93291),i=a(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(a(34519)),l=s(a(2784)),n=i(a(36171)),o=i(a(3123)),d=i(a(96881)),c=s(a(32597)),u=a(9690),h=i(a(38637)),p=i(a(62345)),f=a(30380),m=i(a(4739)),v=i(a(44993)),g=i(a(84161)),E=s(a(64828)),_=i(a(84568)),C=i(a(94548)),S=a(47138),y=i(a(18779)),I=0,M=1,P=2;class T extends l.Component{constructor(e){super(e),this.selectedLabels=new C.default([],(e=>e.id)),this._changeSet=new Set,this.onMultiSelect=e=>{e&&(this._initialLabelState[e]===P?this._changeSet.add("{labelId}_changed"):this._changeSet.has(e)?this._changeSet.delete(e):this._changeSet.add(e),this.forceUpdate())},this._constructLabelCountMap=()=>{var e={},{modelsToUpdate:t}=this.props;return t.forEach((t=>{var a=(0,S.unproxy)(t);a.labels&&a.labels.forEach((t=>{e[t]=e[t]?++e[t]:1}))})),e},this._onUpdateLabelsOK=()=>{(0,f.logLabelOperationEvent)(g.default.LABEL_OPERATIONS.CLICK_POSITIVE,this.props.modelsToUpdate.length,g.default.LABEL_TARGETS.LABEL_COMBINED_DIALOG);var e=this.selectedLabels.list,t=this.selectedLabels.selected,a=e.map(((e,a)=>({id:e.id,type:t[a]?"add":"remove"})));p.default.addOrRemoveLabels(a,this.props.modelsToUpdate),this.props.onLabelUpdateComplete&&this.props.onLabelUpdateComplete()};var{modelsToUpdate:t}=this.props,a=this._constructLabelCountMap();this._initialLabelState=(0,r.default)(a,(e=>e===t.length?M:e>0?P:I))}render(){var e=l.createElement(n.default,{a8nText:"popup-controls-ok",type:"primary",disabled:0===this._changeSet.size,onClick:this._onUpdateLabelsOK,key:1},h.default.t(1241)),t=l.createElement(n.default,{a8nText:"popup-controls-cancel",type:"secondary",onClick:this.props.onCancel,key:0},h.default.t(1569)),a=(0,u.canEditLabel)()&&l.createElement("div",{className:v.default.newLabelBtn},l.createElement(n.default,{a8nText:"popup-controls-cancel",type:"simplified",onClick:this.props.onAddNewLabel,key:2},l.createElement(y.default,{name:"plus-large",className:v.default.plus,display:"inline"}),h.default.t(216)));return l.createElement(E.default,{type:E.TowerModalType},l.createElement(o.default,{key:"mange_label_modal",theme:"labels"},l.createElement(c.default,{title:h.default.t(834),type:c.DRAWER_HEADER_TYPE.POPUP,onCancel:this.props.onCancel}),l.createElement(d.default,{"data-list-scroll-container":!0,theme:"padding"},l.createElement(_.default,{shouldScrollIntoViewAndSelect:this.props.shouldScrollIntoViewAndSelect,initialLabelState:this._initialLabelState,selectedLabels:this.selectedLabels,renderContext:"label-selection",onLabelClick:this.props.onLabelClick,onMultiSelect:this.onMultiSelect})),a,l.createElement("div",{className:v.default.actionBtns},t,e)))}}T.displayName="ManageLabelModal";var L=(0,m.default)(T);t.default=L},99641:(e,t,a)=>{"use strict";var s=a(14859),i=a(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(37426),l=i(a(2784)),n=s(a(59083)),o=s(a(29986)),d=s(a(20698));class c extends l.Component{constructor(e){super(e),this._initCanvas=()=>{var e=this.props.editedMedia.originalImage;e.complete?this.onImageLoad():e.onload=this.onImageLoad},this.onImageLoad=()=>{var e=this.props.editedMedia.editData;this.props.editedMedia.editedImage=null;var t=this.props.editedMedia.originalImage;if(e.width||e.height||(e.width=t.naturalWidth,e.height=t.naturalHeight),!e.baseItem){var a=new r.Easel.Bitmap(t);e.baseItem=a}this.drawCanvas(!0)},this._maybeInitStage=e=>{var t;return this.state.stage?t=this.state.stage:(t=new r.Easel.Stage(e)).enableMouseOver(),this.props.mediaEditController.stage=t,t},this.drawCanvas=(e,t)=>{if(this._refStaticCanvas&&this._refStaticCanvas.refCanvas){var a=this._refStaticCanvas.refCanvas;t&&this.props.mediaPickerStatsLogger&&this.props.mediaPickerStatsLogger.logChange(this.props.activeMediaId||-1,t);var s=this.props.editedMedia,i=s.editData,r=this._maybeInitStage(a);e&&(a.width=i.width,a.height=i.height),r.removeAllChildren(),null!=i.baseItem&&r.addChild(i.baseItem),i.items&&r.addChild(...i.items);var l=s.originalImage.naturalWidth,n=s.originalImage.naturalHeight;r.regX=l/2,r.regY=n/2,r.rotation=i.rotation,i.width&&i.height&&(r.x=i.width/2+i.scale*i.offsetX,r.y=i.height/2+i.scale*i.offsetY),r.scaleX=i.scale,r.scaleY=i.scale,r.update(),this.setState({canvasSize:{width:a.width,height:a.height},stage:r})}},this.saveCanvas=()=>{this.drawCanvas(!0);var e=this._refStaticCanvas&&this._refStaticCanvas.refCanvas;e&&this.props.editedMedia.saveEditsFromCanvas(e)},this.clearStage=e=>{e&&(e.children.forEach((e=>{e.removeAllEventListeners()})),e.removeAllEventListeners(),e.removeAllChildren(),e.enableMouseOver(0),e.clear())},this._setRefStaticCanvas=e=>{this._refStaticCanvas=e},this._setRefMediaContainer=e=>{this._refMediaContainer=e},this._setRefCropOverlay=e=>{this._refCropOverlay=e},this.updateCanvasSize=(e,t)=>{this.setState({canvasSize:{width:e,height:t}})},this.state={canvasSize:{height:1,width:1},stage:null,mediaContainer:null}}componentDidMount(){this._initCanvas(),this.setState({mediaContainer:this._refMediaContainer}),this.cropOverlay=new r.Easel.Stage(this._refCropOverlay),this.cropOverlay.autoClear=!1,this.cropOverlay.enableMouseOver(),this._refMediaContainer&&(this.props.mediaEditController.mediaContainer=this._refMediaContainer),this.props.mediaEditController.cropOverlay=this.cropOverlay}componentWillUnmount(){var e=this.props.editedMedia.originalImage;e.complete||(e.onload=void 0),this.saveCanvas(),this.clearStage(this.state.stage),this.clearStage(this.cropOverlay)}render(){var e=l.createElement("canvas",{ref:this._setRefCropOverlay,className:n.default.cropOverlay});return l.createElement("div",{className:this.props.className,ref:this._setRefMediaContainer},l.createElement(o.default,{type:this.props.fitType||"scaleDown",size:this.state.canvasSize},e,l.createElement(d.default,{ref:this._setRefStaticCanvas,className:n.default.mediaViewerImg})))}}t.default=c,c.displayName="MediaEditCanvas"},55085:(e,t,a)=>{"use strict";var s=a(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(a(99778));class r extends i.default{constructor(...e){super(...e),this.stage=(0,i.prop)(),this.cropOverlay=(0,i.prop)(),this.mediaContainer=(0,i.prop)(),this.isInitialized=(0,i.derived)(this._isInitialized,["stage","cropOverlay","mediaContainer"])}_isInitialized(){return!!this.stage&&!!this.cropOverlay&&!!this.mediaContainer}clearStage(e){e&&(e.children.forEach((e=>{e.removeAllEventListeners()})),e.removeAllEventListeners(),e.removeAllChildren(),e.clear())}}var l=(0,i.defineModel)(r);t.default=l},93156:(e,t,a)=>{"use strict";var s=a(93291),i=a(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(a(25291)),l=s(a(2784)),n=i(a(32944)),o=a(81216),d=i(a(3123)),c=i(a(96881)),u=s(a(32597)),h=i(a(8451)),p=i(a(38637)),f=i(a(7635)),m=i(a(71147)),v=i(a(49398)),g=i(a(19432)),E=i(a(18779)),_=i(a(92915)),C=i(a(82838));class S extends l.Component{constructor(e){super(e),this.onImageSet=(e,t)=>{this.setState({thumb:e,full:t})},this.onContinue=()=>{var e=(0,h.default)(this.state.text.trim());(0,o.createGroup)(e,this.state.thumb,this.state.full,this.props.participants,this.state.dogfoodingGroupsInternalOnly),this.props.onContinue()},this.onSubjectChange=e=>{this.setState({text:e})},this.setRefEmojiInput=e=>{this.refEmojiInput=e},this._onDogfoodingGroupChange=()=>{var e=!this.state.dogfoodingGroupsInternalOnly;this.setState({dogfoodingGroupsInternalOnly:e})},this.state={text:e.subject||"",thumb:e.thumb,full:e.full,dogfoodingGroupsInternalOnly:!1}}componentDidMount(){this.refEmojiInput&&this.refEmojiInput.restoreFocus()}render(){var e=this.state.text.trim().length>0,t=e?l.createElement("div",{className:f.default.nextButton},l.createElement(g.default,{a8nText:"create-group-btn",onClick:(0,r.default)(this.onContinue)},l.createElement(E.default,{name:"checkmark-medium"}))):null;return l.createElement(d.default,null,l.createElement(u.default,{title:p.default.t(1090),type:u.DRAWER_HEADER_TYPE.LARGE,onBack:this.props.onBack}),l.createElement(c.default,null,l.createElement("div",{className:f.default.section},l.createElement(m.default,{type:v.default.GROUP,attachToChat:!1,startImage:this.state.full,onImageSet:this.onImageSet})),l.createElement("div",{"data-a8n":n.default.key("group-subject"),className:f.default.section},l.createElement(_.default,{ref:this.setRefEmojiInput,value:this.state.text,maxLength:25,showRemaining:!0,onChange:this.onSubjectChange,placeholder:p.default.t(759),onEnter:e?(0,r.default)(this.onContinue):()=>{},supportsEmoji:!0})),null,l.createElement(C.default,{transitionName:"btn"},t)))}}t.default=S,S.displayName="NewGroupDrawer"},46183:(e,t,a)=>{"use strict";var s=a(93291),i=a(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(a(90882)),l=i(a(45455)),n=i(a(17335)),o=i(a(72779)),d=s(a(2784)),c=i(a(32944)),u=a(25559),h=i(a(13277)),p=i(a(76176)),f=i(a(43805)),m=i(a(74311)),v=i(a(3123)),g=i(a(96881)),E=s(a(32597)),_=a(83251),C=s(a(24461)),S=i(a(36893)),y=i(a(14076)),I=i(a(5338)),M=i(a(18792)),P=i(a(19058)),T=i(a(38637)),L=i(a(3349)),b=i(a(45632)),N=i(a(56322)),D=i(a(85185)),w=i(a(19432)),O=a(64812),k=i(a(54559)),R=i(a(68267)),A=i(a(18779)),x=s(a(97025)),F=i(a(82838)),U=(0,x.genId)("max_participant_toast");class B extends d.Component{constructor(...e){super(...e),this.state={searchText:"",participants:this.props.participants,shouldFocus:!0,isBusy:!1},this.flatListController=new y.default,this.setRefParticipantList=e=>{this.refParticipantList=e},this.setRefList=e=>{this.refList=e},this.onKeyDown=e=>{if("Backspace"===e.key&&!this.state.searchText&&!(0,l.default)(this.state.participants)){e.preventDefault();var t=this.state.participants;this.setState({participants:t.slice(0,t.length-1),shouldFocus:!0})}},this.onInput=e=>{this.setState({searchText:e.target.value})},this.onReset=()=>{this.setState({searchText:"",shouldFocus:!0})},this.focus=()=>{M.default.focus(this.refInput)},this.onBack=()=>{this.props.onBack()},this.onContinue=()=>{this.props.onContinue(this.state.participants)},this.onDelete=(e,t)=>{var a=(0,r.default)(this.state.participants,(e=>!e.id.equals(t.id)));this.setState({participants:a,shouldFocus:!a.length})},this.onContactClick=(e,t)=>{this.state.participants.find((e=>e.id.equals(t.id)))?this._removeContact(t):t.isBlocked()?h.default.openModal(d.createElement(p.default,{title:T.default.t(207),onOK:()=>{this._unblockAndAddContact(t),h.default.closeModal()},onCancel:()=>h.default.closeModal(),okText:T.default.t(1872),cancelText:T.default.t(1733)},T.default.t(205))):this.addContact(t)},this.onFocusList=e=>{this.refList&&(e.preventDefault(),e.stopPropagation(),I.default.shouldIndicateFocus(),this.refList&&this.refList.focusFirst())},this._onFocusParticipants=e=>{e.repeat||this.refInput&&0!==this.refInput.selectionStart||this.refParticipantList&&(e.preventDefault(),e.stopPropagation(),P.default.flashFocus=0,this.refParticipantList&&this.refParticipantList.focusLast())},this.onSelectFirst=e=>{e.preventDefault(),e.stopPropagation();var t=this.getFilteredContacts()[0];t&&this.onContactClick(e,t)},this.onFocusSearch=()=>{I.default.shouldIndicateFocus(),M.default.focus(this.refInput)},this.setRefInput=e=>{this.refInput=e},this._setRefSizer=e=>{this._refSizer=e}}componentDidMount(){this.focus()}componentDidUpdate(){this._adjustInput()}getFilteredContacts(){var e=(0,n.default)(f.default.getFilteredContacts(),this.state.participants),t=this.state.searchText;if(!t)return e;t=T.default.accentFold(t);var a=(0,b.default)(t);return e.filter((e=>e.searchMatch(t,a)))}_adjustInput(){if(this.refInput){var e,t=this.refInput.offsetParent.offsetWidth-10,a=this._refSizer.offsetWidth,s=a>t?t:a;this.refInput.style.width=s+"px",e=t-this.refInput.offsetLeft-s>0?t-this.refInput.offsetLeft:t,this.refInput.style.width=e+"px",this.state.shouldFocus&&this.focus()}}addContact(e){var t=this.state.participants;if(t.length>=k.default.maxParticipants){var a=T.default.t(96,{max:k.default.maxParticipants});h.default.openToast(d.createElement(x.default,{msg:a,id:U}))}else this.setState({participants:t.concat(e),searchText:"",shouldFocus:!0})}_removeContact(e){var t=this.state.participants;this.setState({participants:(0,r.default)(t,(t=>!e.id.equals(t.id))),shouldFocus:!0})}_unblockAndAddContact(e){this.setState({isBusy:!0}),(0,u.unblockContact)(e).checkpoint(this.props.rejectOnUnmount()).then((()=>{this.addContact(e),this.setState({isBusy:!1})})).catchType(C.Unmount,(()=>{})).catch((()=>{this.setState({isBusy:!1})}))}render(){var e;this.state.isBusy?e=d.createElement("div",{className:L.default.spinner},d.createElement(R.default,{stroke:6,size:24})):this.state.participants&&this.state.participants.length&&(e=d.createElement(w.default,{a8nText:"group-participants-btn",onClick:this.onContinue},d.createElement(A.default,{name:"arrow-forward",directional:!0})));var t=this.state.participants&&this.state.participants.length?" ":T.default.t(746),a={down:this.onFocusList,enter:this.state.searchText?this.onSelectFirst:this.state.participants&&this.state.participants.length?this.onContinue:()=>{},up:this._onFocusParticipants};a[T.default.LR("left","right")]=this._onFocusParticipants;var s,i=this.getFilteredContacts();return s=0===i.length?d.createElement(_.SearchContacts,null):d.createElement(m.default,{ref:this.setRefList,flatListController:this.flatListController,contacts:i,onClick:this.onContactClick,onFocusSearch:this.onFocusSearch,showPersonGroupDivisionHeader:!1}),d.createElement(v.default,null,d.createElement(E.default,{title:T.default.t(214),type:E.DRAWER_HEADER_TYPE.LARGE,onBack:this.onBack}),d.createElement(g.default,null,d.createElement("div",{className:L.default.search},d.createElement("div",null,d.createElement(P.default,{handlers:a,className:L.default.inputLine},d.createElement("div",{"data-list-scroll-container":!0},d.createElement(N.default,{ref:this.setRefParticipantList,theme:"list-names",contacts:this.state.participants,onDelete:this.onDelete,onFocusSearch:this.onFocusSearch})),d.createElement("input",{"data-a8n":c.default.key("inputarea"),className:(0,o.default)(L.default.inputarea,O.SELECTABLE_INPUT_CSS_CLASS),ref:this.setRefInput,placeholder:t,onKeyDown:this.onKeyDown,onChange:this.onInput,value:this.state.searchText,type:"text"}),d.createElement("span",{className:L.default.inputareaSizer,ref:this._setRefSizer},this.state.searchText)))),d.createElement(S.default,{className:L.default.contacts,flatListControllers:[this.flatListController]},s),d.createElement(F.default,{transitionName:"btn",className:L.default.drawerSection},e)))}}B.defaultProps={participants:[]},B.displayName="NewGroupParticipantsDrawer";var G=(0,D.default)(B);t.default=G},13087:(e,t,a)=>{"use strict";var s=a(93291),i=a(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(a(2629)),l=i(a(3123)),n=i(a(96881)),o=s(a(32597)),d=i(a(38637)),c=i(a(96997)),u=s(a(2784));t.default=e=>u.createElement(l.default,null,u.createElement(o.default,{a8n:"drawer-title-notifications",title:d.default.t(1108),onBack:e.onClose,type:o.DRAWER_HEADER_TYPE.LARGE}),u.createElement(n.default,null,u.createElement(r.default,{key:"notifications",mute:c.default.globalMute()})))},48834:(e,t,a)=>{"use strict";var s=a(14859),i=a(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(a(2784)),l=s(a(32944)),n=a(19999),o=s(a(89962)),d=s(a(65610)),c=a(38312),u=s(a(13277)),h=s(a(76176)),p=s(a(79435)),f=s(a(23045)),m=s(a(737)),v=s(a(3123)),g=s(a(96881)),E=s(a(84755)),_=i(a(32597)),C=s(a(84340)),S=s(a(94773)),y=s(a(8451)),I=i(a(24461)),M=a(66239),P=a(9690),T=s(a(62536)),L=s(a(19813)),b=s(a(38637)),N=s(a(84161)),D=a(55439),w=s(a(25086)),O=s(a(58464)),k=s(a(38658)),R=s(a(85185)),A=s(a(54559)),x=a(57614),F=s(a(90370)),U=a(88956),B=a(74315),G=s(a(92915)),H=s(a(58025));class V extends r.Component{constructor(e){super(e),this.onBack=()=>{this.props.onClose?this.props.onClose():this.props.uim.uie.requestDismiss()},this._validateStatus=e=>!!(e||"").trim(),this._onStatusBegin=()=>{this._isEditingStatus=!0},this._onSetStatusError=()=>{u.default.openModal(r.createElement(h.default,{onOK:()=>u.default.closeModal(),okText:b.default.t(1738)},b.default.t(195)))},this._onSetStatus=()=>{if(null!=this.state.status){this._isEditingStatus=!1;var e=this.props.status.status,t=(0,y.default)(this.state.status);if(t===e)return this.setState({status:t});this.setState({pendingStatus:!0}),(0,U.setMyStatus)((0,y.default)(this.state.status)).checkpoint(this.props.rejectOnUnmount()).then((()=>{this.setState({pendingStatus:!1})})).catchType(I.Unmount,(()=>{}))}else this._onCancelStatus()},this.onStatusChange=e=>{this.setState({status:e})},this._onCancelStatus=()=>{this._isEditingStatus=!1,this.setState({status:this.props.status.status})},this._onPushnameBegin=()=>{this._isEditingPushname=!0},this._validatePushname=()=>{var e,{pushname:t}=this.state;return(t=(t||"").trim())?/[\u2714\u2705\u2611]/g.test(t)&&(e=b.default.t(190)):e=b.default.t(187),!e||(this._onSetPushnameError(e),!1)},this._onSetPushname=()=>{if(this._isEditingPushname=!1,p.default.canSetMyPushname()){var{pushname:e}=this.state;if((e=(0,y.default)((e||"").trim()))===this.props.conn.pushname)return this.setState({pushname:e});this.setState({pendingPushname:!0}),(0,x.setPushname)(e).checkpoint(this.props.rejectOnUnmount()).then((()=>{this.setState({pendingPushname:!1})})).catchType(I.Unmount,(()=>{}))}},this._onSetPushnameError=e=>{u.default.openModal(r.createElement(h.default,{onOK:()=>u.default.closeModal(),okText:b.default.t(1738)},e))},this._onPushnameChange=e=>{this.setState({pushname:e})},this._onCancelPushname=()=>{this._isEditingPushname=!1,this.setState({pushname:this.props.conn.pushname})},this.state={pushname:e.conn.pushname,status:e.status.status,pendingPushname:!1,pendingStatus:!1,catalog:null}}componentDidMount(){p.default.isSMB&&(0,P.canEditBizProfile)()&&o.default.find((0,M.getMeUser)()).then((e=>{this.setState({catalog:e})})).catch((()=>{}));var{session:e}=(0,D.getProductCatalogContext)(this.context);e.isAccidental()&&u.default.setDrawerContext("left",(0,D.buildProductCatalogContext)(new w.default,N.default.BIZ_PLATFORM.SMB,N.default.CATALOG_ENTRY_POINT.CATALOG_ENTRY_POINT_SETTINGS))}renderProductCatalogSection(){var e,t;if(A.default.shopsProfileDrawerEntrypoint&&(null===(e=this.props.contact.businessProfile)||void 0===e||null===(t=e.profileOptions)||void 0===t?void 0:t.commerceExperience)===n.COMMERCE_EXPERIENCE_TYPES.SHOP)return null;var{session:a}=(0,D.getProductCatalogContext)(this.context);return a.isAccidental()?null:r.createElement(d.default,{catalog:this.state.catalog,onProductDetail:c.openCatalogManagementFlow,onProductCatalog:()=>(0,c.openCatalogManagementFlow)(),productsToShow:3,catalogEntryLabel:null==this.state.catalog?b.default.t(208):b.default.t(1454),showProductPlaceholders:!0,seeMoreOverlay:!0,sectionTheme:"refresh"})}_renderAboutInput(){var{status:e}=this.props,t=this._isEditingStatus||this.state.pendingStatus?this.state.status:e.status;return r.createElement(G.default,{a8n:"col-main-profile-input",value:t,editable:!0,pending:this.state.pendingStatus,showRemaining:!0,validate:this._validateStatus,maxLength:f.default.MAX_STATUS_LENGTH,onBeginEdit:this._onStatusBegin,onChange:this.onStatusChange,onSave:this._onSetStatus,onError:this._onSetStatusError,onCancel:this._onCancelStatus,theme:"text-input",supportsEmoji:!0,lockable:!0,lowProfile:!0})}_renderStandardEditSection(){var{conn:e}=this.props,t=this._isEditingPushname||this.state.pendingPushname?this.state.pushname:e.pushname,a=p.default.isSMB?b.default.t(313):b.default.t(1196),s=r.createElement(C.default,{a8nText:"col-main-profile",title:b.default.t(1818),theme:"padding"},this._renderAboutInput());return r.createElement(r.Fragment,null,r.createElement(C.default,{a8nText:"col-main-profile",title:b.default.t(1195),theme:"padding"},r.createElement(G.default,{a8n:"col-main-profile-input",value:t,editable:p.default.canSetMyPushname(),pending:this.state.pendingPushname,showRemaining:!0,validate:this._validatePushname,maxLength:f.default.MAX_PUSHNAME_LENGTH,onBeginEdit:this._onPushnameBegin,onChange:this._onPushnameChange,onSave:this._onSetPushname,onCancel:this._onCancelPushname,supportsEmoji:!0,lockable:!0,lowProfile:!0})),r.createElement("div",{"data-a8n":l.default.key("pushname-description"),className:O.default.nameWrapper},r.createElement(B.TextSpan,{theme:"muted"},a)),s)}_renderSection(e){return r.createElement(L.default,e)}_renderAboutSection(){var e=this._renderSection({icon:"info",content:this._renderAboutInput()}),t=this._renderSection({icon:"call-phone",iconClass:O.default.phoneIcon,content:r.createElement("div",null,r.createElement("div",{className:O.default.phoneField},(0,H.default)((0,M.assertGetMe)())),r.createElement("div",{className:O.default.infoText},b.default.t(333)))});return r.createElement(C.default,{title:b.default.t(323),theme:"refresh"},e,t)}_renderEditBizProfileEditSection(){return r.createElement("div",null,r.createElement(S.default,null),this.renderProductCatalogSection(),this._renderAboutSection())}_renderCoverPhoto(){return r.createElement(C.default,{theme:"padding-no-margin"},r.createElement(m.default,{contact:this.props.contact,editable:!0,profilePicThumb:this.props.profilePicThumb,hideStatusV3:!0}))}_renderProfilePicture(){return r.createElement("div",{className:O.default.photoPickerWrapper},r.createElement(k.default,{profilePicThumb:this.props.profilePicThumb}))}render(){var e=(0,P.canSeeBizProfileV3)()&&p.default.isSMB?this._renderCoverPhoto():this._renderProfilePicture(),t=(0,P.canEditBizProfile)()?this._renderEditBizProfileEditSection():this._renderStandardEditSection(),a=b.default.t(942);return r.createElement(v.default,null,r.createElement(_.default,{a8n:"drawer-title-profile",title:a,onBack:this.onBack,type:_.DRAWER_HEADER_TYPE.LARGE}),r.createElement(g.default,null,e,t))}}V.contextType=E.default,V.CONCERNS={contact:["businessProfile","id","statusMute"],profilePicThumb:["imgFull","id"],status:["status"],conn:["pushname"]},V.displayName="ProfileDrawer";var j=(0,T.default)((0,R.default)((0,F.default)(V,V.CONCERNS)));t.default=j},11537:(e,t,a)=>{"use strict";var s=a(14859),i=a(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(a(2784)),l=s(a(93257)),n=s(a(3123)),o=s(a(96881)),d=i(a(32597)),c=s(a(84340)),u=s(a(4170)),h=a(55848),p=a(66368),f=a(66239),m=a(9690),v=s(a(38637)),g=s(a(37788)),E=a(13213),_=s(a(18779)),C=a(74315);class S extends r.PureComponent{constructor(e){super(e),this._onSecurityNotificationChange=()=>{var e=!this.state.securityNotificationEnabled;(0,f.setGlobalSecurityNotifications)(e),this.setState({securityNotificationEnabled:e})},this.state={securityNotificationEnabled:(0,f.getGlobalSecurityNotifications)()}}render(){var e=(0,m.bspUiEnabled)(),t=e?r.createElement(r.Fragment,null,v.default.t(1266)," ",r.createElement(u.default,{href:(0,h.getCodeChangeFaqUrl)()},v.default.t(844))):v.default.t(1265);return r.createElement(n.default,null,r.createElement(d.default,{a8n:"drawer-title-security",title:v.default.t(1271),onBack:this.props.onClose,type:d.DRAWER_HEADER_TYPE.LARGE}),r.createElement(o.default,null,r.createElement(c.default,{theme:"padding-large",animation:!1},r.createElement(p.FlexColumn,{className:g.default.icon,align:"center",justify:"center"},r.createElement(p.FlexItem,null,r.createElement(_.default,{name:"security-shield"})),r.createElement(p.FlexColumn,{className:g.default.iconLock,align:"center",justify:"center"},r.createElement(p.FlexItem,null,r.createElement(_.default,{name:"security-lock"})))),r.createElement("div",{className:g.default.text},e?v.default.t(1270):v.default.t(1269)," ",r.createElement(u.default,{href:e?(0,E.securityUrl)():(0,h.getCodeChangeFaqUrl)()},e?v.default.t(1264):v.default.t(844))),r.createElement(p.FlexRow,{className:g.default.controls},r.createElement("div",{className:g.default.checkbox},r.createElement(l.default,{onChange:this._onSecurityNotificationChange,checked:this.state.securityNotificationEnabled})),r.createElement(p.FlexItem,null,r.createElement("div",{className:g.default.header},r.createElement(C.TextSpan,{theme:"title"},e?v.default.t(1268):v.default.t(1267))),r.createElement(C.TextDiv,{theme:"muted"},t))))))}}t.default=S,S.displayName="SecurityDrawer"},96638:(e,t,a)=>{"use strict";var s=a(14859),i=a(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(a(2784)),l=s(a(13277)),n=s(a(76176)),o=s(a(30905)),d=s(a(38637));class c extends r.Component{constructor(...e){super(...e),this.onCancel=()=>{l.default.closeModal(),this.props.onOK()}}render(){var e=this.props.name||d.default.t(500),t=d.default.t(1301,{name:e});return r.createElement(n.default,{onOK:this.onCancel,okText:d.default.t(1738)},r.createElement("div",null,r.createElement(o.default,{text:t})))}}t.default=c,c.displayName="SendMsgToVerifyIdentityPopup"},77953:(e,t,a)=>{"use strict";var s=a(14859),i=a(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(a(2784)),l=s(a(78523)),n=s(a(79435)),o=i(a(51045)),d=s(a(3123)),c=s(a(96881)),u=s(a(73018)),h=i(a(32597)),p=s(a(30905)),f=a(66239),m=a(9690),v=s(a(38637)),g=s(a(90370)),E=s(a(16426)),_=s(a(18779)),C=s(a(20468));class S extends r.PureComponent{render(){var e,t,a,s=r.createElement(E.default,{id:this.props.profileId}),i=r.createElement(o.default,{id:(0,f.getMaybeMeUser)(),size:82,quality:o.DETAIL_IMAGE_QUALITY.HIGH}),g=r.createElement(p.default,{text:n.default.pushname,ellipsify:!0,titlify:!0});return(0,m.archiveV2Supported)()&&this.props.settings.archive.enabled&&(a=r.createElement(u.default,{icon:r.createElement(_.default,{name:"archived"}),onClick:this.props.onArchiveSettings},v.default.t(230))),C.default.supportsFeature(C.default.F.MD_BACKEND)&&(t=r.createElement(u.default,{a8nText:"li-security",icon:r.createElement(_.default,{name:"settings-security"}),onClick:this.props.onSecurity},v.default.t(944))),e=r.createElement(u.default,{a8nText:"li-keyboard-shortcuts",icon:r.createElement(_.default,{name:"settings-keyboard"}),onClick:this.props.onKeyboardShortcuts},v.default.t(829)),r.createElement(d.default,{theme:"settings"},r.createElement(h.default,{title:v.default.t(1305),onBack:this.props.onClose,type:h.DRAWER_HEADER_TYPE.LARGE}),r.createElement(c.default,null,r.createElement(l.default,{onClick:this.props.onProfile,image:i,primary:g,theme:"identity",secondary:s}),r.createElement(u.default,{a8nText:"li-notifications",icon:r.createElement(_.default,{name:"settings-notifications"}),onClick:this.props.onNotifications},v.default.t(940)),t,r.createElement(u.default,{icon:r.createElement(_.default,{name:"settings-theme"}),onClick:this.props.onThemeSettings},v.default.t(947)),r.createElement(u.default,{icon:r.createElement(_.default,{name:"settings-wallpaper"}),onClick:this.props.onWallpaper},v.default.t(948)),a,r.createElement(u.default,{a8nText:"li-blocked",icon:r.createElement(_.default,{name:"settings-blocked"}),onClick:this.props.onBlocked},v.default.t(934)),undefined,e,r.createElement(u.default,{a8nText:"li-help",icon:r.createElement(_.default,{name:"settings-help"}),onClick:this.props.onHelp},v.default.t(936)),undefined,undefined,undefined,undefined,undefined))}}S.CONCERNS={settings:["archive"]},S.displayName="SettingsDrawer";var y=(0,g.default)(S,S.CONCERNS);t.default=y},95782:(e,t,a)=>{"use strict";var s=a(93291),i=a(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(a(12436)),l=s(a(2784)),n=a(62820),o=i(a(99461)),d=i(a(13277)),c=i(a(23045)),u=i(a(13752)),h=i(a(3123)),p=i(a(96881)),f=s(a(32597)),m=a(83251),v=s(a(24461)),g=i(a(18792)),E=a(66239),_=i(a(20468)),C=i(a(62536)),S=i(a(19058)),y=i(a(38637)),I=i(a(4739)),M=a(58868),P=i(a(85185)),T=i(a(91033)),L=i(a(99979)),b=i(a(68267)),N=i(a(10266)),D=i(a(15100)),w=i(a(58987)),O=i(a(18779)),k=i(a(82838));class R extends l.Component{constructor(e){super(e),this._msgRefs={},this._setRefHotKeys=e=>{this._refHotKeys=e},this._refScrollContainer=l.createRef(),this._getInitialState=()=>{var{starredMsgs:e}=this.props;return{cursor:T.default.create({msgCollection:e,type:c.default.RENDER_CURSOR.STARRED_DRAWER}).loadAfter(e,{count:c.default.MSG_PRELOAD_THRESHOLD})}},this._handleStarChange=()=>{this._initSelectionObjects(),this.forceUpdate()},this._initSelectionObjects=()=>{var e=this.props.starredMsgs.toArray();this._currSelection.init(e,!0),this._activeSelection.init(e)},this.setRefMsgComponent=(e,t)=>{t?this._msgRefs[e.id.toString()]=t:delete this._msgRefs[e.id.toString()]},this.loadEarlierMsgs=()=>{var e=this.state.cursor,t=this.props.chat&&this.props.chat.id,{starredMsgs:a}=this.props,s=a.models;if(e.getEnd(a)<s.length)this.setState({cursor:e.loadAfter(a)});else{if(a.isSynced)return;this.props.starredMsgs.sync(t).checkpoint(this.props.rejectOnUnmount()).then((()=>{e.hasAfter(a)&&this.setState({cursor:e.loadAfter(a)})})).catchType(v.Unmount,(()=>{})).catch((e=>{__LOG__(2)`StarredDrawer:loadEarlierMsgs failed\n${e}`}))}},this.onClose=()=>{this.props.onClose?this.props.onClose():this.props.uim.uie.requestDismiss()},this.focus=()=>{this._refHotKeys&&g.default.focus(this._refHotKeys)},this.onFocusGain=e=>{this._refHotKeys&&((e?e.target:document.activeElement)===this._refHotKeys&&(this._currSelection.index<0?this._currSelection.setFirst(!0):this._currSelection.reset(!1)))},this._onNextMsg=e=>{e&&(e.preventDefault(),e.stopPropagation());var t=this._currSelection.next();this._currSelection.index!==t&&this._currSelection.setNext(!0)},this._onPrevMsg=e=>{e&&(e.stopPropagation(),e.preventDefault()),this._currSelection.prev()>-1&&this._currSelection.setPrev(!0)},this.onScroll=e=>{this.handleScroll(e.currentTarget)},this._handleScroll=e=>{this.updateMsgListInfo(),function(e){return e.scrollTop+c.default.SCROLL_FUDGE>e.scrollHeight-e.clientHeight}(e)&&this.loadEarlierMsgs()},this._selectMsg=e=>{this._currSelection.setVal(e),this._activeSelection.setVal(e),d.default.openChatAt(e.chat,e.chat.getSearchContext(e)),d.default.focusShowMsg(e.id)},this._getMsgList=()=>{var e=this.state.cursor,{starredMsgs:t}=this.props,a=t.toArray(),s=t.isSynced?e.getEnd(t):Math.min(e.getEnd(t),a.length);return a=a.slice(e.getStart(t),s),this.length=a.length,a},this.getMsgVisibility=e=>{if(!e)return c.default.VISIBILITY.BELOW;var t=this._refScrollContainer.current;if(t){var a=t.previousSibling;if(a&&a instanceof HTMLElement){var s=a.clientHeight,i=t.scrollTop+s,r=i+t.clientHeight,l=e.getContainerElement();return l?l.offsetTop+l.clientHeight<=i?c.default.VISIBILITY.ABOVE:l.offsetTop>=r?c.default.VISIBILITY.BELOW:c.default.VISIBILITY.VISIBLE:c.default.VISIBILITY.BELOW}}},this.isMsgVisible=(e,t=!1)=>!!this._msgListInfo.visibleMsgs[e.toString()]&&(!!t||this.getMsgComponent(e)),this.getMsgComponent=e=>{var t=this._msgRefs[e.toString()];if(t){var a=t.getWrapperRef();return a&&"function"==typeof a.getMsgComponentRef?a.getMsgComponentRef():void 0}},this._updateMsgListInfo=()=>{for(var e=this._getMsgList(),t={},a=0,s=this.length-1;a<s;){var i=Math.floor((a+s)/2),r=this._msgRefs[e[i].id.toString()];this.getMsgVisibility(r)===c.default.VISIBILITY.ABOVE?a=i+1:s=i}for(var l=a;l<e.length;l++){var n=this._msgRefs[e[l].id.toString()];if(this.getMsgVisibility(n)!==c.default.VISIBILITY.VISIBLE)break;t[e[l].id.toString()]=!0}this.pauseHiddenGifs(this._msgListInfo.visibleMsgs,t),this._msgListInfo.visibleMsgs=t},this.pauseHiddenGifs=(e,t)=>{for(var a in e)if(!t[a]){var s=this.props.starredMsgs.get(a);if(s&&s.isGif){var i=this.getMsgComponent(a);i&&i.playCount&&i.pause()}}},this.handleScroll=(0,r.default)(this._handleScroll,100),this.updateMsgListInfo=(0,r.default)(this._updateMsgListInfo,100),this._msgListInfo={visibleMsgs:{}},this.state=this._getInitialState(),this._currSelection=new L.default([],(e=>e.id.toString())),this._activeSelection=new L.default([],(e=>e.id.toString())),this._initSelectionObjects()}componentDidMount(){this.focus(),this.props.listeners.add(window,"resize",this.updateMsgListInfo),!this.props.starredMsgs.isSynced&&this.props.starredMsgs.length<c.default.PAGE_SIZE&&this.props.listeners.uiIdle(this.loadEarlierMsgs),this.props.listeners.add(this.props.starredMsgs,"reset sync",(()=>{this._initSelectionObjects(),this.forceUpdate()})),this.props.listeners.add(this.props.starredMsgs,"add remove",this._handleStarChange),this.onFocusGain(),this.props.listeners.add(this.props.starredMsgs,"reset",(()=>{this._msgListInfo={visibleMsgs:{}},this.setState(this._getInitialState()),this.loadEarlierMsgs()}))}componentWillUnmount(){this.handleScroll.cancel(),this.updateMsgListInfo.cancel()}componentDidUpdate(){this.updateMsgListInfo()}render(){var e,t,a=this._getMsgList(),s=this.state.cursor,{starredMsgs:i}=this.props,r=this.props.chat||null;if(t=i.isSynced&&s.getEnd(i)>=a.length?null:this.props.starredMsgs.syncPromise?l.createElement("div",{className:N.default.more,title:y.default.t(886)},l.createElement(b.default,{stroke:6,size:24})):l.createElement("div",{className:N.default.more},l.createElement("div",{title:y.default.t(883),onClick:this.loadEarlierMsgs},l.createElement(O.default,{name:"refresh"}))),a.length>0){var d=a.map((e=>{var t=e.type===c.default.MSG_TYPE.IMAGE||e.type===c.default.MSG_TYPE.VIDEO||e.type===c.default.MSG_TYPE.AUDIO;return l.createElement(w.default,{key:e.id.toString(),ref:t=>{this.setRefMsgComponent(e,t)},msg:e,isMsgVisible:t?this.isMsgVisible:()=>{},currSelection:this._currSelection,activeSelection:this._activeSelection,onClickMsg:this._selectMsg})}));e=l.createElement(k.default,{transitionName:"slide"},d)}else this.props.starredMsgs.isSynced?e=l.createElement(m.StarredMsgs,null):(e=l.createElement(m.Loading,null),t=null);var v,g={down:this._onNextMsg,up:this._onPrevMsg},C=a.length>0?l.createElement(M.MenuBarItem,{a8nText:"starred-menu",icon:l.createElement(O.default,{name:"menu"}),title:y.default.t(950)},l.createElement(D.default,{chat:r,msgs:a})):null;if(_.default.supportsFeature(_.default.F.MD_BACKEND)&&(!r||r&&r.endOfHistoryTransferType===n.ConversationEndOfHistoryTransferModelPropType.COMPLETE_BUT_MORE_MESSAGES_REMAIN_ON_PRIMARY)){var I=o.default.relativeDateStr((0,E.getHistorySyncEarliestDate)());v=l.createElement(u.default,{icon:l.createElement(O.default,{name:"content-chat"}),theme:"list",secondary:y.default.t(516,{date:I})},y.default.t(514))}return l.createElement(h.default,{theme:"gallery"},l.createElement(S.default,{className:N.default.hotKeyWraper,handlers:g,onFocus:this.onFocusGain,"data-tab":c.default.TAB_ORDERS.CHAT_STARRED_DRAWER,onRef:this._setRefHotKeys},l.createElement(f.default,{title:y.default.t(1316),onBack:this.onClose,type:f.DRAWER_HEADER_TYPE.LARGE,menu:C}),l.createElement(p.default,{onScroll:this.onScroll,ref:this._refScrollContainer},e,t,v)))}}R.displayName="StarredDrawer";var A=(0,C.default)((0,P.default)((0,I.default)(R)));t.default=A},15100:(e,t,a)=>{"use strict";var s=a(14859),i=a(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(a(2784)),l=s(a(13277)),n=s(a(81407)),o=s(a(77508)),d=s(a(38637)),c=s(a(64092));class u extends r.Component{constructor(...e){super(...e),this.sendUnstarAll=()=>{l.default.openModal(r.createElement(c.default,{msgs:this.props.msgs,chat:this.props.chat}))}}getElement(){return this._refDropdown}render(){var{msgs:e}=this.props;return r.createElement(n.default,{onRef:e=>{this._refDropdown=e},type:"dropdown_menu",flipOnRTL:!0,key:"StarredDrawerHeader",dirX:"LEFT"},r.createElement(o.default,{a8n:"mi-unstar-all menu-item",action:this.sendUnstarAll,disabled:0===e.length},d.default.t(1390)))}}t.default=u,u.displayName="StarredHeaderDropdown"},20698:(e,t,a)=>{"use strict";var s=a(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(a(2784));class r extends i.Component{constructor(...e){super(...e),this._setRefCanvas=e=>{this.refCanvas=e}}shouldComponentUpdate(){return!1}render(){return i.createElement("canvas",{className:this.props.className,ref:this._setRefCanvas})}}t.default=r,r.displayName="StaticCanvas"},16393:(e,t,a)=>{"use strict";var s=a(14859),i=a(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(a(2784)),l=s(a(32944)),n=s(a(99461)),o=s(a(43805)),d=s(a(51045)),c=a(83251),u=i(a(85530)),h=s(a(36893)),p=s(a(14076)),f=a(66239),m=s(a(20468)),v=s(a(38637)),g=s(a(4739)),E=s(a(21830)),_=s(a(32945)),C=s(a(65677)),S=s(a(78804)),y=s(a(86325)),I=s(a(18779)),M="SEC_UNREAD",P="SEC_READ",T="SEC_MUTED",L="ROW_STATUS";class b extends r.Component{constructor(){super(...arguments),this.flatListController=new p.default,this.onStatusChange=()=>{var e=this._getUnreadStatusList(),t=this._getReadStatusList(),a=[...e,...t].filter((e=>e.contact.statusMute));this.setState({unreadStatusList:e.filter((e=>!e.contact.statusMute)),readStatusList:t.filter((e=>!e.contact.statusMute)),mutedStatusList:a,myStatus:C.default.getMyStatus()})},this._onContactMuteChange=()=>{var e=this._getUnreadStatusList(),t=this._getReadStatusList(),a=[...e,...t].filter((e=>e.contact.statusMute));this.setState({unreadStatusList:e.filter((e=>!e.contact.statusMute)),readStatusList:t.filter((e=>!e.contact.statusMute)),mutedStatusList:a,myStatus:C.default.getMyStatus()})},this._toggleMuted=()=>{this.setState((e=>({isMutedExpanded:!e.isMutedExpanded})))},this.renderItem=e=>{switch(e.type){case M:return r.createElement("div",{className:S.default.listSectionSep},r.createElement("hr",null),r.createElement("div",{className:S.default.listSectionText},r.createElement("span",null,v.default.t(1327))));case P:return r.createElement("div",{className:S.default.listSectionSep},r.createElement("hr",null),r.createElement("div",{className:S.default.listSectionText},r.createElement("span",null,v.default.t(1334))));case T:return r.createElement("div",{className:S.default.listSectionSep},r.createElement("hr",null),r.createElement("div",{className:S.default.listSectionText},r.createElement("span",null,v.default.t(1323)),r.createElement("button",{className:S.default.listSectionAction,onClick:this._toggleMuted},e.expanded?v.default.t(1320):v.default.t(1321))));case L:return r.createElement(_.default,{statusV3:e.status,onClick:()=>this.props.onOpenStatus(e.status,void 0,e.index),contact:e.status.contact});default:throw new u.UnknownDataError(e)}};var e=this._getUnreadStatusList(),t=this._getReadStatusList(),a=[...e,...t].filter((e=>e.contact.statusMute));this.state={unreadStatusList:e.filter((e=>!e.contact.statusMute)),readStatusList:t.filter((e=>!e.contact.statusMute)),mutedStatusList:a,myStatus:C.default.getMyStatus(),isMutedExpanded:!1}}componentDidMount(){this.props.listeners.add(C.default,"add remove bulk_add sort change:msgsChanged change:hasUnread",this.onStatusChange),this.props.listeners.add(o.default,"change:statusMute",this._onContactMuteChange),this.props.listeners.add(C.default,"sync",(()=>{this.forceUpdate()}))}_getUnreadStatusList(){return C.default.getUnexpired(!0)}_getReadStatusList(){return C.default.getUnexpired(!1)}getData(){var{unreadStatusList:e,readStatusList:t,mutedStatusList:a}=this.state,s=[];return e.length>0&&(s.push({type:M,itemKey:"section-unread",height:48}),s.push(...e.map(((e,t)=>({type:L,itemKey:e.id.toString(),height:64,status:e,index:t}))))),t.length>0&&(s.push({type:P,itemKey:"section-read",height:48}),s.push(...t.map(((e,t)=>({type:L,itemKey:e.id.toString(),height:64,status:e,index:t}))))),a.length>0&&(s.push({type:T,itemKey:"section-muted",height:48,expanded:this.state.isMutedExpanded}),this.state.isMutedExpanded&&s.push(...a.map(((e,t)=>({type:L,itemKey:e.id.toString(),height:64,status:e,index:t}))))),s}render(){var e,t=this.getData();return e=C.default.hasSynced()&&t.length>0?r.createElement(u.default,{className:"statusList",itemEnterAnimationsEnabled:!0,flatListController:this.flatListController,direction:"vertical",data:t,renderItem:this.renderItem}):r.createElement(c.ListStatus,null),r.createElement("div",{className:S.default.listPanel},r.createElement(N,{statusV3:this.state.myStatus,onOpenStatus:this.props.onOpenStatus}),r.createElement(h.default,{className:S.default.listBody,flatListControllers:[this.flatListController]},e))}}b.displayName="StatusV3ListPanel";class N extends r.Component{render(){var e,t,a,s=this.props.statusV3;s&&(a=s.msgs);var i,o,c,u,h=()=>{var e=s&&s.msgs;s&&e&&e.length&&this.props.onOpenStatus(s,e.head(),0)};if(s&&a&&a.length){e=r.createElement(y.default,{statusV3:s,contact:s.contact,onClick:h});var p=(0,E.default)(a.last(),"myMsgs.last()").t;t=r.createElement("span",{className:S.default.secondaryHeaderText},n.default.relativeDateAndTimeStr(p)),o={cursor:"pointer"},i=h}else e=r.createElement(d.default,{id:(0,f.getMaybeMeUser)(),theme:"status_v3",size:40}),t=r.createElement("span",{"data-a8n":l.default.key("status-no-updates"),className:S.default.secondaryHeaderText},v.default.t(1325));m.default.supportsFeature(m.default.F.STATUS_V3_UI_SENDING)&&(c=r.createElement(I.default,{name:"menu"}),u=r.createElement(I.default,{name:"status-v3-create"}));var g=r.createElement("span",{"data-a8n":l.default.key("my-status"),className:S.default.primaryHeaderText},v.default.t(1324));return r.createElement("div",{className:S.default.panelHeader,style:o,onClick:i},r.createElement("div",{className:S.default.headerButtonsPrimary},e),r.createElement("div",{className:S.default.headerText},g,t),r.createElement("div",{className:S.default.headerButtonsSecondary},u,c))}}N.displayName="StatusV3ListHeader";var D=(0,g.default)(b);t.default=D},33903:(e,t,a)=>{"use strict";var s=a(93291),i=a(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(a(72779)),l=s(a(2784)),n=i(a(13277)),o=a(66239),d=i(a(4739)),c=i(a(65677)),u=i(a(16393)),h=i(a(89435)),p=i(a(7948)),f=i(a(18779));class m extends l.Component{constructor(e){super(e),this._onStatusAddRemove=()=>{this.setState({status:c.default.getMyStatus()})},this.state={status:c.default.getMyStatus()}}shouldComponentUpdate(e,t){return t.status!==this.state.status}componentDidMount(){var{sessionId:e,listeners:t}=this.props;(0,o.setLastStatusUsage)(),t.add(c.default,"add remove",this._onStatusAddRemove),t.add(n.default,"dismiss_status_v3_viewer",(()=>{this.props.closeStatusViewer(!0)})),null!=e&&c.default.logMetrics({type:"session",sessionId:e})}render(){var{onOpenStatus:e}=this.props,t=(0,r.default)(h.default.v3_x,{});return l.createElement("div",{className:h.default.modalBackground,"data-animate-status-v3-modal-background":!0},l.createElement("div",{className:h.default.mainWrapper},l.createElement(u.default,{onOpenStatus:e}),l.createElement(p.default,{status:this.state.status,onOpenStatus:e}),l.createElement("button",{className:t,onClick:()=>this.props.closeStatusViewer(!0)},l.createElement(f.default,{name:"x-viewer"}))))}}m.displayName="StatusV3Main";var v=(0,d.default)(m);t.default=v},7948:(e,t,a)=>{"use strict";var s=a(14859),i=a(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(a(2784)),l=s(a(32944)),n=s(a(99461)),o=s(a(51045)),d=a(33576),c=i(a(24461)),u=s(a(20468)),h=s(a(38637)),p=s(a(4739)),f=s(a(39542)),m=s(a(85185)),v=s(a(68267)),g=s(a(10771)),E=s(a(86325)),_=s(a(18779));class C extends r.Component{render(){var e,t,a=r.createElement(y,{statusV3:this.props.status,onOpenStatus:this.props.onOpenStatus});return u.default.supportsFeature(u.default.F.STATUS_V3_UI_SENDING)&&(e=r.createElement("div",{className:g.default.updateWrapper},r.createElement("div",{className:g.default.updateTitle},h.default.t(1330)),r.createElement("div",{className:g.default.uploadButtons},r.createElement("div",{className:g.default.buttonContainer},r.createElement(_.default,{name:"status-v3-upload",className:g.default.buttonIcon}),h.default.t(1331)),r.createElement("div",{className:g.default.buttonContainer},r.createElement(_.default,{name:"status-v3-camera",className:g.default.buttonIcon}),h.default.t(1319)))),t=r.createElement("hr",null)),r.createElement("div",{className:g.default.outStatusPanel},e,t,a)}}C.displayName="StatusV3OutStatusPanel";class S extends r.Component{constructor(...e){super(...e),this.rerender=()=>{this.forceUpdate()}}componentDidMount(){var{statusV3:e,listeners:t}=this.props;e&&(t.add(e,"change:msgsChanged",this.rerender),e.loadMore(e.totalCount).catch((e=>{__LOG__(3)`error while loading all out status: ${String(e)}`})))}componentDidUpdate(e){var{listeners:t,statusV3:a}=this.props,{statusV3:s}=e;s!==a&&(s&&t.remove(s,"change:msgsChanged",this.rerender),a&&t.add(a,"change:msgsChanged",this.rerender))}render(){var e=this.props.statusV3;if(e&&e.msgs.length>0){var t=e.msgs.map((t=>r.createElement(M,{key:t.id.toString(),msg:t,status:e,onOpenStatus:this.props.onOpenStatus})));return r.createElement("div",{className:g.default.viewWrapper},r.createElement("div",{className:g.default.viewTitle},h.default.t(1333)),r.createElement("div",{className:g.default.viewUpdates},t))}return r.createElement("div",{className:g.default.viewWrapper},r.createElement("div",{className:g.default.placeholderIcon},r.createElement(_.default,{name:"status-v3-placeholder"})),r.createElement("div",{"data-a8n":l.default.key("status-placeholder"),className:g.default.placeholderText},h.default.t(1326)))}}S.displayName="StatusV3OutViewerImpl";var y=(0,p.default)(S);class I extends r.Component{constructor(){super(...arguments),this.state={}}componentDidMount(){f.default.find(this.props.msg.id).checkpoint(this.props.rejectOnUnmount()).then((e=>{this.props.listeners.add(e.read,"add remove",(()=>{this.setState({seenCount:e.read.length})})),this.setState({seenCount:e.read.length})})).catchType(c.Unmount,(()=>{})).catchType(d.EphemeralDrop,(()=>{}))}render(){var e,{msg:t,status:a}=this.props;e=void 0!==this.state.seenCount?r.createElement(r.Fragment,null,r.createElement(_.default,{name:"status-v3-seen",className:g.default.iconSeen}),r.createElement("div",{className:g.default.seenCount},this.state.seenCount)):r.createElement(v.default,{stroke:3,size:12});var s=r.createElement(o.default,{id:t.sender,theme:"status_v3",size:80});return r.createElement("div",{className:g.default.outDetail},r.createElement(E.default,{statusV3:a,msg:t,onClick:()=>this.props.onOpenStatus(a,t),contact:a.contact,role:"button",theme:"status-panel",thumbnailPlaceholder:s}),r.createElement("div",{className:g.default.seen},e),r.createElement("div",{className:g.default.timestamp},n.default.relativeDateAndTimeStr(t.t)))}}I.displayName="StatusV3OutDetailImpl";var M=(0,m.default)((0,p.default)(I)),P=C;t.default=P},63985:(e,t,a)=>{"use strict";var s=a(14859),i=a(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(a(2784)),l=s(a(13277)),n=s(a(76176)),o=s(a(38637)),d=s(a(67840)),c=s(a(37994)),u=s(a(57750));class h extends r.PureComponent{constructor(...e){super(...e),this.state={theme:"system"},this._handleThemeChange=e=>{var t=e.target.value;"light"!==t&&"dark"!==t&&"system"!==t||this.setState({theme:t})},this._handleOk=()=>{var{theme:e}=this.state;"system"===e?(this.context.setSystemThemeMode(!0),this.context.setTheme(c.default.currentTheme)):(this.context.setSystemThemeMode(!1),this.context.setTheme(e)),l.default.closeModal()},this._handleCancel=()=>{l.default.closeModal()}}componentDidMount(){this.setState({theme:this.context.systemThemeMode?"system":this.context.theme})}render(){var{theme:e}=this.state;return r.createElement(n.default,{title:o.default.t(1373),onOK:this._handleOk,onCancel:this._handleCancel},r.createElement("form",null,r.createElement("ol",null,r.createElement("li",{key:"light"},r.createElement("label",{className:d.default.label},r.createElement("input",{type:"radio",name:"theme",value:"light",className:d.default.input,checked:"light"===e,onChange:this._handleThemeChange}),o.default.t(1372))),r.createElement("li",{key:"dark"},r.createElement("label",{className:d.default.label},r.createElement("input",{type:"radio",name:"theme",value:"dark",className:d.default.input,checked:"dark"===e,onChange:this._handleThemeChange}),o.default.t(1371))),r.createElement("li",{key:"system"},r.createElement("label",{className:d.default.label},r.createElement("input",{type:"radio",name:"theme",value:"system",className:d.default.input,checked:"system"===e,onChange:this._handleThemeChange}),o.default.t(1374))))))}}t.default=h,h.contextType=u.default,h.displayName="ThemePopup"},64092:(e,t,a)=>{"use strict";var s=a(14859),i=a(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(a(2784)),l=s(a(85030)),n=s(a(13277)),o=s(a(76176)),d=s(a(30905)),c=s(a(38637));class u extends r.Component{constructor(...e){super(...e),this.onCancel=()=>{n.default.closeModal()},this._onUnstar=()=>{var e=this.props.chat,t=this.props.msgs;e&&e.pendingAction++,l.default.unstarAllMessages(t,e).finally((()=>{e&&e.pendingAction--})),n.default.closeModal()}}render(){return r.createElement(o.default,{onOK:this._onUnstar,okText:c.default.t(1391),onCancel:this.onCancel},r.createElement("div",null,r.createElement(d.default,{text:c.default.t(1392)})))}}t.default=u,u.displayName="UnstarAllPopup"},67428:(e,t,a)=>{"use strict";var s=a(14859),i=a(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(a(2784)),l=a(62820),n=s(a(3123)),o=s(a(96881)),d=i(a(32597)),c=s(a(30905)),u=s(a(19058)),h=s(a(38637)),p=i(a(64828)),f=s(a(19432)),m=s(a(18779)),v=s(a(17857)),g=s(a(95233)),E=a(65999);class _ extends r.Component{render(){var e,{contactList:t,onSend:a,onBack:s,chat:i}=this.props;switch(i.kind){case l.CHAT_KIND.CHAT:e=h.default.t(489,{chat:i.title(),count:h.default.n(t.length),_plural:t.length});break;case l.CHAT_KIND.GROUP:e=h.default.t(490,{chat:i.title(),count:h.default.n(t.length),_plural:t.length});break;case l.CHAT_KIND.BROADCAST:e=h.default.t(488,{chat:i.title(),count:h.default.n(t.length),_plural:t.length})}var g=e?r.createElement(c.default,{text:e,direction:"auto",titlify:!0,ellipsify:!0}):null;return r.createElement(p.default,{type:p.BoxModalType},r.createElement(n.default,null,r.createElement(d.default,{type:d.DRAWER_HEADER_TYPE.POPUP,onBack:s},g),r.createElement(o.default,null,r.createElement(u.default,null,r.createElement("div",{className:v.default.body},t.map(((e,t)=>this._renderVcard((0,E.vcardFromContactModel)(e),t.toString())))))),r.createElement("div",{className:v.default.btnContainer},r.createElement("div",{className:v.default.btnPosition},r.createElement(f.default,{large:!0,onClick:a},r.createElement(m.default,{name:"send",directional:!0}))))))}_renderVcard(e,t){var a=(0,E.parseVcard)(e.vcard);return a?r.createElement("div",{key:t,className:v.default.vcardWrapper},r.createElement(g.default,{parsedVcard:a,thumbnail:(0,E.vcardThumbnail)(a)})):null}}t.default=_,_.displayName="VcardConfirmModal"},55663:(e,t,a)=>{"use strict";var s=a(93291),i=a(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(a(72779)),l=a(9557),n=i(a(87091)),o=s(a(2784)),d=i(a(75956)),c=i(a(36171)),u=i(a(13277)),h=i(a(23045)),p=i(a(43805)),f=i(a(42394)),m=i(a(3123)),v=i(a(96881)),g=s(a(32597)),E=s(a(24461)),_=i(a(4170)),C=a(55848),S=a(78046),y=a(85871),I=a(66239),M=i(a(81363)),P=i(a(20468)),T=s(a(10313)),L=i(a(62536)),b=a(5370),N=a(77658),D=i(a(38637)),w=i(a(4739)),O=s(a(46229)),k=i(a(85185)),R=i(a(88120)),A=a(64812),x=i(a(96638)),F=i(a(68267)),U=i(a(90370)),B=i(a(18779)),G=a(74315),H=i(a(75632)),V=i(a(46216)),j=i(a(58060)),W=a(66166),K=i(a(87295));class z extends o.Component{constructor(...e){super(...e),this.state={hover:!1,currentQRBinary:null,currentQRData:null},this.onMouseOver=()=>{this.state.hover||this.setState({hover:!0})},this.onMouseEnter=()=>{this.state.hover||this.setState({hover:!0})},this.onMouseLeave=()=>{this.state.hover&&this.setState({hover:!1})},this._setRefQRCodeContainer=e=>{this._refQRCodeContainer=e}}componentDidMount(){this.props.binary&&this._generateQRCode()}componentDidUpdate(){this._generateQRCode()}shouldComponentUpdate(e,t){return!(this._compareBinary(e.binary,this.props.binary)&&this._compareBinary(t.currentQRBinary,this.state.currentQRBinary)&&e.visible===this.props.visible&&t.hover===this.state.hover&&t.currentQRData===this.state.currentQRData)}_fingerprintsMatched(e,t){return!!e&&!!t&&de(e.publicKey,t.publicKey)&&de(e.identifier,t.identifier)}_compareBinary(e,t){if(!e&&!t)return!0;var a=(0,l.decodeProto)(y.CombinedFingerprintSpec,e),s=(0,l.decodeProto)(y.CombinedFingerprintSpec,t);if(!a&&!s)return!0;if(!(null!=a.version||null!=s.version||a.localFingerprint||s.localFingerprint||a.remoteFingerprint||s.remoteFingerprint))return!0;if(a.version!==s.version)return!1;var i=this._fingerprintsMatched(a.localFingerprint,s.localFingerprint),r=this._fingerprintsMatched(a.remoteFingerprint,s.remoteFingerprint);return i&&r}_generateQRCode(){var e=this._refQRCodeContainer,t=this.props.binary;if(e&&t){if(!this._compareBinary(this.state.currentQRBinary,t)){for(this.qr&&delete this.qr;e.firstChild;)e.removeChild(e.firstChild);this.qr=new R.default(e,{text:t,width:h.default.QR_EDGE/2,height:h.default.QR_EDGE/2,correctLevel:R.default.CorrectLevel.L}),this.setState({currentQRBinary:t});var a=e.getElementsByTagName("canvas")[0];a?this._storeQRData(a):this.setState({currentQRData:null})}}else this.setState({currentQRBinary:null,currentQRData:null})}_storeQRData(e){var t=document.createElement("canvas");t.width=e.width+10,t.height=e.height+10;var a=t.getContext("2d");a.fillStyle="white",a.fillRect(0,0,t.width,t.height),a.drawImage(e,5,5),t.toBlob((e=>this.setState({currentQRData:e})),"image/png")}render(){var e=null;if(this.props.visible){var t=null;if(this.state.hover&&this.state.currentQRData){var a=this.props.contact.formattedUser||"",s=p.default.assertGet((0,I.getMaybeMeUser)()).formattedUser;t=o.createElement(f.default,{file:this.state.currentQRData,download:"Verification Code between "+s+" and "+a,extension:S.AllowedFileExtensions.PNG},o.createElement(d.default,{text:D.default.t(1859)}))}e=o.createElement("div",{onMouseOver:this.onMouseOver,onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave},t,o.createElement("div",{className:V.default.circle,ref:this._setRefQRCodeContainer}))}return e}}function q({visible:e}){var t=null;return e&&(t=o.createElement("div",{className:V.default.circle},o.createElement("div",{className:V.default.spinner},o.createElement(F.default,{size:52,stroke:4})))),t}function Y({binary:e,contact:t,visible:a}){var s=null;return a&&(s=o.createElement("div",{className:(0,r.default)(V.default.container,V.default.circleContainer)},o.createElement(z,{visible:!!e,binary:e,contact:t}),o.createElement(q,{visible:!e}))),s}z.defaultProps={binary:null},z.displayName="VerificationQRCode";class Z extends o.Component{shouldComponentUpdate(e){return e.string!==this.props.string}_numDigitsInVerificationString(){return 60}render(){if(!this.props.string)return o.createElement("div",null,D.default.t(885));var e=this.props.string;if(e.length!==this._numDigitsInVerificationString())return __LOG__(3)`verificationString:render this.props.stringshould be ${this._numDigitsInVerificationString()} characters long instead of ${e.length}.`,o.createElement("div",null,D.default.t(1865));for(var t=[],a=0;a<3;a++){for(var s=[],i=0;i<4;i++){for(var r=[],l=0;l<5;l++){var n=e.charAt(5*a*4+5*i+l);r.push(o.createElement("span",{className:V.default.digit,key:l},n))}s.push(o.createElement("span",{className:V.default.block,key:i},r))}t.push(o.createElement(A.SelectableDiv,{className:V.default.row,key:a,selectable:!0},s))}return o.createElement(A.SelectableDiv,{selectable:!0},t)}}function $({visible:e}){var t=null;return e&&(t=o.createElement("div",{className:(0,r.default)(V.default.container,V.default.checkmarkContainer)},o.createElement("div",{className:V.default.checkmark},"✓ "))),t}function Q({visible:e}){var t=null;return e&&(t=o.createElement("div",{className:(0,r.default)(V.default.container,V.default.errorContainer)},o.createElement("div",{className:V.default.error},"!"))),t}function X({children:e}){return o.createElement("div",{className:V.default.errorBanner},e)}Z.defaultProps={string:null},Z.displayName="VerificationString";class J extends o.Component{constructor(...e){super(...e),this.onVideoLoaded=()=>{null==this._captureInterval&&(this._adjustOverlayPosition(),this._captureInterval=this.props.setInterval(this.capture,200))},this.capture=()=>{if(this._verificationVideo){var e=this._verificationVideo.underlyingVideo();if(e){var t=document.createElement("canvas");t.width=e.videoWidth/2,t.height=e.videoHeight/2,t.getContext("2d").drawImage(e,t.width/2,t.height/2,t.width,t.height,0,0,t.width,t.height),t.toBlob((e=>{var t=window.URL.createObjectURL(e);__LOG__(2)`objectURL: ${t}`,this.props.onCapture(t)}),"image/jpeg",1)}}},this._adjustOverlayPosition=()=>{var e=this._verificationVideo.underlyingVideo(),t=this._refVerificationOverlay;if(e&&t){var a=e.offsetHeight,s=e.offsetWidth,i=s/3,r=i;t.style.width=i+"px",t.style.height=r+"px",t.style.margin=(a-r)/2+"px "+(s-i)/2+"px"}},this._setRefVerificationOverlay=e=>{this._refVerificationOverlay=e}}componentDidMount(){this.props.listeners.add(window,"resize",this._adjustOverlayPosition),(0,O.isSrcObjectInVideoElement)()||(this._videoURL=window.URL.createObjectURL(this.props.stream))}componentWillUnmount(){var e,t;null!=this._captureInterval&&this.props.clearInterval(this._captureInterval),this.props.stream&&(null===(e=(t=this.props).disposeStream)||void 0===e||e.call(t),this._videoURL&&window.URL.revokeObjectURL(this._videoURL))}render(){var e=null;return this.props.stream&&(e=o.createElement("div",{className:V.default.webcam},o.createElement("div",{className:V.default.webcamVideo},o.createElement(j.default,{autoPlay:!0,ref:(0,b.GetRef)((e=>{this._verificationVideo=e})),onPlay:this.onVideoLoaded,src:this._videoURL?this._videoURL:void 0,srcObject:this._videoURL?void 0:this.props.stream,width:"100%"})),o.createElement("div",{className:V.default.overlay,ref:this._setRefVerificationOverlay}),o.createElement("button",{onClick:this.props.onClose,className:V.default.btnClose},o.createElement(B.default,{name:"x-alt"})))),e}}J.displayName="VerificationWebcamComponent";var ee=(0,w.default)((0,H.default)(J)),te=0,ae=1,se=2,ie=3,re=4,le=5;class ne extends o.Component{constructor(...e){super(...e),this.state={circleVisible:!0,checkmarkVisible:!1,errorIconVisible:!1,webcamVisible:!1,bannerVisible:!1,bannerText:null,stream:null,isDragging:!1,binaryMD:null,stringMD:null},this._onIdentityKeyMissing=()=>{u.default.openModal(o.createElement(x.default,{name:this.props.contact.formattedUser,onOK:()=>{this.props.onClose?this.props.onClose():this.props.uim.uie.requestDismiss()}}))},this.onDragChange=e=>{this.setState({isDragging:e})},this.onDrop=e=>{this.props.contact.verificationBinary&&this.props.contact.verificationString&&this._onUploadSelect(e)},this._setIdentityState=()=>{(0,K.default)(this.props.contact.id).checkpoint(this.props.rejectOnUnmount()).then((e=>{e?(de(this.state.binaryMD,e.binary)&&!e.string!==this.state.stringMD||(null!=this.state.binaryMD&&u.default.openModal(o.createElement(W.E2EChangeModal,{contact:this.props.contact})),this.setState({binaryMD:e.binary,stringMD:e.string})),this._refreshTimer=this.props.setTimeout((()=>{this._setIdentityState()}),1e3)):(null!=this._refreshTimer&&this.props.clearTimeout(this._refreshTimer),this._onIdentityKeyMissing())})).catchType(E.Unmount,(()=>{}))},this._showWebcamHint=()=>{this.state.webcamVisible&&!this.state.bannerVisible&&this._showBanner(D.default.t(1869))},this._onWebcamOpen=()=>{var{asyncStream:e,disposeStream:t}=O.start("camera");this._disposeStream=t,e.then((e=>this._showWebcamStream(e))).catchType(E.GUM.NotAllowedError,(()=>{u.default.openModal(o.createElement(T.default,{messaging:T.Messaging.CAMERA_FAIL,type:T.default.TYPE.GUIDE_UNBLOCK}))})).catchType(E.GUM.GUMError,(()=>{u.default.openModal(o.createElement(T.default,{messaging:T.Messaging.CAMERA_MISSING,type:T.default.TYPE.GUIDE_NONE}))}))},this._onWebcamClose=()=>{this.setState({webcamVisible:!1,bannerVisible:!1,stream:null}),this._disposeStream=null},this._onWebcamCapture=e=>{this._verifyImage(e,!0)},this._onUploadClick=()=>{var e=this._refVerificationFilePickerInput;e&&e.click()},this._onUploadSelect=e=>{e.stopPropagation();var t=e.target.files||e.dataTransfer.files;if(t&&t[0]){var a=t[0],s=URL.createObjectURL(a);this._verifyImage(s,!1);var i=this._refVerificationFilePickerForm;i&&i.reset()}},this.onClose=()=>{this.props.onClose?this.props.onClose():this.props.uim.uie.requestDismiss()},this._hideCheckmark=()=>{this.state.errorIconVisible||this.setState({circleVisible:!0}),this.setState({checkmarkVisible:!1})},this._hideError=()=>{this.state.checkmarkVisible||this.setState({circleVisible:!0}),this.setState({errorIconVisible:!1})},this._hideBanner=()=>{this.setState({bannerVisible:!1})},this._setRefVerificationFilePickerForm=e=>{this._refVerificationFilePickerForm=e},this._setRefVerificationFilePickerInput=e=>{this._refVerificationFilePickerInput=e}}componentDidMount(){P.default.supportsFeature(P.default.F.MD_BACKEND)?this._setIdentityState():(0,N.queryIdentity)(this.props.contact)}componentDidUpdate(e){e.contact===this.props.contact||P.default.supportsFeature(P.default.F.MD_BACKEND)||(0,N.queryIdentity)(this.props.contact)}componentWillUnmount(){var e;null===(e=this._disposeStream)||void 0===e||e.call(this)}_showWebcamStream(e){this.setState({webcamVisible:!0,circleVisible:!0,checkmarkVisible:!1,errorIconVisible:!1,stream:e}),null!=this._hintTimer&&(this.props.clearTimeout(this._hintTimer),delete this._hintTimer),this._hintTimer=this.props.setTimeout(this._showWebcamHint,7e3)}_getErrorBannerText(e){var t,a=this.props.contact.formattedShortName;switch(e){case se:t=D.default.t(1863,{contact:a});break;case ie:case re:t=D.default.t(1862,{contact:a});break;case le:default:t=D.default.t(1861)}return t}_showCheckmark(){this._onWebcamClose(),this.setState({circleVisible:!1,checkmarkVisible:!0,errorIconVisible:!1,bannerVisible:!1}),null!=this._iconTimer&&(this.props.clearTimeout(this._iconTimer),delete this._iconTimer),this._iconTimer=this.props.setTimeout(this._hideCheckmark,3e3)}_showErrorIcon(){this._onWebcamClose(),this.setState({circleVisible:!1,checkmarkVisible:!1,errorIconVisible:!0,bannerVisible:!1}),null!=this._iconTimer&&(this.props.clearTimeout(this._iconTimer),delete this._iconTimer),this._iconTimer=this.props.setTimeout(this._hideError,3e3)}_showErrorBanner(e){var t=this._getErrorBannerText(e);this._showBanner(t)}_showBanner(e){this.setState({circleVisible:!0,checkmarkVisible:!1,errorIconVisible:!1,bannerVisible:!0,bannerText:e}),null!=this._bannerTimer&&(this.props.clearTimeout(this._bannerTimer),delete this._bannerTimer),this._bannerTimer=this.props.setTimeout(this._hideBanner,5e3)}_validateFingerprint(e){if(!e||0===!e.version||!e.localFingerprint||!e.remoteFingerprint)return le;var t=new ArrayBuffer(0);t=P.default.supportsFeature(P.default.F.MD_BACKEND)?this.state.binaryMD:this.props.contact.verificationBinary;var a=(0,l.decodeProto)(y.CombinedFingerprintSpec,t);if(de(e.localFingerprint&&e.localFingerprint.identifier,a.localFingerprint&&a.localFingerprint.identifier)&&de(e.remoteFingerprint&&e.remoteFingerprint.identifier,a.remoteFingerprint&&a.remoteFingerprint.identifier))return te;var s=de(e.remoteFingerprint&&e.remoteFingerprint.identifier,a.localFingerprint&&a.localFingerprint.identifier),i=de(e.localFingerprint&&e.localFingerprint.identifier,a.remoteFingerprint&&a.remoteFingerprint.identifier);if(!s&&!i)return re;if(!s)return se;if(!i)return ie;var r=de(e.remoteFingerprint&&e.remoteFingerprint.publicKey,a.localFingerprint&&a.localFingerprint.publicKey),n=de(e.localFingerprint&&e.localFingerprint.publicKey,a.remoteFingerprint&&a.remoteFingerprint.publicKey);return r&&n?te:ae}_decodeQRCode(e){return new Promise(((t,a)=>{n.default.callback=(e,s)=>{if(s)a(s);else if(e.length<1)a("QR decoder did not return decoded binary");else{var i=new Uint8Array(e[0]);t(i)}},n.default.decode(e)}))}_verifyImage(e,t){this._decodeQRCode(e).then((e=>(0,l.decodeProto)(y.CombinedFingerprintSpec,e))).then((e=>{var a=this._validateFingerprint(e);a?t&&a===le||(this.setState({errorType:a}),a===ae?this._showErrorIcon():this._showErrorBanner(a)):this._showCheckmark()})).catch((()=>{t||(this.setState({errorType:le}),this._showErrorBanner(le))})).finally((()=>{window.URL.revokeObjectURL(e)}))}render(){var e=null,t=null,a=null,s=null,i=null,r=null,l=new ArrayBuffer(0),n="";return P.default.supportsFeature(P.default.F.MD_BACKEND)?(l=this.state.binaryMD,n=this.state.stringMD,r=D.default.t(1716,{contactName:this.props.contact.formattedShortName})):(l=this.props.contact.verificationBinary,n=this.props.contact.verificationString,r=D.default.t(1864)),l&&(M.default&&(e=o.createElement("div",{className:V.default.section},o.createElement(c.default,{type:"primary",onClick:this.state.webcamVisible?this._onWebcamClose:this._onWebcamOpen},this.state.webcamVisible?D.default.t(1868):D.default.t(1870)))),t=o.createElement("div",{className:V.default.section},o.createElement(c.default,{type:"primary",onClick:this._onUploadClick},D.default.t(1867)),o.createElement("p",{className:V.default.dragAndDropExplanation},this.state.isDragging?D.default.t(1860):null)),a=o.createElement("form",{ref:this._setRefVerificationFilePickerForm},o.createElement("input",{ref:this._setRefVerificationFilePickerInput,accept:"image/*",type:"file",style:{display:"none"},onChange:this._onUploadSelect,onClick:e=>e.stopPropagation()}))),this.state.webcamVisible&&this.state.stream&&(s=o.createElement(ee,{stream:this.state.stream,disposeStream:this._disposeStream,onCapture:this._onWebcamCapture,onClose:this._onWebcamClose})),this.state.bannerVisible&&(i=o.createElement(X,null,this.state.bannerText)),o.createElement(m.default,{theme:"verification",onDrop:this.onDrop,onDragChange:this.onDragChange},o.createElement(g.default,{type:g.DRAWER_HEADER_TYPE.SMALL,onBack:this.onClose},o.createElement(G.TextDiv,{theme:"title"},D.default.t(1866)),o.createElement(G.TextDiv,{theme:"small"},D.default.t(1875),", ",this.props.contact.formattedUser)),s,i,o.createElement(v.default,null,o.createElement("div",{className:V.default.form},o.createElement("div",{className:V.default.photo},o.createElement(Y,{binary:l,contact:this.props.contact,visible:this.state.circleVisible}),o.createElement($,{visible:this.state.checkmarkVisible}),o.createElement(Q,{visible:this.state.errorIconVisible})),o.createElement("div",{className:V.default.section},o.createElement("div",{className:V.default.code},o.createElement(Z,{string:n}))),o.createElement("div",{className:V.default.section},o.createElement("p",{className:V.default.explanation},o.createElement("span",null,r," "),o.createElement(_.default,{href:(0,C.getE2EFaqUrl)()},D.default.t(844)))),e,t,a)))}}ne.CONCERNS={contact:["verificationBinary","verificationString","formattedUser","formattedShortName","id"]},ne.displayName="VerificationDrawer";var oe=(0,L.default)((0,k.default)((0,H.default)((0,U.default)(ne,ne.CONCERNS))));function de(e,t){if(!e||!t)return!1;var a=new Uint8Array(e),s=new Uint8Array(t),i=a.length;if(i!==s.length)return!1;for(var r=0;r<i;r++)if(a[r]!==s[r])return!1;return!0}t.default=oe},4643:(e,t,a)=>{"use strict";var s=a(93291),i=a(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(a(72779)),l=s(a(2784)),n=i(a(32944)),o=i(a(95419)),d=i(a(93257)),c=i(a(13277)),u=i(a(23045)),h=i(a(3123)),p=i(a(96881)),f=s(a(32597)),m=i(a(38637)),v=i(a(54559)),g=i(a(90370)),E=a(74315),_=i(a(57750)),C=s(a(97025)),S=a(33723),y=i(a(48969));class I extends l.Component{constructor(...e){super(...e),this.state={hover:!1},this.onClick=()=>{var e=this._encodeColor(),t=o.default.get("defaultPreference");t&&e!==t.wallpaperColor&&(t.set("wallpaperColor",e),c.default.openToast(l.createElement(C.default,{msg:m.default.t(1546),id:(0,C.genId)()})))},this.onMouseOver=()=>{this.state.hover||(this.setState({hover:!0}),o.default.trigger("wallpaper_color_preview",this._encodeColor()))},this.onMouseEnter=()=>{this.state.hover||(this.setState({hover:!0}),o.default.trigger("wallpaper_color_preview",this._encodeColor()))},this.onMouseLeave=()=>{this.state.hover&&(this.setState({hover:!1}),o.default.trigger("wallpaper_color_preview"))},this._encodeColor=()=>{var{colorHex:e,isDefault:t}=this.props;return t?u.default.DEFAULT_CHAT_WALLPAPER:e}}render(){var e=this.props.isDefault?l.createElement("span",{className:y.default.wallpaperDefaultTitle,"data-a8n":n.default.key("wallpaper-default-title")},m.default.t(525)):null,t=(0,r.default)(y.default.wallpaperColorCanvas,{[y.default.canvasHover]:this.state.hover,[y.default.canvasActive]:this.props.isSelected,[y.default.canvasDefault]:this.props.isDefault});return l.createElement("span",{className:t,style:{backgroundColor:this.props.colorHex},onMouseOver:this.onMouseOver,onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,onClick:this.onClick,title:this.props.isDefault?m.default.t(525):null},e)}}I.displayName="ColorCanvas";class M extends l.Component{constructor(...e){super(...e),this._onWallpaperDoodleChange=()=>{var{chatPreference:e}=this.props;if(e){var t=!e.showDoodle;e.set("showDoodle",t),c.default.openToast(l.createElement(C.default,{msg:t?m.default.t(1547):m.default.t(1548),id:(0,C.genId)()}))}}}render(){var e,{chatPreference:t,colors:a}=this.props,s=t&&t.wallpaperColor,i=t&&t.showDoodle,r=a.map((e=>l.createElement(I,{colorHex:e,isSelected:s===e,isDefault:!1,key:e}))),n=l.createElement(I,{isSelected:s===u.default.DEFAULT_CHAT_WALLPAPER,isDefault:!0,key:u.default.DEFAULT_CHAT_WALLPAPER});r.unshift(n);for(var o=0;o<2;o++)r.push(l.createElement("div",{key:"emptyEl"+o,className:y.default.wallpaperColorEmpty}));return v.default.wallpapersV2&&(e=l.createElement("div",{className:y.default.wallpaperApplyDoodle},l.createElement(d.default,{onChange:this._onWallpaperDoodleChange,checked:!!i}),l.createElement(E.TextSpan,{className:y.default.checkboxLabel,theme:"small"},m.default.t(1545)))),l.createElement(l.Fragment,null,e,l.createElement("div",{className:y.default.wallpaperColorGrid},r))}}M.CONCERNS={chatPreference:["wallpaperColor","showDoodle"]},M.displayName="ColorGridClass";var P=(0,g.default)(M,M.CONCERNS);class T extends l.Component{componentWillUnmount(){o.default.trigger("wallpaper_color_preview"),v.default.wallpapersV2&&o.default.trigger("wallpaper_drawer_close")}componentDidMount(){v.default.wallpapersV2&&o.default.trigger("wallpaper_drawer_open")}render(){return l.createElement(h.default,null,l.createElement(f.default,{title:m.default.t(1549),onBack:this.props.onClose,type:f.DRAWER_HEADER_TYPE.LARGE}),l.createElement(p.default,null,l.createElement(P,{colors:(0,S.getWallpaperColors)(this.context.theme),chatPreference:o.default.get("defaultPreference")})))}}t.default=T,T.contextType=_.default,T.displayName="WallpaperDrawer"},91915:(e,t,a)=>{"use strict";var s=a(14859),i=a(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(a(2784)),l=s(a(99461)),n=s(a(13277)),o=s(a(76176)),d=i(a(18528)),c=s(a(3123)),u=s(a(96881)),h=i(a(32597)),p=a(33576),f=s(a(40517)),m=s(a(14076)),v=s(a(38637)),g=s(a(91585)),E=s(a(35369)),_=s(a(970)),C=a(74315);class S extends r.Component{constructor(e){super(e),this._orderFlatListController=new m.default,this.state={isLoading:!0,fetchState:"PENDING",order:null}}componentDidMount(){var{orderId:e,token:t,sellerJid:a}=this.props;g.default.findOrder(e,a,t).then((e=>{this.setState({fetchState:"SUCCESS",isLoading:!1,order:e})})).catchType(p.E404,(()=>{this._showNotFoundErrorToast(),this.setState({fetchState:"ERROR",isLoading:!1})})).catch((()=>{this.setState({fetchState:"ERROR",isLoading:!1}),__LOG__(4,!0,new Error,!0)`Catalog Order Display failed`,SEND_LOGS("OrderDetails: failed to display")}))}_getDrawerContent(){var{sellerJid:e}=this.props,{fetchState:t,order:a}=this.state;if(this.state.isLoading||null==a)return r.createElement(f.default,{fetchState:t});var s="";s=a.products.length>0?v.default.t(833,{count:a.totalItemCount||0,_plural:a.totalItemCount||0}):v.default.t(1133);var i=r.createElement(C.TextDiv,{theme:"title"},s),n=null;n=null!=a.total&&0!==a.total?v.default.t(1130,{subtotal:d.format(a.currency,a.total)}):v.default.t(1126);var o=r.createElement(C.TextDiv,{theme:"muted-small"},n),c=null;if(null!=a.createdAt){var u=l.default.timeStr(a.createdAt);c=r.createElement(C.TextSpan,{theme:"muted-small"},`${u}`)}return r.createElement(r.Fragment,null,r.createElement(f.default,{fetchState:t}),r.createElement("div",{className:E.default.info},i,o),r.createElement(_.default,{flatListController:this._orderFlatListController,onProductDetail:this.props.onProductDetail,order:a,sellerJid:e}),r.createElement("div",{className:E.default.date},c))}_showNotFoundErrorToast(){n.default.openModal(r.createElement(o.default,{onOK:()=>{n.default.closeModal()},okText:v.default.t(1738)},v.default.t(1127)))}onClose(){n.default.closeDrawerRight()}render(){var{userIsCartOwner:e}=this.props;return r.createElement(c.default,{theme:"striped",onDrop:this.onClose},r.createElement(h.default,{title:e?v.default.t(370):v.default.t(369),type:h.DRAWER_HEADER_TYPE.SMALL,onBack:this.onClose}),r.createElement(u.default,{flatListControllers:[this._orderFlatListController]},this._getDrawerContent()))}}t.default=S,S.displayName="OrderDetailDrawer"},970:(e,t,a)=>{"use strict";var s=a(14859),i=a(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=p;var r=i(a(2784)),l=s(a(23045)),n=s(a(84755)),o=s(a(85530)),d=s(a(36893)),c=a(84347),u=s(a(20129)),h=a(55439);function p(e){var{order:t,onProductDetail:a,sellerJid:s}=e,i=e=>{var a=t.orderItemCollection.toArray();return(0,c.logOrderListImpression)({catalogContext:e,orderId:t.id,productCount:a.length,catalogOwnerJid:s}),a.map((e=>({itemKey:e.id.toString(),product:e})))};return r.createElement(n.default.Consumer,null,(t=>{var s=(0,h.getProductCatalogContext)(t);return r.createElement(d.default,{flatListControllers:[e.flatListController]},r.createElement(o.default,{flatListController:e.flatListController,direction:"vertical",forceConsistentRenderCount:!1,data:i(s),renderItem:t=>((t,s)=>{var{sellerJid:i}=e,{product:l}=t,n={productId:l.id,businessOwnerJid:i};return r.createElement(u.default,{product:l,onClick:()=>{(0,c.logOrderListItemClick)({catalogContext:s,orderId:e.order.id,catalogOwnerJid:i}),a(n)}})})(t,s),defaultItemHeight:l.default.PRODUCT_LIST_ITEM_HEIGHT}))}))}p.displayName="OrderProductList"},20129:(e,t,a)=>{"use strict";var s=a(14859),i=a(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=p;var r=i(a(2784)),l=s(a(78523)),n=i(a(18528)),o=s(a(30905)),d=s(a(38637)),c=s(a(85683)),u=s(a(91100)),h=a(74315);function p(e){var{product:t,onClick:a}=e,s=r.createElement(o.default,{text:t.name,ellipsify:!0,titlify:!0}),i=r.createElement(u.default,{mediaData:t.mediaData,theme:"list"}),p=d.default.t(1131,{quantity:t.quantity.toString()}),f=null;t.quantity&&(f=r.createElement(h.TextSpan,{className:c.default.quantity},p));var m=null;m=t.price&&0!==t.price?n.format(t.currency,t.price):d.default.t(362);var v=r.createElement(h.TextSpan,{className:c.default.price},m),g=null;null!=f&&(g=r.createElement("span",{className:c.default.separator},"•"));var E=r.createElement("div",null,v,g,f);return r.createElement(l.default,{key:t.id.toString(),image:i,customImage:!0,primary:s,secondary:E,theme:"order-product",onClick:a})}p.displayName="OrderProductListItem"},77111:(e,t,a)=>{"use strict";var s=a(14859),i=a(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(a(2784)),l=s(a(1882)),n=s(a(84755)),o=s(a(81407)),d=s(a(77508)),c=s(a(38637)),u=s(a(99369)),h=a(84982),p=a(58868),f=a(55439),m=s(a(18779)),v=a(61864);class g extends r.PureComponent{_getCartIcon(){var{onCartClick:e,cartCount:t,catalogId:a}=this.props;if(e&&a){var s=(0,v.isNumber)(t)&&t>0?t.toString():void 0,i=(0,h.getOnCartClickWithLog)(e,a,(0,f.getProductCatalogContext)(this.context));return r.createElement(p.MenuBarItem,{a8nText:"menu-bar-cart-link",icon:r.createElement(l.default,{theme:"inherit-color"}),text:s,title:c.default.t(359),onClick:i})}return null}_getMenuItems(){var{canManageCatalog:e,onSendCatalog:t,onOpenCollections:a}=this.props;return e?r.createElement(p.MenuBarItem,{a8nText:"menu-bar-menu",icon:r.createElement(m.default,{name:"menu"}),title:c.default.t(950)},r.createElement(o.default,{type:"dropdown_menu",flipOnRTL:!0,key:"CatalogDetailHeader",dirX:"LEFT"},r.createElement(d.default,{a8n:"mi-foward menu-item",action:t},c.default.t(675)),a&&r.createElement(d.default,{a8n:"mi-collections menu-item",action:a},c.default.t(472)))):r.createElement(p.MenuBarItem,{a8nText:"menu-bar-catalog-link",icon:r.createElement(u.default,null),title:c.default.t(413),onClick:t})}render(){return r.createElement(r.Fragment,null,this._getCartIcon(),this._getMenuItems())}}t.default=g,g.contextType=n.default,g.displayName="DetailDrawerMenu"},45411:(e,t,a)=>{"use strict";var s=a(93291),i=a(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.CatalogViewDrawer=void 0;var r=i(a(52954)),l=i(a(12436)),n=i(a(54073)),o=s(a(2784)),d=i(a(2359)),c=a(79930),u=i(a(59544)),h=i(a(89962)),p=i(a(77111)),f=a(61675),m=i(a(23045)),v=i(a(3123)),g=i(a(96881)),E=s(a(32597)),_=a(96313),C=i(a(40517)),S=i(a(14076)),y=i(a(13663)),I=i(a(38637)),M=i(a(4739)),P=i(a(84149)),T=i(a(60345)),L=i(a(65013)),b=i(a(85185)),N=i(a(90370));class D extends o.Component{constructor(e){super(e),this._catalogFlatListController=new S.default,this._handleScroll=(e,t)=>{var a,s;this.props.setScrollOffset&&this.props.setScrollOffset(t.scrollTop),(null===(a=this.state.scrollHelper)||void 0===a?void 0:a.willLoadMore(t))&&this.setState({loadingMore:!0}),null===(s=this.state.scrollHelper)||void 0===s||s.onScroll(e,t).then((e=>{e&&this.setState({loadingMore:!1})})).catch((e=>{throw this.setState({loadingMore:!1}),e}))},this.handleScroll=(0,l.default)(this._handleScroll,100),this.onScroll=e=>{this.handleScroll(e,e.currentTarget)},this._onCartChange=()=>{var e=this.state.cart.itemCount;this.state.cartCount!==e&&this.setState({cartCount:e})},this._onCartClick=()=>{var{contact:e,onCartClick:t}=this.props;t&&t(e.id.toString())},this._onCatalogLinkClick=()=>{var{catalog:e}=this.state,{onCatalogLinkClick:t,contact:a}=this.props;e&&t(e,a)};var t=u.default.findCart(this.props.contact.id.toString());this.state={cartEnabled:!1,catalog:null,cartCount:t.itemCount,catalogFetchState:"NONE",dataSource:null,scrollHelper:null,loadingMore:!0,cart:t}}componentDidMount(){var{catalogId:e,listeners:t}=this.props;this._setupCatalog(),(0,c.checkCartEnabled)(e).then((e=>{this.setState({cartEnabled:e}),e&&t.add(this.state.cart,"all",this._onCartChange)}))}_setupCatalog(){var{catalogId:e,rejectOnUnmount:t,canManageCatalog:a,scrollOffset:s}=this.props;h.default.find(e).checkpoint(t()).then((e=>{var t=new f.CatalogWithCollectionsDataSource(e,a||!1,m.default.PRODUCT_LIST_ITEM_HEIGHT),i=new f.CatalogListItemScrollHelper(t);this.setState({catalog:e,dataSource:t,scrollHelper:i,catalogFetchState:"SUCCESS"},(()=>{this.loadInitialItems(),this._watchProductCollection(),void 0!==s&&this._catalogFlatListController.setScrollFromStart(s)}))})).catch((e=>{(0,_.parseErrorState)(e,(e=>this.setState({catalogFetchState:e,loadingMore:!1})))}))}_watchProductCollection(){var{catalog:e}=this.state;this.props.autoUpdate&&null!=e&&(e.productCollection.on("add",(0,n.default)((()=>this.forceUpdate()),100)),e.productCollection.on("remove",(0,n.default)((()=>this.forceUpdate()),100)),e.collections.on("add",(0,n.default)((()=>this.forceUpdate()),100)),e.collections.on("remove",(0,n.default)((()=>this.forceUpdate()),100)))}_getDrawerContent(){var e,t,{catalog:a,cartEnabled:s,dataSource:i}=this.state,{contact:r,businessProfile:l,canManageCatalog:n,onAddProduct:c,onCartClick:u}=this.props,h=s&&u?this._onCartClick:void 0;return n&&c&&(e=o.createElement(d.default,{onClick:()=>c(),theme:"in-list"})),t=a&&i?o.createElement(P.default,{onCartOpen:h,onProductDetail:this.props.onProductDetail,flatListController:this._catalogFlatListController,catalog:a,canManageCatalog:this.props.canManageCatalog,shareLinks:this.props.canManageCatalog,onProductShare:this.props.onProductShare,onCollectionSeeAll:this.props.onCollectionSeeAll,data:i.getData(),onEditCollection:this.props.onEditCollection}):o.createElement(C.default,{fetchState:this.state.catalogFetchState}),o.createElement(o.Fragment,null,l&&o.createElement("div",{className:T.default.header},o.createElement(L.default,{profilePicThumb:r.getProfilePicThumb(),contact:r,businessProfile:l})),o.createElement("div",{className:T.default.list},e,t,this.state.loadingMore&&o.createElement(y.default,null)))}loadInitialItems(){var e=this;return(0,r.default)((function*(){var{dataSource:t}=e.state;yield null==t?void 0:t.loadInitialItems(),e.setState({loadingMore:!1})}))()}_renderDrawerMenu(){var e=this.state.cartEnabled?this._onCartClick:void 0;return o.createElement(p.default,{onSendCatalog:this._onCatalogLinkClick,onCartClick:e,cartCount:this.state.cart.itemCount,catalogId:this.props.catalogId.toString(),canManageCatalog:this.props.canManageCatalog,onOpenCollections:this.props.onOpenCollections})}render(){return o.createElement(v.default,{theme:"products",onDrop:this.props.onBack},o.createElement(E.default,{title:I.default.t(1162),type:this.props.headerType||E.DRAWER_HEADER_TYPE.SMALL,onBack:this.props.onBack,menu:this._renderDrawerMenu()}),o.createElement(g.default,{onScroll:this.onScroll,flatListControllers:[this._catalogFlatListController]},this._getDrawerContent()))}}t.CatalogViewDrawer=D,D.CONCERNS={contact:["id"]},D.displayName="CatalogViewDrawer";var w=(0,b.default)((0,M.default)((0,N.default)(D,D.CONCERNS)));t.default=w},58322:(e,t,a)=>{"use strict";var s=a(93291),i=a(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.CollectionContentDrawer=void 0;var r=i(a(52954)),l=i(a(12436)),n=s(a(2784)),o=a(79930),d=i(a(59544)),c=i(a(89962)),u=i(a(77111)),h=a(61675),p=i(a(30031)),f=i(a(52585)),m=i(a(23045)),v=i(a(3123)),g=i(a(96881)),E=i(a(84755)),_=s(a(32597)),C=a(96313),S=i(a(40517)),y=i(a(14076)),I=i(a(13663)),M=i(a(38637)),P=i(a(4739)),T=i(a(84149)),L=i(a(85185)),b=i(a(90370));class N extends n.Component{constructor(e){super(e),this._collectionFlatListController=new y.default,this._onCartChange=()=>{var e=this.state.cart.itemCount;this.state.cartCount!==e&&this.setState({cartCount:e})},this._onCartClick=()=>{var{contact:e,onCartClick:t}=this.props;t&&t(e.id.toString())},this._onCatalogLinkClick=()=>{var{catalog:e}=this.state;if(e){var{onCatalogLinkClick:t,contact:a}=this.props;t(e,a)}},this._handleScroll=(e,t)=>{var a,s;this.props.setScrollOffset&&this.props.setScrollOffset(t.scrollTop),(null===(a=this.state.scrollHelper)||void 0===a?void 0:a.willLoadMore(t))&&this.setState({loadingMore:!0}),null===(s=this.state.scrollHelper)||void 0===s||s.onScroll(e,t).then((e=>{e&&this.setState({loadingMore:!1})})).catch((e=>{throw this.setState({loadingMore:!1}),e}))},this.handleScroll=(0,l.default)(this._handleScroll,100),this.onScroll=e=>{this.handleScroll(e,e.currentTarget)};var t=d.default.findCart(this.props.contact.id.toString());this.state={cartEnabled:!1,catalog:null,cartCount:t.itemCount,catalogFetchState:"NONE",dataSource:null,scrollHelper:null,loadingMore:!0,cart:t}}componentDidMount(){var{catalogId:e,listeners:t}=this.props;this._setupCatalog(),(0,o.checkCartEnabled)(e).then((e=>{this.setState({cartEnabled:e}),e&&t.add(this.state.cart,"all",this._onCartChange)}))}_setupCatalog(){var{canManageCatalog:e,catalogId:t,rejectOnUnmount:a,scrollOffset:s}=this.props;c.default.find(t).then((t=>{var a;this.setState({catalog:t,catalogFetchState:"SUCCESS"});var i=new h.SingleCollectionDataSource(t,null===(a=this.props.collection)||void 0===a?void 0:a.id.toString(),e||!1,m.default.PRODUCT_LIST_ITEM_HEIGHT),r=new h.CatalogListItemScrollHelper(i);this.setState({dataSource:i,scrollHelper:r},(()=>{this.loadInitialItems(),this._watchProductCollection(),void 0!==s&&this._collectionFlatListController.setScrollFromStart(s)}))})).checkpoint(a()).catch((e=>{(0,C.parseErrorState)(e,(e=>this.setState({catalogFetchState:e,loadingMore:!1})))}))}_watchProductCollection(){var{collection:e}=this.props,{catalog:t}=this.state;null!=e&&(e.productCollection.on("add",(()=>this.forceUpdate())),e.productCollection.on("remove",(()=>this.forceUpdate()))),null!=t&&(t.productCollection.on("add",(()=>this.forceUpdate())),t.productCollection.on("remove",(()=>this.forceUpdate())),t.collections.on("add",(()=>this.forceUpdate())),t.collections.on("remove",(()=>this.forceUpdate())))}_getDrawerContent(){var e,{catalog:t,cartEnabled:a,dataSource:s,catalogFetchState:i}=this.state,{canManageCatalog:r,onCartClick:l,onProductDetail:o,onProductShare:d}=this.props,c=a&&l?this._onCartClick:void 0;if(!t||!s)return n.createElement(S.default,{fetchState:i});var u=s.getData(),h=n.createElement(T.default,{onCartOpen:c,onProductDetail:o,flatListController:this._collectionFlatListController,catalog:t,canManageCatalog:r,shareLinks:r,onProductShare:d,collectionId:null===(e=this.props.collection)||void 0===e?void 0:e.id.toString(),data:u}),m=this.props.collection?n.createElement(f.default,{collection:this.props.collection,onEditCollection:this.props.onEditCollection}):void 0;return n.createElement(n.Fragment,null,n.createElement("div",{className:p.default.list},m,h,this.state.loadingMore&&n.createElement(I.default,null)))}loadInitialItems(){var e=this;return(0,r.default)((function*(){var{dataSource:t}=e.state;yield null==t?void 0:t.loadInitialItems(),e.setState({loadingMore:!1})}))()}_renderDrawerMenu(){var e=this.state.cartEnabled?this._onCartClick:void 0;return n.createElement(u.default,{onSendCatalog:this._onCatalogLinkClick,onCartClick:e,cartCount:this.state.cart.itemCount,catalogId:this.props.catalogId.toString(),canManageCatalog:this.props.canManageCatalog})}render(){var e,t=(null===(e=this.props.collection)||void 0===e?void 0:e.name)||M.default.t(467);return n.createElement(v.default,{theme:"products",onDrop:this.props.onBack},n.createElement(_.default,{title:t,type:this.props.headerType||_.DRAWER_HEADER_TYPE.SMALL,onBack:this.props.onBack,menu:this._renderDrawerMenu()}),n.createElement(g.default,{flatListControllers:[this._collectionFlatListController],onScroll:this.onScroll},this._getDrawerContent()))}}t.CollectionContentDrawer=N,N.contextType=E.default,N.CONCERNS={contact:["id"]},N.displayName="CollectionContentDrawer";var D=(0,L.default)((0,P.default)((0,b.default)(N,N.CONCERNS)));t.default=D},49355:(e,t,a)=>{"use strict";var s=a(14859),i=a(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=p;var r=i(a(2784)),l=s(a(78523)),n=s(a(30430)),o=s(a(84198)),d=s(a(30905)),c=s(a(38637)),u=a(27582),h=a(74315);function p(e){var t,a,s,{collection:i,onSeeAll:p,allItems:f}=e;i?({name:t,id:a,totalItemsCount:s}=i):f&&(t=c.default.t(467),s=f.totalItemsCount);var m=r.createElement(h.TextDiv,{theme:"title"},r.createElement(d.default,{text:t,ellipsify:!0,titlify:!0}));function v(e){!function(e){e.preventDefault(),e.stopPropagation()}(e),p&&i?p(i):p&&p()}function g(){return r.createElement(n.default,{onClick:v},c.default.t(470))}g.displayName="_renderActions";c.default.t(468,{count:s||0,_plural:s||0});h.TextDiv;var E=void 0;if(i)switch(i.reviewStatus){case u.PRODUCT_REVIEW_STATUS.REJECTED:E=r.createElement("span",{className:o.default.reviewStateRejected},c.default.t(469))}return r.createElement(l.default,{key:a,primary:m,secondary:E,detail:g(),theme:"product",idle:!0,className:o.default.collectionListItem})}p.displayName="CollectionListItem"},83029:(e,t,a)=>{"use strict";var s=a(14859),i=a(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(a(2784)),l=s(a(87962)),n=s(a(51841)),o=s(a(77508)),d=s(a(30905)),c=s(a(38637)),u=s(a(18779)),h=s(a(5431)),p=s(a(43195));class f extends r.Component{constructor(...e){super(...e),this.state={active:!1,contextMenu:null},this.onDelete=e=>{e.preventDefault(),e.stopPropagation(),this.props.onDelete&&this.props.onDelete(this.props.collection)},this.onEdit=e=>{e.preventDefault(),e.stopPropagation(),this.props.onEdit&&this.props.onEdit(this.props.collection)},this.removeContext=()=>{this.setState({contextMenu:null})},this.onContext=e=>{if(this.state.contextMenu)this.setState({contextMenu:null});else{var t=[];this.props.canManage&&(t.push(r.createElement(o.default,{a8n:"mi-show-label",action:this.onEdit,key:"EditLabel"},c.default.t(383))),t.push(r.createElement(o.default,{a8n:"mi-show-label",action:this.onDelete,key:"DeleteLabel"},c.default.t(381)))),e.event&&e.event.persist(),this.setState({contextMenu:{menu:t,event:e.event,anchor:e.anchor}})}}}render(){var e,{collection:t,theme:a}=this.props,s=r.createElement("div",{className:n.default.collectionIcon},r.createElement("div",{className:n.default.iconContainer},r.createElement(u.default,{name:"collections_folder"}))),i=r.createElement(d.default,{text:t.name,ellipsify:!0,titlify:!0});return this.state.contextMenu&&(e=r.createElement(h.default,{displayName:"CollectionContextMenu",escapable:!0,popable:!0,requestDismiss:this.removeContext},r.createElement(p.default,{contextMenu:this.state.contextMenu}))),r.createElement(r.Fragment,null,r.createElement(l.default,{key:t.id.toString(),customImage:!0,image:s,primary:i,theme:a,active:this.state.active,contextEnabled:()=>this.props.canManage,onContext:this.onContext}),e)}}f.defaultProps={theme:"product",isMuted:!1},f.displayName="CollectionManageListItem";var m=f;t.default=m},14471:(e,t,a)=>{"use strict";var s=a(14859),i=a(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(a(2784)),l=a(26891),n=s(a(83029)),o=s(a(23045)),d=s(a(85530)),c=s(a(36893)),u=s(a(90370)),h=a(47138);class p extends r.Component{constructor(...e){super(...e),this.onCollectionDelete=e=>{var{catalog:t}=this.props;(0,l.handleCollectionDelete)((0,h.unproxy)(t),e,"")},this.renderItem=e=>{var{collection:t}=e;return r.createElement(n.default,{collection:t,canManage:this.props.canManage,onDelete:this.onCollectionDelete,onEdit:this.props.onEditCollection})}}getData(){var e=[];return this.props.data.forEach((t=>{t.collection&&e.push({itemKey:t.collection.id,collection:t.collection})})),e}render(){return r.createElement(c.default,{flatListControllers:[this.props.flatListController]},r.createElement(d.default,{flatListController:this.props.flatListController,direction:"vertical",forceConsistentRenderCount:!1,data:this.getData(),renderItem:this.renderItem,defaultItemHeight:o.default.PRODUCT_LIST_ITEM_HEIGHT,itemEnterAnimationsEnabled:!0}))}}p.CONCERNS={catalog:["collections"]},p.displayName="CollectionsList";var f=(0,u.default)(p,p.CONCERNS);t.default=f},11151:(e,t,a)=>{"use strict";var s=a(93291),i=a(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.CollectionsManagementDrawer=void 0;var r=i(a(52954)),l=i(a(12436)),n=i(a(54073)),o=s(a(2784)),d=i(a(2359)),c=i(a(89962)),u=a(61675),h=i(a(14471)),p=i(a(20800)),f=i(a(23045)),m=i(a(3123)),v=i(a(96881)),g=s(a(32597)),E=i(a(14076)),_=i(a(13663)),C=a(66239),S=i(a(38637)),y=i(a(4739)),I=i(a(85185));class M extends o.Component{constructor(e){super(e),this._catalogFlatListController=new E.default,this._handleScroll=(e,t)=>{var a,s;this.props.setScrollOffset&&this.props.setScrollOffset(t.scrollTop),(null===(a=this.state.scrollHelper)||void 0===a?void 0:a.willLoadMore(t))&&this.setState({loadingMore:!0}),null===(s=this.state.scrollHelper)||void 0===s||s.onScroll(e,t).then((e=>{e&&this.setState({loadingMore:!1})})).catch((e=>{throw this.setState({loadingMore:!1}),e}))},this.handleScroll=(0,l.default)(this._handleScroll,100),this.onScroll=e=>{this.handleScroll(e,e.currentTarget)},this.state={loadingMore:!0,dataSource:null,scrollHelper:null}}componentDidMount(){var e=this.getCatalog();if(e){var t=new u.CollectionsDataSource(e,!0,f.default.PRODUCT_LIST_ITEM_HEIGHT);e.collections.on("add",(0,n.default)((()=>this.forceUpdate()),100)),e.collections.on("remove",(0,n.default)((()=>this.forceUpdate()),100));var a=new u.CatalogListItemScrollHelper(t);this.setState({dataSource:t,scrollHelper:a},(()=>{this.loadInitialItems()}))}}getCatalog(){var e=(0,C.getMeUser)();return c.default.get(e)}getDrawerContent(){var e=this.getCatalog(),t=this.state.dataSource;return e&&t?o.createElement("div",null,o.createElement(d.default,{onClick:()=>{this.props.editCollection(null)},theme:"in-list",title:S.default.t(385)}),o.createElement(h.default,{canManage:!0,catalog:e,onEditCollection:this.props.editCollection,data:t.getData(),flatListController:this._catalogFlatListController}),this.state.loadingMore&&o.createElement("div",{className:p.default.loadingSpinner},o.createElement(_.default,null))):null}loadInitialItems(){var e=this;return(0,r.default)((function*(){var{dataSource:t}=e.state;yield null==t?void 0:t.loadInitialItems(),e.setState({loadingMore:!1})}))()}render(){return o.createElement(m.default,{theme:"products",onDrop:this.props.onBack},o.createElement(g.default,{title:S.default.t(388),type:g.DRAWER_HEADER_TYPE.LARGE,onBack:this.props.onBack,menu:o.createElement(o.Fragment,null)}),o.createElement(v.default,{onScroll:this.onScroll,flatListControllers:[this._catalogFlatListController],scrollOffset:this.props.scrollOffset},this.getDrawerContent()))}}t.CollectionsManagementDrawer=M,M.displayName="CollectionsManagementDrawer";var P=(0,I.default)((0,y.default)(M));t.default=P},52585:(e,t,a)=>{"use strict";var s=a(14859),i=a(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=u;var r=i(a(2784)),l=s(a(30430)),n=s(a(14881)),o=s(a(38637)),d=a(27582),c=s(a(18779));function u(e){var{collection:t}=e;switch(t.reviewStatus){case d.PRODUCT_REVIEW_STATUS.PENDING:return r.createElement("div",{className:n.default.pendingBanner},o.default.t(471),r.createElement("div",{className:n.default.iconContainerPending},r.createElement(c.default,{name:"info"})));case d.PRODUCT_REVIEW_STATUS.REJECTED:return r.createElement("div",{className:n.default.rejectedBanner},o.default.t(473),r.createElement(l.default,{onClick:()=>{e.onEditCollection&&e.onEditCollection(e.collection)}},o.default.t(474)),r.createElement("div",{className:n.default.iconContainerRejected},r.createElement(c.default,{name:"info"})));default:return null}}u.displayName="CollectionIntegrityBanner"},89171:(e,t,a)=>{"use strict";var s=a(14859),i=a(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(a(2784)),l=s(a(23045)),n=s(a(85530)),o=s(a(36893)),d=s(a(13819));class c extends r.Component{constructor(...e){super(...e),this._handleSelect=(e,t,a)=>{var{selections:s,active:i,onSelectionChanged:r}=this.props;s.setVal(e,t,a),i.setVal(e,a),r()},this.renderItem=e=>{var{product:t}=e;return r.createElement(d.default,{key:t.id.toString(),product:t,selections:this.props.selections,onClick:()=>this._onProductClick(t),active:this.props.active})}}getData(){var{catalog:e}=this.props;return e.productCollection.getProductModels(!0).map((e=>({itemKey:e.id.toString(),product:e})))}_onProductClick(e){var t=this.props.selections.isSelected(e);this._handleSelect(e,!t,!1)}render(){return r.createElement(o.default,{flatListControllers:[this.props.flatListController]},r.createElement(n.default,{flatListController:this.props.flatListController,direction:"vertical",forceConsistentRenderCount:!1,data:this.getData(),renderItem:this.renderItem,defaultItemHeight:l.default.PRODUCT_LIST_ITEM_HEIGHT,itemEnterAnimationsEnabled:!0}))}}c.displayName="CollectionProductsSelectionList";var u=c;t.default=u},46419:(e,t,a)=>{"use strict";var s=a(93291),i=a(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.EditCollectionContent=void 0;var r=i(a(52954)),l=i(a(12436)),n=i(a(72779)),o=s(a(2784)),d=a(26891),c=a(61675),u=i(a(89171)),h=i(a(23045)),p=i(a(3123)),f=i(a(96881)),m=s(a(32597)),v=i(a(76755)),g=i(a(14076)),E=i(a(13663)),_=i(a(38637)),C=i(a(4739)),S=i(a(94548)),y=i(a(85185)),I=i(a(19432)),M=i(a(99979)),P=i(a(68267)),T=i(a(18779)),L=i(a(92915));class b extends o.Component{constructor(e){var t;super(e),this.active=new M.default([],(e=>e.id)),this.selections=new S.default([],(e=>e.id.toString())),this._collectionFlatListController=new g.default,this._handleScroll=(e,t)=>{var a,s;(null===(a=this.state.scrollHelper)||void 0===a?void 0:a.willLoadMore(t))&&this.setState({loadingMore:!0}),null===(s=this.state.scrollHelper)||void 0===s||s.onScroll(e,t).then((e=>{e&&this.setState({loadingMore:!1})})).catch((e=>{throw this.setState({loadingMore:!1}),e}))},this.handleScroll=(0,l.default)(this._handleScroll,100),this.onScroll=e=>{this.handleScroll(e,e.currentTarget)},this.state={saveEnabled:!0,dataSource:null,scrollHelper:null,name:null===(t=e.collection)||void 0===t?void 0:t.name,errorName:null,isUpdating:!1,loadingMore:!0}}componentDidMount(){this._setupDataSource()}_setupDataSource(){var e,t=new c.CollectionsContentDataSource(this.props.catalog,h.default.PRODUCT_LIST_ITEM_HEIGHT,null===(e=this.props.collection)||void 0===e?void 0:e.id),a=new c.CatalogListItemScrollHelper(t);this.setState({dataSource:t,scrollHelper:a},(()=>{t.loadInitialItems().then((()=>{this.setState({loadingMore:!1}),this.forceUpdate()}))}))}getNameEdit(){return o.createElement(L.default,{editable:!0,focusOnMount:!0,value:this.state.name,onChange:e=>{var t=this.state.errorName;t&&e&&(t=null),this.setState({name:e,errorName:t})},inputPlaceholder:_.default.t(378),theme:"text-input",error:this.state.errorName,maxLength:30})}_getDrawerContent(){var e,t=this.syncSelection();(t>0||this.props.collection&&this.state.name!==this.props.collection.name)&&(e=o.createElement("div",{className:v.default.footer},`${t} Items Updated`,o.createElement("div",{className:v.default.saveButton},o.createElement(I.default,{large:!0,onClick:()=>{this.save()}},o.createElement(T.default,{directional:!0,name:"checkmark-medium"})))));var a=this.state.isUpdating?o.createElement("div",{className:v.default.spinner},o.createElement(P.default,{size:50,stroke:3})):null;return o.createElement(o.Fragment,null,a,o.createElement("div",{className:v.default.nameContainer},o.createElement("span",{className:v.default.nameIcon},o.createElement(T.default,{name:"collections_folder"})),o.createElement("span",{className:v.default.nameEdit},this.getNameEdit())),o.createElement("div",{className:v.default.operation},this.props.collection?_.default.t(387):_.default.t(377)),o.createElement("div",{className:v.default.listContainer},o.createElement(u.default,{catalog:this.props.catalog,flatListController:this._collectionFlatListController,active:this.active,selections:this.selections,onSelectionChanged:()=>this.forceUpdate()}),this.state.loadingMore&&o.createElement("div",{className:v.default.loadingSpinner},o.createElement(E.default,null))),e)}syncSelection(){var e=this.props.catalog.productCollection.getProductModels(!0),t=0;return e.forEach((e=>{this.selections.isInList(e)?e.checkmark!==this.selections.isSelected(e)&&t++:this.selections.setVal(e,e.checkmark)})),t}getProductDeltas(){var e=this.props.catalog.productCollection.getProductModels(!0),t=[],a=[];return e.forEach((e=>{var s=this.selections.isSelected(e);e.checkmark!==s&&(s?a.push(e):t.push(e))})),{added:a,removed:t}}save(){var e=this;return(0,r.default)((function*(){if(e.state.name){e.setState({isUpdating:!0});var{added:t,removed:a}=e.getProductDeltas();try{(yield(0,d.handleCollectionSave)(e.props.catalog,e.props.collection,e.state.name||"",t,a))&&e.props.onBack(),e.setState({isUpdating:!1})}catch(t){e.setState({isUpdating:!1})}}else e.setState({errorName:_.default.t(384)})}))()}render(){var e,t=(0,n.default)(v.default.container,{[v.default.isSending]:this.state.isUpdating}),a=(null===(e=this.props.collection)||void 0===e?void 0:e.name)||_.default.t(386);return o.createElement(p.default,{theme:"products",onDrop:this.props.onBack},o.createElement(m.default,{title:a,type:m.DRAWER_HEADER_TYPE.LARGE,onBack:this.props.onBack,menu:o.createElement(o.Fragment,null)}),o.createElement(f.default,{className:t,flatListControllers:[this._collectionFlatListController],onScroll:this.onScroll},this._getDrawerContent()))}}t.EditCollectionContent=b,b.displayName="EditCollectionContent";var N=(0,y.default)((0,C.default)(b));t.default=N},18457:(e,t,a)=>{"use strict";var s=a(93291),i=a(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.EditProductDrawer=void 0;var r=i(a(72779)),l=s(a(2784)),n=a(26891),o=i(a(36171)),d=i(a(93257)),c=i(a(13277)),u=a(10866),h=s(a(18528)),p=i(a(71699)),f=i(a(3123)),m=i(a(96881)),v=i(a(84755)),g=s(a(32597)),E=i(a(95190)),_=a(33576),C=a(66239),S=i(a(62536)),y=i(a(38637)),I=i(a(4739)),M=a(57934),P=s(a(56811)),T=a(57097),L=a(55439),b=i(a(9246)),N=i(a(85185)),D=i(a(54559)),w=i(a(68267)),O=i(a(90370)),k=i(a(92915)),R=s(a(97025)),A=i(a(22006));class x extends l.Component{constructor(e){var t;super(e),this._imagePanelRef=l.createRef(),this._onNameChange=e=>{this.setState({name:e,nameError:""===e?y.default.t(654):"",isModified:!0})},this.getServerPrice=e=>parseInt(parseFloat(e).toFixed(2).toString().replace(/\.|,/g,""),10),this._onPriceChange=e=>{var t=h.valueFromString(this.state.currency,e),a="";""===e||h.validatePriceString(this.state.currency,e,P.MIN_PRICE,P.MAX_PRICE)||(a=y.default.t(655)),this.setState({priceAmount1000:""===e?null:t,priceStr:`${e}`,priceError:a,isModified:!0})},this.onDescriptionChange=e=>{this.setState({description:e,isModified:!0})},this._onUrlChange=e=>{var t="";""===e||A.default.isValid(e)||(t=y.default.t(660)),this.setState({url:e,urlError:t,isModified:!0})},this._onUrlBlur=()=>{var{url:e}=this.state;""===e||A.default.isHttps(e)||A.default.isHttp(e)||this.setState({url:`https://${e}`})},this._onRetailerIdChange=e=>{this.setState({retailerId:e,retailerIdError:"",isModified:!0})},this._onHiddenChange=()=>{this.setState({isHidden:!this.state.isHidden})},this._getProductChanges=()=>{var{product:e}=this.props,{name:t,priceAmount1000:a,currency:s,description:i,url:r,retailerId:l,isHidden:n}=this.state;return new P.default({id:e.id,priceAmount1000:a,currency:s,description:i||"",imageCdnUrl:e.imageCdnUrl,additionalImageCdnUrl:e.additionalImageCdnUrl,name:t,retailerId:l,url:r,isHidden:n})},this._onSaveItem=()=>{var e,{catalog:t,product:a,newProduct:s}=this.props,i=this._getProductChanges();(s?(0,M.logAddProductClick)((0,L.getProductCatalogContext)(this.context)):(0,M.logEditProductClick)(a,(0,L.getProductCatalogContext)(this.context)),this.setState({isUpdating:!0}),s||this.state.isModified)?null===(e=this._imagePanelRef.current)||void 0===e||e.component.uploadImages().then((e=>{i.imageCdnUrl=e[0],i.additionalImageCdnUrl=e.slice(1),(s?t.addProduct:t.editProduct).call(t,i).then(this._handleEditSuccess).catchType(_.CatalogEditServerError,this._handleEditError).finally((()=>{this.setState({isUpdating:!1})}))})).catch((e=>{throw this.setState({isUpdating:!1}),e})):(0,T.productVisibilitySet)([{productId:a.id.toString(),isHidden:i.isHidden}]).then((()=>{a.isHidden=i.isHidden,this._handleEditSuccess(a)})).catchType(_.CatalogEditServerError,this._handleEditError).finally((()=>{this.setState({isUpdating:!1})}))},this._handleEditError=e=>{this.props.newProduct?(0,M.logAddProductFailed)((0,L.getProductCatalogContext)(this.context)):(0,M.logEditProductFailed)(this.props.product,(0,L.getProductCatalogContext)(this.context),e.statusCode),null!=e.errors&&e.errors.map((e=>{"media"===e.name&&"duplicate"===e.reason&&this.setState({imageError:y.default.t(650)}),"retailer_id"!==e.name&&"retailer-id"!==e.name||"duplicate"!==e.reason||this.setState({retailerIdError:y.default.t(651)})})),c.default.openToast(l.createElement(R.default,{msg:y.default.t(414),id:(0,R.genId)("catalog_save_item_failed")}))},this._handleEditSuccess=e=>{var{catalog:t,onEditSuccess:a,newProduct:s,onCreate:i}=this.props;t.productCollection.add(e,{merge:!0}),this.props.newProduct?(0,M.logAddProductSuccess)((0,L.getProductCatalogContext)(this.context)):(0,M.logEditProductSuccess)(this.props.product,(0,L.getProductCatalogContext)(this.context)),c.default.openToast(l.createElement(R.default,{msg:y.default.t(405),id:(0,R.genId)("catalog_item_saved")})),a(e),null!=s&&i&&i()},this._onDeleteItem=()=>{var{catalog:e,product:t,onDelete:a}=this.props;(0,n.handleProductDelete)(e,t,(0,L.getProductCatalogContext)(this.context)).then((e=>{e&&(c.default.closeDrawerMid(),a&&a())}))},this._onImageChange=e=>{var t="";0===e.length&&(t=y.default.t(653)),this.setState({imageError:t,hasImages:e.length>0,isModified:!0})},this.onDrop=e=>{var t;null===(t=this._imagePanelRef.current)||void 0===t||t.component.onFilePick(e)},this.onDragChange=e=>{this.setState({isDragging:e})};var{product:a}=this.props,s=null==a.priceAmount1000?null:a.priceAmount1000,i="";if(null!=s&&null!=a.currency){var r=h.formatToParts(a.currency,s);i=`${r.integer}${r.decimal}`}this.state={name:a.name||"",priceAmount1000:s,description:a.description||"",url:a.url||"",retailerId:a.retailerId||"",priceStr:i,currency:a.currency||h.currencyForCountryShortcode((0,u.getCountryShortcodeByPhone)(null===(t=(0,C.getMaybeMeUser)())||void 0===t?void 0:t.user)),isUpdating:!1,nameError:"",priceError:"",urlError:"",retailerIdError:"",imageError:"",hasImages:!!a.imageCdnUrl,isDragging:!1,isHidden:a.isHidden,isModified:!1}}componentDidMount(){var{listeners:e,product:t}=this.props;e.add(t,"change:isHidden",(()=>{this.setState({isHidden:this.props.product.isHidden})}))}isValid(){var{name:e,nameError:t,priceError:a,urlError:s,retailerIdError:i,imageError:r,hasImages:l}=this.state;return""!==e&&!1!==l&&t+a+s+i+r===""}render(){var{product:e,onBack:t,onCancel:a,newProduct:s}=this.props,{isUpdating:i,isDragging:n,currency:c,nameError:u,priceError:v,urlError:_,retailerIdError:C,imageError:S}=this.state,I=l.createElement(o.default,{type:"primary",onClick:this._onSaveItem,disabled:!this.isValid(),a8nText:"product-edit-drawer-save-button"},s?y.default.t(221):y.default.t(1241)),M=l.createElement("div",{className:E.default.drawerHeader},l.createElement("div",null,s?y.default.t(419):y.default.t(420)),l.createElement("div",{className:E.default.drawerHeaderButtonContainer},I)),T=s?null:l.createElement("div",{className:E.default.deleteButtonContainer},l.createElement(o.default,{type:"warning",onClick:this._onDeleteItem,a8nText:"product-edit-drawer-delete-button"},y.default.t(534))),L=(0,r.default)(E.default.productWrapper,{[E.default.isSending]:i}),N=n?l.createElement(p.default,null):null,O=i?l.createElement("div",{className:E.default.spinner},l.createElement(w.default,{size:50,stroke:3})):null,R=D.default.webCatalogProductsOnOff&&l.createElement("div",{className:E.default.hiddenContainer},l.createElement(d.default,{id:"product-hidden-check",onChange:this._onHiddenChange,checked:this.state.isHidden,disabled:!1}),l.createElement("label",{className:E.default.hiddenLabel,htmlFor:"product-hidden-check"},y.default.t(402)),l.createElement("div",{className:E.default.hiddenDescr},y.default.t(401)));return l.createElement(f.default,{key:"catalog-link-drawer",theme:"catalog",onDrop:this.onDrop,onDragChange:this.onDragChange},N,l.createElement(g.default,{a8n:"catalog-link-title",title:M,type:g.DRAWER_HEADER_TYPE.SMALL,onBack:t,onCancel:a}),l.createElement(m.default,null,l.createElement("div",{className:L},O,l.createElement(b.default,{product:e,maxImageCount:P.MAX_PRODUCT_IMAGES,onChange:this._onImageChange,ref:this._imagePanelRef,error:S}),l.createElement(k.default,{a8n:"product-edit-drawer-name-input",value:this.state.name,placeholder:y.default.t(838),onChange:this._onNameChange,theme:"small",customStyleThemes:["desaturated"],maxLength:150,error:u}),l.createElement(k.default,{a8n:"product-edit-drawer-price-input",value:this.state.priceStr,placeholder:y.default.t(839,{currencySymbol:h.formatToParts(c,0).symbol}),onChange:this._onPriceChange,theme:"small",maxLength:30,customStyleThemes:["desaturated"],error:v}),l.createElement(k.default,{a8n:"product-edit-drawer-description-input",value:this.state.description,placeholder:y.default.t(836),onChange:this.onDescriptionChange,theme:"small",maxLength:5e3,customStyleThemes:["desaturated"],multiline:!0}),l.createElement(k.default,{a8n:"product-edit-drawer-link-input",value:this.state.url,placeholder:y.default.t(837),onChange:this._onUrlChange,onBlur:this._onUrlBlur,theme:"small",customStyleThemes:["desaturated"],maxLength:75,error:_,managed:!0}),l.createElement(k.default,{a8n:"product-edit-drawer-retailer-id-input",value:this.state.retailerId,placeholder:y.default.t(835),onChange:this._onRetailerIdChange,theme:"small",customStyleThemes:["desaturated"],maxLength:100,error:C}),R,T)))}}t.EditProductDrawer=x,x.contextType=v.default,x.CONCERNS={product:["id","additionalImageCdnUrl","name","priceAmount1000","description","productImageCollection","reviewStatus","url","imageCdnUrl","retailerId","currency","isHidden"]},x.displayName="EditProductDrawer";var F=(0,S.default)((0,N.default)((0,O.default)((0,I.default)(x),x.CONCERNS)));t.default=F},71429:(e,t,a)=>{"use strict";var s=a(93291),i=a(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=P;var r=i(a(72779)),l=s(a(2784)),n=i(a(2359)),o=i(a(78523)),d=i(a(13277)),c=i(a(23045)),u=i(a(3123)),h=i(a(96881)),p=i(a(84755)),f=s(a(32597)),m=i(a(84340)),v=a(33576),g=i(a(38637)),E=a(57934),_=i(a(72634)),C=a(57097),S=a(55439),y=i(a(68267)),I=a(74315),M=s(a(97025));function P(e){var{onBack:t,onAddProductClick:a,onCatalogAlreadyCreated:s}=e,[i,P]=l.useState(!1),T=l.createElement("div",{className:_.default.placeholderIcon}),L=`<a href="${c.default.FB_LEGAL_TERMS_URL}" target="_blank">${g.default.t(665)}</a>`,b=`<a href="${c.default.FB_COMMERCE_POLICY_URL}" target="_blank">${g.default.t(664)}</a>`,N=`<a href="${c.default.WA_COMMERCE_POLICY_URL}" target="_blank">${g.default.t(1880)}</a>`,D=g.default.t(396,{fb_product_link:L,fb_commerce_link:b,wa_commerce_policy_link:N});var w=(0,r.default)({[_.default.isLoading]:i}),O=i?l.createElement("div",{className:_.default.spinner},l.createElement(y.default,{size:50,stroke:3})):null,k=i?l.createElement(n.default,{onClick:()=>{},theme:"default",idle:!!i}):l.createElement(p.default.Consumer,null,(e=>l.createElement(n.default,{onClick:()=>{!function(e){P(!0),(0,E.logCreateProductCatalogClick)(e),(0,C.createCatalog)().then((()=>{(0,E.logCreateProductCatalogSuccess)(e),a()})).catchType(v.ServerStatusCodeError,(t=>{(0,E.logCreateProductCatalogFailed)(e,t.statusCode),d.default.openToast(l.createElement(M.default,{msg:g.default.t(649),id:(0,M.genId)("err_catalog_already_created")})),s()})).finally((()=>{P(!1)}))}((0,S.getProductCatalogContext)(e))},theme:"default",idle:!1})));return l.createElement(u.default,{key:"catalog-link-drawer"},l.createElement(f.default,{title:g.default.t(1162),type:f.DRAWER_HEADER_TYPE.LARGE,onBack:t}),l.createElement(h.default,{className:w},l.createElement(m.default,{theme:"padding-small",animation:!1},O,l.createElement(I.TextDiv,{theme:"title"},g.default.t(374)),k,l.createElement(I.TextDiv,{theme:"plain"},l.createElement("div",{dangerouslySetInnerHTML:{__html:D}})),l.createElement("div",{className:_.default.placeholderContainer},l.createElement(o.default,{theme:"add-item-placeholder",image:T,customImage:!0,className:_.default.addItemPlaceholder,primary:"",secondary:"",idle:!0}),l.createElement("div",{className:_.default.divider}),l.createElement(o.default,{theme:"add-item-placeholder",image:T,customImage:!0,className:_.default.addItemPlaceholder,primary:"",secondary:"",idle:!0}),l.createElement("div",{className:_.default.divider})))))}P.displayName="NewCatalogDrawer"},84802:(e,t,a)=>{"use strict";var s=a(14859),i=a(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.ProductInfoDrawer=void 0;var r=i(a(2784)),l=s(a(36171)),n=s(a(3123)),o=s(a(96881)),d=s(a(84755)),c=i(a(32597)),u=s(a(84340)),h=s(a(13663)),p=a(66239),f=s(a(62536)),m=s(a(38637)),v=a(57934),g=a(42643),E=a(55439),_=a(27582),C=s(a(7075)),S=s(a(25331)),y=s(a(48184)),I=s(a(21311)),M=s(a(10816)),P=s(a(54559)),T=s(a(90370)),L=s(a(48514)),b=a(74315);class N extends r.Component{constructor(e){super(e),this.onEditProduct=()=>{var{product:e}=this.props;this.props.onEditProduct&&this.props.onEditProduct(e)},this.onShareProduct=()=>{var{product:e}=this.props;this.props.onShareProduct&&this.props.onShareProduct(e)},this.onSendChat=()=>{this.props.onCancel(),(0,g.sendProductToChat)(this.props.product,this.props.catalog),(0,v.logProductMessageBusinessClick)(this.props.product,(0,E.getProductCatalogContext)(this.context))},this.state={isLoading:!0}}componentDidMount(){var{catalog:e,product:t}=this.props;e.pullProduct(t.id.toString()).finally((()=>{this.setState({isLoading:!1})})),(0,v.logProductDetailView)({product:t,catalogContext:(0,E.getProductCatalogContext)(this.context)})}render(){var{product:e,onCancel:t}=this.props,a=(0,p.getMaybeMeUser)(),s=L.default.get(a),i=r.createElement(b.TextDiv,{theme:"muted",className:S.default.businessInfoTitle},m.default.t(312)),d=e.reviewStatus!==_.PRODUCT_REVIEW_STATUS.APPROVED||e.isHidden&&P.default.webCatalogProductsOnOff,f=r.createElement("div",null,r.createElement("div",{className:S.default.buttonSeparator},r.createElement(l.default,{type:"strong",onClick:this.onEditProduct},m.default.t(569))),r.createElement(l.default,{type:"strong-primary",onClick:this.onShareProduct,disabled:d},m.default.t(1806))),v=r.createElement("div",{className:S.default.drawerHeader},r.createElement("div",{className:S.default.productName},e.name),r.createElement("div",{className:S.default.drawerHeaderButtonContainer},f)),g=s?r.createElement(u.default,{title:i,theme:"no-padding"},r.createElement(M.default,{status:s})):null,E=this.state.isLoading?r.createElement(h.default,null):r.createElement(r.Fragment,null,r.createElement(I.default,{product:e,isAvailable:!0,fetching:!1}),r.createElement(y.default,{product:e}),r.createElement(C.default,{product:e,onSendChat:this.onSendChat,isAvailable:!0}));return r.createElement(n.default,{key:"catalog-link-drawer",theme:"catalog"},r.createElement(c.default,{a8n:"catalog-product-title",title:v,type:c.DRAWER_HEADER_TYPE.SMALL,onCancel:t}),r.createElement(o.default,null,r.createElement(u.default,{theme:"center-column-fixed-width"},E),r.createElement("div",{className:S.default.productWrapper},g)))}}t.ProductInfoDrawer=N,N.contextType=d.default,N.CONCERNS={product:["id","catalogWid","name","priceAmount1000","description","productImageCollection","reviewStatus","url","canAppeal","imageCdnUrl","retailerId","currency","isHidden"]},N.displayName="ProductInfoDrawer";var D=(0,f.default)((0,T.default)(N,N.CONCERNS));t.default=D},48184:(e,t,a)=>{"use strict";var s=a(14859),i=a(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=g;var r=i(a(2784)),l=s(a(13e3)),n=s(a(13277)),o=s(a(23045)),d=s(a(84755)),c=s(a(38637)),u=a(55439),h=a(27582),p=s(a(26926)),f=s(a(54559)),m=s(a(18779)),v=a(74315);function g(e){var{product:t}=e;function a(){n.default.openModal(r.createElement(d.default.Consumer,null,(e=>r.createElement(l.default,{product:t,sessionId:(0,u.getProductCatalogSessionId)(e)}))))}var s=`<a href="${o.default.WA_COMMERCE_POLICY_URL}" target="_blank">${c.default.t(844)}</a>`;if(t.reviewStatus===h.PRODUCT_REVIEW_STATUS.APPROVED)return t.isHidden&&f.default.webCatalogProductsOnOff?r.createElement("div",{className:p.default.hiddenProductInfoContainer},r.createElement("div",{className:p.default.hiddenProductInfoIcon},r.createElement(m.default,{name:"hide"})),r.createElement("div",{className:p.default.hiddenProductInfoText},r.createElement(v.TextDiv,null,c.default.t(1166)))):null;if(t.reviewStatus===h.PRODUCT_REVIEW_STATUS.REJECTED){if(!0===t.canAppeal){var i=`${c.default.t(403,{learn_more_link:s})}`,g=r.createElement("div",{dangerouslySetInnerHTML:{__html:i}}),E=`<span class="${p.default.appealLink}">${c.default.t(404)}</span>`,_=`${c.default.t(397,{request_review_link:E})}`,C=r.createElement("div",{dangerouslySetInnerHTML:{__html:_}});return r.createElement("div",{className:p.default.statusAlert,"data-a8n":"product-appeal-rejected-initial-review"},g,r.createElement(v.TextDiv,{className:p.default.appealText},r.createElement("div",{onClick:a,onKeyPress:a,role:"button",tabIndex:"0","data-a8n":"product-appeal-button"},C)))}var S=`${c.default.t(399,{learn_more_link:s})}`,y=r.createElement("div",{dangerouslySetInnerHTML:{__html:S}});return r.createElement("div",{className:p.default.statusAlert,"data-a8n":"product-appeal-rejected-final"},y)}if(t.reviewStatus===h.PRODUCT_REVIEW_STATUS.NO_REVIEW||t.reviewStatus===h.PRODUCT_REVIEW_STATUS.OUTDATED){var I=t.isHidden&&f.default.webCatalogProductsOnOff?`${c.default.t(412,{learn_more_link:s})}`:`${c.default.t(411,{learn_more_link:s})}`;return r.createElement("div",{className:p.default.statusAlert,"data-a8n":"product-appeal-pending-initial-review"},r.createElement("div",{dangerouslySetInnerHTML:{__html:I}}))}if(!1===t.canAppeal){var M=c.default.t(398);return r.createElement("div",{className:p.default.statusAlert,"data-a8n":"product-appeal-pending-appeal"},M)}return null}g.displayName="ProductStatusBanner"},10816:(e,t,a)=>{"use strict";var s=a(14859),i=a(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(a(2784)),l=s(a(78523)),n=s(a(79435)),o=s(a(51045)),d=a(66239),c=s(a(62536)),u=s(a(90370));class h extends r.Component{constructor(e){super(e)}render(){var{status:e}=this.props;return r.createElement(l.default,{image:r.createElement(o.default,{id:(0,d.getMaybeMeUser)()}),primary:n.default.pushname,secondary:e.status,idle:!0})}}h.CONCERNS={status:["status"]},h.displayName="ProfileLockup";var p=(0,c.default)((0,u.default)(h,h.CONCERNS));t.default=p},84149:(e,t,a)=>{"use strict";var s=a(14859),i=a(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(a(2784)),l=a(26891),n=s(a(13277)),o=s(a(52585)),d=s(a(49355)),c=s(a(23045)),u=s(a(84755)),h=s(a(85530)),p=s(a(36893)),f=s(a(14076)),m=a(57934),v=a(55439),g=s(a(55794)),E=a(27582),_=s(a(85185)),C=s(a(90370)),S=a(47138);class y extends r.Component{constructor(e){super(e),this._catalogFlatListController=new f.default,this.onProductDetail=e=>{var{onProductDetail:t}=this.props;return(0,m.logCatalogListDetailClick)({product:(0,S.unproxy)(e),catalogContext:(0,v.getProductCatalogContext)(this.context)}),this.setState({openedProductId:e.id.toString()}),t(e)},this.onProductShare=e=>{var{onProductShare:t}=this.props;t&&t(e)},this.onProductDelete=e=>{var{catalog:t}=this.props;(0,l.handleProductDelete)(t,e,(0,v.getProductCatalogContext)(this.context)).then((()=>{e.id===this.state.openedProductId&&(n.default.closeDrawerMid(),this.setState({openedProductId:void 0}))}))},this.onProductHideShow=e=>{(0,l.handleProductVisibilityChange)(e,(0,v.getProductCatalogContext)(this.context))},this.renderItem=e=>{var{collection:t,product:a,allItems:s,reviewBanner:i}=e,{onCartOpen:l,shareLinks:n}=this.props;return t?i?r.createElement(o.default,{collection:t,onEditCollection:this.props.onEditCollection}):r.createElement(d.default,{collection:t,onSeeAll:this.props.onCollectionSeeAll}):s?r.createElement(d.default,{allItems:s,onSeeAll:this.props.onCollectionSeeAll}):a?r.createElement(g.default,{product:a,onCartOpen:l,onClick:()=>this.onProductDetail(a),onProductShare:n?this.onProductShare:null,onProductDelete:this.onProductDelete,onProductHideShow:this.onProductHideShow,canManageCatalog:this.props.canManageCatalog}):null},this.state={openedProductId:void 0,loadingMore:!1,stopLoading:!1,catalogFetchState:e.catalog?"SUCCESS":"NONE"}}getData(){var{onCartOpen:e}=this.props,t=void 0!==e,a=this.props.data||[],s=[];return a.forEach((e=>{var a=e.collection,i=e.product,r=e.allItems;a&&i?s.push({itemKey:`${a.id.toString()}_${i.id.toString()}_${t.toString()}`,product:i}):a?(s.push({itemKey:a.id.toString(),collection:a}),a.reviewStatus!==E.PRODUCT_REVIEW_STATUS.PENDING&&a.reviewStatus!==E.PRODUCT_REVIEW_STATUS.REJECTED||s.push({itemKey:`${a.id.toString()}_reviewBanner`,collection:a,reviewBanner:!0})):r?s.push({itemKey:"view_all",allItems:r}):i&&s.push({itemKey:`${i.id.toString()}_${t.toString()}`,product:i})})),s}render(){var e=this.getData();return r.createElement(r.Fragment,null,r.createElement(p.default,{flatListControllers:[this._catalogFlatListController]},r.createElement(h.default,{flatListController:this._catalogFlatListController,direction:"vertical",forceConsistentRenderCount:!1,data:e,renderItem:this.renderItem,defaultItemHeight:c.default.PRODUCT_LIST_ITEM_HEIGHT,itemEnterAnimationsEnabled:!0})))}}y.CONCERNS={catalog:["productCollection","collections","afterCursor","id","index"]},y.contextType=u.default,y.displayName="ProductCollectionsList";var I=(0,_.default)((0,C.default)(y,y.CONCERNS));t.default=I},9246:(e,t,a)=>{"use strict";var s=a(14859),i=a(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(a(2784)),l=s(a(25713)),n=s(a(13277)),o=s(a(23045)),d=a(15740),c=i(a(24461)),u=s(a(38637)),h=a(27305),p=a(60301),f=a(36169),m=s(a(93013)),v=s(a(58669)),g=s(a(91100)),E=s(a(85185)),_=s(a(18779)),C=i(a(97025)),S=s(a(82838));class y extends r.Component{constructor(e){super(e),this.onAddFileClick=()=>{this.refInput&&this.refInput.click()},this.onFilePick=e=>{(0,d.getFiles)(e,o.default.IMAGE_MIMES).then((e=>{var t=this.props.maxImageCount-this.state.images.length;e.length>t&&n.default.openToast(r.createElement(C.default,{msg:u.default.t(904),duration:6e3,action:{onAction:()=>{},actionText:u.default.t(717),dismiss:!0,theme:"success"},id:(0,C.genId)()})),e.slice(0,this.props.maxImageCount-this.state.images.length).map((e=>({file:e,filename:e.name,mimetype:e.type,type:f.TYPE.PRODUCT}))).map((e=>{var t,a=new l.default({file:Promise.resolve(e)});return null===(t=a.processPromise)||void 0===t?void 0:t.then((()=>{this._appendImage(a)}))}))})).checkpoint(this.props.rejectOnUnmount()).catchType(c.Unmount,(()=>{})),e.target&&e.target.value&&(e.target.value="")},this.uploadImages=()=>{var e=this.state.images.filter((e=>null==e.url)).map((e=>(0,h.uploadProductImage)(e.mediaData.mediaBlob,e.mediaData.filehash).then((t=>{e.url=t}))));return Promise.all(e).then((()=>this.state.images.map((e=>e.url||""))))},this.setRefInput=e=>{this.refInput=e};var t=e.product.productImageCollection.filter((e=>!e.old)).map((e=>({url:e.mediaUrl,mediaData:e.mediaData})));this.state={images:t}}_appendImage(e){e.mediaPrep.waitForPrep().then((t=>{if(this._validateImage(t)){t.mediaStage=p.MEDIA_DATA_STAGE.RESOLVED,t.renderableUrl=e.fullPreview;var a=t.mediaBlob;!a||a instanceof m.default||m.default.createFromData(a,a.type).then((e=>{t.mediaBlob=e})),this.setState({images:[...this.state.images,{url:null,mediaData:t}]}),this.props.onChange&&this.props.onChange(this.state.images)}}))}_validateImage(e){return!(this.state.images.filter((t=>t.mediaData.filehash===e.filehash)).length>0)||(n.default.openToast(r.createElement(C.default,{id:(0,C.genId)(),msg:u.default.t(650)})),!1)}_deleteImage(e){var t=this.state.images.filter((t=>t!==e));this.setState({images:t}),this.props.onChange&&this.props.onChange(t)}_renderTiles(){return this.state.images.filter((e=>e.mediaData)).map((e=>r.createElement("div",{key:e.mediaData.filehash,className:v.default.imageTile},r.createElement("div",{className:v.default.btnDelete,onClick:()=>this._deleteImage(e),role:"button"},r.createElement(_.default,{className:v.default.deleteIcon,name:"x-alt"})),r.createElement(g.default,{mediaData:e.mediaData,className:v.default.imageThumb}))))}_renderAddImageButton(){return this.state.images.length<this.props.maxImageCount?r.createElement("div",{className:v.default.btnAddContainer,onClick:this.onAddFileClick,role:"button"},r.createElement("div",{className:v.default.btnAdd},r.createElement(_.default,{name:"camera"}),r.createElement("div",{className:v.default.btnAddText},u.default.t(373)))):null}_renderFileInput(){return r.createElement("input",{ref:this.setRefInput,type:"file",accept:o.default.IMAGE_MIMES,style:{display:"none"},onChange:this.onFilePick,multiple:!0})}renderErrorMessage(){return r.createElement("div",{className:v.default.errorMessage},this.props.error)}render(){return r.createElement("div",{className:v.default.panel},r.createElement("div",{className:v.default.tileContainer},r.createElement(S.default,{transitionAppear:!0,transitionName:"thumb-scale-flex"},this._renderTiles(),this._renderAddImageButton()),this._renderFileInput()),this.renderErrorMessage())}}y.displayName="ProductImagesEditPanel";var I=(0,E.default)(y);t.default=I},85235:(e,t,a)=>{"use strict";var s=a(93291),i=a(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function({flatListController:e,onProductDetail:t,productMessageList:a}){var s=a.productCollection.getProductModels(),i=a.getSections(),_=a.getSectionsCount()>0,C=a.getTotalProductsFetchedOrFailed(),S=a.getProductSize()===C&&0===s.length,y=[];i.forEach((({title:e,products:t},a)=>{var i=[];t.forEach((({productId:e})=>{var t=s.find((t=>t.id===e));null!=t&&i.push({itemKey:`section-${a}-${t.id.toString()}`,product:t,type:"product",height:o.default.PRODUCT_LIST_ITEM_HEIGHT})})),i.length>0&&(null!=e&&""!==e&&y.push({itemKey:`header-${a}-${e}`,label:e,type:"section",height:72}),y.push(...i))}));var I=(0,l.useCallback)(((e,a)=>((0,h.logCatalogListDetailClick)({product:(0,E.unproxy)(e),catalogContext:a}),t(e))),[t]),M=(0,l.useCallback)((e=>{var t=null;switch(e.type){case"section":var{label:a}=e;t=l.createElement(g.default,{header:a});break;case"product":var{product:s}=e;t=l.createElement(d.default.Consumer,null,(e=>l.createElement(f.default,{product:s,onClick:()=>I(s,(0,p.getProductCatalogContext)(e)),canManageCatalog:!1})))}return t}),[I]);return(0,l.useEffect)((()=>{S&&n.default.openModal(l.createElement(v.default,{onConfirm:()=>{n.default.closeDrawerRight(),n.default.closeModal()}}))}),[S]),l.createElement("div",{className:(0,r.default)({[m.default.list]:!0,[m.default.noSections]:!_})},l.createElement(u.default,{flatListControllers:[e]},l.createElement(c.default,{flatListController:e,direction:"vertical",forceConsistentRenderCount:!1,data:y,renderItem:M,itemEnterAnimationsEnabled:!0})))};var r=i(a(72779)),l=s(a(2784)),n=i(a(13277)),o=i(a(23045)),d=i(a(84755)),c=i(a(85530)),u=i(a(36893)),h=a(57934),p=a(55439),f=i(a(55794)),m=i(a(64278)),v=i(a(92780)),g=i(a(87653)),E=a(47138)},91934:(e,t,a)=>{"use strict";var s=a(93291),i=a(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.ProductMessageListDrawer=void 0;var r=i(a(12436)),l=s(a(2784)),n=a(79930),o=i(a(59544)),d=i(a(1882)),c=i(a(23045)),u=i(a(3123)),h=i(a(96881)),p=i(a(84755)),f=s(a(32597)),m=i(a(30905)),v=s(a(24461)),g=a(96313),E=i(a(40517)),_=i(a(14076)),C=i(a(13663)),S=i(a(38637)),y=i(a(4739)),I=a(84982),M=a(58868),P=a(55439),T=i(a(85235)),L=i(a(27617)),b=i(a(10413)),N=i(a(85185)),D=i(a(90370)),w=a(61864);class O extends l.Component{constructor(e){super(e),this._productListFlatListController=new _.default,this._handleScroll=e=>{this.state.loadingMore||e.scrollTop+c.default.SCROLL_FUDGE>e.scrollHeight-e.clientHeight&&this._loadMoreProduct()},this.handleScroll=(0,r.default)(this._handleScroll,100),this._loadMoreProduct=()=>{var{productListId:e}=this.props,{stopLoading:t,loadedProducts:a}=this.state;if(!t){var s=L.default.assertGet(e),i=s.getTotalProductsFetchedOrFailed(),r=s.getProductSize();i!==r?(this.setState({loadingMore:!0,loadedProducts:i}),L.default.update(e).checkpoint(this.props.rejectOnUnmount()).then((e=>{this.setState({loadingMore:!1}),(Array.isArray(e)?e[0]:e).getTotalProductsFetchedOrFailed()===a&&this.setState({stopLoading:!0}),i*c.default.PRODUCT_LIST_ITEM_HEIGHT<window.innerHeight&&this._loadMoreProduct()})).catchType(v.Unmount,(()=>{})).catch((()=>{this.setState({loadingMore:!1,stopLoading:!0})}))):this.setState({stopLoading:!0})}},this.onScroll=e=>{this.handleScroll(e.currentTarget),this.props.setScrollOffset&&this.props.setScrollOffset(e.currentTarget.scrollTop)},this._onCartChange=()=>{var e=this.state.cart.itemCount;this.state.cartCount!==e&&this.setState({cartCount:e})},this._onCartClick=()=>{var{contact:e,onCartClick:t}=this.props;t&&t(e.id.toString())};var t=L.default.get(this.props.productListId),a=o.default.findCart(this.props.contact.id.toString());this.state={loadingMore:!1,loadedProducts:0,stopLoading:!1,productMessageList:t,cart:a,cartCount:a.itemCount,cartEnabled:!1,productMessageListFetchState:t?"SUCCESS":"NONE"}}componentDidMount(){var{listeners:e,contact:t}=this.props;e.add(this.state.cart,"all",this._onCartChange),this.state.productMessageList?this._loadMoreProduct():this._findProductMessageList(),(0,n.checkCartEnabled)(t.id).checkpoint(this.props.rejectOnUnmount()).then((e=>{this.setState({cartEnabled:e})})).catchType(v.Unmount,(()=>{}))}_findProductMessageList(){return L.default.find(this.props.productListId).checkpoint(this.props.rejectOnUnmount()).then((e=>{this.setState({productMessageList:e,productMessageListFetchState:"SUCCESS"}),this._loadMoreProduct()})).catch((e=>{(0,g.parseErrorState)(e,(e=>this.setState({productMessageListFetchState:e})))}))}_getDrawerContent(){var{productMessageList:e}=this.state;return e?l.createElement(l.Fragment,null,l.createElement("div",null,l.createElement(T.default,{productMessageList:e,flatListController:this._productListFlatListController,onProductDetail:this.props.onProductDetail}),this.state.loadingMore&&l.createElement(C.default,null))):l.createElement(E.default,{fetchState:this.state.productMessageListFetchState})}_getCartIcon(){var{onCartClick:e,contact:t}=this.props;if(e&&this.state.cartEnabled){var a=this.state.cartCount,s=(0,w.isNumber)(a)&&a>0?a.toString():void 0,i=(0,I.getOnCartClickWithLog)(this._onCartClick,t.id.toString(),(0,P.getProductCatalogContext)(this.context));return l.createElement(M.MenuBarItem,{a8nText:"menu-bar-cart-link",icon:l.createElement(d.default,{theme:"inherit-color"}),text:s,title:S.default.t(359),onClick:i})}return null}render(){var{productMessageList:e}=this.state;return l.createElement(u.default,{theme:"products",onDrop:this.props.onBack},l.createElement(f.default,{title:l.createElement("div",{className:b.default.title},l.createElement(m.default,{text:null==e?void 0:e.title,ellipsify:!0})),type:f.DRAWER_HEADER_TYPE.SMALL,onBack:this.props.onBack,menu:this._getCartIcon()}),l.createElement(h.default,{onScroll:this.onScroll,flatListControllers:[this._productListFlatListController],scrollOffset:this.props.scrollOffset},this._getDrawerContent()))}}t.ProductMessageListDrawer=O,O.contextType=p.default,O.CONCERNS={contact:["id"]},O.displayName="ProductMessageListDrawer";var k=(0,N.default)((0,y.default)((0,D.default)(O,O.CONCERNS)));t.default=k},92780:(e,t,a)=>{"use strict";var s=a(14859),i=a(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function({onConfirm:e}){return r.createElement(l.default,{onOK:e,okText:o.default.t(1738)},r.createElement(n.default,{text:o.default.t(1169)}))};var r=i(a(2784)),l=s(a(76176)),n=s(a(30905)),o=s(a(38637))},88322:(e,t,a)=>{"use strict";var s=a(14859),i=a(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(a(2784)),l=s(a(89962)),n=s(a(38637)),o=s(a(21830)),d=i(a(55231)),c=s(a(73908)),u=(e,t)=>{var[a,s]=r.useState(!1),[i,u]=r.useState([]),h=r.createElement(c.default,{disabled:!a,onClick:()=>{var t,a=(0,o.default)(null===(t=i[0])||void 0===t?void 0:t.catalogWid,"products[0]?.catalogWid"),s=(0,o.default)(l.default.get(a),"CatalogCollection.get(catalogWid)");e.onShare(s)}});return r.createElement(d.default,{ref:t,title:n.default.t(1303),onCancel:e.onCancel,onConfirm:e.onConfirm,listType:d.ListType.PRODUCT_SELECT_MODAL,enableSearchBox:!1,customHeader:h,onSelectionChanged:(e,t,a)=>{s(0===a.length)},onDataLoaded:e=>{var t=e;u(t),s(t.length>0)}})};u.displayName="SelectProductsModal";var h=r.forwardRef(u);t.default=h},73908:(e,t,a)=>{"use strict";var s=a(14859),i=a(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=u;var r=i(a(2784)),l=s(a(78523)),n=s(a(38637)),o=s(a(71673)),d=s(a(82841)),c=s(a(18779));function u(e){var t=e.disabled?d.default.disabled:"",a=e.disabled?null:e.onClick,s=r.createElement("span",{className:d.default.title},n.default.t(1159)),i=r.createElement(o.default,{theme:"compact",disabled:e.disabled},r.createElement(c.default,{name:"catalog"}));return r.createElement(l.default,{image:i,onClick:a,primary:s,theme:"list-button-compact",className:t})}u.displayName="SendCatalogButton"},32945:(e,t,a)=>{"use strict";var s=a(93291),i=a(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(a(72779)),l=s(a(2784)),n=i(a(87962)),o=i(a(99461)),d=i(a(90370)),c=i(a(97216)),u=i(a(86325));class h extends l.PureComponent{render(){var{statusV3:e,contact:t}=this.props,a=(0,r.default)({[c.default.dimmed]:t.statusMute}),s=o.default.relativeDateAndTimeStr(e.t);return l.createElement(n.default,{className:a,key:e.id.toString(),customImage:!0,theme:"status-list",image:l.createElement(u.default,{statusV3:e,contact:t,onClick:this.props.onClick}),primary:t.formattedName,secondary:s,onClick:this.props.onClick,contextEnabled:()=>!1})}}h.CONCERNS={statusV3:["id","t","hasUnread","unreadCount","totalCount","contact"],contact:["formattedName","statusMute"]},h.displayName="StatusV3Cell";var p=(0,d.default)(h,h.CONCERNS);t.default=p},86325:(e,t,a)=>{"use strict";var s=a(93291),i=a(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(a(72779)),l=s(a(2784)),n=i(a(23045)),o=i(a(51045)),d=i(a(68043)),c=i(a(90370)),u=i(a(44233)),h=a(29848),p=i(a(49670));class f extends l.PureComponent{constructor(...e){super(...e),this._handleContextMenu=()=>{}}_getMsgToRender(){var{statusV3:e,msg:t}=this.props;return null!=t?t:e.lastStatus}render(){var e,{statusV3:t,contact:a,theme:s,thumbnailPlaceholder:i}=this.props,n=E(s),d=this._getMsgToRender();return e=null!=i?i:d?l.createElement(o.default,{id:d.sender,theme:"status_v3",size:40}):null,l.createElement("div",{className:(0,r.default)(p.default.container,n),role:this.props.role||"",onContextMenu:null,onClickCapture:e=>{this.props.onClick&&this.props.onClick(),e.stopPropagation(),e.preventDefault()}},a.statusMute||"status-panel"===s?null:l.createElement(u.default,{statusV3:t}),l.createElement(m,{msg:d,theme:s,thumbnailPlaceholder:e}))}}function m(e){var{msg:t,theme:a,thumbnailPlaceholder:s}=e,i=E(a),o=p.default.statusImage;return t?t.type===n.default.MSG_TYPE.CHAT?l.createElement(v,{msg:t,theme:a}):l.createElement(d.default,{containerClassName:(0,r.default)(p.default.thumbContainer,i,p.default.statusImageFallbackBackground),childClassName:(0,r.default)(o,i),msg:t,thumbnailPlaceholder:s}):l.createElement("div",{className:(0,r.default)(o,i,p.default.statusImageFallbackBackground)})}function v(e){var{msg:t,theme:a}=e;return l.createElement("div",{className:(0,r.default)(p.default.statusImage,E(a)),style:{backgroundColor:t.statusV3TextBg}},l.createElement("div",{className:(0,r.default)(p.default.textThumb,E(a))},l.createElement(h.StatusV3Text,{msg:t,theme:null!=a?a:"status-thumbnail"})))}f.CONCERNS={statusV3:["lastStatus"],contact:["statusMute"]},f.displayName="StatusV3Thumbnail";var g=(0,c.default)(f,f.CONCERNS);function E(e){return"status-panel"===e?p.default.thumbSizeLarge:p.default.thumbSizeSmall}t.default=g},25682:(e,t,a)=>{"use strict";var s=a(14859),i=a(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.search=function(e,t,a=30){var s={q:e,SafeSearch:"Strict",appid:"D41D8CD98F00B204E9800998ECF8427E4F4A7492",mkt:u[l.default.getLocale()]||u.en,size:c,aspect:d,count:a,offset:t},i=n.default.build("https://www.bingapis.com/api/v6/images/search",s);return o.default.get(i,o.default.RESP_TYPE.JSON).then((t=>{if(!t.response.hasOwnProperty("_type"))throw new r.InvalidServerResponseError(i,status,`Not a valid Bing response: ${JSON.stringify(t.response)}`);if("ErrorResponse"===t.response._type){var a=t.response;throw new r.BingServerError(e,t.status,a)}if("Images"!==t.response._type)throw new r.InvalidServerResponseError(i,status,`Did not receive an image search response, potentially malformed query ${JSON.stringify(t.response)}`);return t.response}))};var r=i(a(24461)),l=s(a(38637)),n=s(a(22006)),o=s(a(1876)),d="Square",c="Medium",u={ar:"ar-SA",da:"da-DK",de:"de-DE",en:"en-US",es:"es-US",fi:"fi-FI",fr:"fr-FR",it:"it-IT",ko:"ko-KR",nl:"nl-NL",pl:"pl-PL","pt-BR":"pt-BR",ru:"ru-RU",sv:"sv-SE",tr:"tr-TR","zh-CN":"zh-CN","zh-TW":"zh-TW","zh-HK":"zh-HK"}},61675:(e,t,a)=>{"use strict";var s=a(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.CatalogListItemScrollHelper=t.CollectionsContentDataSource=t.CollectionsDataSource=t.CatalogWithCollectionsDataSource=t.SingleCollectionDataSource=void 0;var i=s(a(52954)),r=s(a(89962)),l=s(a(23045));function n(e){var t=e.getData().length||0;return e.getCanLoadMore()&&o(t,e.listItemHeight)?e.loadMore().then((()=>o(e.getData().length||0,e.listItemHeight)?e.loadInitialItems():Promise.resolve(!0))):Promise.resolve(!0)}t.SingleCollectionDataSource=class{constructor(e,t,a,s){var i;(this.loading=null,this.catalog=e,this.collectionId=t,this.forCatalogManager=a,this.listItemHeight=s,t)?this.canLoadMoreCollectionItems=!(e.collections.length>0)||!!(null===(i=this.catalog.collections.get(t))||void 0===i?void 0:i.afterCursor):this.canLoadMoreAllItems=!(e.productCollection.length>0)||!!this.catalog.afterCursor}loadMore(){if(this.loading)return this.loading;if(!this.getCanLoadMore())return Promise.resolve();var e=this.collectionId;return this.loading=e?this.catalog.collections.findCollectionProducts(this.catalog.id,e,!1).then((()=>{var t;this.canLoadMoreCollectionItems=!!(null===(t=this.catalog.collections.get(e))||void 0===t?void 0:t.afterCursor),this.loading=null})):r.default.update(this.catalog.id).then((()=>{this.canLoadMoreAllItems=!!this.catalog.afterCursor,this.loading=null})),this.loading}loadInitialItems(){return n(this)}getCanLoadMore(){return this.canLoadMoreCollectionItems||this.canLoadMoreAllItems}getData(){var e,t,a=this.collectionId;a?e=(null===(t=this.catalog.collections.get(a))||void 0===t?void 0:t.productCollection.getProductModels(this.forCatalogManager))||[]:e=this.catalog.productCollection.getProductModels(this.forCatalogManager)||[];return e.map((e=>({product:e,collection:void 0})))}};t.CatalogWithCollectionsDataSource=class{constructor(e,t,a){this.loading=null,this.catalog=e,this.forCatalogManager=t,this.listItemHeight=a,this.canLoadMoreCollections=!(e.collections.length>0)||!!this.catalog.collections.afterCursor,this.canLoadMoreCatalog=!(e.productCollection.length>0)||!!this.catalog.afterCursor}loadMore(){return this.loading?this.loading:this.getCanLoadMore()?(this.canLoadMoreCollections?this.loading=this.catalog.collections.findCollectionsList(this.catalog.id,3,this.forCatalogManager).then((()=>{this.canLoadMoreCollections=!!this.catalog.collections.afterCursor,this.loading=null})):this.loading=r.default.update(this.catalog.id).then((()=>{this.canLoadMoreCatalog=!!this.catalog.afterCursor,this.loading=null})),this.loading):Promise.resolve()}loadInitialItems(){return n(this)}getCanLoadMore(){return this.canLoadMoreCollections||this.canLoadMoreCatalog}getData(){var e=this.catalog.collections.getCollectionModels(this.forCatalogManager),t=e.length>0,a=e.reduce(((e=[],t)=>{e.push({collection:t,product:void 0});var a=t.productCollection.getProductModels(this.forCatalogManager)||[];return a.length>3&&(a.length=3),e.push(...a.map((e=>({product:e,collection:t})))),e}),[]);if(this.canLoadMoreCollections)return a;t&&a.push({allItems:{totalItemsCount:a.length}});var s=this.catalog.productCollection.getProductModels(this.forCatalogManager).map((e=>({product:e,collection:void 0})));return t&&s.length>3&&(s.length=3),a.push(...s),a}};t.CollectionsDataSource=class{constructor(e,t,a){this.loading=null,this.canLoadMoreCollections=!0,this.catalog=e,this.forCatalogManager=t,this.listItemHeight=a}loadMore(){return this.loading?this.loading:this.getCanLoadMore()?(this.canLoadMoreCollections&&(this.loading=this.catalog.collections.findCollectionsList(this.catalog.id,3,this.forCatalogManager).then((()=>{this.canLoadMoreCollections=!!this.catalog.collections.afterCursor,this.loading=null}))),this.loading||Promise.resolve()):Promise.resolve()}loadInitialItems(){return n(this)}getCanLoadMore(){return this.canLoadMoreCollections}getData(){return this.catalog.collections.getCollectionModels(this.forCatalogManager).map((e=>({collection:e,product:void 0})))}};function o(e,t){return e*t<window.innerHeight}t.CollectionsContentDataSource=class{constructor(e,t,a){this.loading=null,this.canLoadMore=!0,this.catalog=e,this.catalog.stale=!0,this.catalog.markProductCollectionOld(),this.catalog.productCollection.reset(),this.listItemHeight=t,this.collectionId=a}loadMore(){return this.loading?this.loading:this.getCanLoadMore()?(this.canLoadMore&&(this.collectionId?this.loading=r.default.findCollectionMembership(this.catalog.id,this.collectionId).then((()=>{this.canLoadMore=!!this.catalog.afterCursor,this.loading=null})):this.loading=r.default.update(this.catalog.id).then((()=>{this.canLoadMore=!!this.catalog.afterCursor,this.loading=null}))),this.loading||Promise.resolve()):Promise.resolve()}loadInitialItems(){return n(this)}getCanLoadMore(){return this.canLoadMore}getData(){return this.catalog.productCollection.getProductModels(!0).map((e=>({product:e,collection:void 0})))}};t.CatalogListItemScrollHelper=class{constructor(e){this.dataSource=e}isScrollAtBottom(e){return e.scrollTop+l.default.SCROLL_FUDGE>=e.scrollHeight-e.clientHeight}willLoadMore(e){return Boolean(this.dataSource.loading||this.isScrollAtBottom(e))}onScroll(e,t){var a=this;return(0,i.default)((function*(){return a.dataSource.loading?(yield a.dataSource.loading,!0):!!a.isScrollAtBottom(t)&&(yield a.dataSource.loadMore(),!0)}))()}}},87295:(e,t,a)=>{"use strict";var s=a(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return _.apply(this,arguments)};var i=s(a(52954)),r=a(76549),l=a(49244),n=a(53),o=a(85871),d=a(66239),c=a(76604),u=s(a(26625)),h=a(48324);var p=/^([17]|2[07]|3[0123469]|4[013456789]|5[12345678]|6[0123456]|8[1246]|9[0123458]|\d{3})\d*?(\d{4,6})$/;function f(e){var t=p.exec(function(e){return e.user.split("@")[0]}(e));return l.Binary.build(t?t[1]+t[2]:e.toString()).readByteArray()}function m(e,t){return`00000${256*e.getUint32(t,!1)+e.getUint8(t+4)}`.slice(-5)}function v(e,t){for(var a=Promise.resolve(l.Binary.build(0,0,t,e).readByteArray()),s=0;s<5200;s++)a=a.then((e=>self.crypto.subtle.digest({name:"SHA-512"},l.Binary.build(e,t).readByteArray())));return a.then((e=>{var t=new DataView(e instanceof ArrayBuffer?e.slice(0,30):e.slice(0,30).buffer);return[m(t,0),m(t,5),m(t,10),m(t,15),m(t,20),m(t,25)].join("")}))}function g(e,t,a,s){return Promise.all([v(e,t),v(a,s)]).then((e=>e.sort().join("")))}function E(e,t,a,s){var i=new l.Binary;return(0,r.encodeProto)(o.CombinedFingerprintSpec,{version:0,localFingerprint:{publicKey:t,identifier:e},remoteFingerprint:{publicKey:s,identifier:a}},i),i.readBuffer()}function _(){return(_=(0,i.default)((function*(e){var t=(0,d.assertGetMe)(),a=yield(0,n.getFanOutList)([e,t]);try{yield(0,c.ensureE2ESessions)(a)}catch(e){__LOG__(4,void 0,new Error)`ensureE2ESessions with error`}var s=[],i=[];a.forEach((e=>{e.user===t.user?i.push(e):s.push(e)}));try{var r=yield(0,h.getAllIdentityKeysBytes)(s),l=yield(0,h.getAllIdentityKeysBytes)(i),o=yield u.default.getIdentityKeyPair();if(!o)return __LOG__(3)`getIdentityVerificationData: missing identity for device verification`,null;l.push(new Uint8Array(o.pubKey));var p=(0,h.identityKeysToBinary)(l),m=(0,h.identityKeysToBinary)(r),v=f((0,d.getMeUser)()),_=f(e),C=yield Promise.all([g(v,p,_,m),E(v,p,_,m)]);if(null==C)return null;var[S,y]=C;return{binary:y,string:S}}catch(e){return __LOG__(3)`getIdentityVerificationData: error ${e} when trying to generate identtiy QR code`,null}}))).apply(this,arguments)}},6909:(e,t,a)=>{"use strict";var s=a(93291),i=a(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,n.promiseLoop)((function(t,a,s){var i=(0,l.delayMs)(o.expBackoff(s,6e4,void 0,.1));return(c.default.state===c.STATE.CONNECTED?Promise.resolve():(0,d.default)(c.default,"change:state",(0,r.default)({state:c.STATE.CONNECTED}))).then((()=>e())).then((e=>{if(e.status>=500&&e.status<600)return i;t(e)})).catch((()=>i))}))};var r=i(a(45126)),l=a(60266),n=a(13275),o=s(a(56179)),d=i(a(57568)),c=s(a(15934))},75976:(e,t,a)=>{"use strict";var s=a(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.getTosUrl=function(){return`${r}?lg=${i.default.getLocale()}`},t.TOS_BASE_URL=void 0;var i=s(a(38637)),r="https://www.whatsapp.com/legal/";t.TOS_BASE_URL=r},25041:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.validateURL=t.validateEmail=t.EMAIL_REGEX=void 0;var s=a(22006),i=new RegExp(/^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?/);t.EMAIL_REGEX=i;t.validateEmail=e=>!e||i.test(e);t.validateURL=e=>!e||s.URL_REGEX.test(e)},48520:(e,t,a)=>{e.exports=a.p+"img/animated-doodle_600127bdb5f7627ede5cd4ef320f55b0.png"},46136:(e,t,a)=>{"use strict";a.r(t),t.default={editMain:"vjKv2",dayMain:"_15mES",timeWrapper:"dguG_",hoursAnd:"_3dPdV",hoursMain:"_2NSEj",dayCheckbox:"_1Aerz",dayInfo:"_2x2dz",dayInfoText:"_1KeFW"}},97670:(e,t,a)=>{"use strict";a.r(t),t.default={editMain:"_3Qb6s",list:"_2si2K",rowMain:"_26RZv",rowCheckbox:"NJmYi",rowLabel:"_3OhaG",disabled:"jUzEE",loadingSpinner:"VQPkV",searchBackground:"_12X4T"}},62894:(e,t,a)=>{"use strict";a.r(t),t.default={businessHoursDayColumn:"_25R4l",businessHoursTimeColumn:"AeuSd",businessHoursSection:"_2vxS9",businessHoursTime:"_2Q3U2",addAnotherWebsite:"_29WX8",businessMap:"_2BBxS",mapOverlay:"_3anF1",overlayHint:"_3mc7J",infoText:"_1l-wf",verifiedNameIcon:"_2iRAs",noPaddingTop:"_3mdN0"}},3151:(e,t,a)=>{"use strict";a.r(t),t.default={loadingSpinner:"_3_LJF",retryButton:"Dv7KR"}},22154:(e,t,a)=>{"use strict";a.r(t),t.default={editPencil:"_1biL_",section:"_3QTDK",smallMargin:"_27tBZ",noMargin:"_2ZYRM",sectionPrimaryIcon:"_2sLc3",fieldPrimaryIcon:"_1WFhm",sectionMain:"_1OjMK",sectionContainerMain:"_24N7r",sectionEditIcon:"_1eZDQ",sectionEmptyText:"_1HLYu",hidden:"_161F8"}},65829:(e,t,a)=>{"use strict";a.r(t),t.default={info:"_1k5TZ",footer:"_2OYeg",emptyCartContainer:"_17Y1T",emptyCardHeader:"_24A2t",emptyCardText:"Btu3u",btnSend:"_1-wPf",cartMessage:"_2i_Nv"}},8641:(e,t,a)=>{"use strict";a.r(t),t.default={price:"_9FX4I",actions:"_14mQB",deleteIcon:"_3b98f",cartListItem:"_2vZhq"}},31720:(e,t,a)=>{"use strict";a.r(t),t.default={select:"_1BLB1"}},45356:(e,t,a)=>{"use strict";a.r(t),t.default={deleteIcon:"txTZq"}},39287:(e,t,a)=>{"use strict";a.r(t),t.default={title:"_2rWf8"}},90720:(e,t,a)=>{"use strict";a.r(t),t.default={notifyName:"_3DxUF"}},85686:(e,t,a)=>{"use strict";a.r(t),t.default={title:"_1cm8S",text:"H8Vqa",icon:"_2xOjk"}},3941:(e,t,a)=>{"use strict";a.r(t),t.default={header:"_3LFqd"}},20189:(e,t,a)=>{"use strict";a.r(t),t.default={container:"S4Hn7",border:"_q8lV",square:"_2EGHe",avatar:"OsBqD",count:"_28NYS",two:"_3WQB6",first:"gdAG9",second:"_3d3oA",three:"_2BRRW",third:"_1FrNI",four:"_3PjHn",fourth:"f5wLF"}},92098:(e,t,a)=>{"use strict";a.r(t),t.default={overlay:"_2qsE7",icon:"_27U5d",text:"nmH4D"}},66262:(e,t,a)=>{"use strict";a.r(t),t.default={container:"_1uUXN",hasPrefixIcon:"_3cM62",hasPostfixIcon:"_32ha8",content:"qaJse",icon:"_2Zc1j",prefixIcon:"_2VCWi",paddedIcon:"n6QZF"}},68097:(e,t,a)=>{"use strict";a.r(t),t.default={download_button:"_3JT_H",downloadButton:"_3JT_H"}},39116:(e,t,a)=>{"use strict";a.r(t),t.default={imageGallery:"_1U5md",imageGalleryList:"l_VtG",imageGalleryItem:"_12qtg",imageGalleryItemSpacer:"R73_m",imageGalleryItemImage:"_1mRcT",imageGalleryItemOverlay:"sc7G4",selected:"_1WBa-",imageGalleryFooter:"XaD1V",focusAnimation:"jUylA",focusAnimationKeyframes:"_1pZl3"}},52425:(e,t,a)=>{"use strict";a.r(t),t.default={inputEmoji:"_3PaJo",wrapper:"UQ0S6",textInput:"_1cBR9",labelText:"vEql6",clearInput:"_1Ca_b",float:"vQLTL",textActive:"hRqfV",suggestionsPositioner:"_1C_wE",suggestionsContainer:"_5HL_Q",charCounter:"_2C6I2",inputControls:"_1826U",charCounterWithClearBtn:"_1SUJo",spacer:"_1EvFF",noPlaceholder:"SXaKj",buttonContainer:"_25gwF",active:"_2Gqfb"}},26561:(e,t,a)=>{"use strict";a.r(t),t.default={container:"_3C7q_",body:"_3s7bs"}},6889:(e,t,a)=>{"use strict";a.r(t),t.default={tabContainer:"_3uRNC",tab:"_3g5ZC",selected:"bKpUF"}},16643:(e,t,a)=>{"use strict";a.r(t),t.default={versionInfo:"_3MrMz"}},32547:(e,t,a)=>{"use strict";a.r(t),t.default={scaler:"_25_O8",scalerButton:"_34hCK"}},15081:(e,t,a)=>{"use strict";a.r(t),t.default={inputContainer:"rOjs5",label:"_4KvgT",input:"oNgw4"}},55672:(e,t,a)=>{"use strict";a.r(t),t.default={body:"_3S8qa",thumbs:"_1npKH",thumbsContainer:"pQbUf",btnSend:"_3v5V7",captionInput:"_2HlOc",mediaBody:"_3Z2cz",invalidContainer:"_1IS2b",invalidMedia:"_3L9FV",mediaWarning:"_2Pu3O",btnAdd:"_2kxXx",btnAddDisabled:"wt2bU",btnAddText:"_24DMK"}},57077:(e,t,a)=>{"use strict";a.r(t),t.default={thumb:"aaQbT",active:"sykWe",body:"_1kkeT",btnDelete:"_2n1pq",bodyDoc:"_2SOPo"}},2107:(e,t,a)=>{"use strict";a.r(t),t.default={container:"_1Ot8E",media:"_3hfOk"}},39480:(e,t,a)=>{"use strict";a.r(t),t.default={container:"_3FgGf",preview:"_3MOdd",img:"_3NgNl"}},90108:(e,t,a)=>{"use strict";a.r(t),t.default={container:"_2RZHc",media:"_192t1",document:"_3S28f",text:"_2mXNP",icon:"_1eZJL"}},85738:(e,t,a)=>{"use strict";a.r(t),t.default={container:"_2Uakc",media:"gK8jz",img:"_2ycmW",audio:"_3yz78",videoContainer:"_2buDw",spinner:"_1psbh",video:"_1knJe",staticPreview:"dElcV"}},38540:(e,t,a)=>{"use strict";a.r(t),t.default={container:"_3hHCK",preview:"_2NxJM",caption:"_1ajXw",img:"ln7Rp",imgBorder:"mjiiZ"}},25902:(e,t,a)=>{"use strict";a.r(t),t.default={btnViewOnce:"_3wOTT",noMargin:"_2amVF"}},46945:(e,t,a)=>{"use strict";a.r(t),t.default={text:"_35A8s",graphic:"_2sBUm"}},9745:(e,t,a)=>{"use strict";a.r(t),t.default={list:"_17KD8",hint:"G8Tyt",button:"_2okK_"}},6686:(e,t,a)=>{"use strict";a.r(t),t.default={container:"_2SRbM",body:"_2FNzl",captionInput:"_3Asxu",footer:"w-vaO",retakeBtn:"_1Fduz",retakeIcon:"_2VWr5",caption:"reBXK",videoContainer:"_3E2el",video:"_3htkI",btn:"x49XD",videoInactive:"t2y9M",btnSend:"_2-E7N",image:"_31rMI",snapshot:"hTWcE"}},75557:(e,t,a)=>{"use strict";a.r(t),t.default={container:"_2SmtJ",chip:"_1QPI1"}},42072:(e,t,a)=>{"use strict";a.r(t),t.default={newGroupButton:"_3kJ-9"}},92035:(e,t,a)=>{"use strict";a.r(t),t.default={icon:"_5eRqW",body:"_25W8i",spinner:"_1guTW",ack:"_38ck1",statusBlue:"_1uFsX"}},28427:(e,t,a)=>{"use strict";a.r(t),t.default={deviceInfo:"_2rRWa",deviceInfoLabel:"_2kRL6",deviceInfoCheckbox:"_1EFPt"}},89426:(e,t,a)=>{"use strict";a.r(t),t.default={container:"AO2h_",section:"maTUh",control:"_3yUUP",label:"_2xvW5",disabled:"_11L21"}},34966:(e,t,a)=>{"use strict";a.r(t),t.default={dropOverlay:"Tn0mt",dropOverlayOutline:"_2xF5H"}},90347:(e,t,a)=>{"use strict";a.r(t),t.default={btnSend:"_2F3ww",attributionLink:"_1Tyjj",mediaBody:"_165NN",attribution:"J4mRu",footer:"_1y7hs",containerBackground:"_3v45H",retake:"K-69C",retakeIcon:"_2iesF",mediaElementBase:"_1ExaQ",mediaElement:"_2AByG _1ExaQ"}},10552:(e,t,a)=>{"use strict";a.r(t),t.default={wrapper:"RdOJd",icon:"_33196",text:"z4TEC"}},16411:(e,t,a)=>{"use strict";a.r(t),t.default={linkContainer:"_3D4f-",descContainer:"_3rfWy",icon:"_2kvi3"}},72879:(e,t,a)=>{"use strict";a.r(t),t.default={confirmationText:"_39ZbM"}},62439:(e,t,a)=>{"use strict";a.r(t),t.default={title:"_2Gjk9",titleIcon:"cERCv",ack:"_2pE7P",statusBlue:"_1_MqV",forwardCount:"_2H_oO",spinner:"_28srV",list:"_17F1I",footer:"_1Fp2h"}},91512:(e,t,a)=>{"use strict";a.r(t),t.default={commentInput:"_3pEjS",search:"_33dbE",groupInfo:"_3R9Y4",onSendInvite:"Quczp"}},14748:(e,t,a)=>{"use strict";a.r(t),t.default={animation:"Hjxnk","play-ltr":"_15z4K",playLtr:"_15z4K","play-rtl":"_3anLU",playRtl:"_3anLU",versionInfo:"_3qfsf"}},76814:(e,t,a)=>{"use strict";a.r(t),t.default={container:"_332Wn",wallpaperColorCanvas:"_11i-f",wallpaperColorEmpty:"lELMX",canvasActive:"aolM7",canvasHover:"_6zJ_L"}},55126:(e,t,a)=>{"use strict";a.r(t),t.default={addLabelBtContainer:"_1QowE"}},88609:(e,t,a)=>{"use strict";a.r(t),t.default={container:"Fmeis",textContainer:"_1seX1",spinner:"ALHQF"}},84312:(e,t,a)=>{"use strict";a.r(t),t.default={container:"_289ov",list:"_2rGcd",header:"YoHdU",item:"_3M5f0",right:"WqzM1",left:"_2d2vs",close:"_2LhUr",name:"RPbwq",time:"_1ZJ7K"}},87519:(e,t,a)=>{"use strict";a.r(t),t.default={wrapper:"SuQHQ",offline:"_1jxad",circle:"_28wdD",text:"_2P6-6",notification:"NW1Lh",ended:"_2HzF3",lastUpdated:"_2j4iJ"}},49639:(e,t,a)=>{"use strict";a.r(t),t.default={wrapper:"_1BLuT",inactive:"KbVXN",offline:"AOZ0E",circle:"D1DwJ",text:"_3R3RZ",backToCenter:"WEsA4",visible:"_1z67b"}},20512:(e,t,a)=>{"use strict";a.r(t),t.default={container:"_2DorF",map:"_21r-h",authFailed:"Duwfq",loading:"_1bABc"}},58512:(e,t,a)=>{"use strict";a.r(t),t.default={container:"_1JiqF",selected:"xqVmU",glow:"_14zjN",stale:"_2v4P0",expired:"_2imMT",pin:"_3F_cn"}},36161:(e,t,a)=>{"use strict";a.r(t),t.default={list:"_24dlt",stopSharingButton:"_16OFg"}},15592:(e,t,a)=>{"use strict";a.r(t),t.default={popup:"_3FN-E",container:"X6oDG",twoLines:"Q3WnW",name:"_3ukcg",status:"DILT-",menuButton:"_2UAfE",triangle:"_1EQJ7"}},44993:(e,t,a)=>{"use strict";a.r(t),t.default={actionBtns:"_3uAdi",newLabelBtn:"_1oClF",plus:"_1Y2uH"}},59083:(e,t,a)=>{"use strict";a.r(t),t.default={mediaViewerImg:"_22uMp",cropOverlay:"_1iJB8"}},7635:(e,t,a)=>{"use strict";a.r(t),t.default={nextButton:"-h5qP",section:"_3VPFA",label:"NEPQf",control:"_3Ro22"}},3349:(e,t,a)=>{"use strict";a.r(t),t.default={spinner:"_1h0YE",search:"_3tEPr",inputarea:"_38sK8",inputLine:"_3G4NF",contacts:"_1ffi5",drawerSection:"_1Ze8s",inputareaSizer:"_1cZ7Z"}},58464:(e,t,a)=>{"use strict";a.r(t),t.default={photoPickerWrapper:"_3ABdz",scale:"IqBCc",nameWrapper:"_2uds3","well-animation":"MxroG",wellAnimation:"MxroG",phoneIcon:"_32Ory",phoneField:"_394ZX",infoText:"_3ulTI"}},37788:(e,t,a)=>{"use strict";a.r(t),t.default={icon:"KIC9M",iconLock:"_2WEdY",text:"_1TPg1",controls:"_2w4OZ",checkbox:"_3fAiR",header:"Mzy--"}},10266:(e,t,a)=>{"use strict";a.r(t),t.default={more:"_2-RNR",hotKeyWraper:"_1gcuq"}},17857:(e,t,a)=>{"use strict";a.r(t),t.default={body:"_2WQUg",vcardWrapper:"_5aqUc",btnContainer:"_3ztsL",btnPosition:"_3YdIR"}},48969:(e,t,a)=>{"use strict";a.r(t),t.default={wallpaperApplyDoodle:"oo1EB",checkboxLabel:"_2k8zU",wallpaperColorGrid:"_10jcL",wallpaperColorCanvas:"_3sW34",wallpaperDefaultTitle:"rppEK",wallpaperColorEmpty:"_13AW3",canvasHover:"ekZ0H",canvasActive:"_2RSZp",canvasDefault:"_2brEy"}},35369:(e,t,a)=>{"use strict";a.r(t),t.default={date:"rIQkf",info:"_2hSio"}},85683:(e,t,a)=>{"use strict";a.r(t),t.default={price:"_31nEQ",separator:"Os1Zf",quantity:"_3d4eP"}},30031:(e,t,a)=>{"use strict";a.r(t),t.default={list:"_3mnS-"}},84198:(e,t,a)=>{"use strict";a.r(t),t.default={collectionListItem:"C-foY",reviewStateRejected:"_2Cc2i"}},51841:(e,t,a)=>{"use strict";a.r(t),t.default={collectionIcon:"_20Mvu",iconContainer:"Zi_tj"}},20800:(e,t,a)=>{"use strict";a.r(t),t.default={loadingSpinner:"_3hr23"}},14881:(e,t,a)=>{"use strict";a.r(t),t.default={pendingBanner:"_1teKb",iconContainerPending:"fFD-m",iconContainerRejected:"f0v2E",rejectedBanner:"_2khZ9"}},76755:(e,t,a)=>{"use strict";a.r(t),t.default={nameContainer:"_22HKD",nameIcon:"tOKGU",nameEdit:"_3jiEF",listContainer:"_12EZb",footer:"_3vCh1",saveButton:"_1f-MJ",operation:"_3w9OB",spinner:"_1kX6_",isSending:"_1xUNP",container:"jniYc",loadingSpinner:"_5Nn9b"}},95190:(e,t,a)=>{"use strict";a.r(t),t.default={productWrapper:"_2uogF",drawerHeader:"_1GToa",drawerHeaderButtonContainer:"_1lvg0",deleteButtonContainer:"dKJ3S",isSending:"_3RNZn",spinner:"ihGXI",hiddenLabel:"_3u6HC",hiddenDescr:"_1T7Ca",hiddenContainer:"_2lQ87"}},72634:(e,t,a)=>{"use strict";a.r(t),t.default={addItemPlaceholder:"_2hNH0",placeholderIcon:"_1gkqm",placeholderContainer:"_1JcNK",divider:"yIA2U",isLoading:"_3LjT5",spinner:"hTNKQ"}},25331:(e,t,a)=>{"use strict";a.r(t),t.default={drawerHeader:"_3_-Qp",productName:"_3MyYf",buttonSeparator:"_1TrI_",drawerHeaderButtonContainer:"UK7LY",productWrapper:"_1XolL",businessInfoTitle:"_2B1vD"}},26926:(e,t,a)=>{"use strict";a.r(t),t.default={statusAlert:"i2Gpi",appealText:"_2tedq",appealLink:"_2NO1s",hiddenProductInfoContainer:"EOTwK",hiddenProductInfoIcon:"_1kTCc",hiddenProductInfoText:"_2qaDR"}},58669:(e,t,a)=>{"use strict";a.r(t),t.default={panel:"_2QaL3",tileContainer:"fzUHY",imageTile:"_32YMy",imageThumb:"_1XE56",btnDelete:"_19moj",deleteIcon:"_3xLeM",btnAdd:"_5boY5",btnAddContainer:"_3swA4",btnAddText:"_16e26",errorMessage:"_1rWFc"}},64278:(e,t,a)=>{"use strict";a.r(t),t.default={list:"_34ACe",noSections:"_2SOcG"}},10413:(e,t,a)=>{"use strict";a.r(t),t.default={title:"zmsbA"}},82841:(e,t,a)=>{"use strict";a.r(t),t.default={disabled:"_1agfk",title:"_1TDGA"}},97216:(e,t,a)=>{"use strict";a.r(t),t.default={dimmed:"RJsro"}},49670:(e,t,a)=>{"use strict";a.r(t),t.default={textThumb:"_1iiZH",thumbSizeSmall:"cimJr",thumbSizeLarge:"_2-NzF",statusImage:"CYQuD",statusImageFallbackBackground:"_3-nnR",container:"_16lEZ",thumbContainer:"_3duy3"}}}]);