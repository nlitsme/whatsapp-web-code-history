/*! Copyright (c) 2021 WhatsApp Inc. All Rights Reserved. */(()=>{var __webpack_modules__={88610:e=>{"use strict";e.exports=JSON.parse("[65,26,32,26,73,1,11,1,5,1,6,23,24,31,32,449,451,7,21,2,16,5,14,1,130,4,6,2,4,4,5,1,7,1,2,3,4,1,2,20,21,83,84,140,147,166,167,38,40,49,55,-1,46,-1,2,-1,3,-1,3,-1,2,-56,64,-1,3,-1,2,-1,14,-48,82,-3,4,-101,116,-2,9,-2,12,-23,24,-30,57,-91,102,-58,67,-2,6,-3,4,-24,28,-1,10,-1,4,-1,6,-43,46,-119,167,55,56,1,2,4,12,4,5,3,10,10,12,29,30,2,3,8,10,2,4,22,23,7,8,1,4,4,7,4,10,2,4,2,3,1,9,1,5,2,3,3,7,12,14,7,8,2,7,1,2,6,10,2,4,22,23,7,8,2,3,2,3,2,6,3,27,4,5,1,8,10,12,3,4,1,13,1,2,9,10,3,4,22,23,7,8,2,3,5,8,4,12,1,2,2,5,1,16,2,6,11,19,1,9,2,3,8,10,2,4,22,23,7,8,2,3,5,8,2,3,1,7,2,4,2,12,1,5,2,3,3,7,18,29,1,2,6,9,3,4,4,7,2,3,1,2,2,5,2,5,3,6,12,16,2,3,2,5,3,4,3,6,1,7,1,15,13,27,3,4,8,9,3,4,23,24,16,19,1,4,4,23,3,8,2,6,10,17,1,8,2,3,11,12,3,4,23,24,10,11,5,8,8,9,3,4,2,11,2,9,1,2,2,6,10,11,2,17,11,12,3,4,41,43,4,9,3,4,3,4,2,6,14,18,26,28,2,3,18,21,24,25,9,10,1,3,7,15,3,9,8,14,10,12,3,15,48,49,2,14,7,15,13,50,2,3,1,2,5,6,24,25,1,2,10,11,2,11,1,3,5,6,1,10,10,12,4,36,24,26,27,28,1,2,1,6,10,11,36,54,1,6,1,3,5,54,8,9,6,7,13,50,45,49,1,7,1,3,2,4,25,27,4,7,16,20,13,14,2,4,6,7,15,16,40,41,1,6,1,3,377,378,4,6,7,8,1,2,4,6,41,42,4,6,33,34,4,6,7,8,1,2,4,6,15,16,57,58,4,6,67,72,29,32,16,32,86,88,6,9,639,640,26,31,89,96,13,14,4,18,18,21,2,11,18,32,13,14,3,18,52,54,1,8,8,9,2,13,7,8,1,4,10,48,10,16,89,96,5,7,34,35,1,6,70,80,31,35,4,6,3,7,2,3,6,19,40,42,5,16,44,48,26,32,11,48,23,25,2,5,56,57,1,10,1,2,2,10,6,19,10,16,10,16,14,100,48,49,1,6,1,2,5,6,9,13,27,36,9,14,32,36,2,4,1,4,56,57,1,3,3,4,1,4,2,10,48,56,2,7,15,18,60,67,43,45,11,22,1,14,1,8,4,5,6,7,3,5,1,6,192,256,278,280,6,8,38,40,6,8,8,9,1,2,1,2,1,2,31,33,53,54,7,8,1,4,3,4,7,10,4,6,6,10,13,18,3,4,7,24,1,1,-1,98,1,14,1,17,13,114,1,5,1,3,10,11,1,4,5,11,1,2,1,2,1,2,4,5,11,13,4,9,5,9,2,18,41,470,69,95,1,263,78,528,1,340,256,1024,47,48,47,48,133,139,4,7,2,14,38,39,1,6,1,3,56,63,2,17,23,32,7,8,7,8,7,8,7,8,7,8,7,8,7,8,7,557,3,28,9,13,2,3,5,7,5,9,86,92,3,4,90,91,4,9,43,44,94,95,48,96,45,48,48,64,28,31,50,65,12,16,167,171,99,101,31,32,6592,6656,20989,20992,1165,1232,317,320,28,48,47,64,30,32,80,82,6,48,102,103,55,57,9,51,13,14,3,4,4,5,25,27,1,9,8,16,52,64,68,78,12,36,13,14,38,46,25,36,2,13,30,36,48,49,2,6,2,4,16,17,11,15,7,8,25,26,41,47,2,4,2,13,3,4,8,9,1,3,10,12,32,33,51,52,1,4,2,4,5,7,1,2,1,25,17,19,8,19,6,8,6,8,6,15,7,8,7,8,58,64,117,118,2,3,4,7,10,16,11172,11184,23,27,49,2101,6766,6768,106,144,7,19,5,10,-1,2,-10,11,-532,534,-144,176,-13,14,-2,114,-143,177,26,32,26,37,89,92,6,8,6,8,6,8,3,38,12,13,26,27,19,20,2,3,15,17,14,48,123,128,1,2,1,5,45,48,9,86,2,67,45,176,29,32,49,96,36,45,30,35,38,48,30,31,37,41,14,56,158,160,10,16,36,40,36,40,40,48,52,63,1,145,311,320,22,32,8,160,-287,288,-225,228,-1,3,-5,9,-40,43,-4,5,-165,167,-82,89,-484,488,-8,18,-294,325,-44,46,-153,164,-175,175,1,2,54,69,7,31,10,28,49,53,2,4,7,18,1,3,25,32,10,19,36,41,1,10,18,26,35,36,3,14,52,61,10,14,2,3,16,17,20,31,18,19,28,31,2,3,1,3,6,72,7,8,1,2,4,5,15,16,11,17,47,48,3,16,10,18,2,3,8,10,2,4,22,23,7,8,2,3,5,8,3,4,4,6,2,4,3,5,1,7,1,6,7,163,56,64,2,5,1,2,21,22,1,2,3,33,51,57,1,2,4,6,1,3,4,12,10,176,50,56,4,6,1,3,27,63,51,59,2,3,1,3,4,15,10,48,43,44,1,2,2,8,1,2,1,8,10,64,27,32,2,6,1,10,16,208,47,56,1,3,1,101,83,95,8,10,1,3,8,9,2,3,30,31,2,6,1,2,4,5,3,12,10,80,8,10,42,50,4,5,4,31,1,7,2,4,40,46,2,6,8,17,1,7,2,5,46,59,1,3,9,38,57,320,9,10,38,52,8,18,29,32,32,57,1,8,1,3,1,76,7,8,2,3,38,59,1,10,10,16,6,7,2,3,37,41,2,3,1,2,1,8,10,320,19,21,4,187,1,16,21,63,923,1025,111,112,5,16,196,2944,1071,1072,9,4048,583,9216,569,576,31,32,10,14,2,98,30,37,1,11,48,55,15,25,10,11,7,8,21,26,19,707,91,192,75,80,56,67,13,77,2,3,1,13,2,16,6136,6144,1238,1280,9,8960,287,336,3,20,4,12,396,2704,107,112,13,16,9,16,10,12,1,3,1,4961,246,256,39,41,62,65,9,25,2,9,30,34,59,306,20,128,25,160,85,86,71,72,2,4,1,3,2,4,4,5,12,13,1,2,7,8,65,66,4,6,8,9,7,8,28,29,4,5,5,6,1,4,7,8,340,342,51,52,57,58,57,58,57,58,57,58,8,60,512,567,4,54,8,9,14,15,7,1659,45,55,7,9,10,14,2,370,44,48,10,1296,-208,215,-109,116,-1445,1447,-270,542,31,32,58,64,61,118,29,42,44,48,9,16,2,3504,42718,42752,4149,4160,222,224,5762,5776,7473,10576,542,2048,4939,786432,65534,65536,65534]")},16290:(e,t,r)=>{var a={"./f00.png":86148,"./f01.png":39830,"./f02.png":14871,"./f03.png":13733,"./f04.png":11921,"./f05.png":99100,"./f06.png":75717,"./f07.png":58163,"./f08.png":80768,"./f09.png":7271,"./f10.png":65498,"./f11.png":70461,"./f12.png":60704,"./f13.png":98796,"./f14.png":24036,"./f15.png":7658,"./f16.png":36722,"./f17.png":23918,"./f18.png":9292,"./f19.png":15210,"./f20.png":8715,"./f21.png":50309,"./f22.png":95977,"./f23.png":77882,"./f24.png":95220,"./f25.png":44876,"./f26.png":62976,"./f27.png":97824,"./f28.png":41153,"./f29.png":43132,"./f30.png":56788,"./f31.png":88193,"./f32.png":68088,"./f33.png":34577,"./f34.png":89374,"./f35.png":71207,"./f36.png":17809,"./f37.png":48105,"./f38.png":53184,"./f39.png":32540,"./f40.png":64303,"./f41.png":27885,"./f42.png":54196,"./f43.png":69034,"./f44.png":98754,"./f45.png":47050,"./f46.png":64690,"./f47.png":1788,"./f48.png":52341,"./f49.png":66470,"./f50.png":66793,"./f51.png":10644,"./f52.png":8388,"./f53.png":29959,"./f54.png":77612,"./f55.png":2108,"./f56.png":18942,"./f57.png":16583,"./f58.png":79024,"./f59.png":2176,"./f60.png":80669,"./f61.png":14939,"./f62.png":7045,"./f63.png":4878,"./f64.png":62663,"./f65.png":34141,"./f66.png":1453,"./f67.png":48450,"./f68.png":45216,"./f69.png":46839,"./f70.png":89954,"./f71.png":89205,"./f72.png":47955,"./f73.png":18350,"./f74.png":84603,"./f75.png":34274,"./f76.png":22717,"./f77.png":23220,"./f78.png":37769,"./f79.png":70926,"./f80.png":11674,"./f81.png":50251,"./f82.png":12627,"./f83.png":44078,"./f84.png":3280,"./f85.png":88468,"./f86.png":371,"./f87.png":79868,"./f88.png":77242,"./f89.png":8768,"./f90.png":22708,"./f91.png":35308,"./f92.png":65820,"./f93.png":91220,"./f94.png":75585,"./f95.png":54895,"./f96.png":92199,"./f97.png":72426,"./f98.png":30002,"./f99.png":66365,"./favicon-error.png":33126,"./favicon-error2.png":99289,"./favicon.png":75233};function n(e){var t=i(e);return r(t)}function i(e){if(!r.o(a,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return a[e]}n.keys=function(){return Object.keys(a)},n.resolve=i,e.exports=n,n.id=16290},8893:(e,t,r)=>{var a={"./f00.png":28004,"./f01.png":53470,"./f02.png":86319,"./f03.png":84796,"./f04.png":86270,"./f05.png":8021,"./f06.png":76007,"./f07.png":68946,"./f08.png":27610,"./f09.png":51680,"./f10.png":24263,"./f11.png":70791,"./f12.png":42115,"./f13.png":52140,"./f14.png":12552,"./f15.png":40647,"./f16.png":94262,"./f17.png":44834,"./f18.png":6989,"./f19.png":43185,"./f20.png":81079,"./f21.png":32418,"./f22.png":73547,"./f23.png":90487,"./f24.png":29547,"./f25.png":56193,"./f26.png":42216,"./f27.png":20390,"./f28.png":79843,"./f29.png":36277,"./f30.png":20801,"./f31.png":95368,"./f32.png":13756,"./f33.png":86106,"./f34.png":42977,"./f35.png":8332,"./f36.png":27984,"./f37.png":83195,"./f38.png":15241,"./f39.png":59286,"./f40.png":84608,"./f41.png":48636,"./f42.png":32956,"./f43.png":62911,"./f44.png":56025,"./f45.png":50683,"./f46.png":62274,"./f47.png":71129,"./f48.png":83966,"./f49.png":27335,"./f50.png":20334,"./f51.png":87549,"./f52.png":48841,"./f53.png":24639,"./f54.png":2582,"./f55.png":34532,"./f56.png":95161,"./f57.png":63219,"./f58.png":82606,"./f59.png":1473,"./f60.png":80184,"./f61.png":88573,"./f62.png":79601,"./f63.png":65485,"./f64.png":10066,"./f65.png":52228,"./f66.png":15706,"./f67.png":56311,"./f68.png":9713,"./f69.png":36807,"./f70.png":16144,"./f71.png":15655,"./f72.png":84031,"./f73.png":57234,"./f74.png":92570,"./f75.png":35436,"./f76.png":87885,"./f77.png":11873,"./f78.png":11179,"./f79.png":6553,"./f80.png":14047,"./f81.png":26136,"./f82.png":26500,"./f83.png":68986,"./f84.png":43803,"./f85.png":57069,"./f86.png":39114,"./f87.png":37368,"./f88.png":50260,"./f89.png":80159,"./f90.png":4636,"./f91.png":7297,"./f92.png":88029,"./f93.png":84886,"./f94.png":42825,"./f95.png":9577,"./f96.png":54614,"./f97.png":72313,"./f98.png":36487,"./f99.png":45657,"./favicon-error.png":82193,"./favicon-error2.png":23445,"./favicon.png":31303};function n(e){var t=i(e);return r(t)}function i(e){if(!r.o(a,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return a[e]}n.keys=function(){return Object.keys(a)},n.resolve=i,e.exports=n,n.id=8893},26819:module=>{var e={},aa={},l;for(l in e)e.hasOwnProperty(l)&&(aa[l]=e[l]);function ba(e){eval.call(null,e)}for(l in e.read=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText},"undefined"!=typeof arguments&&(e.arguments=arguments),"undefined"!=typeof console?(e.print||(e.print=function(e){console.log(e)}),e.printErr||(e.printErr=function(e){console.log(e)})):e.print||(e.print=function(){}),void 0===e.setWindowTitle&&(e.setWindowTitle=function(e){document.title=e}),!e.load&&e.read&&(e.load=function(t){ba(e.read(t))}),e.print||(e.print=function(){}),e.printErr||(e.printErr=e.print),e.arguments||(e.arguments=[]),e.thisProgram||(e.thisProgram="./this.program"),e.print=e.print,e.S=e.printErr,e.preRun=[],e.postRun=[],aa)aa.hasOwnProperty(l)&&(e[l]=aa[l]);var n={cb:function(e){ca=e},Ua:function(){return ca},na:function(){return m},X:function(e){m=e},Aa:function(e){switch(e){case"i1":case"i8":return 1;case"i16":return 2;case"i32":return 4;case"i64":return 8;case"float":return 4;case"double":return 8;default:return"*"===e[e.length-1]?n.H:"i"===e[0]?(assert(0==(e=parseInt(e.substr(1)))%8),e/8):0}},Ta:function(e){return Math.max(n.Aa(e),n.H)},dd:16,Bd:function(e,t){return"double"===t||"i64"===t?7&e&&(assert(4==(7&e)),e+=4):assert(0==(3&e)),e},od:function(e,t,r){return r||"i64"!=e&&"double"!=e?e?Math.min(t||(e?n.Ta(e):0),n.H):Math.min(t,8):8},J:function(t,r,a){return a&&a.length?(a.splice||(a=Array.prototype.slice.call(a)),a.splice(0,0,r),e["dynCall_"+t].apply(null,a)):e["dynCall_"+t].call(null,r)},U:[],Ma:function(e){for(var t=0;t<n.U.length;t++)if(!n.U[t])return n.U[t]=e,2*(1+t);throw"Finished up all reserved function pointers. Use a higher value for RESERVED_FUNCTION_POINTERS."},$a:function(e){n.U[(e-2)/2]=null},M:function(t){n.M.ma||(n.M.ma={}),n.M.ma[t]||(n.M.ma[t]=1,e.S(t))},ha:{},rd:function(e,t){assert(t),n.ha[t]||(n.ha[t]={});var r=n.ha[t];return r[e]||(r[e]=function(){return n.J(t,e,arguments)}),r[e]},pd:function(){throw"You must build with -s RETAIN_COMPILER_SETTINGS=1 for Runtime.getCompilerSetting or emscripten_get_compiler_setting to work"},W:function(e){var t=m;return m=(m=m+e|0)+15&-16,t},Ia:function(e){var t=p;return p=(p=p+e|0)+15&-16,t},P:function(e){var t=v;return(e=(v=(v=v+e|0)+15&-16)>=w)&&(z("Cannot enlarge memory arrays. Either (1) compile with  -s TOTAL_MEMORY=X  with X higher than the current value "+w+", (2) compile with  -s ALLOW_MEMORY_GROWTH=1  which adjusts the size at runtime but prevents some optimizations, (3) set Module.TOTAL_MEMORY to a higher value before the program runs, or if you want malloc to return NULL (0) instead of this abort, compile with  -s ABORTING_MALLOC=0 "),e=!0),e?(v=t,0):t},ea:function(e,t){return Math.ceil(e/(t||16))*(t||16)},xd:function(e,t,r){return r?+(e>>>0)+4294967296*+(t>>>0):+(e>>>0)+4294967296*+(0|t)},La:8,H:4,ed:0};e.Runtime=n,n.addFunction=n.Ma,n.removeFunction=n.$a;var A=!1,da,fa,ca,ha,ia,buffer;function assert(e,t){e||z("Assertion failed: "+t)}function ga(a){var b=e["_"+a];if(!b)try{b=eval("_"+a)}catch(e){}return assert(b,"Cannot call unknown function "+a+" (perhaps LLVM optimizations or closure removed it?)"),b}function ma(e,t,r){switch("*"===(r=r||"i8").charAt(r.length-1)&&(r="i32"),r){case"i1":case"i8":D[e>>0]=t;break;case"i16":E[e>>1]=t;break;case"i32":F[e>>2]=t;break;case"i64":fa=[t>>>0,(da=t,1<=+na(da)?0<da?(0|oa(+pa(da/4294967296),4294967295))>>>0:~~+qa((da-+(~~da>>>0))/4294967296)>>>0:0)],F[e>>2]=fa[0],F[e+4>>2]=fa[1];break;case"float":ra[e>>2]=t;break;case"double":sa[e>>3]=t;break;default:z("invalid type for setValue: "+r)}}function ta(e,t){switch("*"===(t=t||"i8").charAt(t.length-1)&&(t="i32"),t){case"i1":case"i8":return D[e>>0];case"i16":return E[e>>1];case"i32":case"i64":return F[e>>2];case"float":return ra[e>>2];case"double":return sa[e>>3];default:z("invalid type for setValue: "+t)}return null}function G(e,t,r,a){var i,s;"number"==typeof e?(i=!0,s=e):(i=!1,s=e.length);var o,u,l="string"==typeof t?t:null;if(r=4==r?a:[ua,n.W,n.Ia,n.P][void 0===r?2:r](Math.max(s,l?1:t.length)),i){for(a=r,assert(0==(3&r)),e=r+(-4&s);a<e;a+=4)F[a>>2]=0;for(e=r+s;a<e;)D[a++>>0]=0;return r}if("i8"===l)return e.subarray||e.slice?H.set(e,r):H.set(new Uint8Array(e),r),r;for(a=0;a<s;){var d=e[a];"function"==typeof d&&(d=n.sd(d)),0===(i=l||t[a])?a++:("i64"==i&&(i="i32"),ma(r+a,d,i),u!==i&&(o=n.Aa(i),u=i),a+=o)}return r}function la(t,r){if(0===r||!t)return"";for(var a,n=0,i=0;(n|=a=H[t+i>>0],0!=a||r)&&(i++,!r||i!=r););if(r||(r=i),a="",128>n){for(;0<r;)n=String.fromCharCode.apply(String,H.subarray(t,t+Math.min(r,1024))),a=a?a+n:n,t+=1024,r-=1024;return a}return e.UTF8ToString(t)}function za(e,t){for(var r,a,n,i,s,o="";;){if(!(r=e[t++]))return o;128&r?(a=63&e[t++],192==(224&r)?o+=String.fromCharCode((31&r)<<6|a):(n=63&e[t++],224==(240&r)?r=(15&r)<<12|a<<6|n:(i=63&e[t++],240==(248&r)?r=(7&r)<<18|a<<12|n<<6|i:(s=63&e[t++],248==(252&r)?r=(3&r)<<24|a<<18|n<<12|i<<6|s:r=(1&r)<<30|a<<24|n<<18|i<<12|s<<6|63&e[t++])),65536>r?o+=String.fromCharCode(r):(r-=65536,o+=String.fromCharCode(55296|r>>10,56320|1023&r)))):o+=String.fromCharCode(r)}}function Aa(e,t,r,a){if(!(0<a))return 0;var n=r;a=r+a-1;for(var i=0;i<e.length;++i){var s=e.charCodeAt(i);if(55296<=s&&57343>=s&&(s=65536+((1023&s)<<10)|1023&e.charCodeAt(++i)),127>=s){if(r>=a)break;t[r++]=s}else{if(2047>=s){if(r+1>=a)break;t[r++]=192|s>>6}else{if(65535>=s){if(r+2>=a)break;t[r++]=224|s>>12}else{if(2097151>=s){if(r+3>=a)break;t[r++]=240|s>>18}else{if(67108863>=s){if(r+4>=a)break;t[r++]=248|s>>24}else{if(r+5>=a)break;t[r++]=252|s>>30,t[r++]=128|s>>24&63}t[r++]=128|s>>18&63}t[r++]=128|s>>12&63}t[r++]=128|s>>6&63}t[r++]=128|63&s}}return t[r]=0,r-n}function Ba(e){for(var t=0,r=0;r<e.length;++r){var a=e.charCodeAt(r);55296<=a&&57343>=a&&(a=65536+((1023&a)<<10)|1023&e.charCodeAt(++r)),127>=a?++t:t=2047>=a?t+2:65535>=a?t+3:2097151>=a?t+4:67108863>=a?t+5:t+6}return t}function Ca(t){var r=!!e.___cxa_demangle;if(r)try{var a=ua(t.length);ka(t.substr(1),a);var i=ua(4),s=e.___cxa_demangle(a,0,0,i);if(0===ta(i,"i32")&&s)return la(s)}catch(e){}finally{a&&Da(a),i&&Da(i),s&&Da(s)}var o=3,u={v:"void",b:"bool",c:"char",s:"short",i:"int",l:"long",f:"float",d:"double",w:"wchar_t",a:"signed char",h:"unsigned char",t:"unsigned short",j:"unsigned int",m:"unsigned long",x:"long long",y:"unsigned long long",z:"..."},l=[],d=!0;a=t;try{if("Object._main"==t||"_main"==t)return"main()";if("number"==typeof t&&(t=la(t)),"_"!==t[0]||"_"!==t[1]||"Z"!==t[2])return t;switch(t[3]){case"n":return"operator new()";case"d":return"operator delete()"}a=function e(r,a,n){a=a||1/0;var i,s="",c=[];if("N"===t[o]){for(o++,"K"===t[o]&&o++,i=[];"E"!==t[o];)if("S"===t[o]){o++;var f=t.indexOf("_",o);i.push(l[t.substring(o,f)||0]||"?"),o=f+1}else if("C"===t[o])i.push(i[i.length-1]),o+=2;else{var p=(f=parseInt(t.substr(o))).toString().length;if(!f||!p){o--;break}var h=t.substr(o+p,f);i.push(h),l.push(h),o+=p+f}if(o++,i=i.join("::"),0==--a)return r?[i]:i}else("K"===t[o]||d&&"L"===t[o])&&o++,(f=parseInt(t.substr(o)))&&(p=f.toString().length,i=t.substr(o+p,f),o+=p+f);d=!1,"I"===t[o]?(o++,f=e(!0),s+=(p=e(!0,1,!0))[0]+" "+i+"<"+f.join(", ")+">"):s=i;e:for(;o<t.length&&0<a--;)if(i=t[o++],i in u)c.push(u[i]);else switch(i){case"P":c.push(e(!0,1,!0)[0]+"*");break;case"R":c.push(e(!0,1,!0)[0]+"&");break;case"L":o++,f=t.indexOf("E",o)-o,c.push(t.substr(o,f)),o+=f+2;break;case"A":if(f=parseInt(t.substr(o)),o+=f.toString().length,"_"!==t[o])throw"?";o++,c.push(e(!0,1,!0)[0]+" ["+f+"]");break;case"E":break e;default:s+="?"+i;break e}return n||1!==c.length||"void"!==c[0]||(c=[]),r?(s&&c.push(s+"?"),c):s+"("+c.join(", ")+")"}()}catch(e){a+="?"}return 0<=a.indexOf("?")&&!r&&n.M("warning: a problem occurred in builtin C++ name demangling; build with  -s DEMANGLE_SUPPORT=1  to link in libcxxabi demangling"),a}function Ea(){return Fa().replace(/__Z[\w\d_]+/g,(function(e){var t=Ca(e);return e===t?e:e+" ["+t+"]"}))}function Fa(){var e=Error();if(!e.stack){try{throw Error(0)}catch(t){e=t}if(!e.stack)return"(no stack trace available)"}return e.stack.toString()}function Ga(){var e=v;return 0<e%4096&&(e+=4096-e%4096),e}(function(){function a(e){return{arguments:(e=e.toString().match(d).slice(1))[0],body:e[1],returnValue:e[2]}}var b={stackSave:function(){n.na()},stackRestore:function(){n.X()},arrayToC:function(e){var t=n.W(e.length);return ja(e,t),t},stringToC:function(e){var t=0;return null!=e&&0!==e&&ka(e,t=n.W(1+(e.length<<2))),t}},c={string:b.stringToC,array:b.arrayToC};ia=function(e,t,r,a,i){e=ga(e);var s=[],o=0;if(a)for(var u=0;u<a.length;u++){var l=c[r[u]];l?(0===o&&(o=n.na()),s[u]=l(a[u])):s[u]=a[u]}if(r=e.apply(null,s),"string"===t&&(r=la(r)),0!==o){if(i&&i.async)return void EmterpreterAsync.hd.push((function(){n.X(o)}));n.X(o)}return r};var d=/^function\s*\(([^)]*)\)\s*{\s*([^*]*?)[\s;]*(?:return\s*(.*?)[;\s]*)?}$/,f={},h;for(h in b)b.hasOwnProperty(h)&&(f[h]=a(b[h]));ha=function(b,c,d){d=d||[];var h=ga(b);b=d.every((function(e){return"number"===e}));var u="string"!==c;if(u&&b)return h;var q=d.map((function(e,t){return"$"+t}));c="(function("+q.join(",")+") {";var y=d.length;if(!b){c+="var stack = "+f.stackSave.body+";";for(var B=0;B<y;B++){var J=q[B],ea=d[B];"number"!==ea&&(ea=f[ea+"ToC"],c+="var "+ea.arguments+" = "+J+";",c+=ea.body+";",c+=J+"="+ea.returnValue+";")}}return d=a((function(){return h})).returnValue,c+="var ret = "+d+"("+q.join(",")+");",u||(d=a((function(){return la})).returnValue,c+="ret = "+d+"(ret);"),b||(c+=f.stackRestore.body.replace("()","(stack)")+";"),eval(c+"return ret})")}})(),e.ccall=ia,e.cwrap=ha,e.setValue=ma,e.getValue=ta,e.ALLOC_NORMAL=0,e.ALLOC_STACK=1,e.ALLOC_STATIC=2,e.ALLOC_DYNAMIC=3,e.ALLOC_NONE=4,e.allocate=G,e.getMemory=function(e){return va?void 0!==wa&&!wa.C||!xa?n.P(e):ua(e):n.Ia(e)},e.Pointer_stringify=la,e.AsciiToString=function(e){for(var t="";;){var r=D[e++>>0];if(!r)return t;t+=String.fromCharCode(r)}},e.stringToAscii=function(e,t){return ya(e,t,!1)},e.UTF8ArrayToString=za,e.UTF8ToString=function(e){return za(H,e)},e.stringToUTF8Array=Aa,e.stringToUTF8=function(e,t,r){return Aa(e,H,t,r)},e.lengthBytesUTF8=Ba,e.UTF16ToString=function(e){for(var t=0,r="";;){var a=E[e+2*t>>1];if(0==a)return r;++t,r+=String.fromCharCode(a)}},e.stringToUTF16=function(e,t,r){if(void 0===r&&(r=2147483647),2>r)return 0;var a=t;r=(r-=2)<2*e.length?r/2:e.length;for(var n=0;n<r;++n)E[t>>1]=e.charCodeAt(n),t+=2;return E[t>>1]=0,t-a},e.lengthBytesUTF16=function(e){return 2*e.length},e.UTF32ToString=function(e){for(var t=0,r="";;){var a=F[e+4*t>>2];if(0==a)return r;++t,65536<=a?(a-=65536,r+=String.fromCharCode(55296|a>>10,56320|1023&a)):r+=String.fromCharCode(a)}},e.stringToUTF32=function(e,t,r){if(void 0===r&&(r=2147483647),4>r)return 0;var a=t;r=a+r-4;for(var n=0;n<e.length;++n){if(55296<=(i=e.charCodeAt(n))&&57343>=i)var i=65536+((1023&i)<<10)|1023&e.charCodeAt(++n);if(F[t>>2]=i,(t+=4)+4>r)break}return F[t>>2]=0,t-a},e.lengthBytesUTF32=function(e){for(var t=0,r=0;r<e.length;++r){var a=e.charCodeAt(r);55296<=a&&57343>=a&&++r,t+=4}return t},e.stackTrace=function(){return Ea()};for(var D,H,E,Ha,F,Ia,ra,sa,Ja=0,p=0,va=!1,Ka=0,m=0,La=0,Ma=0,v=0,Na=e.TOTAL_STACK||5242880,w=e.TOTAL_MEMORY||16777216,I=65536;I<w||I<2*Na;)I=16777216>I?2*I:I+16777216;function Oa(e){for(;0<e.length;){var t=e.shift();if("function"==typeof t)t();else{var r=t.Qa;"number"==typeof r?void 0===t.T?n.J("v",r):n.J("vi",r,[t.T]):r(void 0===t.T?null:t.T)}}}I!==w&&(w=I),assert("undefined"!=typeof Int32Array&&"undefined"!=typeof Float64Array&&!!new Int32Array(1).subarray&&!!new Int32Array(1).set,"JS engine does not provide full typed array support"),buffer=new ArrayBuffer(w),D=new Int8Array(buffer),E=new Int16Array(buffer),F=new Int32Array(buffer),H=new Uint8Array(buffer),Ha=new Uint16Array(buffer),Ia=new Uint32Array(buffer),ra=new Float32Array(buffer),sa=new Float64Array(buffer),F[0]=255,assert(255===H[0]&&0===H[3],"Typed arrays 2 must be run on a little-endian system"),e.HEAP=void 0,e.buffer=buffer,e.HEAP8=D,e.HEAP16=E,e.HEAP32=F,e.HEAPU8=H,e.HEAPU16=Ha,e.HEAPU32=Ia,e.HEAPF32=ra,e.HEAPF64=sa;var Pa=[],Qa=[],Ra=[],K=[],Sa=[],xa=!1;function Ta(e){Pa.unshift(e)}function Ua(e){Sa.unshift(e)}function Va(e,t,r){return e=Aa(e,r=Array(0<r?r:Ba(e)+1),0,r.length),t&&(r.length=e),r}function ka(e,t,r){for(e=Va(e,r),r=0;r<e.length;)D[t+r>>0]=e[r],r+=1}function ja(e,t){for(var r=0;r<e.length;r++)D[t++>>0]=e[r]}function ya(e,t,r){for(var a=0;a<e.length;++a)D[t++>>0]=e.charCodeAt(a);r||(D[t>>0]=0)}e.addOnPreRun=Ta,e.addOnInit=function(e){Qa.unshift(e)},e.addOnPreMain=function(e){Ra.unshift(e)},e.addOnExit=function(e){K.unshift(e)},e.addOnPostRun=Ua,e.intArrayFromString=Va,e.intArrayToString=function(e){for(var t=[],r=0;r<e.length;r++){var a=e[r];255<a&&(a&=255),t.push(String.fromCharCode(a))}return t.join("")},e.writeStringToMemory=ka,e.writeArrayToMemory=ja,e.writeAsciiToMemory=ya,Math.imul&&-5===Math.imul(4294967295,5)||(Math.imul=function(e,t){var r=65535&e,a=65535&t;return r*a+((e>>>16)*a+r*(t>>>16)<<16)|0}),Math.td=Math.imul,Math.clz32||(Math.clz32=function(e){e>>>=0;for(var t=0;32>t;t++)if(e&1<<31-t)return t;return 32}),Math.kd=Math.clz32;var na=Math.abs,qa=Math.ceil,pa=Math.floor,oa=Math.min,L=0,Wa=null,Xa=null;function Ya(){L++,e.monitorRunDependencies&&e.monitorRunDependencies(L)}function Za(){if(L--,e.monitorRunDependencies&&e.monitorRunDependencies(L),0==L&&(null!==Wa&&(clearInterval(Wa),Wa=null),Xa)){var t=Xa;Xa=null,t()}}e.addRunDependency=Ya,e.removeRunDependency=Za,e.preloadedImages={},e.preloadedAudios={},Ja=8,p=Ja+1696,Qa.push(),G([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,60,0,0,0,0,0,0,0,5,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,2,0,0,0,164,2,0,0,0,4,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,10,255,255,255,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"i8",4,n.La);var $a=n.ea(G(12,"i8",2),8);function eb(e,t){K.push((function(){n.J("vi",e,[t])})),eb.level=K.length}assert(0==$a%8),e._bitshift64Ashr=ab,e._i64Subtract=bb,e._i64Add=cb,e._memset=db,e._bitshift64Lshr=fb,e._bitshift64Shl=gb;var M={G:1,B:2,Qc:3,Nb:4,F:5,sa:6,gb:7,kc:8,Z:9,ub:10,oa:11,$c:11,Ka:12,Y:13,Gb:14,wc:15,$:16,pa:17,ad:18,ba:19,qa:20,N:21,u:22,fc:23,Ja:24,O:25,Xc:26,Hb:27,sc:28,da:29,Nc:30,Zb:31,Gc:32,Db:33,Kc:34,oc:42,Kb:43,vb:44,Qb:45,Rb:46,Sb:47,Yb:48,Yc:49,ic:50,Pb:51,Ab:35,lc:37,mb:52,pb:53,bd:54,gc:55,qb:56,rb:57,Bb:35,sb:59,uc:60,jc:61,Uc:62,tc:63,pc:64,qc:65,Mc:66,mc:67,jb:68,Rc:69,wb:70,Hc:71,ac:72,Eb:73,ob:74,Bc:76,nb:77,Lc:78,Tb:79,Ub:80,Xb:81,Wb:82,Vb:83,vc:38,ra:39,bc:36,aa:40,Cc:95,Fc:96,zb:104,hc:105,kb:97,Jc:91,zc:88,rc:92,Oc:108,yb:111,hb:98,xb:103,ec:101,cc:100,Vc:110,Ib:112,Jb:113,Mb:115,lb:114,Cb:89,$b:90,Ic:93,Pc:94,ib:99,dc:102,Ob:106,xc:107,Wc:109,Zc:87,Fb:122,Sc:116,Ac:95,nc:123,Lb:84,Dc:75,tb:125,yc:131,Ec:130,Tc:86},hb={0:"Success",1:"Not super-user",2:"No such file or directory",3:"No such process",4:"Interrupted system call",5:"I/O error",6:"No such device or address",7:"Arg list too long",8:"Exec format error",9:"Bad file number",10:"No children",11:"No more processes",12:"Not enough core",13:"Permission denied",14:"Bad address",15:"Block device required",16:"Mount device busy",17:"File exists",18:"Cross-device link",19:"No such device",20:"Not a directory",21:"Is a directory",22:"Invalid argument",23:"Too many open files in system",24:"Too many open files",25:"Not a typewriter",26:"Text file busy",27:"File too large",28:"No space left on device",29:"Illegal seek",30:"Read only file system",31:"Too many links",32:"Broken pipe",33:"Math arg out of domain of func",34:"Math result not representable",35:"File locking deadlock error",36:"File or path name too long",37:"No record locks available",38:"Function not implemented",39:"Directory not empty",40:"Too many symbolic links",42:"No message of desired type",43:"Identifier removed",44:"Channel number out of range",45:"Level 2 not synchronized",46:"Level 3 halted",47:"Level 3 reset",48:"Link number out of range",49:"Protocol driver not attached",50:"No CSI structure available",51:"Level 2 halted",52:"Invalid exchange",53:"Invalid request descriptor",54:"Exchange full",55:"No anode",56:"Invalid request code",57:"Invalid slot",59:"Bad font file fmt",60:"Device not a stream",61:"No data (for no delay io)",62:"Timer expired",63:"Out of streams resources",64:"Machine is not on the network",65:"Package not installed",66:"The object is remote",67:"The link has been severed",68:"Advertise error",69:"Srmount error",70:"Communication error on send",71:"Protocol error",72:"Multihop attempted",73:"Cross mount point (not really error)",74:"Trying to read unreadable message",75:"Value too large for defined data type",76:"Given log. name not unique",77:"f.d. invalid for this operation",78:"Remote address changed",79:"Can   access a needed shared lib",80:"Accessing a corrupted shared lib",81:".lib section in a.out corrupted",82:"Attempting to link in too many libs",83:"Attempting to exec a shared library",84:"Illegal byte sequence",86:"Streams pipe error",87:"Too many users",88:"Socket operation on non-socket",89:"Destination address required",90:"Message too long",91:"Protocol wrong type for socket",92:"Protocol not available",93:"Unknown protocol",94:"Socket type not supported",95:"Not supported",96:"Protocol family not supported",97:"Address family not supported by protocol family",98:"Address already in use",99:"Address not available",100:"Network interface is not configured",101:"Network is unreachable",102:"Connection reset by network",103:"Connection aborted",104:"Connection reset by peer",105:"No buffer space available",106:"Socket is already connected",107:"Socket is not connected",108:"Can't send after socket shutdown",109:"Too many references",110:"Connection timed out",111:"Connection refused",112:"Host is down",113:"Host is unreachable",114:"Socket already connected",115:"Connection already in progress",116:"Stale file handle",122:"Quota exceeded",123:"No medium (in tape drive)",125:"Operation canceled",130:"Previous owner died",131:"State not recoverable"};function ib(t){return e.___errno_location&&(F[e.___errno_location()>>2]=t),t}function jb(e,t){for(var r=0,a=e.length-1;0<=a;a--){var n=e[a];"."===n?e.splice(a,1):".."===n?(e.splice(a,1),r++):r&&(e.splice(a,1),r--)}if(t)for(;r--;r)e.unshift("..");return e}function N(e){var t="/"===e.charAt(0),r="/"===e.substr(-1);return(e=jb(e.split("/").filter((function(e){return!!e})),!t).join("/"))||t||(e="."),e&&r&&(e+="/"),(t?"/":"")+e}function kb(e){var t=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/.exec(e).slice(1);return e=t[0],t=t[1],e||t?(t&&(t=t.substr(0,t.length-1)),e+t):"."}function lb(e){if("/"===e)return"/";var t=e.lastIndexOf("/");return-1===t?e:e.substr(t+1)}function mb(){for(var e="",t=!1,r=arguments.length-1;-1<=r&&!t;r--){if("string"!=typeof(t=0<=r?arguments[r]:"/"))throw new TypeError("Arguments to path.resolve must be strings");if(!t)return"";e=t+"/"+e,t="/"===t.charAt(0)}return(t?"/":"")+(e=jb(e.split("/").filter((function(e){return!!e})),!t).join("/"))||"."}var nb=[];function ob(e,t){nb[e]={input:[],output:[],L:t},pb(e,qb)}var qb={open:function(e){var t=nb[e.g.rdev];if(!t)throw new O(M.ba);e.tty=t,e.seekable=!1},close:function(e){e.tty.L.flush(e.tty)},flush:function(e){e.tty.L.flush(e.tty)},read:function(e,t,r,a){if(!e.tty||!e.tty.L.Ba)throw new O(M.sa);for(var n=0,i=0;i<a;i++){var s;try{s=e.tty.L.Ba(e.tty)}catch(e){throw new O(M.F)}if(void 0===s&&0===n)throw new O(M.oa);if(null==s)break;n++,t[r+i]=s}return n&&(e.g.timestamp=Date.now()),n},write:function(e,t,r,a){if(!e.tty||!e.tty.L.ja)throw new O(M.sa);for(var n=0;n<a;n++)try{e.tty.L.ja(e.tty,t[r+n])}catch(e){throw new O(M.F)}return a&&(e.g.timestamp=Date.now()),n}},rb={Ba:function(e){if(!e.input.length){var t=null;if("undefined"!=typeof window&&"function"==typeof window.prompt?null!==(t=window.prompt("Input: "))&&(t+="\n"):"function"==typeof readline&&(null!==(t=readline())&&(t+="\n")),!t)return null;e.input=Va(t,!0)}return e.input.shift()},ja:function(t,r){null===r||10===r?(e.print(za(t.output,0)),t.output=[]):0!=r&&t.output.push(r)},flush:function(t){t.output&&0<t.output.length&&(e.print(za(t.output,0)),t.output=[])}},sb={ja:function(t,r){null===r||10===r?(e.printErr(za(t.output,0)),t.output=[]):0!=r&&t.output.push(r)},flush:function(t){t.output&&0<t.output.length&&(e.printErr(za(t.output,0)),t.output=[])}},P={q:null,A:function(){return P.createNode(null,"/",16895,0)},createNode:function(e,t,r,a){if(24576==(61440&r)||4096==(61440&r))throw new O(M.G);return P.q||(P.q={dir:{g:{D:P.k.D,p:P.k.p,lookup:P.k.lookup,V:P.k.V,rename:P.k.rename,unlink:P.k.unlink,rmdir:P.k.rmdir,readdir:P.k.readdir,symlink:P.k.symlink},stream:{I:P.n.I}},file:{g:{D:P.k.D,p:P.k.p},stream:{I:P.n.I,read:P.n.read,write:P.n.write,ta:P.n.ta,Ea:P.n.Ea,Ga:P.n.Ga}},link:{g:{D:P.k.D,p:P.k.p,readlink:P.k.readlink},stream:{}},va:{g:{D:P.k.D,p:P.k.p},stream:tb}}),16384==(61440&(r=ub(e,t,r,a)).mode)?(r.k=P.q.dir.g,r.n=P.q.dir.stream,r.e={}):32768==(61440&r.mode)?(r.k=P.q.file.g,r.n=P.q.file.stream,r.o=0,r.e=null):40960==(61440&r.mode)?(r.k=P.q.link.g,r.n=P.q.link.stream):8192==(61440&r.mode)&&(r.k=P.q.va.g,r.n=P.q.va.stream),r.timestamp=Date.now(),e&&(e.e[t]=r),r},Sa:function(e){if(e.e&&e.e.subarray){for(var t=[],r=0;r<e.o;++r)t.push(e.e[r]);return t}return e.e},qd:function(e){return e.e?e.e.subarray?e.e.subarray(0,e.o):new Uint8Array(e.e):new Uint8Array},ya:function(e,t){if(e.e&&e.e.subarray&&t>e.e.length&&(e.e=P.Sa(e),e.o=e.e.length),!e.e||e.e.subarray){var r=e.e?e.e.buffer.byteLength:0;r>=t||(t=Math.max(t,r*(1048576>r?2:1.125)|0),0!=r&&(t=Math.max(t,256)),r=e.e,e.e=new Uint8Array(t),0<e.o&&e.e.set(r.subarray(0,e.o),0))}else for(!e.e&&0<t&&(e.e=[]);e.e.length<t;)e.e.push(0)},ab:function(e,t){if(e.o!=t)if(0==t)e.e=null,e.o=0;else{if(!e.e||e.e.subarray){var r=e.e;e.e=new Uint8Array(new ArrayBuffer(t)),r&&e.e.set(r.subarray(0,Math.min(t,e.o)))}else if(e.e||(e.e=[]),e.e.length>t)e.e.length=t;else for(;e.e.length<t;)e.e.push(0);e.o=t}},k:{D:function(e){var t={};return t.dev=8192==(61440&e.mode)?e.id:1,t.ino=e.id,t.mode=e.mode,t.nlink=1,t.uid=0,t.gid=0,t.rdev=e.rdev,16384==(61440&e.mode)?t.size=4096:32768==(61440&e.mode)?t.size=e.o:40960==(61440&e.mode)?t.size=e.link.length:t.size=0,t.atime=new Date(e.timestamp),t.mtime=new Date(e.timestamp),t.ctime=new Date(e.timestamp),t.Pa=4096,t.blocks=Math.ceil(t.size/t.Pa),t},p:function(e,t){void 0!==t.mode&&(e.mode=t.mode),void 0!==t.timestamp&&(e.timestamp=t.timestamp),void 0!==t.size&&P.ab(e,t.size)},lookup:function(){throw vb[M.B]},V:function(e,t,r,a){return P.createNode(e,t,r,a)},rename:function(e,t,r){if(16384==(61440&e.mode)){var a;try{a=wb(t,r)}catch(e){}if(a)for(var n in a.e)throw new O(M.ra)}delete e.parent.e[e.name],e.name=r,t.e[r]=e,e.parent=t},unlink:function(e,t){delete e.e[t]},rmdir:function(e,t){var r,a=wb(e,t);for(r in a.e)throw new O(M.ra);delete e.e[t]},readdir:function(e){var t,r=[".",".."];for(t in e.e)e.e.hasOwnProperty(t)&&r.push(t);return r},symlink:function(e,t,r){return(e=P.createNode(e,t,41471,0)).link=r,e},readlink:function(e){if(40960!=(61440&e.mode))throw new O(M.u);return e.link}},n:{read:function(e,t,r,a,n){var i=e.g.e;if(n>=e.g.o)return 0;if(assert(0<=(e=Math.min(e.g.o-n,a))),8<e&&i.subarray)t.set(i.subarray(n,n+e),r);else for(a=0;a<e;a++)t[r+a]=i[n+a];return e},write:function(e,t,r,a,n,i){if(!a)return 0;if((e=e.g).timestamp=Date.now(),t.subarray&&(!e.e||e.e.subarray)){if(i)return e.e=t.subarray(r,r+a),e.o=a;if(0===e.o&&0===n)return e.e=new Uint8Array(t.subarray(r,r+a)),e.o=a;if(n+a<=e.o)return e.e.set(t.subarray(r,r+a),n),a}if(P.ya(e,n+a),e.e.subarray&&t.subarray)e.e.set(t.subarray(r,r+a),n);else for(i=0;i<a;i++)e.e[n+i]=t[r+i];return e.o=Math.max(e.o,n+a),a},I:function(e,t,r){if(1===r?t+=e.position:2===r&&32768==(61440&e.g.mode)&&(t+=e.g.o),0>t)throw new O(M.u);return t},ta:function(e,t,r){P.ya(e.g,t+r),e.g.o=Math.max(e.g.o,t+r)},Ea:function(e,t,r,a,n,i,s){if(32768!=(61440&e.g.mode))throw new O(M.ba);if(r=e.g.e,2&s||r.buffer!==t&&r.buffer!==t.buffer){if((0<n||n+a<e.g.o)&&(r=r.subarray?r.subarray(n,n+a):Array.prototype.slice.call(r,n,n+a)),e=!0,!(a=ua(a)))throw new O(M.Ka);t.set(r,a)}else e=!1,a=r.byteOffset;return{Cd:a,gd:e}},Ga:function(e,t,r,a,n){if(32768!=(61440&e.g.mode))throw new O(M.ba);return 2&n||P.n.write(e,t,0,a,r,!1),0}}};G(1,"i32*",2),G(1,"i32*",2),G(1,"i32*",2);var xb=null,yb=[null],zb=[],Ab=1,R=null,Cb=!0,S={},O=null,vb={};function T(e,t){if(t=t||{},!(e=mb("/",e)))return{path:"",g:null};var r,a={za:!0,ka:0};for(r in a)void 0===t[r]&&(t[r]=a[r]);if(8<t.ka)throw new O(M.aa);a=jb(e.split("/").filter((function(e){return!!e})),!1);var n=xb;r="/";for(var i=0;i<a.length;i++){var s=i===a.length-1;if(s&&t.parent)break;if(n=wb(n,a[i]),r=N(r+"/"+a[i]),n.R&&(!s||s&&t.za)&&(n=n.R.root),!s||t.ga)for(s=0;40960==(61440&n.mode);)if(n=Db(r),n=T(r=mb(kb(r),n),{ka:t.ka}).g,40<s++)throw new O(M.aa)}return{path:r,g:n}}function U(e){for(var t;;){if(e===e.parent)return e=e.A.Fa,t?"/"!==e[e.length-1]?e+"/"+t:e+t:e;t=t?e.name+"/"+t:e.name,e=e.parent}}function Eb(e,t){for(var r=0,a=0;a<t.length;a++)r=(r<<5)-r+t.charCodeAt(a)|0;return(e+r>>>0)%R.length}function Fb(e){var t=Eb(e.parent.id,e.name);e.K=R[t],R[t]=e}function wb(e,t){var r;if(r=(r=Gb(e,"x"))?r:e.k.lookup?0:M.Y)throw new O(r,e);for(r=R[Eb(e.id,t)];r;r=r.K){var a=r.name;if(r.parent.id===e.id&&a===t)return r}return e.k.lookup(e,t)}function ub(e,t,r,a){return Hb||((Hb=function(e,t,r,a){e||(e=this),this.parent=e,this.A=e.A,this.R=null,this.id=Ab++,this.name=t,this.mode=r,this.k={},this.n={},this.rdev=a}).prototype={},Object.defineProperties(Hb.prototype,{read:{get:function(){return 365==(365&this.mode)},set:function(e){e?this.mode|=365:this.mode&=-366}},write:{get:function(){return 146==(146&this.mode)},set:function(e){e?this.mode|=146:this.mode&=-147}},Xa:{get:function(){return 16384==(61440&this.mode)}},Ca:{get:function(){return 8192==(61440&this.mode)}}})),Fb(e=new Hb(e,t,r,a)),e}var Ib={r:0,rs:1052672,"r+":2,w:577,wx:705,xw:705,"w+":578,"wx+":706,"xw+":706,a:1089,ax:1217,xa:1217,"a+":1090,"ax+":1218,"xa+":1218};function Gb(e,t){return Cb||(-1===t.indexOf("r")||292&e.mode)&&(-1===t.indexOf("w")||146&e.mode)&&(-1===t.indexOf("x")||73&e.mode)?0:M.Y}function Jb(e,t){try{return wb(e,t),M.pa}catch(e){}return Gb(e,"wx")}function Kb(){for(var e=0;e<=4096;e++)if(!zb[e])return e;throw new O(M.Ja)}function Lb(e){Mb||((Mb=function(){}).prototype={},Object.defineProperties(Mb.prototype,{object:{get:function(){return this.g},set:function(e){this.g=e}},vd:{get:function(){return 1!=(2097155&this.flags)}},wd:{get:function(){return 0!=(2097155&this.flags)}},ud:{get:function(){return 1024&this.flags}}}));var t,r=new Mb;for(t in e)r[t]=e[t];return e=r,r=Kb(),e.fd=r,zb[r]=e}var tb={open:function(e){e.n=yb[e.g.rdev].n,e.n.open&&e.n.open(e)},I:function(){throw new O(M.da)}},Zb;function pb(e,t){yb[e]={n:t}}function Nb(e,t){var r,a="/"===t,n=!t;if(a&&xb)throw new O(M.$);if(!a&&!n){if(t=(r=T(t,{za:!1})).path,(r=r.g).R)throw new O(M.$);if(16384!=(61440&r.mode))throw new O(M.qa)}n={type:e,Ad:{},Fa:t,Ya:[]};var i=e.A(n);i.A=n,n.root=i,a?xb=i:r&&(r.R=n,r.A&&r.A.Ya.push(n))}function Ob(e,t,r){var a=T(e,{parent:!0}).g;if(!(e=lb(e))||"."===e||".."===e)throw new O(M.u);var n=Jb(a,e);if(n)throw new O(n);if(!a.k.V)throw new O(M.G);return a.k.V(a,e,t,r)}function Pb(e,t){return t=4095&(void 0!==t?t:438),Ob(e,t|=32768,0)}function V(e,t){return t=1023&(void 0!==t?t:511),Ob(e,t|=16384,0)}function Qb(e,t,r){return void 0===r&&(r=t,t=438),Ob(e,8192|t,r)}function Rb(e,t){if(!mb(e))throw new O(M.B);var r=T(t,{parent:!0}).g;if(!r)throw new O(M.B);var a=lb(t),n=Jb(r,a);if(n)throw new O(n);if(!r.k.symlink)throw new O(M.G);return r.k.symlink(r,a,e)}function Db(e){if(!(e=T(e).g))throw new O(M.B);if(!e.k.readlink)throw new O(M.u);return mb(U(e.parent),e.k.readlink(e))}function Sb(e,t){var r;if(!(r="string"==typeof e?T(e,{ga:!0}).g:e).k.p)throw new O(M.G);r.k.p(r,{mode:4095&t|-4096&r.mode,timestamp:Date.now()})}function Tb(t,r){var a,n,i;if(""===t)throw new O(M.B);if("string"==typeof r){if(void 0===(n=Ib[r]))throw Error("Unknown file open mode: "+r)}else n=r;if(a=64&(r=n)?4095&(void 0===a?438:a)|32768:0,"object"==typeof t)i=t;else{t=N(t);try{i=T(t,{ga:!(131072&r)}).g}catch(e){}}if(n=!1,64&r)if(i){if(128&r)throw new O(M.pa)}else i=Ob(t,a,0),n=!0;if(!i)throw new O(M.B);if(8192==(61440&i.mode)&&(r&=-513),65536&r&&16384!=(61440&i.mode))throw new O(M.qa);if(!n&&(i?40960==(61440&i.mode)?a=M.aa:16384==(61440&i.mode)&&(0!=(2097155&r)||512&r)?a=M.N:(a=["r","w","rw"][3&r],512&r&&(a+="w"),a=Gb(i,a)):a=M.B,a))throw new O(a);if(512&r){var s;if(!(s="string"==typeof(a=i)?T(a,{ga:!0}).g:a).k.p)throw new O(M.G);if(16384==(61440&s.mode))throw new O(M.N);if(32768!=(61440&s.mode))throw new O(M.u);if(a=Gb(s,"w"))throw new O(a);s.k.p(s,{size:0,timestamp:Date.now()})}r&=-641,(i=Lb({g:i,path:U(i),flags:r,seekable:!0,position:0,n:i.n,eb:[],error:!1})).n.open&&i.n.open(i),!e.logReadFiles||1&r||(Ub||(Ub={}),t in Ub||(Ub[t]=1,e.printErr("read file: "+t)));try{S.onOpenFile&&(s=0,1!=(2097155&r)&&(s|=1),0!=(2097155&r)&&(s|=2),S.onOpenFile(t,s))}catch(e){console.log("FS.trackingDelegate['onOpenFile']('"+t+"', flags) threw an exception: "+e.message)}return i}function Vb(e){e.ia&&(e.ia=null);try{e.n.close&&e.n.close(e)}catch(e){throw e}finally{zb[e.fd]=null}}function Wb(e,t,r){if(!e.seekable||!e.n.I)throw new O(M.da);e.position=e.n.I(e,t,r),e.eb=[]}function Xb(e,t,r,a,n,i){if(0>a||0>n)throw new O(M.u);if(0==(2097155&e.flags))throw new O(M.Z);if(16384==(61440&e.g.mode))throw new O(M.N);if(!e.n.write)throw new O(M.u);1024&e.flags&&Wb(e,0,2);var s=!0;if(void 0===n)n=e.position,s=!1;else if(!e.seekable)throw new O(M.da);t=e.n.write(e,t,r,a,n,i),s||(e.position+=t);try{e.path&&S.onWriteToFile&&S.onWriteToFile(e.path)}catch(e){console.log("FS.trackingDelegate['onWriteToFile']('"+path+"') threw an exception: "+e.message)}return t}function Yb(){O||((O=function(e,t){this.g=t,this.bb=function(e){for(var t in this.Q=e,M)if(M[t]===e){this.code=t;break}},this.bb(e),this.message=hb[e]}).prototype=Error(),O.prototype.constructor=O,[M.B].forEach((function(e){vb[e]=new O(e),vb[e].stack="<generic error, no stack>"})))}function $b(e,t){var r=0;return e&&(r|=365),t&&(r|=146),r}function ac(e,t,r,a){return Pb(e=N(("string"==typeof e?e:U(e))+"/"+t),$b(r,a))}function bc(e,t,r,a,n,i){if(n=Pb(e=t?N(("string"==typeof e?e:U(e))+"/"+t):e,a=$b(a,n)),r){if("string"==typeof r){e=Array(r.length),t=0;for(var s=r.length;t<s;++t)e[t]=r.charCodeAt(t);r=e}Sb(n,146|a),Xb(e=Tb(n,"w"),r,0,r.length,0,i),Vb(e),Sb(n,a)}return n}function W(e,t,r,a){e=N(("string"==typeof e?e:U(e))+"/"+t),t=$b(!!r,!!a),W.Da||(W.Da=64);var n=W.Da++<<8|0;return pb(n,{open:function(e){e.seekable=!1},close:function(){a&&a.buffer&&a.buffer.length&&a(10)},read:function(e,t,a,n){for(var i=0,s=0;s<n;s++){var o;try{o=r()}catch(e){throw new O(M.F)}if(void 0===o&&0===i)throw new O(M.oa);if(null==o)break;i++,t[a+s]=o}return i&&(e.g.timestamp=Date.now()),i},write:function(e,t,r,n){for(var i=0;i<n;i++)try{a(t[r+i])}catch(e){throw new O(M.F)}return n&&(e.g.timestamp=Date.now()),i}}),Qb(e,t,n)}function cc(t){if(t.Ca||t.Xa||t.link||t.e)return!0;var r=!0;if("undefined"!=typeof XMLHttpRequest)throw Error("Lazy loading should have been performed (contents set) in createLazyFile, but it was not. Lazy loading only works in web workers. Use --embed-file or --preload-file in emcc on the main thread.");if(!e.read)throw Error("Cannot load without read() or XMLHttpRequest.");try{t.e=Va(e.read(t.url),!0),t.o=t.e.length}catch(e){r=!1}return r||ib(M.F),r}var dc={},Hb,Mb,Ub,ec=0;function X(){return F[(ec+=4)-4>>2]}function fc(){var e;if(e=X(),!(e=zb[e]))throw new O(M.Z);return e}function wa(e){wa.C||(v=Ga(),wa.C=!0,assert(n.P),wa.Ra=n.P,n.P=function(){z("cannot dynamically allocate, sbrk now has control")});var t=v;return 0==e||wa.Ra(e)?t:4294967295}function hc(e,t){if(ic=e,jc=t,!kc)return 1;if(0==e)Y=function(){setTimeout(lc,t)},mc="timeout";else if(1==e)Y=function(){nc(lc)},mc="rAF";else if(2==e){if(!window.setImmediate){var r=[];window.addEventListener("message",(function(e){e.source===window&&"__emcc"===e.data&&(e.stopPropagation(),r.shift()())}),!0),window.setImmediate=function(e){r.push(e),window.postMessage("__emcc","*")}}Y=function(){window.setImmediate(lc)},mc="immediate"}return 0}function oc(t,r,a,i,s){e.noExitRuntime=!0,assert(!kc,"emscripten_set_main_loop: there can only be one main loop function at once: call emscripten_cancel_main_loop to cancel the previous one before setting a new one with different parameters."),kc=t,pc=i;var o=qc;if(lc=function(){if(!A)if(0<rc.length){var r=Date.now(),a=rc.shift();if(a.Qa(a.T),sc){var s=sc,u=0==s%1?s-1:Math.floor(s);sc=a.ld?u:(8*s+(u+.5))/9}console.log('main loop blocker "'+a.name+'" took '+(Date.now()-r)+" ms"),tc(),setTimeout(lc,0)}else o<qc||(uc=uc+1|0,1==ic&&1<jc&&0!=uc%jc?Y():("timeout"===mc&&e.fa&&(e.S("Looks like you are rendering without using requestAnimationFrame for the main loop. You should use 0 for the frame rate in emscripten_set_main_loop in order to use requestAnimationFrame, as that can greatly improve your frame rates!"),mc=""),vc((function(){void 0!==i?n.J("vi",t,[i]):n.J("v",t)})),o<qc||("object"==typeof SDL&&SDL.audio&&SDL.audio.Za&&SDL.audio.Za(),Y())))},s||(r&&0<r?hc(0,1e3/r):hc(1,1),Y()),a)throw"SimulateInfiniteLoop"}e._memcpy=gc;var Y=null,mc="",qc=0,kc=null,pc=0,ic=0,jc=0,uc=0,rc=[];function tc(){if(e.setStatus){var t=e.statusMessage||"Please wait...",r=sc,a=wc.nd;r?r<a?e.setStatus(t+" ("+(a-r)+"/"+a+")"):e.setStatus(t):e.setStatus("")}}function vc(t){if(!(A||e.preMainLoop&&!1===e.preMainLoop())){try{t()}catch(t){if(t instanceof xc)return;throw t&&"object"==typeof t&&t.stack&&e.S("exception thrown: "+[t,t.stack]),t}e.postMainLoop&&e.postMainLoop()}}var wc={},lc,sc,yc=!1,zc=!1,Ac=[];function Bc(){function t(){zc=document.pointerLockElement===r||document.mozPointerLockElement===r||document.webkitPointerLockElement===r||document.msPointerLockElement===r}if(e.preloadPlugins||(e.preloadPlugins=[]),!Cc){Cc=!0;try{Dc=!0}catch(e){Dc=!1,console.log("warning: no blob constructor, cannot create blobs with mimetypes")}Ec="undefined"!=typeof MozBlobBuilder?MozBlobBuilder:"undefined"!=typeof WebKitBlobBuilder?WebKitBlobBuilder:Dc?null:console.log("warning: no BlobBuilder"),Fc="undefined"!=typeof window?window.URL?window.URL:window.webkitURL:void 0,e.Ha||void 0!==Fc||(console.log("warning: Browser does not support creating object URLs. Built-in browser image decoding will not be available."),e.Ha=!0),e.preloadPlugins.push({canHandle:function(t){return!e.Ha&&/\.(jpg|jpeg|png|bmp)$/i.test(t)},handle:function(t,r,a,i){var s=null;if(Dc)try{(s=new Blob([t],{type:Gc(r)})).size!==t.length&&(s=new Blob([new Uint8Array(t).buffer],{type:Gc(r)}))}catch(e){n.M("Blob constructor present but fails: "+e+"; falling back to blob builder")}s||((s=new Ec).append(new Uint8Array(t).buffer),s=s.getBlob());var o=Fc.createObjectURL(s),u=new Image;u.onload=function(){assert(u.complete,"Image "+r+" could not be decoded");var n=document.createElement("canvas");n.width=u.width,n.height=u.height,n.getContext("2d").drawImage(u,0,0),e.preloadedImages[r]=n,Fc.revokeObjectURL(o),a&&a(t)},u.onerror=function(){console.log("Image "+o+" could not be decoded"),i&&i()},u.src=o}}),e.preloadPlugins.push({canHandle:function(t){return!e.zd&&t.substr(-4)in{".ogg":1,".wav":1,".mp3":1}},handle:function(t,r,a,n){function i(n){o||(o=!0,e.preloadedAudios[r]=n,a&&a(t))}function s(){o||(o=!0,e.preloadedAudios[r]=new Audio,n&&n())}var o=!1;if(!Dc)return s();try{var u=new Blob([t],{type:Gc(r)})}catch(e){return s()}u=Fc.createObjectURL(u);var l=new Audio;l.addEventListener("canplaythrough",(function(){i(l)}),!1),l.onerror=function(){if(!o){console.log("warning: browser could not fully decode audio "+r+", trying slower base64 approach");for(var e="",a=0,n=0,s=0;s<t.length;s++)for(a=a<<8|t[s],n+=8;6<=n;){var u=a>>n-6&63;n=n-6,e=e+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[u]}2==n?(e+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[(3&a)<<4],e+="=="):4==n&&(e+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[(15&a)<<2],e+="="),l.src="data:audio/x-"+r.substr(-3)+";base64,"+e,i(l)}},l.src=u,Hc((function(){i(l)}))}});var r=e.canvas;r&&(r.la=r.requestPointerLock||r.mozRequestPointerLock||r.webkitRequestPointerLock||r.msRequestPointerLock||function(){},r.wa=document.exitPointerLock||document.mozExitPointerLock||document.webkitExitPointerLock||document.msExitPointerLock||function(){},r.wa=r.wa.bind(document),document.addEventListener("pointerlockchange",t,!1),document.addEventListener("mozpointerlockchange",t,!1),document.addEventListener("webkitpointerlockchange",t,!1),document.addEventListener("mspointerlockchange",t,!1),e.elementPointerLock&&r.addEventListener("click",(function(e){!zc&&r.la&&(r.la(),e.preventDefault())}),!1))}}function Ic(t,r,a,n){if(r&&e.fa&&t==e.canvas)return e.fa;var i,s;if(r){if(s={antialias:!1,alpha:!1},n)for(var o in n)s[o]=n[o];(s=GL.createContext(t,s))&&(i=GL.getContext(s).cd),t.style.backgroundColor="black"}else i=t.getContext("2d");return i?(a&&(r||assert("undefined"==typeof GLctx,"cannot set in module if GLctx is used, but we are a non-GL context that would replace it"),e.fa=i,r&&GL.yd(s),e.Dd=r,Ac.forEach((function(e){e()})),Bc()),i):null}var Jc=!1,Kc=void 0,Lc=void 0;function Mc(t,r,a){function n(){yc=!1;var t=i.parentNode;(document.webkitFullScreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.mozFullscreenElement||document.fullScreenElement||document.fullscreenElement||document.msFullScreenElement||document.msFullscreenElement||document.webkitCurrentFullScreenElement)===t?(i.ua=document.cancelFullScreen||document.mozCancelFullScreen||document.webkitCancelFullScreen||document.msExitFullscreen||document.exitFullscreen||function(){},i.ua=i.ua.bind(document),Kc&&i.la(),yc=!0,Lc&&Nc()):(t.parentNode.insertBefore(i,t),t.parentNode.removeChild(t),Lc&&Oc()),e.onFullScreen&&e.onFullScreen(yc),Pc(i)}void 0===(Kc=t)&&(Kc=!0),void 0===(Lc=r)&&(Lc=!1),void 0===(Qc=a)&&(Qc=null);var i=e.canvas;Jc||(Jc=!0,document.addEventListener("fullscreenchange",n,!1),document.addEventListener("mozfullscreenchange",n,!1),document.addEventListener("webkitfullscreenchange",n,!1),document.addEventListener("MSFullscreenChange",n,!1));var s=document.createElement("div");i.parentNode.insertBefore(s,i),s.appendChild(i),s.C=s.requestFullScreen||s.mozRequestFullScreen||s.msRequestFullscreen||(s.webkitRequestFullScreen?function(){s.webkitRequestFullScreen(Element.ALLOW_KEYBOARD_INPUT)}:null),a?s.C({Ed:a}):s.C()}var Rc=0;function Sc(e){var t=Date.now();if(0===Rc)Rc=t+1e3/60;else for(;t+2>=Rc;)Rc+=1e3/60;t=Math.max(Rc-t,0),setTimeout(e,t)}function nc(e){"undefined"==typeof window?Sc(e):(window.requestAnimationFrame||(window.requestAnimationFrame=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame||window.oRequestAnimationFrame||Sc),window.requestAnimationFrame(e))}function Hc(t){e.noExitRuntime=!0,setTimeout((function(){A||t()}),1e4)}function Gc(e){return{jpg:"image/jpeg",jpeg:"image/jpeg",png:"image/png",bmp:"image/bmp",ogg:"audio/ogg",wav:"audio/wav",mp3:"audio/mpeg"}[e.substr(e.lastIndexOf(".")+1)]}function Tc(e,t,r){var a=new XMLHttpRequest;a.open("GET",e,!0),a.responseType="arraybuffer",a.onload=function(){200==a.status||0==a.status&&a.response?t(a.response):r()},a.onerror=r,a.send(null)}function Uc(e,t,r){Tc(e,(function(r){assert(r,'Loading data file "'+e+'" failed (no arrayBuffer).'),t(new Uint8Array(r)),Za()}),(function(){if(!r)throw'Loading data file "'+e+'" failed.';r()})),Ya()}var Vc=[],Cc,Dc,Ec,Fc,Qc;function Wc(){var t=e.canvas;Vc.forEach((function(e){e(t.width,t.height)}))}function Nc(){if("undefined"!=typeof SDL){var e=Ia[SDL.screen+0*n.H>>2];F[SDL.screen+0*n.H>>2]=8388608|e}Wc()}function Oc(){if("undefined"!=typeof SDL){var e=Ia[SDL.screen+0*n.H>>2];F[SDL.screen+0*n.H>>2]=-8388609&e}Wc()}function Pc(t,r,a){r&&a?(t.fb=r,t.Va=a):(r=t.fb,a=t.Va);var n=r,i=a;if(e.forcedAspectRatio&&0<e.forcedAspectRatio&&(n/i<e.forcedAspectRatio?n=Math.round(i*e.forcedAspectRatio):i=Math.round(n/e.forcedAspectRatio)),(document.webkitFullScreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.mozFullscreenElement||document.fullScreenElement||document.fullscreenElement||document.msFullScreenElement||document.msFullscreenElement||document.webkitCurrentFullScreenElement)===t.parentNode&&"undefined"!=typeof screen){var s=Math.min(screen.width/n,screen.height/i);n=Math.round(n*s),i=Math.round(i*s)}Lc?(t.width!=n&&(t.width=n),t.height!=i&&(t.height=i),void 0!==t.style&&(t.style.removeProperty("width"),t.style.removeProperty("height"))):(t.width!=r&&(t.width=r),t.height!=a&&(t.height=a),void 0!==t.style&&(n!=r||i!=a?(t.style.setProperty("width",n+"px","important"),t.style.setProperty("height",i+"px","important")):(t.style.removeProperty("width"),t.style.removeProperty("height"))))}Yb(),R=Array(4096),Nb(P,"/"),V("/tmp"),V("/home"),V("/home/web_user"),function(){var e;if(V("/dev"),pb(259,{read:function(){return 0},write:function(e,t,r,a){return a}}),Qb("/dev/null",259),ob(1280,rb),ob(1536,sb),Qb("/dev/tty",1280),Qb("/dev/tty1",1536),"undefined"!=typeof crypto){var t=new Uint8Array(1);e=function(){return crypto.getRandomValues(t),t[0]}}else e=function(){return 256*Math.random()|0};W("/dev","random",e),W("/dev","urandom",e),V("/dev/shm"),V("/dev/shm/tmp")}(),V("/proc"),V("/proc/self"),V("/proc/self/fd"),Nb({A:function(){var e=ub("/proc/self","fd",16895,73);return e.k={lookup:function(e,t){var r=zb[+t];if(!r)throw new O(M.Z);var a={parent:null,A:{Fa:"fake"},k:{readlink:function(){return r.path}}};return a.parent=a}},e}},"/proc/self/fd"),Qa.unshift((function(){if(!e.noFSInit&&!Zb){assert(!Zb,"FS.init was previously called. If you want to initialize later with custom parameters, remove any earlier calls (note that one is automatically added to the generated code)"),Zb=!0,Yb(),e.stdin=e.stdin,e.stdout=e.stdout,e.stderr=e.stderr,e.stdin?W("/dev","stdin",e.stdin):Rb("/dev/tty","/dev/stdin"),e.stdout?W("/dev","stdout",null,e.stdout):Rb("/dev/tty","/dev/stdout"),e.stderr?W("/dev","stderr",null,e.stderr):Rb("/dev/tty1","/dev/stderr");var t=Tb("/dev/stdin","r");assert(0===t.fd,"invalid handle for stdin ("+t.fd+")"),assert(1===(t=Tb("/dev/stdout","w")).fd,"invalid handle for stdout ("+t.fd+")"),assert(2===(t=Tb("/dev/stderr","w")).fd,"invalid handle for stderr ("+t.fd+")")}})),Ra.push((function(){Cb=!1})),K.push((function(){Zb=!1;var t=e._fflush;for(t&&t(0),t=0;t<zb.length;t++){var r=zb[t];r&&Vb(r)}})),e.FS_createFolder=function(e,t,r,a){return V(e=N(("string"==typeof e?e:U(e))+"/"+t),$b(r,a))},e.FS_createPath=function(e,t){e="string"==typeof e?e:U(e);for(var r=t.split("/").reverse();r.length;){var a=r.pop();if(a){var n=N(e+"/"+a);try{V(n)}catch(e){}e=n}}return n},e.FS_createDataFile=bc,e.FS_createPreloadedFile=function(t,r,a,n,i,s,o,u,l,d){function c(a){function c(e){d&&d(),u||bc(t,r,e,n,i,l),s&&s(),Za()}var p=!1;e.preloadPlugins.forEach((function(e){!p&&e.canHandle(f)&&(e.handle(a,f,c,(function(){o&&o(),Za()})),p=!0)})),p||c(a)}Bc();var f=r?mb(N(t+"/"+r)):t;Ya(),"string"==typeof a?Uc(a,(function(e){c(e)}),o):c(a)},e.FS_createLazyFile=function(e,t,r,a,n){if("undefined"!=typeof XMLHttpRequest)throw"Cannot do synchronous binary XHRs outside webworkers in modern browsers. Use --embed-file or --preload-file in emcc";r={Ca:!1,url:r};var i=ac(e,t,a,n);r.e?i.e=r.e:r.url&&(i.e=null,i.url=r.url),Object.defineProperty(i,"usedBytes",{get:function(){return this.e.length}});var s={};return Object.keys(i.n).forEach((function(e){var t=i.n[e];s[e]=function(){if(!cc(i))throw new O(M.F);return t.apply(null,arguments)}})),s.read=function(e,t,r,a,n){if(!cc(i))throw new O(M.F);if(n>=(e=e.g.e).length)return 0;if(assert(0<=(a=Math.min(e.length-n,a))),e.slice)for(var s=0;s<a;s++)t[r+s]=e[n+s];else for(s=0;s<a;s++)t[r+s]=e.get(n+s);return a},i.n=s,i},e.FS_createLink=function(e,t,r){return Rb(r,e=N(("string"==typeof e?e:U(e))+"/"+t))},e.FS_createDevice=W,e.FS_unlink=function(e){var t,r=T(e,{parent:!0}).g,a=lb(e),n=wb(r,a);e:{try{t=wb(r,a)}catch(e){t=e.Q;break e}var i=Gb(r,"wx");t=i||(16384==(61440&t.mode)?M.N:0)}if(t)throw t===M.N&&(t=M.G),new O(t);if(!r.k.unlink)throw new O(M.G);if(n.R)throw new O(M.$);try{S.willDeletePath&&S.willDeletePath(e)}catch(t){console.log("FS.trackingDelegate['willDeletePath']('"+e+"') threw an exception: "+t.message)}if(r.k.unlink(r,a),r=Eb(n.parent.id,n.name),R[r]===n)R[r]=n.K;else for(r=R[r];r;){if(r.K===n){r.K=n.K;break}r=r.K}try{S.onDeletePath&&S.onDeletePath(e)}catch(t){console.log("FS.trackingDelegate['onDeletePath']('"+e+"') threw an exception: "+t.message)}},Qa.unshift((function(){})),K.push((function(){})),e.requestFullScreen=function(e,t,r){Mc(e,t,r)},e.requestAnimationFrame=function(e){nc(e)},e.setCanvasSize=function(t,r,a){Pc(e.canvas,t,r),a||Wc()},e.pauseMainLoop=function(){Y=null,qc++},e.resumeMainLoop=function(){qc++;var e=ic,t=jc,r=kc;kc=null,oc(r,0,!1,pc,!0),hc(e,t),Y()},e.getUserMedia=function(){window.C||(window.C=navigator.getUserMedia||navigator.mozGetUserMedia),window.C(void 0)},e.createContext=function(e,t,r,a){return Ic(e,t,r,a)},Ka=m=n.ea(p),va=!0,La=Ka+Na,Ma=v=n.ea(La),assert(Ma<w,"TOTAL_MEMORY not big enough for stack");var Xc=G([8,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,5,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,6,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,5,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,7,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,5,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,6,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,5,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0],"i8",3);e.Na={Math,Int8Array,Int16Array,Int32Array,Uint8Array,Uint16Array,Uint32Array,Float32Array,Float64Array,NaN:NaN,Infinity:1/0},e.Oa={abort:z,assert,invoke_ii:function(t,r){try{return e.dynCall_ii(t,r)}catch(e){if("number"!=typeof e&&"longjmp"!==e)throw e;Z.setThrew(1,0)}},invoke_iiii:function(t,r,a,n){try{return e.dynCall_iiii(t,r,a,n)}catch(e){if("number"!=typeof e&&"longjmp"!==e)throw e;Z.setThrew(1,0)}},invoke_vi:function(t,r){try{e.dynCall_vi(t,r)}catch(e){if("number"!=typeof e&&"longjmp"!==e)throw e;Z.setThrew(1,0)}},_pthread_cleanup_pop:function(){assert(eb.level==K.length,"cannot pop if something else added meanwhile!"),K.pop(),eb.level=K.length},___lock:function(){},_emscripten_set_main_loop:oc,_pthread_self:function(){return 0},___syscall6:function(e,t){ec=t;try{return Vb(fc()),0}catch(e){return void 0!==dc&&e instanceof O||z(e),-e.Q}},_emscripten_set_main_loop_timing:hc,_abort:function(){e.abort()},_sbrk:wa,_time:function(e){var t=Date.now()/1e3|0;return e&&(F[e>>2]=t),t},___setErrNo:ib,_emscripten_memcpy_big:function(e,t,r){return H.set(H.subarray(t,t+r),e),e},___syscall54:function(e,t){ec=t;try{var r=fc(),a=X();switch(a){case 21505:case 21506:return r.tty?0:-M.O;case 21519:if(!r.tty)return-M.O;var n=X();return F[n>>2]=0;case 21520:return r.tty?-M.u:-M.O;case 21531:if(n=X(),!r.n.Wa)throw new O(M.O);return r.n.Wa(r,a,n);default:z("bad ioctl syscall "+a)}}catch(e){return void 0!==dc&&e instanceof O||z(e),-e.Q}},___unlock:function(){},___syscall140:function(e,t){ec=t;try{var r=fc(),a=X(),n=X(),i=X(),s=X();return assert(0===a),Wb(r,n,s),F[i>>2]=r.position,r.ia&&0===n&&0===s&&(r.ia=null),0}catch(e){return void 0!==dc&&e instanceof O||z(e),-e.Q}},_pthread_cleanup_push:eb,_sysconf:function(e){switch(e){case 30:return 4096;case 85:return I/4096;case 132:case 133:case 12:case 137:case 138:case 15:case 235:case 16:case 17:case 18:case 19:case 20:case 149:case 13:case 10:case 236:case 153:case 9:case 21:case 22:case 159:case 154:case 14:case 77:case 78:case 139:case 80:case 81:case 82:case 68:case 67:case 164:case 11:case 29:case 47:case 48:case 95:case 52:case 51:case 46:return 200809;case 79:return 0;case 27:case 246:case 127:case 128:case 23:case 24:case 160:case 161:case 181:case 182:case 242:case 183:case 184:case 243:case 244:case 245:case 165:case 178:case 179:case 49:case 50:case 168:case 169:case 175:case 170:case 171:case 172:case 97:case 76:case 32:case 173:case 35:return-1;case 176:case 177:case 7:case 155:case 8:case 157:case 125:case 126:case 92:case 93:case 129:case 130:case 131:case 94:case 91:return 1;case 74:case 60:case 69:case 70:case 4:return 1024;case 31:case 42:case 72:return 32;case 87:case 26:case 33:return 2147483647;case 34:case 1:return 47839;case 38:case 36:return 99;case 43:case 37:return 2048;case 0:return 2097152;case 3:return 65536;case 28:return 32768;case 44:return 32767;case 75:return 16384;case 39:return 1e3;case 89:return 700;case 71:return 256;case 40:return 255;case 2:return 100;case 180:return 64;case 25:return 20;case 5:return 16;case 6:return 6;case 73:return 4;case 84:return"object"==typeof navigator&&navigator.hardwareConcurrency||1}return ib(M.u),-1},___syscall146:function(e,t){ec=t;try{var r,a=fc(),n=X();e:{for(var i=X(),s=0,o=0;o<i;o++){var u=Xb(a,D,F[n+8*o>>2],F[n+(8*o+4)>>2],void 0);if(0>u){r=-1;break e}s+=u}r=s}return r}catch(e){return void 0!==dc&&e instanceof O||z(e),-e.Q}},STACKTOP:m,STACK_MAX:La,tempDoublePtr:$a,ABORT:A,cttz_i8:Xc};var Z=function(e,t,r){var a=new e.Int8Array(r),n=(new e.Int16Array(r),new e.Int32Array(r)),i=new e.Uint8Array(r),s=(new e.Uint16Array(r),new e.Uint32Array(r),new e.Float32Array(r),new e.Float64Array(r),0|t.STACKTOP),o=(t.STACK_MAX,t.tempDoublePtr,t.ABORT,t.cttz_i8,0),u=(e.NaN,e.Infinity,0),l=(e.Math.floor,e.Math.abs,e.Math.sqrt,e.Math.pow,e.Math.cos,e.Math.sin,e.Math.tan,e.Math.acos,e.Math.asin,e.Math.atan,e.Math.atan2,e.Math.exp,e.Math.log,e.Math.ceil,e.Math.imul),d=(e.Math.min,e.Math.clz32,t.abort),c=(t.assert,t.invoke_ii,t.invoke_iiii,t.invoke_vi,t._pthread_cleanup_pop),f=t.___lock,p=(t._emscripten_set_main_loop,t._pthread_self),h=t.___syscall6,_=(t._emscripten_set_main_loop_timing,t._abort),m=t._sbrk,g=t._time,v=(t.___setErrNo,t._emscripten_memcpy_big),E=t.___syscall54,y=t.___unlock,S=t.___syscall140,T=t._pthread_cleanup_push,b=t._sysconf,A=t.___syscall146;function C(e,t,r){e|=0;var a,i=0,o=0,l=0,d=0,c=0,f=0,p=0,h=0,_=0,m=0,g=0;a=s,s=s+160|0,P(i=a,t|=0,r|=0),t=0|n[(r=i+144|0)>>2],o=0|n[r+4>>2],d=0|n[(l=r=i+64|0)>>2],c=0|n[l+4>>2],l=0|B(0|t,0|o,18,0),f=u,p=0|U(0|d,0|c,0|t,0|o),o=0|U(0|p,0|u,0|l,0|f),n[(f=r)>>2]=o,n[f+4>>2]=u,o=0|n[(f=i+136|0)>>2],r=0|n[f+4>>2],p=0|n[(l=f=i+56|0)>>2],t=0|n[l+4>>2],l=0|B(0|o,0|r,18,0),c=u,d=0|U(0|p,0|t,0|o,0|r),r=0|U(0|d,0|u,0|l,0|c),n[(c=f)>>2]=r,n[c+4>>2]=u,r=0|n[(c=i+128|0)>>2],f=0|n[c+4>>2],d=0|n[(l=c=i+48|0)>>2],o=0|n[l+4>>2],l=0|B(0|r,0|f,18,0),t=u,p=0|U(0|d,0|o,0|r,0|f),f=0|U(0|p,0|u,0|l,0|t),n[(t=c)>>2]=f,n[t+4>>2]=u,f=0|n[(t=i+120|0)>>2],c=0|n[t+4>>2],p=0|n[(l=t=i+40|0)>>2],r=0|n[l+4>>2],l=0|B(0|f,0|c,18,0),o=u,d=0|U(0|p,0|r,0|f,0|c),c=0|U(0|d,0|u,0|l,0|o),n[(o=t)>>2]=c,n[o+4>>2]=u,c=0|n[(o=i+112|0)>>2],t=0|n[o+4>>2],d=0|n[(l=o=i+32|0)>>2],f=0|n[l+4>>2],l=0|B(0|c,0|t,18,0),r=u,p=0|U(0|d,0|f,0|c,0|t),t=0|U(0|p,0|u,0|l,0|r),n[(r=o)>>2]=t,n[r+4>>2]=u,t=0|n[(r=i+104|0)>>2],o=0|n[r+4>>2],p=0|n[(l=r=i+24|0)>>2],c=0|n[l+4>>2],l=0|B(0|t,0|o,18,0),f=u,d=0|U(0|p,0|c,0|t,0|o),o=0|U(0|d,0|u,0|l,0|f),n[(f=r)>>2]=o,n[f+4>>2]=u,o=0|n[(f=i+96|0)>>2],r=0|n[f+4>>2],d=0|n[(l=f=i+16|0)>>2],t=0|n[l+4>>2],l=0|B(0|o,0|r,18,0),c=u,p=0|U(0|d,0|t,0|o,0|r),r=0|U(0|p,0|u,0|l,0|c),n[(c=f)>>2]=r,n[c+4>>2]=u,r=0|n[(c=i+88|0)>>2],f=0|n[c+4>>2],p=0|n[(l=c=i+8|0)>>2],o=0|n[l+4>>2],l=0|B(0|r,0|f,18,0),t=u,d=0|U(0|p,0|o,0|r,0|f),f=0|U(0|d,0|u,0|l,0|t),n[(t=c)>>2]=f,n[t+4>>2]=u,l=0|n[(f=t=i+80|0)>>2],d=0|n[f+4>>2],r=0|n[(f=i)>>2],o=0|n[f+4>>2],f=0|B(0|l,0|d,18,0),p=u,h=0|U(0|r,0|o,0|l,0|d),d=0|U(0|h,0|u,0|f,0|p),p=u,n[(f=i)>>2]=d,n[f+4>>2]=p,n[(f=t)>>2]=0,n[f+4>>2]=0,f=p,p=d,d=0;do{r=0|k(0|p,0|f,0|(o=0|x(0|(l=0|L(0|(h=0|U(f>>31>>>6|0,0,0|p,0|f)),0|u,26)),0|(h=u),26)),0|u),n[(o=i+(d<<3)|0)>>2]=r,n[o+4>>2]=u,g=0|k(0|(_=0|U(0|l,0|h,0|n[(r=o=i+((1|d)<<3)|0)>>2],0|n[r+4>>2])),0|(r=u),0|(m=0|x(0|(l=0|L(0|(h=0|U(r>>31>>>7|0,0,0|_,0|r)),0|u,25)),0|(h=u),25)),0|u),n[(m=o)>>2]=g,n[m+4>>2]=u,p=0|U(0|l,0|h,0|n[(g=m=i+((d=d+2|0)<<3)|0)>>2],0|n[g+4>>2]),f=u,n[(g=m)>>2]=p,n[g+4>>2]=f}while(d>>>0<10);f=0|n[(d=t)>>2],p=0|n[d+4>>2],g=0|n[(d=i)>>2],m=0|n[d+4>>2],d=0|B(0|f,0|p,18,0),h=u,l=0|U(0|g,0|m,0|f,0|p),p=0|U(0|l,0|u,0|d,0|h),h=u,n[(d=t)>>2]=0,n[d+4>>2]=0,f=0|k(0|p,0|h,0|(l=0|x(0|(t=0|L(0|(d=0|U(h>>31>>>6|0,0,0|p,0|h)),0|u,26)),0|(d=u),26)),0|u),n[(l=i)>>2]=f,n[l+4>>2]=u,f=0|U(0|t,0|d,0|n[(l=c)>>2],0|n[l+4>>2]),n[(l=c)>>2]=f,n[l+4>>2]=u,l=e,e=i,i=l+80|0;do{n[l>>2]=n[e>>2],l=l+4|0,e=e+4|0}while((0|l)<(0|i));s=a}function P(e,t,r){e|=0,r|=0;var a=0,i=0,s=0,o=0,l=0,d=0,c=0,f=0,p=0,h=0,_=0,m=0,g=0,v=0,E=0,y=0,S=0,T=0,b=0,A=0,C=0,P=0,O=0;a=0|L(0,0|n[(t|=0)>>2],32),i=u,o=0|B(0|(s=0|L(0,0|n[r>>2],32)),0|u,0|a,0|i),n[(i=e)>>2]=o,n[i+4>>2]=u,i=0|L(0,0|n[t>>2],32),o=u,l=0|B(0|(s=0|L(0,0|n[(a=r+8|0)>>2],32)),0|u,0|i,0|o),o=u,s=0|L(0,0|n[(i=t+8|0)>>2],32),d=u,d=0|U(0|(f=0|B(0|(c=0|L(0,0|n[r>>2],32)),0|u,0|s,0|d)),0|u,0|l,0|o),n[(o=e+8|0)>>2]=d,n[o+4>>2]=u,o=0|L(0,0|n[i>>2],31),d=u,f=0|B(0|(l=0|L(0,0|n[a>>2],32)),0|u,0|o,0|d),d=u,o=0|L(0,0|n[t>>2],32),l=u,l=0|U(0|(p=0|B(0|(c=0|L(0,0|n[(s=r+16|0)>>2],32)),0|u,0|o,0|l)),0|u,0|f,0|d),d=u,p=0|L(0,0|n[(f=t+16|0)>>2],32),o=u,o=0|U(0|l,0|d,0|(h=0|B(0|(c=0|L(0,0|n[r>>2],32)),0|u,0|p,0|o)),0|u),n[(h=e+16|0)>>2]=o,n[h+4>>2]=u,h=0|L(0,0|n[i>>2],32),o=u,l=0|B(0|(d=0|L(0,0|n[s>>2],32)),0|u,0|h,0|o),o=u,h=0|L(0,0|n[f>>2],32),d=u,d=0|U(0|(c=0|B(0|(p=0|L(0,0|n[a>>2],32)),0|u,0|h,0|d)),0|u,0|l,0|o),o=u,l=0|L(0,0|n[t>>2],32),c=u,c=0|U(0|d,0|o,0|(_=0|B(0|(p=0|L(0,0|n[(h=r+24|0)>>2],32)),0|u,0|l,0|c)),0|u),_=u,d=0|L(0,0|n[(o=t+24|0)>>2],32),l=u,l=0|U(0|c,0|_,0|(m=0|B(0|(p=0|L(0,0|n[r>>2],32)),0|u,0|d,0|l)),0|u),n[(m=e+24|0)>>2]=l,n[m+4>>2]=u,m=0|L(0,0|n[f>>2],32),l=u,c=0|B(0|(_=0|L(0,0|n[s>>2],32)),0|u,0|m,0|l),l=u,m=0|L(0,0|n[i>>2],32),_=u,p=0|B(0|(d=0|L(0,0|n[h>>2],32)),0|u,0|m,0|_),_=u,m=0|L(0,0|n[o>>2],32),d=u,d=0|U(0|(v=0|B(0|(g=0|L(0,0|n[a>>2],32)),0|u,0|m,0|d)),0|u,0|p,0|_),d=0|U(0|(_=0|x(0|d,0|u,1)),0|u,0|c,0|l),l=u,c=0|L(0,0|n[t>>2],32),_=u,_=0|U(0|d,0|l,0|(m=0|B(0|(v=0|L(0,0|n[(p=r+32|0)>>2],32)),0|u,0|c,0|_)),0|u),m=u,d=0|L(0,0|n[(l=t+32|0)>>2],32),c=u,c=0|U(0|_,0|m,0|(g=0|B(0|(v=0|L(0,0|n[r>>2],32)),0|u,0|d,0|c)),0|u),n[(g=e+32|0)>>2]=c,n[g+4>>2]=u,g=0|L(0,0|n[f>>2],32),c=u,_=0|B(0|(m=0|L(0,0|n[h>>2],32)),0|u,0|g,0|c),c=u,g=0|L(0,0|n[o>>2],32),m=u,m=0|U(0|(v=0|B(0|(d=0|L(0,0|n[s>>2],32)),0|u,0|g,0|m)),0|u,0|_,0|c),c=u,_=0|L(0,0|n[i>>2],32),v=u,v=0|U(0|m,0|c,0|(d=0|B(0|(g=0|L(0,0|n[p>>2],32)),0|u,0|_,0|v)),0|u),d=u,c=0|L(0,0|n[l>>2],32),m=u,m=0|U(0|v,0|d,0|(g=0|B(0|(_=0|L(0,0|n[a>>2],32)),0|u,0|c,0|m)),0|u),g=u,d=0|L(0,0|n[t>>2],32),v=u,v=0|U(0|m,0|g,0|(E=0|B(0|(_=0|L(0,0|n[(c=r+40|0)>>2],32)),0|u,0|d,0|v)),0|u),E=u,m=0|L(0,0|n[(g=t+40|0)>>2],32),d=u,d=0|U(0|v,0|E,0|(y=0|B(0|(_=0|L(0,0|n[r>>2],32)),0|u,0|m,0|d)),0|u),n[(y=e+40|0)>>2]=d,n[y+4>>2]=u,y=0|L(0,0|n[o>>2],32),d=u,v=0|B(0|(E=0|L(0,0|n[h>>2],32)),0|u,0|y,0|d),d=u,y=0|L(0,0|n[i>>2],32),E=u,E=0|U(0|(_=0|B(0|(m=0|L(0,0|n[c>>2],32)),0|u,0|y,0|E)),0|u,0|v,0|d),d=u,v=0|L(0,0|n[g>>2],32),_=u,m=0|x(0|(_=0|U(0|E,0|d,0|(m=0|B(0|(y=0|L(0,0|n[a>>2],32)),0|u,0|v,0|_)),0|u)),0|u,1),_=u,d=0|L(0,0|n[f>>2],32),E=u,E=0|U(0|m,0|_,0|(y=0|B(0|(v=0|L(0,0|n[p>>2],32)),0|u,0|d,0|E)),0|u),y=u,_=0|L(0,0|n[l>>2],32),m=u,m=0|U(0|E,0|y,0|(v=0|B(0|(d=0|L(0,0|n[s>>2],32)),0|u,0|_,0|m)),0|u),v=u,y=0|L(0,0|n[t>>2],32),E=u,E=0|U(0|m,0|v,0|(S=0|B(0|(d=0|L(0,0|n[(_=r+48|0)>>2],32)),0|u,0|y,0|E)),0|u),S=u,m=0|L(0,0|n[(v=t+48|0)>>2],32),y=u,y=0|U(0|E,0|S,0|(T=0|B(0|(d=0|L(0,0|n[r>>2],32)),0|u,0|m,0|y)),0|u),n[(T=e+48|0)>>2]=y,n[T+4>>2]=u,T=0|L(0,0|n[o>>2],32),y=u,E=0|B(0|(S=0|L(0,0|n[p>>2],32)),0|u,0|T,0|y),y=u,T=0|L(0,0|n[l>>2],32),S=u,S=0|U(0|(d=0|B(0|(m=0|L(0,0|n[h>>2],32)),0|u,0|T,0|S)),0|u,0|E,0|y),y=u,E=0|L(0,0|n[f>>2],32),d=u,d=0|U(0|S,0|y,0|(m=0|B(0|(T=0|L(0,0|n[c>>2],32)),0|u,0|E,0|d)),0|u),m=u,y=0|L(0,0|n[g>>2],32),S=u,S=0|U(0|d,0|m,0|(T=0|B(0|(E=0|L(0,0|n[s>>2],32)),0|u,0|y,0|S)),0|u),T=u,m=0|L(0,0|n[i>>2],32),d=u,d=0|U(0|S,0|T,0|(E=0|B(0|(y=0|L(0,0|n[_>>2],32)),0|u,0|m,0|d)),0|u),E=u,T=0|L(0,0|n[v>>2],32),S=u,S=0|U(0|d,0|E,0|(y=0|B(0|(m=0|L(0,0|n[a>>2],32)),0|u,0|T,0|S)),0|u),y=u,E=0|L(0,0|n[t>>2],32),d=u,d=0|U(0|S,0|y,0|(b=0|B(0|(m=0|L(0,0|n[(T=r+56|0)>>2],32)),0|u,0|E,0|d)),0|u),b=u,S=0|L(0,0|n[(y=t+56|0)>>2],32),E=u,E=0|U(0|d,0|b,0|(A=0|B(0|(m=0|L(0,0|n[r>>2],32)),0|u,0|S,0|E)),0|u),n[(A=e+56|0)>>2]=E,n[A+4>>2]=u,A=0|L(0,0|n[l>>2],32),E=u,d=0|B(0|(b=0|L(0,0|n[p>>2],32)),0|u,0|A,0|E),E=u,A=0|L(0,0|n[o>>2],32),b=u,m=0|B(0|(S=0|L(0,0|n[c>>2],32)),0|u,0|A,0|b),b=u,A=0|L(0,0|n[g>>2],32),S=u,S=0|U(0|(P=0|B(0|(C=0|L(0,0|n[h>>2],32)),0|u,0|A,0|S)),0|u,0|m,0|b),b=u,m=0|L(0,0|n[i>>2],32),P=u,P=0|U(0|S,0|b,0|(C=0|B(0|(A=0|L(0,0|n[T>>2],32)),0|u,0|m,0|P)),0|u),C=u,b=0|L(0,0|n[y>>2],32),S=u,S=0|U(0|P,0|C,0|(A=0|B(0|(m=0|L(0,0|n[a>>2],32)),0|u,0|b,0|S)),0|u),S=0|U(0|(A=0|x(0|S,0|u,1)),0|u,0|d,0|E),E=u,d=0|L(0,0|n[f>>2],32),A=u,A=0|U(0|S,0|E,0|(P=0|B(0|(C=0|L(0,0|n[_>>2],32)),0|u,0|d,0|A)),0|u),P=u,E=0|L(0,0|n[v>>2],32),S=u,S=0|U(0|A,0|P,0|(C=0|B(0|(d=0|L(0,0|n[s>>2],32)),0|u,0|E,0|S)),0|u),C=u,P=0|L(0,0|n[t>>2],32),A=u,A=0|U(0|S,0|C,0|(b=0|B(0|(d=0|L(0,0|n[(E=r+64|0)>>2],32)),0|u,0|P,0|A)),0|u),b=u,S=0|L(0,0|n[(C=t+64|0)>>2],32),P=u,P=0|U(0|A,0|b,0|(m=0|B(0|(d=0|L(0,0|n[r>>2],32)),0|u,0|S,0|P)),0|u),n[(m=e+64|0)>>2]=P,n[m+4>>2]=u,m=0|L(0,0|n[l>>2],32),P=u,A=0|B(0|(b=0|L(0,0|n[c>>2],32)),0|u,0|m,0|P),P=u,m=0|L(0,0|n[g>>2],32),b=u,b=0|U(0|(d=0|B(0|(S=0|L(0,0|n[p>>2],32)),0|u,0|m,0|b)),0|u,0|A,0|P),P=u,A=0|L(0,0|n[o>>2],32),d=u,d=0|U(0|b,0|P,0|(S=0|B(0|(m=0|L(0,0|n[_>>2],32)),0|u,0|A,0|d)),0|u),S=u,P=0|L(0,0|n[v>>2],32),b=u,b=0|U(0|d,0|S,0|(m=0|B(0|(A=0|L(0,0|n[h>>2],32)),0|u,0|P,0|b)),0|u),m=u,S=0|L(0,0|n[f>>2],32),d=u,d=0|U(0|b,0|m,0|(A=0|B(0|(P=0|L(0,0|n[T>>2],32)),0|u,0|S,0|d)),0|u),A=u,m=0|L(0,0|n[y>>2],32),b=u,b=0|U(0|d,0|A,0|(P=0|B(0|(S=0|L(0,0|n[s>>2],32)),0|u,0|m,0|b)),0|u),P=u,A=0|L(0,0|n[i>>2],32),d=u,d=0|U(0|b,0|P,0|(S=0|B(0|(m=0|L(0,0|n[E>>2],32)),0|u,0|A,0|d)),0|u),S=u,P=0|L(0,0|n[C>>2],32),b=u,b=0|U(0|d,0|S,0|(m=0|B(0|(A=0|L(0,0|n[a>>2],32)),0|u,0|P,0|b)),0|u),m=u,S=0|L(0,0|n[t>>2],32),d=u,d=0|U(0|b,0|m,0|(O=0|B(0|(A=0|L(0,0|n[(P=r+72|0)>>2],32)),0|u,0|S,0|d)),0|u),O=u,t=0|L(0,0|n[(m=t+72|0)>>2],32),b=u,b=0|U(0|d,0|O,0|(r=0|B(0|(S=0|L(0,0|n[r>>2],32)),0|u,0|t,0|b)),0|u),n[(r=e+72|0)>>2]=b,n[r+4>>2]=u,r=0|L(0,0|n[g>>2],32),b=u,d=0|B(0|(O=0|L(0,0|n[c>>2],32)),0|u,0|r,0|b),b=u,r=0|L(0,0|n[o>>2],32),O=u,O=0|U(0|(S=0|B(0|(t=0|L(0,0|n[T>>2],32)),0|u,0|r,0|O)),0|u,0|d,0|b),b=u,d=0|L(0,0|n[y>>2],32),S=u,S=0|U(0|O,0|b,0|(t=0|B(0|(r=0|L(0,0|n[h>>2],32)),0|u,0|d,0|S)),0|u),t=u,b=0|L(0,0|n[i>>2],32),i=u,i=0|U(0|S,0|t,0|(d=0|B(0|(O=0|L(0,0|n[P>>2],32)),0|u,0|b,0|i)),0|u),d=u,t=0|L(0,0|n[m>>2],32),S=u,a=0|x(0|(S=0|U(0|i,0|d,0|(a=0|B(0|(b=0|L(0,0|n[a>>2],32)),0|u,0|t,0|S)),0|u)),0|u,1),S=u,d=0|L(0,0|n[l>>2],32),i=u,i=0|U(0|a,0|S,0|(b=0|B(0|(t=0|L(0,0|n[_>>2],32)),0|u,0|d,0|i)),0|u),b=u,S=0|L(0,0|n[v>>2],32),a=u,a=0|U(0|i,0|b,0|(t=0|B(0|(d=0|L(0,0|n[p>>2],32)),0|u,0|S,0|a)),0|u),t=u,b=0|L(0,0|n[f>>2],32),i=u,i=0|U(0|a,0|t,0|(d=0|B(0|(S=0|L(0,0|n[E>>2],32)),0|u,0|b,0|i)),0|u),d=u,t=0|L(0,0|n[C>>2],32),a=u,a=0|U(0|i,0|d,0|(S=0|B(0|(b=0|L(0,0|n[s>>2],32)),0|u,0|t,0|a)),0|u),n[(S=e+80|0)>>2]=a,n[S+4>>2]=u,S=0|L(0,0|n[g>>2],32),a=u,i=0|B(0|(d=0|L(0,0|n[_>>2],32)),0|u,0|S,0|a),a=u,S=0|L(0,0|n[v>>2],32),d=u,d=0|U(0|(b=0|B(0|(t=0|L(0,0|n[c>>2],32)),0|u,0|S,0|d)),0|u,0|i,0|a),a=u,i=0|L(0,0|n[l>>2],32),b=u,b=0|U(0|d,0|a,0|(t=0|B(0|(S=0|L(0,0|n[T>>2],32)),0|u,0|i,0|b)),0|u),t=u,a=0|L(0,0|n[y>>2],32),d=u,d=0|U(0|b,0|t,0|(S=0|B(0|(i=0|L(0,0|n[p>>2],32)),0|u,0|a,0|d)),0|u),S=u,t=0|L(0,0|n[o>>2],32),b=u,b=0|U(0|d,0|S,0|(i=0|B(0|(a=0|L(0,0|n[E>>2],32)),0|u,0|t,0|b)),0|u),i=u,S=0|L(0,0|n[C>>2],32),d=u,d=0|U(0|b,0|i,0|(a=0|B(0|(t=0|L(0,0|n[h>>2],32)),0|u,0|S,0|d)),0|u),a=u,i=0|L(0,0|n[f>>2],32),f=u,f=0|U(0|d,0|a,0|(S=0|B(0|(b=0|L(0,0|n[P>>2],32)),0|u,0|i,0|f)),0|u),S=u,a=0|L(0,0|n[m>>2],32),d=u,d=0|U(0|f,0|S,0|(s=0|B(0|(i=0|L(0,0|n[s>>2],32)),0|u,0|a,0|d)),0|u),n[(s=e+88|0)>>2]=d,n[s+4>>2]=u,s=0|L(0,0|n[v>>2],32),d=u,f=0|B(0|(S=0|L(0,0|n[_>>2],32)),0|u,0|s,0|d),d=u,s=0|L(0,0|n[g>>2],32),S=u,i=0|B(0|(a=0|L(0,0|n[T>>2],32)),0|u,0|s,0|S),S=u,s=0|L(0,0|n[y>>2],32),a=u,a=0|U(0|(t=0|B(0|(b=0|L(0,0|n[c>>2],32)),0|u,0|s,0|a)),0|u,0|i,0|S),S=u,i=0|L(0,0|n[o>>2],32),o=u,o=0|U(0|a,0|S,0|(s=0|B(0|(t=0|L(0,0|n[P>>2],32)),0|u,0|i,0|o)),0|u),s=u,S=0|L(0,0|n[m>>2],32),a=u,a=0|U(0|o,0|s,0|(h=0|B(0|(i=0|L(0,0|n[h>>2],32)),0|u,0|S,0|a)),0|u),a=0|U(0|(h=0|x(0|a,0|u,1)),0|u,0|f,0|d),d=u,f=0|L(0,0|n[l>>2],32),h=u,h=0|U(0|a,0|d,0|(o=0|B(0|(s=0|L(0,0|n[E>>2],32)),0|u,0|f,0|h)),0|u),o=u,d=0|L(0,0|n[C>>2],32),a=u,a=0|U(0|h,0|o,0|(s=0|B(0|(f=0|L(0,0|n[p>>2],32)),0|u,0|d,0|a)),0|u),n[(s=e+96|0)>>2]=a,n[s+4>>2]=u,s=0|L(0,0|n[v>>2],32),a=u,h=0|B(0|(o=0|L(0,0|n[T>>2],32)),0|u,0|s,0|a),a=u,s=0|L(0,0|n[y>>2],32),o=u,o=0|U(0|(f=0|B(0|(d=0|L(0,0|n[_>>2],32)),0|u,0|s,0|o)),0|u,0|h,0|a),a=u,h=0|L(0,0|n[g>>2],32),f=u,f=0|U(0|o,0|a,0|(d=0|B(0|(s=0|L(0,0|n[E>>2],32)),0|u,0|h,0|f)),0|u),d=u,a=0|L(0,0|n[C>>2],32),o=u,o=0|U(0|f,0|d,0|(s=0|B(0|(h=0|L(0,0|n[c>>2],32)),0|u,0|a,0|o)),0|u),s=u,d=0|L(0,0|n[l>>2],32),l=u,l=0|U(0|o,0|s,0|(a=0|B(0|(f=0|L(0,0|n[P>>2],32)),0|u,0|d,0|l)),0|u),a=u,s=0|L(0,0|n[m>>2],32),o=u,o=0|U(0|l,0|a,0|(p=0|B(0|(d=0|L(0,0|n[p>>2],32)),0|u,0|s,0|o)),0|u),n[(p=e+104|0)>>2]=o,n[p+4>>2]=u,p=0|L(0,0|n[y>>2],32),o=u,l=0|B(0|(a=0|L(0,0|n[T>>2],32)),0|u,0|p,0|o),o=u,p=0|L(0,0|n[g>>2],32),g=u,g=0|U(0|(s=0|B(0|(a=0|L(0,0|n[P>>2],32)),0|u,0|p,0|g)),0|u,0|l,0|o),o=u,l=0|L(0,0|n[m>>2],32),s=u,c=0|x(0|(s=0|U(0|g,0|o,0|(c=0|B(0|(p=0|L(0,0|n[c>>2],32)),0|u,0|l,0|s)),0|u)),0|u,1),s=u,o=0|L(0,0|n[v>>2],32),g=u,g=0|U(0|c,0|s,0|(p=0|B(0|(l=0|L(0,0|n[E>>2],32)),0|u,0|o,0|g)),0|u),p=u,s=0|L(0,0|n[C>>2],32),c=u,c=0|U(0|g,0|p,0|(l=0|B(0|(o=0|L(0,0|n[_>>2],32)),0|u,0|s,0|c)),0|u),n[(l=e+112|0)>>2]=c,n[l+4>>2]=u,l=0|L(0,0|n[y>>2],32),c=u,g=0|B(0|(p=0|L(0,0|n[E>>2],32)),0|u,0|l,0|c),c=u,l=0|L(0,0|n[C>>2],32),p=u,p=0|U(0|(o=0|B(0|(s=0|L(0,0|n[T>>2],32)),0|u,0|l,0|p)),0|u,0|g,0|c),c=u,g=0|L(0,0|n[v>>2],32),v=u,v=0|U(0|p,0|c,0|(l=0|B(0|(o=0|L(0,0|n[P>>2],32)),0|u,0|g,0|v)),0|u),l=u,c=0|L(0,0|n[m>>2],32),p=u,p=0|U(0|v,0|l,0|(_=0|B(0|(g=0|L(0,0|n[_>>2],32)),0|u,0|c,0|p)),0|u),n[(_=e+120|0)>>2]=p,n[_+4>>2]=u,_=0|L(0,0|n[C>>2],32),p=u,v=0|B(0|(l=0|L(0,0|n[E>>2],32)),0|u,0|_,0|p),p=u,_=0|L(0,0|n[y>>2],32),y=u,c=0|B(0|(l=0|L(0,0|n[P>>2],32)),0|u,0|_,0|y),y=u,_=0|L(0,0|n[m>>2],32),l=u,l=0|U(0|(T=0|B(0|(g=0|L(0,0|n[T>>2],32)),0|u,0|_,0|l)),0|u,0|c,0|y),l=0|U(0|(y=0|x(0|l,0|u,1)),0|u,0|v,0|p),n[(p=e+128|0)>>2]=l,n[p+4>>2]=u,p=0|L(0,0|n[C>>2],32),C=u,v=0|B(0|(l=0|L(0,0|n[P>>2],32)),0|u,0|p,0|C),C=u,p=0|L(0,0|n[m>>2],32),l=u,l=0|U(0|(E=0|B(0|(y=0|L(0,0|n[E>>2],32)),0|u,0|p,0|l)),0|u,0|v,0|C),n[(C=e+136|0)>>2]=l,n[C+4>>2]=u,C=0|L(0,0|n[m>>2],31),m=u,P=0|B(0|(l=0|L(0,0|n[P>>2],32)),0|u,0|C,0|m),n[(m=e+144|0)>>2]=P,n[m+4>>2]=u}function O(e,t){e|=0;var r,a,i,o=0,l=0,d=0,c=0,f=0,p=0,h=0,_=0,m=0,g=0,v=0,E=0,y=0,S=0,T=0,b=0,A=0,C=0,P=0,O=0,w=0,M=0,I=0,R=0,D=0,N=0,F=0,G=0,Y=0,K=0,j=0,W=0,V=0,H=0,q=0,z=0,J=0;r=s,s=s+160|0,o=r,c=0|B(0|(a=0|L(0,0|(l=0|n[(t|=0)>>2]),32)),0|(d=u),0|a,0|d),n[(f=o)>>2]=c,n[f+4>>2]=u,f=0|L(0,0|l,31),l=u,m=0|B(0|(h=0|L(0,0|(p=0|n[(c=t+8|0)>>2]),32)),0|(_=u),0|f,0|l),n[(g=i=o+8|0)>>2]=m,n[g+4>>2]=u,g=0|B(0|h,0|_,0|h,0|_),m=u,m=0|x(0|(T=0|U(0|(S=0|B(0|(E=0|L(0,0|n[(v=t+16|0)>>2],32)),0|(y=u),0|a,0|d)),0|u,0|g,0|m)),0|u,1),n[(g=T=o+16|0)>>2]=m,n[g+4>>2]=u,g=0|B(0|E,0|y,0|h,0|_),m=u,m=0|x(0|(P=0|U(0|(C=0|B(0|(b=0|L(0,0|n[(S=t+24|0)>>2],32)),0|(A=u),0|a,0|d)),0|u,0|g,0|m)),0|u,1),n[(g=P=o+24|0)>>2]=m,n[g+4>>2]=u,g=0|B(0|E,0|y,0|E,0|y),m=u,C=0|U(0|(O=0|B(0|b,0|A,0|(C=0|L(0,0|p,30)),0|u)),0|u,0|g,0|m),l=0|U(0|C,0|(m=u),0|(M=0|B(0|(O=0|L(0,0|n[(g=t+32|0)>>2],32)),0|(w=u),0|f,0|l)),0|u),n[(m=M=o+32|0)>>2]=l,n[m+4>>2]=u,m=0|B(0|b,0|A,0|E,0|y),l=u,f=0|U(0|(C=0|B(0|O,0|w,0|h,0|_)),0|u,0|m,0|l),R=0|x(0|(D=0|U(0|f,0|(l=u),0|(R=0|B(0|(C=0|L(0,0|n[(m=t+40|0)>>2],32)),0|(I=u),0|a,0|d)),0|u)),0|u,1),n[(l=D=o+40|0)>>2]=R,n[l+4>>2]=u,l=0|B(0|b,0|A,0|b,0|A),R=u,N=0|U(0|(f=0|B(0|O,0|w,0|E,0|y)),0|u,0|l,0|R),Y=0|U(0|N,0|(R=u),0|(G=0|B(0|(f=0|L(0,0|n[(l=t+48|0)>>2],32)),0|(F=u),0|a,0|d)),0|u),p=0|x(0|(R=0|U(0|Y,0|(G=u),0|(p=0|B(0|C,0|I,0|(R=0|L(0,0|p,31)),0|u)),0|u)),0|u,1),n[(G=R=o+48|0)>>2]=p,n[G+4>>2]=u,G=0|B(0|O,0|w,0|b,0|A),p=u,N=0|U(0|(Y=0|B(0|C,0|I,0|E,0|y)),0|u,0|G,0|p),Y=0|U(0|N,0|(p=u),0|(G=0|B(0|f,0|F,0|h,0|_)),0|u),j=0|x(0|(W=0|U(0|Y,0|(G=u),0|(j=0|B(0|(N=0|L(0,0|n[(p=t+56|0)>>2],32)),0|(K=u),0|a,0|d)),0|u)),0|u,1),n[(G=W=o+56|0)>>2]=j,n[G+4>>2]=u,G=0|B(0|O,0|w,0|O,0|w),j=u,Y=0|B(0|f,0|F,0|E,0|y),V=u,d=0|U(0|(J=0|B(0|(q=0|L(0,0|n[(H=t+64|0)>>2],32)),0|(z=u),0|a,0|d)),0|u,0|Y,0|V),V=u,Y=0|B(0|N,0|K,0|h,0|_),_=u,J=0|U(0|(h=0|B(0|C,0|I,0|b,0|A)),0|u,0|Y,0|_),J=0|U(0|d,0|V,0|(_=0|x(0|J,0|u,1)),0|u),J=0|U(0|(_=0|x(0|J,0|u,1)),0|u,0|G,0|j),n[(G=j=o+64|0)>>2]=J,n[G+4>>2]=u,G=0|B(0|C,0|I,0|O,0|w),J=u,A=0|U(0|(_=0|B(0|f,0|F,0|b,0|A)),0|u,0|G,0|J),y=0|U(0|A,0|(J=u),0|(G=0|B(0|N,0|K,0|E,0|y)),0|u),E=0|U(0|y,0|(G=u),0|(A=0|B(0|q,0|z,0|(J=0|L(0,0|n[c>>2],32)),0|(c=u))),0|u),A=u,G=0|L(0,0|n[t>>2],32),y=u,V=0|x(0|(y=0|U(0|E,0|A,0|(V=0|B(0|(t=0|L(0,0|(_=0|n[t+72>>2]),32)),0|(b=u),0|G,0|y)),0|u)),0|u,1),n[(y=o+72|0)>>2]=V,n[y+4>>2]=u,y=0|B(0|C,0|I,0|C,0|I),V=u,w=0|U(0|(A=0|B(0|f,0|F,0|O,0|w)),0|u,0|y,0|V),O=0|U(0|w,0|(V=u),0|(A=0|B(0|q,0|z,0|(y=0|L(0,0|n[v>>2],32)),0|(v=u))),0|u),A=u,w=0|B(0|N,0|K,0|(V=0|L(0,0|n[S>>2],32)),0|(S=u)),E=u,E=0|x(0|(c=0|U(0|(G=0|B(0|t,0|b,0|J,0|c)),0|u,0|w,0|E)),0|u,1),E=0|x(0|(c=0|U(0|O,0|A,0|E,0|u)),0|u,1),n[(A=c=o+80|0)>>2]=E,n[A+4>>2]=u,A=0|B(0|f,0|F,0|C,0|I),I=u,O=0|U(0|(E=0|B(0|N,0|K,0|(C=0|L(0,0|n[g>>2],32)),0|(g=u))),0|u,0|A,0|I),E=0|U(0|O,0|(I=u),0|(A=0|B(0|q,0|z,0|V,0|S)),0|u),A=0|x(0|(v=0|U(0|E,0|(A=u),0|(I=0|B(0|t,0|b,0|y,0|v)),0|u)),0|(I=u),1),E=u,n[(y=o+88|0)>>2]=A,n[y+4>>2]=E,y=0|B(0|f,0|F,0|f,0|F),F=u,f=0|B(0|q,0|z,0|C,0|g),O=u,J=0|B(0|N,0|K,0|(m=0|L(0,0|(w=0|n[m>>2]),32)),0|(G=u)),d=u,S=0|U(0|(Y=0|B(0|t,0|b,0|V,0|S)),0|u,0|J,0|d),S=0|U(0|(d=0|x(0|S,0|u,1)),0|u,0|f,0|O),S=0|U(0|(O=0|x(0|S,0|u,1)),0|u,0|y,0|F),F=u,n[(y=o+96|0)>>2]=S,n[y+4>>2]=F,O=0|B(0|N,0|K,0|(y=0|L(0,0|n[l>>2],32)),0|(l=u)),K=u,G=0|U(0|(N=0|B(0|q,0|z,0|m,0|G)),0|u,0|O,0|K),K=0|x(0|(g=0|U(0|G,0|(K=u),0|(O=0|B(0|t,0|b,0|C,0|g)),0|u)),0|(O=u),1),G=u,n[(C=o+104|0)>>2]=K,n[C+4>>2]=G,m=0|B(0|(p=0|L(0,0|(C=0|n[p>>2]),32)),0|(N=u),0|p,0|N),f=u,z=0|U(0|(d=0|B(0|q,0|z,0|y,0|l)),0|u,0|m,0|f),f=0|x(0|(m=0|U(0|z,0|(f=u),0|(w=0|B(0|t,0|b,0|(m=0|L(0,0|w,31)),0|u)),0|u)),0|(w=u),1),z=u,n[(d=o+112|0)>>2]=f,n[d+4>>2]=z,J=0|B(0|(H=0|L(0,0|(d=0|n[H>>2]),32)),0|(q=u),0|p,0|N),N=u,J=0|x(0|(l=0|U(0|(p=0|B(0|t,0|b,0|y,0|l)),0|u,0|J,0|N)),0|(N=u),1),p=u,n[(y=o+120|0)>>2]=J,n[y+4>>2]=p,y=0|B(0|H,0|q,0|H,0|q),q=u,H=0|U(0|(C=0|B(0|t,0|b,0|(H=0|L(0,0|C,30)),0|u)),0|u,0|y,0|q),q=u,n[(y=o+128|0)>>2]=H,n[y+4>>2]=q,d=0|B(0|t,0|b,0|(y=0|L(0,0|d,31)),0|u),y=u,n[(C=o+136|0)>>2]=d,n[C+4>>2]=y,_=0|B(0|(C=0|L(0,0|_,31)),0|u,0|t,0|b),b=u,n[(t=o+144|0)>>2]=_,n[t+4>>2]=b,C=0|n[(t=j)>>2],Y=0|n[t+4>>2],t=0|B(0|_,0|b,18,0),V=u,h=0|U(0|_,0|b,0|C,0|Y),Y=0|U(0|h,0|u,0|t,0|V),n[(V=j)>>2]=Y,n[V+4>>2]=u,Y=0|n[(V=W)>>2],j=0|n[V+4>>2],V=0|B(0|d,0|y,18,0),t=u,h=0|U(0|Y,0|j,0|d,0|y),y=0|U(0|h,0|u,0|V,0|t),n[(t=W)>>2]=y,n[t+4>>2]=u,y=0|n[(t=R)>>2],W=0|n[t+4>>2],t=0|B(0|H,0|q,18,0),V=u,h=0|U(0|y,0|W,0|H,0|q),q=0|U(0|h,0|u,0|t,0|V),n[(V=R)>>2]=q,n[V+4>>2]=u,q=0|n[(V=D)>>2],R=0|n[V+4>>2],V=0|B(0|l,0|N,36,0),N=u,l=0|U(0|q,0|R,0|J,0|p),p=0|U(0|l,0|u,0|V,0|N),n[(N=D)>>2]=p,n[N+4>>2]=u,p=0|n[(N=M)>>2],D=0|n[N+4>>2],N=0|B(0|m,0|w,36,0),w=u,m=0|U(0|p,0|D,0|f,0|z),z=0|U(0|m,0|u,0|N,0|w),n[(w=M)>>2]=z,n[w+4>>2]=u,z=0|n[(w=P)>>2],M=0|n[w+4>>2],w=0|B(0|g,0|O,36,0),O=u,g=0|U(0|z,0|M,0|K,0|G),G=0|U(0|g,0|u,0|w,0|O),n[(O=P)>>2]=G,n[O+4>>2]=u,G=0|n[(O=T)>>2],P=0|n[O+4>>2],O=0|B(0|S,0|F,18,0),w=u,g=0|U(0|G,0|P,0|S,0|F),F=0|U(0|g,0|u,0|O,0|w),n[(w=T)>>2]=F,n[w+4>>2]=u,F=0|n[(w=i)>>2],T=0|n[w+4>>2],w=0|B(0|v,0|I,36,0),I=u,v=0|U(0|F,0|T,0|A,0|E),E=0|U(0|v,0|u,0|w,0|I),n[(I=i)>>2]=E,n[I+4>>2]=u,E=0|n[(I=c)>>2],w=0|n[I+4>>2],v=0|n[(I=o)>>2],A=0|n[I+4>>2],I=0|B(0|E,0|w,18,0),T=u,F=0|U(0|v,0|A,0|E,0|w),w=0|U(0|F,0|u,0|I,0|T),T=u,n[(I=o)>>2]=w,n[I+4>>2]=T,n[(I=c)>>2]=0,n[I+4>>2]=0,I=T,T=w,w=0;do{v=0|k(0|T,0|I,0|(A=0|x(0|(E=0|L(0|(F=0|U(I>>31>>>6|0,0,0|T,0|I)),0|u,26)),0|(F=u),26)),0|u),n[(A=o+(w<<3)|0)>>2]=v,n[A+4>>2]=u,S=0|k(0|(O=0|U(0|E,0|F,0|n[(v=A=o+((1|w)<<3)|0)>>2],0|n[v+4>>2])),0|(v=u),0|(g=0|x(0|(E=0|L(0|(F=0|U(v>>31>>>7|0,0,0|O,0|v)),0|u,25)),0|(F=u),25)),0|u),n[(g=A)>>2]=S,n[g+4>>2]=u,T=0|U(0|E,0|F,0|n[(S=g=o+((w=w+2|0)<<3)|0)>>2],0|n[S+4>>2]),I=u,n[(S=g)>>2]=T,n[S+4>>2]=I}while(w>>>0<10);I=0|n[(w=c)>>2],T=0|n[w+4>>2],S=0|n[(w=o)>>2],g=0|n[w+4>>2],w=0|B(0|I,0|T,18,0),F=u,E=0|U(0|S,0|g,0|I,0|T),T=0|U(0|E,0|u,0|w,0|F),F=u,n[(w=c)>>2]=0,n[w+4>>2]=0,I=0|k(0|T,0|F,0|(E=0|x(0|(c=0|L(0|(w=0|U(F>>31>>>6|0,0,0|T,0|F)),0|u,26)),0|(w=u),26)),0|u),n[(E=o)>>2]=I,n[E+4>>2]=u,I=0|U(0|c,0|w,0|n[(E=i)>>2],0|n[E+4>>2]),n[(E=i)>>2]=I,n[E+4>>2]=u,E=e,e=o,o=E+80|0;do{n[E>>2]=n[e>>2],E=E+4|0,e=e+4|0}while((0|E)<(0|o));s=r}function w(){return 0|(0|n[2]?0|n[60+(0|p())>>2]:56)}function M(e){var t=0;return(e|=0)>>>0>4294963200?(n[(0|w())>>2]=0-e,t=-1):t=e,0|t}function I(e){return 0,0}function R(e){0}function D(e,t,r){t|=0,r|=0;var a,i,o,u,l,d=0,f=0,p=0,h=0,_=0,m=0,g=0,v=0,E=0,y=0,S=0,b=0,C=0,P=0,O=0,w=0;for(a=s,s=s+48|0,i=a+16|0,o=a,d=a+32|0,f=0|n[(u=(e|=0)+28|0)>>2],n[d>>2]=f,p=(0|n[(l=e+20|0)>>2])-f|0,n[d+4>>2]=p,n[d+8>>2]=t,n[d+12>>2]=r,t=e+60|0,f=e+44|0,h=d,d=2,_=p+r|0;;){if(0|n[2]?(T(1,0|e),n[o>>2]=n[t>>2],n[o+4>>2]=h,n[o+8>>2]=d,p=0|M(0|A(146,0|o)),c(0),m=p):(n[i>>2]=n[t>>2],n[i+4>>2]=h,n[i+8>>2]=d,m=0|M(0|A(146,0|i))),(0|_)==(0|m)){g=6;break}if((0|m)<0){v=h,E=d,g=8;break}p=_-m|0,m>>>0<=(y=0|n[h+4>>2])>>>0?2==(0|d)?(n[u>>2]=(0|n[u>>2])+m,S=y,b=m,C=h,P=2):(S=y,b=m,C=h,P=d):(O=0|n[f>>2],n[u>>2]=O,n[l>>2]=O,S=0|n[h+12>>2],b=m-y|0,C=h+8|0,P=d+-1|0),n[C>>2]=(0|n[C>>2])+b,n[C+4>>2]=S-b,h=C,d=P,_=p}return 6==(0|g)?(_=0|n[f>>2],n[e+16>>2]=_+(0|n[e+48>>2]),f=_,n[u>>2]=f,n[l>>2]=f,w=r):8==(0|g)&&(n[e+16>>2]=0,n[u>>2]=0,n[l>>2]=0,n[e>>2]=32|n[e>>2],w=2==(0|E)?0:r-(0|n[v+4>>2])|0),s=a,0|w}function N(e){var t,r,a=0,i=0,s=0,o=0,u=0;return r=(e|=0)+28|0,(0|n[(t=e+20|0)>>2])>>>0>(0|n[r>>2])>>>0&&(K[3&n[e+36>>2]](e,0,0),0==(0|n[t>>2]))?a=-1:((s=0|n[(i=e+4|0)>>2])>>>0<(u=0|n[(o=e+8|0)>>2])>>>0&&K[3&n[e+40>>2]](e,s-u|0,1),n[e+16>>2]=0,n[r>>2]=0,n[t>>2]=0,n[o>>2]=0,n[i>>2]=0,a=0),0|a}function L(e,t,r){return e|=0,t|=0,(0|(r|=0))<32?(u=t>>r,e>>>r|(t&(1<<r)-1)<<32-r):(u=(0|t)<0?-1:0,t>>r-32|0)}function k(e,t,r,a){return(t|=0)-(a|=0)>>>0,0|(u=t-a-((r|=0)>>>0>(e|=0)>>>0|0)>>>0,e-r>>>0|0)}function U(e,t,r,a){var n;return 0|(u=(t|=0)+(a|=0)+((n=(e|=0)+(r|=0)>>>0)>>>0<e>>>0|0)>>>0,0|n)}function F(e,t,r){t|=0;var i,s=0,o=0,u=0;if(i=(e|=0)+(r|=0)|0,(0|r)>=20){if(o=(t&=255)|t<<8|t<<16|t<<24,u=-4&i,s=3&e)for(s=e+4-s|0;(0|e)<(0|s);)a[e>>0]=t,e=e+1|0;for(;(0|e)<(0|u);)n[e>>2]=o,e=e+4|0}for(;(0|e)<(0|i);)a[e>>0]=t,e=e+1|0;return e-r|0}function G(e,t,r){return e|=0,t|=0,(0|(r|=0))<32?(u=t>>>r,e>>>r|(t&(1<<r)-1)<<32-r):(u=0,t>>>r-32|0)}function x(e,t,r){return e|=0,t|=0,(0|(r|=0))<32?(u=t<<r|(e&(1<<r)-1<<32-r)>>>32-r,e<<r):(u=e<<r-32,0)}function B(e,t,r,a){t|=0,a|=0;var n,i;return r=0|function(e,t){var r,a,n,i=0;return e=((a=0|l(i=65535&(t|=0),r=65535&(e|=0)))>>>16)+(0|l(i,n=e>>>16))|0,t=0|l(i=t>>>16,r),0|(u=(e>>>16)+(0|l(i,n))+(((65535&e)+t|0)>>>16)|0,e+t<<16|65535&a|0)}(n=e|=0,e=r|=0),i=u,0|(u=(0|l(t,e))+(0|l(a,n))+i|0&i,0|r)}var Y=[function(e){return 0,d(0),0},function(e){var t,r;return e|=0,t=s,s=s+16|0,n[(r=t)>>2]=n[e+60>>2],e=0|M(0|h(6,0|r)),s=t,0|e}],K=[function(e,t,r){return 0,0,0,d(1),0},function(e,t,r){t|=0,r|=0;var i,o=0;return i=s,s=s+80|0,o=i,n[(e|=0)+36>>2]=3,0==(64&n[e>>2]|0)&&(n[o>>2]=n[e+60>>2],n[o+4>>2]=21505,n[o+8>>2]=i+12,0!=(0|E(54,0|o)))&&(a[e+75>>0]=-1),o=0|D(e,t,r),s=i,0|o},function(e,t,r){e|=0,t|=0,r|=0;var a,i,o,u=0;return a=s,s=s+32|0,o=a+20|0,n[(i=a)>>2]=n[e+60>>2],n[i+4>>2]=0,n[i+8>>2]=t,n[i+12>>2]=o,n[i+16>>2]=r,(0|M(0|S(140,0|i)))<0?(n[o>>2]=-1,u=-1):u=0|n[o>>2],s=a,0|u},D],j=[function(e){d(2)},function(e){0|n[(e|=0)+68>>2]||R()}];return{_curve25519_donna:function(e,t,r){e|=0,r|=0;var o,d,c,f,p,h,_,m,g,v,E,y,S,T,b,A,w,M,I,R,D,N,Y,K,j,W,V,H,q,z,J,Q,X,Z,$,ee,te,re,ae,ne,ie,se,oe,ue,le,de,ce,fe,pe,he,_e,me,ge,ve,Ee,ye,Se,Te,be,Ae=0,Ce=0,Pe=0,Oe=0,we=0,Me=0,Ie=0,Re=0,De=0,Ne=0,Le=0,ke=0,Ue=0,Fe=0,Ge=0,xe=0,Be=0,Ye=0,Ke=0,je=0,We=0,Ve=0,He=0,qe=0,ze=0,Je=0,Qe=0,Xe=0,Ze=0,$e=0,et=0,tt=0,rt=0,at=0,nt=0,it=0,st=0,ot=0,ut=0,lt=0,dt=0,ct=0,ft=0,pt=0,ht=0,_t=0,mt=0,gt=0,vt=0,Et=0,yt=0,St=0,Tt=0,bt=0,At=0,Ct=0,Pt=0,Ot=0,wt=0,Mt=0,It=0,Rt=0,Dt=0,Nt=0,Lt=0,kt=0,Ut=0,Ft=0,Gt=0,xt=0,Bt=0,Yt=0,Kt=0,jt=0,Wt=0,Vt=0,Ht=0,qt=0,zt=0,Jt=0,Qt=0,Xt=0,Zt=0,$t=0,er=0,tr=0,rr=0,ar=0,nr=0,ir=0,sr=0,or=0,ur=0,lr=0,dr=0,cr=0,fr=0,pr=0,hr=0,_r=0,mr=0,gr=0,vr=0,Er=0,yr=0,Sr=0,Tr=0,br=0,Ar=0,Cr=0,Pr=0,Or=0,wr=0,Mr=0,Ir=0,Rr=0,Dr=0,Nr=0;o=s,s=s+2640|0,Ae=o+2456|0,Ce=o+2304|0,Pe=o+2152|0,Oe=o+2e3|0,we=o+1848|0,Me=o+1696|0,Ie=o+1544|0,Re=o+1392|0,De=o+1240|0,Ne=o+1088|0,Le=o+936|0,ke=o+784|0,Ue=o+632|0,Fe=o+480|0,Ge=o+328|0,d=o+248|0,xe=o+168|0,Be=o+80|0,Ye=o,je=t|=0,t=(Ke=c=o+2608|0)+32|0;do{a[Ke>>0]=0|a[je>>0],Ke=Ke+1|0,je=je+1|0}while((0|Ke)<(0|t));a[c>>0]=248&(0|i[c>>0]),a[(We=c+31|0)>>0]=63&(0|i[We>>0])|64,We=0|i[r>>0],Ve=0|x(0|i[r+1>>0],0,8),He=u,qe=0|x(0|i[r+2>>0],0,16),ze=He|u,Je=0|x(0|(He=0|i[r+3>>0]),0,24),n[(Qe=d)>>2]=Ve|We|qe|50331648&Je,n[Qe+4>>2]=ze,ze=0|x(0|i[r+4>>0],0,8),Qe=u,Je=0|x(0|i[r+5>>0],0,16),qe=Qe|u,Ve=0|G(ze|He|Je|(We=0|x(0|(Qe=0|i[r+6>>0]),0,24))|0,qe|u|0,2),n[(qe=d+8|0)>>2]=33554431&Ve,n[qe+4>>2]=0,qe=0|x(0|i[r+7>>0],0,8),Ve=u,We=0|x(0|i[r+8>>0],0,16),Je=Ve|u,ze=0|G(qe|Qe|We|(He=0|x(0|(Ve=0|i[r+9>>0]),0,24))|0,Je|u|0,3),n[(Je=d+16|0)>>2]=67108863&ze,n[Je+4>>2]=0,Je=0|x(0|i[r+10>>0],0,8),ze=u,He=0|x(0|i[r+11>>0],0,16),We=ze|u,qe=0|G(Je|Ve|He|(Qe=0|x(0|(ze=0|i[r+12>>0]),0,24))|0,We|u|0,5),n[(We=d+24|0)>>2]=33554431&qe,n[We+4>>2]=0,We=0|x(0|i[r+13>>0],0,8),qe=u,Qe=0|x(0|i[r+14>>0],0,16),He=qe|u,Ve=0|G(We|ze|Qe|(qe=0|x(0|i[r+15>>0],0,24))|0,He|u|0,6),n[(He=d+32|0)>>2]=67108863&Ve,n[He+4>>2]=0,He=0|i[r+16>>0],Ve=0|x(0|i[r+17>>0],0,8),qe=u,Qe=0|x(0|i[r+18>>0],0,16),ze=qe|u,We=0|x(0|(qe=0|i[r+19>>0]),0,24),n[(Je=d+40|0)>>2]=Ve|He|Qe|16777216&We,n[Je+4>>2]=ze,ze=0|x(0|i[r+20>>0],0,8),Je=u,We=0|x(0|i[r+21>>0],0,16),Qe=Je|u,Ve=0|G(ze|qe|We|(He=0|x(0|(Je=0|i[r+22>>0]),0,24))|0,Qe|u|0,1),n[(Qe=d+48|0)>>2]=67108863&Ve,n[Qe+4>>2]=0,Qe=0|x(0|i[r+23>>0],0,8),Ve=u,He=0|x(0|i[r+24>>0],0,16),We=Ve|u,ze=0|G(Qe|Je|He|(qe=0|x(0|(Ve=0|i[r+25>>0]),0,24))|0,We|u|0,3),n[(We=d+56|0)>>2]=33554431&ze,n[We+4>>2]=0,We=0|x(0|i[r+26>>0],0,8),ze=u,qe=0|x(0|i[r+27>>0],0,16),He=ze|u,Qe=0|G(We|Ve|qe|(Je=0|x(0|(ze=0|i[r+28>>0]),0,24))|0,He|u|0,4),n[(He=d+64|0)>>2]=67108863&Qe,n[He+4>>2]=0,He=0|x(0|i[r+29>>0],0,8),Qe=u,Je=0|x(0|i[r+30>>0],0,16),qe=Qe|u,r=0|G(He|ze|Je|(Qe=0|x(0|i[r+31>>0],0,24))|0,qe|u|0,6),n[(qe=d+72|0)>>2]=33554431&r,n[qe+4>>2]=0,F(0|De,0,152),n[(qe=De)>>2]=1,n[qe+4>>2]=0,F(0|Ne,0,152),n[(qe=Ne)>>2]=1,n[qe+4>>2]=0,F(0|Le,0,152),F(0|ke,0,152),F(0|Ue,0,152),n[(qe=Ue)>>2]=1,n[qe+4>>2]=0,F(0|Fe,0,152),F(0|Ge,0,152),n[(qe=Ge)>>2]=1,n[qe+4>>2]=0,t=(Ke=Re+80|0)+72|0;do{n[Ke>>2]=0,Ke=Ke+4|0}while((0|Ke)<(0|t));je=d,t=(Ke=Re)+80|0;do{n[Ke>>2]=n[je>>2],Ke=Ke+4|0,je=je+4|0}while((0|Ke)<(0|t));for(qe=Oe+144|0,r=Oe+64|0,Qe=Oe+136|0,Je=Oe+56|0,ze=Oe+128|0,He=Oe+48|0,Ve=Oe+120|0,We=Oe+40|0,f=Oe+112|0,p=Oe+32|0,h=Oe+104|0,_=Oe+24|0,m=Oe+96|0,g=Oe+16|0,v=Oe+88|0,E=Oe+8|0,y=Oe+80|0,S=we+144|0,T=we+64|0,b=we+136|0,A=we+56|0,w=we+128|0,M=we+48|0,I=we+120|0,R=we+40|0,D=we+112|0,N=we+32|0,Y=we+104|0,K=we+24|0,j=we+96|0,W=we+16|0,V=we+88|0,H=we+8|0,q=we+80|0,z=Oe+72|0,J=we+72|0,Q=Ce+8|0,X=Pe+8|0,Z=Ce+16|0,$=Pe+16|0,ee=Ce+24|0,te=Pe+24|0,re=Ce+32|0,ae=Pe+32|0,ne=Ce+40|0,ie=Pe+40|0,se=Ce+48|0,oe=Pe+48|0,ue=Ce+56|0,le=Pe+56|0,de=Ce+64|0,ce=Pe+64|0,fe=Ce+72|0,pe=Pe+72|0,he=Ae+80|0,_e=Ae+8|0,me=Ae+16|0,ge=Ae+24|0,ve=Ae+32|0,Ee=Ae+40|0,ye=Ae+48|0,Se=Ae+56|0,Te=Ae+64|0,be=Ae+72|0,Xe=0,Ze=Re,$e=ke,ke=De,et=Ue,Ue=Ne,tt=Fe,Fe=Le,Le=Ge;;){for(Ge=0|a[c+(31-Xe)>>0],rt=0,at=Ze,nt=$e,it=ke,st=et,ot=Ue,ut=tt,lt=Fe,dt=Le;;){ft=0|k(0,0,(ct=255&Ge)>>>7|0,0),pt=u,ht=0;do{gt=0|n[(mt=_t=ot+(ht<<3)|0)>>2],vt=0|n[mt+4>>2],yt=0|n[(Et=mt=at+(ht<<3)|0)>>2],Tt=((St=0|n[Et+4>>2])^vt)&pt,vt=0|L(0,(Et=(yt^gt)&ft)^gt|0,32),n[(gt=_t)>>2]=vt,n[gt+4>>2]=u,gt=0|L(0,Et^yt|0,32),n[(yt=mt)>>2]=gt,n[yt+4>>2]=u,ht=ht+1|0}while(10!=(0|ht));bt=0;do{gt=0|n[(yt=ht=lt+(bt<<3)|0)>>2],mt=0|n[yt+4>>2],vt=0|n[(Et=yt=it+(bt<<3)|0)>>2],St=((_t=0|n[Et+4>>2])^mt)&pt,mt=0|L(0,(Et=(vt^gt)&ft)^gt|0,32),n[(gt=ht)>>2]=mt,n[gt+4>>2]=u,gt=0|L(0,Et^vt|0,32),n[(vt=yt)>>2]=gt,n[vt+4>>2]=u,bt=bt+1|0}while(10!=(0|bt));gt=0|n[(vt=ot)>>2],yt=0|n[vt+4>>2],mt=0|n[(Et=vt=ot+8|0)>>2],ht=0|n[Et+4>>2],St=0|n[(_t=Et=ot+16|0)>>2],Tt=0|n[_t+4>>2],Ct=0|n[(At=_t=ot+24|0)>>2],Pt=0|n[At+4>>2],wt=0|n[(Ot=At=ot+32|0)>>2],Mt=0|n[Ot+4>>2],Rt=0|n[(It=Ot=ot+40|0)>>2],Dt=0|n[It+4>>2],Lt=0|n[(Nt=It=ot+48|0)>>2],kt=0|n[Nt+4>>2],Ft=0|n[(Ut=Nt=ot+56|0)>>2],Gt=0|n[Ut+4>>2],Bt=0|n[(xt=Ut=ot+64|0)>>2],Yt=0|n[xt+4>>2],jt=0|n[(Kt=xt=ot+72|0)>>2],Wt=0|n[Kt+4>>2],Kt=0|U(0|(Vt=0|n[(Kt=lt)>>2]),0|(Ht=0|n[Kt+4>>2]),0|gt,0|yt),n[(qt=ot)>>2]=Kt,n[qt+4>>2]=u,Kt=0|U(0|(zt=0|n[(Kt=qt=lt+8|0)>>2]),0|(Jt=0|n[Kt+4>>2]),0|mt,0|ht),n[(Qt=vt)>>2]=Kt,n[Qt+4>>2]=u,Kt=0|U(0|(vt=0|n[(Kt=Qt=lt+16|0)>>2]),0|(Xt=0|n[Kt+4>>2]),0|St,0|Tt),n[(Zt=Et)>>2]=Kt,n[Zt+4>>2]=u,Kt=0|U(0|(Et=0|n[(Kt=Zt=lt+24|0)>>2]),0|($t=0|n[Kt+4>>2]),0|Ct,0|Pt),n[(er=_t)>>2]=Kt,n[er+4>>2]=u,Kt=0|U(0|(_t=0|n[(Kt=er=lt+32|0)>>2]),0|(tr=0|n[Kt+4>>2]),0|wt,0|Mt),n[(rr=At)>>2]=Kt,n[rr+4>>2]=u,Kt=0|U(0|(At=0|n[(Kt=rr=lt+40|0)>>2]),0|(ar=0|n[Kt+4>>2]),0|Rt,0|Dt),n[(nr=Ot)>>2]=Kt,n[nr+4>>2]=u,Kt=0|U(0|(Ot=0|n[(Kt=nr=lt+48|0)>>2]),0|(ir=0|n[Kt+4>>2]),0|Lt,0|kt),n[(sr=It)>>2]=Kt,n[sr+4>>2]=u,Kt=0|U(0|(It=0|n[(Kt=sr=lt+56|0)>>2]),0|(or=0|n[Kt+4>>2]),0|Ft,0|Gt),n[(ur=Nt)>>2]=Kt,n[ur+4>>2]=u,Kt=0|U(0|(Nt=0|n[(Kt=ur=lt+64|0)>>2]),0|(lr=0|n[Kt+4>>2]),0|Bt,0|Yt),n[(dr=Ut)>>2]=Kt,n[dr+4>>2]=u,Kt=0|U(0|(Ut=0|n[(Kt=dr=lt+72|0)>>2]),0|(cr=0|n[Kt+4>>2]),0|jt,0|Wt),n[(fr=xt)>>2]=Kt,n[fr+4>>2]=u,fr=0|k(0|gt,0|yt,0|Vt,0|Ht),n[(Ht=lt)>>2]=fr,n[Ht+4>>2]=u,Ht=0|k(0|mt,0|ht,0|zt,0|Jt),n[(Jt=qt)>>2]=Ht,n[Jt+4>>2]=u,Jt=0|k(0|St,0|Tt,0|vt,0|Xt),n[(Xt=Qt)>>2]=Jt,n[Xt+4>>2]=u,Xt=0|k(0|Ct,0|Pt,0|Et,0|$t),n[($t=Zt)>>2]=Xt,n[$t+4>>2]=u,$t=0|k(0|wt,0|Mt,0|_t,0|tr),n[(tr=er)>>2]=$t,n[tr+4>>2]=u,tr=0|k(0|Rt,0|Dt,0|At,0|ar),n[(ar=rr)>>2]=tr,n[ar+4>>2]=u,ar=0|k(0|Lt,0|kt,0|Ot,0|ir),n[(ir=nr)>>2]=ar,n[ir+4>>2]=u,ir=0|k(0|Ft,0|Gt,0|It,0|or),n[(or=sr)>>2]=ir,n[or+4>>2]=u,or=0|k(0|Bt,0|Yt,0|Nt,0|lr),n[(lr=ur)>>2]=or,n[lr+4>>2]=u,lr=0|k(0|jt,0|Wt,0|Ut,0|cr),n[(cr=dr)>>2]=lr,n[cr+4>>2]=u,lr=0|n[(cr=at)>>2],dr=0|n[cr+4>>2],Wt=0|n[(Ut=cr=at+8|0)>>2],jt=0|n[Ut+4>>2],ur=0|n[(or=Ut=at+16|0)>>2],Nt=0|n[or+4>>2],Bt=0|n[(Yt=or=at+24|0)>>2],ir=0|n[Yt+4>>2],It=0|n[(sr=Yt=at+32|0)>>2],Gt=0|n[sr+4>>2],ar=0|n[(Ft=sr=at+40|0)>>2],nr=0|n[Ft+4>>2],kt=0|n[(Ot=Ft=at+48|0)>>2],Lt=0|n[Ot+4>>2],rr=0|n[(tr=Ot=at+56|0)>>2],At=0|n[tr+4>>2],Rt=0|n[(Dt=tr=at+64|0)>>2],$t=0|n[Dt+4>>2],_t=0|n[(er=Dt=at+72|0)>>2],Mt=0|n[er+4>>2],er=0|U(0|(wt=0|n[(er=it)>>2]),0|(Xt=0|n[er+4>>2]),0|lr,0|dr),n[(Zt=at)>>2]=er,n[Zt+4>>2]=u,er=0|U(0|(Et=0|n[(er=Zt=it+8|0)>>2]),0|(Pt=0|n[er+4>>2]),0|Wt,0|jt),n[(Ct=cr)>>2]=er,n[Ct+4>>2]=u,er=0|U(0|(cr=0|n[(er=Ct=it+16|0)>>2]),0|(Jt=0|n[er+4>>2]),0|ur,0|Nt),n[(Qt=Ut)>>2]=er,n[Qt+4>>2]=u,er=0|U(0|(Ut=0|n[(er=Qt=it+24|0)>>2]),0|(vt=0|n[er+4>>2]),0|Bt,0|ir),n[(Tt=or)>>2]=er,n[Tt+4>>2]=u,er=0|U(0|(or=0|n[(er=Tt=it+32|0)>>2]),0|(St=0|n[er+4>>2]),0|It,0|Gt),n[(Ht=Yt)>>2]=er,n[Ht+4>>2]=u,er=0|U(0|(Yt=0|n[(er=Ht=it+40|0)>>2]),0|(qt=0|n[er+4>>2]),0|ar,0|nr),n[(zt=sr)>>2]=er,n[zt+4>>2]=u,er=0|U(0|(sr=0|n[(er=zt=it+48|0)>>2]),0|(ht=0|n[er+4>>2]),0|kt,0|Lt),n[(mt=Ft)>>2]=er,n[mt+4>>2]=u,er=0|U(0|(Ft=0|n[(er=mt=it+56|0)>>2]),0|(fr=0|n[er+4>>2]),0|rr,0|At),n[(Vt=Ot)>>2]=er,n[Vt+4>>2]=u,er=0|U(0|(Ot=0|n[(er=Vt=it+64|0)>>2]),0|(yt=0|n[er+4>>2]),0|Rt,0|$t),n[(gt=tr)>>2]=er,n[gt+4>>2]=u,er=0|U(0|(tr=0|n[(er=gt=it+72|0)>>2]),0|(Kt=0|n[er+4>>2]),0|_t,0|Mt),n[(xt=Dt)>>2]=er,n[xt+4>>2]=u,xt=0|k(0|lr,0|dr,0|wt,0|Xt),n[(Xt=it)>>2]=xt,n[Xt+4>>2]=u,Xt=0|k(0|Wt,0|jt,0|Et,0|Pt),n[(Pt=Zt)>>2]=Xt,n[Pt+4>>2]=u,Pt=0|k(0|ur,0|Nt,0|cr,0|Jt),n[(Jt=Ct)>>2]=Pt,n[Jt+4>>2]=u,Jt=0|k(0|Bt,0|ir,0|Ut,0|vt),n[(vt=Qt)>>2]=Jt,n[vt+4>>2]=u,vt=0|k(0|It,0|Gt,0|or,0|St),n[(St=Tt)>>2]=vt,n[St+4>>2]=u,St=0|k(0|ar,0|nr,0|Yt,0|qt),n[(qt=Ht)>>2]=St,n[qt+4>>2]=u,qt=0|k(0|kt,0|Lt,0|sr,0|ht),n[(ht=zt)>>2]=qt,n[ht+4>>2]=u,ht=0|k(0|rr,0|At,0|Ft,0|fr),n[(fr=mt)>>2]=ht,n[fr+4>>2]=u,fr=0|k(0|Rt,0|$t,0|Ot,0|yt),n[(yt=Vt)>>2]=fr,n[yt+4>>2]=u,yt=0|k(0|_t,0|Mt,0|tr,0|Kt),n[(Kt=gt)>>2]=yt,n[Kt+4>>2]=u,P(Oe,at,lt),P(we,ot,it),yt=0|n[(Kt=qe)>>2],gt=0|n[Kt+4>>2],tr=0|n[(Kt=r)>>2],Mt=0|n[Kt+4>>2],Kt=0|B(0|yt,0|gt,18,0),_t=u,fr=0|U(0|tr,0|Mt,0|yt,0|gt),gt=0|U(0|fr,0|u,0|Kt,0|_t),n[(_t=r)>>2]=gt,n[_t+4>>2]=u,gt=0|n[(_t=Qe)>>2],Kt=0|n[_t+4>>2],fr=0|n[(_t=Je)>>2],yt=0|n[_t+4>>2],_t=0|B(0|gt,0|Kt,18,0),Mt=u,tr=0|U(0|fr,0|yt,0|gt,0|Kt),Kt=0|U(0|tr,0|u,0|_t,0|Mt),n[(Mt=Je)>>2]=Kt,n[Mt+4>>2]=u,Kt=0|n[(Mt=ze)>>2],_t=0|n[Mt+4>>2],tr=0|n[(Mt=He)>>2],gt=0|n[Mt+4>>2],Mt=0|B(0|Kt,0|_t,18,0),yt=u,fr=0|U(0|tr,0|gt,0|Kt,0|_t),_t=0|U(0|fr,0|u,0|Mt,0|yt),n[(yt=He)>>2]=_t,n[yt+4>>2]=u,_t=0|n[(yt=Ve)>>2],Mt=0|n[yt+4>>2],fr=0|n[(yt=We)>>2],Kt=0|n[yt+4>>2],yt=0|B(0|_t,0|Mt,18,0),gt=u,tr=0|U(0|fr,0|Kt,0|_t,0|Mt),Mt=0|U(0|tr,0|u,0|yt,0|gt),n[(gt=We)>>2]=Mt,n[gt+4>>2]=u,Mt=0|n[(gt=f)>>2],yt=0|n[gt+4>>2],tr=0|n[(gt=p)>>2],_t=0|n[gt+4>>2],gt=0|B(0|Mt,0|yt,18,0),Kt=u,fr=0|U(0|tr,0|_t,0|Mt,0|yt),yt=0|U(0|fr,0|u,0|gt,0|Kt),n[(Kt=p)>>2]=yt,n[Kt+4>>2]=u,yt=0|n[(Kt=h)>>2],gt=0|n[Kt+4>>2],fr=0|n[(Kt=_)>>2],Mt=0|n[Kt+4>>2],Kt=0|B(0|yt,0|gt,18,0),_t=u,tr=0|U(0|fr,0|Mt,0|yt,0|gt),gt=0|U(0|tr,0|u,0|Kt,0|_t),n[(_t=_)>>2]=gt,n[_t+4>>2]=u,gt=0|n[(_t=m)>>2],Kt=0|n[_t+4>>2],tr=0|n[(_t=g)>>2],yt=0|n[_t+4>>2],_t=0|B(0|gt,0|Kt,18,0),Mt=u,fr=0|U(0|tr,0|yt,0|gt,0|Kt),Kt=0|U(0|fr,0|u,0|_t,0|Mt),n[(Mt=g)>>2]=Kt,n[Mt+4>>2]=u,Kt=0|n[(Mt=v)>>2],_t=0|n[Mt+4>>2],fr=0|n[(Mt=E)>>2],gt=0|n[Mt+4>>2],Mt=0|B(0|Kt,0|_t,18,0),yt=u,tr=0|U(0|fr,0|gt,0|Kt,0|_t),_t=0|U(0|tr,0|u,0|Mt,0|yt),n[(yt=E)>>2]=_t,n[yt+4>>2]=u,_t=0|n[(yt=y)>>2],Mt=0|n[yt+4>>2],tr=0|n[(yt=Oe)>>2],Kt=0|n[yt+4>>2],yt=0|B(0|_t,0|Mt,18,0),gt=u,fr=0|U(0|tr,0|Kt,0|_t,0|Mt),Mt=0|U(0|fr,0|u,0|yt,0|gt),gt=u,n[(yt=Oe)>>2]=Mt,n[yt+4>>2]=gt,n[(yt=y)>>2]=0,n[yt+4>>2]=0,yt=gt,gt=Mt,Mt=0;do{tr=0|k(0|gt,0|yt,0|(Kt=0|x(0|(_t=0|L(0|(fr=0|U(yt>>31>>>6|0,0,0|gt,0|yt)),0|u,26)),0|(fr=u),26)),0|u),n[(Kt=Oe+(Mt<<3)|0)>>2]=tr,n[Kt+4>>2]=u,$t=0|k(0|(Vt=0|U(0|_t,0|fr,0|n[(tr=Kt=Oe+((1|Mt)<<3)|0)>>2],0|n[tr+4>>2])),0|(tr=u),0|(Ot=0|x(0|(_t=0|L(0|(fr=0|U(tr>>31>>>7|0,0,0|Vt,0|tr)),0|u,25)),0|(fr=u),25)),0|u),n[(Ot=Kt)>>2]=$t,n[Ot+4>>2]=u,gt=0|U(0|_t,0|fr,0|n[($t=Ot=Oe+((Mt=Mt+2|0)<<3)|0)>>2],0|n[$t+4>>2]),yt=u,n[($t=Ot)>>2]=gt,n[$t+4>>2]=yt}while(Mt>>>0<10);yt=0|n[(Mt=y)>>2],gt=0|n[Mt+4>>2],$t=0|n[(Mt=Oe)>>2],Ot=0|n[Mt+4>>2],Mt=0|B(0|yt,0|gt,18,0),fr=u,_t=0|U(0|$t,0|Ot,0|yt,0|gt),gt=0|U(0|_t,0|u,0|Mt,0|fr),fr=u,n[(Mt=y)>>2]=0,n[Mt+4>>2]=0,Ot=0|k(0|gt,0|fr,0|(yt=0|x(0|(_t=0|L(0|(Mt=0|U(fr>>31>>>6|0,0,0|gt,0|fr)),0|u,26)),0|(Mt=u),26)),0|u),yt=u,n[(fr=Oe)>>2]=Ot,n[fr+4>>2]=yt,gt=0|U(0|_t,0|Mt,0|n[(fr=E)>>2],0|n[fr+4>>2]),fr=u,n[(Mt=E)>>2]=gt,n[Mt+4>>2]=fr,_t=0|n[(Mt=S)>>2],$t=0|n[Mt+4>>2],Kt=0|n[(Mt=T)>>2],tr=0|n[Mt+4>>2],Mt=0|B(0|_t,0|$t,18,0),Vt=u,Rt=0|U(0|Kt,0|tr,0|_t,0|$t),$t=0|U(0|Rt,0|u,0|Mt,0|Vt),n[(Vt=T)>>2]=$t,n[Vt+4>>2]=u,$t=0|n[(Vt=b)>>2],Mt=0|n[Vt+4>>2],Rt=0|n[(Vt=A)>>2],_t=0|n[Vt+4>>2],Vt=0|B(0|$t,0|Mt,18,0),tr=u,Kt=0|U(0|Rt,0|_t,0|$t,0|Mt),Mt=0|U(0|Kt,0|u,0|Vt,0|tr),n[(tr=A)>>2]=Mt,n[tr+4>>2]=u,Mt=0|n[(tr=w)>>2],Vt=0|n[tr+4>>2],Kt=0|n[(tr=M)>>2],$t=0|n[tr+4>>2],tr=0|B(0|Mt,0|Vt,18,0),_t=u,Rt=0|U(0|Kt,0|$t,0|Mt,0|Vt),Vt=0|U(0|Rt,0|u,0|tr,0|_t),n[(_t=M)>>2]=Vt,n[_t+4>>2]=u,Vt=0|n[(_t=I)>>2],tr=0|n[_t+4>>2],Rt=0|n[(_t=R)>>2],Mt=0|n[_t+4>>2],_t=0|B(0|Vt,0|tr,18,0),$t=u,Kt=0|U(0|Rt,0|Mt,0|Vt,0|tr),tr=0|U(0|Kt,0|u,0|_t,0|$t),n[($t=R)>>2]=tr,n[$t+4>>2]=u,tr=0|n[($t=D)>>2],_t=0|n[$t+4>>2],Kt=0|n[($t=N)>>2],Vt=0|n[$t+4>>2],$t=0|B(0|tr,0|_t,18,0),Mt=u,Rt=0|U(0|Kt,0|Vt,0|tr,0|_t),_t=0|U(0|Rt,0|u,0|$t,0|Mt),n[(Mt=N)>>2]=_t,n[Mt+4>>2]=u,_t=0|n[(Mt=Y)>>2],$t=0|n[Mt+4>>2],Rt=0|n[(Mt=K)>>2],tr=0|n[Mt+4>>2],Mt=0|B(0|_t,0|$t,18,0),Vt=u,Kt=0|U(0|Rt,0|tr,0|_t,0|$t),$t=0|U(0|Kt,0|u,0|Mt,0|Vt),n[(Vt=K)>>2]=$t,n[Vt+4>>2]=u,$t=0|n[(Vt=j)>>2],Mt=0|n[Vt+4>>2],Kt=0|n[(Vt=W)>>2],_t=0|n[Vt+4>>2],Vt=0|B(0|$t,0|Mt,18,0),tr=u,Rt=0|U(0|Kt,0|_t,0|$t,0|Mt),Mt=0|U(0|Rt,0|u,0|Vt,0|tr),n[(tr=W)>>2]=Mt,n[tr+4>>2]=u,Mt=0|n[(tr=V)>>2],Vt=0|n[tr+4>>2],Rt=0|n[(tr=H)>>2],$t=0|n[tr+4>>2],tr=0|B(0|Mt,0|Vt,18,0),_t=u,Kt=0|U(0|Rt,0|$t,0|Mt,0|Vt),Vt=0|U(0|Kt,0|u,0|tr,0|_t),n[(_t=H)>>2]=Vt,n[_t+4>>2]=u,Vt=0|n[(_t=q)>>2],tr=0|n[_t+4>>2],Kt=0|n[(_t=we)>>2],Mt=0|n[_t+4>>2],_t=0|B(0|Vt,0|tr,18,0),$t=u,Rt=0|U(0|Kt,0|Mt,0|Vt,0|tr),tr=0|U(0|Rt,0|u,0|_t,0|$t),$t=u,n[(_t=we)>>2]=tr,n[_t+4>>2]=$t,n[(_t=q)>>2]=0,n[_t+4>>2]=0,_t=$t,$t=tr,tr=0;do{Kt=0|k(0|$t,0|_t,0|(Mt=0|x(0|(Vt=0|L(0|(Rt=0|U(_t>>31>>>6|0,0,0|$t,0|_t)),0|u,26)),0|(Rt=u),26)),0|u),n[(Mt=we+(tr<<3)|0)>>2]=Kt,n[Mt+4>>2]=u,Ft=0|k(0|(ht=0|U(0|Vt,0|Rt,0|n[(Kt=Mt=we+((1|tr)<<3)|0)>>2],0|n[Kt+4>>2])),0|(Kt=u),0|(mt=0|x(0|(Vt=0|L(0|(Rt=0|U(Kt>>31>>>7|0,0,0|ht,0|Kt)),0|u,25)),0|(Rt=u),25)),0|u),n[(mt=Mt)>>2]=Ft,n[mt+4>>2]=u,$t=0|U(0|Vt,0|Rt,0|n[(Ft=mt=we+((tr=tr+2|0)<<3)|0)>>2],0|n[Ft+4>>2]),_t=u,n[(Ft=mt)>>2]=$t,n[Ft+4>>2]=_t}while(tr>>>0<10);_t=0|n[(tr=q)>>2],$t=0|n[tr+4>>2],Ft=0|n[(tr=we)>>2],mt=0|n[tr+4>>2],tr=0|B(0|_t,0|$t,18,0),Rt=u,Vt=0|U(0|Ft,0|mt,0|_t,0|$t),$t=0|U(0|Vt,0|u,0|tr,0|Rt),Rt=u,n[(tr=q)>>2]=0,n[tr+4>>2]=0,mt=0|k(0|$t,0|Rt,0|(_t=0|x(0|(Vt=0|L(0|(tr=0|U(Rt>>31>>>6|0,0,0|$t,0|Rt)),0|u,26)),0|(tr=u),26)),0|u),_t=u,$t=0|U(0|Vt,0|tr,0|n[(Rt=H)>>2],0|n[Rt+4>>2]),Rt=u,Vt=0|n[(tr=g)>>2],Ft=0|n[tr+4>>2],Mt=0|n[(tr=_)>>2],Kt=0|n[tr+4>>2],ht=0|n[(tr=p)>>2],At=0|n[tr+4>>2],rr=0|n[(tr=We)>>2],qt=0|n[tr+4>>2],zt=0|n[(tr=He)>>2],sr=0|n[tr+4>>2],Lt=0|n[(tr=Je)>>2],kt=0|n[tr+4>>2],St=0|n[(tr=r)>>2],Ht=0|n[tr+4>>2],Yt=0|n[(tr=z)>>2],nr=0|n[tr+4>>2],tr=0|U(0|mt,0|_t,0|Ot,0|yt),n[(ar=Oe)>>2]=tr,n[ar+4>>2]=u,ar=0|U(0|$t,0|Rt,0|gt,0|fr),n[(tr=E)>>2]=ar,n[tr+4>>2]=u,tr=0|U(0|(ar=0|n[(tr=W)>>2]),0|(vt=0|n[tr+4>>2]),0|Vt,0|Ft),n[(Tt=g)>>2]=tr,n[Tt+4>>2]=u,Tt=0|U(0|(tr=0|n[(Tt=K)>>2]),0|(or=0|n[Tt+4>>2]),0|Mt,0|Kt),n[(Gt=_)>>2]=Tt,n[Gt+4>>2]=u,Gt=0|U(0|(Tt=0|n[(Gt=N)>>2]),0|(It=0|n[Gt+4>>2]),0|ht,0|At),n[(Jt=p)>>2]=Gt,n[Jt+4>>2]=u,Jt=0|U(0|(Gt=0|n[(Jt=R)>>2]),0|(Qt=0|n[Jt+4>>2]),0|rr,0|qt),n[(Ut=We)>>2]=Jt,n[Ut+4>>2]=u,Ut=0|U(0|(Jt=0|n[(Ut=M)>>2]),0|(ir=0|n[Ut+4>>2]),0|zt,0|sr),n[(Bt=He)>>2]=Ut,n[Bt+4>>2]=u,Bt=0|U(0|(Ut=0|n[(Bt=A)>>2]),0|(Pt=0|n[Bt+4>>2]),0|Lt,0|kt),n[(Ct=Je)>>2]=Bt,n[Ct+4>>2]=u,Ct=0|U(0|(Bt=0|n[(Ct=T)>>2]),0|(cr=0|n[Ct+4>>2]),0|St,0|Ht),n[(Nt=r)>>2]=Ct,n[Nt+4>>2]=u,Nt=0|U(0|(Ct=0|n[(Nt=J)>>2]),0|(ur=0|n[Nt+4>>2]),0|Yt,0|nr),n[(Xt=z)>>2]=Nt,n[Xt+4>>2]=u,Xt=0|k(0|Ot,0|yt,0|mt,0|_t),n[(_t=we)>>2]=Xt,n[_t+4>>2]=u,_t=0|k(0|gt,0|fr,0|$t,0|Rt),n[(Rt=H)>>2]=_t,n[Rt+4>>2]=u,Rt=0|k(0|Vt,0|Ft,0|ar,0|vt),n[(vt=W)>>2]=Rt,n[vt+4>>2]=u,vt=0|k(0|Mt,0|Kt,0|tr,0|or),n[(or=K)>>2]=vt,n[or+4>>2]=u,or=0|k(0|ht,0|At,0|Tt,0|It),n[(It=N)>>2]=or,n[It+4>>2]=u,It=0|k(0|rr,0|qt,0|Gt,0|Qt),n[(Qt=R)>>2]=It,n[Qt+4>>2]=u,Qt=0|k(0|zt,0|sr,0|Jt,0|ir),n[(ir=M)>>2]=Qt,n[ir+4>>2]=u,ir=0|k(0|Lt,0|kt,0|Ut,0|Pt),n[(Pt=A)>>2]=ir,n[Pt+4>>2]=u,Pt=0|k(0|St,0|Ht,0|Bt,0|cr),n[(cr=T)>>2]=Pt,n[cr+4>>2]=u,cr=0|k(0|Yt,0|nr,0|Ct,0|ur),n[(ur=J)>>2]=cr,n[ur+4>>2]=u,O(Ie,Oe),O(Me,we),P(we,Me,d),cr=0|n[(ur=S)>>2],Ct=0|n[ur+4>>2],nr=0|n[(ur=T)>>2],Yt=0|n[ur+4>>2],ur=0|B(0|cr,0|Ct,18,0),Pt=u,Bt=0|U(0|nr,0|Yt,0|cr,0|Ct),Ct=0|U(0|Bt,0|u,0|ur,0|Pt),n[(Pt=T)>>2]=Ct,n[Pt+4>>2]=u,Ct=0|n[(Pt=b)>>2],ur=0|n[Pt+4>>2],Bt=0|n[(Pt=A)>>2],cr=0|n[Pt+4>>2],Pt=0|B(0|Ct,0|ur,18,0),Yt=u,nr=0|U(0|Bt,0|cr,0|Ct,0|ur),ur=0|U(0|nr,0|u,0|Pt,0|Yt),n[(Yt=A)>>2]=ur,n[Yt+4>>2]=u,ur=0|n[(Yt=w)>>2],Pt=0|n[Yt+4>>2],nr=0|n[(Yt=M)>>2],Ct=0|n[Yt+4>>2],Yt=0|B(0|ur,0|Pt,18,0),cr=u,Bt=0|U(0|nr,0|Ct,0|ur,0|Pt),Pt=0|U(0|Bt,0|u,0|Yt,0|cr),n[(cr=M)>>2]=Pt,n[cr+4>>2]=u,Pt=0|n[(cr=I)>>2],Yt=0|n[cr+4>>2],Bt=0|n[(cr=R)>>2],ur=0|n[cr+4>>2],cr=0|B(0|Pt,0|Yt,18,0),Ct=u,nr=0|U(0|Bt,0|ur,0|Pt,0|Yt),Yt=0|U(0|nr,0|u,0|cr,0|Ct),n[(Ct=R)>>2]=Yt,n[Ct+4>>2]=u,Yt=0|n[(Ct=D)>>2],cr=0|n[Ct+4>>2],nr=0|n[(Ct=N)>>2],Pt=0|n[Ct+4>>2],Ct=0|B(0|Yt,0|cr,18,0),ur=u,Bt=0|U(0|nr,0|Pt,0|Yt,0|cr),cr=0|U(0|Bt,0|u,0|Ct,0|ur),n[(ur=N)>>2]=cr,n[ur+4>>2]=u,cr=0|n[(ur=Y)>>2],Ct=0|n[ur+4>>2],Bt=0|n[(ur=K)>>2],Yt=0|n[ur+4>>2],ur=0|B(0|cr,0|Ct,18,0),Pt=u,nr=0|U(0|Bt,0|Yt,0|cr,0|Ct),Ct=0|U(0|nr,0|u,0|ur,0|Pt),n[(Pt=K)>>2]=Ct,n[Pt+4>>2]=u,Ct=0|n[(Pt=j)>>2],ur=0|n[Pt+4>>2],nr=0|n[(Pt=W)>>2],cr=0|n[Pt+4>>2],Pt=0|B(0|Ct,0|ur,18,0),Yt=u,Bt=0|U(0|nr,0|cr,0|Ct,0|ur),ur=0|U(0|Bt,0|u,0|Pt,0|Yt),n[(Yt=W)>>2]=ur,n[Yt+4>>2]=u,ur=0|n[(Yt=V)>>2],Pt=0|n[Yt+4>>2],Bt=0|n[(Yt=H)>>2],Ct=0|n[Yt+4>>2],Yt=0|B(0|ur,0|Pt,18,0),cr=u,nr=0|U(0|Bt,0|Ct,0|ur,0|Pt),Pt=0|U(0|nr,0|u,0|Yt,0|cr),n[(cr=H)>>2]=Pt,n[cr+4>>2]=u,Pt=0|n[(cr=q)>>2],Yt=0|n[cr+4>>2],nr=0|n[(cr=we)>>2],ur=0|n[cr+4>>2],cr=0|B(0|Pt,0|Yt,18,0),Ct=u,Bt=0|U(0|nr,0|ur,0|Pt,0|Yt),Yt=0|U(0|Bt,0|u,0|cr,0|Ct),Ct=u,n[(cr=we)>>2]=Yt,n[cr+4>>2]=Ct,n[(cr=q)>>2]=0,n[cr+4>>2]=0,cr=Ct,Ct=Yt,Yt=0;do{nr=0|k(0|Ct,0|cr,0|(ur=0|x(0|(Pt=0|L(0|(Bt=0|U(cr>>31>>>6|0,0,0|Ct,0|cr)),0|u,26)),0|(Bt=u),26)),0|u),n[(ur=we+(Yt<<3)|0)>>2]=nr,n[ur+4>>2]=u,ir=0|k(0|(Ht=0|U(0|Pt,0|Bt,0|n[(nr=ur=we+((1|Yt)<<3)|0)>>2],0|n[nr+4>>2])),0|(nr=u),0|(St=0|x(0|(Pt=0|L(0|(Bt=0|U(nr>>31>>>7|0,0,0|Ht,0|nr)),0|u,25)),0|(Bt=u),25)),0|u),n[(St=ur)>>2]=ir,n[St+4>>2]=u,Ct=0|U(0|Pt,0|Bt,0|n[(ir=St=we+((Yt=Yt+2|0)<<3)|0)>>2],0|n[ir+4>>2]),cr=u,n[(ir=St)>>2]=Ct,n[ir+4>>2]=cr}while(Yt>>>0<10);cr=0|n[(Yt=q)>>2],Ct=0|n[Yt+4>>2],fr=0|n[(Yt=we)>>2],gt=0|n[Yt+4>>2],Yt=0|B(0|cr,0|Ct,18,0),yt=u,Ot=0|U(0|fr,0|gt,0|cr,0|Ct),Ct=0|U(0|Ot,0|u,0|Yt,0|yt),yt=u,n[(Yt=q)>>2]=0,n[Yt+4>>2]=0,gt=0|k(0|Ct,0|yt,0|(cr=0|x(0|(Ot=0|L(0|(Yt=0|U(yt>>31>>>6|0,0,0|Ct,0|yt)),0|u,26)),0|(Yt=u),26)),0|u),n[(cr=we)>>2]=gt,n[cr+4>>2]=u,gt=0|U(0|Ot,0|Yt,0|n[(cr=H)>>2],0|n[cr+4>>2]),n[(cr=H)>>2]=gt,n[cr+4>>2]=u,je=Ie,t=(Ke=nt)+80|0;do{n[Ke>>2]=n[je>>2],Ke=Ke+4|0,je=je+4|0}while((0|Ke)<(0|t));je=we,t=(Ke=st)+80|0;do{n[Ke>>2]=n[je>>2],Ke=Ke+4|0,je=je+4|0}while((0|Ke)<(0|t));O(Ce,ot),O(Pe,lt),P(ut,Ce,Pe),gt=0|n[(cr=ut+144|0)>>2],Yt=0|n[cr+4>>2],yt=0|n[(Ot=cr=ut+64|0)>>2],Ct=0|n[Ot+4>>2],Ot=0|B(0|gt,0|Yt,18,0),fr=u,ir=0|U(0|yt,0|Ct,0|gt,0|Yt),Yt=0|U(0|ir,0|u,0|Ot,0|fr),n[(fr=cr)>>2]=Yt,n[fr+4>>2]=u,Yt=0|n[(fr=ut+136|0)>>2],cr=0|n[fr+4>>2],ir=0|n[(Ot=fr=ut+56|0)>>2],gt=0|n[Ot+4>>2],Ot=0|B(0|Yt,0|cr,18,0),Ct=u,yt=0|U(0|ir,0|gt,0|Yt,0|cr),cr=0|U(0|yt,0|u,0|Ot,0|Ct),n[(Ct=fr)>>2]=cr,n[Ct+4>>2]=u,cr=0|n[(Ct=ut+128|0)>>2],fr=0|n[Ct+4>>2],yt=0|n[(Ot=Ct=ut+48|0)>>2],Yt=0|n[Ot+4>>2],Ot=0|B(0|cr,0|fr,18,0),gt=u,ir=0|U(0|yt,0|Yt,0|cr,0|fr),fr=0|U(0|ir,0|u,0|Ot,0|gt),n[(gt=Ct)>>2]=fr,n[gt+4>>2]=u,fr=0|n[(gt=ut+120|0)>>2],Ct=0|n[gt+4>>2],ir=0|n[(Ot=gt=ut+40|0)>>2],cr=0|n[Ot+4>>2],Ot=0|B(0|fr,0|Ct,18,0),Yt=u,yt=0|U(0|ir,0|cr,0|fr,0|Ct),Ct=0|U(0|yt,0|u,0|Ot,0|Yt),n[(Yt=gt)>>2]=Ct,n[Yt+4>>2]=u,Ct=0|n[(Yt=ut+112|0)>>2],gt=0|n[Yt+4>>2],yt=0|n[(Ot=Yt=ut+32|0)>>2],fr=0|n[Ot+4>>2],Ot=0|B(0|Ct,0|gt,18,0),cr=u,ir=0|U(0|yt,0|fr,0|Ct,0|gt),gt=0|U(0|ir,0|u,0|Ot,0|cr),n[(cr=Yt)>>2]=gt,n[cr+4>>2]=u,gt=0|n[(cr=ut+104|0)>>2],Yt=0|n[cr+4>>2],ir=0|n[(Ot=cr=ut+24|0)>>2],Ct=0|n[Ot+4>>2],Ot=0|B(0|gt,0|Yt,18,0),fr=u,yt=0|U(0|ir,0|Ct,0|gt,0|Yt),Yt=0|U(0|yt,0|u,0|Ot,0|fr),n[(fr=cr)>>2]=Yt,n[fr+4>>2]=u,Yt=0|n[(fr=ut+96|0)>>2],cr=0|n[fr+4>>2],yt=0|n[(Ot=fr=ut+16|0)>>2],gt=0|n[Ot+4>>2],Ot=0|B(0|Yt,0|cr,18,0),Ct=u,ir=0|U(0|yt,0|gt,0|Yt,0|cr),cr=0|U(0|ir,0|u,0|Ot,0|Ct),n[(Ct=fr)>>2]=cr,n[Ct+4>>2]=u,cr=0|n[(Ct=ut+88|0)>>2],fr=0|n[Ct+4>>2],ir=0|n[(Ot=Ct=ut+8|0)>>2],Yt=0|n[Ot+4>>2],Ot=0|B(0|cr,0|fr,18,0),gt=u,yt=0|U(0|ir,0|Yt,0|cr,0|fr),fr=0|U(0|yt,0|u,0|Ot,0|gt),n[(gt=Ct)>>2]=fr,n[gt+4>>2]=u,Ot=0|n[(fr=gt=ut+80|0)>>2],yt=0|n[fr+4>>2],cr=0|n[(fr=ut)>>2],Yt=0|n[fr+4>>2],fr=0|B(0|Ot,0|yt,18,0),ir=u,St=0|U(0|cr,0|Yt,0|Ot,0|yt),yt=0|U(0|St,0|u,0|fr,0|ir),ir=u,n[(fr=ut)>>2]=yt,n[fr+4>>2]=ir,n[(fr=gt)>>2]=0,n[fr+4>>2]=0,fr=ir,ir=yt,yt=0;do{cr=0|k(0|ir,0|fr,0|(Yt=0|x(0|(Ot=0|L(0|(St=0|U(fr>>31>>>6|0,0,0|ir,0|fr)),0|u,26)),0|(St=u),26)),0|u),n[(Yt=ut+(yt<<3)|0)>>2]=cr,n[Yt+4>>2]=u,ur=0|k(0|(Bt=0|U(0|Ot,0|St,0|n[(cr=Yt=ut+((1|yt)<<3)|0)>>2],0|n[cr+4>>2])),0|(cr=u),0|(Pt=0|x(0|(Ot=0|L(0|(St=0|U(cr>>31>>>7|0,0,0|Bt,0|cr)),0|u,25)),0|(St=u),25)),0|u),n[(Pt=Yt)>>2]=ur,n[Pt+4>>2]=u,ir=0|U(0|Ot,0|St,0|n[(ur=Pt=ut+((yt=yt+2|0)<<3)|0)>>2],0|n[ur+4>>2]),fr=u,n[(ur=Pt)>>2]=ir,n[ur+4>>2]=fr}while(yt>>>0<10);fr=0|n[(yt=gt)>>2],ir=0|n[yt+4>>2],ur=0|n[(yt=ut)>>2],Pt=0|n[yt+4>>2],yt=0|B(0|fr,0|ir,18,0),St=u,Ot=0|U(0|ur,0|Pt,0|fr,0|ir),ir=0|U(0|Ot,0|u,0|yt,0|St),St=u,n[(yt=gt)>>2]=0,n[yt+4>>2]=0,Pt=0|k(0|ir,0|St,0|(fr=0|x(0|(Ot=0|L(0|(yt=0|U(St>>31>>>6|0,0,0|ir,0|St)),0|u,26)),0|(yt=u),26)),0|u),n[(fr=ut)>>2]=Pt,n[fr+4>>2]=u,Pt=0|U(0|Ot,0|yt,0|n[(fr=Ct)>>2],0|n[fr+4>>2]),n[(fr=Ct)>>2]=Pt,n[fr+4>>2]=u,Ot=0|k(0|(Pt=0|n[(fr=Ce)>>2]),0|(yt=0|n[fr+4>>2]),0|n[(fr=Pe)>>2],0|n[fr+4>>2]),fr=u,n[(St=Pe)>>2]=Ot,n[St+4>>2]=fr,Yt=0|k(0|(ir=0|n[(St=Q)>>2]),0|(ur=0|n[St+4>>2]),0|n[(St=X)>>2],0|n[St+4>>2]),St=u,n[(cr=X)>>2]=Yt,n[cr+4>>2]=St,Ht=0|k(0|(Bt=0|n[(cr=Z)>>2]),0|(nr=0|n[cr+4>>2]),0|n[(cr=$)>>2],0|n[cr+4>>2]),cr=u,n[(Ut=$)>>2]=Ht,n[Ut+4>>2]=cr,Qt=0|k(0|(kt=0|n[(Ut=ee)>>2]),0|(Lt=0|n[Ut+4>>2]),0|n[(Ut=te)>>2],0|n[Ut+4>>2]),Ut=u,n[(Jt=te)>>2]=Qt,n[Jt+4>>2]=Ut,It=0|k(0|(sr=0|n[(Jt=re)>>2]),0|(zt=0|n[Jt+4>>2]),0|n[(Jt=ae)>>2],0|n[Jt+4>>2]),Jt=u,n[(Gt=ae)>>2]=It,n[Gt+4>>2]=Jt,or=0|k(0|(qt=0|n[(Gt=ne)>>2]),0|(rr=0|n[Gt+4>>2]),0|n[(Gt=ie)>>2],0|n[Gt+4>>2]),Gt=u,n[(Tt=ie)>>2]=or,n[Tt+4>>2]=Gt,vt=0|k(0|(At=0|n[(Tt=se)>>2]),0|(ht=0|n[Tt+4>>2]),0|n[(Tt=oe)>>2],0|n[Tt+4>>2]),Tt=u,n[(tr=oe)>>2]=vt,n[tr+4>>2]=Tt,Rt=0|k(0|(Kt=0|n[(tr=ue)>>2]),0|(Mt=0|n[tr+4>>2]),0|n[(tr=le)>>2],0|n[tr+4>>2]),tr=u,n[(ar=le)>>2]=Rt,n[ar+4>>2]=tr,_t=0|k(0|(Ft=0|n[(ar=de)>>2]),0|(Vt=0|n[ar+4>>2]),0|n[(ar=ce)>>2],0|n[ar+4>>2]),ar=u,n[($t=ce)>>2]=_t,n[$t+4>>2]=ar,Nt=0|k(0|(Xt=0|n[($t=fe)>>2]),0|(mt=0|n[$t+4>>2]),0|n[($t=pe)>>2],0|n[$t+4>>2]),$t=u,n[(Zt=pe)>>2]=Nt,n[Zt+4>>2]=$t,t=(Ke=he)+72|0;do{n[Ke>>2]=0,Ke=Ke+4|0}while((0|Ke)<(0|t));Ct=0|B(0|Ot,0|fr,121665,0),gt=u,n[(Zt=Ae)>>2]=Ct,n[Zt+4>>2]=gt,Zt=0|B(0|Yt,0|St,121665,0),n[(Et=_e)>>2]=Zt,n[Et+4>>2]=u,Et=0|B(0|Ht,0|cr,121665,0),n[(Zt=me)>>2]=Et,n[Zt+4>>2]=u,Zt=0|B(0|Qt,0|Ut,121665,0),n[(Et=ge)>>2]=Zt,n[Et+4>>2]=u,Et=0|B(0|It,0|Jt,121665,0),n[(Zt=ve)>>2]=Et,n[Zt+4>>2]=u,Zt=0|B(0|or,0|Gt,121665,0),n[(Et=Ee)>>2]=Zt,n[Et+4>>2]=u,Et=0|B(0|vt,0|Tt,121665,0),n[(Zt=ye)>>2]=Et,n[Zt+4>>2]=u,Zt=0|B(0|Rt,0|tr,121665,0),n[(Et=Se)>>2]=Zt,n[Et+4>>2]=u,Et=0|B(0|_t,0|ar,121665,0),n[(Zt=Te)>>2]=Et,n[Zt+4>>2]=u,Zt=0|B(0|Nt,0|$t,121665,0),n[(Et=be)>>2]=Zt,n[Et+4>>2]=u,n[(Et=he)>>2]=0,n[Et+4>>2]=0,Et=gt,gt=Ct,Ct=0;do{xt=0|k(0|gt,0|Et,0|(Wt=0|x(0|(jt=0|L(0|(Zt=0|U(Et>>31>>>6|0,0,0|gt,0|Et)),0|u,26)),0|(Zt=u),26)),0|u),n[(Wt=Ae+(Ct<<3)|0)>>2]=xt,n[Wt+4>>2]=u,lr=0|k(0|(wt=0|U(0|jt,0|Zt,0|n[(xt=Wt=Ae+((1|Ct)<<3)|0)>>2],0|n[xt+4>>2])),0|(xt=u),0|(dr=0|x(0|(jt=0|L(0|(Zt=0|U(xt>>31>>>7|0,0,0|wt,0|xt)),0|u,25)),0|(Zt=u),25)),0|u),n[(dr=Wt)>>2]=lr,n[dr+4>>2]=u,gt=0|U(0|jt,0|Zt,0|n[(lr=dr=Ae+((Ct=Ct+2|0)<<3)|0)>>2],0|n[lr+4>>2]),Et=u,n[(lr=dr)>>2]=gt,n[lr+4>>2]=Et}while(Ct>>>0<10);Et=0|n[(Ct=he)>>2],gt=0|n[Ct+4>>2],$t=0|n[(Ct=Ae)>>2],Nt=0|n[Ct+4>>2],Ct=0|B(0|Et,0|gt,18,0),ar=u,_t=0|U(0|$t,0|Nt,0|Et,0|gt),gt=0|U(0|_t,0|u,0|Ct,0|ar),ar=u,n[(Ct=he)>>2]=0,n[Ct+4>>2]=0,Et=0|x(0|(_t=0|L(0|(Ct=0|U(ar>>31>>>6|0,0,0|gt,0|ar)),0|u,26)),0|(Ct=u),26),Nt=u,tr=0|n[($t=_e)>>2],Rt=0|n[$t+4>>2],ar=0|k(0|($t=0|U(0|gt,0|ar,0|Pt,0|yt)),0|u,0|Et,0|Nt),n[(Nt=Ae)>>2]=ar,n[Nt+4>>2]=u,Nt=0|U(0|tr,0|Rt,0|ir,0|ur),Rt=0|U(0|Nt,0|u,0|_t,0|Ct),n[(Ct=_e)>>2]=Rt,n[Ct+4>>2]=u,Rt=0|U(0|n[(Ct=me)>>2],0|n[Ct+4>>2],0|Bt,0|nr),n[(Ct=me)>>2]=Rt,n[Ct+4>>2]=u,Rt=0|U(0|n[(Ct=ge)>>2],0|n[Ct+4>>2],0|kt,0|Lt),n[(Ct=ge)>>2]=Rt,n[Ct+4>>2]=u,Rt=0|U(0|n[(Ct=ve)>>2],0|n[Ct+4>>2],0|sr,0|zt),n[(Ct=ve)>>2]=Rt,n[Ct+4>>2]=u,Rt=0|U(0|n[(Ct=Ee)>>2],0|n[Ct+4>>2],0|qt,0|rr),n[(Ct=Ee)>>2]=Rt,n[Ct+4>>2]=u,Rt=0|U(0|n[(Ct=ye)>>2],0|n[Ct+4>>2],0|At,0|ht),n[(Ct=ye)>>2]=Rt,n[Ct+4>>2]=u,Rt=0|U(0|n[(Ct=Se)>>2],0|n[Ct+4>>2],0|Kt,0|Mt),n[(Ct=Se)>>2]=Rt,n[Ct+4>>2]=u,Rt=0|U(0|n[(Ct=Te)>>2],0|n[Ct+4>>2],0|Ft,0|Vt),n[(Ct=Te)>>2]=Rt,n[Ct+4>>2]=u,Rt=0|U(0|n[(Ct=be)>>2],0|n[Ct+4>>2],0|Xt,0|mt),n[(Ct=be)>>2]=Rt,n[Ct+4>>2]=u,P(dt,Pe,Ae),Rt=0|n[(Ct=dt+144|0)>>2],_t=0|n[Ct+4>>2],tr=0|n[(Nt=Ct=dt+64|0)>>2],ar=0|n[Nt+4>>2],Nt=0|B(0|Rt,0|_t,18,0),Et=u,$t=0|U(0|tr,0|ar,0|Rt,0|_t),_t=0|U(0|$t,0|u,0|Nt,0|Et),n[(Et=Ct)>>2]=_t,n[Et+4>>2]=u,_t=0|n[(Et=dt+136|0)>>2],Ct=0|n[Et+4>>2],$t=0|n[(Nt=Et=dt+56|0)>>2],Rt=0|n[Nt+4>>2],Nt=0|B(0|_t,0|Ct,18,0),ar=u,tr=0|U(0|$t,0|Rt,0|_t,0|Ct),Ct=0|U(0|tr,0|u,0|Nt,0|ar),n[(ar=Et)>>2]=Ct,n[ar+4>>2]=u,Ct=0|n[(ar=dt+128|0)>>2],Et=0|n[ar+4>>2],tr=0|n[(Nt=ar=dt+48|0)>>2],_t=0|n[Nt+4>>2],Nt=0|B(0|Ct,0|Et,18,0),Rt=u,$t=0|U(0|tr,0|_t,0|Ct,0|Et),Et=0|U(0|$t,0|u,0|Nt,0|Rt),n[(Rt=ar)>>2]=Et,n[Rt+4>>2]=u,Et=0|n[(Rt=dt+120|0)>>2],ar=0|n[Rt+4>>2],$t=0|n[(Nt=Rt=dt+40|0)>>2],Ct=0|n[Nt+4>>2],Nt=0|B(0|Et,0|ar,18,0),_t=u,tr=0|U(0|$t,0|Ct,0|Et,0|ar),ar=0|U(0|tr,0|u,0|Nt,0|_t),n[(_t=Rt)>>2]=ar,n[_t+4>>2]=u,ar=0|n[(_t=dt+112|0)>>2],Rt=0|n[_t+4>>2],tr=0|n[(Nt=_t=dt+32|0)>>2],Et=0|n[Nt+4>>2],Nt=0|B(0|ar,0|Rt,18,0),Ct=u,$t=0|U(0|tr,0|Et,0|ar,0|Rt),Rt=0|U(0|$t,0|u,0|Nt,0|Ct),n[(Ct=_t)>>2]=Rt,n[Ct+4>>2]=u,Rt=0|n[(Ct=dt+104|0)>>2],_t=0|n[Ct+4>>2],$t=0|n[(Nt=Ct=dt+24|0)>>2],ar=0|n[Nt+4>>2],Nt=0|B(0|Rt,0|_t,18,0),Et=u,tr=0|U(0|$t,0|ar,0|Rt,0|_t),_t=0|U(0|tr,0|u,0|Nt,0|Et),n[(Et=Ct)>>2]=_t,n[Et+4>>2]=u,_t=0|n[(Et=dt+96|0)>>2],Ct=0|n[Et+4>>2],tr=0|n[(Nt=Et=dt+16|0)>>2],Rt=0|n[Nt+4>>2],Nt=0|B(0|_t,0|Ct,18,0),ar=u,$t=0|U(0|tr,0|Rt,0|_t,0|Ct),Ct=0|U(0|$t,0|u,0|Nt,0|ar),n[(ar=Et)>>2]=Ct,n[ar+4>>2]=u,Ct=0|n[(ar=dt+88|0)>>2],Et=0|n[ar+4>>2],$t=0|n[(Nt=ar=dt+8|0)>>2],_t=0|n[Nt+4>>2],Nt=0|B(0|Ct,0|Et,18,0),Rt=u,tr=0|U(0|$t,0|_t,0|Ct,0|Et),Et=0|U(0|tr,0|u,0|Nt,0|Rt),n[(Rt=ar)>>2]=Et,n[Rt+4>>2]=u,Nt=0|n[(Et=Rt=dt+80|0)>>2],tr=0|n[Et+4>>2],Ct=0|n[(Et=dt)>>2],_t=0|n[Et+4>>2],Et=0|B(0|Nt,0|tr,18,0),$t=u,gt=0|U(0|Ct,0|_t,0|Nt,0|tr),tr=0|U(0|gt,0|u,0|Et,0|$t),$t=u,n[(Et=dt)>>2]=tr,n[Et+4>>2]=$t,n[(Et=Rt)>>2]=0,n[Et+4>>2]=0,Et=$t,$t=tr,tr=0;do{Ct=0|k(0|$t,0|Et,0|(_t=0|x(0|(Nt=0|L(0|(gt=0|U(Et>>31>>>6|0,0,0|$t,0|Et)),0|u,26)),0|(gt=u),26)),0|u),n[(_t=dt+(tr<<3)|0)>>2]=Ct,n[_t+4>>2]=u,Gt=0|k(0|(Tt=0|U(0|Nt,0|gt,0|n[(Ct=_t=dt+((1|tr)<<3)|0)>>2],0|n[Ct+4>>2])),0|(Ct=u),0|(vt=0|x(0|(Nt=0|L(0|(gt=0|U(Ct>>31>>>7|0,0,0|Tt,0|Ct)),0|u,25)),0|(gt=u),25)),0|u),n[(vt=_t)>>2]=Gt,n[vt+4>>2]=u,$t=0|U(0|Nt,0|gt,0|n[(Gt=vt=dt+((tr=tr+2|0)<<3)|0)>>2],0|n[Gt+4>>2]),Et=u,n[(Gt=vt)>>2]=$t,n[Gt+4>>2]=Et}while(tr>>>0<10);Et=0|n[(tr=Rt)>>2],$t=0|n[tr+4>>2],mt=0|n[(tr=dt)>>2],Xt=0|n[tr+4>>2],tr=0|B(0|Et,0|$t,18,0),Vt=u,Ft=0|U(0|mt,0|Xt,0|Et,0|$t),$t=0|U(0|Ft,0|u,0|tr,0|Vt),Vt=u,n[(tr=Rt)>>2]=0,n[tr+4>>2]=0,Xt=0|k(0|$t,0|Vt,0|(Et=0|x(0|(Ft=0|L(0|(tr=0|U(Vt>>31>>>6|0,0,0|$t,0|Vt)),0|u,26)),0|(tr=u),26)),0|u),n[(Et=dt)>>2]=Xt,n[Et+4>>2]=u,Xt=0|U(0|Ft,0|tr,0|n[(Et=ar)>>2],0|n[Et+4>>2]),n[(Et=ar)>>2]=Xt,n[Et+4>>2]=u,Et=0;do{Ft=0|n[(tr=Xt=ut+(Et<<3)|0)>>2],Vt=0|n[tr+4>>2],mt=0|n[($t=tr=nt+(Et<<3)|0)>>2],Kt=((Mt=0|n[$t+4>>2])^Vt)&pt,Vt=0|L(0,($t=(mt^Ft)&ft)^Ft|0,32),n[(Ft=Xt)>>2]=Vt,n[Ft+4>>2]=u,Ft=0|L(0,$t^mt|0,32),n[(mt=tr)>>2]=Ft,n[mt+4>>2]=u,Et=Et+1|0}while(10!=(0|Et));pr=0;do{Rt=0|n[(ar=Et=dt+(pr<<3)|0)>>2],mt=0|n[ar+4>>2],tr=0|n[(Ft=ar=st+(pr<<3)|0)>>2],Vt=(($t=0|n[Ft+4>>2])^mt)&pt,mt=0|L(0,(Ft=(tr^Rt)&ft)^Rt|0,32),n[(Rt=Et)>>2]=mt,n[Rt+4>>2]=u,Rt=0|L(0,Ft^tr|0,32),n[(tr=ar)>>2]=Rt,n[tr+4>>2]=u,pr=pr+1|0}while(10!=(0|pr));if(8==(0|(rt=rt+1|0))){hr=at,_r=nt,mr=it,gr=st,vr=ot,Er=ut,yr=lt,Sr=dt;break}pt=dt,ft=ut,tr=st,Rt=nt,Ge=ct<<1&255,dt=lt,lt=pt,ut=ot,ot=ft,st=it,it=tr,nt=at,at=Rt}if(32==(0|(at=Xe+1|0))){Tr=Er,br=Sr;break}Xe=at,Ze=_r,$e=hr,ke=gr,et=mr,Ue=Er,tt=vr,Fe=Sr,Le=yr}je=Tr,t=(Ke=xe)+80|0;do{n[Ke>>2]=n[je>>2],Ke=Ke+4|0,je=je+4|0}while((0|Ke)<(0|t));je=br,t=(Ke=Be)+80|0;do{n[Ke>>2]=n[je>>2],Ke=Ke+4|0,je=je+4|0}while((0|Ke)<(0|t));O(Ae,Be),O(Ne,Ae),O(De,Ne),C(Ce,De,Be),C(Pe,Ce,Ae),O(De,Pe),C(Oe,De,Ce),O(De,Oe),O(Ne,De),O(De,Ne),O(Ne,De),O(De,Ne),C(we,De,Oe),O(De,we),O(Ne,De),O(De,Ne),O(Ne,De),O(De,Ne),O(Ne,De),O(De,Ne),O(Ne,De),O(De,Ne),O(Ne,De),C(Me,Ne,we),O(De,Me),O(Ne,De),O(De,Ne),O(Ne,De),O(De,Ne),O(Ne,De),O(De,Ne),O(Ne,De),O(De,Ne),O(Ne,De),O(De,Ne),O(Ne,De),O(De,Ne),O(Ne,De),O(De,Ne),O(Ne,De),O(De,Ne),O(Ne,De),O(De,Ne),O(Ne,De),C(De,Ne,Me),O(Ne,De),O(De,Ne),O(Ne,De),O(De,Ne),O(Ne,De),O(De,Ne),O(Ne,De),O(De,Ne),O(Ne,De),O(De,Ne),C(Ie,De,we),O(De,Ie),O(Ne,De),we=2;do{O(De,Ne),O(Ne,De),we=we+2|0}while((0|we)<50);C(Re,Ne,Ie),O(Ne,Re),O(De,Ne),we=2;do{O(Ne,De),O(De,Ne),we=we+2|0}while((0|we)<100);C(Ne,De,Re),O(De,Ne),O(Ne,De),Re=2;do{O(De,Ne),O(Ne,De),Re=Re+2|0}while((0|Re)<50);for(C(De,Ne,Ie),O(Ne,De),O(De,Ne),O(Ne,De),O(De,Ne),O(Ne,De),C(Ye,Ne,Pe),C(Be,xe,Ye),Ye=0|n[Be>>2],n[Ae>>2]=Ye,n[(xe=Ae+4|0)>>2]=n[Be+8>>2],n[(Pe=Ae+8|0)>>2]=n[Be+16>>2],n[(Ne=Ae+12|0)>>2]=n[Be+24>>2],n[(De=Ae+16|0)>>2]=n[Be+32>>2],n[(Ie=Ae+20|0)>>2]=n[Be+40>>2],n[(Re=Ae+24|0)>>2]=n[Be+48>>2],n[(we=Ae+28|0)>>2]=n[Be+56>>2],n[(Me=Ae+32|0)>>2]=n[Be+64>>2],n[(Oe=Ae+36|0)>>2]=n[Be+72>>2],Be=Ye,Ye=0;Ce=Ae+(Ye<<2)|0,je=Be>>31&Be,1&Ye?(t=je>>25,n[Ce>>2]=(0|l(t,-33554432))+Be,Tr=(0|n[(je=Ae+((Ce=Ye+1|0)<<2)|0)>>2])+t|0,n[je>>2]=Tr,Ar=Tr,Cr=Ce):(Ke=je>>26,n[Ce>>2]=(0|l(Ke,-67108864))+Be,Tr=(0|n[(br=Ae+((t=Ye+1|0)<<2)|0)>>2])+Ke|0,n[br>>2]=Tr,Ar=Tr,Cr=t),9!=(0|Cr);)Be=Ar,Ye=Cr;for(Ye=((Cr=0|n[Oe>>2])>>31&Cr)>>25,n[Oe>>2]=(0|l(Ye,-33554432))+Cr,Cr=(19*Ye|0)+(0|n[Ae>>2])|0,n[Ae>>2]=Cr,Ye=Cr,Cr=0;Ar=Ae+(Cr<<2)|0,Be=Ye>>31&Ye,1&Cr?(t=Be>>25,n[Ar>>2]=(0|l(t,-33554432))+Ye,Tr=(0|n[(Be=Ae+((Ar=Cr+1|0)<<2)|0)>>2])+t|0,n[Be>>2]=Tr,Pr=Ar,Or=Tr):(Ce=Be>>26,n[Ar>>2]=(0|l(Ce,-67108864))+Ye,t=(0|n[(je=Ae+((Tr=Cr+1|0)<<2)|0)>>2])+Ce|0,n[je>>2]=t,Pr=Tr,Or=t),9!=(0|Pr);)Ye=Or,Cr=Pr;for(Cr=((Pr=0|n[Oe>>2])>>31&Pr)>>25,n[Oe>>2]=(0|l(Cr,-33554432))+Pr,Pr=(19*Cr|0)+(0|n[Ae>>2])|0,Or=(0|l(Cr=(Pr>>31&Pr)>>26,-67108864))+Pr|0,n[Ae>>2]=Or,n[xe>>2]=Cr+(0|n[xe>>2]),Cr=Or,Or=0;Pr=Ae+(Or<<2)|0,1&Or?(n[Pr>>2]=33554431&Cr,Ye=(0|n[(Ar=Ae+((Pr=Or+1|0)<<2)|0)>>2])+(Cr>>25)|0,n[Ar>>2]=Ye,wr=Pr,Mr=Ye):(n[Pr>>2]=67108863&Cr,Ar=(0|n[(Tr=Ae+((Ye=Or+1|0)<<2)|0)>>2])+(Cr>>26)|0,n[Tr>>2]=Ar,wr=Ye,Mr=Ar),9!=(0|wr);)Cr=Mr,Or=wr;for(wr=0|n[Oe>>2],n[Oe>>2]=33554431&wr,Or=(19*(wr>>25)|0)+(0|n[Ae>>2])|0,n[Ae>>2]=Or,wr=Or,Or=0;Mr=Ae+(Or<<2)|0,1&Or?(n[Mr>>2]=33554431&wr,Cr=(0|n[(Pr=Ae+((Mr=Or+1|0)<<2)|0)>>2])+(wr>>25)|0,n[Pr>>2]=Cr,Ir=Mr,Rr=Cr):(n[Mr>>2]=67108863&wr,Pr=(0|n[(Ye=Ae+((Cr=Or+1|0)<<2)|0)>>2])+(wr>>26)|0,n[Ye>>2]=Pr,Ir=Cr,Rr=Pr),9!=(0|Ir);)wr=Rr,Or=Ir;for(Or=33554431&(Ir=0|n[Oe>>2]),n[Oe>>2]=Or,Rr=(19*(Ir>>25)|0)+(0|n[Ae>>2])|0,n[Ae>>2]=Rr,Ir=1,wr=~(Rr+-67108845>>31);;){if(Cr=0|n[Ae+(Ir<<2)>>2],Dr=1&Ir?(Cr=(Pr=(Cr=(Pr=Cr<<16&(-33554432^Cr))<<8&Pr)<<4&Cr)<<2&Pr)<<1&Cr:(Pr=(Mr=(Pr=(Mr=Cr<<16&(-67108864^Cr))<<8&Mr)<<4&Pr)<<2&Mr)<<1&Pr,Cr=Dr>>31&wr,10==(0|(Ir=Ir+1|0))){Nr=Cr;break}wr=Cr}return wr=Rr-(67108845&Nr)|0,n[Ae>>2]=wr,Ae=67108863&Nr,Rr=33554431&Nr,Dr=(Ir=(0|n[xe>>2])-Rr|0)<<2,Pr=(Cr=(0|n[Pe>>2])-Ae|0)<<3,Ye=(Mr=(0|n[Ne>>2])-Rr|0)<<5,Nr=(Ar=(0|n[De>>2])-Nr|0)<<6,Tr=(0|n[Ie>>2])-Rr|0,n[Ie>>2]=Tr,Be=(Ie=(0|n[Re>>2])-Ae|0)<<1,je=(t=(0|n[we>>2])-Rr|0)<<3,Ce=(0|n[Me>>2])-Ae<<4,n[xe>>2]=Dr,n[Pe>>2]=Pr,n[Ne>>2]=Ye,n[De>>2]=Nr,n[Re>>2]=Be,n[we>>2]=je,n[Me>>2]=Ce,n[Oe>>2]=Or-Rr<<6,a[e>>0]=wr,a[e+1>>0]=wr>>>8,a[e+2>>0]=wr>>>16,a[e+3>>0]=Dr|wr>>>24,a[e+4>>0]=Ir>>>6,a[e+5>>0]=Ir>>>14,a[e+6>>0]=Pr|Ir>>>22,a[e+7>>0]=Cr>>>5,a[e+8>>0]=Cr>>>13,a[e+9>>0]=Ye|Cr>>>21,a[e+10>>0]=Mr>>>3,a[e+11>>0]=Mr>>>11,a[e+12>>0]=Nr|Mr>>>19,a[e+13>>0]=Ar>>>2,a[e+14>>0]=Ar>>>10,a[e+15>>0]=Ar>>>18,a[e+16>>0]=Tr,a[e+17>>0]=Tr>>>8,a[e+18>>0]=Tr>>>16,a[e+19>>0]=Tr>>>24|Be,a[e+20>>0]=Ie>>>7,a[e+21>>0]=Ie>>>15,a[e+22>>0]=Ie>>>23|je,a[e+23>>0]=t>>>5,a[e+24>>0]=t>>>13,je=0|n[Me>>2],a[e+25>>0]=t>>>21|je,a[e+26>>0]=je>>>8,a[e+27>>0]=je>>>16,t=0|n[Oe>>2],a[e+28>>0]=je>>>24|t,a[e+29>>0]=t>>>8,a[e+30>>0]=t>>>16,a[e+31>>0]=t>>>24,s=o,0},_free:function(e){var t,r,a=0,i=0,s=0,o=0,u=0,l=0,d=0,c=0,f=0,p=0,h=0,m=0,g=0,v=0,E=0,y=0,S=0,T=0,b=0,A=0,C=0,P=0,O=0,w=0,M=0,I=0,R=0,D=0,N=0,L=0,k=0,U=0,F=0,G=0;if(e|=0){(a=e+-8|0)>>>0<(i=0|n[47])>>>0&&_(),1==(0|(e=3&(t=0|n[e+-4>>2])))&&_(),r=a+(s=-8&t)|0;do{if(1&t)f=a,p=s;else{if(o=0|n[a>>2],!e)return;if(l=o+s|0,(u=a+(0-o)|0)>>>0<i>>>0&&_(),(0|u)==(0|n[48])){if(3!=(3&(c=0|n[(d=r+4|0)>>2])|0)){f=u,p=l;break}return n[45]=l,n[d>>2]=-2&c,n[u+4>>2]=1|l,void(n[u+l>>2]=l)}if(c=o>>>3,o>>>0<256){if(o=0|n[u+8>>2],d=0|n[u+12>>2],(0|o)!=(0|(h=212+(c<<1<<2)|0))&&(o>>>0<i>>>0&&_(),(0|n[o+12>>2])!=(0|u)&&_()),(0|d)==(0|o)){n[43]=n[43]&~(1<<c),f=u,p=l;break}(0|d)!=(0|h)?(d>>>0<i>>>0&&_(),(0|n[(h=d+8|0)>>2])==(0|u)?m=h:_()):m=d+8|0,n[o+12>>2]=d,n[m>>2]=o,f=u,p=l;break}o=0|n[u+24>>2],d=0|n[u+12>>2];do{if((0|d)==(0|u)){if(g=0|n[(c=(h=u+16|0)+4|0)>>2])y=g,S=c;else{if(!(v=0|n[h>>2])){E=0;break}y=v,S=h}for(;;)if(g=0|n[(c=y+20|0)>>2])y=g,S=c;else{if(!(g=0|n[(c=y+16|0)>>2])){T=y,b=S;break}y=g,S=c}if(!(b>>>0<i>>>0)){n[b>>2]=0,E=T;break}_()}else{if((c=0|n[u+8>>2])>>>0<i>>>0&&_(),(0|n[(g=c+12|0)>>2])!=(0|u)&&_(),(0|n[(h=d+8|0)>>2])==(0|u)){n[g>>2]=d,n[h>>2]=c,E=d;break}_()}}while(0);if(o){if(d=0|n[u+28>>2],(0|u)==(0|n[(c=476+(d<<2)|0)>>2])){if(n[c>>2]=E,!E){n[44]=n[44]&~(1<<d),f=u,p=l;break}}else if(o>>>0<(0|n[47])>>>0&&_(),(0|n[(d=o+16|0)>>2])==(0|u)?n[d>>2]=E:n[o+20>>2]=E,!E){f=u,p=l;break}E>>>0<(d=0|n[47])>>>0&&_(),n[E+24>>2]=o,h=0|n[(c=u+16|0)>>2];do{if(h){if(!(h>>>0<d>>>0)){n[E+16>>2]=h,n[h+24>>2]=E;break}_()}}while(0);if(h=0|n[c+4>>2]){if(!(h>>>0<(0|n[47])>>>0)){n[E+20>>2]=h,n[h+24>>2]=E,f=u,p=l;break}_()}else f=u,p=l}else f=u,p=l}}while(0);if(f>>>0>=r>>>0&&_(),1&(a=0|n[(s=r+4|0)>>2])||_(),2&a)n[s>>2]=-2&a,n[f+4>>2]=1|p,n[f+p>>2]=p,I=p;else{if((0|r)==(0|n[49])){if(E=(0|n[46])+p|0,n[46]=E,n[49]=f,n[f+4>>2]=1|E,(0|f)!=(0|n[48]))return;return n[48]=0,void(n[45]=0)}if((0|r)==(0|n[48]))return E=(0|n[45])+p|0,n[45]=E,n[48]=f,n[f+4>>2]=1|E,void(n[f+E>>2]=E);E=(-8&a)+p|0,i=a>>>3;do{if(a>>>0>=256){T=0|n[r+24>>2],b=0|n[r+12>>2];do{if((0|b)==(0|r)){if(m=0|n[(y=(S=r+16|0)+4|0)>>2])C=m,P=y;else{if(!(e=0|n[S>>2])){A=0;break}C=e,P=S}for(;;)if(m=0|n[(y=C+20|0)>>2])C=m,P=y;else{if(!(m=0|n[(y=C+16|0)>>2])){O=C,w=P;break}C=m,P=y}if(!(w>>>0<(0|n[47])>>>0)){n[w>>2]=0,A=O;break}_()}else{if((y=0|n[r+8>>2])>>>0<(0|n[47])>>>0&&_(),(0|n[(m=y+12|0)>>2])!=(0|r)&&_(),(0|n[(S=b+8|0)>>2])==(0|r)){n[m>>2]=b,n[S>>2]=y,A=b;break}_()}}while(0);if(T){if(b=0|n[r+28>>2],(0|r)==(0|n[(l=476+(b<<2)|0)>>2])){if(n[l>>2]=A,!A){n[44]=n[44]&~(1<<b);break}}else if(T>>>0<(0|n[47])>>>0&&_(),(0|n[(b=T+16|0)>>2])==(0|r)?n[b>>2]=A:n[T+20>>2]=A,!A)break;A>>>0<(b=0|n[47])>>>0&&_(),n[A+24>>2]=T,u=0|n[(l=r+16|0)>>2];do{if(u){if(!(u>>>0<b>>>0)){n[A+16>>2]=u,n[u+24>>2]=A;break}_()}}while(0);if(u=0|n[l+4>>2]){if(!(u>>>0<(0|n[47])>>>0)){n[A+20>>2]=u,n[u+24>>2]=A;break}_()}}}else{if(u=0|n[r+8>>2],b=0|n[r+12>>2],(0|u)!=(0|(T=212+(i<<1<<2)|0))&&(u>>>0<(0|n[47])>>>0&&_(),(0|n[u+12>>2])!=(0|r)&&_()),(0|b)==(0|u)){n[43]=n[43]&~(1<<i);break}(0|b)!=(0|T)?(b>>>0<(0|n[47])>>>0&&_(),(0|n[(T=b+8|0)>>2])==(0|r)?M=T:_()):M=b+8|0,n[u+12>>2]=b,n[M>>2]=u}}while(0);if(n[f+4>>2]=1|E,n[f+E>>2]=E,(0|f)==(0|n[48]))return void(n[45]=E);I=E}if(p=I>>>3,I>>>0<256)return a=212+(p<<1<<2)|0,(s=0|n[43])&(E=1<<p)?(M=0|n[(p=a+8|0)>>2])>>>0<(0|n[47])>>>0?_():(R=p,D=M):(n[43]=s|E,R=a+8|0,D=a),n[R>>2]=f,n[D+12>>2]=f,n[f+8>>2]=D,void(n[f+12>>2]=a);N=(a=I>>>8)?I>>>0>16777215?31:I>>>((s=14-((a=((R=a<<(D=(a+1048320|0)>>>16&8))+520192|0)>>>16&4)|D|(R=((E=R<<a)+245760|0)>>>16&2))+(E<<R>>>15)|0)+7|0)&1|s<<1:0,s=476+(N<<2)|0,n[f+28>>2]=N,n[f+20>>2]=0,n[f+16>>2]=0,R=0|n[44],E=1<<N;do{if(R&E){for(D=I<<(31==(0|N)?0:25-(N>>>1)|0),a=0|n[s>>2];;){if((-8&n[a+4>>2]|0)==(0|I)){L=a,k=130;break}if(!(p=0|n[(M=a+16+(D>>>31<<2)|0)>>2])){U=M,F=a,k=127;break}D<<=1,a=p}if(127==(0|k)){if(!(U>>>0<(0|n[47])>>>0)){n[U>>2]=f,n[f+24>>2]=F,n[f+12>>2]=f,n[f+8>>2]=f;break}_()}else if(130==(0|k)){if((D=0|n[(a=L+8|0)>>2])>>>0>=(l=0|n[47])>>>0&L>>>0>=l>>>0){n[D+12>>2]=f,n[a>>2]=f,n[f+8>>2]=D,n[f+12>>2]=L,n[f+24>>2]=0;break}_()}}else n[44]=R|E,n[s>>2]=f,n[f+24>>2]=s,n[f+12>>2]=f,n[f+8>>2]=f}while(0);if(f=(0|n[51])-1|0,n[51]=f,!f){for(G=628;f=0|n[G>>2];)G=f+8|0;n[51]=-1}}},_i64Add:U,_bitshift64Ashr:L,_i64Subtract:k,_memset:F,_malloc:function(e){e|=0;var t=0,r=0,a=0,i=0,s=0,o=0,u=0,l=0,d=0,c=0,f=0,p=0,h=0,v=0,E=0,y=0,S=0,T=0,A=0,C=0,P=0,O=0,M=0,I=0,R=0,D=0,N=0,L=0,k=0,U=0,F=0,G=0,x=0,B=0,Y=0,K=0,j=0,W=0,V=0,H=0,q=0,z=0,J=0,Q=0,X=0,Z=0,$=0,ee=0,te=0,re=0,ae=0,ne=0,ie=0,se=0,oe=0,ue=0,le=0,de=0,ce=0,fe=0,pe=0,he=0,_e=0,me=0,ge=0,ve=0,Ee=0,ye=0,Se=0,Te=0,be=0,Ae=0,Ce=0,Pe=0,Oe=0,we=0,Me=0,Ie=0,Re=0,De=0,Ne=0,Le=0,ke=0,Ue=0,Fe=0,Ge=0,xe=0,Be=0,Ye=0,Ke=0;do{if(e>>>0<245){if(r=(t=e>>>0<11?16:e+11&-8)>>>3,3&(i=(a=0|n[43])>>>r)){l=0|n[(u=(o=212+((s=(1&i^1)+r|0)<<1<<2)|0)+8|0)>>2],c=0|n[(d=l+8|0)>>2];do{if((0|o)!=(0|c)){if(c>>>0<(0|n[47])>>>0&&_(),(0|n[(f=c+12|0)>>2])==(0|l)){n[f>>2]=o,n[u>>2]=c;break}_()}else n[43]=a&~(1<<s)}while(0);return c=s<<3,n[l+4>>2]=3|c,n[(u=l+c+4|0)>>2]=1|n[u>>2],0|d}if(t>>>0>(u=0|n[45])>>>0){if(i){p=0|n[(v=(h=212+((E=((c=(f=(c=((o=i<<r&((c=2<<r)|0-c))&0-o)-1|0)>>>(o=c>>>12&16))>>>5&8)|o|(f=(p=f>>>c)>>>2&4)|(p=(h=p>>>f)>>>1&2)|(h=(v=h>>>p)>>>1&1))+(v>>>h)|0)<<1<<2)|0)+8|0)>>2],o=0|n[(f=p+8|0)>>2];do{if((0|h)!=(0|o)){if(o>>>0<(0|n[47])>>>0&&_(),(0|n[(c=o+12|0)>>2])==(0|p)){n[c>>2]=h,n[v>>2]=o,y=0|n[45];break}_()}else n[43]=a&~(1<<E),y=u}while(0);return u=(E<<3)-t|0,n[p+4>>2]=3|t,n[(a=p+t|0)+4>>2]=1|u,n[a+u>>2]=u,y&&(o=0|n[48],h=212+((v=y>>>3)<<1<<2)|0,(r=0|n[43])&(i=1<<v)?(d=0|n[(v=h+8|0)>>2])>>>0<(0|n[47])>>>0?_():(S=v,T=d):(n[43]=r|i,S=h+8|0,T=h),n[S>>2]=o,n[T+12>>2]=o,n[o+8>>2]=T,n[o+12>>2]=h),n[45]=u,n[48]=a,0|f}if(a=0|n[44]){for(d=0|n[476+(((u=(h=(u=(a&0-a)-1|0)>>>(a=u>>>12&16))>>>5&8)|a|(h=(o=h>>>u)>>>2&4)|(o=(i=o>>>h)>>>1&2)|(i=(r=i>>>o)>>>1&1))+(r>>>i)<<2)>>2],i=(-8&n[d+4>>2])-t|0,r=d,o=d;;){if(d=0|n[r+16>>2])P=d;else{if(!(h=0|n[r+20>>2])){A=i,C=o;break}P=h}i=(h=(d=(-8&n[P+4>>2])-t|0)>>>0<i>>>0)?d:i,r=P,o=h?P:o}C>>>0<(o=0|n[47])>>>0&&_(),C>>>0>=(r=C+t|0)>>>0&&_(),i=0|n[C+24>>2],f=0|n[C+12>>2];do{if((0|f)==(0|C)){if(E=0|n[(p=C+20|0)>>2])M=E,I=p;else{if(!(d=0|n[(h=C+16|0)>>2])){O=0;break}M=d,I=h}for(;;)if(E=0|n[(p=M+20|0)>>2])M=E,I=p;else{if(!(E=0|n[(p=M+16|0)>>2])){R=M,D=I;break}M=E,I=p}if(!(D>>>0<o>>>0)){n[D>>2]=0,O=R;break}_()}else{if((p=0|n[C+8>>2])>>>0<o>>>0&&_(),(0|n[(E=p+12|0)>>2])!=(0|C)&&_(),(0|n[(h=f+8|0)>>2])==(0|C)){n[E>>2]=f,n[h>>2]=p,O=f;break}_()}}while(0);do{if(i){if(f=0|n[C+28>>2],(0|C)==(0|n[(o=476+(f<<2)|0)>>2])){if(n[o>>2]=O,!O){n[44]=n[44]&~(1<<f);break}}else if(i>>>0<(0|n[47])>>>0&&_(),(0|n[(f=i+16|0)>>2])==(0|C)?n[f>>2]=O:n[i+20>>2]=O,!O)break;O>>>0<(f=0|n[47])>>>0&&_(),n[O+24>>2]=i,o=0|n[C+16>>2];do{if(o){if(!(o>>>0<f>>>0)){n[O+16>>2]=o,n[o+24>>2]=O;break}_()}}while(0);if(o=0|n[C+20>>2]){if(!(o>>>0<(0|n[47])>>>0)){n[O+20>>2]=o,n[o+24>>2]=O;break}_()}}}while(0);return A>>>0<16?(i=A+t|0,n[C+4>>2]=3|i,n[(o=C+i+4|0)>>2]=1|n[o>>2]):(n[C+4>>2]=3|t,n[r+4>>2]=1|A,n[r+A>>2]=A,(o=0|n[45])&&(i=0|n[48],o=212+((f=o>>>3)<<1<<2)|0,(p=0|n[43])&(h=1<<f)?(E=0|n[(f=o+8|0)>>2])>>>0<(0|n[47])>>>0?_():(N=f,L=E):(n[43]=p|h,N=o+8|0,L=o),n[N>>2]=i,n[L+12>>2]=i,n[i+8>>2]=L,n[i+12>>2]=o),n[45]=A,n[48]=r),0|(C+8|0)}k=t}else k=t}else if(e>>>0<=4294967231)if(i=-8&(o=e+11|0),h=0|n[44]){p=0-i|0,U=(E=o>>>8)?i>>>0>16777215?31:i>>>((a=14-((E=((f=E<<(o=(E+1048320|0)>>>16&8))+520192|0)>>>16&4)|o|(f=((d=f<<E)+245760|0)>>>16&2))+(d<<f>>>15)|0)+7|0)&1|a<<1:0,a=0|n[476+(U<<2)>>2];e:do{if(a)for(f=p,d=0,o=i<<(31==(0|U)?0:25-(U>>>1)|0),E=a,u=0;;){if((l=(v=-8&n[E+4>>2])-i|0)>>>0<f>>>0){if((0|v)==(0|i)){Y=l,K=E,j=E,B=90;break e}W=l,V=E}else W=f,V=u;if(v=0==(0|(l=0|n[E+20>>2]))|(0|l)==(0|(E=0|n[E+16+(o>>>31<<2)>>2]))?d:l,l=0==(0|E)){F=W,G=v,x=V,B=86;break}f=W,d=v,o<<=1&l^1,u=V}else F=p,G=0,x=0,B=86}while(0);if(86==(0|B)){if(0==(0|G)&0==(0|x)){if(!(p=h&((a=2<<U)|0-a))){k=i;break}H=0|n[476+(((a=(t=(a=(p&0-p)-1|0)>>>(p=a>>>12&16))>>>5&8)|p|(t=(r=t>>>a)>>>2&4)|(r=(u=r>>>t)>>>1&2)|(u=(o=u>>>r)>>>1&1))+(o>>>u)<<2)>>2]}else H=G;H?(Y=F,K=H,j=x,B=90):(q=F,z=x)}if(90==(0|B))for(;;)if(B=0,r=(o=(u=(-8&n[K+4>>2])-i|0)>>>0<Y>>>0)?u:Y,u=o?K:j,o=0|n[K+16>>2])Y=r,K=o,j=u,B=90;else{if(!(K=0|n[K+20>>2])){q=r,z=u;break}Y=r,j=u,B=90}if(0!=(0|z)&&q>>>0<((0|n[45])-i|0)>>>0){z>>>0<(h=0|n[47])>>>0&&_(),z>>>0>=(u=z+i|0)>>>0&&_(),r=0|n[z+24>>2],o=0|n[z+12>>2];do{if((0|o)==(0|z)){if(p=0|n[(t=z+20|0)>>2])Q=p,X=t;else{if(!(d=0|n[(a=z+16|0)>>2])){J=0;break}Q=d,X=a}for(;;)if(p=0|n[(t=Q+20|0)>>2])Q=p,X=t;else{if(!(p=0|n[(t=Q+16|0)>>2])){Z=Q,$=X;break}Q=p,X=t}if(!($>>>0<h>>>0)){n[$>>2]=0,J=Z;break}_()}else{if((t=0|n[z+8>>2])>>>0<h>>>0&&_(),(0|n[(p=t+12|0)>>2])!=(0|z)&&_(),(0|n[(a=o+8|0)>>2])==(0|z)){n[p>>2]=o,n[a>>2]=t,J=o;break}_()}}while(0);do{if(r){if(o=0|n[z+28>>2],(0|z)==(0|n[(h=476+(o<<2)|0)>>2])){if(n[h>>2]=J,!J){n[44]=n[44]&~(1<<o);break}}else if(r>>>0<(0|n[47])>>>0&&_(),(0|n[(o=r+16|0)>>2])==(0|z)?n[o>>2]=J:n[r+20>>2]=J,!J)break;J>>>0<(o=0|n[47])>>>0&&_(),n[J+24>>2]=r,h=0|n[z+16>>2];do{if(h){if(!(h>>>0<o>>>0)){n[J+16>>2]=h,n[h+24>>2]=J;break}_()}}while(0);if(h=0|n[z+20>>2]){if(!(h>>>0<(0|n[47])>>>0)){n[J+20>>2]=h,n[h+24>>2]=J;break}_()}}}while(0);do{if(q>>>0>=16){if(n[z+4>>2]=3|i,n[u+4>>2]=1|q,n[u+q>>2]=q,r=q>>>3,q>>>0<256){h=212+(r<<1<<2)|0,(o=0|n[43])&(t=1<<r)?(a=0|n[(r=h+8|0)>>2])>>>0<(0|n[47])>>>0?_():(ee=r,te=a):(n[43]=o|t,ee=h+8|0,te=h),n[ee>>2]=u,n[te+12>>2]=u,n[u+8>>2]=te,n[u+12>>2]=h;break}if(re=(h=q>>>8)?q>>>0>16777215?31:q>>>((r=14-((h=((o=h<<(t=(h+1048320|0)>>>16&8))+520192|0)>>>16&4)|t|(o=((a=o<<h)+245760|0)>>>16&2))+(a<<o>>>15)|0)+7|0)&1|r<<1:0,r=476+(re<<2)|0,n[u+28>>2]=re,n[(o=u+16|0)+4>>2]=0,n[o>>2]=0,!((o=0|n[44])&(a=1<<re))){n[44]=o|a,n[r>>2]=u,n[u+24>>2]=r,n[u+12>>2]=u,n[u+8>>2]=u;break}for(a=q<<(31==(0|re)?0:25-(re>>>1)|0),o=0|n[r>>2];;){if((-8&n[o+4>>2]|0)==(0|q)){ae=o,B=148;break}if(!(t=0|n[(r=o+16+(a>>>31<<2)|0)>>2])){ne=r,ie=o,B=145;break}a<<=1,o=t}if(145==(0|B)){if(!(ne>>>0<(0|n[47])>>>0)){n[ne>>2]=u,n[u+24>>2]=ie,n[u+12>>2]=u,n[u+8>>2]=u;break}_()}else if(148==(0|B)){if((a=0|n[(o=ae+8|0)>>2])>>>0>=(t=0|n[47])>>>0&ae>>>0>=t>>>0){n[a+12>>2]=u,n[o>>2]=u,n[u+8>>2]=a,n[u+12>>2]=ae,n[u+24>>2]=0;break}_()}}else a=q+i|0,n[z+4>>2]=3|a,n[(o=z+a+4|0)>>2]=1|n[o>>2]}while(0);return 0|(z+8|0)}k=i}else k=i;else k=-1}while(0);if((z=0|n[45])>>>0>=k>>>0)return q=z-k|0,ae=0|n[48],q>>>0>15?(ie=ae+k|0,n[48]=ie,n[45]=q,n[ie+4>>2]=1|q,n[ie+q>>2]=q,n[ae+4>>2]=3|k):(n[45]=0,n[48]=0,n[ae+4>>2]=3|z,n[(q=ae+z+4|0)>>2]=1|n[q>>2]),0|(ae+8|0);if((ae=0|n[46])>>>0>k>>>0)return q=ae-k|0,n[46]=q,z=(ae=0|n[49])+k|0,n[49]=z,n[z+4>>2]=1|q,n[ae+4>>2]=3|k,0|(ae+8|0);do{if(!(0|n[161])){if(!((ae=0|b(30))+-1&ae)){n[163]=ae,n[162]=ae,n[164]=-1,n[165]=-1,n[166]=0,n[154]=0,n[161]=-16&(0|g(0))^1431655768;break}_()}}while(0);if(ae=k+48|0,(q=(ie=(q=0|n[163])+(z=k+47|0)|0)&(ne=0-q|0))>>>0<=k>>>0)return 0|0;if(0!=(0|(re=0|n[153]))&&(ee=(te=0|n[151])+q|0)>>>0<=te>>>0|ee>>>0>re>>>0)return 0|0;e:do{if(4&n[154])B=190;else{re=0|n[49];t:do{if(re){for(ee=620;;){if((te=0|n[ee>>2])>>>0<=re>>>0&&(te+(0|n[(J=ee+4|0)>>2])|0)>>>0>re>>>0){se=ee,oe=J;break}if(!(ee=0|n[ee+8>>2])){B=173;break t}}if((ee=ie-(0|n[46])&ne)>>>0<2147483647)if((0|(J=0|m(0|ee)))==((0|n[se>>2])+(0|n[oe>>2])|0)){if(-1!=(0|J)){ue=J,le=ee,B=193;break e}}else de=J,ce=ee,B=183}else B=173}while(0);do{if(173==(0|B)&&-1!=(0|(re=0|m(0)))&&(i=re,fe=(J=(ee=0|n[162])+-1|0)&i?q-i+(J+i&0-ee)|0:q,i=(ee=0|n[151])+fe|0,fe>>>0>k>>>0&fe>>>0<2147483647)){if(0!=(0|(J=0|n[153]))&&i>>>0<=ee>>>0|i>>>0>J>>>0)break;if((0|(J=0|m(0|fe)))==(0|re)){ue=re,le=fe,B=193;break e}de=J,ce=fe,B=183}}while(0);t:do{if(183==(0|B)){J=0-ce|0;do{if(ae>>>0>ce>>>0&ce>>>0<2147483647&-1!=(0|de)&&(i=z-ce+(re=0|n[163])&0-re)>>>0<2147483647){if(-1==(0|m(0|i))){m(0|J);break t}pe=i+ce|0;break}pe=ce}while(0);if(-1!=(0|de)){ue=de,le=pe,B=193;break e}}}while(0);n[154]=4|n[154],B=190}}while(0);if(190==(0|B)&&q>>>0<2147483647&&(pe=0|m(0|q))>>>0<(q=0|m(0))>>>0&-1!=(0|pe)&-1!=(0|q)&&(de=q-pe|0)>>>0>(k+40|0)>>>0&&(ue=pe,le=de,B=193),193==(0|B)){de=(0|n[151])+le|0,n[151]=de,de>>>0>(0|n[152])>>>0&&(n[152]=de),de=0|n[49];do{if(de){pe=620;do{if((0|ue)==((q=0|n[pe>>2])+(z=0|n[(ce=pe+4|0)>>2])|0)){he=q,_e=ce,me=z,ge=pe,B=203;break}pe=0|n[pe+8>>2]}while(0!=(0|pe));if(203==(0|B)&&0==(8&n[ge+12>>2]|0)&&de>>>0<ue>>>0&de>>>0>=he>>>0){n[_e>>2]=me+le,pe=de+(z=0==(7&(pe=de+8|0)|0)?0:0-pe&7)|0,ce=le-z+(0|n[46])|0,n[49]=pe,n[46]=ce,n[pe+4>>2]=1|ce,n[pe+ce+4>>2]=40,n[50]=n[165];break}for(ue>>>0<(ce=0|n[47])>>>0?(n[47]=ue,ve=ue):ve=ce,ce=ue+le|0,pe=620;;){if((0|n[pe>>2])==(0|ce)){Ee=pe,ye=pe,B=211;break}if(!(pe=0|n[pe+8>>2])){Se=620;break}}if(211==(0|B)){if(!(8&n[ye+12>>2])){n[Ee>>2]=ue,n[(pe=ye+4|0)>>2]=(0|n[pe>>2])+le,z=ue+(0==(7&(pe=ue+8|0)|0)?0:0-pe&7)|0,q=ce+(0==(7&(pe=ce+8|0)|0)?0:0-pe&7)|0,pe=z+k|0,ae=q-z-k|0,n[z+4>>2]=3|k;do{if((0|q)!=(0|de)){if((0|q)==(0|n[48])){fe=(0|n[45])+ae|0,n[45]=fe,n[48]=pe,n[pe+4>>2]=1|fe,n[pe+fe>>2]=fe;break}if(1==(3&(fe=0|n[q+4>>2])|0)){oe=-8&fe,se=fe>>>3;e:do{if(fe>>>0>=256){ne=0|n[q+24>>2],ie=0|n[q+12>>2];do{if((0|ie)==(0|q)){if(re=0|n[(i=(J=q+16|0)+4|0)>>2])be=re,Ae=i;else{if(!(ee=0|n[J>>2])){Te=0;break}be=ee,Ae=J}for(;;)if(re=0|n[(i=be+20|0)>>2])be=re,Ae=i;else{if(!(re=0|n[(i=be+16|0)>>2])){Ce=be,Pe=Ae;break}be=re,Ae=i}if(!(Pe>>>0<ve>>>0)){n[Pe>>2]=0,Te=Ce;break}_()}else{if((i=0|n[q+8>>2])>>>0<ve>>>0&&_(),(0|n[(re=i+12|0)>>2])!=(0|q)&&_(),(0|n[(J=ie+8|0)>>2])==(0|q)){n[re>>2]=ie,n[J>>2]=i,Te=ie;break}_()}}while(0);if(!ne)break;i=476+((ie=0|n[q+28>>2])<<2)|0;do{if((0|q)==(0|n[i>>2])){if(n[i>>2]=Te,Te)break;n[44]=n[44]&~(1<<ie);break e}if(ne>>>0<(0|n[47])>>>0&&_(),(0|n[(J=ne+16|0)>>2])==(0|q)?n[J>>2]=Te:n[ne+20>>2]=Te,!Te)break e}while(0);Te>>>0<(ie=0|n[47])>>>0&&_(),n[Te+24>>2]=ne,J=0|n[(i=q+16|0)>>2];do{if(J){if(!(J>>>0<ie>>>0)){n[Te+16>>2]=J,n[J+24>>2]=Te;break}_()}}while(0);if(!(J=0|n[i+4>>2]))break;if(!(J>>>0<(0|n[47])>>>0)){n[Te+20>>2]=J,n[J+24>>2]=Te;break}_()}else{J=0|n[q+8>>2],ie=0|n[q+12>>2],ne=212+(se<<1<<2)|0;do{if((0|J)!=(0|ne)){if(J>>>0<ve>>>0&&_(),(0|n[J+12>>2])==(0|q))break;_()}}while(0);if((0|ie)==(0|J)){n[43]=n[43]&~(1<<se);break}do{if((0|ie)==(0|ne))Oe=ie+8|0;else{if(ie>>>0<ve>>>0&&_(),(0|n[(i=ie+8|0)>>2])==(0|q)){Oe=i;break}_()}}while(0);n[J+12>>2]=ie,n[Oe>>2]=J}}while(0);we=q+oe|0,Me=oe+ae|0}else we=q,Me=ae;if(n[(se=we+4|0)>>2]=-2&n[se>>2],n[pe+4>>2]=1|Me,n[pe+Me>>2]=Me,se=Me>>>3,Me>>>0<256){fe=212+(se<<1<<2)|0,ne=0|n[43],i=1<<se;do{if(ne&i){if((re=0|n[(se=fe+8|0)>>2])>>>0>=(0|n[47])>>>0){Ie=se,Re=re;break}_()}else n[43]=ne|i,Ie=fe+8|0,Re=fe}while(0);n[Ie>>2]=pe,n[Re+12>>2]=pe,n[pe+8>>2]=Re,n[pe+12>>2]=fe;break}i=Me>>>8;do{if(i){if(Me>>>0>16777215){De=31;break}De=Me>>>((ee=14-((re=((oe=i<<(ne=(i+1048320|0)>>>16&8))+520192|0)>>>16&4)|ne|(oe=((se=oe<<re)+245760|0)>>>16&2))+(se<<oe>>>15)|0)+7|0)&1|ee<<1}else De=0}while(0);if(i=476+(De<<2)|0,n[pe+28>>2]=De,n[(fe=pe+16|0)+4>>2]=0,n[fe>>2]=0,!((fe=0|n[44])&(ee=1<<De))){n[44]=fe|ee,n[i>>2]=pe,n[pe+24>>2]=i,n[pe+12>>2]=pe,n[pe+8>>2]=pe;break}for(ee=Me<<(31==(0|De)?0:25-(De>>>1)|0),fe=0|n[i>>2];;){if((-8&n[fe+4>>2]|0)==(0|Me)){Ne=fe,B=281;break}if(!(oe=0|n[(i=fe+16+(ee>>>31<<2)|0)>>2])){Le=i,ke=fe,B=278;break}ee<<=1,fe=oe}if(278==(0|B)){if(!(Le>>>0<(0|n[47])>>>0)){n[Le>>2]=pe,n[pe+24>>2]=ke,n[pe+12>>2]=pe,n[pe+8>>2]=pe;break}_()}else if(281==(0|B)){if((ee=0|n[(fe=Ne+8|0)>>2])>>>0>=(oe=0|n[47])>>>0&Ne>>>0>=oe>>>0){n[ee+12>>2]=pe,n[fe>>2]=pe,n[pe+8>>2]=ee,n[pe+12>>2]=Ne,n[pe+24>>2]=0;break}_()}}else ee=(0|n[46])+ae|0,n[46]=ee,n[49]=pe,n[pe+4>>2]=1|ee}while(0);return 0|(z+8|0)}Se=620}for(;;){if((pe=0|n[Se>>2])>>>0<=de>>>0&&(ae=pe+(0|n[Se+4>>2])|0)>>>0>de>>>0){Ue=ae;break}Se=0|n[Se+8>>2]}pe=(z=(pe=(z=Ue+-47|0)+(0==(7&(ae=z+8|0)|0)?0:0-ae&7)|0)>>>0<(ae=de+16|0)>>>0?de:pe)+8|0,q=ue+(ce=0==(7&(q=ue+8|0)|0)?0:0-q&7)|0,ee=le+-40-ce|0,n[49]=q,n[46]=ee,n[q+4>>2]=1|ee,n[q+ee+4>>2]=40,n[50]=n[165],n[(ee=z+4|0)>>2]=27,n[pe>>2]=n[155],n[pe+4>>2]=n[156],n[pe+8>>2]=n[157],n[pe+12>>2]=n[158],n[155]=ue,n[156]=le,n[158]=0,n[157]=pe,pe=z+24|0;do{n[(pe=pe+4|0)>>2]=7}while((pe+4|0)>>>0<Ue>>>0);if((0|z)!=(0|de)){if(pe=z-de|0,n[ee>>2]=-2&n[ee>>2],n[de+4>>2]=1|pe,n[z>>2]=pe,q=pe>>>3,pe>>>0<256){ce=212+(q<<1<<2)|0,(fe=0|n[43])&(oe=1<<q)?(i=0|n[(q=ce+8|0)>>2])>>>0<(0|n[47])>>>0?_():(Fe=q,Ge=i):(n[43]=fe|oe,Fe=ce+8|0,Ge=ce),n[Fe>>2]=de,n[Ge+12>>2]=de,n[de+8>>2]=Ge,n[de+12>>2]=ce;break}if(xe=(ce=pe>>>8)?pe>>>0>16777215?31:pe>>>((q=14-((ce=((fe=ce<<(oe=(ce+1048320|0)>>>16&8))+520192|0)>>>16&4)|oe|(fe=((i=fe<<ce)+245760|0)>>>16&2))+(i<<fe>>>15)|0)+7|0)&1|q<<1:0,q=476+(xe<<2)|0,n[de+28>>2]=xe,n[de+20>>2]=0,n[ae>>2]=0,!((fe=0|n[44])&(i=1<<xe))){n[44]=fe|i,n[q>>2]=de,n[de+24>>2]=q,n[de+12>>2]=de,n[de+8>>2]=de;break}for(i=pe<<(31==(0|xe)?0:25-(xe>>>1)|0),fe=0|n[q>>2];;){if((-8&n[fe+4>>2]|0)==(0|pe)){Be=fe,B=307;break}if(!(oe=0|n[(q=fe+16+(i>>>31<<2)|0)>>2])){Ye=q,Ke=fe,B=304;break}i<<=1,fe=oe}if(304==(0|B)){if(!(Ye>>>0<(0|n[47])>>>0)){n[Ye>>2]=de,n[de+24>>2]=Ke,n[de+12>>2]=de,n[de+8>>2]=de;break}_()}else if(307==(0|B)){if((i=0|n[(fe=Be+8|0)>>2])>>>0>=(pe=0|n[47])>>>0&Be>>>0>=pe>>>0){n[i+12>>2]=de,n[fe>>2]=de,n[de+8>>2]=i,n[de+12>>2]=Be,n[de+24>>2]=0;break}_()}}}else{0==(0|(i=0|n[47]))|ue>>>0<i>>>0&&(n[47]=ue),n[155]=ue,n[156]=le,n[158]=0,n[52]=n[161],n[51]=-1,i=0;do{n[(fe=212+(i<<1<<2)|0)+12>>2]=fe,n[fe+8>>2]=fe,i=i+1|0}while(32!=(0|i));i=ue+(fe=0==(7&(i=ue+8|0)|0)?0:0-i&7)|0,pe=le+-40-fe|0,n[49]=i,n[46]=pe,n[i+4>>2]=1|pe,n[i+pe+4>>2]=40,n[50]=n[165]}}while(0);if((le=0|n[46])>>>0>k>>>0)return ue=le-k|0,n[46]=ue,de=(le=0|n[49])+k|0,n[49]=de,n[de+4>>2]=1|ue,n[le+4>>2]=3|k,0|(le+8|0)}return n[(0|w())>>2]=12,0|0},_memcpy:function(e,t,r){var i;if(e|=0,t|=0,(0|(r|=0))>=4096)return 0|v(0|e,0|t,0|r);if(i=0|e,(3&e)==(3&t)){for(;3&e;){if(!r)return 0|i;a[e>>0]=0|a[t>>0],e=e+1|0,t=t+1|0,r=r-1|0}for(;(0|r)>=4;)n[e>>2]=n[t>>2],e=e+4|0,t=t+4|0,r=r-4|0}for(;(0|r)>0;)a[e>>0]=0|a[t>>0],e=e+1|0,t=t+1|0,r=r-1|0;return 0|i},_bitshift64Lshr:G,_fflush:function e(t){t|=0;var r=0,a=0,i=0,s=0,o=0,u=0,l=0;do{if(t){if((0|n[t+76>>2])<=-1){r=0|N(t);break}a=0==(0|I()),i=0|N(t),a||R(),r=i}else{if(s=0|n[13]?0|e(0|n[13]):0,f(36),i=0|n[8])for(a=i,i=s;;){if(u=(0|n[a+76>>2])>-1?0|I():0,l=(0|n[a+20>>2])>>>0>(0|n[a+28>>2])>>>0?0|N(a)|i:i,u&&R(),!(a=0|n[a+56>>2])){o=l;break}i=l}else o=s;y(36),r=o}}while(0);return 0|r},___errno_location:w,_bitshift64Shl:x,runPostSets:function(){},stackAlloc:function(e){var t;return t=s,s=(s=s+(e|=0)|0)+15&-16,0|t},stackSave:function(){return 0|s},stackRestore:function(e){s=e|=0},establishStackSpace:function(e,t){s=e|=0,t|=0},setThrew:function(e,t){e|=0,t|=0,o||(o=e,t)},setTempRet0:function(e){u=e|=0},getTempRet0:function(){return 0|u},dynCall_ii:function(e,t){return t|=0,0|Y[1&(e|=0)](0|t)},dynCall_iiii:function(e,t,r,a){return t|=0,r|=0,a|=0,0|K[3&(e|=0)](0|t,0|r,0|a)},dynCall_vi:function(e,t){t|=0,j[1&(e|=0)](0|t)}}}(e.Na,e.Oa,buffer);e._curve25519_donna=Z._curve25519_donna;var Da=e._free=Z._free;e.runPostSets=Z.runPostSets;var cb=e._i64Add=Z._i64Add,ab=e._bitshift64Ashr=Z._bitshift64Ashr,bb=e._i64Subtract=Z._i64Subtract,db=e._memset=Z._memset,ua=e._malloc=Z._malloc,gc=e._memcpy=Z._memcpy,fb=e._bitshift64Lshr=Z._bitshift64Lshr;e._fflush=Z._fflush,e.___errno_location=Z.___errno_location;var gb=e._bitshift64Shl=Z._bitshift64Shl;function xc(e){this.name="ExitStatus",this.message="Program terminated with exit("+e+")",this.status=e}e.dynCall_ii=Z.dynCall_ii,e.dynCall_iiii=Z.dynCall_iiii,e.dynCall_vi=Z.dynCall_vi,n.W=Z.stackAlloc,n.na=Z.stackSave,n.X=Z.stackRestore,n.md=Z.establishStackSpace,n.cb=Z.setTempRet0,n.Ua=Z.getTempRet0,xc.prototype=Error(),xc.prototype.constructor=xc;var Yc=null,Xa=function t(){e.calledRun||$c(),e.calledRun||(Xa=t)};function $c(t){function r(){if(!e.calledRun&&(e.calledRun=!0,!A)){if(xa||(xa=!0,Oa(Qa)),Oa(Ra),e.onRuntimeInitialized&&e.onRuntimeInitialized(),e._main&&bd&&e.callMain(t),e.postRun)for("function"==typeof e.postRun&&(e.postRun=[e.postRun]);e.postRun.length;)Ua(e.postRun.shift());Oa(Sa)}}if(t=t||e.arguments,null===Yc&&(Yc=Date.now()),!(0<L)){if(e.preRun)for("function"==typeof e.preRun&&(e.preRun=[e.preRun]);e.preRun.length;)Ta(e.preRun.shift());Oa(Pa),0<L||e.calledRun||(e.setStatus?(e.setStatus("Running..."),setTimeout((function(){setTimeout((function(){e.setStatus("")}),1),r()}),1)):r())}}function ad(t,r){if(!r||!e.noExitRuntime)throw!e.noExitRuntime&&(A=!0,m=void 0,Oa(K),e.onExit)&&e.onExit(t),new xc(t)}e.callMain=e.jd=function(t){function r(){for(var e=0;3>e;e++)n.push(0)}assert(0==L,"cannot call main when async dependencies remain! (listen on __ATMAIN__)"),assert(0==Pa.length,"cannot call main when preRun functions remain to be called"),t=t||[],xa||(xa=!0,Oa(Qa));var a=t.length+1,n=[G(Va(e.thisProgram),"i8",0)];r();for(var i=0;i<a-1;i+=1)n.push(G(Va(t[i]),"i8",0)),r();n.push(0),n=G(n,"i32",0);try{ad(e._main(a,n,0),!0)}catch(t){if(!(t instanceof xc)){if("SimulateInfiniteLoop"!=t)throw t&&"object"==typeof t&&t.stack&&e.S("exception thrown: "+[t,t.stack]),t;e.noExitRuntime=!0}}},e.run=e.run=$c,e.exit=e.exit=ad;var cd=[];function z(t){void 0!==t?(e.print(t),e.S(t),t=JSON.stringify(t)):t="",A=!0;var r="abort("+t+") at "+Ea()+"\nIf this abort() is unexpected, build with -s ASSERTIONS=1 which can give more information.";throw cd&&cd.forEach((function(e){r=e(r,t)})),r}if(e.abort=e.abort=z,e.preInit)for("function"==typeof e.preInit&&(e.preInit=[e.preInit]);0<e.preInit.length;)e.preInit.pop()();var bd=!0;e.noInitialRun&&(bd=!1),$c(),module.exports=e},88120:e=>{var t;!function(){function e(e){if(this.mode=a.MODE_8BIT_BYTE,this.data=e,this.parsedData=[],e instanceof ArrayBuffer)this.parsedData=new Int8Array(e);else{for(var t=0,r=this.data.length;t<r;t++){var n=[],i=this.data.charCodeAt(t);i>65536?(n[0]=240|(1835008&i)>>>18,n[1]=128|(258048&i)>>>12,n[2]=128|(4032&i)>>>6,n[3]=128|63&i):i>2048?(n[0]=224|(61440&i)>>>12,n[1]=128|(4032&i)>>>6,n[2]=128|63&i):i>128?(n[0]=192|(1984&i)>>>6,n[1]=128|63&i):n[0]=i,this.parsedData.push(n)}this.parsedData=Array.prototype.concat.apply([],this.parsedData),this.parsedData.length!=this.data.length&&(this.parsedData.unshift(191),this.parsedData.unshift(187),this.parsedData.unshift(239))}}function r(e,t){this.typeNumber=e,this.errorCorrectLevel=t,this.modules=null,this.moduleCount=0,this.dataCache=null,this.dataList=[]}e.prototype={getLength:function(e){return this.parsedData.length},write:function(e){for(var t=0,r=this.parsedData.length;t<r;t++)e.put(this.parsedData[t],8)}},r.prototype={addData:function(t){var r=new e(t);this.dataList.push(r),this.dataCache=null},isDark:function(e,t){if(e<0||this.moduleCount<=e||t<0||this.moduleCount<=t)throw new Error(e+","+t);return this.modules[e][t]},getModuleCount:function(){return this.moduleCount},make:function(){this.makeImpl(!1,this.getBestMaskPattern())},makeImpl:function(e,t){this.moduleCount=4*this.typeNumber+17,this.modules=new Array(this.moduleCount);for(var a=0;a<this.moduleCount;a++){this.modules[a]=new Array(this.moduleCount);for(var n=0;n<this.moduleCount;n++)this.modules[a][n]=null}this.setupPositionProbePattern(0,0),this.setupPositionProbePattern(this.moduleCount-7,0),this.setupPositionProbePattern(0,this.moduleCount-7),this.setupPositionAdjustPattern(),this.setupTimingPattern(),this.setupTypeInfo(e,t),this.typeNumber>=7&&this.setupTypeNumber(e),null==this.dataCache&&(this.dataCache=r.createData(this.typeNumber,this.errorCorrectLevel,this.dataList)),this.mapData(this.dataCache,t)},setupPositionProbePattern:function(e,t){for(var r=-1;r<=7;r++)if(!(e+r<=-1||this.moduleCount<=e+r))for(var a=-1;a<=7;a++)t+a<=-1||this.moduleCount<=t+a||(this.modules[e+r][t+a]=0<=r&&r<=6&&(0==a||6==a)||0<=a&&a<=6&&(0==r||6==r)||2<=r&&r<=4&&2<=a&&a<=4)},getBestMaskPattern:function(){for(var e=0,t=0,r=0;r<8;r++){this.makeImpl(!0,r);var a=p.getLostPoint(this);(0==r||e>a)&&(e=a,t=r)}return t},createMovieClip:function(e,t,r){var a=e.createEmptyMovieClip(t,r);this.make();for(var n=0;n<this.modules.length;n++)for(var i=1*n,s=0;s<this.modules[n].length;s++){var o=1*s;this.modules[n][s]&&(a.beginFill(0,100),a.moveTo(o,i),a.lineTo(o+1,i),a.lineTo(o+1,i+1),a.lineTo(o,i+1),a.endFill())}return a},setupTimingPattern:function(){for(var e=8;e<this.moduleCount-8;e++)null==this.modules[e][6]&&(this.modules[e][6]=e%2==0);for(var t=8;t<this.moduleCount-8;t++)null==this.modules[6][t]&&(this.modules[6][t]=t%2==0)},setupPositionAdjustPattern:function(){for(var e=p.getPatternPosition(this.typeNumber),t=0;t<e.length;t++)for(var r=0;r<e.length;r++){var a=e[t],n=e[r];if(null==this.modules[a][n])for(var i=-2;i<=2;i++)for(var s=-2;s<=2;s++)this.modules[a+i][n+s]=-2==i||2==i||-2==s||2==s||0==i&&0==s}},setupTypeNumber:function(e){for(var t=p.getBCHTypeNumber(this.typeNumber),r=0;r<18;r++){var a=!e&&1==(t>>r&1);this.modules[Math.floor(r/3)][r%3+this.moduleCount-8-3]=a}for(r=0;r<18;r++){a=!e&&1==(t>>r&1);this.modules[r%3+this.moduleCount-8-3][Math.floor(r/3)]=a}},setupTypeInfo:function(e,t){for(var r=this.errorCorrectLevel<<3|t,a=p.getBCHTypeInfo(r),n=0;n<15;n++){var i=!e&&1==(a>>n&1);n<6?this.modules[n][8]=i:n<8?this.modules[n+1][8]=i:this.modules[this.moduleCount-15+n][8]=i}for(n=0;n<15;n++){i=!e&&1==(a>>n&1);n<8?this.modules[8][this.moduleCount-n-1]=i:n<9?this.modules[8][15-n-1+1]=i:this.modules[8][15-n-1]=i}this.modules[this.moduleCount-8][8]=!e},mapData:function(e,t){for(var r=-1,a=this.moduleCount-1,n=7,i=0,s=this.moduleCount-1;s>0;s-=2)for(6==s&&s--;;){for(var o=0;o<2;o++)if(null==this.modules[a][s-o]){var u=!1;i<e.length&&(u=1==(e[i]>>>n&1)),p.getMask(t,a,s-o)&&(u=!u),this.modules[a][s-o]=u,-1==--n&&(i++,n=7)}if((a+=r)<0||this.moduleCount<=a){a-=r,r=-r;break}}}},r.PAD0=236,r.PAD1=17,r.createData=function(e,t,a){for(var n=g.getRSBlocks(e,t),i=new v,s=0;s<a.length;s++){var o=a[s];i.put(o.mode,4),i.put(o.getLength(),p.getLengthInBits(o.mode,e)),o.write(i)}var u=0;for(s=0;s<n.length;s++)u+=n[s].dataCount;if(i.getLengthInBits()>8*u)throw new Error("code length overflow. ("+i.getLengthInBits()+">"+8*u+")");for(i.getLengthInBits()+4<=8*u&&i.put(0,4);i.getLengthInBits()%8!=0;)i.putBit(!1);for(;!(i.getLengthInBits()>=8*u||(i.put(r.PAD0,8),i.getLengthInBits()>=8*u));)i.put(r.PAD1,8);return r.createBytes(i,n)},r.createBytes=function(e,t){for(var r=0,a=0,n=0,i=new Array(t.length),s=new Array(t.length),o=0;o<t.length;o++){var u=t[o].dataCount,l=t[o].totalCount-u;a=Math.max(a,u),n=Math.max(n,l),i[o]=new Array(u);for(var d=0;d<i[o].length;d++)i[o][d]=255&e.buffer[d+r];r+=u;var c=p.getErrorCorrectPolynomial(l),f=new m(i[o],c.getLength()-1).mod(c);s[o]=new Array(c.getLength()-1);for(d=0;d<s[o].length;d++){var h=d+f.getLength()-s[o].length;s[o][d]=h>=0?f.get(h):0}}var _=0;for(d=0;d<t.length;d++)_+=t[d].totalCount;var g=new Array(_),v=0;for(d=0;d<a;d++)for(o=0;o<t.length;o++)d<i[o].length&&(g[v++]=i[o][d]);for(d=0;d<n;d++)for(o=0;o<t.length;o++)d<s[o].length&&(g[v++]=s[o][d]);return g};for(var a={MODE_NUMBER:1,MODE_ALPHA_NUM:2,MODE_8BIT_BYTE:4,MODE_KANJI:8},n={L:1,M:0,Q:3,H:2},i=0,s=1,o=2,u=3,l=4,d=5,c=6,f=7,p={PATTERN_POSITION_TABLE:[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],G15:1335,G18:7973,G15_MASK:21522,getBCHTypeInfo:function(e){for(var t=e<<10;p.getBCHDigit(t)-p.getBCHDigit(p.G15)>=0;)t^=p.G15<<p.getBCHDigit(t)-p.getBCHDigit(p.G15);return(e<<10|t)^p.G15_MASK},getBCHTypeNumber:function(e){for(var t=e<<12;p.getBCHDigit(t)-p.getBCHDigit(p.G18)>=0;)t^=p.G18<<p.getBCHDigit(t)-p.getBCHDigit(p.G18);return e<<12|t},getBCHDigit:function(e){for(var t=0;0!=e;)t++,e>>>=1;return t},getPatternPosition:function(e){return p.PATTERN_POSITION_TABLE[e-1]},getMask:function(e,t,r){switch(e){case i:return(t+r)%2==0;case s:return t%2==0;case o:return r%3==0;case u:return(t+r)%3==0;case l:return(Math.floor(t/2)+Math.floor(r/3))%2==0;case d:return t*r%2+t*r%3==0;case c:return(t*r%2+t*r%3)%2==0;case f:return(t*r%3+(t+r)%2)%2==0;default:throw new Error("bad maskPattern:"+e)}},getErrorCorrectPolynomial:function(e){for(var t=new m([1],0),r=0;r<e;r++)t=t.multiply(new m([1,h.gexp(r)],0));return t},getLengthInBits:function(e,t){if(1<=t&&t<10)switch(e){case a.MODE_NUMBER:return 10;case a.MODE_ALPHA_NUM:return 9;case a.MODE_8BIT_BYTE:case a.MODE_KANJI:return 8;default:throw new Error("mode:"+e)}else if(t<27)switch(e){case a.MODE_NUMBER:return 12;case a.MODE_ALPHA_NUM:return 11;case a.MODE_8BIT_BYTE:return 16;case a.MODE_KANJI:return 10;default:throw new Error("mode:"+e)}else{if(!(t<41))throw new Error("type:"+t);switch(e){case a.MODE_NUMBER:return 14;case a.MODE_ALPHA_NUM:return 13;case a.MODE_8BIT_BYTE:return 16;case a.MODE_KANJI:return 12;default:throw new Error("mode:"+e)}}},getLostPoint:function(e){for(var t=e.getModuleCount(),r=0,a=0;a<t;a++)for(var n=0;n<t;n++){for(var i=0,s=e.isDark(a,n),o=-1;o<=1;o++)if(!(a+o<0||t<=a+o))for(var u=-1;u<=1;u++)n+u<0||t<=n+u||0==o&&0==u||s==e.isDark(a+o,n+u)&&i++;i>5&&(r+=3+i-5)}for(a=0;a<t-1;a++)for(n=0;n<t-1;n++){var l=0;e.isDark(a,n)&&l++,e.isDark(a+1,n)&&l++,e.isDark(a,n+1)&&l++,e.isDark(a+1,n+1)&&l++,0!=l&&4!=l||(r+=3)}for(a=0;a<t;a++)for(n=0;n<t-6;n++)e.isDark(a,n)&&!e.isDark(a,n+1)&&e.isDark(a,n+2)&&e.isDark(a,n+3)&&e.isDark(a,n+4)&&!e.isDark(a,n+5)&&e.isDark(a,n+6)&&(r+=40);for(n=0;n<t;n++)for(a=0;a<t-6;a++)e.isDark(a,n)&&!e.isDark(a+1,n)&&e.isDark(a+2,n)&&e.isDark(a+3,n)&&e.isDark(a+4,n)&&!e.isDark(a+5,n)&&e.isDark(a+6,n)&&(r+=40);var d=0;for(n=0;n<t;n++)for(a=0;a<t;a++)e.isDark(a,n)&&d++;return r+=10*(Math.abs(100*d/t/t-50)/5)}},h={glog:function(e){if(e<1)throw new Error("glog("+e+")");return h.LOG_TABLE[e]},gexp:function(e){for(;e<0;)e+=255;for(;e>=256;)e-=255;return h.EXP_TABLE[e]},EXP_TABLE:new Array(256),LOG_TABLE:new Array(256)},_=0;_<8;_++)h.EXP_TABLE[_]=1<<_;for(_=8;_<256;_++)h.EXP_TABLE[_]=h.EXP_TABLE[_-4]^h.EXP_TABLE[_-5]^h.EXP_TABLE[_-6]^h.EXP_TABLE[_-8];for(_=0;_<255;_++)h.LOG_TABLE[h.EXP_TABLE[_]]=_;function m(e,t){if(null==e.length)throw new Error(e.length+"/"+t);for(var r=0;r<e.length&&0==e[r];)r++;this.num=new Array(e.length-r+t);for(var a=0;a<e.length-r;a++)this.num[a]=e[a+r]}function g(e,t){this.totalCount=e,this.dataCount=t}function v(){this.buffer=[],this.length=0}m.prototype={get:function(e){return this.num[e]},getLength:function(){return this.num.length},multiply:function(e){for(var t=new Array(this.getLength()+e.getLength()-1),r=0;r<this.getLength();r++)for(var a=0;a<e.getLength();a++)t[r+a]^=h.gexp(h.glog(this.get(r))+h.glog(e.get(a)));return new m(t,0)},mod:function(e){if(this.getLength()-e.getLength()<0)return this;for(var t=h.glog(this.get(0))-h.glog(e.get(0)),r=new Array(this.getLength()),a=0;a<this.getLength();a++)r[a]=this.get(a);for(a=0;a<e.getLength();a++)r[a]^=h.gexp(h.glog(e.get(a))+t);return new m(r,0).mod(e)}},g.RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],g.getRSBlocks=function(e,t){var r=g.getRsBlockTable(e,t);if(null==r)throw new Error("bad rs block @ typeNumber:"+e+"/errorCorrectLevel:"+t);for(var a=r.length/3,n=[],i=0;i<a;i++)for(var s=r[3*i+0],o=r[3*i+1],u=r[3*i+2],l=0;l<s;l++)n.push(new g(o,u));return n},g.getRsBlockTable=function(e,t){switch(t){case n.L:return g.RS_BLOCK_TABLE[4*(e-1)+0];case n.M:return g.RS_BLOCK_TABLE[4*(e-1)+1];case n.Q:return g.RS_BLOCK_TABLE[4*(e-1)+2];case n.H:return g.RS_BLOCK_TABLE[4*(e-1)+3];default:return}},v.prototype={get:function(e){var t=Math.floor(e/8);return 1==(this.buffer[t]>>>7-e%8&1)},put:function(e,t){for(var r=0;r<t;r++)this.putBit(1==(e>>>t-r-1&1))},getLengthInBits:function(){return this.length},putBit:function(e){var t=Math.floor(this.length/8);this.buffer.length<=t&&this.buffer.push(0),e&&(this.buffer[t]|=128>>>this.length%8),this.length++}};var E=[[17,14,11,7],[32,26,20,14],[53,42,32,24],[78,62,46,34],[106,84,60,44],[134,106,74,58],[154,122,86,64],[192,152,108,84],[230,180,130,98],[271,213,151,119],[321,251,177,137],[367,287,203,155],[425,331,241,177],[458,362,258,194],[520,412,292,220],[586,450,322,250],[644,504,364,280],[718,560,394,310],[792,624,442,338],[858,666,482,382],[929,711,509,403],[1003,779,565,439],[1091,857,611,461],[1171,911,661,511],[1273,997,715,535],[1367,1059,751,593],[1465,1125,805,625],[1528,1190,868,658],[1628,1264,908,698],[1732,1370,982,742],[1840,1452,1030,790],[1952,1538,1112,842],[2068,1628,1168,898],[2188,1722,1228,958],[2303,1809,1283,983],[2431,1911,1351,1051],[2563,1989,1423,1093],[2699,2099,1499,1139],[2809,2213,1579,1219],[2953,2331,1663,1273]],y=function(e,t){this._bIsPainted=!1,this._htOption=t,this._elCanvas=document.createElement("canvas"),this._elCanvas.width=t.width,this._elCanvas.height=t.height,this._elCanvas.setAttribute("aria-label","Scan me!"),this._elCanvas.setAttribute("role","img"),e.appendChild(this._elCanvas),this._el=e,this._oContext=this._elCanvas.getContext("2d"),this._bIsPainted=!1,this._bSupportDataURI=null};function S(e,t){for(var r=1,a=e instanceof ArrayBuffer?e.byteLength:function(e){var t=encodeURI(e).toString().replace(/\%[0-9a-fA-F]{2}/g,"a");return t.length+(t.length!=e.length?3:0)}(e),i=0,s=E.length;i<=s;i++){var o=0;switch(t){case n.L:o=E[i][0];break;case n.M:o=E[i][1];break;case n.Q:o=E[i][2];break;case n.H:o=E[i][3]}if(a<=o)break;r++}if(r>E.length)throw new Error("Too long data");return r}y.prototype.draw=function(e){var t=this._oContext,r=this._htOption,a=e.getModuleCount(),n=r.width/a,i=r.height/a,s=Math.round(n),o=Math.round(i);this.clear();for(var u=0;u<a;u++)for(var l=0;l<a;l++){var d=e.isDark(u,l),c=l*n,f=u*i;t.strokeStyle=d?r.colorDark:r.colorLight,t.lineWidth=1,t.fillStyle=d?r.colorDark:r.colorLight,t.fillRect(c,f,n,i),t.strokeRect(Math.floor(c)+.5,Math.floor(f)+.5,s,o),t.strokeRect(Math.ceil(c)-.5,Math.ceil(f)-.5,s,o)}this._bIsPainted=!0},y.prototype.isPainted=function(){return this._bIsPainted},y.prototype.clear=function(){this._oContext.clearRect(0,0,this._elCanvas.width,this._elCanvas.height),this._bIsPainted=!1},y.prototype.round=function(e){return e?Math.floor(1e3*e)/1e3:e},(t=function(e,t){if(this._htOption={width:256,height:256,typeNumber:4,colorDark:"#000000",colorLight:"#ffffff",correctLevel:n.H},"string"==typeof t&&(t={text:t}),t)for(var r in t)this._htOption[r]=t[r];"string"==typeof e&&(e=document.getElementById(e)),this._el=e,this._oQRCode=null,this._oDrawing=new y(this._el,this._htOption),this._htOption.text&&this.makeCode(this._htOption.text)}).prototype.makeCode=function(e){this._oQRCode=new r(S(e,this._htOption.correctLevel),this._htOption.correctLevel),this._oQRCode.addData(e),this._oQRCode.make(),this._el.title=e,this._oDrawing.draw(this._oQRCode)},t.prototype.clear=function(){this._oDrawing.clear()},t.CorrectLevel=n}(),e.exports=t},48729:(e,t,r)=>{var a={"./af":[50170,6365],"./af.js":[50170,6365],"./ar":[34798,8054],"./ar-XB":[95257,9995],"./ar-XB.js":[95257,9995],"./ar.js":[34798,8054],"./az":[34962,7072],"./az.js":[34962,7072],"./bg":[87385,7102],"./bg.js":[87385,7102],"./bn":[56544,8700],"./bn.js":[56544,8700],"./ca":[76369,5632],"./ca.js":[76369,5632],"./cs":[34118,165],"./cs.js":[34118,165],"./da":[89538,1628],"./da.js":[89538,1628],"./de":[56175,7216],"./de.js":[56175,7216],"./el":[18749,1204],"./el.js":[18749,1204],"./en":[15e3,6933],"./en.js":[15e3,6933],"./es":[23377,673],"./es.js":[23377,673],"./et":[47243,792],"./et.js":[47243,792],"./fa":[40935,9999],"./fa.js":[40935,9999],"./fi":[34956,9613],"./fi.js":[34956,9613],"./fil":[16343,907],"./fil.js":[16343,907],"./fr":[74734,6293],"./fr.js":[74734,6293],"./gu":[54217,6038],"./gu.js":[54217,6038],"./he":[8117,5729],"./he.js":[8117,5729],"./hi":[90888,3722],"./hi.js":[90888,3722],"./hr":[33372,5708],"./hr.js":[33372,5708],"./hu":[25382,2556],"./hu.js":[25382,2556],"./id":[62382,5128],"./id.js":[62382,5128],"./it":[38921,2830],"./it.js":[38921,2830],"./ja":[13278,5182],"./ja.js":[13278,5182],"./kk":[42193,9719],"./kk.js":[42193,9719],"./kn":[80155,155],"./kn.js":[80155,155],"./ko":[32091,820],"./ko.js":[32091,820],"./lt":[56976,1529],"./lt.js":[56976,1529],"./lv":[61979,4708],"./lv.js":[61979,4708],"./mk":[48274,6651],"./mk.js":[48274,6651],"./ml":[15939,6655],"./ml.js":[15939,6655],"./mr":[4486,1248],"./mr.js":[4486,1248],"./ms":[80885,5443],"./ms.js":[80885,5443],"./nb":[85792,7749],"./nb.js":[85792,7749],"./nl":[25030,9750],"./nl.js":[25030,9750],"./pa":[82191,9815],"./pa.js":[82191,9815],"./pl":[22808,8628],"./pl.js":[22808,8628],"./pt":[44279,2144,6953],"./pt-BR":[73179,2144,2091],"./pt-BR.js":[73179,2144,2091],"./pt.js":[44279,2144,6953],"./ro":[86658,7162],"./ro.js":[86658,7162],"./ru":[4793,8292],"./ru.js":[4793,8292],"./sk":[21261,1770],"./sk.js":[21261,1770],"./sl":[64435,4259],"./sl.js":[64435,4259],"./sq":[7914,9737],"./sq.js":[7914,9737],"./sr":[37550,6331],"./sr.js":[37550,6331],"./sv":[93102,2944],"./sv.js":[93102,2944],"./sw":[20329,3998],"./sw.js":[20329,3998],"./ta":[96910,2739],"./ta.js":[96910,2739],"./te":[93299,5650],"./te.js":[93299,5650],"./th":[60483,2135],"./th.js":[60483,2135],"./tr":[79133,248],"./tr.js":[79133,248],"./uk":[58851,906],"./uk.js":[58851,906],"./ur":[93511,4361],"./ur.js":[93511,4361],"./uz":[84428,4873],"./uz.js":[84428,4873],"./vi":[64794,8598],"./vi.js":[64794,8598],"./zh-CN":[96530,6483],"./zh-CN.js":[96530,6483],"./zh-HK":[30490,1081],"./zh-HK.js":[30490,1081],"./zh-TW":[28045,7542],"./zh-TW.js":[28045,7542]};function n(e){if(!r.o(a,e))return Promise.resolve().then((()=>{var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=a[e],n=t[0];return Promise.all(t.slice(1).map(r.e)).then((()=>r(n)))}n.keys=()=>Object.keys(a),n.id=48729,e.exports=n},77062:(e,t,r)=>{var a={"./af":[65740,3748],"./af.js":[65740,3748],"./ar":[40550,1473],"./ar-DZ":[72124,6884],"./ar-DZ.js":[72124,6884],"./ar-KW":[54028,6282],"./ar-KW.js":[54028,6282],"./ar-LY":[68801,5671],"./ar-LY.js":[68801,5671],"./ar-MA":[60603,2966],"./ar-MA.js":[60603,2966],"./ar-SA":[52816,9646],"./ar-SA.js":[52816,9646],"./ar-TN":[6331,9289],"./ar-TN.js":[6331,9289],"./ar-XB":[89554,3934],"./ar-XB.js":[89554,3934],"./ar.js":[40550,1473],"./az":[75596,5740],"./az.js":[75596,5740],"./bn":[33009,7728],"./bn.js":[33009,7728],"./ca":[56321,9817],"./ca.js":[56321,9817],"./cs":[29027,2023],"./cs.js":[29027,2023],"./da":[80357,7315],"./da.js":[80357,7315],"./de":[85934,5862],"./de.js":[85934,5862],"./el":[65098,1055],"./el.js":[65098,1055],"./en-AU":[89197,8678],"./en-AU.js":[89197,8678],"./en-CA":[89284,4616],"./en-CA.js":[89284,4616],"./en-GB":[64418,9227],"./en-GB.js":[64418,9227],"./en-IE":[46662,2979],"./en-IE.js":[46662,2979],"./en-NZ":[95027,3892],"./en-NZ.js":[95027,3892],"./es":[76686,1791],"./es-DO":[49147,2394],"./es-DO.js":[49147,2394],"./es.js":[76686,1791],"./et":[87655,4473],"./et.js":[87655,4473],"./fa":[38674,7662],"./fa.js":[38674,7662],"./fi":[40295,7386],"./fi.js":[40295,7386],"./fr":[96698,2445],"./fr-CA":[44666,9765],"./fr-CA.js":[44666,9765],"./fr-CH":[9990,8799],"./fr-CH.js":[9990,8799],"./fr.js":[96698,2445],"./he":[86621,5027],"./he.js":[86621,5027],"./hi":[41400,6709],"./hi.js":[41400,6709],"./hr":[35134,1381],"./hr.js":[35134,1381],"./hu":[90921,4339],"./hu.js":[90921,4339],"./id":[32610,6511],"./id.js":[32610,6511],"./it":[68040,5247],"./it.js":[68040,5247],"./kk":[11847,7074],"./kk.js":[11847,7074],"./kn":[61586,6568],"./kn.js":[61586,6568],"./ko":[57214,4818],"./ko.js":[57214,4818],"./lt":[2684,6920],"./lt.js":[2684,6920],"./mk":[35635,9545],"./mk.js":[35635,9545],"./ml":[10061,3113],"./ml.js":[10061,3113],"./mr":[68890,3422],"./mr.js":[68890,3422],"./ms":[33721,7739],"./ms-MY":[51720,1520],"./ms-MY.js":[51720,1520],"./ms.js":[33721,7739],"./nb":[54544,5959],"./nb.js":[54544,5959],"./nl":[25369,319],"./nl.js":[25369,319],"./pa-IN":[38390,8132],"./pa-IN.js":[38390,8132],"./pl":[96067,4980],"./pl.js":[96067,4980],"./pt":[70854,9116],"./pt-BR":[1436,6547],"./pt-BR.js":[1436,6547],"./pt.js":[70854,9116],"./ro":[73726,3569],"./ro.js":[73726,3569],"./ru":[88787,2957],"./ru.js":[88787,2957],"./sl":[47540,3501],"./sl.js":[47540,3501],"./sq":[1740,6496],"./sq.js":[1740,6496],"./sr":[75476,5170],"./sr-CYRL":[24919,5790],"./sr-CYRL.js":[24919,5790],"./sr.js":[75476,5170],"./sv":[62374,1069],"./sv.js":[62374,1069],"./sw":[84825,2017],"./sw.js":[84825,2017],"./ta":[54921,8634],"./ta.js":[54921,8634],"./te":[2901,3370],"./te.js":[2901,3370],"./tr":[27949,9313],"./tr.js":[27949,9313],"./uk":[68515,9682],"./uk.js":[68515,9682],"./ur":[53918,6163],"./ur.js":[53918,6163],"./uz":[58299,3017],"./uz-LATN":[27249,8117],"./uz-LATN.js":[27249,8117],"./uz.js":[58299,3017],"./zh-CN":[17391,3047],"./zh-CN.js":[17391,3047],"./zh-TW":[62840,5125],"./zh-TW.js":[62840,5125]};function n(e){if(!r.o(a,e))return Promise.resolve().then((()=>{var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=a[e],n=t[0];return r.e(t[1]).then((()=>r(n)))}n.keys=()=>Object.keys(a),n.id=77062,e.exports=n},11284:e=>{"use strict";e.exports=JSON.parse('{"application/":{"applixware":"aw","atom+xml":"atom","atomcat+xml":"atomcat","atomsvc+xml":"atomsvc","ccxml+xml":"ccxml","cdmi-":{"capability":"cdmia","container":"cdmic","domain":"cdmid","object":"cdmio","queue":"cdmiq"},"davmount+xml":"davmount","docbook+xml":"dbk","dssc+der":"dssc","dssc+xml":"xdssc","ecmascript":"ecma","emma+xml":"emma","epub+zip":"epub","exi":"exi","font-":{"tdpfr":"pfr","woff":"woff"},"gml+xml":"gml","gpx+xml":"gpx","gxf":"gxf","hyperstudio":"stk","inkml+xml":["ink","inkml"],"ipfix":"ipfix","java-":{"archive":"jar","vm":"class","serialized-object":"ser"},"javascript":"js","json":"json","jsonml+json":"jsonml","lost+xml":"lostxml","mac-":{"binhex40":"hqx","compactpro":"cpt"},"mads+xml":"mads","marc":"mrc","marcxml+xml":"mrcx","mathematica":["ma","nb","mb"],"mathml+xml":"mathml","mbox":"mbox","mediaservercontrol+xml":"mscml","metalink+xml":"metalink","metalink4+xml":"meta4","mets+xml":"mets","mods+xml":"mods","mp21":["m21","mp21"],"mp4":"mp4s","msword":["doc","dot"],"mxf":"mxf","oda":"oda","ogg":"ogx","omdoc+xml":"omdoc","onenote":["onetoc","onetoc2","onetmp","onepkg"],"oxps":"oxps","pdf":"pdf","pgp-":{"encrypted":"pgp","signature":["asc","sig"]},"pkcs10":"p10","pkcs7-":{"mime":["p7m","p7c"],"signature":"p7s"},"pkcs8":"p8","pkix-":{"cert":"cer","crl":"crl","pkipath":"pkipath","attr-cert":"ac"},"pkixcmp":"pki","pls+xml":"pls","postscript":["ai","eps","ps"],"pskc+xml":"pskcxml","rdf+xml":"rdf","reginfo+xml":"rif","resource-":{"lists+xml":"rl","lists-diff+xml":"rld"},"rpki-":{"ghostbusters":"gbr","manifest":"mft","roa":"roa"},"rsd+xml":"rsd","rss+xml":"rss","rtf":"rtf","sbml+xml":"sbml","scvp-":{"cv-":{"request":"scq","response":"scs"},"vp-":{"request":"spq","response":"spp"}},"sdp":"sdp","set-":{"payment-initiation":"setpay","registration-initiation":"setreg"},"shf+xml":"shf","smil+xml":["smi","smil"],"sparql-":{"query":"rq","results+xml":"srx"},"srgs":"gram","srgs+xml":"grxml","sru+xml":"sru","ssdl+xml":"ssdl","ssml+xml":"ssml","tei+xml":["tei","teicorpus"],"thraud+xml":"tfi","vnd.":{"acucobol":"acu","acucorp":["atc","acutc"],"adobe.":{"fxp":["fxp","fxpl"],"xdp+xml":"xdp","xfdf":"xfdf","formscentral.fcdt":"fcdt","air-application-installer-package+zip":"air"},"apple.":{"installer+xml":"mpkg","mpegurl":"m3u8"},"audiograph":"aep","bmi":"bmi","businessobjects":"rep","chemdraw+xml":"cdxml","cinderella":"cdy","claymore":"cla","commonspace":"csp","cosmocaller":"cmc","crick.":{"clicker":"clkx","clicker.":{"keyboard":"clkk","palette":"clkp","template":"clkt","wordbank":"clkw"}},"curl.":{"car":"car","pcurl":"pcurl"},"dart":"dart","dece.":{"data":["uvf","uvvf","uvd","uvvd"],"ttml+xml":["uvt","uvvt"],"unspecified":["uvx","uvvx"],"zip":["uvz","uvvz"]},"dna":"dna","dpgraph":"dpg","dreamfactory":"dfac","dvb.":{"ait":"ait","service":"svc"},"dynageo":"geo","enliven":"nml","epson.":{"esf":"esf","msf":"msf","quickanime":"qam","salt":"slt","ssf":"ssf"},"eszigno3+xml":["es3","et3"],"ezpix-":{"album":"ez2","package":"ez3"},"fdf":"fdf","fdsn.":{"mseed":"mseed","seed":["seed","dataless"]},"flographit":"gph","framemaker":["fm","frame","maker","book"],"frogans.":{"fnc":"fnc","ltf":"ltf"},"fujitsu.":{"oasys":"oas","oasys2":"oa2","oasys3":"oa3","oasysgp":"fg5","oasysprs":"bh2"},"fujixerox.":{"ddd":"ddd","docuworks":"xdw","docuworks.binder":"xbd"},"fuzzysheet":"fzs","geogebra.":{"file":"ggb","tool":"ggt"},"geonext":"gxt","geoplan":"g2w","geospace":"g3w","gmx":"gmx","grafeq":["gqf","gqs"],"groove-":{"account":"gac","help":"ghf","injector":"grv","tool-":{"message":"gtm","template":"tpl"},"vcard":"vcg","identity-message":"gim"},"hal+xml":"hal","hbci":"hbci","hp-":{"hpgl":"hpgl","hpid":"hpid","hps":"hps","jlyt":"jlt","pcl":"pcl","pclxl":"pclxl"},"ibm.":{"minipay":"mpy","modcap":["afp","listafp","list3820"],"rights-management":"irm","secure-container":"sc"},"iccprofile":["icc","icm"],"igloader":"igl","immervision-":{"ivp":"ivp","ivu":"ivu"},"intergeo":"i2g","intu.":{"qbo":"qbo","qfx":"qfx"},"jam":"jam","jisp":"jisp","kahootz":["ktz","ktr"],"kde.":{"karbon":"karbon","kchart":"chrt","kformula":"kfo","kivio":"flw","kontour":"kon","kpresenter":["kpr","kpt"],"kspread":"ksp","kword":["kwd","kwt"]},"kenameaapp":"htke","kidspiration":"kia","kinar":["kne","knp"],"koan":["skp","skd","skt","skm"],"lotus-":{"approach":"apr","freelance":"pre","notes":"nsf","organizer":"org","screencam":"scm","wordpro":"lwp","1-2-3":"123"},"mcd":"mcd","medcalcdata":"mc1","mfer":"mwf","mfmp":"mfm","micrografx.":{"flo":"flo","igx":"igx"},"mif":"mif","mobius.":{"daf":"daf","dis":"dis","mbk":"mbk","mqy":"mqy","msl":"msl","plc":"plc","txf":"txf"},"mophun.":{"application":"mpn","certificate":"mpc"},"ms-":{"artgalry":"cil","excel":["xls","xlm","xla","xlc","xlt","xlw"],"excel.":{"sheet.":{"macroenabled.12":"xlsm","binary.macroenabled.12":"xlsb"},"addin.macroenabled.12":"xlam","template.macroenabled.12":"xltm"},"fontobject":"eot","htmlhelp":"chm","ims":"ims","lrm":"lrm","officetheme":"thmx","pki.":{"seccat":"cat","stl":"stl"},"powerpoint":["ppt","pps","pot"],"powerpoint.":{"addin.macroenabled.12":"ppam","presentation.macroenabled.12":"pptm","slide.macroenabled.12":"sldm","slideshow.macroenabled.12":"ppsm","template.macroenabled.12":"potm"},"project":["mpp","mpt"],"word.":{"document.macroenabled.12":"docm","template.macroenabled.12":"dotm"},"works":["wps","wks","wcm","wdb"],"wpl":"wpl","xpsdocument":"xps","cab-compressed":"cab"},"mseq":"mseq","musician":"mus","mynfc":"taglet","nitf":["ntf","nitf"],"noblenet-":{"directory":"nnd","sealer":"nns","web":"nnw"},"nokia.":{"radio-":{"preset":"rpst","presets":"rpss"},"n-gage.":{"data":"ngdat","symbian.install":"n-gage"}},"novadigm.":{"edm":"edm","edx":"edx","ext":"ext"},"osgi.":{"dp":"dp","subsystem":"esa"},"palm":["pdb","pqa","oprc"],"pawaafile":"paw","pg.":{"format":"str","osasli":"ei6"},"picsel":"efif","pocketlearn":"plf","powerbuilder6":"pbd","recordare.":{"musicxml":"mxl","musicxml+xml":"musicxml"},"rn-":{"realmedia":"rm","realmedia-vbr":"rmvb"},"seemail":"see","sema":"sema","semd":"semd","semf":"semf","smaf":"mmf","spotfire.":{"dxp":"dxp","sfs":"sfs"},"stardivision.":{"calc":"sdc","draw":"sda","impress":"sdd","math":"smf","writer":["sdw","vor"],"writer-global":"sgl"},"stepmania.":{"package":"smzip","stepchart":"sm"},"svd":"svd","syncml+xml":"xsm","syncml.":{"dm+wbxml":"bdm","dm+xml":"xdm"},"trueapp":"tra","ufdl":["ufd","ufdl"],"umajin":"umj","unity":"unityweb","uoml+xml":"uoml","vcx":"vcx","visio":["vsd","vst","vss","vsw"],"visionary":"vis","vsf":"vsf","Webd.":{"wbxml":"wbxml","wmlc":"wmlc","wmlscriptc":"wmlsc"},"webturbo":"wtb","wordperfect":"wpd","wqd":"wqd","xara":"xar","xfdl":"xfdl","yamaha.":{"hv-":{"dic":"hvd","script":"hvs","voice":"hvp"},"openscoreformat":"osf","smaf-":{"audio":"saf","phrase":"spf"},"openscoreformat.osfpvg+xml":"osfpvg"},"zul":["zir","zirz"],"3gpp2.tcap":"tcap","accpac.simply.":{"aso":"aso","imp":"imp"},"ahead.space":"ahead","airzip.filesecure.":{"azf":"azf","azs":"azs"},"amazon.ebook":"azw","americandynamics.acc":"acc","amiga.ami":"ami","anser-web-":{"certificate-issue-initiation":"cii","funds-transfer-initiation":"fti"},"aristanetworks.swi":"swi","blueice.multipass":"mpm","cloanto.rp9":"rp9","clonk.c4group":["c4g","c4d","c4f","c4p","c4u"],"cluetrust.cartomobile-":{"config":"c11amc","config-pkg":"c11amz"},"contact.cmsg":"cdbcmsg","criticaltools.wbs+xml":"wbs","ctc-posml":"pml","cups-ppd":"ppd","dolby.mlp":"mlp","ds-keypoint":"kpxx","ecowin.chart":"mag","fluxtime.clip":"ftc","fsc.weblaunch":"fsc","genomatix.tuxedo":"txd","geometry-explorer":["gex","gre"],"google-earth.":{"kml+xml":"kml","kmz":"kmz"},"handheld-entertainment+xml":"zmm","insors.igm":"igm","intercon.formnet":["xpw","xpx"],"ipunplugged.rcprofile":"rcprofile","irepository.package+xml":"irp","is-xpr":"xpr","isac.fcs":"fcs","kodak-descriptor":"sse","las.las+xml":"lasxml","macports.portpkg":"portpkg","mediastation.cdkey":"cdkey","mozilla.xul+xml":"xul","muvee.style":"msty","neurolanguage.nlu":"nlu","oasis.opendocument.":{"chart":"odc","database":"odb","formula":"odf","graphics":"odg","image":"odi","presentation":"odp","spreadsheet":"ods","text":"odt","text-":{"master":"odm","template":"ott","web":"oth"},"chart-template":"otc","formula-template":"odft","graphics-template":"otg","image-template":"oti","presentation-template":"otp","spreadsheet-template":"ots"},"olpc-sugar":"xo","oma.dd2+xml":"dd2","openofficeorg.extension":"oxt","openxmlformats-officedocument.":{"presentationml.":{"presentation":"pptx","slide":"sldx","slideshow":"ppsx","template":"potx"},"spreadsheetml.":{"sheet":"xlsx","template":"xltx"},"wordprocessingml.":{"document":"docx","template":"dotx"}},"pmi.widget":"wg","previewsystems.box":"box","proteus.magazine":"mgz","pvi.ptid1":"ptid","quark.quarkxpress":["qxd","qxt","qwd","qwt","qxl","qxb"],"realvnc.bed":"bed","rig.cryptonote":"cryptonote","rim.cod":"cod","route66.link66+xml":"link66","sailingtracker.track":"st","shana.informed.":{"formdata":"ifm","formtemplate":"itp","interchange":"iif","package":"ipk"},"simtech-mindmapper":["twd","twds"],"smart.teacher":"teacher","solent.sdkm+xml":["sdkm","sdkd"],"sun.xml.":{"calc":"sxc","draw":"sxd","impress":"sxi","math":"sxm","writer":"sxw","writer.":{"global":"sxg","template":"stw"},"calc.template":"stc","draw.template":"std","impress.template":"sti"},"sus-calendar":["sus","susp"],"symbian.install":["sis","sisx"],"tcpdump.pcap":["pcap","cap","dmp"],"tmobile-livetv":"tmo","trid.tpt":"tpt","triscape.mxs":"mxs","uiq.theme":"utz","wolfram.player":"nbp","wt.stf":"stf","zzazz.deck+xml":"zaz","3gpp.pic-bw-":{"large":"plb","small":"psb","var":"pvb"},"3m.post-it-notes":"pwn","android.package-archive":"apk","antix.game-component":"atx","astraea-software.iota":"iota","chipnuts.karaoke-mmd":"mmd","data-vision.rdz":"rdz","denovo.fcselayout-link":"fe_launch","hhe.lesson-player":"les","hydrostatix.sof-data":"sfd-hdstx","jcp.javame.midlet-rms":"rms","joost.joda-archive":"joda","llamagraphics.life-balance.":{"desktop":"lbd","exchange+xml":"lbe"},"osgeo.mapguide.package":"mgp","publishare-delta-tree":"qps","tao.intent-module-archive":"tao","yellowriver-custom-menu":"cmp"},"voicexml+xml":"vxml","widget":"wgt","winhlp":"hlp","wsdl+xml":"wsdl","wspolicy+xml":"wspolicy","x-":{"abiword":"abw","authorware-":{"bin":["aab","x32","u32","vox"],"map":"aam","seg":"aas"},"bcpio":"bcpio","bittorrent":"torrent","blorb":["blb","blorb"],"bzip":"bz","bzip2":["bz2","boz"],"cbr":["cbr","cba","cbt","cbz","cb7"],"cdlink":"vcd","chat":"chat","conference":"nsc","cpio":"cpio","csh":"csh","director":["dir","dcr","dxr","cst","cct","cxt","w3d","fgd","swa"],"doom":"wad","dtbncx+xml":"ncx","dtbook+xml":"dtb","dtbresource+xml":"res","dvi":"dvi","envoy":"evy","eva":"eva","font-":{"bdf":"bdf","ghostscript":"gsf","otf":"otf","pcf":"pcf","snf":"snf","ttf":["ttf","ttc"],"type1":["pfa","pfb","pfm","afm"],"linux-psf":"psf"},"freearc":"arc","futuresplash":"spl","glulx":"ulx","gnumeric":"gnumeric","gtar":"gtar","hdf":"hdf","latex":"latex","mie":"mie","ms-":{"application":"application","shortcut":"lnk","wmd":"wmd","wmz":"wmz","xbap":"xbap"},"msaccess":"mdb","msbinder":"obd","mscardfile":"crd","msclip":"clp","msdownload":["exe","dll","com","bat","msi"],"msmediaview":["mvb","m13","m14"],"msmetafile":["wmf","wmz","emf","emz"],"msmoney":"mny","mspublisher":"pub","msschedule":"scd","msterminal":"trm","mswrite":"wri","netcdf":["nc","cdf"],"nzb":"nzb","pkcs12":["p12","pfx"],"pkcs7-":{"certificates":["p7b","spc"],"certreqresp":"p7r"},"sh":"sh","shar":"shar","sql":"sql","stuffit":"sit","stuffitx":"sitx","subrip":"srt","sv4cpio":"sv4cpio","sv4crc":"sv4crc","tads":"gam","tar":"tar","tcl":"tcl","tex":"tex","texinfo":["texinfo","texi"],"tgif":"obj","ustar":"ustar","xfig":"fig","xliff+xml":"xlf","xpinstall":"xpi","xz":"xz","zmachine":["z1","z2","z3","z4","z5","z6","z7","z8"],"7z-compressed":"7z","ace-compressed":"ace","apple-diskimage":"dmg","cfs-compressed":"cfs","chess-pgn":"pgn","debian-package":["deb","udeb"],"dgc-compressed":"dgc","gca-compressed":"gca","gramps-xml":"gramps","install-instructions":"install","iso9660-image":"iso","lzh-compressed":["lzh","lha"],"mobipocket-ebook":["prc","mobi"],"rar-compressed":"rar","shockwave-flash":"swf","silverlight-app":"xap","t3vm-image":"t3","tex-tfm":"tfm","wais-source":"src","java-jnlp-file":"jnlp","research-info-systems":"ris","x509-ca-cert":["der","crt"]},"xaml+xml":"xaml","xenc+xml":"xenc","xhtml+xml":["xhtml","xht"],"xml":["xml","xsl"],"xop+xml":"xop","xproc+xml":"xpl","xslt+xml":"xslt","xspf+xml":"xspf","xv+xml":["mxml","xhvml","xvml","xvm"],"yang":"yang","yin+xml":"yin","zip":"zip","andrew-inset":"ez","cu-seeme":"cu","octet-stream":["bin","dms","lrf","mar","so","dist","distz","pkg","bpk","dump","elc","deploy"],"oebps-package+xml":"opf","pics-rules":"prf","prs.cww":"cww","rls-services+xml":"rs","timestamped-data":"tsd","xcap-diff+xml":"xdf","xml-dtd":"dtd","patch-ops-error+xml":"xer","relax-ng-compact-syntax":"rnc"},"audio/":{"adpcm":"adp","basic":["au","snd"],"midi":["mid","midi","kar","rmi"],"mp4":["m4a","mp4a"],"mpeg":["mpga","mp2","mp2a","mp3","m2a","m3a"],"ogg":["oga","ogg","spx"],"s3m":"s3m","silk":"sil","vnd.":{"dra":"dra","dts":"dts","nuera.":{"ecelp4800":"ecelp4800","ecelp7470":"ecelp7470","ecelp9600":"ecelp9600"},"rip":"rip","dece.audio":["uva","uvva"],"digital-winds":"eol","dts.hd":"dtshd","lucent.voice":"lvp","ms-playready.media.pya":"pya"},"webm":"weba","x-":{"aac":"aac","aiff":["aif","aiff","aifc"],"caf":"caf","flac":"flac","matroska":"mka","mpegurl":"m3u","ms-":{"wax":"wax","wma":"wma"},"pn-":{"realaudio":["ram","ra"],"realaudio-plugin":"rmp"},"wav":"wav"},"xm":"xm"},"image/":{"bmp":"bmp","cgm":"cgm","g3fax":"g3","gif":"gif","ief":"ief","jpeg":["jpeg","jpg","jpe"],"ktx":"ktx","png":"png","sgi":"sgi","svg+xml":["svg","svgz"],"tiff":["tiff","tif"],"vnd.":{"djvu":["djvu","djv"],"dwg":"dwg","dxf":"dxf","fastbidsheet":"fbs","fpx":"fpx","fst":"fst","ms-":{"modi":"mdi","photo":"wdp"},"xiff":"xif","adobe.photoshop":"psd","dece.graphic":["uvi","uvvi","uvg","uvvg"],"dvb.subtitle":"sub","fujixerox.edmics-":{"mmr":"mmr","rlc":"rlc"},"net-fpx":"npx","wap.wbmp":"wbmp"},"webp":"webp","x-":{"3ds":"3ds","cmx":"cmx","freehand":["fh","fhc","fh4","fh5","fh7"],"icon":"ico","pcx":"pcx","pict":["pic","pct"],"portable-":{"anymap":"pnm","bitmap":"pbm","graymap":"pgm","pixmap":"ppm"},"rgb":"rgb","tga":"tga","xbitmap":"xbm","xpixmap":"xpm","xwindowdump":"xwd","cmu-raster":"ras","mrsid-image":"sid"},"prs.btif":"btif"},"model/":{"iges":["igs","iges"],"mesh":["msh","mesh","silo"],"vnd.":{"collada+xml":"dae","dwf":"dwf","gdl":"gdl","gtw":"gtw","mts":"mts","vtu":"vtu"},"vrml":["wrl","vrml"],"x3d+binary":["x3db","x3dbz"],"x3d+vrml":["x3dv","x3dvz"],"x3d+xml":["x3d","x3dz"]},"text/":{"calendar":["ics","ifb"],"css":"css","csv":"csv","html":["html","htm"],"n3":"n3","plain":["txt","text","conf","def","list","log","in"],"richtext":"rtx","sgml":["sgml","sgm"],"troff":["t","tr","roff","man","me","ms"],"turtle":"ttl","vcard":"vcard","vnd.":{"curl":"curl","curl.":{"dcurl":"dcurl","mcurl":"mcurl","scurl":"scurl"},"fly":"fly","graphviz":"gv","in3d.":{"3dml":"3dml","spot":"spot"},"wap.":{"wml":"wml","wmlscript":"wmls"},"dvb.subtitle":"sub","fmi.flexstor":"flx","sun.j2me.app-descriptor":"jad"},"x-":{"asm":["s","asm"],"c":["c","cc","cxx","cpp","h","hh","dic"],"fortran":["f","for","f77","f90"],"nfo":"nfo","opml":"opml","pascal":["p","pas"],"setext":"etx","sfv":"sfv","uuencode":"uu","vcalendar":"vcs","vcard":"vcf","java-source":"java"},"cache-manifest":"appcache","uri-list":["uri","uris","urls"],"prs.lines.tag":"dsc","tab-separated-values":"tsv"},"video/":{"3gpp":"3gp","3gpp2":"3g2","h261":"h261","h263":"h263","h264":"h264","jpeg":"jpgv","jpm":["jpm","jpgm"],"mj2":["mj2","mjp2"],"mp4":["mp4","mp4v","mpg4"],"mpeg":["mpeg","mpg","mpe","m1v","m2v"],"ogg":"ogv","quicktime":["qt","mov"],"vnd.":{"dece.":{"hd":["uvh","uvvh"],"mobile":["uvm","uvvm"],"pd":["uvp","uvvp"],"sd":["uvs","uvvs"],"video":["uvv","uvvv"]},"fvt":"fvt","mpegurl":["mxu","m4u"],"vivo":"viv","dvb.file":"dvb","uvvu.mp4":["uvu","uvvu"],"ms-playready.media.pyv":"pyv"},"webm":"webm","x-":{"f4v":"f4v","fli":"fli","flv":"flv","m4v":"m4v","matroska":["mkv","mk3d","mks"],"mng":"mng","ms-":{"asf":["asf","asx"],"vob":"vob","wm":"wm","wmv":"wmv","wmx":"wmx","wvx":"wvx"},"msvideo":"avi","smv":"smv","sgi-movie":"movie"}},"chemical/x-":{"cdx":"cdx","cif":"cif","cmdf":"cmdf","cml":"cml","csml":"csml","xyz":"xyz"},"message/rfc822":["eml","mime"],"x-conference/x-cooltalk":"ice"}')},215:e=>{"use strict";e.exports=JSON.parse('{"prefixHash":"99abb3d4056fa7f1eea545403cd324c8"}')},19705:e=>{"use strict";e.exports=JSON.parse('{"":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""}')},31881:(e,t,r)=>{"use strict";r.r(t),t.default=[["","Add additional hours","Chat list","Close panel","Open the chat context menu","This is a disappearing message","Full screen","Exit full screen","Mute","Pause","Play","Unmute","Message list. Press right arrow key on a message to open message context menu.","Message list. Press left arrow key on a message to open message context menu.","__author__:","You:","Delivered","Pending","Read","Sent","Voice message","Muted chat","Open emojis panel","Open gif panel","Open sticker panel","Cancel","Voice message","Send","Result: __name__","Search results.","Starred","Sticker with: __emojis__","Sticker with no label","Unselect category","View once info","Turn off view once","Turn on view once","Changing __count__ label","The label could not be updated","__count__ label changed","Adding new label: __labelName__","Archived chats will unarchive when you receive a new message.","Couldn't change archive setting.","Changing archive setting","Archived chats will remain archived when you receive a new message.","Couldn't block __participant__","__participant__ blocked","Blocking __participant__","Couldn't delete broadcast list.","Broadcast list deleted","Broadcast list deleted from this device","Deleting broadcast list","Group setting could not be changed","Couldn't archive chat.","Chat archived","Archiving chat","Couldn't clear chat.","Chat cleared","Chat cleared from this device","Clearing chat","Couldn't delete chat.","Chat deleted","Chat deleted from this device","Deleting chat","Couldn't dismiss change number notification.","Change number notification dismissed.","Dismissing change number notification.","Couldn't mark chat as read.","Couldn't mark chat as unread.","Marked as read","Marked as unread","Marking as read","Marking as unread","Couldn't mute chat.","Chat muted","Muting chat","Couldn't pin chat","You can only pin up to 3 chats.","Chat pinned","Pinning chat","Couldn't unarchive chat.","Chat unarchived","Unarchiving chat","Unmute","Couldn't unmute chat.","Chat unmuted","Unmuting chat","Couldn't unpin chat","Chat unpinned","Unpinning chat","Deleting label: __labelName__ failed","Deleted label: __labelName__","Deleting label: __labelName__","Couldn't create group.","Please enter a shorter subject.","You've created too many groups too quickly. Try again later.","Can't add more than __max__ participants","Created group","Creating group","Couldn't delete group.","Group deleted","Group deleted from this device","Deleting group","Changing group description","Group description change failed","Group description changed","Couldn't exit group.","Exited group","Exiting group","You're not a participant.","This group has ended.","You've added too many contacts to groups too quickly. Try again later.","Couldn't remove group icon.","Group icon removed","Removing group icon","Group icon set","Couldn't set group icon.","Setting group icon","Couldn't mute group.","Group muted","Muting group","Couldn't rename group.","Group renamed to __subject__","Renaming group","Group subject can't be empty","Couldn't unmute group.","Group unmuted","Unmuting group","Updating label color","Label color update failed","Label color updated","Updating label name","Label name update failed","Label name updated","Couldn't stop sharing live location","Stop sharing live location with __name__?","Stop sharing live location with __name__?","Stopped sharing live location","Stopping live location sharing","Marking as not spam","Couldn't mark as not spam","Marked as not spam","Couldn't delete message because the message may have expired","Couldn't delete message","__count__ message deleted","Deleting message","Couldn't star message because the message may have expired","Couldn't star message","__count__ message starred","Starring message","Couldn't unstar all messages","Couldn't unstar message because the message may have expired","Couldn't unstar message","__count__ message unstarred","All messages unstarred","Unstarring message","Unstarring all messages","Failed to add label: __labelName__","Label: __labelName__ added successfully","Couldn't add __participantNames__.","Couldn't add some participants.","You added __participantNames__.","Adding __participantNames__.","Removing __participantNames__ as an admin failed.","You can't dismiss __participant__ as admin because they created this group.","Couldn't remove some participants as an admin.","__participantNames__ is no longer a group admin.","Removing __participantNames__ as a group admin.","They are no longer in this group.","You can't add this participant because they left the group recently.","This group is full.","Please try again.","Couldn't make __participantNames__ an admin.","Couldn't make some participants admin.","__participantNames__ is now a group admin.","Making __participantNames__ a group admin.","Couldn't remove __participantNames__.","Couldn't remove some participants.","You can't remove __participant__ because they created this group.","You removed __participantNames__.","Removing __participantNames__.","Couldn't remove profile photo.","Profile photo removed","Removing profile photo","Profile photo set","Couldn't set profile photo.","Setting profile photo","Your name can't be empty","Your name changed","Couldn't change your name.","That emoji isn't allowed in your name","Changing your name","Reporting spam","Couldn't report spam","Reported spam","About can't be empty","About changed","Couldn't change About.","Changing About","Try again.","Couldn't unblock __participant__","__participant__ unblocked","Unblocking __participant__","Undo","Add a caption","The contact you have selected is blocked. Would you like to unblock them and add them to the group?","Blocked contacts will no longer be able to call you or send you messages","Add blocked contact","Add catalog","Add to a group","Add file","Add group description","Add group icon","Add participant","Add group participants","Label name already exists","NEW LABEL","New label","Add new label","Add profile photo","Add set of hours","Add to catalog","Drag the image to adjust","All chats are archived","Already added to group","Only admins can send messages","Only __admins__ can send messages","admins","Archive chat","Archived","Archived Chats","To reduce interruptions, archived chats will stay here with notifications turned off. You can change this option in Settings.","Welcome to your new Archive","Archive settings","No archived chats","Archived chats","Archived","Archived chats are muted","Camera","Attach Desktop Client Logs","Document","__count__ Page","Photos & Videos","Catalog","Contact","__number__ audio file you tried adding has no content.","Your browser doesnt support audio playback.","1.5","1","2","__number__ audio you tried adding is larger than the __maxSize__ limit.","Archived chats will remain archived when you receive a new message","Keep chats archived","Using __deviceName__ as your __deviceType__ for your WhatsApp calls","BETA","You're using WhatsApp Web Beta","This chat is with a business account. Click for more info.",'"__businessName__" registered as a business account, but WhatsApp hasnt verified their name yet.','This chat is with the official business account of "__businessName__". Click for more info.','WhatsApp has verified that this is the official business account of "__businessName__".','WhatsApp has verified that this is the official business account of "__businessName__". This account is saved with a different name in your address book.',"This business account has now registered as a standard account. Click for more info.","This account was previously a business account but has now registered as a standard account and may no longer belong to the business.",'This official business account changed its name to "__businessName__". Click for more info.','WhatsApp has verified that this official business account changed its name and now uses the name "__businessName__".',"__businessName__ used other companies to store and manage this message.","__businessName__ used Facebook and other companies to store and manage this message.","This message was delivered directly from __businessName__.","This message was delivered directly to __businessName__.","__businessName__ used Facebook to store and manage this message.","This chat is with a business account. Click for more info.",'"__businessName__" registered as a business account, but WhatsApp hasnt verified their name yet.','This chat is with the official business account of "__businessName__". Click for more info.','WhatsApp has verified that this is the official business account of "__businessName__".','WhatsApp has verified that this is the official business account of "__businessName__". This account is saved with a different name in your address book.','This chat is now with the official business account of "__businessName__". Click for more info.','WhatsApp has verified that this is the official business account of "__businessName__".','This chat is no longer with the official business account of "__businessName__". Click for more info.','WhatsApp is no longer able to verify that this is the official business account of "__businessName__".',"Block","Block __contact__? Blocked contacts will no longer be able to call you or send you messages.","Block Contact","List of contacts that you have blocked","No blocked contacts yet","Blocked contacts","WhatsApp secures messages while they're being delivered to and from the companies that store and manage this chat for __businessName__. Contact __businessName__ for more information on their privacy practices.","This chat is with a business account.","WhatsApp secures messages while they're being delivered to and from Facebook, where this chat is stored and managed for __businessName__. Contact __businessName__ for more information on their privacy practices.","WhatsApp secures messages while they're being delivered to and from Facebook, where this chat is stored and managed for __businessName__.","__businessName__ is registered as a business account.","__businessName__ is registered as an official business account.","__businessName__ is registered as an official business account. The business is saved as a different name in your contacts.","This chat is with the official business account of __businessName__.","This chat is with the official business account of __businessName__. The business is saved as a different name in your contacts.","__businessName__ is now registered as a business account, instead of an official business account.","__businessName__ no longer uses Facebook to manage its WhatsApp conversations. Click to learn how this changes privacy in this chat.","__businessName__ now only uses Facebook to manage its WhatsApp conversations. Click to learn how this changes privacy in this chat.","__businessName__ no longer uses Facebook or other companies to manage its WhatsApp conversations.","This chat is with a business account that uses Facebook and other companies to manage its WhatsApp conversations. Click to learn more about privacy in this chat.","__businessName__ is now registered as an official business account. This business no longer uses Facebook to manage its WhatsApp conversations. Click to learn how this changes privacy in this chat.","__businessName__ is now registered as an official business account, but it's saved as a different name in your contacts. This business no longer uses Facebook to manage its WhatsApp conversations. Click to learn how this changes privacy in this chat.","__businessName__ is now registered as an official business account that only uses Facebook to manage its WhatsApp conversations. Click to learn how this changes privacy in this chat.","__businessName__ is now registered as an official business account, but it's saved as a different name in your contacts. This business only uses Facebook to manage its WhatsApp conversations. Click to learn how this changes privacy in this chat.","__businessName__ is now registered as an official business account. This business no longer uses Facebook or other companies to manage its WhatsApp conversations. Click to learn more.","This chat is with the official business account of __businessName__. This business uses Facebook and other companies to manage its WhatsApp conversations. Click to learn more about privacy in this chat.","This chat is with the official business account of __businessName__, but it's saved as a different name in your contacts. This business uses Facebook and other companies to manage its WhatsApp conversations. Click to learn more about privacy in this chat.","__businessName__ is no longer an official business account and it no longer uses Facebook to manage its WhatsApp conversations. Click to learn how this changes privacy in this chat.","__businessName__ is no longer an official business account and it now only uses Facebook to manage its WhatsApp conversations. Click to learn how this changes privacy in this chat.","__businessName__ is no longer an official business account and it no longer uses Facebook or other companies to manage its WhatsApp conversations. Click to learn more.","__businessName__ no longer uses other companies to manage its WhatsApp conversations.","This chat is with a business account that uses other companies to manage its WhatsApp conversations. Click to learn more about privacy in this chat.","__businessName__ is now registered as an official business account. This business no longer uses other companies to manage its WhatsApp conversations. Click to learn more.","This chat is with the official business account of __businessName__. This business uses other companies to manage its WhatsApp conversations. Click to learn more about privacy in this chat.","This chat is with the official business account of __businessName__, but it's saved as a different name in your contacts. This business uses other companies to manage its WhatsApp conversations. Click to learn more about privacy in this chat.","__businessName__ is no longer an official business account and it no longer uses other companies to manage its WhatsApp conversations. Click to learn more.","__businessName__ is now registered as a business account that uses Facebook and other companies to manage its WhatsApp conversations. Click to learn how this changes privacy in this chat.","__businessName__ is now registered as a business account that uses other companies to manage its WhatsApp conversations. Click to learn how this changes privacy in this chat.","__businessName__ is now registered as a business account that uses Facebook to manage its WhatsApp conversations. Click to learn how this changes privacy in this chat.","__businessName__ is now registered as a business account. Click to learn more.","__businessName__ now uses other companies instead of Facebook to manage its WhatsApp conversations. Click to learn how this changes privacy in this chat.","__businessName__ no longer uses Facebook to manage its WhatsApp conversations.","This chat is with a business account that uses Facebook to manage its WhatsApp conversations. Click to learn more about privacy in this chat.","__businessName__ is now registered as an official business account. This business now uses other companies instead of Facebook to manage its WhatsApp conversations. Click to learn how this changes privacy in this chat.","__businessName__ is now registered as an official business account, but it's saved as a different name in your contacts. This business now uses other companies instead of Facebook to manage its WhatsApp conversations. Click to learn how this changes privacy in this chat.","__businessName__ is now registered as an official business account. This business no longer uses Facebook to manage its WhatsApp conversations. Click to learn more.","This chat is with the official business account of __businessName__. This business uses Facebook to manage its WhatsApp conversations. Click to learn more about privacy in this chat.","This chat is with the official business account of __businessName__, but it's saved as a different name in your contacts. This business uses Facebook to manage its WhatsApp conversations. Click to learn more about privacy in this chat.","This chat is with the official account of __businessName__, but it's saved as a different name in your contacts. This account uses Facebook to manage its WhatsApp conversations. Click to learn more about privacy in this chat.","This chat is with the official account of __businessName__. This account uses Facebook to manage its WhatsApp conversations. Click to learn more about privacy in this chat.","__businessName__ is no longer an official business account. This business uses other companies instead of Facebook to manage its WhatsApp conversations. Click to learn how this changes privacy in this chat.","__businessName__ is no longer an official business account and it no longer uses Facebook to manage its WhatsApp conversations. Click to learn more.","__businessName__ now uses other companies to manage its WhatsApp conversations. Click to learn how this changes privacy in this chat.","This chat is with a business account. Click to learn more.","This chat is with the official business account of __businessName__. Click to learn more.","__businessName__ now uses Facebook and other companies to manage its WhatsApp conversations. Click to learn how this changes privacy in this chat.","__businessName__ is no longer registered as a business account.","__businessName__ now uses Facebook to manage its WhatsApp conversations. Click to learn how this changes privacy in this chat.","__businessName__ is now registered as an official business account that uses Facebook and other companies to manage its WhatsApp conversations. Click to learn how this changes privacy in this chat.","__businessName__ is now registered as an official business account, but it's saved as a different name in your contacts. This business uses Facebook and other companies to manage its WhatsApp conversations. Click to learn how this changes privacy in this chat.","__businessName__ is now registered as an official business account that uses other companies to manage its WhatsApp conversations. Click to learn how this changes privacy in this chat.","__businessName__ is now registered as an official business account, but it's saved as a different name in your contacts. This business uses other companies to manage its WhatsApp conversations. Click to learn how this changes privacy in this chat.","__businessName__ is now registered as an official business account that uses Facebook to manage its WhatsApp conversations. Click to learn how this changes privacy in this chat.","__businessName__ is now registered as an official business account, but it's saved as a different name in your contacts. This business uses Facebook to manage its WhatsApp conversations. Click to learn how this changes privacy in this chat.","__businessName__ is now registered as an official business account. Click to learn more.","__businessName__ is no longer an official business account. This business now uses Facebook and other companies to manage its WhatsApp conversations. Click to learn how this changes privacy in this chat.","__businessName__ is no longer an official business account and it now uses other companies to manage its WhatsApp conversations. Click to learn how this changes privacy in this chat.","__businessName__ is no longer an official business account and it now uses Facebook to manage its WhatsApp conversations. Click to learn how this changes privacy in this chat.","__businessName__ is no longer registered as an official business account. Click to learn more.","Broadcast list deleted","Broadcast list info","Browser not supported","and","By appointment only","Closed","Closed now","__closed__, opens at __time__","Closed today","Always Open","By Appointment","Edit Business Hours","End Time","Selected Hours","Start Time","Open","Open 24 hours","__open__ 24 hours","__open__ by appointment only","__open__ until __time__","__open__ until __time__, __additionalOpenTime__ - __additionalCloseTime__","Business Info","This is your business name. It will be visible to your WhatsApp customers.","This verified business is not in your contact list.","__streetAddress__, __city__","__streetAddress__, __city__ __zipCode__","Business account","Something went wrong.",'You cannot select categories when you have selected "Not a Business"',"Choose up to three categories","Confirmed as __businessName__","Confirmed business","About and Phone Number","Add another website","Business Address","Business Hours","Categories","Business Description","Email Address","End Time","Edit map on mobile","This name will be visible to your WhatsApp customers and can only be editable from the app on your mobile device.","Your phone number can only be editable from the app on your mobile device.","Something went wrong","An error occurred while saving.  Please try again.","Business Information","Website","This name will be visible to your WhatsApp customers and can only be editable from the app on your mobile device.","No categories found","Official business account","Search categories","This is a business account.","Verified","__verified__ as __businessName__","Verified business","Use Here","WhatsApp needs a camera for video calls and taking photos. Allow access in your computer's settings.","Allow WhatsApp to access your camera?","Calls are not supported on WhatsApp Web. Open WhatsApp on your phone to call this business.","__count__ message couldn't be forwarded because __contact__ is on a version of WhatsApp that doesn't support it.","No messages could be forwarded because __contact__ is on a version of WhatsApp that doesn't support them.","__count__ message couldn't be forwarded because the file is missing.","__count__ message couldn't be forwarded because the file is missing or __contact__ is on a version of WhatsApp that doesn't support it.","No messages could be forwarded because the file is missing or __contact__ is on a version of WhatsApp that doesn't support them.","No messages could be forwarded because the file is missing.","Can't Load WhatsApp","The caption youre pasting is too long. Try shortening it or sending it as a separate message.","Caption Too Long","Your cart","Add items to your cart","Collect all the items you're interested in here and then send them to the business. Use your cart to ask about buying, customizing, delivery, or anything you want.","Ask for price","Qty __quantity__","One or more items in your cart have been updated","You can't add any more of this item","Add a message","The message youre pasting is too long. Try shortening it or sending it as a separate message.","Message Too Long","Received cart","Your sent cart","Send a cart","Something went wrong","Add Images","Add items to your catalog so customers can see what you're offering","Add new item","Failed to send review request.","Are you sure you want to delete this item from your catalog?","Delete Item","Failed to delete product","By using this feature, you're using a __fb_product_link__ and agree that the __fb_commerce_link__ and __wa_commerce_policy_link__ apply.","If you feel this is not correct, you can __request_review_link__.","Your appeal was submitted. If its approved, your item will be added to your catalog. If its not approved, youll be notified.","We reviewed this item again and found it didn't follow product or service guidelines. __learn_more_link__.","We will review the item and if it meets our guidelines, it will be added to your catalog.","When you hide an item, customers wont see it in your catalog.","Hide item","This item wasn't approved because it doesn't follow our product or service guidelines. __learn_more_link__.","request another review","Changes saved","Add to cart","Delete","Hide item","Share","Show item","This item is being reviewed. If its been approved, your customers will be able to see it on your profile. __learn_more_link__.","This item is being reviewed. You hid it, so customers wont see it in your catalog when its approved. __learn_more_link__.","Catalog link","Failed to save changes","Learn more about their products & services","View __catalogOwnerName__'s Catalog on WhatsApp","__productName__ from __catalogOwnerName__ on WhatsApp.","Anyone with WhatsApp can follow this link to browse catalog","Add new item","Edit item","Change group icon","Message new number","__name__ changed their phone number. You're currently chatting with their new number.","__name__ changed their phone number to a new number.","__name__ changed their phone number to a new number. Click to message the new number.","Change profile photo","You allowed all participants to send messages to this group","You allowed only admins to send messages to this group","You turned off disappearing messages in this chat","You turned on disappearing messages in this chat","You allowed participants to send messages that have been forwarded many times to this group","You blocked participants from sending messages that have been forwarded many times to this group","You allowed all participants to change this group's info","You allowed only admins to change this group's info","Allowing all participants to send messages to this group","Allowing only admins to send messages to this group","Turning off disappearing messages in this chat","Turning on disappearing messages in this chat","Allowing participants to send messages that have been forwarded many times to this group","Blocking participants from sending messages that have been forwarded many times to this group","Allowing all participants to change this group's info","Allowing only admins to change this group's info","Charge your phone to keep using WhatsApp","Archived","You are not an admin","Search for messages within __chatName__.","Starred Messages","No Internet connection","Group invite message. Open WhatsApp on your phone to view.","Sharing live location. Open WhatsApp on your phone to view.","Payment message. Open WhatsApp on your phone to view.","Choose a phone number","Clear this chat?","Clear messages","Clear chat","Clear this chat?","Delete file from your phone","Clear this chat?","click here for group info","click here for contact info","Update WhatsApp","Click to reload QR code","Click to save, ESC to cancel","Click to update WhatsApp","Close chat","All Items","__count__ item","See all","Your computer is connected to a network that prevents WhatsApp from working correctly","Computer not connected","Add __participant__ to __subject__ group?","Add __participants__ to __subject__ group?","Confirm","You are closing WhatsApp.","Some messages cant be forwarded, do you want to forward rest of the messages?","Can't forward all messages","Forward to __chat__?","Log out?","Make __participant__ an admin for __subject__ group?","Remove __participant__ from __subject__ group?","Send __count__ contact to __chat__?","Send __count__ contact to __chat__?","Send __count__ contact to __chat__?","Unblock __chat__ and forward messages?","Blocked. Click to unblock","Unblock __contact__","Unmute this chat?","Enable sounds and notifications?","Unmute this group?","Connecting","Connecting to WhatsApp","Connecting","Contact","Contact Card","About and phone number","Contact is blocked","Loading About","View contact","__number__ contact that you tried to add has no content.","The contact that you tried to add is larger than the __maxSize__ limit.","Use WhatsApp on your phone to see the complete message history.","Older documents may be available","Older files may be available","Older links may be available","Older media may be available","Older messages may be available","Older products may be available","Use WhatsApp on your phone to search messages from before __date__.","Use WhatsApp on your phone to see the complete chat history.","Older chat history is available","Additional messages for this chat are being synced","Search for messages with __chatName__.","Copy link","Decrease speed of selected voice message","WhatsApp message","WhatsApp group message","Default","Delete all","Delete broadcast list?","Delete for me","Delete chat","Delete chat","Delete this chat?","Delete group","Delete this group?","Delete Item","Deleting a label removes it from all messages, contacts, and from the list of labels. Are you sure you want to delete this label?","Delete message","Delete message?","Tell us about your issue","Update","Please Update WhatsApp","New version available","Go To Settings","Please update WhatsApp from the Mac App Store","Desktop Settings","Update","To continue using WhatsApp, click Update and install the latest version.","Couldn't Update Automatically","Downloading an update to WhatsApp. This may take several minutes. WhatsApp will automatically update and restart when the download finishes.","Updating WhatsApp","Please update WhatsApp from the Windows App Store","Dismiss","Dismiss as admin","Docs","__count__ Doc","__name__ downloaded.","__number__ document you tried adding has no content.","__number__ document you tried adding is larger than the __maxSize__ limit.","Download all","This contact can't be displayed in WhatsApp Web. Download it to open it with another app on your computer?","Download contact?","Download failed","open","Downloading","Download completed","This file can't be opened in WhatsApp Web. Download it to open it with another app on your computer?","Download Unsupported File?","Drag file here","End-to-end encrypted","Edit","Choose who can change this groups subject, icon, description and disappearing messages setting.","Add text to your image","Edit label","Did you know? You can type : and a word to search emoji","smile","Activity","Animals & Nature","Flags","Food & Drink","Objects","Smileys & People","Symbols","Travel & Places","Turn on desktop notifications","& ","  ",", ","Only admins can change this setting.","Disappearing messages were turned off.","Disappearing messages were turned on. New messages will disappear from this chat after __number__ day.","Disappearing messages were turned on. New messages will disappear from this chat after __number__ hour.","Disappearing messages were turned on. New messages will disappear from this chat after __number__ minute.","Disappearing messages were turned on. New messages will disappear from this chat after __number__ second.","You turned off disappearing messages.","You turned on disappearing messages. New messages will disappear from this chat after __number__ day.","You turned on disappearing messages. New messages will disappear from this chat after __number__ hour.","You turned on disappearing messages. New messages will disappear from this chat after __number__ minute.","You turned on disappearing messages. New messages will disappear from this chat after __number__ second.","__name__ turned off disappearing messages.","__name__ turned on disappearing messages. New messages will disappear from this chat after __number__ day.","__name__ turned on disappearing messages. New messages will disappear from this chat after __number__ hour.","__name__ turned on disappearing messages. New messages will disappear from this chat after __number__ minute.","__name__ turned on disappearing messages. New messages will disappear from this chat after __number__ second.","","Disappearing messages were turned off. Click to change.","Disappearing messages were turned on. New messages will disappear from this chat after __number__ day. Click to change.","Disappearing messages were turned on. New messages will disappear from this chat after __number__ hour. Click to change.","Disappearing messages were turned on. New messages will disappear from this chat after __number__ minute. Click to change.","Disappearing messages were turned on. New messages will disappear from this chat after __number__ second. Click to change.","You turned off disappearing messages. Click to change.","You turned on disappearing messages. New messages will disappear from this chat after __number__ day. Click to change.","You turned on disappearing messages. New messages will disappear from this chat after __number__ hour. Click to change.","You turned on disappearing messages. New messages will disappear from this chat after __number__ minute. Click to change.","You turned on disappearing messages. New messages will disappear from this chat after __number__ second. Click to change.","__name__ turned off disappearing messages. Click to change.","__name__ turned on disappearing messages. New messages will disappear from this chat after __number__ day. Click to change.","__name__ turned on disappearing messages. New messages will disappear from this chat after __number__ hour. Click to change.","__name__ turned on disappearing messages. New messages will disappear from this chat after __number__ minute. Click to change.","__name__ turned on disappearing messages. New messages will disappear from this chat after __number__ second. Click to change.","Turning on this setting will make new messages disappear from this chat after 7 days. Recipients can still save these messages elsewhere.","Turning on this setting will make new messages disappear from this chat after a selected amount of time. Recipients can still save these messages elsewhere.","New messages will disappear from this chat after __number__ day.","New messages will disappear from this chat after __number__ hour.","New messages will disappear from this chat after __number__ minute.","New messages will disappear from this chat after __number__ second.","Anyone in this chat can change this setting.","Group admins control who can change this setting.","This message was sent while disappearing messages were turned off.","This message will disappear from this chat after __number__ day.","This message will disappear from this chat after __number__ hour.","This message will disappear from this chat after __number__ minute.","This message will disappear from this chat after __number__ second.","Messages will disappear after 7 days if theyre sent to a chat that has disappearing messages turned on.","Messages will disappear after a selected amount of time if theyre sent to a chat that has disappearing messages turned on.","While this setting is on, new messages will disappear from this chat after 7 days.","While this setting is on, new messages will disappear from this chat after a selected amount of time.","Media and messages wont disappear from outside the chat or from any devices theyre saved on.","There are still ways for recipients to save messages, like forwarding them or taking a screenshot.","Get Started With Disappearing Messages","Disappearing Messages Were Turned On","You can't change this setting because you're not connected to the Internet. Check your Internet and try again.","Off","On","__number__ day","__number__ hour","__number__ minute","__number__ second","You can't turn off disappearing messages for this chat unless you unblock this contact.","You can't turn on disappearing messages for this chat unless you unblock this contact.","Catalog already created.","Two or more images are the same. Delete any duplicates and try again.","Item code must be unique.","Incorrect email address format","Add at least one image","Add a title","Enter a valid price","Wait until the message finishes sending and displays a checkmark before forwarding.","Wait until this message is fully delivered before forwarding.","Unable to forward unsent message.","Cant Forward","URL is incorrect","Exit group","Exit this group?","Facebook Commercial Terms","Facebook Product","__number__ file you tried adding has no content.","__count__ file failed to be downloaded because it's no longer on your phone.","__number__ file could not be added.","__number__ file you tried adding is not supported.","__number__ file you tried adding is larger than the __maxSize__ limit.","B","GB","kB","MB","Forward","Forward all","You can only share with up to __count__ chat","Forwarded many times. You can only share with up to __count__ chat.","Messages forwarded many times can only be shared with up to __count__ chat at a time.","Forward message","Forward message to","Forwarded","Forwarded __count__ time","Can't send messages that have been forwarded many times","Forwarded many times","One or more messages will be marked as forwarded many times.","This message will be marked as forwarded many times.","Found a contact card for this number. View contact card?","Older results may be available","Gallery","Get directions","Microsoft Edge","Google Chrome","Mozilla Firefox","Get notified of new messages","Opera","Safari (macOS 10.10+ Only)","Custom GIF animations are currently not supported. Please use provided GIF selection feature.","Favorites","Haha","Love","Reactions","Sad","Sports","Trending","TV","Alerts and sounds off","Alerts and sounds off for 1 day","Alerts and sounds off for 1 hour","Alerts and sounds off for 1 week","Alerts and sounds off for 8 hours","Alerts and sounds off. Click to restore.","Notifications enabled","Go to message","Messages are now end-to-end encrypted. No one outside of this chat, not even WhatsApp, can read or listen to them. Click to learn more.","Failed to load Google Maps","GOT IT","Group","You were added by someone who's not in your contacts","Group deleted","Description","You can't join this group because you were removed.","You can't join this group because it has ended.","You can't join this group because this invite link was reset.","You can't join this group because it is full.","Couldn't join this group. Please try again.","Cancel","Checking invite link","__count__ contact","Reset link","Join group","Invite to group via link","Anyone with WhatsApp can follow this link to join this group. Only share it with people you trust.","__count__ participant","You can't view this group's invite link because you're not an admin.","You can't view this group's invite link because you're no longer a participant.","You can't view this group's invite link because this group has ended.","This invite link doesn't match any WhatsApp groups.","Are you sure you want to reset the invite link for __groupName__? If you reset the link, no one will be able to use it to join this group.","Resetting the invite link for __groupName__.","The previous invite link is now reset and a new invite link has been created.","Send link to","Log in to WhatsApp Web to join this WhatsApp group","View group","Group muted","Type contact name","All participants","Edit group info","Disappearing Messages","Allow","Frequently forwarded messages","Messages forwarded many times","Don't allow","Only admins","Send messages","Group Settings","Follow this link to join my WhatsApp group:","__count__ more","Group Subject","Invitation to join my WhatsApp group","Invite Expired","__number__ invited","Couldn't add __participant__. You can invite them privately to join this group.","WhatsApp group invite","Invited","View invite","Group video call","Group voice call","Send invite to...","Reset invite for __participant__? If you reset the invite, __participant__ won't be able to use it to join this group.","To take photos, click Allow above to give WhatsApp access to your computer's camera.","To take photos, click Yes below to give WhatsApp access to your computer's camera.","To take photos, WhatsApp needs access to your computer's camera. Click __chrome_media_error__ in the URL bar and choose Always allow web.whatsapp.com to access your camera.","To take photos, WhatsApp needs access to your computers camera. Refresh the page, try sending a camera image, and select Yes from the menu that appears.","To take photos, WhatsApp needs access to your computers camera. Click __firefox_lock__ in the URL bar and set Use the Camera to Allow.","To take photos, WhatsApp needs access to your computers camera. Click __opera_media__ in the URL bar and click Clear This Setting and Reload.","To take photos, WhatsApp needs access to your computers camera. Open your browsers Preferences  Websites and change camera setting for web.whatsapp.com to Allow.","You cant take a photo because it looks like your computer doesnt have a camera. Try connecting one or if you have one connected, try restarting your browser.","Camera Not Found","Allow camera","To record Voice Messages, click Allow above to give WhatsApp access to your computer's microphone.","To record Voice Messages, click Yes below to give WhatsApp access to your computer's microphone.","To record Voice Messages, WhatsApp needs access to your microphone. Click __chrome_media_error__ in the URL bar and choose Always allow web.whatsapp.com to access your microphone.","To record Voice Messages, WhatsApp needs access to your computers microphone. Refresh the page, try sending a Voice Message, and select Yes from the menu that appears.","To record Voice Messages, WhatsApp needs access to your computers microphone. Click __firefox_lock__ in the URL bar and set Use the Microphone to Allow.","To record Voice Messages, WhatsApp needs access to your computers microphone. Click __opera_media__ in the URL bar and click Clear This Setting and Reload.","To record Voice Messages, WhatsApp needs access to your computers microphone. Open your browsers Preferences  Websites and change microphone setting for web.whatsapp.com to Allow.","You cant record a Voice Message because it looks like your computer doesnt have a microphone. Try connecting one or if you have one connected, try restarting your browser.","Microphone Not Found","Cant record voice messages during a WhatsApp call.","Allow microphone","To get notifications for new messages, click Allow above.","To get notifications for new messages, click Yes below.","To get notifications for new messages, select Allow notifications from the prompt below the URL bar.","Allow notifications","Help","New Message","Message from __author__","__unreadCount__ New Message","You'll be logged out after several minutes of inactivity","Failed to load image","__number__ image you tried adding has no content.","Image may be subject to copyright.","Image search failed","Enter search term here","No images found","Search for images","Image Search","Terms of Service","__number__ image you tried adding is larger than the __maxSize__ limit.","Check your phone to answer","WhatsApp video call from __name__","WhatsApp voice call from __name__","Increase speed of selected voice message","Send and receive messages without connecting your phone.","Use WhatsApp on up to 4 devices at the same time.","WhatsApp Web","WhatsApp connects to your phone to sync messages. To reduce data usage, connect your phone to Wi-Fi.","Make calls and send messages without connecting your phone.","WhatsApp for Desktop","Get it here","WhatsApp is available for Mac. __get_it_here__.","WhatsApp is available for Windows. __get_it_here__.","Keep your phone connected","Expires at __time__","Expires in __number__ day","Invite expired","Keep starred messages","Keyboard Shortcuts","Catalog","Choose color","__count__ item","Label items","Item Code (Optional)","Description (Optional)","Link (Optional)","Name","Price __currencySymbol__ (Optional)","Enter reason for this request...","Search in __labelName__...","Labels","There was an unexpected error, please click to reload the application.","Learn more","Licenses","Couldn't copy to clipboard. Copy using mouse or keyboard.","Link copied to clipboard.","Links","__count__ Link","Accurate to __accuracy__ M","__count__ people","Live location ended","Expired Location","Last updated __date__ at __time__","Last updated today at __time__","Last updated __date__ at __time__","Last updated yesterday at __time__","Live until __time__","Map view","Satellite view","Terrain view","Hide traffic","Show traffic","Click to continue viewing live location","__hours__h left","__hours__h __minutes__m left","__minutes__m left","__sharers__ is sharing live location","__name__ is sharing live location","__count__ person is sharing live location","You are sharing live location","You and __name__ are sharing live location","You and __count__ other person are sharing live location","You are sharing live location","Stop Sharing","__name__ stopped sharing","Live Location","Updated __hours__h ago","Updated __hours__h __minutes__m ago","Updated just now","Updated __minutes__m ago","View Live Location","load earlier messages","load recent messages","Loading","loading messages","Log in","Menu __android_menu_icon__","Click to reload QR code","Need help to get started?","Settings __iphone_settings_icon__","Open WhatsApp on your phone","Tap __android_menu__ or __iphone_settings__ and select __whatsapp_web_menu_item__","Point your phone to this screen to capture the code","To use WhatsApp on your computer:","WhatsApp Web","WhatsApp Web","This business account is not in your contact list.","Make sure your computer has an active Internet connection.","Make sure your phone has an active Internet connection.","Edit group admins","Mark as read","Mark as unread","You've reached the maximum number of images to add.","Downloading messages: __progress__%","Don't refresh or close this window before the download is complete.","Media","Add a caption","Background","Done","Bryndan Write","Norican","Oswald","Sans Serif","Serif","No preview available","Reset","Crop & Rotate","Emoji","Paint","Redo","Rotate left","Rotate right","Sticker","Text","Undo","Type something","The item you tried adding failed to load.","This file was changed from original.","Media, Links and Docs","Media, Links, Docs and Products","Archived","Blocked","Desktop Settings","Help","Keep me signed in","Log out","Make group admin","Notifications","Profile","Profile","Remove","Security","Settings","Starred","Theme","Chat Wallpaper","Attach","Menu","Message","Message admin","This audio is too large. You can send audio up to __maxSize__.","Message __author__","This document is too large. You can send documents up to __maxSize__.","This file is too large. You can send files up to __maxSize__.","This image is too large. You can send images up to __maxSize__.","Message info","Delivered","Delivered to","Played","Played by","Read","Read by","__count__ remaining","Seen","Opened","Opened by","Couldn't find message","The message youre pasting is too long. Try shortening it or sending it in multiple parts.","Message Too Long","This video is too large. You can send videos up to __maxSize__.","Room","Continue in Messenger","Create a room in Messenger and send a link to group video chat with anyone, even if they don't have WhatsApp or Messenger.","Rooms are protected by Messenger's encryption and privacy controls, but they aren't end-to-end encrypted.","Introducing Messenger Rooms","Continue in Messenger to create a room.","Create a room","WhatsApp needs a microphone for calls and voice messages. Allow access in your computer's settings.","Allow WhatsApp to access your microphone?","Cant play this Voice Message because it's no longer on your phone.","Voice Message Unavailable","Cant view this contact because it's no longer on your phone.","Contact Unavailable","Cant download this document because it's no longer on your phone.","Document Unavailable","Cant view this GIF because it's no longer on your phone.","GIF Unavailable","Media Message Unavailable","Cant view this photo because it's no longer on your phone.","Photo Unavailable","Cant download this sticker because it's no longer on your phone.","Sticker Unavailable","Cant play this video because it's no longer on your phone.","Video Unavailable","Couldn't display message info. Try again later.","Phone number shared via url is invalid.","Send message to","Log in to WhatsApp Web to share","__contactName__ and __count__ other contact","No contacts","__count__ contact","You can only send up to __count__ contact","View all","1 Day","1 Hour","1 Week","1 Year","8 Hours","Always","Mute __name__ for","__A__, __B__","__A__, and __B__","__A__, __B__","__A__ and __B__","Archive Chat","Close Window","WhatsApp needed to restart because of a problem.","Problem Detected","Delete Chat","Delete Group","Exit Group","Log Out","Mark as Read","Mark as Unread","Call","Always On Top","Chat","File","Help","Help Center","Terms and Privacy Policy","Copy","Copy Image","Copy Link","Cut","Edit","About WhatsApp","Hide","Hide Others","Preferences","Quit WhatsApp","Services","Show All","Paste","Redo","Search","Select All","Undo","View","Enter Full Screen","Exit Full Screen","Zoom In","Actual Size","Zoom Out","Next Chat","Previous Chat","Search Chat","Add to dictionary","Copy","Copy Image","Copy Link","Cut","Paste","Redo","Select All","Undo","Window","Bring All to Front","Minimize","Zoom","Do Not Move","Move to Applications","You can move WhatsApp to Applications so it's easier to find.","Move WhatsApp to Applications?","Mute","New Chat","New Group","Pin Chat","Profile and About","Unarchive Chat","Cancel Mute","Unpin Chat","Cancel","End Call","Are you sure you want to end the current call?","This video is unavailable. Please try again.","New chat","New group","Next","You need to create a catalog on the phone first","No chats","No contacts","No Docs","No groups","No Links","No Media","No Media, Links and Docs","No Media, Links, Docs and Products","No products","No result found for '__labelName__'","No results","No starred messages","No thanks","No update found","Not spam","Notifications","__number__ of __totalNumber__","+__number__",'This chat is with the official business account of "WhatsApp". Click for more info.','This is the official business account of "WhatsApp".','This is the official business account of "WhatsApp". This account is saved with a different name in your address book.',"This official business account is not in your contact list.","OK, got it","Only admins can edit this group's info","Opening link in new window...","You will now be directed to","Start WhatsApp at Login","Desktop Alerts","Show Previews","Display message text in desktop alerts","Outgoing Message Tone","Toggles the audio tone that plays when you send a message","Sounds","Ask for total","The seller has deleted your sent cart. Contact the seller for more information.","Order Detail","Your Order","__subtotal__ (estimated)","Qty __quantity__","__total__ (estimated total)","No Items","View cart","View sent cart","Organizing messages","This message can't be viewed in WhatsApp Desktop. View it on your phone instead.","This message can't be viewed in WhatsApp Web. View it on your phone instead.","Recent","Already blocked","Payment","Not Now","Phone battery low","WhatsApp is open on another computer or browser. Click Use Here to use WhatsApp in this window.","Phone not connected",'The version of WhatsApp on your phone is too old. Please update to the latest version, then click "LOG IN" to continue using WhatsApp.',"The video can't be played.","Open the link","This video is playing in picture in picture.","Currently playing video was revoked.","Pin chat","Waiting for this message. This may take a while.","Previous","Reply privately","Add to cart","Item added to cart","Catalog","More","Send catalog","Follow this link to view our catalog on WhatsApp:","Something went wrong","Catalog","View catalog","Details","You hid this item. Your customers can't see it in your catalog","Product link","View items","Message Business","Can not send product before media is ready","View","Remove from cart","This product or service has been removed","This is abusive, harmful or illegal","This appears to be a knockoff or counterfeit item","The pictures or descriptions don't match the item","Other","Tell us more","This is fraud or a scam","This is spam","Submit","Couldn't report product","Thanks for your feedback","Reporting product","Please select a reason.","Follow this link to view our item on WhatsApp:","Waiting for network","Products","__count__ Product","This photo is too small. Please select a photo with height and width of at least __size__ pixel.","Couldn't send this Voice Message.","","Your Name","This is not your username or pin. This name will be visible to your WhatsApp contacts.","Group  __groupName__","Read more","Reconnect","Remove","Remove this group's icon?",'Remove label "__labelName__" from __count__ item',"Remove photo","Remove your profile photo?","Reply","Report","Report and block","Report business","Block business and clear chat","Report this business to WhatsApp?","Report contact","Block contact and clear chat","Report this contact to WhatsApp?","Report group","Exit group and clear chat","Report this group to WhatsApp?","Report product","Report Product","We will review the product and if it does not meet our guidelines, it will be removed.","Your report has now been submitted.","Report this product?","Tell Us More","Report spam","Most recent messages in this group will be forwarded to WhatsApp.","Most recent messages from this user will be forwarded to WhatsApp.","Most recent messages from this business will be forwarded to WhatsApp.","Request review","Click to resend","Retake","Retry","Retry Now","Upload","Retrying","Retrying in __duration__","Retrying in __number__ second","Delete for everyone","Revoke invite","This message was deleted","Messages you selected will be deleted for everyone on the latest version of WhatsApp in this chat.","You deleted this message","Save","Search","Search contacts","Search Emoji","Search GIFs via __service__","Search groups","Search Messages","No chats, contacts or messages found","No contacts found","No groups found","No messages found","No results found for '__keyword__'","Search or start new chat","Search Participants","Search results not yet available. Try again later.","Search via WhatsApp sticker store","Search Web","Couldn't search the web. Check your computer's internet connection and try again.","Would you like to search this on the web? This will upload the message to Google.","Looking for chats, contacts or messages","Searching for images...","Looking for messages","Security code notifications are no longer available for this chat.","Learn which chats are end to end encrypted","Turn on this setting to receive notifications when one of your contact's security code changes.","Turn on this setting to be notified when your security code changes for a contact in an end-to-end encrypted chat. This setting must be enabled on each device you want notifications to show.","Show security notifications","Show security notifications on this computer","WhatsApp secures your conversations with end-to-end encryption. This means your messages, calls and status updates stay between you and the people you choose. Not even WhatsApp can read or listen to them.","Messages and calls in end-to-end encrypted chats stay between you and the people or businesses you choose, so not even WhatsApp can read or listen to them.","Security","See __count__ archived chat","See Location","See more","__count__ selected","Send contacts","Couldn't send this message.","Send link via WhatsApp","send","Feedback/Question about WhatsApp","Email address","Confirm email address","Please enter a valid email address","The email addresses do not match","Subject","Please upload images 10 MB or smaller","Question about WhatsApp Business for Mac","Question about WhatsApp for Mac","Release to add...","Add Screenshots","Feedback sent","Please enter a subject.","Contact us","__count__ Screenshot Maximum","Please add more to your description","Question about WhatsApp Business for Web","Question about WhatsApp for Web","Question about WhatsApp Business for Windows","Question about WhatsApp for Windows","To verify, send a message to __name__ and try again.","Send product","Send products","The sender is not in your contact list","Settings","Shop","Search in Broadcast lists","Broadcast lists","Unread chats","Search in Groups","Labels","Search in Unread chats","Some of your messages are still sending.","Star message","No starred messages","Starred messages","Starting chat","Status","Camera","HIDE","SHOW","Status update not found","MUTED","My Status","No updates","Click on a contact to view their status updates","RECENT","Sending reply","You received a status, but your version of WhatsApp doesn't support it.","Update your status","Upload","View your updates","VIEWED","You don't have any stickers yet. Download sticker packs on your phone to get started.","Angry","Celebrate","Greetings","Happy","Love","Sad","You haven't sent any stickers yet","You haven't favorited any stickers yet","Subject","This chat has been closed","Include device information? (optional)","Technical details like your model and settings can help us answer your question.","Tell us how we can help","Your question has been sent to WhatsApp Support. We'll respond in a WhatsApp chat shortly.","Contact us","The support request form is not yet available for desktop. Use your phone to submit it.","WhatsApp secures messages and calls while theyre being delivered to and from this account.","Learn more about chats with WhatsApp Support.","Click to learn how messages and calls are secured.","Security","This chat is with the official account of WhatsApp Support. Click to learn more.","WhatsApp Support","Suspicious link","__count__ suspicious link","Open link","This link contains unusual characters. It may be trying to appear as another site.","Take photo","You'll be able to use WhatsApp again in __duration__","You're temporarily banned from WhatsApp because you sent too many messages to people who dont have __phone__ in their address books.","You're temporarily banned from WhatsApp because too many people blocked you.","You're temporarily banned from WhatsApp because you created too many groups with people who dont have __phone__ in their address books.","You're temporarily banned from WhatsApp because you sent the same message to too many people.","You're temporarily banned from WhatsApp because you sent too many messages to a broadcast list.","You're temporarily banned from WhatsApp because you may have violated our terms of service.","Terms and Privacy Policy","Dark","Light","Choose theme","System default","Maximum number of files uploaded. __number__ file has been ignored.","Trying to reach phone","Turn off all desktop notifications","Turn off all desktop notifications for:","Type a message","Type a reply","Unarchive chat","Unblock","Unblock __contact__?","Unblock Contact","unknown subject","Unpin chat","__count__ unread message","Unread messages","Could not forward this message because the file is no longer on your phone.","Unstar all","Unstar","Unstar all messages?","Unstar message","You received a message on your phone, but your version of WhatsApp Desktop doesn't support it.","This message can't be shown on WhatsApp Desktop. Open WhatsApp on your phone to view.","You received a message, but your version of WhatsApp doesn't support it.","You sent a message from your phone, but your version of WhatsApp Web doesn't support it.","You received a message on your phone, but your version of WhatsApp Web doesn't support it.","Click here to update.","This message can't be shown on WhatsApp Web. Open WhatsApp on your phone to view.","Until __date__ at __time__","Until today at __time__","Until tomorrow at __time__","Until __day__ at __time__","Untitled","Update available","Download Microsoft Edge","Update Google Chrome","Update Mozilla Firefox","Update Safari","Updating WhatsApp","WhatsApp is out of date. Updating now","Updating","Upload photo","__participants__ joined using your invite","You invited __participants__","AIM","Birthday","Description","Business Name","Mobile","Email","Home","Home Fax","ICQ","iPhone","Jabber","Main","Windows Live","Nickname","Pager","Skype","Work","Work Fax","Yahoo","Version __version__","Video call","Switch","__number__ video you tried adding has no content.","Your browser doesnt support video playback.","__number__ video you tried adding is larger than the __maxSize__ limit.","View business","View Contact Card","Expired","When you turn on this setting, recipients can only open your photo or video one time before it disappears. Keep in mind, they can still take screenshots before it's gone.","Send photos and videos more privately","Photo","This photo will disappear after it is opened.","This photo will disappear after you close it.","This video will disappear after it is opened.","This video will disappear after you close it.","Video","Opened","View or edit catalog","View photo","Voice call","End call","Mute microphone","Turn off camera","Turn on camera","Unmute microphone","You can turn on your camera after __callee__ answers","Request to switch to video call","Calling","Camera not found","camera off","Call ended","Call failed","Call answered on your connected phone","In call","Your call will end in a few seconds because your microphone and sound output device were disconnected.","Your call will end in a few seconds because your microphone was disconnected.","Microphone not found","Call not answered","__name__'s camera and mic are off","The other person's camera and mic are off","__name__'s camera is off","The other person's camera is off","__name__'s mic is muted","The other person's mic is muted","Reconnecting","Call declined","Your connected phone is already on a WhatsApp call","__name__ is requesting to switch to a video call","Requesting to switch to a video call...","Requesting to switch to a video call...","requesting video call...","Ringing","Your call will end in a few seconds because your sound output device was disconnected.","Your microphone is muted","Camera","Use System Setting","Microphone","Audio Device","Default Communications Device","You can turn off your camera after __callee__ answers","WhatsApp didn't connect to a video or audio device. Try starting the call again. If the problem continues, you may have to restart WhatsApp or your computer.","Call could not be started","Please contact us with the make and model of your camera. ","WhatsApp doesn't work with your camera yet","You are already on a WhatsApp call","Call cannot be placed for more than __count__ participant","Couldn't place call: all recipients are using old versions of WhatsApp or incompatible devices.","You can only call up to __count__ contact","__callee__ couldn't be added to the call, because they are using an old version of WhatsApp or an incompatible device.","__count__ others","WhatsApp needs a camera for video calls. Connect one to your computer.","WhatsApp could not find a connected camera","WhatsApp needs a microphone for calls. Connect one to your computer.","WhatsApp could not find a connected microphone","Make sure your computer has an active Internet connection and try again.","Computer not connected to the Internet","Make sure your phone has an active Internet connection and try again.","Phone not connected to the Internet","WhatsApp needs an audio output device for calls. Connect one to your computer.","WhatsApp could not find a connected audio device","Call could not connect","__callee__ is in a country where WhatsApp Calling is unavailable","Couldn't place call: __callee__ is unable to receive WhatsApp calls.","WhatsApp Calling is unavailable in your country.","Couldn't place call: __callee__ is unable to receive WhatsApp calls at this time.","Couldn't place call: __callee__ is unable to receive WhatsApp calls.","Couldn't place call: __callee__ is not registered on WhatsApp","Unblock this contact to call them.","Couldn't place call: __callee__ is unable to receive WhatsApp video calls at this time.","Your audio device is unavailable","Your audio device or microphone is unavailable","Your camera is unavailable or used by another app","Allow WhatsApp to access your camera in computer's settings","Your microphone is unavailable. Switch to another microphone or end the call and try again.","Allow WhatsApp to access your microphone in computer's settings","Accept","Decline","Ignore","WhatsApp voice call","WhatsApp group voice call","WhatsApp group video call","WhatsApp video call","WhatsApp will use your computer's camera for video calls and taking photos. You can always change this later in your computer's settings.","WhatsApp will use your computer's microphone for calls and voice messages. You can always change this later in your computer's settings.","Call could not connect","__contactName__ - WhatsApp voice call","__contactName__ - WhatsApp video call","Add WhatsApp Doodles","Chat wallpaper set","Chat wallpaper doodles added","Chat wallpaper doodles removed","Set Chat Wallpaper","Wallpaper Preview","Your security code with __contactName__ changed because there was a login on a new device of theirs.","Your security code with __contactName__ changed because you logged into a new device.",'Your security code with all recipients changed because there was a login on a new device of yours. To verify a contact\'s security code, open their Contact Info page and click "Encryption".',"Your security code with __contactName__ changed because there was a login on a new device of yours.",'Your security code with all participants changed because there was a login on a new device of yours. To verify a contact\'s security code, open their Contact Info page and click "Encryption"',"Your security code with __contactName__ changed because there was a login on this device.",'Your security code with all recipients changed because there was a login on this device. To verify a contact\'s security code, open their Contact Info page and click "Encryption".',"Messages are end-to-end encrypted. Click to learn more.","Messages you send to this broadcast list are secured with end-to-end encryption. Click to learn more.","Messages you send to this broadcast list are secured with end-to-end encryption, which means WhatsApp and third parties can't read them.","Your security code with all recipients changed. Click to learn more.",'WhatsApp has verified that this is the official business account of "__businessName__".',"WhatsApp has verified that this is the official business account of __businessName__. This account is saved with a different name in your contacts.","This may be a business. WhatsApp hasn't verified their name yet.","Download","Add label","Delete label","Remove label","Cancel","You can't send messages to this group because you're no longer a participant.","Can't send a message to blocked contact __contact__.","Your security code with __contactName__ changed because there was a login or logout from one or more of their devices.",'Your security code with all recipients changed because there was a login or logout from one or more of your devices. To verify a contact\'s security code, open their Contact Info page and click "Encryption".',"Your security code with __contactName__ changed because there was a login or logout from one or more of your devices.",'Your security code with all participants changed because there was a login or logout from one or more of your devices. To verify a contact\'s security code, open their Contact Info page and click "Encryption".',"WhatsApp secures your conversations with end-to-end encryption. This means your messages and status updates stay between you and the people you choose. Not even WhatsApp can read or listen to them.","WhatsApp secures your conversations with end-to-end encryption. This means your messages, calls and status updates stay between you and the people you choose. Not even WhatsApp can read or listen to them.","Muted","Chats","Close","Contact info","Messages are end-to-end encrypted. No one outside of this chat, not even WhatsApp, can read or listen to them. Click to learn more.","Messages to this chat are secured with end-to-end encryption. __businessName__ may use another company to store, read and respond to your messages. Click to learn more.","Messages are end-to-end encrypted. Click to verify.","Messages and calls are end-to-end encrypted. Click to verify.","Contacts","Continue","online","typing","recording audio","last seen __date__ at __time__","last seen today at __time__","last seen __date__ at __time__","last seen yesterday at __time__","__participant__ is typing","__participant__ is recording audio","Audio","Contact","__count__ page","Document","Photo","Live location","Location","Product","Sticker","Video","Voice message","Delete","Delete group","Delete broadcast list","Download __name__","Encryption","Exit","Exit group","Frequently Contacted","Go",'Your security code with all participants changed because there was a login on this device. To verify a contact\'s security code, open their Contact Info page and click "Encryption".',"Group admin","Only admins can message this group.","__name__ changed this group's settings to allow all participants to send messages to this group.","You changed this group's settings to allow all participants to send messages to this group.","__name__ changed this group's settings to allow only admins to send messages to this group.","You allowed only admins to send messages to this group","An admin created this group","__name__ created group __subject__","__name__ created this group","An admin created group __subject__","You created group __subject__","You created this group","Created __date__ at __time__","Created __date__ at __time__","Created today at __time__","Created today at __time__","Created __day__ at __time__","Created __day__ at __time__","Created yesterday at __time__","Created yesterday at __time__","__name__ changed the group description. Click to view.","__name__ changed the group description.","A participant changed the group description. Click to view.","A participant changed the group description.","You changed the group description. Click to view.","Group Description","This group has ended","Group info","Messages are end-to-end encrypted. Click to learn more.","Messages and calls are end-to-end encrypted. Click to learn more.","Messages are end-to-end encrypted. No one outside of this chat, not even WhatsApp, can read or listen to them. Click to learn more.","Messages you send to this group are secured with end-to-end encryption, which means WhatsApp and third parties can't read them.","Messages and calls to this group are secured with end-to-end encryption, which means WhatsApp and third parties can't read or listen to them.","Messages and calls are end-to-end encrypted. No one outside of this chat, not even WhatsApp, can read or listen to them. Click to learn more.","__name__ reset this group's invite link. Click to view the new invite link.","You reset this group's invite link. Click to view the new invite link.","__name__ changed this group's settings to allow messages that have been forwarded many times.","You changed this group's settings to allow messages that have been forwarded many times.","__name__ changed this group's settings to not allow messages that have been forwarded many times.","You changed this group's settings to not allow messages that have been forwarded many times.","__name__ was added","You were added","__name__ changed their phone number to a new number.","__name__ changed to __new_number__","__participants__ is no longer an admin","You're no longer an admin","__name__ joined via an invite link","You joined via an invite link","__name__ left","You left","__participants__ is now an admin","You're now an admin","__name__ was removed","You were removed","__name__ added __participants__","__name__ added you","__name__ removed __participants__","__name__ removed you","A participant added __participants__","A participant added you","A participant removed __participants__","A participant removed you","You added __participants__","You removed __participants__","__name__ changed this group's settings to allow all participants to edit this group's info.","You changed this group's settings to allow all participants to edit this group's info.","__name__ changed this group's settings to allow only admins to edit this group's info.","You changed this group's settings to allow only admins to edit this group's info.","Your security code with all participants changed. Click to learn more.","__name__ changed the subject to __subject__","A participant changed the subject to __subject__","You changed the subject to __subject__","Invite to group","__num__ invite sent","Invite reset","Groups","Groups in common","Messages to this chat and calls are secured with end-to-end encryption, which means that WhatsApp and third parties cant read or listen to them. __businessName__ may use a service to store, read and respond to your messages and calls. Contact __businessName__ for information on their privacy practices.","Learn more","Broadcast list info","__name__ added to the list","__name__ removed from the list","Logging Out","Do not close this window","One or more group participants are using old versions of WhatsApp that can't receive messages sent from this device. Use your phone to message them instead.","This message couldnt be delivered","__name__ is using an old version of WhatsApp that can't receive messages sent from this device. Use your phone to message them instead.","Clearing or deleting entire chats will remove messages from this device only. They will not be removed from other devices.","Changes to clearing or deleting a chat","Messages will be removed from this device only.","Messages will be removed from this device only.","Your computer does not have enough space for WhatsApp to run. Please create more storage by deleting unused files from your computer, then log in again.","The most recent messages in this group will be forwarded to WhatsApp. If you exit the group and clear the chat, it will be deleted from this device only.","The most recent messages from this contact will be forwarded to WhatsApp. If you block this contact and clear the chat, it will be deleted from this device only.","The most recent messages from this business will be forwarded to WhatsApp. If you block this business and clear the chat, it will be deleted from this device only.","Pinning chats is not yet available on the WhatsApp Web Beta","Can't pin chat","To verify that messages and calls with __contactName__ are end-to-end encrypted, open this screen on your phone, and follow the instructions.","New group","Mute notifications","Unmute notifications","New chat","About","Status","Could not deliver message","Messages","Missed group video call","Missed group video call at __time__","Missed group voice call","Missed group voice call at __time__","Missed video call","Missed video call at __time__","Missed voice call","Missed voice call at __time__","No","The business account for __businessName__ has registered as a standard user account and may no longer belong to the business.","The business account you were chatting with is now a standard account. Click for more info.","Messages to this chat are now secured with end-to-end encryption, which means third parties can't read or listen to them.","Messages to this chat are now secured with end-to-end encryption. Click to learn more.","OK","Other contacts","__count__ participant","To receive a payment from __senderName__, set up your payment account on your phone.","__contactName__ canceled their payment request for __currencyAndAmount__","You cancelled your payment request to __contactName__ for __currencyAndAmount__","__contactName__ declined your payment request for __currencyAndAmount__.","You declined __contactName__'s payment request for __currencyAndAmount__.","__senderName__'s payment request for __currencyAndAmount__ to you expired.","Your payment request to __receiverName__ for __currencyAndAmount__ expired.","You notified __receiverName__ that you are trying to send a payment.","You can now send __receiverName__ a payment.","Waiting for this payment message's note. This may take a while.","Payment message  Amount unavailable","This payment message has a note but your version of WhatsApp doesn't support viewing it.","Requested from __receiverName__","Requested __amount__ from You","__senderName__ requested __amount__ from You","__senderName__ requested __amount__ from __receiverName__","Sent __amount__ to You","__senderName__ sent __amount__ to You","__senderName__ sent __amount__ to __receiverName__","Sent to __receiverName__","Cancelled","Completed","Failed","Expired","In Review","Pending","Pending (expiring)","Pending (expires __timeSpan__)","Pending (expires in less than 1 minute)","Processing","__senderName__ sent you __currencyAndAmount__. Use WhatsApp on your phone to accept this transaction.","__senderName__'s payment __relativeTime__ is complete.","Declined","Your payment to __receiverName__ __relativeTime__ couldn't complete.","Your payment to __receiverName__ __relativeTime__ couldn't complete.","Your payment to __receiverName__  was refunded __relativeTime__.","on Friday","on Monday","on Saturday","on __date__","on Sunday","on Thursday","on Tuesday","on Wednesday","__name__ changed this group's icon","You changed this group's icon","__name__ deleted this group's icon","You deleted this group's icon","Preview","OFFICIAL ANNOUNCEMENTS","Recent chats","Recipients","Your security code with __contactName__ changed because there was a logout from one of their devices.",'Your security code with all recipients changed because there was a logout from one of your devices. To verify a contact\'s security code, open their Contact Info page and click "Encryption".',"Your security code with __contactName__ changed because there was a logout from one of your devices.",'Your security code with all participants changed because there was a logout from one of your devices. To verify a contact\'s security code, open their Contact Info page and click "Encryption".',"Reset link","Web Search","Your security code with __contactName__ changed. Click to learn more.","Your security code with __name__ changed because there was a registration on a new device of theirs.",'Your security code with all recipients changed because there was a registration on a new device of yours. To verify a contact\'s security code, open their Contact Info page and click "Encryption".',"Your security code with __name__ changed because there was a registration on a new device of yours.",'Your security code with all participants changed because there was a registration on a new device of yours. To verify a contact\'s security code, open their Contact Info page and click "Encryption".',"Select messages","Help Center","Share","This business uses WhatsApp Business, which allows them to add their opening hours, address, website and catalog of products or services.",'WhatsApp has verified that this is the official business account of "__businessName__". This business uses WhatsApp Business, which allows them to add their opening hours, address, website and catalog of products or services.',"Learn about getting the app","About WhatsApp Business","If youre a business, the free WhatsApp Business app can help.","If youre a business, you can benefit from switching to the free WhatsApp Business app. It has tools to connect with customers and manage messages.","Scan this code to get the WhatsApp Business App. Or, you can install it from the App Store or Google Play Store.","WhatsApp Business app","We are updating our WhatsApp Business Terms of Service. Agree to our new Terms on your phone to continue using WhatsApp Business.",'We are updating our WhatsApp Business Terms of Service. Agree to our new Terms on your phone to continue using WhatsApp Business. If you have accepted the Terms of Service, click "LOG IN" to continue using WhatsApp Business.',"Starred Messages","About",'This chat is with the verified business account for "__businessName__". Click for more info.','WhatsApp has made changes to the business account types. "Verified Business" will now be labeled as "Official Business Account".','This chat is with the business account for "__businessName__". Click for more info.','WhatsApp has made changes to the business account types. "Confirmed Business" will now be labeled as "Business Account".',"This chat may be with a business account. Click for more info.","__businessName__ may be a business account, but WhatsApp hasnt verified their name yet.",'The business account youre chatting with is now verified as "__businessName__". Click for more info.','WhatsApp has made changes to the business account types. "Verified Business" will now be labeled as "Official Business Account".',"This business account has now registered as a standard account. Click for more info.","This account was previously a business account and has now registered as a standard account. It may no longer belong to the business.",'The business account youre chatting with is no longer verified as "__businessName__". Click for more info.','WhatsApp is no longer able to verify that this is the account for "__businessName__".','The business account youre chatting with is no longer verified as "__businessName__". Click for more info.','WhatsApp is no longer able to verify that this is the account for "__businessName__".','The business account youre chatting with is no longer confirmed as "__businessName__". Click for more info.','WhatsApp is no longer able to confirm that this is the account for "__businessName__".',"This account has registered as a business account. Click for more info.",'This account has registered as a business account and WhatsApp has confirmed that this is the account for "__businessName__".',"This chat may be with a business account. Click for more info.","__businessName__ registered as a business account, but WhatsApp hasnt verified their name yet.",'The business account you\'re chatting with belongs to "__businessName__".','WhatsApp has made changes to the business account types. This "Confirmed Business" will now be labeled as "Business Account".',"WhatsApp is updating our Terms and Privacy Policy to reflect new features and comply with the new European Union data protection laws. Open WhatsApp on your phone to read our Terms and Privacy Policy and learn more about the choices you have.","WhatsApp is updating our Terms and Privacy Policy to reflect new features and comply with the new European Union data protection laws. Open WhatsApp on your phone to read our Terms and Privacy Policy and learn more about the choices you have.",'WhatsApp is updating our Terms and Privacy Policy to reflect new features and comply with the new European Union data protection laws. Open WhatsApp on your phone to read our Terms and Privacy Policy and learn more about the choices you have. If you have accepted the Terms and Privacy Policy, click "LOG IN" to continue using WhatsApp.',"__date__ at __time__","today","today at __time__","Try Again","The business account you're chatting with may belong to __businessName__. WhatsApp hasn't verified their name yet.","The business account you're chatting with is now unverified. Click for more info.","To help you connect with businesses, we have verified that the business account you're chatting with belongs to __businessName__.","This chat is with a verified business account. Click for more info.","The business account you're chatting with may belong to __businessName__. WhatsApp hasn't verified their name yet.","This chat is with an unverified business account. Click for more info.","To help you connect with businesses, we have verified that the business account you're chatting with belongs to __businessName__.","The business account you're chatting with is now verified. Click for more info.","Verify","Download code","Release to verify","The image does not contain a valid identity verification QR code.",'You opened "Verify security code" for the wrong phone number. Open it for the correct number to verify __contact__.','__contact__ opened "Verify security code" for the wrong phone number. Ask __contact__ to open it for your phone number.',"Scan the code on your contact's phone, or ask them to scan your code, to verify your messages and calls to them are end-to-end encrypted. You can also compare the number above to verify. This is optional.","Couldn't display security code. You can verify using the QR code instead.","Verify Security Code","Upload Code","Turn Off Camera","Please try increasing the brightness or reducing light reflection.","Scan Code","WHATSAPP VOICE CALL","Yes","yesterday","yesterday at __time__","You","You created a broadcast list with __count__ recipient","You","To use WhatsApp, update __chrome_update__ or use __firefox_homepage__, __safari_homepage__, __edge_homepage__ or __opera_homepage__.","WhatsApp works with Google Chrome __min_version_chrome__+","WhatsApp Commerce Policies","To use WhatsApp, update __edge_homepage__ or use __chrome_homepage__, __firefox_homepage__ or __opera_homepage__.","WhatsApp works with Microsoft Edge __min_version_edge__+","To use WhatsApp, update __firefox_update__ or use __chrome_homepage__, __safari_homepage__, __edge_homepage__ or __opera_homepage__.","WhatsApp works with Mozilla Firefox __min_version_firefox__+","WhatsApp group invite","WhatsApp","To use WhatsApp, update __safari_update__ or use __chrome_homepage__, __firefox_homepage__ or __opera_homepage__.","To use all of WhatsApp's features like photo capturing and Voice Message recording, we recommend using __chrome_homepage__, __firefox_homepage__ or __opera_homepage__.","Using Safari","WhatsApp works with Safari __min_version_safari__+","WhatsApp","Send and receive WhatsApp messages right from your computer.","WhatsApp is open in another window. Click Use Here to use WhatsApp in this window.","Quickly send and receive WhatsApp messages right from your computer.","We recommend using WhatsApp with one of the following browsers:","WhatsApp also supports:","You can't add more than __count__ labels","Your security code with __contactName__ changed","This happened likely because __contactName__ or you recently changed which devices you use WhatsApp on. Please verify the security code again."],{37:"Changing __count__ labels",38:"Some labels could not be updated",39:"__count__ labels changed",142:"Couldn't delete __count__ messages because the messages may have expired",143:"Couldn't delete messages",144:"__count__ messages deleted",145:"Deleting messages",146:"Couldn't star messages because the messages may have expired",147:"Couldn't star messages",148:"__count__ messages starred",149:"Starring messages",151:"Couldn't unstar messages because the messages may have expired",152:"Couldn't unstar messages",153:"__count__ messages unstarred",155:"Unstarring messages",159:"Couldn't add __participantNames__.",161:"You added __participantNames__.",162:"Adding __participantNames__.",163:"Removing __participantNames__ as admins failed.",166:"__participantNames__ are no longer group admins.",167:"Removing __participantNames__ as group admins.",168:"They are no longer in this group.",169:"You can't add these participants because they left the group recently.",172:"Couldn't make __participantNames__ admins.",174:"__participantNames__ are now group admins.",175:"Making __participantNames__ group admins.",176:"Couldn't remove __participantNames__.",179:"You removed __participantNames__.",180:"Removing __participantNames__.",213:"Add participants",241:"__count__ Pages",245:"__number__ audio files you tried adding have no content.",250:"__number__ audio files you tried adding are larger than the __maxSize__ limit.",407:"__count__ messages couldn't be forwarded because __contact__ is on a version of WhatsApp that doesn't support them.",409:"__count__ messages couldn't be forwarded because the file is missing.",410:"__count__ messages couldn't be forwarded because the file is missing or __contact__ is on a version of WhatsApp that doesn't support them.",508:"__count__ items",522:"Send __count__ contacts to __chat__?",523:"Send __count__ contacts to __chat__?",524:"Send __count__ contacts to __chat__?",535:"Contact Cards",540:"__number__ contacts that you tried to add have no content.",541:"The contacts that you tried to add are larger than the __maxSize__ limit.",568:"Deleting a label removes it from all messages, contacts, and from the list of labels. Are you sure you want to delete these labels?",569:"Delete messages",570:"Delete messages?",587:"__count__ Docs",589:"__number__ documents you tried adding have no content.",590:"__number__ documents you tried adding are larger than the __maxSize__ limit.",622:"Disappearing messages were turned on. New messages will disappear from this chat after __number__ days.",623:"Disappearing messages were turned on. New messages will disappear from this chat after __number__ hours.",624:"Disappearing messages were turned on. New messages will disappear from this chat after __number__ minutes.",625:"Disappearing messages were turned on. New messages will disappear from this chat after __number__ seconds.",627:"You turned on disappearing messages. New messages will disappear from this chat after __number__ days.",628:"You turned on disappearing messages. New messages will disappear from this chat after __number__ hours.",629:"You turned on disappearing messages. New messages will disappear from this chat after __number__ minutes.",630:"You turned on disappearing messages. New messages will disappear from this chat after __number__ seconds.",632:"__name__ turned on disappearing messages. New messages will disappear from this chat after __number__ days.",633:"__name__ turned on disappearing messages. New messages will disappear from this chat after __number__ hours.",634:"__name__ turned on disappearing messages. New messages will disappear from this chat after __number__ minutes.",635:"__name__ turned on disappearing messages. New messages will disappear from this chat after __number__ seconds.",636:"__name__ turned on disappearing messages. New messages will disappear from this chat after __number__ years.",638:"Disappearing messages were turned on. New messages will disappear from this chat after __number__ days. Click to change.",639:"Disappearing messages were turned on. New messages will disappear from this chat after __number__ hours. Click to change.",640:"Disappearing messages were turned on. New messages will disappear from this chat after __number__ minutes. Click to change.",641:"Disappearing messages were turned on. New messages will disappear from this chat after __number__ seconds. Click to change.",643:"You turned on disappearing messages. New messages will disappear from this chat after __number__ days. Click to change.",644:"You turned on disappearing messages. New messages will disappear from this chat after __number__ hours. Click to change.",645:"You turned on disappearing messages. New messages will disappear from this chat after __number__ minutes. Click to change.",646:"You turned on disappearing messages. New messages will disappear from this chat after __number__ seconds. Click to change.",648:"__name__ turned on disappearing messages. New messages will disappear from this chat after __number__ days. Click to change.",649:"__name__ turned on disappearing messages. New messages will disappear from this chat after __number__ hours. Click to change.",650:"__name__ turned on disappearing messages. New messages will disappear from this chat after __number__ minutes. Click to change.",651:"__name__ turned on disappearing messages. New messages will disappear from this chat after __number__ seconds. Click to change.",654:"New messages will disappear from this chat after __number__ days.",655:"New messages will disappear from this chat after __number__ hours.",656:"New messages will disappear from this chat after __number__ minutes.",657:"New messages will disappear from this chat after __number__ seconds.",661:"This message will disappear from this chat after __number__ days.",662:"This message will disappear from this chat after __number__ hours.",663:"This message will disappear from this chat after __number__ minutes.",664:"This message will disappear from this chat after __number__ seconds.",676:"__number__ days",677:"__number__ hours",678:"__number__ minutes",679:"__number__ seconds",689:"Wait until the messages finish sending and displays a checkmark before forwarding.",698:"__number__ files you tried adding have no content.",699:"__count__ files failed to be downloaded because they are no longer on your phone.",700:"__number__ files could not be added.",701:"__number__ files you tried adding are not supported.",702:"__number__ files you tried adding are larger than the __maxSize__ limit.",709:"You can only share with up to __count__ chats",710:"Forwarded many times. You can only share with up to __count__ chats.",711:"Messages forwarded many times can only be shared with up to __count__ chats at a time.",712:"Forward messages",713:"Forward messages to",715:"Forwarded __count__ times",720:"Found contact cards for this number. View contact cards?",761:"__count__ contacts",766:"__count__ participants",790:"__count__ more",795:"Couldn't add __participant__. You can invite them privately to join this group.",831:"__unreadCount__ New Messages",834:"__number__ images you tried adding have no content.",842:"__number__ images you tried adding are larger than the __maxSize__ limit.",858:"Expires in __number__ days",864:"__count__ items",880:"__count__ Links",881:"Accurate to __accuracy__ M",882:"__count__ people",889:"Live until __time__",896:"__hours__h left",898:"__minutes__m left",899:"__sharers__ are sharing live location",901:"__count__ people are sharing live location",904:"You and __count__ others are sharing live location",909:"Updated __hours__h ago",912:"Updated __minutes__m ago",995:"__count__ remaining",1031:"__contactName__ and __count__ other contacts",1033:"__count__ contacts",1034:"You can only send up to __count__ contacts",1218:"__count__ Products",1219:"This photo is too small. Please select a photo with height and width of at least __size__ pixels.",1229:'Remove label "__labelName__" from __count__ items',1262:"Retrying in __number__ seconds",1299:"See __count__ archived chats",1302:"__count__ selected",1321:"__count__ Screenshots Maximum",1340:"Star messages",1384:"__count__ suspicious links",1400:"Maximum number of files uploaded. __number__ files have been ignored.",1412:"__count__ unread messages",1418:"Unstar messages",1440:"__participants__ joined using your invite",1441:"You invited __participants__",1464:"__number__ videos you tried adding have no content.",1466:"__number__ videos you tried adding are larger than the __maxSize__ limit.",1468:"View Contact Cards",1527:"Call cannot be placed for more than __count__ participants",1529:"You can only call up to __count__ contacts",1530:"__callee__ couldn't be added to the call, because they are using an old version of WhatsApp or an incompatible device.",1531:"__count__ others",1623:"__count__ pages",1686:"__participants__ are no longer admins",1692:"__participants__ are now admins",1715:"__num__ invites sent",1722:"__name__ were added to the list",1723:"__name__ were removed from the list",1749:"Missed group video call at __time__",1751:"Missed group voice call at __time__",1753:"Missed video call at __time__",1755:"Missed voice call at __time__",1763:"__count__ participants",1765:"__contactName__ canceled their payment request for __currencyAndAmount__",1766:"You cancelled your payment request to __contactName__ for __currencyAndAmount__",1767:"__contactName__ declined your payment request for __currencyAndAmount__.",1768:"You declined __contactName__'s payment request for __currencyAndAmount__.",1769:"__senderName__'s payment request for __currencyAndAmount__ to you expired.",1770:"Your payment request to __receiverName__ for __currencyAndAmount__ expired.",1777:"Requested __amount__ from You",1778:"__senderName__ requested __amount__ from You",1779:"__senderName__ requested __amount__ from __receiverName__",1780:"Sent __amount__ to You",1781:"__senderName__ sent __amount__ to You",1782:"__senderName__ sent __amount__ to __receiverName__",1794:"__senderName__ sent you __currencyAndAmount__. Use WhatsApp on your phone to accept this transaction.",1897:"You created a broadcast list with __count__ recipients"}]},75466:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ParsableWapNode=t.XmppParsingFailure=void 0;var a=r(45321),n=r(30691),i=r(41263),s=r(46378),o=r(71684),u=r(44880),l=r(75586);class d{constructor(e,t){this.parser=e,this.reason=t}toString(){return"XmppParsingFailure: ".concat(this.parser,": ").concat(this.reason)}}t.XmppParsingFailure=d;class c extends l.ParsableXmlNode{constructor(e,t){super(e,t)}assertFromServer(){var e=this.attrString("from");"s.whatsapp.net"!==e&&this.throw('to have "from"="s.whatsapp.net", but instead has "'.concat(e,'"'))}attrUserJid(e){var t=this.attrString(e);return(0,i.interpretAndValidateJid)(t).userJid||this.throw('to have "'.concat(e,'"={UserJid}, but instead has "').concat(t,'"'))}maybeAttrUserJid(e){return this.hasAttr(e)?this.attrUserJid(e):null}attrGroupJid(e){var t=this.attrString(e);return(0,i.interpretAndValidateJid)(t).groupJid||this.throw('to have "'.concat(e,'"={GroupJid}, but instead has "').concat(t,'"'))}attrChatJid(e){var t=this.attrString(e),r=(0,i.interpretAndValidateJid)(t);return r.userJid||r.groupJid||this.throw('to have "'.concat(e,'"={ChatJid}, but instead has "').concat(t,'"'))}attrDeviceJid(e){var t=this.attrString(e),r=(0,i.interpretAndValidateJid)(t);return r.deviceJid?r.deviceJid:r.userJid?(0,i.defaultDeviceJidForUser)(r.userJid):this.throw('to have "'.concat(e,'"={DeviceJid}, but instead has "').concat(t,'"'))}attrDeviceId(e){var t=this.attrInt(e);return(0,i.interpretAsDeviceId)(t)}attrFromJid(){var e=this.attrJidWithType(),t=this.hasAttr("participant")?this.attrDeviceJid("participant"):null;switch(e.jidType){case"user":var r=e.userJid,a=(0,i.defaultDeviceJidForUser)(r);return{type:"device",deviceJid:a,chat:r,author:a};case"device":var n=e.deviceJid;return{type:"device",deviceJid:n,chat:(0,i.extractUserJid)(n),author:n};case"broadcast":return t?{type:"broadcast",broadcastJid:e.broadcastJid,chat:(0,i.extractUserJid)(t),author:t}:this.throw("to have participant for broadcast msg");case"group":if(!t)return this.throw("to have participant for group msg");var s=e.groupJid;return{type:"group",groupJid:s,chat:s,author:t};default:return e.jidType,t?{type:"status",statusJid:e.statusJid,author:t}:this.throw("to have participant for status msg")}}attrJidWithType(e="from"){var t=this.attrString(e),r=(0,i.interpretAndValidateJid)(t);return"unknown"===r.jidType?this.throw('to have "'.concat(e,'"={Jid}, but instead has "').concat(t,'"')):r}attrWapJid(e="from"){var t=this.attrString(e),r=(0,i.interpretAndValidateJid)(t);return"unknown"===r.jidType?a.WapJid.create(null,t):(0,n.JID)((0,i.extractFromJid)(r))}attrLongInt(e){var t=this.attrString(e);return(0,u.decimalStringToLongInt)(t)}attrTime(e){return(0,o.castToUnixTime)(this.attrInt(e))}attrFutureTime(e){var t=this.attrInt(e);return(0,o.futureUnixTime)(t)}contentString(){if(this.hasChildren())return this.throw("to have string content, but has children instead");if(this.hasContent()){var e=new s.Binary(this.contentBytes());return e.readString(e.size())}return this.throw("to have content")}decodeAsString(e){return(0,n.decodeAsString)(e)}throw(e){throw new d(this.name(),"expected <".concat(this.tag(),"> ").concat(e))}}t.ParsableWapNode=c},45321:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WapJid=t.WAP_JID_SUBTYPE=void 0;var a=r(79568),n={JID:0,JID_AD:1};t.WAP_JID_SUBTYPE=n;class i{constructor(e){this._jid=e}static createAD(e,t,r){return new i({type:n.JID_AD,user:e,device:null==r?0:r,agent:null==t?0:t})}static create(e,t){return new i({type:n.JID,user:e,server:t})}toString(){if(this._jid.type===n.JID_AD){var{user:e,agent:t,device:r}=this._jid,i=a.USER_JID_SUFFIX;return 0===t&&0===r?"".concat(e,"@").concat(i):0!==t&&0===r?"".concat(e,".").concat(t,"@").concat(i):0===t&&0!==r?"".concat(e,":").concat(r,"@").concat(i):"".concat(e,".").concat(t,":").concat(r,"@").concat(i)}this._jid.type;var{user:s,server:o}=this._jid;return null!=s?"".concat(s,"@").concat(o):o}getInnerJid(){return this._jid}}t.WapJid=i},51311:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WapParser=void 0;var a=r(75466);t.WapParser=class{constructor(e,t){this._name=e,this._parser=t}parse(e){var t=new a.ParsableWapNode(this._name,e);try{return{success:this._parser(t)}}catch(e){if(e instanceof a.XmppParsingFailure)return{error:e};throw e}}parseOrThrow(e){var t=this.parse(e);if(t.error)throw new Error(String(t.error));return t.success}}},79568:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.USER_JID_FB_SUFFIX=t.USER_JID_SUFFIX=void 0;t.USER_JID_SUFFIX="s.whatsapp.net";t.USER_JID_FB_SUFFIX="msgr"},30691:(e,t,r)=>{"use strict";var a=r(34398);Object.defineProperty(t,"__esModule",{value:!0}),t.makeWapNode=A,t.decodeAsString=function(e){if(e instanceof u.WapJid)return e.toString();return e},t.makeStanza=O,t.encodeStanza=function(e){var t=e instanceof b?e:O(e),r=new i.Binary;w(t,r);var a=r.readByteArray(),n=new Uint8Array(1+a.length);return n[0]=0,n.set(a,1),n},t.decodeStanza=function(e,t){var r=new i.Binary(e);if(2&r.readUint8())return __LOG__(2)(c()),t(r.readByteArray()).then((e=>F(new i.Binary(e))));return Promise.resolve(F(r))},t.generateId=function(){if(!g){var e=new Uint16Array(2);self.crypto.getRandomValues(e),g="".concat(String(e[0]),".").concat(String(e[1]),"-")}return"".concat(g).concat(v++)},t.extractToJid=Y,t.extractParticipantJid=function(e){switch(e.type){case"group":case"status":case"broadcast":return e.author;default:return e.type,null}},t.PARTICIPANT_JID=function(e){return"status"===e.type||"group"===e.type||"broadcast"===e.type?K(e.author):E},t.TO_JID=function(e){return K(Y(e))},t.JID=K,t.CUSTOM_STRING=function(e){return e},t.MAYBE_CUSTOM_STRING=function(e){if(null==e)return E;return e},t.INT=function(e){return e.toString()},t.LONG_INT=function(e){return(0,d.longIntToDecimalString)(e)},t.BIG_ENDIAN_CONTENT=function(e,t=4){for(var r=e,a=new Uint8Array(t),n=t-1;n>=0;n--)a[n]=255&r,r>>>=8;return a},t.wap=t.WapNode=t.S_WHATSAPP_NET=t.G_US=t.DROP_ATTR=void 0;var n=a(r(4875)),i=r(46378),s=r(28631),o=r(79568),u=r(45321),l=r(58489),d=r(44880);function c(){var e=(0,n.default)(["Decoding compressed stanza"]);return c=function(){return e},e}var f=[236,237,238,239],p=248,h=249,_=["0","1","2","3","4","5","6","7","8","9","-",".","","","",""],m=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F"],g="",v=1,E={sentinel:"DROP_ATTR"};t.DROP_ATTR=E;var y=u.WapJid.create(null,"g.us");t.G_US=y;var S=u.WapJid.create(null,"s.whatsapp.net");t.S_WHATSAPP_NET=S;var T={};class b{constructor(e,t=T,r=null){this.tag=e,this.attrs=t,this.content=r}toString(){var e="<"+this.tag;e+=(0,s.attrsToString)(this.attrs);var t=this.content;return Array.isArray(t)?e+=">".concat(t.map(String).join(""),"</").concat(this.tag,">"):e+=t?">".concat((0,s.uint8ArrayToDebugString)(t),"</").concat(this.tag,">"):" />",e}}function A(e,t,r){var a=null;if(t&&null!=t.children)throw new Error('Children should not be passed via props (see eslint check "react/no-children-props")');if(Array.isArray(r))a=r.filter(Boolean);else if("string"==typeof r)a=i.Binary.build(r).readByteArray();else if(r instanceof ArrayBuffer)a=new Uint8Array(r);else if(r instanceof Uint8Array)a=r;else{for(var n=[],s=2;s<arguments.length;s++){var o=arguments[s];o&&n.push(o)}a=n}Array.isArray(a)&&0===a.length&&(a=null);var u={};if(t){var l=t;Object.keys(l).forEach((t=>{var r=l[t];if(null==r)throw new Error("Attr ".concat(t," in <").concat(e,"> is null"));r!==E&&(u[t]=r)}))}return new b(e,u,a)}t.WapNode=b;var C,P=A;function O(e){var t=e.content;return Array.isArray(t)?t=t.map(O):"string"==typeof t&&(t=i.Binary.build(t).readByteArray()),new b(e.tag,e.attrs||T,t)}function w(e,t){if(null==e)t.writeUint8(0);else if(e instanceof b)M(e,t);else if(e instanceof u.WapJid)!function(e,t){var r=e.getInnerJid();if(r.type===u.WAP_JID_SUBTYPE.JID_AD){var{user:a,agent:n,device:i}=r;t.writeUint8(247),t.writeUint8(n),t.writeUint8(i),w(a,t)}else{var{user:s,server:o}=r;t.writeUint8(250),null!=s?w(s,t):t.writeUint8(0),w(o,t)}}(e,t);else if("string"==typeof e)D(e,t);else{if(!(e instanceof Uint8Array))throw new Error("Invalid payload type ".concat(typeof e));!function(e,t){L(e.length,t),t.writeByteArray(e)}(e,t)}}function M(e,t){if(void 0===e.tag)return t.writeUint8(p),void t.writeUint8(0);var r=1;e.attrs&&(r+=2*Object.keys(e.attrs).length),e.content&&r++,r<256?(t.writeUint8(p),t.writeUint8(r)):r<65536&&(t.writeUint8(h),t.writeUint16(r)),w(e.tag,t),e.attrs&&Object.keys(e.attrs).forEach((r=>{D(r,t),w(e.attrs[r],t)}));var a=e.content;if(Array.isArray(a)){a.length<256?(t.writeUint8(p),t.writeUint8(a.length)):a.length<65536&&(t.writeUint8(h),t.writeUint16(a.length));for(var n=0;n<a.length;n++)M(a[n],t)}else a&&w(a,t)}t.wap=P;var I=null;function R(e){for(var t=new Map,r=0;r<e.length;r++)t.set(e[r],r);return t}function D(e,t){if(""===e)return t.writeUint8(252),void t.writeUint8(0);null==C&&(C=R(l.SINGLE_BYTE_TOKEN));var r=C.get(e);if(null==r){if(null==I){I=[];for(var a=0;a<l.DICTIONARIES.length;++a)I.push(R(l.DICTIONARIES[a]))}for(var n=0;n<I.length;++n){var s=I[n].get(e);if(null!=s)return t.writeUint8(f[n]),void t.writeUint8(s)}var o=(0,i.numUtf8Bytes)(e);if(o<128){if(!/[^0-9.-]+?/.exec(e))return void N(e,255,t);if(!/[^0-9A-F]+?/.exec(e))return void N(e,251,t)}L(o,t),t.writeString(e)}else t.writeUint8(r+1)}function N(e,t,r){var a=e.length%2==1;r.writeUint8(t);var n=Math.ceil(e.length/2);a&&(n|=128),r.writeUint8(n);for(var i=0,s=0;s<e.length;s++){var o=e.charCodeAt(s),u=null;if(48<=o&&o<=57?u=o-48:255===t?45===o?u=10:46===o&&(u=11):251===t&&65<=o&&o<=70&&(u=o-55),null==u)throw new Error("Cannot nibble encode ".concat(o));s%2==0?(i=u<<4,s===e.length-1&&(i|=15,r.writeUint8(i))):(i|=u,r.writeUint8(i))}}function L(e,t){if(e<256)t.writeUint8(252),t.writeUint8(e);else if(e<1048576)t.writeUint8(253),t.writeUint8(e>>>16&255),t.writeUint8(e>>>8&255),t.writeUint8(255&e);else{if(!(e<4294967296))throw new Error("Binary with length ".concat(e," is too big for WAP protocol"));t.writeUint8(254),t.writeUint32(e)}}function k(e,t){var r,a,n,i=e.readUint8();if(0===i)return null;if(i===p)return U(e,e.readUint8());if(i===h)return U(e,e.readUint16());if(252===i){var s=e.readUint8();return x(e,s,t)}if(253===i){var o=e.readUint8(),d=e.readUint8(),c=e.readUint8();return x(e,((15&o)<<16)+(d<<8)+c,t)}if(254===i){var f=e.readUint32();return x(e,f,t)}if(250===i)return a=function(e){var t=k(e,!0);if(null!=t&&"string"!=typeof t)throw new Error("Decode string got invalid value ".concat(String(t),", string expected"));return t}(r=e),n=G(r),u.WapJid.create(a,n);if(247===i)return function(e){var t=e.readUint8(),r=e.readUint8(),a=G(e);return u.WapJid.createAD(a,t,r)}(e);if(255===i){var g=e.readUint8();return B(e,_,g>>>7,127&g)}if(251===i){var v=e.readUint8();return B(e,m,v>>>7,127&v)}if(i<=0||i>=240)throw new Error("Unable to decode WAP buffer");if(i>=236&&i<=239){var E=i-236,y=l.DICTIONARIES[E];if(void 0===y)throw new Error("Missing WAP dictionary ".concat(E));var S=e.readUint8(),T=y[S];if(void 0===T)throw new Error("Invalid value index ".concat(S," in dict ").concat(E));return T}var b=l.SINGLE_BYTE_TOKEN[i-1];if(void 0===b)throw new Error("Undefined token with index ".concat(i));return b}function U(e,t){for(var r=[],a=0;a<t;a++)r.push(F(e));return r}function F(e){var t,r=e.readUint8();if(r===p)t=e.readUint8();else{if(r!==h)throw new Error("Failed to decode node since type byte ".concat(String(r)," is invalid"));t=e.readUint16()}var a=void 0,n=null;if(0===t)throw new Error("Failed to decode node, list cannot be empty");var i=G(e);for(t-=1;t>1;){a||(a={});var s=G(e),o=k(e,!0);a[s]=o,t-=2}return 1===t&&(n=k(e,!1))instanceof u.WapJid&&(n=String(n)),new b(i,a,n)}function G(e){var t=k(e,!0);if("string"!=typeof t)throw new Error("Decode string got invalid value ".concat(String(t),", string expected"));return t}function x(e,t,r=!1){return r?e.readString(t):e.readByteArray(t)}function B(e,t,r,a){for(var n=new Array(2*a-r),i=0;i<n.length-1;i+=2){var s=e.readUint8();n[i]=t[s>>>4],n[i+1]=t[15&s]}if(r){var o=e.readUint8();n[n.length-1]=t[o>>>4]}return n.join("")}function Y(e){switch(e.type){case"group":return e.groupJid;case"status":return e.statusJid;case"device":return e.deviceJid;default:return e.type,e.broadcastJid}}function K(e){var[t,r]=e.split("@"),a=null,n=null;return r===o.USER_JID_SUFFIX&&(-1!==t.indexOf(":")&&([t,n]=t.split(":"),n=parseInt(n,10)),-1!==t.indexOf(".")&&([t,a]=t.split("."),a=parseInt(a,10))),null!=n&&0!==n||null!=a&&0!==a?u.WapJid.createAD(t,a,n):u.WapJid.create(t,r)}},58489:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DICTIONARIES=t.DICTIONARY_3_TOKEN=t.DICTIONARY_2_TOKEN=t.DICTIONARY_1_TOKEN=t.DICTIONARY_0_TOKEN=t.SINGLE_BYTE_TOKEN=t.DICT_VERSION=void 0;t.DICT_VERSION=1;t.SINGLE_BYTE_TOKEN=["xmlstreamstart","xmlstreamend","s.whatsapp.net","id","type","from","to","participant","t","receipt","status","jid","2","broadcast","class","g.us","iq","enc","v","ack","1","message","user","notify","read","skmsg","xmlns","result","0","offline","text","off_cnt","7","get","edit","phash","media","mediatype","image","value","item","presence","contact","msg","set","notification","chatstate","video","host","hostname","picture","fna","composing","w:p","ping","pop","media_conn","ip4","primary","download","unavailable","fallback_ip4","fallback_hostname","fallback_class","config","w","ip6","count","participants","fallback_ip6","call","download_buckets","3","retry","00","gif","upload","w:m","last","props","edge_routing","routing_info","handshake","pkmsg","26","location","creation","vll","success","seen","in","list","12","auth","subject","21600","auth_ttl","max_buckets","300","ttl","is_new","hash","call-id","call-creator","platform","4","urn:xmpp:whatsapp:push","relaylatency","8","gcm","urn:xmpp:ping","preview","delivery","verified_name","subscribe","01","name","deny","code","paused","last_id","audio","web","te","out","bits","w:profile:picture","ptt","add","mmg.whatsapp.net","te2","relay_id","business","available","fallback","w:stats","401","contacts","sticker","verified_level","key","unknown","url","5","latency","multicast","fail","prop","w:web","mode","profile","error","played","registration","identity","02","100","6","tag","101","103","102","108","query","104","encrypt","109","document","110","106","107","105","111","day_of_week","business_hours_config","stream:error","e","update","03","transport","false","usync","open_time","delete","resume","medium","net","close_time","1235433600","9","serial","w:gp2","catalog_status","specific_hours","rate","opus","sidelist","action","orientation","true","vertical","canonical","none","04","device_orientation","signature","skey","priority","catalog_not_created","order","context","index","mute","token","offer","terminate","version","token_id","encopt","capability","side_list","ver","05","keygen",".","16000","reason","relay","media-bom1-1.cdn.whatsapp.net","state","direct_path","1080","06","media-sin6-1.cdn.whatsapp.net","conflict"];var r=["screen_height","sync","protocol","c","screen_width","a","description","404","media-frx5-1.cdn.whatsapp.net","540","item-not-found","remove","open_24h","07","10","preaccept","invis","not-authorized","refresh","b","media-gig2-1.cdn.whatsapp.net","media-gru1-1.cdn.whatsapp.net","media-maa2-1.cdn.whatsapp.net","default","d","invite","status-revoke-delay","11","8000","features","08","media_type","resume_check","peer_pid","background","attribute_padding","admin","media-mrs2-1.cdn.whatsapp.net","address","delta","voip_settings","readreceipts","disable","09","note.m4r","complete","business_hours","13","media-frt3-1.cdn.whatsapp.net","accept","uncompressed","rte","200","media-del1-1.cdn.whatsapp.net","720","media-mia3-1.cdn.whatsapp.net","transaction-id","dec","android","keys","other","media-xsp1-1.cdn.whatsapp.net","mon","email","uploadfieldstat","wed","tue","thu","15","14","0a","status-old","timezone","16","lg","w:g2","lc","sat","fri","catalog_exists","480","vp8","website","0b","f","media-eze1-1.cdn.whatsapp.net","media-cgk1-1.cdn.whatsapp.net","active","duration","17","media-cdg2-1.cdn.whatsapp.net","reg_push","groups","media-sof1-1.cdn.whatsapp.net","18","0c","tsoffline","voip","background_location","media-qro1-1.cdn.whatsapp.net","19","nse_ver","Opening.m4r","timeout","latitude","0d","media-otp1-1.cdn.whatsapp.net","media-arn2-1.cdn.whatsapp.net","media-cdt1-1.cdn.whatsapp.net","longitude","24","interactive","media-dfw5-1.cdn.whatsapp.net","not-a-biz","category","media-scl1-1.cdn.whatsapp.net","0f","contact_add","media-mxp1-1.cdn.whatsapp.net","media.fnag1-3.fna.whatsapp.net","media-lhr8-1.cdn.whatsapp.net","media.fnag1-1.fna.whatsapp.net","0e","full","media-lht6-1.cdn.whatsapp.net","voip_payload_type","media-atl3-1.cdn.whatsapp.net","sun","256","-","media-for1-1.cdn.whatsapp.net","25","media-bog1-1.cdn.whatsapp.net","media.fnag1-2.fna.whatsapp.net","20","21","passive","fbip","h.264","contact_remove","22","23","vp8/h.264","media-mad1-1.cdn.whatsapp.net","600","media-frt3-2.cdn.whatsapp.net","255","abt","audio_duration","creator","s_t","group","appointment_only","media-kut2-1.cdn.whatsapp.net","forbidden","media-mia3-2.cdn.whatsapp.net","27","010","media.fsub6-4.fna.whatsapp.net","is_biz","media.fsub6-5.fna.whatsapp.net","50","012","media-sin6-2.cdn.whatsapp.net","connected","media.fcgk5-1.fna.whatsapp.net","28","011","media.fsub6-1.fna.whatsapp.net","invalid","1200","media-xsp1-2.cdn.whatsapp.net","mmg-fna.whatsapp.net","403","media.fcgk4-1.fna.whatsapp.net","media.fsub6-2.fna.whatsapp.net","29","s_o","jabber:iq:privacy","media.fmaa1-4.fna.whatsapp.net","30","32","media.fsub6-3.fna.whatsapp.net","-123","media.fcgk8-1.fna.whatsapp.net","media.fcgk8-2.fna.whatsapp.net","video_duration","media-lim1-1.cdn.whatsapp.net","categories","media-gru2-1.cdn.whatsapp.net","media.fsub3-2.fna.whatsapp.net","013","media.fsub3-1.fna.whatsapp.net","media.fcgk9-2.fna.whatsapp.net","1280","media.fcgk3-2.fna.whatsapp.net","reject","2.20.140","media.fjed4-5.fna.whatsapp.net","media.fmaa1-3.fna.whatsapp.net","media.fcgk9-1.fna.whatsapp.net","media-gru2-2.cdn.whatsapp.net","014","33","31","1020","en","media-arn2-2.cdn.whatsapp.net","media-bom1-2.cdn.whatsapp.net","media.fcgk4-4.fna.whatsapp.net","superadmin","media.fsub2-3.fna.whatsapp.net","media.fsub4-1.fna.whatsapp.net","media.fmaa1-1.fna.whatsapp.net","media-hel2-1.cdn.whatsapp.net","media.famd1-1.fna.whatsapp.net","1a","960","media.fevn1-3.fna.whatsapp.net","1140","privacy","media-jnb1-1.cdn.whatsapp.net","media.fcgk4-2.fna.whatsapp.net","media-mrs2-2.cdn.whatsapp.net","user_add","016","media.fdel3-2.fna.whatsapp.net","media.fjed4-6.fna.whatsapp.net","015","media.fjed4-1.fna.whatsapp.net","35","37","media.fevn1-1.fna.whatsapp.net","34","media.famd1-2.fna.whatsapp.net","media.fbho1-2.fna.whatsapp.net","media.fbho1-1.fna.whatsapp.net","1b","1260","...","business_profile","media-dfw5-2.cdn.whatsapp.net","media.fruh4-6.fna.whatsapp.net","rc_dyn","media.fevn1-2.fna.whatsapp.net","w:biz","254","server-error","media.fruh4-2.fna.whatsapp.net","5000","media.ffjr1-3.fna.whatsapp.net","media.fmaa2-1.fna.whatsapp.net","36","..","media.fmaa2-2.fna.whatsapp.net","40"];t.DICTIONARY_0_TOKEN=r;var a=["WhatsApp","prof-services","1c","media.fcgk7-2.fna.whatsapp.net","media.fdel1-2.fna.whatsapp.net","media.fjed4-3.fna.whatsapp.net","018","group_update","media-lax3-1.cdn.whatsapp.net","media.fruh4-3.fna.whatsapp.net","timestamp","38","media.fdel1-4.fna.whatsapp.net","media.fdel3-1.fna.whatsapp.net","not-allowed","017","39","media.ffjr1-2.fna.whatsapp.net","405","media-ams4-1.cdn.whatsapp.net","media.fcgk3-1.fna.whatsapp.net","userrate","maxfpp","battery","1e","media.ffjr1-4.fna.whatsapp.net","from_ip","1320","019","41","1d","locales","media.ffjr1-1.fna.whatsapp.net","encode","420","media-amt2-1.cdn.whatsapp.net","media.fdel1-3.fna.whatsapp.net","media.fsub2-1.fna.whatsapp.net","45","media.fblr4-1.fna.whatsapp.net","01a","options","enable_vid_one_way_codec_nego","253","browser","aud_pkt_reorder_pct","group_info","live","media.fruh4-5.fna.whatsapp.net","55","01b","media.fmaa1-2.fna.whatsapp.net","entertain","tJyEK","to_ip","media-scl2-1.cdn.whatsapp.net","47558758","44","media.fbho4-1.fna.whatsapp.net","use_correct_order_for_hmac_sha1","43","media.fsaw1-5.fna.whatsapp.net","latency_update_threshold","media.fblr4-2.fna.whatsapp.net","media.fbtz1-4.fna.whatsapp.net","01d","mediaretry","os","retail","auto","enabled_for_video_upgrade","lock_video_orientation","iphone","media.fcgk4-3.fna.whatsapp.net","media.fdel1-1.fna.whatsapp.net","media.fsaw1-2.fna.whatsapp.net","42","k","pid","116470092","46","body","init_bwe","u","nack","60180140","config_code","digest","re","media.fcgk7-1.fna.whatsapp.net","media.fgbb2-2.fna.whatsapp.net","media.fjed4-2.fna.whatsapp.net","1920","01c","47","media.fada1-6.fna.whatsapp.net","media.fcgk18-1.fna.whatsapp.net","proto","status-revoke-drop","A","01f","117625616","127030578","49","83503547","020","80","es","media.fgbb2-1.fna.whatsapp.net","media.fudr1-1.fna.whatsapp.net","1f","Windows","01e","48","51","53","config_value","media-fco1-1.cdn.whatsapp.net","media.fblr1-3.fna.whatsapp.net","media.fjai1-1.fna.whatsapp.net","56","media.fbtz1-8.fna.whatsapp.net","media.fsub2-2.fna.whatsapp.net","cond_net_medium","media.fcgh4-1.fna.whatsapp.net","media.fcgk18-2.fna.whatsapp.net","media.fsaw1-6.fna.whatsapp.net","media.fada1-7.fna.whatsapp.net","powersave","url_text","0.17.11","apparel","media.fsaw1-4.fna.whatsapp.net","021","media-waw1-1.cdn.whatsapp.net","127044826","252","660","media-los2-1.cdn.whatsapp.net","251","media.fsaw1-1.fna.whatsapp.net","41529916","58","59","61","enc_rekey","media-lga3-1.cdn.whatsapp.net","media.fhyd11-1.fna.whatsapp.net","media.fjai1-2.fna.whatsapp.net","media.fjed4-4.fna.whatsapp.net","media.fsaw1-10.fna.whatsapp.net","250","65","media.fcgh5-1.fna.whatsapp.net","media.fdmm2-3.fna.whatsapp.net","~","75","media.fbom19-2.fna.whatsapp.net","66","media.fdmm2-2.fna.whatsapp.net","media.fkno4-1.fna.whatsapp.net","026","55914014","media.fbtz1-7.fna.whatsapp.net","media.fsaw1-8.fna.whatsapp.net","minfpp","39637006","media-lax3-2.cdn.whatsapp.net","media.fdmm2-1.fna.whatsapp.net","media.fsaw1-9.fna.whatsapp.net","57","86400","America/Sao_Paulo","media-dus1-1.cdn.whatsapp.net","media-iad3-1.cdn.whatsapp.net","media.fupg1-1.fna.whatsapp.net","780","media.fada1-2.fna.whatsapp.net","locked","media.fpku3-1.fna.whatsapp.net","media.fruh4-1.fna.whatsapp.net","watls_prefer_ip6","29147490","67","94384562","govt","timeoffline","022","52","M","media.faep8-2.fna.whatsapp.net","media.fhex4-2.fna.whatsapp.net","120","64","media.fruh4-4.fna.whatsapp.net","510","media.fblr1-4.fna.whatsapp.net","media.fupg2-1.fna.whatsapp.net","64084020","840","62","frskmsg","2b","54","all","63","media.fada1-1.fna.whatsapp.net","media.fada1-3.fna.whatsapp.net","media.fhex4-1.fna.whatsapp.net","media.fknu1-1.fna.whatsapp.net","media-mba1-1.cdn.whatsapp.net","Asia/Kolkata","media.fada1-5.fna.whatsapp.net","media.fsub1-2.fna.whatsapp.net","023","024","69","media.fada2-1.fna.whatsapp.net","video_max_bitrate","....","1380","246","60","media.fada1-8.fna.whatsapp.net","media.fdmm2-4.fna.whatsapp.net","media.fmct2-3.fna.whatsapp.net","media.fpku2-1.fna.whatsapp.net","watls_enabled","ab_key","beauty","cond_range_rtt","modify","original_image_url","outgoing","request_image_url","025","750","76","87","media.fada2-2.fna.whatsapp.net","media.faep8-1.fna.whatsapp.net","media.fbtz1-9.fna.whatsapp.net","6000","68","68040630","request","media.fagr1-2.fna.whatsapp.net","media.fdel2-1.fna.whatsapp.net","media.faep9-1.fna.whatsapp.net","media.fbtz1-5.fna.whatsapp.net","55663882","58089031","dtx","media.fsdu2-2.fna.whatsapp.net","media-maa2-2.cdn.whatsapp.net","media.fsaw1-7.fna.whatsapp.net"];t.DICTIONARY_1_TOKEN=a;var n=["target_bitrate","02a","240","media.fcgk24-2.fna.whatsapp.net","92540522","Chrome","media.fdel2-2.fna.whatsapp.net","socTy","watls_early_data","248","79","90","Asia/Jakarta","media.faep9-2.fna.whatsapp.net","source","027","249","2a","disable_prewarm","media.fdel11-1.fna.whatsapp.net","media.fesb4-1.fna.whatsapp.net","media.fixc1-3.fna.whatsapp.net","media.fsdu2-1.fna.whatsapp.net","watls_no_dns","media.fbtz1-6.fna.whatsapp.net","02b","71","85458909","cond_range_packet_loss_pct","029","02e","US","media-kut2-2.cdn.whatsapp.net","media.fasr1-1.fna.whatsapp.net","media.fbdo6-2.fna.whatsapp.net","1177879","77","enc_iv","media.fkul6-1.fna.whatsapp.net","74","media.fada1-4.fna.whatsapp.net","media.fbom19-1.fna.whatsapp.net","media.fsti4-1.fna.whatsapp.net","R","S","biz_block_reasons","media-ort2-1.cdn.whatsapp.net","media.fbtz1-3.fna.whatsapp.net","media.fkul6-2.fna.whatsapp.net","begin","media.fadb3-1.fna.whatsapp.net","media.fbom26-1.fna.whatsapp.net","pt","vid_rc_dyn","70","028","1334","85","92","BR","media.fixc1-2.fna.whatsapp.net","236","242","244","78","biz_block_reasons_version","media-hkg4-1.cdn.whatsapp.net","media.fbom3-1.fna.whatsapp.net","media.fbtz1-1.fna.whatsapp.net","media.fbtz1-2.fna.whatsapp.net","media.fslv1-2.fna.whatsapp.net","73","86","max_subject","media.fagr1-1.fna.whatsapp.net","suspicious_links","245","81","groups_privacy_blacklist","media.fesb3-2.fna.whatsapp.net","media.fist2-1.fna.whatsapp.net","media.fpat1-1.fna.whatsapp.net","media.fsaw2-1.fna.whatsapp.net","media.fsub1-1.fna.whatsapp.net","239","432000","84","media.fadb3-2.fna.whatsapp.net","media.fsaw2-2.fna.whatsapp.net","mms_resume_check_chatd","146","72","83","health","media.fbtz1-10.fna.whatsapp.net","media.fgdl5-3.fna.whatsapp.net","02c","98132223","frequently_forwarded_messages","fs_time_spent","media-vie1-1.cdn.whatsapp.net","media.fccu2-1.fna.whatsapp.net","media.fgyd4-1.fna.whatsapp.net","media.ftuc1-1.fna.whatsapp.net","rc","02d","105427442","900","grocery","group_description_length","media.fgdl5-1.fna.whatsapp.net","media.fist6-1.fna.whatsapp.net","status_video_max_duration","video_codec_priority","033","129563314","180","33554500","503","53713952","89","enable_short_offset","image_max_edge","media.fesb4-2.fna.whatsapp.net","mms_vcache_aggregation_enabled","status_image_max_edge","2f","97","max_bytes","media.fist2-2.fna.whatsapp.net","template_hsm","02f","33554490","announcement_groups","change_number_v2","init_bitrate","media.fbom3-2.fna.whatsapp.net","media.fbom4-2.fna.whatsapp.net","media.fesb3-1.fna.whatsapp.net","media.fidr1-2.fna.whatsapp.net","120661159","128000","247","82","95","enc_p","group_invite_sending","max_participants","media.fbog2-2.fna.whatsapp.net","media.fdel25-1.fna.whatsapp.net","mms_media_key_ttl","-128000","243","33554481","369730359717478","94","96","image_max_kbytes","travel","030","117","130","172800","2d","Desktop","TR","finance","media.fcgk24-1.fna.whatsapp.net","media.fkul5-2.fna.whatsapp.net","33554479","95051518","GB","image_quality","media.fasr1-2.fna.whatsapp.net","media.fidr1-1.fna.whatsapp.net","media.fsaw1-3.fna.whatsapp.net","ru","vid_rc","wap4_enabled","123383191","17578881","2e","33554486","fwd_ui_start_ts","media_max_autodownload","mms_async_fast_forward_ttl","mobile_config","1001","112","113","241","33554484","33554485","93","enable_audio_piggyback_feature","gdpr_report","gif_provider","max_keys","media.fbfh1-2.fna.whatsapp.net","media.fbom4-1.fna.whatsapp.net","promote","sticker_notification_preview","voip_incoming_xml_signaling","1024","1050","157","237","33554483","33554498","91","America/Belem","google_backup_api_w_enabled","media.fbog2-1.fna.whatsapp.net","mms_chatd_resume_check_over_thrift","129864860","2.20.123","228","229","234","33554496","88","announcement","audio_piggyback_timeout_msec","cross_post","frequently_forwarded_max","max_tx_rott_based_bitrate","media.fslv1-1.fna.whatsapp.net","multicast_limit_global","product_catalog_open_deeplink","product_catalog_webclient","status_image_quality","stickers","template_doc_mime_types","test_flags","use_downloadable_filters_int","127","235","33554522","39319543","98","98905883","auth_fingerprint_enabled","enable_periodical_aud_rr_processing","group_join_permissions","media.fmed1-2.fna.whatsapp.net","media.fpku1-1.fna.whatsapp.net","media.fpnq1-2.fna.whatsapp.net","media.ftuc1-2.fna.whatsapp.net","mms_hot_content_timespan_in_seconds","third_party_sticker_caching","1110","1344","19575915","27014777","33554497","33554505"];t.DICTIONARY_2_TOKEN=n;var i=["continuous_ptt_playback","high","media.fbdo1-2.fna.whatsapp.net","media.fbfh1-1.fna.whatsapp.net","media.fscl13-2.fna.whatsapp.net","payments_disable_switch_psp","share_biz_vcard_enabled","status_collapse_muted","voip_incoming_xml_ack","117530242","33554493","33554511","33554515","34838051","450","812","bwe","contact_indexing_ui_enabled","file_max_size","media.fbog2-3.fna.whatsapp.net","media.flca1-2.fna.whatsapp.net","media.fotp3-2.fna.whatsapp.net","media.fsti4-2.fna.whatsapp.net","media.ftru2-3.fna.whatsapp.net","video_max_edge","voice_note_locking_enabled","wam_buffer_count","131","133","160","182","238","33554488","33554491","enable_audio_oob_fec_feature","groups_v3","lasso_integration_enabled","media.fpnq1-1.fna.whatsapp.net","mms_cat_v1_forward_hot_override_enabled","optimistic_image_processing_enabled","packless_hsm","payments_request_messages","status_video_max_bitrate","user_remove","usync_sidelist","voice_note_previewing_enabled","220","33554471","33554502","33554507","33554508","Tri-tone.caf","enable_audio_oob_fec_for_sender","heartbeat_interval","image_edit_zoom","instrument_spam_report_enabled","media-hkt1-1.cdn.whatsapp.net","media.fccu11-1.fna.whatsapp.net","media.fhyd1-2.fna.whatsapp.net","media.fotp3-1.fna.whatsapp.net","media.frba2-2.fna.whatsapp.net","search_in_storage_usage","stream_progressive_jpeg_enabled","web_service_delay","199","221","257","33554501","33554520","570","982188032","consumer_content_provider","db_media_migration_step","db_migration_step","fieldstats_beacon_chance","final_live_location","kaios","max_bitrate","media.fdel27-1.fna.whatsapp.net","media.fkul4-2.fna.whatsapp.net","media.flim18-2.fna.whatsapp.net","media.fluh2-1.fna.whatsapp.net","mtu_size","status_ranking_signal_collection",".....","132","134","145","215","33554487","33554503","33554504","33554516","media.fada1-10.fna.whatsapp.net","mms4_direct_path","payments_upi_transaction_limit","receipt_agg","sigquit_anr_detector_release_rollover_percent","use_local_probing_rx_bitrate","115","33554489","33554514","33554524","33554525","52270851","account_transfer_enabled","audio_oob_fec_max_pkts","de","media-sjc3-1.cdn.whatsapp.net","media.fkul2-2.fna.whatsapp.net","off","121","126","129","153","205","512","99","DE","business_product_catalog","consumer_rc_provider","media.fccu13-1.fna.whatsapp.net","media.fcok1-1.fna.whatsapp.net","media.fcor2-2.fna.whatsapp.net","media.fkul5-1.fna.whatsapp.net","media.fmed1-1.fna.whatsapp.net","media.fpku1-2.fna.whatsapp.net","123","144","150","177","179","191","217","230","33554478","33554494","33554506","350000","82095225","call_in_remote","chord.m4r","google_backup_api_enabled","inline_video","media.fctg1-2.fna.whatsapp.net","media.fist7-2.fna.whatsapp.net","media.fkul2-1.fna.whatsapp.net","move_media_folder_from_sister_app","111404497","124","125","128","135","163","168","189","360","RU","media.fhyd6-1.fna.whatsapp.net","media.fist7-1.fna.whatsapp.net","media.fkul3-2.fna.whatsapp.net","p256dh","payments_web_enabled","product","terminated","141","149","155","161","170","185","204","222","223","2c","33554469","33554499","34816","93580432","call_out_remote","cond_range_target_total_bitrate","final","media.fkul4-1.fna.whatsapp.net","media.fscl9-1.fna.whatsapp.net","mms4_media_retry_notification_encryption_enabled","status_v3_text","stickers_keyboard_integration_enabled","thread_dump_contact_support","wam_real_time_enabled","0.17.10","031","122","1531267200","176","212","33554461","33554470","33554492","33554535","3d","Hi","enable_audio_pkt_piggyback_for_sender","enhanced_block_enabled","ignore_muted_in_badge_count","it","media.flim1-1.fna.whatsapp.net","recipient","139","198","2.20.42","33554466","3e","H","group_call_discoverability_enabled","mms4_audio","optimistic_upload","114","118","138","147","1500","156","165","169","172","190","201","210","224","227","232","33554465","33554474","33554526","644728732639272","Mac OS","media.fbdo6-1.fna.whatsapp.net","media.fesb1-1.fna.whatsapp.net","media.fotp3-3.fna.whatsapp.net","media.fres2-1.fna.whatsapp.net","media.fruh2-1.fna.whatsapp.net","profilo_enabled","039","03c","047","137","142","175","187","196","231","33554475","33554518","K","audio_picker","cond_congestion_no_init_rtt_thr"];t.DICTIONARY_3_TOKEN=i;var s=[r,a,n,i];t.DICTIONARIES=s},79223:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Offline=t.Disconnected=void 0;var a=r(29351),n=(0,a.customError)("Disconnected",!1);t.Disconnected=n;var i=(0,a.customError)("Offline",!1,n);t.Offline=i},82368:(e,t,r)=>{"use strict";var a=r(34398);Object.defineProperty(t,"__esModule",{value:!0}),t.FrameSocket=t.SocketClosed=void 0;var n=a(r(4875)),i=r(46378);function s(){var e=(0,n.default)(["FrameSocket: queueing partial frame of "," bytes"]);return s=function(){return e},e}function o(){var e=(0,n.default)(["FrameSocket.onFrame("," bytes)"]);return o=function(){return e},e}function u(){var e=(0,n.default)(["FrameSocket error ",""]);return u=function(){return e},e}function l(){var e=(0,n.default)(["FrameSocket closed"]);return l=function(){return e},e}function d(){var e=(0,n.default)(["FrameSocket closed, waiting for pending processing"]);return d=function(){return e},e}class c extends Error{constructor(e){var t="SocketClosed";super(null!=e?e:t),this.name=t}}t.SocketClosed=c;function f(e){return!(e.size()<3)&&p(e)<=e.size()}function p(e){return e.readUint8()<<16|e.readUint16()}t.FrameSocket=class{constructor(e,t){this._incoming=new i.Binary,this.closed=!1,this._draining=!1,this.onFrame=null,this.onClose=null,this._handleData=e=>{this._incoming.writeByteArray(e),this.convertBufferedToFrames()},this._handleClose=()=>{if(this._incoming.peek(f))return __LOG__(2)(d()),void(this._draining=!0);this._doClose()},this._doClose=()=>{if(!this.closed){__LOG__(2)(l()),this._draining=!1,this.closed=!0;var e=this.onClose;e&&e()}},this._handleError=e=>{__LOG__(4,void 0,new Error)(u(),e)},this._introToSend=t,this._socket=e,e.onData=this._handleData,e.onClose=this._handleClose,e.onError=this._handleError}sendFrame(e){if(!this._draining){this.throwIfClosed();var t=this._introToSend,r=e.byteLength,a=this._socket.dataToSend;t?(this._introToSend=null,a.ensureAdditionalCapacity(t.length+3+r),a.writeByteArray(t)):a.ensureAdditionalCapacity(3+r),a.writeUint8(r>>16),a.writeUint16(65535&r),a.write(e),this._socket.requestSend()}}convertBufferedToFrames(){for(var e=this._incoming,t=this.onFrame;t&&e.peek(f);){var r=p(e);__LOG__(2)(o(),r),t(e.readByteArray(r)),t=this.onFrame}this._draining&&!e.peek(f)&&this._doClose(),t&&e.size()&&__LOG__(2)(s(),e.size())}throwIfClosed(){if(this.closed)throw new c}close(){this._socket.close()}}},32316:(e,t,r)=>{"use strict";var a=r(66390);Object.defineProperty(t,"__esModule",{value:!0}),t.NoiseHandshake=void 0;var n=r(46378),i=a(r(37953)),s=r(79223),o=r(4450),u=r(52137),l=Promise.reject("UNINITIALIZED HANDSHAKE"),d=new Uint8Array(0);l.catch((()=>{}));function c(e){var t=new ArrayBuffer(12);return new DataView(t).setUint32(8,e),new Uint8Array(t)}function f(e,t=["encrypt","decrypt"]){return self.crypto.subtle.importKey("raw",new Uint8Array(e),"AES-GCM",!1,t)}function p(e,t){return i.extract(new Uint8Array(e),t).then((e=>i.expand(new Uint8Array(e),"",64))).then((e=>[e.slice(0,32),e.slice(32)]))}function h(e){e.catch((()=>{}))}t.NoiseHandshake=class{constructor(e){this._hash=l,this._salt=l,this._cryptoKey=l,this._counter=0,this._socket=e,this._rejectOnClose=new u.Resolvable,e.onClose=()=>{this._rejectOnClose.reject(new s.Disconnected("NoiseHandshake: SocketClosed"))},h(this._rejectOnClose.promise)}start(e,t){var r=n.Binary.build(e).readBuffer(),a=32===r.byteLength?Promise.resolve(r):self.crypto.subtle.digest("SHA-256",r);this._hash=a,this._salt=a,this._cryptoKey=a.then(f),this.authenticate(t)}sendAndReceive(e){var t=this._socket,r=new Promise((r=>{t.onFrame=e=>{t.onFrame=null,r(e)},t.sendFrame(e)}));return this._orRejectOnClose(r)}send(e){this._socket.sendFrame(e)}authenticate(e){this._hash=Promise.all([this._hash,e]).then((([e,t])=>{var r=n.Binary.build(e,t).readByteArray();return self.crypto.subtle.digest("SHA-256",r)}))}encrypt(e){var t=this._counter++,r=Promise.all([this._cryptoKey,this._hash,e]).then((([e,r,a])=>function(e,t,r,a){return self.crypto.subtle.encrypt({name:"AES-GCM",iv:c(t),additionalData:r?new Uint8Array(r):d},e,a)}(e,t,r,a)));return this.authenticate(r),this._orRejectOnClose(r)}decrypt(e){var t=this._counter++,r=Promise.all([this._cryptoKey,this._hash]).then((([r,a])=>function(e,t,r,a){return self.crypto.subtle.decrypt({name:"AES-GCM",iv:c(t),additionalData:r?new Uint8Array(r):d},e,a)}(r,t,a,e)));return this.authenticate(e),this._orRejectOnClose(r)}finish(){var e=this._salt.then((e=>p(e,new Uint8Array(0)))).then((([e,t])=>Promise.all([f(e,["encrypt"]),f(t,["decrypt"])]))).then((([e,t])=>new o.NoiseSocket(this._socket,e,t)));return this._orRejectOnClose(e)}mixIntoKey(e){this._counter=0;var t=Promise.all([this._salt,e]).then((([e,t])=>p(e,new Uint8Array(t))));this._salt=t.then((e=>e[0])),this._cryptoKey=t.then((e=>f(e[1]))),h(this._salt),h(this._cryptoKey)}_orRejectOnClose(e){return Promise.race([e,this._rejectOnClose.promise]).then((e=>this._rejectOnClose.resolveWasCalled()?this._rejectOnClose.promise:e))}}},4450:(e,t,r)=>{"use strict";var a=r(34398);Object.defineProperty(t,"__esModule",{value:!0}),t.NoiseSocket=void 0;var n=a(r(4875)),i=r(98970);function s(){var e=(0,n.default)(["NoiseSocket socket closed while encrypting frame"]);return s=function(){return e},e}var o=Promise.reject("UNINITIALIZED HANDSHAKE"),u=new Uint8Array(0);o.catch((()=>{}));function l(e){var t=new ArrayBuffer(12);return new DataView(t).setUint32(8,e),new Uint8Array(t)}t.NoiseSocket=class{constructor(e,t,r){this._incoming=[],this._readQueue=new i.PromiseQueue,this._sendQueue=new i.PromiseQueue,this._readCounter=0,this._writeCounter=0,this._draining=!1,this._sendCiphertextFrame=e=>{this._socket.closed?__LOG__(2)(s()):this._socket.sendFrame(e)},this._handleCiphertext=e=>{var t=this._readCounter++;this._readQueue.enqueueHandlers(function(e,t,r,a){return self.crypto.subtle.decrypt({name:"AES-GCM",iv:l(t),additionalData:r?new Uint8Array(r):u},e,a)}(this._readKey,t,void 0,e),this._handlePlaintext)},this._handleOnClose=()=>{this._draining=!0,this._readQueue.wait().then((()=>{this._draining=!1;var e=this._onClose;e&&e()}))},this._handlePlaintext=e=>{this._onFrame?this._onFrame(e):this._incoming.push(e)},this._socket=e,this._writeKey=t,this._readKey=r,e.onFrame=this._handleCiphertext,this._socket.onClose=this._handleOnClose,e.convertBufferedToFrames()}sendFrame(e){if(!this._draining){this._socket.throwIfClosed();var t,r,a,n,i=this._writeCounter++;this._sendQueue.enqueueHandlers((t=this._writeKey,r=i,a=void 0,n=e,self.crypto.subtle.encrypt({name:"AES-GCM",iv:l(r),additionalData:a?new Uint8Array(a):u},t,n)),this._sendCiphertextFrame)}}setOnFrame(e){this._onFrame=e}setOnClose(e){this._onClose=e}close(){this._socket.close()}}},13267:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.abPropsParser=void 0;var a=new(r(51311).WapParser)("abProps",(e=>{e.assertTag("iq"),e.assertAttr("from","s.whatsapp.net");var t=e.child("props"),r=t.attrInt("protocol");if(1!==r)throw new Error("Unsupported protocol version ".concat(r));var a=[];return t.forEachChildWithTag("prop",(e=>{var t=e.attrInt("config_code"),r=e.attrString("config_value"),n=e.maybeAttrString("config_expo_key");a.push({configCode:t,configValue:r,configExpoKey:n})})),{abKey:t.maybeAttrString("ab_key"),hash:t.maybeAttrString("hash"),refresh:t.maybeAttrInt("refresh"),props:a}}));t.abPropsParser=a},19784:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DynamicRouter=t.NOT_HANDLED=void 0;var r={sentinel:"RESPONSE_NAMESPACE"},a={sentinel:"NOT_HANDLED"};t.NOT_HANDLED=a;function n(e,t){var a=t.namespace;return a===r?i:e.get(a)}function i(e,t,r){r(t)}t.DynamicRouter=class{constructor(){this._basePromise=Promise.resolve(),this._handlers=new Map,this._handlerChangeCount=0,this._firstRoute=null,this._nextRoute=null,this._lastRoute=null,this._run=()=>{var e=this._nextRoute;if(e){for(var t,r=this._handlers;e&&!(t=n(r,e));)this._nextRoute=e=e.nextRoute;if(e&&t){var i=this._runHandler(t,e),s=!0;if(i!==a){var o=e.prevRoute,u=e.nextRoute;this._nextRoute===e&&(this._nextRoute=u),o?o.nextRoute=u:this._firstRoute=u,u?u.prevRoute=o:(s=!1,this._lastRoute=o)}return s&&this._basePromise.then(this._run),i}}}}hasHandlerForNamespace(e){return this._handlers.has(e)}getHandledNamespaces(){return Array.from(this._handlers.keys())}setNamespaceHandler(e,t){var r=this._handlers,a=r.get(e);if(a!==t&&(++this._handlerChangeCount,r.set(e,t),!a)){var n=this._firstRoute;n&&(this._nextRoute||this._basePromise.then(this._run),this._nextRoute=n)}}setHandlers(e,t){this.setNamespaceHandler(e,(function(e,r,a){var n=t[e](r);a&&a(n)}))}fireAndForget(e,t,r){this._schedule(e,t,r,null)}sendAndReceive(e,t,a){return new Promise(((n,i)=>{this._schedule(e,t,a,(e=>{try{var t=function(e){if(null!=e&&("object"==typeof e||"function"==typeof e)){var t=e.then;return"function"==typeof t?t:null}return null}(e);t?t.call(e,(e=>{this._schedule(r,"",e,n)}),(e=>{this._schedule(r,"",e,i)})):this._schedule(r,"",e,n)}catch(e){this._schedule(r,"",e,i)}}))}))}_schedule(e,t,r,a){var i=this._lastRoute,s={namespace:e,route:t,arg:r,resolver:a,prevRoute:i,nextRoute:null};this._lastRoute=s;var o=!0;i?(i.nextRoute=s,o=!this._nextRoute):this._firstRoute=s,o&&n(this._handlers,s)&&(this._nextRoute=s,this._basePromise.then(this._run))}_runHandler(e,t){var{route:r,arg:n,resolver:i}=t,s=this._handlerChangeCount,o=null,u=null;try{o=e(r,n,i)}catch(e){u=Promise.reject(e)}if(o===a){if(s!==this._handlerChangeCount)return a;u=Promise.reject(new Error("DynamicRouter: NOT_HANDLED can only be used when updating handlers"))}if(!i)return u;u&&i(u)}}},37953:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.hmacSha256=function(e,t){return s(e).then((e=>o(e,t)))},t.extract=u,t.expand=l,t.extractAndExpand=function(e,t,r){return u(null,e).then((e=>l(new Uint8Array(e),t,r)))},t.extractWithSaltAndExpand=function(e,t,r,a){return u(t,e).then((e=>l(new Uint8Array(e),r,a)))};var a=r(46378),n=new Uint8Array(32),i={name:"HMAC",hash:"SHA-256"};function s(e){return self.crypto.subtle.importKey("raw",e,i,!1,["sign"])}function o(e,t){return self.crypto.subtle.sign(i,e,t)}function u(e,t){return s(e||n).then((e=>o(e,t)))}function l(e,t,r){if(r<0||r>8160)return Promise.reject(new Error("HKDF::expand given bad length ".concat(r)));for(var n,i=Math.ceil(r/32),u=a.Binary.build(t).readByteArray(),l=new a.Binary,d=s(e).then((e=>(n=e,new Uint8Array(0)))),c=function(e){d=d.then((t=>o(n,a.Binary.build(t,u,e).readByteArray()))).then((e=>{var t=new Uint8Array(e);return l.writeByteArray(t),t}))},f=1;f<=i;f++)c(f);return d.then((()=>l.readBuffer(r)))}},79167:(e,t)=>{"use strict";function r(e,t){if(e.length!==t.length)return!1;for(var r=1,a=e.length,n=0;n<a;n++)r&=e[n]===t[n]?1:0;return 0!==r}Object.defineProperty(t,"__esModule",{value:!0}),t.areBuffersEqual=function(e,t){return r(new Uint8Array(e),new Uint8Array(t))},t.areBytesEqual=r,t.bytesMod=function(e,t){if(t>8388607)throw new Error("Divisor is too big");for(var r=0,a=0;a<e.length;++a)r=((r<<8)+e[a])%t;return r},t.randomNumberLessThan=function(e){if(e!==(0|e))throw new Error("bound must be int32");if(e<=0)throw new Error("bound must not be positive");var t=new Int32Array(1),r=e*Math.floor((-1>>>1)/e),a=-1;for(;-1===a;){self.crypto.getRandomValues(t);var n=t[0]>>>1;n<r&&(a=n%e)}return a}},10014:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.definePersistedJob=function(e){return new i(e,[])},t.JobBuilder=void 0;var a=r(71684),n=r(34712);class i{constructor(e,t){this.type=e,this.steps=t}step(e,t){return this._stepWithOptions(e,"function"==typeof t?{code:t}:t)}_stepWithOptions(e,t){var{stopRetryIf:r,requirements:u,code:l}=t,d=o(u,l);if(r){var{timePassedSeconds:c,appCrashed:f,onStopRetry:p}=r,h=o(null,function(e){return(t,r,a)=>Promise.resolve(e(t,r,a)).then((e=>e instanceof n.InterruptJob?e:new n.InterruptJob(e)))}(p));null!=c&&(d=s(((e,t,{jobStartTime:r})=>(0,a.happenedWithin)(r,c)),d,h)),f&&(d=s(((e,t,{afterCrash:r})=>!r),d,h))}return new i(this.type,[...this.steps,{stepName:e,info:d}])}finalStep(e,t){var r=this.step(e,t),a={name:r.type,steps:r.steps};return{end:()=>a}}}function s(e,t,r){return(a,n,i)=>e(a,n,i)?t(a,n,i):r(a,n,i)}function o(e,t){var r={requirements:e,code:t};return()=>r}t.JobBuilder=i},3016:(e,t,r)=>{"use strict";var a=r(34398);Object.defineProperty(t,"__esModule",{value:!0}),t.joinRequirements=function(e,t){var r=e.filter((e=>!e.isSatisfiable()));if(r.length>0){var a=r.map((e=>e.name));return e=>(null==t||t("unsatisfiable",a,e),r[0].waitUntilSatisfied())}var n=e.map((()=>Promise.resolve())),i=Promise.resolve(),s=null,o=()=>{if(!n.every(((t,r)=>t===e[r].waitUntilSatisfied()))){var t=[],r=e.map((e=>{var r=e.waitUntilSatisfied();return e.isSatisfied()||(t.push(e.name),r.then((()=>{var r=t.indexOf(e.name);t.splice(r,1)}))),r}));return n=r,s=t,Promise.all(r).then(o)}s=null};return e=>{if(null==s){var r=o();null!=r&&(i=i.then((()=>r)))}return null==t||t(null==s?"satisfied":"unsatisfied",s,e),i}},t.UnsatisfiableJobRequirement=t.JobRequirement=void 0;var n=a(r(4875));function i(){var e=(0,n.default)(["JobRequirement[","] blocker errored ",""]);return i=function(){return e},e}class s{constructor(e){this._waitingOn=Promise.resolve(),this._satisfied=!0,this._newBlockers=null,this._blockersFinished=()=>{var e=this._newBlockers;if(null!=e)return this._newBlockers=null,Promise.all(e).then(this._blockersFinished);this._satisfied=!0},this.name=e}addBlocker(e){var t=e.catch((e=>{__LOG__(4,void 0,new Error,!0)(i(),this.name,e),SEND_LOGS("job-blocker-rejected")}));if(this._satisfied)this._satisfied=!1,this._waitingOn=Promise.all([this._waitingOn,t]).then(this._blockersFinished);else{var r=this._newBlockers;null!=r?r.push(t):this._newBlockers=[t]}}waitUntilSatisfied(){return this._waitingOn}isSatisfied(){return this._satisfied}isSatisfiable(){return!0}}t.JobRequirement=s;t.UnsatisfiableJobRequirement=class extends s{constructor(e){super(e),super.addBlocker(new Promise((()=>{})))}addBlocker(){}isSatisfiable(){return!1}}},34712:(e,t,r)=>{"use strict";var a=r(34398);Object.defineProperty(t,"__esModule",{value:!0}),t.startPersistedJobManager=function(e){if(F)return;var t=G?G(e):e,{isRestartAfterCrash:r,accessors:a}=t,n=new Map,i=t.unfinishedJobEntries.then((e=>{var t=[],i=[];return e.forEach((e=>{e.stepHardStartCountAfterTimeout>=5?t.push(e):i.push(e)})),Promise.all(t.map((e=>(__LOG__(4,void 0,new Error,!0)(I(),B(e),e.step),SEND_LOGS("job-stuck-".concat(e.type)),a.deletePersistedJob(e.jobId))))).then((()=>{i.forEach((e=>{n.has(e.jobId)||(__LOG__(2)(M(),B(e)),n.set(e.jobId,j(e,r)))}))}))}));F={implementationLoaders:U||new Map,implementations:new Map,stepBlockers:new WeakMap,accessors:a,activeJobs:n,initialJobsPromise:i,onJobStarted:t.onJobStarted,onJobFinished:t.onJobFinished,deprecatedJobs:t.deprecatedJobs},U=null},t.addPersistedJobImplementation=function(e,t){var r,a;F?(r=F.implementationLoaders,a=F.deprecatedJobs):r=U||(U=new Map);if(r.has(e))return __LOG__(4,void 0,new Error,!0)(w(),e),void SEND_LOGS("repeat-job-loader");a&&a.includes(e);r.set(e,t)},t.loadAndRunJobFromId=function(e){var{activeJobs:t}=q("loadAndRunJobFromId"),r=t.get(e);if(null!=r)return r;var a=function(){return K.apply(this,arguments)}(e);return t.set(e,a),a},t.internalTestingResetSingleton=function(e){F&&(U=F.implementationLoaders);F=null,G=e},t.jestResetJob=function(e){q("jestResetJob").activeJobs.delete(e)},t.FINISHED_JOB=t.UNSTARTED_JOB=t.InterruptJob=t.RetryOnBackoff=t.RequiresPage=void 0;var n=a(r(85374)),i=a(r(4875)),s=r(71684),o=r(26800),u=r(3016);function l(){var e=(0,i.default)(["onJobStarted for "," threw exception ",""]);return l=function(){return e},e}function d(){var e=(0,i.default)([""," failed with error ",""]);return d=function(){return e},e}function c(){var e=(0,i.default)(["onJobFinished for "," threw exception ",""]);return c=function(){return e},e}function f(){var e=(0,i.default)(["",": finished job"]);return f=function(){return e},e}function p(){var e=(0,i.default)(["",": RetryOnBackoff"]);return p=function(){return e},e}function h(){var e=(0,i.default)(["",": requires page"]);return h=function(){return e},e}function _(){var e=(0,i.default)(["",": delaying until ",""]);return _=function(){return e},e}function m(){var e=(0,i.default)(["",": trim wait from "," to ",""]);return m=function(){return e},e}function g(){var e=(0,i.default)(["",": removing completed, expired job from db"]);return g=function(){return e},e}function v(){var e=(0,i.default)(["",": skew detected, adjusting accordingly"]);return v=function(){return e},e}function E(){var e=(0,i.default)(["No implementation for ",".",""]);return E=function(){return e},e}function y(){var e=(0,i.default)(["No implementation for ",". Maybe it should have been put to the deprecated list?"]);return y=function(){return e},e}function S(){var e=(0,i.default)(["No implementation for deprecated ",", job deleted"]);return S=function(){return e},e}function T(){var e=(0,i.default)(["No entry for job ",""]);return T=function(){return e},e}function b(){var e=(0,i.default)([""," waiting on ",""]);return b=function(){return e},e}function A(){var e=(0,i.default)([""," halting because of ",""]);return A=function(){return e},e}function C(){var e=(0,i.default)(["addPersistedJobImplementation called for "," with object for ",""]);return C=function(){return e},e}function P(){var e=(0,i.default)(["",": InterruptJob"]);return P=function(){return e},e}function O(){var e=(0,i.default)(["",": running step"]);return O=function(){return e},e}function w(){var e=(0,i.default)(["addPersistedJobImplementation called twice for ",""]);return w=function(){return e},e}function M(){var e=(0,i.default)(["",": restarting"]);return M=function(){return e},e}function I(){var e=(0,i.default)(["",": stuck on the step ",", aborting the job"]);return I=function(){return e},e}class R{constructor(e){this.feature=e}toString(){return"RequiresPage: ".concat(this.feature)}}t.RequiresPage=R;class D{constructor(e){this.backoffOptions=e}toString(){return"RetryOnBackoff"}}t.RetryOnBackoff=D;class N{constructor(e){this.result=e}}t.InterruptJob=N;var L="$unstarted";t.UNSTARTED_JOB=L;var k="$finished";t.FINISHED_JOB=k;var U,F=null,G=null;function x(e){return new N(e)}function B(e){return"Job[".concat(e.jobId,"] (").concat(e.type,")")}function Y(e){return"Job[".concat(e.jobId,"] (").concat(e.implementation.name,".").concat(e.currentStepName,")")}function K(){return(K=(0,n.default)((function*(e){var t=q("_loadAndRunJobFromId");yield t.initialJobsPromise;var{readPersistedJob:r}=t.accessors,a=yield r(e);return a?j(a,!1):(__LOG__(4,void 0,new Error,!0)(T(),e),SEND_LOGS("missing-job-entry"),null)}))).apply(this,arguments)}function j(){return W.apply(this,arguments)}function W(){return(W=(0,n.default)((function*(e,t){var r,{accessors:a,activeJobs:i,deprecatedJobs:u,onJobFinished:T,onJobStarted:b}=q("runJob"),A=yield H(e.type);if(!A)return u.includes(e.type)?__LOG__(3)(S(),e.type):(__LOG__(4,void 0,new Error,!0)(y(),e.type),SEND_LOGS("missing-job-implementation")),yield a.deletePersistedJob(e.jobId),null;u.includes(e.type);var C=e.step!==L?A.steps.find((t=>t.stepName===e.step)):A.steps[0];if(!C)return __LOG__(4,void 0,new Error,!0)(E(),e.type,e.step),SEND_LOGS("missing-job-step"),yield a.deletePersistedJob(e.jobId),null;var P={jobStartTime:e.startTime,afterCrash:t,interruptJob:x},O={jobId:e.jobId,uniqKey:e.uniqKey,implementation:A,currentStepName:C.stepName,originalArgs:e.original,currentStepArgs:e.current,jobInfo:P,numberOfAttemptsAfterTimeout:e.stepHardStartCountAfterTimeout,stepFirstStartTime:null!==(r=e.stepFirstStartTime)&&void 0!==r?r:(0,s.unixTime)(),backedOffCount:e.backedOffCount||0,waitUntil:e.waitUntil,version:e.version};if(O.currentStepName===k){var w=O.waitUntil,M=(0,s.secondsUntil)(O.stepFirstStartTime);return null!=w&&(0,s.isInFuture)(w)&&M>0&&(__LOG__(2)(v(),B(e)),w=(0,s.castToUnixTime)(w-M),(0,s.isInFuture)(w)&&(O.stepFirstStartTime=(0,s.castToUnixTime)(O.stepFirstStartTime-M),O.waitUntil=w,yield z(O))),null!=w&&(0,s.isInFuture)(w)||(__LOG__(2)(g(),B(e)),yield a.deletePersistedJob(e.jobId),i.delete(e.jobId)),O.currentStepArgs}var I=()=>{var e=O.waitUntil,t=Promise.resolve();if(null!=e){var r=(0,s.futureUnixTime)(s.DAY_SECONDS);e>r?(__LOG__(2)(m(),Y(O),e,r),O.waitUntil=r,t=z(O).then((()=>(0,s.delayUntil)(r)))):(__LOG__(2)(_(),Y(O),e),t=(0,s.delayUntil)(e))}return t.then((()=>V(O,(()=>(O.waitUntil=null,(0,s.happenedWithin)(O.stepFirstStartTime,s.DAY_SECONDS)||O.numberOfAttemptsAfterTimeout++,z(O)))).catch((e=>{if(e instanceof R)return __LOG__(2)(h(),Y(O)),O.numberOfAttemptsAfterTimeout>0&&(--O.numberOfAttemptsAfterTimeout,z(O)),new Promise((()=>{}));if(e instanceof D){__LOG__(2)(p(),Y(O));var t=(0,o.getDelay)(++O.backedOffCount,e.backoffOptions);return O.waitUntil=(0,s.futureUnixTime)(Math.ceil(t/1e3)),O.numberOfAttemptsAfterTimeout>0&&--O.numberOfAttemptsAfterTimeout,z(O).then(I)}throw e}))))},N=I(),U=N.then(function(){var t=(0,n.default)((function*(t){__LOG__(2)(f(),Y(O));var r=null;try{r=T(O.jobId,O.implementation.name,O.originalArgs,t)}catch(t){__LOG__(4,void 0,new Error,!0)(c(),e.type,t),SEND_LOGS("onJobFinished-threw")}null!=r&&r>0?(O.waitUntil=(0,s.futureUnixTime)(Math.ceil(r/1e3)),O.currentStepName=k,O.currentStepArgs=t,O.stepFirstStartTime=(0,s.unixTime)(),yield z(O)):(yield a.deletePersistedJob(e.jobId),i.delete(e.jobId))}));return function(){return t.apply(this,arguments)}}(),function(){var t=(0,n.default)((function*(t){__LOG__(4,void 0,new Error,!0)(d(),e.type,t),SEND_LOGS("job-threw-exception-".concat(e.type)),yield a.deletePersistedJob(e.jobId),i.delete(e.jobId)}));return function(){return t.apply(this,arguments)}}());try{b(e.jobId,e.type,e.original)}catch(t){__LOG__(4,void 0,new Error,!0)(l(),e.type,t),SEND_LOGS("onJobStarted-threw")}return U.then((()=>N))}))).apply(this,arguments)}function V(e,t){var{currentStepName:r,implementation:{steps:a}}=e,n=a.findIndex((e=>e.stepName===r)),{requirements:i,code:o}=a[n].info(e.currentStepArgs,e.originalArgs,e.jobInfo),l=function(e,t){if(null==t||0===t.length)return Promise.resolve();var{stepBlockers:r}=q("waitForBlockers"),a=r.get(t);null==a&&(a=(0,u.joinRequirements)(t.map((e=>e())),J),r.set(t,a));return a(e)}(e,i);return t&&(l=l.then(t)),l.then((()=>(__LOG__(2)(O(),Y(e)),o(e.currentStepArgs,e.originalArgs,e.jobInfo)))).then((t=>{if(t instanceof N)return __LOG__(2)(P(),Y(e)),t.result;var r=n+1;if(r>=a.length)return t;var i=a[r];return e.currentStepName=i.stepName,e.currentStepArgs=t,e.numberOfAttemptsAfterTimeout=0,e.stepFirstStartTime=(0,s.unixTime)(),e.waitUntil=null,e.backedOffCount=0,z(e).then((()=>V(e)))}))}function H(e){var t=q("getJobImplementation"),{implementations:r,implementationLoaders:a}=t,n=r.get(e);if(n)return n;var i=a.get(e);if(!i)return null;var s=i().then((t=>t.name!==e?(__LOG__(4,void 0,new Error,!0)(C(),e,t.name),SEND_LOGS("different-job-loader"),null):t));return r.set(e,s),s}function q(e){if(F)return F;throw new Error("Jobs::".concat(e," called before startManagingJobs"))}function z(e){return q("updateEntryForJob").accessors.updatePersistedJob({jobId:e.jobId,type:e.implementation.name,uniqKey:e.uniqKey,step:e.currentStepName,original:e.originalArgs,current:e.currentStepArgs,startTime:e.jobInfo.jobStartTime,stepHardStartCountAfterTimeout:e.numberOfAttemptsAfterTimeout,stepFirstStartTime:e.stepFirstStartTime,waitUntil:e.waitUntil,backedOffCount:e.backedOffCount,version:e.version,endTime:e.currentStepName===k?e.stepFirstStartTime:void 0})}function J(e,t,r){"unsatisfiable"===e?__LOG__(2)(A(),Y(r),t):"unsatisfied"===e&&__LOG__(2)(b(),Y(r),t)}},98970:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PromiseQueueMap=t.PromiseQueue=void 0;t.PromiseQueue=class{constructor(e=-1){this._promise=Promise.resolve(),this._maxDelay=e}wait(){return this._promise}enqueueHandlers(e,t,a){var n=this._promise.then((()=>e)).then(t,a),i=n.then();return this._promise=r(n,this._maxDelay),i}enqueue(e){var t=this._promise.then(e),a=t.then();return this._promise=r(t,this._maxDelay),a}};function r(e,t){return t>=0?new Promise((r=>{var a=()=>{r()};e.then(a,a),setTimeout(a,t)})):e.then(a,a)}function a(){}t.PromiseQueueMap=class{constructor(e=-1){this._map=new Map,this._maxDelay=e}waitIfPending(e){return this._map.get(e)}wait(e){return this._map.get(e)||Promise.resolve()}enqueueHandlers(e,t,r,a){var n=this.wait(e).then((()=>t)).then(r,a);return this._addToMap(e,n)}enqueue(e,t){var r=this.wait(e).then(t);return this._addToMap(e,r)}_addToMap(e,t){var a,n=t.then(),i=()=>{this._map.get(e)===a&&this._map.delete(e)};return a=r(t,this._maxDelay).then(i,i),this._map.set(e,a),n}}},56656:(e,t,r)=>{"use strict";var a=r(34398);Object.defineProperty(t,"__esModule",{value:!0}),t.PromiseRetryLoop=void 0;var n=a(r(4875)),i=r(52137),s=r(26800),o=r(91460);function u(){var e=(0,n.default)(["PromiseRetryLoop: retrying "," in ","ms"]);return u=function(){return e},e}function l(){var e=(0,n.default)(["PromiseRetryLoop: resetting ",""]);return l=function(){return e},e}function d(){var e=(0,n.default)(["PromiseRetryLoop was called several times. You may have race conditions"]);return d=function(){return e},e}function c(){var e=(0,n.default)(["PromiseRetryLoop: starting ",""]);return c=function(){return e},e}function f(){var e=(0,n.default)(["PromiseRetryLoop: resetting ",""]);return f=function(){return e},e}t.PromiseRetryLoop=class{constructor(e){this._resolvable=new i.Resolvable,this._promise=null,this._resetTime=null,this.endWithValue=e=>{this._currentLoop.resolve(),this._resolvable.resolve(e)},this._options=e}resetTimeoutAfter(e){this._resetTime=Date.now()+e}cancelReset(){this._resetTime=null}reset(){this._resolvable.resolveWasCalled()||(__LOG__(2)(f(),this._options.name),this._currentLoop.resolve(),this._currentLoop=new i.Resolvable,this._runLoop())}start(){this._resolvable.resolveWasCalled()||(__LOG__(2)(c(),this._options.name),null!=this._currentLoop&&__LOG__(4,void 0,new Error)(d()),this._currentLoop=new i.Resolvable,this._runLoop())}_runLoop(){var e=this._options,t=this._currentLoop,r=(0,s.createTimer)(this._options.timer);r();var a=()=>{if(!this._resolvable.resolveWasCalled()&&!t.resolveWasCalled()){var n=Date.now();this._promise=(0,e.code)(this.endWithValue).then((()=>{if(!this._resolvable.resolveWasCalled()){var{resetDelay:t}=e;(void 0!==t&&Date.now()>=n+t||null!=this._resetTime&&this._resetTime<=Date.now())&&(__LOG__(2)(l(),e.name),r=(0,s.createTimer)(this._options.timer)),this._resetTime=null;var i=r();return __LOG__(2)(u(),e.name,i),(0,o.delayMs)(i).then(a)}}))}};this._promise=Promise.resolve().then(a)}promise(){return this._promise?Promise.race([this._resolvable.promise,this._promise.then((()=>this._resolvable.promise))]):Promise.reject(new Error("PromiseRetryLoop ".concat(this._options.name," had promise() called before start()")))}}},52137:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Resolvable=void 0;t.Resolvable=class{constructor(){var e;this._isResolved=!1,this.promise=new Promise((t=>{e=t})),this._resolve=e}resolve(e){this._isResolved=!0,this._resolve(e)}reject(e){this.resolve(Promise.reject(e))}resolveWasCalled(){return this._isResolved}}},41449:(e,t)=>{"use strict";t.Z=v;var r,a="undefined"!=typeof Promise?Promise:null,n=0,i=[],s=[],o=[],u={sentinel:"CONTINUE_AS_IF_NO_HANDLER"},l={sentinel:"RETRY_ASYNCHRONOUSLY"},d={sentinel:"TO_STRING"},c={sentinel:"DID_ERROR"},f=null,p=[],h=16,_=64,m=128,g=512;function v(e,t){this._flags=0,this._value=void 0,this._onFulfilled=void 0,this._onRejected=void 0,this._context=void 0,this._resolveLevel=0,this._control=void 0,this.x=void 0,this._thenableParent=null,this._parent=void 0,this._child=void 0,this._children=void 0,this.control=void 0,t&&(this._context=t.this),"function"==typeof e&&(this._onFulfilled=e,this._flags|=4,this._flags|=256,H(e,this._context,(e=>F(this,0,!0,!1,e)),(e=>F(this,0,!1,!1,e))))}function E(e){if(void 0===e)return r;if(k(e))return e;var t=new v;return F(t,0,!0,!1,e),J(t,g),t}function y(e){var t=new v;return t._value=e,J(t,514),p.push(t),t}function S(e){var t=arguments.length-1;if(0===t)return this.then(void 0,e);for(var r=new Array(t),a=0;a<t;a++)r[a]=B(arguments[a]);var n=Y(r,arguments[t]),i=U(this,void 0,n);return i._onRejected&&J(i,m),i}function T(e,t){this.errors=e||[],this.message=t||"".concat(this.errors.length," errors")}function b(e){var t="";if(e._flags&m)t=(e._onFulfilled||e._onRejected).call(e._context,d);else if(e._control)t=".addRawControl(".concat(e._control.name,", ").concat(e._control.foo,")");else if(e._flags&h)t=".endWithControls(".concat(Object.keys(e.control),")");else if(e._flags&g)t=1&e._flags?"Promise.resolve(".concat(void 0===e._value?"":e._value,")"):"Promise.reject(".concat(void 0===e._value?"":e._value,")");else if(256&e._flags)switch(3&e._flags){case 2:case 0:case 1:t="new Promise(".concat(e._onFulfilled,")")}else e._onFulfilled&&e._onRejected?t=".then(".concat(e._onFulfilled,", ").concat(e._onRejected,")"):e._onFulfilled?t=".then(".concat(e._onFulfilled,")"):e._onRejected&&(t=".catch(".concat(e._onRejected,")"));return t}function A(e){this.message=e||"StackPromise timed out"}function C(e,t,r,a){this.name=e,this.foo=t,this.lightning=!!r,this.canRunMultipleTimes=!!a}function P(e,t){return function(){for(var r,a,n=e._parent;n&&!(3&n._flags)&&!(n._flags&h);n=n._parent)!n._control||n._control.name!==t||4&n._flags||(r=n);if(!r)return v.NO_ACTIVE_CONTROL;if(r._control.canRunMultipleTimes||J(r,4),arguments.length>0){a=new Array(arguments.length);for(var i=0;i<arguments.length;i++)a[i]=arguments[i]}return r._control.foo.call(r._context,(e=>G(r,r._resolveLevel,!0,!1,e)),(e=>G(r,r._resolveLevel,!1,!1,e)),r._parent,a)}}function O(e){this.message=e,this.stack=new Error(e||this.name).stack}v.resolve=E,v.reject=y,v.prototype.then=function(e,t){"function"!=typeof e&&(e=void 0),"function"!=typeof t&&(t=void 0);var r=new v;r._onFulfilled=e,r._onRejected=t,r._context=this._context,this._flags&_&&J(r,_);var a=3&this._flags;return 0===a?D(this,r):(J(this,8),(1===a?e:t)?(r._parent=this,s.push(r),I()):(r._parent=this,J(r,a),r._value=this._value,2===a&&p.push(r))),r},v.prototype.catch=S,v.prototype.catchType=S,v.prototype.catchTypes=S,v.prototype.catchTypes3=S,v.prototype.catchEqualTo=S,v.prototype.catchConditional=S,v.prototype.end=function(e){var t=this.then();if(J(t,h),t.control={},t._context=void 0,e){var r=e.controls;if(r)for(var a=0;a<r.length;a++){var n=r[a];t.control[n]=P(t,n)}return t}},v.prototype.endWithControls=function(){var e=this.then();J(e,h),e.control={},e._context=void 0;for(var t=0;t<arguments.length;t++){var r=arguments[t];e.control[r]=P(e,r)}return e},v.all=function(e){return new v((function(t,r){var a=e.length;if(0!==a)for(var n=new Array(e.length),i=0;i<e.length;i++)n[i]=U(e[i],s,r);else t([]);function s(e){if(0==--a){for(var r=[],i=0;i<n.length;i++){var s=n[i];r.push(s&&3&s._flags?s._value:e)}t(r)}return e}}))},v.allSettled=function(e){return new v((function(t){var r=Array.from(e),a=r.length;if(0!==a)for(var n=new Array(r.length),i=u(!1),s=u(!0),o=0;o<r.length;o++)n[o]=U(r[o],i,s);else t([]);function u(e){return function(r){var i=e?{status:"rejected",reason:r}:{status:"fulfilled",value:r};if(0==--a){for(var s=[],o=0;o<n.length;o++){var u=n[o];s.push(u&&3&u._flags?u._value:i)}t(s)}return i}}}))},v.any=function(e){return new v((function(t,r){var a=e.length;0===a&&r(new T([],"StackPromise.any called with []"));var n=new Array(e.length);function i(e){if(0==--a){for(var t=[],i=0;i<n.length;i++){var s=n[i];t.push(s&&3&s._flags?s._value:e)}r(new T(t))}return e}for(var s=0;s<e.length;s++)n[s]=U(e[s],t,i)}))},v.reduce=function(e,t,r){return E(e).reduce(t,r)},v.prototype.reduce=function(e,t){return t=L(t),U(this,(function(r,a){if(0===r.length)return t;if(a)return l;for(var n=new Array(r.length),i=0;i<r.length;i++){var s=n[i]=L(r[i]);k(s)&&J(s,8)}var o=this,u=0;return function r(){for(var a=n.length;;){var i=u,s=n[i];if(k(s))switch(3&s._flags){case 2:return s;case 0:return s.then(r);case 1:s=s._value}if(k(t))switch(3&t._flags){case 2:return t;case 0:return t.then(r);case 1:t=t._value}var l=e.call(o,t,s,i,a);if(++u===a)return l;if(k(l=L(l)))switch(3&l._flags){case 2:return l;case 0:return t=l,l.then(r);case 1:J(l,8),t=l._value}else t=l}}()}))},v.race=function(e){var t=L(e);if(k(t)){var r=t.then((e=>v.race(e)));return r._context=void 0,r._flags&=-65,r}return new v((function(e,r){for(var a=0;a<t.length;a++){var n=L(t[a]);if(!k(n)||3&n._flags)for(e(n),a++;a<t.length;a++){var i=t[a];k(i)&&J(i,8)}else n.then(e,r)}}))},T.prototype=Object.create(Error.prototype,{name:{value:"AggregateError"}}),v.AggregateError=T,v.onPossiblyUnhandledRejection=function(e,t){console.error("StackPromise did not catch ".concat(e),t,e)},v.prototype.toString=function(){for(var e,t=[],r=this,a=!1;r;r=r._parent){e=r,!a&&3&r._flags&&(a=!0,r._flags&g||(1&r._flags?t.push("[resolved value: ".concat(r._value,"]")):t.push("[rejected reason: ".concat(r._value,"]"))));var n=b(r);1024&r._flags&&(n="~".concat(n)),t.push(n)}return t.reverse(),768&e._flags||(t[0]="[Promise]".concat(t[0])),t.join("\n")},v.prototype.timeout=function(e,t){if(0!=(3&this._flags))return this.then();var r;function a(a){return a===d?".timeout(".concat(e,", ").concat(t,")"):(clearTimeout(r),u)}var n=this.then(a,a);return J(n,160),r=setTimeout((function(e,t){3&e._flags||G(e,0,!1,!1,t instanceof Error?t:new A(t))}),e,n,t),n},A.prototype=Object.create(Error.prototype,{name:{value:"TimeoutError"}}),v.TimeoutError=A,v.prototype.isFulfilled=function(){return!!(1&this._flags)},v.prototype.isRejected=function(){return!!(2&this._flags)},v.prototype.isPending=function(){return!(3&this._flags)},v.prototype.value=function(){if(1&this._flags)return this._value;throw new Error(2&this._flags?"value() called on StackPromise that was rejected":"value() called on StackPromise that is pending")},v.prototype.reason=function(){if(2&this._flags)return this._value;throw new Error(1&this._flags?"reason() called on StackPromise that was fulfilled, not rejected":"reason() called on StackPromise that is pending")},v.loop=function(e,t){return E(t).loop(e)},v.prototype.loop=function(e){var t=U(this.then((function(r){var a=this,n=0,i=e=>G(t,0,!0,!1,e);return function r(s){return new v((function(t){t(e.call(a,i,s,n++))})).then((function(e){if(!(3&t._flags))return r(e)}))}(r)})),(function(t){return t===d?".loop(".concat(e,")"):u}));return J(t,m),t},v.prototype.checkpoint=function(e){function t(t){return t===d?".checkpoint(".concat(e,")"):2&e._flags?e:u}e=E(e);var r=this.then(t,t);return J(r,m),r},v.prototype.finally=function(e){function t(t){return t===d?".finally(".concat(e,")"):(e.call(this,t),u)}return J(this.then(t,t),m)},v.prototype.get=function(e){var t=this.then((function(t){return t===d?".get('".concat(e,"')"):t[e]}));return J(t,m),t},v.prototype.tap=function(e){return J("function"!=typeof e?this.then(R):this.then((function(t){return t===d?".tap(".concat(e,")"):(e.call(this,t),u)})),m)},v.prototype.spread=function(e){var t=this.then((function(t){return t===d?".spread(".concat(e,")"):e.apply(this,t)}));return J(t,m),t},v.prototype.throw=function(e){return this.then((()=>y(e)))},v.Control=C,v.NO_ACTIVE_CONTROL=new Error("No active control was found."),v.prototype.addControl=function(e){if(!(e instanceof C))throw new Error("addControl must be given Control, but got ".concat(e));var t=this.then(e.lightning?void 0:R);return t._control=e,t},v.prototype.addRawControl=function(e,t,r,a){return this.addControl(new C(e,t,r,a))},v.prototype.addResolveControl=function(e,t,r,a){return this.addControl(new C(e,(function(e,r,a,n){try{e(t.apply(this,n))}catch(e){r(e)}}),r,a))},v.prototype.addRejectControl=function(e,t,r,a){return this.addControl(new C(e,(function(e,r,a,n){try{r(t.apply(this,n))}catch(e){r(e)}}),r,a))},O.prototype=Object.create(Error.prototype,{name:{value:"CancellationError"}}),v.CancellationError=O;var w,M=new C("cancel",(function(e,t,r,a){t(new O(a&&a[0]))}),!1,!1);function I(){var e,t;0===n&&(s.length||p.length)&&(n=1,w||(t=0,w="undefined"==typeof MutationObserver||self&&self.navigator&&self.navigator.standalone?a?function(){a.resolve().then(V)}:"function"==typeof setImmediate?function(){setImmediate(V)}:function(){setTimeout(V,0)}:(e=document.createTextNode(""),new MutationObserver(V).observe(e,{characterData:!0}),function(){e.data=t=1-t})),w())}function R(e){return e===d?".tap()":u}function D(e,t){J(e,8),t._parent=e,e._children?e._children.push(t):e._child?(e._children=[e._child,t],e._child=void 0):e._child=t}function N(e){if(e&&("object"==typeof e||"function"==typeof e)){var t;try{t=e.then}catch(e){return f=e,c}if("function"==typeof t)return t}}function L(e){if(!e||k(e))return e;var t=N(e);if(t===c)return y(f);if(t){var r=new v((function(r,a){t.call(e,r,a)}));return r._thenableParent=e,r}return e}function k(e){return e instanceof v}function U(e,t,r){var a,n,i,s,o=k(e=L(e)),d=!1;if(o){if(!(3&e._flags))return J(e.then(t,r),32);J(e,8),d=!!(e._flags&_),i=e._context,a=1&e._flags?t:r,n=e._value}else a=t,n=e;if(!a)return E(e).then();if((n=z(a,i,n,!0))===c)s=y(f);else{if(n===l)return E(e).then(t,r);if(n===u)return o?e.then():E(e);s=E(n)}return d&&(s=s.cancellable()),void 0!==i&&((s=s.then())._context=i),s}function F(e,t,r,a,n){if(t===e._resolveLevel){var i=++e._resolveLevel;if(J(e,4),e._thenableParent=null,r)if(n===e)e._parent=void 0,K(e,!1,a,new TypeError("promise resolved to itself"));else if(k(n)){var s=3&n._flags;0===s?D(n,e):(e._parent=n,J(e,1024),J(n,8),K(e,1===s,a,n._value))}else{var o=N(n);o===c?(e._parent=void 0,K(e,!1,a,f)):o?(e._parent=void 0,e._thenableParent=n,H(o,n,(t=>F(e,i,!0,!1,t)),(t=>F(e,i,!1,!1,t)))):K(e,!0,a,n)}else K(e,!1,a,n)}}function G(e,t,r,a,n){t===e._resolveLevel&&(x(e),F(e,t,r,a,n))}function x(e){if(e._parent){var t=e._parent;if(e._parent=void 0,t._child===e)t._child=void 0;else if(t._children){for(var r=t._children,a=0;a<r.length;a++)if(r[a]===e){r.splice(a,1);break}0===r.length&&(t._children=void 0)}}}function B(e){if(null==e)throw new Error("Invalid .catch guard ".concat(e));if("function"==typeof e)return e;if("object"==typeof e)throw new Error("Object guards in .catch are currently unsupported");return function(t){return t===e}}function Y(e,t){return function(r,a){return r===d?".catch(..., ".concat(t,")"):e&&!function(e,t){for(var r=0;r<e.length;r++){var a=e[r];if(a===Error||a.prototype instanceof Error){if(t instanceof a)return!0}else if(a(t))return!0}return!1}(e,r)?u:a?l:t.call(this,r)}}function K(e,t,r,a){if(J(e,4|(t?1:2)),e._value=a,e._child)j(e._child,t,r,a),e._child=void 0;else if(e._children){var n=e._children;e._children=void 0;for(var i=0;i<n.length;i++)j(n[i],t,r,a)}else t||8&e._flags||p.push(e)}function j(e,t,r,a){e._resolveLevel++;var n=q(e,t);if(n&&32&e._flags){J(e,4);var i=z(n,e._context,a,!0);if(i!==l)return void(i===c?(e._parent=void 0,K(e,!1,r,f)):i===u?K(e,t,r,a):(e._parent=void 0,F(e,e._resolveLevel,!0,r,i)));e._flags&=-5}n?((r?o:s).push(e),I()):K(e,t,r,a)}function W(e,t){for(;0!==e.length;)t.push(e.pop())}function V(){for(;0!==i.length||0!==s.length;){0===i.length&&W(s,i);var e=i.pop(),t=e._parent,r=!!(t&&1&t._flags),a=t&&t._value,d=q(e,r);if(J(e,4),d){var h=void 0;do{h=z(d,e._context,a,!1)}while(h===l);h===c?(a=f,r=!1,e._parent=void 0):h!==u&&(a=h,r=!0,e._parent=void 0)}3&e._flags||(F(e,e._resolveLevel,r,!0,a),W(o,i))}for(n--;0!==p.length;){var _=p.pop();8&_._flags||v.onPossiblyUnhandledRejection(_._value,_)}}function H(e,t,r,a){try{e.call(t,r,a)}catch(e){a(e)}}function q(e,t){if(!(4&e._flags))return t?e._onFulfilled:e._onRejected}function z(e,t,r,a){try{return a?e.call(t,r,!0):e.call(t,r)}catch(e){return f=e,c}}function J(e,t){return e._flags|=t,e}v.prototype.addCancelControl=function(){return J(this.addControl(M),_)},v.sit=function(e,t){var r=new v;return r._control=new C(e,(function(e,r,a,n){e(t?t.apply(void 0,n):n&&n[0])})),r},v.prototype.cancellable=function(){return J(this.then(),_)},v.prototype.uncancellable=function(){var e=this.then();return e._flags&=-65,e},v.prototype.cancel=function(e){for(var t,r=this;r&&!(3&r._flags);r=r._parent)r._flags&_&&(t=r);if(t)if(void 0===e&&(e=new O),q(t,!1)){var a=new v;x(t),D(a,t),G(a,0,!1,!1,e)}else G(t,t._resolveLevel,!1,!1,e)},F(r=new v,0,!0,!1,void 0)},26800:(e,t)=>{"use strict";function r(e){var{relativeDelay:t=!1}=e,r=null,i=n(e.algo);return function(){if(null==r)return r=t?Date.now():0,0;var n=a(e,i());if(t){var s=Date.now(),o=s-r;o>0&&(n=Math.max(0,n-o)),r=s}return n}}function a({max:e,min:t,jitter:r=.1},a){var n=a;return null!=e&&n>e&&(n=e),null!=t&&n<t&&(n=t),0!==r&&(n=Math.ceil(n*(1+r*Math.random()))),n}function n(e){switch(e.type){case"fibonacci":return function(e){var t=e.second-e.first,r=e.first-t;return function(){var e=t+r;return r=t,t=e,e}}(e);case"exponential":return function(e){var{base:t=2}=e,r=e.first;return function(){var e=r;return r*=t,e}}(e);case"constant":return function(e){var t=e.delay;return function(){return t}}(e);case"adjust":return function(e){var{toMs:t,backoff:r}=e,a=n(r);return function(){return t(a())}}(e);default:throw new Error("makeTimeFunc unrecognized backoff ".concat(e.type))}}Object.defineProperty(t,"__esModule",{value:!0}),t.getDelay=function(e,t){if(0===e)return 0;for(var r=n(t.algo),i=1;i<e;i++)r();return a(t,r())},t.createTimer=r,t.createPromiseTimer=function(e){var t=r(e);return function(e){return new Promise((r=>{var a=t();a>0?setTimeout(r,a,e):r(e)}))}}},73559:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.callSyncPromise=function(e,t,...r){try{return Promise.resolve(e.apply(t,r))}catch(e){return Promise.reject(e)}}},91460:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.delayMs=function(e,t){return new Promise((r=>{setTimeout(r,e,t)}))},t.withTimeout=function(e,t,r){return new Promise(((a,n)=>{var i=setTimeout((()=>{try{a(r())}catch(e){n(e)}}),t);e.then((e=>{clearTimeout(i),a(e)}),(e=>{clearTimeout(i),n(e)}))}))}},5497:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.promiseProps=function(e){var t=Object.keys(e);return Promise.all(t.map((t=>e[t]))).then((function(e){for(var r={},a=0;a<e.length;a++)r[t[a]]=e[a];return r}))}},78692:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.wrapSyncPromise=function(e){return function(){try{return Promise.resolve(e.apply(this,arguments))}catch(e){return Promise.reject(e)}}}},80802:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.compileSpec=function(e){if(e.internalCompiledSpec)return e.internalCompiledSpec;var t=e.internalSpec;if(!t)throw new Error("Message Class ".concat(String(e)," does not have internalSpec"));var r=e.internalDefaults||{},s=Object.keys(t).filter((e=>e!==a.KEYS.ONEOF)),o=new Array(s.length),u=[],l=[],d=new Array(s.length),c=t[a.KEYS.ONEOF]||{};s.sort(((e,r)=>{var a=i(t,e),n=i(t,r);return a[0]-n[0]}));for(var f=0;f<s.length;f++){var p=s[f],h=i(t,p);d[f]=r[p];var _=h[1],m=h[0];if(u.push(m),l.push(_),(_&a.TYPE_MASK)===a.TYPES.MESSAGE)o[f]=h[2];else if((_&a.TYPE_MASK)===a.TYPES.ENUM){var g=h[2];if("function"==typeof g.cast)o[f]=g;else{var v=!0,E=0;for(var y in g)v&&y!==E++&&(v=!1);var S=void 0;if(v){S=[];for(var T=0;T<E;T++)S.push(!0)}else for(var b in S={},g)S[g[b]]=!0;o[f]=S}}else o[f]=null}var A={},C=function(e){c[e].forEach((t=>{A[t]||(A[t]=[]),A[t].push(e)}))};for(var P in c)C(P);var O=t[a.KEYS.RESERVED]&&t[a.KEYS.RESERVED][a.KEYS.RESERVED_TAGS],w=t[a.KEYS.RESERVED]&&t[a.KEYS.RESERVED][a.KEYS.RESERVED_FIELDS],M=new n(s,u,l,d,o,c,A,O,w);return e.internalCompiledSpec=M,M},t.Spec=void 0;var a=r(45261);class n{constructor(e,t,r,a,n,i,s,o,u){this.names=e,this.fields=t,this.types=r,this.defaults=a,this.meta=n,this.oneofToFields=i,this.fieldToOneof=s,this.reservedTags=o?o.reduce(((e,t)=>(e[t]=!0,e)),{}):{},this.reservedFields=u?u.reduce(((e,t)=>(e[t]=!0,e)),{}):{}}}function i(e,t){var r=e[t];if(null==r)throw new Error("fieldData of ".concat(t," is missing"));return r}t.Spec=n},45261:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.KEYS=t.ENC=t.TYPES=t.TYPE_MASK=t.FLAGS=void 0;t.FLAGS={REPEATED:64,PACKED:128,REQUIRED:256};t.TYPE_MASK=31;t.TYPES={INT32:1,INT64:2,UINT32:3,UINT64:4,SINT32:5,SINT64:6,BOOL:7,ENUM:8,FIXED64:9,SFIXED64:10,DOUBLE:11,STRING:12,BYTES:13,MESSAGE:14,FIXED32:15,SFIXED32:16,FLOAT:17};t.ENC={VARINT:0,BIT64:1,BINARY:2,BIT32:5};t.KEYS={ONEOF:"__oneofs__",RESERVED:"__reserved__",RESERVED_TAGS:"tags",RESERVED_FIELDS:"fields"}},84139:(e,t,r)=>{"use strict";var a=r(34398);Object.defineProperty(t,"__esModule",{value:!0}),t.decodeProto=function(e,t){var r=new i.Binary(t),a=g(e,r,void 0,!1);return(0,l.checkRequirements)(e,a),a},t.decodeProtoWithUnknowns=function(e,t){var r=new i.Binary(t),a=g(e,r,void 0,!0);return(0,l.checkRequirements)(e,a),a},t.getUnknownFields=function(e){return Object.prototype.hasOwnProperty.call(e,"unsafeUnknownFields")?e.unsafeUnknownFields:null};var n=a(r(98029)),i=r(46378),s=r(80802),o=r(45261),u=r(54219),l=r(26032),d=r(8320);function c(e,t,r){if(e!==(0,u.typeToEncType)(t))throw new Error("FormatError: ".concat(r," encoded with wire type ").concat(e))}function f(e,t,r){switch(t){case o.TYPES.INT32:return p(r,-2147483648,2147483648,e,i.parseInt64OrThrow);case o.TYPES.INT64:return r.readVarInt(h);case o.TYPES.UINT32:return p(r,0,4294967296,e,i.parseUint64OrThrow);case o.TYPES.UINT64:return r.readVarInt(_);case o.TYPES.SINT32:var a=p(r,0,4294967296,e,i.parseInt64OrThrow);return 1&a?~(a>>>1):a>>>1;case o.TYPES.SINT64:return r.readVarInt(m);case o.TYPES.BOOL:return!!p(r,0,2,e,i.parseUint64OrThrow);case o.TYPES.ENUM:return r.readVarInt(i.parseInt64OrThrow);case o.TYPES.FIXED64:return r.readLong(_,!0);case o.TYPES.SFIXED64:return r.readLong(h,!0);case o.TYPES.DOUBLE:return r.readFloat64(!0);case o.TYPES.STRING:return r.readString(r.readVarInt(i.parseUint64OrThrow));case o.TYPES.BYTES:return r.readBuffer(r.readVarInt(i.parseUint64OrThrow));case o.TYPES.FIXED32:return r.readUint32(!0);case o.TYPES.SFIXED32:return r.readInt32(!0);case o.TYPES.FLOAT:return r.readFloat32(!0)}}function p(e,t,r,a,n){var i=e.readVarInt(n);if(i<t||i>=r)throw new Error("FormatError: ".concat(a," encoded with out-of-range value ").concat(i));return i}function h(e,t){if((0,i.longFitsInDouble)(!0,e,t))return 4294967296*e+v(t);var r=e<0,a=r?0===t?-e:~e:e,n=r?-t:t;return(0,d.createHexLongFrom32Bits)(a,n,r)}function _(e,t){return(0,i.longFitsInDouble)(!1,e,t)?4294967296*v(e)+v(t):(0,d.createHexLongFrom32Bits)(e,t)}function m(e,t){var r=e>>>1,a=e<<31|t>>>1;return 1&t&&(r=~r,a=~a),h(r,a)}function g(e,t,r,a){for(var{names:u,fields:l,types:d,meta:h,oneofToFields:_,fieldToOneof:m,reservedTags:v,reservedFields:E}=(0,s.compileSpec)(e),{internalDefaults:y}=e,S=r||(0,n.default)({},y)||{},T=0;T<u.length;T++)d[T]&o.FLAGS.REPEATED&&(S[u[T]]=[]);for(var b=0,A=l[0];t.size();){var C=p(t,0,4294967296,"field and enc type",i.parseInt64OrThrow),P=7&C,O=C>>>3;if(O!==A){var w=b;do{++b===l.length&&(b=0),A=l[b]}while(O!==A&&b!==w)}if(O===A)!function(){var e=u[b],r=d[b];c(P,r,e);var n=r&o.TYPE_MASK,s=h[b];if(r&o.FLAGS.PACKED)for(var l=t.readVarInt(i.parseUint64OrThrow),p=t.readBinary(l);p.size();){var y=f(e,n,p);(n!==o.TYPES.ENUM||s[y]||void 0!==s.cast(y))&&S[e].push(y)}else if(n===o.TYPES.MESSAGE){var T=t.readVarInt(i.parseUint64OrThrow),A=t.readBinary(T);if(r&o.FLAGS.REPEATED)S[e].push(g(s,A,void 0,a));else{var C=S[e];S[e]=g(s,A,C,a)}}else{var w=f(e,n,t);(n!==o.TYPES.ENUM||s[w]||void 0!==s.cast(w))&&(r&o.FLAGS.REPEATED?S[e].push(w):S[e]=w)}var M=m[e];M&&void 0!==S[e]&&M.forEach((t=>{_[t].filter((t=>t!==e)).forEach((e=>{delete S[e]}))})),(v[O]||E[e])&&delete S[e]}();else if(a){S.unsafeUnknownFields||(S.unsafeUnknownFields={});var M=void 0;switch(P){case o.ENC.VARINT:M=t.readVarInt(i.parseInt64OrThrow);break;case o.ENC.BIT64:M=t.readBinary(8);break;case o.ENC.BINARY:M=t.readBinary(t.readVarInt(i.parseUint64OrThrow));break;case o.ENC.BIT32:M=t.readBinary(4)}S.unsafeUnknownFields[O]=M}else P===o.ENC.VARINT?t.readVarInt(i.parseInt64OrThrow):P===o.ENC.BIT64?t.advance(8):P===o.ENC.BINARY?t.advance(t.readVarInt(i.parseUint64OrThrow)):P===o.ENC.BIT32&&t.advance(4)}return S}function v(e){return e>=0?e:4294967296+e}},68519:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.encodeProto=function(e,t,r=new a.Binary){return(0,o.checkValid)(e,t),_(r,t,e),l=void 0,r},t.encodeErrorInfo=function(){return void 0!==l?"Last encoded value for ".concat(l):"No information known"};var a=r(46378),n=r(80802),i=r(45261),s=r(54219),o=r(26032),u=r(8320),l=void 0;function d(e,t){e.writeVarInt(t)}function c(e,t){if("number"==typeof t&&t<4503599627370496&&t>=-4503599627370496)e.writeVarInt(t>=0?2*t:2*-t-1);else{var r,n=new a.Binary;"number"==typeof t?(r=t<0,n.writeVarInt(r?-t:t)):(r=(0,u.hexLongIsNegative)(t),n.writeVarIntFromHexLong(r?(0,u.negateHexLong)(t):t));var i=n.peek((()=>n.readByteArray())),s=i.byteLength;if(r){var o,l=0;do{o=i[l],i[l]=128&o|(127&o)-1&127,l++}while(255===i[l-1])}for(var d=r?1:0,c=0;c<s;c++){var f=i[c],p=128&f|(63&f)<<1|d;d=(64&f)>>6,i[c]=p}1===d&&(i[s-1]|=128,n.writeInt8(1)),e.writeBinary(n)}}function f(e,t){"number"==typeof t?e.writeVarInt(t):e.writeVarIntFromHexLong(t)}var p=[void 0,d,f,d,f,c,c,(e,t)=>{e.writeVarInt(t?1:0)},d,(e,t)=>{"number"==typeof t?e.writeUint64(t,!0):e.writeHexLong(t,!0)},(e,t)=>{"number"==typeof t?e.writeInt64(t,!0):e.writeHexLong(t,!0)},(e,t)=>{e.writeFloat64(t,!0)},function(e,t){e.writeVarInt((0,a.numUtf8Bytes)(t)),e.writeString(t)},function(e,t){e.writeVarInt(t.byteLength),e.writeBuffer(t)},function(e,t,r){e.writeWithVarIntLength(((e,t)=>_(e,t,r)),t)},(e,t)=>{e.writeUint32(t,!0)},(e,t)=>{e.writeInt32(t,!0)},(e,t)=>{e.writeFloat32(t,!0)}],h=p.map((e=>{if(null!=e)return(e,r)=>{e.writeWithVarIntLength(t,r)};function t(t,r){for(var a=0;a<r.length;a++)e(t,r[a])}}));function _(e,t,r){for(var{names:a,fields:o,types:u,meta:d}=(0,n.compileSpec)(r),{internalDefaults:c}=r,f=0;f<a.length;f++){var _=a[f],m=t[_];if(void 0===m&&c&&(m=c[_]),void 0!==m){l=_;var g=o[f],v=u[f],E=v&i.TYPE_MASK,y=d[f],S=8*g|(0,s.typeToEncType)(v);if(v&i.FLAGS.PACKED){if(m.length>0)e.writeVarInt(S),(0,h[E])(e,m,y)}else if(v&i.FLAGS.REPEATED)for(var T=0;T<m.length;T++){e.writeVarInt(S),(0,p[E])(e,m[T],y)}else{e.writeVarInt(S),(0,p[E])(e,m,y)}}}}},44880:(e,t,r)=>{"use strict";var a=r(34398);Object.defineProperty(t,"__esModule",{value:!0}),t.numberOrThrowIfTooLarge=l,t.longIntToDecimalString=function(e){if("number"==typeof e)return e.toString(10);for(var t=(0,i.hexLongToHex)(e),r=[0],a=0,n=0;n<t.length;n++){a=(0,i.hexAt)(t,n);for(var s=0;s<r.length;s++)r[s]=16*r[s]+a,a=r[s]/10|0,r[s]%=10;for(;a>0;)r.push(a%10),a=a/10|0}var o=r.reverse().join("");return(0,i.hexLongIsNegative)(e)?"-"+o:o},t.decimalStringToLongInt=function(e){if(!/^-?\d+$/.test(e))throw __LOG__(2)(o(),e),new Error("decimalStringToLongInt is given an invalid decimal string");var t="-"===e[0],r=e.replace(/^-?0*/,""),a=r.length;if(a<16||16===a&&r<="9007199254740991")return t?-Number(r):Number(r);if(a>20||20===a&&r>"18446744073709551615"||t&&(a>19||19===a&&r>"9223372036854775807"))throw __LOG__(2)(s(),e),new Error("decimalStringToHexLong is given value over 64 bits");for(var n=0,u=0,l=0;l<a;l++)n=10*n+Number(r[l]),u=10*u+Math.floor(n/4294967296),n%=4294967296;return(0,i.createHexLongFrom32Bits)(u,n,t)},t.maybeNumberOrThrowIfTooLarge=void 0;var n=a(r(4875)),i=r(8320);function s(){var e=(0,n.default)(['"','" is over 64 bits']);return s=function(){return e},e}function o(){var e=(0,n.default)(['"','" is not a valid decimal string']);return o=function(){return e},e}function u(){var e=(0,n.default)([""," is not a safe integer"]);return u=function(){return e},e}function l(e){if("number"!=typeof e)throw __LOG__(2)(u(),e),new Error("numberOrThrowIfTooLarge is given a non-safe integer");return e}t.maybeNumberOrThrowIfTooLarge=e=>null==e?e:l(e)},54219:(e,t,r)=>{"use strict";var a=r(66390);Object.defineProperty(t,"__esModule",{value:!0}),t.typeToEncType=function(e){if(e&i.PACKED)return u.BINARY;var t=e&o;return t<=s.ENUM?u.VARINT:t<=s.DOUBLE?u.BIT64:t<=s.MESSAGE?u.BINARY:u.BIT32};var n=a(r(45261)),{FLAGS:i,TYPES:s,TYPE_MASK:o,ENC:u}=n},26032:(e,t,r)=>{"use strict";var a=r(34398);Object.defineProperty(t,"__esModule",{value:!0}),t.checkRequirements=p,t.checkValid=function(e,t){p(e,t);var r=y(t,e);if(r)throw r.path.reverse(),new TypeError("Invalid value at ".concat(r.path.join("."),": ").concat(r.error))};var n=a(r(4875)),i=r(80802),s=r(45261);function o(){var e=(0,n.default)(['"','" is not an array']);return o=function(){return e},e}function u(){var e=(0,n.default)(['"','" is not ',""]);return u=function(){return e},e}function l(){var e=(0,n.default)(['"','" is out of range']);return l=function(){return e},e}function d(){var e=(0,n.default)(['"','" is not a valid int']);return d=function(){return e},e}function c(){var e=(0,n.default)(['"','" is not a valid long']);return c=function(){return e},e}var f=Number.MAX_SAFE_INTEGER;function p(e,t){var r=h(e,t);if(r)throw r.reverse(),new TypeError("Message missing required value ".concat(r.join(".")))}function h(e,t){for(var{names:r,types:a,meta:n}=(0,i.compileSpec)(e),o=void 0,u=0;u<a.length&&!o;u++){var l=a[u],d=r[u],c=Object.prototype.hasOwnProperty.call(t,d)?t[d]:void 0;if(l&s.FLAGS.REQUIRED&&void 0===c)o=[d];else if((l&s.TYPE_MASK)===s.TYPES.MESSAGE&&l&s.FLAGS.REPEATED&&void 0!==c){var f=n[u],p=void 0;for(p=0;p<c.length&&!o;p++)o=h(f,c[p]);o&&o.push("".concat(d,"[").concat(p,"]"))}else(l&s.TYPE_MASK)===s.TYPES.MESSAGE&&void 0!==c&&(o=h(n[u],c))&&o.push(d)}return o}function _(e,t,r){return"string"==typeof e?!/^-?0x[0-9a-f]{16}$/i.test(e)&&(__LOG__(2)(c(),v(e)),{path:[],error:"value must be a hex string of the form '0x123...' or '-0x123...' where the tail is always 16 characters long"}):m(e,t,r)}function m(e,t,r){return"number"!=typeof e||e!=e||Math.floor(e)!==e?(__LOG__(2)(d(),v(e)),{path:[],error:"value must be an int"}):(e<t||e>=r)&&(__LOG__(2)(l(),v(e)),{path:[],error:"value is out of range"})}function g(e,t,r){return e?void 0:(__LOG__(2)(u(),v(r),t),{path:[],error:"value is invalid"})}function v(e){return"string"==typeof e?'"'.concat(e,'"'):Array.isArray(e)?"[".concat(e.join(", "),"]"):"".concat(e)}var E=[void 0,e=>m(e,-2147483648,2147483648),e=>_(e,-f,f+1),e=>m(e,0,4294967296),e=>_(e,0,f+1),e=>m(e,-2147483648,2147483648),e=>_(e,-f,f+1),e=>g("boolean"==typeof e,"boolean",e),(e,t)=>g("number"==typeof e&&(t[e]||void 0!==t.cast(e)),"in enum",e),e=>_(e,0,f+1),e=>_(e,-f,f+1),e=>g("number"==typeof e,"number",e),e=>g("string"==typeof e,"string",e),e=>g(e instanceof ArrayBuffer||e instanceof Uint8Array,"ArrayBuffer or Uint8Array",e),y,e=>m(e,0,4294967296),e=>m(e,-2147483648,2147483648),e=>g("number"==typeof e,"number",e)];function y(e,t){for(var{names:r,fields:a,types:n,meta:u,oneofToFields:l,fieldToOneof:d,reservedTags:c,reservedFields:f}=(0,i.compileSpec)(t),p=void 0,h=function(t){var i=r[t],h=n[t],_=e[i],m=h&s.TYPE_MASK,g=E[m];if(void 0===g)throw new Error("Can not find the validator for type ".concat(m));if(h&(s.FLAGS.PACKED|s.FLAGS.REPEATED)&&void 0!==_)if(Array.isArray(_))for(var y=u[t],S=0;S<_.length&&!p;S++)(p=g(_[S],y))&&p.path.push("".concat(i,"[").concat(S,"]"));else __LOG__(2)(o(),v(_)),p={path:[i],error:"repeated field must be array"};else if(void 0!==_){(p=g(_,u[t]))&&p.path.push(i);var T=d[i];T&&T.forEach((t=>{l[t].filter((e=>e!==i)).forEach((r=>{void 0!==e[r]&&(p={path:[t],error:"oneof has fields '".concat(i,"' and '").concat(r,"' set")})}))})),c[a[t]]&&(p={path:[i],error:"tag ".concat(a[t]," is reserved")}),f[i]&&(p={path:[i],error:"field name is reserved"})}},_=0;_<r.length&&!p;_++)h(_);return p}},46144:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ensureSize=l,t.toBytes=function(e,t){return l(new Uint8Array(e),t)},t.toBuffer=function(e){var t=e.buffer,r=e.byteOffset,a=e.length;return 0===r&&a===t.byteLength?t:t.slice(r,r+a)},t.readBytes=function(e,t){return e.readByteArray(t)},t.makeBytes=function(e){return new Uint8Array(e)},t.sliceBytes=function(e,t,r){if(e.length-t<r)throw new Error("Can not split off ".concat(r," bytes from index ").concat(t," of ").concat(e.length," bytes"));return e.slice(t,t+r)},t.makeRegistrationId=function(e){var t="extendedRange"===e?2147483646:16380;return(0,s.randomNumberLessThan)(t)+1},t.castRegistrationId=function(e){return d(e)},t.makeSenderKeyId=function(){return(0,s.randomNumberLessThan)(-1>>>1)+1},t.castSenderKeyId=function(e){return d(e)},t.ensureIntInRange=d,t.encodeSignalProto=function(e,t){return(0,a.encodeProto)(e,t).readByteArray()},t.decodeSignalProto=function(e,t,r){return r((0,n.decodeProto)(e,t))},t.hkdf=function(e,t,r,a){return(0,i.extractWithSaltAndExpand)(e,t,r,a).then((e=>new Uint8Array(e)))},t.makeCryptoKey=function(e,t){var r,a;"hmac-sha256"===t?(r=u,a=["sign"]):(r=o,a=["encrypt","decrypt"]);return self.crypto.subtle.importKey("raw",e,r,!1,a)},t.HMAC_SHA256=t.AES_CBC=void 0;var a=r(68519),n=r(84139),i=r(37953),s=r(79167),o={name:"AES-CBC"};t.AES_CBC=o;var u={name:"HMAC",hash:"SHA-256"};function l(e,t){if(e.length!==t)throw new Error("Signal expected ".concat(t," bytes, given ").concat(e.length));return e}function d(e,t=0,r=4294967296){if("number"==typeof e&&t<=e&&e<r&&Math.floor(e)===e)return e;throw new Error("Expected integer in range [".concat(t,", ").concat(r,"), given ").concat(String(e)))}t.HMAC_SHA256=u},46378:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.numUtf8Bytes=d,t.longFitsInDouble=c,t.parseInt64OrThrow=j,t.parseUint64OrThrow=W,t.Binary=void 0;var a=r(8320),n=65533,i=new Uint8Array(10),s=new Uint8Array(0);class o{constructor(e=s,t=!1){e instanceof ArrayBuffer?(this._buffer=new Uint8Array(e),this._readEndIndex=this._writeIndex=e.byteLength):e instanceof Uint8Array&&(this._buffer=e,this._readEndIndex=this._writeIndex=e.length),this._bytesTrashed=0,this._earliestIndex=this._readIndex=0,this._view=null,this._littleEndian=t,this._hiddenReads=0,this._hiddenWrites=0}size(){return this._readEndIndex-this._readIndex}peek(e,t){this._hiddenReads++;var r=this._readIndex,a=this._bytesTrashed;try{return e(this,t)}finally{this._hiddenReads--,this._readIndex=r-(this._bytesTrashed-a)}}advance(e){this._shiftReadOrThrow(e)}readWithViewParser(e,t,r,a){return t(this._getView(),this._shiftReadOrThrow(e),e,r,a)}readWithBytesParser(e,t,r,a){return t(this._buffer,this._shiftReadOrThrow(e),e,r,a)}readUint8(){return f(this,1,h,!1)}readInt8(){return f(this,1,h,!0)}readUint16(e=this._littleEndian){return f(this,2,_,e)}readInt32(e=this._littleEndian){return f(this,4,m,e)}readUint32(e=this._littleEndian){return f(this,4,g,e)}readInt64(e=this._littleEndian){return f(this,8,v,j,e)}readUint64(e=this._littleEndian){return f(this,8,v,W,e)}readLong(e,t=this._littleEndian){return f(this,8,v,e,t)}readFloat32(e=this._littleEndian){return f(this,4,E,e)}readFloat64(e=this._littleEndian){return f(this,8,y,e)}readVarInt(e){var t=p(this,0,S,this.size());return p(this,t,T,e)}readBuffer(e=this.size()){return 0===e?new ArrayBuffer(0):p(this,e,b)}readByteArray(e=this.size()){return 0===e?new Uint8Array(0):p(this,e,A)}readBinary(e=this.size(),t=this._littleEndian){if(0===e)return new o(void 0,t);var r=p(this,e,A);return new o(r,t)}indexOf(e){if(0===e.length)return 0;for(var t=this._buffer,r=this._readEndIndex,a=this._readIndex,n=0,i=a,s=a;s<r;s++)if(t[s]===e[n]){if(0===n&&(i=s),++n===e.byteLength)return s-a-e.byteLength+1}else n>0&&(n=0,s=i);return-1}readString(e){return p(this,e,C)}ensureCapacity(e){this._maybeReallocate(this._readIndex+e)}ensureAdditionalCapacity(e){this._maybeReallocate(this._writeIndex+e)}writeToView(e,t,r,a){var n=this._shiftWriteMaybeReallocate(e);return t(this._getView(),n,e,r,a)}writeToBytes(e,t,r,a){var n=this._shiftWriteMaybeReallocate(e);return t(this._buffer,n,e,r,a)}write(...e){for(var t=0;t<e.length;t++){var r=e[t];"string"==typeof r?this.writeString(r):"number"==typeof r?this.writeUint8(r):r instanceof o?this.writeBinary(r):r instanceof ArrayBuffer?this.writeBuffer(r):r instanceof Uint8Array&&this.writeByteArray(r)}}writeUint8(e){Y(e,0,256,"uint8"),O(this,1,w,e,!1)}writeInt8(e){Y(e,-128,128,"signed int8"),O(this,1,w,e,!0)}writeUint16(e,t=this._littleEndian){Y(e,0,65536,"uint16"),P(this,2,M,e,t)}writeInt16(e,t=this._littleEndian){Y(e,-32768,32768,"signed int16"),P(this,2,I,e,t)}writeUint32(e,t=this._littleEndian){Y(e,0,4294967296,"uint32"),P(this,4,R,e,t)}writeInt32(e,t=this._littleEndian){Y(e,-2147483648,2147483648,"signed int32"),P(this,4,D,e,t)}writeUint64(e,t=this._littleEndian){Y(e,0,0x10000000000000000,"uint64"),P(this,8,N,e,t)}writeInt64(e,t=this._littleEndian){Y(e,-0x8000000000000000,0x8000000000000000,"signed int64"),P(this,8,N,e,t)}writeFloat32(e,t=this._littleEndian){P(this,4,L,e,t)}writeFloat64(e,t=this._littleEndian){P(this,8,k,e,t)}writeVarInt(e){Y(e,-0x8000000000000000,0x8000000000000000,"varint (signed int64)");var t=e<0,r=t?-e:e,a=Math.floor(r/4294967296),n=r-4294967296*a;t&&(a=~a,0===n?a++:n=-n),O(this,B(a,n),U,a,n)}writeVarIntFromHexLong(e){for(var t=(0,a.hexLongIsNegative)(e),r=t?(0,a.negateHexLong)(e):e,n=(0,a.hexLongToHex)(r),i=0,s=0,o=0;o<a.NUM_HEX_IN_LONG;o++)i=i<<4|s>>>28,s=s<<4|(0,a.hexAt)(n,o);t&&(i=~i,0===s?i++:s=-s),O(this,B(i,s),U,i,s)}writeBinary(e){var t=e.peek((e=>e.readByteArray()));if(t.length){var r=this._shiftWriteMaybeReallocate(t.length);this._buffer.set(t,r)}}writeBuffer(e){this.writeByteArray(new Uint8Array(e))}writeByteArray(e){var t=this._shiftWriteMaybeReallocate(e.length);this._buffer.set(e,t)}writeBufferView(e){this.writeByteArray(new Uint8Array(e.buffer,e.byteOffset,e.byteLength))}writeString(e){O(this,d(e),F,e)}writeHexLong(e,t=this._littleEndian){P(this,8,G,e,t)}writeBytes(...e){for(var t=0;t<e.length;t++)Y(e[t],0,256,"byte");O(this,e.length,x,e)}writeAtomically(e,t){this._hiddenWrites++;var r=this._writeIndex,a=this._bytesTrashed;try{var n=e(this,t);return r=this._writeIndex,a=this._bytesTrashed,n}finally{this._hiddenWrites--,this._writeIndex=r-(this._bytesTrashed-a)}}writeWithVarIntLength(e,t){var r=this._writeIndex,a=this.writeAtomically(e,t),n=this._writeIndex;this.writeVarInt(n-r);for(var s=this._writeIndex-n,o=this._buffer,u=0;u<s;u++)i[u]=o[n+u];for(var l=n-1;l>=r;l--)o[l+s]=o[l];for(var d=0;d<s;d++)o[r+d]=i[d];return a}static build(...e){for(var t=0,r=0;r<e.length;r++){var a=e[r];"string"==typeof a?t+=d(a):"number"==typeof a?t++:a instanceof o?t+=a.size():a instanceof ArrayBuffer?t+=a.byteLength:a instanceof Uint8Array&&(t+=a.length)}var n=new o;return n.ensureCapacity(t),n.write.apply(n,arguments),n}_getView(){return this._view||(this._view=new DataView(this._buffer.buffer,this._buffer.byteOffset))}_shiftReadOrThrow(e){if(e<0)throw new Error("ReadError: given negative number of bytes to read");var t=this._readIndex,r=t+e;if(r>this._readEndIndex)throw new Error(t===this._readEndIndex?"ReadError: tried to read from depleted binary":"ReadError: tried to read beyond end of binary");return this._readIndex=r,this._hiddenReads||(this._earliestIndex=r),t}_maybeReallocate(e){var t=this._buffer;if(e<=t.length)return e;var r=this._earliestIndex,a=e-r,n=Math.max(a,2*(t.length-r),64),i=new Uint8Array(n);return r?(i.set(t.subarray(r)),this._bytesTrashed+=r,this._readIndex-=r,this._readEndIndex-=r,this._writeIndex-=r,this._earliestIndex=0):i.set(t),this._buffer=i,this._view=null,a}_shiftWriteMaybeReallocate(e){var t=this._maybeReallocate(this._writeIndex+e),r=this._writeIndex;return this._writeIndex=t,this._hiddenWrites||(this._readEndIndex=t),r}}t.Binary=o;var u="",l=0;function d(e){if(e===u)return l;for(var t=e.length,r=0,a=0;a<t;a++){var n=e.charCodeAt(a);if(n<128)r++;else if(n<2048)r+=2;else if(n<55296||57344<=n&&n<=65535)r+=3;else if(55296<=n&&n<56320&&a+1!==t){var i=e.charCodeAt(a+1);56320<=i&&i<57344?(a++,r+=4):r+=3}else r+=3}return u=e,l=r}function c(e,t,r){var a=t>>21;if(e){var n=Boolean(2097151&t||r);return 0===a||-1===a&&n}return 0===a}function f(e,t,r,a,n){return e.readWithViewParser(t,r,a,n)}function p(e,t,r,a,n){return e.readWithBytesParser(t,r,a,n)}function h(e,t,r,a){return a?e.getInt8(t):e.getUint8(t)}function _(e,t,r,a){return e.getUint16(t,a)}function m(e,t,r,a){return e.getInt32(t,a)}function g(e,t,r,a){return e.getUint32(t,a)}function v(e,t,r,a,n){return a(e.getInt32(n?t+4:t,n),e.getInt32(n?t:t+4,n))}function E(e,t,r,a){return e.getFloat32(t,a)}function y(e,t,r,a){return e.getFloat64(t,a)}function S(e,t,r,a){for(var n=Math.min(a,10),i=0,s=128;i<n&&128&s;)s=e[t+i++];if(10===i&&s>1)throw new Error("ParseError: varint exceeds 64 bits");return 128&s?i+1:i}function T(e,t,r,a){var n=0,i=0,s=r;10===r&&(i=1&e[t+--s]);for(var o=s-1;o>=0;o--)n=n<<7|i>>>25,i=i<<7|127&e[t+o];return a(n,i)}function b(e,t,r){var a=t+e.byteOffset,n=e.buffer;return 0===a&&r===n.byteLength?n:n.slice(a,a+r)}function A(e,t,r){return e.subarray(t,t+r)}function C(e,t,r){for(var a=t+r,i=[],s=null,o=t;o<a;o++){i.length>5e3&&(s||(s=[]),s.push(String.fromCharCode.apply(String,i)),i=[]);var u=0|e[o];if(0==(128&u))i.push(u);else if(192==(224&u)){var l=V(e,o+1,a);if(l){o++;var d=(31&u)<<6|63&l;d>=128?i.push(d):i.push(n)}else i.push(n)}else if(224==(240&u)){var c=V(e,o+1,a),f=V(e,o+2,a);if(c&&f){o+=2;var p=(15&u)<<12|(63&c)<<6|63&f;p>=2048&&!(55296<=p&&p<57344)?i.push(p):i.push(n)}else c?(o++,i.push(n)):i.push(n)}else if(240==(248&u)){var h=V(e,o+1,a),_=V(e,o+2,a),m=V(e,o+3,a);if(h&&_&&m){o+=3;var g=(7&u)<<18|(63&h)<<12|(63&_)<<6|63&m;if(g>=65536&&g<=1114111){var v=g-65536;i.push(55296|v>>10,56320|1023&v)}else i.push(n)}else h&&_?(o+=2,i.push(n)):h?(o++,i.push(n)):i.push(n)}else i.push(n)}var E=String.fromCharCode.apply(String,i);return s?(s.push(E),s.join("")):E}function P(e,t,r,a,n){return e.writeToView(t,r,a,n)}function O(e,t,r,a,n){return e.writeToBytes(t,r,a,n)}function w(e,t,r,a){e[t]=a}function M(e,t,r,a,n){e.setUint16(t,a,n)}function I(e,t,r,a,n){e.setInt16(t,a,n)}function R(e,t,r,a,n){e.setUint32(t,a,n)}function D(e,t,r,a,n){e.setInt32(t,a,n)}function N(e,t,r,a,n){var i=a<0,s=i?-a:a,o=Math.floor(s/4294967296),u=s-4294967296*o;i&&(o=~o,0===u?o++:u=-u),e.setUint32(n?t+4:t,o,n),e.setUint32(n?t:t+4,u,n)}function L(e,t,r,a,n){e.setFloat32(t,a,n)}function k(e,t,r,a,n){e.setFloat64(t,a,n)}function U(e,t,r,a,n){for(var i=a,s=n,o=t+r-1,u=t;u<o;u++)e[u]=128|127&s,s=i<<25|s>>>7,i>>>=7;e[o]=s}function F(e,t,r,a){for(var n=t,i=a.length,s=0;s<i;s++){var o=a.charCodeAt(s);if(o<128)e[n++]=o;else if(o<2048)e[n++]=192|o>>6,e[n++]=128|63&o;else if(o<55296||57344<=o)e[n++]=224|o>>12,e[n++]=128|o>>6&63,e[n++]=128|63&o;else if(55296<=o&&o<56320&&s+1!==i){var u=a.charCodeAt(s+1);if(56320<=u&&u<57344){s++;var l=65536+((1023&o)<<10|1023&u);e[n++]=240|l>>18,e[n++]=128|l>>12&63,e[n++]=128|l>>6&63,e[n++]=128|63&l}else e[n++]=239,e[n++]=191,e[n++]=189}else e[n++]=239,e[n++]=191,e[n++]=189}}function G(e,t,r,n,i){for(var s=(0,a.hexLongIsNegative)(n),o=(0,a.hexLongToHex)(n),u=0,l=0,d=0;d<16;d++)u=u<<4|l>>>28,l=l<<4|(0,a.hexAt)(o,d);s&&(u=~u,0===l?u++:l=-l),e.setUint32(i?t+4:t,u,i),e.setUint32(i?t:t+4,l,i)}function x(e,t,r,a){for(var n=0;n<r;n++)e[t+n]=a[n]}function B(e,t){var r,a;for(e?(r=5,a=e>>>3):(r=1,a=t>>>7);a;)r++,a>>>=7;return r}function Y(e,t,r,a){if("number"!=typeof e||e!=e||Math.floor(e)!==e||e<t||e>=r)throw new TypeError("string"==typeof e?'WriteError: string "'.concat(e,'" is not a valid ').concat(a):"WriteError: ".concat(String(e)," is not a valid ").concat(a))}function K(e,t,r){var a=4294967296*(t>=0||e?t:4294967296+t)+(r>=0?r:4294967296+r);if(!c(e,t,r))throw new Error("ReadError: integer exceeded 53 bits (".concat(a,")"));return a}function j(e,t){return K(!0,e,t)}function W(e,t){return K(!1,e,t)}function V(e,t,r){if(t>=r)return 0;var a=0|e[t];return 128==(192&a)?a:0}},29351:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.customError=a,t.supressQuotaExceededError=function(e){if(null==e||"QuotaExceededError"!==e.name)throw e;i=!0},t.hasSupressedQuotaExceededError=function(){return i},t.obtainErrorSummary=function(e){return JSON.stringify(e,Object.getOwnPropertyNames(e))},t.WrappedError=t.HttpError=void 0;var r=Object.create(Error.prototype,{constructor:{value:void 0,writable:!0,configurable:!0}});function a(e,t=!0,a){function n(r){var a=Error.call(this,r);this.message=r,a.name=e,this.name=e,t&&(this.stack=a.stack)}return n.prototype=Object.create(a?a.prototype:r),n.prototype.constructor=n,n}class n extends(a("HttpError",!1)){constructor(e,t){super(e),this.code=t}}t.HttpError=n;var i=!1;class s extends Error{constructor(e,t){super(e),this.inner=t}}t.WrappedError=s},39329:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ShiftTimer=void 0;function r(e){if(!(e>=0))throw new Error("ShiftTimer must be given delay >= 0")}t.ShiftTimer=class{constructor(e){this._timer=0,this._rafId=0,this.ts=0,this._timerTs=0,this._upperBound=0,this._lowerBound=0,this._arg=void 0,this._run=()=>{var e=this._arg,t=this._foo;this._rafId=0,this._timer=0,this.ts=0,this._timerTs=0,this._upperBound=0,this._lowerBound=0,this._arg=void 0,t(e)},this._foo=e}onOrBefore(e,t){r(e);var a=Date.now()+e,n=this._upperBound;if(!(0!==n&&n<a)){var i=this._lowerBound;0!==i&&a<i||(this._upperBound=a,this._rafId||this._timer&&!(a<this.ts)||this._setDelay(a,e,t))}}onOrBeforeRepaint(e){if(!this._rafId){var t=Date.now(),r=this._lowerBound;if(!(0!==r&&t<r)){var a=this._upperBound;(0===a||t<a)&&(this._upperBound=t),this._timer&&(clearTimeout(this._timer),this._timer=0),(!this.ts||this.ts>t)&&(this.ts=t),this._arg=e,this._rafId=requestAnimationFrame(this._run)}}}onOrAfter(e,t){r(e);var a=Date.now()+e,n=this._lowerBound;if(!(0!==n&&a<n)){var i=this._upperBound;0!==i&&i<a||(this._lowerBound=a,(!this._timer||this.ts<a)&&this._setDelay(a,e,t))}}debounce(e,t){r(e),this._debounce(Date.now(),e,t)}debounceAndCap(e,t,a){r(e),r(t);var n=Date.now(),i=n+t,s=this._lowerBound,o=this._upperBound;(0===s||s<=i)&&(0===o||i<o)&&(this._upperBound=i),this._debounce(n,e,a)}forceRunNow(e){this._timer&&clearTimeout(this._timer),this._rafId&&cancelAnimationFrame(this._rafId),this._arg=e,this._run()}forceRunNowIfScheduled(){this._timer?(clearTimeout(this._timer),this._run()):this._rafId&&(cancelAnimationFrame(this._rafId),this._run())}cancel(){this._timer&&clearTimeout(this._timer),this._rafId&&cancelAnimationFrame(this._rafId),this._timer=0,this._rafId=0,this.ts=0,this._timerTs=0,this._upperBound=0,this._lowerBound=0,this._arg=void 0}isScheduled(){return 0!==this._timer||0!==this._rafId}_debounce(e,t,r){var a=e+t,n=this._lowerBound;if(!(0!==n&&a<n)){var i=this.ts,s=this._upperBound;0!==s&&s<a?i<s&&this._setDelay(s,s-e,r):i<a&&this._setDelay(a,t,r)}}_setDelay(e,t,r){if(this._rafId&&(cancelAnimationFrame(this._rafId),this._rafId=0),this._arg=r,this.ts=e,this._timer){var a=e-this._timerTs;if(-16<a&&a<16)return;clearTimeout(this._timer)}this._timer=setTimeout(this._run,t),this._timerTs=e}}},27538:(e,t,r)=>{"use strict";var a=r(34398);Object.defineProperty(t,"__esModule",{value:!0}),t.startScheduler=function(e){__LOG__(2)(o()),g||(g=new m(e))},t.awaitTaskPromise=function(e){return E("awaitTaskPromise").awaitTaskPromise(e)},t.reschedule=v,t.rescheduleNow=function(e){v(e,(0,i.unixTime)())},t.deactivate=function(e){v(e,i.DUMMY_UNIXTIME)},t.getScheduledTime=function(e){return E("getScheduledTime").getScheduledTime(e)},t.registerTask=function(e,t){E("registerTask").registerTask(e,t)},t.DO_NOT_RESCHEDULE=void 0;var n=a(r(4875)),i=r(71684),s=r(26800);function o(){var e=(0,n.default)(["startScheduler invoked"]);return o=function(){return e},e}function u(){var e=(0,n.default)(["Task "," failed, try again later: ",""]);return u=function(){return e},e}function l(){var e=(0,n.default)(["Task "," will try again later"]);return l=function(){return e},e}function d(){var e=(0,n.default)(["Task "," complete, waiting ",""]);return d=function(){return e},e}function c(){var e=(0,n.default)(["Task "," complete, deactivating"]);return c=function(){return e},e}function f(){var e=(0,n.default)(["Firing task ",""]);return f=function(){return e},e}function p(){var e=(0,n.default)(["Scheduling task "," in ","ms"]);return p=function(){return e},e}function h(){var e=(0,n.default)(["Task "," deactivated"]);return h=function(){return e},e}function _(){var e=(0,n.default)(["Tried to start task "," before registering its implementation"]);return _=function(){return e},e}t.DO_NOT_RESCHEDULE="no_reschedule";class m{constructor(e){this._started=!1,this._resolvers={},this._timers={},this._timeoutIDs={},this._taskImplementations=new Map,this._scheduledTimeResolver=e.scheduledTimeResolver}_startTask(e){var t=this._taskImplementations.get(e);null!=t?this._scheduledTimeResolver.get(e).then((r=>{var a=null==r;if(a||r!==i.DUMMY_UNIXTIME){var n=null==r?0:1e3*r-(0,i.unixTimeMs)();n=Math.max(0,n),n=Math.min(n,~(1<<31)),__LOG__(2)(p(),e,n),this._timeoutIDs[e]=setTimeout((()=>{delete this._timeoutIDs[e],__LOG__(2)(f(),e),t(a).then((t=>{return"no_reschedule"===t?new Promise((()=>{})):(t===i.DUMMY_UNIXTIME?(__LOG__(2)(c(),e),delete this._timers[e],r=i.DUMMY_UNIXTIME):t>=0?(__LOG__(2)(d(),e,t),delete this._timers[e],r=(0,i.futureUnixTime)(t)):(__LOG__(2)(l(),e),r=this._getNextRun(e)),this._scheduledTimeResolver.set(e,r));var r})).then((()=>{this._startTask(e),this._resolvers[e]&&(this._resolvers[e].forEach((e=>e())),delete this._resolvers[e])})).catch((t=>(__LOG__(2)(u(),e,t),this._scheduledTimeResolver.set(e,this._getNextRun(e)).then((()=>{this._startTask(e)})))))}),n)}else __LOG__(2)(h(),e)})):__LOG__(4,void 0,new Error)(_(),e)}_getNextRun(e){return this._timers[e]||(this._timers[e]=(0,s.createTimer)({jitter:.1,max:1e3*i.HOUR_SECONDS,algo:{type:"fibonacci",first:1e3,second:2e3}})),(0,i.futureUnixTime)(Math.round(this._timers[e]()/1e3))}_registerResolver(e,t){this._resolvers[e]||(this._resolvers[e]=[]),this._resolvers[e].push(t)}awaitTaskPromise(e){return new Promise((t=>{this._registerResolver(e,t)}))}reschedule(e,t){this._started?(this._scheduledTimeResolver.set(e,t),null!=this._timeoutIDs[e]&&clearTimeout(this._timeoutIDs[e]),this._startTask(e)):this._scheduledTimeResolver.set(e,t)}registerTask(e,t){this._started||(this._started=!0),this._taskImplementations.set(e,t),this._startTask(e)}getScheduledTime(e){return this._scheduledTimeResolver.get(e)}}var g=null;function v(e,t){E("reschedule").reschedule(e,t)}function E(e){if(g)return g;throw new Error("TaskScheduler::".concat(e," called before startScheduler"))}},30575:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.removeIndexWithoutPreservingOrder=function(e,t){var r=e.pop();t<e.length&&(e[t]=r)}},90432:e=>{e.exports=function(e){throw new Error("Impossible value, the default statement should never be reached for value: ".concat(e))}},60339:(e,t,r)=>{"use strict";var a=r(34398);Object.defineProperty(t,"__esModule",{value:!0}),t.encodeB64=function(e){return o(e,43,47,!0)},t.encodeB64UrlSafe=function(e,t=!1){return o(e,45,95,t)},t.decodeB64=function(e){var t=l(e,43,47,61);if(t)return t.buffer;throw new Error("Base64.decode given invalid string")},t.decodeB64UrlSafe=function(e){var t=l(e,45,95,-1);if(t)return t.buffer;throw new Error("Base64.decode given invalid string")},t.decodeB64ToJsArray=function(e){var t=e instanceof ArrayBuffer?new Uint8Array(e):l(e,43,47,61);return t&&Array.prototype.slice.call(t)},t.sizeWhenB64Decoded=function(e){return Math.floor(3*e.length/4)},t.BASE64_DATA_URL_SCHEME=void 0;var n=a(r(4875));function i(){var e=(0,n.default)(["Found unexpected character code while decoding B64 at index ",", length ",": ",""]);return i=function(){return e},e}var s=3e3;function o(e,t,r,a){var n=Array.isArray(e)||e instanceof ArrayBuffer?new Uint8Array(e):e;if(n.length<=s)return u(n,t,r,a);for(var i=[],o=0;o<n.length;o+=s)i.push(u(n.subarray(o,o+s),t,r,a));return i.join("")}function u(e,t,r,a){for(var n=Math.ceil(4*e.length/3),i=4*Math.ceil(e.length/3),s=new Array(i),o=0,u=0;o<i;o+=4,u+=3){var l=e[u]<<16|e[u+1]<<8|e[u+2];s[o]=l>>18,s[o+1]=l>>12&63,s[o+2]=l>>6&63,s[o+3]=63&l}for(var d=0;d<n;d++){var c=s[d];s[d]=c<26?65+c:c<52?71+c:c<62?c-4:62===c?t:r}for(var f=n;f<i;f++)s[f]=61;var p=String.fromCharCode.apply(String,s);return a?p:p.substring(0,n)}function l(e,t,r,a){for(var n=e.length,s=new Int32Array(n+n%4),o=0;o<n;o++){var u=e.charCodeAt(o);if(65<=u&&u<=90)s[o]=u-65;else if(97<=u&&u<=122)s[o]=u-71;else if(48<=u&&u<=57)s[o]=u+4;else if(u===t)s[o]=62;else{if(u!==r){if(u===a){n=o;break}return null!=self.ERROR&&__LOG__(4,void 0,new Error)(i(),o,n,u),null}s[o]=63}}for(var l=s.length/4,d=0,c=0;d<l;d++,c+=4)s[d]=s[c]<<18|s[c+1]<<12|s[c+2]<<6|s[c+3];for(var f=Math.floor(3*n/4),p=new Uint8Array(f),h=0,_=0;_+3<=f;h++,_+=3){var m=s[h];p[_]=m>>16,p[_+1]=m>>8&255,p[_+2]=255&m}switch(f-_){case 2:p[_]=s[h]>>16,p[_+1]=s[h]>>8&255;break;case 1:p[_]=s[h]>>16}return p}t.BASE64_DATA_URL_SCHEME="data:image/jpeg;base64,"},82704:(e,t,r)=>{"use strict";var a,n;Object.defineProperty(t,"__esModule",{value:!0}),t.dir=function(e){!function(){if(a)return;var e=r(88610),t=e.length/2;a=new Int32Array(t),n=new Int32Array(t);for(var i=0,s=0;i<t;i++,s+=2)a[i]=e[s]+(0===i?0:a[i-1]),n[i]=e[s+1]}();for(var t=0;t<e.length;t++){var i=0|e.charCodeAt(t);if(55296<=i&&i<56320){if(++t===e.length)break;var s=e.charCodeAt(t);if(!(56320<=s&&s<57344))continue;i=65536+((1023&i)<<10|1023&s)}else if(56320<=i&&i<57344)continue;if(!(i<a[0])){for(var o=0|a.length,u=0,l=o-1|0;u<l;){var d=l+u>>1;if(a[d]>i)l=d-1|0;else{if(a[d+1]>i){l=d;break}u=d+1|0}}var c=n[l],f=a[l]+Math.abs(c)|0;if(i<f)return c<0?"rtl":"ltr"}}return}},96519:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=[];r[34]="ES",r[49]="DE",r[52]="MX",r[44]="GB",r[966]="SA",r[39]="IT",r[93]="AF",r[355]="AL",r[213]="DZ",r[376]="AD",r[244]="AO",r[54]="AR",r[374]="AM",r[297]="AW",r[61]="AU",r[43]="AT",r[994]="AZ",r[973]="BH",r[880]="BD",r[375]="BY",r[32]="BE",r[501]="BZ",r[229]="BJ",r[975]="BT",r[591]="BO",r[387]="BA",r[267]="BW",r[55]="BR",r[246]="IO",r[673]="BN",r[359]="BG",r[226]="BF",r[257]="BI",r[225]="CI",r[855]="KH",r[237]="CM",r[238]="CV",r[236]="CF",r[235]="TD",r[56]="CL",r[86]="CN",r[57]="CO",r[269]="KM",r[242]="CG",r[243]="CD",r[682]="CK",r[506]="CR",r[385]="HR",r[53]="CU",r[599]="CW",r[357]="CY",r[420]="CZ",r[45]="DK",r[253]="DJ",r[593]="EC",r[20]="EG",r[503]="SV",r[240]="GQ",r[291]="ER",r[372]="EE",r[251]="ET",r[298]="FO",r[679]="FJ",r[358]="FI",r[33]="FR",r[594]="GF",r[689]="PF",r[241]="GA",r[220]="GM",r[995]="GE",r[233]="GH",r[350]="GI",r[30]="GR",r[299]="GL",r[590]="GP",r[502]="GT",r[224]="GN",r[245]="GW",r[592]="GY",r[509]="HT",r[504]="HN",r[852]="HK",r[36]="HU",r[354]="IS",r[91]="IN",r[62]="ID",r[98]="IR",r[964]="IQ",r[353]="IE",r[972]="IL",r[81]="JP",r[962]="JO",r[254]="KE",r[965]="KW",r[996]="KG",r[856]="LA",r[371]="LV",r[961]="LB",r[266]="LS",r[231]="LR",r[218]="LY",r[423]="LI",r[370]="LT",r[352]="LU",r[853]="MO",r[389]="MK",r[261]="MG",r[265]="MW",r[60]="MY",r[960]="MV",r[223]="ML",r[356]="MT",r[692]="MH",r[596]="MQ",r[222]="MR",r[230]="MU",r[691]="FM",r[373]="MD",r[377]="MC",r[976]="MN",r[382]="ME",r[212]="MA",r[258]="MZ",r[95]="MM",r[264]="NA",r[674]="NR",r[977]="NP",r[31]="NL",r[687]="NC",r[64]="NZ",r[505]="NI",r[227]="NE",r[234]="NG",r[672]="NF",r[850]="KP",r[47]="NO",r[968]="OM",r[92]="PK",r[680]="PW",r[970]="PS",r[507]="PA",r[675]="PG",r[595]="PY",r[51]="PE",r[63]="PH",r[48]="PL",r[351]="PT",r[974]="QA",r[40]="RO",r[7]="RU",r[250]="RW",r[262]="RE",r[508]="PM",r[685]="WS",r[378]="SM",r[221]="SN",r[381]="RS",r[248]="SC",r[232]="SL",r[65]="SG",r[421]="SK",r[386]="SI",r[677]="SB",r[252]="SO",r[27]="ZA",r[82]="KR",r[211]="SS",r[94]="LK",r[249]="SD",r[597]="SR",r[268]="SZ",r[46]="SE",r[41]="CH",r[963]="SY",r[239]="ST",r[886]="TW",r[992]="TJ",r[255]="TZ",r[66]="TH",r[670]="TL",r[228]="TG",r[676]="TO",r[216]="TN",r[90]="TR",r[993]="TM",r[256]="UG",r[380]="UA",r[971]="AE",r[1]="US",r[598]="UY",r[998]="UZ",r[678]="VU",r[58]="VE",r[84]="VN",r[681]="WF",r[967]="YE",r[260]="ZM",r[263]="ZW",r[383]="XK";var a=r;t.default=a},6893:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={1:'[334,-1,"($1) $2-$3"],10',20:'["Ah","[23]"],[334,"1[0125]|[89]00"],["Bg","1[35]|[4-6]|[89][2-9]"],[9,10]',211:"333,9",212:'["[5-7]BF","5(2[015-7]|3[0-4])|[67]",1],["[58]CE",["5(2[2-489]|3[5-9]|92)|892","5(2([2-48]|9[0-7])|3([5-79]|8[0-7])|924)|892"],1],["5DD",["5(29|38)","5(29|38)[89]"],1],["[5]BBBB","5(4[067]|5[03])"],["8[09];G","8(0|9[013-9])",1],9',213:'["[5-8]BBBB","[5-8]"],["9ACBB",9],9',216:"233,8",218:'[27,"[25-79]",1],9',220:"34,7",221:'[2322,"[379]"],[3222,8],9',222:'"[2-48]ABBB",8',223:'[2222,"[246-9]"],8',224:'[2222,3],[3222,"[67]"],[8,9]',225:"2222,8",226:'[2222,"[025-7]"],8',227:'[233,"08"],[2222,"[0289]"],8',228:'[2222,"[279]"],8',229:"2222,8",230:'[34,"[2-46]|8[013]"],[44,5],[7,8]',231:'[133,"[45]"],[233,2],[234,"[23578]"],[7,8,9]',232:"26,8",233:'[234,"[235]"],9',234:'["CCd","[7-9]"],["CDe","[78]"],["CEf","[78]"],10',235:"2222,8",236:"2222,8",237:'[2222,88],[12222,"[26]"],[8,9]',238:"322,7",239:"34,7",240:'[333,"[235]"],[36,"[89]"],9',241:"[2222,0],8",242:'[234,"[02]"],[144,8],9',243:'[234,1],[333,"[89]"],9',244:'[333,"[29]"],9',245:'[333,"44|9[567]"],[34,40],[7,9]',246:"[34,3],7",247:"5",248:'[133,"[246]"],7',249:'[234,"[19]"],9',250:'["2BCC",2],["[7-9]BCC","[7-9]"],9',251:'"[1-59]ACD",9',252:'[17,"24|[67]"],["BA{5,7}","15|28|6[1-35-9]|799|9[2-9]"],[333,"3[59]|4[89]|6[24-6]|79|8[08]|90"],[8,9]',253:"2222,8",254:'["BA{5,7}","[24-6]"],[36,7],["CCd","[89]"],9',255:'["[24]ACD","[24]"],["[67]BCC","[67]"],["[89]BBD","[89]"],9',256:'[45,[202,2024]],[36,"[27-9]|4(6[45]|[7-9])"],[27,"[34]"],9',257:"2222,8",258:'["[28]ACd","2|8[2-7]"],["80ACC",80],9',260:'["[29]AG","[29]"],["800;CC",8],9',261:'[2232,"[23]"],9',262:'"[268]BBBB",9',263:'["7ACd",7],["86BCC","86[24]"],["CCd","2(1[39]|2[0157]|6[14]|7[35]|84)|329"],["[235]ACd","[23]9|54"],["[25]CA{3,5}",["(25|54)8","258[23]|5483"]],["8CF",86],["80ACD",80],[9,10]',264:'["8ACD","8[1235]"],["6ACd",6],["870;CC",870],9',265:'["2BCC",2],[3222,"[1789]"],9',266:"44,8",267:'["7ACC",7],8',268:'[44,"[027]"],8',269:"322,7",27:'[333,860],[234,"[1-9]"],9',290:"[4,5]",291:"133,7",297:"34,7",298:"6,6",299:"222,6",30:'[244,"21|7"],[46,"2(2|3[2-57-9]|4[2-469]|5[2-59]|6[2-9]|7[2-69]|8[2-49])"],[334,"[2689]"],10',31:'["[1-578]ACD","1[035]|2[0346]|3[03568]|4[0356]|5[0358]|7|8[4578]"],["[1-5]BCC","1[16-8]|2[259]|3[124]|4[17-9]|5[124679]"],["6;H","6[0-57-9]"],["66;G",66],["[89]0AA{4,7}","80|9"],[9,11]',32:"[3222,4],9",33:'[3222,8],[12222,"[1-79]"],9',34:'["[89]00;CC","[89]00"],["[5-9]BBBB","[568]|[79][0-8]"],9',350:"[35,2],8",351:'["2ACD","2[12]"],["[2-46-9]BCC","2[3-9]|[346-9]"],9',352:'[2223,20],[333,6],["BBBBb","2([0367]|4[3-8])"],["BBBA{1,5}","[3-57]|8[13-9]|9(0[89]|[2-579])|(2|80)[2-9]"],9',353:'["AdD",1],["BCd","[2569]|4[1-69]|7[14]"],[333,70],[333,81],[234,"[78]"],[433,1],[2134,8],[244,4],9',354:'[34,"[4-9]"],["3BCC",3],[7,8,9]',355:'["6[6-9];CD",6],9',356:'[44,"[2357-9]"],8',357:"26,8",358:'["CA{3,7}","([1-3]00|[6-8]0)"],["116C",116],["BA{4,10}","[14]|2[09]|50|7[135]"],["AA{4,11}","[25689][1-8]|3"],[6,7,8,9,10,11]',359:'[333,999],["BCd","48|8[7-9]|9[08]"],9',36:'["BCd","[2-9]"],9',370:'[134,"52[0-79]"],[323,"[7-9]"],[26,"37|4([15]|6[1-8])"],[35,"[3-6]"],8',371:'[233,"[269]|8[01]"],8',372:'["[3-79]BD",["[369]|4[3-8]|5([0-2]|5[0-478]|6[45])|7[1-9]","[369]|4[3-8]|5([02]|1([0-8]|95)|5[0-478]|6(4[0-4]|5[1-589]))|7[1-9]"]],["70;BD",70],["8000;CC",[800,8000]],["[458]Cd",["40|5|8(00|[1-5])","40|5|8(00[1-9]|[1-5])"]],[7,8]',373:'[233,"22|3"],["[25-7]BBC","2[13-9]|[5-7]"],["[89]BE","[89]"],8',374:'[26,"1|47"],[26,"4[1349]|[5-7]|9[1-9]"],[35,"[23]"],[323,"8|90"],8',375:'[2322,["17[0-3589]|2[4-9]|[34]","17([02358]|1[0-2]|9[0189])|2[4-9]|[34]"],"$1 $2-$3-$4"],[3222,["1(5[24]|6[235]|7[467])|2(1[246]|2[25]|3[26])","1(5[24]|6(2|3[04-9]|5[0346-9])|7([46]|7[37-9]))|2(1[246]|2[25]|3[26])"],"$1 $2-$3-$4"],[423,["1(5[169]|6[3-5]|7[179])|2(1[35]|2[34]|3[3-5])","1(5[169]|6(3[1-3]|4|5[125])|7(1[3-9]|7[0-24-6]|9[2-7]))|2(1[35]|2[34]|3[3-5])"],"$1 $2-$3"],["[89]BCD","8[01]|9"],["82ADD",82],["800;BA{2,4}",800],9',376:'[33,"[135-9]"],[44,1],[333,6],[6,9]',377:'[2222,"[39]"],[233,4],["6;BBBB",6],[332,8],[8,9]',378:'[2222,"[5-7]"],["0549;F",0,"($1) $2"],8',379:"10",380:'[333,["6[12][29]|(3[1-8]|4[136-8]|5[12457]|6[49])2|(56|65)[24]","6[12][29]|(35|4[1378]|5[12457]|6[49])2|(56|65)[24]|(3[1-46-8]|46)2[013-9]"]],[234,["4[45][0-5]|5(0|6[37])|6([12][018]|[36-8])|7|89|9[1-9]|(48|57)[0137-9]","4[45][0-5]|5(0|6(3[14-7]|7))|6([12][018]|[36-8])|7|89|9[1-9]|(48|57)[0137-9]"]],[45,"[3-6]"],["CCd","[89]"],9',381:'["[23]BA{4,9}","(2[389]|39)0"],["[1-3]AA{5,10}","1|2([0-24-7]|[389][1-9])|3([0-8]|9[1-9])"],["6AA{6,8}",6],["[89]BA{3,9}","[89]"],["7[26];A{4,9}","7[26]"],["7[08]AA{4,9}","7[08]"],[8,9,10]',382:'[233,"[2-57-9]|6[036-9]"],[8,9]',383:'[233,"[23][89]|4[3-79]"],[35,"[89]00"],333,8',385:'["1;DC",1],["[2-5]ACd","[2-5]"],["9ACd",9],["[67]ACd","[67]"],["80[01];Bc",8],["80[01];CC",8],[8,9]',386:'[1322,"[12]|3[24-8]|4[24-8]|5[2-8]|7[3-8]"],["[3-7]ACC","[37][01]|4[0139]|51|6"],["[89][09];A{3,6}","[89][09]"],["[58]BE","59|8[1-3]"],8',387:'[233,"6[1-356]|[7-9]"],[233,"[3-5]","$1 $2-$3"],[2223,6],[8,9]',389:'["2;CD",2],["[347]ACC","[347]"],["[58]BABB","[58]"],8',39:'["BdD","0[26]|55"],["0[26];DE","0[26]"],["0BdD","0[13-57-9][0159]"],["CA{3,6}",["0[13-57-9][0159]|8(03|4[17]|9[245])","0[13-57-9][0159]|8(03|4[17]|9(2|[45][0-4]))"]],["0CCD","0[13-57-9][2-46-8]"],["0CA{2,6}","0[13-57-9][2-46-8]"],["CCd",["[13]|8(00|4[08]|9[59])","[13]|8(00|4[08]|9(5[5-9]|9))"]],[344,3],[9,10]',40:'[234,"[23]1"],[333,"[23][3-7]|[7-9]"],9',41:'["[2-9]ACBB","[2-7]|[89]1"],["[89]BCC","8[047]|90"],[32322,860],9',420:'["[2-9]BCC","[2-8]|9[015-7]"],["96ACCC",96],["9ACCC","9[36]"],9',421:'["2;CCB",2,"$1/$2 $3 $4"],["[3-5]ACBB","[3-5]","$1/$2 $3 $4"],["[689]BCC","[689]"],9',423:'[322,"[237-9]"],[234,69],[333,6],7',43:'["1;A{3,12}",1],["5ADA{4,7}","5[079]"],["CA{3,10}","316|46|51|732|6(5[0-3579]|[6-9])|7([28]0)|[89]"],["DA{3,9}","2|3(1[1-578]|[3-8])|4[2378]|5[2-6]|6([12]|4[1-9]|5[468])|7(2[1-8]|35|4[1-8]|[5-79])"],[10,11,12,13]',44:'["Ee",["1(38|5[23]|69|76|94)","1((38|69)7|5(24|39)|768|946)","1(3873|5(242|39[4-6])|(697|768)[347]|9467)"]],["Df","1([2-69][02-9]|[78])"],[244,["[25]|7(0|6[024-9])","[25]|7(0|6([04-9]|2[356]))"]],[46,7],[334,"[1389]"],10',45:"2222,8",46:'["8;ccB",8],["[1-69]AcBB","1[013689]|2[0136]|3[1356]|4[0246]|54|6[03]|90"],[3222,"1[2457]|2([247-9]|5[0138])|3[0247-9]|4[1357-9]|5[0-35-9]|6([124-689]|7[0-2])|9([125-8]|3[0-5]|4[0-3])"],["7ACBB",7],["9[034]ABBC","9[034]"],[32322,"25[245]|67[3-6]"],9',47:'["[489]BBC","[489]"],["[235-7]ABBB","[235-7]"],8',48:'[2322,"[14]|2[0-57-9]|3[2-4]|5[24-689]|6[1-3578]|7[14-7]|8[1-79]|9[145]"],[333,"26|39|5[0137]|6[0469]|7[02389]|8[08]"],9',49:'["BA{3,13}","3[02]|40|[68]9"],["CA{3,12}",["2(0[1-389]|1[124]|2[18]|3[14])|3([35-9][15]|4[015])|906|(2[4-9]|4[2-9]|[579][1-9]|[68][1-8])1","2(0[1-389]|12[0-8])|3([35-9][15]|4[015])|906|2([13][14]|2[18])|(2[4-9]|4[2-9]|[579][1-9]|[68][1-8])1"]],["DA{2,11}",["[24-6]|3([3569][02-46-9]|4[2-4679]|7[2-467]|8[2-46-8])|70[2-8]|8(0[2-9]|[1-8])|90[7-9]|[79][1-9]","[24-6]|3(3(0[1-467]|2[127-9]|3[124578]|7[1257-9]|8[1256]|9[145])|4(2[135]|4[13578]|9[1346])|5(0[14]|2[1-3589]|6[1-4]|7[13468]|8[13568])|6(2[1-489]|3[124-6]|6[13]|7[12579]|8[1-356]|9[135])|7(2[1-7]|4[145]|6[1-5]|7[1-4])|8(21|3[1468]|6|7[1467]|8[136])|9(0[12479]|2[1358]|4[134679]|6[1-9]|7[136]|8[147]|9[1468]))|70[2-8]|8(0[2-9]|[1-8])|90[7-9]|[79][1-9]|3[68]4[1347]|3(47|60)[1356]|3(3[46]|46|5[49])[1246]|3[4579]3[1357]"]],[34,138],["EA{2,10}",3],["CA{5,11}",181],["CAA{4,10}","1(3|80)|9"],["Ch","1[67]"],["CA{7,12}",8],[56,[185,1850,18500]],[344,7],[47,"18[68]"],[56,"15[0568]"],[47,"15[1279]"],[38,18],["CBh","1(6[023]|7)"],[427,"15[279]"],[328,15],[7,8,9,10,11,12]',500:"5",501:'[34,"[2-8]",1],["0;800;DC",0,1],7',502:'[44,"[2-7]"],[434,1],8',503:'[44,"[267]"],[344,"[89]"],8',504:'[44,"[237-9]",1],8',505:"44,8",506:'[44,"[24-7]|8[3-9]"],[334,"[89]0",1],8',507:"[44,6,1],8",508:'"[45]ABB",6',509:"224,8",51:"[333,9],9",52:'[244,"33|5[56]|81"],[334,"[2-9]"],[1244,"1(33|5[56]|81)"],[1334,1],[10,11]',53:'["Ag",7],["BA{4,6}","[2-4]"],[17,5],8',54:'[424,["2(2[024-9]|3[0-59]|47|6[245]|9[02-8])|3(3[28]|4[03-9]|5[2-46-8]|7[1-578]|8[2-9])","2([23]02|6([25]|4[6-8])|9([02356]|4[02568]|72|8[23]))|3(3[28]|4([04679]|3[5-8]|5[4-68]|8[2379])|5([2467]|3[237]|8[2-5])|7[1-578]|8([2469]|3[2578]|5[4-8]|7[36-8]|8[5-8]))|2(2[24-9]|3[1-59]|47)","2([23]02|6([25]|4(64|[78]))|9([02356]|4([0268]|5[2-6])|72|8[23]))|3(3[28]|4([04679]|3[78]|5(4[46]|8)|8[2379])|5([2467]|3[237]|8[23])|7[1-578]|8([2469]|3[278]|5[56][46]|86[3-6]))|2(2[24-9]|3[1-59]|47)|38([58][78]|7[378])|3(4[35][56]|58[45]|8([38]5|54|76))[4-6]","2([23]02|6([25]|4(64|[78]))|9([02356]|4([0268]|5([24-6]|3[2-5]))|72|8[23]))|3(3[28]|4([04679]|3(5(4[0-25689]|[56])|[78])|58|8[2379])|5([2467]|3[237]|8([23]|4([45]|60)|5(4[0-39]|5|64)))|7[1-578]|8([2469]|3[278]|54(4|5[13-7]|6[89])|86[3-6]))|2(2[24-9]|3[1-59]|47)|38([58][78]|7[378])|3(454|85[56])[46]|3(4(36|5[56])|8([38]5|76))[4-6]"],"$1 $2-$3"],[244,1,"$1 $2-$3"],[334,"[23]","$1 $2-$3"],[334,"[68]",1],[1424,["9(2[2-469]|3[3-578])","9(2(2[024-9]|3[0-59]|47|6[245]|9[02-8])|3(3[28]|4[03-9]|5[2-46-8]|7[1-578]|8[2-9]))","9(2([23]02|6([25]|4[6-8])|9([02356]|4[02568]|72|8[23]))|3(3[28]|4([04679]|3[5-8]|5[4-68]|8[2379])|5([2467]|3[237]|8[2-5])|7[1-578]|8([2469]|3[2578]|5[4-8]|7[36-8]|8[5-8])))|92(2[24-9]|3[1-59]|47)","9(2([23]02|6([25]|4(64|[78]))|9([02356]|4([0268]|5[2-6])|72|8[23]))|3(3[28]|4([04679]|3[78]|5(4[46]|8)|8[2379])|5([2467]|3[237]|8[23])|7[1-578]|8([2469]|3[278]|5([56][46]|[78])|7[378]|8(6[3-6]|[78]))))|92(2[24-9]|3[1-59]|47)|93(4[35][56]|58[45]|8([38]5|54|76))[4-6]","9(2([23]02|6([25]|4(64|[78]))|9([02356]|4([0268]|5([24-6]|3[2-5]))|72|8[23]))|3(3[28]|4([04679]|3(5(4[0-25689]|[56])|[78])|5(4[46]|8)|8[2379])|5([2467]|3[237]|8([23]|4([45]|60)|5(4[0-39]|5|64)))|7[1-578]|8([2469]|3[278]|5(4(4|5[13-7]|6[89])|[56][46]|[78])|7[378]|8(6[3-6]|[78]))))|92(2[24-9]|3[1-59]|47)|93(4(36|5[56])|8([38]5|76))[4-6]"],"$1 $2 $3-$4"],[1244,91,"$1 $2 $3-$4"],[1334,9,"$1 $2 $3-$4"],[10,11]',55:'[244,"[1-9][1-9]","$1 $2-$3"],[254,"([14689][1-9]|2[12478]|3[1-578]|5[1-5]|7[13-579])9","$1 $2-$3"],["[3589]00;cD","[3589]00"],[10,11]',56:'[144,"2[23]"],[234,"[357]|4[1-35]|6[13-57]"],["9;DD",9],["44;CD",44],["[68]00;Cd","60|8"],["600;CBC",60],["1230;CD",1],[54,219],9',57:'[17,["1(8[2-9]|9[0-3]|[2-7])|[24-8]","1(8[2-9]|9(09|[1-3])|[2-7])|[24-8]"]],[37,3],["1;CG",["1(80|9[04])","1(800|9(0[01]|4[78]))"]],[8,10]',58:"[37,-1,1],10",590:'["[56]90;BD",-1,"$1 $2-$3"],9',591:'[17,"[23]|4[46]"],[8,"[67]"],[324,8],8',592:"34,7",593:'[134,"[247]|[356][2-8]",1],[234,9],["1800;Cd",1],[8,9]',594:"3222,9",595:'["BCd","([26]1|3[289]|4[124678]|7[123]|8[1236])"],["CA{3,6}","[2-9]0"],[36,"9[1-9]"],[234,8700],[333,"[2-8][1-9]"],9',596:"3222,9",597:'[34,"[6-8]",1],7',598:'[233,9],[44,"[24]"],8',599:'[34,"[13-7]"],["9;CD",9],[7,8]',60:'["3;DD",3,"$1-$2 $3"],["[18]ACd","1[02-46-9][1-9]|8","$1-$2 $3"],["1;[36-8]00;BD","1[36-8]0",1],["11;DD",11,"$1-$2 $3"],["15[49];CD",15,"$1-$2 $3"],[9,10]',61:'["BCA{2,4}",16],[333,"14|[45]"],[144,"[2378]"],[433,"1(30|[89])"],9',62:'["BA{5,9}","2[124]|[36]1"],["CA{5,7}",800],["CA{5,8}","[2-79]"],["CdC","8[1-35-9]",1],["CA{6,8}",1],[334,804],[3133,80],["CDe",8,1],[2434,0],[9,10,11,12]',63:'["DA{4,6}",["3(23|39|46)|4(2[3-6]|[35]9|4[26]|76)|544|88[245]|(52|64|86)2","3(230|397|461)|4(2(35|[46]4|51)|396|4(22|63)|59[347]|76[15])|5(221|446)|642[23]|8(622|8([24]2|5[13]))"]],[334,"[89]"],[434,1],["DbCD",1],10',64:'[323,"[89]0"],[134,"24|[346]|7[2-57-9]|9[2-9]","$1-$2 $3"],["CCd","2(10|74)|[59]|80"],["BdD","2[028]"],["BCA{3,5}","2([169]|7[0-35-9])|7|86"],[8,9,10]',65:'["[3689]CD","[369]|8[1-9]"],["1[89]00;CD","1[89]"],["7000;DC",70],["800;CD",80],8',66:'["BCd","14|[3-9]"],[433,1],9',670:"[44,7],8",672:"[24,1],[15,3],[5,6]",673:'"[2-578]BD",7',674:"34,7",675:'[34,"[13-689]|27"],[44,"20|7"],[7,8]',676:'[34,"7[5-9]|8[47-9]"],[43,0],7',677:'[25,"[7-9]"],7',678:'[34,"[579]"],7',679:'[34,"[35-9]"],[434,0],7',680:"34,7",681:"222,6",682:"23,5",683:"4",685:'["8Bd",8],["7AE",7],[6,7]',686:"8",687:'[222,"[2-46-9]|5[0-4]","$1.$2.$3"],6',688:"[6,7]",689:'[2222,"4[09]|8[79]"],[222,44],[6,8]',690:"[4,5,6,7]",691:"34,7",692:"[34,-1,1],7",7:'[4222,["7(1[0-8]|2[1-9])","7(1([0-6]2|7|8[27])|2(1[23]|[2-9]2))","7(1([0-6]2|7|8[27])|2(13[03-69]|62[013-9]))|72[1-57-9]2"]],[5122,["7(1[0-68]|2[1-9])","7(1([06][3-6]|[18]|2[35]|[3-5][3-5])|2([13][3-5]|[24-689]|7[457]))","7(1(0([356]|4[023])|[18]|2(3[013-9]|5)|3[45]|43[013-79]|5(3[1-8]|4[1-7]|5)|6(3[0-35-9]|[4-6]))|2(1(3[178]|[45])|[24-689]|3[35]|7[457]))|7(14|23)4[0-8]|71(33|45)[1-79]"]],[334,7],[3322,"[3489]","$1 $2-$3-$4"],10',81:'[334,800,1],["DBd","0077",1],[424,"0088",1],["DCd","00(37|66)",1],["DDe","00(37|66)",1],["DEf","00(37|66)",1],["DFg","00(37|66)",1],[244,"[2579]0|80[1-9]",1],10',82:'["AdD",2,1],[234,"60|8",1],["BdD","[1346]|5[1-5]",1],[244,"[57]",1],[533,["003","0030"]],[254,5,1],["EdD",0],[5234,0],[9,10]',84:'[244,"2[48]"],[343,"2[0-35-79]"],["[89]ACBB","8(8|9[89])|9"],["1[2689]ACD","1([26]|8[68]|99)"],["[3578]ACD","[357]|8[1-5]"],["86[89];CC","86[89]"],["1[89]00;A{4,6}",["1[89]0","1[89]00"]],[9,10]',850:"[334,1],10",852:'[44,"[235-7]|[89](0[1-9]|[1-9])"],["800;CC",800],["900;BCC",900],["900;A{2,5}",900],8',853:'"[268]CD",8',855:'["BCd","[1-9]"],[433,1],[8,9]',856:"[2233,2],10",86:'["21;DA{4,6}",21],[344,"3(11|7[179])|4([15]1|3[1-35])|5(1|2[37]|3[12]|51|7[13-79]|9[15])|7(31|5[457]|6[09]|91)|8([57]1|98)"],[434,[807,8078]],[344,"1[3-578]"],["10800;CD",[108,1080,10800]],["Ch",950],11',880:'["CA{3,7}","3([67]|8[013-9])|4(6[168]|7|[89][18])|5(6[128]|9)|6(28|4[14]|5)|7[2-589]|8(0[014-9]|[12])|9[358]|(3[2-5]|4[235]|5[2-578]|6[0389]|76|8[3-7]|9[24])1|(44|66)[01346-9]",1],["DA{3,6}","[13-9]",1],10',886:'["AdD","[25][2-8]|[346]|7[1-9]|8[237-9]"],[234,"[258]"],[333,9],[244,7],9',90:'[334,"512|8[0589]|90"],[3322,["5([0-59]|61)","5([0-59]|616)","5([0-59]|6161)"]],[3322,"[24][1-8]|3[1-9]"],10',91:'[55,["600|7([02-8]|19|9[037-9])|8(0[015-9]|[1-9]|20)|9","600|7([078]|19[0-5]|2([02356-9]|[14][017-9]|9[389])|3([025-9]|1[07-9]|[34][017-9])|4([0-35689]|[47][017-9])|5([02346-9]|1[017-9]|5[017-9])|6([02-9]|1[0-257-9])|9([089]|31|7[02-9]))|8(0([01589]|6[67]|7[02-9])|1([0-57-9]|6[07-9])|2(0[078]|[14][07-9]|[235-9])|3([0357-9]|[126][07-9]|4[1-9])|[45]|6([02457-9]|[136][07-9])|7([078][07-9]|[1-69])|8([0-25-9]|3[07-9]|4[047-9])|9([02-9]|1[027-9]))|9","600|7(0|19[0-5]|2([0235679]|[14][017-9]|8([0-569]|[78][089])|9[389])|3([05-8]|1([089]|7[5-9])|2([5-8]|[0-49][089])|3[017-9]|4([07-9]|11)|9([01689]|[2345][089]|40|7[0189]))|4([056]|1([0135-9]|[23][089]|2[089]|4[089])|2(0[089]|[1-7][089]|[89])|3([0-8][089]|9)|4([089]|11|7[02-8])|7([089]|11|7[02-8])|8([0-24-7][089]|[389])|9([0-7][089]|[89]))|5([0346-9]|1[017-9]|2([03-9]|[12][089])|5[017-9])|6([0346-9]|1[0-257-9]|2([0-4].|[5-9][089])|5([0-367][089]|[4589]))|7(0([02-9]|1[089])|[1-9])|8([0-79]|8(0[0189]|11|8[013-9]|9))|9([089]|313|7([02-8]|9[07-9])))|8(0([01589]|6[67]|7([02-8]|9[05-9]))|1([02-57-9]|1([0-35-9]|4[0-46-9])|6([089]|7[02-8]))|2(0([08]|7[02])|[14]([089]|7[02-8])|[235-9])|3([0357-9]|1([089]|7[02-6])|2([09]|77|8[0-689])|4[1-9]|6([089]|7[02-7]))|[45]|6([02457-9]|1([089]|7[02-8])|3([089]|7[02358])|6([08]|7[02-8]|9[01]))|7(0[07-9]|[1-69]|7([089]|7[02-8])|8([089]|7[02-8]))|8([0-25-9]|3([089]|7[02-8])|4([0489]|7[02-68]))|9([02-9]|1([0289]|7[2-6])))|9"]],[244,"11|2[02]|33|4[04]|79[1-9]|80[2-46]"],[334,"1(2[0-249]|3[0-25]|4[145]|[569][14]|7[1257]|8[1346]|[68][1-9])|2(1[257]|3[013]|4[01]|5[0137]|6[0158]|78|8[1568]|9[14])|3(26|4[1-3]|5[34]|6[01489]|7[02-46]|8[159])|4(1[36]|2[1-47]|3[15]|5[12]|6[0-26-9]|7[0-24-9]|8[013-57]|9[014-7])|5(1[025]|[36][25]|22|4[28]|5[12]|[78]1|9[15])|6(12|[2345]1|57|6[13]|7[14]|80)|7(12|2[14]|3[134]|4[47]|5[15]|[67]1|88)|8(16|2[014]|3[126]|6[136]|7[078]|8[34]|91)"],[433,"1([23579]|[468][1-9])|[2-8]"],[2343,"008"],[334,140],[424,[160,1600]],["DA{2,4};D",[180,1800]],["DdD",[186,1860]],[4333,"18[06]"],10',92:'["Bh","(2[125]|4[0-246-9]|5[1-35-7]|6[1-8]|7[14]|8[16]|91)[2-9]"],["Cg",["2(3[2358]|4[2-4]|9[2-8])|45[3479]|54[2-467]|60[468]|72[236]|8(2[2-689]|3[23578]|4[3478]|5[2356])|9(2[2-8]|3[27-9]|4[2-6]|6[3569]|9[25-8])","9(2[3-8]|98)|(2(3[2358]|4[2-4]|9[2-8])|45[3479]|54[2-467]|60[468]|72[236]|8(2[2-689]|3[23578]|4[3478]|5[2356])|9(22|3[27-9]|4[2-6]|6[3569]|9[25-7]))[2-9]"]],[55,58],[37,3],[2333,"2[125]|4[0-246-9]|5[1-35-7]|6[1-8]|7[14]|8[16]|91"],[3333,"[24-9]"],10',93:'["[2-7]ACD","[2-7]"],9',94:'[234,7],[333,"[1-689]"],9',95:'["ACd","[12]"],["BCd","[4-7]|8[1-35]"],["ACA{4,6}","9(2[0-4]|[35-9]|4[137-9])"],[144,2],[334,8],[1333,92],[154,9],[8,9,10]',960:'[34,"[3467]|9([1-9]|0[1-9])",1],[334,"[89]00"],7',961:'[133,"[13-69]|7([2-57]|62|8[0-7]|9[04-9])|8[02-9]"],[233,"[7-9]"],[7,8]',962:'["7;DD","7[457-9]"],["Cf","70|8[0158]|9"],9',963:'["BCd","[1-5]"],["9BCC",9],9',964:'["BCd","[2-6]"],[334,7],[9,10]',965:'["Dd","[169]|2([235]|4[1-35-9])|52"],[35,"[25]"],8',966:'[45,9],[234,1],[234,5],["CCd",81],[334,8],9',967:'["7BCC","7[0137]"],9',968:'["CA{4,6}","[58]"],[26,2],[44,"[79]"],8',970:'["5[69]ACC",5],["1[78]00;CC","1[78]"],9',971:'["CA{2,9}","60|8"],[315,"[479]"],[234,5],9',972:'[234,"[57]",1],[433,12,1],[46,159,1],[1333,"1[7-9]",1],["CbCD",15,"$1-$2 $3-$4"],9',973:"44,8",974:'["[3-7]CD","[3-7]"],8',975:'[2222,"1|77"],8',976:'["[12]ABD","[12]1"],["[12]2Af","[12]2[1-3]"],["[12]CE",["[12](27|[3-5])","[12](27|[3-5].)2"]],[44,"[57-9]"],["[12]De",["[12](27|[3-5])","[12](27|[3-5].)[4-9]"]],8',977:'["9BG","9(6[013]|7[245]|8)",1],10',98:'[244,"[1-8]"],["CCd",9],10',992:'[612,[331,3317]],[324,"[34]7|91[78]"],[414,3],[234,"[457-9]"],9',993:'[2222,12,"$1 $2-$3-$4"],[26,6],[3122,"13|[2-5]","$1 $2-$3-$4"],8',994:'[3222,9],[2322,["[12]|365","[12]|365","[12]|365([0-46-9]|5[0-35-9])"]],[2322,"[3-8]"],9',995:'[3222,"[348]"],[333,7],[3222,5],9',996:'[45,"3(1[346]|[24-79])"],[333,"[235-79]"],["CCAc",8],9',998:'[2322,"[679]"],[7,8,9]'}},35228:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createDeflate=function(e={}){return new n(e)},t.inflate=function(e){return(0,a.decompressSync)(e)},t.GzipWrapper=void 0;var a=r(37993);class n extends a.Gzip{constructor(e){super(e),this._chunks=[],this.ondata=(e,t)=>{if(this._chunks.push(e),t){var r=0;this._chunks.forEach((e=>{r+=e.length}));var a=new Uint8Array(r),n=0;this._chunks.forEach((e=>{a.set(e,n),n+=e.length})),this._result=a}}}push(e,t){if(null!=this._result)throw new Error("Tried to push chunk to compressor after final block");e instanceof Uint8Array?super.push(e,t):e instanceof ArrayBuffer?super.push(new Uint8Array(e),t):super.push((0,a.strToU8)(e),t)}result(){if(null==this._result)throw new Error("Tried to access result before adding final block");return this._result}}t.GzipWrapper=n},8320:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.randomHex=function(e){var t=new Uint8Array(e);return self.crypto.getRandomValues(t),n(t)},t.toHex=n,t.toLowerCaseHex=function(e){for(var t=[],r=0;r<e.length;r++){var n=e[r];t.push(a[n>>4],a[15&n])}return String.fromCharCode.apply(String,t)},t.parseHex=function(e){var t=s(e);if(t.length%2!=0)throw new Error('parseHex given hex "'.concat(t,'" which is not a multiple of 8-bits.'));for(var r=new Uint8Array(t.length>>1),a=0,n=0;a<t.length;a+=2,n++)r[n]=i(t,a)<<4|i(t,a+1);return r.buffer},t.hexAt=i,t.hexOrThrow=s,t.bytesToBuffer=function(e){var t=e.buffer;return 0===e.byteOffset&&e.length===t.byteLength?t:t.slice(e.byteOffset,e.byteOffset+e.length)},t.bytesToDebugString=function(e){var t=!0,r=e.length;for(;t&&r;){var a=e[--r];t=32<=a&&a<127}return t?JSON.stringify(String.fromCharCode.apply(String,e)):n(e)},t.createHexLong=function(e,t=!1){var r=s(e);return function(e,t){if(e.length>t)throw new Error('"'.concat(e,'" is longer than ').concat(4*t," bits."))}(r,16),"".concat(t?"-":"","0x").concat(o(r,16))},t.createHexLongFrom32Bits=function(e,t,r=!1){var a=l(e),n=l(t);return"".concat(r?"-":"","0x").concat(a).concat(n)},t.hexLongToHex=function(e){return e.substring(e.indexOf("0x")+2)},t.hexLongIsNegative=u,t.negateHexLong=function(e){return u(e)?e.slice(1):"-"+e},t.HEX_LOWER=t.NUM_HEX_IN_LONG=void 0;t.NUM_HEX_IN_LONG=16;var r=[48,49,50,51,52,53,54,55,56,57,65,66,67,68,69,70],a=[48,49,50,51,52,53,54,55,56,57,97,98,99,100,101,102];function n(e){for(var t=[],a=0;a<e.length;a++){var n=e[a];t.push(r[n>>4],r[15&n])}return String.fromCharCode.apply(String,t)}function i(e,t){var r=e.charCodeAt(t);return r<=57?r-48:r<=70?10+r-65:10+r-97}function s(e){if(/[^0-9a-fA-F]/.test(e))throw new Error('"'.concat(e,'" is not a valid hex'));return e}function o(e,t){for(var r=t-e.length,a=e,n=0;n<r;n++)a="0"+a;return a}function u(e){return"-"===e[0]}function l(e){if(e>4294967295||e<-4294967296)throw new Error("uint32ToLowerCaseHex given number over 32 bits");return o((e>=0?e:4294967296+e).toString(16),8)}t.HEX_LOWER=a},6380:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.inflatePhoneRegex=function(e){var t;t="number"==typeof e?String(e).split("").map((e=>".".repeat(Number(e)))).join(")("):e.replace(/;|[a-zA-Z]+/g,(e=>";"===e?")(":e.split("").map((e=>{var t=e.charCodeAt(0);return t>=97?".".repeat(t-96)+"?":".".repeat(t-64)})).join(")(")));return"(".concat(t,")")}},41263:(e,t,r)=>{"use strict";var a=r(34398);Object.defineProperty(t,"__esModule",{value:!0}),t.toJid=function(e){return"".concat(e).concat(s)},t.toGroupJid=function(e){return"".concat(e).concat(o)},t.toBroadcastJid=function(e){return"".concat(e).concat("@broadcast")},t.groupIdFromJid=function(e){if(!e.endsWith(o))throw new Error('groupId called with non-group jid "'.concat(e,'"'));return e.slice(0,-o.length)},t.phoneNumberFromJid=u,t.interpretAsUserJid=l,t.interpretAsGroupJid=function(e){return e.endsWith(o)?e:null},t.extractUserJid=function(e){var[t,r]=e.split("@");return t=(t=t.split(":")[0]).split(".")[0],"".concat(t,"@").concat(r)},t.extractDeviceId=d,t.toDeviceJid=c,t.defaultDeviceJidForUser=function(e){return c(e,0)},t.isPrimaryDevice=function(e){return 0===d(e)},t.interpretAsDeviceId=function(e){return e},t.parseJidParts=f,t.fullFormDeviceJidString=function(e){var{user:t,agent:r="0",device:a="0",server:n}=f(e);return"".concat(t,".").concat(r,":").concat(a,"@").concat(n)},t.stripAgentIdFromDeviceJid=function(e){var{user:t,device:r="0",server:a}=f(e);return"".concat(t,":").concat(r,"@").concat(a)},t.extractFromJid=function(e){switch(e.jidType){case"user":return e.userJid;case"group":return e.groupJid;case"status":return e.statusJid;case"device":return e.deviceJid;case"broadcast":return e.broadcastJid;default:return(0,n.default)(e.jidType)}},t.interpretAndValidateJid=function(e){return e===i?{jidType:"status",statusJid:i}:p.test(e)?{jidType:"user",userJid:e}:m.test(e)?{jidType:"device",deviceJid:e}:h.test(e)?{jidType:"group",groupJid:e}:_.test(e)?{jidType:"broadcast",broadcastJid:e}:{jidType:"unknown"}},t.asChatJid=function(e){return e===i?null:e},t.switchOnMulticastJidType=function(e,t){if(e===i)return t.multicast(e);return g(e,{user:t.user,group:t.multicast})},t.switchOnJidType=function(e,t){if(e===i)return t.status();return g(e,{user:t.user,group:t.group})},t.switchOnChatJidType=g,t.asStatusJid=function(e){return e===i?i:null},t.asMulticastJid=function(e){return null==l(e)?e:null},t.DEFAULT_DEVICE_ID=t.SURVEY_USER_JID=t.GROUP_CALL_DOMAIN=t.GROUP_DOMAIN=t.USER_DOMAIN=t.STATUS_JID=void 0;var n=a(r(90432)),i="status@broadcast";t.STATUS_JID=i;var s="@s.whatsapp.net";t.USER_DOMAIN=s;var o="@g.us";t.GROUP_DOMAIN=o;t.GROUP_CALL_DOMAIN="@call";function u(e){if(!e.endsWith(s))throw new Error('phoneNumberFromJid called with non-user jid "'.concat(e,'"'));return e.slice(0,-s.length)}function l(e){return e.endsWith(s)?e:null}function d(e){return parseInt(e.split(":")[1],10)}function c(e,t){return"".concat(u(e),":").concat(t).concat(s)}t.SURVEY_USER_JID="16505361212@s.whatsapp.net";function f(e){var[t,r]=e.split("@"),[a,n]=t.split(":"),[i,s]=a.split(".");return{user:i,device:n,agent:s,server:r}}t.DEFAULT_DEVICE_ID=0;var p=/^(0|(?!10)[1-9][0-9]{4,19})@s.whatsapp.net$/,h=/^([1-9][0-9]{0,19}|(?!10)[1-9][0-9]{4,19}-[1-9][0-9]{9})@g.us$/,_=/^[0-9]+@broadcast$/,m=/^(0|(?!10)[1-9][0-9]{4,19}(\.[0-9]{1,2})?(:[0-9]{1,2}))@s.whatsapp.net$/;function g(e,t){var r;if(e.endsWith(s)?r=t.user:e.endsWith(o)&&(r=t.group),!r)throw new Error("Can not switch on chat jid ".concat(e));return r(e)}},28721:(e,t,r)=>{"use strict";var a=r(34398);Object.defineProperty(t,"__esModule",{value:!0}),t.findCC=f,t.formatPhone=p,t.extractDigits=function(e){var t=e.match(/\d+/g);return null!=t?t.join(""):""},t.isPotentiallyPhoneNumber=function(e){return h.test(e)},t.isPotentiallyValid=function(e,t){if(!/^\d+$/.test(t))return!1;var r=d[e]||c(e);return!!r&&("number"==typeof r.lengths?r.lengths===t.length:r.lengths.includes(t.length))},t.formattedPhoneNumber=function(e){return p((0,s.phoneNumberFromJid)(e))},t.phoneCC=function(e){return f(e)};var n=a(r(6893)),i=r(6380),s=r(41263),o=/^(1|2[07]|3[0-469]|4[013-9]|5[1-8]|6[0-6]|7|8[1246]|9[0-58])/,u=new Map;class l{constructor(e){var t;if(Array.isArray(e)){t=e[0];var r=e[1];null!=r&&-1!==r&&(Array.isArray(r)||(r=[r]),this._leadins=r.map((function(e){return new RegExp("^("+e+")")}))),this._formatString=e[2]}else t=e;this._regex=new RegExp("^".concat((0,i.inflatePhoneRegex)(t),"$"))}_testAndFormat(e){if(!this._regex.test(e)||!this._checkLeadins(e))return!1;if("string"==typeof this._formatString)return e.replace(this._regex,this._formatString);var t=this._regex.exec(e);return null!=t?t.slice(1).join(null!=this._formatString?"-":" "):void 0}_checkLeadins(e){return!this._leadins||this._leadins.some((function(t){return t.test(e)}))}}var d={};function c(e){var t=null!=n.default[e]?JSON.parse("[".concat(n.default[e],"]")):null;if(null==t)return null;var r=t.pop();return d[e]={lengths:r,formats:t.map((function(e){return new l(e)}))}}function f(e){var t=e.match(o);return t?t[0]:e.length>=3?e.substring(0,3):e}function p(e){var t=u.get(e);return null==t&&(t=function(e){var t=e.length>0&&"+"===e[0]?e.substring(1):e,r=f(t);if(!r)return t;var a=t.substring(r.length),n=d[r]||c(r);if(!n)return"+"+r+" "+a;for(var i=n.formats,s=0;s<i.length;s++){var o=i[s]._testAndFormat(a);if(null!=o&&!1!==o&&""!==o)return"+"+r+" "+o}return"+"+r+" "+a}(e),u.set(e,t)),t}var h=/^\+*[\d ()]+$/},18535:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.nullaryCacheWhilePending=function(e){var t=null,r=()=>(t||(t=(0,a.callSyncPromise)(e).finally((()=>{t=null}))),t);return r.isPending=()=>!!t,r},t.cacheWhilePending=function(e,t){var r=new Map;return a=>{var n,i=e(a),s=r.get(i);if(s)return s;try{n=Promise.resolve(t(a))}catch(e){n=Promise.reject(e)}var o=n.finally((()=>{r.delete(i)}));return r.set(i,o),o}},t.preventGarbageCollection=function(e){n.add(e),e.finally((()=>{n.delete(e)}))};var a=r(73559);var n=new Set},10462:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.length=function(e){var t=e.match(r);return t?t.length:0},t.substring=function(e,t=0,a){var n=e.match(r);return n?n.slice(Math.max(0,t),Math.max(0,a)).join(""):""},t.toArray=function(e){return e.match(r)||[]},t.astralRange=void 0;var r=/\ud83c[\udffb-\udfff](?=\ud83c[\udffb-\udfff])|(?:[^\ud800-\udfff][\u0300-\u036f\ufe20-\ufe23\u20d0-\u20f0]?|[\u0300-\u036f\ufe20-\ufe23\u20d0-\u20f0]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff])[\ufe0e\ufe0f]?(?:[\u0300-\u036f\ufe20-\ufe23\u20d0-\u20f0]|\ud83c[\udffb-\udfff])?(?:\u200d(?:[^\ud800-\udfff]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff])[\ufe0e\ufe0f]?(?:[\u0300-\u036f\ufe20-\ufe23\u20d0-\u20f0]|\ud83c[\udffb-\udfff])?)*/g;t.astralRange=r},79255:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.findSuspiciousCharacters=function(e,t,r,o){var u,f=e.split("."),p=!1;if(f.forEach((e=>{if(p=!e.match(c)){if(u)return null;u=e}})),null==u||p)return null;for(var h=[],_=!0,m=(0,a.toArray)(u),g=0;g<m.length;g++){var v=m[g];if(!(_=_&&d(v))&&i[v]){if(h.length>=2)return null;h.push(v)}}if(_)return l(r)||l(t)||o.some((e=>function(e){return s.has(e)}(e)))?null:new Set(m);if(!h.length)return null;var E=h.filter((e=>{var a=i[e];if(null==a)return!1;if(o.some((e=>a.includes(e))))return!1;for(var s=new Set,u=0;u<a.length;u++){var l=n.LANGUAGE_TO_REGIONS[a[u]];if(null!=l)for(var d=0;d<l.length;d++)s.add(l[d])}return!s.has(r)&&!s.has(t)}));return E.length?new Set(E):null};var a=r(10462),n=r(88477),i={:["ast","ksf","bas","ca","cs","dua","nl","ee","ewo","fo","fr","gl","kl","hu","is","ga","dyo","kea","kkj","nmg","lkt","lag","ln","lu","mas","nnh","jgo","pt","qu","seh","sk","es","to","vai","vi","wae","cy","fy","yav","yo"],:["af","agq","bss","bfd","bas","bkv","btt","nl","igb","ewo","fr","fur","gaj","gby","kl","jab","atg","jbu","kkj","naq","ksh","ku","nmb","lmp","ln","mda","mg","mas","mzm","jgo","nin","ann","ro","sg","scn","srn","yer","tr","wa","cy","yav","yle"],:["agg","ast","az","br","ca","co","cs","nl","etr","et","fr","gl","de","tof","god","hu","tbd","geb","ksh","kup","nds","lb","arn","oc","sg","sk","es","gsw","dts","tr","tk","vo","wa","wae","fy","yll"],:["mt"],:["agq","bss","bfd","bas","bkv","btt","ddn","igb","kjy","ich","gux","haw","jab","iby","idu","jbu","kub","nmg","lv","mda","mi","mas","mql","nin","prg","gd","to","yba","yav"],:["az","crh","tr"],:["lv"],:["dsb","nv","pl","hsb"],:["bs","hr","cs","dzg","et","fi","smn","geb","khq","ses","kun","lkt","lv","lt","dsb","se","nso","prg","sr","sh","sms","sk","sl","taq","twq","tuq","hsb","wqe","dje"],:["ckl","ank","ha","ikx","kai","hia","mbu","anc","nin","pip","tal","tan","wja","wji"],:["naq"],:["naq"],:["liv"],:["fmp","dud","tmh"],:["fub","yay","bkc","bjt","bcn","bas","bsq","bmq","fue","bys","bwr","cky","fuq","ckl","asg","dbq","dnj","dgh","dow","dua","enn","ff","gby","gba","gmm","ank","gde","gkp","jgk","ha","hbb","ikx","kkj","hig","kzr","kai","kpe","nmg","hia","ffm","mbo","mbu","mif","mzm","mua","sur","anc","fuv","nin","dgi","pbi","pip","fuf","cla","sav","srr","sld","sok","tal","tan","yer","ttr","tik","kdl","tsw","vai","vut","wja","wji","fuh","gnd"],:["tzm","kab","okr","shi","tmh","taq"],:["tzm","kab","shi"],:["tzm","kab","shi","tmh","taq"],:[],:["izi","yaz","blt","vi"],:["yay","bom","bin","mfn","dzg","igb","enn","gkn","iby","ikk","ikw","izi","okr","yaz","blt","tan","tuq","vi","yo"],:["avu","mfn","igb","enn","iby","ig","ige","ikk","ikw","izi","okr","blt","tan","vi"]},s=new Set(["abq","ab","ady","av","az","ba","be","bs","bg","bua","ce","ckt","cu","cv","crh","dar","dng","myv","evn","gag","inh","kbd","xal","krc","kaa","kk","kjh","kca","ky","kv","koi","kpy","kum","lbe","lez","mk","mns","chm","mdf","mn","ttt","gld","yrk","nog","os","ru","rue","sr","sh","cjs","alt","tab","tg","tt","tkr","tk","tyv","ude","udm","uk","uz","mrj","sah"]),o=new Set(["374","994","375","387","359","995","7","383","996","389","373","976","382","381","992","993","380","998"]),u="";function l(e){return o.has(e)}function d(e){return u.includes(e)}var c=new RegExp("^[a-z0-9-]+$")},88477:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LANGUAGE_TO_REGIONS=void 0;t.LANGUAGE_TO_REGIONS={fub:["237","235","234"],af:["237","27"],agq:["237"],yay:["234"],bss:["237"],agg:["675"],ast:["34"],avu:["243","211"],az:["994"],bkc:["237","241"],ksf:["237"],bfd:["237"],bjt:["221"],bcn:["234"],bas:["237"],bsq:["231"],bkv:["234"],bom:["234"],btt:["234"],bin:["234"],bmq:["226","223"],bs:["387","385","383","382","381"],fue:["229","228"],br:["33"],bys:["234"],bwr:["234"],cky:["234"],ca:["376","33","39","34"],tzm:["212"],fuq:["234"],ckl:["234"],asg:["234"],co:["33","39"],crh:["7"],hr:["387","385","383","382","381"],mfn:["234"],cs:["420","421"],dbq:["237","234"],dnj:["225","231"],dzg:["235","227"],ddn:["229"],dgh:["234"],dow:["237"],dua:["229"],nl:["297","32","599","31","1","597"],igb:["234"],etr:["675"],enn:["234"],kgy:["675"],et:["372"],ich:["234"],ee:["229","233","228"],ewo:["237"],fo:["298"],fmp:["237"],fi:["358","46"],fr:["32","229","226","257","237","1","236","242","243","235","269","253","240","33","241","509","225","352","261","223","377","227","250","221","248","41","228","678"],fur:["39"],ff:["237","224","222","221"],gaj:["675"],gl:["34"],gby:["234"],gba:["236"],gmm:["237"],de:["43","32","49","423","352","41"],tof:["675"],god:["225"],ank:["234"],gkn:["234"],gux:["229","226","227","228"],gde:["237","234"],gkp:["224"],kl:["299"],jgk:["234"],ha:["229","237","235","233","225","227","234","249","228"],haw:["1"],hbb:["234"],hu:["36"],dud:["234"],jab:["234"],iby:["234"],is:["354"],idu:["234"],ig:["240"],ige:["234"],ikx:["256"],ikk:["234"],ikq:["234"],smn:["358"],ga:["353","44"],atg:["234"],izi:["234"],dyo:["220","221"],jbu:["237","234"],kab:["213"],kea:["238"],tbd:["675"],hig:["234"],kai:["234"],kkj:["237","236","242"],kzr:["237","235"],naq:["264"],geb:["675"],okr:["234"],ksh:["49"],ses:["223"],khq:["223"],kun:["291","251"],kup:["675"],kub:["237","234"],kpe:["224","231"],nmg:["237","240"],ku:["963","90"],lkt:["1"],hia:["234"],lag:["255"],lv:["371"],lmp:["237"],ln:["242","243"],liv:[],lt:["370"],yaz:["234"],nds:["55","49","31"],dsb:["49"],lu:["243"],lb:["32","33","49","352"],mda:["234"],mb:["261"],mt:["356"],mi:["64"],arn:["56"],mas:["254","255"],ffm:["223"],mql:["229","228"],mbo:["237"],mbu:["234"],mif:["237"],mzm:["234"],mua:["237","235"],sur:["234"],nv:["1"],anc:["234"],nnh:["237"],jgo:["237"],fuv:["237","234"],nin:["234"],dgi:["226"],se:["358","46","47"],nso:["27"],ann:["234"],oc:["33","39","377","34"],pbi:["237"],pip:["234"],pl:["48"],pt:["244","55","238","240","245","853","258","351","239","670"],prg:[],fuf:["224","223","221","232"],qu:["54","591","57","593","51"],ro:["373","40"],cla:["234"],sav:["221"],sg:["236","235","243"],gd:["44"],seh:["258"],sr:["387","385","383","382","381"],sh:["387","385","383","382","381"],srr:["220","221"],sch:["39"],sld:["226"],sms:["358"],sk:["420","421"],sl:["386"],sok:["235"],es:["54","501","591","56","57","506","53","593","503","240","502","504","52","505","507","595","51","34","1","598","58"],srn:["597"],gsw:["43","33","49","423","41"],shi:["212"],tal:["234"],tmh:["223"],taq:["226","223"],tan:["234"],twq:["227"],blt:["856","84"],yer:["234"],tuq:["235","218","227","234"],ttr:["234"],tik:["237"],to:["676"],dts:["223"],kdl:["234"],tsw:["234"],tr:["90"],tk:["993"],hsb:["49"],vai:["231","232"],vi:["855","84"],vo:[],vut:["237","234"],wja:["234"],wa:["32"],wae:["43","39","423","41"],wji:["234"],cy:["44"],fy:["31"],fuh:["229","226","227"],yba:["234"],yav:["237"],yle:["675"],yll:["675"],yo:["229","234"],dje:["227"],gnd:["237"]}},24569:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.findSuspiciousCharacters=function(e,t,r,s){var o=e.match(i),u=o&&o[1];if(null==u)return null;var l=(0,n.phoneCC)(r),d="whatsapp"===t?"":(0,n.phoneCC)(t),c=s.map((e=>e.toLowerCase()));return(0,a.findSuspiciousCharacters)(u,d,l,c)};var a=r(79255),n=r(28721),i=/^(?:https?:\/\/)?([^/?#]+)(?:[/?#]|$)/i},71684:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getClockSkew=function(){return f},t.setClockSkew=function(e){f=e},t.toHttpHeaderDate=function(e){return y(e).toUTCString()},t.castToUnixTime=p,t.castLongIntToUnixTime=function(e){return"number"!=typeof e?(0,a.hexLongIsNegative)(e)?d:l:p(e)},t.isOverflowTime=function(e){return e<d||e>l},t.timeoutFor=function(e,t){var r=_(),a=Math.max(e+t-r,0);return Math.min(1e3*a,~(1<<31))},t.futureUnixTime=function(e,t){var r=null!=t?t:_();return p(Math.ceil(r+Math.max(e,0)))},t.pastUnixTime=function(e,t){var r=null!=t?t:_();return p(Math.ceil(r-Math.max(e,0)))},t.cappedMillisecondsUntil=h,t.delayUntil=function(e){var t=h(e);return new Promise((e=>{setTimeout(e,t)}))},t.unixTime=_,t.midnight=function(){return p((new Date).setHours(0,0,0,0)/1e3-f)},t.midnightOn=function(e){return p(y(e).setHours(0,0,0,0)/1e3-f)},t.unixTimeMs=function(){return Date.now()-1e3*f},t.secondsUntil=m,t.isInFuture=function(e){return m(e)>0},t.monotonicTime=g,t.monotonicTimeSince=v,t.oldest=function(e,t){return e<t?e:t},t.timeSince_USE_ONLY_IF_APPROVED=function(e){return Math.max(_()-e,0)},t.unskewedDate_USE_ONLY_IF_APPROVED=function(){return new Date},t.happenedWithinAt=E,t.happenedWithin=function(e,t){return E(_(),e,t)},t.toDate=y,t.sameDay=function(e,t){if(Math.abs(e-t)>i)return!1;var r=c.time===e?c.day:y(e+f).getDay(),a=c.time===t?c.day:y(t+f).getDay();return c.time=t,c.day=a,r===a},t.isWithinNext24h=function(e){return e-_()<=i},t.MonotonicTimer=t.MAX_INT=t.DUMMY_UNIXTIME=t.WEEK_MILLISECONDS=t.DAY_MILLISECONDS=t.HOUR_MILLISECONDS=t.YEAR_SECONDS=t.WEEK_SECONDS=t.DAY_SECONDS=t.HOUR_SECONDS=void 0;var a=r(8320),n=3600;t.HOUR_SECONDS=n;var i=86400;t.DAY_SECONDS=i;t.WEEK_SECONDS=604800;t.YEAR_SECONDS=31536e3;var s=36e5;t.HOUR_MILLISECONDS=s;var o=864e5;t.DAY_MILLISECONDS=o;t.WEEK_MILLISECONDS=6048e5;var u=1<<31;t.DUMMY_UNIXTIME=u;var l=2147483647;t.MAX_INT=l;var d=-2147483647,c={time:0,day:-4},f=0;function p(e){return Math.max(d,Math.min(0|e,l))}function h(e){var t=Math.max(e-_(),0);return Math.min(1e3*t,~(1<<31))}function _(){return p(Date.now()/1e3-f)}function m(e){return Math.max(e-_(),0)}function g(){return performance.now()}function v(e){return Math.floor(performance.now()-e)}function E(e,t,r){return Math.abs(e-t)<=r}function y(e){return new Date(1e3*e)}t.MonotonicTimer=class{constructor(){var e=g();this._initTime=e,this._startTime=e}reset(){this._startTime=g()}elapsed(){return v(this._startTime)}cumulative(){return v(this._initTime)}}},75586:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ParsableXmlNode=void 0;var a=r(96064);t.ParsableXmlNode=class{constructor(e,t){this._name=e,this._node=t,this._children=Array.isArray(t.content)?t.content.map((t=>new this.constructor(e,t))):null}name(){return this._name}hasAttr(e){return Object.prototype.hasOwnProperty.call(this._node.attrs,e)}assertTag(e){this._node.tag!==e&&this.throw("to be <".concat(e,">"))}tag(){return this._node.tag}maybeChild(e){var t=this._children;if(!t)return null;for(var r=0;r<t.length;r++)if(t[r].tag()===e)return t[r];return null}hasChild(e){return!!this.maybeChild(e)}child(e){var t=this.maybeChild(e);return t||this.throw("to have child <".concat(e,">"))}assertAttr(e,t){var r=this.attrString(e);r!==t&&this.throw('to have "'.concat(e,'"="').concat(t,'", but instead has "').concat(r,'"'))}attrString(e){return Object.prototype.hasOwnProperty.call(this._node.attrs,e)?this.decodeAsString(this._node.attrs[e]):this.throw('to have attribute "'.concat(e,'"'))}forEachAttributeKey(e){var t=this._node.attrs;Object.keys(t).forEach((t=>e(t)))}maybeAttrString(e){return this.hasAttr(e)?this.decodeAsString(this._node.attrs[e]):null}maybeAttrInt(e,t,r){return this.hasAttr(e)?this.attrInt(e,t,r):null}attrEnumValues(e,t){var r=new Set(t),a=this.attrString(e);if(!r.has(a)){var n=Array.from(r).join("|");return this.throw('to have "'.concat(e,'"={').concat(n,'} but has value "').concat(a,'"'))}return a}attrEnum(e,t){var r=this.attrString(e);if(!Object.prototype.hasOwnProperty.call(t,r)){var a=Object.keys(t).join("|");return this.throw('to have "'.concat(e,'"={').concat(a,'} but has value "').concat(r,'"'))}return t[r]}attrEnumOrDefault(e,t,r){return this.hasAttr(e)?this.attrEnum(e,t):r}attrInt(e,t,r){var a=this.attrString(e),n=parseInt(a,10);return Number.isNaN(n)?this.throw('to have "'.concat(e,'"={integer} but has value "').concat(a,'"')):void 0!==t&&n<t?this.throw('to have "'.concat(e,'"={at least ').concat(t,"} but has value ").concat(n)):void 0!==r&&n>=r?this.throw('to have "'.concat(e,'"={below ').concat(r,"} but has value ").concat(n)):n}forEachChild(e){var t=this._children;if(t)t.forEach(e);else if(null!=this._node.content)return this.throw("to have children")}forEachChildWithTag(e,t){this.forEachChild((r=>{r.tag()===e&&t(r)}))}mapChildren(e){var t=this._children;return t||null==this._node.content?t?t.map(e):[]:this.throw("to have children")}mapChildrenWithTag(e,t){var r=this._children;return r||null==this._node.content?r?r.filter((t=>t.tag()===e)).map(t):[]:this.throw("to have children")}mapFirstChild(e){var t=this._children;return t&&0!==t.length?e(t[0]):this.throw("to have children")}hasContent(){return!this._children&&!!this._node.content}hasChildren(){return null!=this._children}contentUint(e){for(var t=this.contentBytes(e),r=0,a=0;a<e;a++)r=256*r+t[a];return r}contentBytes(e=-1){if(this._children)return this.throw("to have binary content, but has children instead");if(null!=this._node.content){var t=this._node.content;return-1!==e&&t.length!==e?this.throw("to be ".concat(e," bytes, but got ").concat(t.length," instead")):t}return this.throw("to have content")}contentString(){return this._children?this.throw("to have string content, but has children instead"):null!=this._node.content?this._node.content:this.throw("to have content")}contentEnum(e){var t=this.contentString();if(!Object.prototype.hasOwnProperty.call(e,t)){var r=Object.keys(e).join("|");return this.throw("to have content {".concat(r,'} but has value "').concat(t,'"'))}return e[t]}decodeAsString(e){if("string"!=typeof e)throw new Error("decodeAsString: attribute is ".concat(typeof e," not a string: ").concat(e));return e}throw(e){throw new a.XmlParsingFailure(this._name,"expected <".concat(this._node.tag,"> ").concat(e))}toString(){return this._node.toString()}}},28631:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.attrsToString=i,t.uint8ArrayToDebugString=s,t.XmlNode=void 0;var a=r(8320),n={};function i(e){for(var t=Object.keys(e),r="",a=0;a<t.length;a++){var n=t[a];r+=" ".concat(n,'="').concat(e[n].toString(),'"')}return r}function s(e){return 0===e.length?"\x3c!-- empty binary --\x3e":e.length<50?(0,a.bytesToDebugString)(e):"\x3c!-- ".concat(e.length," bytes --\x3e")}t.XmlNode=class{constructor(e,t=n,r=null){this.tag=e,this.attrs=t,this.content=r}toString(){var e="<"+this.tag;e+=i(this.attrs);var t=this.content;return Array.isArray(t)?e+=">".concat(t.map(String).join(""),"</").concat(this.tag,">"):t instanceof Uint8Array?e+=">".concat(s(t),"</").concat(this.tag,">"):e+=null!=t?">".concat(String(t),"</").concat(this.tag,">"):" />",e}}},96064:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XmlParsingFailure=void 0;t.XmlParsingFailure=class{constructor(e,t){this.parser=e,this.reason=t}toString(){return"XmlParsingFailure: ".concat(this.parser,": ").concat(this.reason)}}},95970:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.TimeoutError=void 0;class r extends Error{constructor(e){super(e),this.name="TimeoutError"}}t.TimeoutError=r;var a=(e,t,a)=>new Promise(((n,i)=>{var s=setTimeout((()=>i(new r(a))),t);e.then((e=>{clearTimeout(s),n(e)})).catch(i)}));t.default=a},99774:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.queryBusinessProfile=function(e){return(0,n.queryBusinessProfile)(e)},t.queryBusinessCategories=function(e){return e===a.BUSINESS_CATEGORY_EMPTY_STR_ID?(0,i.queryBusinessCategories)(""):(0,i.queryBusinessCategories)(e)};var a=r(95167),n=r(59998),i=r(45618)},74253:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.updateEphemeralSettingTimestamp=b,t.changeEphemeralDuration=function(e,t){if(e.isGroup)return __LOG__(4,void 0,new Error,!0)(y(),e.id.toString()),SEND_LOGS("change-ephemeral-duration"),Promise.resolve();var r=e.contact;if(r.isUser&&r.isContactBlocked)return Promise.reject(new o.default("changing ephemeral setting for contact is blocked",r));var a={id:new c.default({id:(0,f.default)(),remote:e.id,fromMe:!0}),from:(0,u.getMaybeMeUser)(),to:e.id,t:i.default.globalUnixTime(),type:s.default.MSG_TYPE.PROTOCOL,subtype:"ephemeral_setting",ephemeralDuration:t,local:!0,isNewMsg:!0,self:"out"},n=null==e.ephemeralSettingTimestamp?1:e.ephemeralSettingTimestamp+1;return b(e,n),(0,p.addAndSendMsgToChat)(e,a)[1].then((()=>(0,_.updateLocal)(e.id,{ephemeralDuration:t}).then((()=>{e.ephemeralDuration=t,__LOG__(2)(E(),e.id.toString(),t)}))))},t.maybeUpdateEphemeralSetting=function(e,t,r,a=!0){var n,i;if(e.isGroup)return __LOG__(4,void 0,new Error,!0)(v(),e.id.toString()),SEND_LOGS("handle-ephemeral-sync-response"),!1;if(!(0,d.isEphemeralDurationAllowed)(t))return __LOG__(2)(g(),t,e.id.toString()),!1;var s=null!==(n=e.ephemeralSettingTimestamp)&&void 0!==n?n:0,o=null!==(i=e.ephemeralDuration)&&void 0!==i?i:0,u=e.id,c=(0,h.shouldUpdateEphemeralSetting)({oldDuration:o,oldSettingTimestamp:s,newDuration:t,newSettingTimestamp:r,chatId:u});c&&(0,_.updateLocal)(e.id,{ephemeralDuration:t,ephemeralSettingTimestamp:r}).then((()=>{o!==t&&a&&(0,l.generateEphemeralSystemMessage)(e,t),e.ephemeralDuration=t,e.ephemeralSettingTimestamp=r,__LOG__(2)(m(),e.id.toString(),t,r)}));return c};var n=a(r(19976)),i=a(r(19899)),s=a(r(50935)),o=a(r(64357)),u=r(95595),l=r(74404),d=r(38822),c=a(r(77865)),f=a(r(49213)),p=r(95721),h=r(44989),_=r(82373);function m(){var e=(0,n.default)(["chat.maybeUpdateEphemeralSetting updated chatId="," ephemeralDuration="," ephemeralSettingTimestamp=",""]);return m=function(){return e},e}function g(){var e=(0,n.default)(["chat.maybeUpdateEphemeralSetting called with invalid setting "," seconds for chat ",""]);return g=function(){return e},e}function v(){var e=(0,n.default)(["chat.maybeUpdateEphemeralSetting should not be called for group ",""]);return v=function(){return e},e}function E(){var e=(0,n.default)(["chat.changeEphemeralDuration chatId="," ephemeralDuration=",""]);return E=function(){return e},e}function y(){var e=(0,n.default)(["chat.changeEphemeralDuration should not be called for group ",""]);return y=function(){return e},e}function S(){var e=(0,n.default)(["chat.updateEphemeralSettingTimestamp chatId="," ephemeralSettingTimestamp=",""]);return S=function(){return e},e}function T(){var e=(0,n.default)(["chat.updateEphemeralSettingTimestamp should not be called for group ",""]);return T=function(){return e},e}function b(e,t){if(e.isGroup)return __LOG__(4,void 0,new Error,!0)(T(),e.id.toString()),void SEND_LOGS("update-ephemeral-setting-timestamp");(0,_.updateLocal)(e.id,{ephemeralSettingTimestamp:t}).then((()=>{e.ephemeralSettingTimestamp=t,__LOG__(2)(S(),e.id.toString(),t)}))}},207:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.markComposing=function(e){return function(e){if((e.presence.isOnline||e.isGroup)&&!e.typing){var t=e.id;(0,s.sendChatStateComposing)(t).catchType(u.ServerStatusCodeError,(e=>{e.status>=400&&__LOG__(3)(m(),t.toString())})).catchTypes(u.WebdDrop,l.ProtoVersionUndefined,(()=>{})),e.presenceResendTimerId=setTimeout((()=>v(e)),o.default.PRESENCE_RESEND_WAIT)}e.typing=!0,e.pausedTimerId&&clearTimeout(e.pausedTimerId);e.pausedTimerId=setTimeout((()=>g(e)),o.default.SEND_PAUSED_WAIT)}((0,c.unproxy)(e))},t.markPaused=function(e){return g((0,c.unproxy)(e))},t.markRecording=function(e){return function(e){if((e.presence.isOnline||e.isGroup)&&!e.recording){var t=e.id;(0,s.sendChatStateRecording)(t).catchType(u.ServerStatusCodeError,(e=>{e.status>=400&&__LOG__(3)(h(),t.toString())})).catchTypes(u.WebdDrop,l.ProtoVersionUndefined,(()=>{})),e.presenceResendTimerId=setTimeout((()=>v(e)),o.default.PRESENCE_RESEND_WAIT)}e.pausedTimerId&&(clearTimeout(e.pausedTimerId),e.unset("pausedTimerId"));e.recording=!0,e.typing=!1}((0,c.unproxy)(e))},t.sendPresenceAvailable=function(){(0,d.setPresenceAvailable)()},t.sendPresenceUnavailable=function(){(0,d.setPresenceUnavailable)()},t.presenceOnlineChanged=function(e){e.presence.isOnline?v(e):e.presenceResendTimerId&&(clearTimeout(e.presenceResendTimerId),e.unset("presenceResendTimerId"))},t.clearPresence=function(e){e.presenceResendTimerId&&(clearTimeout(e.presenceResendTimerId),e.unset("presenceResendTimerId"));e.pausedTimerId&&(clearTimeout(e.pausedTimerId),e.unset("pausedTimerId"));e.typing=!1};var i=n(r(19976)),s=r(61727),o=n(r(50935)),u=r(19741),l=a(r(96452)),d=r(7845),c=r(64658);function f(){var e=(0,i.default)(["models:chat send presence resend composing error ",""]);return f=function(){return e},e}function p(){var e=(0,i.default)(["models:chat send presence resend recording error ",""]);return p=function(){return e},e}function h(){var e=(0,i.default)(["models:chat send presence recording error ",""]);return h=function(){return e},e}function _(){var e=(0,i.default)(["models:chat send presence paused error ",""]);return _=function(){return e},e}function m(){var e=(0,i.default)(["models:chat send presence composing error ",""]);return m=function(){return e},e}function g(e){if((e.presence.isOnline||e.isGroup)&&(e.typing||e.recording)){var t=e.id;(0,s.sendChatStatePaused)(t).catchType(u.ServerStatusCodeError,(e=>{e.status>=400&&__LOG__(3)(_(),t.toString())})).catchTypes(u.WebdDrop,l.ProtoVersionUndefined,(()=>{}))}e.presenceResendTimerId&&(clearTimeout(e.presenceResendTimerId),e.unset("presenceResendTimerId")),e.pausedTimerId&&(clearTimeout(e.pausedTimerId),e.unset("pausedTimerId")),e.typing=e.recording=!1}function v(e){var t=e.id;if(e.recording)(0,s.sendChatStateRecording)(t).catchType(u.ServerStatusCodeError,(e=>{e.status>=400&&__LOG__(3)(p(),t.toString())})).catchTypes(u.WebdDrop,l.ProtoVersionUndefined,(()=>{}));else{if(!e.typing)return void e.unset("presenceResendTimerId");(0,s.sendChatStateComposing)(t).catchType(u.ServerStatusCodeError,(e=>{e.status>=400&&__LOG__(3)(f(),t.toString())})).catchTypes(u.WebdDrop,l.ProtoVersionUndefined,(()=>{}))}e.presenceResendTimerId=setTimeout((()=>v(e)),o.default.PRESENCE_RESEND_WAIT)}},46638:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.sendClear=function(e,t){return _((0,p.unproxy)(e),t)},t.clearChat=m;var i=n(r(19976)),s=a(r(2784)),o=r(12073),u=r(16059),l=n(r(79711)),d=r(19741),c=n(r(18120)),f=n(r(17957)),p=r(64658);function h(){var e=(0,i.default)(["models:chat:sendClear dropped"]);return h=function(){return e},e}function _(e,t){var{promises:r}=e;if(r.sendClear)return r.sendClear;var a=e.getLastMsgKeyForAction(),n=r.sendClear=(0,u.sendClear)(e,a,t),i=new o.ActionType(f.default.t(59)),p=n.then((()=>c.default.supportsFeature(c.default.F.MD_BACKEND)?new o.ActionType(f.default.t(58)):new o.ActionType(f.default.t(57)))).catchType(d.ServerStatusCodeError,(e=>{if(e.status>=400)return new o.ActionType(f.default.t(56))})).catch((()=>(__LOG__(3)(h()),new o.ActionType(f.default.t(56),{actionText:f.default.t(199),actionHandler:()=>_(e,t)}))));return l.default.openToast(s.createElement(o.ActionToast,{id:(0,o.genId)(),initialAction:i,pendingAction:p})),n.then((r=>{r._duplicate||m(e,t)})).catchType(d.ServerStatusCodeError,(()=>{})).finally((()=>{r.sendClear=null}))}function m(e,t){if(e){var r=e.getLastMsgKeyForAction(),a=r?e.msgs.get(r):void 0;e.deleteMsgsBeforeMsgInclusive(a,t)}}},95721:(e,t,r)=>{"use strict";var a=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.addAndSendMsgToChat=function(e,t,a){return function(e,t,a){var s=Promise.resolve(t).then((t=>{var a=r(58885).default.add(t)[0];if(a)return(0,i.storeMessages)([t],e.id).then((()=>a.waitForPrep().then((()=>a))));throw new n.ModelCreateError("Msg",t)})),o=e.addQueue.enqueue(s).then((t=>e.msgs.add(t)[0])),l=a?o.then(a).then((()=>o)):o,d=u(e,l);return[o,d]}((0,o.unproxy)(e),t,a)},t.sendMsgToChat=function(e,t){return u((0,o.unproxy)(e),t)};var n=a(r(96452)),i=r(12425),s=r(45591),o=(r(59420),r(64658));function u(e,t){return e.sendQueue.enqueue(t).then((e=>(0,s.sendMsgRecord)(e)))}},89590:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.sendSpamReport=function(e,t){return S((0,g.unproxy)(e),t)},t.sendNotSpam=function(e,t){return T((0,g.unproxy)(e),t)},t.sendSpamBlockClear=function(e){return function(e){var{promises:t,isGroup:r,contact:a}=e;if(t.reportSpamBlockClear)return t.reportSpamBlockClear;if(r)return Promise.reject(new c.ActionError);var n=S(e,m.SpamFlow.Block);return t.reportSpamBlockClear=n.then((()=>(0,u.blockContact)(a))).then((()=>(0,h.sendClear)(e,!1))).catch((()=>{})).finally((()=>{t.reportSpamBlockClear=null})),t.reportSpamBlockClear}((0,g.unproxy)(e))},t.sendSpamExitClear=function(e){return function(e){var t,{promises:r,isGroup:a,isReadOnly:n,msgs:i}=e;if(r.reportSpamExitClear)return r.reportSpamExitClear;if(!a)return Promise.reject(new c.ActionError);var s=S(e,m.SpamFlow.Block);if(n)t=s;else{var o=(0,f.sendExitGroup)(e),u=(0,v.default)(i,"change:last",(e=>e.isGroupLeave()));t=Promise.all([s,o,u])}return r.reportSpamExitClear=t.then((()=>(0,h.sendClear)(e,!1))).catch((()=>{})).finally((()=>{r.reportSpamExitClear=null})),r.reportSpamExitClear}((0,g.unproxy)(e))};var i=n(r(19976)),s=a(r(2784)),o=r(12073),u=r(43322),l=n(r(79711)),d=r(19741),c=a(r(96452)),f=r(71142),p=n(r(17957)),h=r(46638),_=r(52354),m=r(25995),g=r(64658),v=n(r(17744));function E(){var e=(0,i.default)(["models:chat:sendNotSpam dropped"]);return E=function(){return e},e}function y(){var e=(0,i.default)(["models:chat:sendSpamReport dropped"]);return y=function(){return e},e}function S(e,t,r=(0,o.genId)()){var{promises:a}=e;if(a.sendSpamReport)return a.sendSpamReport;var n=a.sendSpamReport=(0,_.sendSpamReport)(e,t),i=new o.ActionType(p.default.t(192)),u=n.then((()=>new o.ActionType(p.default.t(194)))).catchType(d.ServerStatusCodeError,(()=>new o.ActionType(p.default.t(193)))).catch((()=>(__LOG__(3)(y()),new o.ActionType(p.default.t(193),{actionText:p.default.t(199),actionHandler:()=>S(e,t,r)}))));return l.default.openToast(s.createElement(o.ActionToast,{id:r,initialAction:i,pendingAction:u})),n.finally((()=>{a.sendSpamReport=null}))}function T(e,t=!1,r=(0,o.genId)()){var{promises:a,notSpam:n}=e;if(n)return Promise.resolve();if(a.sendNotSpam)return a.sendNotSpam;var i=a.sendNotSpam=(0,_.sendNotSpam)(e);if(t){var u=new o.ActionType(p.default.t(139)),c=i.then((()=>new o.ActionType(p.default.t(141)))).catchType(d.ServerStatusCodeError,(()=>new o.ActionType(p.default.t(140)))).catch((()=>(__LOG__(3)(E()),new o.ActionType(p.default.t(140),{actionText:p.default.t(199),actionHandler:()=>T(e,t,r)}))));l.default.openToast(s.createElement(o.ActionToast,{id:r,initialAction:u,pendingAction:c}))}return i.then((()=>{e.set({notSpam:!0})})).finally((()=>{e.isTrusted(),a.sendNotSpam=null}))}},1767:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.unstarAllMessages=function(e,t){return m(e,t?(0,h.unproxy)(t):t)};var i=n(r(19976)),s=a(r(2784)),o=r(12073),u=n(r(79711)),l=r(19741),d=n(r(17957)),c=r(78475),f=n(r(72852)),p=a(r(63095)),h=r(64658);function _(){var e=(0,i.default)(["models:chat:sendUnstarAll dropped"]);return _=function(){return e},e}function m(e,t){var a=r(43334).default,n=t?t.promises:a.promises,i=t?t.id:void 0;if(n.sendUnstarAll)return n.sendUnstarAll;var h=n.sendUnstarAll=(0,c.sendUnstarAll)(e,i),g=new o.ActionType(d.default.t(156)),v=h.then((()=>new o.ActionType(d.default.t(154)))).catchType(l.ServerStatusCodeError,(e=>{if(e.statusCode>=400)return new o.ActionType(d.default.t(150))})).catch((()=>(__LOG__(3)(_()),new o.ActionType(d.default.t(150),{actionText:d.default.t(199),actionHandler:()=>m(e,t)}))));return u.default.openToast(s.createElement(o.ActionToast,{id:(0,o.genId)(),initialAction:g,pendingAction:v})),h.then((()=>{e.forEach((e=>{e.set("star",!1)})),t?(0,p.removeStarredMsgs)(e):(p.default.reset(),f.default.reset(),a.forEach((e=>{e.starredMsgs&&e.starredMsgs.reset()})))})).finally((()=>{n.sendUnstarAll=null}))}},58269:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.markUnread=function(e,t){return P((0,m.unproxy)(e),t)},t.sendSeen=b,t.markSeen=A,t.markUnseen=C,t.updateUnreadCountMD=w;var i=n(r(52954)),s=n(r(19976)),o=a(r(2784)),u=r(12073),l=n(r(79711)),d=n(r(50935)),c=r(19741),f=a(r(96452)),p=n(r(18120)),h=n(r(17957)),_=r(77902),m=r(64658),g=n(r(17026)),v=r(55644);function E(){var e=(0,s.default)(["models:chat:sendConversationSeen dropped"]);return E=function(){return e},e}function y(){var e=(0,s.default)(["models:chat:sendSeen unread "," pending: "," delta: ",""]);return y=function(){return e},e}function S(){var e=(0,s.default)(["markUnread: got status ",""]);return S=function(){return e},e}function T(){var e=(0,s.default)(["sendSeen: got status ",""]);return T=function(){return e},e}function b(e,t=!0){return O((0,m.unproxy)(e),t).catchType(c.ServerStatusCodeError,(e=>{__LOG__(3)(T(),e.status)}))}function A(e,t,r){return function(e,t,r=!1){"markSeen ".concat(String(t));var a=null;null!=t?t>0&&t<=e.unreadCount?(a=e.unreadCount-t,"unreadCount set to ".concat(String(a))):-1===t&&e.unreadCount<=0&&(a=0,"unreadCount set to ".concat(String(a))):(a=0,"unreadCount set to ".concat(String(a)));return(null==a?Promise.resolve():(0,_.markConversationSeen)(e.id,a)).then((()=>{if(null!=t&&r){var n=e.pendingSeenCount-t;e.pendingSeenCount=Math.max(0,n)}null!=a&&(e.unreadCount=a),e.unreadMsgAnchor=void 0,e.markedUnread=!1}))}((0,m.unproxy)(e),t,r)}function C(e){!function(e){0===e.unreadCount&&(e.active&&(e.markedUnread=!0),(0,_.markConversationUnseen)(e.id).then((()=>{e.unreadCount=d.default.MARKED_AS_UNREAD})))}((0,m.unproxy)(e))}function P(e,t,r=(0,u.genId)()){t?e.active&&(e.markedUnread=!0):e.markedUnread=!1;var{promises:a}=e;if(a.markUnread)return a.markUnread;var n=a.markUnread=t?function(e){var t=e.getLastMsgKeyForAction();return(0,_.sendConversationUnseen)(e.id,t).then((()=>{C(e)})).catchType(c.ServerStatusCodeError,(t=>(e.markedUnread=!1,Promise.reject(t))))}(e):O(e),i=t?new u.ActionType(h.default.t(72)):new u.ActionType(h.default.t(71)),s=n.then((()=>{var a=t?h.default.t(70):h.default.t(69);return new u.ActionType(a,{actionText:h.default.t(203),actionHandler:()=>P(e,!t,r)})})).catchType(c.ServerStatusCodeError,(e=>{if(e.status>=400)return t?new u.ActionType(h.default.t(68)):new u.ActionType(h.default.t(67));throw new Error("invalid response status")})).catch((()=>{var a=t?h.default.t(68):h.default.t(67);return new u.ActionType(a,{actionText:h.default.t(199),actionHandler:()=>P(e,t,r)})}));return l.default.openToast(o.createElement(u.ActionToast,{id:r,initialAction:i,pendingAction:s})),n.then((()=>{})).catchType(c.ServerStatusCodeError,(e=>{__LOG__(3)(S(),e.status)})).finally((()=>{a.markUnread=null}))}function O(e,t=!0){if(e.markedUnread||0===e.unreadCount)return"markedUnread: ".concat(String(e.markedUnread)),"unreadCount: ".concat(e.unreadCount),Promise.resolve();if(!g.default.available&&t)return e.listenToOnce(g.default,"change:available",(()=>b(e))),Promise.resolve();e.unreadCount,e.pendingSeenCount;var r=e.unreadCount-e.pendingSeenCount,a=-1===e.unreadCount&&-1===r;if(r<=0&&!a)return Promise.resolve();e.disableUnreadAnchor=!0,e.pendingSeenCount=e.unreadCount,e.pendingSeenCount;var n=()=>{e.pendingSeenCount=e.pendingSeenCount-r,e.pendingSeenCount,e.pendingSeenCount<0&&(__LOG__(3)(y(),e.unreadCount,e.pendingSeenCount,r),e.pendingSeenCount=0)},i=e.getLastMsgKeyForAction();return(0,_.sendConversationSeen)(e,i,r).then((t=>{p.default.supportsFeature(p.default.F.MD_BACKEND)?w(e,r):t._duplicate?n():A(e,r,!0)})).catchType(c.ServerStatusCodeError,(e=>(n(),Promise.reject(e)))).catchTypes(c.WebdDrop,f.ProtoVersionUndefined,(()=>{n(),__LOG__(3)(E())}))}function w(){return M.apply(this,arguments)}function M(){return(M=(0,i.default)((function*(e,t,r=!0){var{unreadCount:a}=yield(0,v.getChatMeta)(e.id);if("updateUnreadCount: old ".concat(e.unreadCount,", new ").concat(a),e.unreadCount=a,e.unreadMsgAnchor=void 0,e.markedUnread=!1,r){var n=e.pendingSeenCount-t;e.pendingSeenCount=Math.max(0,n)}}))).apply(this,arguments)}},50553:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.setPushnameLocally=function(e){n.default.pushname=e,(0,i.setPushname)(e)};var n=a(r(52737)),i=r(95595)},49824:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.createDeviceNotifications=function(){return h.apply(this,arguments)};var n=a(r(19976)),i=a(r(52954)),s=r(11008),o=r(57385),u=r(75637),l=r(95595),d=r(96141),c=a(r(50935));function f(){var e=(0,n.default)(["get chats failed"]);return f=function(){return e},e}function p(){var e=(0,n.default)(["get all from chat table failed"]);return p=function(){return e},e}function h(){return(h=(0,i.default)((function*(e,t,r){if(!(0,l.getGlobalSecurityNotifications)())return[];if(!(t.length>0||r.length>0))return[];var a=[];if(e.equals((0,l.getMeUser)()))try{(yield(0,s.getChatTable)().all()).forEach((e=>{e.id!==c.default.STATUS_WID&&a.push((0,u.createWid)(e.id))}))}catch(e){throw __LOG__(4,!0,new Error,!0)(p()),SEND_LOGS("get all from chat table failed when creating device notification"),new Error("get all from chat table failed")}else try{var n=yield(0,s.getChatTable)().get(String(e)),i=yield(0,s.getParticipantTable)().equals(["participants"],String(e));a=i.map((e=>(0,u.createWid)(e.groupId))),n&&a.push((0,u.createWid)(n.id))}catch(e){throw __LOG__(4,!0,new Error,!0)(f()),SEND_LOGS("get chats failed when creating device notification"),new Error("get chays failed")}var h=a.map((a=>(0,o.genDeviceNotificationMsg)(a,e,t,r)));return yield Promise.all(h.map((e=>(0,d.storeMessageInTransaction)([e])))),h}))).apply(this,arguments)}},34507:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.handleADVDeviceUpdateForMessage=function(e,t,r,a,n){if(o.default.supportsFeature(o.default.F.MD_BACKEND))return function(){return M.apply(this,arguments)}(e,t,r,a,n);return Promise.reject(new Error("This call is only supported in MD mode"))},t.handleADVDeviceUpdate=function({wid:e,devices:t,type:r="update"}){if(o.default.supportsFeature(o.default.F.MD_BACKEND))return function(){return w.apply(this,arguments)}(e,t,r);return Promise.reject(new Error("This call is only supported in MD mode"))},t.handleADVDeviceSyncResult=function(e){if(o.default.supportsFeature(o.default.F.MD_BACKEND))return function(){return I.apply(this,arguments)}(e);return Promise.reject(new Error("This call is only supported in MD mode"))};var n=a(r(70417)),i=a(r(19976)),s=a(r(52954)),o=a(r(18120)),u=r(11008),l=r(44480),d=r(44762),c=r(61697),f=r(84139),p=r(44880),h=r(43919),_=r(12250),m=a(r(50935)),g=r(72434),v=r(75637),E=a(r(41186));function y(){var e=(0,i.default)(["handleADVDeviceUpdate: ts mismatch device failed for ",""]);return y=function(){return e},e}function S(){var e=(0,i.default)(["handleADVDeviceUpdate: missing incming timestamp or rawId for ",""]);return S=function(){return e},e}function T(){var e=(0,i.default)(["handleADVDeviceUpdate: missing timestamp or rawId for ",""]);return T=function(){return e},e}function b(){var e=(0,i.default)(["handleADVDeviceUpdate: validate device failed for ",""]);return b=function(){return e},e}function A(){var e=(0,i.default)(["getADVDeviceSignedKeyIndexList: timestamp older than stored data for ",""]);return A=function(){return e},e}function C(){var e=(0,i.default)(["_handleADVDeviceSyncResult: missing primarykey for ",""]);return C=function(){return e},e}function P(){var e=(0,i.default)(["_handleADVDeviceSyncResult: start to handling "," updates"]);return P=function(){return e},e}function O(){var e=(0,i.default)(["getADVDeviceSignedKeyIndexList: timestamp older than stored data"]);return O=function(){return e},e}function w(){return(w=(0,s.default)((function*(e,t,r){var a,i=yield l.waSignalStore.getIdentity((0,d.createSignalAddress)(e).toString());if(i){var s=(0,g.toCurveKeyPubKey)((0,d.strToBuffer)(i)),{deviceList:o,keyIndex:v}=t;if(null!=o&&null!=v){var{ts:E,signedKeyIndexBytes:y}=v,S=yield(0,u.getDeviceListTable)().get(e.user);if(!(S&&(0,p.numberOrThrowIfTooLarge)(S.timestamp)>v.ts)){if("remove"===r&&S){var T=S.devices.filter((e=>e.keyIndex!==o[0].keyIndex&&e.id!==o[0].id)),b=(0,n.default)((0,n.default)({},S),{},{devices:T});return(0,c.applyDeviceUpdate)(e,b,S.devices)}var A=(0,f.decodeProto)(h.ADVSignedKeyIndexListSpec,y);if(!(0,_.verifyKeyIndexListAccountSignature)(A,s))throw new Error("handleADVDeviceUpdate: validate device failed");var C=(0,f.decodeProto)(h.ADVKeyIndexListSpec,A.details);if(null==C.timestamp||null==C.rawId)throw new Error("handleADVDeviceUpdate: missing timestamp or rawId");var P=(0,p.numberOrThrowIfTooLarge)(C.timestamp),w=C.rawId;if(null==w||null==P)throw new Error("handleADVDeviceUpdate: missing incming timestamp or rawId");if(P!==E)throw new Error("handleADVDeviceUpdate: ts mismatch device failed");S&&S.rawId!==w&&(yield(0,c.clearDeviceRecord)(e,S.devices),S=null);var M=C.currentIndex||0,I=new Map,R=new Set(C.validIndexes);R.add(0),o.forEach((e=>{null!=e.keyIndex&&R.has(e.keyIndex)&&I.set(e.id,e.keyIndex)})),S&&("add"===r?S.devices.forEach((e=>{(R.has(e.keyIndex)||e.keyIndex>M)&&I.set(e.id,e.keyIndex)})):S.devices.forEach((e=>{var t=I.get(e.id);null!=t?t<e.keyIndex&&R.has(e.keyIndex)&&I.set(e.id,e.keyIndex):e.keyIndex>M&&I.set(e.id,e.keyIndex)}))),I.set(m.default.DEVICE.PRIMARY_DEVICE,0);var D=Array.from(I.entries()).map((([e,t])=>({id:e,keyIndex:t}))),N="add"===r&&S?S.timestamp:P,L={id:e.user,rawId:w,timestamp:N,validIndexes:Array.from(R),devices:D,currentIndex:C.currentIndex};return(0,c.applyDeviceUpdate)(e,L,null===(a=S)||void 0===a?void 0:a.devices)}__LOG__(2)(O())}}}))).apply(this,arguments)}function M(){return(M=(0,s.default)((function*(e,t,r,a,i){var{rawId:s,timestamp:o,keyIndex:l}=t;if(null==s||null==o||null==l)throw new Error("handleADVDeviceIdentity: rawId, keyIndex, timestamp inside deviceIdentity should not be null");var f=e.device;if(null==f||f===m.default.DEVICE.PRIMARY_DEVICE)throw new Error("handleADVDeviceIdentity: called for primary device");var h=(0,v.toUserWid)(e),_=yield(0,u.getDeviceListTable)().get(h.user);if(_&&(_.rawId!==s||null==r||null!=a&&!(0,d.bufferEqual)(r,a))){if(_.timestamp>(0,p.numberOrThrowIfTooLarge)(o))throw new Error("handleADVDeviceIdentity: out-of-order timestamp detected");yield(0,c.clearDeviceRecord)(h,_.devices),_=null}var y=(0,E.default)();if(_){if(_.timestamp>=(0,p.numberOrThrowIfTooLarge)(o)&&_.validIndexes&&!_.validIndexes.includes(l))throw new Error("handleADVDeviceIdentity: out-of-order timestamp detected");var S=new Map;if(_.devices.forEach((e=>{S.set(e.id,e.keyIndex)})),!S.has(f)||!S.get(f)===l){S.set(f,l);var T=Array.from(S.entries()).map((([e,t])=>({id:e,keyIndex:t}))),b=(0,n.default)((0,n.default)({},_),{},{devices:T});yield(0,c.applyDeviceUpdate)(h,b,_.devices)}}else{a&&(yield y.saveIdentity((0,d.createSignalAddress)(h).toString(),(0,g.toSignalCurvePubKey)(a)));var A={id:e.user,rawId:s,timestamp:(0,p.numberOrThrowIfTooLarge)(o),devices:[{id:f,keyIndex:l},{id:m.default.DEVICE.PRIMARY_DEVICE,keyIndex:0}],validIndexes:null,currentIndex:null};yield(0,c.applyDeviceUpdate)(h,A,null)}yield(0,E.default)().saveIdentity((0,d.createSignalAddress)(e).toString(),(0,g.toSignalCurvePubKey)(i))}))).apply(this,arguments)}function I(){return(I=(0,s.default)((function*(e){__LOG__(2)(P(),e.length);var t=[],r=e.map((e=>e.wid)),a=yield l.waSignalStore.bulkGetIdentity(r.map((e=>(0,d.createSignalAddress)(e).toString()))),n=yield(0,u.getDeviceListTable)().bulkGet(r.map((e=>e.user))),i=[];e.forEach((({wid:e,devices:r},s)=>{var o,u=a[s];if(u){var l=n[s],c=(0,g.toCurveKeyPubKey)((0,d.strToBuffer)(u)),{deviceList:v,keyIndex:E}=r;if(null!=v&&null!=E){var{ts:P,signedKeyIndexBytes:O}=E;if(l&&(0,p.numberOrThrowIfTooLarge)(l.timestamp)>E.ts)__LOG__(2)(A(),String(e));else{var w=(0,f.decodeProto)(h.ADVSignedKeyIndexListSpec,O);if((0,_.verifyKeyIndexListAccountSignature)(w,c)){var M=(0,f.decodeProto)(h.ADVKeyIndexListSpec,w.details);if(null!=M.timestamp&&null!=M.rawId){var I=(0,p.numberOrThrowIfTooLarge)(M.timestamp),R=M.rawId;if(null!=R&&null!=I)if(I===P){l&&l.rawId!==R&&(i.push({wid:e,currentList:l.devices}),l=null);var D=M.currentIndex||0,N=new Map,L=new Set(M.validIndexes);L.add(0),v.forEach((e=>{null!=e.keyIndex&&L.has(e.keyIndex)&&N.set(e.id,e.keyIndex)})),l&&l.devices.forEach((e=>{var t=N.get(e.id);null!=t?t<e.keyIndex&&L.has(e.keyIndex)&&N.set(e.id,e.keyIndex):e.keyIndex>D&&N.set(e.id,e.keyIndex)})),N.set(m.default.DEVICE.PRIMARY_DEVICE,0);var k=Array.from(N.entries()).map((([e,t])=>({id:e,keyIndex:t}))),U={id:e.user,rawId:R,timestamp:I,validIndexes:Array.from(L),devices:k,currentIndex:M.currentIndex};t.push({wid:e,update:U,currentList:null===(o=l)||void 0===o?void 0:o.devices})}else __LOG__(4,void 0,new Error)(y(),String(e));else __LOG__(4,void 0,new Error)(S(),String(e))}else __LOG__(4,void 0,new Error)(T(),String(e))}else __LOG__(4,void 0,new Error)(b(),String(e))}}}else __LOG__(2)(C(),String(e))})),yield Promise.all(i.map((({wid:e,currentList:t})=>(0,c.clearDeviceRecord)(e,t)))),yield(0,c.bulkApplyDeviceUpdate)(t)}))).apply(this,arguments)}},61697:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.clearDeviceRecord=function(){return y.apply(this,arguments)},t.applyDeviceUpdate=function(){return S.apply(this,arguments)},t.bulkApplyDeviceUpdate=function(){return T.apply(this,arguments)};var n=a(r(19976)),i=a(r(52954)),s=a(r(17335)),o=a(r(50935)),u=r(22359),l=r(75093),d=r(11008),c=r(11824),f=r(95196),p=r(75637),h=r(49824),_=r(95595),m=r(53801);function g(){var e=(0,n.default)(["bulkCreateOrReplace into device list table failed"]);return g=function(){return e},e}function v(){var e=(0,n.default)(["createOrReplace into device list table failed"]);return v=function(){return e},e}function E(){var e=(0,n.default)(["remove from device list table failed"]);return E=function(){return e},e}function y(){return(y=(0,i.default)((function*(e,t){yield Promise.all(t.filter((e=>e.id!==o.default.DEVICE.PRIMARY_DEVICE)).map((t=>(0,u.deleteIdentity)((0,p.createDeviceWidFromUserAndDevice)(e.user,t.id)))));var r=[],a=t.map((e=>e.id)).filter((e=>e!==o.default.DEVICE.PRIMARY_DEVICE)),n=function(){var t=(0,i.default)((function*(){var t=(0,h.createDeviceNotifications)(e,r,a),n=(0,f.updateGroupParticipantsInTransaction)(e,r,a),i=(0,d.getDeviceListTable)().remove(e.user).catch((()=>{throw __LOG__(4,!0,new Error,!0)(E()),SEND_LOGS("remove from device list table failed when clearing device record"),new Error("remove from device list table failed")}));return(yield Promise.all([t,n,i]))[0]}));return function(){return t.apply(this,arguments)}}(),s=yield(0,l.getDeviceUpdateLock)(n);yield Promise.all(s.map((e=>(e.recvFresh=!0,e.isNewMsg=!0,(0,c.getBridge)().sendAndReceive("msg_collection","processMultipleMessages",{chatId:e.from,msgObjs:[e],meta:{isHistory:!1}})))))}))).apply(this,arguments)}function S(){return(S=(0,i.default)((function*(e,t,r){var{devices:a}=t,n=a.map((e=>e.id)),g=r?r.map((e=>e.id)):[],E=(0,s.default)(n,g).filter((e=>e!==o.default.DEVICE.PRIMARY_DEVICE)),y=(0,s.default)(g,n).filter((e=>e!==o.default.DEVICE.PRIMARY_DEVICE)),S=function(){var r=(0,i.default)((function*(){var r=(0,h.createDeviceNotifications)(e,E,y),a=(0,f.updateGroupParticipantsInTransaction)(e,E,y),n=(0,d.getDeviceListTable)().createOrReplace(t).catch((()=>{throw __LOG__(4,!0,new Error,!0)(v()),SEND_LOGS("createOrReplace into device list table failed when applying device update"),new Error("createOrReplace into device list table failed")}));return(yield Promise.all([r,a,n]))[0]}));return function(){return r.apply(this,arguments)}}(),T=yield(0,l.getDeviceUpdateLock)(S);Promise.all(y.map((t=>(0,u.deleteIdentity)((0,p.createDeviceWidFromUserAndDevice)(e.user,t))))),yield Promise.all(T.map((e=>(e.recvFresh=!0,e.isNewMsg=!0,(0,c.getBridge)().sendAndReceive("msg_collection","processMultipleMessages",{chatId:e.from,msgObjs:[e],meta:{add:"after",isHistory:!1}}))))),e.user===(0,_.getMeUser)().user&&(0,m.updateMissingKeyDevices)()}))).apply(this,arguments)}function T(){return(T=(0,i.default)((function*(e){var t=[];e.forEach((({wid:e,update:r,currentList:a})=>{var{devices:n}=r,i=n.map((e=>e.id)),u=a?a.map((e=>e.id)):[],l=(0,s.default)(i,u).filter((e=>e!==o.default.DEVICE.PRIMARY_DEVICE)),d=(0,s.default)(u,i).filter((e=>e!==o.default.DEVICE.PRIMARY_DEVICE));t.push({wid:e,added:l,removed:d})}));var r=function(){var r=(0,i.default)((function*(){var r=Promise.all(t.map((({wid:e,added:t,removed:r})=>(0,h.createDeviceNotifications)(e,t,r)))),a=(0,f.bulkUpdateGroupParticipantsInTransaction)(t),n=(0,d.getDeviceListTable)().bulkCreateOrReplace(e.map((e=>e.update))).catch((()=>{throw __LOG__(4,!0,new Error,!0)(g()),SEND_LOGS("bulkCreateOrReplace into device list table failed when applying device update"),new Error("bulkCreateOrReplace into device list table failed")})),i=yield Promise.all([r,a,n]);return i[0]?i[0].flat():[]}));return function(){return r.apply(this,arguments)}}(),a=yield(0,l.getDeviceUpdateLock)(r);yield Promise.all(a.map((e=>(e.recvFresh=!0,e.isNewMsg=!0,(0,c.getBridge)().sendAndReceive("msg_collection","processMultipleMessages",{chatId:e.from,msgObjs:[e],meta:{add:"after",isHistory:!1}})))))}))).apply(this,arguments)}},95196:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.updateGroupParticipantsInTransaction=function(){return u.apply(this,arguments)},t.bulkUpdateGroupParticipantsInTransaction=function(){return l.apply(this,arguments)};var n=a(r(70417)),i=a(r(52954)),s=r(11008),o=r(75637);function u(){return(u=(0,i.default)((function*(e,t,r){var a=(yield(0,s.getParticipantTable)().equals(["participants"],String(e))).map((a=>{var i=a.rotateKey,s=new Map(a.senderKey);return t.forEach((t=>{s.set(String((0,o.createDeviceWidFromUserAndDevice)(e.user,t)),!1)})),r.forEach((t=>{s.delete(String((0,o.createDeviceWidFromUserAndDevice)(e.user,t)))})),r.length>0&&(i=!0),(0,n.default)((0,n.default)({},a),{},{senderKey:s,rotateKey:i})}));return(0,s.getParticipantTable)().bulkCreateOrReplace(a)}))).apply(this,arguments)}function l(){return(l=(0,i.default)((function*(e){if(0!==e.length){var t=yield(0,s.getParticipantTable)().anyOf(["participants"],e.map((e=>String(e.wid))));if(0!==t.length){var r=new Map;e.forEach((e=>{r.set(String(e.wid),e)}));var a=t.map((e=>{var t=e.rotateKey,a=new Map(e.senderKey);return e.participants.forEach((e=>{var n=r.get(e);if(n){var{added:i,removed:s}=n;i.forEach((e=>{a.set(String((0,o.createDeviceWidFromUserAndDevice)(n.wid.user,e)),!1)})),s.forEach((e=>{a.delete(String((0,o.createDeviceWidFromUserAndDevice)(n.wid.user,e)))})),s.length>0&&(t=!0)}})),(0,n.default)((0,n.default)({},e),{},{senderKey:a,rotateKey:t})}));return(0,s.getParticipantTable)().bulkCreateOrReplace(a)}}}))).apply(this,arguments)}},43322:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.blockContact=function(e){return _((0,p.unproxy)(e),!0)},t.unblockContact=function(e){return _((0,p.unproxy)(e),!1)};var i=n(r(19976)),s=a(r(2784)),o=r(12073),u=r(82184),l=n(r(79148)),d=n(r(79711)),c=r(19741),f=n(r(17957)),p=r(64658);function h(){var e=(0,i.default)(["action:setBlock dropped"]);return h=function(){return e},e}function _(e,t,r){var{id:a}=e,n=e.isBlocked();if(t&&n||!t&&!n)return Promise.resolve();var i=(0,u.sendSetBlock)(t,a).then((e=>{e&&(t?l.default.add({id:a}):l.default.remove(a))}));return function(e,t,r,a=(0,o.genId)()){var n={participant:e.formattedName},i=r?new o.ActionType(f.default.t(47,n)):new o.ActionType(f.default.t(202,n)),u=t.then((()=>{var t=r?f.default.t(46,n):f.default.t(201,n);return new o.ActionType(t,{actionText:f.default.t(203),actionHandler:()=>_(e,!r,a)})})).catch((t=>{if(!(t instanceof c.ServerStatusCodeError)){__LOG__(3)(h());var i=r?f.default.t(45,n):f.default.t(200,n),s=new o.ActionType(i,{actionText:f.default.t(199),actionHandler:()=>_(e,r,a)});return Promise.reject(s)}if(t.statusCode>=400){var u=r?new o.ActionType(f.default.t(45,n)):new o.ActionType(f.default.t(200,n));return Promise.reject(u)}}));d.default.openToast(s.createElement(o.ActionToast,{id:a,initialAction:i,pendingAction:u}))}(e,i,t,r),i}},28291:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.onIsBusinessChange=function(e){var t=(0,i.unproxy)(e),{businessProfile:a,id:s}=t,o=t.isBusiness||t.isMe&&n.default.isSMB;o&&!a?t.addChild("businessProfile",r(89216).default.gadd(s)):!o&&a&&(t.stopListening(a),t.businessProfile=void 0,a.delete())};var n=a(r(52737)),i=r(64658)},70703:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.contactFindQuery=function(e){var t=performance.now(),a={};return o.default.contactFindQuery(e.retry,(e=>{a.binarySize=e.binarySize})).then((e=>{var n=e;if("preempted"===n.data)return Promise.reject("contacts preempted");a.count=n.data&&n.data.length,a.timing=Math.ceil(performance.now()-t);var o=r(7470).default;return o.trigger(i.default.COLLECTION_HAS_SYNCED,a),(0,s.mungePSAContact)(n.data),n.checksum&&(o.setChecksum(n.checksum),__LOG__(2)(u(),n.checksum)),Promise.resolve(n.data)}))};var n=a(r(19976)),i=a(r(50935)),s=r(84748),o=a(r(76022));function u(){var e=(0,n.default)(["Store:Contact:query update checksum ",""]);return u=function(){return e},e}},33526:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.queryIdentity=function(e){var t=(0,i.unproxy)(e),{verificationBinary:r,verificationString:a,id:n}=t;if(r&&a)return Promise.resolve();if(t.promises.queryIdentity)return t.promises.queryIdentity;t.promises.queryIdentity=s.default.queryIdentity(n).then((t=>{u(e,t)})).catch((e=>{__LOG__(3)(o(),String(e))})).finally((()=>{t.promises.queryIdentity=null}))},t.updateIdentity=u;var n=a(r(19976)),i=r(64658),s=a(r(76022));function o(){var e=(0,n.default)(["models:contact:queryIdentity error: ",""]);return o=function(){return e},e}function u(e,t){var r=(0,i.unproxy)(e);t.status&&t.status>=400?(r.unset("verificationBinary"),r.unset("verificationString")):(r.verificationBinary=t.binary,r.verificationString=t.string)}},69710:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.handleNewIdentity=function(){return h.apply(this,arguments)};var n=a(r(52954)),i=a(r(18120)),s=r(41263),o=r(15129),u=r(75637),l=r(77993),d=a(r(50935)),c=a(r(64786)),f=r(49824),p=r(95196);function h(){return(h=(0,n.default)((function*(e){if(!i.default.supportsFeature(i.default.F.MD_BACKEND))return Promise.reject(new Error("This call is only supported in MD mode"));var t,r=Promise.resolve(),a=window.libsignal.SignalProtocolAddress.fromString(e).getName(),n=(0,u.createWid)((0,s.toJid)(a)),h=null!==(t=n.device)&&void 0!==t?t:d.default.DEVICE.PRIMARY_DEVICE,_=(0,u.toUserWid)(n);return h===d.default.DEVICE.PRIMARY_DEVICE?(c.default.notifyDeviceIdentityChangedOrDeleted(n,!0),yield(0,l.getStorage)().lock(["participant"],(()=>(0,p.updateGroupParticipantsInTransaction)(_,[h],[h]))),yield(0,o.addSecurityCodeChangedNotification)(_)):yield(0,f.createDeviceNotifications)(_,[h],[h]),r}))).apply(this,arguments)}},78054:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addLiveLocation=function(e,t){var r=(0,a.unproxy)(e);r.liveLocations||(r.liveLocations=[]);var{liveLocations:n}=r;n.push(t)},t.removeLiveLocation=function(e,t){var r=(0,a.unproxy)(e),{liveLocations:n}=r;if(!n)return;for(var i=n.length-1;i>=0;i--)if(n[i]===t){n.splice(i,1);break}0===n.length&&(r.liveLocations=null)};var a=r(64658)},88528:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.updatePushname=function(e,t){return l.enqueue((()=>{(0,s.getBridge)().sendAndReceive("contact_collection","updatePushname",{contactId:e,pushname:t}).then((r=>{if(r||void 0===r)return __LOG__(2)(u(),String(e)),(0,o.updateLocal)(e,{pushname:t})}))}))};var n=a(r(19976)),i=r(98970),s=r(11824),o=r(51803);function u(){var e=(0,n.default)(["updatePushName: set pushname for ",""]);return u=function(){return e},e}var l=new i.PromiseQueue},17555:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.resyncContacts=function(e){void 0!==i.default.checksum&&void 0!==e&&(i.default.checksum!==e?i.default.findQuery({retry:!0}).then((e=>{if(Array.isArray(e)){(0,l.mungePSAContact)(e),__LOG__(2)(h());var t=(0,u.getContactsToRemove)(e),r=Promise.resolve();if(o.default.supportsFeature(o.default.F.MD_BACKEND)&&t.length){var a=t.map((e=>e.id.toString()));r=(0,d.getContactTable)().bulkRemove(a).catch((()=>{throw __LOG__(4,!0,new Error,!0)(p()),SEND_LOGS("bulkRemove from contact table failed when resyncing contacts"),new Error("bulkRemove from contact table failed")}))}r.then((()=>{t.forEach((e=>{e.unset("name"),e.unset("shortName")}))}))}else __LOG__(3)(f(),JSON.stringify(e))})).catchType(s.WebdDrop,(()=>{})):__LOG__(2)(c()))};var n=a(r(19976)),i=a(r(7470)),s=r(19741),o=a(r(18120)),u=r(87354),l=r(84748),d=r(11008);function c(){var e=(0,n.default)(["Store:Contact:resync checksum match"]);return c=function(){return e},e}function f(){var e=(0,n.default)(["Store:Contact.resync error ",""]);return f=function(){return e},e}function p(){var e=(0,n.default)(["bulkRemove from contact table failed"]);return p=function(){return e},e}function h(){var e=(0,n.default)(["Store:Contact:resync success"]);return h=function(){return e},e}},15129:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.addSecurityCodeChangedNotification=function(e){if((0,i.getGlobalSecurityNotifications)()&&s.default.supportsFeature(s.default.F.MD_BACKEND)){var t=[];if(o.default.get(e)){var r=(0,u.genSecurityCodeNotificationMsg)(e,e);t.push((0,d.handleSingleMsgMD)(e,r))}var a=e.toString(),n=(0,l.getParticipantTable)().equals(["participants"],a).then((t=>{var r=t.map((t=>{var r=(0,c.createWid)(t.groupId),a=(0,u.genSecurityCodeNotificationMsg)(r,e);return(0,d.handleSingleMsgMD)(r,a)}));return Promise.all(r)})).catch((()=>{throw __LOG__(4,!0,new Error,!0)(f()),SEND_LOGS("failed to get participants table when adding security code change notification"),new Error("failed to insert notification for groups")}));return t.push(n),Promise.all(t)}return Promise.resolve()};var n=a(r(19976)),i=r(95595),s=a(r(18120)),o=a(r(43334)),u=r(57385),l=r(11008),d=r(39778),c=r(75637);function f(){var e=(0,n.default)(["failed to insert notification for groups"]);return f=function(){return e},e}},84748:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.mungePSAContact=function(e){if(Array.isArray(e)){var t=e.findIndex((e=>e&&i.default.isPSA(e.id))),r=e[t];t>-1&&r&&(r.name=n.default.t(1907),r.shortName=n.default.t(1907))}};var n=a(r(17957)),i=a(r(68384))},73896:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,r,a,s){var o=[d(a,s),c(a,s)];return Promise.all(o.map((a=>{if(a)return(0,n.handleSingleMsgMD)(e,function(e,t,r,a,n){return{type:"notification_template",self:"in",subtype:a,t:r,recipients:[],templateParams:n,from:e,id:new i.default({remote:e,fromMe:!1,id:t})}}(e,t,r,a.subtype,a.templateParams))}))).then((()=>{}))};var n=r(39778),i=a(r(77865)),s=a(r(72424)),o={CSON:{CSON:null,SSON:"blue_msg_consumer_to_self_premise_unverified",SSOY:"blue_msg_unverified_to_verified",ESON:"blue_msg_consumer_to_self_premise_unverified",ESOY:"blue_msg_unverified_to_verified",ESFN:"blue_msg_consumer_to_self_fb_unverified",ESFY:"blue_msg_unverified_to_self_fb_verified",EBON:"blue_msg_consumer_to_bsp_premise_unverified",EBOY:"blue_msg_unverified_to_bsp_premise_verified",EBFN:"blue_msg_consumer_to_bsp_fb_unverified",EBFY:"blue_msg_unverified_to_bsp_fb_verified"},SSON:{CSON:"blue_msg_to_consumer",SSON:null,SSOY:"blue_msg_unverified_to_verified",ESON:null,ESOY:"blue_msg_unverified_to_verified",ESFN:"blue_msg_to_self_fb",ESFY:"blue_msg_unverified_to_self_fb_verified",EBON:"blue_msg_self_premise_to_bsp_premise",EBOY:"blue_msg_unverified_to_bsp_premise_verified",EBFN:"blue_msg_to_bsp_fb",EBFY:"blue_msg_unverified_to_bsp_fb_verified"},SSOY:{CSON:"blue_msg_to_consumer",SSON:"blue_msg_verified_to_unverified",SSOY:null,ESON:"blue_msg_verified_to_unverified",ESOY:null,ESFN:"blue_msg_verified_to_self_fb_unverified",ESFY:"blue_msg_to_self_fb",EBON:"blue_msg_verified_to_bsp_premise_unverified",EBOY:"blue_msg_self_premise_to_bsp_premise",EBFN:"blue_msg_verified_to_bsp_fb_unverified",EBFY:"blue_msg_to_bsp_fb"},ESON:{CSON:"blue_msg_to_consumer",SSON:null,SSOY:"blue_msg_unverified_to_verified",ESON:null,ESOY:"blue_msg_unverified_to_verified",ESFN:"blue_msg_to_self_fb",ESFY:"blue_msg_unverified_to_self_fb_verified",EBON:"blue_msg_self_premise_to_bsp_premise",EBOY:"blue_msg_unverified_to_bsp_premise_verified",EBFN:"blue_msg_to_bsp_fb",EBFY:"blue_msg_unverified_to_bsp_fb_verified"},ESOY:{CSON:"blue_msg_to_consumer",SSON:"blue_msg_verified_to_unverified",SSOY:null,ESON:"blue_msg_verified_to_unverified",ESOY:null,ESFN:"blue_msg_verified_to_self_fb_unverified",ESFY:"blue_msg_to_self_fb",EBON:"blue_msg_verified_to_bsp_premise_unverified",EBOY:"blue_msg_self_premise_to_bsp_premise",EBFN:"blue_msg_verified_to_bsp_fb_unverified",EBFY:"blue_msg_to_bsp_fb"},ESFN:{CSON:"blue_msg_to_consumer",SSON:"blue_msg_self_fb_to_self_premise",SSOY:"blue_msg_self_fb_unverified_to_self_premise_verified",ESON:"blue_msg_self_fb_to_self_premise",ESOY:"blue_msg_self_fb_unverified_to_self_premise_verified",ESFN:null,ESFY:"blue_msg_unverified_to_verified",EBON:"blue_msg_self_fb_to_bsp_premise",EBOY:"blue_msg_self_fb_unverified_to_bsp_premise_verified",EBFN:"blue_msg_to_bsp_fb",EBFY:"blue_msg_unverified_to_bsp_fb_verified"},ESFY:{CSON:"blue_msg_to_consumer",SSON:"blue_msg_self_fb_verified_to_self_premise_unverified",SSOY:"blue_msg_self_fb_to_self_premise",ESON:"blue_msg_self_fb_verified_to_self_premise_unverified",ESOY:"blue_msg_self_fb_to_self_premise",ESFN:"blue_msg_verified_to_unverified",ESFY:null,EBON:"blue_msg_self_fb_verified_to_bsp_premise_unverified",EBOY:"blue_msg_self_fb_to_bsp_premise",EBFN:"blue_msg_verified_to_bsp_fb_unverified",EBFY:"blue_msg_to_bsp_fb"},EBON:{CSON:"blue_msg_to_consumer",SSON:"blue_msg_bsp_premise_to_self_premise",SSOY:"blue_msg_bsp_premise_unverified_to_self_premise_verified",ESON:"blue_msg_bsp_premise_to_self_premise",ESOY:"blue_msg_bsp_premise_unverified_to_self_premise_verified",ESFN:"blue_msg_to_self_fb",ESFY:"blue_msg_unverified_to_self_fb_verified",EBON:null,EBOY:"blue_msg_unverified_to_verified",EBFN:"blue_msg_to_bsp_fb",EBFY:"blue_msg_unverified_to_bsp_fb_verified"},EBOY:{CSON:"blue_msg_to_consumer",SSON:"blue_msg_bsp_premise_verified_to_self_premise_unverified",SSOY:"blue_msg_bsp_premise_to_self_premise",ESON:"blue_msg_bsp_premise_verified_to_self_premise_unverified",ESOY:"blue_msg_bsp_premise_to_self_premise",ESFN:"blue_msg_verified_to_self_fb_unverified",ESFY:"blue_msg_to_self_fb",EBON:"blue_msg_verified_to_unverified",EBOY:null,EBFN:"blue_msg_verified_to_bsp_fb_unverified",EBFY:"blue_msg_to_bsp_fb"},EBFN:{CSON:"blue_msg_to_consumer",SSON:"blue_msg_bsp_fb_to_self_premise",SSOY:"blue_msg_bsp_fb_unverified_to_self_premise_verified",ESON:"blue_msg_bsp_fb_to_self_premise",ESOY:"blue_msg_bsp_fb_unverified_to_self_premise_verified",ESFN:"blue_msg_bsp_fb_to_self_fb",ESFY:"blue_msg_bsp_fb_unverified_to_self_fb_verified",EBON:"blue_msg_bsp_fb_to_bsp_premise",EBOY:"blue_msg_bsp_fb_unverified_to_bsp_premise_verified",EBFN:null,EBFY:"blue_msg_unverified_to_verified"},EBFY:{CSON:"blue_msg_to_consumer",SSON:"blue_msg_bsp_fb_verified_to_self_premise_unverified",SSOY:"blue_msg_bsp_fb_to_self_premise",ESON:"blue_msg_bsp_fb_verified_to_self_premise_unverified",ESOY:"blue_msg_bsp_fb_to_self_premise",ESFN:"blue_msg_bsp_fb_verified_to_self_fb_unverified",ESFY:"blue_msg_bsp_fb_to_self_fb",EBON:"blue_msg_bsp_fb_verified_to_bsp_premise_unverified",EBOY:"blue_msg_bsp_fb_to_bsp_premise",EBFN:"blue_msg_verified_to_unverified",EBFY:null}};var u={CONSUMER:{CONSUMER:null,BIZ_NOT_HIGH:["biz_intro_bottom",null],BIZ_HIGH:["biz_intro_top","CURRENT"]},BIZ_NOT_HIGH:{CONSUMER:["biz_move_to_consumer_app",null],BIZ_NOT_HIGH:null,BIZ_HIGH:["biz_verified_transition_bottom_to_top","CURRENT"]},BIZ_HIGH:{CONSUMER:["biz_move_to_consumer_app",null],BIZ_NOT_HIGH:["biz_verified_transition_top_to_bottom","PREVIOUS"],BIZ_HIGH:null}};function l(e){return e.isBusiness?e.isVerifiedHigh?"BIZ_HIGH":"BIZ_NOT_HIGH":"CONSUMER"}function d(e,t){if(e.isVerifiedHigh&&t.isVerifiedHigh&&null!=e.verifiedName&&null!=t.verifiedName&&e.verifiedName!==t.verifiedName)return{subtype:"biz_name_change",templateParams:[t.verifiedName]};var r=u[l(e)][l(t)];if(null!=r){var[a,n]=r,i=[];return"PREVIOUS"===n&&e.verifiedName?i.push(e.verifiedName):"CURRENT"===n&&t.verifiedName&&i.push(t.verifiedName),{subtype:a,templateParams:i}}}function c(e,t){if(s.default.bspSystemMessageEnabled){var r=f(e),a=f(t),n=o[r][a];if(null==n)return null;var i=[];return t.isVerifiedHigh&&t.verifiedName&&i.push(t.verifiedName),{subtype:n,templateParams:i}}}function f({isVerifiedHigh:e,isBusiness:t,isEnterprise:r,actualActors:a,hostStorage:n}){return t?r?"bsp"===a?"facebook"===n?e?"EBFY":"EBFN":e?"EBOY":"EBON":"facebook"===n?e?"ESFY":"ESFN":e?"ESOY":"ESON":e?"SSOY":"SSON":"CSON"}},87951:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.fetchFirstPartyStickers=function(){return p.apply(this,arguments)};var i=n(r(52954)),s=a(r(96452)),o=n(r(93601)),u=n(r(17957)),l=n(r(40210)),d=n(r(74185)),c=n(r(99340)),f="https://static.whatsapp.net/sticker";function p(){return(p=(0,i.default)((function*(e,t){var r={id:e,lg:u.default.getLocale()},a=d.default.build(f,r),n=yield(0,o.default)(a,{signal:null==t?void 0:t.signal}),i=new l.default.StickerCommonQueryToStaticServer;if(i.set({httpResponseCode:n.status,params:new c.default(r).toString(),queryType:l.default.QUERY_TYPE.STICKER_PACK_DATA}),i.commit(),!n.ok)throw new s.InvalidServerResponseError(a,n.status.toString(),"Invalid response from WhatsApp stickers endpoint");var p=yield n.json();if(null==p||0===p.length)throw new s.InvalidServerResponseError(a,n.status.toString(),"Invalid response from WhatsApp stickers endpoint: ".concat(JSON.stringify(p)));return p[0].stickers.map(((e,t)=>({mimetype:e.mimetype,width:e.width,height:e.height,index:t,filehash:e["file-hash"],directPath:e["direct-path"],mediaKey:e["media-key"],id:e["file-hash"],deprecatedMms3Url:e.url,encFilehash:e["enc-file-hash"],mediaKeyTimestamp:0})))}))).apply(this,arguments)}},23751:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.createGroup=function(e,t,r,a,n=!1){return b(e,t,r,a,void 0,n)},t.sendForNeededAddRequest=A;var i=n(r(70417)),s=n(r(19976)),o=a(r(2784)),u=r(12073),l=n(r(43334)),d=n(r(79711)),c=n(r(7470)),f=r(58665),p=r(19741),h=n(r(18120)),_=n(r(17957)),m=r(75613),g=n(r(15118)),v=n(r(49213)),E=r(75637);function y(){var e=(0,s.default)(["Assertion failed!"]);return y=function(){return e},e}function S(){var e=(0,s.default)(["createGroup failed to set picture."]);return S=function(){return e},e}function T(){var e=(0,s.default)(["models:chatCollection:createGroup dropped"]);return T=function(){return e},e}function b(e,t,r,a,n=(0,u.genId)(),i=!1){var s=a.map((e=>e.id)),c=void 0,h=(0,f.sendCreateGroup)(e,s,c,(0,v.default)(),!1,!1,i),E=new u.ActionType(_.default.t(98)),y=h.then((t=>(A(t,e,c),new u.ActionType(_.default.t(97))))).catchType(p.ServerStatusCodeError,(e=>406===e.status?new u.ActionType(_.default.t(93)+" "+_.default.t(94)):429===e.status?new u.ActionType(_.default.t(93)+" "+_.default.t(95)):void 0)).catch((()=>(__LOG__(3)(T()),new u.ActionType(_.default.t(93),{actionText:_.default.t(199),actionHandler:()=>b(e,t,r,a,n)}))));return d.default.openToast(o.createElement(u.ActionToast,{id:n,initialAction:E,pendingAction:y})),h.then((e=>{if(e.gid&&l.default.find(e.gid).then((e=>{d.default.openChatBottom(e).then((t=>{t&&d.default.focusChatTextInput(e)}))})),!e._duplicate&&t&&r){var a=g.default.gadd(e.gid);return(0,m.setProfilePic)(a,t,r)}e._duplicate&&__LOG__(3)(S())})).catchType(p.ServerStatusCodeError,(()=>{}))}function A(e,t,r,a){if(h.default.supportsFeature(h.default.F.GROUPS_V_4_JOIN_PERMISSION)&&e.participants){var n=a||e.gid;n||(__LOG__(4,void 0,new Error,!0)(y()),SEND_LOGS("Group add request was provided with undefined gid"));var s=e.participants.reduce(((e,t)=>{var r=Object.keys(t)[0];if("403"!==t[r].code)return e;var a=(0,E.createWid)(r),n=c.default.gadd(a,{silent:!0});return[...e,(0,i.default)((0,i.default)({},t[r]),{},{contact:n})]}),[]);s.length>0&&n&&d.default.openGroupV4InviteRequestFlow(s,n,t,r)}}},71142:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.sendExitGroup=function(e){return g((0,h.unproxy)(e))},t.localExitGroup=v;var i=n(r(19976)),s=a(r(2784)),o=r(12073),u=n(r(79711)),l=r(19741),d=a(r(96452)),c=r(14809),f=r(95595),p=n(r(17957)),h=r(64658);function _(){var e=(0,i.default)(["failed to merge chat table"]);return _=function(){return e},e}function m(){var e=(0,i.default)(["actions:chat:sendExit dropped"]);return m=function(){return e},e}function g(e){var{isGroup:t,promises:r}=e;if(!t)return Promise.reject(new d.ActionError);if(r.sendExit)return r.sendExit;var a=r.sendExit=(0,c.sendExitGroup)(e.id),n=new o.ActionType(p.default.t(108)),i=a.then((function(){return new o.ActionType(p.default.t(107))})).catchType(l.ServerStatusCodeError,(e=>{if(e.status>=400)return new o.ActionType(p.default.t(106))})).catch((function(){return __LOG__(3)(m()),new o.ActionType(p.default.t(106),{actionText:p.default.t(199),actionHandler:()=>g(e)})}));return u.default.openToast(s.createElement(o.ActionToast,{id:(0,o.genId)(),initialAction:n,pendingAction:i})),a.then((t=>{t._duplicate||v(e)})).finally((()=>{r.sendExit=null})).catchType(l.ServerStatusCodeError,(()=>{}))}function v(e){e.isGroup&&(e.groupMetadata.participants.remove((0,f.getMaybeMeUser)()),(0,c.markExited)(e.id).then((()=>{e.isReadOnly=!0})).catch((()=>{throw __LOG__(4,!0,new Error,!0)(_()),SEND_LOGS("failed to merge chat table when exiting group"),new Error("failed to merge chat table")})))}},70185:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.handleGroupAction=function(e,t,r){return function(e,t,r){var{action:a}=r;switch(r.action){case l.SUBJECT:var n={name:r.subject};return e.contact.set(n),(0,i.persistGroupMetadata)(e.groupMetadata.id,{subject:r.subject});case l.ADD:case l.PROMOTE:case l.DEMOTE:var o=r.participants.map((e=>({id:e,isAdmin:"promote"===a})));e.groupMetadata.participants.add(o,{merge:!0}),"add"===a&&r.participants.forEach((t=>{s.default.trigger("group_participant_change_".concat(t.toString()),e.id)}));break;case l.REMOVE:var d=e.groupMetadata;r.participants.forEach((e=>{d.participants.remove(e)})),r.participants.forEach((t=>{s.default.trigger("group_participant_change_".concat(t.toString()),e.id)}));break;case l.MODIFY:if(t&&r.participants&&r.participants.length>0){var c=r.participants[0],f=e.groupMetadata.participants.remove(t),p=!1,h=!1;f&&f.length&&f[0]&&(p=f[0].isAdmin,h=f[0].isSuperAdmin);var _={id:c,isAdmin:p,isSuperAdmin:h};e.groupMetadata.participants.add(_)}break;case l.INVITE_CODE:r.code?e.groupMetadata.inviteCode=r.code:__LOG__(3)(u(),r.code,e.id.toString());break;case l.DESC_ADD:return e.groupMetadata.set({desc:r.desc,descId:r.descId,descTime:r.descTime,descOwner:null==t?void 0:t.toString()}),(0,i.persistGroupMetadata)(e.groupMetadata.id,{desc:r.desc,descId:r.descId,descTime:r.descTime,descOwner:null==t?void 0:t.toString()});case l.DESC_REMOVE:if(e.groupMetadata.descId===r.descId)return e.groupMetadata.set({desc:void 0,descId:void 0,descTime:void 0,descOwner:void 0}),(0,i.persistGroupMetadata)(e.groupMetadata.id,{desc:void 0,descId:void 0,descTime:void 0,descOwner:void 0});break;case l.RESTRICT:return e.groupMetadata.restrict=!!r.value,(0,i.persistGroupMetadata)(e.groupMetadata.id,{restrict:!!r.value});case l.ANNOUNCE:return e.groupMetadata.announce=!!r.value,(0,i.persistGroupMetadata)(e.groupMetadata.id,{announce:!!r.value});case l.NO_FORWARD:return e.groupMetadata.noFrequentlyForwarded=!!r.value,(0,i.persistGroupMetadata)(e.groupMetadata.id,{noFrequentlyForwarded:!!r.value});case l.EPHEMERAL:return e.groupMetadata.ephemeralDuration=r.duration,(0,i.persistGroupMetadata)(e.groupMetadata.id,{ephemeralDuration:r.duration})}return Promise.resolve()}((0,o.unproxy)(e),t,r)},t.GROUP_ACTIONS=void 0;var n=a(r(19976)),i=r(60156),s=a(r(99922)),o=r(64658);function u(){var e=(0,n.default)(["model:chat:handleGroupAction:invalid invite code: "," for ",""]);return u=function(){return e},e}var l=Object.freeze({SUBJECT:"subject",ADD:"add",PROMOTE:"promote",DEMOTE:"demote",REMOVE:"remove",MODIFY:"modify",INVITE_CODE:"invite",DESC_ADD:"desc_add",DESC_REMOVE:"desc_remove",RESTRICT:"restrict",ANNOUNCE:"announce",NO_FORWARD:"no_frequently_forwarded",EPHEMERAL:"ephemeral"});t.GROUP_ACTIONS=l},69007:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.handleGroupActionWap=function(){return g.apply(this,arguments)},t.handleGroupActionMD=function(e,t){if(o.default.supportsFeature(o.default.F.MD_BACKEND))return function(){return E.apply(this,arguments)}(e,t);return Promise.reject(new Error("handleGroupActionMD: only supported on MD"))},t.handleGroupCreation=function(e,t){if(o.default.supportsFeature(o.default.F.MD_BACKEND))return function(){return v.apply(this,arguments)}(e,t);return Promise.reject(new Error("handleGroupCreation: should not be called in wap mode"))};var n=a(r(70417)),i=a(r(19976)),s=a(r(52954)),o=a(r(18120)),u=r(70185),l=r(51803),d=a(r(46774)),c=a(r(7470)),f=r(11008),p=r(88528),h=r(27485),_=r(83035);function m(){var e=(0,i.default)(["model:chat: unknown chat for ",", action ",""]);return m=function(){return e},e}function g(){return(g=(0,s.default)((function*(e,t){var{chatId:a,author:n}=e,i=r(43334).default.get(a);if(i){if(t.action===u.GROUP_ACTIONS.SUBJECT){var s={name:t.subject};yield(0,l.updateLocal)(i.contact.id,s)}(0,u.handleGroupAction)(i,n,t)}else __LOG__(3)(m(),a.toString(),JSON.stringify(t))}))).apply(this,arguments)}function v(){return(v=(0,s.default)((function*(e,t){var{chatId:a,author:i,pushname:s}=e;i&&s&&(0,p.updatePushname)(i,s),yield Promise.all([(0,_.updateParticipants)(t.id,t.participants,t.pvId),(0,h.updateGroupMetadataTable)([t])]);var o=r(43334).default,u=o.get(a);if(u)return u.groupMetadata.set(t),Promise.resolve();var l=new d.default({id:a,t:t.creation});l.groupMetadata.set(t),t.subject&&[].push({id:t.id,change:{name:t.subject}});var m=(0,n.default)((0,n.default)({},l.toJSON()),{},{id:a.toString()});yield(0,f.getChatTable)().create(m),o.add(l),c.default.gadd(t.id).set({name:t.subject})}))).apply(this,arguments)}function E(){return(E=(0,s.default)((function*(e,t){var{chatId:a,author:n,pushname:i}=e;n&&i&&(0,p.updatePushname)(n,i);var s=[],o=r(43334).default.get(a);switch(t.action){case u.GROUP_ACTIONS.ADD:s.push((0,_.addParticipants)(a,t.participants,t.version,t.prevVersion));break;case u.GROUP_ACTIONS.REMOVE:s.push((0,_.removeParticipants)(a,t.participants,t.version,t.prevVersion));break;case u.GROUP_ACTIONS.DEMOTE:s.push((0,_.demoteParticipants)(a,t.participants,t.version,t.prevVersion));break;case u.GROUP_ACTIONS.PROMOTE:s.push((0,_.promoteParticipants)(a,t.participants,t.version,t.prevVersion))}yield Promise.all(s),o&&(0,u.handleGroupAction)(o,n,t)}))).apply(this,arguments)}},70574:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.queryGroupFromPhone=function(e){return(0,l.groupMetadataFindFromPhone)(e).then((t=>"ok"===t.status?t.data:"missing"!==t.status?"error"===t.status?(__LOG__(3)(d(),t.info),Promise.reject(new Error("model:GroupMetadata:find error"))):void 0:void(0,s.default)((()=>{r(43334).default.assertGet(e).delete()}))))},t.queryGroupInviteInfo=function(e){return(0,l.sendQueryGroupInvite)(e).then((e=>{var{status:t,subject:a}=e,i=(0,n.default)(e,["status","subject"]),s=new u.default(i);o.default.gadd(s.id);var l=r(43334).default.get(s.id);return{status:t,subject:a,groupMetadata:s,inGroup:!!l&&!l.isReadOnly}}))};var n=a(r(22220)),i=a(r(19976)),s=a(r(98874)),o=a(r(7470)),u=a(r(30440)),l=r(90401);function d(){var e=(0,i.default)(["model:GroupMetadata:find error ",""]);return d=function(){return e},e}},27485:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.queryAndUpdateAllGroupMetadata=function(){return(0,l.queryAllGroups)().then(function(){var e=(0,i.default)((function*(e){e&&(yield p(e),yield _(e),e.forEach(f))}));return function(){return e.apply(this,arguments)}}())},t.queryAndUpdateGroupMetadataById=function(e){if(s.default.supportsFeature(s.default.F.MD_BACKEND))return(0,l.queryGroup)(e).then(function(){var e=(0,i.default)((function*(e){yield p([e]),yield _([e]),f(e)}));return function(){return e.apply(this,arguments)}}());return Promise.resolve()},t.updateGroupMetadataTable=p;var n=a(r(70417)),i=a(r(52954)),s=a(r(18120)),o=a(r(99922)),u=r(11008),l=r(88258),d=r(90401),c=r(77993);function f(e){var t;(0,d.updateSubject)(e.id,e.subject),o.default.gadd(e.id).set({id:e.id,owner:e.owner,creation:e.creation,desc:e.desc,descId:e.descId,descOwner:e.descOwner,descTime:e.descTime,restrict:e.restrict||!1,announce:e.announce||!1,noFrequentlyForwarded:e.noFrequentlyForwarded||!1,ephemeralDuration:e.ephemeralDuration||0,participants:e.participants,support:null!==(t=e.support)&&void 0!==t&&t})}function p(){return h.apply(this,arguments)}function h(){return(h=(0,i.default)((function*(e){if(s.default.supportsFeature(s.default.F.MD_BACKEND)){var t=[];return yield(0,c.getStorage)().lock(["group-metadata"],function(){var r=(0,i.default)((function*([r]){var a=yield r.bulkGet(e.map((e=>e.id.toString())));t=e.map(((e,t)=>{var r,i,s,o=a[t],u={subject:e.subject,subjectTime:e.subjectTime||0},l={announce:e.announce,a_v_id:e.a_v_id||0},d={desc:e.desc,descId:e.descId,descOwner:null===(r=e.descOwner)||void 0===r?void 0:r.toString(),descTime:e.descTime||0};if(o){var c=o.subjectTime||0,f=o.a_v_id||0,p=o.descTime||0;c>u.subjectTime&&(u={subject:o.subject,subjectTime:c}),f>l.a_v_id&&(l={announce:o.announce,a_v_id:f}),p>d.descTime&&(d={desc:o.desc,descId:o.descId,descOwner:o.descOwner,descTime:p})}return(0,n.default)((0,n.default)((0,n.default)({id:e.id.toString(),creation:e.creation,owner:null===(i=e.owner)||void 0===i?void 0:i.toString(),restrict:e.restrict,noFrequentlyForwarded:e.noFrequentlyForwarded,ephemeralDuration:e.ephemeralDuration||0,size:e.size||0,support:null!==(s=e.support)&&void 0!==s&&s},u),d),l)}))}));return function(){return r.apply(this,arguments)}}()),(0,u.getGroupMetadataTable)().bulkCreateOrMerge(t)}yield Promise.resolve()}))).apply(this,arguments)}function _(){return m.apply(this,arguments)}function m(){return(m=(0,i.default)((function*(e){if(s.default.supportsFeature(s.default.F.MD_BACKEND)){var t=yield(0,u.getParticipantTable)().bulkGet(e.map((e=>e.id.toString()))),r=new Map;t.forEach((e=>e&&r.set(e.groupId,e.senderKey)));var a=e.map((e=>{var t,a=[],n=[],i=e.id.toString(),s=r.get(i)||new Map;return null===(t=e.participants)||void 0===t||t.forEach((e=>{e.isAdmin&&n.push(e.id),a.push(e.id),s.set(String(e.id),!1)})),{groupId:i,participants:a.map(String),admins:n.map(String),senderKey:s,rotateKey:!1,deviceSyncComplete:!1}}));return(0,u.getParticipantTable)().bulkCreateOrReplace(a)}yield Promise.resolve()}))).apply(this,arguments)}},83035:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.updateParticipants=function(){return h.apply(this,arguments)},t.addParticipants=function(){return _.apply(this,arguments)},t.removeParticipants=function(e,t,a,n){if(s.default.supportsFeature(s.default.F.MD_BACKEND))return null==a?Promise.reject(new Error("removeParticipants: incoming change missing version id")):(0,u.updateParticipants)(e,{action:u.PARTICIPANT_OPERATION.REMOVE,participants:t,version:a,prevVersion:n}).catchType(u.GroupUnSyncedError,(()=>{__LOG__(3)(p()),(0,r(90401).sendQueryGroup)(e)}));return Promise.resolve()},t.demoteParticipants=function(){return m.apply(this,arguments)},t.promoteParticipants=function(){return g.apply(this,arguments)};var n=a(r(19976)),i=a(r(52954)),s=a(r(18120)),o=r(47882),u=r(51878),l=r(75637);function d(){var e=(0,n.default)(["promoteParticipants: out-of-sync group notification"]);return d=function(){return e},e}function c(){var e=(0,n.default)(["demoteParticipants: out-of-sync group notification"]);return c=function(){return e},e}function f(){var e=(0,n.default)(["addParticipants: out-of-sync group notification"]);return f=function(){return e},e}function p(){var e=(0,n.default)(["removeParticipants: out-of-sync group notification"]);return p=function(){return e},e}function h(){return(h=(0,i.default)((function*(e,t,r){if(s.default.supportsFeature(s.default.F.MD_BACKEND)){var a=[],n=[];t.forEach((e=>{e.isAdmin&&n.push(e.id),a.push(e.id)}));var i=yield v(a);return(0,u.replaceParticipants)(e,a,n,i,r)}yield Promise.resolve()}))).apply(this,arguments)}function _(){return(_=(0,i.default)((function*(e,t,a,n){if(s.default.supportsFeature(s.default.F.MD_BACKEND)){if(null==a)throw new Error("addParticipants: incoming change missing version id");var i=yield v(t);return(0,u.updateParticipants)(e,{action:u.PARTICIPANT_OPERATION.ADD,participants:t,deviceIds:i,version:a,prevVersion:n}).catchType(u.GroupUnSyncedError,(()=>{__LOG__(3)(f()),(0,r(90401).sendQueryGroup)(e)}))}yield Promise.resolve()}))).apply(this,arguments)}function m(){return(m=(0,i.default)((function*(e,t,a,n){if(s.default.supportsFeature(s.default.F.MD_BACKEND)){if(null==a)throw new Error("demoteParticipants: incoming change missing version id");return(0,u.updateParticipants)(e,{action:u.PARTICIPANT_OPERATION.DEMOTE,participants:t,version:a,prevVersion:n}).catchType(u.GroupUnSyncedError,(()=>{__LOG__(3)(c()),(0,r(90401).sendQueryGroup)(e)}))}yield Promise.resolve()}))).apply(this,arguments)}function g(){return(g=(0,i.default)((function*(e,t,a,n){if(s.default.supportsFeature(s.default.F.MD_BACKEND)){if(null==a)throw new Error("promoteParticipants: incoming change missing version id");return(0,u.updateParticipants)(e,{action:u.PARTICIPANT_OPERATION.PROMOTE,participants:t,version:a,prevVersion:n}).catchType(u.GroupUnSyncedError,(()=>{__LOG__(3)(d()),(0,r(90401).sendQueryGroup)(e)}))}yield Promise.resolve()}))).apply(this,arguments)}function v(){return E.apply(this,arguments)}function E(){return(E=(0,i.default)((function*(e){var t=yield(0,o.syncAndGetDeviceList)(e),r=[];return t.forEach(((t,a)=>{if(t){var{devices:n,id:i}=t;r=r.concat(n.map((e=>(0,l.createDeviceWidFromUserAndDevice)(i,e))))}else r.push(e[a])})),r}))).apply(this,arguments)}},53603:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t=!0){if(!(0,i.getMaybeMeUser)().equals(e.id)){var r=s.default.get(e.id);r&&("unsubscribe"===e.type?r.set({isSubscribed:!1,stale:!0}):(!function(e,t){var r,a=!1;void 0===t.type?t.type=e.chatstate.type||"unavailable":"paused"===t.type&&(a=!0,t.type="available");e.isGroup&&"available"!==t.type&&(t.updateTime=Date.now());if(e.isGroup){if(!t.participant)return;t.id=t.participant,t.participant=void 0,r=e.chatstates.gadd(t.id)}else r=e.chatstate;a&&"composing"!==r.type&&"recording"!==r.type||r.set(t);r.expireTimerId&&clearTimeout(r.expireTimerId);"composing"===r.type||"recording"===r.type?r.expireTimerId=setTimeout((()=>function(e){var t=e.type;"composing"!==t&&"recording"!==t||(e.type="available")}(r)),n.default.PRESENCE_COMPOSING_TIMEOUT):r.expireTimerId=void 0;var i=e.forceDisplay||e.isOnline||e.isUser&&!e.chatstate.deny;e.set({hasData:!0,forceDisplay:i})}(r,e),t&&r.set({stale:!1})))}return Promise.resolve()};var n=a(r(50935)),i=r(95595),s=a(r(99098))},95303:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.changeProfilePicThumb=function(e,t){return n.default.imageChanged(e,t),Promise.resolve()};var n=a(r(15118))},27857:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.updateMsgAck=c,t.processOrphanAck=function(e,t){var r=o.default.get(e);if(!r)return Promise.reject("processOrphanAck: no msg found for id ".concat(e.toString()));return(0,i.getHighestAck)(r).then((e=>{if(e&&e.ack!==r.ack)return c(r,t,e)})).catch((()=>{__LOG__(4,void 0,new Error,!0)(d()),SEND_LOGS("processOrphanAck failed")}))};var n=a(r(19976)),i=r(45492),s=r(11824),o=a(r(58885)),u=a(r(68384)),l=r(75637);function d(){var e=(0,n.default)(["Assertion failed!"]);return d=function(){return e},e}function c(e,t,r){var{ack:a,t:n,from:i,to:o}=r,{remote:d,id:c}=e.id;e.updateAck(a,n);var f=(0,s.getBridge)();return f.sendAndReceive("msg_collection","updateLastReceipt",{wid:d,t:n}).then((()=>u.default.isUser(d)?f.sendAndReceive("msg_info_collection","updateInfo",{id:c,from:i,to:o,ack:a,participant:d,t:n}).then((()=>{if(t&&u.default.isBroadcast(t)){var e=t instanceof u.default?t:(0,l.createWid)(t);return f.sendAndReceive("msg_info_collection","updateInfo",{id:c,from:i,to:e,ack:a,participant:d,t:n})}})):u.default.isStatusV3(d)?f.sendAndReceive("msg_info_collection","updateInfo",{id:c,from:i,to:d,ack:a,participant:o,t:n}):void 0))}},79813:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.handleForActiveMessageRange=E,t._rangeContainsMessage=S,t.handleOfflineForMessageRange=function(){return T.apply(this,arguments)},t.ActiveRangeHandlerAction=t.RangeContain=void 0;var i=n(r(19976)),s=n(r(52954)),o=n(r(50935)),u=r(44880),l=a(r(71380)),d=r(75637),c=r(16976);function f(){var e=(0,i.default)(["syncd: missing message range from row."]);return f=function(){return e},e}var p=new Set,h=r(28103).Mirrored(["DOES_NOT_CONTAIN","CONTAINS_BY_TIMESTAMP","CONTAINS_BY_ADDITIONAL"]);t.RangeContain=h;var _=r(28103).Mirrored(["DropMessage","SkipUI"]);t.ActiveRangeHandlerAction=_;var m=e=>e.reduce(((e,t)=>new Set([...e,...t])),new Set);function g(){return v.apply(this,arguments)}function v(){return(v=(0,s.default)((function*(e,t,r){switch(e.action){case"archive":return e.actionValue.archived?yield l.handleForArchive(e,r):yield l.handleForUnarchive(e,r),p;case"markChatAsRead":return yield l.handleForMarkAsReadUnread(e,r,!!e.actionValue.read),p}return p}))).apply(this,arguments)}function E(){return y.apply(this,arguments)}function y(){return(y=(0,s.default)((function*(e,t){if(o.default.SYSTEM_MESSAGE_TYPES.includes(t.type))return p;var r=(yield(0,c.getActiveMessageRanges)(e.toString())).map((e=>[e,S(e.actionValue.messageRange,t)])),a=r.filter((([,e])=>e===h.CONTAINS_BY_ADDITIONAL)).map((([e])=>e));a.forEach((e=>{e.remainingMessages--})),yield(0,c.bulkUpdateActiveMessageRanges)(a);var n=r.map((([e,r])=>g(e,t,r))),i=yield Promise.all(n);return m(i)}))).apply(this,arguments)}function S(e,t){if(null==e)return __LOG__(3)(f()),h.DOES_NOT_CONTAIN;var{messages:r,lastMessageTimestamp:a}=e;if(null!=t.t&&null!=a&&t.t<(0,u.numberOrThrowIfTooLarge)(a))return h.CONTAINS_BY_TIMESTAMP;var n=t.id;for(var{key:i}of r)if(null!=i&&null!=n&&i.id===n.id)return h.CONTAINS_BY_ADDITIONAL;return h.DOES_NOT_CONTAIN}function T(){return(T=(0,s.default)((function*(e){var t=new Map;e.forEach((e=>{if(!o.default.SYSTEM_MESSAGE_TYPES.includes(e.type)){var r=t.get(e.id.remote.toString());(null==r||r.t<e.t)&&t.set(e.id.remote.toString(),e)}})),yield Promise.all([...t.entries()].map((([e,t])=>E((0,d.createWid)(e),t))))}))).apply(this,arguments)}},71380:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.handleForArchive=function(){return l.apply(this,arguments)},t.handleForUnarchive=function(){return d.apply(this,arguments)},t.handleForMarkAsReadUnread=function(){return c.apply(this,arguments)};var n=a(r(52954)),i=r(16976),s=r(79813),o=a(r(43334)),u=r(75637);function l(){return(l=(0,n.default)((function*(e,t){t===s.RangeContain.DOES_NOT_CONTAIN&&(r(33729).default.setArchive([{id:e.chatId,archive:!1}]),yield(0,i.removeActiveMessageRange)(e.chatId,e.action))}))).apply(this,arguments)}function d(){return(d=(0,n.default)((function*(e,t){t!==s.RangeContain.DOES_NOT_CONTAIN&&0!==e.remainingMessages||(yield(0,i.removeActiveMessageRange)(e.chatId,e.action))}))).apply(this,arguments)}function c(){return(c=(0,n.default)((function*(e,t,a){if(t===s.RangeContain.DOES_NOT_CONTAIN)yield(0,i.removeActiveMessageRange)(e.chatId,e.action);else if(0===e.remainingMessages){var n=o.default.get((0,u.createWid)(e.chatId));if(n){var l=r(58269);a?l.markSeen(n):l.markUnseen(n)}yield(0,i.removeActiveMessageRange)(e.chatId,e.action)}}))).apply(this,arguments)}},39778:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.handleSingleMsgMD=function(){return v.apply(this,arguments)},t.handleMsgsMD=function(e,t){var r=t.length;if(!r)return Promise.resolve();if(!(e instanceof l.default))return Promise.resolve();for(var a={add:"before",isHistory:!0},n=0;n<r;n++){t[n].invis=!0}var i=(0,o.getBridge)();return i.fireAndForget("msg_collection","trigger",{name:"handle:msg_history",args:{count:t.length}}),(0,u.storeMessages)(t,e,!0).then((()=>{(0,f.checkOrphanMutations)(t.map((e=>e.id.toString())),[e.toString()])})).then((()=>i.sendAndReceive("msg_collection","processMultipleMessages",{chatId:e,msgObjs:t,meta:a,chatMsgsCollection:null}))).catchType(s.LogoutDrop,(()=>{})).catch((t=>{__LOG__(4,void 0,new Error,!0)(g(),r,String(e),t.name,t.message,t.stack),SEND_LOGS("msg_handler for MD: error storing/processing multiple messages")}))},t.handleInitialSyncMsgs=function(e){var t={add:"last",isHistory:!0},r=Object.keys(e).map((r=>(0,o.getBridge)().sendAndReceive("msg_collection","processMultipleMessages",{chatId:(0,d.createWid)(r),msgObjs:e[r].msgs,meta:t,chatMsgsCollection:null})));return Promise.all([...r,(0,u.storeInitialSyncMessages)(e)]).then((()=>{var t=Array.prototype.concat(...Object.keys(e).map((t=>e[t].msgs.map((e=>e.id.toString())))));return(0,f.checkOrphanMutations)(t,Object.keys(e))})).then((()=>{})).catchType(s.LogoutDrop,(()=>{})).catch((e=>{__LOG__(4,void 0,new Error,!0)(m(),e.name,e.message,e.stack),SEND_LOGS("msg_handler for MD: error storing/processing multiple messages")}))},t.handleProgressiveHistorySyncMsgs=function(e,t){return Promise.resolve().then((()=>(0,u.storeRecentAndFullHistSyncMessages)(e,t,!0,!0).then((()=>{var r=t.map((e=>e)),a=e.map((e=>e.id.toString()));return(0,f.checkOrphanMutations)(a,r)})).then((()=>{})).catchType(s.LogoutDrop,(()=>{})).catch((e=>{__LOG__(4,void 0,new Error,!0)(_(),e.name,e.message,e.stack),SEND_LOGS("handleProgressiveHistorySyncMsgs: error storing/processing multiple messages")}))))};var n=a(r(19976)),i=a(r(52954)),s=r(19741),o=r(11824),u=r(12425),l=a(r(68384)),d=r(75637),c=r(79813),f=r(62147);function p(){var e=(0,n.default)(["Msg: "," chat: "," Error: ",", message: ",", stack: ",""]);return p=function(){return e},e}function h(){var e=(0,n.default)(["checkOrphanMutations failed during handleSingleMsgMD for: "," chat: "," Error: ",", message: ",", stack: ",""]);return h=function(){return e},e}function _(){var e=(0,n.default)(["Error: ",", message: ",", stack: ",""]);return _=function(){return e},e}function m(){var e=(0,n.default)(["Error: ",", message: ",", stack: ",""]);return m=function(){return e},e}function g(){var e=(0,n.default)(["Msgs count: "," Chat: "," Error: ",", message: ",", stack: ",""]);return g=function(){return e},e}function v(){return(v=(0,i.default)((function*(e,t,r=!1){var a,n=(0,o.getBridge)(),i=yield(0,c.handleForActiveMessageRange)(e,t);if(!i.has(c.ActiveRangeHandlerAction.DropMessage)){a=i.has(c.ActiveRangeHandlerAction.SkipUI);try{l.default.isStatusV3(e)&&(yield n.sendAndReceive("status_v3_collection","handleUpdate",{rawMsg:t,checksum:null,isMsgUpdate:!1})),r?yield(0,u.updateMessage)(t):yield(0,u.storeMessages)([t],e);try{yield(0,f.checkOrphanMutations)([t.id.toString()],[e.toString()])}catch(r){__LOG__(4,void 0,new Error)(h(),String(t.id),String(e),r.name,r.message,r.stack)}a||(t.recvFresh=!0,t.isNewMsg=!0,yield n.sendAndReceive("msg_collection","processMultipleMessages",{chatId:e,msgObjs:[t],meta:{add:"after",update:!1,isHistory:!1}}))}catch(r){if(r instanceof s.LogoutDrop)return;__LOG__(4,void 0,new Error,!0)(p(),String(t.id),String(e),r.name,r.message,r.stack),SEND_LOGS("msg_handler for MD: error storing/processing single message")}}}))).apply(this,arguments)}},7195:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.markMdDowngrade=function(e){return(0,s.updateLocal)(e,{mdDowngrade:!0}).then((()=>{var t=i.default.get(e);t&&(t.mdDowngrade=!0)})).catch((e=>{__LOG__(4,void 0,new Error,!0)(o(),e),SEND_LOGS("markMdDowngrade failed")}))};var n=a(r(19976)),i=a(r(58885)),s=r(4526);function o(){var e=(0,n.default)(["markMdDowngrade: failed with error ",""]);return o=function(){return e},e}},22952:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.updateMsgInfo=function(e,t,r,a){if(i.default.supportsFeature(i.default.F.MD_BACKEND))return function(e,t,r,a){var n=e.id;o.default.isUser(n.remote)?function(e,t,r,a){t===u.PLAYED?(e.played.get(r)||(e.playedRemaining-=1),e.played.add({id:r,t:a})):t===u.READ?(e.read.get(r)||(e.readRemaining-=1),e.read.add({id:r,t:a})):t===u.RECEIVED&&(e.delivery.get(r)||(e.deliveryRemaining-=1),e.delivery.add({id:r,t:a}))}(e,t,r,a):function(e,t,r,a){var n=u.CLOCK;e.played.get(r)?n=u.PLAYED:e.read.get(r)?n=u.READ:e.delivery.get(r)&&(n=u.RECEIVED);if(t<=n)return;if(t>u.RECEIVED){var i=e.delivery.get(r);i?e.delivery.remove(i):e.deliveryRemaining-=1}if(t>u.READ){var s=e.read.get(r);s?e.read.remove(s):e.readRemaining-=1}t===u.PLAYED?(e.played.get(r)||(e.playedRemaining-=1),e.played.add({id:r,t:a})):t===u.READ?(e.read.get(r)||(e.readRemaining-=1),e.read.add({id:r,t:a})):t===u.RECEIVED&&(e.delivery.get(r)||(e.deliveryRemaining-=1),e.delivery.add({id:r,t:a}))}(e,t,r,a)}((0,s.unproxy)(e),t,r,a);return function(e,t,r,a){var n=e.id;if(!o.default.isUser(n.remote)){if(t!==u.RECEIVED){var i=e.delivery.get(r);i&&e.delivery.remove(i)}if(t!==u.READ){var s=e.read.get(r);s&&e.read.remove(s)}if(t!==u.PLAYED){var l=e.played.get(r);l&&e.played.remove(l)}}t===u.PLAYED?(e.played.get(r)||(e.playedRemaining-=1),e.played.add({id:r,t:a})):t===u.READ?(e.read.get(r)||(e.readRemaining-=1),e.read.add({id:r,t:a})):t===u.RECEIVED&&(e.delivery.get(r)||(e.deliveryRemaining-=1),e.delivery.add({id:r,t:a}))}((0,s.unproxy)(e),t,r,a)};var n=a(r(50935)),i=a(r(18120)),s=r(64658),o=a(r(68384)),{ACK:u}=n.default},81233:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t._processMultipleMessages=function(){return b.apply(this,arguments)};var i=n(r(19976)),s=n(r(52954)),o=n(r(14952)),u=n(r(19899)),l=n(r(50935)),d=r(95595),c=n(r(44643)),f=n(r(18120)),p=r(28278),h=r(96645),_=a(r(57556)),m=n(r(67110)),g=n(r(49569)),v=n(r(72424)),E=r(95197),y=n(r(68384));function S(){var e=(0,i.default)(["Assertion failed! ",""]);return S=function(){return e},e}function T(){var e=(0,i.default)(["Get empty message with id ","."]);return T=function(){return e},e}function b(){return(b=(0,s.default)((function*(e,t,a,n){var{filteredRecs:i,reorderRecs:s,updates:S}=(0,c.default)(e,t,a,n);yield Promise.all(S);var T,b=r(43334).default,C=r(58885).default;if(0===i.length&&0===s.length){if(e&&a.pendingMsgsDone){var P=b.get(e);P&&(P.pendingMsgs=!1)}return t.map((e=>C.get(e.id))).filter((e=>e))}if(!e)return A(i).then((()=>t.map((e=>C.get(e.id))).filter((e=>e&&!!e.chat))));if(y.default.isStatusV3(e)){var O=t[0],w=O.id.fromMe?(0,d.getMaybeMeUser)():O.author;T=r(57185).default.find(w)}else{if((0,E.shouldCreateChatWithMsgs)(t))T=b.find(e);else{var M=b.get(e);if(null==M)return[];T=Promise.resolve(M)}}var I,R,D=yield T,N=yield A(i),L="after"===a.add||"last"===a.add,k=!a.isHistory,U=!1;if("unread"===a.add?(I=n,D.msgChunks.push(I),R=a.firstUnreadKey):"last"===a.add&&a.resume?(I=n,U=!0):I="function"==typeof n?n():n,(0,o.default)(t,N,s,D,L,I||D.msgs,R,U),a.pendingMsgsDone&&(D.pendingMsgs=!1),k&&y.default.isBroadcast(e)&&!y.default.isStatusV3(e)&&N.forEach((function(e){e&&e.recvFresh&&!e.isNotification&&_.broadcastFanout(e)})),f.default.supportsFeature(f.default.F.RECENT_EMOJI_SYNC))for(var F=0;F<N.length;F++){var G=N[F];if(G&&G.isNewMsg&&G.isSentByMe&&G.containsEmoji){m.default.throttledSync();break}}if(f.default.isRecentStickersEnabled()){var x=N.map((e=>{if(e&&e.isNewMsg&&e.isSentByMe&&e.type===l.default.MSG_TYPE.STICKER){var{mediaData:t}=e;return{id:t.filehash,directPath:t.directPath,filehash:t.filehash,encFilehash:t.encFilehash,mediaKey:t.mediaKey,mediaKeyTimestamp:null!=t.mediaKeyTimestamp?t.mediaKeyTimestamp:u.default.globalUnixTime(),width:t.fullWidth,height:t.fullHeight,size:t.size,mimetype:t.mimetype,type:h.OUTWARD_TYPES.STICKER,index:0}}})).filter(Boolean);g.default.enqueue(x)}if(v.default.webDownloadDocumentThumbMmsEnabled&&N.map((e=>e.asDoc)).filter(Boolean).forEach((e=>{(0,p.downloadMmsThumbnail)({msg:e,isPreload:!0})})),f.default.supportsFeature(f.default.F.DOWNLOAD_STATUS_THUMB_MMS)&&y.default.isStatusV3(e)){var B=(0,d.getLastStatusUsage)();(null==B||Date.now()-B<12096e5)&&N.map((e=>e.asImage||e.asVideo)).filter(Boolean).forEach((e=>{(0,p.downloadStatusV3Thumbnail)({msg:e,isPreload:!0})}))}return t.map((e=>C.get(e.id))).filter((e=>e))}))).apply(this,arguments)}function A(e){var t=r(58885).default.add(e,{merge:!0});return f.default.supportsFeature(f.default.F.MD_BACKEND)&&(t=t.filter(((t,r)=>(null==t&&(__LOG__(4,void 0,new Error,!0)(T(),e[r].id),SEND_LOGS("msgPrepWork-empty-message")),null!=t)))),Promise.all(t.map((e=>e.waitForPrep().catch((e=>{__LOG__(4,void 0,new Error,!0)(S(),String(e)),SEND_LOGS("bad-msg-prep")}))))).then((()=>t))}},14952:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,r,a,n,i,u,l){var d=function(e,t,r,a,n){var i,s,u,l={},d={},c=r.length,f=n;if(0===c)return{msgs:t,collection:f};for(i=0;i<c;i++)s=r[i],d[s.id]=s;for(c=t.length,i=0;i<c;i++)(s=t[i])&&(l[s.id]=s);var p=[];for(c=e.length,i=0;i<c;i++)if((s=e[i])&&((u=l[s.id])&&p.push(u),u=d[s.id]))if(u.recvFresh)p.push(u),a.removeMsg(u),u.unset("recvFresh");else{var h=a.getAllCMCs().find((function(e){return e.get(u.id)}));n&&h===n||(h?(h.forEach((function(e){p.push(e),delete d[e.id]})),h===a.msgs?(a.replaceMsgsCollection(n),f=a.msgs):(a.notifyMsgCollectionMerge(n,h,n),a.removeMsgsCollection(h))):(__LOG__(3)(o(),s.id),p.push(d[s.id])))}return{msgs:p,collection:f}}(e,t,r,a,i);s.addRecordsToChat(d.msgs,a,n,d.collection,u,l)};var i=n(r(19976)),s=a(r(57556));function o(){var e=(0,i.default)(["models:Msg:reorder trying to merge CMC of orphaned message ",""]);return o=function(){return e},e}},44643:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a,n){var i=[],w=[],M=[],I=r(43334).default,R=r(58885).default;return t.forEach((function(t){var D;t.id instanceof p.default||(__LOG__(3)(O(),(new Error).stack),l.upload({reason:"forgot-to-create-msgkey"}),t.id=new p.default({from:t.from,to:t.to,id:t.id,participant:t.participant,selfDir:t.self})),(0,v.isString)(e)&&y.default.isBroadcast(e)&&delete t.broadcast,"ptt"===t.type&&!t.id.fromMe&&t.ack<d.default.ACK.CLOCK&&(t.ack=d.default.ACK.CLOCK),null!=t.hydratedButtons&&((D=t).buttons=new g.default,D.buttons.add(D.hydratedButtons.map(((e,t)=>{var r=null!=e.index?e.index:t,a="".concat(r);return e.quickReplyButton?new m.default({id:a,displayText:e.quickReplyButton.displayText,selectionId:e.quickReplyButton.id,subtype:"quick_reply"}):e.callButton?new m.default({id:a,displayText:e.callButton.displayText,phoneNumber:e.callButton.phoneNumber,subtype:"call"}):new m.default({id:a,displayText:e.urlButton.displayText,url:e.urlButton.url,subtype:"url"})})))),null!=t.dynamicReplyButtons&&function(e){e.replyButtons=new u.default,e.replyButtons.add(e.dynamicReplyButtons.map((({buttonId:e,buttonText:t})=>new o.default({id:e,displayText:null==t?void 0:t.displayText}))))}(t);var N=R.get(t.id);if(t.type===d.default.MSG_TYPE.PROTOCOL&&"ephemeral_setting"!==t.subtype)switch(t.subtype){case"revoke":if(N=R.get(t.protocolMessageKey)){var L=new R.constructor.model(t);y.default.equals(N.sender,L.sender)?(y.default.isStatusV3(e)&&N.msgChunk&&N.msgChunk.remove(N),(0,_.revoke)(N,L.id),y.default.isStatusV3(e)&&r(57185).default.find(N.sender).then((e=>{f.default.supportsFeature(f.default.F.QUERY_STATUS_V_3_THUMBNAIL)&&N&&N.msgChunk&&N.msgChunk.length!==e.totalCount&&E.default.statusQueryThumbnail(e.id)}))):__LOG__(3)(P(),L.id.toString(),N.id.toString())}break;case"ephemeral_sync_response":var k=I.get(t.id.remote);k&&(0,c.maybeUpdateEphemeralSetting)(k,t.ephemeralDuration,t.ephemeralSettingTimestamp);break;default:__LOG__(2)(C(),t.id.toString())}else if(N&&!N.asRevoked){for(var U in t.ack<N.ack&&delete t.ack,t)t.hasOwnProperty(U)&&void 0===t[U]&&delete t[U];t.id.fromMe&&!N.deprecatedMms3Url&&t.deprecatedMms3Url&&(t.phoneUploading=!1),a.isHistory&&(t.isNewMsg=!1);var F=N.t?(0,s.default)(t,["t","id","from","to"]):t,G=N.applyUpdate(F).then((()=>N));if(M.push(G),y.default.isBroadcast(N.id.remote)){var x=h.getBroadcastFanoutKeys(N);x&&x.forEach((e=>{var t=R.get(e);t&&M.push(t.applyUpdate(F).then((()=>N)))}))}a.isHistory&&(N.recvFresh||n)&&!N.search?(__LOG__(3)(A(),N.recvFresh?"dup:":"overlap:",String(N.id)),w.push(N)):a.isHistory&&N.search?(N.search=!1,__LOG__(3)(b(),String(N.id)),i.push({id:N.id})):"search"===a.add&&i.push({id:N.id})}else{h.typeIsMms(t)&&!t.deprecatedMms3Url&&(t.phoneUploading=t.id.fromMe&&t.ack===d.default.ACK.CLOCK);var B=I.get(t.id.remote);"search"===a.add&&(t.search=!0),a.update||i.push(t),!a.isHistory&&"search"!==a.add&&B&&function(e,t){if(!e.isNewMsg||!e.recvFresh)return __LOG__(3,void 0,void 0,!0)(S(),e.id.toString()),void SEND_LOGS("bad-process-live-message-call");e.type===d.default.MSG_TYPE.GP2&&"delete"===e.subtype&&(t.isReadOnly=!0);if(t.isUser){var r,a,n=null!==(r=e.ephemeralDuration)&&void 0!==r?r:0,i=!1;e.type===d.default.MSG_TYPE.PROTOCOL&&"ephemeral_setting"===e.subtype?a=e.t:e.ephemeralSettingTimestamp&&(a=e.ephemeralSettingTimestamp,i=!0);var s=!0;if(null!=a&&(s=(0,c.maybeUpdateEphemeralSetting)(t,n,a,i)),f.default.supportsFeature(f.default.F.MD_BACKEND)&&!h.isNotification(e.type,e.subtype)){var o,u,l=null!==(o=e.ephemeralDuration)&&void 0!==o?o:0,p=null!==(u=t.getEphemeralSetting())&&void 0!==u?u:0;e.ephemeralOutOfSync=l!==p&&!s}}}(t,B),t.ephemeralOutOfSync&&__LOG__(2)(T(),t.id.toString(),null==B?void 0:B.id.toString())}})),{filteredRecs:i,reorderRecs:w,updates:M}};var i=n(r(19976)),s=n(r(17620)),o=n(r(25764)),u=n(r(50760)),l=a(r(3594)),d=n(r(50935)),c=r(74253),f=n(r(18120)),p=n(r(77865)),h=a(r(57556)),_=r(74034),m=n(r(13274)),g=n(r(10750)),v=r(11419),E=n(r(76022)),y=n(r(68384));function S(){var e=(0,i.default)(["processLiveMessage should not be called with history message id ",""]);return S=function(){return e},e}function T(){var e=(0,i.default)(["ephemeralOutOfSync msgId="," chatId=",""]);return T=function(){return e},e}function b(){var e=(0,i.default)(["model:Msg:handle:processMM load search as history ",""]);return b=function(){return e},e}function A(){var e=(0,i.default)(["model:Msg:handle:processMM:","",""]);return A=function(){return e},e}function C(){var e=(0,i.default)(["unknown protocolMessage ",""]);return C=function(){return e},e}function P(){var e=(0,i.default)(["model:Msg:processMM revoke sender mismatch ",", ",""]);return P=function(){return e},e}function O(){var e=(0,i.default)(["_processMultipleMessages: el.id is not a MsgKey ",""]);return O=function(){return e},e}},74034:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.sendRevoke=function(e,t){return function(e,t){var{id:r,t:a}=e;if(!r.fromMe)return Promise.reject("revoking received message");var n=void 0;u.default.supportsFeature(u.default.F.MD_BACKEND)&&r.remote.isGroup()&&(n=(0,S.getMeUser)());var i=new h.default({id:(0,m.default)(),remote:e.id.remote,fromMe:!0,participant:n}),s={id:i,to:r.remote,t:a,type:o.default.MSG_TYPE.PROTOCOL,subtype:"revoke",protocolMessageKey:r,clearMedia:!!t,local:!0};return(0,c.storeMessages)([s],e.chat.id).catch((e=>{throw __LOG__(4,!0,new Error,!0)(A()),SEND_LOGS("storeMessages failed"),e})).then((()=>(0,g.sendMsgRecord)(new p.default(s)))).then((t=>{if(t===v.SendMsgResult.OK){var r=Math.trunc(Date.now()/1e3-e.t);return new f.default.SendRevokeMessage({messageType:e.getWamMessageType(),messageMediaType:e.getWamMediaType(),revokeSendDelay:r}).commit(),C(e,i).then((()=>v.SendMsgResult.OK))}return Promise.resolve(v.SendMsgResult.ERROR_UNKNOWN)}))}((0,E.unproxy)(e),t)},t.revoke=C;var i=n(r(19976)),s=n(r(8555)),o=n(r(50935)),u=n(r(18120)),l=r(57525),d=a(r(28278)),c=r(12425),f=n(r(40210)),p=n(r(27e3)),h=n(r(77865)),_=a(r(57556)),m=n(r(49213)),g=r(45591),v=r(59420),E=r(64658),y=n(r(68384)),S=r(95595);function T(){var e=(0,i.default)(["cannot fanout revoke: "," ",""]);return T=function(){return e},e}function b(){var e=(0,i.default)(["_revoke: failed to process revoke message"]);return b=function(){return e},e}function A(){var e=(0,i.default)(["_sendRevoke: failed to storeMessages into storage"]);return A=function(){return e},e}function C(e,t){return function(e,t){return(0,c.processRevokeMsgs)([e.id.toString()],[t.toString()]).catch((e=>{throw __LOG__(4,!0,new Error,!0)(b()),SEND_LOGS("removeMessagesFromHistory failed"),e})).then((()=>{r(23539).default.removeAllLabelsMD(e),_.typeIsMms(e)&&d.deregisterMsg(e),e.chat&&e.chat.removeFromCollection(e),e.trigger("revoked");var a=e.getCollection(),n=e.id;e.msgChunk&&e.msgChunk.replaceId(n,t),a.replaceId(n,t);var i={id:t,type:o.default.MSG_TYPE.REVOKED,body:void 0,caption:void 0,clientUrl:void 0,deprecatedMms3Url:void 0,loc:void 0,lat:void 0,lng:void 0,isLive:void 0,accuracy:void 0,speed:void 0,degrees:void 0,comment:void 0,sequence:void 0,shareDuration:void 0,finalLat:void 0,finalLng:void 0,finalAccuracy:void 0,finalThumbnail:void 0,finalSpeed:void 0,finalDegrees:void 0,finalTimeOffset:void 0,title:void 0,description:void 0,canonicalUrl:void 0,matchedText:void 0,thumbnail:void 0,richPreviewType:void 0,doNotPlayInline:void 0,quotedMsg:void 0,quotedStanzaID:void 0,quotedRemoteJid:void 0,quotedParticipant:void 0,mediaData:void 0,mentionedJidList:void 0,vcardList:void 0,star:!1};if(e.set(i),e.trigger("change:msgKey",{newKey:t,oldKey:n}),e.chat&&(e.chat.updateMediasCountOnMsg(e,!0),n.equals(e.chat.lastReceivedKey)&&(0,l.setLastReceivedKey)(e.chat.id,t).then((()=>{e.chat.lastReceivedKey=t})),e.chat.composeQuotedMsg===e&&(e.chat.composeQuotedMsg=null)),e.isLive&&r(84383).default.removeMsg(e),y.default.isBroadcast(n.remote)){var u=_.getBroadcastFanoutKeys(n),c=_.getBroadcastFanoutKeys(t);if(!u||!c||u.length!==c.length)return void __LOG__(2)(T(),String(u),String(c));(0,s.default)(u,c).forEach((e=>{var t=a.get(e[0]);t&&C(t,e[1])}))}}))}((0,E.unproxy)(e),t)}},45591:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.sendMsgRecord=function(e){return(0,i.callSyncPromise)((()=>{var t,a=e.id,n=r(43334).default;n.find(a.remote).then((e=>{e.isTrusted()||(0,E.sendNotSpam)(e).catch((()=>{}))})),S.default.isBroadcast(e.to)&&(t=(0,m.broadcastFanout)(e)),e.isNewMsg=!0;var i,w=e.type===u.default.MSG_TYPE.PROTOCOL&&"revoke"===e.subtype;if(!e.isGroupMsg&&!w&&o.default.get(e.to))return Promise.reject(new l.default("Contact is blocked",d.default.assertGet(e.to)));w||(i=new h.default.WebcMessageSend({messageType:e.getWamMessageType(),messageMediaType:e.getWamMediaType(),messageIsForward:Boolean(e.isForwarded)}));var M=r(58885).default;return n.find(e.id.remote).then((t=>((0,y.sendSeen)(t),M.trigger(u.default.NEW_MSG_SENT),(0,s.promiseProps)({reply:(0,g.sendMsgRecord)(e),chat:t})))).then((({reply:r,chat:s})=>{var o=a.remote,l=(0,f.getMaybeMeUser)(),d=a.fromMe&&S.default.equals(a.remote,l)?3:r.data?r.data.ack:1;return e.updateAck(d,r.t),i&&(i.markMessageSendT(),i.commit()),e.type!==u.default.MSG_TYPE.PROTOCOL&&(0,p.setLastReceivedKey)(s.id,a).then((()=>{s.lastReceivedKey=a})),M.updateLastReceipt(o,r.t),S.default.isBroadcast(o)&&(t?t.forEach((e=>{var t=new _.default({from:l,to:e,id:a.id}),r=M.get(t);r&&(r.ack=u.default.ACK.SENT,M.updateLastReceipt(e,r.t),null==r.ephemeralStartTimestamp&&r.updateEphemeralStartTimestamp(r.t),n.find(e).then((e=>{(0,p.setLastReceivedKey)(e.id,t).then((()=>{e.lastReceivedKey=t}))})))})):__LOG__(2)(O())),v.SendMsgResult.OK})).catchType(c.ServerStatusCodeError,(t=>{if(408!==t.status){var r=e.toJSON();__LOG__(2)(P(),JSON.stringify(r.body)),r.body=void 0,__LOG__(2,!0)(C(),JSON.stringify(r)),__LOG__(4,void 0,new Error,!0)(A(),t.status),SEND_LOGS("send-not-200")}return v.SendMsgResult.ERROR_NETWORK})).catch((t=>(__LOG__(3)(b(),e.id.toString()),__LOG__(4,void 0,new Error,!0)(T(),String(t)),SEND_LOGS("send-msg-error"),v.SendMsgResult.ERROR_UNKNOWN)))})).finally((()=>{e.promises.sendPromise&&e.promises.sendPromise.control.settled()}))};var n=a(r(19976)),i=r(73559),s=r(5497),o=a(r(79148)),u=a(r(50935)),l=a(r(64357)),d=a(r(7470)),c=r(19741),f=r(95595),p=r(57525),h=a(r(40210)),_=a(r(77865)),m=r(57556),g=r(8541),v=r(59420),E=r(89590),y=r(58269),S=a(r(68384));function T(){var e=(0,n.default)(["Got error ",""]);return T=function(){return e},e}function b(){var e=(0,n.default)(["model:msg:createRecord dropped msg: ",""]);return b=function(){return e},e}function A(){var e=(0,n.default)(["Phone responded ",""]);return A=function(){return e},e}function C(){var e=(0,n.default)(["Json: ",""]);return C=function(){return e},e}function P(){var e=(0,n.default)(["json.body: ",""]);return P=function(){return e},e}function O(){var e=(0,n.default)(["model:msg:createRecord bclist server ack, no recipients"]);return O=function(){return e},e}},59420:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SendMsgResult=void 0;var a=r(28103).Mirrored(["OK","ERROR_NETWORK","ERROR_EXPIRED","ERROR_CANCELLED","ERROR_UPLOAD","ERROR_UNKNOWN"]);t.SendMsgResult=a},93649:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.queryProduct=function(e,t,r=100,a=100){return(0,u.queryProduct)(e,t,r,a)},t.queryCatalog=function(e,t,r=5,a=100,n=100){return(0,u.queryCatalog)(e,t,r,a,n)},t.queryProductList=function(e,t,r=100,a=100){return(0,u.queryProductList)(e,t,r,a)},t.appealProduct=function(e,t){return(0,u.appealProduct)(e,t)},t.reportProduct=function(e,t,r){return(0,u.reportProduct)(e,t,r)},t.createBusinessCatalog=function(){return(0,u.createCatalog)()},t.addProduct=function(e,t=100,r=100){return(0,u.addProduct)(e,t,r)},t.editProduct=function(e,t=100,r=100){return(0,u.editProduct)(e,t,r)},t.deleteProducts=function(e){return(0,u.deleteProducts)(e)},t.sendProductToChat=function(e,t,r){var{catalogWid:a}=e;if(!t)return;var u=t.productCollection.get(e.id),d=u?(0,l.unproxy)(u):(0,l.unproxy)(e);if(!d)return;var c=d.productImageCollection.head(),f=c&&c.mediaData;if(!f)return;n.default.find(a).then((function(e){i.default.openChatFromUnread(e).then((t=>{if(t){var n=(0,l.unproxy)((0,o.createProductInquiry)(d,a,f,r));e.composeQuotedMsg=n,i.default.focusChatTextInput(e),window.innerWidth<=s.default.LAYOUT_2COLUMNS_MAX_WIDTH&&i.default.closeDrawerRight()}}))}))},Object.defineProperty(t,"createProductCatalog",{enumerable:!0,get:function(){return d.default}});var n=a(r(43334)),i=a(r(79711)),s=a(r(50935)),o=r(27e3),u=r(8125),l=r(64658),d=a(r(95295))},75613:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.setProfilePic=function(e,t,r){return g((0,h.unproxy)(e),t,r)},t.deleteProfilePic=function(e){return v((0,h.unproxy)(e))};var i=n(r(19976)),s=a(r(2784)),o=r(12073),u=n(r(79711)),l=r(19741),d=a(r(96452)),c=r(95595),f=n(r(17957)),p=r(85619),h=r(64658);function _(){var e=(0,i.default)(["models:ProfilePicThumb:deletePicture dropped"]);return _=function(){return e},e}function m(){var e=(0,i.default)(["models:ProfilePicThumb:setPicture dropped"]);return m=function(){return e},e}function g(e,t,r,a=(0,o.genId)()){var{id:n}=e;if(!e.canSet())return Promise.reject(new d.ActionError);var i=(0,p.sendSetPicture)(n,t,r);e.pendingPic=t;var h=(0,c.getMaybeMeUser)(),_=n.equals(h)?new o.ActionType(f.default.t(186)):new o.ActionType(f.default.t(117)),v=i.catch((()=>{throw __LOG__(3)(m()),n.equals(h)?new o.ActionType(f.default.t(185)):new o.ActionType(f.default.t(116))})).catchType(l.ServerStatusCodeError,(i=>{if(i.status>=400){var s=n.equals(h)?f.default.t(185):f.default.t(116);return new o.ActionType(s,{actionText:f.default.t(199),actionHandler:()=>g(e,t,r,a)})}})).then((()=>n.equals(h)?new o.ActionType(f.default.t(184)):new o.ActionType(f.default.t(115))));return u.default.openToast(s.createElement(o.ActionToast,{id:a,initialAction:_,pendingAction:v})),i.then((t=>{t._duplicate||e.set({tag:t.tag,eurl:t.eurl,token:t.token})})).finally((()=>{e.pendingPic=void 0}))}function v(e,t=(0,o.genId)()){var{id:r}=e;if(!e.canDelete())return Promise.reject(new d.ActionError);var a=(0,p.requestDeletePicture)(r);e.pendingPic=e.fallbackType;var n=(0,c.getMaybeMeUser)(),i=r.equals(n)?new o.ActionType(f.default.t(183)):new o.ActionType(f.default.t(114)),h=a.catch((()=>{throw __LOG__(3)(_()),r.equals(n)?new o.ActionType(f.default.t(181)):new o.ActionType(f.default.t(112))})).catchType(l.ServerStatusCodeError,(a=>{if(a.status>=400){var i=r.equals(n)?f.default.t(181):f.default.t(112);return new o.ActionType(i,{actionText:f.default.t(199),actionHandler:()=>v(e,t)})}})).then((()=>r.equals(n)?new o.ActionType(f.default.t(182)):new o.ActionType(f.default.t(113))));return u.default.openToast(s.createElement(o.ActionToast,{id:t,initialAction:i,pendingAction:h})),a.then((t=>{t._duplicate||e.set({tag:void 0,eurl:void 0})})).finally((()=>{e.pendingPic=void 0}))}},6446:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.queryServerProps=function(){return n||(n=(0,s.queryServerProps)().then((e=>{o.default.updateProps(e)})).catchType(i.ServerStatusCodeError,(()=>{})).catchType(i.WebdDrop,(()=>{})).finally((()=>{n=null})))};var n,i=r(19741),s=r(8766),o=a(r(72424))},92816:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.setArchiveClassicSetting=function(e){return y(e)},t.setArchiveEnabledSetting=function(e){return function(e){return __LOG__(2)(E(),e),Promise.resolve().then((()=>{p.default.archive.enabled!==e&&(p.default.archive=(0,i.default)((0,i.default)({},p.default.archive),{},{enabled:e}))}))}(e)};var i=n(r(70417)),s=n(r(19976)),o=a(r(2784)),u=r(12073),l=n(r(79711)),d=r(19741),c=n(r(17957)),f=n(r(40210)),p=n(r(2734)),h=n(r(37513));function _(){var e=(0,s.default)(["models:settings:setArchiveClassicSetting dropped"]);return _=function(){return e},e}function m(){var e=(0,s.default)(["models:settings:setArchiveClassicSetting failed with server error"]);return m=function(){return e},e}function g(){var e=(0,s.default)(["Settings:setArchiveClassicSetting:success value sucessfully set to ",""]);return g=function(){return e},e}function v(){var e=(0,s.default)(["Settings:setArchiveClassicSetting value to ",""]);return v=function(){return e},e}function E(){var e=(0,s.default)(["Settings:setArchiveEnabledSetting value to ",""]);return E=function(){return e},e}function y(e,t=(0,u.genId)()){__LOG__(2)(v(),e);var r=(0,h.default)(e),a=new u.ActionType(c.default.t(43)),n=Boolean(p.default.archive.classic),s=r.then((()=>{__LOG__(2)(g(),e);var r=e?c.default.t(41):c.default.t(44);return new u.ActionType(r,{actionText:c.default.t(203),actionHandler:()=>y(n,t)})})).catchType(d.ServerStatusCodeError,(e=>{if(__LOG__(3)(m()),e.status>=400)return new u.ActionType(c.default.t(42))})).catch((()=>{throw __LOG__(3)(_()),new u.ActionType(c.default.t(42),{actionText:c.default.t(199),actionHandler:()=>y(e,t)})}));return l.default.openToast(o.createElement(u.ActionToast,{id:t,initialAction:a,pendingAction:s})),r.then((()=>{p.default.archive.classic!==e&&(new f.default.ArchiveSettings({keepChatsArchived:e}).commit(),p.default.archive=(0,i.default)((0,i.default)({},p.default.archive),{},{classic:e}))}))}},96911:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.getStatus=function(e){return(0,f.getStatus)(e).then((t=>{var a={id:e};if((0,p.isNumber)(t.status))switch(t.status){case 429:case 401:case 403:case 404:case 304:a.stale=!0;var n=r(76019).default.get(e);n&&!(0,p.isString)(n.status)&&(a.status="");break;default:a.status=""}else{var i=t.status;if(t.stale){var s=r(76019).default.get(e);s&&(i=s.status)}a.status=i}return a}))},t.setMyStatus=function e(t,a=(0,o.genId)()){var n=t.trim();if(!n)return Promise.reject(new l.ActionError);var i=(0,f.setMyStatus)(n),p=new o.ActionType(c.default.t(198)),_=(0,d.getMaybeMeUser)(),m=r(76019).default,g=m.assertGet(_).status,v=i.then((t=>200===t.status?new o.ActionType(c.default.t(196),{actionText:c.default.t(203),actionHandler:()=>e(g,a)}):t.status>=400?new o.ActionType(c.default.t(197)):void 0)).catch((()=>{throw __LOG__(3)(h()),new o.ActionType(c.default.t(197),{actionText:c.default.t(199),actionHandler:()=>e(t,a)})}));return u.default.openToast(s.createElement(o.ActionToast,{id:a,initialAction:p,pendingAction:v})),i.then((e=>{200!==e.status||e._duplicate||(m.assertGet(_).status=t)}))};var i=n(r(19976)),s=a(r(2784)),o=r(12073),u=n(r(79711)),l=a(r(96452)),d=r(95595),c=n(r(17957)),f=r(6829),p=r(11419);function h(){var e=(0,i.default)(["models:statusCollection:setMyStatus dropped"]);return h=function(){return e},e}},95207:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.applyContactBusinessProps=t.updateContactBusinessProperties=void 0;var n=a(r(52954)),i=a(r(50935)),s=a(r(7470)),o=a(r(18120)),u=r(84066),l=r(75637),d=(e,t)=>{var r={};for(var a of e){var{id:n}=a;r[n.user]=a}for(var i of t){var{id:s}=i,o=r[s.user],u=Boolean(o),{level:l,name:d,isApi:c,actualActors:p,hostStorage:h,privacyModeTs:_}=o||{},m={isBusiness:u,isEnterprise:Boolean(c),verifiedLevel:f(l),verifiedName:d,actualActors:p,hostStorage:h,privacyModeTs:_};i.set(m)}};t.updateContactBusinessProperties=d;var c=function(){var e=(0,n.default)((function*(){if(o.default.supportsFeature(o.default.F.MD_BACKEND)){var e=(yield(0,u.getAllVerifiedNames)()).map((({id:e,name:t,level:r,isApi:a,actualActors:n,hostStorage:i,privacyModeTs:s})=>({id:(0,l.createUserWid)(e),name:t,level:r,isApi:a,actualActors:n,hostStorage:i,privacyModeTs:s})));d(e,s.default.toArray())}}));return function(){return e.apply(this,arguments)}}();function f(e){if(null!=e){switch(e){case"unknown":return i.default.VERIFIED_LEVEL.UNKNOWN;case"low":return i.default.VERIFIED_LEVEL.LOW;case"high":return i.default.VERIFIED_LEVEL.HIGH}return i.default.VERIFIED_LEVEL.UNKNOWN}}t.applyContactBusinessProps=c},40690:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.updateVerifiedInfo=c,t.updateContactPropertiesOnNewChat=function(e){var t=!i.default.get(e);if(o.default.supportsFeature(o.default.F.MD_BACKEND)&&t)return(0,u.default)(e).then((t=>{if(t){var{bizInfo:r}=t;if(r)return c(s.default.gadd(e),r.verifiedName)}}));return Promise.resolve()},t.updateBizPrivacyMode=function(){return f.apply(this,arguments)};var n=a(r(52954)),i=a(r(43334)),s=a(r(7470)),o=a(r(18120)),u=a(r(55042)),l=r(95207),d=r(84066);function c(e,t){var r=e.id,{name:a,level:n,isApi:i,serial:s,actualActors:o,hostStorage:u,privacyModeTs:c}=t;return(0,l.updateContactBusinessProperties)([{id:r,name:a,level:n,isApi:i,actualActors:o,hostStorage:u,privacyModeTs:c}],[e]),(0,d.createOrUpdateVerifiedBusinessName)(void 0,r,n,s,a,i,o,u,c)}function f(){return(f=(0,n.default)((function*(e,t){if(null!=t){var r=s.default.get(e);r&&(null!=r.privacyModeTs&&r.privacyModeTs>=t.privacyModeTs||(r.set({isBusiness:!0,isEnterprise:!0,actualActors:t.actualActors,hostStorage:t.hostStorage,privacyModeTs:t.privacyModeTs}),yield(0,d.createOrUpdateVerifiedBusinessName)(null,e,null,null,null,!0,t.actualActors,t.hostStorage,t.privacyModeTs)))}}))).apply(this,arguments)}},30254:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.handleVerifiedNameSync=void 0;var n=a(r(52954)),i=a(r(18120)),s=r(95207),o=r(84066),u=function(){var e=(0,n.default)((function*(e){i.default.supportsFeature(i.default.F.MD_BACKEND)&&0!==e.length&&(yield Promise.all(e.map((({id:e,verifiedName:{level:t,serial:r,name:a,isApi:n,actualActors:i,hostStorage:s,privacyModeTs:u}})=>(0,o.createOrUpdateVerifiedBusinessName)(void 0,e,t,r,a,n,i,s,u)))),yield(0,s.applyContactBusinessProps)())}));return function(){return e.apply(this,arguments)}}();t.handleVerifiedNameSync=u},68776:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.handleIncomingCallOffer=function(e,t){n.default.processIncomingCall(e.call_id,e.peer_jid,{isVideo:e.isVideoCall,canHandleLocally:e.isVideoCall?s.default.isVideoCallEnabled():s.default.isVoiceCallEnabled(),offerTime:e.t}),i.default.handleIncomingSignalingMessage(e,t)},t.handleIncomingSignalingMsg=function(e,t){i.default.handleIncomingSignalingMessage(e,t)},t.handleIncomingEncRekey=function(e,t){i.default.handleIncomingSignalingMessage(e,t)};var n=a(r(79504)),i=a(r(64786)),s=a(r(43711))},72502:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sendCallOffer=function(e){return(0,a.sendCallOfferBridge)(e)},t.sendCallSignalingMsg=function(e,t){return(0,a.sendCallSignalingMsgBridge)(e,t)},t.sendCallEnd=function(e,t){return(0,a.sendCallEndBridge)(e,t)},t.sendEncRekey=function(e){return(0,a.sendEncRekeyBridge)(e)},t.queryCall=function(e,t){return(0,a.sendQueryCallBridge)(e,t)},t.prepareRetryReceipt=function(e){return(0,a.prepareRetryReceiptBridge)(e)};var a=r(65978)},54346:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.ackMatchesTemplate=function(e,t){var{type:r,from:a,participant:n,ts:i}=t;if(e.id!==t.id)return!1;if(null!=t.class&&e.class!==t.class)return!1;if(null!=r&&e.type!==r)return!1;if(null!=a&&!a.equals(e.from))return!1;if(null!=n&&!n.equals(e.participant))return!1;if(null!=i&&e.ts!==i)return!1;return!0},t.default=void 0;var n=new(a(r(23767)).default)("ack",(e=>(e.assertTag("ack"),{id:e.attrString("id"),ts:e.hasAttr("t")?e.attrString("t"):null,class:e.attrString("class"),type:e.hasAttr("type")?e.attrString("type"):null,from:e.attrWid("from"),participant:e.hasAttr("participant")?e.attrDeviceWid("participant"):null})));t.default=n},38165:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return Promise.resolve(function(e,t){var{attrs:r}=e;switch(e.tag){case"iq":return function(e){var{attrs:t,content:r}=e;if("urn:xmpp:ping"===t.xmlns)return(0,R.wap)("iq",{type:"result",to:t.from});if("md"!==t.xmlns)throw new Error("handleIq unrecognized ".concat(e.toString()));if(!Array.isArray(r)||!r.length)return;switch(r[0].tag){case"pair-device":return(0,E.default)(e);case"pair-success":return(0,y.default)(e)}}(e);case"receipt":return"retry"===r.type?(0,C.handleMessageRetryRequest)(e):"enc_rekey_retry"===r.type?(0,u.handleEncRekeyRetryRequest)(e):(0,v.default)(e);case"notification":switch(r.type){case"server_sync":return(0,O.default)(e);case"w:gp2":return(0,h.default)(e);case"picture":return(0,A.default)(e);case"business":return(0,o.handleBusinessNotification)(e);case"contacts":return(0,d.default)(e);case"devices":return(0,c.default)(e);case"mediaretry":return(0,m.default)(e);case"encrypt":var a=e.content;if(!Array.isArray(a)||!a.length)break;switch(a[0].tag){case"count":return(0,T.default)(e,t);case"identity":return(0,I.handleE2eIdentityChange)(e);case"digest":return(0,f.default)(e)}break;case"server":return(0,P.default)(e);case"status":return(0,i.default)(e);case"account_sync":return(0,s.default)(e);case"pay":return(0,S.default)(e)}if(__LOG__(3)(N(),e.toString()),r.hasOwnProperty("id"))return(0,R.wap)("ack",{id:r.id,class:"notification",from:r.to||R.DROP_ATTR,to:r.from||R.DROP_ATTR,type:r.type||R.DROP_ATTR,participant:r.participant||R.DROP_ATTR});break;case"chatstate":return(0,l.default)(e);case"presence":return(0,b.default)(e);case"message":return(0,g.default)(e);case"ib":return(0,_.default)(e);case"stream:error":return(0,w.default)(e);case"failure":return(0,p.default)(e);case"success":return(0,M.default)(e);case"call":return(0,u.handleCall)(e)}__LOG__(3)(D(),e.toString())}(e,t)).then((e=>null==e?"NO_ACK":e))};var n=a(r(19976)),i=a(r(1472)),s=a(r(71432)),o=r(26135),u=r(11974),l=a(r(10078)),d=a(r(47437)),c=a(r(56839)),f=a(r(70505)),p=a(r(28565)),h=a(r(8132)),_=a(r(77493)),m=a(r(33521)),g=a(r(65745)),v=a(r(96521)),E=a(r(87295)),y=a(r(24761)),S=a(r(26905)),T=a(r(84935)),b=a(r(55199)),A=a(r(50780)),C=r(4524),P=a(r(69632)),O=a(r(24914)),w=a(r(74960)),M=a(r(48830)),I=r(12126),R=r(30691);function D(){var e=(0,n.default)(["Comms.handleStanza unrecognized stanza ",""]);return D=function(){return e},e}function N(){var e=(0,n.default)(["Comms.handleStanza unrecognized notification stanza ",""]);return N=function(){return e},e}},54086:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.startComms=function(e,t,r){if(V)return;V=new W(e,t,r),setTimeout(H,0)},t.stopComms=function(e){e&&p.default.onStartingLogout();var t=Q("stopComms");t.socketLoop.endWithValue(),t.socket&&t.socket.close();V=null},t.openSocketLoop=H,t.openSocket=q,t.closeSocket=function(){var e=Q("closeSocket").socket;e&&(__LOG__(2)(C()),e.close())},t.onStreamErrorReceived=function(){Q("onStreamErrorReceived").socketLoop.cancelReset()},t.waitForConnection=function(){Q("waitForConnection").sendPing(),K||(K=new u.Resolvable);return K.promise},t.sendStanzaAndWaitForAck=function(e,t){return z(e,t).then((()=>{}))},t.sendStanzaAndReturnAck=z,t.castStanza=function(e){var t=Q("castStanza");t.socket?t.castStanza(e):__LOG__(2)(b())},t.sendIq=function(e,t,r){return J(e,t,!1,r)},t.sendIqWithoutRetry=function(e,t){return J(e,t,!0)},t.sendPing=function(e,t){var r=Q("sendPing"),a=e.attrs.id;if(!a||"string"!=typeof a)return Promise.reject(new Error("Comms:sendPing given iq without id: ".concat(String(e))));if(!r.socketId)return __LOG__(2)(S()),Promise.resolve();if(r.activePing&&r.activePing.socketId===r.socketId)return __LOG__(2)(y()),Promise.resolve();r.activePing&&r.activePing.handler.resolve();var n=new u.Resolvable;return r.activePing={socketId:r.socketId,stanzaId:a,handler:n},r.callStanza(e),n.promise.then((e=>e&&(0,E.parseIqResponse)(t,e)))},t.startHandlingRequests=function(){return Q("startHandlingRequests").startHandlingRequests()},t.singletonOrThrowIfUninitialized=Q;var i=n(r(19976)),s=r(30691),o=r(56656),u=r(52137),l=r(39329),d=r(30575),c=r(35228),f=a(r(54346)),p=n(r(79711)),h=n(r(50935)),_=r(96452),m=r(39174),g=n(r(87203)),v=n(r(89891)),E=r(54955);r(11824);function y(){var e=(0,i.default)(["sendPing ping still pending"]);return y=function(){return e},e}function S(){var e=(0,i.default)(["sendPing when socket dead"]);return S=function(){return e},e}function T(){var e=(0,i.default)(["Comms has no open socket, will resend iq when socket opens"]);return T=function(){return e},e}function b(){var e=(0,i.default)(["Comms has no open socket"]);return b=function(){return e},e}function A(){var e=(0,i.default)(["Comms has no open socket, will send stanza when socket opens"]);return A=function(){return e},e}function C(){var e=(0,i.default)(["closeSocket called"]);return C=function(){return e},e}function P(){var e=(0,i.default)(["openSocket failed ",""]);return P=function(){return e},e}function O(){var e=(0,i.default)(["openSocket socket closed while in noise handshake"]);return O=function(){return e},e}function w(){var e=(0,i.default)(["Comms: Socket "," closed"]);return w=function(){return e},e}function M(){var e=(0,i.default)(["Comms: Socket "," opened"]);return M=function(){return e},e}function I(){var e=(0,i.default)(["Comms: Socket "," opening, passive mode: ",""]);return I=function(){return e},e}function R(){var e=(0,i.default)(["handleAck: unrecognized ",""]);return R=function(){return e},e}function D(){var e=(0,i.default)(["Comms.startHandlingRequests"]);return D=function(){return e},e}function N(){var e=(0,i.default)(["castStanza error ",""]);return N=function(){return e},e}function L(){var e=(0,i.default)(["--- Sending ---\n",""],["--- Sending ---\\n",""]);return L=function(){return e},e}function k(){var e=(0,i.default)(["Comms: Socket "," expired"]);return k=function(){return e},e}function U(){var e=(0,i.default)(["Comms: testing socket"]);return U=function(){return e},e}function F(){var e=(0,i.default)(["handleIq no handler for iq with id ",""]);return F=function(){return e},e}function G(){var e=(0,i.default)(["Comms: job response is NO_ACK"]);return G=function(){return e},e}function x(){var e=(0,i.default)(["Comms: job response is CLOSE_SOCKET"]);return x=function(){return e},e}function B(){var e=(0,i.default)(["--- Receive ---\n",""],["--- Receive ---\\n",""]);return B=function(){return e},e}function Y(){var e=(0,i.default)(["Failure parsing stanza!"]);return Y=function(){return e},e}var K=null,j=1;class W{constructor(e,t,r){this.nextSocketId=1,this.pendingIqs=new Map,this.ackHandlers=[],this._recvBlocker=new u.Resolvable,this.activePing=null,this._pending=new Set,this.socketId=0,this.socket=null,this.softCloseSocket=null,this.socketLoop=new o.PromiseRetryLoop({name:"MainSocketLoop",code:q,timer:{jitter:.1,max:6e4,algo:{type:"fibonacci",first:1e4,second:1e4},relativeDelay:!0},resetDelay:3e4}),this.parseAndHandleStanza=(e,t)=>{e===this.socketId&&(this.deadSocketTimer.cancel(),K&&(K.resolve(),K=null));var r=(0,s.decodeStanza)(t,Z).then((t=>{if(t){__LOG__(2,!0)(B(),t.toString());var r=this.activePing;return r&&r.socketId===e&&r.stanzaId===X(t)?(this.activePing=null,r.handler.resolve(t),this.maybeScheduleHealthCheck(),"NO_ACK"):this.handleStanza(t,e)}__LOG__(3)(Y())})).then((t=>{if(e===this.socketId)if("CLOSE_SOCKET"===t){__LOG__(2)(x());var r=this.socket;r&&r.close()}else"NO_ACK"===t?__LOG__(2)(G()):t&&this.castStanza(t)}));this._pending.add(r),r.finally((()=>{this._pending.delete(r)}))},this.handleStanza=(e,t)=>{var r=X(e);if(null!=r){var a=this.pendingIqs.get(r);a?(this.pendingIqs.delete(r),a.resolve(e),this.maybeScheduleHealthCheck()):__LOG__(4,void 0,new Error)(F(),r)}else{if("ack"!==e.tag)return"failure"===e.tag?this._handleStanza(e,t):this._recvBlocker.promise.then((()=>this._handleStanza(e,t)));this.handleAck(e)}return"NO_ACK"},this.healthCheckTimer=new l.ShiftTimer((()=>{__LOG__(2)(U()),this.socketId&&this.sendPing()})),this.deadSocketTimer=new l.ShiftTimer((e=>{__LOG__(2)(k(),e),e===this.socketId&&this.softCloseSocket&&this.softCloseSocket()})),this._handleStanza=e,this.sendPing=t,this.socketStartOptions=r}filterPending(e){var t=[];function r(r){e(r)&&t.push(r)}return this.pendingIqs.forEach(r),this.ackHandlers.forEach(r),t}callStanza(e){this.castStanza(e),this.deadSocketTimer.onOrBefore(2e4,this.socketId),this.healthCheckTimer.cancel()}castStanza(e){var t=this.socketOrThrow("castStanza");try{__LOG__(2,!0)(L(),e.toString()),t.sendFrame((0,s.encodeStanza)(e))}catch(e){__LOG__(3)(N(),e)}}socketOrThrow(e){var t=this.socket;if(t)return t;throw new Error("Comms.".concat(e," called while no socket"))}startHandlingRequests(){return __LOG__(2)(D()),this._recvBlocker.resolve(),this._recvBlocker.promise.then((()=>{}))}handleAck(e){for(var t=this.ackHandlers,r=-1,a=null;!a&&++r<t.length;)a=t[r].parseAndTest(e);if(a){var n=t[r];(0,d.removeIndexWithoutPreservingOrder)(t,r),(0,v.default)(e),n.resolve(a),this.maybeScheduleHealthCheck()}else __LOG__(3)(R(),e)}removeHandler(e){if("iq"===e.type){var t=e.stanza.attrs.id;if(!t||"string"!=typeof t)return;if(!this.pendingIqs.delete(t))return}else{e.type;var r=this.ackHandlers.indexOf(e);if(-1===r)return;(0,d.removeIndexWithoutPreservingOrder)(this.ackHandlers,r)}e.resolve(Promise.reject(new _.Disconnected))}maybeScheduleHealthCheck(){if(!this.healthCheckTimer.isScheduled()&&!(this.activePing||this.ackHandlers.length||this.pendingIqs.size)){var e=1e4*Math.random()+2e4;this.healthCheckTimer.onOrBefore(e)}}}var V=null;function H(){Q("openSocketLoop").socketLoop.start()}function q(){var e,t=Q("openSocket"),r=t.nextSocketId++;return __LOG__(2)(I(),r,!!(null===(e=t.socketStartOptions)||void 0===e?void 0:e.passive)),p.default.setSocketState(h.default.SOCKET_STATE.OPENING),(0,g.default)(t.socketStartOptions).then((e=>{t.socketStartOptions=null,p.default.setSocketState(h.default.SOCKET_STATE.PAIRING);var a=new u.Resolvable;return __LOG__(2)(M(),r),t.socketId=r,t.socket=e,t.softCloseSocket=()=>{t.softCloseSocket=null,t.socket&&(t.socket.close(),t.socket=null),a.resolve()},t.socketLoop.resetTimeoutAfter(1e4),t.deadSocketTimer.cancel(),t.maybeScheduleHealthCheck(),e.setOnFrame((e=>t.parseAndHandleStanza(r,e))),e.setOnClose((()=>{__LOG__(2)(w(),r),t.activePing&&r===t.activePing.socketId&&(t.activePing.handler.resolve(),t.activePing=null),t.filterPending((e=>e.attachedToSocketId===r)).forEach((e=>{t.removeHandler(e)})),r===t.socketId&&(t.socketId=0,t.socket=null,p.default.socketStreamDisconnected(),a.resolve())})),(0,m.isRegistered)()&&(p.default.setSocketState(h.default.SOCKET_STATE.CONNECTED),p.default.openSocketStream()),t.filterPending((e=>!e.attachedToSocketId)).sort(((e,t)=>e.orderedId-t.orderedId)).forEach((e=>{t.callStanza(e.stanza)})),a.promise})).catchType(_.Disconnected,(()=>{__LOG__(2)(O())})).catch((e=>{__LOG__(3)(P(),e)}))}function z(e,t){return new Promise((r=>{var a=Q("sendStanzaAndWaitForAck");a.ackHandlers.push({type:"ack",parseAndTest:e=>{var r=f.default.parse(e);return!r.error&&(0,f.ackMatchesTemplate)(r.success,t)?e:null},resolve:r,stanza:e,attachedToSocketId:0,orderedId:j++}),a.socket?a.callStanza(e):__LOG__(2)(A())}))}function J(e,t,r,a){return new Promise((t=>{var a=Q("sendIq"),n=e.attrs.id;if(!n||"string"!=typeof n)throw new Error("Comms:sendIq given iq without id: ".concat(String(e)));var i=a.socketId;!r||i?(a.pendingIqs.set(n,{type:"iq",resolve:t,stanza:e,attachedToSocketId:r?i:0,orderedId:j++}),a.socket?a.callStanza(e):__LOG__(2)(T())):t(Promise.reject(new _.Offline))})).then((e=>(0,E.parseIqResponse)(t,e,a)))}function Q(e){if(V)return V;throw new Error("Comms::".concat(e," called before startComms"))}function X(e){if("iq"===e.tag){var t=e.attrs.type;if("result"===t||"error"===t)return(0,s.decodeAsString)(e.attrs.id)||null}return null}function Z(e){return Promise.resolve((0,c.inflate)(e))}},23767:(e,t,r)=>{"use strict";var a=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(36367));t.default=class{constructor(e,t){this._name=e,this._parser=t}parseParsableWap(e){try{return{success:this._parser(e)}}catch(e){if(e instanceof n.XmppParsingFailure)return{error:e};throw e}}parse(e){var t=new n.default(this._name,e);return this.parseParsableWap(t)}parseOrThrow(e){var t=this.parse(e);if(t.error)throw new Error(String(t.error));return t.success}}},36367:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.convertBytesToUint=f,t.default=t.XmppParsingFailure=t.AUTHOR_SYSTEM=t.AUTHOR_ME=void 0;var n=a(r(19976)),i=r(30691),s=r(46378),o=r(71684),u=r(95595),l=r(75637);function d(){var e=(0,n.default)(["maybeAttrEnum: value does not exist in enum"]);return d=function(){return e},e}t.AUTHOR_ME="@me";var c="@system";function f(e,t,r=!1){for(var a=0,n=0;n<t;n++)a=256*a+e[n];return a}t.AUTHOR_SYSTEM=c;class p{constructor(e,t){this.parser=e,this.reason=t}toString(){return"XmppParsingFailure: ".concat(this.parser,": ").concat(this.reason)}}t.XmppParsingFailure=p;class h{constructor(e,t){this._name=e,this._node=t,this._children=Array.isArray(t.content)?t.content.map((t=>new h(e,t))):null}hasAttr(e){return this._node.attrs.hasOwnProperty(e)}assertTag(e){this._node.tag!==e&&this.throw("to be <".concat(e,">"))}tag(){return this._node.tag}maybeChild(e){var t=this._children;if(!t)return null;for(var r=0;r<t.length;r++)if(t[r]._node.tag===e)return t[r];return null}hasChild(e){return!!this.maybeChild(e)}child(e){var t=this.maybeChild(e);return t||this.throw("to have child <".concat(e,">"))}getFirstChild(){var e=this._children;return e?e[0]:null}assertAttr(e,t){var r=this.attrString(e);r!==t&&this.throw('to have "'.concat(e,'"="').concat(t,'", but instead has "').concat(r,'"'))}assertAttrIsMe(e){var t=this.attrWid(e),r=(0,u.assertGetMe)();t.equals(r)||this.throw('to have "'.concat(e,'"=').concat(r.toString(),', but instead has "').concat(t.toString(),'"'))}assertAttrIsMeUser(e){var t=this.attrWid(e),r=(0,u.assertGetMeUser)();t.equals(r)||this.throw('to have "'.concat(e,'"=').concat(r.toString(),', but instead has "').concat(t.toString(),'"'))}assertFromServer(){var e=this.attrString("from");"s.whatsapp.net"!==e&&this.throw('to have "from"="s.whatsapp.net", but instead has "'.concat(e,'"'))}attrString(e){return this._node.attrs.hasOwnProperty(e)?(0,i.decodeAsString)(this._node.attrs[e]):this.throw('to have attribute "'.concat(e,'"'))}attrAuthor(e){if(!this.hasAttr(e))return c;var t=this.attrUserWid(e);return t.equals((0,u.assertGetMe)())?"@me":t}maybeAttrString(e){return this.hasAttr(e)?(0,i.decodeAsString)(this._node.attrs[e]):null}attrDeviceWid(e){var t,r=this.attrString(e);try{t=(0,l.createDeviceWid)(r)}catch(e){}return t&&t.isUser()?t:this.throw('to have "'.concat(e,'"={DeviceJid}, but instead has "').concat(r,'"'))}attrUserWid(e){var t,r=this.attrString(e);try{t=(0,l.createWid)(r)}catch(e){}return t&&t.isUser()?(0,l.toUserWid)(t):this.throw('to have "'.concat(e,'"={UserJid}, but instead has "').concat(r,'"'))}attrChatWid(e){var t,r=this.attrString(e);try{t=(0,l.createWid)(r)}catch(e){}return t?(0,l.toChatWid)(t):this.throw('to have "'.concat(e,'"={ChatJid}, but instead has "').concat(r,'"'))}attrGroupWid(e){var t,r=this.attrString(e);try{t=(0,l.createWid)(r)}catch(e){}return t&&t.isGroup()?t:this.throw('to have "'.concat(e,'"={GroupJid}, but instead has "').concat(r,'"'))}attrWid(e){var t,r=this.attrString(e);try{t=(0,l.createWid)(r)}catch(e){}return t||this.throw('to have "'.concat(e,'"={JID}, but instead has "').concat(r,'"'))}maybeAttrEnum(e,t){if(!this.hasAttr(e))return null;try{return this.attrEnum(e,t)}catch(e){return __LOG__(3)(d()),null}}attrEnum(e,t){var r=this.attrString(e);if(!t.hasOwnProperty(r)){var a=Object.keys(t).join("|");return this.throw('to have "'.concat(e,'"={').concat(a,'} but has value "').concat(r,'"'))}return t[r]}attrEnumOrDefault(e,t,r){return this.hasAttr(e)?this.attrEnum(e,t):r}attrFlowEnum(e,t){var r=t(this.attrString(e));return null==r?this.throw("to have enum value"):r}attrFlowEnumOrDefault(e,t,r){try{return this.attrFlowEnum(e,t)}catch(e){return r}}attrInt(e,t,r){var a=this.attrString(e),n=parseInt(a,10);return Number.isNaN(n)?this.throw('to have "'.concat(e,'"={integer} but has value "').concat(a,'"')):void 0!==t&&n<t?this.throw('to have "'.concat(e,'"={at least ').concat(t,"} but has value ").concat(n)):void 0!==r&&n>=r?this.throw('to have "'.concat(e,'"={below ').concat(r,"} but has value ").concat(n)):n}maybeAttrInt(e,t,r){return this.hasAttr(e)?this.attrInt(e,t,r):null}attrTime(e){return(0,o.castToUnixTime)(this.attrInt(e))}attrFutureTime(e){var t=this.attrInt(e);return(0,o.futureUnixTime)(t)}forEachChild(e){var t=this._children;if(t)t.forEach(e);else if(this._node.content)return this.throw("to have children")}forEachChildWithTag(e,t){this.forEachChild((r=>{r._node.tag===e&&t(r)}))}mapChildren(e){var t=this._children;return!t&&this._node.content?this.throw("to have children"):t?t.map(e):[]}mapChildrenWithTag(e,t){var r=this._children;return!r&&this._node.content?this.throw("to have children"):r?r.filter((t=>t._node.tag===e)).map(t):[]}hasContent(){return!this._children&&!!this._node.content}contentUint(e){return f(this.contentBytes(e),e)}contentBytes(e=-1){if(this._children)return this.throw("to have binary content, but has children instead");if(this._node.content){var t=this._node.content;return-1!==e&&t.length!==e?this.throw("to be ".concat(e," bytes, but got ").concat(t.length," instead")):t}return this.throw("to have content")}contentString(){if(this._children)return this.throw("to have string content, but has children instead");if(this._node.content){var e=new s.Binary(this._node.content);return e.readString(e.size())}return this.throw("to have content")}contentEnum(e){var t=this.contentString();if(!e.hasOwnProperty(t)){var r=Object.keys(e).join("|");return this.throw("to have content {".concat(r,'} but has value "').concat(t,'"'))}return e[t]}throw(e){throw new p(this._name,"expected <".concat(this._node.tag,"> ").concat(e))}}t.default=h},89891:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var{id:t,from:r,t:a}=e.attrs;"message"===e.attrs.class&&function(e,t,r){var a=new s.default({fromMe:!0,remote:t,id:e});(0,i.getTable)().merge(String(a),{messageRangeIndex:(0,o.craftMessageRangeIndex)(t.toString(),!1,!1,r)}).catch((e=>{throw __LOG__(4,!0,new Error,!0)(l()),SEND_LOGS("message processAckForOutgoingMessage failed"),e}))}(String(t),(0,u.createWid)(String(r)),parseInt(a,10))};var n=a(r(19976)),i=r(52303),s=a(r(77865)),o=r(95197),u=r(75637);function l(){var e=(0,n.default)(["processAckForOutgoingMessage: failed to update in storage"]);return l=function(){return e},e}},35914:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.sendPing=function(){var e=(0,n.wap)("iq",{to:n.S_WHATSAPP_NET,xmlns:"w:p",type:"get",id:(0,n.generateId)()},(0,n.wap)("ping",null));(0,s.sendPing)(e,o).then((e=>{e&&e.success&&u(e.result)}))},t.blockSendPing=function(){var e=(0,n.wap)("iq",{to:n.S_WHATSAPP_NET,xmlns:"w:p",type:"get",id:(0,n.generateId)()},(0,n.wap)("ping",null));return(0,s.sendPing)(e,o).then((e=>{e&&e.success&&u(e.result)}))};var n=r(30691),i=r(71684),s=r(54086),o=new(a(r(23767)).default)("ping",(e=>e.attrTime("t")));function u(e){var t=Math.round(Date.now()/1e3-e);(0,i.setClockSkew)(t)}},54955:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseIqResponse=function(e,t,r){var i=t.content;if(i&&Array.isArray(i)&&i[0]){var s=i[0];if("error"===s.tag){var o=s.attrs||{};return{success:!1,errorCode:parseInt(o.code,10),errorText:(0,a.decodeAsString)(o.text)||"",errorType:(0,a.decodeAsString)(o.type)||"",errorBackoff:parseInt(o.backoff,10),customError:r?r.parseOrThrow(s):void 0,toString:n}}}return{success:!0,result:e.parseOrThrow(t)}},t.errorToString=n;var a=r(30691);function n(){return"IqError ".concat(this.errorCode,": ").concat(this.errorText)}},95778:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.DEVICE_JID=function(e){if(!(e instanceof o.default&&e.isUser()))throw Error("DEVICE_JID: invalid jid type: ".concat(e instanceof o.default?e.toString():"Not an instance of WID"));return n.WapJid.createAD(e.user,e.agent,e.device)},t.USER_JID=function(e){if(!(e instanceof o.default&&e.isUser()))throw Error("USER_JID: invalid jid type: ".concat(e instanceof o.default?e.toString():"Not an instance of WID"));return n.WapJid.create(e.user,i.USER_JID_SUFFIX)},t.CHAT_JID=function(e){if(!(e instanceof o.default&&(e.isUser()||e.isGroup()||e.isBroadcast())))throw Error("CHAT_JID: invalid jid type: ".concat(e instanceof o.default?e.toString():"Not an instance of WID"));return n.WapJid.create(e.user,"c.us"===e.server?i.USER_JID_SUFFIX:e.server)},t.GROUP_JID=function(e){if(!(e instanceof o.default&&e.isGroup()))throw Error("GROUP_JID: invalid jid type: ".concat(e instanceof o.default?e.toString():"Not an instance of WID"));return n.WapJid.create(e.user,e.server)},t.GROUP_CALL_JID=function(e){if(!(e instanceof o.default&&e.isGroupCall()))throw Error("GROUP_CALL_JID: invalid jid type: ".concat(e instanceof o.default?e.toString():"Not an instance of WID"));return n.WapJid.create(e.user,e.server)},t.JID=function(e){if(!(e instanceof o.default))throw Error("JID: invalid jid type: ".concat(e instanceof o.default?e.toString():"Not an instance of WID"));return null!=e.device&&0!==e.device||null!=e.agent&&0!==e.agent?n.WapJid.createAD(e.user,e.agent,e.device):n.WapJid.create(e.user,e.server)},t.wapNodeToVoipXml=t.voipXmlToWapNode=void 0;var n=r(45321),i=r(79568),s=r(30691),o=a(r(68384));t.voipXmlToWapNode=e=>{if(!e||!Array.isArray(e)||3!==e.length)throw Error("Invalid VOIP xml node");return function e(t){if(!t)return null;if(Array.isArray(t)){var r=t[0],a=t[1],i=void 0;a&&Object.keys(a).map((e=>{i||(i={});var t=a[e];if(!t)throw Error("Attribute value is null");if("object"==typeof t){if(t.type!==n.WAP_JID_SUBTYPE.JID&&!n.WAP_JID_SUBTYPE.JID_AD)throw Error("Invalid attribute value type");t=new n.WapJid(t)}i[e]=t}));var o=t[2],u=null;Array.isArray(o)&&o.length>0&&(u="number"==typeof o[0]?new Uint8Array(o):o.map(e).filter((e=>e)));var l=u;return new s.WapNode(r,i,l)}return t}(e)};t.wapNodeToVoipXml=e=>function e(t){var r=[];return r.push(t.tag),r.push(t.attrs||{}),Array.isArray(t.content)&&0===t.content.filter((e=>!Array.isArray(e)))?r.push(t.content):Array.isArray(t.content)?r.push(t.content.map((t=>e(t)))):null!=t.content?t.content instanceof Uint8Array?r.push(Array.from(t.content)):r.push(t.content):r.push(null),r}(e)},82087:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.encryptServerErrorReceipt=function(e,t,r){return function(){return h.apply(this,arguments)}(e,t,function(e){__LOG__(2)(p());var t=new l.Binary;return(0,u.encodeProto)(c.ServerErrorReceiptSpec,e,t),t.readByteArray()}({stanzaId:t}),r)},t.decryptMediaRetryNotification=function(e,t,r,a){return function(){return _.apply(this,arguments)}(e,t,r,a).then((e=>(0,o.decodeProto)(c.MediaRetryNotificationSpec,e)))},t.ENC_IV_SIZE=void 0;var i=n(r(52954)),s=n(r(19976)),o=r(84139),u=r(68519),l=r(46378),d=a(r(55273)),c=r(4786),f=n(r(84025));function p(){var e=(0,s.default)(["encodeServerErrorReceipt"]);return p=function(){return e},e}function h(){return(h=(0,i.default)((function*(e,t,r,a){var n=(null==a?void 0:a.slice())||E(),{key:i,params:s}=yield g(e,t,n);return{ciphertext:yield f.default.encrypt(s,i,r),iv:n}}))).apply(this,arguments)}function _(){return(_=(0,i.default)((function*(e,t,r,a){var{key:n,params:i}=yield g(e,t,r);return f.default.decrypt(i,n,a)}))).apply(this,arguments)}var m="WhatsApp Media Retry Notification";function g(){return v.apply(this,arguments)}function v(){return(v=(0,i.default)((function*(e,t,r){var a=yield d.extractAndExpand(e,m,32),n=new l.Binary;n.write(t);var i=n.readByteArray();return{key:yield f.default.importKey("raw",new Uint8Array(a),"AES-GCM",!1,["encrypt","decrypt"]),params:{name:"AES-GCM",iv:r,additionalData:i}}}))).apply(this,arguments)}function E(){var e=new Uint8Array(12);return self.crypto.getRandomValues(e),e}t.ENC_IV_SIZE=12},55051:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseABProps=function(e){var t=new Map;e.forEach((({configCode:e,configValue:r,configExpoKey:a})=>{t.set(e,{configValue:r,configExpoKey:a})}));var r=new Map;return Object.keys(a.ABPropConfigs).map((e=>{var n=a.ABPropConfigs[e][0],i=t.get(n),s=null==i?void 0:i.configValue,o=null==i?void 0:i.configExpoKey;r.set(n,{configValue:s,configExpoKey:o})})),r};var a=r(85820)},87078:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.syncABProps=m,t.syncABPropsTask=function(){return g.apply(this,arguments)},t.default=void 0;var n=a(r(52954)),i=a(r(19976)),s=r(30691),o=r(13267),u=r(91460),l=r(18535),d=r(8018),c=r(15971),f=r(55051),p=r(54086);function h(){var e=(0,i.default)(["failed to sync ABProps"]);return h=function(){return e},e}function _(){var e=(0,i.default)(["update ABProps config table failed"]);return _=function(){return e},e}function m(e=!0){var t;e&&(t=(0,c.getHash)());var r=(0,s.wap)("iq",{xmlns:"abt",id:(0,s.generateId)(),type:"get",to:s.S_WHATSAPP_NET},(0,s.wap)("props",{protocol:"1",hash:e&&null!=t?(0,s.CUSTOM_STRING)(t):s.DROP_ATTR}));return(0,p.sendIq)(r,o.abPropsParser).then((e=>{if(e.success&&null!=e.result){var t=Date.now();if((0,c.updateAttributesLocalStorage)(e.result.abKey,e.result.hash,e.result.refresh,t),null!=e.result.hash)return(0,d.updateABPropConfigs)((0,f.parseABProps)(e.result.props)).catch((()=>{__LOG__(4,!0,new Error,!0)(_()),SEND_LOGS("update ABProps config table failed when syncing ABProps")}))}}))}function g(){return(g=(0,n.default)((function*(){for(var e=(0,c.isABPropsAfterFirstSync)(),t=3;t-- >0;)try{yield m(e),t=0}catch(e){0===t&&(__LOG__(4,!0,new Error,!0)(h()),SEND_LOGS("failed to sync ABProps")),yield(0,u.delayMs)(1e4*Math.random())}}))).apply(this,arguments)}var v=(0,l.cacheWhilePending)((()=>"abProps"),m);t.default=v},30868:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.getDevices=function(e){return(0,s.syncDeviceList)([(0,u.assertGetMe)()],e)},t.getAndUpdateProfilePicture=function(){var e=(0,l.default)(d.default.get((0,u.getMeUser)()),"ProfilePicThumbCollection.get(getMeUser())");return d.default.resyncPictures([e])},t.updatePrivacySettings=function(){return(0,f.getPrivacy)().then(function(){var e=(0,i.default)((function*(e){if(e.groupAdd===f.GROUP_ADD.contact_blacklist)try{var t=yield(0,f.getBlockedContacts)();"mismatch"===t.status&&(e.blackList=t.users)}catch(e){__LOG__(3,void 0,void 0,!0)(p()),SEND_LOGS("failed to get disallowed contact list for groupadd")}(0,u.setUserPrivacySettings)(e)}));return function(){return e.apply(this,arguments)}}())},t.updateBlocklist=function(){(0,c.fetchAndUpdateBlocklist)().then((e=>{e.dhash&&(o.default.toArray().forEach((e=>o.default.remove(e))),e.wids&&e.wids.forEach((e=>{o.default.gadd(e)})))}))},t.ACCOUNT_SYNC_TYPE=void 0;var n=a(r(19976)),i=a(r(52954)),s=r(47882),o=a(r(79148)),u=r(95595),l=a(r(61941)),d=a(r(15118)),c=r(49434),f=r(73095);function p(){var e=(0,n.default)(["failed to get disallowed contact list for groupadd"]);return p=function(){return e},e}var h=Object.freeze({BLOCKLIST:"blocklist",DEVICES:"devices",PICTURE:"picture",PRIVACY:"privacy",STATUS:"status"});t.ACCOUNT_SYNC_TYPE=h},47882:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.syncDeviceList=g,t.syncAndGetDeviceList=function(){return E.apply(this,arguments)};var n=a(r(19976)),i=a(r(52954)),s=a(r(35838)),o=r(77725),u=r(34507),l=r(24897),d=r(26085),c=r(93116),f=r(75637);function p(){var e=(0,n.default)(["syncDeviceList: skipping "," out of "," records"]);return p=function(){return e},e}function h(){var e=(0,n.default)(["syncDeviceList: error ",": ",""]);return h=function(){return e},e}function _(){var e=(0,n.default)(["Failed to sync device list with error: ",""]);return _=function(){return e},e}var m=new Map;function g(){return v.apply(this,arguments)}function v(){return(v=(0,i.default)((function*(e,t,r){if(null!=r){var a=e.map((e=>e.user)),n=(yield(0,o.getDeviceIds)(a)).map((e=>e?e.devices.map((t=>(0,f.createDeviceWidFromUserAndDevice)(e.id,t))):[])),u=(0,s.default)(n,(e=>e));if(r===(yield(0,l.phashV2)(u)))return}var d=new Set,c=[];if(e.forEach((e=>{var t=m.get(e.user);t?d.add(t):c.push(e)})),0!==c.length){var p=c.map((e=>e.user)),h=(0,o.getDeviceIds)(p).then(function(){var e=(0,i.default)((function*(e){var r=e.map((e=>e?e.devices.map((t=>(0,f.createDeviceWidFromUserAndDevice)(e.id,t))):[])),a=yield Promise.all(r.map((e=>0===e.length?"":(0,l.phashV2)(e))));return y(c.map(((e,t)=>({id:e,hash:a[t]}))),t)}));return function(){return e.apply(this,arguments)}}()).catch((e=>{__LOG__(4,void 0,new Error)(_(),e)})).finally((()=>{c.map((e=>{m.delete(e.user)}))}));c.map((e=>{m.set(e.user,h)})),yield Promise.all([h,...d])}}))).apply(this,arguments)}function E(){return(E=(0,i.default)((function*(e){var t=e.map((e=>e.user));return yield g(e),(0,o.getDeviceIds)(t)}))).apply(this,arguments)}function y(){return S.apply(this,arguments)}function S(){return(S=(0,i.default)((function*(e,t){if(0!==e.length){var r=(new c.USyncQuery).withContext(t||"interactive").withDeviceProtocol();e.forEach((e=>{r.withUser((new d.USyncUser).withId(e.id).withDeviceHash(String(e.hash)))}));var a=yield r.execute();if(a.error.all)throw new Error("syncDeviceList: error ".concat(a.error.all.errorCode,": ").concat(a.error.all.errorText));a.error.devices&&__LOG__(3)(h(),a.error.devices.errorCode,a.error.devices.errorText);var n=a.list.filter((e=>!("errorCode"in e.devices))).filter((e=>null!=e.devices.deviceList&&null!=e.devices.keyIndex)).map((e=>({wid:e.id,devices:e.devices})));return __LOG__(2)(p(),a.list.length-n.length,a.list.length),(0,u.handleADVDeviceSyncResult)(n)}}))).apply(this,arguments)}},19239:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.blockUser=function(e){return c.default.mdBlocklistV2?function(e){return b(e,!0)}(e):function(e){var t=u.default.map((e=>e.id));return t.push(e),S((0,i.default)(t))}(e)},t.unblockUser=function(e){return c.default.mdBlocklistV2?function(e){return b(e,!1)}(e):function(e){var t=u.default.map((e=>e.id));return t.splice(t.indexOf(e),1),S((0,i.default)(t))}(e)};var n=a(r(19976)),i=a(r(75652)),s=r(51311),o=r(30691),u=a(r(79148)),l=r(54086),d=r(95595),c=a(r(72424)),f=r(95778),p=r(75637);function h(){var e=(0,n.default)(["blockUnblockUserV2: server response with ",", ",""]);return h=function(){return e},e}function _(){var e=(0,n.default)(["block/unblock user: success"]);return _=function(){return e},e}function m(){var e=(0,n.default)(["blockUserV2ResponseParser: server response with ",", ",""]);return m=function(){return e},e}function g(){var e=(0,n.default)(["sendBlocklist: server response with ",", ",""]);return g=function(){return e},e}function v(){var e=(0,n.default)(["sendBlocklist: sever response with ",", ",""]);return v=function(){return e},e}function E(){var e=(0,n.default)(["sendBlocklist: success"]);return E=function(){return e},e}var y=new s.WapParser("blockUser",(e=>{if(e.hasChild("error")){var t=e.child("error"),r=t.attrInt("code"),a=t.attrString("text");return __LOG__(3)(v(),r,a),{errorCode:r,errorText:a}}__LOG__(2)(E())}));function S(e){var t=0===e.length?(0,o.wap)("list",{name:"default"}):(0,o.wap)("list",{name:"default"},e.map((e=>(0,o.wap)("item",{action:"deny",type:"jid",value:(0,f.JID)(e),order:"1"})))),r=(0,o.wap)("iq",{xmlns:"jabber:iq:privacy",from:(0,f.JID)((0,d.assertGetMe)()),type:"set",id:(0,o.generateId)()},(0,o.wap)("query",null,t));return(0,l.sendIq)(r,y).then((e=>{if(e.success)return e.result;var{errorCode:t,errorText:r}=e;return __LOG__(3)(g(),t,r),{errorCode:t,errorText:r}}))}var T=new s.WapParser("blockUserV2ResponseParser",(e=>{var t;if(e.hasChild("error")){var r=e.child("error"),a=r.attrInt("code"),n=r.attrString("text");return __LOG__(3)(m(),a,n),{errorCode:a,errorText:n}}return __LOG__(2)(_()),{blockedUsers:null===(t=e.child("list"))||void 0===t?void 0:t.mapChildrenWithTag("item",(e=>(0,p.userJidToUserWid)(e.attrUserJid("jid"))))}}));function b(e,t){var r=(0,o.wap)("iq",{xmlns:"blocklist",to:o.S_WHATSAPP_NET,type:"set",id:(0,o.generateId)()},(0,o.wap)("item",{action:(0,o.CUSTOM_STRING)(t?"block":"unblock"),jid:(0,f.JID)(e)}));return(0,l.sendIq)(r,T).then((e=>{if(!e.success){var{errorCode:t,errorText:r}=e;return __LOG__(3)(h(),t,r),{errorCode:t,errorText:r}}}))}},85193:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.clearDirtyBits=function(e){if(0===e.length)return Promise.resolve();var t=e.map((e=>(0,i.wap)("clean",{type:(0,i.CUSTOM_STRING)(e.type),timestamp:(0,i.INT)(e.timestamp)}))),r=(0,i.wap)("iq",{to:i.S_WHATSAPP_NET,type:"set",xmlns:"urn:xmpp:whatsapp:dirty",id:(0,i.generateId)()},t);return(0,s.sendIq)(r,l).then((()=>{__LOG__(2)(u(),e.map((e=>e.type)).join(","))})).catch((()=>{__LOG__(3)(o())}))};var n=a(r(19976)),i=r(30691),s=r(54086);function o(){var e=(0,n.default)(["clearDirtyBits: failed with error"]);return o=function(){return e},e}function u(){var e=(0,n.default)(["clearDirtyBits: success for type: ",""]);return u=function(){return e},e}var l=new(a(r(23767)).default)("cleanDirtyReplyParser",(e=>(e.assertAttr("type","result"),{})))},85804:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.metricsCiphertextType=function(e){switch(e){case s.CiphertextType.Skmsg:return i.default.E2E_CIPHERTEXT_TYPE.SENDER_KEY_MESSAGE;case s.CiphertextType.Pkmsg:return i.default.E2E_CIPHERTEXT_TYPE.PREKEY_MESSAGE;case s.CiphertextType.Msg:return i.default.E2E_CIPHERTEXT_TYPE.MESSAGE}},t.metricsMediaType=function(e){switch(e){case s.MediaType.Photo:return i.default.MEDIA_TYPE.PHOTO;case s.MediaType.Video:return i.default.MEDIA_TYPE.VIDEO;case s.MediaType.Audio:return i.default.MEDIA_TYPE.AUDIO;case s.MediaType.Ptt:return i.default.MEDIA_TYPE.PTT;case s.MediaType.Location:return i.default.MEDIA_TYPE.LOCATION;case s.MediaType.Contact:return i.default.MEDIA_TYPE.CONTACT;case s.MediaType.Document:return i.default.MEDIA_TYPE.DOCUMENT;case s.MediaType.Url:return i.default.MEDIA_TYPE.URL;case s.MediaType.Call:return i.default.MEDIA_TYPE.CALL;case s.MediaType.Gif:return i.default.MEDIA_TYPE.GIF;case s.MediaType.Future:return i.default.MEDIA_TYPE.FUTURE;case s.MediaType.ContactArray:return i.default.MEDIA_TYPE.CONTACT_ARRAY;case s.MediaType.LiveLocation:return i.default.MEDIA_TYPE.LIVE_LOCATION;case s.MediaType.ProfilePic:return i.default.MEDIA_TYPE.PROFILE_PIC;case s.MediaType.Sticker:return i.default.MEDIA_TYPE.STICKER;case s.MediaType.Hsm:return i.default.MEDIA_TYPE.HSM;case s.MediaType.ProductImage:return i.default.MEDIA_TYPE.PRODUCT_IMAGE;case s.MediaType.Template:return i.default.MEDIA_TYPE.TEMPLATE;case s.MediaType.MdAppState:return i.default.MEDIA_TYPE.MD_APP_STATE;case s.MediaType.MdHistorySync:return i.default.MEDIA_TYPE.MD_HISTORY_SYNC;case s.MediaType.List:return i.default.MEDIA_TYPE.LIST;case s.MediaType.ListResponse:return i.default.MEDIA_TYPE.LIST_REPLY;case s.MediaType.Button:return i.default.MEDIA_TYPE.BUTTON_MESSAGE;case s.MediaType.ButtonResponse:return i.default.MEDIA_TYPE.BUTTON_RESPONSE_MESSAGE;case s.MediaType.Order:return i.default.MEDIA_TYPE.ORDER;case s.MediaType.Product:return i.default.MEDIA_TYPE.PRODUCT_IMAGE}},t.mediaTypeFromProtobuf=function e(t){if(t.deviceSentMessage){var{message:r}=t.deviceSentMessage;return r?e(r):null}if(t.ephemeralMessage){var{message:a}=t.ephemeralMessage;return a?e(a):null}if(t.viewOnceMessage){var{message:n}=t.viewOnceMessage;return n?e(n):null}return t.imageMessage?s.MediaType.Photo:t.stickerMessage?s.MediaType.Sticker:t.locationMessage?s.MediaType.LiveLocation:t.contactMessage?s.MediaType.Contact:t.contactsArrayMessage?s.MediaType.ContactArray:t.documentMessage?s.MediaType.Document:t.audioMessage?t.audioMessage.ptt?s.MediaType.Ptt:s.MediaType.Audio:t.videoMessage?t.videoMessage.gifPlayback?s.MediaType.Gif:s.MediaType.Video:t.buttonsMessage?s.MediaType.Button:t.buttonsResponseMessage?s.MediaType.ButtonResponse:t.listMessage?s.MediaType.List:t.listResponseMessage?s.MediaType.ListResponse:t.orderMessage?s.MediaType.Order:t.productMessage?s.MediaType.Product:null},t.encodeMediaType=o,t.maybeEncoder=u,t.metricsDestinationType=function(e){if(e.isUser())return i.default.E2E_DESTINATION.INDIVIDUAL;if(e.isGroup())return i.default.E2E_DESTINATION.GROUP;if(e.isStatusV3())return i.default.E2E_DESTINATION.STATUS;if(e.isBroadcast())return i.default.E2E_DESTINATION.LIST;throw new Error},t.encodeMaybeMediaType=t.CIPHERTEXT_VERSION=void 0;var n=r(30691),i=a(r(40210)),s=r(96571);function o(e){var t=(()=>{switch(e){case s.MediaType.Photo:return"image";case s.MediaType.Video:return"video";case s.MediaType.Audio:return"audio";case s.MediaType.Ptt:return"ptt";case s.MediaType.Contact:return"vcard";case s.MediaType.Document:return"document";case s.MediaType.Gif:return"gif";case s.MediaType.ContactArray:return"contact_array";case s.MediaType.LiveLocation:return"livelocation";case s.MediaType.Sticker:return"sticker";case s.MediaType.List:return"list";case s.MediaType.ListResponse:return"list_response";case s.MediaType.ButtonResponse:return"buttons_response";case s.MediaType.Order:return"order";case s.MediaType.Product:return"product";default:return null}})();if(t)return(0,n.CUSTOM_STRING)(t);throw new Error("Unsupported type")}function u(e){return t=>null==t?n.DROP_ATTR:e(t)}t.CIPHERTEXT_VERSION=2;var l=u(o);t.encodeMaybeMediaType=l},9492:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=l.parseParsableWap(e);if(t.error)throw __LOG__(4,void 0,new Error)(u(),t.error.toString(),e.toString()),t.error;return t.success};var n=a(r(19976)),i=r(25975),s=a(r(23767)),o=a(r(15059));function u(){var e=(0,n.default)([""," parsing ",""]);return u=function(){return e},e}var l=new s.default("businessProfile",(e=>{var t,r=e.maybeChild("address"),a=r?r.contentString():void 0,n=e.maybeChild("description"),s=n?n.contentString():void 0,u=e.maybeChild("email"),l=u?u.contentString():void 0,d=e.maybeChild("latitude"),c=d?parseFloat(d.contentString()):void 0,f=e.maybeChild("longitude"),p=f?parseFloat(f.contentString()):void 0,h=e.maybeChild("vertical");if(h){var _=h.maybeAttrString("canonical");t={name:h.hasContent()?h.contentString():void 0,canonical:_}}var m=[];e.forEachChildWithTag("website",(e=>{m.push(e.contentString())}));var g,v=[],E=e.maybeChild("categories");E&&E.forEachChildWithTag("category",(e=>{var t=e.attrString("id");v.push({id:t,localized_display_name:e.contentString()})}));var y,S=e.maybeChild("business_hours");if(S){var T=S.maybeAttrString("timezone"),b=[];S.forEachChildWithTag("business_hours_config",(e=>{b.push({day_of_week:e.attrString("day_of_week"),mode:e.attrString("mode"),open_time:e.hasAttr("open_time")?parseInt(e.attrString("open_time"),10):0,close_time:e.hasAttr("close_time")?parseInt(e.attrString("close_time"),10):0})})),g={config:b,timezone:T}}var A=e.maybeChild("profile_options");if(A){y={};var C,P=A.maybeChild("commerce_experience");if(P)y.commerce_experience=null!==(C=i.COMMERCE_EXPERIENCE_TYPES.cast(P.contentString()))&&void 0!==C?C:i.COMMERCE_EXPERIENCE_TYPES.NONE;var O=A.maybeChild("cart_enabled");O&&(y.cart_enabled=Boolean(O.contentString()));var w=A.maybeChild("shop_url");w&&(y.shop_url=w.contentString())}var M=e.maybeChild("catalog_status"),I=M?M.attrString("status"):void 0,R={address:a,description:s,email:l,latitude:c,longitude:p,vertical:t,website:m,categories:v,business_hours:g,catalog_status:I,profile_options:y};return(0,o.default)(R)}))},56154:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseErrorFields=void 0;var a=new(r(51311).WapParser)("parseErrorFields",(e=>{var t=[];return e.forEachChildWithTag("field",(e=>{var r=e.hasAttr("detail")?e.maybeAttrString("detail"):null;t.push({name:e.attrString("name"),reason:e.attrString("reason"),detail:r})})),t}));t.parseErrorFields=a},8318:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=l.parseParsableWap(e);if(t.error)throw __LOG__(4,void 0,new Error)(u(),t.error.toString(),e.toString()),t.error;return t.success};var n=a(r(19976)),i=r(90272),s=a(r(23767)),o=r(72557);function u(){var e=(0,n.default)([""," parsing ",""]);return u=function(){return e},e}var l=new s.default("verifiedName",(e=>{var t=e.attrEnum("verified_level",i.VERIFIED_LEVEL),r=e.hasContent()?e.contentBytes():null,a=e.maybeAttrString("serial"),{serial:n,name:s,isApi:u}=r&&function(e){var t=(0,o.getParsedProtoObjects)(e);if(t&&t.details){var{name:r,serial:a,isApi:n}=(0,o.extractCertificateDetailsParams)(t.details);return{name:r,serial:String(a),isApi:n}}}(r)||{};return{level:t,serial:a||n,name:s,isApi:Boolean(u),actualActors:e.maybeAttrEnum("actual_actors",i.ACTUAL_ACTORS),hostStorage:e.maybeAttrEnum("host_storage",i.HOST_STORAGE),privacyModeTs:e.maybeAttrInt("privacy_mode_ts")}}))},38815:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.syncNewContact=function(e){D.push(e),R?R.debounce(1e3):(R=new u.ShiftTimer((()=>{if((0,h.isRegistered)()){var e=D;D=[],R=null,__LOG__(2)(I(),e.length),L(e).catch((e=>{__LOG__(4,!0,new Error,!0)(M()),SEND_LOGS("contact sync failed: "+e)}))}}))).onOrBefore(2e4)},t.syncContactListInChunks=function(){return N.apply(this,arguments)},t.syncContactList=L,t.runSyncDirtyContactsJob=function(){(0,h.getShouldCheckContactSyncStatus)()&&setTimeout((function(){(0,p.getContactTable)().equals(["isContactSyncCompleted"],0).then((e=>{var t=e.map((e=>(0,y.createWid)(e.id)));return __LOG__(2)(C(),t.length),L(t)}))}),6e4);(0,h.setShouldCheckContactSyncStatus)()};var n=a(r(52954)),i=a(r(19976)),s=a(r(93586)),o=r(91460),u=r(39329),l=r(41263),d=r(77725),c=r(33058),f=r(34507),p=r(11008),h=r(39174),_=r(24897),m=a(r(76019)),g=r(26085),v=r(93116),E=r(30254),y=r(75637);function S(){var e=(0,i.default)(["handleSyncDevice: skipping "," out of "," records"]);return S=function(){return e},e}function T(){var e=(0,i.default)(["handleSyncDevice: error ",": ",""]);return T=function(){return e},e}function b(){var e=(0,i.default)(["failed to execute usync query"]);return b=function(){return e},e}function A(){var e=(0,i.default)(["[contact sync] start regular contact sync for "," chunks of contacts, chunk size: ",""]);return A=function(){return e},e}function C(){var e=(0,i.default)(["[contact sync] sync dirty contacts, found "," contacts to sync"]);return C=function(){return e},e}function P(){var e=(0,i.default)(["[contact sync] mark "," contacts completed for contact sync"]);return P=function(){return e},e}function O(){var e=(0,i.default)(["handleSyncProfilePictures: failed "," : ",""]);return O=function(){return e},e}function w(){var e=(0,i.default)(["handleSyncStatus: failed "," : ",""]);return w=function(){return e},e}function M(){var e=(0,i.default)(["contact sync failed"]);return M=function(){return e},e}function I(){var e=(0,i.default)(["[contact sync] start new contact sync for "," contacts"]);return I=function(){return e},e}var R=null,D=[];function N(){return(N=(0,n.default)((function*(e,t=500){var r=(0,s.default)(e,t);__LOG__(2)(A(),r.length,t);for(var a=0;a<r.length;a++){var n=r[a];yield(0,o.delayMs)(2e4),yield L(n)}}))).apply(this,arguments)}function L(){return k.apply(this,arguments)}function k(){return(k=(0,n.default)((function*(e,t=!0){if(0!==e.length){var r=yield U(e),a=(new v.USyncQuery).withContext("background").withMode("query").withBusinessProtocol().withStatusProtocol().withPictureProtocol();t&&a.withDeviceProtocol(),r.forEach((e=>{a.withUser((new g.USyncUser).withId(e.id).withDeviceHash(String(e.hash)))}));for(var n=null,i=3;i-- >0;)try{var s=(n=yield a.execute()).error.all;if(s)throw new Error("syncContactList: error ".concat(s.errorCode,": ").concat(s.errorText));i=0}catch(e){0===i&&(__LOG__(4,!0,new Error,!0)(b()),SEND_LOGS("failed to execute usync query: "+e)),yield(0,o.delayMs)(1e4*Math.random())}null==n||n.error.all||(yield Promise.all([t?Y(n):Promise.resolve(),G(n),x(n),j(n)]),yield W(e))}}))).apply(this,arguments)}function U(){return F.apply(this,arguments)}function F(){return(F=(0,n.default)((function*(e){var t=e.map((e=>e.user)),r=(yield(0,d.getDeviceIds)(t)).map((e=>e?e.devices.map((t=>(0,y.createDeviceWidFromUserAndDevice)(e.id,t))):[])),a=yield Promise.all(r.map((e=>0===e.length?"":(0,_.phashV2)(e))));return e.map(((e,t)=>({id:e,hash:a[t]})))}))).apply(this,arguments)}function G(e){var t=e.error.status;t?__LOG__(3)(w(),t.errorCode,t.errorText):e.list.map((e=>{var t=m.default.get(e.id);t&&e.status&&t.set({status:e.status})}))}function x(){return B.apply(this,arguments)}function B(){return(B=(0,n.default)((function*(e){var t=e.list.filter((({business:e})=>Boolean(e)));yield(0,E.handleVerifiedNameSync)(t.map((({id:e,business:{verifiedName:t}})=>({id:e,verifiedName:t}))))}))).apply(this,arguments)}function Y(){return K.apply(this,arguments)}function K(){return(K=(0,n.default)((function*(e){var t=e.error.devices;t&&__LOG__(3)(T(),t.errorCode,t.errorText);var r=e.list.filter((e=>e.devices&&null!=e.devices.deviceList&&null!=e.devices.keyIndex&&!("errorCode"in e.devices))).map((e=>({wid:e.id,devices:e.devices})));return __LOG__(2)(S(),e.list.length-r.length,e.list.length),yield(0,c.getAndStoreIdentityKeys)(r.map((e=>e.wid))),(0,f.handleADVDeviceSyncResult)(r)}))).apply(this,arguments)}function j(e){var t=e.error.pictures;t&&__LOG__(3)(O(),t.errorCode,t.errorText)}function W(e){var t=e.map((e=>({id:(0,l.toJid)(e.user),isContactSyncCompleted:1})));return __LOG__(2)(P(),t.length),(0,p.getContactTable)().bulkCreateOrMerge(t)}},99883:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.digestKey=function(){var e=(0,i.wap)("iq",{xmlns:"encrypt",type:"get",to:i.S_WHATSAPP_NET,id:(0,i.generateId)()},(0,i.wap)("digest",null));return(0,o.sendIq)(e,v).then((e=>{if(e.success)return(t=e.result,Promise.all([l.waSignalStore.getRegistrationInfo(),l.waSignalStore.getSignedPreKey()]).then((([e,r])=>{if(!e||!r)throw new Error("validateLocalKeyBundle: No registration info is available");if(t.regId!==e.registrationId)throw new Error("validateLocalKeyBundle: registation id mismatch");var a=e.identityKeyPair.pubKey,n=r.keyPair.pubKey,i=a.byteLength+n.byteLength+r.signature.byteLength+32*t.keys.length,o=new Uint8Array(i),u=0;[a,n,r.signature].forEach((e=>{o.set(new Uint8Array(e),u),u+=e.byteLength}));var c=t.keys.map((e=>l.waSignalStore.getPreKeyById(e).then((t=>{if(!t)throw Error("validateLocalKeyBundle: missing prekey record for id ".concat(e));return t.keyPair.pubKey}))));return Promise.all(c).then((e=>(e.forEach((e=>{o.set(new Uint8Array(e),u),u+=e.byteLength})),o))).then((e=>{d.default.digest("SHA-1",e).then((e=>{var r=(0,s.encodeB64)(e),a=(0,s.encodeB64)(t.hash);if(r!==a)throw Error("validateLocalKeyBundle: hash mismatch remote:".concat(a," local:").concat(r));__LOG__(2)(f())}))}))}))).then((()=>({shouldUploadAll:!1}))).catch((()=>({shouldUploadAll:!1})));var t,r=e.errorCode;return 404===r?(__LOG__(3)(g()),Promise.resolve({shouldUploadAll:!0})):(406===r?__LOG__(3)(m()):503===r?__LOG__(3)(_()):__LOG__(3)(h(),r),Promise.resolve({shouldUploadAll:!1}))})).then((e=>{if(e.shouldUploadAll)return __LOG__(2)(p()),(0,c.uploadPreKeys)()}))};var n=a(r(19976)),i=r(30691),s=r(60339),o=r(54086),u=a(r(23767)),l=r(44480),d=a(r(84025)),c=r(29738);function f(){var e=(0,n.default)(["validateLocalKeyBundle: success"]);return f=function(){return e},e}function p(){var e=(0,n.default)(["digestKey: validate key bundle failed, upload prekeys again"]);return p=function(){return e},e}function h(){var e=(0,n.default)(["digestKey: server error ",""]);return h=function(){return e},e}function _(){var e=(0,n.default)(["digestKey: service unavailable"]);return _=function(){return e},e}function m(){var e=(0,n.default)(["digestKey: malformed request"]);return m=function(){return e},e}function g(){var e=(0,n.default)(["digestKey: no record found for current user"]);return g=function(){return e},e}var v=new u.default("digestResponseParser",(e=>{var t=e.child("digest"),r=t.child("skey");return{regId:t.child("registration").contentUint(4),type:t.child("type").contentUint(1),identity:t.child("identity").contentBytes(32),skey:{id:r.child("id").contentUint(3),pubkey:r.child("value").contentBytes(32),signature:r.child("signature").contentBytes(64)},keys:t.child("list").mapChildren((e=>e.contentUint(3))),hash:t.child("hash").contentBytes(20)}}))},27442:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){if(!o.default.isWid(e)||!e.isUser())return __LOG__(3)(l(),e),Promise.resolve({id:e});return(new s.USyncQuery).withContext("interactive").withMode("query").withStatusProtocol().withUser((new i.USyncUser).withId(e)).execute().then((t=>{if(t.error.all||t.error.status){var r=t.error.all||t.error.status;return __LOG__(3)(u(),r.errorCode,r.errorText),{id:e,error:r}}var a=t.list;return a.length||Promise.reject(new Error("no status data returned for user")),{id:e,status:a[0].status}}))};var n=a(r(19976)),i=r(26085),s=r(93116),o=a(r(68384));function u(){var e=(0,n.default)(["getAbout: failed "," : ",""]);return u=function(){return e},e}function l(){var e=(0,n.default)(["getAbout: this method should only take user wid, instead it received: ",""]);return l=function(){return e},e}},85142:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.getBlocklist=function(){return(0,s.sendIq)((0,i.wap)("iq",{xmlns:"jabber:iq:privacy",from:(0,l.JID)((0,o.assertGetMe)()),type:"get",id:(0,i.generateId)()},(0,i.wap)("query",null,(0,i.wap)("list",{name:"default"}))),f).then((e=>{if(e.success)return __LOG__(2)(c()),e.result;var{errorCode:t,errorText:r}=e;return __LOG__(3)(d(),t,r),{errorCode:t,errorText:r}}))};var n=a(r(19976)),i=r(30691),s=r(54086),o=r(95595),u=a(r(23767)),l=r(95778);function d(){var e=(0,n.default)(["getBlocklist: failed ",", ",""]);return d=function(){return e},e}function c(){var e=(0,n.default)(["getBlocklist from server"]);return c=function(){return e},e}var f=new u.default("getBlocklistParser",(e=>e.hasChild("error")&&404===e.child("error").attrInt("code")?{wids:[]}:{wids:p(e)}));function p(e){return e.child("query").child("list").mapChildrenWithTag("item",(e=>e.attrUserWid("value")))}},33058:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.getAndStoreIdentityKeys=function(){return g.apply(this,arguments)},t.default=v;var n=a(r(19976)),i=a(r(52954)),s=r(30691),o=r(54086),u=r(72434),l=a(r(23767)),d=r(44480),c=r(43097),f=r(44762),p=r(95778);function h(){var e=(0,n.default)(["getAndStoreIdentityKeys: query "," missing keys for "," contacts"]);return h=function(){return e},e}function _(){var e=(0,n.default)(["getAndStoreIdentityKeys: got 0 missing keys"]);return _=function(){return e},e}var m=new l.default("identityKeysParser",(e=>e.child("list").mapChildren((e=>{if(e.hasChild("error")){var t=e.child("error"),r=t.attrInt("code"),a=t.attrString("text");throw new Error("identityKeysParser bad response: ".concat(r," ").concat(a))}return{type:e.child("type").contentBytes(1),identity:e.child("identity").contentBytes(32),user:e.attrUserWid("jid")}}))));function g(){return(g=(0,i.default)((function*(e){var t=yield d.waSignalStore.bulkGetIdentity(e.map((e=>String((0,f.createSignalAddress)(e))))),r=e.filter(((e,r)=>null==t[r]));if(0!==r.length){__LOG__(2)(h(),r.length,e.length);var a=(yield v(r)).map((e=>{var t=e.identity,r=(0,u.toSignalCurvePubKey)(t.buffer.slice(t.byteOffset,t.byteLength+t.byteOffset));return{identityKey:(0,f.bufferToStr)(r),identifier:(0,f.createSignalAddress)(e.user).toString()}}));return(0,c.getStorage)().lock(["identity-store"],(()=>d.waSignalStore.bulkPutIdentity(a)))}__LOG__(2)(_())}))).apply(this,arguments)}function v(e){var t=e.map((e=>(0,s.wap)("user",{jid:(0,p.DEVICE_JID)(e)}))),r=(0,s.wap)("iq",{xmlns:"encrypt",type:"get",to:s.S_WHATSAPP_NET,id:(0,s.generateId)()},(0,s.wap)("identity",null,t));return(0,o.sendIq)(r,m).then((e=>{if(!e.success)throw new Error("getIdentityKeys bad response ".concat(String(e)));return e.result}))}},97066:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.getProfilePicPreview=function(e,t){return p(e,{preview:!0,invite:t})},t.getProfilePicFull=function(e){return p(e,{preview:!1})};var n=a(r(19976)),i=r(30691),s=r(54086),o=r(19741),u=a(r(23767)),l=r(95778);function d(){var e=(0,n.default)(["getProfilePic: "," ",", ",", ",""]);return d=function(){return e},e}var c={preview:"preview",image:"image"},f=new u.default("profilePicParser",(e=>{var t=e.child("picture");return{id:t.attrInt("id"),type:t.attrEnum("type",c),url:t.attrString("url")}}));function p(e,t){var{preview:r,invite:a,photoId:n}=t,u=(0,i.wap)("iq",{to:(0,l.CHAT_JID)(e),type:"get",xmlns:"w:profile:picture",id:(0,i.generateId)()},(0,i.wap)("picture",{invite:(0,i.MAYBE_CUSTOM_STRING)(a),type:r?"preview":i.DROP_ATTR,id:null!=n?(0,i.INT)(n):i.DROP_ATTR,query:"url"}));return(0,s.sendIq)(u,f).then((t=>{if(t.success){var{id:r,url:a,type:n}=t.result;return __LOG__(2)(d(),e.toString(),r,n,a),{tag:r.toString(),eurl:a,type:n}}return Promise.reject(new o.ServerStatusCodeError(t.errorCode,t.errorText))}))}},25692:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.createGroup=function(e,t,r=!1){var a=(0,i.randomHex)(8),l=(0,s.getABPropConfigValue)("groups_dogfooding_ui"),d=t.map((e=>(0,n.wap)("participant",{jid:(0,c.USER_JID)(e)})));l&&r&&d.unshift((0,n.wap)("dogfooding",null));var f=(0,n.wap)("iq",{to:n.G_US,type:"set",xmlns:"w:g2",id:(0,n.generateId)()},(0,n.wap)("create",{subject:(0,n.CUSTOM_STRING)(e),key:(0,n.CUSTOM_STRING)(a)},d));return(0,o.sendIq)(f,p).then((e=>e.success?e.result:Promise.reject(new u.ServerStatusCodeError(e.errorCode,e.errorText))))};var n=r(30691),i=r(8320),s=r(97148),o=r(54086),u=r(19741),l=a(r(23767)),d=r(51890),c=r(95778),f=r(75637),p=new l.default("createGroupReplyParser",(e=>{var t,r=e.child("group");try{t=(0,f.createWid)("".concat(r.attrString("id"),"@g.us"))}catch(e){}if(!t||!t.isGroup)throw Error("createGroupReplyParser: invalid group id");return{wid:t,subject:r.attrString("subject"),creator:r.attrUserWid("creator"),ts:r.attrTime("creation"),participants:r.mapChildrenWithTag("participant",(e=>{var t=e.getFirstChild();return{wid:e.attrUserWid("jid"),error:e.hasAttr("error")?e.attrInt("error"):null,invite_code:t&&t.attrString("code"),invite_code_exp:t&&t.attrString("expiration"),type:e.attrEnumOrDefault("type",d.GROUP_PARTICIPANT_TYPES,"participant")}}))}}))},35938:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.leaveGroups=function(e){var t=e.map((e=>(0,n.wap)("group",{id:(0,u.GROUP_JID)(e)}))),r=(0,n.wap)("iq",{to:n.G_US,type:"set",xmlns:"w:g2",id:(0,n.generateId)()},(0,n.wap)("leave",null,t));return(0,i.sendIq)(r,l).then((e=>e.success?e.result:Promise.reject(new s.ServerStatusCodeError(e.errorCode,e.errorText))))};var n=r(30691),i=r(54086),s=r(19741),o=a(r(23767)),u=r(95778),l=new o.default("leaveGroupResultParser",(e=>(e.assertAttr("type","result"),{groups:e.child("leave").mapChildren((e=>e.attrGroupWid("id")))})))},88258:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.queryAllGroups=function(){var e=(0,s.wap)("iq",{to:s.G_US,type:"get",xmlns:"w:g2",id:(0,s.generateId)()},(0,s.wap)("participating",null,(0,s.wap)("participants",null),(0,s.wap)("description",null)));return(0,o.sendIq)(e,v).then((e=>e.success?e.result:(__LOG__(2)(_(),e.errorCode,e.errorType),Promise.reject(new u.ServerStatusCodeError(e.errorCode,e.errorText)))))},t.queryGroup=function(e,t,r){var a=(0,s.wap)("iq",{to:(0,c.GROUP_JID)(e),type:"get",xmlns:"w:g2",id:(0,s.generateId)()},(0,s.wap)("query",{request:t||s.DROP_ATTR,phash:(0,s.MAYBE_CUSTOM_STRING)(r)}));return(0,o.sendIq)(a,g).then((e=>{if(e.success){var{result:t}=e;return t.phashMatch?Promise.reject(new Error("queryGroup: phash match case is not implemented!")):t}return __LOG__(2)(h(),e.errorCode,e.errorType),Promise.reject(new u.ServerStatusCodeError(e.errorCode,e.errorText))}))},t.queryGroupInvite=function(e){var t=(0,s.wap)("iq",{to:s.G_US,type:"get",xmlns:"w:g2",id:(0,s.generateId)()},(0,s.wap)("invite",{code:(0,s.CUSTOM_STRING)(e)}));return(0,o.sendIq)(t,g).then((e=>e.success?e.result:(__LOG__(2)(p(),e.errorCode,e.errorType),Promise.reject(new u.ServerStatusCodeError(e.errorCode,e.errorText)))))};var n=a(r(19976)),i=a(r(70417)),s=r(30691),o=r(54086),u=r(19741),l=a(r(23767)),d=r(51890),c=r(95778),f=r(75637);function p(){var e=(0,n.default)(["queryGroupInvite failed: ",":",""]);return p=function(){return e},e}function h(){var e=(0,n.default)(["queryGroup failed: ",":",""]);return h=function(){return e},e}function _(){var e=(0,n.default)(["queryAllGroups failed: ",":",""]);return _=function(){return e},e}function m(e){var t,r=function(e){if(e.hasChild("description")){var t=e.child("description");if(t.hasChild("body")){var r=t.child("body");if(r.hasContent()){var a={desc:r.contentString(),descId:t.attrString("id")};return t.hasAttr("participant")&&(a.descOwner=t.attrUserWid("participant")),t.hasAttr("t")&&(a.descTime=t.attrTime("t")),a}}}return null}(e),a=function(e){var t={subject:e.attrString("subject")};return e.hasAttr("s_o")&&(t.subjectOwner=e.attrUserWid("s_o")),e.hasAttr("s_t")&&(t.subjectTime=e.attrTime("s_t")),t}(e),n=function(e){if(e.hasChild("ephemeral")){var t=e.child("ephemeral");if(t.hasAttr("expiration"))return{ephemeralDuration:t.attrInt("expiration")}}return null}(e);try{t=(0,f.createWid)("".concat(e.attrString("id"),"@g.us"))}catch(e){}if(!t||!t.isGroup)throw Error("createGroupReplyParser: invalid group id");var s=e.mapChildrenWithTag("participant",(e=>{var t=e.attrEnumOrDefault("type",d.GROUP_PARTICIPANT_TYPES,d.GROUP_PARTICIPANT_TYPES.participant);return{id:e.attrUserWid("jid"),isSuperAdmin:t===d.GROUP_PARTICIPANT_TYPES.superadmin,isAdmin:t===d.GROUP_PARTICIPANT_TYPES.admin||t===d.GROUP_PARTICIPANT_TYPES.superadmin}})),o={id:t,owner:e.hasAttr("creator")?e.attrUserWid("creator"):void 0,creation:e.attrTime("creation"),restrict:e.hasChild("locked"),announce:e.hasChild("announcement"),noFrequentlyForwarded:e.hasChild("no_frequently_forwarded"),participants:s,pvId:e.hasAttr("p_v_id")?e.attrInt("p_v_id"):void 0,support:e.hasChild("support")};return(0,i.default)((0,i.default)((0,i.default)((0,i.default)({},o),r),n),a)}var g=new l.default("queryGroupParser",(e=>e.hasChild("group")?m(e.child("group")):{phashMatch:!0})),v=new l.default("queryAllGroupParser",(e=>e.child("groups").mapChildren(m)))},51890:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GROUP_PARTICIPANT_TYPES=void 0;t.GROUP_PARTICIPANT_TYPES={superadmin:"superadmin",admin:"admin",participant:"participant"}},1472:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=_.parse(e);if(t.error)return __LOG__(4,void 0,new Error)(d(),t.error.toString(),e.toString()),Promise.reject(t.error);return function(e){switch(__LOG__(2)(p(),e.type,e.from.toString()),e.type){case h.SIDE_LIST_CHANGE:break;case h.CHANGE:var t=u.default.get(e.from);t?t.status=e.content:__LOG__(3)(f(),e.from);break;default:__LOG__(3)(c(),e.type)}return(0,s.wap)("ack",{id:(0,s.CUSTOM_STRING)(e.stanzaId),to:"change"===e.type?(0,l.JID)(e.from):(0,s.CUSTOM_STRING)(e.from),class:"notification",type:"status"})}(t.success)},t.NOTIFICATION_TYPE=void 0;var n=a(r(19976)),i=a(r(70417)),s=r(30691),o=a(r(23767)),u=a(r(76019)),l=r(95778);function d(){var e=(0,n.default)([""," parsing ",""]);return d=function(){return e},e}function c(){var e=(0,n.default)(["handleAboutNotification: unhandled notification of\ntype ",""]);return c=function(){return e},e}function f(){var e=(0,n.default)(["handleAboutNotification: get status update for unknown contact ",""]);return f=function(){return e},e}function p(){var e=(0,n.default)(["handleAboutNotification: received ","\nfor ",""]);return p=function(){return e},e}var h=Object.freeze({CHANGE:"change",SIDE_LIST_CHANGE:"sideListChange",UNKNOWN:"unknown"});t.NOTIFICATION_TYPE=h;var _=new o.default("incomingAboutNotification",(e=>{e.assertTag("notification");var t={stanzaId:e.attrString("id")},r=e.hasChild("set")&&e.child("set");if(r&&!r.hasAttr("hash"))return(0,i.default)({type:h.CHANGE,from:e.attrUserWid("from"),pushname:e.attrString("notify"),content:r.contentString(),ts:e.attrTime("t")},t);var a=h.UNKNOWN;return r&&r.hasAttr("hash")&&(a=h.SIDE_LIST_CHANGE),(0,i.default)({type:a,from:e.attrString("from")},t)}))},71432:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.getAndUpdateStatus=E,t.default=function(){return y.apply(this,arguments)};var n=a(r(52954)),i=a(r(19976)),s=a(r(70417)),o=r(30691),u=r(30868),l=r(54086),d=r(95595),c=a(r(23767)),f=a(r(76019)),p=r(95778);function h(){var e=(0,i.default)(["account sync notification of type "," not supported"]);return h=function(){return e},e}function _(){var e=(0,i.default)([""," parsing ",""]);return _=function(){return e},e}function m(){var e=(0,i.default)(["Error in sendIq fetching user status: ",""]);return m=function(){return e},e}var g=new c.default("incomingAccountSyncNotification",(e=>{e.assertTag("notification");var t,r,a,n,i={stanzaId:e.attrString("id"),ts:e.attrTime("t"),from:e.attrUserWid("from")};if(e.hasChild("status")){var o;null===(o=e.getFirstChild())||void 0===o||o.assertTag("status");var l=e.getFirstChild();return(0,s.default)({type:u.ACCOUNT_SYNC_TYPE.STATUS,action:null==l?void 0:l.attrString("action")},i)}if(e.hasChild("privacy"))return null===(t=e.getFirstChild())||void 0===t||t.assertTag("privacy"),(0,s.default)({type:u.ACCOUNT_SYNC_TYPE.PRIVACY},i);if(e.hasChild("devices"))return null===(r=e.getFirstChild())||void 0===r||r.assertTag("devices"),(0,s.default)({type:u.ACCOUNT_SYNC_TYPE.DEVICES},i);if(e.hasChild("blocklist"))return null===(a=e.getFirstChild())||void 0===a||a.assertTag("blocklist"),(0,s.default)({type:u.ACCOUNT_SYNC_TYPE.BLOCKLIST},i);if(e.hasChild("picture"))return null===(n=e.getFirstChild())||void 0===n||n.assertTag("picture"),(0,s.default)({type:u.ACCOUNT_SYNC_TYPE.PICTURE},i);throw new Error("notification type not supported")})),v=new c.default("statusParser",(e=>{var t,r,a,n;return e.assertAttr("type","result"),{status:null===(t=e.child("status"))||void 0===t||null===(r=t.getFirstChild())||void 0===r?void 0:r.contentString(),t:null===(a=e.child("status"))||void 0===a||null===(n=a.getFirstChild())||void 0===n?void 0:n.attrTime("t")}}));function E(){var e=(0,o.wap)("iq",{xmlns:"status",to:o.S_WHATSAPP_NET,type:"get",id:(0,o.generateId)()},(0,o.wap)("status",null,(0,o.wap)("user",{jid:(0,p.USER_JID)((0,d.assertGetMe)())})));return(0,l.sendIq)(e,v).then((e=>{if(!(null==e?void 0:e.success))return __LOG__(3)(m(),e.errorText),Promise.reject(e.errorText);var{status:t}=e.result;t&&(f.default.assertGet((0,d.getMaybeMeUser)()).status=t)}))}function y(){return(y=(0,n.default)((function*(e){var t=g.parse(e);if(t.error)return __LOG__(4,void 0,new Error)(_(),t.error.toString(),e.toString()),Promise.reject(t.error);var r=t.success;switch(r.type){case u.ACCOUNT_SYNC_TYPE.STATUS:yield E();break;case u.ACCOUNT_SYNC_TYPE.DEVICES:yield(0,u.getDevices)("notification");break;case u.ACCOUNT_SYNC_TYPE.PICTURE:yield(0,u.getAndUpdateProfilePicture)();break;case u.ACCOUNT_SYNC_TYPE.PRIVACY:(0,u.updatePrivacySettings)();break;case u.ACCOUNT_SYNC_TYPE.BLOCKLIST:(0,u.updateBlocklist)();break;default:__LOG__(2)(h(),r.type)}return(0,o.wap)("ack",{id:(0,o.CUSTOM_STRING)(r.stanzaId),to:(0,p.JID)(r.from),class:"notification",type:"status"})}))).apply(this,arguments)}},71290:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.handleVerifiedBusinessNameNotificationHash=function(){return b.apply(this,arguments)},t.handleVerifiedBusinessNameNotificationContact=function(){return A.apply(this,arguments)};var n=a(r(52954)),i=a(r(19976)),s=r(30691),o=r(54086),u=a(r(50935)),l=a(r(7470)),d=a(r(73896)),c=r(31555),f=a(r(23767)),p=r(77993),h=r(95207),_=r(84066),m=a(r(8318)),g=r(95778);function v(){var e=(0,i.default)(["verified name notification not found"]);return v=function(){return e},e}function E(e,t,r,a,n,i,s,o,u){return(0,_.createOrUpdateVerifiedBusinessName)(e,t,r,parseInt(n||"0",10),a,i,s,o,u)}function y(e){return(0,p.getStorage)().lock(["verified-business-name"],(([t])=>{var r=[E(t,e.wid,e.level,e.verifiedName,e.serial,e.isApi,e.actualActors,e.hostStorage,e.privacyModeTs)];return Promise.all(r)})).then((()=>{var t=[],r=l.default.get(e.wid);return null!=r&&t.push((0,d.default)(e.wid,e.stanzaId,e.ts,{verifiedName:r.verifiedName,isVerifiedHigh:r.verifiedLevel===u.default.VERIFIED_LEVEL.HIGH,isBusiness:r.isBusiness,isEnterprise:r.isEnterprise,actualActors:r.actualActors,hostStorage:r.hostStorage},{verifiedName:e.verifiedName,isVerifiedHigh:"high"===e.level,isBusiness:!0,isEnterprise:e.isApi,actualActors:e.actualActors,hostStorage:e.hostStorage})),t.push(function(e,t,r,a,n,i,s){var o=l.default.get(e);return null!=o&&(0,h.updateContactBusinessProperties)([{id:e,name:r,level:t,isApi:a,actualActors:n,hostStorage:i,privacyModeTs:s}],[o]),Promise.resolve()}(e.wid,e.level,e.verifiedName,e.isApi,e.actualActors,e.hostStorage,e.privacyModeTs)),Promise.all(t).then((()=>{}))}))}var S=new f.default("verifiedNameParser",(e=>(0,m.default)(e.child("verified_name"))));function T(e){var t=(0,s.wap)("iq",{to:s.S_WHATSAPP_NET,type:"get",xmlns:"w:biz",id:(0,s.generateId)()},(0,s.wap)("verified_name",{jid:(0,g.DEVICE_JID)(e)}));return(0,o.sendIq)(t,S).then((e=>{if(!e.success){if(404===e.errorCode)return void __LOG__(3)(v());throw new Error("Could not send IQ in retrieveBusinessDetails")}return e.result}))}function b(){return(b=(0,n.default)((function*(e){if("verified_name_hash"!==e.type)throw Error("Invalid notification type");var t=l.default.resolveWidsFromHash(e.hash);if(!t)return!1;var r=yield Promise.all(t.map((e=>T(e).then((t=>({wid:e,verifiedName:t}))))));return r.length&&(yield Promise.all(r.map((({wid:t,verifiedName:r})=>{if(r){var{name:a,level:n,serial:i,isApi:s,hostStorage:o,actualActors:u,privacyModeTs:l}=r;return y({wid:t,verifiedName:a,level:n,stanzaId:e.stanzaId,ts:e.ts,serial:i,isApi:s,hostStorage:o,actualActors:u,privacyModeTs:l})}if(void 0===r)return(0,c.handleBusinessRemoval)(t,e.stanzaId,e.ts)})))),!0}))).apply(this,arguments)}function A(){return(A=(0,n.default)((function*({jid:e,stanzaId:t,ts:r,verifiedName:a}){var n,{serial:i="",level:s,isApi:o,hostStorage:u,actualActors:d,privacyModeTs:c}=a,f=a.name;if(!f)if(null!=(null===(n=l.default.get(e))||void 0===n?void 0:n.verifiedName)){var p;f=(null===(p=l.default.get(e))||void 0===p?void 0:p.verifiedName)||""}else{var h=yield T(e);if(!h)return;f=h.name}return y({verifiedName:f,level:s,stanzaId:t,ts:r,wid:e,serial:i,isApi:o,hostStorage:u,actualActors:d,privacyModeTs:c})}))).apply(this,arguments)}},26135:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.handleBusinessNotification=function(e){__LOG__(2)(_(),e);var t=m.parse(e);if(t.error)return __LOG__(4,void 0,new Error)(h(),t.error.toString(),e.toString()),Promise.reject(t.error);var r=t.success;switch(r.type){case"verified_name_hash":return(0,u.handleVerifiedBusinessNameNotificationHash)(r).then((e=>g(r.stanzaId,r.from,!e)));case"verified_name_jid":return(0,u.handleVerifiedBusinessNameNotificationContact)(r).then((()=>g(r.stanzaId,r.from,!1)));case"remove_hash":return(0,d.handleBusinessRemovalNotificationHash)(r).then((e=>g(r.stanzaId,r.from,!e)));case"remove_jid":return(0,d.handleBusinessRemovalNotificationContact)(r).then((()=>g(r.stanzaId,r.from,!1)));case"profile":return(0,l.handleBusinessProfile)(r),Promise.resolve(g(r.stanzaId,r.from,!1));case"profile_hash":return(0,l.handleBusinessProfileHash)(r).then((e=>g(r.stanzaId,r.from,!e)));default:return Promise.resolve(g(r.stanzaId,r.from,!1))}};var n=a(r(19976)),i=a(r(70417)),s=r(30691),o=a(r(9492)),u=r(71290),l=r(45609),d=r(31555),c=a(r(23767)),f=a(r(8318)),p=r(95778);function h(){var e=(0,n.default)([""," parsing ",""]);return h=function(){return e},e}function _(){var e=(0,n.default)(["business notification received, node: ",""]);return _=function(){return e},e}var m=new c.default("businessNotificationParser",(e=>{e.assertTag("notification");var t,r={stanzaId:e.attrString("id"),from:e.attrChatWid("from"),ts:e.attrTime("t")};if(e.hasChild("remove"))return(t=e.child("remove")).hasAttr("jid")?(0,i.default)({type:"remove_jid",jid:t.attrChatWid("jid")},r):(0,i.default)({type:"remove_hash",hash:t.attrString("hash")},r);if(e.hasChild("verified_name"))return(t=e.child("verified_name")).hasAttr("jid")?(0,i.default)({type:"verified_name_jid",jid:t.attrChatWid("jid"),verifiedName:(0,f.default)(t)},r):(0,i.default)({type:"verified_name_hash",hash:t.attrString("hash")},r);if(e.hasChild("profile")){var a=e.child("profile"),n=a.maybeAttrString("hash");if(n)return(0,i.default)({type:"profile_hash",hash:n},r);var s=(0,o.default)(a);return(0,i.default)({type:"profile",profile:s},r)}return e.throw("Expected child type to be one of: remove | verified_name | profile")}));function g(e,t,r){return r?(0,s.wap)("ack",{id:(0,s.CUSTOM_STRING)(e),to:(0,p.JID)(t),class:"notification",type:"business"},(0,s.wap)("user",{side_list:"out"})):(0,s.wap)("ack",{id:(0,s.CUSTOM_STRING)(e),to:(0,p.JID)(t),class:"notification",type:"business"})}},45609:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.handleBusinessProfileHash=t.handleBusinessProfile=void 0;var n=a(r(52954)),i=a(r(89216)),s=r(80814),o=a(r(7470));t.handleBusinessProfile=({from:e,profile:t})=>{var r=Boolean(i.default.getValid(e)),a=(0,s.parseBusinessProfile)({id:e,profile:t,queryCatalog:!1}),n=i.default.gaddUp(a);r||(n.stale=!0)};var u=function(){var e=(0,n.default)((function*({from:e,hash:t}){var r=o.default.resolveWidsFromHash(t);return!!r&&(yield Promise.all(r.map(function(){var t=(0,n.default)((function*(t){var r=Boolean(i.default.getValid(e)),a=yield i.default.update(t),n=Array.isArray(a)?a:[a];for(var s of n)r||(s.stale=!0)}));return function(){return t.apply(this,arguments)}}())),!0)}));return function(){return e.apply(this,arguments)}}();t.handleBusinessProfileHash=u},31555:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.handleBusinessRemoval=c,t.handleBusinessRemovalNotificationHash=function(){return f.apply(this,arguments)},t.handleBusinessRemovalNotificationContact=function(){return p.apply(this,arguments)};var n=a(r(52954)),i=a(r(7470)),s=r(39778),o=a(r(77865)),u=r(77993);function l(e,t){return e.get(t.user).then((r=>r?(r.isBusiness=!1,r.verifiedLevel=0,r.verifiedName="",e.merge(t.user,r)):Promise.resolve()))}function d(e,t){return e.remove(t.user)}function c(e,t,r){return(0,u.getStorage)().lock(["contact","verified-business-name"],(([t,r])=>Promise.all([l(t,e),d(r,e)]))).then((()=>{var a=i.default.get(e);null!=a&&a.set({isBusiness:!1,verifiedLevel:null,verifiedName:null});var n=function(e,t,r){return{type:"notification_template",self:"in",subtype:"biz_move_to_consumer_app",t:r,recipients:[],from:e,id:new o.default({remote:e,fromMe:!1,id:t})}}(e,t,r);return(0,s.handleSingleMsgMD)(e,n)})).then((()=>{}))}function f(){return(f=(0,n.default)((function*(e){if("remove_hash"!==e.type)throw Error("Invalid notification type");var t=i.default.resolveWidsFromHash(e.hash);return!!t&&(yield Promise.all(t.map((t=>c(t,e.stanzaId,e.ts)))),!0)}))).apply(this,arguments)}function p(){return(p=(0,n.default)((function*(e){if("remove_jid"!==e.type)throw Error("Invalid notification type");yield c(e.jid,e.stanzaId,e.ts)}))).apply(this,arguments)}},10078:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=o.parse(e);if(t.error)return __LOG__(4,void 0,new Error)(s(),t.error.toString(),e.toString()),Promise.reject(t.error);return(0,i.default)(t.success)};var n=a(r(19976)),i=a(r(53603));function s(){var e=(0,n.default)([""," parsing ",""]);return s=function(){return e},e}var o=new(a(r(23767)).default)("incomingChatStateParser",(e=>{var t;if(e.assertTag("chatstate"),e.hasChild("paused"))t="paused";else{if(!e.hasChild("composing"))return e.throw("Expected child of type paused or composing");t=e.child("composing").hasAttr("media")?"recording":"composing"}return{id:e.attrChatWid("from"),type:t,participant:e.hasAttr("participant")?e.attrUserWid("participant"):void 0}}))},47437:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return R.apply(this,arguments)};var n=a(r(52954)),i=a(r(19976)),s=a(r(70417)),o=r(30691),u=a(r(43334)),l=r(95595),d=r(39778),c=a(r(77865)),f=a(r(61941)),p=a(r(23767)),h=a(r(99098)),_=r(27886),m=r(95303),g=a(r(49213)),v=r(96911),E=a(r(76019)),y=r(75637),S=r(35855);function T(){var e=(0,i.default)(["handleContactsNotification: unhandled notification of type ",""]);return T=function(){return e},e}function b(){var e=(0,i.default)(["handleContactsNotification: an update command does not include jid"]);return b=function(){return e},e}function A(){var e=(0,i.default)([""," parsing ",""]);return A=function(){return e},e}function C(){var e=(0,i.default)(["notification.oldJid is null"]);return C=function(){return e},e}function P(){var e=(0,i.default)(['Unexpected "contacts" notification']);return P=function(){return e},e}var O=new p.default("incomingContactsNotification",(e=>{e.assertTag("notification");var t=e.attrString("id"),r={from:e.attrString("from"),ts:e.attrTime("t"),rawTs:e.attrString("t"),stanzaId:t};if(e.hasChild("update")){var a=e.child("update");return a.hasAttr("jid")?(0,s.default)({type:"update",jid:a.attrUserWid("jid")},r):(0,s.default)({type:"empty",jid:null},r)}if(e.hasChild("add")){var n=e.child("add");return(0,s.default)({type:"add",hash:n.hasContent()?n.contentBytes():null,jid:null},r)}if(e.hasChild("remove")){var i=e.child("remove");return(0,s.default)({type:"remove",jid:i.attrUserWid("jid")},r)}if(e.hasChild("modify")){var o=e.child("modify");return(0,s.default)({type:"modify",jid:o.attrUserWid("new"),oldJid:o.attrUserWid("old")},r)}if(e.hasChild("sync")){var u=e.child("sync");return(0,s.default)({type:"sync",after:u.attrTime("after"),jid:null},r)}return __LOG__(3)(P()),(0,s.default)({type:"empty",jid:null},r)}));function w(e,t){var r=function(e,t){if("modify"!==t.type)throw new Error("Error: genContactChangeNotificationMsg invalid type");var r=(0,l.getMeUser)(),a=(0,f.default)(t.oldJid,"notification.oldJid"),n=(0,f.default)(t.jid,"notification.jid");return{id:new c.default({remote:e,fromMe:!1,id:(0,g.default)()}),from:e,subtype:"change_number",t:t.ts,to:r,type:"notification_template",templateParams:[a,n]}}(e,t);return(0,d.handleSingleMsgMD)(e,r)}function M(){return I.apply(this,arguments)}function I(){return(I=(0,n.default)((function*(e){if(e.oldJid){var t=e.oldJid,r=e.jid,a=[];u.default.get(t)&&a.push({id:t.toString(),changeNumberNewJid:r.toString(),changeNumberOldJid:void 0}),u.default.get(r)&&a.push({id:r.toString(),changeNumberNewJid:void 0,changeNumberOldJid:t.toString()}),(0,S.getTable)().bulkCreateOrMerge(a).then((()=>{a.forEach((e=>{var t=u.default.get(e.id);t&&(t.changeNumberNewJid=e.changeNumberNewJid?(0,y.createWid)(e.changeNumberNewJid):void 0,t.changeNumberOldJid=e.changeNumberOldJid?(0,y.createWid)(e.changeNumberOldJid):void 0)}))})),yield Promise.all([w(t,e),w(r,e)])}else __LOG__(2)(C());return Promise.resolve()}))).apply(this,arguments)}function R(){return(R=(0,n.default)((function*(e){var t=O.parse(e);if(t.error)return __LOG__(4,void 0,new Error)(A(),t.error.toString(),e.toString()),Promise.reject(t.error);var r=t.success,a=r.jid;switch(r.type){case"update":if(!a)return __LOG__(3)(b()),l(r);var n=h.default.get(a);n&&n.reset();var i=Promise.resolve(),s=E.default.get(a);s&&(s.set({status:""}),i=(0,v.getStatus)(a).then((e=>{s.set({status:e.status})})));var u=(0,m.changeProfilePicThumb)(r.jid,_.PROFILE_PIC_COMMAND.REMOVE);return Promise.all([u,i]).then((()=>l(r)));case"modify":return yield M(r),l(r);case"sync":return l(r);default:return __LOG__(2)(T(),r.type),l(r)}function l(e,t){return(0,o.wap)("ack",{id:(0,o.CUSTOM_STRING)(e.stanzaId),to:(0,o.CUSTOM_STRING)(e.from),class:"notification",type:"contacts"},t)}}))).apply(this,arguments)}},56839:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return y.apply(this,arguments)},t.DEVICE_NOTIFICATION_TYPES=void 0;var n=a(r(52954)),i=a(r(19976)),s=r(30691),o=r(47882),u=r(34507),l=a(r(23767)),d=a(r(64786)),c=r(95778),f=r(75637);function p(){var e=(0,i.default)(["handleDevicesNotification - update error: ",""]);return p=function(){return e},e}function h(){var e=(0,i.default)(["handleDevicesNotification - remove error: ",""]);return h=function(){return e},e}function _(){var e=(0,i.default)(["handleDevicesNotification - add error: ",""]);return _=function(){return e},e}function m(){var e=(0,i.default)([""," parsing ",""]);return m=function(){return e},e}function g(){var e=(0,i.default)(['Unknown Devices Notification: Devices notification without "remove" and "add" nodes']);return g=function(){return e},e}var v={add:"add",remove:"remove",update:"update"};t.DEVICE_NOTIFICATION_TYPES=v;var E=new l.default("incomingDevicesNotification",(e=>{e.assertTag("notification"),e.assertTag("notification"),e.assertAttr("type","devices");var t,r,a,n=[];if(e.hasChild("remove"))r=v.remove,t=e.child("remove");else if(e.hasChild("add"))r=v.add,t=e.child("add");else{if(!e.hasChild("update"))throw __LOG__(3)(g()),new Error("Failed to parse devices notification");r=v.update,t=e.child("update")}if(r===v.add||r===v.remove){var i=t.maybeChild("key-index-list");if(!i)throw new Error("key index node is required to handle device add or remove notification");var s=i.attrTime("ts");if(r===v.remove&&!s)throw new Error("timestamp is required to handle device remove notification");a={ts:s,signedKeyIndexBytes:r===v.add?i.contentBytes():null};var o=t.maybeChild("device"),u=null==o?void 0:o.attrWid("jid").device;if(!o||null==u)throw new Error("device node or device id is null");n=[{id:u,keyIndex:o.hasAttr("key-index")?o.attrInt("key-index"):null}]}return{type:r,stanzaId:e.attrString("id"),hash:t.attrString(r===v.update?"hash":"device_hash"),user:e.attrUserWid("from"),deviceList:n,keyIndex:a}}));function y(){return(y=(0,n.default)((function*(e){var t=E.parse(e);if(t.error)return __LOG__(4,void 0,new Error)(m(),t.error.toString(),e.toString()),Promise.reject(t.error);var r=t.success,a=r.user,n=(0,s.wap)("ack",{to:(0,c.USER_JID)(r.user),id:(0,s.CUSTOM_STRING)(r.stanzaId),class:"notification"}),i={wid:a,devices:{deviceList:r.deviceList,keyIndex:r.keyIndex},type:r.type};if(r.type===v.add){try{yield(0,u.handleADVDeviceUpdate)(i)}catch(e){__LOG__(3)(_(),e)}return n}if(r.type===v.remove){try{var l;yield(0,u.handleADVDeviceUpdate)(i);var g=(null===(l=r.deviceList)||void 0===l?void 0:l.map((e=>e.id)))||[];yield Promise.all(g.map((e=>{var t=(0,f.createDeviceWidFromUserAndDevice)(a.user,e);d.default.notifyDeviceIdentityChangedOrDeleted(t,!0)})))}catch(e){__LOG__(3)(h(),e)}return n}try{yield(0,o.syncDeviceList)([a],"notification",r.hash)}catch(e){__LOG__(3)(p(),e)}return n}))).apply(this,arguments)}},70505:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=u.parse(e);if(t.error)return __LOG__(4,void 0,new Error)(o(),t.error.toString(),e.toString()),Promise.reject(t.error);var r=t.success,a=(0,i.wap)("ack",{to:i.S_WHATSAPP_NET,id:(0,i.CUSTOM_STRING)(r.stanzaId),class:"notification"});return(0,s.digestKey)().then((()=>a))};var n=a(r(19976)),i=r(30691),s=r(99883);function o(){var e=(0,n.default)([""," parsing ",""]);return o=function(){return e},e}var u=new(a(r(23767)).default)("digestKeyParser",(e=>(e.assertTag("notification"),e.assertAttr("type","encrypt"),e.assertFromServer(),e.child("digest").assertTag("digest"),{stanzaId:e.attrString("id")})))},28565:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return v.apply(this,arguments)};var n=a(r(19976)),i=a(r(52954)),s=a(r(79711)),o=a(r(50935)),u=a(r(23767)),l=r(7355),d=a(r(78135)),c=a(r(12767));function f(){var e=(0,n.default)(["failure reason "," not implemented yet"]);return f=function(){return e},e}function p(){var e=(0,n.default)(["handleFailure: got failure code ",""]);return p=function(){return e},e}function h(){var e=(0,n.default)(["Incorrect temporary ban data "," ",""]);return h=function(){return e},e}function _(){var e=(0,n.default)(["received failure stanza, reason: ",", logging out"]);return _=function(){return e},e}function m(){var e=(0,n.default)([""," parsing ",""]);return m=function(){return e},e}var g=new u.default("failureParser",(e=>(e.assertTag("failure"),{reason:e.attrInt("reason",400,599),location:e.attrString("location"),code:e.hasAttr("code")?e.attrInt("code"):null,expire:e.hasAttr("expire")?e.attrInt("expire"):null})));function v(){return(v=(0,i.default)((function*(e){var t=g.parse(e);if(t.error)return __LOG__(4,void 0,new Error)(m(),t.error.toString(),e.toString()),Promise.reject(t.error);switch(t.success.reason){case 401:case 403:case 406:__LOG__(2)(_(),t.success.reason),yield c.default.clearCredentialsAndStoredData(),s.default.logout();break;case 405:case 409:var r=o.default.VERSION_STR.replace(/\.[di]$/,"");"web"===l.PLATFORMS[o.default.WAM_PLATFORM]?d.default.update(r,!1,0):d.default.update(void 0,!1,0,!1);break;case 402:var{code:a,expire:n}=t.success;if(null==a||null==n)throw __LOG__(4,void 0,new Error)(h(),a,n),new Error("handleFailure: wrong temp ban data");s.default.onTemporaryBan({banned:!0,code:a,expire:n});break;case 400:case 500:case 501:__LOG__(3)(p(),t.success.reason);break;default:return __LOG__(3)(f(),t.success.reason),Promise.reject("failure reason ".concat(t.success.reason," not implemented yet"))}}))).apply(this,arguments)}},8132:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.doesGroupExistInStorage=P,t.default=function(e){var t=C.parse(e);if(t.error)return __LOG__(4,void 0,new Error)(b(),t.error.toString(),e.toString()),Promise.reject(t.error);var r=t.success,{chatId:a,author:n,ts:i,pushname:u,externalId:l,actions:d,offline:c}=r,p=!!c&&!y.default.getOfflineSessionComplete(),h=(0,s.default)({chatId:a,author:n,ts:i,externalId:l},u?{pushname:u}:null);return(0,f.onMsgProcessingThread)(a.toString(),p,(()=>Promise.all(d.map((e=>function(){return w.apply(this,arguments)}(h,e,p)))).then((()=>(0,o.wap)("ack",{to:(0,g.GROUP_JID)(r.chatId),id:(0,o.CUSTOM_STRING)(r.externalId),class:"notification",participant:n?(0,g.JID)(n):o.DROP_ATTR})))))};var n=a(r(19976)),i=a(r(52954)),s=a(r(70417)),o=r(30691),u=r(95595),l=r(54978),d=r(70185),c=r(69007),f=r(92807),p=a(r(67294)),h=r(39778),_=a(r(23767)),m=r(51890),g=r(95778),v=r(96056),E=r(35855),y=a(r(82486));function S(){var e=(0,n.default)(["handleGroupNotification: failed with ",""]);return S=function(){return e},e}function T(){var e=(0,n.default)(["handle action ",""]);return T=function(){return e},e}function b(){var e=(0,n.default)([""," parsing ",""]);return b=function(){return e},e}var A=Object.freeze({REMOVE:"remove",ADD:"add",DEMOTE:"demote",PROMOTE:"promote",MODIFY:"modify",CREATE:"create",SUBJECT:"subject",DESC:"description",LOCKED:"locked",UNLOCKED:"unlocked",ANNOUNCE:"announcement",NOT_ANNOUNCE:"not_announcement",NO_FREQUENTLY_FORWARDED:"no_frequently_forwarded",FREQUENTLY_FORWARDED_OK:"frequently_forwarded_ok",INVITE:"invite",EPHEMERAL:"ephemeral",NOT_EPHEMERAL:"not_ephemeral"});var C=new _.default("groupNotificationParser",(e=>{e.assertTag("notification"),e.hasAttr("to")&&e.assertAttrIsMe("to");var t=e.attrGroupWid("from"),r=e.hasAttr("participant")?e.attrUserWid("participant"):null,a=e.attrTime("t");function n(e){return{participants:e.mapChildrenWithTag("participant",(e=>e.attrUserWid("jid"))),prevVersion:e.hasAttr("prev_v_id")?e.attrInt("prev_v_id"):void 0,version:e.hasAttr("v_id")?e.attrInt("v_id"):void 0}}var i=e.mapChildren((e=>{var t=e.tag();switch(t){case A.CREATE:return function(e){var t=e.child("group"),r=t.mapChildrenWithTag("participant",(e=>{var t=e.attrEnumOrDefault("type",m.GROUP_PARTICIPANT_TYPES,"participant");return{id:e.attrUserWid("jid"),isSuperAdmin:t===m.GROUP_PARTICIPANT_TYPES.superadmin,isAdmin:t===m.GROUP_PARTICIPANT_TYPES.admin||t===m.GROUP_PARTICIPANT_TYPES.superadmin}})),a=function(e){if(e.hasChild("description")){var t=e.child("description");if(t.hasChild("body")){var r=t.child("body");if(r.hasContent())return{content:r.contentString(),id:t.attrString("id")}}}return null}(t),n=function(e){if(e.hasChild("ephemeral")){var t=e.child("ephemeral");if(t.hasAttr("expiration"))return{ephemeralDuration:t.attrInt("expiration")}}return null}(t),i={subject:t.attrString("subject"),restrict:t.hasChild("locked"),announce:t.hasChild("announcement"),noFrequentlyForwarded:t.hasChild("no_frequently_forwarded"),ephemeralDuration:n?n.ephemeralDuration:void 0,owner:t.hasAttr("creator")?t.attrUserWid("creator"):void 0,creation:t.attrTime("creation"),participants:r,desc:a?a.content:void 0,descId:a?a.id:void 0,subjectOwner:t.hasAttr("s_o")?t.attrUserWid("s_o"):void 0,subjectTime:t.hasAttr("s_t")?t.attrTime("s_t"):void 0,support:t.hasChild("support"),pvId:t.attrInt("p_v_id")};return{action:A.CREATE,isInvite:e.hasAttr("reason")&&"invite"===e.attrString("reason"),groupInfo:i}}(e);case A.ADD:return(0,s.default)((0,s.default)({action:d.GROUP_ACTIONS.ADD},n(e)),{},{isInvite:e.hasAttr("reason")&&"invite"===e.attrString("reason")});case A.REMOVE:return(0,s.default)({action:A.REMOVE},n(e));case A.PROMOTE:return(0,s.default)({action:A.PROMOTE},n(e));case A.DEMOTE:return(0,s.default)({action:A.DEMOTE},n(e));case A.MODIFY:return(0,s.default)({action:d.GROUP_ACTIONS.MODIFY},n(e));case A.SUBJECT:return{action:d.GROUP_ACTIONS.SUBJECT,subject:e.attrString("subject"),s_o:e.hasAttr("s_o")?e.attrUserWid("s_o"):null,s_t:e.hasAttr("s_t")?e.attrTime("s_t"):null};case A.DESC:return e.hasChild("delete")?{action:d.GROUP_ACTIONS.DESC_REMOVE,descId:e.attrString("id")}:{action:d.GROUP_ACTIONS.DESC_ADD,descId:e.attrString("id"),desc:e.hasChild("body")?e.child("body").contentString():null,descTime:a};case A.LOCKED:return{action:d.GROUP_ACTIONS.RESTRICT,value:!0};case A.UNLOCKED:return{action:d.GROUP_ACTIONS.RESTRICT,value:!1};case A.ANNOUNCE:return{action:d.GROUP_ACTIONS.ANNOUNCE,value:!0};case A.NOT_ANNOUNCE:return{action:d.GROUP_ACTIONS.ANNOUNCE,value:!1};case A.NO_FREQUENTLY_FORWARDED:return{action:d.GROUP_ACTIONS.NO_FORWARD,value:!0};case A.FREQUENTLY_FORWARDED_OK:return{action:d.GROUP_ACTIONS.NO_FORWARD,value:!1};case A.INVITE:return{action:d.GROUP_ACTIONS.INVITE_CODE,code:e.attrString("code")};case A.EPHEMERAL:return{action:d.GROUP_ACTIONS.EPHEMERAL,duration:e.attrInt("expiration")};case A.NOT_EPHEMERAL:return{action:d.GROUP_ACTIONS.EPHEMERAL,duration:0};default:throw new Error("Unrecognized group action ".concat(t))}}));return{externalId:e.attrString("id"),chatId:t,author:r,ts:e.attrTime("t"),pushname:e.hasAttr("notify")?e.attrString("notify"):null,offline:e.hasAttr("offline")?e.attrString("offline"):null,actions:i}}));function P(){return O.apply(this,arguments)}function O(){return(O=(0,i.default)((function*(e){var[t,r]=yield Promise.all([(0,v.getTable)().get(e.toString()),(0,E.getTable)().get(e.toString())]);return!!t||!!r&&!!r.t}))).apply(this,arguments)}function w(){return(w=(0,i.default)((function*(e,t,r=!1){if(t){__LOG__(2)(T(),t.action);var a=[];try{if(t.action===A.CREATE){var n=(0,s.default)((0,s.default)({},t.groupInfo),{},{id:e.chatId}),i=yield P(n.id);yield(0,c.handleGroupCreation)(e,n),i||a.push((0,l.genGroupCreationMsg)(e,n));var o=(0,u.getMaybeMeUser)();if(!o.equals(e.author)){var f={action:d.GROUP_ACTIONS.ADD,version:n.pvId,participants:[o],isInvite:t.isInvite};yield(0,c.handleGroupActionMD)(e,f),a.push((0,l.genGroupNotificationMsg)(e,f));var{ephemeralDuration:_}=n;e.author&&null!=e.ts&&null!=_&&_>0&&a.push((0,l.genGroupEphemeralSettingMsg)(e.chatId,e.ts,e.author,_))}}else yield(0,c.handleGroupActionMD)(e,t),a.push((0,l.genGroupNotificationMsg)(e,t));r?p.default.addOfflineMessage(a.map((e=>({msg:e})))):yield Promise.all(a.map((e=>(0,h.handleSingleMsgMD)(e.from,e))))}catch(e){__LOG__(3)(S(),e)}}}))).apply(this,arguments)}},31908:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return j.apply(this,arguments)},t.handleHistorySyncChunk=W;var i=n(r(70417)),s=n(r(19976)),o=n(r(52954)),u=r(84139),l=r(44880),d=r(46378),c=r(35228),f=r(71684),p=n(r(12489)),h=n(r(57529)),_=a(r(29891)),m=r(35855),g=n(r(79626)),v=n(r(79711)),E=r(41714),y=n(r(50935)),S=r(57385),T=n(r(1616)),b=r(95595),A=r(11824),C=r(52718),P=r(421),O=r(65291),w=r(39778),M=n(r(77865)),I=r(39174),R=n(r(61941)),D=r(85861),N=r(31739),L=n(r(76022)),k=r(75637),U=r(11008),F=n(r(7470)),G=n(r(40210)),x=r(46774);function B(){var e=(0,s.default)(["history_sync_notification_handler: invalid wid"]);return B=function(){return e},e}function Y(){var e=(0,s.default)(["history sync download failed"]);return Y=function(){return e},e}function K(){var e=(0,s.default)(["[history sync] parseWebMessageInfo failed with error "," and stack ",""]);return K=function(){return e},e}function j(){return(j=(0,o.default)((function*(e,t,r){if(e){var{downloadOptions:a}=e;if(a){var n=!!e.historySyncNotification.originalMessageId,s=n?e.historySyncNotification.originalMessageId:r,o={msgKey:new M.default({remote:t,fromMe:!0,id:s}).toString(),processed:0,downloadOptions:a,isReupload:1,historySyncStepStartedTs:(0,f.unixTimeMs)(),reuploadPending:!1,historySyncPayloadSize:e.historySyncNotification.fileLength};n||(o.syncType=e.historySyncNotification.syncType,o.chunkOrder=e.historySyncNotification.chunkOrder||0,o.isReupload=0);var u=o;switch(u.syncType){case P.HistorySyncHistorySyncType.INITIAL_BOOTSTRAP:case P.HistorySyncHistorySyncType.INITIAL_STATUS_V3:W(u);break;case P.HistorySyncHistorySyncType.PUSH_NAME:return yield(0,C.enqueueNotification)((0,i.default)((0,i.default)({},u),{},{downloadOptions:(0,i.default)({},u.downloadOptions)}),!0),void W(u);default:yield(0,C.enqueueNotification)(u)}h.default.continueProgressiveHistorySyncProcessing()}}}))).apply(this,arguments)}function W(){return V.apply(this,arguments)}function V(){return(V=(0,o.default)((function*(e){var t=e.syncType===P.HistorySyncHistorySyncType.INITIAL_BOOTSTRAP?G.default.MD_BOOTSTRAP_PAYLOAD_TYPE.CRITICAL:G.default.MD_BOOTSTRAP_PAYLOAD_TYPE.NON_CRITICAL,r=new G.default.MdBootstrapHistoryDataDownloaded({mdBootstrapPayloadType:t,mdBootstrapPayloadSize:e.historySyncPayloadSize});r.mdSessionId=yield _.default.getMdSessionId();var a=yield _.default.getStorageEstimation();a.mdStorageQuotaBytes!==_.STORAGE_QUOTA_UNAVAILABLE&&(r.mdStorageQuotaUsedBytes=a.mdStorageQuotaUsedBytes,r.mdStorageQuotaBytes=a.mdStorageQuotaBytes);var n=null;try{n=yield T.default.downloadAndDecrypt((0,i.default)({signal:(new p.default).signal},e.downloadOptions))}catch(t){__LOG__(3)(Y());var s=M.default.fromString(e.msgKey),m=new Map;return m.set(s.remote,[s.id]),z(r,e.historySyncStepStartedTs,!1),(0,E.sendAggregateReceipts)(s.remote,E.RECEIPT_TYPE.SERVER_ERROR,Date.now().toString(),m,void 0,E.RECEIPT_MSG_TYPE.PEER),void(yield(0,C.markChunkForReuploadPending)(e.msgKey))}r.mdBootstrapStepResult=G.default.MD_BOOTSTRAP_STEP_RESULT.SUCCESS;var A=new d.Binary(n);yield new Promise((e=>setTimeout(e,0)));var L=yield(0,c.inflate)(A.readByteArray());yield new Promise((e=>setTimeout(e,0)));var K=(0,u.decodeProto)(P.HistorySyncSpec,L),j=new G.default.MdBootstrapDataApplied({mdBootstrapPayloadType:t,mdBootstrapSource:G.default.MD_BOOTSTRAP_SOURCE.HISTORY});if(j.mdSessionId=yield _.default.getMdSessionId(),e.syncType===P.HistorySyncHistorySyncType.INITIAL_STATUS_V3&&K.statusV3Messages&&K.statusV3Messages.length>0?(r.mdBootstrapMessagesCount=K.statusV3Messages.length,z(r,e.historySyncStepStartedTs,!0),yield Promise.all(K.statusV3Messages.map(function(){var e=(0,o.default)((function*(e){if("0@s.whatsapp.net"===e.participant)return Promise.resolve();var t={type:D.MESSAGE_TYPE.OTHER_STATUS,externalId:(0,R.default)(e.key.id,"msg.key.id"),ts:(0,f.castToUnixTime)(parseInt(e.messageTimestamp,10)),edit:-1,isHsm:!1,count:null,chat:(0,k.createWid)(y.default.STATUS_WID),author:!0===e.key.fromMe?(0,b.getMeUser)():(0,k.createWid)((0,R.default)(e.participant,"msg.participant")),pushname:null,isDirect:!1},r=yield(0,N.parseMessage)(t,"skmsg",(0,R.default)(e.message,"msg.message"),void 0),a=r.renderableMsgs&&r.renderableMsgs;if(!a||1!==a.length)return Promise.resolve();var n=a[0];return(0,w.handleSingleMsgMD)(n.id.remote,n,!1)}));return function(){return e.apply(this,arguments)}}())),j.mdTimestamp=(0,f.unixTimeMs)(),j.commit()):e.syncType!==P.HistorySyncHistorySyncType.PUSH_NAME&&(K.conversations=K.conversations.reduce(((e,t)=>{var r=null;try{r=(0,k.createWid)(t.id)}catch(e){__LOG__(3)(B())}return r?e.concat(t):e}),[])),e.syncType===P.HistorySyncHistorySyncType.INITIAL_BOOTSTRAP){var W={},V=(0,b.assertGetMe)(),q=(0,k.toUserWid)(V),Q=V.getDeviceId(),X={},Z=[],$=0;K.conversations.forEach((t=>{var r,a;$+=t.messages.length;var n=[];if(t.messages.forEach(((r,a)=>{a===t.messages.length-1&&(W[t.id]=r.msgOrderId),n.push(J(e,r.message))})),n=n.filter(Boolean).reverse(),!(0,k.createWid)(t.id).isStatusV3()){var i=(0,S.genDeviceNotificationMsg)((0,k.createWid)(t.id),q,[Q],[]);n.push(i)}var s={t:(0,l.maybeNumberOrThrowIfTooLarge)(null!==(r=t.conversationTimestamp)&&void 0!==r?r:t.lastMsgTimestamp),id:(0,k.createWid)(t.id),unreadCount:t.unreadCount,ephemeralDuration:t.ephemeralExpiration,ephemeralSettingTimestamp:t.ephemeralSettingTimestamp,endOfHistoryTransferType:null!==(a=t.endOfHistoryTransferType)&&void 0!==a?a:x.ConversationEndOfHistoryTransferModelPropType.INCOMPLETE,name:t.name,notSpam:t.notSpam};Z.push(s),X[t.id]={chatInfo:s,msgs:n}})),r.mdBootstrapMessagesCount=$,r.mdBootstrapChatsCount=K.conversations.length,z(r,e.historySyncStepStartedTs,!0),h.default.markInitialHistorySyncCountDebugStats($,Z.length),yield(0,g.default)([{cmd:"preempt",response:Z,binarySize:10}])||Promise.resolve(),yield(0,w.handleInitialSyncMsgs)(X),j.mdTimestamp=(0,f.unixTimeMs)(),j.commit(),(0,O.setHistoryInitialSyncBoundry)(W)}else if(e.syncType===P.HistorySyncHistorySyncType.PUSH_NAME){z(r,e.historySyncStepStartedTs,!0);var ee=K.pushnames.map((e=>({id:e.id||"",pushname:e.pushname||""})));yield(0,U.getContactTable)().bulkCreateOrMerge(ee);var te=K.pushnames.map((e=>{var t=(0,k.createWid)(e.id||""),r=F.default.get(t);return{id:t,pushname:e.pushname||"",type:(null==r?void 0:r.type)||"out",name:null==r?void 0:r.name}}));F.default.add(te,{merge:!0}),j.mdTimestamp=(0,f.unixTimeMs)(),j.commit()}else if(e.syncType!==P.HistorySyncHistorySyncType.INITIAL_STATUS_V3){yield new Promise((e=>setTimeout(e,0)));var re=[],ae=new Set,ne=(0,O.getHistoryInitialSyncBoundry)(),ie=0;K.conversations.forEach((t=>{ie+=t.messages.length;var r=ne&&ne[t.id];t.messages.forEach((a=>{var n=(0,l.maybeNumberOrThrowIfTooLarge)(a.msgOrderId);if(!(null!=r&&null!=n&&n>=r)){ae.add(t.id);var i=J(e,a.message);i&&re.push(i)}}))})),r.mdBootstrapMessagesCount=ie,r.mdBootstrapChatsCount=K.conversations.length,z(r,e.historySyncStepStartedTs,!0),0!==re.length&&(yield(0,w.handleProgressiveHistorySyncMsgs)(re,Array.from(ae))),K.conversations.forEach((e=>{var t=e.endOfHistoryTransferType;if(null!=t)return H((0,k.createWid)(e.id),t)})),j.mdTimestamp=(0,f.unixTimeMs)(),j.commit()}var se,oe=M.default.fromString(e.msgKey),ue=new Map;ue.set(oe.remote,[oe.id]),(0,E.sendAggregateReceipts)(oe.remote,E.RECEIPT_TYPE.HISTORY_SYNC_COMPLETION,void 0,ue),yield(0,C.updateCurrentlyProcessed)(e.msgKey),se=K.progress,e.syncType===P.HistorySyncHistorySyncType.INITIAL_BOOTSTRAP?((0,I.setInitialHistorySyncComplete)(),(0,I.setHistorySyncStatus)({initialCompleted:!0}),v.default.onInitialChatHistorySynced()):e.syncType===P.HistorySyncHistorySyncType.RECENT&&100===se?((0,I.setHistorySyncStatus)({recentCompleted:!0}),v.default.onRecentChatHistorySynced()):e.syncType===P.HistorySyncHistorySyncType.FULL&&100===se&&((0,I.setHistorySyncStatus)({fullCompleted:!0}),v.default.onFullChatHistorySynced())}))).apply(this,arguments)}function H(){return q.apply(this,arguments)}function q(){return(q=(0,o.default)((function*(e,t){var r=t,a=(0,A.getBridge)();yield a.sendAndReceive("chat_collection","add",{things:[{id:e,endOfHistoryTransferType:r}],options:{merge:!0}}),yield(0,m.getTable)().merge(e.toString(),{endOfHistoryTransferType:r})}))).apply(this,arguments)}function z(e,t,r){e.mdTimestamp=(0,f.unixTimeMs)(),e.mdBootstrapStepDuration=(0,f.unixTimeMs)()-t,e.mdBootstrapStepResult=r?G.default.MD_BOOTSTRAP_STEP_RESULT.SUCCESS:G.default.MD_BOOTSTRAP_STEP_RESULT.FAILURE,e.commit()}function J(e,t){var r=null;try{r=L.default.parseWebMessageInfo(t,"after")}catch(e){__LOG__(4,void 0,new Error)(K(),null==e?void 0:e.name,null==e?void 0:e.stack)}return r}},39965:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.handleDirtyBits=function(e){var{supported:t,unsupported:r,protocols:a}=e;__LOG__(2)(p(),t.map((e=>e.type)).join(","),r.map((e=>e.type)).join(","));var n=[...r,...t];return Promise.all(t.map((e=>{var t=e.type;return t===h.groups?(0,l.queryAndUpdateAllGroupMetadata)():t===h.account_sync?function(e=[]){var t=e;t.length||(t=Object.keys(s.ACCOUNT_SYNC_TYPE).map((e=>s.ACCOUNT_SYNC_TYPE[e])));return Promise.all(t.map((e=>"devices"===e?(0,s.getDevices)("notification"):"picture"===e?(0,s.getAndUpdateProfilePicture)():void("privacy"===e?(0,s.updatePrivacySettings)():"blocklist"===e&&(0,s.updateBlocklist)()))))}(a):t===h.syncd_app_state?(f.default.once(f.APP_STATE_SYNC_COMPLETED,(e=>{var t=e.some((e=>null!=e.patches&&e.patches.length>0||null!=e.snapshot));new c.default.MdAppStateDirtyBits({dirtyBitsFalsePositive:!t}).commit()})),(0,d.markCollectionsForSync)([...u.CollectionName.members()])):void 0}))).then((()=>(0,o.clearDirtyBits)(n)))},t.SUPPORTED_DIRTY_PROTOCOLS=t.SUPPORTED_DIRTY_TYPE=void 0;var i=n(r(19976)),s=r(30868),o=r(85193),u=r(63487),l=r(27485),d=r(61392),c=n(r(40210)),f=a(r(79711));function p(){var e=(0,i.default)(["handleDirtyBits: handle dirty bits, supported: ",", unsupported: ",""]);return p=function(){return e},e}var h={groups:"groups",account_sync:"account_sync",syncd_app_state:"syncd_app_state"};t.SUPPORTED_DIRTY_TYPE=h;t.SUPPORTED_DIRTY_PROTOCOLS={devices:"devices",picture:"picture",privacy:"privacy",blocklist:"blocklist"}},67904:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.handleRoutingInfo=function(e){var t=e.domain;if(!t){var r=(0,s.getRoutingInfo)();t=r?r.domain:u.fb}var a=(0,i.bytesToBuffer)(e.edgeRouting);(0,s.setRoutingInfo)({domain:t,edgeRouting:a}),__LOG__(2)(o(),t)},t.DOMAINS=void 0;var n=a(r(19976)),i=r(8320),s=r(39174);function o(){var e=(0,n.default)(["handleInfoBulletin setting and domain: "," and edgeRouting:"]);return o=function(){return e},e}var u={fb:"fb",sl:"sl"};t.DOMAINS=u},77493:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=h.parse(e);if(t.error)return __LOG__(4,void 0,new Error)(p(),t.error.toString(),e.toString()),Promise.reject(t.error);var r=t.success;if(r){if(r.type===l.INFO_TYPE.DIRTY)return(0,s.handleDirtyBits)(r).then((()=>"NO_ACK"));if(r.type===l.INFO_TYPE.ROUTING)return(0,o.handleRoutingInfo)(r),Promise.resolve("NO_ACK");if(r.type===l.INFO_TYPE.DOWNGRADE)return i.default.downgradeWebclient(),Promise.resolve("NO_ACK");if(r.type===l.INFO_TYPE.OFFLINE)return u.default.setOfflineSessionComplete(r.count),(0,c.reportOfflineNotifications)(),Promise.resolve("NO_ACK");if(r.type===l.INFO_TYPE.OFFLINE_PREVIEW)return u.default.setOfflineMessagePreviewCounter(r.count),Promise.resolve("NO_ACK")}else __LOG__(3)(f());return Promise.resolve()};var n=a(r(19976)),i=a(r(79711)),s=r(39965),o=r(67904),u=a(r(82486)),l=r(52493),d=a(r(23767)),c=r(24914);function f(){var e=(0,n.default)(["handleInfoBulletin unrecognized info bulletin"]);return f=function(){return e},e}function p(){var e=(0,n.default)([""," parsing ",""]);return p=function(){return e},e}var h=new d.default("infoBulletinParser",(e=>{if(e.assertTag("ib"),e.assertFromServer(),e.hasChild(l.INFO_TYPE.DIRTY)){var t=[],r=[],a=[];return e.forEachChildWithTag(l.INFO_TYPE.DIRTY,(e=>{var n={type:e.attrString("type"),timestamp:e.attrInt("timestamp")};"account_sync"===n.type?(e.mapChildren((e=>e.tag())).forEach((e=>{s.SUPPORTED_DIRTY_PROTOCOLS.hasOwnProperty(e)&&a.push(e)})),r.push(n)):s.SUPPORTED_DIRTY_TYPE.hasOwnProperty(n.type)?r.push(n):t.push(n)})),{type:l.INFO_TYPE.DIRTY,supported:r,unsupported:t,protocols:a}}if(e.hasChild(l.INFO_TYPE.ROUTING)){var n=e.child(l.INFO_TYPE.ROUTING);return{type:l.INFO_TYPE.ROUTING,edgeRouting:n.child("routing_info").contentBytes(),domain:n.hasChild("dns_domain")?n.child("dns_domain").contentEnum(o.DOMAINS):null}}return e.hasChild(l.INFO_TYPE.DOWNGRADE)?{type:l.INFO_TYPE.DOWNGRADE}:e.hasChild(l.INFO_TYPE.OFFLINE)?{count:e.child(l.INFO_TYPE.OFFLINE).attrInt("count"),type:l.INFO_TYPE.OFFLINE}:e.hasChild(l.INFO_TYPE.OFFLINE_PREVIEW)?{count:{message:e.child(l.INFO_TYPE.OFFLINE_PREVIEW).attrInt("message"),receipt:e.child(l.INFO_TYPE.OFFLINE_PREVIEW).attrInt("receipt")},type:l.INFO_TYPE.OFFLINE_PREVIEW}:null}))},52493:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.INFO_TYPE=void 0;var r=Object.freeze({DIRTY:"dirty",DOWNGRADE:"downgrade_webclient",ROUTING:"edge_routing",OFFLINE:"offline",OFFLINE_PREVIEW:"offline_preview"});t.INFO_TYPE=r},33521:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return v.apply(this,arguments)};var n=a(r(19976)),i=a(r(52954)),s=r(30691),o=r(60339),u=r(95595),l=r(82087),d=r(4786),c=a(r(61941)),f=a(r(23767)),p=a(r(32724)),h=r(95778);function _(){var e=(0,n.default)(["handleMediaRetryNotification: mediaKey is not found for msgId ",""]);return _=function(){return e},e}function m(){var e=(0,n.default)([""," parsing ",""]);return m=function(){return e},e}var g=new f.default("mediaRetryNotification",(e=>{e.assertTag("notification");var t=e.maybeChild("error");if(t)return{msgId:e.attrString("id"),ciphertext:null,iv:null,errorCode:d.MediaRetryNotificationResultType.cast(t.attrInt("code"))};var r=e.child("encrypt");return{msgId:e.attrString("id"),ciphertext:r.child("enc_p").contentBytes(),iv:r.child("enc_iv").contentBytes(l.ENC_IV_SIZE),errorCode:null}}));function v(){return(v=(0,i.default)((function*(e){var t=g.parse(e);if(t.error)throw __LOG__(4,void 0,new Error)(m(),t.error.toString(),e.toString()),t.error;var{msgId:r,errorCode:a}=t.success,n=(0,s.wap)("ack",{id:(0,s.CUSTOM_STRING)(r),class:"notification",type:"mediaretry",to:(0,h.USER_JID)((0,u.getMeUser)())});if(null!=a)return p.default.resolveMediaReupload({msgId:r,result:a}),n;var{ciphertext:i,iv:d}=t.success,f=p.default.getMediaKey(r);if(!f)return __LOG__(3)(_(),r),n;var{stanzaId:v,directPath:E,result:y}=yield(0,l.decryptMediaRetryNotification)((0,o.decodeB64)(f),r,(0,c.default)(d,"iv"),(0,c.default)(i,"ciphertext"));if(v!==r)throw new Error("handleMediaRetryNotification: msg id does not match");return p.default.resolveMediaReupload({msgId:r,result:y,directPath:E}),n}))).apply(this,arguments)}},90272:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HsmMismatchError=t.CATEGORY_PEER=t.ACTUAL_ACTORS=t.HOST_STORAGE=t.VERIFIED_LEVEL=t.MSG_TYPES=void 0;var a=r(29351);t.MSG_TYPES={text:"text",media:"media"};t.VERIFIED_LEVEL={high:"high",low:"low",unknown:"unknown"};t.HOST_STORAGE={1:"on_premise",2:"facebook"};t.ACTUAL_ACTORS={1:"self",2:"bsp"};t.CATEGORY_PEER="peer";class n extends((0,a.customError)("HSMMismatchError")){}t.HsmMismatchError=n},39696:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.decryptE2EPayload=function(){return P.apply(this,arguments)};var i=n(r(19976)),s=n(r(52954)),o=r(12250),u=r(85804),l=r(90272),d=r(43053),c=r(20787),f=r(12425),p=r(31739),h=n(r(40210)),_=r(53183),m=a(r(32602)),g=r(96571),v=r(85861),E=n(r(50935));function y(){var e=(0,i.default)(["error: ",""]);return y=function(){return e},e}function S(){var e=(0,i.default)(["error: ",""]);return S=function(){return e},e}function T(){var e=(0,i.default)(["decryptSignalProto js counter error for msg ID ",": ",""]);return T=function(){return e},e}function b(){var e=(0,i.default)(["error: ",""]);return b=function(){return e},e}function A(){var e=(0,i.default)(["decryptE2EPayload: validateADVIdentity failed"]);return A=function(){return e},e}function C(e,t,r){var{e2eType:a,ciphertext:n}=e;switch(a){case g.CiphertextType.Skmsg:return t.isGroup()||t.isBroadcast()?r?m.Cipher.decryptGroupSignalProto(t,r,n):Promise.reject(new Error("parseMessage: receive msg of ".concat(t.toString()," without participant"))):Promise.reject(new Error("Can not do skmsg for non group ".concat(t.toString())));case g.CiphertextType.Pkmsg:case g.CiphertextType.Msg:var i=t.isUser()?t:r;return i?m.Cipher.decryptSignalProto(i,a,n):Promise.reject(new Error("parseMessage: receive msg of ".concat(t.toString()," without participant")))}}function P(){return(P=(0,s.default)((function*(e){var{bizInfo:t,msgInfo:r,paymentInfo:a,deviceIdentity:n,encs:i}=e;if(null!=r.author.device&&0!==r.author.device&&!(yield(0,o.validateADVwithEncs)(r.author,n,i)))return __LOG__(3)(A()),{result:v.E2EProcessResult.RETRY,retryCount:i[0].retryCount};return Promise.reduce(e.encs,((e,n)=>{if(e.result!==v.E2EProcessResult.SUCCESS)return e;var i=(0,p.getFrom)(r),o=new h.default.E2eMessageRecv({e2eCiphertextType:(0,u.metricsCiphertextType)(n.e2eType),e2eCiphertextVersion:u.CIPHERTEXT_VERSION,e2eDestination:(0,u.metricsDestinationType)(i),e2eSuccessful:!1,messageMediaType:n.mediaType?(0,u.metricsMediaType)(n.mediaType):h.default.MEDIA_TYPE.NONE,retryCount:n.retryCount});return C(n,i,r.author).then((e=>{o.e2eSuccessful=!0,o.weight=1e3,o.commit();var i={retryCount:n.retryCount,e2eType:n.e2eType,mediaType:n.mediaType};return(0,_.processDecryptedProto)(e,r,a,i,t).then((()=>({result:v.E2EProcessResult.SUCCESS})))})).catchTypes(c.SignalDecryptionError,d.UnknownMessageError,(e=>(__LOG__(4,void 0,new Error,!0)(b(),e.toString()),SEND_LOGS("handleMsg: decryption error"),o.weight=1,o.commit(),(0,_.processPlaceholderMsg)(r,v.PlaceholderType.E2E).then((()=>({result:v.E2EProcessResult.RETRY,retryCount:n.retryCount})))))).catchType(c.SignalMessageCounterError,function(){var e=(0,s.default)((function*(e){if(__LOG__(2)(T(),r.externalId,e),null!=r.offline){var t=yield(0,f.getMsgByMsgKey)((0,p.messageInfoToKey)(r));if(null==t&&(yield(0,_.processPlaceholderMsg)(r,v.PlaceholderType.E2E)),null==t||t.type===E.default.MSG_TYPE.CIPHERTEXT)return{result:v.E2EProcessResult.RETRY,retryCount:n.retryCount}}return{result:v.E2EProcessResult.SUCCESS}}));return function(){return e.apply(this,arguments)}}()).catchType(l.HsmMismatchError,(e=>(__LOG__(4,void 0,new Error,!0)(S(),e.toString()),SEND_LOGS("handleMsg: hsm mismatch error"),o.weight=1,o.commit(),{result:v.E2EProcessResult.HSM_MISMATCH}))).catch((e=>(__LOG__(4,void 0,new Error,!0)(y(),e),SEND_LOGS("handleMsg: parse decrypted message error"),o.weight=1,o.commit(),{result:v.E2EProcessResult.PARSE_ERROR})))}),{result:v.E2EProcessResult.SUCCESS})}))).apply(this,arguments)}},43053:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.UnknownMessageError=t.DeviceSentMessageError=void 0;var n=r(29351),i=a(r(40210));class s extends((0,n.customError)("DeviceSentMessageError")){constructor(e,t){t===i.default.DSM_ERROR.MISSING_DSM?super("parseMessage: message should be deviceSentMessage"):t===i.default.DSM_ERROR.INVALID_SENDER?super("parseMessage: message should not be deviceSentMessage"):t===i.default.DSM_ERROR.INVALID_DSM?super("parseMessage: invalid deviceSentMessage"):super("parseMessage: unknown deviceSentMessage error"),new i.default.MdBadDeviceSentMessage({peerType:e,dsmError:t}).commit(),this.peerType=e,this.dsmError=t}}t.DeviceSentMessageError=s;class o extends((0,n.customError)("UnknownMessageError")){}t.UnknownMessageError=o},65745:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=u.default.parse(e);if(t.error)return Promise.reject(new Error("".concat(t.error.toString()," parsing ").concat(e.toString())));var r=t.success,{msgMeta:a,msgInfo:f}=r;return null!=f.offline&&s.default.offlineStanzaReceivedAfterCompelete(),s.default.getOfflineSessionComplete()&&delete r.msgInfo.offline,(0,o.onMsgProcessingThread)(f.chat.toString(),!!r.msgInfo.offline,(0,n.default)((function*(){if(a.isUnavailable)return yield(0,l.processPlaceholderMsg)(f,d.PlaceholderType.FANOUT),(0,c.sendReceipt)(f,a,{result:d.E2EProcessResult.BACKFILL});if(null==f.offline){var e=yield(0,i.decryptE2EPayload)(r);return(0,c.sendReceipt)(f,a,e)}var t=yield s.default.decryptOfflineMessage(r);return t.result!==d.E2EProcessResult.SUCCESS?(0,c.sendReceipt)(f,a,t):void 0})))};var n=a(r(52954)),i=r(39696),s=a(r(82486)),o=r(92807),u=a(r(50705)),l=r(53183),d=r(85861),c=r(31739)},50705:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(70417)),i=r(90272),s=a(r(23767)),o=r(96571),u=r(85861),l=r(31739),d=r(75637);var c=new s.default("incomingMsgParser",(e=>{e.assertTag("message"),e.hasAttr("to")&&e.assertAttrIsMe("to");var t=e.mapChildrenWithTag("enc",(e=>({e2eType:e.attrFlowEnum("type",(e=>o.CiphertextType.cast(e))),mediaType:e.attrFlowEnumOrDefault("mediatype",(e=>o.MediaType.cast(e)),null),ciphertext:e.contentBytes(),retryCount:e.hasAttr("count")?e.attrInt("count"):0}))),r=e.maybeChild("device-identity"),a=r?r.contentBytes():null,s=function(e,t){var r,a={externalId:e.attrString("id"),ts:e.attrTime("t"),edit:e.hasAttr("edit")?e.attrInt("edit"):-1,isHsm:e.hasChild("hsm"),count:e.hasAttr("count")?e.attrInt("count"):null,pushname:e.hasAttr("notify")?e.attrString("notify"):null,category:e.hasAttr("category")?e.attrString("category"):null,offline:e.hasAttr("offline")?e.attrString("offline"):null},i=e.attrWid("from"),s=e.hasAttr("participant")?e.attrDeviceWid("participant"):null,c=e.hasAttr("recipient")?e.attrUserWid("recipient"):null,f=t.every((e=>e.e2eType!==o.CiphertextType.Skmsg)),p=t.some((e=>e.retryCount>0)),h={},_=e.maybeChild("participants");if(_){var m=[];_.forEachChildWithTag("to",(e=>{var t=e.attrUserWid("jid"),r=e.maybeAttrString("eph_setting");m.push(t),null!=r&&(h[t.toString()]=r)})),r=m}if(i.isUser())return null!=c?(0,l.isPeer)(i)?(0,n.default)((0,n.default)({type:u.MESSAGE_TYPE.CHAT},a),{},{chat:(0,d.toUserWid)(c),author:i}):e.throw("recipient on non peer chat message"):(0,n.default)((0,n.default)({type:u.MESSAGE_TYPE.CHAT},a),{},{chat:(0,d.toUserWid)(i),author:i});if(i.isGroup())return null==s?e.throw("group message with no participant"):(0,n.default)((0,n.default)({type:u.MESSAGE_TYPE.GROUP},a),{},{chat:i,author:s,isDirect:f});if(i.isBroadcast()&&!i.isStatusV3()){if(null==s)return e.throw("broadcast message with no participant");if((0,l.isPeer)(s)){if(null==r){if(!p)return e.throw("peer broadcast message with no participants node");r=[]}return(0,n.default)((0,n.default)({type:u.MESSAGE_TYPE.PEER_BROADCAST},a),{},{chat:i,author:s,isDirect:f,bclParticipants:r,bclHashValidated:!1,bclEphSettings:h})}return(0,n.default)((0,n.default)({type:u.MESSAGE_TYPE.OTHER_BROADCAST},a),{},{chat:i,author:s,isDirect:f,ephSetting:e.maybeAttrString("eph_setting")})}return i.isBroadcast()&&i.isStatusV3()?null==s?e.throw("status message with no participant"):(0,l.isPeer)(s)&&f?null==r?e.throw("peer status message with no participants node"):(0,n.default)((0,n.default)({type:u.MESSAGE_TYPE.DIRECT_PEER_STATUS},a),{},{chat:i,author:s,bclParticipants:r,bclHashValidated:!1}):(0,n.default)((0,n.default)({type:u.MESSAGE_TYPE.OTHER_STATUS},a),{},{chat:i,author:s,isDirect:f}):e.throw("Unrecognized message type")}(e,t);return{encs:t,msgInfo:s,msgMeta:function(e,t){var r=e.hasChild("unavailable");r||0!==t.length||e.throw("incomingMsgParser: to have enc node children");return{isUnavailable:r,type:e.attrEnum("type",i.MSG_TYPES),rawTs:e.attrString("t"),urlNumber:e.hasChild("url_number"),urlText:e.hasChild("url_text")}}(e,t),bizInfo:function(e){var t=e.hasChild("verified_name")?e.child("verified_name").contentBytes():null,r=e.attrEnumOrDefault("verified_level",i.VERIFIED_LEVEL,null),a=e.hasAttr("verified_name")?e.attrInt("verified_name"):-1,n=e.maybeChild("biz"),s=null;if(null!=n){var o=n.maybeAttrEnum("actual_actors",i.ACTUAL_ACTORS),u=n.maybeAttrEnum("host_storage",i.HOST_STORAGE),l=n.maybeAttrInt("privacy_mode_ts");null!=o&&null!=u&&null!=l&&(s={actualActors:o,hostStorage:u,privacyModeTs:l})}return{verifiedNameCert:t,verifiedLevel:r,verifiedNameSerial:a,privacyMode:s}}(e),paymentInfo:function(e){var t=null,r=e.hasChild("pay")&&e.child("pay")||e.hasChild("transaction")&&e.child("transaction");r&&(t={receiverJid:r.attrString("receiver"),currency:r.attrString("currency"),amount1000:r.attrInt("amount"),txnStatus:r.attrInt("status"),transactionTimestamp:r.attrInt("ts")});return t}(e),deviceIdentity:a}}));t.default=c},53183:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.processDecryptedProto=function(){return D.apply(this,arguments)},t.processPlaceholderMsg=function(){return k.apply(this,arguments)};var i=n(r(19976)),s=n(r(52954)),o=r(84139),u=r(27857),l=r(90272),d=r(28703),c=r(43053),f=r(95595),p=n(r(31908)),h=r(12425),_=n(r(40210)),m=r(39778),g=r(88528),v=a(r(32602)),E=r(40690),y=r(44762),S=n(r(67294)),T=r(31739),b=r(48835),A=r(85861),C=r(76241),P=r(25813);function O(){var e=(0,i.default)(["Assertion failed!"]);return O=function(){return e},e}function w(){var e=(0,i.default)(["processPlaceholderMsg: skip placeholder for peer message ",""]);return w=function(){return e},e}function M(){var e=(0,i.default)(["Assertion failed!"]);return M=function(){return e},e}function I(){var e=(0,i.default)(["processOrphanAck: failed with error: ",""]);return I=function(){return e},e}function R(){var e=(0,i.default)(["message decrypted: "]);return R=function(){return e},e}function D(){return(D=(0,s.default)((function*(e,t,r,a,n){var i=(0,y.unpad)(e),s=(0,o.decodeProto)(d.MessageSpec,i);if(__LOG__(2)(R()),!t.isHsm&&s.highlyStructuredMessage)throw new l.HsmMismatchError;var u=(0,T.getFrom)(t);if(!(yield(0,b.isFromKnownDevice)(t.author)))throw new c.UnknownMessageError("processDecryptedProto: reject message from unknown device");if(t.type===A.MESSAGE_TYPE.PEER_BROADCAST&&a.retryCount>0){var m=yield(0,h.getMsgByMsgKey)((0,T.messageInfoToKey)(t));null!=(null==m?void 0:m.broadcastParticipants)&&(t.bclParticipants=m.broadcastParticipants,null!=m.broadcastEphSettings&&(t.bclEphSettings=m.broadcastEphSettings))}var E=yield(0,T.parseMessage)(t,a.e2eType,s,r),S=[];if(E.history)(0,p.default)(E.history,u,t.externalId);else if(E.securityNotificationEnabled)(0,f.setGlobalSecurityNotifications)(E.securityNotificationEnabled.isEnabled);else if(E.appStateSyncKeyShare)(0,C.handleAppStateSyncKeyShare)(E.appStateSyncKeyShare,u);else if(E.appStateSyncKeyRequest)(0,P.handleAppStateSyncKeyRequest)(E.appStateSyncKeyRequest,u);else{var O=!1;if(null==E.deviceSent?O=!0:E.deviceSent.phash?O=yield(0,b.validateBclHash)(E.deviceSent.phash,E.deviceSent.info):E.deviceSent.destination&&(O=yield(0,b.validateMsgDestination)(E.deviceSent.destination,t)),!O)throw new c.DeviceSentMessageError((0,T.getDeviceType)(t.author),_.default.DSM_ERROR.INVALID_DSM);var w=a.retryCount>0;S.push(N(E.renderableMsgs,t,r,n,w)),null!=E.storeMsg&&(0,h.storeMessages)([E.storeMsg],E.storeMsg.id.remote),null!=E.senderKey&&S.push(v.Session.createGroupSignalSession(t.author,E.senderKey.groupId,E.senderKey.key)),t.pushname&&(0,g.updatePushname)(t.author,t.pushname),yield Promise.all(S)}}))).apply(this,arguments)}function N(){return L.apply(this,arguments)}function L(){return(L=(0,s.default)((function*(e,t,r,a,n){try{if(t.offline)return void S.default.addOfflineMessage(e.map((e=>({msg:e,receiptInfo:{from:(0,T.getFrom)(t),author:t.author}}))));yield Promise.all(e.map(function(){var e=(0,s.default)((function*(e){var t=e.id.remote;(0,E.updateContactPropertiesOnNewChat)(t),(0,E.updateBizPrivacyMode)(t,a.privacyMode),yield(0,m.handleSingleMsgMD)(t,e,n),(0,u.processOrphanAck)(e.id).catch((e=>{__LOG__(4,void 0,new Error,!0)(I(),e),SEND_LOGS("processOrphanAck failed")}))}));return function(){return e.apply(this,arguments)}}()))}catch(e){__LOG__(4,void 0,new Error,!0)(M()),SEND_LOGS("handle_msg: error storing/processing single message")}}))).apply(this,arguments)}function k(){return(k=(0,s.default)((function*(e,t){if(e.category!==l.CATEGORY_PEER)try{var r=yield(0,T.genPlaceholderMsg)(e,t);e.offline?S.default.addOfflineMessage(r.map((e=>({msg:e})))):yield Promise.all(r.map(function(){var e=(0,s.default)((function*(e){var t=e.id.remote;yield(0,m.handleSingleMsgMD)(t,e)}));return function(){return e.apply(this,arguments)}}()))}catch(e){__LOG__(4,void 0,new Error,!0)(O()),SEND_LOGS("handle_msg: error storing/processing single message")}else __LOG__(2)(w(),e.externalId)}))).apply(this,arguments)}},85861:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MESSAGE_TYPE=t.PlaceholderType=t.E2EProcessResult=void 0;var a=r(28103).Mirrored(["SUCCESS","RETRY","HSM_MISMATCH","BACKFILL","PARSE_ERROR"]);t.E2EProcessResult=a;var n=r(28103).Mirrored(["E2E","FANOUT"]);t.PlaceholderType=n;var i=Object.freeze({CHAT:"chat",GROUP:"group",PEER_BROADCAST:"peer_broadcast",OTHER_BROADCAST:"other_broadcast",DIRECT_PEER_STATUS:"direct_peer_status",OTHER_STATUS:"other_status"});t.MESSAGE_TYPE=i},31739:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.parseMessage=function(){return C.apply(this,arguments)},t.genPlaceholderMsg=function(){return k.apply(this,arguments)},t.generateBaseMsg=U,t.sendReceipt=function(e,t,r){var{externalId:a}=e,{rawTs:n}=t,i=Y(e),s=e.type===S.MESSAGE_TYPE.CHAT&&G(e.author)?e.chat:null,d=e.type===S.MESSAGE_TYPE.CHAT?null:e.author,c=e.category===u.CATEGORY_PEER;switch(r.result){case S.E2EProcessResult.SUCCESS:return(0,v.sendDeliveryReceiptsAfterDecryption)(a,i,s,d,c);case S.E2EProcessResult.HSM_MISMATCH:return Promise.resolve();case S.E2EProcessResult.RETRY:var f=null==r.retryCount?1:r.retryCount+1;return(0,E.sendRetryReceipt)(f,i,d,s,a,n,c);default:return Promise.resolve((0,l.castStanza)((0,o.wap)("ack",{id:(0,o.CUSTOM_STRING)(a),class:"message",from:(0,T.DEVICE_JID)((0,p.assertGetMe)()),to:i?(0,T.JID)(i):o.DROP_ATTR,type:t.type,participant:d?(0,T.USER_JID)(d):o.DROP_ATTR})))}},t.isPeer=G,t.messageInfoToKey=x,t.getDeviceType=B,t.getFrom=Y;var n=a(r(70417)),i=a(r(19976)),s=a(r(52954)),o=r(30691),u=r(90272),l=r(54086),d=a(r(50935)),c=r(58187),f=r(43053),p=r(95595),h=r(12425),_=a(r(40210)),m=a(r(77865)),g=a(r(69338)),v=r(23882),E=r(14229),y=r(96571),S=r(85861),T=r(95778),b=r(75637);function A(){var e=(0,i.default)(["drop: cannot create MsgKey: ",""]);return A=function(){return e},e}function C(){return(C=(0,s.default)((function*(e,t,r,a){var n,i,s,o,u;if(null!=(null===(n=r.protocolMessage)||void 0===n?void 0:n.historySyncNotification))u={history:g.default.parseMsgProto(r,U(e),"relay",a).historySyncMetaData};else if(null!=(null===(i=r.protocolMessage)||void 0===i?void 0:i.initialSecurityNotificationSettingSync)){var l;u={securityNotificationEnabled:{isEnabled:null===(l=r.protocolMessage.initialSecurityNotificationSettingSync.securityNotificationEnabled)||void 0===l||l}}}else if(null!=(null===(s=r.protocolMessage)||void 0===s?void 0:s.appStateSyncKeyShare))u={appStateSyncKeyShare:r.protocolMessage.appStateSyncKeyShare};else if(null!=(null===(o=r.protocolMessage)||void 0===o?void 0:o.appStateSyncKeyRequest))u={appStateSyncKeyRequest:r.protocolMessage.appStateSyncKeyRequest};else switch(e.type){case S.MESSAGE_TYPE.CHAT:u=G(e.author)?yield P(e,r,a):yield I(e,r,a);break;case S.MESSAGE_TYPE.GROUP:u=G(e.author)&&e.isDirect?yield P(e,r,a):yield I(e,r,a);break;case S.MESSAGE_TYPE.PEER_BROADCAST:if(t===y.CiphertextType.Skmsg){if(!e.bclHashValidated)throw new Error("parseMessage: participants for peer broadcast message is not validated");u=yield I(e,r,a)}else u=yield w(e,r,a);break;case S.MESSAGE_TYPE.OTHER_BROADCAST:u=yield I(e,r,a);break;case S.MESSAGE_TYPE.DIRECT_PEER_STATUS:u=yield w(e,r,a);break;case S.MESSAGE_TYPE.OTHER_STATUS:u=yield I(e,r,a);break;default:throw new Error("Unrecognized MESSAGE_TYPE")}return u}))).apply(this,arguments)}function P(){return O.apply(this,arguments)}function O(){return(O=(0,s.default)((function*(e,t,r){var{deviceSentMessage:a}=t;if(null==a)throw new f.DeviceSentMessageError(B(e.author),_.default.DSM_ERROR.MISSING_DSM);if(null==a.destinationJid)throw new f.DeviceSentMessageError(B(e.author),_.default.DSM_ERROR.INVALID_DSM);var{destinationJid:i}=a,s=yield D(e,a.message,r);return(0,n.default)({deviceSent:{destination:(0,b.createWid)(i)}},s)}))).apply(this,arguments)}function w(){return M.apply(this,arguments)}function M(){return(M=(0,s.default)((function*(e,t,r){var{deviceSentMessage:a}=t;if(null==a)throw new f.DeviceSentMessageError(B(e.author),_.default.DSM_ERROR.MISSING_DSM);if(null==a.phash)throw new f.DeviceSentMessageError(B(e.author),_.default.DSM_ERROR.INVALID_DSM);var{phash:i}=a,s=yield D(e,a.message,r);return(0,n.default)({deviceSent:{phash:i,info:e}},s)}))).apply(this,arguments)}function I(){return R.apply(this,arguments)}function R(){return(R=(0,s.default)((function*(e,t,r){if(null!=t.deviceSentMessage)throw new f.DeviceSentMessageError(B(e.author),_.default.DSM_ERROR.INVALID_SENDER);var a=yield D(e,t,r);return(0,n.default)({deviceSent:null},a)}))).apply(this,arguments)}function D(){return N.apply(this,arguments)}function N(){return(N=(0,s.default)((function*(e,t,r){if(null==t)return{senderKey:null,storeMsg:null,renderableMsgs:[]};var a=g.default.parseMsgProto(t,U(e),"relay",r),n=null!=t.senderKeyDistributionMessage?L(e,t.senderKeyDistributionMessage):null,i=null;if(e.type===S.MESSAGE_TYPE.PEER_BROADCAST&&(a.broadcastId=e.chat,a.broadcastParticipants=e.bclParticipants,a.broadcastEphSettings=e.bclEphSettings,i=a),e.type===S.MESSAGE_TYPE.OTHER_BROADCAST){a.broadcastId=e.chat;var s=e.ephSetting,o=a.ephemeralSharedSecret;if(null!=s&&null!=o){var{ephemeralDuration:u,ephemeralSettingTimestamp:l}=yield(0,c.decodeBroadcastEphemeralSetting)(e.chat,(0,p.getMeUser)(),e.author,s,o);a.ephemeralDuration=u,a.ephemeralSettingTimestamp=l}}var d=[];return"unknown"===a.type&&null!=n||(d=e.type===S.MESSAGE_TYPE.PEER_BROADCAST?yield F(a,e.bclParticipants,e.bclEphSettings):[a]),{senderKey:n,storeMsg:i,renderableMsgs:d}}))).apply(this,arguments)}function L(e,t){if(!e.chat.isGroup()&&!e.chat.isBroadcast())throw new Error("should not have senderkey");var{groupId:r,axolotlSenderKeyDistributionMessage:a}=t;if(null==r||e.chat.toString({legacy:!0})!==r)throw new Error("senderKeyDistributionMessage: from ".concat(e.chat.toString()," mismatched to ").concat(r||"null"));if(!a)throw new Error("senderKeyDistributionMessage: from ".concat(e.author.toString()," has no content"));return{groupId:r,key:a}}function k(){return(k=(0,s.default)((function*(e,t){if(e.edit===d.default.EDIT_ATTR.REVOKE&&e.type!==S.MESSAGE_TYPE.PEER_BROADCAST)return[];var r=U(e);return t===S.PlaceholderType.E2E?r.type=d.default.MSG_TYPE.CIPHERTEXT:(r.type=d.default.MSG_TYPE.UNKNOWN,r.subtype="fanout"),e.type===S.MESSAGE_TYPE.PEER_BROADCAST?(r.broadcastParticipants=e.bclParticipants,r.broadcastEphSettings=e.bclEphSettings,(0,h.storeMessages)([r],r.id.remote),e.edit===d.default.EDIT_ATTR.REVOKE?[]:yield F(r,e.bclParticipants)):[r]}))).apply(this,arguments)}function U(e){var t=x(e),r=(0,p.getMeUser)(),a={id:t,from:t.fromMe?r:t.remote,to:t.fromMe?t.remote:r,type:d.default.MSG_TYPE.UNKNOWN,t:e.ts||0,ack:d.default.ACK.SENT,author:t.participant,broadcast:!1,notifyName:e.pushname||""};return null!=e.count&&(a.count=e.count),a}function F(e,t,r){return Promise.all(t.map(function(){var t=(0,s.default)((function*(t){var a,i,s;try{a=new m.default({remote:t,fromMe:!0,id:e.id.id})}catch(e){return __LOG__(3)(A(),e.stack),null}var o=r?r[t.toString()]:null,u=e.ephemeralSharedSecret,l=e.broadcastId;null!=l&&null!=o&&null!=u&&({ephemeralDuration:i,ephemeralSettingTimestamp:s}=yield(0,c.decodeBroadcastEphemeralSetting)(l,t,(0,p.getMeUser)(),o,u));var d=(0,n.default)((0,n.default)({},e),{},{id:a,from:(0,p.getMeUser)(),to:t,broadcast:!0,ephemeralDuration:i,ephemeralSettingTimestamp:s});return e.protocolMessageKey&&(d.protocolMessageKey=new m.default({remote:t,fromMe:!0,id:e.protocolMessageKey.id})),d}));return function(){return t.apply(this,arguments)}}())).then((e=>e.filter(Boolean)))}function G(e){return(0,b.toUserWid)(e).equals((0,p.getMeUser)())}function x(e){return e.type===S.MESSAGE_TYPE.OTHER_BROADCAST?new m.default({remote:(0,b.toUserWid)(e.author),fromMe:!1,id:e.externalId}):e.type===S.MESSAGE_TYPE.CHAT?new m.default({remote:e.chat,fromMe:G(e.author),id:e.externalId}):new m.default({remote:e.chat,fromMe:G(e.author),participant:(0,b.toUserWid)(e.author),id:e.externalId})}function B(e){return null==e.device||e.device===d.default.DEVICE.PRIMARY_DEVICE?_.default.DEVICE_TYPE.PRIMARY:_.default.DEVICE_TYPE.COMPANION}function Y(e){return e.type===S.MESSAGE_TYPE.CHAT?e.author:e.chat}},48835:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.validateMsgDestination=function(e,t){var r=t.author,a=t.chat;if(!e.equals(a))return __LOG__(4,void 0,new Error,!0)(_(),String(e),a.toString()),SEND_LOGS("validateMsgDestination: drop due to the deviceSentMessage meta mismatch."),Promise.resolve(!1);var n=(0,c.toUserWid)(r),i=r.device||0;if(!n.equals((0,l.getMeUser)()))return __LOG__(4,void 0,new Error,!0)(h(),r.toString()),SEND_LOGS("validateMsgDestination: drop due to msg is not sent from your own device."),Promise.resolve(!1);return(0,u.hasDevice)(n,i).then((e=>(e||(__LOG__(4,void 0,new Error,!0)(p(),r.toString()),SEND_LOGS("validateMsgDestination:drop due to invalid device")),e)))},t.validateBclHash=function(e,t){var{bclParticipants:r}=t;return(0,d.phashV2)(r).then((r=>r!==e?(__LOG__(4,void 0,new Error,!0)(f(),e,r),SEND_LOGS("validateBclHash: drop due to invalid hash."),!1):(t.bclHashValidated=!0,!0)))},t.isFromKnownDevice=function(){return m.apply(this,arguments)};var n=a(r(52954)),i=a(r(19976)),s=r(47882),o=a(r(50935)),u=r(77725),l=r(95595),d=r(24897),c=r(75637);function f(){var e=(0,i.default)(["expected: ",", got: ",""]);return f=function(){return e},e}function p(){var e=(0,i.default)(["no record found for sender: ",""]);return p=function(){return e},e}function h(){var e=(0,i.default)(["sender: ",""]);return h=function(){return e},e}function _(){var e=(0,i.default)(["encDestination: ",", destination: ",""]);return _=function(){return e},e}function m(){return(m=(0,n.default)((function*(e){var t=null==e.device?o.default.DEVICE.PRIMARY_DEVICE:e.device;if(t===o.default.DEVICE.PRIMARY_DEVICE)return!0;var[r]=yield(0,u.getDeviceIds)([e.user]),a=null!=r&&r.devices.includes(t);return a||(0,s.syncDeviceList)([(0,c.toUserWid)(e)]),a}))).apply(this,arguments)}},93514:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.handleChatSimpleAck=function(){return E.apply(this,arguments)};var n=a(r(19976)),i=a(r(52954)),s=r(8654),o=a(r(50935)),u=r(95595),l=a(r(82486)),d=r(99849),c=a(r(77865)),f=a(r(48166)),p=r(75637);function h(){var e=(0,n.default)(["error: ",""]);return h=function(){return e},e}function _(){var e=(0,n.default)(["handleChatSimpleAck: peer receipt from peer device ",""]);return _=function(){return e},e}function m(){var e=(0,n.default)(["handleChatSimpleAck: sender receipt from peer device ",""]);return m=function(){return e},e}var{ACK:g,ACK_STRING:v}=o.default;function E(){return(E=(0,i.default)((function*(e){var t,{from:r,externalIds:a,ts:n,recipient:i,ackString:s,offline:o}=e,{ack:_}=e,m=s===v.SENDER,E=!m&&(0,p.toUserWid)(r).equals((0,u.getMeUser)());if(E||m){if(!i)throw new Error("handleChatSimpleAck: invalid sender/peer receipt without recipient");t=i}else{var S;t=(0,p.toUserWid)(r),_===g.READ&&"none"===(null===(S=(0,u.getUserPrivacySettings)())||void 0===S?void 0:S.readReceipts)&&(_=g.RECEIVED)}var T=a.map((e=>new c.default({id:e,remote:t,fromMe:!E}))),b=T.map((e=>e.toString()));if(null!=o&&l.default.offlineStanzaReceivedAfterCompelete(),null==o||l.default.getOfflineSessionComplete()){if(!E)try{yield(0,d.updateReceiptRecords)(_,n,r,b)}catch(e){__LOG__(4,void 0,new Error,!0)(h(),e),SEND_LOGS("handleChatSimpleAck: failed")}yield y(E,m,T,t,_,n)}else{if(!E)return f.default.addOfflineReceipt(_,n,r,b);if(null!=i&&s===v.READ&&a.length>0)return f.default.addOfflinePeerReadReceipt(n,b)}}))).apply(this,arguments)}function y(e,t,r,a,n,i){return n<g.RECEIVED?Promise.resolve():t?(__LOG__(2)(m(),a.toString()),Promise.resolve()):e?(__LOG__(2)(_(),a.toString()),n===g.READ?(0,s.updateChatPeerRead)(a,r):n===g.PLAYED?(0,s.updateMsgAcks)(r,n,i):Promise.resolve()):(0,s.updateMsgAcks)(r,n,i)}},8654:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.updateChatPeerRead=b,t.updateMsgAcks=C,t.processOrphanPeerReceipt=function(e){return T.enqueue((0,i.default)((function*(){var t=yield(0,c.getOrphanReceipt)(String(e));t?(null!=t[S.PLAYED]&&(__LOG__(2)(v(),e),yield C([e],y.PLAYED,t[S.PLAYED])),null!=t[S.READ]&&(__LOG__(2)(g(),e),b(e.remote,[e])),yield(0,c.removeOrphanReceipt)(String(e))):__LOG__(2)(E(),e)})))};var n=a(r(19976)),i=a(r(52954)),s=r(98970),o=r(27857),u=r(55644),l=a(r(50935)),d=a(r(58885)),c=r(55361),f=r(58269),p=r(52303);function h(){var e=(0,n.default)(["updateMsgAcks: store "," orphan acks"]);return h=function(){return e},e}function _(){var e=(0,n.default)(["updateMsgAcks: no message found for incoming ack, with msgKey: ",""]);return _=function(){return e},e}function m(){var e=(0,n.default)(["updateChatPeerRead: storing "," orphan acks"]);return m=function(){return e},e}function g(){var e=(0,n.default)(["processOrphanPeerReceipt: orphan read ack found for incoming ",""]);return g=function(){return e},e}function v(){var e=(0,n.default)(["processOrphanPeerReceipt: orphan played ack found for incoming ",""]);return v=function(){return e},e}function E(){var e=(0,n.default)(["processOrphanPeerReceipt: no orphan ack found for incoming ",""]);return E=function(){return e},e}var{ACK:y,ACK_STRING:S}=l.default,T=new s.PromiseQueue;function b(){return A.apply(this,arguments)}function A(){return(A=(0,i.default)((function*(e,t){var a=t.map(String),n=[],i=null;(yield(0,p.getTable)().bulkGet(a,!1)).forEach(((e,t)=>{e?null==e.pendingReadReceipt||null!=e.rowId&&(null==i||e.rowId>i)&&(i=e.rowId):n.push(a[t])})),T.enqueue((()=>(__LOG__(2)(m(),n.length),(0,c.createOrUpdateOrphanReceipt)(S.READ,0,n)))),yield(0,u.markMessageAndChatAsRead)(i,String(e));var s=r(43334).default.get(e);s&&(0,f.updateUnreadCountMD)(s,0,!1)}))).apply(this,arguments)}function C(){return P.apply(this,arguments)}function P(){return(P=(0,i.default)((function*(e,t,r){var a=[],n=[];e.forEach((e=>{var i=d.default.get(e);i?n.push((0,o.updateMsgAck)(i,null,{from:i.from,to:i.to,ack:t,t:r})):(__LOG__(2)(_(),e),e.fromMe||a.push(e))})),a.length>0&&T.enqueue((()=>{__LOG__(2)(h(),a.length);var e=null;if(t===y.PLAYED?e=S.PLAYED:t===y.READ&&(e=S.READ),e)return(0,c.createOrUpdateOrphanReceipt)(e,r,a.map(String))})),yield Promise.all(n)}))).apply(this,arguments)}},13260:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.handleGroupSimpleAck=function(){return C.apply(this,arguments)};var n=a(r(19976)),i=a(r(52954)),s=r(27857),o=r(8654),u=a(r(50935)),l=r(95595),d=a(r(82486)),c=r(99849),f=a(r(58885)),p=r(22952),h=a(r(92313)),_=a(r(77865)),m=a(r(48166)),g=r(75637);function v(){var e=(0,n.default)(["error: ",""]);return v=function(){return e},e}function E(){var e=(0,n.default)(["Assertion failed! ",""]);return E=function(){return e},e}function y(){var e=(0,n.default)(["handleGroupSimpleAck: no message found for incoming ack, with msgKey:"]);return y=function(){return e},e}function S(){var e=(0,n.default)(["handleGroupSimpleAck: peer receipt from peer device ",""]);return S=function(){return e},e}function T(){var e=(0,n.default)(["handleGroupSimpleAck: sender receipt from peer device ",""]);return T=function(){return e},e}var{ACK:b,ACK_STRING:A}=u.default;function C(){return(C=(0,i.default)((function*(e){var{ack:t,from:r,externalIds:a,ts:n,ackString:i,participant:s,recipient:o,offline:u}=e;if(!s)throw new Error("handleGroupSimpleAck: got group ack without participant.");var f,p=(0,l.getMeUser)(),h=(0,g.toUserWid)(s),E=i===A.SENDER,y=!E&&h.equals(p);if(y){if(!o)throw new Error("handleGroupSimpleAck: invalid sender/peer receipt without recipient");f=o}else f=p;var S=a.map((e=>new _.default({id:e,remote:r,fromMe:!y,participant:f}))),T=S.map((e=>e.toString()));if(null!=u&&d.default.offlineStanzaReceivedAfterCompelete(),null==u||d.default.getOfflineSessionComplete()){if(!y)try{yield(0,c.updateReceiptRecords)(t,n,s,T)}catch(e){__LOG__(4,void 0,new Error,!0)(v(),e),SEND_LOGS("handleGroupSimpleAck: failed")}}else{if(!y)return m.default.addOfflineReceipt(t,n,s,T);if(null!=o&&i===A.READ&&a.length>0)return m.default.addOfflinePeerReadReceipt(n,T)}yield P(y,E,S,r,t,h,n)}))).apply(this,arguments)}function P(e,t,r,a,n,i,u){return n<b.RECEIVED?Promise.resolve():t?(__LOG__(2)(T(),a.toString()),Promise.resolve()):e?(__LOG__(2)(S(),a.toString()),n===b.READ&&(0,o.updateChatPeerRead)(a,r),n===b.PLAYED?(0,o.updateMsgAcks)(r,n,u):Promise.resolve()):Promise.all(r.map((e=>{var t=f.default.get(e);if(t)return h.default.find(e).then((r=>{if(r||(__LOG__(4,void 0,new Error,!0)(E(),e.toString()),SEND_LOGS("handleGroupSimpleAck: no msgInfo found for msg:")),(0,p.updateMsgInfo)(r,n,i,u),n===b.RECEIVED&&0===r.deliveryRemaining||n===b.READ&&0===r.readRemaining||n===b.PLAYED&&0===r.playedRemaining)return(0,s.updateMsgAck)(t,null,{from:(0,l.assertGetMe)(),to:a,ack:n,t:u})}));__LOG__(2)(y())}))).then((()=>{}))}},96521:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=h.default.parse(e);if(t.error)return __LOG__(4,void 0,new Error)(y(),t.error.toString(),e.toString()),Promise.reject(t.error);var r=t.success,{ack:a,ackString:n,from:s,stanzaId:u}=r;if(r.type===h.RECEIPT_TYPE.SIMPLE){if(a===S.CONTENT_GONE)return Promise.resolve(T(s,u,n,null));var _=T(s,u,n,r.participant);return function(e){var{from:t,ack:r,stanzaId:a}=e;if(__LOG__(2)(v(),r,a),r===S.MD_DOWNGRADE)return(0,f.markMdDowngrade)(new p.default({id:a,remote:t,fromMe:!0,participant:t.isUser()?void 0:(0,l.getMeUser)()}));if(r===S.PEER)return Promise.resolve();if(t.isStatusV3())return(0,c.handleStatusSimpleAck)(e);if(t.isUser())return(0,o.handleChatSimpleAck)(e);if(t.isGroup())return(0,d.handleGroupSimpleAck)(e);if(t.isBroadcast()){if(!e.participant)return Promise.reject(new Error("handleSimpleAck: missing participant for broadcast receipt ".concat(t.toString())));var n=(0,i.default)((0,i.default)({},e),{},{from:e.participant,participant:null});return(0,o.handleChatSimpleAck)(n)}return Promise.reject(new Error("handleSimpleAck: unsupported type for ".concat(t.toString())))}(r).then((()=>_)).catch((()=>_))}if(r.type===h.RECEIPT_TYPE.AGGREGATE){var m=T(s,u,n,null);return function(e){var{ack:t,from:r}=e;if(t===S.CONTENT_GONE)return Promise.reject("handleAggregateAck: reupload receipts cannot be aggregated");if(!r.isGroup())return Promise.reject("handleAggregateAck: aggregate receipts should come only from group JIDs");return __LOG__(3)(g()),Promise.resolve()}(r).then((()=>m)).catch((()=>m))}return __LOG__(4,void 0,new Error,!0)(E(),r.type),SEND_LOGS("handleMsgReceipt: Invalid receipt type"),Promise.resolve(T(s,u,n,null))};var i=n(r(70417)),s=n(r(19976)),o=r(93514),u=n(r(50935)),l=r(95595),d=r(13260),c=r(13195),f=r(7195),p=n(r(77865)),h=a(r(31036)),_=r(30691),m=r(95778);function g(){var e=(0,s.default)(["handleAggregateAck: not implemented"]);return g=function(){return e},e}function v(){var e=(0,s.default)(["handleSimpleAck: got receipt "," for msg ",""]);return v=function(){return e},e}function E(){var e=(0,s.default)(["type: ",""]);return E=function(){return e},e}function y(){var e=(0,s.default)([""," parsing ",""]);return y=function(){return e},e}var{ACK:S}=u.default;function T(e,t,r,a){return(0,_.wap)("ack",{to:(0,m.JID)(e),id:(0,_.CUSTOM_STRING)(t),class:"receipt",type:(0,_.MAYBE_CUSTOM_STRING)(r),participant:a&&a!==e?(0,m.DEVICE_JID)(a):_.DROP_ATTR})}},31036:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.RECEIPT_TYPE=void 0;var n=a(r(70417)),i=a(r(50935)),s=a(r(23767)),{ACK:o}=i.default,u={read:o.READ,played:o.PLAYED,inactive:o.INACTIVE,"server-error":o.CONTENT_GONE,"md-downgrade":o.MD_DOWNGRADE,sender:o.RECEIVED,"read-self":o.READ,"played-self":o.PLAYED,peer_msg:o.PEER},l={SIMPLE:"simple",AGGREGATE:"aggregate"};t.RECEIPT_TYPE=l;var d=new s.default("incomingMsgReceiptParser",(e=>{e.assertTag("receipt"),e.hasAttr("to")&&e.assertAttrIsMe("to");var t={ack:e.attrEnumOrDefault("type",u,o.RECEIVED),stanzaId:e.attrString("id"),from:e.attrWid("from"),ackString:e.hasAttr("type")?e.attrString("type"):null},r=e.maybeChild("participants");return r?function(e,t){var r=t.mapChildrenWithTag("user",(e=>{try{return{participant:e.attrDeviceWid("jid"),ts:e.attrTime("t")}}catch(e){return null}})).filter((e=>null!=e));return(0,n.default)((0,n.default)({},e),{},{type:l.AGGREGATE,externalId:t.attrString("key"),receipts:r})}(t,r):function(e,t){var r,a=t.hasAttr("participant")?t.attrDeviceWid("participant"):null,i=t.hasAttr("recipient")?t.attrUserWid("recipient"):null;r=t.hasChild("list")?t.child("list").mapChildrenWithTag("item",(e=>e.attrString("id"))):[];return r.push(e.stanzaId),(0,n.default)((0,n.default)({},e),{},{type:"simple",externalIds:r,participant:a,recipient:i,ts:t.attrTime("t"),offline:t.hasAttr("offline")?t.attrString("offline"):null})}(t,e)}));t.default=d},13195:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.handleStatusSimpleAck=function(){return v.apply(this,arguments)};var n=a(r(19976)),i=a(r(52954)),s=r(8654),o=a(r(50935)),u=r(95595),l=r(99849),d=a(r(77865)),c=r(75637),f=a(r(57185)),p=a(r(92313)),h=r(22952);function _(){var e=(0,n.default)(["error: ",""]);return _=function(){return e},e}var{ACK:m,ACK_STRING:g}=o.default;function v(){return(v=(0,i.default)((function*(e){var{externalIds:t,ts:r,ackString:a,ack:n,participant:i,recipient:s}=e;if(a===g.READ){var f=!!i&&(0,c.toUserWid)(i).equals((0,u.getMeUser)()),p=new d.default({id:t[0],remote:(0,c.createWid)(o.default.STATUS_WID),fromMe:!f,participant:s||(0,u.getMeUser)()}),h=[p.toString()];if(!f&&i)try{yield(0,l.updateReceiptRecords)(n,r,i,h)}catch(e){__LOG__(4,void 0,new Error,!0)(_(),e),SEND_LOGS("handleStatusSimpleAck: failed")}yield E(f,p,r)}}))).apply(this,arguments)}function E(){return y.apply(this,arguments)}function y(){return(y=(0,i.default)((function*(e,t,r){var a=t.participant;if(a){if(e){var n=f.default.get(a);n&&n.handleReadStatus(t)}else{var i=yield p.default.find(t);(0,h.updateMsgInfo)(i,m.READ,a,r)}yield(0,s.updateMsgAcks)([t],m.READ,r)}}))).apply(this,arguments)}},83662:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.sendAndClearDanglingReceipts=function(){return d.apply(this,arguments)},t.clearDanglingReceipts=c;var n=a(r(52954)),i=r(71684),s=r(41714),o=r(29634),u=r(35914),l=r(75637);function d(){return(d=(0,n.default)((function*(){var e=yield(0,o.getTable)().all(),t=new Map;e.forEach((e=>{var{receipts:r}=e;r.forEach((e=>{var r=(0,l.createWid)(e.from),a=(0,l.createWid)(e.author),n=t.get(r);n||(n=new Map,t.set(r,n));var i=n.get(a);i||(i=[],n.set(a,i)),i.push(e.externalId)}))}));var r=String((0,i.unixTime)());yield Promise.all(Array.from(t.keys()).map((e=>{var a=t.get(e);if(a)return(0,s.sendAggregateReceipts)(e,s.RECEIPT_TYPE.DELIVERY,r,a)}))),yield c()}))).apply(this,arguments)}function c(){return f.apply(this,arguments)}function f(){return(f=(0,n.default)((function*(){yield(0,u.blockSendPing)(),yield(0,o.getTable)().clear()}))).apply(this,arguments)}},82486:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.OfflineMessageHandler=void 0;var i=n(r(52954)),s=n(r(19976)),o=r(91460),u=r(83662),l=n(r(79711)),d=r(39696),c=r(82284),f=r(92807),p=n(r(67294)),h=r(41186),_=n(r(48166)),m=r(85861),g=r(22890),v=n(r(12767)),E=a(r(82885)),y=r(31822),S=r(94765);function T(){var e=(0,s.default)(["[offline-resume] runReceiptCleanUpLoop: Gave up clean up receipts "," tries"]);return T=function(){return e},e}function b(){var e=(0,s.default)(["[offline-resume] runReceiptCleanUpLoop: failed with error ","."]);return b=function(){return e},e}function A(){var e=(0,s.default)(["[offline-resume] runReceiptCleanUpLoop: done."]);return A=function(){return e},e}function C(){var e=(0,s.default)(["[offline-resume] _onOfflineComplete: pruneExpiredMessages message failed with error: ",""]);return C=function(){return e},e}function P(){var e=(0,s.default)(["[offline-resume] _onOfflineComplete: restoreChatsAndMessages failed with error ","."]);return P=function(){return e},e}function O(){var e=(0,s.default)(["[offline-resume] _onOfflineComplete: restoreChatsAndMessages."]);return O=function(){return e},e}function w(){var e=(0,s.default)(["[offline-resume] _onOfflineComplete: updateOfflineMsgAcks."]);return w=function(){return e},e}function M(){var e=(0,s.default)(["[offline-resume] _onOfflineComplete: process_offline_messages: total decryption error: ",""]);return M=function(){return e},e}function I(){var e=(0,s.default)(["[offline-resume] _onOfflineComplete: restoreChatsAndMessages failed with error ","."]);return I=function(){return e},e}function R(){var e=(0,s.default)(["[offline-resume] "," received after offline completion marker. Refreshing window due to potential server issue."]);return R=function(){return e},e}function D(){var e=(0,s.default)(["[offline-resume] Received multiple offline preview ib during offline resume."]);return D=function(){return e},e}function N(){var e=(0,s.default)(["[offline-resume] restart client due to exceed the RESUME_RESUME_MESSAGE_LIMIT"]);return N=function(){return e},e}function L(){var e=(0,s.default)(["[offline-resume] Offline session is complete when receiving offline preview ib."]);return L=function(){return e},e}class k{constructor(){this.initState(),l.default.on("logout",(()=>{this.initState()}))}initState(){this._offlineMessagePreviewCounter=-1,this._decryptedMessageCount=0,this._decryptionErrorCount=0,this._offlineSessionComplete=!1,this._finishedDownloading=!1,this._hasMessagesToDownload=null}setOfflineMessagePreviewCounter(e){this._offlineSessionComplete?(__LOG__(2)(L()),e.message>100&&(__LOG__(2)(N()),x())):this._offlineMessagePreviewCounter>0?__LOG__(2)(D()):(y.OfflineResumeReporter.logOfflinePreviewT(),y.OfflineResumeReporter.logOfflineCount(e),this._offlineMessagePreviewCounter=e.message,this._decryptedMessageCount=0,this._offlineSessionComplete=!1,(0,h.enableMemSignalStore)())}getOfflineDeliveryProgress(){return this._finishedDownloading?100:-1===this._offlineMessagePreviewCounter?0:0===this._offlineMessagePreviewCounter?100:Math.min(Math.ceil(100*this._decryptedMessageCount/this._offlineMessagePreviewCounter),100)}getOfflineSessionComplete(){return this._offlineSessionComplete}getHasMessagesToDownload(){return this._hasMessagesToDownload}getFinishedDownloading(){return 100===this.getOfflineDeliveryProgress()}setOfflineSessionComplete(e){return this._offlineSessionComplete?Promise.resolve():(this._hasMessagesToDownload=e>0,this._finishedDownloading=0===e,this._offlineSessionComplete=!0,this._offlineStanzaCountAfterOfflineMarker=0,setTimeout((()=>{this._offlineStanzaCountAfterOfflineMarker>100&&(__LOG__(3)(R(),this._offlineStanzaCountAfterOfflineMarker),x())}),2e4),l.default.onOfflineProgressUpdate(),0===e?((0,h.enablePersistSignalStore)(),y.OfflineResumeReporter.logOfflineDecryptionErrorCount(0),(0,c.restoreChatsAndMessages)().then((()=>{G()})).catch((e=>{__LOG__(4,!0,new Error,!0)(I(),e),SEND_LOGS("offline-resume-fatal-error"),v.default.logout()}))):this._onOfflineComplete())}shouldUseOfflineResumeScreen(){return this._offlineMessagePreviewCounter>this._decryptedMessageCount}decryptOfflineMessage(e){return(0,d.decryptE2EPayload)(e).then((e=>(this._decryptedMessageCount=this._decryptedMessageCount+1,e.result===m.E2EProcessResult.RETRY&&(this._decryptionErrorCount=this._decryptionErrorCount+1),e)))}offlineStanzaReceivedAfterCompelete(){this._offlineSessionComplete&&(this._offlineStanzaCountAfterOfflineMarker=this._offlineStanzaCountAfterOfflineMarker+1)}_onOfflineComplete(){var e=this;return(0,i.default)((function*(){yield(0,f.waitForOfflineMsgThread)(),e._finishedDownloading=!0,l.default.onOfflineProgressUpdate(),y.OfflineResumeReporter.logOfflineDecryptionErrorCount(e._decryptionErrorCount),__LOG__(2)(M(),e._decryptionErrorCount),e._decryptionErrorCount=0,yield function(){return F.apply(this,arguments)}(),(0,h.enablePersistSignalStore)(),Promise.loop(function(){var e=(0,i.default)((function*(e,t,r){var a=(0,o.delayMs)(E.expBackoff(r,12e4,1e3,.1));try{return yield(0,u.clearDanglingReceipts)(),__LOG__(2)(A()),e()}catch(t){return __LOG__(2)(b(),t),r>3?(__LOG__(3)(T(),r),e()):a}}));return function(){return e.apply(this,arguments)}}());try{__LOG__(2)(w()),yield(0,g.updateOfflineMsgAcks)(),__LOG__(2)(O()),yield(0,c.restoreChatsAndMessages)()}catch(e){__LOG__(4,!0,new Error,!0)(P(),e),SEND_LOGS("offline-resume-fatal-error"),v.default.logout()}G();try{yield(0,S.pruneExpiredMessages)()}catch(e){throw __LOG__(4,void 0,new Error)(C(),e),e}}))()}}t.OfflineMessageHandler=k;var U=new k;function F(){return(F=(0,i.default)((function*(){p.default.createSnapshot(),_.default.createSnapshot(),yield Promise.all([p.default.checkpointQueue.wait(),_.default.checkpointQueue.wait()])}))).apply(this,arguments)}function G(){l.default.readyForMainStreamMode(),y.OfflineResumeReporter.logMainScreenLoadT(),y.OfflineResumeReporter.commit()}function x(){window.location&&window.location.reload&&window.location.reload()}t.default=U},67294:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(19976)),i=a(r(52954)),s=r(98970),o=r(39329),u=r(71684),l=a(r(79711)),d=r(41714),c=r(29634),f=a(r(16098)),p=r(44480),h=r(43097),_=r(82119);function m(){var e=(0,n.default)(["[offline-resume] creating snapshot: receipt done for "," - ",""]);return m=function(){return e},e}function g(){var e=(0,n.default)(["[offline-resume] creating snapshot: signal done for "," - ",""]);return g=function(){return e},e}function v(){var e=(0,n.default)(["[offline-resume] creating snapshot: messages done for "," - ",""]);return v=function(){return e},e}function E(){var e=(0,n.default)(["[offline-resume] creating snapshot for offline "," to ",""]);return E=function(){return e},e}var y=new class{constructor(){this.cache=[],this.checkpointQueue=new s.PromiseQueue,this.lastCheckpointIndex=0,this.snapshotTimer=new o.ShiftTimer((()=>{this.createSnapshot()}))}addOfflineMessage(e){this.cache.push(...e),this.snapshotTimer.isScheduled()||this.snapshotTimer.onOrAfter(1e3)}_addToMessageTable(e,t){var r=this;return(0,i.default)((function*(){for(var a=[],n=e;n<t;n++){var i=r.cache[n].msg;a.push(i)}yield(0,_.storeOfflineMsgs)(a)}))()}_sendAggregateReceipts(e,t){var r=this;return(0,i.default)((function*(){for(var a=new Map,n=[],i=e;i<t;i++){var s=r.cache[i].msg,o=r.cache[i].receiptInfo;if(o){var l=s.id.id,{from:f,author:p}=o,h=a.get(f);h||(h=new Map,a.set(f,h));var _=h.get(p);_||(_=[],h.set(p,_)),_.push(l),n.push({from:String(f),author:String(p),externalId:l})}}var m=String((0,u.unixTime)());Promise.all(Array.from(a.keys()).map((e=>{var t=a.get(e);if(t)return(0,d.sendAggregateReceipts)(e,d.RECEIPT_TYPE.DELIVERY,m,t)}))),yield(0,c.getTable)().createOrReplace({receipts:n})}))()}createSnapshot(){var e=this;this.snapshotTimer.isScheduled()&&this.snapshotTimer.cancel();var t=this.lastCheckpointIndex,r=this.cache.length;if(this.lastCheckpointIndex=r,__LOG__(2)(E(),t,r),t!==r){var a=f.default.generateSnapshot();this.checkpointQueue.enqueue((0,i.default)((function*(){yield e._addToMessageTable(t,r),__LOG__(2)(v(),t,r),yield(0,h.getStorage)().lock(["session-store","identity-store","prekey-store","senderkey-store"],(0,i.default)((function*(){yield Promise.all([p.waSignalStore.bulkPutSession(a.sessionUpdate),p.waSignalStore.bulkPutIdentity(a.identityUpdate),p.waSignalStore.bulkPutSenderKey(a.senderKeyUpdate),p.waSignalStore.bulkRmovePreKey(a.preKeyRemove)])}))),__LOG__(2)(g(),t,r),yield e._sendAggregateReceipts(t,r),__LOG__(2)(m(),t,r),l.default.onOfflineProgressUpdate()})))}}};t.default=y},48166:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(52954)),i=a(r(19976)),s=r(98970),o=r(39329),u=a(r(50935)),l=r(22905),d=r(77993),c=r(75637);function f(){var e=(0,i.default)(["[offline-resume] starting saveOtherReceipt:"]);return f=function(){return e},e}function p(){var e=(0,i.default)(["addOfflineReceipt: not supported ack type ",""]);return p=function(){return e},e}var{ACK:h,ACK_STRING:_}=u.default,m=Object.freeze({[h.RECEIVED]:_.DELIVERY,[h.READ]:_.READ,[h.PLAYED]:_.PLAYED,[h.INACTIVE]:_.INACTIVE});function g(e){return __LOG__(2)(f()),(0,d.getStorage)().lock(["message-info"],function(){var t=(0,n.default)((function*([t]){var r=(yield t.bulkGet(e.map((e=>e[0].split(","))))).map(((t,r)=>{var[a,n]=e[r];if(!n)return null;if(t){var i=n.deviceDelivered;return t.deviceDelivered.forEach((e=>i.add(e))),{delivery:v(t.delivery,n.delivery),read:v(t.read,n.read),played:v(t.played,n.played),msgKey:t.msgKey,receiverUserJid:t.receiverUserJid,deviceDelivered:Array.from(i),deviceNotDelivered:t.deviceNotDelivered.filter((e=>!i.has(e)))}}var[s,o]=a.split(",");return{delivery:n.delivery,read:n.read,played:n.played,msgKey:s,receiverUserJid:o,deviceDelivered:Array.from(n.deviceDelivered),deviceNotDelivered:[]}}));return t.bulkCreateOrReplace(r)}));return function(){return t.apply(this,arguments)}}())}function v(e,t){if(null!=e&&null!=t)return Math.min(e,t);var r=null!=e?e:t;return null!=r?r:void 0}var E=new class{constructor(){this.peerReadCache=[],this.otherReceiptCache=new Map,this.snapshotTimer=new o.ShiftTimer((()=>{this.createSnapshot()})),this.checkpointQueue=new s.PromiseQueue}addOfflinePeerReadReceipt(e,t){this.peerReadCache.push({ts:e,msgKeys:t}),this.snapshotTimer.isScheduled()||this.snapshotTimer.onOrAfter(1e3)}addOfflineReceipt(e,t,r,a){var n,i=(0,c.toUserWid)(r).toString(),s=null!==(n=r.device)&&void 0!==n?n:u.default.DEVICE.PRIMARY_DEVICE;a.forEach((r=>{var a=m[e];if(a){var n="".concat(r,",").concat(i),o=this.otherReceiptCache.get(n);o?(a!==m[h.INACTIVE]&&(o[a]=v(o[a],t)),o.deviceDelivered.add(s)):this.otherReceiptCache.set(n,{[a]:t,deviceDelivered:new Set([s])})}else __LOG__(3)(p(),e)})),this.snapshotTimer.isScheduled()||this.snapshotTimer.onOrAfter(1e3)}createSnapshot(){this.snapshotTimer.isScheduled()&&this.snapshotTimer.cancel();var e=Array.from(this.otherReceiptCache);this.otherReceiptCache=new Map;var t=(0,l.getTable)().bulkCreate([...this.peerReadCache]);this.peerReadCache=[],this.checkpointQueue.enqueue((()=>Promise.all([g(e),t])))}};t.default=E},82119:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.storeOfflineMsgs=function(){return E.apply(this,arguments)};var n=a(r(19976)),i=a(r(52954)),s=a(r(18120)),o=r(62147),u=r(96141),l=r(95197),d=r(77993),c=r(35855),f=r(52303),p=a(r(50935)),h=r(79813);function _(){var e=(0,n.default)(["[offline-resume] classifyOfflineMsgs: skip for "," duplicate messages, with id ",""]);return _=function(){return e},e}function m(){var e=(0,n.default)(["[offline-resume] chat updates: ",""]);return m=function(){return e},e}function g(){var e=(0,n.default)(["[offline-resume] Error: ",", message: ",", stack: ",""]);return g=function(){return e},e}function v(){var e=(0,n.default)(["[offline-resume] storeOfflineMsgs: newMsgs: ",", replaceMsgs: ",", revokeMsgs: ",""]);return v=function(){return e},e}function E(){return(E=(0,i.default)((function*(e){if(s.default.supportsFeature(s.default.F.MD_BACKEND))try{var{newMsgs:t,replaceMsgs:r,revokeMsgs:a,chatsWithNewOfflineMsg:n}=yield b(e);__LOG__(2)(v(),t.length,r.length,a.length);var l=yield y(t),c=yield(0,u.encryptMultipleMsgs)(t,!1);yield(0,f.getTable)().bulkCreateOrReplace(r),yield(0,d.getStorage)().lock(["chat","message","fts-indexing-queue"],function(){var e=(0,i.default)((function*([e,t,r]){yield e.bulkCreateOrMerge(l),yield(0,u.storeEncryptedMessage)(c,n,!1)}));return function(){return e.apply(this,arguments)}}()),yield T(a),yield(0,h.handleOfflineForMessageRange)(e),yield(0,o.checkOrphanMutations)(e.map((e=>e.id.toString())),n)}catch(e){__LOG__(4,void 0,new Error,!0)(g(),e.name,e.message,e.stack),SEND_LOGS("storeOfflineMsgs-error")}}))).apply(this,arguments)}function y(){return S.apply(this,arguments)}function S(){return(S=(0,i.default)((function*(e){var t=new Map;e.forEach((e=>{var r=e.id,a=r.remote.toString();if(a!==p.default.STATUS_WID&&(0,l.isUnreadTypeMsg)(e)){var n=t.get(a)||{unread:0,t:0};r.fromMe||(n.unread+=1),e.t>n.t&&(n.t=Math.max(e.t,n.t)),t.set(a,n)}}));var r=Array.from(t.keys()),a=(yield(0,c.getTable)().bulkGet(r)).map(((e,a)=>{var n=r[a],i=t.get(n),s=(null==i?void 0:i.unread)||0,o=e?e.unreadCount:0,u=(null==i?void 0:i.t)||void 0;return e&&null!=e.t&&(null==u||e.t>u)&&(u=e.t),{id:n,unreadCount:o+s,t:u}}));return __LOG__(2)(m(),JSON.stringify(a)),a}))).apply(this,arguments)}function T(e){var t=[],r=[];return e.forEach((e=>{e.protocolMessageKey&&(t.push(String(e.protocolMessageKey)),r.push(String(e.id)))})),(0,u.processRevokeMsgs)(t,r)}function b(){return A.apply(this,arguments)}function A(){return(A=(0,i.default)((function*(e){var t=yield(0,f.getTable)().bulkGet(e.map((e=>String(e.id))),!1),r=[],a=[],n=[],i=new Set,s=new Map;return e.forEach(((e,o)=>{var u=String(e.id),d=t[o];if(d)if(C(d)){var c=(0,l.convertToMessageRowType)(e);c.t=d.t,c.internalId=d.internalId,c.rowId=d.rowId,a.push(c)}else r.push(e.id.id);else{var f=s.get(u);f&&!C(f)?r.push(e.id.id):"revoke"===e.subtype?n.push(e):(s.set(u,e),i.add(String(e.id.remote)))}})),r.length>0&&__LOG__(2)(_(),r.length,r),{newMsgs:Array.from(s.values()),chatsWithNewOfflineMsg:Array.from(i),replaceMsgs:a,revokeMsgs:n}}))).apply(this,arguments)}function C(e){return e.type===p.default.MSG_TYPE.UNKNOWN&&"fanout"===e.subtype||e.type===p.default.MSG_TYPE.CIPHERTEXT}},87295:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=y.parse(e);if(t.error)return __LOG__(4,void 0,new Error)(g(),t.error.toString(),e.toString()),Promise.reject(t.error);var r=t.success;if(r&&r.refs&&Array.isArray(r.refs)&&6===r.refs.length){var{refs:a,id:n}=r;(0,l.castStanza)((0,s.wap)("iq",{to:s.S_WHATSAPP_NET,type:"result",id:(0,s.CUSTOM_STRING)(n)})),(0,u.generateADVSecretKey)(),v=a,E||(E=new o.ShiftTimer((()=>{if(!(0,f.isRegistered)()&&p.default.online&&c.default.supportsFeature(c.default.F.MD_BACKEND))if(v&&v.length){var e=6===v.length?6e4:2e4,t=v.shift();d.default.set({ref:t,refTTL:e}),_.default.state=_.STATE.UNPAIRED,E&&E.onOrAfter(e)}else E&&E.cancel(),E=null,_.default.state=_.STATE.UNPAIRED_IDLE;else E&&E.cancel(),E=null}))),E.forceRunNow()}else __LOG__(3)(m())};var i=n(r(19976)),s=r(30691),o=r(39329),u=r(12250),l=r(54086),d=n(r(52737)),c=n(r(18120)),f=r(39174),p=n(r(99911)),h=n(r(23767)),_=a(r(12767));function m(){var e=(0,i.default)(["handlePairDevice: wrong pair device result received from server"]);return m=function(){return e},e}function g(){var e=(0,i.default)([""," parsing ",""]);return g=function(){return e},e}var v=[],E=null,y=new h.default("pairDeviceParser",(e=>{e.assertTag("iq"),e.assertFromServer();var t=[];return e.child("pair-device").forEachChild((e=>{e.assertTag("ref"),t.push(e.contentString())})),{refs:t,id:e.attrString("id")}}))},24761:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return R.apply(this,arguments)};var i=n(r(19976)),s=n(r(52954)),o=r(30691),u=r(84139),l=r(68519),d=r(60339),c=r(71684),f=n(r(47677)),p=r(43919),h=r(12250),_=r(54086),m=r(97502),g=n(r(52737)),v=r(72434),E=a(r(15447)),y=r(95595),S=n(r(36398)),T=n(r(40210)),b=r(39174),A=n(r(23767)),C=r(44480),P=r(44762),O=r(75637);function w(){var e=(0,i.default)([""," parsing ",""]);return w=function(){return e},e}var M=!1,I=new A.default("pairSuccessParser",(e=>{var t;e.assertTag("iq"),e.assertFromServer();var r=e.attrString("id"),a=e.child("pair-success"),n=null===(t=a.maybeChild("platform"))||void 0===t?void 0:t.maybeAttrString("name"),i=a.child("device"),s=a.child("device-identity").contentBytes(),o=a.maybeChild("biz"),u=o?o.attrString("name"):"";return{wid:i.attrDeviceWid("jid"),id:r,deviceIdentityBytes:s,businessName:u,platform:n}}));function R(){return(R=(0,s.default)((function*(e){if(!M&&!(0,b.isRegistered)()){M=!0;var t=(0,c.unixTime)(),r=I.parse(e);if(r.error)return __LOG__(4,void 0,new Error)(w(),r.error.toString(),e.toString()),M=!1,Promise.reject(r.error);(0,m.resetCompanionReg)(),(0,y.setGlobalSecurityNotifications)(!0),(0,y.setHistorySyncEarliestDate)(t);var a=r.success,{id:n,wid:i,deviceIdentityBytes:s,platform:A}=a;g.default.blockStoreAdds=!1,A&&(g.default.platform=A);var R=(0,u.decodeProto)(p.ADVSignedDeviceIdentityHMACSpec,s),D=R.details,N=R.hmac;(0,f.default)(null!=D&&null!=N,"ADVSignedDeviceIdentityHMAC should not have empty details or hmac");var L=(0,h.getADVSecretKey)(),k=yield new S.default(L).sign(D);if((0,d.encodeB64)(k)!==(0,d.encodeB64)(N))return(0,_.castStanza)((0,o.wap)("iq",{to:o.S_WHATSAPP_NET,type:"error",id:(0,o.CUSTOM_STRING)(n)},(0,o.wap)("error",{code:"401",text:"not-authorized"}))),(0,m.logoutAfterValidationFail)(),void(M=!1);var U=(0,u.decodeProto)(p.ADVSignedDeviceIdentitySpec,D),F=U.accountSignatureKey;(0,f.default)(null!=F,"accountSignatreKey should not be null");var G=U.accountSignature;(0,f.default)(null!=G,"accountSignature should not be null");var x=yield C.waSignalStore.getRegistrationInfo();if((0,f.default)(null!=x,"Empty regInfo"),E.initDeviceLinkEvent(F,x.identityKeyPair.pubKey,t),E.setDeviceLinkPairStage(T.default.MD_LINK_DEVICE_COMPANION_STAGE.PAIR_SUCCESS_RECEIVED),!(0,h.verifyDeviceIdentityAccountSignature)(U,x.identityKeyPair.pubKey))return(0,_.castStanza)((0,o.wap)("iq",{to:o.S_WHATSAPP_NET,type:"error",id:(0,o.CUSTOM_STRING)(n)},(0,o.wap)("error",{code:"401",text:"not-authorized"}))),E.commitDeviceLinkEvent(401),(0,m.logoutAfterValidationFail)(),void(M=!1);U.deviceSignature=(0,h.generateDeviceSignature)(U,x.identityKeyPair,F),yield C.waSignalStore.putIdentity((0,P.createSignalAddress)((0,O.toUserWid)(i)).toString(),(0,P.bufferToStr)((0,v.toSignalCurvePubKey)(F))),yield(0,h.setADVSignedIdentity)(U);var B=(0,u.decodeProto)(p.ADVDeviceIdentitySpec,U.details).keyIndex;(0,f.default)(null!=B,"keyIndex should not be null"),U.accountSignatureKey=void 0;var Y=(0,l.encodeProto)(p.ADVSignedDeviceIdentitySpec,U).readByteArray();(0,_.castStanza)((0,o.wap)("iq",{to:o.S_WHATSAPP_NET,type:"result",id:(0,o.CUSTOM_STRING)(n)},(0,o.wap)("pair-device-sign",null,(0,o.wap)("device-identity",{"key-index":(0,o.INT)(B)},Y)))),E.setDeviceLinkPairStage(T.default.MD_LINK_DEVICE_COMPANION_STAGE.PAIR_DEVICE_SIGN_SENT),(0,y.setMe)(i),(0,b.getInitialHistorySyncComplete)()||(0,m.startInitialHistorySyncTimeout)(),M=!1}}))).apply(this,arguments)}},26905:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return C.apply(this,arguments)},t.parseNotificationPaymentInfo=P,t.parseMsgPaymentInfo=function(e,t){t&&(e.paymentStatus=(0,p.default)(t.status,"paymentInfo.status"),e.paymentTxnStatus=t.txnStatus,e.paymentCurrency=t.currency||"",e.paymentAmount1000=(0,p.default)((0,s.maybeNumberOrThrowIfTooLarge)(t.amount1000),"maybeNumberOrThrowIfTooLarge(paymentInfo.amount1000)"),e.paymentMessageReceiverJid=(0,g.createWid)((0,p.default)(t.receiverJid,"paymentInfo.receiverJid")),e.paymentExpiryTimestamp=(0,s.maybeNumberOrThrowIfTooLarge)(t.expiryTimestamp),e.paymentTransactionTimestamp=(0,p.default)((0,s.maybeNumberOrThrowIfTooLarge)(t.transactionTimestamp),"maybeNumberOrThrowIfTooLarge(paymentInfo.transactionTimestamp)"))},t.getPaymentWebStatus=O,t.getNotificationTransactionStatus=w,t.getPaymentTxnWebStatus=M,t.PaymentTransactionStatusServerString=t.PaymentTransactionTypeServerString=void 0;var n=a(r(52954)),i=a(r(19976)),s=r(44880),o=r(69627),u=r(95595),l=r(12425),d=a(r(27e3)),c=a(r(58885)),f=a(r(77865)),p=a(r(61941)),h=a(r(23767)),_=r(64658),m=r(21617),g=r(75637);function v(){var e=(0,i.default)([""," parsing ",""]);return v=function(){return e},e}function E(){var e=(0,i.default)(["parsePaymentTransactionType payment transaction string=",""]);return E=function(){return e},e}var y=r(28103)({TYPE_UNSET:0,TYPE_P2P_SENT:1,TYPE_P2P_RCVD:2,TYPE_P2P_GRP:3,TYPE_P2P_NO_INFO:4,TYPE_FUTURE:5,TYPE_P2P_REQ_SENT:10,TYPE_P2P_REQ_RCVD:20,TYPE_P2P_REQ_SCHEDULED_PAYMENT_RCVD:21,TYPE_P2P_REQ_GRP:30,TYPE_P2M_SENT:100,TYPE_P2M_RCVD:200,TYPE_P2M_PAYOUT:300,TYPE_MISSING_DETAILS:400,TYPE_DEPOSIT:500,TYPE_REFUND:600,TYPE_WITHDRAWAL:700}),S=r(28103)({STATUS_UNSET:0,REQUEST_PAY_INIT:11,REQUEST_PAY_SUCCESS:12,REQUEST_PAY_FAILED:13,REQUEST_PAY_FAILED_RISK:14,REQUEST_PAY_REJECTED:15,REQUEST_PAY_EXPIRED:16,REQUEST_PAY_FULFILLED:17,REQUEST_PAY_CANCELLED:18,REQUEST_PAY_CANCELLING:19,REQUEST_PAY_SCHEDULED_PAYMENT_SUCCESS:20,RECV_PAY_INIT:101,RECV_PAY_PENDING_SETUP:102,RECV_PAY_PENDING:103,RECV_PAY_RETRY_ON_FAILURE:104,RECV_PAY_FAILURE:105,RECV_PAY_SUCCESS:106,RECV_PAY_EXPIRED:107,RECV_PAY_FAILURE_RISK:108,RECV_PAY_WITHDRAWAL_PROCESSING:109,RECV_PAY_WITHDRAWAL_FAILURE:110,RECV_PAY_WITHDRAWAL_PERMANENT_FAILED:111,RECV_PAY_SENDER_CANCELED:112,SEND_PAY_INIT:401,SEND_PAY_PENDING_RECEIVER:402,SEND_PAY_PENDING:403,SEND_PAY_REFUND_PENDING:404,SEND_PAY_SUCCESS:405,SEND_PAY_FAILURE:406,SEND_PAY_FAILURE_RISK:407,SEND_PAY_REFUNDED:408,SEND_PAY_REFUND_FAILED:409,SEND_PAY_FAILURE_RECEIVER:410,SEND_PAY_REFUND_FAILED_PROCESSING:411,SEND_PAY_PENDING_REFUND:412,SEND_PAY_AUTH_CANCEL_FAILED_PROCESSING:413,SEND_PAY_AUTH_CANCEL_FAILED:414,SEND_PAY_AUTH_CANCELED:415,SEND_PAY_EXPIRED:416,SEND_PAY_AUTH_SUCCESS:417,SEND_PAY_AUTH_SUCCESS_CANCELING:418,SEND_PAY_IN_REVIEW:419,SEND_PAY_PENDING_PROCESSING:420,SEND_PAY_USER_CANCELED:421,WITHDRAWAL_INIT:601,WITHDRAWAL_PENDING:602,WITHDRAWAL_IN_REVIEW:603,WITHDRAWAL_SUCCESS:604,WITHDRAWAL_FAILED:605,WITHDRAWAL_USER_CANCELED:606,WITHDRAWAL_EXPIRED:607,WITHDRAWAL_ACTIVE:608}),T={TYPE_P2P:"p2p",TYPE_P2M:"p2m",TYPE_P2M_PAYOUT:"payout",TYPE_WITHDRAWAL:"withdrawal",TYPE_DEPOSIT:"deposit",TYPE_REFUND:"refund"};t.PaymentTransactionTypeServerString=T;var b={PENDING_RECEIVER_SETUP:"PENDING_RECEIVER_SETUP",PENDING_SETUP:"PENDING_SETUP",PENDING:"PENDING",INITIAL:"INITIAL",SUCCESS:"SUCCESS",COMPLETED:"COMPLETED",IN_REVIEW:"IN_REVIEW",FAILED:"FAILED",DECLINED:"DECLINED",FAILURE:"FAILURE",FAILED_RISK:"FAILED_RISK",FAILED_PROCESSING:"FAILED_PROCESSING",FAILED_RECEIVER_PROCESSING:"FAILED_RECEIVER_PROCESSING",REFUND_FAILED_PROCESSING:"REFUND_FAILED_PROCESSING",REFUNDED:"REFUNDED",REFUND_FAILED:"REFUND_FAILED",EXPIRED:"EXPIRED",CANCELED:"CANCELLED",AUTH_SUCCESS:"AUTH_SUCCESS",AUTH_CANCELED:"AUTH_CANCELED",AUTH_CANCEL_FAILED_PROCESSING:"AUTH_CANCEL_FAILED_PROCESSING",AUTH_CANCEL_FAILED:"AUTH_CANCEL_FAILED",COLLECT_SUCCESS:"COLLECT_SUCCESS",COLLECT_FAILED:"COLLECT_FAILED",COLLECT_REJECTED:"COLLECT_REJECTED",COLLECT_EXPIRED:"COLLECT_EXPIRED",COLLECT_CANCELED:"COLLECT_CANCELED",FAILED_DA:"FAILED_DA",FAILED_DA_FINAL:"FAILED_DA_FINAL",REFUND_FAILED_DA:"REFUND_FAILED_DA",COLLECT_FAILED_RISK:"COLLECT_FAILED_RISK",WITHDRAWAL_PROCESSING:"WITHDRAWAL_PROCESSING",WITHDRAWAL_FAILURE:"WITHDRAWAL_FAILURE",WITHDRAWAL_PERMANENT_FAILED:"WITHDRAWAL_PERMANENT_FAILED",WITHDRAWAL_ACTIVE:"WITHDRAWAL_ACTIVE"};t.PaymentTransactionStatusServerString=b;var A=new h.default("paymentNotificationParser",(e=>{var t=e.child("transaction"),r=void 0,a=void 0,n=(0,u.getMeUser)(),i=t.attrWid("sender"),s=t.attrWid("receiver"),o=n.equals(i);t.hasAttr("group")?(r=t.attrWid("group"),a=t.attrWid("sender")):r=o?s:i;var l=new f.default({id:t.attrString("message-id"),fromMe:o,remote:r,participant:a}),d=function(e,t){if(e){var r=e.toLowerCase();switch(r){case T.TYPE_P2P:return t?y.TYPE_P2P_SENT:y.TYPE_P2P_RCVD;case T.TYPE_P2M:return t?y.TYPE_P2M_SENT:y.TYPE_P2M_RCVD;case T.TYPE_P2M_PAYOUT:return y.TYPE_P2M_PAYOUT;case T.TYPE_DEPOSIT:return y.TYPE_DEPOSIT;case T.TYPE_REFUND:return y.TYPE_REFUND;case T.TYPE_WITHDRAWAL:return y.TYPE_WITHDRAWAL;default:__LOG__(2)(E(),r)}}return t?y.TYPE_P2P_SENT:y.TYPE_P2P_RCVD}(t.attrString("transaction-type"),l.fromMe),c=parseFloat(t.attrString("amount"));return{receiver:s,currency:t.attrString("currency"),amount1000:1e3*c,status:w(d,t.attrString("status")),ts:t.attrInt("ts"),type:d,msgKey:l}}));function C(){return(C=(0,n.default)((function*(e){var t=A.parse(e);if(t.error)return __LOG__(2)(v(),t.error.toString(),e.toString()),Promise.reject(t.error);var r=t.success,a=(0,p.default)(r.msgKey,"info.msgKey"),n=c.default.get(a),i=n?(0,_.unproxy)(n):yield(0,o.getMsgByMsgKey)(a);if(!i)return Promise.reject(new Error("handlePaymentNotification: no msg found for id ".concat((0,p.default)(r.msgKey,"info.msgKey").toString())));P(i,r);var s=[i instanceof d.default?i.toJSON():i];return(0,l.storeMessages)(s)}))).apply(this,arguments)}function P(e,t){t&&(null!=t.status&&(e.paymentStatus=(0,p.default)(O(S.cast(t.status),t.type),"getPaymentWebStatus(NotificationTransactionStatus.cast(mdPaymentInfo.status), mdPaymentInfo.type)"),e.paymentTxnStatus=(0,p.default)(M(S.cast(t.status)),"getPaymentTxnWebStatus(NotificationTransactionStatus.cast(mdPaymentInfo.status))")),e.paymentCurrency=t.currency||"",e.paymentAmount1000=(0,p.default)(t.amount1000,"mdPaymentInfo.amount1000"),e.paymentMessageReceiverJid=t.receiver,e.paymentTransactionTimestamp=(0,p.default)(t.ts,"mdPaymentInfo.ts"))}function O(e,t){if(null==e)return e;switch(e){case S.SEND_PAY_INIT:case S.SEND_PAY_PENDING:case S.RECV_PAY_INIT:case S.RECV_PAY_PENDING:case S.RECV_PAY_RETRY_ON_FAILURE:case S.REQUEST_PAY_INIT:return m.PaymentInfoStatus.PROCESSING;case S.SEND_PAY_PENDING_RECEIVER:case S.SEND_PAY_FAILURE_RECEIVER:return m.PaymentInfoStatus.SENT;case S.REQUEST_PAY_SUCCESS:return t===y.TYPE_P2P_REQ_SENT?m.PaymentInfoStatus.WAITING_FOR_PAYER:m.PaymentInfoStatus.WAITING;case S.RECV_PAY_PENDING_SETUP:return m.PaymentInfoStatus.NEED_TO_ACCEPT;case S.SEND_PAY_SUCCESS:case S.RECV_PAY_SUCCESS:case S.REQUEST_PAY_FULFILLED:return m.PaymentInfoStatus.COMPLETE;case S.SEND_PAY_FAILURE:case S.SEND_PAY_FAILURE_RISK:case S.SEND_PAY_PENDING_REFUND:case S.SEND_PAY_REFUND_PENDING:case S.SEND_PAY_REFUND_FAILED:case S.SEND_PAY_REFUND_FAILED_PROCESSING:case S.RECV_PAY_FAILURE:case S.REQUEST_PAY_FAILED:case S.REQUEST_PAY_FAILED_RISK:return m.PaymentInfoStatus.COULD_NOT_COMPLETE;case S.SEND_PAY_REFUNDED:return m.PaymentInfoStatus.REFUNDED;case S.RECV_PAY_EXPIRED:case S.REQUEST_PAY_EXPIRED:case S.SEND_PAY_AUTH_CANCELED:case S.SEND_PAY_AUTH_CANCEL_FAILED:case S.SEND_PAY_AUTH_CANCEL_FAILED_PROCESSING:return m.PaymentInfoStatus.EXPIRED;case S.REQUEST_PAY_REJECTED:return m.PaymentInfoStatus.REJECTED;case S.REQUEST_PAY_CANCELLED:return m.PaymentInfoStatus.CANCELLED;case S.STATUS_UNSET:case S.REQUEST_PAY_CANCELLING:default:return m.PaymentInfoStatus.UNKNOWN_STATUS}}function w(e,t){if(!t)return S.STATUS_UNSET;var r=t.toUpperCase();switch(e){case y.TYPE_P2P_SENT:case y.TYPE_P2M_SENT:case y.TYPE_DEPOSIT:switch(r){case b.PENDING_RECEIVER_SETUP:return S.SEND_PAY_PENDING_RECEIVER;case b.FAILED_DA:return S.SEND_PAY_PENDING;case b.REFUND_FAILED_DA:return S.SEND_PAY_REFUND_PENDING;case b.FAILED_RISK:return S.SEND_PAY_FAILURE_RISK;case b.INITIAL:return S.SEND_PAY_INIT;case b.SUCCESS:case b.COMPLETED:return S.SEND_PAY_SUCCESS;case b.FAILURE:case b.FAILED:return S.SEND_PAY_FAILURE;case b.REFUNDED:return S.SEND_PAY_REFUNDED;case b.REFUND_FAILED:return S.SEND_PAY_REFUND_FAILED;case b.FAILED_RECEIVER_PROCESSING:return S.SEND_PAY_FAILURE_RECEIVER;case b.REFUND_FAILED_PROCESSING:return S.SEND_PAY_REFUND_FAILED_PROCESSING;case b.FAILED_DA_FINAL:return S.SEND_PAY_PENDING_REFUND;case b.AUTH_CANCEL_FAILED_PROCESSING:return S.SEND_PAY_AUTH_CANCEL_FAILED_PROCESSING;case b.AUTH_CANCEL_FAILED:return S.SEND_PAY_AUTH_CANCEL_FAILED;case b.AUTH_CANCELED:return S.SEND_PAY_AUTH_CANCELED;case b.EXPIRED:return S.SEND_PAY_EXPIRED;case b.IN_REVIEW:return S.SEND_PAY_IN_REVIEW;case b.PENDING:return S.SEND_PAY_PENDING_PROCESSING;case b.CANCELED:return S.SEND_PAY_USER_CANCELED}break;case y.TYPE_P2P_RCVD:case y.TYPE_P2M_RCVD:switch(r){case b.PENDING_SETUP:return S.RECV_PAY_PENDING_SETUP;case b.FAILED_DA:return S.RECV_PAY_PENDING;case b.FAILED_PROCESSING:return S.RECV_PAY_RETRY_ON_FAILURE;case b.SUCCESS:case b.COMPLETED:return S.RECV_PAY_SUCCESS;case b.FAILURE:case b.FAILED:return S.RECV_PAY_FAILURE;case b.EXPIRED:return S.RECV_PAY_EXPIRED;case b.FAILED_RISK:return S.RECV_PAY_FAILURE_RISK;case b.WITHDRAWAL_PROCESSING:return S.RECV_PAY_WITHDRAWAL_PROCESSING;case b.WITHDRAWAL_FAILURE:return S.RECV_PAY_WITHDRAWAL_FAILURE;case b.WITHDRAWAL_PERMANENT_FAILED:return S.RECV_PAY_WITHDRAWAL_PERMANENT_FAILED;case b.CANCELED:return S.RECV_PAY_SENDER_CANCELED}break;case y.TYPE_P2P_REQ_SENT:case y.TYPE_P2P_REQ_RCVD:switch(r){case b.COLLECT_SUCCESS:return S.REQUEST_PAY_SUCCESS;case b.COLLECT_FAILED:return S.REQUEST_PAY_FAILED;case b.COLLECT_FAILED_RISK:return S.REQUEST_PAY_FAILED_RISK;case b.COLLECT_REJECTED:return S.REQUEST_PAY_REJECTED;case b.COLLECT_EXPIRED:return S.REQUEST_PAY_EXPIRED;case b.COLLECT_CANCELED:return S.REQUEST_PAY_CANCELLED}break;case y.TYPE_P2P_REQ_SCHEDULED_PAYMENT_RCVD:switch(r){case b.COLLECT_SUCCESS:return S.REQUEST_PAY_SCHEDULED_PAYMENT_SUCCESS;case b.AUTH_SUCCESS:return S.SEND_PAY_AUTH_SUCCESS}break;case y.TYPE_REFUND:switch(r){case b.SUCCESS:case b.COMPLETED:return S.RECV_PAY_SUCCESS}break;case y.TYPE_WITHDRAWAL:switch(r){case b.PENDING:return S.WITHDRAWAL_PENDING;case b.IN_REVIEW:return S.WITHDRAWAL_IN_REVIEW;case b.SUCCESS:case b.COMPLETED:return S.WITHDRAWAL_SUCCESS;case b.FAILED:case b.DECLINED:return S.WITHDRAWAL_FAILED;case b.CANCELED:return S.WITHDRAWAL_USER_CANCELED;case b.EXPIRED:return S.WITHDRAWAL_EXPIRED;case b.WITHDRAWAL_ACTIVE:return S.WITHDRAWAL_ACTIVE}break;default:return S.STATUS_UNSET}return S.STATUS_UNSET}function M(e){if(null==e)return e;switch(e){case S.RECV_PAY_EXPIRED:case S.SEND_PAY_EXPIRED:return m.PaymentInfoTxnStatus.EXPIRED_TXN;case S.RECV_PAY_FAILURE:case S.SEND_PAY_FAILURE:return m.PaymentInfoTxnStatus.FAILED;case S.RECV_PAY_INIT:case S.SEND_PAY_INIT:return m.PaymentInfoTxnStatus.INIT;case S.RECV_PAY_PENDING_SETUP:return m.PaymentInfoTxnStatus.PENDING_SETUP;case S.RECV_PAY_PENDING:case S.SEND_PAY_PENDING:return m.PaymentInfoTxnStatus.FAILED_DA;case S.RECV_PAY_RETRY_ON_FAILURE:return m.PaymentInfoTxnStatus.FAILED_PROCESSING;case S.RECV_PAY_SUCCESS:case S.SEND_PAY_SUCCESS:case S.REQUEST_PAY_FULFILLED:return m.PaymentInfoTxnStatus.SUCCESS;case S.REQUEST_PAY_CANCELLED:return m.PaymentInfoTxnStatus.COLLECT_CANCELED;case S.REQUEST_PAY_CANCELLING:return m.PaymentInfoTxnStatus.COLLECT_CANCELLING;case S.REQUEST_PAY_EXPIRED:return m.PaymentInfoTxnStatus.COLLECT_EXPIRED;case S.REQUEST_PAY_FAILED_RISK:return m.PaymentInfoTxnStatus.COLLECT_FAILED_RISK;case S.REQUEST_PAY_FAILED:return m.PaymentInfoTxnStatus.COLLECT_FAILED;case S.REQUEST_PAY_INIT:return m.PaymentInfoTxnStatus.COLLECT_INIT;case S.REQUEST_PAY_REJECTED:return m.PaymentInfoTxnStatus.COLLECT_REJECTED;case S.REQUEST_PAY_SUCCESS:return m.PaymentInfoTxnStatus.COLLECT_SUCCESS;case S.SEND_PAY_AUTH_CANCELED:return m.PaymentInfoTxnStatus.AUTH_CANCELED;case S.SEND_PAY_AUTH_CANCEL_FAILED_PROCESSING:return m.PaymentInfoTxnStatus.AUTH_CANCEL_FAILED_PROCESSING;case S.SEND_PAY_AUTH_CANCEL_FAILED:return m.PaymentInfoTxnStatus.AUTH_CANCEL_FAILED;case S.SEND_PAY_FAILURE_RECEIVER:return m.PaymentInfoTxnStatus.FAILED_RECEIVER_PROCESSING;case S.SEND_PAY_FAILURE_RISK:case S.RECV_PAY_FAILURE_RISK:return m.PaymentInfoTxnStatus.FAILED_RISK;case S.SEND_PAY_PENDING_RECEIVER:return m.PaymentInfoTxnStatus.PENDING_RECEIVER_SETUP;case S.SEND_PAY_PENDING_REFUND:return m.PaymentInfoTxnStatus.FAILED_DA_FINAL;case S.SEND_PAY_REFUNDED:return m.PaymentInfoTxnStatus.REFUNDED_TXN;case S.SEND_PAY_REFUND_FAILED_PROCESSING:return m.PaymentInfoTxnStatus.REFUND_FAILED_PROCESSING;case S.SEND_PAY_REFUND_FAILED:return m.PaymentInfoTxnStatus.REFUND_FAILED;case S.SEND_PAY_REFUND_PENDING:return m.PaymentInfoTxnStatus.REFUND_FAILED_DA;case S.SEND_PAY_IN_REVIEW:return m.PaymentInfoTxnStatus.IN_REVIEW;case S.STATUS_UNSET:return m.PaymentInfoTxnStatus.UNKNOWN;default:return null}}},84935:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var r=c.parse(e);if(r.error)return __LOG__(4,void 0,new Error)(l(),r.error.toString(),e.toString()),Promise.reject(r.error);var a=r.success,n=(0,i.wap)("ack",{to:i.S_WHATSAPP_NET,id:(0,i.CUSTOM_STRING)(a.stanzaId),class:"notification"});return d.has(t)?n:(d.add(t),o.waSignalStore.setServerHasPreKeys(!1),(0,u.uploadPreKeys)().then((()=>n)).finally((()=>{d.delete(t)})))};var n=a(r(19976)),i=r(30691),s=a(r(23767)),o=r(44480),u=r(29738);function l(){var e=(0,n.default)([""," parsing ",""]);return l=function(){return e},e}var d=new Set,c=new s.default("lowKeyParser",(e=>(e.assertTag("notification"),e.assertAttr("type","encrypt"),e.assertFromServer(),{stanzaId:e.attrString("id"),numRemaining:e.child("count").attrInt("value")})))},55199:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=o.parse(e);if(t.error)return __LOG__(4,void 0,new Error)(s(),t.error.toString(),e.toString()),Promise.reject(t.error);return(0,i.default)(t.success)};var n=a(r(19976)),i=a(r(53603));function s(){var e=(0,n.default)([""," parsing ",""]);return s=function(){return e},e}var o=new(a(r(23767)).default)("incomingPresenceParser",(e=>{e.assertTag("presence");var t=e.attrEnumOrDefault("type",{available:"available",unavailable:"unavailable",unsubscribe:"unsubscribe"},"available"),r="deny"===e.maybeAttrString("last")||void 0,a=void 0;return"unavailable"===t&&(e.hasAttr("last")?["deny","none","error"].includes(e.attrString("last"))||(a=e.attrTime("last")):a=Date.now()),{id:e.attrChatWid("from"),type:t,t:a,deny:r}}))},50780:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=_.parse(e);if(t.error)return __LOG__(4,void 0,new Error)(h(),t.error.toString(),e.toString()),Promise.reject(t.error);var r=t.success,a=Promise.resolve();if(r.jid){var n=r.jid;switch(r.type){case"delete":case"set":var l="delete"===r.type?d.PROFILE_PIC_COMMAND.REMOVE:d.PROFILE_PIC_COMMAND.SET;a=(0,c.changeProfilePicThumb)(n,l).then((()=>{if(!n.isGroup())return Promise.resolve();var e=(0,o.genGroupPicChangeNotificationMsg)(r.jid,l,r.ts,r.author||(0,s.getMeUser)(),r.stanzaId);return(0,u.handleSingleMsgMD)(r.jid,e)}));break;case"request":break;default:__LOG__(3)(p())}}return a.then((()=>(0,i.wap)("ack",{id:(0,i.CUSTOM_STRING)(r.stanzaId),to:(0,f.JID)(r.from),class:"notification",type:"picture"})))};var n=a(r(19976)),i=r(30691),s=r(95595),o=r(54978),u=r(39778),l=a(r(23767)),d=r(27886),c=r(95303),f=r(95778);function p(){var e=(0,n.default)(["Invalid type received"]);return p=function(){return e},e}function h(){var e=(0,n.default)([""," parsing ",""]);return h=function(){return e},e}var _=new l.default("incomingProfilePicNotificationParser",(e=>{var t,r;if(e.assertTag("notification"),e.hasChild("delete"))t="delete",r=e.child("delete");else if(e.hasChild("set"))t="set",r=e.child("set");else{if(!e.hasChild("request"))return e.throw("Expected child type to be one of: set, delete, request");t="request",(r=e.child("request")).assertAttrIsMe("jid")}var a=e.attrString("id");return r.hasAttr("jid")?{type:t,from:e.attrChatWid("from"),jid:r.attrChatWid("jid"),author:r.hasAttr("author")?r.attrUserWid("author"):null,ts:e.attrTime("t"),rawTs:e.attrString("t"),stanzaId:a,picId:"set"===t?r.attrInt("id",1):0}:{from:e.attrUserWid("from"),jid:null,type:t,hash:r.attrString("hash"),stanzaId:a}}))},4524:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.handleMessageRetryRequest=function(){return P.apply(this,arguments)},t.handleVoipRetryRequest=function(e){return O(e).then((e=>null!=e))};var n=a(r(19976)),i=a(r(52954)),s=r(30691),o=a(r(50935)),u=r(77725),l=r(95595),d=a(r(40210)),c=a(r(29913)),f=r(86390),p=r(80500),h=r(95778),_=r(75637);function m(){var e=(0,n.default)(["handleRetryRequest error: ",""]);return m=function(){return e},e}function g(){var e=(0,n.default)(["handleRetryRequest: no device "," found for "," for incoming retry request ."]);return g=function(){return e},e}function v(){var e=(0,n.default)(["handleRetryRequest: no requester found for incoming retry request."]);return v=function(){return e},e}function E(){var e=(0,n.default)(["handleRetryRequest: no chat found for incoming retry request."]);return E=function(){return e},e}function y(){var e=(0,n.default)(["handleRetryRequest refusing retry attempt #",""]);return y=function(){return e},e}function S(){var e=(0,n.default)(["handleMessageRetryRequest error: ",""]);return S=function(){return e},e}function T(){var e=(0,n.default)(["handleMessageRetryRequest msg retry not authorized"]);return T=function(){return e},e}function b(){var e=(0,n.default)(["Received null stanzaID when handling message retry request"]);return b=function(){return e},e}function A(){var e=(0,n.default)([""," parsing ",""]);return A=function(){return e},e}function C(){var e=(0,n.default)(["getActualChatId: from is a peer device, but without recipient"]);return C=function(){return e},e}function P(){return(P=(0,i.default)((function*(e){var t=c.default.parse(e);if(t.error)throw __LOG__(4,void 0,new Error)(A(),t.error.toString(),e.toString()),new Error(t.error);var r=t.success,{from:a,participant:n,recipient:i,retryCount:o,stanzaId:u}=r;if(null==u)throw __LOG__(3)(b()),new Error("Received null stanzaID when handling message retry request");var l=(0,s.wap)("ack",{id:(0,s.CUSTOM_STRING)(u),to:(0,h.JID)(a),participant:n?(0,h.DEVICE_JID)(n):s.DROP_ATTR,class:"receipt",type:"retry"}),d=yield O(r);if(null==d)return l;var{originalMsgId:_,chat:m,requester:g}=d;try{var v=yield(0,f.getMsgIfAuthorized)(_,m,g);if(!v)return __LOG__(3)(T()),l;yield(0,p.sendRetry)(a,n,i,v,o)}catch(e){__LOG__(3)(S(),e)}return l}))).apply(this,arguments)}function O(){return w.apply(this,arguments)}function w(){return(w=(0,i.default)((function*(e){var{originalMsgId:t,from:r,participant:a,recipient:n,retryCount:i,offline:s}=e;if(i>=o.default.RETRY.MAX_RETRY)__LOG__(2)(y(),i);else{var l=M(r,n);if(l){var c=l.isUser()?r:a;if(c){var p=c.device||0;try{return(yield(0,u.hasDevice)(c,p))?(yield(0,f.updateLocalSession)(l,e),{originalMsgId:t,chat:l,requester:c}):(__LOG__(3)(g(),p,c.user),void new d.default.MdRetryFromUnknownDevice({offline:s,senderType:p===o.default.DEVICE.PRIMARY_DEVICE?d.default.DEVICE_TYPE.PRIMARY:d.default.DEVICE_TYPE.COMPANION}).commit())}catch(e){__LOG__(3)(m(),e)}}else __LOG__(3)(v())}else __LOG__(3)(E())}}))).apply(this,arguments)}function M(e,t){return e.isUser()?(0,_.toUserWid)(e).equals((0,l.getMeUser)())?t||(__LOG__(3)(C()),null):(0,_.toUserWid)(e):e}},29913:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=new(a(r(23767)).default)("retryRequestParser",(e=>{e.assertTag("receipt"),e.assertAttr("type","retry"),e.hasAttr("to")&&e.assertAttrIsMe("to");var t=e.attrWid("from"),r=e.hasAttr("participant")?e.attrDeviceWid("participant"):null,a=e.hasAttr("recipient")?e.attrUserWid("recipient"):null,n=e.child("retry"),i=e.maybeChild("keys"),s=null;if(null!=i){var o,u=i.child("skey"),l=i.child("key");s={identity:i.child("identity").contentBytes(32),deviceIdentity:null===(o=i.maybeChild("device-identity"))||void 0===o?void 0:o.contentBytes(),skey:{id:u.child("id").contentUint(3),pubkey:u.child("value").contentBytes(32),signature:u.child("signature").contentBytes(64)},key:{id:l.child("id").contentUint(3),pubkey:l.child("value").contentBytes(32)}}}return{stanzaId:e.attrString("id"),originalMsgId:n.attrString("id"),ts:e.attrTime("t"),retryCount:n.hasAttr("count")?n.attrInt("count"):0,regId:e.child("registration").contentUint(4),offline:e.hasAttr("offline"),from:t,participant:r,recipient:a,keyBundle:s}}));t.default=n},86390:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.getMsgIfAuthorized=function(){return O.apply(this,arguments)},t.processKeyBundle=w,t.updateLocalSession=function(){return I.apply(this,arguments)};var n=a(r(70417)),i=a(r(19976)),s=a(r(52954)),o=a(r(50935)),u=r(95595),l=r(99849),d=r(12425),c=a(r(27e3)),f=a(r(77865)),p=r(51878),h=r(32602),_=r(75637);function m(){var e=(0,i.default)(["updateLocalSession: delete local session due to same base key"]);return m=function(){return e},e}function g(){var e=(0,i.default)(["updateLocalSession: delete session because reg does not match, saved: ",", received: ",""]);return g=function(){return e},e}function v(){var e=(0,i.default)(["updateLocalSession: retryCount: ",", offline: ",", has keyBundle: ",""]);return v=function(){return e},e}function E(){var e=(0,i.default)(["processKeyBundle: update local session with the retry key bundle"]);return E=function(){return e},e}function y(){var e=(0,i.default)(["processKeyBundle: update local session with the retry key bundle"]);return y=function(){return e},e}function S(){var e=(0,i.default)(["processKeyBundle: delete session because reg does not match, saved: ",", received: ",""]);return S=function(){return e},e}function T(){var e=(0,i.default)(["processKeyBundle: missing session for retry"]);return T=function(){return e},e}function b(){var e=(0,i.default)(["processKeyBundle: skip due to missing key bundle"]);return b=function(){return e},e}function A(){var e=(0,i.default)(["getMsgIfAuthorized: can not find msg ","."]);return A=function(){return e},e}function C(){return P.apply(this,arguments)}function P(){return(P=(0,s.default)((function*(e){var t=r(58885).default.get(e);if(t&&t.type!==o.default.MSG_TYPE.REVOKED)return t;var a=yield(0,d.getMsgByMsgKey)(e);return a?new c.default(a):null}))).apply(this,arguments)}function O(){return(O=(0,s.default)((function*(e,t,r){var a=new f.default({id:e,remote:t,fromMe:!0,participant:t.isUser()?void 0:(0,u.getMeUser)()}),n=yield C(a);return n?(yield(0,l.isRetryEligible)(n.id,r))?n:null:(__LOG__(3)(A(),a.toString()),null)}))).apply(this,arguments)}function w(){return M.apply(this,arguments)}function M(){return(M=(0,s.default)((function*(e,t,r,a,i){return null!=r&&e&&e.key?i?null==a?(__LOG__(2)(T()),yield h.Session.deleteRemoteInfo(t),!1):a!==r?(__LOG__(2)(S(),a,r),yield h.Session.deleteRemoteInfo(t),!1):(__LOG__(2)(y()),yield h.Session.createSignalSession((0,n.default)({wid:t,regId:r},e)),!0):(__LOG__(2)(E()),yield h.Session.createSignalSession((0,n.default)({wid:t,regId:r},e)),!0):(__LOG__(2)(b()),!1)}))).apply(this,arguments)}function I(){return(I=(0,s.default)((function*(e,t){var{from:a,keyBundle:n,offline:i,originalMsgId:s,participant:l,regId:d,retryCount:c}=t,f=l||a;if(__LOG__(2)(v(),c,i.toString(),(!!n).toString()),e.isGroup()){var E=r(43334).default.get(e);E&&f&&(0,p.markForgetSenderKey)(E.id,[f])}var y=yield h.Session.getRemoteRegId(f);if((0,_.toUserWid)(f).equals((0,u.getMeUser)())&&y!==d)throw new Error("updateLocalSession: detect registration Id change remote: ".concat(d,", local: ").concat(y," for peer device"));return(yield w(n,f,d,y,i))||null!=y&&y!==d&&(__LOG__(2)(g(),y,y),yield h.Session.deleteRemoteInfo(f)),c===o.default.RETRY.VALIDATE_OLD_SESSION?h.Session.saveSessionBaseKey(f,s):c>o.default.RETRY.VALIDATE_OLD_SESSION&&(yield h.Session.hasSameBaseKey(f,s))?(__LOG__(2)(m()),h.Session.deleteRemoteInfo(f)):void 0}))).apply(this,arguments)}},69632:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=h.parse(e);if(t.error)return __LOG__(4,void 0,new Error)(c(),t.error.toString(),e.toString()),Promise.reject(t.error);return function(e){var t=(0,s.wap)("ack",{id:(0,s.CUSTOM_STRING)(e.stanzaId),class:"notification",type:"server",to:(0,s.CUSTOM_STRING)(e.from)});switch(e.type){case p.LOG:return u.upload({reason:"Server request",immediate:!0,force:!0,skipSampling:!1}),Promise.resolve(t);case p.PROPS:return(0,d.queryServerProps)().then((()=>t));case p.ABPROPS:return(0,o.syncABProps)(!1).then((()=>t));default:return __LOG__(3)(f()),Promise.resolve(t)}}(t.success)},t.NOTIFICATION_TYPE=void 0;var i=n(r(19976)),s=r(30691),o=r(87078),u=a(r(3594)),l=n(r(23767)),d=r(6446);function c(){var e=(0,i.default)([""," parsing ",""]);return c=function(){return e},e}function f(){var e=(0,i.default)(['Unsupported notification with type "server",\nblindly ack-ing it and doing nothing']);return f=function(){return e},e}var p=Object.freeze({LOG:"log",PROPS:"props",ABPROPS:"abprops"});t.NOTIFICATION_TYPE=p;var h=new l.default("incomingServerNotificationParser",(e=>{e.assertTag("notification");var t=e.attrString("id"),r=e.attrString("from");return e.hasChild(p.LOG)?{type:p.LOG,stanzaId:t,from:r}:e.hasChild(p.PROPS)?{type:p.PROPS,stanzaId:t,from:r}:e.hasChild(p.ABPROPS)?{type:p.ABPROPS,stanzaId:t,from:r}:{type:null,stanzaId:t,from:r}}))},24914:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.reportOfflineNotifications=function(){if(p.size<1)return;var e=0;[...p.entries()].forEach((([,t])=>{e+=t-1})),new u.default.MdAppStateOfflineNotifications({redundantCount:e}).commit(),p.clear()},t.default=function(e){var t=h.parse(e);if(t.error)return __LOG__(4,void 0,new Error)(f(),t.error.toString(),e.toString()),Promise.reject(t.error);return function(e){if(e.changedCollections){var t=e.changedCollections.map((e=>s.CollectionName.cast(e.name))).filter(Boolean);e.offline&&t.forEach((e=>{var t=p.get(e);null!=t?p.set(e,t+1):p.set(e,1)})),(0,d.markCollectionsForSync)(t)}return Promise.resolve((0,i.wap)("ack",{id:(0,i.CUSTOM_STRING)(e.stanzaId),class:"notification",type:"server_sync",to:(0,c.USER_JID)((0,o.assertGetMe)())}))}(t.success)};var n=a(r(19976)),i=r(30691),s=r(63487),o=r(95595),u=a(r(40210)),l=a(r(23767)),d=r(61392),c=r(95778);function f(){var e=(0,n.default)([""," parsing ",""]);return f=function(){return e},e}var p=new Map,h=new l.default("serverSyncNotification",(e=>{if(e.assertTag("notification"),!e.hasChild("collection"))throw"Server sync notifcation does not contain any collections";var t=e.attrString("id");return{changedCollections:e.mapChildrenWithTag("collection",(e=>({name:e.attrString("name")}))),stanzaId:t,offline:e.hasAttr("offline")}}))},74960:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return m.apply(this,arguments)};var n=a(r(52954)),i=a(r(19976)),s=a(r(79711)),o=r(54086),u=r(97502),l=r(15447),d=a(r(23767)),c=a(r(12767));function f(){var e=(0,i.default)(["stream error due to device removed, logging out"]);return f=function(){return e},e}function p(){var e=(0,i.default)([""," parsing ",""]);return p=function(){return e},e}function h(){var e=(0,i.default)(["Unrecognized stream:error: ",""]);return h=function(){return e},e}var _=new d.default("streamErrorParser",(e=>{if(e.assertTag("stream:error"),!e.hasChild("conflict"))return e.hasAttr("code")?{type:"code",code:e.attrInt("code")}:e.hasChild("ack")?{type:"ack",id:e.child("ack").hasAttr("id")?e.child("ack").attrString("id"):null}:(__LOG__(3)(h(),e.toString()),{type:"other"});switch(e.child("conflict").attrString("type")){case"replaced":return{type:"replaced"};case"device_removed":default:return{type:"device_removed"}}}));function m(){return(m=(0,n.default)((function*(e){var t=_.parse(e);if(t.error)return __LOG__(4,void 0,new Error)(p(),t.error.toString(),e.toString()),Promise.reject(t.error);var r=t.success;if("code"===r.type&&r.code>=500&&r.code<600){if(515===r.code)return(0,u.startLogin)(),Promise.resolve("NO_ACK");if(516===r.code)return(0,l.commitDeviceLinkEvent)(516),(0,u.startLogout)(),Promise.resolve("NO_ACK");(0,o.onStreamErrorReceived)()}else{if("device_removed"===r.type)return(0,o.stopComms)(!0),yield c.default.clearCredentialsAndStoredData(),__LOG__(2)(f()),s.default.logout(),Promise.resolve("NO_ACK");if("replaced"===r.type)return(0,o.stopComms)(),Promise.resolve("NO_ACK")}return Promise.resolve("CLOSE_SOCKET")}))).apply(this,arguments)}},48830:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=h.parse(e);if(t.error)return __LOG__(4,void 0,new Error)(p(),t.error),Promise.reject(t.error);var r=t.success;a=r.ts,n=Math.round(Date.now()/1e3-a),(0,i.setClockSkew)(n),s.default.setSkew(n),o.default.onTemporaryBan({banned:!1});var a,n;var u=r.companionEncStatic;if(c.default.generateFinalDbEncryptionAndFtsKey(u),(0,f.generateFinalDbEncryptionAndFtsKeyForInvoker)(u),null==d.default.serverPropsVersion||d.default.serverPropsVersion<r.propsVersion)return(0,l.queryServerProps)()};var n=a(r(19976)),i=r(71684),s=a(r(19899)),o=a(r(79711)),u=a(r(23767)),l=r(6446),d=a(r(72424)),c=a(r(72291)),f=r(66870);function p(){var e=(0,n.default)(["handleSuccess: failed to parse ",""]);return p=function(){return e},e}var h=new u.default("successParser",(e=>(e.assertTag("success"),{ts:e.attrTime("t"),propsVersion:e.attrInt("props"),companionEncStatic:e.maybeAttrString("companion_enc_static")||"NULL"})))},72790:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=v.parse(e);if(t.error)return __LOG__(4,void 0,new Error)(m(),t.error.toString(),e.toString()),Promise.resolve("NO_ACK");var{callCreator:r,from:a,message:n,payloadTag:s,stanzaId:o}=t.success,c=(0,h.wapNodeToVoipXml)(e),g={elapsed_msec:n.elapsed_msec,epoch_msec:n.epoch_msec,is_offline:n.is_offline,payload:c[2][0],peer_app_version:n.peer_app_version,peer_platform:n.peer_platform,peer_jid:n.peer_jid?n.peer_jid.toString({legacy:!0}):void 0},y=n.call_id;switch(n.type){case p.TYPE.OFFER:return E(a,o,y,r,n.type),(0,d.getDoNotDisturb)()&&!l.default.isFocused?__LOG__(2)(_()):(0,u.handleIncomingCallOffer)(n,g),Promise.resolve("NO_ACK");case p.TYPE.ENC_REKEY:return(0,u.handleIncomingEncRekey)(n,g).then((({shouldRetry:e,retryCount:t})=>{e?(0,f.default)(o,n,t):E(a,o,y,r,p.TYPE.ENC_REKEY)})),Promise.resolve("NO_ACK");case p.TYPE.ACCEPT:case p.TYPE.REJECT:return E(a,o,y,r,n.type),(0,u.handleIncomingSignalingMsg)(n,g),Promise.resolve("NO_ACK");default:return(0,u.handleIncomingSignalingMsg)(n,g),Promise.resolve(function(e,t,r){return(0,i.wap)("ack",{to:(0,h.JID)(e),id:(0,i.CUSTOM_STRING)(t),class:"call",type:(0,i.MAYBE_CUSTOM_STRING)(r)})}(a,o,s))}};var n=a(r(19976)),i=r(30691),s=r(54086),o=(a(r(50935)),r(95595)),u=r(68776),l=a(r(89819)),d=r(17483),c=a(r(23767)),f=a(r(43191)),p=r(31558),h=r(95778);function _(){var e=(0,n.default)(["handleCall: ignoring incoming call offer because do not disturb mode is enabled or screen is locked"]);return _=function(){return e},e}function m(){var e=(0,n.default)([""," parsing ",""]);return m=function(){return e},e}function g(e){return p.TYPE[e.tag().toUpperCase()]||p.TYPE.NONE}var v=new c.default("callParser",(e=>{e.assertTag("call");var t=e.attrWid("from"),r=e.getFirstChild();if(r){var a=r.attrString("call-id"),n=r.attrWid("call-creator"),i={call_id:a,call_creator:n,peer_jid:t,peer_platform:e.hasAttr("platform")?e.attrString("platform"):void 0,peer_app_version:e.hasAttr("version")?e.attrString("version"):void 0,epoch_msec:e.hasAttr("t")?String(1e3*e.attrInt("t")):void 0,elapsed_msec:e.hasAttr("e")?String(1e3*e.attrInt("e")):void 0,type:g(r),common:{call_id:a,peer_jid:t.toString(),type:String(g(r))},isVideoCall:r.hasChild("video"),t:e.attrTime("t")};return{from:e.attrWid("from"),stanzaId:e.attrString("id"),payloadTag:r.tag(),message:i,callCreator:n}}throw new Error("Unrecognized call stanza")}));function E(e,t,r,a,n){var u;switch(n){case p.TYPE.OFFER:u=(0,i.wap)("offer",{"call-id":(0,i.CUSTOM_STRING)(r),"call-creator":(0,h.JID)(a)});break;case p.TYPE.ENC_REKEY:u=(0,i.wap)("enc_rekey",{"call-id":(0,i.CUSTOM_STRING)(r),"call-creator":(0,h.JID)(a)});break;case p.TYPE.ACCEPT:u=(0,i.wap)("accept",{"call-id":(0,i.CUSTOM_STRING)(r),"call-creator":(0,h.JID)(a)});break;case p.TYPE.REJECT:u=(0,i.wap)("reject",{"call-id":(0,i.CUSTOM_STRING)(r),"call-creator":(0,h.JID)(a)})}(0,s.castStanza)((0,i.wap)("receipt",{to:(0,h.JID)(e),id:(0,i.CUSTOM_STRING)(t),from:(0,h.JID)((0,o.getMaybeMeUser)())},u))}},64631:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=h.parse(e);if(t.error)return __LOG__(4,void 0,new Error)(p(),t.error.toString(),e.toString()),Promise.resolve();var r=t.success,a=(0,i.wap)("ack",{id:(0,i.CUSTOM_STRING)((0,o.default)(r.stanzaId,"retryInfo.stanzaId")),to:(0,d.JID)(r.from),class:"receipt",type:"enc_rekey_retry"});return(0,s.handleVoipRetryRequest)(r).then((e=>{if(!e)return __LOG__(3)(f()),l.default.endCall(r.originalMsgId),a;l.default.resendEncRekeyRetry(r.from.toString({legacy:!0,formatFull:!0}),r.retryCount)})).catch((()=>(__LOG__(3)(c()),a)))};var n=a(r(19976)),i=r(30691),s=r(4524),o=a(r(61941)),u=a(r(23767)),l=a(r(64786)),d=r(95778);function c(){var e=(0,n.default)(["voip:handle_enc_rekey_retry_receipt: error while attempting to send enc_rekey retry"]);return c=function(){return e},e}function f(){var e=(0,n.default)(["voip:handle_enc_rekey_retry_receipt: not sending enc_rekey retry"]);return f=function(){return e},e}function p(){var e=(0,n.default)([""," parsing ",""]);return p=function(){return e},e}var h=new u.default("rekeyRetryReceiptParser",(e=>{e.assertTag("receipt"),e.assertAttr("type","enc_rekey_retry");var t=e.child("enc_rekey");return{from:e.attrWid("from"),originalMsgId:t.attrString("call-id"),stanzaId:e.attrString("id"),retryCount:t.hasAttr("count")?t.attrInt("count"):0,regId:e.child("registration").contentUint(4),ts:null,participant:null,recipient:null,keyBundle:null,offline:!1}}))},11974:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"handleCall",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(t,"handleEncRekeyRetryRequest",{enumerable:!0,get:function(){return i.default}});var n=a(r(72790)),i=a(r(64631))},72557:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.extractCertificateDetailsParams=function(e){return{serial:e.serial,name:e.verifiedName,isApi:"ent:wa"===e.issuer}},t.getParsedProtoObjects=function(e){if(!e)return null;var t=(0,a.decodeProto)(n.VerifiedNameCertificateSpec,e);if(!t.details)throw new Error("verifyCertificate cert missing details");if(!t.signature)throw new Error("verifyCertificate cert missing signature");var r=(0,a.decodeProto)(n.DetailsSpec,t.details);return{cert:t,details:r}};var a=r(84139),n=r(84222)},10902:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.startWebPersistedJobManager=function(){return c.apply(this,arguments)},t.newJob=function(e){function t(){var t=l.jobSerializers[e],r=t.apply(null,arguments);return p(r)}return{fireAndForget(){t.apply(null,arguments).then((e=>{(0,i.loadAndRunJobFromId)(e)}))},waitUntilPersisted(){return t.apply(null,arguments).then((e=>{(0,i.loadAndRunJobFromId)(e)}))},waitUntilCompleted(){return t.apply(null,arguments).then((e=>(0,i.loadAndRunJobFromId)(e)))}}};var n=a(r(52954)),i=r(34712),s=r(8320),o=r(71684),u=a(r(66505)),l=r(63016),d=r(88857);function c(){return(c=(0,n.default)((function*(){(0,u.default)(),yield(0,d.initialize)();var e=(0,d.getJobsTable)();(0,i.startPersistedJobManager)({accessors:f(),unfinishedJobEntries:e.all(),isRestartAfterCrash:!1,onJobStarted:()=>{},onJobFinished:()=>null,deprecatedJobs:[]})}))).apply(this,arguments)}function f(){return{deletePersistedJob:e=>(0,d.getJobsTable)().remove(e),updatePersistedJob:e=>(0,d.getJobsTable)().createOrReplace(e),readPersistedJob:e=>(0,d.getJobsTable)().get(e)}}function p(){return h.apply(this,arguments)}function h(){return(h=(0,n.default)((function*(e){var t,r,a=(0,d.getJobsTable)(),n=JSON.stringify([e.type,null!==(t=e.uniqKey)&&void 0!==t?t:(0,s.randomHex)(32)]),u={type:e.type,uniqKey:n,startTime:(0,o.unixTime)(),version:null!==(r=e.version)&&void 0!==r?r:1,original:e.args,current:e.args,step:i.UNSTARTED_JOB,waitUntil:null,stepFirstStartTime:null,stepHardStartCountAfterTimeout:0};if(null==e.uniqKey)return a.createOrReplace(u);var l=yield a.equals(["uniqKey"],[e.uniqKey]);if(0===l.length)return a.createOrReplace(u);var c=[],f=null;for(var p of l)p.step===i.FINISHED_JOB?f=p:c.push(a.remove(p.jobId));return yield Promise.all(c),null!=f?f.jobId:a.createOrReplace(u)}))).apply(this,arguments)}},12126:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.ensureE2ESessions=b,t.handleE2eIdentityChange=function(e){var t=P.parse(e);if(t.error)return __LOG__(4,void 0,new Error)(v(),t.error.toString(),e.toString()),Promise.reject(t.error);var{wid:r,stanzaId:a,delay:i}=t.success;return p.Session.hasSignalSessions([r]).then(function(){var e=(0,n.default)((function*([e]){if(e)if(__LOG__(2)(g(),r.toString()),yield p.Session.deleteRemoteInfo(r),(0,f.addSecurityCodeChangedNotification)(r),null!=i){var t=new u.ShiftTimer((()=>{b([r])}));S.set(r.toString(),t),t.onOrAfter(1e3*i)}else b([r])}));return function(){return e.apply(this,arguments)}}()),Promise.resolve((0,s.wap)("ack",{to:(0,h.DEVICE_JID)(r),id:(0,s.CUSTOM_STRING)(a),class:"notification"}))};var n=a(r(52954)),i=a(r(19976)),s=r(30691),o=r(98970),u=r(39329),l=r(54086),d=a(r(50935)),c=a(r(23767)),f=r(15129),p=r(32602),h=r(95778);function _(){var e=(0,i.default)(["establishE2ESession: successfully established E2E sessions"]);return _=function(){return e},e}function m(){var e=(0,i.default)(["createSignalSession: failed for device "," with error ",""]);return m=function(){return e},e}function g(){var e=(0,i.default)(["handleE2eIdentityChange "," updated, establishing session"]);return g=function(){return e},e}function v(){var e=(0,i.default)([""," parsing ",""]);return v=function(){return e},e}function E(){var e=(0,i.default)(["ensureE2ESession deduped ",""]);return E=function(){return e},e}function y(){var e=(0,i.default)(["ensureE2ESession ",""]);return y=function(){return e},e}var S=new Map,T=new o.PromiseQueueMap;function b(e){var t=e.map((e=>e.toString())).join();e.forEach((e=>{var t=S.get(e.toString());t&&(t.cancel(),S.delete(e.toString()))})),__LOG__(2)(y(),t);var r=T.waitIfPending(t);if(r)return __LOG__(2)(E(),t),r;var a=p.Session.hasSignalSessions(e).then((t=>{var r=e.filter(((e,r)=>!t[r]));if(r.length>0)return function(){return C.apply(this,arguments)}(r)}));return T.enqueueHandlers(t,a)}var A=new c.default("e2eSessionParser",(e=>e.child("list").mapChildren((e=>{if(e.hasChild("error")){var t=e.child("error"),r=t.attrInt("code"),a=t.attrString("text");throw new Error("establishE2ESessionParser bad response: ".concat(r," ").concat(a))}var n=e.child("skey"),i=e.hasChild("key")?e.child("key"):null,s=e.hasChild("device-identity")?e.child("device-identity").contentBytes():null;return{wid:e.attrDeviceWid("jid"),regId:e.child("registration").contentUint(4),identity:e.child("identity").contentBytes(32),deviceIdentity:s,skey:{id:n.child("id").contentUint(3),pubkey:n.child("value").contentBytes(32),signature:n.child("signature").contentBytes(64)},key:i&&{id:i.child("id").contentUint(3),pubkey:i.child("value").contentBytes(32)}}}))));function C(){return(C=(0,n.default)((function*(e,t=!1){var r=e.map((e=>(0,s.wap)("user",{jid:(0,h.DEVICE_JID)(e),reason:t?"identity":s.DROP_ATTR}))),a=(0,s.wap)("iq",{id:(0,s.generateId)(),xmlns:"encrypt",type:"get",to:s.S_WHATSAPP_NET},(0,s.wap)("key",null,r)),n=yield(0,l.sendIq)(a,A);if(!n.success)throw new Error("establishE2ESession bad response ".concat(String(n)));var i=n.result;if(!i||i.length<=0)throw new Error("establishE2ESession: empty keyInfo");var o=[],u=[];i.forEach((e=>{null!=e.wid.device&&e.wid.device!==d.default.DEVICE.PRIMARY_DEVICE?u.push(e):o.push(e)}));var c=e=>p.Session.createSignalSession(e).catch((t=>{__LOG__(4,void 0,new Error,!0)(m(),e.wid,t),SEND_LOGS("createSignalSession-fail")}));yield Promise.all(o.map((e=>c(e)))),yield Promise.all(u.map((e=>c(e)))),__LOG__(2)(_())}))).apply(this,arguments)}var P=new c.default("identityChange",(e=>{e.assertTag("notification"),e.assertAttr("type","encrypt"),e.child("identity");var t=parseInt(e.maybeAttrString("delay"),10);return{wid:e.attrDeviceWid("from"),stanzaId:e.attrString("id"),delay:isFinite(t)&&t>0?t:null}}))},57869:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.getAllContactsFromChatCollectionIntoChunks=function(e=500){var t=[],r=[],a=new Set,n=new Set;for(var i of o.default.toArray())n.size===e&&(t.push(n),n=new Set),i.isBroadcast||(i.isGroup?r.push(i.id):a.has(i.id)||(n.add(i.id),a.add(i.id)));for(var s of r){var u=o.default.get(s)||{};for(var l of null===(d=u.groupMetadata)||void 0===d?void 0:d.participants.toArray()){var d;n.size===e&&(t.push(n),n=new Set),a.has(l.id)||(n.add(l.id),a.add(l.id))}}0!==n.size&&t.push(n);return __LOG__(2)(m(),t.length,e),t},t.getNonAddressBookContactsAndMarkAllContactsDirty=function(){return y.apply(this,arguments)},t.getAndUpdateNonAddressBookContacts=function(){return S.apply(this,arguments)};var n=a(r(52954)),i=a(r(19976)),s=r(41263),o=a(r(43334)),u=r(11008),l=r(77993),d=a(r(68384)),c=r(75637);function f(){var e=(0,i.default)(["[contact sync] get "," non-address book contacts, mark dirty, and update the contact table during the inital sync"]);return f=function(){return e},e}function p(){var e=(0,i.default)(["[contact sync] mark "," contacts dirty during the regular sync"]);return p=function(){return e},e}function h(){var e=(0,i.default)(["[contact sync] found "," contacts from chat and group participant tables"]);return h=function(){return e},e}function _(){var e=(0,i.default)(["[contact sync] found "," contacts with set isAddressBookContact value from contact table"]);return _=function(){return e},e}function m(){var e=(0,i.default)(["[contact sync] get "," chunks of contacts from chat collection, chunk size: ",""]);return m=function(){return e},e}function g(){return v.apply(this,arguments)}function v(){return(v=(0,n.default)((function*(){var e=new Set;return yield(0,u.getParticipantTable)().forEach((t=>{t.participants.forEach((t=>{e.add((0,s.toJid)((0,c.createWid)(t).user))}))})),yield(0,u.getChatTable)().forEach((t=>{d.default.isUser(t.id)&&e.add((0,s.toJid)((0,c.createWid)(t.id).user))})),__LOG__(2)(h(),e.size),Array.from(e)}))).apply(this,arguments)}function E(e){return e.anyOf(["isAddressBookContact"],[1,0]).then((e=>{var t=new Set(e.map((e=>e.id)));return __LOG__(2)(_(),t.size),t}))}function y(){return(y=(0,n.default)((function*(){var e=yield g();return(0,l.getStorage)().lock(["contact"],function(){var t=(0,n.default)((function*([t]){var r=yield E(t),a=Array.from(e).map((e=>r.has(e)?{id:e,isContactSyncCompleted:0}:{id:e,isAddressBookContact:0,isContactSyncCompleted:0}));return __LOG__(2)(p(),a.length),t.bulkCreateOrMerge(a)}));return function(){return t.apply(this,arguments)}}())}))).apply(this,arguments)}function S(){return(S=(0,n.default)((function*(){var e=yield g();return(0,l.getStorage)().lock(["contact"],function(){var t=(0,n.default)((function*([t]){var r=yield E(t),a=e.filter((e=>!r.has(e))).map((e=>({id:e,isAddressBookContact:0,isContactSyncCompleted:0})));return __LOG__(2)(f(),a.length),t.bulkCreateOrMerge(a)}));return function(){return t.apply(this,arguments)}}())}))).apply(this,arguments)}},77609:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.sendPassiveIb=function(e){var t=(0,i.wap)("ib",null,(0,i.wap)("passive",{value:(0,i.CUSTOM_STRING)(String(e))}));(0,s.castStanza)(t)},t.sendPassiveIq=function(e){var t=e?(0,i.wap)("passive",null):(0,i.wap)("active",null),r=(0,i.wap)("iq",{to:i.S_WHATSAPP_NET,xmlns:"passive",type:"set",id:(0,i.generateId)()},t);return(0,s.sendIq)(r,l).then((t=>{if(!t.success){var{errorCode:r,errorText:a}=t;return __LOG__(3)(u(),r,a),{errorCode:r,errorText:a}}__LOG__(2)(o(),String(e))}))};var n=a(r(19976)),i=r(30691),s=r(54086);function o(){var e=(0,n.default)(["sendPassiveIq: passive mode set to ",""]);return o=function(){return e},e}function u(){var e=(0,n.default)(["sendPassiveIq: sever response with ",", ",""]);return u=function(){return e},e}var l=new(a(r(23767)).default)("passiveIqParser",(e=>{e.assertAttr("type","result")}))},63016:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.jobSerializers=void 0;var r={rotateKey:()=>({type:"rotateKey",args:{},uniqKey:"rotateKey"}),setAbout:e=>({type:"setAbout",args:{content:e},uniqKey:"setAbout"}),queryProductList:(e,t,r,a)=>({type:"queryProductList",args:{catalogWid:e.toString(),productIds:t,width:r,height:a},uniqKey:"queryProductList:".concat(t.slice().sort().join(","),":").concat(r,":").concat(a)})};t.jobSerializers=r},66505:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){e={rotateKey:()=>r.e(9970).then(r.bind(r,69970)).then((e=>e.default)),setAbout:()=>r.e(4553).then(r.bind(r,54553)).then((e=>e.default)),queryProductList:()=>r.e(495).then(r.bind(r,21966)).then((e=>e.default))},Object.keys(e).forEach((t=>{e.hasOwnProperty(t)&&(0,n.addPersistedJobImplementation)(t,e[t])}));var e},t.defineWebPersistedJob=function(e){return(0,a.definePersistedJob)(e)};var a=r(10014),n=r(34712)},16006:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,r){var a=(0,i.wap)("iq",{id:(0,i.generateId)(),to:i.S_WHATSAPP_NET,type:"set",xmlns:"w:biz:catalog"},(0,i.wap)("product_catalog_add",{v:"1"},(0,d.productModelToNode)(e),(0,i.wap)("width",null,t.toString()),(0,i.wap)("height",null,r.toString())));return(0,s.sendIq)(a,c,o.parseErrorFields).then((e=>{if(e.success)return e.result;throw null!=e.customError?new u.CatalogEditServerError(e.errorCode,e.customError):new u.ServerStatusCodeError(e.errorCode)}))},t.addProductResponse=void 0;var i=r(30691),s=r(54086),o=r(56154),u=r(19741),l=n(r(23767)),d=a(r(82296)),c=new l.default("addProductResponse",(e=>{e.assertTag("iq"),e.assertFromServer();var t=e.child("product_catalog_add").child("product");return(0,d.default)(t)}));t.addProductResponse=c},9571:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var r=(0,n.wap)("iq",{id:(0,n.generateId)(),to:n.S_WHATSAPP_NET,type:"set",xmlns:"fb:thrift_iq"},(0,n.wap)("request",{type:"appeal_product"},(0,n.wap)("reason",null,t),(0,n.wap)("id",null,e)));return(0,i.sendIq)(r,o).then((e=>{if(e.success)return e.result;throw new s.ServerStatusCodeError(e.errorCode)}))},t.appealProductResponse=void 0;var n=r(30691),i=r(54086),s=r(19741),o=new(a(r(23767)).default)("appealProductResponse",(e=>(e.assertTag("iq"),e.assertFromServer(),"true"===e.child("response").child("success").contentString())));t.appealProductResponse=o},95295:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){var e=(0,n.wap)("iq",{id:(0,n.generateId)(),to:n.S_WHATSAPP_NET,type:"set",xmlns:"w:biz:catalog"},(0,n.wap)("product_catalog_create",{version:"1"}));return(0,i.sendIq)(e,o).then((e=>{if(e.success)return e.result;throw new s.ServerStatusCodeError(e.errorCode)}))},t.productCatalogCreateResponse=void 0;var n=r(30691),i=r(54086),s=r(19741),o=new(a(r(23767)).default)("productCatalogCreateResponse",(e=>{e.assertTag("iq"),e.assertFromServer(),e.child("product_catalog_create")}));t.productCatalogCreateResponse=o},48245:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=(0,n.wap)("iq",{id:(0,n.generateId)(),to:n.S_WHATSAPP_NET,type:"set",xmlns:"w:biz:catalog"},(0,n.wap)("product_catalog_delete",{v:"1"},e.map((e=>(0,n.wap)("product",null,(0,n.wap)("id",null,e))))));return(0,i.sendIq)(t,o).then((e=>{if(e.success)return e.result;throw new s.ServerStatusCodeError(e.errorCode)}))},t.productDeleteResponse=void 0;var n=r(30691),i=r(54086),s=r(19741),o=new(a(r(23767)).default)("productDeleteResponse",(e=>(e.assertTag("iq"),e.assertFromServer(),{deletedCount:e.child("product_catalog_delete").attrInt("deleted_count")})));t.productDeleteResponse=o},3709:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,r){var a=(0,i.wap)("iq",{id:(0,i.generateId)(),to:i.S_WHATSAPP_NET,type:"set",xmlns:"w:biz:catalog"},(0,i.wap)("product_catalog_edit",{v:"1"},(0,d.productModelToNode)(e),(0,i.wap)("width",null,t.toString()),(0,i.wap)("height",null,r.toString())));return(0,s.sendIq)(a,c,o.parseErrorFields).then((e=>{if(e.success)return e.result;throw e.customError?new u.CatalogEditServerError(e.errorCode,e.customError):new u.ServerStatusCodeError(e.errorCode)}))};var i=r(30691),s=r(54086),o=r(56154),u=r(19741),l=n(r(23767)),d=a(r(82296)),c=new l.default("editProductResponse",(e=>{e.assertTag("iq"),e.assertFromServer();var t=e.child("product_catalog_edit").child("product");return(0,d.default)(t)}))},82296:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.productModelToNode=function(e){var t,r=e.id?(0,i.wap)("id",null,e.id.toString()):void 0,a=e.description?(0,i.wap)("description",null,e.description):void 0,n=e.url?(0,i.wap)("url",null,e.url):void 0,s=e.retailerId?(0,i.wap)("retailer_id",null,e.retailerId):void 0,o=null!=e.priceAmount1000?(0,i.wap)("currency",null,e.currency):void 0,u=null!=e.priceAmount1000?(0,i.wap)("price",null,e.priceAmount1000.toString()):void 0,l=[(0,i.wap)("image",null,(0,i.wap)("url",null,e.imageCdnUrl))].concat(null===(t=e.additionalImageCdnUrl)||void 0===t?void 0:t.map((e=>(0,i.wap)("image",null,(0,i.wap)("url",null,e)))));return(0,i.wap)("product",{is_hidden:e.isHidden?"true":"false"},r,(0,i.wap)("name",null,e.name),a,n,s,(0,i.wap)("media",null,l),u,o)},t.parseLegacyProductErrorReason=function(e){if(null!=e){var t=Object.keys(e)[0];return[{name:t,reason:e[t]||"",detail:e.detail}]}return[]},t.default=t.parseProductSalePriceNode=void 0;var n=a(r(70417)),i=r(30691),s=e=>{var t,r,a;if(null===(t=e.maybeChild("price"))||void 0===t?void 0:t.contentString())return{sale_price:parseInt(e.child("price").contentString(),10),sale_start_date:null===(r=e.maybeChild("start_date"))||void 0===r?void 0:r.contentString(),sale_end_date:null===(a=e.maybeChild("end_date"))||void 0===a?void 0:a.contentString()}};t.parseProductSalePriceNode=s;var o=e=>{var t,r=e.child("id").contentString(),a=e.maybeChild("url"),i="";a&&a.hasContent()&&(i=a.contentString());var o=e.child("name").contentString(),u=e.maybeChild("description"),l=u?u.contentString():"",d=[],c=[],f=[],p=e.child("media"),h=!0;p.forEachChildWithTag("image",(e=>{if(h)h=!1,d.push({key:"requested",value:e.child("request_image_url").contentString()}),d.push({key:"full",value:e.child("original_image_url").contentString()}),f.push(e.child("id").contentString());else{var t=[];t.push({key:"requested",value:e.child("request_image_url").contentString()}),t.push({key:"full",value:e.child("original_image_url").contentString()}),c.push(t),f.push(e.child("id").contentString())}}));var _=e.maybeChild("status_info"),m=(null==_?void 0:_.child("status").contentString())||"APPROVED",g=null==_||null===(t=_.maybeChild("can_appeal"))||void 0===t?void 0:t.contentString(),v=e.maybeChild("currency"),E=v?v.contentString():void 0,y=e.maybeChild("price"),S=y?parseInt(y.contentString(),10):null,T=e.maybeChild("retailer_id"),b=T?T.contentString():"",A=!!e.hasAttr("is_hidden")&&"true"===e.attrString("is_hidden"),C=e.maybeChild("sale_price"),P=C?s(C):null;return(0,n.default)({id:r,is_hidden:A,url:i,name:o,description:l,additional_image_cdn_urls:c,image_cdn_urls:d,capability_to_review_status:[{key:"WHATSAPP",value:m}],whatsapp_product_can_appeal:"true"===g,image_hashes_for_whatsapp:f,currency:E,price:S,retailer_id:b},P)};t.default=o},89370:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=(0,n.wap)("iq",{to:n.S_WHATSAPP_NET,type:"set",xmlns:"w:biz:catalog",smax_id:"23",id:(0,n.generateId)()},(0,n.wap)("product_visibility_update",{v:"1"},e.map((e=>(0,n.wap)("product",{is_hidden:e.isHidden?"true":"false"},(0,n.wap)("id",null,e.productId))))));return(0,i.sendIq)(t,o).then((e=>{if(e.success)return e.result;throw new s.ServerStatusCodeError(e.errorCode)}))};var n=r(30691),i=r(54086),s=r(19741),o=new(a(r(23767)).default)("visibilitySetResponse",(e=>{e.assertTag("iq"),e.assertFromServer()}))},41653:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.queryCollections=function(e,t,r,a,o,u,d){var f=t?(0,n.wap)("after",null,t):void 0,p=(0,n.wap)("iq",{to:n.S_WHATSAPP_NET,type:"get",xmlns:"w:biz:catalog",id:(0,n.generateId)(),smax_id:"35"},(0,n.wap)("collections",{biz_jid:(0,l.DEVICE_JID)(e),empty_collection:(0,n.CUSTOM_STRING)(o.toString())},(0,n.wap)("collection_limit",null,r.toString()),(0,n.wap)("item_limit",null,a.toString()),(0,n.wap)("width",null,u.toString()),(0,n.wap)("height",null,d.toString()),f));return(0,i.sendIq)(p,c).then((e=>{if(e.success)return e.result;throw new s.ServerStatusCodeError(e.errorCode)}))},t.querySingleCollection=function(e,t,r,a,o,u){var d=r?(0,n.wap)("after",null,r):void 0,c=(0,n.wap)("iq",{to:n.S_WHATSAPP_NET,type:"get",xmlns:"w:biz:catalog",id:(0,n.generateId)(),smax_id:"30"},(0,n.wap)("collection",{biz_jid:(0,l.DEVICE_JID)(e),id:(0,n.CUSTOM_STRING)(t)},(0,n.wap)("limit",null,a.toString()),(0,n.wap)("width",null,o.toString()),(0,n.wap)("height",null,u.toString()),d));return(0,i.sendIq)(c,f).then((e=>{if(e.success)return e.result;throw new s.ServerStatusCodeError(e.errorCode)}))};var n=r(30691),i=r(54086),s=r(19741),o=a(r(23767)),u=a(r(82296)),l=r(95778),d=e=>{var t,r=e.maybeChild("status_info"),a=r?r.child("status").contentString():"APPROVED",n={id:e.child("id").contentString(),name:e.child("name").contentString(),isHidden:"TRUE"===(null===(t=e.maybeChild("is_hidden"))||void 0===t?void 0:t.contentString()),reviewStatus:a,totalItemsCount:parseInt(e.child("item_count").contentString(),10),products:[]};return e.forEachChildWithTag("product",(e=>{n.products.push((0,u.default)(e))})),n},c=new o.default("collectionsResponse",(e=>{e.assertTag("iq"),e.assertFromServer();var t=e.child("collections"),r=[];t.forEachChildWithTag("collection",(e=>{r.push(d(e))}));var a=t.child("paging").child("after"),n=a.hasContent()?a.contentString():"";return{collections:r,afterCursor:n}}));var f=new o.default("singleCollectionResponse",(e=>{e.assertTag("iq"),e.assertFromServer();var t=e.child("collection"),r=d(t),a=t.child("paging").child("after");return{collections:[r],afterCursor:a.hasContent()?a.contentString():""}}))},49434:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.fetchAndUpdateBlocklist=function(){return(f.default.mdBlocklistV2?m:l.getBlocklist)().then(function(){var e=(0,n.default)((function*(e){return null!=e.errorCode||e.dhash&&((0,d.setBlocklistHash)(e.dhash),yield(0,o.updateBlocklist)(e.wids)),e}));return function(){return e.apply(this,arguments)}}())};var n=a(r(52954)),i=a(r(19976)),s=r(30691),o=r(68205),u=r(54086),l=r(85142),d=r(39174),c=a(r(23767)),f=a(r(72424));function p(){var e=(0,i.default)(["fetchBlocklist: failed ",", ",""]);return p=function(){return e},e}function h(){var e=(0,i.default)(["getBlocklist error: code "," text ",""]);return h=function(){return e},e}var _=new c.default("blocklistParser",(e=>{var t,r,a,n={wids:[]};if(e.hasChild("error"))return t=e.child("error"),r=t&&t.maybeAttrString("code"),a=t&&t.maybeAttrString("text"),__LOG__(3,void 0,void 0,!0)(h(),r,a),SEND_LOGS("getBlocklist"),n;e.assertAttr("type","result");var i=e.maybeChild("list");if(i){var s=i.maybeAttrString("dhash");s&&(n.dhash=s),i.hasChild("item")&&(n.wids=i.mapChildrenWithTag("item",(e=>e.attrUserWid("jid")))||[])}return n}));function m(){var e=(0,d.getBlocklistHash)(),t=(0,s.wap)("iq",{xmlns:"blocklist",to:s.S_WHATSAPP_NET,type:"get",id:(0,s.generateId)()},e?(0,s.wap)("item",{dhash:(0,s.CUSTOM_STRING)(e)}):null);return(0,u.sendIq)(t,_).then((e=>{if(e.success)return e.result?e.result:Promise.reject(new Error("response does not have blocked list"));var{errorCode:t,errorText:r}=e;return __LOG__(3)(p(),t,r),{errorCode:t,errorText:r}}))}},12714:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.queryBusinessCategories=function(e){var t=(0,n.wap)("iq",{to:n.S_WHATSAPP_NET,xmlns:"fb:thrift_iq",id:(0,n.generateId)(),type:"get"},(0,n.wap)("request",{op:"typeahead",type:"catkit",v:"1"},(0,n.wap)("query",null,e)));return(0,i.sendIq)(t,o).then((e=>{if(e.success)return e.result;throw new s.ServerStatusCodeError(e.errorCode)}))};var n=r(30691),i=r(54086),s=r(19741),o=new(a(r(23767)).default)("businessCategoriesResponse",(e=>{e.assertTag("iq"),e.assertFromServer();var t=e.child("response"),r=[];t.child("not_a_biz").forEachChildWithTag("category",(e=>{var t=e.attrString("id"),a=e.contentString();r.push({id:t,localized_display_name:a,not_a_biz:!0})})),r.length=1;var a=r[0].id;return t.child("categories").forEachChildWithTag("category",(e=>{var t=e.attrString("id");if(t!==a){var n=e.contentString();r.push({id:t,localized_display_name:n,not_a_biz:!1})}})),r}))},46618:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var r=(0,n.wap)("iq",{to:n.S_WHATSAPP_NET,xmlns:"w:biz",id:(0,n.generateId)(),type:"get"},(0,n.wap)("business_profile",{v:(0,n.INT)(t)},e.map((e=>(0,n.wap)("profile",{jid:(0,l.USER_JID)(e.wid),tag:null!=e.tag?(0,n.INT)(e.tag):n.DROP_ATTR})))));return(0,s.sendIq)(r,d).then((e=>{if(e.success)return e.result;throw new o.ServerStatusCodeError(e.errorCode)}))};var n=r(30691),i=a(r(9492)),s=r(54086),o=r(19741),u=a(r(23767)),l=r(95778),d=new u.default("businessProfileResponse",(e=>{e.assertTag("iq"),e.assertFromServer();var t=e.child("business_profile"),r=[];return t.forEachChildWithTag("profile",(e=>{var t=e.attrWid("jid"),a=e.attrString("tag"),n=(0,i.default)(e);Object.keys(n).length?r.push({wid:t,tag:a,profile:n}):r.push({wid:t,tag:a})})),r}))},14167:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,r,a,o){var u=t?(0,n.wap)("after",null,t):void 0,c=(0,n.wap)("iq",{to:n.S_WHATSAPP_NET,type:"get",xmlns:"w:biz:catalog",id:(0,n.generateId)()},(0,n.wap)("product_catalog",{jid:(0,l.DEVICE_JID)(e)},(0,n.wap)("limit",null,r.toString()),(0,n.wap)("width",null,a.toString()),(0,n.wap)("height",null,o.toString()),u));return(0,i.sendIq)(c,d).then((e=>{if(e.success)return e.result;throw new s.ServerStatusCodeError(e.errorCode)}))};var n=r(30691),i=r(54086),s=r(19741),o=a(r(23767)),u=a(r(82296)),l=r(95778),d=new o.default("catalogResponse",(e=>{e.assertTag("iq"),e.assertFromServer();var t=e.child("product_catalog"),r=[];t.forEachChildWithTag("product",(e=>{e.maybeChild("id")&&r.push((0,u.default)(e))}));var a=t.child("paging"),n=a.child("before"),i=n.hasContent()?n.contentString():"",s=a.child("after"),o=s.hasContent()?s.contentString():"";return{data:r,paging:{cursors:{after:o,before:i}}}}))},95779:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,r,a){var o=(0,n.wap)("iq",{to:n.S_WHATSAPP_NET,type:"get",xmlns:"w:biz:catalog",id:(0,n.generateId)()},(0,n.wap)("product",{jid:(0,l.DEVICE_JID)(e)},(0,n.wap)("product_id",null,t),(0,n.wap)("width",null,r.toString()),(0,n.wap)("height",null,a.toString())));return(0,i.sendIq)(o,d).then((e=>{if(e.success)return{data:e.result};throw new s.ServerStatusCodeError(e.errorCode)}))};var n=r(30691),i=r(54086),s=r(19741),o=a(r(23767)),u=a(r(82296)),l=r(95778),d=new o.default("productResponse",(e=>{e.assertTag("iq"),e.assertFromServer();var t=e.child("product_catalog").child("product");return(0,u.default)(t)}))},98627:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.queryExist=function(e){var t=(new i.USyncQuery).withContactProtocol();return t.withUser((new n.USyncUser).withPhone(e)),t.withBusinessProtocol(),t.execute().then((e=>{var t=e.error.all||e.error.contact;if(t)return Promise.reject(new a.ServerStatusCodeError(t.errorCode,t.errorText));var{list:r}=e;if(1===r.length){var{id:n,contact:i,business:s}=r[0];if(i&&"in"===i.type)return{wid:n,biz:!!s,bizInfo:s}}return null}))};var a=r(19741),n=r(26085),i=r(93116)},95084:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.queryMediaConn=function(e){var t=new Date,r=(0,o.unixTime)(),a=(0,s.wap)("iq",{to:s.S_WHATSAPP_NET,xmlns:"w:m",type:"set",id:(0,s.generateId)()},(0,s.wap)("media_conn",null)),i=(0,u.sendIq)(a,C).then((e=>{if(e.success){__LOG__(2)(v(),e.result.hosts.length);var{auth:a,authTTL:i,ttl:s,hosts:o,maxBuckets:u}=e.result;if(!a||null==s||!o||0===o.length)throw __LOG__(2)(g(),String(!!a)),__LOG__(2)(m(),String(!!s)),__LOG__(2)(_(),String(!!o)),o&&__LOG__(2)(h(),o.length),__LOG__(4,void 0,new Error,!0)(p()),SEND_LOGS("backend:queryMediaConnections unexpected mediaConn"),new Error("Invalid mediaConn");return(0,n.default)({queryStartTime:t,auth:a,hosts:o,ttl:s-r,maxBuckets:u},null!=i?{authTTL:i-r}:null)}throw __LOG__(4,void 0,new Error,!0)(E(),e.errorCode,e.errorText),SEND_LOGS("backend:queryMediaConn: fail"),new l.ServerStatusCodeError(e.errorCode,e.errorText)}));return(0,f.default)(i,e)},t.mediaConnParser=void 0;var n=a(r(70417)),i=a(r(19976)),s=r(30691),o=r(71684),u=r(54086),l=r(19741),d=a(r(81135)),c=a(r(23767)),f=a(r(53827));function p(){var e=(0,i.default)(["Assertion failed!"]);return p=function(){return e},e}function h(){var e=(0,i.default)(["backend:queryMediaConnections: hosts.length ",""]);return h=function(){return e},e}function _(){var e=(0,i.default)(["backend:queryMediaConnections: hosts exists ",""]);return _=function(){return e},e}function m(){var e=(0,i.default)(["backend:queryMediaConnections: ttl exists ",""]);return m=function(){return e},e}function g(){var e=(0,i.default)(["backend:queryMediaConnections: auth exists ",""]);return g=function(){return e},e}function v(){var e=(0,i.default)(["backend:queryMediaConn: got "," hosts"]);return v=function(){return e},e}function E(){var e=(0,i.default)(["response: "," ",""]);return E=function(){return e},e}function y(){var e=(0,i.default)(["media tag: ",""]);return y=function(){return e},e}function S(){var e=(0,i.default)(["Assertion failed!"]);return S=function(){return e},e}function T(){var e=(0,i.default)(["backend:queryMediaConnections: hostname is undefined"]);return T=function(){return e},e}function b(){var e=(0,i.default)(["Assertion failed!"]);return b=function(){return e},e}function A(){var e=(0,i.default)(["backend:queryMediaConnections mediaConn not exists"]);return A=function(){return e},e}var C=new c.default("mediaConnParser",(e=>{if(!e.hasChild("media_conn"))throw __LOG__(2)(A()),__LOG__(4,void 0,new Error,!0)(b()),SEND_LOGS("backend:queryMediaConnections unexpected mediaConn"),new Error("Invalid mediaConn");var t=e.child("media_conn"),r={hosts:function(e){return e.mapChildrenWithTag("host",(e=>{var t,r=e.maybeAttrString("hostname");if(!r)throw __LOG__(2)(T()),__LOG__(4,void 0,new Error,!0)(S()),SEND_LOGS("backend:queryMediaConnections: unexpected media hosts"),new Error("Invalid mediaHost");var a=e.hasAttr("type")?"fallback"===e.attrString("type")?"fallback":"primary":null,n=e.maybeAttrString("class"),i={};e.hasAttr("ip4")&&(i.ip4=e.attrString("ip4")),e.hasAttr("ip6")&&(i.ip6=e.attrString("ip6"));var s=[],o=P(e,"download");o.length>0&&s.push({download:o});var u=P(e,"upload");u.length>0&&s.push({upload:u});var l=null===(t=e.maybeChild("download_buckets"))||void 0===t?void 0:t.mapChildren((e=>e.tag()));return null!=l&&l.length>0&&s.push({downloadBuckets:l}),{hostname:r,ips:[i],type:a,class:n,rules:s.length>0?s:null}}))}(t)};return t.hasAttr("auth")&&(r.auth=t.attrString("auth")),t.hasAttr("auth_ttl")&&(r.authTTL=t.attrFutureTime("auth_ttl")),t.hasAttr("ttl")&&(r.ttl=t.attrFutureTime("ttl")),t.hasAttr("max_buckets")&&(r.maxBuckets=t.attrInt("max_buckets")),r}));function P(e,t){return e.hasChild(t)?e.child(t).mapChildren((e=>{var t=e.tag(),r=t===d.default.PPIC?null:t;return r||(__LOG__(4,void 0,new Error,!0)(y(),t),SEND_LOGS("backend:queryMediaConnections: unsupported media tag"),null)})).filter(Boolean):Object.keys(d.default).map((e=>d.default[e]))}t.mediaConnParser=C},73095:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.getBlockedContacts=function(){var e=(0,i.wap)("iq",{to:i.S_WHATSAPP_NET,type:"get",id:(0,i.generateId)(),xmlns:"privacy"},(0,i.wap)("privacy",null,(0,i.wap)("list",{name:(0,i.CUSTOM_STRING)("groupadd"),value:(0,i.CUSTOM_STRING)("contact_blacklist")})));return(0,s.sendIq)(e,h).then((e=>e.success?e.result:Promise.reject(new Error("invalid response"))))},t.getPrivacy=function(){var e=(0,i.wap)("iq",{xmlns:"privacy",to:i.S_WHATSAPP_NET,type:"get",id:(0,i.generateId)()},(0,i.wap)("privacy",null));return(0,s.sendIq)(e,p).then((e=>e.success?e.result:Promise.reject(new Error("invalid response"))))},t.GROUP_ADD=t.ALL_NONE=void 0;var n=a(r(19976)),i=r(30691),s=r(54086),o=a(r(23767));function u(){var e=(0,n.default)(["getPrivacy error: "," code "," text ",""]);return u=function(){return e},e}var l={all:"all",contacts:"contacts",none:"none",error:"error"},d={all:"all",none:"none",error:"error"};t.ALL_NONE=d;var c={all:"all",contacts:"contacts",contact_blacklist:"contact_blacklist",none:"none",error:"error"};function f(e,t){var r=t.maybeChild("error"),a=r&&r.maybeAttrString("code"),n=r&&r.maybeAttrString("text");__LOG__(3,void 0,void 0,!0)(u(),e,a,n),SEND_LOGS("getPrivacy")}t.GROUP_ADD=c;var p=new o.default("privacyParser",(e=>{e.assertAttr("type","result");var t={};return e.child("privacy").forEachChildWithTag("category",(e=>{switch(e.attrString("name")){case"readreceipts":var r=e.attrEnum("value",d);"error"!==r?t.readReceipts=r:f("readreceipts",e);break;case"last":var a=e.attrEnum("value",l);"error"!==a?t.lastSeen=a:f("last",e);break;case"profile":var n=e.attrEnum("value",l);"error"!==n?t.profilePicture=n:f("profile",e);break;case"status":var i=e.attrEnum("value",l);"error"!==i?t.about=i:f("status",e);break;case"groupadd":var s=e.attrEnum("value",c);"error"!==s?t.groupAdd=s:f("groupadd",e);break;default:f("unknown type",e)}})),t})),h=new o.default("getContactsBlacklistParser",(e=>{var t=e.child("privacy").maybeChild("list");return null==t?{status:"match"}:{status:"mismatch",users:t.mapChildren((e=>e.attrUserWid("jid")))}}))},36876:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){var e=(0,n.wap)("iq",{xmlns:"w",id:(0,n.generateId)(),type:"get",to:n.S_WHATSAPP_NET},(0,n.wap)("props",null));return(0,i.sendIq)(e,s)};var n=r(30691),i=r(54086),s=new(a(r(23767)).default)("serverProps",(e=>{e.assertTag("iq"),e.assertAttr("from","s.whatsapp.net");var t=e.child("props"),r={serverPropsVersion:t.attrInt("version")};return t.forEachChildWithTag("prop",(e=>{switch(e.attrString("name")){case"bsp_system_message_enabled":r.bspSystemMessageEnabled=1===e.attrInt("value");break;case"bsp_ui":r.bspUi=e.attrInt("value");break;case"web_ctwa_context_compose_enabled":r.ctwaContextCompose=1===e.attrInt("value");break;case"ctwa_context_enabled":r.ctwaContextRender=1===e.attrInt("value")?1:0;break;case"ephemeral_messages_enabled":r.ephemeralMessages=e.attrInt("value");break;case"ephemeral_messages_setting":r.ephemeralMessagesSetting=e.attrInt("value");break;case"ephemeral_messages_allowed_values":r.ephemeralMessagesAllowedValues=e.attrString("value");break;case"ephemeral_pruning_enabled":r.ephemeralPruning=e.attrInt("value");break;case"frequently_forwarded_group_setting":r.frequentlyForwardedGroupSetting=e.attrInt("value");break;case"frequently_forwarded_max":r.frequentlyForwardedMax=e.attrInt("value");break;case"frequently_forwarded_messages":r.frequentlyForwardedMessages=e.attrInt("value");break;case"frequently_forwarded_threshold":r.frequentlyForwardedThreshold=e.attrInt("value");break;case"web_gif_search":r.gifSearch=e.attrString("value");break;case"group_call_max_participants":r.groupCallMaxParticipants=e.attrInt("value",0);break;case"group_description_length":r.groupDescLength=e.attrInt("value");break;case"image_max_edge":r.imageMaxEdge=e.attrInt("value");break;case"image_max_kbytes":r.imageMaxKbytes=e.attrInt("value");break;case"image_quality":r.imageQuality=e.attrInt("value")/100;break;case"max_participants":r.maxParticipants=e.attrInt("value");break;case"max_subject":r.maxSubject=e.attrInt("value");break;case"max_keys":r.maxKeys=e.attrInt("value");break;case"media":r.media=e.attrInt("value");break;case"multicast_limit_global":r.multicastLimitGlobal=e.attrInt("value");break;case"mute_always":r.muteAlways=e.attrInt("value");break;case"mms_media_key_ttl":r.mmsMediaKeyTTL=e.attrInt("value");break;case"new_commerce_entry_point_enabled":r.newCommerceEntryPointEnabled=e.attrInt("value");break;case"web_shops_chat_header_button_enabled":r.webShopsChatHeaderButtonEnabled=1===e.attrInt("value",0);break;case"shops_profile_drawer_entrypoint":r.shopsProfileDrawerEntrypoint=1===e.attrInt("value",0);break;case"mms_hot_content_timespan_in_seconds":r.mmsHotContentTimespan=e.attrInt("value");break;case"mms_vcache_aggregation_enabled":r.mmsVCacheAggregationEnabled=1===e.attrInt("value");break;case"product_media_attachments":r.productMediaAttachments=e.attrInt("value");break;case"quick_message_search_enabled":r.quickMessageSearch=e.attrInt("value");break;case"syncd_inline_mutations_max_count":r.syncdInlineMutationsMaxCount=e.attrInt("value");break;case"syncd_patch_protobuf_max_size":r.syncdPatchProtobufMaxSize=e.attrInt("value");break;case"syncd_key_max_use_days":r.syncdKeyMaxUseDays=e.attrInt("value");break;case"syncd_wait_for_key_timeout_days":r.syncdWaitForKeyTimeoutDays=e.attrInt("value");break;case"syncd_additional_mutations":r.syncdAdditionalMutations=e.attrInt("value");break;case"syncd_anti_tampering_fatal_exception_enabled":r.syncdAntiTamperingFatalExceptionEnabled=1===e.attrInt("value");break;case"syncd_sentinel_timeout_seconds":r.syncdSentinelTimeoutSeconds=e.attrInt("value");break;case"syncd_patch_device_index_included":r.syncdPatchDeviceIndexIncluded=1===e.attrInt("value");break;case"template_doc_mime_types":r.templateDocMimeTypes=e.attrInt("value");break;case"web_biz_profile_options":r.webBizProfileOptions=e.attrInt("value");break;case"web_voip_internal_tester":r.webVoipInternalTester=1===e.attrInt("value");break;case"view_once_read":r.viewOnceRead=e.attrInt("value");break;case"view_once_write":r.viewOnceWrite=e.attrInt("value");break;case"vcard_as_document_size_kb":r.vcardAsDocumentSizeKb=e.attrInt("value");break;case"vcard_max_size_kb":r.vcardMaxSizeKb=e.attrInt("value");break;case"md_blocklist_v2":r.mdBlocklistV2=1===e.attrInt("value");break;case"web_download_document_thumb_mms_enabled":r.webDownloadDocumentThumbMmsEnabled=1===e.attrInt("value");break;case"web_download_link_thumb_mms_enabled":r.webDownloadLinkThumbMmsEnabled=1===e.attrInt("value");break;case"web_send_document_thumb_in_message_disabled":r.webSendDocumentThumbInMessageDisabled=1===e.attrInt("value");break;case"web_upload_document_thumb_mms_enabled":r.webUploadDocumentThumbMmsEnabled=1===e.attrInt("value");break;case"web_upload_link_thumb_mms_enabled":r.webUploadLinkThumbMmsEnabled=1===e.attrInt("value");break;case"web_media_custom_cropping_enabled":r.webMediaCustomCroppingEnabled=1===e.attrInt("value");break;case"web_list_message":r.webListMessage=1===e.attrInt("value");break;case"web_voip_mac_os_min_version":r.webVoipMacOsMinVersion=e.attrString("value");break;case"web_voip_windows_os_min_version":r.webVoipWindowsOsMinVersion=e.attrString("value");break;case"web_cart_enabled":r.webCart=1===e.attrInt("value");break;case"web_catalog_products_onoff":r.webCatalogProductsOnOff=1===e.attrInt("value");break;case"web_cart_v1_1_order_message_changes_enabled":r.webCartV11OrderMessageChanges=1===e.attrInt("value");break;case"mms_cat_v1_forward_hot_override_enabled":r.mmsCatV1ForwardHotOverrideEnabled=1===e.attrInt("value");break;case"web_buttons_message_enabled":r.webButtonsMessage=1===e.attrInt("value");break;case"web_product_list_message_fallback":r.webProductListMessageFallback=1===e.attrInt("value");break;case"web_product_list_message_render_kill_switch":r.webProductListMessageRenderKillSwitch=1===e.attrInt("value");break;case"web_smb_upsell_in_biz_profile_enabled":r.webSMBUpsellInBizProfile=1===e.attrInt("value");break;case"ptt_playback_speed_enabled":r.pttPlaybackSpeedEnabled=1===e.attrInt("value");break;case"ptt_playback_speed_hide_delay":r.pttPlaybackSpeedHideDelay=e.attrInt("value");break;case"web_product_list_message_page_size":r.webProductListMessagePageSize=e.attrInt("value");break;case"web_biz_profile_edit_enabled":r.webBizProfileEdit=1===e.attrInt("value");break;case"web_youtube_player_enhancements":r.webYouTubePlayerEnhancements=1===e.attrInt("value");break;case"web_server_sticker_panel":r.webServerStickerPanel=e.attrInt("value");break;case"web_collections_display_enabled":r.webCollectionsDisplay=1===e.attrInt("value")}})),r}))},41714:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sendAggregateReceipts=function(e,t,r,o,u,l){var d=t===s.READ||t===s.PLAYED||t===s.READ_SELF||t===s.PLAYED_SELF;return Promise.all(Array.from(o.keys()).map((c=>{var f=o.get(c);if(f&&0!==f.length){for(var p=e.isUser()?null:c,h=[];f.length>0;){var _=f.splice(0,256),m=null;_.length>1&&(m=(0,a.wap)("list",null,_.slice(1).map((e=>(0,a.wap)("item",{id:(0,a.CUSTOM_STRING)(e)})))));var g=(0,a.wap)("receipt",{to:(0,i.JID)(e),type:t===s.DELIVERY?a.DROP_ATTR:(0,a.CUSTOM_STRING)(t),msgtype:l?(0,a.CUSTOM_STRING)(l):a.DROP_ATTR,id:(0,a.CUSTOM_STRING)(_[0]),t:null!=r?(0,a.CUSTOM_STRING)(r):a.DROP_ATTR,participant:p?(0,i.DEVICE_JID)(p):a.DROP_ATTR,recipient:u?(0,i.USER_JID)(u):a.DROP_ATTR},m);d?h.push((0,n.sendStanzaAndWaitForAck)(g,{id:_[0],from:e,class:"receipt",type:t,participant:p})):h.push((0,n.castStanza)(g))}return Promise.all(h)}}))).then((()=>{}))},t.RECEIPT_MSG_TYPE=t.RECEIPT_TYPE=void 0;var a=r(30691),n=r(54086),i=r(95778),s=Object.freeze({INACTIVE:"inactive",SENDER:"sender",DELIVERY:"delivery",READ:"read",READ_SELF:"read-self",PLAYED:"played",PLAYED_SELF:"played-self",HISTORY_SYNC_COMPLETION:"hist_sync",SERVER_ERROR:"server-error",PEER_MSG:"peer_msg"});t.RECEIPT_TYPE=s;var o=Object.freeze({PEER:"peer"});t.RECEIPT_MSG_TYPE=o},23882:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.sendDeliveryReceiptsAfterPresence=function(){if(n.default.supportsFeature(n.default.F.MD_BACKEND))return(0,o.getInactiveReceiptTable)().all().then((e=>{var t=new Map,r=Date.now().toString();return e.forEach((e=>{var{msgId:r,chatId:a,participantId:n}=e,i=(0,d.createWid)(a),s=(n?(0,d.createWid)(n):null)||i,o=t.get(i);o||(o=new Map,t.set(i,o));var u=o.get(s);u||(u=[],o.set(s,u)),u.push(r)})),Promise.all(Array.from(t.keys()).map((e=>{var a=t.get(e);if(a)return(0,i.sendAggregateReceipts)(e,i.RECEIPT_TYPE.DELIVERY,r,a)}))).then((()=>(0,o.getInactiveReceiptTable)().bulkRemove(e.map((e=>e.msgId)))))}));return Promise.resolve()},t.sendDeliveryReceiptsAfterDecryption=function(e,t,r,a,p=!1){if(n.default.supportsFeature(n.default.F.MD_BACKEND)){var h=(0,l.default)(),_=(0,u.assertGetMe)(),m=!_.getDeviceId(),g=t.isUser()&&(0,d.toUserWid)(_).equals((0,d.toUserWid)(t))||null!=a&&(0,d.toUserWid)(_).equals((0,d.toUserWid)(a)),v=g||h||m,E=Promise.resolve();if(!v){var y={msgId:e,chatId:t.toString(),participantId:a?a.toString():null};E=(0,o.getInactiveReceiptTable)().createOrReplace(y)}return E.then((()=>{if(function(e,t,r,a,n,o,u){var l=c.DROP_ATTR;u?l=(0,c.CUSTOM_STRING)(i.RECEIPT_TYPE.PEER_MSG):o?l=(0,c.CUSTOM_STRING)(i.RECEIPT_TYPE.SENDER):n||(l=(0,c.CUSTOM_STRING)(i.RECEIPT_TYPE.INACTIVE));var d=(0,c.wap)("receipt",{id:(0,c.CUSTOM_STRING)(e),to:(0,f.JID)(t),participant:(t.isGroup()||t.isBroadcast())&&a?(0,f.DEVICE_JID)(a):c.DROP_ATTR,recipient:!u&&o&&r?(0,f.USER_JID)(r):c.DROP_ATTR,type:l});(0,s.castStanza)(d)}(e,t,r,a,v,g,p),v)return(0,o.getInactiveReceiptTable)().remove(e)}))}return Promise.resolve()};var n=a(r(18120)),i=r(41714),s=r(54086),o=r(11008),u=r(95595),l=a(r(73102)),d=r(75637),c=r(30691),f=r(95778)},33947:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.markChatRead=function(){return E.apply(this,arguments)},t.markStatusRead=function(){return S.apply(this,arguments)};var n=a(r(19976)),i=a(r(52954)),s=r(41263),o=r(71684),u=r(41714),l=a(r(50935)),d=r(95595),c=r(52303),f=a(r(77865)),p=a(r(61941)),h=r(73095),_=r(75637),m=r(55644);function g(){var e=(0,n.default)(["markStatusRead: message is not a status."]);return g=function(){return e},e}function v(e){var t;return e.isGroup()?u.RECEIPT_TYPE.READ:(null===(t=(0,d.getUserPrivacySettings)())||void 0===t?void 0:t.readReceipts)===h.ALL_NONE.none?u.RECEIPT_TYPE.READ_SELF:u.RECEIPT_TYPE.READ}function E(){return(E=(0,i.default)((function*(e,t){var r=Date.now().toString(),a=String(e.id),n=yield(0,c.getTable)().equals(["from","pendingReadReceipt"],[a,1],{shouldDecrypt:!1});n.sort(((e,t)=>(e.rowId||0)-(t.rowId||0)));var i=t?String(t):null,s=new Map,o=n.length-1;if(i){for(;o>=0&&n[o].id!==i;o--);o<0&&(o=n.length-1)}for(var d=null;o>=0;o--){var p=n[o];null!=p.rowId&&(null==d||p.rowId>d)&&(d=p.rowId);var h=f.default.fromString(p.id);if(p.type!==l.default.MSG_TYPE.CIPHERTEXT){var g=p.broadcastId||p.from,E=p.author||p.from,y=h.id,S=(0,_.createWidFromWidLike)(E),T=(0,_.createWidFromWidLike)(g),b=s.get(T);b||(b=new Map,s.set(T,b));var A=b.get(S);A?A.push(y):b.set(S,[y])}}return yield Promise.all(Array.from(s.keys()).map((t=>{var a=s.get(t);if(a){var n=v(e.id);return(0,u.sendAggregateReceipts)(t,n,r,a)}}))),(0,m.markMessageAndChatAsRead)(d,a)}))).apply(this,arguments)}var y=(0,_.createWid)(s.STATUS_JID);function S(){return(S=(0,i.default)((function*(e){if("status"===e.remote.user){var t=String((0,o.unixTime)());yield(0,u.sendAggregateReceipts)(y,v(y),t,new Map([[(0,p.default)(e.participant,"msgKey.participant"),[e.id]]])),yield(0,c.getTable)().merge(e.toString(),{ack:l.default.ACK.READ})}else __LOG__(3)(g())}))).apply(this,arguments)}},14229:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.sendRetryReceipt=function(){return v.apply(this,arguments)},t.prepareKeysForRetry=E;var n=a(r(19976)),i=a(r(52954)),s=r(30691),o=r(12250),u=r(54086),l=a(r(50935)),d=r(95595),c=a(r(18120)),f=r(93912),p=r(44480),h=r(69779),_=r(95778),m=r(75637);function g(){var e=(0,n.default)(["error: ",""]);return g=function(){return e},e}function v(){return(v=(0,i.default)((function*(e,t,r,a,n,i,o=!1){try{var l=yield p.waSignalStore.getRegistrationInfo();if(!l)throw Error("No registration info found");var c,f,{registrationId:h,identityKeyPair:v}=l,y=yield E(e,v),S=s.DROP_ATTR,T=s.DROP_ATTR;if(t.isUser()){if(f=s.DROP_ATTR,c=(0,_.DEVICE_JID)(t),(0,d.getMeUser)().equals((0,m.toUserWid)(t)))if(o)S=(0,s.CUSTOM_STRING)("peer"),T=s.DROP_ATTR;else{if(!a)return Promise.reject("sendRetryReceipt: send retry to peer device without receipient");T=(0,_.USER_JID)(a)}}else c=(0,_.CHAT_JID)(t),f=r?(0,_.DEVICE_JID)(r):s.DROP_ATTR;var b=(0,s.wap)("receipt",{id:(0,s.CUSTOM_STRING)(n),to:c,participant:f,recipient:T,type:"retry",category:S},(0,s.wap)("retry",{v:"1",count:(0,s.INT)(e),id:(0,s.CUSTOM_STRING)(n),t:(0,s.CUSTOM_STRING)(i)}),(0,s.wap)("registration",null,(0,s.BIG_ENDIAN_CONTENT)(h)),y);return(0,u.sendStanzaAndWaitForAck)(b,{id:n,class:"receipt",from:t,participant:r,type:"retry"})}catch(e){__LOG__(4,void 0,new Error,!0)(g(),e),SEND_LOGS("sendRetryReceipt: error while creating or sending the retry message")}}))).apply(this,arguments)}function E(){return y.apply(this,arguments)}function y(){return(y=(0,i.default)((function*(e,t){var[r,a]=yield S(e,t);return a&&(yield p.waSignalStore.markKeyAsUploaded(a.keyId),yield p.waSignalStore.markPreKeyAsDirectDistribution(a.keyId)),r}))).apply(this,arguments)}function S(e,t){if(e<2)return Promise.resolve([null,null]);var r=Promise.resolve(null);return c.default.supportsFeature(c.default.F.MD_ADV)&&(r=(0,o.getADVEncodedIdentity)().then((e=>(0,s.wap)("device-identity",null,e)))),Promise.all([p.waSignalStore.getSignedPreKey(),p.waSignalStore.getOrGenSinglePreKey(f.generatePreKeyPair),r]).then((([e,r,a])=>{if(!e)throw new Error("Signed pre key is not available");return[(0,s.wap)("keys",null,(0,s.wap)("type",null,l.default.KEY_BUNDLE_TYPE),(0,s.wap)("identity",null,t.pubKey),(0,h.xmppPreKey)(r),(0,h.xmppSignedPreKey)(e),a),r]})).catch((()=>{throw Error("Could not create keys section for retry")}))}},48276:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return c.apply(this,arguments)};var n=a(r(52954)),i=r(30691),s=r(60339),o=r(54086),u=r(95595),l=r(82087),d=r(95778);function c(){return(c=(0,n.default)((function*(e){var t=e.id.id,r=(0,s.decodeB64)(e.mediaKey),{ciphertext:a,iv:n}=yield(0,l.encryptServerErrorReceipt)(r,t),{chat:c}=e,f=(0,i.CUSTOM_STRING)(c.id.toString({legacy:!0})),p=c.isGroup||c.isBroadcast?(0,i.CUSTOM_STRING)(e.sender.toString({legacy:!0})):i.DROP_ATTR,h=(0,u.getMeUser)(),_=(0,i.wap)("receipt",{type:"server-error",to:(0,d.USER_JID)(h),id:(0,i.CUSTOM_STRING)(t)},(0,i.wap)("encrypt",null,(0,i.wap)("enc_p",null,a),(0,i.wap)("enc_iv",null,n)),(0,i.wap)("rmr",{jid:f,from_me:(0,i.CUSTOM_STRING)(String(e.isSentByMe)),participant:p}));return(0,o.sendStanzaAndWaitForAck)(_,{id:t,class:"receipt",type:"server-error",from:h,participant:null})}))).apply(this,arguments)}},67688:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,r){var a=(0,n.wap)("iq",{to:n.S_WHATSAPP_NET,xmlns:"fb:thrift_iq",type:"set",id:(0,n.generateId)()},(0,n.wap)("request",{type:"report_product",biz_jid:(0,u.USER_JID)(e)},r?(0,n.wap)("reason",null,r):void 0,(0,n.wap)("id",null,t)));return(0,i.sendIq)(a,l).then((e=>{if(!e.success)throw new s.ServerStatusCodeError(e.errorCode)}))};var n=r(30691),i=r(54086),s=r(19741),o=a(r(23767)),u=r(95778),l=new o.default("reportProductResponse",(e=>{e.assertTag("iq"),e.child("response").assertAttr("type","report_product")}))},29390:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.reportSpam=function(e,t){var r,a=function(e){var t=[],r=e.isGroup?null:e.id;return T(e,y,r).forEach((r=>{var a,n,u,l,c,p=r.t.toString();switch(r.type){case E.UNKNOWN:l=null,a=i.DROP_ATTR,u=i.DROP_ATTR,n=(0,i.CUSTOM_STRING)(o.CIPHERTEXT_VERSION.toString());break;case E.CIPHERTEXT:l=null,a=i.DROP_ATTR,u=i.DROP_ATTR,n=i.DROP_ATTR;break;default:var m=(0,f.createMsgProtobuf)(r,r.avParams()||{}),g=(0,o.mediaTypeFromProtobuf)(m);l=r.isViewOnce?null:(0,s.encodeProto)(d.MessageSpec,m).readByteArray(),a=(0,h.typeAttributeFromProtobuf)(m),u=g?(0,i.CUSTOM_STRING)(g):i.DROP_ATTR,n=(0,i.CUSTOM_STRING)(o.CIPHERTEXT_VERSION.toString())}if(e.isGroup){var v=i.DROP_ATTR;r.author?v=(0,_.USER_JID)(r.author):r.from.isUser()&&(v=(0,_.USER_JID)(r.from)),c=(0,i.wap)("message",{t:(0,i.CUSTOM_STRING)(p),from:(0,_.CHAT_JID)(e.id),participant:v,id:(0,i.CUSTOM_STRING)(r.id.id),type:a},(0,i.wap)("raw",{v:n,mediatype:u},l))}else c=(0,i.wap)("message",{t:(0,i.CUSTOM_STRING)(p),from:(0,_.USER_JID)(r.from),to:(0,_.USER_JID)(r.to),type:a,id:(0,i.CUSTOM_STRING)(r.id.id)},r.multicast?(0,i.wap)("multicast",null):null,r.urlNumber?(0,i.wap)("url_number",null):null,r.urlText?(0,i.wap)("url_text",null):null,r.isViewOnce?(0,i.wap)("view_once",null):null,(0,i.wap)("raw",{v:n,mediatype:u},l));t.push(c)})),t}(e);if(e.isGroup){var n=e.groupMetadata.owner&&(0,_.USER_JID)(e.groupMetadata.owner);r=(0,i.wap)("iq",{to:i.S_WHATSAPP_NET,type:"set",xmlns:"spam",id:(0,i.generateId)()},(0,i.wap)("spam_list",{creator:n||i.DROP_ATTR,subject:(0,i.CUSTOM_STRING)(e.name),jid:(0,_.CHAT_JID)(e.id),spam_flow:(0,i.CUSTOM_STRING)(String(t))},a))}else r=(0,i.wap)("iq",{to:i.S_WHATSAPP_NET,type:"set",xmlns:"spam",id:(0,i.generateId)()},(0,i.wap)("spam_list",{jid:(0,_.CHAT_JID)(e.id),spam_flow:(0,i.CUSTOM_STRING)(String(t))},a));return(0,u.sendIq)(r,b).then((e=>{if(e.success)return e.result;var{errorCode:t,errorText:r}=e;return __LOG__(3)(m(),t,r),{errorCode:t,errorText:r}}))};var n=a(r(19976)),i=r(30691),s=r(68519),o=r(85804),u=r(54086),l=a(r(50935)),d=r(28703),c=r(95595),f=r(84962),p=a(r(23767)),h=r(31567),_=r(95778);function m(){var e=(0,n.default)(["reportSpam: sever response with ",", ",""]);return m=function(){return e},e}function g(){var e=(0,n.default)(["reportSpam: sever response with ",", ",""]);return g=function(){return e},e}function v(){var e=(0,n.default)(["reportSpam: success"]);return v=function(){return e},e}var{MSG_TYPE:E}=l.default,y=5,S=new Set([E.CHAT,E.AUDIO,E.IMAGE,E.PTT,E.VIDEO,E.VCARD,E.UNKNOWN,E.CIPHERTEXT]);function T(e,t,r){for(var a=[],n=e.msgs.toArray().reverse(),i=0;i<n.length&&!(a.length>=t);i++){var s=n[i];if(S.has(s.type)&&!s.from.equals((0,c.getMaybeMeUser)())){if(r){if(e.isGroup&&!r.equals(s.author))continue;if(e.isUser&&!r.equals(s.from))continue}a.push(s)}}return a}var b=new p.default("reportUserSpam",(e=>{if(e.hasChild("error")){var t=e.child("error"),r=t.attrInt("code"),a=t.attrString("text");return __LOG__(3)(g(),r,a),{errorCode:r,errorText:a}}__LOG__(2)(v())}))},83847:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var r;switch(t){case"paused":r=(0,a.wap)("paused",null);break;case"composing":r=(0,a.wap)("composing",null);break;case"recording":r=(0,a.wap)("composing",{media:"audio"});break;default:throw new Error("Impossible value, the default statement should never be reached for value: ".concat(t))}return(0,n.castStanza)((0,a.wap)("chatstate",{to:(0,s.CHAT_JID)(e),from:(0,s.JID)((0,i.assertGetMe)())},r))};var a=r(30691),n=r(54086),i=r(95595),s=r(95778)},18238:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.encryptAndSendKeyMsg=function(){return u.apply(this,arguments)};var n=a(r(52954)),i=r(54086),s=r(2787),o=r(84962);function u(){return(u=(0,n.default)((function*(e){var t=e.to,r=(0,o.createMsgProtobuf)(e),a=yield(0,s.createUserDeviceMsgStanza)(t,null,e.id,r,{type:s.MsgType.AppStateSync});return(0,i.sendStanzaAndWaitForAck)(a,{id:e.id.id,class:"message",from:t,participant:null})}))).apply(this,arguments)}},1048:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.encryptAndSendUserMsg=function(){return m.apply(this,arguments)};var n=a(r(19976)),i=a(r(52954)),s=a(r(20412)),o=r(47882),u=r(1831),l=r(54086),d=r(70025),c=r(95595),f=a(r(40210));function p(){var e=(0,n.default)(["resendUserMsg: skip sending to the empty list"]);return p=function(){return e},e}function h(){var e=(0,n.default)(["resendUserMsg: to ",""]);return h=function(){return e},e}function _(){var e=(0,n.default)(["encryptAndSendUserMsg: to ",""]);return _=function(){return e},e}function m(){return(m=(0,i.default)((function*(e,t,r,a=!1){__LOG__(2)(_(),t.toString());var n=(0,c.assertGetMe)(),i=yield(0,u.getFanOutList)([t,n]),s=yield E(e,t,r,i,a,{fanoutType:d.FANOUT_TYPE.CHAT}),{phash:l}=s;return l&&(new f.default.MdDeviceSyncAck({chatType:f.default.MESSAGE_CHAT_TYPE.INDIVIDUAL,revoke:(0,u.isRevokeMsg)(r)}).commit(),(0,o.syncDeviceList)([t,n],"message",l).then((()=>g(e,t,r,a,i)))),s}))).apply(this,arguments)}function g(){return v.apply(this,arguments)}function v(){return(v=(0,i.default)((function*(e,t,r,a=!1,n){__LOG__(2)(h(),t.toString());var i=(0,c.assertGetMe)(),l=yield(0,u.getFanOutList)([t,i]),f=(0,s.default)(l,n,String);if(0!==f.length){var{phash:_}=yield E(e,t,r,f,a,{fanoutType:d.FANOUT_TYPE.CHAT,disableFanout:!0});_&&(0,o.syncDeviceList)([t,i],"message",_)}else __LOG__(2)(p())}))).apply(this,arguments)}function E(){return y.apply(this,arguments)}function y(){return(y=(0,i.default)((function*(e,t,r,a,n=!1,i){var s=yield(0,d.createFanoutMsgStanza)(e,t,r,a,i),o=yield(0,l.sendStanzaAndReturnAck)(s,{id:e.id,class:"message",from:t,participant:null}),c=u.sendMsgAckSyncParser.parse(o);if(c.error)throw new Error("sendMsgToDeviceList: Invalid ack from server");return c.success}))).apply(this,arguments)}},1831:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.encodeAndPad=function(e){var t=(0,s.encodeProto)(l.MessageSpec,e);return(0,h.writeRandomPadMax16)(t),t.readByteArray()},t.isRevokeMsg=m,t.editAttribute=function(e){return m(e)?(0,i.CUSTOM_STRING)(String(o.default.EDIT_ATTR.REVOKE)):i.DROP_ATTR},t.getFanOutList=function(){return g.apply(this,arguments)},t.isPrimaryDevice=function(e){return null==e.device||e.device===o.default.DEVICE.PRIMARY_DEVICE},t.populateICDCMeta=function(){return E.apply(this,arguments)},t.sendMsgAckSyncParser=void 0;var n=a(r(52954)),i=r(30691),s=r(68519),o=a(r(50935)),u=r(77725),l=r(28703),d=r(95595),c=r(84962),f=r(69868),p=a(r(23767)),h=r(44762),_=r(75637);function m(e){return null!=e.protocolMessage&&e.protocolMessage.type===l.ProtocolMessageType.REVOKE}function g(){return(g=(0,n.default)((function*(e){var t=yield(0,u.getDeviceIds)(e.map((e=>e.user))),r=[],a=(0,d.assertGetMe)();return t.forEach(((t,n)=>{if(t){var{devices:i,id:s}=t;i.forEach((e=>{var t=(0,_.createDeviceWidFromUserAndDevice)(s,e);t.equals(a)||r.push(t)}))}else{var o=(0,_.toUserWid)(e[n]);o.equals(a)||r.push(o)}})),r}))).apply(this,arguments)}var v=new p.default("sendMsgAckSyncParser",(e=>(e.assertTag("ack"),{t:e.attrTime("t"),sync:e.hasAttr("sync")?e.attrString("sync"):null,phash:e.hasAttr("phash")?e.attrString("phash"):null,count:e.hasAttr("count")?e.attrInt("count"):null})));function E(){return(E=(0,n.default)((function*(e,t){var r=(0,d.getMeUser)(),a=yield(0,f.getICDCMeta)(r),n=e.equals(r)?null:yield(0,f.getICDCMeta)(e);(0,c.populateMessageContextInfo)(t,a,n)}))).apply(this,arguments)}t.sendMsgAckSyncParser=v},2787:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.createUserDeviceMsgStanza=function(){return y.apply(this,arguments)},t.createGroupDeviceMsgStanza=function(){return S.apply(this,arguments)},t.MsgType=void 0;var n=a(r(52954)),i=r(30691),s=a(r(47677)),o=r(12250),u=r(85804),l=r(1831),d=r(70654),c=r(95595),f=r(84962),p=a(r(18120)),h=r(12126),_=r(96571),m=r(31567),g=r(95778),v=r(75637),E=r(28103).Mirrored(["Retry","AppStateSync"]);function y(){return(y=(0,n.default)((function*(e,t,r,a,n){var i=a;return yield(0,h.ensureE2ESessions)([e]),(0,v.toUserWid)(e).equals((0,c.getMeUser)())&&n.type!==E.AppStateSync?((0,s.default)(null!=t,"createDeviceMsgStanza: no recipient for peer device message"),i=(0,f.createDeviceSentMessage)(a,t),yield(0,l.populateICDCMeta)((0,v.toUserWid)(t),i)):yield(0,l.populateICDCMeta)((0,v.toUserWid)(e),i),T(e,null,t,r,i,n)}))).apply(this,arguments)}function S(){return(S=(0,n.default)((function*(e,t,r,a,n){if(yield(0,h.ensureE2ESessions)([t]),n.type===E.AppStateSync)return Promise.reject(new Error("createGroupDeviceMsgStanza: not expect for App State Sync message"));var i=(0,v.toUserWid)(t).equals((0,c.getMeUser)())?(0,f.createDeviceSentMessage)(a,e):a;return yield(0,l.populateICDCMeta)((0,v.toUserWid)(t),i),T(e,t,null,r,i,n)}))).apply(this,arguments)}function T(){return b.apply(this,arguments)}function b(){return(b=(0,n.default)((function*(e,t,r,a,n,s){var c,f=null!==(c=s.retryCount)&&void 0!==c?c:0,h=(0,u.mediaTypeFromProtobuf)(n),{type:v,ciphertext:y}=yield(0,d.encryptMsgProtobuf)(t||e,f,n),S=null;if(p.default.supportsFeature(p.default.F.MD_ADV)&&v===_.CiphertextType.Pkmsg){var T=yield(0,o.getADVEncodedIdentity)();S=(0,i.wap)("device-identity",null,T)}return(0,i.wap)("message",{id:(0,i.CUSTOM_STRING)(a.id),to:(0,g.JID)(e),participant:t?(0,g.DEVICE_JID)(t):i.DROP_ATTR,recipient:r?(0,g.USER_JID)(r):i.DROP_ATTR,type:(0,m.typeAttributeFromProtobuf)(n),edit:(0,l.editAttribute)(n),category:s.type===E.AppStateSync?(0,i.CUSTOM_STRING)("peer"):i.DROP_ATTR,push_priority:s.type===E.AppStateSync?(0,i.CUSTOM_STRING)("high"):i.DROP_ATTR},(0,i.wap)("enc",{v:(0,i.CUSTOM_STRING)(u.CIPHERTEXT_VERSION.toString()),type:(0,i.CUSTOM_STRING)(v),count:0===f?i.DROP_ATTR:(0,i.INT)(f),mediatype:(0,u.encodeMaybeMediaType)(h)},y),S)}))).apply(this,arguments)}t.MsgType=E},70654:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.encryptMsgProtobuf=function(){return h.apply(this,arguments)},t.encryptMsgSenderKey=function(){return _.apply(this,arguments)};var i=n(r(19976)),s=n(r(52954)),o=r(85804),u=r(1831),l=n(r(40210)),d=a(r(32602)),c=r(96571);function f(){var e=(0,i.default)(["encryptMsgSenderKey: encryption fail for ",", ",""]);return f=function(){return e},e}function p(){var e=(0,i.default)(["encryptMsgProtobuf: encryption fail for ",", ",""]);return p=function(){return e},e}function h(){return(h=(0,s.default)((function*(e,t,r){var a=(0,o.mediaTypeFromProtobuf)(r),n=new l.default.E2eMessageSend({e2eCiphertextVersion:o.CIPHERTEXT_VERSION,e2eDestination:(0,o.metricsDestinationType)(e),messageMediaType:a?(0,o.metricsMediaType)(a):l.default.MEDIA_TYPE.NONE,retryCount:t});try{var{type:i,ciphertext:s}=yield d.Cipher.encryptSignalProto(e,(0,u.encodeAndPad)(r));return n.e2eCiphertextType=(0,o.metricsCiphertextType)(i),n.e2eSuccessful=!0,n.commit(),{type:i,ciphertext:s}}catch(t){throw n.e2eSuccessful=!1,n.weight=1,n.commit(),__LOG__(3)(p(),e.toString(),t),t}}))).apply(this,arguments)}function _(){return(_=(0,s.default)((function*(e,t){var r=new l.default.E2eMessageSend({e2eCiphertextType:(0,o.metricsCiphertextType)(c.CiphertextType.Skmsg),e2eCiphertextVersion:o.CIPHERTEXT_VERSION,e2eDestination:l.default.E2E_DESTINATION.GROUP,messageMediaType:l.default.MEDIA_TYPE.NONE,retryCount:0});try{var a=yield d.Cipher.encryptSenderKeyMsgSignalProto(e,t);return r.e2eSuccessful=!0,r.commit(),a}catch(t){throw r.e2eSuccessful=!1,r.weight=1,r.commit(),__LOG__(3)(f(),e.toString(),t),t}}))).apply(this,arguments)}},70025:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.createFanoutMsgStanza=function(){return C.apply(this,arguments)},t.FANOUT_TYPE=void 0;var n=a(r(19976)),i=a(r(52954)),s=r(30691),o=r(12250),u=r(1831),l=r(85804),d=r(70654),c=r(95595),f=r(84962),p=a(r(18120)),h=r(12126),_=r(99849),m=r(96571),g=r(31567),v=r(95778),E=r(75637);function y(){var e=(0,n.default)(["ensureE2ESessions with error"]);return y=function(){return e},e}function S(){var e=(0,n.default)(["encryptAndSendUserMsg: encryption fail for primary device ",""]);return S=function(){return e},e}var T=Object.freeze({CHAT:"chat",GROUP_DIRECT:"groupDirect"});function b(){return A.apply(this,arguments)}function A(){return(A=(0,i.default)((function*(e,t,r,a){var n=(0,l.mediaTypeFromProtobuf)(r),o=(0,c.getMeUser)();if(a.fanoutType===T.CHAT&&1===t.length&&(0,u.isPrimaryDevice)(t[0])){var{type:p,ciphertext:h}=yield(0,d.encryptMsgProtobuf)(t[0],0,r);return{shouldHaveIdentity:p===m.CiphertextType.Pkmsg,body:(0,s.wap)("enc",{v:(0,s.CUSTOM_STRING)(l.CIPHERTEXT_VERSION.toString()),type:(0,s.CUSTOM_STRING)(p),mediatype:(0,l.encodeMaybeMediaType)(n)},h)}}var _=!1,g=t.map(function(){var t=(0,i.default)((function*(t){var i=(0,E.toUserWid)(t).equals(o)?(0,f.createDeviceSentMessage)(r,e):r,c=a.fanoutType===T.GROUP_DIRECT?(0,E.toUserWid)(t):(0,E.toUserWid)(e);yield(0,u.populateICDCMeta)(c,i);try{var{type:p,ciphertext:h}=yield(0,d.encryptMsgProtobuf)(t,0,i);return p===m.CiphertextType.Pkmsg&&(_=!0),(0,s.wap)("to",{jid:(0,v.DEVICE_JID)(t)},(0,s.wap)("enc",{v:(0,s.CUSTOM_STRING)(l.CIPHERTEXT_VERSION.toString()),type:(0,s.CUSTOM_STRING)(p),mediatype:(0,l.encodeMaybeMediaType)(n)},h))}catch(e){return(0,u.isPrimaryDevice)(t)&&(__LOG__(4,void 0,new Error,!0)(S(),String(t)),SEND_LOGS("encryption-fail-for-primary-device")),null}}));return function(){return t.apply(this,arguments)}}()),y=(yield Promise.all(g)).filter((e=>null!=e));if(y.length>0)return{body:(0,s.wap)("participants",null,y),shouldHaveIdentity:_};throw new Error("encryptAndSendUserMsg: encryption fail for all devices")}))).apply(this,arguments)}function C(){return(C=(0,i.default)((function*(e,t,r,a,n){try{yield(0,h.ensureE2ESessions)(a)}catch(e){__LOG__(4,void 0,new Error)(y())}var i=a.map((t=>({msgKey:e,receiverId:t})));yield(0,_.createOrMergeReceiptRecords)(i);var d=yield b(t,a,r,n),c=n.fanoutType===T.GROUP_DIRECT?(0,s.wap)("enc",{v:(0,s.CUSTOM_STRING)(l.CIPHERTEXT_VERSION.toString()),type:(0,s.CUSTOM_STRING)(m.CiphertextType.Skmsg)}):null,f=null;if(p.default.supportsFeature(p.default.F.MD_ADV)&&d.shouldHaveIdentity){var E=yield(0,o.getADVEncodedIdentity)();f=(0,s.wap)("device-identity",null,E)}var{id:S}=e;return(0,s.wap)("message",{id:(0,s.CUSTOM_STRING)(S),to:(0,v.CHAT_JID)(t),type:(0,g.typeAttributeFromProtobuf)(r),edit:(0,u.editAttribute)(r),device_fanout:n.disableFanout?(0,s.CUSTOM_STRING)("false"):s.DROP_ATTR},d.body,c,f)}))).apply(this,arguments)}t.FANOUT_TYPE=T},65162:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.encryptAndSendGroupDirectMsg=function(){return _.apply(this,arguments)},t.resendGroupMsg=m;var n=a(r(19976)),i=a(r(52954)),s=a(r(20412)),o=r(47882),u=r(1831),l=r(54086),d=r(70025),c=a(r(40210)),f=r(75637);function p(){var e=(0,n.default)(["resendGroupMsg: skip sending to the empty list"]);return p=function(){return e},e}function h(){var e=(0,n.default)(["resendGroupMsg: to ",""]);return h=function(){return e},e}function _(){return(_=(0,i.default)((function*(e,t,r,a){var n=yield v(e,t,r,a,{fanoutType:d.FANOUT_TYPE.GROUP_DIRECT}),{phash:i}=n;return i&&(new c.default.MdDeviceSyncAck({chatType:c.default.MESSAGE_CHAT_TYPE.GROUP,revoke:(0,u.isRevokeMsg)(r)}).commit(),(0,o.syncDeviceList)(a,"message",i).then((()=>m(e,t,r,a)))),n}))).apply(this,arguments)}function m(){return g.apply(this,arguments)}function g(){return(g=(0,i.default)((function*(e,t,r,a){__LOG__(2)(h(),t.toString());var n=Array.from(new Set(a.map((e=>e.user)))).map((e=>(0,f.createUserWid)(e))),i=yield(0,u.getFanOutList)(n),o=(0,s.default)(i,a,String);0!==o.length?yield v(e,t,r,o,{fanoutType:d.FANOUT_TYPE.GROUP_DIRECT,disableFanout:!0}):__LOG__(2)(p())}))).apply(this,arguments)}function v(){return E.apply(this,arguments)}function E(){return(E=(0,i.default)((function*(e,t,r,a,n){var i=yield(0,d.createFanoutMsgStanza)(e,t,r,a,n),s=yield(0,l.sendStanzaAndReturnAck)(i,{id:e.id,class:"message",from:t,participant:null}),o=u.sendMsgAckSyncParser.parse(s);if(o.error)throw new Error("encryptAndSendGroupDirectMsg: Invalid ack from server");return o.success}))).apply(this,arguments)}},64921:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.encryptAndSendGroupMsg=function(){return g.apply(this,arguments)};var n=a(r(52954)),i=r(65162),s=r(28703),o=a(r(18120)),u=a(r(77865)),l=r(51878),d=r(10649),c=r(75637),f=r(1831),p=r(11008),h=Object.freeze({SKMSG:"skmsg",DIRECT:"direct"});function _(){return m.apply(this,arguments)}function m(){return(m=(0,n.default)((function*(e,t){var r=yield(0,l.getGroupSenderKeyList)(e),a={senderKeyList:r,type:h.SKMSG};if(t&&o.default.supportsFeature(o.default.F.MD_BACKEND)){var n=yield(0,p.getMsgInfoTable)().equals(["msgKey"],String(t));if(0===n.length)return a;var{skDistribList:i,skList:s}=r,u=new Set(i.concat(s).map((e=>String((0,c.toUserWid)(e))))),d=n.filter((e=>!u.has(e.receiverUserJid))).map((e=>(0,c.createWid)(e.receiverUserJid)));if(0===d.length)return a;var _=[...yield(0,f.getFanOutList)(d),...s,...i];return{type:h.DIRECT,deviceList:_}}return a}))).apply(this,arguments)}function g(){return(g=(0,n.default)((function*(e,t,r){var{protocolMessage:a}=r,n=null;if((null==a?void 0:a.type)===s.ProtocolMessageType.REVOKE&&(null==a?void 0:a.key)){var{remoteJid:o,id:l,participant:f}=a.key;o&&l&&f&&(n=new u.default({remote:(0,c.createWid)(o),fromMe:!0,id:l,participant:(0,c.createWid)(f)}))}var p=yield _(t,n);if(p.type===h.DIRECT){var{deviceList:m}=p;return(0,i.encryptAndSendGroupDirectMsg)(e,t,r,m)}var{senderKeyList:g}=p;return(0,d.encryptAndSendSenderKeyMsg)(e,t,r,g)}))).apply(this,arguments)}},10649:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.encryptAndSendSenderKeyMsg=function(){return F.apply(this,arguments)};var i=n(r(19976)),s=n(r(52954)),o=r(30691),u=r(98970),l=r(12250),d=r(85804),c=r(1831),f=r(54086),p=r(65162),h=r(70654),_=r(95595),m=n(r(18120)),g=r(12126),v=r(52303),E=r(99849),y=n(r(40210)),S=r(51878),T=r(24897),b=r(90401),A=a(r(32602)),C=r(96571),P=r(31567),O=r(95778),w=r(75637);function M(){var e=(0,i.default)(["encryptAndSendSenderKeyMsg: Invalid ack from server"]);return M=function(){return e},e}function I(){var e=(0,i.default)(["encryptAndSendUserMsg: encryption fail for ",", ",""]);return I=function(){return e},e}function R(){var e=(0,i.default)(["ensureE2ESessions with error"]);return R=function(){return e},e}function D(){return N.apply(this,arguments)}function N(){return(N=(0,s.default)((function*(e,t){if(0===t.length)return null;try{yield(0,g.ensureE2ESessions)(t)}catch(e){__LOG__(4,void 0,new Error)(R())}var r=yield A.Session.getGroupSenderKeyInfo(e),a={senderKeyDistributionMessage:{groupId:e.toString({legacy:!0}),axolotlSenderKeyDistributionMessage:r}},n=t.map(function(){var e=(0,s.default)((function*(e){try{yield(0,c.populateICDCMeta)((0,w.toUserWid)(e),a);var t=yield(0,h.encryptMsgProtobuf)(e,0,a);return{type:t.type,ciphertext:t.ciphertext,participant:e}}catch(t){if((0,c.isPrimaryDevice)(e))throw new Error("encryptAndSendUserMsg: encryption fail for primary device ".concat(String(e)));return __LOG__(2)(I(),e.toString(),t),null}}));return function(){return e.apply(this,arguments)}}());return(yield Promise.all(n)).filter(Boolean)}))).apply(this,arguments)}function L(){return k.apply(this,arguments)}function k(){return(k=(0,s.default)((function*(e,t,r){var a=(0,c.encodeAndPad)(r),n=(0,d.mediaTypeFromProtobuf)(r),i=yield D(e,t,a),s=yield(0,h.encryptMsgSenderKey)(e,a),u=null,f=!1;i&&i.length>0&&(u=(0,o.wap)("participants",null,i.map((({type:e,ciphertext:t,participant:r})=>(e===C.CiphertextType.Pkmsg&&(f=!0),(0,o.wap)("to",{jid:(0,O.DEVICE_JID)(r)},(0,o.wap)("enc",{v:(0,o.CUSTOM_STRING)(d.CIPHERTEXT_VERSION.toString()),type:(0,o.CUSTOM_STRING)(e)},t)))))));var p=(0,o.wap)("enc",{v:(0,o.CUSTOM_STRING)(d.CIPHERTEXT_VERSION.toString()),type:(0,o.CUSTOM_STRING)(C.CiphertextType.Skmsg),mediatype:(0,d.encodeMaybeMediaType)(n)},s.ciphertext),_=null;if(m.default.supportsFeature(m.default.F.MD_ADV)&&f){var g=yield(0,l.getADVEncodedIdentity)();_=(0,o.wap)("device-identity",null,g)}return[u,p,_]}))).apply(this,arguments)}var U=new u.PromiseQueueMap;function F(){return(F=(0,s.default)((function*(e,t,r,a){var{id:n}=e,{skDistribList:i,skList:u,rotateKey:l}=a,d=u.concat(i),h=yield(0,T.phashV2)([...d,(0,_.assertGetMe)()]);yield(0,E.createOrMergeReceiptRecords)(d.map((t=>({msgKey:e,receiverId:t}))));var[m,g,C]=yield U.enqueue(t.toString(),(0,s.default)((function*(){return l&&(yield A.Session.deleteGroupSenderKeyInfo(t)),L(t,i,r)}))),w=(0,o.wap)("message",{id:(0,o.CUSTOM_STRING)(n),to:(0,O.CHAT_JID)(t),phash:(0,o.CUSTOM_STRING)(h),type:(0,P.typeAttributeFromProtobuf)(r),edit:(0,c.editAttribute)(r)},m,g,C),I=yield(0,f.sendStanzaAndReturnAck)(w,{id:n,class:"message",from:t,participant:null}),R=c.sendMsgAckSyncParser.parse(I);if(R.error)throw __LOG__(3)(M()),new Error("encryptAndSendSenderKeyMsg: Invalid ack from server");yield(0,S.markHasSenderKey)(t,i);var{phash:D,count:N}=R.success;return D&&D!==h&&(new y.default.MdDeviceSyncAck({chatType:y.default.MESSAGE_CHAT_TYPE.GROUP,revoke:(0,c.isRevokeMsg)(r)}).commit(),(0,b.sendQueryGroup)(t).then((()=>{(0,p.resendGroupMsg)(e,t,r,d)}))),null!=N&&(0,v.getTable)().merge(String(e),{count:N}),R.success}))).apply(this,arguments)}},80500:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.encryptAndSendMsg=function(e){var t,r=e.id,a=e.to;if(!r||!r.id)return Promise.reject(new Error("sending message without an id"));if(!a)return Promise.reject(new Error("sending message without an remote id"));e.asMms&&(t=e.isUnsentPhoneMsg()?{type:e.type}:e.avParams());var u=(0,i.createMsgProtobuf)(e,t||{});if(a.isUser())return(0,n.encryptAndSendUserMsg)(r,a,u,e.multicast);if(a.isGroup())return o.default.find(a).then((()=>(0,s.encryptAndSendGroupMsg)(r,a,u)));return Promise.reject(new Error("unsupported remote jid type"))},Object.defineProperty(t,"sendRetry",{enumerable:!0,get:function(){return u.sendRetry}}),Object.defineProperty(t,"encodeAndPad",{enumerable:!0,get:function(){return l.encodeAndPad}}),Object.defineProperty(t,"getFanOutList",{enumerable:!0,get:function(){return l.getFanOutList}});var n=r(1048),i=r(84962),s=r(64921),o=a(r(99922)),u=r(65742),l=r(1831)},65742:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.sendRetry=function(){return f.apply(this,arguments)};var n=a(r(19976)),i=a(r(52954)),s=a(r(47677)),o=r(54086),u=r(2787),l=r(84962);function d(){var e=(0,n.default)(["sendRetry: sending "," to ",""]);return d=function(){return e},e}function c(){var e=(0,n.default)(["sendRetry: id "," to ",", requester: ",", count: ",""]);return c=function(){return e},e}function f(){return(f=(0,i.default)((function*(e,t,r,a,n){var i,f=a.id.id;__LOG__(2)(c(),f,e.toString(),(t||e).toString(),n),a.asMms&&(i=a.isUnsentPhoneMsg()?{type:a.type}:a.avParams());var p,h=(0,l.createMsgProtobuf)(a,i||{}),_={type:u.MsgType.Retry,retryCount:n};return e.isUser()?p=yield(0,u.createUserDeviceMsgStanza)(e,r,a.id,h,_):((0,s.default)(null!=t,"sendRetry: no participant for group retry message"),p=yield(0,u.createGroupDeviceMsgStanza)(e,t,a.id,h,_)),__LOG__(2)(d(),f,e.toString()),(0,o.sendStanzaAndWaitForAck)(p,{id:f,class:"message",from:e,participant:t})}))).apply(this,arguments)}},74854:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,i.castStanza)((0,n.wap)("presence",{type:e,name:(0,n.MAYBE_CUSTOM_STRING)(s.default.pushname)}))};var n=r(30691),i=r(54086),s=a(r(52737))},97866:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,n.castStanza)((0,a.wap)("presence",{id:(0,a.generateId)(),to:(0,i.CHAT_JID)(e),type:"subscribe"}))};var a=r(30691),n=r(54086),i=r(95778)},80358:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return(0,i.sendIq)((0,n.wap)("iq",{to:(0,u.CHAT_JID)(e),type:"set",xmlns:"w:profile:picture",id:(0,n.generateId)()},t?(0,n.wap)("picture",{type:"image"},t):null),l).then((e=>e.success?{id:e.result.id}:Promise.reject(new s.ServerStatusCodeError(e.errorCode,e.errorText))))};var n=r(30691),i=r(54086),s=r(19741),o=a(r(23767)),u=r(95778),l=new o.default("photoResponseParser",(e=>(e.assertAttr("type","result"),e.hasChild("picture")?{id:e.child("picture").attrInt("id")}:{id:null})))},66759:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,n.castStanza)((0,a.wap)("presence",{name:(0,a.MAYBE_CUSTOM_STRING)(e)}))};var a=r(30691),n=r(54086)},22105:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var r=(0,i.wap)("iq",{to:i.S_WHATSAPP_NET,type:"set",xmlns:"w:stats",id:(0,i.generateId)()},(0,i.wap)("add",{t:(0,i.INT)(t)},e));return(0,s.sendIq)(r,d).then((e=>{if(!e.success){var{errorCode:t,errorText:r}=e;return __LOG__(3)(o(),t,r),{errorCode:t,errorText:r}}}))};var n=a(r(19976)),i=r(30691),s=r(54086);function o(){var e=(0,n.default)(["fieldStatsUpload: sever response with ",", ",""]);return o=function(){return e},e}function u(){var e=(0,n.default)(["fieldStatsUpload: sever response with ",", ",""]);return u=function(){return e},e}function l(){var e=(0,n.default)(["fieldStatsUpload: success"]);return l=function(){return e},e}var d=new(a(r(23767)).default)("uploadStats",(e=>{if(e.hasChild("error")){var t=e.child("error"),r=t.attrInt("code"),a=t.attrString("text");return __LOG__(3)(u(),r,a),{errorCode:r,errorText:a}}__LOG__(2)(l())}))},96571:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MediaType=t.CiphertextType=void 0;var a=r(28103)({Skmsg:"skmsg",Pkmsg:"pkmsg",Msg:"msg"});t.CiphertextType=a;var n=r(28103)({Photo:"photo",Video:"video",Audio:"audio",Ptt:"ptt",Location:"location",Contact:"contact",Document:"document",Url:"url",Call:"call",Gif:"gif",Future:"future",ContactArray:"contact_array",LiveLocation:"live_location",ProfilePic:"profile_pic",Sticker:"sticker",Hsm:"hsm",ProductImage:"product_image",Template:"template",MdAppState:"md_app_state",MdHistorySync:"md_history_sync",List:"list",ListResponse:"list_response",Button:"button",ButtonResponse:"button_response",Order:"order",Product:"product"});t.MediaType=n},63520:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){var e=(0,n.wap)("iq",{to:n.S_WHATSAPP_NET,type:"set",id:(0,n.generateId)(),xmlns:"md"},(0,n.wap)("remove-companion-device",{jid:(0,u.DEVICE_JID)((0,s.assertGetMe)())}));return(0,i.sendIq)(e,l).then((e=>e.success?{status:e.result.status}:{status:e.errorCode}))};var n=r(30691),i=r(54086),s=r(95595),o=a(r(23767)),u=r(95778),l=new o.default("unpairResponse",(e=>{e.assertTag("iq"),e.assertFromServer();var t=200;return"error"===e.attrString("type")&&(t=e.child("error").attrInt("code")),{status:t}}))},29738:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.uploadPreKeys=function(){var e=new s.PromiseRetryLoop({name:"uploadPreKeys",timer:S,code:e=>(__LOG__(2)(h()),Promise.all([c.waSignalStore.getRegistrationInfo(),c.waSignalStore.getSignedPreKey()]).then((([e,t])=>{if(!e||!t)throw new Error("No signal info is available");var{registrationId:r,identityKeyPair:a}=e;return c.waSignalStore.getOrGenPreKeys(30,l.generatePreKeyPair).then((e=>{if(0===e.length)throw new Error("No preKey is available");return[(0,i.wap)("iq",{id:(0,i.generateId)(),xmlns:"encrypt",type:"set",to:i.S_WHATSAPP_NET},(0,i.wap)("registration",null,(0,i.BIG_ENDIAN_CONTENT)(r)),(0,i.wap)("type",null,u.default.KEY_BUNDLE_TYPE),(0,i.wap)("identity",null,a.pubKey),(0,i.wap)("list",null,e.map(f.xmppPreKey)),(0,f.xmppSignedPreKey)(t)),e[e.length-1].keyId]})).then((([e,t])=>(0,o.waitForConnection)().then((()=>c.waSignalStore.markKeyAsUploaded(t))).then((()=>(0,o.sendIqWithoutRetry)(e,y))).then((e=>{if(e.success)return c.waSignalStore.setServerHasPreKeys(!0),{success:!0};var t=e.errorCode;return t>=500?__LOG__(3)(v(),t):406===t?__LOG__(3)(g()):__LOG__(3)(m(),t),{errorCode:e.errorCode,errorText:e.errorText}})).catch((()=>{__LOG__(3)(_())}))))})).then((t=>{t&&t.success?e():__LOG__(2)(p())})))});return e.start(),e.promise()};var n=a(r(19976)),i=r(30691),s=r(56656),o=r(54086),u=a(r(50935)),l=r(93912),d=a(r(23767)),c=r(44480),f=r(69779);function p(){var e=(0,n.default)(["uploadPreKeys: retrying (after delay)"]);return p=function(){return e},e}function h(){var e=(0,n.default)(["uploadPreKeys: running"]);return h=function(){return e},e}function _(){var e=(0,n.default)(["_uploadPreKeys: disconnected, unclear if on server"]);return _=function(){return e},e}function m(){var e=(0,n.default)(["_uploadPreKeys: unrecognized error ",""]);return m=function(){return e},e}function g(){var e=(0,n.default)(["_uploadPreKeys: uploaded invalid keys"]);return g=function(){return e},e}function v(){var e=(0,n.default)(["_uploadPreKeys: server requested backoff ",""]);return v=function(){return e},e}var E={error:!1,result:!0},y=new d.default("uploadPreKeyResParser",(e=>{if(e.assertTag("iq"),e.assertFromServer(),e.attrEnum("type",E))return{success:!0};var t=e.child("error");return{errorCode:t.attrInt("code"),errorText:t.hasAttr("text")?t.attrString("text"):""}}));var S={algo:{type:"fibonacci",first:1e3,second:2e3},max:61e4}},92807:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.onMsgProcessingThread=function(){return c.apply(this,arguments)},t.waitForOfflineMsgThread=function(e){return e?d.chatQueue.wait(e):d.allChatQueue.wait()},t._online=t._waitForMainStream=void 0;var n=a(r(52954)),i=r(98970),s=a(r(79711)),o=a(r(82486)),u=new Promise((e=>{s.default.on("main_stream_mode_ready",(()=>{e()}))}));t._waitForMainStream=u;var l={allChatQueue:new i.PromiseQueue(5e3),chatQueue:new i.PromiseQueueMap};t._online=l;var d={allChatQueue:new i.PromiseQueue,chatQueue:new i.PromiseQueueMap};function c(){return(c=(0,n.default)((function*(e,t,r){return t&&!o.default.getOfflineSessionComplete()?d.allChatQueue.enqueue((()=>d.chatQueue.enqueue(e,r))):(yield u,l.allChatQueue.enqueue((()=>l.chatQueue.enqueue(e,r))))}))).apply(this,arguments)}},43315:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return I.apply(this,arguments)};var i=n(r(19976)),s=n(r(52954)),o=r(30691),u=r(12250),l=r(85804),d=r(54086),c=n(r(50935)),f=n(r(18120)),p=r(12126),h=n(r(49213)),_=r(80500),m=a(r(32602)),g=r(96571),v=a(r(31558)),E=r(95778),y=n(r(68384)),S=r(75637);function T(){var e=(0,i.default)(["voip:encryptAndSendSignalingMsg: Sending offer without enc"]);return T=function(){return e},e}function b(){var e=(0,i.default)(["voip:encryptAndSendSignalingMsg: Could not establish E2E session with deviceWid"]);return b=function(){return e},e}function A(){var e=(0,i.default)(["voip:encryptMsgCallKey: Removing all enc nodes due to encryption failure"]);return A=function(){return e},e}function C(){var e=(0,i.default)(["voip:encryptMsgCallKey: Signal encryption failed for ",", ",""]);return C=function(){return e},e}function P(){var e=(0,i.default)(["voip:encryptMsgCallKey: Could not establish E2E session with all deviceWids"]);return P=function(){return e},e}function O(){var e=(0,i.default)(["Assertion failed!"]);return O=function(){return e},e}function w(){var e=(0,i.default)(["voip:encryptAndSendSignalingMsg: Failed to encrypt and send msg"]);return w=function(){return e},e}var{VOIP_LOG_COLOR:M}=c.default;function I(){return(I=(0,s.default)((function*(e,t){var r=e.common,a=(0,S.createWid)(r.peer_jid);if(y.default.isGroupCall(a))return R((0,o.CUSTOM_STRING)(r.peer_jid),a,e);try{return R(yield N(e,a,t),a,e)}catch(e){__LOG__(3)(w())}}))).apply(this,arguments)}function R(){return D.apply(this,arguments)}function D(){return(D=(0,s.default)((function*(e,t,r){var a=(0,E.voipXmlToWapNode)(r.payload),n=(0,h.default)(),i=(0,o.wap)("call",{to:e,id:(0,o.CUSTOM_STRING)(n)},a),s=yield(0,d.sendStanzaAndReturnAck)(i,{id:n,class:"call",from:t,participant:null});return{payload:(0,E.wapNodeToVoipXml)(s),status:200}}))).apply(this,arguments)}function N(){return L.apply(this,arguments)}function L(){return(L=(0,s.default)((function*(e,t,r){var a=e.payload[2].findIndex((e=>"destination"===e[0])),n=e.payload[2][a];if(n){e.payload[0]!==v.TYPE_STR.OFFER&&(__LOG__(4,void 0,new Error,!0)(O()),SEND_LOGS("call offer check"));var i=n[2].map((e=>(0,S.createDeviceWidFromUserAndDevice)(e[1].jid.user,e[1].jid.device)));try{yield(0,p.ensureE2ESessions)(i)}catch(e){__LOG__(3)(P())}var o=!1,u=!1;return yield Promise.all(n[2].map(function(){var t=(0,s.default)((function*(t,r){if(k(t[2])){var a=x(t[2]),n=i[r];try{var{encNode:s,shouldHaveIdentity:l}=yield B(a,n,G(e.payload[2]));u=u||l,F(t[2],s)}catch(e){__LOG__(3)(C(),n.toString(),e),o=!0}}}));return function(){return t.apply(this,arguments)}}())),o?(__LOG__(3)(A()),n[2].forEach((e=>U(e)))):u&&(yield K(e.payload[2])),(0,E.USER_JID)(t)}if(!k(e.payload[2]))return(0,E.DEVICE_JID)(t);try{var l=[t];if(t.isCompanion()){var d=(0,S.createDeviceWidFromUserAndDevice)(t.user,c.default.DEVICE.PRIMARY_DEVICE);l.unshift(d)}yield(0,p.ensureE2ESessions)(l)}catch(e){__LOG__(3)(b())}var f,h,_=x(e.payload[2]);try{var m=yield B(_,t,G(e.payload[2]));f=m.encNode,h=m.shouldHaveIdentity}catch(e){if(r!==v.TYPE.OFFER)throw e;f=null,h=!1,__LOG__(3)(T())}return F(e.payload[2],f),h&&(yield K(e.payload[2])),(0,E.DEVICE_JID)(t)}))).apply(this,arguments)}function k(e){return null!=e&&e.findIndex((e=>"enc"===e[0]))>=0}function U(e){if(null!=e){var t=e.findIndex((e=>"enc"===e[0]));e.splice(t,1)}}function F(e,t){var r=e.findIndex((e=>"enc"===e[0]));r>=0&&(e[r]=t)}function G(e){var t=e.find((e=>"enc"===e[0])),r=t&&t[1]&&t[1].count;return null!=r?r:0}function x(e){var t=e.find((e=>"enc"===e[0])),r=t&&t[2];return{call:{callKey:new Uint8Array(r)}}}function B(){return Y.apply(this,arguments)}function Y(){return(Y=(0,s.default)((function*(e,t,r){var{type:a,ciphertext:n}=yield m.Cipher.encryptSignalProto(t,(0,_.encodeAndPad)(e));return{encNode:(0,o.wap)("enc",{v:(0,o.CUSTOM_STRING)(l.CIPHERTEXT_VERSION.toString()),type:(0,o.CUSTOM_STRING)(a),count:(0,o.INT)(r)},n),shouldHaveIdentity:a===g.CiphertextType.Pkmsg}}))).apply(this,arguments)}function K(){return j.apply(this,arguments)}function j(){return(j=(0,s.default)((function*(e){if(f.default.supportsFeature(f.default.F.MD_ADV)){var t=yield(0,u.getADVEncodedIdentity)();e.push((0,o.wap)("device-identity",null,t))}}))).apply(this,arguments)}},14318:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return o.apply(this,arguments)};var n=a(r(52954)),i=r(14229),s=r(44480);function o(){return(o=(0,n.default)((function*(e){var t,r=yield s.waSignalStore.getRegistrationInfo();if(!r)throw Error("No registration info found");var{identityKeyPair:a}=r,n=null!==(t=e[1]&&parseInt(e[1].count,10))&&void 0!==t?t:0,o=yield(0,i.prepareKeysForRetry)(n,a);return o&&e[2]&&Array.isArray(e[2])&&e[2].push(o),e}))).apply(this,arguments)}},73919:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t,r,a=e.common,d=(0,l.createWid)(a.peer_jid);d.isGroupCall()?(t=(0,u.GROUP_CALL_JID)(d),r=Promise.resolve()):(t=(0,u.DEVICE_JID)(d),r=(0,s.ensureE2ESessions)([d]));return r.then((()=>{var r=(0,u.voipXmlToWapNode)(e.payload),a=(0,o.default)(),s=(0,n.wap)("call",{to:t,id:(0,n.CUSTOM_STRING)(a)},r);return(0,i.sendStanzaAndReturnAck)(s,{id:a,class:"call",from:d,participant:null}).then((e=>({payload:(0,u.wapNodeToVoipXml)(e),status:200})))}))};var n=r(30691),i=r(54086),s=r(12126),o=a(r(49213)),u=r(95778),l=r(75637)},43191:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return d.apply(this,arguments)};var n=a(r(52954)),i=r(30691),s=r(54086),o=r(44480),u=r(31558),l=r(95778);function d(){return(d=(0,n.default)((function*(e,t,r=0){var a=yield o.waSignalStore.getRegistrationInfo();if(!a)throw Error("No registration info found");var n=(0,i.wap)("receipt",{to:(0,l.DEVICE_JID)(t.peer_jid),id:(0,i.CUSTOM_STRING)(e),type:(0,i.CUSTOM_STRING)(u.ENC_RETRY_RECEIPT_ATTRS.GROUP_CALL)},(0,i.wap)("enc_rekey",{"call-creator":(0,l.DEVICE_JID)(t.call_creator),"call-id":(0,i.CUSTOM_STRING)(t.call_id),count:(0,i.INT)(r+1)}),(0,i.wap)("registration",null,(0,i.BIG_ENDIAN_CONTENT)(a.registrationId)));(0,s.castStanza)(n)}))).apply(this,arguments)}},77857:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.getClientPayloadForLogin=function(e){var t=(0,c.assertGetMe)(),r=(0,n.default)((0,n.default)({},_(e)),{},{username:parseInt(t.user,10),device:null!=t.device?t.device:0});return(0,i.encodeProto)(h.ClientPayloadSpec,r).readByteArray()},t.getClientPayloadForRegistration=function(e,t,r){var a=m(),s=g(),o=(0,n.default)((0,n.default)({},_(r)),{},{regData:{buildHash:a,companionProps:s,eRegid:(0,u.intToBytes)(4,e.registrationId),eKeytype:(0,u.intToBytes)(1,5),eIdent:e.identityKeyPair.pubKey,eSkeyId:(0,u.intToBytes)(3,t.keyId),eSkeyVal:t.keyPair.pubKey,eSkeySig:t.signature}});return(0,i.encodeProto)(h.ClientPayloadSpec,o).readByteArray()},t.getBuildHash=m,t.getCompanionProps=g,t.getUserAgent=v,t.getPlatformTypeFromName=E,t.getWebSubPlatform=y;var n=a(r(70417)),i=r(68519),s=r(60339),o=a(r(61867)),u=r(59410),l=r(65512),d=a(r(50935)),c=r(95595),f=r(1972),p=a(r(68560)),h=r(33599);function _(e){return{passive:!!e&&e.passive,connectType:h.ClientPayloadConnectType.WIFI_UNKNOWN,connectReason:h.ClientPayloadConnectReason.USER_ACTIVATED,userAgent:v(),webInfo:{webSubPlatform:y()}}}function m(){var e=(0,s.decodeB64)((0,p.default)(d.default.VERSION_BASE));return new Uint8Array(e)}function g(){var e,t=o.default.info();if(t.version&&""!==t.version){var r=t.version.split(".");r.length>0&&t.version&&/^[0-9\.]+$/.test(t.version)&&(e={primary:parseInt(r[0],10),secondary:r.length>1?parseInt(r[1],10):void 0,tertiary:r.length>2?parseInt(r[2],10):void 0})}var a={os:t.os,version:e,platformType:E(t.name),requireFullSync:!1};return(0,i.encodeProto)(l.CompanionPropsSpec,a).readByteArray()}function v(){var e=f.deviceInfo.get(),t=h.UserAgentReleaseChannel.RELEASE;return{appVersion:{primary:d.default.VERSION.p,secondary:d.default.VERSION.s,tertiary:d.default.VERSION.t},platform:h.UserAgentPlatform.WEB,releaseChannel:t,mcc:e.mcc,mnc:e.mnc,osVersion:e.osVersion,manufacturer:e.manufacturer,device:e.device,osBuildNumber:e.osBuild,localeLanguageIso6391:e.lg,localeCountryIso31661Alpha2:e.lc}}function E(e){switch(e){case"Chrome":return l.CompanionPropsPlatformType.CHROME;case"Firefox":return l.CompanionPropsPlatformType.FIREFOX;case"IE":return l.CompanionPropsPlatformType.IE;case"Opera":return l.CompanionPropsPlatformType.OPERA;case"Safari":return l.CompanionPropsPlatformType.SAFARI;case"Edge":return l.CompanionPropsPlatformType.EDGE;case"electron":case"Desktop":return l.CompanionPropsPlatformType.DESKTOP;case"ipad":case"iPad":return l.CompanionPropsPlatformType.IPAD;case"tablet":case"Android tablet":return l.CompanionPropsPlatformType.ANDROID_TABLET;case"Ohana":return l.CompanionPropsPlatformType.OHANA;case"Aloha":return l.CompanionPropsPlatformType.ALOHA;case"Catalina":return l.CompanionPropsPlatformType.CATALINA;default:return l.CompanionPropsPlatformType.UNKNOWN}}function y(){switch(d.default.WAM_PLATFORM){case"WEB":return h.WebInfoWebSubPlatform.WEB_BROWSER;case"DARWIN":case"DARWIN_BETA":return h.WebInfoWebSubPlatform.DARWIN;case"WIN32":case"WIN32_BETA":return h.WebInfoWebSubPlatform.WIN32;case"MACSTORE":return h.WebInfoWebSubPlatform.APP_STORE;case"WINSTORE":return h.WebInfoWebSubPlatform.WIN_STORE;default:return}}},87203:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){if(!(0,y.isRegistered)())return t=e,K().then((e=>Promise.all([T.waSignalStore.getRegistrationInfo(),T.waSignalStore.getSignedPreKey(),e]))).then((([e,r,a])=>{if(!r||!e)throw new Error("Invalid signal credentials");var n=(0,m.getClientPayloadForRegistration)(e,r,t),i=(0,S.default)(E.waNoiseInfo.get(),"waNoiseInfo.get()").staticKeyPair;return Promise.all([j(i,G,a),G.encrypt(Promise.resolve(n))])})).then((([e,t])=>(G.send((0,c.encodeProto)(A.HandshakeMessageSpec,{clientFinish:{static:e,payload:t}}).readByteArray()),G.finish()))).then((e=>(__LOG__(2)(O()),e))).catch((e=>{__LOG__(3)(P(),e)}));var t;return function(e){return K().then((t=>{g.default.incrementProgress();var r=(0,S.default)(E.waNoiseInfo.get(),"waNoiseInfo.get()").staticKeyPair,a=(0,m.getClientPayloadForLogin)(e);return Promise.all([j(r,G,t),G.encrypt(Promise.resolve(a))])})).then((([e,t])=>(g.default.incrementProgress(),G.send((0,c.encodeProto)(A.HandshakeMessageSpec,{clientFinish:{static:e,payload:t}}).readByteArray()),G.finish()))).then((e=>(g.default.incrementProgress(),__LOG__(2)(M()),e))).catch((e=>{__LOG__(3)(w(),e)}))}(e)};var i=n(r(19976)),s=r(58489),o=r(82368),u=r(32316),l=r(79167),d=r(84139),c=r(68519),f=r(46378),p=r(60339),h=r(8320),_=r(71684),m=r(77857),g=n(r(79711)),v=a(r(72434)),E=r(1972),y=r(39174),S=n(r(61941)),T=r(44480),b=n(r(11352)),A=r(33599),C=n(r(17744));function P(){var e=(0,i.default)(["openChatSocketForRegistration error ",""]);return P=function(){return e},e}function O(){var e=(0,i.default)(["openChatSocketForRegistration success, resetting round"]);return O=function(){return e},e}function w(){var e=(0,i.default)(["openChatSocketForLogin error ",""]);return w=function(){return e},e}function M(){var e=(0,i.default)(["openChatSocketForLogin success, resetting round"]);return M=function(){return e},e}function I(){var e=(0,i.default)(["certificateCiphertext: ",""]);return I=function(){return e},e}function R(){var e=(0,i.default)(["serverStaticCiphertext: ",""]);return R=function(){return e},e}function D(){var e=(0,i.default)(["serverEphemeral: ",""]);return D=function(){return e},e}function N(){var e=(0,i.default)(["server hello content: ",""]);return N=function(){return e},e}function L(){var e=(0,i.default)(["openChatSocket rcv hello"]);return L=function(){return e},e}function k(){var e=(0,i.default)(["verifying certificate"]);return k=function(){return e},e}function U(){var e=(0,i.default)(["openChatSocket send hello"]);return U=function(){return e},e}function F(){var e=(0,i.default)(["openChatSocket preIntro ",""]);return F=function(){return e},e}var G,x=new Uint8Array([87,65,5,s.DICT_VERSION]),B="WhatsAppLongTerm1",Y="142375574d0a587166aae71ebe516437c4a28b73e3695c6ce1f7f9545da8ee6b";function K(){var e=(0,y.getRoutingInfo)(),t=e?e.edgeRouting:null,r=t?(0,p.encodeB64UrlSafe)(t):null,a=new b.default({routingToken:r}),n=v.keyPair();return(0,C.default)(a,"change:socket").cancellable().then((()=>a.socket)).finally((()=>{a.deactivate()})).then((e=>{var r=void 0;if(t){var a=new f.Binary;a.write("ED",0,1),a.writeUint8(t.byteLength>>16),a.writeUint16(65535&t.byteLength),a.writeBuffer(t),r=a.readByteArray(),__LOG__(2)(F(),r)}var i=r?f.Binary.build(r,x).readByteArray():x,s=new o.FrameSocket(e,i);(G=new u.NoiseHandshake(s)).start("Noise_XX_25519_AESGCM_SHA256\0\0\0\0",x),__LOG__(2)(U()),G.authenticate(n.pubKey);var l={clientHello:{ephemeral:n.pubKey}};return G.sendAndReceive((0,c.encodeProto)(A.HandshakeMessageSpec,l).readByteArray())})).then((e=>function(e,t,r){__LOG__(2)(L()),__LOG__(2)(N(),(0,h.toLowerCaseHex)(t));var{serverHello:a}=(0,d.decodeProto)(A.HandshakeMessageSpec,t);if(!a)throw new Error("ServerHello payload error");var{ephemeral:n,static:i,payload:s}=a;if(null==n||null==i||null==s)throw new Error("Missing server Ephemeral");__LOG__(2)(D(),(0,h.toLowerCaseHex)(new Uint8Array(n))),__LOG__(2)(R(),(0,h.toLowerCaseHex)(new Uint8Array(i))),__LOG__(2)(I(),(0,h.toLowerCaseHex)(new Uint8Array(s))),e.authenticate(n),e.mixIntoKey(v.sharedSecret(n,r.privKey));var o=e.decrypt(i),u=o.then((e=>v.sharedSecret(e,r.privKey)));return e.mixIntoKey(u),Promise.all([o,e.decrypt(s),n])}(G,e,n))).then((([e,t,r])=>(__LOG__(2)(k()),function(e,t){var r=(0,d.decodeProto)(A.NoiseCertificateSpec,e);if(!r)throw new Error("Missing server Ephemeral");var a=r.details,n=r.signature;if(!a)throw new Error("verifyCertificate cert missing details");if(!n)throw new Error("verifyCertificate cert missing signature");var i=(0,d.decodeProto)(A.DetailsSpec,a);if(i.issuer!==B)throw new Error('verifyCertificate unrecognized issuer "'.concat(String(i.issuer),'"'));if(null!=i.expires&&(0,_.castLongIntToUnixTime)(i.expires)>(0,_.unixTime)())throw new Error("verifyCertificate cert has expired");if(!i.key)throw new Error("verifyCertificate cert has no key detail");if(!(0,l.areBuffersEqual)(i.key,t))throw new Error("verifySignature cert key does not match issuer");if(!v.verifySignature(new Uint8Array((0,h.parseHex)(Y)),new Uint8Array(a),new Uint8Array(n)))throw new Error("verifyCertificate cert poorly signed!")}(t,e),r)))}function j(e,t,r){var a=Promise.resolve(e.pubKey),n=t.encrypt(a);if(!r)return Promise.reject(new Error("staticAgreement called before serverKeys"));var i=v.sharedSecret(r,e.privKey);return t.mixIntoKey(i),n}},35129:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.decryptSignalProto=function(e,t,r){var a=new window.libsignal.SessionCipher((0,o.default)(),(0,l.createSignalAddress)(e));return Promise.resolve(a).then((e=>{switch(t){case u.CiphertextType.Pkmsg:return e.decryptPreKeyWhisperMessage(r);case u.CiphertextType.Msg:return e.decryptWhisperMessage(r);default:return Promise.reject("decryptSignalProto: Received unsupported msg type ".concat(t))}})).catch((e=>{if(e&&"call_failure"===e.reason&&e.value&&"number"==typeof e.value.result)__LOG__(3)(f(),e.value.result);else{if(e&&"MessageCounterError"===e.name)return Promise.reject(new i.SignalMessageCounterError(e));__LOG__(3)(c(),e)}return Promise.reject(new i.SignalDecryptionError(e))}))},t.encryptSignalProto=function(e,t){var r=new window.libsignal.SessionCipher((0,o.default)(),(0,l.createSignalAddress)(e));return Promise.resolve(r).then((e=>e.encrypt(t))).then((({type:e,body:t})=>(__LOG__(2)(d(),e),{type:3===e?u.CiphertextType.Pkmsg:u.CiphertextType.Msg,ciphertext:(0,l.strToBuffer)(t)})))},t.decryptGroupSignalProto=function(e,t,r){var a=new window.libsignal.GroupCipher((0,o.default)(),e.toString({legacy:!0}),(0,l.createSignalAddress)(t));return Promise.resolve(a).then((e=>e.decryptSenderKeyMessage(r))).catch((e=>e&&"MessageCounterError"===e.name?Promise.reject(new i.SignalMessageCounterError(e)):Promise.reject(new i.SignalDecryptionError(e))))},t.encryptSenderKeyMsgSignalProto=function(e,t){var r=new window.libsignal.GroupCipher((0,o.default)(),e.toString({legacy:!0}),(0,l.createSignalAddress)((0,s.assertGetMe)()));return Promise.resolve(r).then((e=>e.encrypt(t))).then((e=>({ciphertext:(0,l.strToBuffer)(e)})))};var n=a(r(19976)),i=r(20787),s=r(95595),o=a(r(41186)),u=r(96571),l=r(44762);function d(){var e=(0,n.default)(["encryptSignalProto complete, type=",""]);return d=function(){return e},e}function c(){var e=(0,n.default)(["decryptSignalProto js error ",""]);return c=function(){return e},e}function f(){var e=(0,n.default)(["decryptSignalProto error code ",""]);return f=function(){return e},e}},20787:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SignalMessageCounterError=t.SignalDecryptionError=void 0;var a=r(29351);class n extends((0,a.customError)("SignalDecryptionError")){}t.SignalDecryptionError=n;class i extends((0,a.customError)("SignalMessageCounterError")){}t.SignalMessageCounterError=i},44480:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.waSignalStore=void 0;var n=a(r(19976)),i=a(r(79711)),s=r(66824),o=r(43097);function u(){var e=(0,n.default)(["getPreKeys: no prekey needs to be generated, avaliable: ",", need: ",""]);return u=function(){return e},e}var l="signal_reg_id",d="signal_static_pubkey",c="signal_static_privkey",f="signal_next_pk_id",p="signal_last_spk_id",h="signal_first_unupload_pk_id",_="signal_sever_has_pre_keys",m="adv_signed_identity",g={name:"AES-CTR",length:128,counter:new Uint8Array(16)};function v(e){return self.crypto.subtle.generateKey({name:g.name,length:g.length},!1,["encrypt","decrypt"]).then((t=>self.crypto.subtle.encrypt(g,t,e).then((e=>({encKey:t,value:e})))))}function E(e){return self.crypto.subtle.decrypt(g,e.encKey,e.value)}var y=new class{constructor(){this.idToSignedPreKey=new Map,i.default.on("logout",(()=>{this.registrationInfo=void 0,this.idToSignedPreKey.clear()}))}getMeta(e){return(0,s.getMetaTable)().get(e).then((e=>e?e.value:null))}putMeta(e){var t=(0,s.getMetaTable)(),r=e.map((e=>t.createOrReplace(e)));return Promise.all(r).then()}setServerHasPreKeys(e){this.putMeta([{key:_,value:e}])}getServerHasPreKeys(){return this.getMeta(_)}putADVSignedIdentity(e){return this.putMeta([{key:m,value:e}])}getADVSignedIdentity(){return this.getMeta(m)}getPreKeysByRange(e,t){return(0,s.getPreKeyTable)().greaterThan(["keyId"],e-1,{limit:t})}getPreKeyById(e){return(0,s.getPreKeyTable)().get(e)}removePreKeyById(e){return(0,s.getPreKeyTable)().remove(e)}bulkRmovePreKey(e){return(0,s.getPreKeyTable)().bulkRemove(e)}putPreKeys(e){var t=(0,s.getPreKeyTable)(),r=e.map((e=>{var{keyId:r,keyPair:a,isDirectDistribution:n}=e;return t.get(r).then((e=>{if(e)throw Error("preKey id ".concat(r," already exists"));return t.create({keyId:r,keyPair:a,isDirectDistribution:n})}))}));return Promise.all(r).then()}markPreKeyAsDirectDistribution(e){return(0,s.getPreKeyTable)().merge(e,{isDirectDistribution:1})}getSignedPreKey(){return this.getMeta(p).then((e=>this.getSignedPreKeyById(e)))}getSignedPreKeyById(e){return this.idToSignedPreKey.has(e)?Promise.resolve(this.idToSignedPreKey.get(e)):(0,s.getSignedPreKeyTable)().get(e).then((t=>(this.idToSignedPreKey.set(e,t),t)))}putSignedPreKeys(e){var t=(0,s.getSignedPreKeyTable)(),r=e.map((e=>{var{keyId:r,keyPair:a,signature:n}=e;return t.get(r).then((e=>{if(e)throw Error("signed preKey id ".concat(r," already exists"));return t.create({keyId:r,keyPair:a,signature:n})}))}));return Promise.all(r).then()}putSession(e,t){return(0,s.getSessionTable)().createOrReplace({address:e,session:t})}bulkPutSession(e){return(0,s.getSessionTable)().bulkCreateOrReplace(e)}removeSession(e){return(0,s.getSessionTable)().remove(e)}getSession(e){return(0,s.getSessionTable)().get(e).then((e=>e?e.session:null))}bulkGetSession(e){return(0,s.getSessionTable)().bulkGet(e).then((e=>e.map((e=>e?e.session:null))))}putIdentity(e,t){return(0,s.getIdentityTable)().createOrReplace({identifier:e,identityKey:t})}bulkPutIdentity(e){return(0,s.getIdentityTable)().bulkCreateOrReplace(e)}bulkGetIdentity(e){return(0,s.getIdentityTable)().bulkGet(e).then((e=>e.map((e=>e?e.identityKey:null))))}getIdentity(e){return(0,s.getIdentityTable)().get(e).then((e=>e?e.identityKey:null))}removeIdentity(e){return(0,s.getIdentityTable)().remove(e)}saveBaseKey(e,t,r){return(0,s.getBaseKeyTable)().createOrReplace({address:e,originalMsgId:t,baseKey:r})}loadBaseKey(e,t){return(0,s.getBaseKeyTable)().equals(["address","originalMsgId"],[e,t]).then((e=>e&&0!==e.length?e[0].baseKey:null))}deleteBaseKey(e,t){var r=(0,s.getBaseKeyTable)();return r.equals(["address","originalMsgId"],[e,t]).then((e=>{if(e&&0!==e.length)return r.remove(e[0].id)}))}putSenderKey(e,t,r){return(0,s.getSenderKeyTable)().createOrReplace({senderKeyName:e,senderId:t,senderKey:r})}bulkPutSenderKey(e){return(0,s.getSenderKeyTable)().bulkCreateOrReplace(e)}removeSenderKey(e){return(0,s.getSenderKeyTable)().remove(e)}getSenderKey(e){return(0,s.getSenderKeyTable)().get(e).then((e=>e?e.senderKey:null))}removeSenderKeyBySenderId(e){var t=(0,s.getSenderKeyTable)();return t.equals(["senderId"],e).then((e=>t.bulkRemove(e.map((e=>e.senderKeyName)))))}clearCredential(){var e=[(0,s.getIdentityTable)(),(0,s.getMetaTable)(),(0,s.getPreKeyTable)(),(0,s.getSessionTable)(),(0,s.getSignedPreKeyTable)()];return Promise.all(e.map((e=>e.clear()))).then((()=>{}))}getRegistrationInfo(){return null!=this.registrationInfo?Promise.resolve(this.registrationInfo):Promise.all([this.getMeta(l),this.getMeta(d),this.getMeta(c)]).then((([e,t,r])=>{if(e&&t&&r)return Promise.all([E(t),E(r)]).then((([t,r])=>(this.registrationInfo={registrationId:e,identityKeyPair:{pubKey:t,privKey:r}},this.registrationInfo)))}))}setRegistrationInfo(e){return Promise.all([v(e.identityKeyPair.pubKey),v(e.identityKeyPair.privKey)]).then((([t,r])=>Promise.all([this.putMeta([{key:l,value:e.registrationId},{key:d,value:t},{key:c,value:r}])]).then()))}getOrGenPreKeys(e,t){return(0,o.getStorage)().lock(["signal-meta-store","prekey-store"],(()=>Promise.all([this.getMeta(h),this.getMeta(f)]).then((([r,a])=>{var n=r||1,i=a||1,s=i-n,o=e-s;if(o<=0)return __LOG__(2)(u(),s,e),this.getPreKeysByRange(n,e);var l=function(e,t){for(var r=[],a=e;a<t;a++)r.push(a);return r}(i,i+o).map((e=>t(e)));return Promise.all(l).then((e=>this.savePreKeys(e))).then((()=>this.getPreKeysByRange(n,e)))}))))}getOrGenSinglePreKey(e){return this.getOrGenPreKeys(1,e).then((e=>{if(1!==e.length)throw Error("Expected to get exactly one key but got ${keys.length}");return e[0]}))}savePreKeys(e){if(0===e.length)return Promise.resolve();var t=e[e.length-1];return Promise.all([this.putMeta([{key:f,value:t.keyId+1}]),this.putPreKeys(e)]).then()}markKeyAsUploaded(e){return Promise.all([this.getMeta(h),this.getMeta(f)]).then((([t,r])=>{if(e<0||!r||e>=r)throw Error("markKeyAsUploaded: key ".concat(e," is out of boundary."));var a=t?Math.max(t,e+1):e+1;return this.putMeta([{key:h,value:a}])}))}rotateSignedPreKey(e,t){return(0,o.getStorage)().lock(["signal-meta-store","signed-prekey-store"],(()=>this.getMeta(p).then((r=>{var a=null==r?1:r+1;return t(e,a).then((e=>(this.putSignedPreKeys([e]),this.putMeta([{key:p,value:a}]),e)))}))))}};t.waSignalStore=y},44762:(e,t)=>{"use strict";function r(e,t){for(var r=0;r<t;r++)e.writeUint8(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.unpad=function(e){var t=new Uint8Array(e);if(0===t.length)throw new Error("unpadPkcs7 given empty bytes");var r=t[t.length-1];if(r>t.length)throw new Error("unpad given ".concat(t.length," bytes, but pad is ").concat(r));return new Uint8Array(t.buffer,t.byteOffset,t.length-r)},t.writeRandomPadMax16=function(e){var t=new Uint8Array(1);self.crypto.getRandomValues(t),r(e,1+(15&t[0]))},t.writePad=r,t.strToBuffer=function(e){return new window.dcodeIO.ByteBuffer.wrap(e,"binary").toArrayBuffer()},t.bufferToStr=function(e){return new window.dcodeIO.ByteBuffer.wrap(e).toString("binary")},t.bufferEqual=function(e,t){if(!e||!t)return!1;if(e.byteLength!==t.byteLength)return!1;for(var r=new DataView(e),a=new DataView(t),n=0;n<r.byteLength;n++)if(r.getUint8(n)!==a.getUint8(n))return!1;return!0},t.createSignalAddress=function(e){if(!(e.isUser()||e.isServer()||e.isPSA()))throw new Error("Jid ".concat(e.toString({legacy:!0}),' is not fully qualified, jid.server should be "s.whatsapp.net"'));return new window.libsignal.SignalProtocolAddress(e.getSignalAddress(),0)}},32602:(e,t,r)=>{"use strict";var a=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.Session=t.Cipher=t.KeyGenerator=void 0;var n=a(r(93912)),i=a(r(35129)),s=a(r(55660)),o=n;t.KeyGenerator=o;var u=i;t.Cipher=u;var l=s;t.Session=l},93912:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.generatePreKeyPair=function(e){return window.libsignal.KeyHelper.generatePreKey(e).then((e=>{var{keyId:t,keyPair:r}=e;return{keyId:t,keyPair:(0,a.toCurveKeyPair)(r),isDirectDistribution:0}}))},t.generateSignedKeyPair=function(e,t){return window.libsignal.KeyHelper.generateSignedPreKey(e,t).then((e=>{var{keyId:t,keyPair:r,signature:n}=e;return{keyId:t,keyPair:(0,a.toCurveKeyPair)(r),signature:n}}))},t.generateIdentityKeyPair=function(){return window.libsignal.KeyHelper.generateIdentityKeyPair().then((e=>(0,a.toCurveKeyPair)(e)))};var a=r(72434)},73745:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.stringifyIdentityKey=function(e){return e instanceof ArrayBuffer?(0,a.bufferToStr)(e):e};var a=r(44762)},41186:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return s},t.enableMemSignalStore=function(){s=n.default},t.enablePersistSignalStore=function(){s=i.default};var n=a(r(16098)),i=a(r(12040)),s=i.default},16098:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(52954)),i=a(r(79711)),s=r(73745),o=r(72434),u=r(44480);var l=new class{constructor(){this.Direction={SENDING:1,RECEIVING:2},this.RegistrationInfo=null,this.SignedPreKeyStore=new Map,this.SessionStore=new Map,this.IdentityStore=new Map,this.PrekeyStore=new Map,this.SenderKeyStore=new Map,i.default.on("logout",(()=>{this.cleanStorage()}))}getIdentityKeyPair(){var e=this;return(0,n.default)((function*(){var t;return e.RegistrationInfo||(e.RegistrationInfo=yield u.waSignalStore.getRegistrationInfo()),(null===(t=e.RegistrationInfo)||void 0===t?void 0:t.identityKeyPair)?(0,o.toSignalCurveKeyPair)(e.RegistrationInfo.identityKeyPair):void 0}))()}getLocalRegistrationId(){var e=this;return(0,n.default)((function*(){var t;return e.RegistrationInfo||(e.RegistrationInfo=yield u.waSignalStore.getRegistrationInfo()),(null===(t=e.RegistrationInfo)||void 0===t?void 0:t.registrationId)||void 0}))()}isTrustedIdentity(){return Promise.resolve(!0)}loadIdentityKey(e){var t=this;return(0,n.default)((function*(){if(null==e)throw new Error("Tried to get identity key for undefined/null key");if(!t.IdentityStore.has(e)){var r=yield u.waSignalStore.getIdentity(e);t.IdentityStore.set(e,r)}return t.IdentityStore.get(e)||void 0}))()}saveIdentity(e,t){if(null==e)return Promise.reject(new Error("Tried to put identity key for undefined/null key"));var r=(0,s.stringifyIdentityKey)(t);return this.IdentityStore.set(e,r),Promise.resolve()}loadPreKey(e){var t=this;return(0,n.default)((function*(){if(null!=e){if(!t.PrekeyStore.has(e)){var r,a=null===(r=yield u.waSignalStore.getPreKeyById(e))||void 0===r?void 0:r.keyPair;t.PrekeyStore.set(e,{keyPair:a})}var n=t.PrekeyStore.get(e);return(null==n?void 0:n.keyPair)||void 0}}))()}removePreKey(e){return null==e?Promise.reject(new Error("Tried to remove pre key without keyId")):(this.PrekeyStore.set(e,{deleted:!0}),Promise.resolve())}loadSignedPreKey(e){var t=this;return(0,n.default)((function*(){if(null!=e){if(!t.SignedPreKeyStore.has(e)){var r,a=null===(r=yield u.waSignalStore.getSignedPreKeyById(e))||void 0===r?void 0:r.keyPair;t.SignedPreKeyStore.set(e,a)}return t.SignedPreKeyStore.get(e)||void 0}}))()}loadSession(e){var t=this;return(0,n.default)((function*(){if(null!=e){if(!t.SessionStore.has(e)){var r=yield u.waSignalStore.getSession(e);t.SessionStore.set(e,r)}return t.SessionStore.get(e)||void 0}}))()}storeSession(e,t){return null==e?Promise.reject(new Error("Tried to put session without identifier")):(this.SessionStore.set(e,t),Promise.resolve())}storeSenderKey(e,t){return null==e?Promise.reject(new Error("Tried to put session without identifier")):(this.SenderKeyStore.set(e,t),Promise.resolve())}loadSenderKey(e){var t=this;return(0,n.default)((function*(){if(null!=e){if(!t.SenderKeyStore.has(e)){var r=yield u.waSignalStore.getSenderKey(e);t.SenderKeyStore.set(e,r)}return t.SenderKeyStore.get(e)||void 0}}))()}cleanStorage(){this.RegistrationInfo=null,this.SessionStore.clear(),this.IdentityStore.clear(),this.PrekeyStore.clear(),this.SignedPreKeyStore.clear(),this.SenderKeyStore.clear()}_generateSessionUpdate(){var e=[];return Array.from(this.SessionStore.keys()).forEach((t=>{var r=this.SessionStore.get(t);r&&e.push({address:t,session:r})})),e}_generateSenderKeyUpdate(){var e=[];return Array.from(this.SenderKeyStore.keys()).forEach((t=>{var r=this.SenderKeyStore.get(t);if(r){var a=t.split("::");2===a.length&&e.push({senderKeyName:t,senderId:a[1],senderKey:r})}})),e}_generateIdentityUpdate(){var e=[];return Array.from(this.IdentityStore.keys()).forEach((t=>{var r=this.IdentityStore.get(t);r&&e.push({identifier:t,identityKey:r})})),e}_generatePreKeyUpdate(){var e=[];return Array.from(this.PrekeyStore.keys()).forEach((t=>{var r=this.PrekeyStore.get(t);r&&r.deleted&&e.push(parseInt(t,10))})),e}generateSnapshot(){return{sessionUpdate:this._generateSessionUpdate(),senderKeyUpdate:this._generateSenderKeyUpdate(),identityUpdate:this._generateIdentityUpdate(),preKeyRemove:this._generatePreKeyUpdate()}}};t.default=l},12040:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(52954)),i=r(73745),s=r(72434),o=r(69710),u=r(44480);var l=new class{constructor(){this.Direction={SENDING:1,RECEIVING:2}}getIdentityKeyPair(){return(0,n.default)((function*(){var e=yield u.waSignalStore.getRegistrationInfo(),t=null==e?void 0:e.identityKeyPair;return t?(0,s.toSignalCurveKeyPair)(t):void 0}))()}getLocalRegistrationId(){return(0,n.default)((function*(){var e=yield u.waSignalStore.getRegistrationInfo();return(null==e?void 0:e.registrationId)||void 0}))()}isTrustedIdentity(){return Promise.resolve(!0)}loadIdentityKey(e){return(0,n.default)((function*(){if(null==e)throw new Error("Tried to get identity key for undefined/null key");return(yield u.waSignalStore.getIdentity(e))||void 0}))()}saveIdentity(e,t){return(0,n.default)((function*(){if(null==e)throw new Error("Tried to put identity key for undefined/null key");var r=(0,i.stringifyIdentityKey)(t),a=yield u.waSignalStore.getIdentity(e);a&&a===r||(a&&(yield(0,o.handleNewIdentity)(e)),yield u.waSignalStore.putIdentity(e,r))}))()}removeIdentity(e){return null==e?Promise.reject(new Error("Tried to remove identity key for undefined/null key")):u.waSignalStore.removeIdentity(e)}loadPreKey(e){return(0,n.default)((function*(){if(null==e)return Promise.resolve(void 0);var t=yield u.waSignalStore.getPreKeyById(e);return(null==t?void 0:t.keyPair)||void 0}))()}removePreKey(e){return null==e?Promise.reject(new Error("Tried to remove pre key without keyId")):u.waSignalStore.removePreKeyById(e)}loadSignedPreKey(e){return(0,n.default)((function*(){if(null==e)return Promise.resolve(void 0);var t=yield u.waSignalStore.getSignedPreKeyById(e);return(null==t?void 0:t.keyPair)||void 0}))()}loadSession(e){return(0,n.default)((function*(){return null==e?Promise.resolve(void 0):(yield u.waSignalStore.getSession(e))||void 0}))()}storeSession(e,t){return null==e?Promise.reject(new Error("Tried to put session without identifier")):u.waSignalStore.putSession(e,t)}removeSession(e){return null==e?Promise.reject(new Error("Tried to remove session without identifier")):u.waSignalStore.removeSession(e)}containSessions(e){return u.waSignalStore.bulkGetSession(e).then((e=>e.map((e=>!!e))))}storeSenderKey(e,t){if(null==e)return Promise.reject(new Error("Tried to put senderKey without senderKeyName"));var r=e.split("::");if(r.length<2)return Promise.reject(new Error("Tried to put senderKey with invalid senderKeyName"));var a=r[1];return u.waSignalStore.putSenderKey(e,a,t)}loadSenderKey(e){return(0,n.default)((function*(){return null==e?Promise.resolve(void 0):(yield u.waSignalStore.getSenderKey(e))||void 0}))()}};t.default=l},55660:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.createSignalSession=function(){return A.apply(this,arguments)},t.hasSignalSessions=function(e){return c.default.containSessions(e.map((e=>(0,h.createSignalAddress)(e).toString())))},t.getRemoteRegId=function(e){var t=new window.libsignal.SessionCipher(c.default,(0,h.createSignalAddress)(e));return Promise.resolve(t).then((e=>e.getRemoteRegistrationId()))},t.deleteRemoteInfo=function(e){var t=(0,h.createSignalAddress)(e).toString();return Promise.all([c.default.removeIdentity(t),c.default.removeSession(t)]).then((()=>{}))},t.saveSessionBaseKey=function(e,t){var r=(0,h.createSignalAddress)(e);return new window.libsignal.SessionInfo(c.default,r).getSessionBaseKey().then((e=>e?p.waSignalStore.saveBaseKey(r.toString(),t,e):(__LOG__(2)(b(),t),Promise.resolve())))},t.hasSameBaseKey=function(e,t){var r=(0,h.createSignalAddress)(e),a=new window.libsignal.SessionInfo(c.default,(0,h.createSignalAddress)(e));return Promise.all([a.getSessionBaseKey(),p.waSignalStore.loadBaseKey(r.toString(),t)]).then((([e,r])=>r?e?(0,h.bufferEqual)(r,e)?(__LOG__(2)(E(),t),!0):(__LOG__(2)(y(),t),!1):(__LOG__(2)(S(),t),!1):(__LOG__(2)(T(),t),!1)))},t.createGroupSignalSession=function(e,t,r){var a=new window.libsignal.GroupCipher((0,f.default)(),t,(0,h.createSignalAddress)(e));return Promise.resolve(a).then((e=>e.decryptSenderKeyDistributionMessage(r)))},t.getGroupSenderKeyInfo=function(e){return new window.libsignal.GroupCipher(c.default,e.toString({legacy:!0}),(0,h.createSignalAddress)((0,d.assertGetMe)())).createSenderKeyDistributionMsg().then((e=>(0,h.strToBuffer)(e)))},t.deleteGroupSenderKeyInfo=function(e){var t=(0,h.createSignalAddress)((0,d.assertGetMe)()),r="".concat(e.toString({legacy:!0}),"::").concat(t.toString());return p.waSignalStore.removeSenderKey(r)},t.deleteDeviceSenderKey=function(e){var t=String((0,h.createSignalAddress)(e));return p.waSignalStore.removeSenderKeyBySenderId(t)};var n=a(r(19976)),i=a(r(52954)),s=r(46378),o=r(12250),u=a(r(50935)),l=r(72434),d=r(95595),c=a(r(12040)),f=a(r(41186)),p=r(44480),h=r(44762);function _(){var e=(0,n.default)(["Assertion failed!"]);return _=function(){return e},e}function m(){var e=(0,n.default)(["Assertion failed!"]);return m=function(){return e},e}function g(){var e=(0,n.default)(["Assertion failed!"]);return g=function(){return e},e}function v(){var e=(0,n.default)(["Signal::createSignalSession with "]);return v=function(){return e},e}function E(){var e=(0,n.default)(["hasSameBaseKey: MsgId: ",", savedBaseKey and sessionBaseKey is same"]);return E=function(){return e},e}function y(){var e=(0,n.default)(["hasSameBaseKey: MsgId: ",", savedBaseKey and sessionBaseKey is different "]);return y=function(){return e},e}function S(){var e=(0,n.default)(["hasSameBaseKey: MsgId: ",", no session has been saved locally "]);return S=function(){return e},e}function T(){var e=(0,n.default)(["hasSameBaseKey: MsgId: ",", no base key has been saved locally "]);return T=function(){return e},e}function b(){var e=(0,n.default)(["saveSessionBaseKey: for ",", no basekey provided"]);return b=function(){return e},e}function A(){return(A=(0,i.default)((function*(e){var t,r,a,{wid:n,identity:i,deviceIdentity:d}=e;if(__LOG__(2)(v()),null!=n.device&&n.device!==u.default.DEVICE.PRIMARY_DEVICE){if(!d)throw new Error("Signal::createSignalSession: expected device-identity in keyBundle for companion device");if(!(yield(0,o.validateADVwithIdentityKey)(n,d,i)))throw new Error("Signal::createSignalSession: invalid identityKey fetched")}try{t=(0,l.toSignalCurvePubKey)(new s.Binary(e.identity).readBuffer())}catch(e){throw __LOG__(4,void 0,new Error,!0)(g()),SEND_LOGS("Signal::createSignalSession: invalid identityKey fetched"),e}try{r=(0,l.toSignalCurvePubKey)(new s.Binary(e.skey.pubkey).readBuffer())}catch(e){throw __LOG__(4,void 0,new Error,!0)(m()),SEND_LOGS("Signal::createSignalSession: invalid signedPreKey fetched"),e}if(e.key)try{a=(0,l.toSignalCurvePubKey)(new s.Binary(e.key.pubkey).readBuffer())}catch(e){__LOG__(4,void 0,new Error,!0)(_()),SEND_LOGS("Signal::createSignalSession: invalid preKey fetched")}var f={registrationId:e.regId,identityKey:t,signedPreKey:{keyId:e.skey.id,publicKey:r,signature:new s.Binary(e.skey.signature).readBuffer()}};return e.key&&a&&(f.preKey={keyId:e.key.id,publicKey:a}),new window.libsignal.SessionBuilder(c.default,(0,h.createSignalAddress)(n)).processPreKey(f)}))).apply(this,arguments)}},69779:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.xmppSignedPreKey=function(e){return(0,i.wap)("skey",null,(0,i.wap)("id",null,(0,i.BIG_ENDIAN_CONTENT)(e.keyId,3)),(0,i.wap)("value",null,e.keyPair.pubKey),(0,i.wap)("signature",null,e.signature))},t.xmppPreKey=function(e){return(0,i.wap)("key",null,(0,i.wap)("id",null,(0,i.BIG_ENDIAN_CONTENT)(e.keyId,3)),(0,i.wap)("value",null,e.keyPair.pubKey))},t.extractIdentityKey=function(e){var t=window.dcodeIO.ByteBuffer.wrap(e);t.readUint8();try{var r=window.libsignal.Protobuf.PreKeyWhisperMessage.decode(t);return(0,s.toCurveKeyPubKey)(r.identityKey.toArrayBuffer())}catch(e){return __LOG__(3)(o()),null}};var n=a(r(19976)),i=r(30691),s=r(72434);function o(){var e=(0,n.default)(["extractIdentityKey: parse proto failed"]);return o=function(){return e},e}},85027:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.startBackend=j;var n=a(r(52954)),i=a(r(19976)),s=r(47882),o=a(r(57529)),u=r(83662),l=a(r(11809)),d=a(r(79711)),c=r(54086),f=r(38815),p=r(29634),h=r(95595),_=a(r(18120)),m=a(r(38165)),g=r(48816),v=r(11008),E=r(62669),y=r(15971),S=r(77609),T=r(35914),b=a(r(72424)),A=r(44480),C=r(61392),P=r(58678),O=r(95207),w=r(97148),M=r(29738),I=a(r(12767)),R=r(87078),D=r(10902),N=r(15447),L=a(r(40210)),k=r(31822),U=r(82284),F=r(6446),G=a(r(72291));function x(){var e=(0,i.default)(["startBackendRegistered: chatd user not registered"]);return x=function(){return e},e}function B(){var e=(0,i.default)(["startBackend"]);return B=function(){return e},e}function Y(){var e=(0,i.default)(["storage initialization error, logging out"]);return Y=function(){return e},e}function K(){var e=(0,i.default)(["debug setup failed:"]);return K=function(){return e},e}function j(){return W.apply(this,arguments)}function W(){return(W=(0,n.default)((function*(){if(__LOG__(2)(B()),A.waSignalStore.getRegistrationInfo()){try{yield Promise.all([(0,v.initialize)(),(0,g.initialize)()]),yield(0,E.initialize)()}catch(e){d.default.storageInitializationError()}var e=yield(0,p.getTable)().count(),t=yield A.waSignalStore.getServerHasPreKeys();yield H(),yield(0,c.startComms)(m.default,T.sendPing,{passive:e>0||!t}),yield(0,c.waitForConnection)(),k.OfflineResumeReporter.logSocketConnectT();var r=[];e>0&&r.push((0,u.sendAndClearDanglingReceipts)()),t||((0,N.setDeviceLinkPairStage)(L.default.MD_LINK_DEVICE_COMPANION_STAGE.UPLOAD_PREKEYS),r.push((0,M.uploadPreKeys)())),yield Promise.all(r),(0,N.setDeviceLinkPairStage)(L.default.MD_LINK_DEVICE_COMPANION_STAGE.COMPLETE),(0,N.commitDeviceLinkEvent)(),yield(0,S.sendPassiveIq)(!1),(0,y.isABPropsAfterFirstSync)()||(yield(0,R.syncABPropsTask)()),yield(0,w.updateABPropsFromStorage)(),yield(0,C.initialize)(),yield(0,c.startHandlingRequests)(),yield o.default.syncCriticalDataIfNeeded(),yield o.default.continueProgressiveHistorySyncProcessing(),yield(0,D.startWebPersistedJobManager)(),yield G.default.waitForFinalDbMsgEncKey(),yield l.default.reInit(),null==b.default.serverPropsVersion&&(yield(0,F.queryServerProps)()),(0,P.registerTasks)(),V(),(0,f.runSyncDirtyContactsJob)()}else __LOG__(2)(x())}))).apply(this,arguments)}function V(){(0,O.applyContactBusinessProps)(),(0,U.restoreLabels)(),(0,U.restoreQuickReplies)(),(0,U.restoreLabelAssociations)(),(0,U.restoreCarts)()}function H(){return q.apply(this,arguments)}function q(){return(q=(0,n.default)((function*(){var e=r(95595),t=r(76022).default,{loadProtoVersions:a}=r(36927),n=e.getVersion(),i=n&&n.protoVersion||[0,17];yield a(),_.default.setVersion(i),t.setVersion(i,10,"EAEYASACKAEwAjgBQAFIAVgBYAFoAXgBmAEBoAEBqAEBsAECuAEBwAEByAEB0AEA2AEB4AEC8AED+AEDgAIDkAIDmAIAqAIDsAIAuAIDwAIB"),b.default.updateSelectiveProps({frequentlyForwardedMessages:1,groupDescLength:512,multicastLimitGlobal:5,frequentlyForwardedMax:5,stickers:1,mdBlocklistV2:1})}))).apply(this,arguments)}d.default.on("main_stream_mode_ready",(()=>{(l.default.startIndexer(),(0,s.syncDeviceList)([(0,h.getMeUser)()])).catch((()=>{__LOG__(2)(K())}))})),d.default.on("md_restart_backend",(()=>{(0,c.stopComms)(),j()})),d.default.on("storage_initialization_error",(0,n.default)((function*(){__LOG__(2)(Y()),yield I.default.clearCredentialsAndStoredData(),d.default.logout()})))},33729:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(70417)),i=a(r(19976)),s=a(r(52954)),o=a(r(43334)),u=r(63487),l=r(3531),d=r(54212),c=r(11008),f=a(r(61941)),p=r(75637),h=r(16976),_=r(8239),m=r(84139),g=r(68519),v=r(61239),E=r(49887);function y(){var e=(0,i.default)(["mute chat sync: REMOVE operation not supported"]);return y=function(){return e},e}function S(){var e=(0,i.default)(["archive chat sync: malformed mutation"]);return S=function(){return e},e}class T extends _.SyncActionBase{constructor(...e){super(...e),this.version=3}getChatJidAndMessageKey(e){var[,t]=e.index;return t||(0,E.throwInvalidActionIndex)(),{chatJid:t,messageKey:null}}setArchive(e){return(0,c.getChatTable)().bulkCreateOrMerge(e).then((()=>{e.forEach((e=>{var t=(0,p.createWid)(e.id),r=o.default.get(t);r&&(r.archive=e.archive)}))}))}validateSyncActionValue(e){var t=e.archiveChatAction;return null!=(null==t?void 0:t.archived)&&(0,d.validateMessageRange)(null==t?void 0:t.messageRange)}applyMutations(e){var t=this;return(0,s.default)((function*(){var r=new Map;yield(0,c.getChatTable)().bulkGet(e.map((e=>{var{indexParts:t}=e,[,r]=t;return r||(0,E.throwInvalidActionIndex)(),(0,p.createWid)(r).toString()}))).then((e=>e.forEach((e=>{e&&r.set(e.id,e)}))));var a=[],n=yield Promise.all(e.map(function(){var e=(0,s.default)((function*(e){try{if("set"===e.operation){var{indexParts:n,value:i}=e,[,s]=n;s||(0,E.throwInvalidActionIndex)();var o=i.archiveChatAction;if(!t.validateSyncActionValue(i))return __LOG__(3)(S()),{actionState:u.SyncActionState.Malformed};var l=(0,f.default)(null==o?void 0:o.archived,"archiveChatAction?.archived"),d=(0,f.default)(null==o?void 0:o.messageRange,"archiveChatAction?.messageRange"),c=(0,p.createWid)(s);if(!r.has(c.toString()))return{actionState:u.SyncActionState.Orphan,orphanModel:{modelType:u.SyncModelType.Chat,modelId:c.toString()}};var h=yield t._applyMutation(c,l,d,i);return h.updates&&a.push(h.updates),h.syncApplyActionResult}return __LOG__(3)(y()),{actionState:u.SyncActionState.Unsupported}}catch(e){return{actionState:u.SyncActionState.Failed}}}));return function(){return e.apply(this,arguments)}}()));return a.length>0&&(yield t.setArchive(a)),n}))()}_applyMutation(e,t,r,a){return(0,s.default)((function*(){yield(0,h.removeActiveMessageRange)(e.toString(),"archive");var n=yield(0,d.constructMessageRange)(e),i=(0,d.compareMessageRanges)(n,r),s=(0,g.encodeProto)(v.SyncActionValueSpec,a).readBuffer();switch(i){case d.MessageRangeEncloseType.RangesAreEqual:return(0,h.addActiveMessageRange)(e.toString(),"archive",s),{updates:{id:e.toString(),archive:t},syncApplyActionResult:{actionState:u.SyncActionState.Success}};case d.MessageRangeEncloseType.RangesNotEnclosing:return(0,h.addActiveMessageRange)(e.toString(),"archive",s),{syncApplyActionResult:{actionState:u.SyncActionState.Orphan,orphanModel:{modelType:u.SyncModelType.Chat,modelId:e.toString()}}};case d.MessageRangeEncloseType.RangeBEnclosesRangeA:return(0,h.addActiveMessageRange)(e.toString(),"archive",s),{updates:{id:e.toString(),archive:t},syncApplyActionResult:{actionState:u.SyncActionState.Orphan,orphanModel:{modelType:u.SyncModelType.Chat,modelId:e.toString()}}};case d.MessageRangeEncloseType.RangeAEnclosesRangeB:return{syncApplyActionResult:{actionState:u.SyncActionState.Success}}}}))()}_constructArchiveChatIndex(e){return JSON.stringify([u.Actions.Archive,e.toString({legacy:!0})])}getArchiveChatMutation(e,t,r){var a=this;return(0,s.default)((function*(){var n={timestamp:e,archiveChatAction:{archived:t,messageRange:yield(0,d.constructMessageRange)(r)}};return{collection:u.CollectionName.RegularLow,index:a._constructArchiveChatIndex(r),binarySyncAction:(0,g.encodeProto)(v.SyncActionValueSpec,n).readBuffer(),version:a.version,operation:l.SyncdMutationSyncdOperation.SET,timestamp:e}}))()}resolveConflicts(e,t){var r,a,i=e=>(0,m.decodeProto)(v.SyncActionValueSpec,e),s=i(e.binarySyncAction),o=i(t.binarySyncAction),l=e.timestamp,c=t.timestamp,p=(0,f.default)(s.archiveChatAction,"pendingMutationValue.archiveChatAction"),_=(0,f.default)(o.archiveChatAction,"incomingMutationValue.archiveChatAction");switch((0,d.compareMessageRanges)((0,f.default)(_.messageRange,"incomingArchiveChatAction.messageRange"),(0,f.default)(p.messageRange,"pendingArchiveChatAction.messageRange"))){case d.MessageRangeEncloseType.RangeAEnclosesRangeB:return u.ConflictResolutionState.ApplyRemoteAndDropLocal;case d.MessageRangeEncloseType.RangeBEnclosesRangeA:return u.ConflictResolutionState.SkipRemote;case d.MessageRangeEncloseType.RangesAreEqual:return l<=c?u.ConflictResolutionState.ApplyRemoteAndDropLocal:u.ConflictResolutionState.SkipRemote;case d.MessageRangeEncloseType.RangesNotEnclosing:var E=l<=c?null!==(r=_.archived)&&void 0!==r&&r:null!==(a=p.archived)&&void 0!==a&&a,y=(0,d.mergeMessageRanges)((0,f.default)(_.messageRange,"incomingArchiveChatAction.messageRange"),(0,f.default)(p.messageRange,"pendingArchiveChatAction.messageRange")),S=(0,g.encodeProto)(v.SyncActionValueSpec,(0,n.default)((0,n.default)({},o),{},{archiveChatAction:{archived:E,messageRange:y}})).readBuffer();return(0,d.lockForMessageRangeSync)([],[(0,n.default)((0,n.default)({},e),{},{binarySyncAction:S})],(()=>{var t=JSON.parse(e.index);return(0,h.addActiveMessageRange)(t[1],"archive",S)})),u.ConflictResolutionState.SkipRemoteAndDropLocal}}}var b=new T;Object.freeze(b);var A=b;t.default=A},20987:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(70417)),i=a(r(19976)),s=a(r(52954)),o=a(r(61941)),u=r(63487),l=r(3531),d=r(54212),c=r(11008),f=r(75637),p=r(16976),h=r(46638),_=a(r(43334)),m=r(8239),g=r(84139),v=r(68519),E=r(61239),y=r(49887);function S(){var e=(0,i.default)(["apply mutation for clear chat not implemented yet."]);return S=function(){return e},e}function T(){var e=(0,i.default)(["mute chat sync: REMOVE operation not supported"]);return T=function(){return e},e}function b(){var e=(0,i.default)(["clear chat sync: malformed mutation"]);return b=function(){return e},e}class A extends m.SyncActionBase{constructor(...e){super(...e),this.version=3}getChatJidAndMessageKey(e){var[,t]=e.index;return t||(0,y.throwInvalidActionIndex)(),{chatJid:t,messageKey:null}}applyMutations(e){var t=this;return Promise.all(e.map(function(){var e=(0,s.default)((function*(e){try{if("set"===e.operation){var r,{indexParts:a,value:n}=e,[,i,s,o]=a;i&&s&&o||(0,y.throwInvalidActionIndex)();var l=null===(r=n.clearChatAction)||void 0===r?void 0:r.messageRange;if(!l)return __LOG__(3)(b()),{actionState:u.SyncActionState.Malformed};var d=(0,f.createWid)(i),p=d.toString();return(yield(0,c.getChatTable)().get(p))?t._applyMutation(d,l,"1"===s,"0"===o):{actionState:u.SyncActionState.Orphan,orphanModel:{modelType:u.SyncModelType.Chat,modelId:p}}}return __LOG__(3)(T()),{actionState:u.SyncActionState.Unsupported}}catch(e){return{actionState:u.SyncActionState.Failed}}}));return function(){return e.apply(this,arguments)}}()))}_applyMutation(e,t,r){var a=_.default.get(e);return(0,h.clearChat)(a,!r),__LOG__(3)(S()),Promise.resolve({actionState:u.SyncActionState.Malformed})}getClearChatMutation(e,t,r,a){var n=this;return(0,s.default)((function*(){var i={timestamp:e,clearChatAction:{messageRange:yield(0,d.constructMessageRange)(t)}};return{collection:u.CollectionName.RegularLow,index:n._constructClearChatIndex(t,r,a||!1),binarySyncAction:(0,v.encodeProto)(E.SyncActionValueSpec,i).readBuffer(),version:n.version,operation:l.SyncdMutationSyncdOperation.SET,timestamp:e}}))()}_constructClearChatIndex(e,t,r){return JSON.stringify([u.Actions.ClearChat,e.toString({legacy:!0}),t?"1":"0",r?"1":"0"])}resolveConflicts(e,t){var r=e=>(0,g.decodeProto)(E.SyncActionValueSpec,e),a=r(e.binarySyncAction),i=r(t.binarySyncAction),s=e.timestamp,l=t.timestamp,c=(0,o.default)(a.clearChatAction,"pendingMutationValue.clearChatAction"),f=(0,o.default)(i.clearChatAction,"incomingMutationValue.clearChatAction");switch((0,d.compareMessageRanges)((0,o.default)(f.messageRange,"incomingClearChatAction.messageRange"),(0,o.default)(c.messageRange,"pendingClearChatAction.messageRange"))){case d.MessageRangeEncloseType.RangeAEnclosesRangeB:return u.ConflictResolutionState.ApplyRemoteAndDropLocal;case d.MessageRangeEncloseType.RangeBEnclosesRangeA:return u.ConflictResolutionState.SkipRemote;case d.MessageRangeEncloseType.RangesAreEqual:return s<=l?u.ConflictResolutionState.ApplyRemoteAndDropLocal:u.ConflictResolutionState.SkipRemote;case d.MessageRangeEncloseType.RangesNotEnclosing:var h=(0,d.mergeMessageRanges)((0,o.default)(f.messageRange,"incomingClearChatAction.messageRange"),(0,o.default)(c.messageRange,"pendingClearChatAction.messageRange")),_=(0,v.encodeProto)(E.SyncActionValueSpec,(0,n.default)((0,n.default)({},i),{},{clearChatAction:{messageRange:h}})).readBuffer();return(0,d.lockForMessageRangeSync)([],[(0,n.default)((0,n.default)({},e),{},{binarySyncAction:_})],(()=>{var t=JSON.parse(e.index);return(0,p.addActiveMessageRange)(t[1],"clearChat",_)})),u.ConflictResolutionState.SkipRemoteAndDropLocal}}}var C=new A;Object.freeze(C);var P=C;t.default=P},94137:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(70417)),i=a(r(19976)),s=a(r(52954)),o=r(63487),u=r(75637),l=a(r(40147)),d=a(r(7470)),c=r(11008),f=r(64075),p=r(38815),h=r(8239),_=r(41263),m=r(49887);function g(){var e=(0,i.default)(["contact sync: operation not supported"]);return g=function(){return e},e}function v(){var e=(0,i.default)(["contact sync: malformed mutation"]);return v=function(){return e},e}class E extends h.SyncActionBase{constructor(...e){super(...e),this.version=2}applyMutations(e){return(0,s.default)((function*(){var t=[],r=[],a=yield Promise.all(e.map((e=>{try{var a=e.indexParts,[,i]=a;i||(0,m.throwInvalidActionIndex)();var s=(0,u.createUserWid)(i);if("set"===e.operation){var c=e.value.contactAction;if(!c)return __LOG__(3)(v()),{actionState:o.SyncActionState.Malformed};var f={id:i,name:c.fullName||"",shortName:c.firstName||"",type:"in",isAddressBookContact:1,isContactSyncCompleted:0};return t.push(f),d.default.add((0,n.default)((0,n.default)({},f),{},{id:s}),{merge:!0}),(0,p.syncNewContact)(s),{actionState:o.SyncActionState.Success}}if("remove"===e.operation){var h=d.default.get(s);null!=h&&h.setNotMyContact();var _=new l.default({id:s,type:"in"});return r.push(s),d.default.remove([_]),{actionState:o.SyncActionState.Success}}return __LOG__(3)(g()),{actionState:o.SyncActionState.Unsupported}}catch(e){return{actionState:o.SyncActionState.Failed}}})));if(yield(0,c.getContactTable)().bulkCreateOrMerge(t),r.length>0){var i=r.map((e=>(0,_.toJid)(e.user)));yield(0,f.setNotAddressBookContacts)(i)}return a}))()}}var y=new E;Object.freeze(y);var S=y;t.default=S},9999:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(19976)),i=a(r(52954)),s=a(r(61941)),o=r(63487),u=r(3531),l=r(8239),d=r(71684),c=r(49887),f=r(11008),p=r(12425),h=a(r(58885)),_=r(68519),m=r(61239),g=r(84139);function v(){var e=(0,n.default)(["delete_message_for_me_sync: operation not supported"]);return v=function(){return e},e}function E(){var e=(0,n.default)(["delete_message_for_me_sync: msg "," found in storage but not in collection"]);return E=function(){return e},e}class y extends l.SyncActionBase{constructor(...e){super(...e),this.version=3}applyMutations(e){return Promise.all(e.map(function(){var e=(0,i.default)((function*(e){try{if("set"===e.operation){var[,t,r,a,n]=e.indexParts;t&&r&&a&&n||(0,c.throwInvalidActionIndex)();var i=(0,c.syncKeyToMsgKey)(t,r,a,n),s=yield(0,f.getMessageTable)().get(i.toString());if(!s)return{actionState:o.SyncActionState.Orphan,orphanModel:{modelId:i.toString(),modelType:o.SyncModelType.Msg}};yield(0,p.removeMessagesFromHistory)([s.id]);var u=h.default.get(i);return u?u.delete():__LOG__(3)(E(),i),{actionState:o.SyncActionState.Success}}return __LOG__(3)(v()),{actionState:o.SyncActionState.Unsupported}}catch(e){return{actionState:o.SyncActionState.Failed}}}));return function(){return e.apply(this,arguments)}}()))}resolveConflicts(e,t){var r,a,n=e=>(0,g.decodeProto)(m.SyncActionValueSpec,e),i=(0,s.default)(null===(r=n(e.binarySyncAction).deleteMessageForMeAction)||void 0===r?void 0:r.deleteMedia,"decodeValue(localMutation.binarySyncAction).deleteMessageForMeAction?.deleteMedia");return!(0,s.default)(null===(a=n(t.binarySyncAction).deleteMessageForMeAction)||void 0===a?void 0:a.deleteMedia,"decodeValue(remoteMutation.binarySyncAction).deleteMessageForMeAction?.deleteMedia")&&i?o.ConflictResolutionState.SkipRemote:o.ConflictResolutionState.SkipRemoteAndDropLocal}getDeleteForMeMutations(e,t){var r=(0,d.unixTimeMs)();return e.map((e=>{var a={deleteMessageForMeAction:{deleteMedia:t,messageTimestamp:e.t},timestamp:r};return{collection:o.CollectionName.RegularHigh,index:JSON.stringify([o.Actions.DeleteMessageForMe,e.id.remote.toString({legacy:!0}),e.id.id,e.id.fromMe?"1":"0",e.isGroupMsg&&!e.id.fromMe?e.sender.toString({legacy:!0}):"0"]),binarySyncAction:(0,_.encodeProto)(m.SyncActionValueSpec,a).readBuffer(),version:this.version,operation:u.SyncdMutationSyncdOperation.SET,timestamp:r}}))}}var S=new y;Object.freeze(S);var T=S;t.default=T},42138:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(70417)),i=a(r(19976)),s=a(r(52954)),o=r(12824),u=r(63487),l=r(98538),d=r(35855),c=r(28352),f=r(75637),p=r(77993),h=r(8239),_=r(49887);function m(){var e=(0,i.default)(["label jid sync: unsupported operation"]);return m=function(){return e},e}function g(){var e=(0,i.default)(["label jid sync: malformed mutation"]);return g=function(){return e},e}class v extends h.SyncActionBase{constructor(...e){super(...e),this.version=u.LABEL_ASSOCIATION_SYNC_VERSION}applyMutations(e){return Promise.all(e.map(function(){var e=(0,s.default)((function*(e){try{if("set"===e.operation){var t,{indexParts:a,value:i}=e,[,s,h]=a;s&&h||(0,_.throwInvalidActionIndex)();var v=null===(t=i.labelAssociationAction)||void 0===t?void 0:t.labeled;if(null==v)return __LOG__(3)(g()),{actionState:u.SyncActionState.Malformed};var E=(0,f.createWid)(h),y=E.toString(),S={labelId:s,associationId:y,type:l.LabelAssociationType.Jid};if(v){var T=yield(0,d.getTable)().get(y),b=r(46774).default,A=T?null:new b({id:E});yield(0,p.getStorage)().lock(["chat","label-association"],(()=>Promise.all([(0,l.getTable)().createOrReplace(S),A?(0,d.getTable)().create((0,n.default)((0,n.default)({},A.toJSON()),{},{id:y})):null]))),A&&r(43334).default.add(A),(0,c.addToLabelCollection)(y,[s],o.LabelItemParentType.Chat)}else yield(0,l.getTable)().remove([s,y,l.LabelAssociationType.Jid]),(0,c.removeLabelFromCollection)(y,s,o.LabelItemParentType.Chat);return{actionState:u.SyncActionState.Success}}return __LOG__(3)(m()),{actionState:u.SyncActionState.Unsupported}}catch(e){return{actionState:u.SyncActionState.Failed}}}));return function(){return e.apply(this,arguments)}}()))}}var E=new v;Object.freeze(E);var y=E;t.default=y},19869:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(19976)),i=a(r(52954)),s=r(12824),o=r(63487),u=r(98538),l=r(49887),d=r(28352),c=r(12425),f=r(8239);function p(){var e=(0,n.default)(["label message sync: operation not supported"]);return p=function(){return e},e}function h(){var e=(0,n.default)(["label message sync: malformed mutation"]);return h=function(){return e},e}class _ extends f.SyncActionBase{constructor(...e){super(...e),this.version=o.LABEL_ASSOCIATION_SYNC_VERSION}applyMutations(e){return Promise.all(e.map(function(){var e=(0,i.default)((function*(e){try{if("set"===e.operation){var t,{indexParts:r,value:a}=e,[,n,i,f,_,m]=r;n&&i&&f&&_&&m||(0,l.throwInvalidActionIndex)();var g=null===(t=a.labelAssociationAction)||void 0===t?void 0:t.labeled;if(null==g)return __LOG__(3)(h()),{actionState:o.SyncActionState.Malformed};var v=(0,l.syncKeyToMsgKey)(i,f,_,m).toString();if(!(yield(0,c.getMsgByMsgKey)(v)))return{actionState:o.SyncActionState.Orphan,orphanModel:{modelId:v,modelType:o.SyncModelType.Msg}};var E={labelId:n,associationId:v,type:u.LabelAssociationType.Message};return g?(yield(0,u.getTable)().createOrReplace(E),(0,d.addToLabelCollection)(v,[n],s.LabelItemParentType.Msg)):(yield(0,u.getTable)().remove([n,v,u.LabelAssociationType.Message]),(0,d.removeLabelFromCollection)(v,n,s.LabelItemParentType.Msg)),{actionState:o.SyncActionState.Success}}return __LOG__(3)(p()),{actionState:o.SyncActionState.Unsupported}}catch(e){return{actionState:o.SyncActionState.Failed}}}));return function(){return e.apply(this,arguments)}}()))}}var m=new _;Object.freeze(m);var g=m;t.default=g},35701:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(70417)),i=a(r(19976)),s=a(r(52954)),o=r(63487),u=a(r(23539)),l=r(71329),d=r(8239),c=r(49887);function f(){var e=(0,i.default)(["label sync: operation not supported"]);return f=function(){return e},e}function p(){var e=(0,i.default)(["labelEditAction.color is empty"]);return p=function(){return e},e}function h(){var e=(0,i.default)(["labelEditAction.name is empty"]);return h=function(){return e},e}function _(){var e=(0,i.default)(["label sync: malformed mutation"]);return _=function(){return e},e}class m extends d.SyncActionBase{constructor(...e){super(...e),this.version=3}applyMutations(e){return Promise.all(e.map(function(){var e=(0,s.default)((function*(e){try{if("set"===e.operation){var t,{indexParts:r,value:a}=e,[,i]=r;i||(0,c.throwInvalidActionIndex)();var s=a.labelEditAction;if(!s)return __LOG__(3)(_()),{actionState:o.SyncActionState.Malformed};if(s.deleted)return yield(0,l.getTable)().remove(i),u.default.remove(i),{actionState:o.SyncActionState.Success};var{color:d,predefinedId:m}=s,g=null!==(t=s.name)&&void 0!==t?t:"";""===g&&__LOG__(3)(h()),null==d&&__LOG__(3)(p());var v={id:i,name:g,colorIndex:d,predefinedId:m};return yield(0,l.getTable)().createOrReplace(v),u.default.add((0,n.default)({},v),{merge:!0}),{actionState:o.SyncActionState.Success}}return __LOG__(3)(f()),{actionState:o.SyncActionState.Unsupported}}catch(e){return{actionState:o.SyncActionState.Failed}}}));return function(){return e.apply(this,arguments)}}()))}}var g=new m;Object.freeze(g);var v=g;t.default=v},27815:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(19976)),i=a(r(52954)),s=r(63487),o=a(r(17957)),u=a(r(50935)),l=r(8239);function d(){var e=(0,n.default)(["locale setting sync: operation not supported"]);return d=function(){return e},e}function c(){var e=(0,n.default)(["locale setting sync: malformed mutation"]);return c=function(){return e},e}class f extends l.SyncActionBase{constructor(...e){super(...e),this.version=3}applyMutations(e){return Promise.all(e.map(function(){var e=(0,i.default)((function*(e){try{if("set"===e.operation){var{value:t}=e,r=t.localeSetting;if(!r)return __LOG__(3)(c()),{actionState:s.SyncActionState.Malformed};var a=r.locale;return yield o.default.setLocale(a,u.default.L10N_PRIORITY.PHONE),{actionState:s.SyncActionState.Success}}return __LOG__(3)(d()),{actionState:s.SyncActionState.Unsupported}}catch(e){return{actionState:s.SyncActionState.Failed}}}));return function(){return e.apply(this,arguments)}}()))}}var p=new f;Object.freeze(p);var h=p;t.default=h},73404:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(70417)),i=a(r(19976)),s=a(r(52954)),o=a(r(43334)),u=r(63487),l=r(3531),d=r(54212),c=r(11008),f=a(r(61941)),p=r(75637),h=r(16976),_=r(8239),m=r(68519),g=r(84139),v=r(61239),E=r(49887);function y(){var e=(0,i.default)(["mark chat as read sync: operation not supported"]);return y=function(){return e},e}function S(){var e=(0,i.default)(["mark chat as read sync: malformed mutation"]);return S=function(){return e},e}class T extends _.SyncActionBase{constructor(...e){super(...e),this.version=3}_setRead(e,t){var a=o.default.get(e);if(a){var n=r(58269);t?n.markSeen(a):n.markUnseen(a)}}validateSyncActionValue(e){var t=e.markChatAsReadAction;return null!=(null==t?void 0:t.read)&&(0,d.validateMessageRange)(null==t?void 0:t.messageRange)}applyMutations(e){var t=this;return Promise.all(e.map(function(){var e=(0,s.default)((function*(e){try{if("set"===e.operation){var r,a,{indexParts:n,value:i}=e,[,s]=n;if(s||(0,E.throwInvalidActionIndex)(),!t.validateSyncActionValue(i))return __LOG__(3)(S()),{actionState:u.SyncActionState.Malformed};var o=(0,f.default)(null===(r=i.markChatAsReadAction)||void 0===r?void 0:r.read,"value.markChatAsReadAction?.read"),l=(0,f.default)(null===(a=i.markChatAsReadAction)||void 0===a?void 0:a.messageRange,"value.markChatAsReadAction?.messageRange"),d=(0,p.createWid)(s),h=d.toString();return(yield(0,c.getChatTable)().get(h))?t._applyMutation(d,o,l,i):{actionState:u.SyncActionState.Orphan,orphanModel:{modelType:u.SyncModelType.Chat,modelId:h}}}return __LOG__(3)(y()),{actionState:u.SyncActionState.Unsupported}}catch(e){return{actionState:u.SyncActionState.Failed}}}));return function(){return e.apply(this,arguments)}}()))}_applyMutation(e,t,r,a){var n=this;return(0,s.default)((function*(){yield(0,h.removeActiveMessageRange)(e.toString(),"markChatAsRead");var i=yield(0,d.constructMessageRange)(e),s=(0,d.compareMessageRanges)(i,r),o=(0,m.encodeProto)(v.SyncActionValueSpec,a).readBuffer();switch(s){case d.MessageRangeEncloseType.RangesAreEqual:return(0,h.addActiveMessageRange)(e.toString(),"markChatAsRead",o),n._setRead(e,t),Promise.resolve({actionState:u.SyncActionState.Success});case d.MessageRangeEncloseType.RangesNotEnclosing:return(0,h.addActiveMessageRange)(e.toString(),"markChatAsRead",o),Promise.resolve({actionState:u.SyncActionState.Orphan,orphanModel:{modelType:u.SyncModelType.Chat,modelId:e.toString()}});case d.MessageRangeEncloseType.RangeBEnclosesRangeA:return(0,h.addActiveMessageRange)(e.toString(),"markChatAsRead",o),n._setRead(e,t),Promise.resolve({actionState:u.SyncActionState.Orphan,orphanModel:{modelType:u.SyncModelType.Chat,modelId:e.toString()}});case d.MessageRangeEncloseType.RangeAEnclosesRangeB:return Promise.resolve({actionState:u.SyncActionState.Success})}}))()}_constructMarkChatAsReadIndex(e){return JSON.stringify([u.Actions.MarkChatAsRead,e.toString({legacy:!0})])}getMarkChatAsReadMutation(e,t,r){var a=this;return(0,s.default)((function*(){var n={timestamp:e,markChatAsReadAction:{read:t,messageRange:yield(0,d.constructMessageRange)(r)}};return{collection:u.CollectionName.RegularLow,index:a._constructMarkChatAsReadIndex(r),binarySyncAction:(0,m.encodeProto)(v.SyncActionValueSpec,n).readBuffer(),version:a.version,operation:l.SyncdMutationSyncdOperation.SET,timestamp:e}}))()}resolveConflicts(e,t){var r,a,i=e=>(0,g.decodeProto)(v.SyncActionValueSpec,e),s=i(e.binarySyncAction),o=i(t.binarySyncAction),l=e.timestamp,c=t.timestamp,p=(0,f.default)(s.markChatAsReadAction,"pendingMutationValue.markChatAsReadAction"),_=(0,f.default)(o.markChatAsReadAction,"incomingMutationValue.markChatAsReadAction");switch((0,d.compareMessageRanges)((0,f.default)(_.messageRange,"incomingMarkChatAsReadAction.messageRange"),(0,f.default)(p.messageRange,"pendingMarkChatAsReadAction.messageRange"))){case d.MessageRangeEncloseType.RangeAEnclosesRangeB:return u.ConflictResolutionState.ApplyRemoteAndDropLocal;case d.MessageRangeEncloseType.RangeBEnclosesRangeA:return u.ConflictResolutionState.SkipRemote;case d.MessageRangeEncloseType.RangesAreEqual:return l<=c?u.ConflictResolutionState.ApplyRemoteAndDropLocal:u.ConflictResolutionState.SkipRemote;case d.MessageRangeEncloseType.RangesNotEnclosing:var E=l<=c?null!==(r=_.read)&&void 0!==r&&r:null!==(a=p.read)&&void 0!==a&&a,y=(0,d.mergeMessageRanges)((0,f.default)(_.messageRange,"incomingMarkChatAsReadAction.messageRange"),(0,f.default)(p.messageRange,"pendingMarkChatAsReadAction.messageRange")),S=(0,m.encodeProto)(v.SyncActionValueSpec,(0,n.default)((0,n.default)({},o),{},{markChatAsReadAction:{read:E,messageRange:y}})).readBuffer();return(0,d.lockForMessageRangeSync)([],[(0,n.default)((0,n.default)({},e),{},{binarySyncAction:S})],(()=>{var t=JSON.parse(e.index);return(0,h.addActiveMessageRange)(t[1],"markChatAsRead",S)})),u.ConflictResolutionState.SkipRemoteAndDropLocal}}}var b=new T;Object.freeze(b);var A=b;t.default=A},54212:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.constructMessageRange=function(){return c.apply(this,arguments)},t.compareMessageRanges=function(e,t){var r=d(e,t),a=d(t,e);return r&&a?l.RangesAreEqual:r?l.RangeAEnclosesRangeB:a?l.RangeBEnclosesRangeA:l.RangesNotEnclosing},t.mergeMessageRanges=function(e,t){var r,a,n,s,o=(0,i.numberOrThrowIfTooLarge)(null!==(r=e.lastMessageTimestamp)&&void 0!==r?r:0),u=(0,i.numberOrThrowIfTooLarge)(null!==(a=t.lastMessageTimestamp)&&void 0!==a?a:0),l=Math.max(o,u),d={messages:f(e.messages,t.messages,l)};0!==l&&(d.lastMessageTimestamp=l);null==e.lastSystemMessageTimestamp&&null==t.lastSystemMessageTimestamp||(d.lastSystemMessageTimestamp=Math.max((0,i.numberOrThrowIfTooLarge)(null!==(n=e.lastSystemMessageTimestamp)&&void 0!==n?n:0),(0,i.numberOrThrowIfTooLarge)(null!==(s=t.lastSystemMessageTimestamp)&&void 0!==s?s:0)));return d},t.validateMessageRange=function(e){if(null==e)return!1;if(null!=e.lastMessageTimestamp&&0===e.messages.length)return!1;if(e.messages.filter((e=>null!=e.timestamp)).length>1e3)throw new u.SyncdFatalError("syncd: additionalMessages has >1000 messages with timestamp");return!0},t.lockForMessageRangeSync=t.MessageRangeEncloseType=void 0;var n=a(r(52954)),i=r(44880),s=r(75524),o=r(61392),u=r(49859),l=r(28103).Mirrored(["RangeAEnclosesRangeB","RangeBEnclosesRangeA","RangesAreEqual","RangesNotEnclosing"]);function d(e,t){for(var r=new Set(e.messages.map((e=>{var t;return null===(t=e.key)||void 0===t?void 0:t.id}))),a=0;a<t.messages.length;a++){var n;if(null==t.messages[a].timestamp)if(!r.has(null===(n=t.messages[a].key)||void 0===n?void 0:n.id))return!1}for(var s=0;s<t.messages.length;s++){var o,u,l;if(!r.has(null===(o=t.messages[s].key)||void 0===o?void 0:o.id)&&(0,i.numberOrThrowIfTooLarge)(null!==(u=e.lastMessageTimestamp)&&void 0!==u?u:0)<=(0,i.numberOrThrowIfTooLarge)(null!==(l=t.messages[s].timestamp)&&void 0!==l?l:0))return!1}return!0}function c(){return(c=(0,n.default)((function*(e){var t,r=yield(0,s.getLastMessageTimestamp)(e),a=yield(0,s.getLastSystemMessageTimestamp)(e),{messages:n,newLastMessageTimestamp:o}=yield(0,s.getAdditionalMessages)(e,r);(null!=o&&(r=o),null==r)&&(r=null===(t=n.sort(s.timestampComparison)[n.length-1])||void 0===t?void 0:t.timestamp);var u={messages:n};return null!=r&&(u.lastMessageTimestamp=r),null!=a&&null!=r&&a>(0,i.numberOrThrowIfTooLarge)(r)&&(u.lastSystemMessageTimestamp=a),u}))).apply(this,arguments)}function f(e,t,r){var a=new Map;return e.concat(t).forEach((e=>{var t,n,s,o=null!==(t=null===(n=e.key)||void 0===n?void 0:n.id)&&void 0!==t?t:"";if((0,i.numberOrThrowIfTooLarge)(null!==(s=e.timestamp)&&void 0!==s?s:0)>=r){var u,l,d=a.get(o);if(d)a.set(o,(0,i.numberOrThrowIfTooLarge)(null!==(u=d.timestamp)&&void 0!==u?u:0)<(0,i.numberOrThrowIfTooLarge)(null!==(l=e.timestamp)&&void 0!==l?l:0)?e:d);else a.set(o,e)}})),Array.from(a.values())}t.MessageRangeEncloseType=l;t.lockForMessageRangeSync=(e,t,r)=>(0,o.lockForSync)([...e,"message","active-message-ranges"],t,r)},34565:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(19976)),i=a(r(52954)),s=r(63487),o=r(3531),u=r(11008),l=a(r(85059)),d=r(75637),c=r(44880),f=r(8239),p=r(71684),h=r(61239),_=r(68519),m=r(49887);function g(){var e=(0,n.default)(["mute chat sync: operation not supported"]);return g=function(){return e},e}function v(){var e=(0,n.default)(["mute chat sync: malformed mutation"]);return v=function(){return e},e}class E extends f.SyncActionBase{constructor(...e){super(...e),this.version=2}getChatJidAndMessageKey(e){var[,t]=e.index;return{chatJid:t,messageKey:null}}applyMutations(e){return Promise.all(e.map(function(){var e=(0,i.default)((function*(e){try{if("set"===e.operation){var t,{indexParts:r,value:a}=e,[,n]=r;n||(0,m.throwInvalidActionIndex)();var i=a.muteAction,o=null===(t=a.muteAction)||void 0===t?void 0:t.muted,f=(0,c.maybeNumberOrThrowIfTooLarge)(null==i?void 0:i.muteEndTimestamp);if(null==o||o&&null==f)return __LOG__(3)(v()),{actionState:s.SyncActionState.Malformed};var h=(0,d.createWid)(n).toString();if(!(yield(0,u.getChatTable)().get(h)))return{actionState:s.SyncActionState.Orphan,orphanModel:{modelType:s.SyncModelType.Chat,modelId:h}};var _=null!=f?f:0,E=_>0&&_<(0,p.unixTimeMs)()?0:Math.floor(_/1e3);return yield(0,u.getChatTable)().merge((0,d.createWid)(n).toString(),{muteExpiration:E}),l.default.add({id:(0,d.createWid)(n),expiration:E},{merge:!0}),{actionState:s.SyncActionState.Success}}return __LOG__(3)(g()),{actionState:s.SyncActionState.Unsupported}}catch(e){return{actionState:s.SyncActionState.Failed}}}));return function(){return e.apply(this,arguments)}}()))}generateMuteMutation(e,t){var r=void 0!==t&&0!==t,a=(0,p.unixTimeMs)(),n=t;-1!==n&&(n*=1e3);var i={timestamp:a,muteAction:{muted:r,muteEndTimestamp:n}};return{collection:s.CollectionName.RegularHigh,index:JSON.stringify([s.Actions.Mute,e.toString({legacy:!0})]),operation:o.SyncdMutationSyncdOperation.SET,version:this.version,binarySyncAction:(0,_.encodeProto)(h.SyncActionValueSpec,i).readBuffer(),timestamp:a}}}var y=new E;Object.freeze(y);var S=y;t.default=S},89694:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(19976)),i=r(63487),s=r(3531),o=r(8239),u=r(50553),l=a(r(66759)),d=r(68519),c=r(61239);function f(){var e=(0,n.default)(["push name sync: operation not supported"]);return f=function(){return e},e}function p(){var e=(0,n.default)(["push name sync: malformed mutation"]);return p=function(){return e},e}class h extends o.SyncActionBase{constructor(...e){super(...e),this.version=1}applyMutations(e){return Promise.all(e.map((e=>{try{if("set"===e.operation){var t,{value:a}=e,n=null===(t=a.pushNameSetting)||void 0===t?void 0:t.name;if(!n)return __LOG__(3)(p()),Promise.resolve({actionState:i.SyncActionState.Malformed});(0,l.default)(n),(0,u.setPushnameLocally)(n);var s=r(57529).default;return s.isSyncDCriticalDataSyncInProcess()&&(s.setSyncDCriticalSynced(),s.setSyncDCriticalDataSyncCompleted()),Promise.resolve({actionState:i.SyncActionState.Success})}return __LOG__(3)(f()),Promise.resolve({actionState:i.SyncActionState.Unsupported})}catch(e){return{actionState:i.SyncActionState.Failed}}})))}getPushnameMutation(e,t){return{collection:i.CollectionName.CriticalBlock,index:JSON.stringify([i.Actions.SettingPushName]),binarySyncAction:(0,d.encodeProto)(c.SyncActionValueSpec,{timestamp:e,pushNameSetting:{name:t}}).readBuffer(),version:this.version,operation:s.SyncdMutationSyncdOperation.SET,timestamp:e}}}var _=new h;Object.freeze(_);var m=_;t.default=m},50560:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(19976)),i=a(r(52954)),s=r(63487),o=a(r(75537)),u=r(11008),l=r(8239),d=r(49887);function c(){var e=(0,n.default)(["quick replies sync: operation not supported"]);return c=function(){return e},e}function f(){var e=(0,n.default)(["quick replies sync: malformed mutation"]);return f=function(){return e},e}function p(){var e=(0,n.default)(["quick replies sync: malformed mutation"]);return p=function(){return e},e}class h extends l.SyncActionBase{constructor(...e){super(...e),this.version=2}applyMutations(e){return Promise.all(e.map(function(){var e=(0,i.default)((function*(e){try{if("set"===e.operation){var{indexParts:t,value:r}=e,[,a]=t;a||(0,d.throwInvalidActionIndex)();var n=r.quickReplyAction;if(!n)return __LOG__(3)(p()),{actionState:s.SyncActionState.Malformed};if(n.deleted)return yield(0,u.getQuickReplyTable)().remove(a),o.default.remove(a),{actionState:s.SyncActionState.Success};var{shortcut:i,message:l}=n;if(!i||!l)return __LOG__(3)(f()),{actionState:s.SyncActionState.Malformed};var h=n.keywords||[],_=n.count||0;return yield(0,u.getQuickReplyTable)().createOrReplace({id:a,shortcut:i,count:_,message:l,keywords:h}),o.default.add({id:a,shortcut:i,message:l,keywords:h,count:_},{merge:!0}),{actionState:s.SyncActionState.Success}}return __LOG__(3)(c()),{actionState:s.SyncActionState.Unsupported}}catch(e){return{actionState:s.SyncActionState.Failed}}}));return function(){return e.apply(this,arguments)}}()))}}var _=new h;Object.freeze(_);var m=_;t.default=m},13584:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(19976)),i=a(r(52954)),s=r(71684),o=r(63487),u=a(r(82657)),l=r(22163),d=r(3531),c=r(8239),f=r(68519),p=r(61239);function h(){var e=(0,n.default)(["sentinel mutation sync: operation not supported"]);return h=function(){return e},e}function _(){var e=(0,n.default)(["sentinel mutation sync: malformed mutation"]);return _=function(){return e},e}class m extends c.SyncActionBase{constructor(...e){super(...e),this.version=3}applyMutations(e){return Promise.all(e.map(function(){var e=(0,i.default)((function*(e){try{if("set"===e.operation){var t,r=null===(t=e.value.keyExpiration)||void 0===t?void 0:t.expiredKeyEpoch;return null==r?(__LOG__(4,void 0,new Error)(_()),{actionState:o.SyncActionState.Malformed}):(yield u.default.expireSyncKey(r),{actionState:o.SyncActionState.Success})}return __LOG__(3)(h()),{actionState:o.SyncActionState.Unsupported}}catch(e){return{actionState:o.SyncActionState.Failed}}}));return function(){return e.apply(this,arguments)}}()))}getSentinelMutations(){var e=this;return(0,i.default)((function*(){var t=(0,s.unixTimeMs)(),r=Array.from(o.CollectionName.members()),a={keyExpiration:{expiredKeyEpoch:(yield(0,l.getNewestKeyPair)()).keyEpoch},timestamp:t};return r.map((r=>({collection:r,index:JSON.stringify([o.Actions.Sentinel,r]),operation:d.SyncdMutationSyncdOperation.SET,version:e.version,binarySyncAction:(0,f.encodeProto)(p.SyncActionValueSpec,a).readBuffer(),timestamp:t})))}))()}}var g=new m;Object.freeze(g);var v=g;t.default=v},21743:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(19976)),i=a(r(52954)),s=r(63487),o=r(11008),u=r(12425),l=a(r(58885)),d=r(49887),c=r(8239),f=r(16054),p=r(3531),h=r(71684),_=r(68519),m=r(61239);function g(){var e=(0,n.default)(["star message sync: operation not supported"]);return g=function(){return e},e}function v(){var e=(0,n.default)(["star_message_sync: msg "," found in storage but not in collection"]);return v=function(){return e},e}function E(){var e=(0,n.default)(["star message sync: malformed mutation"]);return E=function(){return e},e}class y extends c.SyncActionBase{constructor(...e){super(...e),this.version=2}getChatJidAndMessageKey(e){var[,t,r,a,n]=e.index;return t&&r&&a&&n||(0,d.throwInvalidActionIndex)(),{chatJid:t,messageKey:(0,d.syncKeyToMsgKey)(t,r,a,n).toString()}}applyMutations(e){return Promise.all(e.map(function(){var e=(0,i.default)((function*(e){try{if("set"===e.operation){var t,{indexParts:r,value:a}=e,[,n,i,c,f]=r;n&&i&&c&&f||(0,d.throwInvalidActionIndex)();var p=null===(t=a.starAction)||void 0===t?void 0:t.starred;if(null==p)return __LOG__(3)(E()),{actionState:s.SyncActionState.Malformed};var h=(0,d.syncKeyToMsgKey)(n,i,c,f);if(!(yield(0,o.getMessageTable)().get(h.toString())))return{actionState:s.SyncActionState.Orphan,orphanModel:{modelId:h.toString(),modelType:s.SyncModelType.Msg}};p?yield(0,u.starMessages)([h.toString()]):yield(0,u.unstarMessages)([h.toString()]);var _=l.default.get(h);return _?_.star=p:__LOG__(3)(v(),h),{actionState:s.SyncActionState.Success}}return __LOG__(3)(g()),{actionState:s.SyncActionState.Unsupported}}catch(e){return{actionState:s.SyncActionState.Failed}}}));return function(){return e.apply(this,arguments)}}()))}getStarMessageMutations(e,t){var r=(0,h.unixTimeMs)();return e.map((e=>({collection:s.CollectionName.RegularHigh,index:(0,f.constructStarMsgKey)(e),operation:p.SyncdMutationSyncdOperation.SET,version:this.version,binarySyncAction:(0,_.encodeProto)(m.SyncActionValueSpec,{timestamp:r,starAction:{starred:t}}).readBuffer(),timestamp:r})))}}var S=new y;Object.freeze(S);var T=S;t.default=T},8239:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SyncActionBase=void 0;var a=r(63487);t.SyncActionBase=class{getChatJidAndMessageKey(){}resolveConflicts(e,t){return t.timestamp>=e.timestamp?a.ConflictResolutionState.ApplyRemoteAndDropLocal:a.ConflictResolutionState.SkipRemote}dropMutationDueToCrossIndexConflict(){return Promise.resolve(!1)}}},49887:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.syncKeyToMsgKey=function(e,t,r,a){var n=void 0;(0,u.createWid)(e).isUser()||(n="1"===r?(0,i.getMeUser)():(0,u.createWid)(a));return new o.default({fromMe:"1"===r,remote:(0,u.createWid)(e),id:t,participant:n})},t.throwInvalidActionIndex=function(){throw new s.default.MdFatalError({mdFatalErrorCode:s.default.MD_SYNCD_FATAL_ERROR_CODE.INVALID_ACTION_INDEX}).commit(),new n.SyncdFatalError("invalid action index")};var n=r(49859),i=r(95595),s=a(r(40210)),o=a(r(77865)),u=r(75637)},98852:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(19976)),i=a(r(52954)),s=r(71684),o=r(63487),u=r(11008);function l(){var e=(0,n.default)(["Collection "," is in finite retry state with no failure start time"]);return l=function(){return e},e}class d{static loadStatesFromDb(){var e=this;return(0,i.default)((function*(){(yield(0,u.getCollectionVersionTable)().all()).forEach((t=>e.collectionStates.set(t.collection,{collection:t.collection,state:t.state,finiteFailureStartTime:t.finiteFailureStartTime})))}))()}static persistToDb(){var e=[];return this.collectionStates.forEach((t=>e.push(t))),(0,u.getCollectionVersionTable)().bulkCreateOrMerge(e)}static clean(){this.collectionStates=new Map}static getCollectionState(e){var t=this.collectionStates.get(e);return t?t.state:(this.moveCollectionsToUpToDate([e]),o.CollectionSyncState.UpToDate)}static getCollectionsInStateDirty(){var e=[];return this.collectionStates.forEach((t=>{t.state===o.CollectionSyncState.Dirty&&e.push(t.collection)})),e}static getCollectionsInStateRetry(){var e=[];return this.collectionStates.forEach((t=>{t.state===o.CollectionSyncState.FailingFiniteRetry&&e.push(t.collection)})),e}static getCollectionsInStateFatal(){var e=[];return this.collectionStates.forEach((t=>{t.state===o.CollectionSyncState.Fatal&&e.push(t.collection)})),e}static getCollectionsInStateBlocked(){var e=[];return this.collectionStates.forEach((t=>{t.state===o.CollectionSyncState.Blocked&&e.push(t.collection)})),e}static moveCollectionsToUpToDate(e){e.forEach((e=>this.collectionStates.set(e,{collection:e,state:o.CollectionSyncState.UpToDate,finiteFailureStartTime:void 0})))}static moveCollectionsToDirty(e){e.forEach((e=>this.collectionStates.set(e,{collection:e,state:o.CollectionSyncState.Dirty,finiteFailureStartTime:void 0})))}static moveCollectionsToFiniteRetry(e){e.forEach((e=>this.collectionStates.set(e,{collection:e,state:o.CollectionSyncState.FailingFiniteRetry,finiteFailureStartTime:(0,s.unixTimeMs)()})))}static moveCollectionsToFatal(e){e.forEach((e=>this.collectionStates.set(e,{collection:e,state:o.CollectionSyncState.Fatal,finiteFailureStartTime:void 0})))}static moveCollectionsToBlocked(e){e.forEach((e=>this.collectionStates.set(e,{collection:e,state:o.CollectionSyncState.Blocked,finiteFailureStartTime:void 0})))}static getExpiredCollections(){var e=[];return this.collectionStates.forEach((t=>{var r;t.state===o.CollectionSyncState.FailingFiniteRetry&&(null==t.finiteFailureStartTime?(r=1/0,__LOG__(3)(l(),t.collection)):r=t.finiteFailureStartTime,r+6048e5<(0,s.unixTimeMs)()&&e.push(t.collection))})),e}}t.default=d,d.collectionStates=new Map},63487:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SyncDataType=t.ConflictResolutionState=t.SyncModelType=t.SyncActionState=t.CollectionSyncState=t.CollectionState=t.CollectionName=t.Actions=t.LABEL_ASSOCIATION_SYNC_VERSION=t.DEFAULT_COLLECTION_VERSION=t.MAX_PATCH_SIZE=t.MIN_PATCH_SIZE=t.MAX_INLINE_MUTATIONS=t.MIN_INLINE_MUTATIONS=t.FINITE_FAILURE_EXPIRY_DURATION=t.BACKOFF_BASE=t.BACKOFF_MAX_TIMEOUT=t.BACKOFF_MIN_TIMEOUT=void 0;t.BACKOFF_MIN_TIMEOUT=1e3;t.BACKOFF_MAX_TIMEOUT=36e5;t.BACKOFF_BASE=2;t.FINITE_FAILURE_EXPIRY_DURATION=6048e5;t.MIN_INLINE_MUTATIONS=100;t.MAX_INLINE_MUTATIONS=2e3;t.MIN_PATCH_SIZE=10;t.MAX_PATCH_SIZE=100;t.DEFAULT_COLLECTION_VERSION=0;t.LABEL_ASSOCIATION_SYNC_VERSION=3;var a=r(28103)({Star:"star",Contact:"contact",Mute:"mute",Pin:"pin",SettingPushName:"setting_pushName",LabelEdit:"label_edit",LabelMessage:"label_message",LabelJid:"label_jid",QuickReply:"quick_reply",LocaleSetting:"setting_locale",Archive:"archive",MarkChatAsRead:"markChatAsRead",ClearChat:"clearChat",DeleteMessageForMe:"deleteMessageForMe",Sentinel:"sentinel"});t.Actions=a;var n=r(28103)({Generic:"generic",Regular:"regular",RegularLow:"regular_low",RegularHigh:"regular_high",CriticalBlock:"critical_block",CriticalUnblockLow:"critical_unblock_low"});t.CollectionName=n;var i=r(28103).Mirrored(["Success","SuccessHasMore","Conflict","ErrorRetry","ErrorFatal","Blocked"]);t.CollectionState=i;var s=r(28103).Mirrored(["UpToDate","Dirty","FailingFiniteRetry","Fatal","Blocked"]);t.CollectionSyncState=s;var o=r(28103).Mirrored(["Success","Malformed","Orphan","Unsupported","Skipped","Failed"]);t.SyncActionState=o;var u=r(28103).Mirrored(["Msg","Chat"]);t.SyncModelType=u;var l=r(28103).Mirrored(["ApplyRemoteAndDropLocal","SkipRemote","SkipRemoteAndDropLocal"]);t.ConflictResolutionState=l;var d=r(28103).Mirrored(["Patch","Snapshot"]);t.SyncDataType=d},82330:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EMPTY_MUTATION_MAC=t.IV_LENGTH=t.OCTET_LENGTH=t.MAC_LENGTH=t.MAX_OF_MIN_DATA_LENGTH=t.OPERATION_REMOVE_HEX=t.OPERATION_SET_HEX=t.PATCH_MAC_KEY_END=t.SNAPSHOT_MAC_KEY_END=t.VALUE_MAC_KEY_END=t.VALUE_ENCRYPTION_KEY_END=t.INDEX_KEY_END=t.PATCH_MAC_KEY_LENGTH=t.SNAPSHOT_MAC_KEY_LENGTH=t.VALUE_MAC_KEY_LENGTH=t.VALUE_ENCRYPTION_KEY_LENGTH=t.INDEX_KEY_LENGTH=t.DERIVED_KEY_LENGTH=t.HKDF_INFO=void 0;t.HKDF_INFO="WhatsApp Mutation Keys";t.DERIVED_KEY_LENGTH=160;t.INDEX_KEY_LENGTH=32;t.VALUE_ENCRYPTION_KEY_LENGTH=32;t.VALUE_MAC_KEY_LENGTH=32;t.SNAPSHOT_MAC_KEY_LENGTH=32;t.PATCH_MAC_KEY_LENGTH=32;t.INDEX_KEY_END=32;t.VALUE_ENCRYPTION_KEY_END=64;t.VALUE_MAC_KEY_END=96;t.SNAPSHOT_MAC_KEY_END=128;t.PATCH_MAC_KEY_END=160;t.OPERATION_SET_HEX="0x01";t.OPERATION_REMOVE_HEX="0x02";t.MAX_OF_MIN_DATA_LENGTH=0;t.MAC_LENGTH=32;t.OCTET_LENGTH=8;t.IV_LENGTH=16;var r=new ArrayBuffer(32);t.EMPTY_MUTATION_MAC=r},52056:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.generateIndexMac=function(e,t){return new o.default(e).sign(t)},t.generateAssociatedData=function(e,t){var r;switch(e){case l.SyncdMutationSyncdOperation.SET:r=s.OPERATION_SET_HEX;break;case l.SyncdMutationSyncdOperation.REMOVE:r=s.OPERATION_REMOVE_HEX}if(r){var a=r=new Uint8Array([parseInt(r,16)]).buffer,n=new Uint8Array(r.byteLength+t.byteLength);return n.set(new Uint8Array(a)),n.set(new Uint8Array(t),a.byteLength),n.buffer}throw new Error("invalid mutation operation value")},t.generatePadding=function(e,t){var r=Math.max(0,s.MAX_OF_MIN_DATA_LENGTH-e-t),a=new Uint8Array(r);return self.crypto.getRandomValues(a),a.buffer},t.generateCipherText=function(){return h.apply(this,arguments)},t.generateMac=function(e,t,r){var a=new Uint8Array(s.OCTET_LENGTH);a.set([e.byteLength],a.byteLength-1);var n=(0,d.combine)([e,t,a.buffer]);return new u.default(r).sign(n,s.MAC_LENGTH)},t.decryptCipherText=function(){return _.apply(this,arguments)},t.generateSnapshotMac=function(e,t,r,a){return new o.default(e).sign((0,d.combine)([t,r,a]))},t.generatePatchMac=function(e,t,r,a,n){return new o.default(e).sign((0,d.combine)([t,...r,a,n]))},t.valueMacFromIndexAndValueCipherText=function(e){var t=e.byteLength;return new Uint8Array(e).slice(t-s.MAC_LENGTH).buffer},t.generateEncryptionKeys=void 0;var n=a(r(52954)),i=a(r(30733)),s=r(82330),o=a(r(36398)),u=a(r(82060)),l=r(3531),d=r(69551),c=r(60339),f=r(45058),p=(0,i.default)(f.generateEncryptionKeysUnmemoized,c.encodeB64);function h(){return(h=(0,n.default)((function*(e,t,r){var a=yield self.crypto.subtle.importKey("raw",new Uint8Array(t),"AES-CBC",!1,["encrypt"]);return yield self.crypto.subtle.encrypt({name:"AES-CBC",iv:e},a,r)}))).apply(this,arguments)}function _(){return(_=(0,n.default)((function*(e,t,r){var a=yield self.crypto.subtle.importKey("raw",new Uint8Array(t),"AES-CBC",!1,["decrypt"]);return yield self.crypto.subtle.decrypt({name:"AES-CBC",iv:e},a,r)}))).apply(this,arguments)}t.generateEncryptionKeys=p},45058:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.generateEncryptionKeysUnmemoized=function(){return u.apply(this,arguments)};var i=n(r(52954)),s=a(r(55273)),o=r(82330);function u(){return(u=(0,i.default)((function*(e){var t=yield l(e);return{indexKey:t.slice(0,o.INDEX_KEY_END),valueEncryptionKey:t.slice(o.INDEX_KEY_END,o.VALUE_ENCRYPTION_KEY_END),valueMacKey:t.slice(o.VALUE_ENCRYPTION_KEY_END,o.VALUE_MAC_KEY_END),snapshotMacKey:t.slice(o.VALUE_MAC_KEY_END,o.SNAPSHOT_MAC_KEY_END),patchMacKey:t.slice(o.SNAPSHOT_MAC_KEY_END,o.PATCH_MAC_KEY_END)}}))).apply(this,arguments)}function l(e){return s.extractAndExpand(e,o.HKDF_INFO,o.DERIVED_KEY_LENGTH)}},69551:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.combine=function(e){if(0===e.length)throw new Error("buffers length is zero");if(1===e.length)return e[0];var t,r=e.map((e=>e.byteLength)).reduce(((e,t)=>e+t)),a=new Uint8Array(r),n=0;for(t=0;t<e.length;t++)a.set(new Uint8Array(e[t]),n),n+=e[t].byteLength;return a.buffer},t.split=function(e,t,r){if(t<0||r<0)throw new Error("buffers length is zero");var a=new Array(3),n=new Uint8Array(e);return a[0]=n.slice(0,t).buffer,a[1]=n.slice(t,t+r).buffer,a[2]=n.slice(t+r).buffer,a},t.hexToUint8Array=function(e){return Uint8Array.from(e.split(" ").map((e=>parseInt(e,16))))},t.arrayBufferToHex=function(e){return[...new Uint8Array(e)].map((e=>e.toString(16))).toString().replace(/,/g," ")},t.stringToArrayBuffer=function(e){var t,r,a=new ArrayBuffer(e.length),n=new Uint8Array(a);for(t=0,r=e.length;t<r;t++)n[t]=e.charCodeAt(t);return n.buffer},t.arrayBuffersAreEqual=function(e,t){return function(e,t){if(e.byteLength!==t.byteLength)return!1;for(var r=0;r<e.byteLength;r++)if(e.getUint8(r)!==t.getUint8(r))return!1;return!0}(new DataView(e),new DataView(t))},t.to64BitNetworkOrder=function(e){var t=new ArrayBuffer(8);return new DataView(t).setUint32(4,e,!1),t},t.toUtf8=function(e){return r.encode(e)};var r=new TextEncoder},82657:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(52954)),i=r(44303),s=r(11008),o=r(77993),u=new ArrayBuffer(i.KEY_LENGTH_BYTES);t.default=class{static getAllPendingMutationsRows(){return(0,s.getPendingMutationsTable)().all()}static performTransaction(e){return(0,o.getStorage)().lock(["collection-version","pending-mutations","sync-actions"],e)}static getPendingMutationsRows(e,t){return(0,s.getPendingMutationsTable)().equals(e,t)}static getPendingMutationsRowsById(e){return(0,n.default)((function*(){return(yield(0,s.getPendingMutationsTable)().bulkGet(e)).filter(Boolean)}))()}static appendPendingMutationsRows(e){return(0,s.getPendingMutationsTable)().bulkCreate(e)}static bulkUpdatePendingMutationsKeyId(e){return(0,s.getPendingMutationsTable)().bulkCreateOrMerge(e)}static bulkRemovePendingMutations(e){return(0,s.getPendingMutationsTable)().bulkRemove(e)}static getCollectionVersion(e){return(0,n.default)((function*(){var t=yield(0,s.getCollectionVersionTable)().get(e);return null==t?void 0:t.version}))()}static setCollectionVersion(e,t,r){return(0,s.getCollectionVersionTable)().createOrMerge(e,{collection:e,version:t,ltHash:r})}static getLtHash(e){return(0,n.default)((function*(){var t=yield(0,s.getCollectionVersionTable)().get(e);return(null==t?void 0:t.ltHash)||u}))()}static getSyncAction(e){return(0,s.getSyncActionsTable)().get(e)}static getSyncActionsRows(e,t){return(0,s.getSyncActionsTable)().anyOf(e,t)}static setSyncAction(e){return(0,s.getSyncActionsTable)().createOrReplace(e)}static setSyncActionRows(e){return(0,s.getSyncActionsTable)().bulkCreateOrReplace(e)}static deleteSyncActionRows(e){return(0,s.getSyncActionsTable)().bulkRemove(e)}static getSyncKey(e){return(0,s.getSyncKeysTable)().get(e)}static getAllSyncKeys(){return(0,s.getSyncKeysTable)().all()}static createSyncKey(e){return(0,s.getSyncKeysTable)().create(e)}static getSyncKeyData(e){return(0,s.getSyncKeysTable)().get(e)}static expireSyncKey(e){return(0,s.getSyncKeysTable)().equals(["keyEpoch"],e).then((e=>{e.forEach((e=>(0,s.getSyncKeysTable)().merge(e.keyId,{keyId:e.keyId,timestamp:0})))}))}static getMissingKey(e){return(0,s.getMissingKeysTable)().get(e)}static getMissingKeyCount(){return(0,s.getMissingKeysTable)().count()}static bulkGetMissingKeys(e){return(0,s.getMissingKeysTable)().bulkGet(e)}static getAllMissingKeys(){return(0,s.getMissingKeysTable)().all()}static bulkRemoveMissingKeys(e){return(0,s.getMissingKeysTable)().bulkRemove(e)}static updateMissingKey(e){return(0,s.getMissingKeysTable)().merge(e.keyId,e)}static createOrUpdateMissingKeys(e){return(0,s.getMissingKeysTable)().bulkCreateOrMerge(e)}}},95988:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.computeLtHashAndValidateSnapshot=function(){return E.apply(this,arguments)},t.computeLtHashAndValidatePatch=function(){return y.apply(this,arguments)},t.computeOutgoingSnapshotAndPatchMacs=function(){return C.apply(this,arguments)},t.computeLtHash=P;var n=a(r(19976)),i=a(r(52954)),s=r(52056),o=a(r(82657)),u=r(49859),l=r(22163),d=r(44303),c=r(3531),f=r(69551),p=r(63487),h=a(r(72424)),_=a(r(40210));function m(){var e=(0,n.default)(["syncd: unable to validate patch mac.\nexpected patchMAC: ","$\ncomputed patchMAC: ",""]);return m=function(){return e},e}function g(){var e=(0,n.default)(["syncd: unable to validate snapshot mac.\nexpected: ","\ncomputed: ",""]);return g=function(){return e},e}var v=new TextDecoder;function E(){return(E=(0,i.default)((function*(e,t){var{mac:r,version:a,keyId:n,records:i}=t,o=yield(0,l.getKeyData)(n.id);if(!o)throw new u.SyncdMissingKeyError;var c=i.map((e=>(0,s.valueMacFromIndexAndValueCipherText)(e.value.blob))),p=yield d.LT_HASH_ANTI_TAMPERING.add(d.EMPTY_LT_HASH,c),{snapshotMacKey:h}=yield(0,s.generateEncryptionKeys)(o),_=(0,f.to64BitNetworkOrder)(a.version),m=(0,f.toUtf8)(e).buffer;return yield S(r,h,p,_,m,!0),p}))).apply(this,arguments)}function y(){return(y=(0,i.default)((function*(e,t){var{version:r,mutations:a,snapshotMac:n,patchMac:i,keyId:o}=t,d=o.id,c=yield(0,l.getKeyData)(d);if(!c)throw new u.SyncdMissingKeyError;var{snapshotMacKey:p,patchMacKey:h}=yield(0,s.generateEncryptionKeys)(c),_=a.map((e=>({operation:e.operation,indexMac:e.record.index.blob,valueMac:(0,s.valueMacFromIndexAndValueCipherText)(e.record.value.blob)}))),m=yield P(e,_),g=(0,f.to64BitNetworkOrder)(r.version),v=(0,f.toUtf8)(e).buffer;return yield b(i,h,n,_.map((e=>e.valueMac)),g,v),yield S(n,p,m,g,v,!1),m}))).apply(this,arguments)}function S(){return T.apply(this,arguments)}function T(){return(T=(0,i.default)((function*(e,t,r,a,n,i){var o=yield(0,s.generateSnapshotMac)(t,r,a,n);if(!(0,f.arrayBuffersAreEqual)(o,e)){var l=i?_.default.MD_SYNCD_FATAL_ERROR_CODE.SNAPSHOT_MAC_MISMATCH_IN_SNAPSHOT:_.default.MD_SYNCD_FATAL_ERROR_CODE.SNAPSHOT_MAC_MISMATCH_IN_PATCH;if(new _.default.MdFatalError({mdFatalErrorCode:l}).commit(),h.default.syncdAntiTamperingFatalExceptionEnabled)throw new u.SyncdFatalError("unable to validate snapshot mac");__LOG__(3,void 0,void 0,!0)(g(),(0,f.arrayBufferToHex)(e),(0,f.arrayBufferToHex)(o)),SEND_LOGS("syncd: unable to validate snapshot mac.")}}))).apply(this,arguments)}function b(){return A.apply(this,arguments)}function A(){return(A=(0,i.default)((function*(e,t,r,a,n,i){var o=yield(0,s.generatePatchMac)(t,r,a,n,i);if(!(0,f.arrayBuffersAreEqual)(o,e)){if(new _.default.MdFatalError({mdFatalErrorCode:_.default.MD_SYNCD_FATAL_ERROR_CODE.MAC_MISMATCH_PATCH}).commit(),h.default.syncdAntiTamperingFatalExceptionEnabled)throw new u.SyncdFatalError("unable to validate patch mac");__LOG__(3,void 0,void 0,!0)(m(),e,o),SEND_LOGS("syncd: unable to validate patch mac.")}}))).apply(this,arguments)}function C(){return(C=(0,i.default)((function*(e,t,r,a){var n=((yield o.default.getCollectionVersion(e))||p.DEFAULT_COLLECTION_VERSION)+1,{patchMacKey:i,snapshotMacKey:u}=yield(0,s.generateEncryptionKeys)(a),l=(0,f.to64BitNetworkOrder)(n),d=(0,f.toUtf8)(e).buffer,c=yield(0,s.generateSnapshotMac)(u,t,l,d);return{snapshotMac:c,patchMac:yield(0,s.generatePatchMac)(i,c,r.map((e=>e.valueMac)),l,d)}}))).apply(this,arguments)}function P(){return O.apply(this,arguments)}function O(){return(O=(0,i.default)((function*(e,t){var r=yield o.default.getLtHash(e),a=yield w(t.map((e=>e.indexMac))),n=[],i=[];return t.forEach((e=>{var{indexMac:t,valueMac:r,operation:s}=e,o=v.decode(t),u=a.get(o);u?i.push(u):c.SyncdMutationSyncdOperation.REMOVE,s===c.SyncdMutationSyncdOperation.SET&&n.push(r)})),yield d.LT_HASH_ANTI_TAMPERING.subtractThenAdd(r,n,i)}))).apply(this,arguments)}function w(){return M.apply(this,arguments)}function M(){return(M=(0,i.default)((function*(e){var t=yield o.default.getSyncActionsRows(["indexMac"],e);return new Map(t.map((e=>[v.decode(e.indexMac),e.valueMac])))}))).apply(this,arguments)}},9955:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.maxSupportedVersion=t.ActionHandlers=void 0;var n=a(r(71644)),i=a(r(33729)),s=r(63487),o=a(r(94137)),u=a(r(42138)),l=a(r(19869)),d=a(r(35701)),c=a(r(27815)),f=a(r(73404)),p=a(r(34565)),h=a(r(89694)),_=a(r(50560)),m=a(r(21743)),g=a(r(20987)),v=a(r(9999)),E=a(r(13584)),y=new Map([[s.Actions.Star,m.default],[s.Actions.Contact,o.default],[s.Actions.Mute,p.default],[s.Actions.LabelEdit,d.default],[s.Actions.LabelMessage,l.default],[s.Actions.LabelJid,u.default],[s.Actions.QuickReply,_.default],[s.Actions.LocaleSetting,c.default],[s.Actions.SettingPushName,h.default],[s.Actions.Archive,i.default],[s.Actions.MarkChatAsRead,f.default],[s.Actions.ClearChat,g.default],[s.Actions.DeleteMessageForMe,v.default],[s.Actions.Sentinel,E.default]]);t.ActionHandlers=y;t.maxSupportedVersion=()=>(0,n.default)(Array.from(y.values()).map((e=>e.version)))},7150:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.decodeExternalBlobReference=function(e){try{return(0,n.decodeProto)(o.ExternalBlobReferenceSpec,e)}catch(e){throw new s.default.MdFatalError({mdFatalErrorCode:s.default.MD_SYNCD_FATAL_ERROR_CODE.EXTERNAL_BLOB_REFERENCE_PROTOBUF_DESERIALIZATION_FAILED}).commit(),new i.SyncdFatalError("external blob reference protobuf deserialization failed")}},t.decodeSyncdSnapshot=function(e){try{return(0,n.decodeProto)(o.SyncdSnapshotSpec,e)}catch(e){throw new s.default.MdFatalError({mdFatalErrorCode:s.default.MD_SYNCD_FATAL_ERROR_CODE.SNAPSHOT_PROTOBUF_DESERIALIZATION_FAILED}).commit(),new i.SyncdFatalError("snapshot protobuf deserialization failed")}},t.decodeSyncdPatch=function(e){try{return(0,n.decodeProto)(o.SyncdPatchSpec,e)}catch(e){throw new s.default.MdFatalError({mdFatalErrorCode:s.default.MD_SYNCD_FATAL_ERROR_CODE.PATCH_PROTOBUF_DESERIALIZATION_FAILED}).commit(),new i.SyncdFatalError("patch protobuf deserialization failed")}},t.decodeSyncdMutations=function(e){try{return(0,n.decodeProto)(o.SyncdMutationsSpec,e)}catch(e){throw new s.default.MdFatalError({mdFatalErrorCode:s.default.MD_SYNCD_FATAL_ERROR_CODE.MUTATIONS_PROTOBUF_DESERIALIZATION_FAILED}).commit(),new i.SyncdFatalError("mutations protobuf deserialization failed")}},t.decodeSyncActionData=function(e){try{return(0,n.decodeProto)(u.SyncActionDataSpec,e)}catch(e){throw new s.default.MdFatalError({mdFatalErrorCode:s.default.MD_SYNCD_FATAL_ERROR_CODE.ACTION_DATA_PROTOBUF_DESERIALIZATION_FAILED}).commit(),new i.SyncdFatalError("action data protobuf deserialization failed")}};var n=r(84139),i=r(49859),s=a(r(40210)),o=r(3531),u=r(61239)},6630:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.tryDecryptSnapshot=function(){return g.apply(this,arguments)},t.tryDecryptPatch=function(){return v.apply(this,arguments)};var n=a(r(52954)),i=r(68519),s=r(7150),o=r(82330),u=r(52056),l=r(49859),d=r(22163),c=a(r(40210)),f=r(3531),p=r(61239),h=r(69551),_=a(r(30376)),m=new TextDecoder;function g(){return(g=(0,n.default)((function*(e,t){return yield Promise.all(t.records.map((t=>E(e,f.SyncdMutationSyncdOperation.SET,t))))}))).apply(this,arguments)}function v(){return(v=(0,n.default)((function*(e,t){return yield Promise.all(t.mutations.map((t=>E(e,t.operation,t.record))))}))).apply(this,arguments)}function E(){return y.apply(this,arguments)}function y(){return(y=(0,n.default)((function*(e,t,r){var a=r.keyId.id,n=yield(0,d.getKeyData)(a);if(!n){if(t===f.SyncdMutationSyncdOperation.REMOVE)throw new l.SyncdFatalError("no key data for remove mutations");throw new l.SyncdMissingKeyError}var{syncAction:s,indexMac:o,valueMac:u}=yield S(a,n,t,r),{index:c,value:h,version:_}=s,g=h?(0,i.encodeProto)(p.SyncActionValueSpec,h).readBuffer():h;return{index:m.decode(c),binarySyncAction:g,version:_,keyId:a,operation:t,indexMac:o,valueMac:u,collection:e}}))).apply(this,arguments)}function S(){return T.apply(this,arguments)}function T(){return(T=(0,n.default)((function*(e,t,r,a){var n=a.index.blob,i=a.value.blob,d=(0,u.valueMacFromIndexAndValueCipherText)(i),f=(0,h.split)(i,o.IV_LENGTH,i.byteLength-o.MAC_LENGTH-o.IV_LENGTH),p=f[0],m=f[1],g=f[2],v=yield(0,u.generateEncryptionKeys)(t),{indexKey:E,valueEncryptionKey:y,valueMacKey:S}=v,T=(0,h.combine)([p,m]),b=(0,u.generateAssociatedData)(r,e),A=yield(0,u.generateMac)(b,T,S),C=yield(0,u.decryptCipherText)(new Uint8Array(p),y,m),P=(0,s.decodeSyncActionData)(C),O=_.default.validateSyncActionDataProtobuf(P),w=yield(0,u.generateIndexMac)(E,O.index);if(!(0,h.arrayBuffersAreEqual)(n,w)||!(0,h.arrayBuffersAreEqual)(g,A))throw new c.default.MdFatalError({mdFatalErrorCode:c.default.MD_SYNCD_FATAL_ERROR_CODE.DECRYPTION_FAILED}).commit(),new l.SyncdFatalError("decryption failure");return{syncAction:O,indexMac:n,valueMac:d}}))).apply(this,arguments)}},13562:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.applyIndividualMutations=function(){return z.apply(this,arguments)},t.default=function(){return J.apply(this,arguments)};var n=a(r(19976)),i=a(r(52954)),s=a(r(829)),o=r(9955),u=r(95988),l=r(63487),d=a(r(82657)),c=r(6630),f=r(49859),p=r(53801),h=r(44673),_=r(59933),m=r(3531),g=r(62371),v=r(95314),E=a(r(86850)),y=a(r(70546)),S=r(48361),T=r(84139),b=r(61239),A=a(r(40210)),C=r(71684),P=r(13433),O=r(44880),w=r(16054);function M(){var e=(0,n.default)(["syncd: no handler for action ",""]);return M=function(){return e},e}function I(){var e=(0,n.default)(["syncd: invalid action ",""]);return I=function(){return e},e}function R(){var e=(0,n.default)(["syncd: processed "," mutations in patch version "," of collection ",""]);return R=function(){return e},e}function D(){var e=(0,n.default)(["syncd: collection ","'s snapshot v"," applied"]);return D=function(){return e},e}function N(){var e=(0,n.default)(["syncd: processed "," mutations in snapshot of collection ",""]);return N=function(){return e},e}function L(){var e=(0,n.default)(["syncd: collection ","'s snapshot decrypted"]);return L=function(){return e},e}function k(){var e=(0,n.default)(["syncd: collection ","'s snapshot validated"]);return k=function(){return e},e}function U(){var e=(0,n.default)(["syncd: ","'s external patch downloaded"]);return U=function(){return e},e}function F(){var e=(0,n.default)(["syncd retryable error: "," throws ",""]);return F=function(){return e},e}function G(){var e=(0,n.default)(["syncd fatal error: "," throws ",""]);return G=function(){return e},e}function x(){var e=(0,n.default)(["syncd key error: "," missing keys"]);return x=function(){return e},e}function B(){var e=(0,n.default)(["syncd: sync "," but there are no updates"]);return B=function(){return e},e}function Y(){var e=(0,n.default)(["syncd: "," v"," uploaded successfully"]);return Y=function(){return e},e}function K(){var e=(0,n.default)(["syncd: "," patches applied successfully"]);return K=function(){return e},e}function j(){var e=(0,n.default)(["syncd: "," snapshot and patches applied successfully"]);return j=function(){return e},e}function W(){var e=(0,n.default)(["syncd: start applying collection ",""]);return W=function(){return e},e}function V(){var e=(0,n.default)(["syncd: no handler for action ",""]);return V=function(){return e},e}function H(){var e=(0,n.default)(["syncd: invalid action ",""]);return H=function(){return e},e}var q=new ArrayBuffer(128);function z(){return(z=(0,i.default)((function*(e){if(0===e.length)return Promise.resolve();var t=(0,g.syncActionsToDecryptedMutation)(e);yield Promise.all(t.map(function(){var e=(0,i.default)((function*(e){var{setMutationsToPersist:t,pendingMutationsToDrop:r}=yield se(e.collection,[e]);yield d.default.performTransaction((0,i.default)((function*(){yield d.default.setSyncActionRows(t),yield d.default.bulkRemovePendingMutations(r)})))}));return function(){return e.apply(this,arguments)}}()))}))).apply(this,arguments)}function J(){return(J=(0,i.default)((function*(e,t){var{name:r,version:a,patches:n,snapshot:i,syncedPendingMutationsId:s,syncedEncryptedMutations:o}=e;__LOG__(2)(W(),r);var[u,c]=yield Z(r,n,i,t);try{return null!=u?(yield ee(r,u,c,t),__LOG__(2)(j(),r)):null!=c?(yield re(r,c,t),__LOG__(2)(K(),r)):null!=a?(yield Q(r,a,s,o),__LOG__(2)(Y(),r,a)):((0,w.isBootstrap)(t)&&(yield d.default.setCollectionVersion(r,0,q)),__LOG__(2)(B(),r)),e}catch(e){var p=e.message;return e instanceof f.SyncdMissingKeyError?(__LOG__(3)(x(),r),{name:r,state:l.CollectionState.Blocked}):e instanceof f.SyncdFatalError?(__LOG__(4,void 0,new Error,!0)(G(),r,p),SEND_LOGS("syncd fatal error: ".concat(String(r)," throws ").concat(p)),{name:r,state:l.CollectionState.ErrorFatal}):(__LOG__(3)(F(),r,p),{name:r,state:l.CollectionState.ErrorRetry})}}))).apply(this,arguments)}function Q(){return X.apply(this,arguments)}function X(){return(X=(0,i.default)((function*(e,t,r,a){var n=a.map((e=>({indexMac:e.indexMac,valueMac:e.valueMac,operation:e.operation}))),s=yield(0,u.computeLtHash)(e,n),o=(0,g.encryptedUploadMutationsToSyncActions)(a.filter((e=>e.operation===m.SyncdMutationSyncdOperation.SET)),l.SyncActionState.Success);yield d.default.performTransaction((0,i.default)((function*(){yield d.default.setSyncActionRows(o),yield d.default.bulkRemovePendingMutations(r),yield d.default.setCollectionVersion(e,t,s)})))}))).apply(this,arguments)}function Z(){return $.apply(this,arguments)}function $(){return($=(0,i.default)((function*(e,t,r,a){var n=Promise.resolve(),s=0,o=(0,C.unixTimeMs)();if(null!=r){var u=E.default.validateExternalBlobReference(r);s+=(0,O.numberOrThrowIfTooLarge)(u.fileSizeBytes||0),n=(0,h.downloadSnapshot)(u)}var l,d,c=Promise.resolve();if(null!=t){var f=t.map(E.default.validatePatchProtobuf);c=Promise.all(f.map(function(){var t=(0,i.default)((function*(t){var r=t.mutations||[],a=t.externalMutations;return a&&(r=yield(0,h.downloadExternalPatch)(a),__LOG__(2)(U(),e),s+=(0,O.numberOrThrowIfTooLarge)(a.fileSizeBytes||0)),{mutations:r,version:t.version,snapshotMac:t.snapshotMac,patchMac:t.patchMac,keyId:t.keyId,exitCode:t.exitCode}}));return function(){return t.apply(this,arguments)}}()))}try{[l,d]=yield Promise.all([n,c]),(0,w.isBootstrap)(a)&&(0,P.commitBootstrapAppStateDownloadMetric)(e,o,s,!0)}catch(t){throw(0,w.isBootstrap)(a)&&(0,P.commitBootstrapAppStateDownloadMetric)(e,o,s,!1),t}return[l,d]}))).apply(this,arguments)}function ee(){return te.apply(this,arguments)}function te(){return(te=(0,i.default)((function*(e,t,r,a){try{var n=yield(0,u.computeLtHashAndValidateSnapshot)(e,t);__LOG__(2)(k(),e);var s=yield(0,c.tryDecryptSnapshot)(e,t);__LOG__(2)(L(),e),y.default.addMutationCount(t.records.length),(0,S.logMetricsForMutations)(s),(0,v.validateNoSameIndexForMultipleMutations)(s,l.SyncDataType.Snapshot);var o=t.version.version,{setMutationsToPersist:h,pendingMutationsToDrop:_}=yield se(e,s);__LOG__(2)(N(),s.length,e),__LOG__(2)(D(),e,o),yield d.default.performTransaction((0,i.default)((function*(){yield d.default.setSyncActionRows(h),yield d.default.bulkRemovePendingMutations(_),yield d.default.setCollectionVersion(e,o,n)})))}catch(r){throw r instanceof f.SyncdMissingKeyError&&(yield(0,p.handleMissingKeysInSnapshot)(e,t)),r}if(r)return re(e,r,a)}))).apply(this,arguments)}function re(){return ae.apply(this,arguments)}function ae(){return(ae=(0,i.default)((function*(e,t){if(0===t.length)return Promise.resolve();(0,v.validateNoDuplicatePatchVersionInCollection)(t);var r=(0,s.default)(t,(e=>e.version.version));try{for(var a=0;a<r.length;a++)yield ne(e,r[a])}catch(t){throw t instanceof f.SyncdMissingKeyError&&(yield(0,p.handleMissingKeysInPatches)(e,r)),t}}))).apply(this,arguments)}function ne(){return ie.apply(this,arguments)}function ie(){return(ie=(0,i.default)((function*(e,t){if(t.exitCode){var r,a=t.exitCode.code;switch(a){case 100:new A.default.MdFatalError({mdFatalErrorCode:A.default.MD_SYNCD_FATAL_ERROR_CODE.TERMINAL_PATCH_MISSING_DATA}).commit();break;case 101:new A.default.MdFatalError({mdFatalErrorCode:A.default.MD_SYNCD_FATAL_ERROR_CODE.TERMINAL_PATCH_DESERIALIZATION_ERROR}).commit();break;default:new A.default.MdFatalError({mdFatalErrorCode:A.default.MD_SYNCD_FATAL_ERROR_CODE.TERMINAL_PATCH_UNKNOWN}).commit()}throw new f.SyncdFatalError("received terminal patch with exit code:  ".concat(String(a)," text: ").concat(String(null===(r=t.exitCode)||void 0===r?void 0:r.text),"  "))}var n=yield(0,u.computeLtHashAndValidatePatch)(e,t),s=yield(0,c.tryDecryptPatch)(e,t);(0,S.logMetricsForMutations)(s),y.default.addMutationCount(s.length),(0,v.validateNoSameIndexForMultipleMutations)(s,l.SyncDataType.Patch);var o=de(s),p=o.filter((e=>e.operation===m.SyncdMutationSyncdOperation.REMOVE));yield ue(e,p);var h=o.filter((e=>e.operation===m.SyncdMutationSyncdOperation.SET)),{setMutationsToPersist:_,pendingMutationsToDrop:g}=yield se(e,h);__LOG__(2)(R(),s.length,t.version.version,e);var E=t.version.version;yield d.default.performTransaction((0,i.default)((function*(){yield d.default.deleteSyncActionRows(p.map((e=>e.index))),yield d.default.setSyncActionRows(_),yield d.default.bulkRemovePendingMutations(g),yield d.default.setCollectionVersion(e,E,n)})))}))).apply(this,arguments)}function se(){return oe.apply(this,arguments)}function oe(){return(oe=(0,i.default)((function*(e,t){var r=[],a=(0,v.validateAndTypeSetMutations)(t),{supportedMutations:n,unsupportedMutations:i}=ce(a);i.forEach((e=>r.push((0,g.setMutationToSyncAction)(e,l.SyncActionState.Unsupported))));var{remoteMutationsToApply:s,pendingMutationsToDrop:o}=yield(0,_.resolveConflict)(e,n);n.filter((e=>!s.includes(e))).forEach((e=>r.push((0,g.setMutationToSyncAction)(e,l.SyncActionState.Skipped,e.actionName))));for(var u=fe(s),d=0;d<u.length;d++)for(var c=u[d][0].actionHandler,f=yield c.applyMutations(u[d].map((e=>({operation:"set",indexParts:e.indexArr,value:(0,T.decodeProto)(b.SyncActionValueSpec,e.binarySyncAction),timestamp:e.timestamp})))),p=0;p<u[d].length;p++){var h,m;r.push((0,g.setMutationToSyncAction)(u[d][p],f[p].actionState,u[d][p].actionName,null===(h=f[p].orphanModel)||void 0===h?void 0:h.modelId,null===(m=f[p].orphanModel)||void 0===m?void 0:m.modelType))}return{setMutationsToPersist:r,pendingMutationsToDrop:o}}))).apply(this,arguments)}function ue(){return le.apply(this,arguments)}function le(){return(le=(0,i.default)((function*(e,t){yield Promise.all(t.map(function(){var e=(0,i.default)((function*(e){var t=pe(e.index),r=l.Actions.cast(t[0]);if(r){var a=o.ActionHandlers.get(r);a?yield a.applyMutations([{operation:"remove",indexParts:t}]):__LOG__(2)(M(),r)}else __LOG__(2)(I(),t[0])}));return function(){return e.apply(this,arguments)}}()))}))).apply(this,arguments)}function de(e){var t=e.filter((e=>e.operation===m.SyncdMutationSyncdOperation.SET)),r=new Set(t.map((e=>e.index)));return e.filter((e=>e.operation===m.SyncdMutationSyncdOperation.REMOVE)).forEach((e=>{r.has(e.index)||t.push(e)})),t}function ce(e){var t=[],r=[];return e.forEach((e=>{if(e.version>(0,o.maxSupportedVersion)())r.push(e);else{var a=pe(e.index),n=l.Actions.cast(a[0]);if(!n)return __LOG__(3)(H(),a[0]),void r.push(e);var i=o.ActionHandlers.get(n);if(!i)return __LOG__(3)(V(),n),void r.push(e);t.push({collection:e.collection,index:e.index,indexMac:e.indexMac,keyId:e.keyId,timestamp:e.timestamp,binarySyncAction:e.binarySyncAction,valueMac:e.valueMac,version:e.version,indexArr:a,actionName:n,actionHandler:i})}})),{supportedMutations:t,unsupportedMutations:r}}function fe(e){return e.reduce(((e,t)=>(0!==e.length&&t.actionName===e[e.length-1][0].actionName?e[e.length-1].push(t):e.push([t]),e)),[])}function pe(e){try{var t=JSON.parse(e);if(t.length<1)throw new Error;return t}catch(e){throw new A.default.MdFatalError({mdFatalErrorCode:A.default.MD_SYNCD_FATAL_ERROR_CODE.INVALID_ACTION_INDEX}).commit(),new f.SyncdFatalError("invalid action index")}}},44673:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.downloadSnapshot=function(){return h.apply(this,arguments)},t.downloadExternalPatch=function(){return _.apply(this,arguments)};var n=a(r(70417)),i=a(r(52954)),s=r(7150),o=r(60339),u=a(r(12489)),l=a(r(1616)),d=a(r(86850)),c=r(50261),f=a(r(40210)),p=r(49859);function h(){return(h=(0,i.default)((function*(e){try{var t=yield m(e),r=(0,s.decodeSyncdSnapshot)(t);return d.default.validateSnapshotProtobuf(r)}catch(e){if(e instanceof c.MediaNotFoundError)throw new f.default.MdFatalError({mdFatalErrorCode:f.default.MD_SYNCD_FATAL_ERROR_CODE.SNAPSHOT_EXPIRED}).commit(),new p.SyncdFatalError("snapshot expired");throw e}}))).apply(this,arguments)}function _(){return(_=(0,i.default)((function*(e){try{var t=yield m(e);return(0,s.decodeSyncdMutations)(t).mutations.map(d.default.validateMutationProtobuf)}catch(e){if(e instanceof c.MediaNotFoundError)throw new f.default.MdFatalError({mdFatalErrorCode:f.default.MD_SYNCD_FATAL_ERROR_CODE.EXTERNAL_PATCH_EXPIRED}).commit(),new p.SyncdFatalError("external patch expired");throw e}}))).apply(this,arguments)}function m(e){var{mediaKey:t,directPath:r,fileSha256:a,fileEncSha256:i}=e,s={directPath:r,encFilehash:(0,o.encodeB64)(i),filehash:(0,o.encodeB64)(a),mediaKey:(0,o.encodeB64)(t),type:"md-app-state",userDownloadAttemptCount:0};return l.default.downloadAndDecrypt((0,n.default)({signal:(new u.default).signal},s))}},59933:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.resolveConflict=function(){return u.apply(this,arguments)};var n=a(r(52954)),i=r(63487),s=a(r(82657)),o=r(35202);function u(){return(u=(0,n.default)((function*(e,t){var r=[],a=[],n=yield s.default.getPendingMutationsRows(["collection"],e),u=new Map(n.map((e=>[e.index,e])));t.forEach((e=>{var t=u.get(e.index);if(t)switch(e.actionHandler.resolveConflicts(t,e)){case i.ConflictResolutionState.SkipRemote:break;case i.ConflictResolutionState.ApplyRemoteAndDropLocal:r.push(e),a=a.concat(n.filter((t=>t.index===e.index)));break;case i.ConflictResolutionState.SkipRemoteAndDropLocal:a=a.concat(n.filter((t=>t.index===e.index)))}else r.push(e)}));for(var l=(0,o.sort)(r),d=[],c=0;c<l.length;c++){var f=l[c].actionHandler;(yield f.dropMutationDueToCrossIndexConflict(l[c],u))||d.push(l[c])}return{remoteMutationsToApply:d,pendingMutationsToDrop:a.map((e=>e.id)).filter(Boolean)}}))).apply(this,arguments)}},35202:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.sort=function(e){var t=[],r=[];try{return e.forEach((a=>{t.push(a);var n=o.get(a.actionName);null!=n&&e.forEach((e=>{e!==a&&n.includes(e.actionName)&&function(e,t){var r=e.actionHandler.getChatJidAndMessageKey(e),a=t.actionHandler.getChatJidAndMessageKey(t);if(r&&a)return r.chatJid===a.chatJid&&(null==r.messageKey||null==a.messageKey||r.messageKey===a.messageKey);return!1}(e,a)&&(e.timestamp<a.timestamp?r.push([e,a]):r.push([a,e]))}))})),n.default.array(t,r)}catch(e){throw new s.default.MdFatalError({mdFatalErrorCode:s.default.MD_SYNCD_FATAL_ERROR_CODE.CYCLIC_MUTATION_DEPENDENCY_IN_PATCH}).commit(),new i.SyncdFatalError("cyclic mutation dependency in patch")}},t._setDependency=function(e,t){o.set(e,t)};var n=a(r(95159)),i=(r(63487),r(49859)),s=a(r(40210)),o=new Map},62371:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.encryptedUploadMutationsToSyncActions=function(e,t){return e.map((e=>({index:e.index,binarySyncAction:e.binarySyncAction,actionState:t,version:e.version,keyId:e.keyId,indexMac:e.indexMac,valueMac:e.valueMac,collection:e.collection,timestamp:e.timestamp})))},t.setMutationToSyncAction=function(e,t,r,a,n){return{index:e.index,binarySyncAction:e.binarySyncAction,version:e.version,keyId:e.keyId,indexMac:e.indexMac,valueMac:e.valueMac,collection:e.collection,timestamp:e.timestamp,action:r,actionState:t,modelId:a,modelType:n}},t.syncActionsToDecryptedMutation=function(e){return e.map((e=>({collection:e.collection,index:e.index,indexMac:e.indexMac,keyId:e.keyId,operation:a.SyncdMutationSyncdOperation.SET,binarySyncAction:e.binarySyncAction,valueMac:e.valueMac,version:e.version})))};var a=r(3531)},95314:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.validateNoDuplicatePatchVersionInCollection=function(e){var t=new Set;e.forEach((e=>{var r=e.version.version;if(t.has(r))throw new o.default.MdFatalError({mdFatalErrorCode:o.default.MD_SYNCD_FATAL_ERROR_CODE.DUPLICATE_PATCH_VERSION_IN_COLLECTION}).commit(),new s.SyncdFatalError("duplicate patch version in collection");t.add(r)}))},t.validateNoSameIndexForMultipleMutations=function(e,t){var r=new Set,a=new Set;e.forEach((e=>{var n=!1;if(e.operation===u.SyncdMutationSyncdOperation.SET&&(r.has(e.index)?n=!0:r.add(e.index)),e.operation===u.SyncdMutationSyncdOperation.REMOVE&&(a.has(e.index)?n=!0:a.add(e.index)),n)switch(t){case i.SyncDataType.Patch:throw new o.default.MdFatalError({mdFatalErrorCode:o.default.MD_SYNCD_FATAL_ERROR_CODE.SAME_INDEX_FOR_MULTIPLE_MUTATIONS_IN_PATCH}).commit(),new s.SyncdFatalError("same index for multiple mutations in patch");case i.SyncDataType.Snapshot:throw new o.default.MdFatalError({mdFatalErrorCode:o.default.MD_SYNCD_FATAL_ERROR_CODE.SAME_INDEX_FOR_MULTIPLE_MUTATIONS_IN_SNAPSHOT}).commit(),new s.SyncdFatalError("same index for multiple mutations in snapshot")}}))},t.validateAndTypeSetMutations=function(e){return e.map((e=>{var t=e.binarySyncAction;if(!t)throw new o.default.MdFatalError({mdFatalErrorCode:o.default.MD_SYNCD_FATAL_ERROR_CODE.MISSING_ACTION_VALUE}).commit(),new s.SyncdFatalError("missing action value");var r=(0,l.decodeProto)(d.SyncActionValueSpec,t),a=(0,n.maybeNumberOrThrowIfTooLarge)(r.timestamp);if(null==a)throw new o.default.MdFatalError({mdFatalErrorCode:o.default.MD_SYNCD_FATAL_ERROR_CODE.MISSING_ACTION_TIMESTAMP}).commit(),new s.SyncdFatalError("missing action timestamp");return{index:e.index,version:e.version,keyId:e.keyId,indexMac:e.indexMac,valueMac:e.valueMac,collection:e.collection,binarySyncAction:t,timestamp:a}}))};var n=r(44880),i=r(63487),s=r(49859),o=a(r(40210)),u=r(3531),l=r(84139),d=r(61239)},86850:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(19976)),i=r(44880),s=r(49859),o=a(r(40210)),u=a(r(72424));function l(){var e=(0,n.default)(["syncd warning:  missing patch mac"]);return l=function(){return e},e}function d(){var e=(0,n.default)(["syncd warning:  missing snapshot mac"]);return d=function(){return e},e}function c(){var e=(0,n.default)(["syncd warning: missing snapshot mac"]);return c=function(){return e},e}var f=new ArrayBuffer(0);class p{static validateSnapshotProtobuf(e){var{version:t,records:r,mac:a,keyId:n}=e,l=null==t?void 0:t.version;if(!t||null==l)throw new o.default.MdFatalError({mdFatalErrorCode:o.default.MD_SYNCD_FATAL_ERROR_CODE.MISSING_SNAPSHOT_VERSION}).commit(),new s.SyncdFatalError("missing snapshot version");var d=r.map((e=>p.validateRecordProtobuf(e)));if(u.default.syncdAntiTamperingFatalExceptionEnabled){if(!a)throw new o.default.MdFatalError({mdFatalErrorCode:o.default.MD_SYNCD_FATAL_ERROR_CODE.MISSING_SNAPSHOT_MAC}).commit(),new s.SyncdFatalError("missing snapshot mac")}else a||(new o.default.MdFatalError({mdFatalErrorCode:o.default.MD_SYNCD_FATAL_ERROR_CODE.MISSING_SNAPSHOT_MAC}).commit(),__LOG__(3)(c()));var h=null!=a?a:f,_=p.validateKeyIdProtobuf(n,o.default.MD_SYNCD_FATAL_ERROR_CODE.MISSING_SNAPSHOT_KEY_ID);return{version:{version:(0,i.numberOrThrowIfTooLarge)(l)},records:d,mac:h,keyId:_}}static validatePatchProtobuf(e){var{version:t,mutations:r,externalMutations:a,snapshotMac:n,patchMac:c,keyId:h,exitCode:_}=e,m=null==t?void 0:t.version;if(!t||null==m)throw new o.default.MdFatalError({mdFatalErrorCode:o.default.MD_SYNCD_FATAL_ERROR_CODE.MISSING_PATCH_VERSION}).commit(),new s.SyncdFatalError("missing patch version");if(r&&r.length>0&&a)throw new o.default.MdFatalError({mdFatalErrorCode:o.default.MD_SYNCD_FATAL_ERROR_CODE.PATCH_WITH_BOTH_INLINE_AND_EXTERNAL_MUTATIONS}).commit(),new s.SyncdFatalError("patch with both inline and external mutations");if(u.default.syncdAntiTamperingFatalExceptionEnabled){if(!n)throw new o.default.MdFatalError({mdFatalErrorCode:o.default.MD_SYNCD_FATAL_ERROR_CODE.MISSING_PATCH_SNAPSHOT_MAC}).commit(),new s.SyncdFatalError("missing patch snapshot mac");if(!c)throw new o.default.MdFatalError({mdFatalErrorCode:o.default.MD_SYNCD_FATAL_ERROR_CODE.MISSING_PATCH_MAC}).commit(),new s.SyncdFatalError("missing patch mac")}else n||(new o.default.MdFatalError({mdFatalErrorCode:o.default.MD_SYNCD_FATAL_ERROR_CODE.MISSING_SNAPSHOT_MAC}).commit(),__LOG__(3)(d())),c||(new o.default.MdFatalError({mdFatalErrorCode:o.default.MD_SYNCD_FATAL_ERROR_CODE.MISSING_PATCH_MAC}).commit(),__LOG__(3)(l()));var g=null!=n?n:f,v=null!=c?c:f,E=p.validateKeyIdProtobuf(h,o.default.MD_SYNCD_FATAL_ERROR_CODE.MISSING_PATCH_KEY_ID);if(a){var y=p.validateExternalBlobReference(a);return{version:{version:(0,i.numberOrThrowIfTooLarge)(m)},mutations:void 0,externalMutations:y,snapshotMac:g,patchMac:v,keyId:E}}var S=r.map(p.validateMutationProtobuf);return{version:{version:(0,i.numberOrThrowIfTooLarge)(m)},mutations:S,externalMutations:void 0,exitCode:_,snapshotMac:g,patchMac:v,keyId:E}}static validateExternalBlobReference(e){var{mediaKey:t,directPath:r,handle:a,fileSizeBytes:n,fileSha256:i,fileEncSha256:u}=e;if(!t)throw new o.default.MdFatalError({mdFatalErrorCode:o.default.MD_SYNCD_FATAL_ERROR_CODE.MISSING_EXTERNAL_BLOB_REFERENCE_MEDIA_KEY}).commit(),new s.SyncdFatalError("missing external blob reference media key");if(!r)throw new o.default.MdFatalError({mdFatalErrorCode:o.default.MD_SYNCD_FATAL_ERROR_CODE.MISSING_EXTERNAL_BLOB_REFERENCE_DIRECT_PATH}).commit(),new s.SyncdFatalError("missing external blob reference direct path");if(!i)throw new o.default.MdFatalError({mdFatalErrorCode:o.default.MD_SYNCD_FATAL_ERROR_CODE.MISSING_EXTERNAL_BLOB_REFERENCE_FILE_SHA256}).commit(),new s.SyncdFatalError("missing external blob reference file SHA256");if(!u)throw new o.default.MdFatalError({mdFatalErrorCode:o.default.MD_SYNCD_FATAL_ERROR_CODE.MISSING_EXTERNAL_BLOB_REFERENCE_FILE_ENC_SHA256}).commit(),new s.SyncdFatalError("missing external blob reference file enc SHA256");return{mediaKey:t,directPath:r,handle:a,fileSizeBytes:n,fileSha256:i,fileEncSha256:u}}static validateMutationProtobuf(e){var{operation:t,record:r}=e;if(null==t)throw new o.default.MdFatalError({mdFatalErrorCode:o.default.MD_SYNCD_FATAL_ERROR_CODE.MISSING_MUTATION_OPERATION}).commit(),new s.SyncdFatalError("missing mutation operation");if(!r)throw new o.default.MdFatalError({mdFatalErrorCode:o.default.MD_SYNCD_FATAL_ERROR_CODE.MISSING_MUTATION_RECORD}).commit(),new s.SyncdFatalError("missing mutation record");return{operation:t,record:p.validateRecordProtobuf(r)}}static validateRecordProtobuf(e){var{index:t,value:r,keyId:a}=e,n=null==t?void 0:t.blob,i=null==r?void 0:r.blob;if(!t||!n)throw new o.default.MdFatalError({mdFatalErrorCode:o.default.MD_SYNCD_FATAL_ERROR_CODE.MISSING_MUTATION_INDEX}).commit(),new s.SyncdFatalError("missing mutation index");if(!r||!i)throw new o.default.MdFatalError({mdFatalErrorCode:o.default.MD_SYNCD_FATAL_ERROR_CODE.MISSING_MUTATION_VALUE}).commit(),new s.SyncdFatalError("missing mutation value");return{index:{blob:n},value:{blob:i},keyId:p.validateKeyIdProtobuf(a,o.default.MD_SYNCD_FATAL_ERROR_CODE.MISSING_MUTATION_KEY_ID)}}static validateKeyIdProtobuf(e,t){var r=null==e?void 0:e.id;if(!e||!r)throw new o.default.MdFatalError({mdFatalErrorCode:t}).commit(),new s.SyncdFatalError("missing mutation key id");return{id:r}}}t.default=p},30376:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(49859),i=a(r(40210));t.default=class{static validateSyncActionDataProtobuf(e){var{index:t,value:r,padding:a,version:s}=e;if(!t)throw new i.default.MdFatalError({mdFatalErrorCode:i.default.MD_SYNCD_FATAL_ERROR_CODE.MISSING_ACTION_INDEX}).commit(),new n.SyncdFatalError("missing action index");if(null==s)throw new i.default.MdFatalError({mdFatalErrorCode:i.default.MD_SYNCD_FATAL_ERROR_CODE.MISSING_ACTION_VERSION}).commit(),new n.SyncdFatalError("missing action version");return{index:t,value:r,padding:a,version:s}}}},48361:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.logMetricsForMutations=function(e){e.forEach(o)};var n=a(r(40210)),i=r(84139),s=r(61239);function o(e){var t,{binarySyncAction:r}=e;if(null!=r){var a=(0,i.decodeProto)(s.SyncActionValueSpec,r);a.archiveChatAction?t=a.archiveChatAction.messageRange:a.markChatAsReadAction?t=a.markChatAsReadAction.messageRange:a.clearChatAction?t=a.clearChatAction.messageRange:a.deleteChatAction&&(t=a.deleteChatAction.messageRange),null!=t&&new n.default.MdAppStateMessageRange({additionalMessagesCount:t.messages.length}).commit()}}},13433:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.commitBootstrapAppStateDownloadMetric=function(){return c.apply(this,arguments)};var i=n(r(52954)),s=n(r(40210)),o=r(71684),u=r(63487),l=r(44880),d=a(r(29891));function c(){return(c=(0,i.default)((function*(e,t,r,a){var n=new s.default.MdBootstrapAppStateDataDownloaded({mdBootstrapPayloadType:[u.CollectionName.CriticalBlock,u.CollectionName.CriticalUnblockLow].includes(e)?s.default.MD_BOOTSTRAP_PAYLOAD_TYPE.CRITICAL:s.default.MD_BOOTSTRAP_PAYLOAD_TYPE.NON_CRITICAL,mdTimestamp:(0,o.unixTimeMs)(),mdBootstrapStepDuration:(0,o.unixTimeMs)()-t,mdBootstrapStepResult:a?s.default.MD_BOOTSTRAP_STEP_RESULT.SUCCESS:s.default.MD_BOOTSTRAP_STEP_RESULT.FAILURE,mdSessionId:yield d.default.getMdSessionId()}),i=yield d.default.getStorageEstimation();i.mdStorageQuotaBytes!==d.STORAGE_QUOTA_UNAVAILABLE&&(n.mdStorageQuotaUsedBytes=i.mdStorageQuotaUsedBytes,n.mdStorageQuotaBytes=i.mdStorageQuotaBytes);try{var c=(0,l.maybeNumberOrThrowIfTooLarge)(r);null!=c&&(n.mdBootstrapPayloadSize=c)}catch(e){}n.commit()}))).apply(this,arguments)}},25813:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.handleAppStateSyncKeyRequest=function(){return o.apply(this,arguments)};var n=a(r(52954)),i=a(r(82657)),s=r(43526);function o(){return(o=(0,n.default)((function*(e,t){var r=e.keyIds;if(r){var a=r.map((e=>e.keyId)).filter(Boolean);if(a){var o=[],u=[];return yield Promise.all(a.map(function(){var e=(0,n.default)((function*(e){var t=yield i.default.getSyncKey(new Uint8Array(e));t?o.push(t):u.push(e)}));return function(){return e.apply(this,arguments)}}())),(0,s.sendAppStateSyncKeyShare)({type:"missing_key",keys:o,orphanKeys:u,peerDeviceId:t})}}}))).apply(this,arguments)}},76241:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.handleAppStateSyncKeyShare=function(){return E.apply(this,arguments)};var n=a(r(19976)),i=a(r(52954)),s=r(44880),o=a(r(82657)),u=r(53801),l=r(61392),d=a(r(40210)),c=r(23398),f=r(69551),p=r(61671);function h(){var e=(0,n.default)(["syncd: stored key share key id "," from device id ",""]);return h=function(){return e},e}function _(){var e=(0,n.default)(["syncd fatal error: invalid key share key data"]);return _=function(){return e},e}function m(){var e=(0,n.default)(["syncd: received key share key id "," from device id ",""]);return m=function(){return e},e}function g(){var e=(0,n.default)(["syncd fatal error: key share key id has invalid bytelength of ",""]);return g=function(){return e},e}function v(){var e=(0,n.default)(["syncd: received empty key share from device id ",""]);return v=function(){return e},e}function E(){return(E=(0,i.default)((function*(e,t){var r=[],a=e.keys;if(!a)return Promise.resolve();yield Promise.all(a.map(function(){var e=(0,i.default)((function*(e){var a,n=null===(a=e.keyId)||void 0===a?void 0:a.keyId,i=e.keyData,u=null==i?void 0:i.keyData;if(n){if(6!==n.byteLength)return new d.default.MdFatalError({mdFatalErrorCode:d.default.MD_SYNCD_FATAL_ERROR_CODE.INVALID_KEY_SHARE_KEY_ID}).commit(),__LOG__(4,void 0,new Error,!0)(g(),n.byteLength),SEND_LOGS("syncd fatal error: key share key id has invalid bytelength of ".concat(n.byteLength)),(0,c.handleFatalError)();if(r.push({keyId:n,keyData:u}),__LOG__(2)(m(),(0,f.arrayBufferToHex)(n),t.getDeviceId()),i){var l,E,y,S=i.timestamp,T=null===(l=i.fingerprint)||void 0===l?void 0:l.currentIndex,b=null===(E=i.fingerprint)||void 0===E?void 0:E.rawId,A=null===(y=i.fingerprint)||void 0===y?void 0:y.deviceIndexes;if(!u||null==S||null==T||null==b||!A)return new d.default.MdFatalError({mdFatalErrorCode:d.default.MD_SYNCD_FATAL_ERROR_CODE.INVALID_KEY_SHARE_KEY_DATA}).commit(),__LOG__(4,void 0,new Error,!0)(_()),SEND_LOGS("syncd fatal error: invalid key share key data"),(0,c.handleFatalError)();var C=new Uint8Array(n);(yield o.default.getSyncKey(C))||(yield o.default.createSyncKey({keyId:C,keyEpoch:(0,p.getKeyEpoch)(n),keyData:u,timestamp:(0,s.numberOrThrowIfTooLarge)(S),fingerprint:{rawId:b,currentIndex:T,deviceIndexes:A}}),__LOG__(2)(h(),(0,f.arrayBufferToHex)(n),t.getDeviceId()))}}else __LOG__(2)(v(),t.getDeviceId())}));return function(){return e.apply(this,arguments)}}())),yield(0,u.updateMissingKeys)(r,t),(0,l.syncBlockedCollections)()}))).apply(this,arguments)}},53801:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.updateMissingKeyDevices=function(){return b.apply(this,arguments)},t.updateMissingKeys=function(e,t){var r=[],a=[];return e.forEach((e=>{var t=e.keyData,n=(0,_.arrayBufferToHex)(e.keyId);t?r.push(n):a.push(n)})),(0,m.getStorage)().lock(["missing-keys"],function(){var e=(0,s.default)((function*(){if(r.length>0&&(yield l.default.bulkRemoveMissingKeys(r),yield I()),a.length>0){var e=(yield l.default.bulkGetMissingKeys(a)).filter(Boolean),n=t.getDeviceId();e.forEach((e=>e.deviceResponses.set(n,!1))),yield l.default.createOrUpdateMissingKeys(e),yield N()}}));return function(){return e.apply(this,arguments)}}())},t.handleMissingKeysInSnapshot=function(){return A.apply(this,arguments)},t.handleMissingKeysInPatches=function(){return C.apply(this,arguments)};var n,i=a(r(19976)),s=a(r(52954)),o=a(r(10937)),u=r(71684),l=a(r(82657)),d=a(r(40210)),c=r(89532),f=a(r(72424)),p=r(23398),h=r(61671),_=(r(63487),r(69551)),m=r(77993),g=r(49859);function v(){var e=(0,i.default)(["syncd fatal error: missing key on all clients"]);return v=function(){return e},e}function E(){var e=(0,i.default)(["syncd: collection ","'s patches has missing keys ",""]);return E=function(){return e},e}function y(){var e=(0,i.default)(["syncd: collection ","'s snapshot has missing keys ",""]);return y=function(){return e},e}function S(){var e=(0,i.default)(["syncd fatal error: timeout while waiting for missing key"]);return S=function(){return e},e}var T=new ArrayBuffer(0);function b(){return(b=(0,s.default)((function*(){var e=(yield(0,h.getPeerDevices)()).map((e=>e.getDeviceId()));return(0,m.getStorage)().lock(["missing-keys"],function(){var t=(0,s.default)((function*(){var t=yield l.default.getAllMissingKeys();if(0===t.length)return Promise.resolve();t.forEach((t=>{t.deviceResponses.forEach(((r,a)=>{e.includes(a)||t.deviceResponses.delete(a)}))})),yield l.default.createOrUpdateMissingKeys(t),yield N()}));return function(){return t.apply(this,arguments)}}())}))).apply(this,arguments)}function A(){return(A=(0,s.default)((function*(e,t){var r=new Set,a=(yield l.default.getAllSyncKeys()).map((e=>(0,_.arrayBufferToHex)(e.keyId.buffer)));t.records.forEach((e=>{var t=e.keyId.id;if((0,_.arrayBuffersAreEqual)(t,T))throw new g.SyncdFatalError("snapshot has empty key");var n=(0,_.arrayBufferToHex)(t);a.includes(n)||r.add(n)})),__LOG__(2)(y(),e,[...r]),yield P(r)}))).apply(this,arguments)}function C(){return(C=(0,s.default)((function*(e,t){var r=new Set,a=(yield l.default.getAllSyncKeys()).map((e=>(0,_.arrayBufferToHex)(e.keyId.buffer)));t.forEach((e=>{var t=e.keyId.id;if((0,_.arrayBuffersAreEqual)(t,T))throw new g.SyncdFatalError("patches has empty key");var n=(0,_.arrayBufferToHex)(t);a.includes(n)||r.add(n)})),__LOG__(2)(E(),e,[...r]),yield P(r)}))).apply(this,arguments)}function P(){return O.apply(this,arguments)}function O(){return(O=(0,s.default)((function*(e){var t=[...e],r=yield l.default.bulkGetMissingKeys(t),a=t.filter((e=>!r.includes(e)));if(0===a.length)return Promise.resolve();var n=yield(0,h.getPeerDevices)(),i=a.map((e=>(0,_.hexToUint8Array)(e).buffer));yield(0,c.sendAppStateSyncKeyRequest)(i,n),yield w(i,n.map((e=>e.getDeviceId())))}))).apply(this,arguments)}function w(){return M.apply(this,arguments)}function M(){return(M=(0,s.default)((function*(e,t){var r=e.map((e=>{return{keyHex:(0,_.arrayBufferToHex)(e),keyId:e,timestamp:(0,u.unixTimeMs)(),deviceResponses:(r=new Map,t.forEach((e=>r.set(e,null))),r)};var r}));yield l.default.createOrUpdateMissingKeys(r),yield I()}))).apply(this,arguments)}function I(){return R.apply(this,arguments)}function R(){return(R=(0,s.default)((function*(){clearTimeout(n),n=null;var e=yield l.default.getAllMissingKeys();if(0!==e.length){var t=(0,o.default)(e,(e=>e.timestamp)).timestamp,r=f.default.syncdWaitForKeyTimeoutDays*u.DAY_MILLISECONDS-(-t+(0,u.unixTimeMs)());n=setTimeout(D,r)}}))).apply(this,arguments)}function D(){new d.default.MdFatalError({mdFatalErrorCode:d.default.MD_SYNCD_FATAL_ERROR_CODE.TIMEOUT_WHILE_WAITING_FOR_MISSING_KEY}).commit(),__LOG__(4,void 0,new Error,!0)(S()),SEND_LOGS("syncd fatal error: timeout while waiting for missing key"),(0,p.handleFatalError)()}function N(){return L.apply(this,arguments)}function L(){return(L=(0,s.default)((function*(){var e=yield l.default.getAllMissingKeys();for(var t of e){var r=!0;for(var a of t.deviceResponses.values())if(null==a){r=!1;break}if(r)return new d.default.MdFatalError({mdFatalErrorCode:d.default.MD_SYNCD_FATAL_ERROR_CODE.MISSING_KEY_ON_ALL_CLIENTS}).commit(),__LOG__(4,void 0,new Error,!0)(v()),SEND_LOGS("syncd fatal error: missing key on all clients"),void(0,p.handleFatalError)()}}))).apply(this,arguments)}},22163:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.getActiveKey=S,t.getNewestKeyPair=b,t.getKeyData=function(){return C.apply(this,arguments)},t.clearSyncKeysCache=function(){y=new Map};var n=a(r(19976)),i=a(r(52954)),s=a(r(10937)),o=a(r(90882)),u=a(r(71644)),l=a(r(82657)),d=r(77725),c=r(37262),f=r(43526),p=r(61671),h=a(r(40210)),_=r(60339),m=r(69551);function g(){var e=(0,n.default)(["syncd key rotation due to device removal"]);return g=function(){return e},e}function v(){var e=(0,n.default)(["syncd key rotation due to key expiry"]);return v=function(){return e},e}function E(){var e=(0,n.default)(["syncd: stored key rotation key id ",""]);return E=function(){return e},e}var y=new Map;function S(){return T.apply(this,arguments)}function T(){return(T=(0,i.default)((function*(e=!0){var t=yield b(),r=yield(0,d.getMyDeviceList)(),{currentIndex:a,devices:n,rawId:i}=r;if(null==a)throw new Error("syncd: missing current index for own device");r={currentIndex:a,deviceIndexes:n.map((e=>e.keyIndex)),rawId:i};var s=(0,c.hasKeyExpired)(t),o=(0,c.hasADeviceBeenRemoved)(t,r);return e&&(s||o)?(t=(0,c.rotateKey)(t,r),__LOG__(2)(E(),(0,m.arrayBufferToHex)(t.keyId.buffer)),yield l.default.createSyncKey(t),yield(0,f.sendAppStateSyncKeyShare)({type:"key_rotation",keys:[t]}),s&&(__LOG__(2)(v()),new h.default.MdAppStateKeyRotation({mdAppStateKeyRotationReason:h.default.MD_APP_STATE_KEY_ROTATION_REASON_CODE.APP_STATE_SYNC_KEY_EXPIRY}).commit()),o&&(__LOG__(2)(g()),new h.default.MdAppStateKeyRotation({mdAppStateKeyRotationReason:h.default.MD_APP_STATE_KEY_ROTATION_REASON_CODE.DEVICE_DEREGISTERATION}).commit()),S(e)):{keyId:t.keyId.buffer,keyData:t.keyData}}))).apply(this,arguments)}function b(){return A.apply(this,arguments)}function A(){return(A=(0,i.default)((function*(){var e=yield l.default.getAllSyncKeys(),t=(0,u.default)(e.map((e=>(0,p.getKeyEpoch)(e.keyId.buffer)))),r=(0,o.default)(e,(e=>(0,p.getKeyEpoch)(e.keyId.buffer)===t));return(0,s.default)(r,(e=>(0,p.getKeyDeviceId)(e.keyId.buffer)))}))).apply(this,arguments)}function C(){return(C=(0,i.default)((function*(e){var t,r=y.get((0,_.encodeB64)(e));return r?r.keyData:((r=yield l.default.getSyncKeyData(new Uint8Array(e)))&&y.set((0,_.encodeB64)(e),r),null===(t=r)||void 0===t?void 0:t.keyData)}))).apply(this,arguments)}},37262:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.hasKeyExpired=function(e){var t=e.timestamp,r=Math.min(90,Math.max(1,l.default.syncdKeyMaxUseDays));return(0,i.unixTimeMs)()-t>r*i.DAY_MILLISECONDS},t.hasADeviceBeenRemoved=function(e,t){for(var r=e.fingerprint,{rawId:a,currentIndex:i,deviceIndexes:s}=t,o=new Set(r.deviceIndexes),u=r.currentIndex+1;u<=i;u++)o.add(u);return r.rawId!==a||!(0,n.default)(o,new Set(s))},t.rotateKey=function(e,t){var{keyId:r,keyEpoch:a}=function(e){var t=(0,d.getKeyEpoch)(e.keyId.buffer)+1,r=(0,u.assertGetMe)().getDeviceId();return{keyId:new Uint8Array((0,o.default)((0,s.intToBytes)(2,r).buffer,(0,s.intToBytes)(4,t).buffer)),keyEpoch:t}}(e),n=self.crypto.getRandomValues(new Uint8Array(32)).buffer,l=function(e){var{currentIndex:t,deviceIndexes:r,rawId:a}=e;return{rawId:a,currentIndex:t,deviceIndexes:r}}(t),c=(0,i.unixTimeMs)();return{keyId:r,keyEpoch:a,keyData:n,fingerprint:l,timestamp:c}};var n=a(r(18149)),i=r(71684),s=r(59410),o=a(r(50846)),u=r(95595),l=a(r(72424)),d=r(61671)},89532:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.sendAppStateSyncKeyRequest=function(){return h.apply(this,arguments)};var n=a(r(19976)),i=a(r(52954)),s=r(18238),o=r(95595),u=r(12425),l=a(r(27e3)),d=a(r(77865)),c=a(r(49213)),f=r(69551);function p(){var e=(0,n.default)(["syncd: send key request key id "," to peer deviceIds ",""]);return p=function(){return e},e}function h(){return(h=(0,i.default)((function*(e,t){var r={keyIds:e.map((e=>({keyId:e})))},a=t.map((e=>{var t=new d.default({fromMe:!0,remote:(0,o.assertGetMe)(),id:(0,c.default)()});return new l.default({id:t,to:e,type:"protocol",subtype:"app_state_sync_key_request",appStateSyncKeyRequest:r})})),n=t.map((e=>e.getDeviceId())),i=e.map((e=>(0,f.arrayBufferToHex)(e)));__LOG__(2)(p(),i,n),yield(0,u.storeMessages)(a),yield Promise.all(a.map(s.encryptAndSendKeyMsg))}))).apply(this,arguments)}},43526:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.sendAppStateSyncKeyShare=function(){return _.apply(this,arguments)};var n=a(r(19976)),i=a(r(52954)),s=r(18238),o=r(95595),u=r(12425),l=a(r(27e3)),d=a(r(77865)),c=a(r(49213)),f=r(61671),p=r(69551);function h(){var e=(0,n.default)(["syncd: send key share key id "," to peer deviceIds ",""]);return h=function(){return e},e}function _(){return(_=(0,i.default)((function*(e){var t,r;if("key_rotation"===e.type?(t=m(e.keys),r=yield(0,f.getPeerDevices)()):"missing_key"===e.type&&(t=m(e.keys,e.orphanKeys),r=[e.peerDeviceId]),null==r)return Promise.resolve();var a=r,n=a.map((e=>{var r=new d.default({fromMe:!0,remote:(0,o.assertGetMe)(),id:(0,c.default)()});return new l.default({id:r,to:e,type:"protocol",subtype:"app_state_sync_key_share",appStateSyncKeyShare:t})})),i=a.map((e=>e.getDeviceId())),_=e.keys.map((e=>(0,p.arrayBufferToHex)(e.keyId.buffer)));__LOG__(2)(h(),_,i),yield(0,u.storeMessages)(n),yield Promise.all(n.map(s.encryptAndSendKeyMsg))}))).apply(this,arguments)}function m(e,t){var r=e.map((e=>({keyId:{keyId:e.keyId.buffer},keyData:{keyData:e.keyData,fingerprint:{rawId:e.fingerprint.rawId,currentIndex:e.fingerprint.currentIndex,deviceIndexes:e.fingerprint.deviceIndexes},timestamp:e.timestamp}})));if(t){var a=t.map((e=>({keyId:{keyId:e},keyData:void 0})));r=r.concat(a)}return{keys:r}}},61671:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.getKeyDeviceId=function(e){return new DataView(e).getUint16(0)},t.getKeyEpoch=function(e){return new DataView(e).getUint32(2)},t.getPeerDevices=function(){return u.apply(this,arguments)};var n=a(r(52954)),i=r(77725),s=r(95595),o=r(75637);function u(){return(u=(0,n.default)((function*(){var e=[],t=(0,s.assertGetMe)().getDeviceId(),r=yield(0,i.getMyDeviceList)();return r.devices.forEach((a=>{a.id!==t&&e.push((0,o.createDeviceWidFromUserAndDevice)(r.id,a.id))})),e}))).apply(this,arguments)}},3204:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.buildSyncIqNode=function(){return A.apply(this,arguments)},t._generateMutationsToUpload=U;var n=a(r(52954)),i=a(r(829)),s=r(78851),o=r(60339),u=r(95988),l=a(r(57430)),d=a(r(82657)),c=r(57165),f=r(83549),p=r(3531),h=r(30691),_=r(22163),m=r(69551),g=r(18769),v=r(61671),E=a(r(72424)),y=a(r(70546)),S=r(63487),T=r(95595),b=a(r(76936));function A(){return(A=(0,n.default)((function*(e){var{collectionNodes:t,collectionWithEncryptedMutations:r,localCollectionVersions:a}=yield C(e);return{syncIqNode:(0,h.wap)("iq",{to:h.S_WHATSAPP_NET,xmlns:"w:sync:app:state",type:"set",id:(0,h.generateId)()},(0,h.wap)("sync",null,t)),collectionWithEncryptedMutations:r,localCollectionVersions:a}}))).apply(this,arguments)}function C(){return P.apply(this,arguments)}function P(){return(P=(0,n.default)((function*(e){var t=function(){var e=(0,n.default)((function*(e,t){var r,a,n=yield d.default.getCollectionVersion(e);if(null!=t&&t.length>0){var{patchNode:i,encryptedMutations:s}=yield O(e,t);r=i,a=s}return{collection:e,version:n,patchNode:r,encryptedMutations:a}}));return function(){return e.apply(this,arguments)}}(),r=new Map,a=new Map,i=[];return e.forEach(((e,r)=>i.push(t(r,e)))),{collectionNodes:(yield Promise.all(i)).map((e=>{var{collection:t,version:n,patchNode:i,encryptedMutations:s}=e;return s&&a.set(t,s),r.set(t,n),(0,h.wap)("collection",{name:(0,h.CUSTOM_STRING)(t),version:(0,h.INT)(null!=n?n:S.DEFAULT_COLLECTION_VERSION),return_snapshot:0===(null!=n?n:S.DEFAULT_COLLECTION_VERSION)?"true":"false"},i)})),collectionWithEncryptedMutations:a,localCollectionVersions:r}}))).apply(this,arguments)}function O(){return w.apply(this,arguments)}function w(){return(w=(0,n.default)((function*(e,t){var r,a=yield(0,_.getActiveKey)(!M(t)),i=(yield U(e,t,a)).map((e=>(0,c.encryptMutation)(e,a))),s=yield Promise.all(i),o=s.map((e=>({indexMac:e.indexMac,valueMac:e.valueMac,operation:e.operation}))),l=yield(0,u.computeLtHash)(e,o),{snapshotMac:d,patchMac:p}=yield(0,u.computeOutgoingSnapshotAndPatchMacs)(e,l,s,a.keyData),m=s.map((e=>k(e.keyId,e.operation,e.indexMac,e.indexAndValueCipherText))),g=L(m),v=function(){var e=(0,n.default)((function*(){var e=yield(0,f.uploadExternalPatch)(g);return D(yield I(e,g),a.keyId,d,p)}));return function(){return e.apply(this,arguments)}}();return(0,f.exceedInlineMutationCount)(m)?r=yield v():(r=N(m,a.keyId,d,p),(0,f.exceedPatchProtobufSize)(r)&&(r=yield v())),{patchNode:(0,h.wap)("patch",null,r),encryptedMutations:s}}))).apply(this,arguments)}function M(e){return b.default.isLogoutInProgress&&e.some((e=>JSON.parse(e.index)[0]===S.Actions.Sentinel))}function I(){return R.apply(this,arguments)}function R(){return(R=(0,n.default)((function*(e,t){var{mediaKey:r,directPath:a,encFilehash:n,handle:i}=e;if(!i)throw new Error("Missing handle after uploading external patch to mms4");var s=yield(0,l.default)(t);return{mediaKey:(0,o.decodeB64)(r),directPath:a,handle:i,fileSizeBytes:t.byteLength,fileSha256:(0,o.decodeB64)(s),fileEncSha256:(0,o.decodeB64)(n)}}))).apply(this,arguments)}function D(e,t,r,a){var n=E.default.syncdPatchDeviceIndexIncluded?(0,T.assertGetMe)().getDeviceId():void 0;return(0,s.encodeSyncdPatch)({keyId:{id:t},externalMutations:e,snapshotMac:r,patchMac:a,deviceIndex:n})}function N(e,t,r,a){var n=E.default.syncdPatchDeviceIndexIncluded?(0,T.assertGetMe)().getDeviceId():void 0;return(0,s.encodeSyncdPatch)({keyId:{id:t},mutations:e,snapshotMac:r,patchMac:a,deviceIndex:n})}function L(e){return(0,s.encodeSyncdMutations)({mutations:e})}function k(e,t,r,a){return{operation:t,record:{keyId:{id:e},index:{blob:r},value:{blob:a}}}}function U(){return F.apply(this,arguments)}function F(){return(F=(0,n.default)((function*(e,t,r){var a=yield d.default.getSyncActionsRows(["collection"],[e]),n=t,i=G(e,a,t,r.keyId),s=x(a,n=n.concat(i),r.keyId);return y.default.addKeyRotationRemoveCount(s.length),n=n.concat(s)}))).apply(this,arguments)}function G(e,t,r,a){var n=t.filter((e=>!r.map((e=>e.index)).includes(e.index)&&!(0,m.arrayBuffersAreEqual)(e.keyId,a)));n=(0,i.default)(n,(e=>(0,v.getKeyEpoch)(e.keyId)));var s=Math.min(5,Math.max(1,E.default.syncdAdditionalMutations));return n=n.slice(0,s),(0,g.syncActionsToPendingMutations)(n,p.SyncdMutationSyncdOperation.SET)}function x(e,t,r){var a=t.map((e=>e.index)),n=e.filter((e=>a.includes(e.index))).filter((e=>!(0,m.arrayBuffersAreEqual)(e.keyId,r)));return(0,g.syncActionsToPendingMutations)(n,p.SyncdMutationSyncdOperation.REMOVE)}},78851:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.encodeSyncdPatch=function(e){try{return(0,n.encodeProto)(o.SyncdPatchSpec,e).readBuffer()}catch(e){throw new s.default.MdFatalError({mdFatalErrorCode:s.default.MD_SYNCD_FATAL_ERROR_CODE.PATCH_PROTOBUF_SERIALIZATION_FAILED}).commit(),new i.SyncdFatalError("patch protobuf serialization failed")}},t.encodeSyncdMutations=function(e){try{return(0,n.encodeProto)(o.SyncdMutationsSpec,e).readBuffer()}catch(e){throw new s.default.MdFatalError({mdFatalErrorCode:s.default.MD_SYNCD_FATAL_ERROR_CODE.MUTATIONS_PROTOBUF_SERIALIZATION_FAILED}).commit(),new i.SyncdFatalError("mutations protobuf serialization failed")}},t.encodeSyncActionData=function(e){try{return(0,n.encodeProto)(u.SyncActionDataSpec,e).readBuffer()}catch(e){throw new s.default.MdFatalError({mdFatalErrorCode:s.default.MD_SYNCD_FATAL_ERROR_CODE.ACTION_DATA_PROTOBUF_SERIALIZATION_FAILED}).commit(),new i.SyncdFatalError("action data protobuf serialization failed")}};var n=r(68519),i=r(49859),s=a(r(40210)),o=r(3531),u=r(61239)},57165:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.encryptMutation=function(){return g.apply(this,arguments)};var n=a(r(70417)),i=a(r(52954)),s=r(78851),o=r(84139),u=r(82330),l=r(52056),d=a(r(82657)),c=r(49859),f=a(r(40210)),p=r(3531),h=r(61239),_=r(69551),m=r(22163);function g(){return(g=(0,i.default)((function*(e,t){var{index:r,operation:a}=e,i=t.keyId,s=t.keyData;switch(a){case p.SyncdMutationSyncdOperation.SET:break;case p.SyncdMutationSyncdOperation.REMOVE:var o=yield d.default.getSyncAction(r);if(!o)throw new c.SyncdFatalError("no corresponding set mutation");var u=o.keyId;i=u,s=yield(0,m.getKeyData)(u)}var{indexMac:f,indexAndValueCipherText:h}=yield v(e,i,s),_=(0,l.valueMacFromIndexAndValueCipherText)(h);return(0,n.default)((0,n.default)({},e),{},{keyId:i,keyData:s,indexMac:f,indexAndValueCipherText:h,valueMac:_})}))).apply(this,arguments)}function v(){return E.apply(this,arguments)}function E(){return(E=(0,i.default)((function*(e,t,r){try{var{index:a,binarySyncAction:n,operation:i,version:s}=e,o=(0,_.stringToArrayBuffer)(a),d=yield(0,l.generateEncryptionKeys)(r),{indexKey:p,valueEncryptionKey:h,valueMacKey:m}=d,g=yield self.crypto.getRandomValues(new Uint8Array(u.IV_LENGTH)),v=y(o,n,(0,l.generatePadding)(o.byteLength,n.byteLength),s),E=yield(0,l.generateCipherText)(g,h,v),S=(0,_.combine)([g.buffer,E]),T=(0,l.generateAssociatedData)(i,t),b=yield(0,l.generateMac)(T,S,m),A=(0,_.combine)([S,b]);return{indexMac:yield(0,l.generateIndexMac)(p,o),indexAndValueCipherText:A}}catch(e){throw new f.default.MdFatalError({mdFatalErrorCode:f.default.MD_SYNCD_FATAL_ERROR_CODE.ENCRYPTION_FAILED}).commit(),new c.SyncdFatalError("encryption failure")}}))).apply(this,arguments)}function y(e,t,r,a){return(0,s.encodeSyncActionData)({index:e,value:(0,o.decodeProto)(h.SyncActionValueSpec,t),padding:r,version:a})}},88021:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return u.apply(this,arguments)};var n=a(r(52954)),i=r(3204),s=a(r(82657)),o=r(66339);function u(){return(u=(0,n.default)((function*(e){var t=new Map,r=new Map;yield Promise.all(e.map(function(){var e=(0,n.default)((function*(e){var a=yield s.default.getPendingMutationsRows(["collection"],e),n=a.map((e=>e.id)).filter(Boolean);r.set(e,n);var i=(0,o.compactPatch)(a);t.set(e,i)}));return function(){return e.apply(this,arguments)}}()));var a=yield(0,i.buildSyncIqNode)(t);return{syncIqNode:a.syncIqNode,collectionWithPendingMutationsIds:r,collectionWithEncryptedMutations:a.collectionWithEncryptedMutations,localCollectionVersions:a.localCollectionVersions}}))).apply(this,arguments)}},83549:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.exceedInlineMutationCount=function(e){var t=Math.min(2e3,Math.max(s.default.syncdInlineMutationsMaxCount,100));return e.length>t},t.exceedPatchProtobufSize=function(e){var t=1e3*Math.min(100,Math.max(s.default.syncdPatchProtobufMaxSize,10));return e.byteLength>t},t.uploadExternalPatch=function(e){return o.default.encryptAndUpload({blob:e,signal:(new n.default).signal,type:"md-app-state",uploadOrigin:i.default.UPLOAD_ORIGIN_TYPE.UNKNOWN,userUploadAttemptCount:0,forwardedFromWeb:!1})};var n=a(r(12489)),i=a(r(40210)),s=a(r(72424)),o=a(r(52134))},18769:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.syncActionsToPendingMutations=function(e,t){return e.map((e=>({collection:e.collection,index:e.index,binarySyncAction:e.binarySyncAction,operation:t,version:e.version,timestamp:e.timestamp})))}},66339:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.compactPatch=function(e){return(0,n.default)(e.reverse(),(e=>e.index)).reverse()};var n=a(r(84636))},33512:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.syncResponseParser=void 0;var n=a(r(19976)),i=r(7150),s=r(63487),o=a(r(40210)),u=a(r(23767)),l=r(49859);function d(){var e=(0,n.default)(["syncd retryable error: collection "," throws ",""]);return d=function(){return e},e}function c(){var e=(0,n.default)(["syncd fatal error: collection "," throws ",""]);return c=function(){return e},e}function f(){var e=(0,n.default)(["syncd fatal error: collection "," throws ",""]);return f=function(){return e},e}function p(){var e=(0,n.default)(["syncd: successfully parsed collection ",""]);return p=function(){return e},e}function h(){var e=(0,n.default)(["syncd: start parsing syncd collections"]);return h=function(){return e},e}var _=new u.default("syncResponseParser",(e=>{__LOG__(2)(h());var t=[];return e.child("sync").mapChildrenWithTag("collection",(e=>{var r={},a=s.CollectionName.cast(e.attrString("name"));if(!a)throw new l.SyncdFatalError("invalid collection name");r.name=a,r.state=function(e,t){if(!e.hasAttr("type")||"error"!==e.attrString("type"))return e.hasAttr("has_more_patches")?s.CollectionState.SuccessHasMore:s.CollectionState.Success;var r=e.child("error"),a=r.attrString("code"),n=r.attrString("text");switch(a){case"409":return s.CollectionState.Conflict;case"400":return new o.default.MdFatalError({mdFatalErrorCode:o.default.MD_SYNCD_FATAL_ERROR_CODE.XMPP_BAD_REQUEST_FOR_COLLECTION}).commit(),__LOG__(4,void 0,new Error,!0)(f(),String(t),n),SEND_LOGS("syncd fatal error: collection ".concat(String(t)," throws ").concat(n)),s.CollectionState.ErrorFatal;case"404":return new o.default.MdFatalError({mdFatalErrorCode:o.default.MD_SYNCD_FATAL_ERROR_CODE.XMPP_NOT_FOUND_FOR_COLLECTION}).commit(),__LOG__(4,void 0,new Error,!0)(c(),String(t),n),SEND_LOGS("syncd fatal error: collection ".concat(String(t)," throws ").concat(n)),s.CollectionState.ErrorFatal;default:return __LOG__(3)(d(),String(t),n),s.CollectionState.ErrorRetry}}(e,r.name),e.hasAttr("version")&&(r.version=parseInt(e.attrString("version"),10)),e.hasChild("patches")&&(r.patches=e.child("patches").mapChildrenWithTag("patch",(e=>(0,i.decodeSyncdPatch)(e.contentBytes())))),e.hasChild("snapshot")&&(r.snapshot=(0,i.decodeExternalBlobReference)(e.child("snapshot").contentBytes())),t.push(r),__LOG__(2)(p(),a)})),t}));t.syncResponseParser=_},79593:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.serverSync=m;var n=a(r(19976)),i=a(r(52954)),s=a(r(13562)),o=r(54086),u=r(63487),l=r(49859),d=a(r(40210)),c=a(r(88021)),f=r(33512),p=a(r(70546));function h(){var e=(0,n.default)(["syncd retryable error: syncd global throws ",""]);return h=function(){return e},e}function _(){var e=(0,n.default)(["syncd fatal error: syncd global throws ",""]);return _=function(){return e},e}function m(){return g.apply(this,arguments)}function g(){return(g=(0,i.default)((function*(e){if(0===e.length)return Promise.resolve([]);try{var{collectionDetails:t,localCollectionVersions:r}=yield v(e),a=[],n=[];t.forEach((e=>{switch(e.state){case u.CollectionState.ErrorRetry:case u.CollectionState.ErrorFatal:case u.CollectionState.Blocked:return void n.push(e);default:a.push(e)}e.state===u.CollectionState.Conflict&&p.default.incConflict()}));var i=yield Promise.all(a.map((e=>(0,s.default)(e,r.get(e.name))))),o=[];return i.forEach((e=>{switch(e.state){case u.CollectionState.SuccessHasMore:case u.CollectionState.Conflict:return void o.push(e.name);default:n.push(e)}})),n.concat(yield m(o))}catch(t){return t instanceof l.SyncdFatalError?(__LOG__(4,void 0,new Error,!0)(_(),t.message),SEND_LOGS("syncd fatal error: syncd global throws ".concat(t.message)),e.map((e=>({state:u.CollectionState.ErrorFatal,name:e})))):(__LOG__(3,void 0,void 0,!0)(h(),t.message),SEND_LOGS("syncd retryable error: syncd global throws ".concat(t.message)),e.map((e=>({state:u.CollectionState.ErrorRetry,name:e,serverBackoff:t.errorBackoff}))))}}))).apply(this,arguments)}function v(){return E.apply(this,arguments)}function E(){return(E=(0,i.default)((function*(e){var{syncIqNode:t,collectionWithPendingMutationsIds:r,collectionWithEncryptedMutations:a,localCollectionVersions:n}=yield(0,c.default)(e),i=yield(0,o.sendIq)(t,f.syncResponseParser);if(i.success){var s=i.result;return s.forEach((e=>{var t=r.get(e.name);t&&(e.syncedPendingMutationsId=t);var n=a.get(e.name);n&&(e.syncedEncryptedMutations=n)})),{collectionDetails:s,localCollectionVersions:n}}var{errorCode:u,errorText:l,errorBackoff:d}=i;throw y(u,l,d)}))).apply(this,arguments)}function y(e,t,r){switch(e){case 400:return new d.default.MdFatalError({mdFatalErrorCode:d.default.MD_SYNCD_FATAL_ERROR_CODE.XMPP_BAD_REQUEST_GLOBAL_ERROR}).commit(),new l.SyncdFatalError(t);case 404:return new d.default.MdFatalError({mdFatalErrorCode:d.default.MD_SYNCD_FATAL_ERROR_CODE.XMPP_NOT_FOUND_GLOBAL_ERROR}).commit(),new l.SyncdFatalError(t);case 405:return new d.default.MdFatalError({mdFatalErrorCode:d.default.MD_SYNCD_FATAL_ERROR_CODE.XMPP_BAD_METHOD_GLOBAL_ERROR}).commit(),new l.SyncdFatalError(t);case 406:return new d.default.MdFatalError({mdFatalErrorCode:d.default.MD_SYNCD_FATAL_ERROR_CODE.XMPP_NOT_ACCEPTABLE_GLOBAL_ERROR}).commit(),new l.SyncdFatalError(t);default:return new l.SyncdRetryableError(t,r)}}},49859:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SyncdFatalError=t.SyncdRetryableError=t.SyncdMissingKeyError=void 0;class r extends Error{constructor(...e){super(...e),this.name="SyncdMissingKeyError"}}t.SyncdMissingKeyError=r;class a extends Error{constructor(e,t){super(e),this.name="SyncdRetryableError",this.backoff=t,this.message=e}}t.SyncdRetryableError=a;class n extends Error{constructor(e){super(e),this.name="SyncdFatalError",this.message=e}}t.SyncdFatalError=n},23398:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.updateSyncdDisabledDueToFatalFlag=b,t.isSyncdDisabled=function(){return"true"===(0,m.default)(f.default,"localStorage").getItem(u.default.KEY_SYNCD_DISABLED_DUE_TO_FATAL)},t.handleFatalError=function(e){var t=(0,d.getABPropConfigValue)("should_deregister_on_syncd_fatal"),a=r(57529).default;if(!1!==t)__LOG__(4,!0,new Error)(T()),g.default.logout();else if(a.isSyncDCriticalDataSyncInProcess())__LOG__(4,!0,new Error,!0)(S()),SEND_LOGS("critical sync failed during bootstrap"),g.default.logout();else{__LOG__(4,!0,new Error)(y()),b(!0),o.default.handleFatalError();var n=[];null!=e&&(n=e.map((e=>String(e)))),function(){A.apply(this,arguments)}(n)}};var n=a(r(19976)),i=a(r(52954)),s=r(75637),o=(r(63487),a(r(79711))),u=a(r(50935)),l=r(18238),d=r(97148),c=r(95595),f=a(r(80521)),p=a(r(27e3)),h=a(r(77865)),_=a(r(49213)),m=a(r(61941)),g=a(r(12767)),v=r(12425),E=r(71684);function y(){var e=(0,n.default)(["[syncd] Received fatal error and showed fatal flag"]);return y=function(){return e},e}function S(){var e=(0,n.default)(["critical sync failed during bootstrap"]);return S=function(){return e},e}function T(){var e=(0,n.default)(["[syncd] Received fatal error and logged out"]);return T=function(){return e},e}function b(e){(0,m.default)(f.default,"localStorage").setItem(u.default.KEY_SYNCD_DISABLED_DUE_TO_FATAL,e.toString())}function A(){return(A=(0,i.default)((function*(e){var t={collectionNames:e,timestamp:(0,E.unixTimeMs)()},r=new h.default({fromMe:!0,remote:(0,c.getMeUser)(),id:(0,_.default)()}),a=new p.default({id:r,to:(0,s.createDeviceWidFromUserAndDevice)((0,c.assertGetMe)().user,0),type:"protocol",subtype:"app_state_fatal_exception_notification",appStateFatalExceptionNotification:t});return yield(0,v.storeMessages)([a]),(0,l.encryptAndSendKeyMsg)(a)}))).apply(this,arguments)}},62147:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.checkOrphanMutations=function(){return l.apply(this,arguments)},t.checkOrphanMessages=d,t.checkOrphanChats=f,t.applyAllOrphansAndUnsupported=function(){return m.apply(this,arguments)};var n=a(r(52954)),i=r(13562),s=r(23398),o=r(63487),u=a(r(82657));function l(){return(l=(0,n.default)((function*(e,t){if((0,s.isSyncdDisabled)())return Promise.resolve();yield Promise.all([d(e),f(t)])}))).apply(this,arguments)}function d(){return c.apply(this,arguments)}function c(){return(c=(0,n.default)((function*(e){yield h(e,o.SyncModelType.Msg)}))).apply(this,arguments)}function f(){return p.apply(this,arguments)}function p(){return(p=(0,n.default)((function*(e){yield h(e,o.SyncModelType.Chat)}))).apply(this,arguments)}function h(){return _.apply(this,arguments)}function _(){return(_=(0,n.default)((function*(e,t){if((0,s.isSyncdDisabled)())return Promise.resolve();var r=yield u.default.getSyncActionsRows(["modelId","modelType","actionState"],e.map((e=>[e,t,o.SyncActionState.Orphan])));yield(0,i.applyIndividualMutations)(r)}))).apply(this,arguments)}function m(){return(m=(0,n.default)((function*(){if((0,s.isSyncdDisabled)())return Promise.resolve();var e=yield u.default.getSyncActionsRows(["actionState"],[o.SyncActionState.Orphan,o.SyncActionState.Unsupported]);yield(0,i.applyIndividualMutations)(e)}))).apply(this,arguments)}},21601:(e,t,r)=>{"use strict";var a=r(14859);t.Z=function(){return l.apply(this,arguments)};var n=a(r(52954)),i=a(r(13584)),s=r(61392),o=r(63487),u=a(r(82657));function l(){return(l=(0,n.default)((function*(){var e=yield i.default.getSentinelMutations();return yield u.default.appendPendingMutationsRows(e),(0,s.markCollectionsForSync)([...o.CollectionName.members()])}))).apply(this,arguments)}},61392:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.initialize=function(){if(u.default.supportsFeature(u.default.F.MD_BACKEND))return(0,v.isSyncdDisabled)()?Promise.resolve():(e=6e4,t=(0,o.default)((0,s.default)((function*(){var e=yield(0,y.getSyncActionsTable)().count();S.default.setStoredMutationCount(e);var t=yield(0,y.getSyncActionsTable)().equals(["actionState"],d.SyncActionState.Malformed);S.default.setInvalidActionCount(t.length);var r=yield(0,y.getSyncActionsTable)().equals(["actionState"],d.SyncActionState.Unsupported);S.default.setUnsupportedActionCount(r.length);var a=yield c.default.getMissingKeyCount();S.default.setMissingKeyCount(a)})),e,{maxWait:3*e}),E.default.on(E.APP_STATE_SYNC_COMPLETED,t),l.default.loadStatesFromDb().then((()=>Y())));var e,t;return Promise.reject(new Error("This call is only supported in MD mode"))},t.markCollectionsForSync=F,t.syncBlockedCollections=function(){var e=l.default.getCollectionsInStateBlocked();return l.default.moveCollectionsToDirty(e),R=new Set([...R,...I]),G()},t.lockForSync=function(e,t,r){var a=(0,h.getStorage)().lock([...e,...O],(e=>Promise.all([c.default.appendPendingMutationsRows(t),r(e)]))).then((()=>{F(t.map((e=>e.collection)))}));return Promise.resolve(a)},t.SYNCD_INTERNAL_TABLES_TO_LOCK=void 0;var i=n(r(19976)),s=n(r(52954)),o=n(r(54073)),u=n(r(18120)),l=n(r(98852)),d=r(63487),c=n(r(82657)),f=n(r(40210)),p=r(79593),h=r(77993),_=n(r(17744)),m=r(11824),g=r(62147),v=r(23398),E=a(r(79711)),y=r(11008),S=n(r(70546));function T(){var e=(0,i.default)(["syncd: server sync successful"]);return T=function(){return e},e}function b(){var e=(0,i.default)(["syncd: initiate server sync"]);return b=function(){return e},e}function A(){var e=(0,i.default)(["syncd fatal error: expired collections"]);return A=function(){return e},e}function C(){var e=(0,i.default)(["syncd: server sync retry successful"]);return C=function(){return e},e}function P(){var e=(0,i.default)(["syncd: initiate server sync retry"]);return P=function(){return e},e}var O=["pending-mutations"];t.SYNCD_INTERNAL_TABLES_TO_LOCK=O;var w,M=36e5,I=new Set,R=new Set,D=!1,N=0,L=0;if((0,m.isConnectedToPage)()){var k=r(17026).default,U=r(17026).StreamMode;(0,_.default)(k,"change:mode",(()=>k.mode===U.MAIN)).then((()=>{u.default.supportsFeature(u.default.F.MD_BACKEND)&&!(0,v.isSyncdDisabled)()&&((0,g.applyAllOrphansAndUnsupported)(),function(){j.apply(this,arguments)}())}))}function F(e){return u.default.supportsFeature(u.default.F.MD_BACKEND)?(e.forEach((e=>{var t=l.default.getCollectionState(e);t===d.CollectionSyncState.UpToDate?l.default.moveCollectionsToDirty([e]):t===d.CollectionSyncState.Dirty&&(R=new Set([...R,e]))})),G()):Promise.reject(new Error("This call is only supported in MD mode"))}function G(){return x.apply(this,arguments)}function x(){return(x=(0,s.default)((function*(){if((0,v.isSyncdDisabled)())return Promise.resolve();var e=l.default.getCollectionsInStateDirty(),t=new Set(e.filter((e=>!I.has(e))));if(0===t.size)return Promise.resolve();var r=[];try{I=new Set([...I,...t]),__LOG__(2)(b()),r=yield(0,p.serverSync)([...t]),__LOG__(2)(T());var a=r.filter((e=>e.state===d.CollectionState.ErrorRetry));a.length>0&&(L=a[0].serverBackoff||0,N=0),K(r)}catch(e){l.default.moveCollectionsToFiniteRetry([...t])}finally{l.default.persistToDb(),I=new Set([...I].filter((e=>!t.has(e)))),Y(),E.default.trigger(E.APP_STATE_SYNC_COMPLETED,r)}}))).apply(this,arguments)}function B(){if(!(0,v.isSyncdDisabled)()){var e,t,r,a=new Set(l.default.getCollectionsInStateRetry());if(0!==a.size)w=setTimeout((0,s.default)((function*(){try{D=!0,N+=1,__LOG__(2)(P());var e=yield(0,p.serverSync)([...a]);__LOG__(2)(C()),K(e)}catch(e){l.default.moveCollectionsToFiniteRetry([...a])}finally{(t=l.default.getExpiredCollections()).length>0&&(l.default.moveCollectionsToFatal(t),__LOG__(4,void 0,new Error,!0)(A()),SEND_LOGS("syncd fatal error: expired collections"),new f.default.MdFatalError({mdFatalErrorCode:f.default.MD_SYNCD_FATAL_ERROR_CODE.TOO_MANY_INTERNAL_SERVER_ERRORS_IN_7D}).commit()),l.default.persistToDb(),D=!1,Y()}var t})),(e=N,t=L,r=1e3*Math.pow(2,e),Math.min(Math.max(r,t),M)))}}function Y(){if(l.default.getCollectionsInStateDirty().length>0&&(R=new Set([...R].filter((e=>I.has(e)))),G()),l.default.getCollectionsInStateRetry().length>0){if(D)return;null!=w&&clearTimeout(w),B()}l.default.getCollectionsInStateFatal().length>0&&(0,v.handleFatalError)(l.default.getCollectionsInStateFatal())}function K(e){return e.forEach((e=>e.state!==d.CollectionState.Success||R.has(e.name)?e.state===d.CollectionState.ErrorRetry?l.default.moveCollectionsToFiniteRetry([e.name]):e.state===d.CollectionState.ErrorFatal?l.default.moveCollectionsToFatal([e.name]):e.state!==d.CollectionState.Blocked||R.has(e.name)?void 0:l.default.moveCollectionsToBlocked([e.name]):l.default.moveCollectionsToUpToDate([e.name])))}function j(){return(j=(0,s.default)((function*(){var e=yield c.default.getAllPendingMutationsRows(),t=l.default.getCollectionsInStateBlocked();l.default.moveCollectionsToDirty(t);var r=e.map((e=>e.collection)).concat(t);r.length>0&&F(r)}))).apply(this,arguments)}},16054:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.constructStarMsgKey=function(e){return JSON.stringify([a.Actions.Star,...n(e)])},t.constructMsgKeySegments=n,t.extractParticipantForSync=i,t.constructPinChatKey=function(e){return JSON.stringify([a.Actions.Pin,e.id.remote.toString({legacy:!0})])},t.constructMuteChatKey=function(e){return JSON.stringify([a.Actions.Mute,e.id.remote.toString({legacy:!0})])},t.isBootstrap=function(e){return null==e};var a=r(63487);function n(e){var t=i(e);return[e.id.remote.toString({legacy:!0}),e.id.id,e.id.fromMe?"1":"0",t]}function i(e){var t="0";return!e.id.participant||e.id.remote.isUser()||e.id.fromMe||(t=e.id.participant.toString({legacy:!0})),t}},70546:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(39329),i=a(r(79711)),s=a(r(40210)),o=new s.default.MdAppStateSyncDaily,u=new n.ShiftTimer((function(){var e=function(e){var t=new s.default.MdAppStateSyncDaily;e.mutationCount>0&&(t.mutationCount=e.mutationCount);e.invalidActionCount>0&&(t.invalidActionCount=e.invalidActionCount);e.unsupportedActionCount>0&&(t.unsupportedActionCount=e.unsupportedActionCount);e.keyRotationRemoveCount>0&&(t.keyRotationRemoveCount=e.keyRotationRemoveCount);e.storedMutationCount>0&&(t.storedMutationCount=e.storedMutationCount);e.uploadConflictCount>0&&(t.uploadConflictCount=e.uploadConflictCount);e.unsetActionCount>0&&(t.unsetActionCount=e.unsetActionCount);e.missingKeyCount>0&&(t.missingKeyCount=e.missingKeyCount);return t}(o);l(),e.commit()}));function l(){o=new s.default.MdAppStateSyncDaily}function d(){u.onOrBefore(3e5)}i.default.on("logout",(()=>{u.isScheduled()&&u.forceRunNow()}));var c={clear:l,addMutationCount:function(e){0!==e&&(void 0===o.mutationCount&&(o.mutationCount=0),o.mutationCount+=e,d())},setInvalidActionCount:function(e){o.invalidActionCount=e,d()},setUnsupportedActionCount:function(e){o.unsupportedActionCount=e,d()},incConflict:function(){void 0===o.uploadConflictCount&&(o.uploadConflictCount=0),o.uploadConflictCount++,d()},addKeyRotationRemoveCount:function(e){0!==e&&(void 0===o.keyRotationRemoveCount&&(o.keyRotationRemoveCount=0),o.keyRotationRemoveCount+=e,d())},setStoredMutationCount:function(e){o.storedMutationCount=e,d()},addUnsetActionCount:function(e){0!==e&&(void 0===o.unsetActionCount&&(o.unsetActionCount=0),o.unsetActionCount+=e,d())},setMissingKeyCount:function(e){o.missingKeyCount=e,d()}};t.default=c},58678:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.registerTasks=function(){i.default.supportsFeature(i.default.F.MD_BACKEND)&&((0,c.startScheduler)({scheduledTimeResolver:{get:e=>(0,d.getTaskScheduledTime)(String(e)),set:(e,t)=>(0,d.updateTaskScheduledTime)(String(e),t)}}),v.forEach((e=>{var t=function(e){switch(e){case g.SYNC_AB_PROPS:return e=>(e?Promise.resolve():(0,o.syncABPropsTask)()).then((()=>(0,l.getRefresh)()));case g.SYNC_CONTACTS:return e=>(e?Promise.resolve():(0,u.getNonAddressBookContactsAndMarkAllContactsDirty)().catch((e=>{__LOG__(4,!0,new Error)(m(),e)})).then((()=>(0,s.contactSync)())).catch((e=>{__LOG__(4,!0,new Error,!0)(_()),SEND_LOGS("contact sync failed: "+e)}))).then((()=>86400));case g.ROTATE_KEY:return e=>{var t;return e?(__LOG__(2)(h()),t=Promise.resolve()):t=(0,p.newJob)("rotateKey").waitUntilCompleted(),t.then((()=>27*f.DAY_SECONDS))}}}(e);(0,c.registerTask)(e,t)})))};var n=a(r(19976)),i=a(r(18120)),s=r(82945),o=r(87078),u=r(57869),l=r(15971),d=r(88581),c=r(27538),f=r(71684),p=r(10902);function h(){var e=(0,n.default)(["RotateKeyTask skip first run"]);return h=function(){return e},e}function _(){var e=(0,n.default)(["contact sync failed"]);return _=function(){return e},e}function m(){var e=(0,n.default)(["Failed to sync non-address book contacts with error: ",""]);return m=function(){return e},e}var g=r(28103)({SYNC_AB_PROPS:"syncAbProps",SYNC_CONTACTS:"syncContacts",ROTATE_KEY:"rotateKey"}),v=[g.SYNC_AB_PROPS,g.SYNC_CONTACTS,g.ROTATE_KEY]},52098:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DebugMessage=void 0;var a=r(28103).Mirrored([]);t.DebugMessage=a},56004:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.businessParser=function(e){e.assertTag("business");var t=e.maybeChild("error");if(t)return{errorCode:t.attrInt("code"),errorText:t.attrString("text")};var r=e.maybeChild("verified_name");return{verifiedName:r?(0,i.default)(r):null}},t.default=void 0;var n=r(30691),i=a(r(8318));t.default=class{getQueryElement(){return(0,n.wap)("business",null,(0,n.wap)("verified_name",null))}getUserElement(){return null}}},60589:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.contactParser=function(e){e.assertTag("contact");var t=e.maybeChild("error");if(t)return{errorCode:t.attrInt("code"),errorText:t.attrString("text")};return{type:e.attrString("type")}},t.default=void 0;var a=r(30691);t.default=class{getQueryElement(){return(0,a.wap)("contact",null)}getUserElement(e){var t=e.getPhone();return t?(0,a.wap)("contact",null,t):null}}},36509:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.deviceParser=function(e){e.assertTag("devices");var t=e.maybeChild("error");if(t)return{errorCode:t.attrInt("code"),errorText:t.attrString("text")};var r=e.maybeChild("key-index-list"),a=e.maybeChild("device-list"),n=null==r?null:{ts:r.attrTime("ts"),signedKeyIndexBytes:r.contentBytes()};return{deviceList:null==a?void 0:a.mapChildrenWithTag("device",(e=>({id:e.attrInt("id"),keyIndex:e.hasAttr("key-index")?e.attrInt("key-index"):null}))),keyIndex:n}},t.default=void 0;var a=r(30691);t.default=class{getQueryElement(){return(0,a.wap)("devices",{version:(0,a.CUSTOM_STRING)(String(2))})}getUserElement(e){var t=e.getDeviceHash();return t?(0,a.wap)("devices",{device_hash:(0,a.CUSTOM_STRING)(t)}):null}}},54058:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.featureParser=function(e){e.assertTag("feature");var t=e.maybeChild("error");if(t)return{errorCode:t.attrInt("code"),errorText:t.attrString("text")};var r={};return Object.keys(n).forEach((t=>{var a=e.maybeChild(t);a&&(r[t]=a.attrString("value"))})),r},t.default=void 0;var a=r(30691),n={document:(0,a.wap)("document",null),encrypt:(0,a.wap)("encrypt",null),encrypt_blist:(0,a.wap)("encrypt_blist",null),encrypt_contact:(0,a.wap)("encrypt_contact",null),encrypt_group_gen2:(0,a.wap)("encrypt_group_gen2",null),encrypt_image:(0,a.wap)("encrypt_image",null),encrypt_location:(0,a.wap)("encrypt_location",null),encrypt_url:(0,a.wap)("encrypt_url",null),encrypt_v2:(0,a.wap)("encrypt_v2",null),voip:(0,a.wap)("voip",null),multi_agent:(0,a.wap)("multi_agent",null)};t.default=class{constructor(e){if(this.queries=e,0===e.length)throw new Error("must specify at least one query")}getQueryElement(){return(0,a.wap)("feature",null,this.queries&&this.queries.map((e=>n[e])))}getUserElement(){return null}}},93116:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.USyncQuery=t.USYNC_SUPPORT_TYPE=void 0;var i=n(r(19976)),s=r(30691),o=a(r(56004)),u=r(54086),l=a(r(60589)),d=a(r(36509)),c=a(r(54058)),f=n(r(23767)),p=a(r(92655)),h=a(r(79142)),_=r(95778);function m(){var e=(0,i.default)(["Usync success: ",""]);return m=function(){return e},e}function g(){var e=(0,i.default)(["Usync warning: a usync query must have at least one user"]);return g=function(){return e},e}function v(){var e=(0,i.default)(["usync query success!"]);return v=function(){return e},e}var E={FEATURE:"feature",DEVICE:"devices",CONTACT:"contact",PICTURE:"picture",STATUS:"status",BUSINESS:"business"};t.USYNC_SUPPORT_TYPE=E;var y={feature:c.featureParser,devices:d.deviceParser,contact:l.contactParser,picture:p.pictureParser,status:h.statusParser,business:o.businessParser};function S(e){var t=[];return e.forEachChildWithTag("user",(e=>{var r={};e.hasAttr("jid")&&(Object.keys(E).forEach((t=>{var a=E[t],n=e.maybeChild(a);n&&y[a]&&(r[a]=y[a](n))})),r.id=e.attrUserWid("jid"),t.push(r))})),t}var T=new f.default("usyncParser",(e=>{e.assertAttr("type","result");var t={error:{},refresh:{},list:[],sideList:[]},r=e.child("usync"),a=r.child("result"),n=r.child("list"),i=r.maybeChild("side_list");return Object.keys(E).forEach((e=>{var r=E[e],n=a.maybeChild(r);if(n){var i=n.maybeChild("error");i?t.error[r]={errorCode:i.attrInt("code"),errorText:i.attrString("text"),errorBackoff:i.attrInt("backoff")}:n.hasAttr("refresh")&&(t.refresh[r]=n.attrInt("refresh",0))}})),t.list=S(n),i&&(t.sideList=S(i)),__LOG__(2)(v()),t}));t.USyncQuery=class{constructor(){this.context="interactive",this.mode="query",this.protocols=[],this.users=[]}withMode(e){return this.mode=e,this}withContext(e){return this.context=e,this}withContactProtocol(){return this.protocols.push(new l.default),this}withBusinessProtocol(){return this.protocols.push(new o.default),this}withDeviceProtocol(){return this.protocols.push(new d.default),this}withPictureProtocol(){return this.protocols.push(new p.default),this}withStatusProtocol(){return this.protocols.push(new h.default),this}withFeaturesProtocol(e){return this.protocols.push(new c.default(e)),this}withUser(e){return this.users.push(e),this}_buildStanza(){if(0===this.protocols.length)throw new Error("a usync query must have at least one protocol");0===this.users.length&&__LOG__(3)(g()),this.users.map((e=>e.validate()));var e=(0,s.wap)("query",null,this.protocols.map((e=>e.getQueryElement()))),t=this.users.map((e=>{var t=e.getId();return(0,s.wap)("user",{jid:t?(0,_.USER_JID)(t):s.DROP_ATTR},this.protocols.map((t=>t.getUserElement(e))))})),r=(0,s.wap)("list",null,t);return(0,s.wap)("iq",{to:s.S_WHATSAPP_NET,xmlns:"usync",type:"get",id:(0,s.generateId)()},(0,s.wap)("usync",{sid:(0,s.generateId)(),index:"0",last:"true",mode:(0,s.CUSTOM_STRING)(this.mode),context:(0,s.CUSTOM_STRING)(this.context)},e,r))}execute(){var e=this._buildStanza();return(0,u.sendIq)(e,T).then((e=>e.success?(__LOG__(2)(m(),JSON.stringify(e.result)),e.result):{error:{all:{errorCode:e.errorCode,errorText:e.errorText,errorType:e.errorType}},refresh:{},list:[]}))}}},92655:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.pictureParser=function(e){e.assertTag("picture");var t=e.maybeChild("error");if(t)return{errorCode:t.attrInt("code"),errorText:t.attrString("text")};return{id:e.attrInt("id")}},t.default=void 0;var a=r(30691);t.default=class{getQueryElement(){return(0,a.wap)("picture",null)}getUserElement(){return null}}},79142:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.statusParser=function(e){e.assertTag("status");var t=e.maybeChild("error");if(t)return{errorCode:t.attrInt("code"),errorText:t.attrString("text")};return e.hasContent()?e.contentString():null},t.default=void 0;var a=r(30691);t.default=class{getQueryElement(){return(0,a.wap)("status",null)}getUserElement(){return null}}},26085:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.USyncUser=void 0;t.USyncUser=class{withId(e){return this._id=e,this}withDeviceHash(e){return this._deviceHash=e,this}withPhone(e){return this._phone=e,this}getDeviceHash(){return this._deviceHash}getPhone(){return this._phone}getId(){return this._id}validate(){if(null==this._id&&null==this._phone)throw new Error("user must have an id or a phone")}}},73631:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(46378);class n{static tag(e){return e&&e[0]}static attr(e,t){return t&&t[1]?t[1][e]:void 0}static attrs(e){return e[1]}static child(e,t){var r=t[2];if(Array.isArray(r))for(var a=r.length,n=0;n<a;n++){var i=r[n];if(Array.isArray(i)&&i[0]===e)return i}}static firstChild(e){var t=e[2];if(Array.isArray(t))return t[0]}static children(e,t){if(!t)return e&&e[2];var r=e[2];return Array.isArray(r)?r.filter((e=>e[0]===t)):void 0}static dataStr(e){if(!e)return"";var t=e[2];return"string"==typeof t?t:t instanceof ArrayBuffer?new a.Binary(t).readString(t.byteLength):""}static toString(e,t){if(!e)return"undefined";var r=function(e,t){if(e){var r="";for(var a in e){r+=" "+a+"="+("string"==typeof e[a]?t?"...":'"'+e[a]+'"':e[a])}return r}return""}(e[1],t),a=function(e,t){if(e instanceof ArrayBuffer)return"<<bin:"+e.byteLength+">>";if("string"==typeof e)return t?"<<string:"+e.length+">>":e;if(Array.isArray(e))return e.map((e=>n.toString(e,t))).join("\n");return""}(e[2],t);return"<"+e[0]+r+(a?">\n"+a+"\n</"+e[0]+">":"/>")}}t.default=n},19741:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EphemeralDrop=t.LogoutDrop=t.Server5xxDrop=t.ConventionViolationDrop=t.BrowserReplacedDrop=t.WebdDrop=t.E499=t.E404=t.E401=t.CatalogEditServerError=t.ServerStatusCodeError=void 0;var a=r(29351);class n extends((0,a.customError)("ServerStatusCodeError")){constructor(e,t){super(t),this.status=e,this.statusCode=e}}t.ServerStatusCodeError=n;class i extends((0,a.customError)("ServerStatusCodeError")){constructor(e,t,r){super(r),this.errors=t,this.status=e,this.statusCode=e}}t.CatalogEditServerError=i;class s extends((0,a.customError)("E401",!0,n)){constructor(e){super(401,e)}}t.E401=s;class o extends((0,a.customError)("E404",!0,n)){constructor(e){super(404,e)}}t.E404=o;class u extends((0,a.customError)("E499",!0,n)){constructor(e){super(499,e)}}t.E499=u;class l extends((0,a.customError)("WebdDrop")){}t.WebdDrop=l;class d extends((0,a.customError)("BrowserReplacedDrop",!0,l)){}t.BrowserReplacedDrop=d;class c extends((0,a.customError)("ConventionViolationDrop",!0,l)){}t.ConventionViolationDrop=c;class f extends((0,a.customError)("Server5xxDrop",!0,l)){}t.Server5xxDrop=f;class p extends((0,a.customError)("LogoutDrop",!0,l)){}t.LogoutDrop=p;class h extends((0,a.customError)("EphemeralDrop",!0,l)){}t.EphemeralDrop=h},14472:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(21617),n={voipIndividualOutgoing:a.WebFeaturesFlag.FORCE_UPGRADE,groupsV3:a.WebFeaturesFlag.FORCE_UPGRADE,groupsV3Create:a.WebFeaturesFlag.DEVELOPMENT,changeNumberV2:a.WebFeaturesFlag.FORCE_UPGRADE,queryStatusV3Thumbnail:a.WebFeaturesFlag.DEVELOPMENT,liveLocations:a.WebFeaturesFlag.FORCE_UPGRADE,queryVname:a.WebFeaturesFlag.FORCE_UPGRADE,voipIndividualIncoming:a.WebFeaturesFlag.FORCE_UPGRADE,quickRepliesQuery:a.WebFeaturesFlag.FORCE_UPGRADE,payments:a.WebFeaturesFlag.FORCE_UPGRADE,labelsDisplay:a.WebFeaturesFlag.FORCE_UPGRADE,labelsEdit:a.WebFeaturesFlag.FORCE_UPGRADE,stickerPackQuery:a.WebFeaturesFlag.FORCE_UPGRADE,liveLocationsFinal:a.WebFeaturesFlag.FORCE_UPGRADE,mediaUpload:a.WebFeaturesFlag.FORCE_UPGRADE,vnameV2:a.WebFeaturesFlag.FORCE_UPGRADE,videoPlaybackUrl:a.WebFeaturesFlag.FORCE_UPGRADE,statusRanking:a.WebFeaturesFlag.FORCE_UPGRADE,voipIndividualVideo:a.WebFeaturesFlag.DEVELOPMENT,thirdPartyStickers:a.WebFeaturesFlag.FORCE_UPGRADE,frequentlyForwardedSetting:a.WebFeaturesFlag.FORCE_UPGRADE,recentStickers:a.WebFeaturesFlag.FORCE_UPGRADE,recentStickersV2:a.WebFeaturesFlag.PRODUCTION,recentStickersV3:a.WebFeaturesFlag.PRODUCTION,groupsV4JoinPermission:a.WebFeaturesFlag.FORCE_UPGRADE,catalog:a.WebFeaturesFlag.FORCE_UPGRADE,starredStickers:a.WebFeaturesFlag.PRODUCTION,templateMessage:a.WebFeaturesFlag.PRODUCTION,templateMessageInteractivity:a.WebFeaturesFlag.DEVELOPMENT,ephemeralMessages:a.WebFeaturesFlag.PRODUCTION,e2ENotificationSync:a.WebFeaturesFlag.FORCE_UPGRADE,syncdRelease1:a.WebFeaturesFlag.PRODUCTION,userNotice:a.WebFeaturesFlag.PRODUCTION,syncdRelease11:a.WebFeaturesFlag.PRODUCTION,support:a.WebFeaturesFlag.PRODUCTION,groupUiiCleanup:a.WebFeaturesFlag.FORCE_UPGRADE,groupDogfoodingInternalOnly:a.WebFeaturesFlag.DEVELOPMENT,settingsSync:a.WebFeaturesFlag.PRODUCTION,ephemeralAllowGroupMembers:a.WebFeaturesFlag.PRODUCTION,ephemeral24HDuration:a.WebFeaturesFlag.DEVELOPMENT,archiveV2:a.WebFeaturesFlag.PRODUCTION,mdForceUpgrade:a.WebFeaturesFlag.FORCE_UPGRADE};t.default=n},76022:(e,t,r)=>{"use strict";var a=r(93291);Object.defineProperty(t,"__esModule",{value:!0});var n={};Object.defineProperty(t,"default",{enumerable:!0,get:function(){return i.default}});var i=a(r(91560));Object.keys(i).forEach((function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(n,e)||Object.defineProperty(t,e,{enumerable:!0,get:function(){return i[e]}}))}))},80737:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,r=n.default.isWid,a=i.createWid){var s=t;switch(e){case"author":case"broadcast":case"chat":case"descOwner":case"from":case"gid":case"id":case"jid":case"owner":case"participant":case"quotedRemoteJid":case"quotedParticipant":case"remote":case"subjectOwner":case"s_o":case"to":case"wid":case"changeNumberNewJid":case"changeNumberOldJid":case"recipient":r(t)&&(s=a(t));break;default:var o=parseInt(e,10);!isNaN(o)&&r(t)&&(s=a(t))}return s};var n=a(r(68384)),i=r(75637)},36927:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loadProtoVersions=function(){return(0,a.requireLoadProtoVersions)().then((e=>{Object.assign(n,e)}))},t.default=void 0;var a=r(63925),n={};var i=n;t.default=i},5642:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(57370)),i=r(46378),s={NEW:"REQUEST_STATE_NEW",SENT:"REQUEST_STATE_SENT",WEBDACKED:"REQUEST_STATE_WEBDACKED",WILL_RETRY:"REQUEST_STATE_WILL_RETRY"};class o{constructor(e){this.state=s.NEW,this.age=0,this.resends=0;var t=e.data;this.data=t,this.isToPhone=t instanceof ArrayBuffer,this.tag=e.tag,this.clientCacheable=!!e.clientCacheable,this.serverCacheable=!!e.serverCacheable,this.retryOn5xx=!!e.retryOn5xx,this.onSend=e.onSend,this.logOnSend=e.logOnSend,this.onDrop=e.onDrop,this.binaryOpts=e.binaryOpts,this.on5xx=e.on5xx,this.resendGuard=e.resendGuard,this.onTag=e.onTag,this.tagToCancel=e.tagToCancel,this.ephemeral=!!e.ephemeral,this.ignore=!!e.ignore,this.isCallOffer=!!e.isCallOffer,this.isWap4Bridge=!!e.isWap4Bridge}getTag(){return this.tag||(this.onSend?this.onSend.tag:void 0)}getName(){return this.binaryOpts&&this.binaryOpts.metricName?this.binaryOpts.metricName.toLowerCase():"".concat(this.data[0],"_").concat((0,n.default)(this.data[1]))}toString(){var e=this.data;return this.binaryOpts?this.binaryOpts.debugString:Array.isArray(e)?0===e.length?"[]":1===e.length?"[".concat(e[0],"]"):"query"===e[0]||"action"===e[0]?"[".concat(e[0],", ").concat(e[1]).concat(e.length>2?", ...":"","]"):"Invalid request: ".concat(e[0]):e instanceof Object?"{...}":"".concat(String(e))}serialize(){var e=this.tag;if(this.binaryOpts){var t=this.binaryOpts,r=null!=t.metric?t.metric:0,a=(this.ignore?0:1)<<7|(!this.ignore&&t.ackRequest?1:0)<<6|(!0===t.available?1:0)<<5|(!1===t.available?1:0)<<4|(null!=t.expires&&0!==t.expires?1:0)<<3|(t.skipOffline?1:0)<<2;return i.Binary.build(e,",",r,a,this.data).readBuffer()}var n="string"==typeof this.data?this.data:JSON.stringify(this.data);return"".concat(String(e),",,").concat(String(n))}}t.default=o,o.STATE=s},5361:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.base64DecodeRecursively=function e(t){var r=t[2];Array.isArray(r)&&r.forEach((t=>{t&&(t[2]instanceof ArrayBuffer||"string"==typeof t[2]?t[2]=(0,u.decodeB64ToJsArray)(t[2]):t[2]&&e(t))}))},t.default=void 0;var n=a(r(19976)),i=a(r(13888)),s=r(84139),o=r(68519),u=r(60339),l=a(r(7470)),d=r(28703),c=r(95595),f=a(r(73631)),p=r(31558),h=r(5029);function _(){var e=(0,n.default)(["voip_signaling:enc node not present"]);return _=function(){return e},e}function m(){var e=(0,n.default)(["voip_signaling:invalid serializedMessage"]);return m=function(){return e},e}function g(){var e=(0,n.default)(["voip_signaling:invalid messageProto.call"]);return g=function(){return e},e}function v(){var e=(0,n.default)(["Error parsing voip signaling message"]);return v=function(){return e},e}var E={formatCallOffer:function(e,t,r){var a,n,i=r.payload,s={to:r.common.peer_jid,id:t,from:(0,c.getMaybeMeUser)().toString({legacy:!0})},u=i[2];return u.forEach(((e,t)=>{switch(e[0]){case"enc":var s={call:{callKey:new Uint8Array(e[2])}},u={},l=i[1].retry_count;l&&(u.count=l);var c=["call",u,(0,h.cdataArrayBuffer)((0,o.encodeProto)(d.MessageSpec,s))];a=c,n=t;break;default:(0,h.arrayToB64Recursively)(r.payload,!0)}})),u.splice(n,1),u.push(a),i[2]=u,e.actionNode("relay",[["call",s,[i]]])},parseCallSignalingMsg:function(e){try{var t=l.default.get(e.from),r={peer_jid:e.from.toString({legacy:!0}),isContact:t&&t.isMyContact},a=["wrapper",{},e.data];switch(e.type){case"offer":var n=y("offer",a);r.peer_platform=e.platform,e.version&&e.version.length&&(r.peer_version=e.version.join(".")),this.parseCallOffer(n,r,!1);break;case"accept":var i=y("accept",a);r.type=p.TYPE.ACCEPT,r.call_id=f.default.attr("call-id",i)||"",r.peer_platform=e.platform,e.version&&e.version.length&&(r.peer_version=e.version.join("."));break;case"receipt":var s=e.data;switch(r.call_id=f.default.attr("call-id",s)||"",f.default.tag(s)){case"offer":r.type=p.TYPE.OFFER_RECEIPT;break;case"accept":r.type=p.TYPE.ACCEPT_RECEIPT;break;case"reject":default:return}break;case"terminate":var o=y("terminate",a);r.call_id=f.default.attr("call-id",o)||"",r.type=p.TYPE.TERMINATE;break;default:var u=function(e){var t=f.default.firstChild(e);if(!t)throw new Error("voip_signaling:Failed to get first child node");return t}(a);r.call_id=f.default.attr("call-id",u)}return r&&r.call_id&&this.createCommonHeader(r),r}catch(e){return void __LOG__(3)(v())}},parseCallOffer:function(e,t,r){if(t.type=p.TYPE.OFFER,t.call_id=f.default.attr("call-id",e)||"",r){var a=y("call",e),n=f.default.children(a);if(n instanceof ArrayBuffer){var i=(0,s.decodeProto)(d.MessageSpec,n);i.call&&i.call.callKey?this.receiveCallOfferKey(i.call.callKey,t):__LOG__(3)(g())}else __LOG__(3)(m())}else t.enc=this.parseRawE2EMaterial(e);var o=f.default.children(e,"video");t.video_count=Array.isArray(o)?o.length:void 0,t.isVideoCall=!!t.video_count,t.isGroupCall_DEPRECATED=!!t.group_info;var u=f.default.attr("t",e);u&&(t.t=u)},parseRawE2EMaterial:function(e){var t=f.default.child("enc",e);if(t)return(0,u.decodeB64ToJsArray)(f.default.dataStr(t));__LOG__(3)(_())},receiveCallOfferKey:function(e,t){t&&(t[2]=Array.prototype.slice.call(new Uint8Array(e)))},createCommonHeader(e){e.common=(0,i.default)(e,["type","call_id","peer_jid"])}};function y(e,t){var r=f.default.child(e,t);if(!r)throw new Error("voip_signaling:Failed to get child node ".concat(e));return r}t.default=E},5029:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formatCallSignalingMsg=function(e,t){var r,a=t.common.peer_jid;s(t.payload,!1);var n=t.payload;return["call",{from:null===(r=(0,i.getMaybeMeUser)())||void 0===r?void 0:r.toString({legacy:!0}),to:a,id:e},[n]]},t.arrayToB64Recursively=s,t.cdataArrayBuffer=o,t.cdataB64=u;var a=r(46378),n=r(60339),i=r(95595);function s(e,t){var r=e[2];Array.isArray(r)&&r.forEach((e=>{e&&(e[2]instanceof Array&&!(e[2][0]instanceof Array)?e[2]=t?o(new Uint8Array(e[2])):u(new Uint8Array(e[2])):e[2]&&s(e,t))}))}function o(e){return e instanceof Uint8Array?e.buffer:e instanceof ArrayBuffer?e:e instanceof a.Binary?e.readBuffer():void 0}function u(e){return e instanceof Uint8Array||e instanceof ArrayBuffer?(0,n.encodeB64)(e):e instanceof a.Binary?(0,n.encodeB64)(e.readBuffer()):void 0}},91560:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.Wap=void 0;var i,s,o=n(r(70417)),u=n(r(19976)),l=r(30691),d=r(78692),c=r(84139),f=r(46378),p=r(60339),h=r(9729),_=a(r(72434)),m=r(28703),g=r(19741),v=a(r(96452)),E=n(r(14472)),y=a(r(18120)),S=a(r(55273)),T=n(r(36398)),b=n(r(61941)),A=r(82296),C=n(r(36927)),P=n(r(53827)),O=n(r(49213)),w=a(r(8292)),M=n(r(72424)),I=r(11419),R=r(5029),D=r(21617),N=n(r(68384)),L=r(75637),k=n(r(12767));function U(){var e=(0,u.default)(["Assertion failed!"]);return U=function(){return e},e}function F(){var e=(0,u.default)(["wap:queryMediaConnections mediaConn.hosts.length ",""]);return F=function(){return e},e}function G(){var e=(0,u.default)(["wap:queryMediaConnections mediaConn.hosts isArray ",""]);return G=function(){return e},e}function x(){var e=(0,u.default)(["wap:queryMediaConnections mediaConn.hosts exists ",""]);return x=function(){return e},e}function B(){var e=(0,u.default)(["wap:queryMediaConnections mediaConn.ttl exists ",""]);return B=function(){return e},e}function Y(){var e=(0,u.default)(["wap:queryMediaConnections mediaConn.auth exists ",""]);return Y=function(){return e},e}function K(){var e=(0,u.default)(["wap:queryMediaConnections mediaConn exists ",""]);return K=function(){return e},e}function j(){var e=(0,u.default)(["queryMediaConnections result: ",""]);return j=function(){return e},e}function W(){var e=(0,u.default)(["wap:unsetVersion, which should only happen when logout"]);return W=function(){return e},e}function V(){var e=(0,u.default)(["wap:features:unknown: ",": ",""]);return V=function(){return e},e}function H(){var e=(0,u.default)(["wap:features:"," phone value is "," and web value is ",". updating..."]);return H=function(){return e},e}function q(){var e=(0,u.default)(["wap:setVersion unknown version. attempting to update"]);return q=function(){return e},e}function z(){var e=(0,u.default)(["wap:setVersion deprecated version: ",""]);return z=function(){return e},e}function J(){var e=(0,u.default)(["wap:setVersion "," set: ",""]);return J=function(){return e},e}function Q(){var e=(0,u.default)(["Wap:saveSharedSecret done"]);return Q=function(){return e},e}function X(){var e=(0,u.default)(["Wap:saveSharedSecret hmac mismatch "," ",""]);return X=function(){return e},e}function Z(){var e=(0,u.default)(["Wap:saveSharedSecret start"]);return Z=function(){return e},e}function $(e){return function(){if(!i)return Promise.reject(new v.ProtoVersionUndefined("wap:".concat(e,":not connected to phone yet")));var t=i[e];return t?t.apply(i,arguments):Promise.reject("wap:".concat(e,":unsupported"))}}var ee=$("sendPresenceUpdate"),te=$("sendChatstateUpdate");class re{constructor(){this.setSharedSecret=(0,d.wrapSyncPromise)((function(e){__LOG__(2)(Z());var t=(0,b.default)((0,p.decodeB64ToJsArray)(e),"decodeB64ToJsArray(payload)"),r=t.slice(0,32),a=t.slice(64),n=w.get().keyPair,i=(0,b.default)(n,"keyPair").privKey;return _.sharedSecret(r,i).then((e=>S.extractAndExpand(e,"",80))).then((e=>{var n=new Uint8Array(e,0,32),i=new Uint8Array(e,32,32),s=new Uint8Array(e,64,16),o=new Uint8Array(r.concat(a));return new T.default(i).sign(o).then((e=>{var r=(0,p.encodeB64)(e),i=(0,p.encodeB64)(t.slice(32,64));if(i===r){var o=f.Binary.build(s,new Uint8Array(a)).readByteArray();return(0,h.aesCbcDecrypt)(n,o).then((e=>{var t=new Uint8Array(e,0,32),r=new Uint8Array(e,32,32);w.setSecretKeys("0.1",t,r),__LOG__(2)(Q())}))}__LOG__(3)(X(),i,r)}))}))})),this.findGroupPendingInvitesFromPhone=$("findGroupPendingInvitesFromPhone"),this.acceptGroupV4Invite=$("acceptGroupV4Invite"),this.revokeGroupV4Invite=$("revokeGroupV4Invite"),this.addContact=$("addContact"),this.groupMetadataFindFromPhone=$("groupMetadataFindFromPhone"),this.resyncMessages=$("resyncMessages"),this.resyncReceipts=$("resyncReceipts"),this.queryReceivedActions=$("queryReceivedActions"),this.addParticipants=$("addParticipants"),this.changeSubject=$("changeSubject"),this.createGroup=$("createGroup"),this.leaveGroup=$("leaveGroup"),this.removeParticipants=$("removeParticipants"),this.promoteParticipants=$("promoteParticipants"),this.demoteParticipants=$("demoteParticipants"),this.setGroupDescription=$("setGroupDescription"),this.setGroupProperty=$("setGroupProperty"),this.setGroupEphemeralDuration=$("setGroupEphemeralDuration"),this.requestMediaReupload=$("requestMediaReupload"),this.sendMedia=$("sendMedia"),this.mediaUpload=$("mediaUpload"),this.sendConversationSeen=$("sendConversationSeen"),this.sendConversationUnseen=$("sendConversationUnseen"),this.sendConversationClear=$("sendConversationClear"),this.sendConversationDelete=$("sendConversationDelete"),this.sendConversationArchive=$("sendConversationArchive"),this.sendConversationMute=$("sendConversationMute"),this.sendConversationNotSpam=$("sendConversationNotSpam"),this.sendConversationPin=$("sendConversationPin"),this.sendConversationDismissChangeNumber=$("sendConversationDismissChangeNumber"),this.sendMessagePlayed=$("sendMessagePlayed"),this.sendMessageDelete=$("sendMessageDelete"),this.sendMessageStarred=$("sendMessageStarred"),this.sendUnstarAll=$("sendUnstarAll"),this.sendSetPicture=$("sendSetPicture"),this.deletePicture=$("deletePicture"),this.sendSetStatus=$("sendSetStatus"),this.setPushname=$("setPushname"),this.statusQuery=$("statusQuery"),this.sendStatusSeen=$("sendStatusSeen"),this.statusQueryThumbnail=$("statusQueryThumbnail"),this.sendSetBlock=$("sendSetBlock"),this.sendSpamReport=$("sendSpamReport"),this.chatFindQuery=$("chatFindQuery"),this.contactFindQuery=$("contactFindQuery"),this.queryIdentity=$("queryIdentity"),this.queryVname=$("queryVname"),this.msgCreateRecord=$("msgCreateRecord"),this.msgFindQuery=$("msgFindQuery"),this.queryLinkPreview=$("queryLinkPreview"),this.queryVcard=$("queryVcard"),this.queryMsgInfo=$("queryMsgInfo"),this.recentEmojiQuery=$("recentEmojiQuery"),this.clearBPQueue=$("clearBPQueue"),this.parseWebMessageInfo=$("parseWebMessageInfo"),this.subscribeLiveLocation=$("subscribeLiveLocation"),this.unsubscribeLiveLocation=$("unsubscribeLiveLocation"),this.queryActiveLiveLocation=$("queryActiveLiveLocation"),this.disableLiveLocation=$("disableLiveLocation"),this.findGroupPendingInvitesFromPhone=$("findGroupPendingInvitesFromPhone"),this.acceptGroupV4Invite=$("acceptGroupV4Invite"),this.revokeGroupV4Invite=$("revokeGroupV4Invite"),this.sendCallOffer=$("sendCallOffer"),this.queryCall=$("queryCall"),this.sendCallEnd=$("sendCallEnd"),this.queryLabels=$("queryLabels"),this.queryNextLabelColor=$("queryNextLabelColor"),this.queryLabelPalette=$("queryLabelPalette"),this.addOrRemoveLabels=$("addOrRemoveLabels"),this.deleteLabel=$("deleteLabel"),this.createLabel=$("createLabel"),this.editLabel=$("editLabel"),this.queryQuickReplies=$("queryQuickReplies"),this.flushQuickReplyCounts=$("flushQuickReplyCounts"),this.queryStickerPacks=$("queryStickerPacks"),this.queryStickersInStickerPack=$("queryStickersInStickerPack"),this.queryRecentStickers=$("queryRecentStickers"),this.queryStarredStickers=$("queryStarredStickers"),this.queryVideoPlaybackUrl=$("queryVideoPlaybackUrl"),this.queryNoticeState=$("queryNoticeState"),this.querySettings=$("querySettings"),this.setArchiveSetting=$("setArchiveSetting")}isInitialized(){return!!s}setVersion(e,t,r){var a=e[0],n=e[1],u=[a,n,t,r].join("."),l=s!==u;if(__LOG__(2)(J(),u,String(l)),l){var d=i;switch(a){case 0:switch(n){case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 11:case 12:case 13:case 14:case 15:case 16:throw __LOG__(3)(z(),u),new v.DeprecatedProtocolVersion("wap_deprecated_version");case 17:(i=(0,o.default)({},C.default[n])).setSubProtocol(t);break;default:i=void 0}}if(!i)throw __LOG__(3)(q()),new v.UpdateImmediately("wap_unknown_version");s=u,i.supportsFeatureFlags&&this.processFeatureFlags(r),d&&i&&i.upgradeProtoVersion(d)}}processFeatureFlags(e){if(e){var t=(0,b.default)(i,"protoVersion"),r=t.implementedFeatures||{},a=(0,c.decodeProtoWithUnknowns)(D.WebFeaturesSpec,(0,p.decodeB64)(e)),n=(0,c.getUnknownFields)(a);for(var s in delete a.unsafeUnknownFields,r)y.default.setFeatureFromFlags(s,D.WebFeaturesFlag.FORCE_UPGRADE,D.WebFeaturesFlag.FORCE_UPGRADE);var o=Object.keys(D.WebFeaturesSpec.internalSpec),u=Object.keys(a);for(var l in o.forEach((e=>{var t=(0,y.getProtobufFeatureName)(e);!u.includes(e)&&y.default.supportsFeature(t)&&y.default.setFeature(t,!1)})),a)if(!r[l]){var d=a[l],f=E.default[l];if(d===D.WebFeaturesFlag.FORCE_UPGRADE&&f!==D.WebFeaturesFlag.FORCE_UPGRADE)throw __LOG__(3)(H(),l,d,f),new v.UpdateImmediately("wap_feature_force_upgrade");if(y.default.setFeatureFromFlags(l,f,d),y.default.supportsFeatureFromFlags(l)){var h=C.default.features[l];h&&Object.assign(t,h)}}for(var _ in n){var m=n[_];if("number"==typeof m&&D.WebFeaturesFlag.cast(m)===D.WebFeaturesFlag.FORCE_UPGRADE)throw __LOG__(3)(V(),_,m),new v.UpdateImmediately("wap_feature_implemented_unknown")}}}delete(){var e=i?i.delete.apply(i,arguments):void 0;return i=void 0,s=void 0,__LOG__(2)(W()),e}cannotReachPhone(){i&&i.cannotReachPhone.apply(i,arguments)}handle(e,t,r,a){return(0,b.default)(i,"protoVersion").handle.apply(i,[e,t,r,a])}queryServerProps(){return k.default.sendEphemeral2({data:["query","props"],retryOn5xx:!1})}resyncPictures(e){var t=e.filter((e=>N.default.isWid(e.id)));return 0===t.length?Promise.resolve([]):k.default.sendEphemeral2({data:["query","resumePic",t],retryOn5xx:!0})}setRememberMe(e){return k.default.sendBasic({data:["admin","remember",!!e]})}queryMediaConnections(e){var t=new Date,r=k.default.send2({data:["query","mediaConn"]}).then((e=>{if(__LOG__(2,!0)(j(),JSON.stringify(e)),200!==e.status){if(e.status>=400)throw new g.ServerStatusCodeError(e.status,"queryMediaConnections");throw new g.ServerStatusCodeError(e.status,"Invalid return status")}var{media_conn:r}=e;if(!(r&&r.auth&&r.ttl&&r.hosts&&Array.isArray(r.hosts)&&0!==r.hosts.length))throw __LOG__(2)(K(),String(!!r)),r&&(__LOG__(2)(Y(),String(!!r.auth)),__LOG__(2)(B(),String(!!r.ttl)),__LOG__(2)(x(),String(!!r.hosts)),__LOG__(2)(G(),String(Array.isArray(r.hosts))),r.hosts&&__LOG__(2)(F(),r.hosts.length)),__LOG__(4,void 0,new Error,!0)(U()),SEND_LOGS("wap:queryMediaConnections unexpected mediaConn"),new Error("Invalid mediaConn");var{auth:a,auth_ttl:n,ttl:i,max_buckets:s}=r;return{auth:a,authTTL:n,hosts:r.hosts.map((e=>{var t,r=null===(t=e.rules)||void 0===t?void 0:t.map((e=>e.download_buckets?{downloadBuckets:e.download_buckets}:e));return(0,o.default)((0,o.default)({},e),{},{rules:r})})),queryStartTime:t,ttl:i,maxBuckets:s}}));return(0,P.default)(r,e)}acceptGroupInvite(e){return k.default.send2({data:["action","invite",e],retryOn5xx:!0})}revokeGroupInvite(e){return k.default.send2({data:["action","inviteReset",e],retryOn5xx:!0})}contactFindBroadcast(e){return k.default.send2({data:["query","contact",e],retryOn5xx:!0})}commonGroupsFind(e){return N.default.isServer(e)?Promise.resolve({status:200,groups:[]}):k.default.send2({data:["query","group","common",e]})}getCapabilities(e){return k.default.send2({data:["query","caps",e.filter(N.default.isUser)],retryOn5xx:!0})}queryExist(e){return N.default.isUser(e)?k.default.send2({data:["query","exist",e],retryOn5xx:!0}):Promise.resolve({status:400})}queryCtwaContext(e,t,r){var a={accountNumber:(0,L.createWid)(e).toString({legacy:!0}),code:t,expectedSourceUrl:r,id:(0,l.generateId)()};return k.default.send2({data:["query","ctwa",a],retryOn5xx:!0}).then((e=>{var t,a,n,i;if(200!==e.status)throw new g.ServerStatusCodeError(e.status,"queryCtwaContext:fail ".concat(e.status));var s={sourceId:e.data.source.id,sourceType:e.data.source.type,sourceUrl:e.data.source.url,description:e.data.body,title:e.data.headline,mediaType:(null===(t=e.data.video)||void 0===t?void 0:t.url)?m.ExternalAdReplyInfoMediaType.VIDEO:m.ExternalAdReplyInfoMediaType.IMAGE,isSuspiciousLink:e.data.source.url!==r,thumbnailUrl:null===(a=e.data.thumbnail)||void 0===a?void 0:a.url,mediaUrl:null===(n=e.data.video)||void 0===n?void 0:n.url};return(null===(i=e.data.thumbnail)||void 0===i?void 0:i.bytes)&&(s.thumbnail=e.data.thumbnail.bytes),s}))}queryBusinessProfile(e,t){return k.default.send2({data:["query","businessProfile",e.filter((e=>N.default.isUser(e.wid))),t],retryOn5xx:!0}).then((e=>{switch(e.status){case 200:return e.profiles;default:throw new Error("queryBusinessProfile:fail ".concat(e," ").concat(e.status))}}))}queryBusinessCategories(e){var t={id:(0,l.generateId)(),query:e};return k.default.send2({data:["query","businessCategories",t],retryOn5xx:!0}).then((e=>{switch(e.status){case 200:var t=e.data.not_a_biz[0],r=e.data.categories.reduce(((e,r)=>(r.id!==t.id&&e.push({id:r.id,localized_display_name:r.name}),e)),[]);return r.unshift({id:t.id,localized_display_name:t.name,not_a_biz:!0}),r;default:throw new Error("queryBusinessCategories:fail ".concat(e," ").concat(e.status))}}))}queryOrder(e,t,r,a){var n={id:(0,l.generateId)(),orderId:e,imageWidth:t.toString(),imageHeight:r.toString(),token:a};return k.default.send2({data:["query","order",n],retryOn5xx:!0}).then((e=>{switch(e.status){case 200:var{data:t}=e;try{var{currency:r,subtotal:a,total:n,tax:i}=t.price;return{currency:r,createdAt:parseInt(t.creationTS,10),products:t.products.map((e=>{var t,r;return{id:e.id,price:e.price,thumbnailId:null===(t=e.image)||void 0===t?void 0:t.id,thumbnailUrl:null===(r=e.image)||void 0===r?void 0:r.url,currency:e.currency,name:e.name,quantity:parseInt(e.quantity||0,10)}})),subtotal:a,total:n,tax:i}}catch(t){throw new g.ServerStatusCodeError(e.status,"queryOrder:response malformed ".concat(e.status))}case 404:throw new g.E404;default:throw new g.ServerStatusCodeError(e.status,"queryOrder:fail ".concat(e.status))}}))}createOrder(e,t){var r={product:t.map((e=>({id:e.id,name:e.name,quantity:(0,I.isNumber)(e.quantity)?e.quantity.toString():void 0,price:(0,I.isNumber)(e.priceAmount1000)?e.priceAmount1000.toString():void 0,currency:e.currency}))),bizJID:e,id:(0,l.generateId)()};return k.default.send2({data:["action","createOrder",r],retryOn5xx:!0}).then((e=>{if(200===e.status)return e.data;throw new g.ServerStatusCodeError(e.status,"createOrder:fail wap action return status: ".concat(e.status))}))}refreshCart(e,t,r,a){var n=t.map((e=>({id:e}))),i={id:(0,l.generateId)(),products:n,bizJID:N.default.user(e),imageDimensions:{width:r.toString(),height:a.toString()}};return k.default.send2({data:["action","refreshOrder",i],retryOn5xx:!0}).then((e=>{if(200===e.status)return e.data;throw new g.ServerStatusCodeError(e.status,"refreshCart:fail wap action return status: ".concat(e.status))}))}queryProductCatalog(e,t,r,a,n){var i={catalogWid:e,afterCursor:t,limit:r,width:a,height:n,type:M.default.webCatalogApiREH?"get_product_catalog_reh":"get_product_catalog",stanza_id:(0,l.generateId)()};return k.default.send2({data:["query","bizCatalog",i],retryOn5xx:!0}).then((e=>{switch(e.status){case 200:return"string"==typeof e.data||e.data instanceof String?JSON.parse(e.data):e.data;default:throw new g.ServerStatusCodeError(e.status,"queryProductCatalog:fail ".concat(e.status))}}))}queryProductList(e,t,r,a){var n={catalogWid:e,product_ids:t,width:""+r,height:""+a,stanza_id:(0,l.generateId)()};return k.default.send2({data:["action","getProductList",n],retryOn5xx:!0}).then((e=>{switch(e.status){case 200:return e.data.data;default:throw new g.ServerStatusCodeError(e.status,"queryProductList:fail ".concat(e.status))}}))}queryProduct(e,t,r,a){var n={catalogWid:e,productID:t,width:r,height:a,type:M.default.webCatalogApiREH?"get_product_reh":"get_product",stanza_id:(0,l.generateId)()};return k.default.send2({data:["query","bizCatalog",n],retryOn5xx:!0}).then((e=>{switch(e.status){case 200:return{data:"string"==typeof e.data||e.data instanceof String?JSON.parse(e.data):e.data.product};default:throw new g.ServerStatusCodeError(e.status,"queryProduct:fail ".concat(e.status))}}))}reportBusinessCatalogProduct(e,t,r){var a={id:t,jid:e.toString(),reason:r,stanza_id:(0,l.generateId)()};return k.default.send2({data:["action",M.default.webCatalogApiREH?"reportProduct_reh":"reportProduct",a],retryOn5xx:!0}).then((e=>{if(200!==e.status)throw new g.ServerStatusCodeError(e.status,"reportBusinessCatalogProduct:fail ".concat(e.status))}))}deleteBusinessCatalogProduct(e){var t=M.default.webCatalogApiREH?["action","deleteProduct_reh",{product_ids:e,stanza_id:(0,l.generateId)()}]:["action","deleteProduct",e];return k.default.send2({data:t,retryOn5xx:!0}).then((e=>{if(200!==e.status)throw new g.ServerStatusCodeError(e.status,"deleteBusinessCatalogProduct:fail ".concat(e.status));return{deletedCount:e.deletedCount}}))}createBusinessCatalog(){var e=M.default.webCatalogApiREH?["action","createCatalog_reh",{stanza_id:(0,l.generateId)()}]:["action","createCatalog"];return k.default.send2({data:e,retryOn5xx:!0}).then((e=>{if(200!==e.status)throw new g.ServerStatusCodeError(e.status,"createBusinessCatalog:fail ".concat(e.status))}))}editBusinessCatalogProduct(e,t,r){var a={product_id:e.id,name:e.name,image_url:e.imageCdnUrl,url:e.url,additional_image_urls:e.additionalImageCdnUrl,width:t.toString(),height:r.toString(),stanza_id:(0,l.generateId)(),is_hidden:e.isHidden};return"number"==typeof e.priceAmount1000&&(a.price=(e.priceAmount1000/10).toString(),e.currency&&(a.currency=e.currency)),e.description&&(a.description=e.description),e.retailerId&&(a.retailer_id=e.retailerId),k.default.send2({data:["action",M.default.webCatalogApiREH?"editProduct_reh":"editProduct",a],retryOn5xx:!0}).then((e=>{if(200===e.status)return e.data.product;var t;throw new g.CatalogEditServerError(e.status,(0,A.parseLegacyProductErrorReason)(null==e||null===(t=e.data)||void 0===t?void 0:t.reason))}))}addBusinessCatalogProduct(e,t,r){var a={name:e.name,description:e.description||"",image_url:e.imageCdnUrl,url:e.url||"",additional_image_urls:e.additionalImageCdnUrl,retailer_id:e.retailerId||"",width:t.toString(),height:r.toString(),stanza_id:(0,l.generateId)(),is_hidden:e.isHidden};return"number"==typeof e.priceAmount1000&&(a.price=(e.priceAmount1000/10).toString(),e.currency&&(a.currency=e.currency)),k.default.send2({data:["action",M.default.webCatalogApiREH?"addProduct_reh":"addProduct",a],retryOn5xx:!0}).then((e=>{if(200===e.status)return e.data.product;var t;throw new g.CatalogEditServerError(e.status,(0,A.parseLegacyProductErrorReason)(null==e||null===(t=e.data)||void 0===t?void 0:t.reason))}))}productVisibilitySet(e){var t={product_visibility:e.map((e=>[e.productId,e.isHidden])),stanza_id:(0,l.generateId)()};return k.default.send2({data:["action","productVisibilitySet",t],retryOn5xx:!0}).then((e=>{if(200!==e.status)throw new g.ServerStatusCodeError(e.status,"productVisibilitySet:fail ".concat(e.status))}))}appealCatalogProduct(e,t){var r={id:e,reason:t,stanza_id:(0,l.generateId)()};return k.default.send2({data:["action",M.default.webCatalogApiREH?"appealProduct_reh":"appealProduct",r],retryOn5xx:!0}).then((e=>{if(200===e.status)return!0;throw new g.ServerStatusCodeError(e.status,"appealCatalogProduct:fail ".concat(e.status))}))}groupV4InviteRequestMetadataFind(e,t,r,a,n){return k.default.send2({data:["query","InvitedGroupMetadata",{from:e,admin:t,code:r,expiration:a,gid:n}],retryOn5xx:!1})}groupV4InviteGrpPicThumb(e,t,r,a){return k.default.send2({data:["query","AddRequestGrpProfilePicThumb",{admin:e,code:t,expiration:r,gid:a}],retryOn5xx:!0})}groupMetadataFind(e){return k.default.send2({data:["query","GroupMetadata",e],retryOn5xx:!0}).then((e=>e.status&&e.status>=400?Promise.reject(new g.ServerStatusCodeError(e.status)):e))}groupInviteInfo(e){return k.default.send2({data:["query","invite",e],retryOn5xx:!0})}groupInviteCode(e){return k.default.send2({data:["query","inviteCode",e],retryOn5xx:!0})}profilePicFind(e){return N.default.isServer(e)?Promise.resolve({status:400}):k.default.sendEphemeral2({data:["query","ProfilePicThumb",e],retryOn5xx:!0})}profilePicFindThumbFromPhone(){return i?i.profilePicFindThumbFromPhone.apply(i,arguments):Promise.reject(new v.ProtoVersionUndefined("wap:profilePicFindThumbFromPhone:not connected to phone"))}statusFind(e){return N.default.isServer(e)?Promise.resolve({status:""}):k.default.sendEphemeral2({data:["query","Status",e],retryOn5xx:!0})}sendPing(){return k.default.send2({data:["admin","test"],retryOn5xx:!0})}sendPresenceAvailable(){return ee("available")}sendPresenceUnavailable(){return ee("unavailable")}sendChatstateComposing(e){return te("composing",e)}sendChatstatePaused(e){return te("paused",e)}sendChatstateRecording(e){return te("recording",e)}subscribePresence(e){return k.default.send2({data:["action","presence","subscribe",e],retryOn5xx:!0})}downloadImage(){return Promise.reject("Image download is not yet implemented")}logoutToken(){var{encKey:e,macKey:t}=w.get();return new T.default((0,b.default)(t,"macKey")).sign(new Uint8Array((0,b.default)(e,"encKey"))).then(p.encodeB64)}sendGroupCallOffer(e){return this.sendCallSignalingMsg(e)}sendCallSignalingMsg(e,t){var r=t||(0,O.default)(),a=(0,R.formatCallSignalingMsg)(r,e);return a?k.default.send2({tag:r,data:["action","call",a],retryOn5xx:!0}).then((e=>e)):Promise.reject("unknown call signaling msg type")}}t.Wap=re;var ae=new re;t.default=ae},59998:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.queryBusinessProfile=function(e){var t,r=(0,n.getBusinessProfileQueryVersion)();i.default.supportsFeature(i.default.F.MD_BACKEND)?(t=(0,o.default)(e,r))||(t=Promise.reject(new Error("Should not reach here"))):t=s.default.queryBusinessProfile(e,r);return t};var n=r(69452),i=a(r(18120)),s=a(r(76022)),o=a(r(46618))},45618:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.queryBusinessCategories=function(e){var t;if(!n.default.supportsFeature(n.default.F.MD_BACKEND))return i.default.queryBusinessCategories(e);(t=(0,s.queryBusinessCategories)(e))||(t=Promise.reject(new Error("BusinessCategory MD query not yet implemented")));return t};var n=a(r(18120)),i=a(r(76022)),s=r(12714)},69452:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.getBusinessProfileQueryVersion=function(){return 119&n.default.webBizProfileOptions};var n=a(r(72424))},61727:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.sendChatStatePaused=function(e){return i.default.supportsFeature(i.default.F.MD_BACKEND)?((0,o.default)(e,"paused"),Promise.resolve()):s.default.sendChatstatePaused(e).then((e=>{if(200!==e.status)throw new n.ServerStatusCodeError(e.status)}))},t.sendChatStateRecording=function(e){return i.default.supportsFeature(i.default.F.MD_BACKEND)?((0,o.default)(e,"recording"),Promise.resolve()):s.default.sendChatstateRecording(e).then((e=>{if(200!==e.status)throw new n.ServerStatusCodeError(e.status)}))},t.sendChatStateComposing=function(e){return i.default.supportsFeature(i.default.F.MD_BACKEND)?((0,o.default)(e,"composing"),Promise.resolve()):s.default.sendChatstateComposing(e).then((e=>{if(200!==e.status)throw new n.ServerStatusCodeError(e.status)}))};var n=r(19741),i=a(r(18120)),s=a(r(76022)),o=a(r(83847))},16059:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.sendClear=function(e,t,a){var c;s.default.supportsFeature(s.default.F.MD_BACKEND)?(c=Promise.all([Promise.resolve().then(r.bind(r,54212)),Promise.resolve().then(r.bind(r,20987))]).then((([{lockForMessageRangeSync:t},{default:r}])=>{var i=(0,u.unixTimeMs)();return r.getClearChatMutation(i,e.id,!a).then(function(){var r=(0,n.default)((function*(r){return yield t(["message"],[r],(0,n.default)((function*(){yield(0,l.addActiveMessageRange)(e.id.toString(),"clearChat",r.binarySyncAction),yield(0,d.default)(e.id)}))),{_duplicate:null}}));return function(){return r.apply(this,arguments)}}())})))||(c=Promise.reject(new Error("md:sendClear: should not reach here"))):c=o.default.sendConversationClear(e.id,t,!a).then((e=>{if(200!==e.status)throw new i.ServerStatusCodeError(e.status);return e}));return c};var n=a(r(52954)),i=r(19741),s=a(r(18120)),o=a(r(76022)),u=r(71684),l=r(16976),d=a(r(29146))},15790:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.createLocal=function(e,t){if(s.default.supportsFeature(s.default.F.MD_BACKEND))return(0,o.getTable)().create((0,i.default)({id:e.toString()},t)).catch((e=>{if(e instanceof u.DbOnLogoutAbort)throw e;throw __LOG__(4,!0,new Error,!0)(l()),SEND_LOGS("update chat table failed when create local"),new Error("update chat table failed")}));return Promise.resolve()};var n=a(r(19976)),i=a(r(70417)),s=a(r(18120)),o=r(35855),u=r(96452);function l(){var e=(0,n.default)(["update chat table failed"]);return l=function(){return e},e}},12392:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.find=function(e,t){var r=performance.now();return u.default.chatFindQuery(e,(e=>{t.binarySize=e.binarySize})).then((function(e){return"preempted"!==e&&(t.timing=Math.ceil(performance.now()-r),t.size=e.length,o.default.supportsFeature(o.default.F.MD_BACKEND))?(0,d.getTable)().bulkCreateOrMerge(e.map((e=>(0,s.default)((0,s.default)({},e),{},{id:e.id.toString()})))).then((()=>e)).catch((()=>{throw __LOG__(4,!0,new Error,!0)(c()),SEND_LOGS("bulk update chats failed"),new Error("bulk update chats failed")})):e}))},t.findLocal=function(){return f.apply(this,arguments)};var n=a(r(52954)),i=a(r(19976)),s=a(r(70417)),o=a(r(18120)),u=a(r(76022)),l=r(69398),d=r(35855);function c(){var e=(0,i.default)(["bulk update chats failed"]);return c=function(){return e},e}function f(){return(f=(0,n.default)((function*(e){if(o.default.supportsFeature(o.default.F.MD_BACKEND)){var t=yield(0,d.getTable)().get(e);if(t)return(0,l.hydrateWids)(t)}return null}))).apply(this,arguments)}},57525:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setLastReceivedKey=function(){return Promise.resolve()}},37821:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.sendConversationMute=function(e,t,r){var a;if(i.default.supportsFeature(i.default.F.MD_BACKEND)){var l=u.default.generateMuteMutation(e,t);(a=(0,o.lockForSync)(["chat"],[l],(([r])=>r.merge(e.toString(),{muteExpiration:t}))).then((()=>({status:200,_duplicate:null}))))||(a=Promise.reject(new Error("Should not reach here")))}else a=s.default.sendConversationMute(e,t,r).then((e=>{if(200!==e.status)throw new n.ServerStatusCodeError(e.status);return e}));return a};var n=r(19741),i=a(r(18120)),s=a(r(76022)),o=r(61392),u=a(r(34565))},54371:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.resyncMessages=function(e){return u.default.resyncMessages(e).then((e=>{if(s.default.supportsFeature(s.default.F.MD_BACKEND)&&(!e.status||e.status<400)){var{data:t}=e,a=[],n=[];return t.forEach((e=>{r(43334).default.get(e.id)?"clear"===e.type?a.push({id:e.id.toString(),t:e.t,unreadCount:e.unreadCount,archive:e.archive,isReadOnly:e.isReadOnly,modifyTag:e.modifyTag,notSpam:e.notSpam,pin:e.pin,changeNumberOldJid:e.changeNumberOldJid,changeNumberNewJid:e.changeNumberNewJid,muteExpiration:e.muteExpiration,ephemeralDuration:e.ephemeralDuration,ephemeralSettingTimestamp:e.ephemeralSettingTimestamp}):"delete"===e.type?n.push(e.id.toString()):a.push((0,i.default)((0,i.default)({},e),{},{id:e.id.toString()})):a.push((0,i.default)((0,i.default)({},e),{},{id:e.id.toString()}))})),(0,o.getStorage)().lock(["chat"],(([e])=>e.bulkCreateOrMerge(a).then((()=>e.bulkRemove(n))))).then((()=>e)).catch((()=>{throw __LOG__(4,!0,new Error,!0)(l()),SEND_LOGS("get storage or bulk update chats failedwhen re-sync messages"),new Error("get storage or bulk update chats failed")}))}return e}))};var n=a(r(19976)),i=a(r(70417)),s=a(r(18120)),o=r(77993),u=a(r(76022));function l(){var e=(0,n.default)(["get storage or bulk update chats failed"]);return l=function(){return e},e}},77902:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.sendConversationSeen=function(e,t,a){var n;s.default.supportsFeature(s.default.F.MD_BACKEND)?(n=Promise.all([Promise.resolve().then(r.bind(r,54212)),Promise.resolve().then(r.bind(r,73404))]).then((([{lockForMessageRangeSync:r},{default:n}])=>{var i=(0,d.unixTimeMs)();return(-1===a?n.getMarkChatAsReadMutation(i,!0,e.id).then((t=>{var a=e.id.toString();return r([],[t],(()=>(0,l.addActiveMessageRange)(e.id.toString(),"markChatAsRead",t.binarySyncAction))),(0,u.updateChatForMarkAsReadSync)(a)})):(0,c.markChatRead)(e,t)).then((()=>({_duplicate:!1})))})))||(n=Promise.reject(new Error("Should not reach here"))):n=o.default.sendConversationSeen(e.id,t,a).then((e=>{var{status:t,_duplicate:r}=e;return 200!==t?Promise.reject(new i.ServerStatusCodeError(t)):{_duplicate:r}}));return n},t.sendConversationUnseen=function(e,t){var a;s.default.supportsFeature(s.default.F.MD_BACKEND)?(a=Promise.all([Promise.resolve().then(r.bind(r,54212)),Promise.resolve().then(r.bind(r,73404))]).then((([{lockForMessageRangeSync:t},{default:r}])=>{var n=(0,d.unixTimeMs)();a=r.getMarkChatAsReadMutation(n,!1,e).then((r=>t([],[r],(()=>(0,l.addActiveMessageRange)(e.toString(),"markChatAsRead",r.binarySyncAction)))))})))||(a=Promise.reject(new Error("Should not reach here"))):a=o.default.sendConversationUnseen(e,t).then((e=>{var{status:t}=e;if(200!==t)return Promise.reject(new i.ServerStatusCodeError(t))}));return a},t.markConversationSeen=function(e,t){if(s.default.supportsFeature(s.default.F.MD_BACKEND))return(0,f.getChatTable)().merge(e.toString(),{unreadCount:t}).catch((e=>{if(e instanceof p.DbOnLogoutAbort)throw e;throw __LOG__(4,!0,new Error,!0)(_()),SEND_LOGS("update chat table failed when mark convestation seen"),new Error("update chat table failed")}));return Promise.resolve()},t.markConversationUnseen=function(e){if(s.default.supportsFeature(s.default.F.MD_BACKEND))return(0,f.getChatTable)().merge(e.toString(),{unreadCount:-1}).catch((e=>{if(e instanceof p.DbOnLogoutAbort)throw e;throw __LOG__(4,!0,new Error,!0)(h()),SEND_LOGS("update chat table failed when mark conversation as unseen"),new Error("update chat table failed")}));return Promise.resolve()};var n=a(r(19976)),i=r(19741),s=a(r(18120)),o=a(r(76022)),u=r(55644),l=r(16976),d=r(71684),c=r(33947),f=r(11008),p=r(96452);function h(){var e=(0,n.default)(["update chat table failed"]);return h=function(){return e},e}function _(){var e=(0,n.default)(["update chat table failed"]);return _=function(){return e},e}},55630:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.sendDeleteMsgs=function(e,t,r){var a,n=e.map((e=>e.id));if(s.default.supportsFeature(s.default.F.MD_BACKEND)){var h=d.default.getDeleteForMeMutations(e,t),_=n.map((e=>e.toString()));if(!(a=(0,l.lockForSync)(["message","label-association"],h,(()=>(0,u.removeMessagesFromHistory)(_))).then((()=>c.default.purge(_).catch((e=>{__LOG__(3)(p(),e)})).then((()=>Promise.resolve())))).catch((()=>{throw __LOG__(4,!0,new Error,!0)(f()),SEND_LOGS("remove messages from history failed when send delete messages"),new Error("remove messages from history failed")}))))return Promise.reject(new Error("Not Supported for Non-MD"))}else a=o.default.sendMessageDelete(r,n,t).then((e=>{if(200!==e.status)throw new i.ServerStatusCodeError(e.status)}));return a};var n=a(r(19976)),i=r(19741),s=a(r(18120)),o=a(r(76022)),u=r(12425),l=r(61392),d=a(r(9999)),c=a(r(11809));function f(){var e=(0,n.default)(["remove messages from history failed"]);return f=function(){return e},e}function p(){var e=(0,n.default)(["removeMessagesFromHistory: error ",""]);return p=function(){return e},e}},78475:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.sendStarMsgs=function(e,t,r){var a;s.default.supportsFeature(s.default.F.MD_BACKEND)?(a=h(t,r))||(a=Promise.reject(new Error("Should not reach here"))):a=o.default.sendMessageStarred(e,t.map((e=>e.id)),r).then((e=>{if(200!==e.status)return Promise.reject(new i.ServerStatusCodeError(e.status))}));return a},t.sendUnstarAll=function(e,t){var r;s.default.supportsFeature(s.default.F.MD_BACKEND)?(r=h(e,!1))||(r=Promise.reject(new Error("Should not reach here"))):r=o.default.sendUnstarAll(t).then((e=>{if(200!==e.status)return Promise.reject(new i.ServerStatusCodeError(e.status))}));return r};var n=a(r(19976)),i=r(19741),s=a(r(18120)),o=a(r(76022)),u=r(61392),l=r(12425),d=a(r(21743)),c=a(r(70546));function f(){var e=(0,n.default)(["unstar messages failed"]);return f=function(){return e},e}function p(){var e=(0,n.default)(["star messages failed"]);return p=function(){return e},e}function h(e,t){t||c.default.addUnsetActionCount(e.length);var r=d.default.getStarMessageMutations(e,t);return(0,u.lockForSync)(["message"],r,(()=>t?(0,l.starMessages)(e.map((e=>e.id.toString()))).catch((()=>{throw __LOG__(4,!0,new Error,!0)(p()),SEND_LOGS("star messages failed"),new Error("star messages failed")})):(0,l.unstarMessages)(e.map((e=>e.id.toString()))).catch((()=>{throw __LOG__(4,!0,new Error,!0)(f()),SEND_LOGS("unstar messages failed"),new Error("unstar messages failed")}))))}},82373:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.updateLocal=function(e,t){if(i.default.supportsFeature(i.default.F.MD_BACKEND))return(0,s.getTable)().merge(e.toString(),t).catch((e=>{if(e instanceof o.DbOnLogoutAbort)throw e;throw __LOG__(4,!0,new Error,!0)(u()),SEND_LOGS("update chat table failed when update local"),new Error("update chat table failed")}));return Promise.resolve()};var n=a(r(19976)),i=a(r(18120)),s=r(35855),o=r(96452);function u(){var e=(0,n.default)(["update chat table failed"]);return u=function(){return e},e}},82184:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.sendSetBlock=function(e,t){var r;if(s.default.supportsFeature(s.default.F.MD_BACKEND)){var a=e?(0,u.blockUser)(t):(0,u.unblockUser)(t);(r=a.then((e=>{if(e&&null!=e.errorCode)throw new i.ServerStatusCodeError(e.errorCode,e.errorText);return!0})))||(r=Promise.reject(new Error("Should not reach here")))}else r=o.default.sendSetBlock(e,[{jid:t}]).then((e=>{if(200!==e.status)throw new i.ServerStatusCodeError(e.status);return!(e._duplicate||200!==e.status)}));return r.then((r=>{if(r&&s.default.supportsFeature(s.default.F.MD_BACKEND)){var a=t.toString();return(e?(0,l.getBlocklistTable)().createOrReplace({id:a}):(0,l.getBlocklistTable)().remove(t.toString())).then((()=>r)).catch((()=>{throw __LOG__(4,!0,new Error,!0)(d()),SEND_LOGS("Failed to send set block"),new Error("send set block failed")}))}return r}))};var n=a(r(19976)),i=r(19741),s=a(r(18120)),o=a(r(76022)),u=r(19239),l=r(11008);function d(){var e=(0,n.default)(["send set block failed"]);return d=function(){return e},e}},36655:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.setChecksum=function(e){n.default.supportsFeature(n.default.F.MD_BACKEND)&&(0,i.setContactChecksum)(e);return Promise.resolve()};var n=a(r(18120)),i=r(65291)},95402:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.setFrequent=function(e){var t={};Object.keys(e).forEach((r=>{t[r]=e[r].map((e=>e.toString()))})),n.default.supportsFeature(n.default.F.MD_BACKEND)&&(0,i.setFrequentContacts)(t);return Promise.resolve()};var n=a(r(18120)),i=r(65291)},87354:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.getContactsToRemove=function(e){var t=[],a={};return e.forEach((e=>{e&&(a[e.id]=!0)})),n.default.forEach((e=>{var{id:n}=e;!(e.isUser||e.isGroup&&!r(43334).default.get(n))||a[n.toString()]||e.isPSA||t.push(e)})),t};var n=a(r(7470))},52354:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.sendSpamReport=function(e,t){var r;s.default.supportsFeature(s.default.F.MD_BACKEND)?(r=(0,u.reportSpam)(e,t).then((e=>{if(e&&e.errorCode)throw new i.ServerStatusCodeError(e.errorCode,e.errorText)})))||(r=Promise.reject(new Error("Should not reach here"))):r=o.default.sendSpamReport(e.id).then((e=>{if(200!==e.status)throw new i.ServerStatusCodeError(e.status)}));return r},t.sendNotSpam=function(e){var t;t=s.default.supportsFeature(s.default.F.MD_BACKEND)?Promise.resolve():o.default.sendConversationNotSpam(e.id).then((e=>{if(200!==e.status)throw new i.ServerStatusCodeError(e.status)}));return t.then((()=>s.default.supportsFeature(s.default.F.MD_BACKEND)?(0,l.getChatTable)().merge(e.id.toString(),{notSpam:!0}).catch((()=>{throw __LOG__(4,!0,new Error,!0)(d()),SEND_LOGS("get chat table merge failed when sending spam report"),new Error("get chat table merge failed")})):Promise.resolve()))};var n=a(r(19976)),i=r(19741),s=a(r(18120)),o=a(r(76022)),u=r(29390),l=r(11008);function d(){var e=(0,n.default)(["get chat table merge failed"]);return d=function(){return e},e}},51803:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.updateLocal=function(e,t){if(n.default.supportsFeature(n.default.F.MD_BACKEND))return(0,i.getTable)().merge(e.toString(),t);return Promise.resolve()};var n=a(r(18120)),i=r(5254)},82945:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.contactSync=function(){return l.apply(this,arguments)};var n=a(r(52954)),i=a(r(18120)),s=r(38815),o=r(75637),u=r(11008);function l(){return(l=(0,n.default)((function*(){if(i.default.supportsFeature(i.default.F.MD_BACKEND)){var e=yield(0,u.getContactTable)().all();if(e.length>0){var t=e.map((e=>(0,o.createWid)(e.id)));return(0,s.syncContactListInChunks)(t)}}}))).apply(this,arguments)}},58665:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.sendCreateGroup=function(e,t,r,a,u,l,d=!1){var c;if(i.default.supportsFeature(i.default.F.MD_BACKEND)){if(!(c=(0,o.createGroup)(e,t,d).then((e=>({gid:e.wid,participants:e.participants.map((e=>({[e.wid.toString()]:{code:null!=e.error?e.error.toString():"200",invite_code:e.invite_code,invite_code_exp:e.invite_code_exp}})))})))))return Promise.reject(new Error("queryGroupInvite: not supported when not build with MD_BACKEND"))}else c=s.default.createGroup(e,t,r,a,u,l,void 0,d).then((e=>200===e.status?e:Promise.reject(new n.ServerStatusCodeError(e.status))));return c};var n=r(19741),i=a(r(18120)),s=a(r(76022)),o=r(25692)},14809:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.markExited=function(e){if(i.default.supportsFeature(i.default.F.MD_BACKEND))return(0,o.getTable)().merge(e.toString(),{isReadOnly:!0});return Promise.resolve()},t.sendExitGroup=function(e){var t;if(i.default.supportsFeature(i.default.F.MD_BACKEND)){if(!(t=(0,u.leaveGroups)([e]).then((()=>({_duplicate:null})))))return Promise.reject(new Error("sendExitGroup: not supported when not build with MD_BACKEND"))}else t=s.default.leaveGroup(e).then((e=>200!==e.status?Promise.reject(new n.ServerStatusCodeError(e.status)):{_duplicate:e._duplicate}));return t};var n=r(19741),i=a(r(18120)),s=a(r(76022)),o=r(35855),u=r(35938)},90401:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.sendQueryGroup=function(e){var t;if(u.default.supportsFeature(u.default.F.MD_BACKEND)){if(!(t=(0,p.queryGroup)(e,"interactive")))return Promise.reject(new Error("queryGroup: not supported when not build with MD_BACKEND"))}else t=f.default.groupMetadataFind(e);return t.then((t=>{if(t.id)return(0,h.updateGroupMetadataTable)([t]),m(e,t.subject),(0,d.updateParticipants)(t.id,t.participants,t.pvId).then((()=>({id:t.id,owner:t.owner,creation:t.creation,desc:t.desc,descId:t.descId,descOwner:t.descOwner,descTime:t.descTime,restrict:t.restrict||!1,announce:t.announce||!1,noFrequentlyForwarded:t.noFrequentlyForwarded||!1,ephemeralDuration:t.ephemeralDuration||0,participants:t.participants,support:u.default.supportsFeature(u.default.F.SUPPORT)&&!0===t.support})));__LOG__(3)(_())})).catchType(o.ServerStatusCodeError,(t=>{if(t.status>=400)return{id:e,stale:!1}}))},t.sendQueryGroupInvite=function(e){var t;if(u.default.supportsFeature(u.default.F.MD_BACKEND)){if(!(t=(0,p.queryGroupInvite)(e).then((e=>(0,n.default)({status:200},e)))))return Promise.reject(new Error("queryGroup: not supported when not build with MD_BACKEND"))}else t=f.default.groupInviteInfo(e).then((e=>200!==e.status?Promise.reject(new o.ServerStatusCodeError(e.status)):e));return t},t.groupMetadataFindFromPhone=function(e){if(u.default.supportsFeature(u.default.F.MD_BACKEND))return Promise.reject(new Error("groupMetadataFindFromPhone: not supported in MD_BACKEND mode"));return f.default.groupMetadataFindFromPhone(e)},t.updateSubject=m;var n=a(r(70417)),i=a(r(19976)),s=a(r(7470)),o=r(19741),u=a(r(18120)),l=r(11419),d=r(83035),c=r(51803),f=a(r(76022)),p=r(88258),h=r(27485);function _(){var e=(0,i.default)(["Store:GroupMetadata Unexpected server response"]);return _=function(){return e},e}function m(e,t){(0,l.isString)(t)&&s.default.find(e).then((function(e){if(!e.name){var r={name:t};(0,c.updateLocal)(e.id,r).then((()=>{e.set(r)}))}}))}},98936:(e,t,r)=>{"use strict";var a=r(14859);t.Z=function(){if(i.default.supportsFeature(i.default.F.MD_BACKEND)){return(0,s.isRegistered)()}return!!(0,n.getLoginTokens)().server};var n=r(95595),i=a(r(18120)),s=r(39174)},63504:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var r;if(s.default.supportsFeature(s.default.F.MD_BACKEND)){t.some((e=>e instanceof d.default))&&(__LOG__(4,void 0,new Error,!0)(S()),SEND_LOGS("contact model is invalid for editLabelAssociation")),(r=T(e,t.map((e=>e instanceof c.default?{labelAssociationType:m.LabelAssociationType.Message,modelId:e.id.toString(),mutationIndexSegments:(0,p.constructMsgKeySegments)(e)}:{labelAssociationType:m.LabelAssociationType.Jid,modelId:e.id.toString(),mutationIndexSegments:[e.id.toString({legacy:!0})]}))))||(r=Promise.reject(new Error("Should not reach here")))}else r=o.default.addOrRemoveLabels(e,t).then((e=>{if(200!==e.status)return Promise.reject(new i.ServerStatusCodeError(e.status))}));return r},t.editLabelAssociationMD=T;var n=a(r(19976)),i=r(19741),s=a(r(18120)),o=a(r(76022)),u=r(61392),l=r(71684),d=a(r(40147)),c=a(r(27e3)),f=r(63487),p=r(16054),h=r(3531),_=r(75459),m=r(98538),g=r(68519),v=r(61239);function E(){var e=(0,n.default)(["bulkRemove from label association table failed"]);return E=function(){return e},e}function y(){var e=(0,n.default)(["bulkCreateOrReplace into label association table failed"]);return y=function(){return e},e}function S(){var e=(0,n.default)(["contact model is invalid for editLabelAssociation"]);return S=function(){return e},e}function T(e,t){return(0,_.canEditLabelAssociation)()?(0,u.lockForSync)(["label-association"],function(e,t){var r=(0,l.unixTimeMs)(),a=[];return e.forEach((({id:e,type:n})=>{t.forEach((({labelAssociationType:t,mutationIndexSegments:i})=>{a.push({timestamp:r,collection:f.CollectionName.Regular,operation:h.SyncdMutationSyncdOperation.SET,index:JSON.stringify([t===m.LabelAssociationType.Message?f.Actions.LabelMessage:f.Actions.LabelJid,e,...i]),version:f.LABEL_ASSOCIATION_SYNC_VERSION,binarySyncAction:(0,g.encodeProto)(v.SyncActionValueSpec,{timestamp:r,labelAssociationAction:{labeled:"add"===n}}).readBuffer()})}))})),a}(e,t),(()=>{var r=[],a=[];return e.forEach((({id:e,type:n})=>{t.map((({modelId:t,labelAssociationType:i})=>{"add"===n?r.push({labelId:e,associationId:t,type:i}):a.push([e,t,i])}))})),Promise.all([(0,m.getTable)().bulkCreateOrReplace(r).catch((()=>{throw __LOG__(4,!0,new Error,!0)(y()),SEND_LOGS("bulkCreateOrReplace into label association table failed when saving label associations"),new Error("bulkCreateOrReplace into label association table failed")})),(0,m.getTable)().bulkRemove(a).catch((()=>{throw __LOG__(4,!0,new Error,!0)(E()),SEND_LOGS("bulkRemove from label association table failed while saving label associations"),new Error("bulkRemove form label association table failed")}))])})):Promise.reject(new Error("editLabelAssociation is not supported"))}},4526:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.updateLocal=function(e,t){if(i.default.supportsFeature(i.default.F.MD_BACKEND))return(0,s.getTable)().merge(e.toString(),t).catch((e=>{throw __LOG__(4,!0,new Error,!0)(o()),SEND_LOGS("message updateLocal failed"),e}));return Promise.resolve()};var n=a(r(19976)),i=a(r(18120)),s=r(52303);function o(){var e=(0,n.default)(["updateLocal: failed to update in storage"]);return o=function(){return e},e}},45492:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.getHighestAck=function(){return p.apply(this,arguments)};var n=a(r(19976)),i=a(r(52954)),s=a(r(18120)),o=a(r(50935)),u=a(r(92313));function l(){var e=(0,n.default)(["getHighestAck: orphan ack "," for ",""]);return l=function(){return e},e}function d(){var e=(0,n.default)(["getHighestAck: orphan ack has 0 receipt for ",""]);return d=function(){return e},e}function c(){var e=(0,n.default)(["getHighestAck: no orphan ack found for ",""]);return c=function(){return e},e}var{ACK:f}=o.default;function p(){return(p=(0,i.default)((function*(e){if(s.default.supportsFeature(s.default.F.MD_BACKEND)){var t=yield u.default.find(e.id);if(!t)return __LOG__(2)(c(),e.id),null;var r=null,a=null;return 0===t.playedRemaining&&0!==t.played.length?(a=f.PLAYED,r=t.played):0===t.readRemaining&&0!==t.read.length?(a=f.READ,r=t.read):0===t.deliveryRemaining&&0!==t.delivery.length&&(a=f.RECEIVED,r=t.delivery),null==a||null==r?(__LOG__(2)(d(),e.id),null):(__LOG__(2)(l(),a,e.id),{ack:a,t:Math.max(...r.map((e=>e.t))),to:e.to,from:e.from})}return Promise.reject(new Error("getHighestAck: not supported for non MD"))}))).apply(this,arguments)}},44700:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.msgFindQuery=function(e,t,r,a){if(i.default.supportsFeature(i.default.F.MD_BACKEND))return(0,s.msgFindQuery)(e,t).catch((e=>{throw __LOG__(4,!0,new Error,!0)(d()),SEND_LOGS("msgFindQueryMD failed"),e}));return o.default.msgFindQuery(e,t,r,a)},t.msgFindByIds=function(e){if(i.default.supportsFeature(i.default.F.MD_BACKEND))return(0,s.getMsgsByMsgKey)(e).catch((e=>{throw __LOG__(4,!0,new Error,!0)(l()),SEND_LOGS("msgFindByIdsMD failed"),e}));return Promise.resolve([])},t.queryVcard=function(e){if(i.default.supportsFeature(i.default.F.MD_BACKEND))return(0,s.queryVcard)(e).catch((e=>{throw __LOG__(4,!0,new Error,!0)(u()),SEND_LOGS("queryVcardMD failed"),e}));return o.default.queryVcard(e)};var n=a(r(19976)),i=a(r(18120)),s=r(12425),o=a(r(76022));function u(){var e=(0,n.default)(["queryVcard: failed to find vCard in storage"]);return u=function(){return e},e}function l(){var e=(0,n.default)(["msgFindByIds: failed to find msg in storage"]);return l=function(){return e},e}function d(){var e=(0,n.default)(["msgFindQuery: failed to find msg in storage"]);return d=function(){return e},e}},62885:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.sendQueryMsgInfo=function(e){var t,{id:r}=e;u.default.supportsFeature(u.default.F.MD_BACKEND)?(t=(0,d.queryMsgInfo)(e.id).catch((e=>{throw __LOG__(4,!0,new Error,!0)(f()),SEND_LOGS("queryMsgInfo failed"),e})))||(t=Promise.reject(new Error("Should not reach here"))):t=l.default.queryMsgInfo(r).then((e=>e.status>=400?(__LOG__(2)(c(),e.status),Promise.reject(new o.ServerStatusCodeError(e.status))):e));return t.then((t=>(0,n.default)((0,n.default)({},t),{},{id:r,usePlayReceipt:e.type===s.default.MSG_TYPE.PTT||e.isViewOnce})))};var n=a(r(70417)),i=a(r(19976)),s=a(r(50935)),o=r(19741),u=a(r(18120)),l=a(r(76022)),d=r(99849);function c(){var e=(0,i.default)(["model:MsgInfo:findQuery error ",""]);return c=function(){return e},e}function f(){var e=(0,i.default)(["sendQueryMsgInfo: failed to find msg info in storage"]);return f=function(){return e},e}},88659:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.sendDeliveryReceiptsAfterPresence=function(){n.default.supportsFeature(n.default.F.MD_BACKEND)&&(0,i.sendDeliveryReceiptsAfterPresence)()};var n=a(r(18120)),i=r(23882)},8541:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.sendMsgRecord=function(e){var t=Promise.resolve();if(s.default.supportsFeature(s.default.F.MD_BACKEND)){var{encryptAndSendMsg:a}=r(80500);t=a(e).then((e=>({t:parseInt(e.t,10),data:null}))).catch((t=>(__LOG__(3)(u(),e.id.toString()),e.isSendFailure=!0,Promise.reject(t))))}else t=o.default.msgCreateRecord(e).then((e=>200!==e.status?Promise.reject(new i.ServerStatusCodeError(e.status)):e));return t};var n=a(r(19976)),i=r(19741),s=a(r(18120)),o=a(r(76022));function u(){var e=(0,n.default)(["[messaging] sendMsgRecord: MD send failure, msg: ",""]);return u=function(){return e},e}},7845:(e,t,r)=>{"use strict";var a=r(14859),n=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.setPresenceAvailable=function(){o.default.supportsFeature(o.default.F.MD_BACKEND)?(0,c.default)("available"):u.default.sendPresenceAvailable().catchType(i.WebdDrop,(()=>{})).catchType(s.ProtoVersionUndefined,(()=>{}))},t.setPresenceUnavailable=function(){o.default.supportsFeature(o.default.F.MD_BACKEND)?(0,c.default)("unavailable"):u.default.sendPresenceUnavailable().catchType(i.WebdDrop,(()=>{})).catchType(s.ProtoVersionUndefined,(()=>{}))},t.subscribePresence=function(e){var t;if(o.default.supportsFeature(o.default.F.MD_BACKEND)){var r;r=e instanceof l.default?e:(0,d.createWid)(e),(t=Promise.resolve((0,f.default)(r)))||(t=Promise.reject(new Error("md:subscribePresence: not supported when not build with MD_BACKEND")))}else t=u.default.subscribePresence(e);return t};var i=r(19741),s=n(r(96452)),o=a(r(18120)),u=a(r(76022)),l=a(r(68384)),d=r(75637),c=a(r(74854)),f=a(r(97866))},8125:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.queryProduct=function(e,t,r,a){var n;if(i.default.supportsFeature(i.default.F.MD_BACKEND))(n=(0,c.default)(e,t,r,a))||(n=Promise.reject(new Error("Should not reach here")));else{var o=e.toString({legacy:!0});n=s.default.queryProduct(o,t,r,a)}return n},t.queryCatalog=function(e,t,r,a,n){var o;if(i.default.supportsFeature(i.default.F.MD_BACKEND))(o=(0,f.default)(e,t,r,a,n))||(o=Promise.reject(new Error("Should not reach here")));else{var u=e.toString({legacy:!0});o=s.default.queryProductCatalog(u,t,r,a,n)}return o},t.queryProductList=function(e,t,r,a){if(i.default.supportsFeature(i.default.F.MD_BACKEND))return(0,g.newJob)("queryProductList").waitUntilCompleted(e,t,r,a);var n=e.toString({legacy:!0});return s.default.queryProductList(n,t,r,a)},t.reportProduct=function(e,t,r){var a;i.default.supportsFeature(i.default.F.MD_BACKEND)?(a=(0,p.default)(e,t,r))||(a=Promise.reject(new Error("Should not reach here"))):a=s.default.reportBusinessCatalogProduct(e,t,r);return a},t.appealProduct=function(e,t){var r;i.default.supportsFeature(i.default.F.MD_BACKEND)?(r=(0,d.default)(e,t))||(r=Promise.reject(new Error("Should not reach here"))):r=s.default.appealCatalogProduct(e,t);return r},t.createCatalog=function(){var e;i.default.supportsFeature(i.default.F.MD_BACKEND)?(e=(0,h.default)())||(e=Promise.reject(new Error("Should not reach here"))):e=s.default.createBusinessCatalog();return e},t.addProduct=function(e,t,r){var a;i.default.supportsFeature(i.default.F.MD_BACKEND)?(a=(0,u.default)(e,t,r).then(y))||(a=Promise.reject(new Error("Should not reach here"))):a=s.default.addBusinessCatalogProduct(e,t,r).then(y);return a},t.editProduct=function(e,t,r){var a;i.default.supportsFeature(i.default.F.MD_BACKEND)?(a=(0,l.default)(e,t,r).then(y))||(a=Promise.reject(new Error("Should not reach here"))):a=s.default.editBusinessCatalogProduct(e,t,r).then(y);return a},t.deleteProducts=function(e){var t;i.default.supportsFeature(i.default.F.MD_BACKEND)?(t=(0,_.default)(e))||(t=Promise.reject(new Error("Should not reach here"))):t=s.default.deleteBusinessCatalogProduct(e);return t},t.parseDateValue=E,t.mapProductResponseToModel=y,t.mapMsgToProductModel=function(e){var t;e.businessOwnerJid&&(t=(0,o.createWid)(e.businessOwnerJid));return{catalogWid:t,id:e.productId||"",url:e.url,name:e.title,description:e.description,imageCdnUrl:e.mediaData.renderableUrl,reviewStatus:"",currency:e.currencyCode,priceAmount1000:e.priceAmount1000,salePriceAmount1000:e.salePriceAmount1000,retailerId:e.retailerId,productMsgMediaData:e.mediaData,imageCount:null!=e.productImageCount&&0!==e.productImageCount?e.productImageCount:1,fetchedFromServer:!1,t:e.t,isHidden:!1}},t.productVisibilitySet=function(e){var t;i.default.supportsFeature(i.default.F.MD_BACKEND)?(t=(0,m.default)(e))||(t=Promise.reject(new Error("Should not reach here"))):t=s.default.productVisibilitySet(e);return t};var n=a(r(19034)),i=a(r(18120)),s=a(r(76022)),o=r(75637),u=a(r(16006)),l=a(r(3709)),d=a(r(9571)),c=a(r(95779)),f=a(r(14167)),p=a(r(67688)),h=a(r(95295)),_=a(r(48245)),m=a(r(89370)),g=r(10902);function v(e){return null==e?null:i.default.supportsFeature(i.default.F.MD_BACKEND)?parseInt(e,10):10*parseInt(e,10)}function E(e){return e?n.default.utc(e,n.default.ISO_8601).unix():null}function y(e,t){return{catalogWid:t,id:e.id,isHidden:e.is_hidden||!1,url:e.url||"",name:e.name,description:e.description||"",additionalImageCdnUrl:e.additional_image_cdn_urls.map((e=>e[1].value)),additionalImageHashes:e.image_hashes_for_whatsapp.slice(1),imageCdnUrl:e.image_cdn_urls[1].value,imageHash:e.image_hashes_for_whatsapp[0],reviewStatus:e.capability_to_review_status.length?e.capability_to_review_status[0].value:"",currency:e.currency,priceAmount1000:v(e.price),salePriceAmount1000:v(e.sale_price),salePriceStartDate:E(e.sale_start_date),salePriceEndDate:E(e.sale_end_date),retailerId:e.retailer_id||"",productMsgMediaData:null,imageCount:e.additional_image_cdn_urls.length+1,fetchedFromServer:!0,t:Date.now()/1e3,old:!1,canAppeal:e.whatsapp_product_can_appeal}}},85619:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.requestDeletePicture=function(e){var t;o.default.supportsFeature(o.default.F.MD_BACKEND)?(t=(0,g.default)(e,null).then((()=>({_duplicate:!1,status:200}))))||(t=Promise.reject(new Error("Should not reach here"))):t=c.default.deletePicture(e).then((e=>e.status&&200!==e.status?Promise.reject(new s.ServerStatusCodeError(e.status)):e));return t.then((t=>t._duplicate?t:o.default.supportsFeature(o.default.F.MD_BACKEND)?(0,h.getProfilePicThumbTable)().remove(e.toString()).then((()=>{(0,f.changeProfilePicThumb)(e,m.PROFILE_PIC_COMMAND.REMOVE)})).then((()=>t)):t))},t.sendSetPicture=function(e,t,r){var a;if(o.default.supportsFeature(o.default.F.MD_BACKEND)){var n=v.default.parseDataURL(r).data,i=(0,p.decodeB64)(n);(a=(0,g.default)(e,i).then((()=>(0,_.getProfilePicFull)(e).then((e=>({_duplicate:!1,tag:e.tag,eurl:e.eurl,token:"",status:200}))))))||(a=Promise.reject(new Error("Should not reach here")))}else a=c.default.sendSetPicture(e,t,r).then((e=>200!==e.status?Promise.reject(new s.ServerStatusCodeError(e.status)):e));return a.then((t=>b(e).then((r=>{if(t.token=r,t._duplicate)return t;if(o.default.supportsFeature(o.default.F.MD_BACKEND)){var a=e.toString();return(0,h.getProfilePicThumbTable)().createOrMerge(a,{id:a,tag:t.tag,eurl:t.eurl}).then((()=>{(0,f.changeProfilePicThumb)(e,m.PROFILE_PIC_COMMAND.SET)})).then((()=>t))}return t}))))},t.profilePicFindThumbFromPhone=function(e,t){return c.default.profilePicFindThumbFromPhone(e,t).then((t=>b(e).then((e=>{if(t.token=e,o.default.supportsFeature(o.default.F.MD_BACKEND)){var r=t.id.toString();return(0,h.getProfilePicThumbTable)().createOrMerge(r,{id:r,tag:t.tag,raw:t.raw}).then((()=>t))}return t}))))},t.profilePicFind=T,t.profilePicResync=function(e){if(o.default.supportsFeature(o.default.F.MD_BACKEND))return Promise.all(e.map((e=>T(e.id).then((t=>({id:e.id,eurl:t.eurl,tag:t.tag,token:t.token,previewEurl:t.previewEurl}))).catchType(s.ServerStatusCodeError,(t=>{switch(t.status){case 401:case 404:return{id:e.id,tag:"",token:""};default:return __LOG__(3)(S(),t.status,t.message),{id:e.id,token:""}}})))));return c.default.resyncPictures(e).then((e=>Array.isArray(e)?Promise.all(e.map((e=>b(e.id).then((t=>(0,n.default)((0,n.default)({},e),{},{token:t})))))):"number"==typeof e.status&&e.status>=400?(423!==e.status&&429!==e.status&&__LOG__(3)(y(),e.status),Promise.reject(new s.ServerStatusCodeError(e.status))):(__LOG__(3)(E()),Promise.reject(new Error("ProfilePicThumbStore:resyncPictures unknown reply")))))};var n=a(r(70417)),i=a(r(19976)),s=r(19741),o=a(r(18120)),u=a(r(61941)),l=r(8292),d=r(77993),c=a(r(76022)),f=r(95303),p=r(60339),h=r(11008),_=r(97066),m=r(27886),g=a(r(80358)),v=a(r(74185));function E(){var e=(0,i.default)(["ProfilePicThumbStore:resyncPictures unknown reply"]);return E=function(){return e},e}function y(){var e=(0,i.default)(["ProfilePicThumbStore:resyncPictures error ",""]);return y=function(){return e},e}function S(){var e=(0,i.default)(["ProfilePicThumb:resyncPictures error - ",", ",""]);return S=function(){return e},e}function T(e){var t;o.default.supportsFeature(o.default.F.MD_BACKEND)?(t=Promise.all([(0,_.getProfilePicFull)(e),(0,_.getProfilePicPreview)(e)]).then((e=>{var t=e[0],r=e[1];return{tag:t.tag,eurl:t.eurl,previewEurl:r.eurl,token:""}})))||(t=Promise.reject(new Error("Should not reach here"))):t=c.default.profilePicFind(e).then((e=>null!=e.status&&200!==e.status?Promise.reject(new s.ServerStatusCodeError(e.status)):e));var r=t=>(0,d.getStorage)().lock(["profile-pic-thumb"],(([r])=>r.get(e.toString()).then((a=>a?r.merge(e.toString(),t):r.create(t))))),a={id:e.toString(),tag:void 0,eurl:void 0,raw:void 0,previewEurl:void 0};return(0,u.default)(t,"serverPromise").then((t=>b(e).then((e=>(t.token=e,o.default.supportsFeature(o.default.F.MD_BACKEND)?(a.tag=t.tag,a.eurl=t.eurl,a.raw=null,a.previewEurl=t.previewEurl,r(a).then((()=>t))):t))))).catchType(s.ServerStatusCodeError,(e=>{if(!o.default.supportsFeature(o.default.F.MD_BACKEND))throw e;return o.default.supportsFeature(o.default.F.MD_BACKEND)&&404===e.status||!o.default.supportsFeature(o.default.F.MD_BACKEND)&&401===e.status?(a.tag="",a.raw=null):(a.tag=null,a.eurl=null,a.previewEurl=null),r(a).then((()=>{throw e}))}))}function b(e){if(o.default.supportsFeature(o.default.F.MD_BACKEND))return Promise.resolve("");for(var t=String(e),r=new ArrayBuffer(2*t.length),a=new Uint16Array(r),n=0;n<t.length;n++)a[n]=t.charCodeAt(n);return Promise.resolve().then((()=>(0,l.getSecurityToken)(r)))}},55042:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t,r="+".concat(e.toString());if(!n.default.supportsFeature(n.default.F.MD_BACKEND))return i.default.queryExist(r).then((e=>200===e.status?{wid:e.jid,biz:e.biz||!1}:null));(t=(0,s.queryExist)(r))||(t=Promise.reject(new Error("Should not reach queryExists MD")));return t};var n=a(r(18120)),i=a(r(76022)),s=r(98627)},11252:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.sendQueryMediaConn=function(e){return(0,s.default)({delay:({taskDuration:e})=>{var t=1e3*c();return Math.max(t-e,0)},signal:e},(t=>{var r;if(u.default.supportsFeature(u.default.F.MD_BACKEND)){if(!(r=(0,d.queryMediaConn)(e)))return Promise.reject(new Error("sendQueryMediaConn: not supported when not build with MD_BACKEND"))}else r=l.default.queryMediaConnections(e);return r.then((e=>{var{ttl:t,authTTL:r}=e;return null==r?(r=1e3*t,t=3e5):(r*=1e3,t*=1e3),(0,n.default)((0,n.default)({},e),{},{authTTL:r,ttl:t})})).catchType(o.ServerStatusCodeError,(e=>{if(e.status>=500)return t(e);throw e}))}))};var n=a(r(70417)),i=r(26800),s=a(r(93282)),o=r(19741),u=a(r(18120)),l=a(r(76022)),d=r(95084),c=(0,i.createTimer)({algo:{type:"fibonacci",first:0,second:1},max:9e5,jitter:.25})},8766:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.queryServerProps=function(){var e;n.default.supportsFeature(n.default.F.MD_BACKEND)?(e=(0,o.default)().then((e=>e.success?e.result:Promise.reject(new s.ServerStatusCodeError(e.errorCode,e.errorText)))))||(e=Promise.reject(new Error("Should not reach here"))):e=i.default.queryServerProps();return e};var n=a(r(18120)),i=a(r(76022)),s=r(19741),o=a(r(36876))},40103:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){if(n.default.supportsFeature(n.default.F.MD_BACKEND))return s.default.requestMediaReupload(e).then((({result:e,directPath:t})=>({status:u(e),directPath:t,isMD:!0})));return i.default.requestMediaReupload(e).then((({status:e,url:t,mediaKey:r,mediaKeyTimestamp:a,encFilehash:n,directPath:i})=>({isMD:!1,status:e,url:t,mediaKey:r,mediaKeyTimestamp:a,encFilehash:n,directPath:i})))};var n=a(r(18120)),i=a(r(76022)),s=a(r(32724)),o=r(4786);function u(e){if(null!=e)switch(e){case o.MediaRetryNotificationResultType.SUCCESS:return 200;case o.MediaRetryNotificationResultType.NOT_FOUND:case o.MediaRetryNotificationResultType.DECRYPTION_ERROR:return 404;case o.MediaRetryNotificationResultType.GENERAL_ERROR:return 500}return 500}},37513:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){if(i.default.supportsFeature(i.default.F.MD_BACKEND))return Promise.resolve();return s.default.setArchiveSetting(e).then((e=>{if(e.status&&200!==e.status)throw new n.ServerStatusCodeError(e.status)}))};var n=r(19741),i=a(r(18120)),s=a(r(76022))},8941:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);t.Z=function(e,t){if("wam:sendLogs b64len:".concat(e.length),m.default.supportsFeature(m.default.F.MD_BACKEND))return function(e,t){var r=new Uint8Array((0,_.decodeB64)(e)),a=(0,o.unixTime)();return E(t,(e=>(0,g.default)(r,a).uncancellable().then((r=>{if(r&&r.errorCode){if(r.errorCode>=500)throw new d.ServerStatusCodeError(r.errorCode,r.errorText);e(t)}e(void 0)}))))}(e,t);return function(e,t){var r=new FormData;r.append("t",String((0,o.unixTime)())),r.append("v",l.default.VERSION_BASE);var a=(0,f.getLoginTokens)().server;a&&r.append("tok",a);return r.append("buffer",e),E(t,(e=>(0,c.default)(l.default.WAM_URL,{method:"POST",body:r}).then((function(r){if(200===r.status)e(void 0);else{if(r.status>=500)throw new d.ServerStatusCodeError(r.status);e(t)}}))))}(e,t)};var i=n(r(19976)),s=r(91460),o=r(71684),u=n(r(12489)),l=n(r(50935)),d=r(19741),c=n(r(93601)),f=r(95595),p=n(r(99911)),h=a(r(82885)),_=r(60339),m=n(r(18120)),g=n(r(22105));function v(){var e=(0,i.default)(["wam:sendLogs failure error: ",""]);return v=function(){return e},e}function E(e,t){return Promise.loop(((r,a,n)=>{var i=(0,s.delayMs)(h.expBackoff(n,12e4,1e3,.1));return p.default.waitIfOffline({signal:(new u.default).signal}).then((()=>t(r))).catch((t=>n>1?(__LOG__(3)(v(),String(t)),r(e)):("wam:sendLogs retry on error: ".concat(String(t)),i)))}))}},6829:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.getStatus=function(e){var t;o.default.supportsFeature(o.default.F.MD_BACKEND)?(t=(0,l.default)(e).then((e=>e.error?(__LOG__(3)(p(),e.error.errorCode,e.error.errorText),{id:e.id,stale:!0,status:""}):{id:e.id,status:null!=e.status?e.status:""})))||(t=Promise.reject(new Error("getAbout: invalid when build with MD_BACKEND"))):t=u.default.statusFind(e).then((t=>({id:e,status:null!=t.status?t.status:""}))).catchType(s.WebdDrop,(()=>({id:e,stale:!0,status:""})));return t},t.setMyStatus=function(e){var t;o.default.supportsFeature(o.default.F.MD_BACKEND)?(t=(0,d.newJob)("setAbout").waitUntilCompleted(e))||(t=Promise.reject(new Error("setStatus: invalid when build with MD_BACKEND"))):t=u.default.sendSetStatus(e);return t},t.queryStatusAll=function(){var e=Promise.resolve();e=o.default.supportsFeature(o.default.F.MD_BACKEND)?(0,c.queryStatusAllMD)():u.default.statusQuery();return e},t.queryStatusUpdate=function(e,t,r){var a=Promise.resolve();if(o.default.supportsFeature(o.default.F.MD_BACKEND))return Promise.resolve([]);a=u.default.statusQuery(e,t,r,"after");return a},t.sendReadStatus=function(){return h.apply(this,arguments)};var n=a(r(52954)),i=a(r(19976)),s=r(19741),o=a(r(18120)),u=a(r(76022)),l=a(r(27442)),d=r(10902),c=r(8825),f=r(33947);function p(){var e=(0,i.default)(["getStatus: failed "," : ",""]);return p=function(){return e},e}function h(){return(h=(0,n.default)((function*(e,t){var r;if(o.default.supportsFeature(o.default.F.MD_BACKEND)){if(yield(0,f.markStatusRead)(e),null==(r=!0))throw new Error("sendReadStatus: shouldn't reach here (md_backend was disabled)!")}else r=200===(yield u.default.sendStatusSeen(e,t)).status;return r}))).apply(this,arguments)}},65978:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.sendCallOfferBridge=function(e){var t;n.default.supportsFeature(n.default.F.MD_BACKEND)?(t=(0,s.default)(e,l.TYPE.OFFER))||(t=Promise.reject(new Error("Should not reach here"))):t=e.payload[2].find((e=>"enc"===e[0]))?i.default.sendCallOffer(e):i.default.sendGroupCallOffer(e);return t},t.sendCallSignalingMsgBridge=function(e,t){var r;n.default.supportsFeature(n.default.F.MD_BACKEND)?(r=(0,o.default)(e))||(r=Promise.reject(new Error("Should not reach here"))):r=i.default.sendCallSignalingMsg(e,t);return r},t.sendQueryCallBridge=function(e,t){var r;n.default.supportsFeature(n.default.F.MD_BACKEND)?(r=Promise.resolve({status:200}))||(r=Promise.reject(new Error("Should not reach here"))):r=i.default.queryCall(e,t);return r},t.sendCallEndBridge=function(e,t){var r;n.default.supportsFeature(n.default.F.MD_BACKEND)?(r=Promise.resolve({}))||(r=Promise.reject(new Error("Should not reach here"))):r=i.default.sendCallEnd(e,t);return r},t.sendEncRekeyBridge=function(e){var t;n.default.supportsFeature(n.default.F.MD_BACKEND)?(t=(0,s.default)(e,l.TYPE.ENC_REKEY))||(t=Promise.reject(new Error("Should not reach here"))):t=i.default.sendCallSignalingMsg(e);return t},t.prepareRetryReceiptBridge=function(e){var t;n.default.supportsFeature(n.default.F.MD_BACKEND)?(t=(0,u.default)(e))||(t=Promise.reject(new Error("Should not reach here"))):t=Promise.resolve(e);return t};var n=a(r(18120)),i=a(r(76022)),s=a(r(43315)),o=a(r(73919)),u=a(r(14318)),l=r(31558)},46554:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.shift().blocklist.map((e=>({id:e}))),a=r(79148).default;n.default.supportsFeature(n.default.F.MD_BACKEND)?(0,i.getBlocklistTable)().clear().then((()=>Promise.all(t.map((({id:e})=>(0,i.getBlocklistTable)().create({id:e.toString()})))))).then((()=>a.set(t))):a.set(t)};var n=a(r(18120)),i=r(11008)},79626:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.shift(),a=r(43334).default,n=r(58885).default;if(Array.isArray(t)){var o=[],K=[],j=[],W=[];t.forEach((function(e){if("c.us"===e.id)K.push(e);else{var t=!!a.get(e.id),r=["delete","clear","ephemeral","archive","unarchive","star","unstar","spam","modify_tag","pin","modify"].includes(e.type);r?t&&r?K.push(e):__LOG__(2)(Y(),JSON.stringify(e)):o.push(e)}}));var V=o.find((e=>P.default.isPSA(e.id)));null!=V&&(V.name=T.default.t(1907));var H=r(63095).default;return K.forEach((function(e){var t=e.type;if("c.us"===e.id.toString()){switch(a.disableSortListener(),t){case"clear":__LOG__(2)(B(),String(e.before),String(e.kind)),a.forEach((function(t){"number"==typeof e.before?t.deleteMsgsOlderThan(e.before,e.star,e.kind):t.deleteMsgs(e.star,e.kind)}));break;case"delete":__LOG__(2)(x()),a.toArray().forEach((function(e){e.isGroup?e.deleteMsgs(!0):j.push(e)}));break;case"archive":__LOG__(2)(G()),a.forEach((function(e){W.push({id:e.id,archive:!0,pin:void 0})}));break;case"unarchive":__LOG__(2)(F()),a.forEach((function(e){W.push({id:e.id,archive:!1})}));break;case"unstar":__LOG__(2)(U()),H.delete(),a.forEach((function(e){e.unstarAll()}));break;default:__LOG__(3)(k(),JSON.stringify(e))}a.enableSortListener()}else{var r=a.get(e.id);if(!r)return;switch(t){case"ephemeral":if(null!=e.t){var i=r.getLastReceivedNonExpiredMsg(e.t);i&&(0,b.setLastReceivedKey)(r.id,i.id).then((()=>{r.lastReceivedKey=i.id}))}break;case"clear":case"star":case"unstar":if(e.keys){for(var s=e.keys.length,o="star"===t,u=[],l=[],c=[],f=!1,p=0;p<s;p++){var h=void 0,_=void 0,m=void 0,g=void 0,v=void 0,E=e.keys[p];Array.isArray(E)?([h,_,m]=E,g=new A.default({fromMe:_,remote:e.id,id:h,participant:m}),(v=n.get(g))?"clear"===t?v.delete():(v.star=o,c.push(v)):o&&(f=!0)):!(0,d.default)(E)||"star"!==t&&"unstar"!==t||(g=E.id,(v=n.get(E.id))?(v.star=o,c.push(v)):l.push(E)),u.push(g&&g.toString())}"star"!==t&&"unstar"!==t||H.process(o,l,c,f),__LOG__(2)(L(),[t,e.id,u.join(),e.modifyTag].join())}else"clear"===t?("number"==typeof e.before?r.deleteMsgsOlderThan(e.before,e.star,e.kind):r.deleteMsgs(e.star,e.kind),__LOG__(2)(N(),[e.id,e.before,e.modifyTag,e.kind].join())):"unstar"===t&&(r.unstarAll(),__LOG__(2)(D(),e.id));isNaN(e.modifyTag)||W.push({id:e.id,modifyTag:e.modifyTag});break;case"delete":j.push(r),__LOG__(2)(R(),String(e.id));break;case"archive":W.push({id:e.id,archive:!0,pin:void 0});break;case"unarchive":W.push({id:e.id,archive:!1});break;case"spam":W.push({id:e.id,notSpam:e.notSpam});break;case"modify_tag":W.push({id:e.id,modifyTag:e.modifyTag});break;case"pin":W.push({id:e.id,pin:e.pin});break;case"modify":W.push({id:e.id,changeNumberOldJid:e.changeNumberOldJid,changeNumberNewJid:e.changeNumberNewJid})}}})),(g.default.supportsFeature(g.default.F.MD_BACKEND)?(0,C.getStorage)().lock(["chat"],(([e])=>e.bulkCreateOrMerge(o.map((e=>(0,s.default)((0,s.default)({},e),{},{id:e.id.toString()})))).then((()=>Promise.all(W.map((t=>{var{id:r}=t,a=(0,i.default)(t,["id"]);e.merge(r.toString(),a)}))))).then((()=>e.bulkRemove(j.map((e=>e.id.toString()))))))).catch((()=>{__LOG__(4,void 0,new Error,!0)(I()),SEND_LOGS("ChatHandler: bulk handle error")})):Promise.resolve()).then((()=>{a.add(o,{merge:!0}),W.forEach((e=>{var{id:t}=e,r=(0,i.default)(e,["id"]),n=a.get(t);n&&n.set(r)})),j.forEach((e=>e.delete()))}))}if("leave"===t.cmd)t.gids.forEach((function(e){var t=a.get(e);t&&(0,_.localExitGroup)(t)}));else{if("preempt"===t.cmd){var q=Promise.resolve();g.default.supportsFeature(g.default.F.MD_BACKEND)&&(q=(0,O.getTable)().bulkCreateOrMerge(t.response.map((e=>(0,s.default)((0,s.default)({},e),{},{id:e.id.toString(),muteExpiration:0})))));var z=(0,v.getBridge)();return q.then((()=>z.sendAndReceive("chat_collection","add",{things:t.response,options:{merge:!0}}))).then((()=>{f.default.platform!==f.PLATFORMS.IPHONE&&f.default.platform!==f.PLATFORMS.SMBI||((0,l.default)(t.response)?z.fireAndForget("msg_collection","trigger",{name:p.default.COLLECTION_HAS_SYNCED}):setTimeout((()=>{z.fireAndForget("msg_collection","trigger",{name:p.default.COLLECTION_HAS_SYNCED})}),2500)),z.fireAndForget("chat_collection","trigger",{name:p.default.COLLECTION_HAS_SYNCED,args:{count:t.response.length,binarySize:t.binarySize}})}))}if("action"===t.cmd){var J=t.id,Q=t.data;if("create"!==Q[0]&&"introduce"!==Q[0]){if(Q.length<3)return void __LOG__(3)(M(),JSON.stringify(t));var X,Z=t.data[0],$="unknown"===t.data[1]?null:t.data[1];return X=Z===y.GROUP_ACTIONS.RESTRICT||Z===y.GROUP_ACTIONS.ANNOUNCE||Z===y.GROUP_ACTIONS.NO_FORWARD?{action:Z,value:t.data[2]}:Z===y.GROUP_ACTIONS.EPHEMERAL?{action:Z,duration:t.data[2]}:(0,s.default)({action:Z},t.data[2]),(0,S.handleGroupActionWap)({chatId:t.id,author:$},X)}var ee=Q[1],te=Q[2],re=[...(0,u.default)(te.admins,(e=>({id:e,isAdmin:!0}))),...(0,u.default)(te.superadmins||[],(e=>({id:e,isAdmin:!0,isSuperAdmin:!0}))),...(0,u.default)(te.regulars,(e=>({id:e,isAdmin:!1})))];E.default.add({id:J,creation:te.creation,owner:ee,participants:re,stale:!1,desc:te.desc,descId:te.descId,descTime:te.descTime,descOwner:te.descOwner,restrict:!!te.restrict,announce:!!te.announce},{merge:!0}),h.default.add({id:J,name:te.subject},{merge:!0});var ae=a.get(J);if(!ae)return;var ne=ae.msgs.last();if(!ne)return;if("gp2"===ne.type&&"add"===ne.subtype){var ie=(0,m.getMaybeMeUser)();E.default.trigger("group_participant_change_".concat(ie.toString()),J),P.default.equals(ne.recipients[0],ie)&&c.default.alertNewMsg(ne)}}else __LOG__(3)(w(),JSON.stringify(t))}};var i=n(r(22220)),s=n(r(70417)),o=n(r(19976)),u=n(r(16760)),l=n(r(45455)),d=n(r(29259)),c=n(r(79711)),f=a(r(52737)),p=n(r(50935)),h=n(r(7470)),_=r(71142),m=r(95595),g=n(r(18120)),v=r(11824),E=n(r(99922)),y=r(70185),S=r(69007),T=n(r(17957)),b=r(57525),A=n(r(77865)),C=r(77993),P=n(r(68384)),O=r(35855);function w(){var e=(0,o.default)(["model:chat: unknown payload: ",""]);return w=function(){return e},e}function M(){var e=(0,o.default)(["model:chat: incorrect length of payload data for action ",""]);return M=function(){return e},e}function I(){var e=(0,o.default)(["Assertion failed!"]);return I=function(){return e},e}function R(){var e=(0,o.default)(["model:Chat:handle deleted chat for ",""]);return R=function(){return e},e}function D(){var e=(0,o.default)(["model:Chat:handle unstarred chat: ",""]);return D=function(){return e},e}function N(){var e=(0,o.default)(["model:Chat:handle cleared chat:",""]);return N=function(){return e},e}function L(){var e=(0,o.default)(["model:Chat:handle:messages:",""]);return L=function(){return e},e}function k(){var e=(0,o.default)(["Model:chat:handle unknown ",""]);return k=function(){return e},e}function U(){var e=(0,o.default)(["Model:chat:handle:unstar:all"]);return U=function(){return e},e}function F(){var e=(0,o.default)(["Model:chat:handle:unarchive:all"]);return F=function(){return e},e}function G(){var e=(0,o.default)(["Model:chat:handle:archive:all"]);return G=function(){return e},e}function x(){var e=(0,o.default)(["Model:chat:handle:delete:all"]);return x=function(){return e},e}function B(){var e=(0,o.default)(["Model:chat:handle:clear:all before:"," kind:",""]);return B=function(){return e},e}function Y(){var e=(0,o.default)(["Model:chat:handle received junk chat record: ",""]);return Y=function(){return e},e}},96898:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.shift();switch(t.type){case"picture":(0,n.changeProfilePicThumb)(t.jid,t.tag);break;default:(0,a.handle)([t])}return Promise.resolve()};var a=r(42871),n=r(95303)},96985:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t,a=e.shift();a.id="1";var n=r(76022).default,{protoVersion:i,binVersion:h,features:_}=a;if(i){d.default.setVersion(i);var m=d.default.setFeatures(_);t=!!m.KEY_PARTICIPANT,n.setVersion(i,h,_&&_.FLAGS)}if(a.initial){d.default.setPlatform(a.platform),(0,l.setLogoutToken)(a.browserToken),a.hasOwnProperty("is24h")&&o.default.setIs24Hour(a.is24h);var g=a.ref,v=a.serverToken,E=a.clientToken,y=a.connected;g&&y&&v&&(0,l.setRefTok)(g,v),(0,l.setLoginTokens)({client:E,server:v});var S=a.secret?n.setSharedSecret(a.secret):Promise.resolve();return Promise.all([(0,c.requireContactCollection)(),S]).then((([e])=>{if("true"!==a.isResponse&&f.save(),"iw"===a.lg&&(a.lg="he"),a.wid){var t=a.wid;(0,l.setMe)(t),u.default.trigger("me_ready"),a.pushname&&(u.default.pushname=a.pushname,(0,l.setPushname)(a.pushname)),e.gadd(t)}u.default.set(a)}))}return u.default.connected&&t&&(__LOG__(2)(p(),String(d.default.supportsFeature(d.default.F.KEY_PARTICIPANT))),s.default.hardRefresh()),u.default.set(a),Promise.resolve()};var i=n(r(19976)),s=n(r(61867)),o=n(r(19899)),u=n(r(52737)),l=r(95595),d=n(r(18120)),c=r(63925),f=a(r(8292));function p(){var e=(0,i.default)(["models:Conn:participantChange:to:",""]);return p=function(){return e},e}},75001:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.shift();if(Array.isArray(t)){var r=e.shift();!function(e,t){var r=t&&"remove"===t.missing?(0,l.getContactsToRemove)(e):[];(0,d.mungePSAContact)(e),s.default.add(e,{merge:!0}),r.forEach((e=>{e.unset("name"),e.unset("shortName")})),t&&t.checksum&&(s.default.setChecksum(t.checksum),__LOG__(2)(h(),t.checksum));__LOG__(2)(p(),e.map((e=>e.id)).join())}(t,r)}else"preempt"===t.cmd?function(e){(0,d.mungePSAContact)(e.response),s.default.add(e.response,{merge:!0}),e.checksum&&(s.default.setChecksum(e.checksum),__LOG__(2)(f(),e.checksum));s.default.trigger(i.default.COLLECTION_HAS_SYNCED,{count:e.response.length,binarySize:e.binarySize})}(t):"frequent"===t.type?function(e){var t;delete e.type,t=u.default.supportsFeature(u.default.F.MD_BACKEND)?(0,o.setFrequent)(e):Promise.resolve();t.then((()=>{s.default.updateFrequentContacts(e)}))}(t):"sidelist"===t.type?function(e){var{notification:t,action:r,hash:a}=e,n=s.default.resolveWidsFromHash(a);if(!n)return;"business"===t&&"profile"===r&&n.forEach((e=>{var t=s.default.get(e);if(t)t.businessProfile&&t.businessProfile.markStale();else{var r=s.default.getUserCount(),n=s.default.contactHashLength();__LOG__(4,void 0,new Error,!0)(c(),a,r,n),SEND_LOGS("Stale wid in contact hash index")}}))}(t):__LOG__(3)(_(),JSON.stringify(t))};var n=a(r(19976)),i=a(r(50935)),s=a(r(7470)),o=r(95402),u=a(r(18120)),l=r(87354),d=r(84748);function c(){var e=(0,n.default)(["Hash: "," Users: ",", Hashes: ",""]);return c=function(){return e},e}function f(){var e=(0,n.default)(["Store:Contact:handle update checksum ",""]);return f=function(){return e},e}function p(){var e=(0,n.default)(["handle:Contact updated ",""]);return p=function(){return e},e}function h(){var e=(0,n.default)(["handle:Contact update checksum ",""]);return h=function(){return e},e}function _(){var e=(0,n.default)(["handle:Contact unknown: ",""]);return _=function(){return e},e}},9383:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){if(!Array.isArray(e))return __LOG__(4,void 0,new Error,!0)(_()),void SEND_LOGS("ws2:invalid-msg");var t=e.shift();switch(t){case"Blocklist":return void(0,i.default)(e);case"Contact":return void(0,l.default)(e);case"Props":case"ServerProps":return void r(72424).default.handle(e);case"Location":case"LiveLocation":return void r(84383).default.handle(e);case"Chat":return void(0,s.default)(e);case"Msg":return void(0,d.default)(e);case"Stream":return void(0,p.default)(e);case"Conn":return void(0,u.default)(e);case"Cmd":return void(0,o.default)(e);case"Presence":return void(0,f.default)(e);case"MsgInfo":return void(0,c.default)(e);case"BusinessProfile":return void r(89216).default.handle(e);case"GroupMetadata":return void r(99922).default.handle(e);case"Label":return void r(23539).default.handle(e);case"QuickReply":return void r(75537).default.handle(e);case"Call":return void r(79504).default.handle(e);case"Mute":return void r(85059).default.handle(e);case"Status":return void r(76019).default.handle(e);case"StatusV3":return void r(57185).default.handle(e);default:__LOG__(4,void 0,new Error,!0)(h(),t),SEND_LOGS("ws2: Invalid type received")}};var n=a(r(19976)),i=a(r(46554)),s=a(r(79626)),o=a(r(96898)),u=a(r(96985)),l=a(r(75001)),d=a(r(67964)),c=a(r(95501)),f=a(r(24733)),p=a(r(58251));function h(){var e=(0,n.default)(["ws2: Invalid type received: ",""]);return h=function(){return e},e}function _(){var e=(0,n.default)(["ws2: Invalid message, not an array"]);return _=function(){return e},e}},67964:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function([e]){var t=r(58885).default;function a(){return n.apply(this,arguments)}function n(){return(n=(0,s.default)((function*(r,a){var n;n=_.default.isStatusV3(e.broadcast)?new h.default({from:e.from,to:e.broadcast,id:a,selfDir:e.self||"out"}):new h.default({from:e.from,to:r,id:a,participant:e.participant,selfDir:e.self||"out"});var i=t.get(n);i?yield(0,u.updateMsgAck)(i,e.broadcast,{from:e.from,to:r,ack:e.ack,t:e.t}):(__LOG__(2)(g()),t.preAck[n]=e)}))).apply(this,arguments)}if("ack"===e.cmd){var i=[e.to];if(_.default.isBroadcast(e.to)&&e.ack===c.default.ACK.SENT){var T=p.default.get(e.to);T&&Array.prototype.push.apply(i,(0,o.default)(T.participants.toArray(),"id"))}var b=i.map((t=>a(t,e.id)));return Promise.all(b)}if("acks"===e.cmd){var A=e.id.map((t=>a(e.to,t)));return Promise.all(A)}if(e.msg){if(!(e.chat instanceof _.default))return Promise.resolve();var C="update"===e.meta.add;return _.default.isStatusV3(e.chat)&&!r(57185).default.handleUpdate(e.msg,e.meta.checksum,C)?Promise.resolve():(e.msg.recvFresh=!0,e.msg.isNewMsg=!0,t.processMultipleMessages(e.chat,[e.msg],{add:"after",update:C,isHistory:!1}).catchType(f.LogoutDrop,(()=>{})).catch((t=>{__LOG__(4,void 0,new Error,!0)(S(),String(e.msg.id),String(e.chat),t.name,t.message,t.stack),SEND_LOGS("msg_handler: error storing/processing single message")})))}if(e.msgs){var P=e.msgs.length;if(!P)return Promise.resolve();var O=null;if(!(e.chat instanceof _.default))return Promise.resolve();var w=e.meta;w.isHistory=!0,"unread"===w.add&&(w.firstUnreadKey=new h.default({fromMe:w.unreadFromMe,remote:e.chat,id:w.unreadId,participant:w.unreadParticipant}),O=new l.default);for(var M=0;M<P;M++){e.msgs[M].invis=!0}return d.default.platform!==d.PLATFORMS.IPHONE&&d.default.platform!==d.PLATFORMS.SMBI||t.trigger(c.default.COLLECTION_HAS_SYNCED),t.trigger("handle:msg_history",{count:e.msgs.length,binarySize:e.binarySize}),t.processMultipleMessages(e.chat,e.msgs,w,O).catchType(f.LogoutDrop,(()=>{})).catch((t=>{__LOG__(4,void 0,new Error,!0)(y(),P,String(e.chat),t.name,t.message,t.stack),SEND_LOGS("msg_handler: error storing/processing multiple messages")}))}if(e.recent){var I=e.meta,R=e.binarySize;return delete e.recent,delete e.meta,delete e.binarySize,t.trigger(c.default.COLLECTION_HAS_SYNCED,{count:Object.keys(e).length,binarySize:R}),I.isHistory=!0,Promise.all(Object.keys(e).map((r=>{var a;try{a=(0,m.createWid)(r)}catch(e){return Promise.resolve()}var n=e[r];n.invis=!0;var i="last"===I.add&&I.resume?new l.default:null;t.processMultipleMessages(a,[n],I,i).catchType(f.LogoutDrop,(()=>{})).catch((()=>{__LOG__(4,void 0,new Error,!0)(E()),SEND_LOGS("msg_handler: error storing recent messages")}))})))}return __LOG__(2)(v()),Promise.resolve()};var i=n(r(19976)),s=n(r(52954)),o=n(r(16760)),u=r(27857),l=n(r(90980)),d=a(r(52737)),c=n(r(50935)),f=r(19741),p=n(r(99922)),h=n(r(77865)),_=n(r(68384)),m=r(75637);function g(){var e=(0,i.default)(["Msg:out of order ack"]);return g=function(){return e},e}function v(){var e=(0,i.default)(["************** Msg else clause. something strange is going on"]);return v=function(){return e},e}function E(){var e=(0,i.default)(["Assertion failed!"]);return E=function(){return e},e}function y(){var e=(0,i.default)(["Msgs count: "," Chat: "," Error: ",", message: ",", stack: ",""]);return y=function(){return e},e}function S(){var e=(0,i.default)(["Msg: "," chat: "," Error: ",", message: ",", stack: ",""]);return S=function(){return e},e}},95501:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.shift(),{from:r,to:a,ack:i,participant:s,t:o}=t;switch(t.cmd){case"ack":n.default.updateInfo(t.id,r,a,i,s,o);break;case"acks":t.id.forEach((e=>{n.default.updateInfo(e,r,a,i,s,o)}))}};var n=a(r(92313))},24733:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.shift();return(0,n.default)(t)};var n=a(r(53603))},58251:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){switch(e[0]){case"asleep":break;case"killsw":i.default.killServiceWorker();break;case"update":case"update_desktop":break;default:__LOG__(3)(s(),e[0])}};var n=a(r(19976)),i=a(r(78135));function s(){var e=(0,n.default)(["Stream:handle unknown cmd ",""]);return s=function(){return e},e}},11824:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.setBridge=function(e){i=e},t.getBridge=function(){return(0,n.default)(i,"_bridge")},t.isConnectedToPage=function(){return true};var n=a(r(61941)),i=null},13772:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeBridge=function(){return new a.DynamicRouter};var a=r(19784)},61370:(e,t,r)=>{"use strict";var a=r(14859);t.Z=void 0;var n=r(95595),i=a(r(76936)),s=a(r(34391)),o=a(r(15410)),u={whoAmI(){var e=(0,n.getMaybeMeUser)().toString();return Promise.resolve(e)},logImpl:(e,t,r,a,n)=>(o.default.logImpl(e,t,r,a,n),Promise.resolve()),initFromStorage:()=>s.default.invoke("initFromStorage",[]),setLogoutState:e=>(i.default.isLogoutInProgress=e,s.default.invoke("setLogoutState",[e])),deleteDbEncKeyCache:()=>s.default.invoke("deleteDbEncKeyCache",[]),initDatabaseEncnKey:e=>s.default.invoke("initDatabaseEncnKey",[e]),generateFinalDbEncryptionAndFtsKey:e=>s.default.invoke("generateFinalDbEncryptionAndFtsKey",[e])};t.Z=u},96542:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=new MessageChannel,r=t.port1,a=t.port2;o.default.respondTo(r),n.default.init(),s.default.setConnectionManager(n.default),n.default.connectVia(r),e.postMessage((0,i.buildHandshakePayload)(a),[a])};var n=a(r(27620)),i=r(73141),s=a(r(34391)),o=a(r(52929))},7241:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(96542)),i=new(a(r(79034)).default);(0,n.default)(i);var s=i;t.default=s},27620:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(47677)),i=a(r(61941));var s=new class{init(){return this._promise||(this._promise=new Promise((e=>{this._resolver=e})).timeout(5e3)),this._promise}isConnected(){return null!=this._port}getPort(){return this._port}waitForConnection(){return(0,i.default)(this._promise,"ConnectionManager Initialization Promise")}connectVia(e){if(this.isConnected())throw new Error("Connection already established");(0,n.default)(this._resolver,"ConnectionManager not initialized"),this._port=e,this._resolver()}};t.default=s},76936:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={isLogoutInProgress:!1}},34391:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(47677)),i=r(1800),s=r(97110),o=a(r(61941)),u=r(44012);var l=new class{constructor(){this._pending=new Map,this._onResponseReceipt=e=>{var t=(0,u.unwrapResponsePayload)(e.data);if(null!=t){var{invocationId:r,result:a}=t;if(this._pending.has(r)){var{resolve:n}=(0,o.default)(this._pending.get(r),"this._pending.get(invocationId)");n(a),this._pending.delete(r)}}}}setConnectionManager(e){this._conn=e,e.waitForConnection().then((()=>{var t=(0,o.default)(e.getPort(),"Port obtained from ConnectionManager after connection");t.addEventListener("message",this._onResponseReceipt),t.start()}))}invoke(e,t){return(0,n.default)(this._conn,"Connection has not been inited"),this._conn.waitForConnection().then((()=>{(0,n.default)(this._conn,"Connection has not been inited");var r=(0,o.default)(this._conn.getPort(),"Port obtained from ConnectionManager after connection"),a=(0,s.genInvocationId)();return r.postMessage((0,i.buildInvocationPayload)({invocationId:a,method:e,args:t})),new Promise(((e,t)=>{this._pending.set(a,{resolve:e,reject:t})}))}))}};t.default=l},52929:(e,t,r)=>{"use strict";var a=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(1800),i=a(r(29458)),s=r(44012);var o=new class{constructor(){this._onMessage=(e,t)=>{var r=t.data,a=(0,n.unwrapInvocationPayload)(r);if(null!=a){var{method:o,args:u,invocationId:l}=a;i.get()[o](...u).then((t=>{e.postMessage((0,s.buildResponsePayload)(l,t))}))}}}respondTo(e){e.addEventListener("message",(t=>this._onMessage(e,t))),e.start()}};t.default=o},97110:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.genInvocationId=function(){return r++},t.extractInvocationId=function(e){if(null!=e&&"number"==typeof e)return e};var r=1},29458:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.set=function(e){n=e},t.get=u,t.sendLogs=function(){throw new Error("Not yet implemented")},t.log=void 0;var n,i=a(r(26890)),s=a(r(1985)),o=a(r(61941));function u(){return(0,o.default)(n,"InvocationInterface was not inited")}var l=(0,s.default)(((e,t=!1,r,a,n)=>(s,...o)=>{var l,d=(0,i.default)(s,o,!t);return r&&(l={name:r.name,stack:r.stack}),u().logImpl(e,d,l,a,n),d}),((e,t,r,a,n)=>r||n?null:String(e)+String(Boolean(t))+String(Boolean(a))));t.log=l},73141:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.buildHandshakePayload=function(e){return{__command:i.HANDSHAKE_COMMAND,__port:e}},t.extractPortFromHandshakePayload=function(e){if(null!=e&&null!=e.__command&&e.__command===i.HANDSHAKE_COMMAND){if(null!=e.__port)return(0,n.default)(e.__port instanceof MessagePort,"Malformed connection payload"),e.__port}};var n=a(r(47677)),i=r(84624)},1800:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.buildInvocationPayload=function({invocationId:e,method:t,args:r}){return{__id:e,__command:s.INVOCATION_COMMAND,__method:t,__args:r}},t.unwrapInvocationPayload=function(e){if(null!=e&&e.__command===s.INVOCATION_COMMAND){(0,n.default)(e.__id,"Invocation ID missing");var t=(0,i.extractInvocationId)(e.__id);(0,n.default)(null!=t&&e.__method&&"string"==typeof e.__method&&e.__id&&e.__args&&Array.isArray(e.__args),"Malformed invocation message");var r=e,a=r.__method,o=r.__args;return{method:a,args:o,invocationId:t}}};var n=a(r(47677)),i=r(97110),s=r(84624)},44012:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.buildResponsePayload=function(e,t){return{__id:e,__command:s.RESPONSE_COMMAND,__result:t}},t.unwrapResponsePayload=function(e){if(null!=e&&e.__command===s.RESPONSE_COMMAND){(0,n.default)(null!=e.__id,"Invocation ID missing");var t=(0,i.extractInvocationId)(e.__id);return(0,n.default)(null!=t&&e.hasOwnProperty("__result"),"Malformed response message"),{result:e.__result,invocationId:t}}};var n=a(r(47677)),i=r(97110),s=r(84624)},84624:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RESPONSE_COMMAND=t.INVOCATION_COMMAND=t.HANDSHAKE_COMMAND=void 0;t.HANDSHAKE_COMMAND="@@handshake";t.INVOCATION_COMMAND="@@invoke";t.RESPONSE_COMMAND="@@response"},1867:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(52954)),i=a(r(70417)),s=a(r(61941)),o=a(r(13818));t.default=class{constructor(e,t){this._concurrency=e,this._groupLimits=t,this._runningTasksByGroup=new Map,this._enqueuedTasksByGroup=new Map}enqueue(e,t){var r,a,s,o=new Promise(((e,t)=>{r=e,a=t}));return this._doEnqueue((0,i.default)((0,i.default)({},t),{},{run:(s=(0,n.default)((function*(){try{var t=yield e();r(t)}catch(e){a(e)}})),function(){return s.apply(this,arguments)})})),this._runTasks(),o}_doEnqueue(e){this._getOrCreatePriorityQueueForGroup(e.group).push(e)}_doDequeue(){return this._getHighestPriorityAmongGroups()}_runTasks(){for(;this._getRunningTasksCount()<this._concurrency;){var e=this._doDequeue();if(null==e)break;this._runTask(e)}}_runTask(e){var t=this;return(0,n.default)((function*(){var{run:r,signal:a,group:n}=e,i=t._getRunningTasksForGroup(n);if(null==a?void 0:a.aborted)setTimeout(t._runTasks.bind(t),0);else{i.add(e);try{yield r()}finally{i.delete(e),t._runTasks()}}}))()}_getHighestPriorityAmongGroups(){var e,t;for(var r of this._enqueuedTasksByGroup.values()){var a=r.peek();a&&(this._isFullOfGroup(a.group)||(!t||t.priority<a.priority)&&(t=r))}return null===(e=t)||void 0===e?void 0:e.pull()}_getRunningTasksCount(){var e=0;for(var t of this._runningTasksByGroup.values())e+=t.size;return e}_getRunningTasksForGroup(e){if(!this._runningTasksByGroup.has(e)){var t=new Set;return this._runningTasksByGroup.set(e,t),t}return(0,s.default)(this._runningTasksByGroup.get(e),"this._runningTasksByGroup.get(group)")}_isFullOfGroup(e){var t=this._runningTasksByGroup.get(e);return null!=t&&t.size>=this._getLimitForGroup(e)}_getOrCreatePriorityQueueForGroup(e){if(!this._enqueuedTasksByGroup.has(e)){var t=new o.default((e=>-e.priority));this._enqueuedTasksByGroup.set(e,t)}return(0,s.default)(this._enqueuedTasksByGroup.get(e),"this._enqueuedTasksByGroup.get(group)")}_getLimitForGroup(e){var t=this._groupLimits[e];return null==t?1/0:t}}},87925:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(70417)),i=a(r(80521)),s=a(r(31429)),o=r(76295).Z;self.URL=self.URL||self.webkitURL,self.AudioContext=self.AudioContext||self.webkitAudioContext,self.requestFileSystem=self.requestFileSystem||self.webkitRequestFileSystem;var u=(0,n.default)({REQUIRED_BROWSER_APIS:{getRandomValues:!(!self.crypto||!self.crypto.getRandomValues),subtleCrypto:!(!self.crypto||!self.crypto.subtle&&!self.crypto.webkitSubtle),localstorage:!!i.default,sessionstorage:!!s.default,url:!!self.URL,websocket:!!self.WebSocket,worker:!!self.Worker},BROWSER_TYPE:{CHROME:"chrome",CHROMIUM:"chromium",FIREFOX:"firefox",SAFARI:"safari",IE:"ie",OPERA:"opera",EDGE:"edge"},BROWSER_LINK:{CHROME:'<a href="https://www.google.com/chrome">Google Chrome</a>',FIREFOX:'<a href="http://www.firefox.com">Mozilla Firefox</a>',OPERA:'<a href="http://www.opera.com">Opera</a>'},OS_TYPE:{WINDOWS:"windows",MAC:"mac os",CHROMEOS:"chromium os"},LATEST_HASH:"57e9f5139e5c325e7954b91c8b8e6aef566bd306",VERSION:{p:Number("2"),s:Number("2119"),t:Number("6")},VERSION_BASE:"2.2119.6",VERSION_STR:"2.2119.6",DYN_ORIGIN:"https://web.whatsapp.com/",PP_URL:"https://web.whatsapp.com/pp",LOGOUT_URL:"https://web.whatsapp.com/logout",WAM_URL:"https://web.whatsapp.com/wam",GROUP_DEFAULT_ICON:r(72383),USER_DEFAULT_ICON:r(35616),NOTIFICATION_TONE_PATH:r(31472),OUTGOING_MESSAGE_TONE_PATH:r(63946),PTT_MIDDLE_TONE_PATH:r(91356),PTT_END_TONE_PATH:r(16653),DRAG_TYPE_FILE:"Files",KEY_LOCAL_TAKEOVER_OK:"local-takeover-ok",SCROLL_FUDGE:100,PERMISSION_ALLOWED:"granted",PERMISSION_DEFAULT:"default",PERMISSION_DENIED:"denied",QR_EDGE:264,NUX:{SAFARI_LIMITED_SUPPORT:"safari_limited_support",REVOKE_LEGAL_DISCLAIMER_NUX:"revoke_legal_disclaimer_nux",MESSENGER_ROOM_DIALOG_NEW:"messenger_room_dialog_new",MESSENGER_ROOM_DIALOG_RETURNING:"messenger_room_dialog_returning",MESSENGER_ROOM_DIALOG_FROM_CHATLIST:"messenger_room_dialog_from_chatlist",MESSENGER_ROOM_DIALOG_FROM_ATTACH_DROPDOWN:"messenger_room_dialog_from_attach_dropdown",EPHEMERAL:"ephemeral",EPHEMERAL_VIEW_ONCE:"ephemeral_view_once",ARCHIVE:"archive"},TEXTSIZE_CLASS_MAP:[{scale:-1,classname:"textsize-small"},{scale:-2,classname:"textsize-xsmall"},{scale:-3,classname:"textsize-xxsmall"},{scale:1,classname:"textsize-large"},{scale:2,classname:"textsize-xlarge"},{scale:3,classname:"textsize-xxlarge"}],LIST_HEIGHT_TEXTSIZE_MAP:[{scale:-1,height:64},{scale:-2,height:58},{scale:-3,height:52},{scale:1,height:72},{scale:2,height:72},{scale:3,height:72}],MSG_FOCUS_SCROLL_ANIMATION_DURATION:400,WAM_PLATFORM:"WEB",FLB_PLATFORM:"web",APP_ID:"undefined"},o);t.default=u},76295:(e,t)=>{"use strict";t.Z=void 0;var r={CAPABILITY_URL:"https://web.whatsapp.com/browsers.html",STATUS_URL:"https://web.whatsapp.com/status.json",CHECK_UPDATE_URL:"https://web.whatsapp.com/check-update",NOTICE_CONTENT_ENDPOINT_URL:"https://www.whatsapp.com/user-notice/v1/",COOKIE_DOMAIN:".web.whatsapp.com",TICKET_URL:"https://web.whatsapp.com/web-contact-us",GROUP_INVITE_URL:"https://web.whatsapp.com/invite/icon/",GROUP_V4_INVITE_ICON_URL:"https://web.whatsapp.com/invite/v4/icon/",LARGE_EMOJI_URL:"https://web.whatsapp.com/img/",PP_TOK:"/pp",PP_REF:"/pp",UPLOAD_TO_CLB:1,FLAVOR_TAGS:!1,WEB_SOCKET_URL:"wss://web.whatsapp.com/ws",CHATD_WEB_SOCKET_URL:"wss://web.whatsapp.com/ws/chat",LOG_SIZE_ELECTRON:14999,LOG_SIZE_WEB:4999,MEMORY_METRIC_INTERVAL:9e5,MARK_TRANSLATIONS:!1,WAM_ENV:"PROD",WRITE_TO_CONSOLE:!1};t.Z=r},50935:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(70417)),i=a(r(87925)),s=a(r(68859)),o=(0,n.default)((0,n.default)({},s.default),i.default);t.default=o},10792:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r={KEYBOARD_EVENT_KEY_VALUE:{UNIDENTIFIED:"Unidentified",ALT:"Alt",ALT_GRAPH:"AltGraph",CAPS_LOCK:"CapsLock",CONTROL:"Control",FN:"Fn",FN_LOCK:"FnLock",HYPER:"Hyper",META:"Meta",NUM_LOCK:"NumLock",SCROLL_LOCK:"ScrollLock",SHIFT:"Shift",SUPER:"Super",SYMBOL:"Symbol",SYMBOL_LOCK:"SymbolLock",OS:"OS",ENTER:"Enter",TAB:"Tab",SPACE:" ",ARROW_DOWN:"ArrowDown",ARROW_LEFT:"ArrowLeft",ARROW_RIGHT:"ArrowRight",ARROW_UP:"ArrowUp",LEFT:"Left",RIGHT:"Right",UP:"Up",DOWN:"Down",END:"End",HOME:"Home",PAGE_DOWN:"PageDown",PAGE_UP:"PageUp",BACKSPACE:"Backspace",CLEAR:"Clear",COPY:"Copy",CR_SEL:"CrSel",CRSEL:"Crsel",CUT:"Cut",DELETE:"Delete",ERASE_EOF:"EraseEof",EX_SEL:"ExSel",EXSEL:"Exsel",INSERT:"Insert",PASTE:"Paste",REDO:"Redo",UNDO:"Undo"}};t.default=r},68859:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r={ARCHIVE_NUX_MAX_VIEWS:3,IMG_THUMB_MAX_EDGE:100,DOC_THUMB_MAX_EDGE:480,VIDEO_THUMB_MAX_EDGE:480,MAX_PORTRAIT_MEDIA_CAPTION_LENGTH:200,MAX_FILES:30,FREQUENTLY_FORWARDED_SENTINEL:127,MAX_SMB_LABEL_COUNT:20,DEFAULT_SMB__NEW_LABEL_COLOR:"#d6d7d7",FB_CLB_TOKEN:"1063127757113399|745146ffa34413f9dbb5469f5370b7af",FB_CLB_CHECK_URL:"https://crashlogs.whatsapp.net/wa_fls_upload_check",FB_CLB_URL:"https://crashlogs.whatsapp.net/wa_clb_data",FAKE_USER_AGENT:"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/60.0.3112.113 Safari/537.36",G_MAPS_DIR_URL:"https://maps.google.com/maps/dir",G_MAPS_IMG_URL:"https://maps.googleapis.com/maps/api/staticmap",G_MAPS_SEARCH_URL:"https://maps.google.com/maps/search",G_MAPS_URL:"https://maps.google.com/maps",G_MAPS_DARK_MODE_STYLE:"style=element:geometry%7Ccolor:0x212121&style=element:labels.icon%7Cvisibility:off&style=element:labels.text.fill%7Ccolor:0x757575&style=element:labels.text.stroke%7Ccolor:0x212121&style=feature:administrative%7Celement:geometry%7Ccolor:0x757575&style=feature:administrative.country%7Celement:labels.text.fill%7Ccolor:0x9e9e9e&style=feature:administrative.land_parcel%7Cvisibility:off&style=feature:administrative.locality%7Celement:labels.text.fill%7Ccolor:0xbdbdbd&style=feature:poi%7Celement:labels.text.fill%7Ccolor:0x757575&style=feature:poi.park%7Celement:geometry%7Ccolor:0x181818&style=feature:poi.park%7Celement:labels.text.fill%7Ccolor:0x616161&style=feature:poi.park%7Celement:labels.text.stroke%7Ccolor:0x1b1b1b&style=feature:road%7Celement:geometry.fill%7Ccolor:0x2c2c2c&style=feature:road%7Celement:labels.text.fill%7Ccolor:0x8a8a8a&style=feature:road.arterial%7Celement:geometry%7Ccolor:0x373737&style=feature:road.highway%7Celement:geometry%7Ccolor:0x3c3c3c&style=feature:road.highway.controlled_access%7Celement:geometry%7Ccolor:0x4e4e4e&style=feature:road.local%7Celement:labels.text.fill%7Ccolor:0x616161&style=feature:transit%7Celement:labels.text.fill%7Ccolor:0x757575&style=feature:water%7Celement:geometry%7Ccolor:0x000000&style=feature:water%7Celement:labels.text.fill%7Ccolor:0x3d3d3d",FB_LEGAL_TERMS_URL:"https://www.facebook.com/legal/terms",FB_COMMERCE_POLICY_URL:"https://www.facebook.com/policies/commerce",WA_COMMERCE_POLICY_URL:"https://www.whatsapp.com/policies/commerce-policy",NOTIFICATION_PROMPT_DELAY:1e4,PTT_PLAYBACK_DELAY:400,NOTIFICATION_TIMEOUT:5e3,CALL_NOTIFICATION_TIMEOUT:45e3,IDLE_TIMEOUT:6e4,IDLE_TIMEOUT_WAIT:78e4,SEARCH_ZOOM:17,SEND_UNAVAILABLE_WAIT:15e3,SEND_PAUSED_WAIT:2500,CLEAR_CHAT_DIRTY_WAIT:2500,LOG_UPLOAD_INTERVAL:36e5,REVOKE_WINDOW:4096,WAM_ROTATE_INTERVAL:300,ALBUM_DIFF_INTERVAL:600,MAX_TXT_MSG_SIZE:65536,INITIAL_PAGE_SIZE:768,FREQUENTLY_FORWARDED_INITIAL_PAGE_SIZE:308,SUBSEQUENT_PAGE_SIZE:3072,OVERFLOWING_PAGE_THRESHOLD:.1,GROUP_DESCRIPTION_INFO_PANEL_TRUNC_LENGTH:100,GROUP_DESCRIPTION_LENGTH:0,INFO_DRAWER_MAX_ROWS:10,NUM_COLORS:20,FTS_MIN_CHARS:2,FTS_TTL:6e4,FTS_TYPING_DELAY:300,FTS_NUM_RESULTS:30,HSM_ASPECT_RATIO:1.91,TEMPLATE_DOC_MIME_TYPES:1,TEMPLATE_URL_START:64,TEMPLATE_URL_END:32,KEY_STORAGE_TEST:"storage_test",KEY_CLIENT_TOKEN:"WAToken1",KEY_SERVER_TOKEN:"WAToken2",KEY_SECRET:"WASecretKey",KEY_SECRET_BUNDLE:"WASecretBundle",KEY_SECURITY_NOTIFICATIONS:"WASecurityNotifications",KEY_BROWSER_ID:"WABrowserId",KEY_GEOCODER_LOCATION:"WAGeocoderLocation",KEY_GROUP_ASSIGNED_COLOR:"WAGroupAssignedColor",KEY_GMAPS_OVER_LIMIT:"WAGmapsOverLimit",KEY_GLOBAL_MUTE_SOUNDS:"WAGlobalSounds",KEY_OUTGOING_MESSAGE_SOUND:"WAOutgoingMessageSound",KEY_GLOBAL_MUTE_NOTIFICATIONS:"WAGlobalNotifications",KEY_GLOBAL_MUTE_IN_APP_NOTIFICATIONS:"WAGlobalInAppNotifications",KEY_GLOBAL_MUTE_PREVIEWS:"WAGlobalPreviews",KEY_GLOBAL_COLLAPSE_MUTED:"WAGlobalCollapseMuted",KEY_NOTIFICATION_SOUND:"WANotificationSound",KEY_LANG:"WALangPref",KEY_LAST_ACTIVE_EMOJI_TAB:"WALastActiveEmojiTab",KEY_LAST_SELECTED_COMPOSE_BOX_PANEL:"WALastActiveComposeBoxPanel",KEY_LAST_CHAT_MUTE_DURATION:"WALastChatMuteDuration",KEY_UNKNOWN_ID:"WAUnknownID",KEY_VERSION:"WAVersion",KEY_LOAD_RETRY_GENERATION:"WALoadRetryGeneration",KEY_WHATSAPP_MUTEX:"whatsapp-mutex",KEY_LAST_WID:"last-wid",KEY_LAST_WID_MD:"last-wid-md",KEY_SAVE_TO_CAMERA_ROLL:"save_to_camera_roll",KEY_SMB_LABEL_COLOR_PALETTE:"smb_label_color_palette",KEY_LAST_PUSHNAME:"last-pushname",KEY_PROTO_VERSION:"WAProtoVersion",KEY_PTT_PLAYBACK_RATE:"WAPttPlaybackRate",LAST_STATUS_USAGE:"last-status-usage",KEY_MD_OPTED_IN:"md-opted-in",KEY_MOBILE_PLATFORM:"mobile-platform",KEY_REMEMBER_ME:"remember-me",KEY_LOGOUT_TOKEN:"logout-token",KEY_OLD_LOGOUT_CREDS:"old-logout-cred",KEY_NO_TAKEOVER:"no-takeover",KEY_WHATSAPP_LS_VERSION:"ver",KEY_WAM_BUFFER:"wam-buffer",KEY_WAM_INFO:"wam-info",KEY_TIME_SPENT_EVENT:"WaTimeSpentEvent",KEY_VIDEO_VOLUME:"video-volume",KEY_VIDEO_MUTE:"video-mute",KEY_CONTACT_CHECKSUM:"contact-checksum",KEY_USER_PRIVACY_SETTINGS:"user-privacy-settings",KEY_IS_SMB:"is-smb",KEY_COMPOSE_CONTENTS_PREFIX:"compose-contents_",KEY_THEME:"theme",KEY_SYSTEM_THEME_MODE:"system-theme-mode",KEY_ABPROPS:"abprops",KEY_HISTORY_SYNC_EARLIEST_DATE:"history-sync-earliest-date",KEY_SYNCD_DISABLED_DUE_TO_FATAL:"syncd_disabled_due_to_fatal",KEY_SYNCD_FIRST_CLEAR_OR_DELETE:"syncd-first-clear-or-delete",COOKIE_REF:"ref",COOKIE_TOK:"tok",PAGE_SIZE:50,MSG_PRELOAD_THRESHOLD:20,MEDIA_QUERY_LIMIT:50,MIN_PIC_SIDE:192,MAX_PIC_SIDE:640,PROF_PIC_THUMB_SIDE:96,MAX_CAPTION_LENGTH:1024,MAX_CART_MESSAGE_LENGTH:1024,MAX_PRODUCT_SUBTITLE_LENGTH:70,MAX_REPLY_PRODUCT_TITLE_LENGTH:40,MAX_REPLY_PRODUCT_DESC_LENGTH:95,ALBUM_MIN_SIZE:4,ALBUM_MAX_SIZE:102,ALBUM_MAX_HEIGHT:168,ALBUM_PADDING:3,PRESENCE_COMPOSING_TIMEOUT:25e3,PRESENCE_RESEND_WAIT:1e4,MIMETYPE_OGG:"audio/ogg",IMAGE_MIMES:"image/*",WEBP_MIMES:"image/webp",VIDEO_MIMES:"video/mp4,video/3gpp,video/quicktime",KEY_LOG_CURSOR:"debugCursor",MAX_STATUS_LENGTH:139,MAX_PUSHNAME_LENGTH:25,DISP_TYPE:{CONVERSATION:"CONVERSATION",MSG_INFO:"MSG_INFO",STARRED_MSGS:"STARRED_MSGS",GALLERY:"GALLERY",REPLY_STAGE:"REPLY_STAGE",QUOTED_MSG:"QUOTED_MSG",CONTACT_CARD:"CONTACT_CARD",ORDER:"ORDER"},SEND_LOGS_MAX_EMAIL_LENGTH:320,SEND_LOGS_MAX_SUBJECT_LENGTH:50,SEND_LOGS_MIN_DESC_LENGTH:10,SEND_LOGS_MAX_DESC_LENGTH:500,SEND_LOGS_MAX_SCREENSHOTS:3,SEND_LOGS_MAX_SCREENSHOT_SIZE:10485760,CONTACT_US_MIN_DESC_LENGTH:10,CONTACT_US_MAX_DESC_LENGTH:5e3,ACK:{MD_DOWNGRADE:-7,INACTIVE:-6,CONTENT_UNUPLOADABLE:-5,CONTENT_TOO_BIG:-4,CONTENT_GONE:-3,EXPIRED:-2,FAILED:-1,CLOCK:0,SENT:1,RECEIVED:2,READ:3,PLAYED:4,PEER:5},ACK_STRING:{SENDER:"sender",DELIVERY:"delivery",READ:"read",PLAYED:"played",INACTIVE:"inactive"},RETRY:{VALIDATE_OLD_SESSION:2,MAX_RETRY:5},KEY_BUNDLE_TYPE:"",EDIT_ATTR:{REVOKE:7},DEVICE:{PRIMARY_DEVICE:0,PRIMARY_VERSION:0},BATTERY_LOW_THRESHOLD_1:15,BATTERY_LOW_THRESHOLD_2:5,BATTERY_DELAY:1e4,WAM_MAX_BUFFER_SIZE:5e4,SOCKET_STATE:{OPENING:"OPENING",PAIRING:"PAIRING",UNPAIRED:"UNPAIRED",UNPAIRED_IDLE:"UNPAIRED_IDLE",CONNECTED:"CONNECTED",TIMEOUT:"TIMEOUT",CONFLICT:"CONFLICT",UNLAUNCHED:"UNLAUNCHED",PROXYBLOCK:"PROXYBLOCK",TOS_BLOCK:"TOS_BLOCK",SMB_TOS_BLOCK:"SMB_TOS_BLOCK",DEPRECATED_VERSION:"DEPRECATED_VERSION"},SOCKET_STREAM:{DISCONNECTED:"DISCONNECTED",SYNCING:"SYNCING",RESUMING:"RESUMING",CONNECTED:"CONNECTED"},COLLECTION_HAS_SYNCED:"collection_has_synced",NEW_MSG_SENT:"new_msg_sent",DIAGNOSTIC_DELAY:18e3,ONE_BY_ONE_TRANS_GIF:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",DEFAULT_CHAT_WALLPAPER:"default_chat_wallpaper",L10N_PRIORITY:{SAVED:6,PHONE:5,PREVIOUS:4,URL:3,BROWSER:2,DEFAULT:1},RENDER_CURSOR:{RECENT_AT_TOP:"recent_at_top",RECENT_AT_BOTTOM:"recent_at_bottom",CONVERSATION:"conversation",GROUP_CONVERSATION:"group_conversation",STARRED_DRAWER:"starred_drawer"},SECURITY_LINK:"https://www.whatsapp.com/security/",SMB_TOS_LEARN_MORE_LINK:"https://www.whatsapp.com/legal/small-business-terms/",SERVER_WID:"server@c.us",PSA_WID:"0@c.us",STATUS_WID:"status@broadcast",OFFICIAL_BIZ_WID:"16505361212@c.us",VISIBILITY:{ABOVE:"above",VISIBLE:"visible",BELOW:"below"},VIDEO_STREAM_URL:"/stream/video",SPELL_CHECK_SKIP_WORDS:{en_us:new Set(["ain","couldn","didn","doesn","hadn","hasn","mightn","mustn","needn","oughtn","shan","shouldn","wasn","weren","wouldn","Ain","Couldn","Didn","Doesn","Hadn","Hasn","Mightn","Mustn","Needn","Oughtn","Shan","Shouldn","Wasn","Weren","Wouldn"]),en_gb:new Set(["ain","couldn","didn","doesn","hadn","hasn","mightn","mustn","needn","oughtn","shan","shouldn","wasn","weren","wouldn","Ain","Couldn","Didn","Doesn","Hadn","Hasn","Mightn","Mustn","Needn","Oughtn","Shan","Shouldn","Wasn","Weren","Wouldn"]),en:new Set(["ain","couldn","didn","doesn","hadn","hasn","mightn","mustn","needn","oughtn","shan","shouldn","wasn","weren","wouldn","Ain","Couldn","Didn","Doesn","Hadn","Hasn","Mightn","Mustn","Needn","Oughtn","Shan","Shouldn","Wasn","Weren","Wouldn"])},GROUP_INVITE_LINK_URL:"https://chat.whatsapp.com/",GROUP_SETTING_TYPE:{ANNOUNCEMENT:"announcement",RESTRICT:"restrict",NO_FREQUENTLY_FORWARDED:"no_frequently_forwarded",EPHEMERAL:"ephemeral"},GROUP_SETTING_TO_METADATA:{announcement:"announce",restrict:"restrict",no_frequently_forwarded:"noFrequentlyForwarded",ephemeral:"ephemeralDuration"},L10N:{DEFAULT:"en"},EMOJI:{BUCKET_SIZE:25,CATEGORIES:{SMILEYS_PEOPLE:"SMILEYS_PEOPLE",ANIMALS_NATURE:"ANIMALS_NATURE",FOOD_DRINK:"FOOD_DRINK",ACTIVITY:"ACTIVITY",TRAVEL_PLACES:"TRAVEL_PLACES",OBJECTS:"OBJECTS",SYMBOLS:"SYMBOLS",FLAGS:"FLAGS"},CATEGORY_MAPPING:{"Smileys & People":"SMILEYS_PEOPLE","Animals & Nature":"ANIMALS_NATURE","Food & Drink":"FOOD_DRINK",Activity:"ACTIVITY","Travel & Places":"TRAVEL_PLACES",Objects:"OBJECTS",Symbols:"SYMBOLS",Flags:"FLAGS"},ORDERED_CATEGORY_IDS:["SMILEYS_PEOPLE","ANIMALS_NATURE","FOOD_DRINK","ACTIVITY","TRAVEL_PLACES","OBJECTS","SYMBOLS","FLAGS"],EMOJI_TYPE:{APPLE:"APPLE",WHATSAPP:"WHATSAPP"},LARGE_EMOJI_BASE_PATH:"/img",LARGE_EMOJI_ELECTRON_BASE_PATH:"img",EMOJI_SPRITES_BASE_PATH:"/img",EMOJI_SPRITES_ELECTRON_BASE_PATH:"img"},SYSTEM_MESSAGE_TYPES:["notification","notification_template","group_notification","gp2","broadcast_notification","e2e_notification","call_log","protocol"],MSG_TYPE:{NOTIFICATION:"notification",NOTIFICATION_TEMPLATE:"notification_template",GROUP_NOTIFICATION:"group_notification",GP2:"gp2",BROADCAST_NOTIFICATION:"broadcast_notification",E2E_NOTIFICATION:"e2e_notification",CALL_LOG:"call_log",PROTOCOL:"protocol",CHAT:"chat",LOCATION:"location",PAYMENT:"payment",VCARD:"vcard",CIPHERTEXT:"ciphertext",MULTI_VCARD:"multi_vcard",REVOKED:"revoked",OVERSIZED:"oversized",GROUPS_V4_INVITE:"groups_v4_invite",HSM:"hsm",TEMPLATE_BUTTON_REPLY:"template_button_reply",DEBUG:"debug",IMAGE:"image",VIDEO:"video",AUDIO:"audio",PTT:"ptt",STICKER:"sticker",DOCUMENT:"document",PRODUCT:"product",ORDER:"order",LIST:"list",LIST_RESPONSE:"list_response",BUTTONS_RESPONSE:"buttons_response",UNKNOWN:"unknown"},TEMPLATE_BUTTON_SUBTYPE:{QUICK_REPLY:"quick_reply",CALL:"call",URL:"url"},ELECTRON_PREF:{LAST_SAVED_LOCATION:"lastSavedLocation",CONTENT_SETTINGS:"contentSettings"},TOUCHBAR_MAX_EMOJIS:8,VERIFIED_LEVEL:{UNKNOWN:0,LOW:1,HIGH:2},HOSTNAME:{YOUTUBE:"youtube.com",YOUTUBE_MOBILE:"m.youtube.com",YOUTUBE_SHORTENED:"youtu.be",INSTAGRAM:"instagram.com",STREAMABLE:"streamable.com",FACEBOOK:"facebook.com",FBWATCH:"fbwat.ch",FBWATCH_ALT:"fb.watch",LASSOVIDEOS:"lassovideos.com",LASSO_SHORTENED:"las.so",SHARECHAT:"sharechat.com"},WHATSAPP_ORIGIN:"https://whatsapp.com",SMB_SEARCH_FILTERS:{UNREAD:"unread",GROUP:"group",BROADCAST:"broadcast"},SMB_LABELS:{MAX_LABEL_LENGTH:100},PRODUCT_INQUIRY_TYPE:"product_inquiry",PRODUCT_LIST_ITEM_HEIGHT:96,LOADABLE_DELAY:200,TAB_ORDERS:{CHAT_STARRED_DRAWER:3,CHAT_LIST_SEARCH:3,CHAT_LIST:4,CHAT_CONTACT_LIST:4,CHAT_IMAGE_GALLERY:4,CHAT_SEARCH_MSG_LIST:4,PANEL_SEARCH_INPUT:5,COMPOSE_BOX_MENU_BUTTON:5,COMPOSE_BOX_INPUT:6,PTT_BUTTON:7,MESSAGE_LIST:8,CHAT_HEADER_BUTTON:9},SPEEDY_RESUME_MAX_CHATS:5e3,MEDIA_VIEWER:{ANIMATION_DURATION:500,CLOSE_ANIMATION_DURATION:200,ZOOM_IN_FACTOR:2},DEFAULT_THEME:"light",LAYOUT_2COLUMNS_MAX_WIDTH:1024,MUTE_ALWAYS_EXPIRATION_SENTINEL:-1,ANDROID_LABEL_COLOR_PALETTE:["#FF9485","#64C4FF","#FFD429","#DFAEF0","#99B6C1","#55CCB3","#FF9DFF","#D3A91D","#6D7CCE","#D7E752","#00D0E2","#FFC5C7","#93CEAC","#F74848","#00A0F2","#83E422","#FFAF04","#B5EBFF","#9BA6FF","#9368CF"],IPHONE_LABEL_COLOR_PALETTE:["#A62C71","#90A841","#C1A03F","#792138","#AE8774","#F0B330","#B6B327","#C69FCC","#8B6990","#FF8A8C","#54C265","#FF7B6B","#26C4DC","#57C9FF","#74676A","#7E90A3","#5696FF","#6E257E","#7ACBA5","#243640"],VOIP_LOG_COLOR:"#aa6627",VOIP_MAC_MINIMUM_OS_RELEASE_VERSION:"17.0.0",VOIP_WIN_MINIMUM_OS_RELEASE_VERSION:"10.0.18362",VOIP_MAX_GROUP_CALL_PARTICIPANTS:8,WAM_SYS_INFO_INIT_DELAY:5e3,KEY_NOTICE_BANNER_CLOSED_AT:"notice-banner-closed-at",KEY_NOTICE_ID:"notice-id",MARKED_AS_UNREAD:-1,MAS_APP_IDENTIFIER:"57T9237FN3.desktop.WhatsApp"};t.default=r},75328:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MMS_URL_MEDIA_TYPE_SEARCH_PARAM=t.IS_MMS_URL_SEARCH_PARAM=void 0;t.IS_MMS_URL_SEARCH_PARAM="__wa-mms";t.MMS_URL_MEDIA_TYPE_SEARCH_PARAM="mms-type"},25995:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SpamFlow=void 0;var a=r(28103)({Chat:"chat",Account:"account_info",Group:"group_info",Block:"block_dialog",Dropdown:"overflow_menu"});t.SpamFlow=a},11809:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(19976)),i=a(r(76174)),s=a(r(28173)),o=a(r(61941)),u=a(r(7241));function l(){var e=(0,n.default)(["FTS worker error."]);return l=function(){return e},e}var d=new class{constructor(){this._pendingMap=new Map}_ensureWorkerInited(){this._worker||(u.default.onerror=e=>{this._onWorkerError(e)},u.default.onmessageerror=e=>{this._onMessageError(e)},u.default.onmessage=e=>{var t=e.data;this._onWorkerResponse(t)},this._worker=u.default)}_onMessageError(){}_onWorkerError(){__LOG__(3)(l())}_onWorkerResponse(e){var{reqId:t}=e,r=this._pendingMap.get(t);r&&(e.error?r.reject(new Error("FTS worker error")):r.resolve(e.result),this._untrackInvocation(t))}startIndexer(){return this._runCommand({operation:"start-indexer"})}indexFull(){return this._runCommand({operation:"run"})}index(){return this._runCommand({operation:"consume"})}purge(e){return this._runCommand({operation:"purge",ids:e})}reInit(){return this._runCommand({operation:"re-init"})}clearInitializationPromises(){return this._runCommand({operation:"clear-init"})}search(e,t){return this._runCommand({operation:"find",query:e,queryOptions:t}).then((e=>this._coerceToSearchResult(e)))}_coerceToSearchResult(e){return Array.isArray(e)||"boolean"==typeof e?Promise.resolve({canceled:!1,eof:!0,status:404,messages:[]}):(0,s.default)(e.messages).then((({resolved:t,unresolved:r})=>{var{eof:a,status:n}=e;return this.purge(r),{canceled:!1,eof:a,status:n,messages:t}}))}_runCommand(e){this._ensureWorkerInited();var t=(0,i.default)();return new Promise(((r,a)=>{this._pendingMap.set(t,{resolve:r,reject:a}),this._message({command:e,reqId:t})})).finally((()=>{this._untrackInvocation(t)}))}_untrackInvocation(e){this._pendingMap.delete(e)}_message(e){(0,o.default)(this._worker,"this._worker").postMessage(e)}};t.default=d},28173:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){if(n.default.supportsFeature(n.default.F.MD_BACKEND))return(0,i.getTable)().bulkGet(e).then((t=>{var r=[],a=[];return t.forEach(((t,n)=>{t?r.push((0,s.hydrateMessage)(t)):a.push(e[n])})),{resolved:r,unresolved:a}}));return Promise.resolve({resolved:[],unresolved:[]})};var n=a(r(18120)),i=r(52303),s=r(95197)},76174:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return r++};var r=0},18120:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.getProtobufFeatureName=A,t.default=t.FEATURE_CHANGE_EVENT=void 0;var n=a(r(19976)),i=a(r(54073)),s=a(r(18149)),o=a(r(99686)),u=a(r(54004)),l=a(r(75652)),d=a(r(35676)),c=a(r(57370)),f=a(r(98537)),p=a(r(10017)),h=a(r(28267)),_=r(65291),m=r(21617);function g(){var e=(0,n.default)(["wap:features:"," phone value is "," and web value is ","."]);return g=function(){return e},e}function v(){var e=(0,n.default)(["wap:features:"," phone value is "," and web value is ","."]);return v=function(){return e},e}var E=(0,p.default)(Object.keys(m.WebFeaturesSpec.internalSpec).map((e=>[A(e),!1]))),y=!1,S={RESEND_ICON:!1,MEDIA_EDITOR:!1,DELETE_MSG_CLEAR_MEDIA:!0,DEBUG_COMMANDS:!1,MD_BACKEND:y,MD_ADV:y,MD_PAYMENT:!1,MD_E2E:!1,MD_VOIP_GROUP:y,MD_SYNCD_ANTI_TAMPERING:y,CATALOG_MANAGER:!1,WEB_VOIP_VOICE_CALL:!1,WEB_VOIP_VIDEO_CALL:!1,DOWNLOAD_STATUS_THUMB_MMS:!1,MEDIA_EXISTENCE_CHECK:!1,LOG_MISSING_REQUIRED_PROPERTIES:!1,MEDIA_CUSTOM_CROPPING:!0,HIGH_QUALITY_VIDEO_THUMBNAILS:!1,PORTRAIT_MEDIA_LONG_CAPTIONS:!1},T=[[(0,f.default)(S,E),{},{},{},{ARCHIVE_BROADCAST:!0},{RECENT_EMOJI_SYNC:!0},{},{},{},{QUERY_IDENTITY:!1},{},{STARRED_GIFS:!1,INDEX_RECEIVED_VCARD:!1},{STATUS_V3_UI_SENDING:!1},{MEDIAS_COUNT:!1},{},{VOIP_VOICE_CALL:!0},{DESKTOP_VOIP_VOICE_CALL:!0,DESKTOP_VOIP_VIDEO_CALL:!0,DESKTOP_VOIP_GROUP_VOICE_CALL:!1,DESKTOP_VOIP_GROUP_VIDEO_CALL:!1}]],b={KEY_PARTICIPANT:!1,RICH_TEXT:!0};function A(e){return(0,c.default)(e).toUpperCase()}var C="feature_change";t.FEATURE_CHANGE_EVENT=C;class P extends h.default{constructor(){super(),this.FEATURE_CHANGE_EVENT=C,this.silenceChangeEvents=!0,this.triggerFeaturesChangedDebounced=(0,i.default)((()=>{this.supportsFeature(this.F.MD_BACKEND)&&((0,_.setGKProto)(this.proto),(0,_.setGKFeatures)(this.features)),this.trigger(C)}),50),this.features={};var e=(0,d.default)((0,d.default)(T).map(Object.keys)).concat(Object.keys(b));this.F=(0,p.default)((0,l.default)(e).map((e=>[e,e]))),this.setVersion([0,0]),this.silenceChangeEvents=!1}setVersion(e){if(!this.proto||this.proto.length!==e.length||this.proto[0]!==e[0]||this.proto[1]!==e[1]){this.proto=e;var t=T.slice(0,e[0]+1),r=T.slice(e[0]+1,T.length),a=t[e[0]],n=a.slice(0,e[1]+1),i=a.slice(e[1]+1,a.length);t[e[0]]=n,r.unshift(i);var l=(0,u.default)(this.features);this.features=(0,f.default)((0,o.default)((0,f.default)({},...(0,d.default)(t)),(e=>!e)),this.features||{});var c=(0,f.default)({},...(0,d.default)(r));this.features=(0,o.default)(this.features,((e,t)=>!!c[t])),this.VF=(0,p.default)(Object.keys((0,f.default)({},...(0,d.default)(t))).map((e=>[e,e]))),(0,s.default)(l,this.features)||this.triggerFeaturesChanged()}}setPlatform(e){var t=!1;switch(e){case"iphone":t=!1!==this.features.RECENT_EMOJI_SYNC||!1!==this.features.ARCHIVE_BROADCAST||!0!==this.features.RESEND_ICON||!1!==this.features.DELETE_MSG_CLEAR_MEDIA,this.features.RECENT_EMOJI_SYNC=!1,this.features.ARCHIVE_BROADCAST=!1,this.features.RESEND_ICON=!0,this.features.DELETE_MSG_CLEAR_MEDIA=!1;break;case"symbian":case"s40":case"bb":t=!1!==this.features.CHAT_MARK_UNSEEN,this.features.CHAT_MARK_UNSEEN=!1}t&&this.triggerFeaturesChanged()}setFeatureFromFlags(e,t,r){var a=!1;switch(r){case m.WebFeaturesFlag.FORCE_UPGRADE:switch(t){case m.WebFeaturesFlag.FORCE_UPGRADE:a=!0;break;case m.WebFeaturesFlag.PRODUCTION:case m.WebFeaturesFlag.DEVELOPMENT:case m.WebFeaturesFlag.NOT_STARTED:a=!1,__LOG__(4,void 0,new Error,!0)(v(),e,r,t),SEND_LOGS("wap_feature_unreachable_code")}break;case m.WebFeaturesFlag.PRODUCTION:switch(t){case m.WebFeaturesFlag.FORCE_UPGRADE:a=!1,__LOG__(4,void 0,new Error,!0)(g(),e,r,t),SEND_LOGS("wap_feature_unexpected");break;case m.WebFeaturesFlag.PRODUCTION:a=!0;break;case m.WebFeaturesFlag.DEVELOPMENT:case m.WebFeaturesFlag.NOT_STARTED:a=!1}break;case m.WebFeaturesFlag.DEVELOPMENT:switch(t){case m.WebFeaturesFlag.FORCE_UPGRADE:case m.WebFeaturesFlag.PRODUCTION:case m.WebFeaturesFlag.DEVELOPMENT:case m.WebFeaturesFlag.NOT_STARTED:a=!1}break;case m.WebFeaturesFlag.NOT_STARTED:a=!1}var n=A(e);return this.setFeature(n,a)}setFeature(e,t){var r;r=!!t;var a=this.features[e]!==r;return this.features[e]=r,a&&this.triggerFeaturesChanged(),a}setFeatures(e){var t={},r=(0,f.default)({},b,e);for(var a in r)a in this.VF||(t[a]=this.setFeature(a,r[a]));return t}supportsFeature(e){return!!this.features[e]}supportsFeatureFromFlags(e){var t=A(e);return this.supportsFeature(t)}supportsAllFeatures(...e){return e.every((e=>!!this.features[e]))}supportsAnyFeature(...e){return e.some((e=>!!this.features[e]))}resetFeatures(){this.proto=[0,0],this.features={},this.triggerFeaturesChanged()}lt(e){var t=this.proto;return e[0]>t[0]||e[0]===t[0]&&e[1]>t[1]}lte(e){var t=this.proto;return e[0]>t[0]||e[0]===t[0]&&e[1]>=t[1]}gt(e){var t=this.proto;return e[0]<t[0]||e[0]===t[0]&&e[1]<t[1]}gte(e){var t=this.proto;return e[0]<t[0]||e[0]===t[0]&&e[1]<=t[1]}triggerFeaturesChanged(){this.silenceChangeEvents||this.triggerFeaturesChangedDebounced()}overwriteDebugGKs(){}isThirdPartyStickersEnabled(){return this.supportsAllFeatures(this.F.THIRD_PARTY_STICKERS,this.F.MEDIA_UPLOAD)}isRecentStickersEnabled(){return this.supportsAnyFeature(this.F.RECENT_STICKERS_V_2,this.F.RECENT_STICKERS_V_3)&&this.supportsFeature(this.F.MEDIA_UPLOAD)}isStarredStickersEnabled(){return this.supportsFeature(this.F.STARRED_STICKERS)&&this.isRecentStickersEnabled()}isCatalogManagerEnabled(){return this.supportsAllFeatures(this.F.CATALOG_MANAGER,this.F.MD_BACKEND)}isEphemeralAllowGroupMembersEnabled(){if(this.supportsFeature(this.F.MD_BACKEND)){var{getABPropConfigValue:e}=r(97148);return e("ephemeral_allow_group_members")}return this.supportsFeature(this.F.EPHEMERAL_ALLOW_GROUP_MEMBERS)}isEphemeral24HDurationEnabled(){if(this.supportsFeature(this.F.MD_BACKEND)){var e,{getABPropConfigValue:t}=r(97148);return null!==(e=t("ephemeral_24h_duration"))&&void 0!==e&&e}return this.supportsFeature(this.F.EPHEMERAL_24_H_DURATION)}}var O=new P;t.default=O},75459:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.canDisplayLabel=function(){if(i.default.supportsFeature(i.default.F.MD_BACKEND))return n.default.isSMB;return i.default.supportsFeature(i.default.F.LABELS_DISPLAY)},t.canEditLabelAssociation=function(){if(i.default.supportsFeature(i.default.F.MD_BACKEND))return n.default.isSMB;return i.default.supportsFeature(i.default.F.LABELS_EDIT)},t.canEditLabel=function(){if(i.default.supportsFeature(i.default.F.MD_BACKEND))return!1;return i.default.supportsFeature(i.default.F.LABELS_EDIT)},t.canSendQuickReply=function(){if(i.default.supportsFeature(i.default.F.MD_BACKEND))return n.default.isSMB;return i.default.supportsFeature(i.default.F.QUICK_REPLIES_QUERY)},t.bspUiEnabled=function(){return s.default.bspUi},t.buttonsMessagesEnabled=function(){return s.default.webButtonsMessage},t.archiveV2Supported=function(){return i.default.supportsFeature(i.default.F.ARCHIVE_V_2)},t.canEditBizProfile=function(){if(o.has("BIZ_PROFILE_EDIT"))return!0;return n.default.isSMB&&s.default.webBizProfileEdit},t.canSeeSMBUpsell=function(){return s.default.webSMBUpsellInBizProfile},t.productListMessagesEnabled=function(){return s.default.webProductListMessage&&!1},t.productListMessageFallbackEnabled=function(){return s.default.webProductListMessageFallback},t.canSeeBizProfileV3=function(){if(o.has("BIZ_PROFILE_V3"))return!0;return!1},t.cartPropEnabled=function(){return s.default.webCart},t.canViewCollections=function(){if(o.has("COLLECTIONS_DISPLAY"))return!0;return s.default.webCollectionsDisplay};var n=a(r(52737)),i=a(r(18120)),s=a(r(72424)),o=new Set([])},84226:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r={pt:"pt_br",pt_ao:"pt",pt_ch:"pt",pt_cv:"pt",pt_fr:"pt",pt_gq:"pt",pt_gw:"pt",pt_lu:"pt",pt_mo:"pt",pt_mz:"pt",pt_pt:"pt",pt_st:"pt",pt_tl:"pt",zh_hans:"zh_cn",zh_hant:"zh_tw",zh_sg:"zh_cn",tl:"fil"};t.default=r},95810:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r={af:"af",ar:"ar",ar_xb:"ar-XB",az:"az",bg:"bg",bn:"bn",ca:"ca",cs:"cs",da:"da",de:"de",el:"el",en:"en",es:"es",et:"et",fa:"fa",fi:"fi",fil:"fil",fr:"fr",gu:"gu",he:"he",hi:"hi",hr:"hr",hu:"hu",id:"id",it:"it",ja:"ja",kk:"kk",kn:"kn",ko:"ko",lt:"lt",lv:"lv",mk:"mk",ml:"ml",mr:"mr",ms:"ms",nb:"nb",nl:"nl",pa:"pa",pl:"pl",pt:"pt",pt_br:"pt-BR",ro:"ro",ru:"ru",sk:"sk",sl:"sl",sq:"sq",sr:"sr",sv:"sv",sw:"sw",ta:"ta",te:"te",th:"th",tr:"tr",uk:"uk",ur:"ur",uz:"uz",vi:"vi",zh_cn:"zh-CN",zh_hk:"zh-HK",zh_tw:"zh-TW"};t.default=r},89687:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(19976)),i=r(39329);function s(){var e=(0,n.default)([""," called on unretained OpaqueData"]);return s=function(){return e},e}function o(){var e=(0,n.default)([""," called on released OpaqueData"]);return o=function(){return e},e}function u(){var e=(0,n.default)(["OpaqueData:autorelease too many release calls"]);return u=function(){return e},e}function l(){var e=(0,n.default)(["OpaqueData:autorelease called on released object"]);return l=function(){return e},e}function d(){var e=(0,n.default)(["OpaqueData:retain called on released OpaqueData"]);return d=function(){return e},e}var c=[],f=new i.ShiftTimer((function(){var e=c;c=[];for(var t=0;t<e.length;t++){var r=e[t];r._inAutoreleasePool=!1,0!==r._retainCount||r.released||(r.released=!0,r._releaseImpl())}}));t.default=class{constructor(){this._retainCount=1,this._inAutoreleasePool=!1,this.released=!1}retain(){if(this.released)throw __LOG__(3)(d()),new Error("OpaqueData:retain called on released OpaqueData");this._retainCount++}autorelease(){this.released?__LOG__(3)(l()):0===this._retainCount?__LOG__(3)(u()):1===this._retainCount?(this._retainCount=0,this._inAutoreleasePool||(this._inAutoreleasePool=!0,c.push(this),f.onOrBefore(1e3))):this._retainCount--}autoreleaseWhenPromiseCompletes(e){var t=()=>{this.autorelease()};e.then(t,t)}throwIfReleased(e){if(this.released)throw __LOG__(4,void 0,new Error)(o(),e),new Error("".concat(e," called on released OpaqueData"));0===this._retainCount&&__LOG__(4,void 0,new Error)(s(),e)}_releaseImpl(){throw new Error("OpaqueData:_releaseImpl unimplemented")}}},46194:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.cleanFilename=s,t.cleanIncomingFilename=function(e){if(!e)return e;var t=s(e);if(e!==t&&t){var r=t.split("."),a=r.length>=2&&r.pop();["bat","exe","cmd","com","lnk","pif","scr","vb","vbe","vbs","wsh","js","ps1","hta","sh","csh","msi","app","scpt","applescript","reg","vbe","wsf","sct"].includes(a)&&__LOG__(2,!0)(i(),a||"")}return t};var n=a(r(19976));function i(){var e=(0,n.default)(["cleanIncomingFilename:extension: ",""]);return i=function(){return e},e}function s(e){if(!e)return e;var t=e.replace(/[\u202a-\u202e\u2066-\u2069\u200E\u200F\u061C]/g,""),r=t.split(".");if(1===r.length)return t;for(var a=r.length-1;a>0;a--){var n=r[a].trim();if(n.length)return r.slice(0,a).join(".")+"."+n}return t}},82982:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.getImageWidthHeight=function(e){return Q((t=>{var r;return t(e),new Promise(((t,a)=>{(r=new Image).onload=t,r.onabort=()=>{a(new Error("getImageWidthHeight onabort"))},r.onerror=()=>{a(new Error("getImageWidthHeight onerror"))},r.src=e.url()})).then((()=>({width:r.naturalWidth,height:r.naturalHeight})))}))},t.getImageWidthHeightNoOpaque=x,t.opaqueDataToArrayBuffer=function(e){return Q((t=>{t(e);var r=e._blob;if(r)return B(r);var a=e._b64;return(0,d.decodeB64)(a)}))},t.decodeWebpToRGBANoOpaque=Y,t.parseWebpNoOpaque=K,t.videoWidthHeightDuration=function(e){return Q((t=>(t(e),b.videoWidthHeightDuration(e.forceToBlob()))))},t.videoWidthHeightDurationNoOpaque=j,t.processRawImage=function(){return V.apply(this,arguments)},t.processRawAudioVideo=function(){return H.apply(this,arguments)},t.getRawDocumentMimetype=q,t.processRawDocument=function(){return J.apply(this,arguments)},t.fetchMedia=function(e){return(0,y.default)(e,"GET",null,D.default.RESP_TYPE.ARRAY_BUFFER).then((e=>e?Promise.resolve({result:e.response,status:e.status}):Promise.resolve(null)))},t.canPlayOgg=function(){return!!b.canPlayOgg},t.gatherAndSetMetadata=function(){return X.apply(this,arguments)},t.gatherAndSetMetadataNoOpaque=function(e,t){return Promise.resolve().then((()=>{switch(e.type){case C.TYPE.VIDEO:return j(t).then((e=>({fullWidth:e.width,fullHeight:e.height,duration:void 0!==e.duration?"".concat(Math.ceil(e.duration)):void 0,durationFloat:e.duration})));case C.TYPE.IMAGE:return null!=e.contentInfo.fullHeight&&null!=e.contentInfo.fullWidth&&e.size===t.size?null:x(t).then((e=>({fullWidth:e.width,fullHeight:e.height,size:t.size})));case C.TYPE.STICKER:return(0,_.default)().then((e=>e?(0,l.promiseProps)({widthHeight:x(t),webpData:K(t)}).then((e=>({fullWidth:e.widthHeight.width,fullHeight:e.widthHeight.height,animationDuration:e.webpData.animationDuration,firstFrameLength:e.webpData.firstFrameLength,singleLoopDuration:e.webpData.singleLoopDuration,emojis:e.webpData.emojis,isAnimated:e.webpData.animationDuration>0,size:t.size}))):K(t).then((({animationDuration:e,firstFrameLength:r,singleLoopDuration:a,emojis:n})=>e>0?{animationDuration:e,firstFrameLength:r,singleLoopDuration:a,emojis:n,isAnimated:!0,size:t.size}:Y(t).then((r=>({animationDuration:e,rgbaBuffer:r.rgbaBuffer,rgbaWidth:r.width,rgbaHeight:r.height,size:t.size})))))));case C.TYPE.AUDIO:default:return{}}})).catchType(g.MediaUnsupportedError,(t=>{throw e.consolidate({}),t})).then((t=>{null!=t&&e.consolidate(t)}))},t.shouldUseMediaCache=function(e){return e===A.default.STICKER||e===A.default.IMAGE||e===A.default.PRODUCT||e===A.default.PTT||e===A.default.AUDIO},t.shouldUseLruMediaStore=function(e){var t=e===A.default.STICKER||e===A.default.IMAGE,r=e===A.default.AUDIO||e===A.default.DOCUMENT||e===A.default.GIF||e===A.default.PPIC||e===A.default.PRODUCT||e===A.default.PTT||e===A.default.VIDEO||e===A.default.TEMPLATE||e===A.default.THUMBNAIL_DOCUMENT||e===A.default.THUMBNAIL_IMAGE||e===A.default.THUMBNAIL_VIDEO;return(t||r)&&(0,E.getRememberMe)()},t.getResizedThumbData=function(e,t,r,a,n){return new Promise((i=>{var s=new Image;s.setAttribute("crossorigin","anonymous"),s.onload=()=>{var e,o,u=document.createElement("canvas"),l=u.getContext("2d"),d=0,c=0;if(u.width=t,u.height=r,s.height>s.width){var f=s.height/s.width;e=t,c=-((o=f*t)-r)/2}else{var p=s.width/s.height;o=r,d=-((e=p*r)-t)/2}l.drawImage(s,d,c,e,o),i(u.toDataURL(a,n))},s.src=e}))};var i=n(r(70417)),s=n(r(52954)),o=n(r(19976)),u=r(73559),l=r(5497),d=r(60339),c=n(r(5025)),f=r(46194),p=n(r(50935)),h=n(r(36334)),_=n(r(36455)),m=a(r(78711)),g=a(r(96452)),v=r(99888),E=r(95595),y=n(r(37448)),S=a(r(44202)),T=r(91063),b=a(r(23765)),A=n(r(81135)),C=r(96645),P=r(41501),O=n(r(25012)),w=n(r(38579)),M=n(r(72424)),I=n(r(74185)),R=r(84990),D=n(r(69835));function N(){var e=(0,o.default)(["object type: ",""]);return N=function(){return e},e}function L(){var e=(0,o.default)(["Assertion failed!"]);return L=function(){return e},e}function k(){var e=(0,o.default)(["Assertion failed!"]);return k=function(){return e},e}function U(){var e=(0,o.default)(["processRawAudioVideo bad video file ",""]);return U=function(){return e},e}function F(){var e=(0,o.default)(["processRawImage: Failed to reach max thumbnail size, preview will be null"]);return F=function(){return e},e}function G(){var e=(0,o.default)(["MediaUtils error: ",""]);return G=function(){return e},e}function x(e){return new Promise(((t,r)=>{var a=new Image,n=window.URL.createObjectURL(e);a.onload=()=>{var e={width:a.naturalWidth,height:a.naturalHeight};window.URL.revokeObjectURL(n),t(e)},a.onabort=()=>{window.URL.revokeObjectURL(n),r(new Error("getImageWidthHeight onabort"))},a.onerror=()=>{window.URL.revokeObjectURL(n),r(new Error("getImageWidthHeight onerror"))},a.src=n}))}function B(e){return(0,v.blobToArrayBuffer)(e).catch((e=>{throw __LOG__(3)(G(),e),e}))}function Y(e){return B(e).then((e=>(0,h.default)(e)))}function K(e){return B(e).then(w.default)}function j(e){return b.videoWidthHeightDuration(e)}function W(e,t){return Q((r=>(r(e),b.transcode(e.forceToBlob(),t).then((e=>O.default.createFromData(e,e.type))).then((e=>(r(e),e.autorelease(),e))))))}function V(){return(V=(0,s.default)((function*(e){var t=e.forceToBlob(),{width:r,height:a,images:n}=yield S.rotateAndResize(t,M.default.imageMaxEdge,S.BLOB|S.CANVAS),{images:i}=yield S.rotateAndResize(n.canvas,p.default.IMG_THUMB_MAX_EDGE,S.DATA_URL|S.CANVAS),s=S.getResizedDataUrl(i.canvas,"image/jpeg",2e4),o=s?I.default.parseDataURL(s).data:null;return o||__LOG__(2)(F()),{blob:n.blob,width:r,height:a,preview:o}}))).apply(this,arguments)}function H(){return(H=(0,s.default)((function*(e,t,r,a,n){var s,o=e.forceToBlob(),u=yield(0,T.checkAndRepair)(o,!!a);if(!u)throw __LOG__(3)(U(),o.type),new g.InvalidMediaFileType;var l=u.type,d=u.file,c=a||u.isGif;switch((0,v.typeFromMimetype)(l)){case v.FILETYPE.VIDEO:if(t)throw __LOG__(4,void 0,new Error,!0)(k()),SEND_LOGS("media-fault: ptt became video"),new g.InvalidMediaFileType;var f={type:C.OUTWARD_TYPES.VIDEO,mediaBlob:d,mimetype:l,isGif:c,gifAttribution:c?n||0:void 0};if(r&&null!=r.duration&&null!=r.fullHeight&&0!==r.fullHeight&&null!=r.fullWidth&&0!==r.fullWidth&&r.preview)return(0,i.default)((0,i.default)({},f),{},{fullWidth:r.fullWidth,fullHeight:r.fullHeight,preview:r.preview,duration:r.duration.toString()});var{duration:h,thumbs:[_,m]}=yield S.generateVideoThumbsAndDuration(d,[p.default.IMG_THUMB_MAX_EDGE,p.default.VIDEO_THUMB_MAX_EDGE]),E=yield O.default.createFromBase64Jpeg(I.default.parseDataURL(m.url).data);return(0,i.default)((0,i.default)({},f),{},{fullWidth:_.fullWidth,fullHeight:_.fullHeight,preview:I.default.parseDataURL(_.url).data,fullPreviewData:E,duration:h.toString()});case v.FILETYPE.AUDIO:var y=null!==(s=null==r?void 0:r.duration)&&void 0!==s?s:yield(0,v.getAudioDuration)(d);return{type:t?C.OUTWARD_TYPES.PTT:C.OUTWARD_TYPES.AUDIO,mediaBlob:d,mimetype:l,duration:y.toString()};default:throw __LOG__(4,void 0,new Error,!0)(L()),SEND_LOGS("media-fault: audio/video became other"),new Error("audio/video became ".concat(l))}}))).apply(this,arguments)}function q(){return z.apply(this,arguments)}function z(){return(z=(0,s.default)((function*(e,t){var r=e.type;if(r){if("*"===P.DOC_MIMES||P.DOC_MIMES.includes(r))return r;throw new g.InvalidMediaFileType("disallowed mimetype ".concat(r))}var a=yield B(e),n=(0,c.default)(new Uint8Array(a,0,Math.min(262,a.byteLength)));if(n&&n.mime){var i=(0,P.isAllowedDocumentMimetype)(n.mime,t,!0);if(i)return i}else if(t){var s=(0,v.getMimeTypeForFilepath)(t);if(s)return s}throw new g.InvalidMediaFileType("type: ".concat(String(e.type)," name: ").concat(String(t)))}))).apply(this,arguments)}function J(){return(J=(0,s.default)((function*(e,t,r,a){var n,i,s=e.forceToBlob(),o=(0,f.cleanFilename)(s.name||t||null),u=yield q(s,o),l=r?(0,v.blobToText)(s):null,[d,c]=yield Promise.all([m.enrich(s,u),l]),p=null!==(n=null==d||null===(i=d.microThumbnail)||void 0===i?void 0:i.dataUrl)&&void 0!==n?n:null==d?void 0:d.thumbUrl,h=p?I.default.parseDataURL(p).data:null;return{type:C.OUTWARD_TYPES.DOCUMENT,mediaBlob:yield O.default.createFromData(s,u),mimetype:u,filename:o||void 0,documentPreview:d,preview:h,fullPreviewData:null==d?void 0:d.fullPreviewData,fullPreviewSize:d?{width:d.width,height:d.height}:null,pageCount:null!=a?a:null==d?void 0:d.pdfPages,isVcardOverMmsDocument:r,parsedVcards:c?(0,R.parseMultiVcard)(c):null}}))).apply(this,arguments)}function Q(e){var t=[];return(0,u.callSyncPromise)(e,null,(function(e){e.retain(),t.push(e)})).finally((()=>{for(var e=0;e<t.length;e++)t[e].autorelease()}))}function X(){return(X=(0,s.default)((function*(e,t){var r,a;t.retain();try{switch(e.type){case C.TYPE.VIDEO:var n=t.forceToBlob(),{thumbs:[i],duration:s}=yield S.generateVideoThumbsAndDuration(n,[p.default.VIDEO_THUMB_MAX_EDGE]),o=yield O.default.createFromBase64Jpeg(I.default.parseDataURL(i.url).data);r={mediaBlob:t,renderableUrl:t.url(),fullWidth:i.fullWidth,fullHeight:i.fullHeight,duration:void 0!==s?"".concat(Math.ceil(s)):void 0,durationFloat:s,fullPreviewData:o};break;case C.TYPE.AUDIO:var u=yield W(t);u.retain(),r={mediaBlob:u,renderableUrl:u.url()},a=()=>u.autorelease();break;default:e.type!==C.TYPE.IMAGE&&e.type!==C.TYPE.STICKER||(__LOG__(4,void 0,new Error,!0)(N(),e.type||""),SEND_LOGS("Entering gatherAndSetMetadata (with OpaqueData) unexpectedly")),r={mediaBlob:t,renderableUrl:t.url()}}e.consolidate(r)}catch(r){if(!(r instanceof g.MediaUnsupportedError))throw r;e.consolidate({mediaBlob:t,renderableUrl:t.url()})}finally{t.autorelease(),null!=a&&a()}}))).apply(this,arguments)}},25012:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(60339),i=a(r(89687)),s=r(99888);class o extends i.default{constructor(...e){super(...e),this._b64=void 0,this._blob=void 0,this._url=void 0,this._mimetype=void 0,this._released=void 0}url(){return this.throwIfReleased("OpaqueData:url"),this._url?this._url:this._b64?this._url="data:image/jpeg;base64,".concat(this._b64):this._url=window.URL.createObjectURL(this._blob)}getBase64(){return this._b64}filepath(){throw new Error("OpaqueData:filepath can not be implemented on web")}wavFilepath(){throw new Error("OpaqueData:wavFilepath can not be implemented on web")}setWavFilepath(){throw new Error("OpaqueData:setWavFilepath can not be implemented on web")}validate(){return this._released?Promise.resolve(!1):this._blob?(0,s.validateBlob)(this._blob):Promise.resolve(!0)}size(){return this.throwIfReleased("OpaqueData:size"),this._blob?this._blob.size:(0,n.sizeWhenB64Decoded)(this._b64)}formData(){return this.throwIfReleased("OpaqueData:formData"),this.forceToBlob()}type(){return this.throwIfReleased("OpaqueData:type"),this._mimetype||"undefined"}forceToBlob(){this.throwIfReleased("OpaqueData:forceToBlob");var e=this._blob;if(e)return e;var t=this._b64;if(t){this._b64=void 0,this._url=void 0;var r=this._mimetype;return this._blob=new Blob([(0,n.decodeB64)(t)],r?{type:r}:void 0)}throw new Error("OpaqueData:forceToBlob no b64 or blob")}_releaseImpl(){this._mimetype=void 0,this._blob?(this._blob=void 0,this._url&&(window.URL.revokeObjectURL(this._url),this._url=void 0)):(this._b64=void 0,this._url=void 0)}isBlobEqual(e){return e?this._blob===e._blob:!this._blob}}t.default=o,o.createFromBase64Jpeg=e=>new Promise((t=>{var r=new o;return r._b64=e,r._mimetype="image/jpeg",t(r)})),o.createFromData=(e,t)=>new Promise((r=>{var a=new o;return a._blob=e instanceof Blob&&e.type===t?e:new Blob([e],{type:t}),a._mimetype=t,r(a)}))},54146:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(26823)),i=r(53882),s=r(96645),o=a(r(40210));class u{constructor(e){this.itemCount=e.itemCount,this.purgesSoFar=e.purgesSoFar,this.sizeLimit=e.sizeLimit,this.startTime=null!=e.startTime?e.startTime:window.performance.now()}increaseItemCount(){this.itemCount++}decreaseItemCount(){this.itemCount--}increasePurgesSoFar(){this.purgesSoFar++}commitMetric(){new o.default.WebcMediaBlobCachePurge({mediaBlobCacheItemCount:this.itemCount,mediaBlobCachePurgesSoFar:this.purgesSoFar,mediaBlobCacheSizeLimit:this.sizeLimit,mediaBlobCacheUptimeT:Math.round(window.performance.now()-this.startTime)}).commit()}reset(){this.itemCount=0,this.purgesSoFar=0,this.startTime=window.performance.now()}}var l=new class{constructor(e=25e7){if(this.getOrCreateURL=e=>{if(this._filehashToUrl[e])return this.touch(e),this._filehashToUrl[e];var t=this.get(e);if(!t)throw new Error("There is no blob matching filehash: ".concat(e,"."));var r=window.URL.createObjectURL(t);return this._filehashToUrl[e]=r,r},this.revokeURL=(e,t)=>{if(t){if(this._filehashToUrl[e]!==t)throw new Error("The url provided does not match the filehash.");delete this._filehashToUrl[e],window.URL.revokeObjectURL(t)}},null!=e&&e<0)throw new Error("Size limit cannot be a negative number.");this._metricHelper=new u({itemCount:0,purgesSoFar:0,sizeLimit:e,startTime:null}),this._usageCounts={},this._filehashToUrl={},this._lruCache=new n.default({sizeLimit:e,getSize:e=>e.size,onEvict:e=>{this._filehashToUrl[e]&&0===this._getUsageCount(e)&&(this.revokeURL(e,this._filehashToUrl[e]),(0,i.getOrCreateMediaObject)(e).consolidate({downloadStage:s.DOWNLOAD_STAGE.INIT})),this._metricHelper.increasePurgesSoFar(),this._metricHelper.commitMetric()},onAdd:()=>{this._metricHelper.increaseItemCount()},shouldEvict:e=>0===this._getUsageCount(e),onDelete:()=>{this._metricHelper.decreaseItemCount()},onClear:()=>{this._metricHelper.reset()}})}get(e){return this._lruCache.get(e)}has(e){return this._lruCache.has(e)}touch(e){this.get(e)}put(e,t){this._lruCache.put(e,t)}clear(){this._usageCounts={},Object.keys(this._filehashToUrl).forEach((e=>{this._filehashToUrl[e]&&this.revokeURL(e,this._filehashToUrl[e])})),this._filehashToUrl={},this._lruCache.clear()}increaseUsageCount(e){this._usageCounts[e]=this._getUsageCount(e)+1}decreaseUsageCount(e){var t=this._getUsageCount(e);if(t<=0)throw new Error("Cannot decrease the usageCount to a negative number.");this._usageCounts[e]=t-1,0===this._usageCounts[e]&&delete this._usageCounts[e]}_getUsageCount(e){return this._usageCounts[e]||0}};t.default=l},60221:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.cleanJPEG=function(e){var t,r=new a.Binary(e),Y=new a.Binary(e),K=new a.Binary,j=!1,W=!1,V=!1,H=!1,q={version:257,densityUnits:0,xDensity:1,yDensity:1};if(255!==r.readUint8()||r.readUint8()!==v)throw new Error("SOI marker not at the start of the file.");Y.advance(2);var z=void 0;for(;null!=z||r.size();){if(void 0===z){var J=r.readUint8();if(255!==J)throw new Error("0x".concat(J.toString(16)," is not a marker prefix."));z=r.readUint8()}switch(z){case b:if(W)t=r.readUint16(),Y.advance(t+2),r.advance(r.size()-Y.size());else{if(t=r.readUint16(),"JFIF\0"!==r.readString(5))throw new Error("APP0 marker missing 'JFIF' magic bytes.");H=!0,q.version=r.readUint16(),q.densityUnits=r.readUint8(),q.xDensity=r.readUint16(),q.yDensity=r.readUint16(),Y.advance(t+2),r.advance(r.size()-Y.size()),W=!0}break;case y:if(!V&&!H)throw new Error("Missing magic bytes marker.");r.advance(r.readUint16()-2);for(var Q=void 0,X=r.readUint8();r.size();){if(Q=r.readUint8(),255===X&&!B.includes(Q)){z=Q;break}X=Q}K.writeByteArray(Y.readByteArray(Y.size()-r.size()-2));continue;case A:if(t=r.readUint16(),!V&&"Exif\0\0"!==r.readString(6))throw new Error("APP1 marker missing 'EXIF' magic bytes.");V=!0,Y.advance(t+2),r.advance(r.size()-Y.size());break;case U:case x:if(!V&&!H)throw new Error("Missing magic bytes marker.");t=r.readUint16(),Y.advance(t+2),r.advance(r.size()-Y.size());break;case E:if(!V&&!H)throw new Error("Missing magic bytes marker.");j=!0,K.writeByteArray(Y.readByteArray(2));break;case n:case i:case s:case o:case l:case d:case c:case f:case p:case h:case _:case m:case g:case S:case u:case T:if(!V&&!H)throw new Error("Missing magic bytes marker.");t=r.readUint16(),K.writeByteArray(Y.readByteArray(2+t)),r.advance(r.size()-Y.size());break;case C:case P:case O:case w:case M:case I:case R:case D:case N:case L:case k:case F:case G:throw new Error("Received unexpected APP marker 0x".concat(z.toString(16)));default:throw new Error("Did not understand marker: 0x".concat(z.toString(16)))}if(z=void 0,j)break}if(!j)throw new Error("No EOI tag found.");var Z=function(e){var t=new a.Binary;return t.writeBytes(255,216,255,224,0,16,74,70,73,70,0),t.writeUint16(e.version),t.writeUint8(e.densityUnits),t.writeUint16(e.xDensity),t.writeUint16(e.yDensity),t.writeBytes(0,0),t.readByteArray()}(q);return new Blob([Z,K.readByteArray()],{type:"image/jpeg"})};var a=r(46378),n=192,i=193,s=194,o=195,u=196,l=197,d=198,c=199,f=201,p=202,h=203,_=205,m=206,g=207,v=216,E=217,y=218,S=219,T=221,b=224,A=225,C=226,P=227,O=228,w=229,M=230,I=231,R=232,D=233,N=234,L=235,k=236,U=237,F=238,G=239,x=254,B=[0,208,209,210,211,212,213,214,215]},68689:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(19976)),i=a(r(76968));function s(){var e=(0,n.default)(["Unable to open cache: ",", error: ",""]);return s=function(){return e},e}function o(){var e=(0,n.default)(["Tried to delete a non-existent cache: ",""]);return o=function(){return e},e}function u(){var e=(0,n.default)(["Unable to delete. This error can occur if abstract method doDel gets called."]);return u=function(){return e},e}function l(){var e=(0,n.default)(["Unable to put. This error can occur if abstract method doPut gets called."]);return l=function(){return e},e}function d(){var e=(0,n.default)(["Unable to get. This error can occur if abstract method doGet gets called."]);return d=function(){return e},e}var c={ignoreSearch:!0,ignoreMethod:!0,ignoreVary:!0};class f extends i.default{constructor(e){super(),this._encodeKey=e=>{var t=encodeURIComponent(e),r=encodeURIComponent(this.storeName);return"https://_media_cache_v2_.whatsapp.com/".concat(r,"_").concat(t)},this.storeName=e}doGet(e){var t=this._encodeKey(e);return this.cacheStore?Promise.resolve(this.cacheStore.match(t,c).then((e=>e?e.arrayBuffer():null))):(__LOG__(3)(d()),Promise.reject(new Error("Unable to get")))}doPut(e,t){var r=this._encodeKey(e);return this.cacheStore?Promise.resolve(this.cacheStore.put(r,new Response(t)).then((()=>t))):(__LOG__(3)(l()),Promise.reject(new Error("Unable to put in cache")))}doDel(e){var t=this._encodeKey(e);return this.cacheStore?this.cacheStore.delete(t,c).then((()=>{})):(__LOG__(3)(u()),Promise.reject(new Error("Unable to delete")))}doClear(){return Promise.resolve(caches.delete(this.storeName).then((e=>{e||__LOG__(2)(o(),this.storeName)})))}doOpen(){return Promise.resolve(caches.open(this.storeName).then((e=>{this.cacheStore=e}))).catch((e=>(this.cacheStore=null,__LOG__(3)(s(),this.storeName,e),Promise.reject(e))))}doClose(){return this.cacheStore=null,Promise.resolve()}}t.default=f},94620:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(76968));class i extends n.default{get(){return Promise.resolve()}queryByIndex(){return Promise.resolve([])}getAll(){return Promise.resolve([])}put(e,t){return Promise.resolve(t)}del(){return Promise.resolve()}count(){return Promise.resolve(0)}clear(){return Promise.resolve()}}t.default=i},47872:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(76968)),i=a(r(28770)),s=r(62749);class o extends n.default{constructor(){super(),this._store=new i.default(s.initialize,s.IdbArrayBufferTable)}doGet(e){return this._store.get(e).then((e=>e?e.data:null))}doQueryByIndex(){throw new Error("Not implemented. Actual Arraybuffer store does not need it.")}doGetAll(){throw new Error("Not implemented. Actual Arraybuffer store does not need it.")}doPut(e,t){return this._store.put(e,{id:e,data:t}).then((e=>e.data))}doDel(e){return this._store.del(e)}doCount(){return this._store.count()}clear(){return this._store.clear()}doOpen(){return Promise.resolve()}doClose(){return Promise.resolve()}}t.default=o},67457:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.storeDataIndex=t.storePrimaryIndex=void 0;var n=a(r(30530)),i=a(r(7128)),s=a(r(58642)),o="id";t.storePrimaryIndex=o;var u="data";t.storeDataIndex=u;var l="lru-media-array-buffer";i.default.add(l).version(i.default.versions.version(0),[new s.default(o),new n.default(u)]).view((e=>({id:e.id,data:e.data})));var d=i.default.table(l);t.default=d},26666:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.metaInfoSizeIndex=t.metaInfoDateIndex=t.metaInfoPrimaryIndex=void 0;var n=a(r(30530)),i=a(r(90146)),s=a(r(7128)),o=a(r(58642));t.metaInfoPrimaryIndex="id";var u="timestamp";t.metaInfoDateIndex=u;var l="size";t.metaInfoSizeIndex=l;var d="lru-media-meta-info";s.default.add(d).version(s.default.versions.version(1),[new o.default("id"),new n.default(u),new i.default(u)]).version(s.default.versions.version(2),[new n.default(l)]).view((e=>({id:e.id,timestamp:e.timestamp,size:e.size||0})));var c=s.default.table(d);t.default=c},28770:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(76968));class i extends n.default{constructor(e,t){super(),this._initialize=e,this._table=t}doGet(e){return this._initialize().then((()=>this._table.get(e)))}doQueryByIndex(e,t){return this._initialize().then((()=>this._table.all({limit:t.limit,index:[e]})))}doGetAll(){return this._initialize().then((()=>this._table.all()))}doPut(e,t){return this._initialize().then((()=>this._table.createOrReplace(t))).then((()=>t))}doDel(e){return this._initialize().then((()=>this._table.remove(e)))}doCount(){return this._initialize().then((()=>this._table.count()))}doClear(){return this._initialize().then((()=>this._table.clear()))}doOpen(){return this._initialize()}doClose(){return Promise.resolve()}}t.default=i},7128:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(2206)),i=a(r(6957)),s=new n.default("lru-media-storage-idb"),o=new i.default(s);t.default=o},28543:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(28770)),i=r(62749),s=a(r(84233));class o extends s.default{constructor(e,t){super(new n.default(i.initialize,i.IdbMetaInfoTable),{primaryIndex:i.metaInfoPrimaryIndex,dateIndex:i.metaInfoDateIndex,sizeIndex:i.metaInfoSizeIndex,maxSize:e,dispose:t})}}t.default=o},65882:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(52954)),i=a(r(19976)),s=a(r(77715)),o=a(r(76968)),u=r(57337),l=a(r(25353)),d=a(r(28543)),c=r(62749),f=a(r(40210)),p=a(r(61941));function h(){var e=(0,i.default)(["LruMediaStore: encounter QuotaExceededError, thus shrink the size of LruMediaStore"]);return h=function(){return e},e}class _ extends o.default{constructor(e){var t;super(),t=this,this._enqueue=(0,u.createEnqueue)(),this.updateMaxSizeInterval=null,this._dispose=(e,t)=>(Promise.all([(0,l.default)(),this.count()]).then((([e,r])=>{var a,n=new f.default.WebcMediaStorePurge({webcCurrentTimestampT:(new Date).getTime(),webcMediaStoreItemCount:r,webcMediaStoreQuotaBytes:this.getMaxSize(),webcMediaStoreQuotaUsedBytes:null!==(a=this.getCurrentSize())&&void 0!==a?a:void 0,webcPurgedItemTimestampT:t[c.metaInfoDateIndex]});e&&(n.webcBrowserStorageQuotaBytes=e.quota,n.webcBrowserStorageQuotaUsedBytes=e.usage),n.commit()})),this._bufferStore.del(e)),this.doPut=this._enqueue(((e,t)=>{if(t.byteLength>this.getMaxSize())return Promise.resolve(t);if(t.byteLength>3e7)return Promise.resolve(t);var r={id:e,timestamp:(new Date).getTime(),size:t.byteLength};return this._lruStore.putObject(r).then((()=>this._bufferStore.put(e,t))).catchType(s.default.AbortError,(e=>{if(e.message.includes("QuotaExceededError"))return __LOG__(2)(h()),void this.setMaxSize((0,p.default)(this.getCurrentSize(),"this.getCurrentSize()")/2);throw e}))})),this.doDel=this._enqueue((e=>this._lruStore.del(e))),this._updateMaxSize=(0,n.default)((function*(){var e=yield(0,l.default)();if(null!=e){var r=t.getCurrentSize();if(null!=r){var a=e.quota-e.usage,n=t._calculateTargetedBufferSize(e.quota);if(!(a>n)){var i=n-a;r<i?t._clearStoreForThisSession():t.setMaxSize(r-i)}}}else t._clearStoreForThisSession()}));var{name:r,maxSize:a,createArrayBufferStore:i}=e;this._bufferStore=i("".concat(r,"_buffer")),this._lruStore=new d.default(a,this._dispose),this.updateMaxSizeInterval=setInterval(this._updateMaxSize,6e4)}doGet(e){return this._bufferStore.get(e).then((t=>(null!=t&&this.put(e,t),t)))}doClear(){return this._bufferStore.clear().then((()=>this._lruStore.clear()))}doCount(){return this._lruStore.count()}doOpen(){return Promise.all([this._lruStore.open(),this._bufferStore.open()]).then((()=>{}))}doClose(){return Promise.all([this._lruStore.close(),this._bufferStore.close()]).then((()=>{}))}getCurrentSize(){return this._lruStore.getCurrentSize()}getMaxSize(){return this._lruStore.getMaxSize()}setMaxSize(e){return this._lruStore.setMaxSize(e)}_calculateTargetedBufferSize(e){var t=Math.floor(.01*e);return t<1e8?1e8:t>5e8?5e8:t}_clearStoreForThisSession(){this.setMaxSize(0),this.updateMaxSizeInterval&&(clearInterval(this.updateMaxSizeInterval),this.updateMaxSizeInterval=null)}}t.default=_},62749:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"IdbMetaInfoTable",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(t,"metaInfoPrimaryIndex",{enumerable:!0,get:function(){return o.metaInfoPrimaryIndex}}),Object.defineProperty(t,"metaInfoDateIndex",{enumerable:!0,get:function(){return o.metaInfoDateIndex}}),Object.defineProperty(t,"metaInfoSizeIndex",{enumerable:!0,get:function(){return o.metaInfoSizeIndex}}),Object.defineProperty(t,"IdbArrayBufferTable",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(t,"storePrimaryIndex",{enumerable:!0,get:function(){return u.storePrimaryIndex}}),Object.defineProperty(t,"storeDataIndex",{enumerable:!0,get:function(){return u.storeDataIndex}}),t.initialize=void 0;var i=n(r(25291)),s=n(r(7128)),o=a(r(26666)),u=a(r(67457)),l=(0,i.default)((()=>s.default.initialize()));t.initialize=l},84233:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(19976)),i=a(r(52954)),s=r(39329),o=a(r(76968)),u=r(57337),l=a(r(61941));function d(){var e=(0,n.default)(["Invalid size in index ",": ",""]);return d=function(){return e},e}function c(){var e=(0,n.default)(["Error while purging during setMaxSize: ",""]);return c=function(){return e},e}function f(){var e=(0,n.default)(["Error while purging: ",""]);return f=function(){return e},e}function p(){var e=(0,n.default)(["SizeLRUObjectStore: _dispose error: ",""]);return p=function(){return e},e}function h(){var e=(0,n.default)(["SizeLruObjectStore: _purge error: No row returned but currentSize (",") > maxSize (","). Row count is "," (may be out of date)."]);return h=function(){return e},e}class _ extends o.default{constructor(e,t){var r;if(super(),r=this,this._enqueue=(0,u.createEnqueue)(),this._purge=()=>{if(this._pendingPurgePromise)return this._pendingPurgePromise;var e=this.open().then((()=>Promise.loop((e=>{var t=()=>{this._pendingPurgePromise=null,e()},a=this.getCurrentSize();if(!(null==a||a<=this._maxSize))return this.queryOneByIndex(this._dateIndex).then((e=>{var a=this.getCurrentSize(),n=this._maxSize;if(!(null==a||a<=n)){if(null==e)return(0,i.default)((function*(){var e=yield r.count();__LOG__(3,void 0,void 0,!0)(h(),a,n,e),SEND_LOGS("size-lru-store-invalid-empty")}))(),Promise.reject(new Error("Query returned no result but currentSize > maxSize"));var s=e[this._primaryIndex];return this.del(s)}t()}));t()}))));return this._pendingPurgePromise=e},this._schedulePurge=()=>{this._purgeTimer.debounce(2e3)},this.doPut=this._enqueue(function(){var e=(0,i.default)((function*(e,t){if(t[r._primaryIndex]!==e)throw new Error("The key you provide does not match.");var a=yield r._store.get(e),n=null==a?0:r._getSize(a),i=r._getSize(t),s=yield r._store.put(e,t);return r._currentSize=(0,l.default)(r.getCurrentSize(),"_this.getCurrentSize()")-n+i,r._schedulePurge(),s}));return function(){return e.apply(this,arguments)}}()),this.doDel=this._enqueue(function(){var e=(0,i.default)((function*(e){var t=yield r._store.get(e);if(null!=t){try{yield r._dispose(e,t)}catch(e){throw __LOG__(3,void 0,void 0,!0)(p(),e.message),SEND_LOGS("size-lru-store-dispose-error"),e}yield r._store.del(e),r._currentSize=(0,l.default)(r.getCurrentSize(),"_this.getCurrentSize()")-r._getSize(t)}}));return function(){return e.apply(this,arguments)}}()),this._store=e,this._primaryIndex=t.primaryIndex,this._dateIndex=t.dateIndex,this._sizeIndex=t.sizeIndex,t.maxSize<0)throw new Error("Cannot set max size to a negative number");this._maxSize=Math.floor(t.maxSize),this._dispose=t.dispose,this._purgeTimer=new s.ShiftTimer((()=>{this._purge().catch((e=>{__LOG__(3)(f(),e.message)}))}))}getCurrentSize(){return this._currentSize}getMaxSize(){return this._maxSize}setMaxSize(e){return e<0?Promise.reject("Cannot set size to a negative number"):(this._maxSize=Math.floor(e),this._purgeTimer.cancel(),this._purge().catch((e=>{__LOG__(3)(c(),e.message)})))}putObject(e){var t=e[this._primaryIndex];return this.put(t,e)}_getSize(e){var t=e[this._sizeIndex];return"number"!=typeof t||t<0?(__LOG__(3)(d(),this._sizeIndex,t),0):t}doGet(e){return this._store.get(e)}queryOneByIndex(e){return this._store.queryByIndex(e,{limit:1}).then((e=>0===e.length?null:e[0]))}doQueryByIndex(e,t){return this._store.queryByIndex(e,t)}doGetAll(){return this._store.getAll()}doClear(){var e=this;return(0,i.default)((function*(){e._purgeTimer.cancel(),yield e._store.clear(),e._currentSize=0}))()}doCount(){return this._store.count()}doOpen(){var e=this;return(0,i.default)((function*(){if(yield e._store.open(),null==e._currentSize){var t=yield e._store.doGetAll();e._currentSize=t.reduce(((t,r)=>t+e._getSize(r)),0)}}))()}doClose(){return this._currentSize=null,this._store.close()}}t.default=_},90382:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.MediaStore=void 0;var n=a(r(19976)),i=a(r(52954)),s=a(r(25291)),o=a(r(68689)),u=a(r(94620)),l=r(96452),d=a(r(47872)),c=a(r(71219)),f=a(r(65882)),p=a(r(66823));function h(){var e=(0,n.default)(["Failed to initialize media store! Falling back to dummy (no-op) storage. Error:\n",""]);return h=function(){return e},e}function _(){var e=(0,n.default)(["There was a security error attempting to open the media storage. This likely indicates a permissions error. Falling back to dummy (no-op) storage."],["There was a security error attempting to open the media storage. \\\nThis likely indicates a permissions error. Falling back to dummy \\\n(no-op) storage."]);return _=function(){return e},e}var m=Number.MAX_SAFE_INTEGER,g="media_lru",v="lru-media-array-buffer-cache";class E{constructor(){this._getBackingStore=(0,s.default)((0,i.default)((function*(){try{var e=function(){if(null!=c.default&&"caches"in self)return new f.default({name:g,maxSize:m,createArrayBufferStore:()=>new o.default(v)});if(null!=c.default)return new f.default({name:g,maxSize:m,createArrayBufferStore:e=>new d.default(e)})}();if(null!=e)return yield e.open(),e}catch(e){if("SecurityError"===e.name)__LOG__(3)(_());else{if(e instanceof l.DbOnLogoutAbort)throw e;__LOG__(4,!0,new Error,!0)(h(),(0,p.default)(e)),SEND_LOGS("Failed to initialize media store")}}return new u.default})))}get(e){var t=this;return(0,i.default)((function*(){return(yield t._getBackingStore()).get(e)}))()}queryByIndex(e,t){var r=this;return(0,i.default)((function*(){return(yield r._getBackingStore()).queryByIndex(e,t)}))()}getAll(){var e=this;return(0,i.default)((function*(){return(yield e._getBackingStore()).getAll()}))()}put(e,t){var r=this;return(0,i.default)((function*(){return(yield r._getBackingStore()).put(e,t)}))()}del(e){var t=this;return(0,i.default)((function*(){var r=yield t._getBackingStore();yield r.del(e)}))()}count(){var e=this;return(0,i.default)((function*(){return(yield e._getBackingStore()).count()}))()}clear(){var e=this;return(0,i.default)((function*(){var t=yield e._getBackingStore();yield t.clear()}))()}open(){var e=this;return(0,i.default)((function*(){var t=yield e._getBackingStore();yield t.open()}))()}close(){var e=this;return(0,i.default)((function*(){var t=yield e._getBackingStore();yield t.close()}))()}}t.MediaStore=E;var y=new E;t.default=y},28278:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.downloadMsg=function(e){var{msg:t,isUserClick:r,mode:a,downloadEvenIfExpensive:n,rmrReason:i,rmrData:s}=e,{mediaObject:o}=t;return o?o.getPendingProcess("fromDisk").then((()=>(r&&o.userDownloadAttemptCount++,(0,w.downloadMedia)({mimetype:t.mimetype,mediaObject:o,downloadEvenIfExpensive:n,mediaType:(0,C.msgToMediaType)(t),rmrReason:i,rmrData:s,downloadOrigin:we(t),isVcardOverMmsDocument:t.isVcardOverMmsDocument,mode:a}).then((()=>{o.userDownloadAttemptCount=0}))))):(__LOG__(4,void 0,new Error,!0)(Ae(),t.id.toString(),t.type),SEND_LOGS("media-fault: downloadMsg msg without mediaObject"),Promise.resolve())},t.cancelDownloadMedia=Me,t.checkExistence=function(){return Ie.apply(this,arguments)},t.cancelDownloadMsg=function(e){e.mediaObject?Me(e.mediaObject):e.mediaObject||(__LOG__(4,void 0,new Error,!0)(be(),e.id.toString(),e.type),SEND_LOGS("media-fault: cancelDownloadMsg msg without mediaObject"))},t.prepRawMedia=function(e,t){var r;__LOG__(2)(Te()),r=t.isPtt?A.OUTWARD_TYPES.PTT:t.asDocument?A.OUTWARD_TYPES.DOCUMENT:t.asGif?A.OUTWARD_TYPES.VIDEO:t.isAudio?A.OUTWARD_TYPES.AUDIO:A.OUTWARD_TYPES.UNKNOWN;var a=Promise.resolve(e).then((e=>(e.autoreleaseWhenPromiseCompletes(a),(0,N.default)(e,t))));return new Oe(r,a)},t.forwardMediaMsg=function(e,t,r=!1){__LOG__(2)(Se());var a=e.mediaObject;if(!a)return __LOG__(4,void 0,new Error,!0)(ye(),e.id.toString(),e.type),SEND_LOGS("media-fault: forwardMediaMsg msg without mediaObject"),Promise.reject("non initialized media");var n=e.mediaData.toJSON();n.preview&&(n.preview=a.contentInfo._preview);n.mediaBlob&&n.mediaBlob.retain();var i=n.isGif?{isGif:!0}:{};n.type===A.OUTWARD_TYPES.PTT&&(n.type=A.OUTWARD_TYPES.AUDIO);var s={businessOwnerJid:e.businessOwnerJid,productId:e.productId,currencyCode:e.currencyCode,priceAmount1000:e.priceAmount1000,retailerId:e.retailerId,url:e.url,productImageCount:e.productImageCount,title:e.title,description:e.description};return new Oe(n.type,Promise.resolve(n)).sendToChat(t,{forwardedFromWeb:!0,caption:n.type===A.OUTWARD_TYPES.DOCUMENT?e.caption:void 0,addEvenWhilePreparing:!0,placeholderProps:i,isForwarded:e.isForwarded||!e.isSentByMe,forwardingScore:e.getForwardingScoreWhenForwarded(),multicast:r,productMsgOptions:s}).then((t=>{var r;n.type===A.OUTWARD_TYPES.STICKER&&new O.default.StickerSend({stickerSendOrigin:O.default.STICKER_SEND_ORIGIN_TYPE.FORWARD,stickerIsAnimated:Boolean(null===(r=e.mediaData)||void 0===r?void 0:r.isAnimated)}).commit();return t}))},t.cancelUploadMedia=Re,t.cancelUploadMsg=function(e){e.mediaObject?Re(e.mediaObject):(__LOG__(4,void 0,new Error,!0)(Ee(),e.id.toString(),e.type),SEND_LOGS("media-fault: cancelUploadMsg msg without mediaObject"))},t.resumeUploadMsg=function(e){var{mediaObject:t}=e;if(!t)return __LOG__(4,void 0,new Error,!0)(ve(),e.id.toString(),e.type),SEND_LOGS("media-fault: resumeUploadMsg msg without mediaObject"),Promise.resolve();t.userUploadAttemptCount++;var r=(0,M.uploadMedia)({mimetype:e.mimetype,mediaObject:t,mediaType:(0,C.msgToMediaType)(e),forwardedFromWeb:Boolean(e.forwardedFromWeb),uploadOrigin:De(e.chat)}).then((({mediaEntry:r})=>{if(!r)throw new Error("upload failed: media entry was not created");t.userUploadAttemptCount=0;var a={deprecatedMms3Url:r.deprecatedMms3Url,directPath:r.directPath,mediaKey:r.mediaKey,mediaKeyTimestamp:r.mediaKeyTimestamp,filehash:t.filehash,encFilehash:r.encFilehash,size:t.size,streamingSidecar:r.sidecar,firstFrameSidecar:r.firstFrameSidecar};return He(e,a).then((()=>e))}));return(0,U.sendMsgToChat)(e.chat,r).catch((()=>{e.ack=p.default.ACK.FAILED}))},t.mediaMetadata=function(e){var t=e.mediaObject;if(!t)throw __LOG__(4,void 0,new Error,!0)(ge(),e.id.toString(),e.type),SEND_LOGS("media-fault: mediaMetadata msg without mediaObject"),new Error("msg.mediaMetadata with no mediaObject");var r=t.entries.getEntryByEncFilehash({encFilehash:e.encFilehash,deprecatedMms3Url:e.deprecatedMms3Url});if(!r)throw __LOG__(4,void 0,new Error,!0)(me(),e.id.toString(),e.type),SEND_LOGS("media-fault: mediaMetadata no entry"),new Error("msg.mediaMetadata with entry mismatch");var a=e.mediaData;return{url:r.deprecatedMms3Url,directPath:r.directPath,encFilehash:r.encFilehash,mediaKey:r.mediaKey,mediaKeyTimestamp:r.mediaKeyTimestamp,filehash:e.filehash,type:a.type,mimetype:a.mimetype,filename:a.filename,duration:a.duration,width:a.fullWidth,height:a.fullHeight,firstFrameLength:a.firstFrameLength,isAnimated:a.isAnimated,thumbnailDirectPath:e.thumbnailDirectPath,thumbnailSha256:e.thumbnailSha256,thumbnailEncSha256:e.thumbnailEncSha256,thumbnailHeight:e.thumbnailHeight,thumbnailWidth:e.thumbnailWidth}},t.videoStreamingInfo=function(e){var t=e.mediaObject;return t?t.videoStreamingInfo(e.id.toString()):null},t.manuallySetMedia=function({msg:e,media:t,rmrReason:r}){var a=e.mediaObject;if(!a)return;D.default.createFromData(t,e.mimetype).then((t=>{(0,w.manuallySetMedia)({mimetype:e.mimetype,mediaObject:a,mediaBlob:t,mediaType:(0,C.msgToMediaType)(e),rmrReason:r,downloadOrigin:we(e)})}))},t.clearMediaForChat=function(e){b.clearMediaForChat(e)},t.prepareMsg=function(e){var t=e.mediaObject;if(t)return t.resolveWhenConsolidated();var r=e.mediaData,a=r.preview;return!a||void 0!==r.aspectRatio||void 0!==r.fullWidth&&void 0!==r.fullHeight?Promise.resolve():(0,P.getImageWidthHeight)(a).then((({width:t,height:r})=>{e.mediaObject||e.mediaData.set({aspectRatio:t/r})}))},t.registerMsgEarly=function(e,t){e.isUnsentPhoneMsg()&&(__LOG__(4,void 0,new Error,!0)(_e(),e.id.toString(),e.type),SEND_LOGS("media-fault: registerMsgEarly msg without mediaObject"));for(var r={},a=0;a<A.MEDIA_MSG_PROPS.length;a++){var n=A.MEDIA_MSG_PROPS[a],i=t[n];r[n]=void 0!==i?i:e[n]}r.mimetype||r.type!==A.OUTWARD_TYPES.IMAGE||(t.mimetype=r.mimetype="image/jpeg");e.on(Pe,Ne),Ke(e,r,O.default.WEBC_RMR_REASON_CODE.MSG_UPDATE);for(var s={},o=0;o<A.MSG_SPECIFIC_FIELDS.length;o++){var u=A.MSG_SPECIFIC_FIELDS[o];s[u]=r[A.MEDIA_TO_MSG[u]]}e.mediaData.set(s)},t.registerMsg=function(e){e.mimetype||e.type!==A.OUTWARD_TYPES.IMAGE||(e.mimetype="image/jpeg");e.mimetype||e.type!==A.OUTWARD_TYPES.STICKER||(e.mimetype="image/webp");e.on(Pe,Ne),Le(e,O.default.WEBC_RMR_REASON_CODE.MSG_INIT)},t.deregisterMsg=function(e){e.off(null,Ne);var t=e.mediaObject;t&&b.disassociateMediaFromMsg(t,e)},t.downloadMmsThumbnail=ke,t.downloadProgressiveJpegThumbnail=Ge,t.downloadStatusV3Thumbnail=function(){return Be.apply(this,arguments)},t.downloadVideoThumbnail=function(){return Ye.apply(this,arguments)},t.registerSticker=function(e){qe(e,e.mediaObject||function(e){if(!e.filehash)return __LOG__(4,void 0,new Error,!0)(se()),void SEND_LOGS("sticker-filehash-error");var t=b.getOrCreateMediaObject(e.filehash);return b.associateMediaWithSticker(t,e),t}(e),C.default.STICKER)},t.deregisterSticker=function(e){var{mediaObject:t}=e;t&&b.disassociateMediaFromSticker(t,e)},t.registerStickerPackIcon=function(e){qe(e,e.mediaObject||function(e){if(!e.filehash)return __LOG__(4,void 0,new Error,!0)(ie()),void SEND_LOGS("sticker-pack-filehash-error");var t=b.getOrCreateMediaObject(e.filehash);return b.associateMediaWithStickerPack(t,e),t}(e),C.default.IMAGE)},t.deregisterStickerPackIcon=function(e){var{mediaObject:t}=e;t&&b.disassociateMediaFromStickerPack(t,e)},t.downloadStickerOrStickerPackIcon=function(e,t){if(e.isPlaceholder)return e.mediaData.mediaStage=A.MEDIA_DATA_STAGE.PREPARING,Promise.resolve();var r=e.mediaObject;if(!r)return Promise.reject(new Error("media-fault: downloadStickerOrStickerPackIcon sticker/stickerPack without mediaObject"));if(r.downloadStage===A.DOWNLOAD_STAGE.RESOLVED)return Promise.resolve();var a="STICKER"===t?O.default.WEBC_RMR_REASON_CODE.STICKER_PANEL_STICKER:O.default.WEBC_RMR_REASON_CODE.STICKER_PANEL_ICON;return r.getPendingProcess("fromDisk").then((()=>{if(!g.default.supportsFeature(g.default.F.MD_BACKEND)&&!e.deprecatedMms3Url||!e.filehash||!e.mediaKey||!e.encFilehash)return h.default.rmr({mediaObject:r,signal:(new d.default).signal,rmrReason:a})})).then((()=>(0,w.downloadMedia)({mimetype:e.mimetype,mediaObject:e.mediaObject,downloadEvenIfExpensive:!0,mediaType:(0,C.msgToMediaType)({type:e.type,isGif:!1}),rmrReason:a,downloadOrigin:O.default.DOWNLOAD_ORIGIN_TYPE.STICKER_PICKER,shouldThrow:!0})))},t.prepSticker=function(e){__LOG__(2)(ne());var t=e.mediaObject,r=e.mediaData.toJSON();if(r.fullWidth=125,r.fullHeight=125,!t)return __LOG__(4,void 0,new Error,!0)(ae(),e.id),SEND_LOGS("media-fault: prepSticker sticker without mediaObject"),new Oe(r.type,Promise.reject("non initialized media"));return new Oe(r.type,Promise.resolve(r))},t.uploadProductImage=function(e,t){return(0,_.blobToArrayBuffer)(e.forceToBlob()).then((e=>E.default.unencryptedUpload({file:e,hash:t,signal:(new d.default).signal,type:C.default.PRODUCT_CATALOG_IMAGE,uploadOrigin:O.default.UPLOAD_ORIGIN_TYPE.PRODUCT_CATALOG}))).then((e=>new URL(e.directPath,"https://mmg.whatsapp.net").toString()))},t.MediaPrep=void 0;var i=n(r(70417)),s=n(r(52954)),o=n(r(19976)),u=r(73559),l=n(r(47677)),d=n(r(12489)),c=r(8701),f=n(r(19899)),p=n(r(50935)),h=n(r(1616)),_=r(99888),m=r(95595),g=n(r(18120)),v=a(r(44202)),E=n(r(14258)),y=n(r(54146)),S=n(r(8603)),T=n(r(24008)),b=a(r(53882)),A=r(96645),C=a(r(81135)),P=r(82982),O=n(r(40210)),w=r(8401),M=r(78460),I=n(r(77865)),R=n(r(61941)),D=n(r(25012)),N=n(r(73698)),L=n(r(96598)),k=n(r(49213)),U=r(95721),F=r(59420),G=n(r(66823)),x=n(r(72424)),B=r(64658),Y=r(86405),K=r(4526),j=n(r(74185)),W=r(75637);function V(){var e=(0,o.default)(["media.downloadVideoThumbnail: error\n",""],["media.downloadVideoThumbnail: error\\n",""]);return V=function(){return e},e}function H(){var e=(0,o.default)(["media.downloadVideoThumbnail: success"]);return H=function(){return e},e}function q(){var e=(0,o.default)(["media.downloadVideoThumbnail: start"]);return q=function(){return e},e}function z(){var e=(0,o.default)(["media.downloadProgressiveJpegThumbnail: error\n",""],["media.downloadProgressiveJpegThumbnail: error\\n",""]);return z=function(){return e},e}function J(){var e=(0,o.default)(["media.downloadProgressiveJpegThumbnail aborted"]);return J=function(){return e},e}function Q(){var e=(0,o.default)(["media.downloadProgressiveJpegThumbnail: success"]);return Q=function(){return e},e}function X(){var e=(0,o.default)(["media.downloadProgressiveJpegThumbnail: start"]);return X=function(){return e},e}function Z(){var e=(0,o.default)(["media.downloadMmsThumbnail: error\n",""],["media.downloadMmsThumbnail: error\\n",""]);return Z=function(){return e},e}function $(){var e=(0,o.default)(["media.downloadMmsThumbnail aborted"]);return $=function(){return e},e}function ee(){var e=(0,o.default)(["media.downloadMmsThumbnail: success"]);return ee=function(){return e},e}function te(){var e=(0,o.default)(["media.downloadMmsThumbnail: start"]);return te=function(){return e},e}function re(){var e=(0,o.default)(["checkExistence msg without mediaObject, id: "," type: ",""]);return re=function(){return e},e}function ae(){var e=(0,o.default)(["id: ",""]);return ae=function(){return e},e}function ne(){var e=(0,o.default)(["Prepping sticker"]);return ne=function(){return e},e}function ie(){var e=(0,o.default)(["Unexpected sticker pack with no filehash"]);return ie=function(){return e},e}function se(){var e=(0,o.default)(["Unexpected sticker with no filehash"]);return se=function(){return e},e}function oe(){var e=(0,o.default)(["upload failed: thumbnail data incomplete\nDebug info:",""],["upload failed: thumbnail data incomplete\\nDebug info:",""]);return oe=function(){return e},e}function ue(){var e=(0,o.default)(["Assertion failed!"]);return ue=function(){return e},e}function le(){var e=(0,o.default)(["Media:sendToChat error\nresult: ","\nuploadStage: ","\nuploadResultKind: ","\nerror: ",""],["Media:sendToChat error\\nresult: ","\\nuploadStage: ","\\nuploadResultKind: ","\\nerror: ",""]);return le=function(){return e},e}function de(){var e=(0,o.default)(["Media:sendToChat canceled"]);return de=function(){return e},e}function ce(){var e=(0,o.default)(["Assertion failed!"]);return ce=function(){return e},e}function fe(){var e=(0,o.default)(["Media:sendToChat chat ",""]);return fe=function(){return e},e}function pe(){var e=(0,o.default)(["media:msg "," "," filehash"]);return pe=function(){return e},e}function he(){var e=(0,o.default)(["id: "," type: ",""]);return he=function(){return e},e}function _e(){var e=(0,o.default)(["id: "," type: ",""]);return _e=function(){return e},e}function me(){var e=(0,o.default)(["id: "," type: ",""]);return me=function(){return e},e}function ge(){var e=(0,o.default)(["id: "," type: ",""]);return ge=function(){return e},e}function ve(){var e=(0,o.default)(["id: "," type: ",""]);return ve=function(){return e},e}function Ee(){var e=(0,o.default)(["id: "," type: ",""]);return Ee=function(){return e},e}function ye(){var e=(0,o.default)(["id: "," type: ",""]);return ye=function(){return e},e}function Se(){var e=(0,o.default)(["Prepping media msg"]);return Se=function(){return e},e}function Te(){var e=(0,o.default)(["Prepping raw media"]);return Te=function(){return e},e}function be(){var e=(0,o.default)(["id: "," type: ",""]);return be=function(){return e},e}function Ae(){var e=(0,o.default)(["id: "," type: ",""]);return Ae=function(){return e},e}function Ce(){var e=(0,o.default)(["Assertion failed!"]);return Ce=function(){return e},e}var Pe="change:phoneUploading change:ack ".concat(A.MEDIA_MSG_PROPS.map((e=>"change:".concat(e))).join(" "));class Oe{constructor(e,t){this._baseType=e,this._mediaData=new S.default({mediaStage:A.MEDIA_DATA_STAGE.PREPARING}),this._prepwork=t.then((e=>{if(this._mediaData.set(e),!e.filehash)return e.mediaBlob||(__LOG__(4,void 0,new Error,!0)(Ce()),SEND_LOGS("media-fault: no hash or blob")),(0,Y.getHash)(e.mediaBlob).then((e=>{this._mediaData.filehash=e}))}),(e=>(this._mediaData.mediaStage=A.MEDIA_DATA_STAGE.ERROR_UNSUPPORTED,Promise.reject(e))))}sendToChat(e,t){return(0,u.callSyncPromise)(Ve,null,this,e,t)}waitForPrep(){return this._prepwork.then((()=>this._mediaData))}}function we(e){return e.asProduct?O.default.DOWNLOAD_ORIGIN_TYPE.PRODUCT_CATALOG:e.isStatusV3?O.default.DOWNLOAD_ORIGIN_TYPE.STATUS_USER:e.isGroupMsg?O.default.DOWNLOAD_ORIGIN_TYPE.CHAT_GROUP:O.default.DOWNLOAD_ORIGIN_TYPE.CHAT_PERSONAL}function Me(e){(0,w.cancelDownloadMedia)(e)}function Ie(){return(Ie=(0,s.default)((function*(e){if(yield e.waitForPhoneUpload(),!e.mediaObject)return __LOG__(4,void 0,new Error,!0)(re(),e.id.toString(),e.type),void SEND_LOGS("media-fault: checkExistence msg without mediaObject");yield(0,w.checkExistence)({mimetype:e.mimetype,mediaObject:e.mediaObject,mediaType:(0,C.msgToMediaType)({type:e.type,isGif:!1})})}))).apply(this,arguments)}function Re(e){(0,M.cancelUploadMedia)(e)}function De(e){return e?(0,B.unproxy)(e).isGroup?O.default.UPLOAD_ORIGIN_TYPE.CHAT_GROUP:O.default.UPLOAD_ORIGIN_TYPE.CHAT_PERSONAL:O.default.UPLOAD_ORIGIN_TYPE.UNKNOWN}function Ne(e){Le(e,O.default.WEBC_RMR_REASON_CODE.MSG_UPDATE)}function Le(e,t){if(e.isUnsentPhoneMsg()){e.mediaObject&&(__LOG__(4,void 0,new Error,!0)(he(),e.id.toString(),e.type),SEND_LOGS("media-fault: consolidateMediaUpdate unsent message"));var r=je(e);if(r.hasOwnProperty("preview")){var a=r.preview;delete r.preview,a&&D.default.createFromBase64Jpeg(a).then((t=>{e&&e.mediaData&&e.isUnsentPhoneMsg()&&(e.mediaData.preview=t)}))}e.mediaData.set((0,i.default)((0,i.default)({},r),{},{mediaStage:e.phoneUploading?A.MEDIA_DATA_STAGE.REMOTE_UPLOADING:A.MEDIA_DATA_STAGE.REMOTE_NEED_UPLOAD}))}else Ke(e,e,t)}function ke(){return Ue.apply(this,arguments)}function Ue(){return(Ue=(0,s.default)((function*(e){var{msg:t,isPreload:r,signal:a}=e,{thumbnailSha256:n,thumbnailEncSha256:i,thumbnailDirectPath:s}=t;if(s&&i&&n&&(t.type!==C.default.DOCUMENT||null!=t.thumbnailHeight&&null!=t.thumbnailWidth)){__LOG__(2)(te());try{var o=yield h.default.downloadAndDecrypt({directPath:s,encFilehash:i,filehash:n,mediaKey:t.mediaKey,mediaKeyTimestamp:t.mediaKeyTimestamp,type:Fe(t),signal:a||(new d.default).signal,userDownloadAttemptCount:0,isPreload:r}),u=(0,R.default)(t.mediaObject,"mediaObject cannot be null for thumbnail download"),l={fullPreviewData:yield D.default.createFromData(o,"image/jpeg")};t.type===p.default.MSG_TYPE.DOCUMENT&&(l.fullPreviewSize={height:(0,R.default)(t.thumbnailHeight,"msg.thumbnailHeight"),width:(0,R.default)(t.thumbnailWidth,"msg.thumbnailWidth")}),u.consolidate(l),__LOG__(2)(ee())}catch(e){if(e.name===c.ABORT_ERROR)return void __LOG__(2)($());__LOG__(3,!0)(Z(),(0,G.default)(e))}}}))).apply(this,arguments)}function Fe(e){switch(e.type){case p.default.MSG_TYPE.DOCUMENT:return C.default.THUMBNAIL_DOCUMENT;case p.default.MSG_TYPE.VIDEO:return C.default.THUMBNAIL_VIDEO;case p.default.MSG_TYPE.IMAGE:default:return C.default.THUMBNAIL_IMAGE}}function Ge(){return xe.apply(this,arguments)}function xe(){return(xe=(0,s.default)((function*(e){var{msg:t,isPreload:r,signal:a}=e;__LOG__(2)(X());try{var n=(0,R.default)(t.scanLengths,"msg.scanLengths"),i=(0,R.default)(t.scansSidecar,"msg.scansSidecar"),s=(0,R.default)(t.mediaObject,"msg.mediaObject"),o=(0,R.default)(s.filehash,"mediaObject.filehash"),{encFilehash:u,directPath:l}=t,f=yield h.default.downloadAndDecrypt({directPath:l,encFilehash:u,filehash:o,mediaKey:t.mediaKey,mediaKeyTimestamp:t.mediaKeyTimestamp,type:C.default.IMAGE,signal:a||(new d.default).signal,userDownloadAttemptCount:0,progressiveJpegOpts:{mimetype:"image/jpeg",scansSidecar:i,scanLengths:n,scanCount:1},isPreload:r});s.consolidate({fullPreviewData:yield D.default.createFromData(f,"image/jpeg")}),__LOG__(2)(Q())}catch(e){if(e.name===c.ABORT_ERROR)return void __LOG__(2)(J());__LOG__(3,void 0,void 0,!0)(z(),(0,G.default)(e)),SEND_LOGS("download-pjpeg-thumbnail-failed")}}))).apply(this,arguments)}function Be(){return(Be=(0,s.default)((function*(e){var{msg:t,isPreload:r,signal:a}=e,{encFilehash:n,thumbnailSha256:i,thumbnailEncSha256:s,thumbnailDirectPath:o}=t;t.type===p.default.MSG_TYPE.IMAGE&&t.scanLengths&&t.scansSidecar&&n?yield Ge({msg:t,signal:a,isPreload:r}):i&&s&&o&&(yield ke({msg:t,signal:a,isPreload:r}))}))).apply(this,arguments)}function Ye(){return(Ye=(0,s.default)((function*(e){var{msg:t}=e,{encFilehash:r,filehash:a,directPath:n}=t;if(r&&a&&n){__LOG__(2)(q());try{var i=Math.max(parseInt(t.mediaData.duration,10),1),s={video:{size:t.mediaData.size,duration:i},secondsToDownload:1},o=yield h.default.downloadAndDecrypt({directPath:n,encFilehash:r,filehash:a,mediaKey:t.mediaKey,mediaKeyTimestamp:t.mediaKeyTimestamp,type:C.default.VIDEO,signal:(new d.default).signal,userDownloadAttemptCount:0,partialVideoOpts:s,isPreload:!0}),u=new Blob([o],{type:"video/mp4"}),{thumbs:[l]}=yield v.generateVideoThumbsAndDuration(u,[p.default.VIDEO_THUMB_MAX_EDGE]),c=yield D.default.createFromBase64Jpeg(j.default.parseDataURL(l.url).data),f=(0,R.default)(t.mediaObject,"mediaObject cannot be null for thumbnail download"),_={fullPreviewData:c,fullWidth:l.fullWidth,fullHeight:l.fullHeight};f.consolidate(_),__LOG__(2)(H())}catch(e){__LOG__(3,!0)(V(),(0,G.default)(e))}}}))).apply(this,arguments)}function Ke(e,t,r){var a=je(t),n=e.mediaObject,i=t.filehash;if(n)i&&i!==n.filehash&&(__LOG__(2)(pe(),e.id.toString(),n.filehash?"changed":"added"),b.disassociateMediaFromMsg(n,e),n=b.getOrCreateMediaObject(i),e.mediaObject=n,b.associateMediaWithMsg(n,e));else{n=i?b.getOrCreateMediaObject(i):new T.default;var s=e.mediaData;void 0!==s.aspectRatio&&(a.aspectRatio=s.aspectRatio),e.mediaObject=n,b.associateMediaWithMsg(n,e)}var o=!1,{deprecatedMms3Url:u,mediaKey:l,mediaKeyTimestamp:d,encFilehash:c,type:f,streamingSidecar:p,firstFrameSidecar:h,directPath:_,scansSidecar:m,scanLengths:g}=t;if(u||c){var v,E=~C.MEDIA_TYPE_VALUES.indexOf(f)?f:null;(o=!n.entries.has({encFilehash:c,deprecatedMms3Url:u}))?l&&E&&c?v=n.entries.addEntry({deprecatedMms3Url:u,mediaKey:l,mediaKeyTimestamp:d,encFilehash:c,type:E,sidecar:p,directPath:_,firstFrameSidecar:h,scansSidecar:m,scanLengths:g,debugHint:"consolidate"}):o=!1:l&&(v=n.entries.updateEntry({deprecatedMms3Url:u,mediaKey:l,mediaKeyTimestamp:d,encFilehash:c,type:E,sidecar:p,directPath:_,firstFrameSidecar:h,scansSidecar:m,scanLengths:g})),v||(o=!1),o&&n.downloadStage===A.DOWNLOAD_STAGE.ERROR_MISSING&&(a.downloadStage=A.DOWNLOAD_STAGE.INIT)}if(n.consolidate(a)||n.notifyMsgsAsync(),o&&n.downloadStage===A.DOWNLOAD_STAGE.NEED_POKE){var y;try{y=(0,C.msgToMediaType)(e)}catch(r){if(!t.type)throw r;y=(0,C.msgToMediaType)({type:t.type,isGif:e.isGif})}(0,w.downloadMedia)({mimetype:t.mimetype,mediaObject:n,downloadEvenIfExpensive:!1,mediaType:y,rmrReason:r,downloadOrigin:we(e)})}}function je(e){var t={};return A.MAPPED_MSG_PROPS.forEach((r=>{var a=e[r],n=A.MSG_TO_MEDIA[r];t[n]=a})),t}function We(e,t){return"product"===t.type?O.default.DOWNLOAD_ORIGIN_TYPE.PRODUCT_CATALOG:(0,B.unproxy)(e).isGroup?O.default.DOWNLOAD_ORIGIN_TYPE.CHAT_GROUP:O.default.DOWNLOAD_ORIGIN_TYPE.CHAT_PERSONAL}function Ve(e,t,r){__LOG__(2)(fe(),t.id.toString());var a,n,o=r.caption,u=r.quotedMsg?r.quotedMsg.msgContextInfo(t.id):{},d=(0,m.getMaybeMeUser)(),c=r.productMsgOptions||{},h=void 0;if(!t.isUser&&g.default.supportsFeature(g.default.F.MD_BACKEND)&&(h=(0,W.toUserWid)(d)),x.default.ephemeralMessages){t.isEphemeralSettingOn()&&(a=t.getEphemeralSetting());var _=t.getEphemeralSettingTimestamp();null!=_&&(n=_)}var v,E,S,T=(0,i.default)({t:f.default.globalUnixTime(),from:d,isNewMsg:!0,to:t.id,self:"out",type:e._baseType,ack:p.default.ACK.CLOCK,local:!0,id:new I.default({from:d,to:t.id,id:(0,k.default)(),participant:h,selfDir:"out"}),caption:o,quotedMsg:u.quotedMsg,quotedParticipant:u.quotedParticipant,quotedStanzaID:u.quotedStanzaID,quotedRemoteJid:u.quotedRemoteJid,mentionedJidList:r.mentionedJidList,isForwarded:r.isForwarded,forwardingScore:r.forwardingScore,multicast:r.multicast,forwardedFromWeb:r.forwardedFromWeb,ctwaContext:r.ctwaContext,ephemeralDuration:a,ephemeralSettingTimestamp:n},c),R=e.waitForPrep().then((e=>{var t=e.mediaBlob;return!t||t instanceof D.default?Promise.resolve(e):D.default.createFromData(t,t.type).then((t=>(e.mediaBlob=t,e)))})).then((e=>{var a=e.filehash;a||(__LOG__(4,void 0,new Error,!0)(ce()),SEND_LOGS("media-fault: sendToChat filehash undefined"));var n=b.getOrCreateMediaObject(a),i=n.mediaBlob;if(i&&(i.retain(),e.mediaBlob&&e.mediaBlob.autorelease(),e.mediaBlob=i),e.mediaBlob&&(e.renderableUrl=e.mediaBlob.url()),n.consolidate(e.toJSON()),e.mediaBlob&&e.mediaBlob.autorelease(),(0,P.shouldUseMediaCache)((0,C.castToV4)(n.type))&&e.mediaBlob){var s=e.mediaBlob.formData();y.default.put(a,s)}(0,w.downloadMedia)({mimetype:e.mimetype,mediaObject:n,downloadEvenIfExpensive:!0,mediaType:(0,C.msgToMediaType)({type:e.type,isGif:e.isGif}),rmrReason:O.default.WEBC_RMR_REASON_CODE.SEND_TO_CHAT,downloadOrigin:We(t,T),mode:"manual"});var u=n.msgProps(e);return u.caption=o,o||e.type!==A.OUTWARD_TYPES.DOCUMENT||(u.caption=e.filename),x.default.viewOnceWrite&&r.isViewOnce&&(u.isViewOnce=!0),u}));function N(){return G.apply(this,arguments)}function G(){return(G=(0,s.default)((function*(e){v=e;var{mediaObject:r}=e;r||(__LOG__(4,void 0,new Error,!0)(ue()),SEND_LOGS("media-fault: incorrect media object for created msg")),(0,l.default)(r,"msg is missing mediaObject");var a=(0,C.msgToMediaType)(e),n=r.entries.getUploadEntry(),s=n?{key:n.mediaKey,timestamp:n.mediaKeyTimestamp}:(0,L.default)(),{fullPreviewData:o,fullPreviewSize:u}=r.contentInfo,d=o&&ze(a),c=o&&d?Je(e,o,a,s):Promise.resolve(null),f=(0,M.uploadMedia)({mimetype:e.mimetype,mediaObject:r,mediaType:a,forwardedFromWeb:Boolean(e.forwardedFromWeb),uploadOrigin:De(t),mediaKeyInfo:s}),[{kind:p,mediaEntry:h},_]=yield Promise.all([f,c]),m=null==_?void 0:_.uploadMediaResult.mediaEntry;if(E=p,!h)throw new Error("upload failed: media entry was not created");var g={};if(d){if(!(m&&_&&u))throw __LOG__(4,void 0,new Error,!0)(oe(),JSON.stringify({thumbnailResultEntry:m,uploadThumbnailResult:_,fullPreviewSize:u})),SEND_LOGS("mms-thumbnail-data-incomplete"),new Error("upload failed: thumbnail data incomplete");g={thumbnailDirectPath:m.directPath,thumbnailSha256:_.filehash,thumbnailEncSha256:m.encFilehash,thumbnailHeight:u.height,thumbnailWidth:u.width}}return He(v,(0,i.default)({deprecatedMms3Url:h.deprecatedMms3Url,directPath:h.directPath,mediaKey:h.mediaKey,mediaKeyTimestamp:h.mediaKeyTimestamp,filehash:r.filehash,encFilehash:h.encFilehash,size:r.size,streamingSidecar:h.sidecar,firstFrameSidecar:h.firstFrameSidecar},g))}))).apply(this,arguments)}if(r.addEvenWhilePreparing){var B=r.placeholderProps||{};S=(0,U.addAndSendMsgToChat)(t,(0,i.default)((0,i.default)({},B),T),(e=>(v=e,R.then((e=>He(v,e))).then((()=>N(v))))))[1]}else{var Y=R.then((e=>{var t=r.useBasePropsType?T.type:e.type;return(0,i.default)((0,i.default)((0,i.default)({},T),e),{},{type:t})}));S=(0,U.addAndSendMsgToChat)(t,Y,N)[1]}return S.then((e=>({result:e,error:null}))).catch((e=>({result:null,error:e}))).then((({result:e,error:t})=>{var r,a;if(e===F.SendMsgResult.OK)return F.SendMsgResult.OK;var n=null===(r=v)||void 0===r||null===(a=r.mediaObject)||void 0===a?void 0:a.uploadStage;if(v&&(v.ack=p.default.ACK.FAILED),E===M.UploadMediaResultKind.CANCELLATION)return __LOG__(2)(de()),F.SendMsgResult.ERROR_CANCELLED;if(__LOG__(3)(le(),e,n,E,String(t)),null!=n)switch(n){case A.UPLOAD_STAGE.NEED_UPLOAD:case A.UPLOAD_STAGE.ERROR_TOO_LARGE:return F.SendMsgResult.ERROR_UPLOAD;case A.UPLOAD_STAGE.ERROR_MISSING:return F.SendMsgResult.ERROR_EXPIRED}return E===M.UploadMediaResultKind.ERROR?F.SendMsgResult.ERROR_UPLOAD:null!=e?e:F.SendMsgResult.ERROR_UNKNOWN}))}function He(e,t){return(0,K.updateLocal)(e.id,t).then((()=>{e.set(t)}))}function qe(e,t,r){var a,n,i=(a=e,n={},A.MAPPED_STICKER_PROPS.forEach((e=>{var t=a[e],r=A.MSG_TO_MEDIA[e];n[r]=t})),n);if(e.mediaData.set(i),t){e.mediaObject=t;var{deprecatedMms3Url:s,encFilehash:o}=e;if((o||s)&&!t.entries.has({encFilehash:o,deprecatedMms3Url:s}))t.entries.addEntry({deprecatedMms3Url:s,mediaKey:e.mediaKey,mediaKeyTimestamp:e.mediaKeyTimestamp,encFilehash:o,type:r,directPath:e.directPath,debugHint:"setMediaObjectValues"})&&t.downloadStage===A.DOWNLOAD_STAGE.ERROR_MISSING&&(i.downloadStage=A.DOWNLOAD_STAGE.INIT);t.consolidate(i)}}function ze(e){return x.default.webUploadDocumentThumbMmsEnabled&&e===C.default.DOCUMENT}function Je(){return Qe.apply(this,arguments)}function Qe(){return(Qe=(0,s.default)((function*(e,t,r,a){var{chat:n}=e,i=new T.default,s=yield(0,Y.getHash)(t);return i.filehash=s,i.mediaBlob=t,(0,M.uploadMedia)({mimetype:"image/jpeg",mediaObject:i,mediaType:"thumbnail-document",forwardedFromWeb:Boolean(e.forwardedFromWeb),uploadOrigin:De(n),mediaKeyInfo:a}).then((e=>({uploadMediaResult:e,filehash:s})))}))).apply(this,arguments)}t.MediaPrep=Oe},91063:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.checkAndRepair=function(e,t){var r=new s.default.WebcMediaAnalyzed;return(a={type:"prep",file:e,asGif:t},new Promise(((e,t)=>{__LOG__(2)(l()),i=n||new o.default,n=void 0,i.onmessage=r=>{try{r.data&&"log"===r.data.type?__LOG__(2)(u(),r.data.msg):e(r.data)}catch(e){t(e)}},i.onerror=e=>{t("Milan.onerror = ".concat(e&&e.message?e.message:e))},i.postMessage(a)})).finally((()=>{i&&(i.terminate(),n=new o.default)}))).then((({type:e,result:t,error:r,filename:a,file:n})=>{switch(e){case"result":return __LOG__(2)(h()),t;case"parsingError":return __LOG__(2)(p(),n,a,String(r)),n&&(__LOG__(4,void 0,new Error,!0)(f(),String(r)),SEND_LOGS("media-parsing-error")),void __LOG__(2)(c(),String(r))}})).catch((e=>{__LOG__(4,void 0,new Error,!0)(d(),String(e)),SEND_LOGS("media-detection-error")})).finally((t=>{if(r){var a=void 0;if(e.name){var n=e.name.split(".");n.length>1&&(a=n[n.length-1])}r.set({webcMediaSupported:!!t,webcMediaExtensions:a}),r.markWebcMediaAnalyzeT(),r.commit()}}));var a,i};var n,i=a(r(19976)),s=a(r(40210)),o=a(r(77012));function u(){var e=(0,i.default)(["(via Milan) ",""]);return u=function(){return e},e}function l(){var e=(0,i.default)(["MediaAnalyzer:sendMessageToWorker"]);return l=function(){return e},e}function d(){var e=(0,i.default)(["MediaAnalyzer:checkAndRepair got error! ",""]);return d=function(){return e},e}function c(){var e=(0,i.default)(["MediaAnalyzer:checkAndRepair rejected file (",")"]);return c=function(){return e},e}function f(){var e=(0,i.default)(["MediaAnalyzer:checkAndRepair got parsing error! ",""]);return f=function(){return e},e}function p(){var e=(0,i.default)(["trouble parsing file "," (fossil ",") ",""]);return p=function(){return e},e}function h(){var e=(0,i.default)(["MediaAnalyzer:checkAndRepair approved file"]);return h=function(){return e},e}},8603:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(r(70417)),s=a(r(61247)),o=r(46194),u=n(r(54146)),l=r(96645);class d extends s.default{constructor(...e){super(...e),this.type=(0,s.prop)(l.OUTWARD_TYPES.UNKNOWN),this.directPath=(0,s.prop)(),this.mediaKey=(0,s.prop)(),this.mediaKeyTimestamp=(0,s.prop)(),this.encFilehash=(0,s.prop)(),this.mediaStage=(0,s.prop)(l.MEDIA_DATA_STAGE.INIT),this.size=(0,s.prop)(),this.filehash=(0,s.prop)(),this.mimetype=(0,s.prop)(),this.mediaBlob=(0,s.prop)(),this.renderableUrl=(0,s.prop)(),this.fullHeight=(0,s.prop)(),this.fullWidth=(0,s.prop)(),this.aspectRatio=(0,s.prop)(),this.rgbaBuffer=(0,s.prop)(),this.rgbaHeight=(0,s.prop)(),this.rgbaWidth=(0,s.prop)(),this.animationDuration=(0,s.prop)(0),this.animatedAsNewMsg=(0,s.prop)(!1),this.isAnimated=(0,s.prop)(),this.singleLoopDuration=(0,s.prop)(),this.firstFrameLength=(0,s.prop)(),this.firstFrameSidecar=(0,s.prop)(),this.emojis=(0,s.prop)(),this.progressiveStage=(0,s.prop)(),this.isViewOnce=(0,s.prop)(!1),this.preview=(0,s.prop)(),this.sidecar=(0,s.prop)(),this.duration=(0,s.prop)(),this.durationFloat=(0,s.prop)(),this.isGif=(0,s.prop)(),this.gifAttribution=(0,s.prop)(),this.streamable=(0,s.derived)(this._isStreamable,["isGif","isViewOnce","mediaStage","sidecar","type","_swStreamingSupported"]),this._swStreamingSupported=(0,s.prop)(!1),this._listeningToSwSupport=(0,s.prop)(!1),this.filename=(0,s.prop)(),this.pageCount=(0,s.prop)(),this.documentPreview=(0,s.prop)(),this.isVcardOverMmsDocument=(0,s.prop)(!1),this.parsedVcards=(0,s.prop)(),this.fullPreviewSize=(0,s.prop)(),this.fullPreviewData=(0,s.prop)(),this.subtype=(0,s.prop)()}initialize(){super.initialize()}set(e,t,r){var a,n=r;return"string"==typeof e?a={[e]:t}:(a=e,n=t),a=function(e){var t=e.filename||e.caption;if(t&&e.type===c.TYPE.DOCUMENT)return t=(0,o.cleanFilename)(t),(0,i.default)((0,i.default)({},e),{},{filename:t,caption:t});return e}(a),super.set(a,n)}_isStreamable(){return this.isStreamable()}isStreamable(){return this.isStreamableType()&&this.listenToServiceWorkerSupport()&&!this.isViewOnce}_updateStreamingSupported(e){this._swStreamingSupported=e}listenToServiceWorkerSupport(){if(this._listeningToSwSupport)return this._swStreamingSupported;var e=r(58906).default;return this.listenTo(e,"change:streamingSupported",this._updateStreamingSupported),this._swStreamingSupported=Boolean(e.streamingSupported),this._listeningToSwSupport=!0,this._swStreamingSupported}isStreamableType(){return this.type===l.OUTWARD_TYPES.VIDEO&&!this.isGif&&(this.mediaStage===l.MEDIA_DATA_STAGE.INIT||this.mediaStage===l.MEDIA_DATA_STAGE.FETCHING||this.mediaStage===l.MEDIA_DATA_STAGE.DECRYPTING||this.mediaStage===l.MEDIA_DATA_STAGE.RESOLVED)&&null!=this.fullWidth&&null!=this.fullHeight&&Boolean(this.sidecar&&this.sidecar.byteLength>0)}isDownloadable(){return!this.isViewOnce&&(null!=this.renderableUrl||u.default.has(this.filehash)||this.mediaStage===l.MEDIA_DATA_STAGE.EXISTS||this.mediaStage===l.MEDIA_DATA_STAGE.PROGRESSIVE_READY)}}d.Proxy="mediaData";var c=(0,s.defineModel)(d);c.TYPE=l.OUTWARD_TYPES;var f=c;t.default=f},24991:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.MediaEntryList=t.MediaEntry=void 0;var n=a(r(19976)),i=r(2505),s=a(r(42140)),o=a(r(55288)),u=a(r(39417)),l=a(r(27674));function d(){var e=(0,n.default)(["Media type "," from "," is missing encFilehash"]);return d=function(){return e},e}function c(){var e=(0,n.default)(["media-fault: mediaKey changed for the same MMS3 url. type:",". equal?:",". Debug:\n",""],["media-fault: mediaKey changed for the same MMS3 url. type:",". equal?:",". Debug:\\n",""]);return c=function(){return e},e}var f="PROBABLY_ON_SERVER",p="PROBABLY_OFF_SERVER",h="UNKNOWN";class _{constructor(e,t,r,a,n,i,s,o,u,l){this.useBackupUrl=!1,this._encFilehashPromise=null,this.deprecatedMms3Url=e,this.mediaKey=t,this.mediaKeyTimestamp=r,this.encFilehash=a,this.serverStatus=h,this.sidecar=i,this.directPath=s,this.firstFrameSidecar=o,this.type=n,this.scansSidecar=u,this.scanLengths=l}url(e){var{useFallback:t,forceHashUrl:r}=e||{},{encFilehash:a}=this;return a?o.default.getHostsInfo({operation:u.default.DOWNLOAD,encFilehash:a,type:this.type}).then((({selectedHost:e,fallbackHost:n})=>{var i=t&&n?n:e;return(0,s.default)({directPath:r?null:this.directPath,encFilehash:a,hostname:i.hostname,type:this.type})})):Promise.reject(new Error("media_entry: encFilehash does not exist"))}markWhetherOnServer(e){this.serverStatus=e?f:p}}t.MediaEntry=_;function m(e){e.entries.sort(((e,t)=>{var r=g(t)-g(e);return 0===r?t.mediaKeyTimestamp-e.mediaKeyTimestamp:r}))}function g(e){var t=0;switch(e.serverStatus){case f:t+=200;break;case p:break;case h:t+=100}return e.encFilehash?t+=20:e._encFilehashPromise&&(t+=10),t}t.MediaEntryList=class{constructor(){this.entries=[]}_updateEntry({foundEntry:e,mediaKey:t,mediaKeyTimestamp:r,encFilehash:a,sidecar:n,directPath:s,firstFrameSidecar:o,scansSidecar:u,scanLengths:l,deprecatedMms3Url:d}){if(t&&!(0,i.b64Equal)(e.mediaKey,t)){var f=e.mediaKey.replace("=","").split("\n")[0],p=t.replace("=","").split("\n")[0];return __LOG__(4,void 0,new Error,!0)(c(),e.type,f===p,JSON.stringify({before:{hasDirectPath:Boolean(e.directPath),hasEncFilehash:Boolean(e.encFilehash),hasMediaKey:Boolean(e.mediaKey),hasDeprecatedMms3Url:Boolean(e.deprecatedMms3Url)},after:{hasDirectPath:Boolean(s),hasEncFilehash:Boolean(a),hasDeprecatedMms3Url:Boolean(d)}},null,2)),SEND_LOGS("media-key-mismatch-same-mms3-url"),null}return null!=r&&(e.mediaKeyTimestamp=r),n&&(e.sidecar=n),o&&(e.firstFrameSidecar=o),u&&(e.scansSidecar=u),(null==l?void 0:l.length)&&(e.scanLengths=l),e.directPath=s,e}updateEntry({deprecatedMms3Url:e,mediaKey:t,mediaKeyTimestamp:r,encFilehash:a,type:n,sidecar:i,directPath:s,firstFrameSidecar:o,scansSidecar:u,scanLengths:l}){var d=this.getEntryByEncFilehash({encFilehash:a,deprecatedMms3Url:e});if(d)return this._updateEntry({foundEntry:d,mediaKey:t,mediaKeyTimestamp:r,encFilehash:a,sidecar:i,directPath:s,firstFrameSidecar:o,scansSidecar:u,scanLengths:l,deprecatedMms3Url:e})}addEntry(e){var{deprecatedMms3Url:t,mediaKey:r,mediaKeyTimestamp:a,encFilehash:n,type:i,sidecar:s,directPath:o,firstFrameSidecar:u,scansSidecar:l,scanLengths:c,debugHint:f}=e;null==n&&(__LOG__(4,void 0,new Error,!0)(d(),i,f),SEND_LOGS("media-entry-missing-upload-hash-".concat(i,"-").concat(f)));var p=this.entries,h=this.getEntryByEncFilehash({encFilehash:n,deprecatedMms3Url:t}),m=h?this._updateEntry({foundEntry:h,mediaKey:r,mediaKeyTimestamp:a,encFilehash:n,sidecar:s,directPath:o,firstFrameSidecar:u,scansSidecar:l,scanLengths:c,deprecatedMms3Url:t}):null;if(m)return m;if(!r)return null;var g=new _(t,r,a,n,i,s,o,u,l,c);return p.push(g),g}_getKey({encFilehash:e,deprecatedMms3Url:t}){return null==e?"mms3:".concat(t):e}has(e){return null!=this.getEntryByEncFilehash(e)}getEntryByEncFilehash(e){var t=this._getKey(e);return this.entries.find((e=>this._getKey(e)===t))}getUploadEntry(){return m(this),this.entries.find((e=>(0,l.default)(e.mediaKeyTimestamp)))||null}getDownloadEntry(){m(this);var e=this.entries[0];return e&&e.serverStatus!==p?e:null}}},24008:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.consolidate=b,t.webMediaTypeToWamMediaType=function(e){switch(e){case"VIDEO":return 3;case"IMAGE":return 2;case"AUDIO":return 4;case"STICKER":return 16;case"DOCUMENT":return 8;case"PRODUCT":return 18;default:throw new Error("web media type is invalid: ".concat(e))}},t.default=void 0;var n=a(r(70417)),i=a(r(19976)),s=r(39329),o=a(r(50935)),u=a(r(6698)),l=r(24991),d=a(r(81135)),c=r(96645),f=r(82982),p=(a(r(40210)),a(r(25012))),h=a(r(40103)),_=r(23214);function m(){var e=(0,i.default)(["Assertion failed!"]);return m=function(){return e},e}function g(){var e=(0,i.default)(["Assertion failed!"]);return g=function(){return e},e}function v(){var e=(0,i.default)(["Assertion failed!"]);return v=function(){return e},e}function E(){var e=(0,i.default)(["type: ",""]);return E=function(){return e},e}function y(){var e=(0,i.default)(["Assertion failed!"]);return y=function(){return e},e}function S(){var e=(0,i.default)(["Assertion failed!"]);return S=function(){return e},e}function T(){var e=(0,i.default)(["Assertion failed!"]);return T=function(){return e},e}function b(e,t){var r=e.contentInfo,a=!1,n=function(e){switch(e){case c.OUTWARD_TYPES.IMAGE:case c.OUTWARD_TYPES.PRODUCT:return c.TYPE.IMAGE;case c.OUTWARD_TYPES.VIDEO:return c.TYPE.VIDEO;case c.OUTWARD_TYPES.STICKER:return c.TYPE.STICKER;case c.OUTWARD_TYPES.AUDIO:case c.OUTWARD_TYPES.PTT:return c.TYPE.AUDIO;case c.OUTWARD_TYPES.DOCUMENT:default:return}}(t.type,t.subtype);n&&!e.type&&(e.type=n,a=!0);var{downloadStage:i,uploadStage:s}=t;i&&i!==e.downloadStage&&(e.downloadStage=i,a=!0),s&&s!==e.uploadStage&&(e.uploadStage=s,a=!0),t.resolvedPreview&&!r.preview&&(t.resolvedPreview.retain(),r.preview=t.resolvedPreview,a=!0),null!=t.progressiveStage&&t.progressiveStage!==e.progressiveStage&&(e.progressiveStage=t.progressiveStage,a=!0);var o=t.mediaBlob;o&&!o.isBlobEqual(e.mediaBlob)&&(e.mediaBlob&&e.clearBlob(),o.retain(),e.mediaBlob=o,e.size=o.size(),a=!0),null!=t.size&&(null==e.size||t.size<e.size)&&(e.size=t.size,a=!0),t.filehash&&!e.filehash&&(e.filehash=t.filehash,a=!0),t.parsedVcards&&t.parsedVcards!==e.parsedVcards&&(e.parsedVcards=t.parsedVcards,a=!0);for(var u=e.contentFields(),l=0;l<u.length;l++){var d=u[l];switch(d){case"preview":t.preview&&!r._preview&&(e.runProcessIfNotRunBefore("preview",O,t.preview),r._preview=t.preview,a=!0);break;case"fullWidth":case"fullHeight":case"aspectRatio":var f=t[d];null!=f&&0!==f&&r[d]!==f&&(r[d]=f,a=!0);break;case"animationDuration":case"singleLoopDuration":var p=t[d];null!=p&&p!==r[d]&&(r[d]=p,a=!0);break;default:var h=t[d];void 0!==h&&void 0===r[d]&&(r[d]=h,a=!0)}}return null!=r.aspectRatio&&0!==r.aspectRatio||(null!=r.fullWidth&&0!==r.fullWidth&&null!=r.fullHeight&&0!==r.fullHeight?(r.aspectRatio=r.fullWidth/r.fullHeight,a=!0):r.preview&&e.runProcessIfNotRunBefore("aspectRatio",w,r.preview)),a}function A(e,t,r){for(var a=0;a<r.length;a++){var n=r[a];e[n]=t[n]}}function C(e,t){return t.filehash?e.id.fromMe&&e.ack<o.default.ACK.SENT?(e.local||(__LOG__(4,void 0,new Error,!0)(m()),SEND_LOGS("media-fault: unsent media system message not local")),function(e){switch(e.uploadStage){case c.UPLOAD_STAGE.INIT:case c.UPLOAD_STAGE.PREPARING:return c.MEDIA_DATA_STAGE.PREPARING;case c.UPLOAD_STAGE.UPLOADING:return c.MEDIA_DATA_STAGE.UPLOADING;case c.UPLOAD_STAGE.NEED_UPLOAD:return c.MEDIA_DATA_STAGE.NEED_UPLOAD;case c.UPLOAD_STAGE.ERROR_MISSING:return c.MEDIA_DATA_STAGE.ERROR_MISSING;case c.UPLOAD_STAGE.ERROR_TOO_LARGE:return c.MEDIA_DATA_STAGE.ERROR_TOO_LARGE;case c.UPLOAD_STAGE.UPLOADED:return c.MEDIA_DATA_STAGE.SENDING}}(t)):P(t):c.MEDIA_DATA_STAGE.PREPARING}function P(e){switch(e.downloadStage){case c.DOWNLOAD_STAGE.INIT:return c.MEDIA_DATA_STAGE.INIT;case c.DOWNLOAD_STAGE.EXISTS:return c.MEDIA_DATA_STAGE.EXISTS;case c.DOWNLOAD_STAGE.PREPARING:return c.MEDIA_DATA_STAGE.PREPARING;case c.DOWNLOAD_STAGE.REUPLOADING:return c.MEDIA_DATA_STAGE.REUPLOADING;case c.DOWNLOAD_STAGE.FETCHING:return c.MEDIA_DATA_STAGE.FETCHING;case c.DOWNLOAD_STAGE.PROCESSING:return c.MEDIA_DATA_STAGE.DECRYPTING;case c.DOWNLOAD_STAGE.NEED_POKE:return c.MEDIA_DATA_STAGE.NEED_POKE;case c.DOWNLOAD_STAGE.ERROR_MISSING:return c.MEDIA_DATA_STAGE.ERROR_MISSING;case c.DOWNLOAD_STAGE.ERROR_UNSUPPORTED:return c.MEDIA_DATA_STAGE.ERROR_UNSUPPORTED;case c.DOWNLOAD_STAGE.RESOLVED:return c.MEDIA_DATA_STAGE.RESOLVED;case c.DOWNLOAD_STAGE.PROGRESSIVE_READY:return c.MEDIA_DATA_STAGE.PROGRESSIVE_READY}}function O(e){return p.default.createFromBase64Jpeg(e).then((e=>(e.autorelease(),{resolvedPreview:e})))}function w(e){return(0,f.getImageWidthHeight)(e).then((({width:e,height:t})=>({aspectRatio:e/t})))}t.default=class{constructor(){this._msgs=[],this._notifyTimer=new s.ShiftTimer((()=>{!function(e){var t={};A(t,e,c.FIELDS.RAW),A(t,e.contentInfo,e.contentFields()),e.mediaBlob&&(t.renderableUrl=e.mediaBlob.url());for(var r=e._msgs,a=r.length,n=0;n<a;n++){var[i,s]=r[n];if(!s){if(i.type!==o.default.MSG_TYPE.CIPHERTEXT){t.mediaStage=C(i,e);for(var u=0;u<c.MSG_SPECIFIC_FIELDS.length;u++){var l=c.MSG_SPECIFIC_FIELDS[u];t[l]=i[c.MEDIA_TO_MSG[l]]}}else{delete t.mediaStage;for(var d=0;d<c.MSG_SPECIFIC_FIELDS.length;d++)delete t[c.MSG_SPECIFIC_FIELDS[d]]}i.mediaData.set(t)}}for(var f=r.length-1;f>=0;f--)r[f][1]&&r.splice(f,1);var p=e._callOnConsolidate;!e._pendingChanges&&p&&(e._callOnConsolidate=null,p.forEach((e=>{e()})));e._saveMedia&&e._saveMedia(e)}(this),function(e){var t={};A(t,e,c.FIELDS.RAW),A(t,e.contentInfo,e.contentFields()),e.mediaBlob&&(t.renderableUrl=e.mediaBlob.url());var r=P(e);e._stickers=e._stickers.filter((([e,t])=>!t)),e._stickers.forEach((([e,a])=>{e.mediaData.set((0,n.default)((0,n.default)({},t),{},{mediaStage:r}))})),e._stickerPacks=e._stickerPacks.filter((([e,t])=>!t)),e._stickerPacks.forEach((([e,a])=>{e.mediaData.set((0,n.default)((0,n.default)({},t),{},{mediaStage:r}))})),!e._pendingChanges&&e._callOnConsolidate&&(e._callOnConsolidate.forEach((e=>{e()})),e._callOnConsolidate=null);e._saveMedia&&e._saveMedia(e)}(this)})),this._callOnConsolidate=null,this._keyedProcesses=null,this._pendingChangesCount=0,this._saveMedia=null,this._stickers=[],this._stickerPacks=[],this.entries=new l.MediaEntryList,this.downloadStage=c.DOWNLOAD_STAGE.INIT,this.uploadStage=c.UPLOAD_STAGE.INIT,this.userUploadAttemptCount=0,this.userDownloadAttemptCount=0,this.downloadPromise=null,this.uploadPromise=null,this.mediaBlob=null,this.size=void 0,this.filehash=void 0,this.contentInfo={},this.progressiveStage=void 0,this.parsedVcards=null}consolidate(e){return!!b(this,e)&&(this.notifyMsgsAsync(),!0)}clearBlob(){var e=this.mediaBlob;e&&(this.mediaBlob=null,e.autorelease())}contentFields(){var e=this.type||c.TYPE.DOCUMENT;return c.FIELDS[e]}resolveWhenConsolidated(){return this._notifyTimer.ts||this._pendingChanges?new Promise((e=>{this._callOnConsolidate?this._callOnConsolidate.push(e):this._callOnConsolidate=[e]})):Promise.resolve()}notifyMsgsAsync(){this._notifyTimer.debounce(0)}addMsg(e){for(var t=this._msgs,r=0;r<t.length;r++){var[a,n]=t[r];a!==e||n||(__LOG__(4,void 0,new Error,!0)(T()),SEND_LOGS("redundant-media-msg"))}t.push([e,!1]),this.notifyMsgsAsync()}removeMsg(e){for(var t=this._msgs,r=!1,a=0;!r&&a<t.length;a++){var[n,i]=t[a];n!==e||i||(t[a][1]=!0,r=!0)}}hasAssociatedMsgsOrStickers(){for(var e=this._msgs,t=0;t<e.length;t++)if(!e[t][1])return!0;return this.hasAssociatedStickers()||this.hasAssociatedStickerPacks()}associatedMsgs(){for(var e=this._msgs,t=[],r=0;r<e.length;r++){var[a,n]=e[r];n||t.push(a)}return t}rmr(e){var t=this.associatedStickers();if(t.length>0)return(0,_.rmrSticker)(this.entries,this._stickers,t[0]).then((e=>e.status));var r=this.associatedStickerPacks();if(r.length>0)return(0,_.rmrStickerPack)(this.entries,this._stickerPacks,r[0]).then((e=>e.status));var[a]=this._msgs.find((([e,t])=>!t&&!e.isUnsentPhoneMsg()))||[null];return a||(__LOG__(4,void 0,new Error,!0)(S()),SEND_LOGS("media-fault: rmr called on MediaObject with no msg")),a?(e.onMsgSelect(a),(0,h.default)(a).then((e=>{if(200===e.status){var{encFilehash:t}=a,r=e.isMD?this.entries.updateEntry({deprecatedMms3Url:a.deprecatedMms3Url,encFilehash:t,directPath:e.directPath}):this.entries.addEntry({deprecatedMms3Url:e.url,mediaKey:e.mediaKey||a.mediaKey,mediaKeyTimestamp:e.mediaKeyTimestamp,encFilehash:e.encFilehash,type:a.mediaData.type,directPath:e.directPath,debugHint:"rmr"});r||(__LOG__(4,void 0,new Error,!0)(y()),SEND_LOGS("media-fault: rmr entry can not be found")),null==r||r.markWhetherOnServer(!0)}return e.status}))):Promise.reject(new Error("rmr called on MediaObject with no msg"))}msgProps(e){var t={};A(t,this,c.FIELDS.RAW),A(t,this.contentInfo,this.contentFields()),A(t,e,c.MSG_SPECIFIC_FIELDS),t.preview=this.contentInfo._preview;var r={};for(var a in t){var n=c.MEDIA_TO_MSG[a];n&&(r[n]=t[a])}return r}delete(){this._saveMedia=null;var{cancelDownloadMedia:e,cancelUploadMedia:t}=r(28278);e(this),t(this),this.clearBlob()}runProcessIfNotRunBefore(e,t,r){var a=this._keyedProcesses;a||(a=this._keyedProcesses={}),a.hasOwnProperty(e)||(this._pendingChangesCount++,a[e]=Promise.resolve(r).then(t).then((e=>{this.consolidate(e)})).finally((()=>{this._pendingChangesCount--,0===this._pendingChangesCount&&this.notifyMsgsAsync()})))}getPendingProcess(e){return 0!==this._pendingChangesCount&&this._keyedProcesses&&this._keyedProcesses.hasOwnProperty(e)?this._keyedProcesses[e]:Promise.resolve()}videoStreamingInfo(e){if(this.type!==c.TYPE.VIDEO)return __LOG__(4,void 0,new Error,!0)(E(),String(this.type)),SEND_LOGS("media-fault: media streaming info request for non-video type"),null;var t=this.entries.getDownloadEntry();return t&&t.sidecar?Promise.all([(0,u.default)(d.default.VIDEO,t.mediaKey),t.url()]).then((([r,a])=>({cryptoKeys:(0,n.default)((0,n.default)({},r),{},{cipherKey:r.encKey,sidecar:t.sidecar}),streamData:{clientUrl:a,size:this.size,msgKey:e}}))):null}addStickerPack(e){for(var t=this._stickerPacks,r=0;r<t.length;r++){var[a,n]=t[r];a!==e||n||(__LOG__(4,void 0,new Error,!0)(v()),SEND_LOGS("redundant-sticker-pack-add"))}t.push([e,!1]),this.notifyMsgsAsync()}addSticker(e){for(var t=this._stickers,r=0;r<t.length;r++){var[a,n]=t[r];a!==e||n||(__LOG__(4,void 0,new Error,!0)(g()),SEND_LOGS("redundant-sticker-add"))}t.push([e,!1]),this.notifyMsgsAsync()}removeSticker(e){for(var t=this._stickers,r=!1,a=0;!r&&a<t.length;a++){var[n,i]=t[a];n!==e||i||(t[a][1]=!0,r=!0)}}removeStickerPack(e){for(var t=this._stickerPacks,r=!1,a=0;!r&&a<t.length;a++){var[n,i]=t[a];n!==e||i||(t[a][1]=!0,r=!0)}}hasAssociatedStickers(){return this._stickers.some((([e,t])=>!t))}hasAssociatedStickerPacks(){return this._stickerPacks.some((([e,t])=>!t))}associatedStickers(){return this._stickers.reduce(((e,[t,r])=>r?e:e.concat(t)),[])}associatedStickerPacks(){return this._stickerPacks.reduce(((e,[t,r])=>r?e:e.concat(t)),[])}toJSON(){return{mediaBlob:this.mediaBlob,size:this.size,filehash:this.filehash,type:this.type,contentInfo:this.contentInfo,downloadStage:this.downloadStage,uploadStage:this.uploadStage}}}},23214:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.rmrSticker=function(e,t,r){r||(__LOG__(4,void 0,new Error,!0)(f()),SEND_LOGS("media-fault: rmr called on MediaObject without sticker"));return u.default.mediaUpload("sticker",r.id).tap((r=>{var a=r.sticker;if(200===r.status&&a){t.forEach((([e,t])=>{t||(e.directPath===a.directPath&&(__LOG__(4,void 0,new Error,!0)(c()),SEND_LOGS("rmrSticker:same-direct-path-after-rmr")),a.mediaKey=(0,s.default)((0,o.default)(a.mediaKey),"sanitizeBase64(nextSticker.mediaKey)"),e.deprecatedMms3Url=a.url,e.filehash=a.filehash,e.width=a.width,e.height=a.height,e.mediaKey=a.mediaKey,e.mediaKeyTimestamp=0,e.directPath=a.directPath,e.encFilehash=a.encFilehash,a.mimetype&&(e.mimetype=a.mimetype))}));var n=e.addEntry({deprecatedMms3Url:a.url,mediaKey:a.mediaKey,mediaKeyTimestamp:0,encFilehash:a.encFilehash,type:i.default.STICKER,directPath:a.directPath,debugHint:"rmrSticker"});n&&n.markWhetherOnServer(!0)}}))},t.rmrStickerPack=function(e,t,r){r||(__LOG__(4,void 0,new Error,!0)(d()),SEND_LOGS("media-fault: rmr called on MediaObject without stickerPack"));return u.default.mediaUpload("sticker-pack",r.id).tap((r=>{var a=r.stickerPack;if(200===r.status&&a){t.forEach((([e,t])=>{t||(e.directPath===a.directPath&&(__LOG__(4,void 0,new Error,!0)(l()),SEND_LOGS("rmrStickerPack:same-direct-path-after-rmr")),e.url=a.url,e.filehash=a.filehash,e.mediaKey=a.mediaKey,e.mediaKeyTimestamp=0,e.directPath=a.directPath,e.encFilehash=a.encFilehash,a.mimetype&&(e.mimetype=a.mimetype))}));var n=e.addEntry({deprecatedMms3Url:a.url,mediaKey:a.mediaKey,mediaKeyTimestamp:0,encFilehash:a.encFilehash,type:i.default.IMAGE,directPath:a.directPath,debugHint:"rmrStickerPack"});n&&n.markWhetherOnServer(!0)}}))};var n=a(r(19976)),i=a(r(81135)),s=a(r(61941)),o=a(r(82626)),u=a(r(76022));function l(){var e=(0,n.default)(["Assertion failed!"]);return l=function(){return e},e}function d(){var e=(0,n.default)(["Assertion failed!"]);return d=function(){return e},e}function c(){var e=(0,n.default)(["Assertion failed!"]);return c=function(){return e},e}function f(){var e=(0,n.default)(["Assertion failed!"]);return f=function(){return e},e}},53882:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.associateMediaWithMsg=function(e,t){e.addMsg(t)},t.disassociateMediaFromMsg=function(e,t){if(t.mediaObject=null,e.removeMsg(t),e.hasAssociatedMsgsOrStickers())return;var{filehash:r}=e;r&&delete u[r];r&&(0,s.shouldUseLruMediaStore)((0,i.msgToMediaType)(t))&&o.default.del(r);e.delete()},t.delistAndDeleteAllMedia=function(){var e=u;for(var t in u={},e)e[t].delete()},t.getOrCreateMediaObject=function(e){return u.hasOwnProperty(e)?u[e]:u[e]=new n.default},t.clearMediaForChat=function(){},t.associateMediaWithStickerPack=function(e,t){e.addStickerPack(t)},t.disassociateMediaFromStickerPack=function(e,t){if(t.mediaObject=null,e.removeStickerPack(t),e.hasAssociatedMsgsOrStickers())return;var{filehash:r}=e;r&&delete u[r];r&&o.default.del(r);e.delete()},t.associateMediaWithSticker=function(e,t){e.addSticker(t)},t.disassociateMediaFromSticker=function(e,t){if(t.mediaObject=null,e.removeSticker(t),e.hasAssociatedMsgsOrStickers())return;var{filehash:r}=e;r&&delete u[r];r&&o.default.del(r);e.delete()};var n=a(r(24008)),i=r(81135),s=r(82982),o=a(r(90382)),u={}},96645:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TYPE=t.OUTWARD_TYPES=t.MEDIA_DATA_STAGE=t.UPLOAD_STAGE=t.DOWNLOAD_STAGE=t.MSG_SPECIFIC_FIELDS=t.FIELDS=t.MEDIA_MSG_PROPS=t.MAPPED_STICKER_PROPS=t.MAPPED_MEDIA_PROPS=t.MAPPED_MSG_PROPS=t.MSG_TO_MEDIA=t.MEDIA_TO_MSG=void 0;var a=Object.freeze({preview:"body",mediaKey:"mediaKey",mediaKeyTimestamp:"mediaKeyTimestamp",size:"size",filehash:"filehash",mimetype:"mimetype",duration:"duration",pageCount:"pageCount",fullHeight:"height",fullWidth:"width",type:"type",filename:"filename",caption:"caption",isGif:"isGif",gifAttribution:"gifAttribution",sidecar:"streamingSidecar",subtype:"subtype",firstFrameLength:"firstFrameLength",firstFrameSidecar:"firstFrameSidecar",isAnimated:"isAnimated",isVcardOverMmsDocument:"isVcardOverMmsDocument",isViewOnce:"isViewOnce"});t.MEDIA_TO_MSG=a;var n=Object.freeze({body:"preview",directPath:"directPath",mediaKey:"mediaKey",mediaKeyTimestamp:"mediaKeyTimestamp",size:"size",filehash:"filehash",mimetype:"mimetype",duration:"duration",pageCount:"pageCount",height:"fullHeight",width:"fullWidth",type:"type",filename:"filename",caption:"caption",isGif:"isGif",gifAttribution:"gifAttribution",streamingSidecar:"sidecar",subtype:"subtype",firstFrameLength:"firstFrameLength",firstFrameSidecar:"firstFrameSidecar",isAnimated:"isAnimated",isVcardOverMmsDocument:"isVcardOverMmsDocument",isViewOnce:"isViewOnce"});t.MSG_TO_MEDIA=n;var i=Object.keys(n);t.MAPPED_MSG_PROPS=i;var s=Object.keys(a);t.MAPPED_MEDIA_PROPS=s;t.MAPPED_STICKER_PROPS=["filehash","height","mimetype","size","type","width"];var o=[...i,"deprecatedMms3Url","encFilehash","streamable"];t.MEDIA_MSG_PROPS=o;var u=Object.freeze({VIDEO:Object.freeze(["aspectRatio","fullWidth","fullHeight","preview","duration","durationFloat","isViewOnce","fullPreviewData"]),AUDIO:Object.freeze(["duration"]),IMAGE:Object.freeze(["aspectRatio","fullWidth","fullHeight","preview","isViewOnce","fullPreviewData"]),PRODUCT:Object.freeze(["aspectRatio","fullWidth","fullHeight","preview"]),STICKER:Object.freeze(["animationDuration","singleLoopDuration","emojis","firstFrameLength","firstFrameSidecar","isAnimated","fullWidth","fullHeight","preview","rgbaBuffer","rgbaWidth","rgbaHeight","aspectRatio"]),STICKER_PACK:Object.freeze([]),DOCUMENT:Object.freeze(["aspectRatio","pageCount","preview","isVcardOverMmsDocument","parsedVcards","fullPreviewData","fullPreviewSize"]),RAW:Object.freeze(["mediaBlob","size","filehash","progressiveStage"])});t.FIELDS=u;t.MSG_SPECIFIC_FIELDS=["type","filename","caption","isGif","gifAttribution","mimetype","pageCount","sidecar","subtype","isViewOnce"];var l=r(28103).Mirrored(["INIT","EXISTS","PREPARING","REUPLOADING","FETCHING","PROCESSING","NEED_POKE","ERROR_MISSING","ERROR_UNSUPPORTED","PROGRESSIVE_READY","RESOLVED"]);t.DOWNLOAD_STAGE=l;var d=r(28103).Mirrored(["INIT","PREPARING","UPLOADING","NEED_UPLOAD","ERROR_MISSING","ERROR_TOO_LARGE","UPLOADED"]);t.UPLOAD_STAGE=d;var c=r(28103).Mirrored(["INIT","EXISTS","PREPARING","UPLOADING","SENDING","REUPLOADING","FETCHING","DECRYPTING","RESOLVED","NEED_POKE","NEED_UPLOAD","ERROR_MISSING","ERROR_TOO_LARGE","ERROR_UNSUPPORTED","PROGRESSIVE_READY","REMOTE_UPLOADING","REMOTE_NEED_UPLOAD"]);t.MEDIA_DATA_STAGE=c;t.OUTWARD_TYPES={IMAGE:"image",VIDEO:"video",AUDIO:"audio",PTT:"ptt",STICKER:"sticker",DOCUMENT:"document",PRODUCT:"product",UNKNOWN:"unknown"};var f=Object.freeze({VIDEO:"VIDEO",IMAGE:"IMAGE",AUDIO:"AUDIO",STICKER:"STICKER",DOCUMENT:"DOCUMENT",PRODUCT:"PRODUCT"});t.TYPE=f},18614:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t;try{t=e?JSON.parse(e):n.default}catch(e){return null}var r={};return s(t,r,"",""),r};var n=a(r(11284)),i=r(11419);function s(e,t,r,a){var n=e;if(Array.isArray(n)||(0,i.isString)(n)){(0,i.isString)(n)&&(n=[n]);for(var o=0;o<n.length;o++)t[n[o]]=a+r}else for(var u in n)s(n[u],t,u,a+r)}},41501:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.isAllowedDocumentMimetype=function(e,t,r=!1){for(var a in l){var n=l[a];if("document"===n.msgType)if((r?n.signatureMimetype:a)===e&&n.canSend&&t&&t.toLowerCase().endsWith(n.ext.toLowerCase()))return a}return r?e:e||"application/octet-stream"},t.getExtension=function(e){var t=l[e];return t?"."+(t.ext||e.split("/")[1]).toLowerCase():""},t.previewType=function(e){for(var t in l)if(l.hasOwnProperty(t)){var{previewType:r,signatureMimetype:a}=l[t];if(r&&(t===e||a===e))return r}},t.getMediaMimeType=function(e,t){var r=t;r.length>262&&(r=r.subarray(0,262));var a=(0,s.default)(r);if(a)return a.mime;if("image"===e)return"image/jpeg";throw new u.MediaEncryptionError("unknown mime decrypt error for type:"+e)},t.getDocTypes=function(){return(0,i.default)(l,(e=>"document"===e.msgType))},t.EXT_TO_MIME=t.DOC_MIMES=t.MIMETYPES=t.MIMETYPE_DETERMINING_LENGTH=void 0;var i=n(r(42208)),s=n(r(5025)),o=n(r(18614)),u=a(r(96452));t.MIMETYPE_DETERMINING_LENGTH=262;var l={"text/plain":{ext:"TXT",msgType:"document",icon:"icon-doc-txt",canSend:!0},"text/rtf":{ext:"RTF",msgType:"document",icon:"icon-doc-doc",canSend:!0,signatureMimetype:"application/rtf"},"text/vcard":{ext:"VCF",msgType:"vcard"},"application/zip":{ext:"ZIP",icon:"icon-doc-generic",msgType:"document"},"application/pdf":{ext:"PDF",msgType:"document",icon:"icon-doc-pdf",canSend:!0,signatureMimetype:"application/pdf",previewType:"pdf"},"application/msword":{ext:"DOC",msgType:"document",icon:"icon-doc-doc",canSend:!0,signatureMimetype:"application/x-msi",previewType:"msoffice"},"application/vnd.ms-excel":{ext:"XLS",msgType:"document",icon:"icon-doc-xls",canSend:!0,signatureMimetype:"application/x-msi",previewType:"msoffice"},"application/vnd.ms-powerpoint":{ext:"PPT",msgType:"document",icon:"icon-doc-ppt",canSend:!0,signatureMimetype:"application/x-msi",previewType:"msoffice"},"application/vnd.openxmlformats-officedocument.wordprocessingml.document":{ext:"DOCX",msgType:"document",icon:"icon-doc-doc",canSend:!0,signatureMimetype:"application/zip",previewType:"msoffice"},"application/vnd.openxmlformats-officedocument.presentationml.presentation":{ext:"PPTX",msgType:"document",icon:"icon-doc-ppt",canSend:!0,signatureMimetype:"application/zip",previewType:"msoffice"},"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":{ext:"XLSX",msgType:"document",icon:"icon-doc-xls",canSend:!0,signatureMimetype:"application/zip",previewType:"msoffice"},"audio/aac":{msgType:"audio",ext:"AAC"},"audio/mp4":{msgType:"audio"},"audio/amr":{msgType:"audio"},"audio/mpeg":{msgType:"audio"},"audio/ogg; codecs=opus":{msgType:"audio",ext:"OGG"},"audio/wav":{msgType:"audio",ext:"wav"},"video/mp4":{msgType:"video",ext:"MP4"},"video/3gpp":{msgType:"video"},"image/jpeg":{msgType:"image"},"image/png":{msgType:"image"}},d=l;t.MIMETYPES=d;t.DOC_MIMES="*";var c=(0,o.default)();t.EXT_TO_MIME=c},81135:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.castToV4=function(e){var t;if(null==e)t=o.DOCUMENT;else{if(!(e in o))throw new Error("castToV4: unexpected mmsv3 type ".concat(e));t=o[e]}return t},t.msgToMediaType=function({type:e,isGif:t}){switch(e){case s.IMAGE:return o.IMAGE;case s.VIDEO:return t?o.GIF:o.VIDEO;case s.AUDIO:return o.AUDIO;case s.PTT:return o.PTT;case s.DOCUMENT:return o.DOCUMENT;case s.STICKER:return o.STICKER;case s.PRODUCT:return o.PRODUCT;default:throw new Error("msg is not a media msg: ".concat(e,", isGif=").concat(String(t)))}},t.MEDIA_TYPE_VALUES=t.default=void 0;var n=a(r(98346)),i=a(r(50935)),{MSG_TYPE:s}=i.default,o=Object.freeze({AUDIO:"audio",DOCUMENT:"document",GIF:"gif",IMAGE:"image",PPIC:"ppic",PRODUCT:"product",PTT:"ptt",STICKER:"sticker",VIDEO:"video",TEMPLATE:"template",THUMBNAIL_DOCUMENT:"thumbnail-document",THUMBNAIL_IMAGE:"thumbnail-image",THUMBNAIL_VIDEO:"thumbnail-video",HISTORY_SYNC:"md-msg-hist",MD_APP_STATE:"md-app-state",PRODUCT_CATALOG_IMAGE:"product-catalog-image"}),u=o;t.default=u;var l=(0,n.default)(o);t.MEDIA_TYPE_VALUES=l},39417:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r={DOWNLOAD:"DOWNLOAD",UPLOAD:"UPLOAD"};t.default=r},57430:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,n.default)(e)};var n=a(r(40571))},40682:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,r){var a=16*Math.ceil(e/16),s=t.slice(0,n.IV_LENGTH+a);return new i.default(r).sign(s,n.HMAC_LENGTH)};var n=r(43768),i=a(r(36398))},43768:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var r=e instanceof ArrayBuffer?e.byteLength:e.buffer.byteLength,a=new s.default(t),u=Math.ceil((r-16)/o),l=(0,n.default)(u,(t=>{var r=t*o,n=e.slice(r,r+16+o);return a.sign(n,10)}));return Promise.all(l).then((e=>(0,i.default)(...e)))},t.HMAC_LENGTH=t.IV_LENGTH=void 0;var n=a(r(61258)),i=a(r(50846)),s=a(r(36398)),o=65536;t.IV_LENGTH=16;t.HMAC_LENGTH=10},6698:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return d.apply(this,arguments)};n(r(19976));var i=n(r(52954)),s=r(60339),o=a(r(96452)),u=a(r(55273)),l=n(r(81135));function d(){return(d=(0,i.default)((function*(e,t){var r,a=c(e);try{r=(0,s.decodeB64)(t)}catch(e){}if(!t||!a||!r)throw new o.MediaEncryptionError("createKeys fail: !!mediakey: ".concat(!!t," info: ").concat(a," type: ").concat(e));return u.extractAndExpand(r,a,112).then((e=>{if(!e||e.byteLength<112)throw new o.MediaEncryptionError("computeMediaKeys: hkdf error");return{iv:e.slice(0,16),encKey:e.slice(16,48),macKey:e.slice(48,80),refKey:e.slice(80,112)}}))}))).apply(this,arguments)}function c(e){switch(e){case l.default.AUDIO:return"WhatsApp Audio Keys";case l.default.DOCUMENT:return"WhatsApp Document Keys";case l.default.GIF:return"WhatsApp Video Keys";case l.default.IMAGE:return"WhatsApp Image Keys";case l.default.PPIC:throw new Error("Cannot create media keys for profile pics");case l.default.PRODUCT:return"WhatsApp Image Keys";case l.default.PTT:return"WhatsApp Audio Keys";case l.default.STICKER:return"WhatsApp Image Keys";case l.default.VIDEO:return"WhatsApp Video Keys";case l.default.THUMBNAIL_DOCUMENT:return"WhatsApp Document Thumbnail Keys";case l.default.THUMBNAIL_IMAGE:return"WhatsApp Image Thumbnail Keys";case l.default.THUMBNAIL_VIDEO:return"WhatsApp Video Thumbnail Keys";case l.default.TEMPLATE:throw new Error("Cannot create media keys for template");case l.default.HISTORY_SYNC:return"WhatsApp History Keys";case l.default.MD_APP_STATE:return"WhatsApp App State Keys";case l.default.PRODUCT_CATALOG_IMAGE:throw new Error("Cannot create media keys for product catalog image")}}},46822:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function({mediaKeys:e,ciphertextHmac:t,expectedPlaintextHash:r,debugString:a}){return Promise.resolve().then((()=>{if(__LOG__(2)(_(),a),t.byteLength<10)throw new d.MediaDecryptionError("ciphertext too short: ".concat(t.byteLength));var n=new f.default.WebcCryptoMedia({webcCryptoType:f.default.WEBC_CRYPTO_TYPE_CODE.DECRYPT,webcCryptoLibrary:f.default.WEBC_CRYPTO_LIBRARY_CODE.WEBCRYPTO,webcCryptoFileSize:t.byteLength}),{iv:m,encKey:g,macKey:v}=e,E=(0,o.default)(Uint8Array,t),y=(0,u.default)(Uint8Array,[new Uint8Array(m),E.slice(0,-10)]);return new c.default(v).sign(y,10).then((e=>{var t=E.buffer.slice(-10);if(!(0,l.default)(e,t))throw new d.MediaDecryptionError("decryptMedia: hmac mismatch");return(0,i.aesCbcDecrypt)(g,y)})).then((e=>null==r?e:(0,s.default)(e).then((t=>{if(t!==r)throw new d.MediaDecryptionError("decryptMedia: plaintext hash mismatch");return e})))).then((e=>(__LOG__(2)(h(),a),n.markWebcCryptoElapsedT(),n.commit(),e))).catch((e=>{if(__LOG__(3)(p(),a),e instanceof d.MediaDecryptionError)throw e;throw new d.MediaDecryptionError("decryption error: ".concat(String(e),"; stack: ").concat(e.stack))}))}))};var n=a(r(19976)),i=r(9729),s=a(r(57430)),o=a(r(77638)),u=a(r(66190)),l=a(r(38307)),d=r(96452),c=a(r(36398)),f=a(r(40210));function p(){var e=(0,n.default)(["decryptMedia: [","] error"]);return p=function(){return e},e}function h(){var e=(0,n.default)(["decryptMedia: [","] success"]);return h=function(){return e},e}function _(){var e=(0,n.default)(["decryptMedia: [","] start"]);return _=function(){return e},e}},28942:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.cleanupCiphertextAndIv=t.decrypt=t.HMAC_SIZE=t.BLOCK_SIZE=void 0;var n=a(r(19976)),i=a(r(66190)),s=r(30786);function o(){var e=(0,n.default)(["decryptPartialMedia:getEncryptedPadding encrypt error: ",""]);return o=function(){return e},e}function u(){var e=(0,n.default)(["decryptPartialMedia:getEncryptedPadding importKey error: ",""]);return u=function(){return e},e}function l(){var e=(0,n.default)(["decryptPartialMedia:decrypt decrypt error: ",""]);return l=function(){return e},e}function d(){var e=(0,n.default)(["decryptPartialMedia:decrypt importKey error: ",""]);return d=function(){return e},e}t.BLOCK_SIZE=16;t.HMAC_SIZE=10;var c=e=>{var{ciphertext:t,iv:r,mediaKeys:a}=e,{encKey:n}=a,i={name:"AES-CBC",iv:r};return(0,s.getCrypto)().importKey("raw",new Uint8Array(n),"AES-CBC",!1,["decrypt"]).catch((e=>{throw __LOG__(2)(d(),String(e)),e})).then((e=>(0,s.getCrypto)().decrypt(i,e,t))).catch((e=>{throw __LOG__(2)(l(),String(e)),e}))};t.decrypt=c;var f=e=>{var t,{serverRangeStart:r,ciphertext:a,mediaKeys:n}=e,l=a instanceof Uint8Array?a:new Uint8Array(a),d=l.byteLength%16==0;return 0===r?t=new Uint8Array(n.iv):(t=l.slice(0,16),l=l.slice(16)),d||(l=l.slice(0,l.byteLength-10)),d?(e=>{var{ciphertext:t,mediaKeys:r}=e,{encKey:a}=r,n={name:"AES-CBC",iv:(t instanceof Uint8Array?t:new Uint8Array(t)).slice(-16)};return(0,s.getCrypto)().importKey("raw",new Uint8Array(a),"AES-CBC",!1,["encrypt"]).catch((e=>{__LOG__(2)(u(),String(e))})).then((e=>{var t=new Uint8Array([]);return(0,s.getCrypto)().encrypt(n,e,t)})).catch((e=>{__LOG__(2)(o(),String(e))}))})({ciphertext:l,mediaKeys:n}).then((e=>({ciphertext:l=(0,i.default)(Uint8Array,[l,new Uint8Array(e)]),iv:t}))):Promise.resolve({ciphertext:l,iv:t})};t.cleanupCiphertextAndIv=f;var p=({mediaKeys:e,ciphertext:t})=>f({serverRangeStart:0,ciphertext:t,mediaKeys:e}).then((({ciphertext:t,iv:r})=>c({ciphertext:t,iv:r,mediaKeys:e})));t.default=p},495:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function({mediaKey:e,plaintext:t,type:r}){return new Promise(((a,n)=>{if(e.slice(0,10),__LOG__(2)(E()),!r)throw new f.MediaEncryptionError('encryptMedia: missing "type"');if(!e)throw new f.MediaEncryptionError('encryptMedia: missing "mediaKey"');var y=new _.default.WebcCryptoMedia({webcCryptoType:_.default.WEBC_CRYPTO_TYPE_CODE.ENCRYPT,webcCryptoLibrary:_.default.WEBC_CRYPTO_LIBRARY_CODE.WEBCRYPTO});(0,c.default)(r,e).then((({iv:e,encKey:a,macKey:n})=>(0,s.aesCbcEncrypt)(a,t,e).then((a=>{var s=a.slice(e.byteLength);return new p.default(n).sign(a,10).then((e=>{var c=Promise.resolve();if(r===h.default.VIDEO||r===h.default.AUDIO){var f=(0,d.default)(a,e);c=(0,l.default)(f,n)}var p=Promise.resolve();if(r===h.default.STICKER){var{firstFrameLength:_}=(0,m.default)(t);if(null!=_){var g=(0,d.default)(a,e);p=(0,u.default)(_,g,n)}}var v=(0,d.default)(s,e);return(0,i.promiseProps)({ciphertextHmac:v,hash:(0,o.default)(v),sidecar:c,firstFrameSidecar:p})}))})))).then((e=>{y.webcCryptoFileSize=e.ciphertextHmac.byteLength,y.markWebcCryptoElapsedT(),y.commit(),__LOG__(2)(v()),a(e)})).catch((e=>{if(__LOG__(3)(g()),e instanceof f.MediaEncryptionError)throw e;throw new f.MediaEncryptionError("encryption error: ".concat(String(e),"; stack: ").concat(e.stack))})).catch(n)}))};var n=a(r(19976)),i=r(5497),s=r(9729),o=a(r(57430)),u=a(r(40682)),l=a(r(43768)),d=a(r(50846)),c=a(r(6698)),f=r(96452),p=a(r(36398)),h=a(r(81135)),_=a(r(40210)),m=a(r(38579));function g(){var e=(0,n.default)(["encryptMedia: error"]);return g=function(){return e},e}function v(){var e=(0,n.default)(["encryptMedia: success"]);return v=function(){return e},e}function E(){var e=(0,n.default)(["encryptMedia: start"]);return E=function(){return e},e}},64724:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.getProgressiveMediaCacheKey=S,t.default=t.EOI_TAG=void 0;var n=a(r(52954)),i=a(r(19976)),s=r(29351),o=r(9729),u=a(r(66190)),l=r(38174),d=a(r(38307)),c=a(r(36398)),f=a(r(54146));function p(){var e=(0,i.default)(["Assertion failed! ",""]);return p=function(){return e},e}function h(){var e=(0,i.default)(["Assertion failed! ",""]);return h=function(){return e},e}function _(){var e=(0,i.default)(["ImageStreamer:handleProgress error: ",""]);return _=function(){return e},e}function m(){var e=(0,i.default)(["ImageStreamer: [","] Generated progressive image using "," chunks of "," total"]);return m=function(){return e},e}function g(){var e=(0,i.default)(["ImageStreamer: [","] Successfully decrypted chunk "," of "," total"]);return g=function(){return e},e}class v extends((0,s.customError)("ChunkValidationError")){constructor(e){super("Chunk ".concat(e," does not match sidecar"))}}var E=new Uint8Array([2,2]),y=new Uint8Array([255,217]);t.EOI_TAG=y;function S(e,t){return"".concat(e,"-progressive-").concat(t)}t.default=class{constructor(e){this._alignedScanLengths=[],this._increasingScanLengths=[],this._lastDecryptedChunk=0,this._downloadedBytes=new ArrayBuffer(0);var{cryptoKeys:t,scanLengths:r,scansSidecar:a,filehash:n,mimetype:i,debugString:s,onProgressiveUpdate:o}=e;this._cryptoKeys=t,this._scanLengths=r,this._scansSideCar=a,this._filehash=n,this._mimetype=i,this._nextChunkIV=this._cryptoKeys.iv,this._decryptedChunks=new Array(r.length),this._onProgressiveUpdate=o,this._debugString=s}_validateSidecar(e,t){0===t&&(this._nextChunkIV=this._cryptoKeys.iv);var{macKey:r}=this._cryptoKeys,a=this._scansSideCar.slice(10*t,10*t+10),n=this._nextChunkIV;this._nextChunkIV=e.slice(-16);var i=(0,u.default)(Uint8Array,[new Uint8Array(n),new Uint8Array(e)]);return new c.default(r).sign(i,10).then((e=>(0,d.default)(e,a)?Promise.resolve():Promise.reject(new v(t))))}_cleanupCipherTextAndIV(e,t){var r,a=e,n=a.byteLength%16==0;if(0===t)r=this._cryptoKeys.iv;else{var i=this._increasingScanLengths[t-1];r=this._downloadedBytes.slice(i-16,i)}return n||(a=a.slice(0,a.byteLength-10)),n?function(e,t){var{encKey:r}=t;return(0,o.aesCbcEncrypt)(r,E,new Uint8Array(e.slice(-16))).then((e=>e.slice(-16)))}(a,this._cryptoKeys).then((e=>({cipherText:a=(0,u.default)(Uint8Array,[new Uint8Array(a),new Uint8Array(e)]),iv:r}))):Promise.resolve({cipherText:a,iv:r})}_getLastFullyLoadedChunkIndex(e){for(var t=0,r=0;r<this._alignedScanLengths.length;r++)if(e<(t+=this._alignedScanLengths[r]))return r;return this._alignedScanLengths.length}_handleChunk(e,t){return this._validateSidecar(e,t).then((()=>this._cleanupCipherTextAndIV(e,t))).then((({iv:e,cipherText:t})=>(0,o.aesCbcDecrypt)(this._cryptoKeys.encKey,(0,u.default)(Uint8Array,[new Uint8Array(e),new Uint8Array(t)])))).then((e=>(0,l.removeEncryptedPadding)(e,E.buffer))).then((e=>(__LOG__(2)(g(),this._debugString,t,this._scanLengths.length),e)))}_generateBlobFromFullyLoadedChunks(e){return Promise.all(this._decryptedChunks.slice(0,e)).then((t=>{var r,a=this._scanLengths.slice(0,e).reduce(((e,t)=>e+t),0),n=(0,u.default)(Uint8Array,t.map((e=>new Uint8Array(e)))).slice(0,a),i=(0,d.default)(y.buffer,n.slice(-y.length).buffer)?n:(0,u.default)(Uint8Array,[n,y]),s=[i],o=this._mimetype?new Blob(s,{type:this._mimetype}):new Blob(s),l=S(this._filehash,e);return f.default.put(l,o),__LOG__(2)(m(),this._debugString,e,this._scanLengths.length),null===(r=this._onProgressiveUpdate)||void 0===r||r.call(this,e),this._lastDecryptedChunk=e,i.buffer}))}_decryptFullyLoadedChunks(e,t){var r=this;return(0,n.default)((function*(){for(var a=0;a<t;a++)if(!r._decryptedChunks[a]){var n=0===a?0:r._increasingScanLengths[a-1],i=e.slice(n,n+r._alignedScanLengths[a]);yield Promise.all(r._decryptedChunks),r._decryptedChunks[a]||(r._decryptedChunks[a]=r._handleChunk(i,a))}}))()}handleProgress(e,t){if(!this._alignedScanLengths.length){this._alignedScanLengths=(0,l.alignChunkLengthsToMultipleOfAesBlockSize)(this._scanLengths,e);for(var r=0;r<this._alignedScanLengths.length;r++){var a=this._alignedScanLengths[r],n=0===r?a:this._increasingScanLengths[r-1]+a;this._increasingScanLengths.push(n)}}var i,s,o="string"==typeof t?t.length:t.byteLength,u=this._getLastFullyLoadedChunkIndex(o);return u<=this._lastDecryptedChunk?Promise.resolve(null):(this._downloadedBytes="string"==typeof t?(i=t,(s=new Uint8Array(i.length)).set([...i].map((e=>e.codePointAt(0)))),s.buffer):t,this._decryptFullyLoadedChunks(this._downloadedBytes,u).then((()=>this._generateBlobFromFullyLoadedChunks(u))).catch((e=>{__LOG__(3)(_(),e);var t="".concat(e.message,", [").concat(this._debugString,"]")+"scanLengths length: ".concat(this._scanLengths.length,", scansSidecar byteLength: ").concat(this._scansSideCar.byteLength,". ")+"Stack: ".concat(e.stack);e instanceof v?(__LOG__(4,void 0,new Error,!0)(h(),t),SEND_LOGS("ImageStreamer:chunk validation error")):(__LOG__(4,void 0,new Error,!0)(p(),t),SEND_LOGS("ImageStreamer:handleProgress error"))})))}}},96598:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){var e=new Uint8Array(32);return self.crypto.getRandomValues(e),{key:(0,n.encodeB64)(e),timestamp:i.default.globalUnixTime()}};var n=r(60339),i=a(r(19899))},1616:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.DownloadManager=void 0;var i=n(r(70417)),s=n(r(19976)),o=n(r(52954)),u=n(r(12489)),l=n(r(43856)),d=n(r(1867)),c=n(r(6698)),f=r(38174),p=n(r(46822)),h=a(r(28942)),_=r(50261),m=n(r(64724)),g=r(66925),v=r(24008),E=n(r(81135)),y=r(96645),S=r(82982),T=n(r(10111)),b=n(r(40210)),A=n(r(62962)),C=r(86809),P=n(r(61941)),O=n(r(66823)),w=n(r(90382));function M(){var e=(0,s.default)(["downloadManager.rmr: [","] error ","\n",""],["downloadManager.rmr: [","] error ","\\n",""]);return M=function(){return e},e}function I(){var e=(0,s.default)(["downloadManager.rmr: [","] error MediaNotOnPhone\n",""],["downloadManager.rmr: [","] error MediaNotOnPhone\\n",""]);return I=function(){return e},e}function R(){var e=(0,s.default)(["downloadManager.rmr: [","] status ",""]);return R=function(){return e},e}function D(){var e=(0,s.default)(["downloadManager.rmr: [","] start"]);return D=function(){return e},e}function N(){var e=(0,s.default)(["downloadManager.download: [","] error\n",""],["downloadManager.download: [","] error\\n",""]);return N=function(){return e},e}function L(){var e=(0,s.default)(["downloadManager.download: [","] expected error\n",""],["downloadManager.download: [","] expected error\\n",""]);return L=function(){return e},e}function k(){var e=(0,s.default)(["downloadManager.download: [","] success"]);return k=function(){return e},e}function U(){var e=(0,s.default)(["downloadManager.download: [","] start"]);return U=function(){return e},e}function F(){var e=(0,s.default)(["downloadManager.asyncCache.set error:\n",""],["downloadManager.asyncCache.set error:\\n",""]);return F=function(){return e},e}function G(){var e=(0,s.default)(["downloadManager.asyncCache.get error:\n",""],["downloadManager.asyncCache.get error:\\n",""]);return G=function(){return e},e}function x(e){var t,r,a=null===(t=e.progressiveJpegOpts)||void 0===t?void 0:t.scanCount,n=null===(r=e.progressiveJpegOpts)||void 0===r?void 0:r.scanLengths;if(null!=a&&n)return"".concat(e.filehash,"-").concat(a,"/").concat(n.length,"-scans");if(e.partialVideoOpts){var{secondsToDownload:i}=e.partialVideoOpts;return"".concat(e.filehash,"-").concat(i,"-seconds")}return e.filehash}var B=1,Y=2,K=e=>{switch(e){case E.default.THUMBNAIL_DOCUMENT:return Y;case E.default.VIDEO:default:return B}};class j{constructor(){this.preloader=new d.default(10,{thumbnail:4}),this.downloadAndDecrypt=(0,l.default)((e=>x(e)),new W,(e=>e.isPreload?this.preloader.enqueue((()=>V(e)),{priority:K(e.type),group:"thumbnail",signal:e.signal}):V(e))),this.rmr=(0,T.default)((e=>e.mediaObject.filehash||""),q),this.checkExistence=(0,T.default)((e=>e.encFilehash),J)}}t.DownloadManager=j;class W{get(e,t){return(0,o.default)((function*(){if(!(0,S.shouldUseLruMediaStore)(t.type))return null;try{return yield w.default.get(x(t))}catch(e){return __LOG__(3,!0)(G(),(0,O.default)(e)),null}}))()}set(e,t,r){return(0,o.default)((function*(){if((0,S.shouldUseLruMediaStore)(r.type))try{yield w.default.put(x(r),t)}catch(e){__LOG__(3,!0)(F(),(0,O.default)(e))}}))()}}function V(){return H.apply(this,arguments)}function H(){return(H=(0,o.default)((function*(e){var t,r,a=new b.default.MediaDownload2({mediaId:(0,g.generateMediaEventId)(),connectionType:b.default.CONNECTION_TYPE.HOSTNAME,overallMediaType:(0,g.getMetricMediaType)(e.type),overallMmsVersion:4,networkStack:b.default.NETWORK_STACK_TYPE.NATIVE,overallDownloadMode:b.default.MEDIA_DOWNLOAD_MODE_TYPE.FULL,overallAttemptCount:e.userDownloadAttemptCount,overallDownloadOrigin:e.downloadOrigin,overallBackendStore:null!==(t=(0,g.getMetricBackendStore)(e.directPath))&&void 0!==t?t:void 0}),{directPath:n,encFilehash:i,filehash:s,mediaKey:o,onDecryptStart:l,type:d,mode:v,progressiveJpegOpts:E,partialVideoOpts:y}=e,S=e.signal||(new u.default).signal,T=s.slice(0,10);__LOG__(2)(U(),T);try{var C,w,M=null==E?void 0:E.scanCount,I=null!=M&&M===(null==E||null===(C=E.scanLengths)||void 0===C?void 0:C.length)?null:M,R=null;if(E&&null!=I)R={start:0,end:(0,f.alignChunkLengthsToMultipleOfAesBlockSize)(E.scanLengths).slice(0,I).reduce(((e,t)=>e+t),0)};else if(y){var{video:{size:D,duration:F},secondsToDownload:G}=y;R={start:0,end:Math.ceil(D*G/F/h.BLOCK_SIZE)*h.BLOCK_SIZE-1}}var x,B,[Y,K,j]=yield Promise.all([(0,c.default)(d,o).then((e=>{if(E){var{scanLengths:t,scansSidecar:r,mimetype:a,onProgressiveUpdate:n}=E;w=new m.default({cryptoKeys:e,scanLengths:t,scansSidecar:r,mimetype:a,filehash:s,debugString:T,onProgressiveUpdate:n})}return e})),X({scanCount:I,directPath:n,encFilehash:i,type:d,signal:S}),A.default.download({directPath:n,encFilehash:i,type:d,signal:S,mode:v,byteRange:R,onResponseText:null==I?(e,t)=>{var r;null===(r=w)||void 0===r||r.handleProgress(e.total,t)}:null,onDownloadHostFound:({hostName:e,hostClass:t,failCount:r})=>{a.set({overallDomain:e,overallConnectionClass:t,overallRetryCount:r})},onDownloadAttemptSuccess:e=>{a.set({overallT:e})},onDownloadAttemptError:({err:e,overallT:t,failCount:r})=>{var n=new b.default.MediaDownload2(a);n.set({mediaId:(0,g.generateMediaEventId)(),overallDownloadResult:(0,g.getMetricDownloadErrorResultType)(e),overallIsFinal:!1,overallT:t,overallRetryCount:r});var i=(0,g.getStatusCode)(e);null!=i&&(a.downloadHttpCode=i),a.markOverallCumT(),n.commit(),(0,g.logErrorUnknownDetails)(n,e)},debugString:T})]);if(l&&l(),r=j.byteLength,a.set({overallMediaSize:r,overallDownloadResult:b.default.MEDIA_DOWNLOAD_RESULT_TYPE.OK,overallIsFinal:!0,downloadHttpCode:200}),a.markOverallCumT(),a.commit(),null!=I)x=(0,P.default)(yield null===(B=w)||void 0===B?void 0:B.handleProgress(K,j),"yield imageStreamer?.handleProgress(encryptedFileSize, ciphertextHmac)");else x=y?yield(0,h.default)({mediaKeys:Y,ciphertext:j}):yield(0,p.default)({mediaKeys:Y,ciphertextHmac:j,expectedPlaintextHash:s,debugString:T});return __LOG__(2)(k(),T),x}catch(e){throw(e=>{a.set({overallDownloadResult:(0,g.getMetricDownloadErrorResultType)(e),overallIsFinal:!0});var t=(0,g.getStatusCode)(e);null!=t&&(a.downloadHttpCode=t),a.markOverallCumT(),a.commit(),(0,g.logErrorUnknownDetails)(a,e)})(e),e instanceof _.MediaNotFoundError?__LOG__(2,!0)(L(),T,(0,O.default)(e)):__LOG__(3,!0)(N(),T,(0,O.default)(e)),e}}))).apply(this,arguments)}function q(){return z.apply(this,arguments)}function z(){return(z=(0,o.default)((function*(e){var t,r,{mediaObject:a}=e,n=null!==(t=null===(r=a.filehash)||void 0===r?void 0:r.slice(0,10))&&void 0!==t?t:"";a.filehash,a.type,__LOG__(2)(D(),n),a.consolidate({downloadStage:y.DOWNLOAD_STAGE.REUPLOADING});var s=performance.now(),o=new b.default.WebcMediaRmr((0,i.default)((0,i.default)({},e.rmrData),{},{webcRmrReason:e.rmrReason})),u=(0,C.getEffectiveNetworkType)();null!=u&&(o.webcBrowserNetworkType=u),a.type&&(o.messageMediaType=(0,v.webMediaTypeToWamMediaType)(a.type)),null!=a.size&&(o.webcMediaSize=a.size);try{var l=yield a.rmr({onMsgSelect:function(e){null==o.webcChatType&&e.chat&&(o.webcChatType=e.chat.getWebcChatType()),null==o.webcMessageT&&(o.webcMessageT=e.t),o.messageMediaType=e.getWamMediaType()}});if(o.webcRmrStatusCode=l,__LOG__(2)(R(),n,l),404===l)throw new _.MediaNotOnPhone;if(200!==l)throw new _.ServerStatusCodeError(l)}catch(e){throw o.webcMediaRmrError=!0,e instanceof _.MediaNotOnPhone?(__LOG__(2,!0)(I(),n,(0,O.default)(e)),e):(__LOG__(3,!0)(M(),n,e.status||e.message,e.stack),new _.MediaNeedsReupload)}finally{o.webcMediaRmrT=Math.ceil(performance.now()-s),o.commit()}}))).apply(this,arguments)}function J(){return Q.apply(this,arguments)}function Q(){return(Q=(0,o.default)((function*(e){var{directPath:t,encFilehash:r,signal:a,type:n}=e;yield A.default.checkExistence({directPath:t,encFilehash:r,type:n,signal:a||(new u.default).signal})}))).apply(this,arguments)}function X(e){var{scanCount:t,directPath:r,encFilehash:a,type:n,signal:i}=e;return null==t?Promise.resolve(null):A.default.getEncryptedMediaSize({directPath:(0,P.default)(r,"directPath is required for partial downloads"),encFilehash:(0,P.default)(a,"encFilehash is required for partial downloads"),signal:i,type:n})}var Z=new j;t.default=Z},50261:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"LogoutDrop",{enumerable:!0,get:function(){return a.LogoutDrop}}),Object.defineProperty(t,"WebdDrop",{enumerable:!0,get:function(){return a.WebdDrop}}),Object.defineProperty(t,"ServerStatusCodeError",{enumerable:!0,get:function(){return a.ServerStatusCodeError}}),Object.defineProperty(t,"AbortError",{enumerable:!0,get:function(){return n.AbortError}}),Object.defineProperty(t,"HttpNetworkError",{enumerable:!0,get:function(){return n.HttpNetworkError}}),Object.defineProperty(t,"HttpStatusCodeError",{enumerable:!0,get:function(){return n.HttpStatusCodeError}}),Object.defineProperty(t,"MMSForbiddenError",{enumerable:!0,get:function(){return n.MMSForbiddenError}}),Object.defineProperty(t,"MMSUnauthorizedError",{enumerable:!0,get:function(){return n.MMSUnauthorizedError}}),Object.defineProperty(t,"MMSThrottleError",{enumerable:!0,get:function(){return n.MMSThrottleError}}),Object.defineProperty(t,"MediaNotFoundError",{enumerable:!0,get:function(){return n.MediaNotFoundError}}),Object.defineProperty(t,"MediaDecryptionError",{enumerable:!0,get:function(){return i.MediaDecryptionError}}),Object.defineProperty(t,"MediaNeedsReupload",{enumerable:!0,get:function(){return i.MediaNeedsReupload}}),Object.defineProperty(t,"NoMediaHostsError",{enumerable:!0,get:function(){return s.NoMediaHostsError}}),t.MediaNotOnPhone=void 0;var a=r(19741),n=r(85699),i=r(96452),s=r(25172);class o extends a.ServerStatusCodeError{constructor(){super(404),this.name="MediaNotOnPhone"}}t.MediaNotOnPhone=o},25172:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"AbortError",{enumerable:!0,get:function(){return i.default}}),t.NoMediaHostsError=void 0;var n=r(29351),i=a(r(8701));class s extends((0,n.customError)("NoMediaHostsError")){}t.NoMediaHostsError=s},55288:(e,t,r)=>{"use strict";var a=r(93291);Object.defineProperty(t,"__esModule",{value:!0});var n={};Object.defineProperty(t,"default",{enumerable:!0,get:function(){return i.default}});var i=a(r(23832));Object.keys(i).forEach((function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(n,e)||Object.defineProperty(t,e,{enumerable:!0,get:function(){return i[e]}}))}))},94221:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.HOST_TYPE=void 0;var a=r(81135),n=new Set(a.MEDIA_TYPE_VALUES),i=Object.freeze({PRIMARY:"primary",FALLBACK:"fallback"});t.HOST_TYPE=i;t.default=class{constructor(e){this.hostname=e.hostname,this.ips=e.ips||[],this.type=e.type,this.class=e.class;var{downloadBuckets:t,supportedDownloadTypes:r,supportedUploadTypes:a}=function(e){var t,r,a,i,s,o=e||[];for(var u of o){var l,d;if(u.download)for(var c of(a=null!==(l=a)&&void 0!==l?l:new Set,u.download))a.add(c);if(u.upload)for(var f of(i=null!==(d=i)&&void 0!==d?d:new Set,u.upload))i.add(f);u.downloadBuckets&&(s=u.downloadBuckets.map((e=>parseInt(e,10))))}return{supportedDownloadTypes:null!==(t=a)&&void 0!==t?t:n,supportedUploadTypes:null!==(r=i)&&void 0!==r?r:n,downloadBuckets:s}}(e.rules);this.downloadBuckets=t,this._supportedDownloadTypes=r,this._supportedUploadTypes=a}isFallback(){return this.type===i.FALLBACK}supportsDownloadMediaType(e){return this._supportedDownloadTypes.has(e)}supportsUploadMediaType(e){var t="product-catalog-image"===e?"product":e;return this._supportedUploadTypes.has(t)}}},23832:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.FETCH_STATE=void 0;var n=a(r(22220)),i=a(r(19976)),s=a(r(52954)),o=a(r(12489)),u=r(8701),l=r(25172),d=a(r(94221)),c=a(r(10111)),f=a(r(67015)),p=r(11252),h=a(r(94203));function _(){var e=(0,i.default)(["Assertion failed!"]);return _=function(){return e},e}function m(){var e=(0,i.default)(["mediaHosts.sendQueryMediaConn error: ",""]);return m=function(){return e},e}function g(){var e=(0,i.default)(["mediaHosts.sendQueryMediaConn aborted"]);return g=function(){return e},e}t.FETCH_STATE={PENDING:"PENDING",SUCCESS:"SUCCESS",ERROR:"ERROR"};var v=new class{constructor(){var e=this;this._fetch=(0,c.default)((()=>"all"),function(){var t=(0,s.default)((function*({signal:t}){try{var r=yield(0,p.sendQueryMediaConn)(t);e._err=null,e._data={auth:r.auth,authExpirationTime:new Date(r.queryStartTime.getTime()+r.authTTL),authTTL:r.authTTL,hosts:r.hosts.map((e=>new d.default(e))),hostsRefreshTime:new Date(r.queryStartTime.getTime()+r.ttl),queryStartTime:r.queryStartTime,maxBuckets:r.maxBuckets}}catch(t){if(e._data=null,e._err=t,t.name===u.ABORT_ERROR)return void __LOG__(2)(g());__LOG__(3,!0)(m(),function(e){var{name:t,message:r,stack:a}=e,i=(0,n.default)(e,["name","message","stack"]),s=(0,f.default)(e),o=s.slice(s.indexOf("\n")+1),u=0===Object.keys(i).length?"":" "+JSON.stringify(i,((e,t)=>e&&"object"==typeof t?String(t):t));return"".concat(e.name||"Error",": ").concat(e.message).concat(u,"\n").concat(o)}(t)),__LOG__(4,void 0,new Error,!0)(_()),SEND_LOGS("Error fetching mms hosts")}}));return function(){return t.apply(this,arguments)}}()),this._reset()}getHostsInfo({directPath:e,encFilehash:t,operation:r,type:a,signal:n}){var i=this;return(0,s.default)((function*(){var s={signal:n||(new o.default).signal};if(yield i._refreshIfStale(s),!i._data)throw new l.NoMediaHostsError("no fetched data");var{auth:u,hosts:d,maxBuckets:c}=i._data,{selectedHost:f,fallbackHost:p}=(0,h.default)({directPath:e,encFilehash:t,hosts:d,operation:r,type:a,maxBuckets:c});if(!f)throw new l.NoMediaHostsError("no selected host");return{auth:u,selectedHost:f,fallbackHost:p}}))()}_isExpiredOrMissing(){if(!this._data)return!0;var e=this._data;return new Date>=e.authExpirationTime}_needsRefresh(){if(!this._data)return!0;var e=this._data;if(new Date>=e.hostsRefreshTime)return!0;var{authTTL:t,queryStartTime:r}=e,a=Math.floor(.8*t),n=new Date(r.getTime()+a);return new Date>=n}_refreshIfStale(e){var t=this;return(0,s.default)((function*(){return t._isExpiredOrMissing()?(t._reset(),yield t._fetch(e),!0):!!t._needsRefresh()&&(t._fetch(e),!1)}))()}_reset(){this._data=null,this._err=null}};t.default=v},94203:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function({encFilehash:e,directPath:t,hosts:r,operation:a,type:u,maxBuckets:l}){var d,c,f;if(!r.length)return{selectedHost:null,fallbackHost:null};if(a===o.DOWNLOAD){var p,h=t?t.match(/&_nc_hot=([0-9]+)/):null,_=parseInt(h&&h[1],10),m=isNaN(_)?null:Date.now()-_,{mmsHotContentTimespan:g,mmsVCacheAggregationEnabled:v}=s.default;null!=g&&g>0&&(u===i.default.STICKER||null!=m&&m<=g)?p=1:v&&null!=l&&(p=(0,n.default)(e,l)+100);var E=function(e){var t=new Map;return e.forEach((e=>{var r;null===(r=e.downloadBuckets)||void 0===r||r.forEach((r=>{t.set(r,e)}))})),t}(r),y=null==p?null:E.get(p),S=E.get(0);(null==y?void 0:y.supportsDownloadMediaType(u))?f=y:(null==S?void 0:S.supportsDownloadMediaType(u))&&(f=S)}var T=r.find((e=>e.isFallback()));return f=null!==(d=f)&&void 0!==d?d:r.find((e=>a===o.UPLOAD?e.supportsUploadMediaType(u):e.supportsDownloadMediaType(u))),{selectedHost:null!==(c=f)&&void 0!==c?c:null,fallbackHost:null!=T?T:null}},t.OPERATIONS=void 0;var n=a(r(91612)),i=a(r(81135)),s=a(r(72424)),o={DOWNLOAD:"DOWNLOAD",UPLOAD:"UPLOAD"};t.OPERATIONS=o},85699:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"AbortError",{enumerable:!0,get:function(){return a.AbortError}}),Object.defineProperty(t,"HttpNetworkError",{enumerable:!0,get:function(){return a.HttpNetworkError}}),Object.defineProperty(t,"HttpInvalidResponseError",{enumerable:!0,get:function(){return a.HttpInvalidResponseError}}),Object.defineProperty(t,"MmsDownloadFilehashMismatchError",{enumerable:!0,get:function(){return a.MmsDownloadFilehashMismatchError}}),Object.defineProperty(t,"HttpStatusCodeError",{enumerable:!0,get:function(){return a.HttpStatusCodeError}}),Object.defineProperty(t,"NoMediaHostsError",{enumerable:!0,get:function(){return n.NoMediaHostsError}}),t.MMSThrottleError=t.MMSForbiddenError=t.MMSUnauthorizedError=t.MediaInvalidError=t.MediaTooLargeError=t.MediaNotFoundError=void 0;var a=r(37755),n=r(25172);class i extends a.HttpStatusCodeError{constructor(e,t){super(404,e,t),this.name="MediaNotFoundError"}}t.MediaNotFoundError=i;class s extends a.HttpStatusCodeError{constructor(e,t){super(413,e,t),this.name="MediaTooLargeError"}}t.MediaTooLargeError=s;class o extends a.HttpStatusCodeError{constructor(e,t){super(415,e,t),this.name="MediaInvalidError"}}t.MediaInvalidError=o;class u extends a.HttpStatusCodeError{constructor(e,t){super(401,e,t),this.name="MMSUnauthorizedError"}}t.MMSUnauthorizedError=u;class l extends a.HttpStatusCodeError{constructor(e,t){super(403,e,t),this.name="MMSForbiddenError"}}t.MMSForbiddenError=l;class d extends a.HttpStatusCodeError{constructor(e,t){super(507,e,t),this.name="MMSThrottleError"}}t.MMSThrottleError=d},42140:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function({directPath:e,encFilehash:t,hostname:r,type:a,mode:n,byteRange:d}){return e?function({directPath:e,encFilehash:t,hostname:r,query:a}){var n=new URL(e,"https://".concat(r));if(n.hostname!==r)throw __LOG__(4,void 0,new Error,!0)(l(),n.hostname,r,e),SEND_LOGS("malicious directPath"),new Error("malicious directPath");var i=n.searchParams||new u.default(n.search);return i.set("hash",(0,o.default)(t)),Object.keys(a).forEach((e=>{var t=a[e];null!=t&&i.set(e,t)})),"https://".concat(n.host).concat(n.pathname,"?").concat(i.toString())}({encFilehash:t,hostname:r,directPath:e,query:{mode:n,bytestart:null==d?void 0:d.start.toString(),byteend:null==d?void 0:d.end.toString(),[s.MMS_URL_MEDIA_TYPE_SEARCH_PARAM]:a,[s.IS_MMS_URL_SEARCH_PARAM]:""}}):(0,i.default)({hostname:r,type:a,encFilehash:t,query:{mode:n,[s.IS_MMS_URL_SEARCH_PARAM]:""}})};var n=a(r(19976)),i=a(r(78053)),s=r(75328),o=a(r(76796)),u=a(r(99340));function l(){var e=(0,n.default)(["url.hostname: ",", hostname: ",", directPath: ",""]);return l=function(){return e},e}},78053:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function({hostname:e,type:t,encFilehash:r,query:a}){var o=s[t],u=new URL("https://".concat(e).concat(o,"/").concat((0,n.default)(r))),l={};a&&Object.keys(a).forEach((e=>{null!=a[e]&&(l[e]=a[e])}));var d=new i.default(l).toString();d&&(d="?".concat(d));return"https://".concat(u.host).concat(u.pathname).concat(d)};var n=a(r(76796)),i=a(r(99340)),s={audio:"/mms/audio",document:"/mms/document",gif:"/mms/gif",image:"/mms/image",ppic:"/pps/photo",product:"/mms/image",ptt:"/mms/ptt",sticker:"/mms/sticker","thumbnail-document":"/mms/thumbnail-document",video:"/mms/video","md-app-state":"/mms/md-app-state","product-catalog-image":"/product/image"}},25608:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function({auth:e,encFilehash:t,hostname:r,query:a,type:o}){var u=(0,n.default)({auth:e,token:(0,s.default)(t)},a);return(0,i.default)({encFilehash:t,hostname:r,type:o,query:u})};var n=a(r(70417)),i=a(r(78053)),s=a(r(76796))},62962:(e,t,r)=>{"use strict";var a=r(93291);Object.defineProperty(t,"__esModule",{value:!0});var n={};Object.defineProperty(t,"default",{enumerable:!0,get:function(){return i.default}});var i=a(r(29203));Object.keys(i).forEach((function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(n,e)||Object.defineProperty(t,e,{enumerable:!0,get:function(){return i[e]}}))}))},321:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){if(e instanceof a.MMSThrottleError)return!1;return e instanceof a.NoMediaHostsError||e instanceof a.HttpNetworkError||e instanceof a.MMSUnauthorizedError||e instanceof a.HttpStatusCodeError&&e.status>=500};var a=r(85699)},97352:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return e.encFilehash,e.type,__LOG__(2)(f()),(0,o.default)(e).then((e=>{if("complete"!==e.resume)throw new s.MediaNotFoundError("mmsCheckIfUploadExists");if(!e.directPath)throw new s.HttpInvalidResponseError("mmsCheckIfUploadExists: missing directPath");if(!e.url)throw new s.HttpInvalidResponseError("mmsCheckIfUploadExists: missing url");return{directPath:e.directPath,url:e.url,handle:e.handle}})).then((e=>(__LOG__(2)(c()),e))).catch((e=>{throw e instanceof s.MediaNotFoundError?__LOG__(2)(d()):e.name===i.ABORT_ERROR?__LOG__(2)(l()):__LOG__(3)(u()),e}))};var n=a(r(19976)),i=r(8701),s=r(85699),o=a(r(60918));function u(){var e=(0,n.default)(["mmsCheckIfUploadExists: error"]);return u=function(){return e},e}function l(){var e=(0,n.default)(["mmsCheckIfUploadExists: canceled"]);return l=function(){return e},e}function d(){var e=(0,n.default)(["mmsCheckIfUploadExists: expected error"]);return d=function(){return e},e}function c(){var e=(0,n.default)(["mmsCheckIfUploadExists: success"]);return c=function(){return e},e}function f(){var e=(0,n.default)(["mmsCheckIfUploadExists: start"]);return f=function(){return e},e}},29203:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(52954)),i=a(r(70417)),s=a(r(19976)),o=r(8701),u=r(85699),l=a(r(82195)),d=a(r(321)),c=a(r(55288)),f=a(r(97352)),p=r(74477),h=a(r(70950)),_=a(r(99911)),m=a(r(39417));function g(){var e=(0,s.default)(["runMmsTaskWithBackoff: attempt #",""]);return g=function(){return e},e}function v(){var e=(0,s.default)(["runTaskWithBackoff: start"]);return v=function(){return e},e}function E(){var e=(0,s.default)(["mmsClient.download: [","] error"]);return E=function(){return e},e}function y(){var e=(0,s.default)(["mmsClient.download: [","] canceled"]);return y=function(){return e},e}function S(){var e=(0,s.default)(["mmsClient.download: [","] expected error"]);return S=function(){return e},e}function T(){var e=(0,s.default)(["mmsClient.download: [","] success"]);return T=function(){return e},e}function b(){var e=(0,s.default)(["mmsClient.download: [","] attempt #",""]);return b=function(){return e},e}function A(){var e=(0,s.default)(["mmsClient.download: [","] start"]);return A=function(){return e},e}function C(){var e=(0,s.default)(["mmsClient.upload: error"]);return C=function(){return e},e}function P(){var e=(0,s.default)(["mmsClient.upload: canceled"]);return P=function(){return e},e}function O(){var e=(0,s.default)(["mmsClient.upload: success"]);return O=function(){return e},e}function w(){var e=(0,s.default)(["mmsClient.upload: attempt #",""]);return w=function(){return e},e}function M(){var e=(0,s.default)(["mmsClient.upload: start"]);return M=function(){return e},e}function I(){var e=(0,s.default)(["mmsClient.checkIfUploadExists: error"]);return I=function(){return e},e}function R(){var e=(0,s.default)(["mmsClient.checkIfUploadExists: canceled"]);return R=function(){return e},e}function D(){var e=(0,s.default)(["mmsClient.checkIfUploadExists: expected error"]);return D=function(){return e},e}function N(){var e=(0,s.default)(["mmsClient.checkIfUploadExists: success"]);return N=function(){return e},e}function L(){var e=(0,s.default)(["mmsClient.checkIfUploadExists: attempt #",""]);return L=function(){return e},e}function k(){var e=(0,s.default)(["mmsClient.checkIfUploadExists: start"]);return k=function(){return e},e}var U={minTimeout:1e3,retries:3};function F(e,t){var{directPath:r,encFilehash:a,type:s,signal:o}=t;return __LOG__(2)(v()),(0,l.default)((0,i.default)((0,i.default)({},U),{},{signal:o}),function(){var t=(0,n.default)((function*(t,n){__LOG__(2)(g(),n+1);try{var i=yield function(){return G.apply(this,arguments)}({operation:m.default.DOWNLOAD,directPath:r,encFilehash:a,type:s,signal:o,failCount:n});return yield e(i)}catch(e){if((0,d.default)(e))return t(e);throw e}}));return function(){return t.apply(this,arguments)}}())}function G(){return(G=(0,n.default)((function*(e){var{failCount:t,operation:r,directPath:a,encFilehash:n,type:i,signal:s}=e,{selectedHost:o,fallbackHost:u}=yield c.default.getHostsInfo({operation:r,directPath:a,encFilehash:n,type:i,signal:s});return(t>=2&&u?u:o).hostname}))).apply(this,arguments)}var x=new class{checkIfUploadExists(e){var{encFilehash:t,signal:r,type:a}=e,n=!0;return e.encFilehash,e.type,__LOG__(2)(k()),(0,l.default)((0,i.default)((0,i.default)({},U),{},{signal:r}),((e,i)=>(__LOG__(2)(L(),i+1),_.default.waitIfOffline({signal:r}).then((()=>c.default.getHostsInfo({operation:m.default.UPLOAD,encFilehash:t,type:a,signal:r}).then((({auth:e,selectedHost:s,fallbackHost:o})=>{var u=i>=2&&!n&&o?o:s;return(0,f.default)({auth:e,encFilehash:t,hostname:u.hostname,type:a,signal:r,onProgress:()=>{n=!0}})})).catch((t=>{if((0,d.default)(t))return e(t);throw t}))))))).then((e=>(__LOG__(2)(N()),e))).catch((e=>{throw e instanceof u.MediaNotFoundError?__LOG__(2)(D()):e.name===o.ABORT_ERROR?__LOG__(2)(R()):__LOG__(3)(I()),e}))}upload(e){var{ciphertextHmac:t,encFilehash:r,type:a,signal:n,onUploadHostFound:s,onUploadAttemptSuccess:u,onUploadAttemptError:f}=e,p=!0;__LOG__(2)(M());var g=Date.now();return(0,l.default)((0,i.default)((0,i.default)({},U),{},{signal:n}),((e,i)=>(g=Date.now(),__LOG__(2)(w(),i+1),_.default.waitIfOffline({signal:n}).then((()=>c.default.getHostsInfo({operation:m.default.UPLOAD,encFilehash:r,type:a,signal:n}).then((({auth:e,selectedHost:o,fallbackHost:u})=>{var l=i>=2&&!p&&u?u:o;return s({hostName:l.hostname,hostClass:l.class,failCount:i}),(0,h.default)({auth:e,ciphertextHmac:t,hostname:l.hostname,encFilehash:r,type:a,signal:n,onProgress:()=>{p=!0}})})).catch((t=>{var r=(0,d.default)(t);if(!r||i===U.retries||f(t,Date.now()-g),r)return e(t);throw t}))))))).then((e=>(u(Date.now()-g),__LOG__(2)(O()),e))).catch((e=>{throw e.name===o.ABORT_ERROR?__LOG__(2)(P()):__LOG__(3)(C()),e}))}download(e){var{directPath:t,encFilehash:r,type:a,signal:n,mode:s,byteRange:f,debugString:h,onResponseText:_,onDownloadHostFound:g,onDownloadAttemptSuccess:v,onDownloadAttemptError:C}=e,P=!0;__LOG__(2)(A(),h);var O=Date.now();return(0,l.default)((0,i.default)((0,i.default)({},U),{},{signal:n}),((e,i)=>(O=Date.now(),__LOG__(2)(b(),h,i+1),c.default.getHostsInfo({operation:m.default.DOWNLOAD,directPath:t,encFilehash:r,type:a,signal:n}).then((({auth:e,selectedHost:o,fallbackHost:u})=>{var l=i>=2&&!P&&u?u:o;return g({hostName:l.hostname,hostClass:l.class,failCount:i}),(0,p.mms4Download)({directPath:t,encFilehash:r,hostname:l.hostname,type:a,signal:n,mode:s,byteRange:f,debugString:h,onProgress:()=>{P=!0},onResponseText:_})})).catch((t=>{var r=(0,d.default)(t);if(!r||i===U.retries||C({err:t,overallT:Date.now()-O,failCount:i}),r)return e(t);throw t}))))).then((e=>(v(Date.now()-O),__LOG__(2)(T(),h),e))).catch((e=>{throw e instanceof u.MediaNotFoundError?__LOG__(2)(S(),h):e.name===o.ABORT_ERROR?__LOG__(2)(y(),h):__LOG__(3)(E(),h),e}))}checkExistence(e){return F((t=>(0,p.mmsCheckExistence)((0,i.default)((0,i.default)({},e),{},{hostname:t}))),e)}getEncryptedMediaSize(e){return F((t=>(0,p.mmsGetEncryptedMediaSize)((0,i.default)((0,i.default)({},e),{},{hostname:t}))),e)}};t.default=x},74477:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=g,t.mms4Download=function({directPath:e,encFilehash:t,hostname:r,type:a,signal:n,onProgress:s,onResponseText:u,mode:l,byteRange:d,debugString:f}){var p=(0,c.default)({directPath:e,encFilehash:t,hostname:r,type:a,mode:l,byteRange:d});return g({url:p,signal:n,onProgress:s,onResponseText:u,ciphertextValidator:d?null:function(){var e=(0,i.default)((function*(e){return(yield(0,o.default)(e))===t}));return function(){return e.apply(this,arguments)}}(),debugString:f,debug:{encFilehash:t,type:a,url:p}})},t.mms3Download=function({signal:e,deprecatedMms3Url:t,debugString:r,onProgress:a,onResponseText:n}){return g({url:t,signal:e,onProgress:a,onResponseText:n,debugString:r,debug:{deprecatedMms3Url:t}})},t.mmsCheckExistence=function(){return E.apply(this,arguments)},t.mmsGetEncryptedMediaSize=function(){return y.apply(this,arguments)},t.validateMmsResponse=S;var n=a(r(19976)),i=a(r(52954)),s=r(8701),o=a(r(57430)),u=r(85699),l=r(96452),d=a(r(3757)),c=a(r(42140));function f(){var e=(0,n.default)(["mmsDownload: [","] error ",""]);return f=function(){return e},e}function p(){var e=(0,n.default)(["mmsDownload: [","] canceled"]);return p=function(){return e},e}function h(){var e=(0,n.default)(["mmsDownload: [","] error "," ",""]);return h=function(){return e},e}function _(){var e=(0,n.default)(["mmsDownload: [","] success"]);return _=function(){return e},e}function m(){var e=(0,n.default)(["mmsDownload: [","] start"]);return m=function(){return e},e}function g(){return v.apply(this,arguments)}function v(){return(v=(0,i.default)((function*({url:e,signal:t,onProgress:r,onResponseText:a,debug:n,debugString:i,ciphertextValidator:o}){__LOG__(2)(m(),i);try{var l=yield(0,d.default)(e,{signal:t,onProgress:r,onResponseText:a});yield S({response:l,functionName:"mmsDownload",url:e});var c=yield l.arrayBuffer();if(o&&!(yield o(c)))throw new u.MmsDownloadFilehashMismatchError({url:e});return __LOG__(2)(_(),i),c}catch(e){throw e instanceof u.MediaNotFoundError?__LOG__(2)(h(),i,e.name,e.message):e.name===s.ABORT_ERROR?__LOG__(2)(p(),i):__LOG__(3)(f(),i,String(e)),e}}))).apply(this,arguments)}function E(){return(E=(0,i.default)((function*(e){var{directPath:t,encFilehash:r,hostname:a,type:n,signal:i}=e;yield b({directPath:t,encFilehash:r,hostname:a,type:n,signal:i,functionName:"mmsCheckExistence"})}))).apply(this,arguments)}function y(){return(y=(0,i.default)((function*(e){var{directPath:t,encFilehash:r,hostname:a,type:n,signal:i}=e,s=(yield b({directPath:t,encFilehash:r,hostname:a,type:n,signal:i,functionName:"mmsGetEncryptedMediaSize"})).headers.get("content-length");if(!s)throw new l.UnableToGetContentLengthError;return parseInt(s,10)}))).apply(this,arguments)}function S(){return T.apply(this,arguments)}function T(){return(T=(0,i.default)((function*(e){var{response:t,url:r,functionName:a}=e;if(!t.ok)switch(t.status){case 401:throw new u.MMSUnauthorizedError(a,{url:r});case 403:if((yield t.text()).includes("URL signature expired"))throw new u.MediaNotFoundError(a,{url:r,status:t.status});throw new u.MMSForbiddenError(a,{url:r});case 404:case 410:throw new u.MediaNotFoundError(a,{url:r,status:t.status});case 507:throw new u.MMSThrottleError(a,{url:r});default:throw new u.HttpStatusCodeError(t.status,a,{url:r})}}))).apply(this,arguments)}function b(){return A.apply(this,arguments)}function A(){return(A=(0,i.default)((function*(e){var{directPath:t,encFilehash:r,hostname:a,type:n,signal:i,functionName:s}=e,o=(0,c.default)({directPath:t,encFilehash:r,hostname:a,type:n,mode:"auto"}),u=yield(0,d.default)(o,{method:"HEAD",signal:i});return yield S({response:u,functionName:s,url:o}),u}))).apply(this,arguments)}},60918:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var{auth:t,encFilehash:r,hostname:a,signal:n,type:h,onProgress:_}=e,m=(0,u.default)({auth:t,encFilehash:r,hostname:a,query:{resume:1},type:h});return e.encFilehash,e.type,__LOG__(2)(p()),(0,o.default)(m,{method:"post",signal:n,onProgress:_}).then((e=>{if(e.ok)return e.json();switch(e.status){case 401:throw new s.MMSUnauthorizedError("mmsGetUploadProgress",{url:m});case 404:throw new s.MediaNotFoundError("mmsGetUploadProgress",{url:m});default:throw new s.HttpStatusCodeError(e.status,"mmsGetUploadProgress",{url:m})}})).then((e=>{if(!e.resume)throw new s.HttpInvalidResponseError("mmsGetUploadProgress: missing resume",{url:m});return{directPath:e.direct_path,resume:e.resume,url:e.url}})).then((e=>(__LOG__(2)(f()),e))).catch((e=>{throw e instanceof s.MediaNotFoundError?__LOG__(2)(c()):e.name===i.ABORT_ERROR?__LOG__(2)(d()):__LOG__(3)(l()),e}))};var n=a(r(19976)),i=r(8701),s=r(85699),o=a(r(3757)),u=a(r(25608));function l(){var e=(0,n.default)(["mmsGetUploadProgress: error"]);return l=function(){return e},e}function d(){var e=(0,n.default)(["mmsGetUploadProgress: canceled"]);return d=function(){return e},e}function c(){var e=(0,n.default)(["mmsGetUploadProgress: expected error"]);return c=function(){return e},e}function f(){var e=(0,n.default)(["mmsGetUploadProgress: success"]);return f=function(){return e},e}function p(){var e=(0,n.default)(["mmsGetUploadProgress: start"]);return p=function(){return e},e}},70950:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var{auth:t,ciphertextHmac:r,encFilehash:a,hostname:n,type:p,signal:h,onProgress:_}=e,m=(0,u.default)({auth:t,encFilehash:a,hostname:n,type:p});return __LOG__(2)(f()),(0,o.default)(m,{method:"post",body:r,signal:h,onProgress:_}).then((e=>{if(!e.ok)switch(e.status){case 401:throw new s.MMSUnauthorizedError("mmsUpload",{url:m});case 413:throw new s.MediaTooLargeError("mmsUpload",{url:m});case 415:throw new s.MediaInvalidError("mmsUpload: hash mismatch",{url:m});case 507:throw new s.MMSThrottleError("mmsUpload",{url:m});default:throw new s.HttpStatusCodeError(e.status,"mmsUpload",{url:m})}return e.json()})).then((e=>{if(!e.direct_path)throw new s.HttpInvalidResponseError("mmsUpload: missing direct_path");if(!e.url)throw new s.HttpInvalidResponseError("mmsUpload: missing url");return{directPath:e.direct_path,url:e.url,handle:e.handle}})).then((e=>(__LOG__(2)(c()),e))).catch((e=>{throw e.name===i.ABORT_ERROR?__LOG__(2)(d()):__LOG__(3)(l()),e}))};var n=a(r(19976)),i=r(8701),s=r(85699),o=a(r(3757)),u=a(r(25608));function l(){var e=(0,n.default)(["mmsUpload: error"]);return l=function(){return e},e}function d(){var e=(0,n.default)(["mmsUpload: canceled"]);return d=function(){return e},e}function c(){var e=(0,n.default)(["mmsUpload: success"]);return c=function(){return e},e}function f(){var e=(0,n.default)(["mmsUpload: start"]);return f=function(){return e},e}},65710:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"AbortError",{enumerable:!0,get:function(){return a.AbortError}}),Object.defineProperty(t,"HttpNetworkError",{enumerable:!0,get:function(){return a.HttpNetworkError}}),Object.defineProperty(t,"HttpStatusCodeError",{enumerable:!0,get:function(){return a.HttpStatusCodeError}}),Object.defineProperty(t,"MediaNotFoundError",{enumerable:!0,get:function(){return a.MediaNotFoundError}}),Object.defineProperty(t,"MediaTooLargeError",{enumerable:!0,get:function(){return a.MediaTooLargeError}}),Object.defineProperty(t,"MediaInvalidError",{enumerable:!0,get:function(){return a.MediaInvalidError}}),Object.defineProperty(t,"MMSUnauthorizedError",{enumerable:!0,get:function(){return a.MMSUnauthorizedError}}),Object.defineProperty(t,"MediaEncryptionError",{enumerable:!0,get:function(){return n.MediaEncryptionError}}),Object.defineProperty(t,"NoMediaHostsError",{enumerable:!0,get:function(){return i.NoMediaHostsError}});var a=r(85699),n=r(96452),i=r(25172)},14258:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return n.default}});var n=a(r(52134))},52134:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(19976)),i=r(8701),s=a(r(495)),o=r(85699),u=r(99888),l=r(66925),d=a(r(10111)),c=a(r(40210)),f=a(r(62962)),p=a(r(96598)),h=a(r(72424)),_=a(r(99340));function m(){var e=(0,n.default)(["uploadManager.encryptAndUpload: error"]);return m=function(){return e},e}function g(){var e=(0,n.default)(["uploadManager.encryptAndUpload: canceled"]);return g=function(){return e},e}function v(){var e=(0,n.default)(["uploadManager.encryptAndUpload: success"]);return v=function(){return e},e}function E(){var e=(0,n.default)(["uploadManager.encryptAndUpload: start"]);return E=function(){return e},e}function y(){var e=(0,n.default)(["uploadManager._getExistingOrUpload: error"]);return y=function(){return e},e}function S(){var e=(0,n.default)(["uploadManager._getExistingOrUpload: canceled"]);return S=function(){return e},e}function T(){var e=(0,n.default)(["uploadManager._getExistingOrUpload: success"]);return T=function(){return e},e}function b(){var e=(0,n.default)(["uploadManager._getExistingOrUpload: start"]);return b=function(){return e},e}function A(){var e=(0,n.default)(["uploadManager.checkIfAlreadyUploaded: error"]);return A=function(){return e},e}function C(){var e=(0,n.default)(["uploadManager.checkIfAlreadyUploaded: canceled"]);return C=function(){return e},e}function P(){var e=(0,n.default)(["uploadManager.checkIfAlreadyUploaded: success"]);return P=function(){return e},e}function O(){var e=(0,n.default)(["uploadManager.checkIfAlreadyUploaded: start"]);return O=function(){return e},e}function w(e,t,r,a){var n=new c.default.MediaUpload2({mediaId:(0,l.generateMediaEventId)(),connectionType:c.default.CONNECTION_TYPE.HOSTNAME,overallMediaType:(0,l.getMetricMediaType)(e),overallMmsVersion:4,overallAttemptCount:r,networkStack:c.default.NETWORK_STACK_TYPE.NATIVE,overallUploadMode:c.default.MEDIA_UPLOAD_MODE_TYPE.REGULAR,overallIsForward:a,overallUploadOrigin:t});return{onArrayBufferCreated:function(e){n.set({overallMediaSize:e})},onCheckExistingError:function(e){e instanceof o.HttpStatusCodeError&&n.set({resumeHttpCode:e.status})},onCheckExistingSuccess:function(){n.set({overallUploadResult:c.default.MEDIA_UPLOAD_RESULT_TYPE.DUPLICATE,overallIsFinal:!0,resumeHttpCode:200}),n.markOverallCumT(),n.commit()},onUploadHostFound:function({hostName:e,hostClass:t,failCount:r}){n.set({overallDomain:e,overallConnectionClass:t,overallRetryCount:r})},onUploadSuccess:function(){n.set({resumeHttpCode:404,overallUploadResult:c.default.MEDIA_UPLOAD_RESULT_TYPE.OK,overallIsFinal:!0,uploadHttpCode:200,finalizeHttpCode:200}),n.markOverallCumT(),n.commit()},onUploadError:function(e){n.set({overallUploadResult:(0,l.getMetricUploadErrorResultType)(e),overallIsFinal:!0});var t=(0,l.getStatusCode)(e);null!=t&&(n.uploadHttpCode=t,n.finalizeHttpCode=t),n.markOverallCumT(),n.commit(),(0,l.logErrorUnknownDetails)(n,e)},onUploadAttemptSuccess:function(e){n.set({overallT:e})},onUploadAttemptError:function(e,t,r){var a=new c.default.MediaUpload2(n);a.set({mediaId:(0,l.generateMediaEventId)(),overallUploadResult:(0,l.getMetricUploadErrorResultType)(e),overallIsFinal:!1,overallT:t,overallRetryCount:r});var i=(0,l.getStatusCode)(e);null!=i&&(n.uploadHttpCode=i),n.markOverallCumT(),a.commit(),(0,l.logErrorUnknownDetails)(n,e)}}}var M=new class{constructor(){this.checkIfAlreadyUploaded=(0,d.default)((e=>e.encFilehash),(e=>{var{encFilehash:t,type:r}=e;return __LOG__(2)(O()),f.default.checkIfUploadExists(e).catchType(o.MediaNotFoundError,(()=>null)).then((e=>(__LOG__(2)(P()),e))).catch((e=>{throw e.name===i.ABORT_ERROR?__LOG__(2)(C()):__LOG__(3)(A()),e}))})),this._memoizedUpload=(0,d.default)((e=>e.encFilehash),(e=>{var{ciphertextHmac:t,encFilehash:r,type:a,signal:n,onUploadHostFound:i,onUploadAttemptSuccess:s,onUploadAttemptError:o,onUploadSuccess:u}=e;return f.default.upload({ciphertextHmac:t,encFilehash:r,type:a,signal:n,onUploadHostFound:i,onUploadAttemptSuccess:s,onUploadAttemptError:o}).then((e=>(u(),e)))})),this._getExistingOrUpload=(0,d.default)((e=>e.encFilehash),(e=>{var{ciphertextHmac:t,encFilehash:r,signal:a,type:n,onCheckExistingSuccess:s,onCheckExistingError:o,onUploadHostFound:u,onUploadAttemptSuccess:l,onUploadAttemptError:d,onUploadSuccess:c}=e;return __LOG__(2)(b()),this.checkIfAlreadyUploaded({encFilehash:r,type:n,signal:a}).catch((e=>{throw o(e),e})).then((e=>e?(s(),e):this._memoizedUpload({ciphertextHmac:t,encFilehash:r,type:n,signal:a,onUploadHostFound:u,onUploadAttemptSuccess:l,onUploadAttemptError:d,onUploadSuccess:c}))).then((e=>(__LOG__(2)(T()),e))).catch((e=>{throw e.name===i.ABORT_ERROR?__LOG__(2)(S()):__LOG__(3)(y()),e}))}))}encryptAndUpload(e){var{blob:t,signal:r,type:a,userUploadAttemptCount:n,forwardedFromWeb:o,uploadOrigin:l}=e;__LOG__(2)(E());var{onCheckExistingSuccess:d,onCheckExistingError:c,onUploadHostFound:f,onUploadAttemptSuccess:_,onUploadAttemptError:y,onUploadSuccess:S,onArrayBufferCreated:T,onUploadError:b}=w(a,l,n,o);return(t instanceof Blob?(0,u.blobToArrayBuffer)(t):Promise.resolve(t)).then((t=>{var n,i;if(T(t.byteLength),null!=e.mediaKey&&null!=e.mediaKeyTimestamp)n=e.mediaKey,i=e.mediaKeyTimestamp;else{var u=(0,p.default)();n=u.key,i=u.timestamp}return(0,s.default)({type:a,plaintext:t,mediaKey:n}).then((({ciphertextHmac:t,hash:s,sidecar:u,firstFrameSidecar:l})=>(e.mediaKey?this._getExistingOrUpload({ciphertextHmac:t,encFilehash:s,type:a,signal:r,onCheckExistingSuccess:d,onCheckExistingError:c,onUploadHostFound:f,onUploadAttemptSuccess:_,onUploadAttemptError:y,onUploadSuccess:S}):this._memoizedUpload({ciphertextHmac:t,encFilehash:s,type:a,signal:r,onUploadHostFound:f,onUploadAttemptSuccess:_,onUploadAttemptError:y,onUploadSuccess:S})).then((e=>({directPath:o&&h.default.mmsCatV1ForwardHotOverrideEnabled?I(e.directPath):e.directPath,encFilehash:s,mediaKey:n,mediaKeyTimestamp:i,sidecar:u,firstFrameSidecar:l,url:e.url,handle:e.handle})))))})).then((e=>(__LOG__(2)(v()),e))).catch((e=>{throw e.name===i.ABORT_ERROR?__LOG__(2)(g()):__LOG__(3)(m()),b(e),e}))}unencryptedUpload(e){var{file:t,hash:r,type:a,signal:n,uploadOrigin:i}=e,{onCheckExistingSuccess:s,onCheckExistingError:o,onUploadHostFound:u,onUploadAttemptSuccess:l,onUploadAttemptError:d,onUploadSuccess:c}=w(a,i,0,!1);return this._getExistingOrUpload({ciphertextHmac:t,encFilehash:r,type:a,signal:n,onCheckExistingSuccess:s,onCheckExistingError:o,onUploadHostFound:u,onUploadAttemptSuccess:l,onUploadAttemptError:d,onUploadSuccess:c})}};function I(e){var[t,r]=e.split("?"),a=new _.default(r),n=Math.round(Date.now()/1e3);return a.set("_nc_hot",String(n)),"".concat(t,"?").concat(a.toString())}t.default=M},8401:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.cancelDownloadMedia=function(e){var{downloadPromise:t}=e;if(null==t)return;var r=j.get(t);if(null==r)return;j.delete(t),r()},t.manuallySetMedia=function({mimetype:e,mediaObject:t,mediaBlob:r,mediaType:a,rmrReason:n,downloadOrigin:i}){if(t.mediaBlob)return;(0,v.gatherAndSetMetadata)(t,r).then((()=>W({mimetype:e,mediaObject:t,downloadEvenIfExpensive:!1,mediaType:a,rmrReason:n,downloadOrigin:i})))},t.downloadMedia=W,t.checkExistence=function(){return V.apply(this,arguments)},Object.defineProperty(t,"MediaDecryptionError",{enumerable:!0,get:function(){return c.MediaDecryptionError}}),Object.defineProperty(t,"MediaNotOnPhone",{enumerable:!0,get:function(){return c.MediaNotOnPhone}});var i=n(r(52954)),s=n(r(19976)),o=r(29351),u=n(r(12489)),l=r(8701),d=n(r(1616)),c=r(50261),f=a(r(96452)),p=r(99888),h=n(r(54146)),_=a(r(23765)),m=n(r(81135)),g=r(96645),v=r(82982),E=n(r(40210)),y=r(41501),S=n(r(61941)),T=n(r(25012)),b=n(r(92087)),A=r(84990);function C(){var e=(0,s.default)(["checkExistence: error"]);return C=function(){return e},e}function P(){var e=(0,s.default)(["downloadMedia: error"]);return P=function(){return e},e}function O(){var e=(0,s.default)(["Assertion failed! ",""]);return O=function(){return e},e}function w(){var e=(0,s.default)(["downloadMedia: error: ",", ",""]);return w=function(){return e},e}function M(){var e=(0,s.default)(["Assertion failed! ",""]);return M=function(){return e},e}function I(){var e=(0,s.default)(["downloadMedia: error: ",", ",""]);return I=function(){return e},e}function R(){var e=(0,s.default)(["Assertion failed! ",""]);return R=function(){return e},e}function D(){var e=(0,s.default)(["downloadMedia: media unsupported error: ",", ",", ",""]);return D=function(){return e},e}function N(){var e=(0,s.default)(["Assertion failed!"]);return N=function(){return e},e}function L(){var e=(0,s.default)(["Unexpected download error: ",""]);return L=function(){return e},e}function k(){var e=(0,s.default)(["Assertion failed! ",""]);return k=function(){return e},e}function U(){var e=(0,s.default)(["downloadMedia: media unsupported error: ",", ",", ",""]);return U=function(){return e},e}function F(){var e=(0,s.default)(["Failed to retrieve blob text contents ",""]);return F=function(){return e},e}function G(){var e=(0,s.default)(["Assertion failed!"]);return G=function(){return e},e}class x extends((0,o.customError)("NoEntryAfterRMR")){}class B extends((0,o.customError)("MissingEncFilehash")){}var Y=3,K=4,j=new WeakMap;function W({mimetype:e,mediaObject:t,downloadEvenIfExpensive:r,mediaType:a,signal:n,rmrReason:i,rmrData:s,downloadOrigin:o,shouldThrow:E,isVcardOverMmsDocument:C,mode:Y}){if(!t)return Promise.resolve();var K=t.filehash;if(!K)return Promise.resolve();if(t.downloadPromise)return t.downloadPromise;if(t.downloadStage===g.DOWNLOAD_STAGE.ERROR_MISSING)return Promise.resolve();if(t.downloadStage===g.DOWNLOAD_STAGE.PREPARING)return Promise.resolve();if(t.mediaBlob)return t.mediaBlob.validate().then((e=>{if(!e)return t.clearBlob(),t.consolidate({downloadStage:g.DOWNLOAD_STAGE.NEED_POKE}),t.notifyMsgsAsync(),Promise.resolve();t.consolidate({downloadStage:g.DOWNLOAD_STAGE.RESOLVED})}));var V,q,z=h.default.get(K),J=new u.default;return(0,b.default)([J.signal,n].filter(Boolean),(n=>{if(z)V=Promise.resolve(z);else{var b;if(q=t.entries.getDownloadEntry())b=Promise.resolve(q);else{if(!r)return t.consolidate({downloadStage:g.DOWNLOAD_STAGE.NEED_POKE}),Promise.resolve();b=d.default.rmr({mediaObject:t,signal:n,rmrReason:i,rmrData:s}).then((()=>{if(!(q=t.entries.getDownloadEntry()))throw new x;return q}))}t.consolidate({downloadStage:g.DOWNLOAD_STAGE.FETCHING}),V=(0,S.default)(b,"entryPromise").then((r=>{q=r;var{encFilehash:i}=q;if(!i)throw q.markWhetherOnServer(!1),new B;var s=q,{scansSidecar:u,scanLengths:l}=q;return d.default.downloadAndDecrypt({directPath:s.directPath,encFilehash:i,filehash:K,mediaKey:s.mediaKey,mediaKeyTimestamp:s.mediaKeyTimestamp,signal:n,type:a,onDecryptStart:()=>{t.consolidate({downloadStage:g.DOWNLOAD_STAGE.PROCESSING})},userDownloadAttemptCount:t.userDownloadAttemptCount,downloadOrigin:o,mode:Y,progressiveJpegOpts:H({scanLengths:l,scansSidecar:u,mimetype:e,mediaObject:t})}).then((t=>{var r=e||(0,y.getMediaMimeType)(a,new Uint8Array(t)),n=new Blob([t],{type:r});return!(0,v.shouldUseMediaCache)(a)||a!==m.default.PTT&&a!==m.default.AUDIO?n:_.transcode(n)}))}))}var Q=V.then((e=>("text/vcard"===e.type&&C&&(0,p.blobToText)(e).then((e=>{var r=(0,A.parseMultiVcard)(e);r.length>0?t.consolidate({parsedVcards:r}):(__LOG__(4,void 0,new Error,!0)(G()),SEND_LOGS("vcard_over_mms:Failed to parse vcard over mms contents"))})).catch((e=>{__LOG__(4,void 0,new Error,!0)(F(),String(e)),SEND_LOGS("vcard_over_mms:blobToText failed with error: ".concat(String(e)))})),e))).then((e=>(0,v.shouldUseMediaCache)(a)?(h.default.put(K,e),(0,v.gatherAndSetMetadataNoOpaque)(t,e)):T.default.createFromData(e,e.type).then((e=>(0,v.gatherAndSetMetadata)(t,e))))).then((()=>(t.consolidate({downloadStage:g.DOWNLOAD_STAGE.RESOLVED}),t.downloadPromise=null,t.resolveWhenConsolidated()))).catchType(c.MediaNotFoundError,(n=>{if(!q)throw n;if(q.markWhetherOnServer(!1),!r)throw n;return d.default.rmr({mediaObject:t,signal:(new u.default).signal,rmrReason:i,rmrData:s}).then((()=>(t.downloadPromise=null,W({mimetype:e,mediaObject:t,downloadEvenIfExpensive:!1,mediaType:a,rmrReason:i,rmrData:s,downloadOrigin:o,isVcardOverMmsDocument:C,mode:Y}))))})).catchType(f.MediaUnsupportedError,(r=>{if(t.consolidate({downloadStage:g.DOWNLOAD_STAGE.ERROR_UNSUPPORTED}),__LOG__(3)(U(),r.name,r.message,e||""),__LOG__(4,void 0,new Error,!0)(k(),r.message),SEND_LOGS("downloadMedia: media unsupported error:"),E)throw r})).catchType(c.MediaNotOnPhone,(e=>{if(t.consolidate({downloadStage:g.DOWNLOAD_STAGE.ERROR_MISSING}),E)throw e})).catchTypes(x,B,(e=>{if(t.consolidate({downloadStage:g.DOWNLOAD_STAGE.ERROR_MISSING}),__LOG__(3)(L(),e.name),__LOG__(4,void 0,new Error,!0)(N()),SEND_LOGS("unexpected download error: ".concat(e.name)),E)throw e})).catchType(c.MediaDecryptionError,(e=>{if(t.consolidate({downloadStage:g.DOWNLOAD_STAGE.ERROR_MISSING}),E)throw e})).catch((r=>{if(t.consolidate({downloadStage:g.DOWNLOAD_STAGE.NEED_POKE}),r instanceof f.MediaLoadError){if(__LOG__(3)(D(),r.name,r.message,e||""),__LOG__(4,void 0,new Error,!0)(R(),r.message),SEND_LOGS("downloadMedia: media load error:"),E)throw r}else if(r instanceof f.TranscodeBlobTooLargeError){if(__LOG__(3)(I(),r.message,e||""),__LOG__(4,void 0,new Error,!0)(M(),r.message),SEND_LOGS("downloadMedia: transcode blob too large"),E)throw r}else if(r instanceof f.UnableToPlayVideoError){if(__LOG__(3)(w(),r.message,e||""),__LOG__(4,void 0,new Error,!0)(O(),r.message),SEND_LOGS("downloadMedia: unable to play video"),E)throw r}else if(r.name!==l.ABORT_ERROR){if(__LOG__(2)(P()),E)throw r}else if(E)throw r})).finally((()=>{t.downloadPromise=null}));return j.set(Q,(()=>{J.abort()})),t.downloadPromise=Q,Q}))}function V(){return(V=(0,i.default)((function*({mimetype:e,mediaObject:t,mediaType:r}){var{filehash:a}=t;if(a&&t.downloadStage===g.DOWNLOAD_STAGE.INIT&&!(yield q(t))){var n=h.default.get(a),i=new u.default;if(n)t.downloadStage===g.DOWNLOAD_STAGE.INIT&&t.consolidate({downloadStage:g.DOWNLOAD_STAGE.EXISTS});else{var s=t.entries.getDownloadEntry();if(s){var{encFilehash:o}=s;if(!o)return s.markWhetherOnServer(!1),void(t.downloadStage===g.DOWNLOAD_STAGE.INIT&&t.consolidate({downloadStage:g.DOWNLOAD_STAGE.NEED_POKE}));try{yield d.default.checkExistence({directPath:s.directPath,encFilehash:o,signal:i.signal,type:r}),t.downloadStage===g.DOWNLOAD_STAGE.INIT&&t.consolidate({downloadStage:g.DOWNLOAD_STAGE.EXISTS})}catch(e){t.downloadStage===g.DOWNLOAD_STAGE.INIT&&t.consolidate({downloadStage:g.DOWNLOAD_STAGE.NEED_POKE}),__LOG__(2)(C())}}else t.downloadStage===g.DOWNLOAD_STAGE.INIT&&t.consolidate({downloadStage:g.DOWNLOAD_STAGE.NEED_POKE})}}}))).apply(this,arguments)}function H(e){var{scanLengths:t,scansSidecar:r,mimetype:a,mediaObject:n}=e;if(!function(e,t){return!!(e&&t&&e.length>=2&&10*e.length===t.byteLength)}(t,r))return null;var i=new E.default.WebcProgressiveImage({webcFirstRenderScans:0});return{mimetype:a,scansSidecar:(0,S.default)(r,"scansSidecar"),scanLengths:(0,S.default)(t,"scanLengths"),onProgressiveUpdate:e=>{n.downloadStage!==g.DOWNLOAD_STAGE.RESOLVED&&(n.consolidate({downloadStage:g.DOWNLOAD_STAGE.PROGRESSIVE_READY,progressiveStage:e}),i.webcFirstRenderScans||(i.webcFirstRenderScans=e,i.markWebcFirstRenderT()),e>=Y&&!i.webcMidQualityT&&i.markWebcMidQualityT(),e!==K||i.webcFullQualityT||(i.markWebcFullQualityT(),i.commit()))}}}function q(){return z.apply(this,arguments)}function z(){return(z=(0,i.default)((function*(e){return!!e.mediaBlob&&((yield e.mediaBlob.validate())?(e.consolidate({downloadStage:g.DOWNLOAD_STAGE.RESOLVED}),!0):(e.clearBlob(),e.consolidate({downloadStage:g.DOWNLOAD_STAGE.NEED_POKE}),e.notifyMsgsAsync(),!1))}))).apply(this,arguments)}},78460:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.cancelUploadMedia=function(e){var{uploadPromise:t}=e;if(null==t)return;var r=b.get(t);if(null==r)return;b.delete(t),r()},t.uploadMedia=function({mimetype:e,mediaObject:t,mediaType:r,forwardedFromWeb:a,uploadOrigin:n,mediaKeyInfo:i}){if(t.uploadPromise)return t.uploadPromise;var s=new u.default,{signal:g}=s,v=Promise.resolve().then((()=>{t.consolidate({uploadStage:h.UPLOAD_STAGE.UPLOADING})})).then((()=>C({mediaObject:t,mimetype:e,mediaType:r,abortSignal:g,uploadOrigin:n}))).then((e=>{var s=t.entries.getUploadEntry();s&&i&&(0,o.default)(s.mediaKey===i.key,"uploadEntry.mediaKey and mediaKeyInfo.mediaKey should be the same");var u=i?i.key:null==s?void 0:s.mediaKey,l=i?i.timestamp:null==s?void 0:s.mediaKeyTimestamp;return E.default.encryptAndUpload({blob:e,mediaKey:u,mediaKeyTimestamp:l,type:r,signal:g,userUploadAttemptCount:t.userUploadAttemptCount,forwardedFromWeb:a,uploadOrigin:n}).then((({directPath:e,encFilehash:a,mediaKey:n,mediaKeyTimestamp:i,url:s,sidecar:o,firstFrameSidecar:u})=>{var l=t.entries.addEntry({deprecatedMms3Url:s,mediaKey:n,mediaKeyTimestamp:i,encFilehash:a,type:r,sidecar:o,directPath:e,firstFrameSidecar:u,debugHint:"upload"});if(!l)throw new Error("could not create media entry");if((r===_.default.PTT||r===_.default.AUDIO)&&!m.canPlayOgg())if(m.shouldUseMediaCache(r)){var d=t.filehash;if(d&&t.mediaBlob)return p.transcode(t.mediaBlob.formData()).then((e=>{f.default.put(d,e)})).then((()=>l))}else if(t.mediaBlob)return m.gatherAndSetMetadata(t,t.mediaBlob).then((()=>l));return l}))})).then((e=>{if(g.aborted)throw new c.AbortError;return t.consolidate({uploadStage:h.UPLOAD_STAGE.UPLOADED}),__LOG__(2)(T()),{kind:A.SUCCESS,mediaEntry:e}})).catch((e=>{throw e.name===l.ABORT_ERROR?__LOG__(2)(S()):__LOG__(3)(y()),e})).finally((()=>{delete t.uploadPromise})).catchType(d.MediaNotOnPhone,(()=>(t.consolidate({uploadStage:h.UPLOAD_STAGE.ERROR_MISSING}),{kind:A.ERROR}))).catchType(c.MediaTooLargeError,(()=>(t.consolidate({uploadStage:h.UPLOAD_STAGE.ERROR_TOO_LARGE}),{kind:A.ERROR}))).catch((e=>(t.consolidate({uploadStage:h.UPLOAD_STAGE.NEED_UPLOAD}),e.name===l.ABORT_ERROR?{kind:A.CANCELLATION}:{kind:A.ERROR})));return b.set(v,(()=>{s.abort()})),t.uploadPromise=v,v},t.getOrDownloadBlob=C,t.getBlobFromMediaObject=O,t.UploadMediaResultKind=void 0;var i=n(r(52954)),s=n(r(19976)),o=n(r(47677)),u=n(r(12489)),l=r(8701),d=r(50261),c=r(65710),f=n(r(54146)),p=a(r(23765)),h=r(96645),_=n(r(81135)),m=a(r(82982)),g=n(r(40210)),v=r(8401),E=n(r(14258));function y(){var e=(0,s.default)(["MediaAlgo.uploadMedia: error"]);return y=function(){return e},e}function S(){var e=(0,s.default)(["MediaAlgo.uploadMedia: canceled"]);return S=function(){return e},e}function T(){var e=(0,s.default)(["MediaAlgo.uploadMedia: success"]);return T=function(){return e},e}var b=new WeakMap;var A={SUCCESS:"success",CANCELLATION:"cancellation",ERROR:"error"};function C(){return P.apply(this,arguments)}function P(){return(P=(0,i.default)((function*({mediaObject:e,mimetype:t,mediaType:r,abortSignal:a,uploadOrigin:n}){var i=O(e);if(i)return i;if(yield(0,v.downloadMedia)({mimetype:t,mediaObject:e,downloadEvenIfExpensive:!0,mediaType:r,signal:a,rmrReason:g.default.WEBC_RMR_REASON_CODE.UPLOAD,downloadOrigin:n===g.default.UPLOAD_ORIGIN_TYPE.CHAT_PERSONAL?g.default.DOWNLOAD_ORIGIN_TYPE.CHAT_PERSONAL:g.default.DOWNLOAD_ORIGIN_TYPE.CHAT_GROUP,mode:"manual"}),e.downloadStage===h.DOWNLOAD_STAGE.ERROR_MISSING)throw new d.MediaNotOnPhone;var s=O(e);if(s)return s;throw new Error("cant upload media w/out mediaBlob after download")}))).apply(this,arguments)}function O(e){var t=e.mediaBlob;return t?t.formData():e.filehash?f.default.get(e.filehash):void 0}t.UploadMediaResultKind=A},73698:(e,t,r)=>{"use strict";var a=r(14859),n=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var r=Promise.resolve().then((()=>{var r,a,n=e.size(),c=t.asDocument?s.FILETYPE.DOCUMENT:(0,s.typeFromMimetype)(e.type()),f=null!==(r=t.isVcardOverMmsDocument)&&void 0!==r&&r;if(n>function(e,t){if(e===s.FILETYPE.DOCUMENT)return t?1024*d.default.vcardMaxSizeKb:d.default.maxFileSize;return d.default.media}(c,f))return Promise.reject(new o.default(e));if(n<=0)return Promise.reject(new i.MediaFileEmpty);switch(null!=t.gifAttribution?a=t.gifAttribution:t.asGif&&(a=0),c){case"image":return l.processRawImage(e).then((({blob:e,width:t,height:r,preview:a})=>({type:u.OUTWARD_TYPES.IMAGE,mediaBlob:e,mimetype:"image/jpeg",fullWidth:t,fullHeight:r,preview:a})));case"video":case"audio":return l.processRawAudioVideo(e,!!t.isPtt,t.precomputedFields,t.asGif,a,e.type());case"document":return l.processRawDocument(e,t.filename,f,t.documentPageCount);default:throw new Error("Received unsupported mediaType: "+c)}}));return e.retain(),e.autoreleaseWhenPromiseCompletes(r),r};var i=n(r(96452)),s=r(99888),o=a(r(97626)),u=r(96645),l=n(r(82982)),d=a(r(72424))},32724:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.RequestMediaReuploadManager=void 0;var n=a(r(19976)),i=a(r(52954)),s=a(r(61941)),o=a(r(48276));function u(){var e=(0,n.default)(["resolveMediaReupload: msgId (",") is not found in _rmrRequests"]);return u=function(){return e},e}class l{constructor(){var e=this;this._rmrRequests=new Map,this.requestMediaReupload=function(){var t=(0,i.default)((function*(t){var r=t.id.id,a=e._rmrRequests.get(r);if(a)return(0,s.default)(a.request,"existingRequest.request");var n=new Promise(((a,n)=>{e._rmrRequests.set(r,{resolve:a,reject:n,msg:t})}));return(0,s.default)(e._rmrRequests.get(r),"_this._rmrRequests.get(msgId)").request=n,yield(0,o.default)(t),n}));return function(){return t.apply(this,arguments)}}(),this.resolveMediaReupload=({msgId:e,result:t,directPath:r})=>{var a=this._rmrRequests.get(e);null!=a?(a.resolve({result:t,directPath:r}),this._rmrRequests.delete(e)):__LOG__(3)(u(),e)},this.getMediaKey=e=>{var t;return null===(t=this._rmrRequests.get(e))||void 0===t?void 0:t.msg.mediaKey}}}t.RequestMediaReuploadManager=l;var d=new l;t.default=d},27674:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return n.default.globalUnixTime()-e<i.default.mmsMediaKeyTTL+Math.floor(86400*Math.random())};var n=a(r(19899)),i=a(r(72424))},43919:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ADVSignedDeviceIdentityHMACSpec=t.ADVSignedDeviceIdentitySpec=t.ADVDeviceIdentitySpec=t.ADVSignedKeyIndexListSpec=t.ADVKeyIndexListSpec=void 0;var a=r(45261),n={};t.ADVKeyIndexListSpec=n;var i={};t.ADVSignedKeyIndexListSpec=i;var s={};t.ADVDeviceIdentitySpec=s;var o={};t.ADVSignedDeviceIdentitySpec=o;var u={};t.ADVSignedDeviceIdentityHMACSpec=u,n.internalSpec={rawId:[1,a.TYPES.UINT32],timestamp:[2,a.TYPES.UINT64],currentIndex:[3,a.TYPES.UINT32],validIndexes:[4,a.FLAGS.REPEATED|a.FLAGS.PACKED|a.TYPES.UINT32]},i.internalSpec={details:[1,a.TYPES.BYTES],accountSignature:[2,a.TYPES.BYTES]},s.internalSpec={rawId:[1,a.TYPES.UINT32],timestamp:[2,a.TYPES.UINT64],keyIndex:[3,a.TYPES.UINT32]},o.internalSpec={details:[1,a.TYPES.BYTES],accountSignatureKey:[2,a.TYPES.BYTES],accountSignature:[3,a.TYPES.BYTES],deviceSignature:[4,a.TYPES.BYTES]},u.internalSpec={details:[1,a.TYPES.BYTES],hmac:[2,a.TYPES.BYTES]}},65512:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AppVersionSpec=t.CompanionPropsSpec=t.CompanionPropsPlatformType=void 0;var a=r(45261),n=r(28103)({UNKNOWN:0,CHROME:1,FIREFOX:2,IE:3,OPERA:4,SAFARI:5,EDGE:6,DESKTOP:7,IPAD:8,ANDROID_TABLET:9,OHANA:10,ALOHA:11,CATALINA:12});t.CompanionPropsPlatformType=n;var i={};t.CompanionPropsSpec=i;var s={};t.AppVersionSpec=s,i.internalSpec={os:[1,a.TYPES.STRING],version:[2,a.TYPES.MESSAGE,s],platformType:[3,a.TYPES.ENUM,n],requireFullSync:[4,a.TYPES.BOOL]},s.internalSpec={primary:[1,a.TYPES.UINT32],secondary:[2,a.TYPES.UINT32],tertiary:[3,a.TYPES.UINT32],quaternary:[4,a.TYPES.UINT32],quinary:[5,a.TYPES.UINT32]}},28703:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MoneySpec=t.HydratedQuickReplyButtonSpec=t.HydratedURLButtonSpec=t.HydratedCallButtonSpec=t.HydratedTemplateButtonSpec=t.QuickReplyButtonSpec=t.URLButtonSpec=t.CallButtonSpec=t.TemplateButtonSpec=t.LocationSpec=t.PointSpec=t.InteractiveAnnotationSpec=t.DeviceListMetadataSpec=t.MessageContextInfoSpec=t.AdReplyInfoSpec=t.ExternalAdReplyInfoSpec=t.ContextInfoSpec=t.SenderKeyDistributionMessageSpec=t.ImageMessageSpec=t.InvoiceMessageSpec=t.ContactMessageSpec=t.LocationMessageSpec=t.ExtendedTextMessageSpec=t.DocumentMessageSpec=t.AudioMessageSpec=t.VideoMessageSpec=t.CallSpec=t.ChatSpec=t.ProtocolMessageSpec=t.HistorySyncNotificationSpec=t.AppStateSyncKeySpec=t.AppStateSyncKeyIdSpec=t.AppStateSyncKeyFingerprintSpec=t.AppStateSyncKeyDataSpec=t.AppStateSyncKeyShareSpec=t.AppStateSyncKeyRequestSpec=t.AppStateFatalExceptionNotificationSpec=t.InitialSecurityNotificationSettingSyncSpec=t.ContactsArrayMessageSpec=t.HSMCurrencySpec=t.HSMDateTimeComponentSpec=t.HSMDateTimeUnixEpochSpec=t.HSMDateTimeSpec=t.HSMLocalizableParameterSpec=t.HighlyStructuredMessageSpec=t.SendPaymentMessageSpec=t.RequestPaymentMessageSpec=t.DeclinePaymentRequestMessageSpec=t.CancelPaymentRequestMessageSpec=t.PaymentInviteMessageSpec=t.LiveLocationMessageSpec=t.StickerMessageSpec=t.FourRowTemplateSpec=t.HydratedFourRowTemplateSpec=t.TemplateMessageSpec=t.TemplateButtonReplyMessageSpec=t.CatalogSnapshotSpec=t.ProductSnapshotSpec=t.ProductMessageSpec=t.OrderMessageSpec=t.RowSpec=t.SectionSpec=t.ProductSpec=t.ProductSectionSpec=t.ProductListHeaderImageSpec=t.ProductListInfoSpec=t.ListMessageSpec=t.SingleSelectReplySpec=t.ListResponseMessageSpec=t.GroupInviteMessageSpec=t.DeviceSentMessageSpec=t.FutureProofMessageSpec=t.ButtonTextSpec=t.NativeFlowInfoSpec=t.ButtonSpec=t.ButtonsMessageSpec=t.ButtonsResponseMessageSpec=t.MessageSpec=t.AdReplyInfoMediaType=t.ExternalAdReplyInfoMediaType=t.InvoiceMessageAttachmentType=t.ExtendedTextMessageFontType=t.ExtendedTextMessagePreviewType=t.VideoMessageAttribution=t.ProtocolMessageType=t.HistorySyncNotificationHistorySyncType=t.HSMDateTimeComponentDayOfWeekType=t.HSMDateTimeComponentCalendarType=t.PaymentInviteMessageServiceType=t.OrderMessageOrderStatus=t.OrderMessageOrderSurface=t.ListMessageListType=t.ListResponseMessageListType=t.ButtonsMessageHeaderType=t.ButtonType=t.ButtonsResponseMessageType=void 0;var a=r(76483),n=r(45261),i=r(28103)({UNKNOWN:0,DISPLAY_TEXT:1});t.ButtonsResponseMessageType=i;var s=r(28103)({UNKNOWN:0,RESPONSE:1,NATIVE_FLOW:2});t.ButtonType=s;var o=r(28103)({UNKNOWN:0,EMPTY:1,TEXT:2,DOCUMENT:3,IMAGE:4,VIDEO:5,LOCATION:6});t.ButtonsMessageHeaderType=o;var u=r(28103)({UNKNOWN:0,SINGLE_SELECT:1});t.ListResponseMessageListType=u;var l=r(28103)({UNKNOWN:0,SINGLE_SELECT:1,PRODUCT_LIST:2});t.ListMessageListType=l;var d=r(28103)({CATALOG:1});t.OrderMessageOrderSurface=d;var c=r(28103)({INQUIRY:1});t.OrderMessageOrderStatus=c;var f=r(28103)({UNKNOWN:0,FBPAY:1,NOVI:2,UPI:3});t.PaymentInviteMessageServiceType=f;var p=r(28103)({GREGORIAN:1,SOLAR_HIJRI:2});t.HSMDateTimeComponentCalendarType=p;var h=r(28103)({MONDAY:1,TUESDAY:2,WEDNESDAY:3,THURSDAY:4,FRIDAY:5,SATURDAY:6,SUNDAY:7});t.HSMDateTimeComponentDayOfWeekType=h;var _=r(28103)({INITIAL_BOOTSTRAP:0,INITIAL_STATUS_V3:1,FULL:2,RECENT:3,PUSH_NAME:4});t.HistorySyncNotificationHistorySyncType=_;var m=r(28103)({REVOKE:0,EPHEMERAL_SETTING:3,EPHEMERAL_SYNC_RESPONSE:4,HISTORY_SYNC_NOTIFICATION:5,APP_STATE_SYNC_KEY_SHARE:6,APP_STATE_SYNC_KEY_REQUEST:7,MSG_FANOUT_BACKFILL_REQUEST:8,INITIAL_SECURITY_NOTIFICATION_SETTING_SYNC:9,APP_STATE_FATAL_EXCEPTION_NOTIFICATION:10});t.ProtocolMessageType=m;var g=r(28103)({NONE:0,GIPHY:1,TENOR:2});t.VideoMessageAttribution=g;var v=r(28103)({NONE:0,VIDEO:1});t.ExtendedTextMessagePreviewType=v;var E=r(28103)({SANS_SERIF:0,SERIF:1,NORICAN_REGULAR:2,BRYNDAN_WRITE:3,BEBASNEUE_REGULAR:4,OSWALD_HEAVY:5});t.ExtendedTextMessageFontType=E;var y=r(28103)({IMAGE:0,PDF:1});t.InvoiceMessageAttachmentType=y;var S=r(28103)({NONE:0,IMAGE:1,VIDEO:2});t.ExternalAdReplyInfoMediaType=S;var T=r(28103)({NONE:0,IMAGE:1,VIDEO:2});t.AdReplyInfoMediaType=T;var b={};t.MessageSpec=b;var A={};t.ButtonsResponseMessageSpec=A;var C={};t.ButtonsMessageSpec=C;var P={};t.ButtonSpec=P;var O={};t.NativeFlowInfoSpec=O;var w={};t.ButtonTextSpec=w;var M={};t.FutureProofMessageSpec=M;var I={};t.DeviceSentMessageSpec=I;var R={};t.GroupInviteMessageSpec=R;var D={};t.ListResponseMessageSpec=D;var N={};t.SingleSelectReplySpec=N;var L={};t.ListMessageSpec=L;var k={};t.ProductListInfoSpec=k;var U={};t.ProductListHeaderImageSpec=U;var F={};t.ProductSectionSpec=F;var G={};t.ProductSpec=G;var x={};t.SectionSpec=x;var B={};t.RowSpec=B;var Y={};t.OrderMessageSpec=Y;var K={};t.ProductMessageSpec=K;var j={};t.ProductSnapshotSpec=j;var W={};t.CatalogSnapshotSpec=W;var V={};t.TemplateButtonReplyMessageSpec=V;var H={};t.TemplateMessageSpec=H;var q={};t.HydratedFourRowTemplateSpec=q;var z={};t.FourRowTemplateSpec=z;var J={};t.StickerMessageSpec=J;var Q={};t.LiveLocationMessageSpec=Q;var X={};t.PaymentInviteMessageSpec=X;var Z={};t.CancelPaymentRequestMessageSpec=Z;var $={};t.DeclinePaymentRequestMessageSpec=$;var ee={};t.RequestPaymentMessageSpec=ee;var te={};t.SendPaymentMessageSpec=te;var re={};t.HighlyStructuredMessageSpec=re;var ae={};t.HSMLocalizableParameterSpec=ae;var ne={};t.HSMDateTimeSpec=ne;var ie={};t.HSMDateTimeUnixEpochSpec=ie;var se={};t.HSMDateTimeComponentSpec=se;var oe={};t.HSMCurrencySpec=oe;var ue={};t.ContactsArrayMessageSpec=ue;var le={};t.InitialSecurityNotificationSettingSyncSpec=le;var de={};t.AppStateFatalExceptionNotificationSpec=de;var ce={};t.AppStateSyncKeyRequestSpec=ce;var fe={};t.AppStateSyncKeyShareSpec=fe;var pe={};t.AppStateSyncKeyDataSpec=pe;var he={};t.AppStateSyncKeyFingerprintSpec=he;var _e={};t.AppStateSyncKeyIdSpec=_e;var me={};t.AppStateSyncKeySpec=me;var ge={};t.HistorySyncNotificationSpec=ge;var ve={};t.ProtocolMessageSpec=ve;var Ee={};t.ChatSpec=Ee;var ye={};t.CallSpec=ye;var Se={};t.VideoMessageSpec=Se;var Te={};t.AudioMessageSpec=Te;var be={};t.DocumentMessageSpec=be;var Ae={};t.ExtendedTextMessageSpec=Ae;var Ce={};t.LocationMessageSpec=Ce;var Pe={};t.ContactMessageSpec=Pe;var Oe={};t.InvoiceMessageSpec=Oe;var we={};t.ImageMessageSpec=we;var Me={};t.SenderKeyDistributionMessageSpec=Me;var Ie={};t.ContextInfoSpec=Ie;var Re={};t.ExternalAdReplyInfoSpec=Re;var De={};t.AdReplyInfoSpec=De;var Ne={};t.MessageContextInfoSpec=Ne;var Le={};t.DeviceListMetadataSpec=Le;var ke={};t.InteractiveAnnotationSpec=ke;var Ue={};t.PointSpec=Ue;var Fe={};t.LocationSpec=Fe;var Ge={};t.TemplateButtonSpec=Ge;var xe={};t.CallButtonSpec=xe;var Be={};t.URLButtonSpec=Be;var Ye={};t.QuickReplyButtonSpec=Ye;var Ke={};t.HydratedTemplateButtonSpec=Ke;var je={};t.HydratedCallButtonSpec=je;var We={};t.HydratedURLButtonSpec=We;var Ve={};t.HydratedQuickReplyButtonSpec=Ve;var He={};t.MoneySpec=He,b.internalSpec={conversation:[1,n.TYPES.STRING],senderKeyDistributionMessage:[2,n.TYPES.MESSAGE,Me],imageMessage:[3,n.TYPES.MESSAGE,we],contactMessage:[4,n.TYPES.MESSAGE,Pe],locationMessage:[5,n.TYPES.MESSAGE,Ce],extendedTextMessage:[6,n.TYPES.MESSAGE,Ae],documentMessage:[7,n.TYPES.MESSAGE,be],audioMessage:[8,n.TYPES.MESSAGE,Te],videoMessage:[9,n.TYPES.MESSAGE,Se],call:[10,n.TYPES.MESSAGE,ye],chat:[11,n.TYPES.MESSAGE,Ee],protocolMessage:[12,n.TYPES.MESSAGE,ve],contactsArrayMessage:[13,n.TYPES.MESSAGE,ue],highlyStructuredMessage:[14,n.TYPES.MESSAGE,re],fastRatchetKeySenderKeyDistributionMessage:[15,n.TYPES.MESSAGE,Me],sendPaymentMessage:[16,n.TYPES.MESSAGE,te],liveLocationMessage:[18,n.TYPES.MESSAGE,Q],requestPaymentMessage:[22,n.TYPES.MESSAGE,ee],declinePaymentRequestMessage:[23,n.TYPES.MESSAGE,$],cancelPaymentRequestMessage:[24,n.TYPES.MESSAGE,Z],templateMessage:[25,n.TYPES.MESSAGE,H],stickerMessage:[26,n.TYPES.MESSAGE,J],groupInviteMessage:[28,n.TYPES.MESSAGE,R],templateButtonReplyMessage:[29,n.TYPES.MESSAGE,V],productMessage:[30,n.TYPES.MESSAGE,K],deviceSentMessage:[31,n.TYPES.MESSAGE,I],messageContextInfo:[35,n.TYPES.MESSAGE,Ne],listMessage:[36,n.TYPES.MESSAGE,L],viewOnceMessage:[37,n.TYPES.MESSAGE,M],orderMessage:[38,n.TYPES.MESSAGE,Y],listResponseMessage:[39,n.TYPES.MESSAGE,D],ephemeralMessage:[40,n.TYPES.MESSAGE,M],invoiceMessage:[41,n.TYPES.MESSAGE,Oe],buttonsMessage:[42,n.TYPES.MESSAGE,C],buttonsResponseMessage:[43,n.TYPES.MESSAGE,A],paymentInviteMessage:[44,n.TYPES.MESSAGE,X]},A.internalSpec={selectedButtonId:[1,n.TYPES.STRING],selectedDisplayText:[2,n.TYPES.STRING],contextInfo:[3,n.TYPES.MESSAGE,Ie],type:[4,n.TYPES.ENUM,i],__oneofs__:{response:["selectedDisplayText"]}},C.internalSpec={text:[1,n.TYPES.STRING],documentMessage:[2,n.TYPES.MESSAGE,be],imageMessage:[3,n.TYPES.MESSAGE,we],videoMessage:[4,n.TYPES.MESSAGE,Se],locationMessage:[5,n.TYPES.MESSAGE,Ce],contentText:[6,n.TYPES.STRING],footerText:[7,n.TYPES.STRING],contextInfo:[8,n.TYPES.MESSAGE,Ie],buttons:[9,n.FLAGS.REPEATED|n.TYPES.MESSAGE,P],headerType:[10,n.TYPES.ENUM,o],__oneofs__:{header:["text","documentMessage","imageMessage","videoMessage","locationMessage"]}},P.internalSpec={buttonId:[1,n.TYPES.STRING],buttonText:[2,n.TYPES.MESSAGE,w],type:[3,n.TYPES.ENUM,s],nativeFlowInfo:[4,n.TYPES.MESSAGE,O]},O.internalSpec={name:[1,n.TYPES.STRING],paramsJson:[2,n.TYPES.STRING]},w.internalSpec={displayText:[1,n.TYPES.STRING]},M.internalSpec={message:[1,n.TYPES.MESSAGE,b]},I.internalSpec={destinationJid:[1,n.TYPES.STRING],message:[2,n.TYPES.MESSAGE,b],phash:[3,n.TYPES.STRING]},R.internalSpec={groupJid:[1,n.TYPES.STRING],inviteCode:[2,n.TYPES.STRING],inviteExpiration:[3,n.TYPES.INT64],groupName:[4,n.TYPES.STRING],jpegThumbnail:[5,n.TYPES.BYTES],caption:[6,n.TYPES.STRING],contextInfo:[7,n.TYPES.MESSAGE,Ie]},D.internalSpec={title:[1,n.TYPES.STRING],listType:[2,n.TYPES.ENUM,u],singleSelectReply:[3,n.TYPES.MESSAGE,N],contextInfo:[4,n.TYPES.MESSAGE,Ie],description:[5,n.TYPES.STRING]},N.internalSpec={selectedRowId:[1,n.TYPES.STRING]},L.internalSpec={title:[1,n.TYPES.STRING],description:[2,n.TYPES.STRING],buttonText:[3,n.TYPES.STRING],listType:[4,n.TYPES.ENUM,l],sections:[5,n.FLAGS.REPEATED|n.TYPES.MESSAGE,x],productListInfo:[6,n.TYPES.MESSAGE,k],footerText:[7,n.TYPES.STRING],contextInfo:[8,n.TYPES.MESSAGE,Ie]},k.internalSpec={productSections:[1,n.FLAGS.REPEATED|n.TYPES.MESSAGE,F],headerImage:[2,n.TYPES.MESSAGE,U],businessOwnerJid:[3,n.TYPES.STRING]},U.internalSpec={productId:[1,n.TYPES.STRING],jpegThumbnail:[2,n.TYPES.BYTES]},F.internalSpec={title:[1,n.TYPES.STRING],products:[2,n.FLAGS.REPEATED|n.TYPES.MESSAGE,G]},G.internalSpec={productId:[1,n.TYPES.STRING]},x.internalSpec={title:[1,n.TYPES.STRING],rows:[2,n.FLAGS.REPEATED|n.TYPES.MESSAGE,B]},B.internalSpec={title:[1,n.TYPES.STRING],description:[2,n.TYPES.STRING],rowId:[3,n.TYPES.STRING]},Y.internalSpec={orderId:[1,n.TYPES.STRING],thumbnail:[2,n.TYPES.BYTES],itemCount:[3,n.TYPES.INT32],status:[4,n.TYPES.ENUM,c],surface:[5,n.TYPES.ENUM,d],message:[6,n.TYPES.STRING],orderTitle:[7,n.TYPES.STRING],sellerJid:[8,n.TYPES.STRING],token:[9,n.TYPES.STRING],totalAmount1000:[10,n.TYPES.INT64],totalCurrencyCode:[11,n.TYPES.STRING],contextInfo:[17,n.TYPES.MESSAGE,Ie]},K.internalSpec={product:[1,n.TYPES.MESSAGE,j],businessOwnerJid:[2,n.TYPES.STRING],catalog:[4,n.TYPES.MESSAGE,W],contextInfo:[17,n.TYPES.MESSAGE,Ie]},j.internalSpec={productImage:[1,n.TYPES.MESSAGE,we],productId:[2,n.TYPES.STRING],title:[3,n.TYPES.STRING],description:[4,n.TYPES.STRING],currencyCode:[5,n.TYPES.STRING],priceAmount1000:[6,n.TYPES.INT64],retailerId:[7,n.TYPES.STRING],url:[8,n.TYPES.STRING],productImageCount:[9,n.TYPES.UINT32],firstImageId:[11,n.TYPES.STRING],salePriceAmount1000:[12,n.TYPES.INT64]},W.internalSpec={catalogImage:[1,n.TYPES.MESSAGE,we],title:[2,n.TYPES.STRING],description:[3,n.TYPES.STRING]},V.internalSpec={selectedId:[1,n.TYPES.STRING],selectedDisplayText:[2,n.TYPES.STRING],contextInfo:[3,n.TYPES.MESSAGE,Ie],selectedIndex:[4,n.TYPES.UINT32]},H.internalSpec={fourRowTemplate:[1,n.TYPES.MESSAGE,z],hydratedFourRowTemplate:[2,n.TYPES.MESSAGE,q],contextInfo:[3,n.TYPES.MESSAGE,Ie],hydratedTemplate:[4,n.TYPES.MESSAGE,q],__oneofs__:{format:["fourRowTemplate","hydratedFourRowTemplate"]}},q.internalSpec={documentMessage:[1,n.TYPES.MESSAGE,be],hydratedTitleText:[2,n.TYPES.STRING],imageMessage:[3,n.TYPES.MESSAGE,we],videoMessage:[4,n.TYPES.MESSAGE,Se],locationMessage:[5,n.TYPES.MESSAGE,Ce],hydratedContentText:[6,n.TYPES.STRING],hydratedFooterText:[7,n.TYPES.STRING],hydratedButtons:[8,n.FLAGS.REPEATED|n.TYPES.MESSAGE,Ke],templateId:[9,n.TYPES.STRING],__oneofs__:{title:["documentMessage","hydratedTitleText","imageMessage","videoMessage","locationMessage"]}},z.internalSpec={documentMessage:[1,n.TYPES.MESSAGE,be],highlyStructuredMessage:[2,n.TYPES.MESSAGE,re],imageMessage:[3,n.TYPES.MESSAGE,we],videoMessage:[4,n.TYPES.MESSAGE,Se],locationMessage:[5,n.TYPES.MESSAGE,Ce],content:[6,n.TYPES.MESSAGE,re],footer:[7,n.TYPES.MESSAGE,re],buttons:[8,n.FLAGS.REPEATED|n.TYPES.MESSAGE,Ge],__oneofs__:{title:["documentMessage","highlyStructuredMessage","imageMessage","videoMessage","locationMessage"]}},J.internalSpec={url:[1,n.TYPES.STRING],fileSha256:[2,n.TYPES.BYTES],fileEncSha256:[3,n.TYPES.BYTES],mediaKey:[4,n.TYPES.BYTES],mimetype:[5,n.TYPES.STRING],height:[6,n.TYPES.UINT32],width:[7,n.TYPES.UINT32],directPath:[8,n.TYPES.STRING],fileLength:[9,n.TYPES.UINT64],mediaKeyTimestamp:[10,n.TYPES.INT64],firstFrameLength:[11,n.TYPES.UINT32],firstFrameSidecar:[12,n.TYPES.BYTES],isAnimated:[13,n.TYPES.BOOL],pngThumbnail:[16,n.TYPES.BYTES],contextInfo:[17,n.TYPES.MESSAGE,Ie]},Q.internalSpec={degreesLatitude:[1,n.TYPES.DOUBLE],degreesLongitude:[2,n.TYPES.DOUBLE],accuracyInMeters:[3,n.TYPES.UINT32],speedInMps:[4,n.TYPES.FLOAT],degreesClockwiseFromMagneticNorth:[5,n.TYPES.UINT32],caption:[6,n.TYPES.STRING],sequenceNumber:[7,n.TYPES.INT64],timeOffset:[8,n.TYPES.UINT32],jpegThumbnail:[16,n.TYPES.BYTES],contextInfo:[17,n.TYPES.MESSAGE,Ie]},X.internalSpec={serviceType:[1,n.TYPES.ENUM,f],expiryTimestamp:[2,n.TYPES.INT64]},Z.internalSpec={key:[1,n.TYPES.MESSAGE,a.MessageKeySpec]},$.internalSpec={key:[1,n.TYPES.MESSAGE,a.MessageKeySpec]},ee.internalSpec={noteMessage:[4,n.TYPES.MESSAGE,b],currencyCodeIso4217:[1,n.TYPES.STRING],amount1000:[2,n.TYPES.UINT64],requestFrom:[3,n.TYPES.STRING],expiryTimestamp:[5,n.TYPES.INT64],amount:[6,n.TYPES.MESSAGE,He]},te.internalSpec={noteMessage:[2,n.TYPES.MESSAGE,b],requestMessageKey:[3,n.TYPES.MESSAGE,a.MessageKeySpec]},re.internalSpec={namespace:[1,n.TYPES.STRING],elementName:[2,n.TYPES.STRING],params:[3,n.FLAGS.REPEATED|n.TYPES.STRING],fallbackLg:[4,n.TYPES.STRING],fallbackLc:[5,n.TYPES.STRING],localizableParams:[6,n.FLAGS.REPEATED|n.TYPES.MESSAGE,ae],deterministicLg:[7,n.TYPES.STRING],deterministicLc:[8,n.TYPES.STRING],hydratedHsm:[9,n.TYPES.MESSAGE,H]},ae.internalSpec={default:[1,n.TYPES.STRING],currency:[2,n.TYPES.MESSAGE,oe],dateTime:[3,n.TYPES.MESSAGE,ne],__oneofs__:{paramOneof:["currency","dateTime"]}},ne.internalSpec={component:[1,n.TYPES.MESSAGE,se],unixEpoch:[2,n.TYPES.MESSAGE,ie],__oneofs__:{datetimeOneof:["component","unixEpoch"]}},ie.internalSpec={timestamp:[1,n.TYPES.INT64]},se.internalSpec={dayOfWeek:[1,n.TYPES.ENUM,h],year:[2,n.TYPES.UINT32],month:[3,n.TYPES.UINT32],dayOfMonth:[4,n.TYPES.UINT32],hour:[5,n.TYPES.UINT32],minute:[6,n.TYPES.UINT32],calendar:[7,n.TYPES.ENUM,p]},oe.internalSpec={currencyCode:[1,n.TYPES.STRING],amount1000:[2,n.TYPES.INT64]},ue.internalSpec={displayName:[1,n.TYPES.STRING],contacts:[2,n.FLAGS.REPEATED|n.TYPES.MESSAGE,Pe],contextInfo:[17,n.TYPES.MESSAGE,Ie]},le.internalSpec={securityNotificationEnabled:[1,n.TYPES.BOOL]},de.internalSpec={collectionNames:[1,n.FLAGS.REPEATED|n.TYPES.STRING],timestamp:[2,n.TYPES.INT64]},ce.internalSpec={keyIds:[1,n.FLAGS.REPEATED|n.TYPES.MESSAGE,_e]},fe.internalSpec={keys:[1,n.FLAGS.REPEATED|n.TYPES.MESSAGE,me]},pe.internalSpec={keyData:[1,n.TYPES.BYTES],fingerprint:[2,n.TYPES.MESSAGE,he],timestamp:[3,n.TYPES.INT64]},he.internalSpec={rawId:[1,n.TYPES.UINT32],currentIndex:[2,n.TYPES.UINT32],deviceIndexes:[3,n.FLAGS.REPEATED|n.FLAGS.PACKED|n.TYPES.UINT32]},_e.internalSpec={keyId:[1,n.TYPES.BYTES]},me.internalSpec={keyId:[1,n.TYPES.MESSAGE,_e],keyData:[2,n.TYPES.MESSAGE,pe]},ge.internalSpec={fileSha256:[1,n.TYPES.BYTES],fileLength:[2,n.TYPES.UINT64],mediaKey:[3,n.TYPES.BYTES],fileEncSha256:[4,n.TYPES.BYTES],directPath:[5,n.TYPES.STRING],syncType:[6,n.TYPES.ENUM,_],chunkOrder:[7,n.TYPES.UINT32],originalMessageId:[8,n.TYPES.STRING]},ve.internalSpec={key:[1,n.TYPES.MESSAGE,a.MessageKeySpec],type:[2,n.TYPES.ENUM,m],ephemeralExpiration:[4,n.TYPES.UINT32],ephemeralSettingTimestamp:[5,n.TYPES.INT64],historySyncNotification:[6,n.TYPES.MESSAGE,ge],appStateSyncKeyShare:[7,n.TYPES.MESSAGE,fe],appStateSyncKeyRequest:[8,n.TYPES.MESSAGE,ce],initialSecurityNotificationSettingSync:[9,n.TYPES.MESSAGE,le],appStateFatalExceptionNotification:[10,n.TYPES.MESSAGE,de]},Ee.internalSpec={displayName:[1,n.TYPES.STRING],id:[2,n.TYPES.STRING]},ye.internalSpec={callKey:[1,n.TYPES.BYTES]},Se.internalSpec={url:[1,n.TYPES.STRING],mimetype:[2,n.TYPES.STRING],fileSha256:[3,n.TYPES.BYTES],fileLength:[4,n.TYPES.UINT64],seconds:[5,n.TYPES.UINT32],mediaKey:[6,n.TYPES.BYTES],caption:[7,n.TYPES.STRING],gifPlayback:[8,n.TYPES.BOOL],height:[9,n.TYPES.UINT32],width:[10,n.TYPES.UINT32],fileEncSha256:[11,n.TYPES.BYTES],interactiveAnnotations:[12,n.FLAGS.REPEATED|n.TYPES.MESSAGE,ke],directPath:[13,n.TYPES.STRING],mediaKeyTimestamp:[14,n.TYPES.INT64],jpegThumbnail:[16,n.TYPES.BYTES],contextInfo:[17,n.TYPES.MESSAGE,Ie],streamingSidecar:[18,n.TYPES.BYTES],gifAttribution:[19,n.TYPES.ENUM,g],viewOnce:[20,n.TYPES.BOOL],thumbnailDirectPath:[21,n.TYPES.STRING],thumbnailSha256:[22,n.TYPES.BYTES],thumbnailEncSha256:[23,n.TYPES.BYTES]},Te.internalSpec={url:[1,n.TYPES.STRING],mimetype:[2,n.TYPES.STRING],fileSha256:[3,n.TYPES.BYTES],fileLength:[4,n.TYPES.UINT64],seconds:[5,n.TYPES.UINT32],ptt:[6,n.TYPES.BOOL],mediaKey:[7,n.TYPES.BYTES],fileEncSha256:[8,n.TYPES.BYTES],directPath:[9,n.TYPES.STRING],mediaKeyTimestamp:[10,n.TYPES.INT64],contextInfo:[17,n.TYPES.MESSAGE,Ie],streamingSidecar:[18,n.TYPES.BYTES]},be.internalSpec={url:[1,n.TYPES.STRING],mimetype:[2,n.TYPES.STRING],title:[3,n.TYPES.STRING],fileSha256:[4,n.TYPES.BYTES],fileLength:[5,n.TYPES.UINT64],pageCount:[6,n.TYPES.UINT32],mediaKey:[7,n.TYPES.BYTES],fileName:[8,n.TYPES.STRING],fileEncSha256:[9,n.TYPES.BYTES],directPath:[10,n.TYPES.STRING],mediaKeyTimestamp:[11,n.TYPES.INT64],contactVcard:[12,n.TYPES.BOOL],thumbnailDirectPath:[13,n.TYPES.STRING],thumbnailSha256:[14,n.TYPES.BYTES],thumbnailEncSha256:[15,n.TYPES.BYTES],jpegThumbnail:[16,n.TYPES.BYTES],contextInfo:[17,n.TYPES.MESSAGE,Ie],thumbnailHeight:[18,n.TYPES.UINT32],thumbnailWidth:[19,n.TYPES.UINT32]},Ae.internalSpec={text:[1,n.TYPES.STRING],matchedText:[2,n.TYPES.STRING],canonicalUrl:[4,n.TYPES.STRING],description:[5,n.TYPES.STRING],title:[6,n.TYPES.STRING],textArgb:[7,n.TYPES.FIXED32],backgroundArgb:[8,n.TYPES.FIXED32],font:[9,n.TYPES.ENUM,E],previewType:[10,n.TYPES.ENUM,v],jpegThumbnail:[16,n.TYPES.BYTES],contextInfo:[17,n.TYPES.MESSAGE,Ie],doNotPlayInline:[18,n.TYPES.BOOL]},Ce.internalSpec={degreesLatitude:[1,n.TYPES.DOUBLE],degreesLongitude:[2,n.TYPES.DOUBLE],name:[3,n.TYPES.STRING],address:[4,n.TYPES.STRING],url:[5,n.TYPES.STRING],isLive:[6,n.TYPES.BOOL],accuracyInMeters:[7,n.TYPES.UINT32],speedInMps:[8,n.TYPES.FLOAT],degreesClockwiseFromMagneticNorth:[9,n.TYPES.UINT32],comment:[11,n.TYPES.STRING],jpegThumbnail:[16,n.TYPES.BYTES],contextInfo:[17,n.TYPES.MESSAGE,Ie]},Pe.internalSpec={displayName:[1,n.TYPES.STRING],vcard:[16,n.TYPES.STRING],contextInfo:[17,n.TYPES.MESSAGE,Ie]},Oe.internalSpec={note:[1,n.TYPES.STRING],token:[2,n.TYPES.STRING],attachmentType:[3,n.TYPES.ENUM,y],attachmentMimetype:[4,n.TYPES.STRING],attachmentMediaKey:[5,n.TYPES.BYTES],attachmentMediaKeyTimestamp:[6,n.TYPES.INT64],attachmentFileSha256:[7,n.TYPES.BYTES],attachmentFileEncSha256:[8,n.TYPES.BYTES],attachmentDirectPath:[9,n.TYPES.STRING],attachmentJpegThumbnail:[10,n.TYPES.BYTES]},we.internalSpec={url:[1,n.TYPES.STRING],mimetype:[2,n.TYPES.STRING],caption:[3,n.TYPES.STRING],fileSha256:[4,n.TYPES.BYTES],fileLength:[5,n.TYPES.UINT64],height:[6,n.TYPES.UINT32],width:[7,n.TYPES.UINT32],mediaKey:[8,n.TYPES.BYTES],fileEncSha256:[9,n.TYPES.BYTES],interactiveAnnotations:[10,n.FLAGS.REPEATED|n.TYPES.MESSAGE,ke],directPath:[11,n.TYPES.STRING],mediaKeyTimestamp:[12,n.TYPES.INT64],jpegThumbnail:[16,n.TYPES.BYTES],contextInfo:[17,n.TYPES.MESSAGE,Ie],firstScanSidecar:[18,n.TYPES.BYTES],firstScanLength:[19,n.TYPES.UINT32],experimentGroupId:[20,n.TYPES.UINT32],scansSidecar:[21,n.TYPES.BYTES],scanLengths:[22,n.FLAGS.REPEATED|n.TYPES.UINT32],midQualityFileSha256:[23,n.TYPES.BYTES],midQualityFileEncSha256:[24,n.TYPES.BYTES],viewOnce:[25,n.TYPES.BOOL],thumbnailDirectPath:[26,n.TYPES.STRING],thumbnailSha256:[27,n.TYPES.BYTES],thumbnailEncSha256:[28,n.TYPES.BYTES]},Me.internalSpec={groupId:[1,n.TYPES.STRING],axolotlSenderKeyDistributionMessage:[2,n.TYPES.BYTES]},Ie.internalSpec={stanzaId:[1,n.TYPES.STRING],participant:[2,n.TYPES.STRING],quotedMessage:[3,n.TYPES.MESSAGE,b],remoteJid:[4,n.TYPES.STRING],mentionedJid:[15,n.FLAGS.REPEATED|n.TYPES.STRING],conversionSource:[18,n.TYPES.STRING],conversionData:[19,n.TYPES.BYTES],conversionDelaySeconds:[20,n.TYPES.UINT32],forwardingScore:[21,n.TYPES.UINT32],isForwarded:[22,n.TYPES.BOOL],quotedAd:[23,n.TYPES.MESSAGE,De],placeholderKey:[24,n.TYPES.MESSAGE,a.MessageKeySpec],expiration:[25,n.TYPES.UINT32],ephemeralSettingTimestamp:[26,n.TYPES.INT64],ephemeralSharedSecret:[27,n.TYPES.BYTES],externalAdReply:[28,n.TYPES.MESSAGE,Re],entryPointConversionSource:[29,n.TYPES.STRING],entryPointConversionApp:[30,n.TYPES.STRING],entryPointConversionDelaySeconds:[31,n.TYPES.STRING]},Re.internalSpec={title:[1,n.TYPES.STRING],body:[2,n.TYPES.STRING],mediaType:[3,n.TYPES.ENUM,S],thumbnailUrl:[4,n.TYPES.STRING],mediaUrl:[5,n.TYPES.STRING],thumbnail:[6,n.TYPES.BYTES],sourceType:[7,n.TYPES.STRING],sourceId:[8,n.TYPES.STRING],sourceUrl:[9,n.TYPES.STRING]},De.internalSpec={advertiserName:[1,n.TYPES.STRING],mediaType:[2,n.TYPES.ENUM,T],jpegThumbnail:[16,n.TYPES.BYTES],caption:[17,n.TYPES.STRING]},Ne.internalSpec={deviceListMetadata:[1,n.TYPES.MESSAGE,Le],deviceListMetadataVersion:[2,n.TYPES.INT32]},Le.internalSpec={senderKeyHash:[1,n.TYPES.BYTES],senderTimestamp:[2,n.TYPES.UINT64],senderKeyIndexes:[3,n.FLAGS.REPEATED|n.FLAGS.PACKED|n.TYPES.UINT32],recipientKeyHash:[8,n.TYPES.BYTES],recipientTimestamp:[9,n.TYPES.UINT64],recipientKeyIndexes:[10,n.FLAGS.REPEATED|n.FLAGS.PACKED|n.TYPES.UINT32]},ke.internalSpec={polygonVertices:[1,n.FLAGS.REPEATED|n.TYPES.MESSAGE,Ue],location:[2,n.TYPES.MESSAGE,Fe],__oneofs__:{action:["location"]}},Ue.internalSpec={xDeprecated:[1,n.TYPES.INT32],yDeprecated:[2,n.TYPES.INT32],x:[3,n.TYPES.DOUBLE],y:[4,n.TYPES.DOUBLE]},Fe.internalSpec={degreesLatitude:[1,n.TYPES.DOUBLE],degreesLongitude:[2,n.TYPES.DOUBLE],name:[3,n.TYPES.STRING]},Ge.internalSpec={quickReplyButton:[1,n.TYPES.MESSAGE,Ye],urlButton:[2,n.TYPES.MESSAGE,Be],callButton:[3,n.TYPES.MESSAGE,xe],index:[4,n.TYPES.UINT32],__oneofs__:{button:["quickReplyButton","urlButton","callButton"]}},xe.internalSpec={displayText:[1,n.TYPES.MESSAGE,re],phoneNumber:[2,n.TYPES.MESSAGE,re]},Be.internalSpec={displayText:[1,n.TYPES.MESSAGE,re],url:[2,n.TYPES.MESSAGE,re]},Ye.internalSpec={displayText:[1,n.TYPES.MESSAGE,re],id:[2,n.TYPES.STRING]},Ke.internalSpec={quickReplyButton:[1,n.TYPES.MESSAGE,Ve],urlButton:[2,n.TYPES.MESSAGE,We],callButton:[3,n.TYPES.MESSAGE,je],index:[4,n.TYPES.UINT32],__oneofs__:{hydratedButton:["quickReplyButton","urlButton","callButton"]}},je.internalSpec={displayText:[1,n.TYPES.STRING],phoneNumber:[2,n.TYPES.STRING]},We.internalSpec={displayText:[1,n.TYPES.STRING],url:[2,n.TYPES.STRING]},Ve.internalSpec={displayText:[1,n.TYPES.STRING],id:[2,n.TYPES.STRING]},He.internalSpec={value:[1,n.TYPES.INT64],offset:[2,n.TYPES.UINT32],currencyCode:[3,n.TYPES.STRING]}},92214:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EphemeralSettingSpec=void 0;var a=r(45261),n={};t.EphemeralSettingSpec=n,n.internalSpec={duration:[1,a.TYPES.SFIXED32],timestamp:[2,a.TYPES.SFIXED64]}},421:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PushnameSpec=t.HistorySyncMsgSpec=t.ConversationSpec=t.HistorySyncSpec=t.ConversationEndOfHistoryTransferType=t.HistorySyncHistorySyncType=void 0;var a=r(21617),n=r(45261),i=r(28103)({INITIAL_BOOTSTRAP:0,INITIAL_STATUS_V3:1,FULL:2,RECENT:3,PUSH_NAME:4});t.HistorySyncHistorySyncType=i;var s=r(28103)({COMPLETE_BUT_MORE_MESSAGES_REMAIN_ON_PRIMARY:0,COMPLETE_AND_NO_MORE_MESSAGE_REMAIN_ON_PRIMARY:1});t.ConversationEndOfHistoryTransferType=s;var o={};t.HistorySyncSpec=o;var u={};t.ConversationSpec=u;var l={};t.HistorySyncMsgSpec=l;var d={};t.PushnameSpec=d,o.internalSpec={syncType:[1,n.FLAGS.REQUIRED|n.TYPES.ENUM,i],conversations:[2,n.FLAGS.REPEATED|n.TYPES.MESSAGE,u],statusV3Messages:[3,n.FLAGS.REPEATED|n.TYPES.MESSAGE,a.WebMessageInfoSpec],chunkOrder:[5,n.TYPES.UINT32],progress:[6,n.TYPES.UINT32],pushnames:[7,n.FLAGS.REPEATED|n.TYPES.MESSAGE,d]},u.internalSpec={id:[1,n.FLAGS.REQUIRED|n.TYPES.STRING],messages:[2,n.FLAGS.REPEATED|n.TYPES.MESSAGE,l],newJid:[3,n.TYPES.STRING],oldJid:[4,n.TYPES.STRING],lastMsgTimestamp:[5,n.TYPES.UINT64],unreadCount:[6,n.TYPES.UINT32],readOnly:[7,n.TYPES.BOOL],endOfHistoryTransfer:[8,n.TYPES.BOOL],ephemeralExpiration:[9,n.TYPES.UINT32],ephemeralSettingTimestamp:[10,n.TYPES.INT64],endOfHistoryTransferType:[11,n.TYPES.ENUM,s],conversationTimestamp:[12,n.TYPES.UINT64],name:[13,n.TYPES.STRING],pHash:[14,n.TYPES.STRING],notSpam:[15,n.TYPES.BOOL]},l.internalSpec={message:[1,n.TYPES.MESSAGE,a.WebMessageInfoSpec],msgOrderId:[2,n.TYPES.UINT64]},d.internalSpec={id:[1,n.TYPES.STRING],pushname:[2,n.TYPES.STRING]}},42451:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MsgOpaqueDataSpec=t.MsgRowOpaqueDataSpec=void 0;var a=r(45261),n={};t.MsgRowOpaqueDataSpec=n;var i={};t.MsgOpaqueDataSpec=i,n.internalSpec={currentMsg:[1,a.TYPES.MESSAGE,i],quotedMsg:[2,a.TYPES.MESSAGE,i]},i.internalSpec={body:[1,a.TYPES.STRING],caption:[3,a.TYPES.STRING],clientUrl:[4,a.TYPES.STRING],loc:[4,a.TYPES.STRING],lng:[5,a.TYPES.DOUBLE],lat:[7,a.TYPES.DOUBLE],paymentAmount1000:[8,a.TYPES.INT32],paymentNoteMsgBody:[9,a.TYPES.STRING],canonicalUrl:[10,a.TYPES.STRING],matchedText:[11,a.TYPES.STRING],title:[12,a.TYPES.STRING],description:[13,a.TYPES.STRING]}},4786:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ServerErrorReceiptSpec=t.MediaRetryNotificationSpec=t.MediaRetryNotificationResultType=void 0;var a=r(45261),n=r(28103)({GENERAL_ERROR:0,SUCCESS:1,NOT_FOUND:2,DECRYPTION_ERROR:3});t.MediaRetryNotificationResultType=n;var i={};t.MediaRetryNotificationSpec=i;var s={};t.ServerErrorReceiptSpec=s,i.internalSpec={stanzaId:[1,a.TYPES.STRING],directPath:[2,a.TYPES.STRING],result:[3,a.TYPES.ENUM,n]},s.internalSpec={stanzaId:[1,a.TYPES.STRING]}},76483:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MessageKeySpec=void 0;var a=r(45261),n={};t.MessageKeySpec=n,n.internalSpec={remoteJid:[1,a.TYPES.STRING],fromMe:[2,a.TYPES.BOOL],id:[3,a.TYPES.STRING],participant:[4,a.TYPES.STRING]}},3531:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SyncdPatchSpec=t.SyncdMutationSpec=t.SyncdMutationsSpec=t.SyncdSnapshotSpec=t.ExternalBlobReferenceSpec=t.SyncdRecordSpec=t.KeyIdSpec=t.SyncdValueSpec=t.SyncdIndexSpec=t.ExitCodeSpec=t.SyncdVersionSpec=t.SyncdMutationSyncdOperation=void 0;var a=r(45261),n=r(28103)({SET:0,REMOVE:1});t.SyncdMutationSyncdOperation=n;var i={};t.SyncdVersionSpec=i;var s={};t.ExitCodeSpec=s;var o={};t.SyncdIndexSpec=o;var u={};t.SyncdValueSpec=u;var l={};t.KeyIdSpec=l;var d={};t.SyncdRecordSpec=d;var c={};t.ExternalBlobReferenceSpec=c;var f={};t.SyncdSnapshotSpec=f;var p={};t.SyncdMutationsSpec=p;var h={};t.SyncdMutationSpec=h;var _={};t.SyncdPatchSpec=_,i.internalSpec={version:[1,a.TYPES.UINT64]},s.internalSpec={code:[1,a.TYPES.UINT64],text:[2,a.TYPES.STRING]},o.internalSpec={blob:[1,a.TYPES.BYTES]},u.internalSpec={blob:[1,a.TYPES.BYTES]},l.internalSpec={id:[1,a.TYPES.BYTES]},d.internalSpec={index:[1,a.TYPES.MESSAGE,o],value:[2,a.TYPES.MESSAGE,u],keyId:[3,a.TYPES.MESSAGE,l]},c.internalSpec={mediaKey:[1,a.TYPES.BYTES],directPath:[2,a.TYPES.STRING],handle:[3,a.TYPES.STRING],fileSizeBytes:[4,a.TYPES.UINT64],fileSha256:[5,a.TYPES.BYTES],fileEncSha256:[6,a.TYPES.BYTES]},f.internalSpec={version:[1,a.TYPES.MESSAGE,i],records:[2,a.FLAGS.REPEATED|a.TYPES.MESSAGE,d],mac:[3,a.TYPES.BYTES],keyId:[4,a.TYPES.MESSAGE,l]},p.internalSpec={mutations:[1,a.FLAGS.REPEATED|a.TYPES.MESSAGE,h]},h.internalSpec={operation:[1,a.TYPES.ENUM,n],record:[2,a.TYPES.MESSAGE,d]},_.internalSpec={version:[1,a.TYPES.MESSAGE,i],mutations:[2,a.FLAGS.REPEATED|a.TYPES.MESSAGE,h],externalMutations:[3,a.TYPES.MESSAGE,c],snapshotMac:[4,a.TYPES.BYTES],patchMac:[5,a.TYPES.BYTES],keyId:[6,a.TYPES.MESSAGE,l],exitCode:[7,a.TYPES.MESSAGE,s],deviceIndex:[8,a.TYPES.UINT32]}},61239:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SyncActionDataSpec=t.StarActionSpec=t.ContactActionSpec=t.MuteActionSpec=t.PinActionSpec=t.SecurityNotificationSettingSpec=t.PushNameSettingSpec=t.LocaleSettingSpec=t.QuickReplyActionSpec=t.LabelAssociationActionSpec=t.LabelEditActionSpec=t.RecentStickerWeightsActionSpec=t.RecentStickerMetadataSpec=t.RecentEmojiWeightsActionSpec=t.ArchiveChatActionSpec=t.DeleteMessageForMeActionSpec=t.MarkChatAsReadActionSpec=t.ClearChatActionSpec=t.DeleteChatActionSpec=t.UnarchiveChatsSettingSpec=t.SyncActionMessageRangeSpec=t.SyncActionMessageSpec=t.KeyExpirationSpec=t.SyncActionValueSpec=t.RecentEmojiWeightSpec=t.RecentStickerWeightSpec=void 0;var a=r(76483),n=r(45261),i={};t.RecentStickerWeightSpec=i;var s={};t.RecentEmojiWeightSpec=s;var o={};t.SyncActionValueSpec=o;var u={};t.KeyExpirationSpec=u;var l={};t.SyncActionMessageSpec=l;var d={};t.SyncActionMessageRangeSpec=d;var c={};t.UnarchiveChatsSettingSpec=c;var f={};t.DeleteChatActionSpec=f;var p={};t.ClearChatActionSpec=p;var h={};t.MarkChatAsReadActionSpec=h;var _={};t.DeleteMessageForMeActionSpec=_;var m={};t.ArchiveChatActionSpec=m;var g={};t.RecentEmojiWeightsActionSpec=g;var v={};t.RecentStickerMetadataSpec=v;var E={};t.RecentStickerWeightsActionSpec=E;var y={};t.LabelEditActionSpec=y;var S={};t.LabelAssociationActionSpec=S;var T={};t.QuickReplyActionSpec=T;var b={};t.LocaleSettingSpec=b;var A={};t.PushNameSettingSpec=A;var C={};t.SecurityNotificationSettingSpec=C;var P={};t.PinActionSpec=P;var O={};t.MuteActionSpec=O;var w={};t.ContactActionSpec=w;var M={};t.StarActionSpec=M;var I={};t.SyncActionDataSpec=I,i.internalSpec={filehash:[1,n.TYPES.STRING],weight:[2,n.TYPES.FLOAT]},s.internalSpec={emoji:[1,n.TYPES.STRING],weight:[2,n.TYPES.FLOAT]},o.internalSpec={timestamp:[1,n.TYPES.INT64],starAction:[2,n.TYPES.MESSAGE,M],contactAction:[3,n.TYPES.MESSAGE,w],muteAction:[4,n.TYPES.MESSAGE,O],pinAction:[5,n.TYPES.MESSAGE,P],securityNotificationSetting:[6,n.TYPES.MESSAGE,C],pushNameSetting:[7,n.TYPES.MESSAGE,A],quickReplyAction:[8,n.TYPES.MESSAGE,T],recentStickerWeightsAction:[9,n.TYPES.MESSAGE,E],recentStickerMetadata:[10,n.TYPES.MESSAGE,v],recentEmojiWeightsAction:[11,n.TYPES.MESSAGE,g],labelEditAction:[14,n.TYPES.MESSAGE,y],labelAssociationAction:[15,n.TYPES.MESSAGE,S],localeSetting:[16,n.TYPES.MESSAGE,b],archiveChatAction:[17,n.TYPES.MESSAGE,m],deleteMessageForMeAction:[18,n.TYPES.MESSAGE,_],keyExpiration:[19,n.TYPES.MESSAGE,u],markChatAsReadAction:[20,n.TYPES.MESSAGE,h],clearChatAction:[21,n.TYPES.MESSAGE,p],deleteChatAction:[22,n.TYPES.MESSAGE,f],unarchiveChatsSetting:[23,n.TYPES.MESSAGE,c]},u.internalSpec={expiredKeyEpoch:[1,n.TYPES.INT32]},l.internalSpec={key:[1,n.TYPES.MESSAGE,a.MessageKeySpec],timestamp:[2,n.TYPES.INT64]},d.internalSpec={lastMessageTimestamp:[1,n.TYPES.INT64],lastSystemMessageTimestamp:[2,n.TYPES.INT64],messages:[3,n.FLAGS.REPEATED|n.TYPES.MESSAGE,l]},c.internalSpec={unarchiveChats:[1,n.TYPES.BOOL]},f.internalSpec={messageRange:[1,n.TYPES.MESSAGE,d]},p.internalSpec={messageRange:[1,n.TYPES.MESSAGE,d]},h.internalSpec={read:[1,n.TYPES.BOOL],messageRange:[2,n.TYPES.MESSAGE,d]},_.internalSpec={deleteMedia:[1,n.TYPES.BOOL],messageTimestamp:[2,n.TYPES.INT64]},m.internalSpec={archived:[1,n.TYPES.BOOL],messageRange:[2,n.TYPES.MESSAGE,d]},g.internalSpec={weights:[1,n.FLAGS.REPEATED|n.TYPES.MESSAGE,s]},v.internalSpec={directPath:[1,n.TYPES.STRING],encFilehash:[2,n.TYPES.STRING],mediaKey:[3,n.TYPES.STRING],stanzaId:[4,n.TYPES.STRING],chatJid:[5,n.TYPES.STRING],participant:[6,n.TYPES.STRING],isSentByMe:[7,n.TYPES.BOOL]},E.internalSpec={weights:[1,n.FLAGS.REPEATED|n.TYPES.MESSAGE,i]},y.internalSpec={name:[1,n.TYPES.STRING],color:[2,n.TYPES.INT32],predefinedId:[3,n.TYPES.INT32],deleted:[4,n.TYPES.BOOL]},S.internalSpec={labeled:[1,n.TYPES.BOOL]},T.internalSpec={shortcut:[1,n.TYPES.STRING],message:[2,n.TYPES.STRING],keywords:[3,n.FLAGS.REPEATED|n.TYPES.STRING],count:[4,n.TYPES.INT32],deleted:[5,n.TYPES.BOOL]},b.internalSpec={locale:[1,n.TYPES.STRING]},A.internalSpec={name:[1,n.TYPES.STRING]},C.internalSpec={showNotification:[1,n.TYPES.BOOL]},P.internalSpec={pinned:[1,n.TYPES.BOOL]},O.internalSpec={muted:[1,n.TYPES.BOOL],muteEndTimestamp:[2,n.TYPES.INT64]},w.internalSpec={fullName:[1,n.TYPES.STRING],firstName:[2,n.TYPES.STRING]},M.internalSpec={starred:[1,n.TYPES.BOOL]},I.internalSpec={index:[1,n.TYPES.BYTES],value:[2,n.TYPES.MESSAGE,o],padding:[3,n.TYPES.BYTES],version:[4,n.TYPES.INT32]}},84222:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BizIdentityInfoSpec=t.BizAccountLinkInfoSpec=t.BizAccountPayloadSpec=t.DetailsSpec=t.VerifiedNameCertificateSpec=t.LocalizedNameSpec=t.BizIdentityInfoVerifiedLevelValue=t.BizIdentityInfoHostStorageType=t.BizIdentityInfoActualActorsType=t.BizAccountLinkInfoHostStorageType=t.BizAccountLinkInfoAccountType=void 0;var a=r(45261),n=r(28103)({ENTERPRISE:0,PAGE:1});t.BizAccountLinkInfoAccountType=n;var i=r(28103)({ON_PREMISE:0,FACEBOOK:1});t.BizAccountLinkInfoHostStorageType=i;var s=r(28103)({SELF:0,BSP:1});t.BizIdentityInfoActualActorsType=s;var o=r(28103)({ON_PREMISE:0,FACEBOOK:1});t.BizIdentityInfoHostStorageType=o;var u=r(28103)({UNKNOWN:0,LOW:1,HIGH:2});t.BizIdentityInfoVerifiedLevelValue=u;var l={};t.LocalizedNameSpec=l;var d={};t.VerifiedNameCertificateSpec=d;var c={};t.DetailsSpec=c;var f={};t.BizAccountPayloadSpec=f;var p={};t.BizAccountLinkInfoSpec=p;var h={};t.BizIdentityInfoSpec=h,l.internalSpec={lg:[1,a.TYPES.STRING],lc:[2,a.TYPES.STRING],verifiedName:[3,a.TYPES.STRING]},d.internalSpec={details:[1,a.TYPES.BYTES],signature:[2,a.TYPES.BYTES],serverSignature:[3,a.TYPES.BYTES]},c.internalSpec={serial:[1,a.TYPES.UINT64],issuer:[2,a.TYPES.STRING],verifiedName:[4,a.TYPES.STRING],localizedNames:[8,a.FLAGS.REPEATED|a.TYPES.MESSAGE,l],issueTime:[10,a.TYPES.UINT64]},f.internalSpec={vnameCert:[1,a.TYPES.MESSAGE,d],bizAcctLinkInfo:[2,a.TYPES.BYTES]},p.internalSpec={whatsappBizAcctFbid:[1,a.TYPES.UINT64],whatsappAcctNumber:[2,a.TYPES.STRING],issueTime:[3,a.TYPES.UINT64],hostStorage:[4,a.TYPES.ENUM,i],accountType:[5,a.TYPES.ENUM,n]},h.internalSpec={vlevel:[1,a.TYPES.ENUM,u],vnameCert:[2,a.TYPES.MESSAGE,d],signed:[3,a.TYPES.BOOL],revoked:[4,a.TYPES.BOOL],hostStorage:[5,a.TYPES.ENUM,o],actualActors:[6,a.TYPES.ENUM,s],privacyModeTs:[7,a.TYPES.UINT64]}},33599:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AppVersionSpec=t.UserAgentSpec=t.WebdPayloadSpec=t.WebInfoSpec=t.DNSSourceSpec=t.CompanionRegDataSpec=t.ClientPayloadSpec=t.DetailsSpec=t.NoiseCertificateSpec=t.ClientHelloSpec=t.ServerHelloSpec=t.ClientFinishSpec=t.HandshakeMessageSpec=t.ClientPayloadClientFeature=t.UserAgentPlatform=t.UserAgentReleaseChannel=t.WebInfoWebSubPlatform=t.ClientPayloadIOSAppExtension=t.ClientPayloadConnectReason=t.ClientPayloadConnectType=t.DNSSourceDNSResolutionMethod=t.ClientPayloadProduct=void 0;var a=r(45261),n=r(28103)({WHATSAPP:0,MESSENGER:1});t.ClientPayloadProduct=n;var i=r(28103)({SYSTEM:0,GOOGLE:1,HARDCODED:2,OVERRIDE:3,FALLBACK:4});t.DNSSourceDNSResolutionMethod=i;var s=r(28103)({CELLULAR_UNKNOWN:0,WIFI_UNKNOWN:1,CELLULAR_EDGE:100,CELLULAR_IDEN:101,CELLULAR_UMTS:102,CELLULAR_EVDO:103,CELLULAR_GPRS:104,CELLULAR_HSDPA:105,CELLULAR_HSUPA:106,CELLULAR_HSPA:107,CELLULAR_CDMA:108,CELLULAR_1XRTT:109,CELLULAR_EHRPD:110,CELLULAR_LTE:111,CELLULAR_HSPAP:112});t.ClientPayloadConnectType=s;var o=r(28103)({PUSH:0,USER_ACTIVATED:1,SCHEDULED:2,ERROR_RECONNECT:3,NETWORK_SWITCH:4,PING_RECONNECT:5});t.ClientPayloadConnectReason=o;var u=r(28103)({SHARE_EXTENSION:0,SERVICE_EXTENSION:1,INTENTS_EXTENSION:2});t.ClientPayloadIOSAppExtension=u;var l=r(28103)({WEB_BROWSER:0,APP_STORE:1,WIN_STORE:2,DARWIN:3,WIN32:4});t.WebInfoWebSubPlatform=l;var d=r(28103)({RELEASE:0,BETA:1,ALPHA:2,DEBUG:3});t.UserAgentReleaseChannel=d;var c=r(28103)({ANDROID:0,IOS:1,WINDOWS_PHONE:2,BLACKBERRY:3,BLACKBERRYX:4,S40:5,S60:6,PYTHON_CLIENT:7,TIZEN:8,ENTERPRISE:9,SMB_ANDROID:10,KAIOS:11,SMB_IOS:12,WINDOWS:13,WEB:14,PORTAL:15,GREEN_ANDROID:16,GREEN_IPHONE:17,BLUE_ANDROID:18,BLUE_IPHONE:19,FBLITE_ANDROID:20,MLITE_ANDROID:21,IGLITE_ANDROID:22,PAGE:23});t.UserAgentPlatform=c;var f=r(28103)({NONE:0});t.ClientPayloadClientFeature=f;var p={};t.HandshakeMessageSpec=p;var h={};t.ClientFinishSpec=h;var _={};t.ServerHelloSpec=_;var m={};t.ClientHelloSpec=m;var g={};t.NoiseCertificateSpec=g;var v={};t.DetailsSpec=v;var E={};t.ClientPayloadSpec=E;var y={};t.CompanionRegDataSpec=y;var S={};t.DNSSourceSpec=S;var T={};t.WebInfoSpec=T;var b={};t.WebdPayloadSpec=b;var A={};t.UserAgentSpec=A;var C={};t.AppVersionSpec=C,p.internalSpec={clientHello:[2,a.TYPES.MESSAGE,m],serverHello:[3,a.TYPES.MESSAGE,_],clientFinish:[4,a.TYPES.MESSAGE,h]},h.internalSpec={static:[1,a.TYPES.BYTES],payload:[2,a.TYPES.BYTES]},_.internalSpec={ephemeral:[1,a.TYPES.BYTES],static:[2,a.TYPES.BYTES],payload:[3,a.TYPES.BYTES]},m.internalSpec={ephemeral:[1,a.TYPES.BYTES],static:[2,a.TYPES.BYTES],payload:[3,a.TYPES.BYTES]},g.internalSpec={details:[1,a.TYPES.BYTES],signature:[2,a.TYPES.BYTES]},v.internalSpec={serial:[1,a.TYPES.UINT32],issuer:[2,a.TYPES.STRING],expires:[3,a.TYPES.UINT64],subject:[4,a.TYPES.STRING],key:[5,a.TYPES.BYTES]},E.internalSpec={username:[1,a.TYPES.UINT64],passive:[3,a.TYPES.BOOL],clientFeatures:[4,a.FLAGS.REPEATED|a.TYPES.ENUM,f],userAgent:[5,a.TYPES.MESSAGE,A],webInfo:[6,a.TYPES.MESSAGE,T],pushName:[7,a.TYPES.STRING],sessionId:[9,a.TYPES.SFIXED32],shortConnect:[10,a.TYPES.BOOL],iosAppExtension:[30,a.TYPES.ENUM,u],connectType:[12,a.TYPES.ENUM,s],connectReason:[13,a.TYPES.ENUM,o],shards:[14,a.FLAGS.REPEATED|a.TYPES.INT32],dnsSource:[15,a.TYPES.MESSAGE,S],connectAttemptCount:[16,a.TYPES.UINT32],agent:[17,a.TYPES.UINT32],device:[18,a.TYPES.UINT32],regData:[19,a.TYPES.MESSAGE,y],product:[20,a.TYPES.ENUM,n],fbCat:[21,a.TYPES.BYTES],fbUserAgent:[22,a.TYPES.BYTES],oc:[23,a.TYPES.BOOL]},y.internalSpec={eRegid:[1,a.TYPES.BYTES],eKeytype:[2,a.TYPES.BYTES],eIdent:[3,a.TYPES.BYTES],eSkeyId:[4,a.TYPES.BYTES],eSkeyVal:[5,a.TYPES.BYTES],eSkeySig:[6,a.TYPES.BYTES],buildHash:[7,a.TYPES.BYTES],companionProps:[8,a.TYPES.BYTES]},S.internalSpec={dnsMethod:[15,a.TYPES.ENUM,i],appCached:[16,a.TYPES.BOOL]},T.internalSpec={refToken:[1,a.TYPES.STRING],version:[2,a.TYPES.STRING],webdPayload:[3,a.TYPES.MESSAGE,b],webSubPlatform:[4,a.TYPES.ENUM,l]},b.internalSpec={usesParticipantInKey:[1,a.TYPES.BOOL],supportsStarredMessages:[2,a.TYPES.BOOL],supportsDocumentMessages:[3,a.TYPES.BOOL],supportsUrlMessages:[4,a.TYPES.BOOL],supportsMediaRetry:[5,a.TYPES.BOOL],supportsE2EImage:[6,a.TYPES.BOOL],supportsE2EVideo:[7,a.TYPES.BOOL],supportsE2EAudio:[8,a.TYPES.BOOL],supportsE2EDocument:[9,a.TYPES.BOOL],documentTypes:[10,a.TYPES.STRING],features:[11,a.TYPES.BYTES]},A.internalSpec={platform:[1,a.TYPES.ENUM,c],appVersion:[2,a.TYPES.MESSAGE,C],mcc:[3,a.TYPES.STRING],mnc:[4,a.TYPES.STRING],osVersion:[5,a.TYPES.STRING],manufacturer:[6,a.TYPES.STRING],device:[7,a.TYPES.STRING],osBuildNumber:[8,a.TYPES.STRING],phoneId:[9,a.TYPES.STRING],releaseChannel:[10,a.TYPES.ENUM,d],localeLanguageIso6391:[11,a.TYPES.STRING],localeCountryIso31661Alpha2:[12,a.TYPES.STRING],deviceBoard:[13,a.TYPES.STRING]},C.internalSpec={primary:[1,a.TYPES.UINT32],secondary:[2,a.TYPES.UINT32],tertiary:[3,a.TYPES.UINT32],quaternary:[4,a.TYPES.UINT32],quinary:[5,a.TYPES.UINT32]}},21617:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PhotoChangeSpec=t.MediaDataSpec=t.WebFeaturesSpec=t.NotificationMessageInfoSpec=t.WebNotificationsInfoSpec=t.PaymentInfoSpec=t.WebMessageInfoSpec=t.WebFeaturesFlag=t.PaymentInfoCurrency=t.PaymentInfoStatus=t.PaymentInfoTxnStatus=t.WebMessageInfoStatus=t.WebMessageInfoStubType=t.WebMessageInfoBizPrivacyStatus=void 0;var a=r(28703),n=r(76483),i=r(45261),s=r(28103)({E2EE:0,FB:2,BSP:1,BSP_AND_FB:3});t.WebMessageInfoBizPrivacyStatus=s;var o=r(28103)({UNKNOWN:0,REVOKE:1,CIPHERTEXT:2,FUTUREPROOF:3,NON_VERIFIED_TRANSITION:4,UNVERIFIED_TRANSITION:5,VERIFIED_TRANSITION:6,VERIFIED_LOW_UNKNOWN:7,VERIFIED_HIGH:8,VERIFIED_INITIAL_UNKNOWN:9,VERIFIED_INITIAL_LOW:10,VERIFIED_INITIAL_HIGH:11,VERIFIED_TRANSITION_ANY_TO_NONE:12,VERIFIED_TRANSITION_ANY_TO_HIGH:13,VERIFIED_TRANSITION_HIGH_TO_LOW:14,VERIFIED_TRANSITION_HIGH_TO_UNKNOWN:15,VERIFIED_TRANSITION_UNKNOWN_TO_LOW:16,VERIFIED_TRANSITION_LOW_TO_UNKNOWN:17,VERIFIED_TRANSITION_NONE_TO_LOW:18,VERIFIED_TRANSITION_NONE_TO_UNKNOWN:19,GROUP_CREATE:20,GROUP_CHANGE_SUBJECT:21,GROUP_CHANGE_ICON:22,GROUP_CHANGE_INVITE_LINK:23,GROUP_CHANGE_DESCRIPTION:24,GROUP_CHANGE_RESTRICT:25,GROUP_CHANGE_ANNOUNCE:26,GROUP_PARTICIPANT_ADD:27,GROUP_PARTICIPANT_REMOVE:28,GROUP_PARTICIPANT_PROMOTE:29,GROUP_PARTICIPANT_DEMOTE:30,GROUP_PARTICIPANT_INVITE:31,GROUP_PARTICIPANT_LEAVE:32,GROUP_PARTICIPANT_CHANGE_NUMBER:33,BROADCAST_CREATE:34,BROADCAST_ADD:35,BROADCAST_REMOVE:36,GENERIC_NOTIFICATION:37,E2E_IDENTITY_CHANGED:38,E2E_ENCRYPTED:39,CALL_MISSED_VOICE:40,CALL_MISSED_VIDEO:41,INDIVIDUAL_CHANGE_NUMBER:42,GROUP_DELETE:43,GROUP_ANNOUNCE_MODE_MESSAGE_BOUNCE:44,CALL_MISSED_GROUP_VOICE:45,CALL_MISSED_GROUP_VIDEO:46,PAYMENT_CIPHERTEXT:47,PAYMENT_FUTUREPROOF:48,PAYMENT_TRANSACTION_STATUS_UPDATE_FAILED:49,PAYMENT_TRANSACTION_STATUS_UPDATE_REFUNDED:50,PAYMENT_TRANSACTION_STATUS_UPDATE_REFUND_FAILED:51,PAYMENT_TRANSACTION_STATUS_RECEIVER_PENDING_SETUP:52,PAYMENT_TRANSACTION_STATUS_RECEIVER_SUCCESS_AFTER_HICCUP:53,PAYMENT_ACTION_ACCOUNT_SETUP_REMINDER:54,PAYMENT_ACTION_SEND_PAYMENT_REMINDER:55,PAYMENT_ACTION_SEND_PAYMENT_INVITATION:56,PAYMENT_ACTION_REQUEST_DECLINED:57,PAYMENT_ACTION_REQUEST_EXPIRED:58,PAYMENT_ACTION_REQUEST_CANCELLED:59,BIZ_VERIFIED_TRANSITION_TOP_TO_BOTTOM:60,BIZ_VERIFIED_TRANSITION_BOTTOM_TO_TOP:61,BIZ_INTRO_TOP:62,BIZ_INTRO_BOTTOM:63,BIZ_NAME_CHANGE:64,BIZ_MOVE_TO_CONSUMER_APP:65,BIZ_TWO_TIER_MIGRATION_TOP:66,BIZ_TWO_TIER_MIGRATION_BOTTOM:67,OVERSIZED:68,GROUP_CHANGE_NO_FREQUENTLY_FORWARDED:69,GROUP_V4_ADD_INVITE_SENT:70,GROUP_PARTICIPANT_ADD_REQUEST_JOIN:71,CHANGE_EPHEMERAL_SETTING:72,E2E_DEVICE_CHANGED:73,VIEWED_ONCE:74,E2E_ENCRYPTED_NOW:75,BLUE_MSG_BSP_FB_TO_BSP_PREMISE:76,BLUE_MSG_BSP_FB_TO_SELF_FB:77,BLUE_MSG_BSP_FB_TO_SELF_PREMISE:78,BLUE_MSG_BSP_FB_UNVERIFIED:79,BLUE_MSG_BSP_FB_UNVERIFIED_TO_SELF_PREMISE_VERIFIED:80,BLUE_MSG_BSP_FB_VERIFIED:81,BLUE_MSG_BSP_FB_VERIFIED_TO_SELF_PREMISE_UNVERIFIED:82,BLUE_MSG_BSP_PREMISE_TO_SELF_PREMISE:83,BLUE_MSG_BSP_PREMISE_UNVERIFIED:84,BLUE_MSG_BSP_PREMISE_UNVERIFIED_TO_SELF_PREMISE_VERIFIED:85,BLUE_MSG_BSP_PREMISE_VERIFIED:86,BLUE_MSG_BSP_PREMISE_VERIFIED_TO_SELF_PREMISE_UNVERIFIED:87,BLUE_MSG_CONSUMER_TO_BSP_FB_UNVERIFIED:88,BLUE_MSG_CONSUMER_TO_BSP_PREMISE_UNVERIFIED:89,BLUE_MSG_CONSUMER_TO_SELF_FB_UNVERIFIED:90,BLUE_MSG_CONSUMER_TO_SELF_PREMISE_UNVERIFIED:91,BLUE_MSG_SELF_FB_TO_BSP_PREMISE:92,BLUE_MSG_SELF_FB_TO_SELF_PREMISE:93,BLUE_MSG_SELF_FB_UNVERIFIED:94,BLUE_MSG_SELF_FB_UNVERIFIED_TO_SELF_PREMISE_VERIFIED:95,BLUE_MSG_SELF_FB_VERIFIED:96,BLUE_MSG_SELF_FB_VERIFIED_TO_SELF_PREMISE_UNVERIFIED:97,BLUE_MSG_SELF_PREMISE_TO_BSP_PREMISE:98,BLUE_MSG_SELF_PREMISE_UNVERIFIED:99,BLUE_MSG_SELF_PREMISE_VERIFIED:100,BLUE_MSG_TO_BSP_FB:101,BLUE_MSG_TO_CONSUMER:102,BLUE_MSG_TO_SELF_FB:103,BLUE_MSG_UNVERIFIED_TO_BSP_FB_VERIFIED:104,BLUE_MSG_UNVERIFIED_TO_BSP_PREMISE_VERIFIED:105,BLUE_MSG_UNVERIFIED_TO_SELF_FB_VERIFIED:106,BLUE_MSG_UNVERIFIED_TO_VERIFIED:107,BLUE_MSG_VERIFIED_TO_BSP_FB_UNVERIFIED:108,BLUE_MSG_VERIFIED_TO_BSP_PREMISE_UNVERIFIED:109,BLUE_MSG_VERIFIED_TO_SELF_FB_UNVERIFIED:110,BLUE_MSG_VERIFIED_TO_UNVERIFIED:111,BLUE_MSG_BSP_FB_UNVERIFIED_TO_BSP_PREMISE_VERIFIED:112,BLUE_MSG_BSP_FB_UNVERIFIED_TO_SELF_FB_VERIFIED:113,BLUE_MSG_BSP_FB_VERIFIED_TO_BSP_PREMISE_UNVERIFIED:114,BLUE_MSG_BSP_FB_VERIFIED_TO_SELF_FB_UNVERIFIED:115,BLUE_MSG_SELF_FB_UNVERIFIED_TO_BSP_PREMISE_VERIFIED:116,BLUE_MSG_SELF_FB_VERIFIED_TO_BSP_PREMISE_UNVERIFIED:117,E2E_IDENTITY_UNAVAILABLE:118,GROUP_CREATING:119,GROUP_CREATE_FAILED:120,GROUP_BOUNCED:121,BLOCK_CONTACT:122,EPHEMERAL_SETTING_NOT_APPLIED:123,SYNC_FAILED:124,SYNCING:125});t.WebMessageInfoStubType=o;var u=r(28103)({ERROR:0,PENDING:1,SERVER_ACK:2,DELIVERY_ACK:3,READ:4,PLAYED:5});t.WebMessageInfoStatus=u;var l=r(28103)({UNKNOWN:0,PENDING_SETUP:1,PENDING_RECEIVER_SETUP:2,INIT:3,SUCCESS:4,COMPLETED:5,FAILED:6,FAILED_RISK:7,FAILED_PROCESSING:8,FAILED_RECEIVER_PROCESSING:9,FAILED_DA:10,FAILED_DA_FINAL:11,REFUNDED_TXN:12,REFUND_FAILED:13,REFUND_FAILED_PROCESSING:14,REFUND_FAILED_DA:15,EXPIRED_TXN:16,AUTH_CANCELED:17,AUTH_CANCEL_FAILED_PROCESSING:18,AUTH_CANCEL_FAILED:19,COLLECT_INIT:20,COLLECT_SUCCESS:21,COLLECT_FAILED:22,COLLECT_FAILED_RISK:23,COLLECT_REJECTED:24,COLLECT_EXPIRED:25,COLLECT_CANCELED:26,COLLECT_CANCELLING:27,IN_REVIEW:28});t.PaymentInfoTxnStatus=l;var d=r(28103)({UNKNOWN_STATUS:0,PROCESSING:1,SENT:2,NEED_TO_ACCEPT:3,COMPLETE:4,COULD_NOT_COMPLETE:5,REFUNDED:6,EXPIRED:7,REJECTED:8,CANCELLED:9,WAITING_FOR_PAYER:10,WAITING:11});t.PaymentInfoStatus=d;var c=r(28103)({UNKNOWN_CURRENCY:0,INR:1});t.PaymentInfoCurrency=c;var f=r(28103)({NOT_STARTED:0,FORCE_UPGRADE:1,DEVELOPMENT:2,PRODUCTION:3});t.WebFeaturesFlag=f;var p={};t.WebMessageInfoSpec=p;var h={};t.PaymentInfoSpec=h;var _={};t.WebNotificationsInfoSpec=_;var m={};t.NotificationMessageInfoSpec=m;var g={};t.WebFeaturesSpec=g;var v={};t.MediaDataSpec=v;var E={};t.PhotoChangeSpec=E,p.internalDefaults={status:u.PENDING},p.internalSpec={key:[1,i.FLAGS.REQUIRED|i.TYPES.MESSAGE,n.MessageKeySpec],message:[2,i.TYPES.MESSAGE,a.MessageSpec],messageTimestamp:[3,i.TYPES.UINT64],status:[4,i.TYPES.ENUM,u],participant:[5,i.TYPES.STRING],messageC2STimestamp:[6,i.TYPES.UINT64],ignore:[16,i.TYPES.BOOL],starred:[17,i.TYPES.BOOL],broadcast:[18,i.TYPES.BOOL],pushName:[19,i.TYPES.STRING],mediaCiphertextSha256:[20,i.TYPES.BYTES],multicast:[21,i.TYPES.BOOL],urlText:[22,i.TYPES.BOOL],urlNumber:[23,i.TYPES.BOOL],messageStubType:[24,i.TYPES.ENUM,o],clearMedia:[25,i.TYPES.BOOL],messageStubParameters:[26,i.FLAGS.REPEATED|i.TYPES.STRING],duration:[27,i.TYPES.UINT32],labels:[28,i.FLAGS.REPEATED|i.TYPES.STRING],paymentInfo:[29,i.TYPES.MESSAGE,h],finalLiveLocation:[30,i.TYPES.MESSAGE,a.LiveLocationMessageSpec],quotedPaymentInfo:[31,i.TYPES.MESSAGE,h],ephemeralStartTimestamp:[32,i.TYPES.UINT64],ephemeralDuration:[33,i.TYPES.UINT32],ephemeralOffToOn:[34,i.TYPES.BOOL],ephemeralOutOfSync:[35,i.TYPES.BOOL],bizPrivacyStatus:[36,i.TYPES.ENUM,s],verifiedBizName:[37,i.TYPES.STRING],mediaData:[38,i.TYPES.MESSAGE,v],photoChange:[39,i.TYPES.MESSAGE,E]},h.internalSpec={currencyDeprecated:[1,i.TYPES.ENUM,c],amount1000:[2,i.TYPES.UINT64],receiverJid:[3,i.TYPES.STRING],status:[4,i.TYPES.ENUM,d],transactionTimestamp:[5,i.TYPES.UINT64],requestMessageKey:[6,i.TYPES.MESSAGE,n.MessageKeySpec],expiryTimestamp:[7,i.TYPES.UINT64],futureproofed:[8,i.TYPES.BOOL],currency:[9,i.TYPES.STRING],txnStatus:[10,i.TYPES.ENUM,l],useNoviFiatFormat:[11,i.TYPES.BOOL],primaryAmount:[12,i.TYPES.MESSAGE,a.MoneySpec],exchangeAmount:[13,i.TYPES.MESSAGE,a.MoneySpec]},_.internalSpec={timestamp:[2,i.TYPES.UINT64],unreadChats:[3,i.TYPES.UINT32],notifyMessageCount:[4,i.TYPES.UINT32],notifyMessages:[5,i.FLAGS.REPEATED|i.TYPES.MESSAGE,p]},m.internalSpec={key:[1,i.TYPES.MESSAGE,n.MessageKeySpec],message:[2,i.TYPES.MESSAGE,a.MessageSpec],messageTimestamp:[3,i.TYPES.UINT64],participant:[4,i.TYPES.STRING]},g.internalSpec={labelsDisplay:[1,i.TYPES.ENUM,f],voipIndividualOutgoing:[2,i.TYPES.ENUM,f],groupsV3:[3,i.TYPES.ENUM,f],groupsV3Create:[4,i.TYPES.ENUM,f],changeNumberV2:[5,i.TYPES.ENUM,f],queryStatusV3Thumbnail:[6,i.TYPES.ENUM,f],liveLocations:[7,i.TYPES.ENUM,f],queryVname:[8,i.TYPES.ENUM,f],voipIndividualIncoming:[9,i.TYPES.ENUM,f],quickRepliesQuery:[10,i.TYPES.ENUM,f],payments:[11,i.TYPES.ENUM,f],stickerPackQuery:[12,i.TYPES.ENUM,f],liveLocationsFinal:[13,i.TYPES.ENUM,f],labelsEdit:[14,i.TYPES.ENUM,f],mediaUpload:[15,i.TYPES.ENUM,f],mediaUploadRichQuickReplies:[18,i.TYPES.ENUM,f],vnameV2:[19,i.TYPES.ENUM,f],videoPlaybackUrl:[20,i.TYPES.ENUM,f],statusRanking:[21,i.TYPES.ENUM,f],voipIndividualVideo:[22,i.TYPES.ENUM,f],thirdPartyStickers:[23,i.TYPES.ENUM,f],frequentlyForwardedSetting:[24,i.TYPES.ENUM,f],groupsV4JoinPermission:[25,i.TYPES.ENUM,f],recentStickers:[26,i.TYPES.ENUM,f],catalog:[27,i.TYPES.ENUM,f],starredStickers:[28,i.TYPES.ENUM,f],voipGroupCall:[29,i.TYPES.ENUM,f],templateMessage:[30,i.TYPES.ENUM,f],templateMessageInteractivity:[31,i.TYPES.ENUM,f],ephemeralMessages:[32,i.TYPES.ENUM,f],e2ENotificationSync:[33,i.TYPES.ENUM,f],recentStickersV2:[34,i.TYPES.ENUM,f],recentStickersV3:[36,i.TYPES.ENUM,f],userNotice:[37,i.TYPES.ENUM,f],support:[39,i.TYPES.ENUM,f],groupUiiCleanup:[40,i.TYPES.ENUM,f],groupDogfoodingInternalOnly:[41,i.TYPES.ENUM,f],settingsSync:[42,i.TYPES.ENUM,f],archiveV2:[43,i.TYPES.ENUM,f],ephemeralAllowGroupMembers:[44,i.TYPES.ENUM,f],ephemeral24HDuration:[45,i.TYPES.ENUM,f],mdForceUpgrade:[46,i.TYPES.ENUM,f]},v.internalSpec={localPath:[1,i.TYPES.STRING]},E.internalSpec={oldPhoto:[1,i.TYPES.BYTES],newPhoto:[2,i.TYPES.BYTES],newPhotoId:[3,i.TYPES.UINT32]}},95595:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.setMe=function(e){var t=r(18120).default;t.supportsFeature(t.F.MD_BACKEND)?m._set(f.default.KEY_LAST_WID_MD,e):m._set(f.default.KEY_LAST_WID,e)},t.getMe=P,t.assertGetMe=O,t.assertGetMeUser=function(){return(0,_.default)(w(),"meUser")},t.getMeUser=w,t.getMaybeMeUser=function(){var e=P();return e?(0,E.toUserWid)(e):void 0},t.setPushname=function(e){m._setUser(f.default.KEY_LAST_PUSHNAME,e)},t.getPushname=function(){return m._getUser(f.default.KEY_LAST_PUSHNAME)},t.getLoginTokens=M,t.setLoginTokens=function(e){var t=e.client,r=e.server;t&&r&&!(0,l.default)(t)&&(__LOG__(2)(S()),m._set(f.default.KEY_CLIENT_TOKEN,t),m._set(f.default.KEY_SERVER_TOKEN,r))},t.knowsPhone=function(){var e=M();return!(!e.client||!e.server)},t.setRefTok=function(e,t){I(),m.setRefTokCookies(e,t)},t.clearDeprecatedKeys=I,t.mdOptedIn=function(){return m._get(f.default.KEY_MD_OPTED_IN,p.default.permanentStorage)},t.setMdOptedIn=function(e){m._set(f.default.KEY_MD_OPTED_IN,e,p.default.permanentStorage)},t.getSecretBundle=function(){var e=m._get(f.default.KEY_SECRET_BUNDLE);if(!e)return __LOG__(3)(y()),null;"string"==typeof e&&(e=JSON.parse(e));return(0,u.default)(e,d.decodeB64)},t.setSecretBundle=function(e){return m._set(f.default.KEY_SECRET_BUNDLE,(0,u.default)(e,d.encodeB64))},t.clearTokens=function(){T.forEach((e=>{m._set(e,void 0)}))},t.shouldShowNUX=function(e){var t=R(e);return!t||t.views<t.maxViews},t.viewNUX=function(e){var t=R(e);if(!t)throw new Error("UserPrefs:viewNUX key "+e+" does not exist");D(e,{views:t.views+1,maxViews:t.maxViews})},t.getNUX=R,t.setNUX=D,t.removeNUX=function(e){m._setUser(e)},t.getUnknownId=function(){var e=m._get(f.default.KEY_UNKNOWN_ID);e||N(e="unknown"+Math.floor(1e10*Math.random()));return e},t.setUnknownId=N,t.getBrowserId=function(){return m._get(f.default.KEY_BROWSER_ID)},t.setBrowserId=function(e){m._set(f.default.KEY_BROWSER_ID,e)},t.getLastMobilePlatform=function(){return m._get(f.default.KEY_MOBILE_PLATFORM)},t.setLastMobilePlatform=function(e){m._set(f.default.KEY_MOBILE_PLATFORM,e)},t.setLastChatMuteDuration=function(e){m._setUser(f.default.KEY_LAST_CHAT_MUTE_DURATION,e)},t.getLastChatMuteDuration=function(){return m._getUser(f.default.KEY_LAST_CHAT_MUTE_DURATION)},t.setTheme=function(e){m._set(f.default.KEY_THEME,e)},t.getTheme=function(){return m._get(f.default.KEY_THEME)},t.setSystemThemeMode=function(e){m._set(f.default.KEY_SYSTEM_THEME_MODE,e)},t.getSystemThemeMode=function(){return m._get(f.default.KEY_SYSTEM_THEME_MODE)},t.setLastComposeBoxPanel=function(e){m._setUser(f.default.KEY_LAST_SELECTED_COMPOSE_BOX_PANEL,e)},t.getLastComposeBoxPanel=function(){return m._getUser(f.default.KEY_LAST_SELECTED_COMPOSE_BOX_PANEL)},t.setSeenGroupDesc=function(e){m._setUser(e.toString(),!0)},t.getSeenGroupDesc=function(e){return m._getUser(e.toString())},t.getGlobalSounds=function(){return!m._getUser(f.default.KEY_GLOBAL_MUTE_SOUNDS)},t.setGlobalSounds=function(e){m._setUser(f.default.KEY_GLOBAL_MUTE_SOUNDS,!e)},t.getGlobalNotifications=function(){return!m._getUser(f.default.KEY_GLOBAL_MUTE_NOTIFICATIONS)},t.setGlobalNotifications=function(e){m._setUser(f.default.KEY_GLOBAL_MUTE_NOTIFICATIONS,!e)},t.getGlobalSecurityNotifications=function(){return!m._getUser(f.default.KEY_SECURITY_NOTIFICATIONS)},t.setGlobalSecurityNotifications=function(e){m._setUser(f.default.KEY_SECURITY_NOTIFICATIONS,!e)},t.getUserPrivacySettings=function(){return m._getUser(f.default.KEY_USER_PRIVACY_SETTINGS)},t.setUserPrivacySettings=function(e){m._setUser(f.default.KEY_USER_PRIVACY_SETTINGS,e)},t.getGlobalPreviews=function(){return!m._getUser(f.default.KEY_GLOBAL_MUTE_PREVIEWS)},t.setGlobalPreviews=function(e){m._setUser(f.default.KEY_GLOBAL_MUTE_PREVIEWS,!e)},t.getCollapseMuted=function(){return m._getUser(f.default.KEY_GLOBAL_COLLAPSE_MUTED)},t.setCollapseMuted=function(e){m._setUser(f.default.KEY_GLOBAL_COLLAPSE_MUTED,e)},t.getGeocoderLocation=function(){return m._getUser(f.default.KEY_GEOCODER_LOCATION)},t.setGeocoderLocation=function(e){m._setUser(f.default.KEY_GEOCODER_LOCATION,e)},t.getMapsOverQuota=function(){return m._get(f.default.KEY_GMAPS_OVER_LIMIT)},t.setMapsOverQuota=function(e){m._set(f.default.KEY_GMAPS_OVER_LIMIT,e)},t.setSmbLabelPalette=function(e){m._set(f.default.KEY_SMB_LABEL_COLOR_PALETTE,e)},t.getSmbLabelPalette=function(){return m._getUser(f.default.KEY_SMB_LABEL_COLOR_PALETTE)},t.getGroupParticipantAssignedColor=function(e){return m._getUser(f.default.KEY_GROUP_ASSIGNED_COLOR+"-"+e.toString())},t.setGroupParticipantAssignedColor=function(e,t){m._setUser(f.default.KEY_GROUP_ASSIGNED_COLOR+"-"+e.toString(),t)},t.getMutex=function(){return m._getPSIgnoringCache(f.default.KEY_WHATSAPP_MUTEX)},t.setMutex=function(e){var t=e?A+":"+e:e;m._setPS(f.default.KEY_WHATSAPP_MUTEX,t)},t.removeMutex=function(){m._setPS(f.default.KEY_WHATSAPP_MUTEX)},t.parseMutex=function(e){var t=e?JSON.parse(e):"";return t?t.toString().split(/:/).pop():t},t.mutexFilter=function(e){if(e.key!==f.default.KEY_WHATSAPP_MUTEX)return!1;return!(e.newValue||"").includes(A)},t.localTakeoverSuccess=function(){var e=m.getRememberMe()?{}:(0,o.default)(m._getAllKeyValues(),g.LS_ONLY_KEYS);e.wa_tab_src=A,(0,_.default)(h.default,"localStorage").setItem(f.default.KEY_LOCAL_TAKEOVER_OK,JSON.stringify(e)),(0,_.default)(h.default,"localStorage").removeItem(f.default.KEY_LOCAL_TAKEOVER_OK)},t.parseTakeover=function(e){var t=e?JSON.parse(e):{};return(0,s.default)(t)?(delete t.wa_tab_src,t):{}},t.takeoverFilter=function(e){if(e.key!==f.default.KEY_LOCAL_TAKEOVER_OK)return!1;return!(e.newValue||"").includes(A)},t.getLangPref=function(){return m._get(f.default.KEY_LANG)},t.setLangPref=function(e){m._set(f.default.KEY_LANG,e)},t.getLogoutToken=function(){return m._getPS(f.default.KEY_LOGOUT_TOKEN)},t.setLogoutToken=function(e){m._setPS(f.default.KEY_LOGOUT_TOKEN,e)},t.getOldLogoutCreds=function(){return m._getPS(f.default.KEY_OLD_LOGOUT_CREDS)||[]},t.setOldLogoutCreds=function(e){m._setPS(f.default.KEY_OLD_LOGOUT_CREDS,e)},t.setNoTakeover=function(e){m._setTS(f.default.KEY_NO_TAKEOVER,e)},t.getNoTakeover=function(){return m._getTS(f.default.KEY_NO_TAKEOVER)},t.getWamBuffer=function(){return m._get(f.default.KEY_WAM_BUFFER,void 0,!0)},t.setWamBuffer=function(e){m._set(f.default.KEY_WAM_BUFFER,e,void 0,!0)},t.getWamInfo=function(){return m._get(f.default.KEY_WAM_INFO)},t.setWamInfo=function(e){m._set(f.default.KEY_WAM_INFO,e)},t.setVideoVolumeSettings=function(e,t){L(e),k(t)},t.setVideoVolumeSetting=L,t.setVideoMutedSetting=k,t.getVideoVolumeSettings=function(){return{volume:m._get(f.default.KEY_VIDEO_VOLUME),muted:!!m._get(f.default.KEY_VIDEO_MUTE)}},t.setComposeContents=function(e,t){m._setUserSession(U(e),t)},t.getComposeContents=function(e){return m._getUserSession(U(e))},t.deleteComposeContents=function(e){m._clearUserSessionItem(U(e))},t.setVersion=function(e){null!=e&&m._set(f.default.KEY_PROTO_VERSION,e)},t.getVersion=function(){return m._get(f.default.KEY_PROTO_VERSION)},t.setContactChecksum=function(e){m._setUser(f.default.KEY_CONTACT_CHECKSUM,e)},t.getContactChecksum=function(){return m._getUser(f.default.KEY_CONTACT_CHECKSUM)},t.getNoticeBannerClosedAt=function(){return m._getUser(f.default.KEY_NOTICE_BANNER_CLOSED_AT)},t.setNoticeBannerClosedAt=function(e){m._setUser(f.default.KEY_NOTICE_BANNER_CLOSED_AT,e)},t.getNoticeId=function(){return m._getUser(f.default.KEY_NOTICE_ID)},t.setNoticeId=function(e){m._setUser(f.default.KEY_NOTICE_ID,e)},t.getPttPlaybackRate=function(){var e;return null!==(e=m._get(f.default.KEY_PTT_PLAYBACK_RATE))&&void 0!==e?e:1},t.setPttPlaybackRate=function(e){m._set(f.default.KEY_PTT_PLAYBACK_RATE,e)},t.getLastStatusUsage=function(){return m._getUser(f.default.LAST_STATUS_USAGE)},t.setLastStatusUsage=function(){m._setUser(f.default.LAST_STATUS_USAGE,Date.now())},t.getOutgoingMessageSound=function(){return m._getUser(f.default.KEY_OUTGOING_MESSAGE_SOUND)},t.setOutgoingMessageSound=function(e){m._setUser(f.default.KEY_OUTGOING_MESSAGE_SOUND,e)},t.getHistorySyncEarliestDate=function(){var e=m._get(f.default.KEY_HISTORY_SYNC_EARLIEST_DATE);if(!e)return F((0,c.unixTime)());return e},t.setHistorySyncEarliestDate=F,Object.defineProperty(t,"getRememberMe",{enumerable:!0,get:function(){return m.getRememberMe}}),Object.defineProperty(t,"setRememberMe",{enumerable:!0,get:function(){return m.setRememberMe}}),Object.defineProperty(t,"clearAllLocalState",{enumerable:!0,get:function(){return m.clearAllLocalState}}),Object.defineProperty(t,"clearAllTemporaryStorageData",{enumerable:!0,get:function(){return m.clearAllTemporaryStorageData}}),Object.defineProperty(t,"_setAllKeyValues",{enumerable:!0,get:function(){return m._setAllKeyValues}}),Object.defineProperty(t,"getCollection",{enumerable:!0,get:function(){return m.getCollection}}),Object.defineProperty(t,"setCollection",{enumerable:!0,get:function(){return m.setCollection}}),t.thisTabId=void 0;var i=n(r(19976)),s=n(r(29259)),o=n(r(17620)),u=n(r(34519)),l=n(r(84336)),d=r(60339),c=r(71684),f=n(r(50935)),p=n(r(77771)),h=n(r(80521)),_=n(r(61941)),m=a(r(25529)),g=r(95037),v=n(r(68384)),E=r(75637);function y(){var e=(0,i.default)(["UserPrefs:Attempted to load non-existent secret bundle!"]);return y=function(){return e},e}function S(){var e=(0,i.default)(["UserPrefs:setLoginTokens"]);return S=function(){return e},e}var T=[f.default.KEY_LOGOUT_TOKEN,f.default.KEY_CLIENT_TOKEN,f.default.KEY_SERVER_TOKEN,f.default.KEY_SECRET_BUNDLE],b=[f.default.KEY_VERSION],A="x"+Math.round(1e9*Math.random()),C=A;function P(){var e=r(18120).default,t=null;return(t=e.supportsFeature(e.F.MD_BACKEND)?m._get(f.default.KEY_LAST_WID_MD):m._get(f.default.KEY_LAST_WID))&&v.default.isWid(t)?(0,E.createWid)(t):t}function O(){return(0,_.default)(P(),"me")}function w(){return(0,E.toUserWid)(O())}function M(){return{client:m._get(f.default.KEY_CLIENT_TOKEN),server:m._get(f.default.KEY_SERVER_TOKEN)}}function I(){b.forEach((function(e){p.default.permanentStorage.removeItem(e)}))}function R(e){return m._getUser(e)}function D(e,t){m._setUser(e,t)}function N(e){return m._set(f.default.KEY_UNKNOWN_ID,e)}function L(e){m._set(f.default.KEY_VIDEO_VOLUME,e)}function k(e){m._set(f.default.KEY_VIDEO_MUTE,e)}function U(e){return"".concat(f.default.KEY_COMPOSE_CONTENTS_PREFIX).concat(e.toString())}function F(e){var t=e-90*c.DAY_SECONDS;return m._set(f.default.KEY_HISTORY_SYNC_EARLIEST_DATE,t),t}t.thisTabId=C},65291:(e,t,r)=>{"use strict";var a=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.getContactChecksum=function(){return n._getUser(i)},t.setContactChecksum=function(e){n._setUser(i,e)},t.getFrequentContacts=function(){return n._getUser(s)},t.setFrequentContacts=function(e){n._setUser(s,e)},t.setGKFeatures=function(e){n._setUser(o,e)},t.getGKFeatures=function(){return n._getUser(o)},t.setGKProto=function(e){n._setUser(u,e)},t.getGKProto=function(){return n._getUser(u)},t.setHistoryInitialSyncBoundry=function(e){n._setUser(l,JSON.stringify(e))},t.getHistoryInitialSyncBoundry=function(){var e=n._getUser(l);try{return JSON.parse(e)}catch(e){return null}};var n=a(r(25529)),i="contact_checksum",s="frequent_contacts",o="gk_features",u="gk_proto",l="history_initial_sync_boundry"},39174:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.clearRegistrationInfo=function(){var e=[p,h,_,m,g,b];f.default.supportsFeature(f.default.F.MD_BACKEND)?e.push(u.default.KEY_LAST_WID_MD):e.push(u.default.KEY_LAST_WID);e.map((e=>{d._set(e,void 0)}))},t.setNoiseInfo=function(e){var t={recoveryToken:e.recoveryToken,pubKey:e.staticKeyPair.pubKey,privKey:e.staticKeyPair.privKey};return d._set(p,(0,s.default)(t,o.encodeB64))},t.getNoiseInfo=A,t.setRoutingInfo=function(e){var{domain:t,edgeRouting:r}=e,a={domain:t,edgeRouting:r?(0,o.encodeB64)(r):null};return d._set(m,a,l.default.permanentStorage)},t.getRoutingInfo=function(){var e=d._get(m,l.default.permanentStorage);if(e){var{domain:t,edgeRouting:r}=e;return{domain:t,edgeRouting:r?(0,o.decodeB64)(r):null}}return null},t.setMdInternVersion=function(){},t.getMdInternVersion=function(){return},t.isRegistered=function(){return!(!A()||!c.getMe())},t.setInitialHistorySyncComplete=function(){return d._set(g,"true")},t.getInitialHistorySyncComplete=function(){return!!d._get(g,l.default.permanentStorage)},t.setWebEncSalt=function(e){return d._set(b,e)},t.getWebEncSalt=function(){return d._get(b,l.default.permanentStorage)},t.setHistorySyncStatus=function(e){var t,r=null!==(t=C())&&void 0!==t?t:{};d._set(E,(0,i.default)((0,i.default)({},r),e))},t.getHistorySyncStatus=C,t.setAllCriticalDataSynced=function(){return d._set(v,!0)},t.getAllCriticalDataSynced=function(){return!!d._get(v,l.default.permanentStorage)},t.setADVSecretKey=function(e){return d._set(y,e)},t.getADVSecretKey=function(){return d._get(y)},t.setBlocklistHash=function(e){return d._set(S,e)},t.getBlocklistHash=function(){return d._get(S)},t.addDebugContact=function(){},t.getDebugContact=function(){},t.setDebugReadReceipt=function(){},t.getDebugReadReceipt=function(){},t.setDebugPassiveMode=function(){},t.getDebugPassiveMode=function(){},t.setDebugEnableOfflineMock=function(){},t.getDebugEnableOfflineMock=function(){return!1},t.setDebugStanzaFilter=function(){},t.getDebugStanzaFilter=function(){},t.setDebugDecryptFail=function(){},t.getDebugDecryptFail=function(){},t.setDebugRoutingToken=function(){},t.getDebugRoutingToken=function(){},t.setDebugShownMsgs=function(){},t.setDebugDisableHistorySyncTimeout=function(){},t.getDebugDisableHistorySyncTimeout=function(){return!1},t.getDebugShownMsgs=function(){return{}},t.setShouldCheckContactSyncStatus=function(){return d._set(T,!0)},t.getShouldCheckContactSyncStatus=function(){return!!d._get(T)};var i=n(r(70417)),s=n(r(34519)),o=r(60339),u=n(r(50935)),l=n(r(77771)),d=a(r(25529)),c=a(r(95595)),f=n(r(18120)),p=(r(52098),"WANoiseInfo"),h="WAMeInfo",_="WADeviceId",m="WARoutingInfo",g="WaInitialHistorySynced",v="critical_data_synced",E="WAHistorySyncStatus",y="WaADVSecretKey",S="WABlocklistHash",T="WAShouldCheckContactSyncStatus",b="WebEncKeySalt";function A(){var e=d._get(p);if(!e)return null;var t=(0,s.default)(e,o.decodeB64);return{recoveryToken:t.recoveryToken,staticKeyPair:{pubKey:t.pubKey,privKey:t.privKey}}}function C(){return d._get(E)}},25529:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.setRefTokCookies=function(e,t){if(void 0===self.document)return;f.setCookie({name:c.default.COOKIE_REF,value:e,path:c.default.PP_REF,domain:c.default.COOKIE_DOMAIN,secure:!0});var r={name:c.default.COOKIE_TOK,value:t,path:c.default.PP_TOK,domain:c.default.COOKIE_DOMAIN,secure:!0};f.setCookie(r)},t._getKeys=P,t._setKeys=O,t._getAllKeyValues=function(){var e=U();return(0,u.default)(Object.keys(e).map((function(t){return[t,e.getItem(t)]})))},t._setAllKeyValues=function(e){var t=U();Object.keys(e).forEach((function(r){null!=e[r]&&t.setItem(r,e[r])}))},t.clearAllLocalState=function(){return M.apply(this,arguments)},t.clearAllTemporaryStorageData=function(){p.default.temporaryStorage.clear()},t._getPS=I,t._getPSIgnoringCache=function(e){return F(e,p.default.permanentStorage,!1,!0)},t._setPS=R,t._getTS=function(e){return F(e,p.default.temporaryStorage)},t._setTS=function(e,t){G(e,t,p.default.temporaryStorage)},t._setUserSession=function(e,t){var r=N();if(!r)return void __LOG__(3)(A());G((0,m.default)(x(r.toString(),e)),t,p.default.temporaryStorage)},t._getUserSession=function(e){var t=N();if(!t)return __LOG__(3)(b()),null;return F((0,m.default)(x(t.toString(),e)),p.default.temporaryStorage)},t._clearUserSessionItem=function(e){var t=N();if(!t)return void __LOG__(3)(T());var r=(0,m.default)(x(t.toString(),e));p.default.temporaryStorage.removeItem(r)},t.getRememberMe=D,t.setRememberMe=function(e){var t=!!e;if(t===D())return;__LOG__(2)(S(),String(t));var r=U();R(c.default.KEY_REMEMBER_ME,t);var a=U();if(r!==a){(0,o.default)(Object.keys(r.dataStore),g.LS_ONLY_KEYS.concat(g.LS_PRESERVE_KEYS)).forEach((function(e){var t=r.getItem(e);null!=t&&(a.setItem(e,t),r.removeItem(e))}))}t||_.default.clearLogs()},t.getCollection=function(e){return L(e)},t.setCollection=function(e,t,r=!1){null==N()||r||k(e,t)},t._getMe=N,t._getUser=L,t._setUser=k,t._storage=U,t._get=F,t._set=G;var i=n(r(19976)),s=n(r(52954)),o=n(r(17335)),u=n(r(10017)),l=n(r(15253)),d=n(r(46150)),c=n(r(50935)),f=a(r(80533)),p=a(r(77771)),h=n(r(80737)),_=n(r(15410)),m=n(r(68560)),g=r(95037);function v(){var e=(0,i.default)(["userPrefs:_get(",") '","' ",""]);return v=function(){return e},e}function E(){var e=(0,i.default)(["userPrefs: Me has not loaded yet."]);return E=function(){return e},e}function y(){var e=(0,i.default)(["userPrefs: Me has not loaded yet."]);return y=function(){return e},e}function S(){var e=(0,i.default)(["UserPrefs:setRememberMe: ",""]);return S=function(){return e},e}function T(){var e=(0,i.default)(["userPrefs: Me has not loaded yet."]);return T=function(){return e},e}function b(){var e=(0,i.default)(["userPrefs: Me has not loaded yet."]);return b=function(){return e},e}function A(){var e=(0,i.default)(["userPrefs: Me has not loaded yet."]);return A=function(){return e},e}function C(){void 0!==self.document&&(f.setCookie({name:c.default.COOKIE_REF,expirationDate:0,domain:c.default.COOKIE_DOMAIN,path:c.default.PP_REF}),f.setCookie({name:c.default.COOKIE_TOK,expirationDate:0,domain:c.default.COOKIE_DOMAIN,path:c.default.PP_TOK}))}function P(e,t,r=!1){return(0,d.default)(t,t.map((t=>e.getItem(t,r))))}function O(e,t){(0,l.default)(t,(function(t,r){e.setItem(r,t)}))}function w(){return P(p.default.permanentStorage,g.LS_PRESERVE_KEYS,!0)}function M(){return(M=(0,s.default)((function*(){var e=w();yield Promise.all([p.default.temporaryStorage.clear(),p.default.permanentStorage.clear(e)]),C(),_.default.clearLogs()}))).apply(this,arguments)}function I(e){return F(e,p.default.permanentStorage)}function R(e,t){G(e,t,p.default.permanentStorage)}function D(){var e=I(c.default.KEY_REMEMBER_ME),t=r(18120).default;return t.supportsFeature(t.F.MD_BACKEND)&&!1===e&&(e=!0,R(c.default.KEY_REMEMBER_ME,!0)),null===e&&(e=!0,R(c.default.KEY_REMEMBER_ME,!0)),!!e}function N(){return r(95595).getMaybeMeUser()}function L(e){var t=N();return t?F((0,m.default)(x(t.toString(),e))):(__LOG__(3)(y()),null)}function k(e,t){var r=N();r?G((0,m.default)(x(r.toString(),e)),t):__LOG__(3)(E())}function U(){return D()?p.default.permanentStorage:p.default.temporaryStorage}function F(e,t=U(),a=!1,n=!1){if(null==e)throw new Error("_get called with no key");var i=t.getItem(e,n);if(a||null==i)return i;try{return JSON.parse(i,h.default)}catch(a){return __LOG__(2)(v(),e,a,i),r(3594).upload({reason:"userprefs-parse-error"}),void t.removeItem(e)}}function G(e,t,r=U(),a=!1){if(null==e)throw new Error("_set called with no key");if(null==t)r.removeItem(e);else if(a){if("string"!=typeof t)throw new Error("_set: expecting string because isRawString is true");r.setItem(e,t)}else r.setItem(e,JSON.stringify(t))}function x(e,t){return[e,t].join(":")}},95037:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.LS_PRESERVE_KEYS=t.LS_ONLY_KEYS=void 0;var n=a(r(50935)),i=[n.default.KEY_LOG_CURSOR,n.default.KEY_WHATSAPP_MUTEX,n.default.KEY_REMEMBER_ME,n.default.KEY_WHATSAPP_LS_VERSION];t.LS_ONLY_KEYS=i;var s=[n.default.KEY_WHATSAPP_MUTEX,n.default.KEY_REMEMBER_ME,n.default.KEY_OLD_LOGOUT_CREDS,n.default.KEY_MD_OPTED_IN];t.LS_PRESERVE_KEYS=s},86091:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return Promise.resolve(!1)}},25046:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.generateICELiteAnswerSDP=function(e,t,r,s,o,u,l){var d=(v=e,v.ip.join(".")),c=e.port+1,f=new TextDecoder,p=(0,a.encodeB64)(t),h=f.decode(r),_=(0,a.encodeB64)(u),m=(new Date).getTime(),g="v=0\no=- ".concat(m," ").concat(2," IN IP4 127.0.0.1\ns=-\nt=0 0\na=group:BUNDLE 0").concat(l?" 1":"","\na=ice-lite\na=msid-semantic: WMS g1noOjzcjYNgtJfnKdCzBmyvTozKsCGWCleP\nm=audio ").concat(c," RTP/SAVPF ").concat(n,"\nc=IN IP4 ").concat(d,"\na=rtcp:9 IN IP4 0.0.0.0\na=candidate:1152096416 1 udp 2113937151 ").concat(d," ").concat(c," typ host generation 0 network-cost 999\na=ice-ufrag:").concat(p,"\na=ice-pwd:").concat(h,"\na=ice-options:trickle\na=setup:active\na=mid:0\na=extmap:13 http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01\na=sendrecv\na=msid:g1noOjzcjYNgtJfnKdCzBmyvTozKsCGWCleP df375ff4-7ed5-459d-b991-76c8e47ffc52\na=rtcp-mux\na=crypto:0 AES_CM_128_HMAC_SHA1_32 inline:").concat(_,"\na=rtpmap:").concat(n," opus/48000/2\na=rtcp-fb:").concat(n," goog-remb\na=rtcp-fb:").concat(n," transport-cc\na=ssrc:").concat(s," cname:noAs9WOptAnM/+QP\n");var v;l&&(g+="m=video ".concat(c," RTP/SAVP ").concat(i,"\nc=IN IP4 ").concat(d,"\na=rtcp:9 IN IP4 0.0.0.0\na=candidate:1152096416 1 udp 2113937151 ").concat(d," ").concat(c," typ host generation 0 network-cost 999\na=ice-ufrag:").concat(p,"\na=ice-pwd:").concat(h,"\na=ice-options:trickle\na=mid:1\na=extmap:12 urn:3gpp:video-orientation\na=extmap:13 http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01\na=sendrecv\na=msid:ZhweKKCOEinfZyYuSPSvnC7upm9Zs0IIaRYb 629eaf55-18ca-47ed-8bfe-98dfd17c0bc9\na=rtcp-mux\na=crypto:0 AES_CM_128_HMAC_SHA1_32 inline:").concat(_,"\na=rtpmap:").concat(i," VP8/90000\na=rtcp-fb:").concat(i," nack\na=rtcp-fb:").concat(i," nack pli\na=rtcp-fb:").concat(i," goog-remb\na=rtcp-fb:").concat(i," transport-cc\na=ssrc:").concat(o," cname:rcpcNyS/Kejuq2+Y\n"));return{type:"answer",sdp:g}},t.modifyOfferSDP=function(e,t,r,n,i){var s=e;if(s=(s=(s=s.replace(/ice-ufrag:\S+/g,"ice-ufrag:wa-web")).replace(/ice-pwd:\S+/g,"ice-pwd:CplKUv1mtNXWrv0ZzQkHX3TF")).replace(/a=crypto:.*/g,"a=crypto:0 AES_CM_128_HMAC_SHA1_32 inline:".concat((0,a.encodeB64)(n))),i){var o=s.search(/m=video/g),u=s.substring(0,o),l=s.substring(o);u=u.replace(/ssrc:\S+/g,"ssrc:".concat(t)),l=l.replace(/ssrc:\S+/g,"ssrc:".concat(r)),s=u+l}else s=s.replace(/ssrc:\S+/g,"ssrc:".concat(t));return s};var a=r(60339),n=111,i=102},64786:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.checkVoipCapability=function(){return Promise.resolve(!1)},t.default=void 0;var i=n(r(52954)),s=n(r(70417)),o=n(r(19976)),u=n(r(79504)),l=r(95595),d=n(r(68476)),c=a(r(55273)),f=r(72502),p=n(r(49213)),h=r(25046),_=r(92565),m=n(r(43711)),g=a(r(31558));function v(){var e=(0,o.default)(["voip:recv:offerAck: Unknown status:",""]);return v=function(){return e},e}function E(){var e=(0,o.default)(["voip:recv:offer_ack: phone_busy"]);return E=function(){return e},e}function y(){var e=(0,o.default)(["voip:recv:offer_ack: no payload"]);return y=function(){return e},e}function S(){var e=(0,o.default)(["voip:recv:offerAck:"]);return S=function(){return e},e}function T(){var e=(0,o.default)(["voip:send:offer: payload:"]);return T=function(){return e},e}function b(){var e=(0,o.default)(["voip:recieved-track"]);return b=function(){return e},e}function A(){var e=(0,o.default)(["voip:generated-answer: ",""]);return A=function(){return e},e}function C(){var e=(0,o.default)(["voip:modified-offer: ",""]);return C=function(){return e},e}function P(){var e=(0,o.default)(["voip:original-offer: ",""]);return P=function(){return e},e}function O(){var e=(0,o.default)(["voip:generateId: ",""]);return O=function(){return e},e}function w(){var e=(0,o.default)(['voip:handleIncomingSignalingMsg: type: "','" msg: ']);return w=function(){return e},e}function M(){var e=(0,o.default)(["voip:callStart: "," video: ",""]);return M=function(){return e},e}function I(){var e=(0,o.default)(["voip:init"]);return I=function(){return e},e}var R=null,D={type:"none"},N={init:()=>(__LOG__(2)(I()),Promise.resolve(!1)),updateAudioVideoSwitch:()=>{},cleanup:()=>{},refresh:()=>{},callStart:(e,t)=>{if(__LOG__(2)(M(),e.toString(),t.toString()),!m.default.isVoiceCallEnabled&&!m.default.isVideoCallEnabled)throw new Error("voip:callStart: calling not enabled");!function(){Y.apply(this,arguments)}(e,t)},groupCallStart:()=>{},sendGroupCallInvite:()=>{},endCall:()=>{if("ongoing"===D.type){var e=D;!function(){j.apply(this,arguments)}(D.callId,D.peerJid),e.pc.close(),e.stream.getTracks().forEach((e=>e.stop())),D={type:"none"}}},callEndByHandledRemotely:()=>{},acceptCall:()=>{},rejectCall:()=>{},rejectCallWithoutCallCtx:()=>{},resendEncRekeyRetry:()=>{},processMissedIncomingCall:()=>{},mute:()=>{},videoTurnCameraOn:()=>{},videoTurnCameraOff:()=>{},videoStreamPause:()=>{},videoStreamResume:()=>{},videoRequestUpgrade:()=>{},videoAcceptUpgrade:()=>{},videoRejectUpgrade:()=>{},videoCancelUpgrade:()=>{},handleIncomingSignalingMessage:function(e,t){var r=g.TYPE_NAME[e.type];__LOG__(2)(w(),r);var a=u.default.get(e.call_id);if(null==a?void 0:a.canHandleLocally)switch(e.type){case g.TYPE.OFFER:throw new Error("Incoming call offer unimplemented.");case g.TYPE.OFFER_RECEIPT:case g.TYPE.ACCEPT_RECEIPT:return;case g.TYPE.MUTE:case g.TYPE.VIDEO_STATE:break;case g.TYPE.ACCEPT:"offer-sent"===D.type&&(D.pc.setRemoteDescription(D.answer),D=(0,s.default)((0,s.default)({},D),{},{type:"ongoing"}));break;case g.TYPE.REJECT:if("offer-sent"===D.type){var n=D;n.pc.close(),n.stream.getTracks().forEach((e=>e.stop())),D={type:"none"}}break;case g.TYPE.TERMINATE:if("ongoing"===D.type){var i=D;i.pc.close(),i.stream.getTracks().forEach((e=>e.stop())),D={type:"none"}}}else(0,_.handleIncomingSignalingMessage)(e,t)},isInitialized:()=>!0,registerVideoCallback:()=>{},cleanupVideoBuffer:()=>{},updateNetworkMedium:()=>{},registerWebRTCCallback:e=>{R=e},notifyDeviceIdentityChangedOrDeleted:()=>{},getNumParticipantsFromCallOffer:()=>Promise.resolve(-1)};function L(){return k.apply(this,arguments)}function k(){return(k=(0,i.default)((function*(e,t,r,a){var n=new TextDecoder,i=yield c.extract(e,t);return c.expand(i,n.decode(r),a)}))).apply(this,arguments)}function U(){return F.apply(this,arguments)}function F(){return(F=(0,i.default)((function*(e,t,r){var a=new TextEncoder,n=a.encode(e).buffer,i=a.encode(t).buffer,s=new Uint32Array([r]).buffer,o=yield L(n,s,i,32);return new Uint32Array(o)[0]}))).apply(this,arguments)}function G(){return x.apply(this,arguments)}function x(){return(x=(0,i.default)((function*(e,t){var r=new TextEncoder;return(yield L(e,c.DEFAULT_SALT,r.encode(t).buffer,46)).slice(0,30)}))).apply(this,arguments)}t.default=N;function B(){var e=new Uint8Array(32);return self.crypto.getRandomValues(e),e.buffer}function Y(){return(Y=(0,i.default)((function*(e,t){if(!d.default)throw new Error("Unable to request Media Devices.");var r=yield(0,d.default)({audio:!0,video:t}),a=(0,p.default)().substr(0,64);__LOG__(2)(O(),a);var n=B(),s=(0,l.getMaybeMeUser)(),o=yield U(a,s.toString({legacy:!0}),0),u=yield U(a,e.toString({legacy:!0}),0),c=yield U(a,s.toString({legacy:!0}),2),f=yield U(a,e.toString({legacy:!0}),2),_=yield G(n,s.toString({legacy:!0})),m=yield G(n,e.toString({legacy:!0})),g=new RTCPeerConnection({sdpSemantics:"unified-plan"},{mandatory:{},optional:[{DtlsSrtpKeyAgreement:!1},{RtpDataChannels:!0}]});g.onnegotiationneeded=(0,i.default)((function*(){var i=yield g.createOffer();__LOG__(2)(P(),i.sdp);var{token:l,key:d,relay:p}=yield z(n,s,e.toString({legacy:!0}),a,t);yield H(p,a,s,e.toString({legacy:!0})),i.sdp=(0,h.modifyOfferSDP)(i.sdp,o,c,_,t),__LOG__(2)(C(),i.sdp),yield g.setLocalDescription(i);var v=(0,h.generateICELiteAnswerSDP)(p,l,d,u,f,m,t);__LOG__(2)(A(),v.sdp),D={type:"offer-sent",pc:g,answer:v,stream:r,callId:a,peerJid:e.toString({legacy:!0})}})),g.ontrack=e=>{if(__LOG__(2)(b()),!R)throw new Error("No Track callback registered.");R(e)},null==r||r.getTracks().forEach((e=>g.addTrack(e,r)))}))).apply(this,arguments)}function K(e){return["terminate",{"call-id":e},null]}function j(){return(j=(0,i.default)((function*(e,t){var r=K(e),a=r[0];yield(0,f.sendCallSignalingMsg)({common:{type:a,call_id:e,call_creator_jid:"",peer_jid:t},payload:r})}))).apply(this,arguments)}function W(e,t,r,a){return["offer",{"call-id":t,"call-creator":r},[["audio",{enc:"opus",rate:"8000"},null],["audio",{enc:"opus",rate:"16000"},null]].concat(a?[["video",{orientation:"0",screen_width:"1920",screen_height:"1080",device_orientation:"0",enc:"vp8"},null]]:[]).concat([["net",{medium:"3"},null],["capability",{ver:"1"},[1,3,-1,-125,-33]],["enc",{count:"0"},Array.from(new Int8Array(e))],["encopt",{keygen:"2"},null]])]}function V(e,t,r){var a=new ArrayBuffer(6),n=new DataView(a);return n.setUint8(0,e.ip[0]),n.setUint8(1,e.ip[1]),n.setUint8(2,e.ip[2]),n.setUint8(3,e.ip[3]),n.setUint16(4,e.port),["relaylatency",{"call-id":t,"call-creator":r},[["te",{latency:"-99954"},Array.from(new Int8Array(a))]]]}function H(){return q.apply(this,arguments)}function q(){return(q=(0,i.default)((function*(e,t,r,a){var n=V(e,t,r),i=n[0];yield(0,f.sendCallSignalingMsg)({common:{type:i,call_id:t,call_creator_jid:"",peer_jid:a},payload:n})}))).apply(this,arguments)}function z(){return J.apply(this,arguments)}function J(){return(J=(0,i.default)((function*(e,t,r,a,n){var i=W(e,a,t,n),s=i[0];__LOG__(2)(T());var o=yield(0,f.sendCallOffer)({common:{type:s,call_id:a,call_creator_jid:"",peer_jid:r},payload:i});if(!o||!o.status)throw new Error("Error receiving Offer Ack.");switch(o.status){case 200:if(o.payload){__LOG__(2)(S());var u=null,l=null,d=null;for(var c of o.payload[2])if("relay"===c[0])for(var p of c[2])if("token"===p[0])u=new Uint8Array(p[2]);else if("key"===p[0])l=new Uint8Array(p[2]);else if("te2"===p[0]){var h=new Uint8Array(p[2]);if(6===h.length){var _=new DataView(h.buffer);d={ip:[_.getUint8(0),_.getUint8(1),_.getUint8(2),_.getUint8(3)],port:_.getUint16(4)}}}if(null==u)throw new Error("No relay token in Offer Ack");if(null==l)throw new Error("No relay key in Offer Ack");if(null==d)throw new Error("No relay server found in Offer Ack");return{token:u,key:l,relay:d}}throw __LOG__(2)(y()),new Error("Error receiving Offer Ack: No Payload");case 409:throw __LOG__(2)(E()),new Error("Error receiving Offer Ack: Phone Busy");default:throw __LOG__(2)(v(),status),new Error("Error receiving Offer Ack: Unknown status:".concat(status))}}))).apply(this,arguments)}},92565:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.handleIncomingSignalingMessage=function(e){var t=i.default.get(e.call_id);switch(e.type){case o.TYPE.OFFER:null==t||t.setState(s.CALL_STATES.INCOMING_RING);break;case o.TYPE.TERMINATE:null==t||t.setState(s.CALL_STATES.ENDED)}};var i=n(r(79504)),s=r(35205),o=a(r(31558))},43711:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(18120));var i={isVoiceCallEnabled:function(){return n.default.supportsFeature(n.default.F.WEB_VOIP_VOICE_CALL)},isVideoCallEnabled:function(){return n.default.supportsFeature(n.default.F.WEB_VOIP_VIDEO_CALL)},isGroupCallEnabled:function(){return!1,false}};t.default=i},31558:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ENC_RETRY_RECEIPT_ATTRS=t.TYPE_NAME=t.TYPE_STR=t.TYPE=void 0;t.TYPE={NONE:0,OFFER:1,OFFER_RECEIPT:2,ACCEPT:3,REJECT:4,TERMINATE:5,TRANSPORT:6,OFFER_ACK:7,OFFER_NACK:8,RELAY_LATENCY:9,RELAY_ELECTION:10,INTERRUPTION:11,MUTE:12,PREACCEPT:13,ACCEPT_RECEIPT:14,VIDEO_STATE:15,NOTIFY:16,GROUP_INFO:17,ENC_REKEY:18,PEER_STATE:19,VIDEO_STATE_ACK:20,FLOW_CONTROL:21,WEB_CLIENT:22,ACCEPT_ACK:23,GROUP_UPDATE:24,MAX:25};t.TYPE_STR={OFFER:"offer",ACCEPT:"accept",ENC_REKEY:"enc_rekey",REJECT:"reject",RECEIPT:"receipt"};t.TYPE_NAME=["NONE","OFFER","OFFER_RECEIPT","ACCEPT","REJECT","TERMINATE","TRANSPORT","OFFER_ACK","OFFER_NACK","RELAY_LATENCY","RELAY_ELECTION","INTERRUPTION","MUTE","PREACCEPT","ACCEPT_RECEIPT","VIDEO_STATE","NOTIFY","GROUP_INFO","ENC_REKEY","PEER_STATE","VIDEO_STATE_ACK","FLOW_CONTROL","WEB_CLIENT","ACCEPT_ACK","GROUP_UPDATE","MAX"];t.ENC_RETRY_RECEIPT_ATTRS={SINGLE_PARTICIPANT:"enc",GROUP_CALL:"enc_rekey_retry"}},35205:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CallNetworkMedium=t.ParticipantState=t.VideoUpgradeRequestEndedReason=t.VideoState=t.VoipSettingsType=t.CALL_LOG_RESULT_TYPE=t.CALL_LOG_RESULT=t.CALL_RESULT_TYPE=t.RENDERER_IPC_EVENTS=t.MAIN_IPC_EVENTS=t.VOIP_WINDOW_IPC_EVENTS=t.CALL_STATES=t.CALL_UI_STATES=t.WACallState=t.WACallEndReason=t.WAVideoCodecScheme=t.WACallEvent=void 0;t.WACallEvent={WANone:0,CallOfferSent:1,CallOfferReceived:2,CallOfferAckedWithRelayInfo:3,CallOfferNacked:4,CallOfferReceiptReceived:5,CallAcceptFailed:6,CallAcceptSent:7,CallAcceptReceived:8,CallPreacceptReceived:9,CallTerminateReceived:10,CallRejectReceived:11,CallOfferResend:12,AudioStreamStarted:13,P2PNegotiationSuccess:14,RelayCreateSuccess:15,CallStateChanged:16,P2PNegotiationFailed:17,MediaStreamError:18,AudioInitError:19,NoSamplingRatesForAudioRecord:20,SendOfferFailed:21,HandleOfferFailed:22,SendAcceptFailed:23,HandlePreAcceptFailed:24,HandleAcceptFailed:25,WillCreateSoundPort:26,SoundPortCreateFailed:27,TransportCandSendFailed:28,P2PTransportCreateFailed:29,P2PTransportMediaCreateFailed:30,P2PTransportStartFailed:31,P2PTransportRestartSuccess:32,MissingRelayInfo:33,ErrorGatheringHostCandidates:34,MediaStreamStartError:35,RelayLatencySendFailed:36,RelayElectionSendFailed:37,CallEnding:38,CallCaptureBufferFilled:39,CallCaptureEnded:40,RxTimeout:41,TxTimeout:42,RxTrafficStarted:43,RxTrafficStopped:44,RTCPPacketReceived:45,RTCPByeReceived:46,RelayBindsFailed:47,SoundPortCreated:48,AudioDriverRestart:49,Echo:50,SelfVideoStateChanged:51,PeerVideoStateChanged:52,VideoPortCreated:53,VideoPortCreateFailed:54,VideoDecodeStarted:55,VideoRenderStarted:56,VideoCaptureStarted:57,VideoPreviewFailed:58,VideoPreviewReady:59,VideoPreviewShouldMinimize:60,VideoStreamCreateError:61,VideoRenderFormatChanged:62,VideoCodecMismatch:63,VideoDecodePaused:64,VideoDecodeResumed:65,VideoEncodeFatalError:66,VideoDecodeFatalError:67,BatteryLevelLow:68,PeerBatteryLevelLow:69,GroupInfoChanged:70,FieldstatsReady:71,PendingCallInfoChanged:72,MuteStateChanged:73,InterruptionStateChanged:74,RxTrafficStateForPeerChanged:75,HandleAcceptReceiptFailed:76,GroupParticipantLeft:77,AudioRouteChangeRequest:78,HandleAcceptAckFailed:79,CallMissed:80,WeakWiFiSwitchedToCellular:81,CallAutoConnect:82,RejectedDecryptionFailure:83,PeerDeviceOrientationChanged:84,HandleOfferAckFailed:85,PendingCallAutoRejected:86,FDLeakDetected:87,RestartCamera:88,AudioTestReplayFinished:89,SyncDevices:90,VideoCodecStateChanged:91,CallFatal:92,UpdateJoinableCallLog:93,WAMax:94};t.WAVideoCodecScheme={VideoCodecSchemeNone:0,VideoCodecSchemeH26X:1,VideoCodecSchemeVPX:2,VideoCodecSchemeVPXH26X:3};t.WACallEndReason={WACallEndReasonUnknown:0,WACallEndReasonEndButtonTapped:1,WACallEndReasonEndButtonTappedOnBusy:2,WACallEndReasonReject:3,WACallEndReasonRejectUnavailable:4,WACallEndReasonRejectBlocked:5,WACallEndReasonTimeout:6,WACallEndReasonPeerUnavailable:7,WACallEndReasonRejectedByPeer:8,WACallEndReasonTimedoutByPeer:9,WACallEndReasonTerminatedByPeer:10,WACallEndReasonFailed:11,WACallEndReasonHandledRemotely:12};t.WACallState={WACallStateNone:0,WACallStateCalling:1,WACallStatePreacceptReceived:2,WACallStateReceivedCall:3,WACallStateAcceptSent:4,WACallStateAcceptReceived:5,WACallStateCallActive:6,WACallStateCallActiveElseWhere:7,WACallStateReceivedCallWithoutOffer:8};t.CALL_UI_STATES={NONE:"NONE",OUTGOING_RING:"OUTGOING_RING",INCOMING_RING:"INCOMING_RING",OUTGOING_CALLING:"OUTGOING_CALLING",CONNECTING:"CONNECTING",RECONNECTING:"RECONNECTING",ACTIVE:"ACTIVE",ENDED:"ENDED",REJECTED:"REJECTED",REMOTE_CALL_IN_PROGRESS:"REMOTE_CALL_IN_PROGRESS",FAILED:"FAILED"};t.CALL_STATES={INCOMING_RING:"INCOMING_RING",OUTGOING_RING:"OUTGOING_RING",OUTGOING_CALLING:"OUTGOING_CALLING",CONNECTING:"CONNECTING",CONNECTION_LOST:"CONNECTION_LOST",ACTIVE:"ACTIVE",HANDLED_REMOTELY:"HANDLED_REMOTELY",ENDED:"ENDED",REJECTED:"REJECTED",REMOTE_CALL_IN_PROGRESS:"REMOTE_CALL_IN_PROGRESS",FAILED:"FAILED",NOT_ANSWERED:"NOT_ANSWERED"};t.VOIP_WINDOW_IPC_EVENTS={INIT:"VOIP_WINDOW_INIT",UPDATE:"VOIP_WINDOW_UPDATE",REJECT:"VOIP_WINDOW_REJECT",ACCEPT:"VOIP_WINDOW_ACCEPT",IGNORE:"VOIP_WINDOW_IGNORE",END:"VOIP_WINDOW_END",RESET:"VOIP_WINDOW_RESET",TOGGLE_MUTE:"VOIP_WINDOW_TOGGLE_MUTE",TOGGLE_CAMERA:"VOIP_WINDOW_TOGGLE_CAMERA",OPEN_IN_CALL_MENU:"OPEN_IN_CALL_MENU",CLOSE_IN_CALL_MENU:"CLOSE_IN_CALL_MENU",TOGGLE_DEBUG_INFO:"TOGGLE_DEBUG_INFO",GROUP_CALL_INVITE:"GROUP_CALL_INVITE",UPGRADE_REQUEST:"UPGRADE_REQUEST",UPGRADE_ACCEPT:"UPGRADE_ACCEPT",UPGRADE_REJECT:"UPGRADE_REJECT",UPGRADE_CANCEL:"UPGRADE_CANCEL",INITIATE_WINDOW_MOVE:"INITIATE_WINDOW_MOVE",CLOSE_WINDOW_CLICK:"CLOSE_WINDOW_CLICK",MINIMIZE_WINDOW_CLICK:"MINIMIZE_WINDOW_CLICK",MAXIMIZE_WINDOW_CLICK:"MAXIMIZE_WINDOW_CLICK",UNMAXIMIZE_WINDOW_CLICK:"UNMAXIMIZE_WINDOW_CLICK",WINDOW_MAXIMIZED:"WINDOW_MAXIMIZED",WINDOW_UNMAXIMIZED:"WINDOW_UNMAXIMIZED",WINDOW_TITLE_DBL_CLICK:"WINDOW_TITLE_DBL_CLICK",WINDOW_ESC_PRESS:"WINDOW_ESC_PRESS",WINDOW_ALWAYS_ON_TOP_CHANGED:"WINDOW_ALWAYS_ON_TOP_CHANGED",L10N_UPDATE:"L10N_UPDATE"};t.MAIN_IPC_EVENTS={EVENT:"VOIP_MAIN_WINDOW_EVENT",SIGNALING:"VOIP_MAIN_WINDOW_SIGNALING",LOGGING:"VOIP_MAIN_WINDOW_LOGGING",LOG_PATH:"VOIP_MAIN_WINDOW_LOG_PATH",AV_EVENT:"AV_DEVICE_INFO_CHANGED",AV_LOG:"AV_MAIN_WINDOW_LOGGING",AV_DEVICE_CHANGE_TOAST:"AV_DEVICE_CHANGE_TOAST",AV_DEVICE_STATUS_CHANGE:"AV_DEVICE_STATUS_CHANGE"};t.RENDERER_IPC_EVENTS={ENABLE_VOIP_FEATURES:"voip:ENABLE_VOIP_FEATURES",ENABLE_VOIP_GROUP_FEATURES:"voip:ENABLE_VOIP_GROUP_FEATURES",REQUEST_NUM_PARTICIPANTS:"voip:REQUEST_NUM_PARTICIPANTS"};t.CALL_RESULT_TYPE={INVALID:0,CONNECTED:1,REJECTED_BY_USER:2,REJECTED_BY_SERVER:3,MISSED:4,BUSY:5,SETUP_ERROR:6,SERVER_NACK:7,CALL_OFFER_ACK_NOT_RECEIVED:8,MISSED_NO_RECEIPT:9,ACCEPTED_BUT_NOT_CONNECTED:10,CALL_CANCELED_CELLULAR_IN_PROGRESS:11,CALL_CANCELED_AIRPLANE_MODE_ON:12,CALL_CANCELED_NO_NETWORK:13,CALL_OFFER_ACK_CORRUPT:14,CALL_REJECTED_TOS:15,CALL_REJECTED_E2E:16,CALL_REJECTED_UNAVAILABLE:17,CALL_CANCELED_OFFER_NOT_SENT:18,PEER_SETUP_ERROR:19,ACTIVE_ELSEWHERE:20,NO_DECRYPTED_OFFER:21,ACCEPTED_ELSEWHERE:22,REJECTED_ELSEWHERE:23};t.CALL_LOG_RESULT={0:"invalid",1:"canceled",2:"missed",3:"unavailable",4:"reject",5:"connected"};t.CALL_LOG_RESULT_TYPE={INVALID:0,CANCELED:1,MISSED:2,UNAVAILABLE:3,REJECT:4,CONNECTED:5};t.VoipSettingsType={voipSettingsNone:0,voipSettingsAudio:1,voipSettingsVideo:2};t.VideoState={VideoStateDisabled:0,VideoStateEnabled:1,VideoStatePaused:2,VideoStateUpgradeRequest:3,VideoStateUpgradeAccept:4,VideoStateUpgradeReject:5,VideoStateStopped:6,VideoStateUpgradeRejectByTimeout:7,VideoStateUpgradeCancel:8,VideoStateUpgradeCancelByTimeout:9,VideoStateError:20};t.VideoUpgradeRequestEndedReason={EndedByUser:0,EndedByTimeout:1};t.ParticipantState={ParticipantStateInvalid:0,ParticipantConnected:1,ParticipantIncoming:2,ParticipantRinging:3,ParticipantRejected:4,ParticipantTerminated:5,ParticipantTimedout:6,ParticipantCreatingCall:7,ParticipantInvisible:8,ParticipantVisible:9,ParticipantCancelOffer:10};t.CallNetworkMedium={CallNetworkMediumCellular:1,CallNetworkMediumWifi:2,CallNetworkMediumNone:3}},15447:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.initDeviceLinkEvent=function(e,t,r){d=new u.default.MdLinkDeviceCompanion,c={regStartTime:r,accountSignature:e,identityKey:t}},t.setDeviceLinkMdUpgrade=function(){f=!0},t.setDeviceLinkPairStage=function(e){if(!d)return;d.set({mdLinkDeviceCompanionStage:e})},t.commitDeviceLinkEvent=function(){return _.apply(this,arguments)};var n=a(r(52954)),i=r(46378),s=r(60339),o=r(71684),u=a(r(40210)),l=a(r(84025)),d=null,c=null,f=!1;function p(){return h.apply(this,arguments)}function h(){return(h=(0,n.default)((function*(e,t){var r=new i.Binary;r.writeBuffer(e),r.write("_".charCodeAt(0)),r.writeBuffer(t);var a=r.readByteArray(),n=yield l.default.digest({name:"SHA-256"},a);return(0,s.encodeB64)(n)}))).apply(this,arguments)}function _(){return(_=(0,n.default)((function*(e){if(d&&c){var t=d,r=c,a=yield p(c.accountSignature,c.identityKey),n=(0,o.unixTime)()-r.regStartTime;t.set({mdDuration:n,mdSessionId:a,mdTimestamp:r.regStartTime,mdWasUpgraded:f,mdLinkDeviceCompanionErrorCode:null==e?0:e}),t.commit(),d=null,c=null,f=!1}}))).apply(this,arguments)}},74282:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.logLabelOperationEvent=function(e,t,r){var a={labelOperation:e};null!=t&&Object.assign(a,{labelCount:t});r&&Object.assign(a,{labelTarget:r});new n.default.LabelEvent(a).commit()};var n=a(r(40210))},61196:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(19976)),i=a(r(40210));function s(){var e=(0,n.default)(["mediaPickerSentUnchange mediaPickerSent: ",", mediaPickerChanged: ",""]);return s=function(){return e},e}var o={document:i.default.MEDIA_TYPE.DOCUMENT,video:i.default.MEDIA_TYPE.VIDEO,gif:i.default.MEDIA_TYPE.GIF,image:i.default.MEDIA_TYPE.PHOTO,audio:i.default.MEDIA_TYPE.AUDIO};t.default=class{constructor(e,t,r){this.mediaPickerSentUnchanged=0,this.mediaPickerDeleted=0,this.mediaPickerChanged=new Set,this.mediaPickerCroppedRotated=new Set,this.mediaPickerDrawing=new Set,this.mediaPickerStickers=new Set,this.mediaPickerText=new Set,this.mediaPickerLikeDoc=0,this.mediaPickerNotLikeDoc=0,this.mediaPickerT=0,this.t0=Date.now(),this.mediaType=o[t],this.mediaPickerOrigin=r,this.medias=new Set,this.medias.add(e),this.changeTypes={mediaPickerCroppedRotated:this.mediaPickerCroppedRotated,mediaPickerDrawing:this.mediaPickerDrawing,mediaPickerStickers:this.mediaPickerStickers,mediaPickerText:this.mediaPickerText}}onAdd(e){this.medias.add(e),"document"===this.mediaType?this.mediaPickerLikeDoc++:this.mediaPickerNotLikeDoc++}onChange(e,t){this.mediaPickerChanged.add(e),this.changeTypes[t].add(e)}onDelete(e){if(this.medias.delete(e),this.mediaPickerDeleted++,0===this.medias.size)return this.onCancel()}onSend(){return this.mediaPickerSent=this.medias.size,this.mediaPickerSentUnchanged=this.mediaPickerSent-this.mediaPickerChanged.size,this.dataPreflight()}onCancel(){return this.mediaPickerSent=0,this.mediaPickerSentUnchanged=0,this.dataPreflight()}onPause(){this.mediaPickerT+=Date.now()-(this.t0||0),this.t0=null}onResume(){this.t0=null!=this.t0?this.t0:Date.now()}dataPreflight(){var e=this.mediaPickerSentUnchanged;return isNaN(e)&&(e=0,__LOG__(4,void 0,new Error,!0)(s(),null!=this.mediaPickerSent&&0!==this.mediaPickerSent?this.mediaPickerSent:"undefined",this.mediaPickerChanged.size||"undefined"),SEND_LOGS("mediaPickerSentUnchange is not a number")),{mediaPickerSent:this.mediaPickerSent,mediaPickerSentUnchanged:e,mediaPickerT:this.mediaPickerT+(Date.now()-(this.t0||0)),mediaType:this.mediaType,mediaPickerOrigin:this.mediaPickerOrigin,mediaPickerChanged:this.mediaPickerChanged.size,mediaPickerCroppedRotated:this.mediaPickerCroppedRotated.size,mediaPickerDrawing:this.mediaPickerDrawing.size,mediaPickerStickers:this.mediaPickerStickers.size,mediaPickerText:this.mediaPickerText.size,mediaPickerLikeDoc:this.mediaPickerLikeDoc,mediaPickerNotLikeDoc:this.mediaPickerNotLikeDoc,mediaPickerDeleted:this.mediaPickerDeleted}}}},44422:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.MediaPickerChangeTypes=void 0;var n=a(r(70417)),i=a(r(61196)),s=a(r(40210));t.MediaPickerChangeTypes={mediaPickerCroppedRotated:"mediaPickerCroppedRotated",mediaPickerDrawing:"mediaPickerCroppedRotated",mediaPickerStickers:"mediaPickerCroppedRotated",mediaPickerText:"mediaPickerCroppedRotated"};t.default=class{constructor(){this.mediaByTypeAndOrigin=new Map,this.mediaEventReverseIndex=new Map,this.chatRecipients=null}pauseTimer(){this.mediaByTypeAndOrigin.forEach((e=>{e.onPause()}))}resumeTimer(){this.mediaByTypeAndOrigin.forEach((e=>{e.onResume()}))}_getKey(e,t){return"".concat(e,"_").concat(t)}_commitLog(e){new s.default.MediaPicker((0,n.default)((0,n.default)({},e),{},{chatRecipients:this.chatRecipients})).commit()}_processNewMedia(e,t,r){var a=this._getKey(t,r),n=this.mediaByTypeAndOrigin.get(a);if(n)n.onAdd(e),this.mediaEventReverseIndex.set(e,n);else{var s=new i.default(e,t,r);this.mediaByTypeAndOrigin.set(a,s),this.mediaEventReverseIndex.set(e,s)}}logChange(e,t){var r=this.mediaEventReverseIndex.get(e);r&&r.onChange(e,t)}logDelete(e){var t=this.mediaEventReverseIndex.get(e);t&&t.onDelete(e)}logSend(){this.mediaByTypeAndOrigin.forEach((e=>{this._commitLog(e.onSend())}))}logCancel(){this.mediaByTypeAndOrigin.forEach((e=>{this._commitLog(e.onCancel())}))}logAdd(e,t,r){this.mediaEventReverseIndex.get(e)||this._processNewMedia(e,t,r)}}},66925:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.getMetricMediaType=function(e){switch(e){case"audio":return u.default.MEDIA_TYPE.AUDIO;case"document":case"thumbnail-document":return u.default.MEDIA_TYPE.DOCUMENT;case"gif":return u.default.MEDIA_TYPE.GIF;case"image":case"thumbnail-image":return u.default.MEDIA_TYPE.PHOTO;case"ppic":return u.default.MEDIA_TYPE.PROFILE_PIC;case"product":return u.default.MEDIA_TYPE.PRODUCT_IMAGE;case"ptt":return u.default.MEDIA_TYPE.PTT;case"sticker":return u.default.MEDIA_TYPE.STICKER;case"video":case"thumbnail-video":return u.default.MEDIA_TYPE.VIDEO;case"template":return u.default.MEDIA_TYPE.TEMPLATE;case"md-msg-hist":return u.default.MEDIA_TYPE.MD_HISTORY_SYNC;case"md-app-state":return u.default.MEDIA_TYPE.MD_APP_STATE;case"product-catalog-image":return u.default.MEDIA_TYPE.PRODUCT_IMAGE;default:throw new Error("webMediaType is invalid: ".concat(e))}},t.getMetricUploadErrorResultType=function(e){if(e instanceof o.MMSUnauthorizedError)return u.default.MEDIA_UPLOAD_RESULT_TYPE.ERROR_NO_PERMISSIONS;if(e instanceof o.MediaTooLargeError)return u.default.MEDIA_UPLOAD_RESULT_TYPE.ERROR_BAD_MEDIA;if(e instanceof o.MMSThrottleError)return u.default.MEDIA_UPLOAD_RESULT_TYPE.ERROR_THROTTLE;if(e instanceof o.HttpStatusCodeError&&e.status>=500)return u.default.MEDIA_UPLOAD_RESULT_TYPE.ERROR_SERVER;if(e instanceof s.NoMediaHostsError)return u.default.MEDIA_UPLOAD_RESULT_TYPE.ERROR_MEDIA_CONN;if(e instanceof Promise.CancellationError||e.name===i.ABORT_ERROR)return u.default.MEDIA_UPLOAD_RESULT_TYPE.ERROR_CANCEL;if(e instanceof o.HttpNetworkError)return u.default.MEDIA_UPLOAD_RESULT_TYPE.ERROR_UPLOAD;return u.default.MEDIA_UPLOAD_RESULT_TYPE.ERROR_UNKNOWN},t.getMetricDownloadErrorResultType=function(e){if(e instanceof o.MMSThrottleError)return u.default.MEDIA_DOWNLOAD_RESULT_TYPE.ERROR_THROTTLE;if(e instanceof s.NoMediaHostsError)return u.default.MEDIA_DOWNLOAD_RESULT_TYPE.ERROR_MEDIA_CONN;if(e instanceof o.HttpNetworkError)return u.default.MEDIA_DOWNLOAD_RESULT_TYPE.ERROR_NETWORK;if(e instanceof o.HttpStatusCodeError)switch(e.status){case 404:case 410:return u.default.MEDIA_DOWNLOAD_RESULT_TYPE.ERROR_TOO_OLD;case 416:return u.default.MEDIA_DOWNLOAD_RESULT_TYPE.ERROR_CANNOT_RESUME;case 401:return u.default.MEDIA_DOWNLOAD_RESULT_TYPE.ERROR_INVALID_URL;case 429:case 507:return u.default.MEDIA_DOWNLOAD_RESULT_TYPE.ERROR_THROTTLE;default:return u.default.MEDIA_DOWNLOAD_RESULT_TYPE.ERROR_UNKNOWN}if(e instanceof Promise.CancellationError||e.name===i.ABORT_ERROR)return u.default.MEDIA_DOWNLOAD_RESULT_TYPE.ERROR_CANCEL;if(e instanceof o.MmsDownloadFilehashMismatchError)return u.default.MEDIA_DOWNLOAD_RESULT_TYPE.ERROR_ENC_HASH_MISMATCH;return u.default.MEDIA_DOWNLOAD_RESULT_TYPE.ERROR_UNKNOWN},t.getStatusCode=function(e){if(e instanceof o.HttpStatusCodeError)return e.status},t.generateMediaEventId=function(){return 1+Math.floor(Number.MAX_SAFE_INTEGER*Math.random())},t.logErrorUnknownDetails=function(e,t){if(null==t)return;var r;e.overallDownloadResult===u.default.MEDIA_DOWNLOAD_RESULT_TYPE.ERROR_UNKNOWN?r=u.default.WEBC_MEDIA_OPERATION_CODE.DOWNLOAD:e.overallUploadResult===u.default.MEDIA_UPLOAD_RESULT_TYPE.ERROR_UNKNOWN&&(r=u.default.WEBC_MEDIA_OPERATION_CODE.UPLOAD);if(null==r)return;new u.default.WebcMediaErrorUnknownDetails({mediaId:e.mediaId,webcMediaOperation:r,webcMediaErrorName:t.name}).commit()},t.getMetricBackendStore=function(e){if(!e)return u.default.BACKEND_STORE_TYPE.NON_DIRECT_PATH;switch(e.slice(0,2).toLowerCase()){case"/v":return u.default.BACKEND_STORE_TYPE.EVERSTORE;case"/o":return u.default.BACKEND_STORE_TYPE.OIL}return __LOG__(4,void 0,new Error,!0)(l()),SEND_LOGS("unrecognized-direct-path-type"),null};var n=a(r(19976)),i=r(8701),s=r(25172),o=r(85699),u=a(r(40210));function l(){var e=(0,n.default)(["Unrecognized direct path type"]);return l=function(){return e},e}},40210:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(70417)),i=r(53549),{BOOLEAN:s,INTEGER:o,NUMBER:u,STRING:l,TIMER:d}=i.TYPES,c=Object.freeze({NONE:1,SOFTWARE:2,BUILTIN:3}),f=Object.freeze({NONE:1,SOFTWARE:2,BUILTIN:3}),p=Object.freeze({LIMITED:0,FULL:1,LEGACY:2,LEVEL_3:3,EXTERNAL:4}),h=Object.freeze({API_1:1,API_2:2}),_=Object.freeze({JNI:1,OPENSLES:2}),m=Object.freeze({NON_DIRECT_PATH:1,EVERSTORE:2,OIL:3}),g=Object.freeze({SHOWN:1,CLICK:2,DISMISS:3,ELIGIBLE:4,REVOKED:5}),v=Object.freeze({GROUP:1,SMB_WELCOME:2,SMB_VERIFIED:3,SMB_EDIT_PROFILE:4,SMB_EDIT_DESCRIPTION:5,SMB_EDIT_CATEGORY:6,SMB_EDIT_HOURS:7,SMB_EDIT_EMAIL:8,SMB_CATALOG:9,SMB_CATALOG_SHARE_BANNER:10,CROSS_SELL_PROFILE_INTERSTITIAL:11,CROSS_SELL_CHATS_INTERSTITIAL:12,CROSS_SELL_CHATS_BANNER:13,BUSINESS_ACCOUNT_SYSTEM_MESSAGE:14,SMB_CATALOG_CART_INTERSTITIAL:15,PAYMENTS_ONBOARD_BANNER:16,SMB_DIRECTORY_UPSELL:17,SMB_CATALG_LIST_LWI_ADVERTISE_BANNER:18,SMB_LWI_AD_HUB_EDUCATIONAL_BANNER:19}),E=Object.freeze({UNKNOWN:1,SMB:2,ENT:3}),y=Object.freeze({REGISTRATION:1,SETTINGS:2}),S=Object.freeze({DESCRIPTION:1,HOURS:2,ADDRESS:3,EMAIL:4,WEBSITE:5,CATEGORY:6}),T=Object.freeze({CALLS_TAB_MISSED:1,CALLS_TAB_OUTGOING:2,SELECT_CONTACT:3,CALL_INFO:4,NOTIFICATION_MISSED:5,CONTACT_INFO:6,QUICK_CONTACT_INFO:7,CONVERSATION:8,CALLS_TAB_INCOMING:9,GROUP_CHAT_INFO:10,GROUP_CHAT_RECENT_LOCATION:11,ANDROID_BROADCAST_DETAILS:12,ANDROID_LIST_CHAT_INFO:13,ANDROID_CONTACTS_APPLICATION:14,CONTACT_VCARD:15,CALLS_TAB_NEW_CALL:16,VOICE_MAIL_CALL_BACK:17,IOS_INTENT:18,LIVE_LOCATION_MAP:19,GROUP_CALL_INFO:20,CALLS_TAB_BOTTOM_SHEET:21,STATUS_VIEWER:22,DEBUG_TOOL:23,GROUP_CHAT_PICKER:24,GROUP_CHAT_DIRECT:25,STELLA:26,CHAT_LIST:27,NEW_CHAT:28,CONVERSATION_OPTIONS:29}),b=Object.freeze({CELLULAR:1,WIFI:2,NONE:3}),A=Object.freeze({UNBOUND:1,BINDED:2}),C=Object.freeze({INVALID:0,CONNECTED:1,REJECTED_BY_USER:2,REJECTED_BY_SERVER:3,MISSED:4,BUSY:5,SETUP_ERROR:6,SERVER_NACK:7,CALL_OFFER_ACK_NOT_RECEIVED:8,MISSED_NO_RECEIPT:9,ACCEPTED_BUT_NOT_CONNECTED:10,CALL_CANCELED_CELLULAR_IN_PROGRESS:11,CALL_CANCELED_AIRPLANE_MODE_ON:12,CALL_CANCELED_NO_NETWORK:13,CALL_OFFER_ACK_CORRUPT:14,CALL_REJECTED_TOS:15,CALL_REJECTED_E2E:16,CALL_REJECTED_UNAVAILABLE:17,CALL_CANCELED_OFFER_NOT_SENT:18,PEER_SETUP_ERROR:19,ACTIVE_ELSEWHERE:20,NO_DECRYPTED_OFFER:21,ACCEPTED_ELSEWHERE:22,REJECTED_ELSEWHERE:23}),P=Object.freeze({CALL_SEGMENT_ONE_ON_ONE_ACTIVE:1,CALL_SEGMENT_GROUP_ACTIVE:2,CALL_SEGMENT_ONE_ON_ONE_HOLD_SELF:3,CALL_SEGMENT_ONE_ON_ONE_HOLD_PEER:4}),O=Object.freeze({UNKNOWN:1,CALL_ACCEPT_FAILED:2,INIT_MEDIA_STREAM_FAILED:3,START_MEDIA_STREAM_FAILED:4,AUDIO_INIT_ERROR:5,HANDLE_OFFER_FAILED:6,HANDLE_ACCEPT_FAILED:7,SOUND_PORT_CREATE_FAILED:8,P2P_TRANSPORT_CREATE_FAILED:9,P2P_TRANSPORT_MEDIA_CREATE_FAILED:10,INCOMPATIBLE_SRTP_KEY_EXCHANGE:11,SRTP_KEY_GENERATION_ERROR:12,UNSUPPORTED_AUDIO_CAPS:13,P2P_TRANSPORT_START_FAILED:14,RELAY_BIND_FAILED:15,CANNOT_INITIALIZE_AUDIO_RECORD_OBJECT:16,PEER_RELAY_BIND_FAILED:17,VIDEO_CAPTURE_INIT_FAILED:18,VIDEO_CAPTURE_START_FAILED:19,VIDEO_RENDER_INIT_FAILED:20,VIDEO_RENDER_START_FAILED:21,VIDEO_ENCODER_OPEN_FAILED:22,VIDEO_DECODER_OPEN_FAILED:23,VIDEO_STREAM_CREATE_FAILED:24,VIDEO_STREAM_SETUP_FAILED:25,PEER_SETUP_FAILED:26,HANDLE_PREACCEPT_FAILED:27}),w=Object.freeze({CALLER:1,CALLEE:2}),M=Object.freeze({ENDED_BY_USER:1,TIMEOUT:2,RECONNECTING:3,ENDED_BY_SELF:4,ENDED_BY_PEER:5,VIDEO_ENCODER_FATAL_ERROR:6,VIDEO_DECODER_FATAL_ERROR:7,AUDIO_RECORD_FATAL_ERROR:8,CRASH:9,DETECT_IDENTITY_CHANGE:10,USER_INVISIBLE:11}),I=Object.freeze({UNKNOWN:0,P2P:1,UDP_RELAY:2,TCP_RELAY:3,MIXED:4}),R=Object.freeze({DISABLED:0,ENABLED:1,PAUSED:2,UPGRADE_REQUEST:3,MUTED:6,ERROR:20}),D=Object.freeze({NONE:0,UNKNOWN:1,APNS_PUSH:2,IOS_VOIP_PUSH:3,GCM_PUSH:4,ONLINE:5,RIM_PUSH:6}),N=Object.freeze({DEFAULT:0,TEXTURE:1,TEXTURE_FALLBACK:2}),L=Object.freeze({DEFAULT:0,CONSERVATIVE:1,STRICT:2,ERROR:11}),k=Object.freeze({ACTION_PRODUCT_ADD_CLICKED:1,ACTION_PRODUCT_ADD_SUCCESS:2,ACTION_PRODUCT_ADD_FAILED:3,ACTION_PRODUCT_EDIT_CLICKED:4,ACTION_PRODUCT_EDIT_SUCCESS:5,ACTION_PRODUCT_EDIT_FAILED:6,ACTION_PRODUCT_DELETE_CLICKED:7,ACTION_PRODUCT_DELETE_SUCCESS:8,ACTION_PRODUCT_DELETE_FAILED:9,ACTION_APPEAL_PRODUCT_CLICKED:10,ACTION_APPEAL_PRODUCT_SUCCESS:11,ACTION_APPEAL_PRODUCT_FAILED:12,ACTION_CREATE_PRODUCT_CATALOG:13,ACTION_CREATE_PRODUCT_CATALOG_SUCCESS:14,ACTION_CREATE_PRODUCT_CATALOG_FAILED:15,ACTION_CATALOG_MENU_ITEM_CLICKED:16,ACTION_PRODUCT_RESUBMIT_CLICKED:17,ACTION_START_IMPORT_FLOW:18,ACTION_IMPORT_POST:19,ACTION_CARD_IMPRESSION:20,ACTION_CARD_ITEM_CLICK:21,ACTION_CARD_MORE_CLICK:22,ACTION_LIST_IMPRESSION:23,ACTION_LIST_ITEM_CLICK:24,ACTION_DETAIL_IMAGE_CLICK:25,ACTION_DETAIL_LINK_CLICK:26,ACTION_IMAGE_LIST_IMPRESSION:27,ACTION_IMAGE_LIST_CLICK:28,ACTION_FULL_IMAGE_IMPRESSION:29,ACTION_FULL_IMAGE_SWIPE:30,ACTION_DETAIL_IMPRESSION:31,ACTION_QUOTED_PRODUCT_IN_CONVERSATION_CLICK:32,ACTION_PRODUCT_IN_CONVERSATION_CLICK:33,ACTION_SEND_PRODUCT_MESSAGE:34,ACTION_ONBOARD_IMPRESSION:35,ACTION_SHARE_CATALOG_LINK_CLICK:36,ACTION_SHARE_PRODUCT_LINK_CLICK:37,ACTION_CATALOG_IN_CONVERSATION_CLICK:38,ACTION_SHARE_CATALOG_VIA_WA_LINK_CLICK:39,ACTION_SHARE_PRODUCT_VIA_WA_LINK_CLICK:40,ACTION_SHARE_CATALOG_COPY_LINK_CLICK:41,ACTION_SHARE_PRODUCT_COPY_LINK_CLICK:42,ACTION_SEND_CATALOG_CLICK:43,ACTION_ORDER_MESSAGE_CLICK:44,ACTION_ORDER_LIST_IMPRESSION:45,ACTION_ORDER_LIST_ITEM_CLICK:46,ACTION_MESSAGE_BUSINESS_BUTTON_CLICK:47,ACTION_QUOTED_PRODUCT_MESSAGE_SEND:48,ACTION_CART_ADD_PRODUCT:49,ACTION_CART_ICON_CLICK:50,ACTION_CART_SNACKBAR_CLICK:51,ACTION_CART_LIST_IMPRESSION:52,ACTION_CART_EDIT_PRODUCT:53,ACTION_CART_DELETE_PRODUCT:54,ACTION_CART_ABANDON:55,ACTION_SEND_ORDER_MESSAGE:56,ACTION_MENU_CLICK:57,ACTION_PRODUCT_HIDE_CLICKED:58,ACTION_PRODUCT_HIDE_SUCCESS:59,ACTION_PRODUCT_HIDE_CANCELLED:60,ACTION_PRODUCT_HIDE_FAILED:61,ACTION_PRODUCT_UNHIDE_CLICKED:62,ACTION_PRODUCT_UNHIDE_SUCCESS:63,ACTION_PRODUCT_UNHIDE_CANCELLED:64,ACTION_PRODUCT_UNHIDE_FAILED:65,ACTION_CATALOG_LIST_MENU_CLICKED:66,ACTION_CATALOG_LIST_MENU_CLICKED_WITH_ADVERTISE_SHOWN:67}),U=Object.freeze({CATALOG_ENTRY_POINT_PROFILE:1,CATALOG_ENTRY_POINT_SETTINGS:2,CATALOG_ENTRY_POINT_MESSAGE:3,CATALOG_ENTRY_POINT_ATTACHMENT_PANEL:4,CATALOG_ENTRY_POINT_NUX:5,CATALOG_ENTRY_POINT_DEEPLINK:6,CATALOG_ENTRY_POINT_CHAT:7,CATALOG_ENTRY_POINT_ORDER_MESSAGE:8,CATALOG_ENTRY_POINT_INVOICE_ATTACHMENT_PANEL:9,CATALOG_ENTRY_POINT_PRODUCT_LIST_MESSAGE:10}),F=Object.freeze({ACTION_CARD_IMPRESSION:1,ACTION_CARD_ITEM_CLICK:2,ACTION_CARD_MORE_CLICK:3,ACTION_LIST_IMPRESSION:4,ACTION_LIST_ITEM_CLICK:5,ACTION_DETAIL_IMAGE_CLICK:6,ACTION_DETAIL_LINK_CLICK:7,ACTION_IMAGE_LIST_IMPRESSION:8,ACTION_IMAGE_LIST_CLICK:9,ACTION_FULL_IMAGE_IMPRESSION:10,ACTION_FULL_IMAGE_SWIPE:11,ACTION_DETAIL_IMPRESSION:12,ACTION_REPORT_PRODUCT:13,ACTION_SEND_PRODUCT_MESSAGE:14,ACTION_REPORT_PRODUCT_SUCCESS:15,ACTION_REPORT_PRODUCT_FAILURE:16,ACTION_QUOTED_PRODUCT_IN_CONVERSATION_CLICK:17,ACTION_PRODUCT_IN_CONVERSATION_CLICK:18,ACTION_SHARE_CATALOG_LINK_CLICK:19,ACTION_SHARE_PRODUCT_LINK_CLICK:20,ACTION_CATALOG_IN_CONVERSATION_CLICK:21,ACTION_SHARE_CATALOG_VIA_WA_LINK_CLICK:22,ACTION_SHARE_PRODUCT_VIA_WA_LINK_CLICK:23,ACTION_SHARE_CATALOG_COPY_LINK_CLICK:24,ACTION_SHARE_PRODUCT_COPY_LINK_CLICK:25,ACTION_CHAT_CATALOG_ICON_CLICK:26,ACTION_MESSAGE_BUSINESS_BUTTON_CLICK:27,ACTION_CART_ADD_PRODUCT:28,ACTION_CART_EDIT_PRODUCT:29,ACTION_CART_DELETE_PRODUCT:30,ACTION_CART_ABANDON:31,ACTION_CART_ICON_CLICK:32,ACTION_CART_SNACKBAR_CLICK:33,ACTION_SEND_ORDER_MESSAGE:34,ACTION_ORDER_LIST_IMPRESSION:35,ACTION_QUOTED_PRODUCT_MESSAGE_SEND:36,ACTION_CART_LIST_IMPRESSION:37,ACTION_ORDER_MESSAGE_CLICK:38,ACTION_ORDER_LIST_ITEM_CLICK:39,ACTION_PLM_CART_CTA_CLICK:40}),G=Object.freeze({OPEN:1,SELECT_FILTER:2,SEARCH_WITH_FILTER:3}),x=Object.freeze({NONE:0,OTHER_LABELS:1,UNREAD:2,GROUP:3,BROADCAST_LIST:4,NEW_CUSTOMER:5,NEW_ORDER:6,PENDING_PAYMENT:7,PAID:8,ORDER_COMPLETE:9}),B=Object.freeze({HOSTNAME:0,IP4:1,IP6:2}),Y=Object.freeze({CHATD:1,MMS:2}),K=Object.freeze({PROBLEM_DESCRIPTION:1,SUGGESTED_FAQ:2,EMAIL_SEND:3,IN_APP_FAQ:4,CANCELLED:5,FAQ:6}),j=Object.freeze({DEEP_LINK_EXTERNAL:1,DEEP_LINK_WA_LINK_CLICK:2,QR_CODE_SHEET:3}),W=Object.freeze({DEEP_LINK_UNKNOWN:1,DEEP_LINK_CHAT:2,DEEP_LINK_CONTACT_QR_CODE:3,DEEP_LINK_PAYMENT:4,DEEP_LINK_PRODUCT:5,DEEP_LINK_CATALOG:6,DEEP_LINK_FUTURE_PROOF:7,DEEP_LINK_GROUP_INVITE:8,DEEP_LINK_MSG_FORWARD:9,DEEP_LINK_MESSAGE_QR_CODE:10,DEEP_LINK_OPT_IN_QR_CODE:11,DEEP_LINK_CTWA:12,DEEP_LINK_STICKERPACK:13,DEEP_LINK_NOVI_HUB:14,DEEP_LINK_NOVI_ADD_DEBIT_CARD:15,DEEP_LINK_NOVI_ADD_BANK_ACCOUNT:16,DEEP_LINK_NOVI_WITHDRAW:17,DEEP_LINK_NOVI_RESET_PASSWORD:18,DEEP_LINK_PAYMENT_SIGNUP:19,DEEP_LINK_BIZTOOLS_ACCOUNTS:20,DEEP_LINK_PAYMENT_VIRALITY:21,DEEP_LINK_SETTINGS_ACCOUNT_DELETE:22,DEEP_LINK_SETTINGS_ACCOUNT_REQUEST_INFO:23,DEEP_LINK_SETTINGS_CHATS_HISTORY:24}),V=Object.freeze({APP_SWITCH:1,BROWSER:2,CANCELLED:3}),H=Object.freeze({PRIMARY:1,COMPANION:2}),q=Object.freeze({CHAT_PERSONAL:1,CHAT_GROUP:2,STATUS_USER:3,STATUS_ADS:4,PRODUCT_CATALOG:5,GDPR:6,STICKER_PICKER:7,PROFILE_PICTURE:8,BLOKS:9,P2B:10}),z=Object.freeze({NORMAL_QUALITY:1,MID_QUALITY:2,INELIGIBLE_IMAGE_TOO_SMALL:3,INELIGIBLE_PARTIAL_HASHES_NOT_FOUND:4,ERROR_DETERMINING_ELIGIBILITY:5,NOT_DOWNLOADED_ENOUGH_BYTES_TO_DETERMINE_ELIGIBILITY:6}),J=Object.freeze({INVALID_SENDER:1,MISSING_DSM:2,INVALID_DSM:3}),Q=Object.freeze({MESSAGE:0,PREKEY_MESSAGE:1,SENDER_KEY_MESSAGE:2}),X=Object.freeze({INDIVIDUAL:0,GROUP:1,LIST:2,STATUS:3}),Z=Object.freeze({INVALID_MESSAGE:0,LEGACY_MESSAGE:1,INVALID_VERSION:2,PRE_KEY_MESSAGE_MISSING_PRE_KEY:3,PRE_KEY_MESSAGE_INVALID_KEY:4,UNTRUSTED_IDENTITY:5,NO_SESSION_AVAILABLE:6,PLAINTEXT_BYTE_MISMATCH:7,UNKNOWN_CIPHERTEXT_TYPE:8,UNKNOWN_CIPHERTEXT_VERSION:9,INVALID_PADDING:10,INVALID_PROTOCOL_BUFFER:11,INVALID_NUMBER_OF_MESSAGE_TYPES:12,INVALID_IMAGE_FILE_LENGTH:13,INVALID_IMAGE_FILE_SHA256:14,INVALID_IMAGE_MEDIA_URL:15,INVALID_IMAGE_MEDIA_KEY:16,INVALID_IMAGE_MIME_TYPE:17,UNKNOWN_V2_TAGS:18,INVALID_EDIT_VERSION:19,INVALID_HSM_NAMESPACE:20,INVALID_HSM_ELEMENT:21,UNKNOWN_PROTOCOL_MESSAGE_TYPE:22,DUPLICATE_MESSAGE:23,FINGERPRINT_IDENTITY_MISMATCH:24,FINGERPRINT_VERSION_MISMATCH:25,INVALID_ARGUMENT:26,INVALID_KEY:27,INVALID_KEY_ID:28,INVALID_MAC:29,NO_MEMORY:30,STALE_KEY_EXCHANGE:31,VRF_SIGNATURE_VERIFICATION_FAILED:32,ERROR_MINIMUM_VALUE:33,ERROR_UNKNOWN:34,INVALID_BROADCAST_STANZA_ATTRIBUTE:35,INVALID_LIST_REPLY_MESSAGE:36,INVALID_LIST_REPLY_ROW_IDENTIFIER:37,INVALID_BUTTONS_RESPONSE_MESSAGE:38,INVALID_BUTTONS_RESPONSE_BUTTON_IDENTIFIER:39,INVALID_ORDER_MESSAGE:40}),$=Object.freeze({MY_PRIMARY:1,OTHER_PRIMARY:2,MY_COMPANION:3,OTHER_COMPANION:4}),ee=Object.freeze({ACTION_OPEN:1,ACTION_SAVE:2,ACTION_DISCARD:3,ACTION_PROFILE_FIELD_OPEN:4,ACTION_PROFILE_FIELD_SAVE:5,ACTION_PROFILE_FIELD_DISCARD:6}),te=Object.freeze({CALL_TOO_SHORT:1}),re=Object.freeze({ROOM_OPEN_FAILURE:1,UNKNOWN_ERROR:2}),ae=Object.freeze({BOTH:1,SELF:2,PEER:3}),ne=Object.freeze({GIPHY:0,TENOR:1}),ie=Object.freeze({INCOMING_CALL_SCREEN_ANSWER:1,INCOMING_CALL_SCREEN_REJECT:2,INCOMING_CALL_NOTIFICATION_ANSWER:3,INCOMING_CALL_NOTIFICATION_REJECT:4,PENDING_CALL_SCREEN_END_AND_ANSWER:5,PENDING_CALL_SCREEN_HOLD_AND_ANSWER:6,PENDING_CALL_SCREEN_REJECT:7,INCOMING_CALL_REMOTE_ANSWER:8,INCOMING_CALL_REMOTE_REJECT:9,PENDING_CALL_NOTIFICATION_END_AND_ANSWER:10,PENDING_CALL_NOTIFICATION_REJECT:11}),se=Object.freeze({DEFAULT:0,PROBING_ROTT_TO_RELAY:1,PROBING_E2E_PEER_RX:2,PROBING_E2E_RX:3,HIS_RECENT_PEER_RX:4,HIS_RECENT_RX:5,HIS_RECENT_PROBING_ROTT_TO_RELAY:6,HIS_RECENT_PROBING_E2E_PEER_RX:7,HIS_RECENT_PROBING_E2E_RX:8,ONE_SIDE_INITIAL_BANDWIDTH_ESTIMATION:9}),oe=Object.freeze({ADD:1,EDIT:2,DELETE:3,VIEW:4,CLICK_POSITIVE:5,CLICK_NEGATIVE:6,UPDATE_LABEL_COUNT:7}),ue=Object.freeze({LABEL:1,MESSAGE:2,CONTACT:3,LABELS_SCREEN:4,LABEL_DETAILS_SCREEN:5,EDIT_LABEL_DIALOG:6,DELETE_LABEL_DIALOG:7,LABEL_MESSAGE_DIALOG:8,LABEL_CHAT_DIALOG:9,ADD_LABEL_DIALOG:10,BULK_UNLABEL_DIALOG:11,LABEL_COMBINED_DIALOG:12,GROUP:13,BROADCAST:14}),le=Object.freeze({APP_STATE_SYNC_KEY_EXPIRY:1,DEVICE_DEREGISTERATION:2,NO_KEYS:3}),de=Object.freeze({CRITICAL:1,NON_CRITICAL:2}),ce=Object.freeze({APP_STATE:1,HISTORY:2}),fe=Object.freeze({SUCCESS:1,FAILURE:2}),pe=Object.freeze({PAIR_SUCCESS_RECEIVED:1,PAIR_DEVICE_SIGN_SENT:2,FIRST_CONNECT:3,UPLOAD_PREKEYS:4,COMPLETE:5}),he=Object.freeze({INITIAL_SYNC:1,RESUME_SYNC:2,REGULAR_SYNC:3}),_e=Object.freeze({MESSAGE_RANGE_UNSET:1,MESSAGE_RANGE_LAST_SYSTEM_MESSAGE_TIMESTAMP_SET:2,MESSAGE_RANGE_MESSAGES_UNSET:3,MESSAGE_RANGE_MESSAGES_EMPTY:4,MESSAGE_RANGE_MESSAGES_CROSS_LIMIT:5,MESSAGE_RANGE_MESSAGE_KEY_UNSET:6,MESSAGE_RANGE_MESSAGE_KEY_REMOTE_JID_UNSET:7,MESSAGE_RANGE_MESSAGE_KEY_FROM_ME_UNSET:8,MESSAGE_RANGE_MESSAGE_KEY_STANZA_ID_UNSET:9}),me=Object.freeze({TOO_MANY_INTERNAL_SERVER_ERRORS_IN_7D:1,SERVER_DATA_MISMATCH:2,PROTOBUF_DESERIALIZATION_FAILED:3,EXTERNAL_PATCH_EXPIRED:4,MISSING_OR_EMPTY_INDEX:5,SAME_INDEX_FOR_MULTIPLE_MUTATIONS_IN_PATCH:6,DECRYPTION_FAILED:7,MISSING_PATCH_VERSION:8,DUPLICATE_PATCH_VERSION_IN_COLLECTION:9,ENCRYPTION_FAILED:10,MISSING_MUTATION_VERSION:11,MISSING_MUTATION_VALUE:12,INVALID_MUTATION_INDEX:13,PATCH_WITH_BOTH_INLINE_AND_EXTERNAL_MUTATIONS:14,MISSING_MUTATION_OPERATION:15,MISSING_MUTATION_RECORD:16,MISSING_MUTATION_KEY_ID:17,PATCH_PROTOBUF_DESERIALIZATION_FAILED:18,ACTION_DATA_PROTOBUF_DESERIALIZATION_FAILED:19,MISSING_MUTATION_INDEX:20,MISSING_ACTION_INDEX:21,INVALID_ACTION_INDEX:22,MISSING_ACTION_VALUE:23,MISSING_ACTION_VERSION:24,MISSING_ACTION_TIMESTAMP:25,MUTATIONS_PROTOBUF_DESERIALIZATION_FAILED:26,MUTATIONS_PROTOBUF_SERIALIZATION_FAILED:27,PATCH_PROTOBUF_SERIALIZATION_FAILED:28,ACTION_DATA_PROTOBUF_SERIALIZATION_FAILED:29,MISSING_KEY_ON_ALL_CLIENTS:30,TIMEOUT_WHILE_WAITING_FOR_MISSING_KEY:31,MAC_MISMATCH_SNAPSHOT:33,MAC_MISMATCH_PATCH:34,DB_STORE_NOT_READY:35,TERMINAL_PATCH_MISSING_DATA:36,TERMINAL_PATCH_DESERIALIZATION_ERROR:37,TERMINAL_PATCH_UNKNOWN:38,CYCLIC_MUTATION_DEPENDENCY_IN_PATCH:39,MISSING_SNAPSHOT_VERSION:45,MISSING_SNAPSHOT_MAC:46,MISSING_PATCH_SNAPSHOT_MAC:47,MISSING_PATCH_MAC:48,MISSING_EXTERNAL_BLOB_REFERENCE_MEDIA_KEY:49,MISSING_EXTERNAL_BLOB_REFERENCE_DIRECT_PATH:50,MISSING_EXTERNAL_BLOB_REFERENCE_FILE_SHA256:51,MISSING_EXTERNAL_BLOB_REFERENCE_FILE_ENC_SHA256:52,INVALID_KEY_SHARE_KEY_ID:53,MALFORMED_PENDING_MUTATION:54,MISSING_PATCH_KEY_ID:56,INVALID_KEY_SHARE_KEY_DATA:57,SNAPSHOT_EXPIRED:58,MISSING_SNAPSHOT_KEY_ID:59,SNAPSHOT_MAC_MISMATCH_IN_PATCH:60,SNAPSHOT_MAC_MISMATCH_IN_SNAPSHOT:61,XMPP_BAD_REQUEST_FOR_COLLECTION:62,XMPP_NOT_FOUND_FOR_COLLECTION:63,XMPP_BAD_REQUEST_GLOBAL_ERROR:64,XMPP_NOT_FOUND_GLOBAL_ERROR:65,XMPP_BAD_METHOD_GLOBAL_ERROR:66,XMPP_NOT_ACCEPTABLE_GLOBAL_ERROR:67,SAME_INDEX_FOR_MULTIPLE_MUTATIONS_IN_SNAPSHOT:68,EXTERNAL_BLOB_REFERENCE_PROTOBUF_DESERIALIZATION_FAILED:69,SNAPSHOT_PROTOBUF_DESERIALIZATION_FAILED:70,REQUESTING_MISSING_KEY_WITH_NO_CLIENTS:71}),ge=Object.freeze({SYNCD:1,WEB:2}),ve=Object.freeze({BROWSER:1,DESKTOP:2}),Ee=Object.freeze({MANUAL:1,FULL:2,PREFETCH:3,HEADER:4,THUMBNAIL:5}),ye=Object.freeze({OK:1,ERROR_UNKNOWN:2,ERROR_TIMEOUT:3,ERROR_DNS:4,ERROR_INSUFFICIENT_SPACE:5,ERROR_TOO_OLD:6,ERROR_CANNOT_RESUME:7,ERROR_HASH_MISMATCH:8,ERROR_INVALID_URL:9,ERROR_OUTPUT_STREAM:10,ERROR_CANCEL:11,DEDUPED:12,ERROR_ENC_HASH_MISMATCH:14,PREFETCH_END:15,ERROR_CANCEL_PROGRAMMATIC:16,ERROR_MEDIA_CONN:17,ERROR_THROTTLE:18,ERROR_SSL:19,ERROR_NETWORK:20,ERROR_CONNECT:21}),Se=Object.freeze({CHAT_PHOTO_LIBRARY:1,CAMERA_TAB_CAPTURE:2,FORWARD:3,PASTE:4,SHARE_EXTENSION:5,EXPORT:6,MENU_CAMERA_CAPTURE:7,EXTERNAL_CAMERA:8,LINK_PREVIEW_DOWNLOAD:9,CAMERA_TAB_MEDIA_STRIP:10,CAMERA_TAB_PHOTO_LIBRARY:11,CHAT_BUTTON_CAMERA_CAPTURE:12,CHAT_BUTTON_CAMERA_MEDIA_STRIP:13,CHAT_BUTTON_CAMERA_PHOTO_LIBRARY:14,STATUS_TAB_CAMERA_CAPTURE:15,STATUS_TAB_CAMERA_MEDIA_STRIP:16,STATUS_TAB_CAMERA_PHOTO_LIBRARY:17,STATUS_REPLY_CAMERA_CAPTURE:18,STATUS_REPLY_CAMERA_MEDIA_STRIP:19,STATUS_REPLY_CAMERA_PHOTO_LIBRARY:20,MENU_CAMERA_PHOTO_LIBRARY:21,CHAT_GIF_INAPP:22,CHAT_GIF_EXTERNAL:23,STATUS_REPLY_GIF_INAPP:24,STATUS_REPLY_GIF_EXTERNAL:25,SMB_QUICK_REPLY_EDIT:26,SMB_QUICK_REPLY_SEND:27,MEDIA_BROWSER:28,CHAT_QUICK_EDIT:29,CAMERA_TAB_GIF:30,STATUS_TAB_GIF:31}),Te=Object.freeze({NONE:1,PHOTO:2,VIDEO:3,AUDIO:4,PTT:5,LOCATION:6,CONTACT:7,DOCUMENT:8,URL:9,CALL:10,GIF:11,FUTURE:12,CONTACT_ARRAY:13,LIVE_LOCATION:14,PROFILE_PIC:15,STICKER:16,HSM:17,PRODUCT_IMAGE:18,TEMPLATE:19,MD_APP_STATE:20,MD_HISTORY_SYNC:21,CATALOG_LINK:22,PRODUCT_LINK:23,ORDER:24,LIST:25,LIST_REPLY:26,BUTTON_MESSAGE:27,BUTTON_RESPONSE_MESSAGE:28,PRODUCT_LIST:29,BUTTON_NFM:30}),be=Object.freeze({REGULAR:1,FAST_FORWARD_EXIST_CHECK:2,VIDEO_EXIST_CHECK:3,PRODUCT:4,MEDIA_RETRY:5,WEB_REUPLOAD:6,THUMBNAIL:7}),Ae=Object.freeze({OK:1,DUPLICATE:3,ERROR_UNKNOWN:2,ERROR_REQUEST:4,ERROR_UPLOAD:5,ERROR_OOM:6,ERROR_IO:7,ERROR_NO_PERMISSIONS:8,ERROR_BAD_MEDIA:9,ERROR_INSUFFICIENT_SPACE:10,ERROR_FNF:11,ERROR_CANCEL:12,ERROR_SERVER:13,ERROR_REQUEST_TIMEOUT:14,ERROR_NOT_FINALIZED:15,ERROR_OPTIMISTIC_HASH:16,ERROR_MEDIA_CONN:17,ERROR_DNS:18,ERROR_THROTTLE:19,ERROR_SSL:20,ERROR_NO_CLIENT_NETWORK:21}),Ce=Object.freeze({OTHER:0,INDIVIDUAL:1,GROUP:2,STATUS:3,BROADCAST:4}),Pe=Object.freeze({OK:1,ERROR_UNKNOWN:3,ERROR_NETWORK:4,ERROR_EXPIRED:5,ERROR_CANCELLED:6,ERROR_UPLOAD:7}),Oe=Object.freeze({INDIVIDUAL:1,GROUP:2,BROADCAST:3,STATUS:4}),we=Object.freeze({NATIVE:0,OK_HTTP:1,LIGER:2,APACHE:3,WATLS:4}),Me=Object.freeze({NONE:1,SOFTWARE:2,BUILTIN:3}),Ie=Object.freeze({NONE:0,OPTIMISTIC:1,OPT_USED:2,OPT_TAKEOVER:3,OPT_DISABLED:4}),Re=Object.freeze({RESUME_CHECK:1,UPLOAD:2,FINALIZE:3}),De=Object.freeze({NONE_NEW_CONTENT:1,NONE_EXPIRED:2,REUSED:3}),Ne=Object.freeze({CONSUMER:1,SMB:2,ENT:3}),Le=Object.freeze({CELLULAR:1,WIFI:2,NONE:3}),ke=Object.freeze({IPHONE:1,ANDROID:2,BB:3,BBX:7,S40:4,SYMBIAN:5,WP:6,WEBCLIENT:8,OSMETA:11,ENT:12,SMBA:13,KAIOS:14,SMBI:15,WINDOWS:16,WEB:17,PORTAL:18,BLOKS:19,BLUEA:20,BLUEI:21,FBLITEA:22,GREENA:23,GREENI:24,IGDA:25,IGDI:26,IGLITEA:27,MLITEA:28,MSGRA:29,MSGRI:30,MSGRP:31,MSGRW:32,IGDW:33,PAGE:34,MSGRDM:35,MSGRDW:36,TEST:9,UNKNOWN:10}),Ue=Object.freeze({SPEED_1:0,SPEED_1_5:1,SPEED_2:2}),Fe=Object.freeze({AUDIO_QUEUE:0,AVPLAYER:1,AVAUDIOPLAYER:2,OPUSPLAYER:3,ANDROIDPLAYER:4,EXOPLAYER:5}),Ge=Object.freeze({SENT:1,CANCELLED:2,TOO_SHORT:3}),xe=Object.freeze({FROM_CONVERSATION:0,FROM_VOICEMAIL:1}),Be=Object.freeze({UNKNOWN:0,AAC:1,MP3:2,AMR_NB:3,AMR_WB:4,OPUS:5,MULTIPLE_TRACKS:6}),Ye=Object.freeze({MANUAL:0,SEQUENTIAL:1}),Ke=Object.freeze({STICKER_STORE_DATA:0,PREVIEW_IMAGE_DOWNLOAD:1,STICKER_PACK_DATA:2,STICKER_SEARCH:3}),je=Object.freeze({ACTION_SETTINGS_IMPRESSION:1,ACTION_SETTINGS_ADD_CLICK:2,ACTION_SETTINGS_ADD_ABANDONED:3,ACTION_SETTINGS_ADDED:4,ACTION_SETTINGS_DELETED:5,ACTION_CHAT_IMPRESSION:6,ACTION_CHAT_CLICK:7,ACTION_SETTINGS_EDITED:8,ACTION_CHAT_INVALID_ATTACHMENTS:9,ACTION_SETTINGS_INVALID_ATTACHMENTS:10,ACTION_SETTINGS_MEDIA_TRANSCODE:11,ACTION_CHAT_CLICK_CANCEL:12}),We=Object.freeze({UNKNOWN:0,CONVERSATIONS:1,BUTTON:2,KEYBOARD:3}),Ve=Object.freeze({QUICK_REPLY_TRANSCODE_RESULT_OK:1,QUICK_REPLY_TRANSCODE_RESULT_CANCELLED:2,QUICK_REPLY_TRANSCODE_RESULT_FAIL_IMAGE_UNKNOWN:3,QUICK_REPLY_TRANSCODE_RESULT_FAIL_IMAGE_ENCODING:4,QUICK_REPLY_TRANSCODE_RESULT_FAIL_IMAGE_FILE_COPY:5,QUICK_REPLY_TRANSCODE_RESULT_FAIL_VIDEO_UNKNOWN:6}),He=Object.freeze({CELLULAR_UNKNOWN:0,WIFI_UNKNOWN:1,CELLULAR_EDGE:100,CELLULAR_IDEN:101,CELLULAR_UMTS:102,CELLULAR_EVDO:103,CELLULAR_GPRS:104,CELLULAR_HSDPA:105,CELLULAR_HSUPA:106,CELLULAR_HSPA:107,CELLULAR_CDMA:108,CELLULAR_1XRTT:109,CELLULAR_EHRPD:110,CELLULAR_LTE:111,CELLULAR_HSPAP:112}),qe=Object.freeze({CALLS_TAB:1,GROUP_CALL_UI:2,ATTACHMENT:3,WEB_MENU:4}),ze=Object.freeze({STATIC:0,SHARED:1}),Je=Object.freeze({STICKER_SEARCH:1,FORWARD:2,STICKER_PICKER_TAB_RECENTS:3,STICKER_PICKER_TAB_FAVORITES:4,STICKER_PICKER_TAB_EMOTION:5,STICKER_PICKER_TAB_PACK:6,STICKER_PICKER_TAB_CONTEXTUAL_SUGGESTIONS:7}),Qe=Object.freeze({NONE:1,SPEEX:2,WEBRTC:3,MWEBRTC:4,ECHOSUPPRESSOR:5}),Xe=Object.freeze({OTHER:1,APP_OPEN:2,CHAT_OPEN:3,IMAGE_OPEN:4,FIRST_FTS_RESULT:5,CONTACTS_OPEN:6}),Ze=Object.freeze({UNKNOWN:1,CHAT_PERSONAL:2,CHAT_GROUP:3,STATUS_USER:4,PRODUCT_CATALOG:5,STICKER_WEB:6,PAYMENTS_KYC:7,MESSAGE_HISTORY_SYNC:8}),$e=Object.freeze({SUCCESS:0,UNKNOWN_ERROR:1,INVALID_ARGS:2,HTTP_ERROR:3,INVALID_RESPONSE:4,MEM_ALLOC_ERROR:5,NO_DEVICE_FOUND:6,NO_IGD_FOUND:7,NOT_ON_WIFI:100,TOO_MANY_PORTS:101,TIMEOUT:102,ERR_CODE_INVALID_ACTION:401,ERR_CODE_INVALID_ARGS:402,ERR_CODE_ACTION_FAILED:501,ERR_CODE_ACTION_NOT_AUTHORIZED:606,ERR_CODE_PINHOLE_SPACE_EXHAUSTED:701,ERR_CODE_FIREWALL_DISABLED:702,ERR_CODE_INBOUND_PINHOLE_NOT_ALLOWED:703,ERR_CODE_NO_SUCH_ENTRY:704,ERR_CODE_PROTOCOL_NOT_SUPPORTED:705,ERR_CODE_INTERNAL_PORT_WILDCARD_NOT_ALLOWED:706,ERR_CODE_PROTOCOL_WILDCARD_NOT_ALLOWED:707,ERR_CODE_WILDCARD_NOT_PERMITTED_IN_SRC_IP:708,ERR_CODE_NO_PACKET_SENT:709,ERR_CODE_SPECIFIED_ARRAY_INDEX_INVALID:713,ERR_CODE_NO_SUCH_ENTRY_IN_ARRAY:714,ERR_CODE_WILD_CARD_NOT_PERMITTED_IN_SRC_IP:715,ERR_CODE_WILD_CARD_NOT_PERMITTED_IN_EXT_PORT:716,ERR_CODE_CONFLICT_IN_MAPPING_ENTRY:718,ERR_CODE_SAME_PORT_VALUES_REQUIRED:724,ERR_CODE_ONLY_PERMANENT_LEASES_SUPPORTED:725,ERR_CODE_REMOTE_HOST_ONLY_SUPPORTS_WILDCARD:726,ERR_CODE_EXTERNAL_PORT_ONLY_SUPORTS_WILDCARD:727,ERR_CODE_NO_PORT_MAPS_AVAILABLE:728,ERR_CODE_CONFLICT_WITH_OTHER_MECHANISMS:729,ERR_CODE_WILD_CARD_NOT_PERMITTED_IN_INT_PORT:732,DISABLED:999}),et=Object.freeze({SUCCESS:0,UNKNOWN_ERROR:1,INVALID_ARGS:2,HTTP_ERROR:3,INVALID_RESPONSE:4,MEM_ALLOC_ERROR:5,NO_DEVICE_FOUND:6,NO_IGD_FOUND:7,NOT_ON_WIFI:100,TIMEOUT:102,ERR_CODE_INVALID_ACTION:401,ERR_CODE_INVALID_ARGS:402,ERR_CODE_ACTION_FAILED:501,ERR_CODE_ACTION_NOT_AUTHORIZED:606,ERR_CODE_WILD_CARD_NOT_PERMITTED_IN_SRC_IP:715,ERR_CODE_WILD_CARD_NOT_PERMITTED_IN_EXT_PORT:716,ERR_CODE_NO_PORT_MAPS_AVAILABLE:728,ERR_CODE_CONFLICT_WITH_OTHER_MECHANISMS:729,ERR_CODE_WILD_CARD_NOT_PERMITTED_IN_INT_PORT:732,DISABLED:999}),tt=Object.freeze({INVALID_STANZA:1,JSON_FETCH:2,JSON_PARSE:3,IMAGE_FETCH:4}),rt=Object.freeze({BANNER_APPEAR:1,BANNER_SELECT:2,MODAL_APPEAR:3,MODAL_DISMISS:4,MODAL_LINK_FOLLOW:5,MODAL_ACCEPT:6,BLOCKING_MODAL_APPEAR:7,BLOCKING_MODAL_LINK_FOLLOW:8,BLOCKING_MODAL_ACCEPT:9,BANNER_DISMISS:10,EDUCATION_1_APPEAR:11,EDUCATION_1_DISMISS:12,EDUCATION_1_CONTINUE:13,MODAL_BACK:14,BLOCKING_MODAL_BACK:15}),at=Object.freeze({ACTION_IMPRESSION:1,ACTION_CLICK_WEBSITE:2,ACTION_CLICK_LOCATION:3,ACTION_CLICK_HOURS:4,ACTION_CLICK_DESCRIPTION:5,ACTION_CLICK_EMAIL:6,ACTION_CLICK_ADDTOCONTACT:7,ACTION_CLICK_MORE_BIZ_PROFILE:8}),nt=Object.freeze({STATIC:0,SHARED:1}),it=Object.freeze({INVALID:0,NOT_SINGLE_SEGMENT_CALL:1,NOT_START_FROM_VIDEO_CALL:2,HAS_AV_SWITCH:3,SELF_CAMERA_OFF:4,PEER_CAMERA_OFF:5,SELF_HAS_NETWORK_TRANSITION:6,PEER_HAS_NETWORK_TRANSITION:7,CALL_TOO_SHORT:8,PASS:100}),st=Object.freeze({UNCACHED:0,IDLE:1,CHECKING:2,DOWNLOADING:3,UPDATEREADY:4,OBSOLETE:5}),ot=Object.freeze({UNCACHED:0,IDB:1,SW:2}),ut=Object.freeze({INDIVIDUAL:0,GROUP:1,BROADCAST_LIST:2}),lt=Object.freeze({WEBCRYPTO:0,CRYPTOJS:1}),dt=Object.freeze({ENCRYPT:0,DECRYPT:1}),ct=Object.freeze({PROD:0,INTERN:1,DEV:2}),ft=Object.freeze({SUCCESS:0,SILENCE:1,ZEROWIDTH:2}),pt=Object.freeze({DOWNLOAD:1,UPLOAD:2}),ht=Object.freeze({OTHER:0,RESOLVED:1,NEEDS_RMR:2}),_t=Object.freeze({NEW_GROUP:1,CREATE_A_ROOM:2,PROFILE:3,CATALOG:4,ARCHIVED:5,STARRED:6,LABELS:7,SETTINGS:8,LOG_OUT:9,CONTACT_INFO:10,SELECT_MESSAGES:11,CLOSE_CHAT:12,MUTE_NOTIFICATIONS:13,CLEAR_MESSAGES:14,DELETE_CHAT:15,REPORT_BUSINESS:16,BLOCK:17,SETTINGS_NOTIFICATIONS:18,SETTINGS_THEME:19,SETTINGS_CHAT_WALLPAPER:20,SETTINGS_BLOCKED:21,SETTINGS_HELP:22,OPEN:23,CLOSE:24}),mt=Object.freeze({THREADS_SCREEN_CLICK:1,CHAT_SCREEN_CLICK:2,SETTINGS_SCREEN_CLICK:3}),gt=Object.freeze({LOAD_PREV:0,LOAD_NEXT:1,LOAD_AROUND:2}),vt=Object.freeze({NAVIGATE_NEXT:0,RELOAD:1,BACK_FORWARD:2,UNDEFINED:255}),Et=Object.freeze({UNKNOWN:0,USER_SCROLL:1,NEW_MESSAGE_PREFETCH:2,SEARCH_RESULT_CLICK:3}),yt=Object.freeze({OTHER:0,MSG_CLICK:1,STICKER_PANEL_ICON:2,MEDIA_VIEWER:3,VIDEO_STREAMING:4,STATUS_V3:5,MULTI_SELECT_DOWNLOAD:6,DOCUMENT_DOWNLOAD:7,PIP:8,STICKER_PANEL_STICKER:9,SEND_TO_CHAT:10,UPLOAD:11,MSG_INIT:12,MSG_UPDATE:13,MSG_DELETE:14,MSG_RENDER:15}),St=Object.freeze({TEXT:0,URL:1,IMAGE:2,VIDEO:3,GIF:4}),Tt=Object.freeze({MY:0,RECENT:1,VIEWED:2,MUTED:3}),bt=Object.freeze({QR:0,MAIN:1,SYNCING:2,OFFLINE:3,CONFLICT:4,PROXYBLOCK:5,TOS_BLOCK:6,SMB_TOS_BLOCK:7,DEPRECATED_VERSION:8}),At=Object.freeze({PHONE:0,SERVER:1}),Ct=Object.freeze({GET:0,SET:1}),Pt=Object.freeze({WEB:1,WIN32:2,DARWIN:3,IOS_TABLET:4,ANDROID_TABLET:5,WINSTORE:6,MACSTORE:7,DARWIN_BETA:8,WIN32_BETA:9}),Ot=Object.freeze({FALSE:0,TRUE:1,UNDEFINED:2}),wt=Object.freeze({SOURCE_OTHER:1,SOURCE_INSTAGRAM:2}),Mt=Object.freeze({DISCONNECTED:1,CONNECTING:2,CONNECTED:3,UNKNOWN:4}),It=Object.freeze({DISABLED:0,ALLOC:1,ALLOC_AND_RTP:2}),Rt=(0,i.defineGlobal)({appVersion:[17,l],browser:[779,l],browserVersion:[295,l],datacenter:[2795,l],deviceName:[13,l],deviceVersion:[4505,l],mcc:[5,o],mnc:[3,o],networkIsWifi:[23,s],platform:[11,ke],webcBucket:[875,l],webcEnv:[633,ct],webcNativeAutolaunch:[1009,s],webcNativeBetaUpdates:[1007,s],webcPhoneAppVersion:[1005,l],webcPhoneCharging:[783,s],webcPhoneDeviceManufacturer:[829,l],webcPhoneDeviceModel:[831,l],webcPhoneOsBuildNumber:[833,l],webcPhoneOsVersion:[835,l],webcPhonePlatform:[707,ke],webcTabId:[3727,l],webcWebArch:[6605,l],webcWebDeviceManufacturer:[6599,l],webcWebDeviceModel:[6601,l],webcWebOsReleaseNumber:[6603,l],webcWebPlatform:[899,Pt]});(0,i.defineEvents)({ArchiveSettings:[2788,{keepChatsArchived:[1,s]},[1,1,1]],BannerEvent:[1578,{bannerOperation:[2,g],bannerType:[1,v]},[1,1,1]],Call:[462,{acceptAckLatencyMs:[1016,d],acceptedButNotConnectedTimeSpentMs:[1015,d],activeRelayProtocol:[412,o],allocErrorBitmap:[593,o],androidCamera2MinHardwareSupportLevel:[444,p],androidCameraApi:[443,h],androidSystemPictureInPictureT:[477,d],androidTelecomTimeSpentBeforeReject:[497,d],audioCodecDecodedFecFrames:[755,o],audioCodecDecodedPlcFrames:[756,o],audioCodecEncodedFecFrames:[751,o],audioCodecEncodedNonVoiceFrames:[753,o],audioCodecEncodedVoiceFrames:[752,o],audioCodecReceivedFecFrames:[754,o],audioDeviceIssues:[860,o],audioDeviceLastIssue:[861,o],audioDeviceSwitchCount:[867,o],audioDeviceSwitchDuration:[866,d],audioFrameLoss1xMs:[724,d],audioFrameLoss2xMs:[725,d],audioFrameLoss4xMs:[726,d],audioFrameLoss8xMs:[727,d],audioGetFrameUnderflowPs:[83,o],audioInbandFecDecoded:[679,o],audioInbandFecEncoded:[678,o],audioLossPeriodCount:[722,o],audioNackReqPktsRecvd:[646,o],audioNackReqPktsSent:[645,o],audioNackRtpRetransmitDiscardCount:[649,o],audioNackRtpRetransmitFailCount:[651,o],audioNackRtpRetransmitRecvdCount:[648,o],audioNackRtpRetransmitReqCount:[647,o],audioNackRtpRetransmitSentCount:[650,o],audioNumPiggybackRxPkt:[1008,o],audioNumPiggybackTxPkt:[1007,o],audioPlayCbLatencyAvg:[1032,o],audioPlayCbLatencyMax:[1031,o],audioPlayCbLatencyMin:[1030,o],audioPlayCbLatencyStddev:[1033,o],audioPutFrameOverflowPs:[82,o],audioRecCbLatencyAvg:[1036,o],audioRecCbLatencyMax:[1035,o],audioRecCbLatencyMin:[1034,o],audioRecCbLatencyStddev:[1037,o],audioRtxPktDiscarded:[677,o],audioRtxPktProcessed:[676,o],audioRtxPktSent:[675,o],audioRxAvgFpp:[728,u],audioRxPktLossPctDuringPip:[642,u],audioTotalBytesOnNonDefCell:[450,u],avAvgDelta:[192,u],avMaxDelta:[193,u],aveNumPeersAutoPaused:[578,o],aveTimeBwResSwitches:[994,d],aveTimeBwVidRcDynCondTrue:[719,d],avgClockCbT:[139,d],avgDecodeT:[136,d],avgDiffAudioVideoFrameT:[1028,d],avgEncodeT:[135,d],avgEventQueuingDelay:[816,o],avgPlayCbT:[137,d],avgRecordCbIntvT:[495,d],avgRecordCbT:[138,d],avgRecordGetFrameT:[140,d],avgTargetBitrate:[141,u],avgTcpConnCount:[413,o],avgTcpConnLatencyInMsec:[414,d],batteryDropMatched:[355,s],batteryDropTriggered:[442,s],batteryLowMatched:[354,s],batteryLowTriggered:[441,s],batteryRulesApplied:[353,s],biDirRelayRebindLatencyMs:[843,d],biDirRelayResetLatencyMs:[844,d],builtinAecAvailable:[33,s],builtinAecEnabled:[38,s],builtinAecImplementor:[36,l],builtinAecUuid:[37,l],builtinAgcAvailable:[34,s],builtinNsAvailable:[35,s],c2DecAvgT:[302,d],c2DecFrameCount:[300,o],c2DecFramePlayed:[301,o],c2EncAvgT:[298,d],c2EncCpuOveruseCount:[299,o],c2EncFrameCount:[297,o],c2RxTotalBytes:[296,o],c2TxTotalBytes:[295,o],callAcceptFuncT:[132,d],callAecMode:[39,c],callAecOffset:[42,o],callAecTailLength:[43,o],callAgcMode:[52,f],callAndrGcmFgEnabled:[268,s],callAndroidAudioMode:[55,o],callAndroidRecordAudioPreset:[57,o],callAndroidRecordAudioSource:[56,o],callAudioEngineType:[54,_],callAudioRestartCount:[96,u],callAudioRestartReason:[97,u],callAvgAudioRxPipBitrate:[640,u],callAvgRottRx:[259,d],callAvgRottTx:[258,d],callAvgRtt:[107,d],callAvgVideoRxPipBitrate:[638,u],callBatteryChangePct:[195,u],callCalculatedEcOffset:[50,o],callCalculatedEcOffsetStddev:[51,o],callCreatorHid:[505,l],callDefNetwork:[405,b],callEcRestartCount:[99,u],callEchoEnergy:[46,u],callEchoLikelihood:[44,o],callEchoLikelihoodBeforeEc:[47,u],callEndFuncT:[130,d],callEndReconnecting:[70,s],callEndReconnectingBeforeNetworkChange:[877,s],callEndReconnectingBeforeP2pFailover:[875,s],callEndReconnectingBeforeRelayFailover:[869,s],callEndReconnectingBeforeRelayReset:[948,s],callEndReconnectingSoonAfterCallActive:[848,s],callEndReconnectingSoonAfterNetworkChange:[878,s],callEndReconnectingSoonAfterP2pFailover:[876,s],callEndReconnectingSoonAfterRelayFailover:[870,s],callEndReconnectingSoonAfterRelayReset:[949,s],callEndedDuringAudFreeze:[518,s],callEndedDuringVidFreeze:[517,s],callEndedInterrupted:[23,s],callEnterPipModeCount:[626,o],callFromUi:[2,T],callHistEchoLikelihood:[45,u],callInitialRtt:[109,d],callInterrupted:[22,s],callIsLastSegment:[388,s],callLastRtt:[108,d],callMaxRtt:[106,d],callMessagesBufferedCount:[422,o],callMinRtt:[105,d],callNetwork:[76,b],callNetworkSubtype:[77,o],callNsMode:[53,Me],callOfferAckTimout:[159,u],callOfferDelayT:[243,d],callOfferElapsedT:[102,d],callOfferFanoutCount:[588,o],callOfferReceiptDelay:[134,d],callP2pAvgRtt:[457,d],callP2pDisabled:[18,s],callP2pMinRtt:[456,d],callPeerAppVersion:[15,l],callPeerIpStr:[10,l],callPeerIpv4:[8,o],callPeerPlatform:[5,l],callPendingCallsAcceptedCount:[501,o],callPendingCallsCount:[498,o],callPendingCallsRejectedCount:[499,o],callPendingCallsTerminatedCount:[500,o],callPipMode10sCount:[628,o],callPipMode10sT:[633,d],callPipMode120sCount:[631,o],callPipMode120sT:[636,d],callPipMode240sCount:[632,o],callPipMode240sT:[637,d],callPipMode30sCount:[629,o],callPipMode30sT:[634,d],callPipMode60sCount:[630,o],callPipMode60sT:[635,d],callPipModeT:[627,d],callPlaybackBufferSize:[59,o],callPlaybackCallbackStopped:[25,s],callPlaybackFramesPs:[93,u],callPlaybackSilenceRatio:[95,u],callRadioType:[231,He],callRandomId:[529,l],callRecentPlaybackFramesPs:[94,u],callRecentRecordFramesPs:[29,u],callReconnectingStateCount:[438,o],callRecordBufferSize:[58,o],callRecordCallbackStopped:[24,s],callRecordFramesPs:[28,o],callRecordMaxEnergyRatio:[98,u],callRecordSilenceRatio:[26,o],callRejectFuncT:[131,d],callRelayAvgRtt:[455,d],callRelayBindStatus:[16,A],callRelayCreateT:[104,d],callRelayMinRtt:[454,d],callRelayServer:[17,l],callResult:[63,C],callRingingT:[103,d],callRxAvgBitrate:[121,u],callRxAvgBwe:[122,u],callRxAvgJitter:[125,d],callRxAvgLossPeriod:[128,d],callRxMaxJitter:[124,d],callRxMaxLossPeriod:[127,d],callRxMinJitter:[123,d],callRxMinLossPeriod:[126,d],callRxPktLossPct:[120,u],callRxPktLossRetransmitPct:[892,u],callRxStoppedT:[100,d],callSamplingRate:[30,o],callSegmentIdx:[389,o],callSegmentType:[393,P],callSelfIpStr:[9,l],callSelfIpv4:[7,o],callServerNackErrorCode:[68,o],callSetupErrorType:[71,O],callSetupT:[101,d],callSide:[1,w],callSoundPortFuncT:[133,d],callStartFuncT:[129,d],callSwAecMode:[41,o],callSwAecType:[40,Qe],callT:[92,d],callTermReason:[69,M],callTestBucket:[19,l],callTestEvent:[318,o],callTonesDetectedInRecord:[49,o],callTonesDetectedInRingback:[48,o],callTransitionCount:[78,o],callTransitionCountCellularToWifi:[432,o],callTransitionCountWifiToCellular:[431,o],callTransport:[72,I],callTransportExtrayElected:[515,s],callTransportP2pToRelayFallbackCount:[80,o],callTransportPeerTcpUsed:[587,s],callTransportRelayToRelayFallbackCount:[79,o],callTransportTcpFallbackToUdp:[516,s],callTransportTcpUsed:[514,s],callTxAvgBitrate:[112,u],callTxAvgBwe:[113,u],callTxAvgJitter:[116,d],callTxAvgLossPeriod:[119,d],callTxMaxJitter:[115,d],callTxMaxLossPeriod:[118,d],callTxMinJitter:[114,d],callTxMinLossPeriod:[117,d],callTxPktErrorPct:[111,u],callTxPktLossPct:[110,u],callUserRate:[20,o],callWakeupSource:[156,D],calleeAcceptToDecodeT:[447,d],callerInContact:[476,s],callerOfferToDecodeT:[445,d],callerVidRtpToDecodeT:[446,d],cameraFormats:[765,o],cameraIssues:[850,o],cameraLastIssue:[851,o],cameraOffCount:[331,o],cameraPermission:[849,s],cameraPreviewMode:[322,N],cameraStartDuration:[852,d],cameraStartFailureDuration:[856,d],cameraStartMode:[233,L],cameraStartToFirstFrameT:[916,d],cameraStopDuration:[853,d],cameraStopFailureCount:[858,o],cameraSwitchCount:[855,o],cameraSwitchDuration:[854,d],cameraSwitchFailureDuration:[857,d],clampedBwe:[527,s],codecSamplingRate:[624,o],combinedE2eAvgRtt:[760,u],combinedE2eMaxRtt:[761,u],combinedE2eMinRtt:[759,u],confBridgeSamplingRate:[623,o],conservativeModeStopped:[974,s],conservativeRampUpExploringT:[743,d],conservativeRampUpHeldCount:[643,o],conservativeRampUpHoldingT:[741,d],conservativeRampUpRampingUpT:[742,d],createdFromGroupCallDowngrade:[519,s],dataLimitOnAltNetworkReached:[537,s],deviceBoard:[230,l],deviceHardware:[229,l],dtxRxByteFrameCount:[914,o],dtxRxCount:[912,o],dtxRxDurationT:[911,d],dtxRxTotalCount:[913,o],dtxTxByteFrameCount:[910,o],dtxTxCount:[619,o],dtxTxDurationT:[618,d],dtxTxTotalCount:[909,o],echoCancellationMsPerSec:[320,o],echoCancelledFrameCount:[940,o],echoEstimatedFrameCount:[941,o],echoSpeakerModeFrameCount:[987,o],encoderCompStepdowns:[81,o],endCallAfterConfirmation:[90,te],failureToCreateAltSocket:[534,o],failureToCreateTestAltSocket:[532,o],fastplayMaxDurationMs:[1005,d],fastplayNumFrames:[1004,o],fastplayNumTriggers:[1006,o],fieldStatsRowType:[328,ae],finishedDlBwe:[503,s],finishedOverallBwe:[528,s],finishedUlBwe:[502,s],freezeBweCongestionCorrPct:[1009,u],groupAcceptNoCriticalGroupUpdate:[1013,s],groupAcceptToCriticalGroupUpdateMs:[1014,d],groupCallCallerParticipantCountAtCallStart:[439,o],groupCallInviteCountSinceCallStart:[360,o],groupCallIsGroupCallInvitee:[357,s],groupCallIsLastSegment:[356,s],groupCallNackCountSinceCallStart:[361,o],groupCallReringCountSinceCallStart:[946,o],groupCallReringNackCountSinceCallStart:[947,o],groupCallSegmentIdx:[329,o],groupCallTotalCallTSinceCallStart:[358,d],groupCallTotalP3CallTSinceCallStart:[359,d],groupCallVideoMaximizedCount:[592,o],hasRestrictedSettingsForAudioCalls:[539,s],highPeerBweT:[884,d],hisBasedInitialTxBitrate:[342,o],hisInfoCouldBeUsedForInitBwe:[339,s],historyBasedBweActivated:[807,s],historyBasedBweEnabled:[806,s],historyBasedBweSuccess:[808,s],historyBasedBweVideoTxBitrate:[809,o],incomingCallUiAction:[387,ie],initBweSource:[337,se],initialEstimatedTxBitrate:[244,u],isIpv6Capable:[91,s],isPendingCall:[976,s],isRejoin:[927,s],isRering:[945,s],isUpnpExternalIpPrivate:[260,s],isUpnpExternalIpTheSameAsReflexiveIp:[261,s],jbAvgDelay:[146,u],jbAvgDelayUniform:[644,u],jbAvgTargetSize:[1012,u],jbDiscards:[150,u],jbEmpties:[151,u],jbEmptyPeriods1x:[997,u],jbEmptyPeriods2x:[998,u],jbEmptyPeriods4x:[999,u],jbEmptyPeriods8x:[1e3,u],jbGets:[152,u],jbLastDelay:[149,u],jbLost:[277,u],jbLostEmptyDuringPip:[641,o],jbLostEmptyHighPeerBwePerSec:[777,u],jbLostEmptyLowPeerBwePerSec:[775,u],jbLostEmptyLowToHighPeerBwePerSec:[776,u],jbMaxDelay:[148,u],jbMinDelay:[147,u],jbNonSpeechDiscards:[846,u],jbPuts:[153,u],jbTotalEmptyPeriods:[996,u],joinableAfterCall:[895,s],joinableDuringCall:[894,s],joinableNewUi:[893,s],l1Locations:[986,l],lastConnErrorStatus:[415,o],libsrtpVersionUsed:[504,ze],longConnect:[21,s],lossOfAltSocket:[535,o],lossOfTestAltSocket:[533,o],lowDataUsageBitrate:[157,u],lowPeerBweT:[885,d],lowToHighPeerBweT:[886,d],malformedStanzaXpath:[452,l],maxEventQueueDepth:[558,o],mediaStreamSetupT:[448,d],micAvgPower:[253,o],micMaxPower:[252,o],micMinPower:[251,o],micPermission:[859,s],micStartDuration:[862,d],micStartToFirstCallbackT:[931,d],micStopDuration:[863,d],multipleTxRxRelaysInUse:[838,s],nativeSamplesPerFrame:[32,l],nativeSamplingRate:[31,l],neteqAcceleratedFrames:[653,o],neteqExpandedFrames:[652,o],networkMediumChangeLatencyMs:[995,d],numAsserts:[933,o],numConnectedParticipants:[330,o],numCriticalGroupUpdateDropped:[567,o],numDirPjAsserts:[985,o],numL1Errors:[929,o],numL2Errors:[930,o],numOutOfOrderCriticalGroupUpdate:[625,o],numPeersAutoPausedOnce:[577,o],numRenderSkipGreenFrame:[1029,o],numResSwitch:[993,o],numVidDlAutoPause:[574,o],numVidDlAutoResume:[576,o],numVidDlAutoResumeRejectBadAudio:[579,o],numVidRcDynCondTrue:[717,o],numVidUlAutoPause:[559,o],numVidUlAutoPauseFail:[560,o],numVidUlAutoPauseRejectHighSendingRate:[564,o],numVidUlAutoPauseRejectTooEarly:[565,o],numVidUlAutoPauseUserAction:[566,o],numVidUlAutoResume:[561,o],numVidUlAutoResumeFail:[562,o],numVidUlAutoResumeRejectAudioLqm:[563,o],numberOfProcessors:[27,o],offerAckLatencyMs:[1017,d],oibweDlProbingTime:[805,d],oibweE2eProbingTime:[802,d],oibweNotFinishedWhenCallActive:[868,s],oibweOibleProbingTime:[803,d],oibweUlProbingTime:[804,d],onMobileDataSaver:[525,s],onWifiAtStart:[540,s],oneSideInitRxBitrate:[507,o],oneSideInitTxBitrate:[506,o],oneSideMinPeerInitRxBitrate:[509,o],oneSideRcvdPeerRxBitrate:[508,s],opusVersion:[287,o],p2pSuccessCount:[522,o],pcntPoorAudLqmAfterPause:[599,u],pcntPoorAudLqmBeforePause:[598,u],pcntPoorVidLqmAfterPause:[597,u],pcntPoorVidLqmBeforePause:[596,u],peerCallNetwork:[264,Le],peerCallResult:[66,C],peerTransport:[591,I],peerVideoHeight:[191,o],peerVideoWidth:[190,o],peerXmppStatus:[4,Mt],pingsSent:[160,u],pongsReceived:[161,u],poolMemUsage:[510,o],poolMemUsagePadding:[511,o],presentEndCallConfirmation:[89,te],previousCallInterval:[266,d],previousCallVideoEnabled:[265,s],previousCallWithSamePeer:[267,s],previousJoinNotEnded:[1001,s],probeAvgBitrate:[327,u],pushToCallOfferDelay:[158,u],rcMaxrtt:[155,u],rcMinrtt:[154,u],reconnectingStartsBeforeCallActive:[847,s],recordCircularBufferFrameCount:[84,o],reflectivePortsDiff:[162,u],relayBindFailureAltNetSwitchSuccess:[583,o],relayBindFailureAltNetSwitchTriggered:[582,o],relayBindFailureAltNetworkSwitchToCallEnd:[586,d],relayBindFailureFallbackCount:[581,o],relayBindFailureIpVersionSwitchToCallEnd:[585,d],relayBindFailureIpVersionSwitchTriggered:[584,o],relayBindTimeInMsec:[424,d],relayElectionTimeInMsec:[423,d],relayFallbackOnRxDataFromRelay:[481,o],relayFallbackOnStopRxDataOnP2p:[482,o],relayFallbackOnTransportStanzaNotification:[483,o],renderFreezeHighPeerBweT:[780,d],renderFreezeLowPeerBweT:[778,d],renderFreezeLowToHighPeerBweT:[779,d],rxProbeCountSuccess:[291,o],rxProbeCountTotal:[290,o],rxRelayRebindLatencyMs:[841,d],rxRelayResetLatencyMs:[842,d],rxTotalBitrate:[145,u],rxTotalBytes:[143,u],rxTpFbBitrate:[294,u],rxTrafficStartFalsePositive:[758,s],sbweAvgDowntrend:[963,u],sbweAvgUptrend:[962,u],sbweCeilingCongestionCount:[783,o],sbweCeilingCount:[781,o],sbweCeilingMissingRtcpCongestionCount:[786,o],sbweCeilingNoNewDataReceivedCongestionCount:[787,o],sbweCeilingPktLossCount:[782,o],sbweCeilingRttCongestionCount:[784,o],sbweCeilingZeroRttCongestionCount:[785,o],sbweHoldCount:[961,o],sbweRampDownCount:[960,o],sbweRampUpCount:[959,o],senderBweInitBitrate:[975,o],sfuAbnormalUplinkRttCount:[879,o],sfuAvgLqHqTargetBitrateDiff:[1002,u],sfuAvgTargetBitrate:[673,u],sfuAvgTargetBitrateHq:[943,u],sfuBwaAllParticipantDlBwUsedPct:[919,u],sfuBwaAllParticipantUlBwUsedPct:[918,u],sfuBwaChangeNumStreamCount:[928,o],sfuBwaSelfDlBwUsedPct:[1003,u],sfuBwaSelfUlBwUsedPct:[917,u],sfuBwaSimulcastDisabledCntReasonBattery:[920,o],sfuBwaSimulcastDisabledCntReasonNetMedium:[921,o],sfuBwaVidEncHqStreamScheduledT:[926,d],sfuBwaVidEncLqStreamScheduledT:[925,d],sfuDownlinkAvgCombinedBwe:[662,u],sfuDownlinkAvgPktLossPct:[667,u],sfuDownlinkAvgRemoteBwe:[661,u],sfuDownlinkAvgSenderBwe:[660,u],sfuDownlinkMaxPktLossPct:[668,u],sfuDownlinkMinPktLossPct:[666,u],sfuDownlinkSbweAvgDowntrend:[973,u],sfuDownlinkSbweAvgUptrend:[972,u],sfuDownlinkSbweCeilingCongestionCount:[797,o],sfuDownlinkSbweCeilingCount:[795,o],sfuDownlinkSbweCeilingMissingRtcpCongestionCount:[800,o],sfuDownlinkSbweCeilingNoNewDataReceivedCongestionCount:[801,o],sfuDownlinkSbweCeilingPktLossCount:[796,o],sfuDownlinkSbweCeilingRttCongestionCount:[798,o],sfuDownlinkSbweCeilingZeroRttCongestionCount:[799,o],sfuDownlinkSbweHoldCount:[971,o],sfuDownlinkSbweRampDownCount:[970,o],sfuDownlinkSbweRampUpCount:[969,o],sfuDownlinkSenderBweDiffStddev:[958,u],sfuDownlinkSenderBweStddev:[957,u],sfuFirstRxParticipantReportTime:[883,d],sfuFirstRxUplinkReportTime:[881,d],sfuMaxTargetBitrate:[674,u],sfuMaxTargetBitrateHq:[944,u],sfuMinTargetBitrate:[672,u],sfuMinTargetBitrateHq:[942,u],sfuPeerDownlinkStddevAllCombinedBwe:[813,u],sfuRxParticipantReportCount:[882,o],sfuRxUplinkReportCount:[880,o],sfuSimulcastAvgDecSessFlipTime:[833,d],sfuSimulcastAvgEncSchedEventUpdateTime:[837,d],sfuSimulcastBwaCandidateCnt:[923,o],sfuSimulcastBwaDownlinkBottleneckCount:[874,o],sfuSimulcastBwaUplinkBottleneckCount:[873,o],sfuSimulcastDecAvgKfRecvTimeSinceFlip:[952,d],sfuSimulcastDecAvgNumReplayedCachedPkt:[951,u],sfuSimulcastDecAvgNumSkippedCachedPkt:[950,u],sfuSimulcastDecNumNoKf:[953,o],sfuSimulcastDecSessFlipCount:[744,o],sfuSimulcastDecSessFlipErrorBitmap:[768,o],sfuSimulcastDecSessFlipErrorCount:[767,o],sfuSimulcastEncErrorBitmap:[766,o],sfuSimulcastEncSchedEventCount:[732,o],sfuSimulcastEncSchedEventErrorCount:[735,o],sfuSimulcastEncSchedEventSkipCount:[734,o],sfuSimulcastEncSchedEventSuccessUpdateCount:[733,o],sfuSimulcastMaxDecSessFlipTime:[832,d],sfuSimulcastMaxEncSchedEventUpdateTime:[836,d],sfuSimulcastMinDecSessFlipTime:[831,d],sfuSimulcastMinEncSchedEventUpdateTime:[835,d],sfuUplinkAvgCombinedBwe:[659,u],sfuUplinkAvgPktLossPct:[664,u],sfuUplinkAvgRemoteBwe:[658,u],sfuUplinkAvgRtt:[670,u],sfuUplinkAvgSenderBwe:[657,u],sfuUplinkMaxPktLossPct:[665,u],sfuUplinkMaxRtt:[671,u],sfuUplinkMinPktLossPct:[663,u],sfuUplinkMinRtt:[669,u],sfuUplinkSbweAvgDowntrend:[968,u],sfuUplinkSbweAvgUptrend:[967,u],sfuUplinkSbweCeilingCongestionCount:[790,o],sfuUplinkSbweCeilingCount:[788,o],sfuUplinkSbweCeilingMissingRtcpCongestionCount:[793,o],sfuUplinkSbweCeilingNoNewDataReceivedCongestionCount:[794,o],sfuUplinkSbweCeilingPktLossCount:[789,o],sfuUplinkSbweCeilingRttCongestionCount:[791,o],sfuUplinkSbweCeilingZeroRttCongestionCount:[792,o],sfuUplinkSbweHoldCount:[966,o],sfuUplinkSbweRampDownCount:[965,o],sfuUplinkSbweRampUpCount:[964,o],sfuUplinkSenderBweDiffStddev:[956,u],sfuUplinkSenderBweStddev:[955,u],simulcastAvgLqBitrateWhenHqEnabled:[1011,o],simulcastReplayVideoRenderFreeze2xT:[982,d],simulcastReplayVideoRenderFreeze4xT:[983,d],simulcastReplayVideoRenderFreeze8xT:[984,d],simulcastReplayVideoRenderFreezeT:[981,d],skippedBwaCycles:[748,o],skippedBweCycles:[747,o],smallCallButton:[6,s],speakerAvgPower:[250,o],speakerMaxPower:[249,o],speakerMinPower:[248,o],speakerStartDuration:[864,d],speakerStartToFirstCallbackT:[932,d],speakerStopDuration:[865,d],startedInitBweProbing:[900,s],switchToDefTriggeredByGoodDefNet:[538,o],switchToNonSfu:[750,o],switchToSfu:[749,o],symmetricNatPortGap:[257,o],systemNotificationOfNetChange:[541,o],telecomFrameworkCallStartDelayT:[440,d],timeEnc1280w:[992,d],timeEnc160w:[988,d],timeEnc320w:[989,d],timeEnc480w:[990,d],timeEnc640w:[991,d],timeOnNonDefNetwork:[530,d],timeOnNonDefNetworkPerSegment:[531,d],timeSinceLastRtpToCallEndInMsec:[715,d],timeVidRcDynCondTrue:[718,d],totalAudioFrameLossMs:[723,d],totalBytesOnNonDefCell:[449,u],totalTimeVidDlAutoPause:[575,d],totalTimeVidUlAutoPause:[573,d],trafficShaperAvgAudioQueueMs:[898,d],trafficShaperAvgQueueMs:[242,d],trafficShaperAvgVideoQueueMs:[899,d],trafficShaperMaxDelayViolations:[240,o],trafficShaperMinDelayViolations:[241,o],trafficShaperOverflowCount:[237,o],trafficShaperQueueEmptyCount:[238,o],trafficShaperQueuedAudioPacketCount:[896,o],trafficShaperQueuedPacketCount:[239,o],trafficShaperQueuedVideoPacketCount:[897,o],transportCurTimeInMsecAsyncWriteWaitingInQueue:[552,d],transportLastSendOsError:[555,o],transportNumAsyncWriteDispatched:[580,o],transportNumAsyncWriteQueued:[551,o],transportOvershoot10PercCount:[699,o],transportOvershoot20PercCount:[700,o],transportOvershoot40PercCount:[701,o],transportOvershootLongestStreakS:[708,o],transportOvershootSinceLast10sCount:[704,o],transportOvershootSinceLast15sCount:[705,o],transportOvershootSinceLast1sCount:[702,o],transportOvershootSinceLast30sCount:[706,o],transportOvershootSinceLast5sCount:[703,o],transportOvershootStreakAvgS:[709,u],transportOvershootTimeBetweenAvgS:[707,u],transportRtpSendErrorRate:[557,u],transportSendErrorCount:[556,o],transportSrtpRxMaxPktSize:[1038,o],transportSrtpRxRejectedBitrate:[763,u],transportSrtpRxRejectedDupPktCnt:[772,o],transportSrtpRxRejectedPktCnt:[762,o],transportSrtpTxFailedPktCnt:[774,o],transportSrtpTxMaxPktSize:[773,o],transportTotalNumSendOsError:[554,o],transportTotalTimeInMsecAsyncWriteQueueToDispatch:[553,d],transportUndershoot10PercCount:[710,o],transportUndershoot20PercCount:[711,o],transportUndershoot40PercCount:[712,o],triggeredButDataLimitReached:[536,o],txProbeCountSuccess:[289,o],txProbeCountTotal:[288,o],txRelayRebindLatencyMs:[839,d],txRelayResetLatencyMs:[840,d],txTotalBitrate:[144,u],txTotalBytes:[142,u],txTpFbBitrate:[293,u],upnpAddResultCode:[246,$e],upnpRemoveResultCode:[247,et],usedInitTxBitrate:[341,o],userDescription:[87,l],userProblems:[88,o],userRating:[86,o],vidAveSuccBurstyPktLossLength:[691,o],vidAveSuccNonBurstyPktLossLength:[692,o],vidCorrectRetxDetectPcnt:[688,o],vidFreezeTMsInSample0:[695,d],vidNumBurstyPktLoss:[689,o],vidNumFecDroppedNoHole:[696,o],vidNumFecDroppedTooBig:[697,o],vidNumNonBurstyPktLoss:[690,o],vidNumRetxDropped:[698,o],vidNumRxRetx:[757,o],vidPktRxState0:[693,l],vidRxFecRateInSample0:[694,u],vidUlAutoPausedAtCallEnd:[589,s],vidUlTimeSinceAutoPauseAtCallEnd:[590,d],vidWrongRetxDetectPcnt:[716,o],videoActiveTime:[276,d],videoAveDelayLtrp:[484,d],videoAvgCombPsnr:[390,u],videoAvgEncodingPsnr:[410,u],videoAvgScalingPsnr:[408,u],videoAvgSenderBwe:[186,u],videoAvgTargetBitrate:[184,u],videoAvgTargetBitrateHq:[828,u],videoCaptureAvgFps:[222,o],videoCaptureConverterTs:[226,d],videoCaptureDupFrames:[887,o],videoCaptureFrameOverwriteCount:[496,o],videoCaptureHeight:[228,o],videoCaptureWidth:[227,o],videoCodecScheme:[401,o],videoCodecSubType:[303,o],videoCodecType:[236,o],videoDecAvgBitrate:[220,o],videoDecAvgConsecutiveKfVp8:[610,u],videoDecAvgConsecutiveLtrpVp8:[611,u],videoDecAvgFps:[207,u],videoDecAvgFramesFromFoundLtrVp8:[612,u],videoDecAvgFramesFromUnfoundLtrVp8:[613,u],videoDecColorId:[205,o],videoDecCrcMismatchFrames:[419,o],videoDecErrorFrames:[174,o],videoDecErrorFramesCodecSwitch:[714,o],videoDecErrorFramesDuplicate:[713,o],videoDecErrorFramesH264:[680,o],videoDecErrorFramesIgnoreConsecutive:[478,o],videoDecErrorFramesOutoforder:[682,o],videoDecErrorFramesSpsPpsH264:[812,o],videoDecErrorFramesSpsPpsMissingAfterResolutionSwitch:[810,o],videoDecErrorFramesSpsPpsNotSupportedAfterResolutionSwitch:[811,o],videoDecErrorFramesVp8:[681,o],videoDecErrorLtrpFramesVp8:[462,o],videoDecErrorLtrpFramesVp8CrcMismatch:[479,o],videoDecErrorLtrpFramesVp8NoLtr:[480,o],videoDecErrorLtrpFramesVp8NoLtr10:[615,o],videoDecErrorLtrpFramesVp8NoLtr5:[614,o],videoDecInputFrames:[172,o],videoDecKeyframes:[175,o],videoDecLatency:[223,d],videoDecLatencyH264:[684,d],videoDecLatencyVp8:[683,d],videoDecLostPackets:[210,o],videoDecLtrpFramesVp8:[461,o],videoDecLtrpPoolCreateFailed:[490,s],videoDecName:[204,o],videoDecNumPliThrottledByAllLtrp:[915,o],videoDecNumSkippedFramesVp8:[616,o],videoDecNumSwitchesToAllLtrp:[617,o],videoDecOutputFrames:[173,o],videoDecRestart:[206,o],videoDecSkipPackets:[209,o],videoDecodePausedCount:[232,o],videoDowngradeCount:[273,o],videoEnabled:[163,s],videoEnabledAtCallStart:[270,s],videoEncAllLtrpTimeInMsec:[609,d],videoEncAvgBitrate:[221,o],videoEncAvgConsecutiveKfVp8:[605,u],videoEncAvgConsecutiveLtrpVp8:[606,u],videoEncAvgFps:[216,u],videoEncAvgFpsHq:[825,u],videoEncAvgFramesFromFoundLtrVp8:[604,u],videoEncAvgFramesFromUnfoundLtrVp8:[603,u],videoEncAvgPsnrKeyFrameVp8:[465,u],videoEncAvgPsnrLtrpFrameVp8:[469,u],videoEncAvgPsnrPFramePrevRefVp8:[474,u],videoEncAvgQpKeyFrameVp8:[466,u],videoEncAvgQpLtrpFrameVp8:[470,u],videoEncAvgQpPFramePrevRefVp8:[475,u],videoEncAvgSizeAllLtrpFrameVp8:[685,u],videoEncAvgSizeKeyFrameVp8:[464,u],videoEncAvgSizeLtrpFrameVp8:[468,u],videoEncAvgSizePFramePrevRefVp8:[473,u],videoEncAvgTargetFps:[215,u],videoEncAvgTargetFpsHq:[827,u],videoEncColorId:[213,o],videoEncDeviationAllLtrpFrameVp8:[686,u],videoEncDeviationPFramePrevRefVp8:[687,u],videoEncDiscardFrame:[217,o],videoEncDiscardFrameHq:[938,o],videoEncDropFrames:[179,o],videoEncDropFramesHq:[937,o],videoEncErrorFrames:[178,o],videoEncErrorFramesHq:[936,o],videoEncInputFrames:[176,o],videoEncInputFramesHq:[934,o],videoEncKeyframes:[180,o],videoEncKeyframesHq:[939,o],videoEncKeyframesVp8:[463,o],videoEncKfErrCodecSwitchT:[731,d],videoEncKfIgnoreOldFrames:[729,o],videoEncKfQueueEmpty:[730,o],videoEncLatency:[224,d],videoEncLatencyHq:[826,d],videoEncLtrpFrameGenFailedVp8:[471,o],videoEncLtrpFramesVp8:[467,o],videoEncLtrpPoolCreateFailed:[491,s],videoEncLtrpToKfFallbackVp8:[494,o],videoEncName:[212,o],videoEncNumErrorLtrHoldFailedVp8:[600,o],videoEncNumErrorLtrHoldFailedVp810:[602,o],videoEncNumErrorLtrHoldFailedVp85:[601,o],videoEncNumSuccessHfFallbackVp8:[622,o],videoEncNumSwitchesToAllLtrp:[607,o],videoEncOutputFrames:[177,o],videoEncOutputFramesHq:[935,o],videoEncPFramePrevRefVp8:[472,o],videoEncRegularLtrpTimeInMsec:[608,d],videoEncRestart:[214,o],videoEncTimeOvershoot10PercH264:[363,d],videoEncTimeOvershoot10PercH265:[366,d],videoEncTimeOvershoot10PercVp8:[369,d],videoEncTimeOvershoot10PercVp9:[372,d],videoEncTimeOvershoot20PercH264:[364,d],videoEncTimeOvershoot20PercH265:[367,d],videoEncTimeOvershoot20PercVp8:[370,d],videoEncTimeOvershoot20PercVp9:[373,d],videoEncTimeOvershoot40PercH264:[365,d],videoEncTimeOvershoot40PercH265:[368,d],videoEncTimeOvershoot40PercVp8:[371,d],videoEncTimeOvershoot40PercVp9:[374,d],videoEncTimeSpentInFastH264Ms:[1026,d],videoEncTimeSpentInFasterH264Ms:[1025,d],videoEncTimeSpentInMediumH264Ms:[1027,d],videoEncTimeSpentInNegative10Vp8Ms:[1019,d],videoEncTimeSpentInNegative12Vp8Ms:[1018,d],videoEncTimeSpentInNegative4Vp8Ms:[1022,d],videoEncTimeSpentInNegative6Vp8Ms:[1021,d],videoEncTimeSpentInNegative8Vp8Ms:[1020,d],videoEncTimeSpentInSuperfastH264Ms:[1023,d],videoEncTimeSpentInVeryfastH264Ms:[1024,d],videoEncTimeUndershoot10PercH264:[375,d],videoEncTimeUndershoot10PercH265:[378,d],videoEncTimeUndershoot10PercVp8:[381,d],videoEncTimeUndershoot10PercVp9:[384,d],videoEncTimeUndershoot20PercH264:[376,d],videoEncTimeUndershoot20PercH265:[379,d],videoEncTimeUndershoot20PercVp8:[382,d],videoEncTimeUndershoot20PercVp9:[385,d],videoEncTimeUndershoot40PercH264:[377,d],videoEncTimeUndershoot40PercH265:[380,d],videoEncTimeUndershoot40PercVp8:[383,d],videoEncTimeUndershoot40PercVp9:[386,d],videoFecRecovered:[183,o],videoH264Time:[334,o],videoH265Time:[335,o],videoHeight:[189,o],videoInitRxBitrate16s:[904,u],videoInitRxBitrate2s:[901,u],videoInitRxBitrate4s:[902,u],videoInitRxBitrate8s:[903,u],videoInitialCodecScheme:[402,o],videoInitialCodecType:[321,o],videoLastCodecType:[404,o],videoLastSenderBwe:[185,u],videoMaxCombPsnr:[392,u],videoMaxEncodingPsnr:[411,u],videoMaxRxBitrate:[426,u],videoMaxScalingPsnr:[409,u],videoMaxTargetBitrate:[420,u],videoMaxTargetBitrateHq:[829,u],videoMaxTxBitrate:[425,u],videoMaxTxBitrateHq:[824,u],videoMinCombPsnr:[391,u],videoMinEncodingPsnr:[407,u],videoMinScalingPsnr:[406,u],videoMinTargetBitrate:[421,u],videoMinTargetBitrateHq:[830,u],videoNackSendDelay:[872,d],videoNewPktsBeforeNack:[871,o],videoNpsiGenFailed:[594,o],videoNpsiNoNack:[595,o],videoNumAvSyncDiscardFrames:[1010,o],videoNumH264Frames:[332,o],videoNumH265Frames:[333,o],videoPeerState:[275,R],videoPeerTriggeredPauseCount:[654,o],videoRenderAvgFps:[208,o],videoRenderConverterTs:[225,d],videoRenderDelayT:[196,d],videoRenderDupFrames:[888,o],videoRenderFreeze2xT:[304,d],videoRenderFreeze4xT:[305,d],videoRenderFreeze8xT:[306,d],videoRenderFreezeT:[235,d],videoRenderInitFreeze16sT:[908,d],videoRenderInitFreeze2sT:[905,d],videoRenderInitFreeze4sT:[906,d],videoRenderInitFreeze8sT:[907,d],videoRenderInitFreezeT:[526,d],videoRenderNumFreezes:[569,o],videoRenderNumSinceLastFreeze10s:[571,o],videoRenderNumSinceLastFreeze30s:[572,o],videoRenderNumSinceLastFreeze5s:[570,o],videoRenderSumTimeSinceLastFreeze:[568,d],videoRtcpAppRxFailed:[493,o],videoRtcpAppTxFailed:[492,o],videoRxBitrate:[169,u],videoRxBweHitTxBwe:[187,s],videoRxBytesRtcpApp:[489,u],videoRxFecBitrate:[219,u],videoRxFecFrames:[182,o],videoRxKfBeforeLtrpAfterRpsi:[485,o],videoRxLtrpFramesVp8:[460,o],videoRxNumCodecSwitch:[721,o],videoRxPackets:[201,o],videoRxPktErrorPct:[171,u],videoRxPktLossPct:[170,u],videoRxPktRtcpApp:[487,o],videoRxRtcpFir:[621,o],videoRxRtcpNack:[203,o],videoRxRtcpNpsi:[521,o],videoRxRtcpPli:[202,o],videoRxRtcpRpsi:[459,o],videoRxTotalBytes:[168,u],videoSelfState:[274,R],videoSenderBweDiffStddev:[954,u],videoSenderBweStddev:[348,u],videoTargetBitrateReaches1000kbpsT:[351,d],videoTargetBitrateReaches1500kbpsT:[435,d],videoTargetBitrateReaches2000kbpsT:[436,d],videoTargetBitrateReaches200kbpsT:[349,d],videoTargetBitrateReaches250kbpsT:[433,d],videoTargetBitrateReaches500kbpsT:[350,d],videoTargetBitrateReaches750kbpsT:[434,d],videoTotalBytesOnNonDefCell:[451,u],videoTxBitrate:[165,u],videoTxBitrateHq:[823,u],videoTxBytesRtcpApp:[488,u],videoTxFecBitrate:[218,u],videoTxFecFrames:[181,o],videoTxNumCodecSwitch:[720,o],videoTxPackets:[197,o],videoTxPacketsHq:[818,o],videoTxPktErrorPct:[167,u],videoTxPktErrorPctHq:[821,u],videoTxPktLossPct:[166,u],videoTxPktLossPctHq:[822,u],videoTxPktRtcpApp:[486,o],videoTxResendPackets:[198,o],videoTxResendPacketsHq:[819,o],videoTxRtcpFirEmptyJb:[620,o],videoTxRtcpNack:[200,o],videoTxRtcpNpsi:[520,o],videoTxRtcpPli:[199,o],videoTxRtcpPliHq:[820,o],videoTxRtcpRpsi:[458,o],videoTxTotalBytes:[164,u],videoTxTotalBytesHq:[817,u],videoUpdateEncoderFailureCount:[453,o],videoUpgradeCancelByTimeoutCount:[325,o],videoUpgradeCancelCount:[323,o],videoUpgradeCount:[272,o],videoUpgradeRejectByTimeoutCount:[326,o],videoUpgradeRejectCount:[324,o],videoUpgradeRequestCount:[271,o],videoWidth:[188,o],vpxLibUsed:[513,nt],waLongFreezeCount:[891,o],waReconnectFreezeCount:[890,o],waShortFreezeCount:[889,o],waVoipHistoryGetVideoTxBitrateResult:[845,o],waVoipHistoryGetVideoTxBitrateSuccess:[740,s],waVoipHistoryIpAddressNotAvailable:[834,s],waVoipHistoryIsCallRecordLoaded:[737,s],waVoipHistoryIsCallRecordSaved:[738,s],waVoipHistoryIsInitialized:[769,s],waVoipHistoryNumOfCallRecordFound:[771,o],waVoipHistoryNumOfCallRecordLoaded:[739,o],waVoipHistorySaveCallRecordConditionCheckStatus:[770,it],warpHeaderRxTotalBytes:[656,u],warpHeaderTxTotalBytes:[655,u],warpRxPktErrorCount:[746,o],warpTxPktErrorCount:[745,o],weakCellularNetConditionDetected:[429,o],weakWifiNetConditionDetected:[430,o],weakWifiSwitchToDefNetSuccess:[397,o],weakWifiSwitchToDefNetSuccessByPeriodicalCheck:[395,o],weakWifiSwitchToDefNetTriggered:[396,o],weakWifiSwitchToDefNetTriggeredByPeriodicalCheck:[394,o],weakWifiSwitchToNonDefNetFalsePositive:[399,o],weakWifiSwitchToNonDefNetSuccess:[400,o],weakWifiSwitchToNonDefNetTriggered:[398,o],wifiRssiAtCallStart:[263,o],wpNotifyCallFailed:[64,o],wpSoftwareEcMatches:[65,s],xmppStatus:[3,Mt],xorCipher:[269,It]},[1,1,1]],CatalogBiz:[1722,{cartToggle:[13,s],catalogAppealReason:[4,l],catalogBizAction:[1,k],catalogEntryPoint:[7,U],catalogSessionId:[3,l],deepLinkOpenFrom:[8,j],errorCode:[5,o],isOrderMsgAttached:[10,s],orderId:[9,l],productCount:[6,o],productId:[2,l],productIds:[12,l],quantity:[11,o]},[1,1,1]],CatalogView:[1630,{bizPlatform:[16,E],cartToggle:[15,s],catalogEntryPoint:[7,U],catalogEventSampled:[8,s],catalogOwnerJid:[6,l],catalogReportReasonCode:[4,l],catalogSessionId:[2,l],catalogViewAction:[1,F],deepLinkOpenFrom:[9,j],isNewProductAddedToCart:[13,s],isOrderMsgAttached:[10,s],orderId:[11,l],productId:[5,l],quantity:[12,o]},[1,1,1]],ChatFilterEvent:[1616,{actionType:[1,G],filterType:[2,x],sessionId:[3,o]},[1,1,1]],ContactSend:[2234,{channel:[1,Y],isMultiVcard:[2,s],messageSendResult:[3,Pe],messageSendT:[4,d],vcardDataSize:[5,o]},[1,1,1]],ContactUsSession:[470,{contactUsAutomaticEmail:[3,s],contactUsExitState:[1,K],contactUsFaq:[2,s],contactUsLogs:[4,s],contactUsMenuFaqT:[12,d],contactUsOutage:[5,s],contactUsOutageEmail:[6,s],contactUsProblemDescription:[7,l],contactUsScreenshotC:[19,u],contactUsT:[11,d],languageCode:[21,l]},[1,1,1]],DeepLinkOpen:[2136,{deepLinkOpenFrom:[2,j],deepLinkType:[3,W],isContact:[4,s],linkOwnerType:[5,Ne]},[1,1,1]],E2eMessageRecv:[478,{e2eCiphertextType:[5,Q],e2eCiphertextVersion:[6,o],e2eDestination:[4,X],e2eFailureReason:[2,Z],e2eSenderType:[8,$],e2eSuccessful:[1,s],messageMediaType:[7,Te],offline:[9,s],retryCount:[3,o]},[1,20,20]],E2eMessageSend:[476,{e2eCiphertextType:[5,Q],e2eCiphertextVersion:[6,o],e2eDestination:[4,X],e2eFailureReason:[2,Z],e2eReceiverType:[8,H],e2eSuccessful:[1,s],encRetryCount:[9,o],messageMediaType:[7,Te],retryCount:[3,o]},[1,5,5]],EditBusinessProfile:[1466,{businessProfileEntryPoint:[10,y],editBusinessProfileSessionId:[2,l],editProfileAction:[1,ee],editProfileActionField:[9,S],hasAddress:[5,s],hasCategory:[4,s],hasDescription:[3,s],hasEmail:[7,s],hasHours:[6,s],hasWebsite:[8,s]},[1,1,1]],EphemeralMessageTime:[2742,{zombieStateDuration:[1,o]},[1,1,1]],EphemeralPurgeCount:[2744,{messageCount:[1,o]},[1,1,1]],EphemeralSettingChange:[2370,{chatEphemeralityDuration:[1,o]},[1,1,1]],GifFromProviderSent:[1124,{gifSearchProvider:[1,ne]},[1,1,1]],GifSearchCancelled:[1126,{gifSearchProvider:[1,ne]},[1,1,1]],GifSearchNoResults:[1128,{gifSearchProvider:[1,ne],inputLanguageCode:[3,l],languageCode:[2,l]},[1,1,1]],GifSearchResultTapped:[1122,{gifSearchProvider:[1,ne],rank:[2,o]},[1,1,1]],GifSearchSessionStarted:[1134,{gifSearchProvider:[1,ne]},[1,1,1]],HfmTextSearchComplete:[2186,{},[1,1,1]],LabelEvent:[1422,{itemsLabeledCount:[5,o],labelCount:[4,o],labelOperation:[2,oe],labelTarget:[1,ue],predefinedLabelNumber:[3,o]},[1,1,1]],MdAppStateDirtyBits:[2520,{dirtyBitsFalsePositive:[2,s]},[1,20,1e3]],MdAppStateKeyRotation:[2518,{mdAppStateKeyRotationReason:[1,le]},[1,20,1e3]],MdAppStateMessageRange:[2522,{additionalMessagesCount:[1,o]},[1,20,1e3]],MdAppStateOfflineNotifications:[2602,{redundantCount:[1,o]},[1,20,1e3]],MdAppStateSyncDaily:[2300,{crossIndexConflictCount:[11,o],invalidActionCount:[4,o],keyRotationRemoveCount:[12,o],missingKeyCount:[9,o],mutationCount:[1,o],storedMutationCount:[7,o],unsetActionCount:[8,o],unsupportedActionCount:[5,o],uploadConflictCount:[10,o]},[1,1,1]],MdBadDeviceSentMessage:[2176,{dsmError:[2,J],peerType:[1,H]},[1,1,1]],MdBootstrapAppStateDataDownloaded:[2294,{mdBootstrapContactsCount:[5,o],mdBootstrapPayloadSize:[4,o],mdBootstrapPayloadType:[2,de],mdBootstrapStepDuration:[6,o],mdBootstrapStepResult:[7,fe],mdSessionId:[1,l],mdStorageQuotaBytes:[8,o],mdStorageQuotaUsedBytes:[9,o],mdTimestamp:[3,o]},[1,1,1]],MdBootstrapDataApplied:[2298,{mdBootstrapPayloadType:[3,de],mdBootstrapSource:[2,ce],mdSessionId:[1,l],mdTimestamp:[4,o]},[1,1,1]],MdBootstrapHistoryDataDownloaded:[2296,{mdBootstrapChatsCount:[6,o],mdBootstrapMessagesCount:[5,o],mdBootstrapPayloadSize:[4,o],mdBootstrapPayloadType:[2,de],mdBootstrapStepDuration:[7,o],mdBootstrapStepResult:[8,fe],mdSessionId:[1,l],mdStorageQuotaBytes:[9,o],mdStorageQuotaUsedBytes:[10,o],mdTimestamp:[3,o]},[1,1,1]],MdCriticalEvent:[2746,{mdCriticalEventCode:[1,_e]},[1,1,1]],MdDeviceSyncAck:[2180,{chatType:[1,Ce],revoke:[2,s]},[1,1,1]],MdFatalError:[2304,{mdFatalErrorCode:[1,me]},[1,1,1]],MdLinkDeviceCompanion:[2576,{mdDurationS:[8,o],mdLinkDeviceCompanionErrorCode:[6,o],mdLinkDeviceCompanionStage:[4,pe],mdSessionId:[1,l],mdTimestampS:[7,o],mdWasUpgraded:[5,s]},[1,1,1]],MdPushnameValidation:[2302,{didWebUserChangeSyncd:[3,s],isSyncdPushnameEmpty:[2,s],matches:[1,s],validationCaller:[4,ge],validationStage:[5,he],webPlatform:[6,ve]},[1,1,1e3]],MdRetryFromUnknownDevice:[2178,{offline:[2,s],senderType:[1,H]},[1,1,1]],MediaDownload2:[1590,{connectionType:[31,B],debugMediaException:[24,l],debugMediaIp:[22,l],debugUrl:[23,l],downloadBytesTransferred:[20,u],downloadConnectT:[15,d],downloadHttpCode:[18,o],downloadIsReuse:[17,s],downloadIsStreaming:[19,s],downloadNetworkT:[16,d],downloadQuality:[37,z],downloadResumePoint:[14,o],downloadTimeToFirstByteT:[21,d],estimatedBandwidth:[36,u],mediaId:[38,o],networkStack:[30,we],overallAttemptCount:[4,o],overallBackendStore:[39,m],overallConnBlockFetchT:[10,d],overallConnectionClass:[29,l],overallCumT:[27,d],overallDecryptT:[12,d],overallDomain:[5,l],overallDownloadMode:[11,Ee],overallDownloadOrigin:[35,q],overallDownloadResult:[25,ye],overallFileValidationT:[13,d],overallIsEncrypted:[28,s],overallIsFinal:[26,s],overallMediaSize:[7,u],overallMediaType:[1,Te],overallMmsVersion:[6,o],overallQueueT:[9,d],overallRetryCount:[3,o],overallT:[8,d],usedFallbackHint:[40,l]},[1,1,1]],MediaPicker:[1038,{chatRecipients:[16,o],mediaPickerChanged:[4,o],mediaPickerCroppedRotated:[10,o],mediaPickerDeleted:[3,o],mediaPickerDrawing:[11,o],mediaPickerFilter:[18,o],mediaPickerLikeDoc:[19,o],mediaPickerNotLikeDoc:[20,o],mediaPickerOrigin:[14,Se],mediaPickerOriginThirdParty:[21,s],mediaPickerSent:[2,o],mediaPickerSentUnchanged:[5,o],mediaPickerStickers:[12,o],mediaPickerT:[15,d],mediaPickerText:[13,o],mediaType:[1,Te],statusRecipients:[17,o]},[1,1,1]],MediaUpload2:[1588,{connectionType:[43,B],debugMediaException:[34,l],debugMediaIp:[32,l],debugUrl:[33,l],estimatedBandwidth:[45,u],finalizeConnectT:[28,d],finalizeHttpCode:[31,o],finalizeIsReuse:[30,s],finalizeNetworkT:[29,d],mediaId:[46,o],networkStack:[42,we],overallAttemptCount:[4,o],overallConnBlockFetchT:[10,d],overallConnectionClass:[41,l],overallCumT:[37,d],overallCumUserVisibleT:[38,d],overallDomain:[5,l],overallIsFinal:[36,s],overallIsForward:[16,s],overallIsManual:[13,s],overallLastUploadRetryPhase:[11,Re],overallMediaKeyReuse:[40,De],overallMediaSize:[7,u],overallMediaType:[1,Te],overallMmsVersion:[6,o],overallOptimisticFlag:[12,Ie],overallQueueT:[9,d],overallRetryCount:[3,o],overallT:[8,d],overallTranscodeT:[15,d],overallUploadMode:[39,be],overallUploadOrigin:[44,Ze],overallUploadResult:[35,Ae],overallUserVisibleT:[14,d],resumeConnectT:[17,d],resumeHttpCode:[20,o],resumeIsReuse:[19,s],resumeNetworkT:[18,d],uploadBytesTransferred:[27,u],uploadConnectT:[22,d],uploadHttpCode:[25,o],uploadIsReuse:[24,s],uploadIsStreaming:[26,s],uploadNetworkT:[23,d],uploadResumePoint:[21,o],usedFallbackHint:[47,l]},[1,1,1]],MemoryStat:[1336,{hasVerifiedNumber:[7,s],numMessages:[8,u],privateBytes:[3,u],processType:[5,l],sharedBytes:[4,u],uptime:[6,u],workingSetPeakSize:[2,u],workingSetSize:[1,u]},[1,1,1]],Ptt:[458,{pttDuration:[5,d],pttLock:[4,s],pttResult:[1,Ge],pttSize:[3,u],pttSource:[2,xe]},[1,1,1]],PttPlayback:[2044,{pttDuration:[12,d],pttMainThreadBlock:[7,s],pttPlayRequestT:[1,d],pttPlaybackFailed:[8,s],pttPlaybackOverallT:[4,d],pttPlaybackSpeed:[10,Ue],pttPlaybackSpeedCnt:[11,o],pttPlayer:[9,Fe],pttPlayerInitT:[2,d],pttPlayerPlayT:[3,d],pttSeekCnt:[13,o],pttTrigger:[5,Ye],pttType:[6,Be]},[1,1,1]],QuickReply:[1468,{attachmentGifCount:[7,o],attachmentImageCount:[5,o],attachmentVideoCount:[6,o],quickReplyAction:[1,je],quickReplyCount:[2,o],quickReplyKeywordCount:[3,o],quickReplyKeywordMatched:[4,s],quickReplyOrigin:[9,We],quickReplyTranscodeResult:[8,Ve]},[1,1,1]],RoomsCreationFlow:[2202,{entryResult:[3,V],errorReason:[2,re],roomsEntryPoint:[1,qe]},[1,1,1]],SendRevokeMessage:[1348,{messageMediaType:[2,Te],messageType:[1,Oe],revokeSendDelay:[3,o]},[1,1,1]],StickerCommonQueryToStaticServer:[2740,{httpResponseCode:[2,o],params:[3,l],queryType:[1,Ke]},[1,1,1]],StickerSend:[1840,{stickerIsAnimated:[3,s],stickerIsFirstParty:[2,s],stickerSendOrigin:[1,Je]},[1,1,1]],UiAction:[472,{uiActionPreloaded:[2,s],uiActionT:[3,d],uiActionType:[1,Xe]},[1,1,1]],UserActivity:[1384,{userActivityBitmapHigh:[4,o],userActivityBitmapLen:[5,o],userActivityBitmapLow:[3,o],userActivitySessionCum:[7,o],userActivitySessionId:[1,l],userActivitySessionSeq:[6,o],userActivityStartTime:[2,o]},[1,1,1]],UserNotice:[2472,{userNoticeContentVersion:[2,o],userNoticeEvent:[3,rt],userNoticeId:[1,o]},[1,1,1]],UserNoticeError:[2474,{userNoticeContentVersion:[2,o],userNoticeErrorEvent:[3,tt],userNoticeId:[1,o]},[1,1,1]],ViewBusinessProfile:[1522,{businessProfileJid:[3,l],viewBusinessProfileAction:[1,at],websiteSource:[2,wt]},[1,1,1]],WebcAssetLoad:[1358,{webcAssetCacheType:[4,ot],webcAssetFromCache:[2,s],webcAssetLoadT:[3,d],webcAssetName:[1,l],webcAssetSize:[5,u]},[1,1,1]],WebcChatOpen:[864,{webcChatOpenBeforePaintT:[7,d],webcChatOpenPaintedT:[6,d],webcChatOpenT:[2,d],webcFinalRenderedMessageCount:[5,o],webcRenderedMessageCount:[4,o],webcUnreadCount:[1,u],webcWindowHeightFloat:[8,u]},[1,1,1]],WebcCryptoMedia:[1028,{webcCryptoElapsedT:[4,d],webcCryptoFileSize:[3,u],webcCryptoLibrary:[2,lt],webcCryptoType:[1,dt]},[1,1,1]],WebcCryptoSupport:[1026,{webcAesCbcSupported:[2,s],webcEcdhSupported:[3,s],webcHmacSha256Supported:[1,s]},[1,1,1]],WebcDbOpen:[1940,{webcDbName:[1,l],webcDbOpenNumAttempts:[3,o],webcDbOpenWasSuccess:[2,s]},[1,1,1]],WebcEmojiOpen:[1166,{webcEmojiOpenTab:[1,l]},[1,1,1]],WebcFingerprint:[1704,{webcCanvasFingerprint:[25,l],webcDocumentDriverEvaluate:[9,s],webcDocumentDriverUnwrapped:[7,s],webcDocumentElementAttrDriver:[14,s],webcDocumentElementAttrSelenium:[12,s],webcDocumentElementAttrWebdriver:[13,s],webcDocumentFxdriverEvaluate:[6,s],webcDocumentFxdriverUnwrapped:[11,s],webcDocumentSeleniumEvaluate:[2,s],webcDocumentSeleniumUnwrapped:[10,s],webcDocumentWebdriverEvaluate:[1,s],webcDocumentWebdriverScriptFn:[5,s],webcDocumentWebdriverScriptFunc:[4,s],webcDocumentWebdriverScriptFunction:[3,s],webcDocumentWebdriverUnwrapped:[8,s],webcWebglFingerprint:[24,l],webcWebglRenderer:[23,l],webcWebglVendor:[22,l],webcWindowSeleniumIdeRecorder:[20,s],webcWindowCallphantom:[18,s],webcWindowCallselenium:[19,s],webcWindowNavigatorWebdriver:[21,Ot],webcWindowNightmare:[16,s],webcWindowPhantom:[15,s],webcWindowSelenium:[17,s]},[1,1,1]],WebcFirstScreenEmojisLoad:[2144,{webcEmojisLoadT:[1,d],webcLoadedEmojisCount:[2,o]},[1,1,1]],WebcImgError:[1700,{webcImgErrorCode:[1,u]},[1,1,1]],WebcIndexeddbAvailablity:[2114,{webcIndexeddbIsAvailable:[1,s]},[1,1,10]],WebcLogin:[1664,{webcBrowserNetworkType:[14,l],webcBrowserStorageQuotaBytes:[15,o],webcBrowserStorageQuotaUsedBytes:[16,o],webcLoginT:[3,d],webcPersistentLoginEnabled:[17,s],webcQrCodes:[1,o],webcQrLoadT:[2,d],webcSyncChatCount:[8,o],webcSyncChatSize:[10,o],webcSyncChatT:[9,d],webcSyncContactCount:[11,o],webcSyncContactSize:[13,o],webcSyncContactT:[12,d],webcSyncMessageCount:[5,o],webcSyncMessageSize:[7,o],webcSyncMessageT:[6,d],webcSyncT:[4,d]},[1,1,1]],WebcManualWebsocketAttempt:[896,{webcManualWebsocketAttemptSuccessful:[1,s]},[1,1,1]],WebcMediaAnalyzed:[912,{webcMediaAnalyzeT:[3,d],webcMediaExtensions:[2,l],webcMediaSupported:[1,s]},[1,1,1]],WebcMediaBlobCachePurge:[1956,{mediaBlobCacheItemCount:[4,o],mediaBlobCachePurgesSoFar:[3,o],mediaBlobCacheSizeLimit:[2,o],mediaBlobCacheUptimeT:[1,d]},[1,1,1]],WebcMediaErrorUnknownDetails:[2352,{mediaId:[1,o],webcMediaErrorName:[3,l],webcMediaOperation:[2,pt]},[1,1,1]],WebcMediaLoad:[1202,{webcMediaLoadResult:[2,ft],webcMediaLoadT:[1,d]},[1,1,1]],WebcMediaRender:[1898,{messageMediaType:[9,Te],webcBrowserNetworkType:[7,l],webcBrowserStorageQuotaBytes:[10,o],webcBrowserStorageQuotaUsedBytes:[11,o],webcChatPosition:[1,o],webcChatType:[2,ut],webcMediaStage:[5,ht],webcMessageIndex:[3,o],webcMessageT:[8,d]},[1,1,1]],WebcMediaRmr:[1906,{messageMediaType:[10,Te],webcBrowserNetworkType:[2,l],webcBrowserStorageQuotaBytes:[11,o],webcBrowserStorageQuotaUsedBytes:[12,o],webcChatPosition:[1,o],webcChatType:[9,ut],webcMediaRmrError:[8,s],webcMediaRmrT:[6,d],webcMediaSize:[7,o],webcMessageIndex:[3,o],webcMessageT:[5,d],webcRmrReason:[14,yt],webcRmrStatusCode:[13,o]},[1,1,1]],WebcMediaStorePurge:[2112,{webcBrowserStorageQuotaBytes:[1,o],webcBrowserStorageQuotaUsedBytes:[2,o],webcCurrentTimestampT:[7,d],webcMediaStoreItemCount:[5,o],webcMediaStoreQuotaBytes:[3,o],webcMediaStoreQuotaUsedBytes:[4,o],webcPurgedItemTimestampT:[6,d]},[1,1,1]],WebcMemoryStat:[1188,{hasVerifiedNumber:[12,s],jsHeapSizeLimit:[9,o],numMessages:[8,u],totalJsHeapSize:[10,o],uptime:[6,u],usedJsHeapSize:[11,o]},[1,1,1]],WebcMenu:[2504,{webcMenuAction:[2,mt],webcMenuItemLabel:[3,_t]},[1,1,1]],WebcMessageQuery:[1876,{webcAudioMessageCount:[14,o],webcBrowserNetworkType:[1,l],webcBrowserStorageQuotaBytes:[20,o],webcBrowserStorageQuotaUsedBytes:[21,o],webcChatPosition:[2,o],webcChatType:[13,ut],webcDocumentMessageCount:[16,o],webcEarliestMessageIndex:[11,o],webcEarliestMessageT:[12,d],webcMessageCount:[4,o],webcMessageQueryTrigger:[19,Et],webcMessageQueryType:[3,gt],webcOtherMessageCount:[18,o],webcPhotoMessageCount:[7,o],webcPttMessageCount:[15,o],webcQueryT:[9,d],webcResponseBytes:[10,o],webcStickerMessageCount:[17,o],webcTextMessageCount:[5,o],webcVideoMessageCount:[6,o]},[1,1,1]],WebcMessageSend:[2072,{messageIsForward:[3,s],messageMediaType:[2,Te],messageSendT:[4,d],messageType:[1,Oe]},[1,1,1]],WebcOfflineResume:[2628,{chatThreadCount:[9,o],decryptErrorCount:[4,o],offlineMessageCount:[2,o],offlineReceiptCount:[3,o],offlineSizeBytes:[8,o],webcLastStanzaT:[10,d],webcMainScreenLoadT:[7,d],webcOfflinePreviewT:[6,d],webcPageLoadT:[1,d],webcSocketConnectT:[5,d]},[1,1,1]],WebcPageLoad:[642,{webcAppcacheStatus:[29,st],webcCached:[30,s],webcConnectEnd:[10,d],webcConnectStart:[9,d],webcDomComplete:[19,d],webcDomContentLoadedEventEnd:[18,d],webcDomContentLoadedEventStart:[17,d],webcDomInteractive:[16,d],webcDomLoading:[15,d],webcDomainLookupEnd:[8,d],webcDomainLookupStart:[7,d],webcExeDone:[23,d],webcExeStart:[22,d],webcFetchStart:[6,d],webcInitialMountT:[38,d],webcInitialNavMountT:[39,d],webcInitialPanel:[42,l],webcInitialPanelMountStartT:[43,d],webcInitialPanelMountT:[40,d],webcInitialPanelRenderT:[46,d],webcJsLoadT:[37,d],webcLoadEventEnd:[21,d],webcLoadEventStart:[20,d],webcMainScriptEnd:[45,d],webcMainScriptStart:[44,d],webcNativeLoadT:[36,d],webcNavigation:[32,vt],webcPageLoadT:[34,d],webcParallellyFetched:[41,s],webcQrCode:[31,s],webcRedirectCount:[33,u],webcRedirectEnd:[5,d],webcRedirectStart:[4,d],webcRequestStart:[12,d],webcResponseEnd:[14,d],webcResponseStart:[13,d],webcSecureConnectionStart:[11,d],webcUnloadEventEnd:[3,d],webcUnloadEventStart:[2,d],webcWsAttempts:[28,u],webcWsNormal:[27,d],webcWsOpening:[24,d],webcWsPairing:[25,d],webcWsSyncing:[26,d]},[1,1,1]],WebcPageResume:[884,{webcResumeCount:[1,o]},[1,1,1]],WebcPhoneDisconnected:[878,{webcPhoneBbarShownT:[2,d],webcPhoneDisconnectedT:[1,d]},[1,1,1]],WebcProgressiveImage:[2226,{webcFirstRenderScans:[1,o],webcFirstRenderT:[2,d],webcFullQualityT:[4,d],webcMidQualityT:[3,d]},[1,1,10]],WebcRawPlatforms:[2416,{webcRawPlatform:[1,l]},[1,1,1]],WebcResourceLoad:[688,{webcResourceCached:[3,s],webcResourceDuration:[2,d],webcResourceName:[1,l]},[1,1,1]],WebcStatusSession:[1880,{webcStatusMutedItemCount:[4,o],webcStatusMutedRowCount:[7,o],webcStatusRecentItemCount:[2,o],webcStatusRecentRowCount:[5,o],webcStatusSessionId:[1,o],webcStatusViewedItemCount:[3,o],webcStatusViewedRowCount:[6,o]},[1,1,1]],WebcStatusSync:[1878,{webcStatusMutedItemCount:[4,o],webcStatusMutedRowCount:[7,o],webcStatusRecentItemCount:[2,o],webcStatusRecentRowCount:[5,o],webcStatusSyncT:[1,d],webcStatusViewedItemCount:[3,o],webcStatusViewedRowCount:[6,o]},[1,1,1]],WebcStatusView:[1882,{webcStatusLoadT:[6,d],webcStatusLoaded:[4,s],webcStatusMediaType:[5,St],webcStatusPlaybackT:[8,d],webcStatusReplyCount:[9,o],webcStatusRowIndex:[3,o],webcStatusRowSection:[2,Tt],webcStatusSessionId:[1,o],webcStatusUnread:[10,s],webcStatusViewT:[7,d]},[1,1,1]],WebcStorageStat:[1504,{webcStorageQuota:[2,o],webcStorageUsage:[1,o]},[1,1,1]],WebcStreamModeChange:[770,{webcStreamMode:[1,bt]},[1,1,1]],WebcUiFreeze:[1836,{webcUiFreezeFps:[1,u],webcUiFreezeT:[2,d]},[1,1,1]],WebcWamUpload:[916,{webcAvailableBbarTp:[3,u],webcAvailableNormalTp:[4,u],webcAvailableTp:[2,u],webcTotalT:[1,d],webcUnavailableBbarTp:[6,u],webcUnavailableNormalTp:[7,u],webcUnavailableTp:[5,u]},[1,1,1]],WebcWapRequest:[2006,{webcWapRequestAckT:[3,d],webcWapRequestDestination:[6,At],webcWapRequestKind:[5,Ct],webcWapRequestName:[8,l],webcWapRequestRecvT:[4,d],webcWapRequestResponseSize:[2,o],webcWapRequestSize:[7,o],webcWapRequestStatus:[9,o]},[1,1,10]],WebcWasmSupport:[1374,{webcWasmSupported:[1,s]},[1,1,1]],WebcWsOpen:[740,{webcWsOpenT:[1,d]},[1,1,1]]});var Dt=(0,n.default)((0,n.default)({},i.events),{METRICS:i.metrics,Global:Rt,WamEvent:i.WamEvent,AEC_MODE:c,AGC_MODE:f,ANDROID_CAMERA2_SUPPORT_LEVEL:p,ANDROID_CAMERA_API:h,AUDIO_ENGINE_TYPE:_,BACKEND_STORE_TYPE:m,BANNER_OPERATIONS:g,BANNER_TYPES:v,BIZ_PLATFORM:E,BUSINESS_PROFILE_ENTRY_POINT:y,BUSINESS_PROFILE_FIELD:S,CALL_FROM_UI:T,CALL_NETWORK_MEDIUM:b,CALL_RELAY_BIND_STATUS:A,CALL_RESULT_TYPE:C,CALL_SEGMENT_TYPE:P,CALL_SETUP_ERROR_TYPE:O,CALL_SIDE:w,CALL_TERM_REASON:M,CALL_TRANSPORT_TYPE:I,CALL_VIDEO_STATE:R,CALL_WAKEUP_SOURCE:D,CAMERA_PREVIEW_MODE:N,CAMERA_START_MODE_PARAMS:L,CATALOG_BIZ_ACTION:k,CATALOG_ENTRY_POINT:U,CATALOG_VIEW_ACTION:F,CHAT_FILTER_ACTION_TYPES:G,CHAT_FILTER_TYPES:x,CONNECTION_TYPE:B,CONTACT_SEND_CHANNEL:Y,CONTACT_US_EXIT_STATE:K,DEEP_LINK_OPEN_FROM:j,DEEP_LINK_TYPE:W,DESTINATION:V,DEVICE_TYPE:H,DOWNLOAD_ORIGIN_TYPE:q,DOWNLOAD_QUALITY_TYPE:z,DSM_ERROR:J,E2E_CIPHERTEXT_TYPE:Q,E2E_DESTINATION:X,E2E_FAILURE_REASON:Z,E2E_SENDER_TYPE:$,EDIT_PROFILE_ACTION:ee,END_CALL_CONFIRMATION_TYPE:te,ERROR_REASON:re,FIELD_STATS_ROW_TYPE:ae,GIF_SEARCH_PROVIDER:ne,INCOMING_CALL_UI_ACTION_TYPE:ie,INIT_BWE_SOURCE:se,LABEL_OPERATIONS:oe,LABEL_TARGETS:ue,MD_APP_STATE_KEY_ROTATION_REASON_CODE:le,MD_BOOTSTRAP_PAYLOAD_TYPE:de,MD_BOOTSTRAP_SOURCE:ce,MD_BOOTSTRAP_STEP_RESULT:fe,MD_LINK_DEVICE_COMPANION_STAGE:pe,MD_PUSHNAME_VALIDATION_STAGE_CODE:he,MD_SYNCD_CRITICAL_EVENT_CODE:_e,MD_SYNCD_FATAL_ERROR_CODE:me,MD_VALIDATION_CALLER_CHANNEL:ge,MD_VALIDATION_WEB_PLATFORM:ve,MEDIA_DOWNLOAD_MODE_TYPE:Ee,MEDIA_DOWNLOAD_RESULT_TYPE:ye,MEDIA_PICKER_ORIGIN_TYPE:Se,MEDIA_TYPE:Te,MEDIA_UPLOAD_MODE_TYPE:be,MEDIA_UPLOAD_RESULT_TYPE:Ae,MESSAGE_CHAT_TYPE:Ce,MESSAGE_SEND_RESULT_TYPE:Pe,MESSAGE_TYPE:Oe,NETWORK_STACK_TYPE:we,NS_MODE:Me,OPTIMISTIC_FLAG_TYPE:Ie,OVERALL_LAST_UPLOAD_RETRY_PHASE_TYPE:Re,OVERALL_MEDIA_KEY_REUSE_TYPE:De,OWNER_TYPE:Ne,PEER_CALL_NETWORK_MEDIUM:Le,PLATFORM_TYPE:ke,PTT_PLAYBACK_SPEED_TYPE:Ue,PTT_PLAYER_TYPE:Fe,PTT_RESULT_TYPE:Ge,PTT_SOURCE_TYPE:xe,PTT_STREAM_TYPE:Be,PTT_TRIGGER_TYPE:Ye,QUERY_TYPE:Ke,QUICK_REPLY_ACTION:je,QUICK_REPLY_ORIGIN:We,QUICK_REPLY_TRANSCODE_RESULT:Ve,RADIO_TYPE:He,ROOMS_ENTRY_POINT:qe,SRTP_LIBRARY_VERSION:ze,STICKER_SEND_ORIGIN_TYPE:Je,SW_AEC_TYPE:Qe,UI_ACTION_TYPE:Xe,UPLOAD_ORIGIN_TYPE:Ze,UPNP_ADD_RESULT_CODE:$e,UPNP_REMOVE_RESULT_CODE:et,USER_NOTICE_ERROR_EVENT:tt,USER_NOTICE_EVENT:rt,VIEW_BUSINESS_PROFILE_ACTION:at,VPX_LIB:nt,WA_VOIP_HISTORY_SAVE_CALL_RECORD_CONDITION_CHECK_STATUS:it,WEBC_APPCACHE_STATUS_CODE:st,WEBC_ASSET_CACHE_TYPE_CODE:ot,WEBC_CHAT_TYPE:ut,WEBC_CRYPTO_LIBRARY_CODE:lt,WEBC_CRYPTO_TYPE_CODE:dt,WEBC_ENV_CODE:ct,WEBC_MEDIA_LOAD_RESULT_CODE:ft,WEBC_MEDIA_OPERATION_CODE:pt,WEBC_MEDIA_STAGE_TYPE:ht,WEBC_MENU_ITEM_LABEL:_t,WEBC_MENU_TYPE:mt,WEBC_MESSAGE_QUERY_DIRECTION:gt,WEBC_NAVIGATION_TYPE:vt,WEBC_QUERY_TRIGGER_TYPE:Et,WEBC_RMR_REASON_CODE:yt,WEBC_STATUS_MEDIA_TYPE:St,WEBC_STATUS_ROW_SECTION:Tt,WEBC_STREAM_MODE_CODE:bt,WEBC_WAP_REQUEST_DESTINATION_CODE:At,WEBC_WAP_REQUEST_KIND_CODE:Ct,WEBC_WEB_PLATFORM_TYPE:Pt,WEBC_WINDOW_NAVIGATOR_WEBDRIVER_TYPE:Ot,WEBSITE_SOURCE_TYPE:wt,XMPP_STATUS:Mt,XOR_CIPHER_MODE:It});t.default=Dt},53549:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.defineEvents=function(e){for(var t in e){var r,a=e[t],n=a[2];r=n[2],v({name:t,id:a[0],props:a[1],weight:r})}},t.defineGlobal=function(e){var t={},r=function(r){var a=e[r],n=h.defineGlobal(r,a[0],a[1]);t[r]={type:n.validator,set(e){this.commitOnSet&&d.default.set(n,e)}}};for(var a in e)r(a);return new((0,l.defineTypeHash)("Global",t,E))},t.events=t.WamEvent=t.metrics=t.Metric=t.TYPES=void 0;var i=n(r(82421)),s=n(r(23779)),o=n(r(35380)),u=n(r(61941)),l=(r(86362),a(r(63731))),d=n(r(95839)),c=Object.freeze({BOOLEAN:"boolean",INTEGER:"integer",NUMBER:"number",STRING:"string",TIMER:"timer"});function f(e){return"number"==typeof e&&e===Math.floor(e)}t.TYPES=c;class p{constructor(e,t,r){this.name=e,this.id=t,this.type=r,this.setValidator()}setValidator(){var e=this.type;if("object"==typeof e){var t=(0,o.default)(e);this.validator=e=>e in t}else e===c.INTEGER||e===c.TIMER?this.validator=f:this.validator=e}}t.Metric=p;var h=new class{constructor(){this.map={}}_key(e,t){return"".concat(e,"::").concat(t)}get(e,t){var r=this._key(e,t);return(0,u.default)(this.map[r],r)}define(e,t,r,a){var n=this._key(e,t);return n in this.map||(this.map[n]=new p(t,r,a)),this.map[n]}getGlobal(e){return this.get("Global",e)}defineGlobal(e,t,r){return this.define("Global",e,t,r)}};t.metrics=h;var _=1;class m extends l.default{constructor(){super(),this.instanceId=_++,this.eventTime=Date.now(),this.commitTime=void 0}commit(){d.default.commit(this)}setTime(e){this.eventTime=e||Date.now()}setSequenceNumber(e){this.sequenceNumber=e}}t.WamEvent=m;var g={};function v({name:e,id:t,weight:r,props:a}){var n={id:t,weight:r},o={},u=[];for(var d in a){var f=a[d],p=h.define(e,d,f[0],f[1]);o[d]=p.validator,f[1]===c.TIMER&&u.push(d)}var _=(0,l.defineTypeHash)(e,o,m);u.forEach((e=>{n["mark"+(0,s.default)(e)]=function(t){this[e]=Date.now()-this.eventTime;t&&t.showInTimeline}})),(0,i.default)(_.prototype,n),g[e]=_}t.events=g;class E extends l.default{constructor(...e){super(...e),this.commitOnSet=!0}}},16199:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.newMessageQueryEvent=function(e){return new i.default.WebcMessageQuery({webcResponseBytes:0,webcMessageCount:0,webcTextMessageCount:0,webcVideoMessageCount:0,webcPhotoMessageCount:0,webcAudioMessageCount:0,webcPttMessageCount:0,webcStickerMessageCount:0,webcDocumentMessageCount:0,webcOtherMessageCount:0,webcMessageQueryTrigger:e})},t.logMessageCounts=function(e,t){e.webcMessageCount+=t.length;for(var r=0,a=t[r];r<t.length;++r,a=t[r])switch(a.type){case s.CHAT:case s.LOCATION:case s.PAYMENT:case s.VCARD:case s.CIPHERTEXT:case s.MULTI_VCARD:case s.REVOKED:case s.OVERSIZED:e.webcTextMessageCount+=1;break;case s.IMAGE:case s.PRODUCT:e.webcPhotoMessageCount+=1;break;case s.VIDEO:e.webcVideoMessageCount+=1;break;case s.AUDIO:e.webcAudioMessageCount+=1;break;case s.PTT:e.webcPttMessageCount+=1;break;case s.STICKER:e.webcStickerMessageCount+=1;break;case s.DOCUMENT:e.webcDocumentMessageCount+=1;break;default:e.webcOtherMessageCount+=1}};var n=a(r(50935)),i=a(r(40210));var{MSG_TYPE:s}=n.default},31822:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.OfflineResumeReporter=void 0;var n=a(r(19976)),i=a(r(40210));function s(){var e=(0,n.default)(["======== offline resume perf ========\nmessage: ","\nreceipt: ","\ndecryptError: ","\npageLoadT: ","\nconnectionT: ","\nofflinePreviewT: ","\nscreenLoadT: ","\n======================================"]);return s=function(){return e},e}var o=new class{constructor(){this.offlineResume=new i.default.WebcOfflineResume,this.offlineResume.offlineMessageCount=0,this.offlineResume.offlineReceiptCount=0,this.offlineResume.decryptErrorCount=0}logOfflineCount(e){this.offlineResume&&(this.offlineResume.offlineMessageCount=e.message,this.offlineResume.offlineReceiptCount=e.receipt)}logOfflineDecryptionErrorCount(e){this.offlineResume&&(this.offlineResume.decryptErrorCount=e)}logMainScreenLoadT(){this.offlineResume&&this.offlineResume.markWebcMainScreenLoadT()}logOfflinePreviewT(){this.offlineResume&&this.offlineResume.markWebcOfflinePreviewT()}logPageLoadT(){this.offlineResume&&this.offlineResume.markWebcPageLoadT()}logSocketConnectT(){this.offlineResume&&this.offlineResume.markWebcSocketConnectT()}commit(){var e=this.offlineResume;e&&(__LOG__(2)(s(),e.offlineMessageCount,e.offlineReceiptCount,e.decryptErrorCount,e.webcPageLoadT,e.webcSocketConnectT,e.webcOfflinePreviewT,e.webcMainScreenLoadT),e.commit(),this.offlineResume=null)}};t.OfflineResumeReporter=o},47398:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.streamInfoChange=function(e,t,r){var a=Math.floor(window.performance.now());v[e]=a,r&&(v.socketSequence=t,m())},t.saveInitialPanelMountTime=function(e){h=e},t.setInitialScreen=function(e){if(null==g)return;g.set({webcInitialPanel:e})},t.onInitialRenderComplete=function(){_()},t.PageLoad=t.initialScreenTimer=t.mainScriptTimer=t.exeTimer=void 0;var i=n(r(19976)),s=n(r(40210)),o=n(r(61941)),u=a(r(86362)),l=n(r(90564)),d=n(r(95839)),c=r(34732);function f(){var e=(0,i.default)(["MetricReporter:logPageLoad delayed"]);return f=function(){return e},e}function p(){var e=(0,i.default)(["MetricReporter:logPageLoad metrics not provided by browser!"]);return p=function(){return e},e}var h,_,m,g=new s.default.WebcPageLoad,v={},E=new Promise((e=>_=e)),y=new Promise((e=>m=e)),S=!1;function T(e){return window.performance&&window.performance.timing&&window.performance.timing.navigationStart?e-window.performance.timing.navigationStart:null}function b(){if(window.performance&&window.performance.timing&&window.performance.navigation){if(g){var e=g,t=window.performance.timing,r=window.performance.navigation,a=t.navigationStart,n=t.loadEventEnd-a;if(n<=0)return __LOG__(2)(f()),void setTimeout(b,1e4);e.set({webcPageLoadT:n,webcUnloadEventStart:i("unloadEventStart"),webcUnloadEventEnd:i("unloadEventEnd"),webcRedirectStart:i("redirectStart"),webcRedirectEnd:i("redirectEnd"),webcFetchStart:i("fetchStart"),webcDomainLookupStart:i("domainLookupStart"),webcDomainLookupEnd:i("domainLookupEnd"),webcConnectStart:i("connectStart"),webcConnectEnd:i("connectEnd"),webcSecureConnectionStart:i("secureConnectionStart"),webcRequestStart:i("requestStart"),webcResponseStart:i("responseStart"),webcResponseEnd:i("responseEnd"),webcDomLoading:i("domLoading"),webcDomInteractive:i("domInteractive"),webcDomContentLoadedEventStart:i("domContentLoadedEventStart"),webcDomContentLoadedEventEnd:i("domContentLoadedEventEnd"),webcDomComplete:i("domComplete"),webcLoadEventStart:i("loadEventStart"),webcLoadEventEnd:i("loadEventEnd"),webcCached:t.fetchStart===t.domainLookupEnd,webcNavigation:r.type,webcRedirectCount:r.redirectCount,webcWsOpening:v.OPENING,webcWsPairing:v.PAIRING,webcWsSyncing:v.SYNCING,webcWsNormal:v.NORMAL,webcWsAttempts:v.socketSequence,webcQrCode:!v.SYNCING,webcParallellyFetched:window.PARALLEL_FETCH_SCRIPT,webcInitialPanelMountT:h-a}),e.commit(),g=null}}else __LOG__(2)(p());function i(e){var r=t[e];return r&&T(r)}}Promise.all([E,y]).then((()=>{b(),(0,l.default)(),(0,c.logWasmSupport)(),S||(S=!0,d.default.resumeJobs())}));class A{constructor(e){this._hasStarted=!1,this._label=e.label,this._startProperty=e.startProperty,this._endProperty=e.endProperty}start(){this._hasStarted=!0,null!=g&&(g.set({[this._startProperty]:T(Date.now())}),this._measure=u.startMeasure(this._label))}end(){null!=g&&(g.set({[this._endProperty]:T(Date.now())}),(0,o.default)(this._measure,"this._measure").end())}hasStarted(){return this._hasStarted}}var C=new A({label:"PageLoad.webcExe",startProperty:"webcExeStart",endProperty:"webcExeDone"});t.exeTimer=C;var P=new A({label:"PageLoad.webcMainScript",startProperty:"webcMainScriptStart",endProperty:"webcMainScriptEnd"});t.mainScriptTimer=P;var O=new A({label:"PageLoad.webcInitialPanelRender",startProperty:"webcInitialPanelMountStartT",endProperty:"webcInitialPanelRenderT"});t.initialScreenTimer=O;var w=(0,o.default)(g,"_PageLoad");t.PageLoad=w},35920:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=new class{constructor(){this._resetNextSet=!1,this._value=0}get(){return this._value}_checkReset(){this._resetNextSet&&(this._resetNextSet=!1,this._value=0,this.initialDisplayDate=null)}inc(){return this._checkReset(),this.set(this._value+1)}set(e){if(this._checkReset(),this._value!==e)return 1===e&&(this.initialDisplayDate=Math.floor(window.performance.now())),this._value=e,this.get()}reset(){this._resetNextSet=!0}};t.default=r},90564:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){if(!(window.performance&&window.performance.timing&&window.performance.getEntriesByType))return void __LOG__(2)(s());var e=window.performance.timing.fetchStart===window.performance.timing.domainLookupEnd,t=window.performance.getEntriesByType("resource"),r=document.createElement("a");t.forEach((function(t){"xmlhttprequest"!==t.initiatorType&&(r.href=t.name,new i.default.WebcResourceLoad({webcResourceName:r.pathname+r.search+r.hash,webcResourceDuration:Math.round(t.duration),webcResourceCached:e}).commit())}))};var n=a(r(19976)),i=a(r(40210));function s(){var e=(0,n.default)(["MetricReporter:logResourceLoads metrics not provided by browser!"]);return s=function(){return e},e}},63731:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.defineTypeHash=function(e,t,n){var i={$className:{value:e}};for(var s in t){var o=t[s];if("string"!=typeof o&&"function"!=typeof o||(o={type:o}),!o||"object"!=typeof o)throw new Error("".concat(e," specified with non-object ").concat(o));i[s]={enumerable:!0,get:r(s),set:a(s,o)}}class u extends n{constructor(e){super(),this.all={},e&&this.set(e)}}return Object.defineProperties(u.prototype,i),u},t.default=void 0;function r(e){return function(){return this.all[e]}}function a(e,t){var r=t.type,a=t.set;return function(t){if(t!==this.all[e]){if(null==t);else if("function"==typeof r){if(!r(t))throw new TypeError("".concat(this.$className,".").concat(e," type-validator fails ").concat(t))}else if(typeof t!==r)throw new TypeError("".concat(this.$className,".").concat(e," requires type ").concat(r,", got ").concat(t));a&&a.call(this,t),this.all[e]=t}}}t.default=class{set(e){for(var t in e)this[t]=e[t]}}},95839:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,i,s,o,u,l,d,c,f,p,h,_,m,g,v,E=a(r(19976)),y=a(r(34519)),S=a(r(90882)),T=a(r(16760)),b=r(11824),A=a(r(61941));function C(){var e=(0,E.default)(["wam dropped "," buffers! ("," bytes)"]);return C=function(){return e},e}function P(){var e=(0,E.default)(["wam:sendAllLogs failed to read because ",""]);return P=function(){return e},e}function O(){var e=(0,E.default)(["wam:save WamStorage failed to save ",""]);return O=function(){return e},e}function w(){var e=(0,E.default)(["wam:executePending error ",""]);return w=function(){return e},e}function M(){var e=(0,E.default)(["wam:commit redundant commit! ",""]);return M=function(){return e},e}var I=null,R=!1;var D,N=0,L=[],k=!1,U=!1,F=null,G=0;function x(e,t){e.commitTime=null!=t?t:J(),e.sequenceNumber=G++}function B(e){if(!F||e){var t=i.info();F={appVersion:o.VERSION_BASE,platform:l.PLATFORM_TYPE.WEBCLIENT,browser:t.name||null,browserVersion:t.ua||null,deviceName:t.os||null,deviceVersion:t.version||null,webcPhonePlatform:u.platformField||null,webcEnv:l.WEBC_ENV_CODE[o.WAM_ENV],webcTabId:_.thisTabId,webcWebPlatform:l.WEBC_WEB_PLATFORM_TYPE[o.WAM_PLATFORM]},e&&Object.assign(F,e),l.Global.commitOnSet=!1,l.Global.set(F),l.Global.commitOnSet=!0}}class Y{constructor(e){this.buffer=new n(void 0,!0),this.buffer.write("WAM",3),this.eventsWritten=0,this.prevGlobals={},this.dirtyGlobals={},this.unsavedPortion=null,this.saveKey=String(1e9*Math.random()|0),e&&this.setAll(e)}size(){return this.buffer.size()}setAll(e){for(var t in e){var r=e[t];void 0!==r&&this.set(l.METRICS.getGlobal(t).id,r)}}set(e,t){this.dirtyGlobals[String(e)]=t,this.unsavedPortion&&this.unsavedPortion.set(e,t)}flushGlobals(){var e=this.dirtyGlobals,t=this.prevGlobals;for(var r in e){var a=e[r];if("boolean"==typeof a)a=a?1:0;else if(void 0===a)a=null;else if(Number.isNaN(a))continue;if(a!==t[r]){t[r]=a;var n=parseInt(r,10);V(this.buffer,n,a,0)}}this.dirtyGlobals={}}write(e){var t=this.buffer;this.set(47,e.commitTime),this.set(3433,e.sequenceNumber),this.flushGlobals();for(var r=e.all,a=Object.keys(r),n=-1,i=0;i<a.length;i++){null!=r[a[i]]&&(n=i)}V(t,e.id,-e.weight,-1===n?5:1);for(var s=0;s<=n;s++){var o=a[s],u=l.METRICS.get(e.$className,o).id,d=r[o];null!=d&&("boolean"==typeof d&&(d=d?1:0),V(t,u,d,n===s?6:2))}this.eventsWritten++,this.unsavedPortion&&this.unsavedPortion.write(e)}stringBuffer(){return this.eventsWritten>0?c(this.buffer.peek((e=>e.readByteArray()))):""}}function K(e){L.push(e),k&&v.onOrBefore(1e4)}function j(){k=!0,L.length>0&&v.onOrBefore(1e4)}function W(){k=!1,v.cancel(),Promise.resolve(L).then((function(e){B(),"wam:executePending ".concat(e.length," jobs");var t=D||new Y(F);D=t;for(var r=0;r<e.length;r++){var a=e[r],[n,...i]=a;if(n){var s=i[0];t.write(s)}else{var[u,l]=i;F[u.name]=l,t.set(u.id,l)}}var c,p=J();if(t.eventsWritten>0&&(t.size()>o.WAM_MAX_BUFFER_SIZE||p>N+o.WAM_ROTATE_INTERVAL||!U)){if(!f())return t.buffer.size()>o.WAM_MAX_BUFFER_SIZE?(D=null,Promise.resolve()):q();if(null!=d){var h=d.uploadEvent();x(h,p),h.all,t.write(h)}return m.deleteAll().catch((function(e){return __LOG__(3)(P(),String(e)),{}})).then((e=>(c=e,D&&(D.unsavedPortion&&!(D.saveKey in c)&&(D=D.unsavedPortion),c[(0,A.default)(D,"context").saveKey]=D.stringBuffer()),Promise.all((0,T.default)(c,z))))).then((function(e){var t=(0,S.default)(e);if(t.length!==e.length&&(N=J(),U=!0),D&&!t.includes(D.saveKey)&&(D=null),0===t.length)return Promise.resolve();var r=t.reduce((function(e,t){return e+c[t].length}),0);if(r<o.WAM_MAX_BUFFER_SIZE)return Promise.all((0,T.default)(t,(function(e){return m.add(e,c[e]).then((()=>{}),(()=>{}))})));D=null,__LOG__(3)(C(),t.length,r)}))}return q()})).catch((function(e){__LOG__(3)(w(),String(e&&e.stack?e.stack:e)),s.upload({reason:"wam-error"}),D=null})).then(j,j),L=[]}function V(e,t,r,a){if(null==r)0===a&&H(e,t,a);else if("number"==typeof r&&r===(0|r))0===r?H(e,t,16|a):1===r?H(e,t,32|a):-128<=r&&r<128?(H(e,t,48|a),e.writeInt8(r)):-32768<=r&&r<32768?(H(e,t,64|a),e.writeInt16(r)):(H(e,t,80|a),e.writeInt32(r));else if("number"==typeof r)H(e,t,112|a),e.writeFloat64(r);else if("string"==typeof r){var n=g(r);n<256?(H(e,t,128|a),e.writeUint8(n)):n<65536?(H(e,t,144|a),e.writeUint16(n)):(H(e,t,160|a),e.writeUint32(n)),e.writeString(r)}}function H(e,t,r){t<256?(e.writeUint8(r),e.writeUint8(t)):(e.writeUint8(8|r),e.writeUint16(t))}function q(){if(!D)return Promise.resolve();var e=D.stringBuffer();if(!e)return Promise.resolve();var t=(0,A.default)(D,"context").unsavedPortion;if(t&&0===t.eventsWritten)return Promise.resolve();var r=(0,A.default)(D,"context").saveKey;return(t?m.update(r,e).then((function(e){return D?e?("wam:save successfully updated ".concat(r),void((0,A.default)(D,"context").unsavedPortion=new Y(F))):(D=D.unsavedPortion,q()):Promise.resolve()})):m.add(r,e).then((function(){if(!D)return Promise.resolve();"wam:save successfully saved new entry ".concat(r),(0,A.default)(D,"context").unsavedPortion=new Y(F)}))).catch((function(e){__LOG__(3)(O(),String(e))}))}function z(e,t){return""===e||"["===e[0]?Promise.resolve(void 0):p(e,t)}function J(){return Math.floor(Date.now()/1e3)}var Q=(0,y.default)({commit:function(e){null==e.commitTime||0===e.commitTime?0!==e.weight&&Math.random()*e.weight>1?e.commitTime=J():("wam:commit ".concat(e.$className),e.all,x(e),K([!0,e])):__LOG__(3)(M(),e.$className)},set:function(e,t){"wam:set ".concat(e.name," = ").concat(String(t)),K([!1,e,t])},resumeJobs:j,initialize:B},(function(e){return function(){if(R)e.apply(void 0,arguments);else{I||(I=[],self.setTimeout((function(){if(null!=I){c=r(60339).encodeB64,n=r(46378).Binary,g=r(46378).numUtf8Bytes,i=r(61867).default,u=r(52737).default,s=r(3594),o=r(50935).default,l=r(40210).default,h=r(39329).ShiftTimer,_=r(95595),m=r(58992).Z,f=r(98936).Z,p=r(8941).Z,(0,b.isConnectedToPage)()&&(d=r(44222)),v=new h(W);for(var e=0;e<(0,A.default)(I,"lazyJobs").length;e++)(0,A.default)(I,"lazyJobs")[e]();I=null,R=!0}}),0));for(var t=new Array(arguments.length),a=0;a<arguments.length;a++)t[a]=arguments[a];(0,A.default)(I,"lazyJobs").push((()=>{e.apply(void 0,t)}))}}}));t.default=Q},58992:(e,t,r)=>{"use strict";var a=r(14859);t.Z=void 0;var n=a(r(77771));t.Z=class{static add(e,t){return n.default.idb().then((r=>r.wam.add({key:e,buffer:t},e)))}static update(e,t){return n.default.idb().then((r=>r.wam.update(e,{key:e,buffer:t}))).then((e=>0!==e))}static deleteAll(){var e={};return n.default.idb().then((t=>t.wam.toCollection().modify((function(t){e[t.key]=t.buffer,delete this.value})))).then((()=>e))}}},44222:(e,t,r)=>{"use strict";var a=r(14859),n=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.monitor=function(e,t){f(e?t?"ab":"an":t?"ub":"un")},t.uploadEvent=function(){var e=new l.default.WebcWamUpload;if(i){f(o);var t=i.total;if(t>0){var r=i.an+i.ab,a=i.un+i.ub;e.set({webcTotalT:Math.ceil(i.total),webcAvailableTp:r/t,webcAvailableNormalTp:r?i.an/r:void 0,webcAvailableBbarTp:r?i.ab/r:void 0,webcUnavailableTp:a/t,webcUnavailableNormalTp:a?i.un/a:void 0,webcUnavailableBbarTp:a?i.ub/a:void 0})}d(o)}return e};var i,s,o,u=n(r(42743)),l=a(r(40210));function d(e){s=Date.now(),o=e,i={total:0,ab:0,an:0,ub:0,un:0}}function c(e){Date.now()-e>s?s+=e:i[o]-=e}function f(e){if(i){var t=Date.now(),r=Math.max(t-s,0);i.total+=r,i[e]+=r,s=t,o=e}else d(e),u.default.on(u.JS_HALT_EVENT,c)}},7232:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(19976)),i=a(r(40210));function s(){var e=(0,n.default)(["WAPReporter: fail to log basic send"]);return s=function(){return e},e}function o(){var e=(0,n.default)(["WAPReporter: fail to log send"]);return o=function(){return e},e}var u=new class{constructor(){this._events=new Map}logSend(e){var t=e.tag;if(t)try{var r=e.getName(),a=r.startsWith("query")?i.default.WEBC_WAP_REQUEST_KIND_CODE.GET:i.default.WEBC_WAP_REQUEST_KIND_CODE.SET,n=e.isToPhone?i.default.WEBC_WAP_REQUEST_DESTINATION_CODE.PHONE:i.default.WEBC_WAP_REQUEST_DESTINATION_CODE.SERVER,s=e.data.byteLength||JSON.stringify(e.data).length;this._createEvent(t,{kind:a,destination:n,name:r,size:s})}catch(e){__LOG__(3)(o())}}logBasicSend(e,t){if(e)try{var r=i.default.WEBC_WAP_REQUEST_KIND_CODE.GET,a=i.default.WEBC_WAP_REQUEST_DESTINATION_CODE.SERVER,n=t[1].toLowerCase(),o=JSON.stringify(t).length;this._createEvent(e,{kind:r,destination:a,name:n,size:o})}catch(e){__LOG__(3)(s())}}logAck(e){if(e){var t=this._events.get(e);t&&t.markWebcWapRequestAckT({showInTimeline:!1})}}logRecv(e,t,r){if(e){var a=this._events.get(e);a&&(a.webcWapRequestResponseSize=t,null!=r&&(a.webcWapRequestStatus=r),a.markWebcWapRequestRecvT({showInTimeline:!1}),a.commit(),this._events.delete(e))}}delete(e){e&&this._events.delete(e)}clear(){this._events.clear()}_createEvent(e,t){var r=new i.default.WebcWapRequest({webcWapRequestKind:t.kind,webcWapRequestDestination:t.destination,webcWapRequestName:t.name,webcWapRequestSize:t.size});this._events.set(e,r)}};t.default=u},34732:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.logWasmSupport=function(){var e;new n.default.WebcWasmSupport({webcWasmSupported:null!=(null===(e=window.WebAssembly)||void 0===e?void 0:e.instantiate)}).commit()};var n=a(r(40210))},68398:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getAppUserModelId=function(){return"win32"!==process.platform||process.windowsStore?null:"com.squirrel.WhatsApp.WhatsApp"}},17483:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.getDoNotDisturb=function(){try{var e,t;if("darwin"===process.platform)return(null===(e=window.Native.MacOSNotificationState)||void 0===e?void 0:e.getDoNotDisturb())||(null===(t=window.Native.MacOSNotificationState)||void 0===t?void 0:t.getNotificationState())===o.SESSION_SCREEN_IS_LOCKED;if("win32"===process.platform){var r,a,n,l,d;if((null===(r=window.Native.WindowsNotificationState)||void 0===r?void 0:r.getNotificationState())!==o.QUNS_ACCEPTS_NOTIFICATIONS)return!0;var c=(0,i.getAppUserModelId)(),f=c&&"YES"===(null===(a=window.Native.WindowsFocusAssist)||void 0===a||null===(n=a.isPriority(c))||void 0===n?void 0:n.name),p=null===(l=window.Native.WindowsFocusAssist)||void 0===l?void 0:l.getFocusAssist().name;return!!(f&&p===u.ALARMS_ONLY||!f&&[u.PRIORITY_ONLY,u.ALARMS_ONLY].includes(p))||!!(null===(d=window.Native.WindowsQuiteHours)||void 0===d?void 0:d.getIsQuietHours())}}catch(e){__LOG__(3)(s(),e)}return!1};var n=a(r(19976)),i=r(68398);function s(){var e=(0,n.default)(["getDoNotDisturb failed with error ",""]);return s=function(){return e},e}var o=r(28103).Mirrored(["UNKNOWN","SESSION_SCREEN_IS_LOCKED","SESSION_ON_CONSOLE_KEY","QUNS_NOT_PRESENT","QUNS_BUSY","QUNS_RUNNING_D3D_FULL_SCREEN","QUNS_PRESENTATION_MODE","QUNS_ACCEPTS_NOTIFICATIONS","QUNS_QUIET_TIME","QUNS_APP","UNKNOWN_ERROR"]),u=r(28103).Mirrored(["NOT_SUPPORTED","FAILED","OFF","PRIORITY_ONLY","ALARMS_ONLY"])},27998:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.playEndCallTone=function(){}},86884:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.hasPending=function(){return null!=be&&be.hasPending()},t.execApiCmd=Me,t.default=t.InitialEmojisCompletionContext=t.Screen=void 0;var i=n(r(19976)),s=n(r(25291)),o=n(r(72779)),u=r(39329),l=n(r(47677)),d=n(r(19034)),c=a(r(2784)),f=n(r(25337)),p=r(25675),h=n(r(59802)),_=(n(r(43764)),a(r(86634))),m=n(r(23109)),g=n(r(85943)),v=n(r(19899)),E=n(r(79711)),y=n(r(26147)),S=n(r(52737)),T=n(r(50935)),b=a(r(93292)),A=n(r(77771)),C=n(r(52645)),P=n(r(13517)),O=r(95585),w=r(90776),M=r(95595),I=n(r(18120)),R=n(r(44343)),D=n(r(50868)),N=n(r(17957)),L=n(r(20642)),k=r(63925),U=n(r(46023)),F=n(r(11412)),G=a(r(4901)),x=n(r(61941)),B=n(r(63576)),Y=r(47398),K=r(27985),j=r(36927),W=n(r(11719)),V=n(r(67616)),H=n(r(72424)),q=n(r(39401)),z=n(r(79583)),J=a(r(17026)),Q=n(r(94984)),X=a(r(2220)),Z=n(r(35563)),$=n(r(50198)),ee=n(r(77626)),te=n(r(17693)),re=n(r(78135)),ae=n(r(51701)),ne=r(80084),ie=n(r(12767)),se=a(r(7355)),oe=n(r(15410)),ue=r(31822),le=n(r(34563)),de=n(r(8166)),ce=(n(r(28193)),r(54086)),fe=n(r(74185));function pe(){var e=(0,i.default)(["Banned accounts: user selected logout"]);return pe=function(){return e},e}function he(){var e=(0,i.default)(["Local Clock: ",", Skew: ",""]);return he=function(){return e},e}function _e(){var e=(0,i.default)(["App:registerYesterdayTimer:rerenderUI relative timestamps"]);return _e=function(){return e},e}function me(){var e=(0,i.default)(["Failed to open indexeddb: ",""]);return me=function(){return e},e}function ge(){var e=(0,i.default)(["Modified a created iframe element to include sandbox attributes for security fix."]);return ge=function(){return e},e}function ve(){var e=(0,i.default)(["App:componentDidMount:visibilityState: ",""]);return ve=function(){return e},e}function Ee(){var e=(0,i.default)(["App:componentDidMount:rerenderUI locale change"]);return Ee=function(){return e},e}function ye(){var e=(0,i.default)(["[md takover] tab taken over. stopping comms"]);return ye=function(){return e},e}function Se(){var e=(0,i.default)(["[md takover] refreshing page on takeover"]);return Se=function(){return e},e}function Te(){var e=(0,i.default)(["main:execApiCmd:",""]);return Te=function(){return e},e}r(48393),ie.default.registerHandler((e=>{(0,k.requireHandleSocketMessage)().then((t=>t(e)))}));var be,Ae=r(28103).Mirrored(["CLIENT_EXPIRED_DIALOG","ANOTHER_SESSION","QR","SYNCING","OFFLINE","PROXYBLOCK","CONFLICT","TOS_BLOCK","SMB_TOS_BLOCK","DEPRECATED_VERSION","MAIN","STARTUP","TEMP_BAN","LOGOUT"]);t.Screen=Ae;var Ce=!1,Pe=!1;function Oe(e){"initialPanelMountTRecorded"===e&&(Ce=!0),"initialPanelRenderTRecorded"===e&&(Pe=!0),Ce&&Pe&&(0,Y.onInitialRenderComplete)()}var we=(0,s.default)((()=>{(0,Y.saveInitialPanelMountTime)(Date.now()),Oe("initialPanelMountTRecorded")}));function Me({cmdAndData:e,isExternal:t}){var{resultType:r,data:a}=e;return __LOG__(2)(Te(),r),(0,l.default)(null!=be,"Attempted to exec API command before main was loaded"),be.execApiCmd({cmd:r,untypedData:a,isExternal:t})}var Ie=new P.default,Re=c.createContext(Ie);t.InitialEmojisCompletionContext=Re;class De extends c.Component{constructor(...e){super(...e),this.contextMenuRef=c.createRef(),this.animate=!0,this.state={mode:J.default.mode,updating:J.default.clientExpired,hardExpired:J.default.hardExpired,anotherSession:!1,takingOver:!1,apiCmd:void 0,locale:N.default.getLocale(),mainLoaded:!1,socketProgressStep:0,theme:(0,X.getTheme)(),systemThemeMode:(0,X.getSystemThemeMode)(),isKeyboardUser:!1,initialLoadReady:!1,startLogout:!1,stayInSync:!ie.default.hasSynced},this._unsetIsKeyboardUser=()=>{this.setState({isKeyboardUser:!1})},this._setIsKeyboardUser=()=>{this.setState({isKeyboardUser:!0})},this._handlers={up:this._setIsKeyboardUser,down:this._setIsKeyboardUser,left:this._setIsKeyboardUser,right:this._setIsKeyboardUser,home:this._setIsKeyboardUser,end:this._setIsKeyboardUser,"command+up":this._setIsKeyboardUser,"command+down":this._setIsKeyboardUser,pageUp:this._setIsKeyboardUser,pageDown:this._setIsKeyboardUser,tab:this._setIsKeyboardUser,"shift+tab":this._setIsKeyboardUser,"shift+?":this._setIsKeyboardUser},this._setModeScheduler=new u.ShiftTimer((e=>{e!==this.state.mode&&this.setState({mode:e})})),this._handleStreamModeChange=()=>{var e=J.default.mode;this.state.mode!==J.StreamMode.MAIN?this._setModeScheduler.onOrBefore(0,e):this._setModeScheduler.forceRunNow(e)},this._onClientExpired=()=>{this.state.updating!==J.default.clientExpired&&this.setState({updating:J.default.clientExpired})},this._onHardExpired=()=>{this.setState({hardExpired:J.default.hardExpired})},this.onMouseDown=e=>{this._unsetIsKeyboardUser(),E.default.windowMouseDown(e)},this.onClick=e=>{this._unsetIsKeyboardUser(),E.default.windowClick(e)},this._handleWindowClick=e=>{var t,r=e.target;if(r&&"A"===r.nodeName){var a=r.getAttribute("href");if(a)if(!(null===(t=r.dataset)||void 0===t?void 0:t.nohandle)){var n=(0,K.parseAPICmd)(a);"INVALID"!==n.resultType&&this._canExecApiCmd()&&Me({cmdAndData:n,isExternal:!0})&&e.preventDefault()}}},this._handleSetTheme=e=>{if(this.state.theme!==e){for(var t of X.THEME_ASSETS[e])_.default.loadAsset(t,_.LOAD_PRIORITY.THEME_ASSET_LOAD,!1);if(H.default.wallpapersV2){var r=m.default.get("defaultPreference");if(r&&T.default.DEFAULT_CHAT_WALLPAPER!==r.wallpaperColor){var a=(0,ne.toggleWallpaperColor)(r.wallpaperColor,this.state.theme);r.set("wallpaperColor",a)}}(0,X.setTheme)(e),this.setState({theme:e})}},this._handleSetSystemThemeMode=e=>{(0,X.setSystemThemeMode)(e),this.setState({systemThemeMode:e})},this._mdReloadPageOnTakeOver=()=>{__LOG__(2)(Se()),window.location.reload()},this._onReadyForMainScreen=()=>this.setState({stayInSync:!1}),this._getThemeContextValue=(0,F.default)((({theme:e,systemThemeMode:t})=>({theme:e,setTheme:this._handleSetTheme,systemThemeMode:t,setSystemThemeMode:this._handleSetSystemThemeMode})))}componentDidMount(){!0===(0,M.mdOptedIn)()&&(I.default.setFeature(I.default.F.MD_BACKEND,!0),I.default.setFeature(I.default.F.MD_ADV,!0),I.default.setFeature(I.default.F.MD_VOIP_GROUP,!1));var{theme:e}=this.state;(0,X.applyThemeToUI)(e),ke().then((t=>{_.default.setPlatform(t),_.default.loadInitialAssets(X.THEME_ASSETS[e])})),Promise.all([Promise.all([(0,k.requireMain)(),ke()]).then((([e,t])=>{Y.mainScriptTimer.start(),be=e(t),Y.mainScriptTimer.end()})),(0,U.default)()]).then(j.loadProtoVersions).then((()=>{E.default.mainLoaded(),this.setState({mainLoaded:!0})})).then((()=>Promise.all([(0,k.requireEmojiAssetMapCreator)(),(0,k.requireEmojiConfig)(),ke()]))).then((([e,t,r])=>{_.default.setPlatform(r),_.default.initEmojiAsset(e(t)),Ie.beginPreloadFallback()}));var{listeners:t}=this.props;t.add(E.default,"increment_progress",(()=>{this._incProgress()})),t.add(E.default,"initial_load_ready",(()=>{this.setState({initialLoadReady:!0})})),I.default.supportsFeature(I.default.F.MD_BACKEND)&&(t.add(E.default,"account_temporarily_banned",(e=>{this.setState({temporaryBan:e})})),t.add(E.default,"starting_logout",(()=>{this.setState({startLogout:!0})})),ue.OfflineResumeReporter.logPageLoadT());var a,n=r(18310).Z;if(t.add(window,"beforeunload",n.unloadMutex.bind(n)),t.add(window,"unload",n.unloadMutex.bind(n)),t.add(window,"storage",(e=>{n.storagePong(e)&&(I.default.supportsFeature(I.default.F.MD_BACKEND)&&(__LOG__(2)(ye()),(0,ce.stopComms)()),oe.default.onTakeOver(),this.setState({takingOver:!1,anotherSession:!0}))})),t.add(J.default,"change:clientExpired",this._onClientExpired),t.add(J.default,"change:hardExpired",this._onHardExpired),t.add(J.default,"change:mode",this._handleStreamModeChange),fe.default.canMuckHistory()){var i=(0,K.parseAPICmd)(window.location.href);if(i.resultType!==p.APICmd.INVALID){var{url:s}=i.data;delete i.data.url,this._maybeExecApiCmd(i),window.history.replaceState({},"",s)}}t.add(N.default,"locale_change",(e=>{__LOG__(2)(Ee()),(0,M.setLangPref)(e),this.animate=!1,this.setState({locale:"".concat(N.default.getLocale(),"#").concat(d.default.locale())})})),this._registerYesterdayTimer(),__LOG__(2)(ve(),document.visibilityState),"prerender"===document.visibilityState?(0,ae.default)(document,"visibilitychange").timeout(5e3).then((()=>this._beginMutex(0))).catch((()=>this._beginMutex(0))):this._beginMutex(0),this.props.listeners.add(window,"click",this._handleWindowClick,!0),this.props.listeners.add(window,"blur",(()=>{this._unsetIsKeyboardUser()})),se.default.poll(se.checkForUpdates),this._logFirstRenderMountTime(),document.createElement=(a=document.createElement.bind(document),(e,t={})=>{if("iframe"===e.toLowerCase()){__LOG__(3)(ge());var r=a(e,t);return r.sandbox=H.default.webYouTubePlayerEnhancements?"allow-scripts allow-same-origin allow-popups allow-popups-to-escape-sandbox":"allow-scripts allow-same-origin",r}return a(e,t)}),this.props.listeners.add(Q.default,"system_theme_change",(e=>{this.state.systemThemeMode&&this._handleSetTheme(e)}))}componentDidUpdate(e,t){!0===t.anotherSession&&!1===this.state.anotherSession?A.default.openDB().catch((e=>{__LOG__(3)(me(),e)})):!1===t.anotherSession&&!0===this.state.anotherSession&&A.default.idb().then((e=>e.close())).catch((()=>{})),this._maybeExecApiCmd(this.state.apiCmd),this.state.mode!==J.StreamMode.MAIN&&(this.animate=!0),this._logFirstRenderMountTime()}componentWillUnmount(){this._setModeScheduler.cancel(),this._setWamSystemInfo&&this._setWamSystemInfo.cancel()}_beginMutex(e,t=!1){t&&re.default.shouldForceUpdateOnTakeOver()&&re.default.restart();var a=r(18310).Z;return(t?a.takeoverLocal(e):a.init(e)).catch((e=>(this.setState({takingOver:!0}),this._beginMutex(e,!0)))).then((e=>{oe.default.isTakeOver=e,this.setState({takingOver:!1,anotherSession:e})}))}_incProgress(){this.setState({socketProgressStep:this.state.socketProgressStep+1})}_maybeExecApiCmd(e){if(e)return this._canExecApiCmd()?(Me({cmdAndData:e,isExternal:!0}),void(null!=this.state.apiCmd&&this.setState({apiCmd:null}))):void(e!==this.state.apiCmd&&this.setState({apiCmd:e}))}_canExecApiCmd(){return null!=be&&Le(this.state)===Ae.MAIN}_logFirstRenderMountTime(){this.state.mode!==J.StreamMode.SYNCING&&we()}_calculateProgress(){return 20*this.state.socketProgressStep}_registerYesterdayTimer(){f.default.setLocalTimeout((()=>{__LOG__(2)(_e()),__LOG__(2)(he(),Date.now(),v.default.getSkew()),E.default.midnight(),this._registerYesterdayTimer()}),(0,d.default)().endOf("day").valueOf())}_getTemporaryBanReason(e){var t=(0,M.getMaybeMeUser)().user;switch(e){case 101:return N.default.t(1389,{phone:t});case 102:return N.default.t(1390);case 103:return N.default.t(1391,{phone:t});case 104:return N.default.t(1392);case 106:return N.default.t(1393);default:return N.default.t(1394)}}_getUiAndIconCount(){switch(Le(this.state)){case Ae.CLIENT_EXPIRED_DIALOG:return{ui:c.createElement(w.DefaultFavicon,null,c.createElement(g.default,null)),requiresBackendCheck:!1};case Ae.ANOTHER_SESSION:var e,t;return this.state.takingOver?(e=()=>{},t=N.default.t(531)):(e=()=>{I.default.supportsFeature(I.default.F.MD_BACKEND)?this._mdReloadPageOnTakeOver():this._beginMutex(0,!0)},t=N.default.t(403)),{ui:c.createElement(w.ErrorFavicon,null,c.createElement(y.default,{cancelText:N.default.t(1604),onCancel:window.open.bind(window,"https://www.whatsapp.com/","_self"),okText:t,onOK:e},N.default.t(1914))),requiresBackendCheck:!1};case Ae.TEMP_BAN:var{code:r,expire:a}=this.state.temporaryBan||{},n=this._getTemporaryBanReason(r),i=d.default.duration(a,"seconds").humanize();return{ui:c.createElement(w.ErrorFavicon,null,c.createElement(y.default,{cancelText:N.default.t(968),onCancel:()=>{__LOG__(2)(pe()),ie.default.logout()},okText:N.default.t(1720),onOK:window.open.bind(window,(0,O.getFaqUrl)())},c.createElement("div",null,n),c.createElement("div",null,N.default.t(1388,{duration:i})))),requiresBackendCheck:!0};case Ae.QR:return{ui:c.createElement(w.DefaultFavicon,null,c.createElement(G.default,{type:G.ModalType,key:"modal-manager"}),c.createElement(V.default,{key:"qr-code",apiCmd:this.state.apiCmd})),extraClasses:h.default.isQR,requiresBackendCheck:!0};case Ae.STARTUP:case Ae.SYNCING:if(I.default.supportsFeature(I.default.F.MD_BACKEND)){var s=c.createElement(le.default,{initialLoadReady:this.state.initialLoadReady,onReady:this._onReadyForMainScreen});return{ui:c.createElement(w.DefaultFavicon,null,s),requiresBackendCheck:!0}}var o=c.createElement(z.default,{progress:this._calculateProgress()});return{ui:c.createElement(w.DefaultFavicon,null,o),requiresBackendCheck:!0};case Ae.OFFLINE:return{ui:c.createElement(w.ErrorFavicon,null,c.createElement(B.default,null)),requiresBackendCheck:!0};case Ae.PROXYBLOCK:return{ui:c.createElement(w.ErrorFavicon,null,c.createElement(W.default,null)),requiresBackendCheck:!0};case Ae.CONFLICT:return{ui:c.createElement(w.ErrorFavicon,null,c.createElement(y.default,{cancelText:N.default.t(968),onCancel:()=>ie.default.logout(),okText:N.default.t(403),onOK:()=>ie.default.takeover()},N.default.t(1174))),requiresBackendCheck:!0};case Ae.TOS_BLOCK:return{ui:c.createElement(w.ErrorFavicon,null,c.createElement($.default,{description:N.default.t(1866)})),requiresBackendCheck:!0};case Ae.SMB_TOS_BLOCK:return{ui:c.createElement(w.ErrorFavicon,null,c.createElement($.default,{description:N.default.t(1839)},c.createElement(q.default,null))),requiresBackendCheck:!0};case Ae.DEPRECATED_VERSION:return{ui:c.createElement(w.ErrorFavicon,null,c.createElement(C.default,null)),requiresBackendCheck:!0};case Ae.LOGOUT:return{ui:c.createElement(w.DefaultFavicon,null,c.createElement(G.default,{type:G.ModalType,key:"modal-manager"}),c.createElement(de.default,{key:"logout"})),requiresBackendCheck:!0};case Ae.MAIN:var{MainComponent:u}=(0,x.default)(be,"Main");return{ui:[c.createElement(Z.default,{key:"toast-manager"}),c.createElement(G.default,{contextMenuRef:this.contextMenuRef,type:G.ModalType,key:"main-modal-manager"}),c.createElement(G.default,{type:G.MediaType,key:"media-modal-manager"}),c.createElement(b.default,{ref:this.contextMenuRef,type:b.Type.MENU,key:"context-menu-manager"}),c.createElement(b.default,{type:b.Type.TOOLTIP,key:"tooltip-manager"}),c.createElement(Re.Provider,{key:"main",value:Ie},c.createElement(u,{conn:S.default,animate:this.animate}))],extraClasses:h.default.isMain,requiresBackendCheck:!0}}}render(){!function(e){if(Y.initialScreenTimer.hasStarted())return;var t=Le(e);if(!function(e){return e!==Ae.SYNCING}(t))return;(0,Y.setInitialScreen)(t),Y.initialScreenTimer.start(),window.requestAnimationFrame((()=>{Y.initialScreenTimer.end(),Oe("initialPanelRenderTRecorded")}))}(this.state);var{isKeyboardUser:e}=this.state,{ui:t,extraClasses:r,requiresBackendCheck:a}=this._getUiAndIconCount(),n=(0,o.default)(h.default.wrapper,r,{"app-wrapper-web":!0,"safari-fix":ee.default.isSafari,"edge-fix":ee.default.isTrident,"font-fix":ee.default.browser===T.default.BROWSER_TYPE.CHROME||ee.default.browser===T.default.BROWSER_TYPE.OPERA,"os-mac":ee.default.os===T.default.OS_TYPE.MAC,"os-win":ee.default.os===T.default.OS_TYPE.WINDOWS,"keyboard-user":e});return a&&null!=be&&!(0,M.knowsPhone)()&&be.notificationBackend.shutdownAsNeeded(),c.createElement(X.default.Provider,{value:this._getThemeContextValue({theme:this.state.theme,systemThemeMode:this.state.systemThemeMode})},c.createElement(D.default.Provider,{value:e},c.createElement(te.default,{displayName:"App",uimState:te.default.State.INACTIVE},c.createElement(R.default,{handlers:this._handlers,className:n,onMouseDownCapture:this.onMouseDown,onClickCapture:this.onClick},undefined,undefined,t))))}}De.displayName="App";var Ne=(0,L.default)(De);function Le(e){var{anotherSession:t,updating:r,hardExpired:a,mainLoaded:n,mode:i,temporaryBan:s}=e;if(null==s?void 0:s.banned)return Ae.TEMP_BAN;if(r||a)return Ae.CLIENT_EXPIRED_DIALOG;if(t)return Ae.ANOTHER_SESSION;if(I.default.supportsFeature(I.default.F.MD_BACKEND)&&e.startLogout)return Ae.LOGOUT;switch(i){case J.StreamMode.QR:return Ae.QR;case J.StreamMode.SYNCING:return Ae.SYNCING;case J.StreamMode.OFFLINE:return Ae.OFFLINE;case J.StreamMode.PROXYBLOCK:return Ae.PROXYBLOCK;case J.StreamMode.CONFLICT:return Ae.CONFLICT;case J.StreamMode.TOS_BLOCK:return Ae.TOS_BLOCK;case J.StreamMode.SMB_TOS_BLOCK:return Ae.SMB_TOS_BLOCK;case J.StreamMode.DEPRECATED_VERSION:return Ae.DEPRECATED_VERSION;case J.StreamMode.MAIN:return n?Ae.MAIN:Ae.STARTUP}throw new Error("app:render Error invalid StreamMode: ".concat(i))}function ke(){return S.default.platform?Promise.resolve(S.default.platform):new Promise((e=>{var t=()=>{var{platform:r}=S.default;null!=r&&(S.default.off("change:platform",t),e(r))};S.default.on("change:platform",t)}))}t.default=Ne},901:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default=class{constructor(e,t,r){this.retryCount=0,this.asset=e,this.resolution=t,this.priority=r}getLoadUrlPromise(){return this._loadUrlPromise}setLoadUrlPromise(e){this._loadUrlPromise=e}getConsumerPromise(){return this._consumerPromise}setConsumerPromise(e){this._consumerPromise=e}getConsumerPromiseResolve(){return this._consumerPromiseResolve}setConsumerPromiseResolve(e){this._consumerPromiseResolve=e}}},89741:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){if(!r(58906).default.supported)return;var t=!0===e.estimateStorage,a=r(30734).default,c=r(99215).default,f=navigator.serviceWorker;(0,s.default)().then((t=>{var r=(0,n.default)(e.keep,(e=>[e[i.default.RES.LOW],e[i.default.RES.HIGH]])).map((e=>{var r,a=null===(r=e[t&&e[d]?d:l])||void 0===r?void 0:r.split("/");return null!=a?a[a.length-1]:null}));f&&f.controller&&a.request(f.controller,c.CLEAN_ASSETS,r).catch((()=>{}))})).then((()=>t?(0,u.default)():null)).then((e=>{e&&new o.default.WebcStorageStat({webcStorageUsage:e.usage,webcStorageQuota:e.quota}).commit()}))};var n=a(r(35838)),i=a(r(56117)),s=a(r(36455)),o=a(r(40210)),u=a(r(25353)),l="default",d="webp"},38527:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.getEmojiTypeFromPlatform=p,t.default=function(e){return t=>f(t,e)};var n=a(r(98346)),i=a(r(75652)),s=a(r(30733)),o=r(52737),u=a(r(50935)),l=r(70270),{EMOJI:{EMOJI_TYPE:d,BUCKET_SIZE:c}}=u.default,f=(0,s.default)(((e,t)=>{for(var r=new Map,a=p(e),s=t[a],o=s.SELECTOR,u=Math.ceil((0,i.default)((0,n.default)(s.UNICODE_TO_EMOJI)).length/c),d=0;d<u;d+=1){var f="emoji-".concat(o,"-b").concat(d);r.set(f,{id:f,selectors:[".emoji.".concat(o,".b").concat(d),".emojik.".concat(o,".b").concat(d)],low:{default:(0,l.getEmojiSpritesPath)(a,d,40,"png"),webp:(0,l.getEmojiSpritesPath)(a,d,40,"webp")},high:{default:(0,l.getEmojiSpritesPath)(a,d,64,"png"),webp:(0,l.getEmojiSpritesPath)(a,d,64,"webp")}})}return r}));function p(e){switch(e){case o.PLATFORMS.IPHONE:case o.PLATFORMS.SMBI:case o.PLATFORMS.IPAD:case o.PLATFORMS.IPOD:return d.APPLE;default:return d.WHATSAPP}}},13517:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(19976)),i=a(r(86634)),s=a(r(40210));function o(){var e=(0,n.default)(["EmojiCompletionTracker:firstScreenEmojis complete in "," ms"]);return o=function(){return e},e}t.default=class{constructor(){this._loadingEmojisCount=0,this._hasTriggeredEmojiPreload=!1,this.beginPreload=(e=!1)=>{this._hasTriggeredEmojiPreload||(this._hasTriggeredEmojiPreload=!0,window.setTimeout((()=>{i.default.loadEmojis()}),e?1e3:0))},this.beginPreloadFallback=()=>{window.setTimeout((()=>{this.beginPreload(!1)}),5e3)},this.incrementLoadingEmojisCount=()=>{this._hasTriggeredEmojiPreload||(this._firstScreenEmojisLoadEvent||(this._firstScreenEmojisLoadEvent=new s.default.WebcFirstScreenEmojisLoad({webcLoadedEmojisCount:0})),this._firstScreenEmojisLoadEvent.webcEmojisLoadT||(this._firstScreenEmojisLoadEvent.webcLoadedEmojisCount+=1),this._loadingEmojisCount+=1)},this.decrementLoadingEmojisCount=()=>{if(!this._hasTriggeredEmojiPreload){this._loadingEmojisCount-=1;var e=this._firstScreenEmojisLoadEvent;if(0===this._loadingEmojisCount&&e){this.beginPreload(!0),e.markWebcEmojisLoadT(),e.commit();var t=e.webcEmojisLoadT;__LOG__(2)(o(),t)}}}}}},86634:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.AssetLoaderClass=t.default=t.AssetLoader=t.LOAD_PRIORITY=void 0;var i=n(r(19976)),s=n(r(98346)),o=n(r(18149)),u=n(r(47677)),l=n(r(901)),d=n(r(89741)),c=n(r(50935)),f=n(r(56117)),p=n(r(44243)),h=n(r(12396)),_=r(38527),m=a(r(96182)),g=n(r(40210)),v=n(r(61941)),E=n(r(13818)),y=a(r(82885));function S(){var e=(0,i.default)(["Assertion failed!"]);return S=function(){return e},e}function T(){var e=(0,i.default)(["Asset: "," failed. Retrying... ",""]);return T=function(){return e},e}function b(){var e=(0,i.default)(["Asset load cancelled by more recent request: ","-",""]);return b=function(){return e},e}function A(){var e=(0,i.default)(["AssetLoader:loadEmojis cancelled by more recent request."]);return A=function(){return e},e}function C(){var e=(0,i.default)(["AssetLoader:loadEmojis complete in ","ms"]);return C=function(){return e},e}function P(){var e=(0,i.default)(["AssetLoader: loadEmoji Cancelled by more recent request: ","-",""]);return P=function(){return e},e}function O(){var e=(0,i.default)(["AssetLoader:loadInitialAssets cancelled by more recent request."]);return O=function(){return e},e}function w(){var e=(0,i.default)(["AssetLoader:loadInitialAssets complete in ","ms"]);return w=function(){return e},e}var M={INITIAL_EMOJI_LOAD:1,INITIAL_ASSET_LOAD:2,THEME_ASSET_LOAD:2,HELP_ANIMATED_DOODLE:2,LAZY_LOAD_EMOJI:2,NOTIFICATION_ICON:2};t.LOAD_PRIORITY=M;var{EMOJI_TYPE:I}=c.default.EMOJI;class R{constructor(e=90){this._assetStyle=new p.default("asset-style"),this._requestedAssets={},this._loadingDataMap={},this._getEmojiForPlatform=null,this._currentResolution=f.default.currentRes,this._currentlyLoadingCount=0,this._queue=new E.default((e=>-e.priority)),this._hasLoggedDecrementBelowZero=!1,this._handleDpiChange=()=>{var e=f.default.currentRes,t=this._currentResolution;e!==t&&(this._currentResolution=e,Object.keys(this._requestedAssets).forEach((e=>{this._cancelLoad(e,t)})),this._loadAssets((0,s.default)(this._requestedAssets),M.INITIAL_EMOJI_LOAD,{forceCheck:!1}).catchType(Promise.CancellationError,(()=>{})))},this._maxConcurrentRequests=e,window.addEventListener("dpichange",this._handleDpiChange)}initEmojiAsset(e){this._getEmojiForPlatform=e}loadInitialAssets(e){var t=new g.default.WebcAssetLoad({webcAssetName:"initial-assets",webcAssetFromCache:!1,webcAssetCacheType:g.default.WEBC_ASSET_CACHE_TYPE_CODE.UNCACHED});this._loadAssets(e,M.INITIAL_ASSET_LOAD,{estimateStorage:!0}).then((()=>{t.markWebcAssetLoadT(),t.commit();var e=t.webcAssetLoadT;__LOG__(2)(w(),e)})).catchType(Promise.CancellationError,(()=>{__LOG__(2)(O())}))}loadEmoji(e,t){if(this._getEmojiForPlatform&&this._currentPlatform){var r=this._getEmojiForPlatform(this._currentPlatform),a=h.default.getBucket(e),n=this._getEmojiPrefix(),i=r.get("".concat(n,"b").concat(a)),s=this._currentResolution;return i?this.loadAsset(i,t,!1).catchType(Promise.CancellationError,(()=>{__LOG__(2)(P(),i.id,s)})):Promise.reject(new Error("The given emoji glyph id was not found"))}return Promise.reject(new Error("emojiForPlatform or currentPlatform are not set"))}loadEmojis(){var e=(0,v.default)(this._currentPlatform,"this._currentPlatform");(0,u.default)(null!=this._getEmojiForPlatform,"Emojis were loaded before initializing the emoji assets!");var t=[...this._getEmojiForPlatform(e).values()],r=new g.default.WebcAssetLoad({webcAssetName:"emojis",webcAssetFromCache:!1,webcAssetCacheType:g.default.WEBC_ASSET_CACHE_TYPE_CODE.UNCACHED});this._loadAssets(t,M.INITIAL_EMOJI_LOAD,{estimateStorage:!0}).then((()=>{r.markWebcAssetLoadT(),r.commit();var e=r.webcAssetLoadT;__LOG__(2)(C(),e)})).catchType(Promise.CancellationError,(()=>{__LOG__(2)(A())}))}loadAsset(e,t,r=!0){var{id:a}=e,n=f.default.currentRes,i=this._requestedAssets[a];if(i&&!(0,o.default)(e,i))return Promise.reject(new Error(["Attempted to load an asset using an already used ID"].join("\n")));this._requestedAssets[a]=e,this._loadingDataMap[a]=this._loadingDataMap[a]||{};var s="high"===n?"low":"high";this._cancelLoad(a,s);var u=this._loadingDataMap[a][n];if(u&&!r)return u.promise;var d=new l.default(e,n,t),c=this._buildPromise(d).uncancellable().tap((t=>{var{selectors:r}=e;r&&this._assetStyle.setRule("".concat(r.join(", ")),{"background-image":"url('".concat(t,"')")})})).catch((e=>{var t=this._loadingDataMap[a][n],r=p!==t;if(r||(this._loadingDataMap[a][n]=null),e instanceof Promise.CancellationError&&(__LOG__(2)(b(),a,n),r&&t))return t.promise;throw e}));d.setConsumerPromise(c);var p={promise:c,cancel:e=>{this._cancelUrlPromise(d,e)}};return this._loadingDataMap[a][n]=p,u&&u.cancel(!1),this._startLoad(),c}_buildPromise(e){return new Promise((t=>{e.setConsumerPromiseResolve(t),this._queue.push(e)})).cancellable()}_startLoad(){var e=this;if(!(this._currentlyLoadingCount>=this._maxConcurrentRequests))for(var t=function(){var t=e._queue.pull();if(!t)return{v:void 0};e._currentlyLoadingCount+=1,(0,m.default)(t).then((()=>{e._decrementCurrentlyLoadingCount(),e._startLoad()})).catchType(Promise.CancellationError,(()=>{e._decrementCurrentlyLoadingCount(),e._startLoad()})).catch((r=>{e._decrementCurrentlyLoadingCount(),t.retryCount+=1;var a=y.expBackoff(t.retryCount,12e4,1e3,.1);setTimeout((()=>{e._queue.push(t),e._startLoad()}),a),e._startLoad(),(0,m.getSupportedImageFormatUrl)(t).then((e=>{var t=e.split("/");__LOG__(3)(T(),t[t.length-1],r.toString())}))}))},r=0;r<this._maxConcurrentRequests-this._currentlyLoadingCount;r++){var a=t();if("object"==typeof a)return a.v}}_cancelUrlPromise(e,t=!0){var r=e.getLoadUrlPromise();if(r){r.cancel();var a=e.getConsumerPromise();t&&a&&a.cancel()}this._startLoad()}_cancelLoad(e,t){var r=this._loadingDataMap[e]&&this._loadingDataMap[e][t];r&&(this._loadingDataMap[e][t]=null,r.promise.isPending()&&r.cancel(!0))}setPlatform(e){if(e!==this._currentPlatform){this._currentPlatform=e;var t=((0,_.getEmojiTypeFromPlatform)(e)===I.APPLE?I.WHATSAPP:I.APPLE)===I.APPLE?"emoji-apple-":"emoji-wa-";if(Object.keys(this._requestedAssets).forEach((e=>{e.startsWith(t)&&(this._cancelLoad(e,"high"),this._cancelLoad(e,"low"))})),null!=this._getEmojiForPlatform){var r=[...this._getEmojiForPlatform(e).values()];this._loadAssets(r,M.INITIAL_EMOJI_LOAD,{forceCheck:!1})}}}_getEmojiPrefix(){return(0,_.getEmojiTypeFromPlatform)(this._currentPlatform)===I.APPLE?"emoji-apple-":"emoji-wa-"}_loadAssets(e,t,r){var a=!1!==(r&&r.forceCheck),n=!0===(r&&r.estimateStorage);return Promise.all(e.map((e=>this.loadAsset(e,t,a)))).then((e=>((0,d.default)({keep:(0,s.default)(this._requestedAssets),estimateStorage:n}),e)))}_decrementCurrentlyLoadingCount(){this._currentlyLoadingCount<=0&&!this._hasLoggedDecrementBelowZero&&(this._hasLoggedDecrementBelowZero=!0,__LOG__(4,void 0,new Error,!0)(S()),SEND_LOGS("Tried to decrease _loadingCount below zero, would have been negative.")),this._currentlyLoadingCount=Math.max(0,this._currentlyLoadingCount-1)}}t.AssetLoader=R;var D=new R;t.default=D;var N=R;t.AssetLoaderClass=N},96182:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.getSupportedImageFormatUrl=p,t.default=function(e){var t=new i.default,r=p(e).then((r=>{var a;return u.default.waitIfOffline({signal:(new i.default).signal}).then((()=>(a=Date.now(),(0,o.default)(r,{signal:t.signal})))).cancellable().catchType(Promise.CancellationError,(e=>(t.abort(),Promise.reject(e)))).then((t=>{var n=e.getConsumerPromiseResolve();if(!t.ok||!n)return Promise.reject(new f(r,t.status,Date.now()-a));n(r)})).cancellable()}));return e.setLoadUrlPromise(r),r},t.LoadUrlError=void 0;var n=r(29351),i=a(r(12489)),s=a(r(36455)),o=a(r(3757)),u=a(r(99911)),l=a(r(61941)),d="default",c="webp";class f extends((0,n.customError)("LoadUrlError")){constructor(e,t,r){super("Failed to load url. StatusCode: ".concat(t,". Duration: ").concat(r," ms")),this.url=e,this.statusCode=t}}function p(e){return(0,s.default)().cancellable().then((t=>{var{asset:r,resolution:a}=e,n=t&&r[a][c]?c:d;return(0,l.default)(r[a][n],"asset[resolution][format]")}))}t.LoadUrlError=f},96838:(e,t,r)=>{var a=r(19976),n=r(52954);function i(){var e=a(["version: ",""]);return i=function(){return e},e}function s(){var e=a(["latest hash: ",""]);return s=function(){return e},e}function o(){var e=a(["webclient close/reload triggered"]);return o=function(){return e},e}function u(){return(u=n((function*(){window.Promise=r(41449).Z,(0,r(50041).default)(),window.__LOG__=r(15410).log,window.SEND_LOGS=r(3594).sendLogs,window.onerror=r(19655).HC,window.Promise.onPossiblyUnhandledRejection=r(19655).e2;var{requireMain:e}=r(63925);e();var{exeTimer:t}=r(47398);t.start();var a=r(61941).default,u=r(28316),l=r(2784),d=r(77626).default;d.isSafari&&d.browserVersion.startsWith("13.")&&(a(document.body,"document.body").className+=" text-rendering-bug-fix"),r(14389),window.Velocity=r(86534),r(64928),window.WebFont=r(75310),r(29398);var c=r(29458),f=r(61370).Z;c.set(f);var{isFunction:p}=r(11419);["getSelection","open","focus"].forEach((function(e){var t=Object.getPrototypeOf(window)[e];p(t)&&window[e]!==t&&(window[e]=t)}));var h=r(3594);window.Debug||(window.Debug={}),window.Debug.uploadLogs=h.upload;try{var _=r(77771).default;yield _.loadUserIdb()}finally{var m=r(17957).default;m.init(r(95595).getLangPref()).then(n((function*(){(yield Promise.resolve().then(r.bind(r,19899))).default.setIs24HourBasedOnLocale()}))),r(15410).default;var{default:g,hasPending:v}=r(86884),E=r(50935).default;window.Debug.VERSION=E.VERSION_STR,window.Debug.DESKTOP_BETA=void 0;var y=r(61867).default;window.onbeforeunload=function(){if(y.isDownloading())y.clearDownloading();else if(__LOG__(2)(o()),__LOG__(2)(s(),E.LATEST_HASH),__LOG__(2)(i(),E.VERSION_STR),!(y.promptUnloadGuards>0))return v()?m.t(515):void 0},window.addEventListener("dragover",(function(e){e.preventDefault()})),window.addEventListener("drop",(function(e){e.preventDefault()})),r(26474).loadSVGData(),(0,r(43704).Z)()||(u.render(l.createElement(g,null),a(document.getElementById("app"),"document.getElementById('app')")),t.end())}if(window.navigator.serviceWorker&&!window.navigator.serviceWorker.controller)try{window.navigator.serviceWorker.register("/serviceworker.js",{scope:"/"})}catch(e){}}))).apply(this,arguments)}!function(){u.apply(this,arguments)}()},12073:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.genId=function(e){return(0,i.default)(e||"action_toast")},t.ActionToast=t.ActionType=t.ToastPosition=void 0;var i=n(r(74930)),s=r(91460),o=a(r(2784)),u=n(r(79711)),l=r(75074),d={LEFT:"LEFT",RIGHT:"RIGHT"};t.ToastPosition=d;t.ActionType=class{constructor(e,t){if(!e)throw new Error("ActionType must have text!");this.text=e,t&&(this.action=t.actionText,this.handler=t.actionHandler)}};class c extends o.Component{constructor(...e){super(...e),this.state={currentInitialAction:this.props.initialAction,actionType:this.props.initialAction,pending:!0},this._actionPromise=null,this.onAction=()=>{this.state.actionType&&this.state.actionType.handler&&this.state.actionType.handler().catch((()=>{}))},this.onDismiss=()=>{u.default.closeToast(this)}}static getDerivedStateFromProps(e,t){var r=e.initialAction;return r!==t.currentInitialAction?{currentInitialAction:r,actionType:r,pending:!0}:null}componentDidMount(){this._runAction(this.props.pendingAction)}componentDidUpdate(e){e.pendingAction!==this.props.pendingAction&&this._runAction(this.props.pendingAction)}_runAction(e){var t={};this._actionPromise&&this._actionPromise.control.cancel(),this._actionPromise=e.addRejectControl("cancel",(()=>t)).then((e=>{this.setState({actionType:e,pending:!1})})).catchConditional((e=>e!==t),(e=>{this.setState({actionType:e,pending:!1})})).then((()=>(0,s.delayMs)(this.props.settleDuration))).addRejectControl("cancel",(()=>t)).then((()=>{u.default.closeToast(this)})).catchConditional((e=>e===t),(()=>{})).endWithControls("cancel")}render(){var e,t,{actionType:r}=this.state;return r?(r.action&&r.handler&&(t=o.createElement(l.ToastActionBtn,{buttonText:r.action,onClick:this.onAction})),this.state.pending||(e=o.createElement(l.ToastDismissBtn,{onClick:this.onDismiss})),o.createElement(l.ToastBody,{toastPosition:this.props.toastPosition,actionText:r.text,actionBtn:t,dismissBtn:e})):null}}t.ActionToast=c,c.defaultProps={settleDuration:5e3,toastPosition:d.LEFT},c.displayName="ActionToast"},64:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(r(58527)),s=n(r(72779)),o=a(r(2784)),u=n(r(32960)),l=n(r(95387)),d=r(90973),c=n(r(2825)),f=n(r(71203)),p=n(r(14578)),h=n(r(72376));var _=function({a8nText:e,children:t,className:r,disabled:a,onClick:n,nowrap:_,spinner:m,type:g}){var v,[E,y]=(0,h.default)(n,{disabled:a}),[S,T]=(0,f.default)(),b=(0,p.default)(E,S);switch(g){case"primary":v="white";break;case"secondary":case"plain-white":case"simplified":v="highlight";break;default:v="default"}return a&&(v="default"),o.createElement("div",(0,i.default)({},y,{"data-a8n":u.default.key(e),className:(0,s.default)(l.default.button,{[l.default.primary]:"primary"===g,[l.default.secondary]:"secondary"===g,[l.default.plainWhite]:"plain-white"===g,[l.default.disabled]:a,[l.default.nowrap]:_,[l.default.simplified]:"simplified"===g,[l.default.warning]:"warning"===g,[l.default.strong]:"strong"===g,[l.default.strongPrimary]:"strong-primary"===g,[l.default.itemFocused]:T},r),ref:b}),o.createElement(d.FlexRow,{align:"center",justify:"center"},o.createElement(d.FlexItem,{a8nText:u.default.key("content")},null!=t?t:null),m?o.createElement(d.FlexItem,{a8nText:u.default.key("spinner"),className:l.default.spinner},o.createElement(c.default,{color:v,size:16})):null))};t.default=_},41353:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var{children:t,href:r,onClick:a,title:n,className:u}=e;return s.createElement("a",{className:(0,i.default)(u,o.default.link),href:null!=r?r:void 0,onClick:e=>{null!=r&&(e.metaKey||e.altKey)||(e.preventDefault(),a(e))},role:"button",rel:"noreferrer noopener",target:"_blank",title:n},t)};var i=n(r(72779)),s=a(r(2784)),o=n(r(67347))},79711:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.Cmd=t.APP_STATE_SYNC_COMPLETED=void 0;var n=a(r(70417)),i=a(r(19976)),s=a(r(54073)),o=a(r(47677)),u=a(r(12489)),l=r(8701),d=a(r(50935)),c=a(r(45090)),f=a(r(28267)),p=a(r(18120)),h=r(64658);function _(){var e=(0,i.default)(["Unexpected scrollChatToBottom error: ",""]);return _=function(){return e},e}function m(){var e=(0,i.default)(["Unexpected scrollToFocusedMsg error: ",""]);return m=function(){return e},e}function g(){var e=(0,i.default)(["Unexpected openChat error: ",""]);return g=function(){return e},e}function v(){var e=(0,i.default)(["Cmd: initialLoadReady"]);return v=function(){return e},e}function E(){var e=(0,i.default)(["Cmd: incrementProgress"]);return E=function(){return e},e}function y(){var e=(0,i.default)(["cmd:clearUIBusy uibusy timeout"]);return y=function(){return e},e}t.APP_STATE_SYNC_COMPLETED="app_state_sync_completed";class S extends f.default{constructor(...e){var t,r,a;super(...e),this.isMainLoaded=!1,this.uiBusy=0,this._clearUiBusy=(0,s.default)((()=>{this.uiBusy&&(__LOG__(2)(y()),this.uiBusy=0,this._triggerIdleEvent())}),1e3,{maxWait:5e3}),this._triggerIdleEvent=(t=()=>{(0,o.default)(0===this.uiBusy,"ui_idle triggered when uiBusy is ".concat(this.uiBusy)),0===this.uiBusy&&(this._clearUiBusy.cancel(),this.trigger("ui_idle"))},(a=()=>{if(!r){r=new u.default;var{signal:e}=r;(0,c.default)({signal:e}).then((()=>{e.aborted||(r=null,t())}),(e=>{if(e.name!==l.ABORT_ERROR)throw e}))}}).cancel=()=>{r&&(r.abort(),r=null)},a)}mainLoaded(){this.isMainLoaded=!0,this.trigger("main_loaded")}incrementProgress(){__LOG__(2)(E()),this.trigger("increment_progress")}initialLoadReady(){__LOG__(2)(v()),this.trigger("initial_load_ready")}logSocketSummary(){this.trigger("log_socket_summary")}muteAll(e,t){this.trigger("mute_all",e,t)}muteChat(e,t){this.trigger("mute_chat",(0,h.unproxy)(e),t)}muteChats(e,t,r){var a=e.map((e=>(0,h.unproxy)(e)));this.trigger("mute_chats",a,t,r)}deleteOrExitChat(e,t){this.trigger("delete_or_exit_chat",(0,h.unproxy)(e),t)}clearChat(e,t){this.trigger("clear_chat",(0,h.unproxy)(e),t)}archiveChat(e,t){this.trigger("archive_chat",(0,h.unproxy)(e),t)}pinChat(e,t){this.trigger("pin_chat",(0,h.unproxy)(e),t)}pinChats(e,t){var r=e.map((e=>(0,h.unproxy)(e)));this.trigger("pin_chats",r,t)}markChatUnread(e,t){this.trigger("mark_chat_unread",(0,h.unproxy)(e),t)}msgInfoDrawer(e){this.trigger("msg_info_drawer",(0,h.unproxy)(e))}chatSearch(e){this.trigger("chat_search",(0,h.unproxy)(e))}chatInfoDrawer(e,t){this.trigger("chat_info_drawer",(0,h.unproxy)(e),t)}attachMediaDrawer(e){var t=(0,n.default)((0,n.default)({},e),{},{chat:(0,h.unproxy)(e.chat)});this.trigger("attach_media_drawer",t)}attachProduct(e){this.trigger("attach_product",e)}verificationDrawer(e){this.trigger("verification_drawer",e)}liveLocationDrawer(e,t){this.trigger("live_location_drawer",e,t)}expiredLocationDrawer(e){this.trigger("expired_location_drawer",e)}mediaViewerModal(e){var{msg:t,getZoomNode:r,currentTime:a,highlightedMsgIds:n}=e;this.trigger("media_viewer_modal",{msg:t,getZoomNode:r,currentTime:a,highlightedMsgIds:n})}openMediaViewerForAlbumMedia(e){this.trigger("open_media_viewer_for_album_media",e)}productImageViewerModal(e,t){this.trigger("product_image_viewer_modal",e,t)}ephemeralDrawer(e){this.trigger("ephemeral_drawer",e)}sendStarMsgs(e,t,r,a){this.trigger("send_star_msgs",(0,h.unproxy)(e),t,r,a)}sendUnstarMsgs(e,t,r,a){this.trigger("send_unstar_msgs",(0,h.unproxy)(e),t,r,a)}sendDeleteMsgs(e,t,r,a,n){this.trigger("send_delete_msgs",(0,h.unproxy)(e),t,r,a,n)}sendRevokeMsgs(e,t,r,a,n){this.trigger("send_revoke_msgs",(0,h.unproxy)(e),t,r,a,n)}_openChat(e,t){var r=(0,h.unproxy)(e);return new Promise((e=>{this.trigger("open_chat",r,t,e)})).addCancelControl().catch((e=>{throw __LOG__(2)(g(),String(e)),e}))}openChatAt(e,t){var r=(0,h.unproxy)(e);if(!t)return this.openChatBottom(r);this.setUiBusy(!0,"open_chat_at");var a=this._openChat(r,t).then((e=>{var t,r;if(e)if(e.wasVisible)t=()=>this._scrollToFocusedMsg({pos:"offset",offset:e.offset}),r=()=>this._scrollToFocusedMsg({pos:"center",animate:!0,duration:d.default.MSG_FOCUS_SCROLL_ANIMATION_DURATION,easing:[.7,0,.3,1]});else switch(t=()=>this._scrollToFocusedMsg({pos:e.alignAt}),e.alignAt){case"top":case"bottom":r=()=>this._scrollToFocusedMsg({pos:"center",animate:!0,duration:d.default.MSG_FOCUS_SCROLL_ANIMATION_DURATION,easing:[.88,.64,.13,.99]});break;case"center":default:r=()=>Promise.resolve()}else t=()=>this._scrollToFocusedMsg({pos:"center"}),r=()=>Promise.resolve();return t().then(r)})).then((()=>{this.flashFocusedMsg()})).then((()=>!0)).catchType(Promise.CancellationError,(()=>!1));return a.finally((()=>{this.setUiBusy(!1,"open_chat_at")})),a}openChatFromUnread(e){var t,r=(0,h.unproxy)(e);if(r.unreadMsgAnchor&&(t={collection:r.unreadMsgAnchor.msgChunk,promise:Promise.resolve(),msg:r.unreadMsgAnchor,isUnreadDivider:r.shouldShowUnreadDivider}),t||r.unreadCount>0){this.setUiBusy(!0,"open_from_unread");var a=this._openChat(r,t).then((()=>this._scrollToFocusedMsg({pos:"top",offset:-120}))).then((()=>!0)).catchType(Promise.CancellationError,(()=>!1));return a.finally((()=>{this.setUiBusy(!1,"open_from_unread")})),a}return this.openChatBottom(r)}openChatBottom(e){var t,r=(0,h.unproxy)(e);this.setUiBusy(!0,"open_bottom"),r.msgs.length>0&&(t={collection:r.msgs,msg:r.msgs.last(),isUnreadDivider:!1});var a=this._openChat(r,t).then((()=>this._scrollChatToBottom())).then((()=>!0)).catchType(Promise.CancellationError,(()=>!1));return a.finally((()=>{this.setUiBusy(!1,"open_bottom")})),a}scrollToPtt(e){var t=(0,h.unproxy)(e.chat),r={collection:e.chat.msgs,msg:e,key:e.id,highlightMsg:!1};this.setUiBusy(!0,"open_chat_at");var a=this._openChat(t,r).then((()=>this._scrollToFocusedMsg({pos:"center",animate:!0,duration:d.default.MSG_FOCUS_SCROLL_ANIMATION_DURATION,easing:[.7,0,.3,1]}))).then((()=>!0)).catchType(Promise.CancellationError,(()=>!1));return a.finally((()=>{this.setUiBusy(!1,"open_chat_at")})),a}_scrollToFocusedMsg(e){return new Promise((t=>{this.trigger("scroll_to_focused_msg",t,e)})).catch((e=>{__LOG__(3)(m(),String(e))}))}_scrollChatToBottom(){return new Promise((e=>{this.trigger("scroll_chat_to_bottom",e)})).catch((e=>{__LOG__(3)(_(),String(e))}))}flashFocusedMsg(){setTimeout((()=>{this.trigger("flash_focused_msg")}),0)}updateChatlistSelection(e){var t=(0,h.unproxy)(e);this.trigger("update_chatlist_selection",t)}closeChat(e){var t=(0,h.unproxy)(e);this.trigger("close_chat",t)}focusChatTextInput(e){var t=(0,h.unproxy)(e);t?this.trigger("focus_chat_text_input_"+t.id.toString()):this.trigger("focus_chat_text_input")}setChatCtwaContextLinkData(e,t){this.trigger("chat_set_ctwa_context_link_data_"+e.id.toString(),t)}focusShowMsg(e){this.trigger("focus_show_msg",e)}enterChatTextInput(e){var t=(0,h.unproxy)(e);this.trigger("enter_chat_text_input_"+t.id.toString())}focusNextChat(e){this.trigger("focus_next_chat",e)}focusPrevChat(e){this.trigger("focus_prev_chat",e)}focusChatList(){this.trigger("focus_chat_list")}focusChatSearch(){this.trigger("focus_chat_search")}pasteChatTextInput(e,t){var r=(0,h.unproxy)(e);this.trigger("paste_chat_text_input_"+r.id.toString(),t)}startGroupCall(e,t){var r=(0,h.unproxy)(e);this.trigger("voip_start_group_call",r,t)}closeStatusViewer(){this.trigger("close_status_viewer")}sendPasteToCompose(e,t){var r=(0,h.unproxy)(e);this.trigger("send_paste_to_compose_"+r.id.toString(),t)}login(e){this.trigger("login",e)}logout(){var e=p.default.supportsFeature(p.default.F.MD_BACKEND);p.default.resetFeatures(),p.default.setFeature(p.default.F.MD_BACKEND,e),p.default.setFeature(p.default.F.MD_ADV,e),p.default.setFeature(p.default.F.MD_VOIP_GROUP,e&&!1),this.trigger("logout")}openContextMenu(e,t){this.trigger("open_context_menu",e,t)}closeContextMenu(e){this.trigger("close_context_menu",e)}openTooltip(e,t){this.trigger("open_tooltip",e,t)}closeTooltip(e){this.trigger("close_tooltip",e)}openToast(e){this.trigger("open_toast",e)}closeToast(e){this.trigger("close_toast",e)}alertNewMsg(e){this.trigger("alert_new_msg",e)}newMediaMsg(e){this.trigger("new_media_msg",e)}alertCall(e,t,r,a){this.trigger("alert_call",e,t,r,a)}cancelCall(e){this.trigger("cancel_call",e)}windowError(){}cannotReachPhone(){}sentPing(){}openModal(e,t){this.trigger("open_modal",e,t)}closeModal(e){this.trigger("close_modal",e)}openModalMedia(e,t){this.trigger("open_media",e,t)}closeModalMedia(){this.trigger("close_media")}openDrawerRight(e,t,r){this.trigger("open_drawer_right",e,t,r)}openDrawerMid(e,t,r,a){this.trigger("open_drawer_mid",e,t,r,a)}openDrawerLeft(e,t,r){this.trigger("open_drawer_left",e,t,r)}existsDrawerRight(e){this.trigger("exists_drawer_right",e)}existsDrawerMid(e){this.trigger("exists_drawer_mid",e)}existsDrawerLeft(e){this.trigger("exists_drawer_left",e)}closeDrawerRight(){this.trigger("close_drawer_right")}closeDrawerMid(){this.trigger("close_drawer_mid")}closeDrawerLeft(){this.trigger("close_drawer_left")}onPanesWillChange(e){this.trigger("panes_will_change",e)}onPanesDidChange(e){this.trigger("panes_did_change",e)}openGroupInviteModal(e){this.trigger("open_group_invite_modal",e)}openGroupV4InviteRequestFlow(e,t,r,a){this.trigger("open_group_v4_invite_request_flow",e,t,r,a)}mediaPlaying(e){this.trigger("mediaPlaying",e)}pttRecording(){this.trigger("pttRecording")}pttPlaying(e){this.trigger("pttPlaying",e)}uiResize(){this.trigger("resize")}setUiBusy(e){var t=this.uiBusy||0;e?(++t,this._clearUiBusy(),this._triggerIdleEvent.cancel()):t&&--t,this.uiBusy=t,0===t&&(this._clearUiBusy.cancel(),this._triggerIdleEvent())}windowMouseDown(e){this.trigger("window_mousedown",e)}windowClick(e){this.trigger("window_click",e)}midnight(){this.trigger("midnight")}textsizeChange(e){this.trigger("textsize_change",e)}scrollMessages(){this.trigger("scroll_messages")}getConversationHeaderOffset(e){this.trigger("get_conversation_header_offset",e)}floaterEscapeOverlap(e,t){this.trigger("floater_escape_overlap",e,t)}autoplayPTT(e){this.trigger("sequential_playback_ptt",e)}refreshMessages(){this.trigger("refresh_messages")}serverPropsUpdated(){this.trigger("server_props_updated")}storageInitializationError(){this.trigger("storage_initialization_error")}restartBackend(){this.trigger("md_restart_backend")}downgradeWebclient(){this.trigger("md_downgrade_webclient")}upgradeToMDInternal(){this.trigger("upgrade_to_md")}upgradeToMDProd(){this.trigger("upgrade_to_md_prod")}refreshQR(){this.trigger("md_refresh_qr")}setSocketState(e){this.trigger("set_socket_state",e)}socketStreamDisconnected(){this.trigger("socket_stream_disconnected")}openSocketStream(){this.trigger("open_socket_stream")}readyForMainStreamMode(){this.trigger("main_stream_mode_ready")}onInitialChatHistorySynced(){this.trigger("on_initial_chat_synced")}onRecentChatHistorySynced(){this.trigger("on_recent_chat_history_synced")}onFullChatHistorySynced(){this.trigger("on_full_chat_history_synced")}onOfflineProgressUpdate(){this.trigger("offline_progress_update")}criticalSyncDone(){this.trigger("on_critical_sync_done")}onTemporaryBan(e){this.trigger("account_temporarily_banned",e)}onStartingLogout(){this.trigger("starting_logout")}handleFatalError(){this.trigger("handle_fatal_error")}}t.Cmd=S;var T=new S;t.default=T},93292:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.ContextMenuManager=t.Type=void 0;var i=n(r(70417)),s=a(r(2784)),o=n(r(79711)),u=a(r(14457)),l=n(r(20642)),d=n(r(75010)),c=n(r(5179)),f=n(r(74824)),p={MENU:"MENU",TOOLTIP:"TOOLTIP"};t.Type=p;var h={originX:0,originY:0,offsetX:0,offsetY:0,dirX:u.DirX.RIGHT,dirY:u.DirY.BOTTOM,type:u.MenuType.dropdown};class _ extends s.Component{constructor(...e){super(...e),this.state={},this._setRefMenuContainer=e=>{this._refMenuContainer=e},this._setRefDropdown=e=>{this._refDropdown=e},this.onClose=e=>{(!e||this.state.menu&&this.state.menu.uim===e)&&this.setState({menu:void 0})},this._onOpen=(e,t)=>{var{menu:r}=this.state;r&&r.uim&&r.uim.pop(),r=(0,i.default)((0,i.default)((0,i.default)({},h),e),{},{key:Math.random(),isTemporaryRender:!0}),e.event&&(r=(0,i.default)((0,i.default)({},r),{},{originX:e.event.clientX,originY:e.event.clientY,offsetX:null!=e.offsetX?e.offsetX:10,offsetY:null!=e.offsetY?e.offsetY:10}),e.event.stopPropagation()),this.setState({menu:r},(()=>{var e;t(null===(e=this._refMenuContainer)||void 0===e?void 0:e.getElement()),this._setDirection()}))},this.isOpen=()=>null!=this.state.menu}componentDidMount(){var e=this.props.type===p.MENU?"open_context_menu":"open_tooltip";this.props.listeners.add(o.default,e,this._onOpen);var t=this.props.type===p.MENU?"close_context_menu":"close_tooltip";this.props.listeners.add(o.default,t,this.onClose)}_setDirection(){if(this._refDropdown){var e=this._refDropdown.clientWidth,t=this._refDropdown.clientHeight+10,r=window.innerWidth,a=window.innerHeight;if(this.state.menu){var{anchor:n,originX:s,originY:o,offsetX:l,offsetY:d,dirX:c,dirY:f}=this.state.menu,p=s,h=s,_=o,m=o;if(n&&n instanceof HTMLElement){var g=n.getBoundingClientRect();p=g.left,h=g.right,m=g.bottom,_=g.top}var v=c;v===u.DirX.RIGHT&&p+e>r&&h-e>0?v=u.DirX.LEFT:v===u.DirX.LEFT&&h-e<0&&p+e<r&&(v=u.DirX.RIGHT);var E=f;E===u.DirY.BOTTOM&&m+t+d>a&&_-t>0?E=u.DirY.TOP:E===u.DirY.TOP&&_-t<0&&m+t+d<a&&(E=u.DirY.BOTTOM);var y,S=v===u.DirX.RIGHT?p:h;y=E===u.DirY.TOP?_:m;var T=l,b=d;n||(v===u.DirX.LEFT&&(T=0),E===u.DirY.TOP&&(b=0)),this.setState({menu:(0,i.default)((0,i.default)({},this.state.menu),{},{dirX:v,dirY:E,originX:S,originY:y,offsetX:T,offsetY:b,isTemporaryRender:!1})})}}}render(){var e,t="dropdown";if(this.state.menu){var{menu:r,key:a,originX:n,originY:i,offsetX:o,offsetY:l,dirX:p,dirY:h,type:_,autoFocus:m,findFirstItem:g,horizontal:v,isTemporaryRender:E,theme:y}=this.state.menu,S=Array.isArray(r)?r.map((e=>s.cloneElement(e,{theme:y}))):r;e=s.createElement(u.default,{origin:{x:n+o,y:i+l},onRef:this._setRefDropdown,type:_,key:"key-"+a,dirX:p,dirY:h,horizontal:v,autoFocus:m,findFirstItem:g,isTemporaryRender:E},s.createElement(d.default,{ref:this._setRefMenuContainer},S)),t="picker"===_?"dropdown-picker":"dropdown"}return s.createElement(c.default.Consumer,null,(r=>s.createElement(c.default.Provider,{value:this.state.menu&&this.state.menu.uim||r},s.createElement(f.default,{transitionName:t},e))))}}t.ContextMenuManager=_,_.displayName="ContextMenuManager";var m=(0,l.default)(_);t.default=m},76736:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.APP_TEXT_MIMETYPE=void 0;var n=a(r(2689)),i=a(r(11403)),s=r(69914),o=a(r(61846)),u=a(r(80965)),l=a(r(27428)),d=a(r(16929)),c=r(66615);t.APP_TEXT_MIMETYPE="application/whatsapp";class f{constructor(e){this._value=e||""}append(e,t=""){return this._value=[this.toString(),e].filter((e=>e)).join(t),this}prepend(e,t=""){return this._value=[e,this.toString()].filter((e=>e)).join(t),this}toString(){return this._value}}class p{static fromEl(e,t=(0,s.isCopyable)(e)){var r=t?(0,s.getAppTextTemplateData)(e):null;return new p("",r)}static getTemplate(e){var t=e;if(!t)return null;if(!(t instanceof HTMLElement)){if(!t.parentElement)return null;t=t.parentElement}for(var r=new p("${appText}"),a=t,n=5,i=0,o=!1;a&&i<n;)a instanceof HTMLElement&&(0,s.isCopyable)(a)?(r=p.fromEl(a,!0).append(r.toString()),o=o||!r.isPlainText(),n=5):i++,a=a.parentElement;return o?r.toString():null}constructor(e="",t){this._innerAppText=new f(e),this._appTextTemplate=t}append(e,t=""){return this._innerAppText.append(e,t),this}prepend(e,t=""){return this._innerAppText.prepend(e,t),this}isPlainText(){return Boolean(!this._appTextTemplate&&""!==this._appTextTemplate)}toString(){return this._appTextTemplate||""===this._appTextTemplate?this._appTextTemplate.replace(/\$\{appText\}/g,this._innerAppText.toString()):this._innerAppText.toString()}}class h{constructor(e,t){var r=e||"";this._plainText=new f(r),t&&(this._appText=new p(r,t))}static _copyableChildrenToClipboard(e){var t=(0,s.findCopyableChildren)(e);return(0,i.default)(t,((e,t)=>e.prepend(this.fromEl(t),"\n")),new h)}static _pruneRangeNodes(e,t,r){for(var a=t.cloneContents().childNodes,n=(0,u.default)(t),i=[],s=[],o=0;o<a.length;o++){var l=a[o],d=n[o]&&n[o].parentElement;(r||(0,c.isSelectable)(n[o])||(0,c.hasSelectableChildren)(l))&&(e.contains(n[o])||d&&d.contains(e))&&(i.push(l),s.push(n[o]))}n=s;var f=r;if(1===(a=i).length){var p=a[0];(f=f||(0,c.isSelectable)(n[0]))||(a=(0,c.findSelectableChildren)(p,f),f=!1)}return{rangeNodes:a,parentIsSelectable:f}}static fromCopyableEl(e,t=!1){var r=(0,s.getPrePlainTextData)(e)||"",a=new h(r),n=(0,s.getPlainTextData)(e),o=(0,s.getAppTextTemplateData)(e),u=new h("",o);return n||""===n?(u.appendPlainText(n),a.append(u)):t||(0,c.isSelectable)(e)?((0,i.default)(e.childNodes,((e,t)=>{var r=(0,l.default)(t,"div")?"\n":"";return e.prepend(this.fromSelectableNode(t),r)}),u),a.append(u)):(u.append(this._copyableChildrenToClipboard(e)),a.append(u))}static fromEl(e,t=!1){return(0,s.isCopyable)(e)||t?this.fromCopyableEl(e,t):this._copyableChildrenToClipboard(e)}static fromNode(e,t){return e instanceof HTMLElement?this.fromEl(e,t):t?this.fromSelectableNode(e):new h}static fromRange(e,t){var r=t.commonAncestorContainer,a=p.getTemplate(r),n=new h("",a),s=(0,c.isSelectAll)(r)?r:(0,c.findSelectAllParent)(r);if(s instanceof HTMLElement)return n.append(this.fromCopyableEl(s));var{parentIsSelectable:o,rangeNodes:u}=this._pruneRangeNodes(e,t,(0,c.isSelectable)(r));return(0,i.default)(u,((e,t)=>{var r=o?"":"\n",a=this.fromNode(t,o);return e.prepend(a,r)}),n)}static fromSelectableNode(e){if((0,d.default)(e))return new h(e.textContent);if(!(e instanceof HTMLElement))return new h;var t=new h;return(0,o.default)(e,(e=>(0,d.default)(e)||(0,s.isCopyable)(e)?[]:Array.from(e.childNodes)),(e=>{var r;(0,s.isCopyable)(e)&&e instanceof HTMLElement?(r=this.fromCopyableEl(e,!0),t.append(r)):(0,d.default)(e)&&t.appendPlainText(e.textContent)})),t}static fromSelection(e,t){var r=new h;return(0,n.default)(t.rangeCount).map((r=>{var a=t.getRangeAt(r);return this.fromRange(e,a)})).reduce(((e,t)=>e.append(t,"\n")),r)}append(e,t=""){return e.hasAppText()?(this._appText=this._appText||new p(this.toPlainString()),this._appText.append(e.toAppString(),t)):this.hasAppText()&&this._appText.append(e.toAppString(),t),this._plainText.append(e.toPlainString(),t),this}appendPlainText(e,t=""){return this.append(new h(e)),this}prepend(e,t=""){return e.hasAppText()?(this._appText=this._appText||new p(this.toPlainString()),this._appText.prepend(e.toAppString(),t)):this.hasAppText()&&this._appText.prepend(e.toAppString(),t),this._plainText.prepend(e.toPlainString(),t),this}hasAppText(){return Boolean(this._appText)}toAppText(){return this.hasAppText()?this._appText:new p(this.toPlainString())}toPlainString(){return this._plainText.toString()}toAppString(){return this.hasAppText()?this._appText.toString():this.toPlainString()}}t.default=h},69914:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.isCopyable=function(e){return e instanceof HTMLElement&&(0,c.default)(e,h)},t.getPrePlainTextData=function(e){return e.dataset[v]},t.getPlainTextData=function(e){return e.dataset[m]},t.getAppTextTemplateData=function(e){return e.dataset[y]},t.findCopyableChildren=function(e){var t=Array.from(e.querySelectorAll(h));return t.filter((e=>!t.some((t=>t!==e&&t.contains(e)))))},t.CopyableCode=function(e){return l.createElement("code",b(e))},t.CopyableDel=function(e){return l.createElement("del",b(e))},t.CopyableDiv=function(e){return l.createElement("div",b(e))},t.CopyableEm=function(e){return l.createElement("em",b(e))},t.CopyableLink=function(e){var t=b(e),r=t.href;if(r&&!f.default.hasValidUrlScheme(r))return l.createElement("span",null);return l.createElement("a",t)},t.CopyableSpan=function(e){return l.createElement("span",b(e))},t.CopyableStrong=function(e){return l.createElement("strong",b(e))},t.CopyableUl=function(e){return l.createElement("ul",b(e))},t.default=t.CopyableImg=t.PLAIN_TEXT_DATA_ATTR=t.COPYABLE_CSS_SELECTOR=t.COPYABLE_CSS_CLASS=void 0;var i=n(r(70417)),s=n(r(58527)),o=n(r(22220)),u=n(r(72779)),l=a(r(2784)),d=n(r(77501)),c=n(r(61439)),f=n(r(74185)),p="copyable-text";t.COPYABLE_CSS_CLASS=p;var h=".".concat(p);t.COPYABLE_CSS_SELECTOR=h;var _="data-plain-text",m=(0,d.default)(_);t.PLAIN_TEXT_DATA_ATTR=m;var g="data-pre-plain-text",v=(0,d.default)(g),E="data-app-text-template",y=(0,d.default)(E);var S=l.forwardRef(((e,t)=>{var r,{forwardedRef:a}=e,n=b((0,o.default)(e,["forwardedRef"]));return l.createElement("img",(0,s.default)({ref:null!=a?a:t},n,{alt:null!==(r=n.alt)&&void 0!==r?r:""}))}));t.CopyableImg=S;var T=l.forwardRef((function(e,t){var{element:r}=e,a=(0,o.default)(e,["element"]);return l.createElement(r,(0,s.default)({},b(a),{ref:t}))}));function b(e){var{plainText:t,prePlainText:r,appTextTemplate:a}=e,n=(0,o.default)(e,["plainText","prePlainText","appTextTemplate"]),s=(0,i.default)({},n);return s.className=(0,u.default)(n.className,p),null!=t&&(s[_]=t),null!=r&&(s[g]=r),null!=a&&(s[E]=a),s}t.default=T},96955:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(r(58527)),s=n(r(70417)),o=n(r(22220)),u=n(r(72779)),l=a(r(2784)),d=a(r(76736)),c=n(r(69630)),f=l.forwardRef((function(e,t){var{canCut:r,children:a,className:n}=e,d=(0,o.default)(e,["canCut","children","className"]),f=(0,s.default)((0,s.default)({},d),{},{className:(0,u.default)(n,c.default.noop,"copyable-area"),onCopy:h,onCut:r?_:void 0});return l.createElement("div",(0,i.default)({},f,{ref:t}),a)}));function p(e){var t=e.currentTarget;if(!(t instanceof HTMLElement))return!1;var r=d.default.fromSelection(t,window.getSelection());e.clipboardData.setData("text/plain",r.toPlainString());try{e.clipboardData.setData(d.APP_TEXT_MIMETYPE,r.toAppString())}catch(e){}return!0}function h(e){p(e,window.getSelection())&&(e.stopPropagation(),e.preventDefault())}function _(e){var t=window.getSelection();p(e)&&(t.deleteFromDocument(),e.stopPropagation(),e.preventDefault(),e.target.dispatchEvent(new Event("input",{bubbles:!0,cancelable:!0})))}t.default=f},66615:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.createSelectableElement=function(e,t){var r=document.createElement(e);r.setAttribute("class",h),(t||""===t)&&(r.dataset[l.PLAIN_TEXT_DATA_ATTR]=t);return r},t.isSelectable=E,t.isSelectAll=y,t.findSelectableChildren=function(e,t){if(!(e instanceof HTMLElement))return[];if(t||E(e))return Array.from(e.childNodes);var r=Array.from(e.querySelectorAll(_));return r.filter((e=>!r.some((t=>t!==e&&t.contains(e)))))},t.hasSelectableChildren=function(e){if(!(e instanceof HTMLElement))return!1;return!!e.querySelector(_)},t.findSelectAllParent=function(e){if(!S(e))return null;var t,r=e,a=0;for(;r&&a<5;){if(y(r)&&r instanceof HTMLElement){t=r;break}r=r.parentElement,a++}return t},t.SelectableCode=function(e){var t=A(e);return e.selectable?u.createElement(l.CopyableCode,t):u.createElement("code",t)},t.SelectableDel=function(e){var t=A(e);return e.selectable?u.createElement(l.CopyableDel,t):u.createElement("del",t)},t.SelectableDiv=function(e){var t=A(e);return e.selectable?u.createElement(l.CopyableDiv,t):u.createElement("div",t)},t.SelectableEm=function(e){var t=A(e);return e.selectable?u.createElement(l.CopyableEm,t):u.createElement("em",t)},t.SelectableLink=function(e){var t=A(e),r=e.href;if(r&&!f.default.hasValidUrlScheme(r))return u.createElement("span",null);return e.selectable?u.createElement(l.CopyableLink,t):u.createElement("a",t)},t.SelectableSpan=function(e){var t=A(e);return e.selectable?u.createElement(l.CopyableSpan,t):u.createElement("span",t)},t.SelectableStrong=function(e){var t=A(e);return e.selectable?u.createElement(l.CopyableStrong,t):u.createElement("strong",t)},t.SelectableUl=function(e){var t=A(e);return e.selectable?u.createElement(l.CopyableUl,t):u.createElement("ul",t)},t.default=t.SelectableImg=t.SELECTABLE_INPUT_CSS_CLASS=t.SELECTABLE_CSS_SELECTOR=t.SELECTABLE_CSS_CLASS=void 0;var i=n(r(58527)),s=n(r(22220)),o=n(r(72779)),u=a(r(2784)),l=a(r(69914)),d=n(r(61439)),c=n(r(18464)),f=n(r(74185)),p="selectable-text";t.SELECTABLE_CSS_CLASS=p;var h="".concat(l.COPYABLE_CSS_CLASS," ").concat(p),_=".".concat(p);t.SELECTABLE_CSS_SELECTOR=_;var m=h;t.SELECTABLE_INPUT_CSS_CLASS=m;var g="select-all",v=".".concat(g);function E(e){return!!e&&(e instanceof HTMLElement?(0,d.default)(e,_)||(0,d.default)(e,"".concat(_," *")):E(e.parentElement))}function y(e){return!!e&&(e instanceof HTMLElement?(0,d.default)(e,v):y(e.parentElement))}function S(e){return!!e&&(e instanceof HTMLElement?(0,d.default)(e,"".concat(v," *")):S(e.parentElement))}var T=u.forwardRef(((e,t)=>{var r,{forwardedRef:a}=e,n=(0,s.default)(e,["forwardedRef"]),o=A(n);return n.selectable?u.createElement(l.CopyableImg,(0,i.default)({forwardedRef:t},o)):u.createElement("img",(0,i.default)({ref:t},o,{alt:null!==(r=n.alt)&&void 0!==r?r:""}))}));t.SelectableImg=T;var b=u.forwardRef((function(e,t){var{element:r}=e,a=(0,s.default)(e,["element"]),n=A(a);return a.selectable?u.createElement(l.default,(0,i.default)({element:r},n,{ref:t})):u.createElement(r,(0,i.default)({},n,{ref:t}))}));function A(e){var{className:t,plainText:r,prePlainText:a,appTextTemplate:n,selectable:i,selectAll:u}=e,l=(0,s.default)(e,["className","plainText","prePlainText","appTextTemplate","selectable","selectAll"]);return i&&(l.plainText=r,l.prePlainText=a,l.appTextTemplate=n),l.className=(0,o.default)(t,c.default.noop,{[p]:i,[g]:i&&u}),l}t.default=b},14457:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.DirY=t.DirX=t.MenuType=t.EMOJI_PICKER_WIDTH=void 0;var i=n(r(98537)),s=n(r(72779)),o=a(r(2784)),u=n(r(79711)),l=n(r(74489)),d=n(r(12461)),c=n(r(38147)),f=n(r(6660)),p=n(r(98294)),h=n(r(44343)),_=n(r(17957)),m=n(r(61941)),g=parseInt(d.default["-emoji-picker-width"].replace(/px$/,""),10);t.EMOJI_PICKER_WIDTH=g;t.MenuType={dropdown:"dropdown",dropdown_menu:"dropdown_menu",dropdown_text:"dropdown_text",menu:"menu",picker:"picker",emoji_picker:"emoji_picker",sticker_picker:"sticker_picker",color_picker:"color_picker",tooltip:"tooltip"};var v={RIGHT:"RIGHT",LEFT:"LEFT"};t.DirX=v;var E={TOP:"TOP",BOTTOM:"BOTTOM"};t.DirY=E;class y extends o.Component{constructor(...e){super(...e),this.state={showShortcuts:!1,keyboard:!1,selected:null},this._setRefDropdown=e=>{this._refDropdown=e,this.props.onRef&&this.props.onRef(e)},this._setRefList=e=>{this._refList=e},this._floaterEscapeOverlap=()=>{this._refList&&this._refDropdown&&!this.props.isTemporaryRender&&u.default.floaterEscapeOverlap(this._refDropdown,10)},this.onMouseMove=()=>{f.default.focus(this._refDropdown),this.setState({keyboard:!1})},this._selectPrevious=e=>{S(e);var{activeChildren:t,currentlyFocusedIndex:r}=this._getActiveChildren();0!==t.length&&this._focusNewActiveChild(t,r-1)},this.selectNext=e=>{S(e);var{activeChildren:t,currentlyFocusedIndex:r}=this._getActiveChildren();0!==t.length&&this._focusNewActiveChild(t,r+1)},this._getActiveChildren=()=>{var e=[...(0,m.default)(this._refList,"this._refList").querySelectorAll("li:not(.dropdown-item-disabled)")];return{activeChildren:e,currentlyFocusedIndex:e.indexOf(this.state.selected)}},this._focusNewActiveChild=(e,t)=>{var r=(t<0?e.length-1:t)%e.length;f.default.focus(e[r]),this.setState({keyboard:!0,selected:e[r]})},this.close=e=>{e.preventDefault();var{uim:t}=this.props;t&&t.uie.requestDismiss()},this.default=e=>{var t=this.props.onDefault;if(t){c.default.shouldIndicateFocus();var{uim:r}=this.props;r&&r.uie.requestDismiss(),t(e)}},this._resetSelected=e=>{e.stopPropagation(),f.default.focus(this._refDropdown),this.setState({selected:void 0})}}getElement(){return this._refDropdown}_allowKeyboard(){var e=this.props.type;return"emoji_picker"!==e&&"sticker_picker"!==e&&"color_picker"!==e&&"dropdown_text"!==e}componentDidMount(){if(this._floaterEscapeOverlap(),this._allowKeyboard()){var{autoFocus:e,children:t,findFirstItem:r}=this.props;if(e){var a,n,i=null===(a=this._refList)||void 0===a?void 0:a.querySelector("[tabindex]");r&&i||this._refList&&this._refList.firstChild instanceof HTMLDivElement&&i?n=i:this._refList&&this._refList.children.length>0?n=this._refList.children[0]:null!=t&&(n=o.Children.toArray(t)[0]),f.default.focus(n),this.setState({keyboard:!0,selected:n})}else f.default.focus(this._refDropdown)}}componentDidUpdate(e){e.isTemporaryRender&&!this.props.isTemporaryRender&&this._floaterEscapeOverlap()}getStyle(){var e=this.props,t={},r=e.flipOnRTL&&_.default.isRTL()?e.dirX===v.LEFT?v.RIGHT:v.LEFT:e.dirX,a=e.dirY,n=r===v.RIGHT?v.LEFT:v.RIGHT,s=a===E.TOP?E.BOTTOM:E.TOP;if(t[l.default.prefix("transformOrigin")]=s+" "+n,!e.origin)return(0,i.default)(t,e.style);if(r===v.RIGHT?t.left=e.origin.x:t.right=window.innerWidth-e.origin.x,a===E.BOTTOM){var o;t.top=e.origin.y;var u=null===(o=this._refDropdown)||void 0===o?void 0:o.offsetHeight;if(null!=u){var d=window.innerHeight-u-32;t.top=Math.min(d,(0,m.default)(e.origin,"p.origin").y)}}else t.bottom=window.innerHeight-e.origin.y;return(0,i.default)(t,e.style)}render(){var e=this.props,t=e.type,r=(0,s.default)({[d.default.container]:"dropdown"===t||"dropdown_menu"===t||"emoji_picker"===t||"sticker_picker"===t||"color_picker"===t||"dropdown_text"===t,[d.default.right]:"dropdown_menu"===t,[d.default.icons]:"menu"===t,[d.default.picker]:"picker"===t,[d.default.emoji]:"emoji_picker"===t,[d.default.sticker]:"sticker_picker"===t,[d.default.colorPicker]:"color_picker"===t,[d.default.text]:"dropdown_text"===t,[d.default.tooltip]:"tooltip"===t,[d.default.inverse]:("picker"===t||"emoji_picker"===t||"sticker_picker"===t||"color_picker"===t||"dropdown_text"===t||"tooltip"===t)&&e.dirX===v.LEFT,[d.default.inverseVertical]:("emoji_picker"===t||"sticker_picker"===t||"color_picker"===t||"dropdown_text"===t)&&e.dirY===E.TOP}),a="picker"===t||"emoji_picker"===t||"sticker_picker"===t||"dropdown_text"===t||"tooltip"===t?o.createElement("div",{className:d.default.nib,"data-animate-dropdown-nib":!0}):null;if(this._allowKeyboard()){var n={enter:this.default,tab:S,"shift+tab":S,up:()=>{},down:()=>{}};return e.horizontal?(n[_.default.LR("left","right")]=this._selectPrevious,n[_.default.LR("right","left")]=this.selectNext,n[_.default.LR("up","down")]=this._selectPrevious,n[_.default.LR("down","up")]=this.selectNext):(n.up=this._selectPrevious,n.down=this.selectNext,n[_.default.LR("left","right")]=this.close,n[_.default.LR("right","left")]=this.default),o.createElement(h.default,{onRef:this._setRefDropdown,handlers:n,className:r,style:this.getStyle(),onMouseMove:this.state.keyboard?this.onMouseMove:null,onMouseUp:this._resetSelected},o.createElement("ul",{ref:this._setRefList,className:d.default.items},e.children),a)}return o.createElement("div",{ref:this._setRefDropdown,className:r,style:this.getStyle()},e.children,a)}}function S(e){e.stopPropagation(),e.preventDefault()}y.defaultProps={type:"dropdown",dirX:v.RIGHT,dirY:E.BOTTOM},y.displayName="Dropdown";var T=(0,p.default)(y);t.default=T},35387:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.openExternalLink=function(e){if(!d.default.hasValidUrlScheme(e))return void(e.toLowerCase().startsWith("javascript:")&&(__LOG__(4,void 0,new Error,!0)(c(),e),SEND_LOGS("URL error")));var t=document.createElement("a");t.href=e,t.target="_blank",t.rel="noopener noreferrer",t.style.display="none",document&&document.body&&document.body.appendChild(t);t.click(),document&&document.body&&document.body.removeChild(t)},t.default=void 0;var i=n(r(19976)),s=a(r(2784)),o=n(r(50935)),u=(n(r(4141)),n(r(72509))),l=r(86145),d=n(r(74185));function c(){var e=(0,i.default)(["Bad url: ",""]);return c=function(){return e},e}function f(){var e=(0,i.default)(["Bad url: ",""]);return f=function(){return e},e}class p extends s.PureComponent{constructor(...e){super(...e),this._elRef=s.createRef(),this._onKeyDown=e=>{var t;(0,u.default)(e)&&(null===(t=this._elRef.current)||void 0===t||t.click())}}render(){var{children:e,className:t,href:r,isLongTemplateUrl:a,onClick:n}=this.props;return d.default.hasValidUrlScheme(r)?a?s.createElement("a",{ref:this._elRef,rel:"noopener noreferrer",className:t,href:r,target:"_blank",onClick:n,onKeyDown:this._onKeyDown},(0,l.substring)(r,0,o.default.TEMPLATE_URL_START),s.createElement("span",null,""),(0,l.substring)(r,r.length-o.default.TEMPLATE_URL_END,r.length)):s.createElement("a",{ref:this._elRef,rel:"noopener noreferrer",className:t,href:r,target:"_blank",onClick:n,onKeyDown:this._onKeyDown},e):(r.toLowerCase().startsWith("javascript:")&&(__LOG__(4,void 0,new Error,!0)(f(),r),SEND_LOGS("URL error")),s.createElement("a",null))}}t.default=p,p.displayName="ExternalLink"},90776:(e,t,r)=>{"use strict";var a=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.DefaultFavicon=s,t.ErrorFavicon=o;var n=a(r(2784)),i=r(53274);function s({children:e}){return n.useEffect((()=>{(0,i.setTitleAndIcon)(0)}),[]),e}function o({children:e}){return n.useEffect((()=>{(0,i.setTitleAndIcon)(-1)}),[]),e}s.displayName="DefaultFavicon",o.displayName="ErrorFavicon"},90973:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"FlexItem",{enumerable:!0,get:function(){return l.FlexItem}}),t.FlexColumn=t.FlexRow=t.FlexContainer=void 0;var i=n(r(58527)),s=n(r(72779)),o=a(r(2784)),u=n(r(62018)),l=r(25505),d=o.forwardRef((function(e,t){var{align:r="start",as:a="div",direction:n,justify:i="start",wrap:l="nowrap",children:d,className:c,style:f}=e;return o.createElement(a,{className:(0,s.default)({[u.default.flex]:!0,[u.default.justifyStart]:"start"===i,[u.default.justifyCenter]:"center"===i,[u.default.justifyEnd]:"end"===i,[u.default.justifyAll]:"all"===i,[u.default.justifyAround]:"around"===i,[u.default.justifyEvenly]:"evenly"===i,[u.default.directionVertical]:"vertical"===n,[u.default.directionHorizontal]:"horizontal"===n,[u.default.directionVerticalReverse]:"vertical-reverse"===n,[u.default.directionHorizontalReverse]:"horizontal-reverse"===n,[u.default.alignStart]:"start"===r,[u.default.alignCenter]:"center"===r,[u.default.alignEnd]:"end"===r,[u.default.alignStretch]:"stretch"===r,[u.default.alignBaseline]:"baseline"===r,[u.default.wrap]:"wrap"===l,[u.default.wrapReverse]:"wrap-reverse"===l},c),ref:t,style:f},d)}));t.FlexContainer=d,d.displayName="FlexContainer";var c=o.forwardRef((function(e,t){return o.createElement(d,(0,i.default)({},e,{direction:"horizontal",ref:t}),e.children)}));t.FlexRow=c,c.displayName="FlexRow";var f=o.forwardRef((function(e,t){return o.createElement(d,(0,i.default)({},e,{direction:"vertical",ref:t}),e.children)}));t.FlexColumn=f,f.displayName="FlexColumn"},25505:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.FlexItem=void 0;var i=n(r(70417)),s=n(r(72779)),o=a(r(2784)),u=n(r(91200)),l=n(r(9435)),d=o.forwardRef((function(e,t){var{a8nText:r,align:a="auto",as:n="div",basis:d,className:c,children:f,order:p,grow:h,shrink:_,style:m}=e,g={flexBasis:"string"==typeof d||null==d?d:"".concat(d,"px"),flexGrow:h,flexShrink:_,order:p};return o.createElement(n,{className:(0,s.default)({[l.default.flexItem]:!0,[l.default.alignAuto]:"auto"===a,[l.default.alignStart]:"start"===a,[l.default.alignCenter]:"center"===a,[l.default.alignEnd]:"end"===a,[l.default.alignStretch]:"stretch"===a},c),"data-a8n":r,ref:t,style:(0,i.default)((0,i.default)({},m),(0,u.default)(g))},f)}));t.FlexItem=d,d.displayName="FlexItem"},71203:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){var[e,t]=(0,a.useState)(!1),r=(0,i.useFocusVisibility)();return[(0,n.useFocus)({onFocusChange:t}),e&&r]};var a=r(2784),n=r(44794),i=r(36895)},69731:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){var e=(0,a.useRef)(!1);return(0,a.useEffect)((()=>(e.current=!0,()=>{e.current=!1})),[]),(0,a.useCallback)((()=>e.current),[])};var a=r(2784)},93081:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.useListener=function(e,t,r,a){var i=(0,n.useRef)(r),o=(0,n.useRef)(null);return(0,n.useEffect)((()=>{i.current=r}),[r]),(0,n.useEffect)((()=>s(o,e,t,((...e)=>{var t;null===(t=i.current)||void 0===t||t.call(i,...e)}),a)),[e,t]),()=>{var e;null===(e=o.current)||void 0===e||e.disengage()}},t.useListenerRef=function(e,t,r,a){var i=(0,n.useRef)(r),o=(0,n.useRef)(null);return(0,n.useEffect)((()=>{i.current=r}),[r]),(0,n.useEffect)((()=>{var r=e.current;if(null!=r)return s(o,r,t,((...e)=>{var t;null===(t=i.current)||void 0===t||t.call(i,...e)}),a)}),[e,t]),()=>{var e;null===(e=o.current)||void 0===e||e.disengage()}};var n=r(2784),i=a(r(28148));function s(e,t,r,a,n){if(null==t)return e.current=null,()=>{};var s=new i.default(t,r,a,n);return s.engage(),e.current=s,()=>{s.disengage(),e.current=null}}},14578:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(...e){return(0,i.useMemo)((function(){return t=>{for(var r of e)null!=r&&("function"!=typeof r?"object"!=typeof r?(__LOG__(4,void 0,new Error,!0)(s()),SEND_LOGS("react-bad-ref")):r.current=t:r(t))}}),[...e])};var n=a(r(19976)),i=r(2784);function s(){var e=(0,n.default)(["mergeRefs cannot handle refs that are not a function or a react ref"]);return s=function(){return e},e}},72376:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var r,a=(0,n.useRef)(),o=!0===(null==t?void 0:t.disabled),u=o?s:e;return[e=>{a.current=e},{"aria-disabled":null!==(r=null==t?void 0:t.disabled)&&void 0!==r?r:void 0,onClick:u,onKeyPress:function(e){var t;(0,i.default)(e)&&(e.stopPropagation(),e.preventDefault(),null===(t=a.current)||void 0===t||t.click())},role:"button",tabIndex:o?-1:0}]};var n=r(2784),i=a(r(72509));function s(){}},53632:(e,t,r)=>{"use strict";var a=r(14859),n=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.Component=void 0;var i=n(r(2784)),s=a(r(50935)),o=n(r(96452)),u=a(r(72259)),l=a(r(25676)),d=a(r(35307)),c=r(66615),f=a(r(74185)),p=new d.default;class h extends i.Component{static getDerivedStateFromProps(e,t){return e.src!==t.src?{src:e.src,available:!0}:null}constructor(e){super(e),this._refNative=i.createRef(),this.getElement=()=>this._refNative.current,this.onLoad=e=>{var{target:t}=e;if(t instanceof HTMLImageElement){var r=this.getImgElement();r&&r.complete&&this._showImgElement(r),this.props.onLoad&&this.props.onLoad({target:t}),this.setState({loading:!1})}},this.onError=e=>{this.setState({available:!1});var{src:t,crossOrigin:r,noXHR:a,hasPrivacyChecks:n}=this.props;if(t&&function(e){return"/"===e[0]||f.default.isHttp(e)}(t)){var i,s=this.retry;if(s)if(_(s,this.props)){if(!s.noXHR)return;i=s}else{s.release()&&p.remove(s),i=new l.default(t,r,a,n)}else i=new l.default(t,r,a,n);this.retry=i,p.enqueue(i).checkpoint(this.props.rejectOnUnmount()).then((()=>{i===this.retry&&this.setState({available:!0})})).catchTypes(o.ServerStatusError,o.GaveUpRetry,(e=>{i===this.retry&&(this.props.rejectOnUnmount().isRejected()||(this.setState({available:!1,error:e}),this.props.onError&&this.props.onError(e)))})).catchTypes(o.Unmount,Promise.CancellationError,(()=>{}))}else this.setState({error:e.error})},this.onContextMenu=e=>{this.props.disableContextMenu&&e.preventDefault()},this.state={src:e.src,available:!0,error:null,loading:!0}}componentDidMount(){if(this.props.src){var e=this.getImgElement();e&&!e.complete&&this._hideImgElement(e)}}componentDidUpdate(e){if(_(e,this.props)||this._cancelRetry(),this.props.src){var t=this.getImgElement();t&&!t.complete&&this._hideImgElement(t)}}componentWillUnmount(){this._cancelRetry()}_cancelRetry(){if(this.retry){var e=this.retry;e.release()&&p.remove(e)}}getImgElement(){return this._refNative.current}_showImgElement(e){"visible"!==e.style.visibility&&(e.style.visibility="visible")}_hideImgElement(e){"hidden"!==e.style.visibility&&(e.style.visibility="hidden")}render(){var{alt:e,className:t,crossOrigin:r,draggable:a,onClick:n,onMouseMove:o,plainText:u,selectable:l,src:d,style:f,renderLoading:p,renderError:h}=this.props,{available:_,error:m,loading:g}=this.state;if(m&&h)return h(m);var v=Boolean(_&&d);return i.createElement(i.Fragment,null,i.createElement(c.SelectableImg,{ref:this._refNative,plainText:u||"",selectable:Boolean(l),crossOrigin:r?"anonymous":void 0,onError:v?this.onError:()=>{},onLoad:v?this.onLoad:()=>{},src:v&&null!=d?d:s.default.ONE_BY_ONE_TRANS_GIF,alt:e,className:t,draggable:a,onClick:n,onMouseMove:o,style:f,onContextMenu:this.onContextMenu}),g&&p&&p())}}function _(e,t){return e.src===t.src&&e.crossOrigin===t.crossOrigin&&e.noXHR===t.noXHR&&e.hasPrivacyChecks===t.hasPrivacyChecks}h.defaultProps={crossOrigin:!0,noXHR:!1,hasPrivacyChecks:!0},h.displayName="Img";var m=h;t.Component=m;var g=(0,u.default)(h);t.default=g},25676:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(r(19976)),s=a(r(96452)),o=n(r(40210)),u=n(r(69835));function l(){var e=(0,i.default)(["Img:Retry "," failed with error code ",". Not retrying."]);return l=function(){return e},e}function d(){var e=(0,i.default)(["Img:Retry "," failed with error code ",". Retrying."]);return d=function(){return e},e}t.default=class{constructor(e,t,r,a){this.src=e,this.crossOrigin=t,this.noXHR=r,this.hasPrivacyChecks=a,this.generation=0,this.refCount=0,this.inProgress=!1}key(){var e=this.crossOrigin?"Y":"N",t=this.noXHR?"Y":"N";return"co:".concat(e,",noXHR:").concat(t,",src:").concat(this.src)}sendXHR(){if(this.noXHR)return Promise.resolve(!0);var e=this.src;return this.inProgress=!0,this._xhrPromise=u.default.get(e).timeout(3e4,"ImgRetryTimeout"),this._xhrPromise.then((t=>{var{status:r}=t;if(r>=200&&r<400)return!0;if(r>=500)return __LOG__(2)(d(),e,r),new o.default.WebcImgError({webcImgErrorCode:r}).commit(),!1;throw __LOG__(2)(l(),e,r),new o.default.WebcImgError({webcImgErrorCode:r}).commit(),new s.ServerStatusError(null,e,r)})).catch((e=>{if(e instanceof s.ServerStatusError)throw e;return!1})).finally((()=>{this.inProgress=!1}))}release(){return this.refCount--,this.refCount<=0&&(this._xhrPromise&&this._xhrPromise.cancel(),!0)}shouldRetain(){return this.refCount>0}}},35307:(e,t,r)=>{"use strict";var a=r(14859),n=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(r(96452)),s=a(r(12489)),o=r(78986),u=a(r(99911)),l=n(r(82885)),d=a(r(61941));class c{constructor(){this._queue=new Map,this._inDelay=new Map,this._numInProgress=0}static maxInProgressRetry(){return 20}enqueue(e){var t=this._queue.get(e.key());if(t){if(e.hasPrivacyChecks!==t.hasPrivacyChecks){var r="Img:hasPrivacyChecks shouldn't change ".concat(e.key());return Promise.reject(r)}return t.refCount++,t.promise}return e.promise=new Promise(((t,r)=>{e.resolve=t,e.reject=r})),e.refCount++,this._addToQueue(e),e.promise}remove(e){var t=e.key();this._queue.delete(t);var r=this._inDelay.get(t);r&&(r.cancel(),this._inDelay.delete(t))}_addToQueue(e){var t=e.generation;if(e.generation++,t>10){var r="Stop retrying ".concat(e.src," after ").concat(10," times");throw new i.GaveUpRetry(r)}var a=e.key();if(0===t)this._queue.set(a,e),this._startProcessing();else{var n=l.expDelaySec(t,60,0).cancellable().catchType(Promise.CancellationError,(()=>{}));this._inDelay.set(e.key(),n),n.then((()=>{this._inDelay.delete(a),this._queue.set(a,e),this._startProcessing()}))}}_startProcessing(){this._waitPromise||(this._waitPromise=u.default.waitIfOffline({signal:(new s.default).signal}).then((()=>{this._waitPromise=null,o.UIBusyTasks.enqueue((()=>{this._processRetries()}))})))}_processRetries(){for(var e,t=this._queue.values();(e=t.next())&&!e.done&&!(this._numInProgress>c.maxInProgressRetry());){var r=e.value;this._processRetry((0,d.default)(r,"retry"))}}_processRetry(e){e.inProgress||(e.promise.isPending()?(this._numInProgress++,e.sendXHR().then((t=>{this._queue.delete(e.key()),t?e.resolve():e.shouldRetain()&&this._addToQueue(e)})).catch((t=>{this._queue.delete(e.key()),e.reject(t)})).finally((()=>{this._numInProgress--}))):this._queue.delete(e.key()))}}t.default=c},81524:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(r(45455)),s=a(r(2784)),o=n(r(17957)),u=r(66615),l=/(.*?)__(\w+?)__/g;class d extends s.PureComponent{translate(){var e,t,{id:r,plural:a,params:n}=this.props,u=o.default.t(r,{_plural:a});if(!n||(0,i.default)(n))return u;for(var d=[];e=l.exec(u);){var c=e;d.push(c[1]);var f=c[2];if(f&&null!=n[f]){var p=Array.isArray(n[f])?n[f].map(((e,t)=>s.createElement(s.Fragment,{key:"child_".concat(t)},e))):s.createElement(s.Fragment,{key:f},n[f]);d.push(p)}t=c.index+c[0].length}return"number"==typeof t&&t<u.length&&d.push(u.slice(t)),0===d.length?u:d}render(){var{onClick:e,wrapInHiddenToken:t}=this.props;return s.createElement(u.SelectableSpan,{dir:o.default.isRTL()?"rtl":"ltr",selectable:!t,onClick:e},this.translate())}}t.default=d,d.defaultProps={wrapInHiddenToken:!0},d.displayName="L10n"},81256:(e,t,r)=>{"use strict";var a=r(14859),n=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(r(2784)),s=a(r(50036));t.default=({max:e=100,value:t})=>i.createElement("progress",{value:t,max:e,dir:"ltr",className:s.default.progress})},17426:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(r(72779)),s=a(r(2784)),o=n(r(56117)),u=n(r(53632)),l=n(r(20642)),d=n(r(61316)),c=n(r(2825)),f=n(r(82631)),p=n(r(74824)),h={low:r(40189),high:r(84592)},_={low:r(75259),high:r(42479)},m="FIRST_OPEN",g="READY",v="LOADING",E="FIRST_PLAY",y="ENDED",S="REPLAY";class T extends s.Component{constructor(...e){super(...e),this.playerRef=s.createRef(),this.state={state:m},this._onPosterLoad=()=>{this.setState({state:g})},this._onFirstPlay=e=>{this.setState({state:v}),e.stopPropagation(),e.preventDefault()},this.onCanPlay=()=>{this.state.state===v&&this.setState({state:E})},this.onEnded=()=>{this.setState({state:y})},this._onReplay=()=>{this.setState({state:S});var e=this.playerRef&&this.playerRef.current;e&&e.play()}}componentDidMount(){this.props.listeners.add(window,"dpichange",(()=>{this.forceUpdate()}))}render(){var e,t,r=this.state.state;r===m&&(e=s.createElement("div",{className:d.default.overlay},s.createElement(c.default,{size:32})),t=this._onPosterLoad);var a,n,l=r===m||r===g||r===v?s.createElement(u.default,{className:(0,i.default)(d.default.poster,{[d.default.hidden]:r===m}),src:_[o.default.currentRes],key:"poster",onLoad:t}):null,E=h[o.default.currentRes],S=r!==m&&r!==g?s.createElement("video",{autoPlay:!0,className:d.default.player,controls:!0,controlsList:"nodownload",key:o.default.currentRes,onCanPlayThrough:this.onCanPlay,onEnded:this.onEnded,ref:this.playerRef},s.createElement("source",{src:E,type:"video/mp4"})):null;switch(r){case g:n=this._onFirstPlay,a=s.createElement(A,null);break;case v:a=s.createElement(c.default,{color:"white",size:32});break;case y:n=this._onReplay,a=s.createElement(f.default,{name:"refresh-large"})}var T=a?s.createElement("div",{className:d.default.overlay,role:"button",onClick:n},s.createElement("div",{className:d.default.button},a)):null;return s.createElement("div",{className:d.default.video},s.createElement("div",{className:d.default.container},s.createElement(p.default,{transitionName:"fade"},e,T,l),S))}}T.displayName="Video";var b=(0,l.default)(T);t.default=b;var A=()=>s.createElement("div",{className:d.default.play},s.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"28",height:"34",viewBox:"0 0 28 34"},s.createElement("path",{fill:"#FFF",d:"M1 4.983v24.034a2.982 2.982 0 0 0 4.564 2.53L24.792 19.53a2.981 2.981 0 0 0 0-5.058L5.563 2.454A2.983 2.983 0 0 0 1 4.983z"})))},67616:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(r(19976)),s=n(r(72779)),o=a(r(2784)),u=n(r(32960)),l=r(25675),d=n(r(61867)),c=n(r(79711)),f=n(r(9386)),p=n(r(52737)),h=n(r(50935)),_=n(r(35387)),m=r(95585),g=r(95595),v=n(r(18120)),E=n(r(17957)),y=n(r(81524)),S=n(r(20642)),T=n(r(99911)),b=n(r(35920)),A=n(r(88120)),C=n(r(17024)),P=a(r(52221)),O=r(66615),w=n(r(2825)),M=n(r(82631)),I=n(r(67134)),R=n(r(74824)),D=n(r(76022)),N=a(r(12767)),L=n(r(17426)),k=r(1972),U=r(60339),F=r(44480),G=r(12250);function x(){var e=(0,i.default)(["Assertion failed!"]);return x=function(){return e},e}class B extends o.Component{constructor(e){super(e),this.onStateChange=()=>{this.setState({offline:!T.default.online,expired:N.default.state===N.STATE.UNPAIRED_IDLE,refValid:N.default.state===N.STATE.UNPAIRED})},this._onQRExpiry=()=>{v.default.supportsFeature(v.default.F.MD_BACKEND)?c.default.refreshQR():N.default.poke()},this._onRememberMeChange=e=>{N.default.isIncognito||D.default.setRememberMe(e.target.checked).catch((()=>{})),(0,g.setRememberMe)(e.target.checked),this.setState({rememberMe:(0,g.getRememberMe)()})},this.state={rememberMe:(0,g.getRememberMe)(),expired:N.default.state===N.STATE.UNPAIRED_IDLE,offline:!T.default.online,refValid:N.default.state===N.STATE.UNPAIRED}}componentDidMount(){this.props.listeners.add(N.default,"change:state change:online",this.onStateChange)}render(){var e;e=this.state.offline?o.createElement(K,null,o.createElement("div",{className:C.default.qrButton,key:"expiry"},o.createElement("div",{className:C.default.qrButtonIcon},o.createElement(M.default,{name:"connection"})),E.default.t(489))):this.state.expired?o.createElement(K,null,o.createElement("button",{className:C.default.qrButton,key:"expiry",onClick:this._onQRExpiry},o.createElement("div",{className:C.default.qrButtonIcon},o.createElement(M.default,{name:"refresh-large"})),E.default.t(920))):this.state.refValid?o.createElement(K,null):o.createElement("div",{className:C.default.qrcode},o.createElement(w.default,null));var t,r=this.state.rememberMe?null:o.createElement("div",{className:(0,s.default)(C.default.tip,C.default.rememberMeTip)},E.default.t(832));if(this.props.apiCmd)switch(this.props.apiCmd.resultType){case l.APICmd.GROUP_INVITE:t=o.createElement("div",{className:C.default.groupInviteTip},o.createElement("div",{className:C.default.tip},E.default.t(775)));break;case l.APICmd.MSG_SEND:t=o.createElement("div",{className:C.default.groupInviteTip},o.createElement("div",{className:C.default.tip},E.default.t(1030)))}var a=o.createElement("strong",null,o.createElement(y.default,{id:919,params:{android_menu_icon:o.createElement(W,null)}})),n=o.createElement("strong",null,o.createElement(y.default,{id:922,params:{iphone_settings_icon:o.createElement(V,null)}})),i=o.createElement("strong",null,E.default.t(928)),u=o.createElement(y.default,{id:924,params:{android_menu:a,iphone_settings:n,whatsapp_web_menu_item:i}}),d=o.createElement("div",{className:"landing-header"},o.createElement(H,null),o.createElement("div",{className:"landing-headerTitle"},E.default.t(927))),c=o.createElement(L.default,null);return o.createElement("div",{className:"landing-wrapper"},d,o.createElement("div",{className:"landing-window"},o.createElement("div",{className:"landing-main"},o.createElement("div",{className:C.default.qrWrapper},o.createElement("div",{className:C.default.text},o.createElement("div",{className:(0,s.default)("landing-title",C.default.headline)},E.default.t(926)),o.createElement("ol",{className:C.default.list},o.createElement("li",{className:C.default.listItem},E.default.t(923)),o.createElement("li",{className:C.default.listItem},u),o.createElement("li",{className:C.default.listItem},E.default.t(925)))),o.createElement("div",{className:C.default.qr},t,e),o.createElement(_.default,{href:(0,m.getLoginFaqUrl)(),className:C.default.hint},E.default.t(921)),v.default.supportsFeature(v.default.F.MD_BACKEND)?null:o.createElement("div",{className:C.default.toggle},o.createElement(R.default,{transitionName:"fade_sifo"},r),o.createElement("label",null,o.createElement("input",{type:"checkbox",name:"rememberMe",checked:this.state.rememberMe,onChange:this._onRememberMeChange}),E.default.t(967))))),undefined,undefined,c,undefined,undefined,undefined))}}B.displayName="QRCode";class Y extends o.Component{constructor(e){super(e),this._setRefContainer=e=>{this._containerElement=e},this._genQR=()=>{var e=this._containerElement;return null==e?Promise.resolve():this.getData().then((t=>{t&&(b.default.inc(),this.qr?this.qr.makeCode(t):this.qr=new A.default(e,{text:t,colorDark:"#122e31",width:h.default.QR_EDGE,height:h.default.QR_EDGE,correctLevel:A.default.CorrectLevel.L}),e.removeAttribute("title"),e.setAttribute("data-ref",t))}))},this.copy=()=>{var e=window.getSelection(),t=document.getElementsByClassName(C.default.codeCopy).item(0);t&&(e.selectAllChildren(t),document.execCommand("copy")),c.default.closeModal()},this.onMouseMove=()=>{this.state.disableCursor&&this.setState({disableCursor:!1}),this._disableCursor()},this.onMouseLeave=()=>{this._disableCursor.cancel(),this.setState({disableCursor:!1})},this.onContextMenu=e=>{e.stopPropagation(),e.preventDefault(),this.getData().then((e=>{c.default.openModal(o.createElement(f.default,{onOK:this.copy,okText:"Copy to Clipboard"},o.createElement(O.SelectableSpan,{className:C.default.codeCopy,selectable:!0},e)))}))},this._disableCursor=this.props.debounce((()=>{this.setState({disableCursor:!0})}),100),this.state={disableCursor:!1}}componentDidMount(){this._genQR(),this.props.listeners.add(p.default,"change:ref",this._genQR),c.default.initialLoadReady()}componentWillUnmount(){b.default.reset()}getData(){if(p.default.connected)return Promise.resolve(void 0);var e=p.default.ref;if(v.default.supportsFeature(v.default.F.MD_BACKEND))return F.waSignalStore.getRegistrationInfo().then((t=>{var r=k.waNoiseInfo.get();if(!r||!r.staticKeyPair||!t)return __LOG__(4,void 0,new Error,!0)(x()),SEND_LOGS("Empty noiseInfo or empty regInfo"),null;var a=(0,U.encodeB64)(r.staticKeyPair.pubKey),n=(0,U.encodeB64)(t.identityKeyPair.pubKey),i=(0,G.getADVSecretKey)();return e+","+a+","+n+","+i}));var t=d.default.id();return Promise.resolve().then((()=>{var r=P.getOrGenerate();return e+","+r+","+t}))}render(){var e=this.props.children,t=(0,s.default)(C.default.qrcode,{[C.default.idle]:!!e}),r=this.state.disableCursor&&null==e?{cursor:"none"}:null;return o.createElement("div",{ref:this._setRefContainer,"data-a8n":u.default.key("qrcode"),className:t,onContextMenu:null,style:r,onMouseMove:this.onMouseMove,onMouseLeave:this.onMouseLeave},o.createElement(R.default,{transitionName:"scale"},e),o.createElement("div",{className:C.default.codeLogo},o.createElement(q,null)))}}Y.displayName="Qrcode";var K=(0,I.default)((0,S.default)(Y)),j=(0,S.default)(B);t.default=j;var W=()=>o.createElement("span",{className:C.default.icon},o.createElement("svg",{height:"24px",viewBox:"0 0 24 24",width:"24px"},o.createElement("rect",{fill:"#f2f2f2",height:"24",rx:"3",width:"24"}),o.createElement("path",{d:"m12 15.5c.825 0 1.5.675 1.5 1.5s-.675 1.5-1.5 1.5-1.5-.675-1.5-1.5.675-1.5 1.5-1.5zm0-2c-.825 0-1.5-.675-1.5-1.5s.675-1.5 1.5-1.5 1.5.675 1.5 1.5-.675 1.5-1.5 1.5zm0-5c-.825 0-1.5-.675-1.5-1.5s.675-1.5 1.5-1.5 1.5.675 1.5 1.5-.675 1.5-1.5 1.5z",fill:"#818b90"}))),V=()=>o.createElement("span",{className:C.default.icon},o.createElement("svg",{width:"24",height:"24",viewBox:"0 0 24 24"},o.createElement("rect",{fill:"#F2F2F2",width:"24",height:"24",rx:"3"}),o.createElement("path",{d:"M12 18.69c-1.08 0-2.1-.25-2.99-.71L11.43 14c.24.06.4.08.56.08.92 0 1.67-.59 1.99-1.59h4.62c-.26 3.49-3.05 6.2-6.6 6.2zm-1.04-6.67c0-.57.48-1.02 1.03-1.02.57 0 1.05.45 1.05 1.02 0 .57-.47 1.03-1.05 1.03-.54.01-1.03-.46-1.03-1.03zM5.4 12c0-2.29 1.08-4.28 2.78-5.49l2.39 4.08c-.42.42-.64.91-.64 1.44 0 .52.21 1 .65 1.44l-2.44 4C6.47 16.26 5.4 14.27 5.4 12zm8.57-.49c-.33-.97-1.08-1.54-1.99-1.54-.16 0-.32.02-.57.08L9.04 5.99c.89-.44 1.89-.69 2.96-.69 3.56 0 6.36 2.72 6.59 6.21h-4.62zM12 19.8c.22 0 .42-.02.65-.04l.44.84c.08.18.25.27.47.24.21-.03.33-.17.36-.38l.14-.93c.41-.11.82-.27 1.21-.44l.69.61c.15.15.33.17.54.07.17-.1.24-.27.2-.48l-.2-.92c.35-.24.69-.52.99-.82l.86.36c.2.08.37.05.53-.14.14-.15.15-.34.03-.52l-.5-.8c.25-.35.45-.73.63-1.12l.95.05c.21.01.37-.09.44-.29.07-.2.01-.38-.16-.51l-.73-.58c.1-.4.19-.83.22-1.27l.89-.28c.2-.07.31-.22.31-.43s-.11-.35-.31-.42l-.89-.28c-.03-.44-.12-.86-.22-1.27l.73-.59c.16-.12.22-.29.16-.5-.07-.2-.23-.31-.44-.29l-.95.04c-.18-.4-.39-.77-.63-1.12l.5-.8c.12-.17.1-.36-.03-.51-.16-.18-.33-.22-.53-.14l-.86.35c-.31-.3-.65-.58-.99-.82l.2-.91c.03-.22-.03-.4-.2-.49-.18-.1-.34-.09-.48.01l-.74.66c-.39-.18-.8-.32-1.21-.43l-.14-.93a.426.426 0 00-.36-.39c-.22-.03-.39.05-.47.22l-.44.84-.43-.02h-.22c-.22 0-.42.01-.65.03l-.44-.84c-.08-.17-.25-.25-.48-.22-.2.03-.33.17-.36.39l-.13.88c-.42.12-.83.26-1.22.44l-.69-.61c-.15-.15-.33-.17-.53-.06-.18.09-.24.26-.2.49l.2.91c-.36.24-.7.52-1 .82l-.86-.35c-.19-.09-.37-.05-.52.13-.14.15-.16.34-.04.51l.5.8c-.25.35-.45.72-.64 1.12l-.94-.04c-.21-.01-.37.1-.44.3-.07.2-.02.38.16.5l.73.59c-.1.41-.19.83-.22 1.27l-.89.29c-.21.07-.31.21-.31.42 0 .22.1.36.31.43l.89.28c.03.44.1.87.22 1.27l-.73.58c-.17.12-.22.31-.16.51.07.2.23.31.44.29l.94-.05c.18.39.39.77.63 1.12l-.5.8c-.12.18-.1.37.04.52.16.18.33.22.52.14l.86-.36c.3.31.64.58.99.82l-.2.92c-.04.22.03.39.2.49.2.1.38.08.54-.07l.69-.61c.39.17.8.33 1.21.44l.13.93c.03.21.16.35.37.39.22.03.39-.06.47-.24l.44-.84c.23.02.44.04.66.04z",fill:"#818b90"}))),H=()=>o.createElement("span",{className:C.default.icon},o.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"39",height:"39",viewBox:"0 0 39 39"},o.createElement("path",{fill:"#00E676",d:"M10.7 32.8l.6.3c2.5 1.5 5.3 2.2 8.1 2.2 8.8 0 16-7.2 16-16 0-4.2-1.7-8.3-4.7-11.3s-7-4.7-11.3-4.7c-8.8 0-16 7.2-15.9 16.1 0 3 .9 5.9 2.4 8.4l.4.6-1.6 5.9 6-1.5z"}),o.createElement("path",{fill:"#FFF",d:"M32.4 6.4C29 2.9 24.3 1 19.5 1 9.3 1 1.1 9.3 1.2 19.4c0 3.2.9 6.3 2.4 9.1L1 38l9.7-2.5c2.7 1.5 5.7 2.2 8.7 2.2 10.1 0 18.3-8.3 18.3-18.4 0-4.9-1.9-9.5-5.3-12.9zM19.5 34.6c-2.7 0-5.4-.7-7.7-2.1l-.6-.3-5.8 1.5L6.9 28l-.4-.6c-4.4-7.1-2.3-16.5 4.9-20.9s16.5-2.3 20.9 4.9 2.3 16.5-4.9 20.9c-2.3 1.5-5.1 2.3-7.9 2.3zm8.8-11.1l-1.1-.5s-1.6-.7-2.6-1.2c-.1 0-.2-.1-.3-.1-.3 0-.5.1-.7.2 0 0-.1.1-1.5 1.7-.1.2-.3.3-.5.3h-.1c-.1 0-.3-.1-.4-.2l-.5-.2c-1.1-.5-2.1-1.1-2.9-1.9-.2-.2-.5-.4-.7-.6-.7-.7-1.4-1.5-1.9-2.4l-.1-.2c-.1-.1-.1-.2-.2-.4 0-.2 0-.4.1-.5 0 0 .4-.5.7-.8.2-.2.3-.5.5-.7.2-.3.3-.7.2-1-.1-.5-1.3-3.2-1.6-3.8-.2-.3-.4-.4-.7-.5h-1.1c-.2 0-.4.1-.6.1l-.1.1c-.2.1-.4.3-.6.4-.2.2-.3.4-.5.6-.7.9-1.1 2-1.1 3.1 0 .8.2 1.6.5 2.3l.1.3c.9 1.9 2.1 3.6 3.7 5.1l.4.4c.3.3.6.5.8.8 2.1 1.8 4.5 3.1 7.2 3.8.3.1.7.1 1 .2h1c.5 0 1.1-.2 1.5-.4.3-.2.5-.2.7-.4l.2-.2c.2-.2.4-.3.6-.5s.4-.4.5-.6c.2-.4.3-.9.4-1.4v-.7s-.1-.1-.3-.2z"}))),q=()=>o.createElement("span",{className:C.default.icon},o.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"64",height:"64",viewBox:"0 0 64 64"},o.createElement("path",{fill:"#FFF",d:"M6.525 43.936a29.596 29.596 0 0 1-3.039-13.075C3.494 14.568 16.755 1.313 33.05 1.313c7.904.004 15.328 3.082 20.91 8.666 5.581 5.586 8.653 13.01 8.65 20.907-.007 16.294-13.266 29.549-29.558 29.549a29.648 29.648 0 0 1-12.508-2.771L1.391 62.687l5.134-18.751z"}),o.createElement("path",{fill:"#123033",d:"M50.801 13.135c-4.739-4.742-11.039-7.354-17.752-7.357-13.837 0-25.094 11.253-25.099 25.085a25.039 25.039 0 0 0 3.349 12.541l-3.56 12.999 13.304-3.488a25.084 25.084 0 0 0 11.996 3.054h.011c13.83 0 25.088-11.256 25.095-25.087.002-6.703-2.607-13.005-7.344-17.747zM33.05 51.733h-.008a20.866 20.866 0 0 1-10.62-2.906l-.762-.452-7.894 2.07 2.108-7.694-.497-.789a20.802 20.802 0 0 1-3.189-11.097c.004-11.496 9.361-20.85 20.87-20.85a20.73 20.73 0 0 1 14.746 6.115 20.733 20.733 0 0 1 6.104 14.752c-.006 11.497-9.363 20.851-20.858 20.851z"}),o.createElement("path",{fill:"#123033",d:"M25.429 19.26a8.65 8.65 0 0 0-1.028.011 2.352 2.352 0 0 0-.95.255c-.221.114-.427.277-.75.582-.305.288-.481.54-.668.782a6.974 6.974 0 0 0-1.443 4.291l.001.003a8.243 8.243 0 0 0 .844 3.607c1.043 2.307 2.763 4.746 5.035 7.008a24.676 24.676 0 0 0 1.657 1.6 24.145 24.145 0 0 0 9.814 5.229s.751.179 1.391.218c.021.001.04.003.061.003a9.207 9.207 0 0 0 1.422-.033 5.086 5.086 0 0 0 2.129-.59c.423-.225.623-.337.978-.561 0 0 .11-.072.319-.23.345-.257.558-.438.845-.736.211-.22.394-.479.534-.772.2-.417.401-1.213.481-1.874.061-.505.042-.781.036-.952-.011-.275-.238-.558-.487-.678l-1.486-.668s-2.222-.967-3.581-1.587a1.278 1.278 0 0 0-.452-.104c-.341-.021-.723.068-.966.324v-.004c-.013-.001-.182.145-2.031 2.385-.102.122-.341.387-.754.362a1.086 1.086 0 0 1-.185-.029 3.402 3.402 0 0 1-.49-.17c-.316-.134-.427-.185-.643-.278l-.013-.006a15.361 15.361 0 0 1-4.013-2.556 15.88 15.88 0 0 1-.927-.885c-1.074-1.041-1.953-2.148-2.607-3.24-.035-.06-.09-.146-.15-.242-.107-.174-.225-.381-.262-.523-.095-.376.157-.678.157-.678s.622-.68.911-1.05c.278-.356.518-.704.671-.952.301-.484.39-.982.238-1.37a216.767 216.767 0 0 0-2.219-5.215c-.156-.339-.598-.589-1.005-.636a6.284 6.284 0 0 0-.414-.041"})))},64225:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(r(829)),s=a(r(2784)),o=n(r(38147)),u=n(r(6660)),l=n(r(68340)),d=n(r(38447));class c extends s.Component{constructor(...e){super(...e),this._refRotateFocus=s.createRef(),this.getElement=()=>this._refRotateFocus.current,this.onKeyDown=e=>{if(!e.metaKey&&!e.ctrlKey){if("Tab"===e.key)return this.onRotateFocus(e);var t=this._refRotateFocus.current;if(t&&t===document.activeElement){var r=t.querySelector("input[data-tab]");r&&(o.default.shouldIndicateFocus(),f(r))}}},this.onRotateFocus=e=>{var t=1;e&&(e.stopPropagation(),e.preventDefault(),t=e.shiftKey?-1:1,o.default.shouldIndicateFocus());var r=this._refRotateFocus.current;if(r){var a=Array.from(r.querySelectorAll("[data-tab]"));if(a.length){a=(0,i.default)(a,(e=>parseInt(e.getAttribute("data-tab"),10)||0));var n=0,s=document.activeElement;s&&(n=(0,l.default)(a,a.findIndex((e=>e.contains(s)))+t));var u=a[n];o.default.shouldIndicateFocus(),f(u)}}}}render(){return s.createElement("div",{ref:this._refRotateFocus,style:this.props.style,className:d.default.container,onKeyDown:this.onKeyDown,tabIndex:"-1"},this.props.children)}}function f(e){e.restoreFocus?e.restoreFocus():u.default.focus(e)}t.default=c,c.displayName="RotateFocus"},92754:(e,t,r)=>{"use strict";var a=r(14859),n=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(r(2784)),s=r(65712),o=a(r(10792)),u=a(r(32186)),l=r(28103).Mirrored(["FORWARD","REVERSE"]);class d extends i.Component{constructor(...e){super(...e),this._refRotateFocus=i.createRef(),this.getElement=()=>this._refRotateFocus.current,this.onKeyDown=e=>{if(!e.metaKey&&!e.ctrlKey)return e.key===o.default.KEYBOARD_EVENT_KEY_VALUE.TAB?this.onRotateFocus(e):void 0},this.onRotateFocus=e=>{var t=this._refRotateFocus.current;if(t){var r=e.shiftKey?l.REVERSE:l.FORWARD,a=(0,s.tabbable)(t);if(!(a.length<1)){var n=a[0],i=a[a.length-1],o=document.activeElement;r===l.FORWARD&&o===i?(e.preventDefault(),n.focus()):r!==l.REVERSE||o!==n&&o!==t||(e.preventDefault(),i.focus())}}}}render(){return i.createElement("div",{ref:this._refRotateFocus,className:u.default.container,onKeyDown:this.onKeyDown,tabIndex:"-1",onBlur:this.props.onBlur,role:"dialog"},this.props.children)}}t.default=d,d.displayName="RotateFocusModal"},39401:(e,t,r)=>{"use strict";var a=r(14859),n=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(r(2784)),s=a(r(41353)),o=a(r(50935)),u=r(35387),l=a(r(17957)),d=a(r(74185));t.default=()=>{var e=d.default.build(o.default.SMB_TOS_LEARN_MORE_LINK,{lg:l.default.getLocale()});return i.createElement(s.default,{href:e,onClick:t=>{t.preventDefault(),setTimeout((()=>(0,u.openExternalLink)(e)),10)}},l.default.t(875))}},2825:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.colorOptions=t.styleThemeOptions=void 0;n(r(19976));var i=n(r(72779)),s=a(r(2784)),o=n(r(63252)),u=n(r(9807));var l=(0,o.default)({noop:null});t.styleThemeOptions=l;var d=(0,o.default)({default:null,highlight:null,solidwhite:null,white:null,accent:null});t.colorOptions=d;class c extends s.PureComponent{componentDidMount(){}render(){var{size:e,stroke:t,styleThemes:r,color:a,outgoingMsg:n}=this.props,o=40+t,l=(0,i.default)(u.default.path,u.default[a],{[u.default.in]:!1===n,[u.default.out]:n});return s.createElement("svg",{className:(0,i.default)(u.default.container,r&&r.map((e=>u.default[e]))),width:e,height:e,viewBox:"0 0 "+o+" "+o,role:"status"},s.createElement("circle",{className:l,cx:o/2,cy:o/2,r:20,fill:"none",strokeWidth:t}))}}t.default=c,c.defaultProps={color:d.default,size:65,stroke:4},c.displayName="Spinner"},82631:(e,t,r)=>{"use strict";var a=r(14859),n=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var{className:t,color:r,directional:a,display:n,containerRef:u,name:l,"aria-label":d,title:c,style:f}=e;return i.createElement(o.default,{"aria-label":d,className:t,color:r,containerRef:u,isRTL:!!a&&s.default.isRTL(),display:n,name:l,title:c,style:f})};var i=n(r(2784)),s=a(r(17957)),o=a(r(26474))},26474:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.loadSVGData=h,t.loadSpecificSVG=function(e){return h().then((()=>i[e]))},t.default=void 0;var i,s,o=n(r(58527)),u=n(r(22220)),l=n(r(72779)),d=r(91460),c=a(r(2784)),f=n(r(10476)),p=a(r(82885));function h(){return s||(s=Promise.loop(((e,t,a)=>{var n=(0,d.delayMs)(p.expBackoff(a,12e4,1e3,.1));return r.e(5512).then(r.bind(r,48779)).then((t=>{i=t.default,e()})).catch((()=>n))})))}class _ extends c.PureComponent{constructor(...e){super(...e),this.state={loaded:!!i}}componentDidMount(){this.state.loaded||(this.loading=h().cancellable().then((()=>{this.setState({loaded:!0})})).catch((()=>{})))}componentWillUnmount(){this.loading&&this.loading.cancel()}render(){var e=this.props,{"aria-label":t,name:r,isRTL:a,className:n,display:s,containerRef:d}=e,p=(0,u.default)(e,["aria-label","name","isRTL","className","display","containerRef"]);if(i&&!i[r])throw new Error("Missing SVG for '"+r+"'!");var h=i?{__html:i[r]}:void 0,_=this.props.color?f.default[this.props.color]:null,m=(0,l.default)(_,n,{[f.default.reverse]:a,[f.default.inline]:"inline"===s});return c.createElement("span",(0,o.default)({"data-testid":r,"aria-label":t,ref:d,"data-icon":r,className:m,dangerouslySetInnerHTML:h},p))}}t.default=_,_.displayName="SVGBase"},40263:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=d,t.TextHeader=function(e){var{level:t="1"}=e,r=(0,s.default)(e,["level"]);return o.createElement(d,(0,i.default)({as:c[t]},r))},t.TextParagraph=function(e){return o.createElement(d,(0,i.default)({as:"p"},e))},t.TextDiv=function(e){return o.createElement(d,(0,i.default)({as:"div"},e))},t.TextSpan=function(e){return o.createElement(d,(0,i.default)({as:"span"},e))};var i=n(r(58527)),s=n(r(22220)),o=a(r(2784)),u=n(r(72779)),l=n(r(32455));function d(e){var t,r,a,n,i=null!==(t=e.as)&&void 0!==t?t:"span",s=e.theme?l.default[e.theme]:null,d=e.color?l.default["color-".concat(e.color)]:null,c=l.default["weight-".concat(null!==(r=e.weight)&&void 0!==r?r:"normal")],f=null!=e.customSize?null:null!==(a=e.size)&&void 0!==a?a:"14",p=null!=f?l.default["size-".concat(f)]:null;return null!=e.customSize&&(n={fontSize:"string"==typeof e.customSize?e.customSize:"".concat(e.customSize,"px")}),o.createElement(i,{className:(0,u.default)(s,d,p,c,e.className),style:n},e.children)}var c={1:"h1",2:"h2",3:"h3",4:"h4",5:"h5",6:"h6"}},75074:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.genId=function(e){return(0,i.default)(e||"toast")},t.default=t.ToastBody=t.ToastDismissBtn=t.ToastActionBtn=t.Toast=void 0;var i=n(r(74930)),s=n(r(72779)),o=a(r(2784)),u=n(r(79711)),l=n(r(82631)),d=n(r(67134)),c=n(r(70680));class f extends o.PureComponent{constructor(...e){super(...e),this.delay=this.props.setTimeout((()=>{u.default.closeToast(this)}),this.props.duration),this.onDismiss=()=>{u.default.closeToast(this),this.props.onDismiss&&this.props.onDismiss()}}getId(){return this.props.id}restartDelay(){this.props.clearTimeout(this.delay),this.delay=this.props.setTimeout((()=>{u.default.closeToast(this)}),this.props.duration)}render(){var e,{msg:t,action:r}=this.props;return r&&(e=o.createElement(p,{buttonText:r.actionText,onClick:r.dismiss?this.onDismiss:r.onAction,theme:r.theme})),o.createElement(_,{actionText:t,actionBtn:e})}}t.Toast=f,f.defaultProps={duration:4e3},f.displayName="Toast";var p=({buttonText:e,onClick:t,theme:r})=>o.createElement("button",{className:(0,s.default)(c.default.button,{[c.default.btnSuccess]:"success"===r}),onClick:t},e);t.ToastActionBtn=p,p.displayName="ToastActionBtn";var h=({buttonText:e,onClick:t})=>o.createElement("button",{className:c.default.close,onClick:t},o.createElement(l.default,{name:"x-alt"}));t.ToastDismissBtn=h,h.displayName="ToastDismissBtn";var _=({toastPosition:e,actionText:t,actionBtn:r,dismissBtn:a})=>{var n=(0,s.default)(c.default.toast,{[c.default.right]:"RIGHT"===e});return o.createElement("div",{className:n},o.createElement("span",null,t),r,a)};t.ToastBody=_,_.displayName="ToastBody";var m=(0,d.default)(f);t.default=class extends m{restartDelay(){var e=this.getComponent();e&&e.restartDelay()}}},35563:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(r(829)),s=n(r(17620)),o=n(r(72779)),u=a(r(2784)),l=n(r(79711)),d=n(r(20642)),c=n(r(6155)),f=n(r(75074)),p=n(r(89778)),h=n(r(77626)),_=n(r(74824));class m extends u.Component{constructor(...e){super(...e),this.state={toasts:{}},this._refToasts=new Map,this._setRefToast=(e,t)=>{t?this._refToasts.set(e,t):this._refToasts.delete(e)},this._setToastRefCache=new c.default(this._setRefToast),this.openToast=e=>{var t;(t=this._refToasts.get(e.props.id))&&t instanceof f.default?t.restartDelay():(this.state.toasts[e.props.id]=e,this.setState({toasts:this.state.toasts}))},this.closeToast=e=>{var t=this.state.toasts;t[e.props.id]&&this.setState({toasts:(0,s.default)(t,e.props.id)})}}componentDidMount(){this.props.listeners.add(l.default,"open_toast",this.openToast),this.props.listeners.add(l.default,"close_toast",this.closeToast)}componentDidUpdate(e,t){this._animateEnter=Object.keys(t.toasts).length>Object.keys(this.state.toasts).length}render(){var e=this._animateEnter,t=(0,i.default)(this.state.toasts,"id").reverse().map(((t,r)=>{var a=r<3?p.default["slide".concat(r)]:p.default["slide".concat(3)];return 0!==r||e||(a=""),u.createElement("div",{key:t.props.id,ref:this._setToastRefCache.getRefSetter(t.props.id),className:(0,o.default)(p.default.wrapper,a)},u.cloneElement(t))})),r=h.default.isTrident?"fade_sifo":"toast-transition";return u.createElement(_.default,{transitionName:r},t)}}m.displayName="ToastManager";var g=(0,d.default)(m);t.default=g},17693:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(r(19976)),s=a(r(2784)),o=n(r(93954)),u=n(r(20398)),l=n(r(5179));function d(){var e=(0,i.default)(["UIE received a child component that does not have a compatible API:\n",""],["UIE received a child component that does not have a compatible API:\\n",""]);return d=function(){return e},e}var c=null;class f extends s.Component{constructor(e,t){super(e,t),this._didMount=!1,this._pendingRequestFocus=!1,this._requestFocusTimeout=null,this._refAnchorElement=s.createRef(),this._setRefChild=e=>{var t="function"==typeof(null==e?void 0:e.getComponent)?e.getComponent():e;this._refChild=t,this.props.children&&"function"==typeof this.props.children.ref&&this.props.children.ref(t)},this.uim=this.context?this.context.branch(this):new u.default(void 0,this)}componentDidUpdate(e){e.uimState!==this.props.uimState&&(this.uim.state=this.props.uimState)}componentWillUnmount(){c&&this._requestFocusTimeout===c&&(clearTimeout(c),c=null),this.uim.pop(!0,this.props.requestRecentFocusOnUnmount)}activate(){this.uim.activate()}popable(){return this.props.popable}escapable(){return this.props.escapable}requestDismiss(e){this.props.requestDismiss&&this.props.requestDismiss(e)}componentDidMount(){var{requestFocus:e}=this.props;this._didMount=!0,e&&this._pendingRequestFocus&&this._maybeCallRequestFocus()}requestFocus(){var{requestFocus:e}=this.props;e&&this._didMount?this._maybeCallRequestFocus():this._pendingRequestFocus=!0}getDisplayName(){return this.props.displayName}getRef(){return this._refChild}getUIMState(){return this.props.uimState}getNode(){var e=this._refChild;if(null!=e){if(e instanceof HTMLElement)return e;var t="";try{var r=e.getElement();if(null==r||r instanceof HTMLElement)return r;t="Non HTML element received:\n".concat((0,o.default)(r.constructor))}catch(e){t="".concat(e.message,":\n").concat(e.stack)}__LOG__(4,void 0,new Error,!0)(d(),t),SEND_LOGS("uie-bad-child-api");var a=this._refAnchorElement.current;if((null==a?void 0:a.previousElementSibling)instanceof HTMLElement)return a.previousElementSibling}return null}render(){var{children:e}=this.props;if(!e)return null;var t=s.cloneElement(e,{ref:this._setRefChild});return s.createElement(l.default.Provider,{value:this.uim},t,s.createElement("div",{ref:this._refAnchorElement,style:{display:"none"},hidden:!0}))}_maybeCallRequestFocus(){var{requestFocus:e}=this.props;e&&(c&&clearTimeout(c),this._requestFocusTimeout=c=setTimeout((()=>{e(),this._requestFocusTimeout=c=null}),0))}}t.default=f,f.State=u.default.State,f.defaultProps={uimState:u.default.State.ACTIVE,requestRecentFocusOnUnmount:!0},f.contextType=l.default,f.displayName="UIE"},75010:(e,t,r)=>{"use strict";var a=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(2784)),i=n.forwardRef((function({children:e},t){var r=n.useRef();return n.useImperativeHandle(t,(()=>({getElement:()=>r.current}))),n.createElement("div",{ref:r},e)}));t.default=i},93954:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return"string"==typeof e?e:e&&(e.displayName||e.name)||"Component"}},13414:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.GetRef=function(e){return t=>{t?"function"==typeof t._getComponent?e(t._getComponent()):e(t):e(void 0)}},t._getComponent=function(){var e=this.component||this.refs.component;if("function"==typeof e._getComponent)return e._getComponent();return e},t.WrappedComponent=t.HOCRef=void 0;var i=n(r(19976)),s=n(r(70417)),o=a(r(2784)),u=n(r(61941));function l(){var e=(0,i.default)(["","\n",""],["","\\n",""]);return l=function(){return e},e}t.HOCRef="component";class d extends o.Component{constructor(e){super(e),this.setComponent=e=>{this.component=e},this.state=(0,s.default)({},this.state)}static getDerivedStateFromError(){return{hasError:!0}}componentDidCatch(e,t){__LOG__(4,void 0,new Error,!0)(l(),e.stack,t.componentStack),SEND_LOGS("component-did-catch")}getComponent(){return this.component instanceof d?this.component.getComponent():(0,u.default)(this.component,"this.component")}}t.WrappedComponent=d},20642:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t,r,a;return r=t=class extends p.WrappedComponent{constructor(...e){super(...e),this.listeners=new m}componentDidMount(){this.listeners.internalUseOnlyMarkMounted()}componentWillUnmount(){this.listeners.internalUseOnlyMarkUnmounted()}_getComponent(){return p._getComponent.call(this)}render(){return this.state.hasError?null:o.createElement(e,(0,i.default)({ref:this.setComponent},this.props,{listeners:this.listeners}))}},t.defaultProps=null!==(a=e.defaultProps)&&void 0!==a?a:void 0,t.displayName="Listener(".concat((0,f.default)(e),")"),r},t.Listeners=void 0;var i=n(r(58527)),s=n(r(19976)),o=a(r(2784)),u=n(r(12489)),l=r(8701),d=n(r(79711)),c=n(r(45090)),f=n(r(93954)),p=r(13414),h=n(r(28148));function _(){var e=(0,s.default)(["Listener added after unmounting"]);return _=function(){return e},e}class m{constructor(){this._mounted=!1,this._unmounted=!1,this._listeners=new Set,this._remove=e=>{e.disengage(),this._listeners.delete(e)}}_add(e){this._unmounted?__LOG__(3)(_()):(this._listeners.add(e),this._mounted&&e.engage())}internalUseOnlyMarkMounted(){this._mounted=!0,this._listeners.forEach((e=>{e.engage()}))}internalUseOnlyMarkUnmounted(){this._unmounted=!0,this._listeners.forEach(this._remove),this._abortController&&this._abortController.abort()}add(e,t,r,a){var n=this,i=new h.default(e,t,(function(){n._unmounted||r.apply(this,arguments)}),a,r);this._add(i)}addOnce(e,t,r,a){var n=this,i=new h.default(e,t,(function(){n._remove(i),n._unmounted||r.apply(this,arguments)}),a,r);this._add(i)}remove(e,t,r,a){this._listeners.forEach((n=>{n.represents(e,t,r,a)&&this._remove(n)}))}uiIdle(e){d.default.uiBusy?this.addOnce(d.default,"ui_idle",e):(this._abortController=this._abortController||new u.default,(0,c.default)({signal:this._abortController.signal}).then((()=>{e()}),(e=>{if(e.name!==l.ABORT_ERROR)throw e})))}testsOnlyGetListeners(){return this._listeners}}t.Listeners=m},72259:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t,r,a;return r=t=class extends l.WrappedComponent{constructor(...e){super(...e),this._isUnmounted=!1,this.rejectOnUnmount=()=>(this._rejectPromise||(this._rejectPromise=new Promise(((e,t)=>{this._rejector=t})),this._rejectPromise.catch((()=>{})),this._isUnmounted&&this._rejector(new o.Unmount)),this._rejectPromise)}componentWillUnmount(){this._isUnmounted=!0,this._rejectPromise&&this._rejector(new o.Unmount)}_getComponent(){return l._getComponent.call(this)}render(){return this.state.hasError?null:s.createElement(e,(0,i.default)({ref:this.setComponent,rejectOnUnmount:this.rejectOnUnmount},this.props))}},t.defaultProps=null!==(a=e.defaultProps)&&void 0!==a?a:void 0,t.displayName="Promise(".concat((0,u.default)(e),")"),r};var i=n(r(58527)),s=a(r(2784)),o=a(r(96452)),u=n(r(93954)),l=r(13414)},64658:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.unproxy=function(e){return(null==e?void 0:e.$ProxyState$state)?e.$ProxyState$state:e}},67134:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t,r;return r=t=class extends c.WrappedComponent{constructor(...e){super(...e),this._timers=new Map,this._timerId=0,this._unmounted=!1,this.setInterval=(e,t)=>{this._unmounted&&(__LOG__(4,void 0,new Error,!0)(m()),SEND_LOGS("Setting interval after unmount"));var r=++this._timerId,a=window.setInterval(e,t);return this._timers.set(r,(()=>{window.clearInterval(a),this._timers.delete(r)})),r},this.clearInterval=e=>{var t=this._timers.get(e);t&&t()},this.setTimeout=(e,t)=>{this._unmounted&&(__LOG__(4,void 0,new Error,!0)(_()),SEND_LOGS("Setting timeout after unmount"));var[r,a]=this._cbWrapper(e),n=window.setTimeout(a,t);return this._timers.set(r,(()=>{window.clearTimeout(n),this._timers.delete(r)})),r},this.clearTimeout=e=>{var t=this._timers.get(e);t&&t()},this.requestAnimationFrame=e=>{this._unmounted&&(__LOG__(4,void 0,new Error,!0)(h()),SEND_LOGS("Requesting animation frame after unmount"));var[t,r]=this._cbWrapper(e),a=window.requestAnimationFrame(r);return this._timers.set(t,(()=>{window.cancelAnimationFrame(a),this._timers.delete(t)})),t},this.cancelAnimationFrame=e=>{var t=this._timers.get(e);t&&t()},this.throttle=(e,t,r)=>{this._unmounted&&(__LOG__(4,void 0,new Error,!0)(p()),SEND_LOGS("Throttling after unmount"));var[a,n]=this._cbWrapper(e),i=(0,u.default)(n,t,r),s=i.cancel.bind(i);i.cancel=()=>{s(),this._timers.delete(a)};var o=(...e)=>{this._unmounted||(this._timers.set(a,i.cancel),i(...e))};return o.cancel=i.cancel,o.flush=i.flush,o},this.debounce=(e,t,r)=>{this._unmounted&&(__LOG__(4,void 0,new Error,!0)(f()),SEND_LOGS("Debouncing after unmount"));var[a,n]=this._cbWrapper(e),i=(0,o.default)(n,t,r),s=i.cancel.bind(i),u=i.flush.bind(i);i.cancel=()=>{s(),this._timers.delete(a)},i.flush=()=>{u()};var l=(...e)=>{this._unmounted||(this._timers.set(a,i.cancel),i(...e))};return l.cancel=i.cancel,l.flush=i.flush,l},this._cbWrapper=e=>{var t=++this._timerId;return[t,(...r)=>{this._timers.delete(t),e(...r)}]}}_getComponent(){return c._getComponent.call(this)}componentWillUnmount(){this._unmounted=!0,this._timers.forEach((e=>e()))}render(){return this.state.hasError?null:l.createElement(e,(0,i.default)({ref:this.setComponent,setInterval:this.setInterval,clearInterval:this.clearInterval,setTimeout:this.setTimeout,clearTimeout:this.clearTimeout,requestAnimationFrame:this.requestAnimationFrame,cancelAnimationFrame:this.cancelAnimationFrame,debounce:this.debounce,throttle:this.throttle},this.props))}},t.displayName="Timer(".concat((0,d.default)(e),")"),r};var i=n(r(58527)),s=n(r(19976)),o=n(r(54073)),u=n(r(12436)),l=a(r(2784)),d=n(r(93954)),c=r(13414);function f(){var e=(0,s.default)(["Assertion failed!"]);return f=function(){return e},e}function p(){var e=(0,s.default)(["Assertion failed!"]);return p=function(){return e},e}function h(){var e=(0,s.default)(["Assertion failed!"]);return h=function(){return e},e}function _(){var e=(0,s.default)(["Assertion failed!"]);return _=function(){return e},e}function m(){var e=(0,s.default)(["Assertion failed!"]);return m=function(){return e},e}},63925:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.requireMain=function(){return c().then((e=>e.requireMain()))},t.requireContactCollection=function(){return c().then((e=>e.requireContactCollection()))},t.requireLoadProtoVersions=function(){return c().then((e=>e.requireLoadProtoVersions()))},t.requireHandleSocketMessage=function(){return c().then((e=>e.requireHandleSocketMessage()))},t.requireEmojiConfig=function(){return c().then((e=>e.requireEmojiConfig()))},t.requireEmojiAssetMapCreator=function(){return c().then((e=>e.requireEmojiAssetMapCreator()))},t.requireStatusV3Collection=function(){return c().then((e=>e.requireStatusV3Collection()))},t.requireClearAppStates=function(){return c().then((e=>e.requireClearAppStates()))},t.requireHandleVideoStreamingRequest=function(){return c().then((e=>e.requireHandleVideoStreamingRequest()))},t.requireLabelCollection=function(){return c().then((e=>e.requireLabelCollection()))},t.requireChatCollection=function(){return c().then((e=>e.requireChatCollection()))},t.requireMsgCollection=function(){return c().then((e=>e.requireMsgCollection()))},t.requireStickerPackCollection=function(){return c().then((e=>e.requireStickerPackCollection()))},t.requireVoip=function(){return c().then((e=>e.requireVoip()))},t.requireSetHandlers=function(){return c().then((e=>e.requireSetHandlers()))};var n=a(r(19976)),i=a(r(25291)),s=a(r(12489)),o=a(r(82195));function u(){var e=(0,n.default)(["Assertion failed!"]);return u=function(){return e},e}function l(){var e=(0,n.default)(["failed to load main bundle"]);return l=function(){return e},e}var d={minTimeout:1e3,maxTimeout:12e4,retries:1/0,signal:(new s.default).signal};var c=(0,i.default)((function(){return(0,o.default)(d,((e,t)=>Promise.all([r.e(2101),r.e(7964)]).then(r.bind(r,65268)).catch((r=>(__LOG__(3)(l()),10===t&&(__LOG__(4,void 0,new Error,!0)(u()),SEND_LOGS("failed to load main bundle")),e(r))))))}))},46023:(e,t,r)=>{"use strict";var a=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){if(String.prototype.normalize)return Promise.resolve();return Promise.loop(((e,t,a)=>{var s=(0,n.delayMs)(i.expBackoff(a,12e4,1e3,.1));return r.e(6110).then(r.t.bind(r,58216,23)).then((()=>e())).catch((()=>s))}))};var n=r(91460),i=a(r(82885))},28148:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(74489)),i=a(r(28267));function s(e){return e instanceof i.default}t.default=class{constructor(e,t,r,a,i){this._hasEngaged=!1,this._hasDisengaged=!1,this.source=e,this.cb=r,this.capture=a,this._cbIdentifier=i,s(e)||"function"==typeof e.on?this.event=t:this.event=n.default.prefix(t,e)}engage(){if(!this._hasEngaged&&!this._hasDisengaged){this._hasEngaged=!0;var e=this.source,t=this.event;s(e)||"function"==typeof e.on?(e.on(t,this.cb),"function"==typeof e.incObservers&&e.incObservers()):this.capture?e.addEventListener(t,this.cb,this.capture):e.addEventListener(t,this.cb)}}disengage(){if(!this._hasDisengaged&&(this._hasDisengaged=!0,this._hasEngaged)){var e=this.source,t=this.event;s(e)||"function"==typeof e.off?(e.off(this.event,this.cb),"function"==typeof e.decObservers&&e.decObservers()):this.capture?e.removeEventListener(t,this.cb,this.capture):e.removeEventListener(t,this.cb)}}represents(e,t,r,a){if(this.source!==e)return!1;if(this.event!==t)return!1;if(this._cbIdentifier!==r)return!1;if(a&&"object"==typeof a){var n=this.capture;return!(!n||"object"!=typeof n)&&(n.passive===a.passive&&n.capture===a.capture)}return this.capture===a}}},85943:(e,t,r)=>{"use strict";var a=r(14859),n=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(r(2784)),s=a(r(65556)),o=a(r(17957)),u=a(r(41967)),l=a(r(2825)),d=a(r(78135));class c extends i.Component{componentDidMount(){d.default.restart(!0).then((()=>{d.default.restart()}))}render(){return i.createElement(u.default,{cover:!0,title:o.default.t(1438)},i.createElement("div",null,o.default.t(1437)),i.createElement("div",{className:s.default.pending},i.createElement(l.default,{stroke:4,size:40,color:"highlight"})))}}c.displayName="ClientExpiredDialog";var f=c;t.default=f},9386:(e,t,r)=>{"use strict";var a=r(14859),n=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(r(2784)),s=a(r(64)),o=a(r(44343)),u=a(r(17957)),l=a(r(41967));class d extends i.Component{constructor(...e){super(...e),this._setRefEl=e=>{this._refEl=e},this.onOK=e=>{e.stopPropagation(),e.preventDefault(),this.props.onOK&&this.props.onOK()},this.onCancel=e=>{e.stopPropagation(),e.preventDefault(),this.props.onCancel&&this.props.onCancel()}}getElement(){this._refEl}render(){var e=this.props.onOK?i.createElement(s.default,{a8nText:"popup-controls-ok",type:"primary",onClick:this.onOK,disabled:this.props.okDisabled,spinner:!0===this.props.okSpinner},this.props.okText||u.default.t(1761)):null,t=this.props.onCancel?i.createElement(s.default,{a8nText:"popup-controls-cancel",type:this.props.onOK?"secondary":"primary",onClick:this.onCancel},this.props.cancelText||u.default.t(1593)):null,r={escape:this.props.onCancel?this.onCancel:()=>{}},a=i.createElement(i.Fragment,null,t,e);return i.createElement(o.default,{handlers:r,onRef:this._setRefEl},i.createElement(l.default,{actions:a,children:this.props.children,cover:this.props.cover,onDragChange:this.props.onDragChange,onDrop:this.props.onDrop,type:this.props.type,title:this.props.title}))}}t.default=d,d.displayName="ConfirmPopup"},26147:(e,t,r)=>{"use strict";var a=r(14859),n=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(r(2784)),s=a(r(9386));class o extends i.Component{render(){return i.createElement(s.default,{cover:!0,children:this.props.children,cancelText:this.props.cancelText,onCancel:this.props.onCancel,okText:this.props.okText,onOK:this.props.onOK})}}t.default=o,o.displayName="Conflict"},34563:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(r(70417)),s=r(91460),o=a(r(2784)),u=n(r(79711)),l=n(r(82486)),d=a(r(6048)),c=n(r(69731)),f=r(93081),p=n(r(12767)),h=r(28103).Mirrored(["INITIAL_LOAD","CONNECTING","FAKE_FILL","DOWNLOADING","ORGANIZING"]),_=r(28103).Mirrored(["NOT_STARTED","STARTED","PAST_MIN_TIME"]),m=({onReady:e,initialLoadReady:t})=>{var r=(0,c.default)(),a=o.useRef(!1),[n,m]=o.useState(t?d.Stage.CONNECTING:d.Stage.INITIAL_LOAD),[g,v]=o.useState({INITIAL_LOAD:t?_.PAST_MIN_TIME:_.NOT_STARTED,CONNECTING:_.NOT_STARTED,FAKE_FILL:_.NOT_STARTED,DOWNLOADING:_.NOT_STARTED,ORGANIZING:_.NOT_STARTED}),[E,y]=o.useState(0),[S,T]=o.useState(null);(0,f.useListener)(u.default,"offline_progress_update",(()=>{g.CONNECTING===_.PAST_MIN_TIME&&y(l.default.getOfflineDeliveryProgress());var e=l.default.getHasMessagesToDownload();null==S&&null!=e&&T(e)}));var b=o.useCallback(((e,t)=>(v((t=>(0,i.default)((0,i.default)({},t),{},{[e]:_.STARTED}))),(0,s.delayMs)(t).then((()=>{r()&&v((t=>(0,i.default)((0,i.default)({},t),{},{[e]:_.PAST_MIN_TIME})))})))),[r]);o.useEffect((()=>{t?b(h.CONNECTING,1500):b(h.INITIAL_LOAD,500)}),[]);var{CONNECTING:A,DOWNLOADING:C,ORGANIZING:P,FAKE_FILL:O,INITIAL_LOAD:w}=g;return o.useEffect((()=>{if(A===_.STARTED||P===_.STARTED||C===_.STARTED||O===_.STARTED);else if(P===_.PAST_MIN_TIME)a.current||(e(),a.current=!0);else if(C===_.PAST_MIN_TIME&&E>=100&&P===_.NOT_STARTED)(0,s.delayMs)(450).then((()=>{r()&&(m(d.Stage.ORGANIZING),b(h.ORGANIZING,800))}));else if(A===_.PAST_MIN_TIME&&null!=S&&C===_.NOT_STARTED&&O===_.NOT_STARTED){var n=l.default.getFinishedDownloading();S&&!n?(m(d.Stage.DOWNLOADING),y(l.default.getOfflineDeliveryProgress()),b(h.DOWNLOADING,450)):(y(100),b(h.FAKE_FILL,450).then((()=>{p.default.hasSynced?a.current||e():(m(d.Stage.ORGANIZING),b(h.ORGANIZING,800))})))}else t&&w===_.PAST_MIN_TIME&&A===_.NOT_STARTED?(m(d.Stage.CONNECTING),b(h.CONNECTING,1500)):w===_.NOT_STARTED&&b(h.INITIAL_LOAD,500)}),[E,e,S,b,r,t,A,C,P,O,w]),o.useMemo((()=>o.createElement(d.default,{stage:n,progress:E,theme:"resume"})),[n,E])};m.displayName="DebouncedLoadingScreen";var g=m;t.default=g},52645:(e,t,r)=>{"use strict";var a=r(14859),n=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(r(2784)),s=a(r(9386)),o=a(r(17957)),u=a(r(12767));t.default=()=>i.createElement(s.default,{cover:!0,cancelText:o.default.t(968),onCancel:u.default.logout.bind(u.default,!0),okText:o.default.t(918),onOK:u.default.poke.bind(u.default)},o.default.t(1176))},62262:(e,t,r)=>{"use strict";var a=r(14859),n=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(r(2784)),s=a(r(16261));class o extends i.PureComponent{constructor(...e){super(...e),this.state={isDragging:!1,fromDrop:!1,blockDrop:!1},this.onDragStart=()=>{this.props.disableFromWithin&&this.setState({blockDrop:!0})},this.onDragEnd=()=>{this.props.disableFromWithin&&this.setState({blockDrop:!1})},this.onDrop=e=>{e.preventDefault(),e.stopPropagation(),this.setState({isDragging:!1,fromDrop:!0}),this.props.onDrop&&!this.state.blockDrop&&this.props.onDrop(e)},this.onDragOver=e=>{e.preventDefault(),e.stopPropagation(),this.state.isDragging||this.state.blockDrop||(this.setState({isDragging:!0,fromDrop:!1}),function(e){if(e.dataTransfer){try{if(!e.dataTransfer.dropEffect)return}catch(e){return}e.dataTransfer.effectAllowed&&(e.nativeEvent.dataTransfer.dropEffect="copy")}}(e))},this.onDragLeave=e=>{e.preventDefault(),e.stopPropagation(),this.state.isDragging&&this.setState({isDragging:!1,fromDrop:!1})}}componentDidUpdate(e,t){var{isDragging:r,fromDrop:a}=this.state,{onDragChange:n}=this.props;t.isDragging!==r&&n&&n(r,a)}render(){return i.createElement("div",{key:"mask",className:s.default.mask,style:this.state.isDragging?{}:{display:"none"},onDragLeave:this.onDragLeave,onDrop:this.onDrop})}}t.default=o,o.displayName="DragAndDrop"},6048:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.Stage=void 0;var i=n(r(72779)),s=a(r(2784)),o=n(r(17957)),u=n(r(81524)),l=n(r(17241)),d=n(r(81256)),c=r(28103).Mirrored(["INITIAL_LOAD","CONNECTING","DOWNLOADING","ORGANIZING"]);t.Stage=c;var f=e=>{s.useEffect((()=>{var e=document.getElementById("initial_startup");e&&e.parentNode&&e.parentNode.removeChild(e)}),[]);var t,r=e.stage===c.INITIAL_LOAD,a=(0,i.default)(l.default.container,{[l.default.themeResume]:"resume"===e.theme,[l.default.containerFixed]:!e.debug,[l.default.initialLoad]:r}),n=e.stage===c.ORGANIZING,f=e.stage===c.DOWNLOADING,_=(0,i.default)(l.default.graphic,{[l.default.organizing]:n,[l.default.shimmering]:r||n}),m=(0,i.default)(l.default.warning,{[l.default.showWarning]:f});switch(e.stage){case c.INITIAL_LOAD:t=o.default.t(1912);break;case c.CONNECTING:t=o.default.t(531);break;case c.DOWNLOADING:t=s.createElement(u.default,{id:936,params:{progress:e.progress}});break;case c.ORGANIZING:t=o.default.t(1166)}return s.createElement("div",{className:a},s.createElement("div",{className:_},s.createElement(p,null)),s.createElement("div",{className:l.default.progress},s.createElement(d.default,{value:e.progress,max:100})),s.createElement("div",{className:l.default.main},t),s.createElement("div",{className:l.default.secondary},s.createElement(h,null)," ",o.default.t(601)),s.createElement("div",{className:m},o.default.t(937)))};f.displayName="LoadingScreen";var p=()=>s.createElement("span",null,s.createElement("svg",{width:"250px",height:"52px",viewBox:"0 0 250 52",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},s.createElement("g",{className:l.default.dots},s.createElement("circle",{fill:"#B6B6B6",cx:"65.7636689",cy:"21.1046108",r:"3.65625"}),s.createElement("circle",{fill:"#B6B6B6",cx:"81.0791876",cy:"19.3283142",r:"3.65625"}),s.createElement("circle",{fill:"#B6B6B6",cx:"96.3947063",cy:"17.7846275",r:"3.65625"}),s.createElement("circle",{fill:"#B6B6B6",cx:"111.710225",cy:"17.5274031",r:"3.65625"}),s.createElement("circle",{fill:"#B6B6B6",cx:"127.025744",cy:"17.6118619",r:"3.65625"}),s.createElement("circle",{fill:"#B6B6B6",cx:"142.341262",cy:"18.4196288",r:"3.65625"}),s.createElement("circle",{fill:"#B6B6B6",cx:"157.656781",cy:"19.9893339",r:"3.65625"}),s.createElement("circle",{fill:"#B6B6B6",cx:"172.9723",cy:"22.0657859",r:"3.65625"})),s.createElement("path",{className:l.default.laptop,d:"M190.14097 4.7518926h48.227869l.281462-.00596781c1.058365-.00288774 2.664865.25185461 2.695721 2.87464716.142823 12.13996425 0 22.28077555 0 34.40910725 0 .06028-.024112.168784-.036168.217008l-16.394805-.0086927c-12.47317.0007215-24.136918.0136044-37.78743-.0033633l-.010915-6.2953341c-.030319-9.5718533-.105914-18.2714581.010915-28.31872515.033356-2.86867935 1.976535-2.91690333 3.013351-2.86867935zm20.097267 4.28597465l-19.256815-.00079524.002426 4.98254029c-.000422 6.5558423-.012657 12.8111695-.002954 19.3619492l.011919 4.9777941h46.536157l.008754-4.9777414c.010547-8.1882109.002637-15.913459.002637-24.3331514l-27.302124-.01059555zM179.195421 44.6572387c.397848-.036168.807752-.024112 1.2056-.024112 9.620684 0 19.241369-.012056 28.862053 0 .132616.4701838.54252 1.6393289 1.036816 1.6393289 3.255119.012056 4.510238 0 7.765357 0 .542519.036168.988591-1.1450331 1.133263-1.6513849 9.910029 0 19.820057.012056 29.730086.012056.084392.012056.265232.036168.349624.048224-.016075.2571945-.016075 1.0085894 0 2.2541846 0 1.4209691-1.193544 1.8201689-1.965128 2.1215688-.421959.1205599-.868031.1326159-1.289991.1928959h-63.560505c-.651024-.072336-1.350272-.108504-1.916904-.4701838-.566631-.2893439-1.000647-.7595278-1.350271-1.2779356v-2.8446419z",fill:"currentColor"}),s.createElement("path",{className:l.default.logo,d:"M37.7314595,31.1612046 C37.0876293,30.8391042 33.9223475,29.2816062 33.332139,29.0666255 C32.7419305,28.8517683 32.3127104,28.7444016 31.8834903,29.3887258 C31.4542703,30.0332973 30.2204788,31.4835521 29.8447567,31.91339 C29.4692818,32.3428571 29.0936834,32.3968494 28.4499768,32.0745019 C27.8060232,31.7521544 25.7314595,31.0723707 23.272278,28.8787027 C21.3582085,27.171583 20.0661004,25.0632896 19.6905019,24.4185946 C19.315027,23.7741467 19.6505946,23.4257297 19.9729421,23.1046178 C20.2625483,22.8161235 20.6167722,22.352556 20.9386255,21.9767104 C21.2606023,21.6007413 21.3678456,21.3320154 21.5824556,20.9026718 C21.7970657,20.472834 21.6898224,20.0968649 21.528834,19.7746409 C21.3678456,19.452417 20.0801853,16.2831815 19.543722,14.993915 C19.0210965,13.7387491 18.4903166,13.9087567 18.0950733,13.8887413 C17.7199691,13.870085 17.2902548,13.8661313 16.8611583,13.8661313 C16.4319382,13.8661313 15.7343629,14.0272433 15.144278,14.6716911 C14.5540695,15.3163861 12.8908108,16.8740077 12.8908108,20.0429961 C12.8908108,23.2121081 15.1978996,26.2734826 15.5198765,26.7031969 C15.8417297,27.1330348 20.0597992,33.6360772 26.5184865,36.4250193 C28.05461,37.0883707 29.2539305,37.4846023 30.1888494,37.7811274 C31.7312742,38.2713822 33.1348263,38.2021931 34.2440772,38.0363861 C35.4810811,37.8515521 38.0533127,36.478888 38.5898996,34.9750116 C39.1263629,33.470888 39.1263629,32.1818687 38.9653745,31.91339 C38.8045097,31.6447876 38.3752896,31.4835521 37.7314595,31.1612046 M25.9838765,47.2013591 L25.9752278,47.2013591 C22.1322625,47.1998763 18.3629343,46.1674749 15.0745946,44.2160926 L14.2926332,43.7519074 L6.18674906,45.8782394 L8.35027028,37.9751042 L7.84111198,37.1648494 C5.69723552,33.7549343 4.56500386,29.8139923 4.56660833,25.767166 C4.57130502,13.9587954 14.1789652,4.35187645 25.9924016,4.35187645 C31.7128649,4.35385328 37.0902239,6.58458689 41.1338378,10.6327722 C45.1773282,14.680834 47.4028724,20.0618996 47.4007737,25.7843398 C47.3959539,37.5936988 37.7882934,47.2013591 25.9838765,47.2013591 M44.2112742,7.556695 C39.3464092,2.68614672 32.8767258,0.00271814672 25.9836293,0 C11.7809421,0 0.221652509,11.5584247 0.215969112,25.7654363 C0.21411583,30.3069652 1.40058687,34.7397683 3.65553668,38.6475984 L-4.61852778e-14,52 L13.6596757,48.4167413 C17.4233205,50.4695597 21.6607876,51.5516293 25.9733745,51.5531121 L25.9838765,51.5531121 L25.984,51.5531121 C40.1852046,51.5531121 51.7456062,39.9934517 51.7512912,25.7860695 C51.7538842,18.9011274 49.0761392,12.4271197 44.2112742,7.556695",fill:"currentColor"}))),h=()=>s.createElement("span",null,s.createElement("svg",{width:"10px",height:"12px",viewBox:"0 0 10 12",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},s.createElement("path",{d:"M5.00847986,1.6 C6.38255462,1.6 7.50937014,2.67435859 7.5940156,4.02703389 L7.59911976,4.1906399 L7.599,5.462 L7.75719976,5.46214385 C8.34167974,5.46214385 8.81591972,5.94158383 8.81591972,6.53126381 L8.81591972,9.8834238 C8.81591972,10.4731038 8.34167974,10.9525438 7.75719976,10.9525438 L2.25767996,10.9525438 C1.67527998,10.9525438 1.2,10.4731038 1.2,9.8834238 L1.2,6.53126381 C1.2,5.94158383 1.67423998,5.46214385 2.25767996,5.46214385 L2.416,5.462 L2.41679995,4.1906399 C2.41679995,2.81636129 3.49135449,1.68973395 4.84478101,1.60510326 L5.00847986,1.6 Z M5.00847986,2.84799995 C4.31163824,2.84799995 3.73624912,3.38200845 3.6709675,4.06160439 L3.6647999,4.1906399 L3.663,5.462 L6.35,5.462 L6.35111981,4.1906399 C6.35111981,3.53817142 5.88169076,2.99180999 5.26310845,2.87228506 L5.13749818,2.85416626 L5.00847986,2.84799995 Z",fill:"currentColor"}))),_=f;t.default=_},8166:(e,t,r)=>{"use strict";var a=r(14859),n=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(r(2784)),s=a(r(17957)),o=a(r(71291)),u=a(r(2825)),l=r(40263),d=()=>i.createElement("div",{className:o.default.background},i.createElement("div",{className:o.default.mainWrapper},i.createElement(u.default,{size:50,stroke:4,color:"highlight"}),i.createElement(l.TextDiv,{className:o.default.logoutTitle,size:"32"},s.default.t(1724)),i.createElement(l.TextDiv,{theme:"muted"},s.default.t(1725))));d.displayName="LogoutLoadingScreen";var c=d;t.default=c},41967:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.TowerModalType=t.FlexModalType=t.BoxModalType=void 0;var i=n(r(45455)),s=n(r(72779)),o=a(r(2784)),u=n(r(32960)),l=n(r(96955)),d=n(r(62262)),c=n(r(87564)),f="box",p="flex",h="guide",_="tower",m="auto";class g extends o.PureComponent{constructor(...e){super(...e),this.setDragAndDropRef=e=>{this.dragAndDropRef=e},this.onDragOver=e=>{this.dragAndDropRef&&this.dragAndDropRef.onDragOver(e)},this.onDragStart=e=>{this.dragAndDropRef&&this.dragAndDropRef.onDragStart(e)},this.onDragEnd=e=>{this.dragAndDropRef&&this.dragAndDropRef.onDragEnd(e)}}render(){var e=this.props,t=null!=e.title?o.createElement("div",{"data-a8n":u.default.key("popup-title"),className:c.default.popupTitle},e.title):null,r=(0,s.default)(c.default.popup,{[c.default.popupFlexInvite]:"invite"===e.type,[c.default.popupBox]:e.type===f,[c.default.popupFlex]:e.type===p,[c.default.popupTower]:e.type===_,[c.default.popupAuto]:e.type===m}),a=(0,i.default)(e.actions)?null:o.createElement("div",{className:c.default.popupControls},e.actions),n=(0,s.default)("overlay",c.default.backdrop,{[c.default.backdropCover]:e.cover,[c.default.popupGuide]:e.type===h}),g=o.createElement("div",{className:c.default.popupContainer},o.createElement("div",{className:r,"data-animate-modal-popup":!0},o.createElement("div",{className:c.default.popupBody,"data-animate-modal-body":!0},t,o.createElement("div",{"data-a8n":u.default.key("popup-contents"),className:c.default.popupContents},e.children),a)));return o.createElement(l.default,{className:n,onDragOver:this.onDragOver,onDragStart:this.onDragStart,onDragEnd:this.onDragEnd,ref:e.onRef,"data-animate-modal-backdrop":!0},e.onDrop&&o.createElement(d.default,{ref:this.setDragAndDropRef,disableFromWithin:!0,onDragChange:e.onDragChange,onDrop:e.onDrop}),g)}}g.displayName="Modal";var v=f;t.BoxModalType=v;var E=p;t.FlexModalType=E;var y=_;t.TowerModalType=y;var S=g;t.default=S},4901:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.MediaType=t.ModalType=void 0;var i=n(r(23779)),s=n(r(74930)),o=a(r(2784)),u=n(r(79711)),l=n(r(6660)),d=n(r(20642)),c=n(r(64225)),f=n(r(92754)),p=n(r(17693)),h=n(r(5179)),_=n(r(74824)),m="modal",g="none",v="modal";t.ModalType=v;t.MediaType="media";class E extends o.Component{constructor(...e){super(...e),this.state={flow:void 0,modalId:null,transition:m,uim:void 0,blockClose:!1},this.setRefUIE=e=>{this.refUIE=e},this.openFlow=(e,t={})=>{var r=t.transition||m,{uim:a,blockClose:n}=t;this.state.flow&&(r=g);var i=(0,s.default)("ModalManager".concat(this.props.type)),u=e;this.props.type===v&&(u=o.cloneElement(e,{requestFocus:this._focusOnContainer})),this.setState({flow:u,modalId:i,transition:r,uim:a,blockClose:n})},this.closeFlow=e=>{if(this.state.flow){var t={flow:void 0,modalId:null};e&&(t.transition=e),this.setState(t)}},this.requestFocus=()=>{if(this.refUIE){var e=this.refUIE.getNode();e&&!e.contains(document.activeElement)&&l.default.focus(e)}},this._focusOnContainer=()=>{if(this.refUIE){var e=this.refUIE.getNode();e&&l.default.focus(e)}},this.requestDismiss=e=>{e===this.state.modalId&&this.closeFlow()},this.shouldRequestFocus=e=>{var t,r=e.relatedTarget,a=null===(t=this.props.contextMenuRef)||void 0===t?void 0:t.current,n=!!a&&a.getComponent().isOpen();return r instanceof HTMLElement&&!e.currentTarget.contains(r)&&!n},this._onBlurHandler=e=>{this.shouldRequestFocus(e)&&this.requestFocus()}}componentDidMount(){this.props.listeners.add(u.default,"open_".concat(this.props.type),this.openFlow),this.props.listeners.add(u.default,"close_".concat(this.props.type),this.closeFlow)}componentDidUpdate(e){e.type!==this.props.type&&(e.listeners.remove(u.default,"open_".concat(e.type),this.openFlow),e.listeners.remove(u.default,"close_".concat(e.type),this.closeFlow),this.props.listeners.add(u.default,"open_".concat(this.props.type),this.openFlow),this.props.listeners.add(u.default,"close_".concat(this.props.type),this.closeFlow))}render(){var{flow:e,modalId:t,transition:r,blockClose:a}=this.state;return e&&(e=o.createElement(p.default,{displayName:"Modal".concat((0,i.default)(this.props.type)),escapable:!a,key:t,ref:this.setRefUIE,requestFocus:this.requestFocus,requestDismiss:this.requestDismiss.bind(null,t)},this.props.type===v?o.createElement(f.default,{onBlur:this._onBlurHandler},e):o.createElement(c.default,null,e))),o.createElement(h.default.Consumer,null,(t=>o.createElement(h.default.Provider,{value:this.state.uim||t},o.createElement(_.default,{transitionName:r},e))))}}E.displayName="ModalManager";var y=(0,d.default)(E);t.default=y},63576:(e,t,r)=>{"use strict";var a=r(14859),n=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(r(2784)),s=a(r(17957)),o=a(r(41967));t.default=()=>i.createElement(o.default,{title:s.default.t(511),cover:!0},s.default.t(930))},11719:(e,t,r)=>{"use strict";var a=r(14859),n=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(r(2784)),s=a(r(9386)),o=r(35387),u=r(95585),l=a(r(17957));function d(){(0,o.openExternalLink)((0,u.getCannotConnectFaqUrl)())}t.default=()=>i.createElement(s.default,{cover:!0,title:l.default.t(413),okText:l.default.t(875),onOK:d},l.default.t(510))},79583:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(r(19976)),s=n(r(98874)),o=n(r(19034)),u=a(r(2784)),l=n(r(9386)),d=r(35387),c=r(95585),f=n(r(17957)),p=n(r(20642)),h=a(r(6048)),_=n(r(16656)),m=a(r(17026)),g=n(r(67134)),v=n(r(12767));function E(){var e=(0,i.default)(["Startup: user selected logout"]);return E=function(){return e},e}class y extends u.PureComponent{constructor(e){super(e),this._forceUpdate=()=>{this.forceUpdate()},this._retried=()=>{null!=this.timeout&&(this.props.clearTimeout(this.timeout),this.timeout=null),null!=this.interval&&(this.props.clearInterval(this.interval),this.interval=null),this.setState({retriable:!1}),this.startTimeout()},this._allowRetry=()=>{this.setState({retriable:!0}),this.interval=this.props.setInterval(this._forceUpdate,1e3)},this.retry=()=>{v.default.poke(),this._retried()},this._onLearnMoreClick=()=>{(0,d.openExternalLink)((0,c.getCannotConnectFaqUrl)())},this.state={retriable:!1}}componentDidMount(){this.startTimeout();var e=document.getElementById("initial_startup");e&&e.parentNode&&e.parentNode.removeChild(e),this.props.listeners.add(m.default,"change:displayInfo",this._forceUpdate),this.props.listeners.add(v.default,"change:retryTimestamp",this._retried)}startTimeout(){this.timeout=this.props.setTimeout(this._allowRetry,3e3)}logout(){__LOG__(2)(E()),v.default.logout()}render(){var e,t,r,a,{progress:n}=this.props;switch(m.default.displayInfo){case m.StreamInfo.OPENING:e=f.default.t(532),t=f.default.t(930),a=this.logout;break;case m.StreamInfo.PAIRING:case m.StreamInfo.TIMEOUT:e=f.default.t(1401),t=u.createElement("span",null,f.default.t(931),"",u.createElement("span",{className:_.default.action,onClick:this._onLearnMoreClick,role:"button"},f.default.t(875))),a=this.logout;break;case m.StreamInfo.SYNCING:case m.StreamInfo.CONNECTING:return u.createElement(h.default,{theme:"resume",progress:n,stage:h.Stage.INITIAL_LOAD});default:return m.default.mode===m.StreamMode.MAIN?u.createElement(h.default,{theme:"resume",progress:n,stage:h.Stage.INITIAL_LOAD}):null}var i=this.state.retriable;if(i){var d=v.default.retryTimestamp-Date.now();if(isNaN(d)||d<1)r=f.default.t(1260),(0,s.default)((()=>v.default.poke()));else if(d<6e4){var c=Math.ceil(d/1e3);r=f.default.t(1262,{number:c,_plural:c})}else r=f.default.t(1261,{duration:o.default.duration(d).humanize()})}else r=f.default.t(1260);return u.createElement(l.default,{cover:!0,title:e,okText:f.default.t(1258),onOK:i?this.retry:()=>{},cancelText:a?f.default.t(968):null,onCancel:a},r,u.createElement("hr",{className:_.default.divider}),u.createElement("div",{className:_.default.textTip},t))}}y.displayName="Startup";var S=(0,g.default)((0,p.default)(y));t.default=S},28193:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(r(19976)),s=a(r(2784)),o=n(r(64)),u=n(r(9386)),l=n(r(17957)),d=n(r(20642)),c=n(r(81256)),f=n(r(2825)),p=n(r(42803)),h=a(r(17026)),_=n(r(67134)),m=n(r(12767));function g(){var e=(0,i.default)(["Startup: user selected logout"]);return g=function(){return e},e}class v extends s.PureComponent{constructor(e){super(e),this._forceUpdate=()=>{this.forceUpdate()},this._startInerval=()=>{this.interval=this.props.setInterval(this._forceUpdate,1e3)}}componentDidMount(){this.startTimeout();var e=document.getElementById("initial_startup");e&&e.parentNode&&e.parentNode.removeChild(e),this.props.listeners.add(h.default,"change:displayInfo",this._forceUpdate)}startTimeout(){this.timeout=this.props.setTimeout(this._startInerval,6e3)}logout(){__LOG__(2)(g()),m.default.logout()}render(){var e,t,{progress:r}=this.props;switch(h.default.displayInfo){case h.StreamInfo.OPENING:case h.StreamInfo.PAIRING:case h.StreamInfo.TIMEOUT:e=l.default.t(532),t=l.default.t(930);break;case h.StreamInfo.SYNCING:case h.StreamInfo.CONNECTING:return s.createElement("div",{id:"startup"},s.createElement(f.default,{size:50,stroke:4}),s.createElement("div",{className:p.default.progress},s.createElement(c.default,{key:"progress_bar",value:r})),s.createElement(o.default,{className:p.default.logoutBtn,type:"primary",onClick:this.logout},l.default.t(968)));default:return h.default.mode===h.StreamMode.MAIN?s.createElement("div",{id:"startup"},s.createElement(f.default,{size:50,stroke:4}),s.createElement("div",{className:p.default.progress},s.createElement(c.default,{key:"progress_bar",value:r})),s.createElement(o.default,{className:p.default.logoutBtn,type:"primary",onClick:this.logout},l.default.t(968))):null}return s.createElement(u.default,{cover:!0,title:e,cancelText:l.default.t(968),onCancel:this.logout},undefined,s.createElement("hr",{className:p.default.divider}),s.createElement("div",{className:p.default.textTip},t))}}v.displayName="StartupMd";var E=(0,_.default)((0,d.default)(v));t.default=E},50198:(e,t,r)=>{"use strict";var a=r(14859),n=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(r(2784)),s=a(r(9386)),o=a(r(17957)),u=a(r(12767));class l extends i.Component{render(){return i.createElement(s.default,{cover:!0,cancelText:o.default.t(968),onCancel:u.default.logout.bind(u.default,!0),okText:o.default.t(918),onOK:u.default.poke.bind(u.default)},this.props.description,"",this.props.children)}}l.displayName="TOS";var d=l;t.default=d},19655:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);t.HC=function(e,t,a,n,i){if(c.some((({partialUserAgent:t,partialMsg:r})=>f.includes(t)&&String(e).includes(r))))return __LOG__(3)(d(),e||(i||"").toString()),!0;try{r(20398).default.pprint(!0)}catch(e){__LOG__(3)(l())}var o;o=t&&"number"==typeof a?" (".concat(t,":").concat(a,":").concat(n,")"):t?" (".concat(t,")"):"";if("Script error."===e&&!i)return u.default.logUncaughtError("".concat(o," ").concat(e)),t&&s.upload({reason:"script-error",hasTaggedMessage:!0}),!1;var h=i instanceof Error&&i.stack?i:"".concat(e||"Given: ".concat(String(i)));if(u.default.logUncaughtError(h),!p(i))return!0;return s.upload({reason:null,hasTaggedMessage:!0}),!0},t.e2=function(e,t){if(u.default.logUncaughtError(e,t),!p(e))return;var r=e instanceof Error&&e.stack?null:"unhandled-rejection: ".concat(e);s.upload({reason:r,hasTaggedMessage:!0})};var i=n(r(19976)),s=a(r(3594)),o=r(96452),u=n(r(15410));function l(){var e=(0,i.default)(["UIM Print Failed!"]);return l=function(){return e},e}function d(){var e=(0,i.default)(["Ignored Error: ",""]);return d=function(){return e},e}var c=[{partialUserAgent:"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/60.0.3112.113 Safari/537.36",partialMsg:"Cannot read property 'style' of null"},{partialUserAgent:"Mozilla/5.0 (Windows NT 6.2; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/60.0.3112.78 Safari/537.36",partialMsg:"Unexpected token :"},{partialUserAgent:"Firefox/52.0,,Mozilla/5.0 (X11; U; Linux i686; en-US; rv:1.9.0.4) Gecko/20100101 Firefox/52.0",partialMsg:"Cannot read property 'style' of undefined"},{partialUserAgent:"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_5) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.1.1 Safari/605.1.15",partialMsg:"is not an object"},{partialUserAgent:"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/60.0.3112.113 Safari/537.36",partialMsg:"Cannot read property 'getElementsByTagName' of undefined"},{partialUserAgent:"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/67.0.3396.99 Safari/537.36",partialMsg:"Can't find variable: dismissKeyboard"},{partialUserAgent:"Mozilla/5.0 (Windows NT 6.2; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/60.0.3112.78 Safari/537.36",partialMsg:"ReferenceError: None is not defined"},{partialUserAgent:"Chrome",partialMsg:"ResizeObserver loop limit exceeded"}],f=window.navigator.userAgent;function p(e){return!(e instanceof o.DbOnLogoutAbort)}},2220:(e,t,r)=>{"use strict";var a=r(14859),n=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.getTheme=function(){var e;if(c())return u.default.currentTheme;return null!==(e=(0,o.getTheme)())&&void 0!==e?e:s.default.DEFAULT_THEME},t.setTheme=d,t.getSystemThemeMode=c,t.setSystemThemeMode=f,t.applyThemeToUI=p,t.default=t.THEME_ASSETS=void 0;var i=n(r(2784)),s=a(r(50935)),o=r(95595),u=a(r(94984)),l={light:[{id:"bg-chat-light",selectors:["[data-asset-chat-background-light]"],low:{default:r(84184)},high:{default:r(84184)}},{id:"bg-chat-dark",selectors:["[data-asset-chat-background-dark]"],low:{default:r(69285)},high:{default:r(69285)}},{id:"intro-connection-light",selectors:["[data-asset-intro-image-light]"],low:{default:r(19303)},high:{default:r(47890)}}],dark:[{id:"bg-chat-dark",selectors:["[data-asset-chat-background-dark]"],low:{default:r(69285)},high:{default:r(69285)}},{id:"intro-connection-dark",selectors:["[data-asset-intro-image-dark]"],low:{default:r(68141)},high:{default:r(55175)}}]};function d(e){(0,o.setTheme)(e),p(e)}function c(){var e;return null===(e=(0,o.getSystemThemeMode)())||void 0===e||e}function f(e){(0,o.setSystemThemeMode)(e)}function p(e){var t=document.body;t&&("dark"===e?t.classList.add("dark"):t.classList.remove("dark"))}t.THEME_ASSETS=l;var h={theme:u.default.currentTheme,systemThemeMode:!0,setTheme:d,setSystemThemeMode:f},_=i.createContext(h);t.default=_},26360:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.ATTACH_MEDIA_STATE=void 0;var i=n(r(19976)),s=n(r(70417)),o=a(r(61247)),u=a(r(96452)),l=r(99888),d=r(28278),c=n(r(97626)),f=n(r(40210)),p=r(27e3),h=n(r(25012));r(59420);function _(){var e=(0,i.default)(["AttachMedia:processFile convert unexpected error to InvalidMediaFileType:"]);return _=function(){return e},e}function m(){var e=(0,i.default)(["Invariant violated, processed file is not previewable"]);return m=function(){return e},e}var g={READY:"ready",PROCESSING:"processing",ERROR:"error"};t.ATTACH_MEDIA_STATE=g;class v extends o.default{constructor(...e){super(...e),this.id=(0,o.prop)(),this.file=(0,o.prop)(),this.uiProcessed=(0,o.prop)(!1),this.fileOrigin=(0,o.prop)(),this.isVcardOverMmsDocument=(0,o.prop)(!1),this.state=(0,o.session)(),this.mediaPrep=(0,o.session)(),this.mimetype=(0,o.session)(),this.originalMimetype=(0,o.session)(),this.processPromise=(0,o.session)(),this.exception=(0,o.session)(),this.caption=(0,o.session)(),this.type=(0,o.session)(p.TYPE.UNKNOWN),this.mediaEditorData=(0,o.session)(),this.editedFile=(0,o.session)(),this._mediaEditorUndoStack=(0,o.session)((()=>[])),this._mediaEditorRedoStack=(0,o.session)((()=>[])),this.preview=(0,o.session)(),this.fullPreview=(0,o.session)(),this.fullPreviewSize=(0,o.session)(),this.filename=(0,o.session)(),this.documentPageCount=(0,o.session)(),this.isGif=(0,o.session)(),this.gifAttribution=(0,o.session)(),this.previewable=(0,o.derived)(this._previewable,["preview","fullPreview","type","filename","fullPreviewSize","mimetype"]),this.filesize=(0,o.derived)(this._filesize,["file"]),this.fileExt=(0,o.derived)(this._fileExt,["filename"])}_previewable(){if(!this.type||!this.mimetype||!this.fullPreview)return!1;switch(this.type){case p.TYPE.DOCUMENT:return!!this.filename;case p.TYPE.IMAGE:case p.TYPE.VIDEO:return!(!this.fullPreviewSize||!this.preview);case p.TYPE.AUDIO:case p.TYPE.PTT:case p.TYPE.UNKNOWN:return!0;default:throw new Error("Unsupported attach media type ".concat(this.type))}}_filesize(){return this.file instanceof h.default?this.file.size():this.file instanceof Blob?this.file.size:null}_fileExt(){return this.filename?(0,l.getFileExtension)(this.filename):null}initialize(){if(super.initialize(),!(this.file instanceof Promise))throw new Error("cannot process non-promise file");this.processAttachment(this.file)}processAttachment(e){this.state=g.PROCESSING,this.processPromise=this._processAttachmentPromiseHelper(e).then((()=>{}))}_processAttachmentData(e){if(this.fileOrigin===f.default.MEDIA_PICKER_ORIGIN_TYPE.CHAT_PHOTO_LIBRARY){var t=e.file.name;return(0,l.copyFile)(e.file).then((r=>(0,s.default)((0,s.default)({},e),{},{filename:t,file:r})))}return Promise.resolve(e)}_processAttachmentPromiseHelper(e){return e.then((e=>this._processAttachmentData(e))).then((e=>{this.set(e);var t={},{file:r,filename:a,isGif:n,gifAttribution:i,isVcardOverMmsDocument:s,documentPageCount:o}=e;n?(t.asGif=!0,t.gifAttribution=i):e.type===l.FILETYPE.DOCUMENT&&(t.asDocument=!0,t.filename=a,t.isVcardOverMmsDocument=s,t.documentPageCount=o),t.precomputedFields={fullHeight:e.fullPreviewSize?e.fullPreviewSize.height:void 0,fullWidth:e.fullPreviewSize?e.fullPreviewSize.width:void 0,preview:e.preview,duration:e.duration};var u=h.default.createFromData(r,r.type),c=(0,d.prepRawMedia)(u,t);return this.set({mediaPrep:c}),c.waitForPrep().then((t=>{var r=t.documentPreview,a=t.mediaBlob instanceof h.default?window.URL.createObjectURL(t.mediaBlob.forceToBlob()):window.URL.createObjectURL(t.mediaBlob),n={file:t.mediaBlob,fullPreview:a,type:t.type,filename:t.filename,mimetype:t.mimetype,originalMimetype:e.mimetype,preview:t.preview,state:g.READY,isGif:t.isGif,fullPreviewSize:void 0,documentPageCount:o,isVcardOverMmsDocument:t.isVcardOverMmsDocument};t.fullWidth&&t.fullHeight&&(n.fullPreviewSize={height:t.fullHeight,width:t.fullWidth}),t.type===p.TYPE.IMAGE&&(n.preview=a),t.type===p.TYPE.DOCUMENT&&r&&(n.fullPreview=r.url,n.preview=r.thumbUrl,n.fullPreviewSize={height:r.height,width:r.width},n.documentPageCount=r.pdfPages),this.set(n),this.previewable||(__LOG__(4,void 0,new Error,!0)(m()),SEND_LOGS("AttachMedia processFile"))}))})).catchTypes(u.InvalidMediaFileType,u.InvalidImageFileType,(t=>{if(this.isGif||this.type===l.FILETYPE.DOCUMENT)throw t;return this._processAttachmentPromiseHelper(e.then((e=>(e.type=l.FILETYPE.DOCUMENT,e))))})).catchTypes3(c.default,u.MediaFileFailedLoad,u.MediaFileEmpty,(e=>(this.set({exception:e,state:g.ERROR}),this))).catch((()=>(__LOG__(3)(_()),this.set({exception:new u.InvalidMediaFileType,state:g.ERROR}),this)))}sendToChat(e,t){if(!this.mediaPrep)return Promise.reject(new Error("MediaPrep not available"));if(this.state===g.ERROR)return Promise.reject(new Error(this.exception));if(!(this.state!==g.PROCESSING||this.previewable&&t.addEvenWhilePreparing))return Promise.reject(new Error("Media still processing"));if(this.state===g.READY)return this.mediaPrep.sendToChat(e,t);var r={mimetype:this.mimetype};switch(this.type){case p.TYPE.VIDEO:r.isGif=this.isGif,r.gifAttribution=this.gifAttribution;case p.TYPE.IMAGE:r.width=this.fullPreviewSize.width,r.height=this.fullPreviewSize.height,r.body=this.preview,t.placeholderProps=r;break;case p.TYPE.DOCUMENT:r.pageCount=this.documentPageCount,r.filename=this.filename,r.body=this.preview,t.placeholderProps=r;break;case p.TYPE.AUDIO:case p.TYPE.PTT:}return this.mediaPrep.sendToChat(e,t)}getFileType(){if(!(this.file instanceof Blob||this.file instanceof File))throw new Error("expected file to be a Blob or File");return(0,l.typeFromMimetype)(this.file.type)}isViewableOnce(){return new Set([p.TYPE.IMAGE,p.TYPE.VIDEO]).has(this.type)&&!this.isGif}delete(){this.fullPreview&&window.URL.revokeObjectURL(this.fullPreview),super.delete()}updateMediaEditorData(e,t){return this.mediaEditorData===e||(t.undoable&&(this._mediaEditorUndoStack.push(this.mediaEditorData),this._mediaEditorRedoStack=[]),this.mediaEditorData=e),this.mediaEditorData}undoMediaEditorData(){this.canUndoMediaEditorData()&&(this._mediaEditorRedoStack.push(this.mediaEditorData),this.mediaEditorData=this._mediaEditorUndoStack.pop())}redoMediaEditorData(){this.canRedoMediaEditorData()&&(this._mediaEditorUndoStack.push(this.mediaEditorData),this.mediaEditorData=this._mediaEditorRedoStack.pop())}canUndoMediaEditorData(){return this._mediaEditorUndoStack.length>0}canRedoMediaEditorData(){return this._mediaEditorRedoStack.length>0}updateEditedFile(e){this.editedFile=e}updatePreview(e){window.URL.revokeObjectURL(this.preview),this.preview=e}updateFullPreview(e){window.URL.revokeObjectURL(this.fullPreview),this.fullPreview=e}updateCaption(e){this.caption=e}}v.Proxy="attachMedia";var E=(0,o.defineModel)(v);t.default=E},36543:(e,t,r)=>{"use strict";var a=r(14859),n=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(r(26360)),s=a(r(54019)),o=a(r(50935)),u=n(r(96452)),l=r(99888),d=a(r(17957)),c=a(r(44422)),f=a(r(97626)),p=a(r(72424)),h=a(r(73664)),{IMAGE:_,VIDEO:m,DOCUMENT:g,AUDIO:v}=l.FILETYPE,{READY:E,ERROR:y,PROCESSING:S}=i.ATTACH_MEDIA_STATE,T=1;class b extends s.default{constructor({chatParticipantCount:e}){super(),this.errorMsgs=null,this.ignored=0,this.mediaPickerStatsLogger=new c.default,this.selection=new h.default([],(e=>e.id),"prev"),this.mediaPickerStatsLogger.chatRecipients=e,this.listenTo(this.selection,"all",this._handleSelectionEvents.bind(this))}_handleSelectionEvents(e,t){"focus"!==t&&!1!==t||this.trigger("active-change")}removeSingleton(e,t){e&&(t||this.mediaPickerStatsLogger.logDelete(e.id),e.url&&window.URL.revokeObjectURL(e.url),e.original&&e.original.url&&window.URL.revokeObjectURL(e.original.url))}remove(e,t){var r=super.remove(e,t);return r.forEach((e=>this.removeSingleton(e,t))),this.selection.init(this.getPreviewableMedias(),!0),r}delete(){super.delete(),this.forEach((e=>this.removeSingleton(e))),this.selection.init(this.getPreviewableMedias(),!0)}reorder(e,t){return this.reorderMutate(e,t),this.selection.init(this.getPreviewableMedias(),!0),this.getPreviewableMedias()}replace(e,t){var r=this.get(e);if(r){var a=this.indexOf(r),n=r.caption;this.remove(r,{silent:!0}),r.delete();var s=new i.default({id:e,caption:n,file:this._normalizeAttachment(t)});return this.add(s,a?{at:a}:{}),s.processPromise}}getValidMedias(){return this.filter((e=>e.state===E||e.state===S))}getPreviewableMedias(){return this.filter((e=>e.previewable))}getActive(){return this.selection.getVal()}setActive(e){this.selection.setVal(e)}unsetActive(){this.selection.unset()}setNextAsActive(){var e=this.selection.list.length-1;return-1===this.selection.index||this.selection.index===e||this.selection.setNext(),this.selection.getVal()}setPrevAsActive(){return-1===this.selection.index||0===this.selection.index||this.selection.setPrev(),this.selection.getVal()}processAttachments(e,t){var r=this.getPreviewableMedias().length,a=e.length+r>o.default.MAX_FILES?Math.max(o.default.MAX_FILES-r,0):e.length,n=e.length-a;0===a?n&&this.trigger("max_upload_limit",n):this.ignore(n);var s=e.slice(0,a).map((e=>new i.default({id:T++,file:this._normalizeAttachment(e),fileOrigin:t})));this.add(s);var u=this.getActive();return this.unsetActive(),Promise.all(e).then((()=>{this._attemptToSetNextActiveFromAdded(s,u)})),Promise.all(s.map((e=>e.processPromise))).then((()=>(s.forEach((e=>this._logMediaAdd(e,t))),this._attemptToSetNextActiveFromAdded(s,u))))}_attemptToSetNextActiveFromAdded(e,t){if(!this.getActive()&&!this.getModelsArray().some((e=>e.state===S&&!e.previewable))){var r=e.find((e=>e.previewable));r||(r=t),this.selection.init(this.getPreviewableMedias()),r&&this.setActive(r)}}_logMediaAdd(e,t){if(null!=t){var r=e.isGif?"gif":e.type;this.mediaPickerStatsLogger.logAdd(e.id,r,t)}}_normalizeAttachment(e){return Promise.resolve(e).then((e=>(e.filename||(e.filename=e.file.name),e.mimetype||(e.mimetype=e.file.type),e.type||(e.type=(0,l.typeFromMimetype)(e.file.type)),!e.type&&e.mimetype&&(e.type=(0,l.typeFromMimetype)(e.mimetype)),e)))}ignore(e){e>0&&(this.ignored+=e)}uiProcessMsgs(){var e,t=[],r=0,a=0,n=0,i=0,s=0,l=0,c=0,h=0,E=0,T=0,b=0,A=!1,C=d.default.filesize(p.default.media),P=d.default.filesize(p.default.maxFileSize),O=d.default.filesize(1024*p.default.vcardMaxSizeKb);if(this.forEach((t=>{if(!t.uiProcessed&&(!e&&t.previewable&&(e=t),t.state!==S&&(t.uiProcessed=!0,t.state===y)))if(t.exception instanceof f.default)switch(t.getFileType()){case _:r+=1;break;case m:a+=1;break;case v:n+=1;break;case g:t.isVcardOverMmsDocument?s+=t.documentPageCount:i+=1}else if(t.exception instanceof u.MediaFileEmpty)switch(t.getFileType()){case _:l+=1;break;case m:c+=1;break;case v:h+=1;break;case g:t.isVcardOverMmsDocument?T+=t.documentPageCount:E+=1}else t.exception instanceof u.MediaFileFailedLoad?A=!0:b+=1})),r>0&&t.push(d.default.t(842,{number:r,_plural:r,maxSize:C})),a>0&&t.push(d.default.t(1466,{number:a,_plural:a,maxSize:C})),n>0&&t.push(d.default.t(250,{number:n,_plural:n,maxSize:C})),i>0&&t.push(d.default.t(590,{number:i,_plural:i,maxSize:P})),s>0&&t.push(d.default.t(541,{_plural:s,maxSize:O})),l>0&&t.push(d.default.t(834,{number:l,_plural:l})),c>0&&t.push(d.default.t(1464,{number:c,_plural:c})),h>0&&t.push(d.default.t(245,{number:h,_plural:h})),E>0&&t.push(d.default.t(589,{number:E,_plural:E})),T>0&&t.push(d.default.t(540,{number:T,_plural:T})),b>0&&t.push(d.default.t(701,{number:b,_plural:b})),A&&(t=[]).push(d.default.t(959)),t.length>1){t=[];var w=r+a+n+i,M=l+c+h+E,I=w+M+b;0===b?(0!==w&&t.push(d.default.t(702,{number:w,_plural:w,maxSize:P})),0!==M&&t.push(d.default.t(698,{number:M,_plural:M}))):t.push(d.default.t(700,{number:I,_plural:I}))}var R=t.join(" ");this.errorMsgs=R,this.ignore(this.getPreviewableMedias().length-o.default.MAX_FILES);var D=this.ignored;return this.ignored=0,D&&this.trigger("max_upload_limit",D),b>0&&this.trigger("files_not_supported"),{errorMsgs:R}}canSend(){return!this.getModelsArray().some((e=>e.state===S&&!e.previewable))}}t.default=b,b.model=i.default},64329:(e,t,r)=>{"use strict";var a=r(14859),n=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(r(61247)),s=a(r(68384));class o extends i.default{constructor(...e){super(...e),this.id=(0,i.prop)()}contact(){return r(7470).default.gadd(this.id)}getCollection(){return r(79148).default}}o.Proxy="blocklist",o.idClass=s.default;var u=(0,i.defineModel)(o);t.default=u},79148:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.BlocklistCollection=void 0;var n=a(r(54019)),i=a(r(64329));class s extends n.default{constructor(){super(),this.listenTo(this,"add",this.blockContact),this.listenTo(this,"remove",this.unblockContact)}blockContact(e){e.contact().isContactBlocked=!0}unblockContact(e){e.contact().isContactBlocked=!1}}t.BlocklistCollection=s,s.model=i.default;var o=new s;t.default=o},95167:(e,t,r)=>{"use strict";var a=r(14859),n=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.BUSINESS_CATEGORY_EMPTY_STR_ID=void 0;var i=n(r(61247)),s=a(r(68384));t.BUSINESS_CATEGORY_EMPTY_STR_ID="__empty_query__";class o extends i.default{constructor(...e){super(...e),this.id=(0,i.prop)(),this.categories=(0,i.prop)()}getCollection(){return r(75472).default}}o.Proxy="BusinessCategoriesResult",o.idClass=s.default;var u=(0,i.defineModel)(o);t.default=u},75472:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.BusinessCategoriesResultCollection=void 0;var n=a(r(54019)),i=a(r(95167)),s=r(99774);class o extends n.default{_find(e){return(0,s.queryBusinessCategories)(e).then((t=>new i.default({id:e,categories:t})))}}t.BusinessCategoriesResultCollection=o,o.model=i.default,o.staleCollection=!0;var u=new o;t.default=u},88137:(e,t,r)=>{"use strict";var a=r(14859),n=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULTS=t.default=t.MAX_BUSINESS_CATEGORIES=void 0;var i=n(r(61247)),s=a(r(68384));t.MAX_BUSINESS_CATEGORIES=3;class o extends i.default{constructor(...e){super(...e),this.id=(0,i.prop)(),this.tag=(0,i.prop)(),this.description=(0,i.prop)(),this.categories=(0,i.prop)(),this.profileOptions=(0,i.prop)(),this.email=(0,i.prop)(),this.website=(0,i.prop)(),this.latitude=(0,i.prop)(),this.longitude=(0,i.prop)(),this.businessHours=(0,i.prop)(),this.catalogStatus=(0,i.prop)(),this.address=(0,i.prop)(),this.structuredAddress=(0,i.prop)(),this.stale=(0,i.session)(!0)}markStale(){this.stale=!0,this.hasObservers()&&this.getCollection().find(this.id)}getCollection(){return r(89216).default}isValid(){return Array.isArray(this.categories)}}o.Proxy="businessProfile",o.idClass=s.default;var u=(0,i.defineModel)(o);t.default=u;t.DEFAULTS={description:null,email:null,website:null}},89216:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.BusinessProfileCollection=t.CATALOG_EXISTS=void 0;var n=a(r(70417)),i=a(r(19976)),s=a(r(54019)),o=a(r(88137)),u=r(99774),l=r(80814);function d(){var e=(0,i.default)(["Store:BusinessProfile:handle Received invalid update from server"]);return d=function(){return e},e}function c(){var e=(0,i.default)(["Store:BusinessProfile:find No businessProfile found for ",""]);return c=function(){return e},e}function f(){var e=(0,i.default)(["Received invalid business profile response"]);return f=function(){return e},e}t.CATALOG_EXISTS="catalog_exists";class p extends s.default{_find(e){return this._findAndParse(e,{queryCatalog:!0})}_update(e){return this._findAndParse(e,{queryCatalog:!1})}_findAndParse(e,{queryCatalog:t}){var r=this.gadd(e);return(0,u.queryBusinessProfile)([{wid:r.id,tag:r.tag}]).then((r=>{if(!Array.isArray(r))return __LOG__(3)(f()),null;if(0===r.length)return __LOG__(2)(c(),String(e)),{id:e};var a=r[0],{wid:i,tag:s}=a,o={id:i,tag:s},{profile:u}=a;return u?(0,n.default)((0,n.default)({},(0,l.parseBusinessProfile)({id:a.wid,profile:u,queryCatalog:t})),o):o}))}onResume(){this.filter((e=>e.stale&&e.hasObservers())).map((e=>this.find(e.id)))}handle([e]){e&&null!=e.tag||__LOG__(3)(d());var t=this.gadd(e.wid);e.tag!==t.tag&&t.markStale()}getValid(e){var t=this.get(e);if(null==t?void 0:t.isValid())return t}}t.BusinessProfileCollection=p,p.model=o.default,p.staleCollection=!0;var h=new p;t.default=h},25975:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.COMMERCE_EXPERIENCE_TYPES=t.BUSINESS_HOUR_MODES=t.DAYS_OF_WEEK=void 0;t.DAYS_OF_WEEK=["sun","mon","tue","wed","thu","fri","sat"];t.BUSINESS_HOUR_MODES={OPEN_24H:"open_24h",SPECIFIC_HOURS:"specific_hours",APPOINTMENT_ONLY:"appointment_only"};var a=r(28103)({CATALOG:"catalog",NONE:"none",SHOP:"shop"});t.COMMERCE_EXPERIENCE_TYPES=a},80814:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.parseBusinessProfile=t.hasCatalog=t.CATALOG_EXISTS=void 0;var i=n(r(70417)),s=n(r(19976)),o=n(r(22220)),u=a(r(88137)),l=r(25975),d=n(r(65468)),c=n(r(7470));function f(){var e=(0,s.default)(["Store:BusinessProfile:missing catalog"]);return f=function(){return e},e}var p="catalog_exists";t.CATALOG_EXISTS=p;var h=e=>{var t,r;return e&&e instanceof u.default?(null===(r=e.profileOptions)||void 0===r?void 0:r.commerceExperience)===l.COMMERCE_EXPERIENCE_TYPES.CATALOG||e.catalogStatus===p:(null==e||null===(t=e.profile_options)||void 0===t?void 0:t.commerce_experience)===l.COMMERCE_EXPERIENCE_TYPES.CATALOG||(null==e?void 0:e.catalog_status)===p};t.hasCatalog=h;t.parseBusinessProfile=({profile:e,id:t,queryCatalog:r})=>{if(!e)return{id:t};var{business_hours:a,catalog_status:n,structured_address:s,profile_options:p,address:_}=e,m=(0,o.default)(e,["business_hours","catalog_status","structured_address","profile_options","address"]),g={};return g.businessHours=a?(({config:e,timezone:t})=>{var r={};return e.forEach((e=>{var{day_of_week:t,mode:a}=e;if(a===l.BUSINESS_HOUR_MODES.SPECIFIC_HOURS){var{open_time:n,close_time:i}=e;r[t]||(r[t]={mode:a,hours:[]}),null!=n&&null!=i&&r[t].hours&&r[t].hours.push([n,i])}else r[t]={mode:a}})),{config:r,timezone:t}})(a):null,p&&(g.profileOptions={},g.profileOptions.commerceExperience=p.commerce_experience,g.profileOptions.cartEnabled=p.cart_enabled,null!=p.shop_url&&(g.profileOptions.shopURL=p.shop_url)),h(e)&&(g.catalogStatus=n,r&&d.default.findCarouselCatalog(t).then((e=>{var r=Array.isArray(e)?e[0]:e;c.default.assertGet(t).businessCatalog=r})).catch((()=>__LOG__(3)(f())))),s?g.structuredAddress={streetAddress:s.street_address,cityId:s.city_id,localizedCityName:s.localized_city_name,zipCode:s.zip_code}:g.address=_||null,(0,i.default)((0,i.default)((0,i.default)((0,i.default)({},u.DEFAULTS),m),g),{},{id:t})}},25764:(e,t,r)=>{"use strict";var a=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(61247));class i extends n.default{constructor(...e){super(...e),this.id=(0,n.prop)(),this.displayText=(0,n.prop)(),this.selected=(0,n.session)(!1)}}i.Proxy="replyButton";var s=(0,n.defineModel)(i);t.default=s},50760:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.ButtonCollection=void 0;var n=a(r(54019)),i=a(r(25764));class s extends n.default{}t.ButtonCollection=s,s.model=i.default;var o=s;t.default=o},1085:(e,t,r)=>{"use strict";var a=r(14859),n=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i,s=n(r(61247)),o=a(r(29155)),u=a(r(79711)),l=a(r(52737)),d=a(r(43711)),c=r(35205);class f extends s.default{constructor(...e){super(...e),this.id=(0,s.prop)(),this.peerJid=(0,s.prop)(),this.offerTime=(0,s.prop)(),this.isVideo=(0,s.prop)(!1),this.isGroup=(0,s.prop)(!1),this.groupCallParticipants=(0,s.prop)(),this.canHandleLocally=(0,s.prop)(!1),this.outgoing=(0,s.prop)(!1),this.webClientShouldHandle=(0,s.prop)(!1),this.participants=(0,s.collection)(o.default),this.callInfo=(0,s.prop)(),this._state=(0,s.prop)(),this._ringTimeout=(0,s.prop)()}getState(){return this._state}setState(e){var t,a=e;(t=this._state,a in h[t||"EMPTY"])&&(this.webClientShouldHandle||a===c.CALL_STATES.INCOMING_RING||(a=c.CALL_STATES.HANDLED_REMOTELY,i||(i=r(64786).default),i.callEndByHandledRemotely(this.id)),this._state=a,this.handleNotification())}handleNotification(){var e=this.getState();!l.default.tosShowCallNotification||!this.peerJid||d.default.isVoiceCallEnabled()&&!this.isVideo||d.default.isVideoCallEnabled()&&this.isVideo||(e===c.CALL_STATES.INCOMING_RING?u.default.alertCall(this.peerJid,this.id,this.isVideo,this.canHandleLocally):u.default.cancelCall(this.peerJid))}getCollection(){return r(79504).default}}f.Proxy="call";var p=(0,s.defineModel)(f);t.default=p;var h={EMPTY:{[c.CALL_STATES.INCOMING_RING]:!0,[c.CALL_STATES.OUTGOING_CALLING]:!0,[c.CALL_STATES.CONNECTING]:!0,[c.CALL_STATES.REJECTED]:!0,[c.CALL_STATES.HANDLED_REMOTELY]:!0,[c.CALL_STATES.ENDED]:!0,[c.CALL_STATES.FAILED]:!0},INCOMING_RING:{[c.CALL_STATES.HANDLED_REMOTELY]:!0,[c.CALL_STATES.CONNECTING]:!0,[c.CALL_STATES.ACTIVE]:!0,[c.CALL_STATES.REJECTED]:!0,[c.CALL_STATES.ENDED]:!0,[c.CALL_STATES.REMOTE_CALL_IN_PROGRESS]:!0,[c.CALL_STATES.FAILED]:!0},OUTGOING_CALLING:{[c.CALL_STATES.OUTGOING_RING]:!0,[c.CALL_STATES.CONNECTING]:!0,[c.CALL_STATES.ENDED]:!0,[c.CALL_STATES.FAILED]:!0,[c.CALL_STATES.ACTIVE]:!0,[c.CALL_STATES.NOT_ANSWERED]:!0,[c.CALL_STATES.REMOTE_CALL_IN_PROGRESS]:!0},OUTGOING_RING:{[c.CALL_STATES.CONNECTING]:!0,[c.CALL_STATES.ACTIVE]:!0,[c.CALL_STATES.REJECTED]:!0,[c.CALL_STATES.ENDED]:!0,[c.CALL_STATES.FAILED]:!0,[c.CALL_STATES.NOT_ANSWERED]:!0},CONNECTING:{[c.CALL_STATES.ACTIVE]:!0,[c.CALL_STATES.ENDED]:!0,[c.CALL_STATES.REMOTE_CALL_IN_PROGRESS]:!0,[c.CALL_STATES.FAILED]:!0},CONNECTION_LOST:{[c.CALL_STATES.ACTIVE]:!0,[c.CALL_STATES.ENDED]:!0,[c.CALL_STATES.FAILED]:!0},ACTIVE:{[c.CALL_STATES.ENDED]:!0,[c.CALL_STATES.FAILED]:!0,[c.CALL_STATES.CONNECTION_LOST]:!0},HANDLED_REMOTELY:{},ENDED:{},REJECTED:{},REMOTE_CALL_IN_PROGRESS:{},FAILED:{},NOT_ANSWERED:{}}},79504:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.CallCollection=void 0;var i=n(r(70417)),s=n(r(19976)),o=n(r(98537)),u=n(r(99686)),l=n(r(54019)),d=n(r(1085)),c=n(r(50935)),f=n(r(18120)),p=n(r(86091)),h=n(r(89819)),_=r(17483),m=n(r(72424)),g=n(r(43711)),v=a(r(5361)),E=r(31558),y=r(27998),S=r(35205);function T(){var e=(0,s.default)(["voip:processIncomingCall: Attempting to add existing call with call ID"]);return T=function(){return e},e}function b(){var e=(0,s.default)(["received offer_key: no pending offer"]);return b=function(){return e},e}function A(){var e=(0,s.default)(["voip:incoming_signaling(paired phone):",":"]);return A=function(){return e},e}function C(){var e=(0,s.default)(["CallCollection:handle: ignoring incoming call offer because do not disturb mode is enabled or screen is locked"]);return C=function(){return e},e}function P(){var e=(0,s.default)(["voip:incoming_signaling(peer):",":"]);return P=function(){return e},e}var{VOIP_LOG_COLOR:O}=c.default,w=null,M=null;class I extends l.default{constructor(...e){super(...e),this.pendingOffers={},this.pendingVoipCapChecks={}}handleQuery(){return Promise.resolve()}handle(e){w&&M||(w=r(64786).default,M=r(64786).checkVoipCapability);var t=e.shift();if(t.data&&t.data[0]){var a=v.default.parseCallSignalingMsg(t);if(!a)return;var n={};(f.default.supportsFeature(f.default.F.DESKTOP_VOIP_VOICE_CALL)||m.default.webVoip)&&(Array.isArray(t.data[0])&&(t.data=t.data[0]),(0,v.base64DecodeRecursively)(t.data),n={peer_jid:a.peer_jid,payload:t.data,peer_platform:a.peer_platform,peer_app_version:a.peer_version,epoch_msec:null!=a.t?String(1e3*a.t):void 0,elapsed_msec:null!=a.e?String(1e3*a.e):void 0,is_offline:t.data[1].offline});var s=a.call_id,o=null,u=null,l=null,d=JSON.parse(JSON.stringify(t)),c=d.data[2]&&d.data[2].find((e=>"enc"===e[0]));c&&(c[2]="xxx bytes"),__LOG__(2)(P(),JSON.stringify(a));var y=!1;switch(a.type){case E.TYPE.OFFER:if((0,_.getDoNotDisturb)()&&!h.default.isFocused)return void __LOG__(2)(C());if(y=!0,o=a.isVideoCall,u=a.isGroupCall_DEPRECATED,l=a.t,w.isInitialized()){this.pendingVoipCapChecks[s]=Promise.all([M((0,i.default)({},a)),(0,p.default)()]).then((([e,t])=>e&&t));var T=t.data[2]&&t.data[2].find((e=>"enc"===e[0]));this.pendingOffers[s]=Promise.sit("receivedKey",(e=>{v.default.receiveCallOfferKey(e,T)})).endWithControls("receivedKey")}}this.pendingVoipCapChecks[s]?this.pendingVoipCapChecks[s].then((e=>{var r,i;(r=!u&&(o?e&&(g.default.isVideoCallEnabled()||m.default.webVoip):e),this.processIncomingCall(s,t.from,{isVideo:o,isGroupCall:u,canHandleLocally:r,offerTime:l}),r&&this.pendingOffers[s]&&(g.default.isVoiceCallEnabled()||m.default.webVoip))?this.pendingOffers[s].then((()=>{var e;null===(e=w)||void 0===e||e.handleIncomingSignalingMessage(a,n)})):(this.cleanupPendingOffer(s),null===(i=w)||void 0===i||i.handleIncomingSignalingMessage(a,n))})).finally((()=>{delete this.pendingVoipCapChecks[s]})):this.pendingOffers[s]?(y&&this.processIncomingCall(s,t.from),(g.default.isVoiceCallEnabled()||m.default.webVoip)&&this.pendingOffers[s].then((()=>{var e;null===(e=w)||void 0===e||e.handleIncomingSignalingMessage(a,n)}))):(y&&this.processIncomingCall(s,t.from,{isVideo:o,isGroupCall:u,canHandleLocally:!1,offerTime:l}),w.handleIncomingSignalingMessage(a,n))}else switch(__LOG__(2)(A(),JSON.stringify(t)),t.type){case"offer_key":var O=this.pendingOffers[t.id];O?O.control.receivedKey(t.key):__LOG__(3)(b());break;case"accept":case"reject":case"terminate":var I=this.get(t.id);I&&I.setState(S.CALL_STATES.ENDED),this.cleanupPendingOffer(t.id)}}processIncomingCall(e,t,r){if(null==this.get(e)){var a=r,n={id:e};null!=t&&(n.peerJid=t),a&&(a=(0,u.default)(a,(e=>null==e)),(0,o.default)(n,a)),this.add(n,{merge:!0})}else __LOG__(2)(T())}cleanupPendingOffer(e){delete this.pendingOffers[e]}setActiveCall(e){var t,r=this.activeCall&&!e,a=null===(t=this.activeCall)||void 0===t?void 0:t.webClientShouldHandle;this.activeCall=e,this.trigger("change:activeCall",e),r&&a&&(0,y.playEndCallTone)()}}t.CallCollection=I,I.model=d.default;var R=new I;t.default=R},88195:(e,t,r)=>{"use strict";var a=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(61247));class i extends n.default{constructor(...e){super(...e),this.id=(0,n.prop)(),this.callId=(0,n.prop)(),this.isIncoming=(0,n.prop)(!1),this.isRinging=(0,n.prop)(!1),this.isInterrupted=(0,n.prop)(!1),this.isMuted=(0,n.prop)(!1),this.isTrafficStopped=(0,n.prop)(!1),this.isInvitingToGroupCall=(0,n.prop)(!1),this.isVideoStopped=(0,n.prop)(!1),this.isVideoPaused=(0,n.prop)(!1),this.isVideoDecodePaused=(0,n.prop)(!1),this.isVideoDecodeStarted=(0,n.prop)(!1),this.isOfferingVideoUpgrade=(0,n.prop)(!1)}}i.Proxy="callParticipant";var s=(0,n.defineModel)(i);t.default=s},29155:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(26834)),i=a(r(54019)),s=a(r(88195));class o extends i.default{}t.default=o,o.model=s.default,o.comparator=(e,t)=>e.id===t.id?0:(0,n.default)(e.id,t.id)?-1:1},39016:(e,t,r)=>{"use strict";var a=r(14859),n=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(r(61247)),s=a(r(42134));class o extends i.default{constructor(...e){super(...e),this.id=(0,i.prop)(),this.products=(0,i.prop)(),this.itemCount=(0,i.prop)(),this.total=(0,i.prop)(),this.currency=(0,i.prop)(),this.message=(0,i.prop)()}countTotals(){var e=this.cartItemCollection.reduce(((e,t)=>{var r;return e.currency.add(t.currency),{itemCount:e.itemCount+t.quantity,total:e.total+t.quantity*(null!==(r=t.priceAmount1000)&&void 0!==r?r:0),currency:e.currency}}),{itemCount:0,total:0,currency:new Set}),t=1===e.currency.size,r={itemCount:e.itemCount,total:t?e.total:null,currency:t?e.currency.values().next().value:null};this.set(r,{silent:!0})}initialize(){super.initialize(),this.cartItemCollection=new s.default,this.listenTo(this,"change:cartItemCollection",this.countTotals)}getCollection(){return r(99601).default}}o.Proxy="cart";var u=(0,i.defineModel)(o);t.default=u},99601:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.CartCollection=void 0;var i=n(r(19976)),s=a(r(54019)),o=n(r(39016)),u=n(r(52737)),l=r(95595),d=n(r(18120));function c(){var e=(0,i.default)(["Error while restoring carts from cache, ",""]);return c=function(){return e},e}function f(){var e=(0,i.default)(["Error while saving carts to cache, ",""]);return f=function(){return e},e}class p extends s.default{constructor(e,t){super(),this.imageWidth=100,this.imageHeight=100,null!=e&&(this.imageWidth=e),null!=t&&(this.imageHeight=t)}saveToCache(){if(!d.default.supportsFeature(d.default.F.MD_BACKEND))try{if(!u.default.shouldSaveToCache())return;var e=this.reduce(((e,t)=>{var{cartItemCollection:r,itemCount:a,total:n,currency:i,id:s,message:o}=t,u=r.map((e=>({id:e.id,priceAmount1000:e.priceAmount1000,currency:e.currency,name:e.name,quantity:e.quantity,imageHash:e.imageHash})));return u.length>0&&e.push({id:s,products:u,itemCount:a,total:n,currency:i,message:o}),e}),[]);!0,(0,l.setCollection)(p.cachePolicy.id,e,true)}catch(e){__LOG__(3)(f(),String(e))}}initializeFromCache(e){try{(e||[]).forEach((e=>{var t=new o.default({id:e.id,itemCount:e.itemCount,total:e.total,currency:e.currency,message:e.message});t.cartItemCollection.add(e.products),this.add(t,{merge:!0})}))}catch(e){__LOG__(3)(c(),String(e))}}findCart(e){return this.gadd(e)}}t.CartCollection=p,p.model=o.default,p.cachePolicy={id:"cart_collection",policy:s.CACHE_POLICY.LOAD,delay:2e3};var h=new p;t.default=h},69160:(e,t,r)=>{"use strict";var a=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.MAX_QUANTITY=void 0;var n=a(r(61247));t.MAX_QUANTITY=99;class i extends n.default{constructor(...e){super(...e),this.id=(0,n.prop)(),this.priceAmount1000=(0,n.prop)(),this.currency=(0,n.prop)(),this.name=(0,n.prop)(),this.quantity=(0,n.prop)(),this.imageHash=(0,n.prop)(),this.imageCdnUrl=(0,n.prop)()}getCollection(){return r(99601).default}}i.Proxy="cart-item";var s=(0,n.defineModel)(i);t.default=s},42134:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.CartItemCollection=void 0;var n=a(r(54019)),i=a(r(69160));class s extends n.default{}t.CartItemCollection=s,s.model=i.default;var o=s;t.default=o},46774:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.getForwardedMessageFields=Fe,t.default=t.CHAT_KIND=t.KIND=t.ConversationEndOfHistoryTransferModelPropType=void 0;var i=n(r(52954)),s=n(r(19976)),o=n(r(17620)),u=n(r(67304)),l=n(r(15253)),d=n(r(17335)),c=n(r(34498)),f=n(r(54004)),p=n(r(45455)),h=n(r(54073)),_=r(91460),m=a(r(2784)),g=r(12073),v=n(r(25337)),E=r(96046),y=r(61247),S=n(r(53603)),T=n(r(5320)),b=n(r(45883)),A=n(r(55526)),C=n(r(90980)),P=n(r(56953)),O=n(r(7020)),w=n(r(19899)),M=n(r(79711)),I=n(r(52737)),R=n(r(50935)),D=n(r(64357)),N=n(r(7470)),L=n(r(19744)),k=r(19741),U=n(r(25353)),F=a(r(96452)),G=r(95595),x=n(r(18120)),B=n(r(22605)),Y=n(r(17957)),K=r(28352),j=n(r(68560)),W=r(28278),V=n(r(40210)),H=n(r(27e3)),q=n(r(58885)),z=r(16199),J=n(r(77865)),Q=r(57556),X=n(r(85059)),Z=r(86809),$=n(r(61941)),ee=r(207),te=n(r(99098)),re=r(51897),ae=n(r(15118)),ne=n(r(49213)),ie=r(74034),se=r(55630),oe=r(95721),ue=(r(59420),r(89590)),le=r(78475),de=n(r(72424)),ce=r(92816),fe=a(r(63095)),pe=n(r(73298)),he=a(r(82885)),_e=r(51803),me=r(82373),ge=r(89526),ve=n(r(17744)),Ee=n(r(76022)),ye=n(r(68384)),Se=n(r(12767)),Te=r(8654),be=r(55644);function Ae(){var e=(0,s.default)(["chat:loadMsgs:error ",""]);return Ae=function(){return e},e}function Ce(){var e=(0,s.default)(["chat:onEmptyMRM failed\n",""],["chat:onEmptyMRM failed\\n",""]);return Ce=function(){return e},e}function Pe(){var e=(0,s.default)(["models:Chat:removeMsg 0 messages left, querying..."]);return Pe=function(){return e},e}function Oe(){var e=(0,s.default)(["chat:preload failed\n",""],["chat:preload failed\\n",""]);return Oe=function(){return e},e}function we(){var e=(0,s.default)(["models:chat:sendDismissChangeNumber dropped"]);return we=function(){return e},e}function Me(){var e=(0,s.default)(["chat:onNewMsg failed\n",""],["chat:onNewMsg failed\\n",""]);return Me=function(){return e},e}function Ie(){var e=(0,s.default)(["onNewMsg: unable to find metadata from chat table for id:",""]);return Ie=function(){return e},e}function Re(){var e=(0,s.default)(["chat:onPendingActionUpdate pendingAction value is invalid"]);return Re=function(){return e},e}function De(){var e=(0,s.default)(["chat:onPendingActionUpdate pendingAction value is invalid"]);return De=function(){return e},e}function Ne(){var e=(0,s.default)(["chat:unknown kind id:",""]);return Ne=function(){return e},e}var Le=r(28103)({COMPLETE_BUT_MORE_MESSAGES_REMAIN_ON_PRIMARY:0,COMPLETE_AND_NO_MORE_MESSAGE_REMAIN_ON_PRIMARY:1,INCOMPLETE:2});t.ConversationEndOfHistoryTransferModelPropType=Le;var ke={GROUP:"group",BROADCAST:"broadcast",CHAT:"chat"};t.CHAT_KIND=t.KIND=ke;class Ue extends pe.default{constructor(...e){super(...e),this.id=(0,y.prop)(),this.t=(0,y.prop)(),this.unreadCount=(0,y.prop)(0),this.archive=(0,y.prop)(),this.isReadOnly=(0,y.prop)(),this.isAnnounceGrpRestrict=(0,y.prop)(),this.modifyTag=(0,y.prop)(),this.muteExpiration=(0,y.prop)(0),this.name=(0,y.prop)(),this.notSpam=(0,y.prop)(),this.pin=(0,y.prop)(),this.labels=(0,y.prop)(),this.changeNumberOldJid=(0,y.prop)(),this.changeNumberNewJid=(0,y.prop)(),this.lastReceivedKey=(0,y.prop)(),this.ephemeralDuration=(0,y.prop)(),this.ephemeralSettingTimestamp=(0,y.prop)(),this.createdLocally=(0,y.session)(),this.pendingAction=(0,y.session)(),this.formattedTitle=(0,y.session)(),this.active=(0,y.session)(),this.pausedTimerId=(0,y.session)(),this.presenceResendTimerId=(0,y.session)(),this.recording=(0,y.session)(),this.typing=(0,y.session)(),this.colors=(0,y.session)(),this.composeContents=(0,y.session)((()=>({}))),this.attachMediaContents=(0,y.session)(),this.squelch=(0,y.session)(),this.pendingSeenCount=(0,y.session)(0),this.unreadMsgAnchor=(0,y.session)(),this.markedUnread=(0,y.session)(),this.trusted=(0,y.session)(),this.canSend=(0,y.session)(),this.promises=(0,y.session)((()=>({}))),this.ftsCache=(0,y.session)((()=>({}))),this.composeQuotedMsg=(0,y.session)(),this.composeQuotedMsgRemoteJid=(0,y.session)(),this.quotedMsgAdminGroupJid=(0,y.session)(),this.groupMetadata=(0,y.session)(),this.presence=(0,y.session)(),this.mute=(0,y.session)(),this.contact=(0,y.session)(),this.liveLocation=(0,y.session)(),this.liveLocationQueried=(0,y.session)(!1),this.ackedProps=(0,y.session)((()=>({}))),this.mediaCount=(0,y.session)(0),this.linkCount=(0,y.session)(0),this.docCount=(0,y.session)(0),this.productCount=(0,y.session)(0),this.msgUnsyncedButtonReplyMsgs=(0,y.prop)(),this.vcardDismissed=(0,y.session)(!1),this.endOfHistoryTransfer=(0,y.session)(!1),this.endOfHistoryTransferType=(0,y.prop)(),this.kind=(0,y.derived)(this._kind),this.isUser=(0,y.derived)(this._isUser),this.isPSA=(0,y.derived)(this._isPSA),this.isGroup=(0,y.derived)(this._isGroup),this.isBroadcast=(0,y.derived)(this._isBroadcast),this.canUnread=(0,y.derived)(this._canUnread),this.hasUnread=(0,y.derived)(this._hasUnread,["unreadCount"]),this.optimisticUnreadCount=(0,y.derived)(this._optimisticUnreadCount,["unreadCount","pendingSeenCount"]),this.shouldShowUnreadDivider=(0,y.derived)(this._shouldShowUnreadDivider,["unreadCount","unreadMsgAnchor"]),this.shouldAppearInList=(0,y.derived)(this._shouldAppearInList,["createdLocally","msgs","msgsLength"]),this.previewMessage=(0,y.derived)(this._previewMessage,["msgs","msgsChanged"]),this.showChangeNumberNotification=(0,y.derived)(this._showChangeNumberNotification,["changeNumberOldJid","changeNumberNewJid","id","isUser"]),this.shouldShowUnreadInTitle=(0,y.derived)(this._shouldShowUnreadInTitle,["isGroup","archive","optimisticUnreadCount","muteExpiration"])}initialize(){super.initialize(),this.addQueue=new B.default,this.sendQueue=new B.default,this._ephemeralMessagesToDelete=new Set,this._ephemeralMessageTimerIds=new Map,this._promises=null,this.msgs.msgLoadState.contextLoaded=!0,this.addChild("presence",te.default.gadd(this.id));var e=X.default.get(this.id);if(e?this.addChild("mute",e):this.addChild("mute",X.default.gadd({id:this.id,expiration:this.muteExpiration})),this.listenTo(this.mute,"change:expiration",this.updateMuteExpiration),this.addChild("contact",N.default.gadd(this.id)),this.name&&!this.contact.name){var t={name:this.name};this.isGroup?this.contact.set(t):(0,_e.updateLocal)(this.contact.id,t).then((()=>{this.contact.set(t)}))}if(this.listenTo(this.contact,"change:name",this.updateTitle),this.listenTo(this.contact,"change:isContactBlocked",this.updateCanSend),this.isGroup&&(this.trusted=!0),this.isGroup||this.isBroadcast){var r,a=this.getGroupMetadataCollection();this.isBroadcast&&!a.get(this.id)&&(r=!0),this.addChild("groupMetadata",a.gadd(this.id)),this.listenTo(this.groupMetadata,"change:stale change:announce",this.updateIsAnnounceGrpRestrict),this.listenTo(this.groupMetadata.participants,"change:isAdmin add remove",this.updateIsAnnounceGrpRestrict),this.listenTo(this.groupMetadata,"change:trusted change:stale",this.isTrusted),this.listenTo(this.groupMetadata,"change:participants change:stale",this.updateReadOnly),this.listenTo(this.groupMetadata.participants,"change:contact.formattedShortName",this.updateTitle),this.updateReadOnly(),this.updateIsAnnounceGrpRestrict();var n=this.id;this.listenTo(this,"change:isReadOnly",(function(){this.isTrusted(),this.updateCanSend(),ae.default.update(n).catchType(k.WebdDrop,(()=>{})),a.update(n).catchType(k.WebdDrop,(()=>{}))})),this.listenTo(this,"change:isAnnounceGrpRestrict",this.updateCanSend),this.listenTo(this,"change:archive",(()=>{!0===this.archive&&(0,E.shouldEnableArchiveV2)()&&(0,ce.setArchiveEnabledSetting)(!0)})),r&&a.update(n).catchType(k.WebdDrop,(()=>{}))}else this.listenTo(this.presence,"change:isOnline",(()=>(0,ee.presenceOnlineChanged)(this))),this.listenTo(this.contact,"change:isMyContact",this.isTrusted);var i=this.getCollection();i.notSpam[this.id]&&!this.notSpam&&(0,ue.sendNotSpam)(this).catch((()=>{})),i.notSpam[this.id]=!!this.notSpam,this.notSpam||this.listenTo(this,"change:notSpam",this.onNotSpamChange),this.updateTitle(),this.isTrusted(),this.updateCanSend(),this.listenTo(this.msgs,"add",this.onNewMsg),this.listenTo(this.msgs,"update_sort_time",this.updateSortTime),this.listenTo(this.msgs,"bulk_add",this.addMediaMsgs),this.listenTo(this.msgs,"add",this._deregisterExpiredViewOnceMessage),this.listenTo(this.msgs,"bulk_add",this.deregisterExpiredViewOnceBulkMessages),this.listenTo(this.msgs,"add remove change:ephemeralExpirationTimestamp",this._resetEphemeralMessageExpirationTimer),this.listenTo(this.msgs,"bulk_add",(e=>{e.forEach((e=>{this._resetEphemeralMessageExpirationTimer(e)}))})),this.listenTo(this,"change:msgs",this.resetMediaMsgs),this._saveAssignedColors=(0,h.default)(this.saveAssignedColors,1e3),this.listenTo(this,"change:active",this.onActiveUpdate),this.pendingAction=0,this.listenTo(this,"change:t change:modifyTag",this._clearFtsCache),this.listenTo(Y.default,"locale_change",(()=>{this.updateTitle()})),I.default.isSMB&&(0,K.initializeLabels)(this)}_kind(){return ye.default.isGroup(this.id)?ke.GROUP:ye.default.isBroadcast(this.id)?ke.BROADCAST:ye.default.isUser(this.id)?ke.CHAT:void __LOG__(2)(Ne(),this.id.toString())}_isUser(){return ye.default.isUser(this.id)}_isPSA(){return ye.default.isPSA(this.id)}_isGroup(){return ye.default.isGroup(this.id)}_isBroadcast(){return ye.default.isBroadcast(this.id)}isSupportGroup(){return this.isGroup&&this.groupMetadata.support}_canUnread(){return!this.isBroadcast}_hasUnread(){return 0!==this.unreadCount}_optimisticUnreadCount(){var{unreadCount:e,pendingSeenCount:t}=this;return e===R.default.MARKED_AS_UNREAD?e:Math.max(0,e-t)}_shouldShowUnreadDivider(){if(0===this.unreadCount)return!1;if(this.unreadMsgAnchor){var{msgChunk:e}=this.unreadMsgAnchor,t=e?e.getModelsArray():[];return this.unreadMsgAnchor!==t.find((e=>e.isUnreadType))}return!this.msgs.msgLoadState.noEarlierMsgs||this.msgs.filter((e=>e.isUnreadType)).length!==this.unreadCount}_shouldAppearInList(){if(x.default.supportsFeature(x.default.F.MD_BACKEND)&&this.isBroadcast)return!1;if(this._shouldAppearInListLatched)return!0;if(ye.default.isStatusV3(this.id))return!1;var e=this.msgs.some((e=>{var t=e.type===R.default.MSG_TYPE.GROUPS_V4_INVITE&&e.from.equals((0,G.getMaybeMeUser)()),r=e.type===R.default.MSG_TYPE.E2E_NOTIFICATION&&"encrypt"===e.subtype;return!t&&!r&&e.type!==R.default.MSG_TYPE.CALL_LOG&&!e.isBizNotification&&"change_number"!==e.subtype}));return this._shouldAppearInListLatched=!this.createdLocally||e,this._shouldAppearInListLatched}_previewMessage(){for(var e=this.msgs.length-1;e>=0;e--){var t=this.msgs.at(e);if(t&&t.type!==R.default.MSG_TYPE.E2E_NOTIFICATION)return t}if(this.msgs.length>0)return this.msgs.last()}_showChangeNumberNotification(){if(!x.default.supportsFeature(x.default.F.CHANGE_NUMBER_V_2))return!1;var{changeNumberOldJid:e,changeNumberNewJid:t,id:r,isUser:a}=this;if(!a)return!1;if(!e&&!t)return!1;var n=N.default.get(t||r);return!n||!n.isMyContact}_shouldShowUnreadInTitle(){var e=!!this.muteExpiration;if(this.archive)return!1;if(this.optimisticUnreadCount<=0)return!1;if(!this.isGroup)return!e;if(!e)return!0;if(!this.msgs||0===this.msgs.length)return!1;for(var t=!1,r=this.msgs,a=this.optimisticUnreadCount,n=Math.max(0,r.length-a);n<r.length;n++){var i=this.msgs.at(n);if(i){var s=(0,G.getMaybeMeUser)();if(i.isMentioned(s)||i.isQuoted(s)){var o=this.getCollection().get(i.sender);if(!o||!o.muteExpiration){t=!0;break}}}}return t}set(e,t,r){return"string"==typeof e?"muteExpiration"===e&&this.mute&&this.mute.setMute(t):e.hasOwnProperty("muteExpiration")&&this.mute&&this.mute.setMute(e.muteExpiration),super.set(e,t,r)}addPendingAction(e){if(e.isPending()){var t=()=>{this.decPending()};e.then(t,t),this.pendingAction++}}decPending(){this.pendingAction>0?this.pendingAction--:(__LOG__(2)(De()),this.pendingAction=0)}onActiveUpdate(){this.isGroup&&this.active&&(this.squelch=-1),this.presence.chatActive=this.active,this.active||(this.msgs.filter((e=>(0,ge.isExpired)(e.safe()))).forEach(W.deregisterMsg),this._ephemeralMessagesToDelete.forEach((e=>{this._ephemeralMessagesToDelete.delete(e),e.delete({skipUpdatingSortTime:!0,doNotResetLastReceived:!0})})))}onPendingActionUpdate(){this.pendingAction<0&&(__LOG__(2)(Re()),this.pendingAction=0)}onNotSpamChange(){this.getCollection().notSpam[this.id]=this.notSpam,this.isTrusted(),this.notSpam&&this.stopListening(this,"change:notSpam")}hasMaybeSentMsgToChat(){return this.getAllMsgs().some((e=>e.isSentByMe))}isTrusted(){var e=!1;return this.isGroup?e=this.isReadOnly||this.notSpam||this.groupMetadata.isTrusted():this.isBroadcast?e=!0:this.isUser&&(e=this.notSpam||this.contact.isMyContact),!e&&this.hasMaybeSentMsgToChat()&&(e=!0),this.trusted=e}updateMuteExpiration(){var e=Number(this.mute.expiration);(0,me.updateLocal)(this.id,{muteExpiration:e}).then((()=>this.muteExpiration=e))}updateTitle(){this.isBroadcast?this.formattedTitle=this.contact.name||this.groupMetadata.participants.map((function(e){return e.contact.formattedShortName})).join(", "):this.isUser?this.formattedTitle=this.contact.getFormattedUser()||"":this.isGroup&&(this.formattedTitle=this.contact.name)}title(){return this.isGroup?this.formattedTitle||Y.default.t(1410):this.formattedTitle}updateCanSend(){return this.isReadOnly||this.isAnnounceGrpRestrict?this.canSend=!1:this.isUser?this.canSend=!(this.contact.isContactBlocked||this.isPSA):this.canSend=!0}delete(){super.delete(),this.getCollection().remove(this.id),this.cancelPendingPromises(),this.presence.delete(),this.liveLocation&&this.liveLocation.delete(),M.default.closeChat(this),this.groupMetadata&&this.groupMetadata.delete(),this.mediaMsgs&&this.mediaMsgs.delete(),this.linkMsgs&&this.linkMsgs.delete(),this.docMsgs&&this.docMsgs.delete(),this.productMsgs&&this.productMsgs.delete();var e=this.starredMsgs;e&&(e.delete(),e.stopListening(),e.reset()),this.receivedVcardMsgs&&this.receivedVcardMsgs.delete(),(0,G.deleteComposeContents)(this.id)}isDirty(){return 0!==this.unreadCount}resetMediaMsgs(){var{mediaMsgs:e,linkMsgs:t,docMsgs:r,productMsgs:a}=this;e&&(e.delete(),e.queryMedia({chat:this})),t&&(t.delete(),t.queryLinks(this)),r&&(r.delete(),r.queryDocs(this)),a&&(a.delete(),a.queryProducts(this))}isMsgForMediaCollection(e){return e.isMedia&&!e.isViewOnce}addMediaMsgs(e,t){if(e){var r=Array.isArray(e)?e:[e],a=[],n=[],i=[],s=[];r.forEach((e=>{this.isMsgForMediaCollection(e)&&a.push(e),e.asDoc&&i.push(e),e.linkPreview&&n.push(e),null!=e.asProduct&&s.push(e)})),this.mediaMsgs&&a.length&&this.mediaMsgs.add(a,t),this.linkMsgs&&n.length&&this.linkMsgs.add(n,t),this.docMsgs&&i.length&&this.docMsgs.add(i,t),this.productMsgs&&s.length&&this.productMsgs.add(s,t)}}onNewMsg(e){var t=this;if(e){var r=Promise.resolve();e.isSentByMe&&!this.notSpam&&(r=(0,me.updateLocal)(this.id,{notSpam:!0}).then((()=>this.notSpam=!0))),"i"!==e.eventType&&r.then((()=>{var r={};return x.default.supportsFeature(x.default.F.MD_BACKEND)||(r.t=e.t),this.promises.updateSortTime&&this.promises.updateSortTime.cancel(),this.updateMediasCountOnMsg(e),this.archive&&(0,E.shouldUnarchiveChat)(e.isSentByMe)&&(r.archive=!1),this.promises.setArchive&&this.promises.setArchive.cancel(),e.isSentByMe?this.markedUnread=!1:((0,S.default)({id:this.id,participant:e.author,type:"paused"},!1),x.default.supportsFeature(x.default.F.MD_BACKEND)||"a"!==e.eventType&&"d"!==e.eventType||(r.unreadCount=this.unreadCount+1||1)),(0,me.updateLocal)(this.id,r).then((0,i.default)((function*(){if(x.default.supportsFeature(x.default.F.MD_BACKEND))try{var{unreadCount:e,timestamp:a}=yield(0,be.getChatMeta)(t.id);r.t=a,r.unreadCount=e}catch(e){__LOG__(4,void 0,new Error)(Ie(),t.id.toString())}return r})))})).then((t=>{e.isSentByMeFromWeb&&e.promises.sendPromise?this.setAndKeepPrevious(t,e.promises.sendPromise):this.set(t);var r=L.default.get(this.id);if(r&&(r.timestamp=w.default.globalUnixTime()),"gp2"!==e.type||"add"!==e.subtype&&"create"!==e.subtype||this.getGroupMetadataCollection().trigger("group_participant_change_".concat((0,G.getMaybeMeUser)().toString()),this.id),!e.isSentByMe){switch(e.eventType){case"d":case"a":"d"===e.eventType&&M.default.alertNewMsg(e),this.msgs.length<R.default.MSG_PRELOAD_THRESHOLD&&this.loadEarlierMsgs(void 0,V.default.WEBC_QUERY_TRIGGER_TYPE.NEW_MESSAGE_PREFETCH).catchType(k.E404,(()=>{})).catch((e=>{__LOG__(2)(Me(),e)}));break;case"n":e.type===R.default.MSG_TYPE.CALL_LOG&&M.default.alertNewMsg(e);break;case"s":if("gp2"===e.type&&"add"===e.subtype&&(0,G.getMaybeMeUser)().equals(e.recipients[0])&&!this.contact.name)return;M.default.alertNewMsg(e),this.getGroupMetadataCollection().trigger("group_participant_change_".concat((0,G.getMaybeMeUser)().toString()),this.id)}var a=e.mediaData;!a||"image"!==a.type&&"video"!==a.type||M.default.newMediaMsg(e),x.default.supportsFeature(x.default.F.MD_BACKEND)&&t.unreadCount&&(0,Te.processOrphanPeerReceipt)(e.id)}}))}}canPin(){if(this.archive)return!1;var e=this.promises&&this.promises.setArchive;return!e||!e.archive}canArchive(){return!this.isBroadcast||x.default.supportsFeature(x.default.F.ARCHIVE_BROADCAST)}sendDismissChangeNumber(){if(this.promises.sendDismissChangeNumber)return this.promises.sendDismissChangeNumber;var e=x.default.supportsFeature(x.default.F.MD_BACKEND)?Promise.resolve({status:200,_duplicate:null}):Ee.default.sendConversationDismissChangeNumber(this.id);this.promises.sendDismissChangeNumber=e;var t=new g.ActionType(Y.default.t(66)),r=e.then((e=>200===e.status?new g.ActionType(Y.default.t(65)):e.status>=400?new g.ActionType(Y.default.t(64)):void 0)).catch((()=>(__LOG__(3)(we()),new g.ActionType(Y.default.t(64),{actionText:Y.default.t(199),actionHandler:this.sendDismissChangeNumber.bind(this)}))));return M.default.openToast(m.createElement(g.ActionToast,{id:(0,g.genId)(),initialAction:t,pendingAction:r})),e.then((e=>{if(200===e.status&&!e._duplicate)return(0,me.updateLocal)(this.id,{changeNumberNewJid:void 0,changeNumberOldJid:void 0}).then((()=>{this.changeNumberOldJid=this.changeNumberNewJid=void 0}))})).finally((()=>{this.promises.sendDismissChangeNumber=null}))}setComposeContents(e){this.composeContents=e}getSessionPersistedComposeContents(){return(0,G.getComposeContents)(this.id)}getComposeContents(){return(0,p.default)(this.composeContents)?this.getSessionPersistedComposeContents()||{}:this.composeContents}setAttachMediaContents(e){this.attachMediaContents=e}preload(){1===this.msgs.length&&this.loadEarlierMsgs().catchType(k.E404,(()=>{})).catch((e=>{__LOG__(2)(Oe(),e)}))}onEmptyMRM(){__LOG__(2)(Pe()),this.loadEarlierMsgs().catchType(k.E404,(()=>{})).catch((e=>{__LOG__(2)(Ce(),e)}))}loadEarlierMsgs(e,t){var r=e,a=null!=t?t:V.default.WEBC_QUERY_TRIGGER_TYPE.USER_SCROLL;if(r||(r=this.msgs),r.msgLoadState.noEarlierMsgs)return Promise.resolve();if(r.msgLoadState.isLoadingEarlierMsgs)return r.loadEarlierPromise;var n=r?r.head():null;return this._loadMsgs("before",r,a).then((e=>{var t=n?n.msgChunk:r;return t&&Array.isArray(e)&&e.length<R.default.PAGE_SIZE&&(t.msgLoadState.noEarlierMsgs=!x.default.supportsFeature(x.default.F.MD_BACKEND)||this.endOfHistoryTransferType!==Le.INCOMPLETE),t&&this.isMostRecentCMC(t)&&this.trigger("msgs:loadEarlier"),e}))}isMostRecentCMC(e){return this.msgs===e}loadRecentMsgs(e){var t=e;return t||(t=this.msgs),this.isMostRecentCMC(t)?Promise.resolve():t.msgLoadState.isLoadingRecentMsgs?t.loadRecentPromise:this._loadMsgs("after",t,V.default.WEBC_QUERY_TRIGGER_TYPE.USER_SCROLL)}_loadMsgs(e,t,r){var a,n={};(a="after"===e?t.last():t.head())?n=a.id.clone():n.remote=this.id,n.count=R.default.PAGE_SIZE,n.direction=e;var i=(0,z.newMessageQueryEvent)(r);return this._loadMsgsPromiseLoop(a,t,q.default.findQuery.bind(q.default,n,{logOnSend:e=>{i.webcResponseBytes+=e.binarySize}}),e,i)}_updateMsgLoadState(e,t,r){var a=e&&e.msgChunk&&e.msgChunk!==t;t.msgLoadState.contextLoaded=!0,e&&a&&((0,$.default)(e.msgChunk,"msg.msgChunk").msgLoadState.contextLoaded=!0),"after"===r?t.msgLoadState.isLoadingRecentMsgs=!1:"before"===r?t.msgLoadState.isLoadingEarlierMsgs=!1:"around"===r&&(t.msgLoadState.isLoadingAroundMsgs=!1)}_loadMsgsPromiseLoop(e,t,r,a,n,i=!0){var s=performance.now();"after"===a?(t.msgLoadState.isLoadingRecentMsgs=!0,n.webcMessageQueryType=V.default.WEBC_MESSAGE_QUERY_DIRECTION.LOAD_NEXT):"before"===a?(t.msgLoadState.isLoadingEarlierMsgs=!0,n.webcMessageQueryType=V.default.WEBC_MESSAGE_QUERY_DIRECTION.LOAD_PREV):"around"===a&&(t.msgLoadState.isLoadingAroundMsgs=!0,n.webcMessageQueryType=V.default.WEBC_MESSAGE_QUERY_DIRECTION.LOAD_AROUND),n.webcBrowserNetworkType=(0,Z.getEffectiveNetworkType)(),n.webcChatType=this.getWebcChatType(),"number"==typeof this.initialIndex&&(n.webcChatPosition=this.initialIndex);var o=Promise.loop(((i,o,u)=>{var l=(0,_.delayMs)(he.expBackoff(u,12e4,1e3,.1)),d=Promise.resolve();return x.default.supportsFeature(x.default.F.MD_BACKEND)||"CONNECTED"===Se.default.stream||(d=(0,ve.default)(Se.default,"change:stream",(()=>"CONNECTED"===Se.default.stream))),d.then((()=>this.regCancellablePromise(r()).then((r=>{var o;n.webcQueryT=Math.ceil(performance.now()-s),Array.isArray(r[0])?(o=r[0][0],r.forEach((e=>(0,z.logMessageCounts)(n,e)))):(o=r[0],(0,z.logMessageCounts)(n,r)),o&&(n.webcEarliestMessageT=o.t,o.msgChunk===this.msgs&&(n.webcEarliestMessageIndex=this.msgs.length-1)),(0,U.default)().then((e=>{e&&(n.webcBrowserStorageQuotaBytes=e.quota,n.webcBrowserStorageQuotaUsedBytes=e.usage)})).finally((()=>n.commit())),this._updateMsgLoadState(e,t,a),i(r)})))).catchConditional((e=>!(e instanceof Promise.CancellationError)),(r=>u>3||404===r?(this._updateMsgLoadState(e,t,a),__LOG__(3)(Ae(),String(r)),404===r?Promise.reject(new k.E404):Promise.reject(new F.GaveUpRetry("Gave up msg fetch after ".concat(u," tries")))):l))}),0).catchType(F.GaveUpRetry,(()=>[])).catchType(k.E404,(e=>{if(i)return[];throw e}));return"after"===a?t.loadRecentPromise=o:"before"===a?t.loadEarlierPromise=o:"around"===a&&(t.loadAroundPromise=o),o}getSearchContext(e,t){var r,a=null;e instanceof H.default?a=e:e instanceof J.default&&(r=e);var n=a?a.msgChunk:void 0,i=Math.trunc(R.default.PAGE_SIZE/3*2);if(!n||!n.msgLoadState.contextLoaded){n||(n=new C.default,this.msgChunks.push(n),a&&n.add(a));var s=a?a.id.clone():r.clone();s.count=i;var o=function(){if(a)return a.msgChunk;if(null!=r){var e=q.default.get(r);return e&&e.msgChunk?e.msgChunk:n}return n},u=(0,z.newMessageQueryEvent)(V.default.WEBC_QUERY_TRIGGER_TYPE.SEARCH_RESULT_CLICK);this._loadMsgsPromiseLoop(a,n,q.default.getContext.bind(q.default,s,o,(e=>{u.webcResponseBytes+=e.binarySize})),"around",u,null==t).then((e=>{var t=o();t&&n&&t!==n&&this.notifyMsgCollectionMerge(t,n,t);var s=e[0],u=r?q.default.get(r):a;u&&Array.isArray(s)&&s.length<i&&((0,$.default)(u.msgChunk,"loadedMsg.msgChunk").msgLoadState.noEarlierMsgs=!x.default.supportsFeature(x.default.F.MD_BACKEND)||this.endOfHistoryTransferType!==Le.INCOMPLETE,n&&u.msgChunk!==n&&(n.msgLoadState.noEarlierMsgs=!x.default.supportsFeature(x.default.F.MD_BACKEND)||this.endOfHistoryTransferType!==Le.INCOMPLETE))})).catch((()=>{t&&(t.isQuotedMsgAvailable=!1)}))}return{collection:n,msg:a,key:r,highlightMsg:!0}}sendStarMsgs(e,t){return this.promises.sendStarMsgs?this.promises.sendStarMsgs:this.promises.sendStarMsgs=(0,le.sendStarMsgs)(this.id,e,t).then((()=>{e.forEach((e=>{e.set("star",t)})),t?(0,fe.addStarredMsgs)(e):(0,fe.removeStarredMsgs)(e)})).finally((()=>{this.promises.sendStarMsgs=null}))}sendRevokeMsgs(e,t){return this.promises.sendRevokeMsgs?this.promises.sendRevokeMsgs:this.promises.sendRevokeMsgs=Promise.all(e.map((e=>(0,ie.sendRevoke)(e,t)))).finally((()=>{this.promises.sendRevokeMsgs=null}))}sendDeleteMsgs(e,t){return this.promises.sendDeleteMsgs||(this.promises.sendDeleteMsgs=(0,se.sendDeleteMsgs)(e,t,this.id).then((()=>(e.forEach((e=>{e.delete()})),e.length))).catchType(k.ServerStatusCodeError,(()=>{var t=0;return e.forEach((e=>{(e.ack===R.default.ACK.FAILED||e.isExpired())&&(e.delete(),t++)})),t})).finally((()=>{this.promises.sendDeleteMsgs=null}))),this.promises.sendDeleteMsgs}deleteMsgs(e,t){this.deleteMsgsBeforeMsgInclusive(void 0,!e,t)}deleteMsgsOlderThan(e,t,r){var a=this.msgs,n=a.head();!n||n.t>=e||((n=a.last())&&n.t<e?this.deleteMsgs(t,r):this.deleteMsgsPartial((function(a){return a&&(r&&!(0,Q.msgMatchesType)(a,r)||a.star&&!t||a.t>=e||a.isPersistent)})))}deleteMsgsBeforeMsgInclusive(e,t=!1,r){var a;if(e){if(!this.msgs.get(e.id))return;a=this.msgs.indexOf(e)}else a=this.msgs.length;this.deleteMsgsPartial((function(e,n){return r&&!(0,Q.msgMatchesType)(e,r)||e.msgChunk===this.msgs&&n>a||t&&e.star||e.isPersistent&&t}),!0)}deleteMsgsPartial(e,t=!1){var r=this.unreadCount;if(this.getAllCMCs().forEach((r=>{var a=r.filter(((t,r,a)=>!e.apply(this,[t,r,a])));r.remove(a,void 0,t),a.forEach((e=>{e.delete()}))})),(0,f.default)(this.msgChunks).forEach((e=>{0===e.length&&this.removeMsgsCollection(e)})),this.msgs.length>0){var a=r>this.msgs.length?this.msgs.length:r;(0,me.updateLocal)(this.id,{unreadCount:a}).then((()=>{this.unreadCount=a,this.msgs.msgLoadState.noEarlierMsgs=!x.default.supportsFeature(x.default.F.MD_BACKEND)||this.endOfHistoryTransferType!==Le.INCOMPLETE}))}}getFirstMsgWithStatus(){return this.msgs.getModelsArray().find((function(e){return!e.isNotification&&(e.isSentByMe||e.type===R.default.MSG_TYPE.PTT||e.isViewOnce||e.isEphemeral)}))}getLastReceivedMsg(){for(var e=this.msgs.length-1;e>=0;e--){var t=this.msgs.at(e);if(t&&(!t.local||t.ack>R.default.ACK.CLOCK))return t}}getLastReceivedNonExpiredMsg(e){for(var t=this.msgs.length-1;t>=0;t--){var r=this.msgs.at(t);if(r&&(!r.local||r.ack>R.default.ACK.CLOCK)&&(!r.isEphemeral||null!=r.ephemeralExpirationTimestamp&&r.ephemeralExpirationTimestamp>e))return r}}getLastMsgKeyForAction(){var e,t=this.msgs.last();return t&&(e=!this.lastReceivedKey||t.id.fromMe&&t.local&&t.ack===R.default.ACK.CLOCK?t.id:this.lastReceivedKey),e||void 0}getLastTimestampMsg(){for(var e=this.msgs.length-1;e>=0;e--){var t=this.msgs.at(e);if(t&&"i"!==(0,Q.eventTypeFromMsgType)(t))return t}}getWebcChatType(){switch(this.kind){case ke.CHAT:return V.default.WEBC_CHAT_TYPE.INDIVIDUAL;case ke.GROUP:return V.default.WEBC_CHAT_TYPE.GROUP;case ke.BROADCAST:return V.default.WEBC_CHAT_TYPE.BROADCAST_LIST;default:throw new TypeError("Invalid Chat.kind ".concat(String(this.kind)))}}deregisterExpiredViewOnceBulkMessages(e){e.forEach(this._deregisterExpiredViewOnceMessage)}_deregisterExpiredViewOnceMessage(e){(0,ge.isExpired)(e.safe())&&(0,W.deregisterMsg)(e)}_resetEphemeralMessageExpirationTimer(e){if(de.default.ephemeralMessages){v.default.clearTimeout(this._ephemeralMessageTimerIds.get(e)),this._ephemeralMessageTimerIds.delete(e),this._ephemeralMessagesToDelete.delete(e);var{ephemeralExpirationTimestamp:t}=e;if(null!=t&&this.msgs.includes(e)){var r=()=>{this._ephemeralMessageTimerIds.delete(e),this.active?this._ephemeralMessagesToDelete.add(e):e.delete({skipUpdatingSortTime:!0,doNotResetLastReceived:!0})};if(e.isExpired())r();else{var a=v.default.setGlobalTimeout(r,1e3*t);this._ephemeralMessageTimerIds.set(e,a)}}}}sendProductMessage(e,t){var r=this;return(0,i.default)((function*(){yield(0,re.sendProductMessage)(r,e,t)}))()}sendGroupInviteMessage(e,t,r,a,n,i){var s=(0,G.getMaybeMeUser)(),o={ack:R.default.ACK.CLOCK,from:s,id:new J.default({from:s,to:this.id,id:(0,ne.default)(),participant:void 0,selfDir:"out"}),local:!0,self:"out",t:w.default.globalUnixTime(),to:this.id,type:"groups_v4_invite",isNewMsg:!0,inviteGrpJpegThum:i,inviteCode:r,inviteCodeExp:a,inviteGrp:e,inviteGrpName:t,comment:n};return(0,oe.addAndSendMsgToChat)(this,o)[1]}_isMediaMsg(e){return Boolean(e.asMms&&!e.ctwaContext)}_forwardMessageAndSendToChat(e,t,r=!1){if(this._isMediaMsg(e))return(0,W.forwardMediaMsg)(e,this,r).then(void 0);var a=Fe(e),n=(0,G.getMaybeMeUser)(),i=new J.default({from:n,to:t,id:(0,ne.default)(),participant:void 0,selfDir:"out"});return e.ctwaContext&&(a.body=e.ctwaContext.sourceUrl,a.type=R.default.MSG_TYPE.CHAT,a.mediaObject=void 0),de.default.ephemeralMessages&&(this.isEphemeralSettingOn()&&(a.ephemeralDuration=this.getEphemeralSetting()),a.ephemeralSettingTimestamp=this.getEphemeralSettingTimestamp()),Object.assign(a,{id:i,from:n,t:w.default.globalUnixTime(),to:t,ack:R.default.ACK.CLOCK,participant:void 0,local:!0,self:"out",isNewMsg:!0,star:!1,isForwarded:e.isForwarded||!e.isSentByMe,forwardedFromWeb:!0,forwardingScore:e.getForwardingScoreWhenForwarded(),multicast:r}),(0,oe.addAndSendMsgToChat)(this,a),Promise.resolve()}forwardMessages(e,t=!1){var r=this;return(0,i.default)((function*(){var a=r.id,n=r.contact;if(n.isUser&&n.isBlocked())throw new D.default("Forwarded to contact is blocked",n);var i=[];for(var s of e)try{yield r._forwardMessageAndSendToChat(s,a,t)}catch(e){r._isMediaMsg(s)&&i.push(s)}return i}))()}updateReadOnly(){if(!this.isSupportGroup()||!this.isReadOnly){var e=Promise.resolve();if(this.isGroup&&!this.groupMetadata.stale){var t=!1;t=x.default.supportsFeature(x.default.F.MD_BACKEND)?!this.groupMetadata.participants.get((0,G.getMeUser)()):!this.groupMetadata.participants.get((0,G.getMaybeMeUser)()),e=(0,me.updateLocal)(this.id,{isReadOnly:t}).then((()=>this.isReadOnly=t))}e.then((()=>{this.isBroadcast&&this.updateTitle()}))}}updateIsAnnounceGrpRestrict(){if(this.isGroup&&!this.groupMetadata.stale){var e=this.groupMetadata.participants.get((0,G.getMaybeMeUser)()),t=e&&!e.isAdmin&&this.groupMetadata.announce;(0,me.updateLocal)(this.id,{isAnnounceGrpRestrict:t}).then((()=>this.isAnnounceGrpRestrict=t))}}sortMsgs(e){var t=e.map((e=>{var t=(0,$.default)(e.msgChunk,"msg.msgChunk");return{msg:e,chunkT:(0,$.default)(t.at(0),"chunk.at(0)").t,index:t.indexOf(e)}}));return(0,c.default)(t,["chunkT","index"]).map((e=>e.msg))}_updateAssignedColor(){if(this.colors){var e=this.groupMetadata.participants,t=this.colors,r=(0,d.default)(Object.keys(t),e.map((e=>e.id.toString())).map(j.default));r.forEach((function(e){delete t[e]})),r.length&&this._saveAssignedColors()}}loadAssignedColors(){return this.groupMetadata&&this.listenTo(this.groupMetadata.participants,"remove reset",this._updateAssignedColor),(0,G.getGroupParticipantAssignedColor)(this.id)||{}}saveAssignedColors(){var e=this.colors;e&&(0,G.setGroupParticipantAssignedColor)(this.id,e)}assignedColor(e){var t,r=this.colors||(this.colors=this.loadAssignedColors()),a=(0,j.default)(e.toString());if(t=r[a])return t;var n={};(0,l.default)(r,((e,t)=>{n[e]?n[e].push(t):n[e]=[t]}));for(var i=Number.POSITIVE_INFINITY,s=1;s<R.default.NUM_COLORS;s++){if(!n[s]){t=s;break}n[s].length<i&&(i=n[s].length,t=s)}return r[a]=t,this._saveAssignedColors(),t}unstarAll(){var e=this.getAllMsgs();e.forEach((e=>{e&&(e.star=!1)})),(0,fe.removeStarredMsgs)(e)}constructMediaMsgs(e){return e?e.isViewOnce?new A.default:(this.getMediaMsgs().includes(e)||e.msgChunk===this.msgs?(t=this.getMediaMsgs()).hasMediaAfter=!1:t=new A.default,t.includes(e)||(e.msgChunk?t.add(e.msgChunk.filter(this.isMsgForMediaCollection)):t.add(e)),t):this.getMediaMsgs();var t}fts(e,t=1,r){if(1===t){var a=this.ftsCache[e];if(a)return a;var n=q.default.search(e,t,r,this.id);this.ftsCache[e]=n;var i=()=>{this.ftsCache[e]=null};return setTimeout(i,3e5),n.catch(i),n}return q.default.search(e,t,r,this.id)}_clearFtsCache(){this.ftsCache={}}updateSortTime(){this.promises.updateSortTime||(this.promises.updateSortTime=this.regCancellablePromise((0,_.delayMs)(0)).then((()=>{var e=this.getLastTimestampMsg();return e?(this.t=e.t,Promise.resolve()):this.msgs.msgLoadState.noEarlierMsgs||this.pendingMsgs?Promise.resolve():this.loadEarlierMsgs()})).then((e=>{if(e){var t=this.getLastTimestampMsg();this.t=t?t.t:void 0}})).catch((()=>{})).finally((()=>{this.promises.updateSortTime=void 0})))}removeFromCollection(e){e.star&&(0,fe.removeStarredMsgs)([e]),e.isMedia&&this.mediaMsgs?this.mediaMsgs.remove(e):e.getLinks().length&&this.linkMsgs?this.linkMsgs.remove(e):e.asDoc&&this.docMsgs?this.docMsgs.remove(e):null!=e.asProduct&&this.productMsgs&&this.productMsgs.remove(e),this.updateMediasCountOnMsg(e,!0)}getMediaMsgs(){return this.mediaMsgs||(this.mediaMsgs=new A.default),this.mediaMsgs}getLinkMsgs(){return this.linkMsgs||(this.linkMsgs=new b.default),this.linkMsgs}getDocMsgs(){return this.docMsgs||(this.docMsgs=new T.default),this.docMsgs}getParticipantCount(){var e;return(null===(e=this.groupMetadata)||void 0===e?void 0:e.participants.length)||1}getProductMsgs(){return this.productMsgs||(this.productMsgs=new P.default),this.productMsgs}getReceivedVcardMsgs(){return this.contact.isMyContact||!this.contact.isUser?null:(this.receivedVcardMsgs||(this.receivedVcardMsgs=new O.default,this.receivedVcardMsgs.parent=this),this.receivedVcardMsgs)}dismissVcard(){this.vcardDismissed=!0}updateMediasCountOnMsg(e,t=!1){if(x.default.supportsFeature(x.default.F.MEDIAS_COUNT)){var r=t?-1:1;e.isMedia&&(this.mediaCount+=r);var a=e.getLinks().length;a&&(this.linkCount+=r*a),e.asDoc&&(this.docCount+=r)}}resetMediasCount(e){x.default.supportsFeature(x.default.F.MEDIAS_COUNT)&&(null!=e.mediaCount&&(this.mediaCount=e.mediaCount),null!=e.linkCount&&(this.linkCount=e.linkCount),null!=e.docCount&&(this.docCount=e.docCount))}getStarredMsgs(){var e=this.starredMsgs;return e||(this.starredMsgs=e=new fe.StarredMsgCollection,this.starredMsgs.add(fe.default.filter((e=>e.chat===this)))),e}setAndKeepPrevious(e,t){var r=Object.keys(e);r.forEach((e=>{e in this.ackedProps||(this.ackedProps[e]=this[e])})),t.finally((()=>{r.forEach((e=>{delete this.ackedProps[e]}))})),this.set(e)}getAckedPhoneProps(){return{wid:this.id,mute:this.mute.expiration,active:this.active,isReadOnly:this.isReadOnly,modifyTag:this.modifyTag,unreadCount:this.unreadCount,ephemeralDuration:this.ephemeralDuration,ephemeralSettingTimestamp:this.ephemeralSettingTimestamp,changeNumberOldJid:this.changeNumberOldJid,changeNumberNewJid:this.changeNumberNewJid,archive:"archive"in this.ackedProps?this.ackedProps.archive:this.archive,notSpam:"notSpam"in this.ackedProps?this.ackedProps.notSpam:this.notSpam,pin:"pin"in this.ackedProps?this.ackedProps.pin:this.pin}}regCancellablePromise(e){return this._promises||(this._promises=[]),this._promises.push(e),e.cancellable().finally((()=>{this._promises=(0,u.default)(this._promises,e),this._promises&&0===this._promises.length&&(this._promises=null)}))}cancelPendingPromises(){this._promises&&this._promises.length>0&&(this._promises.forEach((function(e){e.cancel()})),this._promises=null)}matchFilter(e={}){return!!(0,p.default)(e)||(e.label?this.labels&&this.labels.includes(e.label):e.kind===R.default.SMB_SEARCH_FILTERS.UNREAD?!!this.hasUnread:e.kind===this.kind)}getEphemeralSetting(){if(!de.default.ephemeralMessages)return null;var e=this.isGroup?this.groupMetadata.ephemeralDuration:this.ephemeralDuration;return null==e||0===e?null:e}getEphemeralSettingTimestamp(){return de.default.ephemeralMessages?this.isGroup||0===this.ephemeralSettingTimestamp?null:this.ephemeralSettingTimestamp:null}isEphemeralSettingOn(){if(!de.default.ephemeralMessages)return!1;var e=this.getEphemeralSetting();return null!=e&&0!==e}shouldShowEphemeralSetting(){if(!de.default.ephemeralMessages)return!1;if(!de.default.ephemeralMessagesSetting)return!1;if(!x.default.supportsAnyFeature(x.default.F.EPHEMERAL_MESSAGES,x.default.F.MD_BACKEND))return!1;if(this.isGroup){var e=this.groupMetadata.participants.getSuperAdmin();if(e&&e.contact.isEnterprise)return!1;if(!this.groupMetadata.canSetEphemeralSetting()&&!this.isEphemeralSettingOn())return!1}return!this.isBroadcast&&!this.contact.isEnterprise}getCollection(){return r(43334).default}getGroupMetadataCollection(){return r(99922).default}}function Fe(e){var t,r=["buttons","caption","broadcast","ephemeralDuration","ephemeralSettingTimestamp","ephemeralStartTimestamp","ephemeralOutOfSync","dynamicReplyButtons","replyButtons"];return!0===e.isDynamicReplyButtonsMsg&&e.type===R.default.MSG_TYPE.CHAT||(r=["footer",...r]),(null===(t=e.quotedMsg)||void 0===t?void 0:t.type)!==R.default.MSG_TYPE.PRODUCT&&(r=["quotedMsg","quotedParticipant","quotedRemoteJid","quotedStanzaID",...r]),(0,o.default)(e.toJSON(),r)}Ue.Proxy="chat",Ue.idClass=ye.default;var Ge=(0,y.defineModel)(Ue);t.default=Ge},84840:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=(e,t)=>{var r=e.pin||0,a=t.pin||0;if(r||a)return r!==a?r>a?-1:1:e.id.toString()<t.id.toString()?-1:1;var n=e.t||0,i=t.t||0;return n!==i?n>i?-1:1:e.id.toString()<t.id.toString()?-1:1};t.default=r},43334:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.ChatCollection=void 0;var i=n(r(19976)),s=n(r(52954)),o=n(r(42208)),u=n(r(60417)),l=n(r(90882)),d=n(r(16760)),c=n(r(45455)),f=n(r(54073)),p=r(91460),h=r(5497),_=a(r(54019)),m=r(43322),g=n(r(46774)),v=n(r(84840)),E=a(r(52737)),y=n(r(50935)),S=n(r(7470)),T=r(15790),b=r(19741),A=r(12392),C=n(r(24)),P=n(r(22182)),O=r(95595),w=n(r(18120)),M=r(78986),I=n(r(23539)),R=n(r(77865)),D=n(r(11680)),N=n(r(75537)),L=n(r(49569)),k=r(54371),U=r(17555),F=r(1767),G=n(r(2734)),x=n(r(47805)),B=n(r(48967)),Y=r(51803),K=n(r(17744)),j=n(r(68384)),W=a(r(12767));function V(){var e=(0,i.default)(["ChatCollection:saveToCache save: ",""]);return V=function(){return e},e}function H(){var e=(0,i.default)(["ChatStore:resyncMessages resume dropped"]);return H=function(){return e},e}function q(){var e=(0,i.default)(["model:chat:resume error in processing checksum:",""]);return q=function(){return e},e}function z(){var e=(0,i.default)(["model:chat:resume error in processing reply:",""]);return z=function(){return e},e}function J(){var e=(0,i.default)(["model:chat:resume: deleted chat for ",""]);return J=function(){return e},e}function Q(){var e=(0,i.default)(["model:chat:resume: cleared chat for ",""]);return Q=function(){return e},e}function X(){var e=(0,i.default)(["ChatStore:resyncMessages resume success"]);return X=function(){return e},e}function Z(){var e=(0,i.default)(["ChatStore:resyncMessages resume error ",""]);return Z=function(){return e},e}function $(){var e=(0,i.default)(["ChatStore:resyncMessages"]);return $=function(){return e},e}class ee extends _.default{constructor(){super(),this.notSpam={},this.promises={sendUnstarAll:null},this._sortEnabled=!1,this._viewOnceCleanupTaskQueue=new Set,this.enableSortListener(),this.listenTo(W.default,"change:stream",(()=>{W.default.stream===W.STREAM.RESUMING&&this.forEach((e=>{e.pendingMsgs=!1}))})),this.listenToOnce(this,"sort",(0,f.default)(this.setIndexes,100)),this._scheduleViewOnceMediaCleanup()}_scheduleViewOnceMediaCleanup(){clearTimeout(this._viewOnceCleanupTimeout),this._viewOnceCleanupTimeout=setTimeout((()=>{M.IdleCallbackTasks.enqueue((()=>{this._runViewOnceMediaCleanup(),this._scheduleViewOnceMediaCleanup()}))}),18e5)}_runViewOnceMediaCleanup(){this.forEach((e=>{var t=e.id;this._viewOnceCleanupTaskQueue.has(t)||(M.IdleCallbackTasks.enqueue((()=>{this._viewOnceCleanupTaskQueue.delete(t);var e=this.get(t);!1===(null==e?void 0:e.active)&&e.deregisterExpiredViewOnceBulkMessages(e.msgs)})),this._viewOnceCleanupTaskQueue.add(t))}))}enableSortListener(e){this._sortEnabled||(this.listenTo(this,"change:t change:pin change:shouldAppearInList",this.sort),e&&this.sort(),this._sortEnabled=!0)}disableSortListener(){this._sortEnabled&&(this.stopListening(null,null,this.sort),this._sortEnabled=!1)}setIndexes(){this.forEach(((e,t)=>{e.initialIndex=t}))}active(){var e=this.filter((e=>e.active))[0];return e||void 0}find(e){return w.default.supportsFeature(w.default.F.MD_BACKEND)?this._findMD(e):super.find(e)}_find(e){return Promise.resolve({id:e,createdLocally:!0})}_findQuery(e){var t=this,a={};return(0,A.find)(!!e.retry,a).then((function(e){if("preempted"===e)return Promise.reject("chats preempted");if(E.default.platform===E.PLATFORMS.IPHONE||E.default.platform===E.PLATFORMS.SMBI){var n=r(58885).default;(0,c.default)(e)?n.trigger(y.default.COLLECTION_HAS_SYNCED):setTimeout((()=>{n.trigger(y.default.COLLECTION_HAS_SYNCED)}),2500)}return t.trigger(y.default.COLLECTION_HAS_SYNCED,a),Promise.resolve(e)}))}_findMD(e){var t=()=>super.find,r=this;return(0,s.default)((function*(){var a=r.get(e);return a||((a=yield(0,A.findLocal)(String(e)))?r.gadd(a):((a=yield t().call(r,e))&&(yield(0,T.createLocal)(a.id,{id:a.id.toString(),t:a.t,unreadCount:a.unreadCount,archive:a.archive,isReadOnly:a.isReadOnly,modifyTag:a.modifyTag,notSpam:a.notSpam,pin:a.pin,changeNumberOldJid:null!=a.changeNumberOldJid?a.changeNumberOldJid.toString():void 0,changeNumberNewJid:null!=a.changeNumberNewJid?a.changeNumberNewJid.toString():void 0,muteExpiration:a.muteExpiration,endOfHistoryTransferType:a.endOfHistoryTransferType})),a))}))()}sync(){this.findQuery({}).catchType(b.WebdDrop,(()=>{}));var e=r(58885).default;return Promise.all([(0,K.default)(this,y.default.COLLECTION_HAS_SYNCED),e.hasSynced()])}getKeysForResyncMsgs(){return this.filter((function(e){return e.shouldAppearInList})).map((function(e){var t=e.getAckedPhoneProps(),r=e.lastReceivedKey;return r&&(t.id=r.id,t.fromMe=r.fromMe.toString(),t.participant=r.participant),t}))}resyncMessages(){__LOG__(2)($());var e=this.getKeysForResyncMsgs();return(0,k.resyncMessages)(e).then((e=>{if(e.status>=400)return __LOG__(3)(Z(),e.status),Promise.reject(new Error("ChatStore:resyncMessages resume error "+e.status));__LOG__(2)(X());try{this.disableSortListener(),e.data.forEach((e=>{if(e.disableUnreadAnchor=!1,e.firstUnreadKey=void 0,e.keys&&1===e.keys.length){var t=e.keys[0];e.firstUnreadKey=new R.default({id:t[0],fromMe:t[1],participant:t[2],remote:e.id})}if("delete"!==e.type&&!j.default.isPSA(e.id)){var r=S.default.get(e.id);if(r){if(e.name){var a={name:e.name};(0,Y.updateLocal)(r.id,a).then((()=>{r.set(a)}))}}else S.default.add({id:e.id,name:e.name})}var n=this.get(e.id);if(n)if("clear"===e.type){n.resetMediaMsgs();var i=[];n.msgs.forEach((e=>i.push(e))),n.msgChunks.length&&n.msgChunks.forEach((e=>{e.forEach((e=>i.push(e)))})),n.set({t:e.t,unreadCount:e.unreadCount,createdLocally:!1,archive:e.archive,isReadOnly:e.isReadOnly,modifyTag:e.modifyTag,msgs:[],notSpam:e.notSpam,unreadMsgAnchor:void 0,disableUnreadAnchor:e.disableUnreadAnchor,pendingMsgs:e.pendingMsgs,pin:e.pin,changeNumberOldJid:e.changeNumberOldJid,changeNumberNewJid:e.changeNumberNewJid,muteExpiration:e.muteExpiration,ephemeralDuration:e.ephemeralDuration,ephemeralSettingTimestamp:e.ephemeralSettingTimestamp}),i.forEach((e=>{e.delete()})),__LOG__(2)(Q(),e.id)}else"delete"===e.type?(n.delete(),__LOG__(2)(J(),e.id)):n.set(e,{merge:!0});else this.add(e)})),this.enableSortListener(!0)}catch(e){__LOG__(3)(z(),String(e))}(0,p.delayMs)(100).then((()=>{w.default.supportsFeature(w.default.F.USER_NOTICE)&&D.default.sync(!0),w.default.supportsFeature(w.default.F.SETTINGS_SYNC)&&G.default.sync(!0),e.checksum&&(0,U.resyncContacts)(e.checksum),e.statusChecksum&&r(57185).default.sync(e.statusChecksum),e.quickRepliesChecksum&&N.default.sync(e.quickRepliesChecksum),e.labelsChecksum&&I.default.sync(e.labelsChecksum),e.stickerPackChecksum&&B.default.sync(e.stickerPackChecksum),null!=e.recentStickersChecksum&&L.default.sync(e.recentStickersChecksum),null!=e.starredStickersChecksum&&x.default.sync(e.starredStickersChecksum)})).catch((e=>{__LOG__(3)(q(),String(e))}))})).catchType(b.WebdDrop,(function(e){return __LOG__(3)(H()),Promise.reject(e)}))}unstarAllMessages(e,t){return(0,F.unstarAllMessages)(e,t)}forwardMessagesToChats(e,t){var a=Promise.all(e.map((e=>(0,h.promiseProps)({message:e,canForward:e.canForward()&&(null!=r(58885).default.get(e.id)||e.isEphemeral)}))));return Promise.all(t.filter((e=>e.canSend)).map((e=>{var t;return t=e.isUser&&e.contact.isBlocked()?(0,m.unblockContact)(e.contact):Promise.resolve(!0),Promise.all([a,t]).spread((t=>{var r=(0,d.default)((0,l.default)(t,{canForward:!0}),"message"),a=(0,d.default)((0,l.default)(t,{canForward:!1}),"message");return(0,h.promiseProps)({chat:e,undelivered:e.forwardMessages(r,!0),canForward:r,cannotForward:a})}))}))).then((e=>{var t=(0,u.default)(e.map((({chat:e,undelivered:t,canForward:r,cannotForward:a})=>{var n=null;return(t.length||a.length)&&(n=(0,C.default)({chat:e,undelivered:t,canForward:r,cannotForward:a})),n?{chat:e,reason:n}:null})));if(t.length)throw new P.default(t);return!0}))}saveToCache(){if(E.default.shouldSaveToCache()){var{id:e}=ee.cachePolicy;__LOG__(2)(V(),String(e));var t=this.map(((e,t)=>{var r=e.toJSON(),a=t<20?Math.min(e.unreadCount+20,50):Math.min(Math.max(3,e.unreadCount),20);return r.msgs=e.msgs?e.msgs.slice(-a).map((e=>(0,o.default)(e.toJSON(),(e=>void 0!==e)))):[],r}));(0,O.setCollection)(e,t,!0)}}onResume(){var e=this.active();e&&e.presence.subscribe()}delete(){super.delete(),this.listenToOnce(this,"sort",(0,f.default)(this.setIndexes,100))}}t.ChatCollection=ee,ee.model=g.default,ee.comparator=v.default,ee.cachePolicy={id:"chat",policy:_.CACHE_POLICY.IMMEDIATE,trigger:"add sort remove reset change:id change:t change:unreadCount change:archive change:isReadOnly change:isAnnounceGrpRestrict change:modifyTag change:muteExpiration change:name change:notSpam change:pin change:changeNumberOldJid change:changeNumberNewJid change:lastReceivedKey change:msg:ack msgs:loadEarlier"};var te=new ee;t.default=te},5320:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(r(54019)),s=n(r(50935)),o=r(19741),u=a(r(96452)),l=n(r(27e3)),d=n(r(58885));class c extends i.default{constructor(...e){super(...e),this.hasDocBefore=!0}delete(){super.delete(),this.stopListening(),this.reset()}queryDocs(e,t){if(t)return this.queryDocBefore||(this.queryDocBefore=d.default.queryMedia(t.id.remote,s.default.MEDIA_QUERY_LIMIT,"before",t.id,"document").then((e=>((!e||e.length<s.default.MEDIA_QUERY_LIMIT)&&(this.hasDocBefore=!1),this.add(e.filter(f),{at:0}),{length:e.length}))).catchTypes(o.WebdDrop,u.ProtoVersionUndefined,(()=>{})).catchEqualTo(404,(()=>{})).finally((()=>{this.queryDocBefore=null,this.trigger("query_doc_before")})),this.trigger("query_doc_before")),this.queryDocBefore;var r=e.msgs;if(0===this.length){if(!r||0===r.length)return this.hasDocBefore=!1,new Promise((e=>{e({eof:!0})}));this.add(r.filter(f),{at:0})}if(e.msgs.msgLoadState.noEarlierMsgs)return this.hasDocBefore=!1,new Promise((e=>{e({eof:!0})}));if(this.length<=2*s.default.MEDIA_QUERY_LIMIT){var a=0===this.length?r.head():this.head();return this.queryDocs(e,a)}return new Promise((e=>{e({eof:!1})}))}}function f(e){return null!=e.asDoc&&!e.isVcardOverMmsDocument}t.default=c,c.model=l.default},45883:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(r(54019)),s=n(r(50935)),o=r(19741),u=a(r(96452)),l=n(r(27e3)),d=n(r(58885));class c extends i.default{constructor(...e){super(...e),this.hasLinkBefore=!0}delete(){super.delete(),this.stopListening(),this.reset()}queryLinks(e,t){if(t)return this.queryLinkBefore||(this.queryLinkBefore=d.default.queryMedia(t.id.remote,s.default.MEDIA_QUERY_LIMIT,"before",t.id,"url").then((e=>((!e||e.length<s.default.MEDIA_QUERY_LIMIT)&&(this.hasLinkBefore=!1),this.add(e,{at:0}),this.createLinksAndAddMsgs(e),{length:e.length}))).catchTypes(o.WebdDrop,u.ProtoVersionUndefined,(()=>{})).catchEqualTo(404,(()=>{})).finally((()=>{this.queryLinkBefore=null,this.trigger("query_link_before")})),this.trigger("query_link_before")),this.queryLinkBefore;var r=e.msgs.getModelsArray();if(0===this.length){if(!r||0===r.length)return this.hasLinkBefore=!1,new Promise((e=>{e({eof:!0})}));this.add(r.filter((e=>e.getLinks().length>0)),{at:0}),this.createLinksAndAddMsgs(r)}if(e.msgs.msgLoadState.noEarlierMsgs)return this.hasLinkBefore=!1,new Promise((e=>{e({eof:!0})}));if(this.length<=2*s.default.MEDIA_QUERY_LIMIT){var a=0===this.length?e.msgs.head():this.head();return this.queryLinks(e,a)}return new Promise((e=>{e({eof:!1})}))}createLinksAndAddMsgs(e){var t=[];Promise.loop(((r,a,n)=>{e.length===n&&r();var i=e[n];i.getLinks().length&&t.push(i)})).then((()=>{this.add(t),this.trigger("query_link_before")}))}}t.default=c,c.model=l.default,c.comparator=(e,t)=>e.t-t.t},55526:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(r(54019)),s=n(r(50935)),o=r(19741),u=a(r(96452)),l=n(r(27e3)),d=n(r(58885)),c="before",f="after";function p(e){return e.isMedia&&!e.isViewOnce}class h extends i.default{constructor(...e){super(...e),this.hasMediaBefore=!0,this.hasMediaAfter=!0}delete(){super.delete(),this.stopListening()}getAfter(e){var t=this.indexOf(e);return t<0||t===this.length-1?null:this.at(t+1)}getBefore(e){var t=this.indexOf(e);return t<=0?null:this.at(t-1)}loadEarlierMedias(){var e=this.head();e&&this.queryMedia({msg:e})}loadRecentMedias(){var e=this.last();e&&this.queryMedia({msg:e,direction:f})}loadMoreAroundIfNeeded(e){if(e&&!e.isViewOnce){var t=this.indexOf(e);t<20&&this.hasMediaBefore&&this.loadEarlierMedias(),this.length-t<20&&this.hasMediaAfter&&this.loadRecentMedias()}}queryMedia(e){var t,{chat:r,msg:a}=e,n=null!==(t=e.direction)&&void 0!==t?t:c;if(!a&&r){var i=r.msgs;if(!i||0===i.length)return this.hasMediaBefore=!1,new Promise((e=>{e({eof:!0})}));this.add(i.filter(p),{at:0});var l=this.toArray();if(r.msgs.msgLoadState.noEarlierMsgs)return this.hasMediaBefore=!1,new Promise((e=>{e({eof:!0})}));if(l.length<=2*s.default.MEDIA_QUERY_LIMIT){var h=0===l.length?i.head():l[0];return this.queryMedia({chat:r,msg:h})}return new Promise((e=>{e({eof:!1})}))}if(a&&n===c){if(this.queryMediaBefore)return this.queryMediaBefore;var _=0;return this.queryMediaBefore=d.default.queryMedia(a.id.remote,s.default.MEDIA_QUERY_LIMIT,n,a.isMedia?a.id:void 0).then((e=>{var t=e.messages;(!t||t.length<s.default.MEDIA_QUERY_LIMIT)&&(this.hasMediaBefore=!1);var a=[];t&&t.length>0&&(a=t.filter(p)),this.add(a,{at:0});var n={mediaCount:e.mediaCount,linkCount:e.linkCount,docCount:e.docCount};return r&&r.resetMediasCount(n),{length:_=a.length}})).catchTypes(o.WebdDrop,u.ProtoVersionUndefined,(()=>{})).catchEqualTo(404,(()=>{})).finally((()=>{this.queryMediaBefore=null,this.trigger("query_media_before",_)})),this.trigger("query_media_before",0),this.queryMediaBefore}if(a&&n===f)return this.queryMediaAfter?this.queryMediaAfter:this.queryMediaAfter=d.default.queryMedia(a.id.remote,s.default.MEDIA_QUERY_LIMIT,n,a.id).then((e=>{var t=e.messages;(!t||t.length<s.default.MEDIA_QUERY_LIMIT)&&(this.hasMediaAfter=!1);var a=[];t&&t.length>0&&(a=t.filter(p)),this.add(a);var n={mediaCount:e.mediaCount,linkCount:e.linkCount,docCount:e.docCount};return r&&r.resetMediasCount(n),{length:a.length}})).catchTypes(o.WebdDrop,u.ProtoVersionUndefined,(()=>{})).catchEqualTo(404,(()=>{})).finally((()=>{this.queryMediaAfter=null,this.trigger("query_media_after")}))}}t.default=h,h.model=l.default},90980:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.MsgLoadState=void 0;var i=n(r(47677)),s=n(r(54019)),o=a(r(61247)),u=n(r(27e3));class l extends o.default{constructor(...e){super(...e),this.noEarlierMsgs=(0,o.prop)(),this.isLoadingEarlierMsgs=(0,o.prop)(),this.isLoadingRecentMsgs=(0,o.prop)(),this.isLoadingAroundMsgs=(0,o.prop)(),this.contextLoaded=(0,o.prop)()}}l.Proxy="msgLoad";var d=(0,o.defineModel)(l);t.MsgLoadState=d;class c extends s.default{constructor(){super(),this.msgLoadState=new d({noEarlierMsgs:!1,isLoadingEarlierMsgs:!1,isLoadingRecentMsgs:!1,isLoadingAroundMsgs:!1,contextLoaded:!1}),this.listenTo(this,"add remove reset sort",this.triggerChangeLast)}delete(){this.stopListening(),super.delete(),this.msgLoadState.delete()}triggerChangeLast(e,t,r){var a=this.last();if(this._last!==a){this._last=a;var n=!1;t&&t.includes(e)&&r&&r.add&&!r.remove&&(n=!0),this.trigger("change:last",a,n)}}add(e,t){var a=super.add(e,t);return r(58885).default.add(a,t).forEach((e=>{e&&this.isModel(e)&&(e.msgChunk=this)})),a&&this.trigger("bulk_add",a,t),a}remove(e,t={},r=!1){var a=super.remove(e,t),n=!!t&&t.silent,i=a.filter((e=>!!e));return i.length&&!n&&(this.trigger("remove_msgs",i,t),r||this.trigger("update_sort_time")),a}replace(e){this.msgLoadState=e.msgLoadState,this.loadRecentPromise=e.loadRecentPromise,this.loadEarlierPromise=e.loadEarlierPromise,this.loadAroundPromise=e.loadAroundPromise;var t=e.getModelsArray();this.set(t,{silent:!0,merge:!1}),t.forEach((e=>{this.isModel(e)&&(e.msgChunk=this)})),this.trigger("bulk_add",t)}onMsgLoadStateChange(e){var t,r=()=>{e()},a=()=>{(0,i.default)(null!=t,"prevMsgLoadState cannot be null after bulk_add"),t.off("change",r);var a=this.msgLoadState;a.on("change",r),t=a,e()};(t=this.msgLoadState).on("change",r),this.on("bulk_add",a);var n=()=>{(0,i.default)(null!=t,"prevMsgLoadState cannot be null when unsubscribing"),this.off("bulk_add",a),t.off("change",r)};return()=>{var e=n;e&&(n=null,e())}}}t.default=c,c.model=u.default},61:(e,t,r)=>{"use strict";var a=r(14859),n=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.DEFAULT_PREFERENCE=void 0;var i=n(r(61247)),s=a(r(68384)),o="defaultPreference";t.DEFAULT_PREFERENCE=o;class u extends i.default{constructor(...e){super(...e),this.id=(0,i.prop)(),this.wallpaperColor=(0,i.prop)(),this.saveToCameraRoll=(0,i.prop)(),this.showDoodle=(0,i.prop)()}getCollection(){return r(23109).default}}u.Proxy="chatPreference",u.idClass=s.default,u.allowedIds=[o];var l=(0,i.defineModel)(u);t.default=l},23109:(e,t,r)=>{"use strict";var a=r(14859),n=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(r(54019)),s=n(r(61)),o=a(r(50935));class u extends i.default{initializeFromCache(e){this.add([{id:s.DEFAULT_PREFERENCE,wallpaperColor:o.default.DEFAULT_CHAT_WALLPAPER,saveToCameraRoll:!0,showDoodle:!0},...e||[]],{merge:!0})}get(e){return super.get(e)||super.get(s.DEFAULT_PREFERENCE)}delete(){super.delete(),this.add({id:s.DEFAULT_PREFERENCE,wallpaperColor:o.default.DEFAULT_CHAT_WALLPAPER,saveToCameraRoll:!0,showDoodle:!0})}}u.model=s.default,u.cachePolicy={id:"chat_preference",policy:i.CACHE_POLICY.LOAD,delay:1e3};var l=new u;t.default=l},56953:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(54019)),i=a(r(27e3));class s extends n.default{constructor(...e){super(...e),this.hasProductBefore=!0}delete(){super.delete(),this.stopListening(),this.reset()}queryProducts(e){var t=e.msgs;return this.hasProductBefore=!1,this.add(t.filter((e=>null!=e.asProduct)),{at:0}),Promise.resolve()}}t.default=s,s.model=i.default,s.comparator=(e,t)=>e.t-t.t},7020:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(54019)),i=r(19741),s=a(r(18120)),o=a(r(27e3)),u=a(r(58885));class l extends n.default{constructor(...e){super(...e),this.syncPromise=null,this.isSynced=!1}onResume(){this.isSynced=!1,this.sync(this.parent)}sync(e){return s.default.supportsFeature(s.default.F.INDEX_RECEIVED_VCARD)?this.isSynced?Promise.resolve():(this.syncPromise||(this.syncPromise=u.default.queryVcard(e.id).then((e=>this.add(e))).catchType(i.E499,(()=>{})).catch((()=>{})).finally((()=>{this.isSynced=!0,this.syncPromise=null}))),this.syncPromise):(this.isSynced=!0,Promise.resolve())}}t.default=l,l.model=o.default,l.resumeOnAvailable=!0},97741:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return o.apply(this,arguments)};var n=a(r(52954)),i=a(r(58447)),s=a(r(90382));function o(){return(o=(0,n.default)((function*(){(yield Promise.allSettled([(0,i.default)(),s.default.clear()])).forEach((e=>{if("rejected"===e.status)throw e.reason}))}))).apply(this,arguments)}},42871:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.handle=function([e]){switch(e.type){case"const":u.default[e.key]=e.value;break;case"read":if(e.isStatus){_.default.handle([e]);break}case"unread":var t=s.default.get(e.jid);t&&("read"===e.type?(0,m.markSeen)(t):"unread"===e.type&&(0,m.markUnseen)(t));break;case"log":o.upload({reason:"server-requested",immediate:!0,force:!0,isHighPri:!0});break;case"privacy":if(e.jid){var r=f.default.get(e.jid);r&&r.reset(),p.default.update(e.jid).catchType(d.WebdDrop,(()=>{})),h.default.update(e.jid).catchType(d.WebdDrop,(()=>{}))}else __LOG__(3)(y());break;case"identity":if(e.jid){var a=l.default.get(e.jid);a?(0,c.updateIdentity)(a,e):__LOG__(3)(E())}else __LOG__(3)(v());break;default:__LOG__(3)(g(),e.type)}};var i=n(r(19976)),s=n(r(43334)),o=a(r(3594)),u=n(r(50935)),l=n(r(7470)),d=r(19741),c=r(33526),f=n(r(99098)),p=n(r(15118)),h=n(r(76019)),_=n(r(57185)),m=r(58269);function g(){var e=(0,i.default)(["Store:Cmd:handle:unknown ",""]);return g=function(){return e},e}function v(){var e=(0,i.default)(["Store:Cmd:handle:identity no jid"]);return v=function(){return e},e}function E(){var e=(0,i.default)(["Store:Cmd:handle:identity no contact"]);return E=function(){return e},e}function y(){var e=(0,i.default)(["Store:Cmd:handle:privacy no jid"]);return y=function(){return e},e}},52737:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.Conn=t.PLATFORMS=void 0;var i=n(r(19976)),s=n(r(54073)),o=n(r(75652)),u=a(r(61247)),l=n(r(79711)),d=n(r(50935)),c=r(95595),f=n(r(18120)),p=n(r(86091)),h=n(r(17957)),_=r(63925),m=n(r(40210)),g=n(r(43711));function v(){var e=(0,i.default)(["Conn: platform change: ",""]);return v=function(){return e},e}function E(){var e=(0,i.default)(["Conn: updateVoipAvailability, getMaybeMeUser undefined"]);return E=function(){return e},e}function y(){var e=(0,i.default)(["Conn: updateVoipAvailability, isSystemCapableOfVoip false"]);return y=function(){return e},e}function S(){var e=(0,i.default)(["Conn: updateVoipAvailability, Voip initialized"]);return S=function(){return e},e}function T(){var e=(0,i.default)(["Conn: updateVoipAvailability, isSystemCapableOfVoip true"]);return T=function(){return e},e}function b(){var e=(0,i.default)(["Conn: updateVoipAvailability, Voip GK false"]);return b=function(){return e},e}function A(){var e=(0,i.default)(["Conn: updateVoipAvailability"]);return A=function(){return e},e}var C={ANDROID:"android",BB:"bb",BBX:"bbx",IPAD:"ipad",IPHONE:"iphone",IPOD:"ipod",S40:"s40",SMBA:"smba",SMBI:"smbi",SYMBIAN:"symbian",WP7:"wp7"};t.PLATFORMS=C;class P extends u.default{constructor(...e){super(...e),this.id=(0,u.prop)(),this.ref=(0,u.prop)(),this.refTTL=(0,u.prop)(),this.refId=(0,u.prop)(),this.wid=(0,u.prop)(),this.connected=(0,u.prop)(),this.protoVersion=(0,u.prop)(),this.clientToken=(0,u.prop)(),this.serverToken=(0,u.prop)(),this.secret=(0,u.prop)(),this.isResponse=(0,u.prop)(),this.battery=(0,u.prop)(),this.plugged=(0,u.prop)(),this.lc=(0,u.prop)(),this.lg=(0,u.prop)(),this.locales=(0,u.prop)(),this.is24h=(0,u.prop)(),this.platform=(0,u.prop)(),this.phone=(0,u.prop)(),this.tos=(0,u.prop)(),this.smbTos=(0,u.prop)(0),this.pushname=(0,u.prop)(),this.blockStoreAdds=(0,u.session)(!1),this.isVoipInitialized=(0,u.session)(!1),this.refExpiry=(0,u.derived)(this._refExpiry,["ref","refTTL"]),this.locale=(0,u.derived)(this._locale,["lg","lc"]),this.localesList=(0,u.derived)(this._localesList,["locales","lg","lc"]),this.allLocales=(0,u.derived)(this._allLocales,["localesList"]),this.allLanguages=(0,u.derived)(this._allLanguages,["localesList"]),this.platformField=(0,u.derived)(this._platformField,["platform"]),this.tosShowCallNotification=(0,u.derived)(this._tosShowCallNotification,["tos"]),this.isSMB=(0,u.derived)(this._isSMB,["platform"])}_refExpiry(){return Date.now()+this.refTTL}_locale(){return this.formatLocale(this.lg,this.lc)}_localesList(){return this.locales&&this.locales.length?this.locales.split(",").map((e=>{var[t,r]=e.split("-");return t?[t,r]:null})).filter(Boolean):this.lg?[[this.lg,this.lc]]:[]}_allLocales(){return(0,o.default)(this.localesList.map((([e,t])=>this.formatLocale(e,t)))).filter(Boolean)}_allLanguages(){return(0,o.default)(this.localesList.map((([e,t])=>e)))}_platformField(){return"wp7"===this.platform?m.default.PLATFORM_TYPE.WP:this.platform&&m.default.PLATFORM_TYPE[this.platform.toUpperCase()]||m.default.PLATFORM_TYPE.UNKNOWN}_tosShowCallNotification(){return f.default.supportsFeature(f.default.F.MD_BACKEND)||this.tos<2}_isSMB(){return this.platform===C.SMBA||this.platform===C.SMBI}initialize(){u.default.prototype.initialize.call(this),this.listenTo(this,"change:locale",(function(e,t){h.default.setLocale(t,d.default.L10N_PRIORITY.PHONE)})),this.listenTo(this,"change:plugged",(0,s.default)((()=>{m.default.Global.webcPhoneCharging=this.plugged}),5e3,{leading:!0})),this.listenTo(this,"change:phone",(()=>{!function(e={}){var{mcc:t,mnc:r}=e;t&&"string"==typeof t&&(t=parseInt(t,10));r&&"string"==typeof r&&(r=parseInt(r,10));m.default.Global.set({mcc:null!=t?t:null,mnc:null!=r?r:null,webcPhoneDeviceManufacturer:e.device_manufacturer||null,webcPhoneDeviceModel:e.device_model||null,webcPhoneOsBuildNumber:e.os_build_number||null,webcPhoneOsVersion:e.os_version||null,webcPhoneAppVersion:e.wa_version||null})}(this.phone)})),this.listenTo(this,"me_ready",this.updateVoipAvailability),this.listenTo(f.default,f.default.FEATURE_CHANGE_EVENT,this.updateVoipAvailability),this.listenTo(this,"change:platform",this.handlePlatformChange),this.listenTo(l.default,"server_props_updated",this.updateVoipAvailability)}delete(){(0,c.setPushname)(),(0,c.setVersion)(),this.clear()}canSetMyPushname(){return!this.isSMB}updateVoipAvailability(){__LOG__(2)(A()),(0,_.requireVoip)().then((e=>{if(!g.default.isVoiceCallEnabled()&&!g.default.isVideoCallEnabled())return __LOG__(2)(b()),e.cleanup(),void(this.isVoipInitialized=!1);this.id&&(0,c.getMaybeMeUser)()?(0,p.default)().then((t=>{t?(__LOG__(2)(T()),e.init().then((t=>{__LOG__(2)(S()),this.isVoipInitialized=t,t&&e.updateAudioVideoSwitch()}))):(__LOG__(2)(y()),e.cleanup(),this.isVoipInitialized=!1)})):(__LOG__(2)(E()),e.cleanup(),this.isVoipInitialized=!1)}))}handlePlatformChange(){__LOG__(2)(v(),this.platform),this.platform&&(0,c.setLastMobilePlatform)(this.platform)}formatLocale(e,t){return e?t?e.toLowerCase()+"-"+t.toUpperCase():e.toLowerCase():null}shouldSaveToCache(){return!!(0,c.getMe)()&&!!this.id}}t.Conn=P,P.Proxy="conn";var O=new((0,u.defineModel)(P))({id:"1"});t.default=O},77690:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=new RegExp("[A-Za-z-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------]");t.default=r},40147:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(r(19976)),s=n(r(77690)),o=a(r(61247)),u=n(r(79148)),l=r(28291),d=n(r(52737)),c=n(r(50935)),f=r(74460),p=r(95595),h=r(75459),_=n(r(17957)),m=r(28352),g=n(r(68560)),v=n(r(15118)),E=n(r(76019)),y=n(r(68384)),S=n(r(3111));function T(){var e=(0,i.default)(["contact:onPendingActionUpdate pendingAction value is invalid"]);return T=function(){return e},e}function b(){var e=(0,i.default)(["contact:getStatus for non-user ",""]);return b=function(){return e},e}var A=/^[^0-9]+$/;class C extends o.default{constructor(...e){super(...e),this.id=(0,o.prop)(),this.name=(0,o.prop)(),this.shortName=(0,o.prop)(),this.pushname=(0,o.prop)(),this.type=(0,o.prop)("in"),this.verifiedName=(0,o.prop)(),this.isBusiness=(0,o.prop)(),this.isEnterprise=(0,o.prop)(),this.verifiedLevel=(0,o.prop)(),this.actualActors=(0,o.prop)(),this.hostStorage=(0,o.prop)(),this.privacyModeTs=(0,o.prop)(),this.statusMute=(0,o.prop)(),this.sectionHeader=(0,o.prop)(),this.labels=(0,o.prop)(),this.isContactBlocked=(0,o.session)(!1),this.verificationString=(0,o.session)(),this.verificationBinary=(0,o.session)(),this.pendingAction=(0,o.session)(),this.promises=(0,o.session)((()=>({}))),this.status=(0,o.session)(),this.profilePicThumb=(0,o.session)(),this.businessProfile=(0,o.session)(),this.commonGroups=(0,o.session)(),this.liveLocations=(0,o.session)(),this.businessCatalog=(0,o.session)(),this.locale=(0,o.session)(),this.notifyName=(0,o.derived)(this._notifyNameFunction,["pushname","isBusiness","verifiedLevel","verifiedName"]),this.mentionName=(0,o.derived)(this._mentionName,["isMyContact","isBusiness","verifiedLevel","name","notifyName"]),this.displayName=(0,o.derived)(this._displayName,["id","mentionName","isMe"]),this.userid=(0,o.derived)(this._userid),this.userhash=(0,o.derived)(this._userhash),this.searchName=(0,o.derived)(this._searchName,["name","id","locale"]),this.searchVerifiedName=(0,o.derived)(this._searchVerifiedName,["verifiedLevel","verifiedName"]),this.header=(0,o.derived)(this._header,["name"]),this.isMe=(0,o.derived)(this._isMe),this.isUser=(0,o.derived)(this._isUser),this.isGroup=(0,o.derived)(this._isGroup),this.isBroadcast=(0,o.derived)(this._isBroadcast),this.isPSA=(0,o.derived)(this._isPSA),this.formattedShortNameWithNonBreakingSpaces=(0,o.derived)(this._formattedShortNameWithNonBreakingSpaces,["shortName","formattedName","id","locale"]),this.formattedShortName=(0,o.derived)(this._formattedShortName,["shortName","formattedName","id","locale"]),this.formattedName=(0,o.derived)(this._formattedName,["name","id","locale","verifiedLevel","verifiedName"]),this.formattedUser=(0,o.derived)(this._formattedUser,["name","id","locale","verifiedLevel","verifiedName"]),this.isWAContact=(0,o.derived)(this._isWAContact,["type"]),this.isMyContact=(0,o.derived)(this._isMyContact,["name"]),this.showBusinessCheckmarkAsPrimary=(0,o.derived)(this._showBusinessCheckmarkAsPrimary,["isBusiness","verifiedLevel","name","verifiedName"]),this.showBusinessCheckmarkAsSecondary=(0,o.derived)(this._showBusinessCheckmarkAsSecondary,["isBusiness","verifiedLevel","name","verifiedName"])}_notifyNameFunction(){return this.isBusiness&&this.verifiedLevel!==c.default.VERIFIED_LEVEL.HIGH?this.verifiedName:this.pushname}_mentionName(){return!this.isMyContact&&this.isBusiness&&this.verifiedLevel!==c.default.VERIFIED_LEVEL.HIGH?null:this.name||this.notifyName}_displayName(){return this.isMe&&d.default.pushname?d.default.pushname:this.mentionName||(0,S.default)(this.id)}_userid(){return this.isUser?y.default.user(this.id):null}_userhash(){return this.isUser?(0,g.default)((this.id.user||"")+"WA_ADD_NOTIF"):null}_searchName(){return y.default.isPSA(this.id)?_.default.accentFold(_.default.t(1907)):this.name?_.default.accentFold(this.name):null}_searchVerifiedName(){return this.verifiedLevel!==c.default.VERIFIED_LEVEL.HIGH?null:this.verifiedName?_.default.accentFold(this.verifiedName):null}_header(){if(this.name){var e=this.name.toLowerCase(),t=s.default.exec(e);if(t&&0===t.index||t&&A.test(e.slice(t.index))){var r=t[0],a=_.default.removeAccents(r);return(0,f.getCollator)().compare(a,r)?r:a}return"#"}}_isMe(){return this.id.equals((0,p.getMaybeMeUser)())}_isUser(){return y.default.isUser(this.id)}_isGroup(){return y.default.isGroup(this.id)}_isBroadcast(){return y.default.isBroadcast(this.id)}_isPSA(){return y.default.isPSA(this.id)}_formattedShortNameWithNonBreakingSpaces(){return this.id?this.isMe?_.default.t(1896):this.shortName||this.formattedName&&this.formattedName.replace(/\s/g," "):""}_formattedShortName(){return this.id?this.isMe?_.default.t(1896):this.shortName||this.formattedName:""}_formattedName(){return this.id?this.isMe?_.default.t(1896):y.default.isPSA(this.id)?_.default.t(1907):this.name?this.name:this.verifiedLevel===c.default.VERIFIED_LEVEL.HIGH&&this.verifiedName?this.verifiedName:this.isUser?(0,S.default)(this.id):"":""}_formattedUser(){return this.getFormattedUser()}_isWAContact(){return this.isUser&&"in"===this.type}_isMyContact(){return!!(this.isUser&&this.name&&this.name.length)}_showBusinessCheckmarkAsPrimary(){return this.isBusiness&&this.verifiedLevel===c.default.VERIFIED_LEVEL.HIGH&&(this.name===this.verifiedName||!this.name)}_showBusinessCheckmarkAsSecondary(){return this.isBusiness&&this.verifiedLevel===c.default.VERIFIED_LEVEL.HIGH&&Boolean(this.name)&&this.name!==this.verifiedName}initialize(){super.initialize(),this.id&&(this.isMe&&this.addChild("status",E.default.gadd(this.id)),this.isMe&&this.addChild("profilePicThumb",v.default.gadd(this.id)),(this.isBusiness||this.isMe&&d.default.isSMB)&&this.addChild("businessProfile",r(89216).default.gadd(this.id)),this.listenTo(this,"change:isBusiness",(()=>(0,l.onIsBusinessChange)(this))),this.listenTo(_.default,"locale_change",(()=>{this.locale=_.default.getLocale()})),this.listenTo(this,"change:name",this.updateShortName),this.isContactBlocked=!!u.default.get(this.id),this.pendingAction=0,d.default.isSMB&&(0,m.initializeLabels)(this))}updateShortName(){if(this.isUser&&this.name&&!this.shortName){var[e]=this.name.split(/\s/);s.default.exec(e)&&this.set("shortName",e)}}getStatus(){return y.default.user(this.id)||__LOG__(2)(b(),this.id.toString()),this.status=E.default.gadd(this.id)}getProfilePicThumb(){return this.profilePicThumb=v.default.gadd(this.id)}addPendingAction(e){if(e.isPending()){var t=()=>{this.decPending()};e.then(t,t),this.pendingAction++}return e}decPending(){this.pendingAction>0?this.pendingAction--:(__LOG__(2)(T()),this.pendingAction=0)}isBlocked(){return!!u.default.get(this.id)}searchMatch(e,t,r){var a;return(0,h.canDisplayLabel)()&&r?!(e&&this.searchName&&!this.searchName.includes(e))&&Boolean(null===(a=this.labels)||void 0===a?void 0:a.includes(r)):!!e&&(!(!this.searchName||!this.searchName.includes(e))||(!(!this.userid||!this.userid.includes(e))||(!!(t&&this.userid&&this.userid.includes(t))||(!(!this.searchVerifiedName||!this.searchVerifiedName.includes(e))||!(!this.pushname||!_.default.accentFold(this.pushname).includes(e))))))}getFormattedUser(){return this.id?y.default.isPSA(this.id)?_.default.t(1907):this.name?this.name:this.verifiedLevel===c.default.VERIFIED_LEVEL.HIGH&&this.verifiedName?this.verifiedName:(0,S.default)(this.id):""}set(e,t,r){var a=super.set(e,t,r);if("string"!=typeof e&&t&&t.merge&&a){if(a.isPSA)return a;!e.name&&a.name&&(a.unset("name"),a.unset("shortName")),!e.verifiedName&&a.verifiedName&&a.unset("verifiedName")}return a}getCollection(){return r(7470).default}setNotMyContact(){this.name&&this.set("name",void 0)}}C.Proxy="contact",C.idClass=y.default;var P=(0,o.defineModel)(C);t.default=P},7470:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.ContactCollection=void 0;var i=n(r(19976)),s=n(r(54073)),o=a(r(54019)),u=r(36655),l=n(r(50935)),d=n(r(40147)),c=n(r(74460)),f=r(19741),p=r(70703),h=r(95402),_=r(95595),m=n(r(17957)),g=n(r(74125)),v=n(r(17744)),E=a(r(12767));function y(){var e=(0,i.default)(["Store:Contact init from cache"]);return y=function(){return e},e}class S extends o.default{constructor(){super(),this._contactHashes=new g.default,this.checksum=void 0,this._frequentContacts={},this._sort=(0,s.default)((()=>super.sort()),1e3),this._silentSort=(0,s.default)((()=>super.sort({silent:!0})),1e3),this.listenTo(m.default,"locale_change",this.sort),this.listenTo(this,"change:name",this.sort),this.listenTo(E.default,"change:stream",(()=>{E.default.stream===E.STREAM.RESUMING&&this.forEach((e=>{e.unset("verificationString"),e.unset("verificationBinary")}))})),this.listenTo(this,"add",this.contactAdded),this.listenTo(this,"remove",this.contactRemoved)}sort(e){return e&&e.silent?this._silentSort():this._sort()}ensureSorted(){this._sort.flush()}initializeFromCache(e){e&&(__LOG__(2)(y()),this.add(e,{silent:!0,merge:!0}))}contactAdded(e){this._contactHashes.put(e)}contactRemoved(e){this._contactHashes.remove(e)}contactHashLength(){return this._contactHashes.length}delete(){super.delete(),this.setChecksum(),delete this.checksum,this._frequentContacts={},(0,h.setFrequent)({}).catch((()=>{})),this._contactHashes.clear()}isFilteredContact(e){return!!e.name&&!e.isMe&&!e.isPSA&&e.isWAContact}getFilteredContacts(){return this.filter((function(e){return e.name&&!e.isMe&&!e.isPSA&&e.isWAContact}))}_find(e){var t=this.get(e);return t?Promise.resolve(t):Promise.resolve({id:e})}_findQuery(e){return(0,p.contactFindQuery)(e)}sync(){return this.findQuery({}).catchType(f.WebdDrop,(()=>{})),(0,v.default)(this,l.default.COLLECTION_HAS_SYNCED)}updateFrequentContacts(e){this._frequentContacts=e}frequentContacts(e,t){var r=e&&this._frequentContacts[e];if(r||(r=this._frequentContacts.message),!r)return[];var a=t&&t.id;return r.map((e=>this.get(e))).filter((e=>!!e&&!e.id.equals(a)))}getUserCount(){return this.map((e=>e.isUser?1:0)).reduce(((e,t)=>e+t),0)}setChecksum(e){this.checksum=e,(0,_.setContactChecksum)(this.checksum),(0,u.setChecksum)(e).catch((()=>{}))}resolveWidsFromHash(e){return this._contactHashes.get(e)}}t.ContactCollection=S,S.model=d.default,S.comparator=c.default,S.cachePolicy={id:"contact",policy:o.CACHE_POLICY.IMMEDIATE,trigger:"add\n        sort\n        remove\n        reset\n        change:id\n        change:name\n        change:shortName\n        change:pushname\n        change:type\n        change:verifiedName\n        change:isBusiness\n        change:isEnterprise\n        change:verifiedLevel\n        change:statusMute\n        change:sectionHeader\n        change:isContactBlocked\n        change:labels"};var T=new S;t.default=T},74460:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.getCollator=function(){return n},t.default=void 0;var n,i=a(r(79711)),s=a(r(50935)),o=r(95595);u(),i.default.on("set_locale",u);function u(e=s.default.L10N.DEFAULT){if(self.Intl&&self.Intl.Collator){var t=self.Intl.Collator([e],{sensitivity:"base"});n={compare(e,r){try{return t.compare(e,r)}catch(e){return 0}}}}else n={compare:(e,t)=>e.localeCompare(t)}}var l=(e,t)=>{var r=e.id.toString(),a=t.id.toString(),i=(0,o.getMaybeMeUser)(),s=i&&i.toString();if(r===s)return 1;if(a===s)return-1;var u=e.name,l=t.name;if(!u&&l)return 1;if(u&&!l)return-1;if(u&&l&&e.header&&t.header){var d=n.compare(e.header,t.header);return 0===d?n.compare(u,l):d}return r&&a?r.localeCompare(a):-1};t.default=l},74125:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(19976)),i=a(r(64116)),s=a(r(61941)),o=a(r(68384));function u(){var e=(0,n.default)(["Store:Contact can't call slice on contact.userhash"]);return u=function(){return e},e}class l{constructor(){this._map={},this.length=0}static getSidelistHash(e){return e.isUser?"string"==typeof e.userhash&&e.userhash.slice?e.userhash.slice(0,4):(__LOG__(3)(u()),null):null}put(e){var t=l.getSidelistHash(e);if(t&&!this._map[t]){if(this._map[t]){var r=this._map[t];r instanceof o.default?this._map[t]=[r,e.id]:r instanceof Array&&r.push(e.id)}else this._map[t]=e.id;this.length++}}remove(e){var t=l.getSidelistHash(e);if(t&&this._map[t]){var r=(0,s.default)(this._map[t],"this._map[hash]");r instanceof o.default?delete this._map[t]:r instanceof Array&&(0,i.default)(r,(t=>t.equals(e.id))),this.length++}}get(e){var t=this._map[e];return t instanceof o.default?[t]:t}clear(){this._map={},this.length=0}}t.default=l},40827:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.ConversionTupleExpiry=t.default=void 0;var i=n(r(19976)),s=r(46378),o=n(r(25337)),u=a(r(61247)),l=n(r(19899)),d=n(r(68384));function c(){var e=(0,i.default)(["Invalid conversionTuple timer"]);return c=function(){return e},e}var f=604800;t.ConversionTupleExpiry=f;class p extends u.default{constructor(...e){super(...e),this.id=(0,u.prop)(),this.conversionData=(0,u.prop)(),this.conversionSource=(0,u.prop)(),this.timestamp=(0,u.prop)((()=>l.default.globalUnixTime())),this.alarmId=(0,u.session)()}initialize(){super.initialize(),this.listenTo(this,"change:timestamp",this._setExpiryTimer),this._setExpiryTimer()}_setExpiryTimer(){var e=this.timestamp+f;if(e<0)return __LOG__(3)(c()),void this.delete();this.alarmId=o.default.setLocalTimeout((()=>{this.delete()}),1e3*e,this.alarmId)}_clearAlarm(){this.alarmId&&(o.default.clearTimeout(this.alarmId),this.alarmId=void 0)}elapsedSeconds(){return l.default.globalUnixTime()-this.timestamp}formatTuple(){var e={conversionDelaySeconds:this.elapsedSeconds()};return this.conversionData&&(e.conversionData=this.conversionData),this.conversionSource&&(e.conversionSource=this.conversionSource),e}toJSON(){var e=this.serialize(),t=e.conversionData;if(t instanceof ArrayBuffer){var r=new s.Binary(t);e.conversionData=r.readString(t.byteLength)}return e}delete(){super.delete(),this.getCollection().remove(this.id),this._clearAlarm()}getCollection(){return r(19744).default}}p.Proxy="conversionTuple",p.idClass=d.default;var h=(0,u.defineModel)(p);t.default=h},19744:(e,t,r)=>{"use strict";var a=r(14859),n=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(r(54019)),s=a(r(19899)),o=n(r(40827)),u=r(27985);class l extends i.default{initializeFromCache(e){if(e){var t=s.default.globalUnixTime()-o.ConversionTupleExpiry,r=e.filter((e=>e.timestamp-t>0)).map((e=>{var t=(0,u.parseConversionData)(e.conversionData);return t?e.conversionData=t:delete e.conversionData,e}));this.add(r),this.saveToCache()}}}l.model=o.default,l.cachePolicy={id:"conversion_tuple",policy:i.CACHE_POLICY.LOAD,delay:1e3};var d=new l;t.default=d},23203:(e,t,r)=>{"use strict";var a=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(61247));class i extends n.default{constructor(...e){super(...e),this.id=(0,n.prop)(),this.weight=(0,n.prop)()}}i.Proxy="recentEmoji";var s=(0,n.defineModel)(i);t.default=s},67110:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.RecentEmojiCollection=void 0;var i=n(r(19976)),s=n(r(12436)),o=n(r(54073)),u=a(r(54019)),l=n(r(12396)),d=r(19741),c=n(r(18120)),f=n(r(23203)),p=r(11419),h=n(r(76022));function _(){var e=(0,i.default)(["models:RecentEmoji:throttledSync dirty: ",""]);return _=function(){return e},e}function m(){var e=(0,i.default)(["models:recentEmoji:findQuery error"]);return m=function(){return e},e}class g extends u.default{constructor(){super(),this.dirty=!1,this._throttledSync=(0,s.default)((function(e){e.sync()}),36,{leading:!1}),this.listenTo(this,"change:weight change:length",(0,o.default)(this._sortTrimScale,100))}_sortTrimScale(){var e=this.length;e&&(this.sort(),e>36&&this.remove(this.models.slice(36)))}delete(){super.delete(),this.dirty=!1,this._throttledSync.cancel()}sync(){return this.findQuery({},{set:!0}).finally((()=>{this.dirty=!1})).catchType(d.WebdDrop,(()=>{})).catchConditional(p.isString,(()=>{}))}_findQuery(){return c.default.supportsFeature(c.default.F.RECENT_EMOJI_SYNC)&&!c.default.supportsFeature(c.default.F.MD_BACKEND)?h.default.recentEmojiQuery(this.dirty?this.toArray():void 0).then((function(e){return Array.isArray(e)?(e.forEach((function(e){e.id=l.default.normalizeAllEmojis(e.id)})),Promise.resolve(e)):(__LOG__(3)(m()),Promise.reject("recent emoji fetch error"))})):Promise.reject("gk recent emoji sync unsupported")}throttledSync(){c.default.supportsFeature(c.default.F.RECENT_EMOJI_SYNC)&&(__LOG__(2)(_(),String(this.dirty)),this._throttledSync(this))}increment(e){var t=l.default.getSkinToneBase(e)||e;this.get(t)||this.add({id:t,weight:0}),this.forEach((e=>{e.id===t?e.weight+=1:e.weight*=.9})),this.dirty=!0,this.throttledSync()}}t.RecentEmojiCollection=g,g.cachePolicy={id:"recent_emoji_collection",policy:u.CACHE_POLICY.LOAD,delay:2e3},g.comparator=(e,t)=>e.weight>t.weight?-1:1,g.model=f.default;var v=new g;t.default=v},30440:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(r(19976)),s=a(r(61247)),o=n(r(50935)),u=n(r(7470)),l=r(19741),d=r(95595),c=n(r(18120)),f=n(r(30788)),p=n(r(9094)),h=n(r(76022)),_=n(r(68384));function m(){var e=(0,i.default)(["models:groupMetadata:participantCollection:revokeGroupV4AddInvite failed"]);return m=function(){return e},e}class g extends s.default{constructor(...e){super(...e),this.participants=(0,s.collection)(f.default),this.pendingParticipants=(0,s.collection)(p.default),this.id=(0,s.prop)(),this.creation=(0,s.prop)(),this.owner=(0,s.prop)(),this.desc=(0,s.prop)(),this.descId=(0,s.prop)(),this.descTime=(0,s.prop)(),this.descOwner=(0,s.prop)(),this.restrict=(0,s.prop)(),this.announce=(0,s.prop)(),this.noFrequentlyForwarded=(0,s.prop)(),this.ephemeralDuration=(0,s.prop)(),this.size=(0,s.prop)(),this.support=(0,s.prop)(),this.stale=(0,s.session)(!0),this.trusted=(0,s.session)(!0),this.inviteCode=(0,s.session)(),this.groupInviteCodePromise=(0,s.session)(),this.revokeGroupInvitePromise=(0,s.session)(),this.revokeGroupV4AddInvitePromise=(0,s.session)(),this.groupInviteLink=(0,s.derived)(this._groupInviteLink,["inviteCode"])}_groupInviteLink(){return this.inviteCode?"".concat(o.default.GROUP_INVITE_LINK_URL).concat(this.inviteCode):null}delete(){super.delete(),this.getCollection().remove(this.id),this.participants.delete()}canSetSubject(){return!!this.participants.iAmMember()&&((this.participants.iAmAdmin()||!c.default.supportsFeature(c.default.F.GROUPS_V_3)||!0!==this.restrict)&&!this.support)}canSetDescription(){return!!c.default.supportsFeature(c.default.F.GROUPS_V_3)&&(!(!this.participants.iAmMember()||!this.participants.iAmAdmin()&&this.restrict)&&!this.support)}canSetGroupProperty(){return!!c.default.supportsFeature(c.default.F.GROUPS_V_3)&&(!!this.participants.iAmAdmin()&&!this.support)}canSetEphemeralSetting(){return c.default.isEphemeralAllowGroupMembersEnabled()?!(!this.participants.iAmMember()||!this.participants.iAmAdmin()&&this.restrict)&&!this.support:this.participants.iAmAdmin()&&!this.support}initialize(){s.default.prototype.initialize.call(this),this.listenTo(this.participants,"change:isAdmin change:isSuperAdmin change:contact.isMyContact sort remove reset",this.isTrusted),this.listenTo(this.participants,"add remove reset",this.triggerParticipantsChange),this.listenTo(this,"change:owner",this.isTrusted),this.isTrusted()}triggerParticipantsChange(){this.trigger("change:participants")}isTrusted(){if(this.stale)return this.trusted;if(!this.owner)return this.trusted=!1;if(this.support)return this.trusted=!0;var e=(0,d.getMaybeMeUser)();if(_.default.equals(this.owner,e))return this.trusted=!0;if(this.owner){var t=u.default.get(this.owner);if(t&&t.isMyContact)return this.trusted=!0}return this.trusted=!1}revokeGroupV4AddInvite(e){if(this.revokeGroupV4AddInvitePromise)return this.revokeGroupV4AddInvitePromise;var t=this.id.toString(),r=(0,d.getMaybeMeUser)().toString(),{pendingParticipants:a}=this;return this.revokeGroupV4AddInvitePromise=h.default.revokeGroupV4Invite(e,t,r).then((t=>(t.status>=200&&t.status<300&&a.remove(e),t.status))).catch((()=>{__LOG__(3)(m())})).finally((()=>{this.revokeGroupV4AddInvitePromise=null}))}queryGroupV4PendingInvite(){if(c.default.supportsFeature(c.default.F.MD_BACKEND))return Promise.resolve();var e=(0,d.getMaybeMeUser)().toString(),t=this.id.toString();return h.default.findGroupPendingInvitesFromPhone(e,t).then((e=>{this.collection&&this.collection.add({id:this.id,pendingParticipants:e.participants},{merge:!0})})).catchType(l.WebdDrop,(()=>{}))}getCollection(){return r(99922).default}}g.Proxy="groupMetadata",g.idClass=_.default;var v=(0,s.defineModel)(g);t.default=v},99922:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(r(19976)),s=n(r(26139)),o=n(r(54019)),u=n(r(43334)),l=r(19741),d=a(r(96452)),c=n(r(18120)),f=r(60156),p=n(r(30440)),h=r(70574),_=r(90401),m=n(r(76022)),g=n(r(68384)),v=r(75637);function E(){var e=(0,i.default)(["groupMetadata:find trying to fetch non-group/bclist wid ",""]);return E=function(){return e},e}function y(){var e=(0,i.default)(["models:GroupMetadataCollection:_find:bclist error: ",""]);return y=function(){return e},e}function S(){var e=(0,i.default)(["models:GroupMetadataCollection:_find:False broadcast list query"]);return S=function(){return e},e}function T(){var e=(0,i.default)(["contactFindBroadcast: not implemented for MD"]);return T=function(){return e},e}function b(){var e=(0,i.default)(["queryGroupFromPhone: not implemented for MD"]);return b=function(){return e},e}class A extends o.default{onResume(){(0,s.default)(u.default.where({active:!0}).filter((e=>e.isGroup||e.isBroadcast)),u.default.where({isBroadcast:!0})).forEach((e=>{this.find(e.id).catchTypes(l.WebdDrop,d.ProtoVersionUndefined,(()=>{}))}))}_find(e){if(g.default.isGroup(e)){var t=r(43334).default.get(e);return t&&t.isReadOnly?c.default.supportsFeature(c.default.F.MD_BACKEND)?(__LOG__(3)(b()),Promise.resolve({id:e})):(0,h.queryGroupFromPhone)(e):(0,f.getGroupMetadataFromStorage)(e).then((t=>t?Promise.resolve(t):(0,_.sendQueryGroup)(e)))}return g.default.isBroadcast(e)?c.default.supportsFeature(c.default.F.MD_BACKEND)?(__LOG__(3)(T()),Promise.resolve({id:e})):m.default.contactFindBroadcast(e).then((t=>{if(200===t.status){var r=this.get(e);return r&&!r.stale?Promise.resolve(r):{id:e,participants:t.recipients}}return 404===t.status?(__LOG__(3)(S()),{id:e}):(__LOG__(3)(y(),t.status),Promise.reject(new Error("models:GroupMetadataCollection:_find:bclist error: "+t.status)))})):(__LOG__(2)(E(),e.toString()),Promise.reject(new Error("groupMetadata:find trying to fetch non-group/bclist wid ".concat(e.toString()))))}_handle(e){return e}handlePendingInvite(e){var{gid:t,participants:r}=e;this.add({id:(0,v.createWid)(t),pendingParticipants:r},{merge:!0})}}A.model=p.default,A.staleCollection=!0;var C=new A;t.default=C},35954:(e,t,r)=>{"use strict";var a=r(14859),n=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(r(61247)),s=a(r(7470)),o=a(r(68384));class u extends i.default{constructor(...e){super(...e),this.id=(0,i.prop)(),this.isAdmin=(0,i.prop)(),this.isSuperAdmin=(0,i.prop)(),this.contact=(0,i.session)(),this.hasSenderKey=(0,i.session)(!1)}initialize(){super.initialize(),this.addChild("contact",s.default.gadd(this.id))}}u.Proxy="participant",u.idClass=o.default;var l=(0,i.defineModel)(u);t.default=l},30788:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(54073)),i=a(r(43334)),s=a(r(95847)),o=r(23751),u=r(95595),l=a(r(18120)),d=a(r(17957)),c=a(r(35954)),f=a(r(38738));class p extends s.default{constructor(e,t={}){super(e,t),this._debouncedSort=(0,n.default)((()=>this.sort()),1e3),this.sendForNeededAddRequest=e=>{var t=this.parent.id,r=i.default.assertGet(t),a=r.groupMetadata.desc;(0,o.sendForNeededAddRequest)(e,r.formattedTitle||r.name,a,this.parent.id)},this.listenTo(this,"change:contact.name",this._debouncedSort),this.listenTo(d.default,"locale_change",this._debouncedSort)}delete(){this.forEach((function(e){e.delete()})),this.stopListening(),this.reset()}ensureSorted(){this._debouncedSort.flush()}set(e,t){var r=t||{};return r.isParticipantCollectionAdd||(r.remove=!0),super.set(e,r)}add(e,t){var r=t||{};return r.isParticipantCollectionAdd=!0,super.add(e,r)}canAdd(){return!!this.iAmAdmin()}canPromote(e){return!!e&&(!(0,u.getMaybeMeUser)().equals(e.id)&&(!!this.iAmAdmin()&&!e.isAdmin))}canDemote(e){return!!e&&(!!this.iAmAdmin()&&(!(0,u.getMaybeMeUser)().equals(e.id)&&(!(l.default.supportsFeature(l.default.F.GROUPS_V_3)&&e.isSuperAdmin)&&!!e.isAdmin)))}canRemove(e){return!!e&&(!(0,u.getMaybeMeUser)().equals(e.id)&&!!this.iAmAdmin())}canVerifyIdentity(e){return!!l.default.supportsFeature(l.default.F.QUERY_IDENTITY)&&(!!e&&!(0,u.getMaybeMeUser)().equals(e.id))}iAmMember(){return 1===this.filter((e=>e.id.equals((0,u.getMaybeMeUser)()))).length}iAmRestrictedMember(){var e=this.parent.id;return i.default.assertGet(e).groupMetadata.restrict&&!this.iAmAdmin()}iAmAdmin(){return 1===this.filter((e=>e.id.equals((0,u.getMaybeMeUser)())&&e.isAdmin)).length}iAmSuperAdmin(){return 1===this.filter((e=>e.id.equals((0,u.getMaybeMeUser)())&&e.isSuperAdmin)).length}getAdmins(){return this.where({isAdmin:!0})}getSuperAdmin(){return this.findFirst((e=>e.isSuperAdmin))}}t.default=p,p.model=c.default,p.comparator=f.default},38738:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(74460)),i=(e,t)=>(0,n.default)(e.contact,t.contact);t.default=i},9094:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(54073)),i=a(r(95847)),s=a(r(17957)),o=a(r(35954)),u=a(r(38738));class l extends i.default{constructor(e,t={}){super(e,t),this._debouncedSort=(0,n.default)((()=>this.sort()),1e3),this.listenTo(this,"change:contact.name",this._debouncedSort),this.listenTo(s.default,"locale_change",this._debouncedSort)}delete(){this.forEach((function(e){e.delete()})),this.stopListening(),this.reset()}ensureSorted(){this._debouncedSort.flush()}set(e,t={}){return t.isParticipantCollectionAdd||(t.remove=!0),super.set(e,t)}add(e,t={}){return t.isParticipantCollectionAdd=!0,super.add(e,t)}}t.default=l,l.model=o.default,l.comparator=u.default},51905:(e,t,r)=>{"use strict";var a=r(14859),n=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.intColorToHex=f,t.default=void 0;var i=n(r(61247)),s=n(r(52737)),o=a(r(50935)),u=a(r(18120)),l=a(r(8286)),d=r(12824);class c extends i.default{constructor(...e){super(...e),this.id=(0,i.prop)(),this.name=(0,i.prop)(),this.colorIndex=(0,i.prop)(),this.color=(0,i.prop)(),this.count=(0,i.prop)(),this.stale=(0,i.session)(!0),this.hexColor=(0,i.derived)(this._hexColor,["color","colorIndex"])}initialize(){super.initialize(),this.labelItemCollection=new l.default,this._triggerLabelUpdate(),this.listenTo(this,"change:name",this._triggerLabelUpdate),this.listenTo(this,"change:color",this._triggerLabelUpdate),this.listenTo(this,"change:colorIndex",this._triggerLabelUpdate),this.listenTo(this,"change:count",this._triggerLabelUpdate),u.default.supportsFeature(u.default.F.MD_BACKEND)&&(this.listenTo(this.labelItemCollection,"add",this._handleLabelItemCollectionUpdate),this.listenTo(this.labelItemCollection,"remove",this._handleLabelItemCollectionUpdate))}_hexColor(){if(u.default.supportsFeature(u.default.F.MD_BACKEND)){var e=this.colorIndex;if(null==e)return;return s.default.platform===s.PLATFORMS.SMBI?o.default.IPHONE_LABEL_COLOR_PALETTE[e]:o.default.ANDROID_LABEL_COLOR_PALETTE[e]}if(this.color)return f(this.color)}_find(e){return Promise.resolve({id:e})}_triggerLabelUpdate(){this.name&&r(23539).default.trigger("label_updated_".concat(this.id))}_handleLabelItemCollectionUpdate(){var e=this.labelItemCollection.filter((e=>e.parentType!==d.LabelItemParentType.Contact)).length;this.count=String(e)}}function f(e){var t=parseInt(e,10);return"#".concat((t>>>0).toString(16).slice(-6))}c.Proxy="label";var p=(0,i.defineModel)(c);t.default=p},23539:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.LabelCollection=t.LABEL_PROPERTIES=void 0;var i=n(r(19976)),s=n(r(64116)),o=r(91460),u=a(r(2784)),l=r(12073),d=n(r(54019)),c=n(r(79711)),f=n(r(52737)),p=n(r(63504)),h=r(19741),_=a(r(96452)),m=r(95595),g=n(r(17957)),v=n(r(51905)),E=r(74282),y=r(12824),S=r(28352),T=n(r(40210)),b=n(r(17744)),A=a(r(82885)),C=n(r(76022)),P=n(r(12767)),O=r(98538),w=n(r(18120));function M(){var e=(0,i.default)(["labels:loadLabelPalette:error ",""]);return M=function(){return e},e}function I(){var e=(0,i.default)(["updatingLabel dropped"]);return I=function(){return e},e}function R(){var e=(0,i.default)(["addingNewLabel dropped"]);return R=function(){return e},e}function D(){var e=(0,i.default)(["deleteLabel - label does not exist"]);return D=function(){return e},e}function N(){var e=(0,i.default)(["addingNewLabel dropped"]);return N=function(){return e},e}function L(){var e=(0,i.default)(["addingNewLabel dropped"]);return L=function(){return e},e}var k=Object.freeze({NAME:"name",COLOR:"color"});t.LABEL_PROPERTIES=k;var U=Object.freeze({UPDATING:"updating",SUCCEEDED:"succeeded",FAILED:"failed"});class F extends d.default{constructor(){super(),this.checksum=void 0,this.listenTo(this,"remove",this.handleRemove)}initializeAssociationsFromCache(e){e.forEach((({labelId:e,associationId:t,type:r})=>{(0,S.addToLabelCollection)(t,[e],r===O.LabelAssociationType.Jid?y.LabelItemParentType.Chat:y.LabelItemParentType.Msg)}))}addNewLabel(e,t){(0,E.logLabelOperationEvent)(T.default.LABEL_OPERATIONS.ADD,1,T.default.LABEL_TARGETS.LABEL);var r=C.default.createLabel(e,t),a=new l.ActionType(g.default.t(40,{labelName:e})),n=(0,l.genId)(),i=r.then((({status:t})=>200===t?new l.ActionType(g.default.t(158,{labelName:e})):new l.ActionType(g.default.t(157,{labelName:e})))).catch((()=>(__LOG__(3)(L()),new l.ActionType(g.default.t(157,{labelName:e})))));return c.default.openToast(u.createElement(l.ActionToast,{id:n,initialAction:a,pendingAction:i})),r}removeAllLabelsMD(e){return this.addOrRemoveLabelsMD((e.labels||[]).map((e=>({type:"remove",id:e}))),[e])}addOrRemoveLabelsMD(e,t){w.default.supportsFeature(w.default.F.MD_BACKEND)&&e.forEach((({id:e,type:r})=>{t.forEach((t=>{var a=(0,S.getParentTypeFromModel)(t),n=t.id.toString();"add"===r?(0,S.addToLabelCollection)(n,[e],a):(0,S.removeLabelFromCollection)(n,e,a)}))}))}addOrRemoveLabels(e,t){var r=(0,l.genId)(),a=new l.ActionType(g.default.t(37,{count:e.length,_plural:e.length})),n=(0,p.default)(e,t).then((()=>{this.addOrRemoveLabelsMD(e,t)})).then((()=>new l.ActionType(g.default.t(39,{count:e.length,_plural:e.length})))).catch((()=>(__LOG__(3)(N()),new l.ActionType(g.default.t(38)))));c.default.openToast(u.createElement(l.ActionToast,{id:r,initialAction:a,pendingAction:n}))}deleteLabel(e){(0,E.logLabelOperationEvent)(T.default.LABEL_OPERATIONS.DELETE,1,T.default.LABEL_TARGETS.LABEL);var t=C.default.deleteLabel(e),r=this.get(e);if(r){var{name:a}=r,n=new l.ActionType(g.default.t(92,{labelName:a})),i=(0,l.genId)(),s=t.then((({status:e})=>200===e?new l.ActionType(g.default.t(91,{labelName:a})):new l.ActionType(g.default.t(90,{labelName:a})))).catch((()=>(__LOG__(3)(R()),new l.ActionType(g.default.t(90,{labelName:a})))));return c.default.openToast(u.createElement(l.ActionToast,{id:i,initialAction:n,pendingAction:s})),t}__LOG__(2)(D())}_getActionLabelUpdateString(e,t){switch(e){case k.NAME:return t===U.UPDATING?g.default.t(131):t===U.SUCCEEDED?g.default.t(133):g.default.t(132);case k.COLOR:return t===U.UPDATING?g.default.t(128):t===U.SUCCEEDED?g.default.t(130):g.default.t(129)}return""}updateLabel(e,t){(0,E.logLabelOperationEvent)(T.default.LABEL_OPERATIONS.EDIT,1,T.default.LABEL_TARGETS.LABEL);var r=C.default.editLabel(e.id,e.name,e.color),a=new l.ActionType(this._getActionLabelUpdateString(t,U.UPDATING)),n=(0,l.genId)(),i=r.then((({status:e})=>200===e?new l.ActionType(this._getActionLabelUpdateString(t,U.SUCCEEDED)):new l.ActionType(this._getActionLabelUpdateString(t,U.FAILED)))).catch((()=>(__LOG__(3)(I()),new l.ActionType(this._getActionLabelUpdateString(t,U.FAILED)))));return c.default.openToast(u.createElement(l.ActionToast,{id:n,initialAction:a,pendingAction:i})),r}getNewLabelColor(){return C.default.queryNextLabelColor().then((e=>e.labelColors[0].color)).catch((()=>{}))}getLabelColorPalette(){return this.labelColorPalette=this.labelColorPalette||(0,m.getSmbLabelPalette)(),this.labelColorPalette&&this.labelColorPalette.waVersion===f.default.phone.wa_version?Promise.resolve(this.labelColorPalette.colors):this._getColorPaletteLoop().then((e=>{var t=e.labelColors.map((({color:e})=>e));return(0,m.setSmbLabelPalette)({colors:t,waVersion:f.default.phone.wa_version}),t})).catch((()=>{}))}_getColorPaletteLoop(){return Promise.loop(((e,t,r)=>{var a=(0,o.delayMs)(A.expBackoff(r,12e4,1e3,.1));return("CONNECTED"===P.default.stream?Promise.resolve():(0,b.default)(P.default,"change:stream",(()=>"CONNECTED"===P.default.stream))).then((()=>C.default.queryLabelPalette().then((t=>{e(t)})))).catchConditional((e=>!(e instanceof Promise.CancellationError)),(e=>r>3||404===e?(__LOG__(3)(M(),String(e)),404===e?Promise.reject(new h.E404):Promise.reject(new _.GaveUpRetry("Gave up loading label palette ".concat(r," tries")))):a))}),0)}handleRemove(e){var{labelItemCollection:t}=e;t.toArray().forEach((e=>{var{parentId:t,parentType:r,labelId:a}=e,n=(0,S.getParentCollection)(r).get(t);n&&(n.labels=(0,s.default)(n.labels,(e=>e!==a)))}))}onResume(){this.filter((e=>e.hasObservers())).forEach((e=>{this.find(e.id).catchType(h.WebdDrop,(()=>{}))}))}delete(){super.delete(),delete this.checksum}sync(e){if(!e||this.checksum!==e)return this.findQuery({}).catchTypes(h.WebdDrop,_.ProtoVersionUndefined,(()=>{}))}handle(e){var t;if(e.checksum&&this.updateChecksum(e.checksum),e.labels&&e.labels[0]&&e.labels[0].labelUpdates)return e.labels[0].labelUpdates.forEach((e=>{e.collection.forEach((r=>{r!==y.LabelItemParentType.Msg&&r!==y.LabelItemParentType.Chat||(t=!0);var a=e.id,n=(0,S.getParentCollection)(r).get(e.id);n&&(n.labels&&n.labels.forEach((t=>{e.labels.includes(t)||(0,S.removeLabelFromCollection)(a,t,r)})),n.labels=e.labels)}))})),void(t&&this.trigger("bulk_msg_chat_label_change"));var r=[],a=[];e.labels.forEach((e=>{"delete"===e.type?r.push(e.label):a.push(e.label)})),this.remove(r.map((({id:e})=>e))),this.add(a,{merge:!0})}_findQuery(){return C.default.queryLabels().then((e=>(e.checksum&&this.updateChecksum(e.checksum),e.labels)))}_find(){return this._findQuery()}updateChecksum(e){this.checksum=e}getLabelsForModel(e,t){return this.filter((r=>r.labelItemCollection.get((0,S.createLabelItemId)(e,r.id,t)))).map((e=>e.id))}}t.LabelCollection=F,F.model=v.default,F.staleCollection=!0,F.resumeOnAvailable=!0;var G=new F;t.default=G},79516:(e,t,r)=>{"use strict";var a=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(61247));r(12824);class i extends n.default{constructor(...e){super(...e),this.id=(0,n.prop)(),this.parentType=(0,n.prop)(),this.parentId=(0,n.prop)(),this.labelId=(0,n.prop)()}}i.Proxy="labelItem";var s=(0,n.defineModel)(i);t.default=s},8286:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.LabelItemCollection=void 0;var n=a(r(67304)),i=a(r(54019)),s=a(r(18120)),o=a(r(79516)),u=r(28352);class l extends i.default{constructor(){super(),s.default.supportsFeature(s.default.F.MD_BACKEND)&&(this.listenTo(this,"add",this._handleAdd),this.listenTo(this,"remove",this._handleRemove))}_handleAdd(e){this._handleChange(e,!0)}_handleRemove(e){this._handleChange(e,!1)}_handleChange(e,t){var r=(0,u.getParentCollection)(e.parentType).get(e.parentId);if(r){var a=r.labels||[];t?a.includes(e.labelId)||(r.labels=[e.labelId].concat(a)):r.labels=(0,n.default)(a,e.labelId)}}}t.LabelItemCollection=l,l.model=o.default;var d=l;t.default=d},54019:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"CACHE_POLICY",{enumerable:!0,get:function(){return d.CACHE_POLICY_TYPE}}),t.default=void 0;var i=n(r(70417)),s=n(r(19976)),o=n(r(74930)),u=n(r(60417)),l=n(r(92070)),d=r(7805),c=n(r(95847)),f=n(r(52737)),p=r(19741),h=a(r(96452)),_=r(95595),m=n(r(17026)),g=r(11419),v=a(r(12767));function E(){var e=(0,s.default)(["baseCollection:initFromCache load: ",""]);return E=function(){return e},e}function y(){var e=(0,s.default)(["WebdDrop error: ",""]);return y=function(){return e},e}function S(){var e=(0,s.default)(["baseCollection:query query promise rejected: ",""]);return S=function(){return e},e}function T(){var e=(0,s.default)(["LogoutDrop error: ",""]);return T=function(){return e},e}function b(){var e=(0,s.default)(["Called update without an id"]);return b=function(){return e},e}function A(){var e=(0,s.default)(["Called find without an id"]);return A=function(){return e},e}function C(){var e=(0,s.default)(["baseCollection:saveToCache save: ",""]);return C=function(){return e},e}var P="QUERY",O="FIND",w="UPDATE",M=(new Object).toString(),I={id:"none",policy:d.CACHE_POLICY_TYPE.NONE};class R extends c.default{constructor(){super(),this._inflight={},this._cachePolicy=(0,d.createCachePolicy)(this,this.constructor.cachePolicy||I),this._staleCollection=this.constructor.staleCollection||!1,this._resumeOnAvailable=this.constructor.resumeOnAvailable||!1,(!0===this._staleCollection||(0,g.isFunction)(this.onResume))&&(this.listenTo(v.default,"change:stream",this._handleStreamChange),this.listenTo(v.default,"didResume",this._onResume),this._resumeOnAvailable&&this.listenTo(m.default,"change:available",(()=>{m.default.available&&this._needsUpdate&&this._onResume()}))),this._cachePolicy.enableCaching(),this._cachePolicy.constructor.policy===d.CACHE_POLICY_TYPE.LOAD&&this.listenTo(f.default,"me_ready",this._updateFromCache)}initializeFromCache(e){this.add(e)}saveToCache(){if(f.default.shouldSaveToCache()){var{id:e}=this._cachePolicy;__LOG__(2)(C(),String(e)),(0,_.setCollection)(e,this.toJSON(),this._cachePolicy.constructor.policy===d.CACHE_POLICY_TYPE.IMMEDIATE)}}add(e,t){if(e){if(f.default.blockStoreAdds)throw new p.LogoutDrop("adding to store when blocking store adds");var r=Array.isArray(e)?e:[e];if(r.every((e=>e&&e.isState))){var a=(0,l.default)(r,(e=>this.get(e.id)));return a.length&&super.add(a,t),r}}return super.add(e,t)}findQuery(e,t){return this._query(P,e,t)}find(e,t){return e?this._query(O,e,t):(__LOG__(4,void 0,new Error,!0)(A()),SEND_LOGS("find-without-id"),Promise.reject("called find without an id"))}update(e,t){return e?this._query(w,e,t):(__LOG__(4,void 0,new Error,!0)(b()),SEND_LOGS("update-without-id"),Promise.reject("called update without an id"))}handle(e){var t=this._handle(e.shift());if(this._staleCollection){var r=Array.isArray(t)?t:[t];(0,u.default)(r).forEach((e=>{e.stale=!1}))}this.add(t,{merge:!0})}gadd(e,t){if(this.modelClass.prototype.isIdType(e)){var r=this.get(e);return r||this.add({id:e},t)[0]}if(e&&e.id){var a=t||{};return a.merge=!0,this.add(e,a)[0]}throw new Error("gadd called without an id attr (id)")}gaddUp(e){var t,r=this._staleCollection;if(this.modelClass.prototype.isIdType(e)){var a={stale:r,id:e};t=this.get(e)||this.add(a,{merge:!0})[0]}else e&&e.id&&(this.get(e.id)&&(r=!1),e=(0,i.default)({stale:r},e),t=this.add(e,{merge:!0})[0]);if(t){var n=t;return t.stale&&this.find(t.id).catchType(p.WebdDrop,(()=>{})),n}throw new Error(".gaddUp called without an id attr (id)")}delete(){this._inflight={},this.reset()}isStateStale(e){var t=this.get(e);return!!t&&t.stale}_handleResume(){switch(v.default.stream){case v.STREAM.DISCONNECTED:if(!this._staleCollection)return;this.forEach((e=>{e&&(e.stale=!0)}));break;case v.STREAM.RESUMING:case v.STREAM.SYNCING:case v.STREAM.CONNECTED:}}_onResume(){(0,g.isFunction)(this.onResume)&&(this._resumeOnAvailable&&!m.default.available?this._needsUpdate=!0:(this.onResume(),this._needsUpdate=!1))}_query(e,t,r){var a=(0,g.isString)(t)?t:t.toString();a===M&&(a=(0,o.default)("collection_query_"));var n=e===P?void 0:this.get(t),i="force-"+a;return(this._inflight[i]&&e===O||e===w)&&(a=i),this._inflight[a]?e===O&&n&&!n.stale?Promise.resolve(n):this._inflight[a]:!n||n&&n.stale||e===w?this._inflight[a]=this._serverQuery(e,t,r).finally((()=>{delete this._inflight[a]})).catchType(p.LogoutDrop,(e=>{__LOG__(3)(T(),e.toString())})).catchConditional(g.isString,(function(e){__LOG__(2)(S(),String(e))})).catchType(p.WebdDrop,(function(e){throw __LOG__(3)(y(),e.toString()),e})):Promise.resolve(n)}_serverQuery(e,t,r){var a;if(e===w)a=this._update(t);else if(e===O)a=this._find(t);else{var n=r&&r.logOnSend;a=this._findQuery(t,n)}return a.then((e=>{if(this._staleCollection){var t=Array.isArray(e)?e:[e];(0,u.default)(t).forEach((function(e){void 0===e.stale&&(e.stale=!1)}))}var a;if(a=r&&r.set?this.set(e):this.add(e,{merge:!0}),Array.isArray(e))return a;if(a[0])return a[0];throw new h.ModelCreateError("Unknown",e)}))}_update(e){return this._find(e)}_handleStreamChange(){this._handleResume(),this._cachePolicy.constructor.policy===d.CACHE_POLICY_TYPE.LOAD&&this._updateFromCache()}_updateFromCache(){var{id:e}=this._cachePolicy;this._cachePolicy.disableCaching(),f.default.shouldSaveToCache()&&(__LOG__(2)(E(),String(e)),this.initializeFromCache((0,_.getCollection)(e)),this._cachePolicy.enableCaching())}}t.default=R},79909:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.genMirrorMask=function(e){var t={},r=0,a=e=>{t["change:".concat(e)]=r++};e.props&&Object.keys(e.props).forEach(a);e.session&&Object.keys(e.session).forEach(a);e.derived&&Object.keys(e.derived).forEach(a);return t},t.genBitMask=function(e,t){for(var r=[],a=0;a<t.length;a++){var n=e["change:".concat(t[a])],i=Math.floor(n/32);s(r,i+1),r[i]|=1<<n%32}return r},t.default=void 0;var n=a(r(8555));function i(e,t){e[t]=e[e.length-1],e.pop()}function s(e,t){if(!(t<=e.length))for(var r=t-e.length,a=0;a<r;a++)e.push(0)}t.default=class{constructor(e){this.state=e}destructor(){this.state.off("all",this.onGatherEvent,this)}initListener(){this.state.on("all",this.onGatherEvent,this),this.masks=[],this.listeners=[],this.changeEvents=[]}onGatherEvent(e){if("change"===e){if(!this.changeEvents.filter(Boolean).length)return;this.onChange(),this.changeEvents=[]}else{var t=this.state.mirrorMask[e];if(void 0===t)return;var r=t/32|0;s(this.changeEvents,r+1),this.changeEvents[r]|=1<<(t%32|0)}}onChange(){var e=this.state,t=this.changeEvents;(0,n.default)(this.masks,this.listeners).forEach((([r,a])=>{for(var n=Math.min(t.length,r.length),i=0;i<n;i++)if(t[i]&r[i]){var[s,o]=a;null!=s&&null!=o&&s(o,e);break}}))}addListener(e,t,r){this.listeners||this.initListener(),this.masks.push(t),this.listeners.push([e,r])}removeListener(e){for(var t=this.listeners,r=0;r<t.length;r++)t[r][0]===e&&(t[r][0]=null,t[r][1]=null,i(this.masks,r),i(t,r))}}},61247:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.defineModel=function(e){var t=(0,h.convert)(e),r=(0,h.stateExtend)(v,t);if(e.Proxy){var a=(0,d.genMirrorMask)(t);r.prototype.mirrorMask=a,r.prototype.proxyName=e.Proxy,(0,_.default)(e.Proxy,t,a)}return r},Object.defineProperty(t,"prop",{enumerable:!0,get:function(){return h.prop}}),Object.defineProperty(t,"session",{enumerable:!0,get:function(){return h.session}}),Object.defineProperty(t,"derived",{enumerable:!0,get:function(){return h.derived}}),Object.defineProperty(t,"collection",{enumerable:!0,get:function(){return h.collection}}),t.default=void 0;var i=n(r(70417)),s=n(r(46150)),o=n(r(15253)),u=n(r(84336)),l=n(r(99686)),d=a(r(79909)),c=n(r(79711)),f=r(19741),p=n(r(28267)),h=r(98486),_=n(r(76128)),m=r(11419),g=/^change:/;class v extends p.default{constructor(e,t={}){if(super(),this.stale=(0,h.session)(!1),this.__fired=null,this.__changes=null,this.__initialized=!1,!t._internalInitializationDoNotUse){this.stale=e&&e.stale||this.getDefault("stale"),this.parent=t.parent,this.collection=t.collection,this._initDeriveds(),this._initCollections();var r=this.__defaults,a=r?(0,i.default)((0,i.default)({},r),e):e;a&&!function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}(a)&&this.set(a,(0,i.default)({silent:!0},t)),this.initialize(),this.__initialized=!0}}initialize(){if(this.collection&&this.id&&!this.collection.modelClass.prototype.isIdType(this.id))throw new Error("Model id:".concat(String(this.id)," is wrong type"));this._uiObservers=0,this.mirrorMask&&(this.mirror=new d.default(this))}_refreshStaleModel(){if(this._uiObservers||!this.stale){if(!this.getCollection)throw new Error("base_model:_refreshStaleModel getCollection does not exist");this.getCollection().find(this.id).catch(f.WebdDrop,(()=>{}))}}incObservers(e){(this._uiObservers++,e)||r(99911).default.online&&this.stale&&(c.default.uiBusy?this.listenToOnce(c.default,"ui_idle",this._refreshStaleModel):this._refreshStaleModel())}decObservers(){this._uiObservers>0&&this._uiObservers--,0===this._uiObservers&&this.stopListening(c.default,"ui_idle",this._refreshStaleModel)}hasObservers(){return this._uiObservers>0}addChild(e,t){var r={};r[e]=t,this.set(r,{silent:!0}),this.listenTo(t,"all",this._getCachedEventBubblingHandler(e))}get(e){return this[e]}set(e,t,r){var a=r;return"string"==typeof e?this._set(e,t,a):(a=t)&&a.merge?this._set((0,l.default)(e,u.default),a):this._set(e,a)}_markChange(e){this.__initialized&&(this._getChanges().push(e),this.__fired&&(this.__fired[e]=!1))}_set(e,t,r){for(var a=this,n=!!this.__changes,[i,s]=(0,m.isString)(e)?[{[e]:t},r]:[e,t],o=Object.keys(i).reduce(((e,t)=>{var r=this._setKV(t,i[t],s);return r&&e.push(...r),e}),[]),u=0,l=function(){if(u++>5)throw new Error("Circular derived properties / event listeners");var e=a._topo;if(!e)throw new Error("_topo unexpectedly undefined");var t,r,n=(t=e,r=new Set(o),t.filter((e=>r.has(e))));o=n.reduce(((e,t,r)=>{var i=a._setD(t,n.slice(r+1));return i&&e.push(...i),e}),[])};o&&o.length>0;)l();if(!(s&&s.silent)&&this.hasUnfiredChanges()){for(var d=this.__fired={},c=this._getChanges(),f=c.length;c.length;){var p=c.shift();if(!d[p]){d[p]=!0;var h=this._definition[p].evt;(this.isListening(h)||this.isListening("all"))&&this.trigger(h,this,this[p])}}(f&&this.isListening("change")||this.isListening("all"))&&this.trigger("change",this)}return n||(this.__changes&&(this.__changes=null),this.__fired&&(this.__fired=null)),this}_setKV(e,t,r){if(this._collections[e])this[e].set(t,r);else{var a=this._definition[e];if(a){if(a.attr===h.Attr.DERIVED)throw new Error("Attempting to directly set derived property: ".concat(e));var n=a.sk;if(t!==this[e]){this[n]=t,this._markChange(e);var i=this._deps;return i&&i[e]?i[e]:void 0}}else this[e]=t}}_setD(e,t){var r,a,n=this._definition[e],i=n.sk,s=n.fn.call(this);if(this[i]!==s&&(this[i]=s,this._markChange(e),this._deps&&this._deps[e])){var o=(r=this._deps[e],a=new Set(t),r.filter((e=>!a.has(e))));if(o.length)return o}}hasUnfiredChanges(){var e=this.__fired,t=this.__changes;if(!t)return!1;if(!e)return!0;for(var r=0;r<t.length;r++)if(!e[t[r]])return!0;return!1}_getChanges(){return this.__changes||(this.__changes=[])}_initDeriveds(){this.__derived.forEach((e=>{this[this._definition[e].sk]=h.INIT}))}_initCollections(){(0,o.default)(this._collections,((e,t)=>{this[t]=new e(null,{parent:this})}))}unset(e,t){var r=Array.isArray(e)?e:[e];this.set((0,s.default)(r),t)}clear(){this.unset([...this.__props,...this.__session])}delete(){this.stopListening()}reset(){this.set(this.__defaults)}toJSON(){return this.serialize()}serialize(){for(var e={},t=0;t<this.__props.length;t++)e[this.__props[t]]=this[this.__props[t]];return(0,o.default)(this._collections,((t,r)=>{e[r]=this[r].serialize()})),e}getDefault(e){var t=this._definition[e];if(t){var r=t.default;return(0,m.isFunction)(r)?r():r}}_getCachedEventBubblingHandler(e){return function(t,r,a){g.test(t)?this.trigger("change:"+e+"."+t.split(":")[1],r,a):"change"===t&&this.trigger("change",this)}.bind(this)}static isIdType(e){return!(!this.allowedIds||!this.allowedIds.includes(e))||(this.idClass?e instanceof this.idClass:"string"==typeof e)}}t.default=v},87389:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.CACHE_POLICY_TYPE=void 0;var n=a(r(28267)),i={LOAD:"LOAD",IMMEDIATE:"IMMEDIATE",NONE:"NONE"};t.CACHE_POLICY_TYPE=i;class s extends n.default{constructor(e,t){super(),this._collection=e,this._id=t}enableCaching(){}disableCaching(){}get collection(){return this._collection}get id(){return this._id}}t.default=s,s.policy=i.NONE},98308:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(r(54073)),s=a(r(87389)),o=n(r(18120));class u extends s.default{constructor(e,t){super(e,t.id),this._trigger=t.trigger||"all",this._saveToCache=(0,i.default)(this.saveToCache,0)}saveToCache(){o.default.supportsFeature(o.default.F.MD_BACKEND)}enableCaching(){this.listenTo(this.collection,this._trigger,this._saveToCache)}disableCaching(){this.stopListening(this.collection,this._trigger,this._saveToCache)}}t.default=u,u.policy=s.CACHE_POLICY_TYPE.IMMEDIATE},7805:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.createCachePolicy=function(e,t){switch(t.policy){case"LOAD":return new s.default(e,t);case"IMMEDIATE":return new i.default(e,t);case"NONE":return new o.default(e,t)}return new o.default(e,{id:"none",policy:"NONE"})},Object.defineProperty(t,"CACHE_POLICY_TYPE",{enumerable:!0,get:function(){return n.CACHE_POLICY_TYPE}});var n=r(87389),i=a(r(98308)),s=a(r(92553)),o=a(r(66369))},92553:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(r(54073)),s=a(r(87389));class o extends s.default{constructor(e,t){super(e,t.id),this._trigger=t.trigger||"all",this._delay=t.delay,this._saveToCache=(0,i.default)(this.saveToCache,this._delay)}saveToCache(){this.collection.saveToCache()}enableCaching(){this.listenTo(this.collection,this._trigger,this._saveToCache)}disableCaching(){this.stopListening(this.collection,this._trigger,this._saveToCache)}}t.default=o,o.policy=s.CACHE_POLICY_TYPE.LOAD},66369:(e,t,r)=>{"use strict";var a=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(87389));class i extends n.default{constructor(e,t){super(e,t.id)}}t.default=i,i.policy=n.CACHE_POLICY_TYPE.NONE},95847:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(19976)),i=a(r(70417)),s=r(60248),o=a(r(28267));function u(){var e=(0,n.default)(["collection:_prepareModel exception: ",""]);return u=function(){return e},e}function l(){var e=(0,n.default)(["Assertion failed!"]);return l=function(){return e},e}function d(){var e=(0,n.default)(["collection:set model has no id"]);return d=function(){return e},e}function c(){var e=(0,n.default)(["collection:set called with no models"]);return c=function(){return e},e}class f extends o.default{constructor(e,t={}){super(),t.parent&&(this.parent=t.parent);var{model:r,comparator:a}=this.constructor;if(!r)throw new Error("Collection initialized without model!");this.modelClass=r,a&&(this._comparator=a),this._reset()}add(e,t){var r;return r=Array.isArray(e)?e.slice():e?[e]:[],this.set(r,(0,i.default)({merge:!1,add:!0,remove:!1},t))}set(e,t){if(!e)return __LOG__(3)(c()),[];for(var r,a,n,s,o,u=(0,i.default)({add:!0,remove:!0,merge:!0},t),l=this._comparator&&!1!==u.sort,f=[],p=[],h={},{add:_,merge:m,remove:g}=u,v=null!=u.at?u.at:void 0,E=!(l||!_||!g)&&[],y=0,S=e.length;y<S;y++)if(s=e[y],this.isModel(s)&&(a=s),r=s.id){if(n=this.get(r)){var T=n;g&&(h[n.id.toString()]=!0),m&&(s=a&&s===a?a.attributes:s,T.set(s,u)),e[y]=T}else if(_){if(!(a=e[y]=this._prepareModel(s,u)))continue;var b=a;f.push(b),this._addReference(b)}if(a=n||a){var A=a;!E||a.id&&h[a.id.toString()]||E.push(A),h[A.id.toString()]=!0}}else __LOG__(3)(d());if(g){for(var C=0,P=this.length;C<P;C++){var O=a=this._models[C];h[a.id.toString()]||p.push(O)}p.length&&this.remove(p,(0,i.default)({},u))}if(f.length||E&&E.length)if(l&&(o=!0),"number"==typeof v)this._models.splice(v,0,...f);else for(var w=E||f,M=0,I=w.length;M<I;M++)this._models.push(w[M]);if(o&&this.sort({silent:!0}),!u.silent){for(var R=0,D=f.length;R<D;R++)(a=f[R]).trigger?a.trigger("add",a,this,u):this.trigger("add",a,this,u);(o||E&&E.length)&&this.trigger("sort",this,u)}return e}remove(e,t={}){for(var r,a,n,i,s=Array.isArray(e)?e.slice():[e],o=[],u=0,l=s.length;u<l;u++)if((i=s[u])&&(n=i instanceof this.modelClass?i.id:i,r=o[u]=this.get(n))){var d=r;this._deIndex(r),a=this._models.indexOf(r),this._models.splice(a,1),t.silent||(t.index=a,d.trigger?d.trigger("remove",r,this,t):this.trigger("remove",r,this,t)),this._removeReference(d)}return o}reset(){for(var e=0,t=this._models.length;e<t;e++)this._removeReference(this._models[e]);this._reset(),this.trigger("reset",this)}sort(e={}){if(!this._comparator)throw new Error("Cannot sort without comparator");return this._models.sort(this._comparator.bind(this)),e.silent||this.trigger("sort",this,e),this}replaceId(e,t){var r=this.get(e);r&&(this._removeFromIndex(e),r.set({id:t}),this._addIndex(r))}reorderMutate(e,t){(0,s.arrayMoveMutate)(this._models,e,t)}get(e){return this._index[e]}assertGet(e){var t=this._index[e];return t||(__LOG__(4,void 0,new Error,!0)(l()),SEND_LOGS("Collection:assertGet no result")),t}at(e){return this._models[e]}get length(){return this._models.length}get isCollection(){return!0}get models(){return this._models}serialize(){return this.map((e=>e.toJSON()))}toJSON(){return this.serialize()}isModel(e){return e instanceof this.modelClass}includes(e,t=0){return 0===t?e instanceof this.modelClass&&null!=this.get(e.id):this._models.includes(e,t)}indexOf(e,t){return this._models.indexOf(e,t)}lastIndexOf(e,t){return this._models.lastIndexOf(e,t)}every(e){return this._models.every(e)}some(e){return this._models.some(e)}forEach(e){this._models.forEach(e)}map(e){return this._models.map(e)}filter(e){return this._models.filter(e)}findFirst(e){return this._models.find(e)}reduce(e,t){return this._models.reduce(e,t)}slice(e,t){return this._models.slice(e,t)}where(e){return this.filter((t=>{for(var r in e)if(e[r]!==t.get(r))return!1;return!0}))}head(){return this._models[0]}last(){return this._models[this._models.length-1]}toArray(){return this._models.slice()}getModelsArray(){return this._models}reorder(e,t){return(0,s.arrayMove)(this._models,e,t)}_reset(){this._models=[],this._index={}}_prepareModel(e,t){if(this.isModel(e))return e.collection||(e.collection=this),e;var r=(0,i.default)((0,i.default)({},t),{},{collection:this});try{return new this.modelClass(e,r)}catch(e){return void __LOG__(3)(u(),e.stack)}}_addReference(e){this._addIndex(e),e.collection||(e.collection=this),e.on&&e.on("all",this._onModelEvent,this)}_removeReference(e){this===e.collection&&delete e.collection,this._deIndex(e),e.off&&e.off("all",this._onModelEvent,this)}_addIndex(e){this._index[e.id]=e}_deIndex(e){delete this._index[e.id]}_removeFromIndex(e){this.get(e)&&delete this._index[e]}_onModelEvent(e,t,r,a){var n=e.indexOf(":"),i=-1===n?e:e.slice(0,n);("add"!==i&&"remove"!==i||r===this)&&("destroy"===i&&this.remove(t,a),this.trigger.apply(this,arguments))}}t.default=f},98486:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.prop=function(e=p){return{default:e,type:h}},t.session=function(e=p){return{default:e,type:_}},t.derived=function(e,t){return{fn:e,deps:t,type:m}},t.collection=function(e){return{val:e,type:g}},t.convert=function(e){var t=new e({},{_internalInitializationDoNotUse:!0}),r={name:e.name||"Unknown",props:{},session:{},derived:{},collections:{},isIdType:e.isIdType};e.Collection&&(r.Collection=e.Collection);e.idClass&&(r.idClass=e.idClass);e.allowedIds&&(r.allowedIds=e.allowedIds);var a=new Set(["constructor"]),n=new Set(["collection","parent","__changes","__fired","__initialized"]);(function(e){var t=[];for(var r in e)"function"!=typeof e[r]&&t.push([r,e[r]]);return t})(t).forEach((([t,i])=>{if(!n.has(t))switch(i.type){case h:r.props[t]=v(i);break;case _:r.session[t]=v(i);break;case m:r.derived[t]=(0,s.default)(i,"type"),a.add(i.fn.name);break;case g:r.collections[t]=i.val;break;default:throw new Error("Invalid defineModel Class type for ".concat(e.name,":").concat(t,"."))}}));var i=function(e){var t={},r=Object.getPrototypeOf({}),a=e;Object.getOwnPropertyNames(a).forEach((e=>{"function"==typeof a[e]&&(t[e]=a[e])}));for(;(a=Object.getPrototypeOf(a))&&a!==r;)Object.getOwnPropertyNames(a).forEach((e=>{e in t||(t[e]=a[e])}));return t}(t);return a.forEach((e=>{delete i[e]})),Object.assign(r,i),r},t.stateExtend=function(e,t){var r=(0,l.default)(t.name,"protoDef.name");delete t.name;var a=function(e,t){return{[t]:class extends e{}}[t]}(e,r),o=a.prototype,d=o.__props=[],p=o.__session=[],h=o.__derived=[],_=o._collections={},m=o._definition={},g=o._derived={};(0,i.default)(t.props,(function(e,t){d.push(t),y(o,t,e,f.PROP)})),(0,i.default)(t.session,(function(e,t){p.push(t),y(o,t,e,f.SESSION)})),(0,i.default)(t.derived,(function(e,t){h.push(t),function(e,t,r){var a=E(t),n=r.fn;e._definition[t]=e._derived[t]={sk:a,evt:"change:"+t,attr:f.DERIVED,fn:n,deps:r.deps},Object.defineProperty(e,t,{get(){var e=this[a];if(e!==c)return e;var t=n.call(this);return this[a]=t,t},set(){throw new TypeError("'".concat(t,"' is a derived property, it can't be set directly."))}})}(o,t,e)})),(0,i.default)(t.collections,(function(e,t){_[t]=e})),Object.assign(o,(0,s.default)(t,["props","session","derived","collections"]));var v=d.concat(p),S=v.length;Object.defineProperties(o,{attributes:{get(){for(var e={},t=0;t<S;++t)e[v[t]]=this[v[t]];return e}},isState:{get:()=>!0,set(){throw new Error("attempt to set isState")}}});for(var T={},b=0;b<S;b++){var A=v[b];"default"in m[A]&&(T[A]=c)}(0,n.default)(T)||(o.__defaults=T);if(h.length){var C=[],P={},O={};(0,i.default)(g,((e,t)=>{O[t]=!0,(0,i.default)(e.deps,(e=>{O[e]=!0,(P[e]||(P[e]=[])).push(t),C.push([t,e])}))})),C.length&&(o._deps=P,o._topo=u.default.array(Object.keys(O),C).reverse())}return a},t.NO_DEFAULT_VALUE=t.Attr=t.INIT=void 0;var n=a(r(45455)),i=a(r(15253)),s=a(r(17620)),o=a(r(29259)),u=a(r(95159)),l=a(r(61941)),d=r(11419),c={sentinel:"DEFAULT VALUE PLACEHOLDER"};t.INIT=c;var f={PROP:"PROP",SESSION:"SESSION",DERIVED:"DERIVED"};t.Attr=f;var p=Symbol("NO_DEFAULT_VALUE");t.NO_DEFAULT_VALUE=p;var h="Props",_="Session",m="Derived",g="Collection";function v(e){var t=e.default;return t===p?{}:{default:t}}function E(e){return"__x_"+e}function y(e,t,r,a){if(!(0,o.default)(r))throw new Error("Invalid Prop/Session definition.");var n={sk:E(t),evt:"change:".concat(t),attr:a};void 0!==r.default&&(n.default=r.default),e._definition[t]=n;var i=(0,d.isFunction)(n.default);if(null!=n.default&&!i){if(Array.isArray(n.default))throw new Error("Do not return mutable types as default values as they are shared. Type: Array provided.");if((0,o.default)(n.default))throw new Error("Do not return mutable types as default values as they are shared. Type: $FlowFixMeObjectType provided.")}var s=n.sk;Object.defineProperty(e,t,{set(e){this.set(t,e)},get(){var e=this[s];return e!==c?e:i?this[s]=n.default():n.default}})}},76128:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.ProxyStates=void 0;var n=a(r(19976)),i=a(r(22220));function s(){var e=(0,n.default)(['Cannot write proxy property "','" created in <',"/>. Make sure it is in your list of concerns."]);return s=function(){return e},e}function o(){var e=(0,n.default)(['Cannot read proxy property "','" created in <',"/>. Make sure it is in your list of concerns."]);return o=function(){return e},e}var u={};t.ProxyStates=u;t.default=(e,t,r)=>{var{props:a,session:n,collections:l,derived:d}=t,c=(0,i.default)(t,["props","session","collections","derived"]);function f(e){this.$ProxyState$state=e}var p={};[a,n,l,d].forEach((e=>{e&&Object.keys(e).forEach((e=>{p[e]={get(){return __LOG__(4,void 0,new Error,!0)(o(),e,this.$ProxyState$ComponentName),SEND_LOGS("Invalid ProxyState Access"),this.$ProxyState$state[e]},set(t){__LOG__(4,void 0,new Error,!0)(s(),e,this.$ProxyState$ComponentName),SEND_LOGS("Invalid ProxyState Write"),this.$ProxyState$state[e]=t}}}))})),p.proxyName={value:e},p.mirrorMask={value:r},p.isProxyOf={value(e){return this.$ProxyState$state===e}},["set","get",...Object.keys(c)].forEach((e=>{p[e]={value(){var t=this.$ProxyState$state;return t[e].apply(t,arguments)}}})),f.prototype=Object.create(null,p),f.prototype.constructor=f,u[e]=f}},44174:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(r(19976)),s=a(r(2784)),o=r(12073),u=a(r(61247)),l=n(r(43334)),d=n(r(79711)),c=r(19741),f=a(r(96452)),p=r(95595),h=n(r(17957)),_=n(r(21941)),m=n(r(76022)),g=n(r(68384));function v(){var e=(0,i.default)(["models:liveLocation:disableLiveLocation dropped"]);return v=function(){return e},e}class E extends u.default{constructor(...e){super(...e),this.id=(0,u.prop)(),this.duration=(0,u.prop)(),this.participants=(0,u.collection)(_.default),this.active=(0,u.session)(!1),this.keepAliveTimer=(0,u.session)(),this.stopPromise=(0,u.session)()}initialize(){super.initialize(),this.listenTo(this.participants,"remove reset",(()=>{this.hasParticipants()||this.delete()}));var e=l.default.get(this.id);e&&!e.liveLocation&&(e.liveLocation=this)}delete(){super.delete(),this.stopViewingMap(),this.participants.delete(),this.getCollection().remove(this.id);var e=l.default.get(this.id);e&&(e.liveLocation=void 0)}hasParticipants(){return this.participants.length>0}startViewingMap(){this.active||(this.active=!0,this._updateLiveLocations(),this._startKeepAlive())}stopViewingMap(){this.active&&(this.active=!1,this._pauseLiveLocations(),this._stopKeepAlive())}userHasLiveLocation(e){return!!this.participants.get(e)}iHaveLiveLocation(){return this.userHasLiveLocation((0,p.getMaybeMeUser)())}stopMyLiveLocation(e){if(!this.iHaveLiveLocation())return Promise.reject(new f.ActionError);if(this.stopPromise)return this.stopPromise;var t=this.stopPromise=m.default.disableLiveLocation(this.id),r=new o.ActionType(h.default.t(138)),a=e||(0,o.genId)(),n=t.then((e=>200===e.status?new o.ActionType(h.default.t(137)):e.status>=400?new o.ActionType(h.default.t(134)):void 0)).catch((()=>(__LOG__(3)(v()),new o.ActionType(h.default.t(134),{actionText:h.default.t(199),actionHandler:this.stopMyLiveLocation.bind(this,a)}))));return d.default.openToast(s.createElement(o.ActionToast,{id:a,initialAction:r,pendingAction:n})),t.then((e=>{if(200===e.status&&!e._duplicate){var t=this.participants.get((0,p.getMaybeMeUser)());t&&t.disable()}})).finally((()=>{this.stopPromise=null}))}_updateLiveLocations(){this.getCollection().update(this.id).catch((()=>{}))}_pauseLiveLocations(){m.default.unsubscribeLiveLocation(this.id).catchType(c.WebdDrop,(()=>{}))}_sendKeepAlive(){m.default.subscribeLiveLocation(this.id,!1).catchType(c.WebdDrop,(()=>{}))}_startKeepAlive(){if(null==this.keepAliveTimer){var e=this.duration;null!=e&&0!==e&&(this.keepAliveTimer=window.setInterval(this._sendKeepAlive.bind(this),1e3*e))}}_stopKeepAlive(){null!=this.keepAliveTimer&&(window.clearInterval(this.keepAliveTimer),this.keepAliveTimer=null)}getCollection(){return r(84383).default}}E.Proxy="liveLocation",E.idClass=g.default;var y=(0,u.defineModel)(E);t.default=y},84383:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.LiveLocationCollection=void 0;var n=a(r(70417)),i=a(r(19976)),s=a(r(54019)),o=a(r(19899)),u=a(r(50935)),l=a(r(7470)),d=r(19741),c=a(r(44174)),f=r(11419),p=a(r(76022)),h=a(r(68384));function _(){var e=(0,i.default)(["Assertion failed!"]);return _=function(){return e},e}function m(){var e=(0,i.default)(["Assertion failed!"]);return m=function(){return e},e}function g(){var e=(0,i.default)(["models:liveLocation:handle unrecognized payload"]);return g=function(){return e},e}function v(){var e=(0,i.default)(["models:liveLocation:handle unknown type: ",""]);return v=function(){return e},e}function E(){var e=(0,i.default)(["model:LiveLocation:getActive error ",""]);return E=function(){return e},e}function y(){var e=(0,i.default)(["liveLocation:participant query not implemented on the phone"]);return y=function(){return e},e}function S(){var e=(0,i.default)(["model:LiveLocation:_find error ",""]);return S=function(){return e},e}function T(){var e=(0,i.default)(["liveLocation:subscribe query not implemented on the phone"]);return T=function(){return e},e}class b extends s.default{_find(e){return h.default.isUser(e)||h.default.isGroup(e)?p.default.subscribeLiveLocation(e,!0).then((t=>{if(t.status&&t.status>=400)return 499===t.status?__LOG__(2)(T()):__LOG__(3)(S(),t.status),Promise.reject(t.status);var r=(0,f.isNumber)(t.duration)?t.duration:void 0,a=t.participants?t.participants.map((e=>(0,n.default)((0,n.default)({},this._extractLocationFields(e)),{},{id:e.id,expiration:0===e.expiration?1/0:e.expiration}))):[];return{id:e,duration:r,participants:a}})):Promise.reject(new Error("invalid wid for live location: "+e))}getActive(e){return h.default.isUser(e)||h.default.isGroup(e)?p.default.queryActiveLiveLocation(e).then((t=>{if(t.status&&t.status>=400)return 499===t.status?__LOG__(2)(y()):__LOG__(3)(E(),t.status),Promise.reject(t.status);if(t.participants&&t.participants.length){var r=t.participants.map((e=>({id:e.id,expiration:0===e.expiration?1/0:e.expiration})));this.add({id:e,participants:r},{merge:!0})}})).catchType(d.WebdDrop,(()=>{})):Promise.reject(new Error("invalid wid for live location: "+e))}onResume(){this.filter((e=>e.active&&e.hasParticipants())).forEach((e=>{this.update(e.id)}))}handle(e){Array.isArray(e)?e.forEach((e=>{switch(e.type){case"update":var t=this._extractLocationFields(e),r=l.default.get(e.jid);r&&r.liveLocations&&r.liveLocations.forEach((e=>e.set(t)));break;case"disable":var a=this.get(e.chat);if(a){var n=a.participants.get(e.jid);n&&(e.seq>n.sequence||-1===e.seq)&&n.disable()}break;default:__LOG__(3)(v(),e.type)}})):__LOG__(3)(g())}processMsg(e,t=!1){e.type===u.default.MSG_TYPE.LOCATION&&e.isLive||(__LOG__(4,void 0,new Error,!0)(m()),SEND_LOGS("collection:liveLocation trying to process non live-location msg"));var r=e.id.remote,{lat:a,lng:n,accuracy:i,speed:s,degrees:l,sequence:d,comment:c,shareDuration:f,t:p}=e;if(p&&f){var h=p+f;if(!(h<=o.default.globalUnixTime())){var _={id:e.sender,lat:a,lng:n,accuracy:i,speed:s,degrees:l,sequence:d,comment:c,expiration:h,lastUpdated:p,msg:e};-1===d&&delete _.sequence;var g=this.get(r);if(g){var v=g.participants.get(_.id);if(t)return void(v&&v.lastUpdated<=_.lastUpdated&&v.set(_));if(v&&g.participants.removeParticipant(v),g.hasParticipants())return void g.participants.add(_)}this.add({id:r,participants:[_]})}}}removeMsg(e){e.type===u.default.MSG_TYPE.LOCATION&&e.isLive||(__LOG__(4,void 0,new Error,!0)(_()),SEND_LOGS("collection:liveLocation trying to remove non live-location msg"));var t=e.id.remote,r=e.sender,a=this.get(t);a&&a.participants.remove(r)}_extractLocationFields(e){return void 0===e.lat||void 0===e.lng?{}:{lastUpdated:o.default.globalUnixTime()-e.elapsed,lat:e.lat,lng:e.lng,accuracy:e.accuracy,speed:e.speed,degrees:e.degrees,comment:e.comment}}}t.LiveLocationCollection=b,b.model=c.default,b.staleCollection=!0,b.resumeOnAvailable=!0;var A=new b;t.default=A},75492:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(r(25337)),s=a(r(61247)),o=n(r(19899)),u=n(r(7470)),l=r(95595),d=r(78054),c=r(11419),f=n(r(68384));class p extends s.default{constructor(...e){super(...e),this.id=(0,s.prop)(),this.msg=(0,s.prop)(),this.lat=(0,s.prop)(),this.lng=(0,s.prop)(),this.accuracy=(0,s.prop)(),this.speed=(0,s.prop)(),this.degrees=(0,s.prop)(),this.sequence=(0,s.prop)(),this.comment=(0,s.prop)(),this.expiration=(0,s.prop)(),this.lastUpdated=(0,s.prop)(),this.contact=(0,s.session)(),this.expireTimerId=(0,s.session)(),this.disabled=(0,s.session)(!1),this.isMe=(0,s.derived)(this._isMe,["id"]),this.valid=(0,s.derived)(this._valid,["lat","lng"])}_isMe(){return this.id.equals((0,l.getMaybeMeUser)())}_valid(){return t=this.lat,(0,c.isNumber)(t)&&t>=-90&&t<=90&&(e=this.lng,(0,c.isNumber)(e)&&e>=-180&&e<=180);var e,t}initialize(){super.initialize(),this.addChild("contact",u.default.gadd(this.id)),(0,d.addLiveLocation)(this.contact,this),this.listenTo(this,"change:expiration",this._setExpireTimer),this._setExpireTimer()}delete(){super.delete(),this._disableMsg(),(0,d.removeLiveLocation)(this.contact,this),this._clearExpireTimer()}remainingTime(){return this.expiration-o.default.globalUnixTime()}elapsedTime(){return o.default.globalUnixTime()-this.lastUpdated}disable(){this.disabled=!0}_disableMsg(){var e=this.msg;e&&(e.shareDuration=o.default.globalUnixTime()-e.t-1)}_setExpireTimer(){this.expiration&&(this.remainingTime()<=0?this._expire():this.expireTimerId=i.default.setGlobalTimeout(this._expire.bind(this),1e3*this.expiration,this.expireTimerId))}_clearExpireTimer(){i.default.clearTimeout(this.expireTimerId),this.expireTimerId=null}_expire(){this.disable()}}p.Proxy="liveLocationParticipant",p.idClass=f.default;var h=(0,s.defineModel)(p);t.default=h},21941:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(54019)),i=a(r(74460)),s=r(95595),o=a(r(75492));class u extends n.default{constructor(){super(),this.listenTo(this,"change:disabled",(e=>{e.disabled&&this.removeParticipant(e)}))}delete(){this.forEach((e=>this.removeParticipant(e)))}validLocations(){return this.filter((e=>e.valid))}removeParticipant(e){this.remove(e),e.delete()}}t.default=u,u.model=o.default,u.comparator=(e,t)=>{var r=(0,s.getMaybeMeUser)();return e.contact.id.equals(r)?-1:t.contact.id.equals(r)?1:(0,i.default)(e.contact,t.contact)}},89819:(e,t,r)=>{"use strict";var a=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(61247));class i extends n.default{constructor(...e){super(...e),this.isFocused=(0,n.session)(!0)}initialize(){super.initialize(),this._onFocus=this._onFocus.bind(this),this._onBlur=this._onBlur.bind(this)}delete(){super.delete()}_onFocus(){this.isFocused=!0}_onBlur(){this.isFocused=!1}}i.Proxy="mainWindowState";var s=new((0,n.defineModel)(i));t.default=s},27e3:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.createProductInquiry=function(e,t,r,a){var n=function(e){return new ne(e)}({ack:v.default.ACK.CLOCK,id:new k.default({id:"product_inquiry",remote:t,fromMe:!0}),from:t,t:_.default.globalUnixTime(),type:re.PRODUCT,title:e.name,description:e.description,businessOwnerJid:t.toString({legacy:!0}),productId:e.id.toString(),url:e.url,productImageCount:e.productImageCollection.length,body:r.preview&&r.preview._b64,currencyCode:e.currency,priceAmount1000:e.priceAmount1000,salePriceAmount1000:e.salePriceAmount1000,sessionId:a});return n.mediaData.set(r),n},t.default=t.TYPE=void 0;var i=n(r(52954)),s=n(r(19976)),o=n(r(17620)),u=n(r(84636)),l=n(r(45455)),d=n(r(36585)),c=r(98970),f=a(r(82704)),p=a(r(61247)),h=r(98962),_=n(r(19899)),m=n(r(79711)),g=n(r(52737)),v=n(r(50935)),E=n(r(7470)),y=r(28703),S=n(r(12396)),T=r(74253),b=n(r(25353)),A=r(95595),C=r(27853),P=n(r(18120)),O=n(r(17957)),w=r(28352),M=r(57525),I=a(r(90088)),R=a(r(28278)),D=n(r(8603)),N=r(96645),L=n(r(40210)),k=n(r(77865)),U=a(r(57556)),F=r(86809),G=n(r(61941)),x=r(45591),B=r(59420),Y=n(r(72424)),K=r(11419),j=r(86145),W=r(4526),V=r(84990),H=r(89526),q=n(r(17744)),z=n(r(68384)),J=n(r(3111));function Q(){var e=(0,s.default)(["error = ",""]);return Q=function(){return e},e}function X(){var e=(0,s.default)(["updated "," from "," to ",""]);return X=function(){return e},e}function Z(){var e=(0,s.default)(["id: "," type: ",""]);return Z=function(){return e},e}function $(){var e=(0,s.default)(["resumeUpload called while state was ",""]);return $=function(){return e},e}function ee(){var e=(0,s.default)(["Msg:initialize updating msg with out of order ack"]);return ee=function(){return e},e}function te(){var e=(0,s.default)(["msg:msg with no sender id:",", from:",", author:",", type:",""]);return te=function(){return e},e}var{MSG_TYPE:re}=v.default;t.TYPE=re;class ae extends p.default{constructor(...e){super(...e),this.id=(0,p.prop)(),this.body=(0,p.prop)(),this.type=(0,p.prop)(),this.subtype=(0,p.prop)(),this.t=(0,p.prop)(),this.notifyName=(0,p.prop)(),this.from=(0,p.prop)(),this.to=(0,p.prop)(),this.author=(0,p.prop)(),this.self=(0,p.prop)("in"),this.ack=(0,p.prop)(),this.invis=(0,p.prop)(),this.isNewMsg=(0,p.prop)(),this.star=(0,p.prop)(!1),this.recvFresh=(0,p.prop)(),this.caption=(0,p.prop)(),this.interactiveAnnotations=(0,p.prop)(),this.clientUrl=(0,p.prop)(),this.loc=(0,p.prop)(),this.lat=(0,p.prop)(),this.lng=(0,p.prop)(),this.isLive=(0,p.prop)(),this.accuracy=(0,p.prop)(),this.speed=(0,p.prop)(),this.degrees=(0,p.prop)(),this.comment=(0,p.prop)(),this.sequence=(0,p.prop)(),this.shareDuration=(0,p.prop)(),this.finalLat=(0,p.prop)(),this.finalLng=(0,p.prop)(),this.finalAccuracy=(0,p.prop)(),this.finalThumbnail=(0,p.prop)(),this.finalSpeed=(0,p.prop)(),this.finalDegrees=(0,p.prop)(),this.finalTimeOffset=(0,p.prop)(),this.deprecatedMms3Url=(0,p.prop)(),this.directPath=(0,p.prop)(),this.mimetype=(0,p.prop)(),this.duration=(0,p.prop)(),this.filehash=(0,p.prop)(),this.encFilehash=(0,p.prop)(),this.size=(0,p.prop)(),this.filename=(0,p.prop)(),this.streamingSidecar=(0,p.prop)(),this.mediaKey=(0,p.prop)(),this.mediaKeyTimestamp=(0,p.prop)(),this.pageCount=(0,p.prop)(),this.isGif=(0,p.prop)(),this.gifAttribution=(0,p.prop)(),this.isViewOnce=(0,p.prop)(),this.streamable=(0,p.prop)(),this.width=(0,p.prop)(),this.height=(0,p.prop)(),this.thumbnailDirectPath=(0,p.prop)(),this.thumbnailSha256=(0,p.prop)(),this.thumbnailEncSha256=(0,p.prop)(),this.thumbnailHeight=(0,p.prop)(),this.thumbnailWidth=(0,p.prop)(),this.scanLengths=(0,p.prop)(),this.scansSidecar=(0,p.prop)(),this.isFromTemplate=(0,p.prop)(!1),this.devicesAdded=(0,p.prop)(),this.devicesRemoved=(0,p.prop)(),this.isThisDeviceAdded=(0,p.prop)(),this.firstFrameLength=(0,p.prop)(),this.firstFrameSidecar=(0,p.prop)(),this.isAnimated=(0,p.prop)(),this.canonicalUrl=(0,p.prop)(),this.matchedText=(0,p.prop)(),this.thumbnail=(0,p.prop)(),this.richPreviewType=(0,p.prop)(),this.doNotPlayInline=(0,p.prop)(),this.title=(0,p.prop)(),this.description=(0,p.prop)(),this.businessOwnerJid=(0,p.prop)(),this.productId=(0,p.prop)(),this.currencyCode=(0,p.prop)(),this.priceAmount1000=(0,p.prop)(),this.salePriceAmount1000=(0,p.prop)(),this.retailerId=(0,p.prop)(),this.url=(0,p.prop)(),this.productImageCount=(0,p.prop)(),this.sessionId=(0,p.prop)(),this.recipients=(0,p.prop)(),this.broadcast=(0,p.prop)(),this.quotedMsg=(0,p.prop)(),this.quotedStanzaID=(0,p.prop)(),this.quotedRemoteJid=(0,p.prop)(),this.quotedParticipant=(0,p.prop)(),this.mentionedJidList=(0,p.prop)(),this.footer=(0,p.prop)(),this.hydratedButtons=(0,p.prop)(),this.buttons=(0,p.prop)(),this.selectedId=(0,p.prop)(),this.selectedIndex=(0,p.prop)(),this.multicast=(0,p.prop)(),this.urlText=(0,p.prop)(),this.urlNumber=(0,p.prop)(),this.clearMedia=(0,p.prop)(),this.isVcardOverMmsDocument=(0,p.prop)(!1),this.vcardList=(0,p.prop)(),this.vcardFormattedName=(0,p.prop)(),this.protocolMessageKey=(0,p.prop)(),this.templateParams=(0,p.prop)(),this.textColor=(0,p.prop)(),this.backgroundColor=(0,p.prop)(),this.font=(0,p.prop)(),this.isForwarded=(0,p.prop)(!1),this.forwardingScore=(0,p.prop)(),this.labels=(0,p.prop)(),this.paymentCurrency=(0,p.prop)(),this.paymentAmount1000=(0,p.prop)(),this.paymentMessageReceiverJid=(0,p.prop)(),this.paymentTransactionTimestamp=(0,p.prop)(),this.paymentStatus=(0,p.prop)(),this.paymentTxnStatus=(0,p.prop)(),this.paymentNoteMsg=(0,p.prop)(),this.paymentRequestMessageKey=(0,p.prop)(),this.paymentExpiryTimestamp=(0,p.prop)(),this.ephemeralStartTimestamp=(0,p.prop)(),this.ephemeralDuration=(0,p.prop)(),this.ephemeralSettingTimestamp=(0,p.prop)(),this.ephemeralOutOfSync=(0,p.prop)(),this.ephemeralSharedSecret=(0,p.prop)(),this.bizPrivacyStatus=(0,p.prop)(),this.verifiedBizName=(0,p.prop)(),this.inviteCode=(0,p.prop)(),this.inviteCodeExp=(0,p.prop)(),this.inviteGrp=(0,p.prop)(),this.inviteGrpName=(0,p.prop)(),this.inviteGrpJpegThum=(0,p.prop)(),this.sellerJid=(0,p.prop)(),this.message=(0,p.prop)(),this.orderTitle=(0,p.prop)(),this.itemCount=(0,p.prop)(),this.orderId=(0,p.prop)(),this.surface=(0,p.prop)(),this.status=(0,p.prop)(),this.token=(0,p.prop)(),this.totalAmount1000=(0,p.prop)(),this.totalCurrencyCode=(0,p.prop)(),this.historySyncMetaData=(0,p.prop)(),this.mdDowngrade=(0,p.prop)(),this.isSendFailure=(0,p.prop)(),this.appStateSyncKeyShare=(0,p.prop)(),this.appStateSyncKeyRequest=(0,p.prop)(),this.appStateFatalExceptionNotification=(0,p.prop)(),this.broadcastParticipants=(0,p.prop)(),this.broadcastEphSettings=(0,p.prop)(),this.broadcastId=(0,p.prop)(),this.ctwaContext=(0,p.prop)(),this.list=(0,p.prop)(),this.listResponse=(0,p.prop)(),this.promises=(0,p.session)((()=>({}))),this.local=(0,p.session)(),this.search=(0,p.session)(),this.msgChunk=(0,p.session)(),this.phoneUploading=(0,p.session)(),this.startOfDay=(0,p.session)(),this.startOfDaySkew=(0,p.session)(),this._quotedMsgObj=(0,p.session)(),this.isQuotedMsgAvailable=(0,p.session)(!0),this.senderObj=(0,p.session)(),this.mediaData=(0,p.session)(),this.forwardedFromWeb=(0,p.session)(!1),this.isDynamicReplyButtonsMsg=(0,p.prop)(!1),this.dynamicReplyButtons=(0,p.prop)(),this.replyButtons=(0,p.prop)(),this.buttonsResponse=(0,p.prop)(),this.selectedButtonId=(0,p.prop)(),this._links=(0,p.session)((()=>[])),this._headerLinks=(0,p.session)((()=>[])),this._footerLinks=(0,p.session)((()=>[])),this.linksIndexParsed=(0,p.session)(0),this.chat=(0,p.derived)(this._chat),this.hasTemplateButtons=(0,p.derived)(this._hasTemplateButtons,["buttons"]),this.ephemeralExpirationTimestamp=(0,p.derived)(this._ephemeralExpirationTimestamp,["t","subtype","ephemeralStartTimestamp","ephemeralDuration"]),this.isEphemeral=(0,p.derived)(this._isEphemeral,["ephemeralDuration","type","subtype"]),this.isQuickReply=(0,p.derived)(this._isQuickReply,["buttons"]),this.isFutureproof=(0,p.derived)(this._isFutureproof,["type","subtype"]),this.isGroupMsg=(0,p.derived)(this._isGroupMsg),this.isStatusV3=(0,p.derived)(this._isStatusV3),this.isPSA=(0,p.derived)(this._isPSA),this.isRTL=(0,p.derived)(this._isRTL,["dir"]),this.asProductInquiry=(0,p.derived)(this._asProductInquiry),this.statusV3TextBg=(0,p.derived)(this._statusV3TextBg),this.isSentByMe=(0,p.derived)(this._isSentByMe),this.isSentByMeFromWeb=(0,p.derived)(this._isSentByMeFromWeb,["isUserCreatedType"]),this.isNotification=(0,p.derived)(this._isNotification,["type","subtype"]),this.asGroupNotification=(0,p.derived)(this._asGroupNotification,["type"]),this.asBroadcastNotification=(0,p.derived)(this._asBroadcastNotification,["type"]),this.isBizNotification=(0,p.derived)(this._isBizNotification,["type","subtype"]),this.asProduct=(0,p.derived)(this._asProduct,["type"]),this.asAlbumAsset=(0,p.derived)(this._asAlbumAsset,["type","isNotification","caption","isForwarded","asRevoked","isGif","quotedMsg","ctwaContext","isViewOnce"]),this.asGroupedSticker=(0,p.derived)(this._asGroupedSticker,["type","isNotification","asRevoked","quotedMsg","ctwaContext"]),this.isMedia=(0,p.derived)(this._isMedia,["type"]),this.asDoc=(0,p.derived)(this._asDoc,["type"]),this.asImage=(0,p.derived)(this._asImage,["type"]),this.asVideo=(0,p.derived)(this._asVideo,["type"]),this.asMms=(0,p.derived)(this._asMms,["type"]),this.asRevoked=(0,p.derived)(this._asRevoked,["type"]),this.asViewOnce=(0,p.derived)(this._asViewOnce,["type","isViewOnce"]),this.asVisualMedia=(0,p.derived)(this._asVisualMedia,["type"]),this.numTimesForwarded=(0,p.derived)(this._numTimesForwarded,["isForwarded","forwardingScore"]),this.isFrequentlyForwarded=(0,p.derived)(this._isFrequentlyForwarded,["numTimesForwarded"]),this.eventType=(0,p.derived)(this._eventType,["type","invis","isNewMsg"]),this.sender=(0,p.derived)(this._sender),this.text=(0,p.derived)(this._text,["type","body","caption","comment","isLive","paymentNoteMsg","subtype"]),this.containsEmoji=(0,p.derived)(this._containsEmoji,["text"]),this.isFailed=(0,p.derived)(this._isFailed,["isSentByMe","ack","mdDowngrade","isSendFailure"]),this.vcard=(0,p.derived)(this._vcard,["type","body"]),this.isUnsentMedia=(0,p.derived)(this._isUnsentMedia,["ack","asMms","isSentByMe"]),this.dir=(0,p.derived)(this._dir,["type","text","subtype"]),this.rtl=(0,p.derived)(this._rtl,["type","text","subtype"]),this.linkPreview=(0,p.derived)(this._linkPreview,["matchedText","body","title","description"]),this.isGroupsV4InviteExpired=(0,p.derived)(this._isGroupsV4InviteExpired,["type","inviteCode","inviteCodeExp"]),this.isPersistent=(0,p.derived)(this._isPersistent),this.isUnreadType=(0,p.derived)(this._isUnreadType,["type"]),this.isUserCreatedType=(0,p.derived)(this._isUserCreatedType,["type"]),this.supportsMessageFooter=(0,p.derived)(this._supportsMessageFooter,["isDynamicReplyButtonsMsg","isFromTemplate"]),this.supportsMessageFooterLinks=(0,p.derived)(this._supportsMessageFooterLinks,["type","isDynamicReplyButtonsMsg"]),this.hasBodyOrFooter=(0,p.derived)(this._hasBodyOrFooter,["text","footer"]),this.initialPageSize=(0,p.derived)(this._initialPageSize,["isFrequentlyForwarded"])}_chat(){return this._getChatCollection().get(this.id.remote)}_hasTemplateButtons(){return this.isFromTemplate&&null!=this.buttons&&this.buttons.length>0}_ephemeralExpirationTimestamp(){var{ephemeralDuration:e,ephemeralStartTimestamp:t,t:r,subtype:a,id:{fromMe:n}}=this;return(0,C.getEphemeralExpirationTimestamp)(e,t,r,a,n)}_isEphemeral(){return(this.type!==re.PROTOCOL||"ephemeral_setting"!==this.subtype)&&(null!=this.ephemeralDuration&&0!==this.ephemeralDuration)}_isQuickReply(){if(!this.hasTemplateButtons)return!1;if(null==this.buttons)return!1;var e=this.buttons.at(0);return null!=e&&e.subtype===v.default.TEMPLATE_BUTTON_SUBTYPE.QUICK_REPLY}_isFutureproof(){return this.type===re.UNKNOWN||this.type===re.PAYMENT&&"futureproof"===this.subtype}_isGroupMsg(){return z.default.isGroup(this.from)||z.default.isGroup(this.to)}_isStatusV3(){return z.default.isStatusV3(this.id.remote)}_isPSA(){return z.default.isPSA(this.id.remote)}_isRTL(){return"rtl"===this.dir||void 0===this.dir&&O.default.isRTL()}_asProductInquiry(){var e=this.safe();return e.type===v.default.MSG_TYPE.PRODUCT&&e.id&&e.id.id===v.default.PRODUCT_INQUIRY_TYPE?e:null}_statusV3TextBg(){if(!this.isStatusV3)return null;var e=this.backgroundColor;return e?"rgba(".concat(e>>16&255,", ").concat(e>>8&255,", ").concat(255&e,", ").concat(e>>24&255,")"):null}_isSentByMe(){return"in"!==this.id.self&&!this.isNotification&&z.default.equals(this.from,(0,A.getMaybeMeUser)())}_isSentByMeFromWeb(){return this.id.fromMe&&this.local&&this.isUserCreatedType}_isNotification(){return U.isNotification(this.type,this.subtype)}_asGroupNotification(){var e=this.safe();switch(e.type){case re.GROUP_NOTIFICATION:case re.GP2:return e;default:return null}}_asBroadcastNotification(){var e=this.safe();return e.type===re.BROADCAST_NOTIFICATION?e:null}_isBizNotification(){if(this.type===re.NOTIFICATION_TEMPLATE){if(h.BIZ_SYSTEM_MSG_SUBTYPES.includes(this.subtype))return!0;switch(this.subtype){case"verified_initial_unknown":case"verified_initial_low":case"verified_initial_high":case"verified_transition_any_to_none":case"verified_transition_any_to_high":case"verified_transition_high_to_low":case"verified_transition_high_to_unknown":case"verified_transition_unknown_to_low":case"verified_transition_low_to_unknown":case"verified_transition_none_to_low":case"verified_transition_none_to_unknown":case"biz_verified_transition_top_to_bottom":case"biz_verified_transition_bottom_to_top":case"biz_intro_top":case"biz_intro_bottom":case"biz_name_change":case"biz_move_to_consumer_app":case"biz_two_tier_migration_top":case"biz_two_tier_migration_bottom":return!0;default:return!1}}return!1}_asProduct(){var e=this.safe();return"product"===e.type?e:null}_asAlbumAsset(){var e=this.safe();return e.type!==v.default.MSG_TYPE.IMAGE&&(e.type!==v.default.MSG_TYPE.VIDEO||!0===e.isGif)||e.isNotification||e.caption||e.asRevoked||e.quotedMsg||e.ctwaContext||e.isViewOnce?null:e}_asGroupedSticker(){var e=this.safe();return e.type!==v.default.MSG_TYPE.STICKER||e.isNotification||e.asRevoked||e.quotedMsg||e.ctwaContext?null:e}_isMedia(){return["image","video","audio"].includes(this.type)}_asDoc(){var e=this.safe();return e.type===v.default.MSG_TYPE.DOCUMENT?e:null}_asImage(){var e=this.safe();return e.type===v.default.MSG_TYPE.IMAGE?e:null}_asVideo(){var e=this.safe();return e.type===v.default.MSG_TYPE.VIDEO?e:null}_asMms(){var e=this.safe();return(0,U.typeIsMms)(e)?e:null}_asRevoked(){var e=this.safe();return e.type===re.REVOKED?e:null}_asViewOnce(){var e=this.asVisualMedia;return(null==e?void 0:e.isViewOnce)?e:null}_asVisualMedia(){var e=this.safe();return e.type===v.default.MSG_TYPE.IMAGE||e.type===v.default.MSG_TYPE.VIDEO?e:null}_numTimesForwarded(){return this.forwardingScore?this.forwardingScore||0:this.isForwarded?1:0}_isFrequentlyForwarded(){return this.numTimesForwarded>=v.default.FREQUENTLY_FORWARDED_SENTINEL}_eventType(){if(!this.isNewMsg)return"i";var e=(0,U.eventTypeFromMsgType)(this);return this.invis?"i"===e?"i":"n":e}_sender(){return this.isSentByMe?this.from:this.isGroupMsg||this.isStatusV3?this.author:this.from}_text(){var e;if(this.isFromTemplate||this.isDynamicReplyButtonsMsg)return this.type===re.CHAT?this.body:this.caption;switch(this.type){case re.CHAT:return this.body;case re.IMAGE:case re.VIDEO:return this.caption;case re.LOCATION:return this.isLive?this.comment:void 0;case re.PAYMENT:var{paymentNoteMsg:t}=this;return t?t.body:void 0;case re.GROUPS_V4_INVITE:return this.comment;case re.LIST:return null===(e=this.list)||void 0===e?void 0:e.description;case re.PRODUCT:return(0,d.default)(this.title,{length:v.default.MAX_REPLY_PRODUCT_TITLE_LENGTH});case re.HSM:case re.TEMPLATE_BUTTON_REPLY:return this.body;default:return}}_containsEmoji(){var{text:e}=this;return!!e&&S.default.containsEmoji(e)}_isFailed(){var e=this.isSentByMe&&this.ack<v.default.ACK.CLOCK;return P.default.supportsFeature(P.default.F.MD_BACKEND)?e||!!this.mdDowngrade||!!this.isSendFailure:e}_vcard(){if(this.type===re.VCARD)try{return(0,V.parseVcard)(this.body)}catch(e){return}}_isUnsentMedia(){return this.ack<v.default.ACK.SENT&&null!=this.asMms&&this.isSentByMe}_dir(){return this.type===re.VCARD?this.subtype?f.dir(this.subtype):void 0:this.text?f.dir(this.text):void 0}_rtl(){return this.type===re.VCARD?!!this.subtype&&"rtl"===f.dir(this.subtype):!!this.text&&"rtl"===f.dir(this.text)}_linkPreview(){return(0,K.isString)(this.matchedText)&&(!(0,l.default)(this.title)||!(0,l.default)(this.description))&&this.body.includes(this.matchedText)}_isGroupsV4InviteExpired(){if(this.type!==v.default.MSG_TYPE.GROUPS_V4_INVITE)return!1;if(!this.inviteCode)return!0;var e=(new Date).getTime()/1e3;return parseInt(e,10)>=parseInt(this.inviteCodeExp,10)}_isPersistent(){return this.type===re.E2E_NOTIFICATION&&"encrypt"===this.subtype}_isUnreadType(){return[re.CHAT,re.IMAGE,re.VIDEO,re.AUDIO,re.PTT,re.DOCUMENT,re.VCARD,re.LOCATION,re.CIPHERTEXT,re.OVERSIZED,re.MULTI_VCARD,re.REVOKED,re.UNKNOWN,re.STICKER,re.PRODUCT,re.GROUPS_V4_INVITE].includes(this.type)}_isUserCreatedType(){return[re.PROTOCOL,re.CHAT,re.LOCATION,re.VCARD,re.MULTI_VCARD,re.IMAGE,re.VIDEO,re.AUDIO,re.PTT,re.DOCUMENT,re.STICKER,re.PRODUCT,re.GROUPS_V4_INVITE].includes(this.type)}_supportsMessageFooter(){return this.isFromTemplate||this.isDynamicReplyButtonsMsg}_supportsMessageFooterLinks(){return this.isDynamicReplyButtonsMsg||this.type===re.LIST}_hasBodyOrFooter(){return null!=this.text||null!=this.footer}_initialPageSize(){return this.isFrequentlyForwarded?v.default.FREQUENTLY_FORWARDED_INITIAL_PAGE_SIZE:v.default.INITIAL_PAGE_SIZE}initialize(){if(super.initialize(),this._pendingAckUpdate=new c.PromiseQueue,this.sender)this.addChild("senderObj",E.default.gadd(this.sender));else switch(this.type){case re.NOTIFICATION:case re.NOTIFICATION_TEMPLATE:case re.GROUP_NOTIFICATION:case re.GP2:case re.BROADCAST_NOTIFICATION:case re.E2E_NOTIFICATION:case re.CALL_LOG:case re.PROTOCOL:break;default:__LOG__(2)(te(),this.id.toString(),this.from.toString(),this.author&&this.author.toString(),this.type)}var e;this.mentionedJidList=this.mentionedJidList||[],this.mentionedJidList.forEach((e=>E.default.gadd(e)));var t=this.getCollection();(e=t.preAck[this.id])&&(__LOG__(2)(ee()),this.updateAck(e.ack,e.t),delete t.preAck[this.id]),this.type===re.CIPHERTEXT&&this.listenToOnce(this,"change:type",this.onCiphertextDecrypted),this.mediaObject=void 0,U.typeIsMms(this)&&(this._createMediaDataChild(),this.isViewOnce&&!(0,H.isUnviewed)(this.safe())||R.registerMsg(this)),this.isSentByMeFromWeb&&(this.promises.sendPromise=Promise.sit("settled").finally((()=>{this.promises.sendPromise=null})).endWithControls("settled")),this.isLive&&r(84383).default.processMsg(this,!1),g.default.isSMB&&(0,w.initializeLabels)(this),this.isViewOnce&&(this.listenTo(this,"change:ack",this.onViewOnceMediaStatusChanged),this.listenTo(this.mediaData,"change:mediaStage",this.onViewOnceMediaStatusChanged))}_getLinks(e,t=[],r=0,a=1/0){if(r>=a)return[t,a];var n=(0,j.firstNCodepoints)(e,a),i=I.findLinks(n,false,this.sender);if((0,j.numCodepoints)(e)>a&&i.length>0){var s=i[i.length-1];(0,j.numCodepoints)(n.slice(0,s.index))+(0,j.numCodepoints)(s.url)===a&&(i=I.findLinks(e,false,this.sender))}return[i,a]}getLinks(e=this.initialPageSize+1){var{text:t}=this;if(null==t)return this._links;var[r,a]=this._getLinks(t,this._links,this.linksIndexParsed,e);return this.linksIndexParsed=a,this._links=r}getHeaderLinks(){if(!1===this.isDynamicReplyButtonsMsg||null==this.title)return[];if(this._headerLinks.length>0)return this._headerLinks;var[e]=this._getLinks(this.title,this._headerLinks);return this._headerLinks=e}getFooterLinks(){if(!this.supportsMessageFooterLinks||null==this.footer)return[];if(this._footerLinks.length>0)return this._footerLinks;var[e]=this._getLinks(this.footer,this._footerLinks);return this._footerLinks=e}getGalleryLinks(){return(0,u.default)(this.getLinks(),"href").filter((e=>e.isHttp))}getSuspiciousLinks(){return this.getLinks().filter((e=>e.suspiciousCharacters&&e.suspiciousCharacters.size))}_createMediaDataChild(){this.addChild("mediaData",new D.default)}hasSymbol(){return["image","video","audio","ptt","location","vcard","multi_vcard","document","ciphertext","oversized","unknown","call_log","revoked","sticker","payment","groups_v4_invite","product","order"].includes(this.type)}mayFail(){return this.isSentByMe&&this.ack<v.default.ACK.SENT}isUnsentPhoneMsg(){return!this.local&&this.isSentByMe&&this.ack<v.default.ACK.SENT}canReply(){return!(this.type===re.LIST&&!(0,U.listMsgCanRender)(this))&&(this.chat.canSend&&!this.mayFail()&&!this.isNotification&&this.type!==re.UNKNOWN&&this.type!==re.CIPHERTEXT&&this.type!==re.OVERSIZED&&this.type!==re.REVOKED&&this.interactiveButtonsReleased())}canPrivateReply(){return!this.mayFail()&&!this.isNotification&&this.type!==re.UNKNOWN&&this.type!==re.CIPHERTEXT&&this.type!==re.OVERSIZED&&this.type!==re.REVOKED&&!this.isSentByMe&&this.isGroupMsg&&this.interactiveButtonsReleased()}canPrivateReplyInRestrictedGrp(){return!!this.chat.isAnnounceGrpRestrict&&!this.chat.isReadOnly&&!this.mayFail()&&!this.isSentByMe&&!this.isNotification&&this.type!==re.UNKNOWN&&this.type!==re.CIPHERTEXT&&this.type!==re.OVERSIZED&&this.type!==re.REVOKED&&this.interactiveButtonsReleased()}canForward(){var e;if(this.type===re.CIPHERTEXT)return!1;if(this.type===re.OVERSIZED)return!1;if(this.type===re.REVOKED)return!1;if(this.type===re.UNKNOWN)return!1;if(this.type===re.PAYMENT)return!1;if(this.type===re.LIST)return(null===(e=this.list)||void 0===e?void 0:e.listType)===y.ListMessageListType.PRODUCT_LIST&&(0,U.listMsgCanRender)(this);if(this.type===re.GROUPS_V4_INVITE)return!1;if(this.type===re.LOCATION&&this.isLive)return!1;if(this.type===re.ORDER)return!1;if(!this.interactiveButtonsReleased())return!1;if(this.ack<v.default.ACK.SENT&&this.isSentByMe)return!1;if(this.asMms){var t=this.mediaData;if(t.mediaStage===N.MEDIA_DATA_STAGE.EXISTS)return!0;if(t.mediaStage===N.MEDIA_DATA_STAGE.ERROR_MISSING)return!1;if(t.mediaStage===N.MEDIA_DATA_STAGE.ERROR_UNSUPPORTED)return!1;if(t.mediaStage!==N.MEDIA_DATA_STAGE.RESOLVED&&(this.type===re.IMAGE||this.type===re.VIDEO||this.type===re.PTT))return!1;if(this.isViewOnce)return!1;if(this.isUnsentMedia)return!1}return!0}canQuickForward(){return!(!this.canForward()||this.isFrequentlyForwarded||0!==this.getSuspiciousLinks().length||this.type===v.default.MSG_TYPE.PTT||this.type===v.default.MSG_TYPE.STICKER||!this.interactiveButtonsReleased())&&(null!=this.asMms||this.linkPreview||this.type===v.default.MSG_TYPE.VCARD||this.type===v.default.MSG_TYPE.LOCATION||null!=this.ctwaContext)}canStar(){return!(this.type===re.LIST&&!(0,U.listMsgCanRender)(this))&&(!this.isNotification&&!this.isFutureproof&&!this.isViewOnce&&this.type!==re.REVOKED&&!(this.ack<v.default.ACK.SENT&&this.isSentByMe)&&this.interactiveButtonsReleased())}interactiveButtonsReleased(){return this.isFromTemplate||!this.hasTemplateButtons&&this.type!==v.default.MSG_TYPE.TEMPLATE_BUTTON_REPLY}isGroupLeave(){return"gp2"===this.type&&("leave"===this.subtype||"remove"===this.subtype)&&z.default.equals(this.recipients[0],(0,A.getMaybeMeUser)())}isTrusted(){return!!z.default.equals(this.sender,(0,A.getMaybeMeUser)())||(!(!this.senderObj||!this.senderObj.isMyContact)||(this.isGroupMsg?this.chat.isTrusted():this.chat.notSpam))}getVcardWids(){return this.type!==re.VCARD?null:(0,V.vcardWids)(this.vcard)}getLocObject(){var e=this.loc;if(e){var[t,r=null]=e.split("\n");return{name:t,addr:r}}return null}resumeRemoteUpload(){return this.isUnsentPhoneMsg()&&!this.phoneUploading&&((0,x.sendMsgRecord)(this).then((e=>{e!==B.SendMsgResult.OK&&(this.phoneUploading=!1)})),this.phoneUploading=!0),this.downloadMedia({downloadEvenIfExpensive:!0,rmrReason:L.default.WEBC_RMR_REASON_CODE.MSG_CLICK,isUserInitiated:!0})}forceRMR(){return Promise.reject(new Error("unimplemented forceRMR"))}isForcingRMR(){return!1}cancelDownload(){R.cancelDownloadMsg(this)}resumeUpload(){return this.mediaData.mediaStage!==N.MEDIA_DATA_STAGE.NEED_UPLOAD&&(__LOG__(4,void 0,new Error,!0)($(),this.mediaData.mediaStage),SEND_LOGS("resume-non-need-upload")),R.resumeUploadMsg(this)}cancelUpload(){R.cancelUploadMsg(this)}logInitialRender(){if(this.asMms&&this.mediaData&&!this.isStatusV3&&!this._renderEvent){var e=this._renderEvent=new L.default.WebcMediaRender({messageMediaType:this.getWamMediaType(),webcChatType:this.chat.getWebcChatType(),webcChatPosition:this.chat.initialIndex,webcBrowserNetworkType:(0,F.getEffectiveNetworkType)(),webcMessageT:this.t}),{msgChunk:t}=this;t&&t===this.chat.msgs&&(e.webcMessageIndex=t.length-t.indexOf(this)-1);var r=()=>{switch(this.mediaData.mediaStage){case N.MEDIA_DATA_STAGE.INIT:case N.MEDIA_DATA_STAGE.PREPARING:case N.MEDIA_DATA_STAGE.FETCHING:case N.MEDIA_DATA_STAGE.DECRYPTING:case N.MEDIA_DATA_STAGE.REMOTE_UPLOADING:case N.MEDIA_DATA_STAGE.REUPLOADING:case N.MEDIA_DATA_STAGE.UPLOADING:case N.MEDIA_DATA_STAGE.SENDING:return;case N.MEDIA_DATA_STAGE.RESOLVED:e.webcMediaStage=L.default.WEBC_MEDIA_STAGE_TYPE.RESOLVED;break;case N.MEDIA_DATA_STAGE.NEED_POKE:e.webcMediaStage=L.default.WEBC_MEDIA_STAGE_TYPE.NEEDS_RMR;break;default:e.webcMediaStage=L.default.WEBC_MEDIA_STAGE_TYPE.OTHER}this._logStorageEstimate(e).finally((()=>{e.commit(),this.stopListening(this.mediaData,"change:mediaStage",r)}))};this.listenToAndRun(this.mediaData,"change:mediaStage",r)}}waitForPhoneUpload(){var e=this;return(0,i.default)((function*(){if(!Boolean(e.mediaData.filehash)||e.isUnsentPhoneMsg()){if(e.promises.waitForPhoneUploadPromise)return e.promises.waitForPhoneUploadPromise;e.promises.waitForPhoneUploadPromise=(0,q.default)(e.mediaData,"change:mediaStage change:filehash",(()=>Boolean(e.mediaData.filehash)&&!e.isUnsentPhoneMsg())),yield e.promises.waitForPhoneUploadPromise,e.promises.waitForPhoneUploadPromise=null}}))()}downloadMedia(e){if(this.asRevoked)return Promise.resolve();var{downloadEvenIfExpensive:t,rmrReason:r,isUserInitiated:a}=e;if(this.asMms||(__LOG__(4,void 0,new Error,!0)(Z(),this.id.toString(),this.type),SEND_LOGS("media-fault: downloadMedia msg is not mms type")),this.isUnsentPhoneMsg()){var n=this.promises.waitForPhoneUploadPromise;return n||(n=this.promises.waitForPhoneUploadPromise=(0,q.default)(this.mediaData,"change:mediaStage change:filehash",(()=>!!this.mediaData.filehash&&!this.isUnsentPhoneMsg())).then((()=>{this.promises.waitForPhoneUploadPromise=null}))),n.then((()=>this.downloadMedia(e)))}return R.downloadMsg({msg:this,isUserClick:r===L.default.WEBC_RMR_REASON_CODE.MSG_CLICK,downloadEvenIfExpensive:t,rmrReason:r,rmrData:this._getRmrData(r),mode:a?"manual":"auto"})}_getRmrData(e){var t={webcRmrReason:e,webcMessageT:this.t},r=this.chat;if(r){t.webcChatType=r.getWebcChatType(),null!=r.initialIndex&&(t.webcChatPosition=r.initialIndex);var{msgChunk:a}=this;a&&a===r.msgs&&(t.webcMessageIndex=a.length-a.indexOf(this)-1)}return t}applyUpdate(e){return e.type&&this.type!==e.type&&U.typeIsMms(e)?(this.type!==re.CIPHERTEXT&&(__LOG__(4,void 0,new Error,!0)(X(),this.id.toString(),this.type,String(e.type)),SEND_LOGS("invalid-type-update")),this._createMediaDataChild(),R.registerMsgEarly(this,e),R.prepareMsg(this).then((()=>{this.set(e)})).catch((e=>{__LOG__(4,void 0,new Error,!0)(Q(),String(e)),SEND_LOGS("preregister-error")}))):(this.set(e),this.isLive&&r(84383).default.processMsg(this,!0),this.paymentTransactionTimestamp&&this.getCollection().updateLastTransactionTime(this.id.remote,this.paymentTransactionTimestamp),Promise.resolve())}waitForPrep(){return U.typeIsMms(this)?R.prepareMsg(this):Promise.resolve()}delete(e){super.delete(),r(63095).default.remove(this),this.isLive&&r(84383).default.removeMsg(this),this.getCollection().remove(this.id),this.msgChunk&&this.msgChunk.remove(this.id,{},Boolean(e&&e.skipUpdatingSortTime)),U.typeIsMms(this)&&R.deregisterMsg(this),r(23539).default.removeAllLabelsMD(this);var t=this._getChatCollection().get(this.id.remote);if(t){if(t.unreadMsgAnchor===this&&(t.unreadMsgAnchor=void 0),(!e||!e.doNotResetLastReceived)&&t.lastReceivedKey===this.id){var a=void 0,n=t.getLastReceivedMsg();n&&(a=n.id),(0,M.setLastReceivedKey)(t.id,a).then((()=>{t.lastReceivedKey=a}))}t.composeQuotedMsg===this&&(t.composeQuotedMsg=null)}}quotedMsgObj(){if(!this.quotedMsg&&!this.paymentRequestMessageKey)return null;if(this._quotedMsgObj){var e=this.getCollection();return U.getOriginalQuotedMsgIfPossible(this._quotedMsgObj,e)}if(this.quotedMsg)this._quotedMsgObj=this._getQuotedMsgObj();else{if(!this.paymentRequestMessageKey)return null;this._quotedMsgObj=this._getQuotedPaymentRequestMsg()}var t=this.getCollection();return U.getOriginalQuotedMsgIfPossible(this._quotedMsgObj,t)}_getQuotedMsgObj(){var e=(0,A.getMaybeMeUser)(),t=!this.quotedParticipant||z.default.equals(this.quotedParticipant,e),r=t?"out":"in",a=this.quotedRemoteJid?this.quotedRemoteJid:this.id.remote,n={id:this.quotedStanzaID,from:t?e:a,to:t?a:e,self:r,author:(0,G.default)(this.quotedParticipant,"this.quotedParticipant"),remote:a};return!(z.default.isGroup(n.from)||z.default.isGroup(n.to))&&!z.default.isStatusV3(a)||z.default.equals(e,this.quotedParticipant)&&!P.default.supportsFeature(P.default.F.MD_BACKEND)||(n.participant=(0,G.default)(this.quotedParticipant,"this.quotedParticipant")),Object.assign(n,this.quotedMsg),U.createQuotedMsg(n)}_getQuotedPaymentRequestMsg(){if(!this.paymentRequestMessageKey)return null;var e=this.paymentRequestMessageKey.remote?this.paymentRequestMessageKey.remote:this.id.remote,t=this.paymentRequestMessageKey.fromMe,r=null!=this.paymentRequestMessageKey.self?this.paymentRequestMessageKey.self:t?"out":"in",a=this.paymentRequestMessageKey.participant||this.paymentMessageReceiverJid,n={id:this.paymentRequestMessageKey.id,from:t?(0,A.getMaybeMeUser)():e,to:t?e:(0,A.getMaybeMeUser)(),self:r,participant:a,author:a,remote:e,amount1000:this.paymentAmount1000,currency:this.paymentCurrency,receiverJid:this.sender,type:this.type,subtype:"request"};return U.createQuotedMsg(n)}getQuotedMsgAdminGroupJid(){return null==this.quotedMsg?this.quotedRemoteJid:null}msgContextInfo(e){var t=(0,o.default)(this.toJSON(),["id","t","notifyName","from","to","author","self","ack","invis","isNewMsg","star","recvFresh","recipients","broadcast","quotedMsg","quotedStanzaID","quotedRemoteJid","quotedParticipant","senderObj","multicast","replyButtons"]),r=null;return e&&!this.id.remote.equals(e)&&(r=this.id.remote),{quotedMsg:t,quotedParticipant:this.sender,quotedStanzaID:this.id.id,quotedRemoteJid:r}}displayName(e,t){if(!this.sender)return"";if(this.sender.equals((0,A.getMaybeMeUser)()))return O.default.t(1896);var r=this.senderObj,a=e?r.shortName:void 0;if(a)return a;if(r.name)return r.name;var n=t&&this.notifyName?" ~"+this.notifyName:"";return(0,J.default)(this.sender)+n}isQuoted(e){var t=this.quotedMsgObj();return!!t&&t.sender.equals(e)}isMentioned(e){return!!this.mentionedJidList&&this.mentionedJidList.findIndex((t=>t.equals(e)))>-1}mentionMap(){if(!this.mentionedJidList)return null;if(!this.mentionedJidList.length)return null;var e={};return this.mentionedJidList.forEach((t=>{e["@".concat(z.default.user(t)||"")]=E.default.gadd(t)})),e}updateAck(e,t){if(P.default.supportsFeature(P.default.F.MD_BACKEND))this.updateAckMD(e,t);else{var r=this.ack;(0,K.isNumber)(e)&&(void 0===r||e>r||e===v.default.ACK.FAILED)?(this.ack=e,e>=1&&null!=t&&null==this.ephemeralStartTimestamp&&this.updateEphemeralStartTimestamp(t),"ephemeral_setting"===this.subtype&&1===e&&null!=t&&(0,T.updateEphemeralSettingTimestamp)(this.chat,t)):e===v.default.ACK.FAILED&&this.ack===v.default.ACK.CLOCK&&(this.ack=v.default.ACK.FAILED,this.phoneUploading=!1)}}updateAckMD(e,t){var r=this;this._pendingAckUpdate.enqueue((0,i.default)((function*(){var a=r.ack;(0,K.isNumber)(e)&&(void 0===a||e>a||e===v.default.ACK.FAILED)?(yield(0,W.updateLocal)(r.id,{ack:e}),r.ack=e,e>=1&&null!=t&&null==r.ephemeralStartTimestamp&&r.updateEphemeralStartTimestamp(t),"ephemeral_setting"===r.subtype&&1===e&&null!=t&&(0,T.updateEphemeralSettingTimestamp)(r.chat,t)):e===v.default.ACK.FAILED&&r.ack===v.default.ACK.CLOCK&&(yield(0,W.updateLocal)(r.id,{ack:v.default.ACK.FAILED}),r.ack=v.default.ACK.FAILED,r.phoneUploading=!1)})))}avParams(){return R.mediaMetadata(this)}resend(){return this.isFailed?(this._pendingAckUpdate.enqueue((()=>(0,W.updateLocal)(this.id,{ack:v.default.ACK.CLOCK}).then((()=>{this.ack=v.default.ACK.CLOCK})))),this.asMms?this.isSentByMeFromWeb?this.resumeUpload():this.resumeRemoteUpload():(0,x.sendMsgRecord)(this)):Promise.resolve()}onCiphertextDecrypted(){if(!this.isStatusV3){var e=this.chat,t=e.msgs.length,r=e.msgs.indexOf(this);-1!==r&&t-r<=10&&m.default.alertNewMsg(this)}}onViewOnceMediaStatusChanged(){if(this.isViewOnce){var e=this.isSentByMe&&this.ack>=v.default.ACK.SENT&&this.mediaData.mediaStage===N.MEDIA_DATA_STAGE.RESOLVED,t=!this.isSentByMe&&this.ack>=v.default.ACK.PLAYED;(e||t)&&(R.deregisterMsg(this),this.stopListening(this,"change:ack",this.onViewOnceMediaStatusChanged),this.stopListening(this.mediaData,"change:mediaStage",this.onViewOnceMediaStatusChanged))}}canRevoke(){return this.id.fromMe&&this.isUserCreatedType&&(!z.default.isBroadcast(this.id.remote)||"iphone"===g.default.platform)&&!this.broadcast&&Math.trunc(+new Date/1e3)-this.t<=v.default.REVOKE_WINDOW&&!this.isUnsentPhoneMsg()&&!this.isUnsentMedia}getWamMessageType(){return this.isStatusV3?L.default.MESSAGE_TYPE.STATUS:this.isGroupMsg?L.default.MESSAGE_TYPE.GROUP:z.default.isBroadcast(this.id.remote)?L.default.MESSAGE_TYPE.BROADCAST:L.default.MESSAGE_TYPE.INDIVIDUAL}getWamMediaType(){var e,t;if(!0===this.isDynamicReplyButtonsMsg)return L.default.MEDIA_TYPE.BUTTON_MESSAGE;switch(this.type){case re.IMAGE:return L.default.MEDIA_TYPE.PHOTO;case re.VIDEO:return this.mediaData.isGif?L.default.MEDIA_TYPE.GIF:L.default.MEDIA_TYPE.VIDEO;case re.AUDIO:return L.default.MEDIA_TYPE.AUDIO;case re.PTT:return L.default.MEDIA_TYPE.PTT;case re.DOCUMENT:return L.default.MEDIA_TYPE.DOCUMENT;case re.UNKNOWN:return L.default.MEDIA_TYPE.FUTURE;case re.LOCATION:return this.isLive?L.default.MEDIA_TYPE.LIVE_LOCATION:L.default.MEDIA_TYPE.LOCATION;case re.VCARD:return L.default.MEDIA_TYPE.CONTACT;case re.MULTI_VCARD:return L.default.MEDIA_TYPE.CONTACT_ARRAY;case re.CHAT:return this.linkPreview?L.default.MEDIA_TYPE.URL:L.default.MEDIA_TYPE.NONE;case re.STICKER:return L.default.MEDIA_TYPE.STICKER;case re.PRODUCT:return L.default.MEDIA_TYPE.PRODUCT_IMAGE;case re.LIST:switch(null!==(e=null===(t=this.list)||void 0===t?void 0:t.listType)&&void 0!==e?e:y.ListMessageListType.UNKNOWN){case y.ListMessageListType.SINGLE_SELECT:return L.default.MEDIA_TYPE.LIST;case y.ListMessageListType.PRODUCT_LIST:return L.default.MEDIA_TYPE.PRODUCT_LIST;default:return L.default.MEDIA_TYPE.NONE}case re.LIST_RESPONSE:return L.default.MEDIA_TYPE.LIST_REPLY;case re.BUTTONS_RESPONSE:return L.default.MEDIA_TYPE.BUTTON_RESPONSE_MESSAGE;case re.ORDER:return L.default.MEDIA_TYPE.ORDER;default:return L.default.MEDIA_TYPE.NONE}}getForwardingScoreWhenForwarded(){if(!Y.default.frequentlyForwardedMessages)return this.numTimesForwarded;var e=this.numTimesForwarded+(this.id.fromMe?0:1);return e>=Y.default.frequentlyForwardedThreshold?v.default.FREQUENTLY_FORWARDED_SENTINEL:e}updateEphemeralStartTimestamp(e){return(0,W.updateLocal)(this.id,{ephemeralStartTimestamp:e}).then((()=>{this.ephemeralStartTimestamp=e}))}isExpired(){return null!=this.ephemeralExpirationTimestamp&&this.ephemeralExpirationTimestamp<=_.default.globalUnixTime()}_logStorageEstimate(e){return(0,b.default)().then((t=>{t&&(e.webcBrowserStorageQuotaBytes=t.quota,e.webcBrowserStorageQuotaUsedBytes=t.usage)}))}getCollection(){return r(58885).default}_getChatCollection(){return r(43334).default}isDownloadable(){var e;return!this.asRevoked&&(!this.isViewOnce&&(this.type===v.default.MSG_TYPE.VCARD||this.type===v.default.MSG_TYPE.MULTI_VCARD||!!(null===(e=this.mediaData)||void 0===e?void 0:e.isDownloadable())&&this.type!==v.default.MSG_TYPE.STICKER))}safe(){return this}unsafe(){return this}}ae.Proxy="msg",ae.idClass=k.default;var ne=(0,p.defineModel)(ae),ie=ne;t.default=ie},47340:(e,t,r)=>{"use strict";var a=r(14859),n=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(r(61247)),s=a(r(77865));class o extends i.default{constructor(...e){super(...e),this.id=(0,i.prop)(),this.unsyncedButtonReplies=(0,i.prop)()}}o.Proxy="msgButtonReplyMsg",o.idClass=s.default;var u=(0,i.defineModel)(o);t.default=u},30797:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(54019)),i=a(r(47340));class s extends n.default{}t.default=s,s.model=i.default},58885:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.MsgCollection=void 0;var i=n(r(70417)),s=n(r(19976)),o=r(5497),u=n(r(54019)),l=n(r(50935)),d=r(28703),c=r(19741),f=r(44700),p=r(95595),h=n(r(27e3)),_=n(r(30797)),m=n(r(77865)),g=n(r(61941)),v=r(81233),E=n(r(76485)),y=r(11419),S=n(r(17744)),T=n(r(76022)),b=n(r(68384)),A=r(75637),C=a(r(12767));function P(){var e=(0,s.default)(["Msg:resyncReceipts dropped "," ",""]);return P=function(){return e},e}function O(){var e=(0,s.default)(["Msg:resyncReceipts error"]);return O=function(){return e},e}function w(){var e=(0,s.default)(["Msg:resyncReceipts invalid response: ",""]);return w=function(){return e},e}function M(){var e=(0,s.default)(["Msg:resyncReceipts success"]);return M=function(){return e},e}function I(){var e=(0,s.default)(["Msg:resyncReceipts"]);return I=function(){return e},e}function R(){var e=(0,s.default)(["Msg:resyncReceipts wid in lastReceivedReceipt, but no msg: ",""]);return R=function(){return e},e}function D(){var e=(0,s.default)(["model:msg:getContext:before ctx message mismatch"]);return D=function(){return e},e}function N(){var e=(0,s.default)(["model:msg:getContext:before fetch error"]);return N=function(){return e},e}function L(){var e=(0,s.default)(["model:msg:getContext:after fetch error"]);return L=function(){return e},e}function k(){var e=(0,s.default)(["model:msg:getContext fetch error"]);return k=function(){return e},e}function U(){var e=(0,s.default)(["model:Msg:media error ",""]);return U=function(){return e},e}function F(){var e=(0,s.default)(["model:Msg:search error ",""]);return F=function(){return e},e}function G(){var e=(0,s.default)(["model:Msg:queryVcard error 499 (unimplemented)"]);return G=function(){return e},e}function x(){var e=(0,s.default)(["model:Msg:getStarred error ",""]);return x=function(){return e},e}function B(){var e=(0,s.default)(["model:Msg:getStarred error 499 (unimplemented)"]);return B=function(){return e},e}function Y(){var e=(0,s.default)(["model:Msg:findQuery:got:",":",""]);return Y=function(){return e},e}function K(){var e=(0,s.default)(["model:Msg:findQuery error ",""]);return K=function(){return e},e}class j extends u.default{constructor(){super(),this.lastReceivedReceipt={},this.lastReceivedPaymentTransaction={},this.preAck={},this.pendingAdd={},this.ftsCache={},this.productListMessagesPrefetchChain=Promise.resolve([]),this.onSearchTag=e=>{this.pendingSearchTag=e},this.listenTo(C.default,"change:stream",(function(){C.default.stream===C.STREAM.DISCONNECTED&&(this.preAck={})})),this.listenTo(this,"remove",this.removeFromCollection)}removeFromCollection(e){e.chat&&e.chat.removeFromCollection(e)}_findQuery(e,t){var a,n=this;switch(e.direction){case"before":case"after":a=e.direction;break;default:a="before"}var i={add:a,isHistory:!0};return(0,f.msgFindQuery)(a,e,t,void 0).then((t=>t.status>=400?(__LOG__(3)(K(),t.status),Promise.reject(t.status)):(t.forEach((function(e){e.invis=!0})),__LOG__(2)(Y(),t.length,e.direction),n.processMultipleMessages(e.remote,t,i,(function(){var t=n.get(e),a=r(43334).default.get(e.remote);return t?t.msgChunk:a?a.msgs:void 0})))))}add(e,t){var r=(Array.isArray(e)?e:[e]).filter((e=>null==e.ephemeralDuration||0===e.ephemeralDuration||!new h.default(e).isExpired())),a=super.add(r,t);return this._syncTemplateButtonClickState(a),this._syncQuickReplyButtonClickState(a),this._prefetchProductListMessages(a),a}_prefetchProductListMessages(e){var t=r(90567).default;this.productListMessagesPrefetchChain=e.filter((e=>{var t,r;return null!=e&&e.isNewMsg&&e.type===l.default.MSG_TYPE.LIST&&(null===(t=e.list)||void 0===t?void 0:t.listType)===d.ListMessageListType.PRODUCT_LIST&&null!=(null===(r=e.list)||void 0===r?void 0:r.productListInfo)})).reduce(((e,r)=>{var a;if(null==r)return e;var n=r.isForwarded?r.businessOwnerJid:r.from.toString({legacy:!0}),i=null===(a=r.list)||void 0===a?void 0:a.productListInfo;if(null==n||null==i)return e;var s=t.getOrAdd(r.id,i,n);return null==s||0!==s.productCollection.getModelsArray().length||s.isFetching()?e:e.then((()=>t.update(s.id)))}),this.productListMessagesPrefetchChain)}_syncTemplateButtonClickState(e){for(var t=this,r=function(r){var a=e[r];if(!a)return"continue";var n=a.chat;if(a.type===l.default.MSG_TYPE.TEMPLATE_BUTTON_REPLY&&null!=a.selectedIndex&&a.sender.equals((0,p.getMaybeMeUser)())){null==n.msgUnsyncedButtonReplyMsgs&&(n.msgUnsyncedButtonReplyMsgs=new _.default);var{msgUnsyncedButtonReplyMsgs:i}=n,s=a.quotedMsgObj();if(!s)return"continue";var o=i.get(s.id);o||(i.add({id:s.id,unsyncedButtonReplies:new E.default}),o=i.get(s.id));var{unsyncedButtonReplies:u}=(0,g.default)(o,"buttonReplyMsg");u.add(a);var d=t.get(s.id);if(d&&d.buttons){var c=d.buttons.get("".concat((0,g.default)(a.selectedIndex,"msg.selectedIndex")));c&&(c.selected=!0),u.remove(a)}}else if(a.isFromTemplate&&a.buttons){var{msgUnsyncedButtonReplyMsgs:f}=n;if(null==f)return"continue";var h=f.get(a.id);h&&(h.unsyncedButtonReplies.forEach((e=>{var t=(0,g.default)(a.buttons,"msg.buttons").get("".concat((0,g.default)(e.selectedIndex,"replyMsg.selectedIndex")));t&&(t.selected=!0)})),h.unsyncedButtonReplies.delete())}},a=0;a<e.length;a++)r(a)}_syncQuickReplyButtonClickState(e){for(var t=this,r=function(r){var a=e[r];if(!a)return"continue";if(a.type===l.default.MSG_TYPE.BUTTONS_RESPONSE&&null!=a.selectedButtonId&&a.sender.equals((0,p.getMaybeMeUser)())){var n=a.quotedMsgObj();if(!n)return"continue";var i=t.get(n.id);if(i&&i.replyButtons){var s=i.replyButtons.get(a.selectedButtonId);s&&(s.selected=!0)}}else if(a.isDynamicReplyButtonsMsg&&a.replyButtons&&a.replyButtons.every((e=>!e.selected))&&a.chat){var o=Math.max(0,a.chat.msgs.models.length-1e3);a.chat.msgs.getModelsArray().slice(o).filter((e=>{var t;return e.type===l.default.MSG_TYPE.BUTTONS_RESPONSE&&null!=e.selectedButtonId&&e.sender.equals((0,p.getMaybeMeUser)())&&(null===(t=e.quotedMsgObj())||void 0===t?void 0:t.id.toString())===a.id.toString()})).map((({selectedButtonId:e})=>e)).forEach((e=>{var t,r=null===(t=a.replyButtons)||void 0===t?void 0:t.get(e);null!=r&&(r.selected=!0)}))}},a=0;a<e.length;a++)r(a)}getStarred(e,t,r,a){var n={count:"number"!=typeof t||isNaN(t)?l.default.PAGE_SIZE:t,chat:e||void 0,remote:r&&r.remote,id:r&&r.id,fromMe:r&&r.fromMe,participant:r&&r.participant,media:a?"gif":void 0},i={add:"search"};return(0,f.msgFindQuery)("star",n).then((e=>{var t=e.status;return e.status>=400?(499===t?__LOG__(2)(B()):__LOG__(3)(x(),t),Promise.reject(t)):this.processMultipleMessages(void 0,e,i)}))}getMessagesById(e){return(0,f.msgFindByIds)(e).then((e=>(0,o.promiseProps)({messages:this.processMultipleMessages(void 0,e,{add:"search"}),eof:!0,canceled:!1})))}queryVcard(e){return(0,f.queryVcard)(e).then((e=>499===e.status?(__LOG__(2)(G()),Promise.reject(new c.E499)):this.processMultipleMessages(void 0,e,{add:"search"})))}incrementalStarredUpdate(e){return this.processMultipleMessages(void 0,e,{add:"search"})}search(e,t=1,r,a,n={}){var i="".concat(e,"__").concat(n.label||n.kind||"");if(1!==t||a)return this._search(e,t,r,a,n.label,n.kind);var s=this.ftsCache[i];if(s)return s;var o=this._search(e,t,r,a,n.label,n.kind);this.ftsCache[i]=o;var u=()=>{this.ftsCache[i]=null};return setTimeout(u,l.default.FTS_TTL),o.catch(u),o}_search(e,t,r,a,n,i){var s={searchTerm:e,page:(0,y.isNumber)(t)&&0!==t?t:1,count:(0,y.isNumber)(r)&&0!==r?r:l.default.PAGE_SIZE,remote:a,tagToCancel:a?this.pendingSearchTag:void 0,label:n,kind:i},u={add:"search"};return(0,f.msgFindQuery)("search",s,void 0,this.onSearchTag).then((e=>{if(s.tagToCancel===this.pendingSearchTag&&(this.pendingSearchTag=void 0),499===e.status)return(0,o.promiseProps)({messages:Promise.resolve([]),eof:!1,canceled:!0});if(404===e.status)return Promise.reject(new c.E404);if(e.status>=400)return __LOG__(3)(F(),e.status),Promise.reject(e.status);var t=Array.isArray(e)?e:e.messages,r=!!Array.isArray(e)||e.eof;return(0,o.promiseProps)({messages:this.processMultipleMessages(void 0,t,u),eof:r,canceled:!1})}))}queryMedia(e,t,r,a,n){var i={remote:e,count:(0,y.isNumber)(t)&&0!==t?t:l.default.PAGE_SIZE,id:a&&a.id,fromMe:a&&a.fromMe,participant:a&&a.participant,direction:r||"before",media:n},s={add:"search"};return(0,f.msgFindQuery)("media",i).then((e=>e.status>=400?(__LOG__(3)(U(),e.status),Promise.reject(e.status)):n?this.processMultipleMessages(void 0,e,{add:"search"}):(0,o.promiseProps)({docCount:e.docCount,linkCount:e.linkCount,mediaCount:e.mediaCount,messages:this.processMultipleMessages(void 0,e.messages,s)})))}getContext(e,t,r){var a=this.get(e);if(a)return Promise.all([(0,f.msgFindQuery)("before",e,r),(0,f.msgFindQuery)("after",e,r)]).spread(((r,n)=>Array.isArray(r)&&Array.isArray(n)?(a.search=!1,Promise.all([this.processMultipleMessages(e.remote,r,{add:"before",isHistory:!0},t),this.processMultipleMessages(e.remote,n,{add:"after",isHistory:!0},t)])):(__LOG__(3)(k()),Promise.reject(r.status||n.status))));var n={add:"after",isHistory:!0};return(0,f.msgFindQuery)("after",e,r).then((r=>Array.isArray(r)?b.default.isStatusV3(r[0].id.remote)?Promise.reject("statusV3, stop querying before the msg"):this.processMultipleMessages(e.remote,r,n,t):(__LOG__(3)(L()),Promise.reject(r.status)))).then((t=>{var a=(0,g.default)(t[0],"after[0]"),n=a.id.clone();n.count=e.count+1;var i={add:"before",isHistory:!0};return Promise.all([(0,f.msgFindQuery)("before",n,r).then((t=>Array.isArray(t)?t[t.length-1].id.equals(e)?this.processMultipleMessages(e.remote,t,i,(function(){return a.msgChunk})):(__LOG__(3)(D()),Promise.reject(405)):(__LOG__(3)(N()),Promise.reject(t.status)))),Promise.resolve(t)])}))}hasSynced(){return(0,S.default)(this,l.default.COLLECTION_HAS_SYNCED)}delete(){super.delete(),this.lastReceivedReceipt={},this.lastReceivedPaymentTransaction={},this.preAck={}}getKeysForResyncReceipts(){var e=[],t=(0,i.default)((0,i.default)({},this.lastReceivedReceipt),this.lastReceivedPaymentTransaction);for(var a in t){var n=(0,A.createWid)(a),s=r(43334).default.get(n),o=void 0;if(s&&(o=s.getFirstMsgWithStatus()),o){var u=o.id;u.t=this.lastReceivedReceipt[n]||o.t||0,u.payT=this.lastReceivedPaymentTransaction[n],e.push(u)}else __LOG__(3)(R(),n.toString())}return e}resyncReceipts(){__LOG__(2)(I());var e=this.getKeysForResyncReceipts();return 0===e.length?Promise.resolve():T.default.resyncReceipts(e).then((e=>{Array.isArray(e)?(__LOG__(2)(M()),e.forEach((e=>{this.updateLastReceipt(e.id,e.t),this.updateLastTransactionTime(e.id,e.payT),e.acks.forEach((t=>{var{id:r,fromMe:a,participant:n,status:i,t:s}=t;if(null!=r&&null!=a&&null!=i){var o=new m.default({fromMe:a,remote:e.id,id:r,participant:n}),u=this.get(o);u&&(u.isEphemeral&&s?u.updateEphemeralStartTimestamp(s):u.updateAck(i))}else __LOG__(3)(w(),JSON.stringify(t))})),e.msgs.length>0&&this.processMultipleMessages(e.id,e.msgs,{update:!0,isHistory:!1}).catchType(c.LogoutDrop,(()=>{}))}))):__LOG__(3)(O())})).catchTypes3(c.LogoutDrop,c.EphemeralDrop,c.BrowserReplacedDrop,(()=>{})).catch((e=>{throw __LOG__(3)(P(),String(e),e?e.stack:"no stack"),new Error("Msg:resyncReceipts dropped")}))}updateLastReceipt(e,t){var r=this.lastReceivedReceipt[e];t&&(!r||t>r)&&(this.lastReceivedReceipt[e]=t)}updateLastTransactionTime(e,t){var r=this.lastReceivedPaymentTransaction[e];t&&(!r||t>r)&&(this.lastReceivedPaymentTransaction[e]=t)}processMultipleMessages(e,t,r,a){var n=()=>(0,v._processMultipleMessages)(e,t,r,a);if(e){var i,s=this.pendingAdd[e];return(i=s?s.then(n):n()).finally((()=>{e&&this.pendingAdd[e]===i&&(this.pendingAdd[e]=null)})).catch((()=>{})),this.pendingAdd[e]=i}return n()}markAllAsStale(){this.forEach((e=>e.unset("recvFresh")))}}t.MsgCollection=j,j.model=h.default;var W=new j;t.default=W},39035:(e,t,r)=>{"use strict";var a=r(14859),n=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.ParticipantCollection=t.MsgInfoParticipant=void 0;var i=n(r(61247)),s=a(r(95847)),o=a(r(7470)),u=a(r(74460)),l=a(r(77865)),d=a(r(68384));class c extends i.default{constructor(...e){super(...e),this.id=(0,i.prop)(),this.t=(0,i.prop)(),this.contact=(0,i.session)()}initialize(){super.initialize(),this.addChild("contact",o.default.gadd(this.id))}}c.Proxy="msgInfoParticipant",c.idClass=d.default;var f=(0,i.defineModel)(c);t.MsgInfoParticipant=f;class p extends s.default{}t.ParticipantCollection=p,p.model=f,p.comparator=(e,t)=>(0,u.default)(e.contact,t.contact);class h extends i.default{constructor(...e){super(...e),this.id=(0,i.prop)(),this.usePlayReceipt=(0,i.prop)(),this.playedRemaining=(0,i.prop)(0),this.readRemaining=(0,i.prop)(0),this.deliveryRemaining=(0,i.prop)(0),this.played=(0,i.collection)(p),this.read=(0,i.collection)(p),this.delivery=(0,i.collection)(p),this.settled=(0,i.derived)(this._settled,["usePlayReceipt","playedRemaining","readRemaining"])}_settled(){return this.usePlayReceipt?!this.playedRemaining:!this.readRemaining}getCollection(){return r(92313).default}}h.Proxy="msgInfo",h.idClass=l.default;var _=(0,i.defineModel)(h);t.default=_},92313:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.MsgInfoCollection=void 0;var i=n(r(54019)),s=n(r(39035)),o=r(62885),u=r(22952),l=n(r(77865)),d=a(r(12767));class c extends i.default{_initializeStaleCollection(){this.listenTo(d.default,"change:stream",(()=>{d.default.stream===d.STREAM.DISCONNECTED&&this.forEach((e=>{e.settled||e.set("stale",!0)}))}))}_find(e){var t=r(58885).default.get(e);return t?t.isSentByMe?(0,o.sendQueryMsgInfo)(t):Promise.reject("message not sent by me"):Promise.reject("No message found for id: ".concat(e))}updateInfo(e,t,r,a,n,i){var s=new l.default({from:t,to:r,id:e,participant:n}),o=new l.default({from:t,to:r,id:e}),d=this.get(s)||this.get(o);if(d)return(0,u.updateMsgInfo)(d,a,n,i)}}t.MsgInfoCollection=c,c.model=s.default,c.staleCollection=!0;var f=new c;t.default=f},84962:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.createDeviceSentMessage=function(e,t){return{deviceSentMessage:{destinationJid:t.toString({legacy:!0}),message:e}}},t.populateMessageContextInfo=function(e,t,r){if(!t&&!r)return;e.messageContextInfo={deviceListMetadata:{senderKeyHash:null==t?void 0:t.keyHash,senderTimestamp:null==t?void 0:t.timestamp,recipientKeyHash:null==r?void 0:r.keyHash,recipientTimestamp:null==r?void 0:r.timestamp}}},t.createViewOnceFutureProofMessage=g,t.createMsgProtobuf=function(e,t){var r,a=function(e){var t=e.id,r=e.toJSON();delete r.status,delete r.mimetype,delete r.height,delete r.width,delete r.recipients,delete r.chat,delete r.broadcast,delete r.ack,delete r.invis,delete r.filehash,delete r.recvFresh,delete r.mediaData,d.default.isHttp(e.clientUrl)||delete r.clientUrl;d.default.isHttp(e.deprecatedMms3Url)||delete r.deprecatedMms3Url;for(var a in r)null==r[a]&&delete r[a];var n=s.default.get(t.remote);n&&(r.conversionTuple=n.serialize());return r}(e);if(a.quotedMsg){var n=a.quotedMsg.mentionedJidList,i=Array.isArray(n)&&n.length>0?{mentionedJid:n.map(E)}:void 0;r={stanzaId:a.quotedStanzaID,remoteJid:E(a.quotedRemoteJid),participant:E(a.quotedParticipant),quotedMessage:v(a.quotedMsg,{duration:a.quotedMsg.duration,directPath:a.quotedMsg.directPath,encFilehash:a.quotedMsg.encFilehash,filehash:a.quotedMsg.filehash,height:a.quotedMsg.height,mediaKey:a.quotedMsg.mediaKey,mediaKeyTimestamp:(0,l.isNumber)(a.quotedMsg.mediaKeyTimestamp)?a.quotedMsg.mediaKeyTimestamp:void 0,mimetype:a.quotedMsg.mimetype,url:a.quotedMsg.clientUrl||a.quotedMsg.deprecatedMms3Url,width:a.quotedMsg.width},i)}}else a.quotedRemoteJid&&(r={remoteJid:E(a.quotedRemoteJid)});if(a.mentionedJidList&&a.mentionedJidList.length>0){var o=a.mentionedJidList;(r=r||{}).mentionedJid=o.map(E)}a.conversionTuple&&(r=r||{},Object.assign(r,a.conversionTuple));a.isForwarded&&((r=r||{}).isForwarded=a.isForwarded);a.forwardingScore&&((r=r||{}).forwardingScore=a.forwardingScore);a.ephemeralDuration&&((r=r||{}).expiration=a.ephemeralDuration);a.ephemeralSettingTimestamp&&((r=r||{}).ephemeralSettingTimestamp=a.ephemeralSettingTimestamp);a.ctwaContext&&((r=r||{}).externalAdReply={sourceUrl:a.ctwaContext.sourceUrl,sourceId:a.ctwaContext.sourceId,sourceType:a.ctwaContext.sourceType,body:a.ctwaContext.description,title:a.ctwaContext.title,thumbnailUrl:a.ctwaContext.thumbnailUrl,thumbnail:a.ctwaContext.thumbnail?y(a.ctwaContext.thumbnail):void 0,mediaType:a.ctwaContext.mediaType,mediaUrl:a.ctwaContext.mediaUrl});return v(a,t,r)},t.createMessageKey=function(e){return{remoteJid:E(e.to),fromMe:!0,id:e.id.id}};var n=a(r(19976)),i=r(60339),s=a(r(19744)),o=r(28703),u=a(r(18120)),l=r(11419),d=a(r(74185)),c=a(r(68384));function f(){var e=(0,n.default)(["url(deprecatedMms3Url) missing from msg type ",""]);return f=function(){return e},e}function p(){var e=(0,n.default)(["fileEncSha256 missing from msg type ",""]);return p=function(){return e},e}function h(){var e=(0,n.default)(["fileSha256 missing from msg type ",""]);return h=function(){return e},e}function _(){var e=(0,n.default)(["directPath missing from msg type ",""]);return _=function(){return e},e}function m(){var e=(0,n.default)(["invalid sticker mimetype: ",""]);return m=function(){return e},e}function g(e){return{viewOnceMessage:{message:e}}}function v(e,t={},r,a){var n=a||{},i=e.mimetype||t.mimetype||void 0,s=t.duration;switch(e.type){case"chat":"url"===e.subtype||e.quotedMsg||e.quotedRemoteJid||Array.isArray(e.mentionedJidList)&&e.mentionedJidList.length>0||e.conversionTuple||e.isForwarded||e.forwardingScore||e._isPaymentNoteMsg||e.ephemeralDuration||e.ephemeralSettingTimestamp||e.ctwaContext?n.extendedTextMessage={text:e.body,matchedText:e.matchedText,canonicalUrl:e.canonicalUrl,description:e.description,title:e.title,jpegThumbnail:y(e.thumbnail),previewType:e.richPreviewType,contextInfo:r}:n.conversation=e.body;break;case"groups_v4_invite":n.groupInviteMessage={inviteCode:e.inviteCode,inviteExpiration:parseInt(e.inviteCodeExp,10),groupJid:e.inviteGrp,groupName:e.inviteGrpName,caption:e.comment,jpegThumbnail:y(e.inviteGrpJpegThum)};break;case"sticker":if("image/webp"!==t.mimetype)throw __LOG__(3)(m(),t.mimetype),new Error("invalid sticker mimetype");n.stickerMessage={url:t.url,mimetype:t.mimetype,directPath:t.directPath||void 0,fileSha256:y(t.filehash),fileEncSha256:y(t.encFilehash),mediaKey:y(t.mediaKey),mediaKeyTimestamp:(0,l.isNumber)(t.mediaKeyTimestamp)?t.mediaKeyTimestamp:void 0,fileLength:(0,l.isNumber)(e.size)?e.size:void 0,height:e.height,width:e.width,firstFrameLength:t.firstFrameLength||void 0,firstFrameSidecar:e.firstFrameSidecar||void 0,isAnimated:t.isAnimated,contextInfo:r},S(e.type,n.stickerMessage);break;case"location":var u={degreesLatitude:parseFloat(e.lat)||void 0,degreesLongitude:parseFloat(e.lng)||void 0,jpegThumbnail:y(e.body),contextInfo:r};if(e.loc&&(0,l.isString)(e.loc)){var d=e.loc.split("\n");u.name=d[0],u.address=d[1],u.url=e.clientUrl}n.locationMessage=u;break;case"vcard":n.contactMessage={displayName:e.vcardFormattedName,vcard:e.body,contextInfo:r};break;case"multi_vcard":n.contactsArrayMessage={displayName:e.subtype,contacts:e.vcardList.map((e=>e)),contextInfo:r};break;case"image":n.imageMessage={url:t.url,mimetype:i,caption:e.caption,directPath:t.directPath||void 0,fileSha256:y(t.filehash),fileEncSha256:y(t.encFilehash),height:t.height,width:t.width,fileLength:(0,l.isNumber)(e.size)?e.size:void 0,mediaKey:y(t.mediaKey),mediaKeyTimestamp:(0,l.isNumber)(t.mediaKeyTimestamp)?t.mediaKeyTimestamp:void 0,jpegThumbnail:e.isViewOnce?void 0:y(e.body),contextInfo:r,viewOnce:e.isViewOnce},S(e.type,n.imageMessage);break;case"product":n.productMessage={product:{productImage:{url:t.url,mimetype:i,caption:e.caption,directPath:t.directPath||void 0,fileSha256:y(t.filehash),fileEncSha256:y(t.encFilehash),height:t.height,width:t.width,fileLength:(0,l.isNumber)(e.size)?e.size:void 0,mediaKey:y(t.mediaKey),mediaKeyTimestamp:(0,l.isNumber)(t.mediaKeyTimestamp)?t.mediaKeyTimestamp:void 0,jpegThumbnail:y(e.body)},productId:e.productId,title:e.title,description:e.description,currencyCode:e.currencyCode,priceAmount1000:e.priceAmount1000||void 0,salePriceAmount1000:e.salePriceAmount1000||void 0,retailerId:e.retailerId,url:e.url,productImageCount:e.productImageCount},businessOwnerJid:e.businessOwnerJid,contextInfo:r};break;case"document":var c={url:t.url,mimetype:i,title:e.caption,directPath:t.directPath||void 0,fileSha256:y(t.filehash),fileEncSha256:y(t.encFilehash),fileName:t.filename,fileLength:(0,l.isNumber)(e.size)?e.size:void 0,mediaKey:y(t.mediaKey),mediaKeyTimestamp:(0,l.isNumber)(t.mediaKeyTimestamp)?t.mediaKeyTimestamp:void 0,jpegThumbnail:y(e.body),contextInfo:r,contactVcard:e.isVcardOverMmsDocument,thumbnailDirectPath:t.thumbnailDirectPath,thumbnailSha256:y(t.thumbnailSha256),thumbnailEncSha256:y(t.thumbnailEncSha256),thumbnailHeight:t.thumbnailHeight,thumbnailWidth:t.thumbnailWidth};(0,l.isNumber)(e.pageCount)&&!isNaN(e.pageCount)&&(c.pageCount=e.pageCount),n.documentMessage=c;break;case"ptt":case"audio":s=(0,l.isString)(s)?parseInt(s,10):s,n.audioMessage={url:t.url,mimetype:i,directPath:t.directPath||void 0,fileSha256:y(t.filehash),fileEncSha256:y(t.encFilehash),seconds:s,ptt:"ptt"===e.type,fileLength:(0,l.isNumber)(e.size)?e.size:void 0,mediaKey:y(t.mediaKey),mediaKeyTimestamp:(0,l.isNumber)(t.mediaKeyTimestamp)?t.mediaKeyTimestamp:void 0,contextInfo:r,streamingSidecar:e.streamingSidecar},S(e.type?"ptt":"audio",n.audioMessage);break;case"video":s=(0,l.isString)(s)?parseInt(s,10):s,n.videoMessage={url:t.url,mimetype:i,directPath:t.directPath||void 0,fileSha256:y(t.filehash),fileEncSha256:y(t.encFilehash),height:t.height,width:t.width,seconds:s,caption:e.caption,fileLength:(0,l.isNumber)(e.size)?e.size:void 0,mediaKey:y(t.mediaKey),mediaKeyTimestamp:(0,l.isNumber)(t.mediaKeyTimestamp)?t.mediaKeyTimestamp:void 0,jpegThumbnail:e.isViewOnce?void 0:y(e.body),gifPlayback:e.isGif,gifAttribution:e.gifAttribution,contextInfo:r,streamingSidecar:e.streamingSidecar,viewOnce:e.isViewOnce},S(e.type,n.videoMessage);break;case"protocol":var f;switch(e.subtype){case"revoke":var p=e.protocolMessageKey;f={key:{remoteJid:E(p.remote),fromMe:p.fromMe,id:p.id,participant:E(p.participant)},type:o.ProtocolMessageType.REVOKE};break;case"ephemeral_setting":f={type:o.ProtocolMessageType.EPHEMERAL_SETTING,ephemeralExpiration:e.ephemeralDuration};break;case"ephemeral_sync_response":f={type:o.ProtocolMessageType.EPHEMERAL_SYNC_RESPONSE,ephemeralExpiration:e.ephemeralDuration,ephemeralSettingTimestamp:e.ephemeralSettingTimestamp};break;case"app_state_sync_key_share":f={type:o.ProtocolMessageType.APP_STATE_SYNC_KEY_SHARE,appStateSyncKeyShare:e.appStateSyncKeyShare};break;case"app_state_sync_key_request":f={type:o.ProtocolMessageType.APP_STATE_SYNC_KEY_REQUEST,appStateSyncKeyRequest:e.appStateSyncKeyRequest};break;case"app_state_fatal_exception_notification":f={type:o.ProtocolMessageType.APP_STATE_FATAL_EXCEPTION_NOTIFICATION,appStateFatalExceptionNotification:e.appStateFatalExceptionNotification}}f&&(n.protocolMessage=f);break;case"payment":var h={};h.stanzaId=e.quotedStanzaID,h.mentionedJid=e.mentionedJidList&&e.mentionedJidList.map(E),h.isForwarded=e.isForwarded,h.forwardingScore=e.forwardingScore,h.participant=E(e.quotedParticipant),e.quotedMsg&&(h.quotedMessage=v(e.quotedMsg));var _=e.paymentNoteMsg?v(Object.assign(e.paymentNoteMsg,{_isPaymentNoteMsg:!0}),h):void 0;switch(e.subtype){case"send":var T=e.paymentRequestMessageKey?{fromMe:e.paymentRequestMessageKey.fromMe,remoteJid:E(e.paymentRequestMessageKey.remote),id:e.paymentRequestMessageKey.id,participant:E(e.paymentRequestMessageKey.participant)}:void 0;n.sendPaymentMessage={requestMessageKey:T,noteMessage:_};break;case"request":n.requestPaymentMessage={amount1000:e.amount1000,expiryTimestamp:e._paymentExpiryTimestamp,requestFrom:e._paymentRequestFrom,currencyCodeIso4217:e._currencyCodeIso4217,noteMessage:_}}break;case"template_button_reply":n.templateButtonReplyMessage={selectedId:e.selectedId,selectedIndex:e.selectedIndex,selectedDisplayText:e.body,contextInfo:r};break;case"template":return"text"===e.subtype?(e.type="chat",e.title&&(e.body="*"+e.title+"*\n"+e.body)):e.type=e.subtype,v(e,t,r,n);case"list":n.listMessage=e.list,n.listMessage.contextInfo=r;break;case"list_response":n.listResponseMessage=e.listResponse,n.listResponseMessage.contextInfo=r;break;case"buttons_response":n.buttonsResponseMessage=e.buttonsResponse,n.buttonsResponseMessage.contextInfo=r;break;case"order":e.itemCount||e.message||e.orderId||e.orderTitle||e.sellerJid||e.status||e.surface||e.thumbnail||e.token||e.totalAmount1000||e.totalCurrencyCode?n.orderMessage={itemCount:e.itemCount,message:e.message,orderId:e.orderId,orderTitle:e.orderTitle,sellerJid:e.sellerJid,status:e.status,surface:e.surface,thumbnail:y(e.thumbnail),token:e.token,totalAmount1000:e.totalAmount1000,totalCurrencyCode:e.totalCurrencyCode}:n.conversation=e.body}return!0===e.isDynamicReplyButtonsMsg&&(n=function(e,t,r){var{documentMessage:a,imageMessage:n,locationMessage:i,videoMessage:s}=e;if(t.isForwarded&&(a||n||i||s))return e;var u={buttons:!0===t.isForwarded?void 0:t.dynamicReplyButtons,footerText:t.footer,contextInfo:r};return a?(u.documentMessage=a,u.headerType=o.ButtonsMessageHeaderType.DOCUMENT,u.contentText=t.caption):n?(u.imageMessage=n,u.headerType=o.ButtonsMessageHeaderType.IMAGE,u.contentText=t.caption):i?(u.locationMessage=i,u.headerType=o.ButtonsMessageHeaderType.LOCATION,u.contentText=t.caption):s?(u.videoMessage=s,u.headerType=o.ButtonsMessageHeaderType.VIDEO,u.contentText=t.caption):t.title?(u.text=t.title,u.headerType=o.ButtonsMessageHeaderType.TEXT,u.contentText=t.body):(u.contentText=t.body,u.headerType=o.ButtonsMessageHeaderType.EMPTY),{buttonsMessage:u}}(n,e,r)),e.isViewOnce&&(n=g(n)),n}function E(e){return e instanceof c.default?e.toString({legacy:!0}):(0,l.isString)(e)?e.replace(/@c.us$/,"@s.whatsapp.net"):void 0}function y(e){return e?(0,i.decodeB64)(e):void 0}function S(e,t){u.default.supportsFeature(u.default.F.LOG_MISSING_REQUIRED_PROPERTIES)&&(t.viewOnce||(null==t.directPath&&(__LOG__(2,void 0,void 0,!0)(_(),e),SEND_LOGS("outgoing-media-message-missing-direct-path")),null==t.fileSha256&&(__LOG__(2,void 0,void 0,!0)(h(),e),SEND_LOGS("outgoing-media-message-missing-file-sha")),null==t.fileEncSha256&&(__LOG__(2,void 0,void 0,!0)(p(),e),SEND_LOGS("outgoing-media-message-missing-file-enc-sha")),null==t.url&&(__LOG__(2,void 0,void 0,!0)(f(),e),SEND_LOGS("outgoing-media-message-missing-mms3-url"))))}},69338:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.convertToTextWithoutSpecialEmojis=G,t.default=void 0;var i=n(r(70417)),s=n(r(19976)),o=n(r(30733)),u=r(60339),l=r(46194),d=n(r(19899)),c=a(r(52737)),f=n(r(50935)),p=r(28703),h=n(r(12396)),_=n(r(18120)),m=r(75459),g=r(11824),v=a(r(90088)),E=n(r(77865)),y=n(r(82626)),S=n(r(72424)),T=r(11419),b=n(r(74185)),A=n(r(68384)),C=r(75637);function P(){var e=(0,s.default)(["mediaKey is missing from msg type ",""]);return P=function(){return e},e}function O(){var e=(0,s.default)(["url(deprecatedMms3Url) is missing from msg type ",""]);return O=function(){return e},e}function w(){var e=(0,s.default)(["fileEncSha256 missing from msg type ",""]);return w=function(){return e},e}function M(){var e=(0,s.default)(["directPath missing from msg type ",""]);return M=function(){return e},e}function I(){var e=(0,s.default)(["directPath and fileEncSha256 missing from msg type ",""]);return I=function(){return e},e}function R(){var e=(0,s.default)(["parseGroupInviteMessageProto: not supported"]);return R=function(){return e},e}function D(){var e=(0,s.default)(["parseRequestPaymentMessageProto: not supported"]);return D=function(){return e},e}function N(){var e=(0,s.default)(["parseSendPaymentMessageProto: not supported"]);return N=function(){return e},e}function L(){var e=(0,s.default)(["parseLiveLocationMessageProto: not supported"]);return L=function(){return e},e}function k(){var e=(0,s.default)(["parseContextInfoProto: payment not supported"]);return k=function(){return e},e}function U(){var e=(0,s.default)(["drop: not Message"]);return U=function(){return e},e}var F=(0,o.default)((function(e){if((0,g.isConnectedToPage)())return b.default.hostname(e);if(!e)return"";var t=b.default.isHttp(e)?e:"http://"+e;return new self.URL(t).hostname}));function G(e){return e?c.default.platform===c.PLATFORMS.ANDROID?e:h.default.convertToTextWithoutSpecialEmojis(e):e}function x(e,t){var r;_.default.supportsFeature(_.default.F.LOG_MISSING_REQUIRED_PROPERTIES)&&e.id&&("status"===(null===(r=e.id.remote)||void 0===r?void 0:r.user)&&A.default.isPSA(e.author)||e.id.fromMe||(null==t.directPath&&null==t.fileEncSha256?(__LOG__(2,void 0,void 0,!0)(I(),e.type),SEND_LOGS("media-message-missing-direct-path-and-file-enc")):null==t.directPath?(__LOG__(2,void 0,void 0,!0)(M(),e.type),SEND_LOGS("media-message-missing-direct-path")):null==t.fileEncSha256&&(__LOG__(2,void 0,void 0,!0)(w(),e.type),SEND_LOGS("media-message-missing-file-enc")),null==t.url&&(__LOG__(2,void 0,void 0,!0)(O(),e.type),SEND_LOGS("media-message-missing-mms3-url")),null==t.mediaKey&&(__LOG__(2,void 0,void 0,!0)(P(),e.type),SEND_LOGS("media-message-missing-media-key"))))}var B={parseMsgProto:function(e,t,r,a,n,i){if(!e)return __LOG__(4,void 0,new Error,!0)(U()),SEND_LOGS("null-message"),t;var{conversation:s,imageMessage:o,contactMessage:u,locationMessage:l,liveLocationMessage:d,extendedTextMessage:c,documentMessage:p,audioMessage:h,videoMessage:m,stickerMessage:g,contactsArrayMessage:v,protocolMessage:E,sendPaymentMessage:y,requestPaymentMessage:b,productMessage:A,groupInviteMessage:C,viewOnceMessage:P,ephemeralMessage:O,templateMessage:w,templateButtonReplyMessage:M,orderMessage:I,listMessage:R,listResponseMessage:D,buttonsResponseMessage:N,buttonsMessage:L}=e,k=void 0;if((0,T.isString)(s)&&this.parseConversationProto(t,s),C&&this.parseGroupInviteMessageProto(t,C),o&&(this.parseImageMessageProto(t,o),k=o.contextInfo),g&&(this.parseStickerMessageProto(t,g),k=g.contextInfo),u&&(this.parseContactMessageProto(t,u),k=u.contextInfo),v&&(this.parseContactsArrayMessageProto(t,v),k=v.contextInfo),l&&(this.parseLocationMessageProto(t,l),k=l.contextInfo),d&&(this.parseLiveLocationMessageProto(t,d,n),k=d.contextInfo),y&&(k=y&&y.noteMessage&&y.noteMessage.extendedTextMessage&&y.noteMessage.extendedTextMessage.contextInfo,this.parseSendPaymentMessageProto(t,y,a)),b&&(k=b&&b.noteMessage&&b.noteMessage.extendedTextMessage&&b.noteMessage.extendedTextMessage.contextInfo,this.parseRequestPaymentMessageProto(t,b,a)),c&&(this.parseExtendedTextMessageProto(t,c),k=c.contextInfo),p&&(this.parseDocumentMessageProto(t,p),k=p.contextInfo),h&&(this.parseAudioMessageProto(t,h),k=h.contextInfo),m&&(this.parseVideoMessageProto(t,m),k=m.contextInfo),E&&this.parseProtocolMessageProto(t,E,r),A&&(this.parseProductMessageProto(t,A),k=A.contextInfo),C&&this.parseGroupInviteMessageProto(t,C),I&&(this.parseOrderMessageProto(t,I),k=I.contextInfo),R&&this.parseListMessageProto(t,R),D&&(this.parseListResponseMessageProto(t,D),k=D.contextInfo),P&&this.parseViewOnceFutureProofMessageProto(t,P),O&&this.parseEphemeralFutureProofMessageProto(t,O),L&&this.parseButtonsMessageProto(t,L),N&&(this.parseButtonsResponseMessageProto(t,N),k=N.contextInfo),_.default.supportsFeature(_.default.F.MD_BACKEND)){var{deviceSentMessage:F,highlyStructuredMessage:x}=e;F&&this.parseDeviceSentMessage(t,F,r),x&&(t.type=f.default.MSG_TYPE.HSM,x.hydratedHsm&&x.hydratedHsm.hydratedTemplate&&(t.body=G(x.hydratedHsm.hydratedTemplate.hydratedContentText)))}return w&&(_.default.supportsFeature(_.default.F.MD_BACKEND)&&w.hydratedTemplate?this.parseTemplateMessage(t,w.hydratedTemplate):this.parseTemplateMessage(t,w.hydratedFourRowTemplate)),M&&(this.parseTemplateButtonReplyMessage(t,M),k=M.contextInfo,t.type=f.default.MSG_TYPE.TEMPLATE_BUTTON_REPLY),k&&(this.parseContextInfoProto(t,k,i),k.externalAdReply&&S.default.ctwaContextRender&&this.parseCtwaContextProto(t,k.externalAdReply)),t},parseConversationProto:function(e,t){e.type=f.default.MSG_TYPE.CHAT,e.body=G(t)},parseImageMessageProto:function(e,t){e.type=f.default.MSG_TYPE.IMAGE,e.deprecatedMms3Url=this.decodeUrl(t.url),e.directPath=t.directPath||"",e.mimetype=t.mimetype||"",e.caption=G(t.caption),e.filehash=this.decodeBytes(t.fileSha256),e.encFilehash=this.decodeBytes(t.fileEncSha256),e.size=t.fileLength||0,e.height=t.height||0,e.width=t.width||0,e.mediaKey=this.decodeBytes(t.mediaKey),e.mediaKeyTimestamp=null!=t.mediaKeyTimestamp?t.mediaKeyTimestamp:d.default.globalUnixTime(),e.body=this.decodeBytes(t.jpegThumbnail)||"",e.interactiveAnnotations=t.interactiveAnnotations,e.scanLengths=t.scanLengths,e.scansSidecar=t.scansSidecar,e.isViewOnce=!0===t.viewOnce,e.thumbnailDirectPath=t.thumbnailDirectPath,e.thumbnailSha256=this.decodeBytes(t.thumbnailSha256),e.thumbnailEncSha256=this.decodeBytes(t.thumbnailEncSha256),x(e,t)},parseStickerMessageProto:function(e,t){e.type=f.default.MSG_TYPE.STICKER,e.deprecatedMms3Url=this.decodeUrl(t.url),e.directPath=t.directPath||"",e.mimetype=t.mimetype||"",e.filehash=this.decodeBytes(t.fileSha256),e.encFilehash=this.decodeBytes(t.fileEncSha256),e.mediaKey=(0,y.default)(this.decodeBytes(t.mediaKey)),e.mediaKeyTimestamp=null!=t.mediaKeyTimestamp?t.mediaKeyTimestamp:d.default.globalUnixTime(),e.height=t.height||0,e.width=t.width||0,e.firstFrameLength=t.firstFrameLength,e.firstFrameSidecar=t.firstFrameSidecar,e.isAnimated=t.isAnimated,x(e,t)},parseContactMessageProto:function(e,t){e.type=f.default.MSG_TYPE.VCARD,e.vcardFormattedName=t.displayName,e.body=t.vcard},parseContactsArrayMessageProto:function(e,t){var r=t.contacts;e.type=f.default.MSG_TYPE.MULTI_VCARD,e.vcardFormattedName=t.displayName,e.vcardList=Array.isArray(r)?r.map((e=>({displayName:e.displayName,vcard:e.vcard}))):[]},parseLocationMessageProto:function(e,t){var r=t.name&&t.address?"".concat(t.name,"\n").concat(t.address):t.name||t.address||"";e.type=f.default.MSG_TYPE.LOCATION,e.lat=void 0!==t.degreesLatitude?t.degreesLatitude:void 0,e.lng=void 0!==t.degreesLongitude?t.degreesLongitude:void 0,e.loc=r,e.body=this.decodeBytes(t.jpegThumbnail)||"",e.clientUrl=t.url},parseExtendedTextMessageProto:function(e,t){var r=t.matchedText||t.canonicalUrl||t.description||t.title;if(r){var a=F(t.canonicalUrl||""),n=F(t.matchedText||"");e.canonicalUrl=a===n||""===a?t.canonicalUrl:n}e.type=f.default.MSG_TYPE.CHAT,e.subtype=r?"url":void 0,e.body=G(t.text||""),e.matchedText=t.matchedText,e.description=t.description,e.title=t.title,e.thumbnail=this.decodeBytes(t.jpegThumbnail)||"",e.richPreviewType=t.previewType,e.doNotPlayInline=t.doNotPlayInline,e.textColor=t.textArgb,e.backgroundColor=t.backgroundArgb;var i=p.ExtendedTextMessageFontType;if(null!=t.font)switch(t.font){case i.SANS_SERIF:case i.SERIF:case i.NORICAN_REGULAR:case i.BRYNDAN_WRITE:case i.BEBASNEUE_REGULAR:case i.OSWALD_HEAVY:e.font=t.font}},parseDocumentMessageProto:function(e,t){e.type=f.default.MSG_TYPE.DOCUMENT,e.deprecatedMms3Url=this.decodeUrl(t.url),e.directPath=t.directPath,e.mimetype=t.mimetype,e.filehash=this.decodeBytes(t.fileSha256),e.encFilehash=this.decodeBytes(t.fileEncSha256),e.size=t.fileLength||0,e.pageCount=t.pageCount||0,e.mediaKey=this.decodeBytes(t.mediaKey),e.mediaKeyTimestamp=null!=t.mediaKeyTimestamp?t.mediaKeyTimestamp:d.default.globalUnixTime(),e.filename=(0,l.cleanIncomingFilename)(t.fileName||t.title),e.caption=e.filename,e.body=this.decodeBytes(t.jpegThumbnail)||"",e.isVcardOverMmsDocument=Boolean(t.contactVcard)&&e.size<=1024*S.default.vcardMaxSizeKb,e.thumbnailDirectPath=t.thumbnailDirectPath,e.thumbnailSha256=this.decodeBytes(t.thumbnailSha256),e.thumbnailEncSha256=this.decodeBytes(t.thumbnailEncSha256),e.thumbnailHeight=t.thumbnailHeight,e.thumbnailWidth=t.thumbnailWidth},parseAudioMessageProto:function(e,t){e.type=t.ptt?f.default.MSG_TYPE.PTT:f.default.MSG_TYPE.AUDIO,e.deprecatedMms3Url=this.decodeUrl(t.url),e.directPath=t.directPath,e.mimetype=t.mimetype,e.filehash=this.decodeBytes(t.fileSha256),e.encFilehash=this.decodeBytes(t.fileEncSha256),e.size=t.fileLength||0,e.duration="".concat(t.seconds||0),e.mediaKey=this.decodeBytes(t.mediaKey),e.mediaKeyTimestamp=null!=t.mediaKeyTimestamp?t.mediaKeyTimestamp:d.default.globalUnixTime(),e.streamingSidecar=t.streamingSidecar,x(e,t)},parseVideoMessageProto:function(e,t){e.type=f.default.MSG_TYPE.VIDEO,e.deprecatedMms3Url=this.decodeUrl(t.url),e.directPath=t.directPath,e.mimetype=t.mimetype,e.filehash=this.decodeBytes(t.fileSha256),e.encFilehash=this.decodeBytes(t.fileEncSha256),e.size=t.fileLength||0,e.height=t.height,e.width=t.width,e.duration="".concat(t.seconds||0),e.mediaKey=this.decodeBytes(t.mediaKey),e.mediaKeyTimestamp=null!=t.mediaKeyTimestamp?t.mediaKeyTimestamp:d.default.globalUnixTime(),e.caption=G(t.caption),e.body=this.decodeBytes(t.jpegThumbnail)||"",e.isGif=t.gifPlayback,e.gifAttribution=t.gifAttribution,e.streamingSidecar=t.streamingSidecar,e.interactiveAnnotations=t.interactiveAnnotations,e.isViewOnce=!0===t.viewOnce,e.thumbnailDirectPath=t.thumbnailDirectPath,e.thumbnailSha256=this.decodeBytes(t.thumbnailSha256),e.thumbnailEncSha256=this.decodeBytes(t.thumbnailEncSha256),x(e,t)},parseContextInfoProto:function(e,t,r){var a=t.quotedMessage,n=t.mentionedJid;e.quotedMsg=a&&this.parseMsgProto(a,{type:f.default.MSG_TYPE.UNKNOWN}),e.quotedMsg&&"payment"===e.quotedMsg.type&&r&&__LOG__(2)(k()),e.quotedStanzaID=t.stanzaId,e.quotedParticipant=this.decodeJid(t.participant),e.quotedRemoteJid=this.decodeJid(t.remoteJid),e.mentionedJidList=Array.isArray(n)?n.map(this.decodeJid):n,e.isForwarded=t.isForwarded,e.forwardingScore=t.forwardingScore,null!=t.expiration&&(e.ephemeralDuration=t.expiration),null!=t.ephemeralSettingTimestamp&&(e.ephemeralSettingTimestamp=t.ephemeralSettingTimestamp),null!=t.ephemeralSharedSecret&&(e.ephemeralSharedSecret=t.ephemeralSharedSecret)},parseCtwaContextProto:function(e,t){var r=v.findLink(t.sourceUrl||"",!1,e.from);e.ctwaContext={sourceUrl:t.sourceUrl,description:t.body,title:t.title,thumbnail:t.thumbnail?this.decodeBytes(t.thumbnail):null,thumbnailUrl:t.thumbnailUrl,mediaType:t.mediaType,mediaUrl:t.mediaUrl,isSuspiciousLink:r&&r.suspiciousCharacters&&r.suspiciousCharacters.size>0}},_getMsgKey:function(e,t){if(!e)throw new Error("parseProtocolMessageProto: no message key is defined for protocol message");var{id:r}=e;if(!r)throw new Error("parseProtocolMessageProto: no message id is defined for protocol message");return _.default.supportsFeature(_.default.F.MD_BACKEND)?new E.default({id:r,fromMe:t.id.fromMe,remote:t.id.remote,participant:t.id.participant}):new E.default({id:r,fromMe:e.fromMe,remote:this.decodeJid(e.remoteJid),participant:this.decodeJid(e.participant)})},parseProtocolMessageProto:function(e,t,r){if("relay"===r||t.type===p.ProtocolMessageType.EPHEMERAL_SETTING){var{key:a,type:n}=t,i=null;if(e.type=f.default.MSG_TYPE.PROTOCOL,null!=n)switch(n){case p.ProtocolMessageType.REVOKE:i=this._getMsgKey(a,e),e.protocolMessageKey=i,e.subtype="revoke";break;case p.ProtocolMessageType.EPHEMERAL_SETTING:e.subtype="ephemeral_setting",e.ephemeralDuration=t.ephemeralExpiration;break;case p.ProtocolMessageType.EPHEMERAL_SYNC_RESPONSE:e.subtype="ephemeral_sync_response",e.ephemeralDuration=t.ephemeralExpiration,e.ephemeralSettingTimestamp=t.ephemeralSettingTimestamp;break;case p.ProtocolMessageType.HISTORY_SYNC_NOTIFICATION:e.subtype="history_sync_notification";var{historySyncNotification:s}=t;if(s){var o={directPath:s.directPath,encFilehash:this.decodeBytes(s.fileEncSha256),filehash:this.decodeBytes(s.fileSha256),mediaKey:this.decodeBytes(s.mediaKey),type:"md-msg-hist"};e.historySyncMetaData={historySyncNotification:t.historySyncNotification,downloadOptions:o}}break;case p.ProtocolMessageType.APP_STATE_SYNC_KEY_REQUEST:case p.ProtocolMessageType.APP_STATE_SYNC_KEY_SHARE:case p.ProtocolMessageType.MSG_FANOUT_BACKFILL_REQUEST:case p.ProtocolMessageType.INITIAL_SECURITY_NOTIFICATION_SETTING_SYNC:case p.ProtocolMessageType.APP_STATE_FATAL_EXCEPTION_NOTIFICATION:e.subtype="unknown"}}},decodeJid:function(e){return A.default.isWid(e)?(0,C.createWid)(e):e},decodeUrl:function(e){return e&&!e.includes("/u/")?e:void 0},decodeBytes:function(e){return e?(0,u.encodeB64)(e):void 0},parseDeviceSentMessage:function(e,t,r){var a=this.decodeJid(t.destinationJid);e.id.remote=a,e.to=a,this.parseMsgProto(t.message,e,r)},parseTemplateMessage:function(e,t){var{documentMessage:r,imageMessage:a,locationMessage:n,videoMessage:i}=t;e.isFromTemplate=!0,r?this.parseDocumentMessageProto(e,r):a?this.parseImageMessageProto(e,a):n?this.parseLocationMessageProto(e,n):i?this.parseVideoMessageProto(e,i):(e.type=f.default.MSG_TYPE.CHAT,t.hydratedContentText&&(e.body=G(t.hydratedContentText))),t.hydratedButtons&&this.parseButtons(e,t),t.hydratedContentText&&(e.caption=G(t.hydratedContentText)),t.hydratedFooterText&&(e.footer=G(t.hydratedFooterText)),t.hydratedTitleText&&(e.title=G(t.hydratedTitleText))},parseButtons:function(e,t){var{hydratedButtons:r}=t;r.length&&(e.hydratedButtons=r)},parseTemplateButtonReplyMessage:function(e,t){e.body=G(t.selectedDisplayText),e.selectedIndex=t.selectedIndex,e.selectedId=t.selectedId},parseProductMessageProto:function(e,t){var{product:r}=t;r&&(r.productImage&&this.parseImageMessageProto(e,r.productImage),e.type=f.default.MSG_TYPE.PRODUCT,e.businessOwnerJid=t.businessOwnerJid,e.contextInfo=t.contextInfo,e.productId=r.productId,e.currencyCode=r.currencyCode,e.priceAmount1000=r.priceAmount1000,e.salePriceAmount1000=r.salePriceAmount1000,e.retailerId=r.retailerId,e.url=r.url,e.productImageCount=r.productImageCount,e.title=r.title,e.description=r.description)},parseLiveLocationMessageProto:function(){__LOG__(2)(L())},parseSendPaymentMessageProto:function(){__LOG__(2)(N())},parseRequestPaymentMessageProto:function(){__LOG__(2)(D())},parseGroupInviteMessageProto:function(){__LOG__(2)(R())},parseOrderMessageProto:function(e,t){e.type=f.default.MSG_TYPE.ORDER,e.thumbnail=this.decodeBytes(t.thumbnail),e.message=t.message||"",e.orderId=t.orderId,e.itemCount=t.itemCount||0,e.status=t.status,e.surface=t.surface,e.sellerJid=t.sellerJid,e.orderTitle=t.orderTitle||"",e.token=t.token||"",e.totalAmount1000=t.totalAmount1000,e.totalCurrencyCode=t.totalCurrencyCode,e.body=""},parseListMessageProto:function(e,t){var r;S.default.webListMessage&&t.listType===p.ListMessageListType.SINGLE_SELECT||(0,m.productListMessagesEnabled)()&&t.listType===p.ListMessageListType.PRODUCT_LIST?(e.type=f.default.MSG_TYPE.LIST,e.list=t,e.footer=t.footerText,e.contextInfo=t.contextInfo,t.listType===p.ListMessageListType.PRODUCT_LIST&&(e.businessOwnerJid=null===(r=t.productListInfo)||void 0===r?void 0:r.businessOwnerJid)):(t.listType===p.ListMessageListType.PRODUCT_LIST&&(0,m.productListMessageFallbackEnabled)()&&(e.subtype="phone_only_feature"),e.type=f.default.MSG_TYPE.UNKNOWN)},parseListResponseMessageProto:function(e,t){if(S.default.webListMessage&&t.listType===p.ListResponseMessageListType.SINGLE_SELECT){e.type=f.default.MSG_TYPE.LIST_RESPONSE,e.listResponse=(0,i.default)((0,i.default)({},t),{},{contextInfo:void 0});var r=t.title||"";t.description&&(r+="\n"+t.description),e.body=G(r)}},parseButtonsResponseMessageProto:function(e,{selectedDisplayText:t,selectedButtonId:r,type:a}){(0,m.buttonsMessagesEnabled)()&&a===p.ButtonsResponseMessageType.DISPLAY_TEXT?(e.type=f.default.MSG_TYPE.BUTTONS_RESPONSE,e.selectedButtonId=r,e.body=G(t)):e.type=f.default.MSG_TYPE.UNKNOWN},parseViewOnceFutureProofMessageProto:function(e,t){S.default.viewOnceRead?this.parseMsgProto(t.message,e):(e.type=f.default.MSG_TYPE.UNKNOWN,e.subtype="phone")},parseEphemeralFutureProofMessageProto:function(e,t){S.default.ephemeralMessages?this.parseMsgProto(t.message,e):(e.type=f.default.MSG_TYPE.UNKNOWN,e.subtype="phone")},parseButtonsMessageProto:function(e,t){if((0,m.buttonsMessagesEnabled)()){var{documentMessage:r,imageMessage:a,locationMessage:n,videoMessage:s,contentText:o,footerText:u,text:l,buttons:d,headerType:c}=t;[p.ButtonsMessageHeaderType.EMPTY,p.ButtonsMessageHeaderType.TEXT,p.ButtonsMessageHeaderType.DOCUMENT,p.ButtonsMessageHeaderType.IMAGE,p.ButtonsMessageHeaderType.VIDEO,p.ButtonsMessageHeaderType.LOCATION].includes(c)?(a?this.parseImageMessageProto(e,a):r?this.parseDocumentMessageProto(e,r):n?this.parseLocationMessageProto(e,(0,i.default)((0,i.default)({},n),{},{name:void 0,address:void 0})):s?this.parseVideoMessageProto(e,s):(e.type=f.default.MSG_TYPE.CHAT,o&&(e.body=G(o)),l&&(e.title=G(l))),e.isDynamicReplyButtonsMsg=!0,null!=c&&(e.headerType=c),d&&(e.dynamicReplyButtons=d),o&&(e.caption=G(o)),u&&(e.footer=G(u))):e.type=f.default.MSG_TYPE.UNKNOWN}else e.type=f.default.MSG_TYPE.UNKNOWN}};t.default=B},31567:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.typeAttributeFromProtobuf=function e(t){if(t.ephemeralMessage){var{message:r}=t.ephemeralMessage;return r?e(r):"text"}if(t.deviceSentMessage){var{message:a}=t.deviceSentMessage;return a?e(a):"text"}return t.conversation||t.extendedTextMessage||t.templateButtonReplyMessage||t.protocolMessage?"text":"media"},t.protobufToMsgKey=function(e){var{fromMe:t,id:r,participant:a,remoteJid:u}=e;(0,n.default)(null!=t&&null!=u&&null!=r,"fromMe, remoteJid, and id should be set");var l=a?(0,o.createWid)(a):void 0,d=(0,o.createWid)(u);(d.isGroup()||d.isBroadcast())&&t&&(l=(0,i.getMaybeMeUser)());return new s.default({fromMe:t,id:r,participant:l,remote:(0,o.createWid)(u)})},t.msgKeyToProtobuf=function(e){var t;return{fromMe:e.fromMe,id:e.id,participant:e.fromMe||null===(t=e.participant)||void 0===t?void 0:t.toString({legacy:!0}),remoteJid:e.remote.toString({legacy:!0})}};var n=a(r(47677)),i=r(95595),s=a(r(77865)),o=r(75637)},57556:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.typeIsMms=function(e){return"image"===e.type||"video"===e.type||"audio"===e.type||"ptt"===e.type||"sticker"===e.type||"document"===e.type||"product"===e.type||"protocol"===e.type&&"history_sync_notification"===e.subtype},t.msgMatchesType=function(e,t){switch(t){case"text":return e.type===u.default.MSG_TYPE.CHAT&&"url"!==e.subtype;case"image":return e.type===u.default.MSG_TYPE.IMAGE;case"video":return e.type===u.default.MSG_TYPE.VIDEO&&!e.isGif;case"gif":return e.type===u.default.MSG_TYPE.VIDEO&&e.isGif;case"audio":return e.type===u.default.MSG_TYPE.AUDIO;case"ptt":return e.type===u.default.MSG_TYPE.PTT;case"document":return e.type===u.default.MSG_TYPE.DOCUMENT;case"location":return e.type===u.default.MSG_TYPE.LOCATION;case"vcard":return e.type===u.default.MSG_TYPE.VCARD||e.type===u.default.MSG_TYPE.MULTI_VCARD;case"url":return e.type===u.default.MSG_TYPE.CHAT&&"url"===e.subtype;case"sticker":return e.type===u.default.MSG_TYPE.STICKER;case void 0:default:return!1}},t.createQuotedMsg=function(e){if(!e)return null;var t=new _.default({from:e.from,to:e.to,id:e.id,participant:e.participant,selfDir:e.self});return e.id=t,new(0,r(27e3).default)(e).safe()},t.getOriginalQuotedMsgIfPossible=function(e,t){var r;if(!e)return e;var a=null===(r=t.get(e.id))||void 0===r?void 0:r.safe();return a&&!a.asRevoked?a:e},t.listMsgCanRender=function(e){var t;return(null===(t=e.list)||void 0===t?void 0:t.listType)!==l.ListMessageListType.PRODUCT_LIST||(0,f.productListMessagesEnabled)()&&!m.default.webProductListMessageRenderKillSwitch},t.getBroadcastFanoutKeys=T,t.broadcastFanout=function(e){var t;if(!e.invis){var a=T(e);a&&(t=a.map((e=>e.remote)),a.forEach((t=>{var a=r(58885).default;if(!a.some((0,s.default)({id:t}))){var n=P(e);n.to=t.remote,n.id=t,n.broadcast=!0;var i=a.add(n,{merge:!0});r(43334).default.find(t.remote).then((function(e){m.default.ephemeralMessages&&i.forEach((t=>{if(t.type!==u.default.MSG_TYPE.PROTOCOL){e.isEphemeralSettingOn()&&(t.ephemeralDuration=e.getEphemeralSetting());var r=e.getEphemeralSettingTimestamp();null!=r&&(t.ephemeralSettingTimestamp=r)}})),b(i,e,!0)}))}})))}return t},t.addRecordsToChat=b,t.isNotification=function(e,t){switch(e){case u.default.MSG_TYPE.GROUP_NOTIFICATION:case u.default.MSG_TYPE.GP2:case u.default.MSG_TYPE.BROADCAST_NOTIFICATION:case u.default.MSG_TYPE.NOTIFICATION:case u.default.MSG_TYPE.NOTIFICATION_TEMPLATE:case u.default.MSG_TYPE.E2E_NOTIFICATION:case u.default.MSG_TYPE.CALL_LOG:return!0;case u.default.MSG_TYPE.PROTOCOL:return"ephemeral_setting"===t;default:return!1}},t.eventTypeFromMsgType=function(e){var t,r,a=e.type,n=e.subtype,i=(0,c.getMaybeMeUser)();t=a===u.default.MSG_TYPE.GP2||a===u.default.MSG_TYPE.GROUP_NOTIFICATION?"subject"===n?"n":"add"===n||"invite"===n?e.recipients&&g.default.equals(r,i)?"s":"i":"remove"===n?e.recipients&&g.default.equals(r,i)?"n":"i":"create"===n?"n":"i":a===u.default.MSG_TYPE.BROADCAST_NOTIFICATION||a===u.default.MSG_TYPE.NOTIFICATION||a===u.default.MSG_TYPE.E2E_NOTIFICATION?"create"===n?"n":"i":a===u.default.MSG_TYPE.GROUPS_V4_INVITE&&e.from.equals(i)?"i":a===u.default.MSG_TYPE.CALL_LOG?"n":e.broadcast?g.default.isBroadcast(e.id.remote)?"n":"i":a===u.default.MSG_TYPE.REVOKED?"i":g.default.isPSA(e.id.remote)?e.ack===u.default.ACK.RECEIVED?"d":"a":a===u.default.MSG_TYPE.CIPHERTEXT||a===u.default.MSG_TYPE.OVERSIZED?"a":a===u.default.MSG_TYPE.NOTIFICATION_TEMPLATE||a===u.default.MSG_TYPE.PROTOCOL&&"ephemeral_setting"===n?"i":"d";return t};var n=a(r(19976)),i=a(r(72960)),s=a(r(45126)),o=a(r(16760)),u=a(r(50935)),l=r(28703),d=r(19741),c=r(95595),f=r(75459),p=a(r(80737)),h=r(57525),_=a(r(77865)),m=a(r(72424)),g=a(r(68384));function v(){var e=(0,n.default)(["setRecords LogoutDrop: ",""]);return v=function(){return e},e}function E(){var e=(0,n.default)(["models:msg:store:resetMostRecentMsgs .msgs === cmc !"]);return E=function(){return e},e}function y(){var e=(0,n.default)(["model:msgs:broadcastFanout no group_metadata rec for bclist, cant fanout: ",""]);return y=function(){return e},e}function S(){var e=(0,n.default)(["model:msgs:broadcastFanout: unknown msgOrKey: ",""]);return S=function(){return e},e}function T(e){var t,a,n;if(e instanceof r(27e3).default)a=e,n=e.id;else{if(!(e instanceof _.default))return void __LOG__(3)(S(),String(e));n=e}if(!g.default.isStatusV3(n.remote)){if(a&&a.recipients&&0!==a.recipients.length)t=a.recipients;else{var i=r(99922).default.get(n.remote);i?t=(0,o.default)(P(i.participants),"id"):__LOG__(2)(y(),n.remote.toString())}return t?t.map((e=>new _.default({fromMe:n.fromMe,remote:e,id:n.id}))):void 0}}function b(e,t,a,n,i,s){var o=n||t.msgs;if(0!==e.length){var u=o===t.msgs;if(s)if(u)__LOG__(2)(E()),A(t,o,e);else u=!0,A(t,o,e).then((()=>{var e=new(0,r(90980).default);e.replace(t.msgs),t.msgChunks.push(e),t.replaceMsgsCollection(o),t.msgs.trigger("change:last",t.msgs.last())}));else a?u?A(t,o,e):C(o,e):C(o,e,{at:0,silent:e.every(O)});var l=r(58885).default;if(a&&u||!l.lastReceivedReceipt[t.id])for(var d=e.length-1;d>=0;d--){var c=e[d],f=c.id;if(f.fromMe&&!c.isNotification){l.updateLastReceipt(f.remote,c.t);break}}if(a&&u||!l.lastReceivedPaymentTransaction[t.id])for(var p=e.length-1;p>=0;p--){var h=e[p],_=h.id;h.paymentTransactionTimestamp&&l.updateLastTransactionTime(_.remote,h.paymentTransactionTimestamp)}var m=i;m&&!t.unreadMsgAnchor&&(t.disableUnreadAnchor?t.disableUnreadAnchor=!1:t.unreadMsgAnchor=e.find((function(e){return e.id.toString()===m.toString()})))}}function A(e,t,r){var a=(0,i.default)(r,(e=>!!e));return a?(C(t,r),(0,h.setLastReceivedKey)(e.id,a.id).then((()=>{e.lastReceivedKey=a.id}))):Promise.resolve()}function C(e,t,r){try{e.add(t,r)}catch(e){if(!(e instanceof d.LogoutDrop))throw e;__LOG__(3)(v(),e.toString())}}function P(e){return null!=e&&"object"==typeof e?JSON.parse(JSON.stringify(e),p.default):e}function O(e){return"i"===e.eventType}},77861:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.GLOBAL_MUTE=void 0;var i=n(r(19976)),s=n(r(19034)),o=a(r(2784)),u=r(12073),l=n(r(25337)),d=a(r(61247)),c=n(r(79711)),f=a(r(96452)),p=n(r(17957)),h=r(37821),_=r(11419),m=n(r(68384));function g(){var e=(0,i.default)(["models:Mute:unmute dropped"]);return g=function(){return e},e}function v(){var e=(0,i.default)(["models:Mute:unmute ",""]);return v=function(){return e},e}function E(){var e=(0,i.default)(["models:Mute:mute dropped"]);return E=function(){return e},e}function y(){var e=(0,i.default)(["models:Mute:mute "," duration:",""]);return y=function(){return e},e}function S(){var e=(0,i.default)(["models:Mute:mute "," muted, no expiration"]);return S=function(){return e},e}function T(){var e=(0,i.default)(["models:Mute:mute called with wrong units?"," exp:",""]);return T=function(){return e},e}function b(){var e=(0,i.default)(["models:Mute:mute called with invalid expiration ",""]);return b=function(){return e},e}var A="global_mute";t.GLOBAL_MUTE=A;class C extends d.default{constructor(...e){super(...e),this.id=(0,d.prop)(),this.expiration=(0,d.prop)(0),this._unmuteTimer=(0,d.session)(),this.promises=(0,d.session)((function(){return{}})),this.isMuted=(0,d.derived)(this._isMuted,["expiration"])}_isMuted(){return!!this.expiration}initialize(){super.initialize(),null!=this.expiration&&0!==this.expiration&&this.mute(this.expiration)}setMute(e,t){(e||this.expiration)&&e!==this.expiration&&(e?this.mute(e,t):this.unmute(t))}mute(e,t,r){var a=e;if(!(0,_.isNumber)(a))return __LOG__(2)(b(),a),Promise.reject(new f.ActionError);(a=Math.round(a))>2e9&&__LOG__(2)(T(),this.id.toString(),a);var n=function(){if(this.isMuted&&(l.default.clearTimeout(this._unmuteTimer),this.unset("_unmuteTimer")),-1===a)__LOG__(2)(S(),this.id.toString());else{var e=a-(0,s.default)().unix();__LOG__(2)(y(),this.id.toString(),e),this._unmuteTimer=l.default.setGlobalTimeout(this.unmute.bind(this),1e3*a)}this.set({expiration:a})}.bind(this),i=m.default.isGroup(this.id);if(t){if(this.promises.mute)return this.promises.mute;var d=this.promises.mute=(0,h.sendConversationMute)(this.id,a,this.expiration),g=i?new u.ActionType(p.default.t(120)):new u.ActionType(p.default.t(75)),v=r||(0,u.genId)(),A=this.promises.mute.catch((()=>{__LOG__(3)(E());var e=i?p.default.t(118):p.default.t(73);throw new u.ActionType(e,{actionText:p.default.t(199),actionHandler:this.mute.bind(this,a,t,v)})})).then((e=>{if(200===e.status){var r=i?p.default.t(119):p.default.t(74);return new u.ActionType(r,{actionText:p.default.t(203),actionHandler:this.unmute.bind(this,t,v)})}if(e.status>=400)throw i?new u.ActionType(p.default.t(118)):new u.ActionType(p.default.t(73))}));return c.default.openToast(o.createElement(u.ActionToast,{id:v,initialAction:g,pendingAction:A})),d.then((function(e){200!==e.status||e._duplicate||n()})).finally((()=>{this.promises.mute=null}))}return n(),Promise.resolve()}canMute(){var e=!1;if(m.default.isGroup(this.id)){var t=r(99922).default.get(this.id);t&&(e=t.participants.iAmMember())}return e||m.default.isUser(this.id)}_clearUnmuteTimer(){l.default.clearTimeout(this._unmuteTimer),this.unset("_unmuteTimer"),this.expiration=0}unmute(e,t){var r=function(){__LOG__(2)(v(),this.id.toString()),this._clearUnmuteTimer()}.bind(this),a=m.default.isGroup(this.id);if(e){if(this.promises.unmute)return this.promises.unmute;var n=this.promises.unmute=(0,h.sendConversationMute)(this.id,0,this.expiration),i=a?new u.ActionType(p.default.t(127)):new u.ActionType(p.default.t(86)),s=t||(0,u.genId)(),l=this.promises.unmute.catch((()=>{__LOG__(3)(g());var t=a?p.default.t(125):p.default.t(84);return Promise.reject(new u.ActionType(t,{actionText:p.default.t(199),actionHandler:this.unmute.bind(this,e,s)}))})).then((e=>{if(200===e.status)return a?new u.ActionType(p.default.t(126)):new u.ActionType(p.default.t(85));if(e.status>=400)throw a?new u.ActionType(p.default.t(125)):new u.ActionType(p.default.t(84))}));return c.default.openToast(o.createElement(u.ActionToast,{id:s,initialAction:i,pendingAction:l})),n.then((function(e){200!==e.status||e._duplicate||r()})).finally((()=>{this.promises.unmute=null}))}return r(),Promise.resolve()}delete(){super.delete(),this.getCollection().remove(this.id),this._clearUnmuteTimer()}getCollection(){return r(85059).default}}C.Proxy="mute",C.idClass=m.default,C.allowedIds=[A];var P=(0,d.defineModel)(C);t.default=P},85059:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.MuteCollection=void 0;var i=n(r(19976)),s=a(r(54019)),o=n(r(52737)),u=r(95595),l=a(r(77861));function d(){var e=(0,i.default)(["models:mute:cache-save: globalMuteModel does not exist"]);return d=function(){return e},e}function c(){var e=(0,i.default)(["models:mute:cache-save: ",""]);return c=function(){return e},e}var f=!0,p=!0,h=!0,_=!1,m=!1;class g extends s.default{initializeFromCache(e){this.add(e),this.setGlobalNotifications((0,u.getGlobalNotifications)()),this.setGlobalSounds((0,u.getGlobalSounds)()),this.setGlobalPreviews((0,u.getGlobalPreviews)()),this.setCollapseMuted((0,u.getCollapseMuted)()),this.setOutgoingMessageSound((0,u.getOutgoingMessageSound)())}saveToCache(){if(o.default.shouldSaveToCache()){var e=this.constructor.cachePolicy.id;__LOG__(2)(c(),String(e));var t=this.get(l.GLOBAL_MUTE);t?(0,u.setCollection)(e,t.toJSON()):__LOG__(3)(d())}}globalMute(){var e=this.get(l.GLOBAL_MUTE);return e||this.add({id:l.GLOBAL_MUTE})[0]}getGlobalSounds(){return f}setGlobalSounds(e){f=e,(0,u.setGlobalSounds)(e)}getGlobalNotifications(){return p}setGlobalNotifications(e){p=e,(0,u.setGlobalNotifications)(e)}getGlobalPreviews(){return h}setGlobalPreviews(e){h=e,(0,u.setGlobalPreviews)(e)}getCollapseMuted(){return _}setCollapseMuted(e){_=e,(0,u.setCollapseMuted)(e),this.trigger("change:collapseMuted",_)}getOutgoingMessageSound(){return m}setOutgoingMessageSound(e){m=e,(0,u.setOutgoingMessageSound)(e)}handle(e){e.forEach((e=>{var t=r(43334).default.get(e.id);t&&"mute"===e.type&&t.mute.setMute(e.muteExpiration)}))}}t.MuteCollection=g,g.model=l.default,g.cachePolicy={id:"mute",policy:s.CACHE_POLICY.LOAD,delay:1e3};var v=new g;t.default=v},11680:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(r(70417)),s=n(r(19976)),o=r(26800),u=r(29351),l=n(r(96519)),d=r(28721),c=n(r(12489)),f=r(8701),p=n(r(93282)),h=a(r(61247)),_=n(r(52737)),m=n(r(50935)),g=r(19741),v=r(37755),E=n(r(93601)),y=r(95595),S=n(r(18120)),T=n(r(17957)),b=n(r(40210)),A=n(r(61941)),C=n(r(72424)),P=n(r(74185));function O(){var e=(0,s.default)(["Notice: Could Not download"]);return O=function(){return e},e}function w(){var e=(0,s.default)(["Notice: Fetch Retry attempt"]);return w=function(){return e},e}function M(){var e=(0,s.default)(["Notice: Icon fetch error : ",""]);return M=function(){return e},e}function I(){var e=(0,s.default)(["Notice: Error Message : ",""]);return I=function(){return e},e}function R(){var e=(0,s.default)([""," failed with error: ",""]);return R=function(){return e},e}function D(){var e=(0,s.default)([""," dropped"]);return D=function(){return e},e}function N(){var e=(0,s.default)([""," error receive status code ",""]);return N=function(){return e},e}function L(){var e=(0,s.default)([""," success"]);return L=function(){return e},e}function k(){var e=(0,s.default)(["",""]);return k=function(){return e},e}function U(){var e=(0,s.default)(["Notice: received empty notice"]);return U=function(){return e},e}function F(){var e=(0,s.default)(["Notice: more than one notice from phone response"]);return F=function(){return e},e}function G(){var e=(0,s.default)(["Notice: received notice id: ",", blocking: ",", version: ",""]);return G=function(){return e},e}function x(){var e=(0,s.default)(["Notice: aborting fetches"]);return x=function(){return e},e}function B(){var e=(0,s.default)(["Notice:fetchNoticeData successful for policyVersion ",""]);return B=function(){return e},e}function Y(){var e=(0,s.default)(["Notice: Unknown action type ",""]);return Y=function(){return e},e}class K extends((0,u.customError)("NoticeJsonParseError")){}var j=["logout","refresh"],W=(0,o.createTimer)({algo:{type:"constant",delay:432e5}}),V=(0,o.createTimer)({algo:{type:"fibonacci",first:0,second:1},max:18e6});class H extends h.default{constructor(...e){super(...e),this.id=(0,h.prop)(),this.noticeId=(0,h.prop)(),this.blocking=(0,h.prop)(),this.policyVersion=(0,h.prop)(),this.banner=(0,h.prop)(),this.blockingModal=(0,h.prop)(),this.shouldShowButterBar=(0,h.session)(!0),this.backgroundFetches=(0,h.session)()}initialize(){super.initialize(),this.fetchNoticeData=this.fetchNoticeData.bind(this),this.listenTo(T.default,"locale_change",this.fetchNoticeData)}dismissButterBarNotice(){0!==C.default.greenAlertBannerDuration&&(new b.default.UserNotice({userNoticeId:this.noticeId,userNoticeContentVersion:this.policyVersion,userNoticeEvent:b.default.USER_NOTICE_EVENT.BANNER_DISMISS}).commit(),this._dismissAndStartButterBarTimer(C.default.greenAlertBannerDuration),(0,y.setNoticeBannerClosedAt)(Date.now()))}_dismissAndStartButterBarTimer(e){this.shouldShowButterBar=!1,this._clearButterBarTimer(),this._butterBarTimeoutHandler=window.setTimeout((()=>{this.shouldShowButterBar=!0,(0,y.setNoticeBannerClosedAt)(null)}),e)}delete(){this.resetNotice(),super.delete()}sanitizeBlockingModal(e){if(!e)return null;var t=e=>{if(!e)return null;var t=e.action;if(t){var r=j.find((e=>"".concat("whatsapp:user-notice?action=").concat(e)===t));if(r)return e.action=r,e;__LOG__(3)(Y(),t)}return null};return e.primaryButton=t(e.primaryButton),e.secondaryButton=t(e.secondaryButton),e}_isoFromCallingCode(e){var t=parseInt(e,10),r=l.default[t];return(0,A.default)(r,"isoFromCC")}validateResponseFields(e,t){e.forEach((e=>{if(!(e in t))throw new Error("Missing field ".concat(e," in notice content."))}))}extractBlockingModal(e){if(e)return this.validateResponseFields(["icon","iconDescription","title","body","primaryButton"],e),this.validateResponseFields(["light","dark"],e.icon),{icon:{light:e.icon.light,dark:e.icon.dark},iconSvg:{light:"",dark:""},iconDescription:e.iconDescription,title:e.title,body:e.body,primaryButton:e.primaryButton,secondaryButton:e.secondaryButton}}extractBanner(e){if(e)return this.validateResponseFields(["icon","iconDescription","text"],e),this.validateResponseFields(["light","dark"],e.icon),{icon:{light:e.icon.light,dark:e.icon.dark},iconDescription:e.iconDescription,text:e.text,iconSvg:{light:"",dark:""}}}extractUserNoticeContent(e){var{policyVersion:t}=e;if(!t)throw new Error("Missing field policyVersion in notice content.");__LOG__(2)(B(),t);var r=e.banner&&this.extractBanner(e.banner),a=e["blocking-modal"]&&this.extractBlockingModal(e["blocking-modal"]),n=a&&this.sanitizeBlockingModal(a);this.set({policyVersion:t,blockingModal:n,banner:r}),this.makeIconFetch(r,n)}resetBackgroundFetches(){var e;null===(e=this.backgroundFetches)||void 0===e||e.forEach((e=>{__LOG__(2)(x()),e.abort()}))}resetNotice(){this.resetBackgroundFetches(),this.unset(["banner","blocking","blockingModal","noticeId","policyVersion"]),(0,y.setNoticeId)(null),(0,y.setNoticeBannerClosedAt)(null),this._clearButterBarTimer(),this.shouldShowButterBar=!0}_clearButterBarTimer(){var e=this._butterBarTimeoutHandler;null!=e&&window.clearTimeout(e)}fetchNoticeData(){if(this.noticeId&&S.default.supportsFeature(S.default.F.USER_NOTICE)){var e,t;this.resetBackgroundFetches(),this.set({blockingModal:void 0,banner:void 0});var r=(0,y.getMeUser)(),a=(0,d.findCC)(r.user),n=this._isoFromCallingCode(a),i=P.default.build(m.default.NOTICE_CONTENT_ENDPOINT_URL,{id:this.noticeId,lg:null!==(e=_.default.lg)&&void 0!==e?e:"zz",lc:null!==(t=_.default.lc)&&void 0!==t?t:"ZZ",cc:n,platform:_.default.isSMB?"smbweb":"web"});this.makeContentFetch(i)}}_shouldUpdateVersion(e,t){return null==e||null!=t&&t>e}handleResponse(e){if(S.default.supportsFeature(S.default.F.USER_NOTICE))if(e.length){var{blocking:t,id:r,version:a}=e[0],n=this.noticeId,i=this._shouldUpdateVersion(this.policyVersion,a);__LOG__(2)(G(),r,t,a),this.set({blocking:t,noticeId:r,policyVersion:i?a:this.policyVersion}),(r!==n||i)&&this.fetchNoticeData(),r!==(0,y.getNoticeId)()&&((0,y.setNoticeId)(r),(0,y.setNoticeBannerClosedAt)(null),this._clearButterBarTimer(),this.shouldShowButterBar=!0),e.length>1&&(__LOG__(4,void 0,new Error,!0)(F()),SEND_LOGS("notice-unallowed-length"))}else __LOG__(2)(U()),this.resetNotice()}sync(e){!0!==e&&this._initializeShouldShowButterBar();var t="Notice:sync".concat(e?" resume":"");return __LOG__(2)(k(),t),(0,r(76022).default.queryNoticeState)(e).then((e=>{200===e.status?(__LOG__(2)(L(),t),this.handleResponse(e.notices)):__LOG__(3)(N(),t,e.status)})).catchType(g.WebdDrop,(function(){__LOG__(3)(D(),t)})).catch((e=>{__LOG__(4,void 0,new Error,!0)(R(),t,e),SEND_LOGS("notice-query-failed")}))}_initializeShouldShowButterBar(){var e=(0,y.getNoticeBannerClosedAt)();if(null!=e&&0!==C.default.greenAlertBannerDuration){var t=e+C.default.greenAlertBannerDuration-Date.now();if(t>0)return void this._dismissAndStartButterBarTimer(t)}this.shouldShowButterBar=!0}makeContentFetch(e){return this.attemptFirstFetchAndRetriesAfter(e).then((e=>{try{var t=e&&JSON.parse(e);t&&this.extractUserNoticeContent(t)}catch(e){throw new b.default.UserNoticeError({userNoticeId:this.noticeId,userNoticeContentVersion:this.policyVersion,userNoticeErrorEvent:b.default.USER_NOTICE_ERROR_EVENT.JSON_PARSE}).commit(),new K("Received invalid User Notice content for id ".concat(this.noticeId))}})).catch((e=>{if(e.name!==f.ABORT_ERROR){if("NoticeJsonParseError"!==e.name)new b.default.UserNoticeError({userNoticeId:this.noticeId,userNoticeContentVersion:this.policyVersion,userNoticeErrorEvent:b.default.USER_NOTICE_ERROR_EVENT.JSON_FETCH}).commit();this.resetNotice(),__LOG__(4,void 0,new Error,!0)(I(),e.message),SEND_LOGS("notice-content-error")}}))}makeIconFetch(e,t){var r=[null==e?void 0:e.icon.light,null==e?void 0:e.icon.dark,null==t?void 0:t.icon.light,null==t?void 0:t.icon.dark].map((e=>e?this.attemptFirstFetchAndRetriesAfter(e):Promise.resolve(null)));return Promise.all(r).then((([e,t,r,a])=>{var n=this.banner,s=this.blockingModal;this.banner&&e&&t&&(n=(0,i.default)((0,i.default)({},this.banner),{iconSvg:{light:e,dark:t}})),this.blockingModal&&r&&a&&(s=(0,i.default)((0,i.default)({},this.blockingModal),{iconSvg:{light:r,dark:a}})),this.set({banner:n,blockingModal:s})})).catch((e=>{e.name!==f.ABORT_ERROR&&(new b.default.UserNoticeError({userNoticeId:this.noticeId,userNoticeContentVersion:this.policyVersion,userNoticeErrorEvent:b.default.USER_NOTICE_ERROR_EVENT.IMAGE_FETCH}).commit(),__LOG__(4,void 0,new Error,!0)(M(),e.message),SEND_LOGS("notice-icon-fetch-error"))}))}shouldRetry(e){return 404===e||429===e||e>=500}attemptFirstFetchAndRetriesAfter(e){var t,r=new c.default,a=r.signal,n=null!==(t=this.backgroundFetches)&&void 0!==t?t:[];return this.backgroundFetches=[...n,r],(0,E.default)(e,{signal:a}).then((e=>{if(!e.ok){var t=e.status;throw this.shouldRetry(t)?new v.HttpStatusCodeError(t,"noticeFetchErr"):new Error("contentResponseUnhandledError")}return e.text()})).catch((t=>{if("HttpStatusCodeError"===t.name)return this.retryFetch(e,t.status);throw t}))}retryFetch(e,t){var r,a=new c.default,n=a.signal,i=null!==(r=this.backgroundFetches)&&void 0!==r?r:[];this.backgroundFetches=[...i,a];var s,o;return 404===t?(o=2,s=({taskDuration:e})=>{var t=W();return Math.max(t-e,0)}):(o=8,s=({taskDuration:e})=>{var t=36e5*V();return Math.max(t-e,0)}),(0,p.default)({delay:s,retries:o,signal:n},(t=>(__LOG__(2)(w()),(0,E.default)(e,{signal:n}).then((e=>{if(!e.ok){if(__LOG__(3)(O()),this.shouldRetry(e.status))return t(new Error("retryFailed"));throw new Error("contentResponseUnhandledError")}return e.text()})))))}}H.Proxy="notice";var q=new((0,h.defineModel)(H))({id:"default_notice_id"});t.default=q},33555:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.Chatstate=t.default=t.ChatstateCollection=void 0;var i=n(r(54073)),s=n(r(54019)),o=a(r(61247)),u=n(r(19899)),l=n(r(7470)),d=n(r(17957)),c=n(r(68384));class f extends o.default{constructor(...e){super(...e),this.id=(0,o.prop)(),this.type=(0,o.prop)(),this.t=(0,o.prop)(),this.deny=(0,o.prop)(),this.updateTime=(0,o.session)(),this.expireTimerId=(0,o.session)()}}f.Proxy="chatstate",f.idClass=c.default;var p=(0,o.defineModel)(f);t.Chatstate=p;class h extends s.default{}t.ChatstateCollection=h,h.model=p;class _ extends o.default{constructor(...e){super(...e),this.id=(0,o.prop)(),this.isOnline=(0,o.session)(!1),this.stale=(0,o.session)(!0),this.hasData=(0,o.session)(!1),this.isSubscribed=(0,o.session)(!1),this.withholdDisplay=(0,o.session)(!0),this.forceDisplay=(0,o.session)(!1),this.chatActive=(0,o.session)(!1),this.withholdDisplayTimer=(0,o.session)(),this.forceDisplayTimer=(0,o.session)(),this.chatstate=(0,o.session)(),this.chatstates=(0,o.collection)(h),this.isGroup=(0,o.derived)(this._isGroup),this.isUser=(0,o.derived)(this._isUser)}_isGroup(){return c.default.isGroup(this.id)}_isUser(){return c.default.isUser(this.id)}initialize(){super.initialize();var e=this.isGroup?{id:"",type:"unavailable"}:{id:this.id};this.addChild("chatstate",new p(e)),this.isGroup?this.listenTo(this.chatstates,"add change",(0,i.default)((()=>{var e,t=!1;this.chatstates.forEach((r=>{"composing"!==r.type&&"recording"!==r.type||e&&!(e.updateTime<r.updateTime)||(e=r),t=t||"unavailable"!==r.type})),this.set({isOnline:t}),this.chatstate.set({id:e?e.id:"",type:e?e.type:"unavailable"})}))):this.listenTo(this.chatstate,"change:type",(()=>{this.isOnline="unavailable"!==this.chatstate.type})),this.listenTo(this,"change:chatActive",this.onChatActiveChange)}delete(){super.delete(),this.getCollection().remove(this.id),this.chatstate.delete(),this.chatstates.forEach((e=>e.delete()))}reset(){this.hasData=!1,this.isGroup?this.chatstates.forEach((e=>{e.type="unavailable"})):this.isUser&&(this.chatstate.unset("t"),this.chatstate.unset("deny")),this.chatstate.set({id:this.isGroup?"":this.id,type:"unavailable",t:void 0,deny:void 0})}isActive(){var e=this.chatstate.type;return this.hasData&&("composing"===e||"recording"===e)}getFormattedString(){if(!this.hasData)return null;if(this.isGroup){var e=this.chatstate.id;if(!e)return null;var t=l.default.get(e);if(!t)return null;var r=t.formattedShortName;return"composing"===this.chatstate.type?d.default.t(1619,{participant:r}):d.default.t(1620,{participant:r})}if(!this.isUser)return null;var a=this.chatstate;switch(a.type){case"available":return d.default.t(1612);case"composing":return d.default.t(1613);case"recording":return d.default.t(1614);case"unavailable":return a.deny||null==a.t?null:u.default.lastSeenStr(a.t)}}onChatActiveChange(){this.chatActive?(this.hasData?this.withholdDisplay=!1:this.withholdDisplayTimer=setTimeout((()=>{this.set({withholdDisplay:!1,withholdDisplayTimer:void 0})}),1500),this.forceDisplayTimer=setTimeout((()=>{this.set({forceDisplay:!0,forceDisplayTimer:void 0})}),2e3)):(this.withholdDisplayTimer&&(clearTimeout(this.withholdDisplayTimer),this.withholdDisplayTimer=void 0),this.forceDisplayTimer&&(clearTimeout(this.forceDisplayTimer),this.forceDisplayTimer=void 0))}subscribe(){return this.getCollection().find(this.id)}getCollection(){return r(99098).default}}_.Proxy="presence",_.idClass=c.default;var m=(0,o.defineModel)(_);t.default=m},99098:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.PresenceCollection=void 0;var n=a(r(54019)),i=a(r(33555)),s=r(7845),o=a(r(68384));class u extends n.default{_find(e){return!this.gadd(e).isUser||o.default.isServer(e)||o.default.isPSA(e)?Promise.resolve({id:e}):(0,s.subscribePresence)(e).then((()=>({id:e})))}clearAllPresence(){this.forEach((e=>{e.reset(),e.set({stale:!0,isSubscribed:!1})}))}}t.PresenceCollection=u,u.model=i.default,u.staleCollection=!0;var l=new u;t.default=l},54657:(e,t,r)=>{"use strict";var a=r(14859),n=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(r(61247)),s=a(r(61941)),o=a(r(37163)),u=r(93649),l=r(8125),d=a(r(87127)),c=a(r(38350)),f=a(r(68384));class p extends i.default{constructor(...e){super(...e),this.id=(0,i.prop)(),this.afterCursor=(0,i.prop)(),this.index=(0,i.prop)(),this.fetchedFromServer=(0,i.session)(),this._products=(0,i.session)(),this._msgs=(0,i.session)()}initialize(){super.initialize(),this.productCollection=new c.default,this.msgProductCollection=new c.default,this.collections=new d.default,this.listenTo(this,"change:_products",this.triggerProductUpdate),this.listenTo(this,"change:_msgs",this.triggerMsgUpdate),this.triggerProductUpdate(),this.triggerMsgUpdate()}triggerProductUpdate(){this._products&&this.productCollection.add(this._products,{merge:!0}),this._products=void 0}triggerMsgUpdate(){this._msgs&&this.msgProductCollection.add(this._msgs,{merge:!0}),this._msgs=void 0}markProductCollectionOld(){this.productCollection.forEach((e=>e.markOld()))}addProduct(e){var{id:t}=this;return(0,u.addProduct)(e).then((e=>{var r=this.productCollection.at(0);e.catalogWid=t,e.index=r?r.index-1:0;var a=this.productCollection.add(e,{merge:!0,at:0})[0];return(0,s.default)(a,"addedProduct")}))}editProduct(e){return(0,u.editProduct)(e).then((e=>{var t=this.productCollection.add(e,{merge:!0})[0];return(0,s.default)(t,"editedProduct")}))}pullProduct(e){return(0,u.queryProduct)(this.id,e).then((e=>{var t=new o.default((0,l.mapProductResponseToModel)(e.data,this.id));this.updateProduct(t)}))}updateProduct(e){this.productCollection.add(e,{merge:!1})}getCollection(){return r(65468).default}}p.Proxy="catalog",p.idClass=f.default;var h=(0,i.defineModel)(p);t.default=h},65468:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.CatalogCollection=t.STATIC_WHATSAPP_IMAGE_URI=void 0;var n=a(r(54019)),i=a(r(54657)),s=r(93649),o=r(8125),u=r(11419),l=r(75637),d="https://static.whatsapp.net";t.STATIC_WHATSAPP_IMAGE_URI=d;class c extends n.default{addMsgAsProduct(e){var t=e.businessOwnerJid&&(0,l.createWid)(e.businessOwnerJid);if(t){var r=this.get(t),a=r&&e.productId&&r.msgProductCollection.get(e.productId),n=r&&e.productId&&r.productCollection.get(e.productId);if(!(n&&n.t&&n.t>=e.t||a&&a.fetchedFromServer)){var i=(0,o.mapMsgToProductModel)(e);return super.add({id:t,afterCursor:void 0,_msgs:[i],stale:!0,fetchedFromServer:!!n},{merge:!0})}}}_queryProduct({catalogWid:e,productId:t,productMsgMediaData:r,width:a,height:n}){return(0,s.queryProduct)(e,t,a,n).then((t=>{if(!t.data)return super.add({id:e,afterCursor:void 0});var{data:a}=t;if(!a.image_cdn_urls||a.image_cdn_urls[0].value.includes(d))return Promise.reject(new Error("CatalogCollection:findProduct:_queryProduct ".concat(a.image_cdn_urls?"Product image contains static image":"Could not find image_cdn_urls for product")));var n=(0,o.mapProductResponseToModel)(a,e);n.productMsgMediaData=r;var i=[n];return super.add({id:e,afterCursor:void 0,_products:i,_msgs:i},{merge:!0})}))}findProduct({catalogWid:e,productId:t,productMsgMediaData:r}){return t?this._queryProduct({catalogWid:e,productId:t,productMsgMediaData:r}):Promise.reject(new Error("CatalogCollection:findProduct Received productId type ".concat(void 0===t?"undefined":"null")))}_queryCatalog(e,t,r){var a=e?e.index:0;return(0,s.queryCatalog)(t,r,10).then((e=>{if(!e.data.length)return{id:t,afterCursor:void 0};var r=[];return e.data.forEach((e=>{e.image_cdn_urls&&!e.image_cdn_urls[0].value.includes(d)&&r.push((0,o.mapProductResponseToModel)(e,t))})),{id:t,afterCursor:e.paging.cursors.after,_products:r,fetchedFromServer:!0,index:a+r.length}}))}_findQuery(e){var t=this.get(e),r=t&&!t.stale?t.afterCursor:void 0;return this._queryCatalog(t,e,r)}_find(e){return this._findQuery(e)}findCarouselCatalog(e){var t=this.get(e),r=(0,u.isString)(e)?(0,l.createWid)(e):e;return t&&t.set({index:0}),this._queryCatalog(t,r,void 0).then((e=>(t&&t.markProductCollectionOld(),super.add(e,{merge:!0}))))}findNextProductPage(e){return this.update(e).then((e=>(Array.isArray(e)?e[0]:e).productCollection.getProductModels()))}}t.CatalogCollection=c,c.model=i.default,c.staleCollection=!0;var f=new c;t.default=f},37163:(e,t,r)=>{"use strict";var a=r(14859),n=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.MAX_PRODUCT_IMAGES=t.MAX_PRICE=t.MIN_PRICE=void 0;var i=n(r(61247)),s=r(99888),o=a(r(8603)),u=r(96645),l=a(r(11318));t.MIN_PRICE=0;t.MAX_PRICE=4503599627370496;t.MAX_PRODUCT_IMAGES=10;class d extends i.default{constructor(...e){super(...e),this.old=(0,i.session)(!1),this.id=(0,i.prop)(),this.isHidden=(0,i.prop)(),this.catalogWid=(0,i.prop)(),this.url=(0,i.prop)(),this.name=(0,i.prop)(),this.description=(0,i.prop)(),this.reviewStatus=(0,i.prop)(),this.canAppeal=(0,i.prop)(),this.currency=(0,i.prop)(),this.priceAmount1000=(0,i.prop)(),this.salePriceAmount1000=(0,i.prop)(),this.salePriceStartDate=(0,i.prop)(),this.salePriceEndDate=(0,i.prop)(),this.retailerId=(0,i.prop)(),this.productImageCollection=(0,i.session)(),this.imageCount=(0,i.prop)(),this.index=(0,i.prop)(),this.additionalImageCdnUrl=(0,i.prop)(),this.additionalImageHashes=(0,i.prop)(),this.imageCdnUrl=(0,i.prop)(),this.imageHash=(0,i.prop)(),this.productMsgMediaData=(0,i.session)(),this.fetchedFromServer=(0,i.session)(),this.t=(0,i.prop)()}initialize(){super.initialize(),this.productImageCollection=new l.default,this.listenTo(this,"change:imageCdnUrl",this.triggerImageUpdate),this.listenTo(this,"change:additionalImageCdnUrl",this.triggerImageUpdate),this.triggerImageUpdate()}triggerImageUpdate(){if(this.markProductImagesOld(),this.fetchedFromServer||!this.productMsgMediaData)this.imageCdnUrl&&this.productImageCollection.gadd({id:"_0",mediaUrl:this.imageCdnUrl,fetchedFromServer:this.fetchedFromServer,old:!1},{merge:!0}),this.additionalImageCdnUrl&&this.additionalImageCdnUrl.forEach(((e,t)=>{this.productImageCollection.gadd({id:"_".concat(t+1),mediaUrl:e,fetchedFromServer:this.fetchedFromServer,old:!1},{merge:!0})}));else for(var e=0;e<this.imageCount;e++)this.productImageCollection.gadd({id:"_".concat(e),type:"product",mediaData:new o.default({mediaStage:u.MEDIA_DATA_STAGE.PREPARING}),fetchedFromServer:this.fetchedFromServer,old:!1},{merge:!0})}markOld(){this.old=!0}markProductImagesOld(){this.productImageCollection.forEach((e=>e.markOld()))}getHeadImageFile(){var e,{productImageCollection:t,name:r}=this,a=t.head();if(a&&(a.mediaData&&a.mediaData.mediaBlob&&a.mediaData.mediaBlob._blob&&(e=a.mediaData.mediaBlob._blob),e))return(0,s.createFile)([e],"".concat(r,".jpg"),{type:"image/jpeg"})}evictImagesFromCache(){this.productImageCollection.forEach((e=>e.evictFromCache()))}getPreviewImage(){return this.productImageCollection.head()}}d.Proxy="product";var c=(0,i.defineModel)(d);t.default=c},51897:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.sendProductMessage=function(){return g.apply(this,arguments)};var i=n(r(70417)),s=n(r(52954)),o=a(r(2784)),u=r(26360),l=n(r(36543)),d=n(r(79711)),c=n(r(50935)),f=n(r(17957)),p=n(r(40210)),h=n(r(61941)),_=a(r(75074));function m(e,t){var r=(0,h.default)(new l.default({chatParticipantCount:t}),"new AttachMediaCollection({\n  chatParticipantCount\n})");return r.processAttachments([{file:e}],p.default.MEDIA_PICKER_ORIGIN_TYPE.CHAT_PHOTO_LIBRARY).then((()=>{if(r.canSend()){var e=r.getPreviewableMedias();if(1===e.length){var[t]=e;return t.caption||(t.caption=void 0),t}}}))}function g(){return(g=(0,s.default)((function*(e,t,r){var a=t.getHeadImageFile();if(!a)throw d.default.openToast(o.createElement(_.default,{msg:f.default.t(1199),id:(0,_.genId)()})),new Error("Tried to send product message. Media file is not available.");var n=e.getParticipantCount(),s=yield m(a,n);if(!s)throw d.default.openToast(o.createElement(_.default,{msg:f.default.t(1199),id:(0,_.genId)()})),new Error("Tried to send product message. Media data is not available.");var l={quotedMsg:r,caption:s.caption,addEvenWhilePreparing:s.previewable&&s.state===u.ATTACH_MEDIA_STATE.PROCESSING,useBasePropsType:!0},p={businessOwnerJid:t.catalogWid.toString({legacy:!0}),productId:t.id.toString(),url:t.url,productImageCount:t.productImageCollection.length,title:t.name,description:t.description,currencyCode:t.currency,priceAmount1000:t.priceAmount1000,type:c.default.MSG_TYPE.PRODUCT};0===t.priceAmount1000&&(p.priceAmount1000=null,p.currencyCode=null),s.sendToChat(e,(0,i.default)((0,i.default)({},l),{},{productMsgOptions:p}))}))).apply(this,arguments)}},33556:(e,t,r)=>{"use strict";var a=r(14859),n=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(r(61247)),s=a(r(38350));class o extends i.default{constructor(...e){super(...e),this.id=(0,i.prop)(),this.name=(0,i.prop)(),this.isHidden=(0,i.prop)(),this.reviewStatus=(0,i.prop)(),this.totalItemsCount=(0,i.prop)(),this.afterCursor=(0,i.prop)()}initialize(){super.initialize(),this.productCollection=new s.default}addProducts(e){this.productCollection.add(e,{merge:!0})}}o.Proxy="productColl";var u=(0,i.defineModel)(o);t.default=u},87127:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.ProductCollCollection=void 0;var n=a(r(52954)),i=a(r(54019)),s=r(8125),o=a(r(33556)),u=r(41653),l=100,d=e=>({id:e.id,name:e.name,reviewStatus:e.reviewStatus,totalItemsCount:e.totalItemsCount});class c extends i.default{constructor(...e){super(...e),this.afterCursor=""}_findQuery(e){return(0,u.queryCollections)(e,this.afterCursor,10,0,!0,l,l).then((e=>(this.afterCursor=e.afterCursor,e.collections)))}_find(e){return this._findQuery(e)}findCollectionsList(e,t,r){var a=this;return(0,n.default)((function*(){var n=yield(0,u.queryCollections)(e,a.afterCursor,10,t,r,l,l);a.afterCursor=n.afterCursor,a.add(n.collections.map(d),{merge:!0}),n.collections.forEach((t=>{var r=a.get(t.id);r&&r.addProducts(t.products.map((t=>(0,s.mapProductResponseToModel)(t,e))))}))}))()}getCollectionModels(e){var t=this.toArray();return e?t:t.filter((e=>!e.isHidden&&"APPROVED"===e.reviewStatus))}findCollectionProducts(e,t){var r=this;return(0,n.default)((function*(){var a=r.get(t),n=a?a.afterCursor:void 0,i=yield(0,u.querySingleCollection)(e,t,n,10,l,l);1===i.collections.length&&(r.add(i.collections.map(d),{merge:!0}),(a=r.get(t))&&(a.addProducts(i.collections[0].products.map((t=>(0,s.mapProductResponseToModel)(t,e)))),a.afterCursor=i.afterCursor))}))()}}t.ProductCollCollection=c,c.model=o.default,c.staleCollection=!0;var f=c;t.default=f},38350:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.ProductCollection=t.PRODUCT_REVIEW_STATUS=void 0;var n=a(r(54019)),i=a(r(37163)),s=a(r(72424)),o={NO_REVIEW:"NO_REVIEW",PENDING:"PENDING",REJECTED:"REJECTED",APPROVED:"APPROVED",OUTDATED:"OUTDATED"};t.PRODUCT_REVIEW_STATUS=o;class u extends n.default{getProductModels(e=!1){var t=super.toArray();if(super.length<1)return t;var r=super.head();if(!(r&&r.catalogWid))return t;var a=e?new Set([o.OUTDATED,o.NO_REVIEW,o.APPROVED,o.REJECTED,o.PENDING]):new Set([o.APPROVED]),n=super.filter((e=>a.has(e.reviewStatus)&&!e.old));return s.default.webCatalogProductsOnOff&&!e?n.filter((e=>!e.isHidden)):n}add(e,t){var r=t?super.add(e,t):super.add(e);return this.sort(),r}evictImagesFromCache(e){var t=this.get(e);t&&t.evictImagesFromCache()}}t.ProductCollection=u,u.model=i.default,u.comparator=function(e,t){return e.index-t.index};var l=u;t.default=l},55316:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(r(19976)),s=n(r(52954)),o=n(r(70417)),u=r(26800),l=n(r(12489)),d=n(r(93282)),c=a(r(61247)),f=r(96452),p=r(28278),h=n(r(8603)),_=r(96645),m=r(82982),g=n(r(25012)),v=r(86405),E=n(r(90382));function y(){var e=(0,i.default)(["Failed to fetch ",""]);return y=function(){return e},e}var S=(0,u.createTimer)({algo:{type:"fibonacci",first:0,second:1},jitter:.25,max:9e5});function T(e){return"_productimage_"+new URL(e).pathname}class b extends c.default{constructor(...e){super(...e),this.id=(0,c.prop)(),this.type=(0,c.prop)(),this.mediaUrl=(0,c.prop)(),this.blobUrl=(0,c.session)(),this.mediaData=(0,c.session)(),this.fetchedFromServer=(0,c.prop)(),this.old=(0,c.session)(!1)}initialize(){super.initialize(),this.listenTo(this,"change:mediaUrl change:fetchedFromServer",this.triggerImageUpdate),this.triggerImageUpdate()}_processAndUpdateMediaData(e){var t={},r=g.default.createFromData(e,"image/jpeg");(0,p.prepRawMedia)(r,{}).waitForPrep().then((e=>(t=(0,o.default)((0,o.default)({},t),{},{mediaBlob:e.mediaBlob,type:e.type,mimetype:e.mimetype,fullWidth:e.fullWidth,fullHeight:e.fullHeight}),Promise.all([g.default.createFromBase64Jpeg(e.preview),g.default.createFromData(e.mediaBlob),(0,v.getHash)(e.mediaBlob)])))).then((e=>{var[r,a,n]=e;if(t=(0,o.default)((0,o.default)({},t),{},{preview:r,mediaBlob:a,renderableUrl:a.url(),mediaStage:_.MEDIA_DATA_STAGE.RESOLVED,filehash:n}),n===this.mediaData.filehash)return Promise.resolve();this.mediaData.set(t)}))}triggerImageUpdate(){var e=this;return(0,s.default)((function*(){if(e.fetchedFromServer&&e.mediaUrl){e.mediaData||e.addChild("mediaData",new h.default({mediaStage:_.MEDIA_DATA_STAGE.PREPARING}));var t=T(e.mediaUrl),r=yield E.default.get(t);if(r)return e._processAndUpdateMediaData(r);var a={delay:({taskDuration:e})=>{var t=1e3*S();return Math.max(t-e,0)},signal:(new l.default).signal,retries:10};return(0,d.default)(a,(t=>(0,m.fetchMedia)(e.mediaUrl).then((e=>e&&e.status>=200&&e.status<300?e:t(new f.CatalogImageDownloadError))))).then((r=>{var a=r.result;E.default.put(t,a),e._processAndUpdateMediaData(a)})).catch((()=>{__LOG__(3)(y(),e.mediaUrl),e.mediaData.set({mediaStage:_.MEDIA_DATA_STAGE.ERROR_MISSING})}))}}))()}markOld(){this.old=!0}evictFromCache(){if(this.mediaUrl){var e=T(this.mediaUrl);E.default.del(e)}}}b.Proxy="productImage";var A=(0,c.defineModel)(b);t.default=A},11318:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.ProductImageCollection=void 0;var n=a(r(54019)),i=a(r(55316));class s extends n.default{toArray(){return super.filter((e=>e.old?(this.remove(e),!1):e))}}t.ProductImageCollection=s,s.model=i.default;var o=s;t.default=o},42809:(e,t,r)=>{"use strict";var a=r(14859),n=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.INVALID_PRODUCT_TOKEN=void 0;var i=n(r(61247)),s=r(65468),o=a(r(77865)),u=r(8125),l=a(r(38350)),d=r(72571),c=a(r(72424)),f="DELETED";t.INVALID_PRODUCT_TOKEN=f;var p=["ERROR","SUCCESS"];class h extends i.default{constructor(...e){super(...e),this.id=(0,i.prop)(),this.catalogId=(0,i.prop)(),this._productsLoadingStatus=(0,i.session)(),this._productList=(0,i.session)(),this._products=(0,i.session)()}initialize(){super.initialize(),this.productCollection=new l.default,this._productsLoadingStatus=new Map,this.listenTo(this,"change:_products",this.triggerProductUpdate),this.listenTo(this,"change:stale",this.resetProductLoadingStatus),this.triggerProductUpdate()}triggerProductUpdate(){null!=this._products&&(this._products.forEach((e=>{var t=this._getFetchStatus(e);this.setProductLoadingStatus(e.id,t),"DELETED"!==e.status&&"ERROR"!==t&&this.productCollection.add((0,u.mapProductResponseToModel)(e,this.catalogId),{merge:!0})})),this._products=void 0)}resetProductLoadingStatus(){this.stale&&(this._productsLoadingStatus=new Map)}getNextProductBatchToLoad(){var e=this.getPageSize(),t=this._productList.productSections.reduce(((e,{products:t})=>[...e,...t.map((({productId:e})=>e)).filter(Boolean).filter((e=>"NONE"===this.getProductLoadingStatus(e)))]),[]).slice(0,e);return t.forEach((e=>this.setProductLoadingStatus(e,"PENDING"))),t}getPageSize(){var e=c.default.webProductListMessagePageSize||d.PRODUCT_PAGE_SIZE,t=this.getProductSize();return t<3*e?t:2*e}getProductSize(){return this._productList.productSections.reduce(((e,{products:t})=>e+t.length),0)}setProductLoadingStatus(e,t){this._productsLoadingStatus.set(e,t)}getProductLoadingStatus(e){return this._productsLoadingStatus.get(e)||"NONE"}getTotalProductsFetchedOrFailed(){return Array.from(this._productsLoadingStatus).filter((([e,t])=>p.includes(t))).length}getProductList(){return this._productList}getSections(){return this._productList.productSections}getSectionsCount(){return this._productList.productSections.reduce(((e,{title:t})=>null!=t&&""!==t?e+1:e),0)}isFetching(){var e=!1;return this._productsLoadingStatus.forEach((t=>{"PENDING"===t&&(e=!0)})),e}_getFetchStatus(e){return e.status===f||!e.image_cdn_urls||e.image_cdn_urls[0].value.includes(s.STATIC_WHATSAPP_IMAGE_URI)?"ERROR":"SUCCESS"}}h.Proxy="product_list",h.idClass=o.default;var _=(0,i.defineModel)(h);t.default=_},90567:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.ProductMessageListCollection=void 0;var n=a(r(54019)),i=r(93649),s=a(r(42809)),o=r(75637);class u extends n.default{_queryProductList(e){var t=e.catalogId;return(0,i.queryProductList)(t,e.getNextProductBatchToLoad()).then((t=>({id:e.id,_products:t,fetchedFromServer:!0})))}_findQuery(e){var t=this.get(e);return null==t?Promise.resolve({id:e}):this._queryProductList(t)}_find(e){return this._findQuery(e)}getOrAdd(e,t,r){var a=this.get(e);if(null!=a)return a;if(null==r)return null;var n=(0,o.createWid)(r);return null!=(a=this.add({id:e,catalogId:n,_productList:t})[0])?a:null}}t.ProductMessageListCollection=u,u.model=s.default,u.staleCollection=!0;var l=new u;t.default=l},72571:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PRODUCT_PAGE_SIZE=void 0;t.PRODUCT_PAGE_SIZE=6},27886:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PROFILE_PIC_COMMAND=void 0;var r=Object.freeze({REMOVE:"remove",SET:"set"});t.PROFILE_PIC_COMMAND=r},22315:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.FALLBACK=void 0;var i=n(r(70417)),s=n(r(19976)),o=a(r(61247)),u=n(r(50935)),l=r(95595),d=n(r(18120)),c=n(r(74185)),f=n(r(68384)),p=n(r(58906));function h(){var e=(0,s.default)(["Assertion failed!"]);return h=function(){return e},e}var _={SINGLE:"SINGLE",GROUP:"GROUP"};t.FALLBACK=_;class m extends o.default{constructor(...e){super(...e),this.id=(0,o.prop)(),this.token=(0,o.prop)(),this.tag=(0,o.prop)(),this.raw=(0,o.prop)(),this.eurl=(0,o.prop)(),this.previewEurl=(0,o.prop)(),this.stale=(0,o.session)(!0),this.eurlStale=(0,o.session)(!1),this.pendingPic=(0,o.session)(),this.img=(0,o.derived)(this._img,["tag","raw","stale","eurl","eurlStale","previewEurl"]),this.imgFull=(0,o.derived)(this._imgFull,["tag","raw","stale","eurl","eurlStale"]),this.fallbackType=(0,o.derived)(this._fallbackType,["id"])}_img(){return this.raw?"data:image/jpeg;base64,"+this.raw:!this.tag&&this.stale?null:this.tag?d.default.supportsFeature(d.default.F.MD_BACKEND)?this.previewEurl:this.generateUrl("s"):void 0}_imgFull(){return!this.raw&&this.tag||!this.stale?!this.raw&&this.tag?d.default.supportsFeature(d.default.F.MD_BACKEND)?this.eurl:this.generateUrl("l"):void 0:null}_fallbackType(){return f.default.isUser(this.id)?_.SINGLE:(f.default.isGroup(this.id),_.GROUP)}markStale(e){this.stale=!0,e&&e.eurl&&(this.eurlStale=!0)}validate(){if(this.stale||this.eurlStale)return this.getCollection().update(this.id)}generateUrl(e){var t={t:e,u:this.id.toString(),i:this.tag||"",n:this.token||""};return this.token||(__LOG__(4,void 0,new Error,!0)(h()),SEND_LOGS("profilePicThumb::generateUrl: empty token for profile pic")),p.default.alive&&this.eurl&&!this.eurlStale&&(t=(0,i.default)({e:this.eurl},t)),c.default.build(u.default.PP_URL,t)}canSet(){if(f.default.isGroup(this.id)){var e=r(43334).default.get(this.id);return!(e&&e.groupMetadata&&e.groupMetadata.participants.iAmRestrictedMember())}return!!this.id.equals((0,l.getMaybeMeUser)())}canDelete(){if(f.default.isGroup(this.id)&&this.tag){var e=r(43334).default.assertGet(this.id);return!(e&&e.groupMetadata&&e.groupMetadata.participants.iAmRestrictedMember())}return!(!this.id.equals((0,l.getMaybeMeUser)())||!this.tag)}getCollection(){return r(15118).default}}m.Proxy="profilePicThumb",m.idClass=f.default;var g=(0,o.defineModel)(m);t.default=g},15118:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.ProfilePicThumbCollection=void 0;var i=n(r(19976)),s=n(r(45455)),o=a(r(54019)),u=n(r(52737)),l=r(19741),d=a(r(96452)),c=r(95595),f=n(r(18120)),p=n(r(68560)),h=r(27886),_=r(85619),m=n(r(22315)),g=r(84990),v=n(r(68384)),E=r(75637);function y(){var e=(0,i.default)(["ProfilePicThumbStore:resyncPictures dropped: ",""]);return y=function(){return e},e}function S(){var e=(0,i.default)(["ProfilePicThumbStore:resyncPictures dropped: ",""]);return S=function(){return e},e}function T(){var e=(0,i.default)(["ProfilePicThumbStore:resyncPictures blocked ",""]);return T=function(){return e},e}function b(){var e=(0,i.default)(["ProfilePicThumbStore:resyncPictures success"]);return b=function(){return e},e}function A(){var e=(0,i.default)(["models:profilePic:cache-save: ",""]);return A=function(){return e},e}class C extends o.default{get(e){var t=super.get(e);if(!this.modelClass.prototype.isIdType(e))return t;var r=super.get((0,p.default)(e.toString()));if(r){if(this.remove(r,{silent:!0}),t&&t.tag)return t;var a=r.toJSON();return a.id=e,this.add(a,{silent:!0,merge:!0})[0]}return t||void 0}saveToCache(){if(u.default.shouldSaveToCache()){var e=C.cachePolicy.id,t=this.filter((e=>v.default.isWid(e.id)&&!!e.eurl&&!!e.token));t=t.map((function(e){var t=e.toJSON();return t.id=(0,p.default)(t.id.toString()),t})),__LOG__(2)(A(),String(e)),(0,c.setCollection)(e,t)}}initializeFromCache(e){if(this.length&&e){var t=this.reduce(((e,t)=>(e[(0,p.default)(t.id.toString())]=t.id.toString(),e)),new Object);if(!(0,s.default)(t)){var r=e.reduce(((e,r)=>(t[r.id]&&(r.id=(0,E.createWid)(t[r.id]),r.stale=!0,r.token&&e.push(r)),e)),[]);this.add(r,{merge:!0})}}}onResume(){var e=this.filter((e=>{var t=r(43334).default.get(e.id);return e.hasObservers()&&e.stale&&(v.default.isUser(e.id)||v.default.isGroup(e.id))&&!(t&&t.isReadOnly)})).map((e=>(e.tag||e.unset("tag",{silent:!0}),e)));this.resyncPictures(e)}_find(e){var t=r(43334).default.get(e);if(t&&t.isReadOnly)return f.default.supportsFeature(f.default.F.MD_BACKEND)?Promise.resolve({id:e,stale:!0}):(0,_.profilePicFindThumbFromPhone)(e,this.get(e)).then((e=>(e.tag||e.raw||(e.eurl=null,e.tag=null,e.raw=null,e.eurlStale=!1),e))).catchType(d.ProtoVersionUndefined,(()=>({id:e,stale:!0})));if(v.default.isUser(e)||v.default.isGroup(e)){var a={id:e};return(0,_.profilePicFind)(e).then((e=>(a.tag=e.tag,a.raw=null,a.eurl=e.eurl,a.eurlStale=!1,a.token=e.token,f.default.supportsFeature(f.default.F.MD_BACKEND)&&(a.previewEurl=e.previewEurl),a))).catchType(l.ServerStatusCodeError,(e=>{switch(e.status){case 401:a.tag="",a.raw=void 0;break;case 423:case 429:a.stale=!0;break;default:a.tag=null,a.eurl=null,a.eurlStale=!1}return Promise.resolve(a)})).catchType(l.WebdDrop,(function(){return{id:e,stale:!0}}))}return Promise.resolve({id:e,tag:null})}imageChanged(e,t){var r=this.get(e);r&&(t===h.PROFILE_PIC_COMMAND.REMOVE?r.set({tag:void 0,eurl:void 0}):t!==h.PROFILE_PIC_COMMAND.SET&&r.tag===t||this.update(r.id).catchType(l.WebdDrop,(()=>{})))}resyncPictures(e){return 0===e.length?Promise.resolve():(0,_.profilePicResync)(e.map((function(e){return{id:e.id,tag:e.tag}}))).then((t=>{__LOG__(2)(b()),t.forEach((t=>{var r=this.get(t.id);r&&r.set({tag:t.tag,token:t.token,raw:void 0,stale:!1,eurl:t.eurl,eurlStale:!1,previewEurl:t.previewEurl}),e.forEach((e=>{e.eurlStale&&this.update(e.id)})),e.forEach((e=>{e.stale=!1}))}))})).catchType(l.WebdDrop,(()=>{})).catchType(l.ServerStatusCodeError,(e=>{423===e.status||429===e.status?__LOG__(3)(T(),e.status):e.status>=400&&__LOG__(3)(S(),String(e))})).catch((function(e){__LOG__(3)(y(),String(e))}))}findThumbnailWid(e){return e.find((e=>{var t;return null===(t=this.get(e))||void 0===t?void 0:t.img}))}getThumbnailWidFromVcard(e){if(!e)return null;var t=(0,g.vcardWids)(e);if(t){var r=this.findThumbnailWid(t);return r||(t.length?t[0]:null)}}}t.ProfilePicThumbCollection=C,C.model=m.default,C.staleCollection=!0,C.resumeOnAvailable=!0,C.cachePolicy={id:"profile_pic_thumb",trigger:"change:tag change:raw",policy:o.CACHE_POLICY.LOAD,delay:5e3};var P=new C;t.default=P},94077:(e,t,r)=>{"use strict";var a=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(61247));class i extends n.default{constructor(...e){super(...e),this.id=(0,n.prop)(),this.shortcut=(0,n.prop)(),this.message=(0,n.prop)(),this.count=(0,n.prop)(),this.keywords=(0,n.prop)(),this.pendingCount=(0,n.session)(0),this.totalCount=(0,n.derived)(this._totalCount,["count","pendingCount"])}_totalCount(){return this.count+this.pendingCount}useOnce(){this.pendingCount+=1,this.getCollection().periodicFlush()}getCollection(){return r(75537).default}}i.Proxy="quickReply";var s=(0,n.defineModel)(i);t.default=s},75537:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.QuickReplyCollection=void 0;var n=r(39329),i=a(r(54019)),s=r(19741),o=a(r(18120)),u=a(r(94077)),l=a(r(76022));class d extends i.default{constructor(...e){super(...e),this.checksum=void 0,this.flushCountsTimer=new n.ShiftTimer((()=>{this.hasPendingCounts()&&this.flushCounts()})),this.sortQuickReply=(e,t)=>e.totalCount===t.totalCount?e.id<t.id?-1:1:e.totalCount>t.totalCount?-1:1,this.onCountsFlushed=({id:e,count:t})=>{var r=this.get(e);r&&(r.count=t,r.pendingCount=0)}}delete(){super.delete(),delete this.checksum}filterShortcuts(e){return this.filter((({shortcut:t})=>t.toLowerCase().startsWith(e.toLowerCase()))).sort(this.sortQuickReply)}sync(e){o.default.supportsFeature(o.default.F.QUICK_REPLIES_QUERY)&&(this.synced()&&this.checksum===e?this.hasPendingCounts()&&this.flushCounts():this.findQuery({}).catchType(s.WebdDrop,(()=>{})))}periodicFlush(){o.default.supportsFeature(o.default.F.QUICK_REPLIES_QUERY)&&this.flushCountsTimer.debounceAndCap(2e3,5e3)}updateChecksum(e){this.checksum=e}synced(){return void 0!==this.checksum}hasPendingCounts(){return this.some((({pendingCount:e})=>e>0))}getAllPendingCounts(){var e={};return this.forEach((({id:t,pendingCount:r})=>{r>0&&(e[t]=r)})),e}flushCounts(){var e=this.getAllPendingCounts();l.default.flushQuickReplyCounts(e).then((t=>{t.checksum&&this.updateChecksum(t.checksum),t.data.filter((({id:t})=>void 0!==e[t])).forEach(this.onCountsFlushed)})).catchType(s.WebdDrop,(()=>{}))}_findQuery(){var e=this.getAllPendingCounts();return l.default.queryQuickReplies(e).then((t=>(t.checksum&&this.updateChecksum(t.checksum),t.data.filter((({id:t})=>void 0!==e[t])).forEach(this.onCountsFlushed),t.data)))}handle(e){e.checksum&&this.updateChecksum(e.checksum);var t=[],r=[];e.quickReplies.forEach((e=>{"delete"===e.type?t.push(e):r.push(e)})),this.remove(t.map((({id:e})=>e))),this.add(r,{merge:!0})}}t.QuickReplyCollection=d,d.model=u.default;var c=new d;t.default=c},89526:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.isUnviewed=function(e){return!l(e)&&!d(e)},t.isViewed=l,t.isExpired=d,t.VIEW_ONCE_EXPIRE_AFTER=void 0;var n=a(r(19899)),i=a(r(50935)),s=r(64658),o=1209600;function u(e){var t=(0,s.unproxy)(e);return null!=t?t.asViewOnce:null}function l(e){var t;return(null===(t=u(e))||void 0===t?void 0:t.ack)===i.default.ACK.PLAYED}function d(e){var t=u(e);if(null==t)return!1;var r=n.default.globalUnixTime()-(0,s.unproxy)(t).t;return!l(t)&&r>=o}t.VIEW_ONCE_EXPIRE_AFTER=o},72424:(e,t,r)=>{"use strict";var a=r(14859),n=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.ServerProps=void 0;var i=n(r(61247)),s=a(r(79711)),o=a(r(40210)),u=r(72571),l=r(56783),d=a(r(99340)),c=a(r(18120)),f={imageMaxKBytes:function(e){if("number"==typeof e&&e>0)return 1024*e},maxParticipants:function(e){if("number"==typeof e&&e>0)return e-1},media:h,maxFileSize:h,groupDescLength:_,googleMapsDoNotAuth:m,googleMapsKeyless:m,frequentlyForwardedMessages:m,frequentlyForwardedGroupSetting:m,quickMessageSearch:m,ephemeralMessagesSetting:m,ephemeralMessages:m,ephemeralPruning:m,statusVideoMaxDuration:_,muteAlways:m,viewOnceRead:m,viewOnceWrite:m,ctwaContextRender:m,serverPropsVersion:_,newCommerceEntryPointEnabled:m,wallpapersV2:m,hfmStringChanges:m,bspUi:m,webServerStickerPanel:m};class p extends i.default{constructor(...e){super(...e),this.serverPropsVersion=(0,i.prop)(),this.gifSearch=(0,i.prop)(!1),this.imageMaxEdge=(0,i.prop)(1600),this.imageMaxKBytes=(0,i.prop)(1048576),this.maxParticipants=(0,i.prop)(101),this.maxSubject=(0,i.prop)(25),this.media=(0,i.prop)(16777216),this.maxFileSize=(0,i.prop)(104857600),this.groupDescLength=(0,i.prop)(0),this.googleMapsDoNotAuth=(0,i.prop)(!0),this.googleMapsKeyless=(0,i.prop)(!1),this.multicastLimitGlobal=(0,i.prop)(5),this.frequentlyForwardedMessages=(0,i.prop)(!1),this.frequentlyForwardedThreshold=(0,i.prop)(5),this.frequentlyForwardedMax=(0,i.prop)(1),this.frequentlyForwardedGroupSetting=(0,i.prop)(!1),this.quickMessageSearch=(0,i.prop)(!1),this.ephemeralMessagesSetting=(0,i.prop)(!1),this.ephemeralMessages=(0,i.prop)(!0),this.ephemeralPruning=(0,i.prop)(!0),this.ephemeralMessagesAllowedValues=(0,i.prop)("604800"),this.stickerSearchEnabled=(0,i.prop)(!1),this.productMediaAttachments=(0,i.prop)(!1),this.muteAlways=(0,i.prop)(!1),this.viewOnceRead=(0,i.prop)(!1),this.viewOnceWrite=(0,i.prop)(!1),this.wallpapersV2=(0,i.prop)(!1),this.hfmStringChanges=(0,i.prop)(!1),this.mmsVCacheAggregationEnabled=(0,i.prop)(!1),this.mmsHotContentTimespan=(0,i.prop)(0),this.mmsCatV1ForwardHotOverrideEnabled=(0,i.prop)(!1),this.pttPlaybackSpeedEnabled=(0,i.prop)(!1),this.pttPlaybackSpeedHideDelay=(0,i.prop)(1500),this.templateDocMimeTypes=(0,i.prop)(1),this.mmsMediaKeyTTL=(0,i.prop)(1/0),this.vcardAsDocumentSizeKb=(0,i.prop)(0),this.vcardMaxSizeKb=(0,i.prop)(1e3),this.mmsVcardAutodownloadSizeKb=(0,i.prop)(1024),this.webUploadDocumentThumbMmsEnabled=(0,i.prop)(!1),this.webDownloadDocumentThumbMmsEnabled=(0,i.prop)(!1),this.webSendDocumentThumbInMessageDisabled=(0,i.prop)(!1),this.webUploadLinkThumbMmsEnabled=(0,i.prop)(!1),this.webDownloadLinkThumbMmsEnabled=(0,i.prop)(!1),this.webVoipInternalTester=(0,i.prop)(!1),this.webVoip=(0,i.prop)(!1),this.groupCallMaxParticipants=(0,i.prop)(0),this.statusVideoMaxDuration=(0,i.prop)(30),this.webVoipMacOsMinVersion=(0,i.prop)(""),this.webVoipWindowsOsMinVersion=(0,i.prop)(""),this.ctwaContextRender=(0,i.prop)(!1),this.ctwaContextCompose=(0,i.prop)(!1),this.syncdInlineMutationsMaxCount=(0,i.prop)(1e3),this.syncdPatchProtobufMaxSize=(0,i.prop)(100),this.syncdKeyMaxUseDays=(0,i.prop)(30),this.syncdWaitForKeyTimeoutDays=(0,i.prop)(7),this.syncdAdditionalMutations=(0,i.prop)(1),this.syncdAntiTamperingFatalExceptionEnabled=(0,i.prop)(!1),this.syncdSentinelTimeoutSeconds=(0,i.prop)(3),this.syncdPatchDeviceIndexIncluded=(0,i.prop)(!1),this.webBizProfileOptions=(0,i.prop)(3),this.webBizProfileEdit=(0,i.prop)(!1),this.mdBlocklistV2=(0,i.prop)(!1),this.newCommerceEntryPointEnabled=(0,i.prop)(!1),this.webShopsChatHeaderButtonEnabled=(0,i.prop)(!1),this.shopsProfileDrawerEntrypoint=(0,i.prop)(!1),this.bspSystemMessageEnabled=(0,i.prop)(!1),this.bspUi=(0,i.prop)(!1),this.webMediaCustomCroppingEnabled=(0,i.prop)(!1),this.webListMessage=(0,i.prop)(!1),this.webCart=(0,i.prop)(!1),this.webCartV11OrderMessageChanges=(0,i.prop)(!1),this.webButtonsMessage=(0,i.prop)(!1),this.webCatalogApiREH=(0,i.prop)(!1),this.greenAlertBannerDuration=(0,i.prop)(0),this.webSMBUpsellInBizProfile=(0,i.prop)(!1),this.webProductListMessageFallback=(0,i.prop)(!1),this.webProductListMessage=(0,i.prop)(!1),this.webProductListMessageRenderKillSwitch=(0,i.prop)(!1),this.webProductListMessagePageSize=(0,i.prop)(u.PRODUCT_PAGE_SIZE),this.webCatalogProductsOnOff=(0,i.prop)(!1),this.webYouTubePlayerEnhancements=(0,i.prop)(!1),this.webServerStickerPanel=(0,i.prop)(!1),this.webCollectionsDisplay=(0,i.prop)(!1)}delete(){super.delete(),this.updateProps({})}initialize(){super.initialize()}set(e,t,r){if("string"==typeof e)(0,l.setServerPropInElectron)(e,t);else{var a=e,n=t;Object.keys(a).forEach((e=>{var t=a[e];(null==n?void 0:n.merge)&&void 0===t||(0,l.setServerPropInElectron)(e,t)}))}return super.set(e,t,r)}updateProps(e){var t=e;for(var r in o.default.Global.webcBucket=t.bucket||null,this.__props.forEach((e=>{var r=t[e];void 0===r?r="serverPropsVersion"===e?this.serverPropsVersion:this.getDefault(e):f[e]&&void 0===(r=f[e](r))&&(r=this.getDefault(e)),this.set(e,r)})),c.default.F)void 0!==t[r]&&c.default.setFeature(r,t[r]);s.default.serverPropsUpdated()}updateSelectiveProps(e){var t=e;for(var r in o.default.Global.webcBucket=t.bucket||null,this.__props.forEach((e=>{var r=t[e];void 0!==r&&(f[e]&&void 0===(r=f[e](r))&&(r=this.getDefault(e)),this.set(e,r))})),c.default.F)void 0!==t[r]&&c.default.setFeature(r,e[r]);s.default.serverPropsUpdated()}extendAndOverrideFromURLParams(e){var t=new d.default(window.location.search),r=e;return this.__props.forEach((e=>{var a="".concat("sp_").concat(e);if(!0===t.has(a)){var n=t.get(a);if(null==n)return;"true"===n||"false"===n?r[e]="true"===n:isNaN(n)||isNaN(parseFloat(n))?r[e]=n:r[e]=parseFloat(n)}})),r}handlePayload(e){"number"==typeof e.status&&e.status>=400||this.updateProps(e)}handle(e){var t=e.shift();this.handlePayload(t)}getWebVoipInternalTester(){return this.webVoipInternalTester}getWebVoip(){return this.webVoip}getGroupCallMaxParticipants(){return this.groupCallMaxParticipants}getEphemeralMessagesAllowedValues(){return this.ephemeralMessagesAllowedValues.split(",").map((e=>parseInt(e,10)))}}function h(e){if("number"==typeof e&&e>0)return 1024*e*1024}function _(e){if("number"==typeof e&&e>0)return e}function m(e){if("number"==typeof e)return!!e}t.ServerProps=p,p.Proxy="serverProps";var g=new((0,i.defineModel)(p))({id:"1"});t.default=g},2734:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(r(19976)),s=a(r(61247)),o=r(19741),u=r(75459);function l(){var e=(0,i.default)([""," failed with error: ",""]);return l=function(){return e},e}function d(){var e=(0,i.default)([""," dropped"]);return d=function(){return e},e}function c(){var e=(0,i.default)([""," error receive status code ",""]);return c=function(){return e},e}function f(){var e=(0,i.default)([""," success"]);return f=function(){return e},e}function p(){var e=(0,i.default)(["",""]);return p=function(){return e},e}function h(){var e=(0,i.default)(["Settings: received empty settings"]);return h=function(){return e},e}function _(){var e=(0,i.default)(["Settings:handleResponse archive settings response is unsupported"]);return _=function(){return e},e}function m(){var e=(0,i.default)(["Settings: received setting type : ",""]);return m=function(){return e},e}var g={classic:!1,enabled:!1};class v extends s.default{constructor(...e){super(...e),this.id=(0,s.prop)(),this.archive=(0,s.prop)(),this.showArchiveV2=(0,s.derived)(this._showArchiveV2,["archive","enabled"])}delete(){this.set({archive:g}),super.delete()}_showArchiveV2(){return!!this.archive.enabled&&!this.archive.classic}handleResponse(e){e.length?e.forEach((e=>{switch(__LOG__(2)(m(),e.type),e.type){case"Archive":var t;if(!(0,u.archiveV2Supported)()){__LOG__(4,void 0,new Error,!0)(_()),SEND_LOGS("archive-setting-unsupported");break}this.set({archive:{classic:e.value.classic,enabled:null!==(t=e.value.enabled)&&void 0!==t?t:this.archive.enabled}})}})):__LOG__(2)(h())}sync(e){var t="Settings:sync".concat(e?" resume":"");return __LOG__(2)(p(),t),(0,r(76022).default.querySettings)(e).then((e=>{200===e.status?(__LOG__(2)(f(),t),this.handleResponse(e.settings)):__LOG__(3)(c(),t,e.status)})).catchType(o.WebdDrop,(function(){__LOG__(3)(d(),t)})).catch((e=>{__LOG__(4,void 0,new Error,!0)(l(),t,e),SEND_LOGS("settings-query-failed")}))}}v.Proxy="settings";var E=new((0,s.defineModel)(v))({id:"default_settings_id",archive:g});t.default=E},72852:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(r(19976)),s=n(r(74186)),o=n(r(29036)),u=n(r(90882)),l=n(r(54019)),d=n(r(18120)),c=n(r(27e3)),f=n(r(58885)),p=a(r(12767));function h(){var e=(0,i.default)(["starred gif msgs sync error: "]);return h=function(){return e},e}class _ extends l.default{constructor(){super(),this.syncPromise=null,this.isSynced=!1,this.listenTo(p.default,"change:stream",(()=>{p.default.stream===p.STREAM.DISCONNECTED&&(this.isSynced=!1)}))}onResume(){this.isSynced=!1,this.sync()}maySync(){return d.default.supportsFeature(d.default.F.STARRED_GIFS)}sync(){return this.isSynced?Promise.resolve():this.syncPromise?this.syncPromise:this.maySync()?(this.syncPromise=f.default.getStarred(void 0,void 0,void 0,!0).then((e=>{var t=[];e&&e.length&&(t=(0,u.default)(e,(e=>e&&e.isGif&&!e.isUnsentMedia))),this.set(t)})).catch((e=>{499!==e&&__LOG__(3)(h())})).finally((()=>{this.syncPromise=null,this.isSynced=!0})),this.syncPromise):Promise.resolve()}add(e,t){if(!e||!this.maySync()||!this.isSynced)return[];var r=this.isModel(e)?[e]:e;return r=(0,o.default)((0,u.default)(r,(e=>e.isGif)),this.toArray(),((e,t)=>e.body===t.body)),super.add(r,t)}remove(e,t){if(!e||!this.maySync()||!this.isSynced)return[];var r=this.isModel(e)?[e]:e;return r=(0,s.default)((0,u.default)(r,(e=>e.isGif)),this.toArray(),((e,t)=>e.body===t.body)),super.remove(r,t)}}_.model=c.default,_.comparator=function(e,t){return t.t-e.t};var m=new _;t.default=m},63095:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.addStarredMsgs=function(e){i.add(e),e.forEach((e=>{e.chat.starredMsgs&&e.chat.starredMsgs.add(e)})),f.default.add(e)},t.removeStarredMsgs=g,t.default=t.StarredMsgCollection=void 0;var i,s=n(r(19976)),o=n(r(54019)),u=n(r(50935)),l=n(r(27e3)),d=n(r(58885)),c=n(r(61941)),f=n(r(72852)),p=a(r(12767));function h(){var e=(0,s.default)(["models:starred:update:error: "]);return h=function(){return e},e}function _(){var e=(0,s.default)(["starred msg sync error: "]);return _=function(){return e},e}class m extends o.default{constructor(){super(),this.syncPromise=null,this.isSynced=!1,this.listenTo(p.default,"change:stream",(()=>{p.default.stream===p.STREAM.DISCONNECTED?this.isSynced=!1:p.default.stream===p.STREAM.CONNECTED&&this.delete()}))}process(e,t,r,a){a?this.delete():this.updateMsgs(e,t,r)}sync(e){if(this.isSynced)return Promise.resolve();if(null!=this.syncPromise)return this.syncPromise;var t,r=this,a=this.last();return a&&(t=a.id),this.syncPromise=d.default.getStarred(e,u.default.PAGE_SIZE,t).then((function(e){e.length&&r.add(e,{silent:!0}),e.length<u.default.PAGE_SIZE&&(r.isSynced=!0)})).catch((function(){__LOG__(3)(_())})).finally((()=>{r.syncPromise=null,r.trigger("sync")})),this.trigger("sync"),(0,c.default)(this.syncPromise,"syncPromise can not be null")}updateMsgs(e,t,r){var a=this.syncPromise||Promise.resolve();this.syncPromise=a.then((()=>e?(t.length>0?d.default.incrementalStarredUpdate(t):Promise.resolve([])).then((e=>{var t=e.concat(r);this.isSynced&&(this.add(t,{silent:!0}),f.default.add(e)),t.forEach((e=>{e.chat.starredMsgs&&e.chat.starredMsgs.add(e)})),this.trigger("sync")})).catch((()=>{__LOG__(3)(h())})):(g(t.concat(r).filter((e=>!e.star))),Promise.resolve()))).finally((()=>{this.syncPromise=null}))}delete(){this.isSynced=!1,super.delete()}}function g(e){i.remove(e),e.forEach((e=>{e.chat.starredMsgs&&e.chat.starredMsgs.remove(e)}))}t.StarredMsgCollection=m,m.model=l.default,m.comparator=(e,t)=>t.t-e.t;var v=i=new m;t.default=v},42382:(e,t,r)=>{"use strict";var a=r(14859),n=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(r(61247)),s=a(r(68384));class o extends i.default{constructor(...e){super(...e),this.id=(0,i.prop)(),this.status=(0,i.prop)(),this.stale=(0,i.session)(!0)}getCollection(){return r(76019).default}}o.Proxy="status",o.idClass=s.default;var u=(0,i.defineModel)(o);t.default=u},76019:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.StatusCollection=void 0;var n=a(r(54019)),i=r(19741),s=a(r(42382)),o=r(96911),u=a(r(68384)),l=r(75637);class d extends n.default{onResume(){this.filter((e=>e.hasObservers())).forEach((e=>{this.find(e.id).catchType(i.WebdDrop,(()=>{}))}))}_find(e){var t=e instanceof u.default?e:(0,l.createWid)(e);return(0,o.getStatus)(t)}handle([e]){var t=this.get(e.id);t&&(t.status=e.status,t.stale=!1)}}t.StatusCollection=d,d.model=s.default,d.idClass=u.default,d.staleCollection=!0,d.resumeOnAvailable=!0;var c=new d;t.default=c},282:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(19976)),i=a(r(25337)),s=r(61247),o=a(r(19899)),u=a(r(50935)),l=a(r(7470)),d=r(6829),c=a(r(73298)),f=a(r(68384));function p(){var e=(0,n.default)(["Status V3 onEmptyMRM with total count: ",", noEarlierMsgs: ",""]);return p=function(){return e},e}function h(){var e=(0,n.default)(["Status v3 deleted with total count: ",""]);return h=function(){return e},e}function _(){var e=(0,n.default)(["Bad status v3 read count, ",", ",""]);return _=function(){return e},e}class m extends c.default{constructor(...e){super(...e),this.id=(0,s.prop)(),this.t=(0,s.prop)(),this.unreadCount=(0,s.prop)(0),this.totalCount=(0,s.prop)(0),this.pic=(0,s.prop)(),this._msgs=(0,s.prop)((()=>[])),this.readKeys=(0,s.session)((()=>({}))),this.contact=(0,s.session)(),this.expireTimer=(0,s.session)(),this.expireTs=(0,s.session)(),this.hasUnread=(0,s.derived)(this._hasUnread,["unreadCount"]),this.readCount=(0,s.derived)(this._readCount,["unreadCount","totalCount"]),this.lastStatus=(0,s.derived)(this._lastStatus,["msgsChanged","totalCount"])}_hasUnread(){return this.unreadCount>0}_readCount(){var e=this.totalCount-this.unreadCount;return Number.isFinite(e)?e:(__LOG__(3)(_(),this.totalCount,this.unreadCount),0)}_lastStatus(){return this.msgs.last()}initialize(){super.initialize(),this.addChild("contact",l.default.gadd(this.id)),this.listenTo(this.msgs,"add bulk_add",(()=>{window.setTimeout((()=>{this.setupStatusExpiration()}))})),this.listenTo(this,"change:lastStatus",(()=>{this.lastStatus&&(this.t=this.lastStatus.t)}))}setupStatusExpiration(){var e=this.msgs.at(0);if(e&&!("number"==typeof this.expireTs&&this.expireTs<=e.t)){var t=e.t+86400+1;t<o.default.globalUnixTime()?window.setTimeout((()=>{this.expireMsg()})):(this.expireTimer=i.default.setGlobalTimeout(this.expireMsg.bind(this),1e3*t,this.expireTimer),this.expireTs=e.t)}}expireMsg(){for(var e=this.msgs;e.length>0;){var t=e.at(0);if(!t)break;if(t.t+86400>o.default.globalUnixTime())break;this.unreadCount>this.totalCount-1&&this.unreadCount--,this.totalCount--,e.remove(t),t.delete()}this.expireTs=void 0,this.expireTimer=void 0,0!==this.totalCount&&this.setupStatusExpiration()}delete(){__LOG__(2)(h(),this.totalCount),super.delete(),this.expireTimer&&i.default.clearTimeout(this.expireTimer),null!=this.expireTs&&(this.expireTs=void 0),this.getCollection().remove(this.id)}onEmptyMRM(){__LOG__(2)(p(),this.totalCount,this.msgs.msgLoadState.noEarlierMsgs?"true":"false"),this.msgs.msgLoadState.noEarlierMsgs&&0===this.totalCount?this.delete():this.totalCount>0&&this.loadMore().catch((()=>{})).finally((()=>{this.msgs.length||this.delete()}))}loadMore(e=u.default.PAGE_SIZE){if(this.msgs.msgLoadState.noEarlierMsgs)return Promise.resolve();if(this.msgs.msgLoadState.isLoadingEarlierMsgs)return this.msgs.loadEarlierPromise;var t=0!==e?e:u.default.PAGE_SIZE;return this.getCollection().loadMore(this.id,t,this.msgs.last()).then((e=>(Array.isArray(e)&&e.length<t&&(this.msgs.msgLoadState.noEarlierMsgs=!0),e))).catch((e=>(404===e&&this.delete(),Promise.reject(e))))}handleReadStatus(e){this.readKeys[e]||(this.readKeys[e]=!0,this.unreadCount>0&&this.unreadCount--)}sendReadStatus(e,t){return(0,d.sendReadStatus)(e,t).then((t=>{t&&this.handleReadStatus(e)}))}getCollection(){return r(57185).default}}m.Proxy="statusV3",m.idClass=f.default;var g=(0,s.defineModel)(m);t.default=g},57185:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.StatusV3Collection=void 0;var n=a(r(19976)),i=a(r(45455)),s=a(r(90882)),o=a(r(16760)),u=a(r(94030)),l=a(r(54019)),d=a(r(19899)),c=a(r(50935)),f=r(19741),p=r(95595),h=a(r(18120)),_=a(r(40210)),m=a(r(58885)),g=a(r(25012)),v=r(6829),E=a(r(282)),y=r(75637);function S(){var e=(0,n.default)(["models:statusV3:unknown:",""]);return S=function(){return e},e}function T(){var e=(0,n.default)(["models:statusV3:read:no_status:",""]);return T=function(){return e},e}function b(){var e=(0,n.default)(["models:statusV3:unexpected update"]);return b=function(){return e},e}function A(){var e=(0,n.default)(["models:statusV3:no_checksum"]);return A=function(){return e},e}function C(){var e=(0,n.default)(["Total count: ",", msgs length: ",""]);return C=function(){return e},e}function P(){var e=(0,n.default)(["model:statusv3:loadMore:",""]);return P=function(){return e},e}function O(){var e=(0,n.default)(["model:statusv3:findQuery error ",""]);return O=function(){return e},e}function w(){var e=(0,n.default)(["Received "," status V3 messages when total count is "," for ",""]);return w=function(){return e},e}class M extends l.default{delete(){super.delete(),delete this.checksum}_find(e){return Promise.resolve({id:e})}findQuery(e,t){return super.findQuery(e,t).then((e=>{var t=e||[];return Promise.all(t.map((e=>{if(e){var t=0;return e.msgs.forEach((r=>{t<e._msgs.length&&e._msgs[t].id.toString()===r.id.toString()?++t:r.delete()})),e._msgs.length>0?this.addStatusMessages(e.id,e._msgs):Promise.resolve()}}))).then((()=>t))}))}_findQuery(){return(0,v.queryStatusAll)().then((e=>(this.checksum=e.checksum,Promise.all(e.statuses.map((e=>{e.totalCount!==e._msgs.length&&e.totalCount<=20&&__LOG__(3)(w(),e._msgs.length,e.totalCount,e.id);var t=e.pic;return t?g.default.createFromData(t,"image/jpeg").then((t=>(e.pic=t,e))):e}))))))}loadMore(e,t,r){return(0,v.queryStatusUpdate)(e,t,r&&r.id).then((e=>e.status>=400?(__LOG__(3)(O(),e.status),Promise.reject(e.status)):(e.forEach((function(e){e.invis=!0})),__LOG__(2)(P(),e.length),m.default.processMultipleMessages((0,y.createWid)(c.default.STATUS_WID),e,{add:"after",isHistory:!0}))))}sync(e){var t=window.performance.now();return!e||this.checksum&&this.checksum!==e?this.findQuery({},{set:this.hasSynced()}).catchType(f.WebdDrop,(()=>{})).finally((()=>{this.trigger("sync")})).tap((()=>{var e=window.performance.now(),r=Math.round(e-t);this.logMetrics({type:"sync",syncTime:r}),this.forEach((e=>{e.msgs.length>e.totalCount&&__LOG__(2)(C(),e.totalCount,e.msgs.length)}))})):Promise.resolve(void 0)}logMetrics(e){var t;t="sync"===e.type?new _.default.WebcStatusSync({webcStatusSyncT:e.syncTime}):new _.default.WebcStatusSession({webcStatusSessionId:e.sessionId});var r=this.filter((e=>!e.contact.isMe)),a=r.filter((e=>!e.contact.statusMute)),n=a.filter((e=>e.hasUnread)),i=a.filter((e=>!e.hasUnread)),s=r.filter((e=>e.contact.statusMute)),o=(0,u.default)(a.map((e=>e.unreadCount))),l=(0,u.default)(a.map((e=>e.readCount))),d=(0,u.default)(s.map((e=>e.totalCount)));t.webcStatusRecentItemCount=o,t.webcStatusRecentRowCount=n.length,t.webcStatusViewedItemCount=l,t.webcStatusViewedRowCount=i.length,t.webcStatusMutedItemCount=d,t.webcStatusMutedRowCount=s.length,t.commit()}hasSynced(){return!!h.default.supportsFeature(h.default.F.MD_BACKEND)||!!this.checksum}handleUpdate(e,t,r){var a=e.id.fromMe?(0,p.getMaybeMeUser)():e.author;if(this.updateChecksum(t),this.hasSynced()){if(r)return!0;var n=this.get(a);if(n){var i=h.default.supportsFeature(h.default.F.MD_BACKEND)||n.totalCount===n.msgs.length;if("revoke"===e.subtype){var s=n.msgs.toArray().slice(0,n.totalCount-n.unreadCount),u=(0,o.default)(s,(e=>e.id.toString())),l={totalCount:n.totalCount-1};u.find((t=>t===e.protocolMessageKey.toString()))||n.readKeys[e.protocolMessageKey.toString()]||(l.unreadCount=n.unreadCount-1),n.set(l)}else{var d={totalCount:n.totalCount+1};e.invis||(d.unreadCount=n.unreadCount+1),d.t=e.t,n.set(d)}return!i&&e.body&&g.default.createFromBase64Jpeg(e.body).then((e=>{n.pic=e})),i}return this.add({id:a,t:e.t,unreadCount:e.invis?0:1,totalCount:1}),!0}return!1}updateChecksum(e){e?this.hasSynced()&&(this.checksum=e):__LOG__(2)(A())}handle(e){var t=e.shift();if(Array.isArray(t))__LOG__(3)(b());else switch(t.type){case"read":this.updateChecksum(t.checksum);var r=this.get(t.chat);r?r.handleReadStatus(t.key):__LOG__(2)(T(),[t.chat,t.key].join());break;default:__LOG__(3)(S(),t.type)}}addStatusMessages(e,t){return m.default.processMultipleMessages((0,y.createWid)(c.default.STATUS_WID),t,{add:"after",isHistory:!0})}getUnexpired(e){var t=this.filter((e=>e.totalCount>0&&d.default.globalUnixTime()-e.t<=86400&&e.contact.isMyContact&&!e.contact.isMe&&!e.contact.isPSA));return e?(0,s.default)(t,(e=>e.unreadCount>0)):(0,s.default)(t,(e=>0===e.unreadCount))}getMyStatus(){var e=this.filter((e=>e.contact.isMe));if((0,i.default)(e));else if(!(d.default.globalUnixTime()-e[0].t>86400))return e[0]}}t.StatusV3Collection=M,M.model=E.default,M.comparator=(e,t)=>t.t-e.t;var I=new M;t.default=I},49569:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.RecentStickerCollection=t.RECENT_STICKERS_LIMIT=void 0;var i=n(r(19976)),s=n(r(70417)),o=n(r(22220)),u=n(r(54019)),l=a(r(52737)),d=n(r(18120)),c=n(r(61941)),f=n(r(82626)),p=n(r(86484)),h=n(r(76022));function _(){var e=(0,i.default)(["collection:recent_sticker:_sync error "]);return _=function(){return e},e}var m=32;t.RECENT_STICKERS_LIMIT=m;class g extends u.default{constructor(...e){super(...e),this._checksum="",this._syncStatus="NONE",this._weightMap=new Map,this._sortTrimScale=()=>{var e=this.length;if(e){if(this.sort(),e>m){for(var t=m;t<e;t++)this._weightMap.delete((0,c.default)(this.at(t),"this.at(i)").id);this.remove(this.models.slice(m))}var r=this.head(),a=this.last();r&&a&&this._getWeight(r)<10&&this._getWeight(a)>.01||this.forEach(((t,r)=>{this._weightMap.set(t.id,1+(e-r)/e*3)}))}}}_comparator(e,t){return l.default.platform===l.PLATFORMS.ANDROID?this._getWeight(t)-this._getWeight(e):e.index>t.index?1:-1}_getWeight(e){return(0,c.default)(this._weightMap.get(e.id),"this._weightMap.get(sticker.id)")}_findQuery(){return d.default.isRecentStickersEnabled()?h.default.queryRecentStickers().then((({checksum:e,stickers:t})=>(this.setChecksum(e),l.default.platform===l.PLATFORMS.ANDROID&&(this._weightMap.clear(),t.forEach((({id:e,weight:t})=>{this._weightMap.set(e,t)}))),t.map(((e,t)=>{var{weight:r}=e,a=(0,o.default)(e,["weight"]);return(0,s.default)((0,s.default)({},a),{},{mediaKey:(0,f.default)(a.mediaKey),index:t})}))))):Promise.reject(new Error("gk recent sticker sync unsupported"))}enqueue(e){d.default.isRecentStickersEnabled()&&0!==e.length&&(l.default.platform===l.PLATFORMS.ANDROID?this._enqueueAndroid(e):this._enqueueiOS(e))}_enqueueAndroid(e){e.forEach((e=>{this.get(e.id)||(this._weightMap.set(e.id,0),this.add(e)),this.forEach((t=>{var r=this._getWeight(t);t.id===e.id?r+=1:r*=.9,this._weightMap.set(t.id,Math.round(1e3*r)/1e3)}))})),this._sortTrimScale()}_enqueueiOS(e){this.forEach(((e,t)=>{e.index=m+t}));var t=new Set(e.map((e=>e.id)));e.reduce(((e,r)=>t.has(r.id)?(t.delete(r.id),[r].concat(e)):e),[]).slice(0,m).forEach(((e,t)=>{var r=this.get(e.id);r?r.index=t:this.add({id:e.id,deprecatedMms3Url:e.deprecatedMms3Url,directPath:e.directPath,filehash:e.filehash,encFilehash:e.encFilehash,mediaKey:e.mediaKey,mediaKeyTimestamp:e.mediaKeyTimestamp,width:e.width,height:e.height,size:e.size,mimetype:e.mimetype,type:e.type,index:t})})),this.sort(),this.remove(this.slice(m))}setChecksum(e){this._checksum=e}sync(e){return d.default.isRecentStickersEnabled()&&(null==e||e!==this._checksum)?this._sync():Promise.resolve()}_sync(){return"INPROGRESS"===this._syncStatus?Promise.resolve():(this._syncStatus="INPROGRESS",this.findQuery({},{set:!0}).then((()=>{this.sort(),this._syncStatus="SUCCESS"})).catch((()=>{__LOG__(3)(_()),this._syncStatus="FAILURE"})))}isSynced(){return"SUCCESS"===this._syncStatus||"FAILURE"===this._syncStatus}reset(){return this._syncStatus="NONE",this._weightMap.clear(),super.reset()}}t.RecentStickerCollection=g,g.model=p.default;var v=new g;t.default=v},47805:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.StarredStickerCollection=t.STARRED_STICKERS_PAGE_SIZE=void 0;var n=a(r(19976)),i=a(r(70417)),s=a(r(54019)),o=a(r(18120)),u=a(r(82626)),l=a(r(86484)),d=a(r(76022));function c(){var e=(0,n.default)(["collection:starred_sticker:_sync error "]);return c=function(){return e},e}t.STARRED_STICKERS_PAGE_SIZE=24;class f extends s.default{constructor(...e){super(...e),this._checksum="",this._syncStatus="NONE",this._currentPage=0,this._total=0}_findQuery(){return o.default.isStarredStickersEnabled()?d.default.queryStarredStickers(this._currentPage+1,24).then((({checksum:e,total:t,stickers:r})=>(this._checksum=e,this._currentPage+=1,this._total=t,r.map(((e,t)=>(0,i.default)((0,i.default)({},e),{},{mediaKey:(0,u.default)(e.mediaKey),index:this.length+t})))))):Promise.reject(new Error("gk starred sticker sync unsupported"))}add(e,t,r){return r&&(this._total+=1),super.add(e,t)}remove(e,t={}){return this._total-=1,super.remove(e,t)}syncNextPage(){return this.canLoadMore()?this._sync(!1).then((()=>{this.trigger("next_page_sync")})):Promise.resolve()}sync(e){return o.default.isStarredStickersEnabled()&&(null==e||e!==this._checksum)?(this.reset(),this._sync(!0).then((()=>{this.trigger("sync")}))):Promise.resolve()}_sync(e){return"INPROGRESS"===this._syncStatus?Promise.resolve():(this._syncStatus="INPROGRESS",this.findQuery({},{set:e}).then((()=>{this._syncStatus="SUCCESS"})).catch((()=>{__LOG__(3)(c()),this._syncStatus="FAILURE"})))}isSynced(){return"SUCCESS"===this._syncStatus||"FAILURE"===this._syncStatus}canLoadMore(){return 0!==this._total&&this.length<this._total}getRemaining(){return this._total-this.length}reset(){return this._syncStatus="NONE",this._currentPage=0,this._checksum="",this._total=0,super.reset()}}t.StarredStickerCollection=f,f.model=l.default,f.comparator=(e,t)=>e.index>=t.index?1:-1;var p=new f;t.default=p},86484:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.Sticker=void 0;var i=n(r(19976)),s=n(r(25291)),o=a(r(61247)),u=a(r(28278)),l=n(r(8603)),d=r(96645),c=n(r(40210)),f=r(47410);r(59420);function p(){var e=(0,i.default)(["id: ",", error: ",""]);return p=function(){return e},e}var h=(0,s.default)((()=>new m({id:"placeholder",isPlaceholder:!0})));class _ extends o.default{constructor(...e){super(...e),this.id=(0,o.prop)(),this.mediaData=(0,o.session)(),this.mediaObject=(0,o.prop)(),this.deprecatedMms3Url=(0,o.prop)(),this.directPath=(0,o.prop)(),this.filehash=(0,o.prop)(),this.height=(0,o.prop)(),this.index=(0,o.prop)(),this.mediaKey=(0,o.prop)(),this.mediaKeyTimestamp=(0,o.prop)(),this.mimetype=(0,o.prop)(),this.size=(0,o.prop)(),this.type=(0,o.prop)(d.OUTWARD_TYPES.STICKER),this.encFilehash=(0,o.prop)(),this.width=(0,o.prop)(),this.isPlaceholder=(0,o.prop)()}initialize(){super.initialize(),this.addChild("mediaData",new l.default),this.isPlaceholder||u.registerSticker(this)}downloadMedia(){return u.downloadStickerOrStickerPackIcon(this,"STICKER").catch((e=>{__LOG__(4,void 0,new Error,!0)(p(),this.id,String(e.stack||e)),SEND_LOGS("sticker-panel:sticker download failed")}))}sendToChat(e,t){r(49569).default.enqueue([this]),this.mediaData&&this.mediaData.mediaBlob&&this.mediaData.mediaBlob.retain();var{ctwaContextLinkData:a,ctwaContext:n}=e.getComposeContents(),i={quotedMsg:e.composeQuotedMsg,ctwaContext:(0,f.prepareCtwaContextSend)(a,n)};return e.composeQuotedMsg=null,(0,u.prepSticker)(this).sendToChat(e,i).then((e=>{var r=new c.default.StickerSend({stickerSendOrigin:t.stickerSendOrigin,stickerIsAnimated:Boolean(this.mediaData.isAnimated)});return null!=t.stickerIsFirstParty&&(r.stickerIsFirstParty=t.stickerIsFirstParty),r.commit(),e}))}delete(){super.delete(),u.deregisterSticker(this)}}t.Sticker=_,_.Proxy="sticker",_.getPlaceholder=h;var m=(0,o.defineModel)(_);m.getPlaceholder=h;var g=m;t.default=g},93771:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.StickerCollection=t.FETCH_STATE=void 0;var n=a(r(54019)),i=a(r(86484));t.FETCH_STATE={PENDING:"PENDING",SUCCESS:"SUCCESS",ERROR:"ERROR"};class s extends n.default{fetch(){throw new Error("".concat(this.constructor.name,".fetch is not implemented"))}}t.StickerCollection=s,s.model=i.default;var o=new s;t.default=o},70275:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.StickerPack=t.PRE_PLACEHOLDER_ID=void 0;var i=n(r(19976)),s=a(r(61247)),o=n(r(8603)),u=r(96645),l=n(r(89664));function d(){var e=(0,i.default)(["id: ",", error: ",""]);return d=function(){return e},e}var c="placeholder:";t.PRE_PLACEHOLDER_ID=c;var f=({index:e,page:t})=>new h({id:"".concat(c).concat(e),index:e,page:t});class p extends s.default{constructor(...e){super(...e),this.id=(0,s.prop)(),this.index=(0,s.prop)(),this.name=(0,s.prop)(),this.page=(0,s.prop)(),this.url=(0,s.prop)(),this.mimetype=(0,s.prop)("image/png"),this.mediaData=(0,s.session)(),this.mediaObject=(0,s.prop)(),this.directPath=(0,s.prop)(),this.filehash=(0,s.prop)(),this.mediaKey=(0,s.prop)(),this.mediaKeyTimestamp=(0,s.prop)(),this.size=(0,s.prop)(),this.type=(0,s.prop)(u.OUTWARD_TYPES.IMAGE),this.encFilehash=(0,s.prop)(),this.deprecatedMms3Url=(0,s.derived)(this._deprecatedMms3Url,["url","isFirstParty"]),this.stickers=(0,s.derived)(this._getStickersCollection,["id"]),this.isPlaceholder=(0,s.derived)(this._isPlaceholder,["id"]),this.isFirstParty=(0,s.derived)(this._isFirstParty,["url","mediaKey"])}_deprecatedMms3Url(){return this.isFirstParty?"":this.url}_isPlaceholder(){return p.isPlaceholderId(this.id)}_isFirstParty(){return Boolean(this.url)&&!this.mediaKey}_getStickersCollection(){return this._stickers=this._stickers||new l.default(this.id.split("#")[0],this.isFirstParty),this._stickers}initialize(){super.initialize(),this.isPlaceholder||this.isFirstParty||(this.addChild("mediaData",new o.default({renderableUrl:""})),r(28278).registerStickerPackIcon(this))}downloadMedia(){return this.isPlaceholder||this.isFirstParty?Promise.resolve():r(28278).downloadStickerOrStickerPackIcon(this,"STICKER_PACK").catch((e=>{__LOG__(4,void 0,new Error,!0)(d(),this.id,String(e.stack||e)),SEND_LOGS("sticker-panel:sticker-pack download failed")}))}delete(){super.delete(),r(28278).deregisterStickerPackIcon(this)}}t.StickerPack=p,p.Proxy="stickerPack",p.createPlaceholder=f,p.isPlaceholderId=e=>new RegExp("^".concat(c)).test(e);var h=(0,s.defineModel)(p),_=h;t.default=_,h.createPlaceholder=f,h.isPlaceholderId=p.isPlaceholderId},48967:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.StickerPackCollection=t.PAGE_FETCH_STATE=t.PAGE_SIZE_POPUP=t.PAGE_SIZE_COMPOSE_BOX=void 0;var n=a(r(70417)),i=a(r(19976)),s=a(r(52954)),o=a(r(61258)),u=a(r(13888)),l=a(r(54019)),d=a(r(70275)),c=a(r(76022));function f(){var e=(0,i.default)(["StickerPack page fetch promise cancelled: ",""]);return f=function(){return e},e}t.PAGE_SIZE_COMPOSE_BOX=9;t.PAGE_SIZE_POPUP=6;var p={PENDING:"PENDING",SUCCESS:"SUCCESS",ERROR:"ERROR"};t.PAGE_FETCH_STATE=p;class h extends l.default{constructor(){super(),this.checksum=null,this._pageFetchPromises={},this.pageFetchStates={},this._handleChecksumChange=()=>{Object.keys(this.pageFetchStates).forEach((e=>this._resetFetchPageStateAndPromise(parseInt(e,10)))),this._resetRangeWithPlaceholders(0,this.length),this.fetchAt(0,!1,!0)},this.listenTo(this,"change:checksum",this._handleChecksumChange)}createPlaceholder(e){return h.createPlaceholder(e)}preFetch(){var e=this;return(0,s.default)((function*(){yield e.fetchAt(0).then((()=>Promise.all(e.filter((e=>e.isFirstParty)).map((e=>e.stickers.fetch())))))}))()}fetchAt(e,t,r){return this._fetchPageWithIndex(e,Boolean(t),Boolean(r))}hasFetchedData(){return Object.keys(this.pageFetchStates).some((e=>this.pageFetchStates[parseInt(e,10)]===p.SUCCESS))}isFetchingData(){return Object.keys(this.pageFetchStates).some((e=>this.pageFetchStates[parseInt(e,10)]===p.PENDING))}pageWithIndex(e){return h.pageWithIndex(e)}reset(){return this.setChecksum(null,{silent:!0}),Object.keys(this.pageFetchStates).forEach((e=>this._resetFetchPageStateAndPromise(parseInt(e,10)))),super.reset()}sync(e){this.setChecksum(e)}setChecksum(e,t){return this.checksum!==e&&(this.checksum=e,t&&t.silent||this.trigger("change:checksum",e),!0)}_fetchPageWithIndex(e,t,r){var a=this.pageWithIndex(e);return this._fetchPage(a,t,r)}_fetchPage(e,t,r){var a,n=this.pageFetchStates[e];if(t&&n!==p.PENDING&&(a=this._pageFetchPromises[e])&&(a.cancel(),delete this._pageFetchPromises[e]),a=this._pageFetchPromises[e])return a;var i=this.length;return this._insertPagePlaceholders(e),this._setFetchPageState(e,p.PENDING),this._pageFetchPromises[e]=c.default.queryStickerPacks(e,9).cancellable().then((t=>{var a=this._parseStickerPacksRes(e,t),n=r||this.setChecksum(t.checksum,{silent:!0}),s=9*(e-1),o=9*(e+0);this._resetRange(s,o,a),n&&(this._resetRangeWithPlaceholders(0,s),this._resetRangeWithPlaceholders(Math.min(s+a.length,o),t.count));var u=this.length;i!==u&&this.trigger("change:length",u),this._setFetchPageState(e,p.SUCCESS)})).catch((t=>{if(t instanceof Promise.CancellationError)return __LOG__(2)(f(),e),void this._unsetFetchPageStateAndPromise(e);this._setFetchPageState(e,p.ERROR)})),this._pageFetchPromises[e]}_insertPagePlaceholders(e){var t=e-1;this._resetRangeWithPlaceholders(9*t,9*(t+1))}_parseStickerPacksRes(e,t){if(200!==t.status||!t.data)throw new Error("sticker packs query error");return t.data.map(((t,r)=>(0,n.default)((0,n.default)({},(0,u.default)(t,["id","mimetype","name","url","mediaKey","filehash","directPath"])),{},{encFilehash:t.encFilehash,page:e,index:9*(e-1)+r})))}_resetRangeWithPlaceholders(e,t){this._resetRange(e,t,(0,o.default)(t-e,(t=>h.createPlaceholder(e+t))))}_resetRange(e,t,r){this._forEachInRange(e,t,((t,a)=>{var n=r[a-e];if(t)if(n)t.id===n.id?(this.remove(t,{silent:!0}),this.add(n)):(this.remove(t),this.add(n));else for(var i=t;i;)this.remove(i),i=this.at(a);else n&&this.add(n)}))}_forEachInRange(e,t,r){for(var a=e;a<t;a++){r(this.at(a),a)}}_resetFetchPageStateAndPromise(e){e in this.pageFetchStates&&(this.pageFetchStates[e]===p.PENDING?this._pageFetchPromises[e].cancel():this._unsetFetchPageStateAndPromise(e))}_setFetchPageState(e,t){this.pageFetchStates[e]!==t&&(this.pageFetchStates[e]=t,this.trigger("change:pageFetchStates",e,t))}_unsetFetchPageState(e){e in this.pageFetchStates&&(delete this.pageFetchStates[e],this.trigger("change:pageFetchStates",e))}_unsetFetchPageStateAndPromise(e){delete this._pageFetchPromises[e],this._unsetFetchPageState(e)}}t.StickerPackCollection=h,h.model=d.default,h.comparator=function(e,t){return e.index<t.index?-1:e.index>t.index?1:0},h.createPlaceholder=function(e){return d.default.createPlaceholder({index:e,page:this.pageWithIndex(e)})},h.pageWithIndex=function(e){return Math.floor(e/9)+1};var _=new h;t.default=_},89664:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"FETCH_STATE",{enumerable:!0,get:function(){return l.FETCH_STATE}}),t.default=void 0;var n=a(r(70417)),i=a(r(13888)),s=r(87951),o=r(93771),u=a(r(76022)),l=r(93771);class d extends o.StickerCollection{constructor(e,t){super(),this._parseStickersRes=e=>{if(200!==e.status||!e.data)throw new Error("sticker pack stickers query error");return e.data.map(((e,t)=>(0,n.default)((0,n.default)({},(0,i.default)(e,["directPath","mimetype","mediaKey","filehash","width","height"])),{},{index:t,id:e.filehash,deprecatedMms3Url:e.url,encFilehash:e.encFilehash,mediaKeyTimestamp:0})))},this.stickerPackId=e,this.isFirstParty=t;var r,a=d._cache[this.stickerPackId];if(a)return a;var s=this;Object.defineProperty(this,"fetchState",{get:()=>r,set(e){r!==e&&(r=e,s.trigger("change:fetchState",e))}})}fetch(e){return e&&this.fetchState!==o.FETCH_STATE.PENDING&&delete this._fetchPromise,this._fetchPromise?this._fetchPromise:(this.fetchState=o.FETCH_STATE.PENDING,r(70275).default.isPlaceholderId(this.stickerPackId)?(this._fetchPromise=new Promise((()=>{})),this._fetchPromise):(t=this.isFirstParty?(0,s.fetchFirstPartyStickers)(this.stickerPackId):u.default.queryStickersInStickerPack(this.stickerPackId).then(this._parseStickersRes),this._fetchPromise=t.then((e=>{var t=Math.max(this.length||e.length);this._resetRange(0,t,e),this.fetchState=o.FETCH_STATE.SUCCESS})).catch((()=>{this.fetchState=o.FETCH_STATE.ERROR})),this._fetchPromise));var t}_resetRange(e,t,r){this._forEachInRange(e,t,((t,a)=>{var n=r[a-e];t?n?t.id===n.id?t.set(n):(this.remove(t),this.add(n)):this.remove(t):n&&this.add(n)}))}_forEachInRange(e,t,r){for(var a=e;a<t;a++){r(this.at(a),a)}}}t.default=d,d._cache={},d.comparator=(e,t)=>e.index<t.index?-1:e.index>t.index?1:0},17026:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.Obscurity=t.StreamMode=t.StreamInfo=void 0;var i=n(r(19976)),s=n(r(54073)),o=r(39329),u=a(r(61247)),l=n(r(79711)),d=n(r(50935)),c=r(95595),f=n(r(18120)),p=n(r(40210)),h=n(r(99911)),_=r(47398),m=a(r(86362)),g=r(207),v=n(r(78135)),E=r(44222),y=n(r(79345)),S=a(r(12767)),T=r(39174);function b(){var e=(0,i.default)(["Stream:unknown obscure level:"]);return b=function(){return e},e}function A(){var e=(0,i.default)(["Stream:onAvailableUpdate user ",""]);return A=function(){return e},e}function C(){var e=(0,i.default)(["Stream:onSelfUpdate mode:"," info:"," view:",""]);return C=function(){return e},e}function P(){var e=(0,i.default)(["Stream:unavailableLogoutTimer logout due to inactivity"]);return P=function(){return e},e}function O(){var e=(0,i.default)(["Stream:rememberMe: ",""]);return O=function(){return e},e}var w=r(28103).Mirrored(["OFFLINE","OPENING","PAIRING","SYNCING","RESUMING","CONNECTING","NORMAL","TIMEOUT"]);t.StreamInfo=w;var M=r(28103).Mirrored(["QR","MAIN","SYNCING","OFFLINE","CONFLICT","PROXYBLOCK","TOS_BLOCK","SMB_TOS_BLOCK","DEPRECATED_VERSION"]);t.StreamMode=M;var I=r(28103).Mirrored(["SHOW","OBSCURE","HIDE"]);t.Obscurity=I;class R extends u.default{constructor(...e){super(...e),this.info=(0,u.session)(w.NORMAL),this.mode=(0,u.session)(M.SYNCING),this.obscurity=(0,u.session)(I.HIDE),this.needsUpdate=(0,u.session)(),this.clientExpired=(0,u.session)(!1),this.hardExpired=(0,u.session)(!1),this.lastSyncStart=(0,u.session)(L()),this.couldForce=(0,u.session)(),this.uiActive=(0,u.session)(),this.available=(0,u.session)(!0),this.unavailableShiftTimer=(0,u.session)(),this.unavailableLogoutTimer=(0,u.session)(),this.unobscureShiftTimer=(0,u.session)(),this.timeoutEvent=(0,u.session)(),this.resumeCount=(0,u.session)(0),this.phoneAuthed=(0,u.session)(!1),this._activeModeMeasure=(0,u.session)(),this.displayInfo=(0,u.derived)(this._displayInfo,["info","obscurity"])}_displayInfo(){return function(e,t){switch(t){case I.SHOW:return e;case I.HIDE:return S.default.hasSynced?w.NORMAL:w.CONNECTING;case I.OBSCURE:switch(e){case w.OPENING:case w.PAIRING:case w.SYNCING:case w.RESUMING:return w.CONNECTING;default:return e}}return __LOG__(3)(b()),e}(this.info,this.obscurity)}initialize(){super.initialize(),f.default.supportsFeature(f.default.F.MD_BACKEND)&&!(0,T.isRegistered)()&&(this.mode=M.QR),this._activeModeMeasure=m.startMeasure("Stream.mode: ".concat(this.mode)),__LOG__(2)(O(),String((0,c.getRememberMe)())),this.unavailableShiftTimer=new o.ShiftTimer((()=>this.markUnavailable())),this.unobscureShiftTimer=new o.ShiftTimer((()=>this.unobscure())),this.unavailableLogoutTimer=new o.ShiftTimer((function(){(0,c.getRememberMe)()||(__LOG__(2)(P()),S.default.logout())})),this.listenTo(S.default,"change:state change:stream change:hasSynced",this.onSocketUpdate),this.listenTo(h.default,"change:online",this.onSocketUpdate),this.listenTo(this,"change:available",this.onAvailableUpdate),this.listenTo(this,"change:phoneAuthed",this.onPhoneAuthedUpdate),this.listenTo(this,"change:info change:displayInfo change:mode",(0,s.default)(this.onSelfUpdate)),this.listenTo(this,"change:info",this.logPageResume),this.listenTo(this,"change:info",this.updateWamLog),this.listenTo(this,"change:mode",this.logModeChange),this.listenTo(this,"change:available change:uiActive",this.updateCouldForce),this.listenTo(l.default,"midnight",this.updateHardExpire.bind(this)),f.default.supportsFeature(f.default.F.MD_BACKEND)&&this.listenTo(l.default,"socket_stream_disconnected",(()=>{r(99098).default.clearAllPresence()})),window.document&&document.addEventListener("visibilitychange",this.updateCouldForce),this.updateCouldForce(),this.updateHardExpire()}delete(){}markAvailable(){this.unavailableShiftTimer.cancel(),this.available=!0,(0,E.monitor)(!0,this.displayInfo===w.TIMEOUT)}markUnavailable(e){null!=e&&0!==e?this.unavailableShiftTimer.onOrBefore(e):(this.unavailableShiftTimer.cancel(),this.available=!1,(0,E.monitor)(!1,this.displayInfo===w.TIMEOUT))}onSelfUpdate(){__LOG__(2)(C(),this.mode,this.info,this.displayInfo);var e=this.timeoutEvent;if(this.info===w.TIMEOUT)e||(this.timeoutEvent=e=new p.default.WebcPhoneDisconnected),this.displayInfo===w.TIMEOUT&&null==this._bbarTime&&(this._bbarTime=Date.now());else if(e){e.markWebcPhoneDisconnectedT();var t=this._bbarTime;null!=t&&(e.webcPhoneBbarShownT=Date.now()-t),e.commit(),this.timeoutEvent=null,this._bbarTime=null}}onSocketUpdate(){var e={},t=function(){switch(S.default.state){case S.STATE.TIMEOUT:return w.TIMEOUT;case S.STATE.OPENING:return h.default.online?w.OPENING:w.OFFLINE;case S.STATE.PAIRING:return S.default.hasSynced?w.RESUMING:w.PAIRING;case S.STATE.CONNECTED:return S.default.stream!==S.STREAM.CONNECTED?S.default.hasSynced?w.NORMAL:w.SYNCING:w.NORMAL;case S.STATE.UNLAUNCHED:case S.STATE.PROXYBLOCK:default:return w.NORMAL}}();if(e.info=t,e.mode=function(){var e=!1;e=f.default.supportsFeature(f.default.F.MD_BACKEND)?(0,T.isRegistered)():(0,c.knowsPhone)();if(!e&&S.default.state!==S.STATE.PROXYBLOCK)return M.QR;var t=S.default.hasSynced;switch(S.default.state){case S.STATE.PROXYBLOCK:return M.PROXYBLOCK;case S.STATE.CONFLICT:return M.CONFLICT;case S.STATE.TOS_BLOCK:return M.TOS_BLOCK;case S.STATE.SMB_TOS_BLOCK:return M.SMB_TOS_BLOCK;case S.STATE.DEPRECATED_VERSION:return M.DEPRECATED_VERSION;case S.STATE.UNLAUNCHED:return M.SYNCING;case S.STATE.UNPAIRED_IDLE:case S.STATE.UNPAIRED:return M.QR;case S.STATE.OPENING:if(!h.default.online&&!S.default.hasSynced)return M.OFFLINE;default:return t||S.default.stream===S.STREAM.CONNECTED?M.MAIN:M.SYNCING}}(),e.phoneAuthed=S.default.stream!==S.STREAM.DISCONNECTED,t===w.NORMAL)this.unobscureShiftTimer.cancel(),e.obscurity=I.HIDE;else if(t===w.OFFLINE)this.unobscureShiftTimer.cancel(),e.obscurity=I.OBSCURE;else switch(this.obscurity){case I.HIDE:this.unobscureShiftTimer.onOrBefore(d.default.DIAGNOSTIC_DELAY);break;case I.OBSCURE:this.unobscureShiftTimer.onOrBefore(3e3);break;case I.SHOW:}this.set(e)}unobscure(){this.obscurity=I.SHOW}onPhoneAuthedUpdate(){this.phoneAuthed&&(this.sendAvailability(!0),r(67110).default.sync())}onAvailableUpdate(){var e=this.available;if(__LOG__(2)(A(),e?"available":"unavailable"),e||(0,c.getRememberMe)()?this.unavailableLogoutTimer.cancel():this.unavailableLogoutTimer.onOrBefore(d.default.IDLE_TIMEOUT_WAIT),this.sendAvailability(!1),f.default.supportsFeature(f.default.F.MD_BACKEND))if(e){var{sendDeliveryReceiptsAfterPresence:t}=r(88659);t()}else{r(99098).default.clearAllPresence()}}sendAvailability(e){(e||this.uiActive)&&(this.available?(0,g.sendPresenceAvailable)():(0,g.sendPresenceUnavailable)())}updateCouldForce(){this.couldForce=!this.uiActive||!this.available&&document.hidden}updateHardExpire(){v.default.isExpired()&&(this.hardExpired=!0,v.default.restart(!0))}logPageResume(){this.info===w.RESUMING&&(this.resumeCount++,new p.default.WebcPageResume({webcResumeCount:this.resumeCount}).commit())}updateWamLog(){var e=this.info===w.NORMAL;(0,_.streamInfoChange)(this.info,y.default.numSocketsAttempted,e),e&&this.stopListening(this,"change:info",this.updateWamLog)}logModeChange(){this._activeModeMeasure&&this._activeModeMeasure.end(),this.mode===M.SYNCING&&(this.lastSyncStart=L()),this._activeModeMeasure=m.startMeasure("Stream.mode: ".concat(this.mode)),new p.default.WebcStreamModeChange({webcStreamMode:D(this.mode)}).commit()}}function D(e){switch(e){case M.QR:return p.default.WEBC_STREAM_MODE_CODE.QR;case M.MAIN:return p.default.WEBC_STREAM_MODE_CODE.MAIN;case M.SYNCING:return p.default.WEBC_STREAM_MODE_CODE.SYNCING;case M.OFFLINE:return p.default.WEBC_STREAM_MODE_CODE.OFFLINE;case M.CONFLICT:return p.default.WEBC_STREAM_MODE_CODE.CONFLICT;case M.PROXYBLOCK:return p.default.WEBC_STREAM_MODE_CODE.PROXYBLOCK;case M.DEPRECATED_VERSION:return p.default.WEBC_STREAM_MODE_CODE.DEPRECATED_VERSION;case M.TOS_BLOCK:case M.SMB_TOS_BLOCK:return p.default.WEBC_STREAM_MODE_CODE.TOS_BLOCK}}R.Proxy="stream";var N=new((0,u.defineModel)(R));function L(){return Math.floor(window.performance.now())}t.default=N},73298:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(r(19976)),s=n(r(67304)),o=n(r(35676)),u=a(r(61247)),l=n(r(90980));function d(){var e=(0,i.default)(["model:Chat:replaceMsgsCollection:",""]);return d=function(){return e},e}function c(){var e=(0,i.default)(["models:Chat:removeMsg ",""]);return c=function(){return e},e}class f extends u.default{constructor(...e){super(...e),this.id=(0,u.prop)(),this.pendingMsgs=(0,u.prop)(),this.labels=(0,u.prop)(),this.msgChunks=(0,u.session)((()=>[])),this.lastReceivedKey=(0,u.session)(),this.unreadMsgAnchor=(0,u.session)(),this.disableUnreadAnchor=(0,u.session)(),this.msgsLength=(0,u.session)(),this.msgsChanged=(0,u.session)(0),this.msgs=(0,u.collection)(l.default)}initialize(){super.initialize(),this.listenTo(this.msgs,"change:last",(()=>{this.msgsChanged++})),this.listenTo(this.msgs,"add remove bulk_add",(()=>{this.msgsChanged++,this.msgsLength=this.msgs.length}))}onEmptyMRM(){throw new Error("onEmptyMRM not implemented")}delete(){super.delete(),this.getAllCMCs().forEach((e=>{e.forEach((e=>{e.delete()})),e.delete()}))}removeMsg(e){var t=e.msgChunk;t&&(t.indexOf(e)<0||(__LOG__(2)(c(),e.get("id")),t.remove(e),0===t.length&&(t===this.msgs?this.onEmptyMRM():this.removeMsgsCollection(t))))}getAllCMCs(){return this.msgChunks.concat([this.msgs])}getAllMsgs(){return(0,o.default)(this.getAllCMCs().map((e=>e.getModelsArray())))}replaceMsgsCollection(e){__LOG__(2)(d(),this.id.toString());var t={msg:e.last()};this.msgs.replace(e),this.notifyMsgCollectionMerge(e,this.msgs,this.msgs,t),this.msgChunks=(0,s.default)(this.msgChunks,e),e.delete()}removeMsgsCollection(e){this.msgChunks=(0,s.default)(this.msgChunks,e),e.delete()}notifyMsgCollectionMerge(e,t,r,a){this.trigger("change:cmc:merge",e,t,r,a)}}t.default=f},13274:(e,t,r)=>{"use strict";var a=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(61247));class i extends n.default{constructor(...e){super(...e),this.id=(0,n.prop)(),this.displayText=(0,n.prop)(),this.subtype=(0,n.prop)(),this.url=(0,n.prop)(),this.phoneNumber=(0,n.prop)(),this.selectionId=(0,n.prop)(),this.selected=(0,n.session)(!1)}}i.Proxy="templateButton";var s=(0,n.defineModel)(i);t.default=s},10750:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.TemplateButtonCollection=void 0;var n=a(r(54019)),i=a(r(13274));class s extends n.default{}t.TemplateButtonCollection=s,s.model=i.default,s.comparator=(e,t)=>e.id<t.id?-1:e.id>t.id?1:0;var o=s;t.default=o},76485:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(54019)),i=a(r(27e3));class s extends n.default{}t.default=s,s.model=i.default,s.comparator=function(e,t){return t.t-e.t}},62325:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={cache:{},delete:function(){this.cache={}}}},12767:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.STREAM=t.STATE=void 0;var i=n(r(52954)),s=n(r(19976)),o=n(r(45126)),u=n(r(67304)),l=n(r(90882)),d=n(r(15253)),c=n(r(17335)),f=n(r(29259)),p=n(r(13888)),h=n(r(16760)),_=n(r(45455)),m=n(r(95970)),g=r(91460),v=r(46378),E=r(29351),y=r(60339),S=n(r(49833)),T=n(r(19034)),b=a(r(61247)),A=n(r(61867)),C=a(r(3594)),P=n(r(97741)),O=n(r(11809)),w=n(r(19899)),M=n(r(79711)),I=n(r(52737)),R=n(r(96985)),D=n(r(50935)),N=r(19741),L=a(r(96452)),k=r(88122),U=r(95595),F=n(r(18120)),G=r(75459),x=r(29458),B=r(63925),Y=r(11008),K=n(r(11680)),j=a(r(15918)),W=n(r(5642)),V=a(r(8292)),H=n(r(2734)),q=n(r(22253)),z=n(r(36838)),J=n(r(53397)),Q=a(r(82885)),X=n(r(78135)),Z=n(r(7232)),$=a(r(53182)),ee=r(79345),te=n(r(92906)),re=r(39174),ae=r(97148),ne=r(66870),ie=n(r(63520)),se=r(54086),oe=r(66824),ue=r(35011),le=n(r(72424));function de(){var e=(0,s.default)(["ws2:deprecated version"]);return de=function(){return e},e}function ce(){var e=(0,s.default)(["ws2:POST logout failure"]);return ce=function(){return e},e}function fe(){var e=(0,s.default)(["ws2:POST logout"]);return fe=function(){return e},e}function pe(){var e=(0,s.default)(["ws2:logout through socket failure, will POST"]);return pe=function(){return e},e}function he(){var e=(0,s.default)(["ws2:logout through socket success"]);return he=function(){return e},e}function _e(){var e=(0,s.default)(["ws2:logout through socket"]);return _e=function(){return e},e}function me(){var e=(0,s.default)(["[CRITICAL] unpairDevice failed with error, preoceed with local logout \n",""],["[CRITICAL] unpairDevice failed with error, preoceed with local logout \\n",""]);return me=function(){return e},e}function ge(){var e=(0,s.default)(["ws2:multi-device logout failed with error code ",""]);return ge=function(){return e},e}function ve(){var e=(0,s.default)(["ws2:Resending "," in ","ms"]);return ve=function(){return e},e}function Ee(){var e=(0,s.default)(["ws2:clearState error ",""]);return Ee=function(){return e},e}function ye(){var e=(0,s.default)(["ws2:clearState failed due to DB operations aborted: ",""]);return ye=function(){return e},e}function Se(){var e=(0,s.default)(["ws2:clearState error ",""]);return Se=function(){return e},e}function Te(){var e=(0,s.default)(["ws2:clearState failed due to DB operations aborted: ",""]);return Te=function(){return e},e}function be(){var e=(0,s.default)(["ws2:clearState"]);return be=function(){return e},e}function Ae(){var e=(0,s.default)(["ws2:error during resume, resyncing: ","\n",""],["ws2:error during resume, resyncing: ","\\n",""]);return Ae=function(){return e},e}function Ce(){var e=(0,s.default)(["ws2:queryReceivedActions error"]);return Ce=function(){return e},e}function Pe(){var e=(0,s.default)(["ws2:queryReceivedActions unknown tag in response: ",""]);return Pe=function(){return e},e}function Oe(){var e=(0,s.default)(["ws2:queryReceivedActions onSendDup undefined; should be defined: ",""]);return Oe=function(){return e},e}function we(){var e=(0,s.default)(["ws2:queryReceivedActions found dup: ",",",""]);return we=function(){return e},e}function Me(){var e=(0,s.default)(["ws2:queryReceivedActions"]);return Me=function(){return e},e}function Ie(){var e=(0,s.default)(["Error: prefetch StickerPacks\n",""],["Error: prefetch StickerPacks\\n",""]);return Ie=function(){return e},e}function Re(){var e=(0,s.default)(["[ws2] moving to main screen from onCriticalSyncDone"]);return Re=function(){return e},e}function De(){var e=(0,s.default)(["ws2:handleChallenge passed challenge"]);return De=function(){return e},e}function Ne(){var e=(0,s.default)(["ws2:handleChallenge failed challenge!"]);return Ne=function(){return e},e}function Le(){var e=(0,s.default)(["ws2:handleChallenge no server token!"]);return Le=function(){return e},e}function ke(){var e=(0,s.default)(["ws2:challenged!"]);return ke=function(){return e},e}function Ue(){var e=(0,s.default)(["ws2:unknown error! status:",""]);return Ue=function(){return e},e}function Fe(){var e=(0,s.default)(["ws2:Already authorized!"]);return Fe=function(){return e},e}function Ge(){var e=(0,s.default)(["ws2:login"]);return Ge=function(){return e},e}function xe(){var e=(0,s.default)(["ws2:Bad Ref Response!"]);return xe=function(){return e},e}function Be(){var e=(0,s.default)(["ws2:Server denied new ref"]);return Be=function(){return e},e}function Ye(){var e=(0,s.default)(["ws2:Keeping Ref"]);return Ye=function(){return e},e}function Ke(){var e=(0,s.default)(["ws2:Updating Ref"]);return Ke=function(){return e},e}function je(){var e=(0,s.default)(["ws2:Requesting Ref Update"]);return je=function(){return e},e}function We(){var e=(0,s.default)(["ws2:phone replaced"]);return We=function(){return e},e}function Ve(){var e=(0,s.default)(["ws2:phone denied (conflict)"]);return Ve=function(){return e},e}function He(){var e=(0,s.default)(["ws2:denied tos"]);return He=function(){return e},e}function qe(){var e=(0,s.default)(["ws2:No secret bundle!"]);return qe=function(){return e},e}function ze(){var e=(0,s.default)(["ws2:phone disassociated via ",""]);return ze=function(){return e},e}function Je(){var e=(0,s.default)(["ws2:sync rejected, logging out"]);return Je=function(){return e},e}function Qe(){var e=(0,s.default)(["ws2:run loop interrupt: ",""]);return Qe=function(){return e},e}function Xe(){var e=(0,s.default)(["Assertion failed!"]);return Xe=function(){return e},e}function Ze(){var e=(0,s.default)(["Error initializing database during sync: ",""]);return Ze=function(){return e},e}function $e(){var e=(0,s.default)(["ws2:main loaded"]);return $e=function(){return e},e}function et(){var e=(0,s.default)(["ws2:completed ",""]);return et=function(){return e},e}function tt(){var e=(0,s.default)(["ws2:Running"]);return tt=function(){return e},e}function rt(){var e=(0,s.default)(["ws2:Run Backoff ","ms"]);return rt=function(){return e},e}function at(){var e=(0,s.default)(["ws2: received message, but no handler is registered"]);return at=function(){return e},e}function nt(){var e=(0,s.default)(["ws2: unexpected response status"]);return nt=function(){return e},e}function it(){var e=(0,s.default)(["ws2:onMessage error"]);return it=function(){return e},e}function st(){var e=(0,s.default)(["ws2:Pang while not timed-out"]);return st=function(){return e},e}function ot(){var e=(0,s.default)(["ws2:error-cannot-reach-phone"]);return ot=function(){return e},e}function ut(){var e=(0,s.default)(["",""]);return ut=function(){return e},e}function lt(){var e=(0,s.default)(["ws2:onMessage dropping ",""]);return lt=function(){return e},e}function dt(){var e=(0,s.default)(["ws2:onMessage 5xx error ",""]);return dt=function(){return e},e}function ct(){var e=(0,s.default)(["sending: ",", ",""]);return ct=function(){return e},e}function ft(){var e=(0,s.default)(["    send: ",", ",""]);return ft=function(){return e},e}function pt(){var e=(0,s.default)(["low-send: "," ",""]);return pt=function(){return e},e}function ht(){var e=(0,s.default)(["Ephemeral Drop: ",""]);return ht=function(){return e},e}function _t(){var e=(0,s.default)(["ws2:Outstanding Reqs: ",""]);return _t=function(){return e},e}function mt(){var e=(0,s.default)(["ws2:Phone timed out"]);return mt=function(){return e},e}function gt(){var e=(0,s.default)(["     ack: ",""]);return gt=function(){return e},e}function vt(){var e=(0,s.default)(["    recv: ","","",""]);return vt=function(){return e},e}function Et(){var e=(0,s.default)(["ws2:hard refresh!"]);return Et=function(){return e},e}function yt(){var e=(0,s.default)(["ws2: upgrade to md! (flow for external users)"]);return yt=function(){return e},e}function St(){var e=(0,s.default)(["ws2: can upgrade to md! (flow for internal users)"]);return St=function(){return e},e}function Tt(){var e=(0,s.default)(["ws2:onRefCycle"]);return Tt=function(){return e},e}function bt(){var e=(0,s.default)(["ws2:stream change: ",""]);return bt=function(){return e},e}function At(){var e=(0,s.default)(["ws2:state change: ",""]);return At=function(){return e},e}function Ct(){var e=(0,s.default)(["Assertion failed!"]);return Ct=function(){return e},e}function Pt(){var e=(0,s.default)(["",""]);return Pt=function(){return e},e}function Ot(){var e=(0,s.default)(["ws hash:"]);return Ot=function(){return e},e}function wt(){var e=(0,s.default)(["",""]);return wt=function(){return e},e}function Mt(){var e=(0,s.default)(["ws queue:"]);return Mt=function(){return e},e}function It(){var e=(0,s.default)(["ws socket id:      ",""]);return It=function(){return e},e}function Rt(){var e=(0,s.default)(["wd online:         ",""]);return Rt=function(){return e},e}function Dt(){var e=(0,s.default)(["ws state           ",""]);return Dt=function(){return e},e}function Nt(){var e=(0,s.default)(["ws:summary --------------------------------"]);return Nt=function(){return e},e}function Lt(){var e=(0,s.default)(["ws2: [logout error] sentinelPromise or sendCurrentLogoutPromise timed out with ",""]);return Lt=function(){return e},e}function kt(){var e=(0,s.default)(["ws2: [logout error] sendCurrentLogoutPromise errored with ",""]);return kt=function(){return e},e}function Ut(){var e=(0,s.default)(["ws2: multi-device logout did not manage to send sentinel patch"]);return Ut=function(){return e},e}function Ft(){var e=(0,s.default)(["ws2:user logged out"]);return Ft=function(){return e},e}function Gt(){var e=(0,s.default)(["destroyStorage: failed with error ",""]);return Gt=function(){return e},e}function xt(){var e=(0,s.default)(["ws2:run error unknown!\n",""],["ws2:run error unknown!\\n",""]);return xt=function(){return e},e}function Bt(){var e=(0,s.default)(["ws2:socket loop closed"]);return Bt=function(){return e},e}function Yt(){var e=(0,s.default)(["ws2:launch redundantly called!\n",""],["ws2:launch redundantly called!\\n",""]);return Yt=function(){return e},e}function Kt(){var e=(0,s.default)(["ws2:Launch gen"," (backoff gen",")"]);return Kt=function(){return e},e}function jt(){var e=(0,s.default)(["[ws2] moving to main screen from main_stream_mode_ready"]);return jt=function(){return e},e}function Wt(){var e=(0,s.default)(["[ws2] did not meet conditions to move to main screen"]);return Wt=function(){return e},e}function Vt(){var e=(0,s.default)(["[ws2] observed main_stream_mode_ready"]);return Vt=function(){return e},e}function Ht(){var e=(0,s.default)(["[ws2] observed on_critical_sync_done"]);return Ht=function(){return e},e}var{FLAVOR_TAGS:qt,VERSION:zt,LOGOUT_URL:Jt,SOCKET_STATE:Qt,SOCKET_STREAM:Xt,SPEEDY_RESUME_MAX_CHATS:Zt}=D.default;t.STREAM=Xt,t.STATE=Qt;class $t extends((0,E.customError)("ExternalPoke")){}class er extends((0,E.customError)("MustExitLoop")){}class tr extends((0,E.customError)("Denied401Failed")){}class rr extends((0,E.customError)("Denied409Conflict")){}class ar extends((0,E.customError)("DeniedTOS")){}class nr extends((0,E.customError)("DeniedTOSGDPR",!0,ar)){}class ir extends((0,E.customError)("DeniedTOSSMB",!0,ar)){}class sr extends((0,E.customError)("DeniedUnknown")){}class or extends((0,E.customError)("ForcedRefresh")){}class ur extends((0,E.customError)("TooManyRefRequest")){}class lr extends((0,E.customError)("UILogout")){}class dr extends((0,E.customError)("WindowOffline")){}class cr extends((0,E.customError)("PhoneFailedPing")){}class fr extends((0,E.customError)("AssertionFailed")){}class pr extends((0,E.customError)("TakeoverRequested")){}class hr extends((0,E.customError)("PhoneReplacedClient")){}class _r extends((0,E.customError)("NoSecretBundle")){}class mr extends((0,E.customError)("PhoneKickedClient")){}class gr extends((0,E.customError)("TempServerError")){}var vr={SYNC_INFO:["Conn",q.default.OBJECT],CHALLENGE:["Cmd",{type:"challenge",challenge:q.default.STRING}],DISCONNECT:["Cmd",{type:"disconnect",kind:void 0}],HARD_REFRESH:["Cmd",{type:"update"}],UPGRADE_MD_FOR_INTERNAL_USER:["Cmd",{type:"upgrade_md"}],UPGRADE_MD_FOR_PROD:["Cmd",{type:"upgrade_md_prod",version:void 0}],PONG:["Pong",q.default.BOOLEAN]},Er={TAG:e=>new q.default({tag:e,data:q.default.ANY,binarySize:q.default.ANY}),SYNC_INFO:new q.default({tag:q.default.ANY,data:vr.SYNC_INFO,binarySize:q.default.ANY}),CHALLENGE:new q.default({tag:q.default.ANY,data:vr.CHALLENGE,binarySize:q.default.ANY}),DISCONNECT:new q.default({tag:q.default.ANY,data:vr.DISCONNECT,binarySize:q.default.ANY}),HARD_REFRESH:new q.default({tag:q.default.ANY,data:vr.HARD_REFRESH,binarySize:q.default.ANY}),UPGRADE_MD_FOR_INTERNAL_USER:new q.default({tag:q.default.ANY,data:vr.UPGRADE_MD_FOR_INTERNAL_USER,binarySize:q.default.ANY}),UPGRADE_MD_FOR_PROD:new q.default({tag:q.default.ANY,data:vr.UPGRADE_MD_FOR_PROD,binarySize:q.default.ANY}),PONG:new q.default({tag:q.default.ANY,data:vr.PONG,binarySize:q.default.ANY})},yr=new q.default({status:e=>"number"==typeof e&&e>=500,_:void 0}),Sr=new q.default({status:e=>"number"==typeof e&&499===e,_:void 0}),Tr=new q.default({status:e=>"number"==typeof e,_:void 0});class br extends b.default{constructor(...e){super(...e),this.socketPreload=(0,b.session)(),this.socket=(0,b.session)(),this.launchGeneration=(0,b.session)(0),this.backoffGeneration=(0,b.session)(0),this.hasSynced=(0,b.session)(),this.state=(0,b.session)(Qt.UNLAUNCHED),this.stream=(0,b.session)(Xt.DISCONNECTED),this.canSend=(0,b.session)(),this.sendQueue=(0,b.session)(),this.sendHash=(0,b.session)(),this.cancelHash=(0,b.session)(),this.doubleAckHash=(0,b.session)(),this.sequence=(0,b.session)(0),this.shortTagBase=(0,b.session)(),this.socketWatcher=(0,b.session)(),this.refWatcher=(0,b.session)(),this.phoneWatchdog=(0,b.session)(),this.pendingPhoneReqs=(0,b.session)(0),this.isIncognito=(0,b.session)(),this.runPromise=(0,b.session)(),this.streamPromise=(0,b.session)(),this.conflictPromise=(0,b.session)(),this.resumePromise=(0,b.session)(),this.logoutMutex=(0,b.session)(0),this.retryTimestamp=(0,b.session)(),this.pokeable=(0,b.session)(),this.launched=(0,b.session)(),this.mustExitLoop=(0,b.session)(),this.syncTag=(0,b.session)(),this.lastPhoneMessage=(0,b.session)(),this.shouldForceReconnect=(0,b.session)(!1),this.shouldUpgradeToMDIntern=(0,b.session)(!1),this.shouldUpgradeToMDPord=(0,b.session)(!1)}initialize(){F.default.supportsFeature(F.default.F.MD_BACKEND)||(this.sendQueue=[],this.sendHash={},this.cancelHash={},this.doubleAckHash={},this.phoneWatchdog=new $.default({waitAlgorithm:(0,$.fibonacci)(3e3,3e3,36e5),onTimeout:this.phoneTimedOut.bind(this),onActivated:this.onPhoneWatchdogActivated.bind(this),onFed:this.onPhoneWatchdogFed.bind(this),onDeactivated:this.onPhoneWatchdogDeactivated.bind(this)})),this.listenTo(this,"change:state",this.onStateChange.bind(this)),this.listenTo(this,"change:stream",this.onStreamChange.bind(this)),(0,g.delayMs)(0).then(j.determineIncognito).then((e=>{this.isIncognito=e})),this.listenTo(M.default,"log_socket_summary",this.summary),this.listenTo(M.default,"set_socket_state",(e=>{this.state=e})),this.listenTo(M.default,"open_socket_stream",(()=>{this.openStream(),this.hasSynced&&this.set({stream:Xt.CONNECTED})})),this.listenTo(M.default,"socket_stream_disconnected",(()=>{this.set({stream:Xt.DISCONNECTED})})),this.listenTo(M.default,"on_critical_sync_done",(()=>{__LOG__(2)(Ht()),this.onCriticalSyncDone()})),this.listenTo(M.default,"main_stream_mode_ready",(()=>{__LOG__(2)(Vt()),!F.default.supportsFeature(F.default.F.MD_BACKEND)||(0,re.getAllCriticalDataSynced)()||F.default.supportsFeature(F.default.F.MD_E2E)?(__LOG__(2)(jt()),this.set({hasSynced:!0,stream:Xt.CONNECTED})):__LOG__(2)(Wt())})),this.listenTo(M.default,"socket_stream_disconnected",(()=>{this.stream=Xt.DISCONNECTED}))}preload(){F.default.supportsFeature(F.default.F.MD_BACKEND)||(this.socketPreload=new z.default)}send(e){var t=new W.default(e);this.sendQueue.push(t),this.flushQueue()}send2(e){return new Promise(((t,r)=>{var a=new W.default(e);a.onSend=t,a.onDrop=r,this.sendQueue.push(a),this.flushQueue()}))}shortTag(){return this.shortTagBase||(this.shortTagBase=((0,T.default)().unix()%1e3).toString()),"".concat(this.shortTagBase,".--").concat(this.sequence++)}tag(e){var t="".concat((0,T.default)().unix(),".--").concat(this.sequence++);return e&&qt?t+"-"+e:t}launch(e,t=0){__LOG__(2)(Kt(),this.launchGeneration,this.backoffGeneration);var r=300*Q.expBackoff(this.backoffGeneration,100),a=Date.now()+r;if(this.launched){var n=new Error("Redundant Launch");return __LOG__(3,!0)(Yt(),n.stack),void C.upload({reason:"redundant-launch"})}function i(){__LOG__(2)(Bt()),this.socketPreload&&this.socketPreload.deactivate(),this.clearState(),this.set({state:Qt.UNLAUNCHED,mustExitLoop:!1,launched:!1,socketPreload:null})}this.mustExitLoop?i.call(this):(this.launched=!0,this.run(t,e).then((function(e){return[e,!1]})).catchType(er,(()=>(this.mustExitLoop=!0,[!1,!1]))).catchType(pr,(function(){return[!1,!0]})).catch((e=>(__LOG__(3,!0)(xt(),e.stack),C.upload({reason:"unknown-error-in-ws-loop"}),this.clearState(),[!0,!1]))).spread(((e,t)=>{if(this.mustExitLoop)i.call(this);else{var n=Date.now();this.launchGeneration++,this.backoffGeneration=e&&n<a+6e4?this.backoffGeneration+1:0;var s=n<a?Math.min(a-n,r):0;this.launched=!1,this.launch(t,s)}})))}poke(){this.pokeable?this.pokeable.poke():this.phoneWatchdog.forceTimeout()}takeover(){if(!this.conflictPromise)throw"Takeover called without conflict!";this.conflictPromise.cancel(new pr)}exitLoop(e){this.mustExitLoop=!0,this.runPromise&&this.runPromise.cancel(e||new er)}clearCredentialsAndStoredData(){var e=this;return(0,i.default)((function*(){try{yield e.destroyStorage()}catch(e){__LOG__(4,void 0,new Error,!0)(Gt(),e),SEND_LOGS("Logout destroyStorage failed")}return e.clearCredentials()}))()}destroyStorage(){return(0,i.default)((function*(){var e=[(0,Y.destroy)()];F.default.supportsFeature(F.default.F.MD_BACKEND)&&(e.push((0,k.destroy)()),e.push(O.default.clearInitializationPromises()),(0,ae.clearABPropConfigs)()),yield Promise.all(e)}))()}logout(e){var t,a=this;(0,x.get)().setLogoutState(!0),F.default.supportsFeature(F.default.F.MD_BACKEND)?M.default.onStartingLogout():t=this.runPromise,__LOG__(2)(Ft());var n=Promise.resolve();if(F.default.supportsFeature(F.default.F.MD_BACKEND)){var s=Math.min(20,Math.max(0,le.default.syncdSentinelTimeoutSeconds));n=(0,m.default)(r(21601).Z(),1e3*s).catch((()=>__LOG__(3)(Ut())))}(0,m.default)(n.then((()=>{this.stream===Xt.DISCONNECTED||e?this.sendCurrentLogout():this.sendCurrentLogout(this.socket)})).catch(function(){var e=(0,i.default)((function*(e){__LOG__(4,void 0,new Error)(kt(),e),yield a.clearCredentialsAndStoredData(),M.default.logout()}));return function(){return e.apply(this,arguments)}}()),3e3,"network request took more than ".concat(3," seconds")).then((0,i.default)((function*(){yield a.clearCredentialsAndStoredData(),t&&t.cancel(new lr),a.state===Qt.OPENING&&a.trigger("change:state"),M.default.logout()}))).catch(function(){var e=(0,i.default)((function*(e){__LOG__(4,void 0,new Error)(Lt(),e),yield a.clearCredentialsAndStoredData(),M.default.logout()}));return function(){return e.apply(this,arguments)}}()).finally((()=>{(0,x.get)().setLogoutState(!1)}))}summary(){__LOG__(2)(Nt()),__LOG__(2)(Dt(),this.state),__LOG__(2)(Rt(),String(navigator.onLine)),__LOG__(2)(It(),this.socket?this.socket.id:"n/a"),__LOG__(2)(Mt()),(0,_.default)(this.sendQueue)||S.default.print((0,h.default)(this.sendQueue,(function(e){var t=(0,p.default)(e,"tag","state","age","ephemeral","isToPhone");return e&&e.toString&&(t.debug=e.toString()),t}))).split(/\n/).forEach((function(e){__LOG__(2)(wt(),e)})),__LOG__(2)(Ot()),(0,_.default)(this.sendHash)||S.default.print((0,h.default)(this.sendHash,(function(e){var t=(0,p.default)(e,"tag","state","age","ephemeral","isToPhone");return e&&e.toString&&(t.debug=e.toString()),t}))).split(/\n/).forEach((function(e){__LOG__(2)(Pt(),e)}))}registerHandler(e){F.default.supportsFeature(F.default.F.MD_BACKEND)||(this.handler&&(__LOG__(4,void 0,new Error,!0)(Ct()),SEND_LOGS("ws2: attempting to register handler multiple times")),this.handler=e)}onStateChange(){__LOG__(2)(At(),this.state)}onStreamChange(){__LOG__(2)(bt(),this.stream),this.stream===Xt.DISCONNECTED&&(F.default.supportsFeature(F.default.F.MD_BACKEND)?Z.default.clear():this.onRefCycle(),this.unset("resumePromise"))}onRefCycle(){__LOG__(2)(Tt()),this.sendQueue.forEach((function(e){e.state=W.default.STATE.NEW,e.age=0})),this.clearSendHash()}onActivity(e){if(e){var t=e.data;if(Er.UPGRADE_MD_FOR_INTERNAL_USER.test(e))__LOG__(2)(St()),this.shouldUpgradeToMDIntern=!0,this.exitLoop();else if(Er.UPGRADE_MD_FOR_PROD.test(e)){if(__LOG__(2)(yt()),t&&Array.isArray(t)&&2===t.length&&t[1]&&t[1].type&&t[1].version){var r="string"==typeof t[1].version&&t[1].version,a=r&&new te.default(r),n=D.default.VERSION_STR.replace(/\.[di]$/,""),i=new te.default(n);if(a&&i.lt(a))return(0,U.setMdOptedIn)(!0),X.default.restart(!0),void this.exitLoop()}this.shouldUpgradeToMDPord=!0,this.exitLoop()}else if(Er.HARD_REFRESH.test(e))__LOG__(2)(Et()),X.default.restart(!0);else if(t){var s=Array.isArray(t)?" [".concat(String(t[0]),", ...]"):"",o=(0,f.default)(t)&&"number"==typeof t.status?t.status:null;Z.default.logRecv(e.tag,e.binarySize,o);var u=null!=o?",{status:".concat(o,"}"):"";__LOG__(2)(vt(),e.tag,s,u)}else Z.default.logAck(e.tag),__LOG__(2)(gt(),e.tag)}else w.default.setSkew(this.socket.timeSkew||0);this.sendRemainingLogouts()}onPhoneWatchdogActivated(){}onPhoneWatchdogFed(){this.state=Qt.CONNECTED}onPhoneWatchdogDeactivated(){}flushQueue(){if(this.sendQueue.length){var e=this.sendQueue.filter((e=>e.state===W.default.STATE.NEW&&this.canRequestBeSent(e))),t=w.default.localUnixTime(),r=[],a=[];e.forEach((e=>{!function(e,t){return!(!e.resendGuard||e.resendGuard())||!(!e.binaryOpts||null==e.binaryOpts.expires||0===e.binaryOpts.expires)&&t-e.binaryOpts.expires>120}(e,t)?a.push(e):r.push(e)})),this.sendQueue=(0,c.default)(this.sendQueue,r),r.forEach((e=>{delete this.sendHash[e.tag],delete this.doubleAckHash[e.tag],Z.default.delete(e.tag),e.onSend({status:408})})),a.length&&a.forEach((e=>{this._send(e)}))}}phoneTimedOut(){var e=this.phoneWatchdog.failGeneration;if(1===e){__LOG__(3)(mt());var t=(0,h.default)(this.sendHash,"tag");__LOG__(3)(_t(),t.join(","))}M.default.sentPing(e);var r=this.phoneWatchdog.waitAlgorithm(this.phoneWatchdog);return this.set({state:Qt.TIMEOUT,retryTimestamp:Date.now()+r}),this._basicSend({tag:this.tag("ping"),data:["admin","test"]},"ping"),!0}clearSendHash(e){if(e)(0,d.default)(this.sendHash,(function(e){e.resendTimer&&clearTimeout(e.resendTimer),e.onDrop(new N.LogoutDrop(e.toString()))}));else{var t=(0,l.default)(this.sendHash,"ephemeral");__LOG__(3)(ht(),(0,h.default)(t,"tag").join(",")),t.forEach((function(e){e.resendTimer&&clearTimeout(e.resendTimer),e.onDrop(new N.EphemeralDrop(e.toString()))}))}this.sendHash={},this.doubleAckHash={},this.pendingPhoneReqs=0,this.phoneWatchdog&&this.phoneWatchdog.deactivate(),Z.default.clear()}_basicSend(e,t){__LOG__(2)(pt(),t,String(e.tag)),Z.default.logBasicSend(e.tag,e.data),this.socket.cast("".concat(String(e.tag),",").concat(String(JSON.stringify(e.data))))}_send(e){e.tag=e.getTag()||this.shortTag(),e.onTag&&e.onTag(e.tag),this.sendHash[e.tag]=e,e.tagToCancel&&(this.cancelHash[e.tag]=e.tagToCancel),(e.isCallOffer||e.isWap4Bridge)&&(this.doubleAckHash[e.tag]=e),e.binaryOpts?e.binaryOpts.debugObj:e.data,Z.default.logSend(e),__LOG__(2)(ft(),String(e.tag),e.toString()),this.socket.send(e.serialize()),e.isToPhone&&this.pendingPhoneReqs++,e.state=W.default.STATE.SENT}sendBasic(e){return this.socket?(e.tag=this.tag(),this._basicSend(e,"external"),this.socket.nextMessage(Er.TAG(e.tag))):Promise.reject("socket not open")}sendEphemeral(e){e.ephemeral=!0;var t=new W.default(e);this.canRequestBeSent(t)?this._send(t):t.onDrop(new N.EphemeralDrop(t.toString()))}sendEphemeral2(e){return new Promise(((t,r)=>{var a=new W.default(e);a.ephemeral=!0,this.canRequestBeSent(a)?(a.onSend=t,a.onDrop=r,this._send(a)):r(new N.EphemeralDrop(a.toString()))}))}sendEphemeralIgnore(e){e.ephemeral=!0,e.ignore=!0,e.tag=this.tag();var t=new W.default(e);if(this.canRequestBeSent(t)){var r=t.serialize();this.socket.send(r),__LOG__(2)(ct(),String(t.tag),t.toString())}else t.onDrop(new N.EphemeralDrop(t.toString()))}on5xx(e){__LOG__(3)(dt(),String(e.tag)),e.on5xx&&e.on5xx(),e.resends>=5?(__LOG__(3)(lt(),String(e.tag)),e.onDrop(new N.Server5xxDrop),delete this.sendHash[e.tag],Z.default.delete(e.tag),this.sendQueue=(0,u.default)(this.sendQueue,e)):this.maybeResendRequestEventually(e)}onMessage(e){var t=e.tag,a=e.data,n=e.binarySize;if(Ar(a)&&(this.lastPhoneMessage=(0,T.default)().unix()),Er.PONG.test(e))if(a[1]){var i=0,s=!1;(0,d.default)(this.sendHash,(function(e){if(e.isToPhone){var t=++e.age;40===t?(s=!0,__LOG__(4,void 0,new Error)(ut(),e.tag+" likely dead: "+e.toString()),M.default.cannotReachPhone("("+e.tag+") "+e.toString()),r(76022).default.cannotReachPhone()):t<40&&i++}})),this.pendingPhoneReqs=i,this.phoneWatchdog.feed(),0===i&&this.phoneWatchdog.deactivate(),s&&__LOG__(3)(ot())}else this.state!==Qt.TIMEOUT?__LOG__(3)(st()):this.runPromise.cancel(new cr);else{var o=this.sendHash[t];if(o)if(a){if(o.retryOn5xx&&yr.test(a))this.on5xx(o,a);else{var l=!0;if(this.doubleAckHash[t]&&(delete this.doubleAckHash[t],!o.isCallOffer&&!o.isWap4Bridge||200!==a.status||a.payload||(l=!1)),l){var c;try{o.logOnSend&&o.logOnSend(e),c=o.onSend(a)}catch(e){if(e instanceof N.E401)return void this.logout();__LOG__(3)(it()),o.onDrop(e)}if(yr.test(c)?this.on5xx(o,c):(delete this.sendHash[t],this.sendQueue=(0,u.default)(this.sendQueue,o)),Sr.test(a)){var f=this.cancelHash[t];if(f){var p=this.sendHash[f];delete this.cancelHash[t],delete this.sendHash[f],this.sendQueue=(0,u.default)(this.sendQueue,p)}}}}o.isToPhone&&(o.age<40&&this.pendingPhoneReqs--,this.phoneWatchdog.feed(),0===this.pendingPhoneReqs&&this.phoneWatchdog.deactivate())}else o.state=W.default.STATE.WEBDACKED,o.isToPhone&&this.phoneWatchdog.activate();else if(a){if(Tr.test(a))__LOG__(3)(nt());else if(a instanceof ArrayBuffer)r(76022).default.handle(a,this,t,n).catchType(N.WebdDrop,(()=>{}));else try{this.handler?this.handler(a):__LOG__(3)(at())}catch(e){if(e instanceof L.UpdateImmediately)this.exitLoop(e);else{if(!(e instanceof L.DeprecatedProtocolVersion))throw e;this.runPromise&&this.runPromise.cancel(e)}}Ar(a)&&this.phoneWatchdog.feed()}}}run(e,t){var r=this;return this.runPromise=J.default.resolve(e).cancellable().then((e=>{if(this.state=Qt.OPENING,M.default.incrementProgress(),e>0){__LOG__(2)(rt(),e);var t=(0,g.delayMs)(e).cancellable().catchType($t,(()=>{}));return this.setPokeable(t,Date.now()+e),t}})).finally((()=>{this.unset("pokeable"),this.unset("retryTimestamp")})).then((()=>(M.default.incrementProgress(),__LOG__(2)(tt()),this.openSocket()))).then((e=>{if(M.default.incrementProgress(),e.onactivity=this.onActivity.bind(this),this.socket=e,this.socketWatcher=j.attachWatcher(this.runPromise,this.throwOnClose()),this.state=Qt.PAIRING,void 0===this.isIncognito)return j.waitForBBEvent(this,"change:isIncognito")})).then((()=>{M.default.incrementProgress(),this.shortTagBase=((0,T.default)().unix()%1e3).toString();var e=this.initConn();if((0,U.knowsPhone)()){var r=this.requestSync(t),a=Promise.all([e,r]).finally((function(){e.cancel(),r.cancel()})),n=(0,B.requireChatCollection)().then((e=>{this.hasSynced&&e.length<=Zt&&!F.default.supportsFeature(F.default.F.MD_BACKEND)&&(this.resumePromise=this.runResume(!0))}));return Promise.all([a,n])}return e.then((()=>{this.set({state:Qt.UNPAIRED,refWatcher:j.attachWatcher(this.runPromise,this.manageRef())})}))})).then((()=>this.waitForSyncInfo())).finally((()=>{this.refWatcher&&(this.refWatcher.cancel(),this.unset("refWatcher"))})).then((e=>(M.default.incrementProgress(),__LOG__(2)(et(),this.hasSynced?"re-auth":"auth"),this.state=Qt.CONNECTED,I.default.blockStoreAdds=!1,I.default.platform=e.platform,j.waitForMain().then((()=>e))))).then((function(e){return __LOG__(2)($e()),e.initial=!0,(0,R.default)([e])})).then((()=>(0,Y.initialize)().catch((e=>{__LOG__(3)(Ze(),e),__LOG__(4,void 0,new Error,!0)(Xe()),SEND_LOGS("Error initializing database during sync")})))).then((()=>{var e=this.openStream();return this.streamPromise=e,e})).then((function(){return new J.default})).catchType(L.SocketClosed,(function(e){throw e.event instanceof lr?e.event:e})).catch((e=>{__LOG__(3)(Qe(),e),this.set({canSend:!1,stream:Xt.DISCONNECTED,runPromise:null}),this.phoneWatchdog.deactivate(),this.streamPromise&&(this.streamPromise.cancel(),this.unset("streamPromise")),this.socketWatcher&&(this.socketWatcher.cancel(),this.unset("socketWatcher"));var t=this.socket;return t&&t.state!==ee.STATE.CLOSED&&(t.detachCallbacks(),t.close(!0,e)),this.unset("socket"),this.shouldUpgradeToMDIntern?(M.default.upgradeToMDInternal(),!1):this.shouldUpgradeToMDPord?(M.default.upgradeToMDProd(),!1):Promise.reject(e)})).catchType(L.UpdateImmediately,(e=>{throw this.updateImmediately(e.message),new er})).catchType(L.DeprecatedProtocolVersion,(()=>this.deprecatedVersion())).catchTypes(N.E401,cr,(function(){return!1})).catchType(or,(()=>(this.clearState(),!1))).catchTypes3(L.SocketClosed,L.SocketError,gr,(()=>!0)).catchType(sr,(()=>(__LOG__(3)(Je()),this.sendCurrentLogout().then((0,i.default)((function*(){return yield r.clearCredentialsAndStoredData(),M.default.logout(),!1})))))).catchTypes(tr,mr,function(){var e=(0,i.default)((function*(e){return __LOG__(2)(ze(),String(e)),yield r.clearCredentialsAndStoredData(),M.default.logout(),!1}));return function(){return e.apply(this,arguments)}}()).catchType(_r,(0,i.default)((function*(){return __LOG__(3)(qe()),yield r.clearCredentialsAndStoredData(),C.upload({reason:"no-secret-bundle"}),M.default.logout(),!1}))).catchType(ur,(()=>(this.state=Qt.UNPAIRED_IDLE,this.setPokeable(j.waitForOfflineNaive().throw(new dr).catchType($t,(()=>!1)))))).catchType(L.BlockedByProxy,(()=>(A.default.promptUnloadGuards++,this.state=Qt.PROXYBLOCK,this.setPokeable((new J.default).catchType($t,(()=>!1)).finally((function(){A.default.promptUnloadGuards--})))))).catchType(ar,(e=>{__LOG__(2)(He());var t=this.setPokeable((new J.default).cancellable().catchType($t,(()=>!1))).cancellable(),r=e instanceof nr?Qt.TOS_BLOCK:Qt.SMB_TOS_BLOCK;return this.clearState(),this.set({state:r,runPromise:t}),t})).catchTypes(rr,hr,(e=>{e instanceof rr?__LOG__(2)(Ve()):__LOG__(2)(We());var t=(new J.default).cancellable();return this.set({state:Qt.CONFLICT,conflictPromise:t,runPromise:t}),this.clearState(),t})).finally((()=>{this.conflictPromise&&this.conflictPromise.cancel()})).catchTypes(lr,dr,(function(){return!1}))}openSocket(){var e=this.socketPreload;if(this.socketPreload=null,e&&e.socket&&e.socket.state===ee.STATE.OPEN)return Promise.resolve(e.socket);var t=e&&e.active?e:new z.default,r=()=>{this.retryTimestamp=t.retryTimestamp};t.on("change:retryTimestamp",r),this.pokeable=t;var a=j.waitForBBEvent(t,"change:socket").cancellable().then((()=>t.socket)).finally((()=>{t.off("change:retryTimestamp",r),t.onerror=null,t.deactivate(),this.pokeable=null}));return t.onerror=e=>{a.cancel(e)},a}initConn(){return new Promise(((e,t)=>{var r=zt,a=this.tag("init"),n=A.default.info();return this._basicSend({tag:a,data:["admin","init",[r.p,r.s,r.t],[n.os||"Unknown",n.name||"Unknown",n.version||"Unknown"],A.default.id(),!this.isIncognito&&!!(0,U.getRememberMe)()]},"init"),this.socket.nextMessage(Er.TAG(a)).get("data").catch(t).then(e)})).then((function(e){w.default.setSkew(Date.now()-e.time),(0,R.default)([{id:"1",ref:e.ref,refTTL:e.ttl}])}))}manageRef(){return Promise.loop(((e,t,r)=>{var a=I.default.refExpiry-Date.now()-500;return(0,g.delayMs)(Math.max(a,0)).cancellable().then((()=>{if(r>=5)throw new ur;__LOG__(2)(je());var e=this.tag("qr"+r);return this._basicSend({tag:e,data:["admin","Conn","reref"]},"reref"),this.socket.nextMessage(Er.TAG(e))})).then((t=>{var r=t.data;switch(r.status){case 200:return __LOG__(2)(Ke()),void(0,R.default)([{ref:r.ref,refTTL:r.ttl}]);case 304:return __LOG__(2)(Ye()),void e();case 429:throw __LOG__(2)(Be()),new ur;default:throw __LOG__(3)(xe()),new fr("unrecognized ref request status ("+r.status+")")}}))})).cancellable()}requestSync(e){if(this.syncTag=this.tag("sync"),!V.load())return Promise.reject(new _r);var{client:t,server:r}=(0,U.getLoginTokens)(),a=["admin","login",t,r,A.default.id()];e?a.push("takeover"):this.hasSynced&&(a.push(this.shouldForceReconnect?"force_reconnect":"reconnect"),a.push((0,U.getMaybeMeUser)()));var n=()=>(this._basicSend({tag:this.syncTag,data:a},"sync"),!0),i=new $.default({waitAlgorithm:(0,$.fibonacci)(0,8500,6e4),onTimeout:n});i.on("change:ts",(()=>{this.retryTimestamp=i.ts})),this.pokeable=i,i.activate(),n();var s=this.socket.nextMessage(Er.TAG(this.syncTag)),o=this.lookForAndHandleChallenge().catchType(Promise.CancellationError,(()=>{})).catch(s.cancel.bind(s));return s.then((e=>{__LOG__(2)(Ge());var t=e.data;switch(t.status){case 200:return e;case 401:return Promise.reject(new tr);case 403:var r;return r=t.tos>=2?new nr:t.smbTos?new ir:new sr,Promise.reject(r);case 405:return __LOG__(3)(Fe()),C.upload({reason:"already-authorized"}),Promise.reject(new or);case 409:return Promise.reject(new rr);case 500:return Promise.reject(new gr);default:return __LOG__(3)(Ue(),t.status),Promise.reject(new sr)}})).finally((()=>{o.cancel(),i.deactivate(),this.unset("pokeable"),this.unset("retryTimestamp")}))}waitForSyncInfo(){return this.socket.nextMessage(Er.SYNC_INFO).then((function(e){return e.data[1]}))}lookForAndHandleChallenge(){return this.socket.nextMessage(Er.CHALLENGE).then((function(e){__LOG__(2)(ke());var t=(0,y.decodeB64)(e.data[1].challenge);return V.getSecurityToken(t)})).then((e=>{var t=(0,U.getLoginTokens)(),r=t?t.server:void 0;if(!r)return __LOG__(3)(Le()),Promise.reject(new Error("Handle challenge no server token"));var a=this.tag("challenge");return this._basicSend({tag:a,data:["admin","challenge",e,r,A.default.id()]},"challenge"),this.socket.nextMessage(Er.TAG(a))})).then((function(e){return e.data.status>=500?Promise.reject(new gr):e.data.status>=400?(__LOG__(3)(Ne()),Promise.reject(new tr)):void __LOG__(2)(De())}))}throwOnClose(){return this.socket.nextMessage(Er.DISCONNECT).then((function(e){throw"replaced"===e.data[1].kind?new hr:new mr}))}onCriticalSyncDone(){F.default.supportsFeature(F.default.F.MD_BACKEND)&&(__LOG__(2)(Re()),this.set({hasSynced:!0,stream:Xt.CONNECTED}))}openStream(){if(F.default.supportsFeature(F.default.F.MD_BACKEND))return(0,B.requireStatusV3Collection)().then((e=>{e.sync()})),(0,B.requireContactCollection)().then((e=>{var t=(0,U.getMeUser)();t&&(I.default.blockStoreAdds=!1,I.default.id="1",I.default.trigger("me_ready")),e.gadd(t)}));var e;if(this.canSend=!0,this.hasSynced)this.resumePromise||(this.resumePromise=this.runResume(!1)),e=this.resumePromise.finally((()=>{this.unset("resumePromise")}));else{var t=(0,B.requireContactCollection)().then((e=>e.sync()));if(e=(0,B.requireChatCollection)().then((e=>e.sync())).cancellable().then((()=>(this.set({hasSynced:!0,stream:Xt.CONNECTED}),(0,B.requireStickerPackCollection)().then((e=>{e.preFetch()})).catch((e=>{__LOG__(3)(Ie(),e.stack)})),F.default.supportsFeature(F.default.F.USER_NOTICE)&&K.default.sync(),F.default.supportsFeature(F.default.F.SETTINGS_SYNC)&&H.default.sync(),t))).catch((e=>(this.set({hasSynced:!1,stream:Xt.DISCONNECTED}),Promise.reject(e)))).catchType(Promise.CancellationError,(()=>{})),(0,B.requireStatusV3Collection)().then((e=>{e.sync()})),I.default.isSMB){if(F.default.supportsFeature(F.default.F.QUICK_REPLIES_QUERY))r(75537).default.sync();(0,G.canDisplayLabel)()&&(0,B.requireLabelCollection)().then((e=>{e.sync()}))}}return(0,B.requireMsgCollection)().cancellable().then((e=>{e.markAllAsStale()})).then((()=>(this.stream=this.hasSynced?Xt.RESUMING:Xt.SYNCING,this.socket.onmessage=this.onMessage.bind(this),this.socket.releaseMessages(),e))).catchType(Promise.CancellationError,(function(){e.cancel()}))}queryReceivedActions(){var e=this,t=(0,l.default)(this.sendQueue,"clientCacheable"),a=(0,h.default)(t,"tag").filter((function(e){return e}));return __LOG__(2)(Me()),0===a.length?Promise.resolve():r(76022).default.queryReceivedActions(a).then((function(r){Array.isArray(r)?r.forEach((function(t){var r=function(e,t){for(var r=t;r<e.length;r++){var a=e[r];if(a.tag)return a}}(e.sendQueue,parseInt(t.id,10)||0);if(r)if(__LOG__(2)(we(),t.id,t.code),delete e.sendHash[t.id],Z.default.delete(t.id),e.sendQueue=(0,u.default)(e.sendQueue,r),r.onSend){var a=r.onSend({status:t.code,_duplicate:!0});yr.test(a)&&r.onDrop(new N.Server5xxDrop)}else __LOG__(3)(Oe(),t.id),r.onDrop(new N.ConventionViolationDrop);else __LOG__(3)(Pe(),t.id)})):"replaced"===r?(t.forEach((function(e){e.onDrop(new N.BrowserReplacedDrop)})),e.sendQueue=(0,c.default)(e.sendQueue,t)):__LOG__(3)(Ce())}))}runResume(e){return Promise.all([this.queryReceivedActions(),(0,B.requireChatCollection)().then((e=>e.resyncMessages())),(0,B.requireMsgCollection)().then((e=>e.resyncReceipts()))]).then((()=>{this.trigger("didResume"),this.flushQueue(),this.stream=Xt.CONNECTED})).catchTypes(N.WebdDrop,Promise.CancellationError,(()=>{this.stream=Xt.DISCONNECTED})).catch((t=>{if(!e)throw __LOG__(3,!0)(Ae(),String(t),t.stack),C.upload({reason:"error-on-resume"}),this.stream=Xt.DISCONNECTED,new or;if(this.canSend)return this.runResume(!1);this.unset("resumePromise")}))}setPokeable(e,t=this.retryTimestamp){return this.set({pokeable:{poke(){e.cancel(new $t)}},retryTimestamp:t}),e}clearCredentials(){var e=this;return(0,i.default)((function*(){try{yield e.clearState()}catch(e){}try{(0,U.setBrowserId)()}catch(e){}try{(0,U.setUnknownId)()}catch(e){}try{(0,U.setMe)()}catch(e){}if(F.default.supportsFeature(F.default.F.MD_BACKEND)){try{(0,re.clearRegistrationInfo)()}catch(e){}try{yield(0,oe.destroy)()}catch(e){}try{yield(0,ne.deleteEncKeysAndCache)(),(0,ue.deleteSalt)()}catch(e){}}else{try{(0,U.clearTokens)()}catch(e){}try{V.clear()}catch(e){}}try{yield(0,U.clearAllLocalState)()}catch(e){}window.location.reload()}))()}clearState(){var e=this;return(0,i.default)((function*(){__LOG__(2)(be()),e.sendQueue=[],e.clearSendHash(!0),e.unset("hasSynced");try{(yield(0,B.requireClearAppStates)())()}catch(e){e instanceof L.DbOnLogoutAbort?__LOG__(3)(Te(),e.stack):(__LOG__(4,void 0,new Error,!0)(Se(),e.stack),SEND_LOGS("clear_session_app_state"))}try{yield(0,P.default)()}catch(e){e instanceof L.DbOnLogoutAbort?__LOG__(3)(ye(),e.stack):(__LOG__(4,void 0,new Error,!0)(Ee(),e.stack),SEND_LOGS("clear_persistent_app_state"))}}))()}maybeResendRequestEventually(e){var t=300*Q.expBackoff(e.resends,100);__LOG__(2)(ve(),e.toString(),t),e.state=W.default.STATE.WILL_RETRY,e.resendTimer=setTimeout((()=>{e.resends++,e.resendTimer=void 0,this.sendHash[e.tag]===e&&(!e.resendGuard||e.resendGuard()?this._send(e):e.onSend({status:408}))}),t)}sendCurrentLogout(e){var t;F.default.supportsFeature(F.default.F.MD_BACKEND)?(t=(0,ie.default)().then((e=>{200!==e.status&&__LOG__(3)(ge(),e.status),(0,se.stopComms)()})).catch((e=>{__LOG__(4,!0,new Error)(me(),e.stack)})))||(t=Promise.reject(new Error("sendCurrentLogout: should not reach"))):t=(V.load()?r(76022).default.logoutToken().then((e=>{var t={t:(0,U.getLogoutToken)(),m:e},r=(0,U.getOldLogoutCreds)();return r.push(t),(0,U.setOldLogoutCreds)(r),t})):Promise.resolve({})).then((t=>{if(e&&e.state===ee.STATE.OPEN){var r=this.logoutMutex;this.logoutMutex=r<=0?r=1:++r,__LOG__(2)(_e()),e.partingSend(new lr,'goodbye,,["admin","Conn","disconnect"]',(e=>0===e.indexOf("goodbye,"))).then((function(e){e?(__LOG__(2)(he()),Cr(t)):__LOG__(3)(pe())})).finally((()=>{this.logoutMutex===r&&(this.logoutMutex=0)}))}else this.logoutMutex<0&&(this.logoutMutex=0),this.sendRemainingLogouts()}));return t}sendRemainingLogouts(){var e=this.logoutMutex;if(0===e){var t=r(69835).default,a=(0,U.getOldLogoutCreds)();0!==a.length?(this.logoutMutex=e=1,Promise.all((0,h.default)(a,(function(e){return __LOG__(2)(fe()),t.post(Jt,e).then((function(){Cr(e)})).catch((function(){__LOG__(3)(ce())}))}))).finally((()=>{e===this.logoutMutex&&(this.logoutMutex=0)}))):this.logoutMutex=-1}}updateImmediately(e){C.upload({reason:e,immediate:!0}).finally((()=>{X.default.restart(!0)}))}deprecatedVersion(){__LOG__(2)(de()),C.upload({reason:"ws2:deprecated version",immediate:!0});var e=this.setPokeable((new J.default).cancellable().catchType($t,(()=>!1))).cancellable();return this.clearState(),this.set({state:Qt.DEPRECATED_VERSION,runPromise:e}),e}canRequestBeSent(e){return!!this.canSend||Boolean(this.socket)&&(0,U.knowsPhone)()&&e.serverCacheable}}function Ar(e){return e instanceof v.Binary}function Cr(e){var t=(0,U.getOldLogoutCreds)(),r=(0,o.default)(e);(0,U.setOldLogoutCreds)((0,l.default)(t,(e=>!r(e))))}var Pr=new((0,b.defineModel)(br));t.default=Pr},88122:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.initialize=function(){null==d&&((0,o.createStorage)(),(0,s.addTable)(),(0,u.addTable)(),d=(0,o.getStorage)().initialize().catch((e=>{throw __LOG__(4,!0,new Error,!0)(l()),SEND_LOGS("Failed to initialize fts storage"),e})));return d},t.destroy=function(){return(0,o.destroyStorage)().catch((()=>c.resolve(new i.default(o.DATABASE_NAME).delete()))).finally((()=>{d=null}))},t.clearInitializePromise=function(){d=null},Object.defineProperty(t,"getManifestTable",{enumerable:!0,get:function(){return s.getTable}}),Object.defineProperty(t,"getIndexV1Table",{enumerable:!0,get:function(){return u.getTable}});var n=a(r(19976)),i=a(r(77715)),s=r(75959),o=r(50777),u=r(84605);function l(){var e=(0,n.default)(["Assertion failed!"]);return l=function(){return e},e}var d,c=r(41449).Z},75959:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.addTable=function(){(0,i.getStorage)().add(u).version((0,o.manifestCreateTable)(),[new s.default("key"),new n.default("tokenizerVersion"),new n.default("schemaVersion"),new n.default("isCurrent"),new n.default("lastMsgKeyViaFullIndexer"),new n.default("isFullIndexingComplete")]).view((e=>e||null))},t.getTable=function(){return(0,i.getStorage)().table(u)},t.ManifestKeys=t.TABLE_NAME=void 0;var n=a(r(30530)),i=r(50777),s=a(r(58642)),o=r(95005),u="manifest";t.TABLE_NAME=u;var l=Object.freeze({PREV_VERSION:"prev.version",CURR_VERSION:"curr.version",NEXT_VERSION:"next.version"});t.ManifestKeys=l},84605:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.addTable=function(){(0,d.getStorage)().add(f).version((0,c.ftsIndexCreateTable)(),[new l.default("id"),new u.default("token",u.ENCRYPTED_VALUE_TYPE.STRING),new o.default("messages"),new s.default("messages"),new o.default("blindIndices"),new s.default("blindIndices")]).view((e=>e?new p(e.id,e.token,e.blindIndices,e.messages):null))},t.getTable=function(){return(0,d.getStorage)().table(f)},t.FtsIndexEntry=t.TABLE_NAME=void 0;var i=n(r(84636)),s=n(r(66879)),o=n(r(30530)),u=a(r(80522)),l=n(r(72948)),d=r(50777),c=r(95005),f="fts-v1-index";t.TABLE_NAME=f;class p{constructor(e,t,r,a){null!=e&&(this.id=e),this.token=t,this.blindIndices=r||[],this.messages=a||[]}addMessageIds(e){null!=e&&(this.messages=(0,i.default)([...this.messages,...e],(([e])=>e)))}}t.FtsIndexEntry=p},50777:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.createStorage=function(){var e=new i.default(o);u=new s.default(e)},t.getStorage=function(){return(0,n.default)(null!=u,"[fts-storage] Storage should be created first before being accessed"),u},t.destroyStorage=function(){if(null==u)return Promise.reject(new Error("[fts-storage] Storage should be created first before being destroyed"));return u.purge().then((()=>{u=null})).catch((e=>{throw u=null,e}))},t.DATABASE_NAME=void 0;var n=a(r(47677)),i=a(r(2206)),s=a(r(6957)),o="fts-storage-dogfooding";t.DATABASE_NAME=o;var u=null},95005:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ftsIndexCreateTable=function(){return(0,a.getStorage)().versions.version(0)},t.manifestCreateTable=function(){return(0,a.getStorage)().versions.version(1)};var a=r(50777)},48816:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.initialize=function(){null==n&&(n=s.default.initialize().catch((e=>{throw __LOG__(4,!0,new Error,!0)(l()),SEND_LOGS("Failed to initialize hsm storage"),e})));return n},Object.defineProperty(t,"HsmLanguagePackRequestInfo",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(t,"HsmTranslation",{enumerable:!0,get:function(){return u.default}});var n,i=a(r(19976)),s=a(r(34445)),o=a(r(93063)),u=a(r(68634));function l(){var e=(0,i.default)(["Assertion failed!"]);return l=function(){return e},e}},93063:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(30530)),i=a(r(9387)),s=a(r(34445)),o=a(r(58642));s.default.add("hsm-language-pack-request-info").version(s.default.versions.version(0),[new o.default("id"),new n.default("namespace"),new n.default("phoneLg"),new n.default("phoneLc"),new n.default("lg"),new n.default("lc"),new n.default("resultLg"),new n.default("resultLc"),new n.default("hash"),new n.default("responseTime"),new i.default(["namespace","phoneLc","phoneLg"])]).view((e=>({id:e.id,namespace:e.namespace,phoneLg:e.phoneLg,phoneLc:e.phoneLc,lg:e.lg,lc:e.lc,resultLg:e.resultLg,resultLc:e.resultLc,hash:e.hash,responseTime:e.responseTime})));var u=s.default.table("hsm-language-pack-request-info");t.default=u},68634:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(30530)),i=a(r(90146)),s=a(r(34445)),o=a(r(58642));s.default.add("hsm-translation").version(s.default.versions.version(1),[new o.default("id"),new n.default("languagePackId"),new i.default("languagePackId"),new n.default("translation")]).view((e=>({id:e.id,languagePackId:e.languagePackId,translation:e.translation})));var u=s.default.table("hsm-translation");t.default=u},34445:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(2206)),i=a(r(6957)),s=new n.default("hsm-storage"),o=new i.default(s);t.default=o},88857:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.initialize=function(){null==l&&((0,s.createStorage)(),(0,o.addTable)(),l=(0,s.getStorage)().initialize().catch((e=>{throw __LOG__(4,!0,new Error,!0)(u()),SEND_LOGS("Failed to initialize jobs storage"),e})));return l},t.destroy=function(){return(0,s.destroyStorage)().catch((()=>d.resolve(new i.default(s.DATABASE_NAME).delete()))).finally((()=>{l=null}))},Object.defineProperty(t,"getJobsTable",{enumerable:!0,get:function(){return o.getTable}});var n=a(r(19976)),i=a(r(77715)),s=r(15020),o=r(22807);function u(){var e=(0,n.default)(["Assertion failed!"]);return u=function(){return e},e}var l,d=r(41449).Z},22807:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.addTable=function(){(0,o.getStorage)().add("jobs-store").version((0,u.jobsCreateTable)(),[new s.default("jobId"),new n.default("type"),new n.default("uniqKey"),new i.default("uniqKey"),new n.default("original"),new n.default("current"),new n.default("step"),new n.default("startTime"),new n.default("endTime"),new n.default("stepHardStartCountAfterTimeout"),new n.default("stepFirstStartTime"),new n.default("waitUntil"),new n.default("backedOffCount"),new n.default("version")]).view((e=>({jobId:e.jobId,type:e.type,uniqKey:e.uniqKey,original:e.original,current:e.current,step:e.step,startTime:e.startTime,endTime:e.endTime,stepHardStartCountAfterTimeout:e.stepHardStartCountAfterTimeout,stepFirstStartTime:e.stepFirstStartTime,waitUntil:e.waitUntil,backedOffCount:e.backedOffCount,version:e.version})))},t.getTable=function(){return(0,o.getStorage)().table("jobs-store")};var n=a(r(30530)),i=a(r(90146)),s=a(r(72948)),o=r(15020),u=r(47678)},15020:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.createStorage=function(){var e=new i.default(o);u=new s.default(e)},t.getStorage=function(){return(0,n.default)(null!=u,"[jobs-storage] Storage should be created first before being accessed"),u},t.destroyStorage=function(){if(null==u)return Promise.reject(new Error("[jobs-storage] Storage should be created first before being destroyed"));return u.purge().then((()=>{u=null})).catch((e=>{throw u=null,e}))},t.DATABASE_NAME=void 0;var n=a(r(47677)),i=a(r(2206)),s=a(r(6957)),o="jobs-storage";t.DATABASE_NAME=o;var u=null},47678:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.jobsCreateTable=function(){return(0,a.getStorage)().versions.version(0)};var a=r(15020)},2206:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,i=a(r(19976)),s=a(r(52954)),o=a(r(77715)),u=a(r(47677)),l=r(80522),d=a(r(61941)),c=r(7053);function f(){var e=(0,i.default)(["idb faild to do Operation: "," on Table: ",". Failed with error ",""]);return f=function(){return e},e}var p=null;p=r(72291).default,n=r(72291).DB_ENCRYPTION_CIPHER;var h=r(41449).Z;function _(){return(_=(0,s.default)((function*(e,t,r,a){if(!p)throw new Error("feature is not yet implemented");var i=a?p.dbMsgEncKeys[p.dbMsgEncKeys.length-1]:p.encKeys[p.encKeys.length-1],s=new Uint8Array(16);self.crypto.getRandomValues(s);var u=r===l.ENCRYPTED_VALUE_TYPE.STRING?(new TextEncoder).encode(e):e;try{var d=self.crypto.subtle.encrypt({iv:s,name:n},i.key,u),c=null==o.default.currentTransaction?d:o.default.waitFor(d);return{_data:yield h.resolve(c),iv:s,_keyId:i.id}}catch(r){throw b(r,"encryptDbMaterial",null,e,t),r}}))).apply(this,arguments)}function m(){return(m=(0,s.default)((function*(e,t,r,a){if(!p)throw new Error("feature is not yet implemented");var{_data:i,iv:s,_keyId:d}=e,c=a?p.dbMsgEncKeys.filter((e=>e.id===d))[0]:p.encKeys.filter((e=>e.id===d))[0];if((0,u.default)(null!=c,"Encryption key id not found"),null==i)return i;try{var f=self.crypto.subtle.decrypt({iv:s,name:n},c.key,i),_=null==o.default.currentTransaction?f:o.default.waitFor(f),m=yield h.resolve(_);return r===l.ENCRYPTED_VALUE_TYPE.STRING?new TextDecoder("utf-8").decode(m):m}catch(e){throw b(e,"encryptDbMaterial",null,t),e}}))).apply(this,arguments)}class g{constructor(e,t,r,a,n,i){this.table=e,this.view=r,this.db=t,this.propFilter=a,this.tableEncryptedColumns=new Map(Object.keys(n).map((e=>[e,n[e]]))),this.shouldUseDbMsgEncKeyForEncryptedCol=i}asyncView(e){var t=this;return(0,s.default)((function*(){if(!t._hasEncryptedColumn())return t.view(e);var r=yield t._decryptColumns(e);return t.view(r)}))()}_decryptColumns(e){var t=this;return(0,s.default)((function*(){(0,u.default)("object"==typeof e,"Called `_decryptColumns` with primitive value");var r=Array.from(t.tableEncryptedColumns.entries()).map((([r,a])=>{var n=e[r];return(null==n?void 0:n._data)&&(null==n?void 0:n.iv)?function(){return m.apply(this,arguments)}(n,r,a,t.shouldUseDbMsgEncKeyForEncryptedCol).then((t=>{e[r]=t})):n}));return yield Promise.all(r),e}))()}_encryptColumns(e){var t=Array.from(this.tableEncryptedColumns.entries()).map((([t,r])=>{var a=e[t];return null==a?a:function(){return _.apply(this,arguments)}(a,t,r,this.shouldUseDbMsgEncKeyForEncryptedCol).then((r=>{e[t]=r}))}));return Promise.all(t).then((()=>e))}_addAndEncrypt(e){var t=this;return(0,s.default)((function*(){if(!t._hasEncryptedColumn())return t.table.add(e);var r=yield t._encryptSingleUpdate(e);return t.table.add(r)}))()}_putAndEncrypt(e){var t=this;return(0,s.default)((function*(){if(!t._hasEncryptedColumn())return t.table.put(e);var r=yield t._encryptColumns(e);return t.table.put(r)}))()}_bulkAddAndEncrypt(e){return this._hasEncryptedColumn()?this._encryptBulkUpdates(e).then((e=>this.table.bulkAdd(e))):this.table.bulkAdd(e)}_bulkPutAndEncrypt(e){return this._hasEncryptedColumn()?o.default.waitFor(this._encryptBulkUpdates(e)).then((e=>this.table.bulkPut(e))):this.table.bulkPut(e)}_encryptBulkUpdates(e){if(!this._hasEncryptedColumn())return h.resolve(e);var t=[],r=e.map(((e,r)=>this._encryptColumns(e).then((e=>{t[r]=e}))));return Promise.all(r).then((()=>t))}_encryptSingleUpdate(e){var t=this;return(0,s.default)((function*(){return t._hasEncryptedColumn()?yield t._encryptColumns(e):e}))()}asyncViewMap(e,t=!0){if(!this._hasEncryptedColumn()||!t)return Promise.resolve(e.map((e=>e?this.view(e):null)));var r=e.map((e=>null!=e?this.asyncView(e):h.resolve(null)));return h.resolve(null==o.default.currentTransaction?Promise.all(r):o.default.waitFor(Promise.all(r)))}preflightEncryptSingleRecord(e){return this.tableEncryptedColumns,Object.keys(e).forEach((t=>{this.tableEncryptedColumns.has(t)||delete e[t]})),this._encryptColumns(e)}postflightDecryptSingleRecord(e){var t=this;return(0,s.default)((function*(){var r=yield t._decryptColumns(e);return t.view(r)}))()}bulkCreateWith_ALREADY_ENCRYPTED_RECORDS_ONLY(e){return A(e,this.tableEncryptedColumns),h.resolve(this.table.bulkAdd(e)).catch((t=>{throw b(t,"bulkCreateWith_ALREADY_ENCRYPTED_RECORDS_ONLY",this.table.name,e),t}))}bulkCreateOrReplace_ALREADY_ENCRYPTED_RECORDS_ONLY(e){return A(e,this.tableEncryptedColumns),h.resolve(this.table.bulkPut(e)).catch((t=>{throw b(t,"bulkCreateOrReplace",this.table.name,e),t}))}create(e){var t=this.propFilter(e);return h.resolve(this._addAndEncrypt(t)).catch((t=>{throw b(t,"create",this.table.name,e),t}))}createOrReplace(e){var t=this.propFilter(e);return h.resolve(this._putAndEncrypt(t)).catch((t=>{throw b(t,"createOrReplace",this.table.name,e),t}))}createOrMerge(e,t){var r=this;return(0,s.default)((function*(){var a=r.propFilter(t),n=yield r._encryptColumns(a);return h.resolve(r.db.transaction("rw",r.table,(()=>{r.table.where(":id").equals(e).modify((e=>{Object.assign(e,n)})).then((e=>{if(1!==e)return r.table.add(n)}))})).then((()=>{}))).catch((a=>{throw b(a,"createOrMerge",r.table.name,e,t),a}))}))()}get(e){return h.resolve(this.table.get(e)).then((e=>e?this.asyncView(e):null)).catch((t=>{throw b(t,"get",this.table.name,e),t}))}merge(e,t){var r=this;return(0,s.default)((function*(){var a=r.propFilter(t),n=yield r._encryptSingleUpdate(a);return h.resolve(r.table.update(e,n)).catch((a=>{throw b(a,"merge",r.table.name,e,t),a}))}))()}remove(e){return h.resolve(this.table.delete(e)).catch((t=>{throw b(t,"remove",this.table.name,e),t}))}bulkCreate(e){var t=e.map((e=>this.propFilter(e)));return h.resolve(this.db.transaction("rw",this.table,(()=>this._bulkAddAndEncrypt(t)))).catch((t=>{throw b(t,"bulkCreate",this.table.name,e),t}))}bulkCreateOrReplace(e){var t=e.map((e=>this.propFilter(e)));return h.resolve(this.db.transaction("rw",this.table,(()=>this._bulkPutAndEncrypt(t)))).catch((t=>{throw b(t,"bulkCreateOrReplace",this.table.name,e),t}))}bulkCreateOrMerge(e){var t=this;return(0,s.default)((function*(){var r=new Map,a=t._primaryKey();function n(){return(n=(0,s.default)((function*(e){var r=t.table.where(":id").anyOf(Array.from(e.keys()));return yield r.modify((t=>{Object.assign(t,e.get(t[a])),e.delete(t[a])})),Array.from(e.values())}))).apply(this,arguments)}return(yield t._encryptBulkUpdates(e)).forEach((e=>{var n=t.propFilter(e);(0,u.default)(a in n,"Called `bulkCreateOrMerge` with item(s) not including the primary key"),r.set(n[a],n)})),h.resolve(t.db.transaction("rw",t.table,(()=>function(){return n.apply(this,arguments)}(r).then((e=>0===e.length?h.resolve():t.table.bulkPut(e)))))).catch((r=>{throw b(r,"bulkCreateOrMerge",t.table.name,e),r}))}))()}bulkGet(e,t=!0){return h.resolve(this.db.transaction("r",this.table,(()=>{var t=e.map((e=>this.table.get(e)));return o.default.Promise.all(t)}))).then((e=>this.asyncViewMap(e,t))).catch((t=>{throw b(t,"bulkGet",this.table.name,e),t}))}bulkRemove(e){return h.resolve(this.db.transaction("rw",this.table,(()=>this.table.bulkDelete(e)))).catch((t=>{throw b(t,"bulkRemove",this.table.name,e),t}))}all(e,t){var r=S(this.table.orderBy(e&&e.index?y(e.index):":id"),e);t&&(r=r.until(t));var a=null;switch(null==e?void 0:e.returnKeyType){case"keys":a=h.resolve(r.keys());break;case"primary_key":a=h.resolve(r.primaryKeys());break;default:a=h.resolve(r.toArray()).then((t=>this.asyncViewMap(t,null==e?void 0:e.shouldDecrypt)))}return a.catch((t=>{throw b(t,"all",this.table.name,e),t}))}count(){return h.resolve(this.table.count()).catch((e=>{throw b(e,"count",this.table.name),e}))}equals(e,t,r){return h.resolve(S(this.table.where(y(e)).equals(t),r).toArray()).then((e=>this.asyncViewMap(e,null==r?void 0:r.shouldDecrypt))).catch((a=>{throw b(a,"equals",this.table.name,e,t,r),a}))}anyOf(e,t,r){return h.resolve(S(this.table.where(y(e)).anyOf(t),r).toArray()).then((e=>this.asyncViewMap(e,null==r?void 0:r.shouldDecrypt))).catch((a=>{throw b(a,"anyOf",this.table.name,e,t,r),a}))}greaterThan(e,t,r){var a=r&&r.inclusive?this.table.where(y(e)).aboveOrEqual(t):this.table.where(y(e)).above(t);return h.resolve(S(a,r).toArray()).then((e=>this.asyncViewMap(e,null==r?void 0:r.shouldDecrypt))).catch((a=>{throw b(a,"greaterThan",this.table.name,e,t,r),a}))}lessThan(e,t,r){var a=r&&r.inclusive?this.table.where(y(e)).belowOrEqual(t):this.table.where(y(e)).below(t);return h.resolve(S(a,r).toArray()).then((e=>this.asyncViewMap(e))).catch((a=>{throw b(a,"lessThan",this.table.name,e,t,r),a}))}between(e,t,r,a,n){var i=S(this.table.where(y(e)).between(t,r,!(!a||!a.lowerInclusive),!(!a||!a.upperInclusive)),a),s=null;switch(null==a?void 0:a.returnKeyType){case"keys":s=h.resolve(i.keys());break;case"primary_key":s=h.resolve(i.primaryKeys());break;default:s=n?h.resolve(i.until(n).toArray()).then((()=>[])):h.resolve(i.toArray()).then((e=>this.asyncViewMap(e,null==a?void 0:a.shouldDecrypt)))}return s.catch((n=>{throw b(n,"between",this.table.name,e,t,r,a),n}))}forEachSortedBy(e,t){var r=this;return this.table.orderBy(e).each(function(){var e=(0,s.default)((function*(e){var a=yield r._decryptColumns(e);return t(a)}));return function(){return e.apply(this,arguments)}}()).catch((r=>{throw b(r,"forEachSortedBy",this.table.name,e,t),r}))}forEach(e){var t=this;return this.table.each(function(){var r=(0,s.default)((function*(r){var a=yield t._decryptColumns(r);return e(a)}));return function(){return r.apply(this,arguments)}}()).catch((t=>{throw b(t,"forEach",this.table.name,e),t}))}clear(){return h.resolve(this.table.clear()).catch((e=>{throw b(e,"clear",this.table.name),e}))}_primaryKey(){return this.table.schema.primKey.name}_hasEncryptedColumn(){return this.tableEncryptedColumns.size>0}}function v(e){if(e.length>1)return e.forEach((e=>{(0,u.default)(e.primaryKey&&e.primaryKey===c.PRIMARY_KEY_TYPE.COMPOSITE,"Invalid column passed to `formatPrimaryKey`")})),"[".concat(e.map((e=>e.name)).join("+"),"]");var t=e[0];return(0,u.default)(t.primaryKey&&t.primaryKey!==c.PRIMARY_KEY_TYPE.COMPOSITE,"Invalid column passed to `formatPrimaryKey`"),t.primaryKey===c.PRIMARY_KEY_TYPE.AUTO_INCREMENT?"".concat(t.name,"++"):t.name}function E(e){switch(e.type){case c.INDEX_TYPE.SIMPLE:return e.column;case c.INDEX_TYPE.COMPOSITE:return"[".concat(e.columns.join("+"),"]");case c.INDEX_TYPE.ARRAY:return"*".concat(e.column);case c.INDEX_TYPE.UNIQUE:return"&".concat(e.column)}throw new Error('Cannot format index of type "'.concat(e.type,'"'))}function y(e){return 1===e.length?e[0]:"[".concat(e.join("+"),"]")}function S(e,t){var r=e;return t&&t.reverse&&(r=r.reverse()),t&&null!=t.offset&&(r=r.offset(t.offset)),t&&null!=t.limit&&0!==t.limit&&(r=r.limit(t.limit)),r}function T(e){return h.resolve(e)}function b(e,t,r,...a){__LOG__(3,!0)(f(),t,r,e)}function A(e,t){var r=Array.from(t.entries());e.forEach((()=>{r.forEach((([t,r])=>{if(e[t]&&!(e[t]._keyId&&e[t]._data&&e[t].iv))throw new Error("[CRITICAL] Records contain unencrypted field")}))}))}t.default=class{constructor(e,t=T){this.tableNames=new Map,this.tableColumns=new Map,this.tableEncryptedColumns=new Map,this.name=e,this.db=new o.default(this.name),this.transformSchema=t}initialize(e,t,r){return function(e,t,r,a,n){return Promise.reduce(e,((e,i)=>n((0,c.cloneSchema)(i)).then((n=>{if((0,u.default)(!(n.name in e),"Multiple tables resulted in the same transformed name"),n.deleted)return e[n.name]=null,e;t.set(i.name,n.name),r.set(i.name,n.columns.map((e=>e.name))),a.set(i.name,n.encryptedColumns||{});var s=n.columns.filter((e=>e.primaryKey));(0,u.default)(s.length>=1,'No primary key was defined for "'.concat(i.name,'"'));var o=[v(s)].concat(n.indexes.map(E)).join(", ");return e[n.name]=o,e}))),{})}(t,this.tableNames,this.tableColumns,this.tableEncryptedColumns,this.transformSchema).then((t=>{this.db.version(e+1).stores(t).upgrade((e=>{var t;if(r)return null===(t=e[r.name])||void 0===t?void 0:t.toCollection().modify(r.callback)}))}))}open(){return h.resolve(this.db.open())}transact(e,t,r="rw"){return h.resolve(this.db.transaction(r,e,(()=>t())))}close(){return this.db.close(),h.resolve()}view(e,t,r,a){(0,u.default)(this.tableNames.has(e),'Attemped to get view for uninitialized table "'.concat(e,'"')),(0,u.default)(this.tableColumns.has(e),'Attemped to get columns for uninitialized table "'.concat(e,'"'));var n=r?function(e){if(!e)return e=>e;return t=>{var r={};return e.forEach((e=>{t.hasOwnProperty(e)&&(r[e]=t[e])})),r}}(this.tableColumns.get(e)):e=>e;return new g(this.db.table(this.tableNames.get(e)),this.db,t,n,(0,d.default)(this.tableEncryptedColumns.get(e),"this.tableEncryptedColumns.get(table)"),a)}available(){return h.resolve(!0)}reset(){return this.tableNames=new Map,h.resolve(this.db.delete()).finally((()=>{this.db=new o.default(this.name)}))}}},27433:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(96452),i=a(r(76936));t.default=class{constructor(e){this._view=e}_read(e){return i.default.isLogoutInProgress?Promise.reject(new n.DbOnLogoutAbort("dropping db read operation due to logout")):e(this._view())}_write(e){return i.default.isLogoutInProgress?Promise.reject(new n.DbOnLogoutAbort("dropping db write operation due to logout")):e(this._view())}create(e){return this._write((t=>t.create(e)))}preflightEncryptSingleRecord(e){return this._write((t=>t.preflightEncryptSingleRecord(e)))}postflightDecryptSingleRecord(e){return this._write((t=>t.postflightDecryptSingleRecord(e)))}bulkCreateWith_ALREADY_ENCRYPTED_RECORDS_ONLY(e){return this._write((t=>t.bulkCreateWith_ALREADY_ENCRYPTED_RECORDS_ONLY(e)))}bulkCreateOrReplace_ALREADY_ENCRYPTED_RECORDS_ONLY(e){return this._write((t=>t.bulkCreateOrReplace_ALREADY_ENCRYPTED_RECORDS_ONLY(e)))}createOrReplace(e){return this._write((t=>t.createOrReplace(e)))}createOrMerge(e,t){return this._write((r=>r.createOrMerge(e,t)))}get(e){return this._read((t=>t.get(e)))}merge(e,t){return this._write((r=>r.merge(e,t)))}remove(e){return this._write((t=>t.remove(e)))}bulkCreate(e){return this._write((t=>t.bulkCreate(e)))}bulkCreateOrReplace(e){return this._write((t=>t.bulkCreateOrReplace(e)))}bulkCreateOrMerge(e){return this._write((t=>t.bulkCreateOrMerge(e)))}bulkGet(e,t){return this._read((r=>r.bulkGet(e,t)))}bulkRemove(e){return this._write((t=>t.bulkRemove(e)))}all(e,t){return this._read((r=>r.all(e,t)))}count(){return this._read((e=>e.count()))}equals(e,t,r){return this._read((a=>a.equals(e,t,r)))}anyOf(e,t,r){return this._read((a=>a.anyOf(e,t,r)))}greaterThan(e,t,r){return this._read((a=>a.greaterThan(e,t,r)))}lessThan(e,t,r){return this._read((a=>a.lessThan(e,t,r)))}between(e,t,r,a,n){return this._read((i=>i.between(e,t,r,a,n)))}forEachSortedBy(e,t){return this._read((r=>r.forEachSortedBy(e,t)))}forEach(e){return this._read((t=>t.forEach(e)))}clear(){return this._write((e=>e.clear()))}}},91695:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(47677)),i=a(r(6053));class s extends i.default{constructor(e){super(),(0,n.default)("AbstractPrimaryKey"!==this.constructor.name,"Cannot instantiate abstract class AbstractPrimaryKey"),Array.isArray(e)?this.columns=[...e]:this.columns=[e]}validate(e){(0,n.default)(0===e.columns.length,"Attempted to add primary key after other columns")}apply(){throw new Error("Subclass of `AbstractPrimaryKey` must implement `apply` method")}}t.default=s},66879:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(47677)),i=a(r(6053)),s=r(7053);class o extends i.default{constructor(e){super(),this.column=e}validate(e){var t=e.columns.find((e=>e.name===this.column));(0,n.default)(t,'Attempted to add index on non-existent column "'.concat(this.column,'" in "').concat(e.name,'"')),(0,n.default)(t&&(!t.primaryKey||t.primaryKey===s.PRIMARY_KEY_TYPE.COMPOSITE),'Cannot add index on primary key on table "'.concat(e.name,'"')),(0,n.default)(!e.indexes.some((e=>(e.type===s.INDEX_TYPE.ARRAY||e.type===s.INDEX_TYPE.SIMPLE||e.type===s.INDEX_TYPE.UNIQUE)&&(0,s.indexContainsColumn)(e,this.column))),'Attempted to add index "'.concat(this.column,'" which already exists in "').concat(e.name,'"'))}apply(e){var t=(0,s.cloneSchema)(e);return t.indexes.push(this._getIndex()),t}_getIndex(){return{type:s.INDEX_TYPE.ARRAY,column:this.column}}}t.default=o},30530:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(47677)),i=a(r(6053)),s=r(7053);class o extends i.default{constructor(e){super(),this.name=e}validate(e){(0,n.default)(!e.columns.find((e=>e.name===this.name)),'Attempted to add column "'.concat(this.name,'" to "').concat(e.name,'" but it already exists'))}apply(e){var t=(0,s.cloneSchema)(e);return t.columns.push({name:this.name}),t}}t.default=o},9387:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(47677)),i=a(r(6053)),s=r(7053);class o extends i.default{constructor(e){super(),this.columns=[...e]}validate(e){this.columns.forEach((t=>{(0,n.default)(e.columns.find((e=>e.name===t)),'Attempted to add index on non-existent column "'.concat(t,'" in "').concat(e.name,'"'))})),(0,n.default)(this.columns.length>1,"Attempted to add composite index for only 1 column"),(0,n.default)(-1===(0,s.findIndex)(e,this._getIndex()),"Attempted to add index [".concat(String(this.columns),'], which already exists in "').concat(e.name,'"'));var t=e.columns.filter((e=>e.primaryKey&&e.primaryKey===s.PRIMARY_KEY_TYPE.COMPOSITE)).map((e=>e.name));(0,n.default)(t.length!==this.columns.length||t.some((e=>!this.columns.includes(e))),"Attempted to add index [".concat(String(this.columns),'], which already is the primary key in "').concat(e.name,'"'))}apply(e){var t=(0,s.cloneSchema)(e);return t.indexes.push(this._getIndex()),t}_getIndex(){return{type:s.INDEX_TYPE.COMPOSITE,columns:this.columns}}}t.default=o},80522:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.ENCRYPTED_VALUE_TYPE=void 0;var n=a(r(47677)),i=a(r(6053)),s=r(7053),o=Object.freeze({STRING:"String",ARRAY_BUFFER:"ArrayBuffer"});t.ENCRYPTED_VALUE_TYPE=o;class u extends i.default{constructor(e,t){super(),this.name=e,this.dataType=t}validate(e){(0,n.default)(!e.columns.find((e=>e.name===this.name)),'Attempted to add encrypted column "'.concat(this.name,'" to "').concat(e.name,'" but it already exists'))}apply(e){var t=(0,s.cloneSchema)(e);return t.columns.push({name:this.name}),t.encryptedColumns[this.name]=this.dataType,t}}t.default=u},90146:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(47677)),i=a(r(6053)),s=r(7053);class o extends i.default{constructor(e){super(),this.keyPath=e,this.column=e.split(".")[0]}validate(e){var t=e.columns.find((e=>e.name===this.column));(0,n.default)(t,'Attempted to add index on non-existent column "'.concat(this.column,'" in "').concat(e.name,'"')),(0,n.default)(t&&(!t.primaryKey||t.primaryKey===s.PRIMARY_KEY_TYPE.COMPOSITE),'Cannot add index on primary key on table "'.concat(e.name,'"')),(0,n.default)(!e.indexes.some((e=>(e.type===s.INDEX_TYPE.ARRAY||e.type===s.INDEX_TYPE.SIMPLE||e.type===s.INDEX_TYPE.UNIQUE)&&(0,s.indexContainsColumn)(e,this.column))),'Attempted to add index "'.concat(this.column,'" which already exists in "').concat(e.name,'"'))}apply(e){var t=(0,s.cloneSchema)(e);return t.indexes.push(this._getIndex()),t}_getIndex(){return{type:s.INDEX_TYPE.SIMPLE,column:this.keyPath}}}t.default=o},95745:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(47677)),i=a(r(6053)),s=r(7053);class o extends i.default{constructor(e){super(),this.column=e}validate(e){var t=e.columns.find((e=>e.name===this.column));(0,n.default)(t,'Attempted to add index on non-existent column "'.concat(this.column,'" in "').concat(e.name,'"')),(0,n.default)(t&&(!t.primaryKey||t.primaryKey===s.PRIMARY_KEY_TYPE.COMPOSITE),'Cannot add index on primary key on table "'.concat(e.name,'"')),(0,n.default)(!e.indexes.some((e=>(e.type===s.INDEX_TYPE.ARRAY||e.type===s.INDEX_TYPE.SIMPLE||e.type===s.INDEX_TYPE.UNIQUE)&&(0,s.indexContainsColumn)(e,this.column))),'Attempted to add index "'.concat(this.column,'" which already exists in "').concat(e.name,'"'))}apply(e){var t=(0,s.cloneSchema)(e);return t.indexes.push(this._getIndex()),t}_getIndex(){return{type:s.INDEX_TYPE.UNIQUE,column:this.column}}}t.default=o},72948:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(47677)),i=a(r(91695)),s=r(7053);class o extends i.default{validate(e){super.validate(e),(0,n.default)(this.columns&&1===this.columns.length,"Attempted to add UserDefinedPrimaryKey over wrong number of columns")}apply(e){var t=(0,s.cloneSchema)(e);return t.columns.unshift({name:this.columns[0],primaryKey:s.PRIMARY_KEY_TYPE.AUTO_INCREMENT}),t}}t.default=o},19667:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(47677)),i=a(r(91695)),s=r(7053);class o extends i.default{validate(e){super.validate(e),(0,n.default)(this.columns&&this.columns.length>1,"Attempted to add composite primary key for only 1 column")}apply(e){var t=(0,s.cloneSchema)(e);return this.columns.forEach((e=>{t.columns.push({name:e,primaryKey:s.PRIMARY_KEY_TYPE.COMPOSITE})})),t}}t.default=o},6053:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(47677));t.default=class{constructor(){(0,n.default)("Mutation"!==this.constructor.name,"Cannot instantiate abstract class Mutation")}validate(){throw new Error("Subclasses of Mutaton must implement `validate`")}apply(){throw new Error("Subclasses of Mutaton must implement `apply`")}}},1252:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(47677)),i=a(r(6053)),s=r(7053);class o extends i.default{constructor(e){super(),this.column=e}validate(e){(0,n.default)(-1!==(0,s.findIndex)(e,this._getIndex()),'Attempted to remove non-existent index "'.concat(this.column,'" on "').concat(e.name,'"'))}apply(e){var t=(0,s.cloneSchema)(e),r=(0,s.findIndex)(e,this._getIndex());return t.indexes.splice(r,1),t}_getIndex(){return{type:s.INDEX_TYPE.ARRAY,column:this.column}}}t.default=o},66546:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(47677)),i=a(r(6053)),s=r(7053);class o extends i.default{constructor(e){super(),this.name=e}validate(e){var t=e.columns.find((e=>e.name===this.name));(0,n.default)(t,'Attempted to remove column "'.concat(this.name,'" from "').concat(e.name,"\" but it doesn't exist")),(0,n.default)(!t.primaryKey,'Attempted to remove primary key column "'.concat(this.name,'". Removing primary keys is not supported.')),(0,n.default)(!e.indexes.some((e=>(0,s.indexContainsColumn)(e,this.name))),'Attempted to remove column "'.concat(this.name,'" from "').concat(e.name,'" but an index exists with the column'))}apply(e){var t=(0,s.cloneSchema)(e);return t.columns.splice(t.columns.findIndex((e=>e.name===this.name)),1),t}}t.default=o},39605:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(47677)),i=a(r(6053)),s=r(7053);class o extends i.default{constructor(e){super(),this.columns=[...e].sort()}validate(e){(0,n.default)(-1!==(0,s.findIndex)(e,this._getIndex()),"Attempted to remove non-existent index [".concat(String(this.columns),'] on "').concat(e.name,'"'))}apply(e){var t=(0,s.cloneSchema)(e),r=(0,s.findIndex)(e,this._getIndex());return t.indexes.splice(r,1),t}_getIndex(){return{type:s.INDEX_TYPE.COMPOSITE,columns:this.columns}}}t.default=o},50600:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(47677)),i=a(r(6053)),s=r(7053);class o extends i.default{constructor(e){super(),this.column=e}validate(e){(0,n.default)(-1!==(0,s.findIndex)(e,this._getIndex()),'Attempted to remove non-existent index "'.concat(this.column,'" on "').concat(e.name,'"'))}apply(e){var t=(0,s.cloneSchema)(e),r=(0,s.findIndex)(e,this._getIndex());return t.indexes.splice(r,1),t}_getIndex(){return{type:s.INDEX_TYPE.SIMPLE,column:this.column}}}t.default=o},58642:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(47677)),i=a(r(91695)),s=r(7053);class o extends i.default{validate(e){super.validate(e),(0,n.default)(this.columns&&1===this.columns.length,"Attempted to add UserDefinedPrimaryKey over wrong number of columns")}apply(e){var t=(0,s.cloneSchema)(e);return t.columns.unshift({name:this.columns[0],primaryKey:s.PRIMARY_KEY_TYPE.USER_DEFINED}),t}}t.default=o},6e4:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.sortMutations=function(e){return[...e].sort(E)};var n=a(r(47677)),i=a(r(66879)),s=a(r(30530)),o=a(r(9387)),u=a(r(80522)),l=a(r(90146)),d=a(r(95745)),c=a(r(72948)),f=a(r(19667)),p=a(r(1252)),h=a(r(66546)),_=a(r(39605)),m=a(r(50600)),g=a(r(58642)),v=[_.default,p.default,m.default,h.default,c.default,g.default,f.default,s.default,l.default,i.default,o.default,d.default,u.default];function E(e,t){var r=v.indexOf(e.constructor),a=v.indexOf(t.constructor);return(0,n.default)(-1!==r,"Mutation ".concat(e.constructor.name," is not a known mutation type")),(0,n.default)(-1!==a,"Mutation ".concat(e.constructor.name," is not a known mutation type")),r-a}},7053:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.emptySchema=function(e){return{name:e,columns:[],indexes:[],encryptedColumns:{}}},t.cloneSchema=function(e){return{name:e.name,columns:e.columns.map((e=>(0,n.default)({},e))),indexes:e.indexes.map(l),encryptedColumns:(0,n.default)({},e.encryptedColumns||{}),deleted:e.deleted}},t.freezeSchema=function(e){return Object.freeze({name:e.name,columns:Object.freeze(e.columns.map(Object.freeze)),indexes:Object.freeze(e.indexes.map(u)),encryptedColumns:Object.freeze((0,n.default)({},e.encryptedColumns||{})),deleted:e.deleted})},t.findIndex=function(e,t){return e.indexes.findIndex((e=>function(e,t){if(e.type!==t.type)return!1;switch(e.type){case o.SIMPLE:case o.ARRAY:case o.UNIQUE:return(0,i.default)(t.type===e.type,"Index types are not equal"),e.column===t.column;case o.COMPOSITE:return(0,i.default)(t.type===e.type,"Index types are not equal"),e.columns.length===t.columns.length&&!e.columns.some((e=>!t.columns.includes(e)))}throw new Error("cannot compare unknown indexes of types: ".concat(e.type,", ").concat(t.type))}(t,e)))},t.indexContainsColumn=function(e,t){switch(e.type){case o.SIMPLE:case o.ARRAY:case o.UNIQUE:return e.column===t;case o.COMPOSITE:return!!e.columns.find((e=>e===t))}throw new Error("cannot check indexes of unknown index type: ".concat(e.type))},t.INDEX_TYPE=t.PRIMARY_KEY_TYPE=void 0;var n=a(r(70417)),i=a(r(47677)),s=Object.freeze({AUTO_INCREMENT:"auto-increment",USER_DEFINED:"user-defined",COMPOSITE:"composite"});t.PRIMARY_KEY_TYPE=s;var o=Object.freeze({SIMPLE:"simple",COMPOSITE:"composite",ARRAY:"array",UNIQUE:"unique"});function u(e){switch(e.type){case o.SIMPLE:return Object.freeze({type:o.SIMPLE,column:e.column});case o.ARRAY:return Object.freeze({type:o.ARRAY,column:e.column});case o.COMPOSITE:return Object.freeze({type:o.COMPOSITE,columns:Object.freeze(e.columns.map(Object.freeze))});case o.UNIQUE:return Object.freeze({type:o.UNIQUE,column:e.column})}throw new Error("cannot freeze index of unknown type: ".concat(e.type))}function l(e){switch(e.type){case o.SIMPLE:return{type:o.SIMPLE,column:e.column};case o.UNIQUE:return{type:o.UNIQUE,column:e.column};case o.COMPOSITE:return{type:o.COMPOSITE,columns:e.columns.map((e=>e))};case o.ARRAY:return{type:o.ARRAY,column:e.column}}throw new Error("cannot clone unknown index type: ".concat(e.type))}t.INDEX_TYPE=o},22488:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.MissingVersionError=t.InvalidVersionError=t.DuplicateVersionError=void 0;class r extends Error{constructor(...e){super(...e),this.name="DuplicateVersionError"}}t.DuplicateVersionError=r;class a extends Error{constructor(...e){super(...e),this.name="InvalidVersionError"}}t.InvalidVersionError=a;class n extends Error{constructor(...e){super(...e),this.name="MissingVersionError"}}t.MissingVersionError=n;t.default=class{constructor(){this.versions=new Set,this._max=-1}claim(e){if(e<0)throw new a("Versions must by greater than or equal to zero!");if(this.versions.has(e))throw new r("Version #".concat(e," has already been claimed!"));this.versions.add(e),this._max=Math.max(this.max,e)}version(e){if(e<0)throw new a("Versions must by greater than or equal to zero!");return e}validate(){for(var e=0;e<=this.max;++e)if(!this.versions.has(e))throw new n("Schema version #".concat(e," is missing!"))}get max(){return this._max}}},6957:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.NotInitializedError=t.NoSuchTableError=t.NoSuchDatabaseError=t.NoFallbackError=t.DuplicateTableError=t.DuplicateDatabaseError=t.AlreadyInitializedError=void 0;var n=a(r(52954)),i=a(r(27433)),s=a(r(22488)),o=a(r(78030));class u extends Error{constructor(...e){super(...e),this.name="AlreadyInitializedError"}}t.AlreadyInitializedError=u;class l extends Error{constructor(...e){super(...e),this.name="DuplicateDatabaseError"}}t.DuplicateDatabaseError=l;class d extends Error{constructor(...e){super(...e),this.name="DuplicateTableError"}}t.DuplicateTableError=d;class c extends Error{constructor(...e){super(...e),this.name="NoFallbackError"}}t.NoFallbackError=c;class f extends Error{constructor(...e){super(...e),this.name="NoSuchDatabaseError"}}t.NoSuchDatabaseError=f;class p extends Error{constructor(...e){super(...e),this.name="NoSuchTableError"}}t.NoSuchTableError=p;class h extends Error{constructor(...e){super(...e),this.name="NotInitializedError"}}t.NotInitializedError=h;t.default=class{constructor(e){this.tables=new Map,this.views=new Map,this.state=1,this.versions=new s.default,this._database=e}add(e){if(this.tables.has(e))throw new d('Table "'.concat(e,'" already added. Reuse the definition.'));var t=new o.default(e,this.versions);return this.tables.set(e,t),t}_getBackingDB(){return this._database}_unsafeGetOrCreateView(e){if(this.views.has(e))return this.views.get(e);var t=this._database.view(e.name,e.rowview,e.shouldEnablePropFilter,e.shouldUseDbMsgEncKeyForEncryptedCol);return this.views.set(e,t),t}_guardInitializedThunk(e){return()=>{if(3&this.state)throw new h("Storage must be initialized before accessing a table!");return e()}}table(e){var t=this.tables.get(e);if(!t)throw new p("Unknown table ".concat(e," requested, ensure table is defined!"));if(!this._getBackingDB())throw new f('Unable to find associated database with table "'.concat(e,'"'));return new i.default(this._guardInitializedThunk((()=>this._unsafeGetOrCreateView(t))))}lock(e,t){if(3&this.state)return Promise.reject(new h("Initialize storage before attempting to lock tables!"));for(var r=0;r<e.length;++r)if(!this.tables.has(e[r]))return Promise.reject(new p('Requested lock of unknown table "'.concat(e[r],'"')));var a=e.map((e=>{var t=this.tables.get(e);if(t)return t;throw new p('Requested lock of unknown table "'.concat(e,'"'))})).map((e=>this._unsafeGetOrCreateView(e)));return this._getBackingDB().transact(e,(()=>t(a)))}_getUpgraderForCurrentVersion(e,t){for(var r=0;r<e.length;r++)if(e[r].maxVersion===t){var a=e[r].upgraders.get(t);if(a)return{name:e[r].name,callback:a}}}_applyDatabaseVersion(e,t,r){var a=t,n=r.map((e=>e.schema(a))).filter(Boolean);return e.initialize(t,n,this._getUpgraderForCurrentVersion(r,a))}initialize(){var e=this;return(0,n.default)((function*(){if(4&e.state)throw new u("Storage instance has already been initialized");if(e.versions.validate(),!e._database)throw new f('"'.concat(e._database.constructor.name,'" failed availability check!'));yield e._database.available();var t=Array.from(e.tables.values()),r=e._getBackingDB();if(t&&r){for(var a=0;a<=e.versions.max;a++)yield e._applyDatabaseVersion(r,a,t);yield r.open(),e.state=4}}))()}purge(){return this.state=2,this.views=new Map,this._getBackingDB().reset().then((()=>{}))}}},78030:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(70417)),i=a(r(47677)),s=r(7053),o=r(6e4);function u(e){return e}t.default=class{constructor(e,t){this.maxVersion=-1,this.versions=new Map,this.upgraders=new Map,this.shouldEnablePropFilter=!0,this.shouldUseDbMsgEncKeyForEncryptedCol=!1,this.name=e,this.versionManager=t}version(e,t,r){this.versionManager.claim(e),(0,i.default)(!this.versions.has(e),'Table "'.concat(this.name,'" already has version #').concat(+e," defined!")),(0,i.default)(e>this.maxVersion,"Versions for table ".concat(this.name," must be defined in order")),this.maxVersion=e;var a=this.schema(e)||(0,s.emptySchema)(this.name),n=(0,o.sortMutations)(t).reduce(((e,t)=>(t.validate(e),t.apply(e))),(0,s.cloneSchema)(a));return this.versions.set(e,(0,s.freezeSchema)(n)),this.upgraders.set(e,r),this}delete(e){this.versionManager.claim(e),(0,i.default)(!this.versions.has(e),'Table "'.concat(this.name,'" already has version #').concat(+e," defined!")),(0,i.default)(e>this.maxVersion,"Versions for table ".concat(this.name," must be defined in order")),this.maxVersion=e;var t=this.schema(e)||(0,s.emptySchema)(this.name),r=(0,n.default)((0,n.default)({},t),{},{deleted:!0});return this.versions.set(e,(0,s.freezeSchema)(r)),this}view(e){return this.rowview=e,this}enablePropFilter(e){return this.shouldEnablePropFilter=e,this}useDbMsgEncKeyForEncryptedCol(e){return this.shouldUseDbMsgEncKeyForEncryptedCol=e,this}schema(e){var t=this.versions.get(e);if(t)return t;var r=Array.from(this.versions.keys()).map(u).sort(((e,t)=>e-t)).filter((t=>t<e)).pop();return r||0===r?this.versions.get(r)||(0,s.emptySchema)(this.name):null}}},8018:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.getABPropConfigs=function(){return(0,u.initializeWithoutGKs)().then((()=>(0,s.getTable)().all().then((e=>e))))},t.parseConfigValue=c,t.getConfigValue=function(e){var t=o.ABPropConfigs[e];if(null==t)return __LOG__(4,!0,new Error,!0)(d()),SEND_LOGS("invalid ABProps config name: "+e),Promise.reject(new Error("invalid ABProps config name"));var[r,a,n]=t;return(0,u.initializeWithoutGKs)().then((()=>(0,s.getTable)().get(String(r)).then((e=>e?c(e.configValue,a,n):n))))},t.updateABPropConfigs=function(e){var t=[];return e.forEach(((e,r)=>{t.push({configCode:String(r),configValue:e.configValue,configExpoKey:e.configExpoKey})})),(0,l.getStorage)().lock(["abpropConfigs"],function(){var e=(0,n.default)((function*([e]){yield e.clear(),yield e.bulkCreate(t)}));return function(){return e.apply(this,arguments)}}())};var n=a(r(52954)),i=a(r(19976)),s=r(67995),o=r(85820),u=r(24319),l=r(77993);function d(){var e=(0,i.default)(["invalid ABProps config name"]);return d=function(){return e},e}function c(e,t,r){return null==e||null==t?r:"bool"===t?"1"===e||"True"===e||"true"===e:"int"===t?parseInt(e,10):"float"===t?parseFloat(e):e}},16976:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.addActiveMessageRange=function(){return _.apply(this,arguments)},t.removeActiveMessageRange=function(e,t){return p.removeRange(e,t)},t.updateActiveMessageRange=function(e){return p.createOrReplaceRange(e)},t.bulkUpdateActiveMessageRanges=function(e){return p.bulkCreateOrReplaceRanges(e)},t.getActiveMessageRanges=function(e){return p.getRangesForChat(e)},t._cache=void 0;var n,i=a(r(70417)),s=a(r(52954)),o=a(r(61941)),u=r(24319),l=r(75524),d=r(84139),c=r(61239),f=new Map,p={reset:()=>{f=new Map},removeRange:function(e,t){var r;return null===(r=f.get(e))||void 0===r||r.delete(t),(0,u.getActiveMessageRangesTable)().remove([e,t])},createOrReplaceRange:function(e){var t=f.get(e.chatId);return null==t&&(t=new Map,f.set(e.chatId,t)),t.set(e.action,e),(0,u.getActiveMessageRangesTable)().createOrReplace(e)},bulkCreateOrReplaceRanges:function(e){return e.forEach((e=>{var t=f.get(e.chatId);null==t&&(t=new Map,f.set(e.chatId,t)),t.set(e.action,e)})),(0,u.getActiveMessageRangesTable)().bulkCreateOrReplace(e)},getRangesForChat:(n=(0,s.default)((function*(e){var t=f.get(e);if(null==t){var r=yield(0,u.getActiveMessageRangesTable)().anyOf(["chatId"],[e]);t=new Map(r.map((e=>[e.action,e]))),f.set(e,t)}return[...t.values()]})),function(){return n.apply(this,arguments)})};function h(e,t){switch(e){case"archive":return{action:"archive",actionValue:(0,o.default)(t.archiveChatAction,"syncActionValue.archiveChatAction")};case"markChatAsRead":return{action:"markChatAsRead",actionValue:(0,o.default)(t.markChatAsReadAction,"syncActionValue.markChatAsReadAction")};case"clearChat":return{action:"clearChat",actionValue:(0,o.default)(t.clearChatAction,"syncActionValue.clearChatAction")};default:throw new Error("unsupported action for message ranges: ".concat(String(e)))}}function _(){return(_=(0,s.default)((function*(e,t,r){var a,n=(0,d.decodeProto)(c.SyncActionValueSpec,r),{actionValue:s}=h(t,n),o=(null===(a=s.messageRange)||void 0===a?void 0:a.messages)||[],u=yield(0,l.filterReceivedMessagesInRange)(e,o),f=Math.max(0,o.length-u.length);return p.createOrReplaceRange((0,i.default)((0,i.default)({chatId:e},h(t,n)),{},{remainingMessages:f}))}))).apply(this,arguments)}t._cache=p},68205:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.getBlocklist=function(){var e=Promise.resolve([]);return n.default.supportsFeature(n.default.F.MD_BACKEND)?e=(0,i.getTable)().all().then((e=>e.map((e=>(0,o.createUserWid)(e.id))))):e},t.updateBlocklist=function(e){var t=Promise.resolve(!1);if(n.default.supportsFeature(n.default.F.MD_BACKEND)&&e){var r=e.map((e=>({id:e.toString()})));return t=(0,s.getStorage)().lock(["blocklist"],(([e])=>e.clear().then((()=>e.bulkCreate(r).then((()=>Promise.resolve(!0)))))))}return t};var n=a(r(18120)),i=r(66315),s=r(77993),o=r(75637)},55644:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.getChatMeta=function(){return c.apply(this,arguments)},t.updateChatForMarkAsReadSync=function(e){return(0,s.getStorage)().lock(["chat"],function(){var t=(0,i.default)((function*([t]){var r=yield t.get(e);if(null!=r)return-1===r.unreadCount?t.createOrMerge(e,{id:e,unreadCount:0}):void 0;__LOG__(4,void 0,new Error)(d(),e)}));return function(){return t.apply(this,arguments)}}())},t.markMessageAndChatAsRead=function(e,t){return(0,s.getStorage)().lock(["message","chat"],function(){var r=(0,i.default)((function*([r,a]){var n=yield(0,l.getTable)().equals(["from","pendingReadReceipt"],[t,1],{shouldDecrypt:!1}),i=[],s=0;n.forEach((t=>{null==e||null!=t.rowId&&t.rowId>e?s++:i.push({id:t.id,ack:Math.max(t.ack,u.default.ACK.READ),pendingReadReceipt:null})}));var o=[a.createOrMerge(t,{id:t,unreadCount:s})];i.length>0&&o.push((0,l.getTable)().bulkCreateOrMerge(i)),yield Promise.all(o)}));return function(){return r.apply(this,arguments)}}())};var n=a(r(19976)),i=a(r(52954)),s=r(77993),o=r(35855),u=a(r(50935)),l=r(52303);function d(){var e=(0,n.default)(["updateMarkChatAsReadSync: could not find chat with id ",""]);return d=function(){return e},e}function c(){return(c=(0,i.default)((function*(e){var t=yield(0,o.getTable)().get(e.toString());return t?{unreadCount:t.unreadCount,timestamp:t.t}:Promise.reject(new Error("Failed to find row in chat table with id:"+e.toString()))}))).apply(this,arguments)}},64075:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.setNotAddressBookContacts=function(e){if(n.default.supportsFeature(n.default.F.MD_BACKEND))return(0,s.getStorage)().lock(["contact"],(()=>{var t=e.map((e=>({id:e,isAddressBookContact:0,name:void 0})));return(0,i.getContactTable)().bulkCreateOrMerge(t)}));return Promise.resolve()};var n=a(r(18120)),i=r(11008),s=r(77993)},77725:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.hasDevice=function(e,t){return o.default.supportsFeature(o.default.F.MD_BACKEND)?t===s.default.DEVICE.PRIMARY_DEVICE?Promise.resolve(!0):f([e.user]).then((([e])=>!!e&&!!e.devices.includes(t))):Promise.resolve(!1)},t.getDeviceIds=f,t.doesDeviceHashMatch=function(e,t){if(o.default.supportsFeature(o.default.F.MD_BACKEND))return null==t?Promise.resolve(!0):f([e.user]).then(function(){var e=(0,n.default)((function*(e){var r=e.map((e=>e?e.devices.map((t=>(0,d.createDeviceWidFromUserAndDevice)(e.id,t))):[])),a=(0,i.default)(r,(e=>e));return(yield(0,c.phashV2)(a))!==t}));return function(){return e.apply(this,arguments)}}());return Promise.resolve(!1)},t.getMyDeviceList=function(){return p.apply(this,arguments)};var n=a(r(52954)),i=a(r(35838)),s=a(r(50935)),o=a(r(18120)),u=r(95595),l=r(47513),d=r(75637),c=r(24897);function f(e){return o.default.supportsFeature(o.default.F.MD_BACKEND)?(0,l.getTable)().bulkGet(e).then((e=>e.map((e=>{if(e){var t=e.devices.map((e=>e.id));return{id:e.id,devices:t}}return null})))):Promise.reject(new Error("getDeviceIds: not supported without model storage and md backend"))}function p(){return(p=(0,n.default)((function*(){var e=(0,u.assertGetMe)(),t=yield(0,l.getTable)().get(e.user);if(!t)throw new Error("syncd: cannot find my device list");return t}))).apply(this,arguments)}},60156:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.persistGroupMetadata=function(e,t){if(i.default.supportsFeature(i.default.F.MD_BACKEND))return(0,s.getTable)().merge(e.toString(),t);return Promise.resolve()},t.getGroupMetadataFromStorage=function(e){if(i.default.supportsFeature(i.default.F.MD_BACKEND))return(0,o.getStorage)().lock(["group-metadata","participant"],function(){var t=(0,n.default)((function*([t,r]){var a=yield t.get(e.toString());if(a){var n=yield r.get(e.toString());if(n&&n.deviceSyncComplete){var s,o=new Set(n.admins);return{id:e,owner:a.owner&&(0,u.createWid)(a.owner),creation:a.creation,desc:a.desc,descId:a.descId,descOwner:a.descOwner&&(0,u.createWid)(a.descOwner),descTime:a.descTime,restrict:a.restrict||!1,announce:a.announce||!1,noFrequentlyForwarded:a.noFrequentlyForwarded||!1,ephemeralDuration:a.ephemeralDuration||0,participants:null===(s=n.participants)||void 0===s?void 0:s.map((e=>({id:(0,u.createWid)(e),isAdmin:o.has(e),isSuperAdmin:!1}))),support:i.default.supportsFeature(i.default.F.SUPPORT)&&!0===a.support}}}return null}));return function(){return t.apply(this,arguments)}}());return Promise.resolve(null)};var n=a(r(52954)),i=a(r(18120)),s=r(96056),o=r(77993),u=r(75637)},52718:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.getNextUnProcessedNotification=l,t.updateCurrentlyProcessed=function(e){var t;if(s.default.supportsFeature(s.default.F.MD_BACKEND)){if(u.delete(e),!(t=(0,o.getTable)().remove(e)))return Promise.reject(new Error("updateCurrentProcessed history sync notification: not supported for non MD"))}else t=Promise.reject("updateCurrentProcessed for history sync notification: not supported without md backend");return t},t.markChunkForReuploadPending=function(e){return u.delete(e),(0,o.getTable)().merge(e,{reuploadPending:!0})},t.getByChunkOrderNumber=function(e,t){var r;if(s.default.supportsFeature(s.default.F.MD_BACKEND)){if(!(r=(0,o.getTable)().equals(["chunkOrder","syncType"],[e,t])))return Promise.reject(new Error("getNotificationForChunk history sync notification: not supported for non MD"))}else r=Promise.reject("getNotificationForChunk for history sync notification: not supported without md backend");return r},t.addNotification=d,t.enqueueNotification=function(){return c.apply(this,arguments)},t.fetchNextHitorySyncChunkForProcessing=function(){return f.apply(this,arguments)};var n=a(r(52954)),i=a(r(70417)),s=a(r(18120)),o=r(8750),u=new Set;function l(){var e;if(s.default.supportsFeature(s.default.F.MD_BACKEND)){if(!(e=(0,o.getTable)().equals(["processed"],0).then((e=>{var t=e.filter((e=>!u.has(e.msgKey)&&!e.reuploadPending)).sort(((e,t)=>e.syncType<t.syncType?1:e.syncType>t.syncType?-1:e.syncType===t.syncType&&null!=e.chunkOrder&&null!=t.chunkOrder?e.chunkOrder-t.chunkOrder:0));return t.length>0?t[0]:void 0}))))return Promise.reject(new Error("getNextUnProcessed history sync notification: not supported for non MD"))}else e=Promise.reject("getNextUnProcessed for history sync notification: not supported without md backend");return e}function d(e){var t;if(s.default.supportsFeature(s.default.F.MD_BACKEND)){var r=e.downloadOptions.mediaKey;e.downloadOptions.mediaKey="";var a=(0,i.default)((0,i.default)({},e),{},{chunkEncryptionKey:r});if(e.processed=0,!(t=(0,o.getTable)().createOrMerge(e.msgKey,a)))return Promise.reject(new Error("add history sync notification: not supported for non MD"))}else t=Promise.reject("add history sync notification: not supported without md backend");return t}function c(){return(c=(0,n.default)((function*(e,t=!1){yield d(e),t&&u.add(e.msgKey)}))).apply(this,arguments)}function f(){return(f=(0,n.default)((function*(){if(u.size>0)return null;var e=yield l();return e&&(e.downloadOptions.mediaKey=e.chunkEncryptionKey,delete e.chunkEncryptionKey,u.add(e.msgKey)),e}))).apply(this,arguments)}},74108:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.queryLocalLabelAssociation=s,t.default=function(){return o.apply(this,arguments)};var n=a(r(52954)),i=r(98538);function s(e){return(0,i.getTable)().anyOf(["associationId","type"],e.map((({associationId:e,type:t})=>[e,t])))}function o(){return(o=(0,n.default)((function*(e){var t=yield s(e);yield(0,i.getTable)().bulkRemove(t.map((({labelId:e,associationId:t,type:r})=>[e,t,r])))}))).apply(this,arguments)}},75093:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.getDeviceUpdateLock=function(e){if(!n.default.supportsFeature(n.default.F.MD_BACKEND))return Promise.reject("This call is only supported in MD mode");Promise.resolve();var t=["participant","device-list"];(0,s.getGlobalSecurityNotifications)()&&(t=[...t,"message","chat"]);return(0,i.getStorage)().lock(t,(t=>e(t)))};var n=a(r(18120)),i=r(77993),s=r(95595)},99849:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.createOrMergeReceiptRecords=function(e){if(o.default.supportsFeature(o.default.F.MD_BACKEND)){var t=new Map;return e.forEach((e=>{var r,{msgKey:a,receiverId:n}=e,i=(0,f.toUserWid)(n).toString(),s=a.toString(),o="".concat(s,",").concat(i),l=null!==(r=n.device)&&void 0!==r?r:u.default.DEVICE.PRIMARY_DEVICE,d=t.get(o);d?d.deviceNotDelivered.push(l):t.set(o,{msgKey:s,receiverUserJid:i,deviceDelivered:[],deviceNotDelivered:[l]})})),(0,d.getStorage)().lock(["message-info"],function(){var e=(0,s.default)((function*([e]){var r=Array.from(t.values()).map((e=>[e.msgKey,e.receiverUserJid]));return(yield e.anyOf(["msgKey","receiverUserJid"],r)).forEach((e=>{var r="".concat(e.msgKey,",").concat(e.receiverUserJid),a=t.get(r);a&&t.set(r,(0,i.default)((0,i.default)({},e),{},{deviceNotDelivered:[...e.deviceNotDelivered,...a.deviceNotDelivered]}))})),(0,p.getTable)().bulkCreateOrReplace(Array.from(t.values()))}));return function(){return e.apply(this,arguments)}}())}return Promise.reject(new Error("createOrMergeReceiptRecords: not supported for non MD"))},t.updateReceiptRecords=function(e,t,r,a){if(o.default.supportsFeature(o.default.F.MD_BACKEND)){var n=y[e],i=(0,f.toUserWid)(r).toString(),s=r.device||0;return n?function(e,t,r,a,n){if(0===n.length)return Promise.resolve();return(0,d.getStorage)().lock(["message-info"],(([i])=>{var s=n.map((e=>[e,r]));return i.bulkGet(s).then((s=>{var o=[];return n.forEach(((n,i)=>{var u=s[i];if(!u)return __LOG__(2)(h(),n,r),void o.push({msgKey:n,receiverUserJid:r,[e]:t,deviceDelivered:[],deviceNotDelivered:[]});if(e!==y[v.INACTIVE]){var l=u[e];(null==u[e]||l>t)&&(u[e]=t)}u.deviceNotDelivered.length>0&&(u.deviceDelivered.push(a),u.deviceDelivered=u.deviceDelivered.filter(((e,t,r)=>r.indexOf(e)===t)),u.deviceNotDelivered=u.deviceNotDelivered.filter((e=>e!==a))),o.push(u)})),i.bulkCreateOrReplace(o)}))}))}(n,t,i,s,a):Promise.reject(new Error("updateReceiptRecords: not supported ack type ".concat(e)))}return Promise.reject(new Error("updateReceiptRecords: not supported for non MD"))},t.isRetryEligible=function(e,t){if(o.default.supportsFeature(o.default.F.MD_BACKEND)){var r=(0,f.toUserWid)(t).toString(),a=t.device||0;return(0,p.getTable)().get([e.toString(),r]).then((t=>t?!!t.deviceNotDelivered.includes(a)||(__LOG__(2)(m(),e.toString(),r,a),!1):(__LOG__(2)(g(),e.toString(),r),!1)))}return Promise.resolve(!1)},t.queryMsgInfo=function(e){if(o.default.supportsFeature(o.default.F.MD_BACKEND)){var t=String(e);return(0,l.getTable)().get(t).then((t=>{var r=t?t.count:null;return(0,p.getTable)().equals(["msgKey"],e.toString()).then((t=>{var a={delivery:[],deliveryRemaining:0,played:[],playedRemaining:0,read:[],readRemaining:0},n=0;t.forEach((e=>{var t=(0,f.createWid)(e.receiverUserJid);if(!(0,c.getMeUser)().equals(t)){!function(e){var t=e.read;null!=t&&(null==e.delivery||e.delivery>t)&&(e.delivery=t)}(e);for(var r=0;r<S.length;r++){var i=S[r],s=e[i];if(null!=s){a[i].push({id:t,t:s});break}}n+=1}}));var i=null!=r&&0!==r?r:n;return __LOG__(2)(_(),e,r,i,a.played.length,a.read.length,a.delivery.length),a.playedRemaining=i-a.played.length,a.readRemaining=a.playedRemaining-a.read.length,a.deliveryRemaining=a.readRemaining-a.delivery.length,a}))}))}return Promise.reject(new Error("queryMsgInfo: not supported without model storage"))};var n=a(r(19976)),i=a(r(70417)),s=a(r(52954)),o=a(r(18120)),u=(a(r(68384)),a(r(50935))),l=r(52303),d=r(77993),c=r(95595),f=r(75637),p=r(24170);function h(){var e=(0,n.default)(["updateReceiptRecords: got receipt for peer msg ",",",""]);return h=function(){return e},e}function _(){var e=(0,n.default)(["queryMsgInfo: ",", ack count: ",", receiver: ",",\nplayed: ",", read: ",", delivery: ",""]);return _=function(){return e},e}function m(){var e=(0,n.default)(["MessageInfoStore: ",",",":"," has been delivered"]);return m=function(){return e},e}function g(){var e=(0,n.default)(["MessageInfoStore: missing record for ",",",""]);return g=function(){return e},e}var{ACK:v,ACK_STRING:E}=u.default,y={[v.RECEIVED]:E.DELIVERY,[v.READ]:E.READ,[v.PLAYED]:E.PLAYED,[v.INACTIVE]:E.INACTIVE},S=[E.PLAYED,E.READ,E.DELIVERY]},54074:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.removeMessagesFromHistory=function(e){if(i.default.supportsFeature(i.default.F.MD_BACKEND))return(0,s.initializeWithoutGKs)().then((()=>(0,d.getStorage)().lock(["message","label-association"],(()=>{var t=(0,l.default)(e.map((e=>({associationId:e,type:o.LabelAssociationType.Message}))));return Promise.all([(0,u.getTable)().bulkRemove(e),t])})))).then((()=>{})).catch((e=>{throw __LOG__(4,void 0,new Error)(c(),e),e}));return Promise.resolve()};var n=a(r(19976)),i=a(r(18120)),s=r(24319),o=r(98538),u=r(52303),l=a(r(74108));r(7241);var d=r(77993);function c(){var e=(0,n.default)(["removeMessagesFromHistory: error ",""]);return c=function(){return e},e}},94765:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.pruneExpiredMessages=function(){if(n.default.supportsFeature(n.default.F.MD_BACKEND)&&o.default.ephemeralPruning)return(0,s.getTable)().lessThan(["expiredTimestamp"],i.default.globalUnixTime()).then((e=>{(0,s.getTable)().bulkRemove(e.map((e=>e.id)))}));return Promise.resolve()};var n=a(r(18120)),i=a(r(19899)),s=r(52303),o=a(r(72424))},69627:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.msgFindQuery=function(e,t){if(null!=t.label)return Promise.resolve([]);if("before"===e)return function(e,t=20){if(i.default.supportsFeature(i.default.F.MD_BACKEND)&&e instanceof s.default){var r=e.remote.toString();return(0,u.getTable)().equals(["id"],e.toString()).then((a=>{if(0===a.length)return __LOG__(3)(d(),e.toString()),Promise.reject(new p(e.toString()));var n=a[0],i=(0,o.getInChatMsgId)(n.internalId||""),s=Math.max(0,i-t),u=(0,o.craftInternalId)(r,s),l=(0,o.craftInternalId)(r,i);return(0,o.queryChatMessageHelper)(u,l,{lowerInclusive:!0,upperInclusive:!1}).then((e=>e.map(o.hydrateMessage)))}))}return Promise.resolve([])}(t,t.count);if("after"===e)return function(e,t=20){if(i.default.supportsFeature(i.default.F.MD_BACKEND)&&e instanceof s.default){var r=e.remote.toString();return(0,u.getTable)().equals(["id"],e.toString()).then((a=>{if(0===a.length)return __LOG__(3)(l(),e.toString()),Promise.reject(new p(e.toString()));var n=a[0],i=(0,o.getInChatMsgId)(n.internalId||""),s=(0,o.craftInternalId)(r,i),u=(0,o.craftInternalId)(r,i+t);return(0,o.queryChatMessageHelper)(s,u,{lowerInclusive:!1,upperInclusive:!0}).then((e=>e.map(o.hydrateMessage)))}))}return Promise.resolve([])}(t,t.count).catchType(p,(()=>({status:404})));if("star"===e){var a=null==t.id?void 0:new s.default(t);return null!=t.chat?function(e,t,r){if(i.default.supportsFeature(i.default.F.MD_BACKEND))return Promise.resolve().then((()=>{if(null!=r)return(0,u.getTable)().get(r.toString())})).then((r=>{var a=null==r?[(0,o.endOfChat)(e),1/0]:[r.internalId,r.isStarred],n=[(0,o.beginningOfChat)(e),0];return(0,u.getTable)().between(["internalId","isStarred"],n,a,{lowerInclusive:!1,upperInclusive:!1,reverse:!0,limit:t}).then((e=>e.map(o.hydrateMessage)))}));return Promise.resolve([])}(t.chat,t.count,a):function(e,t){if(i.default.supportsFeature(i.default.F.MD_BACKEND))return Promise.resolve().then((()=>{if(null!=t)return(0,u.getTable)().get(t.toString())})).then((t=>{var r=null==t?1/0:t.isStarred;return(0,u.getTable)().between(["isStarred"],0,r,{lowerInclusive:!1,upperInclusive:!1,reverse:!0,limit:e}).then((e=>e.map(o.hydrateMessage)))}));return Promise.resolve([])}(t.count,a)}if("search"===e){var n={};t.remote&&(n.remote=t.remote.toString()),t.count&&t.page>=0&&(n.limit=t.count,n.page=t.page);var{default:c}=r(11809);return c.search(t.searchTerm,n)}if("media"===e){var _=t.remote,m=null==t.id?void 0:new s.default(t);return"document"===t.media?h(_,t.count,t.direction,"isDocMsg",m).then((e=>e.map(o.hydrateMessage))):"url"===t.media?h(_,t.count,t.direction,"hasLink",m).then((e=>e.map(o.hydrateMessage))):Promise.all([h(_,t.count,t.direction,"isMediaMsg",m).then((e=>e.map(o.hydrateMessage))),h(_,t.count,t.direction,"isDocMsg",m).then((e=>e.map(o.hydrateMessage))),h(_,t.count,t.direction,"hasLink",m).then((e=>e.map(o.hydrateMessage)))]).then((([e,t,r])=>{var a=[e,r,t].flat();return{docCount:t.length,linkCount:r.length,mediaCount:e.length,messages:a}}))}return __LOG__(3)(f(),e),Promise.reject(new Error("Message query type ".concat(e," not implemented.")))},t.queryVcard=function(e){if(i.default.supportsFeature(i.default.F.MD_BACKEND))return(0,u.getTable)().equals(["vcardWAids"],e.toString()).then((e=>e.map(o.hydrateMessage)));return Promise.resolve()},t.getMsgByMsgKey=function(e){if(i.default.supportsFeature(i.default.F.MD_BACKEND)){var t;return t=e instanceof s.default?e.toString():e,(0,u.getTable)().get(t).then((e=>e?(0,o.hydrateMessage)(e):null))}return Promise.resolve(null)},t.getMsgsByMsgKey=function(e){if(i.default.supportsFeature(i.default.F.MD_BACKEND))return(0,u.getTable)().bulkGet(e).then((e=>e.filter(Boolean).map(o.hydrateMessage)));return Promise.resolve([])};var n=a(r(19976)),i=a(r(18120)),s=a(r(77865)),o=r(95197),u=r(52303);function l(){var e=(0,n.default)(["Anchor message "," does not exist in message table"]);return l=function(){return e},e}function d(){var e=(0,n.default)(["Anchor message "," does not exist in message table"]);return d=function(){return e},e}function c(){var e=(0,n.default)(["Anchor message "," does not exist in message table"]);return c=function(){return e},e}function f(){var e=(0,n.default)(["Message query type "," not implemented."]);return f=function(){return e},e}class p extends Error{constructor(e){super("Anchor message ".concat(e," does not exist in message table")),this.name="NoAnchorMessageError"}}function h(e,t,r,a,n){return i.default.supportsFeature(i.default.F.MD_BACKEND)?(null==n?Promise.resolve(void 0):(0,u.getTable)().equals(["id"],n.toString())).then((i=>{if(n&&null!=i&&0===i.length)return __LOG__(3)(c(),n&&n.toString()),Promise.reject(new p(n&&n.toString()));var s,l,d=i&&i[0];return"before"===r?(s=(0,o.beginningOfChat)(e),l=null==d?(0,o.endOfChat)(e):(0,o.craftInternalId)(e.toString(),(0,o.getInChatMsgId)(d.internalId||""))):(s=null==d?(0,o.beginningOfChat)(e):(0,o.craftInternalId)(e.toString(),(0,o.getInChatMsgId)(d.internalId||"")),l=(0,o.endOfChat)(e)),(0,u.getTable)().between(["internalId",a],[s,0],[l,1/0],{lowerInclusive:!1,upperInclusive:!1,limit:t})})):Promise.resolve([])}},12425:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"storeMessages",{enumerable:!0,get:function(){return a.storeMessages}}),Object.defineProperty(t,"storeInitialSyncMessages",{enumerable:!0,get:function(){return a.storeInitialSyncMessages}}),Object.defineProperty(t,"starMessages",{enumerable:!0,get:function(){return a.starMessages}}),Object.defineProperty(t,"unstarMessages",{enumerable:!0,get:function(){return a.unstarMessages}}),Object.defineProperty(t,"updateMessage",{enumerable:!0,get:function(){return a.updateMessage}}),Object.defineProperty(t,"processRevokeMsgs",{enumerable:!0,get:function(){return a.processRevokeMsgs}}),Object.defineProperty(t,"storeRecentAndFullHistSyncMessages",{enumerable:!0,get:function(){return a.storeRecentAndFullHistSyncMessages}}),Object.defineProperty(t,"msgFindQuery",{enumerable:!0,get:function(){return n.msgFindQuery}}),Object.defineProperty(t,"getMsgByMsgKey",{enumerable:!0,get:function(){return n.getMsgByMsgKey}}),Object.defineProperty(t,"getMsgsByMsgKey",{enumerable:!0,get:function(){return n.getMsgsByMsgKey}}),Object.defineProperty(t,"queryVcard",{enumerable:!0,get:function(){return n.queryVcard}}),Object.defineProperty(t,"removeMessagesFromHistory",{enumerable:!0,get:function(){return i.removeMessagesFromHistory}});var a=r(96141),n=r(69627),i=r(54074)},75524:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.getLastMessageTimestamp=function(e){return(0,i.getTable)().between(["messageRangeIndex"],(0,l.beginningOfMessageRange)(e,l.MessagePropertyType.IncomingChatMessage),(0,l.endOfMessageRange)(e,l.MessagePropertyType.IncomingChatMessage),{lowerInclusive:!0,reverse:!0,limit:1}).then((e=>{var t;return(0,l.extractC2STimestampFromMessageRangeIndex)(null===(t=e[0])||void 0===t?void 0:t.messageRangeIndex)}))},t.getLastSystemMessageTimestamp=function(e){return(0,i.getTable)().between(["messageRangeIndex"],(0,l.beginningOfMessageRange)(e,l.MessagePropertyType.SystemMessage),(0,l.endOfMessageRange)(e,l.MessagePropertyType.SystemMessage),{lowerInclusive:!0,reverse:!0,limit:1}).then((e=>{var t;return(0,l.extractC2STimestampFromMessageRangeIndex)(null===(t=e[0])||void 0===t?void 0:t.messageRangeIndex)}))},t.getAdditionalMessages=function(){return c.apply(this,arguments)},t.filterReceivedMessagesInRange=function(){return f.apply(this,arguments)},t.timestampComparison=h,t._test=void 0;var n=a(r(52954)),i=r(52303),s=a(r(77865)),o=a(r(61941)),u=r(31567),l=r(95197),d=r(44880);function c(){return(c=(0,n.default)((function*(e,t,r=1e3){var a=(0,i.getTable)().between(["messageRangeIndex"],(0,l.beginningOfMessageRange)(e,l.MessagePropertyType.Outgoing,t),(0,l.endOfMessageRange)(e,l.MessagePropertyType.Outgoing),{reverse:!0}),n=(0,i.getTable)().anyOf(["messageRangeIndex"],[(0,l.beginningOfMessageRange)(e,l.MessagePropertyType.IncomingChatMessage,t),(0,l.beginningOfMessageRange)(e,l.MessagePropertyType.Outgoing,t),(0,l.beginningOfMessageRange)(e,l.MessagePropertyType.Outgoing)],{reverse:!0}),o=yield Promise.all([a,n]).then((([e,t])=>e.concat(t).filter((e=>-1!==e.ack)).map((e=>{var t,r=s.default.fromString(e.id),a=null!==(t=(0,l.extractC2STimestampFromMessageRangeIndex)(e.messageRangeIndex))&&void 0!==t?t:void 0;return{key:(0,u.msgKeyToProtobuf)(r),timestamp:a}})))),{messages:d,newLastMessageTimestamp:c}=p(o,r);return{messages:d,newLastMessageTimestamp:c}}))).apply(this,arguments)}function f(){return(f=(0,n.default)((function*(e,t){if(0===t.length)return t;var r=t.map((e=>(0,u.protobufToMsgKey)((0,o.default)(e.key,"syncActionMessage.key")).toString())),a=yield(0,i.getTable)().bulkGet(r);return t.filter(((e,t)=>null!=a[t]))}))).apply(this,arguments)}function p(e,t){var r=[],a=[];if(e.forEach((e=>{null!=e.timestamp?r.push(e):a.push(e)})),r.length<t)return{messages:e};var n=r.sort(h).slice(0,t),i=n[n.length-1];return{messages:n.concat(a),newLastMessageTimestamp:(0,d.numberOrThrowIfTooLarge)((0,o.default)(i.timestamp,"smallestTimestampMessage.timestamp"))}}function h(e,t){var[r,a]=[e,t].map((e=>(0,d.numberOrThrowIfTooLarge)((0,o.default)(e.timestamp,"syncActionMessage.timestamp"))));return a-r}var _={limitAdditionalMessages:p};t._test=_},96141:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.storeInitialSyncMessages=function(){return L.apply(this,arguments)},t.storeRecentAndFullHistSyncMessages=function(){return k.apply(this,arguments)},t.storeMessages=function(){return U.apply(this,arguments)},t.updateMessage=function(e){if(u.default.supportsFeature(u.default.F.MD_BACKEND)){delete e.t;var t=(0,c.convertToMessageRowType)(e);return(0,m.getTable)().createOrMerge(t.id,t)}return Promise.resolve()},t.starMessages=function(e){if(u.default.supportsFeature(u.default.F.MD_BACKEND))return(0,m.getTable)().bulkGet(e).then((e=>{var t=e.filter(Boolean).map((e=>({id:e.id,isStarred:e.rowId})));return(0,m.getTable)().bulkCreateOrMerge(t)}));return Promise.resolve()},t.unstarMessages=function(e){if(u.default.supportsFeature(u.default.F.MD_BACKEND))return(0,m.getTable)().bulkCreateOrMerge(e.map((e=>({id:e,isStarred:void 0}))));return Promise.resolve()},t.processRevokeMsgs=function(e,t){if(u.default.supportsFeature(u.default.F.MD_BACKEND))return(0,P.getStorage)().lock(["message"],function(){var r=(0,s.default)((function*([r]){var a=yield(0,m.getTable)().bulkGet(e,!1),n=[];a.forEach(((r,a)=>{if(null==r)return __LOG__(4,!0,new Error,!0)(D()),void SEND_LOGS("RevokeMsg-not-found-error");n.push({id:t[a],to:r.to,author:r.author,type:p.default.MSG_TYPE.REVOKED,protocolMessageKey:e[a],from:r.from,t:r.t,rowId:r.rowId,internalId:r.internalId})})),yield(0,m.getTable)().bulkRemove(e),yield(0,m.getTable)().bulkCreateOrReplace(n)}));return function(){return r.apply(this,arguments)}}());return Promise.resolve()},t.encryptMultipleMsgs=x,t.storeEncryptedMessage=Y,t.storeMessageInTransaction=K;var n=a(r(70417)),i=a(r(19976)),s=a(r(52954)),o=a(r(15253)),u=a(r(18120)),l=r(27853),d=r(57556),c=r(95197),f=r(84990),p=a(r(50935)),h=r(41263),_=r(76862),m=r(52303),g=r(75637),v=a(r(11809)),E=a(r(12767)),y=a(r(77865)),S=a(r(72291)),T=a(r(76936)),b=a(r(77715)),A=r(97405),C=r(90088),P=r(77993);function O(){var e=(0,i.default)(["Error storing messages"]);return O=function(){return e},e}function w(){var e=(0,i.default)(["Error storing MD initial sync messages"]);return w=function(){return e},e}function M(){var e=(0,i.default)(["Error storing MD initial sync messages"]);return M=function(){return e},e}function I(){var e=(0,i.default)(["[process-msg] craftMessageRangeIndex failed with error ",""]);return I=function(){return e},e}function R(){var e=(0,i.default)(["[storeEncryptedMessage] BulkError in bulkCreate, retrying with bulk create or replace"]);return R=function(){return e},e}function D(){var e=(0,i.default)(["processRevokeMsg: old message key does not exist"]);return D=function(){return e},e}var N=1e9;function L(){return(L=(0,s.default)((function*(e){if(u.default.supportsFeature(u.default.F.MD_BACKEND)){yield S.default.waitForFinalDbMsgEncKey();var t=0;(0,o.default)(e,(({msgs:e})=>t+=e.length));var r=Object.keys(e).reduce(((t,r)=>{var a=t.nextRowId,n=N-e[r].msgs.length,i=W(e[r].chatInfo.unreadCount||0,e[r].msgs),s=e[r].msgs.map((e=>(a++,n++,H((0,c.convertToMessageRowType)(e),(0,g.createWid)(r).toString(),!!(0,C.findLink)(e.body,!0),a,n,i.has(String(e.id))))));return{nextRowId:a,messages:t.messages.concat(s)}}),{nextRowId:N-t,messages:[]});return(0,P.getStorage)().lock(["message"],(([e])=>e.bulkCreate(r.messages).catch((t=>{if(t instanceof b.default.BulkError)return e.bulkCreateOrMerge(r.messages);throw t})))).then((()=>{b.default.ignoreTransaction((()=>{(0,A.getTable)().bulkCreate(r.messages.map((e=>({id:e.id})))).then((()=>{v.default.index()}))}))})).catch((()=>{__LOG__(3)(M())}))}return Promise.resolve()}))).apply(this,arguments)}function k(){return(k=(0,s.default)((function*(e,t,r=!1,a=!1){return u.default.supportsFeature(u.default.F.MD_BACKEND)?Y(yield x(e,r),t,a).catch((()=>{__LOG__(3)(w())})):Promise.resolve()}))).apply(this,arguments)}function U(){return(U=(0,s.default)((function*(e,t,r=!1){return u.default.supportsFeature(u.default.F.MD_BACKEND)?(yield S.default.waitForFinalDbMsgEncKey(),Promise.resolve(K(e,t,r)).catchType(b.default.BulkError,(()=>{var r=null==t?e[0].id.remote:t,a=e.map((e=>H((0,c.convertToMessageRowType)(e),r.toString(),!!(0,C.findLink)(e.body,!0))));return(0,m.getTable)().bulkCreateOrMerge(a)})).then((()=>{v.default.index()})).catch((e=>{throw __LOG__(3)(O()),e}))):Promise.resolve()}))).apply(this,arguments)}function F(){return G.apply(this,arguments)}function G(){return(G=(0,s.default)((function*(e,t){if(T.default.isLogoutInProgress)return Promise.reject(new Error("dropping processAndEncryptSingleMsgRow due to logout"));null!=t&&(yield(0,_.asyncSleepAfterGivenLoopIteration)(t,150));var r=(0,m.getTable)(),a=q(e),i=(0,c.convertToMessageRowType)(e),s=yield r.preflightEncryptSingleRecord((0,n.default)({},i));return[(0,n.default)((0,n.default)((0,n.default)({},i),s),{},{vcardWAids:a}),!!(0,C.findLink)(e.body,!0)]}))).apply(this,arguments)}function x(){return B.apply(this,arguments)}function B(){return(B=(0,s.default)((function*(e,t=!1){var r;if(yield S.default.waitForFinalDbMsgEncKey(),yield new Promise((e=>setTimeout(e,0))),t){r=[];for(var a=0;a<e.length;a++){var n=e[a],i=yield F(n,a);r.push(i)}}else r=yield Promise.all(e.map(function(){var e=(0,s.default)((function*(e){return yield F(e)}));return function(){return e.apply(this,arguments)}}()));return r}))).apply(this,arguments)}function Y(e,t,r=!1){return(0,P.getStorage)().lock(["message"],function(){var a=(0,s.default)((function*([a]){var n=yield a.all({reverse:!r,limit:1,index:["rowId"],returnKeyType:"keys"}).then((e=>0===e.length?N:e[0])),i={};yield Promise.all(t.map((e=>{var t=(0,g.createWid)(e),n=(0,c.beginningOfChat)(t),s=(0,c.endOfChat)(t);return a.between(["internalId"],n,s,{limit:1,reverse:!r,returnKeyType:"keys"}).then((e=>i[t.toString()]=0===e.length?N:(0,c.getInChatMsgId)(e[0])))})));var s=r?-1:1,o=e.map((([e,t],a)=>{var o=y.default.fromString(e.id),u=o.remote.toString(),l=i[u]+1*s;i[u]=l;var d=!r&&j(o,e);return H(e,u,t,n+s*(a+1),l,d)}));return a.bulkCreateWith_ALREADY_ENCRYPTED_RECORDS_ONLY(o).catch((e=>{if(r&&e instanceof b.default.BulkError)return __LOG__(4,void 0,new Error)(R()),a.bulkCreateOrReplace_ALREADY_ENCRYPTED_RECORDS_ONLY(o);throw e})).then((()=>o))}));return function(){return a.apply(this,arguments)}}()).then((e=>{b.default.ignoreTransaction((()=>{(0,A.getTable)().bulkCreate(e.map((e=>({id:e.id})))).then((()=>{v.default.index()}))}))}))}function K(e,t,r=!1){var a=null==t?e[0].id.remote:t,n=(0,c.beginningOfChat)(a),i=(0,c.endOfChat)(a);return(0,P.getStorage)().lock(["chat","message"],function(){var t=(0,s.default)((function*([t,s]){var o=yield t.get(a.toString());if(!a.isStatusV3()&&(null!=o||(0,c.shouldCreateChatWithMsgs)(e))){var u=yield function(){return V.apply(this,arguments)}(o,e,a);yield t.createOrMerge(a.toString(),u)}var l=s.all({reverse:!r,limit:1,index:["rowId"],returnKeyType:"keys"}).then((e=>0===e.length?N:e[0])),d=s.between(["internalId"],n,i,{limit:1,reverse:!r,returnKeyType:"keys"}).then((e=>0===e.length?N:(0,c.getInChatMsgId)(e[0]))),[f,p]=yield Promise.all([l,d]),h=r?f-e.length:f+1,_=r?p-e.length:p+1,m=e.map(((e,t)=>{var n=(0,c.convertToMessageRowType)(e),i=!r&&j(e.id,e);return H(n,a.toString(),!!(0,C.findLink)(e.body,!0),h+t,_+t,i)}));return s.bulkCreate(m).then((()=>m))}));return function(){return t.apply(this,arguments)}}()).then((e=>{b.default.ignoreTransaction((()=>{(0,A.getTable)().bulkCreate(e.map((e=>({id:e.id}))))}))}))}function j(e,t){if(e.fromMe||e.remote.isStatusV3())return!1;var r=(0,d.eventTypeFromMsgType)(t);return"a"===r||"d"===r}function W(e,t){for(var r=e,a=new Set,n=t.length-1;n>=0&&!(r<=0);n--){var i=t[n];j(i.id,i)&&(r--,a.add(String(i.id)))}return a}function V(){return(V=(0,s.default)((function*(e,t,r){var a=void 0,n=e?e.unreadCount:0;return t.forEach((e=>{var t=(0,d.eventTypeFromMsgType)(e);"i"!==t&&(e&&null!=e.t&&(null==a||e.t>a)&&(a=e.t),"a"!==t&&"d"!==t||e.id.fromMe||(n+=1))})),e&&null!=e.t&&(null==a||e.t>a)&&(a=e.t),{id:r.toString(),unreadCount:n,t:a}}))).apply(this,arguments)}function H(e,t,r,a,i,s){var o=[p.default.MSG_TYPE.IMAGE,p.default.MSG_TYPE.VIDEO,p.default.MSG_TYPE.AUDIO].includes(e.type),u=(0,n.default)((0,n.default)({},e),{},{vcardWAids:e.vcardWAids||q(e),id:e.id.toString(),isStarred:e.star?a:void 0,hasLink:"chat"===e.type&&r?a:void 0,isMediaMsg:o?a:void 0,isDocMsg:e.type===p.default.MSG_TYPE.DOCUMENT?a:void 0,expiredTimestamp:z(e)});null!=a&&(u.rowId=a),null!=i&&(u.internalId=(0,c.craftInternalId)(t,i)),s&&t!==h.STATUS_JID&&(u.pendingReadReceipt=1);var l,d=e.c2sTimestamp;e.id.fromMe&&!E.default.hasSynced?d=null!==(l=e.c2sTimestamp)&&void 0!==l?l:e.t:d=e.t;try{u.messageRangeIndex=(0,c.craftMessageRangeIndex)(t,!y.default.fromString(e.id).fromMe,p.default.SYSTEM_MESSAGE_TYPES.includes(e.type),d)}catch(e){__LOG__(4,void 0,new Error)(I(),e)}return u}function q(e){var t=[];if("vcard"===e.type)t=[e.body];else{if("multi_vcard"!==e.type)return;t=e.vcardList.map((e=>e.vcard))}return t.filter(Boolean).reduce(((e,t)=>{var r=(0,f.vcardWids)((0,f.parseVcard)(t));return e.concat(r.map((e=>e.toString())))}),[])}function z(e){var{ephemeralDuration:t,ephemeralStartTimestamp:r,t:a,subtype:n,id:{fromMe:i}}=e,s=(0,l.getEphemeralExpirationTimestamp)(t,r,a,n,i);return null!=s?s:void 0}},29146:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return o.apply(this,arguments)};var n=a(r(52954)),i=r(52303),s=r(95197);function o(){return(o=(0,n.default)((function*(e){var t=(0,s.beginningOfChat)(e),r=(0,s.endOfChat)(e),a=yield(0,i.getTable)().between(["internalId"],t,r,{lowerInclusive:!1,upperInclusive:!1,returnKeyType:"primary_key"});yield(0,i.getTable)().bulkRemove(a)}))).apply(this,arguments)}},95197:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.convertToMessageRowType=function(e){var t,r=(0,i.default)({},e);e.quotedMsg&&(r.quotedMsg=(0,i.default)({},e.quotedMsg));(null===(t=e.quotedMsg)||void 0===t?void 0:t.paymentNoteMsg)&&(r.quotedMsg.paymentNoteMsg=(0,i.default)({},e.quotedMsg.paymentNoteMsg));e.paymentNoteMsg&&(r.paymentNoteMsg=(0,i.default)({},e.paymentNoteMsg));r.id=e.id.toString(),e.from&&(r.from=e.from.toString());e.protocolMessageKey&&(r.protocolMessageKey=e.protocolMessageKey.toString());e.paymentRequestMessageKey&&(r.paymentRequestMessageKey=e.paymentRequestMessageKey.toString());return delete r.notifyName,delete r.local,delete r.isNewMsg,delete r.clearMedia,delete r.multicast,delete r.urlNumber,delete r.urlText,delete r.linkPreview,delete r.star,delete r.forwardedFromWeb,r=function(e){var t,r,a,n={currentMsg:{},quotedMsg:{}};if(null===(t=e.paymentNoteMsg)||void 0===t?void 0:t.body){var i;n.currentMsg.paymentNoteMsgBody=e.paymentNoteMsg.body,null===(i=e.paymentNoteMsg)||void 0===i||delete i.body}(null===(r=e.quotedMsg)||void 0===r||null===(a=r.paymentNoteMsg)||void 0===a?void 0:a.body)&&(n.quotedMsg.paymentNoteMsgBody=e.quotedMsg.paymentNoteMsg.body,delete e.quotedMsg.paymentNoteMsg.body);h.forEach((t=>{n.currentMsg[t]=e[t],delete e[t]})),e.quotedMsg&&h.forEach((t=>{n.quotedMsg[t]=e.quotedMsg[t],delete e.quotedMsg[t]}));var s=(0,o.encodeProto)(d.MsgRowOpaqueDataSpec,n);return e.msgRowOpaqueData=s.readBuffer(),e}(r)},t.hydrateMessage=function(e){var t,r=(0,i.default)({},e);e.quotedMsg&&(r.quotedMsg=(0,i.default)({},e.quotedMsg));(null===(t=e.quotedMsg)||void 0===t?void 0:t.paymentNoteMsg)&&(r.quotedMsg.paymentNoteMsg=(0,i.default)({},e.quotedMsg.paymentNoteMsg));e.paymentNoteMsg&&(r.paymentNoteMsg=(0,i.default)({},e.paymentNoteMsg));var a=c.default.fromString(r.id),n=r.protocolMessageKey?c.default.fromString(r.protocolMessageKey):void 0,o=r.paymentRequestMessageKey?c.default.fromString(r.paymentRequestMessageKey):void 0,u=(0,f.hydrateWids)(r);u.id=a,n&&(u.protocolMessageKey=n);o&&(u.paymentRequestMessageKey=o);return r.star=void 0!==r.isStarred,delete r.internalId,delete r.rowId,delete r.isStarred,delete r.count,delete r.hasLink,delete r.isMediaMsg,delete r.isDocMsg,delete r.expiredTimestamp,delete r.pendingReadReceipt,r=function(e){var t=(0,s.decodeProto)(d.MsgRowOpaqueDataSpec,e.msgRowOpaqueData);if(t.currentMsg){var r;if(t.currentMsg.paymentNoteMsgBody&&e.paymentNoteMsg)e.paymentNoteMsg.body=null===(r=t.currentMsg)||void 0===r?void 0:r.paymentNoteMsgBody;h.forEach((r=>{var a;e[r]=null===(a=t.currentMsg)||void 0===a?void 0:a[r]}))}e.quotedMsg&&t.quotedMsg&&(t.quotedMsg.paymentNoteMsgBody&&(e.quotedMsg.paymentNoteMsg.body=t.quotedMsg.paymentNoteMsgBody),h.forEach((r=>{var a;e.quotedMsg[r]=null===(a=t.quotedMsg)||void 0===a?void 0:a[r]})));return e}(r)},t.craftMessageRangeIndex=function(e,t,r,a){var n;n=r?_.SystemMessage:t?_.IncomingChatMessage:_.Outgoing;return"".concat(e,"_").concat(n,"_").concat(null!=a?m(a):"")},t.extractC2STimestampFromMessageRangeIndex=function(e){if(e){var t=e.split("_")[2];return t?g(t):null}return null},t.beginningOfMessageRange=function(e,t,r){var a=null!=r?m(r):"";return"".concat(e.toString(),"_").concat(t,"_").concat(a)},t.endOfMessageRange=function(e,t){return"".concat(e.toString(),"_").concat(t,"_g")},t.craftInternalId=function(e,t){var r=m(t);return"".concat(e,"_").concat(r,"_m")},t.getInChatMsgId=function(e){return g(e.split("_")[1])},t.beginningOfChat=function(e){return"".concat(e.toString(),"_/")},t.endOfChat=function(e){return"".concat(e.toString(),"_g")},t.queryChatMessageHelper=function(){return v.apply(this,arguments)},t.isUnreadTypeMsg=E,t.getKeyMsgsFromChatHistory=function(e){if(l.default.supportsFeature(l.default.F.MD_BACKEND)){var t,r=e.unreadCount,a=void 0,n=void 0,i=void 0;return(0,p.getTable)().between(["internalId"],"".concat(e.id,"_/"),"".concat(e.id,"_g"),{reverse:!0},(e=>(i||(i=e.id),n||(n=e),a||e.type!==u.default.MSG_TYPE.E2E_NOTIFICATION&&e.type!==u.default.MSG_TYPE.PROTOCOL&&(a=e),!(0!==r||!a)||!!(r>0&&E(e)&&0===(r-=1))&&(t=e.id.toString(),!0)))).then((()=>({anchor:t,previewMsg:a||n,lastReceivedKey:i})))}return Promise.resolve({anchor:void 0,previewMsg:void 0,lastReceivedKey:void 0})},t.shouldCreateChatWithMsgs=function(e){return e.some((e=>e.type!==u.default.MSG_TYPE.NOTIFICATION_TEMPLATE))},t.MessagePropertyType=t.MSG_OPAQUE_DATA_KEYS=void 0;var n=a(r(52954)),i=a(r(70417)),s=r(84139),o=r(68519),u=a(r(50935)),l=a(r(18120)),d=r(42451),c=a(r(77865)),f=r(69398),p=r(52303),h=["body","caption","clientUrl","loc","lng","lat","paymentAmount1000","canonicalUrl","matchedText","title","description"];t.MSG_OPAQUE_DATA_KEYS=h;var _=r(28103)({IncomingChatMessage:"1",Outgoing:"2",SystemMessage:"3"});function m(e){var t=e.toString(16);return(t.length-1).toString(16)+t}function g(e){return parseInt(e.substring(1),16)}function v(){return(v=(0,n.default)((function*(e,t,r){return l.default.supportsFeature(l.default.F.MD_BACKEND)?y(yield(0,p.getTable)().between(["internalId"],e,t,r)):Promise.resolve([])}))).apply(this,arguments)}function E(e){return[u.default.MSG_TYPE.CHAT,u.default.MSG_TYPE.IMAGE,u.default.MSG_TYPE.VIDEO,u.default.MSG_TYPE.AUDIO,u.default.MSG_TYPE.PTT,u.default.MSG_TYPE.DOCUMENT,u.default.MSG_TYPE.VCARD,u.default.MSG_TYPE.LOCATION,u.default.MSG_TYPE.CIPHERTEXT,u.default.MSG_TYPE.OVERSIZED,u.default.MSG_TYPE.MULTI_VCARD,u.default.MSG_TYPE.UNKNOWN,u.default.MSG_TYPE.STICKER,u.default.MSG_TYPE.PRODUCT,u.default.MSG_TYPE.GROUPS_V4_INVITE].includes(e.type)}function y(e){return e.filter((e=>e.type!==u.default.MSG_TYPE.DEBUG))}t.MessagePropertyType=_},55361:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.removeOrphanReceipt=function(e){if(n.default.supportsFeature(n.default.F.MD_BACKEND))return(0,i.getTable)().remove(e);return Promise.reject(new Error("removeOrphanReceipt: not supported for non MD"))},t.getOrphanReceipt=function(e){if(n.default.supportsFeature(n.default.F.MD_BACKEND))return(0,i.getTable)().get(e);return Promise.reject(new Error("getOrphanReceipt: not supported for non MD"))},t.createOrUpdateOrphanReceipt=function(e,t,r){if(n.default.supportsFeature(n.default.F.MD_BACKEND))return(0,s.getStorage)().lock(["orphan-receipt"],(([a])=>a.bulkGet(r).then((n=>{var i=r.reduce(((r,a,i)=>{var s=n[i];s||(s={msgKey:a});var o=s[e];return(null==o||o>t)&&(s[e]=t,r.push(s)),r}),[]);return a.bulkCreateOrReplace(i)}))));return Promise.reject(new Error("updateReceiptRecords: not supported for non MD"))};var n=a(r(18120)),i=r(37752),s=r(77993)},51878:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.getGroupSenderKeyList=function(e){var t;if(s.default.supportsFeature(s.default.F.MD_BACKEND)){var r=e.toString();if(!(t=(0,l.getTable)().get(r).then((e=>{var t=[],r=[];if(!e)return{skDistribList:t,skList:r,rotateKey:!1};var{senderKey:a,rotateKey:n}=e;return Array.from(a.keys()).forEach((e=>{a.get(e)?r.push((0,d.createWid)(e)):t.push((0,d.createWid)(e))})),n?{skDistribList:t.concat(r),skList:[],rotateKey:n}:{skDistribList:t,skList:r,rotateKey:n}}))))return Promise.reject(new Error("getGroupSenderKeyList: not supported"))}else t=Promise.reject("getGroupSenderKeyList: not supported without model storage and md backend");return t},t.markHasSenderKey=function(e,t){var r;if(s.default.supportsFeature(s.default.F.MD_BACKEND)){var a=e.toString();if(!(r=(0,u.getStorage)().lock(["participant"],(([e])=>e.get(a).then((r=>{if(r)return e.createOrReplace(m(r,t,!0));__LOG__(2)(f(),a)}))))))return Promise.reject(new Error("markHasSenderKey: not supported"))}else r=Promise.reject("markHasSenderKey: not supported without model storage and md backend");return r},t.markForgetSenderKey=function(e,t){var r;if(s.default.supportsFeature(s.default.F.MD_BACKEND)){var a=e.toString();if(!(r=(0,u.getStorage)().lock(["participant"],(([e])=>e.get(a).then((r=>{if(r)return e.createOrReplace(m(r,t,!1));__LOG__(2)(c(),a)}))))))return Promise.reject(new Error("markForgetSenderKey: not supported"))}else r=Promise.reject("markForgetSenderKey: not supported without model storage and md backend");return r},t.updateParticipants=function(e,t){var r;if(s.default.supportsFeature(s.default.F.MD_BACKEND)){var{participants:a,version:i,prevVersion:l}=t,c=e.toString();if(!(r=(0,u.getStorage)().lock(["participant"],function(){var e=(0,n.default)((function*([e]){var r=yield e.get(c);if(!r)throw new p("updateParticipants: group participant info missing for group ".concat(c,", action ").concat(t.action));if(r.version&&(null==l||l!==r.version))throw new p("updateParticipants: prevVersion info missing for group ".concat(c,", action ").concat(t.action));switch(t.action){case h.ADD:return e.createOrReplace(function(e,t,r,a){var n=new Map(e.senderKey);return r.forEach((e=>{if(!e.equals((0,o.assertGetMe)())){var t=String(e);n.set(t,!1)}})),{groupId:e.groupId,senderKey:n,participants:e.participants.concat(t.map(String)),admins:e.admins,rotateKey:e.rotateKey,version:a,deviceSyncComplete:e.deviceSyncComplete}}(r,a,t.deviceIds,i));case h.REMOVE:return e.createOrReplace(function(e,t,r){var a=new Map(e.senderKey);Array.from(a.keys()).forEach((e=>{var r=(0,d.createWid)(e).user;t.some((e=>e.user===r))?a.delete(e):a.set(e,!1)}));var n=t.map(String);return{groupId:e.groupId,senderKey:a,participants:e.participants.filter((e=>!n.includes(e))),admins:e.admins.filter((e=>!n.includes(e))),rotateKey:!0,version:r,deviceSyncComplete:e.deviceSyncComplete}}(r,a,i));case h.DEMOTE:return e.createOrReplace(_(r,a,i,h.DEMOTE));case h.PROMOTE:return e.createOrReplace(_(r,a,i,h.PROMOTE));default:throw new Error("updateParticipants: failed with unknown action ".concat(t.action))}}));return function(){return e.apply(this,arguments)}}())))return Promise.reject(new Error("addParticipantRecord: not supported"))}else r=Promise.reject(new Error("updateParticipants: not supported without model storage and md backend"));return r},t.replaceParticipants=function(e,t,r,a,n){var i;if(!s.default.supportsFeature(s.default.F.MD_BACKEND))return Promise.reject(new Error("replaceParticipants: not supported without model storage and md backend"));var l=e.toString();if(!(i=(0,u.getStorage)().lock(["participant"],(([e])=>e.get(l).then((i=>i?e.createOrReplace(function(e,t,r,a,n){var i=e.rotateKey,s=e.senderKey,u=new Map;a.forEach((e=>{if(!e.equals((0,o.assertGetMe)())){var t=String(e),r=s.get(t);null==r?u.set(t,!1):(u.set(t,r),s.delete(t))}})),0!==s.size&&(i=!0);return{groupId:e.groupId,senderKey:u,participants:t.map(String),admins:r.map(String),rotateKey:i,version:n,deviceSyncComplete:!0}}(i,t,r,a,n)):e.create(function(e,t,r,a,n){var i=new Map;return a.forEach((e=>{if(!e.equals((0,o.assertGetMe)())){var t=String(e);i.has(t)||i.set(t,!1)}})),{groupId:e,senderKey:i,participants:t.map(String),admins:r.map(String),rotateKey:!1,version:n,deviceSyncComplete:!0}}(l,t,r,a,n))))))))return Promise.reject(new Error("replaceParticipants: not supported"));return i},t.PARTICIPANT_OPERATION=t.GroupUnSyncedError=void 0;var n=a(r(52954)),i=a(r(19976)),s=a(r(18120)),o=r(95595),u=r(77993),l=r(33762),d=r(75637);function c(){var e=(0,i.default)(["markForgetSenderKey: group participant info missing for group ",""]);return c=function(){return e},e}function f(){var e=(0,i.default)(["markHasSenderKey: group participant info missing for group ",""]);return f=function(){return e},e}class p extends Error{constructor(...e){super(...e),this.name="GroupUnSyncedError"}}t.GroupUnSyncedError=p;var h=Object.freeze({ADD:"add",REMOVE:"remove",DEMOTE:"demote",PROMOTE:"promote"});function _(e,t,r,a){var n=e.admins,i=t.map(String);return a===h.DEMOTE?n=e.admins.filter((e=>!i.includes(e))):a===h.PROMOTE&&(n=e.admins.concat(i)),{groupId:e.groupId,senderKey:e.senderKey,participants:e.participants,admins:n,rotateKey:e.rotateKey,version:r,deviceSyncComplete:e.deviceSyncComplete}}function m(e,t,r){var a=new Map(e.senderKey),n=!1;return t.forEach((e=>{if(!e.equals((0,o.assertGetMe)())){var t=String(e);a.has(t)?a.set(t,r):n=!0}})),{groupId:e.groupId,senderKey:a,participants:e.participants,admins:e.admins,rotateKey:n,deviceSyncComplete:e.deviceSyncComplete}}t.PARTICIPANT_OPERATION=h},8825:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.queryStatusAllMD=function(){var e=(0,c.createWid)(o.default.STATUS_WID);return u.default.waitForFinalDbMsgEncKey().then((()=>(0,d.queryChatMessageHelper)((0,d.beginningOfChat)(e),(0,d.endOfChat)(e),{lowerInclusive:!1,upperInclusive:!1}).then((e=>{var t=[],r=[];e.forEach((e=>{(0,s.happenedWithin)((0,s.castToUnixTime)(e.t),s.DAY_SECONDS)&&e.type!==o.default.MSG_TYPE.REVOKED?r.push((0,d.hydrateMessage)(e)):e.author?t.push(e.id):__LOG__(3)(f())})),(0,l.getTable)().bulkRemove(t);var a=(0,i.default)(r,(e=>e.author.toString())),n=[];for(var u in a){var p=a[u],h=p.filter((e=>e.ack<o.default.ACK.READ)).length,_=p[p.length-1].t;n.push({id:(0,c.createWid)(u),unreadCount:h,totalCount:p.length,t:_,_msgs:p})}return{statuses:n}}))))};var n=a(r(19976)),i=a(r(3440)),s=r(71684),o=a(r(50935)),u=a(r(72291)),l=r(52303),d=r(95197),c=r(75637);function f(){var e=(0,n.default)(["Author is null for status v3 message"]);return f=function(){return e},e}},88581:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getTaskScheduledTime=function(e){return(0,n.getTable)().get(e).then((e=>null==e?void 0:e.time))},t.updateTaskScheduledTime=function(e,t){return(0,a.getStorage)().lock(["tasks-scheduled-time"],(([r])=>r.createOrReplace({taskName:e,time:t})))};var a=r(77993),n=r(78139)},69398:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.hydrateWids=function e(t){if(Array.isArray(t))return t.map(((t,r)=>e((0,n.default)(r,t,i.isWidlike,i.createWidFromWidLike))));if(t&&"object"==typeof t){for(var r=Object.keys(t),a=0;a<r.length;a++){var s=r[a];t[s]=e((0,n.default)(s,t[s],i.isWidlike,i.createWidFromWidLike))}return t}return t};var n=a(r(80737)),i=r(75637)},84066:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.hasBusinessNameVerificationChanged=function(e,t,r){var a=Promise.resolve(!1);a=n.default.supportsFeature(n.default.F.MD_BACKEND)?(0,i.getTable)().get(e.user).then((e=>!e||e.serial!==r||e.level!==t)):Promise.reject("hasBusinessNameVerificationChanged: not supported without md backend");return a},t.getAllVerifiedNames=function(){var e=Promise.resolve([]);e=n.default.supportsFeature(n.default.F.MD_BACKEND)?(0,i.getTable)().all():Promise.reject(new Error("getAllVerifiedNames: not supported without md backend"));return e},t.createOrUpdateVerifiedBusinessName=function(e,t,r,a,o,u,l,d,c){var f;if(n.default.supportsFeature(n.default.F.MD_BACKEND)){var p=(0,s.toUserWid)(t).user,h=e||(0,i.getTable)();if(!(f=h.createOrReplace({id:p,level:r,serial:a,name:o,isApi:u,actualActors:l,hostStorage:d,privacyModeTs:c})))return Promise.reject(new Error("createOrUpdateVerifiedBusinessName: not supported for non MD"))}else f=Promise.reject("createOrUpdateVerifiedBusinessName: not supported without md backend");return f};var n=a(r(18120)),i=r(54128),s=r(75637)},11008:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0});var n={initialize:!0};t.initialize=function(){if(!i.default.supportsFeature(i.default.F.MD_BACKEND))return Promise.resolve();return(0,s.initializeWithoutGKs)()};var i=a(r(18120)),s=r(24319);Object.keys(s).forEach((function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(n,e)||Object.defineProperty(t,e,{enumerable:!0,get:function(){return s[e]}}))}))},24319:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.initializeWithoutGKs=function(){null==k&&((0,u.createStorage)(),(0,d.addTable)(),(0,c.addTable)(),(0,f.addTable)(),(0,p.addTable)(),(0,h.addTable)(),(0,_.addTable)(),(0,m.addTable)(),(0,g.addTable)(),(0,v.addTable)(),(0,E.addTable)(),(0,y.addTable)(),(0,S.addTable)(),(0,T.addTable)(),(0,b.addTable)(),(0,A.addTable)(),(0,C.addTable)(),(0,P.addTable)(),(0,O.addTable)(),(0,w.addTable)(),(0,M.addTable)(),(0,I.addTable)(),(0,R.addTable)(),(0,D.addTable)(),(0,N.addTable)(),(0,o.addTable)(),(0,s.addTable)(),(0,l.addTable)(),k=(0,u.getStorage)().initialize().catch((e=>{throw __LOG__(4,!0,new Error,!0)(L()),SEND_LOGS("Failed to initialize model storage"),e})));return k},t.destroy=function(){return(0,u.destroyStorage)().catch((()=>U.resolve(new i.default(u.DATABASE_NAME).delete()))).finally((()=>{k=null}))},t.clearInitializePromise=function(){k=null},Object.defineProperty(t,"getCollectionVersionTable",{enumerable:!0,get:function(){return s.getTable}}),Object.defineProperty(t,"getPendingMutationsTable",{enumerable:!0,get:function(){return o.getTable}}),Object.defineProperty(t,"getSyncActionsTable",{enumerable:!0,get:function(){return l.getTable}}),Object.defineProperty(t,"getABPropConfigsTable",{enumerable:!0,get:function(){return d.getTable}}),Object.defineProperty(t,"getTasksScheduledTimeTable",{enumerable:!0,get:function(){return c.getTable}}),Object.defineProperty(t,"getContactTable",{enumerable:!0,get:function(){return f.getTable}}),Object.defineProperty(t,"getBlocklistTable",{enumerable:!0,get:function(){return p.getTable}}),Object.defineProperty(t,"getProfilePicThumbTable",{enumerable:!0,get:function(){return h.getTable}}),Object.defineProperty(t,"getChatTable",{enumerable:!0,get:function(){return _.getTable}}),Object.defineProperty(t,"getMessageTable",{enumerable:!0,get:function(){return m.getTable}}),Object.defineProperty(t,"getMsgInfoTable",{enumerable:!0,get:function(){return g.getTable}}),Object.defineProperty(t,"getParticipantTable",{enumerable:!0,get:function(){return v.getTable}}),Object.defineProperty(t,"getOrphanReceiptTable",{enumerable:!0,get:function(){return E.getTable}}),Object.defineProperty(t,"getDeviceListTable",{enumerable:!0,get:function(){return y.getTable}}),Object.defineProperty(t,"getLabelTable",{enumerable:!0,get:function(){return S.getTable}}),Object.defineProperty(t,"getLabelAssociationTable",{enumerable:!0,get:function(){return T.getTable}}),Object.defineProperty(t,"getInactiveReceiptTable",{enumerable:!0,get:function(){return b.getTable}}),Object.defineProperty(t,"getVerifiedBusinessNameTable",{enumerable:!0,get:function(){return A.getTable}}),Object.defineProperty(t,"getHistorySyncNotificationTable",{enumerable:!0,get:function(){return C.getTable}}),Object.defineProperty(t,"getEncryptedMutationsTable",{enumerable:!0,get:function(){return P.getTable}}),Object.defineProperty(t,"getQuickReplyTable",{enumerable:!0,get:function(){return O.getTable}}),Object.defineProperty(t,"getGroupMetadataTable",{enumerable:!0,get:function(){return w.getTable}}),Object.defineProperty(t,"getSyncKeysTable",{enumerable:!0,get:function(){return M.getTable}}),Object.defineProperty(t,"getActiveMessageRangesTable",{enumerable:!0,get:function(){return I.getTable}}),Object.defineProperty(t,"getFtsIndexingQueueTable",{enumerable:!0,get:function(){return R.getTable}}),Object.defineProperty(t,"getCartTable",{enumerable:!0,get:function(){return D.getTable}}),Object.defineProperty(t,"getMissingKeysTable",{enumerable:!0,get:function(){return N.getTable}});var n=a(r(19976)),i=a(r(77715)),s=r(97211),o=r(38685),u=r(77993),l=r(96001),d=r(67995),c=r(78139),f=r(5254),p=r(66315),h=r(88451),_=r(35855),m=r(52303),g=r(24170),v=r(33762),E=r(37752),y=r(47513),S=r(71329),T=r(98538),b=r(34788),A=r(54128),C=r(8750),P=r(23054),O=r(8656),w=r(96056),M=r(54440),I=r(96762),R=r(97405),D=r(32771),N=r(27279);function L(){var e=(0,n.default)(["Assertion failed!"]);return L=function(){return e},e}var k,U=r(41449).Z},67995:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.addTable=function(){(0,i.getStorage)().add("abpropConfigs").version((0,o.abpropsConfigCreateTable)(),[new s.default("configCode"),new n.default("configValue"),new n.default("configExpoKey")]).view((e=>({configCode:e.configCode,configValue:e.configValue,configExpoKey:e.configExpoKey})))},t.getTable=function(){return(0,i.getStorage)().table("abpropConfigs")};var n=a(r(30530)),i=r(77993),s=a(r(58642)),o=r(89290)},96762:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.addTable=function(){(0,o.getStorage)().add("active-message-ranges").version((0,u.activeMessageRangesCreateTable)(),[new s.default(["chatId","action"]),new i.default("chatId"),new n.default("actionValue"),new n.default("remainingMessages")]).view((e=>e))},t.getTable=function(){return(0,o.getStorage)().table("active-message-ranges")};var n=a(r(30530)),i=a(r(90146)),s=a(r(19667)),o=r(77993),u=r(89290)},66315:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.addTable=function(){(0,n.getStorage)().add("blocklist").version((0,s.blocklistCreateTable)(),[new i.default("id")]).view((e=>({id:e.id})))},t.getTable=function(){return(0,n.getStorage)().table("blocklist")};var n=r(77993),i=a(r(58642)),s=r(89290)},32771:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.addTable=function(){(0,i.getStorage)().add("cart").version((0,o.cartCreateTable)(),[new s.default("id"),new n.default("products"),new n.default("message"),new n.default("total"),new n.default("currency"),new n.default("itemCount")]).view((e=>e))},t.getTable=function(){return(0,i.getStorage)().table("cart")};var n=a(r(30530)),i=r(77993),s=a(r(58642)),o=r(89290)},35855:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.addTable=function(){(0,i.getStorage)().add("chat").version((0,o.chatCreateTable)(),[new s.default("id"),new n.default("t"),new n.default("unreadCount"),new n.default("archive"),new n.default("isReadOnly"),new n.default("isAnnounceGrpRestrict"),new n.default("modifyTag"),new n.default("muteExpiration"),new n.default("name"),new n.default("notSpam"),new n.default("pin"),new n.default("changeNumberOldJid"),new n.default("changeNumberNewJid"),new n.default("ephemeralDuration"),new n.default("ephemeralSettingTimestamp"),new n.default("unreadMsgAnchorId"),new n.default("endOfHistoryTransferType")]).view((e=>({id:e.id,t:e.t,unreadCount:e.unreadCount,unreadMsgAnchorId:e.unreadMsgAnchorId,archive:e.archive,isReadOnly:e.isReadOnly,isAnnounceGrpRestrict:e.isAnnounceGrpRestrict,modifyTag:e.modifyTag,muteExpiration:e.muteExpiration,name:e.name,notSpam:e.notSpam,pin:e.pin,changeNumberOldJid:e.changeNumberOldJid,changeNumberNewJid:e.changeNumberNewJid,endOfHistoryTransfer:e.endOfHistoryTransfer,endOfHistoryTransferType:e.endOfHistoryTransferType,ephemeralDuration:e.ephemeralDuration,ephemeralSettingTimestamp:e.ephemeralSettingTimestamp})))},t.getTable=function(){return(0,i.getStorage)().table("chat")};var n=a(r(30530)),i=r(77993),s=a(r(58642)),o=r(89290)},97211:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.addTable=function(){(0,i.getStorage)().add("collection-version").version((0,o.collectionVersionCreateTable)(),[new s.default("collection"),new n.default("version"),new n.default("state"),new n.default("finiteFailureStartTime"),new n.default("ltHash")]).view((e=>e))},t.getTable=function(){return(0,i.getStorage)().table("collection-version")};var n=a(r(30530)),i=r(77993),s=a(r(58642)),o=r(89290)},5254:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.addTable=function(){(0,s.getStorage)().add("contact").version((0,u.contactCreateTable)(),[new o.default("id"),new n.default("name"),new n.default("shortName"),new n.default("pushname"),new n.default("type"),new n.default("verifiedName"),new n.default("isBusiness"),new n.default("isEnterprise"),new n.default("verifiedLevel"),new n.default("statusMute"),new n.default("sectionHeader"),new n.default("isAddressBookContact"),new i.default("isAddressBookContact")]).version((0,u.contactAddIsContactSyncCompleted)(),[new n.default("isContactSyncCompleted"),new i.default("isContactSyncCompleted")]).view((e=>e))},t.getTable=function(){return(0,s.getStorage)().table("contact")};var n=a(r(30530)),i=a(r(90146)),s=r(77993),o=a(r(58642)),u=r(89290)},47513:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.addTable=function(){(0,i.getStorage)().add("device-list").version((0,o.deviceListCreateTable)(),[new s.default("id"),new n.default("devices"),new n.default("nextVersion"),new n.default("rawId"),new n.default("timestamp"),new n.default("validIndexes"),new n.default("currentIndex")]).view((e=>e))},t.getTable=function(){return(0,i.getStorage)().table("device-list")};var n=a(r(30530)),i=r(77993),s=a(r(58642)),o=r(89290)},23054:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.addTable=function(){(0,s.getStorage)().add("encrypted-mutations").version((0,o.encryptedMutationsCreateTable)(),[new i.default("id"),new n.default("collectionName"),new n.default("keyId"),new n.default("indexMac"),new n.default("operation"),new n.default("indexAndValueCipherText")]).view((e=>e))},t.getTable=function(){return(0,s.getStorage)().table("encrypted-mutations")};var n=a(r(30530)),i=a(r(72948)),s=r(77993),o=r(89290)},97405:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.addTable=function(){(0,n.getStorage)().add("fts-indexing-queue").version((0,s.ftsIndexingQueueCreateTable)(),[new i.default("id")]).view((e=>e))},t.getTable=function(){return(0,n.getStorage)().table("fts-indexing-queue")};var n=r(77993),i=a(r(58642)),s=r(89290)},96056:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.addTable=function(){(0,i.getStorage)().add("group-metadata").version((0,o.groupMetadataCreateTable)(),[new s.default("id"),new n.default("subject"),new n.default("subjectTime"),new n.default("creation"),new n.default("owner"),new n.default("desc"),new n.default("descId"),new n.default("descTime"),new n.default("descOwner"),new n.default("restrict"),new n.default("announce"),new n.default("a_v_id"),new n.default("noFrequentlyForwarded"),new n.default("ephemeralDuration"),new n.default("size"),new n.default("support")]).view((e=>e))},t.getTable=function(){return(0,i.getStorage)().table("group-metadata")};var n=a(r(30530)),i=r(77993),s=a(r(58642)),o=r(89290)},8750:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.addTable=function(){(0,u.getStorage)().add("history-sync-notification").version((0,d.historySyncNotificationsCreateTable)(),[new l.default("msgKey"),new i.default("downloadOptions"),new i.default("syncType"),new s.default("chunkEncryptionKey",s.ENCRYPTED_VALUE_TYPE.STRING),new i.default("chunkOrder"),new i.default("processed"),new o.default("syncType"),new o.default("chunkOrder"),new o.default("processed"),new i.default("isReupload"),new i.default("historySyncStepStartedTs"),new i.default("historySyncPayloadSize"),new i.default("reuploadPending")]).view((e=>e)).useDbMsgEncKeyForEncryptedCol(!0)},t.getTable=function(){return(0,u.getStorage)().table("history-sync-notification")};var i=n(r(30530)),s=a(r(80522)),o=n(r(90146)),u=r(77993),l=n(r(58642)),d=r(89290)},34788:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.addTable=function(){(0,i.getStorage)().add("inactive-receipt").version((0,o.inactiveReceiptCreateTable)(),[new s.default("msgId"),new n.default("chatId"),new n.default("participantId")]).view((e=>e))},t.getTable=function(){return(0,i.getStorage)().table("inactive-receipt")};var n=a(r(30530)),i=r(77993),s=a(r(58642)),o=r(89290)},98538:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.addTable=function(){(0,o.getStorage)().add("label-association").version((0,u.labelAssociationCreateTable)(),[new s.default(["labelId","associationId","type"]),new i.default("labelId"),new n.default(["associationId","type"])]).view((e=>e))},t.getTable=function(){return(0,o.getStorage)().table("label-association")},t.LabelAssociationType=void 0;var n=a(r(9387)),i=a(r(90146)),s=a(r(19667)),o=r(77993),u=r(89290),l=r(28103)({Jid:"jid",Message:"message"});t.LabelAssociationType=l},71329:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.addTable=function(){(0,i.getStorage)().add("label").version((0,o.labelCreateTable)(),[new s.default("id"),new n.default("name"),new n.default("colorIndex"),new n.default("predefinedId")]).view((e=>e))},t.getTable=function(){return(0,i.getStorage)().table("label")};var n=a(r(30530)),i=r(77993),s=a(r(58642)),o=r(89290)},24170:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.addTable=function(){(0,o.getStorage)().add("message-info").version((0,u.messageInfoCreateTable)(),[new s.default(["msgKey","receiverUserJid"]),new n.default("delivery"),new n.default("read"),new n.default("played"),new n.default("deviceDelivered"),new n.default("deviceNotDelivered"),new i.default("msgKey")]).view((e=>e))},t.getTable=function(){return(0,o.getStorage)().table("message-info")};var n=a(r(30530)),i=a(r(90146)),s=a(r(19667)),o=r(77993),u=r(89290)},52303:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.addTable=function(){(0,c.getStorage)().add("message").version((0,p.messageCreateTable)(),[new f.default("id"),new s.default("internalId"),new d.default("internalId"),new s.default("rowId"),new d.default("rowId"),new s.default("type"),new s.default("subtype"),new s.default("t"),new s.default("notifyName"),new s.default("from"),new s.default("to"),new s.default("author"),new s.default("self"),new s.default("ack"),new s.default("invis"),new s.default("isStarred"),new l.default("isStarred"),new s.default("mentionedJidList"),new s.default("count"),new s.default("devicesAdded"),new s.default("devicesRemoved"),new s.default("isThisDeviceAdded"),new s.default("recipients"),new s.default("protocolMessageKey"),new s.default("templateParams"),new o.default(["internalId","isStarred"]),new s.default("vcardWAids"),new i.default("vcardWAids"),new s.default("hasLink"),new s.default("isMediaMsg"),new s.default("isDocMsg"),new o.default(["internalId","isMediaMsg"]),new o.default(["internalId","isDocMsg"]),new o.default(["internalId","hasLink"]),new s.default("ephemeralStartTimestamp"),new s.default("ephemeralDuration"),new s.default("ephemeralSettingTimestamp"),new s.default("ephemeralOutOfSync"),new s.default("expiredTimestamp"),new l.default("expiredTimestamp"),new s.default("directPath"),new s.default("mimetype"),new s.default("duration"),new s.default("filehash"),new s.default("uploadhash"),new s.default("size"),new s.default("filename"),new s.default("streamingSidecar"),new s.default("mediaKey"),new s.default("mediaKeyTimestamp"),new s.default("pageCount"),new s.default("isGif"),new s.default("gifAttribution"),new s.default("isViewOnce"),new s.default("width"),new s.default("height"),new s.default("scanLengths"),new s.default("scansSidecar"),new s.default("interactiveAnnotations"),new s.default("firstFrameLength"),new s.default("firstFrameSidecar"),new s.default("isAnimated"),new s.default("thumbnail"),new s.default("richPreviewType"),new s.default("doNotPlayInline"),new s.default("broadcast"),new s.default("broadcastParticipants"),new s.default("broadcastId"),new s.default("quotedMsg"),new s.default("quotedStanzaID"),new s.default("quotedRemoteJid"),new s.default("quotedParticipant"),new s.default("footer"),new s.default("hydratedButtons"),new s.default("selectedId"),new s.default("selectedIndex"),new s.default("vcardFormattedName"),new s.default("isVcardOverMmsDocument"),new s.default("businessOwnerJid"),new s.default("productId"),new s.default("currencyCode"),new s.default("priceAmount1000"),new s.default("retailerId"),new s.default("url"),new s.default("productImageCount"),new s.default("paymentCurrency"),new s.default("paymentMessageReceiverJid"),new s.default("paymentTransactionTimestamp"),new s.default("paymentStatus"),new s.default("paymentNoteMsg"),new s.default("paymentRequestMessageKey"),new s.default("paymentExpiryTimestamp"),new s.default("message"),new s.default("orderTitle"),new s.default("itemCount"),new s.default("orderId"),new s.default("surface"),new s.default("status"),new s.default("token"),new s.default("textColor"),new s.default("backgroundColor"),new s.default("font"),new s.default("isForwarded"),new s.default("forwardingScore"),new s.default("ctwaContext"),new s.default("mdDowngrade"),new s.default("messageRangeIndex"),new l.default("messageRangeIndex"),new s.default("vcardList"),new s.default("totalAmount1000"),new s.default("totalCurrencyCode"),new s.default("list"),new s.default("listResponse"),new s.default("isDynamicReplyButtonsMsg"),new s.default("dynamicReplyButtons"),new s.default("selectedButtonId"),new s.default("sellerJid"),new s.default("deprecatedMms3Url"),new s.default("encFilehash"),new u.default("msgRowOpaqueData",u.ENCRYPTED_VALUE_TYPE.ARRAY_BUFFER),new s.default("thumbnailDirectPath"),new s.default("thumbnailSha256"),new s.default("thumbnailEncSha256"),new s.default("thumbnailHeight"),new s.default("thumbnailWidth"),new s.default("pendingReadReceipt"),new o.default(["from","pendingReadReceipt"])]).version((0,p.messageAddIsSendFailureProperties)(),[new s.default("isSendFailure")]).version((0,p.messageAddPaymentTxnStatus)(),[new s.default("paymentTxnStatus")]).view((e=>e)).enablePropFilter(!0).useDbMsgEncKeyForEncryptedCol(!0)},t.getTable=function(){return(0,c.getStorage)().table("message")};var i=n(r(66879)),s=n(r(30530)),o=n(r(9387)),u=a(r(80522)),l=n(r(90146)),d=n(r(95745)),c=r(77993),f=n(r(58642)),p=r(89290)},27279:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.addTable=function(){(0,i.getStorage)().add("missing-keys").version((0,o.missingKeysCreateTable)(),[new s.default("keyHex"),new n.default("keyId"),new n.default("timestamp"),new n.default("deviceResponses")]).view((e=>e))},t.getTable=function(){return(0,i.getStorage)().table("missing-keys")};var n=a(r(30530)),i=r(77993),s=a(r(58642)),o=r(89290)},37752:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.addTable=function(){(0,i.getStorage)().add("orphan-receipt").version((0,o.orphanReceiptCreateTable)(),[new s.default("msgKey"),new n.default("delivery"),new n.default("read"),new n.default("played")]).view((e=>e))},t.getTable=function(){return(0,i.getStorage)().table("orphan-receipt")};var n=a(r(30530)),i=r(77993),s=a(r(58642)),o=r(89290)},33762:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.addTable=function(){(0,s.getStorage)().add("participant").version((0,u.participantCreateTable)(),[new o.default("groupId"),new i.default("senderKey"),new i.default("participants"),new i.default("admins"),new i.default("rotateKey"),new i.default("version"),new n.default("participants"),new i.default("deviceSyncComplete")]).view((e=>e))},t.getTable=function(){return(0,s.getStorage)().table("participant")};var n=a(r(66879)),i=a(r(30530)),s=r(77993),o=a(r(58642)),u=r(89290)},38685:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.addTable=function(){(0,o.getStorage)().add("pending-mutations").version((0,u.pendingMutationsCreateTable)(),[new s.default("id"),new n.default("collection"),new n.default("index"),new i.default("index"),new n.default("timestamp"),new i.default("collection"),new n.default("version"),new n.default("operation"),new n.default("binarySyncAction")]).view((e=>e))},t.getTable=function(){return(0,o.getStorage)().table("pending-mutations")};var n=a(r(30530)),i=a(r(90146)),s=a(r(72948)),o=r(77993),u=r(89290)},88451:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.addTable=function(){(0,i.getStorage)().add("profile-pic-thumb").version((0,o.profilePicThumbCreateTable)(),[new s.default("id"),new n.default("tag"),new n.default("raw"),new n.default("eurl"),new n.default("previewEurl")]).view((e=>({id:e.id,tag:e.tag,raw:e.raw,eurl:e.eurl,previewEurl:e.previewEurl})))},t.getTable=function(){return(0,i.getStorage)().table("profile-pic-thumb")};var n=a(r(30530)),i=r(77993),s=a(r(58642)),o=r(89290)},8656:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.addTable=function(){(0,i.getStorage)().add("quick-reply").version((0,o.quickReplyCreateTable)(),[new s.default("id"),new n.default("shortcut"),new n.default("message"),new n.default("count"),new n.default("keywords")]).view((e=>e))},t.getTable=function(){return(0,i.getStorage)().table("quick-reply")};var n=a(r(30530)),i=r(77993),s=a(r(58642)),o=r(89290)},96001:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.addTable=function(){(0,o.getStorage)().add("sync-actions").version((0,l.syncActionsCreateTable)(),[new u.default("index"),new n.default("keyId"),new n.default("version"),new n.default("actionState"),new s.default("actionState"),new n.default("modelId"),new n.default("modelType"),new i.default(["modelId","modelType","actionState"]),new n.default("valueMac"),new n.default("indexMac"),new s.default("indexMac"),new n.default("collection"),new s.default("collection"),new n.default("timestamp"),new n.default("action"),new s.default("action"),new n.default("binarySyncAction")]).view((e=>e))},t.getTable=function(){return(0,o.getStorage)().table("sync-actions")};var n=a(r(30530)),i=a(r(9387)),s=a(r(90146)),o=(r(63487),r(77993)),u=a(r(58642)),l=r(89290)},54440:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.addTable=function(){(0,u.getStorage)().add("sync-keys").version((0,d.syncKeysCreateTable)(),[new l.default("keyId"),new i.default("timestamp"),new i.default("fingerprint"),new s.default("keyData",s.ENCRYPTED_VALUE_TYPE.ARRAY_BUFFER),new i.default("keyEpoch"),new o.default("keyEpoch")]).view((e=>e))},t.getTable=function(){return(0,u.getStorage)().table("sync-keys")};var i=n(r(30530)),s=a(r(80522)),o=n(r(90146)),u=r(77993),l=n(r(58642)),d=r(89290)},78139:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.addTable=function(){(0,i.getStorage)().add("tasks-scheduled-time").version((0,o.tasksScheduledTimeCreateTable)(),[new s.default("taskName"),new n.default("time")]).view((e=>e))},t.getTable=function(){return(0,i.getStorage)().table("tasks-scheduled-time")};var n=a(r(30530)),i=r(77993),s=a(r(58642)),o=r(89290)},54128:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.addTable=function(){(0,i.getStorage)().add("verified-business-name").version((0,o.verifiedBusinessNameCreateTable)(),[new s.default("id"),new n.default("serial"),new n.default("name"),new n.default("isApi"),new n.default("level"),new n.default("actualActors"),new n.default("hostStorage"),new n.default("privacyModeTs")]).view((e=>e))},t.getTable=function(){return(0,i.getStorage)().table("verified-business-name")};var n=a(r(30530)),i=r(77993),s=a(r(58642)),o=r(89290)},77993:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.createStorage=function(){var e=new i.default(o);u=new s.default(e)},t.getStorage=function(){return(0,n.default)(null!=u,"[model-storage] Storage should be created first before being accessed"),u},t.destroyStorage=function(){if(null==u)return Promise.reject(new Error("[model-storage] Storage should be created first before being destroyed"));return u.purge().then((()=>{u=null})).catch((e=>{throw u=null,e}))},t.DATABASE_NAME=void 0;var n=a(r(47677)),i=a(r(2206)),s=a(r(6957)),o="model-storage";t.DATABASE_NAME=o;var u=null},82284:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.restoreGroupsContactsAndProfilePics=function(){__LOG__(2)(X()),p.default.trigger("me_ready");var e=(0,_.getPushname)(),t=(0,_.getLastMobilePlatform)();if(null==t)return Promise.reject(new Error("platform not found in UserPrefs."));return p.default.pushname=e,p.default.platform=t,__LOG__(2)(Q()),(0,m.initializeWithoutGKs)().then((()=>{var e=Promise.resolve(),t=Promise.resolve();e=(0,F.getTable)().all().then((e=>{I.default.checksum=(0,O.getContactChecksum)()||"",I.default.add(e.map(A.hydrateWids),{silent:!0})})),t=(0,k.getTable)().all().then((e=>{R.default.add(e.map(A.hydrateWids),{silent:!0}),e.forEach((e=>(0,w.updateSubject)((0,P.createWidFromWidLike)(e.id),e.subject)))}));var r=(0,y.getTable)().all().then((e=>{S.default.add(e.map(A.hydrateWids),{silent:!0})}));return Promise.all([e,t,r])})).then((()=>{}))},t.restoreBlocklist=function(){return(0,u.getTable)().all().then((e=>{l.default.initializeFromCache(e.map(A.hydrateWids))}))},t.restoreChatsAndMessages=function(){return ie.apply(this,arguments)},t.restoreLabels=function(){if((0,D.canDisplayLabel)())return(0,G.getTable)().all().then((e=>{N.default.initializeFromCache(e)}));return Promise.resolve()},t.restoreLabelAssociations=function(){if((0,D.canDisplayLabel)())return(0,x.getTable)().all().then((e=>{N.default.initializeAssociationsFromCache(e)}));return Promise.resolve()},t.restoreQuickReplies=function(){if((0,D.canSendQuickReply)())return(0,B.getTable)().all().then((e=>{L.default.initializeFromCache(e)}));return Promise.resolve()},t.restoreCarts=function(){if((0,D.cartPropEnabled)())return(0,U.getTable)().all().then((e=>{M.default.initializeFromCache(e.map(A.hydrateWids))}));return Promise.resolve()};var n=a(r(52954)),i=a(r(70417)),s=a(r(19976)),o=r(71684),u=r(66315),l=a(r(79148)),d=r(35855),c=a(r(43334)),f=a(r(90980)),p=a(r(52737)),h=a(r(50935)),_=r(95595),m=r(24319),g=r(52303),v=a(r(58885)),E=a(r(77865)),y=r(88451),S=a(r(15118));r(7241);var T=r(95197),b=r(22890),A=r(69398),C=r(54128),P=r(75637),O=r(65291),w=r(90401),M=a(r(99601)),I=a(r(7470)),R=a(r(99922)),D=r(75459),N=a(r(23539)),L=a(r(75537)),k=r(96056),U=r(32771),F=r(5254),G=r(71329),x=r(98538),B=r(8656),Y=a(r(72291));function K(){var e=(0,s.default)(["restoreChatsAndMessages: failed with error: ",""]);return K=function(){return e},e}function j(){var e=(0,s.default)(["restore-business-info: invalid wid"]);return j=function(){return e},e}function W(){var e=(0,s.default)(["Unread anchor message is not in message collection."]);return W=function(){return e},e}function V(){var e=(0,s.default)(["processPreviewMessageInChat: restoring "," message."]);return V=function(){return e},e}function H(){var e=(0,s.default)(["restoreMessagesForChat: restoring last "," messages."]);return H=function(){return e},e}function q(){var e=(0,s.default)(["Unread anchor message does not exist in message table"]);return q=function(){return e},e}function z(){var e=(0,s.default)(["unreadMsgAnchorId is not defined"]);return z=function(){return e},e}function J(){var e=(0,s.default)(["restoreChats: restoring chats."]);return J=function(){return e},e}function Q(){var e=(0,s.default)(["[InitFromStorage] important metadata loaded"]);return Q=function(){return e},e}function X(){var e=(0,s.default)(["[InitFromStorage] will attempt to initialize from storage"]);return X=function(){return e},e}function Z(e){return null!=e.t&&(0,o.happenedWithin)((0,o.castToUnixTime)(e.t),o.DAY_SECONDS)||null!=e.pin&&e.pin>0}function $(){return(0,d.getTable)().all().then((e=>Promise.all(e.map((e=>(0,T.getKeyMsgsFromChatHistory)(e).then((({anchor:t,previewMsg:r,lastReceivedKey:a})=>({chat:(0,i.default)((0,i.default)({},e),{},{unreadMsgAnchorId:Z(e)?t:void 0}),anchor:t,previewMsg:r,lastReceivedKey:a})))))))).then((e=>{var t=e.map((({chat:e,anchor:t,previewMsg:r})=>e));return(0,d.getTable)().bulkCreateOrMerge(t).then((()=>e.map((({chat:e,anchor:t,previewMsg:r,lastReceivedKey:a})=>({chat:e,previewMsg:r,lastReceivedKey:a})))))}))}function ee(e){return __LOG__(2)(J()),c.default.add(e.map((({chat:e,previewMsg:t,lastReceivedKey:r})=>{var a=(0,A.hydrateWids)((0,i.default)({},e));return r&&(a.lastReceivedKey=E.default.fromString(r)),a})),{silent:!0}),e}function te(){return re.apply(this,arguments)}function re(){return(re=(0,n.default)((function*(e,t){var r;r=t&&t.internalId?yield(0,T.queryChatMessageHelper)(t.internalId,"".concat(e.id,"_g"),{lowerInclusive:!0}):yield(0,T.queryChatMessageHelper)("".concat(e.id,"_/"),"".concat(e.id,"_g"),{reverse:!0,limit:1}),__LOG__(2)(V(),r.length),v.default.processMultipleMessages((0,P.createWidFromWidLike)(e.id),r.map((e=>{var t=(0,T.hydrateMessage)(e);return t.invis=!0,t})),{pendingMsgsDone:!1,resume:!1,add:"last",isHistory:!0})}))).apply(this,arguments)}function ae(e){switch(e){case"unknown":return h.default.VERIFIED_LEVEL.UNKNOWN;case"low":return h.default.VERIFIED_LEVEL.LOW;case"high":return h.default.VERIFIED_LEVEL.HIGH;default:return h.default.VERIFIED_LEVEL.UNKNOWN}}function ne(e,t){return Z(e)?e.unreadCount>=20?te(e,t).then((()=>function(e){return e.unreadMsgAnchorId?(0,g.getTable)().equals(["id"],e.unreadMsgAnchorId).then((t=>{if(0!==t.length){var r=(0,T.getInChatMsgId)(t[0].internalId||""),a=Math.max(0,r-5);return(0,T.queryChatMessageHelper)((0,T.craftInternalId)(e.id,a),(0,T.craftInternalId)(e.id,r+5),{lowerInclusive:!0,upperInclusive:!1}).then((t=>{if(!(t.length-5<0)){var r=t[t.length-5].id,a=t.map((e=>{var t=(0,T.hydrateMessage)(e);return t.invis=!0,t}));return v.default.processMultipleMessages((0,P.createWidFromWidLike)(e.id),a,{pendingMsgsDone:!0,resume:!1,add:"unread",isHistory:!0,firstUnreadKey:E.default.fromString(r)},new f.default)}})).then()}__LOG__(3)(q())})):(__LOG__(3)(z()),Promise.resolve())}(e))):0===e.unreadCount?te(e,t):(__LOG__(2)(H(),e.unreadCount+5),(0,T.queryChatMessageHelper)("".concat(e.id,"_/"),"".concat(e.id,"_g"),{reverse:!0,limit:e.unreadCount+5}).then((t=>v.default.processMultipleMessages((0,P.createWidFromWidLike)(e.id),t.map(T.hydrateMessage).reverse(),{pendingMsgsDone:!0,resume:!1,add:"last",isHistory:!0}))).then()):te(e)}function ie(){return(ie=(0,n.default)((function*(){return yield Y.default.waitForFinalDbMsgEncKey(),(0,m.initializeWithoutGKs)().then(b.updateUnreadCount).then($).then(ee).then((e=>Promise.all(e.map((({chat:e,previewMsg:t})=>ne(e,t).then((()=>{if(e.unreadMsgAnchorId){var t=E.default.fromString(e.unreadMsgAnchorId),r=v.default.get(t);if(!r)return void __LOG__(3)(W());var a=c.default.get((0,P.createWidFromWidLike)(e.id));a&&(a.unreadMsgAnchor=r)}}))))).then((()=>(0,C.getTable)().all())).then((e=>{e.forEach((e=>{var t;try{t=(0,P.createUserWid)(e.id)}catch(e){return __LOG__(4,void 0,new Error,!0)(j()),void SEND_LOGS("restore-business-info: invalid wid")}var r=c.default.get(t);if(r){var a={isBusiness:!0,isEnterprise:e.isApi,verifiedName:e.name,verifiedLevel:ae(e.level||"unknown"),actualActors:e.actualActors,hostStorage:e.hostStorage,privacyModeTs:e.privacyModeTs};r.contact.set(a),"high"===e.level&&e.name&&!r.contact.name&&r.contact.set({name:e.name})}}))})))).catch((e=>{throw __LOG__(4,void 0,new Error)(K(),e),e}))}))).apply(this,arguments)}},89290:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.pendingMutationsCreateTable=function(){return(0,a.getStorage)().versions.version(0)},t.collectionVersionCreateTable=function(){return(0,a.getStorage)().versions.version(1)},t.syncActionsCreateTable=function(){return(0,a.getStorage)().versions.version(2)},t.contactCreateTable=function(){return(0,a.getStorage)().versions.version(3)},t.blocklistCreateTable=function(){return(0,a.getStorage)().versions.version(4)},t.profilePicThumbCreateTable=function(){return(0,a.getStorage)().versions.version(5)},t.chatCreateTable=function(){return(0,a.getStorage)().versions.version(6)},t.messageCreateTable=function(){return(0,a.getStorage)().versions.version(7)},t.messageInfoCreateTable=function(){return(0,a.getStorage)().versions.version(8)},t.participantCreateTable=function(){return(0,a.getStorage)().versions.version(9)},t.orphanReceiptCreateTable=function(){return(0,a.getStorage)().versions.version(10)},t.deviceListCreateTable=function(){return(0,a.getStorage)().versions.version(11)},t.inactiveReceiptCreateTable=function(){return(0,a.getStorage)().versions.version(12)},t.verifiedBusinessNameCreateTable=function(){return(0,a.getStorage)().versions.version(13)},t.historySyncNotificationsCreateTable=function(){return(0,a.getStorage)().versions.version(14)},t.encryptedMutationsCreateTable=function(){return(0,a.getStorage)().versions.version(15)},t.labelCreateTable=function(){return(0,a.getStorage)().versions.version(16)},t.labelAssociationCreateTable=function(){return(0,a.getStorage)().versions.version(17)},t.quickReplyCreateTable=function(){return(0,a.getStorage)().versions.version(18)},t.abpropsConfigCreateTable=function(){return(0,a.getStorage)().versions.version(19)},t.groupMetadataCreateTable=function(){return(0,a.getStorage)().versions.version(20)},t.syncKeysCreateTable=function(){return(0,a.getStorage)().versions.version(21)},t.tasksScheduledTimeCreateTable=function(){return(0,a.getStorage)().versions.version(22)},t.activeMessageRangesCreateTable=function(){return(0,a.getStorage)().versions.version(23)},t.ftsIndexingQueueCreateTable=function(){return(0,a.getStorage)().versions.version(24)},t.cartCreateTable=function(){return(0,a.getStorage)().versions.version(25)},t.missingKeysCreateTable=function(){return(0,a.getStorage)().versions.version(26)},t.messageAddIsSendFailureProperties=function(){return(0,a.getStorage)().versions.version(27)},t.contactAddIsContactSyncCompleted=function(){return(0,a.getStorage)().versions.version(28)},t.messageAddPaymentTxnStatus=function(){return(0,a.getStorage)().versions.version(29)};var a=r(77993)},62669:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.initialize=function(){null==c&&((0,l.createStorage)(),(0,o.addTable)(),(0,s.addTable)(),(0,u.addTable)(),c=(0,l.getStorage)().initialize().catch((e=>{throw __LOG__(4,!0,new Error,!0)(d()),SEND_LOGS("Failed to initialize offd storage"),e})));return c},t.destroy=function(){return(0,l.destroyStorage)().catch((()=>f.resolve(new i.default(l.DATABASE_NAME).delete()))).finally((()=>{c=null}))};var n=a(r(19976)),i=a(r(77715)),s=r(29634),o=r(25819),u=r(22905),l=r(32350);function d(){var e=(0,n.default)(["Assertion failed!"]);return d=function(){return e},e}var c,f=r(41449).Z},29634:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.addTable=function(){(0,s.getStorage)().add("dangling-receipt").version((0,s.getStorage)().versions.version(1),[new i.default("id"),new n.default("receipts")]).view((e=>({id:e.id,receipts:e.receipts})))},t.getTable=function(){return(0,s.getStorage)().table("dangling-receipt")};var n=a(r(30530)),i=a(r(72948)),s=r(32350)},22905:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.addTable=function(){(0,s.getStorage)().add("peer-read-receipt").version((0,s.getStorage)().versions.version(2),[new i.default("id"),new n.default("msgKeys"),new n.default("ts")]).view((e=>({id:e.id,ts:e.ts,msgKeys:e.msgKeys})))},t.getTable=function(){return(0,s.getStorage)().table("peer-read-receipt")};var n=a(r(30530)),i=a(r(72948)),s=r(32350)},25819:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.addTable=function(){(0,i.getStorage)().add("read-receipt").version((0,i.getStorage)().versions.version(0),[new s.default("id"),new n.default("externalIds")]).delete((0,i.getStorage)().versions.version(3)).view((e=>({id:e.id,externalIds:e.externalIds})))},t.getTable=function(){return(0,i.getStorage)().table("read-receipt")};var n=a(r(30530)),i=r(32350),s=a(r(58642))},32350:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.createStorage=function(){var e=new i.default(o);u=new s.default(e)},t.getStorage=function(){return(0,n.default)(null!=u,"[offd-storage] Storage should be created first before being accessed"),u},t.destroyStorage=function(){if(null==u)return Promise.reject(new Error("[model-storage] Storage should be created first before being destroyed"));return u.purge().then((()=>{u=null})).catch((e=>{throw u=null,e}))},t.DATABASE_NAME=void 0;var n=a(r(47677)),i=a(r(2206)),s=a(r(6957)),o="offd-storage";t.DATABASE_NAME=o;var u=null},22890:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.updateOfflineMsgAcks=function(){return c.apply(this,arguments)},t.updateUnreadCount=function(){return p.apply(this,arguments)};var n=a(r(52954)),i=a(r(18120)),s=r(22905),o=a(r(50935)),u=r(52303),l=a(r(77865)),d=r(35855);function c(){return(c=(0,n.default)((function*(){if(i.default.supportsFeature(i.default.F.MD_BACKEND)){var e=(yield(0,s.getTable)().all()).reduce(((e,t)=>e.concat(t.msgKeys.map((e=>({id:e,ack:o.default.ACK.READ,pendingReadReceipt:null}))))),[]);yield(0,u.getTable)().bulkCreateOrMerge(e)}return Promise.resolve()}))).apply(this,arguments)}function f(){var e=new Map;return(0,s.getTable)().forEach((t=>{t.msgKeys.forEach((t=>{var r=l.default.fromString(t).remote.toString();if(r!==o.default.STATUS_WID){var a=(e.get(r)||0)+1;e.set(r,a)}}))})).then((()=>(0,s.getTable)().clear())).then((()=>e))}function p(){return(p=(0,n.default)((function*(){if(i.default.supportsFeature(i.default.F.MD_BACKEND)){var e=yield f(),t=Array.from(e.keys()),r=(yield(0,d.getTable)().bulkGet(t)).map(((r,a)=>{var n=e.get(t[a])||0,i=r?r.unreadCount:0;return{id:t[a],unreadCount:Math.max(i-n,0)}}));yield(0,d.getTable)().bulkCreateOrMerge(r)}return Promise.resolve()}))).apply(this,arguments)}},66824:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.initialize=function(){null==_&&((0,s.createStorage)(),(0,o.addTable)(),(0,u.addTable)(),(0,l.addTable)(),(0,d.addTable)(),(0,c.addTable)(),(0,f.addTable)(),(0,p.addTable)(),_=(0,s.getStorage)().initialize().catch((e=>{throw __LOG__(4,!0,new Error,!0)(h()),SEND_LOGS("Failed to initialize signal storage"),e})));return _},t.destroy=function(){return(0,s.destroyStorage)().catch((()=>m.resolve(new i.default(s.DATABASE_NAME).delete()))).finally((()=>{_=null}))},Object.defineProperty(t,"getBaseKeyTable",{enumerable:!0,get:function(){return o.getTable}}),Object.defineProperty(t,"getIdentityTable",{enumerable:!0,get:function(){return u.getTable}}),Object.defineProperty(t,"getMetaTable",{enumerable:!0,get:function(){return l.getTable}}),Object.defineProperty(t,"getPreKeyTable",{enumerable:!0,get:function(){return d.getTable}}),Object.defineProperty(t,"getSenderKeyTable",{enumerable:!0,get:function(){return c.getTable}}),Object.defineProperty(t,"getSessionTable",{enumerable:!0,get:function(){return f.getTable}}),Object.defineProperty(t,"getSignedPreKeyTable",{enumerable:!0,get:function(){return p.getTable}});var n=a(r(19976)),i=a(r(77715)),s=r(43097),o=r(68623),u=r(80662),l=r(5196),d=r(57465),c=r(86774),f=r(58156),p=r(27373);function h(){var e=(0,n.default)(["Assertion failed!"]);return h=function(){return e},e}var _,m=r(41449).Z},68623:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.addTable=function(){(0,o.getStorage)().add("baseKey-store").version((0,u.baseKeyCreateTable)(),[new s.default("id"),new n.default("address"),new n.default("originalMsgId"),new n.default("baseKey"),new i.default(["address","originalMsgId"])]).view((e=>({id:e.id,address:e.address,originalMsgId:e.originalMsgId,baseKey:e.baseKey})))},t.getTable=function(){return(0,o.getStorage)().table("baseKey-store")};var n=a(r(30530)),i=a(r(9387)),s=a(r(72948)),o=r(43097),u=r(10971)},80662:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.addTable=function(){(0,i.getStorage)().add("identity-store").version((0,o.identityCreateTable)(),[new s.default("identifier"),new n.default("identityKey")]).view((e=>({identifier:e.identityKey,identityKey:e.identityKey})))},t.getTable=function(){return(0,i.getStorage)().table("identity-store")};var n=a(r(30530)),i=r(43097),s=a(r(58642)),o=r(10971)},5196:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.addTable=function(){(0,i.getStorage)().add("signal-meta-store").version((0,o.metaCreateTable)(),[new s.default("key"),new n.default("value")]).view((e=>({key:e.key,value:e.value})))},t.getTable=function(){return(0,i.getStorage)().table("signal-meta-store")};var n=a(r(30530)),i=r(43097),s=a(r(58642)),o=r(10971)},57465:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.addTable=function(){(0,s.getStorage)().add("prekey-store").version((0,o.preKeyCreateTable)(),[new i.default("keyId"),new n.default("keyPair"),new n.default("isDirectDistribution")]).view((e=>({keyId:e.keyId,keyPair:e.keyPair,isDirectDistribution:e.isDirectDistribution})))},t.getTable=function(){return(0,s.getStorage)().table("prekey-store")};var n=a(r(30530)),i=a(r(72948)),s=r(43097),o=r(10971)},86774:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.addTable=function(){(0,s.getStorage)().add("senderkey-store").version((0,u.senderKeyCreateTable)(),[new o.default("senderKeyName"),new n.default("senderKey"),new n.default("senderId"),new i.default("senderId")]).view((e=>({senderKeyName:e.senderKeyName,senderKey:e.senderKey,senderId:e.senderId})))},t.getTable=function(){return(0,s.getStorage)().table("senderkey-store")};var n=a(r(30530)),i=a(r(90146)),s=r(43097),o=a(r(58642)),u=r(10971)},58156:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.addTable=function(){(0,i.getStorage)().add("session-store").version((0,o.sessionCreateTable)(),[new s.default("address"),new n.default("session")]).view((e=>({address:e.address,session:e.session})))},t.getTable=function(){return(0,i.getStorage)().table("session-store")};var n=a(r(30530)),i=r(43097),s=a(r(58642)),o=r(10971)},27373:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.addTable=function(){(0,s.getStorage)().add("signed-prekey-store").version((0,o.signedPreKeyCreateTable)(),[new i.default("keyId"),new n.default("keyPair"),new n.default("signature")]).view((e=>({keyId:e.keyId,keyPair:e.keyPair,signature:e.signature})))},t.getTable=function(){return(0,s.getStorage)().table("signed-prekey-store")};var n=a(r(30530)),i=a(r(72948)),s=r(43097),o=r(10971)},43097:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.createStorage=function(){var e=new i.default(o);u=new s.default(e)},t.getStorage=function(){return(0,n.default)(null!=u,"[signal-storage] Storage should be created first before being accessed"),u},t.destroyStorage=function(){if(null==u)return Promise.reject(new Error("[signal-storage] Storage should be created first before being destroyed"));return u.purge().then((()=>{u=null})).catch((e=>{throw u=null,e}))},t.DATABASE_NAME=void 0;var n=a(r(47677)),i=a(r(2206)),s=a(r(6957)),o="signal-storage";t.DATABASE_NAME=o;var u=null},10971:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.identityCreateTable=function(){return(0,a.getStorage)().versions.version(0)},t.metaCreateTable=function(){return(0,a.getStorage)().versions.version(1)},t.preKeyCreateTable=function(){return(0,a.getStorage)().versions.version(2)},t.sessionCreateTable=function(){return(0,a.getStorage)().versions.version(3)},t.signedPreKeyCreateTable=function(){return(0,a.getStorage)().versions.version(4)},t.baseKeyCreateTable=function(){return(0,a.getStorage)().versions.version(5)},t.senderKeyCreateTable=function(){return(0,a.getStorage)().versions.version(6)};var a=r(43097)},58447:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return i.apply(this,arguments)};var n=a(r(52954));function i(){return(i=(0,n.default)((function*(){var e=window.caches;if(null!=e){var t=yield e.keys();yield Promise.all(t.map((t=>e.delete(t))))}}))).apply(this,arguments)}},99215:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r={REQUEST_STREAMING_INFO:"GET_STREAMING_INFO",REQUEST_RMR:"REQUEST_RMR",SEND_STREAMING_CHUNK:"SEND_STREAMING_CHUNK",EXP_BACKOFF:"EXP_BACKOFF",LOG:"LOG",UPLOAD_LOGS:"UPLOAD_LOGS",REQUEST_DOCUMENT_DOWNLOAD:"REQUEST_DOCUMENT_DOWNLOAD",SET_L10N:"SET_L10N",STREAMING_SUPPORTED:"STREAMING_SUPPORTED",REMOVE_PP:"REMOVE_PP",LOGOUT:"LOGOUT",CLEAN_ASSETS:"CLEAN_ASSETS",PRELOAD_LAZY_LOADED_BUNDLES:"PRELOAD_LAZY_LOADED_BUNDLES"};t.default=r},30734:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;class r{constructor(e){this.onMessage=e=>{if(e.data&&e.data.action){var t=e.data;if(e.ports&&0!==e.ports.length){var a=e.ports;if(r.isSW()||!window.navigator.serviceWorker||e.source===window.navigator.serviceWorker.controller)("function"==typeof e.waitUntil?t=>e.waitUntil(t):()=>{})(Promise.resolve(this.requestHandler(t)).then((e=>{a[0].postMessage(e)})).catch((e=>{a[0].postMessage({error:e&&e.toString()})})))}}},this.requestHandler=e}init(){var e=r.isSW()?self:window.navigator.serviceWorker;try{if(!e)return;e.addEventListener("message",this.onMessage)}catch(e){}}static isSW(){return"undefined"==typeof window}static getRequestor(e){return r.isSW()?"string"==typeof e?self.clients.get(e):Promise.resolve(e):window.navigator.serviceWorker?window.navigator.serviceWorker.ready.then((()=>window.navigator.serviceWorker?window.navigator.serviceWorker.controller:null)):Promise.resolve(null)}static broadcast(e,t){return r.isSW()?self.clients.matchAll().then((a=>0===a.length?Promise.reject("No clients available."):Promise.all(a.map((a=>r.request(a,e,t)))))):Promise.reject(new Error("Broadcast called from non-serviceworker."))}static request(e,t,a){var n=new MessageChannel;return new Promise(((i,s)=>(n.port1.onmessage=e=>{e.data&&e.data.error?s(e.data.error):i(e.data)},r.getRequestor(e).then((e=>{if(!e)return s("No ServiceWorker controlling this client.");e.postMessage({action:t,message:a,version:"2.2119.6"},[n.port2])})))))}}t.default=r},48393:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859),i=n(r(19976)),s=n(r(99215)),o=n(r(79711)),u=r(63925),l=n(r(15410)),d=n(r(30734)),c=n(r(17026)),f=n(r(58906)),p=a(r(12767));function h(){var e=(0,i.default)(['Unable to add "error" event listener to service worker container, error: ',""]);return h=function(){return e},e}function _(){var e=(0,i.default)(["ServiceWorker container error: ",""]);return _=function(){return e},e}function m(){var e=(0,i.default)(['Unable to add "controllerchange" event listener to service worker container, error: ',""]);return m=function(){return e},e}function g(){var e=(0,i.default)(['Unable to add "error" event listener to service worker, error: ',""]);return g=function(){return e},e}function v(){var e=(0,i.default)(["ServiceWorker controller error: ",""]);return v=function(){return e},e}if(f.default.supported){var E=function(){try{var e=navigator.serviceWorker;e&&e.controller&&e.controller.addEventListener("error",(e=>{p.default.state!==p.STATE.UNLAUNCHED&&__LOG__(3)(v(),e.error)}))}catch(e){__LOG__(3)(g(),e)}};try{var y=navigator.serviceWorker;y&&y.addEventListener("controllerchange",(()=>{E(),p.default.state===p.STATE.UNLAUNCHED&&(c.default.needsUpdate=!0)}))}catch(e){__LOG__(3)(m(),e)}try{var S=navigator.serviceWorker;S&&S.addEventListener("error",(e=>{p.default.state!==p.STATE.UNLAUNCHED&&__LOG__(3)(_(),e.error)}))}catch(e){__LOG__(3)(h(),e)}E();var T=function(e,t){e.buffer.forEach((e=>{var r,a=null!==(r=e.message[0])&&void 0!==r?r:"",n="ServiceWorker (".concat(t,"): ").concat(a),i=function(e){switch(e){case"info":return 1;case"log":return 2;case"warn":return 3;case"error":return 4}throw new Error("Invalid level: ".concat(e))}(e.level.match(/^(.*?)(?:Verbose)?$/i)[1]);l.default.logImpl(i,n,e.error,e.attachedToSendLogs,e.extraTags)}))};new d.default((({action:e,message:t,version:a})=>{switch(e){case s.default.REQUEST_STREAMING_INFO:case s.default.EXP_BACKOFF:case s.default.REQUEST_RMR:case s.default.SEND_STREAMING_CHUNK:return(0,u.requireHandleVideoStreamingRequest)().then((r=>r({action:e,message:t})));case s.default.LOG:if(p.default.state===p.STATE.UNLAUNCHED)return;return t&&T(t,a),{test:!0};case s.default.UPLOAD_LOGS:return t&&T(t,a),r(3594).upload({reason:"Requested by Service Worker"}).then((()=>{}));default:return Promise.reject("Invalid Action: ".concat(e))}})).init(),o.default.on("logout",(()=>{var e=navigator.serviceWorker;e&&e.controller&&d.default.request(e.controller,s.default.LOGOUT).catch((()=>{}))}))}},84159:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default=class{open(){return this._openPromise?this._openPromise:this._closePromise?(this._openPromise=this._closePromise.catch((e=>{throw this._openPromise=null,e})).then((()=>(this._openPromise=null,this.open()))),this._openPromise):(this._openPromise=this.doOpen().catch((e=>{throw this._openPromise=null,e})).then((()=>{this._openPromise=null})),this._openPromise)}close(){return this._closePromise?this._closePromise:this._openPromise?(this._closePromise=this._openPromise.catch((e=>{throw this._closePromise=null,e})).then((()=>(this._closePromise=null,this.close()))),this._closePromise):(this._closePromise=this.doClose().catch((e=>{throw this._closePromise=null,e})).then((()=>{this._closePromise=null})),this._closePromise)}doOpen(){throw new Error("Not implemented")}doClose(){throw new Error("Not implemented")}}},76968:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(84159));class i extends n.default{get(e){return this.open().then((()=>this.doGet(e)))}queryByIndex(e,t){return this.open().then((()=>this.doQueryByIndex(e,t)))}getAll(){return this.open().then((()=>this.doGetAll()))}put(e,t){return this.open().then((()=>this.doPut(e,t)))}del(e){return this.open().then((()=>this.doDel(e)))}count(){return this.open().then((()=>this.doCount()))}clear(){return this.open().then((()=>this.doClear()))}doGet(){throw new Error("Not implemented")}doQueryByIndex(){throw new Error("Not implemented")}doGetAll(){throw new Error("Not implemented")}doPut(){throw new Error("Not implemented")}doDel(){throw new Error("Not implemented")}doCount(){throw new Error("Not implemented")}doClear(){throw new Error("Not implemented")}doOpen(){throw new Error("Not implemented")}doClose(){throw new Error("Not implemented")}}t.default=i},58906:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(99215)),i=a(r(28267)),s=a(r(30734)),o=a(r(77626)),u="Modernizr"in window;class l extends i.default{constructor(){super(),this.supported=u?Modernizr.serviceworker:"serviceWorker"in navigator,this._checkAlive=()=>{var e=navigator.serviceWorker&&navigator.serviceWorker.controller;return Boolean(e)},this._checkStreamingSupport=()=>{if(this.supported&&this.alive&&!o.default.isSafari){if(this._streamingSupportedPromise)return this._streamingSupported;var e=navigator.serviceWorker&&navigator.serviceWorker.controller;e&&(this._streamingSupportedPromise=s.default.request(e,n.default.STREAMING_SUPPORTED).timeout(100).catch((()=>!1)).then((e=>(delete this._streamingSupportedPromise,this.streamingSupported=e,e))))}else this._streamingSupported=!1},this._setSupported=e=>{this.supported=e},u&&Modernizr.on("serviceworker",this._setSupported);var e=this;Object.defineProperty(this,"streamingSupported",{get:()=>(e._checkStreamingSupport(),e._streamingSupported),set(t){t!==e._streamingSupported&&e.trigger("change:streamingSupported",t),e._streamingSupported=t}}),Object.defineProperty(this,"alive",{get:()=>e._checkAlive()})}}var d=new l;t.default=d},32960:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r={key(e){}};t.default=r},85820:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ABPropConfigs=void 0;t.ABPropConfigs={groups_dogfooding_ui:[308,"bool",!1],md_icdc_enabled:[309,"bool",!1],md_icdc_hash_length:[310,"int",10],played_self_enabled:[361,"bool",!1],ephemeral_24h_duration:[407,"bool",!1],ephemeral_allow_group_members:[432,"bool",!1],business_profile_refresh_m1_enabled:[470,"bool",!1],web_test_bool2:[220,"bool",!1],web_test_int2:[221,"int",0],web_test_float2:[222,"float",0],web_test_string2:[223,"string","test_string_value"],test_web_biz_profile_options:[285,"int",3],test_web_ctwa_context_compose_enabled:[286,"int",1],test_web_gif_search:[287,"string","giphy"],test_web_list_message:[288,"int",1],test_web_voip_internal_tester:[289,"int",1],test_web_ctwa_context_compose_enabled_2:[298,"bool",!0],test_web_list_message_2:[299,"bool",!0],test_web_voip_internal_tester_2:[300,"bool",!0],should_deregister_on_syncd_fatal:[383,"bool",!0],stop_abprops_traffic_in_serverprops_response:[315,"bool",!1],enable_biz_activity_report_request:[455,"bool",!1],plm_products_max_batch_fetch_size:[464,"int",18]}},15971:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.updateAttributesLocalStorage=function(e,t,r,a){var l,d,c=null;null!=r&&((c=r)<600?c=600:c>o&&(c=o));var f=u()||{},p={abKey:null!=e?e:f.abKey,hash:null!=t?t:f.hash,refresh:null!==(l=null===(d=c)||void 0===d?void 0:d.toString())&&void 0!==l?l:f.refresh,lastSyncTime:a};(0,s.default)(n.default,"localStorage").setItem(i.default.KEY_ABPROPS,JSON.stringify(p))},t.isABPropsAfterFirstSync=function(){return null!=u()},t.getABKey=function(){var e=u();return null==e?void 0:e.abKey},t.getHash=function(){var e=u();return null==e?void 0:e.hash},t.getLastSyncTime=function(){var e=u(),t=null==e?void 0:e.lastSyncTime;if(null==t)return null;return parseInt(t,10)},t.getRefresh=function(){var e,t=u();return parseInt(null!==(e=null==t?void 0:t.refresh)&&void 0!==e?e:86400,10)};var n=a(r(80521)),i=a(r(68859)),s=a(r(61941)),o=604800;function u(){var e=(0,s.default)(n.default,"localStorage").getItem(i.default.KEY_ABPROPS);return null==e?null:JSON.parse(e)}},97148:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.clearABPropConfigs=function(){return m()},t.getAllABPropConfigs=function(){return E()},t.getABPropConfigValue=function(e){var t;u.default.supportsFeature(u.default.F.MD_BACKEND)||(__LOG__(4,!0,new Error,!0)(c(),e),SEND_LOGS("[ABProps] getABPropConfigValue() should not be called by non-MD build, config name: ".concat(e)));var r=o.ABPropConfigs[e],[a,,n]=r;return null!==(t=v(a))&&void 0!==t?t:n},t.updateABPropsFromStorage=function(){return y.apply(this,arguments)};var n=a(r(52954)),i=a(r(19976)),s=r(8018),o=r(85820),u=a(r(18120));function l(){var e=(0,i.default)(["[ABProps] Failed to update ABProps configs cache from storage"]);return l=function(){return e},e}function d(){var e=(0,i.default)(["[ABProps] Should not store an ABProp (code: ",") that is unavailable for this client version"]);return d=function(){return e},e}function c(){var e=(0,i.default)(["[ABProps] getABPropConfigValue() should not be called by non-MD build, config name: ",""]);return c=function(){return e},e}function f(){var e=(0,i.default)(["[ABProps] configs need to be initialized before its first access, config code: ",""]);return f=function(){return e},e}var p=new Map,h=!1,_={};Object.keys(o.ABPropConfigs).forEach((e=>{var[t]=o.ABPropConfigs[e];_[t]=e}));var m=()=>{p.clear(),h=!1},g=function(e){e.forEach((e=>{p.set(e.configCode,e)})),h=!0},v=function(e){var t;return h?null===(t=p.get(e))||void 0===t?void 0:t.configValue:(__LOG__(4,!0,new Error,!0)(f(),e),SEND_LOGS("[ABProps] configs need to be initialized before its first access, config code: ".concat(e)),null)},E=function(){return Array.from(p.values())};function y(){return(y=(0,n.default)((function*(){try{var e=(yield(0,s.getABPropConfigs)()).map((e=>{var t=_[e.configCode];if(null!=t){var r=o.ABPropConfigs[t],[a,n,i]=r;return{configCode:a,configValue:(0,s.parseConfigValue)(e.configValue,n,i),configExpoKey:null}}__LOG__(4,!0,new Error,!0)(d(),e.configCode),SEND_LOGS("[ABProps] Should not store an ABProp (code: ".concat(e.configCode,") that is unavailable for this client version"))}));g(e)}catch(e){__LOG__(4,!0,new Error,!0)(l()),SEND_LOGS("[ABProps] Failed to update ABProps configs cache from storage: "+e)}}))).apply(this,arguments)}},25337:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(r(19976)),s=n(r(74930)),o=a(r(19899)),u=a(r(42743));function l(){var e=(0,i.default)(["Alarm:setTimeout:Cannot set alarm in the past."]);return l=function(){return e},e}var d=Math.pow(2,31)-1;var c=new class{constructor(){this._alarms=new Map;var e=()=>{this._alarms.size>0&&this._validateTimeouts()};u.default.on(u.JS_HALT_EVENT,e),u.default.on(u.CLOCK_CHANGE_BACKWARDS_EVENT,e),o.default.on(o.SKEW_CHANGE_EVENT,this._resetGlobalTimeouts.bind(this))}setLocalTimeout(e,t,r){return this._setTimeout(!1,e,t,r)}setGlobalTimeout(e,t,r){return this._setTimeout(!0,e,t,r)}clearTimeout(e){if(e){var t=this._alarms.get(e);t&&(window.clearTimeout(t.timeoutId),this._alarms.delete(e))}}_setTimeout(e,t,r,a){a&&this.clearTimeout(a);var n=a||(0,s.default)("alarm_timer_"),i=r-this._getTimeInMS(e),o=Math.min(i,d);if(i<0)return __LOG__(2)(l()),t(),n;var c=window.setTimeout((()=>{r-this._getTimeInMS(e)<u.DEFAULT_THRESHOLD?(this._alarms.delete(n),t()):this._setTimeout(e,t,r,n)}),o);return this._alarms.set(n,{isGlobal:e,fn:t,expiration:r,timeoutId:c}),n}_validateTimeouts(){new Map(this._alarms).forEach(((e,t)=>{var{isGlobal:r,fn:a,expiration:n}=e;n<this._getTimeInMS(r)?(this.clearTimeout(t),a()):this._setTimeout(r,a,n,t)}))}_resetGlobalTimeouts(){new Map(this._alarms).forEach(((e,t)=>{var{isGlobal:r,fn:a,expiration:n}=e;r&&this._setTimeout(r,a,n,t)}))}_getTimeInMS(e=!1){return 1e3*(e?o.default.globalUnixTime():o.default.localUnixTime())}};t.default=c},40603:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.URL=void 0;t.URL="https://web.whatsapp.com/"},25675:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isWAURL=function(e){return r.test(e)},t.APICmd=void 0;t.APICmd={GROUP_INVITE:"GROUP_INVITE",MSG_SEND:"MSG_SEND",INVALID:"INVALID",CATALOG:"CATALOG",PRODUCT:"PRODUCT"};var r=/^whatsapp:\/\/.*/i},27985:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.parseConversionData=v,t.parseAPICmd=function(e){if("string"!=typeof e)return{resultType:u.APICmd.INVALID,data:void 0};var t=(e=>{var t=e.match(p);if(t)return{code:t[2],url:t[1]||"/"};if(t=e.match(h))return{code:t[1]};if(t=e.match(_))return{code:t[1]};if(t=e.match(m))return{code:t[1]}})(e);if(t)return{resultType:u.APICmd.GROUP_INVITE,data:t};var r=function(e){var t=e.match(O)||e.match(w);if(t)return I(t);if(t=e.match(M))return(0,i.default)((0,i.default)({},I(t)),{},{url:"/"})}(e);if(r)return{resultType:u.APICmd.CATALOG,data:r};var a=function(e){var t=e.match(A)||e.match(C);if(t)return R(t);if(t=e.match(P))return(0,i.default)((0,i.default)({},R(t)),{},{url:"/"})}(e);if(a)return{resultType:u.APICmd.PRODUCT,data:a};var n=(e=>{var t=e.match(y);if(t){var r=E(t[2]);if(r)return r.url=t[1]||"/",r}if(t=e.match(S))return E(t[1]);if(t=e.match(T))return E(t[1]);if(t=e.match(b)){var a;if(t[1]&&(a={phone:"".concat(t[1],"@c.us")}),t[2]){var n=E(t[2]);n&&(a=(0,i.default)((0,i.default)({},a),n))}return a}})(e);if(n)return{resultType:u.APICmd.MSG_SEND,data:n};return{resultType:u.APICmd.INVALID,data:void 0}};var n,i=a(r(70417)),s=r(46378),o=r(40603),u=r(25675),l=a(r(99340)),d=(n=o.URL,n.replace(/\/+$/,"")).replace(/[\/\.]/g,"\\$&"),c="((?:/\\w+)*)",f="(?:(?:/\\w+)*)",p=new RegExp("^".concat(d).concat(c,"/accept/?\\?code=(\\w+)$"),"i"),h=/^https?:\/\/chat\.whatsapp\.com\/invite\/(\w+)$/i,_=/^https?:\/\/chat\.whatsapp\.com\/(\w+)$/i,m=/^whatsapp:\/\/chat\/?\?code=(\w+)$/i,g={text:"text",phone:"phone",data:"data",source:"source",context:"context",icebreaker:"icebreaker",source_url:"source_url"};function v(e){if(e&&"string"==typeof e){var t=s.Binary.build(e);if(!(t.size()>512))return t.readBuffer()}}function E(e){var t={};if(new l.default(e).forEach(((e,r)=>{var a=r.toLowerCase();if(a===g.data){var n=v(e);if(!n)return;t.conversionTuple||(t.conversionTuple={}),t.conversionTuple.conversionData=n}else if(a===g.source){var i=e;if((0,s.numUtf8Bytes)(i)>32)return;t.conversionTuple||(t.conversionTuple={}),t.conversionTuple.conversionSource=i}else a===g.source_url?(t.ctwaContextLinkData=t.ctwaContextLinkData||{},t.ctwaContextLinkData.sourceUrl=e):a===g.context?(t.ctwaContextLinkData=t.ctwaContextLinkData||{},t.ctwaContextLinkData.context=e):a===g.icebreaker?(t.ctwaContextLinkData=t.ctwaContextLinkData||{},t.ctwaContextLinkData.icebreaker=e):g[a]&&(t[a]=e)})),t.phone&&(t.phone=t.phone.replace(/\D/g,"")+"@c.us",t.ctwaContextLinkData&&(t.ctwaContextLinkData.phone=t.phone)),t.phone||t.text)return t}var y=new RegExp("^".concat(d).concat(c,"/send/?\\?(.+)$"),"i"),S=/^https?:\/\/api\.whatsapp\.com\/send\/?\?(.+)$/i,T=/^whatsapp:\/\/send\/?\?(.*)$/i,b=/^https?:\/\/wa\.me\/?([0-9]{0,20})?\/?\??(.+)?$/i,A=/^https?:\/\/wa\.me\/p\/([0-9]{0,20})\/([0-9]{0,20})$/i,C=/^whatsapp:\/\/product\/([0-9]{0,20})\/([0-9]{0,20})$/i,P=new RegExp("^".concat(d).concat(f,"/product/([0-9]{0,20})/([0-9]{0,20})$"),"i"),O=/^https?:\/\/wa\.me\/c\/([0-9]{0,20})$/i,w=/^whatsapp:\/\/catalog\/([0-9]{0,20})$/i,M=new RegExp("^".concat(d).concat(f,"/catalog/([0-9]{0,20})$"),"i");function I(e){return{catalogOwnerJid:"".concat(e[1],"@s.whatsapp.net")}}function R(e){return{productId:e[1],businessOwnerJid:"".concat(e[2],"@s.whatsapp.net")}}},18310:(e,t,r)=>{"use strict";var a=r(14859);t.Z=void 0;var n=a(r(19976)),i=a(r(25337)),s=r(95595),o=a(r(28520)),u=a(r(12767));function l(){var e=(0,n.default)(["app:_pingForOtherLocalSession mutex timeout"]);return l=function(){return e},e}function d(){var e=(0,n.default)(["app:_pingForOtherLocalSession stale mutex"]);return d=function(){return e},e}function c(){var e=(0,n.default)(["app:takeoverLocal timeout"]);return c=function(){return e},e}var f=r(51701).default,p=6e5,h="init",_="ping",m="pong",g="local-takeover";var v=new class{init(e=0){var t=e+1;if(t>3)return Promise.resolve(!0);var r=(0,s.getNoTakeover)();return(0,s.setNoTakeover)(),u.default.preload(),this._pingForOtherLocalSession().then((e=>e?(this._updateMutex(),(0,o.default)(!r).then((()=>!1))):!!r||Promise.reject(t)))}takeoverLocal(e){return(0,s.getMutex)()?((0,s.setMutex)(g),f(window,"storage",s.takeoverFilter).timeout(3e4,"takeoverLocalTimeout").then((t=>{var r=(0,s.parseTakeover)(t.newValue);return(0,s.getRememberMe)()||(0,s._setAllKeyValues)(r),u.default.mustExitLoop=!1,(0,s.removeMutex)(),this.init(e)})).catchType(Promise.TimeoutError,(()=>(__LOG__(3)(c()),u.default.mustExitLoop=!1,(0,s.removeMutex)(),this.init(e))))):this.init(e)}unloadMutex(){var e=(0,s.getMutex)();e&&this._ourMutex&&e.includes(this._ourMutex)&&(0,s.removeMutex)()}storagePong(e){if((0,s.mutexFilter)(e)){var t=(0,s.parseMutex)(e.newValue);if(t)return t===g?(this._clearMutexTimer(),u.default.exitLoop(),(0,s.localTakeoverSuccess)(),!0):void(0===t.indexOf(_)&&(0,s.setMutex)(m+Math.random()))}}_clearMutexTimer(){this._updateMutexTimerID&&i.default.clearTimeout(this._updateMutexTimerID)}_updateMutex(){this._clearMutexTimer();var e=Date.now();(0,s.setMutex)(this._ourMutex=h+"_"+e),this._updateMutexTimerID=i.default.setLocalTimeout(this._updateMutex.bind(this),e+p)}_pingForOtherLocalSession(){var e=(0,s.getMutex)();if(e){var t=1e4;if((e+="").indexOf("_")>0){var r=e.split("."),a=parseInt(r[r.length-1],10);if(Number.isFinite(a))a<Date.now()-9e5&&(__LOG__(2)(d()),t=1e3)}var n=f(window,"storage",s.mutexFilter).timeout(t,"waitForOtherLocalSessionTimeout").then((()=>!1)).catchType(Promise.TimeoutError,(function(){return __LOG__(3)(l()),!0}));return(0,s.setMutex)(_+Math.random()),n}return Promise.resolve(!0)}};t.Z=v},96046:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.shouldUnarchiveChat=function(e){if((0,n.archiveV2Supported)()){if(s.default.showArchiveV2)return!1;if(!s.default.archive.enabled&&!e)return(0,i.setArchiveEnabledSetting)(!0),!1}return!0},t.shouldEnableArchiveV2=function(){var e=r(43334).default.filter((e=>e.archive));return(0,n.archiveV2Supported)()&&!s.default.archive.enabled&&1===e.length};var n=r(75459),i=r(92816),s=a(r(2734))},50846:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(...e){var t=e.reduce(((e,t)=>e+t.byteLength),0),r=new Uint8Array(t),a=0;return e.forEach((e=>{r.set(new Uint8Array(e),a),a+=e.byteLength})),r.buffer}},38307:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(e.byteLength!==t.byteLength)return!1;for(var r=new DataView(e),a=new DataView(t),n=0;n<r.byteLength;n++)if(r.getUint8(n)!==a.getUint8(n))return!1;return!0}},60248:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.arrayMove=t.arrayMoveMutate=void 0;var r=function(e,t,r){var a=r<0?e.length+r:r,n=e.splice(t,1)[0];e.splice(a,0,n)};t.arrayMoveMutate=r;t.arrayMove=function(e,t,a){var n=e.slice();return r(n,t,a),n}},68340:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return t>e.length-1?0:t<0?e.length-1:t}},51198:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){for(var r=[],a=e.length,n=t.length,i=Math.max(a,n),s=0;s<i;s++)s<a&&r.push(e[s]),s<n&&r.push(t[s]);return r}},51107:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;return e.every(((e,r)=>e===t[r]))}},42577:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r={equal:(e,t)=>{if(e!==t)throw new Error("".concat(String(e)," !== ").concat(String(t)))}};t.default=r},76862:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.asyncSleepAfterGivenLoopIteration=function(){return i.apply(this,arguments)};var n=a(r(52954));function i(){return(i=(0,n.default)((function*(e,t=200,r=200){e%t==0&&(yield new Promise((e=>setTimeout(e,r))))}))).apply(this,arguments)}},2505:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.b64Equal=function(e,t){var r=e.length,a=t.length;switch(r-a){case-2:return 61===t.charCodeAt(r)&&61===t.charCodeAt(r+1)&&t.substr(0,r)===e;case-1:return 61===t.charCodeAt(r)&&t.substr(0,r)===e;case 0:return e===t;case 1:return 61===e.charCodeAt(a)&&e.substr(0,a)===t;case 2:return 61===e.charCodeAt(a)&&61===e.charCodeAt(a+1)&&e.substr(0,a)===t;default:return!1}}},91612:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){for(var r=atob(e),a=0,n=0;n<r.length;n++){var i=r.charCodeAt(n);a=(((a=((a<<4)+(i>>4))%t)<<4)+(15&i))%t}return a}},82626:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){if(!e)return null;var t=e.replace(/\s+$/,"");e!==t&&Math.random()<.001&&(__LOG__(3,void 0,void 0,!0)(i()),SEND_LOGS("media-key-sanitize"));return t};var n=a(r(19976));function i(){var e=(0,n.default)(["base64 sanitized due to extra whitespace"]);return i=function(){return e},e}},76796:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return e.replace(/\//g,"_").replace(/\+/g,"-")}},54225:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.CLOCK_CHANGE_BACKWARDS_EVENT=t.JS_HALT_EVENT=void 0;var n=a(r(19976)),i=a(r(28267));function s(){var e=(0,n.default)(["JsHaltDetector:detection stopped"]);return s=function(){return e},e}function o(){var e=(0,n.default)(["JsHaltDetector:detection started"]);return o=function(){return e},e}var u="js_halt";t.JS_HALT_EVENT=u;var l="clock_change_backwards";t.CLOCK_CHANGE_BACKWARDS_EVENT=l;class d extends i.default{constructor(e,t){super(),this._interval=e,this._threshold=t}startDetection(){if(!this._intervalId){var e=Date.now();this._intervalId=setInterval((()=>{var t=Date.now(),r=t-e-this._interval;r>this._threshold?this.trigger(u,r):r<-this._threshold&&this.trigger(l,r),e=t}),this._interval),__LOG__(2)(o())}}stopDetection(){this._intervalId&&(clearInterval(this._intervalId),this._intervalId=null,__LOG__(2)(s()))}}t.default=d},3169:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default=class{constructor(e){if(e<=0)throw new RangeError("BitArray:numBits should be positive");this._numBits=e,this._array=new Uint8Array(Math.ceil(this._numBits/8))}get(e){var[t,r]=this._getArrayIndexOffset(e);return Boolean(this._array[t]>>r&1)}set(e){var[t,r]=this._getArrayIndexOffset(e);this._array[t]|=1<<r}unset(e){var[t,r]=this._getArrayIndexOffset(e);this._array[t]&=~(1<<r)}toggle(e){var[t,r]=this._getArrayIndexOffset(e);this._array[t]^=1<<r}clear(){this._array=new Uint8Array(Math.ceil(this._numBits/8))}toArray(){for(var e=[],t=0;t<this._numBits;t++)e.push(this.get(t));return e}toString(){return this.toArray().map((e=>e?"1":"0")).join("")}get length(){return this._numBits}_getArrayIndexOffset(e){if(e<0||e>=this._numBits)throw new RangeError("BitArray:index out of bounds");var t=Math.floor(e/8);return[t,e-8*t]}}},98962:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BIZ_SYSTEM_MSG_SUBTYPES=void 0;t.BIZ_SYSTEM_MSG_SUBTYPES=["blue_msg_e2e_identity_unavailable","blue_msg_bsp_fb_to_bsp_premise","blue_msg_bsp_fb_to_self_fb","blue_msg_bsp_fb_to_self_premise","blue_msg_bsp_fb_unverified","blue_msg_bsp_fb_unverified_to_bsp_premise_verified","blue_msg_bsp_fb_unverified_to_self_fb_verified","blue_msg_bsp_fb_unverified_to_self_premise_verified","blue_msg_bsp_fb_verified","blue_msg_bsp_fb_verified_to_bsp_premise_unverified","blue_msg_bsp_fb_verified_to_self_fb_unverified","blue_msg_bsp_fb_verified_to_self_premise_unverified","blue_msg_bsp_premise_to_self_premise","blue_msg_bsp_premise_unverified","blue_msg_bsp_premise_unverified_to_self_premise_verified","blue_msg_bsp_premise_verified","blue_msg_bsp_premise_verified_to_self_premise_unverified","blue_msg_consumer_to_bsp_fb_unverified","blue_msg_consumer_to_bsp_premise_unverified","blue_msg_consumer_to_self_fb_unverified","blue_msg_consumer_to_self_premise_unverified","blue_msg_self_fb_to_bsp_premise","blue_msg_self_fb_to_self_premise","blue_msg_self_fb_unverified","blue_msg_self_fb_unverified_to_bsp_premise_verified","blue_msg_self_fb_unverified_to_self_premise_verified","blue_msg_self_fb_verified","blue_msg_self_fb_verified_to_bsp_premise_unverified","blue_msg_self_fb_verified_to_self_premise_unverified","blue_msg_self_premise_to_bsp_premise","blue_msg_self_premise_unverified","blue_msg_self_premise_verified","blue_msg_to_bsp_fb","blue_msg_to_consumer","blue_msg_to_self_fb","blue_msg_unverified_to_bsp_fb_verified","blue_msg_unverified_to_bsp_premise_verified","blue_msg_unverified_to_self_fb_verified","blue_msg_unverified_to_verified","blue_msg_verified_to_bsp_fb_unverified","blue_msg_verified_to_bsp_premise_unverified","blue_msg_verified_to_self_fb_unverified","blue_msg_verified_to_unverified"]},57529:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(52954)),i=a(r(19976)),s=a(r(70417)),o=r(30868),u=a(r(79711)),l=r(91460),d=r(63487),c=r(71432),f=r(39174),p=r(57869),h=r(27485),_=r(61392),m=a(r(12767)),g=r(38815),v=r(47882),E=a(r(40210)),y=a(r(29891)),S=r(71684),T=r(52718),b=r(31908),A=r(23398),C=a(r(82657)),P=a(r(61867));function O(){var e=(0,i.default)(["[History sync] _progressiveHistorySyncRun failed with ",", stack: ",""]);return O=function(){return e},e}function w(){var e=(0,i.default)(["[history sync] processLoop picked up chunk"]);return w=function(){return e},e}function M(){var e=(0,i.default)(["[history sync] Skip processLoop, until initial sync is complete"]);return M=function(){return e},e}function I(){var e=(0,i.default)(["[history sync] continueProgressiveHistorySyncProcessing"]);return I=function(){return e},e}function R(){var e=(0,i.default)(["[bootstrap] need to sync critical data: false"]);return R=function(){return e},e}function D(){var e=(0,i.default)(["failed to sync privacy settings"]);return D=function(){return e},e}function N(){var e=(0,i.default)(["[bootstrap] ",""]);return N=function(){return e},e}function L(){var e=(0,i.default)(["[bootstrap] need to sync critical data: true"]);return L=function(){return e},e}function k(){var e=(0,i.default)(["Sync device failed"]);return k=function(){return e},e}function U(){var e=(0,i.default)(["[contact sync] sync "," contacts for device info during the initial sync"]);return U=function(){return e},e}function F(){var e=(0,i.default)(["[contact sync] syncMostRecentDevices has no contact to sync during bootstrap"]);return F=function(){return e},e}function G(){var e=(0,i.default)(["[contact sync] inital contact sync completes"]);return G=function(){return e},e}function x(){var e=(0,i.default)(["[contact sync] start contact sync for "," chunks of contacts during the inital sync"]);return x=function(){return e},e}function B(){var e=(0,i.default)(["[bootstrap] critical sync done"]);return B=function(){return e},e}function Y(){var e=(0,i.default)(["[bootstrap] completed sync for ",""]);return Y=function(){return e},e}var K=r(28103).Mirrored(["NotStarted","InProcess","Completed"]),j={initialChatHistory:!1,readReceipts:!1,syncdCritical:!1},W={initialChatHistoryTotalMsg:-1,initialChatHistoryTotalChats:-1};var V=new class{constructor(){this._criticalState={},this._debugOnlyState={},this._progressiveHistorySyncRemainingIteration=5,this._progressiveHistorySyncInFlight=!1,this._allCriticalDataSynced=!1,this.initState()}initState(){this._criticalState=(0,s.default)({},j),this._debugOnlyState=(0,s.default)({},W),this._syncDCritcalDataState=K.NotStarted}_isCriticalSyncDoneThisSession(){for(var e in this._criticalState)if(!this._criticalState[e])return!1;return!0}_setSynced(e){__LOG__(2)(Y(),e),this._criticalState[e]=!0,this._isCriticalSyncDoneThisSession()&&(__LOG__(2)(B()),(0,f.setAllCriticalDataSynced)(),u.default.criticalSyncDone(),this.syncNonCriticalData())}_syncContactsInChunks(e,t){return(0,n.default)((function*(){__LOG__(2)(x(),e?t.length+1:0),null!=e&&(yield(0,g.syncContactList)(Array.from(e),!1));for(var r=0;r<t.length;r++){var a=Array.from(t[r]);yield(0,l.delayMs)(2e4),yield(0,g.syncContactList)(a)}__LOG__(2)(G())}))()}_syncDeviceList(e){if(null==e)return __LOG__(2)(F()),Promise.resolve();__LOG__(2)(U(),e.size);var t=Array.from(e);return(0,v.syncDeviceList)(t).catch((e=>{__LOG__(4,!0,new Error,!0)(k()),SEND_LOGS("Sync device failed: "+e)}))}setReadReceiptsSynced(){this._setSynced("readReceipts")}setInitialChatHistorySynced(){this._setSynced("initialChatHistory")}setSyncDCriticalSynced(){this._criticalState.syncdCritical||this._setSynced("syncdCritical")}syncNonCriticalData(){var e=[];(0,h.queryAndUpdateAllGroupMetadata)().then((()=>{e=(0,p.getAllContactsFromChatCollectionIntoChunks)(),this._syncDeviceList(e[0]),(0,p.getAndUpdateNonAddressBookContacts)()})).then((()=>{setTimeout(function(){this._syncContactsInChunks(e[0],e.slice(1,e.length))}.bind(this),4e4)})),(0,c.getAndUpdateStatus)(),(0,o.getAndUpdateProfilePicture)(),(0,o.updateBlocklist)(),(0,_.markCollectionsForSync)([d.CollectionName.Regular,d.CollectionName.RegularLow,d.CollectionName.RegularHigh]).then((0,n.default)((function*(){new E.default.MdBootstrapDataApplied({mdBootstrapPayloadType:E.default.MD_BOOTSTRAP_PAYLOAD_TYPE.NON_CRITICAL,mdBootstrapSource:E.default.MD_BOOTSTRAP_SOURCE.APP_STATE,mdSessionId:yield y.default.getMdSessionId(),mdTimestamp:(0,S.unixTimeMs)()}).commit()})))}markInitialHistorySyncCountDebugStats(e,t){this._debugOnlyState={initialChatHistoryTotalMsg:e,initialChatHistoryTotalChats:t}}isSyncDCriticalDataSyncInProcess(){return this._syncDCritcalDataState===K.InProcess}setSyncDCriticalDataSyncCompleted(){this._syncDCritcalDataState=K.Completed}getCriticialSyncDebugSummary(){return(0,f.getAllCriticalDataSynced)()?"-------\nAll critical data synced\n-------\n\n":"-------\n Initial history sync complete: ".concat((0,f.getHistorySyncStatus)()?"true":this._criticalState.initialChatHistory.toString(),"\n Initial msgs: ").concat(this._debugOnlyState.initialChatHistoryTotalMsg,", initial chats: ").concat(this._debugOnlyState.initialChatHistoryTotalChats,"\n Receipt sync complete: ").concat(this._criticalState.readReceipts.toString()," \n ")+"Critical collection sync complete: ".concat(this._criticalState.syncdCritical.toString()," \n-------\n")}syncCriticalDataIfNeeded(){var e=this;return(0,n.default)((function*(){if(e._allCriticalDataSynced=(0,f.getAllCriticalDataSynced)(),e._allCriticalDataSynced)__LOG__(2)(R());else{__LOG__(2)(L()),__LOG__(2)(N(),e.getCriticialSyncDebugSummary());var t=(0,o.updatePrivacySettings)().then((()=>{e.setReadReceiptsSynced()})).catch((()=>{__LOG__(4,!0,new Error,!0)(D()),SEND_LOGS("failed to update privacy settings from privacy request to webd"),m.default.logout()}));(0,A.updateSyncdDisabledDueToFatalFlag)(!1),e._syncDCritcalDataState=K.InProcess;var r=(0,_.markCollectionsForSync)([d.CollectionName.CriticalBlock,d.CollectionName.CriticalUnblockLow]).then((0,n.default)((function*(){if(!e._criticalState.syncdCritical){var t=yield C.default.getSyncActionsRows(["action"],[d.Actions.SettingPushName]);t.length>0&&t.find((e=>e.actionState===d.SyncActionState.Success))&&(e.setSyncDCriticalSynced(),e.setSyncDCriticalDataSyncCompleted())}new E.default.MdBootstrapDataApplied({mdBootstrapPayloadType:E.default.MD_BOOTSTRAP_PAYLOAD_TYPE.CRITICAL,mdBootstrapSource:E.default.MD_BOOTSTRAP_SOURCE.APP_STATE,mdSessionId:yield y.default.getMdSessionId(),mdTimestamp:(0,S.unixTimeMs)()}).commit()})));(0,f.getInitialHistorySyncComplete)()&&e.setInitialChatHistorySynced(),yield Promise.all([t,r])}}))()}continueProgressiveHistorySyncProcessing(){__LOG__(2)(I());var e="Safari"!==P.default.info().name;this._initNextProgressiveHistorySyncRunLoop(e)}_progressiveHistorySyncRun(){var e=this;return(0,n.default)((function*(){if(!e._allCriticalDataSynced&&!0!==e._criticalState.initialChatHistory)return __LOG__(2)(M()),void e._progressiveHistorySyncRemainingIteration++;var t=yield(0,T.fetchNextHitorySyncChunkForProcessing)();t&&(__LOG__(2)(w()),e._progressiveHistorySyncRemainingIteration++,yield(0,b.handleHistorySyncChunk)(t))}))()}_initNextProgressiveHistorySyncRunLoop(e=!1){var t=this;return(0,n.default)((function*(){if(e&&t._progressiveHistorySyncRemainingIteration++,!t._progressiveHistorySyncInFlight&&t._progressiveHistorySyncRemainingIteration>0){t._progressiveHistorySyncRemainingIteration--,t._progressiveHistorySyncInFlight=!0;try{yield t._progressiveHistorySyncRun()}catch(e){__LOG__(4,void 0,new Error)(O(),null==e?void 0:e.message,null==e?void 0:e.stack)}t._progressiveHistorySyncInFlight=!1,yield new Promise((e=>setTimeout(e,5e4))),t._initNextProgressiveHistorySyncRunLoop()}}))()}};u.default.on("on_initial_chat_synced",(()=>{V.setInitialChatHistorySynced()})),u.default.on("logout",(()=>{V.initState()}));var H=V;t.default=H},61867:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(54073)),i=r(60339),s=a(r(77626)),o=!1,u=(0,n.default)((()=>o=!1),500),l={id:function(){var e=r(95595),t=e.getBrowserId();if(t)return t;var a=new Uint8Array(16);return self.crypto.getRandomValues(a),t=(0,i.encodeB64)(a),e.setBrowserId(t),t},info:function(){var e=s.default.parser.getResult();return{os:e.os.name,version:e.os.version,name:e.browser.name,ua:e.browser.name+" "+e.browser.version}},hardRefresh:function(e,t=!0){(this.promptUnloadGuards++,e)&&r(95595).setNoTakeover(!0);location.reload(t)},startDownloading:function(){o=!0,u()},clearDownloading:function(){o=!1},isDownloading:function(){return o},promptUnloadGuards:0};t.default=l},59410:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.intToBytes=function(e,t){for(var r=t,a=new Uint8Array(e),n=e-1;n>=0;n--)a[n]=255&r,r>>>=8;return a},t.uint8ArrayToBuffer=function(e){return e.buffer.slice(e.byteOffset,e.byteLength+e.byteOffset)}},29398:()=>{!function(e){var t=e.HTMLCanvasElement&&e.HTMLCanvasElement.prototype,r=e.Blob&&function(){try{return Boolean(new Blob)}catch(e){return!1}}(),a=r&&e.Uint8Array&&function(){try{return 100===new Blob([new Uint8Array(100)]).size}catch(e){return!1}}(),n=e.BlobBuilder||e.WebKitBlobBuilder||e.MozBlobBuilder||e.MSBlobBuilder,i=(r||n)&&e.atob&&e.ArrayBuffer&&e.Uint8Array&&function(e){var t,i,s,o,u,l,d,c,f;if(!(t=e.match(/^data:((.*?)(;charset=.*?)?)(;base64)?,/)))throw new Error("invalid data URI");for(i=t[2]?t[1]:"text/plain"+(t[3]||";charset=US-ASCII"),s=!!t[4],o=e.slice(t[0].length),u=s?atob(o):decodeURIComponent(o),l=new ArrayBuffer(u.length),d=new Uint8Array(l),c=0;c<u.length;c+=1)d[c]=u.charCodeAt(c);return r?new Blob([a?d:l],{type:i}):((f=new n).append(l),f.getBlob(i))};e.HTMLCanvasElement&&!t.toBlob&&(t.mozGetAsFile?t.toBlob=function(e,r,a){a&&t.toDataURL&&i?e(i(this.toDataURL(r,a))):e(this.mozGetAsFile("blob",r))}:t.toDataURL&&i&&(t.toBlob=function(e,t,r){e(i(this.toDataURL(t,r)))})),e.dataURLtoBlob=i}(window)},3594:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.upload=q,t.uploadUserReport=function(){return Z.apply(this,arguments)},t.sendLogs=function(){return te.apply(this,arguments)};var n=a(r(70417)),i=a(r(19976)),s=a(r(52954)),o=a(r(12436)),u=a(r(42577)),l=a(r(79711)),d=a(r(52737)),c=a(r(50935)),f=r(95595),p=r(43443),h=a(r(15410)),_=a(r(40210)),m=a(r(20398)),g=a(r(74185)),v=a(r(95839)),E=a(r(69835)),y=a(r(18120));function S(){var e=(0,i.default)(["CLB:uploadUserReport failed ",""]);return S=function(){return e},e}function T(){var e=(0,i.default)(["CLB:uploadUserReport succeeded"]);return T=function(){return e},e}function b(){var e=(0,i.default)(["CLB:uploadUserReport submitting"]);return b=function(){return e},e}function A(){var e=(0,i.default)(["CLB:uploadUserReport description: ",""]);return A=function(){return e},e}function C(){var e=(0,i.default)(["CLB:uploadUserReport uploading"]);return C=function(){return e},e}function P(){var e=(0,i.default)(["wa:uploadLogs error uploading: ",""]);return P=function(){return e},e}function O(){var e=(0,i.default)(["wa:uploadLogs squelched logs"]);return O=function(){return e},e}function w(){var e=(0,i.default)(["=================================================="]);return w=function(){return e},e}function M(){var e=(0,i.default)(["reason for logs: ",""]);return M=function(){return e},e}function I(){var e=(0,i.default)(["reason for logs: manual-upload"]);return I=function(){return e},e}function R(){var e=(0,i.default)(["wa:uploadLogs hasTaggedMessage"]);return R=function(){return e},e}function D(){var e=(0,i.default)(["wa:uploadLogs mdOptIn: ",""]);return D=function(){return e},e}function N(){var e=(0,i.default)(["wa:uploadLogs distribution: ",""]);return N=function(){return e},e}function L(){var e=(0,i.default)(["wa:uploadLogs url: ",""]);return L=function(){return e},e}function k(){var e=(0,i.default)(["wa:uploadLogs appId: ",""]);return k=function(){return e},e}function U(){var e=(0,i.default)(["wa:uploadLogs webPlatform: ",""]);return U=function(){return e},e}function F(){var e=(0,i.default)(["wa:uploadLogs platform: ",""]);return F=function(){return e},e}function G(){var e=(0,i.default)(["wa:uploadLogs userAgent: ",""]);return G=function(){return e},e}function x(){var e=(0,i.default)(["wa:uploadLogs version: ",""]);return x=function(){return e},e}function B(){var e=(0,i.default)(["wa:uploadLogs hash: ",""]);return B=function(){return e},e}function Y(){var e=(0,i.default)(["wa:uploadLogs ref: ",""]);return Y=function(){return e},e}function K(){var e=(0,i.default)(["=================================================="]);return K=function(){return e},e}function j(){var e=(0,i.default)(["Focus at time of upload:"]);return j=function(){return e},e}var W=e=>new Promise((t=>setTimeout(t,e))),V=r(28103)({CRASHLOG:"crashlog",SUPPORT:"support"}),H=(0,o.default)(J,c.default.LOG_UPLOAD_INTERVAL);function q(){return z.apply(this,arguments)}function z(){return(z=(0,s.default)((function*({reason:e,immediate:t=!1,force:r=!1,persist:a=!1,isHighPri:n=!1,nativeCrash:i,voipLog:s,skipSampling:o=!1,hasTaggedMessage:u=!1,ticketId:f}){var h=a?V.SUPPORT:V.CRASHLOG;l.default.logSocketSummary(),__LOG__(2)(j()),m.default.pprint(),__LOG__(2)(K()),__LOG__(2)(Y(),d.default.ref||"no conn"),__LOG__(2)(B(),c.default.LATEST_HASH),__LOG__(2)(x(),c.default.VERSION_BASE),__LOG__(2)(G(),navigator.userAgent),__LOG__(2)(F(),d.default.platform||"no platform"),__LOG__(2)(U(),c.default.FLB_PLATFORM||"web"),__LOG__(2)(k(),c.default.APP_ID),__LOG__(2)(L(),location.href),__LOG__(2)(N(),(0,p.getDistribution)()),__LOG__(2)(D(),y.default.supportsFeature(y.default.F.MD_BACKEND)),u&&__LOG__(2)(R());var _=null;if(void 0===e)h=V.SUPPORT,__LOG__(2)(I()),_=!0;else if(e){var g=e;y.default.supportsFeature(y.default.F.MD_BACKEND)&&(g="[MD] ".concat(e)),__LOG__(2)(M(),g)}__LOG__(2)(w());var v=J;if(!_&&!r){if(!(Math.random()<c.default.UPLOAD_TO_CLB))return void __LOG__(2)(O());v=H}try{return yield v({isHighPri:n,immediate:t,logType:h,nativeCrash:i,voipLog:s,skipSampling:o,ticketId:f})}catch(e){__LOG__(2)(P(),e)}}))).apply(this,arguments)}function J(){return Q.apply(this,arguments)}function Q(){return(Q=(0,s.default)((function*({isHighPri:e,immediate:t,logType:r,nativeCrash:a,voipLog:n,skipSampling:i=!1,ticketId:s}){yield W(t?0:500);var o=X({isHighPri:e}),l=yield E.default.post($(r),o);u.default.equal(l.status,200);var d=X({isHighPri:e}),c=(yield h.default.getLogs()).join("\n"),f=new Blob([c],{type:"text/plain"});d.append("file",f,"logs.txt"),s&&d.append("ticket_id",s),a&&(d.append("attachment",new Blob([a.contents],{type:"application/octet-stream"}),a.filename),d.set("agent",a.agent),d.append("tags","electron_native"),n&&d.append("voip_log",new Blob([n.contents],{type:"text/plain"}),n.filename));var p=yield E.default.post(ee(r),d);return u.default.equal(p.status,200),p.getResponseHeader("X-Uploaded-File-Id")}))).apply(this,arguments)}function X({isHighPri:e}){var t=new FormData;e&&t.append("forced","true");var a=(0,f.getMe)();a&&(t.append("from",a.user),t.append("from_jid",a.toString()));var n=r(61867).default.info(),i=(0,p.getLogUserAgent)({device:n.os,browser:n.ua,appVersion:c.default.VERSION_BASE});return t.append("agent",i),t.append("app_id",c.default.APP_ID),y.default.supportsFeature(y.default.F.MD_BACKEND)&&t.append("md_opt_in","true"),t}function Z(){return(Z=(0,s.default)((function*(e,t,r,a,i){try{__LOG__(2)(C()),__LOG__(2,!0)(A(),a);var s=yield q({reason:"user-report",immediate:!0,force:!0,persist:!0}),o=(0,f.getLoginTokens)().server,u=new FormData;o&&u.append("tok",o),null!=e&&u.append("user",String(e)),u.append("email",t),s&&u.append("crashlog",s),u.append("desc",a),i.map(((e,t)=>{u.append("screenshot-".concat(t),e)})),v.default.initialize();var l=(0,n.default)((0,n.default)({subject:r},_.default.Global.all),{},{webcWebPlatform:c.default.FLB_PLATFORM,webcPhonePlatform:d.default.platform,webcProtoVersion:String(d.default.protoVersion)}),p=(0,f.getMe)();p&&(l.deviceID=p.toString());var h={};for(var m in l){var g=l[m];null!=g&&(h[m]=g)}u.append("info",JSON.stringify(h)),__LOG__(2)(b()),yield E.default.post(c.default.TICKET_URL,u),__LOG__(2)(T())}catch(e){__LOG__(2)(S(),String(e))}}))).apply(this,arguments)}function $(e){return g.default.build(c.default.FB_CLB_CHECK_URL,{type:String(e),access_token:c.default.FB_CLB_TOKEN})}function ee(e){return g.default.build(c.default.FB_CLB_URL,{type:String(e),access_token:c.default.FB_CLB_TOKEN})}function te(){return(te=(0,s.default)((function*(e){yield q({reason:e,hasTaggedMessage:!0})}))).apply(this,arguments)}},19899:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.HOUR24_FORMAT_CHANGE_EVENT=t.SKEW_CHANGE_EVENT=void 0;var n=a(r(70417)),i=a(r(19976)),s=a(r(19034)),o=r(44578),u=a(r(50935)),l=a(r(28267)),d=a(r(17957));function c(){var e=(0,i.default)(["Setting large clockskew: ","ms"]);return c=function(){return e},e}function f(){var e=(0,i.default)(["Intl.DateTimeFormat().resolvedOptions().timeZone does not exist"]);return f=function(){return e},e}function p(){var e=(0,i.default)(["Intl.DateTimeFormat().resolvedOptions().timeZone is ",""]);return p=function(){return e},e}var h=["fi","id","ms","ms-my"],_="skew_change";t.SKEW_CHANGE_EVENT=_;var m="hour24_format_change";t.HOUR24_FORMAT_CHANGE_EVENT=m;class g extends l.default{constructor(){if(super(),this.is24h=!1,this.skewMS=0,this.skew=0,Intl&&Intl.DateTimeFormat&&Intl.DateTimeFormat().resolvedOptions){var e=Intl.DateTimeFormat().resolvedOptions().timeZone;switch(e?__LOG__(2)(p(),e):__LOG__(2)(f()),e){case"America/Sao_Paulo":this.timeZoneHardCode="America/Belem";break;case"America/Campo_Grande":case"America/Cuiaba":this.timeZoneHardCode="America/Porto_Velho"}}}getIs24Hour(){return this.is24h}setIs24Hour(e){e!==this.is24h&&(this.is24h=e,this.trigger(m))}setIs24HourBasedOnLocale(){this.setIs24Hour(o.LOCALES_THAT_PREFER_24HOUR_TIME.has(d.default.getLocale()))}setSkew(e){Math.abs(e)>6e4&&__LOG__(2)(c(),e);var t=this.skewMS;this.skewMS=e,this.skew=Math.round(e/1e3),Math.abs(t-this.skewMS)>1e3&&this.trigger(_)}getSkew(){return this.skew}localUnixTime(e){return void 0!==e?e+this.skew:Math.floor(Date.now()/1e3)}globalUnixTime(e){return void 0!==e?e-this.skew:Math.floor((Date.now()-this.skewMS)/1e3)}relativeStr(e){var t=e+this.skew;return t>=(0,s.default)().startOf("day").unix()?this._timestampStr(t):this._dateRelativeStr(t,!1)}relativeDateStr(e){return this._dateRelativeStr(e+this.skew,!1)}relativeDateAndTimeStr(e){return this._dateRelativeStr(e+this.skew,!0)}timeStr(e){if(this.shouldUseIntlDateTimeFormat()){var t=1e3*(e+this.skew),r={hour12:!this.is24h,hour:"numeric",minute:"numeric"},a={year:"numeric",month:"numeric",day:"numeric"};null!=this.timeZoneHardCode&&(r=(0,n.default)((0,n.default)({},r),{},{timeZone:this.timeZoneHardCode}),a=(0,n.default)((0,n.default)({},a),{},{timeZone:this.timeZoneHardCode}));var i=Intl.DateTimeFormat(s.default.locale(),r).format(t),o=Intl.DateTimeFormat(s.default.locale(),a).format(t);return"".concat(i,", ").concat(o)}return s.default.unix(e+this.skew).format(this.is24h?"HH".concat(this._hmsSeparator(),"mm, l"):"LT, l")}timestampStr(e){return this._timestampStr(e+this.skew)}timestampStrFormat(){return this.is24h?"HH".concat(this._hmsSeparator(),"mm"):"LT"}timestampHour(e){var t=e+this.skew,r=s.default.unix(t).hour();return this.is24h?r:r%12}createdStr(e,t){var r=this.daysDelta(e),a=e+this.skew,n=this._timestampStr(a);if(0===r)return t?d.default.t(1657,{time:n}):d.default.t(1656,{time:n});if(1===r)return t?d.default.t(1661,{time:n}):d.default.t(1660,{time:n});if(r<7){var i=this._dateRelativeStr(a,!1);return t?d.default.t(1659,{day:i,time:n}):d.default.t(1658,{day:i,time:n})}var s=this._dateRelativeStr(a,!1);return t?d.default.t(1655,{date:s,time:n}):d.default.t(1654,{date:s,time:n})}untilStr(e){if(e===u.default.MUTE_ALWAYS_EXPIRATION_SENTINEL)return d.default.t(1041);var t=this.daysDelta(e),r=e+this.skew,a=this._timestampStr(r);if(0===t)return d.default.t(1427,{time:a});if(1===t)return d.default.t(1428,{time:a});if(t<7){var n=this._dateRelativeStr(r,!1);return d.default.t(1429,{day:n,time:a})}var i=this._dateRelativeStr(r,!1);return d.default.t(1426,{date:i,time:a})}lastSeenStr(e){var t=this.daysDelta(e),r=e+this.skew,a=this._timestampStr(r);if(0===t)return d.default.t(1616,{time:a});if(1===t)return d.default.t(1618,{time:a});if(t<7){var n=this._dateRelativeStr(r,!1);return d.default.t(1617,{date:n,time:a})}var i=this._dateRelativeStr(r,!1);return d.default.t(1615,{date:i,time:a})}daysDelta(e,t){var r=s.default.unix(e).startOf("day"),a=(void 0===t?(0,s.default)().startOf("day"):s.default.unix(t).startOf("day")).diff(r,"days");return Math.abs(a)}durationStr(e){var t="string"==typeof e?parseInt(e,10):e,r=s.default.utc(1e3*t);if(r.isValid()){var a=t<3600?"m:ss":"H:mm:ss";return r.format(a)}return""}paymentTimestampStr(e){var t=e+this.skew,r=s.default.unix(t),a=r.startOf("day"),n=(0,s.default)().startOf("day").diff(a,"days");if(0===n)return d.default.t(1868);if(1===n)return d.default.t(1894);if(!(n<7)){var i=r.format("MMMM d");return d.default.t(1803,{date:i})}switch(r.day()){case 0:default:return d.default.t(1804);case 1:return d.default.t(1801);case 2:return d.default.t(1806);case 3:return d.default.t(1807);case 4:return d.default.t(1805);case 5:return d.default.t(1800);case 6:return d.default.t(1802)}}liveLocationLastUpdatedStr(e){var t=e+this.skew,r=this._timestampStr(t),a=s.default.unix(t).startOf("day"),n=(0,s.default)().startOf("day").diff(a,"days");if(0===n)return d.default.t(886,{time:r});if(1===n)return d.default.t(888,{time:r});if(n<6){var i=this._dateRelativeStr(t,!1);return d.default.t(887,{date:i,time:r})}var o=this._dateRelativeStr(t,!1);return d.default.t(885,{date:o,time:r})}_timestampStr(e){if(this.shouldUseIntlDateTimeFormat()){var t={hour12:!this.is24h,hour:"numeric",minute:"numeric"};null!=this.timeZoneHardCode&&(t=(0,n.default)((0,n.default)({},t),{},{timeZone:this.timeZoneHardCode}));var r=Intl.DateTimeFormat(s.default.locale(),t).format(1e3*e);return this.is24h?r.replace(/^24/,"00"):r.replace(/^0/,"12")}return s.default.unix(e).format(this.timestampStrFormat())}_dateStr(e){if(this.shouldUseIntlDateTimeFormat()){var t={year:"numeric",month:"numeric",day:"numeric"};return null!=this.timeZoneHardCode&&(t=(0,n.default)((0,n.default)({},t),{},{timeZone:this.timeZoneHardCode})),Intl.DateTimeFormat(s.default.locale(),t).format(1e3*e)}return s.default.unix(e).format("l")}_dateRelativeStr(e,t){var r=(0,s.default)().startOf("day"),a=s.default.unix(e).startOf("day"),n=r.diff(a,"days"),i=this._timestampStr(e);if(0===n)return t?d.default.t(1869,{time:i}):d.default.t(1868);if(1===n)return t?d.default.t(1895,{time:i}):d.default.t(1894);if(!t&&Math.abs(n)<7)return s.default.unix(e).format("dddd");var o=this._dateStr(e);return t?d.default.t(1867,{date:o,time:i}):o}_hmsSeparator(){var e=s.default.locale();return h.includes(e)?".":":"}shouldUseIntlDateTimeFormat(){return Intl&&Intl.DateTimeFormat&&!o.LOCALE_DATE_TIME_CUSTOMIZATIONS[s.default.locale()]&&!o.SHOULD_USE_MOMENT_LOCALE_FORMAT.has(s.default.locale())}}var v=new g;t.default=v},97502:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.resetCompanionReg=function(){_=!1,m=!1},t.startLogin=function(){if(_||m)return;(0,l.setDeviceLinkPairStage)(c.default.MD_LINK_DEVICE_COMPANION_STAGE.FIRST_CONNECT),_=!0,(0,o.clearADVSecretKey)(),u.default.restartBackend()},t.startLogout=v,t.logoutAfterValidationFail=function(){new s.ShiftTimer((()=>{v()})).onOrAfter(1e3)},t.startInitialHistorySyncTimeout=function(){if(null==h){h=setTimeout(g,12e4),(new d.default).listenTo(u.default,"on_initial_chat_synced",(()=>{clearTimeout(h)}))}};var n=a(r(52954)),i=a(r(19976)),s=r(39329),o=r(12250),u=a(r(79711)),l=r(15447),d=a(r(28267)),c=a(r(40210)),f=a(r(12767));function p(){var e=(0,i.default)(["initialHistorySyncTimeout - logout due to no history data"]);return p=function(){return e},e}var h,_=!1,m=!1;function g(){__LOG__(4,void 0,new Error)(p()),f.default.logout()}function v(){return E.apply(this,arguments)}function E(){return(E=(0,n.default)((function*(){_||m||(m=!0,yield f.default.clearCredentialsAndStoredData(),(0,o.clearADVSecretKey)(),u.default.restartBackend())}))).apply(this,arguments)}},74489:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r="animation",a="transition",n={_normalize:function(e,t,r){var a=e.toLowerCase().indexOf(t),n=e.slice(0,a).toLowerCase();return 0===e.indexOf(t)?n+e.slice(a)+r.toLowerCase():n+e.slice(a)+r},prefix:function(e,t){var n;if(0===e.indexOf(r)){n=e.substring(r.length);var i=window.Modernizr?window.Modernizr.prefixed(r):r;return this._normalize(i,r,n)}if(0===e.indexOf(a)){n=e.substring(a.length);var s=window.Modernizr?window.Modernizr.prefixed(a):a;return this._normalize(s,a,n)}return window.Modernizr.prefixed(e,t,!1)||e}};t.default=n},64357:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(29351);class n extends((0,a.customError)("ContactBlocked")){constructor(e,t){super(e),this.contact=t}}t.default=n},80533:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setCookie=function(e){e.session&&delete e.expirationDate;var t=[];["name","value","domain","path","secure","session","expirationDate"].forEach((r=>{var a=e[r];if(void 0!==a&&"value"!==r)switch(r){case"expirationDate":var n=new Date(e.expirationDate);t.push("expires=".concat(n.toUTCString()));break;case"secure":t.push("secure");break;case"name":var i=e.value||"";t.push("".concat(String(a),"=").concat(i));break;default:t.push("".concat(r,"=").concat(String(a)))}})),document.cookie=t.join(";")},t.getCookie=function(e){var t=document.cookie.match(new RegExp("(^| )"+e+"=([^;]+)"));return t?t[2]:void 0},t.deleteCookie=function(e){document.cookie=e+"=; expires=Thu, 01 Jan 1970 00:00:01 GMT;"}},38174:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.encryptAndMac=function(e,t,r){return(0,o.aesCbcEncrypt)(e,new Uint8Array(r)).then((e=>new l.default(t).sign(e).then((t=>i.Binary.build(t,e).readBuffer()))))},t.macAndDecrypt=function(e,t,r){return Promise.resolve(new Uint8Array(r)).then((r=>{var a=(0,s.encodeB64)(r.subarray(0,32)),n=r.subarray(32);return new l.default(t).sign(n).then((t=>{var r=(0,s.encodeB64)(t);if(a!==r)throw __LOG__(3)(d(),a,r),new Error("macAndDecrypt HMAC mismatch");return(0,o.aesCbcDecrypt)(e,n)}))}))},t.alignChunkSizeToMultipleAesBlockSize=c,t.alignChunkLengthsToMultipleOfAesBlockSize=function(e,t){for(var r=[],a=0,n=0,i=0,s=0;s<e.length;++s){if(a+=e[s],s===e.length-1&&null!=t){a>n?r.push(t-n):(r.pop(),r.push(t-i));break}if(a>n){var o=c(a-n);i=n,r.push(o),n+=o}}return r},t.removeEncryptedPadding=function(e,t){var r=e.slice(-t.byteLength);if((0,u.default)(r,t))return e.slice(0,e.byteLength-t.byteLength);return e};var n=a(r(19976)),i=r(46378),s=r(60339),o=r(9729),u=a(r(38307)),l=a(r(36398));function d(){var e=(0,n.default)(["crypto:macAndDecrypt HMAC don't match "," vs. ",""]);return d=function(){return e},e}function c(e){return 16*parseInt((e+15)/16,10)}},9729:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.aesCbcDecrypt=function(e,t){return Promise.resolve().then((()=>{var r=t.slice(0,16),a=t.slice(16),i=o(r);return Promise.resolve(s.default.importKey("raw",(0,n.default)(Uint8Array,e),"AES-CBC",!1,["decrypt"])).then((e=>s.default.decrypt(i,e,a)))}))},t.aesCbcEncrypt=function(e,t,r){return Promise.resolve().then((()=>{var a;r?a=(0,n.default)(Uint8Array,r):(a=new Uint8Array(16),self.crypto.getRandomValues(a));var u=o(a);return Promise.resolve(s.default.importKey("raw",(0,n.default)(Uint8Array,e),"AES-CBC",!1,["encrypt"])).then((e=>s.default.encrypt(u,e,t))).then((e=>(0,i.default)(Uint8Array,[a,new Uint8Array(e)]).buffer))}))};var n=a(r(77638)),i=a(r(66190)),s=a(r(84025));function o(e){return{name:"AES-CBC",iv:(0,n.default)(Uint8Array,e)}}},38034:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(77638)),i=a(r(84025));t.default=class{constructor(e,t){this._algo=e,this._key=(0,n.default)(Uint8Array,t)}sign(e,t){return Promise.resolve(i.default.importKey("raw",this._key,this._algo,!1,["sign"])).then((t=>i.default.sign(this._algo,t,e))).then((e=>null!=t&&0!==t?e.slice(0,t):e))}}},52267:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(38034)),i={name:"HMAC",hash:{name:"SHA-1"}};class s extends n.default{constructor(e){super(i,e)}}t.default=s},36398:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(38034)),i={name:"HMAC",hash:{name:"SHA-256"}};class s extends n.default{constructor(e){super(i,e)}}t.default=s},82060:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(38034)),i={name:"HMAC",hash:{name:"SHA-512"}};class s extends n.default{constructor(e){super(i,e)}}t.default=s},44303:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.LT_HASH_ANTI_TAMPERING=t.default=t.EMPTY_LT_HASH=t.KEY_LENGTH_BYTES=void 0;var i=n(r(52954)),s=a(r(55273)),o=128;t.KEY_LENGTH_BYTES=o;var u=new ArrayBuffer(o);t.EMPTY_LT_HASH=u;class l{constructor(e){this.salt=e}add(e,t){var r=this;return t.reduce(function(){var e=(0,i.default)((function*(e,t){return r._addSingle(yield e,t)}));return function(){return e.apply(this,arguments)}}(),Promise.resolve(e))}subtract(e,t){var r=this;return t.reduce(function(){var e=(0,i.default)((function*(e,t){return r._subtractSingle(yield e,t)}));return function(){return e.apply(this,arguments)}}(),Promise.resolve(e))}subtractThenAdd(e,t,r){var a=this;return(0,i.default)((function*(){return a.add(yield a.subtract(e,r),t)}))()}_addSingle(e,t){var r=this;return(0,i.default)((function*(){var a=yield s.extractAndExpand(t,r.salt,o);return r.performPointwiseWithOverflow(e,a,((e,t)=>e+t))}))()}_subtractSingle(e,t){var r=this;return(0,i.default)((function*(){var a=yield s.extractAndExpand(t,r.salt,o);return r.performPointwiseWithOverflow(e,a,((e,t)=>e-t))}))()}performPointwiseWithOverflow(e,t,r){for(var a=new DataView(e),n=new DataView(t),i=new ArrayBuffer(a.byteLength),s=new DataView(i),o=0;o<a.byteLength;o+=2)s.setUint16(o,r(a.getUint16(o,!0),n.getUint16(o,!0)),!0);return i}}t.default=l;var d=new l("WhatsApp Patch Integrity");t.LT_HASH_ANTI_TAMPERING=d},40571:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return Promise.resolve(i.default.digest({name:"SHA-256"},e).then(n.encodeB64))};var n=r(60339),i=a(r(84025))},70594:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(19976));function i(){var e=(0,n.default)(["CryptoSupport:ECDH: ",""]);return i=function(){return e},e}function s(){var e=(0,n.default)(["CryptoSupport:ECDH key generation #1 failed: ",""]);return s=function(){return e},e}function o(){var e=(0,n.default)(["CryptoSupport:ECDH key generation #2 failed: ",""]);return o=function(){return e},e}function u(){var e=(0,n.default)(["CryptoSupport:ECDH key derivation failed: ",""]);return u=function(){return e},e}function l(){var e=(0,n.default)(["CryptoSupport:ECDH key derivation succeeded"]);return l=function(){return e},e}function d(){var e=(0,n.default)(["CryptoSupport:AES-CBC: ",""]);return d=function(){return e},e}function c(){var e=(0,n.default)(["CryptoSupport:AES-CBC key generation failed: ",""]);return c=function(){return e},e}function f(){var e=(0,n.default)(["CryptoSupport:AES-CBC decryption failed: ",""]);return f=function(){return e},e}function p(){var e=(0,n.default)(["CryptoSupport:AES-CBC encryption/decryption is incorrect"]);return p=function(){return e},e}function h(){var e=(0,n.default)(["CryptoSupport:AES-CBC encryption/decryption is correct"]);return h=function(){return e},e}function _(){var e=(0,n.default)(["CryptoSupport:AES-CBC encryption failed: ",""]);return _=function(){return e},e}function m(){var e=(0,n.default)(["CryptoSupport:HMAC-SHA256: ",""]);return m=function(){return e},e}function g(){var e=(0,n.default)(["CryptoSupport:HMAC-SHA256 key generation failed: ",""]);return g=function(){return e},e}function v(){var e=(0,n.default)(["CryptoSupport:HMAC-SHA256 verification failed: ",""]);return v=function(){return e},e}function E(){var e=(0,n.default)(["CryptoSupport:HMAC-SHA256 is not verified"]);return E=function(){return e},e}function y(){var e=(0,n.default)(["CryptoSupport:HMAC-SHA256 is verified"]);return y=function(){return e},e}function S(){var e=(0,n.default)(["CryptoSupport:HMAC-SHA256 signing failed: ",""]);return S=function(){return e},e}var T="whatsapp is da best",b=new Uint8Array(T.split("").map((e=>e.charCodeAt(0)))),A={name:"HMAC",hash:"SHA-256"},C={name:"AES-CBC",length:256},P={name:"ECDH",namedCurve:"P-256"};function O(){return Promise.resolve().then((()=>self.crypto.subtle||self.crypto.webkitSubtle))}var w={supportsHmacSha256:function(){return O().then((e=>e.generateKey(A,!1,["sign","verify"]).then((t=>e.sign(A,t,b).then((r=>e.verify(A,t,r,b.buffer))).catch((e=>(__LOG__(2)(S(),e),!1))).then((e=>e?(__LOG__(2)(y()),!0):(__LOG__(2)(E()),!1))).catch((e=>(__LOG__(2)(v(),e),!1))))).catch((e=>(__LOG__(2)(g(),e),!1))))).catch((e=>(__LOG__(2)(m(),e),!1)))},supportsAesCbc:function(){return O().then((e=>e.generateKey(C,!1,["encrypt","decrypt"]).then((t=>Promise.resolve(self.crypto).then((e=>({name:"AES-CBC",iv:e.getRandomValues(new Uint8Array(16))}))).then((r=>e.encrypt(r,t,b).then((a=>e.decrypt(r,t,a))).catch((e=>(__LOG__(2)(_(),e),!1))).then((e=>{var t,r=new Uint8Array(e);return t=r,Array.prototype.slice.call(t).map((e=>String.fromCharCode(e))).join("")===T?(__LOG__(2)(h()),!0):(__LOG__(2)(p()),!1)})).catch((e=>(__LOG__(2)(f(),e),!1))))))).catch((e=>(__LOG__(2)(c(),e),!1))))).catch((e=>(__LOG__(2)(d(),e),!1)))},supportsEcdh:function(){return O().then((e=>e.generateKey(P,!1,["deriveKey"]).then((t=>e.generateKey(P,!1,["deriveKey"]).then((r=>{var a={name:"ECDH",namedCurve:"P-256",public:r.publicKey};return e.deriveKey(a,t.privateKey,C,!1,["encrypt","decrypt"]).then((()=>(__LOG__(2)(l()),!0))).catch((e=>(__LOG__(2)(u(),e),!1)))})).catch((e=>(__LOG__(2)(o(),e),!1))))).catch((e=>(__LOG__(2)(s(),e),!1))))).catch((e=>(__LOG__(2)(i(),e),!1)))},supportsWebCrypto:function(){return this.webCryptoPromise||(this.webCryptoPromise=Promise.all([this.supportsHmacSha256(),this.supportsAesCbc()])),this.webCryptoPromise.spread(((e,t)=>Promise.resolve(e&&t)))}};t.default=w},72434:(e,t,r)=>{"use strict";var a;Object.defineProperty(t,"__esModule",{value:!0}),t.keyPair=function(e){var t;void 0===e?(t=new Uint8Array(32),self.crypto.getRandomValues(t)):t=new Uint8Array(e);return t[0]&=248,t[31]&=127,t[31]|=64,u({pubKey:32,privKey:t,basepoint:n},(function(e){var r=a._curve25519_donna(e.pubKey,e.privKey,e.basepoint);if(r)throw new Error("Curve25519:keyPair Error Code ".concat(r));return{pubKey:o(e.pubKey,32),privKey:t.buffer}}))},t.sharedSecret=function(e,t){return Promise.resolve().then((()=>u({sharedKey:32,pubKey:e,privKey:t},(function(e){var t=a._curve25519_donna(e.sharedKey,e.privKey,e.pubKey);if(t)throw new Error("Curve25519:sharedSecret Error Code ".concat(t));return o(e.sharedKey,32)}))))},t.toSignalCurveKeyPair=function(e){if(32!==e.pubKey.byteLength||32!==e.privKey.byteLength)throw new Error("Invalid key pair type");var t=i(e.pubKey),r=new Uint8Array(32);return r.set(new Uint8Array(e.privKey)),{pubKey:t,privKey:r.buffer}},t.toSignalCurvePubKey=i,t.toCurveKeyPair=function(e){if(33!==e.pubKey.byteLength||32!==e.privKey.byteLength)throw new Error("Invalid key pair type");var t=new Uint8Array(32),r=new Uint8Array(32);return t.set(new Uint8Array(e.pubKey).subarray(1)),r.set(new Uint8Array(e.privKey)),{pubKey:t.buffer,privKey:r.buffer}},t.toCurveKeyPubKey=function(e){if(33!==e.byteLength)throw new Error("Invalid key type");var t=new Uint8Array(32);return t.set(new Uint8Array(e).subarray(1)),t.buffer},t.verifySignature=function(e,t,r){if(32!==e.byteLength)throw new Error("Invalid public key length: ".concat(e.byteLength));var a=new Uint8Array(33);return a[0]=5,a.set(e,1),!1===window.libsignal.Curve.verifySignature(a,t,r)};var n=new Uint8Array(32);n[0]=9;function i(e){if(32!==e.byteLength)throw new Error("Invalid key type");var t=new Uint8Array(33);return t[0]=5,t.set(new Uint8Array(e),1),t.buffer}function s(e){if("number"==typeof e)return a._malloc(e);var t=new Uint8Array(e.buffer||e),r=a._malloc(t.length);return a.HEAPU8.set(t,r),r}function o(e,t){var r=new Uint8Array(t);return r.set(a.HEAPU8.subarray(e,e+t)),r.buffer}function u(e,t){a||(a=r(26819));var n={};try{for(var i in e)n[i]=s(e[i]);return t(n)}finally{for(var o in n)a._free(n[o])}}},26823:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.Node=void 0;var n=a(r(19976)),i=a(r(12436)),s=a(r(47677));function o(){var e=(0,n.default)(["Blob size is larger than the limit of the whole store."]);return o=function(){return e},e}class u{constructor(e,t){this.key=e,this.value=t,this.prev=null,this.next=null}}t.Node=u;t.default=class{constructor(e){var t;this.schedulePurge=(0,i.default)((()=>{this.purgeNow()}),1e3,{leading:!1}),this._keyToNode={},this._sizeLimit=e.sizeLimit,this._getSize=e.getSize,this._onPurge=e.onPurge,this._shouldEvict=null!==(t=e.shouldEvict)&&void 0!==t?t:()=>!0,this._onEvict=e.onEvict,this._onAdd=e.onAdd,this._onDelete=e.onDelete,this._currentSize=0,this._dummyHead=new u("dummy-head",null),this._dummyTail=new u("dummy-tail",null),this._dummyHead.next=this._dummyTail,this._dummyTail.prev=this._dummyHead}get(e){if(!this._keyToNode.hasOwnProperty(e))return null;var t=this._keyToNode[e];if(null==t)return null;var r=t.prev,a=t.next;r&&(r.next=a),a&&(a.prev=r);var n=this._dummyHead.next;if(null==n)throw new Error("The linked list is not constructed properly.");return this._dummyHead.next=t,n.prev=t,t.prev=this._dummyHead,t.next=n,t.value}has(e){return this._keyToNode.hasOwnProperty(e)}touch(e){this.get(e)}put(e,t){0!==this._sizeLimit&&(this._getSize(t)>this._sizeLimit?__LOG__(3)(o()):(this.delete(e),this._add(e,t),this.schedulePurge()))}_add(e,t){var r=new u(e,t);this._keyToNode[e]=r;var a=this._dummyHead.next;if(null==a)throw new Error("The linked list is not constructed properly.");this._dummyHead.next=r,a.prev=r,r.prev=this._dummyHead,r.next=a,this._currentSize+=this._getSize(t),this._onAdd&&this._onAdd(e,t)}delete(e){if(this._keyToNode.hasOwnProperty(e)){var t=this._keyToNode[e];if(null!=t){this._currentSize-=this._getSize(t.value);var r=t.prev,a=t.next;r&&(r.next=a),a&&(a.prev=r),delete this._keyToNode[e],this._onDelete&&this._onDelete(e,t.value)}}}clear(){this._keyToNode={},this._currentSize=0,this._dummyHead.next=this._dummyTail,this._dummyTail.prev=this._dummyHead,this._onClear&&this._onClear()}purgeNow(){for(var e=this._dummyTail.prev;this._currentSize>this._sizeLimit&&e!==this._dummyHead;e=e?e.prev:null){(0,s.default)(null!=e,"The linked list is not constructed properly.");var{key:t,value:r}=e;this._shouldEvict(t,r)&&(this.delete(t),this._onEvict&&this._onEvict(t,r))}this._onPurge&&this._onPurge(this._keyToNode)}}},13818:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default=class{constructor(e,t){this._valueFn=e,this._heap=[],this._load(t)}_load(e){e&&e.length&&e.forEach((e=>{this.push(e)}))}_swap(e,t){var r=this._heap[t];this._heap[t]=this._heap[e],this._heap[e]=r}_siftUp(e=0){if(0!==e){var t=this._getParent(e),r=2*t+1,a=2*t+2,n=this._heap.length;if(!(e>=n)){var i=this._getVal(t),s=t;if(r<n){var o=this._getVal(r);i>o&&(s=r,i=o)}if(a<n)i>this._getVal(a)&&(s=a);s!==t&&(this._swap(s,t),this._siftUp(t))}}}_doHeapify(e=0){var t=2*e+1,r=2*e+2,a=this._heap.length;if(!(e>=a)){var n=this._getVal(e),i=e;if(t<a){var s=this._getVal(t);n>s&&(i=t,n=s)}if(r<a)n>this._getVal(r)&&(i=r);i!==e&&this._swap(i,e),t<a&&this._doHeapify(t),r<a&&this._doHeapify(r)}}_getVal(e){return this._valueFn(this._heap[e])}_getParent(e){return e%2==0?(e-2)/2:(e-1)/2}push(e){this._heap.push(e);var t=this._heap.length-1;this._siftUp(t)}pull(){var e=this._heap.shift();return this.heapify(),e}heapify(){this._doHeapify(0)}peek(){return this._heap[0]}}},75688:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(61941));class i{constructor(e){this._children={},this._indices=[],e&&(this._data=e)}static fromBackwardsStrings(e,t){return e.reduce(((e,t,r)=>e.addBackwardsString(t,r)),new i(t))._optimize()}addBackwardsString(e,t){for(var r=e.length-1,a=this;r>=0;){var n=e.charAt(r);a._addIndex(t),a=a.get(n)||a.set(n,new i),r--}return a._addIndex(t),this}static fromForwardsStrings(e,t){return e.reduce(((e,t,r)=>e.addForwardsString(t,r)),new i(t))._optimize()}addForwardsString(e,t){for(var r=0,a=this;r<e.length;){var n=e.charAt(r);a._addIndex(t),a=a.get(n)||a.set(n,new i),r++}return a._addIndex(t),this}set(e,t){return this._children[e]=t,t}get(e){return this._children[e]}getChildren(){return Object.keys(this._children).map((e=>({prefix:e,node:(0,n.default)(this.get(e),"this.get(prefix)")})))}hasChildren(){return!function(e){for(var t in e)return!1;return!0}(this._children)}search(e){var t=this._data;if(!t)return[];for(var r=this,a=0;a<e.length&&r;a++){var n=e[a];r=r.get(n)}return r?r.getIndices().map((e=>t[e])):[]}_addIndex(e){this._indices.push(e)}getIndices(){var e=this._indices,t=Object.keys(this._children);return 1===t.length&&0===this._indices.length?this._children[t[0]].getIndices():e}_optimize(){if(!this.hasChildren())return this;var e=Object.keys(this._children),t=this._children[e[0]]._indices;return e.forEach((e=>{this._children[e]._optimize()})),1===e.length&&this._indices.length===t.length&&(this._indices=[]),this}testOnlyGetChildrenProperty(){return this._children}testOnlyGetIndicesProperty(){return this._indices}}t.default=i},77771:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(52954)),i=a(r(19976)),s=a(r(15253)),o=a(r(77715)),u=a(r(19034)),l=a(r(50935)),d=a(r(80521)),c=a(r(40210)),f=a(r(61941)),p=a(r(31429)),h=r(11419),_=a(r(77626));function m(){var e=(0,i.default)(["db:deleteDB:Error ",""]);return m=function(){return e},e}function g(){var e=(0,i.default)(["db:openDB:Error ",""]);return g=function(){return e},e}function v(){var e=(0,i.default)(["db:openDB blocked"]);return v=function(){return e},e}function E(){var e=(0,i.default)(["db: Successfully opened db"]);return E=function(){return e},e}function y(){var e=(0,i.default)(["db:loadUserIdb:Error ",""]);return y=function(){return e},e}function S(){var e=(0,i.default)(["db:clear:Error ",""]);return S=function(){return e},e}function T(){var e=(0,i.default)(["db:removeItem:Error ",""]);return T=function(){return e},e}function b(){var e=(0,i.default)(["db:setItem:Error ",""]);return b=function(){return e},e}function A(){var e=(0,i.default)(["openDB failed: ",""]);return A=function(){return e},e}var C={ERROR:"error",OPENING:"opening",BLOCKED:"blocked",OPEN:"open",CLOSED:"closed",FAILED:"failed"},P=!1,O=null;function w(){this.initializeStorage(),this._dbName="wawc",this._db=new o.default(this._dbName),this._db.on("versionchange",(e=>{e&&null!=e.newVersion&&e.newVersion!==e.oldVersion&&(P=!0,O&&O())})),this._db.version(1).stores({logs:"line,log"}),this._db.version(2).stores({logs:"line,log",assets:"key,hash,data"}),this._db.version(3).stores({logs:"line,log",assets:"key,hash,data",wam:",buffer,prevValues,lastSend"}),this._db.version(4).stores({logs:"line,log",assets:"key,hash,data",wam:",key,buffer",l10n:"key,hash,t"}).upgrade((function(e){e.wam.toCollection().modify((function(e){e.key=e.lastSend,delete e.prevValues,delete e.lastSend}))})),this._db.version(5).stores({logs:"line,log",assets:null,wam:",key,buffer",l10n:"key,hash,t"}),this._db.version(6).stores({logs:"line,log,timestamp",wam:",key,buffer",l10n:"key,hash,t"}).upgrade((e=>{e.logs.toCollection().count().then((()=>{e.logs.toCollection().modify((e=>{var{log:t}=e;e.timestamp=1e3*(0,u.default)(t.slice(5,28),"YYYY-MM-DD HH:mm:ss.SSS").unix()}))}))})),this._db.version(7).stores({logs:"line,log,timestamp",wam:",key,buffer",l10n:"key,hash,t",user:"key"}),this.openAttempt=0,this.openDB().catch((e=>{__LOG__(3)(A(),e)})),this._dbState=C.OPENING}class M{constructor(){this.dataStore={}}setItem(e,t){this.dataStore[e]=t,null!=d.default&&d.default.setItem(e,t),r(77771).default.idb().then((r=>r.user.put({key:e,value:t}))).catch((e=>{__LOG__(3)(b(),e)}))}getItem(e,t=!1){if(void 0===this.dataStore[e]||t){if(null!=d.default){var r=d.default.getItem(e);return null!=r&&this.setItem(e,r),r}return null}return this.dataStore[e]}removeItem(e){delete this.dataStore[e],null!=d.default&&d.default.removeItem(e),r(77771).default.idb().then((t=>t.user.delete(e))).catch((e=>{__LOG__(3)(T(),e)}))}clear(e){var t=this;return(0,n.default)((function*(){t.dataStore={},null!=d.default&&(d.default.clear(),e&&(0,s.default)(e,(function(e,t){d.default.setItem(t,e)})));var a=r(77771).default;yield a.idb().then((e=>e.user.clear())).catch((e=>{__LOG__(3)(S(),e)}))}))()}}w.prototype.initializeStorage=function(){this.temporaryStorage=this._hasSessionStorage()?{dataStore:{},setItem:function(e,t){this.dataStore[e]=t,(0,f.default)(p.default,"sessionStorage").setItem(e,t)},getItem:function(e,t=!1){return null==this.dataStore[e]||t?(0,f.default)(p.default,"sessionStorage").getItem(e):this.dataStore[e]},removeItem:function(e){delete this.dataStore[e],(0,f.default)(p.default,"sessionStorage").removeItem(e)},clear:function(){return this.dataStore={},(0,f.default)(p.default,"sessionStorage").clear(),Promise.resolve()}}:{dataStore:{},setItem:function(e,t){this.dataStore[e]=t},getItem:function(e){return void 0===this.dataStore[e]?null:this.dataStore[e]},removeItem:function(e){delete this.dataStore[e]},clear:function(){return this.dataStore={},Promise.resolve()}},this.permanentStorage=new M},w.prototype._hasSessionStorage=function(){try{var e=(0,f.default)(p.default,"sessionStorage");return e.setItem(l.default.KEY_STORAGE_TEST,l.default.KEY_STORAGE_TEST),(0,h.isFunction)(e.clear)}catch(e){return!1}},w.prototype.loadUserIdb=function(){return this.idb().then((e=>e.transaction("rw",e.user,(()=>e.user.toArray().then((e=>e.forEach((e=>{this.permanentStorage.dataStore[e.key]=e.value})))))))).catch((e=>{__LOG__(3)(y(),e)}))},w.prototype.openDB=function(){this._db.isOpen()&&this._db.close();var e=Promise.resolve(this._db.open()).timeout(1e4).then((()=>(__LOG__(2)(E()),new c.default.WebcDbOpen({webcDbName:this._dbName,webcDbOpenWasSuccess:!0,webcDbOpenNumAttempts:this.openAttempt}).commit(),this._dbState=C.OPEN,C.OPEN))).catchType(Promise.TimeoutError,(()=>(__LOG__(2)(v()),new c.default.WebcDbOpen({webcDbName:this._dbName,webcDbOpenWasSuccess:!1,webcDbOpenNumAttempts:this.openAttempt}).commit(),this._dbState=C.BLOCKED,C.BLOCKED))).catch((e=>(__LOG__(3)(g(),e),this.openAttempt>1||_.default.isSafari?(this.opening=void 0,this._dbState=C.ERROR,new c.default.WebcDbOpen({webcDbName:this._dbName,webcDbOpenWasSuccess:!1,webcDbOpenNumAttempts:this.openAttempt}).commit(),Promise.reject(C.ERROR)):(this.openAttempt+=1,this._db.delete().catch((e=>(__LOG__(3)(m(),e),this.opening=void 0,this._dbState=C.ERROR,Promise.reject(C.ERROR)))).then((()=>this.openDB())))))).then((e=>(this.opening=void 0,e===C.BLOCKED?Promise.reject(C.BLOCKED):this._db)));return this.opening||(this.opening=e),e},w.prototype.idb=function(){return this._db.isOpen()?Promise.resolve(this._db):this._db.hasFailed()?Promise.reject(C.FAILED):this._dbState===C.BLOCKED?Promise.reject(C.BLOCKED):this.opening?this.opening:Promise.reject(C.CLOSED)},w.prototype.onVersionChange=function(e){O=e,P&&O()},w.prototype.State=C;var I=new w;t.default=I},72291:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.DB_ENCRYPTION_CIPHER=t.ENC_KEY_TTL=t.ENC_KEY_TABLE_NAME=t.ENC_KEY_DB_NAME=void 0;var i=n(r(19976)),s=n(r(70417)),o=n(r(52954)),u=n(r(77715)),l=a(r(96452)),d=r(52137),c=r(60339),f=r(71684),p=n(r(47677));function h(){var e=(0,i.default)(["Base ftsHMACKey is null in _generateFinalFtsHmacKey"]);return h=function(){return e},e}var _=r(41449).Z,m="wawc_db_enc";t.ENC_KEY_DB_NAME=m;var g="keys";t.ENC_KEY_TABLE_NAME=g;var v={name:"HKDF"},E={hash:"SHA-256"},y=4*f.WEEK_MILLISECONDS*24;t.ENC_KEY_TTL=y;var S="fts_hmac_keys",T="AES-CBC";t.DB_ENCRYPTION_CIPHER=T;function b(){var e=new Uint8Array(128);return self.crypto.getRandomValues(e),self.crypto.subtle.importKey("raw",e,v,!1,["deriveKey"])}var A=new class{constructor(){var e=this;this._waitUntilFinalDbEncKeyReady=new d.Resolvable,this._waitUntilFinalFtsHmacKeyReady=new d.Resolvable,this._getOrUpdateEncKeys=e=>this._getDbOrThrow().keys.orderBy("id").toArray().then((t=>{if(!t||0===t.length)return this._addNewEncKey(e);var r=t[t.length-1]._expiration;if(null!=r&&r<=(new Date).getTime())return this._addNewEncKey(e);this._ephemeralLocalEncSalt=e;var a=t.map(function(){var t=(0,o.default)((function*(t){var r=yield self.crypto.subtle.deriveKey((0,s.default)((0,s.default)((0,s.default)({},v),E),{},{salt:e,info:new Uint8Array(1)}),t.key,{name:T,length:128},!1,["encrypt","decrypt"]);return(0,s.default)((0,s.default)({},t),{},{key:r})}));return function(){return t.apply(this,arguments)}}());return Promise.all(a).then((e=>{this._keys=e}))})),this._getOrUpdateFtsKey=()=>this._getDbOrThrow().fts_hmac_keys.orderBy("id").toArray().then((e=>{if(!e||0===e.length)return this._addNewFtsHMACKey();if(e.length>1)throw new l.DBInvalidFtsHMACKey;this._ftsHMACKey=e[e.length-1]})),this._addNewEncKey=e=>b().then((t=>this._getDbOrThrow().keys.add({key:t,_expiration:(new Date).getTime()+y}).then((()=>this._getOrUpdateEncKeys(e))))),this._addNewFtsHMACKey=()=>b().then((e=>this._getDbOrThrow().fts_hmac_keys.add({key:e}).then((()=>this._getOrUpdateFtsKey())))),this.generateFinalDbEncryptionAndFtsKey=e=>{var t=(0,c.decodeB64)(e);return this._generateFinalFtsHmacKey(t),this._generateFinalDbMsgEncryptionKey(t),Promise.resolve()},this._generateFinalDbMsgEncryptionKey=t=>this._getDbOrThrow().keys.orderBy("id").toArray().then((r=>{var a=r.map(function(){var r=(0,o.default)((function*(r){var a;(0,p.default)(null!=e._ephemeralLocalEncSalt,"DB msg encryption key faiiled due to _ephemeralLocalEncSalt");try{a=yield self.crypto.subtle.deriveKey((0,s.default)((0,s.default)((0,s.default)({},v),E),{},{salt:t,info:new Uint8Array(e._ephemeralLocalEncSalt||0)}),r.key,{name:T,length:128},!1,["encrypt","decrypt"])}catch(t){throw e._ephemeralLocalEncSalt=null,t}return(0,s.default)((0,s.default)({},r),{},{key:a})}));return function(){return r.apply(this,arguments)}}());return Promise.all(a).then((e=>{this._ephemeralLocalEncSalt=null,this._finalDbMsgEncKeys=e,this._waitUntilFinalDbEncKeyReady.resolve()}))})).finally((()=>{this._ephemeralLocalEncSalt=null})),this._generateFinalFtsHmacKey=function(){var t=(0,o.default)((function*(t){if(!e._ftsHMACKey||null==e._ftsHMACKey.key||null==e._ftsHMACKey.id)throw __LOG__(2)(h()),new l.DBInvalidFtsHMACKey;var[r,a]=[e._ftsHMACKey.id,e._ftsHMACKey.key],n=yield self.crypto.subtle.deriveKey((0,s.default)((0,s.default)((0,s.default)({},v),E),{},{salt:t,info:new Uint8Array(0)}),a,{name:"HMAC",hash:"SHA-1"},!1,["sign"]);e._finalFtsHmacKey={id:r,key:n},e._waitUntilFinalFtsHmacKeyReady.resolve()}));return function(){return t.apply(this,arguments)}}()}init(e){if(this._db)return _.resolve();this._db=new u.default(m),this._getDbOrThrow().version(1).stores({[g]:"++id, _expirtation",[S]:"++id"});var t=e.buffer.slice(e.byteOffset,e.byteLength+e.byteOffset);return _.resolve(this._getDbOrThrow().open()).then((()=>Promise.all([this._getOrUpdateEncKeys(t),this._getOrUpdateFtsKey()])))}_getDbOrThrow(){if(null==this._db)throw new Error("[db_encryption_key] db is not initialized");return this._db}deleteKeys(){return Promise.all([this._getDbOrThrow().table(g).clear(),this._getDbOrThrow().table(S).clear()]).then((()=>{})).finally((()=>(this._db=null,_.resolve(u.default.delete(m)).catch((()=>u.default.delete(m))))))}deleteKeyCache(){this._keys=null,this._ftsHMACKey=null,this._finalDbMsgEncKeys=null,this._waitUntilFinalDbEncKeyReady=new d.Resolvable,this._waitUntilFinalFtsHmacKeyReady=new d.Resolvable,this._finalFtsHmacKey=null,this._ephemeralLocalEncSalt=null}waitForFinalDbMsgEncKey(){return this._waitUntilFinalDbEncKeyReady.promise}waitForFinalFtsHmacKey(){return this._waitUntilFinalFtsHmacKeyReady.promise}get encKeys(){if(!this._keys)throw new l.DbEncKeyNotLoaded(g);return this._keys}get dbMsgEncKeys(){if(!this._finalDbMsgEncKeys)throw new l.DbMsgEncKeyNotLoaded(g);return this._finalDbMsgEncKeys}get ftsHMACKey(){if(!this._finalFtsHmacKey)throw new l.DbEncKeyNotLoaded(S);return this._finalFtsHmacKey}};t.default=A},61846:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function e(t,r,a){r(t).forEach((t=>e(t,r,a))),a(t)}},45090:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=function(e){if(null==e)return l();if(!(e instanceof Promise))return e;var t=new i.default;e.isFulfilled()||e.isRejected()?t.abort():e.catch((()=>{})).then((()=>{t.abort()}));return t.signal}(e&&e.signal);return new Promise(((e,r)=>{var a,n,i;t.aborted?r(new s.default):(o.push(d),t.addEventListener("abort",c),1===o.length&&(i=requestAnimationFrame((()=>{n=setTimeout((()=>{u()}),0)})),a=()=>{cancelAnimationFrame(i),clearTimeout(n)}));function l(){t.removeEventListener("abort",c);var e=o.indexOf(d);-1!==e&&o.splice(e,1),0===o.length&&null!=a&&(a(),a=null)}function d(){l(),e()}function c(){l(),r(new s.default)}}))},t.resolveAllForTestingOnly=void 0;var n=a(r(25291)),i=a(r(12489)),s=a(r(8701)),o=[];function u(){for(;o.length>0;){o.shift()()}}t.resolveAllForTestingOnly=()=>(u(),Promise.resolve());var l=(0,n.default)((()=>(new i.default).signal))},78711:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.enrich=function(e,t){var r;switch((0,i.previewType)(t)){case"pdf":r=u(e);break;case"msoffice":r=Promise.resolve();break;default:r=Promise.resolve()}return r.timeout(3e3,"Document enrichment timeout").catch((()=>null))},t.enrichPdf=u;var n=a(r(19976)),i=r(41501),s=a(r(75897));function o(){var e=(0,n.default)(["pdf preview generation failed"]);return o=function(){return e},e}function u(e){var t;return s.default.fileToPdf(e).then((e=>(t=e,s.default.pdfToImg(e,1)))).catch((()=>(__LOG__(2)(o()),null))).finally((()=>{t&&s.default.releasePdf(t)}))}},77501:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,n.default)(e.replace(/^data-/,""))};var n=a(r(96009))},27428:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return e instanceof HTMLElement&&e.tagName.toLowerCase()===t.toLowerCase()}},61439:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(!(e instanceof HTMLElement))return!1;return r.call(e,t)};var r=Element.prototype.matches||Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector},16929:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return Boolean(e&&3===e.nodeType)}},80965:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){if(e.collapsed)return[];if(e.startContainer===e.endContainer)return(0,i.default)(e.startContainer)?[e.startContainer]:Array.prototype.slice.call(e.startContainer.childNodes,e.startOffset,e.endOffset);var t,r,a=e.commonAncestorContainer.childNodes;t=e.commonAncestorContainer===e.startContainer?a[0]:s(e.commonAncestorContainer,e.startContainer);(0,n.default)(t,"range is invalid: start missing"),r=e.commonAncestorContainer===e.endContainer?a[a.length-1]:s(e.commonAncestorContainer,e.endContainer);(0,n.default)(r,"range is invalid: end missing");var o=r,u=e=>e&&e.nextSibling,l=[],d=t;for(;d&&d!==o;)l.push(d),d=u(d)||u(d.parentNode);return l.push(o),l};var n=a(r(47677)),i=a(r(16929));function s(e,t){for(var r=t;r.parentNode!==e;){if(!r.parentNode)return null;r=r.parentNode}return r}},56117:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r={LOW:"low",HIGH:"high"},a=window.matchMedia("\n    only screen and (-webkit-min-device-pixel-ratio: 2),\n    only screen and (min-device-pixel-ratio: 2),\n    only screen and (min-resolution: 2dppx)\n"),n={RES:r,currentRes:a.matches?r.HIGH:r.LOW};a.addListener((function(e){var t=e.matches?r.HIGH:r.LOW;if(t!==n.currentRes){n.currentRes=t;var a=document.createEvent("Event");a.initEvent("dpichange",!0,!0),window.dispatchEvent(a)}}));var i=n;t.default=i},44243:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(96009)),i=a(r(15253)),s=a(r(16760)),o=a(r(74930));t.default=class{constructor(e){this.rules={},this.styleSheet=this.createStyleSheet(e)}createStyleSheet(e){var t=e||(0,o.default)("dynamic-style-"),r=document.createElement("style");return r.id=t,r.type="text/css",document.head&&document.head.appendChild(r),r=r.sheet}addRule(e,t){var r=this.styleSheet.cssRules.length,a=(0,s.default)(t,((e,t)=>"".concat(t,": ").concat(e,";"))).join(" ");return this.styleSheet.insertRule("".concat(e," { ").concat(a," }"),r),this.rules[e]=this.styleSheet.cssRules[r],this.rules[e]}updateRule(e,t){var r=this.rules[e];return(0,i.default)(t,((e,t)=>{r.style[(0,n.default)(t)]=e})),r}setRule(e,t){return this.rules[e]?this.updateRule(e,t):this.addRule(e,t)}}},79094:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return s(null,i.default.fromForwardsStrings(e.sort(((e,t)=>t.length-e.length)).map((e=>"".concat(e).concat(o)))),null,0)};var n=a(r(89166)),i=a(r(75688));function s(e,t,r,a,i){var l=[],d=!1,c=i;null==c&&(e&&1===a?u.has(e)&&(c=!0):e&&r&&2===a&&(c=u.has(r+e)));t.getChildren().forEach((t=>{t.prefix!==o?l.push(s(t.prefix,t.node,e,a+1,c)):d=!0}));var f=""!==e||null==r||c?(0,n.default)(e||""):"?",p=0===l.length?"":"(?:".concat(l.join("|"),")");return p&&d&&(p+="?"),"".concat(f).concat(p)}var o="\n",u=new Set(["","","","","",""])},27703:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.HEART_EMOJIS=t.VARIATION_CATEGORY=t.CATEGORY_ORDERING=t.LARGE_EMOJI_SIZE=t.EMOJI_WIDTH=t.EMOJI_TYPE=void 0;var n=a(r(50935)),{EMOJI:{ORDERED_CATEGORY_IDS:i}}=n.default;t.EMOJI_TYPE={APPLE:"APPLE",WHATSAPP:"WHATSAPP"};t.EMOJI_WIDTH={small:20,large:32};var s=r(28103).Mirrored(["MEDIUM","LARGE","XLARGE"]);t.LARGE_EMOJI_SIZE=s;var o=[...i,"VARIATION"];t.CATEGORY_ORDERING=o;var u=o.indexOf("VARIATION");t.VARIATION_CATEGORY=u;t.HEART_EMOJIS=["","","","","","","","","","","","","",""]},70201:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={APPLE:["1d5e731","529580c","d5735d4","3964227","60856da","fcef0ee","8e3414f","50659eb","8b6c76f","3b3d6b8","54fa2d7","0f873e5","83c57e6","54d4a36","05f819b","08b10df","1eda693","24f071f","43c7f1e","4673bc1","ad8e7a0","3b84c7f","47138e6","f7cf586","4609a68","eafe075","9fca360","4ff00ff","0e91b1d","958420b","194fdde","6c4a311","2c0b6d6","3b923f5","95f9182","f0b652b","5eef5f5","e2d60bb","3eb3a31","9b46eb8","e02b8ca","ccdb9d0","0204c19","e00c36f","59e20f3","585516e","3dfd1eb","265211d","44410d4","1937682","00b6dfb","c7b2566","b5308c2","3726c3f","32e0b8a","c70c8c9","929723c","3f5711a","7acb2c4","094645b","7d3f66d","e5962c7","ae792a7","76de187","bb980fd","2ec44f0","0cd59e3","1f800d7","969aa1f","20e8b4c","4fdae5e","ed4ad5f","5d67f78","9530353","5caffb3","59682ab","27b2426","b3a1edd","ab61b6f","ef4f27f","19e3281","14f4ada","70cf125","f408ea6","43ac328","c8c0ba6","39f813e","7cc745e","ce99005","4930013","d7a4068","7a46e3b","0c9c29f","56bf54b","17ac67d","dd192f7","c812d02","813dbc5","23c9c52","435e976","2bbd0df","625aadb","b9222f6","da65d5f","06ed4e2","ee050c5","9945226","84e64af","1696d42","d0e076e","cebbc40","61d3b8d","57d59fb","654bb14","f8c09c1","e52c442","7bf95b0","250df50","7dbc57b","298d700","4886b3a","640c1b4","b4254db","42b05a6","c0b44e2","024aeae","48b76e4","e06653f","70c4701","451b05c","37dc131","5a6cd0e","10fb6f0"],WHATSAPP:["275ab2d","2daeeb8","2224eba","0b9fe45","17c7395","a55d276","72434c2","1dd3846","c010a8c","ea9208b","3789cf9","1dcf7fa","6158b5d","01fd086","acc727e","6193968","17db773","bc40265","a4c2a1b","3ef52a3","2543ee4","ca1f104","4e1c931","c3a2f48","07cf04f","8b61961","9745348","5038cd6","7749b45","71b967c","45e7af0","c9cf572","c9bf2df","83cde5f","613025d","865dd57","e14a64a","4042dd6","8eab52b","91915f2","815b7ef","f8e0fb5","74b6b53","ac288a6","59306d9","f76ad56","f31dda5","2cdd785","8016aef","5df7b0d","22d0178","8c0c7e3","c32047b","b67ba4c","11629aa","33d67ff","84811ea","cfe754f","702917c","b2d2eb4","7d099c5","e09e035","741bdfc","33f9a55","279c1fa","a4d0c95","7b9ccb6","c817f7b","8c06d9c","7ebc665","a4fae04","54098a2","0a997bf","c65e655","0b02db6","59ecb60","53e46d5","6767439","22df2e4","ba186c8","6163a99","58bc633","a1b8d2e","02a99d5","c952246","eb4b44f","359629e","ea498fd","46e372a","3341cbb","204cc1a","b8ae509","b4cb2c1","6f6f3ee","9208a05","b5ed726","2199bf0","cf22dae","dd9c307","761ba89","9ed7247","02e2a9d","4cf10ee","c9ad573","43a26e5","38760e0","24e2ebd","da05a9f","4331754","b8bad41","34566f5","8449706","a0ee6b0","0d0dbc3","1ebbe36","dc97ce2","ca7d8e1","753afda","4663f0e","2e20ac0","a69f27b","b47fa5e"]}},70270:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,r){var a="large"===r?"40":"64";return{low:d("".concat(t,"-").concat(a,".png"),e.toLowerCase()),high:d("".concat(t,"-64.png"),e.toLowerCase())}},t.getEmojiSpritesPath=function(e,t,r,a){var n=(0,o.default)(s.default[e][t],"emojiSpriteHashes[emojiType][bucketId]");return"".concat(l,"/emoji-").concat(t,"-").concat(r,"_").concat(n,".").concat(a)};var n=a(r(50935)),i=r(215),s=a(r(70201)),o=a(r(61941)),{EMOJI:{LARGE_EMOJI_BASE_PATH:u,EMOJI_SPRITES_BASE_PATH:l}}=n.default;function d(e,t){return"".concat(u,"/").concat(i.prefixHash,"_").concat(t.slice(0,1),"_").concat(e)}},12396:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.isBaseCoupleEmoji=function(e){return y.includes(e)},t.default=t.getPermutations=void 0;var n=a(r(45861)),i=a(r(30733)),s=a(r(72779)),o=a(r(47677)),u=a(r(3169)),l=a(r(79094)),d=a(r(50935)),c=r(27703),f=a(r(70270)),p=a(r(61941)),h=a(r(23111)),_=a(r(19705)),m="",g=["","","","",""],v=new RegExp(g.join("|"),"g"),E=d.default.EMOJI.BUCKET_SIZE,y=["","","",""],S=c.HEART_EMOJIS.map((e=>e)),T=new Set(["","","","","","","","","","","","","","","",""]),b=e=>e.replace(/\uFE0F/g,""),A=(0,i.default)(((e,t)=>function r(a=[]){if(a.length===t)return[a];for(var n=[],i=0;i<e.length;i++){var s=[...a];s.push(e[i]),n=n.concat(r(s))}return n}()),((e,t)=>e.toString()+t));t.getPermutations=A;function C(e){return e.every((t=>t===e[0]))?e[0]:e.join("")}var P=new class{constructor(){var e=this;this.skinToneVariations=g,this._specialEmojiRegex=null,this.emojiRegex=()=>{var e=this._createEmojiRegexIfNeeded();return e.lastIndex=0,e},this._createEmojiRegexIfNeeded=(0,h.default)((()=>{var e=this._getEmojiRegexSource();return new RegExp("("+e+")","g")})),this.onlyEmojiRegex=()=>{var e=this._createOnlyEmojiRegexIfNeeded();return e.lastIndex=0,e},this._createOnlyEmojiRegexIfNeeded=(0,h.default)((()=>{var e=this._getEmojiRegexSource();return new RegExp("^("+e+")+$","g")})),this.convertToTextWithoutSpecialEmojis=e=>{if(!this._specialEmojiRegex){var t=(0,l.default)(Object.keys(_.default));this._specialEmojiRegex=new RegExp("(".concat(t,")"),"g")}return this._specialEmojiRegex.lastIndex=0,e.replace(this._specialEmojiRegex,(e=>_.default[e]))},this.splitEmojis=e=>!1===this.containsOnlyEmoji(e)?null:e.split(this.emojiRegex()).filter(Boolean),this.containsEmoji=e=>this.emojiRegex().test(e),this.containsOnlyEmoji=e=>this.onlyEmojiRegex().test(e),this.matchLargeEmojiPattern=e=>{if(e.length>50||e.includes(" "))return null;var t=this._getLargeEmojisRegex().exec(e);return t?t.filter(Boolean).slice(1):null},this.normalizeEmojiFromString=e=>this.normalizeEmoji(e),this.normalizeEmoji=e=>{var t=b(e),{unqualifiedToNormalizedEmoji:r}=this._getDerivedMaps();return r.get(t)},this.normalizeAllEmojis=(0,i.default)((e=>e?e.replace(this.emojiRegex(),((e,t)=>{var r;return T.has(t)?"":null!==(r=this.normalizeEmoji(t))&&void 0!==r?r:""})):"")),this.getSkinToneVariant=(e,t)=>{var r=this._getBaseToSkinToneEmojis().get(e);if(null==r)return null;var a=C(t);return r.get(a)},this._getDerivedMaps=(0,h.default)((()=>{var{orderedEmojis:e,legacyToEmoji:t}=this._getConfig(),r=new Map,a=new Map,i=new Map,s=0;return e.forEach(((e,t)=>{""!==e&&null!=e&&((Array.isArray(e)?e:[e]).forEach((e=>{a.set(e,t);var r=b(e);i.set(r,e)})),r.set(t,s),s++)})),(0,n.default)(t).forEach((([e,t])=>{a.set(e,t);var r=b(e);i.set(r,e)})),{emojiToGlyphId:a,glyphIdToIndex:r,unqualifiedToNormalizedEmoji:i}})),this._getBaseToSkinToneEmojis=(0,h.default)((()=>{var{emojiToGlyphId:t}=this._getDerivedMaps(),r=new Map,a=function(t){var a=void 0,n=t.replace(v,(e=>(null==a&&(a=[]),a.push(e),"")));if(null==a)return"continue";var i=a,s=void 0;s=n==="".concat(m,"").concat(m,"")?"":n==="".concat(m,"").concat(m,"")?"":n==="".concat(m,"").concat(m,"")?"":n;var o=e.normalizeEmoji(s);if(null==o)return"continue";var u=r.get(o);null==u&&((u=new Map).set("",o),r.set(o,u));var l=C(i);u.set(l,t)};for(var n of t.keys())a(n);return r})),this._getSkinToneEmojisToBase=(0,h.default)((()=>{var e=new Map;for(var[t,r]of this._getBaseToSkinToneEmojis().entries())for(var a of r.values())e.set(a,t);return e})),this._getEmojiRegexSource=(0,h.default)((()=>{var{emojiToGlyphId:e}=this._getDerivedMaps();return(0,l.default)([...e.keys(),...T].filter(Boolean))})),this._createLargeEmojisRegexIfNeeded=(0,h.default)((()=>{var e=this._getEmojiRegexSource();return new RegExp("^(".concat(e,")(").concat(e,")?(").concat(e,")?$"))})),this.getEmojisInCategory=e=>{var t;return null!==(t=this._getConfig().categorizedEmojis[e])&&void 0!==t?t:[]},this._getEmojiToCategory=(0,h.default)((()=>{var{categorizedEmojis:e}=this._getConfig(),t=new Map;return Object.keys(e).forEach((r=>{var a=c.CATEGORY_ORDERING.indexOf(r);e[r].forEach((e=>{var r=this.normalizeEmoji(e);null!=r&&t.set(r,a)}))})),t})),this.getGlyphId=e=>{var t=this.normalizeEmoji(e);if(null==t)return null;var{emojiToGlyphId:r}=this._getDerivedMaps();return r.get(t)},this.getGlyphPath=(e,t)=>(0,f.default)(this._getConfig().emojiType,e,t),this.isGlyphCached=e=>{var t=this._getGlyphIndex(e);return this._getCachedGlyphs().get(t)},this.markGlyphCached=e=>{var t=this._getGlyphIndex(e);this._getCachedGlyphs().set(t)},this._getCachedGlyphs=(0,h.default)((()=>new u.default(this._getGlyphCount()))),this.getCssClasses=(e,t="small")=>(0,s.default)("b".concat(this.getBucket(e)),"small"===t?"emoji":"emojik",this._getConfig().emojiType===c.EMOJI_TYPE.APPLE?"apple":"wa"),this.getStyle=(e,t="small")=>{var{xpos:r,ypos:a}=this._getCoordinates(e,t);return{backgroundPosition:"-".concat(r,"px -").concat(a,"px")}},this.getBucket=e=>{var t=this._getGlyphIndex(e),r=Math.floor(t/E);return"".concat(r)},this.getHeartEmojis=(0,h.default)((()=>S.map(this.normalizeEmoji).filter(Boolean))),this._getLastBucketId=(0,h.default)((()=>{var e=this._getGlyphCount();return e-e%E})),this._getLastBucketCols=(0,h.default)((()=>Math.floor(Math.sqrt(this._getGlyphCount()-this._getLastBucketId()))))}configure(e){e!==this._config&&(this._config=e,this.getHeartEmojis.reset(),this._specialEmojiRegex=null,this._createEmojiRegexIfNeeded.reset(),this._createLargeEmojisRegexIfNeeded.reset(),this._createOnlyEmojiRegexIfNeeded.reset(),this._getEmojiRegexSource.reset(),this._getCachedGlyphs.reset(),this._getSkinToneEmojisToBase.reset(),this._getBaseToSkinToneEmojis.reset(),this._getEmojiToCategory.reset(),this._getLastBucketId.reset(),this._getLastBucketCols.reset(),this._getDerivedMaps.reset())}_getConfig(){return(0,o.default)(null!=this._config,"Attempt to use EmojiUtil before it's been configured"),this._config}isEmoji(e){return null!=this.normalizeEmoji(e)}getSkinToneBase(e){var t,r=this.normalizeEmoji(e);return null==r?null:null!==(t=this._getSkinToneEmojisToBase().get(r))&&void 0!==t?t:null}_getLargeEmojisRegex(){var e=this._createLargeEmojisRegexIfNeeded();return e.lastIndex=0,e}_getGlyphCount(){var{glyphIdToIndex:e}=this._getDerivedMaps();return e.size}_getCoordinates(e,t){var r=this._getGlyphIndex(e),a=r%E,n=r>=this._getLastBucketId()?this._getLastBucketCols():Math.floor(Math.sqrt(E)),i=c.EMOJI_WIDTH[t],s=Math.floor(a/n);return{xpos:Math.floor(a%n)*i,ypos:s*i,width:i}}_getGlyphIndex(e){var{glyphIdToIndex:t}=this._getDerivedMaps();return(0,p.default)(t.get(e),"glyphIdToIndex.get(glyphId)")}};t.default=P},66870:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.initEncSalt=function(){return d.apply(this,arguments)},t.initEncSaltForInvoker=function(){return c.apply(this,arguments)},t.generateFinalDbEncryptionAndFtsKeyForInvoker=function(e){return(0,o.get)().generateFinalDbEncryptionAndFtsKey(e)},t.deleteEncKeysAndCache=function(){var e;return Promise.all([null===(e=n)||void 0===e?void 0:e.deleteKeys(),(0,o.get)().deleteDbEncKeyCache()]).then((()=>{}))};var n,i=a(r(52954)),s=r(35011),o=r(29458),u=a(r(79711));n=r(72291).default;var l=null;function d(){return(d=(0,i.default)((function*(){var e;null==l&&(l=(0,s.getOrGenSalt)());var t=yield l;if(t&&t.constructor===Uint8Array)return null===(e=n)||void 0===e?void 0:e.init(t)}))).apply(this,arguments)}function c(){return(c=(0,i.default)((function*(){null==l&&(l=(0,s.getOrGenSalt)());var e=yield l;e&&e.constructor===Uint8Array&&(0,o.get)().initDatabaseEncnKey(e)}))).apply(this,arguments)}u.default.on("logout",(()=>{l=Promise.resolve(null)}))},35011:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.getOrGenSalt=function(){var e=!!(0,i.getMaybeMeUser)(),t=null;e||(t=new Uint8Array(128),self.crypto.getRandomValues(t),t=btoa(String.fromCharCode(...new Uint8Array(t))),(0,s.setWebEncSalt)(t));null==(t=(0,s.getWebEncSalt)())&&(__LOG__(4,void 0,new Error)(u()),o.default.logout());return t=Uint8Array.from(atob(t),(e=>e.charCodeAt(0))),Promise.resolve(t)},t.deleteSalt=function(){(0,s.setWebEncSalt)(null)};var n=a(r(19976)),i=r(95595),s=r(39174),o=a(r(12767));function u(){var e=(0,n.default)(["[DB ENC CRITICAL ERROR] null returned for local enc salt"]);return u=function(){return e},e}},58187:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.decodeBroadcastEphemeralSetting=function(e,t,r,l,d){var c=e.toString({legacy:!0}),f=t.toString({legacy:!0}),p=r.toString({legacy:!0}),h="Ephemeral ".concat(f," ").concat(c),_=n.Binary.build(h).readByteArray(),m=new Uint8Array(d),g=(0,i.decodeB64)(l),v=n.Binary.build(p).readBuffer();return function(e,t){return self.crypto.subtle.importKey("raw",e,"HKDF",!1,["deriveKey"]).then((e=>self.crypto.subtle.deriveKey({name:"HKDF",hash:"SHA-256",salt:u,info:t},e,{name:"HMAC",hash:"SHA-256"},!0,["verify"]))).then((e=>self.crypto.subtle.exportKey("raw",e)))}(m,_).then((e=>function(e,t,r){var a=e.slice(0,12),n=e.slice(12,44);return self.crypto.subtle.importKey("raw",n,"AES-GCM",!1,["decrypt"]).then((e=>self.crypto.subtle.decrypt({name:"AES-GCM",iv:new Uint8Array(a),additionalData:r},e,t)))}(e,g,v))).then((e=>{var{duration:t,timestamp:r}=(0,a.decodeProto)(o.EphemeralSettingSpec,e);return null==t||null==r?Promise.reject(new Error("ephSetting decoded into malformed proto")):{ephemeralDuration:t,ephemeralSettingTimestamp:(0,s.castLongIntToUnixTime)(r)}}))};var a=r(84139),n=r(46378),i=r(60339),s=r(71684),o=r(92214),u=new Uint8Array(32)},74404:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.generateEphemeralSystemMessage=function(e,t){if(n.default.supportsFeature(n.default.F.MD_BACKEND)){var a=r(39778).handleSingleMsgMD,d={id:new u.default({id:(0,l.default)(),remote:e.id,fromMe:!1}),from:e.id,to:(0,o.getMaybeMeUser)(),t:i.default.globalUnixTime(),type:s.default.MSG_TYPE.PROTOCOL,subtype:"ephemeral_setting",ephemeralDuration:t,isNewMsg:!0};a(e.id,d)}};var n=a(r(18120)),i=a(r(19899)),s=a(r(50935)),o=r(95595),u=a(r(77865)),l=a(r(49213))},27853:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getEphemeralExpirationTimestamp=function(e,t,r,a,n){if("ephemeral_setting"===a)return null;if(null==e||0===e)return null;if(n&&null!=t)return t+e;return r+e}},38822:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.isEphemeralDurationAllowed=function(e){return!(e<0)&&(0===e||n.default.getEphemeralMessagesAllowedValues().includes(e))};var n=a(r(72424))},44989:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.shouldUpdateEphemeralSetting=function(e){var{oldDuration:t,oldSettingTimestamp:r,newDuration:n,newSettingTimestamp:i,chatId:s}=e;return i>r||!(i<r)&&(t!==n&&!(0,a.getMaybeMeUser)().isLessThan(s))};var a=r(95595)},25353:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return i.apply(this,arguments)};var n=a(r(52954));function i(){return(i=(0,n.default)((function*(){var e=navigator.storage;if(null==(null==e?void 0:e.estimate))return null;var{usage:t,quota:r}=yield e.estimate();return{usage:t,quota:r}}))).apply(this,arguments)}},28267:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(74930)),i=a(r(45455)),s=a(r(25291)),o=/\s+/;t.default=class{on(e,t,r){if(!t)return this;if("function"!=typeof t)throw new Error("Callback parameter passed is not a function");return this._multiEvent(this.on,...arguments)||this._getOrCreateEvents(e).push({callback:t,context:r,ctx:r||this}),this}once(e,t,r){if(!t)return this;if(this._multiEvent(this.once,...arguments))return this;var a=this,n=(0,s.default)((function(){a.off(e,n),t.apply(this,arguments)}));return n._callback=t,this.on(e,n,r)}off(e,t,r){var a=this._events;if(!a)return this;if(this._multiEvent(this.off,...arguments))return this;if(!e&&!t&&!r)return this._events=void 0,this;for(var n=e?[e]:Object.keys(a),i=0;i<n.length;i++){var s=n[i],o=a[s];if(o){if(a[s]=[],t||r)for(var u=0;u<o.length;u++){var l=o[u];(t&&t!==l.callback&&t!==l.callback._callback||r&&l.context!==r)&&a[s].push(l)}a[s].length||delete a[s]}}return this}trigger(e,...t){if(!this._events)return this;if(this._multiEvent(this.trigger,...arguments))return this;var r=this._getEvents(e),a=this._getEvents("all");return r&&this._triggerEvents(r,t),a&&this._triggerEvents(a,arguments),this}stopListening(e,t,r){var a=this._listeningTo;if(!a)return this;var n=e&&e._listenId,s=n?{[n]:e}:a;for(var o in s){var u=s[o];u.off(t,r,this),(!t&&!r||(0,i.default)(u._events))&&delete a[o]}return(0,i.default)(this._listeningTo)&&delete this._listeningTo,this}listenTo(e,t,r){return r?(this._addListeningTo(e),e.on(t,r,this),this):this}listenToOnce(e,t,r){return this._addListeningTo(e),e.once(t,r,this),this}listenToAndRun(e,t,r){return this.listenTo.apply(this,arguments),r.apply(this),this}isListening(e){var t=this._events;return!!t&&("string"==typeof e?!!t[e]:(0,i.default)(t))}_addListeningTo(e){(this._listeningTo||(this._listeningTo={}))[e._listenId||(e._listenId=(0,n.default)("l"))]=e}_getOrCreateEvents(e){var t=this._events||(this._events={});return t[e]||(t[e]=[])}_getEvents(e){if(e){var t=this._events;if(t)return t[e]}}_multiEvent(e,t,...r){if(o.test(t)){for(var a=t.split(o),n=0;n<a.length;n++)e.call(this,a[n],...r);return!0}return!1}_triggerEvents(e,t){var r,a=-1,n=e.length,i=t[0],s=t[1],o=t[2];switch(t.length){case 0:for(;++a<n;)(r=e[a]).callback.call(r.ctx);return;case 1:for(;++a<n;)(r=e[a]).callback.call(r.ctx,i);return;case 2:for(;++a<n;)(r=e[a]).callback.call(r.ctx,i,s);return;case 3:for(;++a<n;)(r=e[a]).callback.call(r.ctx,i,s,o);return;default:for(;++a<n;)(r=e[a]).callback.apply(r.ctx,t)}}bind(){return this.on(...arguments)}unbind(){return this.off(...arguments)}removeListener(){return this.off(...arguments)}removeAllListeners(){return this.off()}emit(e,...t){return this.trigger(arguments)}}},96452:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GUM=t.UnableToGetContentLengthError=t.SourceUnavailableError=t.AbortError=t.NotFoundError=t.OverconstrainedError=t.ConstraintNotSatisfiedError=t.NotAllowedError=t.NotSupportedError=t.GUMError=t.ActiveChatChanged=t.Unmount=t.ActionError=t.CanNotSendUnencrypted=t.CapabilityUnknown=t.CapabilityInvalid=t.CapabilityError=t.DeprecatedProtocolVersion=t.UpdateImmediately=t.ProtoVersionUndefined=t.DBInvalidFtsHMACKey=t.DbOnLogoutAbort=t.DbMsgEncKeyNotLoaded=t.DbEncKeyNotLoaded=t.ModelCreateError=t.ModelError=t.MediaUnsupportedError=t.MediaDragDropError=t.UnableToPlayVideoError=t.TranscodeBlobTooLargeError=t.MediaLoadError=t.MediaMissing=t.MediaNeedsReupload=t.BingServerError=t.InvalidServerResponseError=t.ServerStatusError=t.DecodeWebpResultsError=t.ImageError=t.BlockedByProxy=t.SocketNotOpen=t.SocketClosed=t.SocketError=t.MediaFileEmpty=t.MediaFileFailedLoad=t.MediaDecryptionError=t.MediaEncryptionError=t.InvalidMediaFileType=t.InvalidImageFileType=t.MediaFileError=t.CatalogImageDownloadError=t.GaveUpRetry=t.ShouldLoop=t.Offline=t.Disconnected=t.QueryDrop=t.UnimplementedMethod=void 0;var a=r(29351);class n extends((0,a.customError)("UnimplementedMethod")){}t.UnimplementedMethod=n;class i extends((0,a.customError)("QueryDrop")){}t.QueryDrop=i;class s extends((0,a.customError)("Disconnected")){}t.Disconnected=s;class o extends((0,a.customError)("Offline")){}t.Offline=o;class u extends((0,a.customError)("ShouldLoop")){}t.ShouldLoop=u;class l extends((0,a.customError)("GaveUpRetry")){}t.GaveUpRetry=l;class d extends((0,a.customError)("CatalogImageDownloadError")){}t.CatalogImageDownloadError=d;class c extends((0,a.customError)("MediaFileError")){}t.MediaFileError=c;class f extends((0,a.customError)("InvalidImageFileType",!0,c)){}t.InvalidImageFileType=f;class p extends((0,a.customError)("InvalidMediaFileType",!0,c)){}t.InvalidMediaFileType=p;class h extends((0,a.customError)("MediaEncryptionError",!0,c)){}t.MediaEncryptionError=h;class _ extends((0,a.customError)("MediaDecryptionError",!0,c)){}t.MediaDecryptionError=_;class m extends((0,a.customError)("MediaFileFailedLoad",!0,c)){}t.MediaFileFailedLoad=m;class g extends((0,a.customError)("MediaFileEmpty",!0,c)){}function v(e){try{return JSON.stringify(e)}catch(t){return e.toString()}}t.MediaFileEmpty=g;class E extends((0,a.customError)("SocketError")){constructor(e){super("string"==typeof e?e:v(e)),this.event=e}}t.SocketError=E;class y extends((0,a.customError)("SocketClosed")){constructor(e){super("string"==typeof e?e:v(e)),this.event=e}}t.SocketClosed=y;class S extends((0,a.customError)("SocketNotOpen")){constructor(e){super("socket not open, is ".concat(e))}}t.SocketNotOpen=S;class T extends((0,a.customError)("BlockedByProxy")){}t.BlockedByProxy=T;class b extends((0,a.customError)("ImageError")){constructor(e,t){super("Image failed to load."),this.src=e,this.status=t,this.target={src:e,status:t}}}t.ImageError=b;class A extends((0,a.customError)("DecodeWebpResultsError")){constructor(e,t){super(e),this.event=t}}t.DecodeWebpResultsError=A;class C extends((0,a.customError)("ServerStatusError")){constructor(e,t,r){super("".concat(e||"Server replied with a failed status code",": ").concat(r)),this.url=t,this.status=r}}t.ServerStatusError=C;class P extends((0,a.customError)("InvalidServerResponseError")){constructor(e,t,r){var a="Invalid response for ".concat(e,", with status ").concat(t);r&&(a="".concat(a,": ").concat(r)),super(a)}}t.InvalidServerResponseError=P;class O extends((0,a.customError)("BingServerError",!0,C)){constructor(e,t,r){super("Error ".concat(t," for ").concat(e,": ").concat(JSON.stringify(r)),e,t)}}t.BingServerError=O;class w extends((0,a.customError)("MediaNeedsReupload")){}t.MediaNeedsReupload=w;class M extends((0,a.customError)("MediaMissing")){}t.MediaMissing=M,M.message="Media is no longer available on your phone";class I extends((0,a.customError)("MediaLoadError")){constructor(e){super(e),this.src=e}}t.MediaLoadError=I;class R extends((0,a.customError)("TranscodeBlobTooLargeError")){constructor(){super("Transcode blob too large")}}t.TranscodeBlobTooLargeError=R;class D extends((0,a.customError)("UnableToPlayVideoError")){constructor(e){super("Unable to play video. Reason: ".concat(String(e)))}}t.UnableToPlayVideoError=D;class N extends((0,a.customError)("MediaDragDropError",!0,I)){constructor(e){super(e)}}t.MediaDragDropError=N;class L extends((0,a.customError)("MediaUnsupportedError")){}t.MediaUnsupportedError=L,L.message="Media format is unsupported";class k extends((0,a.customError)("ModelError")){}t.ModelError=k;class U extends((0,a.customError)("ModelCreateError")){constructor(e,t){super(e),this.model=t}}t.ModelCreateError=U;class F extends((0,a.customError)("DbEncKeyNotLoadedError")){constructor(e){super("MasterDatabaseEncryptionKey.".concat(e," was accessed before init"))}}t.DbEncKeyNotLoaded=F;class G extends((0,a.customError)("DbMsgEncKeyNotLoadedError")){constructor(e){super("MasterDatabaseMessageEncryptionKey.".concat(e," was accessed before init"))}}t.DbMsgEncKeyNotLoaded=G;class x extends((0,a.customError)("DbOnLogoutAbortError")){}t.DbOnLogoutAbort=x,x.message="DB operation was dropped due to logout activity";class B extends((0,a.customError)("DBExpiredFtsHMACKey")){}t.DBInvalidFtsHMACKey=B,B.message="MasterDatabaseEncryptionKey.fts_hmac_keys is in an invalid state";class Y extends((0,a.customError)("ProtoVersionUndefined")){}t.ProtoVersionUndefined=Y;class K extends((0,a.customError)("UpdateImmediately")){}t.UpdateImmediately=K;class j extends((0,a.customError)("DeprecatedProtocolVersion")){}t.DeprecatedProtocolVersion=j;class W extends((0,a.customError)("CapabilityError")){}t.CapabilityError=W;class V extends((0,a.customError)("CapabilityInvalid",!0,W)){}t.CapabilityInvalid=V;class H extends((0,a.customError)("CapabilityUnknown",!0,W)){}t.CapabilityUnknown=H;class q extends((0,a.customError)("CanNotSendUnencrypted")){}t.CanNotSendUnencrypted=q;class z extends((0,a.customError)("ActionError")){}t.ActionError=z,z.message="Could not perform action.";class J extends((0,a.customError)("Unmount")){}t.Unmount=J;class Q extends((0,a.customError)("ActiveChatChanged")){}t.ActiveChatChanged=Q;class X extends((0,a.customError)("GUMError")){}t.GUMError=X;class Z extends((0,a.customError)("NotSupportedError",!0,X)){}t.NotSupportedError=Z,Z.message="The operation is not supported.";class $ extends((0,a.customError)("NotAllowedError",!0,X)){}t.NotAllowedError=$,$.message="The user did not grant permission for the operation";class ee extends((0,a.customError)("ConstraintNotSatisfiedError",!0,X)){}t.ConstraintNotSatisfiedError=ee,ee.message="One of the mandatory Constraints could not be satisfied.";class te extends((0,a.customError)("OverconstrainedError",!0,X)){}t.OverconstrainedError=te,te.message="Due to changes in the environment, one or more mandatory constraints can no longer be satisfied.";class re extends((0,a.customError)("NotFoundError",!0,X)){}t.NotFoundError=re,re.message="The object can not be found here.";class ae extends((0,a.customError)("AbortError",!0,X)){}t.AbortError=ae,ae.message="The operation was aborted.";class ne extends((0,a.customError)("SourceUnavailableError",!0,X)){}t.SourceUnavailableError=ne,ne.message="The source of the MediaStream could not be accessed due to a hardware error (e.g. lock from another process).";class ie extends((0,a.customError)("UnableToGetContentLengthError")){}t.UnableToGetContentLengthError=ie,ie.message="Failed to get media contentLength from mms";var se={GUMError:X,NotSupportedError:Z,NotAllowedError:$,ConstraintNotSatisfiedError:ee,OverconstrainedError:te,NotFoundError:re,AbortError:ae,SourceUnavailableError:ne};t.GUM=se},95585:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.getFaqUrl=function(){return"".concat(i,"/").concat(s,"?lang=").concat(n.default.getLocale())},t.getBusinessFaqUrl=function(){return o("general/chats/about-chatting-with-businesses")},t.getCannotConnectFaqUrl=function(){return o("web/troubleshooting/cant-connect-to-whatsapp-web-or-desktop")},t.getCiphertextFaqUrl=function(){return o("general/security-and-privacy/seeing-waiting-for-this-message-this-may-take-a-while")},t.getCodeChangeFaqUrl=function(){return o("general/security-and-privacy/security-code-change-notification")},t.getMDCodeChangeFaqUrl=function(){return"".concat(i,"/").concat(n.default.getLocale(),"/").concat(s,"/26000361")},t.getE2EFaqUrl=function(){return o("general/security-and-privacy/end-to-end-encryption")},t.getE2EEnterpriseFaqUrl=function(){return o("general/security-and-privacy/end-to-end-encryption-for-business-messages")},t.getFrequentlyForwardedFaqUrl=function(){return o("general/coronavirus-product-changes/about-forwarding-limits")},t.getLoginFaqUrl=function(){return o("general/download-and-installation/how-to-log-in-or-out")},t.getNonVerifiedTransitionFaqUrl=function(){return o("general/business-account-becomes-a-standard-account")},t.getNotificationChromeFaqUrl=function(){return o("web/troubleshooting/cant-receive-notifications-on-chrome")},t.getNotificationEdgeFaqUrl=function(){return o("web/troubleshooting/cant-receive-notifications-on-microsoft-edge")},t.getNotificationFirefoxFaqUrl=function(){return o("web/troubleshooting/cant-receive-notifications-on-firefox")},t.getNotificationOperaFaqUrl=function(){return o("web/troubleshooting/cant-receive-notifications-on-opera")},t.getNotificationSafariFaqUrl=function(){return o("web/troubleshooting/cant-receive-notifications-on-safari")},t.getRevokeFaqUrl=function(){return o("web/chats/how-to-delete-messages")},t.getSuspiciousLinkFaqUrl=function(){return o("web/chats/suspicious-links")},t.getUnverifiedTransitionFaqUrl=function(){return o("general/business-account-becomes-unverified")},t.getVerifiedHighFaqUrl=function(){return o("general/verified-business-account")},t.getVerifiedLowUnknownFaqUrl=function(){return o("general/unverified-business-account")},t.getVerifiedTransitionFaqUrl=function(){return o("general/business-account-becomes-verified")},t.getEphemeralFaqUrl=function(){return o("general/chats/about-disappearing-messages")},t.getViewOnceFaqUrl=function(){return o("general/chats/about-view-once")},t.getSupportChatFaqUrl=function(){return o("general/what-information-does-whatsapp-collect-when-you-contact-support")},t.getContactFormDeviceInfoShareFaqUrl=function(){return o("general/security-and-privacy/learn-more-about-device-information")},t.PLATFORM=t.FAQ_BASE_URL=void 0;var n=a(r(17957)),i="https://faq.whatsapp.com";t.FAQ_BASE_URL=i;var s="web";function o(e){return"".concat(i,"/").concat(e,"?lang=").concat(n.default.getLocale())}t.PLATFORM=s},36455:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return r};var r=new Promise((e=>{Modernizr.on("webp",e)})).then((e=>!(!e||!e.valueOf()))).timeout(5e3).catch((()=>!1))},99888:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.blobToArrayBuffer=o,t.validateBlob=function(e){return o(e.webkitSlice?e.webkitSlice(0,1):e.slice(0,1)).then((e=>1===e.byteLength)).catch((()=>!1))},t.getAudioDuration=function(e){var t,r;return new Promise(((a,n)=>{(t=document.createElement("audio")).addEventListener("loadeddata",a),t.addEventListener("error",(()=>{n(new Error("getAudioDuration: error loading audio"))})),t.src=r=URL.createObjectURL(e)})).then((()=>~~t.seekable.end(0))).finally((()=>{r&&URL.revokeObjectURL(r)}))},t.typeFromMimetype=function(e){var t=e.split("/")[0];switch(t){case s.IMAGE:case s.VIDEO:case s.AUDIO:return t;default:return s.DOCUMENT}},t.getMimeTypeForFilepath=function(e){var t=l(e),r=(0,i.isAllowedDocumentMimetype)(i.EXT_TO_MIME&&t&&i.EXT_TO_MIME[t],e,!1);if(r)return r},t.removeTrailingDots=u,t.getFileExtension=l,t.createFile=d,t.copyFile=function(e){return o(e).then((t=>{var{lastModified:r,type:a,name:n}=e;return d([t],n,{lastModified:r,type:a})}))},t.blobToText=function(){return c.apply(this,arguments)},t.FILETYPE=void 0;var n=a(r(52954)),i=r(41501),s=Object.freeze({IMAGE:"image",VIDEO:"video",AUDIO:"audio",DOCUMENT:"document"});function o(e){var t;return new Promise(((r,a)=>{(t=new FileReader).onload=r,t.onerror=e=>{a(new Error("blobToArrayBuffer error: ".concat(String(e))))},t.onabort=e=>{a(new Error("blobToArrayBuffer abort: ".concat(String(e))))},t.readAsArrayBuffer(e)})).then((()=>t.result))}function u(e){return e.replace(/\.+$/,"")}function l(e){var t=u(e.trimRight()).split(".");return t.length>1?t[t.length-1].toLowerCase():null}function d(e,t,r){var a=new Blob(e,r||{});return a.name=t,a}function c(){return(c=(0,n.default)((function*(e){if("function"==typeof e.text)return e.text();var t=new FileReader;if(yield new Promise(((r,a)=>{t.onload=r,t.onerror=e=>{a(new Error("blobToText error: ".concat(String(e))))},t.onabort=e=>{a(new Error("blobToText abort: ".concat(String(e))))},t.readAsText(e)})),t.result instanceof ArrayBuffer)throw new TypeError("blobToText error: Invalid result type: ArrayBuffer");if(null==t.result)throw new TypeError("blobToText: Invalid result type: null");return t.result}))).apply(this,arguments)}t.FILETYPE=s},91200:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return Object.keys(e).reduce(((t,r)=>(null!=e[r]&&(t[r]=e[r]),t)),{})}},32392:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.forbiddenFindDOMNode=n,t.forbiddenAssertDOMNode=function(e,t=window.HTMLElement){var r=n(e,t);if(r)return r;throw new Error("[ForbiddenAssertDOMNode] findDOMNode returned ".concat(String(r)," with component ").concat(String(e)))};var a=r(28316);function n(e,t=window.HTMLElement){var r=(0,a.findDOMNode)(e);if(r){if(r instanceof t)return r;throw new Error("[forbiddenFindDOMNode] returned node not instance of ".concat(String(t)))}return r}},38147:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(50664));var i=new class{constructor(){this.shouldIndicateFocusTimestamp=0}shouldIndicateFocus(){this.shouldIndicateFocusTimestamp=Date.now()}maybeIndicateFocus(e,t=n.default.focusAnimation){Date.now()-this.shouldIndicateFocusTimestamp>200||this.indicateFocus(e,t)}indicateFocus(e,t=n.default.focusAnimation){e&&(e.classList.remove(t),e.offsetWidth,e.classList.add(t))}};t.default=i},6660:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(19976)),i=r(39329),s=a(r(32510));function o(){var e=(0,n.default)(["Focus loop encountered."]);return o=function(){return e},e}var u=[],l=!1;var d=new i.ShiftTimer((function(){u=[],l=!1})),c=!s.default||{capture:!0,passive:!0};document.addEventListener("keydown",(()=>{d.forceRunNow()}),c);var f={focus(e,t){if(e&&(!u.length||e!==u[u.length-1])){if(l=l||null!=window.event,function(e){5===u.length&&u.shift(),u.push(e)}(e),function(){if(u.length<5)return!1;for(var e=new Set,t=0;t<u.length;t++){if(e.has(u[t]))return!0;e.add(u[t])}return!1}()&&!l)return __LOG__(4,void 0,new Error,!0)(o()),void SEND_LOGS("focus-loop");d.onOrBefore(75),e.focus(t)}}};t.default=f},24:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function({chat:e,undelivered:t,canForward:r,cannotForward:a}){var s=r.length-t.length,o=a.length+t.length,u=e.isUser?{contact:e.formattedTitle}:{};if(s>0)return t.length?a.length?i.default.t(410,(0,n.default)({count:o,_plural:o},u)):i.default.t(409,{count:o,_plural:o}):i.default.t(407,{count:o,_plural:o,contact:e.formattedTitle});if(t.length)return a.length?i.default.t(411,u):i.default.t(412);return i.default.t(408,u)};var n=a(r(70417)),i=a(r(17957))},26890:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,r,a=String){var i=(0,n.default)(e,t.map(a)).join(""),s=r?4e3:Number.POSITIVE_INFINITY;i.length>s&&(i=i.slice(0,s).replace(/\s+$/," [truncated]"));return i};var n=a(r(51198))},22182:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(29351);class n extends((0,a.customError)("ForwardError")){constructor(e){super(),this.reasons=e}}t.default=n},70013:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.aspectRatioScaled=function(e,t){return"number"!=typeof e||e<0||e!=e?{width:t,height:t}:e>1?{width:t,height:Math.max(t/e,1)}:{width:Math.max(t*e,1),height:t}},t.boundHeightWidth=function(e,t,r){var a=null!=t?t:r,n=null!=e?e:r;a>n?a>r&&(n*=r/a,a=r):n>r&&(a*=r/n,n=r);return{width:Math.max(a,1),height:Math.max(n,1)}},t.rotatePoint=function(e,t,r){var a=r*Math.PI/180;return{x:Math.cos(a)*e+Math.sin(a)*t,y:-Math.sin(a)*e+Math.cos(a)*t}}},58806:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(19976));function i(){var e=(0,n.default)(["hard expire time not found on dom, using fallback of 1572566400 (2019/11/1)"]);return i=function(){return e},e}var s=document.getElementById("hard_expire_time"),o=s&&s.dataset&&s.dataset.time;o||(__LOG__(3)(i()),o="1572566400");var u=o;t.default=u},55273:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.extract=o,t.expand=u,t.extractAndExpand=function(e,t,r){return o(e,s).then((e=>u(e,t,r)))},t.DEFAULT_SALT=void 0;var n=r(46378),i=a(r(36398)),s=new Uint8Array(32).buffer;function o(e,t){return new i.default(new Uint8Array(t)).sign(new Uint8Array(e))}function u(e,t,r){if(r<0||r>8160)return Promise.reject(new Error("HKDF::expand given bad length ".concat(r)));for(var a=Math.ceil(r/32),s=n.Binary.build(t).readByteArray(),o=new n.Binary,u=new i.default(e),l=Promise.resolve(new Uint8Array(0)),d=function(e){l=l.then((t=>{var r=new Uint8Array(t.length+s.length+1);return r.set(t),r.set(s,t.length),r[t.length+s.length]=e,u.sign(r)})).then((e=>{var t=new Uint8Array(e);return o.writeByteArray(t),t}))},c=1;c<=a;c++)d(c);return l.then((()=>o.readBuffer(r)))}t.DEFAULT_SALT=s},44343:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.SpecialKeyMap=void 0;var i=n(r(58527)),s=n(r(22220)),o=n(r(19976)),u=n(r(98346)),l=a(r(2784)),d=n(r(20398));function c(){var e=(0,o.default)(["Invalid HotKey Key: ",""]);return c=function(){return e},e}function f(){var e=(0,o.default)(["Invalid HotKey Key: ",""]);return f=function(){return e},e}function p(){var e=(0,o.default)(["Invalid HotKey Modifier: ",""]);return p=function(){return e},e}var h={alt:"Alt",ctrl:"Control",meta:"Meta",shift:"Shift"},_=(0,u.default)(h),m={backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,capslock:20,esc:27,space:32,pageup:33,pagedown:34,end:35,home:36,left:37,up:38,right:39,down:40,ins:45,del:46,meta:224};t.SpecialKeyMap=m;var g={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},v={option:"alt",command:"meta",return:"enter",escape:"esc",plus:"+"};class E extends l.Component{constructor(...e){super(...e),this._setRef=e=>{this._ref=e,this.props.onRef&&this.props.onRef(e)},this.getElement=()=>this._ref,this.focused=!1,this.onKeyDown=e=>{var{handlers:t}=this.props;t&&Object.keys(t).forEach((r=>{var a=t[r];if(null!=a){var n=this.normalizeKM(r),[i]=n;g[i]&&this.matchHandler(n,e)&&(e.persist(),a(e))}}))},this.onKeyPress=e=>{var{handlers:t}=this.props;t&&Object.keys(t).forEach((r=>{var a=t[r];if(null!=a){var n=this.normalizeKM(r),[i]=n;g[i]||this.matchHandler(n,e)&&(e.persist(),a(e))}}))},this.onFocus=e=>{this.focused=!0,this.props.onFocus(e)},this.onBlur=e=>{this.focused=!1,this.props.onBlur(e)}}matchHandler([e,t],r){return e===r.which&&_.every((e=>t&&e===t?r.getModifierState(t):!r.getModifierState(e)))}normalizeKM(e){var[t,r]=e.toLowerCase().split("+");v[t]&&(t=v[t]),v[r]&&(r=v[r]);var a,n=t;return r?(n=r,void 0===(a=h[t])?__LOG__(3)(p(),t):void 0===n&&__LOG__(3)(f(),r)):void 0===n&&__LOG__(3)(c(),t),[m[n]||n.charCodeAt(0),a]}componentDidMount(){this.focused=!1}componentWillUnmount(){if(!0===this.focused){var e=document.activeElement;this._ref===e&&d.default.Manager.refocusTopUie()}}render(){var e=this.props,{component:t,handlers:r,children:a,onRef:n}=e,o=(0,s.default)(e,["component","handlers","children","onRef"]),u=r&&Object.keys(r).some((e=>null!=r[e]));return l.createElement(t,(0,i.default)({ref:this._setRef,tabIndex:"-1",onKeyPress:u?this.onKeyPress:null,onKeyDown:u?this.onKeyDown:null},o,{onFocus:this.onFocus,onBlur:this.onBlur}),a)}}t.default=E,E.defaultProps={component:"div",onFocus:()=>{},onBlur:()=>{}},E.flashFocus=Date.now(),E.displayName="Hotkeys"},74110:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MmsDownloadFilehashMismatchError=t.default=void 0;var a=r(29351);class n extends((0,a.customError)("HttpInvalidResponseError")){constructor(e,t){super(null!=t&&null!=t.url?"".concat(e,": ").concat(t.url):e)}}t.default=n;t.MmsDownloadFilehashMismatchError=class extends n{constructor(e){super("mmsDownload: filehash mismatch",e),this.name="MmsDownloadFilehashMismatchError"}}},24126:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(29351);class n extends((0,a.customError)("HttpNetworkError")){constructor(e,t){super(null!=t&&null!=t.url?"".concat(e,": ").concat(t.url):e)}}t.default=n},17447:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(29351);class n extends((0,a.customError)("HttpStatusCodeError")){constructor(e,t,r){super(null!=r&&null!=r.url?"".concat(t,": ").concat(e," ").concat(r.url):"".concat(t,": ").concat(e)),this.status=e}}t.default=n},46302:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(24126));class i extends n.default{constructor(e,t){super(e,t),this.name="HttpTimedOutError"}}t.default=i},37755:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"AbortError",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(t,"HttpInvalidResponseError",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(t,"MmsDownloadFilehashMismatchError",{enumerable:!0,get:function(){return s.MmsDownloadFilehashMismatchError}}),Object.defineProperty(t,"HttpNetworkError",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(t,"HttpStatusCodeError",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(t,"HttpTimedOutError",{enumerable:!0,get:function(){return l.default}});var i=n(r(8701)),s=a(r(74110)),o=n(r(24126)),u=n(r(17447)),l=n(r(46302))},3757:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t={}){return f(e,t).catch((e=>{if(e.name===s.ABORT_ERROR)throw new s.default;if(e instanceof u.HttpNetworkError)throw e;throw new u.HttpNetworkError(e.message)}))},t.sharedFetch=f;var i=n(r(70417)),s=a(r(8701)),o=n(r(86041)),u=r(37755),l=n(r(87697)),d=n(r(20909)),c=n(r(8802));function f(e,t={}){return new Promise(((r,a)=>{if(t.signal&&t.signal.aborted)a(new o.default("AbortError"));else{var n=new XMLHttpRequest;if(t.signal){var s=t.signal;s.addEventListener("abort",(function e(){s.removeEventListener("abort",e),n.onreadystatechange=()=>{},n.abort(),a(new o.default("AbortError"))}))}var{onProgress:f,onResponseText:p}=t;(null!=f||p)&&(n.onprogress=e=>{p&&p(e,n.responseText),f&&f(e)}),n.onreadystatechange=()=>{if(0===n.readyState)a(new Error("fetch error: not sent"));else if(4===n.readyState){if(null==n.status)return void a(new Error("fetch error: no status"));if(0===n.status||n.status>=12e3)return void a(new Error("fetch error: unexpected status ".concat(n.status)));r(_())}},n.onerror=()=>a(new Error("fetch error: error")),n.ontimeout=()=>{a(new u.HttpTimedOutError("fetch error: timedout",{url:e.toString()}))},n.withCredentials="include"===t.credentials,null!=t.timeout&&(n.timeout=t.timeout),n.open(t.method||"get",e.toString(),!0);var h=new d.default(t.headers||{});(0,l.default)(h.keys(),(e=>{var t=h.get(e);null!=t&&n.setRequestHeader(e,t)})),p?n.overrideMimeType("text/plain; charset=x-user-defined"):n.responseType="arraybuffer",n.send(t.body||null)}function _(){var e=new d.default((0,c.default)(n.getAllResponseHeaders()));return(0,i.default)((0,i.default)({ok:200<=n.status&&n.status<300,statusText:n.statusText,status:n.status,url:n.responseURL},p?{text:()=>Promise.resolve(n.responseText),json:()=>Promise.resolve(JSON.parse(n.responseText)),arrayBuffer:()=>{return Promise.resolve((e=n.responseText,(t=new Uint8Array(e.length)).set([...e].map((e=>e.codePointAt(0)))),t.buffer));var e,t}}:{text:()=>m(),json:()=>m().then((e=>JSON.parse(e))),arrayBuffer:()=>n.response}),{},{blob:()=>Promise.resolve(new Blob([n.response],{type:e.get("content-type")||""})),clone:_,headers:e})}function m(){return Promise.resolve(String.fromCharCode(...new Uint8Array(n.response)))}}))}},8802:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(e||"").trim().toLowerCase().split("\n").reduce(((e,t)=>{if(!t.trim())return e;var r=t.indexOf(":"),a=t.substr(0,r).trim(),n=t.substr(r+1).trim().replace(/;$/,"");return e[a]?Array.isArray(e[a])?e[a].push(n):e[a]+=", ".concat(n):e[a]=n,e}),{})}},22359:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.deleteIdentity=function(e){return Promise.all([(0,i.deleteRemoteInfo)(e),(0,i.deleteDeviceSenderKey)(e)]).catch((()=>{__LOG__(2)(s(),e.user)})).then((()=>{}))};var n=a(r(19976)),i=r(55660);function s(){var e=(0,n.default)(["handleDevicesNotification: failed to clean the signal info for ",""]);return s=function(){return e},e}},12250:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.generateADVSecretKey=function(){var e=new Uint8Array(32);self.crypto.getRandomValues(e);var t=(0,l.encodeB64)(e);return(0,m.setADVSecretKey)(t),t},t.getADVSecretKey=function(){var e=(0,m.getADVSecretKey)();if(null==e)throw new Error("MD secretKey is null or undefined");return e},t.setADVSignedIdentity=function(e){if(null==e)return Promise.reject(new Error("MD advSignedDeviceIdentity is null or undefined"));if(null==e.deviceSignature)return Promise.reject(new Error("MD advSignedDeviceIdentity is missing deviceSignature"));return g.waSignalStore.putADVSignedIdentity(e)},t.getADVEncodedIdentity=function(){return D.apply(this,arguments)},t.verifyDeviceIdentityAccountSignature=N,t.generateDeviceSignature=function(e,t,r){var a=e.details,n=u.Binary.build(I,a,t.pubKey,r).readByteArray().buffer;return window.libsignal.Curve.calculateSignature(t.privKey,n)},t.verifyDeviceSignature=L,t.clearADVSecretKey=function(){(0,m.setADVSecretKey)(void 0)},t.validateADVwithIdentityKey=k,t.validateADVwithEncs=function(e,t,r){if(!h.default.supportsFeature(h.default.F.MD_ADV))return Promise.resolve(!0);var a=r.find((e=>e.e2eType===v.CiphertextType.Pkmsg));if(!a)return Promise.resolve(!0);__LOG__(2)(w());try{(0,d.default)(null!=e,"author should not be null");var n=(0,E.extractIdentityKey)(a.ciphertext);return(0,d.default)(null!=n,"identityKey should not be null"),k(e,t,new Uint8Array(n))}catch(e){return __LOG__(3)(O(),e),Promise.resolve(!1)}},t.verifyKeyIndexListAccountSignature=function(e,t){var r=e.details,a=e.accountSignature;(0,d.default)(null!=a,"accountSignature should not be null");var n=u.Binary.build(R,r).readByteArray();return(0,p.verifySignature)(new Uint8Array(t),n,new Uint8Array(a))};var n=a(r(19976)),i=a(r(52954)),s=r(84139),o=r(68519),u=r(46378),l=r(60339),d=a(r(47677)),c=r(43919),f=r(59410),p=r(72434),h=a(r(18120)),_=r(34507),m=r(39174),g=r(44480),v=r(96571),E=r(69779),y=r(44762),S=r(75637);function T(){var e=(0,n.default)(["validateADVIdentity: failed"]);return T=function(){return e},e}function b(){var e=(0,n.default)(["validateADVIdentity: successfully verified accountSignature and deviceSignature"]);return b=function(){return e},e}function A(){var e=(0,n.default)(["validateADVIdentity: process adv device identity failed"]);return A=function(){return e},e}function C(){var e=(0,n.default)(["validateADVIdentity: invalid device signature"]);return C=function(){return e},e}function P(){var e=(0,n.default)(["validateADVIdentity: invalid account signature"]);return P=function(){return e},e}function O(){var e=(0,n.default)(["validateADVwithEncs: failed ",""]);return O=function(){return e},e}function w(){var e=(0,n.default)(["validateADVwithEncs: start validate prekey msg "]);return w=function(){return e},e}var M=new Uint8Array([6,0]),I=new Uint8Array([6,1]),R=new Uint8Array([6,2]);function D(){return(D=(0,i.default)((function*(){var e=yield g.waSignalStore.getADVSignedIdentity();if(null==e)throw new Error("MD advSignedDeviceIdentity is null or undefined");if(null==e.deviceSignature)throw new Error("MD advSignedDeviceIdentity is missing deviceSignature");return(0,o.encodeProto)(c.ADVSignedDeviceIdentitySpec,e).readByteArray()}))).apply(this,arguments)}function N(e,t,r){var a=e.details,n=e.accountSignatureKey||r;(0,d.default)(null!=n,"accountSignatureKey should not be null");var i=e.accountSignature;(0,d.default)(null!=i,"accountSignature should not be null");var s=u.Binary.build(M,a,t).readByteArray();return(0,p.verifySignature)(new Uint8Array(n),s,new Uint8Array(i))}function L(e,t,r){var a=e.details,n=e.deviceSignature;(0,d.default)(null!=n,"deviceSignature should not be null");var i=e.accountSignatureKey||r;(0,d.default)(null!=i,"accountSignatureKey should not be null");var s=u.Binary.build(I,a,t,i).readByteArray();return(0,p.verifySignature)(new Uint8Array(t),s,new Uint8Array(n))}function k(){return U.apply(this,arguments)}function U(){return(U=(0,i.default)((function*(e,t,r){if(!h.default.supportsFeature(h.default.F.MD_ADV))return!0;try{var a=(0,f.uint8ArrayToBuffer)(r),n=yield g.waSignalStore.getIdentity((0,y.createSignalAddress)(e).toString());if(n){var i=(0,p.toCurveKeyPubKey)((0,y.strToBuffer)(n));if((0,y.bufferEqual)(i,a))return!0}var o=(0,s.decodeProto)(c.ADVSignedDeviceIdentitySpec,t);(0,d.default)(null!=o,"advSignedDeviceIdentity should not be null");var u=yield g.waSignalStore.getIdentity((0,y.createSignalAddress)((0,S.toUserWid)(e)).toString()),l=u?(0,p.toCurveKeyPubKey)((0,y.strToBuffer)(u)):null;if(!N(o,a,l))return __LOG__(3)(P()),!1;if(!L(o,a,l))return __LOG__(3)(C()),!1;var m=(0,s.decodeProto)(c.ADVDeviceIdentitySpec,o.details);(0,d.default)(null!=m,"advDeviceIdentity should not be null");try{yield(0,_.handleADVDeviceUpdateForMessage)(e,m,l,o.accountSignatureKey,a)}catch(e){return __LOG__(3)(A()),!1}return __LOG__(2)(b()),!0}catch(e){return __LOG__(3)(T()),!1}}))).apply(this,arguments)}},69868:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.getICDCMeta=function(){return m.apply(this,arguments)},t.computeIdentityHash=g;var n=a(r(52954)),i=r(46144),s=r(71684),o=r(97148),u=a(r(50935)),l=r(72434),d=r(47513),c=r(95595),f=a(r(12040)),p=a(r(84025)),h=r(52588),_=r(75637);function m(){return(m=(0,n.default)((function*(e){if(!1===(0,o.getABPropConfigValue)("md_icdc_enabled"))return null;var t=yield(0,d.getTable)().get(e.user);if(!t)return null;var r={keyHash:void 0,timestamp:void 0},{timestamp:a,devices:n}=t,i=n.some((e=>e.id!==u.default.DEVICE.PRIMARY_DEVICE));if(i){var s=n.map((e=>(0,_.createDeviceWidFromUserAndDevice)(t.id,e.id))).filter((e=>!e.equals((0,c.assertGetMe)()))),p=yield(0,h.getAllIdentityKeysBytes)(s);if((0,c.assertGetMe)().user===e.user){var m=yield f.default.getIdentityKeyPair();if(!m)return null;p.push(new Uint8Array(m.pubKey))}var v=E();r.keyHash=yield g(p.map((e=>new Uint8Array((0,l.toCurveKeyPubKey)(e.buffer)))),v)}return(i||y(a))&&(r.timestamp=a),r}))).apply(this,arguments)}function g(){return v.apply(this,arguments)}function v(){return(v=(0,n.default)((function*(e,t){var r=(0,h.identityKeysToBinary)(e),a=yield p.default.digest({name:"SHA-256"},r),n=new Uint8Array(a);return(0,i.sliceBytes)(n,0,t)}))).apply(this,arguments)}function E(){var e=(0,o.getABPropConfigValue)("md_icdc_hash_length");return Math.max(e,8)}function y(e){return(0,s.unixTime)()-e<2592e3}},52588:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.getAllIdentityKeysBytes=function(){return l.apply(this,arguments)},t.identityKeysToBinary=function(e){var t=new i.Binary;return e.sort(u).forEach((e=>{t.writeByteArray(e)})),t.readByteArray()};var n=a(r(52954)),i=r(46378),s=r(44480),o=r(44762);function u(e,t){for(var r=0;r<e.length&&r<t.length;++r)if(e[r]!==t[r])return e[r]-t[r];return e.length-t.length}function l(){return(l=(0,n.default)((function*(e){for(var t=yield s.waSignalStore.bulkGetIdentity(e.map((e=>(0,o.createSignalAddress)(e).toString()))),r=[],a=0;a<t.length;a++){var n=t[a];if(null==n)throw new Error("getAllIdentityKeys: missing identity key for device ".concat(String(e[a])));r.push(new Uint8Array((0,o.strToBuffer)(n)))}return r}))).apply(this,arguments)}},78986:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UIBusyTasks=t.IdleCallbackTasks=t.IdleEnum=void 0;var a=r(39329),n=r(20835),i=r(28103).Mirrored(["IDLE_CALLBACK","UI_BUSY"]);t.IdleEnum=i;class s{constructor(e){this.busyMap=new Map,this.busyId=0,this._clearBusyMap=()=>{this.busyMap.clear()},this._taskMap=new Map,this.taskId=0,this.runIdleLoop=()=>{this.idleType===i.IDLE_CALLBACK?this.idleCallbackId=(0,n.requestIdleCallback)(this._ricOnIdle):this.isIdle()&&this._uiBusyOnIdle()},this._ricOnIdle=e=>{for(var t,r=this._taskMap.entries();(t=r.next())&&!t.done;){var[a,n]=t.value;if(n(),this._taskMap.delete(a),e.timeRemaining()<=0)break}this._taskMap.size>0&&this.runIdleLoop()},this.idleType=e}setBusy(e){var t=e;return null!=t&&this.busyMap.has(t)?this.busyMap.set(t,this.busyMap.get(t)+1):(t=++this.busyId,this.busyMap.set(t,1)),this.busyTimer||(this.busyTimer=new a.ShiftTimer(this._clearBusyMap)),this.busyTimer.debounce(1e3),t}decBusy(e){if(null!=e){var t=this.busyMap.get(e);null!=t&&0!==t&&(1===t?this.clearBusy(e):this.busyMap.set(e,t-1))}}clearBusy(e){null!=this.busyMap.get(e)&&this.busyMap.delete(e),this.isIdle()&&(this.busyTimer.cancel(),this._taskMap.size>0&&window.setTimeout(this.runIdleLoop,0))}isIdle(){return 0===this.busyMap.size}isBusy(){return this.busyMap.size>0}cancelIdleLoop(){this.idleType===i.IDLE_CALLBACK&&null!=this.idleCallbackId&&(0,n.cancelIdleCallback)(this.idleCallbackId)}_uiBusyOnIdle(){for(var e,t=this._taskMap.entries();(e=t.next())&&!e.done;){var[r,a]=e.value;if(a(),this._taskMap.delete(r),this.isBusy())break}}enqueue(e){return this._taskMap.set(++this.taskId,e),1===this._taskMap.size&&this.runIdleLoop(),this.taskId}dequeue(e){var t=this._taskMap.delete(e);return t&&0===this._taskMap.size&&this.cancelIdleLoop(),t}isInQueue(e){return this._taskMap.has(e)}}var o=new s(i.UI_BUSY);t.UIBusyTasks=o;var u=new s(i.IDLE_CALLBACK);t.IdleCallbackTasks=u},44202:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.generateVideoThumbsAndDuration=function(){return I.apply(this,arguments)},t.crop=function(e,t,r,a,n,i,s,u=P){return(e instanceof HTMLCanvasElement?Promise.resolve(e):_.loadImage(e)).then((e=>{var l=document.createElement("canvas"),d=l.getContext("2d");null==i||null==s?(l.height=n,l.width=a,d.drawImage(e,t,r,a,n)):(l.height=s,l.width=i,d.drawImage(e,t,r,a,n,0,0,i,s));var c={};return N(c,l,u),(0,o.promiseProps)(c).then((e=>({images:e,width:a,height:n})))}))},t.toDataUrlWithRoundedCorners=function(e){return(e instanceof HTMLCanvasElement?Promise.resolve(e):_.loadImage(e)).then((e=>{var t=document.createElement("canvas"),r=t.getContext("2d");t.height=e.height,t.width=e.width;var a=Math.min(e.width,e.height);return r.beginPath(),r.arc(e.width/2,e.height/2,a/2,0,2*Math.PI,!0),r.clip(),r.closePath(),r.drawImage(e,0,0),t.toDataURL("image/png")}))},t.generateLinkPreview=function(e){return _.loadImage(e).then((e=>{var t=140;if(e.width<100||e.height<100)return __LOG__(2)(b()),null;var r=document.createElement("canvas"),a=r.getContext("2d");r.height=t,r.width=t;var n=Math.min(e.width,e.height),i=(e.width-n)/2,s=(e.height-n)/2;return a.drawImage(e,i,s,n,n,0,0,t,t),r.toDataURL("image/jpeg").replace(/^data:image\/jpeg;base64,/,"")})).catch((()=>(__LOG__(2)(T()),null)))},t.toDataUrl=function(e){return _.loadImage(e).then((e=>{var t=document.createElement("canvas"),r=t.getContext("2d");return t.height=e.height,t.width=e.width,r.drawImage(e,0,0),t.toDataURL("image/jpeg").replace(/^data:image\/jpeg;base64,/,"")})).catch((()=>(__LOG__(2)(S()),null)))},t.rotateAndResize=function(e,t,r){var a,n,i,s=new ArrayBuffer(0);e instanceof HTMLCanvasElement?(n=Promise.resolve(e),i=Promise.resolve(s)):(a=window.URL.createObjectURL(e),n=_.loadImage(a),i=(0,f.blobToArrayBuffer)(e).catch((e=>(__LOG__(3)(y(),e),s))));return(0,o.promiseProps)({buffer:i,image:n}).then((({buffer:e,image:a})=>{var n={};try{n=(0,u.default)(e)}catch(e){}var i=0;switch(n.orientation||"UNKNOWN"){case"right-top":i=1;break;case"left-bottom":i=-1;break;case"bottom-right":i=2}var s=document.createElement("canvas"),l=a.naturalWidth||a.width,d=a.naturalHeight||a.height,c=s.getContext("2d"),f={};if(!i){var _,m,g=(0,p.boundHeightWidth)(d,l,t),v=r&O;if(e&&v&&l===g.width&&d===g.height)try{var y=(0,h.cleanJPEG)(e);f.blob=y,v=!1,_=l,m=d}catch(e){__LOG__(2)(E(),e.message)}return(v||r&~O)&&(s.width=g.width,s.height=g.height,_=s.width,m=s.height,k(s),c.drawImage(a,0,0,_,m),N(f,s,r)),(0,o.promiseProps)(f).then((e=>({width:_,height:m,images:e})))}switch(i){case 1:case-1:var S=Math.max(l,d),T=S/2;s.width=s.height=S,k(s),L(c,{x:T,y:T,degrees:90*i}),1===i?c.drawImage(a,0,S-d):c.drawImage(a,S-l,0),L(c,{x:T,y:T,degrees:-90*i}),function(e,t,r){var a=e.getContext("2d"),n=a.getImageData(0,0,t,r);e.width=t,e.height=r,a.putImageData(n,0,0)}(s,d,l);var b=function(e,t){var{width:r,height:a}=(0,p.boundHeightWidth)(e.height,e.width,t);if(r>e.width&&a>e.height)return e;var n=document.createElement("canvas"),i=n.getContext("2d");return n.width=r,n.height=a,i.drawImage(e,0,0,r,a),n}(s,t);return N(f,b,r),(0,o.promiseProps)(f).then((e=>({width:b.width,height:b.height,images:e})));case 2:var A=(0,p.boundHeightWidth)(d,l,t),C=s.width=A.width,P=s.height=A.height;return k(s),L(c,{x:C/2,y:P/2,degrees:90*i}),c.drawImage(a,0,0,C,P),L(c,{x:C/2,y:P/2,degrees:-90*i}),N(f,s,r),(0,o.promiseProps)(f).then((e=>({width:s.width,height:s.height,images:e})))}})).finally((()=>{a&&window.URL.revokeObjectURL(a)}))},t.canvasToBlob=R,t.urlToFile=function(e){return _.loadImage(e).then((e=>{var t=document.createElement("canvas");t.width=e.naturalWidth,t.height=e.naturalHeight;var r=t.getContext("2d");return k(t),r.drawImage(e,0,0),R(t)})).catch((()=>Promise.reject(new d.MediaDragDropError("unable to render image",e))))},t.isCached=function(e){if(!e)return!1;var t=new Image;return t.src=e,!!t.complete},t.getResizedDataUrl=function(e,t="image/jpeg",r){var a=e.toDataURL(t);if(window.dataURLtoBlob(a).size<=r)return e.toDataURL(t);for(var n=.9;n>=.1;n-=.1){var i=e.toDataURL(t,n);if(window.dataURLtoBlob(i).size<=r)return i}return null},t.generateMicroThumb=function(){return D.apply(this,arguments)},t.CANVAS=t.BLOB=t.DATA_URL=void 0;var i=n(r(19976)),s=n(r(52954)),o=r(5497),u=n(r(86120)),l=n(r(12489)),d=a(r(96452)),c=n(r(82195)),f=r(99888),p=r(70013),h=r(60221),_=a(r(23765)),m=n(r(25012)),g=n(r(77626));function v(){var e=(0,i.default)(["generateVideoThumbAndDuration: Setting video.currentTime to 0 to attempt to unblock the video"]);return v=function(){return e},e}function E(){var e=(0,i.default)(["Could not parse JPEG: ",""]);return E=function(){return e},e}function y(){var e=(0,i.default)(["ImageUtils::rotateAndResize error: ",""]);return y=function(){return e},e}function S(){var e=(0,i.default)(["data URL conversion failed: "]);return S=function(){return e},e}function T(){var e=(0,i.default)(["link preview image generation failed: "]);return T=function(){return e},e}function b(){var e=(0,i.default)(["Image size too small for link preview"]);return b=function(){return e},e}var A=2,C=4,P=1;t.DATA_URL=P;var O=A;t.BLOB=O;var w=C;t.CANVAS=w;var M=({video:e,fullWidth:t,fullHeight:r,maxDimension:a})=>{var n=document.createElement("canvas"),{width:i,height:s}=(0,p.boundHeightWidth)(r,t,a);n.width=i,n.height=s;var o=n.getContext("2d");o.drawImage(e,0,0,i,s);var u=o.getImageData(0,0,i,s);return{thumb:{url:n.toDataURL("image/jpeg"),width:i,height:s,fullWidth:t,fullHeight:r},imageData:u}};function I(){return(I=(0,s.default)((function*(e,t){var{video:r,fullWidth:a,fullHeight:n}=yield _.loadVideo(e,!0);if(g.default.isBuggyVideoLoad){var i=e=>{for(var t=e.width*e.height/4,r=0;r<=1;r+=.25){var a=4*Math.round(t*r);if(0!==e.data[a])return!1;if(0!==e.data[a+1])return!1;if(0!==e.data[a+2])return!1;var n=e.data[a+3];if(0!==n&&255!==n)return!1}return!0};return(0,c.default)({minTimeout:50,maxTimeout:50,retries:100,signal:(new l.default).signal,factor:1},((e,s)=>{var o,u=[];for(o of t){var{thumb:l,imageData:d}=M({video:r,fullHeight:n,fullWidth:a,maxDimension:o});if(s<100&&i(d))return s>0&&(__LOG__(2)(v()),r.currentTime=0),e(new Error("retry"));u.push(l)}var c={duration:~~r.seekable.end(0),thumbs:u};return _.disposeVideo(r),Promise.resolve(c)}))}try{var s=t.map((e=>M({video:r,fullHeight:n,fullWidth:a,maxDimension:e}).thumb));return{duration:~~r.seekable.end(0),thumbs:s}}finally{_.disposeVideo(r)}}))).apply(this,arguments)}function R(e,t="image/jpeg"){return e.toBlob?new Promise((function(t){e.toBlob(t,"image/jpeg")})):Promise.resolve(window.dataURLtoBlob(e.toDataURL("image/jpeg")))}function D(){return(D=(0,s.default)((function*(e,t,r){for(var a,n,i=r||{},s=null!==(a=i.mimetype)&&void 0!==a?a:"image/jpeg",o=null!==(n=i.maxAttempts)&&void 0!==n?n:10,u=.5,l=e,d=yield R(l,s),c=0;c<o&&!(d.size<=t);c++){var f=Math.floor(e.width*u),p=Math.floor(e.height*u);(l=U(f,p)).getContext("2d").drawImage(e,0,0,f,p),d=yield R(l,s),u*=.5}return{opaqueData:yield m.default.createFromData(d,s),width:l.width,height:l.height,dataUrl:l.toDataURL("image/jpeg")}}))).apply(this,arguments)}function N(e,t,r){!e.blob&&r&O&&(e.blob=R(t)),!e.dataUrl&&r&P&&(e.dataUrl=Promise.resolve(t.toDataURL("image/jpeg"))),!e.canvas&&r&w&&(e.canvas=Promise.resolve(t))}function L(e,t){var r=t.x||0,a=t.y||0;t.degrees&&(t.radians=t.degrees*(Math.PI/180)),e.translate(r,a),e.rotate(t.radians),e.translate(-r,-a)}function k(e){var t=e.getContext("2d");t.fillStyle="rgb(247,247,247)",t.fillRect(0,0,e.width,e.height)}function U(e,t){var r=document.createElement("canvas");return r.width=e,r.height=t,r}},22605:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default=class{constructor(){this._lastPromise=Promise.resolve(),this._pending=[]}enqueue(e){e.catch((()=>{}));var t=()=>e;this._lastPromise=this._lastPromise.then(t,t);var r=this._lastPromise.cancellable();return this._pending.push(r),r.finally((()=>{this._pending.length>0&&this._pending[0]===r&&this._pending.shift()}))}cancelAll(e){var t=this._pending;this._pending=[],t.forEach((t=>{t.cancel(e)}))}}},71219:(e,t)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;try{r=self.indexedDB}catch(e){}var a=r;t.default=a},1972:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.waNoiseInfo=t.deviceInfo=void 0;var a=r(39174);var n=new class{get(){return{osVersion:"0.1",osBuild:"0.1",hardware:"desktop",manufacturer:"",device:"Desktop",lg:"en",lc:"en",mcc:"000",mnc:"000",sim_mnc:"000",sim_mcc:"000"}}};t.deviceInfo=n;var i=new class{get(){return(0,a.getNoiseInfo)()}set(e){return(0,a.setNoiseInfo)(e)}};t.waNoiseInfo=i},72509:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=0,r=e.charCode,a=e.keyCode;null!=r&&0!==r?t=r:null!=a&&0!==a&&(t=a);return n.has(t)};var a=r(44343),n=new Set([a.SpecialKeyMap.enter,a.SpecialKeyMap.space])},5331:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(56010));class i extends n.default{constructor(e){super(),this._array=e.slice()}_next(){return 0===this._array.length?this.return():{done:!1,value:this._array.shift()}}}t.default=i},11639:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.defaults=void 0;var n=a(r(70417)),i=a(r(62277)),s={factor:2,jitter:0,maxTimeout:1/0};t.defaults=s;class o extends i.default{constructor(e){super(null==e.factor?s.factor:e.factor),this._opts=(0,n.default)((0,n.default)({},s),e),this._retryCount=0}_next(){var{jitter:e,maxTimeout:t,minTimeout:r,retries:a}=this._opts,n=super._next();if(n.done)return n;if(this._retryCount++,this._retryCount>a)return this.return();var i=r*n.value;return i*=Math.random()*e*2-e+1,{done:!1,value:i=Math.min(i,t)}}}t.default=o},62277:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(56010));class i extends n.default{constructor(e){super(),this._base=e,this._value=1}_next(){var e=this._value;return this._value=e*this._base,{done:!1,value:e}}}t.default=i},87697:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var r=0,a=e.next();for(;!a.done;)t(a.value,r,e),a=e.next(),r++}},56010:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,i=a(r(41261));n=i.default.iterator;t.default=class{constructor(){this._done=!1}[n](){return this}next(){return this._done?{done:!0,value:void 0}:this._next()}_next(){throw new Error("unimplemented")}return(){return this._done=!0,this.next()}}},60715:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return new i(e,t)};var n=a(r(56010));class i extends n.default{constructor(e,t){super(),this._iterator=e,this._mapper=t,this._n=0}_next(){var e=this._iterator.next();if(e.done)return this.return();var t=this._mapper(e.value,this._n,this._iterator);return this._n++,{done:!1,value:t}}}},42743:(e,t,r)=>{"use strict";var a=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"JS_HALT_EVENT",{enumerable:!0,get:function(){return n.JS_HALT_EVENT}}),Object.defineProperty(t,"CLOCK_CHANGE_BACKWARDS_EVENT",{enumerable:!0,get:function(){return n.CLOCK_CHANGE_BACKWARDS_EVENT}}),t.default=t.DEFAULT_INTERVAL=t.DEFAULT_THRESHOLD=void 0;var n=a(r(54225));t.DEFAULT_THRESHOLD=3e3;t.DEFAULT_INTERVAL=1e4;var i=new n.default(1e4,3e3);i.startDetection();var s=i;t.default=s},63252:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t={};for(var r in e)e.hasOwnProperty(r)&&(t[r]=r);return t}},50868:(e,t,r)=>{"use strict";var a=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(2784)).createContext(!1);t.default=n},44578:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.LOCALES_THAT_PREFER_24HOUR_TIME=t.LOCALE_CUSTOMIZATIONS=t.SHOULD_USE_MOMENT_LOCALE_FORMAT=t.LOCALE_DATE_TIME_CUSTOMIZATIONS=t.default=void 0;var n=a(r(70417)),i=a(r(19976)),s=a(r(42164)),o=a(r(52850)),u=a(r(19034)),l=a(r(50935)),d=a(r(28267)),c=r(77867),f=a(r(84226)),p=a(r(26385)),h=a(r(95810));function _(){var e=(0,i.default)(['l10n:t string key "','" fallback failed']);return _=function(){return e},e}function m(){var e=(0,i.default)(['l10n:t string key "','" not found']);return m=function(){return e},e}function g(){var e=(0,i.default)(["l10n.t was called with an unprocessed id (","). If you just added a string on local, restarting your build may address the issue."]);return g=function(){return e},e}var v=new Set(["",""]),E=new Set(["ar","ar-XB","fa","ur","he","dv","ku"]),y=new Set(["ar","ar-XB","fa"]),S="".split("");function T(e){return S[parseInt(e,10)]}var b=new Error("Unimplemented method");class A extends d.default{constructor(e,t,r){if(super(),!e||!t)throw b;this._locale=e,this.localeStrings={},this.localeStrings[l.default.L10N.DEFAULT]=t,this.markTranslations=r,this.customizeMoment()}getLocale(){throw b}setLocale(){throw b}normalizeLocale(e){var t=e.replace(/-/g,"_").toLowerCase(),r=this._getTranslationFilename(t);if(r)return r;for(var a=t;a;){var n=(a=a.split("_").slice(0,-1).join("_"))&&this._getTranslationFilename(a);if(n)return n}}isLocaleSupported(e){return!!e&&!!this.normalizeLocale(e)}_getTranslationFilename(e){var t=f.default[e]||e;return h.default[t]}lng(){var e=this.getLocale();return h.default[e]||e}isRTL(e=this.getLocale()){return E.has(e)}LR(e,t){return this.isRTL()?t:e}embedDir(e,t=this.isRTL()){return t?this.embedRTL(e):this.embedLTR(e)}forceDir(e,t=this.isRTL()){return t?this.forceRTL(e):this.forceLTR(e)}embedLTR(e){return""+e+""}embedRTL(e){return""+e+""}isolateLTR(e){return""+e+""}isolateRTL(e){return""+e+""}forceLTR(e){return""+e}forceRTL(e){return""+e}t(e,t,r){"number"!=typeof e&&__LOG__(3)(g(),e);var a=e,n=null!=t?t._plural:null,i=r||this.getLocale();this.localeStrings[i]||(i=l.default.L10N.DEFAULT);var s=this._getString(a,i,n);for(var o in this.markTranslations&&(s?i===l.default.L10N.DEFAULT&&(s="["+s+"]"):(s="!!"+a+"!!",__LOG__(2)(m(),a))),s||(s=this._getString(a,l.default.L10N.DEFAULT,n)),s||__LOG__(2)(_(),a),t)if(t.hasOwnProperty(o)&&"_plural"!==o){var u=new RegExp("__"+o+"__","g"),d=void 0;d="string"==typeof t[o]&&v.has(t[o].slice(0,1))?t[o]:this.n(t[o],i),s=s.replace(u,d)}return s}_getString(e,t,r){var a=this.localeStrings[t]||this.localeStrings[l.default.L10N.DEFAULT];if(null==a)throw new Error("Couldn't find translations for locale ".concat(t," or default (").concat(l.default.L10N.DEFAULT,")"));if(!Array.isArray(a))throw new Error("Unexpected locale format.");var[n,i]=a,s=n[e]||"";if(null==r)return s;var o=p.default[t];if(null==o)return s;var u=o.numbers[o.plurals(r)];return 1===u?s:i[2===o.numbers.length&&2===u?e.toString():"".concat(e,"_").concat(u)]||s}useArabicScriptDigits(e){return y.has(e||this.getLocale())}isLatinAlphabetLanguage(e){return o.default.isLatin(this.removeAccents(e))}n(e,t){var r=e;return isNaN(r)||(r=r.toString()),this.useArabicScriptDigits(t)?r.toString().replace(/[0-9]/g,T):r}filesize(e){var t=this;return this.n((0,s.default)(e,{base:2,round:0,suffixes:{B:t.t(703),kB:t.t(705),MB:t.t(706),GB:t.t(704)}}))}normalizeForm(e=""){return(0,c.normalizeForm)(e)}removeAccents(e=""){return(0,c.removeAccents)(e)}accentFold(e=""){return this.removeAccents(e).toLowerCase()}customizeMoment(){u.default.relativeTimeRounding(Math.floor),u.default.relativeTimeThreshold("s",60),u.default.relativeTimeThreshold("m",60),u.default.relativeTimeThreshold("h",24)}}t.default=A;var C={"zh-tw":{longDateFormat:{LT:"Ah:mm",LTS:"Ah:m:s",L:"YYYYMMMD",LL:"YYYYMMMD",LLL:"YYYYMMMDLT",LLLL:"YYYYMMMDddddLT",l:"YYYYMMMD",ll:"YYYYMMMD",lll:"YYYYMMMDLT",llll:"YYYYMMMDddddLT"}},"zh-cn":{longDateFormat:{LT:"Ah:mm",LTS:"Ah:m:s",L:"YYYY-MM-DD",LL:"YYYYMMMD",LLL:"YYYYMMMDLT",LLLL:"YYYYMMMDddddLT",l:"YYYYMMMD",ll:"YYYYMMMD",lll:"YYYYMMMDLT",llll:"YYYYMMMDddddLT"}},ar:{longDateFormat:{LT:"h:mm A",LTS:"HH:mm:ss",L:"YYYY/MM/DD",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd D MMMM YYYY LT"}},ta:{longDateFormat:{LT:"h:mm A",LTS:"h:mm:ss A",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY h:mm A",LLLL:"dddd, D MMMM YYYY, h:mm A"},preparse:null,postformat:null,meridiem:null,meridiemHour:null},nl:{longDateFormat:{l:"DD-MM-YYYY",L:"DD-MM-YYYY"}},"en-ie":{longDateFormat:{l:"DD/MM/YYYY",L:"DD/MM/YYYY"}},hi:{preparse:null,postformat:null,longDateFormat:{LT:"A h:mm ",LTS:"A h:mm:ss ",LLL:"D MMMM YYYY A h:mm ",LLLL:"dddd, D MMMM YYYY, A h:mm "},meridiem:(e,t)=>0===e&&0===t?"":e>=20||e<4?"":e>=4&&e<12?"":e>=12&&e<16?"":""}};t.LOCALE_DATE_TIME_CUSTOMIZATIONS=C;var P=new Set(["ur"]);t.SHOULD_USE_MOMENT_LOCALE_FORMAT=P;var O=(0,n.default)((0,n.default)({},C),{"pt-pt":{weekdays:["Domingo","Segunda-feira","Tera-feira","Quarta-feira","Quinta-feira","Sexta-feira","Sbado"]}});t.LOCALE_CUSTOMIZATIONS=O;var w=new Set(["af","az","ca","cs","da","de","el","et","fi","fr","he","hr","hu","id","it","kk","lt","mk","nb","pl","pt","pt_br","ro","ru","sl","sr","sv","tr","uk"]);t.LOCALES_THAT_PREFER_24HOUR_TIME=w},77867:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.normalizeForm=i,t.removeAccents=function(e=""){return(0,n.default)(i(e).replace(/(?:[\^`\xA8\xAF\xB4\xB7\xB8\u02B0-\u034E\u0350-\u0357\u035D-\u0362\u0374\u0375\u037A\u0384\u0385\u0483-\u0487\u0559\u0591-\u05A1\u05A3-\u05BD\u05BF\u05C1\u05C2\u05C4\u064B-\u0652\u0657\u0658\u06DF\u06E0\u06E5\u06E6\u06EA-\u06EC\u0730-\u074A\u07A6-\u07B0\u07EB-\u07F5\u0818\u0819\u08E3-\u08FE\u093C\u094D\u0951-\u0954\u0971\u09BC\u09CD\u0A3C\u0A4D\u0ABC\u0ACD\u0AFD-\u0AFF\u0B3C\u0B4D\u0B55\u0BCD\u0C4D\u0CBC\u0CCD\u0D3B\u0D3C\u0D4D\u0DCA\u0E47-\u0E4C\u0E4E\u0EBA\u0EC8-\u0ECC\u0F18\u0F19\u0F35\u0F37\u0F39\u0F3E\u0F3F\u0F82-\u0F84\u0F86\u0F87\u0FC6\u1037\u1039\u103A\u1063\u1064\u1069-\u106D\u1087-\u108D\u108F\u109A\u109B\u135D-\u135F\u17C9-\u17D3\u17DD\u1939-\u193B\u1A75-\u1A7C\u1A7F\u1AB0-\u1ABD\u1B34\u1B44\u1B6B-\u1B73\u1BAA\u1BAB\u1C36\u1C37\u1C78-\u1C7D\u1CD0-\u1CE8\u1CED\u1CF4\u1CF7-\u1CF9\u1D2C-\u1D6A\u1DC4-\u1DCF\u1DF5-\u1DF9\u1DFD-\u1DFF\u1FBD\u1FBF-\u1FC1\u1FCD-\u1FCF\u1FDD-\u1FDF\u1FED-\u1FEF\u1FFD\u1FFE\u2CEF-\u2CF1\u2E2F\u302A-\u302F\u3099-\u309C\u30FC\uA66F\uA67C\uA67D\uA67F\uA69C\uA69D\uA6F0\uA6F1\uA700-\uA721\uA788-\uA78A\uA7F8\uA7F9\uA8C4\uA8E0-\uA8F1\uA92B-\uA92E\uA953\uA9B3\uA9C0\uA9E5\uAA7B-\uAA7D\uAABF-\uAAC2\uAAF6\uAB5B-\uAB5F\uAB69-\uAB6B\uABEC\uABED\uFB1E\uFE20-\uFE2F\uFF3E\uFF40\uFF70\uFF9E\uFF9F\uFFE3]|\uD800\uDEE0|\uD802[\uDEE5\uDEE6]|\uD803[\uDD22-\uDD27\uDF46-\uDF50]|\uD804[\uDCB9\uDCBA\uDD33\uDD34\uDD73\uDDC0\uDDCA-\uDDCC\uDE35\uDE36\uDEE9\uDEEA\uDF3C\uDF4D\uDF66-\uDF6C\uDF70-\uDF74]|\uD805[\uDC42\uDC46\uDCC2\uDCC3\uDDBF\uDDC0\uDE3F\uDEB6\uDEB7\uDF2B]|\uD806[\uDC39\uDC3A\uDD3D\uDD3E\uDD43\uDDE0\uDE34\uDE47\uDE99]|\uD807[\uDC3F\uDD42\uDD44\uDD45\uDD97]|\uD81A[\uDEF0-\uDEF4\uDF30-\uDF36]|\uD81B[\uDF8F-\uDF9F\uDFF0\uDFF1]|\uD834[\uDD67-\uDD69\uDD6D-\uDD72\uDD7B-\uDD82\uDD85-\uDD8B\uDDAA-\uDDAD]|\uD838[\uDD30-\uDD36\uDEEC-\uDEEF]|\uD83A[\uDCD0-\uDCD6\uDD44-\uDD46\uDD48-\uDD4A])/g,""))};var n=a(r(52850));function i(e=""){return e.normalize("NFKD")}},17957:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(r(52954)),s=n(r(19976)),o=r(91460),u=n(r(19034)),l=a(r(44578)),d=n(r(50935)),c=r(11824),f=a(r(82885)),p=n(r(77626));function h(){var e=(0,s.default)(["l10n:locale update error: (",", ",") > (",", ",")"]);return h=function(){return e},e}function _(){var e=(0,s.default)(["l10n:locale updated: (",", ",") > (",", ","), Fetch: ","ms, Apply: ","ms"]);return _=function(){return e},e}function m(){var e=(0,s.default)([""," times, locale is (",", ",")"]);return m=function(){return e},e}function g(){var e=(0,s.default)([""," times, locale is ",""]);return g=function(){return e},e}var v="%F0%9F%8C%90",E=self.location.href;E&&E.includes("/".concat(v,"/"))&&Promise.resolve().then(r.bind(r,74185)).then((({default:e})=>{e.canMuckHistory()&&window.history.replaceState({},"","/")}));var y="en-gb",S={LTR:"LTR",RTL:"RTL"},T={LTR:"style",RTL:"style_rtl"},b=d.default.L10N_PRIORITY;class A extends l.default{constructor(){super({l:d.default.L10N.DEFAULT,priority:b.DEFAULT,loc:d.default.L10N.DEFAULT},r(31881).default,d.default.MARK_TRANSLATIONS);var e=function(){if((0,c.isConnectedToPage)())return document.querySelector("html").getAttribute("loc")}(),t={};this._considerLocale(t,e,b.PREVIOUS)&&this.downloadAndSetTranslation(t)}getLocale(){return this._locale.l}getFullLocale(){return this._locale.loc.replace("_","-")}normalizeForm(e=""){if(!p.default.isTrident)return e.normalize("NFKD");try{return e.normalize("NFKD")}catch(t){return e}}setLocale(e,t){var r=this;return(0,i.default)((function*(){var a={l:r._locale.l,priority:r._locale.priority,loc:r._locale.l};return r._considerLocale(a,e,t)?r.downloadAndSetTranslation(a):Promise.resolve()}))()}isLocaleSupported(e){try{return super.isLocaleSupported(e)&&(!self.Intl||Array.isArray(self.Intl.Collator.supportedLocalesOf(e)))}catch(e){return!1}}init(e){var t,r={l:d.default.L10N.DEFAULT,priority:b.DEFAULT,loc:d.default.L10N.DEFAULT};if(this._considerLocale(r,e,b.PREVIOUS),this._considerLocale(r,(t=(E||self.location.href||"").split("/".concat(v,"/"))).length>1?t[1].split("/")[0]:void 0,b.URL),this._considerLocale(r,navigator.language,b.BROWSER),navigator.languages&&navigator.languages.length)for(var a=0;a<navigator.languages.length&&!this._considerLocale(r,navigator.languages[a],b.BROWSER);a++);return this.downloadAndSetTranslation(r)}_considerLocale(e,t,r){if(!(null!=e.priority&&r<e.priority)&&null!=t&&t!==this.getLocale()){var a=this.normalizeLocale(t);return a?(e.l=a,e.priority=r,e.loc=t,e):void 0}}downloadAppLocale(e){return this.localeStrings[e]?Promise.resolve(this.localeStrings[e]):Promise.loop(function(){var t=(0,i.default)((function*(t,a,n){var i=(0,o.delayMs)(f.expBackoff(n,12e4,1e3,.1));return(yield r(48729)("./".concat(e))).default().then((([e])=>t(e))).catch((()=>(10===n&&(__LOG__(4,void 0,new Error,!0)(g(),n,e),SEND_LOGS("downadAppLocale failure")),i)))}));return function(){return t.apply(this,arguments)}}())}downloadMomentLocale(e){var{l:t,loc:a}=e;return u.default.locale()===a?Promise.resolve():Promise.loop(function(){var e=(0,i.default)((function*(e,n,i){var s=(0,o.delayMs)(f.expBackoff(i,12e4,1e3,.1)),u=()=>Promise.resolve();if(a!==d.default.L10N.DEFAULT)try{u=(yield r(77062)("./".concat(a))).default}catch(e){try{u=(yield r(77062)("./".concat(a))).default}catch(e){u=()=>Promise.resolve()}}return u().then((()=>e())).catch((()=>(10===i&&(__LOG__(4,void 0,new Error,!0)(m(),i,t,a),SEND_LOGS("downloadMomentLocale failure")),s)))}));return function(){return e.apply(this,arguments)}}())}downloadAndSetTranslation(e){var{l:t,loc:a}=this._locale,{l:n,loc:i}=e,s=this.isRTL(n),o=s?S.RTL:S.LTR;if((0,c.isConnectedToPage)()&&n===t&&document.getElementById(T[o])&&i===a)return Promise.resolve();this._fetchPromise&&this._fetchPromise.cancel();var l,f,p=self.performance.now();return this._fetchPromise=Promise.all([this.downloadAppLocale(n),this.downloadMomentLocale(e)]).then((([t])=>{l=self.performance.now(),this.localeStrings[n]=t,this._locale=e,this.trigger("set_collator",n);var r=[i,n,y].filter((e=>!!e));u.default.locale(r),this.customizeMomentLocale(u.default.locale()),(0,c.isConnectedToPage)()&&(document.documentElement&&document.documentElement.setAttribute("lang",e.l),document.documentElement&&document.documentElement.setAttribute("dir",o)),this.trigger("locale_change",n)})).then((()=>{if(f=self.performance.now(),__LOG__(2)(_(),t,a,n,i,l-p,f-l),r(58906).default.supported){var e=r(30734).default,o=r(99215).default;navigator.serviceWorker&&navigator.serviceWorker.controller&&e.request(navigator.serviceWorker.controller,o.SET_L10N,{isRTL:s,locale:n}).catch((()=>{}))}})).catch((()=>(__LOG__(2)(h(),t,a,n,i),this.downloadAndSetTranslation({l:d.default.L10N.DEFAULT,priority:b.DEFAULT,loc:d.default.L10N.DEFAULT}))))}_updateElectronMain(){}customizeMomentLocale(e){var t=l.LOCALE_CUSTOMIZATIONS[e];t&&u.default.locale(e,t)}}A.Dir=S;var C=new A;t.default=C},26385:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r={ach:{name:"Acholi",numbers:[1,2],plurals:e=>Number(e>1)},af:{name:"Afrikaans",numbers:[1,2],plurals:e=>Number(1!=e)},ak:{name:"Akan",numbers:[1,2],plurals:e=>Number(e>1)},am:{name:"Amharic",numbers:[1,2],plurals:e=>Number(e>1)},an:{name:"Aragonese",numbers:[1,2],plurals:e=>Number(1!=e)},ar:{name:"Arabic",numbers:[0,1,2,3,11,100],plurals:e=>Number(0===e?0:1==e?1:2==e?2:e%100>=3&&e%100<=10?3:e%100>=11?4:5)},arn:{name:"Mapudungun",numbers:[1,2],plurals:e=>Number(e>1)},ast:{name:"Asturian",numbers:[1,2],plurals:e=>Number(1!=e)},ay:{name:"Aymar",numbers:[1],plurals:()=>0},az:{name:"Azerbaijani",numbers:[1,2],plurals:e=>Number(1!=e)},be:{name:"Belarusian",numbers:[1,2,5],plurals:e=>Number(e%10==1&&e%100!=11?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2)},bg:{name:"Bulgarian",numbers:[1,2],plurals:e=>Number(1!=e)},bn:{name:"Bengali",numbers:[1,2],plurals:e=>Number(1!=e)},bo:{name:"Tibetan",numbers:[1],plurals:()=>0},br:{name:"Breton",numbers:[1,2],plurals:e=>Number(e>1)},bs:{name:"Bosnian",numbers:[1,2,5],plurals:e=>Number(e%10==1&&e%100!=11?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2)},ca:{name:"Catalan",numbers:[1,2],plurals:e=>Number(1!=e)},cgg:{name:"Chiga",numbers:[1],plurals:()=>0},cs:{name:"Czech",numbers:[1,2,5],plurals:e=>Number(1==e?0:e>=2&&e<=4?1:2)},csb:{name:"Kashubian",numbers:[1,2,5],plurals:e=>Number(1==e?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2)},cy:{name:"Welsh",numbers:[1,2,3,8],plurals:e=>Number(1==e?0:2==e?1:8!=e&&11!=e?2:3)},da:{name:"Danish",numbers:[1,2],plurals:e=>Number(1!=e)},de:{name:"German",numbers:[1,2],plurals:e=>Number(1!=e)},dz:{name:"Dzongkha",numbers:[1],plurals:()=>0},el:{name:"Greek",numbers:[1,2],plurals:e=>Number(1!=e)},en:{name:"English",numbers:[1,2],plurals:e=>Number(1!=e)},eo:{name:"Esperanto",numbers:[1,2],plurals:e=>Number(1!=e)},es:{name:"Spanish",numbers:[1,2],plurals:e=>Number(1!=e)},es_ar:{name:"Argentinean Spanish",numbers:[1,2],plurals:e=>Number(1!=e)},et:{name:"Estonian",numbers:[1,2],plurals:e=>Number(1!=e)},eu:{name:"Basque",numbers:[1,2],plurals:e=>Number(1!=e)},fa:{name:"Persian",numbers:[1],plurals:()=>0},fi:{name:"Finnish",numbers:[1,2],plurals:e=>Number(1!=e)},fil:{name:"Filipino",numbers:[1,2],plurals:e=>Number(e>1)},fo:{name:"Faroese",numbers:[1,2],plurals:e=>Number(1!=e)},fr:{name:"French",numbers:[1,2],plurals:e=>Number(e>1)},fur:{name:"Friulian",numbers:[1,2],plurals:e=>Number(1!=e)},fy:{name:"Frisian",numbers:[1,2],plurals:e=>Number(1!=e)},ga:{name:"Irish",numbers:[1,2,3,7,11],plurals:e=>Number(1==e?0:2==e?1:e<7?2:e<11?3:4)},gd:{name:"Scottish Gaelic",numbers:[1,2,3,20],plurals:e=>Number(1==e||11==e?0:2==e||12==e?1:e>2&&e<20?2:3)},gl:{name:"Galician",numbers:[1,2],plurals:e=>Number(1!=e)},gu:{name:"Gujarati",numbers:[1,2],plurals:e=>Number(1!=e)},gun:{name:"Gun",numbers:[1,2],plurals:e=>Number(e>1)},ha:{name:"Hausa",numbers:[1,2],plurals:e=>Number(1!=e)},he:{name:"Hebrew",numbers:[1,2],plurals:e=>Number(1!=e)},hi:{name:"Hindi",numbers:[1,2],plurals:e=>Number(1!=e)},hr:{name:"Croatian",numbers:[1,2,5],plurals:e=>Number(e%10==1&&e%100!=11?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2)},hu:{name:"Hungarian",numbers:[1,2],plurals:e=>Number(1!=e)},hy:{name:"Armenian",numbers:[1,2],plurals:e=>Number(1!=e)},ia:{name:"Interlingua",numbers:[1,2],plurals:e=>Number(1!=e)},id:{name:"Indonesian",numbers:[1],plurals:()=>0},is:{name:"Icelandic",numbers:[1,2],plurals:e=>Number(e%10!=1||e%100==11)},it:{name:"Italian",numbers:[1,2],plurals:e=>Number(1!=e)},ja:{name:"Japanese",numbers:[1],plurals:()=>0},jbo:{name:"Lojban",numbers:[1],plurals:()=>0},jv:{name:"Javanese",numbers:[0,1],plurals:e=>Number(0!==e)},ka:{name:"Georgian",numbers:[1],plurals:()=>0},kk:{name:"Kazakh",numbers:[1],plurals:()=>0},km:{name:"Khmer",numbers:[1],plurals:()=>0},kn:{name:"Kannada",numbers:[1,2],plurals:e=>Number(1!=e)},ko:{name:"Korean",numbers:[1],plurals:()=>0},ku:{name:"Kurdish",numbers:[1,2],plurals:e=>Number(1!=e)},kw:{name:"Cornish",numbers:[1,2,3,4],plurals:e=>Number(1==e?0:2==e?1:3==e?2:3)},ky:{name:"Kyrgyz",numbers:[1],plurals:()=>0},lb:{name:"Letzeburgesch",numbers:[1,2],plurals:e=>Number(1!=e)},ln:{name:"Lingala",numbers:[1,2],plurals:e=>Number(e>1)},lo:{name:"Lao",numbers:[1],plurals:()=>0},lt:{name:"Lithuanian",numbers:[1,2,10],plurals:e=>Number(e%10==1&&e%100!=11?0:e%10>=2&&(e%100<10||e%100>=20)?1:2)},lv:{name:"Latvian",numbers:[0,1,2],plurals:e=>Number(e%10==1&&e%100!=11?0:0!==e?1:2)},mai:{name:"Maithili",numbers:[1,2],plurals:e=>Number(1!=e)},mfe:{name:"Mauritian Creole",numbers:[1,2],plurals:e=>Number(e>1)},mg:{name:"Malagasy",numbers:[1,2],plurals:e=>Number(e>1)},mi:{name:"Maori",numbers:[1,2],plurals:e=>Number(e>1)},mk:{name:"Macedonian",numbers:[1,2],plurals:e=>Number(1==e||e%10==1?0:1)},ml:{name:"Malayalam",numbers:[1,2],plurals:e=>Number(1!=e)},mn:{name:"Mongolian",numbers:[1,2],plurals:e=>Number(1!=e)},mnk:{name:"Mandinka",numbers:[0,1,2],plurals:e=>Number(0===e?0:1==e?1:2)},mr:{name:"Marathi",numbers:[1,2],plurals:e=>Number(1!=e)},ms:{name:"Malay",numbers:[1],plurals:()=>0},mt:{name:"Maltese",numbers:[1,2,11,20],plurals:e=>Number(1==e?0:0===e||e%100>1&&e%100<11?1:e%100>10&&e%100<20?2:3)},nah:{name:"Nahuatl",numbers:[1,2],plurals:e=>Number(1!=e)},nap:{name:"Neapolitan",numbers:[1,2],plurals:e=>Number(1!=e)},nb:{name:"Norwegian Bokmal",numbers:[1,2],plurals:e=>Number(1!=e)},ne:{name:"Nepali",numbers:[1,2],plurals:e=>Number(1!=e)},nl:{name:"Dutch",numbers:[1,2],plurals:e=>Number(1!=e)},nn:{name:"Norwegian Nynorsk",numbers:[1,2],plurals:e=>Number(1!=e)},no:{name:"Norwegian",numbers:[1,2],plurals:e=>Number(1!=e)},nso:{name:"Northern Sotho",numbers:[1,2],plurals:e=>Number(1!=e)},oc:{name:"Occitan",numbers:[1,2],plurals:e=>Number(e>1)},or:{name:"Oriya",numbers:[2,1],plurals:e=>Number(1!=e)},pa:{name:"Punjabi",numbers:[1,2],plurals:e=>Number(1!=e)},pap:{name:"Papiamento",numbers:[1,2],plurals:e=>Number(1!=e)},pl:{name:"Polish",numbers:[1,2,5],plurals:e=>Number(1==e?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2)},pms:{name:"Piemontese",numbers:[1,2],plurals:e=>Number(1!=e)},ps:{name:"Pashto",numbers:[1,2],plurals:e=>Number(1!=e)},pt:{name:"Portuguese",numbers:[1,2],plurals:e=>Number(1!=e)},"pt-BR":{name:"Brazilian Portuguese",numbers:[1,2],plurals:e=>Number(1!=e)},rm:{name:"Romansh",numbers:[1,2],plurals:e=>Number(1!=e)},ro:{name:"Romanian",numbers:[1,2,20],plurals:e=>Number(1==e?0:0===e||e%100>0&&e%100<20?1:2)},ru:{name:"Russian",numbers:[1,2,5],plurals:e=>Number(e%10==1&&e%100!=11?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2)},sah:{name:"Yakut",numbers:[1],plurals:()=>0},sco:{name:"Scots",numbers:[1,2],plurals:e=>Number(1!=e)},se:{name:"Northern Sami",numbers:[1,2],plurals:e=>Number(1!=e)},si:{name:"Sinhala",numbers:[1,2],plurals:e=>Number(1!=e)},sk:{name:"Slovak",numbers:[1,2,5],plurals:e=>Number(1==e?0:e>=2&&e<=4?1:2)},sl:{name:"Slovenian",numbers:[5,1,2,3],plurals:e=>Number(e%100==1?1:e%100==2?2:e%100==3||e%100==4?3:0)},so:{name:"Somali",numbers:[1,2],plurals:e=>Number(1!=e)},son:{name:"Songhay",numbers:[1,2],plurals:e=>Number(1!=e)},sq:{name:"Albanian",numbers:[1,2],plurals:e=>Number(1!=e)},sr:{name:"Serbian",numbers:[1,2,5],plurals:e=>Number(e%10==1&&e%100!=11?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2)},su:{name:"Sundanese",numbers:[1],plurals:()=>0},sv:{name:"Swedish",numbers:[1,2],plurals:e=>Number(1!=e)},sw:{name:"Swahili",numbers:[1,2],plurals:e=>Number(1!=e)},ta:{name:"Tamil",numbers:[1,2],plurals:e=>Number(1!=e)},te:{name:"Telugu",numbers:[1,2],plurals:e=>Number(1!=e)},tg:{name:"Tajik",numbers:[1,2],plurals:e=>Number(e>1)},th:{name:"Thai",numbers:[1],plurals:()=>0},ti:{name:"Tigrinya",numbers:[1,2],plurals:e=>Number(e>1)},tk:{name:"Turkmen",numbers:[1,2],plurals:e=>Number(1!=e)},tr:{name:"Turkish",numbers:[1,2],plurals:e=>Number(e>1)},tt:{name:"Tatar",numbers:[1],plurals:()=>0},ug:{name:"Uyghur",numbers:[1],plurals:()=>0},uk:{name:"Ukrainian",numbers:[1,2,5],plurals:e=>Number(e%10==1&&e%100!=11?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2)},ur:{name:"Urdu",numbers:[1,2],plurals:e=>Number(1!=e)},uz:{name:"Uzbek",numbers:[1,2],plurals:e=>Number(e>1)},vi:{name:"Vietnamese",numbers:[1],plurals:()=>0},wa:{name:"Walloon",numbers:[1,2],plurals:e=>Number(e>1)},wo:{name:"Wolof",numbers:[1],plurals:()=>0},yo:{name:"Yoruba",numbers:[1,2],plurals:e=>Number(1!=e)},zh:{name:"Chinese",numbers:[1],plurals:()=>0}};t.default=r},12824:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LabelItemParentType=void 0;var a=r(28103).Mirrored(["Chat","Contact","Msg"]);t.LabelItemParentType=a},28352:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.initializeLabels=function(e){var t=l(e);if(i.default.supportsFeature(i.default.F.MD_BACKEND))e.labels=r(23539).default.getLabelsForModel(e.id.toString(),t);else{var a=()=>{u(e.id.toString(),e.labels,t)};a(),e.listenTo(e,"change:labels",a)}},t.addToLabelCollection=u,t.removeLabelFromCollection=function(e,t,a){var n=r(23539).default.get(t),u=null==n?void 0:n.labelItemCollection;if(!u)return void __LOG__(3)(o(),t);u.remove(d(e,t,a)),i.default.supportsFeature(i.default.F.MD_BACKEND)&&a===s.LabelItemParentType.Chat&&u.remove(d(e,t,s.LabelItemParentType.Contact))},t.getParentCollection=function(e){switch(e){case s.LabelItemParentType.Chat:return r(43334).default;case s.LabelItemParentType.Contact:return r(7470).default;case s.LabelItemParentType.Msg:return r(58885).default}},t.getParentTypeFromModel=l,t.createLabelItemId=d;var n=a(r(19976)),i=a(r(18120)),s=r(12824);function o(){var e=(0,n.default)(["labelItemCollection does not exist for lableId ",""]);return o=function(){return e},e}function u(e,t,a){if(t&&t.length>0){var n=r(23539).default;t.forEach((t=>{var r=n.gadd({id:t});r.labelItemCollection.gadd({id:d(e,t,a),labelId:t,parentId:e,parentType:a}),i.default.supportsFeature(i.default.F.MD_BACKEND)&&a===s.LabelItemParentType.Chat&&r.labelItemCollection.gadd({id:d(e,t,s.LabelItemParentType.Contact),labelId:t,parentId:e,parentType:s.LabelItemParentType.Contact})}))}}function l(e){if(e instanceof r(46774).default)return s.LabelItemParentType.Chat;if(e instanceof r(40147).default)return s.LabelItemParentType.Contact;if(e instanceof r(27e3).default)return s.LabelItemParentType.Msg;throw new Error("getParentTypeFromModel: model is invalid")}function d(e,t,r){return"".concat(e,"_").concat(t,"_").concat(r)}},28520:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=M;var n=a(r(19976)),i=a(r(52954)),s=(a(r(15410)),a(r(12767))),o=a(r(18120)),u=r(13772),l=r(11824),d=r(63925),c=(a(r(23109)),r(95595)),f=a(r(50935)),p=r(82284),h=r(66870),_=r(11008),m=r(66824),g=r(39174),v=r(85027),E=a(r(38165)),y=r(35914),S=r(54086),T=r(48148),b=a(r(79711)),A=a(r(9383)),C=r(15447),P=a(r(76936));function O(){var e=(0,n.default)(["storageInitializationError triggered logout: ","."]);return O=function(){return e},e}function w(){return(0,S.startComms)(E.default,y.sendPing),(0,S.waitForConnection)().then((()=>(0,S.startHandlingRequests)()))}function M(e){var t=(0,u.makeBridge)();(0,l.setBridge)(t),(0,d.requireSetHandlers)().then((e=>e(t)));var r=Promise.resolve();return o.default.supportsFeature(o.default.F.MD_BACKEND)?r=(0,h.initEncSalt)().then((()=>(0,h.initEncSaltForInvoker)())).then((()=>(0,m.initialize)())).catch((e=>{__LOG__(4,void 0,new Error,void 0,["launch_socket"])(O(),(null==e?void 0:e.message)||(null==e?void 0:e.name)),b.default.storageInitializationError()})).then((()=>P.default.isLogoutInProgress?Promise.reject(new Error("aborting launchSocket due to logout")):(0,g.isRegistered)()?(b.default.initialLoadReady(),(0,_.initialize)().catch((()=>b.default.storageInitializationError())).then((()=>{b.default.incrementProgress(),(0,p.restoreGroupsContactsAndProfilePics)()})).then((()=>(0,p.restoreBlocklist)())).then((()=>{b.default.incrementProgress(),(0,v.startBackend)()}))):(b.default.incrementProgress(),Promise.all([(0,T.refreshNoiseCredentials)(),(0,T.refreshSignalCredentials)()]).then((()=>{b.default.incrementProgress(),w()}))))):s.default.launch(e),r}b.default.on("md_downgrade_webclient",(0,i.default)((function*(){(0,S.stopComms)(),yield(0,h.deleteEncKeysAndCache)(),s.default.set({launched:!1,stream:f.default.SOCKET_STREAM.DISCONNECTED,mustExitLoop:!1,shouldUpgradeToMD:!1}),(0,c.setMdOptedIn)(!1),o.default.setFeature(o.default.F.MD_BACKEND,!1),o.default.setFeature(o.default.F.MD_ADV,!1),o.default.setFeature(o.default.F.MD_VOIP_GROUP,!1),s.default.initialize(),s.default.handler||s.default.registerHandler(A.default),M(!0)}))),b.default.on("upgrade_to_md",(()=>{(0,c.setMdOptedIn)(!0),o.default.setFeature(o.default.F.MD_BACKEND,!0),o.default.setFeature(o.default.F.MD_ADV,!0),o.default.setFeature(o.default.F.MD_VOIP_GROUP,!1),M(!0),(0,C.setDeviceLinkMdUpgrade)()})),b.default.on("upgrade_to_md_prod",(()=>{(0,c.setMdOptedIn)(!0),o.default.setFeature(o.default.F.MD_BACKEND,!0),o.default.setFeature(o.default.F.MD_ADV,!0),o.default.setFeature(o.default.F.MD_VOIP_GROUP,!1),M(!0),(0,C.setDeviceLinkMdUpgrade)()})),b.default.on("md_refresh_qr",(()=>{(0,S.stopComms)(),w()})),b.default.on("logout",(()=>{o.default.supportsFeature(o.default.F.MD_BACKEND)&&M(!0)}))},65466:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(52954)),i=a(r(19976));function s(){var e=(0,i.default)(["LazyPoll[","]: Manually Resumed"]);return s=function(){return e},e}function o(){var e=(0,i.default)(["LazyPoll[","]: Manually Paused"]);return o=function(){return e},e}function u(){var e=(0,i.default)(["LazyPoll[","]: Polling..."]);return u=function(){return e},e}function l(){var e=(0,i.default)(["LazyPoll[","]: Active Resuming"]);return l=function(){return e},e}function d(){var e=(0,i.default)(["LazyPoll[","]: Inactive slowing down"]);return d=function(){return e},e}function c(){var e=(0,i.default)(["LazyPoll[","]: Inactive paused"]);return c=function(){return e},e}t.default=class{constructor({name:e,handler:t=null,interval:r=3600,restingInterval:a=18e3,sleepWhileResting:n=!1,randomIntervalExtension:i=0}){if(this._running=!1,this._slowDown=!1,this._name=e,this._interval=1e3*r,this._restingInterval=1e3*a,this._sleepWhileResting=n,this._randomIntervalExtension=1e3*i,this._rest(),"function"==typeof t)this.poll(t);else if(null!=t)throw new Error("Poll handler must be a function or null")}_getRandomExtension(){return Math.ceil(Math.random()*this._randomIntervalExtension)}_getInterval(){return(this._slowDown?this._restingInterval:this._interval)+this._getRandomExtension()}_rest(){document.addEventListener("visibilitychange",(()=>{this._lock||(document.hidden?this._sleepWhileResting?(__LOG__(2)(c(),this._name),this._pause()):(__LOG__(2)(d(),this._name),this._slowDown=!0):this._callback&&(__LOG__(2)(l(),this._name),this._resume()))}),!1)}_isDue(){return!this._lastPoll||Date.now()-this._lastPoll>=this._getInterval()}_pause(){clearTimeout(this._timer),this._running=!1}_resume(){this._slowDown=!1,this._running=!0,this._cycle()}_cycle(){var e=this;return(0,n.default)((function*(){e._running&&(e._isDue()&&(__LOG__(2)(u(),e._name),yield e._callback(),e._lastPoll=Date.now()),clearTimeout(e._timer),e._timer=setTimeout((()=>e._cycle()),e._getInterval()))}))()}poll(e){null==this._callback?(this._callback=e,this._running=!0,this._cycle()):this.resume()}pause(){__LOG__(2)(o(),this._name),this._lock=!0,this._pause()}resume(){__LOG__(2)(s(),this._name),this._lock=!1,this._resume()}}},90088:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.findLinks=function(e,t=!1,r){if(!M.test(e))return[];w.lastIndex=0;var a,n=[];for(;a=I(e);){var i=D(a,t,r);i&&n.push(i)}return n},t.findLink=R,t.validateEmail=function(e){var t=R(e);return t&&t.url===e&&"mailto:"===t.scheme&&t.username&&!t.params&&!t.anchor?t:null};var n=a(r(19976)),i=r(41263),s=r(24569),o=a(r(52737)),u=r(95595),l=r(25270);function d(){var e=(0,n.default)(["text size: ",", error: ",""]);return d=function(){return e},e}var c=/^https?:\/\/$/gi,f="\\w|[^\\s\0-]|%[0-9a-f][0-9a-f]",p="(?:".concat(f,")|(?:").concat(f,")(?:").concat(f,"|-)*(?:").concat(f,")"),h="(?!_)(?:(?:".concat(p,")\\.)+(?:").concat(l.TLD,")(?!\\.").concat(p,")"),_="(?:".concat(f,"|[^\\s%])"),m="/".concat(_,"*?"),g="[".concat("+@!.?,(\\[{<:","]*(?!").concat(_,"|#)"),v="\\?(?!".concat(g,")").concat(_,"*?"),E="#".concat(_,"*?"),y="0-9a-z!#$%&'*+/=?^_`{|}~\\-",S="\\b\\w[".concat(y,"]*(?:\\.[").concat(y,"]+)*"),T="(".concat("^|\\W\\.|[^/\\w.]|_",")(").concat("(?:http|https)://|mailto:",")?(").concat(S,"@)?(").concat(h,")(?:(?!").concat(p,")|(?=_))(?:(?=[^:/?#])|(").concat(":\\d{1,5}",")?(").concat(m,")?(").concat(v,")?(").concat(E,")?(?=").concat(g,"))"),b=6,A=7,C=8,P=new Map([[34,34],[41,40],[62,60],[93,91],[125,123],[187,171],[8217,8216],[8221,8220]]),O=new Map([[34,34],[40,41],[60,62],[91,93],[123,125],[171,187],[8216,8217],[8220,8221]]),w=new RegExp("".concat(T),"ig"),M=new RegExp("\\.(?:".concat(l.TLD,")"),"i");function I(e){try{return w.exec(e)}catch(t){return __LOG__(4,void 0,new Error,!0)(d(),e.length,String(t)),SEND_LOGS("linkify-regex-error"),null}}function R(e,t=!1,r){return w.lastIndex=0,D(I(e),t,r)}function D(e,t=!1,r){if(!e)return null;var a=e[1].length,n=e[0],l=e.index+a,{index:d}=e;if("_"===e[1]&&d-1&&/\S/.test(e.input[d-1]))return null;if(e[5]){var f=parseInt(e[5].slice(1),10);if("0"===e[5][1]||!(0<f&&f<65536))return null}var p=[C,A,b].find((t=>e&&e[t]))||0;if(p){var h=[],_=e[p];"_"===_.slice(-1)&&"_"===n[l-1]&&(n=n.slice(0,-1),e[p]=_=_.slice(0,-1));for(var m=0,g=0,v=0;v<_.length;v++){var E=_.charCodeAt(v);E===g?0===(g=h.pop()||0)&&(m=v):O.has(E)?(0!==g&&h.push(g),g=O.get(E)):P.has(E)||0===g&&(m=v)}for(;0!==h.length;)h.pop();m!==_.length-1?(n=e.slice(2,p).filter((e=>e)).join("")+_.slice(0,m+1),w.lastIndex=l+n.length):n=n.slice(a)}else n=n.slice(a);var y=n,S=e[2],T=Boolean(S&&S.match(c));if(t&&!T)return null;S?S=S.toLowerCase():(S=0===y.toLowerCase().indexOf("irc.")?"irc://":0===y.toLowerCase().indexOf("ftp.")?"ftp://":e[3]?"mailto:":"http://",y=S+y);var M=e[4],I=(0,u.getMaybeMeUser)();return{href:y,url:n,index:l,input:e.input,scheme:S,username:e[3],domain:M,port:e[5],path:e[b],params:e[A],anchor:e[C],isHttp:T,suspiciousCharacters:r&&I?(0,s.findSuspiciousCharacters)(M,(0,i.toJid)(r.user),(0,i.toJid)(I.user),o.default.allLanguages):void 0}}},80521:(e,t)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;try{r=window.localStorage}catch(e){}var a=r;t.default=a},15410:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.log=t.default=void 0;var n=a(r(52954)),i=a(r(16760)),s=r(39329),o=a(r(19034)),u=a(r(50935)),l=a(r(26890)),d=a(r(1985)),c=a(r(67015)),f=u.default.LOG_SIZE_WEB,p=Date.now(),h="LTSXOo+_*-=.<^!#?".split("");function _(){return h[Math.round(Math.random()*(h.length-1))]}var m=_()+_()+_()+_(),g={};g[g.ALL=0]="all",g[g.INFO=1]="info",g[g.LOG=2]="log",g[g.WARN=3]="warn",g[g.ERROR=4]="error",g[g.OFF=5]="off";function v(e){switch(e){case g.INFO:case g.LOG:case g.WARN:case g.ERROR:return g[e];default:throw new Error("Unexpected numeric log level: ".concat(e))}}var E=new class{constructor(){this.logs=[],this.localCursor=0,this.pending=void 0,this.timer=new s.ShiftTimer((()=>this._persistIdb())),this.isTakeOver=!1,this.log=(0,d.default)(((e,t=!1,r,a,n)=>(i,...s)=>{var o=(0,l.default)(i,s,!t);return this.logImpl(e,o,r,a,n),o}),((e,t,r,a,n)=>r||n?null:String(e)+String(Boolean(t))+String(Boolean(a))))}logImpl(e,t,r,a,n){var i=(0,o.default)().locale("en").format("YYYY-MM-DD HH:mm:ss.SSS:"),s=r?"\n".concat((0,c.default)(r,!0)):"",u=[v(e),a?"sendlogs":null,...null!=n?n:[]].filter(Boolean).map((e=>"[".concat(e,"]"))).join(""),l="".concat(m," ").concat(i)+(u?"".concat(u," "):"")+t+s;this.logs.push(l),this.isTakeOver||(this.logs.length>f&&(this.logs.shift(),this.localCursor--),this.timer.debounceAndCap(250,1e3))}logUncaughtError(e,t){var r,a=e instanceof Error&&e.stack?e:void 0;if(r=a?String(e):t?"Promise rejected: ".concat(String(e)):"Error: ".concat(String(e)),this.logImpl(g.ERROR,r,a,!0,["uncaught"]),null!=t){var n=String(t);this.logImpl(g.WARN,n)}}onTakeOver(){this.isTakeOver=!0}getLogs(){var e=r(77771).default,t=[];return this.pending&&t.push(this.pending),this.timer.isScheduled()&&(this.timer.forceRunNow(),this.pending&&t.push(this.pending)),Promise.all(t).then((()=>e.idb())).then(function(){var e=(0,n.default)((function*(e){var t=[];return yield e.logs.orderBy("timestamp").each((e=>{e.log=e.log.slice(0,2500),t.push(e)})),t}));return function(){return e.apply(this,arguments)}}()).then((e=>(0,i.default)(e,"log"))).catch((()=>this.logs))}clearLogs(){r(77771).default.idb().then((e=>e.logs.clear())).catch((()=>{})),this._setCursor(0),this.localCursor=0,this.logs=[]}_optimisticallyAdvanceCursor(e,t){this.localCursor+=t,this._setCursor((e+t)%f)}_persistIdb(){var e=r(77771).default,t=this.logs.slice(Math.max(this.localCursor,0),this.logs.length);t.length&&(this.pending=e.idb().then((e=>e.transaction("rw",e.logs,e.user,(()=>{var r=this._getCursor();this._optimisticallyAdvanceCursor(r,t.length),t.forEach((t=>{r=(r+1)%f,e.logs.put({line:r,log:t,timestamp:performance&&performance.now()+p||Date.now()})}))})))).catch((()=>{})).finally((()=>{this.pending=void 0})))}_getCursor(){var e=r(77771).default;try{return JSON.parse(e.permanentStorage.getItem(u.default.KEY_LOG_CURSOR))||Math.max(this.localCursor,0)}catch(e){return Math.max(this.localCursor,0)}}_setCursor(e){return r(77771).default.permanentStorage.setItem(u.default.KEY_LOG_CURSOR,String(e))}},y=E;t.default=y;var S=E.log;t.log=S},68560:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(30733)),i=r(60339);function s(e,t){var r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r}function o(e,t,r,a,n,i){return s((o=s(s(t,e),s(a,i)))<<(u=n)|o>>>32-u,r);var o,u}function u(e,t,r,a,n,i,s){return o(t&r|~t&a,e,t,n,i,s)}function l(e,t,r,a,n,i,s){return o(t&a|r&~a,e,t,n,i,s)}function d(e,t,r,a,n,i,s){return o(t^r^a,e,t,n,i,s)}function c(e,t,r,a,n,i,s){return o(r^(t|~a),e,t,n,i,s)}function f(e){return function(e,t){var r,a,n,i;e[t>>5]|=128<<t%32,e[14+(t+64>>>9<<4)]=t;for(var o=1732584193,f=-271733879,p=-1732584194,h=271733878,_=0;_<e.length;_+=16)r=o,a=f,n=p,i=h,o=u(o,f,p,h,e[_],7,-680876936),h=u(h,o,f,p,e[_+1],12,-389564586),p=u(p,h,o,f,e[_+2],17,606105819),f=u(f,p,h,o,e[_+3],22,-1044525330),o=u(o,f,p,h,e[_+4],7,-176418897),h=u(h,o,f,p,e[_+5],12,1200080426),p=u(p,h,o,f,e[_+6],17,-1473231341),f=u(f,p,h,o,e[_+7],22,-45705983),o=u(o,f,p,h,e[_+8],7,1770035416),h=u(h,o,f,p,e[_+9],12,-1958414417),p=u(p,h,o,f,e[_+10],17,-42063),f=u(f,p,h,o,e[_+11],22,-1990404162),o=u(o,f,p,h,e[_+12],7,1804603682),h=u(h,o,f,p,e[_+13],12,-40341101),p=u(p,h,o,f,e[_+14],17,-1502002290),o=l(o,f=u(f,p,h,o,e[_+15],22,1236535329),p,h,e[_+1],5,-165796510),h=l(h,o,f,p,e[_+6],9,-1069501632),p=l(p,h,o,f,e[_+11],14,643717713),f=l(f,p,h,o,e[_],20,-373897302),o=l(o,f,p,h,e[_+5],5,-701558691),h=l(h,o,f,p,e[_+10],9,38016083),p=l(p,h,o,f,e[_+15],14,-660478335),f=l(f,p,h,o,e[_+4],20,-405537848),o=l(o,f,p,h,e[_+9],5,568446438),h=l(h,o,f,p,e[_+14],9,-1019803690),p=l(p,h,o,f,e[_+3],14,-187363961),f=l(f,p,h,o,e[_+8],20,1163531501),o=l(o,f,p,h,e[_+13],5,-1444681467),h=l(h,o,f,p,e[_+2],9,-51403784),p=l(p,h,o,f,e[_+7],14,1735328473),o=d(o,f=l(f,p,h,o,e[_+12],20,-1926607734),p,h,e[_+5],4,-378558),h=d(h,o,f,p,e[_+8],11,-2022574463),p=d(p,h,o,f,e[_+11],16,1839030562),f=d(f,p,h,o,e[_+14],23,-35309556),o=d(o,f,p,h,e[_+1],4,-1530992060),h=d(h,o,f,p,e[_+4],11,1272893353),p=d(p,h,o,f,e[_+7],16,-155497632),f=d(f,p,h,o,e[_+10],23,-1094730640),o=d(o,f,p,h,e[_+13],4,681279174),h=d(h,o,f,p,e[_],11,-358537222),p=d(p,h,o,f,e[_+3],16,-722521979),f=d(f,p,h,o,e[_+6],23,76029189),o=d(o,f,p,h,e[_+9],4,-640364487),h=d(h,o,f,p,e[_+12],11,-421815835),p=d(p,h,o,f,e[_+15],16,530742520),o=c(o,f=d(f,p,h,o,e[_+2],23,-995338651),p,h,e[_],6,-198630844),h=c(h,o,f,p,e[_+7],10,1126891415),p=c(p,h,o,f,e[_+14],15,-1416354905),f=c(f,p,h,o,e[_+5],21,-57434055),o=c(o,f,p,h,e[_+12],6,1700485571),h=c(h,o,f,p,e[_+3],10,-1894986606),p=c(p,h,o,f,e[_+10],15,-1051523),f=c(f,p,h,o,e[_+1],21,-2054922799),o=c(o,f,p,h,e[_+8],6,1873313359),h=c(h,o,f,p,e[_+15],10,-30611744),p=c(p,h,o,f,e[_+6],15,-1560198380),f=c(f,p,h,o,e[_+13],21,1309151649),o=c(o,f,p,h,e[_+4],6,-145523070),h=c(h,o,f,p,e[_+11],10,-1120210379),p=c(p,h,o,f,e[_+2],15,718787259),f=c(f,p,h,o,e[_+9],21,-343485551),o=s(o,r),f=s(f,a),p=s(p,n),h=s(h,i);return new Uint8Array([255&o,o>>>8&255,o>>>16&255,o>>>24&255,255&f,f>>>8&255,f>>>16&255,f>>>24&255,255&p,p>>>8&255,p>>>16&255,p>>>24&255,255&h,h>>>8&255,h>>>16&255,h>>>24&255])}(function(e){var t,r=[];for(r[(e.length>>2)-1]=0,t=0;t<r.length;t+=1)r[t]=0;var a=8*e.length;for(t=0;t<a;t+=8)r[t>>5]|=(255&e.charCodeAt(t/8))<<t%32;return r}(e),8*e.length)}var p=(0,n.default)((e=>(0,i.encodeB64)(f(e))));t.default=p},92952:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.genCurrentSessionId=function(){return h.apply(this,arguments)},t.genSessionId=_;var n=a(r(52954)),i=r(46378),s=r(60339),o=r(72434),u=r(95595),l=a(r(61941)),d=a(r(12040)),c=r(44480),f=a(r(84025)),p=r(44762);function h(){return(h=(0,n.default)((function*(){var e=(0,p.createSignalAddress)((0,u.getMeUser)()).toString(),t=(0,l.default)(yield c.waSignalStore.getIdentity(e),"yield waSignalStore.getIdentity(primaryDeviceIdentifier)"),r=(0,o.toCurveKeyPubKey)((0,p.strToBuffer)(t)),a=(0,l.default)(yield d.default.getIdentityKeyPair(),"yield SignalProtocolStore.getIdentityKeyPair()");return _(r,(0,o.toCurveKeyPubKey)(a.pubKey))}))).apply(this,arguments)}function _(){return m.apply(this,arguments)}function m(){return(m=(0,n.default)((function*(e,t){if(32!==e.byteLength)throw new Error("genSessionId: primary identity public key is ".concat(e.byteLength," bytes, should be 32!"));if(32!==t.byteLength)throw new Error("genSessionId: companion identity public key is ".concat(e.byteLength," bytes, should be 32!"));var r=new i.Binary;r.writeBuffer(e),r.write("_".charCodeAt(0)),r.writeBuffer(t);var a=r.readByteArray(),n=yield f.default.digest({name:"SHA-256"},a);return(0,s.encodeB64)(n)}))).apply(this,arguments)}},29891:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.STORAGE_QUOTA_UNAVAILABLE=void 0;var n=a(r(52954)),i=a(r(25353)),s=r(92952);t.STORAGE_QUOTA_UNAVAILABLE=-1;var o=new class{constructor(){this._storageEstimation={mdStorageQuotaBytes:-2,mdStorageQuotaUsedBytes:-2},this._mdSessionId=null}getStorageEstimation(){var e=this;return(0,n.default)((function*(){if(-2!==e._storageEstimation.mdStorageQuotaBytes)return Promise.resolve(e._storageEstimation);var t=yield(0,i.default)();return e._storageEstimation={mdStorageQuotaBytes:t?t.quota:-1,mdStorageQuotaUsedBytes:t?t.usage:-1},e._storageEstimation}))()}getMdSessionId(){var e=this;return(0,n.default)((function*(){return null!=e._mdSessionId||(e._mdSessionId=yield(0,s.genCurrentSessionId)()),e._mdSessionId}))()}};t.default=o},97626:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(29351),n=r(96452);class i extends((0,a.customError)("MediaFileTooLarge",!0,n.MediaFileError)){constructor(e){super("File (".concat(e.type(),") size = ").concat(e.size())),this.opaqueData=e}}t.default=i},23765:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.getMediaTagErrorReason=P,t.loadImage=O,t.image=function(e){return O(e).then((e=>e&&e.naturalWidth>0?{img:e,fullWidth:e.naturalWidth,fullHeight:e.naturalHeight}:Promise.reject(new u.MediaLoadError("image loaded with zero width")))).catch((()=>Promise.reject(new u.MediaLoadError("unable to render image"))))},t.loadVideo=w,t.videoWidthHeightDuration=function(e){return w(e,!0).then((({video:e,fullWidth:t,fullHeight:r,duration:a})=>(M(e),{width:t,height:r,duration:a})))},t.disposeVideo=M,t.transcode=function(e,t){var r=t||e.type;return r&&r.includes(o.default.MIMETYPE_OGG)&&!b?e.size<=3e5?new c.default(e).generateBlob():Promise.reject(new u.TranscodeBlobTooLargeError):Promise.resolve(e)},t.canPlayOgg=void 0;var i=n(r(19976)),s=r(91460),o=n(r(50935)),u=a(r(96452)),l=n(r(31600)),d=n(r(40210)),c=n(r(39592)),f=n(r(77626));function p(){var e=(0,i.default)(["Error: ",""]);return p=function(){return e},e}function h(){var e=(0,i.default)(["MediaLoad:video #"," dimensions are not defined. Video readyState: ",". Video width: ",""]);return h=function(){return e},e}function _(){var e=(0,i.default)(["MediaLoad:video #"," successful"]);return _=function(){return e},e}function m(){var e=(0,i.default)(["unable to load video #"," ("," bytes)"]);return m=function(){return e},e}function g(){var e=(0,i.default)(["MediaLoad:video.onerror #",": ","\n Blob info -> size:",", type: ",""],["MediaLoad:video.onerror #",": ","\\n Blob info -> size:",", type: ",""]);return g=function(){return e},e}function v(){var e=(0,i.default)(["MediaLoad:video.oncanplay #",". Metadata loaded: ",". Video width: ",""]);return v=function(){return e},e}function E(){var e=(0,i.default)(["MediaLoad:video.onprogress #",""]);return E=function(){return e},e}function y(){var e=(0,i.default)(["MediaLoad:video.onloadeddata #",""]);return y=function(){return e},e}function S(){var e=(0,i.default)(["MediaLoad:video.onloadedmetadata #",". Video ready: ",". Video width: ",""]);return S=function(){return e},e}function T(){var e=(0,i.default)(["MediaLoad:video called (#","). Should wait for a first frame: ",""]);return T=function(){return e},e}var b=(new Audio).canPlayType("audio/ogg");t.canPlayOgg=b;var A=0,C=Promise.resolve();function P(e){if(!e||!e.error)return null;var t=e.error,r=Object.keys(l.default).find((e=>l.default[e]===t.code));r=r||"UNKNOWN CODE ".concat(t.code);var a=t.message&&~t.message.indexOf(":")?t.message.split(":")[0]:"";return a?"".concat(r,": ").concat(a):r}function O(e,t=!0){var r;return new Promise((function(a,n){r=new Image;var i=/^(?:data|blob):/.test(e);t&&!i&&r.setAttribute("crossOrigin","anonymous"),r.onload=a,r.onabort=()=>{n(new Error("loadImage onabort"))},r.onerror=()=>{n(new u.InvalidImageFileType("Image tag load error"))},r.src=e})).then((()=>r))}function w(e,t=!1){var r=C.then((()=>function(e,t=!1){var r,a,n=new d.default.WebcMediaLoad,i=null,o=++A;function l(){r&&i&&(document.body&&document.body.removeChild(i),i=null)}var c=new Promise((function(n,s){__LOG__(2)(T(),o,t);var l=!1,d=!1;if((r=document.createElement("video")).volume=0,r.muted=!0,r.playsinline=!0,r.onloadedmetadata=()=>{__LOG__(2)(S(),o,d,r.videoWidth),l=!0,!d&&t||n()},r.onloadeddata=()=>{__LOG__(2)(y(),o)},r.onprogress=()=>{__LOG__(2)(E(),o)},r.oncanplay=()=>{__LOG__(2)(v(),o,l,r.videoWidth),d=!0,l&&t&&n()},r.onerror=()=>{var t=r.error?r.error.message:"no error message";__LOG__(3)(g(),o,String(t),e.size,e.type);var a=P(r);s(new u.UnableToPlayVideoError(a))},r.src=a=window.URL.createObjectURL(e),f.default.isSafari||f.default.isBuggyVideoLoad){var c=i=document.createElement("div");c.style="opacity: 0.004",c.appendChild(r),document.body&&document.body.appendChild(c)}r.load()}));setTimeout((()=>{l(),c.isPending()&&(__LOG__(3)(m(),o,e.size),new d.default.WebcMediaLoad({webcMediaLoadResult:d.default.WEBC_MEDIA_LOAD_RESULT_CODE.SILENCE}).commit())}),8e3);var p=c.then((()=>(0,s.delayMs)(10))).then((()=>{if(n.markWebcMediaLoadT(),__LOG__(2)(_(),o),r.pause(),r.videoWidth>0)return n.webcMediaLoadResult=d.default.WEBC_MEDIA_LOAD_RESULT_CODE.SUCCESS,n.commit(),{video:r,fullWidth:r.videoWidth,fullHeight:r.videoHeight,duration:r.duration};throw r.duration>0?(__LOG__(3)(h(),o,r.readyState,r.videoWidth),new u.MediaUnsupportedError("video loaded with duration but no dims")):(n.webcMediaLoadResult=d.default.WEBC_MEDIA_LOAD_RESULT_CODE.ZEROWIDTH,n.commit(),new u.MediaLoadError("video loaded with zero width"))})).finally((()=>{l(),r&&(r.onloadedmetadata=null,r.onloadeddata=null,r.onplay=null,r.onerror=null),a&&window.URL.revokeObjectURL(a)}));return p.catch((()=>{M(r)})),p}(e,t)));return C=r.timeout(1e3).then((()=>{}),(()=>{})),r}function M(e){try{e.pause(),e.src="",e.load()}catch(e){__LOG__(4,void 0,new Error,!0)(p(),String(e)),SEND_LOGS("dispose-video-error")}}},50041:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){n.default.Cache=s},t.clearAllMemoizeCache=function(){i.forEach((e=>e.clear()))},t.MemoizeCache=void 0;var n=a(r(30733)),i=[];class s extends Map{constructor(){super(),i.push(this)}}t.MemoizeCache=s},1985:(e,t)=>{"use strict";function r(e,t){var a=function(...r){var n=t?t.apply(this,r):r[0];if(!n)return e.apply(this,r);var i=a.cache;if(i.has(n))return i.get(n);var s=e.apply(this,r);return a.cache=i.set(n,s)||i,s};return a.cache=new(r.Cache||Map),a}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,r.Cache=Map;var a=r;t.default=a},11412:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t=n.default){var r=null,a=function(a){return null!=r&&t(r.params,a)?r.params=a:r={params:a,result:e.call(this,a)},r.result};return a.clear=()=>{r=null},a};var n=a(r(88665))},77865:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(19976)),i=r(95595),s=a(r(18120)),o=a(r(41699)),u=a(r(68384)),l=r(75637);function d(){var e=(0,n.default)(["Incorrect Wid MsgKey: remote:"," p:",""]);return d=function(){return e},e}function c(){var e=(0,n.default)(["MsgKey case error: ",""]);return c=function(){return e},e}function f(){var e=(0,n.default)(["Incorrect Wid MsgKey: from:"," to:"," p:",""]);return f=function(){return e},e}function p(){var e=(0,n.default)(["No matching constructor MsgKey: ",""]);return p=function(){return e},e}function h(){var e=(0,n.default)(["Unclear constructor MsgKey: ",""]);return h=function(){return e},e}function _(){var e=(0,n.default)(["MsgKey error: id is already a MsgKey"]);return _=function(){return e},e}class m{constructor(e){var t=e;if(!t)throw new Error("MsgKey error: obj is null/undefined");t.id instanceof m&&(t=t.id,__LOG__(3)(_()));var r,a,n,o,l,g,v,E=t.from&&t.to&&t.id,y=void 0!==t.fromMe&&t.remote&&t.id,S=(0,i.getMaybeMeUser)();if(!S)throw new Error("MsgKey error: me is undefined");if(E&&y)throw __LOG__(3)(h(),JSON.stringify(t)),new Error("MsgKey error: unclear which constructor to use");if(!E&&!y)throw __LOG__(3)(p(),JSON.stringify(t)),new Error("MsgKey error: don't have a matching constructor");if(E){if(({from:r,to:a,id:n,participant:o,selfDir:l}=t),!(r instanceof u.default)||!(a instanceof u.default)||o&&!(o instanceof u.default))throw __LOG__(3)(f(),String(r),String(a),String(o)),new Error("MsgKey error: something is not a wid");l=u.default.equals(r,a)?l:void 0,u.default.equals(r,a)&&u.default.equals(r,S)?(g="out"===l,v=S):u.default.equals(r,S)?(g=!0,v=a):u.default.equals(a,S)?(g=!1,v=r):u.default.equals(r,a)&&(u.default.isGroup(r)||u.default.isBroadcast(r))?(g=!0,v=r):__LOG__(3)(c(),[r,a,n,S].join()),void 0!==g&&(this.fromMe=g),v&&(this.remote=v),n&&(this.id=n)}else if(y){if(({fromMe:g,remote:v,id:n,participant:o}=t),!(v instanceof u.default)||o&&!(o instanceof u.default))throw __LOG__(3)(d(),String(v),String(o)),new Error("MsgKey error: something is not a wid");u.default.equals(S,v)&&(l=g?"out":"in"),void 0!==g&&(this.fromMe=g),v&&(this.remote=v),n&&(this.id=n)}var T=[this.fromMe,this.remote,this.id];void 0!==l&&(this.self=l,T.push(this.self)),s.default.supportsAnyFeature(s.default.F.KEY_PARTICIPANT,s.default.F.MD_BACKEND)&&void 0!==o&&(this.participant=o,T.push(this.participant)),this._serialized=T.join("_")}toString(){return this._serialized}clone(){return new m({fromMe:this.fromMe,remote:this.remote,id:this.id,participant:this.participant})}equals(e){return e instanceof m&&this.toString()===e.toString()}static fromString(e){var{fromMe:t,remote:r,id:a,participant:n}=(0,o.default)(e);return new m({fromMe:t,remote:(0,l.createWid)(r),id:a,participant:n?(0,l.createWid)(n):void 0})}}t.default=m},41699:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){if(!e||!(0,i.isString)(e))throw new Error("MsgKey fromString error: str is null or not a string");var t=e.split("_"),r=void 0;t.length<3?__LOG__(3)(s(),e):4===t.length?"out"!==t[3]&&"in"!==t[3]&&(r=t[3]):5===t.length&&(r=t[4]);return{fromMe:"true"===t[0],remote:t[1],id:t[2],participant:r}};var n=a(r(19976)),i=r(11419);function s(){var e=(0,n.default)(["MsgKey error: cannot create MsgKey from ",""]);return s=function(){return e},e}},99911:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(r(19976)),s=n(r(52954)),o=a(r(61247)),u=n(r(50935)),l=n(r(37448)),d=n(r(10111));function c(){var e=(0,i.default)(["NetworkStatus ",""]);return c=function(){return e},e}function f(){var e=(0,i.default)(["NetworkStatus:checkOnline errored! ",""]);return f=function(){return e},e}function p(){var e=(0,i.default)(["NetworkStatus:checkOnline response ",""]);return p=function(){return e},e}function h(){var e=(0,i.default)(["NetworkStatus:checkOnline checking"]);return h=function(){return e},e}function _(){var e=(0,i.default)(["waitIfOffline: Continuing..."]);return _=function(){return e},e}function m(){var e=(0,i.default)(["waitIfOffline: Waiting..."]);return m=function(){return e},e}class g extends o.default{constructor(...e){super(...e),this.online=(0,o.session)(!0),this.waitIfOffline=(0,d.default)((()=>"all"),(0,s.default)((function*(){this.online||(__LOG__(2)(m()),yield new Promise((e=>{this.listenToOnce(this,"change:online",(()=>{__LOG__(2)(_()),e()}))})))}))),this.checkOnline=(0,d.default)((()=>"all"),(0,s.default)((function*(){__LOG__(2)(h());try{var e=yield(0,l.default)(u.default.STATUS_URL);this.online=!!e,__LOG__(2)(p(),String(this.online))}catch(e){__LOG__(3)(f(),String(e))}})))}initialize(){this.listenTo(this,"change:online",this._logOnlineOffline),this._logOnlineOffline()}_logOnlineOffline(){var e=this.online;__LOG__(2)(c(),e?"online":"offline")}}var v=new((0,o.defineModel)(g));t.default=v},86809:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getEffectiveNetworkType=function(){return navigator.connection&&"string"==typeof navigator.connection.effectiveType?navigator.connection.effectiveType:null}},67015:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t=!1){var{name:r,message:a,stack:i}=e,s=i.indexOf("\n"),o=i.slice(0,s).match(new RegExp("(".concat((0,n.default)(r),"|Error)(:|$)")));if(null!=o){if(!t)return i;var u=o.index+o[0].length,l=null==a?-1:i.indexOf(a,u),d=null==a||-1===l?-1:l+a.length,c=Math.max(0,s,u,d);return i.slice(c).replace(/^\n+/,"")}return t?i:a?"".concat(r,": ").concat(a,"\n").concat(i):"".concat(r,"\n").concat(i)};var n=a(r(89166))},53274:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.setTitleAndIcon=function(e){var t=l.default.t(1912);e>0&&(t="("+l.default.n(e)+") "+l.default.t(1912));clearTimeout(i),document.title=document.title+" ",i=setTimeout((()=>{document.title=t}),0),p(e)},t.setIcon=p;var i,s=n(r(19976)),o=a(r(86634)),u=n(r(22605)),l=n(r(17957)),d=n(r(77626));function c(){var e=(0,s.default)(["Favicon updated: ",""]);return c=function(){return e},e}var f=new u.default;function p(e){if(!d.default.isSafari){var t,a={id:t=-1===e?"favicon-error2":0===e?"favicon":e<10?"f0"+e:e<100?"f"+e:"f00",low:{default:r(16290)("./".concat(t,".png"))},high:{default:r(8893)("./".concat(t,".png"))}};f.enqueue(o.default.loadAsset(a,o.LOAD_PRIORITY.NOTIFICATION_ICON,!1)).then((e=>{var r,a=document.getElementById("favicon");(r=a)&&r.parentNode&&r.parentNode.removeChild(r);var n=document.createElement("link");n.setAttribute("id","favicon"),n.setAttribute("rel","shortcut icon"),n.setAttribute("type","image/png"),n.setAttribute("href",e),n.setAttribute("src",e);var i=document.getElementsByTagName("head");i&&i[0]&&i[0].appendChild(n),__LOG__(2)(c(),t)})).catchType(Promise.CancellationError,(()=>{}))}}},61941:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t="?"){if(null==e)throw new Error("Unexpected null or undefined: ".concat(t));return e}},15059:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,n.default)(e,i)};var n=a(r(99686)),i=e=>null==e},23111:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=r,a=function(...a){return t===r&&(t=e.call(this,...a)),t};return a.reset=()=>{t=r},a};var r={}},45629:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.openSocket=function(e){return new WebSocket(e)}},39592:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(19976)),i=r(46378),s=r(99888),o=a(r(64957));function u(){var e=(0,n.default)(["Player::oggBlobToWAVBlob error: ",""]);return u=function(){return e},e}var l,d=0;t.default=class{constructor(e){this.oggBlob=e}generateBlob(){return this.oggBlobToWAVBlob(this.oggBlob,1)}oggBlobToWAVBlob(e,t=2){var r=t;return new Promise((t=>{var a=new o.default,n=[],i=[],c=(d++,l||new window.AudioContext),f={outputBufferSampleRate:c.sampleRate,bufferLength:4096};a.onmessage=e=>{if(null==e.data){for(var a=function(e){n.forEach((t=>{for(var r=t[e]||t[0],a=0;a<r.length;a++)i.push(r[a])}))},s=0;s<r;s++)a(s);var o=this.encodeWAV(i,c,r),u=new Blob([o.readByteArray()],{type:"audio/wav"});0==--d&&l&&(l.close&&l.close(),l=void 0),t(u)}else n.push(e.data),r=n[0].length},a.postMessage({command:"decode-init",config:f}),(0,s.blobToArrayBuffer)(e).then((e=>{a.postMessage({command:"decode",pages:new Uint8Array(e)}),a.postMessage({command:"decode-done"})})).catch((e=>{__LOG__(3)(u(),e)}))}))}encodeWAV(e,t,r){var a=new i.Binary(void 0,!0);a.ensureCapacity(44+2*e.length),a.writeString("RIFF"),a.writeUint32(36+2*e.length),a.writeString("WAVE"),a.writeString("fmt "),a.writeUint32(16),a.writeUint16(1),a.writeUint16(r),a.writeUint32(t.sampleRate),a.writeUint32(t.sampleRate*r*2),a.writeUint16(2*r),a.writeUint16(16),a.writeString("data"),a.writeUint32(2*e.length);for(var n=0;n<e.length;n++){var s=Math.max(-1,Math.min(e[n],1));s*=s>0?32767:32768,a.writeInt16(Math.floor(s))}return a}}},75897:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(r(52954)),s=r(91460),o=r(5497),u=n(r(28421)),l=n(r(50935)),d=a(r(44202)),c=n(r(25012)),f=n(r(72424)),p=a(r(82885));t.default=class{static fileToPdf(e){var t=URL.createObjectURL(e);return Promise.loop((function(e,t,a){var n=(0,s.delayMs)(p.expBackoff(a,12e4,0,0));return r.e(2974).then(r.t.bind(r,38664,23)).then((t=>{t.GlobalWorkerOptions.workerSrc=u.default,e(t.default)})).catch((()=>n))})).then((e=>e.getDocument(t).promise))}static releasePdf(e){return e.destroy()}static pdfToImg(e,t){var r=document.createElement("canvas");return e.getPage(t).then((e=>{var t=e.getViewport({scale:1}),a=r.getContext("2d");return r.height=t.height,r.width=t.width,e.render({canvasContext:a,viewport:t}).promise})).then((()=>(0,o.promiseProps)({blob:d.canvasToBlob(r),thumbnail:d.rotateAndResize(r,l.default.DOC_THUMB_MAX_EDGE,d.DATA_URL|d.CANVAS|d.BLOB),microThumbnail:f.default.webUploadDocumentThumbMmsEnabled?d.generateMicroThumb(r,1300,{mimetype:"image/jpeg",maxAttempts:10}):Promise.resolve(null)}))).then((e=>e)).then(function(){var t=(0,i.default)((function*({blob:t,thumbnail:r,microThumbnail:a}){return{url:URL.createObjectURL(t),thumbUrl:r.images.dataUrl,width:r.images.canvas.width,height:r.images.canvas.height,fullPreviewData:yield c.default.createFromData(r.images.blob,"image/jpeg"),fullPreviewSize:{width:r.images.canvas.width,height:r.images.canvas.height},pdfPages:e.numPages,microThumbnail:a}}));return function(){return t.apply(this,arguments)}}())}}},86362:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.startMeasure=function(e){return r;if(!a)return r;var t=(n.get(e)||0)+1;n.set(e,t);var s=i(1===t?e:"".concat(e," (").concat(t,")")),o="".concat(s,": Start"),u="".concat(s,": End");performance.mark(o);var l=!1;return{end(){if(!l){l=!0;var t=n.get(e)||0;t>1?n.set(e,t-1):n.delete(e),performance.mark(u),performance.measure(s,o,u)}}}},t.formatMeasureLabel=i;var r={end(){}},a=performance&&performance.mark&&performance.measure,n=new Map;function i(e){return"".concat(""," ").concat(e)}},24897:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.phashV1=function(e){for(var t=e.map((e=>(0,s.toUserWid)(e).toString({legacy:!0}))).sort().join(""),r=[],a=0;a<t.length;a++)r.push(t.charCodeAt(a));var o=new Uint8Array(r);return i.default.digest({name:"SHA-1"},o).then((e=>"1:".concat((0,n.encodeB64)(e.slice(0,6)))))},t.phashV2=function(e){for(var t=e.map((e=>e.toString({legacy:!0,formatFull:!0}))).sort().join(""),r=[],a=0;a<t.length;a++)r.push(t.charCodeAt(a));var s=new Uint8Array(r);return i.default.digest({name:"SHA-256"},s).then((e=>"2:".concat((0,n.encodeB64)(e.slice(0,6)))))};var n=r(60339),i=a(r(84025)),s=r(75637)},12489:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(95522)),i=a(r(15456)),s="AbortController"in self?AbortController:class{constructor(){this.signal=new n.default}abort(){var e=new i.default("abort");this.signal.dispatchEvent(e)}};t.default=s},95522:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(74966)),i=class extends n.default{constructor(){super(),this.aborted=!1}dispatchEvent(e){return"abort"===e.type&&(this.aborted=!0,"function"==typeof this.onabort&&this.onabort.call(this,e)),super.dispatchEvent(e)}toString(){return"[object AbortSignal]"}};t.default=i},86041:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(42685),n="DomException"in window?DOMException:a.DOMException;t.default=n},15456:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=Event;t.default=r},74966:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(28267));t.default=class{constructor(){this._emitter=new n.default}addEventListener(e,t){this._emitter.on(e,t,this)}removeEventListener(e,t){this._emitter.off(e,t,this)}dispatchEvent(e){return this._emitter.trigger(e.type),!0}}},93601:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(70417)),i=r(3757),s=()=>{},o="fetch"in window?fetch:function(e,t={}){return(0,i.sharedFetch)(e,(0,n.default)((0,n.default)({},t),{},{onProgress:s}))};t.default=o},68476:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(77626));["webkitGetUserMedia"].forEach((function(e){var t=Object.getPrototypeOf(navigator)[e];t&&navigator[e]!==t&&(navigator[e]=t)}));var i=function(){var e;if(n.default.isBrokenGetUserMedia)return null;var t=null===(e=navigator.mediaDevices)||void 0===e?void 0:e.getUserMedia;if(t)return t.bind(navigator.mediaDevices);var r=navigator.getUserMedia||navigator.mozGetUserMedia||navigator.webkitGetUserMedia;return r?function(e){return new Promise((function(t,a){r.call(navigator,e,t,a)}))}:null}();t.default=i},20909:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,i=a(r(5331)),s=a(r(87697)),o=a(r(60715)),u=a(r(41261)),l="Headers"in window&&Headers?Headers:(n=u.default.iterator,class e{constructor(t){var r=this;if(this._headers={},t instanceof e)(0,s.default)(t.entries(),(e=>{var[t,r]=e;r.split(", ").forEach((e=>{this.append(t,e)}))}));else if("object"==typeof t){var a=function(e){t[e].split(", ").forEach((t=>{r.append(e,t)}))};for(var n in t)a(n)}}append(e,t){var r=e.toLowerCase();r in this._headers?this._headers[r].push(t):this._headers[r]=[t]}delete(e){var t=e.toLowerCase();delete this._headers[t]}entries(){var e=Object.keys(this._headers).map((e=>[e,this.get(e)||""]));return new i.default(e)}get(e){var t=e.toLowerCase();return t in this._headers?this._headers[t].join(", "):null}has(e){return e.toLowerCase()in this._headers}keys(){return(0,o.default)(this.entries(),(([e])=>e))}set(e,t){var r=e.toLowerCase();this._headers[r]=[t]}values(){return(0,o.default)(this.entries(),(([e,t])=>t))}[n](){return this.entries()}toString(){return"[Object Headers]"}});t.default=l},20835:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.cancelIdleCallback=t.requestIdleCallback=void 0;var r=window.requestIdleCallback,a=window.cancelIdleCallback,n="requestIdleCallback"in window?r:function(e){return setTimeout((()=>{var t=Date.now();e({didTimeout:!1,timeRemaining:()=>Math.max(0,50-(Date.now()-t))})}),1)};t.requestIdleCallback=n;var i="cancelIdleCallback"in window?a:function(e){clearTimeout(e)};t.cancelIdleCallback=i},31600:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=window.MediaError||{MEDIA_ERR_ABORTED:1,MEDIA_ERR_NETWORK:2,MEDIA_ERR_DECODE:3,MEDIA_ERR_SRC_NOT_SUPPORTED:4};t.default=r},84025:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=self.crypto,a=r&&(r.subtle||r.webkitSubtle||r.subtle);t.default=a},41261:(e,t)=>{"use strict";var r,a;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n="Symbol"in window?Symbol:(a=r=class{},r.iterator="@@iterator",a);t.default=n},99340:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,r(31125);var a=URLSearchParams;t.default=a},47410:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.prepareCtwaContextSend=function(e,t){if(t)return(0,i.default)({},t);if(e&&e.sourceUrl){var r=e.sourceUrl;if(null==r||""===r)return;var a=u.findLink(e.sourceUrl,!1,(0,o.getMaybeMeUser)());return{sourceUrl:r,sourceType:"",sourceId:"",mediaType:s.ExternalAdReplyInfoMediaType.NONE,isSuspiciousLink:!!(a&&a.suspiciousCharacters&&a.suspiciousCharacters.size>0)}}return};var i=n(r(70417)),s=r(28703),o=r(95595),u=a(r(90088))},43443:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getDistribution=function(){return"prod","".concat("web","_").concat("prod")},t.getLogUserAgent=function({appVersion:e,browser:t,device:r}){var a;return a="Web/"+t,"WhatsApp/".concat(e," ").concat(a," Device/").concat(r)}},8701:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ABORT_ERROR=t.default=void 0;var a=r(29351);class n extends((0,a.customError)("AbortError")){}t.default=n;t.ABORT_ERROR="AbortError"},43856:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,r){return(0,i.default)(e,(function(a){if(a.signal.aborted)throw new n.default;var i=e(a);return t.get(i,a).then((e=>{if(a.signal.aborted)throw new n.default;return null!=e?e:r(a).then((e=>{if(a.signal.aborted)throw new n.default;return t.set(i,e,a).then((()=>e))}))}))}))};var n=a(r(8701)),i=a(r(10111))},91976:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var{signal:r,timeoutIterator:a,timeoutIncludesTaskDuration:u}=(0,n.default)((0,n.default)({},o),e);return(0,i.default)((({retry:e,failCount:r})=>new Promise(((n,i)=>{var o=Date.now();try{t((function(e){return Promise.reject(new s.default(e))}),r).then(n).catch(l)}catch(e){return void l(e)}function l(t){if(t instanceof s.default){var r=a.next();if(r.done)i(t.source);else{var n=Date.now()-o,l=u?Math.max(r.value-n,0):r.value;e(l)}}else i(t)}}))),r)},t.defaults=void 0;var n=a(r(70417)),i=a(r(58768)),s=a(r(76092)),o=Object.freeze({timeoutIncludesTaskDuration:!0});t.defaults=o},93282:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return l.apply(this,arguments)};var n=a(r(70417)),i=a(r(52954)),s=a(r(76092)),o=a(r(14558)),u={retries:1/0};function l(){return(l=(0,i.default)((function*(e,t){var r,{delay:a,signal:i,retries:l}=(0,n.default)((0,n.default)({},u),e),d=0,c=Date.now(),f=null,p=e=>Promise.reject(new s.default(e));try{return c=Date.now(),yield t(p,d,i)}catch(r){if(d++,!(r instanceof s.default))throw r;f=r}for(;d<=l;){var h=a({iterationCount:d,taskDuration:Date.now()-c});yield(0,o.default)(h,i);try{return c=Date.now(),yield t(p,d,i)}catch(r){if(d++,!(r instanceof s.default))throw r;f=r}}if(!f)throw new Error("assert: backoff completed without error or result");throw f.source}))).apply(this,arguments)}},57337:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createEnqueue=function(){var e={};return function(t,r){return function a(...n){var i=(r||((...e)=>String(e[0])))(...n);if(e[i]){var s=e[i].then((()=>(delete e[i],a(...n))));return e[i]=s,s}var o=t.apply(this,n).then((t=>(e[i]===o&&delete e[i],t)));return e[i]=o,o}}}},82195:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var r=(0,s.default)((0,s.default)({},l),e),{signal:a,timeoutIncludesTaskDuration:n}=r,d=(0,i.default)(r,["signal","timeoutIncludesTaskDuration"]),c=new u.default(d);return(0,o.default)({signal:a,timeoutIterator:c,timeoutIncludesTaskDuration:n},t)};var i=n(r(22220)),s=n(r(70417)),o=a(r(91976)),u=a(r(11639)),l=(0,s.default)((0,s.default)({},u.defaults),o.defaults)},10111:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var r=new Map;return function(a){if(a.signal.aborted)return Promise.reject(new s.default);var l=e.call(this,a),d=r.get(l);if(null==d||d.aggregator.signal.aborted){var c=new u.default,f=(0,n.default)((0,n.default)({},a),{},{signal:c.signal});d={aggregator:c,promise:t.call(this,f).finally((()=>{c.dispose(),r.delete(l)}))},r.set(l,d)}var p=a.signal||(new i.default).signal;return d.aggregator.add(p),(0,o.default)(d.promise,p)}};var n=a(r(70417)),i=a(r(12489)),s=a(r(8701)),o=a(r(53827)),u=a(r(885))},53827:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(null==t)return e;var r,a=t.aborted?Promise.reject(new n.default):new Promise(((e,a)=>{var i=()=>{a(new n.default)};t.addEventListener("abort",i),r=()=>{t.removeEventListener("abort",i)}}));return Promise.race([a,e]).finally((()=>{var e;null===(e=r)||void 0===e||e(),r=null}))};var n=a(r(8701))},92087:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var r,a=new n.default;if(e.some((e=>e.aborted)))a.abort();else{r=()=>{for(var t of e)t.removeEventListener("abort",i);r=null};var i=()=>{var e;null===(e=r)||void 0===e||e(),a.abort()};for(var s of e)s.addEventListener("abort",i)}return t(a.signal).finally((()=>{var e;null===(e=r)||void 0===e||e()}))};var n=a(r(12489))},58768:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return new Promise(((r,a)=>{var i,s=0,o=!1;if(t){var u=()=>{t.removeEventListener("abort",u),o=!0,null!=i&&clearTimeout(i),a(new n.default)};if(t.aborted)return void u();t.addEventListener("abort",u)}!function t(){var n=!1,u=!1;i=null;try{var l=e({retry:e=>{if(!o&&!u){if(n=!0,s++,null==e)return t();i=setTimeout(t,e)}},failCount:s});if(!(l instanceof Promise))throw new TypeError("task must return a promise");l.then((e=>{o||n||(u=!0,r(e))})).catch((e=>{o||n||(u=!0,a(e))}))}catch(e){if(o||n)return;a(e)}}()}))};var n=a(r(8701))},76092:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(29351);class n extends((0,a.customError)("RetryableError")){constructor(e){super("see error at this.source"),this.source=e}}t.default=n},885:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(12489));t.default=class{constructor(){this._disposed=!1,this._controller=new n.default,this._signals=new Set,this.signal=this._controller.signal,this._handleAbort=e=>{this.delete(e.currentTarget),this._checkAborted()}}add(...e){for(var t of(this._throwIfDisposed(),e))t.aborted||(t.addEventListener("abort",this._handleAbort),this._signals.add(t));this._checkAborted()}_checkAborted(){this._disposed||[...this._signals].every((e=>e.aborted))&&(this.dispose(),this._controller.abort())}delete(...e){this._throwIfDisposed(),this._delete(...e)}_delete(...e){var t=!1;for(var r of e)this._signals.delete(r)&&(t=!0,r.removeEventListener("abort",this._handleAbort));t&&this._checkAborted()}_throwIfDisposed(){if(this._disposed)throw new Error("Attempt to modify disposed SignalAggregator")}dispose(){if(!this._disposed)for(var e of(this._disposed=!0,this._signals))this._delete(e)}}},14558:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(8701)),i=(e,t)=>new Promise(((r,a)=>{if(t&&t.aborted)throw new n.default;var i=setTimeout((function(){t&&t.removeEventListener("abort",s),r()}),e);function s(){t&&t.removeEventListener("abort",s),clearTimeout(i),a(new n.default)}t&&t.addEventListener("abort",s)}));t.default=i},60412:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return t.catchType(Promise.CancellationError,(()=>{})).catch((function(t){e.cancel(t)})),t}},2379:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return new Promise((function(e){function t(){e(!1)}if(self.requestFileSystem)self.requestFileSystem(window.TEMPORARY,1,t,(function(t){e("SecurityError"===t.name)}));else if(o.default){var r=o.default.open("pb_detect");r?(r.onsuccess=t,r.onerror=function(t){t.preventDefault(),window.InvalidStateError?e(t instanceof window.InvalidStateError):e(!0)}):t()}else l.default.isTrident?e(!0):t()})).then((function(e){if(e)return e;if(!u.default)return!1;try{return u.default.setItem("INCOG","0"),u.default.removeItem("INCOG"),!1}catch(e){return"QuotaExceededError"===e.name||Promise.reject(e)}})).timeout(100,"detectIncognitoTimeout").catchType(Promise.TimeoutError,(function(){return!1})).catch((function(e){return __LOG__(3)(d(),String(e)),s.upload({reason:"incog-throw"}),!1}))};var i=n(r(19976)),s=a(r(3594)),o=n(r(71219)),u=n(r(80521)),l=n(r(77626));function d(){var e=(0,i.default)(["promiseUtil:determineIncognito failed check: ",""]);return d=function(){return e},e}},37448:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t="GET",r,a){var n=new XMLHttpRequest;return new Promise((function(i){function s(){i(n.status&&n.status<12e3?n:null)}a&&(n.responseType=a),n.onload=s,n.onreadystatechange=function(){4===n.readyState?s():0===n.readyState&&i(null)},n.onerror=()=>i(null),n.ontimeout=()=>i(null),n.open(t,e,!0),r?n.send(r):n.send()})).addRawControl("cancel",((e,t)=>{n.abort(),t(new Promise.CancellationError("Aborted XHR"))}),!0).endWithControls("cancel")}},15918:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"attachWatcher",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(t,"getResponseIfOnline",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(t,"waitForOfflineNaive",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(t,"waitForEvent",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(t,"waitForBBEvent",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(t,"determineIncognito",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(t,"waitForSkip",{enumerable:!0,get:function(){return d.default}}),Object.defineProperty(t,"waitForMain",{enumerable:!0,get:function(){return c.default}});var n=a(r(60412)),i=a(r(37448)),s=a(r(75062)),o=a(r(51701)),u=a(r(17744)),l=a(r(2379)),d=a(r(9415)),c=a(r(31720))},17744:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,r){var a,n=r;return new Promise((function(r){a=n?function(){n.apply(this,arguments)&&r(arguments)}:function(){r(arguments)},e.on(t,a)})).cancellable().finally((function(){e.off(t,a)}))}},51701:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,r){var a,n=r;return new Promise((function(r){a=n?function(){n.apply(this,arguments)&&r.apply(this,arguments)}:r,e&&e.addEventListener&&e.addEventListener(t,a)})).cancellable().finally((function(){e&&e.removeEventListener&&e.removeEventListener(t,a)}))}},31720:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return n.default.isMainLoaded?Promise.resolve():(0,i.default)(n.default,"main_loaded")};var n=a(r(79711)),i=a(r(17744))},75062:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return(0,n.default)(window,"offline")};var n=a(r(51701))},9415:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){var e,t;return new Promise((function(r){!function a(){t&&t+1e4<Date.now()?r(!0):(t=Date.now(),e=setTimeout(a,1e3))}()})).cancellable().finally((function(){clearTimeout(e)}))}},49213:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){var e=new Uint8Array(8);self.crypto.getRandomValues(e);for(var t=new Array(16),a=0,n=0;a<e.length;a++,n+=2){var i=e[a];t[n]=r[i>>4],t[n+1]=r[15&i]}return"3EB0"+String.fromCharCode.apply(String,t)},t.randomId=function(){var e=new Uint8Array(16);self.crypto.getRandomValues(e);for(var t=new Array(32),a=0,n=0;a<e.length;a++,n+=2){var i=e[a];t[n]=r[i>>4],t[n+1]=r[15&i]}return String.fromCharCode.apply(String,t)};var r=[48,49,50,51,52,53,54,55,56,57,65,66,67,68,69,70]},43704:(e,t,r)=>{"use strict";var a=r(14859);t.Z=function(){if(o(i.default.REQUIRED_BROWSER_APIS))return!0;return(0,n.promiseProps)({cryptoSha256:s.default.supportsHmacSha256(),cryptoAesCbc:s.default.supportsAesCbc()}).then(o),!1};var n=r(5497),i=a(r(50935)),s=a(r(70594));function o(e){var t=[];for(var r in e)e[r]||t.push(r);if(t.length>0){var a="".concat(i.default.CAPABILITY_URL,"?missing=").concat(t.join(","));return window.location.replace?window.location.replace(a):window.location.href=a,!0}return!1}},48148:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.refreshNoiseCredentials=function(){var e=(0,l.keyPair)(),t=new Uint8Array(24);return self.crypto.getRandomValues(t),Promise.resolve(d.waNoiseInfo.set({recoveryToken:t.buffer,staticKeyPair:e}))},t.refreshSignalCredentials=function(){var e=window.libsignal.KeyHelper.generateRegistrationId();return h.waSignalStore.clearCredential().then((()=>(0,c.generateIdentityKeyPair)().then((t=>Promise.all([h.waSignalStore.setRegistrationInfo({registrationId:e,identityKeyPair:t}),h.waSignalStore.rotateSignedPreKey((0,l.toSignalCurveKeyPair)(t),c.generateSignedKeyPair)]).then((()=>{}))))))},t.setRoutingInfo=function(e,t){var r={domain:e,edgeRouting:t?(0,s.decodeB64)(t):null};return __LOG__(2)(E()),Promise.resolve((0,p.setRoutingInfo)(r))},t.register=function(e,t,r,a){return Promise.all([h.waSignalStore.getRegistrationInfo(),h.waSignalStore.getSignedPreKey()]).then((([i,s])=>{var o=d.waNoiseInfo.get(),l=d.deviceInfo.get();if(!o)throw new Error("Invalid noise credentials");if(!i||!s)throw new Error("Invalid signal credentials");if(!l)throw new Error("Invalid device info");var c={id:S(o.recoveryToken),authkey:S(o.staticKeyPair.pubKey),e_regid:S((0,u.intToBytes)(4,i.registrationId)),e_keytype:S((0,u.intToBytes)(1,5)),e_ident:S(i.identityKeyPair.pubKey),e_skey_id:S((0,u.intToBytes)(3,s.keyId)),e_skey_val:S(s.keyPair.pubKey),e_skey_sig:S(s.signature)};null!=a&&0!==a&&(c.device_id=a.toString());var f=A(y,"/v2/register",(0,n.default)({cc:e,in:t,lg:l.lg,lc:l.lc,code:r,"x-whatsapp-ua":b()},c));return fetch(f).then((e=>e.json())).catch((()=>({status:"fail",reason:"network_error"})))}))},t.requestCode=function(e,t,r){return Promise.all([h.waSignalStore.getRegistrationInfo(),h.waSignalStore.getSignedPreKey()]).then((([a,i])=>{var l=d.waNoiseInfo.get(),c=d.deviceInfo.get();if(!l)throw new Error("Invalid noise credentials");if(!a||!i)throw new Error("Invalid signal credentials");if(!c)throw new Error("Invalid device info");var p={id:S(l.recoveryToken),authkey:S(l.staticKeyPair.pubKey),e_regid:S((0,u.intToBytes)(4,a.registrationId)),e_keytype:S((0,u.intToBytes)(1,5)),e_ident:S(a.identityKeyPair.pubKey),e_skey_id:S((0,u.intToBytes)(3,i.keyId)),e_skey_val:S(i.keyPair.pubKey),e_skey_sig:S(i.signature)};return function(e){var t=(0,s.decodeB64)((0,f.default)(T)),r=(0,o.toLowerCaseHex)(new Uint8Array(t));__LOG__(2)(v(),r);var a=(0,s.decodeB64)((0,f.default)(["NvzsLFWNdEheK8VyC0LcidMVlsQhaD95lPVtO1mM",r,e].join(""))),n=(0,o.toLowerCaseHex)(new Uint8Array(a));return __LOG__(2)(g(),n),Promise.resolve(n)}(t).then((a=>{var i=A(y,"/v2/code",(0,n.default)({cc:e,in:t,mcc:c.mcc,mnc:c.mnc,sim_mnc:c.sim_mnc,sim_mcc:c.sim_mcc,lg:c.lg,lc:c.lc,method:r,token:a,"x-whatsapp-ua":b()},p));return fetch(i).then((e=>e.json())).catch((()=>({status:"fail",reason:"network_error"})))}))}))},t.buildUrl=A;var n=a(r(70417)),i=a(r(19976)),s=r(60339),o=r(8320),u=r(59410),l=r(72434),d=r(1972),c=r(93912),f=a(r(68560)),p=r(39174),h=r(44480),_=a(r(77626)),m=a(r(76796));function g(){var e=(0,i.default)(["token: ",""]);return g=function(){return e},e}function v(){var e=(0,i.default)(["build hash: ",""]);return v=function(){return e},e}function E(){var e=(0,i.default)(["set routingInfo:"]);return E=function(){return e},e}var y="https://v.whatsapp.net";function S(e){return(0,m.default)((0,s.encodeB64)(e))}var T="0.3.2555";function b(){var e="".concat(_.default.browser,"-").concat(_.default.browserVersion).replace(" ","_"),t="".concat(_.default.os,"-").concat(_.default.osVersion).replace(" ","_");return"WhatsApp/".concat(T," Web/").concat(e," Device/").concat(t)}function A(e,t,r){if(!/^https:\/\/[-\w.]+\.\w+$/.test(e))throw new Error('buildUrl given invalid host "'.concat(e,'"'));if(!t.startsWith("/"))throw new Error('buildUrl given invalid path "'.concat(t,'"'));var a=r,n="".concat(e).concat(t);if(!a)return n;var i=Object.keys(a).map((e=>{var t=a[e];t instanceof ArrayBuffer&&(t=new Uint8Array(t));var r=t instanceof Uint8Array?Array.prototype.slice.call(t).map((e=>"%".concat(e.toString(16)))).join(""):encodeURIComponent(t);return"".concat(encodeURIComponent(e),"=").concat(r)}));if(i.length>0){var s=i.join("&");return n.includes("?")?"".concat(n,"&").concat(s):"".concat(n,"?").concat(s)}return n}},64464:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(46378),n=r(39329),i=1e4;t.default=class{constructor(e){this.performSendStep=()=>{var e=!1,t=i;if(this.remainingChunk){var r=this.remainingChunk;if(r.length>=i){var n=a.Binary.build(210,128,r),s=n.readBuffer(i);this.remainingChunk=n.readByteArray(),e=!0,t=0,this._send(s)}else{var o=a.Binary.build(211,128,r);this.remainingChunk=null,e=!0,t-=o.size(),this._send(o.readBuffer())}}for(var u=this.queue;u.length&&t>2;){var l=u.shift();if("string"==typeof l)l.length<=t||!e?(e=!0,t-=l.length,this._send(l)):(t=0,u.unshift(l));else if(l.byteLength<t)e=!0,t-=l.byteLength,this._send(l);else{var d=a.Binary.build(208,128,l),c=d.readBuffer(t);this.remainingChunk=d.readByteArray(),e=!0,t=0,this._send(c)}}this.isQueueing()&&this.timer.onOrBefore(250)},this.watchedSocket=e,this.queue=[],this.remainingChunk=null,this.timer=new n.ShiftTimer(this.performSendStep)}isQueueing(){return this.queue.length>0||!!this.remainingChunk}cancel(){this.timer.cancel()}_send(e){this.watchedSocket.socket.send(e)}send(e){this.isQueueing()?this.queue.push(e):function(e){return"string"==typeof e?e.length:e.byteLength}(e)<=i?this._send(e):(this.queue.push(e),this.timer.forceRunNow())}}},8292:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.set=_,t.clear=function(){n=void 0},t.get=function(){return(0,l.default)(n,"BUNDLE")},t.getBundle=function(){return n},t.getSecurityToken=function(e){if(!n)return __LOG__(3)(h()),Promise.reject("secret_bundle:getSecurityToken: no secret bundle");return new u.default(n.key).sign(new Uint8Array(e)).then(s.encodeB64)},t.setSecretKeys=function(e,t,r){"0.1"===e?n&&t&&r?(n.encKey=t,n.macKey=r,n.key=r):__LOG__(3)(p(),e,String(t),String(r)):__LOG__(2)(f(),e)},t.load=function(){var e=(0,o.getSecretBundle)();if(!e)return __LOG__(2)(c()),null;return _(e),e},t.save=function(){if(!n)return void __LOG__(2)(d());delete n.keyPair,(0,o.setSecretBundle)(n)};var n,i=a(r(19976)),s=r(60339),o=r(95595),u=a(r(36398)),l=a(r(61941));function d(){var e=(0,i.default)(["secret_bundle:save: trying to save empty secret bundle!"]);return d=function(){return e},e}function c(){var e=(0,i.default)(["secret_bundle:load: attempted to load non-existent secret bundle!"]);return c=function(){return e},e}function f(){var e=(0,i.default)(["secret_bundle:setSecretKeys unknown version: v",""]);return f=function(){return e},e}function p(){var e=(0,i.default)(["secret_bundle:setSecretKeys v"," "," ",""]);return p=function(){return e},e}function h(){var e=(0,i.default)(["secret_bundle:getSecurityToken: no secret bundle"]);return h=function(){return e},e}function _(e){n=e}},52221:(e,t,r)=>{"use strict";var a=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.getOrGenerate=function(){var e=i.getBundle();if(e&&e.key&&e.keyPair)return(0,n.encodeB64)(e.key);var t=s.keyPair(),r=(0,n.encodeB64)(t.pubKey),a={key:t.pubKey,keyPair:t,encKey:void 0,macKey:void 0};return i.set(a),r};var n=r(60339),i=a(r(8292)),s=a(r(72434))},66823:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var{name:t,message:r,stack:a}=e,s=(0,n.default)(e,["name","message","stack"]),o=(0,i.default)({name:t,message:"",stack:a}),u=o.slice(o.indexOf("\n")+1),l=0===Object.keys(s).length?"":" "+JSON.stringify(s,((e,t)=>e&&"object"==typeof t?String(t):t));return"".concat(t||"Error"," - ").concat(r||"").concat(l,"\n").concat(u)};var n=a(r(22220)),i=a(r(67015))},56783:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setServerPropInElectron=function(){}},31429:(e,t)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;try{r=window.sessionStorage}catch(e){}var a=r;t.default=a},6155:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(19976));function i(){var e=(0,n.default)(["[SetRefCache] Large cache detected with "," entries"]);return i=function(){return e},e}t.default=class{constructor(e){this.cache=new Map,this.howBig=0,this.fn=e}getKeyString(e){return"string"==typeof e?e:e.join("_")}getRefSetter(e){var t=this.getKeyString(e),r=this.cache.get(t);return r||(r=r=>{this.fn(e,r),r||this.cache.delete(t)},this.cache.set(t,r),Math.floor(this.cache.size/500)>this.howBig&&(__LOG__(4,void 0,new Error)(i(),this.cache.size),this.howBig=Math.floor(this.cache.size/500))),r}}},22253:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(4335)),i=a(r(29259)),s=a(r(11403)),o=a(r(15253)),u=r(11419);function l(e){switch(typeof e){case"object":return null==e?e=>null===e:function(e){var t=[],r=!1,a=0;(0,o.default)(e,(function(e,n){if(void 0!==e){a++;var i=l(e);t.push((function(e){return e.hasOwnProperty(n)&&i&&i(e[n])}))}else r=!0}));var n=(0,s.default)(t,(function(e,t){return e?function(r){return t(r)&&e(r)}:t}));return function(e){if("object"!=typeof e||null==e)return!1;var t=Object.keys(e).length;return!(t<a)&&!(!r&&t>a)&&n(e)}}(e);case"function":return e;case"boolean":case"undefined":case"number":case"string":return function(t){return t===e};default:throw new TypeError("Unknown Template type: ".concat(typeof e))}}class d{constructor(e){this.predicate=l(e)}test(e){return this.predicate(e)}}t.default=d,d.ANY=()=>!0,d.OBJECT=i.default,d.STRING=u.isString,d.BOOLEAN=n.default},30786:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getCrypto=function(){return self.crypto.subtle||self.crypto.webkitSubtle}},73664:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(45455)),i=a(r(28267));class s extends i.default{constructor(e=[],t,r="next"){super(),this.list=e,this.index=-1,this.value=void 0,this.getter=t||(e=>e),this.deleteDir=r}init(e=[],t=!1){var r,a,i=t;if(this.list=e,this.value)if((0,n.default)(e))this.unset();else{if((r=e.indexOf(this.value))>-1){if(r===this.index)return;a=!0,i=!1}else if(!i||this.index<0)r=-1;else{var s="prev"===this.deleteDir?-1:0;r=this.index+s,r=Math.max(r,0),a=(r=Math.min(r,e.length-1))>-1}this.set(r,i,a)}}unset(){var e=this.value;this.value=void 0,this.index=-1,e&&this.trigger(this.getter(e),!1)}reset(e=!0){this.index<0||this.value&&this.trigger(this.getter(this.value),"focus",e)}set(e,t=!0,r=!0){if(this.list.length){var a=Math.min(Math.max(e,-1),this.list.length-1),n=this.value,i=a>-1?this.list[a]:void 0;i?(this.value=i,this.trigger(this.getter(i),t?"focus":"select")):r&&(this.value=void 0),r&&n&&n!==i&&this.trigger(this.getter(n),!1),this.index=a}}getVal(){return this.value}setVal(e,t=!0){var r=this.list.indexOf(e);r>-1?this.set(r,t):(this.unset(),this.value=e)}setFirst(e=!0){(0,n.default)(this.list)||this.set(0,e,!0)}setLast(e=!0){(0,n.default)(this.list)||this.set(this.list.length-1,e,!0)}setPrev(e=!0){(0,n.default)(this.list)||this.set(this.prev(),e,!0)}setNext(e=!0){(0,n.default)(this.list)||this.set(this.next(),e,!0)}prev(){return(0,n.default)(this.list)||-1===this.index?-1:this.index-1}next(){return(0,n.default)(this.list)?-1:Math.min(this.index+1,this.list.length-1)}}var o=s;t.default=o},36838:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(r(19976)),s=n(r(4889)),o=r(46378),u=n(r(12489)),l=a(r(61247)),d=a(r(3594)),c=n(r(50935)),f=a(r(42743)),p=n(r(80737)),h=n(r(99911)),_=n(r(14558)),m=n(r(17744)),g=r(91779),v=a(r(53182)),E=r(79345);function y(){var e=(0,i.default)(["js halt longer than "," ms detected, resetting watchdog fail generation"]);return y=function(){return e},e}function S(){var e=(0,i.default)(["SocketOpener:offline... heuristic poll"]);return S=function(){return e},e}function T(){var e=(0,i.default)(["SocketOpener:offline... quick poll"]);return T=function(){return e},e}function b(){var e=(0,i.default)(["SocketOpener:offline... wait for navigator"]);return b=function(){return e},e}function A(){var e=(0,i.default)(["SocketOpener:offlineController activating"]);return A=function(){return e},e}function C(){var e=(0,i.default)(["SocketOpener:onlineController activating"]);return C=function(){return e},e}function P(){var e=(0,i.default)(["attemptOpen called while not active!"]);return P=function(){return e},e}function O(){var e=(0,i.default)(["SocketOpener deadly error! ",""]);return O=function(){return e},e}function w(){var e=(0,i.default)(["SocketOpener closing socket opener"]);return w=function(){return e},e}function M(){var e=(0,i.default)(["SocketOpener set to socket ",""]);return M=function(){return e},e}var I=3e5,R=18e4,D=(0,v.fibonacci)(8e3,4e3,3e5);class N extends l.default{constructor(...e){super(...e),this.active=(0,l.prop)(!0),this.socket=(0,l.prop)(),this.sockets=(0,l.prop)(),this.attempts=(0,l.prop)(0),this.startId=(0,l.prop)(0),this.controller=(0,l.prop)(),this.retryTimestamp=(0,l.prop)(),this.tsListener=(0,l.prop)(),this.onerror=(0,l.prop)()}initialize(){this.sockets=[],new Promise(((e,t)=>{this._resolve=e,this._reject=t})).then((e=>{__LOG__(2)(M(),e.id),this.set({active:!1,socket:e}),h.default.online=!0})).finally((()=>{this.stopListening(),__LOG__(2)(w()),this.active=!1,this.sockets.forEach((e=>{e.cancel()}));var e=this.controller;e&&(e.deactivate(),this.controller=null)})).catchType(Promise.CancellationError,(()=>{})).catch((e=>{if(__LOG__(3)(O(),String(e)),!this.onerror)return Promise.reject(e);this.onerror(e)})),this.tsListener=e=>{this.retryTimestamp=e.ts},this.listenTo(h.default,"change:online",this.onOnlineChange),this.listenTo(f.default,f.JS_HALT_EVENT,this.onJsHalt),this.onOnlineChange()}attemptOpen(){if(!this.active)return __LOG__(2)(P()),void d.upload({reason:"rogue-opener"});var e=(0,E.open)({url:c.default.WEB_SOCKET_URL,msgParser:k});this.attempts=this.sockets.push(e);var t=!1,r=function(){if(t)return Promise.resolve();t=!0;var e=(new u.default).signal;return h.default.checkOnline({signal:e})},a=new u.default;(0,_.default)(6e3,a.signal).then((()=>r())).catch((()=>{})),e.then(this._resolve).finally((()=>a.abort())).catchType(Promise.CancellationError,(()=>{})).catch((()=>r()))}poke(){this.controller&&this.controller.forceTimeout()}onOnlineChange(){if(this.active){var e=this.controller,t=h.default.online?this.onlineController():this.offlineController();e&&(e.off("change:ts",this.tsListener),e.deactivate()),t.on("change:ts",this.tsListener),t.activate(),this.controller=t}}onlineController(){return __LOG__(2)(C()),new v.default({waitAlgorithm:D,jitter:.2,onActivated:()=>{this.attemptOpen()},onTimeout:()=>(this.attemptOpen(),!0)})}offlineController(){__LOG__(2)(A());var e,t=0;return new v.default({waitAlgorithm:a=>(e&&e.cancel(),navigator.onLine?t++<2?(__LOG__(2)(T()),e=null,6e3):(__LOG__(2)(S()),e=L(a,[(0,g.waitForOnlineNaive)(),(0,m.default)(f.default,f.JS_HALT_EVENT),(0,m.default)(r(17026).default,"change:available")]),I):(__LOG__(2)(b()),t=0,e=L(a,[(0,g.waitForOnlineNaive)()]),I)),jitter:.2,onActivated:()=>{0===this.pendingAttempts()&&this.attemptOpen()},onDeactivated:()=>{e&&e.cancel()},onTimeout:()=>(this.attemptOpen(),!0)})}deactivate(){this._reject(new Promise.CancellationError)}pendingAttempts(){return(0,s.default)(this.sockets,(e=>e.isPending()?1:0))}onJsHalt(e){var t=this.controller;t&&e>R&&(__LOG__(2)(y(),R),t.resetGeneration())}}function L(e,t){return Promise.any(t).cancellable().then((()=>{e.forceTimeout()})).finally((()=>{t.forEach((e=>{e.cancel()}))})).catchType(Promise.CancellationError,(()=>{}))}function k(e){var t,r,a,n=e.data;if(n instanceof ArrayBuffer){for(var i,s=[],u=new o.Binary(n);44!==(i=u.readUint8());)s.push(i);t=String.fromCharCode.apply(String,s),r=u.readBuffer(),a=n.byteLength}else{if("string"!=typeof n)throw new Error("Unexpected message event type");var l=n.indexOf(",");t=n.slice(0,l),r=(r=n.slice(l+1))?JSON.parse(r,p.default):void 0,a=new Blob([n]).size}return{tag:t,data:r,binarySize:a}}var U=(0,l.defineModel)(N);t.default=U},11352:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(r(19976)),s=n(r(4889)),o=n(r(12489)),u=a(r(61247)),l=n(r(50935)),d=a(r(42743)),c=n(r(99911)),f=n(r(14558)),p=n(r(17744)),h=r(91779),_=a(r(53182)),m=r(10254);function g(){var e=(0,i.default)(["js halt longer than "," ms detected, resetting watchdog fail generation"]);return g=function(){return e},e}function v(){var e=(0,i.default)(["SocketOpenerMD:offline... heuristic poll"]);return v=function(){return e},e}function E(){var e=(0,i.default)(["SocketOpenerMD:offline... quick poll"]);return E=function(){return e},e}function y(){var e=(0,i.default)(["SocketOpenerMD:offline... wait for navigator"]);return y=function(){return e},e}function S(){var e=(0,i.default)(["SocketOpenerMD:offlineController activating"]);return S=function(){return e},e}function T(){var e=(0,i.default)(["SocketOpenerMD:onlineController activating"]);return T=function(){return e},e}function b(){var e=(0,i.default)(["attemptOpen called while not active!"]);return b=function(){return e},e}function A(){var e=(0,i.default)(["SocketOpenerMD deadly error! ",""]);return A=function(){return e},e}function C(){var e=(0,i.default)(["SocketOpenerMD closing socket opener"]);return C=function(){return e},e}function P(){var e=(0,i.default)(["SocketOpenerMD set to socket ",""]);return P=function(){return e},e}var O=3e5,w=18e4,M=(0,_.fibonacci)(8e3,4e3,3e5);class I extends u.default{constructor(...e){super(...e),this.active=(0,u.prop)(!0),this.socket=(0,u.prop)(),this.sockets=(0,u.prop)(),this.attempts=(0,u.prop)(0),this.controller=(0,u.prop)(),this.retryTimestamp=(0,u.prop)(),this.tsListener=(0,u.prop)(),this.onerror=(0,u.prop)()}initialize(){this.sockets=[],new Promise(((e,t)=>{this._resolve=e,this._reject=t})).then((e=>{__LOG__(2)(P(),e.id),this.set({active:!1,socket:e}),c.default.online=!0})).finally((()=>{this.stopListening(),__LOG__(2)(C()),this.active=!1,this.sockets.forEach((e=>{e.cancel()}));var e=this.controller;e&&(e.deactivate(),this.controller=null)})).catchType(Promise.CancellationError,(()=>{})).catch((e=>{if(__LOG__(3)(A(),String(e)),!this.onerror)return Promise.reject(e);this.onerror(e)})),this.tsListener=e=>{this.retryTimestamp=e.ts},this.listenTo(c.default,"change:online",this.onOnlineChange),this.listenTo(d.default,d.JS_HALT_EVENT,this.onJsHalt),this.onOnlineChange()}attemptOpen(){if(this.active){var e=(0,m.open)(this.routingToken?"".concat(l.default.CHATD_WEB_SOCKET_URL,"?ED=").concat(this.routingToken):l.default.CHATD_WEB_SOCKET_URL);this.attempts=this.sockets.push(e);var t=!1,r=function(){if(t)return Promise.resolve();t=!0;var e=(new o.default).signal;return c.default.checkOnline({signal:e})},a=new o.default;(0,f.default)(6e3,a.signal).then((()=>r())).catch((()=>{})),e.then(this._resolve).finally((()=>a.abort())).catchType(Promise.CancellationError,(()=>{})).catch((()=>r()))}else __LOG__(2)(b())}poke(){this.controller&&this.controller.forceTimeout()}onOnlineChange(){if(this.active){var e=this.controller,t=c.default.online?this.onlineController():this.offlineController();e&&(e.off("change:ts",this.tsListener),e.deactivate()),t.on("change:ts",this.tsListener),t.activate(),this.controller=t}}onlineController(){return __LOG__(2)(T()),new _.default({waitAlgorithm:M,jitter:.2,onActivated:()=>{this.attemptOpen()},onTimeout:()=>(this.attemptOpen(),!0)})}offlineController(){__LOG__(2)(S());var e,t=0;return new _.default({waitAlgorithm:a=>(e&&e.cancel(),navigator.onLine?t++<2?(__LOG__(2)(E()),e=null,6e3):(__LOG__(2)(v()),e=R(a,[(0,h.waitForOnlineNaive)(),(0,p.default)(d.default,d.JS_HALT_EVENT),(0,p.default)(r(17026).default,"change:available")]),O):(__LOG__(2)(y()),t=0,e=R(a,[(0,h.waitForOnlineNaive)()]),O)),jitter:.2,onActivated:()=>{0===this.pendingAttempts()&&this.attemptOpen()},onDeactivated:()=>{e&&e.cancel()},onTimeout:()=>(this.attemptOpen(),!0)})}deactivate(){this._reject(new Promise.CancellationError)}pendingAttempts(){return(0,s.default)(this.sockets,(e=>e.isPending()?1:0))}onJsHalt(e){var t=this.controller;t&&e>w&&(__LOG__(2)(g(),w),t.resetGeneration())}}function R(e,t){return Promise.any(t).cancellable().then((()=>{e.forceTimeout()})).finally((()=>{t.forEach((e=>{e.cancel()}))})).catchType(Promise.CancellationError,(()=>{}))}var D=(0,u.defineModel)(I);t.default=D},86405:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.getHash=function(e){return(e instanceof _.default?(0,f.opaqueDataToArrayBuffer)(e):(0,d.blobToArrayBuffer)(e)).then((e=>(0,m.default)(e))).catch((t=>{var r={error:"".concat(t),blobSize:e.size,isOpaqueData:e instanceof _.default};__LOG__(3,void 0,void 0,!0)(g(),JSON.stringify(r,null,2)),SEND_LOGS("subtle-crypto-get-hash-error")}))},t.decrypt=v,t.decryptE2EMedia=function(e,t,r,a){var n,i=Promise.resolve().then((()=>{if(!e)throw new l.MediaEncryptionError('decrypt async, missing "type"');if(!(t instanceof ArrayBuffer))throw new l.MediaEncryptionError('decrypt async, missing "payload"');if(!r)throw new l.MediaEncryptionError('decrypt async, missing "mediaKey"');if(n=new p.default.WebcCryptoMedia({webcCryptoType:p.default.WEBC_CRYPTO_TYPE_CODE.DECRYPT,webcCryptoLibrary:p.default.WEBC_CRYPTO_LIBRARY_CODE.WEBCRYPTO,webcCryptoFileSize:t.byteLength}),t.byteLength<10)throw new l.MediaEncryptionError("ciphertext too short: ".concat(t.byteLength));return(0,u.default)(e,r).then((({iv:r,encKey:n,macKey:i})=>{var s=t.byteLength-10,o=new Uint8Array(t,s),u=new Uint8Array(t,0,s);return v(new Uint8Array(n),new Uint8Array(r),u,new Uint8Array(i),o,a||(t=>(0,h.getMediaMimeType)(e,t)))}))})).tap((e=>{e.autoreleaseWhenPromiseCompletes(i),n.markWebcCryptoElapsedT(),n.commit()})).catchConditional((e=>!(e instanceof l.MediaEncryptionError)),(e=>{var t=e instanceof Error?"encryption error: ".concat(String(e),"; stack: ").concat(e.stack):"encryption error: ".concat(String(e),";");throw new l.MediaEncryptionError(t)}));return i};var i=n(r(19976)),s=r(46378),o=r(9729),u=n(r(6698)),l=a(r(96452)),d=r(99888),c=n(r(36398)),f=r(82982),p=n(r(40210)),h=r(41501),_=n(r(25012)),m=n(r(40571));function g(){var e=(0,i.default)(["SubtleCrypto::getHash error. Debug:\n",""],["SubtleCrypto::getHash error. Debug:\\n",""]);return g=function(){return e},e}function v(e,t,r,a,n,i){return Promise.resolve().then((()=>{if(!(10<=n.length&&n.length<=32))throw new l.MediaEncryptionError("Given bad expected hmac");var i=s.Binary.build(t,r).readByteArray();return new c.default(a).sign(i).then((t=>{for(var r=new Uint8Array(t,0,n.length),a=!1,s=0;s<r.length;s++)r[s]!==n[s]&&(a=!0);if(a)throw new l.MediaEncryptionError("hmac check failure");return(0,o.aesCbcDecrypt)(e,i)}))})).then((e=>{var t="string"==typeof i?i:i(new Uint8Array(e));return _.default.createFromData(e,t)}))}},32510:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=!1;try{var a={get passive(){r=!0}};window.addEventListener("test",null,a)}catch(e){}var n=r;t.default=n},57385:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.genSecurityCodeNotificationMsg=function(e,t){var r=(0,i.getMeUser)();return{id:new s.default({fromMe:t.equals(r),remote:e,id:(0,o.default)()}),t:(0,n.unixTime)(),type:"e2e_notification",subtype:"identity",from:e,to:r,body:t.toString()}},t.genDeviceNotificationMsg=function(e,t,r,a){var l=(0,i.assertGetMe)(),d=new s.default({fromMe:t.equals((0,u.toUserWid)(l)),remote:e,id:(0,o.default)()}),c=d.fromMe&&r.includes(l.getDeviceId());return{id:d,t:(0,n.unixTime)(),type:"e2e_notification",subtype:"device",from:e,to:(0,u.toUserWid)(l),body:t.toString(),devicesAdded:r.length,devicesRemoved:a.length,isThisDeviceAdded:c}},t.genEncryptNotificationMsg=function(e){return l(e,"e2e_notification","encrypt",[])},t.genTealNotificationTemplateMsg=function(e,t,r){return l(e,"notification_template",t,r)};var n=r(71684),i=r(95595),s=a(r(77865)),o=a(r(49213)),u=r(75637);function l(e,t,r,a){var u=(0,i.getMeUser)();return{id:new s.default({fromMe:e.equals(u),remote:e,id:(0,o.default)()}),t:(0,n.unixTime)(),type:t,subtype:r,from:e,to:u,templateParams:a}}},54978:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.genGroupCreationMsg=function(e,t){var r,a,i,{chatId:u,externalId:l}=e;if(!l)throw new Error("handleGroupCreationMD: no externalId for group action ".concat(JSON.stringify(e),", ").concat(JSON.stringify(t)));var d=null!==(r=null!==(a=t.owner)&&void 0!==a?a:e.author)&&void 0!==r?r:(0,n.getMaybeMeUser)(),c=t.subject;return{id:new s.default({remote:u,fromMe:!1,participant:d,id:(0,o.default)()}),author:d,body:c,from:u,recipients:[],self:"in",subtype:"create",t:null!==(i=t.creation)&&void 0!==i?i:e.ts,type:"gp2"}},t.genGroupNotificationMsg=function(e,t){var{chatId:r,externalId:a}=e,n=e.author&&(0,u.toUserWid)(e.author)||void 0;if(!a)throw new Error("handleGroupActionMD: no externalId for group action ".concat(JSON.stringify(e),", ").concat(JSON.stringify(t)));var o=null,l=[],d=n,c=t.action,f=null;switch(t.action){case i.GROUP_ACTIONS.SUBJECT:o=t.subject;break;case i.GROUP_ACTIONS.MODIFY:l=t.participants;break;case i.GROUP_ACTIONS.ADD:t.isInvite&&(c="invite");case i.GROUP_ACTIONS.PROMOTE:case i.GROUP_ACTIONS.DEMOTE:case i.GROUP_ACTIONS.REMOVE:1===(l=t.participants).length&&(d=l[0]),t.action===i.GROUP_ACTIONS.REMOVE&&1===l.length&&n===d&&(c="leave");break;case i.GROUP_ACTIONS.INVITE_CODE:c="revoke_invite";break;case i.GROUP_ACTIONS.DESC_ADD:c="description",o=t.desc;break;case i.GROUP_ACTIONS.DESC_REMOVE:c="description";break;case i.GROUP_ACTIONS.RESTRICT:case i.GROUP_ACTIONS.ANNOUNCE:case i.GROUP_ACTIONS.NO_FORWARD:f=t.value?["on"]:["off"],o=f[0];break;case i.GROUP_ACTIONS.EPHEMERAL:n&&(f=["".concat(t.duration),n])}var p={id:new s.default({remote:r,fromMe:!1,participant:d,id:a}),author:n,from:r,recipients:l.map(u.toUserWid)||[],self:"in",subtype:c,t:e.ts,type:"gp2"};o&&(p.body=o);f&&(p.templateParams=f);return p},t.genGroupPicChangeNotificationMsg=function(e,t,r,a,n){return{type:"gp2",self:"in",subtype:"picture",t:r,author:a,body:t,recipients:[],from:e,id:new s.default({remote:e,fromMe:!1,id:n})}},t.genGroupEphemeralSettingMsg=function(e,t,r,a){return{id:new s.default({remote:e,fromMe:!1,participant:r,id:(0,o.default)()}),author:r,from:e,recipients:[],self:"in",subtype:"ephemeral",t,type:"gp2",templateParams:["".concat(a)]}};var n=r(95595),i=r(70185),s=a(r(77865)),o=a(r(49213)),u=r(75637)},94984:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(28267));class i extends n.default{constructor(){super(),this.mediaQuery=window.matchMedia("(prefers-color-scheme: dark)"),this.theme=this.currentTheme,this.handleThemeChange=()=>{var e=this.currentTheme;e!==this.theme&&(this.theme=e,this.trigger("system_theme_change",e))},this.mediaQuery.addListener(this.handleThemeChange)}get currentTheme(){return this.mediaQuery.matches?"dark":"light"}}var s=new i;t.default=s},53397:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r={ROOT:1,THENABLE:2,FINALLY:3,META:4},a={PENDING:1,FULFILLED:2,REJECTED:3};function n(){var e,t;switch(this._parent=null,this._subs=[],this._catchTypes=null,this._onResolve=null,this._onReject=null,this.type=r.ROOT,this.state=a.PENDING,this.value=void 0,this._forceable=!1,this._cancellable=!1,arguments.length){case 0:break;case 1:e=arguments[0];break;case 2:t=arguments[0],e=arguments[1];break;default:throw new Error("TightPromise constructor with "+arguments.length+" arguments")}if(this.context=t,arguments.length>0)try{e.call(t,s.bind(this),o.bind(this))}catch(e){o.call(this,e)}}function i(...e){var t=new n;return t.type=r.THENABLE,t._onReject=arguments[arguments.length-1],arguments.length>1&&(t._catchTypes=Array.prototype.slice.call(arguments,0,arguments.length-1),t._catchTypes.forEach((function(e){if("function"!=typeof e)throw new Error("expected type, got "+e)}))),this._addChild(t),t}function s(e){var t;this.state===a.PENDING&&("object"!=typeof(t=e)&&"function"!=typeof t||"function"!=typeof t.then?(this.value=e,this.state=a.FULFILLED,this._notifySubs()):e.then(s.bind(this),o.bind(this)))}function o(e){this.state===a.PENDING&&(this.value=e,this.state=a.REJECTED,this._notifySubs())}n.STATE=a,n.TYPE=r,n.prototype={isPending:function(){return this.state===a.PENDING},then:function(e,t){if(!e&&!t)return this;var a=new n;return a.type=r.THENABLE,a._onResolve=e||null,a._onReject=t||null,this._addChild(a),a},catch:i,catchType:i,catchTypes:i,catchTypes3:i,catchEqualTo:i,catchConditional:i,finally:function(e){var t=new n;return t.type=r.FINALLY,t._onResolve=e,this._addChild(t),t},bind:function(e){var t=new n;return t.type=r.META,this._addChild(t),t.context=e,t},spread:function(e){return this.then((function(t){e.apply(this,t)}))},get:function(e){return this.then((function(t){return t[e]}))},forceable:function(){var e=new n;return e.context=this.context,e.type=r.META,this._addChild(e),e._forceable=!0,e},cancellable:function(){var e=new n;return e.context=this.context,e.type=r.META,this._addChild(e),e._cancellable=!0,e},force:function(e){if(this._forceable){for(var t=this;t.type===r.META;){var n=t._parent;if(!n||!n._forceable||n.state!==a.PENDING)break;t=n}s.call(this,e)}},cancel:function(e){var t=e;if(this._cancellable){t=t||new Promise.CancellationError;var r=this,n=!1;do{var i=r._parent;i&&i._cancellable&&i.state===a.PENDING?r=i:n=!0}while(!n);o.call(r,t)}},timeout:function(e,t){var i=new n;return i.type=r.META,this._addChild(i),i.state===a.PENDING&&setTimeout(o.bind(i,new Promise.TimeoutError(t)),e),i},loosen:function(){return Promise.resolve(this)},_run:function(e,t){var r;try{r=e.call(this.context,t)}catch(e){return void o.call(this,e)}s.call(this,r)},_handle:function(){if(this.state===a.PENDING){var e=this._parent;switch(this.type){case r.THENABLE:if(e.state===a.FULFILLED){var t=this._onResolve;t?this._run(t,e.value):s.call(this,e.value)}else if(this._onReject){var n=this._catchTypes,i=n?n.length:0,u=e.value;if(0===i)return void this._run(this._onReject,u);for(var l=0;l<i;l++)if(u instanceof n[l])return void this._run(this._onReject,u);o.call(this,u)}else o.call(this,e.value);return;case r.FINALLY:try{this._onResolve.call(this.context)}catch(e){!function(e){setTimeout((function(e){throw e}),0,e)}(e)}default:e.state===a.FULFILLED?s.call(this,e.value):o.call(this,e.value)}}},_addChild:function(e){e._parent=this,e.context=this.context,e._cancellable=this._cancellable,e.type===r.META&&(e._forceable=this._forceable),this.state===a.PENDING?this._subs.push(e):e._handle()},_notifySubs:function(){this._subs.forEach((function(e){e._handle()}))}},n.delay=function(...e){var t,r;switch(arguments.length){case 0:t=0;break;case 1:t=arguments[0];break;default:t=arguments[1],r=arguments[0]}return new n((function(e){setTimeout(e.bind(null,r),t)}))},n.resolve=function(e){var t=new n;return s.call(t,e),t},n.reject=function(e){var t=new n;return o.call(t,e),t};var u=n;t.default=u},82885:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.expBackoff=n,t.expDelaySec=function(e,t,r,i=.1){return(0,a.delayMs)(Math.floor(1e3*n(e,t,r,i)))};var a=r(91460);function n(e,t,r,a=.1){var n;return n=0===e?r||0:Math.pow(2,e),Number.isFinite(t)&&n>t&&(n=t),"number"==typeof r&&Number.isFinite(r)&&n<r&&(n=r),a&&(n*=1+a*Math.random()),n}},25270:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TLD=void 0;t.TLD="abb|abbott|ac|academy|accountant|accountants|ad|adult|ae|aero|af|africa|ag|agency|ai|al|am|amsterdam|anz|ao|apartments|app|apple|ar|archi|army|art|as|asia|associates|at|au|auction|audio|auto|aws|ax|axa|az|ba|baby|band|bank|bar|barclays|basketball|bayern|bb|bbva|bd|be|beauty|beer|berlin|best|bet|bf|bg|bh|bi|bible|bid|bike|bingo|bio|biz|bj|black|blog|blue|bm|bn|bnpparibas|bo|bond|bot|boutique|box|br|bradesco|brother|brussels|bs|bt|build|builders|business|buzz|bw|by|bz|bzh|ca|cab|cafe|cam|camera|camp|canon|capetown|capital|cards|care|careers|cars|casa|cash|casino|cat|cba|cbs|cc|cd|center|ceo|cern|cf|cg|ch|charity|chat|cheap|chrome|church|ci|citic|city|ck|cl|claims|cleaning|click|clinic|clothing|cloud|club|cm|cn|co|coach|codes|coffee|college|cologne|com|community|company|computer|construction|consulting|cool|coop|country|coupons|courses|cr|credit|creditcard|cricket|cu|cv|cw|cx|cy|cymru|cyou|cz|dance|data|date|dating|de|deals|degree|delivery|deloitte|dental|dentist|desi|design|dev|dhl|diet|digital|direct|directory|discount|dj|dk|do|doctor|dog|domains|download|dz|earth|ec|eco|edu|education|ee|eg|email|energy|engineering|equipment|es|estate|et|eu|eus|events|exchange|expert|exposed|express|extraspace|fage|fail|faith|family|fan|fans|farm|fashion|feedback|fi|film|finance|financial|fish|fit|fitness|fj|flights|florist|flowers|fm|fo|football|forex|forsale|forum|foundation|fox|fr|fun|fund|furniture|futbol|fyi|ga|gal|gallery|game|games|garden|gd|gdn|ge|gg|gh|gi|gift|gifts|gives|gl|glass|gle|global|globo|gm|gmbh|gold|golf|goog|google|gop|gov|gp|gq|gr|graphics|gratis|green|group|gs|gt|guide|guru|gy|haus|health|healthcare|help|helsinki|here|hiphop|hk|hn|hockey|holdings|holiday|homes|honda|horse|host|hosting|house|how|hr|hsbc|ht|hu|icu|id|ie|il|im|immo|in|inc|industries|info|ink|institute|insure|int|international|investments|io|iq|ir|is|ist|istanbul|it|jcb|je|jewelry|jm|jo|jobs|jp|ke|kg|kh|ki|kim|kitchen|kiwi|km|koeln|kp|kpmg|kr|krd|kred|kw|ky|kyoto|kz|la|land|lat|law|lawyer|lb|lc|leclerc|legal|lgbt|li|life|lighting|limited|link|live|lk|llc|loan|loans|lol|london|love|lr|ls|lt|ltd|ltda|lu|luxury|lv|ly|ma|madrid|management|market|marketing|markets|mba|md|me|media|melbourne|men|menu|mg|miami|mil|mk|ml|mm|mn|mo|mobi|moda|moe|moi|mom|monash|money|monster|mortgage|moscow|movie|mp|mq|mr|ms|msd|mt|mu|museum|mv|mw|mx|my|mz|na|name|nc|ne|net|network|neustar|news|nf|ng|ngo|ni|nico|ninja|nl|no|np|nr|nrw|nu|nyc|nz|observer|office|okinawa|om|one|ong|onl|online|ooo|orange|org|organic|ovh|pa|page|paris|partners|parts|party|pe|pet|pf|pg|ph|pharmacy|photo|photography|photos|physio|pics|pictures|pink|pizza|pk|pl|place|plumbing|plus|pm|pn|poker|porn|post|pr|press|pro|prod|productions|promo|properties|ps|pt|pub|pw|py|qa|quebec|quest|racing|radio|re|realtor|realty|recipes|red|reise|ren|rent|rentals|repair|report|rest|restaurant|review|reviews|rich|rip|ro|rocks|rodeo|rs|ru|rugby|run|rw|sa|sale|salon|sandvik|sap|saxo|sb|sbi|sc|scb|school|schule|science|scot|sd|se|security|services|ses|sex|sexy|sg|sh|sharp|shell|shiksha|shoes|shop|shopping|show|si|site|sk|ski|skin|sl|sm|sn|sncf|so|soccer|social|softbank|software|solar|solutions|sony|soy|space|sport|sr|st|storage|store|stream|studio|study|style|su|sucks|supply|support|surf|sv|swiss|sx|sy|sydney|systems|sz|taipei|tatar|tattoo|tax|taxi|tc|td|team|tech|technology|tel|tennis|tf|tg|th|theater|tickets|tips|tj|tk|tl|tm|tn|to|today|tokyo|tools|top|toshiba|tours|town|toyota|toys|tr|trade|trading|training|travel|tt|tube|tv|tw|tz|ua|ug|uk|university|uno|us|uy|uz|va|vanguard|vc|ve|vegas|ventures|vet|vg|vi|video|vin|vip|vision|vn|voyage|vu|wales|wang|watch|webcam|weber|website|wedding|weir|wf|wien|wiki|win|wine|woodside|work|works|world|ws|wtf|xyz|yandex|ye|yoga|youtube|yt|za|zip|zm|zone|zw|||||||||||||||"},60069:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(86534)),i=[.1,.82,.25,1],s=[.69,0,.79,.14],o=[.84,.07,.93,.46];n.default.RegisterEffect("attach.Up",{defaultDuration:300,calls:[[{opacity:[1,0],translateY:["0%","150%"],scaleX:[1,.3],scaleY:[1,.3]},1,{easing:[300,22]}]]}),n.default.RegisterEffect("attach.Down",{defaultDuration:200,easing:s,calls:[[{opacity:[0,1],translateY:["100%","0%"],scaleX:[.3,1],scaleY:[.3,1]},1,{easing:[.33,0,.39,.91]}]]}),n.default.RegisterEffect("dropdown.Down",{defaultDuration:200,easing:i,calls:[[{opacity:[1,0],translateY:["0%","-15px"]},1,{easing:i}]]});var u={pop:{duration:200,easing:o,enter:{props:{scaleX:[1,.5],scaleY:[1,.5],opacity:[1,0]}},leave:{props:{scaleX:[.5,1],scaleY:[.5,1],opacity:[0,1]}}},slide:{duration:200,easing:i,enter:{props:"slideDown"},leave:{props:"slideUp"}},scaleY:{duration:200,easing:i,enter:{props:{scaleY:[1,0],transformOrigin:"center"}},leave:{props:{scaleY:[0,1],transformOrigin:"center"}}},scale:{duration:500,easing:i,enter:{props:{scaleX:[1,0],scaleY:[1,0]}},leave:{props:{scaleX:[0,1],scaleY:[0,1]}}},fade:{duration:200,easing:i,enter:{props:{opacity:[1,0]}},leave:{props:{opacity:[0,1]}}},"fade-fast":{easing:"ease",enter:{props:{opacity:[1,0]},duration:150},leave:{props:{opacity:[0,1]},duration:100}},fade_sifo:{enter:{props:{opacity:[1,0]},duration:250},leave:{props:{opacity:[0,1]},duration:100}},capture:{enter:{props:{opacity:[1,0]},duration:350},leave:[{selector:"[data-animate-capture-snapshot]",props:"transition.bounceDownOut",duration:700},{selector:"[data-animate-capture-webcam]",props:{opacity:[0,1]},duration:100,easing:"ease"}]},butterbar:{enter:{props:"slideDown",easing:i,duration:700},leave:{props:"slideUp",easing:s,duration:350}},modal:{enter:[{selector:"[data-animate-modal-backdrop]",props:{opacity:[1,0]},duration:300,easing:[.19,.73,.28,1]},{selector:"[data-animate-modal-popup]",props:{scaleX:[1,0],scaleY:[1,0],opacity:[1,0]},easing:[.19,.73,.28,1],delay:180,duration:200},{selector:"[data-animate-modal-popup]",props:{opacity:[0,0]},duration:180}],leave:[{selector:"[data-animate-modal-backdrop]",props:{opacity:[0,1]},duration:300,easing:s,delay:100},{selector:"[data-animate-modal-popup]",props:{scaleX:[0,1],scaleY:[0,1]},easing:s,duration:200}]},"modal-flow":{enter:[{selector:"[data-animate-modal-backdrop]",props:{opacity:[1,0]},duration:300,easing:[.19,.73,.28,1]},{selector:"[data-animate-modal-popup]",props:{scaleX:[1,0],scaleY:[1,0],opacity:[1,1]},easing:[.19,.73,.28,1],delay:180,duration:200},{selector:"[data-animate-modal-popup]",props:{opacity:[0,0]},duration:180}],leave:[{selector:"[data-animate-modal-backdrop]",props:{opacity:[0,1]},duration:300,easing:s,delay:100},{selector:"[data-animate-modal-popup]",props:{scaleX:[0,1],scaleY:[0,1]},easing:s,duration:200}]},"flow-transition-modal-push":{duration:300,easing:i,enter:{props:{opacity:[1,0]}},leave:{props:{opacity:[0,1]}}},"flow-transition-modal-pop":{duration:300,easing:i,enter:{props:{opacity:[1,0]}},leave:{props:{opacity:[0,1]}}},"flow-transition-box-size-drawer-push":{duration:300,easing:i,enter:[{selector:"[data-animate-modal-body]",props:{translateX:["0%","100%"]}}],leave:[{props:{background:["transparent","transparent"]}},{selector:"[data-animate-modal-popup]",props:{background:["transparent","transparent"],boxShadow:["none","none"]}},{selector:"[data-animate-modal-body]",props:{translateX:["-100%","0%"]}}]},"flow-transition-box-size-drawer-pop":{duration:300,easing:i,enter:[{selector:"[data-animate-modal-body]",props:{translateX:["0%","-100%"]}}],leave:[{props:{background:["transparent","transparent"]}},{selector:"[data-animate-modal-popup]",props:{background:["transparent","transparent"],boxShadow:["none","none"]}},{selector:"[data-animate-modal-body]",props:{translateX:["100%","0%"]}}]},"flow-transition-drawer-push":{duration:300,easing:i,enter:{props:{translateX:["0%","100%"]}},leave:{props:{translateX:["-100%","0%"]}}},"flow-transition-drawer-pop":{duration:300,easing:i,enter:{props:{translateX:["0%","-100%"]}},leave:{props:{translateX:["100%","0%"]}}},"drawer-left":{enter:[{props:{translateX:["0%","-100%"]},duration:300,easing:i},{selector:"[data-animate-drawer-title]",props:{translateX:[0,-50],opacity:[1,0]},duration:500,easing:"easeOut"}],leave:[{props:{translateX:["-100%","0%"]},duration:300,easing:s}]},"drawer-left-rtl":{enter:[{props:{translateX:["0%","100%"]},duration:300,easing:i},{selector:"[data-animate-drawer-title]",props:{translateX:[0,50],opacity:[1,0]},duration:500,easing:"easeOut"}],leave:[{props:{translateX:["100%","0%"]},duration:300,easing:s}]},dropdown:{duration:300,easing:i,enter:[{selector:"[data-animate-dropdown-item]",props:"dropdown.Down",delay:50,duration:375,stagger:25,drag:!0},{props:{scale:[1,0]}},{props:{opacity:[1,0]},duration:100}],leave:{props:{scaleX:[0,1],scaleY:[0,1],opacity:[0,1]}}},"dropdown-picker":{duration:300,easing:i,enter:[{selector:"[data-animate-dropdown-item]",props:{opacity:[1,0]},delay:50,duration:200},{selector:"[data-animate-dropdown-nib]",props:{opacity:[1,0],rotateZ:["45deg"],translateY:["0%","-100%"]}},{props:{scale:[1,0]}},{props:{opacity:[1,0]},duration:100}],leave:[{selector:"[data-animate-dropdown-item]",props:{opacity:[1,0]},duration:100},{selector:"[data-animate-dropdown-nib]",props:{opacity:[1,0]},duration:150},{props:{scaleX:[0,1],scaleY:[0,1],opacity:[0,1]}}]},"profile-viewer":{duration:500,easing:[.1,1.03,.28,.99],leave:[{delay:400,props:{opacity:[0,1]}},{selector:"[data-animate-profile-viewer]",props:{borderRadius:["50%","0%"]}}]},"media-viewer":{duration:300,easing:[.1,1.03,.28,.99],leave:{selector:"[data-animate-media-viewer]",props:{opacity:[0,1]}}},"status-v3-quoted-msg":{enter:{props:{translateY:["0%","100%"],opacity:[1,0]},duration:200,easing:[.1,.82,.25,1]},leave:{props:{translateY:["100%","0%"],opacity:[0,1]},duration:200,easing:[.1,.82,.25,1]}},"status-v3-modal":{easing:[.55,.085,.68,.53],enter:{duration:100,selector:"[data-animate-status-v3-modal-background]",props:{opacity:[1,0]}},leave:{duration:100,selector:"[data-animate-status-v3-modal-background]",props:{opacity:[0,1]}}},"quoted-status-v3-modal":{easing:[.55,.085,.68,.53],enter:{duration:100,selector:"[data-animate-status-v3-viewer]",props:{opacity:[1,0]}},leave:{duration:100,selector:"[data-animate-status-v3-viewer]",props:{opacity:[0,1]}}},"status-v3-player":{easing:[.55,.085,.68,.53],enter:{duration:200,props:{opacity:[1,0]}},leave:{duration:200,props:{opacity:[0,1]}}},menu:{enter:{selector:"[data-animate-menu-icons-item]",props:"attach.Up",duration:700,stagger:30,drag:!1},leave:{selector:"[data-animate-menu-icons-item]",props:"attach.Down",duration:200,stagger:30}},emoji:{duration:300,easing:i,enter:{props:{height:[291,0]}},leave:{props:{height:[0,291]}}},ptt:{enter:[{selector:"[data-animate-btn-border]",easing:"easeInOut",props:{scaleX:[1,.5],scaleY:[1,.5],opacity:[1,0]},duration:250,delay:100},{selector:"[data-animate-ptt-counter]",easing:"easeInOut",props:{scaleX:[1,.8],scaleY:[1,.8],opacity:[1,0]},duration:250,delay:100},{props:{opacity:[1,0]},duration:150,easing:i}],leave:[{selector:"[data-animate-btn-border]",easing:i,props:{scaleX:[.5,1],scaleY:[.5,1],opacity:[0,1]},duration:250},{selector:"[data-animate-ptt-counter]",easing:i,props:{scaleX:[.5,1],scaleY:[.5,1],opacity:[0,1]},duration:250},{props:{opacity:[0,1]},duration:300,easing:i}]},"slide-left":{duration:300,easing:i,enter:{props:{translateX:["0%","100%"]}},leave:{props:{translateX:["100%","0%"]}}},"slide-left-rtl":{duration:300,easing:i,enter:{props:{translateX:["0%","-100%"]}},leave:{props:{translateX:["-100%","0%"]}}},"slide-forward":{duration:200,easing:[.19,.93,.18,.99],enter:{props:{translateX:["0%","100%"]}},leave:{props:{translateX:["-100%","0%"]}}},"slide-back":{duration:200,easing:[.19,.93,.18,.99],enter:{props:{translateX:["0%","-100%"]}},leave:{props:{translateX:["100%","0%"]}}},"media-slide-forward":{duration:200,easing:[.19,.93,.18,.99],enter:[{selector:"[data-animate-attach-media]",props:{opacity:[1,0],translateX:["0%","30%"]}},{selector:"[data-animate-media-caption]",props:{opacity:[1,0]}}],leave:[{selector:"[data-animate-attach-media]",props:{opacity:[0,1],translateX:["-30%","0%"]}},{selector:"[data-animate-media-caption]",props:{opacity:[0,1]}}]},"media-slide-back":{duration:200,easing:[.19,.93,.18,.99],enter:[{selector:"[data-animate-attach-media]",props:{opacity:[1,0],translateX:["0%","-30%"]}},{selector:"[data-animate-media-caption]",props:{opacity:[1,0]}}],leave:[{selector:"[data-animate-attach-media]",props:{opacity:[0,1],translateX:["30%","0%"]}},{selector:"[data-animate-media-caption]",props:{opacity:[0,1]}}]},"slide-down-date":{duration:300,enter:{props:{translateY:["0%","-130%"],opacity:[1,0]},easing:i},leave:{props:{translateY:["-130%","0%"],opacity:[0,1]},easing:s}},"slide-down-test":{duration:300,easing:i,enter:{props:{height:["auto","0"],opacity:[1,0]}},leave:{props:{translateY:["-130%","0%"],opacity:[0,1]}}},"pop-fast-reverse":{duration:75,easing:[.14,.62,.33,.9],enter:[{selector:"[data-js-context-icon]",props:{translateX:["0%","-100%"]}},{props:{opacity:[1,.5]}}],leave:[{selector:"[data-js-context-icon]",props:{translateX:["-100%","0%"]}},{props:{opacity:[0,1]}}]},"pop-fast":{duration:75,easing:[.14,.62,.33,.9],enter:[{selector:"[data-js-context-icon]",props:{translateX:["0%","100%"]}},{props:{opacity:[1,.5]}}],leave:[{selector:"[data-js-context-icon]",props:{translateX:["100%","0%"]}},{props:{opacity:[0,1]}}]},"pop-fast-chat":{duration:75,easing:[.14,.62,.33,.9],enter:[{props:{width:["20px","5px"],opacity:[1,.5]}}],leave:[{props:{width:["5px","20px"],opacity:[0,1]}}]},"toast-transition":{duration:300,easing:i,cleanOnComplete:!0,enter:{props:{translateY:["0%","100%"],opacity:[1,0]}},leave:{props:{opacity:[0,1]}}},"slide-up-down":{duration:300,easing:i,enter:{props:{translateY:["0%","100%"]}},leave:{props:{translateY:["100%","0%"]}}},"slide-up-down-footer":{duration:200,easing:i,enter:[{props:{translateY:["0%","100%"]}},{selector:"[data-animate-btn]",props:{opacity:[1,0],scale:[1,0]},delay:200,duration:300}],leave:[{props:{translateY:["100%","0%"]},delay:200},{selector:"[data-animate-btn]",props:{opacity:[0,1],scale:[.6,1]},duration:200}]},"slide-up":{duration:300,easing:i,enter:{props:{translateY:["0%","100%"]}},leave:{props:{translateY:["100%","0%"]}}},"slide-down":{duration:300,easing:i,enter:{props:{translateY:["0%","-100%"]}},leave:{props:{translateY:["-100%","0%"]}}},"emoji-search-slide-away":{duration:300,enter:{easing:"easeOutCubic",props:{translateY:["0%","-100%"]}},leave:{easing:"easeInCubic",props:{translateY:["-100%","0%"]}}},"emoji-search-slide-away-fast":{duration:80,enter:{easing:"easeOutCubic",props:{translateY:["0%","-100%"]}},leave:{easing:"easeInCubic",props:{translateY:["-100%","0%"]}}},"emoji-search-panel-slide-up":{duration:300,easing:i,enter:{props:{translateY:["0%","100%"],opacity:[1,0]}},leave:{props:{translateY:["100%","0%"],opacity:[0,1]}}},none:{},btn:{duration:300,easing:i,enter:{props:{scale:[1,0],opacity:[1,0]}},leave:{props:{scale:[0,1],opacity:[0,1]}}},pop_delay:{duration:300,enter:[{props:{scale:[1,0],opacity:[1,0]},delay:500,easing:i}],leave:{props:"transition.expandOut",easing:s}},"delay-leave":{duration:1,enter:{props:{opacity:[1,1]}},leave:{props:{opacity:[1,1]},delay:300}},"media-caption":{enter:[{props:{opacity:[0,0],translateY:["100%","100%"]},duration:200},{props:{opacity:[1,0],translateY:["0%","100%"]},easing:i,delay:200,duration:300}],leave:{props:{opacity:[0,1]},easing:"ease",duration:300}},"media-scale":{enter:[{selector:"[data-animate-media-caption]",props:{opacity:[0,0],translateY:["100%","100%"]},duration:200},{selector:"[data-animate-media-caption]",props:{opacity:[1,0],translateY:["0%","100%"]},easing:i,delay:200,duration:300},{selector:"[data-animate-attach-media]",props:{opacity:[0,0]},duration:200},{selector:"[data-animate-attach-media]",props:{opacity:[1,0],scale:[1,.625],display:"flex"},delay:200,duration:300,easing:i}],leave:[{selector:"[data-animate-media-caption]",props:{opacity:[0,1]},easing:"ease",duration:300},{selector:"[data-animate-attach-media]",props:{opacity:[0,1],scale:[.5,1],display:"flex"},delay:0,duration:200,easing:s}]},"thumb-scale":{duration:400,easing:i,enter:{props:"transition.expandIn"},leave:{props:"transition.expandOut"}},"thumb-scale-flex":{duration:400,easing:i,enter:{props:{scale:[1,0],display:"flex"}},leave:{duration:200,props:{scale:[0,1],display:"flex"}}},default:{duration:300,enter:{props:{opacity:[1,0]}},leave:{props:{opacity:[0,1]}}},noop:{duration:0},"noop-full-opacity":{duration:0,enter:{props:{opacity:[1,1]}},leave:{props:{opacity:[1,1]}}},pip:{enter:{props:{opacity:[1,0]},duration:400},leave:{props:{scaleX:[.5,1],scaleY:[.5,1],opacity:[0,1]},duration:200,easing:o}},voip:{enter:{props:{opacity:[1,0]},duration:400},leave:{props:{scaleX:[.5,1],scaleY:[.5,1],opacity:[0,1]},duration:200,easing:o}},"replace-fade":{enter:[{props:{opacity:[0,0]},duration:400},{props:{opacity:[1,0]},duration:400,delay:400}],leave:{props:{opacity:[0,1]},duration:400}}};t.default=u},77638:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(t instanceof e)return t;if("string"==typeof t)return new e((0,a.decodeB64)(t));return new e(t)};var a=r(60339)},66190:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var r=t.reduce(((e,t)=>e+t.length),0),a=new e(r),n=0;return t.forEach((e=>{a.set(e,n),n+=e.length})),a}},11419:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isFunction=function(e){return"function"==typeof e},t.isNumber=function(e){return"number"==typeof e},t.isString=function(e){return"string"==typeof e},t.isBoolean=function(e){return"boolean"==typeof e}},77626:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.gteVersion=s,t.ltVersion=o,t.parseUA=u,t.default=void 0;var n=a(r(46353));function i(e,t){var r,a,n=/(\.0)+[^\.]*$/,i=(e+"").replace(n,"").split("."),s=(t+"").replace(n,"").split("."),o=Math.min(i.length,s.length);for(r=0;r<o;r++)if(0!==(a=parseInt(i[r],10)-parseInt(s[r],10)))return a;return i.length-s.length}function s(e,t){return i(e,t)>=0}function o(e,t){return i(e,t)<0}function u(e){var t=new n.default;t.setUA(e||"");var r=(t.getBrowser().name||"").toUpperCase(),a=t.getBrowser().version||"0.0.0",i=(t.getEngine().name||"").toUpperCase(),u=(t.getOS().name||"").toUpperCase(),l=t.getOS().version||"0.0.0",d="SAFARI"===r,c="CHROME"===r,f="GECKO"===i,p=!1;switch(u){case"MAC OS":c?p=s(l,"10.10")&&s(a,"41.0.0"):s(l,"10.7")&&(p=!0);break;case"WINDOWS":s(l,"8.1")&&(f||c&&s(a,"41.0.0"))&&(p=!0)}var h=d||c&&o(a,"76");return{isWebkit:!i||"WEBKIT"===i,isGecko:f,isTrident:"TRIDENT"===i||"EDGEHTML"===i,isSafari:d,isElectron:!1,isBuggyVideoLoad:c&&s(a,"76")||"BLINK"===i&&!c,hasEmoji:p,troublesWithLotsOfVideos:c,supportsEmojiEllipsification:!h,isBrokenGetUserMedia:c&&o(a,"50"),os:u.toLowerCase(),osVersion:l,browser:r.toLowerCase(),browserVersion:a,parser:t}}var l=u("undefined"!=typeof self?self.navigator.userAgent:null);t.default=l},98294:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t,r,a;return r=t=class extends u.WrappedComponent{render(){return this.state.hasError?null:s.createElement(d.default.Consumer,null,(t=>s.createElement(e,(0,i.default)({ref:this.setComponent},this.props,{uim:(0,l.default)(t,"uim")}))))}},t.defaultProps=null!==(a=e.defaultProps)&&void 0!==a?a:void 0,t.displayName="UIM(".concat((0,o.default)(e),")"),r};var i=n(r(58527)),s=a(r(2784)),o=n(r(93954)),u=r(13414),l=n(r(61941)),d=n(r(5179))},20398:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.UIMState=void 0;var n=a(r(19976)),i=a(r(55324)),s=a(r(64116));function o(){var e=(0,n.default)(["",""]);return o=function(){return e},e}function u(){var e=(0,n.default)(["Attempting to set multiple UIM tree roots. Expecting only one."]);return u=function(){return e},e}var l=r(28103).Mirrored(["ACTIVE","PASSIVE","INACTIVE","DEAD"]);t.UIMState=l;class d{static maybePreventScroll(e){var t=d.Manager.top&&d.Manager.top.uie.getNode();e.target instanceof HTMLElement&&t&&!t.contains(e.target)&&(e.preventDefault(),e.stopPropagation())}constructor(e,t){this.shouldRequestFocus=!0,this.parent=e||this,e||(d.Manager.root&&(__LOG__(4,void 0,new Error,!0)(u()),SEND_LOGS("multiple-uim-roots")),d.Manager.root=this),this.uie=t,this.children=[],this.state=t.getUIMState()}get state(){return this._state}set state(e){switch(e){case l.ACTIVE:this.lastActive=Date.now(),d.Manager.top=this;break;case l.PASSIVE:this.lastActive=Date.now(),this._state!==l.ACTIVE&&(d.Manager.top=d.findMostRecentlyActiveFocusable());break;case l.INACTIVE:this._state&&this._state!==e&&(d.Manager.top=d.findMostRecentlyActiveFocusable());break;case l.DEAD:}this._state=e}activate(){this.state=this._state}branch(e){var t=new d(this,e);return this.children.push(t),d.pprint(),t}pop(e=!1,t=!0){if(this.state!==l.DEAD){this._invalidateAndDismissChildren(this.children,e),(0,s.default)(this.parent.children,(e=>e===this));var r=d.findMostRecentlyActiveFocusable(this);r&&(r.shouldRequestFocus=t),d.Manager.top=r,d.pprint()}}_invalidateAndDismissChildren(e,t){e.forEach((e=>{e.state=l.DEAD,e.uie.requestDismiss(t),this._invalidateAndDismissChildren(e.children,t)}))}static findMostRecentlyActiveFocusable(e){var{root:t}=d.Manager;if(t)return c(t,e,(e=>e.state===l.ACTIVE||e.state===l.PASSIVE))}static findMostRecentlyActiveDismissable(e){var{root:t}=d.Manager;if(t)return c(t,e,(e=>e.state===l.ACTIVE))||c(t,e,(e=>e.state===l.PASSIVE))}static pprint(e){if(e||d.Manager.verbose){var{root:t}=d.Manager;t&&__LOG__(2)(o(),p(t,[]))}}}function c(e,t,r){if(!e.children.length)return e;var a=e.children.filter((e=>e!==t)).map((e=>c(e,t,r))).concat([e]).filter(Boolean).filter(r);return(0,i.default)(a,"lastActive")}d.State=l,d.Manager={_top:void 0,set top(e){e&&(e.lastActive=Date.now()),e&&this._top!==e&&e.state!==l.INACTIVE&&e.state!==l.DEAD&&e.shouldRequestFocus&&e.uie.requestFocus(),e&&(e.shouldRequestFocus=!0),this._top&&this._top.uie.popable()&&window.removeEventListener("wheel",d.maybePreventScroll,!0),e&&e.uie.popable()&&window.addEventListener("wheel",d.maybePreventScroll,!0),this._top=e},get top(){return this._top},refocusTopUie(){setTimeout((()=>{this._top&&document.activeElement===document.body&&this._top.uie.requestFocus()}),0)},root:void 0,verbose:!1};function f(e,t,r,a){var n;n=r&&a?"":r&&!a?"":!r&&a?"":"",e===d.Manager.root&&(n="");var i=e.uie.getDisplayName();e===d.Manager.top&&(i="".concat(i," "));var s="(".concat(function(e){switch(e){case l.ACTIVE:return"A";case l.PASSIVE:return"P";case l.INACTIVE:return"I";case l.DEAD:return"D"}}(e.state),")").concat(a?"\n":"");return"".concat(t.join("")).concat(n," ").concat(i," ").concat(s)}function p(e,t,r){return f(e,t,r,!!e.children.length)+e.children.map(((a,n)=>{var i=n<e.children.length-1;return p(a,r?t.concat(["".concat(""," ")]):t.concat(["  "]),i)})).join("\n")}window.addEventListener("keydown",(e=>{if(27===e.keyCode){var{top:t}=d.Manager,r=t&&t.state===l.ACTIVE?t:d.findMostRecentlyActiveDismissable();r&&r.uie.escapable()&&(e.stopPropagation(),e.preventDefault(),r&&r.uie.requestDismiss(!1))}}),{capture:!0});var h=null;function _(e,t){var r=e&&e.state===l.ACTIVE&&e.uie.popable()?e:d.findMostRecentlyActiveDismissable();if(!r||!r.uie.popable())return null;var a=r.uie.getNode();return a&&t.target instanceof Node&&a.contains(t.target)?null:r}window.addEventListener("mousedown",(e=>{if(h=null,e.screenX&&e.screenY){var t=_(d.Manager.top,e);t&&2===e.button?t.uie.requestDismiss():h=t}}),{capture:!0}),window.addEventListener("mouseup",(e=>{if(e.screenX&&e.screenY){var t=_(d.Manager.top,e);t&&t===h&&setTimeout((()=>t.uie.requestDismiss()),0),h=null}else h=null}),{capture:!0});var m=d;t.default=m},5179:(e,t,r)=>{"use strict";var a=r(93291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(2784)).createContext(null);t.default=n},86145:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.firstNCodepoints=function(e,t){return n(e||"",0,t)},t.numCodepoints=function(e){return(0,a.length)(e||"")},t.substring=n,t.toArray=i,t.codePointAt=function(e,t=0){if(e.codePointAt)return e.codePointAt(t);var r=e.charCodeAt(t);if(r>=55296&&r<=56319){var a=e.charCodeAt(t+1);a>=56320&&a<=57343&&(r=65536+(r-55296<<10)+(a-56320))}return r},t.firstNEncodedBytes=function(e,t){if(null==t)return e;if(encodeURI(e).length<=t)return e;for(var r=0,a=i(e),s=a.length,o=0;o<s;o++){var u=a[o],l=encodeURI(u).length;if(r+l>t)return n(e,0,o);r+=l}return e};var a=r(10462);function n(e,t,r){if(!e)return"";var n=t||0,i=null==r?1/0:r;return e.length,0===n&&i===1/0?e:e.length>=5e3&&i/e.length<=.5?function(e,t,r){var n,i=new RegExp(a.astralRange),s="",o=0;do{(n=i.exec(e))&&(s+=n[0]),o++}while(n&&o<r);return s}(e,0,i):(0,a.substring)(e,n,i)}function i(e,t,r){var n=e||"",i=t||0,s=null==r?1/0:r;return n.length>=5e3&&s/n.length<=.5?function(e,t,r){var n,i=new RegExp(a.astralRange),s=[];do{(n=i.exec(e))&&s.push(n[0])}while(n&&s.length<r);return s}(n,0,s):(0,a.toArray)(n).slice(i,s)}},7355:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.checkForUpdates=function(){return _.apply(this,arguments)},t.default=t.hasUpdate=t.PLATFORMS=void 0;var n=a(r(19976)),i=a(r(52954)),s=a(r(50935)),o=a(r(93601)),u=a(r(65466)),l=a(r(78135));function d(){var e=(0,n.default)(["Updater: App will update. ",""]);return d=function(){return e},e}function c(){var e=(0,n.default)(["Updater: Version check failed"]);return c=function(){return e},e}function f(){var e=(0,n.default)(["Updater: Checked at "," ",""]);return f=function(){return e},e}var p={WEB:"web",DARWIN:"darwin",WIN32:"win32",MACSTORE:"darwin",WINSTORE:"win32",DARWIN_BETA:"darwin-beta",WIN32_BETA:"win32-beta"};t.PLATFORMS=p;var h=e=>[e.isBroken,e.isBelowSoft,e.isBelowHard,e.beta].some(Boolean);function _(){return(_=(0,i.default)((function*(){var e=p[s.default.WAM_PLATFORM],t=s.default.VERSION_STR.replace(/\.[di]$/,""),a=null;try{var n=yield(0,o.default)("".concat(s.default.CHECK_UPDATE_URL,"?version=").concat(t,"&platform=").concat(e));if(!n.ok)throw Error(n.statusText);a=yield n.json();var i=(new Date).toISOString();__LOG__(2)(f(),i,JSON.stringify({response:a,version:t}))}catch(e){__LOG__(4,void 0,new Error)(c())}if(!a||!h(a))return!1;var{isBelowHard:u,isBelowSoft:_,hardUpdateTime:m,currentVersion:g,isBroken:v,beta:E}=a;__LOG__(2)(d(),JSON.stringify({response:a,version:t}));var y=u?m:null;return"web"===e?l.default.update(g,_,y):v?r(17026).default.needsManualDownload=!0:l.default.update(void 0,_,y,E),!0}))).apply(this,arguments)}t.hasUpdate=h;var m=new u.default({name:"updater",interval:1800,restingInterval:3600,randomIntervalExtension:180});t.default=m},31971:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.DownloadState=void 0;var n=a(r(25337)),i=a(r(19899)),s=a(r(50935)),o=a(r(77771)),u=a(r(28267)),l=r(96452),d=a(r(58806)),c=a(r(92906)),f=r(28103).Mirrored(["UPDATE_DOWNLOADED","UPDATE_NOT_AVAILABLE","ERROR"]);t.DownloadState=f;class p extends u.default{constructor(){super(),this._forceUpdateOnTakeOver=!1,this.latestUpdateIteration=0,this.activeVersion=new c.default(s.default.VERSION_BASE),o.default.onVersionChange((()=>this.setForceUpdateOnTakeOver()))}setForceUpdateOnTakeOver(){this._forceUpdateOnTakeOver=!0}shouldForceUpdateOnTakeOver(){var e=this._forceUpdateOnTakeOver;return this._forceUpdateOnTakeOver=!1,!!e}isExpired(){return i.default.globalUnixTime()>Number(d.default)}clearHardExpiration(){this.hardExpirationTimer&&(n.default.clearTimeout(this.hardExpirationTimer),this.hardExpirationTimer=void 0),this.stopListening(r(17026).default,"change:couldForce")}update(){throw new l.UnimplementedMethod("Updater::update")}restart(){throw new l.UnimplementedMethod("Updater::restart")}manualDownload(){throw new l.UnimplementedMethod("Updater::manualDownload")}killServiceWorker(){throw new l.UnimplementedMethod("Updater::killServiceWorker")}}t.default=p},78135:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.Updater=void 0;var i=n(r(19976)),s=a(r(31971)),o=n(r(92906)),u=n(r(25337)),l=n(r(61867)),d=n(r(58906));function c(){var e=(0,i.default)(["Unable to update serviceworker, error: ",""]);return c=function(){return e},e}function f(){var e=(0,i.default)(["Unable to update service worker to version. Error: ",""]);return f=function(){return e},e}function p(){var e=(0,i.default)(["Service worker unregistration status: ",""]);return p=function(){return e},e}function h(){var e=(0,i.default)(["Killing service worker"]);return h=function(){return e},e}function _(){var e=(0,i.default)(["AppUpdate:update current: "," latest: ",""]);return _=function(){return e},e}class m extends s.default{update(e,t,a){__LOG__(2)(_(),String(this.activeVersion),String(e));var n=++this.latestUpdateIteration,i=e?new o.default(e):void 0;this.clearHardExpiration();var l=r(17026).default;return"number"==typeof a&&(this.hardExpirationTimer=u.default.setLocalTimeout((()=>(l.clientExpired=!0,this._update(i).then((e=>{e===s.DownloadState.UPDATE_DOWNLOADED&&this.restart()})))),Date.now()+a)),this.updateInProgress=Promise.resolve(this.updateInProgress).then((()=>this._update(i))).tap((e=>{this.updateInProgress=void 0,n===this.latestUpdateIteration&&e!==s.DownloadState.ERROR&&e!==s.DownloadState.UPDATE_NOT_AVAILABLE&&((t||"number"==typeof a)&&(l.needsUpdate=!0),"number"==typeof a&&this.listenToAndRun(l,"change:couldForce",(()=>{l.couldForce&&this.restart()})))}))}_update(e){if(!this.activeVersion.equals(e)&&d.default.alive)return this._swUpdate();var t=this.activeVersion.equals(e)?s.DownloadState.UPDATE_NOT_AVAILABLE:s.DownloadState.UPDATE_DOWNLOADED;return Promise.resolve(t)}killServiceWorker(){if(!d.default.alive)return Promise.resolve();var e=navigator.serviceWorker;return e?(__LOG__(2)(h()),e.ready.then((e=>e.unregister())).then((e=>{__LOG__(2)(p(),String(e))}))):Promise.resolve()}_swUpdate(){var e=navigator.serviceWorker;return e?e.ready.then((t=>new Promise((r=>{function a(e){i(),__LOG__(3)(f(),String(e))}function n(){i(),r(s.DownloadState.UPDATE_DOWNLOADED)}function i(){e.removeEventListener("error",a),e.removeEventListener("controllerchange",n)}e.addEventListener("error",a),e.addEventListener("controllerchange",n),t.update().then((()=>{t.installing||r(s.DownloadState.UPDATE_NOT_AVAILABLE)})).catch((e=>{a(e),r(s.DownloadState.ERROR)}))})))).catch((e=>(__LOG__(3)(c(),e),s.DownloadState.ERROR))):Promise.resolve(s.DownloadState.ERROR)}restart(e){return e?this.update(void 0,!0,0):(l.default.hardRefresh(void 0,!1),Promise.resolve(s.DownloadState.UPDATE_DOWNLOADED))}}t.Updater=m;var g=new m;t.default=g},92906:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(29351);class n extends((0,a.customError)("InvalidVersion")){}class i{constructor(e){var t=e.split(".");if(3!==t.length)throw new n("Version format does not contain 3 numbers.");if(this.primary=Number.parseInt(t[0],10),this.secondary=Number.parseInt(t[1],10),this.tertiary=Number.parseInt(t[2],10),Number.isNaN(this.primary)||Number.isNaN(this.secondary)||Number.isNaN(this.tertiary))throw new n("Version contains a non-parseable string.")}lt(e){var t=e;return"string"==typeof t&&(t=new i(t)),this.primary<t.primary||this.primary===t.primary&&this.secondary<t.secondary||this.primary===t.primary&&this.secondary===t.secondary&&this.tertiary<t.tertiary}equals(e){var t=e;return!!t&&("string"==typeof t&&(t=new i(t)),this.primary===t.primary&&this.secondary===t.secondary&&this.tertiary===t.tertiary)}toString(){return"".concat(this.primary,".").concat(this.secondary,".").concat(this.tertiary)}}t.default=i},74185:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.URL_REGEX=void 0;var n,i=a(r(30733)),s=a(r(15253)),o=r(46378),u=r(60339),l=a(r(883)),d=r(99888),c=r(11824),f=a(r(52267)),p=r(11419),h=a(r(99340)),_=/^(https?:\/\/(?:www\.|(?!www))[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\.[^\s]{2,}|www\.[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\.[^\s]{2,}|https?:\/\/(?:www\.|(?!www))[a-zA-Z0-9]+\.[^\s]{2,}|www\.[a-zA-Z0-9]+\.[^\s]{2,})/;t.URL_REGEX=_;var m={build:function(e,t){var r=new h.default;return(0,s.default)(t||{},((e,t)=>{r.set(t,e)})),"".concat(e,"?").concat(r.toString())},canMuckHistory:function(){return!!((0,c.isConnectedToPage)()&&window.history&&window.history.pushState&&self.location)},relToAbs:function(e){return n||(n=document.createElement("a")),n.href=e,n.href},hostname:(0,i.default)((function(e){return n||(n=document.createElement("a")),n.href=this.isHttp(e)?e:"http://"+e,n.hostname})),withoutWww:function(e){return e.split("www.").join("")},isHttp:function(e){return e&&("https://"===e.toLowerCase().substring(0,8)||"http://"===e.toLowerCase().substring(0,7))},isHttps:function(e){return e&&"https://"===e.toLowerCase().substring(0,8)},hasValidUrlScheme:function(e){var t=e.trim();return["irc://","ftp://","mailto:","http://","https://"].some((e=>0===t.toLowerCase().indexOf(e)))},isBlob:function(e){return(0,p.isString)(e)&&"blob:"===e.substring(0,5)},isData:function(e){return(0,p.isString)(e)&&"data:"===e.substring(0,5)},isEncryptedMedia:function(e){return e&&(0,p.isString)(e)&&e.endsWith(".enc")},parseDataURL:function(e){var t=e.indexOf(":"),r=e.indexOf(";"),a=e.indexOf(",");return{mimetype:e.substring(t+1,r),data:e.substring(a+1)}},dataURLtoFile:function(e){var t=this.parseDataURL(e).mimetype;return(0,d.createFile)([window.dataURLtoBlob(e)],"",{type:t})},GSM_NAME:"gme-whatsappinc",GSM_NUMS:"LM4NgcjF-X_EedaZ6MwPVSH0Sac=",gsmURL:function(e,t){var r=t.replace(/\-/g,"+").replace(/_/g,"/"),a=(0,u.decodeB64)(r),n=l.default.parse(e).path,i=o.Binary.build(n).readByteArray();return new f.default(a).sign(i).then((t=>"".concat(e,"&signature=").concat((0,u.encodeB64UrlSafe)(t))))},thumbToCSSURL:function(e){var t=this.isHttp(e)||e.startsWith("data:")?e:"data:image/jpeg;base64,".concat(e);return'url("'.concat(t,'")')},thumbAsBackgroundImage:function(e){return e?{backgroundImage:this.thumbToCSSURL(e)}:{}},isValid:e=>_.test(e)};t.default=m},73102:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){if((0,a.isConnectedToPage)()){return r(17026).default.available}return!1};var a=r(11824)},84990:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.vcardGetDate=function(e){var t=e;return(0,u.default)([/-([^-]*)-([^-]*)-([^-]*)/,/([^-]*)-([^-]*)-([^-]*)/],(r=>{var a=e.match(r);if(a){var n=!a[1].length||"1604"===a[1],i=n?"0000":a[1];return t=(0,c.default)("".concat(i,"-").concat(a[2],"-").concat(a[3])).format("l"),n&&(t=t.replace(/[.,-\/\s]*0000[.,-\/\s]*/,"")),!1}})),t},t.vcardGetOrganizationString=function(e){var t=e.ORG&&e.ORG[0],r=e.TITLE&&e.TITLE[0];if(t&&Array.isArray(t.value)&&t.value.length>0){var a=null;r&&r.value&&(a="".concat(r.value).trim());var[n,...i]=t.value;i.push(n);var s=i.map((e=>(0,h.isString)(e)?e.trim():"")).filter((e=>e.length)).join(f.default.t(619));return(a||"")+(a&&a.length&&s.length?" - ":"")+s}return""},t.vcardGetType=function(e){var t={jabber:f.default.t(1452),"skype-username":f.default.t(1457),skype:f.default.t(1457),msn:f.default.t(1454),aim:f.default.t(1442),yahoo:f.default.t(1460),icq:f.default.t(1450),"wa-biz-description":f.default.t(1444),[T]:f.default.t(1445)},r=e.properties["X-ABLabel"]||t[e.type.toLowerCase()];if(r)return function(e){if(!e)return;return e.replace(/^_\$!<([^>]*)>!\$_$/,"$1").replace(/\\,/,",").replace(/\\;/,";").replace(/\\\\/,"\\")}(r);var a={TEL:[[["cell"],f.default.t(1446)],[["iphone"],f.default.t(1451)],[["main"],f.default.t(1453)],[["home","fax"],f.default.t(1449)],[["work","fax"],f.default.t(1459)],[["home"],f.default.t(1448)],[["work"],f.default.t(1458)],[["pager"],f.default.t(1456)],[[],f.default.t(1448)]],EMAIL:[[["home"],f.default.t(1448)],[["work"],f.default.t(1458)],[["internet"],f.default.t(1447)]],URL:[[["home"],f.default.t(1448)],[["work"],f.default.t(1458)]],ADR:[[["home"],f.default.t(1448)],[["work"],f.default.t(1458)]]};return r=e.type,(0,d.default)(a,(t=>{if(t){var[a,n]=t;if(0===(0,o.default)(a,(0,s.default)(e.properties.type,(e=>e.toLowerCase()))).length)return r=n,!1}})),r},t.vcardWids=function(e){var t=[];e&&e.TEL&&e.TEL.forEach((e=>{e.properties&&e.properties.waid&&e.properties.waid.length>0&&(t=t.concat((0,s.default)(e.properties.waid,g.createUserWid)))}));return t},t.parseVcard=O,t.vcardSerialize=function(e){return e.map((function(e){return e.line.replace(/(.{75,75})/g,"$1\n ").replace(/\n^-$/gm,"")})).join("\n")},t.vcardThumbnail=function(e){if(!e)return;var{PHOTO:t}=e;if(t&&t[0]&&_.default.isData(t[0].value))return t[0].value},t.vcardGetName=w,t.vcardGetNameFromParsed=function(e){var t=null,{FN:r,NICKNAME:a,TEL:n}=e;if(r&&r[0])t=r[0].value;else if(a&&a[0])t=a[0].value;else if(n&&n[0]){var i,s=n[0],o=null===(i=s.properties.waid)||void 0===i?void 0:i[0];t=o?(0,m.default)(o):s.value}return t},t.vcardFromContactModel=function(e){var t,r=P(e.formattedName),a=["BEGIN:VCARD","VERSION:3.0","N:".concat(w(e)),"FN:".concat(r),"TEL;type=CELL;waid=".concat(String(e.userid),":").concat((0,m.default)(e.userid)),e.isBusiness?"X-WA-BIZ-NAME:".concat(r):null,(null===(t=e.businessProfile)||void 0===t?void 0:t.description)?"X-WA-BIZ-DESCRIPTION:".concat(P(e.businessProfile.description)):null,"END:VCARD"].filter(Boolean);return{displayName:r,vcard:a.join("\n"),isMultiVcard:!1}},t.getNameString=M,t.getNameStringFromNames=I,t.mergeVcards=function(e){if(0===e.length)throw new Error("No vcards provided");return 1===e.length?e[0]:{displayName:M(e),vcard:e.map((e=>e.vcard)).join("\n"),isMultiVcard:!0}},t.parseMultiVcard=function(e){var t=e.match(/BEGIN:VCARD([\s\S]*?)END:VCARD/g);return t?t.map((e=>O(e))).filter(Boolean):[]},t.vcardIsBiz=function(e){return(e.SERVICE||[]).some((e=>e.type.toLowerCase()===T&&e.value))},t.Field=void 0;var n=a(r(19976)),i=a(r(90882)),s=a(r(16760)),o=a(r(17335)),u=a(r(59756)),l=a(r(829)),d=a(r(15253)),c=a(r(19034)),f=a(r(17957)),p=a(r(61941)),h=r(11419),_=a(r(74185)),m=a(r(3111)),g=r(75637);function v(){var e=(0,n.default)(["vcard:parse failed because the vCard is not formatted as expected:\nHeader as expected? ","\nVersion as expected? ","\nFooter as expected? ","\nLines: ",""]);return v=function(){return e},e}var E=/X-([^;:]+)(?:;[^:]+)*:(.+)/,y={"X-ABLabel":[/X-ABLabel(?:;([^:]+))*:(.+)/,1],ADR:[/ADR(?:;([^:]+))*:;;(.*);(.*);(.*);(.*);(.*)/,5],"X-ABADR":[/X-ABADR(?:;([^:]+))*:(.*)/,1],URL:[/URL(?:;([^:]+))*:(.*)/,1],EMAIL:[/EMAIL(?:;([^:]+))*:(.+)/,1],TEL:[/TEL(?:;([^:]+))*:(.+)/,1]},S={N:[/N(?:;([^:]+))*:([^;]*);([^;]*);([^;]*);([^;]*);(.*)/,5],FN:[/FN(?:;([^:]+))*:(.*)/,1],NICKNAME:[/NICKNAME(?:;([^:]+))*:(.*)/,1],"X-PHONETIC-FIRST-NAME":[/X-PHONETIC-FIRST-NAME(?:;([^:]+))*:(.*)/,1],"X-PHONETIC-LAST-NAME":[/X-PHONETIC-LAST-NAME(?:;([^:]+))*:(.*)/,1],ORG:[/ORG(?:;([^:]+))*:([^;]*)(?:;(.*))*/,2],TITLE:[/TITLE(?:;([^:]+))*:(.*)/,1],TEL:[/TEL(?:;([^:]+))*:(.*)/,1],PHOTO:[/PHOTO(?:;([^:]+))*:(.*)/,1],BDAY:[/BDAY(?:;([^:]+))*:(.*)/,1],URL:[/URL(?:;([^:]+))*:(.+)/,1],EMAIL:[/EMAIL(?:;([^:]+))*:(.+)/,1]},T="wa-biz-name";class b{constructor(e,t,r,a){this.type=e,this.index=t,this.properties=r||{},this.value=a}}function A(e,t,r){e[t]||(e[t]=[]),e[t].push(r)}function C(e){var t={};return e?(e.split(";").forEach((e=>{var r=e.split(/=/);if(1===r.length){var a=r[0];A(t,a.toLowerCase(),!0)}else if(2===r.length){var[n,i]=r;A(t,n.toLowerCase(),i.toLowerCase())}})),t):t}function P(e){return e?e.replace(/\\/g,"\\\\").replace(/;/g,"\\;").replace(/,/g,"\\,"):""}function O(e){var t=e.replace(/\r?\n|\r/g,"\n").replace(/\n^[ \t]/gm,"").split("\n").filter((e=>0!==e.trim().length)),r={},a={};if(!(t.length<3)){var n=t[0].trim().toUpperCase(),i=t[1].trim().toUpperCase(),s=t[t.length-1].trim().toUpperCase(),o="VERSION:2.1"===i||"VERSION:3.0"===i||"VERSION:4.0"===i;if("BEGIN:VCARD"!==n||!o||"END:VCARD"!==s)return __LOG__(4,void 0,new Error,!0)(v(),String("BEGIN:VCARD"===n),String(o),String("END:VCARD"===s),t.length),void SEND_LOGS("vcard-fault");for(var u=2;u<t.length-1;u++){var c=t[u],f=c.match(/item(\d+)\.(.*)/),_=f?f[2]:c,m=(0,p.default)(_.match(/([^:;]*)[:;].*/),"field.match(/([^:;]*)[:;].*/)")[1],g=f?y:S,T=m,P=m,O=void 0,w=void 0;if(g[T]){var[M,I]=g[T],R=_.match(M);R&&(O=C(R[1]),w=1===I?w=R[2]:R.slice(2,2+I))}else{var D=_.match(E);D&&(P="SERVICE",T=D[1],w=D[2],O={})}if((Array.isArray(w)?w:[w]).some((e=>e&&(0,h.isString)(e)&&e.trim())))if(f){var N=f[1];a[N]?a[N].fields.push(new b(T,null,O,w)):a[N]={type:T,index:u,key:P,properties:O,value:w,fields:[]}}else A(r,P,new b(T,u,O,w))}return Object.keys(a).forEach((e=>{var{key:t,index:n,type:i,value:s,properties:o,fields:u}=a[e];u.forEach((e=>{o[e.type]=e.value})),A(r,t,new b(i,n,o,s))})),function(e){var t={};return(0,d.default)(e,((e,r)=>{t[r]=(0,l.default)(e,(e=>e.index))})),t}(r)}}function w(e){var t=(0,i.default)(e.formattedName.split(e.formattedShortName)),r=t.length?t[0].trim():void 0,a=r?e.formattedShortName:e.formattedName;return"".concat(P(r),";").concat(P(a),";;;")}function M(e){return I(e.map((e=>e.displayName)))}function I(e){var t=e.find((e=>!!e));return e.length?t?1===e.length?t:f.default.t(1031,{contactName:t,count:e.length-1,_plural:e.length-1}):f.default.t(1033,{count:e.length,_plural:e.length}):f.default.t(1032)}t.Field=b},91378:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,r,...a){if(!e)return Promise.resolve();if("string"==typeof t&&(t===o||t===u))return(0,s.default)(e,t,r,...a);d(e,(e=>{var t=l.get(e)||0;l.set(e,t+1)}));var n=t;if("object"==typeof r&&"object"==typeof n){var c;"function"==typeof r.begin&&(c=r.begin),r.begin=e=>{for(var t in n){var r=n[t];Array.isArray(r)&&(0,s.hook)(e,t,r[1])}c&&c(e)}}return(0,s.default)(e,t,r,...a).then((e=>(d(e,(e=>{var t=(l.get(e)||1)-1;0===t?(l.delete(e),function(e){var t=s.default.Utilities.data(e),{delayedElements:r}=s.default.State;(0,i.default)(r,((t,a)=>{"count"!==a&&(t!==e&&t||delete r[a])})),t&&t.velocity&&t.velocity.tweensContainer&&(t.velocity.tweensContainer.element=null);s.default.Utilities.removeData(e,["fxqueue","velocity"])}(e)):l.set(e,t)})),e)))};var i=n(r(15253)),s=a(r(86534)),o="finish",u="stop",l=new Map;function d(e,t){Array.isArray(e)?e.forEach((e=>{t(e)})):t(e)}},74824:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(r(70417)),s=n(r(22220)),o=n(r(19976)),u=n(r(17620)),l=n(r(45455)),d=a(r(2784)),c=r(9448),f=n(r(79711)),p=a(r(96452)),h=r(32392),_=r(78986),m=n(r(60069)),g=r(11419),v=n(r(91378));function E(){var e=(0,o.default)([" "," wasn't found in VelocityTransitionGroupChild transitions."]);return E=function(){return e},e}var y="enter",S="leave",T="appear";class b extends d.Component{constructor(...e){super(...e),this._isUnmounted=!1,this.setBusy=()=>{this.busyId=_.UIBusyTasks.setBusy(this.busyId),this.isBusy||(this.isBusy=!0,f.default.setUiBusy(!0,"vtg"))},this.unsetBusy=()=>{null!=this.busyId&&(_.UIBusyTasks.clearBusy(this.busyId),delete this.busyId),this.isBusy&&(this.uiBusy=!1,f.default.setUiBusy(!1,"vtg"))},this.componentWillAppear=e=>{this.animateIfEnabled(T,e)},this.componentWillEnter=e=>{this.animateIfEnabled(y,e)},this.componentWillLeave=e=>{this.animateIfEnabled(S,e)}}_getTransition(){var{transitionName:e}=this.props;if(e&&!m.default[e])throw __LOG__(4,void 0,new Error,!0)(E(),e),SEND_LOGS("transition-name"),new Error("Invalid transitionName");return e?m.default[e]:m.default.default}animateIfEnabled(e,t){var r=!1;switch(e){case y:r=this.props.transitionEnter;break;case S:r=this.props.transitionLeave;break;case T:r=this.props.transitionAppear}r?(this.setBusy(),this.animateTransitions(e).finally((()=>{this.unsetBusy()})).checkpoint(this.rejectOnUnmount()).then((()=>{(0,g.isFunction)(t)&&t()})).catchType(p.Unmount,(()=>{}))):t()}getTransitionNodes(e,t){var r=t;Array.isArray(r)||(r=[r]);var a={};return r.map((t=>{var r,{selector:n}=t,o=(0,s.default)(t,["selector"]);return r=n?n in a?a[n]:a[n]=e?Array.from(e.querySelectorAll(n)):void 0:e,(0,l.default)(r)?void 0:(0,i.default)({nodes:r},o)})).filter(Boolean)}blockAction(e){e.preventDefault(),e.stopPropagation()}animateTransitions(e){var t=e,{delay:r=0,children:a,onAnimationComplete:n}=this.props,{staggerDelay:i}=d.Children.only(a);t===T&&(t=y);var s=this._getTransition(),o=s[t];if(!s||!o)return Promise.resolve();var l=(0,u.default)(s,S,y),c=(0,h.forbiddenFindDOMNode)(this,window.Node),f=this.getTransitionNodes(c,o);return t===S&&c&&c.setAttribute&&c.addEventListener&&(c.setAttribute("pointerEvents","none",c),c.addEventListener("keypress",this.blockAction,!0),c.addEventListener("keydown",this.blockAction,!0)),Promise.all(f.map((e=>{var{nodes:t,props:a,easing:n,duration:s,delay:o,stagger:u,drag:d}=e;return(0,v.default)(t,a,{easing:n||l.easing||"easeInSine",duration:s||l.duration||0,delay:i||r||o||l.delay||0,queue:l.queue||!1,stagger:u||!1,drag:d||!1})}))).finally((()=>{l.cleanOnComplete&&t===y&&f.forEach((e=>{var t=e.nodes;(Array.isArray(t)?t:[t]).forEach((e=>e.removeAttribute("style")))})),t===S&&c&&c.removeEventListener&&(c.removeEventListener("keypress",this.blockAction,!0),c.removeEventListener("keydown",this.blockAction,!0)),n&&n()}))}componentWillUnmount(){this._isUnmounted=!0,this._rejectPromise&&this._rejector(new p.Unmount);var e=(0,h.forbiddenFindDOMNode)(this,window.Node);(0,v.default)(e,"finish")}rejectOnUnmount(){return this._rejectPromise||(this._rejectPromise=new Promise(((e,t)=>{this._rejector=t})),this._rejectPromise.catch((()=>{})),this._isUnmounted&&this._rejector(new p.Unmount)),this._rejectPromise}render(){return d.Children.only(this.props.children)}}b.defaultProps={transitionAppear:!1,transitionEnter:!0,transitionLeave:!0},b.displayName="VelocityTransitionGroupChild";class A extends d.Component{constructor(...e){super(...e),this._wrapChild=e=>d.createElement(b,this.props,e)}render(){return d.createElement(c.TransitionGroup,{childFactory:this._wrapChild,className:this.props.className,transitionName:this.props.transitionName,component:this.props.component,children:this.props.children})}}t.default=A,A.defaultProps={transitionAppear:!1,transitionEnter:!0,transitionLeave:!0},A.displayName="VelocityTransitionGroup"},91779:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.waitForOnlineNaive=function(){return(0,i.default)(self,"online").then((()=>(0,n.delayMs)(100)))};var n=r(91460),i=a(r(51701))},80084:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.getWallpaperColors=f,t.toggleWallpaperColor=function(e,t){var r=f(t);if(e===n.default.DEFAULT_CHAT_WALLPAPER)return n.default.DEFAULT_CHAT_WALLPAPER;if(i.default.wallpapersV2){var a=r.findIndex((t=>t.toUpperCase()===e.toUpperCase()));if(-1!==a)return"light"===t?c[a]:d[a]}return e},t.colorExistsInTheme=function(e,t){var r=f(t);return e===n.default.DEFAULT_CHAT_WALLPAPER||r.some((t=>t.toUpperCase()===e.toUpperCase()))},t.getWallpaperColorPropValue=p,t.getDoodleOpacity=function(e,t){if(i.default.wallpapersV2){var r=p(e,t,"opacity");if(r)return r}return"0.06"},t.getDoodleAssetName=function(e,t){var r="data-asset-chat-background-".concat(t);if(i.default.wallpapersV2&&"light"===t&&e!==n.default.DEFAULT_CHAT_WALLPAPER){var a=p(e,t,"doodle");if(a)return"data-asset-chat-background-".concat(a)}return r},t.invertTransparentWallpaperColors=function(e,t){if(i.default.wallpapersV2)return"light"===e&&t!==n.default.DEFAULT_CHAT_WALLPAPER&&!!p(t,e,"invertTransparentWallpaperColors");var r=o.includes(t);return!!f(e).includes(t)&&(r?"light"===e:"dark"===e)};var n=a(r(50935)),i=a(r(72424)),s=["#ccebdc","#aed8c7","#7acba5","#c7e9eb","#a9dbd8","#68d5d9","#6ec3d4","#f2dad5","#f2d5e1","#fbcad2","#ffa7a8","#cbdaec","#d7d3eb","#e5c0eb","#d0deb1","#dee0b4","#e6dfa8","#f7e9a8","#ffd1a4","#ff8a8c","#ff5978","#f56056","#dc6e4f","#e6e365","#73c780","#2293a4","#219ed9","#2b5aa6","#74676a","#48324d","#dee3e9","#d9dade","#c0c1c4","#7e90a3","#55626f","#243640","#162127"],o=["#ff8a8c","#ff5978","#f56056","#dc6e4f","#73c780","#2293a4","#219ed9","#2b5aa6","#74676a","#48324d","#7e90a3","#55626f","#243640","#162127"],u={"#BBE4E5":{doodle:"dark",opacity:"0.42"},"#AED8C7":{doodle:"dark",opacity:"0.3"},"#7ACBA5":{doodle:"dark",opacity:"0.26"},"#CBDAEC":{doodle:"dark",opacity:"0.42"},"#66D2D5":{doodle:"dark",opacity:"0.26"},"#63BDCF":{doodle:"dark",opacity:"0.26"},"#D6D0F0":{doodle:"dark",opacity:"0.36"},"#CECECE":{doodle:"dark",opacity:"0.36"},"#D1DABE":{doodle:"dark",opacity:"0.36"},"#E6E1B1":{doodle:"dark",opacity:"0.42"},"#FEEFA9":{doodle:"light",opacity:"0.06"},"#FED297":{doodle:"dark",opacity:"0.42"},"#FD9A9B":{doodle:"dark",opacity:"0.26"},"#FD6769":{doodle:"dark",opacity:"0.26"},"#FB4668":{doodle:"dark",opacity:"0.26"},"#922040":{doodle:"dark",opacity:"0.17",invertTransparentWallpaperColors:!0},"#DC6E4F":{doodle:"dark",opacity:"0.2"},"#644D52":{doodle:"dark",opacity:"0.13",invertTransparentWallpaperColors:!0},"#517E7E":{doodle:"dark",opacity:"0.13"},"#3190BB":{doodle:"dark",opacity:"0.13"},"#35558A":{doodle:"dark",opacity:"0.1",invertTransparentWallpaperColors:!0},"#55626F":{doodle:"dark",opacity:"0.1",invertTransparentWallpaperColors:!0},"#1D2326":{doodle:"dark",opacity:"0.1",invertTransparentWallpaperColors:!0},"#301E34":{doodle:"dark",opacity:"0.1",invertTransparentWallpaperColors:!0},"#ECF0F1":{doodle:"light",opacity:"0.06"},"#FFFEA2":{doodle:"light",opacity:"0.06"},"#E7E8D2":{doodle:"light",opacity:"0.06"}},l={"#0F2424":{doodle:"dark",opacity:"0.05"},"#12261F":{doodle:"dark",opacity:"0.055"},"#11241C":{doodle:"dark",opacity:"0.055"},"#111E27":{doodle:"dark",opacity:"0.06"},"#0F2224":{doodle:"dark",opacity:"0.06"},"#0E2125":{doodle:"dark",opacity:"0.055"},"#1F1D25":{doodle:"dark",opacity:"0.06"},"#212121":{doodle:"dark",opacity:"0.055"},"#1F211C":{doodle:"dark",opacity:"0.055"},"#23231B":{doodle:"dark",opacity:"0.055"},"#262419":{doodle:"dark",opacity:"0.055"},"#261F17":{doodle:"dark",opacity:"0.055"},"#261717":{doodle:"dark",opacity:"0.055"},"#260F10":{doodle:"dark",opacity:"0.06"},"#260A10":{doodle:"dark",opacity:"0.07"},"#19050B":{doodle:"dark",opacity:"0.075"},"#21100C":{doodle:"dark",opacity:"0.07"},"#0F0C0C":{doodle:"dark",opacity:"0.065"},"#101919":{doodle:"dark",opacity:"0.06"},"#0A1D25":{doodle:"dark",opacity:"0.055"},"#0D1523":{doodle:"dark",opacity:"0.065"},"#0D0F11":{doodle:"dark",opacity:"0.07"},"#0A0C0D":{doodle:"dark",opacity:"0.07"},"#110B12":{doodle:"dark",opacity:"0.07"},"#1E1F1F":{doodle:"dark",opacity:"0.055"},"#262618":{doodle:"dark",opacity:"0.055"},"#23231F":{doodle:"dark",opacity:"0.055"}},d=Object.keys(u),c=Object.keys(l);function f(e){return i.default.wallpapersV2?"light"===e?d:c:s}function p(e,t,r){var a="light"===t?u:l;for(var n in a)if(n.toUpperCase()===e.toUpperCase())return a[n][r];return null}},53182:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.fibonacci=function(e,t,r){if("number"==typeof r){var a=r;return function(r){switch(r.failGeneration){case 0:return Math.min(a,t);case 1:return Math.min(a,e+t);default:return Math.min(a,r.waitDuration+r.prevWaitDuration)}}}return function(r){switch(r.failGeneration){case 0:return t;case 1:return e+t;default:return r.waitDuration+r.prevWaitDuration}}},t.default=void 0;var i=n(r(19976)),s=r(39329),o=a(r(61247)),u=a(r(3594));function l(){var e=(0,i.default)(["Watchdog timed-out without handler!"]);return l=function(){return e},e}function d(){var e=(0,i.default)(["forced non-running watchdog!"]);return d=function(){return e},e}class c extends o.default{constructor(...e){super(...e),this.failGeneration=(0,o.session)(0),this.ts=(0,o.session)(),this.waitDuration=(0,o.session)(0),this.prevWaitDuration=(0,o.session)(0),this.jitter=(0,o.session)(0),this.shiftTimer=(0,o.session)(),this.waitAlgorithm=(0,o.session)(),this.onActivated=(0,o.session)(),this.onDeactivated=(0,o.session)(),this.onFed=(0,o.session)(),this.onTimeout=(0,o.session)()}initialize(){this.shiftTimer=new s.ShiftTimer((()=>p.call(this)))}activate(){this.shiftTimer.isScheduled()||(this._run(!0),this.onActivated&&this.onActivated(this))}deactivate(){this.shiftTimer.isScheduled()&&(this.shiftTimer.cancel(),this.onDeactivated&&this.onDeactivated(this))}feed(){this.shiftTimer.isScheduled()&&(this._run(!0),this.onFed&&this.onFed(this))}forceTimeout(e){this.shiftTimer.isScheduled()?null!=e&&0!==e?(this.shiftTimer.onOrBefore(e),this.ts=this.shiftTimer.ts):this.shiftTimer.forceRunNow():__LOG__(3)(d())}poke(){this.forceTimeout.apply(this,arguments)}resetGeneration(){this.failGeneration=0}_run(e){e&&this.resetGeneration();var t=this.waitAlgorithm(this),r=this.jitter*Math.random()*t;this.shiftTimer.debounce(t+r),this.set({ts:this.shiftTimer.ts,waitDuration:t,prevWaitDuration:this.waitDuration})}}var f=(0,o.defineModel)(c);function p(){var e=this.onTimeout;if(!e)return __LOG__(3)(l()),void u.upload({reason:"watchdog-no-handler"});this.failGeneration++,e(this)&&this._run(!1)}t.default=f},79345:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.open=function(e){var t,r;try{t=new U(e)}catch(e){return __LOG__(3)(T(),e),m.default.reject(e)}return new m.default(t,(function(e,t){this.id=(U.numSocketsAttempted++).toString(),__LOG__(2)(S(),this.id),r=new f.default.WebcWsOpen;var a=(0,p.openSocket)(this.url);a.binaryType="arraybuffer",a.onopen=e,a.onclose=a.onerror=function(e){t(new d.SocketError(e))},this.socket=a})).cancellable().catch((function(e){if(__LOG__(2)(y(),this.id,e),this.socket){var t=this.socket;switch(t.readyState){case WebSocket.CONNECTING:t.onopen=null;case WebSocket.OPEN:t.onerror=null,t.onclose=null,t.close();break;case WebSocket.CLOSING:case WebSocket.CLOSED:t.onerror=null,t.onclose=null}}throw e})).then((function(){__LOG__(2)(E(),this.id),r.markWebcWsOpenT(),r.commit();var e=this.socket;return e.onmessage=this._onMessage.bind(this),e.onerror=this._onCloseOrError.bind(this,!0),e.onclose=this._onCloseOrError.bind(this,!1),this._offlineListener=(0,v.default)().then(this.close.bind(this,!1,"offline")).catchType(Promise.CancellationError,(()=>{})),this._pingTimer.onOrAfter(G()),this.state=L.OPEN,this}))},t.default=t.STATE=void 0;var i=n(r(19976)),s=n(r(67304)),o=r(39329),u=a(r(61247)),l=a(r(3594)),d=a(r(96452)),c=a(r(42743)),f=n(r(40210)),p=r(45629),h=n(r(64464)),_=n(r(22253)),m=n(r(53397)),g=n(r(77626)),v=n(r(75062));function E(){var e=(0,i.default)(["WatchedSocket opened socket ",""]);return E=function(){return e},e}function y(){var e=(0,i.default)(["WatchedSocket error on open of ",": ",""]);return y=function(){return e},e}function S(){var e=(0,i.default)(["WatchedSocket opening socket ",""]);return S=function(){return e},e}function T(){var e=(0,i.default)(["WatchedSocket error constructing: ",""]);return T=function(){return e},e}function b(){var e=(0,i.default)(["WatchedSocket:releaseMessages dropping "," messages."]);return b=function(){return e},e}function A(){var e=(0,i.default)(["WatchedSocket:releaseMessages not queued!"]);return A=function(){return e},e}function C(){var e=(0,i.default)(["Socket "," closing: ",""]);return C=function(){return e},e}function P(){var e=(0,i.default)(["watchedSocket:dropped!"]);return P=function(){return e},e}function O(){var e=(0,i.default)(["watchedSocket:enqueued"]);return O=function(){return e},e}function w(){var e=(0,i.default)(["WatchedSocket:exception closing: ","\n",""],["WatchedSocket:exception closing: ","\\n",""]);return w=function(){return e},e}function M(){var e=(0,i.default)(["exception sending: ","\n",""],["exception sending: ","\\n",""]);return M=function(){return e},e}function I(){var e=(0,i.default)(["WatchedSocket "," Timeout!"]);return I=function(){return e},e}function R(){var e=(0,i.default)(["js halt longer than "," ms detected, killing socket"]);return R=function(){return e},e}var D=18e4;function N(e,t){var r=-1,a=e.find((e=>(r++,t(e))));return void 0===a?void 0:{index:r,value:a}}var L={OPEN:"OPEN",CLOSED:"CLOSED"};t.STATE=L;class k extends u.default{constructor(...e){super(...e),this.id=(0,u.session)(),this.url=(0,u.session)(),this.onmessage=(0,u.session)(),this.onactivity=(0,u.session)(),this.timeSkew=(0,u.session)(),this.msgParser=(0,u.session)(),this.state=(0,u.session)(),this.error=(0,u.session)(),this.socket=(0,u.session)(),this.isQueueing=(0,u.session)(!0),this.maxQueueSize=(0,u.session)(),this.messageQueue=(0,u.session)(),this._offlineListener=(0,u.session)(),this._msgListeners=(0,u.session)(),this._pingTimer=(0,u.session)(),this._killTimer=(0,u.session)()}initialize(){this._msgListeners=[],this.messageQueue=[],this.safariSplitter=g.default.isSafari?new h.default(this):null,this._pingTimer=new o.ShiftTimer((()=>this._ping())),this._killTimer=new o.ShiftTimer((()=>this._killSocket())),c.default.on(c.JS_HALT_EVENT,this._onJsHalt,this)}_onJsHalt(e){e>D&&(__LOG__(2)(R(),D),this._killTimer.cancel(),this._killTimer.onOrBefore(0))}_ping(){this.send("?,,"),this._killTimer.onOrAfter(x())}_killSocket(){__LOG__(3)(I(),this.id),this.close(!0,"stale")}detachCallbacks(){this.set({onactivity:void 0,onmessage:void 0})}send(e){this.cast(e),this._pingTimer.cancel(),this._killTimer.onOrAfter(x())}cast(e){if(this.state!==L.OPEN)throw new d.SocketNotOpen(this.state);if("string"==typeof e&&/\[object ArrayBuffer\]/.test(e))throw new TypeError("converted ArrayBuffer to string prematurely");if(this.safariSplitter)this.safariSplitter.send(e);else try{this.socket.send(e)}catch(e){__LOG__(3)(M(),e,e.stack),l.upload({reason:"send-exception"}),this.close(!0,e)}}partingSend(e,t,r){var a=this,n=this.socket;return new Promise((function(i){function s(){i(void 0)}n.onclose=s,n.onerror=s,n.onmessage=function(e){var t=e.data;r&&!r(t)||i(t)},a.send(t),a._onCloseOrError(!1,e)})).timeout(2e4,"paringSendTimeout").catch((()=>{})).finally((function(){n.onclose=void 0,n.onerror=void 0,n.onmessage=void 0,n.readyState===WebSocket.OPEN&&n.close()}))}close(e,t){var r,a=this.socket;if(this._onCloseOrError(e,t||"unspecified"),a&&((r=a.readyState)===WebSocket.CONNECTING||r===WebSocket.OPEN))try{a.close()}catch(e){__LOG__(3)(w(),e,e.stack)}}_onMessage(e){this._pingTimer.onOrAfter(G()),this._killTimer.cancel();var t=e.data;if("string"==typeof t&&"!"===t.charAt(0)){var r=parseInt(t.slice(1),10);return r==r&&(this.timeSkew=Date.now()-r),void(this.onactivity&&this.onactivity())}var a=this.msgParser(e);this.onactivity&&this.onactivity(a),this._onParsedMsg(a)}_onParsedMsg(e){var t=N(this._msgListeners,(function(t){return!t.filter||t.filter(e)}));t?(this._msgListeners.splice(t.index,1),t.value.removed=!0,t.value.promise.force(e)):this.isQueueing?(__LOG__(3)(O()),this.messageQueue.push(e),void 0!==this.maxQueueSize&&this.messageQueue.length>this.maxQueueSize&&this.close(!0,"Queue Overflow")):this.onmessage?this.onmessage(e):__LOG__(3)(P())}_onCloseOrError(e,t){if(this.state!==L.CLOSED){this.safariSplitter&&this.safariSplitter.cancel(),this.socket&&(this.socket.onclose=void 0,this.socket.onerror=void 0,this.socket.onmessage=void 0),this._offlineListener&&this._offlineListener.cancel(),__LOG__(3)(C(),this.id,t.toString()),c.default.off(c.JS_HALT_EVENT,this._onJsHalt,this),this._pingTimer.cancel(),this._killTimer.cancel(),this.set({state:L.CLOSED,error:e?t:void 0});var r=this._msgListeners,a=e?new d.SocketError(t):new d.SocketClosed(t);this._msgListeners=[],r.forEach((function(e){e.removed=!0,e.promise.cancel(a)}))}}holdMessages(e){var t=this.isQueueing&&void 0!==e&&this.messageQueue>e;this.set({isQueueing:!0,messageQueue:this.messageQueue||[],maxQueueSize:e}),t&&this.close(!0,"Queue Overflow")}releaseMessages(e){if(this.isQueueing){var t=this.messageQueue;this.set({isQueueing:!1,messageQueue:[]}),e?t.length>0&&__LOG__(3)(b(),t.length):t.forEach((e=>{this._onParsedMsg(e)}))}else __LOG__(3)(A())}nextMessage(e){if(this.state!==L.OPEN)return m.default.reject(new d.SocketNotOpen(this.state)).cancellable();var t;if(t=e instanceof _.default?e.test.bind(e):e,this.isQueueing){var r;if(t){var a=N(this.messageQueue,t);a&&(r=a.value,this.messageQueue.splice(a.index,1))}else this.messageQueue.length>0&&(r=this.messageQueue.shift());if(r)return m.default.resolve(r).cancellable()}var n=(new m.default).cancellable().forceable(),i={removed:!1,filter:t,promise:n};return this._msgListeners.push(i),n.catch((()=>{i.removed||(this._msgListeners=(0,s.default)(this._msgListeners,i))})),n}}var U=(0,u.defineModel)(k);U.numSocketsAttempted=0;var F=U;function G(){return 2e4*Math.random()+1e4}function x(){return 7e4*Math.random()+2e4}t.default=F},10254:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.open=function(e){var t;try{t=new A(e)}catch(e){return __LOG__(3)(m(),e),c.default.reject(e)}return new c.default(t,(function(e,t){A.numSocketsAttempted++,this.id=A.numSocketsAttempted,__LOG__(2)(_(),this.id);var r=(0,d.openSocket)(this.url);r.binaryType="arraybuffer",r.onopen=e,r.onclose=r.onerror=function(e){t(new u.SocketError(e))},this.socket=r})).cancellable().catch((function(e){if(__LOG__(2)(h(),this.id,e),this.socket){var t=this.socket;switch(t.readyState){case WebSocket.CONNECTING:t.onopen=null;case WebSocket.OPEN:t.onerror=null,t.onclose=null,t.close();break;case WebSocket.CLOSING:case WebSocket.CLOSED:t.onerror=null,t.onclose=null}}throw e})).then((function(){__LOG__(2)(p(),this.id);var e=this.socket;return e.onmessage=this._onMessage.bind(this),e.onerror=this._onCloseOrError.bind(this,!0),e.onclose=this._onCloseOrError.bind(this,!1),this._offlineListener=(0,f.default)().then(this.close.bind(this,!1,"offline")).catchType(Promise.CancellationError,(()=>{})),this.state=b.OPEN,this}))},t.default=t.STATE=void 0;var i=n(r(19976)),s=r(46378),o=r(39329),u=a(r(96452)),l=a(r(42743)),d=r(45629),c=n(r(53397)),f=n(r(75062));function p(){var e=(0,i.default)(["WatchedSocketMD opened socket ",""]);return p=function(){return e},e}function h(){var e=(0,i.default)(["WatchedSocketMD error on open of ",": ",""]);return h=function(){return e},e}function _(){var e=(0,i.default)(["WatchedSocketMD opening socket ",""]);return _=function(){return e},e}function m(){var e=(0,i.default)(["WatchedSocketMD error constructing: ",""]);return m=function(){return e},e}function g(){var e=(0,i.default)(["Socket "," closing: ",""]);return g=function(){return e},e}function v(){var e=(0,i.default)(["exception sending: ","\n",""],["exception sending: ","\\n",""]);return v=function(){return e},e}function E(){var e=(0,i.default)(["WatchedSocketMD:exception closing: ","\n",""],["WatchedSocketMD:exception closing: ","\\n",""]);return E=function(){return e},e}function y(){var e=(0,i.default)(["WatchedSocketMD "," Timeout!"]);return y=function(){return e},e}function S(){var e=(0,i.default)(["js halt longer than "," ms detected, killing socket"]);return S=function(){return e},e}var T=18e4,b={OPEN:"OPEN",CLOSED:"CLOSED"};t.STATE=b;class A{constructor(e){this.onError=null,this.dataToSend=new s.Binary,this.url=e,this._killTimer=new o.ShiftTimer((()=>this._killSocket())),l.default.on(l.JS_HALT_EVENT,this._onJsHalt,this)}_onJsHalt(e){e>T&&(__LOG__(2)(S(),T),this._killTimer.cancel(),this._killTimer.onOrBefore(0))}_killSocket(){__LOG__(3)(y(),this.id),this.close(!0,"stale")}detachCallbacks(){this.socket.onmessage=C}close(e=!1,t){var r,a=this.socket;if(this._onCloseOrError(e,t||"unspecified"),a&&((r=a.readyState)===WebSocket.CONNECTING||r===WebSocket.OPEN))try{a.close()}catch(e){__LOG__(3)(E(),e,e.stack)}}requestSend(){if(this.state!==b.OPEN)throw new u.SocketNotOpen(this.state);if(this.dataToSend.size())try{this.socket.send(this.dataToSend.readByteArray())}catch(e){__LOG__(3)(v(),e,e.stack),this.close(!0,e)}}_onMessage(e){if(!(e.data instanceof ArrayBuffer))throw new TypeError("expected ArrayBuffer from the socket");this.onData&&(0,this.onData)(new Uint8Array(e.data))}_onCloseOrError(e,t){this.state!==b.CLOSED&&(this.socket&&(this.socket.onclose=C,this.socket.onerror=C,this.socket.onmessage=C),this._offlineListener&&this._offlineListener.cancel(),__LOG__(3)(g(),this.id,t.toString()),l.default.off(l.JS_HALT_EVENT,this._onJsHalt,this),this._killTimer.cancel(),this.state=b.CLOSED,this.error=e?t:void 0,null!=this.onClose&&this.onClose())}}function C(){}t.default=A,A.numSocketsAttempted=0},36334:(e,t,r)=>{"use strict";var a=r(93291),n=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return new Promise(((t,r)=>{var a=new i.default;a.onerror=function(e){a.terminate(),r(new s.DecodeWebpResultsError("worker error",e))},a.onmessageerror=function(e){a.terminate(),r(new s.DecodeWebpResultsError("worker message error",e))},a.onmessage=e=>{a.terminate();var r=e.data;t(r)},a.postMessage({webpBuffer:e},[e])}))};var i=n(r(80967)),s=a(r(96452))},38579:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.getTotalAnimationDuration=d,t.default=function(e){var t=new Uint8Array(e);if(!m(t))return __LOG__(2)(l()),h;if(!g(t))return(0,n.default)((0,n.default)({},h),{},{emojis:_(t)});var r,a=0,i=44;for(;(0,s.default)(t.slice(i,i+4),p);){var o=i+20,u=t.slice(o,o+3);if(3!==u.length)return h;a+=c(u);var f=i+4,v=t.slice(f,f+4);if(4!==v.length)return h;i+=8+c(v),null==r&&(r=i)}var E=d(a),y=_(t);return{animationDuration:E,firstFrameLength:r,singleLoopDuration:a,emojis:y}},t.getCorrespondingEmojis=_,t.isExtendedFile=m,t.isAnimatedWebp=g,t.MAX_DURATION=t.MAX_LOOPS=void 0;var n=a(r(70417)),i=a(r(19976)),s=a(r(51107));function o(){var e=(0,i.default)(["Failed to parse emojis out of sticker, returning array."]);return o=function(){return e},e}function u(){var e=(0,i.default)(["JSON not found in sticker file"]);return u=function(){return e},e}function l(){var e=(0,i.default)(["Sticker file not extended format."]);return l=function(){return e},e}t.MAX_LOOPS=3;function d(e){if(0===e)return 0;var t=Math.min(Math.floor(5e3/e),3);return Math.max(t,1)*e}function c(e){return e.reduce(((e,t,r)=>e+(t<<8*r)),0)}t.MAX_DURATION=5e3;var f=new Uint8Array([86,80,56,88]),p=new Uint8Array([65,78,77,70]),h={animationDuration:0,singleLoopDuration:0,emojis:[]};function _(e){if(null==TextDecoder)return[];var t=String.fromCharCode(0),r=new TextDecoder,a=0;for(a+=12;a<e.byteLength;){var n=r.decode(e.slice(a,a+4)),i=c(e.slice(a+4,a+4+4));if(i%2!=0&&(i+=1),"EXIF"===n||"XMP"===n){for(var s=e.slice(a,e.byteLength),l=r.decode(s),d=void 0,f=void 0,p=l.length;p>0;--p)if(null==f&&"}"===l[p])f=p;else if(null!=f&&l[p]===t){d=p+1;break}if(null==d||null==f)return __LOG__(3)(u()),[];var h=l.substring(d,f+1);try{var _=JSON.parse(h);return Array.isArray(_.emojis)?_.emojis:[]}catch(e){return __LOG__(2)(o()),[]}}a+=8+i}return[]}function m(e){var t=e.slice(12,16);return(0,s.default)(t,f)}function g(e){var t=new Uint8Array(e);return m(t)&&0!=(2&t[20])}},68384:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(19976)),i=a(r(50935)),s=r(11419);function o(){var e=(0,n.default)(["wid:isXWid called on nonstring: + ",""]);return o=function(){return e},e}var u=/(?:^([^.:@]+))(?:\.([0-9]{1,2}))?(?:\:([0-9]{1,2}))?@(s\.whatsapp\.net|c\.us|g\.us|broadcast|call|b\.whatsapp\.net)$/i,l=["name","short","notify"];class d{constructor(e,t){if(!(t&&t.intentionallyUsePrivateConstructor))throw new Error("You should use WidFactory.createWid() instead of the Wid constructor. If you absolutely must use the constructor, pass {intentionallyUsePrivateConstructor: true} as a second parameter.");var r=e.match(u);if(!r)throw new Error("wid error: invalid wid: ".concat(e));var a,n=[],i=r[1],s=r[2],o=r[3],l=r[4].toLowerCase();switch(l){case"s.whatsapp.net":a="c.us";break;default:a=l}if(this.server=a,this.user=i,n.push(this.user),s){if("c.us"!==this.server)throw new Error("wid error: wrong server for wid with agent present: ".concat(e));var d=parseInt(s,10);if(isNaN(d))throw new Error("wid error: NaN agent: ".concat(s," wid: ").concat(e));if(d>255)throw new Error("wid error: agent>255 : ".concat(d," wid: ").concat(e));d&&(n.push("."),n.push(d),this.agent=d)}if(o){if("c.us"!==this.server)throw new Error("wid error: wrong server for wid with device present: ".concat(e));var c=parseInt(o,10);if(isNaN(c))throw new Error("wid error: NaN device: ".concat(o," wid: ").concat(e));if(c>255)throw new Error("wid error: device>255 : ".concat(c," wid: ").concat(e));c&&(n.push(":"),n.push(c),this.device=c)}n.push("@"),n.push(this.server),this._serialized=n.join("")}toString(e){if(e){var t,r,a=e.legacy&&"c.us"===this.server?"@s.whatsapp.net":this.server;if(e.formatFull?(t=".".concat(this.agent||0),r=":".concat(this.device||0)):(t=null!=this.agent&&0!==this.agent?".".concat(this.agent):"",r=null!=this.device&&0!==this.device?":".concat(this.device):""),e.formatFull||e.legacy&&"c.us"===this.server)return[this.user,t,r,a].join("")}return this._serialized}toJid(){return this.toString({legacy:!0})}getSignalAddress(){var e=null!=this.agent&&0!==this.agent?"_".concat(this.agent):"",t=null!=this.device&&0!==this.device?":".concat(this.device):"";return[this.user,e,t].join("")}getDeviceId(){var e=this.device;return null==e?0:e}equals(e){return e instanceof d&&this.toString()===e.toString()}isLessThan(e){return e instanceof d&&this.toString()<e.toString()}isGreaterThan(e){return e instanceof d&&this.toString()>e.toString()}isCompanion(){return null!=this.device&&this.device!==i.default.DEVICE.PRIMARY_DEVICE}isUser(){return"c.us"===this.server}isBroadcast(){return"broadcast"===this.server}isOfficialBizAccount(){return this.toString()===i.default.OFFICIAL_BIZ_WID}isGroup(){return"g.us"===this.server}isGroupCall(){return"call"===this.server}isServer(){return"server"===this.user&&"c.us"===this.server}isPSA(){return"0"===this.user&&"c.us"===this.server}isStatusV3(){return"status"===this.user&&"broadcast"===this.server}toJSON(){return this.toString()}static isXWid(e,t){return(0,s.isString)(t)?t.split("@")[1]===e:t instanceof d?t.server===e:(void 0!==t&&__LOG__(2)(o(),String(t)),!1)}static isUser(e){return d.isXWid("c.us",e)}static isBroadcast(e){return d.isXWid("broadcast",e)}static isGroup(e){return d.isXWid("g.us",e)}static isGroupCall(e){return d.isXWid("call",e)}static isWid(e){return(0,s.isString)(e)?u.test(e):e instanceof d}static canBeWid(e){return!e||!l.includes(e)}static isServer(e){return(0,s.isString)(e)?e.toLowerCase()===i.default.SERVER_WID:e instanceof d&&e.isServer()}static isPSA(e){return(0,s.isString)(e)?e.toLowerCase()===i.default.PSA_WID:e instanceof d&&e.isPSA()}static isStatusV3(e){return(0,s.isString)(e)?e.toLowerCase()===i.default.STATUS_WID:e instanceof d&&e.isStatusV3()}static isOfficialBizAccount(e){return(0,s.isString)(e)?e.toLowerCase()===i.default.OFFICIAL_BIZ_WID:e instanceof d&&e.isOfficialBizAccount()}static user(e){return(0,s.isString)(e)?e.split("@")[0]:e instanceof d?e.user:void 0}static equals(e,t){return e instanceof d||t instanceof d?e instanceof d&&e.equals(t):e===t}static isLessThan(e,t){return e instanceof d&&t instanceof d&&e.toString()<t.toString()}static isGreaterThan(e,t){return e instanceof d&&t instanceof d&&e.toString()>t.toString()}}t.default=d},3111:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){if(e){var t;if(e instanceof u.default?t=e.user:(0,o.isString)(e)&&(t=e.split("@")[0]),t){var r=t;return s.default.isRTL()?s.default.isolateLTR(l(r)):l(r)}}return""};var n=a(r(30733)),i=r(28721),s=a(r(17957)),o=r(11419),u=a(r(68384)),l=(0,n.default)((e=>"Server"===e?e:(0,i.formatPhone)(e)))},75637:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.createWid=o,t.createWidFromWidLike=function(e){return o("string"==typeof e?e:e._serialized)},t.isWidlike=function(e){return!!e&&(!!i.default.isWid(e)||!(!e||"object"!=typeof e||!i.default.isWid(e._serialized)))},t.createDeviceWidFromUserAndDevice=function(e,t){return u("".concat(e,":").concat(t,"@c.us"))},t.createDeviceWid=u,t.createUserWid=l,t.toUserWid=d,t.toChatWid=function(e){if(e.isUser())return d(e);return e},t.userJidToUserWid=function(e){return d(o(e))};var n=r(11419),i=a(r(68384)),s=a(r(62325));function o(e){var t;return s.default&&s.default.cache?(t=s.default.cache[e])||(t=new i.default(e,{intentionallyUsePrivateConstructor:!0}),s.default.cache[e]=t):t=new i.default(e,{intentionallyUsePrivateConstructor:!0}),t}function u(e){return o(e)}function l(e,t){var r;if(!(null!=(r=o(r=(0,n.isString)(e)&&(e.endsWith("@c.us")||e.endsWith("@s.whatsapp.net"))?e:"".concat(e,"@").concat(t||"c.us"))).device&&0!==r.device||null!=r.agent&&0!==r.agent))return r;throw new Error("createUserWid is called with invalid user string")}function d(e){if(!e.isUser())throw new Error("asUserWid: wid is not a user wid");return null!=e.device&&0!==e.device||null!=e.agent&&0!==e.agent?l(e.user):e}},69835:(e,t,r)=>{"use strict";var a=r(14859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(74185)),i={GET:"GET",POST:"POST",HEAD:"HEAD",PUT:"PUT"};function s(e,t){for(var r in t)e.setRequestHeader(r,t[r])}function o(e,t,r,a,o,u){var l=new XMLHttpRequest,d=new Promise(((d,c)=>{if(l.onload=function(e){4===l.readyState?d(l):c(e)},l.onerror=c,l.ontimeout=c,o&&(l.onprogress=o),l.onabort=c,r instanceof FormData)l.open(t||i.POST,e,!0),a&&(l.responseType=a),u&&s(l,u),l.send(r);else if(r instanceof Object){var f=n.default.build(e,r);l.open(t||i.GET,f,!0),a&&(l.responseType=a),u&&s(l,u),l.send()}else l.open(t||i.GET,e,!0),a&&(l.responseType=a),u&&s(l,u),l.send()})).cancellable();return d.catchType(Promise.CancellationError,(()=>{l.abort()})).catch((()=>{})),d}var u={head:function(e){return o(e,i.HEAD)},get:function(e,t,r=null){return o(e,i.GET,null,t,void 0,r)},post:function(e,t){return o(e,i.POST,t)},request:o,VERB:i,RESP_TYPE:{ARRAY_BUFFER:"arraybuffer",BLOB:"blob",JSON:"json"}};t.default=u},69285:(e,t,r)=>{e.exports=r.p+"img/bg-chat-tile-dark_a4be512e7195b6b733d9110b408f075d.png"},84184:(e,t,r)=>{e.exports=r.p+"img/bg-chat-tile-light_04fcacde539c58cca6745483d4858c52.png"},86148:(e,t,r)=>{e.exports=r.p+"img/f00_50f7c47f611e65a746f1d8328172af4c.png"},39830:(e,t,r)=>{e.exports=r.p+"img/f01_3d1e81d38917ed4427168024350d8df6.png"},14871:(e,t,r)=>{e.exports=r.p+"img/f02_c83a3786caa656cdcea06396bbc6c1fc.png"},13733:(e,t,r)=>{e.exports=r.p+"img/f03_dc76f32180586199d7e1872dd004832c.png"},11921:(e,t,r)=>{e.exports=r.p+"img/f04_f13406e16c2b6a8dda89763cf005b02b.png"},99100:(e,t,r)=>{e.exports=r.p+"img/f05_566b33dfb23660bf5fa83125a9dd8218.png"},75717:(e,t,r)=>{e.exports=r.p+"img/f06_f564cba48589a560af4b6e8408ae1718.png"},58163:(e,t,r)=>{e.exports=r.p+"img/f07_ae76e3caeb9dde2ad18eab0ce141d223.png"},80768:(e,t,r)=>{e.exports=r.p+"img/f08_59c98baa006f5eac6629be0957fd73f2.png"},7271:(e,t,r)=>{e.exports=r.p+"img/f09_1a7f295d0fa98fa1d2a63f8dc4600341.png"},65498:(e,t,r)=>{e.exports=r.p+"img/f10_53c9084de35f9f003ed395e1d120d9b6.png"},70461:(e,t,r)=>{e.exports=r.p+"img/f11_c129c05bc58cad686e0934357d6194fb.png"},60704:(e,t,r)=>{e.exports=r.p+"img/f12_bf90fa5257d34005ad5b75ffebb9b74c.png"},98796:(e,t,r)=>{e.exports=r.p+"img/f13_156bc51d4150b9b257fa4e2e774ce985.png"},24036:(e,t,r)=>{e.exports=r.p+"img/f14_95fa7d926a8cf1638985d3cd551fac31.png"},7658:(e,t,r)=>{e.exports=r.p+"img/f15_454f1add82fcb11fbb4086c8be3b1bd9.png"},36722:(e,t,r)=>{e.exports=r.p+"img/f16_9ca6324f98317f9d73084696719d2b9b.png"},23918:(e,t,r)=>{e.exports=r.p+"img/f17_9376c16fcd9b554de8a081973bebe9aa.png"},9292:(e,t,r)=>{e.exports=r.p+"img/f18_cc883fb28c32b1652826de5dc16feee0.png"},15210:(e,t,r)=>{e.exports=r.p+"img/f19_c448ba8ef94abcf763e25003aa15d27d.png"},8715:(e,t,r)=>{e.exports=r.p+"img/f20_4ebcff229b29e651b73640d0cd8eccb2.png"},50309:(e,t,r)=>{e.exports=r.p+"img/f21_54d02a1f6ad665760923ecfae9c9ff25.png"},95977:(e,t,r)=>{e.exports=r.p+"img/f22_ca38cbb571fbddb6900518455b8a20b9.png"},77882:(e,t,r)=>{e.exports=r.p+"img/f23_851a6d2ec552319ddaac7ff8ff37263e.png"},95220:(e,t,r)=>{e.exports=r.p+"img/f24_7806bc8ea69d9441ff27032fbaf52907.png"},44876:(e,t,r)=>{e.exports=r.p+"img/f25_68d927d9d12aef33387b683be6341340.png"},62976:(e,t,r)=>{e.exports=r.p+"img/f26_eb28a47950f61dc80827a74063d8786a.png"},97824:(e,t,r)=>{e.exports=r.p+"img/f27_d53f3b6cf583d7a41f3434d18fe4456e.png"},41153:(e,t,r)=>{e.exports=r.p+"img/f28_245f3d8d8dae33bdc04373918922c5a8.png"},43132:(e,t,r)=>{e.exports=r.p+"img/f29_31c6170329c4cf5808fe773488b5d143.png"},56788:(e,t,r)=>{e.exports=r.p+"img/f30_105e340803065abb74841ce2fff42b4b.png"},88193:(e,t,r)=>{e.exports=r.p+"img/f31_db46b1350eb553583212866aa44e2ac0.png"},68088:(e,t,r)=>{e.exports=r.p+"img/f32_4c358e4136bab81e06b7fd7171a7908c.png"},34577:(e,t,r)=>{e.exports=r.p+"img/f33_5a8f246313db052d67853a40f77a6427.png"},89374:(e,t,r)=>{e.exports=r.p+"img/f34_8588016a836bc826824d0656c8b7b0bc.png"},71207:(e,t,r)=>{e.exports=r.p+"img/f35_8aefe3b46c378109f0f780b6954e18db.png"},17809:(e,t,r)=>{e.exports=r.p+"img/f36_793fc72fadaf963507fc6802a9470970.png"},48105:(e,t,r)=>{e.exports=r.p+"img/f37_8d8f6653cbe1f6dd3783174a8af618da.png"},53184:(e,t,r)=>{e.exports=r.p+"img/f38_54b8f37e9f1251bfe9a2a2ef88a31912.png"},32540:(e,t,r)=>{e.exports=r.p+"img/f39_23a6e90aa9166a2fb981cc171abe8513.png"},64303:(e,t,r)=>{e.exports=r.p+"img/f40_923f39f07df4b8ad006e1115dcb206ec.png"},27885:(e,t,r)=>{e.exports=r.p+"img/f41_87448793e4bcea7fae3cfa7532e45033.png"},54196:(e,t,r)=>{e.exports=r.p+"img/f42_cd0e42183cff2e75bdde0c139bbb641a.png"},69034:(e,t,r)=>{e.exports=r.p+"img/f43_9f44150edcf010967cf272c80bd4ff14.png"},98754:(e,t,r)=>{e.exports=r.p+"img/f44_7f5d4a3e29f21bd5d5572a1543448949.png"},47050:(e,t,r)=>{e.exports=r.p+"img/f45_04c55805346c4afbc7f8084570a2cd48.png"},64690:(e,t,r)=>{e.exports=r.p+"img/f46_1e9f9b05193093b5d0d80d9c936bcb36.png"},1788:(e,t,r)=>{e.exports=r.p+"img/f47_152a85c5e9ff12d5f85050ecad1d4313.png"},52341:(e,t,r)=>{e.exports=r.p+"img/f48_bd6d89500662b8605997f54027b2e650.png"},66470:(e,t,r)=>{e.exports=r.p+"img/f49_42185158c0bfff92c70f417c74297ce7.png"},66793:(e,t,r)=>{e.exports=r.p+"img/f50_d825d156222c0d93428f4ecd78564c75.png"},10644:(e,t,r)=>{e.exports=r.p+"img/f51_51e116016636d309962001419e70d5f1.png"},8388:(e,t,r)=>{e.exports=r.p+"img/f52_5296e30be9bec98ccf173a9be6e711a9.png"},29959:(e,t,r)=>{e.exports=r.p+"img/f53_f81b7a3702779e190aeefb7e2183e636.png"},77612:(e,t,r)=>{e.exports=r.p+"img/f54_37b3eb612da7ad6c0b20b65e4fdae582.png"},2108:(e,t,r)=>{e.exports=r.p+"img/f55_0c3d912e971e18d6fe8946550262d0e6.png"},18942:(e,t,r)=>{e.exports=r.p+"img/f56_97a65c1c44dced234e0fbb5f78cb277f.png"},16583:(e,t,r)=>{e.exports=r.p+"img/f57_88b41898da1ce86274ee318e1713f437.png"},79024:(e,t,r)=>{e.exports=r.p+"img/f58_56649fe103006ec4fc5bdea5c69f7828.png"},2176:(e,t,r)=>{e.exports=r.p+"img/f59_1dd065a271b58e1ecb9bb3b6c261107f.png"},80669:(e,t,r)=>{e.exports=r.p+"img/f60_4b277b056575663ee9dbf81fecce989e.png"},14939:(e,t,r)=>{e.exports=r.p+"img/f61_ef3fba8c7e6d895afacfb334e7a746ff.png"},7045:(e,t,r)=>{e.exports=r.p+"img/f62_edecb61bfd5cd13895dd8134898d4402.png"},4878:(e,t,r)=>{e.exports=r.p+"img/f63_245e85a3728d5fed6ff9acf1182f4797.png"},62663:(e,t,r)=>{e.exports=r.p+"img/f64_48df8c352924ef1153bb8fd56f5af198.png"},34141:(e,t,r)=>{e.exports=r.p+"img/f65_162b82a8adaf7d2815129f38f265bfb6.png"},1453:(e,t,r)=>{e.exports=r.p+"img/f66_c626c592461087351ad719fa3118959d.png"},48450:(e,t,r)=>{e.exports=r.p+"img/f67_daa263ddff773a14e3ababc4b485a7c9.png"},45216:(e,t,r)=>{e.exports=r.p+"img/f68_ec21f5c8c90ec3bbf634290d6e6025c0.png"},46839:(e,t,r)=>{e.exports=r.p+"img/f69_549a880f1517135abf8914b4cb31fa92.png"},89954:(e,t,r)=>{e.exports=r.p+"img/f70_a69c6599124e3c33d7fac368b07c0249.png"},89205:(e,t,r)=>{e.exports=r.p+"img/f71_4aceb1dc5eaeb5f9cdddf4975e45a841.png"},47955:(e,t,r)=>{e.exports=r.p+"img/f72_f4ed6835609bf3831a20437e8e47d2dc.png"},18350:(e,t,r)=>{e.exports=r.p+"img/f73_94b8b5d2760e6afd967fd74a008cfae0.png"},84603:(e,t,r)=>{e.exports=r.p+"img/f74_2cd31cfe47f05fabb12f9b9f76fc2b6b.png"},34274:(e,t,r)=>{e.exports=r.p+"img/f75_25366bc618fe77d5dfd9db90133f2766.png"},22717:(e,t,r)=>{e.exports=r.p+"img/f76_1347ad29de86f3d0ceb3bf329b06a0a7.png"},23220:(e,t,r)=>{e.exports=r.p+"img/f77_6749eab5d350640476c8ec39ebc3e4db.png"},37769:(e,t,r)=>{e.exports=r.p+"img/f78_9effc679939e4458adafae48294a5db5.png"},70926:(e,t,r)=>{e.exports=r.p+"img/f79_36df3d2cd225fa6b3a6c84c69b72bed1.png"},11674:(e,t,r)=>{e.exports=r.p+"img/f80_f94a52bb981c25a9f8643a55d023be59.png"},50251:(e,t,r)=>{e.exports=r.p+"img/f81_fb74d3d4cc5a27e62e93586c7d09e47e.png"},12627:(e,t,r)=>{e.exports=r.p+"img/f82_2741f2d09772f3e9e836f2c50fb0bf99.png"},44078:(e,t,r)=>{e.exports=r.p+"img/f83_f8586167f3fde3b1e0c7dbb479e5c0ab.png"},3280:(e,t,r)=>{e.exports=r.p+"img/f84_f5b79393aa7e2979b376c76f46d39b52.png"},88468:(e,t,r)=>{e.exports=r.p+"img/f85_7ea40f8452fb838a747fb0881ffd5980.png"},371:(e,t,r)=>{e.exports=r.p+"img/f86_486fdf332fda50c1cd7c4b9bd8a3f993.png"},79868:(e,t,r)=>{e.exports=r.p+"img/f87_91e88bfc16e4baddaf2fc4f881c3efc5.png"},77242:(e,t,r)=>{e.exports=r.p+"img/f88_286401f05def8a122db7f4686e383691.png"},8768:(e,t,r)=>{e.exports=r.p+"img/f89_658f39d559719b5b6208346f6a7753b9.png"},22708:(e,t,r)=>{e.exports=r.p+"img/f90_d5612bad79e603d92135c3bbfbcd14d1.png"},35308:(e,t,r)=>{e.exports=r.p+"img/f91_58bb429f953c740a98bcab0c032e8e25.png"},65820:(e,t,r)=>{e.exports=r.p+"img/f92_970e0969177b051897bdd55bf12ee3ae.png"},91220:(e,t,r)=>{e.exports=r.p+"img/f93_4776ec98a5d48ae85b24621ad1eac6eb.png"},75585:(e,t,r)=>{e.exports=r.p+"img/f94_296c4ae16a836cf0903cc5ef0476333c.png"},54895:(e,t,r)=>{e.exports=r.p+"img/f95_888ec2f78b312aed756a8d7008dc979b.png"},92199:(e,t,r)=>{e.exports=r.p+"img/f96_5b97286be655dbd4f5aa79f5f008c5ce.png"},72426:(e,t,r)=>{e.exports=r.p+"img/f97_b4ff99d92592c44b5d8a5b501fc24da6.png"},30002:(e,t,r)=>{e.exports=r.p+"img/f98_0922d228059acde80cc489a2879fe864.png"},66365:(e,t,r)=>{e.exports=r.p+"img/f99_c608e2edac2f741a5a39b814ba36c287.png"},33126:(e,t,r)=>{e.exports=r.p+"img/favicon-error_ac2b4ac0b3a8a9d2256d517e69a3e272.png"},99289:(e,t,r)=>{e.exports=r.p+"img/favicon-error2_fb2afa4bfd23495c7bd2555bb080bb35.png"},75233:(e,t,r)=>{e.exports=r.p+"img/favicon_c5088e888c97ad440a61d247596f88e5.png"},28004:(e,t,r)=>{e.exports=r.p+"img/f00_81a748c30861e19178cb90ab8b31c9e4.png"},53470:(e,t,r)=>{e.exports=r.p+"img/f01_78cd893586564a736b94f919cd2851f7.png"},86319:(e,t,r)=>{e.exports=r.p+"img/f02_4bfcfe058a11109e81b7e9cbdfdeb02a.png"},84796:(e,t,r)=>{e.exports=r.p+"img/f03_577fd59324f5db48af17efcba0a23ea5.png"},86270:(e,t,r)=>{e.exports=r.p+"img/f04_841c20c722f90620ba13762ae73f6143.png"},8021:(e,t,r)=>{e.exports=r.p+"img/f05_c1bde74d642126370c5da5fb0de680c6.png"},76007:(e,t,r)=>{e.exports=r.p+"img/f06_eb85be6945aa4a51c3e05d97ecb1c290.png"},68946:(e,t,r)=>{e.exports=r.p+"img/f07_4d1031e781a9619d0579571eb2049ee6.png"},27610:(e,t,r)=>{e.exports=r.p+"img/f08_4d61c3d691066fa829ad43af1d6063ca.png"},51680:(e,t,r)=>{e.exports=r.p+"img/f09_f9d4e1b3266f81e8952251520de80711.png"},24263:(e,t,r)=>{e.exports=r.p+"img/f10_1f2eeb1340d4c4b4d423117d47d5f56e.png"},70791:(e,t,r)=>{e.exports=r.p+"img/f11_699424412fed1628d27e04957a284d2e.png"},42115:(e,t,r)=>{e.exports=r.p+"img/f12_ef4dd9b4bc88503d33fde312a57af7f9.png"},52140:(e,t,r)=>{e.exports=r.p+"img/f13_0bf1895a611a2187f9758ac305e87d2e.png"},12552:(e,t,r)=>{e.exports=r.p+"img/f14_df2ad83835b022116ce26f030de1a13d.png"},40647:(e,t,r)=>{e.exports=r.p+"img/f15_cffc8769d0c2ef7f8f8d5fc16e339cab.png"},94262:(e,t,r)=>{e.exports=r.p+"img/f16_8b958a65cb9dbf5c7716f1c865391473.png"},44834:(e,t,r)=>{e.exports=r.p+"img/f17_83147bc30e9d1cfe9ae417bf4afc2f77.png"},6989:(e,t,r)=>{e.exports=r.p+"img/f18_9595be739a769411763ad68c24cb245f.png"},43185:(e,t,r)=>{e.exports=r.p+"img/f19_2b465cf764fb53292292e003e070268a.png"},81079:(e,t,r)=>{e.exports=r.p+"img/f20_a781e4e7a5b4d97c226843b0f2d1472d.png"},32418:(e,t,r)=>{e.exports=r.p+"img/f21_b03a1e45532edd017ebbda6b8e2566bb.png"},73547:(e,t,r)=>{e.exports=r.p+"img/f22_809ee1be83cf9aba76ecde6bf3e65e58.png"},90487:(e,t,r)=>{e.exports=r.p+"img/f23_e2c0fa78795ee79b68fdbdca50a960ae.png"},29547:(e,t,r)=>{e.exports=r.p+"img/f24_3832927a08d4eec1867a7d7c4ba2fcd7.png"},56193:(e,t,r)=>{e.exports=r.p+"img/f25_0ade03b46b6e8819de9523bc8ff6a7cd.png"},42216:(e,t,r)=>{e.exports=r.p+"img/f26_e38c0e2c62dae55d9cdf26d8c22b6b9d.png"},20390:(e,t,r)=>{e.exports=r.p+"img/f27_b4871a7570313a9f599b1911f339413d.png"},79843:(e,t,r)=>{e.exports=r.p+"img/f28_1b3971aa7b75218570c3d9940aa4a73d.png"},36277:(e,t,r)=>{e.exports=r.p+"img/f29_f2c7a605126e29e8885601cdc65e6aa0.png"},20801:(e,t,r)=>{e.exports=r.p+"img/f30_712d71bfb048818a771a9d144b40d9aa.png"},95368:(e,t,r)=>{e.exports=r.p+"img/f31_1d19e90516ce464192bd7016d05a2dba.png"},13756:(e,t,r)=>{e.exports=r.p+"img/f32_9a70dc1de944f622b350752076a6310d.png"},86106:(e,t,r)=>{e.exports=r.p+"img/f33_1f3382e82a8abe7cdce46f789f7c4ede.png"},42977:(e,t,r)=>{e.exports=r.p+"img/f34_29dc69ea8e91117dae46fcf7e7f58417.png"},8332:(e,t,r)=>{e.exports=r.p+"img/f35_fa478612d2487e2fead293b7005566ea.png"},27984:(e,t,r)=>{e.exports=r.p+"img/f36_bb827e69f0979553e18c0fd1cb192b02.png"},83195:(e,t,r)=>{e.exports=r.p+"img/f37_b06f5850d2c8eda0c51ad5491779af6c.png"},15241:(e,t,r)=>{e.exports=r.p+"img/f38_0b370e976457b876910c4a638ac302e2.png"},59286:(e,t,r)=>{e.exports=r.p+"img/f39_a09d7dfecc70b04ec35edc2967c60a30.png"},84608:(e,t,r)=>{e.exports=r.p+"img/f40_ed134cdcd59bb430218f2be2cdd20aa1.png"},48636:(e,t,r)=>{e.exports=r.p+"img/f41_a785dbfd120b89c2e8616357b9722163.png"},32956:(e,t,r)=>{e.exports=r.p+"img/f42_4149402ff16c6de0b1b06eff01619455.png"},62911:(e,t,r)=>{e.exports=r.p+"img/f43_d543d1bc6a09014ac24d7189b0ced761.png"},56025:(e,t,r)=>{e.exports=r.p+"img/f44_9ffa8beb4bd1c21f328fdd822cba19a7.png"},50683:(e,t,r)=>{e.exports=r.p+"img/f45_0c3cea68945b437380dacd15cbe90ded.png"},62274:(e,t,r)=>{e.exports=r.p+"img/f46_58320ab4676a6287d9dec0790f0d88fc.png"},71129:(e,t,r)=>{e.exports=r.p+"img/f47_5f2ac6f7a9fe79dc3d9a701872c0d0f8.png"},83966:(e,t,r)=>{e.exports=r.p+"img/f48_5fdbdf26d5c581f2a84ebfa50355bd2d.png"},27335:(e,t,r)=>{e.exports=r.p+"img/f49_7bd9cdf5a225ef778b0abd7c9b5310ba.png"},20334:(e,t,r)=>{e.exports=r.p+"img/f50_f4b49b8b3eb729c1fd7c991958aa67b7.png"},87549:(e,t,r)=>{e.exports=r.p+"img/f51_cccd95bad4c9b8e03d05f634e91d2cc8.png"},48841:(e,t,r)=>{e.exports=r.p+"img/f52_8cc8a9757166f53c59a5a1c5e2ebeb00.png"},24639:(e,t,r)=>{e.exports=r.p+"img/f53_623900497390a42269ea6c7ffd812ecc.png"},2582:(e,t,r)=>{e.exports=r.p+"img/f54_c114021c7945464df273df92403987cb.png"},34532:(e,t,r)=>{e.exports=r.p+"img/f55_bcfef9ad8bf26d250613af9b04c918cf.png"},95161:(e,t,r)=>{e.exports=r.p+"img/f56_76dd317a660aa4927e72484ef9d903fb.png"},63219:(e,t,r)=>{e.exports=r.p+"img/f57_72ed0f17ab92bb06761245cb5a7fd73b.png"},82606:(e,t,r)=>{e.exports=r.p+"img/f58_8b9aa917870bcfabc296989c8a810446.png"},1473:(e,t,r)=>{e.exports=r.p+"img/f59_1a64de23c9ec094314b18a18108319ce.png"},80184:(e,t,r)=>{e.exports=r.p+"img/f60_4926d3e8b53f38a3c792cb7b3e07d48d.png"},88573:(e,t,r)=>{e.exports=r.p+"img/f61_08509dff37749613925fe8b16a84ba56.png"},79601:(e,t,r)=>{e.exports=r.p+"img/f62_0869c06452d4ebecdc99f7192ebc702f.png"},65485:(e,t,r)=>{e.exports=r.p+"img/f63_6083f333c2239cba7bbde44e7607a67c.png"},10066:(e,t,r)=>{e.exports=r.p+"img/f64_5d2e1af055fb2cb08326de8e4a844eab.png"},52228:(e,t,r)=>{e.exports=r.p+"img/f65_c863d05c20e4ff179c46170a5311afaf.png"},15706:(e,t,r)=>{e.exports=r.p+"img/f66_1971ad2c6440b2fc909759d8614ef901.png"},56311:(e,t,r)=>{e.exports=r.p+"img/f67_8817a536067dadbc7dc0b1ce0c7cca51.png"},9713:(e,t,r)=>{e.exports=r.p+"img/f68_11393ba2b52ac23a884f923672858aa3.png"},36807:(e,t,r)=>{e.exports=r.p+"img/f69_6a31bf9a0987d546a53d7e8e148d9fa3.png"},16144:(e,t,r)=>{e.exports=r.p+"img/f70_6a12b8c8cf306de335b3174c92c7d63d.png"},15655:(e,t,r)=>{e.exports=r.p+"img/f71_363e1241dbcac22f3bebce9bb5e03e85.png"},84031:(e,t,r)=>{e.exports=r.p+"img/f72_ae6ac1146134ea79656c595a1a2d0e8b.png"},57234:(e,t,r)=>{e.exports=r.p+"img/f73_c9b6d05e598e5adf69ceab85f5db96ac.png"},92570:(e,t,r)=>{e.exports=r.p+"img/f74_67c9ceb4623d37c005ae86e28e4e9fbe.png"},35436:(e,t,r)=>{e.exports=r.p+"img/f75_62cbd93e646a20f624123b595584f2a2.png"},87885:(e,t,r)=>{e.exports=r.p+"img/f76_6862123772ba72af8d1f307c0d2b4895.png"},11873:(e,t,r)=>{e.exports=r.p+"img/f77_78710dcf8b6d89f3951e7887f95408bf.png"},11179:(e,t,r)=>{e.exports=r.p+"img/f78_59e408dc54ae0bd33f3617f7ee9bb2e0.png"},6553:(e,t,r)=>{e.exports=r.p+"img/f79_6682dcc8dd4b1c197e7ec7b9b3deb601.png"},14047:(e,t,r)=>{e.exports=r.p+"img/f80_0d13bdc19570b4c3577062fd0a3a1428.png"},26136:(e,t,r)=>{e.exports=r.p+"img/f81_bfb32e248b9a30d62e32a1f7ea4e7e98.png"},26500:(e,t,r)=>{e.exports=r.p+"img/f82_286f2cdea929dc7b1565aad502aaf165.png"},68986:(e,t,r)=>{e.exports=r.p+"img/f83_4984ad9c5348e8717965f575ac7ea534.png"},43803:(e,t,r)=>{e.exports=r.p+"img/f84_4d4303666006c977553c896dd850fc1b.png"},57069:(e,t,r)=>{e.exports=r.p+"img/f85_10cbc8d1444126f654a032456a74a72c.png"},39114:(e,t,r)=>{e.exports=r.p+"img/f86_03d43f57ad876d0367274524fd27b4ec.png"},37368:(e,t,r)=>{e.exports=r.p+"img/f87_610b9a8f68249032da365af5a664fc41.png"},50260:(e,t,r)=>{e.exports=r.p+"img/f88_5ad6ef9e65165c4bb4c670ce875a5fb5.png"},80159:(e,t,r)=>{e.exports=r.p+"img/f89_e049c6b076ab9212a901406939d7274e.png"},4636:(e,t,r)=>{e.exports=r.p+"img/f90_88c16bdd2fd8228ad1ec89ce3f0cb118.png"},7297:(e,t,r)=>{e.exports=r.p+"img/f91_78d445d5baae7479cac968c11f6724dc.png"},88029:(e,t,r)=>{e.exports=r.p+"img/f92_34f845f9fa2a3667d8d747453f63ad68.png"},84886:(e,t,r)=>{e.exports=r.p+"img/f93_2f324509fe48d002f5a944b003cd180d.png"},42825:(e,t,r)=>{e.exports=r.p+"img/f94_c406ffa6170c14bcbe3158ab7879ce16.png"},9577:(e,t,r)=>{e.exports=r.p+"img/f95_7ce72143c371f981d394ab9b3391f5ea.png"},54614:(e,t,r)=>{e.exports=r.p+"img/f96_bc32095dc9dab040674f58592e10451b.png"},72313:(e,t,r)=>{e.exports=r.p+"img/f97_eedf5849b413d903c4cc72cca6ce0576.png"},36487:(e,t,r)=>{e.exports=r.p+"img/f98_8d47ec83349711222b6d9346049676f1.png"},45657:(e,t,r)=>{e.exports=r.p+"img/f99_d27a48329dde7e88d3d7cd348d745f91.png"},82193:(e,t,r)=>{e.exports=r.p+"img/favicon-error_ef91873fcda4eda22679f675ebf6ed24.png"},23445:(e,t,r)=>{e.exports=r.p+"img/favicon-error2_7ce1b67dbef23e87862b3c12b9b32676.png"},31303:(e,t,r)=>{e.exports=r.p+"img/favicon_94e99ab189284094867d2e1220e42e9f.png"},72383:(e,t,r)=>{e.exports=r.p+"img/icon-group-default_92b8a80d57227e2f342bd57ccf6382d8.png"},35616:(e,t,r)=>{e.exports=r.p+"img/icon-user-default_bfb4ec026499f5b2d80e673a1a3a5bd7.png"},68141:(e,t,r)=>{e.exports=r.p+"img/intro-connection-dark_0ee01153183b5ebd9b296399cc2104b0.jpg"},55175:(e,t,r)=>{e.exports=r.p+"img/intro-connection-hq-dark_f8cb12a6fc73afaf9d5903b7849bebd6.jpg"},47890:(e,t,r)=>{e.exports=r.p+"img/intro-connection-hq-light_9466a20e6d2921a21ac7ab82419be157.jpg"},19303:(e,t,r)=>{e.exports=r.p+"img/intro-connection-light_c98cc75f2aa905314d74375a975d2cf2.jpg"},42479:(e,t,r)=>{e.exports=r.p+"img/qr-video-hq_96cc4255e20a97852c14cbc15995bc0d.jpg"},75259:(e,t,r)=>{e.exports=r.p+"img/qr-video_07f8d2958696dceefa4f4676aeb4663e.jpg"},31472:(e,t,r)=>{e.exports=r.p+"notification_2a485d84012c106acef03b527bb54635.mp3"},63946:(e,t,r)=>{e.exports=r.p+"send_message_98602e277c84944aafc41098fa4dd8d8.m4a"},16653:(e,t,r)=>{e.exports=r.p+"sequential-ptt-end_62ed28be622237546fd39f9468a76a49.mp3"},91356:(e,t,r)=>{e.exports=r.p+"sequential-ptt-middle_7fa161964e93db72b8d00ae22189d75f.mp3"},84592:(e,t,r)=>{e.exports=r.p+"whatsapp-webclient-login-hq_10ce945f706bbd216466cd05f672164d.mp4"},40189:(e,t,r)=>{e.exports=r.p+"whatsapp-webclient-login_a0f99e8cbba9eaa747ec23ffb30d63fe.mp4"},59802:(e,t,r)=>{"use strict";r.r(t),t.default={wrapper:"_3h3LX",isQR:"_1dqoA",isQr:"_1dqoA",draggableHeader:"_3WvPc",isMain:"_34ybp"}},43764:(e,t,r)=>{"use strict";r.r(t)},95387:(e,t,r)=>{"use strict";r.r(t),t.default={button:"_1dwBj",plainWhite:"_2EcSg",primary:"_3xWLK",secondary:"Spzqc",strongPrimary:"_1l_x_",warning:"_1BFEX",itemFocused:"_3nDx1",disabled:"JVgjR",nowrap:"_2V1EM",simplified:"_2ewuV",spinner:"_1G_dx",strong:"_1OaoY"}},67347:(e,t,r)=>{"use strict";r.r(t),t.default={link:"_24xcm"}},69630:(e,t,r)=>{"use strict";r.r(t),t.default={noop:"_3wXwX"}},18464:(e,t,r)=>{"use strict";r.r(t),t.default={noop:"_3-8er"}},12461:(e,t,r)=>{"use strict";r.r(t),t.default={"-emoji-picker-width":"388px",emojiPickerWidth:"388px",container:"_1qAEq",right:"_11bi2",picker:"_9lBgK",tooltip:"_1o8x9",items:"_19rjv",nib:"nlx4A",inverse:"_1rzcO",colorPicker:"_1In2E",emoji:"_2iHK1",sticker:"_1zmqw",inverseVertical:"gYkeG",text:"IBBBs",icons:"_3BZyX"}},4141:(e,t,r)=>{"use strict";r.r(t)},62018:(e,t,r)=>{"use strict";r.r(t),t.default={flex:"_3NCXc",directionHorizontal:"_FUG3",directionVertical:"_2EBj2",directionHorizontalReverse:"_1NF4-",directionVerticalReverse:"_3uUjW",justifyStart:"_1epIK",justifyCenter:"_1Yw2u",justifyEnd:"_2SPxy",justifyAll:"_2E7Hg",justifyAround:"_2dV6s",justifyEvenly:"_3tjJI",alignCenter:"_2HGw4",alignStart:"_3Ti0R",alignEnd:"JP43o",alignStretch:"eKyMO",alignBaseline:"_2L34J",wrap:"_2KzS4",wrapReverse:"OE8lY"}},9435:(e,t,r)=>{"use strict";r.r(t),t.default={flexItem:"VtaVl",alignAuto:"-TvKO",alignStart:"_2PYOl",alignCenter:"_3hCgp",alignEnd:"_1BZaG",alignStretch:"_7Uh2Y"}},50036:(e,t,r)=>{"use strict";r.r(t),t.default={progress:"_2Ps9W"}},61316:(e,t,r)=>{"use strict";r.r(t),t.default={video:"_3UUj0",container:"_2epc6",player:"_3fERx",poster:"_1vpd2",hidden:"_34HJw",overlay:"_2cwBX",button:"_3khBQ",play:"_1Sw8v"}},17024:(e,t,r)=>{"use strict";r.r(t),t.default={qrWrapper:"_3870-",text:"_29lv_",qr:"O1rXL",headline:"_24CXv",list:"_2yDOs",listItem:"ZJ0wv",hint:"_1Id11",toggle:"_37xqU",tip:"_2-pPz",rememberMeTip:"_1a-np",codeCopy:"_2fkxk",qrcode:"_3jid7",codeLogo:"-A_bA",idle:"_267ZZ",qrButton:"_3DeCQ",qrButtonIcon:"_2tiyK",groupInviteTip:"_2bTE0",icon:"_2zr6K"}},38447:(e,t,r)=>{"use strict";r.r(t),t.default={container:"_1sMV6"}},32186:(e,t,r)=>{"use strict";r.r(t),t.default={container:"_1XTIr"}},9807:(e,t,r)=>{"use strict";r.r(t),t.default={container:"_132Kx","rotate-ltr":"_1kCJK",rotateLtr:"_1kCJK",path:"_2EU5z",dash:"_3mEDO",default:"_2ZoUA",white:"_3ET3C",solidwhite:"_3ZJnR",highlight:"_39w8M",accent:"_3jpnp",in:"_3p1-X",out:"_3H_WX",noop:"_3JV-p","rotate-rtl":"_8Bv1n",rotateRtl:"_8Bv1n"}},10476:(e,t,r)=>{"use strict";r.r(t),t.default={reverse:"_1XP9x",inline:"_2nw-x",white:"_1xoWz",black:"_1-09X"}},32455:(e,t,r)=>{"use strict";r.r(t),t.default={"weight-light":"_3-Or1",weightLight:"_3-Or1","weight-normal":"_29Iga",weightNormal:"_29Iga","weight-medium":"_4Jchm",weightMedium:"_4Jchm","weight-semibold":"_391r4",weightSemibold:"_391r4","weight-bold":"jPHDz",weightBold:"jPHDz","size-8":"VLT8j",size8:"VLT8j","size-9":"_4992K",size9:"_4992K","size-10":"_1DyoB",size10:"_1DyoB","size-11":"_3y9sF",size11:"_3y9sF","size-12":"_2KWXe",size12:"_2KWXe","size-13":"qsTJT",size13:"qsTJT","size-14":"_1AJnI",size14:"_1AJnI","size-15":"_3ja-N",size15:"_3ja-N","size-16":"_3EsAO",size16:"_3EsAO","size-17":"rOUL-",size17:"rOUL-","size-18":"u_30I",size18:"u_30I","size-19":"_1TtmI",size19:"_1TtmI","size-20":"_1q4r_",size20:"_1q4r_","size-22":"_18JQV",size22:"_18JQV","size-24":"_1p6Pw",size24:"_1p6Pw","size-26":"_1I9yQ",size26:"_1I9yQ","size-28":"BKJMV",size28:"BKJMV","size-30":"_2NHuO",size30:"_2NHuO","size-32":"_3Q2nA",size32:"_3Q2nA","size-36":"_2Asix",size36:"_2Asix","size-48":"_2VwSE",size48:"_2VwSE","size-60":"_3VzdB",size60:"_3VzdB",title:"_1Kn3o",large:"qpqWq","section-title":"_3weD7",sectionTitle:"_3weD7","section-title-larger":"_3HZiZ",sectionTitleLarger:"_3HZiZ",small:"_201BQ",muted:"_37Hn4","muted-small":"_3iU5s",mutedSmall:"_3iU5s",plain:"_3yN28","popup-title":"_5Z9lA",popupTitle:"_5Z9lA","color-accent":"yeBCZ",colorAccent:"yeBCZ","color-danger":"_2xgD1",colorDanger:"_2xgD1","color-dark":"vCuIB",colorDark:"vCuIB","color-secondary":"cpeB8",colorSecondary:"cpeB8","color-muted":"lXktD",colorMuted:"lXktD","color-success":"_21bUp",colorSuccess:"_21bUp"}},70680:(e,t,r)=>{"use strict";r.r(t),t.default={toast:"AWZA-",right:"_29Ru9",close:"_19Mz6",button:"_2FSIK",btnSuccess:"_1QEPz"}},89778:(e,t,r)=>{"use strict";r.r(t),t.default={wrapper:"_3IsEX",slide0:"_5D0tR",slide1:"V4D9s",slide2:"_1NOem",slide3:"QyChF"}},65556:(e,t,r)=>{"use strict";r.r(t),t.default={pending:"_160LO"}},16261:(e,t,r)=>{"use strict";r.r(t),t.default={mask:"_1vPu0"}},17241:(e,t,r)=>{"use strict";r.r(t),t.default={container:"_2sWIa",containerFixed:"_1one0",themeResume:"TZ8aZ",graphic:"_3419W",logo:"_2Pv5M",dots:"_1eMR9",laptop:"_2dUbm",shimmering:"vQA16","shimmer-ltr":"_3M73Q",shimmerLtr:"_3M73Q","shimmer-rtl":"_1wVsi",shimmerRtl:"_1wVsi",initialLoad:"_1F05l",organizing:"k_UuR",progress:"_15P0N",main:"_2ISCK",secondary:"_1azin",warning:"_1wYCT",showWarning:"_2_alf",dot:"_28y4i"}},71291:(e,t,r)=>{"use strict";r.r(t),t.default={background:"_2oJcB",mainWrapper:"_2Da41",logoutTitle:"_15Ayf"}},87564:(e,t,r)=>{"use strict";r.r(t),t.default={backdrop:"_1814Z",popupContainer:"_1gmLA",popup:"_3NCh_",popupBody:"_3B-ht",popupTitle:"_1ENRV",backdropCover:"_3Ku9S",popupContents:"_3SRfO",popupBox:"_2LViW",popupFlex:"_3wAow",popupAuto:"_2ekDq",popupControls:"_1uJw_",popupFlexInvite:"_2ty1W",popupTower:"_1MNyt",popupGuide:"_3pCPi"}},16656:(e,t,r)=>{"use strict";r.r(t),t.default={action:"_3NY9P",textTip:"_3NYCH",divider:"_38rGi"}},42803:(e,t,r)=>{"use strict";r.r(t),t.default={textTip:"_1H__B",divider:"_35dIr",progress:"kAnmj",logoutBtn:"T9kOL"}},50664:(e,t,r)=>{"use strict";r.r(t),t.default={focusAnimation:"_2N0S3",focusAnimationKeyframes:"_13Lpl"}},77012:(e,t,r)=>{"use strict";function a(){return new Worker(r.p+"milan.50c8f1c48c7ca7b5e01b.worker.js")}r.r(t),r.d(t,{default:()=>a})},79034:(e,t,r)=>{"use strict";function a(){return new Worker(r.p+"index.be63365bc04d9c6ad5b7.worker.js")}r.r(t),r.d(t,{default:()=>a})},64957:(e,t,r)=>{"use strict";function a(){return new Worker(r.p+"opus.fb9ff9597f98345adf05.worker.js")}r.r(t),r.d(t,{default:()=>a})},80967:(e,t,r)=>{"use strict";function a(){return new Worker(r.p+"webp_to_rgba.worker.4ba00e67e4034206534d.worker.js")}r.r(t),r.d(t,{default:()=>a})}},__webpack_module_cache__={},leafPrototypes,getProto,inProgress,dataWebpackPrefix;function __webpack_require__(e){if(__webpack_module_cache__[e])return __webpack_module_cache__[e].exports;var t=__webpack_module_cache__[e]={id:e,loaded:!1,exports:{}};return __webpack_modules__[e].call(t.exports,t,t.exports,__webpack_require__),t.loaded=!0,t.exports}__webpack_require__.m=__webpack_modules__,__webpack_require__.x=e=>{},__webpack_require__.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return __webpack_require__.d(t,{a:t}),t},getProto=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,__webpack_require__.t=function(e,t){if(1&t&&(e=this(e)),8&t)return e;if("object"==typeof e&&e){if(4&t&&e.__esModule)return e;if(16&t&&"function"==typeof e.then)return e}var r=Object.create(null);__webpack_require__.r(r);var a={};leafPrototypes=leafPrototypes||[null,getProto({}),getProto([]),getProto(getProto)];for(var n=2&t&&e;"object"==typeof n&&!~leafPrototypes.indexOf(n);n=getProto(n))Object.getOwnPropertyNames(n).forEach((function(t){a[t]=function(){return e[t]}}));return a.default=function(){return e},__webpack_require__.d(r,a),r},__webpack_require__.d=(e,t)=>{for(var r in t)__webpack_require__.o(t,r)&&!__webpack_require__.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},__webpack_require__.f={},__webpack_require__.e=e=>Promise.all(Object.keys(__webpack_require__.f).reduce(((t,r)=>(__webpack_require__.f[r](e,t),t)),[])),__webpack_require__.u=e=>(({155:"locales/kn",165:"locales/cs",248:"locales/tr",275:"lazy_loaded_low_priority_components",319:"moment_locales/nl",673:"locales/es",792:"locales/et",820:"locales/ko",906:"locales/uk",907:"locales/fil",1055:"moment_locales/el",1069:"moment_locales/sv",1081:"locales/zh-HK",1204:"locales/el",1248:"locales/mr",1381:"moment_locales/hr",1473:"moment_locales/ar",1520:"moment_locales/ms-MY",1529:"locales/lt",1628:"locales/da",1702:"vendors~lazy_loaded_low_priority_components",1770:"locales/sk",1791:"moment_locales/es",2017:"moment_locales/sw",2023:"moment_locales/cs",2091:"locales/pt-BR",2101:"vendors~bootstrap_main",2135:"locales/th",2144:"locales/pt~locales/pt-BR",2394:"moment_locales/es-DO",2445:"moment_locales/fr",2556:"locales/hu",2739:"locales/ta",2830:"locales/it",2944:"locales/sv",2957:"moment_locales/ru",2966:"moment_locales/ar-MA",2974:"vendors~pdf",2979:"moment_locales/en-IE",3017:"moment_locales/uz",3047:"moment_locales/zh-CN",3113:"moment_locales/ml",3370:"moment_locales/te",3422:"moment_locales/mr",3501:"moment_locales/sl",3569:"moment_locales/ro",3722:"locales/hi",3748:"moment_locales/af",3892:"moment_locales/en-NZ",3934:"moment_locales/ar-XB",3998:"locales/sw",4259:"locales/sl",4339:"moment_locales/hu",4361:"locales/ur",4473:"moment_locales/et",4616:"moment_locales/en-CA",4708:"locales/lv",4818:"moment_locales/ko",4873:"locales/uz",4980:"moment_locales/pl",5027:"moment_locales/he",5125:"moment_locales/zh-TW",5128:"locales/id",5170:"moment_locales/sr",5182:"locales/ja",5247:"moment_locales/it",5443:"locales/ms",5512:"svg",5632:"locales/ca",5650:"locales/te",5671:"moment_locales/ar-LY",5708:"locales/hr",5729:"locales/he",5740:"moment_locales/az",5790:"moment_locales/sr-CYRL",5862:"moment_locales/de",5959:"moment_locales/nb",6038:"locales/gu",6110:"vendors~unorm",6163:"moment_locales/ur",6282:"moment_locales/ar-KW",6293:"locales/fr",6331:"locales/sr",6365:"locales/af",6483:"locales/zh-CN",6496:"moment_locales/sq",6511:"moment_locales/id",6547:"moment_locales/pt-BR",6568:"moment_locales/kn",6651:"locales/mk",6655:"locales/ml",6709:"moment_locales/hi",6884:"moment_locales/ar-DZ",6920:"moment_locales/lt",6933:"locales/en",6953:"locales/pt",7072:"locales/az",7074:"moment_locales/kk",7102:"locales/bg",7162:"locales/ro",7205:"lazy_loaded_high_priority_components",7216:"locales/de",7315:"moment_locales/da",7386:"moment_locales/fi",7542:"locales/zh-TW",7662:"moment_locales/fa",7728:"moment_locales/bn",7739:"moment_locales/ms",7749:"locales/nb",7964:"bootstrap_main",8054:"locales/ar",8117:"moment_locales/uz-LATN",8132:"moment_locales/pa-IN",8292:"locales/ru",8295:"vendors~lazy_loaded_high_priority_components~lazy_loaded_low_priority_components",8598:"locales/vi",8628:"locales/pl",8634:"moment_locales/ta",8678:"moment_locales/en-AU",8700:"locales/bn",8799:"moment_locales/fr-CH",9116:"moment_locales/pt",9227:"moment_locales/en-GB",9289:"moment_locales/ar-TN",9313:"moment_locales/tr",9488:"lazy_loaded_high_priority_components~lazy_loaded_low_priority_components",9545:"moment_locales/mk",9613:"locales/fi",9646:"moment_locales/ar-SA",9682:"moment_locales/uk",9719:"locales/kk",9737:"locales/sq",9750:"locales/nl",9765:"moment_locales/fr-CA",9815:"locales/pa",9817:"moment_locales/ca",9995:"locales/ar-XB",9999:"locales/fa"}[e]||e)+"."+{155:"4d2093f500470aa79ef5",165:"e358029d7ce54ccdc798",248:"e387971a094e0f55c8d1",275:"bd21dfe97a983e0dfd95",319:"176bf2ead6e808088d1b",495:"7044fe6a5d405d83dda0",673:"5bd9b9ef3c0356db9bea",792:"a34d2112b2161b0bb9ee",820:"49e491e1d41999d2b387",906:"81739b1899c00bc5b91e",907:"c688d0b7e9d0abfeed8b",1055:"68ea62648893d5920f9f",1069:"9b4e09477c1f8554f625",1081:"63934da2a5dd76a9e414",1204:"837ae3f9058bc439ba8e",1248:"6d2f8acb5135505828f7",1381:"07ccfaa757bb1fbee3bf",1473:"b66567b2832ab705b021",1520:"ff9dc20fd3444e873de8",1529:"43a9a5c70d27f8f10eeb",1628:"8101e80a52e057b69097",1702:"3778c1c55bf7c5f5fd45",1770:"2112bb21ab69420a4abc",1791:"31152916dd67899e3b97",2017:"44f99860e27545c90025",2023:"a750192eb3bfc6ee3409",2091:"b9b9d0198b7b54283386",2101:"f7b925c8137d1fabecdb",2135:"6e0ceb14fc7883c09cf7",2144:"07103397c29e9aea7907",2394:"88071ac52fb2adc6b1ed",2445:"ff32280ccd5a3782d10c",2556:"7068928231c505753eb4",2739:"520c583f48a992728a70",2830:"d8c8d2fd24cd739644c4",2944:"6cf64da91c33b8af1cc2",2957:"c958f84e8bb93696e620",2966:"31a4283fb22466aebf8a",2974:"8190509a7c5c75ae57d7",2979:"1be5e24dbbb29a941d86",3017:"9c8a30810e172ef18a24",3047:"f6453b60307ca74005dc",3113:"e2ab7f47bc2a89af72ef",3370:"9fb4996210cfc0ce41fb",3422:"53baa6b57656db34ff4a",3501:"6b87236a32d641ed74ad",3569:"c15198aa075b4a257c01",3722:"aae7c569c679af81eff6",3748:"51964f1df9526a9f8170",3892:"7837e01e74d0a7467c18",3934:"925433e4fac26bac6e06",3998:"6b406dcc97155e8b4524",4259:"79a8a4693739bd17c8e1",4339:"82d07fdad6516f07df36",4361:"1d1e7d2be36a377dca5d",4473:"4874cf004acb657ccbe0",4553:"f65f7123ca2cbb681cfd",4616:"8fd39ed778103c44b00a",4708:"c6d55bfda1e859bcf741",4818:"dd27678a091e9af68ec1",4873:"223fd64aa766b7409142",4980:"21fd9e14f61c78673f72",5027:"adae0dbb0dcc21af4b18",5125:"1c2b01fddc1d51d7a54a",5128:"6f99d1b93548bcd587e2",5170:"eae7c16db3bd90a55336",5182:"b746067b0ed850c2972a",5247:"acae8cf2656ef47419e6",5443:"a05164e5550181346d1d",5512:"3dd3d8d97e5a595ffa71",5632:"ae61287785862f35f94e",5650:"e68133e91ef25e228917",5671:"f7fb6aeeaefb573f25cd",5708:"9d482fe8363af0b75e12",5729:"4253b80e094dda33426d",5740:"76ac04513c73b67ea2d2",5790:"4c9f33d779c795d3f9fc",5862:"f8ca46b171e5c84d0242",5959:"4bc5009f128f9407a120",6038:"4e2e845384433a10945c",6110:"fda875c14206939717ad",6163:"b3541b0df539ae7fc331",6282:"01147fbfde320085f831",6293:"a9a6009e37d77a3f3c5a",6331:"c33358d082db8e1515c2",6365:"d66b3361948571505b72",6483:"5cf839ea964563cc0940",6496:"a2ac56e3ac7acf07e822",6511:"2d2fec7161e18d1843fa",6547:"6ecee0e93fe24308d93c",6568:"1003152c4d91f170b7c6",6651:"7c6749808b07803f5f3e",6655:"758765d7234936e9864b",6709:"670a332f3d7fb42c746a",6884:"54edf8e4e4aa7891857e",6920:"60be0cd92a1ae64974a8",6933:"fbb2b50f3de094b1ed93",6953:"a42c1e7138828e4ded60",7072:"78ffa4afbfbac3e15677",7074:"7e1f33d3cc5cdf2690e1",7102:"4103036cb7af330e5ca7",7162:"f3756c1bb5b77849fc52",7205:"2e0c8d3f1a0a6b897c3c",7216:"957042b11e1e40b95e69",7315:"ff196d6c645bc8ad51c1",7386:"902c3ffdd549bf999106",7542:"0a9c1e2a4edd8c6bd795",7662:"5133e432014d344ed87d",7728:"8670249acd34e0031667",7739:"f8f020b2df8ddeebb2f4",7749:"7d3f1d965e40c24c0eea",7964:"61ccbd302106e7080867",8054:"ac07f98526f2c6b05c20",8117:"144d8c8392c71e185566",8132:"f21c0dc65251602b6d0e",8292:"431d3606c547c86482cf",8295:"0d95f3cee944da5fc9ac",8598:"f61d4df71628ce8f98dd",8628:"34755814763bf8d80cc9",8634:"0aba3fe1613085e7ce0f",8678:"db4f1173ee3e13f2a3b0",8700:"35779fc9cbc3350463fd",8799:"710d7612e41f0be32e9c",9116:"05f97be1fbab5ae0d5fc",9227:"0986af5de6e4cb60c945",9289:"a30cf128d729f8de12ea",9313:"f82fc1957f9f2e8b0c56",9488:"e4606286782bafae4f77",9545:"5f543d9a3bcd4ef81a37",9613:"292f5beede4f9335b70b",9646:"210b53f6788cafc907c9",9682:"1fcc003e1056fbee5c06",9719:"71824f1fefd6914a7c08",9737:"7d1e6eb80553304d4b8c",9750:"0c9854e6133650ab01e9",9765:"fc79505ed07e1afb02a6",9815:"c75a96c2eabe3db66173",9817:"87d93ce64f807db21605",9970:"ed88fa6b46c63aa5bd59",9995:"c45d1a0f1d86f05ba510",9999:"44c258896af7bf5e6e57"}[e]+".js"),__webpack_require__.miniCssF=e=>({275:"lazy_loaded_low_priority_components",7205:"lazy_loaded_high_priority_components",7964:"bootstrap_main",9488:"lazy_loaded_high_priority_components~lazy_loaded_low_priority_components"}[e]+"."+{275:"2a4b00c927c34b71c336",7205:"14702ae184b96824e0b2",7964:"7d54142917c77e74be3c",9488:"cb1a266eb145b745e796"}[e]+".css"),__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),__webpack_require__.hmd=e=>((e=Object.create(e)).children||(e.children=[]),Object.defineProperty(e,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+e.id)}}),e),__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),inProgress={},dataWebpackPrefix="build:",__webpack_require__.l=(e,t,r,a)=>{if(inProgress[e])inProgress[e].push(t);else{var n,i;if(void 0!==r)for(var s=document.getElementsByTagName("script"),o=0;o<s.length;o++){var u=s[o];if(u.getAttribute("src")==e||u.getAttribute("data-webpack")==dataWebpackPrefix+r){n=u;break}}n||(i=!0,(n=document.createElement("script")).charset="utf-8",n.timeout=120,__webpack_require__.nc&&n.setAttribute("nonce",__webpack_require__.nc),n.setAttribute("data-webpack",dataWebpackPrefix+r),n.src=e),inProgress[e]=[t];var l=(t,r)=>{n.onerror=n.onload=null,clearTimeout(d);var a=inProgress[e];if(delete inProgress[e],n.parentNode&&n.parentNode.removeChild(n),a&&a.forEach((e=>e(r))),t)return t(r)},d=setTimeout(l.bind(null,void 0,{type:"timeout",target:n}),12e4);n.onerror=l.bind(null,n.onerror),n.onload=l.bind(null,n.onload),i&&document.head.appendChild(n)}},__webpack_require__.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},__webpack_require__.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),__webpack_require__.p="/";var oldGetScript=__webpack_require__.u,oldLoadScript=__webpack_require__.e,queryMap=new Map,countMap=new Map,maxRetries=5,loadStylesheet,installedCssChunks;__webpack_require__.u=function(e){return oldGetScript(e)+(queryMap.has(e)?"?"+queryMap.get(e):"")},__webpack_require__.e=function(e){return oldLoadScript(e).catch((function(t){var r=countMap.has(e)?countMap.get(e):5;if(r<1){var a=oldGetScript(e);throw t.message="Loading chunk "+e+" failed after 5 retries.\n("+a+")",t.request=a,t}var n="cache-bust=true"+("&retry-attempt="+(5-r+1));return queryMap.set(e,n),countMap.set(e,r-1),__webpack_require__.e(e)}))},loadStylesheet=e=>new Promise(((t,r)=>{var a=__webpack_require__.miniCssF(e),n=__webpack_require__.p+a;if(((e,t)=>{for(var r=document.getElementsByTagName("link"),a=0;a<r.length;a++){var n=(s=r[a]).getAttribute("data-href")||s.getAttribute("href");if("stylesheet"===s.rel&&(n===e||n===t))return s}var i=document.getElementsByTagName("style");for(a=0;a<i.length;a++){var s;if((n=(s=i[a]).getAttribute("data-href"))===e||n===t)return s}})(a,n))return t();((e,t,r,a)=>{var n=document.createElement("link");n.rel="stylesheet",n.type="text/css",n.onerror=n.onload=i=>{if(n.onerror=n.onload=null,"load"===i.type)r();else{var s=i&&("load"===i.type?"missing":i.type),o=i&&i.target&&i.target.href||t,u=new Error("Loading CSS chunk "+e+" failed.\n("+o+")");u.code="CSS_CHUNK_LOAD_FAILED",u.type=s,u.request=o,n.parentNode.removeChild(n),a(u)}},n.href=t,document.head.appendChild(n)})(e,n,t,r)})),installedCssChunks={9209:0},__webpack_require__.f.miniCss=(e,t)=>{installedCssChunks[e]?t.push(installedCssChunks[e]):0!==installedCssChunks[e]&&{275:1,7205:1,7964:1,9488:1}[e]&&t.push(installedCssChunks[e]=loadStylesheet(e).then((()=>{installedCssChunks[e]=0}),(t=>{throw delete installedCssChunks[e],t})))},(()=>{var e={9209:0},t=[[96838,1174]];__webpack_require__.f.j=(t,r)=>{var a=__webpack_require__.o(e,t)?e[t]:void 0;if(0!==a)if(a)r.push(a[2]);else{var n=new Promise(((r,n)=>{a=e[t]=[r,n]}));r.push(a[2]=n);var i=__webpack_require__.p+__webpack_require__.u(t),s=new Error;__webpack_require__.l(i,(r=>{if(__webpack_require__.o(e,t)&&(0!==(a=e[t])&&(e[t]=void 0),a)){var n=r&&("load"===r.type?"missing":r.type),i=r&&r.target&&r.target.src;s.message="Loading chunk "+t+" failed.\n("+n+": "+i+")",s.name="ChunkLoadError",s.type=n,s.request=i,a[1](s)}}),"chunk-"+t,t)}};var r=e=>{},a=(a,n)=>{for(var i,s,[o,u,l,d]=n,c=0,f=[];c<o.length;c++)s=o[c],__webpack_require__.o(e,s)&&e[s]&&f.push(e[s][0]),e[s]=0;for(i in u)__webpack_require__.o(u,i)&&(__webpack_require__.m[i]=u[i]);for(l&&l(__webpack_require__),a&&a(n);f.length;)f.shift()();return d&&t.push.apply(t,d),r()},n=self.webpackChunkbuild=self.webpackChunkbuild||[];function i(){for(var r,a=0;a<t.length;a++){for(var n=t[a],i=!0,s=1;s<n.length;s++){var o=n[s];0!==e[o]&&(i=!1)}i&&(t.splice(a--,1),r=__webpack_require__(__webpack_require__.s=n[0]))}return 0===t.length&&(__webpack_require__.x(),__webpack_require__.x=e=>{}),r}n.forEach(a.bind(null,0)),n.push=a.bind(null,n.push.bind(n));var s=__webpack_require__.x;__webpack_require__.x=()=>(__webpack_require__.x=s||(e=>{}),(r=i)())})(),__webpack_require__.x()})();