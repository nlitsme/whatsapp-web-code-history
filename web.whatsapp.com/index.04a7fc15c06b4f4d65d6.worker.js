/*! Copyright (c) 2021 WhatsApp Inc. All Rights Reserved. */(()=>{var e={8103:e=>{"use strict";var t=Object.prototype.hasOwnProperty,n="function"==typeof WeakMap?new WeakMap:new Map;function r(e){var t=n.get(e);if(void 0!==t)return t;var r=Object.getOwnPropertyNames(e),a=new Set(r.map((t=>e[t])));return n.set(e,a),a}var a=Object.freeze(Object.defineProperties(Object.create(null),{isValid:{value:function(e){return r(this).has(e)}},cast:{value:function(e){return this.isValid(e)?e:void 0}},members:{value:function(){return r(this).values()}}}));function o(e){var n=Object.create(a);for(var r in e)t.call(e,r)&&Object.defineProperty(n,r,{value:e[r]});return Object.freeze(n)}var i=Object.freeze(Object.defineProperties(Object.create(null),{isValid:{value:function(e){return"string"==typeof e&&t.call(this,e)}},cast:{value:a.cast},members:{value:function(){return Object.getOwnPropertyNames(this)}}}));o.Mirrored=function(e){for(var t=Object.create(i),n=0,r=e.length;n<r;++n)Object.defineProperty(t,e[n],{value:e[n]});return Object.freeze(t)},Object.freeze(o.Mirrored),e.exports=Object.freeze(o)},2954:e=>{function t(e,t,n,r,a,o,i){try{var u=e[o](i),s=u.value}catch(e){return void n(e)}u.done?t(s):Promise.resolve(s).then(r,a)}e.exports=function(e){return function(){var n=this,r=arguments;return new Promise((function(a,o){var i=e.apply(n,r);function u(e){t(i,a,o,u,s,"next",e)}function s(e){t(i,a,o,u,s,"throw",e)}u(void 0)}))}}},1260:e=>{e.exports=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}},4859:e=>{e.exports=function(e){return e&&e.__esModule?e:{default:e}}},3291:(e,t,n)=>{var r=n(8921);function a(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return a=function(){return e},e}e.exports=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==r(e)&&"function"!=typeof e)return{default:e};var t=a();if(t&&t.has(e))return t.get(e);var n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var u=o?Object.getOwnPropertyDescriptor(e,i):null;u&&(u.get||u.set)?Object.defineProperty(n,i,u):n[i]=e[i]}return n.default=e,t&&t.set(e,n),n}},417:(e,t,n)=>{var r=n(1260);function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}e.exports=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}},9976:e=>{e.exports=function(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}},8921:e=>{function t(n){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?e.exports=t=function(e){return typeof e}:e.exports=t=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t(n)}e.exports=t},5363:(e,t,n)=>{"use strict";n.r(t),n.d(t,{Dexie:()=>Yn});var r=function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};function a(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),a=0;for(t=0;t<n;t++)for(var o=arguments[t],i=0,u=o.length;i<u;i++,a++)r[a]=o[i];return r}var o=Object.keys,i=Array.isArray,u="undefined"!=typeof self?self:"undefined"!=typeof window?window:global;function s(e,t){return"object"!=typeof t||o(t).forEach((function(n){e[n]=t[n]})),e}"undefined"==typeof Promise||u.Promise||(u.Promise=Promise);var l=Object.getPrototypeOf,c={}.hasOwnProperty;function f(e,t){return c.call(e,t)}function d(e,t){"function"==typeof t&&(t=t(l(e))),o(t).forEach((function(n){p(e,n,t[n])}))}var h=Object.defineProperty;function p(e,t,n,r){h(e,t,s(n&&f(n,"get")&&"function"==typeof n.get?{get:n.get,set:n.set,configurable:!0}:{value:n,configurable:!0,writable:!0},r))}function v(e){return{from:function(t){return e.prototype=Object.create(t.prototype),p(e.prototype,"constructor",e),{extend:d.bind(null,e.prototype)}}}}var m=Object.getOwnPropertyDescriptor;function y(e,t){var n;return m(e,t)||(n=l(e))&&y(n,t)}var _=[].slice;function g(e,t,n){return _.call(e,t,n)}function b(e,t){return t(e)}function w(e){if(!e)throw new Error("Assertion Failed")}function E(e){u.setImmediate?setImmediate(e):setTimeout(e,0)}function O(e,t){return e.reduce((function(e,n,r){var a=t(n,r);return a&&(e[a[0]]=a[1]),e}),{})}function P(e,t){if(f(e,t))return e[t];if(!t)return e;if("string"!=typeof t){for(var n=[],r=0,a=t.length;r<a;++r){var o=P(e,t[r]);n.push(o)}return n}var i=t.indexOf(".");if(-1!==i){var u=e[t.substr(0,i)];return void 0===u?void 0:P(u,t.substr(i+1))}}function S(e,t,n){if(e&&void 0!==t&&(!("isFrozen"in Object)||!Object.isFrozen(e)))if("string"!=typeof t&&"length"in t){w("string"!=typeof n&&"length"in n);for(var r=0,a=t.length;r<a;++r)S(e,t[r],n[r])}else{var o=t.indexOf(".");if(-1!==o){var u=t.substr(0,o),s=t.substr(o+1);if(""===s)void 0===n?i(e)&&!isNaN(parseInt(u))?e.splice(u,1):delete e[u]:e[u]=n;else{var l=e[u];l||(l=e[u]={}),S(l,s,n)}}else void 0===n?i(e)&&!isNaN(parseInt(t))?e.splice(t,1):delete e[t]:e[t]=n}}function x(e,t){"string"==typeof t?S(e,t,void 0):"length"in t&&[].map.call(t,(function(t){S(e,t,void 0)}))}function C(e){var t={};for(var n in e)f(e,n)&&(t[n]=e[n]);return t}var I=[].concat;function A(e){return I.apply([],e)}var k="Boolean,String,Date,RegExp,Blob,File,FileList,ArrayBuffer,DataView,Uint8ClampedArray,ImageData,Map,Set".split(",").concat(A([8,16,32,64].map((function(e){return["Int","Uint","Float"].map((function(t){return t+e+"Array"}))})))).filter((function(e){return u[e]})),T=k.map((function(e){return u[e]})),M=O(k,(function(e){return[e,!0]}));function R(e){if(!e||"object"!=typeof e)return e;var t;if(i(e)){t=[];for(var n=0,r=e.length;n<r;++n)t.push(R(e[n]))}else if(T.indexOf(e.constructor)>=0)t=e;else for(var a in t=e.constructor?Object.create(e.constructor.prototype):{},e)f(e,a)&&(t[a]=R(e[a]));return t}var j={}.toString;function D(e){return j.call(e).slice(8,-1)}var N=function(e,t){return"Array"===t?""+e.map((function(e){return N(e,D(e))})):"ArrayBuffer"===t?""+new Uint8Array(e):"Date"===t?e.getTime():ArrayBuffer.isView(e)?""+new Uint8Array(e.buffer):e};function K(e,t,n,r){return n=n||{},r=r||"",o(e).forEach((function(a){if(f(t,a)){var o=e[a],i=t[a];if("object"==typeof o&&"object"==typeof i&&o&&i){var u=D(o),s=D(i);u===s?M[u]?N(o,u)!==N(i,s)&&(n[r+a]=t[a]):K(o,i,n,r+a+"."):n[r+a]=t[a]}else o!==i&&(n[r+a]=t[a])}else n[r+a]=void 0})),o(t).forEach((function(a){f(e,a)||(n[r+a]=t[a])})),n}var F="undefined"!=typeof Symbol&&Symbol.iterator,B=F?function(e){var t;return null!=e&&(t=e[F])&&t.apply(e)}:function(){return null},Y={};function L(e){var t,n,r,a;if(1===arguments.length){if(i(e))return e.slice();if(this===Y&&"string"==typeof e)return[e];if(a=B(e)){for(n=[];!(r=a.next()).done;)n.push(r.value);return n}if(null==e)return[e];if("number"==typeof(t=e.length)){for(n=new Array(t);t--;)n[t]=e[t];return n}return[e]}for(t=arguments.length,n=new Array(t);t--;)n[t]=arguments[t];return n}var U="undefined"!=typeof Symbol?function(e){return"AsyncFunction"===e[Symbol.toStringTag]}:function(){return!1},q="undefined"!=typeof location&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function V(e,t){q=e,z=t}var z=function(){return!0},W=!new Error("").stack;function G(){if(W)try{throw new Error}catch(e){return e}return new Error}function X(e,t){var n=e.stack;return n?(t=t||0,0===n.indexOf(e.name)&&(t+=(e.name+e.message).split("\n").length),n.split("\n").slice(t).filter(z).map((function(e){return"\n"+e})).join("")):""}var H=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],Q=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(H),J={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed"};function Z(e,t){this._e=G(),this.name=e,this.message=t}function $(e,t){return e+". Errors: "+Object.keys(t).map((function(e){return t[e].toString()})).filter((function(e,t,n){return n.indexOf(e)===t})).join("\n")}function ee(e,t,n,r){this._e=G(),this.failures=t,this.failedKeys=r,this.successCount=n,this.message=$(e,t)}function te(e,t){this._e=G(),this.name="BulkError",this.failures=t,this.message=$(e,t)}v(Z).from(Error).extend({stack:{get:function(){return this._stack||(this._stack=this.name+": "+this.message+X(this._e,2))}},toString:function(){return this.name+": "+this.message}}),v(ee).from(Z),v(te).from(Z);var ne=Q.reduce((function(e,t){return e[t]=t+"Error",e}),{}),re=Z,ae=Q.reduce((function(e,t){var n=t+"Error";function r(e,r){this._e=G(),this.name=n,e?"string"==typeof e?(this.message=e+(r?"\n "+r:""),this.inner=r||null):"object"==typeof e&&(this.message=e.name+" "+e.message,this.inner=e):(this.message=J[t]||n,this.inner=null)}return v(r).from(re),e[t]=r,e}),{});ae.Syntax=SyntaxError,ae.Type=TypeError,ae.Range=RangeError;var oe=H.reduce((function(e,t){return e[t+"Error"]=ae[t],e}),{});var ie=Q.reduce((function(e,t){return-1===["Syntax","Type","Range"].indexOf(t)&&(e[t+"Error"]=ae[t]),e}),{});function ue(){}function se(e){return e}function le(e,t){return null==e||e===se?t:function(n){return t(e(n))}}function ce(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}function fe(e,t){return e===ue?t:function(){var n=e.apply(this,arguments);void 0!==n&&(arguments[0]=n);var r=this.onsuccess,a=this.onerror;this.onsuccess=null,this.onerror=null;var o=t.apply(this,arguments);return r&&(this.onsuccess=this.onsuccess?ce(r,this.onsuccess):r),a&&(this.onerror=this.onerror?ce(a,this.onerror):a),void 0!==o?o:n}}function de(e,t){return e===ue?t:function(){e.apply(this,arguments);var n=this.onsuccess,r=this.onerror;this.onsuccess=this.onerror=null,t.apply(this,arguments),n&&(this.onsuccess=this.onsuccess?ce(n,this.onsuccess):n),r&&(this.onerror=this.onerror?ce(r,this.onerror):r)}}function he(e,t){return e===ue?t:function(n){var r=e.apply(this,arguments);s(n,r);var a=this.onsuccess,o=this.onerror;this.onsuccess=null,this.onerror=null;var i=t.apply(this,arguments);return a&&(this.onsuccess=this.onsuccess?ce(a,this.onsuccess):a),o&&(this.onerror=this.onerror?ce(o,this.onerror):o),void 0===r?void 0===i?void 0:i:s(r,i)}}function pe(e,t){return e===ue?t:function(){return!1!==t.apply(this,arguments)&&e.apply(this,arguments)}}function ve(e,t){return e===ue?t:function(){var n=e.apply(this,arguments);if(n&&"function"==typeof n.then){for(var r=this,a=arguments.length,o=new Array(a);a--;)o[a]=arguments[a];return n.then((function(){return t.apply(r,o)}))}return t.apply(this,arguments)}}ie.ModifyError=ee,ie.DexieError=Z,ie.BulkError=te;var me={},ye="undefined"==typeof Promise?[]:function(){var e=Promise.resolve();if("undefined"==typeof crypto||!crypto.subtle)return[e,e.__proto__,e];var t=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[t,t.__proto__,e]}(),_e=ye[0],ge=ye[1],be=ye[2],we=ge&&ge.then,Ee=_e&&_e.constructor,Oe=!!be,Pe=!1,Se=be?function(){be.then(Xe)}:u.setImmediate?setImmediate.bind(null,Xe):u.MutationObserver?function(){var e=document.createElement("div");new MutationObserver((function(){Xe(),e=null})).observe(e,{attributes:!0}),e.setAttribute("i","1")}:function(){setTimeout(Xe,0)},xe=function(e,t){De.push([e,t]),Ie&&(Se(),Ie=!1)},Ce=!0,Ie=!0,Ae=[],ke=[],Te=null,Me=se,Re={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:gt,pgp:!1,env:{},finalize:function(){this.unhandleds.forEach((function(e){try{gt(e[0],e[1])}catch(e){}}))}},je=Re,De=[],Ne=0,Ke=[];function Fe(e){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");this._listeners=[],this.onuncatched=ue,this._lib=!1;var t=this._PSD=je;if(q&&(this._stackHolder=G(),this._prev=null,this._numPrev=0),"function"!=typeof e){if(e!==me)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(!1===this._state&&Ue(this,this._value))}this._state=null,this._value=null,++t.ref,Le(this,e)}var Be={get:function(){var e=je,t=at;function n(n,r){var a=this,o=!e.global&&(e!==je||t!==at),i=o&&!st(),u=new Fe((function(t,u){Ve(a,new Ye(mt(n,e,o,i),mt(r,e,o,i),t,u,e))}));return q&&Ge(u,this),u}return n.prototype=me,n},set:function(e){p(this,"then",e&&e.prototype===me?Be:{get:function(){return e},set:Be.set})}};function Ye(e,t,n,r,a){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.resolve=n,this.reject=r,this.psd=a}function Le(e,t){try{t((function(t){if(null===e._state){if(t===e)throw new TypeError("A promise cannot be resolved with itself.");var n=e._lib&&He();t&&"function"==typeof t.then?Le(e,(function(e,n){t instanceof Fe?t._then(e,n):t.then(e,n)})):(e._state=!0,e._value=t,qe(e)),n&&Qe()}}),Ue.bind(null,e))}catch(t){Ue(e,t)}}function Ue(e,t){if(ke.push(t),null===e._state){var n=e._lib&&He();t=Me(t),e._state=!1,e._value=t,q&&null!==t&&"object"==typeof t&&!t._promise&&function(e,t,n){try{e.apply(null,n)}catch(e){t&&t(e)}}((function(){var n=y(t,"stack");t._promise=e,p(t,"stack",{get:function(){return Pe?n&&(n.get?n.get.apply(t):n.value):e.stack}})})),function(e){Ae.some((function(t){return t._value===e._value}))||Ae.push(e)}(e),qe(e),n&&Qe()}}function qe(e){var t=e._listeners;e._listeners=[];for(var n=0,r=t.length;n<r;++n)Ve(e,t[n]);var a=e._PSD;--a.ref||a.finalize(),0===Ne&&(++Ne,xe((function(){0==--Ne&&Je()}),[]))}function Ve(e,t){if(null!==e._state){var n=e._state?t.onFulfilled:t.onRejected;if(null===n)return(e._state?t.resolve:t.reject)(e._value);++t.psd.ref,++Ne,xe(ze,[n,e,t])}else e._listeners.push(t)}function ze(e,t,n){try{Te=t;var r,a=t._value;t._state?r=e(a):(ke.length&&(ke=[]),r=e(a),-1===ke.indexOf(a)&&function(e){var t=Ae.length;for(;t;)if(Ae[--t]._value===e._value)return void Ae.splice(t,1)}(t)),n.resolve(r)}catch(e){n.reject(e)}finally{Te=null,0==--Ne&&Je(),--n.psd.ref||n.psd.finalize()}}function We(e,t,n){if(t.length===n)return t;var r="";if(!1===e._state){var a,o,i=e._value;null!=i?(a=i.name||"Error",o=i.message||i,r=X(i,0)):(a=i,o=""),t.push(a+(o?": "+o:"")+r)}return q&&((r=X(e._stackHolder,2))&&-1===t.indexOf(r)&&t.push(r),e._prev&&We(e._prev,t,n)),t}function Ge(e,t){var n=t?t._numPrev+1:0;n<100&&(e._prev=t,e._numPrev=n)}function Xe(){He()&&Qe()}function He(){var e=Ce;return Ce=!1,Ie=!1,e}function Qe(){var e,t,n;do{for(;De.length>0;)for(e=De,De=[],n=e.length,t=0;t<n;++t){var r=e[t];r[0].apply(null,r[1])}}while(De.length>0);Ce=!0,Ie=!0}function Je(){var e=Ae;Ae=[],e.forEach((function(e){e._PSD.onunhandled.call(null,e._value,e)}));for(var t=Ke.slice(0),n=t.length;n;)t[--n]()}function Ze(e){return new Fe(me,!1,e)}function $e(e,t){var n=je;return function(){var r=He(),a=je;try{return dt(n,!0),e.apply(this,arguments)}catch(e){t&&t(e)}finally{dt(a,!1),r&&Qe()}}}d(Fe.prototype,{then:Be,_then:function(e,t){Ve(this,new Ye(null,null,e,t,je))},catch:function(e){if(1===arguments.length)return this.then(null,e);var t=arguments[0],n=arguments[1];return"function"==typeof t?this.then(null,(function(e){return e instanceof t?n(e):Ze(e)})):this.then(null,(function(e){return e&&e.name===t?n(e):Ze(e)}))},finally:function(e){return this.then((function(t){return e(),t}),(function(t){return e(),Ze(t)}))},stack:{get:function(){if(this._stack)return this._stack;try{Pe=!0;var e=We(this,[],20).join("\nFrom previous: ");return null!==this._state&&(this._stack=e),e}finally{Pe=!1}}},timeout:function(e,t){var n=this;return e<1/0?new Fe((function(r,a){var o=setTimeout((function(){return a(new ae.Timeout(t))}),e);n.then(r,a).finally(clearTimeout.bind(null,o))})):this}}),"undefined"!=typeof Symbol&&Symbol.toStringTag&&p(Fe.prototype,Symbol.toStringTag,"Dexie.Promise"),Re.env=ht(),d(Fe,{all:function(){var e=L.apply(null,arguments).map(lt);return new Fe((function(t,n){0===e.length&&t([]);var r=e.length;e.forEach((function(a,o){return Fe.resolve(a).then((function(n){e[o]=n,--r||t(e)}),n)}))}))},resolve:function(e){if(e instanceof Fe)return e;if(e&&"function"==typeof e.then)return new Fe((function(t,n){e.then(t,n)}));var t=new Fe(me,!0,e);return Ge(t,Te),t},reject:Ze,race:function(){var e=L.apply(null,arguments).map(lt);return new Fe((function(t,n){e.map((function(e){return Fe.resolve(e).then(t,n)}))}))},PSD:{get:function(){return je},set:function(e){return je=e}},totalEchoes:{get:function(){return at}},newPSD:it,usePSD:pt,scheduler:{get:function(){return xe},set:function(e){xe=e}},rejectionMapper:{get:function(){return Me},set:function(e){Me=e}},follow:function(e,t){return new Fe((function(n,r){return it((function(t,n){var r=je;r.unhandleds=[],r.onunhandled=n,r.finalize=ce((function(){var e=this;!function(e){function t(){e(),Ke.splice(Ke.indexOf(t),1)}Ke.push(t),++Ne,xe((function(){0==--Ne&&Je()}),[])}((function(){0===e.unhandleds.length?t():n(e.unhandleds[0])}))}),r.finalize),e()}),t,n,r)}))}}),Ee&&(Ee.allSettled&&p(Fe,"allSettled",(function(){var e=L.apply(null,arguments).map(lt);return new Fe((function(t){0===e.length&&t([]);var n=e.length,r=new Array(n);e.forEach((function(e,a){return Fe.resolve(e).then((function(e){return r[a]={status:"fulfilled",value:e}}),(function(e){return r[a]={status:"rejected",reason:e}})).then((function(){return--n||t(r)}))}))}))})),Ee.any&&"undefined"!=typeof AggregateError&&p(Fe,"any",(function(){var e=L.apply(null,arguments).map(lt);return new Fe((function(t,n){0===e.length&&n(new AggregateError([]));var r=e.length,a=new Array(r);e.forEach((function(e,o){return Fe.resolve(e).then((function(e){return t(e)}),(function(e){a[o]=e,--r||n(new AggregateError(a))}))}))}))})));var et={awaits:0,echoes:0,id:0},tt=0,nt=[],rt=0,at=0,ot=0;function it(e,t,n,r){var a=je,o=Object.create(a);o.parent=a,o.ref=0,o.global=!1,o.id=++ot;var i=Re.env;o.env=Oe?{Promise:Fe,PromiseProp:{value:Fe,configurable:!0,writable:!0},all:Fe.all,race:Fe.race,allSettled:Fe.allSettled,any:Fe.any,resolve:Fe.resolve,reject:Fe.reject,nthen:yt(i.nthen,o),gthen:yt(i.gthen,o)}:{},t&&s(o,t),++a.ref,o.finalize=function(){--this.parent.ref||this.parent.finalize()};var u=pt(o,e,n,r);return 0===o.ref&&o.finalize(),u}function ut(){return et.id||(et.id=++tt),++et.awaits,et.echoes+=100,et.id}function st(){return!!et.awaits&&(0==--et.awaits&&(et.id=0),et.echoes=100*et.awaits,!0)}function lt(e){return et.echoes&&e&&e.constructor===Ee?(ut(),e.then((function(e){return st(),e}),(function(e){return st(),bt(e)}))):e}function ct(e){++at,et.echoes&&0!=--et.echoes||(et.echoes=et.id=0),nt.push(je),dt(e,!0)}function ft(){var e=nt[nt.length-1];nt.pop(),dt(e,!1)}function dt(e,t){var n=je;if((t?!et.echoes||rt++&&e===je:!rt||--rt&&e===je)||vt(t?ct.bind(null,e):ft),e!==je&&(je=e,n===Re&&(Re.env=ht()),Oe)){var r=Re.env.Promise,a=e.env;ge.then=a.nthen,r.prototype.then=a.gthen,(n.global||e.global)&&(Object.defineProperty(u,"Promise",a.PromiseProp),r.all=a.all,r.race=a.race,r.resolve=a.resolve,r.reject=a.reject,a.allSettled&&(r.allSettled=a.allSettled),a.any&&(r.any=a.any))}}function ht(){var e=u.Promise;return Oe?{Promise:e,PromiseProp:Object.getOwnPropertyDescriptor(u,"Promise"),all:e.all,race:e.race,allSettled:e.allSettled,any:e.any,resolve:e.resolve,reject:e.reject,nthen:ge.then,gthen:e.prototype.then}:{}}function pt(e,t,n,r,a){var o=je;try{return dt(e,!0),t(n,r,a)}finally{dt(o,!1)}}function vt(e){we.call(_e,e)}function mt(e,t,n,r){return"function"!=typeof e?e:function(){var a=je;n&&ut(),dt(t,!0);try{return e.apply(this,arguments)}finally{dt(a,!1),r&&vt(st)}}}function yt(e,t){return function(n,r){return e.call(this,mt(n,t),mt(r,t))}}-1===(""+we).indexOf("[native code]")&&(ut=st=ue);var _t="unhandledrejection";function gt(e,t){var n;try{n=t.onuncatched(e)}catch(e){}if(!1!==n)try{var r,a={promise:t,reason:e};if(u.document&&document.createEvent?((r=document.createEvent("Event")).initEvent(_t,!0,!0),s(r,a)):u.CustomEvent&&s(r=new CustomEvent(_t,{detail:a}),a),r&&u.dispatchEvent&&(dispatchEvent(r),!u.PromiseRejectionEvent&&u.onunhandledrejection))try{u.onunhandledrejection(r)}catch(e){}q&&r&&!r.defaultPrevented&&console.warn("Unhandled rejection: "+(e.stack||e))}catch(e){}}var bt=Fe.reject;function wt(e,t,n,r){if(e._state.openComplete||je.letThrough){var a=e._createTransaction(t,n,e._dbSchema);try{a.create()}catch(e){return bt(e)}return a._promise(t,(function(e,t){return it((function(){return je.trans=a,r(e,t,a)}))})).then((function(e){return a._completion.then((function(){return e}))}))}if(!e._state.isBeingOpened){if(!e._options.autoOpen)return bt(new ae.DatabaseClosed);e.open().catch(ue)}return e._state.dbReadyPromise.then((function(){return wt(e,t,n,r)}))}var Et="3.0.3",Ot=String.fromCharCode(65535),Pt=-1/0,St="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",xt="String expected.",Ct=[],It="undefined"!=typeof navigator&&/(MSIE|Trident|Edge)/.test(navigator.userAgent),At=It,kt=It,Tt=function(e){return!/(dexie\.js|dexie\.min\.js)/.test(e)},Mt="__dbnames",Rt="readonly",jt="readwrite";function Dt(e,t){return e?t?function(){return e.apply(this,arguments)&&t.apply(this,arguments)}:e:t}var Nt={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function Kt(e){return function(t){return void 0===P(t,e)&&x(t=R(t),e),t}}var Ft=function(){function e(){}return e.prototype._trans=function(e,t,n){var r=this._tx||je.trans,a=this.name;function o(e,n,r){if(!r.schema[a])throw new ae.NotFound("Table "+a+" not part of transaction");return t(r.idbtrans,r)}var i=He();try{return r&&r.db===this.db?r===je.trans?r._promise(e,o,n):it((function(){return r._promise(e,o,n)}),{trans:r,transless:je.transless||je}):wt(this.db,e,[this.name],o)}finally{i&&Qe()}},e.prototype.get=function(e,t){var n=this;return e&&e.constructor===Object?this.where(e).first(t):this._trans("readonly",(function(t){return n.core.get({trans:t,key:e}).then((function(e){return n.hook.reading.fire(e)}))})).then(t)},e.prototype.where=function(e){if("string"==typeof e)return new this.db.WhereClause(this,e);if(i(e))return new this.db.WhereClause(this,"["+e.join("+")+"]");var t=o(e);if(1===t.length)return this.where(t[0]).equals(e[t[0]]);var n=this.schema.indexes.concat(this.schema.primKey).filter((function(e){return e.compound&&t.every((function(t){return e.keyPath.indexOf(t)>=0}))&&e.keyPath.every((function(e){return t.indexOf(e)>=0}))}))[0];if(n&&this.db._maxKey!==Ot)return this.where(n.name).equals(n.keyPath.map((function(t){return e[t]})));!n&&q&&console.warn("The query "+JSON.stringify(e)+" on "+this.name+" would benefit of a compound index ["+t.join("+")+"]");var r=this.schema.idxByName,a=this.db._deps.indexedDB;function u(e,t){try{return 0===a.cmp(e,t)}catch(e){return!1}}var s=t.reduce((function(t,n){var a=t[0],o=t[1],s=r[n],l=e[n];return[a||s,a||!s?Dt(o,s&&s.multi?function(e){var t=P(e,n);return i(t)&&t.some((function(e){return u(l,e)}))}:function(e){return u(l,P(e,n))}):o]}),[null,null]),l=s[0],c=s[1];return l?this.where(l.name).equals(e[l.keyPath]).filter(c):n?this.filter(c):this.where(t).equals("")},e.prototype.filter=function(e){return this.toCollection().and(e)},e.prototype.count=function(e){return this.toCollection().count(e)},e.prototype.offset=function(e){return this.toCollection().offset(e)},e.prototype.limit=function(e){return this.toCollection().limit(e)},e.prototype.each=function(e){return this.toCollection().each(e)},e.prototype.toArray=function(e){return this.toCollection().toArray(e)},e.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},e.prototype.orderBy=function(e){return new this.db.Collection(new this.db.WhereClause(this,i(e)?"["+e.join("+")+"]":e))},e.prototype.reverse=function(){return this.toCollection().reverse()},e.prototype.mapToClass=function(e){this.schema.mappedClass=e;var t=function(t){if(!t)return t;var n=Object.create(e.prototype);for(var r in t)if(f(t,r))try{n[r]=t[r]}catch(e){}return n};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=t,this.hook("reading",t),e},e.prototype.defineClass=function(){return this.mapToClass((function(e){s(this,e)}))},e.prototype.add=function(e,t){var n=this,r=this.schema.primKey,a=r.auto,o=r.keyPath,i=e;return o&&a&&(i=Kt(o)(e)),this._trans("readwrite",(function(e){return n.core.mutate({trans:e,type:"add",keys:null!=t?[t]:null,values:[i]})})).then((function(e){return e.numFailures?Fe.reject(e.failures[0]):e.lastResult})).then((function(t){if(o)try{S(e,o,t)}catch(e){}return t}))},e.prototype.update=function(e,t){if("object"!=typeof t||i(t))throw new ae.InvalidArgument("Modifications must be an object.");if("object"!=typeof e||i(e))return this.where(":id").equals(e).modify(t);o(t).forEach((function(n){S(e,n,t[n])}));var n=P(e,this.schema.primKey.keyPath);return void 0===n?bt(new ae.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(n).modify(t)},e.prototype.put=function(e,t){var n=this,r=this.schema.primKey,a=r.auto,o=r.keyPath,i=e;return o&&a&&(i=Kt(o)(e)),this._trans("readwrite",(function(e){return n.core.mutate({trans:e,type:"put",values:[i],keys:null!=t?[t]:null})})).then((function(e){return e.numFailures?Fe.reject(e.failures[0]):e.lastResult})).then((function(t){if(o)try{S(e,o,t)}catch(e){}return t}))},e.prototype.delete=function(e){var t=this;return this._trans("readwrite",(function(n){return t.core.mutate({trans:n,type:"delete",keys:[e]})})).then((function(e){return e.numFailures?Fe.reject(e.failures[0]):void 0}))},e.prototype.clear=function(){var e=this;return this._trans("readwrite",(function(t){return e.core.mutate({trans:t,type:"deleteRange",range:Nt})})).then((function(e){return e.numFailures?Fe.reject(e.failures[0]):void 0}))},e.prototype.bulkGet=function(e){var t=this;return this._trans("readonly",(function(n){return t.core.getMany({keys:e,trans:n}).then((function(e){return e.map((function(e){return t.hook.reading.fire(e)}))}))}))},e.prototype.bulkAdd=function(e,t,n){var r=this,a=Array.isArray(t)?t:void 0,o=(n=n||(a?void 0:t))?n.allKeys:void 0;return this._trans("readwrite",(function(t){var n=r.schema.primKey,i=n.auto,u=n.keyPath;if(u&&a)throw new ae.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(a&&a.length!==e.length)throw new ae.InvalidArgument("Arguments objects and keys must have the same length");var s=e.length,l=u&&i?e.map(Kt(u)):e;return r.core.mutate({trans:t,type:"add",keys:a,values:l,wantResults:o}).then((function(e){var t=e.numFailures,n=e.results,a=e.lastResult,i=e.failures;if(0===t)return o?n:a;throw new te(r.name+".bulkAdd(): "+t+" of "+s+" operations failed",Object.keys(i).map((function(e){return i[e]})))}))}))},e.prototype.bulkPut=function(e,t,n){var r=this,a=Array.isArray(t)?t:void 0,o=(n=n||(a?void 0:t))?n.allKeys:void 0;return this._trans("readwrite",(function(t){var n=r.schema.primKey,i=n.auto,u=n.keyPath;if(u&&a)throw new ae.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(a&&a.length!==e.length)throw new ae.InvalidArgument("Arguments objects and keys must have the same length");var s=e.length,l=u&&i?e.map(Kt(u)):e;return r.core.mutate({trans:t,type:"put",keys:a,values:l,wantResults:o}).then((function(e){var t=e.numFailures,n=e.results,a=e.lastResult,i=e.failures;if(0===t)return o?n:a;throw new te(r.name+".bulkPut(): "+t+" of "+s+" operations failed",Object.keys(i).map((function(e){return i[e]})))}))}))},e.prototype.bulkDelete=function(e){var t=this,n=e.length;return this._trans("readwrite",(function(n){return t.core.mutate({trans:n,type:"delete",keys:e})})).then((function(e){var r=e.numFailures,a=e.lastResult,o=e.failures;if(0===r)return a;throw new te(t.name+".bulkDelete(): "+r+" of "+n+" operations failed",o)}))},e}();function Bt(e){var t={},n=function(n,r){if(r){for(var a=arguments.length,o=new Array(a-1);--a;)o[a-1]=arguments[a];return t[n].subscribe.apply(null,o),e}if("string"==typeof n)return t[n]};n.addEventType=u;for(var r=1,a=arguments.length;r<a;++r)u(arguments[r]);return n;function u(e,r,a){if("object"==typeof e)return s(e);r||(r=pe),a||(a=ue);var o={subscribers:[],fire:a,subscribe:function(e){-1===o.subscribers.indexOf(e)&&(o.subscribers.push(e),o.fire=r(o.fire,e))},unsubscribe:function(e){o.subscribers=o.subscribers.filter((function(t){return t!==e})),o.fire=o.subscribers.reduce(r,a)}};return t[e]=n[e]=o,o}function s(e){o(e).forEach((function(t){var n=e[t];if(i(n))u(t,e[t][0],e[t][1]);else{if("asap"!==n)throw new ae.InvalidArgument("Invalid event config");var r=u(t,se,(function(){for(var e=arguments.length,t=new Array(e);e--;)t[e]=arguments[e];r.subscribers.forEach((function(e){E((function(){e.apply(null,t)}))}))}))}}))}}function Yt(e,t){return v(t).from({prototype:e}),t}function Lt(e,t){return!(e.filter||e.algorithm||e.or)&&(t?e.justLimit:!e.replayFilter)}function Ut(e,t){e.filter=Dt(e.filter,t)}function qt(e,t,n){var r=e.replayFilter;e.replayFilter=r?function(){return Dt(r(),t())}:t,e.justLimit=n&&!r}function Vt(e,t){if(e.isPrimKey)return t.primaryKey;var n=t.getIndexByKeyPath(e.index);if(!n)throw new ae.Schema("KeyPath "+e.index+" on object store "+t.name+" is not indexed");return n}function zt(e,t,n){var r=Vt(e,t.schema);return t.openCursor({trans:n,values:!e.keysOnly,reverse:"prev"===e.dir,unique:!!e.unique,query:{index:r,range:e.range}})}function Wt(e,t,n,r){var a=e.replayFilter?Dt(e.filter,e.replayFilter()):e.filter;if(e.or){var o={},i=function(e,n,r){if(!a||a(n,r,(function(e){return n.stop(e)}),(function(e){return n.fail(e)}))){var i=n.primaryKey,u=""+i;"[object ArrayBuffer]"===u&&(u=""+new Uint8Array(i)),f(o,u)||(o[u]=!0,t(e,n,r))}};return Promise.all([e.or._iterate(i,n),Gt(zt(e,r,n),e.algorithm,i,!e.keysOnly&&e.valueMapper)])}return Gt(zt(e,r,n),Dt(e.algorithm,a),t,!e.keysOnly&&e.valueMapper)}function Gt(e,t,n,r){var a=$e(r?function(e,t,a){return n(r(e),t,a)}:n);return e.then((function(e){if(e)return e.start((function(){var n=function(){return e.continue()};t&&!t(e,(function(e){return n=e}),(function(t){e.stop(t),n=ue}),(function(t){e.fail(t),n=ue}))||a(e.value,e,(function(e){return n=e})),n()}))}))}var Xt=function(){function e(){}return e.prototype._read=function(e,t){var n=this._ctx;return n.error?n.table._trans(null,bt.bind(null,n.error)):n.table._trans("readonly",e).then(t)},e.prototype._write=function(e){var t=this._ctx;return t.error?t.table._trans(null,bt.bind(null,t.error)):t.table._trans("readwrite",e,"locked")},e.prototype._addAlgorithm=function(e){var t=this._ctx;t.algorithm=Dt(t.algorithm,e)},e.prototype._iterate=function(e,t){return Wt(this._ctx,e,t,this._ctx.table.core)},e.prototype.clone=function(e){var t=Object.create(this.constructor.prototype),n=Object.create(this._ctx);return e&&s(n,e),t._ctx=n,t},e.prototype.raw=function(){return this._ctx.valueMapper=null,this},e.prototype.each=function(e){var t=this._ctx;return this._read((function(n){return Wt(t,e,n,t.table.core)}))},e.prototype.count=function(e){var t=this;return this._read((function(e){var n=t._ctx,r=n.table.core;if(Lt(n,!0))return r.count({trans:e,query:{index:Vt(n,r.schema),range:n.range}}).then((function(e){return Math.min(e,n.limit)}));var a=0;return Wt(n,(function(){return++a,!1}),e,r).then((function(){return a}))})).then(e)},e.prototype.sortBy=function(e,t){var n=e.split(".").reverse(),r=n[0],a=n.length-1;function o(e,t){return t?o(e[n[t]],t-1):e[r]}var i="next"===this._ctx.dir?1:-1;function u(e,t){var n=o(e,a),r=o(t,a);return n<r?-i:n>r?i:0}return this.toArray((function(e){return e.sort(u)})).then(t)},e.prototype.toArray=function(e){var t=this;return this._read((function(e){var n=t._ctx;if("next"===n.dir&&Lt(n,!0)&&n.limit>0){var r=n.valueMapper,a=Vt(n,n.table.core.schema);return n.table.core.query({trans:e,limit:n.limit,values:!0,query:{index:a,range:n.range}}).then((function(e){var t=e.result;return r?t.map(r):t}))}var o=[];return Wt(n,(function(e){return o.push(e)}),e,n.table.core).then((function(){return o}))}),e)},e.prototype.offset=function(e){var t=this._ctx;return e<=0||(t.offset+=e,Lt(t)?qt(t,(function(){var t=e;return function(e,n){return 0===t||(1===t?(--t,!1):(n((function(){e.advance(t),t=0})),!1))}})):qt(t,(function(){var t=e;return function(){return--t<0}}))),this},e.prototype.limit=function(e){return this._ctx.limit=Math.min(this._ctx.limit,e),qt(this._ctx,(function(){var t=e;return function(e,n,r){return--t<=0&&n(r),t>=0}}),!0),this},e.prototype.until=function(e,t){return Ut(this._ctx,(function(n,r,a){return!e(n.value)||(r(a),t)})),this},e.prototype.first=function(e){return this.limit(1).toArray((function(e){return e[0]})).then(e)},e.prototype.last=function(e){return this.reverse().first(e)},e.prototype.filter=function(e){var t,n;return Ut(this._ctx,(function(t){return e(t.value)})),t=this._ctx,n=e,t.isMatch=Dt(t.isMatch,n),this},e.prototype.and=function(e){return this.filter(e)},e.prototype.or=function(e){return new this.db.WhereClause(this._ctx.table,e,this)},e.prototype.reverse=function(){return this._ctx.dir="prev"===this._ctx.dir?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},e.prototype.desc=function(){return this.reverse()},e.prototype.eachKey=function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each((function(t,n){e(n.key,n)}))},e.prototype.eachUniqueKey=function(e){return this._ctx.unique="unique",this.eachKey(e)},e.prototype.eachPrimaryKey=function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each((function(t,n){e(n.primaryKey,n)}))},e.prototype.keys=function(e){var t=this._ctx;t.keysOnly=!t.isMatch;var n=[];return this.each((function(e,t){n.push(t.key)})).then((function(){return n})).then(e)},e.prototype.primaryKeys=function(e){var t=this._ctx;if("next"===t.dir&&Lt(t,!0)&&t.limit>0)return this._read((function(e){var n=Vt(t,t.table.core.schema);return t.table.core.query({trans:e,values:!1,limit:t.limit,query:{index:n,range:t.range}})})).then((function(e){return e.result})).then(e);t.keysOnly=!t.isMatch;var n=[];return this.each((function(e,t){n.push(t.primaryKey)})).then((function(){return n})).then(e)},e.prototype.uniqueKeys=function(e){return this._ctx.unique="unique",this.keys(e)},e.prototype.firstKey=function(e){return this.limit(1).keys((function(e){return e[0]})).then(e)},e.prototype.lastKey=function(e){return this.reverse().firstKey(e)},e.prototype.distinct=function(){var e=this._ctx,t=e.index&&e.table.schema.idxByName[e.index];if(!t||!t.multi)return this;var n={};return Ut(this._ctx,(function(e){var t=e.primaryKey.toString(),r=f(n,t);return n[t]=!0,!r})),this},e.prototype.modify=function(e){var t=this,n=this._ctx;return this._write((function(r){var a;if("function"==typeof e)a=e;else{var i=o(e),u=i.length;a=function(t){for(var n=!1,r=0;r<u;++r){var a=i[r],o=e[a];P(t,a)!==o&&(S(t,a,o),n=!0)}return n}}var s=n.table.core,l=s.schema.primaryKey,c=l.outbound,f=l.extractKey,d="testmode"in Yn?1:2e3,h=t.db.core.cmp,p=[],v=0,m=[],y=function(e,t){var n=t.failures,r=t.numFailures;v+=e-r;for(var a=0,i=o(n);a<i.length;a++){var u=i[a];p.push(n[u])}};return t.clone().primaryKeys().then((function(e){var t=function(n){var o=Math.min(d,e.length-n);return s.getMany({trans:r,keys:e.slice(n,n+o)}).then((function(i){for(var u=[],l=[],p=c?[]:null,v=[],m=0;m<o;++m){var _=i[m],g={value:R(_),primKey:e[n+m]};!1!==a.call(g,g.value,g)&&(null==g.value?v.push(e[n+m]):c||0===h(f(_),f(g.value))?(l.push(g.value),c&&p.push(e[n+m])):(v.push(e[n+m]),u.push(g.value)))}return Promise.resolve(u.length>0&&s.mutate({trans:r,type:"add",values:u}).then((function(e){for(var t in e.failures)v.splice(parseInt(t),1);y(u.length,e)}))).then((function(e){return l.length>0&&s.mutate({trans:r,type:"put",keys:p,values:l}).then((function(e){return y(l.length,e)}))})).then((function(){return v.length>0&&s.mutate({trans:r,type:"delete",keys:v}).then((function(e){return y(v.length,e)}))})).then((function(){return e.length>n+o&&t(n+d)}))}))};return t(0).then((function(){if(p.length>0)throw new ee("Error modifying one or more objects",p,v,m);return e.length}))}))}))},e.prototype.delete=function(){var e=this._ctx,t=e.range;return Lt(e)&&(e.isPrimKey&&!kt||3===t.type)?this._write((function(n){var r=e.table.core.schema.primaryKey,a=t;return e.table.core.count({trans:n,query:{index:r,range:a}}).then((function(t){return e.table.core.mutate({trans:n,type:"deleteRange",range:a}).then((function(e){var n=e.failures,r=(e.lastResult,e.results,e.numFailures);if(r)throw new ee("Could not delete some values",Object.keys(n).map((function(e){return n[e]})),t-r);return t-r}))}))})):this.modify((function(e,t){return t.value=null}))},e}();function Ht(e,t){return e<t?-1:e===t?0:1}function Qt(e,t){return e>t?-1:e===t?0:1}function Jt(e,t,n){var r=e instanceof rn?new e.Collection(e):e;return r._ctx.error=n?new n(t):new TypeError(t),r}function Zt(e){return new e.Collection(e,(function(){return nn("")})).limit(0)}function $t(e,t,n,r,a,o){for(var i=Math.min(e.length,r.length),u=-1,s=0;s<i;++s){var l=t[s];if(l!==r[s])return a(e[s],n[s])<0?e.substr(0,s)+n[s]+n.substr(s+1):a(e[s],r[s])<0?e.substr(0,s)+r[s]+n.substr(s+1):u>=0?e.substr(0,u)+t[u]+n.substr(u+1):null;a(e[s],l)<0&&(u=s)}return i<r.length&&"next"===o?e+n.substr(e.length):i<e.length&&"prev"===o?e.substr(0,n.length):u<0?null:e.substr(0,u)+r[u]+n.substr(u+1)}function en(e,t,n,r){var a,o,i,u,s,l,c,f=n.length;if(!n.every((function(e){return"string"==typeof e})))return Jt(e,xt);function d(e){a=function(e){return"next"===e?function(e){return e.toUpperCase()}:function(e){return e.toLowerCase()}}(e),o=function(e){return"next"===e?function(e){return e.toLowerCase()}:function(e){return e.toUpperCase()}}(e),i="next"===e?Ht:Qt;var t=n.map((function(e){return{lower:o(e),upper:a(e)}})).sort((function(e,t){return i(e.lower,t.lower)}));u=t.map((function(e){return e.upper})),s=t.map((function(e){return e.lower})),l=e,c="next"===e?"":r}d("next");var h=new e.Collection(e,(function(){return tn(u[0],s[f-1]+r)}));h._ondirectionchange=function(e){d(e)};var p=0;return h._addAlgorithm((function(e,n,r){var a=e.key;if("string"!=typeof a)return!1;var d=o(a);if(t(d,s,p))return!0;for(var h=null,v=p;v<f;++v){var m=$t(a,d,u[v],s[v],i,l);null===m&&null===h?p=v+1:(null===h||i(h,m)>0)&&(h=m)}return n(null!==h?function(){e.continue(h+c)}:r),!1})),h}function tn(e,t,n,r){return{type:2,lower:e,upper:t,lowerOpen:n,upperOpen:r}}function nn(e){return{type:1,lower:e,upper:e}}var rn=function(){function e(){}return Object.defineProperty(e.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!0,configurable:!0}),e.prototype.between=function(e,t,n,r){n=!1!==n,r=!0===r;try{return this._cmp(e,t)>0||0===this._cmp(e,t)&&(n||r)&&(!n||!r)?Zt(this):new this.Collection(this,(function(){return tn(e,t,!n,!r)}))}catch(e){return Jt(this,St)}},e.prototype.equals=function(e){return null==e?Jt(this,St):new this.Collection(this,(function(){return nn(e)}))},e.prototype.above=function(e){return null==e?Jt(this,St):new this.Collection(this,(function(){return tn(e,void 0,!0)}))},e.prototype.aboveOrEqual=function(e){return null==e?Jt(this,St):new this.Collection(this,(function(){return tn(e,void 0,!1)}))},e.prototype.below=function(e){return null==e?Jt(this,St):new this.Collection(this,(function(){return tn(void 0,e,!1,!0)}))},e.prototype.belowOrEqual=function(e){return null==e?Jt(this,St):new this.Collection(this,(function(){return tn(void 0,e)}))},e.prototype.startsWith=function(e){return"string"!=typeof e?Jt(this,xt):this.between(e,e+Ot,!0,!0)},e.prototype.startsWithIgnoreCase=function(e){return""===e?this.startsWith(e):en(this,(function(e,t){return 0===e.indexOf(t[0])}),[e],Ot)},e.prototype.equalsIgnoreCase=function(e){return en(this,(function(e,t){return e===t[0]}),[e],"")},e.prototype.anyOfIgnoreCase=function(){var e=L.apply(Y,arguments);return 0===e.length?Zt(this):en(this,(function(e,t){return-1!==t.indexOf(e)}),e,"")},e.prototype.startsWithAnyOfIgnoreCase=function(){var e=L.apply(Y,arguments);return 0===e.length?Zt(this):en(this,(function(e,t){return t.some((function(t){return 0===e.indexOf(t)}))}),e,Ot)},e.prototype.anyOf=function(){var e=this,t=L.apply(Y,arguments),n=this._cmp;try{t.sort(n)}catch(e){return Jt(this,St)}if(0===t.length)return Zt(this);var r=new this.Collection(this,(function(){return tn(t[0],t[t.length-1])}));r._ondirectionchange=function(r){n="next"===r?e._ascending:e._descending,t.sort(n)};var a=0;return r._addAlgorithm((function(e,r,o){for(var i=e.key;n(i,t[a])>0;)if(++a===t.length)return r(o),!1;return 0===n(i,t[a])||(r((function(){e.continue(t[a])})),!1)})),r},e.prototype.notEqual=function(e){return this.inAnyRange([[Pt,e],[e,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},e.prototype.noneOf=function(){var e=L.apply(Y,arguments);if(0===e.length)return new this.Collection(this);try{e.sort(this._ascending)}catch(e){return Jt(this,St)}var t=e.reduce((function(e,t){return e?e.concat([[e[e.length-1][1],t]]):[[Pt,t]]}),null);return t.push([e[e.length-1],this.db._maxKey]),this.inAnyRange(t,{includeLowers:!1,includeUppers:!1})},e.prototype.inAnyRange=function(e,t){var n=this,r=this._cmp,a=this._ascending,o=this._descending,i=this._min,u=this._max;if(0===e.length)return Zt(this);if(!e.every((function(e){return void 0!==e[0]&&void 0!==e[1]&&a(e[0],e[1])<=0})))return Jt(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",ae.InvalidArgument);var s=!t||!1!==t.includeLowers,l=t&&!0===t.includeUppers;var c,f=a;function d(e,t){return f(e[0],t[0])}try{(c=e.reduce((function(e,t){for(var n=0,a=e.length;n<a;++n){var o=e[n];if(r(t[0],o[1])<0&&r(t[1],o[0])>0){o[0]=i(o[0],t[0]),o[1]=u(o[1],t[1]);break}}return n===a&&e.push(t),e}),[])).sort(d)}catch(e){return Jt(this,St)}var h=0,p=l?function(e){return a(e,c[h][1])>0}:function(e){return a(e,c[h][1])>=0},v=s?function(e){return o(e,c[h][0])>0}:function(e){return o(e,c[h][0])>=0};var m=p,y=new this.Collection(this,(function(){return tn(c[0][0],c[c.length-1][1],!s,!l)}));return y._ondirectionchange=function(e){"next"===e?(m=p,f=a):(m=v,f=o),c.sort(d)},y._addAlgorithm((function(e,t,r){for(var o=e.key;m(o);)if(++h===c.length)return t(r),!1;return!!function(e){return!p(e)&&!v(e)}(o)||(0===n._cmp(o,c[h][1])||0===n._cmp(o,c[h][0])||t((function(){f===a?e.continue(c[h][0]):e.continue(c[h][1])})),!1)})),y},e.prototype.startsWithAnyOf=function(){var e=L.apply(Y,arguments);return e.every((function(e){return"string"==typeof e}))?0===e.length?Zt(this):this.inAnyRange(e.map((function(e){return[e,e+Ot]}))):Jt(this,"startsWithAnyOf() only works with strings")},e}();function an(e){return 1===e.length?e[0]:e}function on(e){try{return e.only([[]]),[[]]}catch(e){return Ot}}function un(e){return $e((function(t){return sn(t),e(t.target.error),!1}))}function sn(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()}var ln=function(){function e(){}return e.prototype._lock=function(){return w(!je.global),++this._reculock,1!==this._reculock||je.global||(je.lockOwnerFor=this),this},e.prototype._unlock=function(){if(w(!je.global),0==--this._reculock)for(je.global||(je.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var e=this._blockedFuncs.shift();try{pt(e[1],e[0])}catch(e){}}return this},e.prototype._locked=function(){return this._reculock&&je.lockOwnerFor!==this},e.prototype.create=function(e){var t=this;if(!this.mode)return this;var n=this.db.idbdb,r=this.db._state.dbOpenError;if(w(!this.idbtrans),!e&&!n)switch(r&&r.name){case"DatabaseClosedError":throw new ae.DatabaseClosed(r);case"MissingAPIError":throw new ae.MissingAPI(r.message,r);default:throw new ae.OpenFailed(r)}if(!this.active)throw new ae.TransactionInactive;return w(null===this._completion._state),(e=this.idbtrans=e||n.transaction(an(this.storeNames),this.mode)).onerror=$e((function(n){sn(n),t._reject(e.error)})),e.onabort=$e((function(n){sn(n),t.active&&t._reject(new ae.Abort(e.error)),t.active=!1,t.on("abort").fire(n)})),e.oncomplete=$e((function(){t.active=!1,t._resolve()})),this},e.prototype._promise=function(e,t,n){var r=this;if("readwrite"===e&&"readwrite"!==this.mode)return bt(new ae.ReadOnly("Transaction is readonly"));if(!this.active)return bt(new ae.TransactionInactive);if(this._locked())return new Fe((function(a,o){r._blockedFuncs.push([function(){r._promise(e,t,n).then(a,o)},je])}));if(n)return it((function(){var e=new Fe((function(e,n){r._lock();var a=t(e,n,r);a&&a.then&&a.then(e,n)}));return e.finally((function(){return r._unlock()})),e._lib=!0,e}));var a=new Fe((function(e,n){var a=t(e,n,r);a&&a.then&&a.then(e,n)}));return a._lib=!0,a},e.prototype._root=function(){return this.parent?this.parent._root():this},e.prototype.waitFor=function(e){var t=this._root(),n=Fe.resolve(e);if(t._waitingFor)t._waitingFor=t._waitingFor.then((function(){return n}));else{t._waitingFor=n,t._waitingQueue=[];var r=t.idbtrans.objectStore(t.storeNames[0]);!function e(){for(++t._spinCount;t._waitingQueue.length;)t._waitingQueue.shift()();t._waitingFor&&(r.get(-1/0).onsuccess=e)}()}var a=t._waitingFor;return new Fe((function(e,r){n.then((function(n){return t._waitingQueue.push($e(e.bind(null,n)))}),(function(e){return t._waitingQueue.push($e(r.bind(null,e)))})).finally((function(){t._waitingFor===a&&(t._waitingFor=null)}))}))},e.prototype.abort=function(){this.active&&this._reject(new ae.Abort),this.active=!1},e.prototype.table=function(e){var t=this._memoizedTables||(this._memoizedTables={});if(f(t,e))return t[e];var n=this.schema[e];if(!n)throw new ae.NotFound("Table "+e+" not part of transaction");var r=new this.db.Table(e,n,this);return r.core=this.db.core.table(e),t[e]=r,r},e}();function cn(e,t,n,r,a,o,i){return{name:e,keyPath:t,unique:n,multi:r,auto:a,compound:o,src:(n&&!i?"&":"")+(r?"*":"")+(a?"++":"")+fn(t)}}function fn(e){return"string"==typeof e?e:e?"["+[].join.call(e,"+")+"]":""}function dn(e,t,n){return{name:e,primKey:t,indexes:n,mappedClass:null,idxByName:O(n,(function(e){return[e.name,e]}))}}function hn(e){return null==e?function(){}:"string"==typeof e?function(e){return 1===e.split(".").length?function(t){return t[e]}:function(t){return P(t,e)}}(e):function(t){return P(t,e)}}function pn(e,t){return"delete"===t.type?t.keys:t.keys||t.values.map(e.extractKey)}function vn(e){return[].slice.call(e)}var mn=0;function yn(e){return null==e?":id":"string"==typeof e?e:"["+e.join("+")+"]"}function _n(e,t,n,r){var o=t.cmp.bind(t);function u(e){if(3===e.type)return null;if(4===e.type)throw new Error("Cannot convert never type to IDBKeyRange");var t=e.lower,r=e.upper,a=e.lowerOpen,o=e.upperOpen;return void 0===t?void 0===r?null:n.upperBound(r,!!o):void 0===r?n.lowerBound(t,!!a):n.bound(t,r,!!a,!!o)}var s=function(e,t){var n=vn(e.objectStoreNames);return{schema:{name:e.name,tables:n.map((function(e){return t.objectStore(e)})).map((function(e){var t=e.keyPath,n=e.autoIncrement,r=i(t),a=null==t,o={},u={name:e.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:a,compound:r,keyPath:t,autoIncrement:n,unique:!0,extractKey:hn(t)},indexes:vn(e.indexNames).map((function(t){return e.index(t)})).map((function(e){var t=e.name,n=e.unique,r=e.multiEntry,a=e.keyPath,u={name:t,compound:i(a),keyPath:a,unique:n,multiEntry:r,extractKey:hn(a)};return o[yn(a)]=u,u})),getIndexByKeyPath:function(e){return o[yn(e)]}};return o[":id"]=u.primaryKey,null!=t&&(o[yn(t)]=u.primaryKey),u}))},hasGetAll:n.length>0&&"getAll"in t.objectStore(n[0])&&!("undefined"!=typeof navigator&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}}(e,r),l=s.schema,c=s.hasGetAll,f=l.tables.map((function(e){return function(e){var t=e.name;return{name:t,schema:e,mutate:function(n){var r=n.trans,o=n.type,i=n.keys,s=n.values,l=n.range,c=n.wantResults;return new Promise((function(n,f){n=$e(n);var d=r.objectStore(t),h=null==d.keyPath,p="put"===o||"add"===o;if(!p&&"delete"!==o&&"deleteRange"!==o)throw new Error("Invalid operation type: "+o);var v=(i||s||{length:1}).length;if(i&&s&&i.length!==s.length)throw new Error("Given keys array must have same length as given values array.");if(0===v)return n({numFailures:0,failures:{},results:[],lastResult:void 0});var m,y=c&&a(i||pn(e.primaryKey,{type:o,keys:i,values:s})),_=[],g=0,b=function(e){++g,sn(e),y&&(y[e.target._reqno]=void 0),_[e.target._reqno]=e.target.error},w=function(e){var t=e.target;y[t._reqno]=t.result};if("deleteRange"===o){if(4===l.type)return n({numFailures:g,failures:_,results:y,lastResult:void 0});m=3===l.type?d.clear():d.delete(u(l))}else{var E=p?h?[s,i]:[s,null]:[i,null],O=E[0],P=E[1];if(p)for(var S=0;S<v;++S)(m=P&&void 0!==P[S]?d[o](O[S],P[S]):d[o](O[S]))._reqno=S,y&&void 0===y[S]&&(m.onsuccess=w),m.onerror=b;else for(S=0;S<v;++S)(m=d[o](O[S]))._reqno=S,m.onerror=b}var x=function(e){var t=e.target.result;y&&(y[v-1]=t),n({numFailures:g,failures:_,results:y,lastResult:t})};m.onerror=function(e){b(e),x(e)},m.onsuccess=x}))},getMany:function(e){var n=e.trans,r=e.keys;return new Promise((function(e,a){e=$e(e);for(var o,i=n.objectStore(t),u=r.length,s=new Array(u),l=0,c=0,f=function(t){var n=t.target;s[n._pos]=n.result,++c===l&&e(s)},d=un(a),h=0;h<u;++h)null!=r[h]&&((o=i.get(r[h]))._pos=h,o.onsuccess=f,o.onerror=d,++l);0===l&&e(s)}))},get:function(e){var n=e.trans,r=e.key;return new Promise((function(e,a){e=$e(e);var o=n.objectStore(t).get(r);o.onsuccess=function(t){return e(t.target.result)},o.onerror=un(a)}))},query:function(e){return function(n){return new Promise((function(r,a){r=$e(r);var o=n.trans,i=n.values,s=n.limit,l=n.query,c=s===1/0?void 0:s,f=l.index,d=l.range,h=o.objectStore(t),p=f.isPrimaryKey?h:h.index(f.name),v=u(d);if(0===s)return r({result:[]});if(e){var m=i?p.getAll(v,c):p.getAllKeys(v,c);m.onsuccess=function(e){return r({result:e.target.result})},m.onerror=un(a)}else{var y=0,_=i||!("openKeyCursor"in p)?p.openCursor(v):p.openKeyCursor(v),g=[];_.onsuccess=function(e){var t=_.result;return t?(g.push(i?t.value:t.primaryKey),++y===s?r({result:g}):void t.continue()):r({result:g})},_.onerror=un(a)}}))}}(c),openCursor:function(e){var n=e.trans,r=e.values,a=e.query,o=e.reverse,i=e.unique;return new Promise((function(e,s){e=$e(e);var l=a.index,c=a.range,f=n.objectStore(t),d=l.isPrimaryKey?f:f.index(l.name),h=o?i?"prevunique":"prev":i?"nextunique":"next",p=r||!("openKeyCursor"in d)?d.openCursor(u(c),h):d.openKeyCursor(u(c),h);p.onerror=un(s),p.onsuccess=$e((function(t){var r=p.result;if(r){r.___id=++mn,r.done=!1;var a=r.continue.bind(r),o=r.continuePrimaryKey;o&&(o=o.bind(r));var i=r.advance.bind(r),u=function(){throw new Error("Cursor not stopped")};r.trans=n,r.stop=r.continue=r.continuePrimaryKey=r.advance=function(){throw new Error("Cursor not started")},r.fail=$e(s),r.next=function(){var e=this,t=1;return this.start((function(){return t--?e.continue():e.stop()})).then((function(){return e}))},r.start=function(e){var t=new Promise((function(e,t){e=$e(e),p.onerror=un(t),r.fail=t,r.stop=function(t){r.stop=r.continue=r.continuePrimaryKey=r.advance=u,e(t)}})),n=function(){if(p.result)try{e()}catch(e){r.fail(e)}else r.done=!0,r.start=function(){throw new Error("Cursor behind last entry")},r.stop()};return p.onsuccess=$e((function(e){p.onsuccess=n,n()})),r.continue=a,r.continuePrimaryKey=o,r.advance=i,n(),t},e(r)}else e(null)}),s)}))},count:function(e){var n=e.query,r=e.trans,a=n.index,o=n.range;return new Promise((function(e,n){var i=r.objectStore(t),s=a.isPrimaryKey?i:i.index(a.name),l=u(o),c=l?s.count(l):s.count();c.onsuccess=$e((function(t){return e(t.target.result)})),c.onerror=un(n)}))}}}(e)})),d={};return f.forEach((function(e){return d[e.name]=e})),{stack:"dbcore",transaction:e.transaction.bind(e),table:function(e){if(!d[e])throw new Error("Table '"+e+"' not found");return d[e]},cmp:o,MIN_KEY:-1/0,MAX_KEY:on(n),schema:l}}function gn(e,t,n,a){var o=n.IDBKeyRange;return{dbcore:function(e,t){return t.reduce((function(e,t){var n=t.create;return r(r({},e),n(e))}),e)}(_n(t,n.indexedDB,o,a),e.dbcore)}}function bn(e,t){var n=t.db,r=gn(e._middlewares,n,e._deps,t);e.core=r.dbcore,e.tables.forEach((function(t){var n=t.name;e.core.schema.tables.some((function(e){return e.name===n}))&&(t.core=e.core.table(n),e[n]instanceof e.Table&&(e[n].core=t.core))}))}function wn(e,t,n,r){n.forEach((function(n){var a=r[n];t.forEach((function(t){var r=y(t,n);(!r||"value"in r&&void 0===r.value)&&(t===e.Transaction.prototype||t instanceof e.Transaction?p(t,n,{get:function(){return this.table(n)},set:function(e){h(this,n,{value:e,writable:!0,configurable:!0,enumerable:!0})}}):t[n]=new e.Table(n,a))}))}))}function En(e,t){t.forEach((function(t){for(var n in t)t[n]instanceof e.Table&&delete t[n]}))}function On(e,t){return e._cfg.version-t._cfg.version}function Pn(e,t,n,r){var a=e._dbSchema,i=e._createTransaction("readwrite",e._storeNames,a);i.create(n),i._completion.catch(r);var u=i._reject.bind(i),s=je.transless||je;it((function(){je.trans=i,je.transless=s,0===t?(o(a).forEach((function(e){xn(n,e,a[e].primKey,a[e].indexes)})),bn(e,n),Fe.follow((function(){return e.on.populate.fire(i)})).catch(u)):function(e,t,n,r){var a=[],i=e._versions,u=e._dbSchema=In(e,e.idbdb,r),s=!1;function l(){return a.length?Fe.resolve(a.shift()(n.idbtrans)).then(l):Fe.resolve()}return i.filter((function(e){return e._cfg.version>=t})).forEach((function(i){a.push((function(){var a=u,l=i._cfg.dbschema;An(e,a,r),An(e,l,r),u=e._dbSchema=l;var c=Sn(a,l);c.add.forEach((function(e){xn(r,e[0],e[1].primKey,e[1].indexes)})),c.change.forEach((function(e){if(e.recreate)throw new ae.Upgrade("Not yet support for changing primary key");var t=r.objectStore(e.name);e.add.forEach((function(e){return Cn(t,e)})),e.change.forEach((function(e){t.deleteIndex(e.name),Cn(t,e)})),e.del.forEach((function(e){return t.deleteIndex(e)}))}));var f=i._cfg.contentUpgrade;if(f&&i._cfg.version>t){bn(e,r),n._memoizedTables={},s=!0;var d=C(l);c.del.forEach((function(e){d[e]=a[e]})),En(e,[e.Transaction.prototype]),wn(e,[e.Transaction.prototype],o(d),d),n.schema=d;var h,p=U(f);p&&ut();var v=Fe.follow((function(){if((h=f(n))&&p){var e=st.bind(null,null);h.then(e,e)}}));return h&&"function"==typeof h.then?Fe.resolve(h):v.then((function(){return h}))}})),a.push((function(t){s&&At||function(e,t){for(var n=0;n<t.db.objectStoreNames.length;++n){var r=t.db.objectStoreNames[n];null==e[r]&&t.db.deleteObjectStore(r)}}(i._cfg.dbschema,t);En(e,[e.Transaction.prototype]),wn(e,[e.Transaction.prototype],e._storeNames,e._dbSchema),n.schema=e._dbSchema}))})),l().then((function(){var e,t;t=r,o(e=u).forEach((function(n){t.db.objectStoreNames.contains(n)||xn(t,n,e[n].primKey,e[n].indexes)}))}))}(e,t,i,n).catch(u)}))}function Sn(e,t){var n,r={del:[],add:[],change:[]};for(n in e)t[n]||r.del.push(n);for(n in t){var a=e[n],o=t[n];if(a){var i={name:n,def:o,recreate:!1,del:[],add:[],change:[]};if(""+(a.primKey.keyPath||"")!=""+(o.primKey.keyPath||"")||a.primKey.auto!==o.primKey.auto&&!It)i.recreate=!0,r.change.push(i);else{var u=a.idxByName,s=o.idxByName,l=void 0;for(l in u)s[l]||i.del.push(l);for(l in s){var c=u[l],f=s[l];c?c.src!==f.src&&i.change.push(f):i.add.push(f)}(i.del.length>0||i.add.length>0||i.change.length>0)&&r.change.push(i)}}else r.add.push([n,o])}return r}function xn(e,t,n,r){var a=e.db.createObjectStore(t,n.keyPath?{keyPath:n.keyPath,autoIncrement:n.auto}:{autoIncrement:n.auto});return r.forEach((function(e){return Cn(a,e)})),a}function Cn(e,t){e.createIndex(t.name,t.keyPath,{unique:t.unique,multiEntry:t.multi})}function In(e,t,n){var r={};return g(t.objectStoreNames,0).forEach((function(e){for(var t=n.objectStore(e),a=t.keyPath,o=cn(fn(a),a||"",!1,!1,!!t.autoIncrement,a&&"string"!=typeof a,!0),i=[],u=0;u<t.indexNames.length;++u){var s=t.index(t.indexNames[u]);a=s.keyPath;var l=cn(s.name,a,!!s.unique,!!s.multiEntry,!1,a&&"string"!=typeof a,!1);i.push(l)}r[e]=dn(e,o,i)})),r}function An(e,t,n){for(var r=n.db.objectStoreNames,a=0;a<r.length;++a){var o=r[a],i=n.objectStore(o);e._hasGetAll="getAll"in i;for(var s=0;s<i.indexNames.length;++s){var l=i.indexNames[s],c=i.index(l).keyPath,f="string"==typeof c?c:"["+g(c).join("+")+"]";if(t[o]){var d=t[o].idxByName[f];d&&(d.name=l,delete t[o].idxByName[f],t[o].idxByName[l]=d)}}}"undefined"!=typeof navigator&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&u.WorkerGlobalScope&&u instanceof u.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(e._hasGetAll=!1)}var kn,Tn=function(){function e(){}return e.prototype._parseStoresSpec=function(e,t){o(e).forEach((function(n){if(null!==e[n]){var r=e[n].split(",").map((function(e,t){var n=(e=e.trim()).replace(/([&*]|\+\+)/g,""),r=/^\[/.test(n)?n.match(/^\[(.*)\]$/)[1].split("+"):n;return cn(n,r||null,/\&/.test(e),/\*/.test(e),/\+\+/.test(e),i(r),0===t)})),a=r.shift();if(a.multi)throw new ae.Schema("Primary key cannot be multi-valued");r.forEach((function(e){if(e.auto)throw new ae.Schema("Only primary key can be marked as autoIncrement (++)");if(!e.keyPath)throw new ae.Schema("Index must have a name and cannot be an empty string")})),t[n]=dn(n,a,r)}}))},e.prototype.stores=function(e){var t=this.db;this._cfg.storesSource=this._cfg.storesSource?s(this._cfg.storesSource,e):e;var n=t._versions,r={},a={};return n.forEach((function(e){s(r,e._cfg.storesSource),a=e._cfg.dbschema={},e._parseStoresSpec(r,a)})),t._dbSchema=a,En(t,[t._allTables,t,t.Transaction.prototype]),wn(t,[t._allTables,t,t.Transaction.prototype,this._cfg.tables],o(a),a),t._storeNames=o(a),this},e.prototype.upgrade=function(e){return this._cfg.contentUpgrade=e,this},e}();function Mn(e){return it((function(){return je.letThrough=!0,e()}))}function Rn(e){var t=e._state,n=e._deps.indexedDB;if(t.isBeingOpened||e.idbdb)return t.dbReadyPromise.then((function(){return t.dbOpenError?bt(t.dbOpenError):e}));q&&(t.openCanceller._stackHolder=G()),t.isBeingOpened=!0,t.dbOpenError=null,t.openComplete=!1;var r=t.dbReadyResolve,a=null;return Fe.race([t.openCanceller,new Fe((function(r,i){if(!n)throw new ae.MissingAPI("indexedDB API not found. If using IE10+, make sure to run your code on a server URL (not locally). If using old Safari versions, make sure to include indexedDB polyfill.");var u=e.name,s=t.autoSchema?n.open(u):n.open(u,Math.round(10*e.verno));if(!s)throw new ae.MissingAPI("IndexedDB API not available");s.onerror=un(i),s.onblocked=$e(e._fireOnBlocked),s.onupgradeneeded=$e((function(r){if(a=s.transaction,t.autoSchema&&!e._options.allowEmptyDB){s.onerror=sn,a.abort(),s.result.close();var o=n.deleteDatabase(u);o.onsuccess=o.onerror=$e((function(){i(new ae.NoSuchDatabase("Database "+u+" doesnt exist"))}))}else{a.onerror=un(i);var l=r.oldVersion>Math.pow(2,62)?0:r.oldVersion;e.idbdb=s.result,Pn(e,l/10,a,i)}}),i),s.onsuccess=$e((function(){a=null;var n=e.idbdb=s.result,i=g(n.objectStoreNames);if(i.length>0)try{var l=n.transaction(an(i),"readonly");t.autoSchema?function(e,t,n){e.verno=t.version/10;var r=e._dbSchema=In(0,t,n);e._storeNames=g(t.objectStoreNames,0),wn(e,[e._allTables],o(r),r)}(e,n,l):(An(e,e._dbSchema,l),function(e,t){var n=Sn(In(0,e.idbdb,t),e._dbSchema);return!(n.add.length||n.change.some((function(e){return e.add.length||e.change.length})))}(e,l)||console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Some queries may fail.")),bn(e,l)}catch(e){}Ct.push(e),n.onversionchange=$e((function(n){t.vcFired=!0,e.on("versionchange").fire(n)})),kn.add(u),r()}),i)}))]).then((function(){return t.onReadyBeingFired=[],Fe.resolve(Mn(e.on.ready.fire)).then((function e(){if(t.onReadyBeingFired.length>0){var n=t.onReadyBeingFired.reduce(ve,ue);return t.onReadyBeingFired=[],Fe.resolve(Mn(n)).then(e)}}))})).finally((function(){t.onReadyBeingFired=null})).then((function(){return t.isBeingOpened=!1,e})).catch((function(n){try{a&&a.abort()}catch(e){}return t.isBeingOpened=!1,e.close(),t.dbOpenError=n,bt(t.dbOpenError)})).finally((function(){t.openComplete=!0,r()}))}function jn(e){var t=function(t){return e.next(t)},n=a(t),r=a((function(t){return e.throw(t)}));function a(e){return function(t){var a=e(t),o=a.value;return a.done?o:o&&"function"==typeof o.then?o.then(n,r):i(o)?Promise.all(o).then(n,r):n(o)}}return a(t)()}function Dn(e,t,n){var r=arguments.length;if(r<2)throw new ae.InvalidArgument("Too few arguments");for(var a=new Array(r-1);--r;)a[r-1]=arguments[r];n=a.pop();var o=A(a);return[e,o,n]}function Nn(e,t,n,r,a){return Fe.resolve().then((function(){var o=je.transless||je,i=e._createTransaction(t,n,e._dbSchema,r),u={trans:i,transless:o};r?i.idbtrans=r.idbtrans:i.create();var s,l=U(a);l&&ut();var c=Fe.follow((function(){if(s=a.call(i,i))if(l){var e=st.bind(null,null);s.then(e,e)}else"function"==typeof s.next&&"function"==typeof s.throw&&(s=jn(s))}),u);return(s&&"function"==typeof s.then?Fe.resolve(s).then((function(e){return i.active?e:bt(new ae.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))})):c.then((function(){return s}))).then((function(e){return r&&i._resolve(),i._completion.then((function(){return e}))})).catch((function(e){return i._reject(e),bt(e)}))}))}function Kn(e,t,n){for(var r=i(e)?e.slice():[e],a=0;a<n;++a)r.push(t);return r}var Fn={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(e){return r(r({},e),{table:function(t){var n=e.table(t),a=n.schema,o={},i=[];function u(e,t,n){var a=yn(e),s=o[a]=o[a]||[],l=null==e?0:"string"==typeof e?1:e.length,c=t>0,f=r(r({},n),{isVirtual:c,isPrimaryKey:!c&&n.isPrimaryKey,keyTail:t,keyLength:l,extractKey:hn(e),unique:!c&&n.unique});(s.push(f),f.isPrimaryKey||i.push(f),l>1)&&u(2===l?e[0]:e.slice(0,l-1),t+1,n);return s.sort((function(e,t){return e.keyTail-t.keyTail})),f}var s=u(a.primaryKey.keyPath,0,a.primaryKey);o[":id"]=[s];for(var l=0,c=a.indexes;l<c.length;l++){var f=c[l];u(f.keyPath,0,f)}function d(t){var n,a,o=t.query.index;return o.isVirtual?r(r({},t),{query:{index:o,range:(n=t.query.range,a=o.keyTail,{type:1===n.type?2:n.type,lower:Kn(n.lower,n.lowerOpen?e.MAX_KEY:e.MIN_KEY,a),lowerOpen:!0,upper:Kn(n.upper,n.upperOpen?e.MIN_KEY:e.MAX_KEY,a),upperOpen:!0})}}):t}return r(r({},n),{schema:r(r({},a),{primaryKey:s,indexes:i,getIndexByKeyPath:function(e){var t=o[yn(e)];return t&&t[0]}}),count:function(e){return n.count(d(e))},query:function(e){return n.query(d(e))},openCursor:function(t){var r=t.query.index,a=r.keyTail,o=r.isVirtual,i=r.keyLength;if(!o)return n.openCursor(t);return n.openCursor(d(t)).then((function(n){return n&&function(n){return Object.create(n,{continue:{value:function(r){null!=r?n.continue(Kn(r,t.reverse?e.MAX_KEY:e.MIN_KEY,a)):t.unique?n.continue(Kn(n.key,t.reverse?e.MIN_KEY:e.MAX_KEY,a)):n.continue()}},continuePrimaryKey:{value:function(t,r){n.continuePrimaryKey(Kn(t,e.MAX_KEY,a),r)}},key:{get:function(){var e=n.key;return 1===i?e[0]:e.slice(0,i)}},value:{get:function(){return n.value}}})}(n)}))}})}})}},Bn={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(e){return r(r({},e),{table:function(t){var n=e.table(t),o=n.schema.primaryKey;return r(r({},n),{mutate:function(e){var i=je.trans,u=i.table(t).hook,s=u.deleting,l=u.creating,c=u.updating;switch(e.type){case"add":if(l.fire===ue)break;return i._promise("readwrite",(function(){return d(e)}),!0);case"put":if(l.fire===ue&&c.fire===ue)break;return i._promise("readwrite",(function(){return d(e)}),!0);case"delete":if(s.fire===ue)break;return i._promise("readwrite",(function(){return d(e)}),!0);case"deleteRange":if(s.fire===ue)break;return i._promise("readwrite",(function(){return function(e){return h(e.trans,e.range,1e4)}(e)}),!0)}return n.mutate(e);function d(e){var t=je.trans,i=e.keys||pn(o,e);if(!i)throw new Error("Keys missing");return"delete"!==(e="add"===e.type||"put"===e.type?r(r({},e),{keys:i,wantResults:!0}):r({},e)).type&&(e.values=a(e.values)),e.keys&&(e.keys=a(e.keys)),function(e,t,n){return"add"===t.type?Promise.resolve(new Array(t.values.length)):e.getMany({trans:t.trans,keys:n})}(n,e,i).then((function(r){var a=i.map((function(n,a){var i=r[a],u={onerror:null,onsuccess:null};if("delete"===e.type)s.fire.call(u,n,i,t);else if("add"===e.type||void 0===i){var d=l.fire.call(u,n,e.values[a],t);null==n&&null!=d&&(n=d,e.keys[a]=n,o.outbound||S(e.values[a],o.keyPath,n))}else{var h=K(i,e.values[a]),p=c.fire.call(u,h,n,i,t);if(p){var v=e.values[a];Object.keys(p).forEach((function(e){f(v,e)?v[e]=p[e]:S(v,e,p[e])}))}}return u}));return n.mutate(e).then((function(t){for(var n=t.failures,o=t.results,u=t.numFailures,s=t.lastResult,l=0;l<i.length;++l){var c=o?o[l]:i[l],f=a[l];null==c?f.onerror&&f.onerror(n[l]):f.onsuccess&&f.onsuccess("put"===e.type&&r[l]?e.values[l]:c)}return{failures:n,results:o,numFailures:u,lastResult:s}})).catch((function(e){return a.forEach((function(t){return t.onerror&&t.onerror(e)})),Promise.reject(e)}))}))}function h(e,t,a){return n.query({trans:e,values:!1,query:{index:o,range:t},limit:a}).then((function(n){var o=n.result;return d({type:"delete",keys:o,trans:e}).then((function(n){return n.numFailures>0?Promise.reject(n.failures[0]):o.length<a?{failures:[],numFailures:0,lastResult:void 0}:h(e,r(r({},t),{lower:o[o.length-1],lowerOpen:!0}),a)}))}))}}})}})}},Yn=function(){function e(t,n){var a=this;this._middlewares={},this.verno=0;var o=e.dependencies;this._options=n=r({addons:e.addons,autoOpen:!0,indexedDB:o.indexedDB,IDBKeyRange:o.IDBKeyRange},n),this._deps={indexedDB:n.indexedDB,IDBKeyRange:n.IDBKeyRange};var i=n.addons;this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null;var u,s={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:ue,dbReadyPromise:null,cancelOpen:ue,openCanceller:null,autoSchema:!0};s.dbReadyPromise=new Fe((function(e){s.dbReadyResolve=e})),s.openCanceller=new Fe((function(e,t){s.cancelOpen=t})),this._state=s,this.name=t,this.on=Bt(this,"populate","blocked","versionchange",{ready:[ve,ue]}),this.on.ready.subscribe=b(this.on.ready.subscribe,(function(t){return function(n,r){e.vip((function(){var e=a._state;if(e.openComplete)e.dbOpenError||Fe.resolve().then(n),r&&t(n);else if(e.onReadyBeingFired)e.onReadyBeingFired.push(n),r&&t(n);else{t(n);var o=a;r||t((function e(){o.on.ready.unsubscribe(n),o.on.ready.unsubscribe(e)}))}}))}})),this.Collection=(u=this,Yt(Xt.prototype,(function(e,t){this.db=u;var n=Nt,r=null;if(t)try{n=t()}catch(e){r=e}var a=e._ctx,o=a.table,i=o.hook.reading.fire;this._ctx={table:o,index:a.index,isPrimKey:!a.index||o.schema.primKey.keyPath&&a.index===o.schema.primKey.name,range:n,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:r,or:a.or,valueMapper:i!==se?i:null}}))),this.Table=function(e){return Yt(Ft.prototype,(function(t,n,r){this.db=e,this._tx=r,this.name=t,this.schema=n,this.hook=e._allTables[t]?e._allTables[t].hook:Bt(null,{creating:[fe,ue],reading:[le,se],updating:[he,ue],deleting:[de,ue]})}))}(this),this.Transaction=function(e){return Yt(ln.prototype,(function(t,n,r,a){var o=this;this.db=e,this.mode=t,this.storeNames=n,this.schema=r,this.idbtrans=null,this.on=Bt(this,"complete","error","abort"),this.parent=a||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new Fe((function(e,t){o._resolve=e,o._reject=t})),this._completion.then((function(){o.active=!1,o.on.complete.fire()}),(function(e){var t=o.active;return o.active=!1,o.on.error.fire(e),o.parent?o.parent._reject(e):t&&o.idbtrans&&o.idbtrans.abort(),bt(e)}))}))}(this),this.Version=function(e){return Yt(Tn.prototype,(function(t){this.db=e,this._cfg={version:t,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}}))}(this),this.WhereClause=function(e){return Yt(rn.prototype,(function(t,n,r){this.db=e,this._ctx={table:t,index:":id"===n?null:n,or:r};var a=e._deps.indexedDB;if(!a)throw new ae.MissingAPI("indexedDB API missing");this._cmp=this._ascending=a.cmp.bind(a),this._descending=function(e,t){return a.cmp(t,e)},this._max=function(e,t){return a.cmp(e,t)>0?e:t},this._min=function(e,t){return a.cmp(e,t)<0?e:t},this._IDBKeyRange=e._deps.IDBKeyRange}))}(this),this.on("versionchange",(function(e){e.newVersion>0?console.warn("Another connection wants to upgrade database '"+a.name+"'. Closing db now to resume the upgrade."):console.warn("Another connection wants to delete database '"+a.name+"'. Closing db now to resume the delete request."),a.close()})),this.on("blocked",(function(e){!e.newVersion||e.newVersion<e.oldVersion?console.warn("Dexie.delete('"+a.name+"') was blocked"):console.warn("Upgrade '"+a.name+"' blocked by other connection holding version "+e.oldVersion/10)})),this._maxKey=on(n.IDBKeyRange),this._createTransaction=function(e,t,n,r){return new a.Transaction(e,t,n,r)},this._fireOnBlocked=function(e){a.on("blocked").fire(e),Ct.filter((function(e){return e.name===a.name&&e!==a&&!e._state.vcFired})).map((function(t){return t.on("versionchange").fire(e)}))},this.use(Fn),this.use(Bn),i.forEach((function(e){return e(a)}))}return e.prototype.version=function(e){if(isNaN(e)||e<.1)throw new ae.Type("Given version is not a positive number");if(e=Math.round(10*e)/10,this.idbdb||this._state.isBeingOpened)throw new ae.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,e);var t=this._versions,n=t.filter((function(t){return t._cfg.version===e}))[0];return n||(n=new this.Version(e),t.push(n),t.sort(On),n.stores({}),this._state.autoSchema=!1,n)},e.prototype._whenReady=function(e){var t=this;return this._state.openComplete||je.letThrough?e():new Fe((function(e,n){if(!t._state.isBeingOpened){if(!t._options.autoOpen)return void n(new ae.DatabaseClosed);t.open().catch(ue)}t._state.dbReadyPromise.then(e,n)})).then(e)},e.prototype.use=function(e){var t=e.stack,n=e.create,r=e.level,a=e.name;a&&this.unuse({stack:t,name:a});var o=this._middlewares[t]||(this._middlewares[t]=[]);return o.push({stack:t,create:n,level:null==r?10:r,name:a}),o.sort((function(e,t){return e.level-t.level})),this},e.prototype.unuse=function(e){var t=e.stack,n=e.name,r=e.create;return t&&this._middlewares[t]&&(this._middlewares[t]=this._middlewares[t].filter((function(e){return r?e.create!==r:!!n&&e.name!==n}))),this},e.prototype.open=function(){return Rn(this)},e.prototype.close=function(){var e=Ct.indexOf(this),t=this._state;if(e>=0&&Ct.splice(e,1),this.idbdb){try{this.idbdb.close()}catch(e){}this.idbdb=null}this._options.autoOpen=!1,t.dbOpenError=new ae.DatabaseClosed,t.isBeingOpened&&t.cancelOpen(t.dbOpenError),t.dbReadyPromise=new Fe((function(e){t.dbReadyResolve=e})),t.openCanceller=new Fe((function(e,n){t.cancelOpen=n}))},e.prototype.delete=function(){var e=this,t=arguments.length>0,n=this._state;return new Fe((function(r,a){var o=function(){e.close();var t=e._deps.indexedDB.deleteDatabase(e.name);t.onsuccess=$e((function(){kn.remove(e.name),r()})),t.onerror=un(a),t.onblocked=e._fireOnBlocked};if(t)throw new ae.InvalidArgument("Arguments not allowed in db.delete()");n.isBeingOpened?n.dbReadyPromise.then(o):o()}))},e.prototype.backendDB=function(){return this.idbdb},e.prototype.isOpen=function(){return null!==this.idbdb},e.prototype.hasBeenClosed=function(){var e=this._state.dbOpenError;return e&&"DatabaseClosed"===e.name},e.prototype.hasFailed=function(){return null!==this._state.dbOpenError},e.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(e.prototype,"tables",{get:function(){var e=this;return o(this._allTables).map((function(t){return e._allTables[t]}))},enumerable:!0,configurable:!0}),e.prototype.transaction=function(){var e=Dn.apply(this,arguments);return this._transaction.apply(this,e)},e.prototype._transaction=function(e,t,n){var r=this,a=je.trans;a&&a.db===this&&-1===e.indexOf("!")||(a=null);var o,i,u=-1!==e.indexOf("?");e=e.replace("!","").replace("?","");try{if(i=t.map((function(e){var t=e instanceof r.Table?e.name:e;if("string"!=typeof t)throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return t})),"r"==e||e===Rt)o=Rt;else{if("rw"!=e&&e!=jt)throw new ae.InvalidArgument("Invalid transaction mode: "+e);o=jt}if(a){if(a.mode===Rt&&o===jt){if(!u)throw new ae.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");a=null}a&&i.forEach((function(e){if(a&&-1===a.storeNames.indexOf(e)){if(!u)throw new ae.SubTransaction("Table "+e+" not included in parent transaction.");a=null}})),u&&a&&!a.active&&(a=null)}}catch(e){return a?a._promise(null,(function(t,n){n(e)})):bt(e)}var s=Nn.bind(null,this,o,i,a,n);return a?a._promise(o,s,"lock"):je.trans?pt(je.transless,(function(){return r._whenReady(s)})):this._whenReady(s)},e.prototype.table=function(e){if(!f(this._allTables,e))throw new ae.InvalidTable("Table "+e+" does not exist");return this._allTables[e]},e}(),Ln=Yn;d(Ln,r(r({},ie),{delete:function(e){return new Ln(e).delete()},exists:function(e){return new Ln(e,{addons:[]}).open().then((function(e){return e.close(),!0})).catch("NoSuchDatabaseError",(function(){return!1}))},getDatabaseNames:function(e){return kn?kn.getDatabaseNames().then(e):Fe.resolve([])},defineClass:function(){return function(e){s(this,e)}},ignoreTransaction:function(e){return je.trans?pt(je.transless,e):e()},vip:Mn,async:function(e){return function(){try{var t=jn(e.apply(this,arguments));return t&&"function"==typeof t.then?t:Fe.resolve(t)}catch(e){return bt(e)}}},spawn:function(e,t,n){try{var r=jn(e.apply(n,t||[]));return r&&"function"==typeof r.then?r:Fe.resolve(r)}catch(e){return bt(e)}},currentTransaction:{get:function(){return je.trans||null}},waitFor:function(e,t){var n=Fe.resolve("function"==typeof e?Ln.ignoreTransaction(e):e).timeout(t||6e4);return je.trans?je.trans.waitFor(n):n},Promise:Fe,debug:{get:function(){return q},set:function(e){V(e,"dexie"===e?function(){return!0}:Tt)}},derive:v,extend:s,props:d,override:b,Events:Bt,getByKeyPath:P,setByKeyPath:S,delByKeyPath:x,shallowClone:C,deepClone:R,getObjectDiff:K,asap:E,minKey:Pt,addons:[],connections:Ct,errnames:ne,dependencies:function(){try{return{indexedDB:u.indexedDB||u.mozIndexedDB||u.webkitIndexedDB||u.msIndexedDB,IDBKeyRange:u.IDBKeyRange||u.webkitIDBKeyRange}}catch(e){return{indexedDB:null,IDBKeyRange:null}}}(),semVer:Et,version:Et.split(".").map((function(e){return parseInt(e)})).reduce((function(e,t,n){return e+t/Math.pow(10,2*n)})),default:Ln,Dexie:Ln})),Ln.maxKey=on(Ln.dependencies.IDBKeyRange),function(e){try{kn=function(e){var t,n=e&&"function"==typeof e.databases;if(!n){var r=new Yn(Mt,{addons:[]});r.version(1).stores({dbnames:"name"}),t=r.table("dbnames")}return{getDatabaseNames:function(){return n?Fe.resolve(e.databases()).then((function(e){return e.map((function(e){return e.name})).filter((function(e){return e!==Mt}))})):t.toCollection().primaryKeys()},add:function(e){return!n&&e!==Mt&&t.put({name:e}).catch(ue)},remove:function(e){return!n&&e!==Mt&&t.delete(e).catch(ue)}}}(e)}catch(e){}}(Yn.dependencies.indexedDB),Fe.rejectionMapper=function(e,t){if(!e||e instanceof Z||e instanceof TypeError||e instanceof SyntaxError||!e.name||!oe[e.name])return e;var n=new oe[e.name](t||e.message,e);return"stack"in e&&p(n,"stack",{get:function(){return this.inner.stack}}),n},V(q,Tt),t.default=Yn},7677:e=>{"use strict";e.exports=function(e,t,n,r,a,o,i,u){if(!e){var s;if(void 0===t)s=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var l=[n,r,a,o,i,u],c=0;(s=new Error(t.replace(/%s/g,(function(){return l[c++]})))).name="Invariant Violation"}throw s.framesToPop=1,s}}},1449:(e,t)=>{"use strict";t.Z=_;var n,r="undefined"!=typeof Promise?Promise:null,a=0,o=[],i=[],u=[],s={sentinel:"CONTINUE_AS_IF_NO_HANDLER"},l={sentinel:"RETRY_ASYNCHRONOUSLY"},c={sentinel:"TO_STRING"},f={sentinel:"DID_ERROR"},d=null,h=[],p=16,v=64,m=128,y=512;function _(e,t){this._flags=0,this._value=void 0,this._onFulfilled=void 0,this._onRejected=void 0,this._context=void 0,this._resolveLevel=0,this._control=void 0,this.x=void 0,this._thenableParent=null,this._parent=void 0,this._child=void 0,this._children=void 0,this.control=void 0,t&&(this._context=t.this),"function"==typeof e&&(this._onFulfilled=e,this._flags|=4,this._flags|=256,W(e,this._context,(e=>K(this,0,!0,!1,e)),(e=>K(this,0,!1,!1,e))))}function g(e){if(void 0===e)return n;if(D(e))return e;var t=new _;return K(t,0,!0,!1,e),H(t,y),t}function b(e){var t=new _;return t._value=e,H(t,514),h.push(t),t}function w(e){var t=arguments.length-1;if(0===t)return this.then(void 0,e);for(var n=new Array(t),r=0;r<t;r++)n[r]=Y(arguments[r]);var a=L(n,arguments[t]),o=N(this,void 0,a);return o._onRejected&&H(o,m),o}function E(e,t){this.errors=e||[],this.message=t||"".concat(this.errors.length," errors")}function O(e){var t="";if(e._flags&m)t=(e._onFulfilled||e._onRejected).call(e._context,c);else if(e._control)t=".addRawControl(".concat(e._control.name,", ").concat(e._control.foo,")");else if(e._flags&p)t=".endWithControls(".concat(Object.keys(e.control),")");else if(e._flags&y)t=1&e._flags?"Promise.resolve(".concat(void 0===e._value?"":e._value,")"):"Promise.reject(".concat(void 0===e._value?"":e._value,")");else if(256&e._flags)switch(3&e._flags){case 2:case 0:case 1:t="new Promise(".concat(e._onFulfilled,")")}else e._onFulfilled&&e._onRejected?t=".then(".concat(e._onFulfilled,", ").concat(e._onRejected,")"):e._onFulfilled?t=".then(".concat(e._onFulfilled,")"):e._onRejected&&(t=".catch(".concat(e._onRejected,")"));return t}function P(e){this.message=e||"StackPromise timed out"}function S(e,t,n,r){this.name=e,this.foo=t,this.lightning=!!n,this.canRunMultipleTimes=!!r}function x(e,t){return function(){for(var n,r,a=e._parent;a&&!(3&a._flags)&&!(a._flags&p);a=a._parent)!a._control||a._control.name!==t||4&a._flags||(n=a);if(!n)return _.NO_ACTIVE_CONTROL;if(n._control.canRunMultipleTimes||H(n,4),arguments.length>0){r=new Array(arguments.length);for(var o=0;o<arguments.length;o++)r[o]=arguments[o]}return n._control.foo.call(n._context,(e=>F(n,n._resolveLevel,!0,!1,e)),(e=>F(n,n._resolveLevel,!1,!1,e)),n._parent,r)}}function C(e){this.message=e,this.stack=new Error(e||this.name).stack}_.resolve=g,_.reject=b,_.prototype.then=function(e,t){"function"!=typeof e&&(e=void 0),"function"!=typeof t&&(t=void 0);var n=new _;n._onFulfilled=e,n._onRejected=t,n._context=this._context,this._flags&v&&H(n,v);var r=3&this._flags;return 0===r?M(this,n):(H(this,8),(1===r?e:t)?(n._parent=this,i.push(n),k()):(n._parent=this,H(n,r),n._value=this._value,2===r&&h.push(n))),n},_.prototype.catch=w,_.prototype.catchType=w,_.prototype.catchTypes=w,_.prototype.catchTypes3=w,_.prototype.catchEqualTo=w,_.prototype.catchConditional=w,_.prototype.end=function(e){var t=this.then();if(H(t,p),t.control={},t._context=void 0,e){var n=e.controls;if(n)for(var r=0;r<n.length;r++){var a=n[r];t.control[a]=x(t,a)}return t}},_.prototype.endWithControls=function(){var e=this.then();H(e,p),e.control={},e._context=void 0;for(var t=0;t<arguments.length;t++){var n=arguments[t];e.control[n]=x(e,n)}return e},_.all=function(e){return new _((function(t,n){var r=e.length;if(0!==r)for(var a=new Array(e.length),o=0;o<e.length;o++)a[o]=N(e[o],i,n);else t([]);function i(e){if(0==--r){for(var n=[],o=0;o<a.length;o++){var i=a[o];n.push(i&&3&i._flags?i._value:e)}t(n)}return e}}))},_.allSettled=function(e){return new _((function(t){var n=Array.from(e),r=n.length;if(0!==r)for(var a=new Array(n.length),o=s(!1),i=s(!0),u=0;u<n.length;u++)a[u]=N(n[u],o,i);else t([]);function s(e){return function(n){var o=e?{status:"rejected",reason:n}:{status:"fulfilled",value:n};if(0==--r){for(var i=[],u=0;u<a.length;u++){var s=a[u];i.push(s&&3&s._flags?s._value:o)}t(i)}return o}}}))},_.any=function(e){return new _((function(t,n){var r=e.length;0===r&&n(new E([],"StackPromise.any called with []"));var a=new Array(e.length);function o(e){if(0==--r){for(var t=[],o=0;o<a.length;o++){var i=a[o];t.push(i&&3&i._flags?i._value:e)}n(new E(t))}return e}for(var i=0;i<e.length;i++)a[i]=N(e[i],t,o)}))},_.props=function(e){var t=Object.keys(e),n=_.all(t.map((t=>e[t])));function r(e){for(var n={},r=0;r<e.length;r++)n[t[r]]=e[r];return n}switch(3&n._flags){case 2:return n;case 0:return H(n.then(r),32);case 1:return n._value=r(n._value),n}},_.reduce=function(e,t,n){return g(e).reduce(t,n)},_.prototype.reduce=function(e,t){return t=j(t),N(this,(function(n,r){if(0===n.length)return t;if(r)return l;for(var a=new Array(n.length),o=0;o<n.length;o++){var i=a[o]=j(n[o]);D(i)&&H(i,8)}var u=this,s=0;return function n(){for(var r=a.length;;){var o=s,i=a[o];if(D(i))switch(3&i._flags){case 2:return i;case 0:return i.then(n);case 1:i=i._value}if(D(t))switch(3&t._flags){case 2:return t;case 0:return t.then(n);case 1:t=t._value}var l=e.call(u,t,i,o,r);if(++s===r)return l;if(D(l=j(l)))switch(3&l._flags){case 2:return l;case 0:return t=l,l.then(n);case 1:H(l,8),t=l._value}else t=l}}()}))},_.each=function(e,t){return g(e).each(t)},_.prototype.each=function(e){var t=[];return this.reduce((function(n,r,a,o){return t.push(r),e.call(this,r,a,o)})).then((()=>t))},_.race=function(e){var t=j(e);if(D(t)){var n=t.then((e=>_.race(e)));return n._context=void 0,n._flags&=-65,n}return new _((function(e,n){for(var r=0;r<t.length;r++){var a=j(t[r]);if(!D(a)||3&a._flags)for(e(a),r++;r<t.length;r++){var o=t[r];D(o)&&H(o,8)}else a.then(e,n)}}))},E.prototype=Object.create(Error.prototype,{name:{value:"AggregateError"}}),_.AggregateError=E,_.onPossiblyUnhandledRejection=function(e,t){console.error("StackPromise did not catch ".concat(e),t,e)},_.prototype.toString=function(){for(var e,t=[],n=this,r=!1;n;n=n._parent){e=n,!r&&3&n._flags&&(r=!0,n._flags&y||(1&n._flags?t.push("[resolved value: ".concat(n._value,"]")):t.push("[rejected reason: ".concat(n._value,"]"))));var a=O(n);1024&n._flags&&(a="~".concat(a)),t.push(a)}return t.reverse(),768&e._flags||(t[0]="[Promise]".concat(t[0])),t.join("\n")},_.prototype.timeout=function(e,t){if(0!=(3&this._flags))return this.then();var n;function r(r){return r===c?".timeout(".concat(e,", ").concat(t,")"):(clearTimeout(n),s)}var a=this.then(r,r);return H(a,160),n=setTimeout((function(e,t){3&e._flags||F(e,0,!1,!1,t instanceof Error?t:new P(t))}),e,a,t),a},P.prototype=Object.create(Error.prototype,{name:{value:"TimeoutError"}}),_.TimeoutError=P,_.prototype.isFulfilled=function(){return!!(1&this._flags)},_.prototype.isRejected=function(){return!!(2&this._flags)},_.prototype.isPending=function(){return!(3&this._flags)},_.prototype.value=function(){if(1&this._flags)return this._value;throw new Error(2&this._flags?"value() called on StackPromise that was rejected":"value() called on StackPromise that is pending")},_.prototype.reason=function(){if(2&this._flags)return this._value;throw new Error(1&this._flags?"reason() called on StackPromise that was fulfilled, not rejected":"reason() called on StackPromise that is pending")},_.loop=function(e,t){return g(t).loop(e)},_.prototype.loop=function(e){var t=N(this.then((function(n){var r=this,a=0,o=e=>F(t,0,!0,!1,e);return function n(i){return new _((function(t){t(e.call(r,o,i,a++))})).then((function(e){if(!(3&t._flags))return n(e)}))}(n)})),(function(t){return t===c?".loop(".concat(e,")"):s}));return H(t,m),t},_.prototype.checkpoint=function(e){function t(t){return t===c?".checkpoint(".concat(e,")"):2&e._flags?e:s}e=g(e);var n=this.then(t,t);return H(n,m),n},_.prototype.finally=function(e){function t(t){return t===c?".finally(".concat(e,")"):(e.call(this,t),s)}return H(this.then(t,t),m)},_.prototype.get=function(e){var t=this.then((function(t){return t===c?".get('".concat(e,"')"):t[e]}));return H(t,m),t},_.prototype.tap=function(e){return H("function"!=typeof e?this.then(T):this.then((function(t){return t===c?".tap(".concat(e,")"):(e.call(this,t),s)})),m)},_.prototype.spread=function(e){var t=this.then((function(t){return t===c?".spread(".concat(e,")"):e.apply(this,t)}));return H(t,m),t},_.prototype.throw=function(e){return this.then((()=>b(e)))},_.Control=S,_.NO_ACTIVE_CONTROL=new Error("No active control was found."),_.prototype.addControl=function(e){if(!(e instanceof S))throw new Error("addControl must be given Control, but got ".concat(e));var t=this.then(e.lightning?void 0:T);return t._control=e,t},_.prototype.addRawControl=function(e,t,n,r){return this.addControl(new S(e,t,n,r))},_.prototype.addResolveControl=function(e,t,n,r){return this.addControl(new S(e,(function(e,n,r,a){try{e(t.apply(this,a))}catch(e){n(e)}}),n,r))},_.prototype.addRejectControl=function(e,t,n,r){return this.addControl(new S(e,(function(e,n,r,a){try{n(t.apply(this,a))}catch(e){n(e)}}),n,r))},C.prototype=Object.create(Error.prototype,{name:{value:"CancellationError"}}),_.CancellationError=C;var I,A=new S("cancel",(function(e,t,n,r){t(new C(r&&r[0]))}),!1,!1);function k(){var e,t;0===a&&(i.length||h.length)&&(a=1,I||(t=0,I="undefined"==typeof MutationObserver||self&&self.navigator&&self.navigator.standalone?r?function(){r.resolve().then(z)}:"function"==typeof setImmediate?function(){setImmediate(z)}:function(){setTimeout(z,0)}:(e=document.createTextNode(""),new MutationObserver(z).observe(e,{characterData:!0}),function(){e.data=t=1-t})),I())}function T(e){return e===c?".tap()":s}function M(e,t){H(e,8),t._parent=e,e._children?e._children.push(t):e._child?(e._children=[e._child,t],e._child=void 0):e._child=t}function R(e){if(e&&("object"==typeof e||"function"==typeof e)){var t;try{t=e.then}catch(e){return d=e,f}if("function"==typeof t)return t}}function j(e){if(!e||D(e))return e;var t=R(e);if(t===f)return b(d);if(t){var n=new _((function(n,r){t.call(e,n,r)}));return n._thenableParent=e,n}return e}function D(e){return e instanceof _}function N(e,t,n){var r,a,o,i,u=D(e=j(e)),c=!1;if(u){if(!(3&e._flags))return H(e.then(t,n),32);H(e,8),c=!!(e._flags&v),o=e._context,r=1&e._flags?t:n,a=e._value}else r=t,a=e;if(!r)return g(e).then();if((a=X(r,o,a,!0))===f)i=b(d);else{if(a===l)return g(e).then(t,n);if(a===s)return u?e.then():g(e);i=g(a)}return c&&(i=i.cancellable()),void 0!==o&&((i=i.then())._context=o),i}function K(e,t,n,r,a){if(t===e._resolveLevel){var o=++e._resolveLevel;if(H(e,4),e._thenableParent=null,n)if(a===e)e._parent=void 0,U(e,!1,r,new TypeError("promise resolved to itself"));else if(D(a)){var i=3&a._flags;0===i?M(a,e):(e._parent=a,H(e,1024),H(a,8),U(e,1===i,r,a._value))}else{var u=R(a);u===f?(e._parent=void 0,U(e,!1,r,d)):u?(e._parent=void 0,e._thenableParent=a,W(u,a,(t=>K(e,o,!0,!1,t)),(t=>K(e,o,!1,!1,t)))):U(e,!0,r,a)}else U(e,!1,r,a)}}function F(e,t,n,r,a){t===e._resolveLevel&&(B(e),K(e,t,n,r,a))}function B(e){if(e._parent){var t=e._parent;if(e._parent=void 0,t._child===e)t._child=void 0;else if(t._children){for(var n=t._children,r=0;r<n.length;r++)if(n[r]===e){n.splice(r,1);break}0===n.length&&(t._children=void 0)}}}function Y(e){if(null==e)throw new Error("Invalid .catch guard ".concat(e));if("function"==typeof e)return e;if("object"==typeof e)throw new Error("Object guards in .catch are currently unsupported");return function(t){return t===e}}function L(e,t){return function(n,r){return n===c?".catch(..., ".concat(t,")"):e&&!function(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(r===Error||r.prototype instanceof Error){if(t instanceof r)return!0}else if(r(t))return!0}return!1}(e,n)?s:r?l:t.call(this,n)}}function U(e,t,n,r){if(H(e,4|(t?1:2)),e._value=r,e._child)q(e._child,t,n,r),e._child=void 0;else if(e._children){var a=e._children;e._children=void 0;for(var o=0;o<a.length;o++)q(a[o],t,n,r)}else t||8&e._flags||h.push(e)}function q(e,t,n,r){e._resolveLevel++;var a=G(e,t);if(a&&32&e._flags){H(e,4);var o=X(a,e._context,r,!0);if(o!==l)return void(o===f?(e._parent=void 0,U(e,!1,n,d)):o===s?U(e,t,n,r):(e._parent=void 0,K(e,e._resolveLevel,!0,n,o)));e._flags&=-5}a?((n?u:i).push(e),k()):U(e,t,n,r)}function V(e,t){for(;0!==e.length;)t.push(e.pop())}function z(){for(;0!==o.length||0!==i.length;){0===o.length&&V(i,o);var e=o.pop(),t=e._parent,n=!!(t&&1&t._flags),r=t&&t._value,c=G(e,n);if(H(e,4),c){var p=void 0;do{p=X(c,e._context,r,!1)}while(p===l);p===f?(r=d,n=!1,e._parent=void 0):p!==s&&(r=p,n=!0,e._parent=void 0)}3&e._flags||(K(e,e._resolveLevel,n,!0,r),V(u,o))}for(a--;0!==h.length;){var v=h.pop();8&v._flags||_.onPossiblyUnhandledRejection(v._value,v)}}function W(e,t,n,r){try{e.call(t,n,r)}catch(e){r(e)}}function G(e,t){if(!(4&e._flags))return t?e._onFulfilled:e._onRejected}function X(e,t,n,r){try{return r?e.call(t,n,!0):e.call(t,n)}catch(e){return d=e,f}}function H(e,t){return e._flags|=t,e}_.prototype.addCancelControl=function(){return H(this.addControl(A),v)},_.sit=function(e,t){var n=new _;return n._control=new S(e,(function(e,n,r,a){e(t?t.apply(void 0,a):a&&a[0])})),n},_.prototype.cancellable=function(){return H(this.then(),v)},_.prototype.uncancellable=function(){var e=this.then();return e._flags&=-65,e},_.prototype.cancel=function(e){for(var t,n=this;n&&!(3&n._flags);n=n._parent)n._flags&v&&(t=n);if(t)if(void 0===e&&(e=new C),G(t,!1)){var r=new _;B(t),M(r,t),F(r,0,!1,!1,e)}else F(t,t._resolveLevel,!1,!1,e)},K(n=new _,0,!0,!1,void 0)},3487:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SyncDataType=t.ConflictResolutionState=t.SyncModelType=t.SyncActionState=t.CollectionSyncState=t.CollectionState=t.CollectionName=t.Actions=t.LABEL_ASSOCIATION_SYNC_VERSION=t.DEFAULT_COLLECTION_VERSION=t.MAX_PATCH_SIZE=t.MIN_PATCH_SIZE=t.MAX_INLINE_MUTATIONS=t.MIN_INLINE_MUTATIONS=t.FINITE_FAILURE_EXPIRY_DURATION=t.BACKOFF_BASE=t.BACKOFF_MAX_TIMEOUT=t.BACKOFF_MIN_TIMEOUT=void 0;t.BACKOFF_MIN_TIMEOUT=1e3;t.BACKOFF_MAX_TIMEOUT=36e5;t.BACKOFF_BASE=2;t.FINITE_FAILURE_EXPIRY_DURATION=6048e5;t.MIN_INLINE_MUTATIONS=100;t.MAX_INLINE_MUTATIONS=2e3;t.MIN_PATCH_SIZE=10;t.MAX_PATCH_SIZE=100;t.DEFAULT_COLLECTION_VERSION=0;t.LABEL_ASSOCIATION_SYNC_VERSION=3;var r=n(8103)({Star:"star",Contact:"contact",Mute:"mute",Pin:"pin",SettingPushName:"setting_pushName",LabelEdit:"label_edit",LabelMessage:"label_message",LabelJid:"label_jid",QuickReply:"quick_reply",LocaleSetting:"setting_locale",Archive:"archive",MarkChatAsRead:"markChatAsRead",ClearChat:"clearChat",DeleteMessageForMe:"deleteMessageForMe",Sentinel:"sentinel"});t.Actions=r;var a=n(8103)({Generic:"generic",Regular:"regular",RegularLow:"regular_low",RegularHigh:"regular_high",CriticalBlock:"critical_block",CriticalUnblockLow:"critical_unblock_low"});t.CollectionName=a;var o=n(8103).Mirrored(["Success","SuccessHasMore","Conflict","ErrorRetry","ErrorFatal","Blocked"]);t.CollectionState=o;var i=n(8103).Mirrored(["UpToDate","Dirty","FailingFiniteRetry","Fatal","Blocked"]);t.CollectionSyncState=i;var u=n(8103).Mirrored(["Success","Malformed","Orphan","Unsupported","Skipped","Failed"]);t.SyncActionState=u;var s=n(8103).Mirrored(["Msg","Chat"]);t.SyncModelType=s;var l=n(8103).Mirrored(["ApplyRemoteAndDropLocal","SkipRemote","SkipRemoteAndDropLocal"]);t.ConflictResolutionState=l;var c=n(8103).Mirrored(["Patch","Snapshot"]);t.SyncDataType=c},7620:(e,t,n)=>{"use strict";var r=n(4859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(n(7677)),o=r(n(1941));var i=new class{init(){return this._promise||(this._promise=new Promise((e=>{this._resolver=e})).timeout(5e3)),this._promise}isConnected(){return null!=this._port}getPort(){return this._port}waitForConnection(){return(0,o.default)(this._promise,"ConnectionManager Initialization Promise")}connectVia(e){if(this.isConnected())throw new Error("Connection already established");(0,a.default)(this._resolver,"ConnectionManager not initialized"),this._port=e,this._resolver()}};t.default=i},6936:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={isLogoutInProgress:!1}},4391:(e,t,n)=>{"use strict";var r=n(4859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(n(7677)),o=n(1800),i=n(7110),u=r(n(1941)),s=n(4012);var l=new class{constructor(){this._pending=new Map,this._onResponseReceipt=e=>{var t=(0,s.unwrapResponsePayload)(e.data);if(null!=t){var{invocationId:n,result:r}=t;if(this._pending.has(n)){var{resolve:a}=(0,u.default)(this._pending.get(n),"this._pending.get(invocationId)");a(r),this._pending.delete(n)}}}}setConnectionManager(e){this._conn=e,e.waitForConnection().then((()=>{var t=(0,u.default)(e.getPort(),"Port obtained from ConnectionManager after connection");t.addEventListener("message",this._onResponseReceipt),t.start()}))}invoke(e,t){return(0,a.default)(this._conn,"Connection has not been inited"),this._conn.waitForConnection().then((()=>{(0,a.default)(this._conn,"Connection has not been inited");var n=(0,u.default)(this._conn.getPort(),"Port obtained from ConnectionManager after connection"),r=(0,i.genInvocationId)();return n.postMessage((0,o.buildInvocationPayload)({invocationId:r,method:e,args:t})),new Promise(((e,t)=>{this._pending.set(r,{resolve:e,reject:t})}))}))}};t.default=l},2929:(e,t,n)=>{"use strict";var r=n(3291);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n(1800),o=r(n(9458)),i=n(4012);var u=new class{constructor(){this._onMessage=(e,t)=>{var n=t.data,r=(0,a.unwrapInvocationPayload)(n);if(null!=r){var{method:u,args:s,invocationId:l}=r;o.get()[u](...s).then((t=>{e.postMessage((0,i.buildResponsePayload)(l,t))}))}}}respondTo(e){e.addEventListener("message",(t=>this._onMessage(e,t))),e.start()}};t.default=u},7110:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.genInvocationId=function(){return n++},t.extractInvocationId=function(e){if(null!=e&&"number"==typeof e)return e};var n=1},9458:(e,t,n)=>{"use strict";var r=n(4859);Object.defineProperty(t,"__esModule",{value:!0}),t.set=function(e){a=e},t.get=s,t.sendLogs=function(){throw new Error("Not yet implemented")},t.log=void 0;var a,o=r(n(6890)),i=r(n(1985)),u=r(n(1941));function s(){return(0,u.default)(a,"InvocationInterface was not inited")}var l=(0,i.default)(((e,t=!1,n,r,a)=>(i,...u)=>{var l,c=(0,o.default)(i,u,!t);return n&&(l={name:n.name,stack:n.stack}),s().logImpl(e,c,l,r,a),c}),((e,t,n,r,a)=>n||a?null:String(e)+String(Boolean(t))+String(Boolean(r))));t.log=l},3141:(e,t,n)=>{"use strict";var r=n(4859);Object.defineProperty(t,"__esModule",{value:!0}),t.buildHandshakePayload=function(e){return{__command:o.HANDSHAKE_COMMAND,__port:e}},t.extractPortFromHandshakePayload=function(e){if(null!=e&&null!=e.__command&&e.__command===o.HANDSHAKE_COMMAND){if(null!=e.__port)return(0,a.default)(e.__port instanceof MessagePort,"Malformed connection payload"),e.__port}};var a=r(n(7677)),o=n(4624)},1800:(e,t,n)=>{"use strict";var r=n(4859);Object.defineProperty(t,"__esModule",{value:!0}),t.buildInvocationPayload=function({invocationId:e,method:t,args:n}){return{__id:e,__command:i.INVOCATION_COMMAND,__method:t,__args:n}},t.unwrapInvocationPayload=function(e){if(null!=e&&e.__command===i.INVOCATION_COMMAND){(0,a.default)(e.__id,"Invocation ID missing");var t=(0,o.extractInvocationId)(e.__id);(0,a.default)(null!=t&&e.__method&&"string"==typeof e.__method&&e.__id&&e.__args&&Array.isArray(e.__args),"Malformed invocation message");var n=e,r=n.__method,u=n.__args;return{method:r,args:u,invocationId:t}}};var a=r(n(7677)),o=n(7110),i=n(4624)},4012:(e,t,n)=>{"use strict";var r=n(4859);Object.defineProperty(t,"__esModule",{value:!0}),t.buildResponsePayload=function(e,t){return{__id:e,__command:i.RESPONSE_COMMAND,__result:t}},t.unwrapResponsePayload=function(e){if(null!=e&&e.__command===i.RESPONSE_COMMAND){(0,a.default)(null!=e.__id,"Invocation ID missing");var t=(0,o.extractInvocationId)(e.__id);return(0,a.default)(null!=t&&e.hasOwnProperty("__result"),"Malformed response message"),{result:e.__result,invocationId:t}}};var a=r(n(7677)),o=n(7110),i=n(4624)},4624:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RESPONSE_COMMAND=t.INVOCATION_COMMAND=t.HANDSHAKE_COMMAND=void 0;t.HANDSHAKE_COMMAND="@@handshake";t.INVOCATION_COMMAND="@@invoke";t.RESPONSE_COMMAND="@@response"},2186:(e,t,n)=>{"use strict";var r=n(3291),a=n(4859);t.Z=function(){o||((0,i.default)("undefined"!=typeof DedicatedWorkerGlobalScope&&self instanceof DedicatedWorkerGlobalScope,"Connect can only be called in WebWorker scope"),self.addEventListener("message",v),o=Promise.resolve(u.default.init()),c.default.setConnectionManager(u.default),d.set(s.default));return(0,h.default)(o,"connection")};var o,i=a(n(7677)),u=a(n(7620)),s=a(n(1612)),l=n(3141),c=a(n(4391)),f=a(n(2929)),d=r(n(9458)),h=a(n(1941)),p=[];function v(e){var t=e.data;if(!u.default.isConnected()){var n=(0,l.extractPortFromHandshakePayload)(t);if(null!=n)return u.default.connectVia(n),e.stopImmediatePropagation(),f.default.respondTo(n),void(0,h.default)(o,"connection").then((()=>{(0,i.default)("undefined"!=typeof DedicatedWorkerGlobalScope&&self instanceof DedicatedWorkerGlobalScope,"Connect can only be called in WebWorker scope"),self.removeEventListener("message",v),p.forEach((e=>{self.dispatchEvent(e)}))}))}p.push(e)}},1612:(e,t,n)=>{"use strict";var r=n(4859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(n(6936)),o=n(3012),i=r(n(4391)),u={whoAmI:()=>i.default.invoke("whoAmI",[]),logImpl:(e,t,n,r,a)=>i.default.invoke("logImpl",[e,t,n,r,a]),initFromStorage:()=>(0,o.init)(),setLogoutState:e=>(a.default.isLogoutInProgress=e,Promise.resolve())};t.default=u},2206:(e,t,n)=>{"use strict";var r=n(4859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(n(9976)),o=r(n(2954)),i=r(n(5363)),u=r(n(7677)),s=(n(522),r(n(1941))),l=n(1054);function c(){var e=(0,a.default)(["Operation "," failed with args: ",""]);return c=function(){return e},e}function f(){var e=(0,a.default)(["idb faild to do Operation: "," on Table: ",". Failed with error ",""]);return f=function(){return e},e}var d=n(1449).Z;function h(){return(h=(0,o.default)((function*(){throw new Error("feature is not yet implemented")}))).apply(this,arguments)}function p(){return(p=(0,o.default)((function*(){throw new Error("feature is not yet implemented")}))).apply(this,arguments)}class v{constructor(e,t,n,r,a,o){this.table=e,this.view=n,this.db=t,this.propFilter=r,this.tableEncryptedColumns=new Map(Object.keys(a).map((e=>[e,a[e]]))),this.shouldUseDbMsgEncKeyForEncryptedCol=o}asyncView(e){var t=this;return(0,o.default)((function*(){if(!t._hasEncryptedColumn())return t.view(e);var n=yield t._decryptColumns(e);return t.view(n)}))()}_decryptColumns(e){var t=this;return(0,o.default)((function*(){(0,u.default)("object"==typeof e,"Called `_decryptColumns` with primitive value");var n=Array.from(t.tableEncryptedColumns.entries()).map((([n,r])=>{var a=e[n];return(null==a?void 0:a._data)&&(null==a?void 0:a.iv)?function(){return p.apply(this,arguments)}(a,n,r,t.shouldUseDbMsgEncKeyForEncryptedCol).then((t=>{e[n]=t})):a}));return yield Promise.all(n),e}))()}_encryptColumns(e){var t=Array.from(this.tableEncryptedColumns.entries()).map((([t,n])=>{var r=e[t];return null==r?r:function(){return h.apply(this,arguments)}(r,t,n,this.shouldUseDbMsgEncKeyForEncryptedCol).then((n=>{e[t]=n}))}));return Promise.all(t).then((()=>e))}_addAndEncrypt(e){var t=this;return(0,o.default)((function*(){if(!t._hasEncryptedColumn())return t.table.add(e);var n=yield t._encryptSingleUpdate(e);return t.table.add(n)}))()}_putAndEncrypt(e){var t=this;return(0,o.default)((function*(){if(!t._hasEncryptedColumn())return t.table.put(e);var n=yield t._encryptColumns(e);return t.table.put(n)}))()}_bulkAddAndEncrypt(e){return this._hasEncryptedColumn()?this._encryptBulkUpdates(e).then((e=>this.table.bulkAdd(e))):this.table.bulkAdd(e)}_bulkPutAndEncrypt(e){return this._hasEncryptedColumn()?i.default.waitFor(this._encryptBulkUpdates(e)).then((e=>this.table.bulkPut(e))):this.table.bulkPut(e)}_encryptBulkUpdates(e){if(!this._hasEncryptedColumn())return d.resolve(e);var t=[],n=e.map(((e,n)=>this._encryptColumns(e).then((e=>{t[n]=e}))));return Promise.all(n).then((()=>t))}_encryptSingleUpdate(e){var t=this;return(0,o.default)((function*(){return t._hasEncryptedColumn()?yield t._encryptColumns(e):e}))()}asyncViewMap(e,t=!0){if(!this._hasEncryptedColumn()||!t)return Promise.resolve(e.map((e=>e?this.view(e):null)));var n=e.map((e=>null!=e?this.asyncView(e):d.resolve(null)));return d.resolve(null==i.default.currentTransaction?Promise.all(n):i.default.waitFor(Promise.all(n)))}preflightEncryptSingleRecord(e){return this.tableEncryptedColumns,Object.keys(e).forEach((t=>{this.tableEncryptedColumns.has(t)||delete e[t]})),this._encryptColumns(e)}postflightDecryptSingleRecord(e){var t=this;return(0,o.default)((function*(){var n=yield t._decryptColumns(e);return t.view(n)}))()}bulkCreateWith_ALREADY_ENCRYPTED_RECORDS_ONLY(e){return E(e,this.tableEncryptedColumns),d.resolve(this.table.bulkAdd(e)).catch((t=>{throw w(t,"bulkCreateWith_ALREADY_ENCRYPTED_RECORDS_ONLY",this.table.name,e),t}))}bulkCreateOrReplace_ALREADY_ENCRYPTED_RECORDS_ONLY(e){return E(e,this.tableEncryptedColumns),d.resolve(this.table.bulkPut(e)).catch((t=>{throw w(t,"bulkCreateOrReplace",this.table.name,e),t}))}create(e){var t=this.propFilter(e);return d.resolve(this._addAndEncrypt(t)).catch((t=>{throw w(t,"create",this.table.name,e),t}))}createOrReplace(e){var t=this.propFilter(e);return d.resolve(this._putAndEncrypt(t)).catch((t=>{throw w(t,"createOrReplace",this.table.name,e),t}))}createOrMerge(e,t){var n=this;return(0,o.default)((function*(){var r=n.propFilter(t),a=n._primaryKey(),o=yield n._encryptColumns(r);return d.resolve(n.table.update(o[a],o)).then((e=>{if(0===e)return d.resolve(n.table.put(o))})).catch((r=>{throw w(r,"createOrMerge",n.table.name,e,t),r}))}))()}get(e){return d.resolve(this.table.get(e)).then((e=>e?this.asyncView(e):null)).catch((t=>{throw w(t,"get",this.table.name,e),t}))}merge(e,t){var n=this;return(0,o.default)((function*(){var r=n.propFilter(t),a=yield n._encryptSingleUpdate(r);return d.resolve(n.table.update(e,a)).catch((r=>{throw w(r,"merge",n.table.name,e,t),r}))}))()}remove(e){return d.resolve(this.table.delete(e)).catch((t=>{throw w(t,"remove",this.table.name,e),t}))}bulkCreate(e){var t=e.map((e=>this.propFilter(e)));return d.resolve(this.db.transaction("rw",this.table,(()=>this._bulkAddAndEncrypt(t)))).catch((t=>{throw w(t,"bulkCreate",this.table.name,e),t}))}bulkCreateOrReplace(e){var t=e.map((e=>this.propFilter(e)));return d.resolve(this.db.transaction("rw",this.table,(()=>this._bulkPutAndEncrypt(t)))).catch((t=>{throw w(t,"bulkCreateOrReplace",this.table.name,e),t}))}bulkCreateOrMerge(e){var t=this;return(0,o.default)((function*(){var n=[],r=t._primaryKey(),a=yield t._encryptBulkUpdates(e),i=Promise.all(a.map(function(){var e=(0,o.default)((function*(e){var a=t.propFilter(e);(0,u.default)(r in a,"Called `bulkCreateOrMerge` with item(s) not including the primary key"),0===(yield t.table.update(a[r],a))&&n.push(a)}));return function(){return e.apply(this,arguments)}}()));return d.resolve(i).then((()=>t.table.bulkPut(n).catch((n=>{throw w(n,"bulkCreateOrMerge",t.table.name,e),n}))))}))()}bulkGet(e,t=!0){return d.resolve(this.table.bulkGet(e)).then((e=>this.asyncViewMap(e,t))).catch((t=>{throw w(t,"bulkGet",this.table.name,e),t}))}bulkRemove(e){return d.resolve(this.db.transaction("rw",this.table,(()=>this.table.bulkDelete(e)))).catch((t=>{throw w(t,"bulkRemove",this.table.name,e),t}))}all(e,t){var n=g(this.table.orderBy(e&&e.index?_(e.index):":id"),e);t&&(n=n.until(t));var r=null;switch(null==e?void 0:e.returnKeyType){case"keys":r=d.resolve(n.keys());break;case"primary_key":r=d.resolve(n.primaryKeys());break;default:r=d.resolve(n.toArray()).then((t=>this.asyncViewMap(t,null==e?void 0:e.shouldDecrypt)))}return r.catch((t=>{throw w(t,"all",this.table.name,e),t}))}count(){return d.resolve(this.table.count()).catch((e=>{throw w(e,"count",this.table.name),e}))}equals(e,t,n){return d.resolve(g(this.table.where(_(e)).equals(t),n).toArray()).then((e=>this.asyncViewMap(e,null==n?void 0:n.shouldDecrypt))).catch((r=>{throw w(r,"equals",this.table.name,e,t,n),r}))}anyOf(e,t,n){return d.resolve(g(this.table.where(_(e)).anyOf(t),n).toArray()).then((e=>this.asyncViewMap(e,null==n?void 0:n.shouldDecrypt))).catch((r=>{throw w(r,"anyOf",this.table.name,e,t,n),r}))}greaterThan(e,t,n){var r=n&&n.inclusive?this.table.where(_(e)).aboveOrEqual(t):this.table.where(_(e)).above(t);return d.resolve(g(r,n).toArray()).then((e=>this.asyncViewMap(e,null==n?void 0:n.shouldDecrypt))).catch((r=>{throw w(r,"greaterThan",this.table.name,e,t,n),r}))}lessThan(e,t,n){var r=n&&n.inclusive?this.table.where(_(e)).belowOrEqual(t):this.table.where(_(e)).below(t);return d.resolve(g(r,n).toArray()).then((e=>this.asyncViewMap(e))).catch((r=>{throw w(r,"lessThan",this.table.name,e,t,n),r}))}between(e,t,n,r,a){var o=g(this.table.where(_(e)).between(t,n,!(!r||!r.lowerInclusive),!(!r||!r.upperInclusive)),r),i=null;switch(null==r?void 0:r.returnKeyType){case"keys":i=d.resolve(o.keys());break;case"primary_key":i=d.resolve(o.primaryKeys());break;default:i=a?d.resolve(o.until(a).toArray()).then((()=>[])):d.resolve(o.toArray()).then((e=>this.asyncViewMap(e,null==r?void 0:r.shouldDecrypt)))}return i.catch((a=>{throw w(a,"between",this.table.name,e,t,n,r),a}))}forEachSortedBy(e,t){var n=this;return this.table.orderBy(e).each(function(){var e=(0,o.default)((function*(e){var r=yield n._decryptColumns(e);return t(r)}));return function(){return e.apply(this,arguments)}}()).catch((n=>{throw w(n,"forEachSortedBy",this.table.name,e,t),n}))}forEach(e){var t=this;return this.table.each(function(){var n=(0,o.default)((function*(n){var r=yield t._decryptColumns(n);return e(r)}));return function(){return n.apply(this,arguments)}}()).catch((t=>{throw w(t,"forEach",this.table.name,e),t}))}clear(){return d.resolve(this.table.clear()).catch((e=>{throw w(e,"clear",this.table.name),e}))}_primaryKey(){return this.table.schema.primKey.name}_hasEncryptedColumn(){return this.tableEncryptedColumns.size>0}}function m(e){if(e.length>1)return e.forEach((e=>{(0,u.default)(e.primaryKey&&e.primaryKey===l.PRIMARY_KEY_TYPE.COMPOSITE,"Invalid column passed to `formatPrimaryKey`")})),"[".concat(e.map((e=>e.name)).join("+"),"]");var t=e[0];return(0,u.default)(t.primaryKey&&t.primaryKey!==l.PRIMARY_KEY_TYPE.COMPOSITE,"Invalid column passed to `formatPrimaryKey`"),t.primaryKey===l.PRIMARY_KEY_TYPE.AUTO_INCREMENT?"".concat(t.name,"++"):t.name}function y(e){switch(e.type){case l.INDEX_TYPE.SIMPLE:return e.column;case l.INDEX_TYPE.COMPOSITE:return"[".concat(e.columns.join("+"),"]");case l.INDEX_TYPE.ARRAY:return"*".concat(e.column);case l.INDEX_TYPE.UNIQUE:return"&".concat(e.column)}throw new Error('Cannot format index of type "'.concat(e.type,'"'))}function _(e){return 1===e.length?e[0]:"[".concat(e.join("+"),"]")}function g(e,t){var n=e;return t&&t.reverse&&(n=n.reverse()),t&&null!=t.offset&&(n=n.offset(t.offset)),t&&null!=t.limit&&0!==t.limit&&(n=n.limit(t.limit)),n}function b(e){return d.resolve(e)}function w(e,t,n,...r){__LOG__(3,!0)(f(),t,n,e),__LOG__(2)(c(),t,r)}function E(e,t){var n=Array.from(t.entries());e.forEach((()=>{n.forEach((([t,n])=>{if(e[t]&&!(e[t]._keyId&&e[t]._data&&e[t].iv))throw new Error("[CRITICAL] Records contain unencrypted field")}))}))}t.default=class{constructor(e,t=b){this.tableNames=new Map,this.tableColumns=new Map,this.tableEncryptedColumns=new Map,this.name=e,this.db=new i.default(this.name),this.transformSchema=t}initialize(e,t,n){return function(e,t,n,r,a){return Promise.reduce(e,((e,o)=>a((0,l.cloneSchema)(o)).then((a=>{if((0,u.default)(!(a.name in e),"Multiple tables resulted in the same transformed name"),a.deleted)return e[a.name]=null,e;t.set(o.name,a.name),n.set(o.name,a.columns.map((e=>e.name))),r.set(o.name,a.encryptedColumns||{});var i=a.columns.filter((e=>e.primaryKey));(0,u.default)(i.length>=1,'No primary key was defined for "'.concat(o.name,'"'));var s=[m(i)].concat(a.indexes.map(y)).join(", ");return e[a.name]=s,e}))),{})}(t,this.tableNames,this.tableColumns,this.tableEncryptedColumns,this.transformSchema).then((t=>{this.db.version(e+1).stores(t).upgrade((e=>{var t;if(n)return null===(t=e[n.name])||void 0===t?void 0:t.toCollection().modify(n.callback)}))}))}open(){return d.resolve(this.db.open())}transact(e,t,n="rw"){return d.resolve(this.db.transaction(n,e,(()=>t())))}close(){return this.db.close(),d.resolve()}view(e,t,n,r){(0,u.default)(this.tableNames.has(e),'Attemped to get view for uninitialized table "'.concat(e,'"')),(0,u.default)(this.tableColumns.has(e),'Attemped to get columns for uninitialized table "'.concat(e,'"'));var a=n?function(e){if(!e)return e=>e;return t=>{var n={};return e.forEach((e=>{t.hasOwnProperty(e)&&(n[e]=t[e])})),n}}(this.tableColumns.get(e)):e=>e;return new v(this.db.table(this.tableNames.get(e)),this.db,t,a,(0,s.default)(this.tableEncryptedColumns.get(e),"this.tableEncryptedColumns.get(table)"),r)}available(){return d.resolve(!0)}reset(){return this.tableNames=new Map,d.resolve(this.db.delete()).finally((()=>{this.db=new i.default(this.name)}))}}},7433:(e,t,n)=>{"use strict";var r=n(4859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(n(6936));t.default=class{constructor(e){this._view=e}_read(e){return a.default.isLogoutInProgress?Promise.reject(new Error("dropping db read operation due to logout")):e(this._view())}_write(e){return a.default.isLogoutInProgress?Promise.reject(new Error("dropping db write operation due to logout")):e(this._view())}create(e){return this._write((t=>t.create(e)))}preflightEncryptSingleRecord(e){return this._write((t=>t.preflightEncryptSingleRecord(e)))}postflightDecryptSingleRecord(e){return this._write((t=>t.postflightDecryptSingleRecord(e)))}bulkCreateWith_ALREADY_ENCRYPTED_RECORDS_ONLY(e){return this._write((t=>t.bulkCreateWith_ALREADY_ENCRYPTED_RECORDS_ONLY(e)))}bulkCreateOrReplace_ALREADY_ENCRYPTED_RECORDS_ONLY(e){return this._write((t=>t.bulkCreateOrReplace_ALREADY_ENCRYPTED_RECORDS_ONLY(e)))}createOrReplace(e){return this._write((t=>t.createOrReplace(e)))}createOrMerge(e,t){return this._write((n=>n.createOrMerge(e,t)))}get(e){return this._read((t=>t.get(e)))}merge(e,t){return this._write((n=>n.merge(e,t)))}remove(e){return this._write((t=>t.remove(e)))}bulkCreate(e){return this._write((t=>t.bulkCreate(e)))}bulkCreateOrReplace(e){return this._write((t=>t.bulkCreateOrReplace(e)))}bulkCreateOrMerge(e){return this._write((t=>t.bulkCreateOrMerge(e)))}bulkGet(e,t){return this._read((n=>n.bulkGet(e,t)))}bulkRemove(e){return this._write((t=>t.bulkRemove(e)))}all(e,t){return this._read((n=>n.all(e,t)))}count(){return this._read((e=>e.count()))}equals(e,t,n){return this._read((r=>r.equals(e,t,n)))}anyOf(e,t,n){return this._read((r=>r.anyOf(e,t,n)))}greaterThan(e,t,n){return this._read((r=>r.greaterThan(e,t,n)))}lessThan(e,t,n){return this._read((r=>r.lessThan(e,t,n)))}between(e,t,n,r,a){return this._read((o=>o.between(e,t,n,r,a)))}forEachSortedBy(e,t){return this._read((n=>n.forEachSortedBy(e,t)))}forEach(e){return this._read((t=>t.forEach(e)))}clear(){return this._write((e=>e.clear()))}}},1695:(e,t,n)=>{"use strict";var r=n(4859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(n(7677)),o=r(n(6053));class i extends o.default{constructor(e){super(),(0,a.default)("AbstractPrimaryKey"!==this.constructor.name,"Cannot instantiate abstract class AbstractPrimaryKey"),Array.isArray(e)?this.columns=[...e]:this.columns=[e]}validate(e){(0,a.default)(0===e.columns.length,"Attempted to add primary key after other columns")}apply(){throw new Error("Subclass of `AbstractPrimaryKey` must implement `apply` method")}}t.default=i},6879:(e,t,n)=>{"use strict";var r=n(4859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(n(7677)),o=r(n(6053)),i=n(1054);class u extends o.default{constructor(e){super(),this.column=e}validate(e){var t=e.columns.find((e=>e.name===this.column));(0,a.default)(t,'Attempted to add index on non-existent column "'.concat(this.column,'" in "').concat(e.name,'"')),(0,a.default)(t&&(!t.primaryKey||t.primaryKey===i.PRIMARY_KEY_TYPE.COMPOSITE),'Cannot add index on primary key on table "'.concat(e.name,'"')),(0,a.default)(!e.indexes.some((e=>(e.type===i.INDEX_TYPE.ARRAY||e.type===i.INDEX_TYPE.SIMPLE||e.type===i.INDEX_TYPE.UNIQUE)&&(0,i.indexContainsColumn)(e,this.column))),'Attempted to add index "'.concat(this.column,'" which already exists in "').concat(e.name,'"'))}apply(e){var t=(0,i.cloneSchema)(e);return t.indexes.push(this._getIndex()),t}_getIndex(){return{type:i.INDEX_TYPE.ARRAY,column:this.column}}}t.default=u},530:(e,t,n)=>{"use strict";var r=n(4859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(n(7677)),o=r(n(6053)),i=n(1054);class u extends o.default{constructor(e){super(),this.name=e}validate(e){(0,a.default)(!e.columns.find((e=>e.name===this.name)),'Attempted to add column "'.concat(this.name,'" to "').concat(e.name,'" but it already exists'))}apply(e){var t=(0,i.cloneSchema)(e);return t.columns.push({name:this.name}),t}}t.default=u},9387:(e,t,n)=>{"use strict";var r=n(4859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(n(7677)),o=r(n(6053)),i=n(1054);class u extends o.default{constructor(e){super(),this.columns=[...e]}validate(e){this.columns.forEach((t=>{(0,a.default)(e.columns.find((e=>e.name===t)),'Attempted to add index on non-existent column "'.concat(t,'" in "').concat(e.name,'"'))})),(0,a.default)(this.columns.length>1,"Attempted to add composite index for only 1 column"),(0,a.default)(-1===(0,i.findIndex)(e,this._getIndex()),"Attempted to add index [".concat(String(this.columns),'], which already exists in "').concat(e.name,'"'));var t=e.columns.filter((e=>e.primaryKey&&e.primaryKey===i.PRIMARY_KEY_TYPE.COMPOSITE)).map((e=>e.name));(0,a.default)(t.length!==this.columns.length||t.some((e=>!this.columns.includes(e))),"Attempted to add index [".concat(String(this.columns),'], which already is the primary key in "').concat(e.name,'"'))}apply(e){var t=(0,i.cloneSchema)(e);return t.indexes.push(this._getIndex()),t}_getIndex(){return{type:i.INDEX_TYPE.COMPOSITE,columns:this.columns}}}t.default=u},522:(e,t,n)=>{"use strict";var r=n(4859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.ENCRYPTED_VALUE_TYPE=void 0;var a=r(n(7677)),o=r(n(6053)),i=n(1054),u=Object.freeze({STRING:"String",ARRAY_BUFFER:"ArrayBuffer"});t.ENCRYPTED_VALUE_TYPE=u;class s extends o.default{constructor(e,t){super(),this.name=e,this.dataType=t}validate(e){(0,a.default)(!e.columns.find((e=>e.name===this.name)),'Attempted to add encrypted column "'.concat(this.name,'" to "').concat(e.name,'" but it already exists'))}apply(e){var t=(0,i.cloneSchema)(e);return t.columns.push({name:this.name}),t.encryptedColumns[this.name]=this.dataType,t}}t.default=s},146:(e,t,n)=>{"use strict";var r=n(4859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(n(7677)),o=r(n(6053)),i=n(1054);class u extends o.default{constructor(e){super(),this.keyPath=e,this.column=e.split(".")[0]}validate(e){var t=e.columns.find((e=>e.name===this.column));(0,a.default)(t,'Attempted to add index on non-existent column "'.concat(this.column,'" in "').concat(e.name,'"')),(0,a.default)(t&&(!t.primaryKey||t.primaryKey===i.PRIMARY_KEY_TYPE.COMPOSITE),'Cannot add index on primary key on table "'.concat(e.name,'"')),(0,a.default)(!e.indexes.some((e=>(e.type===i.INDEX_TYPE.ARRAY||e.type===i.INDEX_TYPE.SIMPLE||e.type===i.INDEX_TYPE.UNIQUE)&&(0,i.indexContainsColumn)(e,this.column))),'Attempted to add index "'.concat(this.column,'" which already exists in "').concat(e.name,'"'))}apply(e){var t=(0,i.cloneSchema)(e);return t.indexes.push(this._getIndex()),t}_getIndex(){return{type:i.INDEX_TYPE.SIMPLE,column:this.keyPath}}}t.default=u},5745:(e,t,n)=>{"use strict";var r=n(4859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(n(7677)),o=r(n(6053)),i=n(1054);class u extends o.default{constructor(e){super(),this.column=e}validate(e){var t=e.columns.find((e=>e.name===this.column));(0,a.default)(t,'Attempted to add index on non-existent column "'.concat(this.column,'" in "').concat(e.name,'"')),(0,a.default)(t&&(!t.primaryKey||t.primaryKey===i.PRIMARY_KEY_TYPE.COMPOSITE),'Cannot add index on primary key on table "'.concat(e.name,'"')),(0,a.default)(!e.indexes.some((e=>(e.type===i.INDEX_TYPE.ARRAY||e.type===i.INDEX_TYPE.SIMPLE||e.type===i.INDEX_TYPE.UNIQUE)&&(0,i.indexContainsColumn)(e,this.column))),'Attempted to add index "'.concat(this.column,'" which already exists in "').concat(e.name,'"'))}apply(e){var t=(0,i.cloneSchema)(e);return t.indexes.push(this._getIndex()),t}_getIndex(){return{type:i.INDEX_TYPE.UNIQUE,column:this.column}}}t.default=u},2948:(e,t,n)=>{"use strict";var r=n(4859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(n(7677)),o=r(n(1695)),i=n(1054);class u extends o.default{validate(e){super.validate(e),(0,a.default)(this.columns&&1===this.columns.length,"Attempted to add UserDefinedPrimaryKey over wrong number of columns")}apply(e){var t=(0,i.cloneSchema)(e);return t.columns.unshift({name:this.columns[0],primaryKey:i.PRIMARY_KEY_TYPE.AUTO_INCREMENT}),t}}t.default=u},9667:(e,t,n)=>{"use strict";var r=n(4859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(n(7677)),o=r(n(1695)),i=n(1054);class u extends o.default{validate(e){super.validate(e),(0,a.default)(this.columns&&this.columns.length>1,"Attempted to add composite primary key for only 1 column")}apply(e){var t=(0,i.cloneSchema)(e);return this.columns.forEach((e=>{t.columns.push({name:e,primaryKey:i.PRIMARY_KEY_TYPE.COMPOSITE})})),t}}t.default=u},6053:(e,t,n)=>{"use strict";var r=n(4859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(n(7677));t.default=class{constructor(){(0,a.default)("Mutation"!==this.constructor.name,"Cannot instantiate abstract class Mutation")}validate(){throw new Error("Subclasses of Mutaton must implement `validate`")}apply(){throw new Error("Subclasses of Mutaton must implement `apply`")}}},1252:(e,t,n)=>{"use strict";var r=n(4859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(n(7677)),o=r(n(6053)),i=n(1054);class u extends o.default{constructor(e){super(),this.column=e}validate(e){(0,a.default)(-1!==(0,i.findIndex)(e,this._getIndex()),'Attempted to remove non-existent index "'.concat(this.column,'" on "').concat(e.name,'"'))}apply(e){var t=(0,i.cloneSchema)(e),n=(0,i.findIndex)(e,this._getIndex());return t.indexes.splice(n,1),t}_getIndex(){return{type:i.INDEX_TYPE.ARRAY,column:this.column}}}t.default=u},6546:(e,t,n)=>{"use strict";var r=n(4859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(n(7677)),o=r(n(6053)),i=n(1054);class u extends o.default{constructor(e){super(),this.name=e}validate(e){var t=e.columns.find((e=>e.name===this.name));(0,a.default)(t,'Attempted to remove column "'.concat(this.name,'" from "').concat(e.name,"\" but it doesn't exist")),(0,a.default)(!t.primaryKey,'Attempted to remove primary key column "'.concat(this.name,'". Removing primary keys is not supported.')),(0,a.default)(!e.indexes.some((e=>(0,i.indexContainsColumn)(e,this.name))),'Attempted to remove column "'.concat(this.name,'" from "').concat(e.name,'" but an index exists with the column'))}apply(e){var t=(0,i.cloneSchema)(e);return t.columns.splice(t.columns.findIndex((e=>e.name===this.name)),1),t}}t.default=u},9605:(e,t,n)=>{"use strict";var r=n(4859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(n(7677)),o=r(n(6053)),i=n(1054);class u extends o.default{constructor(e){super(),this.columns=[...e].sort()}validate(e){(0,a.default)(-1!==(0,i.findIndex)(e,this._getIndex()),"Attempted to remove non-existent index [".concat(String(this.columns),'] on "').concat(e.name,'"'))}apply(e){var t=(0,i.cloneSchema)(e),n=(0,i.findIndex)(e,this._getIndex());return t.indexes.splice(n,1),t}_getIndex(){return{type:i.INDEX_TYPE.COMPOSITE,columns:this.columns}}}t.default=u},600:(e,t,n)=>{"use strict";var r=n(4859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(n(7677)),o=r(n(6053)),i=n(1054);class u extends o.default{constructor(e){super(),this.column=e}validate(e){(0,a.default)(-1!==(0,i.findIndex)(e,this._getIndex()),'Attempted to remove non-existent index "'.concat(this.column,'" on "').concat(e.name,'"'))}apply(e){var t=(0,i.cloneSchema)(e),n=(0,i.findIndex)(e,this._getIndex());return t.indexes.splice(n,1),t}_getIndex(){return{type:i.INDEX_TYPE.SIMPLE,column:this.column}}}t.default=u},8642:(e,t,n)=>{"use strict";var r=n(4859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(n(7677)),o=r(n(1695)),i=n(1054);class u extends o.default{validate(e){super.validate(e),(0,a.default)(this.columns&&1===this.columns.length,"Attempted to add UserDefinedPrimaryKey over wrong number of columns")}apply(e){var t=(0,i.cloneSchema)(e);return t.columns.unshift({name:this.columns[0],primaryKey:i.PRIMARY_KEY_TYPE.USER_DEFINED}),t}}t.default=u},0:(e,t,n)=>{"use strict";var r=n(4859);Object.defineProperty(t,"__esModule",{value:!0}),t.sortMutations=function(e){return[...e].sort(g)};var a=r(n(7677)),o=r(n(6879)),i=r(n(530)),u=r(n(9387)),s=r(n(522)),l=r(n(146)),c=r(n(5745)),f=r(n(2948)),d=r(n(9667)),h=r(n(1252)),p=r(n(6546)),v=r(n(9605)),m=r(n(600)),y=r(n(8642)),_=[v.default,h.default,m.default,p.default,f.default,y.default,d.default,i.default,l.default,o.default,u.default,c.default,s.default];function g(e,t){var n=_.indexOf(e.constructor),r=_.indexOf(t.constructor);return(0,a.default)(-1!==n,"Mutation ".concat(e.constructor.name," is not a known mutation type")),(0,a.default)(-1!==r,"Mutation ".concat(e.constructor.name," is not a known mutation type")),n-r}},1054:(e,t,n)=>{"use strict";var r=n(4859);Object.defineProperty(t,"__esModule",{value:!0}),t.emptySchema=function(e){return{name:e,columns:[],indexes:[],encryptedColumns:{}}},t.cloneSchema=function(e){return{name:e.name,columns:e.columns.map((e=>(0,a.default)({},e))),indexes:e.indexes.map(l),encryptedColumns:(0,a.default)({},e.encryptedColumns||{}),deleted:e.deleted}},t.freezeSchema=function(e){return Object.freeze({name:e.name,columns:Object.freeze(e.columns.map(Object.freeze)),indexes:Object.freeze(e.indexes.map(s)),encryptedColumns:Object.freeze((0,a.default)({},e.encryptedColumns||{})),deleted:e.deleted})},t.findIndex=function(e,t){return e.indexes.findIndex((e=>function(e,t){if(e.type!==t.type)return!1;switch(e.type){case u.SIMPLE:case u.ARRAY:case u.UNIQUE:return(0,o.default)(t.type===e.type,"Index types are not equal"),e.column===t.column;case u.COMPOSITE:return(0,o.default)(t.type===e.type,"Index types are not equal"),e.columns.length===t.columns.length&&!e.columns.some((e=>!t.columns.includes(e)))}throw new Error("cannot compare unknown indexes of types: ".concat(e.type,", ").concat(t.type))}(t,e)))},t.indexContainsColumn=function(e,t){switch(e.type){case u.SIMPLE:case u.ARRAY:case u.UNIQUE:return e.column===t;case u.COMPOSITE:return!!e.columns.find((e=>e===t))}throw new Error("cannot check indexes of unknown index type: ".concat(e.type))},t.INDEX_TYPE=t.PRIMARY_KEY_TYPE=void 0;var a=r(n(417)),o=r(n(7677)),i=Object.freeze({AUTO_INCREMENT:"auto-increment",USER_DEFINED:"user-defined",COMPOSITE:"composite"});t.PRIMARY_KEY_TYPE=i;var u=Object.freeze({SIMPLE:"simple",COMPOSITE:"composite",ARRAY:"array",UNIQUE:"unique"});function s(e){switch(e.type){case u.SIMPLE:return Object.freeze({type:u.SIMPLE,column:e.column});case u.ARRAY:return Object.freeze({type:u.ARRAY,column:e.column});case u.COMPOSITE:return Object.freeze({type:u.COMPOSITE,columns:Object.freeze(e.columns.map(Object.freeze))});case u.UNIQUE:return Object.freeze({type:u.UNIQUE,column:e.column})}throw new Error("cannot freeze index of unknown type: ".concat(e.type))}function l(e){switch(e.type){case u.SIMPLE:return{type:u.SIMPLE,column:e.column};case u.UNIQUE:return{type:u.UNIQUE,column:e.column};case u.COMPOSITE:return{type:u.COMPOSITE,columns:e.columns.map((e=>e))};case u.ARRAY:return{type:u.ARRAY,column:e.column}}throw new Error("cannot clone unknown index type: ".concat(e.type))}t.INDEX_TYPE=u},2488:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.MissingVersionError=t.InvalidVersionError=t.DuplicateVersionError=void 0;class n extends Error{constructor(...e){super(...e),this.name="DuplicateVersionError"}}t.DuplicateVersionError=n;class r extends Error{constructor(...e){super(...e),this.name="InvalidVersionError"}}t.InvalidVersionError=r;class a extends Error{constructor(...e){super(...e),this.name="MissingVersionError"}}t.MissingVersionError=a;t.default=class{constructor(){this.versions=new Set,this._max=-1}claim(e){if(e<0)throw new r("Versions must by greater than or equal to zero!");if(this.versions.has(e))throw new n("Version #".concat(e," has already been claimed!"));this.versions.add(e),this._max=Math.max(this.max,e)}version(e){if(e<0)throw new r("Versions must by greater than or equal to zero!");return e}validate(){for(var e=0;e<=this.max;++e)if(!this.versions.has(e))throw new a("Schema version #".concat(e," is missing!"))}get max(){return this._max}}},6957:(e,t,n)=>{"use strict";var r=n(4859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.NotInitializedError=t.NoSuchTableError=t.NoSuchDatabaseError=t.NoFallbackError=t.DuplicateTableError=t.DuplicateDatabaseError=t.AlreadyInitializedError=void 0;var a=r(n(7433)),o=r(n(2488)),i=r(n(8030));class u extends Error{constructor(...e){super(...e),this.name="AlreadyInitializedError"}}t.AlreadyInitializedError=u;class s extends Error{constructor(...e){super(...e),this.name="DuplicateDatabaseError"}}t.DuplicateDatabaseError=s;class l extends Error{constructor(...e){super(...e),this.name="DuplicateTableError"}}t.DuplicateTableError=l;class c extends Error{constructor(...e){super(...e),this.name="NoFallbackError"}}t.NoFallbackError=c;class f extends Error{constructor(...e){super(...e),this.name="NoSuchDatabaseError"}}t.NoSuchDatabaseError=f;class d extends Error{constructor(...e){super(...e),this.name="NoSuchTableError"}}t.NoSuchTableError=d;class h extends Error{constructor(...e){super(...e),this.name="NotInitializedError"}}t.NotInitializedError=h;t.default=class{constructor(e){this.tables=new Map,this.views=new Map,this.state=1,this.versions=new o.default,this._database=e}add(e){if(this.tables.has(e))throw new l('Table "'.concat(e,'" already added. Reuse the definition.'));var t=new i.default(e,this.versions);return this.tables.set(e,t),t}_getBackingDB(){return this._database}_unsafeGetOrCreateView(e){if(this.views.has(e))return this.views.get(e);var t=this._database.view(e.name,e.rowview,e.shouldEnablePropFilter,e.shouldUseDbMsgEncKeyForEncryptedCol);return this.views.set(e,t),t}_guardInitializedThunk(e){return()=>{if(3&this.state)throw new h("Storage must be initialized before accessing a table!");return e()}}table(e){var t=this.tables.get(e);if(!t)throw new d("Unknown table ".concat(e," requested, ensure table is defined!"));if(!this._getBackingDB())throw new f('Unable to find associated database with table "'.concat(e,'"'));return new a.default(this._guardInitializedThunk((()=>this._unsafeGetOrCreateView(t))))}lock(e,t){if(3&this.state)return Promise.reject(new h("Initialize storage before attempting to lock tables!"));for(var n=0;n<e.length;++n)if(!this.tables.has(e[n]))return Promise.reject(new d('Requested lock of unknown table "'.concat(e[n],'"')));var r=e.map((e=>{var t=this.tables.get(e);if(t)return t;throw new d('Requested lock of unknown table "'.concat(e,'"'))})).map((e=>this._unsafeGetOrCreateView(e)));return this._getBackingDB().transact(e,(()=>t(r)))}_getUpgraderForCurrentVersion(e,t){for(var n=0;n<e.length;n++)if(e[n].maxVersion===t){var r=e[n].upgraders.get(t);if(r)return{name:e[n].name,callback:r}}}initialize(){return 4&this.state?Promise.reject(new u("Storage instance has already been initialized")):(this.versions.validate(),(this._database?this._database.available():Promise.reject(new f('"'.concat(this._database.constructor.name,'" failed availability check!')))).then((()=>{var e=Array.from(this.tables.values()),t=this._getBackingDB();if(e&&t){var n=new Array(this.versions.max+1);return Promise.each(n,((n,r)=>{var a=r,o=e.map((e=>e.schema(a))).filter(Boolean);return t.initialize(r,o,this._getUpgraderForCurrentVersion(e,a))})).then((()=>t.open()))}})).then((()=>this.state=4)).then((()=>{})))}purge(){return this.state=2,this.views=new Map,this._getBackingDB().reset().then((()=>{}))}}},8030:(e,t,n)=>{"use strict";var r=n(4859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(n(417)),o=r(n(7677)),i=n(1054),u=n(0);function s(e){return e}t.default=class{constructor(e,t){this.maxVersion=-1,this.versions=new Map,this.upgraders=new Map,this.shouldEnablePropFilter=!0,this.shouldUseDbMsgEncKeyForEncryptedCol=!1,this.name=e,this.versionManager=t}version(e,t,n){this.versionManager.claim(e),(0,o.default)(!this.versions.has(e),'Table "'.concat(this.name,'" already has version #').concat(+e," defined!")),(0,o.default)(e>this.maxVersion,"Versions for table ".concat(this.name," must be defined in order")),this.maxVersion=e;var r=this.schema(e)||(0,i.emptySchema)(this.name),a=(0,u.sortMutations)(t).reduce(((e,t)=>(t.validate(e),t.apply(e))),(0,i.cloneSchema)(r));return this.versions.set(e,(0,i.freezeSchema)(a)),this.upgraders.set(e,n),this}delete(e){this.versionManager.claim(e),(0,o.default)(!this.versions.has(e),'Table "'.concat(this.name,'" already has version #').concat(+e," defined!")),(0,o.default)(e>this.maxVersion,"Versions for table ".concat(this.name," must be defined in order")),this.maxVersion=e;var t=this.schema(e)||(0,i.emptySchema)(this.name),n=(0,a.default)((0,a.default)({},t),{},{deleted:!0});return this.versions.set(e,(0,i.freezeSchema)(n)),this}view(e){return this.rowview=e,this}enablePropFilter(e){return this.shouldEnablePropFilter=e,this}useDbMsgEncKeyForEncryptedCol(e){return this.shouldUseDbMsgEncKeyForEncryptedCol=e,this}schema(e){var t=this.versions.get(e);if(t)return t;var n=Array.from(this.versions.keys()).map(s).sort(((e,t)=>e-t)).filter((t=>t<e)).pop();return n||0===n?this.versions.get(n)||(0,i.emptySchema)(this.name):null}}},4319:(e,t,n)=>{"use strict";var r=n(4859);Object.defineProperty(t,"__esModule",{value:!0}),t.initializeWithoutGKs=function(){null==f&&((0,s.createStorage)(),(0,u.addTable)(),(0,i.addTable)(),(0,l.addTable)(),f=(0,s.getStorage)().initialize().catch((e=>{throw __LOG__(4,!0,new Error,!0)(c()),SEND_LOGS("Failed to initialize model storage"),e})));return f},t.destroy=function(){return(0,s.destroyStorage)().catch((()=>d.resolve(new o.default(s.DATABASE_NAME).delete()))).finally((()=>{f=null}))},t.clearInitializePromise=function(){f=null};var a=r(n(9976)),o=r(n(5363)),i=n(7211),u=n(8685),s=n(7993),l=n(6001);function c(){var e=(0,a.default)(["Assertion failed!"]);return c=function(){return e},e}var f,d=n(1449).Z},5855:(e,t,n)=>{"use strict";var r=n(4859);Object.defineProperty(t,"__esModule",{value:!0}),t.addTable=function(){(0,o.getStorage)().add("chat").version((0,u.chatCreateTable)(),[new i.default("id"),new a.default("t"),new a.default("unreadCount"),new a.default("archive"),new a.default("isReadOnly"),new a.default("isAnnounceGrpRestrict"),new a.default("modifyTag"),new a.default("muteExpiration"),new a.default("name"),new a.default("notSpam"),new a.default("pin"),new a.default("changeNumberOldJid"),new a.default("changeNumberNewJid"),new a.default("ephemeralDuration"),new a.default("ephemeralSettingTimestamp"),new a.default("unreadMsgAnchorId"),new a.default("endOfHistoryTransferType")]).view((e=>({id:e.id,t:e.t,unreadCount:e.unreadCount,unreadMsgAnchorId:e.unreadMsgAnchorId,archive:e.archive,isReadOnly:e.isReadOnly,isAnnounceGrpRestrict:e.isAnnounceGrpRestrict,modifyTag:e.modifyTag,muteExpiration:e.muteExpiration,name:e.name,notSpam:e.notSpam,pin:e.pin,changeNumberOldJid:e.changeNumberOldJid,changeNumberNewJid:e.changeNumberNewJid,endOfHistoryTransfer:e.endOfHistoryTransfer,endOfHistoryTransferType:e.endOfHistoryTransferType,ephemeralDuration:e.ephemeralDuration,ephemeralSettingTimestamp:e.ephemeralSettingTimestamp})))},t.getTable=function(){return(0,o.getStorage)().table("chat")};var a=r(n(530)),o=n(7993),i=r(n(8642)),u=n(9290)},7211:(e,t,n)=>{"use strict";var r=n(4859);Object.defineProperty(t,"__esModule",{value:!0}),t.addTable=function(){(0,o.getStorage)().add("collection-version").version((0,u.collectionVersionCreateTable)(),[new i.default("collection"),new a.default("version"),new a.default("state"),new a.default("finiteFailureStartTime"),new a.default("ltHash")]).view((e=>e))},t.getTable=function(){return(0,o.getStorage)().table("collection-version")};var a=r(n(530)),o=n(7993),i=r(n(8642)),u=n(9290)},2303:(e,t,n)=>{"use strict";var r=n(3291),a=n(4859);Object.defineProperty(t,"__esModule",{value:!0}),t.addTable=function(){(0,f.getStorage)().add("message").version((0,h.messageCreateTable)(),[new d.default("id"),new i.default("internalId"),new c.default("internalId"),new i.default("rowId"),new c.default("rowId"),new i.default("type"),new i.default("subtype"),new i.default("t"),new i.default("notifyName"),new i.default("from"),new i.default("to"),new i.default("author"),new i.default("self"),new i.default("ack"),new i.default("invis"),new i.default("isStarred"),new l.default("isStarred"),new i.default("mentionedJidList"),new i.default("count"),new i.default("devicesAdded"),new i.default("devicesRemoved"),new i.default("isThisDeviceAdded"),new i.default("recipients"),new i.default("protocolMessageKey"),new i.default("templateParams"),new u.default(["internalId","isStarred"]),new i.default("vcardWAids"),new o.default("vcardWAids"),new i.default("hasLink"),new i.default("isMediaMsg"),new i.default("isDocMsg"),new u.default(["internalId","isMediaMsg"]),new u.default(["internalId","isDocMsg"]),new u.default(["internalId","hasLink"]),new i.default("offline"),new i.default("isOffline"),new s.default("offlineBuffer",s.ENCRYPTED_VALUE_TYPE.ARRAY_BUFFER),new c.default("isOffline"),new i.default("ephemeralStartTimestamp"),new i.default("ephemeralDuration"),new i.default("ephemeralSettingTimestamp"),new i.default("ephemeralOutOfSync"),new i.default("expiredTimestamp"),new l.default("expiredTimestamp"),new i.default("directPath"),new i.default("mimetype"),new i.default("duration"),new i.default("filehash"),new i.default("uploadhash"),new i.default("size"),new i.default("filename"),new i.default("streamingSidecar"),new i.default("mediaKey"),new i.default("mediaKeyTimestamp"),new i.default("pageCount"),new i.default("isGif"),new i.default("gifAttribution"),new i.default("isViewOnce"),new i.default("width"),new i.default("height"),new i.default("scanLengths"),new i.default("scansSidecar"),new i.default("interactiveAnnotations"),new i.default("firstFrameLength"),new i.default("firstFrameSidecar"),new i.default("isAnimated"),new i.default("thumbnail"),new i.default("richPreviewType"),new i.default("doNotPlayInline"),new i.default("broadcast"),new i.default("broadcastParticipants"),new i.default("broadcastId"),new i.default("quotedMsg"),new i.default("quotedStanzaID"),new i.default("quotedRemoteJid"),new i.default("quotedParticipant"),new i.default("footer"),new i.default("hydratedButtons"),new i.default("selectedId"),new i.default("selectedIndex"),new i.default("vcardFormattedName"),new i.default("isVcardOverMmsDocument"),new i.default("businessOwnerJid"),new i.default("productId"),new i.default("currencyCode"),new i.default("priceAmount1000"),new i.default("retailerId"),new i.default("url"),new i.default("productImageCount"),new i.default("paymentCurrency"),new i.default("paymentMessageReceiverJid"),new i.default("paymentTransactionTimestamp"),new i.default("paymentStatus"),new i.default("paymentNoteMsg"),new i.default("paymentRequestMessageKey"),new i.default("paymentExpiryTimestamp"),new i.default("message"),new i.default("orderTitle"),new i.default("itemCount"),new i.default("orderId"),new i.default("surface"),new i.default("status"),new i.default("token"),new i.default("textColor"),new i.default("backgroundColor"),new i.default("font"),new i.default("isForwarded"),new i.default("forwardingScore"),new i.default("ctwaContext"),new i.default("mdDowngrade"),new i.default("messageRangeIndex"),new l.default("messageRangeIndex"),new i.default("vcardList"),new i.default("totalAmount1000"),new i.default("totalCurrencyCode"),new i.default("list"),new i.default("listResponse"),new i.default("isDynamicReplyButtonsMsg"),new i.default("dynamicReplyButtons"),new i.default("selectedButtonId"),new i.default("sellerJid"),new i.default("deprecatedMms3Url"),new i.default("encFilehash"),new s.default("msgRowOpaqueData",s.ENCRYPTED_VALUE_TYPE.ARRAY_BUFFER),new i.default("thumbnailDirectPath"),new i.default("thumbnailSha256"),new i.default("thumbnailEncSha256"),new i.default("thumbnailHeight"),new i.default("thumbnailWidth")]).view((e=>e)).enablePropFilter(!0).useDbMsgEncKeyForEncryptedCol(!0)},t.getTable=function(){return(0,f.getStorage)().table("message")};var o=a(n(6879)),i=a(n(530)),u=a(n(9387)),s=r(n(522)),l=a(n(146)),c=a(n(5745)),f=n(7993),d=a(n(8642)),h=n(9290)},8685:(e,t,n)=>{"use strict";var r=n(4859);Object.defineProperty(t,"__esModule",{value:!0}),t.addTable=function(){(0,u.getStorage)().add("pending-mutations").version((0,s.pendingMutationsCreateTable)(),[new i.default("id"),new a.default("collection"),new a.default("index"),new o.default("index"),new a.default("timestamp"),new o.default("collection"),new a.default("version"),new a.default("operation"),new a.default("binarySyncAction")]).view((e=>e))},t.getTable=function(){return(0,u.getStorage)().table("pending-mutations")};var a=r(n(530)),o=r(n(146)),i=r(n(2948)),u=n(7993),s=n(9290)},6001:(e,t,n)=>{"use strict";var r=n(4859);Object.defineProperty(t,"__esModule",{value:!0}),t.addTable=function(){(0,u.getStorage)().add("sync-actions").version((0,l.syncActionsCreateTable)(),[new s.default("index"),new a.default("keyId"),new a.default("version"),new a.default("actionState"),new i.default("actionState"),new a.default("modelId"),new a.default("modelType"),new o.default(["modelId","modelType","actionState"]),new a.default("valueMac"),new a.default("indexMac"),new i.default("indexMac"),new a.default("collection"),new i.default("collection"),new a.default("timestamp"),new a.default("action"),new i.default("action"),new a.default("binarySyncAction")]).view((e=>e))},t.getTable=function(){return(0,u.getStorage)().table("sync-actions")};var a=r(n(530)),o=r(n(9387)),i=r(n(146)),u=(n(3487),n(7993)),s=r(n(8642)),l=n(9290)},7993:(e,t,n)=>{"use strict";var r=n(4859);Object.defineProperty(t,"__esModule",{value:!0}),t.createStorage=function(){var e=new o.default(u);s=new i.default(e)},t.getStorage=function(){return(0,a.default)(null!=s,"[model-storage] Storage should be created first before being accessed"),s},t.destroyStorage=function(){if(null==s)return Promise.reject(new Error("[model-storage] Storage should be created first before being destroyed"));return s.purge().then((()=>{s=null})).catch((e=>{throw s=null,e}))},t.DATABASE_NAME=void 0;var a=r(n(7677)),o=r(n(2206)),i=r(n(6957)),u="model-storage";t.DATABASE_NAME=u;var s=null},3012:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.init=function(){return(0,a.initializeWithoutGKs)().then((()=>(0,r.getTable)().all().then((e=>Promise.all(e.map((e=>{var t=e.id||"";return(0,o.getTable)().between(["internalId"],"".concat(e.id,"_/"),"".concat(e.id,"_g"),{reverse:!0,limit:20}).then((e=>e.length>0&&null!=e[0].isOffline?{chatId:t,messages:[e[0]]}:{chatId:t,messages:e.reverse()}))}))).then((t=>[e,t]))))))};var r=n(5855),a=n(4319),o=n(2303);self.Promise=n(1449).Z},9290:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.pendingMutationsCreateTable=function(){return(0,r.getStorage)().versions.version(0)},t.collectionVersionCreateTable=function(){return(0,r.getStorage)().versions.version(1)},t.syncActionsCreateTable=function(){return(0,r.getStorage)().versions.version(2)},t.contactCreateTable=function(){return(0,r.getStorage)().versions.version(3)},t.blocklistCreateTable=function(){return(0,r.getStorage)().versions.version(4)},t.profilePicThumbCreateTable=function(){return(0,r.getStorage)().versions.version(5)},t.chatCreateTable=function(){return(0,r.getStorage)().versions.version(6)},t.messageCreateTable=function(){return(0,r.getStorage)().versions.version(7)},t.messageInfoCreateTable=function(){return(0,r.getStorage)().versions.version(8)},t.participantCreateTable=function(){return(0,r.getStorage)().versions.version(9)},t.orphanReceiptCreateTable=function(){return(0,r.getStorage)().versions.version(10)},t.deviceListCreateTable=function(){return(0,r.getStorage)().versions.version(11)},t.inactiveReceiptCreateTable=function(){return(0,r.getStorage)().versions.version(12)},t.verifiedBusinessNameCreateTable=function(){return(0,r.getStorage)().versions.version(13)},t.historySyncNotificationsCreateTable=function(){return(0,r.getStorage)().versions.version(14)},t.encryptedMutationsCreateTable=function(){return(0,r.getStorage)().versions.version(15)},t.labelCreateTable=function(){return(0,r.getStorage)().versions.version(16)},t.labelAssociationCreateTable=function(){return(0,r.getStorage)().versions.version(17)},t.quickReplyCreateTable=function(){return(0,r.getStorage)().versions.version(18)},t.abpropsConfigCreateTable=function(){return(0,r.getStorage)().versions.version(19)},t.groupMetadataCreateTable=function(){return(0,r.getStorage)().versions.version(20)},t.syncKeysCreateTable=function(){return(0,r.getStorage)().versions.version(21)},t.tasksScheduledTimeCreateTable=function(){return(0,r.getStorage)().versions.version(22)},t.activeMessageRangesCreateTable=function(){return(0,r.getStorage)().versions.version(23)},t.ftsIndexingQueueCreateTable=function(){return(0,r.getStorage)().versions.version(24)},t.cartCreateTable=function(){return(0,r.getStorage)().versions.version(25)},t.missingKeysCreateTable=function(){return(0,r.getStorage)().versions.version(26)};var r=n(7993)},1198:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){for(var n=[],r=e.length,a=t.length,o=Math.max(r,a),i=0;i<o;i++)i<r&&n.push(e[i]),i<a&&n.push(t[i]);return n}},6890:(e,t,n)=>{"use strict";var r=n(4859);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n,r=String){var o=(0,a.default)(e,t.map(r)).join(""),i=n?4e3:Number.POSITIVE_INFINITY;o.length>i&&(o=o.slice(0,i).replace(/\s+$/," [truncated]"));return o};var a=r(n(1198))},1985:(e,t)=>{"use strict";function n(e,t){var r=function(...n){var a=t?t.apply(this,n):n[0];if(!a)return e.apply(this,n);var o=r.cache;if(o.has(a))return o.get(a);var i=e.apply(this,n);return r.cache=o.set(a,i)||o,i};return r.cache=new(n.Cache||Map),r}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n.Cache=Map;var r=n;t.default=r},1941:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t="?"){if(null==e)throw new Error("Unexpected null or undefined: ".concat(t));return e}}},t={};function n(r){if(t[r])return t[r].exports;var a=t[r]={exports:{}};return e[r](a,a.exports,n),a.exports}n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{self.Promise=n(1449).Z;var{log:e,sendLogs:t}=n(9458);self.__LOG__=e,self.SEND_LOGS=t;(0,n(2186).Z)().then((()=>{self.addEventListener("message",(()=>{}))}))})()})();