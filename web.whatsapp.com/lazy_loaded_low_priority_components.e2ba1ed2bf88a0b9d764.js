/*! Copyright (c) 2021 WhatsApp Inc. All Rights Reserved. */
(self.webpackChunkwhatsapp_web_client=self.webpackChunkwhatsapp_web_client||[]).push([[275],{84818:(e,t,a)=>{"use strict";var l=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.cartItemCollection.reset(),e.set("message",void 0),e.trigger("change:cartItemCollection"),(0,s.default)(e)};var s=l(a(25399))},63956:(e,t,a)=>{"use strict";var l=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var a=s.default.findCart(e);return a.cartItemCollection.remove(t),a.trigger("change:cartItemCollection"),(0,i.default)(a),a.itemCount};var s=l(a(66281)),i=l(a(25399))},39052:(e,t,a)=>{"use strict";var l=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.parsePrice=E,t.isPriceMatch=_,t.createProductFromRefreshCartItem=C,t.default=function(e,t){var a=r.default.get((0,v.createWid)(e.id)),l=[],s=[],c=!0;a&&e.cartItemCollection.forEach((i=>{var r=a.productCollection.get(i.id),n=t&&t.products.find((e=>e.id===i.id));if(n=function(e,t){if(e&&"deleted"===e.status)return void t.productCollection.remove(e.id);return e}(n,a),!t&&r){var o=function(e,t){var a=function(e,t){return e.priceAmount1000===(0,h.getActivePrice)(t)&&e.currency===t.currency&&e.name===t.name&&e.imageHash===t.imageHash}(e,t);a||e.set({priceAmount1000:(0,h.getActivePrice)(t),currency:t.currency,name:t.name,imageHash:t.imageHash},{silent:!0});return a}(i,r);c=c&&o,l.push({product:r,cartItem:i})}else if(n){var d=function(e,t){var a=!t||function(e,t){var a,l,s=(0,h.getActivePrice)(g(t));return _(e.priceAmount1000,s)&&(!(0,m.isString)(e.currency)&&!(0,m.isString)(t.currency)||e.currency===t.currency)&&e.name===t.name&&e.imageHash===(null===(a=t.media)||void 0===a||null===(l=a.image)||void 0===l?void 0:l.id)}(e,t);if(!a&&t){var l=g(t);e.set({priceAmount1000:(0,h.getActivePrice)(l),currency:l.currency,name:l.name,imageHash:l.imageHash},{silent:!0})}return a}(i,n);c=c&&d,l.push({product:C(n,e.id),cartItem:i})}else c=!1,s.push(i.id)})),a||(0,n.default)(e);c||(s.length&&e.cartItemCollection.remove(s),e.trigger("change:cartItemCollection"),o.default.openModal(i.default.createElement(d.default,{onOK:()=>{o.default.closeModal()}},u.default.t(426))));return(0,p.default)(e),l};var s=l(a(81109)),i=l(a(67294)),r=l(a(57984)),n=l(a(84818)),o=l(a(97420)),d=l(a(58743)),u=l(a(66761)),c=l(a(53965)),f=a(4014),h=a(36655),p=l(a(25399)),m=a(16241),v=a(32991);function g(e){var t,a,l,s,i,r,n,o;return{id:e.id,name:null!==(t=e.name)&&void 0!==t?t:"",imageCdnUrl:null===(a=e.media)||void 0===a||null===(l=a.image)||void 0===l?void 0:l.request_image_url,imageHash:null===(s=e.media)||void 0===s||null===(i=s.image)||void 0===i?void 0:i.id,currency:e.currency,priceAmount1000:E(e.price),salePriceAmount1000:E(null===(r=e.sale_price)||void 0===r?void 0:r.price),salePriceStartDate:(0,f.parseDateValue)(null===(n=e.sale_price)||void 0===n?void 0:n.start_date),salePriceEndDate:(0,f.parseDateValue)(null===(o=e.sale_price)||void 0===o?void 0:o.end_date)}}function E(e){return"string"==typeof e?e.length>0?parseInt(e,10):null:e}function _(e,t){var a=E(e),l=E(t);return(0,m.isNumber)(a)&&(0,m.isNumber)(l)?a===l:!(0,m.isNumber)(a)&&!(0,m.isNumber)(l)}function C(e,t){return new c.default((0,s.default)((0,s.default)({},g(e)),{},{catalogWid:(0,v.createWid)(t),productMsgMediaData:null,imageCount:1,fetchedFromServer:!0,t:Date.now()/1e3,old:!1}))}},86578:(e,t,a)=>{"use strict";var l=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){if(0===e.cartItemCollection.length)return Promise.resolve({products:[],price:{}});var t=e.cartItemCollection.map((e=>e.id));return(0,s.refreshCart)(e.id,t,i.default.imageWidth,i.default.imageHeight)};var s=a(29524),i=l(a(66281))},32536:(e,t,a)=>{"use strict";var l=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return c.apply(this,arguments)};var s=l(a(48926)),i=l(a(57984)),r=a(15624),n=l(a(62)),o=l(a(25399)),d=a(32991);function u(e){var t,a,l=e.cartItemCollection.at(0);if(null==l)return"";var s=i.default.get((0,d.createWid)(e.id)),r=null==s?void 0:s.productCollection.get(l.id),n=null==r||null===(t=r.productImageCollection.at(0))||void 0===t?void 0:t.mediaData;if(null==n)return"";var o=null===(a=n.preview)||void 0===a?void 0:a.getBase64();return null!=o?o:""}function c(){return(c=(0,s.default)((function*(e,t){var a=yield(0,r.createOrder)(t.id,e.cartItemCollection.toArray());return yield(0,n.default)(t,a,e.itemCount,u(e),e.message),(0,o.default)(e),a.id}))).apply(this,arguments)}},52059:(e,t,a)=>{"use strict";var l=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){e.set("message",t),(0,s.default)(e)};var s=l(a(25399))},63435:(e,t,a)=>{"use strict";var l=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a){var l=s.default.findCart(e),r=l.cartItemCollection.get(t.id);null==r||r.set("quantity",a),l.trigger("change:cartItemCollection"),(0,i.default)(l)};var s=l(a(66281)),i=l(a(25399))},62:(e,t,a)=>{"use strict";var l=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a,l,f){var h=(0,r.getMaybeMeUser)(),p=function(e,t,a,l,d){var u=(0,r.getMaybeMeUser)(),c={type:"order",ack:i.default.ACK.CLOCK,from:u,id:new n.default({from:u,to:e.id,id:(0,o.default)(),participant:void 0,selfDir:"out"}),local:!0,isNewMsg:!0,self:"out",t:s.default.globalUnixTime(),to:e.id,orderId:t.id,token:t.token,orderTitle:e.name||e.formattedTitle,sellerJid:e.id.toString({legacy:!0}),thumbnail:l,itemCount:a,message:d},f=t.price.total;f&&f.length>0&&(c.totalAmount1000=parseInt(f,10));t.price.currency&&t.price.currency.length>0&&(c.totalCurrencyCode=t.price.currency);return c}(e,t,a,l,f);if(c.default.equals(e.id,h))return(0,d.addAndSendMsgToChat)(e,p)[0].then((()=>{})).catch((e=>{throw __LOG__(3)`Order message send to chat failure: ${e}`,e}));return(0,d.addAndSendMsgToChat)(e,p)[1].then((e=>{if(!e||e!==u.SendMsgResult.OK)throw new Error("Order message SendMsgResult failure status")})).catch((e=>{throw __LOG__(3)`Order message send to chat failure: ${e}`,e}))};var s=l(a(56656)),i=l(a(46274)),r=a(56726),n=l(a(4765)),o=l(a(51459)),d=a(89390),u=a(4205),c=l(a(43501))},97876:(e,t,a)=>{"use strict";var l=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.setPushname=function(e){return f(e)};var s=l(a(67294)),i=a(96440),r=l(a(97420)),n=l(a(3243)),o=a(66274),d=l(a(66761)),u=l(a(64644)),c=a(39696);function f(e,t=(0,i.genId)()){var a=(0,u.default)(e),l=new i.ActionType(d.default.t(193)),h=n.default.pushname,p=a.then((()=>new i.ActionType(d.default.t(190),{actionText:d.default.t(205),actionHandler:()=>f(h,t)}))).catchType(o.ServerStatusCodeError,(e=>{if(e.status>=400)return new i.ActionType(d.default.t(191))})).catch((()=>{throw __LOG__(3)`models:conn:setPushname dropped`,new i.ActionType(d.default.t(191),{actionText:d.default.t(201),actionHandler:()=>f(status,t)})}));return r.default.openToast(s.default.createElement(i.ActionToast,{id:t,initialAction:l,pendingAction:p})),a.then((t=>{t._duplicate||(0,c.setPushnameLocally)(e)}))}},52537:(e,t,a)=>{"use strict";var l=a(20862),s=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a,l){var s=e.map(C.vcardFromContactModel),n=1===s.length?s[0]:(0,C.mergeVcards)(s),o=`${n.displayName}.vcf`,d=(0,h.createFile)([n.vcard],o,{type:S}),c=d.size/1024;if(0!==E.default.vcardAsDocumentSizeKb&&c>E.default.vcardAsDocumentSizeKb)return void function(){y.apply(this,arguments)}(d,e.length,t,a,l);!function(e,t,a,l,s){var n=l&&l.msgContextInfo(t.id),o=(0,p.getMaybeMeUser)(),d=(0,i.default)((0,i.default)({ack:f.default.ACK.CLOCK,from:o,id:new m.default({from:o,to:t.id,id:(0,v.default)(),participant:void 0,selfDir:"out"}),local:!0,isNewMsg:!0,self:"out",t:u.default.globalUnixTime(),to:t.id},n),{},{ctwaContext:s}),c=1===e.length?(0,i.default)((0,i.default)({type:"vcard",vcardFormattedName:e[0].displayName,body:e[0].vcard},d),I(t)):(0,i.default)((0,i.default)({type:"multi_vcard",vcardList:e},d),I(t));(0,r.default)((function*(){try{yield(0,g.addAndSendMsgToChat)(t,c)[1]}catch(e){throw __LOG__(2)`Error sending contact: ${e}`,e}}))()}(s,t,0,a,l)};var i=s(a(81109)),r=s(a(48926)),n=s(a(96391)),o=s(a(67294)),d=s(a(5784)),u=s(a(56656)),c=s(a(97420)),f=s(a(46274)),h=a(51418),p=a(56726),m=s(a(4765)),v=s(a(51459)),g=a(89390),E=s(a(86981)),_=l(a(9931)),C=a(7878),S="text/vcard";function y(){return(y=(0,r.default)((function*(e,t,a,l,s){var i={file:e,type:f.default.MSG_TYPE.DOCUMENT,filename:e.name,mimetype:S,isVcardOverMmsDocument:!0,documentPageCount:t},u=new d.default({chatParticipantCount:a.getParticipantCount()});yield u.processAttachments([i]);var{errorMsgs:h}=u.uiProcessMsgs();if(h)c.default.openToast(o.default.createElement(_.default,{msg:h,id:(0,_.genId)()}));else{var p=(0,n.default)(u.getValidMedias()[0],"collection.getValidMedias()[0]");(0,r.default)((function*(){try{yield p.sendToChat(a,{quotedMsg:l,ctwaContext:s})}catch(e){throw __LOG__(2)`Error sending contact: ${e}`,e}}))()}}))).apply(this,arguments)}function I(e){var t={};if(E.default.ephemeralMessages){e.isEphemeralSettingOn()&&(t.ephemeralDuration=e.getEphemeralSetting());var a=e.getEphemeralSettingTimestamp();null!=a&&(t.ephemeralSettingTimestamp=a);var l=e.getDisappearingModeInitiator();null!=l&&(t.disappearingModeInitiator=l)}return t}},58734:(e,t,a)=>{"use strict";var l=a(20862),s=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){r.default.openToast(i.default.createElement(o.default,{msg:n.default.t(434),duration:6e3,id:(0,o.genId)()}))};var i=s(a(67294)),r=s(a(97420)),n=s(a(66761)),o=l(a(9931))},64388:(e,t,a)=>{"use strict";var l=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.sendSupportRequest=function(e,t){var a=(0,s.wap)("iq",{from:(0,d.USER_JID)((0,n.getMeUser)()),id:(0,s.generateId)(),smax_id:"3",to:s.S_WHATSAPP_NET,type:"set",xmlns:"fb:thrift_iq"},(0,s.wap)("description",null,e),null!=t?(0,s.wap)("debug_information_json",null,t):null);return(0,r.sendIq)(a,c).then((e=>{var a;if(e.success){var l,{result:s}=e;return"success"===s.type?(null!=t&&(__LOG__(2)`InAppSupport: Uploading logs for ticketId=${s.ticketId}`,(0,i.upload)({reason:"user-report",immediate:!0,force:!0,persist:!0,ticketId:s.ticketId}).then((e=>{__LOG__(2)`InAppSupport: Logs upload complete for ticketId=${s.ticketId}, logsId=${e}`}))),{type:"success",message:s.message,ticketId:s.ticketId}):(u(a=null!==(l=s.errorCode)&&void 0!==l?l:400),{type:"error",errorCode:a})}return u(e.errorCode,e.errorText),{type:"error",errorCode:e.errorCode}}))};var s=a(24488),i=a(6514),r=a(10378),n=a(56726),o=l(a(79112)),d=a(78209);function u(e,t){__LOG__(3,void 0,void 0,!0)`supportRequest error: code=${e} message=${null!=t?t:""}`,SEND_LOGS("supportRequest")}var c=new o.default("supportResponse",(e=>{var t=e.child("response");return t.hasAttr("error_code")?{type:"error",errorCode:t.attrInt("error_code",0,1e3)}:(t.assertAttr("status","ok"),{type:"success",message:t.child("message").contentString(),ticketId:t.child("ticket_id").contentString()})}))},13151:(e,t,a)=>{"use strict";var l=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.editBusinessProfile=void 0;var s=l(a(60246)),i=l(a(94986)),r=a(29370);t.editBusinessProfile=e=>{var t;return s.default.supportsFeature(s.default.F.MD_BACKEND)?(t=(0,r.editBusinessProfile)(e))||(t=Promise.reject(new Error("md business profile edit not supported"))):t=(0,i.default)(e),t}},94986:(e,t,a)=>{"use strict";var l=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.convertProfileToRequestData=void 0;var s=l(a(81109)),i=l(a(48926)),r=a(66274),n=l(a(68600)),o=l(a(11774)),d=e=>{if(e)return{category:e.map((({id:e})=>({id:e})))}},u=e=>{if(e){var{note:t,timezone:a,config:l}=e,s=[];for(var i in l){var r=l[i],{mode:n,hours:o}=r;if(o)for(var[d,u]of o)s.push({day_of_week:i,mode:n,open_time:d,close_time:u});else s.push({day_of_week:i,mode:n})}return{timezone:a,business_hours_note:t,business_hours_config:s}}},c=({address:e,description:t,email:a,website:l,businessHours:s,categories:i})=>{var r=(0,n.default)({address:e,description:t,email:a,website:l,business_hours:u(s),categories:d(i)});return Object.keys(r).length>0?r:void 0};t.convertProfileToRequestData=c;var f=function(){var e=(0,i.default)((function*(e){var t=c(e);if(t){var a=(0,s.default)({v:2},t);try{var l=yield o.default.send2({data:["action","editBusinessProfile",a],retryOn5xx:!0}),{status:i}=l;if((e=>e>=200&&e<=299)(i))return;throw __LOG__(3)`error editing business profile webd: ${i}`,new r.ServerStatusCodeError(i,"edit business profile")}catch(e){var n=e;throw __LOG__(3)`error editing business profile: ${n}`,n}}else __LOG__(3)`empty profile received, ignoring save`}));return function(){return e.apply(this,arguments)}}();t.default=f},64644:(e,t,a)=>{"use strict";var l=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){if(i.default.supportsFeature(i.default.F.MD_BACKEND)&&e){var t=(0,n.unixTimeMs)(),a=d.default.getPushnameMutation(t,e);return(0,o.default)(e),(0,u.lockForSync)([],[a],(()=>Promise.resolve())).then((()=>({_duplicate:null})))}return r.default.setPushname(e).then((e=>{if(e.status&&200!==e.status)throw new s.ServerStatusCodeError(e.status);return{_duplicate:e._duplicate}}))};var s=a(66274),i=l(a(60246)),r=l(a(7682)),n=a(61658),o=l(a(40256)),d=l(a(86317)),u=a(85935)},39655:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CombinedFingerprintSpec=t.FingerprintDataSpec=void 0;var l=a(17126),s={};t.FingerprintDataSpec=s;var i={};t.CombinedFingerprintSpec=i,s.internalSpec={publicKey:[1,l.TYPES.BYTES],identifier:[2,l.TYPES.BYTES]},i.internalSpec={version:[1,l.TYPES.UINT32],localFingerprint:[2,l.TYPES.MESSAGE,s],remoteFingerprint:[3,l.TYPES.MESSAGE,s]}},42966:(e,t,a)=>{"use strict";var l=a(20862),s=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(a(48926)),r=s(a(81109)),n=l(a(67294)),o=s(a(87009)),d=s(a(73132)),u=s(a(10618)),c=s(a(66761)),f=a(17236),h=s(a(63203)),p=s(a(54151)),m=s(a(5750)),v=s(a(51231)),g=a(30449),E=a(54302).Mirrored(["START","END"]),_=f.BUSINESS_HOUR_MODES.SPECIFIC_HOURS,C=()=>[(0,g.minutesToTime)(540),(0,g.minutesToTime)(1080)];class S extends n.Component{constructor(...e){super(...e),this.state=(({businessHours:{mode:e,days:t}})=>{var a={};for(var{dayKey:l,closed:s,hours:i,dayName:r}of t)a[l]={closed:s,hours:i||[C()],dayKey:l,dayName:r};return{mode:e||_,dayValues:a}})(this.props)}_buildDayId({dayKey:e}){return`${e}_business_hours`}_renderCheckbox(e){var{closed:t,dayKey:a}=e,l=this._buildDayId(e);return n.default.createElement("div",{className:o.default.dayCheckbox},n.default.createElement(d.default,{id:l,checked:!t,onChange:()=>{var{dayValues:e}=this.state,t=e[a];this._updateDayValue(a,{closed:!t.closed})}}))}_renderTabs(){var{mode:e}=this.state;return n.default.createElement(m.default,{onSelect:e=>{if(e===f.BUSINESS_HOUR_MODES.OPEN_24H){var{dayValues:t}=this.state;for(var a of f.DAYS_OF_WEEK)t[a]=(0,r.default)((0,r.default)({},t[a]),{},{closed:!1});this.setState({mode:e,dayValues:t})}else this.setState({mode:e})},selectedId:e,tabConfigs:[{title:c.default.t(364),id:f.BUSINESS_HOUR_MODES.SPECIFIC_HOURS},{title:c.default.t(360),id:f.BUSINESS_HOUR_MODES.OPEN_24H},{title:c.default.t(361),id:f.BUSINESS_HOUR_MODES.APPOINTMENT_ONLY}]})}_updateValueToUserTimeFormat(e,t,a){var{dayValues:l}=this.state,s=l[e],{hours:i}=s,r=t===E.START?0:1,n=i[a][r],o=(0,g.timeStringToMinutes)(n);void 0!==o&&this._updateDayValue(e,{hours:this._updateHoursValue(i,(0,g.minutesToTime)(o),t,a)})}_updateHoursValue(e,t,a,l){var s=[...e],i=a===E.START?0:1,r=[...s[l]];return r[i]=t,s[l]=r,s}_renderTimeInput(e,t,a,l){var s=(0,g.isValidTime)(t)?null:" ";return n.default.createElement("div",{key:`${e}-${a}-${l}`,className:o.default.timeWrapper},n.default.createElement(v.default,{managed:!0,value:t,theme:"small",maxLength:15,customStyleThemes:["desaturated","noErrorInfo"],error:s,onChange:t=>{var{dayValues:s}=this.state,i=s[e],{hours:r}=i;this._updateDayValue(e,{hours:this._updateHoursValue(r,t,a,l)})},onBlur:()=>{this._updateValueToUserTimeFormat(e,a,l)}}))}_updateDayValue(e,t){var{dayValues:a}=this.state,l=a[e];this.setState({dayValues:(0,r.default)((0,r.default)({},a),{},{[e]:(0,r.default)((0,r.default)({},l),t)})})}_addHours(e){var{dayValues:t}=this.state,a=t[e],{hours:l}=a;this._updateDayValue(e,{hours:[...l,C()]})}_removeHours(e){var{dayValues:t}=this.state,a=t[e],{hours:l}=a,s=[...l];s.pop(),this._updateDayValue(e,{hours:s})}_renderAdd(e){return n.default.createElement("div",{className:o.default.timeWrapper},n.default.createElement(u.default,{"aria-label":c.default.t(1),label:c.default.t(222),onClick:()=>{this._addHours(e)},prefixIcon:"status-ciphertext",iconTheme:"padded-svg"}))}_renderRemove(e){return n.default.createElement("div",{className:o.default.timeWrapper},n.default.createElement(p.default,{title:c.default.t(1285),"aria-label":c.default.t(1285),name:"x-alt",onClick:()=>{this._removeHours(e)}}))}_renderHours({dayKey:e,hours:t}){var a=[],l=t.length>=2?this._renderRemove(e):this._renderAdd(e);return t.forEach((([t,l],s)=>{s>0&&a.push(n.default.createElement("div",{className:o.default.hoursAnd},c.default.t(354))),a.push(this._renderTimeInput(e,t,E.START,s),this._renderTimeInput(e,l,E.END,s))})),n.default.createElement("div",{className:o.default.hoursMain},a,l)}_renderDayValues(e,t){var a,{closed:l}=e;return l?a=c.default.t(356):t===f.BUSINESS_HOUR_MODES.APPOINTMENT_ONLY?a=c.default.t(355):t===f.BUSINESS_HOUR_MODES.OPEN_24H&&(a=c.default.t(367)),a?n.default.createElement("div",{className:o.default.dayInfoText},a):f.BUSINESS_HOUR_MODES.SPECIFIC_HOURS&&!e.closed?this._renderHours(e):null}_renderDayInfo(e,t){var{dayName:a}=e,l=this._buildDayId(e);return n.default.createElement("div",{className:o.default.dayInfo},n.default.createElement("label",{htmlFor:l},a),this._renderDayValues(e,t))}_renderDay(e){var{mode:t}=this.state;return n.default.createElement("div",{key:`day-${e.dayKey}`,className:o.default.dayMain},this._renderCheckbox(e),this._renderDayInfo(e,t))}_renderBusinessHours(){var{businessHours:{days:e}}=this.props;return n.default.createElement("div",null,this._renderTabs(),n.default.createElement("div",{className:o.default.editMain},e.map((({dayKey:e})=>{var t=this.state.dayValues[e];return this._renderDay(t)}))))}render(){var e=this,t=this._renderBusinessHours(),{mode:a,dayValues:l}=this.state,{businessHours:{note:s,timezone:r}}=this.props;return n.default.createElement(h.default,{title:c.default.t(362),isValid:(0,g.isValidBusinessHours)(a,l),doSave:(0,i.default)((function*(){yield e.props.saveBusinessProfile((0,g.convertToRawBusinessProfile)({mode:a,dayValues:l,note:s,timezone:r}))})),afterSave:this.props.afterSave,onCancel:this.props.onCancel},t)}}t.default=S,S.displayName="BusinessHours"},22018:(e,t,a)=>{"use strict";var l=a(20862),s=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(a(48926)),r=s(a(81109)),n=s(a(94184)),o=l(a(67294)),d=a(75787),u=a(72796),c=s(a(50743)),f=s(a(73132)),h=s(a(55839)),p=s(a(97420)),m=s(a(47060)),v=s(a(3152)),g=s(a(12063)),E=s(a(66761)),_=s(a(89329)),C=s(a(63203)),S=s(a(17363)),y=l(a(9931));class I extends o.Component{constructor(...e){super(...e),this.state=(({initialCategories:e})=>({selectedCategories:e,searchText:"",isLoading:!1}))(this.props),this.flatListController=new g.default,this.setRefList=e=>{this.list=e},this.renderItem=e=>{var t=o.default.createElement(f.default,{id:`${e.id}`,onChange:()=>{!e.disabled&&this._toggleResultById(e.id)},checked:e.selected,disabled:e.disabled}),a=o.default.createElement("label",{className:(0,n.default)(c.default.rowLabel,{[c.default.disabled]:e.disabled}),htmlFor:e.id},e.localized_display_name);return this._renderRow(a,t)},this._removeById=e=>{var t=this.state.selectedCategories.filter((t=>t.id===e))[0];t&&this.toggle(t)},this._toggleResultById=e=>{var t,a=null===(t=this.state.results)||void 0===t?void 0:t.filter((t=>t.id===e))[0];a&&this.toggle(a)},this.toggle=e=>{var t,a=null===(t=this.state.results)||void 0===t?void 0:t.find((e=>e.not_a_biz)),l=this.state.selectedCategories.find((e=>e.id===(null==a?void 0:a.id))),s=this.state.selectedCategories;this.state.selectedCategories.length>0&&(e.not_a_biz&&!l?(s=[],this._showConflictWarning()):!e.not_a_biz&&l&&(s=this.state.selectedCategories.filter((e=>e.id!==l.id)),this._showConflictWarning())),this.isSelected(e.id)?this.setState({selectedCategories:s.filter((t=>t.id!==e.id))}):this.setState({selectedCategories:[...s,e]})},this.setSearchText=e=>{this._getResults(e)},this.onRemoveItem=e=>{this.setState({selectedCategories:this.state.selectedCategories.filter((t=>t.id!==e.id))})}}componentDidMount(){this._getResults("")}renderList(){if(this.state.isLoading)return o.default.createElement("div",{className:c.default.loadingSpinner},o.default.createElement(S.default,{color:"highlight",size:44,stroke:6}));if(!this.state.results||0===this.state.results.length)return this._renderRow(E.default.t(401),null);var e=this.state.results.map((e=>(0,r.default)((0,r.default)({},e),{},{id:e.id,itemKey:e.id.toString(),disabled:this.isDisabled(e),selected:this.isSelected(e.id)})));return o.default.createElement(v.default,{flatListControllers:[this.flatListController]},o.default.createElement(m.default,{ref:this.setRefList,data:e,flatListController:this.flatListController,direction:"vertical",renderItem:this.renderItem,defaultItemHeight:48}))}_renderRow(e,t){return o.default.createElement("div",{className:c.default.rowMain},o.default.createElement("div",{className:c.default.rowCheckbox},t),e)}_renderSearchBox(){return o.default.createElement(_.default,{onSearch:this.setSearchText,placeholder:E.default.t(403)})}_renderFooter(){return this.state&&this.state.selectedCategories?o.default.createElement(h.default,{categories:this.state.selectedCategories,onRemoveItem:this._removeById}):null}_showConflictWarning(){p.default.openToast(o.default.createElement(y.default,{id:(0,y.genId)(),msg:E.default.t(381)}))}isSelected(e){for(var{selectedCategories:t}=this.state,a=0;a<t.length;a++)if(t[a].id===e)return!0;return!1}isDisabled(e){return!e.not_a_biz&&!this.isSelected(e.id)&&this.state.selectedCategories.length>=u.MAX_BUSINESS_CATEGORIES}_getResults(e){this.setState({isLoading:!0}),this.props.searchCategories(e||d.BUSINESS_CATEGORY_EMPTY_STR_ID).then((t=>{var a=t.categories;""!==e&&(a=a.filter((e=>!e.not_a_biz))),this.setState({isLoading:!1,results:a})})).catch((()=>{p.default.openToast(o.default.createElement(y.default,{id:(0,y.genId)(),msg:E.default.t(380)})),this.setState({isLoading:!1,results:[]})}))}render(){var e,t=this;return this.state.selectedCategories.length&&(e=this._renderFooter()),o.default.createElement(C.default,{title:E.default.t(382),isValid:this.state.selectedCategories.length>0,doSave:(0,i.default)((function*(){yield t.props.saveBusinessProfile({categories:t.state.selectedCategories})})),afterSave:this.props.afterSave,onCancel:this.props.onCancel},o.default.createElement("div",{className:c.default.searchBackground},this._renderSearchBox()),o.default.createElement("div",{className:c.default.editMain},o.default.createElement("div",{className:c.default.list},this.renderList()),e))}}t.default=I,I.displayName="Categories"},67082:(e,t,a)=>{"use strict";var l=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=l(a(67154)),i=l(a(67294)),r=l(a(9515)),n=l(a(42966)),o=a(72203),d=l(a(22018)),u=l(a(97420)),c=l(a(25404)),f=l(a(76482)),h=a(53615),p=l(a(92325)),m=l(a(66761)),v=a(65987),g=l(a(57736)),E=l(a(5148)),_=a(85920),C=a(64730),S=l(a(51231)),y=l(a(53918)),I=a(71285),{useState:M,useEffect:P}=i.default,L=256,T=512,b=128,D=256;t.default=({businessProfile:e,saveBusinessProfile:t,sessionId:a,verifiedName:l})=>{var[N,O]=M(),[w,k]=M(),[R,A]=M(),[x,F]=M(),[U,B]=M(),[H,G]=M(),[V,j]=M(),[W,K]=M(),[z,Y]=M(),[q,Z]=M(!1),[$,X]=M();P((()=>{var t=(0,C.convertRawBusinessProfile)(e);O(t.description),A(t.email),k(t.address),F(t.primaryWebsite),B(t.secondaryWebsite),G(Boolean(t.primaryWebsite&&!t.secondaryWebsite))}),[e]),P((()=>{(0,I.validateEmail)(R)&&j(null)}),[R]),P((()=>{(0,I.validateURL)(x)&&K(null)}),[x]),P((()=>{(0,I.validateURL)(U)&&Y(null)}),[U]);var J,Q=()=>{var e=[];return x&&e.push(x),U&&e.push(U),{website:e.map(((e,t)=>{if(!y.default.isHttps(e)&&!y.default.isHttp(e)){var a=`https://${e}`;return 0===t?F(a):B(a),a}return e}))}},ee=e=>i.default.createElement(p.default,(0,s.default)({},e,{hideEditIcon:Boolean($)})),te=({setValue:l,value:r,fieldKey:n,fieldMetric:o,originalValue:d,textFieldConfig:u,formatForSave:c,validate:f,onError:h,error:p,lowProfile:m,placeholder:g,startActive:E})=>{var C=(null==$?void 0:$.fieldKey)===n,y=r?void 0:g;return i.default.createElement(S.default,(0,s.default)({value:r,editable:!$||C,pending:C&&(null==$?void 0:$.editType)===_.EditType.PENDING,showRemaining:!0,onBeginEdit:()=>{(0,v.logProfileFieldOpen)(o,e,a),X({fieldKey:n,editType:_.EditType.EDITING})},onChange:l,onSave:()=>{(0,v.logProfileFieldSave)(o,e,a),X({fieldKey:n,editType:_.EditType.PENDING}),t(c()).then((()=>{X()}),(()=>{X()}))},onCancel:()=>{(0,v.logProfileFieldDiscard)(o,e,a),l(d),X()},lockable:!0,lowProfile:m,multiline:!0,inputPlaceholder:y,theme:"text-input",validate:f,onError:h,error:p,a8n:`biz-profile-${n}-input`,startActive:E},u))},ae=(0,C.convertRawBusinessProfile)(e),le=m.default.t(398),se=void 0;return(0,h.canSeeBizProfileV3)()&&(le=null,se=f.default.noPaddingTop),i.default.createElement(c.default,{title:le,theme:"refresh",className:se},(e=>{if(!e)return null;var t=(0,h.canSeeBizProfileV3)()?"no-margin":void 0;return ee({theme:t,icon:"account-box",iconClass:f.default.verifiedNameIcon,content:i.default.createElement("div",null,i.default.createElement("div",null,e),i.default.createElement("div",{className:f.default.infoText},m.default.t(400)))})})(l),ee({icon:"business-description",content:te({value:N,setValue:O,originalValue:ae.description,fieldKey:"description",fieldMetric:E.default.BUSINESS_PROFILE_FIELD.DESCRIPTION,placeholder:m.default.t(390),textFieldConfig:{maxLength:T,supportsEmoji:!0},lowProfile:!0,formatForSave:()=>({description:N})})}),ee({icon:"business-category",type:"container",emptyText:m.default.t(389),content:(J=ae.categories,0===J.length?null:i.default.createElement("div",null,J.map((e=>e.localized_display_name)).join(m.default.t(658)))),onEdit:()=>{(0,v.logProfileFieldOpen)(E.default.BUSINESS_PROFILE_FIELD.CATEGORY,e,a),u.default.openModal(i.default.createElement(d.default,{initialCategories:ae.categories,saveBusinessProfile:t,searchCategories:e=>r.default.find(e),afterSave:()=>(0,v.logProfileFieldSave)(E.default.BUSINESS_PROFILE_FIELD.CATEGORY,e,a),onCancel:()=>{(0,v.logProfileFieldDiscard)(E.default.BUSINESS_PROFILE_FIELD.CATEGORY,e,a)}}))}}),ee({icon:"business-address",content:(e=>{var t,a=te({value:w,placeholder:m.default.t(387),setValue:k,originalValue:e.address,fieldKey:"address",fieldMetric:E.default.BUSINESS_PROFILE_FIELD.ADDRESS,textFieldConfig:{maxLength:D},lowProfile:!0,formatForSave:()=>({address:w})}),{latitude:l,longitude:s}=e;return null!=l&&null!=s&&(t=((e,t)=>{var a;return"address"===(null==$?void 0:$.fieldKey)&&(a=i.default.createElement("div",{className:f.default.mapOverlay},i.default.createElement("div",{className:f.default.overlayHint},m.default.t(393)))),i.default.createElement("div",{style:{height:96},className:f.default.businessMap},a,i.default.createElement(g.default,{lat:e,lng:t,name:w,width:312,height:96}))})(l,s)),i.default.createElement(i.default.Fragment,null,a,t)})(ae)}),ee({icon:"business-hours",type:"container",emptyText:m.default.t(388),content:(({mode:e,days:t})=>null==e?null:i.default.createElement("div",null,t.map((({dayName:t,dayKey:a,closed:l,hours:s})=>i.default.createElement("div",{key:a,className:f.default.businessHoursSection},i.default.createElement("div",{className:f.default.businessHoursDayColumn},t),i.default.createElement("div",{className:f.default.businessHoursTimeColumn},((e,t,a)=>{if(t)return m.default.t(356);switch(e){case o.BUSINESS_HOUR_MODES.SPECIFIC_HOURS:return i.default.createElement(i.default.Fragment,null,a&&a.map((([e,t],a)=>i.default.createElement("div",{key:a,className:f.default.businessHoursTime},e," - ",t))));case o.BUSINESS_HOUR_MODES.APPOINTMENT_ONLY:return m.default.t(355);case o.BUSINESS_HOUR_MODES.OPEN_24H:return m.default.t(367);default:return null}})(e,l,s)))))))(ae.hours),onEdit:()=>{(0,v.logProfileFieldOpen)(E.default.BUSINESS_PROFILE_FIELD.HOURS,e,a),u.default.openModal(i.default.createElement(n.default,{businessHours:ae.hours,saveBusinessProfile:t,onCancel:()=>{(0,v.logProfileFieldDiscard)(E.default.BUSINESS_PROFILE_FIELD.HOURS,e,a)},afterSave:()=>(0,v.logProfileFieldSave)(E.default.BUSINESS_PROFILE_FIELD.HOURS,e,a)}))}}),ee({icon:"business-email",content:te({value:R,placeholder:m.default.t(391),originalValue:ae.email,setValue:A,fieldKey:"email",fieldMetric:E.default.BUSINESS_PROFILE_FIELD.EMAIL,textFieldConfig:{maxLength:b},error:V,lowProfile:!1,formatForSave:()=>({email:R}),validate:e=>(0,I.validateEmail)(e),onError:()=>{j(m.default.t(724))}})}),(e=>{var t=te({value:x,placeholder:m.default.t(399),originalValue:e.primaryWebsite,setValue:F,fieldKey:"primaryWebsite",fieldMetric:E.default.BUSINESS_PROFILE_FIELD.WEBSITE,textFieldConfig:{maxLength:L},formatForSave:Q,lowProfile:!1,validate:I.validateURL,onError:()=>{K(m.default.t(732))},error:W});return ee({icon:"business-website",theme:"small-margin",content:i.default.createElement("div",null,t)})})(ae),(e=>{if(!e.primaryWebsite)return null;if(U||!H){var t=te({placeholder:m.default.t(399),value:U,originalValue:e.secondaryWebsite,setValue:B,fieldKey:"secondaryWebsite",fieldMetric:E.default.BUSINESS_PROFILE_FIELD.WEBSITE,textFieldConfig:{maxLength:L},formatForSave:Q,lowProfile:!1,validate:I.validateURL,onError:()=>{Y(m.default.t(732))},error:z,startActive:q});return ee({icon:"business-website",theme:"no-margin",content:i.default.createElement("div",null,t)})}var a=i.default.createElement("button",{className:f.default.addAnotherWebsite,onClick:()=>{G(!1),Z(!0)}},m.default.t(386));return ee({theme:"no-margin",content:i.default.createElement("div",null,a)})})(ae))}},75598:(e,t,a)=>{"use strict";var l=a(20862),s=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(a(48926)),r=l(a(67294)),n=s(a(99420)),o=a(13151),d=s(a(27306)),u=s(a(3243)),c=s(a(25404)),f=s(a(67082)),h=s(a(62389)),p=a(67052),m=a(56726),v=s(a(66761)),g=a(65987),E=a(85920),_=s(a(17363)),C=a(75740),{useState:S,useEffect:y}=r.default,I=function(){var e=(0,i.default)((function*(){var e=(0,m.getMeUser)(),t=n.default.get(e);return t&&t.markStale(),(yield n.default.find(e)).serialize()}));return function(){return e.apply(this,arguments)}}(),M=function(){var e=(0,i.default)((function*(){var e=(0,m.getMeUser)(),t=yield n.default.update(e);return(Array.isArray(t)?t[0]:t).serialize()}));return function(){return e.apply(this,arguments)}}();var P=function(){var[e,t]=S(E.LoadType.PENDING),[a,l]=S(),s=(0,r.useRef)(Math.floor(2147483648*Math.random()).toString()),n=function(){var e=(0,i.default)((function*(){t(E.LoadType.PENDING);try{var e=yield I();l(e),t(E.LoadType.DONE),(0,g.logProfileOpen)(e,s.current)}catch(e){t(E.LoadType.ERROR)}}));return function(){return e.apply(this,arguments)}}();return y((()=>{n()}),[]),e===E.LoadType.PENDING?r.default.createElement("div",{className:h.default.loadingSpinner},r.default.createElement(_.default,{color:"default",size:24,stroke:6})):e===E.LoadType.ERROR?r.default.createElement(c.default,{title:v.default.t(398),theme:"refresh"},r.default.createElement(p.FlexRow,{align:"center",justify:"center"},r.default.createElement(p.FlexItem,null,v.default.t(396)),r.default.createElement(p.FlexItem,{className:h.default.retryButton},r.default.createElement(d.default,{onClick:()=>{n()},type:"simplified"},v.default.t(1316))))):e===E.LoadType.DONE&&a?r.default.createElement(f.default,{verifiedName:u.default.pushname||void 0,sessionId:s.current,businessProfile:a,saveBusinessProfile:function(){var e=(0,i.default)((function*(e){try{yield(0,o.editBusinessProfile)(e)}catch(e){throw(0,C.showError)(v.default.t(397)),__LOG__(3,void 0,void 0,!0)`business_profile:edit_form save failed`,SEND_LOGS(`businessProfile edit handled server error - ${e.status}`),e}try{var t=yield M();return l(t),t}catch(e){throw(0,C.showError)(v.default.t(396)),e}}));return function(){return e.apply(this,arguments)}}()}):null};t.default=P},65987:(e,t,a)=>{"use strict";var l=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.getProfilePopulatedFields=r,t.logProfileOpen=function(e,t){var a=new i.default.EditBusinessProfile((0,s.default)({editProfileAction:i.default.EDIT_PROFILE_ACTION.ACTION_OPEN,businessProfileEntryPoint:i.default.BUSINESS_PROFILE_ENTRY_POINT.SETTINGS,editBusinessProfileSessionId:t},r(e)));a&&a.commit()},t.logProfileFieldOpen=function(e,t,a){var l=new i.default.EditBusinessProfile((0,s.default)({editProfileAction:i.default.EDIT_PROFILE_ACTION.ACTION_PROFILE_FIELD_OPEN,businessProfileEntryPoint:i.default.BUSINESS_PROFILE_ENTRY_POINT.SETTINGS,editProfileActionField:e,editBusinessProfileSessionId:a},r(t)));l&&l.commit()},t.logProfileFieldSave=function(e,t,a){var l=new i.default.EditBusinessProfile((0,s.default)({editProfileAction:i.default.EDIT_PROFILE_ACTION.ACTION_PROFILE_FIELD_SAVE,businessProfileEntryPoint:i.default.BUSINESS_PROFILE_ENTRY_POINT.SETTINGS,editProfileActionField:e,editBusinessProfileSessionId:a},r(t)));l&&l.commit()},t.logProfileFieldDiscard=function(e,t,a){var l=new i.default.EditBusinessProfile((0,s.default)({editProfileAction:i.default.EDIT_PROFILE_ACTION.ACTION_PROFILE_FIELD_DISCARD,businessProfileEntryPoint:i.default.BUSINESS_PROFILE_ENTRY_POINT.SETTINGS,editProfileActionField:e,editBusinessProfileSessionId:a},r(t)));l&&l.commit()};var s=l(a(81109)),i=l(a(5148));function r(e){var t;return{hasDescription:null!=e.description,hasCategory:!!(e.categories&&e.categories.length>0),hasHours:null!=(null===(t=e.businessHours)||void 0===t?void 0:t.config),hasEmail:null!=e.email,hasAddress:null!=e.address,hasWebsite:null!=e.website}}},64730:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.convertRawBusinessProfile=void 0;var l=a(46822);t.convertRawBusinessProfile=e=>{var{description:t,email:a,address:s,website:i,categories:r,businessHours:n,latitude:o,longitude:d}=e,[u,c]=i||[];return{description:t,email:a,address:s,primaryWebsite:u,secondaryWebsite:c,hours:(0,l.getBusinessHoursForEdit)(n),categories:r||[],latitude:o,longitude:d}}},75740:(e,t,a)=>{"use strict";var l=a(20862),s=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.showError=void 0;var i=s(a(67294)),r=s(a(97420)),n=l(a(9931));t.showError=e=>{r.default.openToast(i.default.createElement(n.default,{msg:e,duration:6e3,id:(0,n.genId)()}))}},92325:(e,t,a)=>{"use strict";var l=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=l(a(94184)),i=l(a(67294)),r=l(a(89450)),n=l(a(66761)),o=l(a(54151)),d=l(a(62745));t.default=({icon:e,iconClass:t,content:a,onEdit:l,type:u="field",emptyText:c,hideEditIcon:f,theme:h})=>{var p=l?i.default.createElement("div",{className:(0,s.default)(r.default.sectionEditIcon,{[r.default.hidden]:f})},i.default.createElement(o.default,{"aria-label":n.default.t(641),name:"pencil",className:r.default.editPencil,directional:!0,title:n.default.t(641),onClick:()=>{l()}})):void 0,m=c&&!a,v=m?c:a,g=e?i.default.createElement(d.default,{name:e}):null;return i.default.createElement("div",{className:(0,s.default)(r.default.section,{[r.default.smallMargin]:"small-margin"===h,[r.default.noMargin]:"no-margin"===h})},i.default.createElement("div",{className:(0,s.default)(r.default.sectionPrimaryIcon,t,{[r.default.fieldPrimaryIcon]:"field"===u})},g),i.default.createElement("div",{className:(0,s.default)(r.default.sectionMain,{[r.default.sectionContainerMain]:"container"===u,[r.default.sectionEmptyText]:m})},v),p)}},51968:(e,t,a)=>{"use strict";var l=a(20862),s=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.CartDetailDrawer=void 0;var i=s(a(48926)),r=a(58328),n=l(a(67294)),o=s(a(99420)),d=a(84442),u=s(a(27306)),c=s(a(66281)),f=s(a(19453)),h=s(a(67744)),p=s(a(84818)),m=s(a(97420)),v=s(a(58743)),g=s(a(46274)),E=l(a(25246)),_=s(a(3395)),C=s(a(34727)),S=s(a(31763)),y=l(a(85002)),I=l(a(92246)),M=s(a(12063)),P=s(a(98607)),L=s(a(66761)),T=s(a(48878)),b=a(25500),D=a(94804),N=s(a(39052)),O=s(a(80941)),w=a(66248),k=s(a(52206)),R=s(a(86578)),A=s(a(92120)),x=s(a(58734)),F=s(a(32536)),U=s(a(62745)),B=a(45739),H=s(a(52059)),G=s(a(77923));class V extends n.Component{constructor(e){var t;super(e),t=this,this._cartFlatListController=new M.default,this.updateData=function(){var e=(0,i.default)((function*(e){var[a,l]=yield Promise.all([e?(0,R.default)(t.state.cart):Promise.resolve(),o.default.find(t.props.chat.id)]);a&&(t.refreshedCart=a);var s=(0,N.default)(t.state.cart,t.refreshedCart);t.setState({businessProfile:l,cartProductItems:s,isLoading:!1})}));return function(){return e.apply(this,arguments)}}(),this.onSend=()=>{var{cart:e}=this.state;this.setState({isLoading:!0}),(0,F.default)(e,this.props.chat).then((t=>{var a=Boolean(e.message);(0,b.logSendOrderMessage)({orderId:t,catalogOwnerJid:e.id,catalogContext:(0,w.getProductCatalogContext)(this.context),isOrderMsgAttached:a,quantity:e.itemCount}),this.props.onBack(),(0,p.default)(e),e.message=void 0,this.props.closeDrawerRightOnSend&&this._closeDrawerRight()})).catch((()=>{__LOG__(4,!0,new Error,!0)`Unable to create catalog order`,SEND_LOGS("submitOrder: order creation or order message send error"),(0,x.default)(),this.updateData(!0)})).finally((()=>{this.setState({isLoading:!1})}))},this.onChange=e=>{var{cart:t}=this.state;this.setState({cartMessage:e},(()=>{(0,H.default)(t,e)}))},this._setRefMessageInput=e=>{this._refMessageInput=e},this.onMaxPasteExceeded=()=>{m.default.openModal(n.default.createElement(v.default,{title:L.default.t(430),onOK:()=>{m.default.closeModal()},okText:L.default.t(1826)},L.default.t(429)))},this.updateDataQueue=new r.PromiseQueue;var a=c.default.findCart(this.props.sellerJid);this.state={isLoading:!0,businessProfile:void 0,cartProductItems:[],cartMessage:a.message,cart:a}}_closeDrawerRight(){m.default.existsDrawerRight((e=>{e&&m.default.closeDrawerRight()}))}componentDidMount(){var{cart:e}=this.state,{listeners:t,rejectOnUnmount:a}=this.props;t.add(e,"change:cartItemCollection",(()=>{this.updateDataQueue.enqueue((()=>this.updateData()))})),this.updateData(!0).checkpoint(a()).then((()=>{(0,D.logCartListImpression)(e.id.toString(),(0,w.getProductCatalogContext)(this.context))})).catchType(I.Unmount,(()=>{})).catch((()=>{__LOG__(4,!0,new Error,!0)`Unable to open the cart`,SEND_LOGS("openCart: failed to open the cart"),(0,x.default)(),(0,p.default)(e)})).finally((()=>{this.setState({isLoading:!1})}))}_emptyCartContent(){return n.default.createElement("div",{className:f.default.emptyCartContainer},n.default.createElement(U.default,{name:"shopping-cart-empty"}),n.default.createElement(B.TextDiv,{className:f.default.emptyCardHeader,theme:"large"},L.default.t(422)),n.default.createElement(B.TextDiv,{className:f.default.emptyCardText,theme:"plain"},L.default.t(423)),(0,d.hasCatalog)(this.state.businessProfile)&&n.default.createElement(u.default,{onClick:this.props.onProductCatalog,type:"primary"},L.default.t(1248)))}_getDrawerContent(){var{chat:e,sellerJid:t}=this.props,{cart:a}=this.state;if(this.state.isLoading)return n.default.createElement(P.default,null);var l,s,i=a.itemCount,r=i>0;if(r){var o=L.default.t(908,{count:i,_plural:i});l=n.default.createElement(B.TextDiv,{theme:"title"},o)}null!=a.total&&null!=a.currency?s=n.default.createElement(B.TextDiv,{theme:"muted-small"},L.default.t(1215,{subtotal:E.format(a.currency,a.total)})):i>0&&(s=n.default.createElement(B.TextDiv,{theme:"muted-small"},L.default.t(1211)));var d=n.default.createElement(G.default,{transitionName:"media-caption",className:f.default.cartMessage},n.default.createElement(O.default,{ref:this._setRefMessageInput,chat:e,maxLength:g.default.MAX_CART_MESSAGE_LENGTH,multiline:!0,onEnter:this.onSend,onChange:this.onChange,onMaxPasteExceeded:this.onMaxPasteExceeded,placeholder:L.default.t(428),showRemaining:!0,spellCheck:!0,supportsEmoji:!0,value:this.state.cartMessage})),u=n.default.createElement("button",{className:f.default.btnSend,tabIndex:"-1",onClick:this.onSend,title:L.default.t(433)},n.default.createElement(A.default,{large:!0},n.default.createElement(U.default,{name:"send",directional:!0})));return n.default.createElement(n.default.Fragment,null,!r&&this._emptyCartContent(),n.default.createElement("div",{className:f.default.info},l,s),n.default.createElement(h.default,{flatListController:this._cartFlatListController,onProductDetail:this.props.onProductDetail,cart:a,sellerJid:t,cartProductItems:this.state.cartProductItems}),r&&n.default.createElement("div",{className:f.default.footer},d,n.default.createElement(G.default,{transitionAppear:!0,transitionName:"btn"},u)))}render(){var{onBack:e}=this.props;return n.default.createElement(_.default,{onDrop:e,theme:"striped"},n.default.createElement(y.default,{title:L.default.t(421),type:y.DRAWER_HEADER_TYPE.SMALL,onBack:e}),n.default.createElement(C.default,{flatListControllers:[this._cartFlatListController]},this._getDrawerContent()))}}t.CartDetailDrawer=V,V.contextType=S.default,V.displayName="CartDetailDrawer";var j=(0,k.default)((0,T.default)(V));t.default=j},67744:(e,t,a)=>{"use strict";var l=a(20862),s=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(a(73955)),r=l(a(67294)),n=s(a(50812)),o=s(a(46274)),d=s(a(47060)),u=s(a(3152));class c extends r.PureComponent{constructor(...e){super(...e),this.getData=()=>this.props.cartProductItems.map((e=>({itemKey:e.cartItem.id,contentKey:(0,i.default)("cartItem"),product:e.product,cartItem:e.cartItem}))),this.renderItem=e=>{var{onProductDetail:t,sellerJid:a}=this.props,l={productId:e.cartItem.id,businessOwnerJid:a};return r.default.createElement(n.default,{cartId:a,product:e.product,quantity:e.cartItem.quantity,onClick:()=>t(l)})}}render(){return r.default.createElement(u.default,{flatListControllers:[this.props.flatListController]},r.default.createElement(d.default,{flatListController:this.props.flatListController,direction:"vertical",forceConsistentRenderCount:!1,data:this.getData(),renderItem:this.renderItem,defaultItemHeight:o.default.PRODUCT_LIST_ITEM_HEIGHT}))}}t.default=c,c.displayName="CartProductList"},50812:(e,t,a)=>{"use strict";var l=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t,a,{product:l,onClick:E}=e,_=s.default.createElement(c.default,{text:l.name,ellipsify:!0,titlify:!0}),C=null===(t=l.getPreviewImage())||void 0===t?void 0:t.mediaData;a=C?s.default.createElement(v.default,{theme:"list",mediaData:C}):s.default.createElement(s.default.Fragment,null);var S=s.default.createElement(m.default,{className:i.default.price,product:l,fallback:f.default.t(424)});return s.default.createElement(n.default,{key:l.id.toString(),image:a,customImage:!0,primary:_,secondary:S,theme:"cart-product",onClick:E,detail:s.default.createElement(u.default.Consumer,null,(t=>s.default.createElement("div",{className:i.default.actions},s.default.createElement(r.default,{quantity:e.quantity,onChange:a=>function(t,a){var{cartId:l,product:s}=e;(0,g.default)(l,s,t),(0,h.logEditProduct)(s,a,t)}(a,(0,p.getProductCatalogContext)(t))}),s.default.createElement("div",{className:i.default.deleteIcon},s.default.createElement(o.default,{onClick:a=>function(t,a){var{cartId:l,product:s}=e,i=(0,d.default)(l,s.id.toString());(0,d.default)(l,s.id.toString()),(0,h.logDeleteProduct)(s,a),0===i&&(0,h.logCartAbandon)(s.catalogWid.toString(),a),function(e){e.preventDefault(),e.stopPropagation()}(t)}(a,(0,p.getProductCatalogContext)(t))}))))),className:i.default.cartListItem})};var s=l(a(67294)),i=l(a(65324)),r=l(a(49111)),n=l(a(79274)),o=l(a(38494)),d=l(a(63956)),u=l(a(31763)),c=l(a(98712)),f=l(a(66761)),h=a(94804),p=a(66248),m=l(a(48709)),v=l(a(38924)),g=l(a(63435))},49111:(e,t,a)=>{"use strict";var l=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return s.default.createElement("div",{className:r.default.select},s.default.createElement("select",{onClick:function(e){e.preventDefault(),e.stopPropagation()},value:e.quantity,onChange:function(t){var a=t.target;a instanceof HTMLSelectElement&&e.onChange(parseInt(a.value,10))}},function(){for(var e=[],t=1;t<=i.MAX_QUANTITY;t++)e.push(s.default.createElement("option",{key:t,value:t},t));return e}()))};var s=l(a(67294)),i=a(59706),r=l(a(5323))},38494:(e,t,a)=>{"use strict";var l=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return s.default.createElement(n.default,{"aria-label":r.default.t(1259),name:"delete",title:r.default.t(1259),className:i.default.deleteIcon,onClick:e.onClick})};var s=l(a(67294)),i=l(a(33776)),r=l(a(66761)),n=l(a(54151))},20432:(e,t,a)=>{"use strict";var l=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=l(a(67294)),i=l(a(62067)),r=l(a(79274)),n=l(a(56656)),o=l(a(8959));t.default=({title:e,icon:t,t:a})=>{var l=null!=a?n.default.relativeDateAndTimeStr(a):"-",d=s.default.createElement("div",{className:o.default.title,"data-a8n":i.default.key("msg-info-title")},t,e);return s.default.createElement(r.default,{primary:d,secondary:l,theme:"plain",idle:!0})}},53422:(e,t,a)=>{"use strict";var l=a(95318),s=a(20862);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(a(67294)),r=l(a(95925)),n=l(a(56656)),o=l(a(27890)),d=l(a(98712)),u=l(a(39893)),c=l(a(82286));class f extends i.PureComponent{render(){var e,{contact:t,msgInfoParticipant:a}=this.props,l=i.default.createElement(o.default,{id:t.id}),s=n.default.relativeDateAndTimeStr(a.t),c=i.default.createElement("span",{title:s},s);return!t.name&&t.notifyName&&(e=i.default.createElement(d.default,{className:u.default.notifyName,direction:"auto",text:t.notifyName})),i.default.createElement(r.default,{contextEnabled:()=>!1,image:l,primary:i.default.createElement(d.default,{direction:"auto",text:t.formattedName,titlify:!0,ellipsify:!0}),secondary:c,secondaryDetail:e,style:{cursor:"auto"},theme:"drawer-list",idle:!0})}}f.CONCERNS={msgInfoParticipant:["t"],contact:["id","name","formattedName","notifyName"]},f.displayName="GroupMsgInfoCell";var h=(0,c.default)(f,f.CONCERNS);t.default=h},23331:(e,t,a)=>{"use strict";var l=a(95318),s=a(20862);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(a(67294)),r=l(a(66761)),n=l(a(78749)),o=l(a(82286)),d=l(a(62745)),u=a(45739);class c extends i.PureComponent{render(){var{numTimesForwarded:e,isFrequentlyForwarded:t}=this.props.msg;if(e<=0||t)return null;var a=i.default.createElement(d.default,{name:"forwarded",display:"inline",className:n.default.icon}),l=r.default.t(755,{count:e,_plural:e});return i.default.createElement("div",{className:n.default.title},a,i.default.createElement(u.TextSpan,{theme:"title",className:n.default.text},l))}}c.CONCERNS={msg:["numTimesForwarded","isFrequentlyForwarded"]},c.displayName="MsgInfoForwardCount";var f=(0,o.default)(c,c.CONCERNS);t.default=f},51885:(e,t,a)=>{"use strict";var l=a(95318),s=a(20862);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(a(67294)),r=l(a(6699)),n=s(a(2078)),o=l(a(18917)),d=l(a(46274)),u=s(a(84051)),c=l(a(15308)),f=s(a(47060)),h=l(a(79766)),p=l(a(66761)),m=l(a(84026)),v=l(a(24927));class g extends i.PureComponent{constructor(...e){super(...e),this.selection=new v.default([],(e=>e.id.toString())),this._getSelectionList=()=>{var{contacts:e,frequentContacts:t}=this.props,a=[],l=[];return e.forEach((e=>{if(e.isGroup){var t=o.default.get(e.id);t&&l.push(t)}else a.push(e)})),(t||[]).concat(a).concat(l)},this.onFocusGain=e=>{e.target===this.refList&&(this.selection.index<0?this.focusFirst():this.selection.reset(!0))},this.focusFirst=()=>{this.selection.setFirst(!0)},this._onNextContact=e=>{e.preventDefault(),e.stopPropagation(),this.selection.setNext(!0)},this._onPrevContact=e=>{e.preventDefault(),e.stopPropagation(),this.selection.prev()>-1?this.selection.setPrev(!0):(this.selection.unset(),this.props.onFocusSearch(e))},this.setRefHotKeys=e=>{this.refList=e},this._renderContact=(e,t)=>{var a;return e.isBlocked()&&(a=p.default.t(575)),i.default.createElement(u.default,{active:this.selection,contact:e,onClick:this.props.onClick,secondary:a,frequent:t,waitIdle:!0})},this.renderItem=e=>{switch(e.type){case 0:return i.default.createElement(m.default,{key:"frequent-contacts-header",header:p.default.t(1703)});case 3:var{data:t,frequent:a}=e;return this._renderChat(t,a);case 2:var{data:l,frequent:s}=e;return this._renderContact(l,s);case 1:var{data:n,separator:o}=e;return i.default.createElement("div",{className:c.default.header},o?i.default.createElement(r.default,{key:`separator-${n}`}):null,i.default.createElement(m.default,{header:n}));default:throw new f.UnknownDataError(e)}}}_renderChat(e,t){return i.default.createElement(n.default,{active:this.selection,chat:e,mode:n.Mode.INFO,noContext:!0,onClick:this.props.onClick,frequent:t})}_getFrequentContactsData(e){var t=[];return e.forEach((e=>{var a=this._getContactDataItem(e,!0);a&&t.push(a)})),t}_getContactDataItem(e,t){var a=(t?u.FREQUENT_PREFIX:"")+e.id.toString();if(e.isGroup){var l=o.default.get(e.id);return l?{itemKey:a,data:l,type:3,frequent:t}:null}return{itemKey:a,data:e,type:2,frequent:t}}getData(){var{frequentContacts:e}=this.props,t=[],a=[],l=[];e&&e.length&&(t.push({itemKey:"frequent-contacts-header",type:0}),t.push(...this._getFrequentContactsData(e))),this.props.contacts.forEach((e=>{e.isGroup?l.push(e):a.push(e)}));var s=this._getDataFromContacts(a),i=this._getDataFromContacts(l);if(this.props.showPersonGroupDivisionHeader&&s.length>0){var r=p.default.t(1674);t.push({itemKey:`header-${r}`,data:r,separator:!0,type:1})}if(t.push(...s),this.props.showPersonGroupDivisionHeader&&i.length>0){var n=p.default.t(1781);t.push({itemKey:`header-${n}`,data:n,separator:!0,type:1})}return t.push(...i),t}_getDataFromContacts(e){if(0===e.length)return[];for(var t=e[0].isGroup?"group":"contact",a=[],l=e.length>10,s="XXX",i=0;i<e.length;i++){var r=e[i];if(l&&r.header){var n=r.header;if(n!==s){var o=i<e.length-1&&n!==e[i+1].header;a.push({itemKey:`header-${t}-${n}`,data:n,separator:o,type:1}),s=n}}var d=this._getContactDataItem(r);d&&a.push(d)}return a}render(){this.selection.init(this._getSelectionList());var e={down:this._onNextContact,up:this._onPrevContact};return i.default.createElement(h.default,{onRef:this.setRefHotKeys,handlers:e,onFocus:this.onFocusGain,"data-tab":d.default.TAB_ORDERS.CHAT_CONTACT_LIST,"data-testid":"contact-list-key"},i.default.createElement(f.default,{data:this.getData(),renderItem:this.renderItem,flatListController:this.props.flatListController,direction:"vertical"}))}}t.default=g,g.displayName="ContactList"},1600:(e,t,a)=>{"use strict";var l=a(20862),s=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(a(35161)),r=l(a(67294)),n=l(a(84051)),o=s(a(79766)),d=s(a(66761)),u=s(a(24927));class c extends r.PureComponent{constructor(e){super(e),this.focusLast=()=>{this.props.contacts&&this.props.contacts.length&&this.selection.setLast(!0)},this._focusPrev=e=>{e.preventDefault(),e.stopPropagation(),this.selection.prev()>-1&&this.selection.setPrev(!0)},this._focusNext=e=>{e.preventDefault(),e.stopPropagation();var{onFocusSearch:t}=this.props,a=this.selection.next();this.selection.index===a?(this.selection.unset(),t&&t(e)):this.selection.setNext(!0)},this._deleteContact=e=>{e.preventDefault(),e.stopPropagation();var{onDelete:t}=this.props,a=this.selection.getVal();if(a){var l=this.props.contacts.find(a);l&&t&&t(e,l)}},this.onParticipantClick=(e,t)=>{this.selection.setVal(t)},this.selection=new u.default(e.contacts,(e=>e.id))}componentDidUpdate(){this.selection.init(this.props.contacts,!0)}render(){var e=this.props.contacts;if(!e)return null;var t=e.length?(0,i.default)(e,(e=>r.default.createElement(n.default,{contact:e,active:this.selection,onDelete:this.props.onDelete,onClick:this.onParticipantClick,type:n.Type.SMALL,key:e.id.toString(),theme:this.props.theme,waitIdle:!0}))):null,a={up:this._focusPrev,down:this._focusNext};this.props.onDelete&&(a[d.default.LR("left","right")]=this._focusPrev,a[d.default.LR("right","left")]=this._focusNext,a.backspace=this._deleteContact);var l=r.default.createElement("ul",null,t);return r.default.createElement(o.default,{handlers:a},l)}}t.default=c,c.displayName="ParticipantList"},5827:(e,t,a)=>{"use strict";var l=a(20862),s=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var{ids:t,size:a,onClick:l,showCount:s,square:d,border:u}=e,c=t.length;if(0===c)return null;if(1===c)return r.default.createElement(o.default,{id:t[0],size:40,onClick:l,border:u});var f=t.slice(0,4).map(((e,t)=>r.default.createElement("div",{key:`avatar-combo-image-${t}`,className:(0,i.default)(n.default.avatar,{[n.default.first]:0===t,[n.default.second]:1===t,[n.default.third]:2===t,[n.default.fourth]:3===t})},r.default.createElement(o.default,{id:e,size:a,square:!0})))),h=(0,i.default)(n.default.container,{[n.default.square]:d,[n.default.border]:u},{[n.default.two]:2===c,[n.default.three]:3===c,[n.default.four]:c>=4}),p=(0,o.getSize)(a),m={height:p,width:p,cursor:l?"pointer":void 0},v=s?r.default.createElement("div",{className:n.default.count,style:m},t.length):null;return r.default.createElement("div",{className:h,style:m,onClick:l},f,v)};var i=s(a(94184)),r=s(a(67294)),n=s(a(72084)),o=l(a(27890))},27413:(e,t,a)=>{"use strict";var l=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return s.default.createElement("div",{className:r.default.overlay,key:"avatar-overlay"},s.default.createElement("div",{className:r.default.icon},e.icon),s.default.createElement("div",{"data-a8n":i.default.key("avatar-text"),className:r.default.text},e.text))};var s=l(a(67294)),i=l(a(62067)),r=l(a(79169))},10618:(e,t,a)=>{"use strict";var l=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var{onClick:t,className:a,label:l,prefixIcon:d,postfixIcon:u}=e,c=(0,s.default)(r.default.icon,{[r.default.paddedIcon]:"padded-svg"===e.iconTheme});return i.default.createElement(o.default,{className:(0,s.default)(a,r.default.container,{[r.default.hasPrefixIcon]:null!=d,[r.default.hasPostfixIcon]:null!=u}),onClick:t,"aria-label":e["aria-label"]},d&&i.default.createElement(n.default,{name:d,className:(0,s.default)(c,r.default.prefixIcon)}),i.default.createElement("div",{className:r.default.content},l),u&&i.default.createElement(n.default,{name:u,className:c}))};var s=l(a(94184)),i=l(a(67294)),r=l(a(10721)),n=l(a(62745)),o=l(a(87120))},80908:(e,t,a)=>{"use strict";var l=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function({children:e,download:t,file:a,extension:l}){return s.default.createElement(n.default,{className:i.default.download_button,onClick:()=>{null!=a&&r.default.downloadData(a,t,l)}},e)};var s=l(a(67294)),i=l(a(7890)),r=l(a(68816)),n=l(a(87120))},96783:(e,t,a)=>{"use strict";var l=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a){var l=(0,i.useRef)(e);l.current=e;var r=(0,i.useMemo)((()=>(0,s.default)(((...e)=>l.current(...e)),t,a)),[t,a]);return(0,i.useEffect)((()=>r.cancel),[]),r};var s=l(a(23279)),i=a(67294)},14173:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t=0,a){var{immediate:s=!1}=null!=a?a:{},i=(0,l.useRef)(e);i.current=e;var r=(0,l.useRef)(),n=(0,l.useCallback)((()=>{r.current&&clearTimeout(r.current)}),[]),o=(0,l.useCallback)((()=>{n(),r.current=setTimeout((()=>i.current()),t)}),[n,t]);return(0,l.useEffect)((()=>(s&&o(),n)),[s,o,n]),[o,n]};var l=a(67294)},9345:(e,t,a)=>{"use strict";var l=a(20862),s=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(a(35161)),r=s(a(94184)),n=s(a(96391)),o=l(a(67294)),d=s(a(46274)),u=a(77830),c=s(a(23418)),f=s(a(47312)),h=s(a(79766)),p=s(a(58780)),m=s(a(66761)),v=s(a(56113)),g=s(a(24927)),E=s(a(17363)),_=s(a(10937)),C=s(a(87120));class S extends o.PureComponent{constructor(...e){super(...e),this.state={},this._setRefBody=e=>{this._refBody=e},this._refImages=new Map,this.setRefImage=(e,t)=>{t?this._refImages.set(e,t):this._refImages.delete(e)},this._setImageRefCache=new v.default(this.setRefImage),this.selection=new g.default(this.props.thumbnails,(e=>e.id)),this._handleHotKeysRef=e=>{this._refHotKeys=e},this.handleMouseDown=e=>{e.preventDefault(),e.stopPropagation()},this.handleClick=e=>{var t=e.target;this.props.onImageClick&&1===t.nodeType&&"IMG"===t.tagName&&this.props.onImageClick(t.src)},this.handleEnter=()=>{var e=this.selection.getVal();e||(__LOG__(4,void 0,new Error,!0)`Assertion failed!`,SEND_LOGS("No value selected, but enter clicked")),this.props.onImageClick&&e&&this.props.onImageClick(e.thumbUrl)},this._requestMoreImagesIfNeeded=()=>{if(!this.props.isLoadingMore&&this.props.canLoadMore&&this.props.onRequestMoreImages){if(!this._refBody)throw new Error("Requesting more images when body not rendered");this._refBody.scrollTop+d.default.SCROLL_FUDGE>this._refBody.scrollHeight-this._refBody.clientHeight&&this.props.onRequestMoreImages()}},this.handleScroll=this.props.throttle(this._requestMoreImagesIfNeeded,100),this._selectPrev=e=>{e.preventDefault(),e.stopPropagation(),this.selection.setPrev(!1),this._updateSelected(!0,!0)},this.selectNext=e=>{e.preventDefault(),e.stopPropagation(),this.selection.setNext(!1),this._updateSelected(!0,!0)},this._selectPrevRow=e=>{if(e.preventDefault(),e.stopPropagation(),0===this.selection.index&&this.props.onFocusPrev)this.props.onFocusPrev();else{var t=Math.max(this.selection.index-3,0);this.selection.set(t,!1,!1),this._updateSelected(!0,!0)}},this._selectNextRow=e=>{e.preventDefault(),e.stopPropagation(),this.selection.set(this.selection.index+3,!1,!1),this._updateSelected(!0,!0)},this._handleFocus=e=>{e.stopPropagation(),e.preventDefault(),(null==this.selection.index||this.selection.index<0)&&this.selection.setFirst(!1),this._updateSelected(!0,!1);var t=(0,n.default)(this._refImages.get(`${this.selection.index}`),"this._refImages.get(`${this.selection.index}`)").getElementsByClassName(p.default.imageGalleryItemOverlay);if(1!==t.length)throw new Error(`Unexpected number of overlay elements ${t.length}`);c.default.maybeIndicateFocus(t[0],p.default.focusAnimation)},this.handleRequestDismiss=()=>{this.selection.unset(),this.setState({selectedImage:void 0})}}componentDidMount(){this._updateSelected()}componentDidUpdate(){this._requestMoreImagesIfNeeded(),this.selection.init(this.props.thumbnails,!1),this._updateSelected()}focus(){this._refHotKeys&&this._refHotKeys.focus()}_updateSelected(e=!1,t=!1){var a=this.selection.getVal();if(a&&this.state.selectedImage!==a&&(this.setState({selectedImage:a}),this.selection.index>-1)){var l=this._refImages.get(`${this.selection.index}`);f.default.focus(l),t&&l&&(0,u.scrollIntoViewIfNeeded)(l,!1)}}render(){var e={down:this._selectNextRow,enter:this.handleEnter,left:this._selectPrev,right:this.selectNext,up:this._selectPrevRow},t=(0,i.default)(this.props.thumbnails,(({id:e,name:t,thumbUrl:a},l)=>{var s=!!this.state.selectedImage&&this.state.selectedImage.id===e,i=(0,r.default)(p.default.imageGalleryItem,{[p.default.selected]:s}),n=o.default.createElement("div",{className:p.default.imageGalleryItemOverlay});return o.default.createElement("div",{key:e,ref:this._setImageRefCache.getRefSetter(`${l}`),className:i,tabIndex:-1},n,o.default.createElement(C.default,{onClick:this.handleClick},o.default.createElement("img",{alt:m.default.t(30,{name:t}),className:p.default.imageGalleryItemImage,src:a})))})),a=this.props.isLoadingMore?o.default.createElement("div",{tabIndex:-1,className:p.default.imageGalleryFooter},o.default.createElement(E.default,{stroke:6,size:24})):null;return o.default.createElement(h.default,{className:p.default.imageGallery,"data-tab":d.default.TAB_ORDERS.CHAT_IMAGE_GALLERY,handlers:e,onFocus:this._handleFocus,onMouseDown:this.handleMouseDown,onRef:this._handleHotKeysRef},o.default.createElement("div",{ref:this._setRefBody,className:p.default.imageGalleryList,onScroll:this.handleScroll},t,o.default.createElement("div",{tabIndex:-1,className:p.default.imageGalleryItemSpacer}),o.default.createElement("div",{tabIndex:-1,className:p.default.imageGalleryItemSpacer}),o.default.createElement("div",{tabIndex:-1,className:p.default.imageGalleryItemSpacer}),a))}}S.defaultProps={thumbnails:[]},S.displayName="ImageGallery";var y=(0,_.default)(S);t.default=class extends y{focus(){this.getComponent().focus()}}},80941:(e,t,a)=>{"use strict";var l=a(20862),s=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(a(94184)),r=l(a(67294)),n=s(a(97420)),o=s(a(58743)),d=a(68770),u=s(a(49204)),c=a(38178),f=s(a(79766)),h=s(a(66761)),p=s(a(38341)),m=s(a(36344)),v=a(47374),g=s(a(62745)),E=s(a(47469)),_=s(a(1869)),C=a(93215),S=s(a(77923));class y extends r.Component{constructor(...e){super(...e),this.state={active:!1,emojiPicker:null},this._refEmojiPanel=(0,r.createRef)(),this.onEmojiPicker=e=>{e&&(e.preventDefault(),e.stopPropagation());var t=r.default.createElement(u.default,{ref:this._refEmojiPanel,onEmoji:this.onEmoji,onFocusNext:this.restoreFocus,onFocusPrev:this.restoreFocus});this.setState({emojiPicker:{menu:t,dirY:d.DirY.TOP,type:"emoji_picker",anchor:e.target}}),this.restoreFocus()},this.onEmojiPickerClose=()=>{this.setState({emojiPicker:null})},this.onRestoreEmojiPickerFocus=()=>{var e;null===(e=this._refEmojiPanel.current)||void 0===e||e.restoreFocus()},this.onEmoji=e=>{var t=this.refInput;t&&(t.focus(!1),t.replaceSelection(e)),this.onEmojiPickerClose()},this.setRefInput=e=>{this.refInput=e},this.onSelectionChange=e=>{this.selection=e},this.restoreFocus=()=>{this.refInput&&this.refInput.focus()},this.onBlur=e=>{this.state.active&&this.setState({active:!1}),this.props.onBlur&&this.props.onBlur(e)},this.onFocus=e=>{e.stopPropagation(),this.state.active||this.setState({active:!0}),this.props.onFocus&&this.props.onFocus(e)},this.onReset=()=>{this.refInput&&this.refInput.reset()}}componentDidMount(){this.props.focusOnMount&&this.restoreFocus()}render(){var e,t=this.props.maxLength,a=(0,C.numCodepoints)(this.props.value||""),l=(0,i.default)(m.default.textInput,{[m.default.noPlaceholder]:!this.props.placeholder,[m.default.active]:!0}),s=(0,i.default)(m.default.labelText,{[m.default.float]:!!this.props.value}),n=this.props.supportsEmoji?r.default.createElement("button",{className:m.default.inputEmoji,onClick:this.onEmojiPicker},r.default.createElement(g.default,{"aria-label":h.default.t(23),name:"emoji-input"})):void 0,{value:o}=this.props;e=o&&""!==o?r.default.createElement("div",{role:"button",className:m.default.clearInput,onClick:this.onReset},r.default.createElement(g.default,{name:"x-alt"})):null;var d,u=this.props.showRemaining?r.default.createElement("div",{className:(0,i.default)(m.default.buttonContainer,m.default.charCounter,{[m.default.charCounterWithClearBtn]:!!e})},r.default.createElement("div",{className:m.default.charCounter},t-a<50?h.default.n(t-a):null)):null;return this.state.emojiPicker&&(d=r.default.createElement(E.default,{displayName:"EmojiPicker",escapable:!0,popable:!0,requestDismiss:this.onEmojiPickerClose,requestFocus:this.onRestoreEmojiPickerFocus},r.default.createElement(_.default,{contextMenu:this.state.emojiPicker}))),r.default.createElement(f.default,{className:l,onFocus:this.restoreFocus},r.default.createElement("span",{className:s},this.props.placeholder),r.default.createElement("div",{className:m.default.spacer}),r.default.createElement("div",{className:m.default.suggestionsPositioner},r.default.createElement("div",{className:m.default.suggestionsContainer},r.default.createElement(p.default.MentionSuggestions,{chat:this.props.chat,theme:v.ThemeOptions.MEDIA_CAPTION}),r.default.createElement(p.default.EmojiSuggestions,{chat:this.props.chat,theme:c.ThemeOptions.MEDIA_CAPTION}))),r.default.createElement("div",{className:(0,i.default)(m.default.wrapper,{[m.default.textActive]:this.state.active})},r.default.createElement(p.default,{ref:this.setRefInput,initialValue:this.props.value,initialSelection:this.selection,readOnly:!1,spellCheck:this.props.spellCheck,multiline:this.props.multiline,maxLength:this.props.maxLength,onEnter:this.props.onEnter,onMaxPasteExceeded:this.props.onMaxPasteExceeded,onFiles:this.props.onFiles,onChange:this.props.onChange,onSelect:this.onSelectionChange,theme:"media-caption"}),r.default.createElement("div",{className:m.default.inputControls},r.default.createElement(S.default,{transitionName:"pop",component:"div",className:m.default.buttonContainer},e,n),u)),d)}}t.default=y,y.defaultProps={maxLength:25,onMaxPasteExceeded:()=>{n.default.openModal(r.default.createElement(o.default,{title:h.default.t(420),onOK:()=>{n.default.closeModal()},okText:h.default.t(1826)},h.default.t(419)))}},y.displayName="MediaCaptionTextInput"},63893:(e,t,a)=>{"use strict";var l=a(95318),s=a(20862);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(a(67294)),r=l(a(46274)),n=l(a(5523)),o=l(a(20487)),d=l(a(82286));class u extends i.Component{constructor(...e){super(...e),this._setRefContainer=e=>{this._refContainer=e}}getContainer(){return this._refContainer}render(){var{chatPreference:e}=this.props,{wallpaperColor:t,showDoodle:a}=e,l={};return t!==r.default.DEFAULT_CHAT_WALLPAPER&&(l={backgroundColor:t}),i.default.createElement("div",{className:o.default.container,ref:this._setRefContainer},i.default.createElement("div",{className:o.default.body,style:l},i.default.createElement(n.default,{wallpaperColor:t,showDoodle:a}),this.props.children))}}u.CONCERNS={chatPreference:["wallpaperColor","showDoodle"]},u.displayName="MsgPreview";var c=(0,d.default)(u,u.CONCERNS);t.default=class extends c{get container(){return this.getComponent().getContainer()}}},93249:(e,t,a)=>{"use strict";var l=a(20862),s=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(a(63105)),r=l(a(67294)),n=s(a(27413)),o=s(a(32231)),d=s(a(97420)),u=s(a(58743)),c=s(a(46274)),f=s(a(69107)),h=s(a(94123)),p=s(a(59474)),m=s(a(18749)),v=a(51418),g=s(a(99213)),E=s(a(28204)),_=s(a(91244)),C=s(a(84150)),S=s(a(66761)),y=l(a(44242)),I=l(a(18467)),M=s(a(53852)),P=s(a(5582)),L=s(a(10839)),T=s(a(20254)),b=s(a(62745)),D=s(a(53482)),N=s(a(44843)),O=s(a(47469)),w=s(a(1869)),k=s(a(77923));class R extends r.Component{constructor(...e){super(...e),this.state={img:this.props.startImage,hover:!1,imageSize:null},this._setRefImageContainer=e=>{this._refImageContainer=e},this._setRefImageInput=e=>{this._refImageInput=e},this._onUpload=()=>{var e=this._refImageInput;if(e)return e.click(),!0},this._removeImage=()=>{this.props.onImageSet(),d.default.closeModal()},this._onRemove=()=>{var e=this.props.type===L.default.GROUP?S.default.t(1286):S.default.t(1289);d.default.openModal(r.default.createElement(u.default,{onOK:this._removeImage,okText:S.default.t(1285),onCancel:()=>d.default.closeModal(),cancelText:S.default.t(1657)},e))},this._onView=()=>{var e=this._refImageContainer,{id:t,attachToChat:a}=this.props;if(e&&t){var l=f.default.assertGet(t),s={transition:"profile-viewer"};a&&(s.uim=this.props.uim),d.default.openModalMedia(r.default.createElement(T.default,{contact:l,profilePicThumb:l.getProfilePicThumb(),animateBorderRadius:!0,getZoomNode:t=>{t(e)}}),s)}},this.onPaste=e=>{if(this.state.contextMenu){var t=new h.default(e.clipboardData),a=(0,i.default)(t.getFiles(),(e=>"image"===(0,v.typeFromMimetype)(e.type)));if(a.length){e.preventDefault(),e.stopPropagation(),this.closeContextMenu();var l=a[0];this._onImagePick(l)}}},this.onImageSelected=e=>{this.closeContextMenu();var t=e.target.files[0];if(!t)return!1;this._onImagePick(t),e.target.value=""},this._onImageReceived=(e,t)=>{e?y.loadImage(e).then((()=>{this.setState({img:e}),this.props.onImageSet(e,t)})).catch((e=>{__LOG__(3)`PhotoPicker:onImageReceived failed to load image: ${String(e)}`;var t=this.props.type===L.default.GROUP?S.default.t(118):S.default.t(187);d.default.openModal(r.default.createElement(u.default,{onOK:()=>d.default.closeModal()},t))})):this.setState({img:null,imageSize:null})},this.onSearch=()=>{d.default.openModal(r.default.createElement(I.default,{type:I.BoxModalType},r.default.createElement(_.default,{onFinished:this._onImageReceived})))},this._onImagePick=e=>{var t=URL.createObjectURL(e);y.loadImage(t).then((t=>{t&&(t.width<c.default.MIN_PIC_SIDE||t.height<c.default.MIN_PIC_SIDE)?d.default.openModal(r.default.createElement(u.default,{onOK:()=>d.default.closeModal()},S.default.t(1277,{size:c.default.MIN_PIC_SIDE,_plural:c.default.MIN_PIC_SIDE}))):d.default.openModal(r.default.createElement(I.default,{type:I.BoxModalType},r.default.createElement(m.default,{img:e,onFinished:this._onImageReceived,onRetake:this._onUpload})))})).catch((()=>{var e=this.props.type===L.default.GROUP?S.default.t(118):S.default.t(187);d.default.openModal(r.default.createElement(u.default,{onOK:()=>d.default.closeModal()},e))})).finally((()=>{URL.revokeObjectURL(t)}))},this.onImageClick=e=>{if(this.props.readOnly)this.state.img&&this._onView();else{e.stopPropagation(),e.preventDefault();var t=[];this.props.id&&this.state.img&&t.push(r.default.createElement(p.default,{a8n:"mi-view-photo",key:"view",action:this._onView},S.default.t(1543))),g.default&&t.push(r.default.createElement(D.default,{key:"take",onImageTake:this._onImageReceived})),t.push(r.default.createElement(p.default,{a8n:"mi-upload-photo",key:"upload",action:this._onUpload},S.default.t(1500))),N.default.isElectron&&this.props.type===L.default.GROUP&&t.push(r.default.createElement(p.default,{a8n:"mi-search-photo",key:"search",action:this.onSearch},S.default.t(1886))),this.state.img&&t.push(r.default.createElement(p.default,{a8n:"mi-remove-photo",key:"remove",action:this._onRemove},S.default.t(1288))),e.persist(),this.setState({contextMenu:{menu:t,event:e}})}},this.closeContextMenu=()=>{this.setState({contextMenu:null})},this.onMouseOver=()=>{this.state.hover||this.setState({hover:!0})},this.onMouseEnter=()=>{this.state.hover||this.setState({hover:!0})},this.onMouseLeave=()=>{this.state.hover&&this.setState({hover:!1})},this.onLoad=e=>{var t=e.target.clientWidth,a=e.target.clientHeight;this.setState({imageSize:{width:t,height:a}})}}static getDerivedStateFromProps(e){return e.startImage?{img:e.startImage}:{img:e.startImage,imageSize:null}}render(){var e,t;this.state.img&&(e=r.default.createElement(M.default,{type:"cover",size:this.state.imageSize},r.default.createElement(C.default,{src:this.state.img,crossOrigin:!1,style:{height:"100%",width:"100%"},onLoad:this.onLoad}))),(this.props.pending||this.state.img&&!this.state.imageSize)&&(t=r.default.createElement(o.default,null));var a=null;if(!this.props.pending&&!this.props.readOnly&&(!this.state.img||this.state.imageSize)&&(!this.state.img||this.state.contextMenu||this.state.hover)){var l="";switch(this.props.type){case L.default.GROUP:l=this.state.img?S.default.t(494):S.default.t(214);break;case L.default.PROFILE:l=this.state.img?S.default.t(499):S.default.t(221)}a=r.default.createElement(n.default,{icon:r.default.createElement(b.default,{name:"camera"}),text:l})}var s,i,d=this.props.pending||!this.state.imageSize&&this.state.img?()=>{}:this.onImageClick;if(this.state.contextMenu&&(s=r.default.createElement(O.default,{displayName:"PhotoPickerContextMenu",escapable:!0,popable:!0,requestDismiss:this.closeContextMenu},r.default.createElement(w.default,{contextMenu:this.state.contextMenu}))),this.props.pending||!this.state.img||this.state.img&&!this.state.imageSize){var u=this.props.type===L.default.PROFILE?"default-user":"default-group";i=r.default.createElement("div",{className:P.default.defaultIcon},r.default.createElement(b.default,{name:u}))}var c=null!=this.props.size?{width:this.props.size,height:this.props.size}:null;return r.default.createElement("div",{className:P.default.container,style:c},r.default.createElement("div",{className:P.default.body,onClick:d,onMouseOver:this.onMouseOver,onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,onPaste:this.onPaste,ref:this._setRefImageContainer,dir:"ltr"},r.default.createElement("div",{className:P.default.imageContainer},e,i),r.default.createElement(k.default,{transitionName:"fade"},t,a)),r.default.createElement("input",{ref:this._setRefImageInput,type:"file",accept:"image/gif,image/jpeg,image/jpg,image/png",style:{display:"none"},onChange:this.onImageSelected}),s)}}R.displayName="PhotoPicker";var A=(0,E.default)(R);t.default=A},38341:(e,t,a)=>{"use strict";var l=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=l(a(28786)),i=l(a(38207)),r=l(a(38178)),n=l(a(69856)),o=l(a(45101)),d=l(a(62086)),u=l(a(47374)),c=l(a(15031)),f=new n.default,h=new s.default;class p extends((0,o.default)([i.default,h,f,d.default])){}t.default=p,p.MentionSuggestions=(0,c.default)(u.default,{plugin:f}),p.EmojiSuggestions=(0,c.default)(r.default,{plugin:h})},63203:(e,t,a)=>{"use strict";var l=a(20862),s=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(a(67154)),r=s(a(67294)),n=s(a(97420)),o=s(a(58743)),d=l(a(85002)),u=s(a(66761)),c=a(22204),{useState:f}=r.default;t.default=({doSave:e,afterSave:t,isValid:a,children:l,modalConfig:s,onError:h,title:p,onCancel:m})=>{var[v,g]=f(c.EditType.EDITING),E=r.default.createElement(d.default,{title:p,type:d.DRAWER_HEADER_TYPE.POPUP,onCancel:()=>{n.default.closeModal(),m&&m()}});return r.default.createElement(o.default,(0,i.default)({children:l,okText:u.default.t(1327),type:"auto",onOK:()=>{g(c.EditType.PENDING),e().then((()=>{g(c.EditType.DONE),t&&t(),n.default.closeModal()}),(e=>{g(c.EditType.ERROR),h&&h(e)}))},okSpinner:v===c.EditType.PENDING,okDisabled:v===c.EditType.PENDING||!a,title:E},s))}},5750:(e,t,a)=>{"use strict";var l=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=l(a(94184)),i=l(a(67294)),r=l(a(79766)),n=l(a(95108)),{useRef:o}=i.default,d=({tabConfigs:e,selectedId:t,onSelect:a,tabClass:l,className:d})=>{var u=o(t),c=o([]),f=e.map((({id:e})=>e)),h=f.length-1;return i.default.createElement(r.default,{handlers:{right:()=>{var e=f.indexOf(u.current),t=e===h?0:e+1,a=c.current[t];a&&a.focus()},left:()=>{var e=f.indexOf(u.current),t=0===e?h:e-1,a=c.current[t];a&&a.focus()}}},i.default.createElement("div",{role:"tablist",className:(0,s.default)(n.default.tabContainer,d)},e.map(((e,r)=>(({title:e,id:r},o)=>{var d=r===t;return i.default.createElement("button",{role:"tab",tabIndex:d?0:-1,"aria-selected":Boolean(d),title:e,className:(0,s.default)(n.default.tab,{[n.default.selected]:d},l),onClick:()=>{d||a(r)},onFocus:()=>{u.current=r},ref:e=>c.current[o]=e,key:e},e)})(e,r)))))};t.default=d},53482:(e,t,a)=>{"use strict";var l=a(95318),s=a(20862);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(a(67294)),r=l(a(97420)),n=l(a(59474)),o=l(a(46425)),d=l(a(66761));class u extends i.Component{constructor(...e){super(...e),this.onCapture=()=>{r.default.openModal(i.default.createElement(o.default,{onFinished:this.props.onImageTake}))}}render(){return i.default.createElement(n.default,{action:this.onCapture,a8n:"mi-take-photo",disabled:this.props.disabled},d.default.t(1448))}}t.default=u,u.displayName="TakePhotoMenuItem"},8895:(e,t,a)=>{"use strict";var l=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function({className:e}){var t=n.default.VERSION_STR;return i.default.createElement(d.SelectableDiv,{"data-a8n":r.default.key("version"),className:(0,s.default)(u.default.versionInfo,e),selectable:!0},o.default.t(1522,{version:""}),i.default.createElement("span",{dir:"LTR"},t),null,null)};var s=l(a(94184)),i=l(a(67294)),r=l(a(62067)),n=l(a(46274)),o=l(a(66761)),d=a(80493),u=l(a(6935))},97768:(e,t,a)=>{"use strict";var l=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=l(a(67294)),i=l(a(18917)),r=l(a(97420)),n=l(a(58743)),o=l(a(98712)),d=l(a(21681)),u=l(a(47312)),c=l(a(82396)),f=l(a(66761)),h=a(47494);class p extends d.default{constructor(...e){super(...e),this.filter=e=>{var t=e.groupMetadata;return!(!e.isGroup||e.isGroup&&!t.participants.iAmMember())&&(t.participants.get(this.props.contact.id)?f.default.t(226):!!t.participants.iAmAdmin()||f.default.t(518))},this._confirmAddToGroup=e=>{this.props.requestFocus&&this.props.requestFocus(),this.push(s.default.createElement(n.default,{cancelText:f.default.t(1657),okText:f.default.t(215),onOK:this._addToGroup.bind(null,e),onCancel:this._pop},s.default.createElement(o.default,{text:f.default.t(550,{participant:this.props.contact.formattedName,subject:e.contact.name})})))},this.requestFocus=()=>{if(this.refUIE){var e=this.refUIE.getNode();e&&!e.contains(document.activeElement)&&u.default.focus(e)}},this._addToGroup=e=>{(0,h.addParticipants)(e,[this.props.contact]).then((()=>{r.default.openChatFromUnread(e).then((t=>{t&&r.default.focusChatTextInput(e)}))})).catch((()=>{})),this.end()},this._pop=()=>{this.pop()}}componentDidMount(){this.push(s.default.createElement(c.default,{chats:i.default.filter((e=>e.isGroup)),filter:this.filter,onCancel:this._pop,onGroup:this._confirmAddToGroup}))}}t.default=p},70714:(e,t,a)=>{"use strict";var l=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=l(a(81629)),i=l(a(51463)),r=l(a(67294)),n=a(23491),o=l(a(73456)),d=l(a(97420)),u=l(a(21681)),c=a(67172),f=l(a(44843));class h extends u.default{constructor(){super(...arguments),this.onCancel=()=>{this.props.onComplete&&this.props.onComplete(!1),this._clearAttachMedia(),this.props.mediaCollection.mediaPickerStatsLogger.logCancel(),this.end()},this.onFailedMedias=e=>{var t=e.filter((e=>e.isGif));if(t.length>0){var a=t.map((e=>e.filename));d.default.once("ui_idle",(()=>{d.default.pasteChatTextInput(this.props.chat,a.join(" "))})),this.props.onComplete&&this.props.onComplete(!1),this._clearAttachMedia(),this.props.mediaCollection.mediaPickerStatsLogger.logCancel(),this.end()}},this._sendMediaWithMentions=(e,t,a)=>{var{chat:l}=this.props;d.default.once("ui_idle",(()=>{e.forEach(((e,t)=>{var s=e.media,i={};if(0===t&&(i.quotedMsg=l.composeQuotedMsg,l.composeQuotedMsg=null),i.isViewOnce=a,i.mentionedJidList=e.mentionedJidList,i.caption=s.caption,i.addEvenWhilePreparing=s.previewable&&s.state===n.ATTACH_MEDIA_STATE.PROCESSING,this.props.initCaption&&this.props.initCaption.ctwaContextLinkData){var{ctwaContextLinkData:r,ctwaContext:o}=this.props.initCaption;i.ctwaContext=(0,c.prepareCtwaContextSend)(r,o)}s.sendToChat(l,i)})),this._clearAttachMedia()})),this.props.onComplete&&this.props.onComplete(!0,t),this.props.mediaCollection.mediaPickerStatsLogger.logSend(),this.end()},this.setText=e=>{null!=e&&d.default.once("ui_idle",(()=>{d.default.pasteChatTextInput(this.props.chat,e)})),this.end()},this._clearAttachMedia=()=>{this.props.chat&&this.props.chat.setAttachMediaContents(null)},this.handleRequestDismiss=this.handleRequestDismiss.bind(this)}componentDidMount(){d.default.closeContextMenu(),d.default.closeTooltip(),this.push(r.default.createElement(o.default,{chat:this.props.chat,onBack:this.onCancel,initCaption:this.props.initCaption,onSendMedia:(0,i.default)(this._sendMediaWithMentions),onDropText:(0,i.default)(this.setText),onFailedMedias:this.onFailedMedias,mediaCollection:this.props.mediaCollection}))}componentWillUnmount(){f.default.isGecko?(0,s.default)((()=>d.default.focusChatTextInput(this.props.chat))):d.default.focusChatTextInput(this.props.chat)}handleRequestDismiss(e){!1===e&&(this._clearAttachMedia(),this.props.mediaCollection.mediaPickerStatsLogger.logCancel()),super.handleRequestDismiss()}}t.default=h},46932:(e,t,a)=>{"use strict";var l=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=l(a(67294)),i=l(a(97420)),r=l(a(21681)),n=l(a(66761)),o=a(58635),d=l(a(43541)),u=a(42473);class c extends r.default{constructor(...e){super(...e),this.requestFocus=()=>{var e,t=null===(e=this.refUIE)||void 0===e?void 0:e.getRef();null!=t&&(t instanceof HTMLElement||"function"!=typeof t.onFocusList||t.onFocusList())},this._sendProducts=e=>{var{chat:t}=this.props;e.forEach(((e,a)=>{var l=0===a?t.composeQuotedMsg:null;t.sendProductMessage(e,l).then((()=>{(0,o.logProductMessageSent)({product:e,catalogSessionId:this.props.sessionId})}))})),t.composeQuotedMsg=null,this.end()},this._shareCatalog=e=>{var{chat:t}=this.props,a=(0,u.createCatalogLink)(e.id.user),l=`${n.default.t(1245)} ${a}`;i.default.pasteChatTextInput(t,l),(0,o.logSendCatalogClick)({catalogOwnerWid:e.id,catalogSessionId:this.props.sessionId}),this.end()},this._pop=()=>{this.pop()},this._popNone=()=>{this.pop("none")}}componentDidMount(){this.push(s.default.createElement(d.default,{onCancel:this._pop,onConfirm:this._sendProducts,onShare:this._shareCatalog}))}}var f=c;t.default=f},65213:(e,t,a)=>{"use strict";var l=a(20862),s=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(a(67154)),r=s(a(67294)),n=s(a(21681)),o=s(a(66761)),d=l(a(30399)),u=s(a(52537)),c=s(a(86981)),f=s(a(83779));class h extends n.default{constructor(...e){super(...e),this._confirmSendContacts=e=>{this.push(r.default.createElement(f.default,{contactList:e,onSend:()=>this._sendContacts(e),onBack:this._popNone,chat:this.props.chat}),"none"),this.contacts=e},this._sendContacts=e=>{var{chat:t}=this.props,a=t.composeQuotedMsg,l=t.getComposeContents().ctwaContext||void 0;(0,u.default)(e,t,a,l),t.composeQuotedMsg=null,this.props.onContactsSent(),this.end()},this._getContacts=()=>this.contacts,this._pop=()=>{this.pop()},this._popNone=()=>{this.pop("none")}}componentDidMount(){var e=this.props.serverProps.maxParticipants;this.contacts=[],this.push(r.default.createElement(d.default,{title:o.default.t(1363),onCancel:this._pop,onConfirm:this._confirmSendContacts,getInitialItems:this._getContacts,listType:d.ListType.CONTACT_SELECT_MODAL,maxItems:e,allowBlockedContacts:!0}))}}t.default=e=>r.default.createElement(h,(0,i.default)({},e,{serverProps:c.default}))},27789:(e,t,a)=>{"use strict";var l=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=l(a(67294)),i=l(a(73136)),r=l(a(21681)),n=a(2893);class o extends r.default{constructor(...e){super(...e),this.sendMedia=({getImg:e,caption:t,isViewOnce:a,mentionedJidList:l})=>{var s=this.props.chat,i=s.composeQuotedMsg;s.composeQuotedMsg=null;var r=s.getComposeContents().ctwaContext||void 0;(0,n.prepRawMedia)(e,{}).sendToChat(s,{caption:t,mentionedJidList:l,quotedMsg:i,ctwaContext:r,isViewOnce:a}),this.props.onCaptureSent(),this.end()}}componentDidMount(){this.push(s.default.createElement(i.default,{onBack:()=>{this.end()},chat:this.props.chat,caption:!0,theme:"capture-contain",onSend:this.sendMedia,stream:this.props.stream,disposeStream:this.props.disposeStream}))}}t.default=o},78448:(e,t,a)=>{"use strict";var l=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=l(a(67294)),i=l(a(51968)),r=l(a(97420)),n=l(a(31763)),o=l(a(21681)),d=l(a(5148)),u=a(66248),c=l(a(34331));class f extends o.default{constructor(...e){super(...e),this.onProductCatalog=()=>{var{sellerJid:e,chat:t}=this.props;this.push(s.default.createElement(c.default,{chat:t,catalogOwnerJid:e}))},this.onProductDetail=e=>{var{chat:t}=this.props;this.push(s.default.createElement(c.default,{refreshCarousel:!0,chat:t,productInfo:e,onEnd:this._pop}))},this._end=()=>{this.end(!0)},this._pop=()=>{this.pop()}}componentDidMount(){var{sellerJid:e,chat:t}=this.props;this.push(s.default.createElement(n.default.Consumer,null,(a=>{var{entryPoint:l}=(0,u.getProductCatalogContext)(a);return s.default.createElement(i.default,{chat:t,sellerJid:e,onProductDetail:this.onProductDetail,onProductCatalog:this.onProductCatalog,onBack:this._end,closeDrawerRightOnSend:l===d.default.CATALOG_ENTRY_POINT.CATALOG_ENTRY_POINT_PRODUCT_LIST_MESSAGE})}))),r.default.existsDrawerLeft((e=>{e&&r.default.closeDrawerLeft()})),r.default.existsDrawerMid((e=>{e&&r.default.closeDrawerMid()}))}}t.default=f},39544:(e,t,a)=>{"use strict";var l=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=l(a(67154)),i=l(a(67294)),r=l(a(57984)),n=l(a(9506)),o=l(a(40943)),d=l(a(99568)),u=l(a(97420)),c=l(a(31105)),f=l(a(69766)),h=l(a(69107)),p=l(a(31763)),m=a(85002),v=l(a(70547)),g=l(a(14382)),E=a(66274),_=l(a(21681)),C=a(56726),S=a(53615),y=l(a(66761)),I=l(a(78019)),M=l(a(53965)),P=l(a(37091)),L=l(a(28187)),T=l(a(43866));class b extends _.default{constructor(...e){super(...e),this._handleAddFirstProduct=()=>{this._showProductList(),r.default.find(this.props.catalogId).then((()=>{this._onAddProduct()})).catchType(E.ServerStatusCodeError,(()=>{__LOG__(3)`Failed to fetch product catalog from server`}))},this._showProductList=()=>{var e=h.default.get(this.props.catalogId);if(e){var t=(0,S.canManageCollections)()?i.default.createElement(d.default,{contact:e,onCatalogLinkClick:this._onCatalogShare,onProductShare:this.onProductShare,onProductDetail:this.onEditProduct,onAddProduct:this._onAddProduct,catalogId:this.props.catalogId,onBack:this._end,onCartClick:this.onCartClick,businessProfile:null,headerType:m.DRAWER_HEADER_TYPE.LARGE,onCollectionSeeAll:this.onCollectionSeeAll,canManageCatalog:!0,autoUpdate:!0,onOpenCollections:this.onOpenCollections,onEditCollection:this._onEditCollection,onOpenSettings:this.onOpenSettings}):i.default.createElement(L.default,{contact:e,onCatalogLinkClick:this._onCatalogShare,onProductShare:this.onProductShare,onProductDetail:this.onEditProduct,onAddProduct:this._onAddProduct,catalogId:this.props.catalogId,onBack:this._end,onCartClick:this.onCartClick,businessProfile:null,headerType:m.DRAWER_HEADER_TYPE.LARGE,canManageCatalog:!0,autoUpdate:!0,onOpenSettings:this.onOpenSettings});this.push(t)}},this.onEditProduct=e=>{var t=r.default.assertGet(this.props.catalogId);u.default.openDrawerMid(i.default.createElement(g.default,{catalog:t,product:e}),"slide-left",void 0,void 0,this.props.context)},this.onCartClick=e=>{(0,T.default)(e,void 0,this.props.context)},this.onCollectionSeeAll=e=>{var t=this.props.catalogId,a=h.default.gadd(t);this.push(i.default.createElement(c.default,{contact:a,onProductDetail:this.onEditProduct,catalogId:t,onBack:this._pop,onCatalogLinkClick:this._onCatalogShare,onCartClick:this.onCartClick,collection:e,canManageCatalog:!0,headerType:m.DRAWER_HEADER_TYPE.LARGE,onEditCollection:this._onEditCollection}))},this._onEditCollection=e=>{var t=(0,C.getMeUser)(),a=r.default.get(t);a&&this.push(i.default.createElement(v.default,{onBack:this._pop,collection:e,catalog:a}))},this._onAddProduct=()=>{var e=r.default.assertGet(this.props.catalogId),t=new M.default({catalogWid:e.id,additionalImageCdnUrl:[]});u.default.openDrawerMid(i.default.createElement(g.default,{catalog:e,product:t,newProduct:!0}),"slide-left",void 0,void 0,this.props.context)},this._onCatalogShare=(e,t)=>{u.default.openDrawerMid(i.default.createElement(n.default,{onCancel:()=>{u.default.closeDrawerMid()},catalog:e,contact:t,prompt:y.default.t(490),onSend:()=>u.default.closeDrawerMid(),centerDrawer:!0}),"slide-left",void 0,void 0,this.props.context)},this.onProductShare=e=>{u.default.openDrawerMid(i.default.createElement(P.default,{onCancel:()=>{u.default.closeDrawerMid()},product:e,prompt:y.default.t(490),onSend:()=>u.default.closeDrawerMid(),centerDrawer:!0,sendProductMsg:!0}),"slide-left",void 0,void 0,this.props.context)},this.onOpenCollections=()=>{u.default.openDrawerLeft(i.default.createElement(f.default,null))},this.onOpenSettings=()=>{this.push(i.default.createElement(o.default,{onBack:this._pop}))},this._pop=()=>{this.pop(),u.default.closeDrawerMid()},this._end=()=>{this.end(!0),u.default.closeDrawerMid()}}componentDidMount(){null!=this.props.catalog?(this._showProductList(),null!=this.props.product&&this.onEditProduct(this.props.product)):this._showNewCatalog()}_showNewCatalog(){this.push(i.default.createElement(I.default,{onBack:this._pop,onAddProductClick:this._handleAddFirstProduct,onCatalogAlreadyCreated:this._showProductList}))}}t.default=e=>i.default.createElement(p.default.Consumer,null,(t=>i.default.createElement(b,(0,s.default)({context:t},e))))},69766:(e,t,a)=>{"use strict";var l=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=l(a(67294)),i=l(a(57984)),r=l(a(97420)),n=l(a(12283)),o=l(a(70547)),d=l(a(21681)),u=a(56726);class c extends d.default{constructor(...e){super(...e),this.editCollection=e=>{var t=(0,u.getMeUser)(),a=i.default.get(t);a&&this.push(s.default.createElement(o.default,{onBack:this._pop,collection:e,catalog:a}))},this._pop=()=>{this.pop(),r.default.closeDrawerMid()},this._end=()=>{this.end(!0),r.default.closeDrawerMid()}}componentDidMount(){this.showCollectionsList()}showCollectionsList(){this.push(s.default.createElement(n.default,{onBack:this._pop,editCollection:this.editCollection}))}}t.default=c},30053:(e,t,a)=>{"use strict";var l=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=l(a(67294)),i=l(a(14109)),r=l(a(21681)),n=l(a(34331));class o extends r.default{constructor(...e){super(...e),this.onProductClick=e=>{this.push(s.default.createElement(n.default,{refreshCarousel:!0,chat:this.props.msg.chat,product:e,onEnd:this._pop}))},this._pop=()=>{this.pop()}}componentDidMount(){this.push(s.default.createElement(i.default,{msg:this.props.msg,onProductClick:this.onProductClick}))}}t.default=o},65829:(e,t,a)=>{"use strict";var l=a(20862),s=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(a(67294)),r=s(a(73136)),n=s(a(97420)),o=l(a(58750)),d=l(a(92246)),u=s(a(21681)),c=l(a(15178)),f=l(a(8336)),h=l(a(18467)),p=s(a(52206));class m extends u.default{constructor(...e){super(...e),this._refCaptureDrawer=null,this._setRefCaptureDrawer=e=>{this._refCaptureDrawer=e},this._pushPermissionModal=()=>{this.push(i.default.createElement(c.default,{messaging:c.Messaging.CAMERA,type:c.default.TYPE.GUIDE_ALLOW,onConfirm:this._popModal}),"modal")},this._popModal=()=>{this.pop("modal")},this._startCaptureDrawer=()=>{var e;null===(e=this._disposeStream)||void 0===e||e.call(this);var{asyncStream:t,disposeStream:a}=f.start("camera",this._pushPermissionModal);this._disposeStream=a,t.then((e=>{this._refCaptureDrawer||this._popModal(),e&&this._refCaptureDrawer&&this._refCaptureDrawer.loadNewStream(e,a)})).catchType(d.GUM.NotAllowedError,(()=>{this.cleanUp(),n.default.openModal(i.default.createElement(c.default,{messaging:c.Messaging.CAMERA_FAIL,type:c.default.TYPE.GUIDE_UNBLOCK}))})).catchType(d.GUM.GUMError,(()=>{this.cleanUp(),n.default.openModal(i.default.createElement(c.default,{messaging:c.Messaging.CAMERA_MISSING,type:c.default.TYPE.GUIDE_NONE}))}))},this.onFinished=(e,t)=>{this.props.onFinished(e,t),this.cleanUp()},this.cleanUp=()=>{this.end()},this.onRetake=()=>{this.pop("flow-transition-box-size-drawer-pop"),this._startCaptureDrawer()},this.onCaptured=e=>{this.push(i.default.createElement(h.default,{type:h.BoxModalType},i.default.createElement(o.default,{onRetake:this.onRetake,retryText:o.RETRY_OPTIONS.RETAKE,onFinished:this.onFinished,onCancel:this.cleanUp,img:e})),"flow-transition-box-size-drawer-push")},this.handleRequestDismiss=e=>{!1===e&&this.stackSize()>1?this.onRetake():this.cleanUp()}}componentDidMount(){this.push(i.default.createElement(h.default,{type:h.BoxModalType},i.default.createElement(r.default,{ref:this._setRefCaptureDrawer,stream:void 0,disposeStream:void 0,caption:!1,theme:"capture-cover",onBack:this.cleanUp,onSend:null,onCaptured:this.onCaptured,chat:void 0}))),this._startCaptureDrawer()}componentWillUnmount(){var e;null===(e=this._disposeStream)||void 0===e||e.call(this)}}var v=(0,p.default)(m);t.default=v},18749:(e,t,a)=>{"use strict";var l=a(20862),s=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(a(67294)),r=l(a(58750)),n=s(a(21681));class o extends n.default{constructor(...e){super(...e),this.onEnd=()=>{this.end()},this.onFinished=(e,t)=>{this.props.onFinished(e,t),this.end()}}componentDidMount(){this.push(i.default.createElement(r.default,{onCancel:this.onEnd,onFinished:this.onFinished,onRetake:this.props.onRetake,retryText:r.RETRY_OPTIONS.RESTART,img:this.props.img}))}}t.default=o},14382:(e,t,a)=>{"use strict";var l=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=l(a(67294)),i=l(a(97420)),r=l(a(33023)),n=l(a(21681)),o=l(a(66761)),d=l(a(6853)),u=l(a(37091));class c extends n.default{constructor(...e){super(...e),this._showInfoDrawer=e=>{var{catalog:t}=this.props;this.push(s.default.createElement(d.default,{catalog:t,product:e,onCancel:this.end,onEditProduct:this._onProductEdit,onShareProduct:this.onShareProduct}))},this.onShareProduct=e=>{this.push(s.default.createElement(u.default,{onBack:this._pop,product:e,prompt:s.default.createElement("div",null,o.default.t(490)),onSend:()=>i.default.closeDrawerMid(),centerDrawer:!0,sendProductMsg:!0}))},this._onProductEdit=e=>{this.push(s.default.createElement(r.default,{catalog:this.props.catalog,onBack:this._pop,onEditSuccess:this._showInfoDrawer,product:e,onDelete:this.props.onDelete}))},this._pop=()=>{this.pop()},this._end=()=>{this.end(!0)}}componentDidMount(){var{catalog:e,product:t,onCreate:a,newProduct:l}=this.props;l?this.push(s.default.createElement(r.default,{onCancel:this._pop,onEditSuccess:e=>{a&&a(),this._showInfoDrawer(e)},catalog:e,product:t,newProduct:!0})):this._showInfoDrawer(t)}}t.default=c},97558:(e,t,a)=>{"use strict";var l=a(20862),s=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(a(67294)),r=s(a(18917)),n=s(a(97420)),o=s(a(58743)),d=s(a(46274)),u=s(a(21681)),c=s(a(31131)),f=s(a(28585)),h=s(a(66761)),p=l(a(30399)),m=s(a(86981));class v extends u.default{constructor(...e){super(...e),this.requestFocus=()=>{var e,t=null===(e=this.refUIE)||void 0===e?void 0:e.getRef();null!=t&&(t instanceof HTMLElement||"function"!=typeof t.onFocusList||t.onFocusList())},this.onForwardConfirmed=e=>{var{msgs:t,onForward:a}=this.props;r.default.forwardMessagesToChats(t,e).catchType(c.default,(e=>{this._showMediaSendError(e.reasons)})),this.end(),a&&a(t),n.default.openChatFromUnread(e[0])},this._showMediaSendError=e=>{var t=e.map((({chat:e,reason:t})=>i.default.createElement("p",{key:e.id.toString()},e.formattedTitle," : ",t)));n.default.openModal(i.default.createElement(o.default,{onOK:()=>n.default.closeModal(),okText:h.default.t(1826)},t),void 0)}}componentDidMount(){var e,{msgs:t}=this.props,a=h.default.t(753,{_plural:t.length||1}),l=t[0],s=l&&l.chat;e="video"!==l.type&&"image"!==l.type?"message":l.type;var r,n=t.some((e=>e.isFrequentlyForwarded)),o=t.filter((e=>!e.isFrequentlyForwarded&&e.getForwardingScoreWhenForwarded()===d.default.FREQUENTLY_FORWARDED_SENTINEL));m.default.frequentlyForwardedMessages&&o.length&&(r=i.default.createElement(f.default,{frequentlyForwardedCount:o.length,totalCount:t.length}));var u=m.default.frequentlyForwardedMessages&&n?m.default.frequentlyForwardedMax:m.default.multicastLimitGlobal;this.push(i.default.createElement(p.default,{onConfirm:this.onForwardConfirmed,maxItems:u,excludeChat:s,excludeBroadcast:!0,msgType:e,title:a,listType:p.ListType.CHAT_SELECT_MODAL,customHeader:r,hasFrequentlyForwarded:n,showEphemeralIcon:!0}))}}t.default=v},27346:(e,t,a)=>{"use strict";var l=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=l(a(67294)),i=l(a(21681)),r=l(a(66564));class n extends i.default{componentDidMount(){this.push(s.default.createElement(r.default,{chat:this.props.chat,onConfirm:this.props.onConfirm}))}}t.default=n},98366:(e,t,a)=>{"use strict";var l=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=l(a(67294)),i=l(a(21681)),r=l(a(94348)),n=l(a(34331));class o extends i.default{constructor(...e){super(...e),this.onProductClick=e=>{this.push(s.default.createElement(n.default,{refreshCarousel:!0,chat:this.props.msg.chat,product:e,onEnd:this._pop}))},this._pop=()=>{this.pop()}}componentDidMount(){this.push(s.default.createElement(r.default,{msg:this.props.msg,onProductClick:this.onProductClick}))}}t.default=o},16817:(e,t,a)=>{"use strict";var l=a(20862),s=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(a(67294)),r=s(a(18917)),n=s(a(97420)),o=s(a(58743)),d=s(a(21681)),u=s(a(28936)),c=s(a(50750)),f=s(a(66761)),h=s(a(56573)),p=s(a(23045)),m=a(4205),v=l(a(9931));class g extends d.default{constructor(...e){super(...e),this.onSendInvite=(e="",t)=>{n.default.closeModal(),Promise.all(this.props.participantNeedInvite.map((a=>{var{contact:l,invite_code:s,invite_code_exp:i}=a;return r.default.find(l.id).then((a=>{var r=this.props.groupGid.toString(),n=u.default.assertGet(r);return a.sendGroupInviteMessage(r,this.props.subject,s||"",i,e,t).then((e=>e===m.SendMsgResult.OK&&(n.pendingParticipants.add({id:l.id}),!0)))}))}))).then((e=>{var t=e.filter(Boolean).length;n.default.openToast(i.default.createElement(v.default,{msg:f.default.t(1779,{num:t,_plural:t}),id:(0,v.genId)()}))}))},this._addInviteCommment=e=>{this.push(i.default.createElement(c.default,{participants:e,gid:this.props.groupGid,subject:this.props.subject,groupDesc:this.props.groupDesc,onClose:this._pop,onSend:this.onSendInvite}))},this._pop=()=>{this.pop()}}componentDidMount(){var{participantNeedInvite:e}=this.props,t=this._getFormattedNames(e.map((e=>e.contact)),!0),a=f.default.t(836,{participant:t,_plural:e.length});this.push(i.default.createElement(o.default,{onOK:this._addInviteCommment.bind(this,e),okText:f.default.t(1778),onCancel:this._pop,cancelText:f.default.t(1657)},a))}_getFormattedName(e,t=!1){return t?e.formattedUser:i.default.createElement(p.default,{contact:e})}_getFormattedNames(e,t=!1){if(!Array.isArray(e))return this._getFormattedName(e,t);var a=e.map((e=>this._getFormattedName(e,t)));return(0,h.default)(a,t)}}t.default=g,g.defaultProps={removeTopDrawer:!0,pushTransition:"none",popTransition:"none"}},91244:(e,t,a)=>{"use strict";var l=a(20862),s=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(a(67294)),r=l(a(58750)),n=s(a(21681)),o=s(a(73043));class d extends n.default{constructor(...e){super(...e),this.onImageSelected=(e,t)=>{this.push(i.default.createElement(r.default,{onCancel:this._handleCancel,attributionUrl:t,onFinished:this.onFinished,onRetake:this._pop,retryText:r.RETRY_OPTIONS.NONE,img:e}))},this._handleCancel=()=>{this.end()},this._pop=()=>{this.pop()},this.onFinished=(e,t)=>{this.props.onFinished(e,t),this.end()}}componentDidMount(){this.push(i.default.createElement(o.default,{onCancel:this._pop,onImageSelected:this.onImageSelected}))}}t.default=d},84217:(e,t,a)=>{"use strict";var l=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=l(a(67294)),i=l(a(3910)),r=l(a(97420)),n=l(a(58743)),o=l(a(46274)),d=l(a(21681)),u=l(a(66761)),c=l(a(66375)),f=l(a(10242)),h=l(a(87096)),p=l(a(43325));class m extends d.default{constructor(...e){super(...e),this.onDeleteLabel=e=>{e.forEach((({id:e})=>{c.default.deleteLabel(e)}))},this._onManageLabels=e=>{r.default.openModal(s.default.createElement(p.default,{modelsToUpdate:e}))},this.onEditLabel=e=>{r.default.openModal(s.default.createElement(i.default,{labelId:e,onUpdateLabel:this.onUpdateLabel,onCancel:r.default.closeModal()}))},this.onLabelClick=e=>{var t=a(63873).Z;this.push(s.default.createElement(t,{openLabelColorDrawer:this.openLabelColorDrawer,labelId:e,onManageLabels:this._onManageLabels,onClose:this._pop,onRemoveLabel:this.onRemoveLabel,onEditLabel:this.onEditLabel}))},this.openAddLabel=()=>{c.default.toArray().length>=o.default.MAX_SMB_LABEL_COUNT?r.default.openModal(s.default.createElement(n.default,{okText:u.default.t(1196),onOK:()=>r.default.closeModal()},u.default.t(1986,{count:o.default.MAX_SMB_LABEL_COUNT}))):r.default.openModal(s.default.createElement(i.default,{onAddLabel:this.onAddLabel,onCancel:r.default.closeModal()}))},this.onUpdateLabel=(e,t)=>{c.default.updateLabel(e,t)},this.openLabelColorDrawer=(e,t)=>{this.push(s.default.createElement(f.default,{labelId:e,onClose:this._pop,onUpdateColor:this.onUpdateLabel,currentColor:t}))},this._pop=()=>{this.pop()}}componentDidMount(){this.push(s.default.createElement(h.default,{onDeleteLabel:this.onDeleteLabel,onLabelClick:this.onLabelClick,onClose:this._pop,openAddLabel:this.openAddLabel}))}onAddLabel(e,t){c.default.addNewLabel(e,t)}onRemoveLabel(e,t){c.default.addOrRemoveLabels([{id:e,type:"remove"}],t)}}t.default=m},46150:(e,t,a)=>{"use strict";var l=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=l(a(67294)),i=l(a(3910)),r=l(a(6653)),n=l(a(97420)),o=l(a(58743)),d=l(a(46274)),u=l(a(21681)),c=l(a(66761)),f=l(a(66375)),h=a(51508),p=l(a(3775)),m=l(a(5148));class v extends u.default{constructor(...e){super(...e),this._newlyAddedLabels=new Set,this._logWamEvent=()=>{var e=this.props.modelsToUpdate.length;this._labelViewType=1===e?this.props.modelsToUpdate[0]instanceof r.default?m.default.LABEL_TARGETS.LABEL_CHAT_DIALOG:m.default.LABEL_TARGETS.LABEL_MESSAGE_DIALOG:m.default.LABEL_TARGETS.LABEL_COMBINED_DIALOG,(0,h.logLabelOperationEvent)(m.default.LABEL_OPERATIONS.VIEW,e,this._labelViewType)},this.onLabelUpdateComplete=()=>{this.props.onLabelUpdateComplete&&this.props.onLabelUpdateComplete(),this._pop()},this.onAddLabel=(e,t)=>{f.default.addNewLabel(e,t).then((()=>{this._newlyAddedLabels.add(e)}))},this.shouldScrollIntoViewAndSelect=e=>this._newlyAddedLabels.has(e)?(this._newlyAddedLabels.delete(e),{shouldScrollIntoView:!0,shouldSelect:!0}):{shouldScrollIntoView:!1,shouldSelect:!1},this.onAddNewLabel=()=>{f.default.toArray().length>=d.default.MAX_SMB_LABEL_COUNT?n.default.openModal(s.default.createElement(o.default,{okText:c.default.t(1196),onOK:()=>n.default.closeModal()},c.default.t(1986,{count:d.default.MAX_SMB_LABEL_COUNT}))):this.push(s.default.createElement(i.default,{onAddLabel:this.onAddLabel,onCancel:this._pop}))},this._popAndLogEvent=()=>{this._labelViewType&&(0,h.logLabelOperationEvent)(m.default.LABEL_OPERATIONS.CLICK_NEGATIVE,this.props.modelsToUpdate.length,this._labelViewType),this.pop()},this._pop=()=>{this.pop()}}componentDidMount(){this._logWamEvent(),this.push(s.default.createElement(p.default,{shouldScrollIntoViewAndSelect:this.shouldScrollIntoViewAndSelect,onAddNewLabel:this.onAddNewLabel,onLabelUpdateComplete:this.onLabelUpdateComplete,onCancel:this._popAndLogEvent,modelsToUpdate:this.props.modelsToUpdate}))}}t.default=v,v.defaultProps={removeTopDrawer:!0,pushTransition:"none",popTransition:"none"}},30005:(e,t,a)=>{"use strict";var l=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=l(a(67294)),i=l(a(18917)),r=l(a(97420)),n=l(a(69107)),o=l(a(79099)),d=l(a(21681)),u=l(a(66761)),c=l(a(47506)),f=l(a(74854));class h extends d.default{constructor(...e){super(...e),this.onClick=(e,t)=>{i.default.find(t.id).then(r.default.openChatFromUnread.bind(r.default)),this.end()},this.onNewGroup=()=>{this.push(s.default.createElement(f.default,{onBack:this.pop,onContinue:this.onSetGroupInfo}))},this.onSetGroupInfo=e=>{this.push(s.default.createElement(c.default,{participants:e,onBack:()=>{this.popAndUpdate({participants:e})},onContinue:this.end}))}}componentDidMount(){n.default.ensureSorted(),this.push(s.default.createElement(o.default,{title:u.default.t(1170),onBack:this.end,onClick:this.onClick,onNewGroup:this.onNewGroup}))}}t.default=h},20647:(e,t,a)=>{"use strict";var l=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=l(a(67294)),i=l(a(69107)),r=l(a(21681)),n=l(a(47506)),o=l(a(74854));class d extends r.default{constructor(...e){super(...e),this.onSetGroupInfo=e=>{this.push(s.default.createElement(n.default,{participants:e,onBack:()=>{this.popAndUpdate({participants:e})},onContinue:this.end}))}}componentDidMount(){i.default.ensureSorted(),this.push(s.default.createElement(o.default,{onBack:this.end,onContinue:this.onSetGroupInfo}))}}t.default=d},32956:(e,t,a)=>{"use strict";var l=a(20862),s=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=T;var i=s(a(67154)),r=s(a(48926)),n=l(a(67294)),o=s(a(99420)),d=s(a(9506)),u=s(a(99568)),c=s(a(31105)),f=s(a(69107)),h=s(a(31763)),p=s(a(21681)),m=a(53615),v=a(58635),g=s(a(43851)),E=a(66248),_=s(a(77453)),C=s(a(64349)),S=s(a(37091)),y=s(a(28187)),I=s(a(23991)),M=s(a(43866)),P=a(32991);class L extends p.default{constructor(...e){var t;super(...e),t=this,this.scrollOffset=0,this.setScrollOffset=e=>{this.scrollOffset=e},this.onCollectionSeeAll=e=>{this.push(n.default.createElement(T,{chat:this.props.chat,catalogOwnerJid:this.props.catalogOwnerJid,collection:e,isAllItems:!e}))},this._pushProductDetails=e=>{var{chat:t,refreshCarousel:a}=this.props,l=n.default.createElement(_.default,{chat:t,product:e,onEnd:this._end,onBack:this._popAndUpdate,onProductDetail:this.onProductDetail,onProductCatalog:this.onProductCatalogHeaderClick,onProductLinkClick:this._onProductLinkClick,refreshCarousel:a,onCartClick:this._onCartClick});this.push(l)},this._pushProductDetailsWithDeepLink=e=>{var t=n.default.createElement(C.default,{chat:this.props.chat,productInfo:e,onEnd:this._end,onBack:this._pop,onProductDetail:this.onProductDetail,onProductCatalog:this.onProductCatalogHeaderClick,onProductLinkClick:this._onProductLinkClick,onCartClick:this._onCartClick});this.push(t)},this.pushProductCatalog=function(){var e=(0,r.default)((function*(e){var a=f.default.gadd(e),l=yield o.default.find(e),s=(0,m.canViewCollections)()?n.default.createElement(u.default,{contact:a,onProductDetail:t.onProductDetail,catalogId:e,onBack:t._pop,businessProfile:l,scrollOffset:t.scrollOffset,setScrollOffset:t.setScrollOffset,onCatalogLinkClick:t._onCatalogLinkClick,onCartClick:t._onCartClick,onCollectionSeeAll:t.onCollectionSeeAll}):n.default.createElement(y.default,{contact:a,onProductDetail:t.onProductDetail,catalogId:e,onBack:t._pop,businessProfile:l,setScrollOffset:t.setScrollOffset,onCatalogLinkClick:t._onCatalogLinkClick,onCartClick:t._onCartClick});t.push(s)}));return function(){return e.apply(this,arguments)}}(),this._pushOrderDetail=(e,t,a,l)=>{var s=n.default.createElement(g.default,{orderId:e,token:t,sellerJid:a,userIsCartOwner:l,onProductDetail:this._onProductDetailFromInfo});this.push(s)},this._pushProductList=(e,t)=>{var a=f.default.gadd(t),l=n.default.createElement(I.default,{contact:a,productListId:e,onProductDetail:this.onProductDetail,onCartClick:this._onCartClick,onBack:this._pop,onEnd:this._end,setScrollOffset:this.setScrollOffset});this.push(l)},this.onProductDetail=e=>{this._pushProductDetails(e)},this._onProductDetailFromInfo=e=>{this._pushProductDetailsWithDeepLink(e)},this.onProductCatalogHeaderClick=(e,t)=>{(0,v.logCarouselViewMoreClick)({catalogOwnerWid:e,catalogContext:t}),this.pushProductCatalog(e)},this._onProductLinkClick=e=>{this.push(n.default.createElement(S.default,{product:e,onBack:this._pop}))},this._onCatalogLinkClick=(e,t)=>{this.push(n.default.createElement(d.default,{catalog:e,contact:t,onBack:this._pop}))},this._onCartClick=e=>{var t=(0,E.getProductCatalogContext)(this.props.context),a=(0,M.default)(e,this.props.chat,t);a&&this.push(a)},this._pop=()=>{this.pop()},this._end=()=>{this.end(!0)},this._popAndUpdate=()=>{this.popAndUpdate({scrollOffset:this.scrollOffset})}}componentDidMount(){var{catalogOwnerJid:e,orderId:t,product:a,productInfo:l,productListId:s,collection:i,isAllItems:r}=this.props;if(e)i||r?this.pushCollectionContent((0,P.createWid)(e)):null!=s?this._pushProductList(s,(0,P.createWid)(e)):this.pushProductCatalog((0,P.createWid)(e));else if(a)this._pushProductDetails(a);else if(l)this._pushProductDetailsWithDeepLink(l);else{if(!t)throw new Error("ProductDetailsFlow:no-product");var{token:n,sellerJid:o,userIsCartOwner:d}=this.props;null!=n&&null!=o&&null!=d&&this._pushOrderDetail(t,n,o,d)}}pushCollectionContent(e){var t=f.default.gadd(e);this.push(n.default.createElement(c.default,{contact:t,onProductDetail:this.onProductDetail,catalogId:e,onBack:this._pop,onCatalogLinkClick:this._onCatalogLinkClick,onCartClick:this._onCartClick,scrollOffset:this.scrollOffset,setScrollOffset:this.setScrollOffset,collection:this.props.collection}))}}function T(e){var t=(0,n.useContext)(h.default);return n.default.createElement(L,(0,i.default)({context:t},e))}},39583:(e,t,a)=>{"use strict";var l=a(20862),s=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(a(67154)),r=s(a(67294)),n=s(a(21681)),o=s(a(66761)),d=l(a(30399)),u=s(a(52537)),c=s(a(86981));class f extends n.default{constructor(...e){super(...e),this._handleForwardConfirmed=e=>{0===e.length&&this.end(),this._chatsToForwardTo=e,this._sendContactToChats(e)},this._sendContactToChats=e=>{for(var t of e)(0,u.default)(this.props.contacts,t),t.composeQuotedMsg=null;this.props.onContactsSent(e[0]),this.end()},this._popNone=()=>{this.pop("none")},this._handleCancel=()=>{this.end()}}componentDidMount(){var e=null==this.props.maxItems?this.props.serverProps.maxParticipants:this.props.maxItems;this.push(r.default.createElement(d.default,{onConfirm:this._handleForwardConfirmed,maxItems:e,title:o.default.t(1363),listType:d.ListType.CHAT_SELECT_MODAL,onCancel:this._handleCancel}))}}t.default=e=>r.default.createElement(f,(0,i.default)({},e,{serverProps:c.default}))},55838:(e,t,a)=>{"use strict";var l=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var{chat:t}=e,a=(0,s.default)(t.groupMetadata.groupInviteLink,"chat.groupMetadata.groupInviteLink"),l=`${r.default.t(830)} ${a}`;return i.default.createElement(n.default,{title:r.default.t(815),text:l,pushTransition:"none",popTransition:"none"})};var s=l(a(96391)),i=l(a(67294)),r=l(a(66761)),n=l(a(34751))},75584:(e,t,a)=>{"use strict";var l=a(20862),s=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(a(67154)),r=s(a(67294)),n=a(87577),o=s(a(97420)),d=s(a(21681)),u=s(a(66761)),c=l(a(30399)),f=a(49993),h=s(a(86981));class p extends d.default{constructor(...e){super(...e),this.onForwardConfirmed=e=>{var t=this.props.msgText;if(1===e.length){var a=e[0];(a.isUser&&a.contact.isBlocked()?(0,n.unblockContact)(a.contact):Promise.resolve(!0)).then((()=>{if(t){if(a.urlText=this.props.urlText,a.active)return void o.default.pasteChatTextInput(a,t);a.setComposeContents({text:t})}return o.default.openChatFromUnread(a).then((e=>{e&&o.default.focusChatTextInput(a)}))}))}else Promise.all(e.map((e=>{(e.isUser&&e.contact.isBlocked()?(0,n.unblockContact)(e.contact):Promise.resolve(!0)).then((()=>{e.urlText=this.props.urlText,(0,f.sendTextMsgToChat)(e,t)}))}))),o.default.openChatFromUnread(e[0]);this.end()}}componentDidMount(){this.push(r.default.createElement(c.default,{onConfirm:this.onForwardConfirmed,maxItems:this.props.serverProps.multicastLimitGlobal,title:u.default.t(1080),listType:c.ListType.CHAT_SELECT_MODAL}))}}t.default=e=>r.default.createElement(p,(0,i.default)({},e,{serverProps:h.default}))},46561:(e,t,a)=>{"use strict";var l=a(20862),s=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(a(48926)),r=s(a(67294)),n=a(87577),o=s(a(97420)),d=s(a(46274)),u=s(a(21681)),c=s(a(66761)),f=l(a(30399)),h=s(a(86981));class p extends u.default{constructor(...e){var t;super(...e),t=this,this._handleForwardConfirmed=e=>{e.forEach(function(){var e=(0,i.default)((function*(e){e.isUser&&e.contact.isBlocked()&&(yield(0,n.unblockContact)(e.contact)),t._sendProduct(e)}));return function(){return e.apply(this,arguments)}}()),this.end(),1===e.length&&(o.default.openChatFromUnread(e[0]),window.innerWidth<=d.default.LAYOUT_2COLUMNS_MAX_WIDTH&&o.default.closeDrawerRight()),this.props.onSend&&this.props.onSend()},this._handleCancel=()=>{this.end()},this._sendProduct=e=>{var{product:t}=this.props;o.default.once("ui_idle",(()=>{e.sendProductMessage(t)}))}}componentDidMount(){o.default.closeContextMenu(),o.default.closeTooltip(),this.push(r.default.createElement(f.default,{onConfirm:this._handleForwardConfirmed,maxItems:h.default.multicastLimitGlobal,title:c.default.t(1080),listType:f.ListType.CHAT_SELECT_MODAL,onCancel:this._handleCancel}))}}t.default=p},65851:(e,t,a)=>{"use strict";var l=a(20862),s=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(a(67294)),r=s(a(73636)),n=s(a(35576)),o=l(a(6514)),d=s(a(97420)),u=s(a(3243)),c=s(a(69107)),f=s(a(21681)),h=a(56726),p=s(a(47334)),m=s(a(89650)),v=s(a(47029)),g=s(a(42047)),E=s(a(27101)),_=s(a(54161)),C=s(a(87642)),S=s(a(15105)),y=s(a(43351)),I=s(a(71530)),M=s(a(2990)),P=s(a(56990));class L extends f.default{constructor(...e){super(...e),this._showWallpaperDrawer=()=>{this.push(i.default.createElement(M.default,{onClose:this._pop}))},this._showArchiveSettingsDrawer=()=>{this.push(i.default.createElement(r.default,{settings:C.default,onClose:this._pop}))},this._showBlockedDrawer=()=>{this.push(i.default.createElement(n.default,{onClose:this._pop}))},this._showProfileDrawer=()=>{var e=(0,h.getMaybeMeUser)(),t=y.default.assertGet(e),a=_.default.assertGet(e),l=c.default.assertGet(e);this.push(i.default.createElement(E.default,{status:t,profilePicThumb:a,contact:l,conn:u.default,onClose:this._pop}))},this._showNotifications=()=>{this.push(i.default.createElement(g.default,{onClose:this._pop}))},this._showMediaAutoDownload=()=>{this.push(i.default.createElement(v.default,{onClose:this._pop}))},this._showSecurity=()=>{this.push(i.default.createElement(P.default,{onClose:this._pop}))},this._showHelp=()=>{o.upload({reason:"help-page-opened",isHighPri:!0}),this.push(i.default.createElement(p.default,{onClose:this._pop}))},this._showThemePopup=()=>{d.default.openModal(i.default.createElement(I.default,null))},this.showKeyboardShortcuts=()=>{d.default.openModal(i.default.createElement(m.default,null))},this._pop=()=>{this.pop()}}componentDidMount(){this.push(i.default.createElement(S.default,{profileId:(0,h.getMaybeMeUser)(),onWallpaper:this._showWallpaperDrawer,onBlocked:this._showBlockedDrawer,onProfile:this._showProfileDrawer,onNotifications:this._showNotifications,onMediaAutoDownload:this._showMediaAutoDownload,onSecurity:this._showSecurity,onHelp:this._showHelp,onThemeSettings:this._showThemePopup,onKeyboardShortcuts:this.showKeyboardShortcuts,onClose:this._pop,settings:C.default,onArchiveSettings:this._showArchiveSettingsDrawer}))}}t.default=L},51280:(e,t,a)=>{"use strict";var l=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=l(a(67294)),i=l(a(97420)),r=l(a(21681)),n=l(a(48878)),o=l(a(84361)),d=l(a(77389));class u extends r.default{constructor(...e){super(...e),this.sessionId=Math.round(1e9*Math.random()),this._openStatusViewer=(e,t,a)=>{this.push(s.default.createElement(d.default,{initialStatusV3:e,initialStatusMsg:t,closeStatusViewer:this.closeStatusViewer,sessionId:this.sessionId,rowIdx:a}),"none")},this.closeStatusViewer=e=>{e?this.end():this.pop("none")}}componentDidMount(){this.push(s.default.createElement(o.default,{onOpenStatus:this._openStatusViewer,closeStatusViewer:this.closeStatusViewer,sessionId:this.sessionId}),"status-v3-modal"),this.props.listeners.add(i.default,"close_status_viewer",(()=>{this.closeStatusViewer(!0)}))}componentWillUnmount(){this.props.onFlowEnd()}}var c=(0,n.default)(u);t.default=c},56616:(e,t,a)=>{"use strict";var l=a(95318),s=a(20862);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(a(67294)),r=l(a(79274)),n=l(a(98712)),o=a(53615),d=l(a(66761)),u=l(a(66375)),c=s(a(28113)),f=l(a(48878));class h extends i.PureComponent{constructor(...e){super(...e),this._updateLabels=()=>{this.forceUpdate()}}componentDidMount(){this.props.listeners.add(u.default,`label_updated_${this.props.label}`,this._updateLabels)}render(){var{label:e}=this.props,t=u.default.get(e);if(!t||!t.name)return null;if("label-list"===this.props.theme){var a=i.default.createElement(c.default,{renderAsCircle:"label-list"===this.props.theme,theme:this.props.theme,labels:[e]}),l=i.default.createElement(n.default,{text:t.name,ellipsify:!0,titlify:!0});return i.default.createElement(r.default,{theme:(0,o.canEditLabel)()?"chat-checkbox":void 0,image:a,primary:l,secondary:d.default.t(908,{count:parseInt(t.count||0,10),_plural:parseInt(t.count||0,10)})})}var s=(0,c.renderLabelSvg)(t.hexColor),f=i.default.createElement(n.default,{text:t.name,ellipsify:!0,titlify:!0});return i.default.createElement(r.default,{theme:"label-selection",image:s,primary:f})}}h.displayName="LabelListItem";var p=(0,f.default)(h);t.default=p},48679:(e,t,a)=>{"use strict";var l=a(95318),s=a(20862);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(a(67294)),r=l(a(95806)),n=l(a(60246)),o=a(53615),d=l(a(66375)),u=l(a(56616)),c=l(a(48878)),f=l(a(15508));class h extends i.PureComponent{constructor(){super(),this._refLastLabel=null,this.updateData=(e,t,a)=>{var{shouldScrollIntoViewAndSelect:l}=this.props;this.setState({labels:d.default.toArray()},(()=>{if(a.add&&l){var{shouldScrollIntoView:t,shouldSelect:s}=l(e.name);t&&this._refLastLabel&&this._refLastLabel.scrollIntoView({behavior:"smooth"}),s&&this.onMultiSelect(e,!0,!1)}}))},this._setRefLastLabel=e=>{this._refLastLabel=e},this.onMultiSelect=(e,t,a)=>{var{selectedLabels:l,onMultiSelect:s}=this.props;l&&l.setVal(e,t,a),s&&s(e.id)},this._renderLabelRow=()=>{var{renderContext:e,onLabelClick:t,initialLabelState:a={}}=this.props,l=this.props.SelectableState||new f.default(!0),s=n.default.supportsFeature(n.default.F.MD_BACKEND)?[...this.state.labels].sort(((e,t)=>{var a=parseInt(e.id,10),l=parseInt(t.id,10);return isNaN(a)||isNaN(l)?0:a-l})):this.state.labels;return s.reduce(((n,c,f)=>{var h=d.default.assertGet(c.id);if(!c.name)return n;var p="label-selection"===e||(0,o.canEditLabel)()?i.default.createElement(r.default,{theme:e,model:h,initialSelection:a[c.id]||0,multiSelection:this.props.selectedLabels,selectableState:l,onSelect:this.onMultiSelect},i.default.createElement(u.default,{label:c.id})):i.default.createElement(u.default,{label:c.id,theme:e});return[...n,i.default.createElement("div",{key:`label_item_${c.id}`,ref:f===s.length-1?this._setRefLastLabel:()=>{},onClick:t?t.bind(null,c.id):()=>{}},p)]}),[])},this.state={labels:d.default.toArray()}}componentDidMount(){this.props.listeners.add(d.default,"add remove",this.updateData)}render(){return i.default.createElement("div",null,this._renderLabelRow())}}h.displayName="MultiSelectLabelList";var p=(0,c.default)(h);t.default=p},98419:(e,t,a)=>{"use strict";var l=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"LiveLocationDrawer",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(t,"ExpiredLocationDrawer",{enumerable:!0,get:function(){return i.default}});var s=l(a(24110)),i=l(a(84404))},37976:(e,t,a)=>{"use strict";var l=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.requireBundle=void 0;var s=l(a(67294)),i=l(a(68356)),r=l(a(46274)),n=l(a(66761)),o=l(a(25801)),d=(0,l(a(83179)).default)((()=>Promise.all([a.e(8295),a.e(1702),a.e(9488),a.e(275)]).then(a.bind(a,81843)).then((e=>e.default))),"ContactUsModal");t.requireBundle=d;var u=(0,i.default)({loader:d,loading:e=>s.default.createElement(o.default,{title:n.default.t(1436),okText:n.default.t(1366),error:Boolean(e.error)}),delay:r.default.LOADABLE_DELAY});t.default=u},51994:(e,t,a)=>{"use strict";var l=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=l(a(82492)),i=a(51418),r=l(a(53918));class n{constructor(e,t,a,l){this.updateEditData=e=>{this.saveEdits(),this.editData=(0,s.default)({},this.editData,e)},this.updateEditItems=(e,t)=>{this.saveEdits();var a=[];this.editData.items&&this.editData.items.forEach((e=>{e!==t&&a.push(e)})),a.push(e),this.editData.items=a},this.saveEdits=()=>{var e=new n(this.media,this.originalImage,this.editData,this.previous);this.previous=e},this.revertEdit=()=>{this.previous&&(this.editData=this.previous.editData,this.previous=this.previous.previous)},this.saveEditsFromCanvas=e=>{var t=e.toDataURL();this.editedImage||(this.editedImage=new Image),this.editedImage.src=t},this.exportEditedMedia=()=>{if(this.hasEdits()&&this.editedImage){var e=this.editedImage.src;return r.default.dataURLtoFile(e)}return this.media instanceof File?this.media:(0,i.createFile)([this.media],"",{type:this.media.type})},this.hasEdits=()=>!!this.previous&&this.editedImage,this.cleanUp=()=>{window.URL.revokeObjectURL(this.originalImage.src)},this.media=e,t?this.originalImage=t:(this.originalImage=new Image,this.originalImage.src=window.URL.createObjectURL(e)),this.previous=l,this.editData={height:0,width:0,offsetX:0,offsetY:0,rotation:0,scale:1,items:[],baseItem:null},(0,s.default)(this.editData,a)}}t.default=n},10315:(e,t,a)=>{"use strict";var l=a(95318),s=a(20862);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(76304),r=s(a(67294)),n=l(a(46274)),o=s(a(28518)),d=l(a(48878)),u=l(a(12843)),c=l(a(62745)),f=1.1;class h extends r.Component{constructor(...e){super(...e),this._validateTranslate=(e,t)=>{var a=this.props.editedMedia.editData,l=(e-a.width/2)*a.scale,s=(e+a.width/2)*a.scale,i=(t+a.height/2)*a.scale,r=(t-a.height/2)*a.scale;return{x:l<-this._cropRadius&&s>this._cropRadius,y:r<-this._cropRadius&&i>this._cropRadius}},this._validateScale=e=>{var t=this.props.editedMedia.editData,a=Math.max(2*this._cropRadius/t.width,2*this._cropRadius/t.height),l=Math.max(e,a);if(t.width*e<this._cropRadius||t.height*e<this._cropRadius)return!1;var s=-this._cropRadius/l+t.width/2,i=this._cropRadius/l-t.width/2,r=-this._cropRadius/l+t.height/2,n=this._cropRadius/l-t.height/2;return{scale:l,offsetX:Math.min(Math.max(t.offsetX,i),s),offsetY:Math.min(Math.max(t.offsetY,n),r)}},this._onPressMove=(e,t)=>{var a=this.props.editedMedia.editData,l=e.stageX-t.x,s=e.stageY-t.y,i=a.offsetX+l/a.scale,r=a.offsetY+s/a.scale,n=this._validateTranslate(i,r);n.x&&(a.offsetX=i),n.y&&(a.offsetY=r),t.x=e.stageX,t.y=e.stageY,this.props.drawCanvas()},this._onEnlarge=(e=1.1)=>{var t=this.props.editedMedia.editData,a=0!==e?e:f,l=this._validateScale(t.scale*a);l&&(t.scale=l.scale,t.offsetX=l.offsetX,t.offsetY=l.offsetY,this.props.drawCanvas())},this._onReduce=(e=1.1)=>{var t=this.props.editedMedia.editData,a=0!==e?e:f,l=this._validateScale(t.scale/a);l&&(t.scale=l.scale,t.offsetX=l.offsetX,t.offsetY=l.offsetY,this.props.drawCanvas())},this.crop=()=>{var e,t=this.props.editedMedia,a=t.editData,l=t.editedImage&&t.editedImage.src;if(!l)return Promise.reject("empty image");var s=2*this._cropRadius,i=s;return s>n.default.MAX_PIC_SIDE?i=n.default.MAX_PIC_SIDE:s<n.default.MIN_PIC_SIDE&&(i=n.default.MIN_PIC_SIDE),o.crop(l,(a.width-2*this._cropRadius)/2,(a.height-2*this._cropRadius)/2,2*this._cropRadius,2*this._cropRadius,i,i,o.DATA_URL|o.CANVAS).then((({images:t})=>(e=t.dataUrl,o.crop(t.canvas,0,0,n.default.PROF_PIC_THUMB_SIDE,n.default.PROF_PIC_THUMB_SIDE)))).then((({images:t})=>({thumb:t.dataUrl,full:e})))}}render(){return r.default.createElement("div",{className:u.default.scaler},r.default.createElement("div",{className:u.default.scalerButton,onClick:()=>{this._onEnlarge()}},r.default.createElement(c.default,{name:"plus"})),r.default.createElement("div",{className:u.default.scalerButton,onClick:()=>{this._onReduce()}},r.default.createElement(c.default,{name:"minus"})))}componentDidMount(){this.props.editedMedia.saveEdits();var e,t=this.props.editedMedia.editData,a=this.props.cropOverlay,l=a.canvas;e=t.baseItem?t.baseItem.getBounds():{width:0,height:0},l.style.display="block",l.width=e.width,l.height=e.height;var s=new i.Easel.Shape;s.graphics.beginFill("rgba(0, 0, 0, 0.1)"),s.graphics.drawRect(0,0,e.width,e.height),s.regX=e.width/2,s.regY=e.height/2,s.x=e.width/2,s.y=e.height/2,s.on("mousedown",(e=>{var t={x:e.stageX,y:e.stageY},a=s.on("pressmove",this._onPressMove,null,!1,t);s.on("pressup",(()=>{s.off("pressmove",a)}),null,!0)})),s.cursor="move",this.props.listeners.add(l,"mousewheel",(e=>{e.deltaY>0?this._onEnlarge(1.02):this._onReduce(1.02)}));var r=l.getContext("2d"),n=l.width,o=l.height,d=n/o>500/361?o/361:n/500;this._cropRadius=Math.min(361,500)/2*.9*d,r.fillStyle="rgba(0, 0, 0, 0.5)",r.fillRect(0,0,n,o),r.globalCompositeOperation="destination-out",r.beginPath(),r.arc(n/2,o/2,this._cropRadius,0,2*Math.PI,!0),r.fillStyle="#ffffff",r.fill(),a.addChild(s),a.update()}}h.displayName="ProfileCropTool";var p=(0,d.default)(h);t.default=class extends p{crop(){return this.getComponent().crop()}}},3910:(e,t,a)=>{"use strict";var l=a(95318),s=a(20862);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(a(67294)),r=l(a(84978)),n=l(a(97420)),o=l(a(58743)),d=l(a(46274)),u=l(a(66761)),c=a(13960),f=s(a(66375)),h=a(51508),p=a(28113),m=l(a(5148)),v=l(a(17363)),g=l(a(51231));class E extends i.Component{constructor(e){super(e),this._labelModel=null,this.onOk=()=>{var{labelName:e,labelColor:t,labelNameError:a}=this.state;if(!a){(0,h.logLabelOperationEvent)(m.default.LABEL_OPERATIONS.CLICK_POSITIVE,1,this.props.onAddLabel?m.default.LABEL_TARGETS.ADD_LABEL_DIALOG:m.default.LABEL_TARGETS.EDIT_LABEL_DIALOG);var l=e&&e.trim(),s=this._validateLabelName(l||"");s.passed?(this.props.labelId&&this.props.onUpdateLabel?this.props.onUpdateLabel({id:this.props.labelId,color:t,name:e},f.LABEL_PROPERTIES.NAME):this.props.onAddLabel&&this.props.onAddLabel(e||"",t),this.props.onCancel?this.props.onCancel():n.default.closeModal()):this.setState({labelNameError:s.error})}},this.onCancel=()=>{(0,h.logLabelOperationEvent)(m.default.LABEL_OPERATIONS.CLICK_NEGATIVE,1,this.props.onAddLabel?m.default.LABEL_TARGETS.ADD_LABEL_DIALOG:m.default.LABEL_TARGETS.EDIT_LABEL_DIALOG),this.props.onCancel?this.props.onCancel():n.default.closeModal()},this._onLabelNameChange=e=>{var t=this._validateLabelName(e);this.setState({labelName:e,labelNameError:t.passed?void 0:t.error})},this._validateLabelName=e=>{var t=!0,a=null;return e&&""!==e.trim()||(t=!1),this._labelModel&&this._labelModel.name===e||0===f.default.where({name:e}).length||(t=!1,a=u.default.t(217)),{passed:t,error:a}},this._handleKeyEnter=e=>{e.stopPropagation(),this.onOk()},this.props.labelId&&(this._labelModel=f.default.assertGet(this.props.labelId)),this.state={labelColor:this._labelModel&&this._labelModel.color||void 0,labelName:this._labelModel&&this._labelModel.name||"",labelNameError:void 0}}componentDidMount(){this.props.onAddLabel?(f.default.getNewLabelColor().then((e=>{this.setState({labelColor:e||d.default.DEFAULT_SMB__NEW_LABEL_COLOR})})),(0,h.logLabelOperationEvent)(m.default.LABEL_OPERATIONS.VIEW,1,m.default.LABEL_TARGETS.ADD_LABEL_DIALOG)):this.props.onUpdateLabel&&(0,h.logLabelOperationEvent)(m.default.LABEL_OPERATIONS.VIEW,1,m.default.LABEL_TARGETS.EDIT_LABEL_DIALOG)}render(){var e=!this._validateLabelName(this.state.labelName.trim()).passed;return i.default.createElement(o.default,{title:this.props.onUpdateLabel?u.default.t(644):u.default.t(220),okText:u.default.t(1826),onOK:this.onOk,okDisabled:e,onCancel:this.onCancel},i.default.createElement("div",{className:r.default.inputContainer},i.default.createElement("div",{className:r.default.label},this.state.labelColor?(0,p.renderLabelSvg)((0,c.intColorToHex)(this.state.labelColor)):i.default.createElement(v.default,{stroke:5,size:20})),i.default.createElement("div",{className:r.default.input},i.default.createElement(g.default,{a8n:"add-new-label-name-input",focusOnMount:!0,hideFloatingLabel:!0,showRemaining:!0,supportsEmoji:!0,value:this.state.labelName,error:this.state.labelNameError,maxLength:d.default.SMB_LABELS.MAX_LABEL_LENGTH,onChange:this._onLabelNameChange,onEnter:this._handleKeyEnter,placeholder:u.default.t(219)}))))}}t.default=E,E.displayName="AddOrEditLabelPopup"},75861:(e,t,a)=>{"use strict";var l=a(95318),s=a(20862);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(a(67294)),r=l(a(97420)),n=l(a(58743)),o=l(a(46274)),d=a(66274),u=l(a(91072)),c=l(a(66761)),f=a(58635),h=a(86989),p=a(116),m=a(45739),v=l(a(51231)),g=s(a(9931));class E extends i.PureComponent{constructor(...e){super(...e),this.state={isSubmitting:!1,submitted:!1,reason:""},this._onInputChange=e=>{this.setState({reason:e})},this._handleOk=()=>{var{product:e,sessionId:t}=this.props;(0,f.logAppealProductCatalogClick)(t),this.setState({isSubmitting:!0}),(0,h.appealProduct)(e.id.toString(),this.state.reason).then((()=>{e.canAppeal=!1,e.reviewStatus=p.PRODUCT_REVIEW_STATUS.PENDING,(0,f.logAppealProductCatalogSuccess)(t),this.setState({isSubmitting:!1,submitted:!0})})).catchType(d.ServerStatusCodeError,(e=>{r.default.openToast(i.default.createElement(g.default,{msg:c.default.t(438),id:(0,g.genId)("catalog_appeal_submission_failed")})),(0,f.logAppealProductCatalogFailed)(t,e.status),this.setState({isSubmitting:!1})}))},this._handleCancel=()=>{r.default.closeModal()}}render(){var{submitted:e,isSubmitting:t,reason:a}=this.state;return e?i.default.createElement(n.default,{title:c.default.t(1313),onOK:this._handleCancel},i.default.createElement(m.TextDiv,null,c.default.t(464))):i.default.createElement(n.default,{title:c.default.t(1313),onOK:this._handleOk,onCancel:this._handleCancel,okDisabled:t},i.default.createElement("form",null,i.default.createElement(v.default,{a8n:"confirm-popup-text-input",placeholder:c.default.t(915),onChange:this._onInputChange,value:a,maxLength:1e3}),i.default.createElement(u.default,{href:o.default.WA_COMMERCE_POLICY_URL},c.default.t(919))))}}t.default=E,E.displayName="AppealProductPopup"},73456:(e,t,a)=>{"use strict";var l=a(20862),s=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(a(94184)),r=l(a(67294)),n=a(23491),o=s(a(5771)),d=s(a(94546)),u=s(a(81316)),c=s(a(73808)),f=s(a(37777)),h=s(a(51669)),p=s(a(36839)),m=s(a(62066)),v=s(a(53318)),g=s(a(97420)),E=s(a(58743)),_=s(a(46274)),C=s(a(94123)),S=s(a(8053)),y=s(a(3395)),I=s(a(34727)),M=l(a(85002)),P=a(79736),L=l(a(92246)),T=a(51418),b=s(a(47312)),D=s(a(79766)),N=s(a(66761)),O=s(a(48878)),w=s(a(80941)),k=s(a(5148)),R=a(74088),A=s(a(52206)),x=s(a(92120)),F=s(a(86981)),U=s(a(17363)),B=s(a(62745)),H=l(a(9931)),G=s(a(77923)),{IMAGE:V,VIDEO:j,DOCUMENT:W,AUDIO:K}=_.default.MSG_TYPE,{PROCESSING:z}=n.ATTACH_MEDIA_STATE;class Y extends r.Component{static getDerivedStateFromProps(e,t){var a=e.mediaCollection.getActive(),l=e.initCaption&&e.initCaption.text,s=t.isInitCaptionUsed;return s||t.activeMedia||!l||!a||a.type!==V&&a.type!==j||(a.caption=l,s=!0),{prevActiveMedia:t.activeMedia,activeMedia:a,isInitCaptionUsed:s}}constructor(e){super(e),this._attachMediaRefMap=new Map,this.setRefContainer=e=>{this.refContainer=e},this.setRefInput=e=>{this.refInput=e},this._setAttachMediaRef=(e,t)=>{this._attachMediaRefMap.set(e,t)},this._onMediaProcessUpdate=()=>{var{mediaCollection:e}=this.props;if(e.canSend()){clearTimeout(this._mediaProcessTimer),this._mediaProcessTimer=null,this.setState({showLoadingState:!1});var{errorMsgs:t}=e.uiProcessMsgs(),a=e.getPreviewableMedias();t&&a.length>0&&g.default.openToast(r.default.createElement(H.default,{msg:t,id:(0,H.genId)()})),this.forceUpdate()}else this._mediaProcessTimer||(this._mediaProcessTimer=setTimeout((()=>{this._mediaProcessTimer=null,this.setState({showLoadingState:!0})}),500))},this._onFilesNotSupported=()=>{var e=this.props.mediaCollection.filter((e=>e.exception));e.length>0&&this.props.onFailedMedias(e)},this._showIgnoredToast=e=>{if(e>0){var t=N.default.t(1461,{number:e,_plural:e});g.default.openToast(r.default.createElement(H.default,{msg:t,id:(0,H.genId)()}))}},this.onDrop=e=>{this.state.isViewOnce||this.onFilePick(e)},this.onDragLeave=()=>{this.props.mediaCollection.length||this.props.onBack()},this.onDragChange=(e,t)=>{this.state.isViewOnce||(this.setState({isDragging:e}),e||t||this.props.mediaCollection.length||this.props.onBack())},this.onEnter=e=>{this.state.activeMedia&&(e.repeat||e.shiftKey||this.onSend())},this._onArrowLeft=e=>{if(this.state.activeMedia&&!e.repeat){var t=this.state.activeMedia&&!this.state.activeMedia.caption,a=this.refCaptionInput&&this.refCaptionInput.refInput;(t||a&&!a.isFocused()||a&&a.cursorIsAtStart())&&this.onPrev()}},this._onArrowRight=e=>{if(this.state.activeMedia&&!e.repeat){var t=this.state.activeMedia&&!this.state.activeMedia.caption,a=this.refCaptionInput&&this.refCaptionInput.refInput;(t||a&&!a.isFocused()||a&&a.cursorIsAtEnd())&&this.onNext()}},this.onNext=()=>{this.props.mediaCollection.setNextAsActive()&&(this._refSendButton&&b.default.focus(this._refSendButton),this._scrollIntoView())},this.onPrev=()=>{this.props.mediaCollection.setPrevAsActive()&&(this._refSendButton&&b.default.focus(this._refSendButton),this._scrollIntoView())},this._scrollIntoView=()=>{var e=this.props.mediaCollection.getActive();if(e){var t=this._attachMediaRefMap.get(e.id);t&&t.scrollIntoView()}},this.onSelectThumb=e=>{this.props.mediaCollection.setActive(e)},this.onSend=e=>{e&&e.preventDefault(),e&&e.shiftKey||this.props.mediaCollection.canSend()&&Promise.all([]).then((()=>{var e=this.props.mediaCollection.getPreviewableMedias();if(0!==e.length){var t=e.map((e=>{var t=e.caption,a=[],l=this.refCaptionInput&&this.refCaptionInput.refInput;if(t&&l){var s=l.serialize(t),[i,r]=[s[0].trim(),s[1]];i.length&&(t=i,a=r.mentionedJidList||[])}return e.caption=t||void 0,{media:e,mentionedJidList:a}}));this.props.onSendMedia(t,this.state.isInitCaptionUsed,this.state.isViewOnce)}}))},this.onAddFileClick=()=>{this.refInput&&this.refInput.click()},this.onFilePick=e=>{(0,P.getFiles)(e).then((e=>this.props.mediaCollection.processAttachments(e.map((e=>({file:e}))),k.default.MEDIA_PICKER_ORIGIN_TYPE.CHAT_PHOTO_LIBRARY))).checkpoint(this.props.rejectOnUnmount()).catchType(L.Unmount,(()=>{})).catchType(L.MediaDragDropError,(e=>{this.props.mediaCollection.length||this.props.onDropText(e.src)})),e.target&&e.target.value&&(e.target.value="")},this._onRemoveThumb=(e,t)=>{t.stopPropagation(),t.preventDefault(),this.props.mediaCollection.remove(e),0===this.props.mediaCollection.getValidMedias().length?this._delayedClose=setTimeout((()=>{this.props.onBack()}),200):this._refSendButton&&b.default.focus(this._refSendButton)},this.onCaptionChange=e=>{var{activeMedia:t,isInitCaptionUsed:a}=this.state;if(t){var l=this.props.mediaCollection.indexOf(t);t.caption=e,0===l&&""===e&&a?this.setState({isInitCaptionUsed:!1}):this.forceUpdate()}},this.onPaste=e=>{e.preventDefault(),e.stopPropagation();var t=new C.default(e.clipboardData);t.hasFiles()&&this.onFiles(t)},this.onFiles=e=>{var t=e.getFiles().filter((e=>{var t=(0,T.typeFromMimetype)(e.type);return"image"===t||"video"===t})).map((e=>({file:e})));this.props.mediaCollection.processAttachments(t,k.default.MEDIA_PICKER_ORIGIN_TYPE.PASTE)},this._onViewOnceChange=e=>{this.setState({isViewOnce:e})},this.setRefCaptionInput=e=>{this.state.activeMedia&&!e||(this.refCaptionInput=e)},this._canViewOnce=()=>{var e,{mediaCollection:t}=this.props;return F.default.viewOnceWrite&&1===t.length&&!0===(null===(e=t.at(0))||void 0===e?void 0:e.isViewableOnce())},this._getMedia=e=>{var t,a,l;switch(e.type){case V:case j:t||(t=r.default.createElement(h.default,{mimeType:e.mimetype,url:e.fullPreview,isGif:e.isGif,size:e.fullPreviewSize,processing:e.state===z,preview:e.preview})),a=r.default.createElement("div",{className:o.default.captionInput,"data-animate-media-caption":!0},r.default.createElement(w.default,{ref:this.setRefCaptionInput,value:e.caption,placeholder:N.default.t(206),maxLength:_.default.MAX_CAPTION_LENGTH,onEnter:this.onSend,onChange:this.onCaptionChange,onFiles:this.onFiles,chat:this.props.chat,showRemaining:!0,spellCheck:!0,multiline:!0,supportsEmoji:!0}),F.default.viewOnceWrite?r.default.createElement(m.default,{disabled:!this._canViewOnce(),isOn:this.state.isViewOnce,mediaType:e.type,onChange:this._onViewOnceChange}):null);break;case K:t=r.default.createElement(u.default,{mimeType:e.mimetype,url:e.fullPreview});break;case W:switch((0,R.previewType)(e.mimetype)){case"pdf":t=r.default.createElement(p.default,{fullPreview:e.fullPreview,fullPreviewSize:e.fullPreviewSize,pageCount:e.documentPageCount,mimeType:e.mimetype,filename:e.filename});break;case"msoffice":t=r.default.createElement(c.default,{fullPreview:e.fullPreview,fullPreviewSize:e.fullPreviewSize,mimeType:e.mimetype,filename:e.filename});break;default:t=r.default.createElement(f.default,{mimeType:e.mimetype,filename:e.filename})}}return"image/gif"===e.originalMimetype&&(l=r.default.createElement("div",{className:o.default.mediaWarning,"data-animate-attach-media":!0},N.default.t(1007)," ",r.default.createElement(v.default,{onClick:this._onWarningCtaClick},N.default.t(919)))),r.default.createElement("div",{className:o.default.mediaBody,key:e.id},t,l,a)},this._onWarningCtaClick=e=>{e.preventDefault(),g.default.openModal(r.default.createElement(E.default,{onOK:()=>g.default.closeModal()},N.default.t(771)))},this.getThumbs=e=>e.map((e=>r.default.createElement(d.default,{id:e.id,key:"media-"+e.id,active:e===this.state.activeMedia,attachMedia:e,onClick:this.onSelectThumb,onClose:this._onRemoveThumb,onRef:this._setAttachMediaRef}))),this._setRefSendButton=e=>{this._refSendButton=e},this.state={activeMedia:null,prevActiveMedia:null,isDragging:!1,isInitCaptionUsed:!1,isViewOnce:!1,showLoadingState:!1}}componentDidMount(){var{mediaCollection:e,listeners:t}=this.props;t.add(e,"add remove reset",(()=>{this.forceUpdate()})),t.add(e,"active-change change:state change:previewable",this._onMediaProcessUpdate),t.add(e,"files_not_supported",this._onFilesNotSupported),t.add(e,"max_upload_limit",this._showIgnoredToast),e.mediaPickerStatsLogger.resumeTimer()}componentDidUpdate(e,t){!t.activeMedia&&this.state.activeMedia&&this.refCaptionInput?this.props.listeners.uiIdle((()=>{this.refCaptionInput&&this.refCaptionInput.restoreFocus()})):this._refSendButton&&this.refContainer&&!this.refContainer.contains(document.activeElement)&&b.default.focus(this._refSendButton)}componentWillUnmount(){this._delayedClose&&clearTimeout(this._delayedClose),this._mediaProcessTimer&&clearTimeout(this._mediaProcessTimer),this.props.mediaCollection.mediaPickerStatsLogger.pauseTimer()}render(){var e,t,a,{mediaCollection:l}=this.props,{activeMedia:s,prevActiveMedia:n}=this.state,d=0,u=l.getPreviewableMedias();u.length>_.default.MAX_FILES&&(u=u.slice(0,_.default.MAX_FILES)),this.state.showLoadingState?e=r.default.createElement(U.default,{key:"processing",color:"highlight"}):s?e=this._getMedia(s):0===u.length&&l.errorMsgs&&(e=r.default.createElement("div",{className:o.default.invalidContainer,key:"pending"},r.default.createElement("div",{className:o.default.invalidMedia},l.errorMsgs))),u.length>0&&(t=this.getThumbs(u),d=1===u.length?400:400+(150+15*u.length),a=this.state.showLoadingState?null:r.default.createElement("div",{className:o.default.btnSend,tabIndex:"-1",ref:this._setRefSendButton,onKeyPress:e=>e.preventDefault()},r.default.createElement(x.default,{large:!0,onClick:this.onSend},r.default.createElement(B.default,{name:"send",directional:!0}))));var c=this.state.isDragging?r.default.createElement(S.default,null):null,f=u.length<_.default.MAX_FILES?r.default.createElement("div",{className:(0,i.default)(o.default.btnAdd,{[o.default.btnAddDisabled]:this.state.isViewOnce}),key:"media-more",onClick:this.state.isViewOnce?void 0:this.onAddFileClick,role:"button"},r.default.createElement(B.default,{name:"add-alt"}),r.default.createElement("div",{className:o.default.btnAddText},N.default.t(212))):null,h={enter:this.onEnter,left:this._onArrowLeft,right:this._onArrowRight},p="*"===R.DOC_MIMES?"*":[_.default.IMAGE_MIMES,_.default.VIDEO_MIMES,R.DOC_MIMES].join(),m="media-scale";return s&&n&&s!==n&&(m=l.indexOf(s)>l.indexOf(n)?"media-slide-forward":"media-slide-back"),r.default.createElement(D.default,{handlers:h,onRef:this.setRefContainer},r.default.createElement(y.default,{key:"attach-image-modal",theme:"media",onDrop:this.onDrop,onDragChange:this.onDragChange},r.default.createElement(M.default,{title:N.default.t(1877),type:M.DRAWER_HEADER_TYPE.OFFSET,onCancel:this.props.onBack}),r.default.createElement(I.default,{tabIndex:"-1",overflow:"hidden",onPaste:this.onPaste},c,r.default.createElement("div",{className:o.default.body},r.default.createElement(G.default,{transitionName:m},e)),r.default.createElement("div",{className:o.default.thumbs},r.default.createElement(G.default,{transitionAppear:!0,transitionName:"thumb-scale",className:o.default.thumbsContainer},t),f),r.default.createElement(G.default,{transitionAppear:!0,transitionName:"btn",delay:d},a),r.default.createElement("input",{ref:this.setRefInput,type:"file",accept:p,style:{display:"none"},onChange:this.onFilePick,multiple:!0}))))}}Y.displayName="AttachMediaDrawer";var q=(0,A.default)((0,O.default)(Y));t.default=q},94546:(e,t,a)=>{"use strict";var l=a(20862),s=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(a(35937)),r=s(a(94184)),n=l(a(67294)),o=s(a(54892)),d=s(a(46274)),u=a(74088),c=s(a(82286)),f=a(79665),h=s(a(62745)),{IMAGE:p,VIDEO:m,DOCUMENT:v,AUDIO:g}=d.default.MSG_TYPE,E=(0,i.default)(u.MIMETYPES,(e=>e.msgType===v));class _ extends n.PureComponent{constructor(...e){super(...e),this._onClick=e=>{this.props.onClick&&this.props.onClick((0,f.unproxy)(this.props.attachMedia),e)},this._onClose=e=>{this.props.onClose&&this.props.onClose((0,f.unproxy)(this.props.attachMedia),e)},this.setRef=e=>{e&&this.props.onRef(this.props.id,e)}}_renderBody(){var e,t,a,l=this.props.attachMedia;switch(l.type){case p:a={backgroundImage:`url(${l.preview})`},e=n.default.createElement("div",{className:o.default.body,style:a});break;case m:a={backgroundImage:`url(data:image/jpeg;base64,${l.preview})`},e=n.default.createElement("div",{className:o.default.body,style:a});break;case g:e=n.default.createElement("div",{className:(0,r.default)(o.default.body,"attach-media-audio-thumb")});break;case v:if(__LOG__(2)`media is`,l.preview){var s={backgroundImage:"url("+l.preview+")"};e=n.default.createElement("div",{className:o.default.body,style:s});break}E[l.mimetype]&&(t=E[l.mimetype].icon);default:t=(0,r.default)(o.default.body,o.default.bodyDoc,t,{"icon-doc-generic":!t}),e=n.default.createElement("div",{className:t})}return e}render(){var e=(0,r.default)(o.default.thumb,{[o.default.active]:this.props.active});return n.default.createElement("div",{className:e,onClick:this._onClick,role:"button",ref:this.setRef},n.default.createElement("div",{className:o.default.btnDelete,onClick:this._onClose,role:"button"},n.default.createElement(h.default,{name:"x-alt"})),this._renderBody())}}_.CONCERNS={attachMedia:["mimetype","preview","type"]},_.displayName="AttachMediaThumb";var C=(0,c.default)(_,_.CONCERNS);t.default=C},81316:(e,t,a)=>{"use strict";var l=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function({mimeType:e,url:t}){return s.default.createElement("div",{className:i.default.container,"data-animate-attach-media":!0},s.default.createElement("div",{className:i.default.media},s.default.createElement("audio",{controls:!0,type:e,src:t})))};var s=l(a(67294)),i=l(a(46771))},73808:(e,t,a)=>{"use strict";var l=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function({fullPreview:e,fullPreviewSize:t,mimeType:a,filename:l}){return e&&t?s.default.createElement("div",{className:i.default.container,"data-animate-attach-media":!0},s.default.createElement("div",{className:i.default.preview},s.default.createElement(o.default,{type:"scaleDown",size:t},s.default.createElement("img",{alt:n.default.t(1877),src:e,className:i.default.img})))):s.default.createElement(r.default,{mimeType:a,filename:l})};var s=l(a(67294)),i=l(a(72763)),r=l(a(37777)),n=l(a(66761)),o=l(a(53852))},37777:(e,t,a)=>{"use strict";var l=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function({mimeType:e,filename:t}){var a=(0,i.default)(n.default.icon,d[e]?d[e].icon:"icon-doc-generic");return r.default.createElement("div",{className:n.default.container,"data-animate-attach-media":!0},r.default.createElement("div",{className:n.default.media},r.default.createElement("div",{className:n.default.document},r.default.createElement("div",{className:a}),r.default.createElement("div",{className:n.default.text},t))))};var s=l(a(35937)),i=l(a(94184)),r=l(a(67294)),n=l(a(56342)),o=a(74088),d=(0,s.default)(o.MIMETYPES,(e=>"document"===e.msgType))},51669:(e,t,a)=>{"use strict";var l=a(20862),s=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function({mimeType:e,url:t,isGif:a,size:l,processing:s,preview:r}){var c;switch(m[e].msgType){case"image":c=o.default.createElement("img",{alt:u.default.t(1877),src:t,className:d.default.img});break;case"video":var v=a?{loop:!s,autoPlay:!s,muted:!1,controls:!1}:{},g=s?o.default.createElement("div",{className:d.default.spinner},o.default.createElement(h.default,{color:h.colorOptions.white,size:50,stroke:3})):null,E=r?o.default.createElement("img",{alt:u.default.t(1877),className:d.default.staticPreview,src:`data:image/jpeg;base64,${r}`}):null,_=s?null:o.default.createElement(p.default,(0,i.default)({controls:!0,controlsList:"nodownload nofullscreen",className:d.default.video},v,{src:t}));c=o.default.createElement("div",{className:(0,n.default)(d.default.img,d.default.videoContainer)},g,_,E);break;case"audio":c=o.default.createElement("audio",{controls:!0,className:d.default.audio,type:e,src:t})}return o.default.createElement("div",{className:d.default.container,"data-animate-attach-media":!0},o.default.createElement("div",{className:d.default.media},o.default.createElement(f.default,{type:"scaleDown",size:l},c)))};var i=s(a(67154)),r=s(a(35937)),n=s(a(94184)),o=s(a(67294)),d=s(a(13149)),u=s(a(66761)),c=a(74088),f=s(a(53852)),h=l(a(17363)),p=s(a(28149)),m=(0,r.default)(c.MIMETYPES,(e=>"image"===e.msgType||"video"===e.msgType))},36839:(e,t,a)=>{"use strict";var l=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function({fullPreview:e,fullPreviewSize:t,pageCount:a,mimeType:l,filename:u,showPageCount:c=!0,showBorder:f=!1}){if(e&&t&&null!=a&&a>0){var h=o.default.t(243,{count:a,_plural:a});return i.default.createElement("div",{className:n.default.container,"data-js-attach-preview":!0},i.default.createElement("div",{className:n.default.preview},i.default.createElement(d.default,{type:"scaleDown",size:t},i.default.createElement("img",{alt:o.default.t(1877),src:e,className:(0,s.default)(n.default.img,{[n.default.imgBorder]:f})}))),c&&i.default.createElement("div",{className:n.default.caption},h))}return i.default.createElement(r.default,{mimeType:l,filename:u})};var s=l(a(94184)),i=l(a(67294)),r=l(a(37777)),n=l(a(28469)),o=l(a(66761)),d=l(a(53852))},62066:(e,t,a)=>{"use strict";var l=a(20862),s=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function({disabled:e,isOn:t,mediaType:a,onChange:l,noMargin:s}){var[E,_]=(0,r.useState)((0,f.shouldShowNUX)(c.default.NUX.EPHEMERAL_VIEW_ONCE));return(0,r.useEffect)((()=>{if(t){if(!E){var e=a===p.TYPE.VIDEO?h.default.t(1537):h.default.t(1534),l=r.default.createElement(v.default,{msg:e,id:(0,v.genId)("view-once-toast")});return u.default.openToast(l),()=>{u.default.closeToast(l)}}var s=r.default.createElement(d.default,{onOkClick:()=>{_(!1),u.default.closeModal()}});u.default.openModal(s)}}),[E,a,t]),r.default.createElement(g.default,{a8nText:n.default.key("view-once-toggle"),className:(0,i.default)(o.default.btnViewOnce,{[o.default.noMargin]:s,[o.default.disabled]:e}),disabled:e,onClick:()=>l(!t),"aria-pressed":t},r.default.createElement(m.default,{"aria-label":t?h.default.t(37):h.default.t(38),name:t?"view-once-media-select-on":"view-once-media-select"}))};var i=s(a(94184)),r=l(a(67294)),n=s(a(62067)),o=s(a(74481)),d=s(a(13520)),u=s(a(97420)),c=s(a(46274)),f=a(56726),h=s(a(66761)),p=a(94490),m=s(a(62745)),v=l(a(9931)),g=s(a(87120))},13520:(e,t,a)=>{"use strict";var l=a(95318),s=a(20862);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,i.useEffect)((()=>()=>{(0,f.setNUX)(o.default.NUX.EPHEMERAL_VIEW_ONCE,{views:1,maxViews:1})}),[]),i.default.createElement(n.default,{onOK:e.onOkClick,cancelText:h.default.t(919),onCancel:()=>{(0,d.openExternalLink)((0,u.getViewOnceFaqUrl)())}},i.default.createElement(c.FlexColumn,null,i.default.createElement(c.FlexItem,{className:r.default.graphic,align:"center"},i.default.createElement(p.default,{name:"view-once-sender-nux"})),i.default.createElement(m.TextHeader,{className:r.default.text,theme:"popup-title"},h.default.t(1532)),i.default.createElement(m.TextParagraph,{className:r.default.text,color:"secondary"},h.default.t(1531))))};var i=s(a(67294)),r=l(a(29669)),n=l(a(58743)),o=l(a(46274)),d=a(91072),u=a(78572),c=a(67052),f=a(56726),h=l(a(66761)),p=l(a(62745)),m=a(45739)},69439:(e,t,a)=>{"use strict";var l=a(95318),s=a(20862);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){var[e,t]=(0,i.useState)(r.getAutoDownloadPhotos),[a,l]=(0,i.useState)(r.getAutoDownloadAudio),[s,u]=(0,i.useState)(r.getAutoDownloadVideos),[c,f]=(0,i.useState)(r.getAutoDownloadDocuments);return i.default.createElement(o.default,null,i.default.createElement(o.SettingsCheckListItem,{a8nText:"option-photos",id:"photos",checked:e,onChange:()=>t((e=>{var t=!e;return(0,r.setAutoDownloadPhotos)(t),t}))},n.default.t(1208)),i.default.createElement(o.SettingsCheckListItem,{a8nText:"option-audio",id:"audio",checked:a,onChange:()=>l((e=>{var t=!e;return(0,r.setAutoDownloadAudio)(t),t}))},n.default.t(1200)),i.default.createElement(o.SettingsCheckListItem,{a8nText:"option-videos",id:"videos",checked:s,onChange:()=>u((e=>{var t=!e;return(0,r.setAutoDownloadVideos)(t),t}))},n.default.t(1210)),i.default.createElement(o.SettingsCheckListItem,{a8nText:"option-documents",id:"documents",checked:c,onChange:()=>f((e=>{var t=!e;return(0,r.setAutoDownloadDocuments)(t),t}))},n.default.t(1203)),i.default.createElement(o.SettingsCheckListSection,null,i.default.createElement(d.TextDiv,{theme:"muted"},n.default.t(983))))};var i=s(a(67294)),r=a(56726),n=l(a(66761)),o=s(a(50822)),d=a(45739)},35576:(e,t,a)=>{"use strict";var l=a(20862),s=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(a(51463)),r=l(a(67294)),n=s(a(62067)),o=a(87577),d=s(a(53939)),u=s(a(20333)),c=s(a(97420)),f=s(a(58743)),h=s(a(84051)),p=s(a(69107)),m=s(a(49890)),v=s(a(3395)),g=s(a(34727)),E=s(a(61376)),_=l(a(85002)),C=a(4404),S=s(a(47060)),y=s(a(3152)),I=s(a(12063)),M=s(a(66761)),P=s(a(48878)),L=s(a(62745));class T extends r.Component{constructor(...e){super(...e),this.flatListController=new I.default,this._onBlockConfirm=e=>{(0,o.blockContact)(e).catch((()=>{})),c.default.closeModal()},this.onBlock=()=>{c.default.openModal(r.default.createElement(m.default,{title:M.default.t(209),filter:function(e){return!!p.default.isFilteredContact(e)&&(!u.default.get(e.id)||M.default.t(1225))},onCancel:()=>c.default.closeModal(),onSelect:(0,i.default)(this._onBlockConfirm)}))},this._onUnblockConfirm=e=>{(0,o.unblockContact)(e).catch((()=>{})),c.default.closeModal()},this._onUnblockCancel=()=>{c.default.closeModal()},this._onUnblock=(e,t)=>{c.default.openModal(r.default.createElement(f.default,{okText:M.default.t(1468),onOK:this._onUnblockConfirm.bind(this,t),cancelText:M.default.t(1657),onCancel:this._onUnblockCancel},M.default.t(1469,{contact:t.formattedName})))},this.renderItem=e=>{var{blocklist:t}=e,a=t.contact();return r.default.createElement(h.default,{contact:a,key:a.id.toString(),onClick:this._onUnblock,onDelete:this._onUnblock,waitIdle:!0})}}componentDidMount(){this.props.listeners.add(u.default,"add remove",(()=>{this.forceUpdate()}))}getData(){return u.default.map((e=>({itemKey:e.id.toString(),blocklist:e})))}render(){var e,t;return u.default.length>0?(e=r.default.createElement(y.default,{flatListControllers:[this.flatListController],className:d.default.list},r.default.createElement(S.default,{flatListController:this.flatListController,direction:"vertical",data:this.getData(),renderItem:this.renderItem})),t=r.default.createElement("div",{"data-a8n":n.default.key("blocked-description"),className:d.default.hint},M.default.t(208))):e=r.default.createElement(C.Blocked,null),r.default.createElement(v.default,null,r.default.createElement(_.default,{title:M.default.t(287),onBack:this.props.onClose,type:_.DRAWER_HEADER_TYPE.LARGE}),r.default.createElement("div",{className:d.default.button},r.default.createElement(E.default,{a8nText:"li-add-blocked",onClick:this.onBlock,icon:r.default.createElement(L.default,{name:"add-user",directional:!0})},M.default.t(209))),r.default.createElement(g.default,null,e,t))}}T.displayName="BlockedDrawer";var b=(0,P.default)(T);t.default=b},73136:(e,t,a)=>{"use strict";var l=a(20862),s=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(a(94184)),r=a(20014),n=l(a(67294)),o=s(a(62066)),d=s(a(55386)),u=s(a(97420)),c=s(a(46274)),f=s(a(3395)),h=s(a(34727)),p=l(a(85002)),m=l(a(92246)),v=l(a(15178)),g=l(a(28518)),E=s(a(66761)),_=s(a(9626)),C=s(a(80941)),S=l(a(8336)),y=s(a(5148)),I=s(a(53852)),M=s(a(97962)),P=s(a(52206)),L=s(a(92120)),T=s(a(86981)),b=s(a(17363)),D=s(a(62745)),N=s(a(53918)),O=s(a(77923)),w=s(a(28149)),k="ANIMATING",R="LOADING",A="RECORDING",x="SENDING";class F extends n.PureComponent{constructor(...e){super(...e),this.state={caption:void 0,img:void 0,isViewOnce:!1,state:k,stream:void 0,videoSize:void 0},this._refVideo=(0,n.createRef)(),this._startTimer=new r.ShiftTimer((({stream:e,disposeStream:t})=>{this.loadNewStream(e,t)})),this.loadNewStreamTimerUpdate=(e,t)=>{this._startTimer.forceRunNow({stream:e,disposeStream:t})},this.loadNewStream=(e,t)=>{var a;e?(null===(a=this._disposeStream)||void 0===a||a.call(this),this._disposeStream=t,this.setState({state:R,stream:e}),(0,S.isSrcObjectInVideoElement)()||(e?(window.URL.revokeObjectURL(this.url),this.url=window.URL.createObjectURL(e)):(window.URL.revokeObjectURL(this.url),this.url=void 0))):this.state.state===k&&this.setState({state:R})},this._stopStreamTimer=new r.ShiftTimer((({stream:e,disposeStream:t})=>{e&&t&&t(),(0,S.isSrcObjectInVideoElement)()||(this.url=window.URL.revokeObjectURL(this.url))})),this.onCapture=()=>{var e,t=null===(e=this._refVideo.current)||void 0===e?void 0:e.underlyingVideo();if(t){var{chat:a}=this.props,l=document.createElement("canvas");l.height=t.videoHeight,l.width=t.videoWidth;var s=l.getContext("2d");if(s){s.translate(l.width,0),s.scale(-1,1),s.drawImage(t,0,0,t.videoWidth,t.videoHeight);var i=this.props.onCaptured;if(i)g.canvasToBlob(l).then((e=>{i(e)}));else{this._stopStreamTimer.onOrBefore(500,{stream:this.state.stream,disposeStream:this._disposeStream}),this._mediaLogger=new _.default,this._mediaLogger.logAdd("CAPTURE_MEDIA","image",y.default.MEDIA_PICKER_ORIGIN_TYPE.MENU_CAMERA_CAPTURE),this._mediaLogger.chatRecipients=a&&a.groupMetadata?a.groupMetadata.participants.length:1;var r=l.toDataURL("image/jpeg");window.dataURLtoBlob(r),this.setState({state:x,stream:void 0,img:r})}}else __LOG__(3)`CaptureDrawer:onCapture can not get 2d context`}},this.onVideoLoaded=e=>{this.setState({state:A,videoSize:{width:e.videoWidth,height:e.videoHeight}})},this.onRetake=()=>{this.setState({state:R,caption:void 0});var{asyncStream:e,disposeStream:t}=S.start("camera");this._disposeStream=t,e.then((e=>{e&&((0,S.isSrcObjectInVideoElement)()||(this.url=window.URL.createObjectURL(e)),this.setState({stream:e}))})).catchType(m.GUM.NotAllowedError,(()=>{this.props.onBack(),u.default.openModal(n.default.createElement(v.default,{messaging:v.Messaging.CAMERA_FAIL,type:v.default.TYPE.GUIDE_UNBLOCK}))})).catchType(m.GUM.GUMError,(()=>{this.props.onBack(),u.default.openModal(n.default.createElement(v.default,{messaging:v.Messaging.CAMERA_MISSING,type:v.default.TYPE.GUIDE_NONE}))}))},this.onSend=()=>{var{img:e,caption:t}=this.state,a=this.props.onSend;if(a)if(e){var l=this.refCaptionInput&&this.refCaptionInput.refInput,s=[];if(t&&l){var i=l.serialize(t),[r,n]=[i[0].trim(),i[1]];r.length&&(t=r,s=n.mentionedJidList||[])}a({caption:t,getImg:M.default.createFromBase64Jpeg(N.default.parseDataURL(e).data),isViewOnce:this.state.isViewOnce,mentionedJidList:s}),this._mediaLogger.logSend()}else __LOG__(4,void 0,new Error,!0)`Assertion failed!`,SEND_LOGS("capture-drawer-no-img");else __LOG__(4,void 0,new Error,!0)`Assertion failed!`,SEND_LOGS("capture-drawer-no-onSend")},this.onCaptionChange=e=>{this.setState({caption:e})},this._canViewOnce=()=>T.default.viewOnceWrite,this._onViewOnceChange=e=>{this.setState({isViewOnce:e})},this.setRefCaptionInput=e=>{this.refCaptionInput=e}}componentDidMount(){this._startTimer.onOrBefore(300,{stream:this.props.stream,disposeStream:this.props.disposeStream})}componentWillUnmount(){var e;this._startTimer.cancel(),this.url&&window.URL.revokeObjectURL(this.url),null===(e=this._disposeStream)||void 0===e||e.call(this),this._mediaLogger&&this._mediaLogger.logCancel()}render(){var e,t,a,l,s,r="capture-cover"===this.props.theme?"cover":"contain";switch(this.state.state){case k:case R:if(s=n.default.createElement(b.default,{stroke:4,size:50}),this.state.state===k)break;case A:var u=(0,i.default)(d.default.video,{[d.default.videoInactive]:this.state.stream&&this.state.state===R}),m=this.state.stream?n.default.createElement(w.default,{autoPlay:!0,ref:this._refVideo,onPlay:this.onVideoLoaded,src:this.url?this.url:void 0,srcObject:this.url?void 0:this.state.stream}):null;a=this.state.stream?n.default.createElement("div",{key:"webcam"},n.default.createElement(I.default,{type:r,size:this.state.videoSize},n.default.createElement("div",{className:u,"data-animage-capture-webcam":!0},m))):null,e=this.state.state===A?n.default.createElement("div",{className:d.default.btn,key:"btn-capture"},n.default.createElement(L.default,{large:!0,onClick:this.onCapture},n.default.createElement(D.default,{name:"camera"}))):null;break;case x:a=n.default.createElement(I.default,{type:r,size:this.state.videoSize},n.default.createElement("img",{alt:"",className:d.default.image,"data-animate-capture-snapshot":!0,src:this.state.img})),e=n.default.createElement("div",{className:(0,i.default)(d.default.btn,d.default.btnSend),key:"btn-send"},n.default.createElement(L.default,{large:!0,onClick:this.onSend},n.default.createElement(D.default,{name:"send",directional:!0}))),t=n.default.createElement("div",{className:d.default.retakeBtn,onClick:this.onRetake},n.default.createElement("div",{className:d.default.retakeIcon},n.default.createElement(D.default,{name:"return"})),E.default.t(1315)),l=this.props.chat?n.default.createElement("div",{className:d.default.captionInput},n.default.createElement(C.default,{ref:this.setRefCaptionInput,chat:this.props.chat,maxLength:c.default.MAX_CAPTION_LENGTH,multiline:!0,onEnter:this.onSend,onChange:this.onCaptionChange,placeholder:E.default.t(206),showRemaining:!0,spellCheck:!0,supportsEmoji:!0,value:this.state.caption}),T.default.viewOnceWrite?n.default.createElement(o.default,{disabled:!this._canViewOnce(),isOn:this.state.isViewOnce,mediaType:"image",onChange:this._onViewOnceChange}):null):null;break;default:__LOG__(2)`captureDrawer:render Unhandled video capture state ${this.state.state}`}var v=this.props.caption?n.default.createElement(O.default,{transitionName:"media-caption",className:d.default.caption},l):null,g=n.default.createElement("div",{className:d.default.footer},v,n.default.createElement(O.default,{transitionName:"pop_delay"},e));return n.default.createElement(f.default,{key:"attach-capture-modal",theme:this.props.theme},n.default.createElement(p.default,{title:E.default.t(1448),type:p.DRAWER_HEADER_TYPE.OFFSET,onCancel:this.props.onBack},t),n.default.createElement(h.default,{overflow:"hidden"},n.default.createElement("div",{className:d.default.container},s,n.default.createElement("div",{className:d.default.body},n.default.createElement(O.default,{transitionName:"capture",className:d.default.videoContainer},a))),g))}}F.defaultProps={caption:!1},F.displayName="CaptureDrawer";var U=(0,P.default)(F);t.default=class extends U{constructor(...e){super(...e),this.loadNewStream=(e,t)=>{this.getComponent().loadNewStreamTimerUpdate(e,t)}}}},55839:(e,t,a)=>{"use strict";var l=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return i.default.createElement("div",{className:(0,s.default)(n.default.container)},i.default.createElement(o.FlexRow,{align:"start",justify:"start",wrap:"wrap"},e.categories.map((t=>i.default.createElement(r.default,{"aria-label":d.default.t(35),key:t.id.toString(),className:n.default.chip,onClick:()=>e.onRemoveItem(t.id),label:t.localized_display_name,postfixIcon:"round-x-inv"})))))};var s=l(a(94184)),i=l(a(67294)),r=l(a(10618)),n=l(a(43770)),o=a(67052),d=l(a(66761))},79099:(e,t,a)=>{"use strict";var l=a(95318),s=a(20862);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(a(67294)),r=l(a(6699)),n=l(a(79274)),o=l(a(69107)),d=l(a(71889)),u=l(a(51885)),c=l(a(3395)),f=l(a(34727)),h=s(a(85002)),p=a(4404),m=l(a(12063)),v=l(a(23418)),g=l(a(47312)),E=l(a(79766)),_=l(a(66761)),C=l(a(89329)),S=l(a(1398)),y=l(a(51432)),I=l(a(62745)),M=l(a(96783)),P=(0,i.forwardRef)(((e,t)=>{var{title:a,onBack:l,onClick:s,onNewGroup:P}=e,[L,T]=(0,i.useState)(""),b=(0,i.useRef)(),D=(0,i.useRef)(),N=(0,i.useRef)(),O=(0,i.useMemo)((()=>o.default.frequentContacts("message")),[o.default.length]),w=Boolean(L),k=(0,i.useMemo)((()=>w?[]:O),[w,O]),[R]=(0,i.useState)((()=>new m.default)),A=(0,i.useCallback)((e=>{o.default.ensureSorted();var t="string"==typeof e?e:L;if(!t)return o.default.getFilteredContacts();var a=o.default.getFilteredContacts().concat(o.default.filter((e=>e.name&&!e.isMe&&!e.isPSA&&!e.isWAContact))),l=_.default.accentFold(t),s=(0,S.default)(l);return a.filter((function(e){return e.searchMatch(l,s)}))}),[L]);(0,i.useEffect)((()=>{g.default.focus(b.current)}),[]);var x,F,U=(0,i.useCallback)((()=>{v.default.shouldIndicateFocus(),g.default.focus(b.current)}),[]),B=(0,i.useCallback)((e=>{var t=D.current;null!=t&&(e.preventDefault(),e.stopPropagation(),v.default.shouldIndicateFocus(),t.focusFirst())}),[]),H=(0,M.default)((e=>T(e)),100),G=(0,i.useCallback)((e=>{N.current=e,H(e)}),[H]),V=(0,i.useCallback)((e=>{e.preventDefault(),e.stopPropagation();var t=k[0];if(t)return v.default.shouldIndicateFocus(),void s(e,t);var a=A(N.current)[0];a&&(v.default.shouldIndicateFocus(),s(e,a))}),[s,A,k]),j=A();if(x=0===j.length?L?(0,p.SearchWithKeyword)(L):(0,p.SearchWithoutKeyword)():i.default.createElement(u.default,{ref:D,contacts:j,flatListController:R,frequentContacts:k,onClick:s,onFocusSearch:U,showPersonGroupDivisionHeader:!!L}),!L){var W=i.default.createElement(y.default,null,i.default.createElement(I.default,{name:"new-group",directional:!0}));F=i.default.createElement("div",{"data-list-scroll-offset":!0},i.default.createElement("div",{className:d.default.newGroupButton},i.default.createElement(n.default,{image:W,primary:_.default.t(1805),onClick:P}),i.default.createElement(r.default,null)))}return i.default.createElement(c.default,{ref:t,key:"contact-modal"},i.default.createElement(h.default,{title:a,type:h.DRAWER_HEADER_TYPE.LARGE,onBack:l}),i.default.createElement(E.default,{handlers:{down:B}},i.default.createElement(C.default,{ref:b,onSearch:G,onEnter:V,placeholder:_.default.t(1329)})),i.default.createElement(f.default,{flatListControllers:[R]},F,x))}));t.default=P},14109:(e,t,a)=>{"use strict";var l=a(95318),s=a(20862);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(a(67294)),r=l(a(28383)),n=l(a(97420)),o=l(a(46274)),d=l(a(20432)),u=l(a(13550)),c=l(a(3395)),f=l(a(34727)),h=s(a(85002)),p=l(a(25404)),m=s(a(92246)),v=a(53615),g=l(a(28204)),E=l(a(44216)),_=l(a(66761)),C=l(a(48878)),S=a(58603),y=l(a(94558)),I=l(a(43174)),M=l(a(23331)),P=l(a(63893)),L=l(a(52206)),T=l(a(86981)),b=l(a(17363)),D=l(a(82286)),N=l(a(62745)),O=s(a(9931)),w=l(a(63572));class k extends i.Component{constructor(...e){super(...e),this.setRefScrollable=e=>{this.refScrollable=e},this.state={msgInfo:void 0,unimplemented:!1},this._refWrapper=(0,i.createRef)(),this.isMsgVisible=(e,t=!1)=>e===this.props.msg.id&&(!!t||this.getMsgComponent()),this.onClose=()=>{this.props.uim.uie.requestDismiss()}}componentDidMount(){var e;I.default.find(this.props.msg.id).checkpoint(this.props.rejectOnUnmount()).then((e=>{this.setState({msgInfo:e}),this.props.listeners.add(e.played,"add remove",(()=>{this.forceUpdate()})),this.props.listeners.add(e.read,"add remove",(()=>{this.forceUpdate()})),this.props.listeners.add(e.delivery,"add remove",(()=>{this.forceUpdate()}))})).catchType(m.Unmount,(()=>{})).catch((()=>{this.setState({unimplemented:!0}),n.default.openToast(i.default.createElement(O.default,{msg:_.default.t(1078),id:(0,O.genId)("msg_info_failed")}))}));var t=null===(e=this.refScrollable)||void 0===e?void 0:e.container;this.props.msg.type===o.default.MSG_TYPE.IMAGE&&t&&(t.scrollTop=t.scrollHeight),this.props.listeners.add(this.props.msg,"remove",((e,t)=>{t===y.default&&this.props.uim.uie.requestDismiss()}))}getMsgComponent(){var e;return null===(e=this._refWrapper.current)||void 0===e?void 0:e.getMsgComponentRef()}render(){var e,t,a,{msg:l}=this.props,{msgInfo:s,unimplemented:n}=this.state;if(s){var m,g,C,y,I=[],L=l.type===o.default.MSG_TYPE.PTT;(L||l.isViewOnce)&&(t=L?_.default.t(1044):_.default.t(1046),C=(g=s.played.head())&&g.t,y=i.default.createElement("span",{className:u.default.icon},i.default.createElement(N.default,{name:L?"status-ptt":"view-once-viewed",className:u.default.statusBlue})),I.push(i.default.createElement(d.default,{title:L?_.default.t(1039):_.default.t(1048),t:C,icon:y,key:"played"}))),C=(g=s.read.head())&&g.t,y=i.default.createElement("span",{className:u.default.icon},i.default.createElement(N.default,{name:"status-dblcheck",className:u.default.ack})),t=null!==(m=t)&&void 0!==m?m:_.default.t(1041),I.push(i.default.createElement(d.default,{title:t,t:C,icon:y,key:"read"})),C=(g=s.delivery.head())&&g.t,y=i.default.createElement("span",{className:u.default.icon},i.default.createElement(N.default,{name:"status-dblcheck"})),I.push(i.default.createElement(d.default,{title:_.default.t(1037),t:C,icon:y,key:"delivery"})),!T.default.hfmStringChanges&&T.default.frequentlyForwardedMessages&&l.numTimesForwarded>0&&!l.isFrequentlyForwarded&&I.push(i.default.createElement(M.default,{key:"forward",msg:l})),e=i.default.createElement(p.default,{theme:"padding"},I)}s||n||(a=i.default.createElement("div",{className:u.default.spinner,key:"spinner"},i.default.createElement(b.default,{size:50,stroke:4})));var D=null;return l.labels&&l.labels.length&&(0,v.canDisplayLabel)()&&(D=i.default.createElement(p.default,{theme:"padding"},i.default.createElement(E.default,{labels:l.labels}))),i.default.createElement(c.default,{key:"message-info-modal",theme:"striped"},i.default.createElement(h.default,{title:_.default.t(1036),type:h.DRAWER_HEADER_TYPE.SMALL,onCancel:this.onClose}),i.default.createElement(P.default,{ref:this.setRefScrollable,chatPreference:r.default.assertGet("defaultPreference")},i.default.createElement(w.default,{msg:l,ref:this._refWrapper,displayType:o.default.DISP_TYPE.MSG_INFO,isMsgVisible:this.isMsgVisible,position:S.MsgPosition.END,onProductClick:this.props.onProductClick})),i.default.createElement(f.default,null,D,i.default.createElement("div",{className:u.default.body},a,e)))}}k.CONCERNS={msg:["id","star","type","isGif","isViewOnce","labels","numTimesForwarded","isFrequentlyForwarded"]},k.displayName="ContactMsgInfoDrawer";var R=(0,g.default)((0,L.default)((0,C.default)((0,D.default)(k,k.CONCERNS))));t.default=R},81843:(e,t,a)=>{"use strict";var l=a(20862),s=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(a(81109)),r=l(a(67294)),n=s(a(97420)),o=s(a(58743)),d=s(a(46274)),u=s(a(60246)),c=s(a(66761)),f=a(45739),h=a(64388),p=s(a(53318)),m=s(a(73132)),v=s(a(91072)),g=a(67052),E=s(a(51231)),_=l(a(9931)),C=a(78572),S=s(a(79766)),y=s(a(11942)),I=s(a(44843)),M=a(56726),{CONTACT_US_MAX_DESC_LENGTH:P}=d.default;class L extends r.Component{constructor(...e){super(...e),this.state={description:"",includeDeviceInfo:!0,isSending:!1},this._setDescriptionRef=e=>{this._descriptionInput=e},this.onSend=()=>{var{description:e,includeDeviceInfo:t}=this.state;if(this.validateDescription(e)){var a=(0,i.default)((0,i.default)({},I.default.parser.getResult()),{},{"Device ID":(0,M.assertGetMe)()}),l=t?JSON.stringify(a):void 0;this.setState({isSending:!0}),this.props.onSend&&this.props.onSend({description:e}),__LOG__(2)`InAppSupport: Sending support request with deviceInfo=${t}:${null!=l?l:"n/a"}`,this._sendRequest=(0,h.sendSupportRequest)(e,l).then((t=>{null!=t.message?(n.default.closeModal(),n.default.openToast(r.default.createElement(_.default,{msg:c.default.t(1435),id:(0,_.genId)()}))):this.props.onFailure&&this.props.onFailure({description:e})})).finally((()=>{this._sendRequest=void 0,this.setState({isSending:!1})}))}else this.setState({descriptionError:c.default.t(1382)})},this.onCancel=()=>{this.props.onCancel&&this.props.onCancel(),n.default.closeModal()},this.onEmail=()=>{var{onEmail:e}=this.props;e&&(n.default.closeModal(),e({description:this.state.description}))},this.onDescriptionChange=e=>{this.setState({description:e,descriptionError:this.validateDescription(e)?void 0:this.state.descriptionError})},this._onIncludeDeviceInfoChange=()=>{this.setState({includeDeviceInfo:!this.state.includeDeviceInfo})},this.validateDescription=e=>e.length>=d.default.CONTACT_US_MIN_DESC_LENGTH,this.stopPropagation=e=>{e.stopPropagation()}}componentWillUnmount(){var e,t;!0===(null===(e=this._sendRequest)||void 0===e?void 0:e.isPending())&&(null===(t=this._sendRequest)||void 0===t||t.cancel())}componentDidMount(){var e;null===(e=this._descriptionInput)||void 0===e||e.restoreFocus()}render(){var{isSending:e}=this.state,t={enter:this.stopPropagation};if(e&&(t.esc=this.stopPropagation),u.default.supportsFeature(u.default.F.MD_BACKEND)){var a="contact-us-include-device";return r.default.createElement(o.default,{title:c.default.t(1436),okDisabled:!this.validateDescription(this.state.description)||e,okSpinner:e,okText:c.default.t(1366),onOK:this.onSend,onCancel:e?void 0:this.onCancel},r.default.createElement(S.default,{handlers:t},r.default.createElement(g.FlexColumn,{align:"stretch"},r.default.createElement(E.default,{error:this.state.descriptionError,maxLength:P,onChange:this.onDescriptionChange,placeholder:c.default.t(1434),ref:this._setDescriptionRef,value:this.state.description}),r.default.createElement(g.FlexItem,{className:y.default.deviceInfo,grow:1},r.default.createElement(f.TextParagraph,{theme:"muted-small"},c.default.t(1432))),r.default.createElement(g.FlexRow,null,r.default.createElement(g.FlexItem,{className:y.default.deviceInfoLabel,grow:1},r.default.createElement("label",{htmlFor:a},r.default.createElement(f.TextParagraph,{theme:"plain"},c.default.t(1433)," ",r.default.createElement(v.default,{href:(0,C.getSupportChatFaqUrl)()},c.default.t(919))))),r.default.createElement(g.FlexItem,{className:y.default.deviceInfoCheckbox,grow:0},r.default.createElement(m.default,{checked:this.state.includeDeviceInfo,id:a,onChange:this._onIncludeDeviceInfoChange}))),r.default.createElement(g.FlexRow,null,r.default.createElement(g.FlexItem,{className:y.default.emailLink,grow:1},r.default.createElement(p.default,{onClick:this.onEmail},c.default.t(770)))))))}return r.default.createElement(o.default,{okText:c.default.t(1826),onOK:()=>n.default.closeModal(),title:c.default.t(1436)},r.default.createElement(f.TextParagraph,{theme:"plain"},c.default.t(1437)))}}t.default=L,L.displayName="ContactUsModal"},82324:(e,t,a)=>{"use strict";var l=a(95318),s=a(20862);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(a(67294)),r=l(a(56656)),n=l(a(97420)),o=l(a(66761)),d=l(a(1340)),u=s(a(50822)),c=a(79665),f=a(45739),h=l(a(53233)),p=e=>{var t=(0,h.default)(e.mute,["isMuted","expiration"]),[a,l]=(0,i.useState)((()=>d.default.getGlobalNotifications())),[s,p]=(0,i.useState)((()=>d.default.getOutgoingMessageSound())),[m,v]=(0,i.useState)((()=>d.default.getGlobalSounds())),[g,E]=(0,i.useState)((()=>d.default.getGlobalPreviews())),[_,C]=(0,i.useState)((()=>d.default.getCollapseMuted())),S=[];window.Notification&&(S.push(i.default.createElement(u.SettingsCheckListItem,{key:0,a8nText:"option-desktop-notifications",id:"desktop-notifications",checked:a,onChange:()=>{l((e=>{var t=!e;return d.default.setGlobalNotifications(t),t}))}},o.default.t(1202))),S.push(i.default.createElement(u.SettingsCheckListItem,{key:1,a8nText:"options-msg-previews",disabled:!a,id:"msg-previews",checked:g,onChange:()=>{E((e=>{var t=!e;return d.default.setGlobalPreviews(t),t}))}},o.default.t(1204),i.default.createElement(f.TextDiv,{theme:"muted"},o.default.t(1205)))));var{expiration:y,isMuted:I}=t;return i.default.createElement(u.default,null,i.default.createElement(u.SettingsCheckListItem,{a8nText:"option-sounds",id:"sounds",checked:m,onChange:()=>{v((e=>{var t=!e;return d.default.setGlobalSounds(t),t}))}},o.default.t(1209)),undefined,S,undefined,i.default.createElement(u.SettingsCheckListItem,{a8nText:"option-mute-desktop-notifications",id:"mute-desktop-notifications",checked:I,onChange:()=>{n.default.muteAll((0,c.unproxy)(t),!t.isMuted)}},o.default.t(1463),I&&null!=y?i.default.createElement(f.TextDiv,{theme:"muted"},r.default.untilStr(y)):null))};t.default=p},8053:(e,t,a)=>{"use strict";var l=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return s.default.createElement("div",{key:"container",className:i.default.dropOverlay},s.default.createElement("div",{className:i.default.dropOverlayOutline},r.default.t(639)))};var s=l(a(67294)),i=l(a(86088)),r=l(a(66761))},39159:(e,t,a)=>{"use strict";var l=a(95318),s=a(20862);Object.defineProperty(t,"__esModule",{value:!0}),t.E2EChangeModal=t.E2EChangeModalClass=void 0;var i=s(a(67294)),r=l(a(97420)),n=l(a(58743)),o=l(a(66761)),d=l(a(82286));class u extends i.Component{render(){var e=o.default.t(1826),t=this.props.contact.formattedShortName,a=o.default.t(1989,{contactName:t}),l=o.default.t(1990,{contactName:t});return i.default.createElement(n.default,{title:a,onOK:()=>r.default.closeModal(),okText:e},l)}}t.E2EChangeModalClass=u,u.CONCERNS={contact:["formattedShortName"]},u.displayName="E2EChangeModalClass";var c=(0,d.default)(u,u.CONCERNS);t.E2EChangeModal=c},58750:(e,t,a)=>{"use strict";var l=a(20862),s=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.RETRY_OPTIONS=void 0;var i=s(a(41609)),r=l(a(67294)),n=s(a(3395)),o=s(a(34727)),d=s(a(85002)),u=s(a(25605)),c=s(a(51994)),f=s(a(91072)),h=s(a(66761)),p=s(a(48878)),m=s(a(67919)),v=s(a(29809)),g=s(a(53852)),E=s(a(10315)),_=s(a(92120)),C=s(a(62745)),S=a(48725),y=s(a(53918)),I=s(a(77923)),M={NONE:"none",RETAKE:"retake",RESTART:"restart"};t.RETRY_OPTIONS=M;class P extends r.Component{constructor(e){super(e),this._onDoneEditing=()=>{var e=this.state.editedMedia;this.saveCanvas(),this._refProfileCropTool&&this._refProfileCropTool.crop().then((({thumb:t,full:a})=>{this.props.onFinished(t,a),e.cleanUp()}))},this._onObjectLoad=e=>{if(e&&e instanceof HTMLElement){var t={};!this.state.editorSize||this.state.editorSize.width===e.clientWidth&&this.state.editorSize.height===e.clientHeight||(t.editorSize={width:e.clientWidth,height:e.clientHeight}),this.state.loaded||(t.loaded=!0),(0,i.default)(t)||this.setState(t)}},this.setRefMediaEditCanvas=e=>{this.mediaEditCanvas=e},this._setRefProfileCropTool=e=>{this._refProfileCropTool=e},this.drawCanvas=(e,t)=>{this.mediaEditCanvas&&this.mediaEditCanvas.drawCanvas(e,t)},this.saveCanvas=()=>{this.mediaEditCanvas&&this.mediaEditCanvas.saveCanvas()},this.updateCanvasSize=(e,t)=>{this.mediaEditCanvas&&this.mediaEditCanvas.updateCanvasSize(e,t)},this.onCanvasInitialized=()=>{this.forceUpdate()},this.state={doneEditing:!1,loaded:!1,editorSize:{width:500,height:361},editedMedia:new c.default(e.img)},this.mediaEditController=new v.default}componentDidMount(){this.props.listeners.add(this.mediaEditController,"change:isInitialized",this.onCanvasInitialized)}render(){var e,{attributionUrl:t,onRetake:a,retryText:l}=this.props,s=this.state.loaded?r.default.createElement("div",{className:u.default.btnSend,key:"btn-send"},r.default.createElement(_.default,{large:!0,onClick:this._onDoneEditing},r.default.createElement(C.default,{name:"checkmark-large"}))):null;this.mediaEditController.isInitialized&&(e=r.default.createElement(E.default,{editedMedia:this.state.editedMedia,stage:this.mediaEditController.stage,cropOverlay:this.mediaEditController.cropOverlay,mediaContainer:this.mediaEditController.mediaContainer,drawCanvas:this.drawCanvas,ref:this._setRefProfileCropTool}));var i,c=r.default.createElement(m.default,{className:u.default.mediaElement,editedMedia:this.state.editedMedia,mediaEditController:this.mediaEditController,fitType:"cover",ref:this.setRefMediaEditCanvas});if(a){var p;switch(l){case M.NONE:p=null;break;case M.RETAKE:p=h.default.t(1315);break;case M.RESTART:default:p=h.default.t(1318)}i=r.default.createElement("button",{className:u.default.retake,onClick:a},r.default.createElement("div",{className:u.default.retakeIcon},r.default.createElement(C.default,{name:"return"})),p)}var v=t?r.default.createElement("div",{className:u.default.attribution},r.default.createElement(f.default,{className:u.default.attributionLink,href:t},y.default.hostname(t)),r.default.createElement("span",null,h.default.t(876),"",r.default.createElement(f.default,{href:(0,S.getTosUrl)()},h.default.t(882)))):null,P=r.default.createElement("div",{className:u.default.footer},r.default.createElement(I.default,{transitionName:"btn"},s),v),L=this.props.imageSize?this.props.imageSize:{width:500,height:361};return r.default.createElement(n.default,{key:"attach-edit-modal",theme:"edit"},r.default.createElement(d.default,{title:h.default.t(224),type:"offset",onCancel:this.props.onCancel},i),r.default.createElement(o.default,{overflow:"hidden"},r.default.createElement("div",{className:u.default.mediaBody},e,r.default.createElement("div",{className:u.default.containerBackground},r.default.createElement(I.default,{transitionName:"capture"},r.default.createElement(g.default,{type:"cover",size:L,onObjectLoad:this._onObjectLoad},c)))),P))}}P.displayName="EditImageDrawer";var L=(0,p.default)(P);t.default=L},28585:(e,t,a)=>{"use strict";var l=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function({frequentlyForwardedCount:e,totalCount:t}){var a=s.default.createElement("span",{className:o.default.text},1===e&&1===t?d.default.t(759):d.default.t(758)," ",s.default.createElement(r.default,{href:(0,n.getFrequentlyForwardedFaqUrl)()},d.default.t(919)));return s.default.createElement("div",{className:o.default.wrapper},s.default.createElement("div",{className:o.default.icon},s.default.createElement(u.default,{name:"highly-forwarded"})),s.default.createElement(i.default,{theme:"plain",primary:a,idle:!0}))};var s=l(a(67294)),i=l(a(79274)),r=l(a(91072)),n=a(78572),o=l(a(65813)),d=l(a(66761)),u=l(a(62745))},19874:(e,t,a)=>{"use strict";var l=a(95318),s=a(20862);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(73591),r=s(a(67294)),n=l(a(79274)),o=l(a(97420)),d=l(a(42699)),u=s(a(27890)),c=l(a(3395)),f=l(a(34727)),h=l(a(61376)),p=s(a(85002)),m=l(a(98712)),v=a(4404),g=a(66274),E=s(a(92246)),_=a(18813),C=l(a(32521)),S=l(a(27346)),y=l(a(66761)),I=l(a(52206)),M=a(80493),P=l(a(45256)),L=l(a(36350)),T=l(a(82286)),b=l(a(62745)),D=s(a(9931)),N="group-invite-link-anchor",O=0,w=1,k=2;class R extends r.Component{constructor(...e){super(...e),this.state={state:O},this._getErrorMessageFromStatusCode=e=>{switch(e){case 401:return y.default.t(808);case 403:return y.default.t(809);case 404:return y.default.t(810);default:return y.default.t(811)}},this._handleLoadingErrorStatusCode=e=>{var t=this._getErrorMessageFromStatusCode(e);this.props.onBack(),o.default.openToast(r.default.createElement(D.default,{msg:t,id:(0,D.genId)()}))},this._handleRevokeGroupInvite=()=>{o.default.openModal(r.default.createElement(S.default,{pushTransition:"none",popTransition:"none",chat:this.props.chat,onConfirm:this._handleConfirmRevokeGroupInvite}),{transition:"modal-flow"})},this._handleRevokingErrorStatusCode=e=>{var t=this._getErrorMessageFromStatusCode(e);this.props.onBack(),o.default.openToast(r.default.createElement(D.default,{msg:t,id:(0,D.genId)()}))},this._handleConfirmRevokeGroupInvite=()=>{this.setState({state:w});var e=(0,_.revokeGroupInvite)(this.props.groupMetadata);(0,i.delayMs)(500).then((()=>e)).checkpoint(this.props.rejectOnUnmount()).then((()=>{o.default.openToast(r.default.createElement(D.default,{msg:y.default.t(814),id:(0,D.genId)()})),this.setState({state:k})})).catchType(g.ServerStatusCodeError,(e=>{this._handleRevokingErrorStatusCode(e.statusCode)})).catchType(E.Unmount,(()=>{}))},this._handleSendGroupInviteLink=()=>{o.default.openModal(r.default.createElement(P.default,{chat:this.props.chat}),{transition:"modal-flow"})},this.handleClickGroupInviteLinkCapture=e=>{e.preventDefault(),e.stopPropagation()},this._renderDrawerBody=()=>{var e,t=this.props.groupMetadata;if(this.state.state===O)e=r.default.createElement(v.LoadingWithText,{text:y.default.t(801)});else if(this.state.state===w)e=r.default.createElement(v.LoadingWithText,{text:y.default.t(813,{groupName:this.props.chat.contact.name})});else{var a=t.groupInviteLink,l=null;document.queryCommandSupported("copy")&&(l=r.default.createElement(d.default,{elementId:N}));var s=r.default.createElement(u.default,{id:this.props.chat.id,size:82,quality:u.DETAIL_IMAGE_QUALITY.HIGH}),i=r.default.createElement("span",{className:C.default.linkContainer},r.default.createElement(M.SelectableLink,{id:N,href:a,selectable:!0},a));e=r.default.createElement(f.default,null,r.default.createElement(n.default,{image:s,primary:r.default.createElement(m.default,{text:this.props.chat.contact.name,direction:"auto"}),theme:"identity",secondary:i}),r.default.createElement("div",{className:C.default.descContainer},y.default.t(806)),r.default.createElement(L.default,{onClick:this._handleSendGroupInviteLink}),l,r.default.createElement(h.default,{a8nText:"li-revoke-link",icon:r.default.createElement(b.default,{name:"revoke",className:C.default.icon}),onClick:this._handleRevokeGroupInvite},y.default.t(803)))}return e}}componentDidMount(){(0,_.queryGroupInviteCode)(this.props.groupMetadata).checkpoint(this.props.rejectOnUnmount()).then((()=>{this.setState({state:k})})).catchType(g.ServerStatusCodeError,(e=>{this._handleLoadingErrorStatusCode(e.statusCode)})).catchType(E.Unmount,(()=>{}))}render(){return r.default.createElement(c.default,null,r.default.createElement(p.default,{title:y.default.t(805),onBack:this.props.onBack,type:p.DRAWER_HEADER_TYPE.SMALL}),this._renderDrawerBody())}}R.CONCERNS={groupMetadata:["inviteCode","groupInviteLink"]},R.displayName="GroupInviteLinkDrawer";var A=(0,I.default)((0,T.default)(R,R.CONCERNS));t.default=A},66564:(e,t,a)=>{"use strict";var l=a(95318),s=a(20862);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(a(67294)),r=l(a(97420)),n=l(a(58743)),o=l(a(56081)),d=l(a(66761));class u extends i.Component{constructor(...e){super(...e),this._handleCancel=()=>{r.default.closeModal()},this._handleOK=()=>{this.props.onConfirm(),r.default.closeModal()}}render(){return i.default.createElement(n.default,{title:d.default.t(803),onOK:this._handleOK,okText:d.default.t(803),onCancel:this._handleCancel,cancelText:d.default.t(1657)},i.default.createElement("div",{className:o.default.confirmationText},d.default.t(812,{groupName:this.props.chat.contact.name})))}}t.default=u,u.displayName="GroupInviteRevokeModal"},94348:(e,t,a)=>{"use strict";var l=a(20862),s=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(a(96391)),r=l(a(67294)),n=s(a(62067)),o=s(a(28383)),d=s(a(97420)),u=s(a(46274)),c=s(a(3395)),f=s(a(34727)),h=l(a(85002)),p=s(a(25404)),m=l(a(92246)),v=l(a(47060)),g=s(a(12063)),E=a(53615),_=s(a(53422)),C=s(a(23533)),S=s(a(50700)),y=a(56920),I=s(a(28204)),M=s(a(44216)),P=s(a(66761)),L=s(a(48878)),T=a(58603),b=s(a(94558)),D=s(a(43174)),N=s(a(23331)),O=s(a(63893)),w=s(a(52206)),k=s(a(66567)),R=s(a(86981)),A=s(a(17363)),x=s(a(82286)),F=s(a(62745)),U=a(45739),B=l(a(9931)),H=s(a(63572));class G extends r.Component{constructor(...e){super(...e),this.flatListController=new g.default,this.setRefScrollable=e=>{this.refScrollable=e},this.state={msgInfo:void 0,unimplemented:!1},this._refWrapper=(0,r.createRef)(),this.isMsgVisible=(e,t=!1)=>e===this.props.msg.id&&(!!t||this.getMsgComponent()),this.onClose=()=>{this.props.uim.uie.requestDismiss()},this._getHeaderAtSection=e=>{var t,a;switch(e){case y.SECTIONS.PLAYED_HEADER:a=r.default.createElement(F.default,{name:"status-ptt",className:C.default.statusBlue}),t=P.default.t(1040);break;case y.SECTIONS.READ_HEADER:a=r.default.createElement(F.default,{name:"status-dblcheck",className:C.default.ack}),t=P.default.t(1042);break;case y.SECTIONS.SEEN_HEADER:a=r.default.createElement(F.default,{name:"status-dblcheck",className:C.default.ack}),t=this.props.msg.isViewOnce?P.default.t(1047):P.default.t(1045);break;case y.SECTIONS.DELIVERED_HEADER:a=r.default.createElement(F.default,{name:"status-dblcheck"}),t=P.default.t(1038);break;case y.SECTIONS.VIEWED_HEADER:a=r.default.createElement(F.default,{name:"view-once-viewed",className:C.default.statusBlue}),t=P.default.t(1049);break;default:return __LOG__(4,void 0,new Error)`Invalid SECTION for group message info section header`,null}return a=r.default.createElement("div",{className:C.default.titleIcon},a),r.default.createElement("div",{"data-a8n":n.default.key("msg-info-title"),className:C.default.title},r.default.createElement(k.default,{side:a,ellipsify:!0},r.default.createElement(U.TextSpan,{theme:"section-title"},t)))},this._getFooterAtSection=e=>{var t=(0,i.default)(this.state.msgInfo,"this.state.msgInfo");return r.default.createElement(S.default,{key:e,section:e,msgInfo:t})},this.renderItem=e=>{if("row"===e.kind)return this._getInfoCell(e.participant);if(e.type===y.SECTIONS.FORWARD_COUNT)return this._getForwardCount();switch(e.type){case y.SECTIONS.PLAYED_HEADER:case y.SECTIONS.READ_HEADER:case y.SECTIONS.SEEN_HEADER:case y.SECTIONS.DELIVERED_HEADER:case y.SECTIONS.VIEWED_HEADER:return this._getHeaderAtSection(e.type);default:return this._getFooterAtSection(e.type)}}}componentDidMount(){var e;D.default.find(this.props.msg.id).checkpoint(this.props.rejectOnUnmount()).then((e=>{this.setState({msgInfo:e}),this.props.listeners.add(e.played,"add remove",(()=>{this.forceUpdate()})),this.props.listeners.add(e.read,"add remove",(()=>{this.forceUpdate()})),this.props.listeners.add(e.delivery,"add remove",(()=>{this.forceUpdate()}))})).catchType(m.Unmount,(()=>{})).catch((()=>{this.setState({unimplemented:!0}),d.default.openToast(r.default.createElement(B.default,{msg:P.default.t(1078),id:(0,B.genId)("msg_info_failed")}))}));var t=null===(e=this.refScrollable)||void 0===e?void 0:e.container;this.props.msg.type===u.default.MSG_TYPE.IMAGE&&t&&(t.scrollTop=t.scrollHeight),this.props.listeners.add(this.props.msg,"remove",((e,t)=>{t===b.default&&this.props.uim.uie.requestDismiss()}))}getAnimateEnterClass(e){return`animate-enter${-1===e?"":e}`}getMsgComponent(){var e;return null===(e=this._refWrapper.current)||void 0===e?void 0:e.getMsgComponentRef()}_getInfoCell(e){return r.default.createElement(_.default,{msgInfoParticipant:e,contact:e.contact,key:e.id.toString()})}_getForwardCount(){return R.default.hfmStringChanges?null:r.default.createElement("div",{className:C.default.forwardCount},r.default.createElement(N.default,{msg:this.props.msg}))}getData(){var{msg:e}=this.props,{msgInfo:t}=this.state,a=[],l=e.type===u.default.MSG_TYPE.PTT,s=l||e.isViewOnce;if(t&&s){var i=l?y.SECTIONS.PLAYED_HEADER:y.SECTIONS.VIEWED_HEADER;a.push({kind:"section",type:i,itemKey:i,height:50}),a.push(...t.played.map((e=>({participant:e,kind:"row",itemKey:e.id.toString(),height:v.DEFAULT_ITEM_HEIGHT})))),t.playedRemaining>0&&(i=l?y.SECTIONS.PLAYED_FOOTER:y.SECTIONS.VIEWED_FOOTER,a.push({kind:"section",type:i,itemKey:i,height:50}))}return t&&(t.read.length>0||t.playedRemaining>0)&&(a.push({kind:"section",type:s?y.SECTIONS.SEEN_HEADER:y.SECTIONS.READ_HEADER,itemKey:y.SECTIONS.READ_HEADER,height:50}),a.push(...t.read.map((e=>({participant:e,kind:"row",itemKey:e.id.toString(),height:v.DEFAULT_ITEM_HEIGHT})))),t.readRemaining>0&&a.push({kind:"section",type:y.SECTIONS.READ_FOOTER,itemKey:s?y.SECTIONS.SEEN_FOOTER:y.SECTIONS.READ_FOOTER,height:50})),t&&(t.delivery.length>0||t.deliveryRemaining>0)&&(a.push({kind:"section",type:y.SECTIONS.DELIVERED_HEADER,itemKey:y.SECTIONS.DELIVERED_HEADER,height:50}),a.push(...t.delivery.map((e=>({participant:e,kind:"row",itemKey:e.id.toString(),height:v.DEFAULT_ITEM_HEIGHT})))),t.deliveryRemaining>0&&a.push({kind:"section",type:y.SECTIONS.DELIVERED_FOOTER,itemKey:y.SECTIONS.DELIVERED_FOOTER,height:50})),R.default.frequentlyForwardedMessages&&e.numTimesForwarded>0&&!e.isFrequentlyForwarded&&a.push({kind:"section",type:y.SECTIONS.FORWARD_COUNT,itemKey:y.SECTIONS.FORWARD_COUNT,height:60}),a}render(){var e,{msg:t}=this.props,{msgInfo:a,unimplemented:l}=this.state;a||l||(e=r.default.createElement("div",{className:C.default.spinner,key:"spinner"},r.default.createElement(A.default,{size:50,stroke:4})));var s=this.getData(),i=s.length?r.default.createElement(v.default,{flatListController:this.flatListController,direction:"vertical",forceConsistentRenderCount:!1,data:s,renderItem:this.renderItem}):null,n=null;return t.labels&&t.labels.length&&(0,E.canDisplayLabel)()&&(n=r.default.createElement(p.default,{theme:"padding"},r.default.createElement(M.default,{labels:t.labels}))),r.default.createElement(c.default,{key:"message-info-modal",theme:"striped"},r.default.createElement(h.default,{title:P.default.t(1036),type:h.DRAWER_HEADER_TYPE.SMALL,onCancel:this.onClose}),r.default.createElement(O.default,{ref:this.setRefScrollable,chatPreference:o.default.assertGet("defaultPreference")},r.default.createElement(H.default,{msg:t,ref:this._refWrapper,displayType:u.default.DISP_TYPE.MSG_INFO,isMsgVisible:this.isMsgVisible,position:T.MsgPosition.END,onProductClick:this.props.onProductClick})),r.default.createElement(f.default,{flatListControllers:[this.flatListController]},n,e,r.default.createElement("div",{className:C.default.list},i)))}}G.CONCERNS={msg:["id","star","type","isGif","isViewOnce","labels","numTimesForwarded","isFrequentlyForwarded"]},G.displayName="GroupMsgInfoDrawer";var V=(0,I.default)((0,w.default)((0,L.default)((0,x.default)(G,G.CONCERNS))));t.default=V},50700:(e,t,a)=>{"use strict";var l=a(95318),s=a(20862);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(a(67294)),r=l(a(62067)),n=l(a(23533)),o=a(56920),d=l(a(66761)),u=l(a(82286)),c=a(45739);class f extends i.Component{render(){var e,t,a;switch(this.props.section){case o.SECTIONS.PLAYED_FOOTER:case o.SECTIONS.VIEWED_FOOTER:e=this.props.msgInfo.playedRemaining,t=this.props.msgInfo.playedRemaining;break;case o.SECTIONS.READ_FOOTER:case o.SECTIONS.SEEN_FOOTER:e=this.props.msgInfo.readRemaining,t=this.props.msgInfo.readRemaining;break;case o.SECTIONS.DELIVERED_FOOTER:e=this.props.msgInfo.deliveryRemaining,t=this.props.msgInfo.deliveryRemaining;break;default:return __LOG__(4,void 0,new Error)`Invalid SECTION for group message info section footer`,null}a=null!=e&&0!==e?{count:e,_plural:t}:{_plural:t};var l=d.default.t(1043,a);return i.default.createElement("div",{"data-a8n":r.default.key("msg-info-remaining"),className:n.default.footer},i.default.createElement(c.TextSpan,{theme:"muted"},l))}}f.CONCERNS={msgInfo:["playedRemaining","readRemaining","deliveryRemaining"]},f.displayName="GroupMsgInfoSectionFooter";var h=(0,u.default)(f,f.CONCERNS);t.default=h},56920:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SECTIONS=void 0;var l=a(54302).Mirrored(["DELIVERED_FOOTER","DELIVERED_HEADER","FORWARD_COUNT","PLAYED_FOOTER","PLAYED_HEADER","READ_FOOTER","READ_HEADER","SEEN_FOOTER","SEEN_HEADER","VIEWED_FOOTER","VIEWED_HEADER"]);t.SECTIONS=l},50750:(e,t,a)=>{"use strict";var l=a(95318),s=a(20862);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(a(67294)),r=l(a(79274)),n=l(a(46274)),o=l(a(27890)),d=l(a(3395)),u=l(a(34727)),c=s(a(85002)),f=l(a(98712)),h=l(a(70053)),p=l(a(2021)),m=l(a(66761)),v=l(a(18467)),g=l(a(1600)),E=l(a(54161)),_=l(a(52206)),C=l(a(92120)),S=l(a(62745)),y=l(a(51231)),I=l(a(77923));class M extends i.Component{constructor(...e){super(...e),this.state={isBusy:!1,inviteComment:m.default.t(833)},this.setRefParticipantList=e=>{this.refParticipantList=e},this.onClose=()=>{var{onClose:e}=this.props;e()},this._getGroupThumbBase64=()=>{var{gid:e}=this.props,t=E.default.get(e);return new Promise((e=>{t&&t.img?(0,h.default)(t.img).then((t=>{if(t.ok)return t.blob();e(void 0)})).then((t=>{if(t){var a=new FileReader;a.onloadend=function(){var t=a.result;if(null!=t){var l=t.toString().split(",")[1];e(l)}else e(void 0)},a.readAsDataURL(t)}})).catch((()=>e(void 0))):e(void 0)}))},this.onSend=()=>{var{onSend:e}=this.props,{inviteComment:t}=this.state;this._getGroupThumbBase64().then((a=>{e(t,a)}))},this._onInviteCommentChange=e=>{this.setState({inviteComment:e})},this.setRefEmojiInput=e=>{this.refEmojiInput=e}}render(){var e=i.default.createElement(C.default,{a8nText:"group-participants-btn",large:!0,onClick:this.onSend},i.default.createElement(S.default,{name:"send",directional:!0})),t=i.default.createElement(o.default,{id:this.props.gid}),a=i.default.createElement(f.default,{text:this.props.subject});return i.default.createElement(v.default,{type:"invite"},i.default.createElement(d.default,{theme:"invite"},i.default.createElement(c.default,{type:c.DRAWER_HEADER_TYPE.POPUP,title:m.default.t(842),onCancel:this.onClose}),i.default.createElement(u.default,null,i.default.createElement("div",{className:p.default.search},i.default.createElement("div",{"data-list-scroll-container":!0},i.default.createElement(g.default,{ref:this.setRefParticipantList,theme:"list-names",contacts:this.props.participants.map((e=>e.contact))}))),i.default.createElement("div",{className:p.default.commentInput},i.default.createElement(y.default,{a8n:"groups-v4-invite-add-comment-input",ref:this.setRefEmojiInput,value:this.state.inviteComment,showRemaining:!0,maxLength:n.default.MAX_CAPTION_LENGTH,onChange:this._onInviteCommentChange,theme:"v4-invite-caption",supportsEmoji:!0})),i.default.createElement(I.default,{transitionName:"btn",className:p.default.onSendInvite},e),i.default.createElement("div",{className:p.default.groupInfo},i.default.createElement(r.default,{idle:!0,image:t,primary:a,secondary:m.default.t(837),theme:"group_v4_invite"})))))}}M.displayName="GroupV4InviteAddComment";var P=(0,_.default)(M);t.default=P},82396:(e,t,a)=>{"use strict";var l=a(20862),s=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(a(23279)),r=s(a(63105)),n=s(a(35161)),o=a(73591),d=l(a(67294)),u=l(a(2078)),c=a(4404),f=s(a(66761)),h=s(a(81354)),p=s(a(1398)),m=s(a(24927));class v extends d.Component{getElement(){this._refEl}constructor(e){super(e),this._setRefEl=e=>{this._refEl=e},this.onSelect=(e,t)=>{if(t instanceof u.Mode){var a=t.props.chat;!0===this.props.filter(a)&&this.props.onGroup(t.props.chat)}},this.onSearch=(0,i.default)((e=>{this.setState({searchText:e})}),100),this.renderItem=e=>{var t,a,{onGroup:l,filter:s}=this.props,i=s(e.chat),r="boolean"!=typeof i;return r&&(t=i,a="group-modal"),d.default.createElement(u.default,{chat:e.chat,contact:e.chat.contact,mode:u.Mode.INFO,active:this.selection,secondary:t,noContext:!0,theme:a,onClick:r?void 0:l.bind(null,e.chat)})},this.selection=new m.default,this.state={loading:!0,searchText:void 0}}componentDidMount(){var{chats:e}=this.props;(0,o.delayMs)(300).then((()=>Promise.all((0,n.default)((0,r.default)(e,(e=>e.groupMetadata.stale)),(e=>a(28936).default.update(e.groupMetadata.id).catch((()=>{}))))))).then((()=>this.setState({loading:!1})))}getData(){var{chats:e,filter:t}=this.props,{loading:a,searchText:l}=this.state;if(a)return[];var s=f.default.accentFold(l),i=(0,p.default)(s),r=e.filter((e=>t(e)&&(!s||s&&e.contact.searchMatch(s,i))));return this.selection.init(r.filter((e=>!0===t(e))).map((e=>e.id))),r.map((e=>({chat:e,itemKey:e.id.toString()})))}render(){var{onCancel:e}=this.props,{loading:t}=this.state,a=t?d.default.createElement(c.Loading,null):d.default.createElement(c.SearchGroups,null);return d.default.createElement(h.default,{title:f.default.t(1781),data:this.getData(),renderItem:this.renderItem,emptyState:a,selection:this.selection,onCancel:e,onSearch:this.onSearch,onSelect:this.onSelect,onRef:this._setRefEl,searchPlaceholder:f.default.t(1332)})}}t.default=v,v.defaultProps={filter:function(){return!0}},v.displayName="GroupsModal"},47334:(e,t,a)=>{"use strict";var l=a(95318),s=a(20862);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(a(67294)),r=l(a(11959)),n=s(a(19117)),o=l(a(97420)),d=l(a(37976)),u=l(a(3395)),c=l(a(34727)),f=l(a(61376)),h=s(a(85002)),p=a(91072),m=a(78572),v=l(a(60246)),g=l(a(51298)),E=l(a(66761)),_=l(a(84644)),C=a(13664),S=l(a(5148)),y=l(a(16951)),I=a(48725),M=l(a(44843)),P=l(a(8895)),L={id:"animated-doodle",selectors:[`.${g.default.animation}`],low:{default:r.default},high:{default:r.default}};class T extends i.Component{constructor(...e){super(...e),this.openTime=-1,this._actionsTaken=!1,this._onTOS=()=>{this._actionsTaken=!0,(0,p.openExternalLink)((0,I.getTosUrl)())},this._onHelpCenter=()=>{(0,p.openExternalLink)((0,m.getFaqUrl)()),this._logSessionEvent(S.default.CONTACT_US_EXIT_STATE.FAQ)},this._onContactUs=()=>{o.default.openModal(v.default.supportsFeature(v.default.F.SUPPORT)?i.default.createElement(d.default,{onEmail:this.onContactUsRetryWithEmail,onCancel:this.onContactUsCancel,onFailure:this.onContactUsRetryWithEmail}):i.default.createElement(y.default,{onCancel:this.onContactUsCancel,onSend:this.onContactUsSend}))},this._onLicenses=()=>{o.default.openModal(i.default.createElement(_.default,{onOk:this._onLicensesOk}))},this.onContactUsCancel=()=>{this._logSessionEvent(S.default.CONTACT_US_EXIT_STATE.PROBLEM_DESCRIPTION)},this.onContactUsSend=e=>{this._logSessionEvent(S.default.CONTACT_US_EXIT_STATE.EMAIL_SEND,e)},this.onContactUsRetryWithEmail=e=>{o.default.openModal(i.default.createElement(y.default,{onCancel:this.onContactUsCancel,onSend:this.onContactUsSend,description:null==e?void 0:e.description}))},this._onLicensesOk=()=>{}}componentDidMount(){this.openTime=performance.now(),n.default.loadAsset(L,n.LOAD_PRIORITY.HELP_ANIMATED_DOODLE)}componentWillUnmount(){this._actionsTaken||this._logSessionEvent(S.default.CONTACT_US_EXIT_STATE.CANCELLED)}_logSessionEvent(e,t){(0,C.logSessionEvent)(e,this.openTime,t),this._actionsTaken=!0}render(){var e;return M.default.isElectron&&(e=i.default.createElement(f.default,{a8nText:"li-licenses",onClick:this._onLicenses},E.default.t(920))),i.default.createElement(u.default,null,i.default.createElement(h.default,{a8n:"drawer-title-help",title:E.default.t(869),onBack:this.props.onClose,type:h.DRAWER_HEADER_TYPE.LARGE}),i.default.createElement(c.default,null,i.default.createElement("div",{className:g.default.animation}),i.default.createElement(P.default,{className:g.default.versionInfo}),i.default.createElement(f.default,{a8nText:"li-faq",onClick:this._onHelpCenter},E.default.t(1893)),i.default.createElement(f.default,{a8nText:"li-contact-us",onClick:this._onContactUs},E.default.t(1380)),e,i.default.createElement(f.default,{a8nText:"li-tos",onClick:this._onTOS},E.default.t(1456)),undefined,undefined))}}t.default=T,T.displayName="HelpDrawer"},73043:(e,t,a)=>{"use strict";var l=a(20862),s=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(a(57043)),r=s(a(35161)),n=s(a(24350)),o=l(a(67294)),d=l(a(83756)),u=s(a(97420)),c=s(a(46274)),f=s(a(3395)),h=s(a(34727)),p=l(a(85002)),m=a(4404),v=l(a(92246)),g=s(a(70053)),E=s(a(23418)),_=s(a(47312)),C=s(a(79766)),S=s(a(9345)),y=s(a(66761)),I=s(a(89329)),M=s(a(52206)),P=s(a(5535)),L=s(a(10937)),T=l(a(9931)),b=s(a(44843)),D=a(93215),N=s(a(7682));class O extends o.Component{constructor(e){super(e),this.setRefSearch=e=>{this.refSearch=e},this._setRefSearchHotkeys=e=>{this._refSearchHotkeys=e},this._setRefGallery=e=>{this._refGallery=e},this._search=(e,t)=>{this._hasPendingSearch=!1;var a=d.search(e,t).cancellable().then((t=>{a===this._searchPromise&&(this._addSearchResults(e,t),this.setState({isSearching:!1}))})).catchType(Promise.CancellationError,(()=>{})).catch((()=>{__LOG__(3,!0)`Image search failed`,u.default.openToast(o.default.createElement(T.default,{msg:y.default.t(877),id:(0,T.genId)()})),a===this._searchPromise&&this.setState({isSearching:!1})})).finally((()=>{a===this._searchPromise&&(this._searchPromise=null)}));this._searchPromise=a,this.setState({isSearching:!0})},this._handleUserInput=e=>{var t=(e||"").trim();if(!t)return this._cancelSearch(),void this._resetState();(0,D.numCodepoints)(t)<c.default.FTS_MIN_CHARS||t!==this.state.query&&(this._cancelSearch(),this._resetState(),this._requestSearch(t))},this._handleRequestMoreImages=()=>{this._hasPendingSearch||this._searchPromise||!this.state.totalEstimatedMatches||this.state.nextOffset>=this.state.totalEstimatedMatches||this._requestSearch(this.state.query,this.state.nextOffset)},this._handleImageClick=e=>{var t=this.state.imageData[e];if(t){var a=t.contentUrl;(b.default.isElectron?(0,P.default)((()=>(0,g.default)(a))).then((e=>{if(200!==e.status)throw new v.ServerStatusError(null,a,e.status);return e.blob()})):N.default.downloadImage(a)).checkpoint(this.props.rejectOnUnmount()).then((e=>{if(!(e instanceof Blob))throw new v.ImageError("Server did not respond with image bytes",a);this.props.onImageSelected(e,t.hostPageUrl)})).catchType(v.Unmount,(()=>{})).catch((()=>{__LOG__(3,!0)`Image search failed`,u.default.openToast(o.default.createElement(T.default,{msg:y.default.t(874),id:(0,T.genId)()}))}))}},this._focusSearch=()=>{E.default.shouldIndicateFocus(),_.default.focus(this.refSearch)},this._focusGallery=e=>{e.repeat||this._refGallery&&this.refSearch&&this.refSearch.cursorIsAtEnd()&&(e.preventDefault(),e.stopPropagation(),E.default.shouldIndicateFocus(),null!=this._refGallery&&_.default.focus(this._refGallery))},this._handleSearchFocus=()=>{E.default.maybeIndicateFocus(this._refSearchHotkeys)},this.state={imageData:{},isSearching:!1,nextOffset:0,query:"",thumbnails:[],totalEstimatedMatches:0},this._hasPendingSearch=!1,this._searchPromise=null,this._debouncedSearch=this.props.debounce(this._search,750)}componentWillUnmount(){this._cancelSearch()}_requestSearch(e,t=0){this._hasPendingSearch=!0,this._debouncedSearch(e,t)}_cancelSearch(){this._hasPendingSearch&&(this._debouncedSearch.cancel(),this._hasPendingSearch=!1),this._searchPromise&&this._searchPromise.cancel()}_resetState(){this.setState({imageData:{},isSearching:!1,nextOffset:0,query:"",thumbnails:[],totalEstimatedMatches:0})}_addSearchResults(e,t){this.setState((a=>{var l=(0,n.default)(t.value,(e=>null==e?void 0:e.thumbnailUrl)),s=(0,r.default)(t.value,(e=>({id:e.imageId,name:e.name,thumbUrl:e.thumbnailUrl}))),o=t.value.length,d={};return a.query===e?(d.nextOffset=t.nextOffset?t.nextOffset:a.nextOffset+o,d.thumbnails=(0,i.default)(a.thumbnails,s),d.totalEstimatedMatches=t.totalEstimatedMatches,d.imageData=Object.assign(l,a.imageData)):(d.imageData=l,d.nextOffset=t.nextOffset?t.nextOffset:o,d.query=e,d.thumbnails=s,d.totalEstimatedMatches=t.totalEstimatedMatches),d}))}render(){var e,t=p.DRAWER_HEADER_TYPE.POPUP,a={down:this._focusGallery};return e=0===this.state.thumbnails.length?this.state.isSearching?o.default.createElement(m.SearchingImages,null):this.state.query?o.default.createElement(m.ImageSearchEmpty,null):o.default.createElement(m.BeforeImageSearch,null):o.default.createElement(S.default,{ref:this._setRefGallery,canLoadMore:this.state.nextOffset<this.state.totalEstimatedMatches,isLoadingMore:this.state.isSearching,thumbnails:this.state.thumbnails,onFocusPrev:this._focusSearch,onImageClick:this._handleImageClick,onRequestMoreImages:this._handleRequestMoreImages}),o.default.createElement(f.default,null,o.default.createElement(p.default,{title:y.default.t(881),type:t,onBack:this.props.onBack,onCancel:this.props.onCancel}),o.default.createElement(h.default,null,o.default.createElement(C.default,{onRef:this._setRefSearchHotkeys,handlers:a,onFocus:this._handleSearchFocus},o.default.createElement(I.default,{ref:this.setRefSearch,placeholder:y.default.t(878),onSearch:this._handleUserInput,loading:this.state.isSearching})),e))}}O.displayName="ImageSearchDrawer";var w=(0,L.default)((0,M.default)(O));t.default=w},10242:(e,t,a)=>{"use strict";var l=a(20862),s=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(a(94184)),r=l(a(67294)),n=s(a(3395)),o=s(a(34727)),d=l(a(85002)),u=s(a(66761)),c=a(13960),f=l(a(66375)),h=s(a(45227)),p=s(a(17363)),m=s(a(62745));class v extends r.Component{constructor(...e){super(...e),this.state={hover:!1},this.onClick=()=>{this.props.onUpdateColor({id:this.props.labelId,color:this.props.colorInt},f.LABEL_PROPERTIES.COLOR),this.props.onBack()},this._disableHover=()=>{this.state.hover&&this.setState({hover:!1})},this._enableHover=()=>{this.state.hover||this.setState({hover:!0})}}render(){var e=this.props.isSelected?r.default.createElement(m.default,{name:"checkmark-medium"}):null,t=(0,i.default)(h.default.wallpaperColorCanvas,{[h.default.canvasHover]:this.state.hover,[h.default.canvasActive]:this.props.isSelected});return r.default.createElement("span",{className:t,style:{backgroundColor:(0,c.intColorToHex)(this.props.colorInt)},onMouseOver:this._enableHover,onMouseEnter:this._enableHover,onMouseLeave:this._disableHover,onClick:this.onClick},e)}}v.displayName="ColorCanvas";class g extends r.Component{render(){for(var{currentColor:e,colors:t}=this.props,a=t.map((t=>r.default.createElement(v,{onUpdateColor:this.props.onUpdateColor,colorInt:t,onBack:this.props.onBack,labelId:this.props.labelId,isSelected:e===t,key:t}))),l=0;l<2;l++)a.push(r.default.createElement("div",{key:"emptyEl"+l,className:h.default.wallpaperColorEmpty}));return a}}g.displayName="ColorGrid";class E extends r.Component{constructor(){super(),this._getColorPromise=null,this.state={colors:f.default.labelColorPalette&&f.default.labelColorPalette.colors}}componentWillUnmount(){this._getColorPromise&&this._getColorPromise.cancel()}render(){var e=r.default.createElement(p.default,{stroke:6,size:24});return this.state.colors?e=r.default.createElement(g,{labelId:this.props.labelId,onBack:this.props.onClose,onUpdateColor:this.props.onUpdateColor,colors:this.state.colors,currentColor:this.props.currentColor}):(this._getColorPromise=f.default.getLabelColorPalette(),this._getColorPromise.cancellable().then((e=>{this.setState({colors:e})}))),r.default.createElement(n.default,null,r.default.createElement(d.default,{theme:this.state.colors?void 0:"center-content",title:u.default.t(907),onBack:this.props.onClose,type:d.DRAWER_HEADER_TYPE.LARGE}),r.default.createElement(o.default,null,r.default.createElement("div",{className:h.default.container},e)))}}t.default=E,E.displayName="LabelColorDrawer"},87096:(e,t,a)=>{"use strict";var l=a(95318),s=a(20862);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(a(67294)),r=l(a(97420)),n=l(a(58743)),o=l(a(3395)),d=l(a(34727)),u=s(a(85002)),c=a(53615),f=l(a(66761)),h=l(a(44676)),p=a(51508),m=l(a(48878)),v=l(a(5148)),g=l(a(40822)),E=l(a(48679)),_=l(a(40469)),C=l(a(92120)),S=l(a(62745));class y extends i.PureComponent{constructor(){super(),this.onMultiSelect=()=>{var e=this.multiSelection.getSelected().length;this.setState({selectedCount:e})},this.shouldScrollIntoViewAndSelect=()=>({shouldScrollIntoView:!0,shouldSelect:!1}),this.onDeleteLabel=e=>{r.default.closeModal(),this.multiSelection.unsetAll(),this.props.onDeleteLabel(e)},this._confirmDeleteSelectedLabels=()=>{var e=this.multiSelection.getSelected();(0,p.logLabelOperationEvent)(v.default.LABEL_OPERATIONS.VIEW,e.length,v.default.LABEL_TARGETS.DELETE_LABEL_DIALOG),r.default.openModal(i.default.createElement(n.default,{okText:f.default.t(1961),cancelText:f.default.t(1821),onCancel:()=>{(0,p.logLabelOperationEvent)(v.default.LABEL_OPERATIONS.CLICK_NEGATIVE,1,v.default.LABEL_TARGETS.DELETE_LABEL_DIALOG),r.default.closeModal()},onOK:()=>{(0,p.logLabelOperationEvent)(v.default.LABEL_OPERATIONS.CLICK_POSITIVE,1,v.default.LABEL_TARGETS.DELETE_LABEL_DIALOG),this.onDeleteLabel(e)}},f.default.t(607,{_plural:e.length})))},this.onCancelSelection=()=>{this.multiSelection.unsetAll(),this.setState({selectedCount:0})},this.multiSelection=new _.default([],(e=>e.id)),this.state={selectedCount:0}}componentDidMount(){(0,p.logLabelOperationEvent)(v.default.LABEL_OPERATIONS.VIEW,void 0,v.default.LABEL_TARGETS.LABELS_SCREEN)}render(){var{selectedCount:e}=this.state,t=null;t=e>0?i.default.createElement(g.default,{selectedModels:this.multiSelection,onCancel:this.onCancelSelection,onDelete:this._confirmDeleteSelectedLabels,theme:"drawer-header"}):i.default.createElement(u.default,{title:f.default.t(917),onBack:this.props.onClose,type:u.DRAWER_HEADER_TYPE.LARGE});var a=(0,c.canEditLabel)()&&i.default.createElement("div",{className:h.default.addLabelBtContainer},i.default.createElement(C.default,{large:!0,onClick:this.props.openAddLabel},i.default.createElement(S.default,{name:"plus-large"})));return i.default.createElement(o.default,{theme:"settings"},t,i.default.createElement(d.default,null,i.default.createElement(E.default,{shouldScrollIntoViewAndSelect:this.shouldScrollIntoViewAndSelect,selectedLabels:this.multiSelection,renderContext:"label-list",onMultiSelect:this.onMultiSelect,onLabelClick:this.props.onLabelClick})),a)}}y.displayName="LabelDrawer";var I=(0,m.default)(y);t.default=I},63873:(e,t,a)=>{"use strict";var l=a(95318),s=a(20862);t.Z=void 0;var i=s(a(67294)),r=l(a(66737)),n=l(a(97420)),o=l(a(58743)),d=l(a(3395)),u=l(a(34727)),c=s(a(85002)),f=l(a(68770)),h=l(a(59474)),p=a(53615),m=l(a(66761)),v=l(a(66375)),g=a(51508),E=l(a(28113)),_=l(a(48878)),C=a(3875),S=l(a(5148)),y=l(a(40822)),I=l(a(94490)),M=l(a(40469)),P=l(a(87642)),L=l(a(62745));function T({openColorPicker:e,openEditLabel:t}){return(0,p.canEditLabel)()?i.default.createElement(C.MenuBarItem,{a8nText:"starred-menu",icon:i.default.createElement(L.default,{name:"menu"}),title:m.default.t(1028)},i.default.createElement(f.default,{type:"dropdown_menu",flipOnRTL:!0,key:"labelChooseColor",dirX:"LEFT"},i.default.createElement(h.default,{a8n:"menu-item",action:e},m.default.t(907)),i.default.createElement(h.default,{a8n:"menu-item",action:t},m.default.t(644)))):null}class b extends i.PureComponent{constructor(){super(),this._openColorPicker=()=>{var{labelId:e}=this.props,t=v.default.assertGet(e);this.props.openLabelColorDrawer(this.props.labelId,t.color)},this._openEditLabel=()=>{this.props.onEditLabel&&this.props.onEditLabel(this.props.labelId)},this.onCancelLabelSelection=()=>{this.multiSelection.unsetAll()},this.onRemoveLabel=()=>{var e=this.multiSelection.getSelected(),{onRemoveLabel:t,labelId:a}=this.props;if(t){var l=v.default.assertGet(a);(0,g.logLabelOperationEvent)(S.default.LABEL_OPERATIONS.VIEW,e.length,S.default.LABEL_TARGETS.BULK_UNLABEL_DIALOG),n.default.openModal(i.default.createElement(o.default,{title:m.default.t(1287,{count:e.length,labelName:l.name,_plural:e.length}),okText:m.default.t(1826),cancelText:m.default.t(1657),onCancel:this._closeModal,onOK:this._onRemoveLabelConfirmed.bind(null,a,e)}))}},this._closeModal=()=>{var e=this.multiSelection.getSelected();(0,g.logLabelOperationEvent)(S.default.LABEL_OPERATIONS.CLICK_NEGATIVE,e.length,S.default.LABEL_TARGETS.BULK_UNLABEL_DIALOG),n.default.closeModal()},this._onRemoveLabelConfirmed=(e,t)=>{n.default.closeModal(),this.onCancelLabelSelection(),this.props.onRemoveLabel(e,t),(0,g.logLabelOperationEvent)(S.default.LABEL_OPERATIONS.CLICK_POSITIVE,t.length,S.default.LABEL_TARGETS.BULK_UNLABEL_DIALOG)},this.multiSelection=new M.default([],(e=>e.id.toString()))}componentDidMount(){this.props.listeners.add(this.multiSelection,"all",(()=>this.forceUpdate())),(0,g.logLabelOperationEvent)(S.default.LABEL_OPERATIONS.VIEW,void 0,S.default.LABEL_TARGETS.LABEL_DETAILS_SCREEN)}_hasMixedSelection(e){for(var t,a,l=0;l<e.length;l++){if(e[l]instanceof I.default?a=!0:t=!0,t&&a)return!0}return!1}render(){var e=this.multiSelection.getSelected(),t=this._hasMixedSelection(e),a=this.multiSelection.getSelected().length>0?i.default.createElement(y.default,{labelEditEnabled:!t,onRemoveLabel:this.onRemoveLabel,selectedModels:this.multiSelection,onCancel:this.onCancelLabelSelection,theme:"drawer-header"}):i.default.createElement(c.default,{onBack:this.props.onClose,menu:i.default.createElement(T,{openColorPicker:this._openColorPicker,openEditLabel:this._openEditLabel}),type:c.DRAWER_HEADER_TYPE.LABELS},i.default.createElement(E.default,{labels:[this.props.labelId],renderAsCircle:!0,showName:!0,theme:"drawer-title"}));return i.default.createElement(d.default,{theme:"settings"},a,i.default.createElement(u.default,null,i.default.createElement(r.default,{hideMultiSelectBar:!0,multiSelection:this.multiSelection,labelFilter:this.props.labelId,settings:P.default,selectable:!0})))}}b.displayName="LabelItemDrawer";var D=(0,_.default)(b);t.Z=D},92649:(e,t,a)=>{"use strict";var l=a(95318),s=a(20862);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(a(67294)),r=l(a(97420)),n=l(a(58743)),o=l(a(66761)),d=l(a(64677)),u=a(18467),c=l(a(17363)),f=a(45739);class h extends i.Component{constructor(...e){super(...e),this.state={licensesText:void 0},this.onOk=()=>{this.props.onOk&&this.props.onOk(),r.default.closeModal()}}componentDidMount(){}render(){var e,t;return this.state.licensesText||(e=i.default.createElement("div",{className:d.default.spinner,key:"spinner"},i.default.createElement(c.default,{size:50,stroke:4}))),this.state.licensesText&&(t=i.default.createElement("div",{className:d.default.textContainer},this.state.licensesText)),i.default.createElement(n.default,{okText:o.default.t(1826),onOK:this.onOk,type:u.FlexModalType},i.default.createElement("div",{className:d.default.container},i.default.createElement(f.TextSpan,{theme:"popup-title"},o.default.t(920)),t,e))}}t.default=h,h.displayName="LicensesPopup"},29475:(e,t,a)=>{"use strict";var l=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.ID_SEPARATOR=void 0;var s=l(a(91828)),i=a(18456);t.ID_SEPARATOR=",";t.default=class{constructor(...e){this.participants=new s.default,e.forEach((e=>this.add(e)))}get id(){return this.participants.map((({id:e})=>e.toString())).join(",")}get center(){var e=this.participants.map((({lat:e})=>e)),t=this.participants.map((({lng:e})=>e));return{lat:(Math.min(...e)+Math.max(...e))/2,lng:(Math.min(...t)+Math.max(...t))/2}}get lat(){return this.center.lat}get lng(){return this.center.lng}get length(){return this.participants.length}get northeast(){var e=this.participants.map((({lat:e})=>e)),t=this.participants.map((({lng:e})=>e));return{lat:Math.max(...e),lng:Math.max(...t)}}get southwest(){var e=this.participants.map((({lat:e})=>e)),t=this.participants.map((({lng:e})=>e));return{lat:Math.min(...e),lng:Math.min(...t)}}add(e){this.participants.add(e)}hasSingleParticipant(){return 1===this.length}fits(e,t,a){var{lat:l,lng:s}=this.center,{lat:r,lng:n}=e,o=(0,i.getMetersBetweenLatLngs)(l,s,l,n),d=(0,i.getMetersBetweenLatLngs)(l,s,r,s),u=(0,i.getMetersPerPixel)(l,t);return o/u<=a&&d/u<=a}}},46831:(e,t,a)=>{"use strict";var l=a(95318),s=a(20862);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(a(67294)),r=l(a(14395)),n=l(a(27890)),o=l(a(2689)),d=l(a(47060)),u=l(a(3152)),c=l(a(12063)),f=l(a(66761)),h=l(a(23045)),p=l(a(62745)),m=l(a(72635));class v extends i.Component{constructor(...e){super(...e),this.flatListController=new c.default,this.renderListItem=e=>{var{participant:t}=e,a=t.isMe?i.default.createElement("div",{className:r.default.time},i.default.createElement(o.default,{reason:"live-location-time"},i.default.createElement(m.default,{participant:t}))):null;return i.default.createElement("div",{className:r.default.item,onClick:()=>this.props.onParticipantSelected(t.contact.id.toString())},i.default.createElement("div",{className:r.default.left},i.default.createElement(n.default,{id:t.contact.id,size:28})),i.default.createElement("div",{className:r.default.right},i.default.createElement("div",{className:r.default.name},i.default.createElement(h.default,{contact:t.contact,titlify:!0,ellipsify:!0,you:!0})),a))}}getListData(){return this.props.participants.map((e=>({itemKey:e.id.toString(),participant:e})))}render(){return i.default.createElement("div",{className:r.default.container},i.default.createElement("div",{className:r.default.header},i.default.createElement("div",{className:r.default.left},i.default.createElement("span",{className:r.default.close,onClick:this.props.onClearSelected},i.default.createElement(p.default,{name:"x"}))),i.default.createElement("div",{className:r.default.right},f.default.t(926,{count:this.props.participants.length,_plural:this.props.participants.length}))),i.default.createElement(u.default,{className:r.default.list,flatListControllers:[this.flatListController]},i.default.createElement(d.default,{data:this.getListData(),flatListController:this.flatListController,direction:"vertical",defaultItemHeight:48,renderItem:this.renderListItem})))}}t.default=v,v.displayName="LiveLocationClusterList"},86996:(e,t,a)=>{"use strict";var l=a(20862),s=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a,l){var s=new Map;if(!e.length)return s;for(var n=e.filter((e=>e!==a)).sort(((e,t)=>e.lat-t.lat)),o=function(e){var a=n[e],o=void 0;if(s.forEach((e=>{!o&&e.fits(a,t,l)&&(o=e)})),o){var d=o,u=o.id;s.delete(u),d.add(a)}else o=new r.default(a);s.set((0,i.default)(o,"clusterToAdd").id,(0,i.default)(o,"clusterToAdd"))},d=0;d<n.length;d++)o(d);if(a&&e.length!==n.length){var u=new r.default(a);s.set(u.id,u)}return s},t.participantInCluster=function(e,t){return e.split(r.ID_SEPARATOR).includes(t.toString())},t.singleParticipantClusterId=function(e){return!e.includes(r.ID_SEPARATOR)},t.findClusterForParticipant=function(e,t){var a,l=e.values();for(;(a=l.next())&&!a.done;){var s=a.value;if(s.participants.get(t))return s}return null};var i=s(a(96391)),r=l(a(29475))},64109:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getSmallestElapsedTime=a,t.isStale=function(e){return a(e)>=600},t.MARKER_SIZE=t.AVATAR_SIZE=t.PIN_SIZE=t.GLOW_SIZE=t.IMAGE_BORDER_SIZE=t.IMAGE_SIZE=t.STALE_THRESHOLD=void 0;t.STALE_THRESHOLD=600;t.IMAGE_SIZE=40;t.IMAGE_BORDER_SIZE=2;t.GLOW_SIZE=4;t.PIN_SIZE=4;t.AVATAR_SIZE=44;function a(e){var t=e.participants.map((e=>e.elapsedTime()));return Math.min(...t)}t.MARKER_SIZE=52},84404:(e,t,a)=>{"use strict";var l=a(95318),s=a(20862);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(a(67294)),r=l(a(56656)),n=l(a(3395)),o=l(a(34727)),d=s(a(85002)),u=l(a(28204)),c=l(a(34600)),f=l(a(66761)),h=l(a(48878)),p=l(a(11103)),m=a(81803),v=l(a(42753)),g=l(a(96361)),E=l(a(82286)),_=l(a(62745));class C extends i.PureComponent{constructor(e){super(e),this.onClose=()=>{this.props.onClose?this.props.onClose():this.props.uim.uie.requestDismiss()},this.onRoadmapSelected=()=>{this.setState({mapType:m.MapType.ROADMAP})},this.onSatelliteSelected=()=>{this.setState({mapType:m.MapType.SATELLITE})},this.onTerrainSelected=()=>{this.setState({mapType:m.MapType.TERRAIN})},this.onTrafficToggled=()=>{this.setState((e=>({showTraffic:!e.showTraffic})))},this.onMarkerSelected=e=>{this.setState({markerSelected:e})},this.state={mapType:m.MapType.ROADMAP,showTraffic:!1,markerSelected:!1,online:g.default.online}}componentDidMount(){this.props.listeners.add(g.default,"change:online",(()=>{this.setState({online:g.default.online})}))}render(){var e,t,a,l,s=i.default.createElement(v.default,{onRoadmapSelected:this.onRoadmapSelected,onSatelliteSelected:this.onSatelliteSelected,onTerrainSelected:this.onTerrainSelected,onTrafficToggled:this.onTrafficToggled,showTraffic:this.state.showTraffic}),{finalLat:u,finalLng:h,finalTimeOffset:m,lat:g,lng:E,senderObj:C,t:S}=this.props.msg,{mapType:y,showTraffic:I,markerSelected:M,online:P}=this.state;return void 0===u||void 0===h||void 0===m?(e=g,t=E,a=S):(e=u,t=h,a=S+m),l=P?i.default.createElement("div",{className:c.default.wrapper},i.default.createElement(p.default,{contact:C,lat:e,lng:t,mapType:y,showTraffic:I,markerSelected:M,onMarkerSelected:this.onMarkerSelected}),i.default.createElement("div",{className:c.default.notification},i.default.createElement("div",{className:c.default.ended},f.default.t(927)),i.default.createElement("div",{className:c.default.lastUpdated},r.default.liveLocationLastUpdatedStr(a)))):i.default.createElement("div",{className:c.default.offline},i.default.createElement("div",null,i.default.createElement("div",{className:c.default.circle},i.default.createElement(_.default,{name:"live-location-disconnected"})),i.default.createElement("div",{className:c.default.text},f.default.t(974)))),i.default.createElement(n.default,null,i.default.createElement(d.default,{title:f.default.t(928),type:d.DRAWER_HEADER_TYPE.SMALL,menu:s,onCancel:this.onClose}),i.default.createElement(o.default,null,l))}}C.CONCERNS={msg:["finalLat","finalLng","finalTimeOffset","lat","lng","senderObj","t"]},C.displayName="ExpiredLocationDrawer";var S=(0,u.default)((0,h.default)((0,E.default)(C,C.CONCERNS)));t.default=S},11103:(e,t,a)=>{"use strict";var l=a(95318),s=a(20862);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(20014),r=s(a(67294)),n=a(33458),o=a(81803),d=l(a(52566));class u extends r.Component{constructor(e){super(e),this.setMap=e=>this.map=e,this.mapOnClick=()=>{this.dismissMarkerTimer.debounceAndCap(50,100)},this.markerOnClick=()=>{this.dismissMarkerTimer.isScheduled()&&this.dismissMarkerTimer.cancel(),this.props.onMarkerSelected(!0)},this.getPixelPositionOffset=(e,t)=>({x:-e/2,y:-t}),this.dismissMarkerTimer=new i.ShiftTimer((()=>{this.props.markerSelected&&this.props.onMarkerSelected(!1)}))}componentWillUnmount(){this.dismissMarkerTimer.isScheduled()&&this.dismissMarkerTimer.cancel()}getMapPaneName(){return n.OverlayView.OVERLAY_MOUSE_TARGET}getMarkers(){var{lat:e,lng:t,contact:a,markerSelected:l}=this.props;return r.default.createElement(d.default,{marker:{isLive:!1,contact:a,lat:e,lng:t,selected:l,onClick:e=>this.markerOnClick(e)}})}getTrafficLayer(){return this.props.showTraffic?r.default.createElement(n.TrafficLayer,{autoRefresh:!0}):null}render(){var{lat:e,lng:t}=this.props;return r.default.createElement(n.GoogleMap,{ref:this.setMap,defaultCenter:{lat:e,lng:t},defaultOptions:this.props.getMapOptions(),defaultZoom:o.INITIAL_ZOOM,mapTypeId:this.props.mapType,onClick:this.mapOnClick},this.getMarkers(),this.getTrafficLayer())}}u.displayName="ExpiredLocationMap";var c=(0,o.withConfig)((0,n.withScriptjs)((0,n.withGoogleMap)(u)));t.default=c},24110:(e,t,a)=>{"use strict";var l=a(20862),s=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(a(41609)),r=s(a(23493)),n=s(a(94184)),o=l(a(67294)),d=s(a(46831)),u=l(a(86996)),c=s(a(97420)),f=a(64109),h=s(a(3395)),p=s(a(34727)),m=l(a(85002)),v=s(a(28204)),g=s(a(85529)),E=s(a(66761)),_=s(a(48878)),C=s(a(92152)),S=s(a(83340)),y=a(81803),I=s(a(42753)),M=s(a(96361)),P=s(a(77771)),L=s(a(17427)),T=s(a(82286)),b=a(79665),D=s(a(62745)),N=s(a(10937)),O=l(a(9931)),w=s(a(43501)),k=a(32991),R=["click","mousedown","mousemove","scroll"],A="ACTIVE",x="INACTIVE",F="OFFLINE";class U extends o.PureComponent{constructor(e){super(e),this._onParticipantAdd=()=>{var{zoomLevel:e,selectedParticipantId:t}=this.state;this._updateMinZoomClusters(),this.setState({clusters:this._getClusters(e,t)})},this.onParticipantRemove=e=>{var{selectedClusterId:t,selectedParticipantId:a,zoomLevel:l}=this.state;this._updateMinZoomClusters();var s=t,i=a;t&&(0,u.participantInCluster)(t,e.id)&&(s=null),w.default.equals(a,e.id)&&(i=null),this.setState({selectedClusterId:s,selectedParticipantId:i,clusters:this._getClusters(l,i)})},this._onParticipantDisable=e=>{if(!e.isMe){var t=e.contact.formattedName;c.default.openToast(o.default.createElement(O.default,{msg:E.default.t(951,{name:t}),id:(0,O.genId)()}))}},this.onLocationChanged=()=>{var{zoomLevel:e,selectedParticipantId:t}=this.state;this._updateMinZoomClusters(),this.setState({clusters:this._getClusters(e,t)})},this.onIdle=()=>{var{liveLocation:e}=this.props.chat;e&&(e.stopViewingMap(),this.setState({status:x}))},this.onActivity=(0,r.default)((()=>{this._removeIdleTimeout(),this._addIdleTimeout()}),250),this._onRefresh=()=>{var{liveLocation:e}=this.props.chat;e&&(e.startViewingMap(),this.setState({status:A}))},this.onClose=()=>{this.props.onClose?this.props.onClose():this.props.uim.uie.requestDismiss()},this.onMarkerSelected=e=>{e?(0,u.singleParticipantClusterId)(e)?this.onParticipantSelected(e):this._onClusterSelected(e):this.onClearSelected()},this.onClearSelected=()=>{var{selectedParticipantId:e,selectedClusterId:t,zoomLevel:a}=this.state;(e||t)&&this.setState({selectedParticipantId:null,selectedClusterId:null,clusters:this._getClusters(a)})},this._onClusterSelected=e=>{this.state.selectedClusterId!==e&&this.setState({selectedParticipantId:null,selectedClusterId:e})},this.onParticipantSelected=e=>{var{selectedParticipantId:t,zoomLevel:a}=this.state,l=(0,k.createWid)(e);w.default.equals(t,l)||this.setState({selectedParticipantId:l,selectedClusterId:null,clusters:this._getClusters(a,l)})},this.onStopSharing=e=>{e.preventDefault(),e.stopPropagation();var{chat:t}=this.props;c.default.openModal(o.default.createElement(C.default,{chat:t}))},this.onRoadmapSelected=()=>{this.setState({mapType:y.MapType.ROADMAP})},this.onSatelliteSelected=()=>{this.setState({mapType:y.MapType.SATELLITE})},this.onTerrainSelected=()=>{this.setState({mapType:y.MapType.TERRAIN})},this.onTrafficToggled=()=>{this.setState((e=>({showTraffic:!e.showTraffic})))},this._onBackToCenter=()=>{this.setState({selectedParticipantId:null,selectedClusterId:null,atCenter:!0,clusters:this._getClusters(this.state.zoomLevel)})},this.onMapMoved=(e,t)=>{this.setState((a=>{var l={};if(a.zoomLevel!==e){var s=this._getClusters(e,a.selectedParticipantId);Object.assign(l,{zoomLevel:e,clusters:s})}return this._hasValidParticipants()&&a.atCenter!==t&&Object.assign(l,{atCenter:t}),(0,i.default)(l)?null:l}))},this._updateMinZoomClusters(),this.state={clusters:this._getClusters(y.INITIAL_ZOOM),selectedClusterId:null,selectedParticipantId:null,mapType:y.MapType.ROADMAP,showTraffic:!1,zoomLevel:y.INITIAL_ZOOM,atCenter:!0,status:M.default.online?A:F}}componentDidMount(){this._listenToModelChange(),this._listenToNetworkChange(),this._startCheckingForIdle();var{liveLocation:e}=this.props.chat;e&&(e.startViewingMap(),this._addParticipantListeners(e))}componentWillUnmount(){this.onActivity.cancel();var{liveLocation:e}=this.props.chat;e&&e.stopViewingMap()}_addParticipantListeners(e){this.props.listeners.add(e.participants,"add",this._onParticipantAdd),this.props.listeners.add(e.participants,"remove",this.onParticipantRemove),this.props.listeners.add(e.participants,"change:disabled",this._onParticipantDisable),this.props.listeners.add(e.participants,"change:valid",this.onLocationChanged)}_removeParticipantListeners(e){this.props.listeners.remove(e.participants,"add",this._onParticipantAdd),this.props.listeners.remove(e.participants,"remove",this.onParticipantRemove),this.props.listeners.remove(e.participants,"change:disabled",this._onParticipantDisable),this.props.listeners.remove(e.participants,"change:valid",this.onLocationChanged)}_listenToModelChange(){var{chat:e}=this.props;this.props.listeners.add((0,b.unproxy)(e),"change:liveLocation",(()=>{var{liveLocation:t}=e;t&&(this._removeParticipantListeners(t),this._addParticipantListeners(t));var{zoomLevel:a}=this.state;this.setState({clusters:this._getClusters(a)})}))}_listenToNetworkChange(){this.props.listeners.add(M.default,"change:online",(()=>{M.default.online||this._stopCheckingForIdle(),this.setState({status:M.default.online?A:F})}))}_startCheckingForIdle(){this._addIdleTimeout(),this._addActivityListeners()}_stopCheckingForIdle(){this._removeIdleTimeout(),this._removeActivityListeners()}_addIdleTimeout(){this._idleTimeoutId=this.props.setTimeout(this.onIdle,18e4)}_removeIdleTimeout(){null!=this._idleTimeoutId&&this.props.clearTimeout(this._idleTimeoutId),this._idleTimeoutId=null}_addActivityListeners(){R.forEach((e=>{this.props.listeners.add(document,e,this.onActivity)}))}_removeActivityListeners(){R.forEach((e=>{this.props.listeners.remove(document,e,this.onActivity)}))}_updateMinZoomClusters(){var e=this.getParticipants(),t=e?e.validLocations():[];this._minZoomClusters=(0,u.default)(t,y.MIN_ZOOM,null,f.MARKER_SIZE)}getParticipants(){var{liveLocation:e}=this.props.chat;return e?e.participants:null}_hasValidParticipants(){var e=this.getParticipants();return!!e&&!!e.validLocations().length}_getOpenFromCluster(){var e=this.getParticipants();if(!e||0===e.length)return null;var{openFrom:t}=this.props,a=null;if(t)a=t;else{var l=e.at(0);l&&(a=l.id)}return a?(0,u.findClusterForParticipant)(this._minZoomClusters,a):null}_getClusters(e,t){var a=this.getParticipants(),l=null,s=[];a&&(t&&(l=a.get(t)),s=a.validLocations());var i=s,r=[];if(this._minZoomClusters.size>1){var n=this._getOpenFromCluster();if(n){var o=n.participants;i=o.validLocations(),r=s.filter((({id:e})=>!o.get(e)))}}return{primary:(0,u.default)(i,e,l,f.MARKER_SIZE),secondary:(0,u.default)(r,e,l,f.MARKER_SIZE)}}_getList(){var e,{clusters:t,selectedClusterId:a}=this.state,l=this.getParticipants();if(l&&l.length){if(a){var s=t.primary.get(a)||t.secondary.get(a);if(s){var i=s.participants;e=o.default.createElement(d.default,{participants:i,onParticipantSelected:this.onParticipantSelected,onClearSelected:this.onClearSelected})}}e||(e=o.default.createElement(P.default,{participants:l,onParticipantSelected:this.onParticipantSelected,onStopSharing:this.onStopSharing}))}return e}render(){var e,t;this.props.isFirstLevel?e=this.onClose:t=this.onClose;var a,l,{selectedParticipantId:s,selectedClusterId:i,mapType:r,showTraffic:d,atCenter:u,status:c}=this.state,f=c===A?o.default.createElement(I.default,{onRoadmapSelected:this.onRoadmapSelected,onSatelliteSelected:this.onSatelliteSelected,onTerrainSelected:this.onTerrainSelected,onTrafficToggled:this.onTrafficToggled,showTraffic:d}):null;if(c===A||c===x){var v=s&&s.toString()||i;a=o.default.createElement("div",{className:g.default.wrapper},o.default.createElement("div",{className:(0,n.default)(g.default.backToCenter,{[g.default.visible]:!u}),onClick:this._onBackToCenter},o.default.createElement(D.default,{name:"return"})),o.default.createElement(S.default,{clusters:this.state.clusters.primary,secondaryClusters:this.state.clusters.secondary,selectedMarkerId:v,openFrom:this.props.openFrom,mapType:r,showTraffic:d,atCenter:u,onMarkerSelected:this.onMarkerSelected,onClearSelected:this.onClearSelected,onLocationChanged:this.onLocationChanged,onMapMoved:this.onMapMoved}),this._getList())}if(c===x||c===F){var _=c===x,C=_?"live-location-refresh":"live-location-disconnected",y=_?E.default.t(939):E.default.t(974);l=o.default.createElement(L.default,{inactive:_,svgName:C,text:y,onClick:_?this._onRefresh:void 0})}return o.default.createElement(h.default,null,o.default.createElement(m.default,{title:E.default.t(952),type:m.DRAWER_HEADER_TYPE.SMALL,menu:f,onBack:t,onCancel:e}),o.default.createElement(p.default,null,a,l))}}U.CONCERNS={chat:["id","liveLocation"]},U.displayName="LiveLocationDrawer";var B=(0,v.default)((0,N.default)((0,_.default)((0,T.default)(U,U.CONCERNS))));t.default=B},83340:(e,t,a)=>{"use strict";var l=a(20862),s=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(a(23279)),r=a(20014),n=l(a(67294)),o=a(33458),d=a(81803),u=s(a(52566)),c=a(18456),f=1e-4;class h extends n.Component{constructor(e){super(e),this.setMap=e=>this.map=e,this.onLocationChanged=e=>{var{clusters:t,atCenter:a,selectedMarkerId:l}=this.props;if(this.props.onLocationChanged(),!l&&a)this._viewAllClusters();else if(l&&l===e){var s=t.get(l);s&&this._viewSingleCluster(s)}},this.onIdle=(0,i.default)((()=>{var e=this.map;if(e){var t=e.getZoom();if(this._zoomingToAllClusters){this._defaultZoomLevel=t,this._zoomingToAllClusters=!1;var a=this._zoomHistory;if(a.prev.preZoom===a.curr.postZoom&&a.prev.postZoom===a.curr.preZoom)return}this.props.onMapMoved(t,this.atCenter())}}),100),this.onDragStart=()=>{var e=this.map;if(e){var t=e.getZoom();this.props.onMapMoved(t,!1)}},this.onResize=(0,i.default)((()=>{this._setMapLatLngDiff()}),250),this.mapOnClick=()=>{this.dismissMarkerTimer.debounceAndCap(50,100)},this.markerOnClick=(e,t)=>{this.dismissMarkerTimer.isScheduled()&&this.dismissMarkerTimer.cancel(),this.props.onMarkerSelected(t)},this.dismissMarkerTimer=new r.ShiftTimer((()=>{this.props.selectedMarkerId&&this.props.onClearSelected()})),this._defaultLatDiff=this._defaultLngDiff=.01,this._defaultZoomLevel=-1,this._zoomingToAllClusters=!1,this._zoomHistory={prev:{preZoom:-1,postZoom:-1},curr:{preZoom:-1,postZoom:-1}}}componentWillUnmount(){this.onIdle.cancel(),this.onResize.cancel(),window.removeEventListener("resize",this.onResize),this.dismissMarkerTimer.isScheduled()&&this.dismissMarkerTimer.cancel()}componentDidMount(){window.addEventListener("resize",this.onResize),this._setMapLatLngDiff(),this._viewAllClusters()}componentDidUpdate(e){var{clusters:t,secondaryClusters:a,selectedMarkerId:l,atCenter:s}=this.props,{selectedMarkerId:i}=e;if(this._setMapLatLngDiff(),t.size&&(!i||l||s))if(l&&i!==l){var r=t.get(l)||a.get(l);r&&this._viewSingleCluster(r)}else!l&&s&&this._viewAllClusters()}_viewAllClusters(){var{clusters:e}=this.props;0===e.size||this.atCenter()||(this._zoomToFitAllClusters(e),this._centerAllClusters(e))}_viewSingleCluster(e){this._zoomToFitSingleCluster(e),this._centerSingleCluster(e)}_zoomToFitAllClusters(e){var t=this.map;if(t){this._zoomingToAllClusters=!0,this._zoomHistory.prev.preZoom=this._zoomHistory.curr.preZoom,this._zoomHistory.curr.preZoom=t.getZoom();var a=this.getBounds(e),l=e.entries().next();if(1!==e.size||l.done)this._boundsTooSmall(a)?t.fitBounds(this._getDefaultBounds(a.getCenter())):t.fitBounds(a);else{var[,s]=l.value;this._zoomToFitSingleCluster(s,!1)}this._zoomHistory.prev.postZoom=this._zoomHistory.curr.postZoom,this._zoomHistory.curr.postZoom=t.getZoom()}}_zoomToFitSingleCluster(e,t=!0){var a=this.map;if(a&&(!t||!this._boundsTooSmall(a.getBounds()))){var l=e.northeast,s=e.southwest,i=new google.maps.LatLng(l.lat,l.lng),r=new google.maps.LatLng(s.lat,s.lng),n=new google.maps.LatLngBounds(r,i);this._boundsTooSmall(n)?a.fitBounds(this._getDefaultBounds(n.getCenter())):a.fitBounds(n)}}_centerAllClusters(e){var t=this.getBounds(e).getCenter();this._centerMap(t)}_centerSingleCluster(e){var t=new google.maps.LatLng(e.center);this._centerMap(t)}_centerMap(e){var t=this.map;t&&(t.getCenter().equals(e)||t.panTo(e))}_getInitialCenter(){return this.getBounds(this.props.clusters).getCenter()}getBounds(e){var t=new google.maps.LatLngBounds;return e.forEach((e=>{t.extend({lat:e.lat,lng:e.lng})})),t}_boundsTooSmall(e){var t=e.getNorthEast(),a=e.getSouthWest(),l=t.lat()-a.lat(),s=t.lng()-a.lng(),i=Math.abs(l)<this._defaultLatDiff,r=Math.abs(s)<this._defaultLngDiff;return i||r}_getDefaultBounds(e){var t=new google.maps.LatLng(e.lat()-this._defaultLatDiff/2,e.lng()-this._defaultLngDiff/2),a=new google.maps.LatLng(e.lat()+this._defaultLatDiff/2,e.lng()+this._defaultLngDiff/2);return new google.maps.LatLngBounds(t,a)}atCenter(){var e=this.map;if(!e)return!0;var t=e.getCenter(),a=this._getInitialCenter(),l=t.lat()-a.lat(),s=t.lng()-a.lng();return Math.abs(l)<f&&Math.abs(s)<f&&this._defaultZoomLevel===e.getZoom()}_setMapLatLngDiff(){var e=this.map;if(e){var t=e.getCenter(),a=e.getDiv(),l=(0,c.getMetersPerPixel)(t.lat(),d.INITIAL_ZOOM),s=a.offsetWidth*l,i=a.offsetHeight*l;this._defaultLatDiff=(0,c.getLatDiff)(i),this._defaultLngDiff=(0,c.getLngDiff)(s,t.lat())}}getMarkers(){var{clusters:e,secondaryClusters:t,selectedMarkerId:a}=this.props,l=[],s=(e,t)=>{l.push(n.default.createElement(u.default,{key:t,marker:{isLive:!0,cluster:e,onLocationChanged:()=>this.onLocationChanged(t),selected:a===t,onClick:e=>this.markerOnClick(e,t)}}))};return e.forEach(s),t.forEach(s),l}getTrafficLayer(){return this.props.showTraffic?n.default.createElement(o.TrafficLayer,{autoRefresh:!0}):null}render(){return n.default.createElement(o.GoogleMap,{ref:this.setMap,defaultCenter:this._getInitialCenter(),defaultOptions:this.props.getMapOptions(),defaultZoom:d.INITIAL_ZOOM,mapTypeId:this.props.mapType,onClick:this.mapOnClick,onDragStart:this.onDragStart,onIdle:this.onIdle},this.getMarkers(),this.getTrafficLayer())}}h.displayName="LiveLocationMap";var p=(0,d.withConfig)((0,o.withScriptjs)((0,o.withGoogleMap)(h)));t.default=p},81803:(e,t,a)=>{"use strict";var l=a(20862),s=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.withConfig=function(e){return class extends r.Component{constructor(...e){super(...e),this.state={authFailed:!0===window.gm_authFailed},this._onAuthFailed=()=>{window.gm_authFailed=!0,this.setState({authFailed:!0});var e=this._getUrl(),t=String(d.default.googleMapsDoNotAuth),a=String(d.default.googleMapsKeyless);__LOG__(4,void 0,new Error,!0)`url: ${e}\ntarget: ${"web"}\nprops; ${t} & ${a}`,SEND_LOGS("google-map-auth-failed")}}componentDidMount(){window.gm_authFailure=this._onAuthFailed}componentWillUnmount(){window.gm_authFailure=void 0}_getUrl(){var e={client:"gme-whatsappinc",v:"3",libraries:"geometry,drawing,places",t:Math.floor(Date.now()/864e5)};return c.default.build("https://maps.googleapis.com/maps/api/js",e)}getMapOptions(){return{clickableIcons:!1,fullscreenControl:!1,keyboardShortcuts:!1,mapTypeControl:!1,minZoom:3,streetViewControl:!1,zoomControl:!0,zoomControlOptions:{position:google.maps.ControlPosition.TOP_RIGHT}}}render(){if(this.state.authFailed)return r.default.createElement("div",{className:o.default.authFailed},n.default.t(789));var t=this._getUrl(),a=r.default.createElement("div",{className:o.default.loading},r.default.createElement(u.default,{color:"highlight"})),l=r.default.createElement("div",{className:o.default.container}),s=r.default.createElement("div",{className:o.default.map});return r.default.createElement(e,(0,i.default)({googleMapURL:t,loadingElement:a,containerElement:l,mapElement:s,getMapOptions:this.getMapOptions},this.props))}}},t.MIN_ZOOM=t.INITIAL_ZOOM=t.MapType=void 0;var i=s(a(67154)),r=l(a(67294)),n=s(a(66761)),o=s(a(98057)),d=s(a(86981)),u=s(a(17363)),c=s(a(53918)),f=a(54302)({ROADMAP:"roadmap",SATELLITE:"satellite",TERRAIN:"terrain"});t.MapType=f;t.INITIAL_ZOOM=15;t.MIN_ZOOM=3},52566:(e,t,a)=>{"use strict";var l=a(20862),s=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(a(94184)),r=l(a(67294)),n=a(33458),o=s(a(5827)),d=a(64109),u=s(a(48878)),c=s(a(48347)),f=s(a(57432)),h=s(a(10937)),p=s(a(38307));class m extends r.Component{constructor(e){super(e),this._setOverlay=e=>{this.overlay=e},this.onLocationChanged=()=>{this.props.marker.isLive&&this.props.marker.onLocationChanged()},this._onLastUpdatedTimeChanged=()=>{if(this.props.marker.isLive){null!=this.timeoutId&&(this.props.clearTimeout(this.timeoutId),this.timeoutId=null);var e=(0,d.isStale)(this.props.marker.cluster);this.state.stale!==e&&this.setState({stale:e}),e||this._setStaleTimeout()}},this._getPixelPositionOffset=(e,t)=>({x:-e/2,y:-t}),this.state={stale:!e.marker.isLive||(0,d.isStale)(e.marker.cluster)}}componentDidMount(){if(this.props.marker.isLive){var{cluster:e}=this.props.marker;(0,d.isStale)(e)||this._setStaleTimeout(),e.participants.forEach((e=>{this.props.listeners.add(e,"change:lat change:lng",this.onLocationChanged),this.props.listeners.add(e,"change:lastUpdated",this._onLastUpdatedTimeChanged)}))}}_setStaleTimeout(){if(this.props.marker.isLive){var{cluster:e}=this.props.marker,t=d.STALE_THRESHOLD-(0,d.getSmallestElapsedTime)(e);t<=0||(this.timeoutId=this.props.setTimeout((()=>this.setState({stale:!0})),1e3*t))}}_getMapPaneName(){return this.props.marker.onClick?n.OverlayView.OVERLAY_MOUSE_TARGET:n.OverlayView.OVERLAY_LAYER}render(){var e,t,a,l,{onClick:s,selected:u}=this.props.marker,{stale:h}=this.state;if(this.props.marker.isLive){var{cluster:m}=this.props.marker;e=m.lat,t=m.lng,a=m.participants.map((({id:e})=>e))}else e=this.props.marker.lat,t=this.props.marker.lng,a=[this.props.marker.contact.id];if(u){var v,g,E;if(this.props.marker.isLive){var{cluster:_}=this.props.marker,C=_.participants,S=_.hasSingleParticipant()?C.at(0):null;S&&(v=S.id,g=S.accuracy,E=S.isMe)}else{var{contact:y}=this.props.marker;v=y.id,E=y.isMe}v&&(l=r.default.createElement(f.default,{id:v,lat:e,lng:t,accuracy:g,isMe:E||!1,markerSize:d.MARKER_SIZE}))}return r.default.createElement(n.OverlayView,{ref:this._setOverlay,position:{lat:e,lng:t},mapPaneName:this._getMapPaneName(),getPixelPositionOffset:this._getPixelPositionOffset},r.default.createElement(p.default.Provider,{value:this.context},r.default.createElement("div",{className:(0,i.default)(c.default.container,{[c.default.selected]:u}),onClick:s},l,r.default.createElement("div",{className:(0,i.default)(c.default.glow,{[c.default.stale]:h,[c.default.expired]:!this.props.marker.isLive}),style:{height:d.AVATAR_SIZE,width:d.AVATAR_SIZE,padding:d.GLOW_SIZE}},r.default.createElement("div",null,r.default.createElement(o.default,{ids:a,size:d.IMAGE_SIZE,border:!0,showCount:!0}))),r.default.createElement("div",{className:(0,i.default)(c.default.pin,{[c.default.selected]:u}),style:{height:d.PIN_SIZE,width:d.PIN_SIZE,marginLeft:(d.MARKER_SIZE-d.PIN_SIZE)/2}}))))}}m.contextType=p.default,m.displayName="LiveLocationMarker";var v=(0,h.default)((0,u.default)(m));t.default=v},42753:(e,t,a)=>{"use strict";var l=a(20862),s=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return i.default.createElement(d.MenuBarItem,{a8nText:"live-location-map-menu",icon:i.default.createElement(u.default,{name:"menu"}),title:o.default.t(1028)},i.default.createElement(r.default,{type:"dropdown_menu",flipOnRTL:!0,dirX:r.DirX.LEFT,dirY:r.DirY.BOTTOM},i.default.createElement(n.default,{a8n:"mi-roadmap-view menu-item",action:e.onRoadmapSelected},o.default.t(934)),i.default.createElement(n.default,{a8n:"mi-satellite-view menu-item",action:e.onSatelliteSelected},o.default.t(935)),i.default.createElement(n.default,{a8n:"mi-terrain-view menu-item",action:e.onTerrainSelected},o.default.t(936)),i.default.createElement(n.default,{a8n:"mi-traffic menu-item",action:e.onTrafficToggled},e.showTraffic?o.default.t(937):o.default.t(938))))};var i=s(a(67294)),r=l(a(68770)),n=s(a(59474)),o=s(a(66761)),d=a(3875),u=s(a(62745))},77771:(e,t,a)=>{"use strict";var l=a(95318),s=a(20862);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(a(67294)),r=l(a(84051)),n=l(a(2689)),o=l(a(47060)),d=l(a(3152)),u=l(a(12063)),c=l(a(66761)),f=l(a(67493)),h=l(a(72635));class p extends i.Component{constructor(...e){super(...e),this.flatListController=new u.default,this.renderListItem=e=>{var{participant:t}=e,a=t.valid?i.default.createElement(n.default,{reason:"live-location-time"},i.default.createElement(h.default,{participant:t})):c.default.t(960),l=t.valid?()=>this.props.onParticipantSelected(t.contact.id.toString()):null,s=t.isMe?i.default.createElement("div",{onClick:this.props.onStopSharing,className:f.default.stopSharingButton},c.default.t(950)):null;return i.default.createElement(r.default,{contact:t.contact,secondary:a,onClick:l,detail:s})}}getListData(){return this.props.participants.map((e=>({itemKey:e.id.toString(),contentKey:e.valid?"valid":"invalid",participant:e})))}render(){var e=this.getListData();return i.default.createElement(d.default,{className:f.default.list,flatListControllers:[this.flatListController]},i.default.createElement(o.default,{data:e,renderItem:this.renderListItem,flatListController:this.flatListController,direction:"vertical"}))}}p.displayName="LiveLocationParticipants";var m=p;t.default=m},57432:(e,t,a)=>{"use strict";var l=a(20862),s=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(a(94184)),r=l(a(67294)),n=s(a(18917)),o=s(a(97420)),d=s(a(64163)),u=s(a(69107)),c=s(a(59474)),f=a(91072),h=s(a(66761)),p=a(95999),m=s(a(23045)),v=s(a(85753)),g=s(a(62745)),E=s(a(47469)),_=s(a(1869));class C extends r.Component{constructor(e){super(e),this.mouseEnter=()=>{this.state.hover||this.setState({hover:!0})},this.mouseLeave=()=>{this.state.hover&&this.setState({hover:!1})},this._onDirection=()=>{var{lat:e,lng:t}=this.props;(0,f.openExternalLink)((0,p.getDirectionUrl)(e,t))},this.onMessage=()=>{var{id:e}=this.props;n.default.find(e).then((e=>{e.active&&o.default.existsDrawerRight((e=>{e&&2===d.default.column&&o.default.closeDrawerRight()})),o.default.openChatFromUnread(e).then((t=>{t&&o.default.focusChatTextInput(e)}))}))},this._onContextOpen=e=>{var t=e&&e.target;this.setState({contextMenu:{menu:this._getContextMenu(),anchor:t}})},this.onContextClose=()=>{this.setState({contextMenu:!1})},this.state={hover:!1,contextMenu:!1}}_getContextMenu(){var e=[];return e.push(r.default.createElement(c.default,{key:"direction",a8n:"get-directions",action:this._onDirection},h.default.t(763))),e.push(r.default.createElement(c.default,{key:"message",a8n:"send-message",action:this.onMessage},h.default.t(1029))),e}render(){var{id:e,accuracy:t,isMe:a,markerSize:l}=this.props,s=u.default.assertGet(e),n=r.default.createElement("div",{className:v.default.name},r.default.createElement(m.default,{ellipsify:!0,you:!0,contact:s})),o=null!=t?r.default.createElement("div",{className:v.default.status},h.default.t(925,{accuracy:t,_plural:t})):null,d=a?null:r.default.createElement("div",{onClick:this._onContextOpen,className:v.default.menuButton},r.default.createElement(g.default,{name:"down"})),c=r.default.createElement("div",{className:v.default.triangle}),f=!a&&this.state.contextMenu?r.default.createElement(E.default,{displayName:"LiveLocationPopupContextMenu",escapable:!0,popable:!0,requestDismiss:this.onContextClose},r.default.createElement(_.default,{contextMenu:this.state.contextMenu})):null;return r.default.createElement("div",{className:(0,i.default)(v.default.container,{[v.default.twoLines]:!!o}),style:{transform:`translateX(calc(-50% + ${l/2}px))`}},r.default.createElement("div",{className:v.default.popup,onMouseOver:this.mouseEnter,onMouseEnter:this.mouseEnter,onMouseDown:this.mouseLeave,onMouseUp:this.mouseEnter,onMouseLeave:this.mouseLeave},n,o,d),c,f)}}t.default=C,C.displayName="LiveLocationPopup"},17427:(e,t,a)=>{"use strict";var l=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return s.default.createElement("div",{className:e.inactive?i.default.inactive:i.default.offline,onClick:e.onClick},s.default.createElement("div",null,s.default.createElement("div",{className:i.default.circle},s.default.createElement(r.default,{name:e.svgName})),s.default.createElement("div",{className:i.default.text},e.text)))};var s=l(a(67294)),i=l(a(85529)),r=l(a(62745))},72635:(e,t,a)=>{"use strict";var l=a(95318),s=a(20862);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(a(67294)),r=l(a(66761)),n=l(a(67754)),o=a(89840),d=l(a(14173)),u=(e,t=!1)=>{var a=e;t&&(a+=59);var l=a%3600;return{hours:Math.floor(a/3600),minutes:Math.floor(l/60)}},c=e=>e.isMe?(e=>{var{hours:t,minutes:a}=u(e,!0);return t>0?a>0?r.default.t(941,{hours:t,minutes:a}):r.default.t(940,{hours:t,_plural:t}):r.default.t(942,{minutes:a,_plural:a})})(e.remainingTime()):(e=>{var{hours:t,minutes:a}=u(e);return t>0?a>0?r.default.t(954,{hours:t,minutes:a}):r.default.t(953,{hours:t,_plural:t}):a>0?r.default.t(956,{minutes:a,_plural:a}):r.default.t(955)})(e.elapsedTime()),f=e=>e.isMe?e.remainingTime():e.elapsedTime(),h=({participant:e})=>{var[t,a]=(0,i.useState)((()=>c(e))),[l,s]=(0,i.useState)((()=>f(e))),{expiration:r,lastUpdated:u}=e;(0,i.useEffect)((()=>{s(f(e)%60)}),[r,u]),(0,o.useListener)(e,e.isMe?"change:expiration":"change:lastUpdated",(e=>a(c(e))));var[h,p]=(0,n.default)((()=>a(c(e))),6e4),[m]=(0,d.default)((()=>{a(c(e)),h()}),1e3*l);return(0,i.useEffect)((()=>{p(),m()}),[l,m,p]),i.default.createElement("span",null,t)};t.default=h},18456:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getMetersBetweenLatLngs=function(e,t,s,i){var r=l(s-e),n=l(i-t),o=Math.sin(r/2)*Math.sin(r/2)+Math.cos(l(e))*Math.cos(l(s))*Math.sin(n/2)*Math.sin(n/2),d=2*Math.atan2(Math.sqrt(o),Math.sqrt(1-o));return a*d},t.getMetersPerPixel=function(e,t){var a=Math.cos(e*Math.PI/180),l=1/Math.pow(2,t);return 156543.03392*a*l},t.getLatDiff=function(e){return s(e/a)},t.getLngDiff=function(e,t){var i=a*Math.cos(l(t));return s(e/i)};var a=6371e3;function l(e){return e*(Math.PI/180)}function s(e){return e*(180/Math.PI)}},3775:(e,t,a)=>{"use strict";var l=a(20862),s=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(a(66604)),r=l(a(67294)),n=s(a(27306)),o=s(a(3395)),d=s(a(34727)),u=l(a(85002)),c=a(53615),f=s(a(66761)),h=s(a(66375)),p=a(51508),m=s(a(48878)),v=s(a(76747)),g=s(a(5148)),E=l(a(18467)),_=s(a(48679)),C=s(a(40469)),S=a(79665),y=s(a(62745)),I=0,M=1,P=2;class L extends r.Component{constructor(e){super(e),this.selectedLabels=new C.default([],(e=>e.id)),this._changeSet=new Set,this.onMultiSelect=e=>{e&&(this._initialLabelState[e]===P?this._changeSet.add("{labelId}_changed"):this._changeSet.has(e)?this._changeSet.delete(e):this._changeSet.add(e),this.forceUpdate())},this._constructLabelCountMap=()=>{var e={},{modelsToUpdate:t}=this.props;return t.forEach((t=>{var a=(0,S.unproxy)(t);a.labels&&a.labels.forEach((t=>{e[t]=e[t]?++e[t]:1}))})),e},this._onUpdateLabelsOK=()=>{(0,p.logLabelOperationEvent)(g.default.LABEL_OPERATIONS.CLICK_POSITIVE,this.props.modelsToUpdate.length,g.default.LABEL_TARGETS.LABEL_COMBINED_DIALOG);var e=this.selectedLabels.list,t=this.selectedLabels.selected,a=e.map(((e,a)=>({id:e.id,type:t[a]?"add":"remove"})));h.default.addOrRemoveLabels(a,this.props.modelsToUpdate),this.props.onLabelUpdateComplete&&this.props.onLabelUpdateComplete()};var{modelsToUpdate:t}=this.props,a=this._constructLabelCountMap();this._initialLabelState=(0,i.default)(a,(e=>e===t.length?M:e>0?P:I))}render(){var e=r.default.createElement(n.default,{a8nText:"popup-controls-ok",type:"primary",disabled:0===this._changeSet.size,onClick:this._onUpdateLabelsOK,key:1},f.default.t(1327)),t=r.default.createElement(n.default,{a8nText:"popup-controls-cancel",type:"secondary",onClick:this.props.onCancel,key:0},f.default.t(1657)),a=(0,c.canEditLabel)()&&r.default.createElement("div",{className:v.default.newLabelBtn},r.default.createElement(n.default,{a8nText:"popup-controls-cancel",type:"simplified",onClick:this.props.onAddNewLabel,key:2},r.default.createElement(y.default,{name:"plus-large",className:v.default.plus,display:"inline"}),f.default.t(218)));return r.default.createElement(E.default,{type:E.TowerModalType},r.default.createElement(o.default,{key:"mange_label_modal",theme:"labels"},r.default.createElement(u.default,{title:f.default.t(909),type:u.DRAWER_HEADER_TYPE.POPUP,onCancel:this.props.onCancel}),r.default.createElement(d.default,{"data-list-scroll-container":!0,theme:"padding"},r.default.createElement(_.default,{shouldScrollIntoViewAndSelect:this.props.shouldScrollIntoViewAndSelect,initialLabelState:this._initialLabelState,selectedLabels:this.selectedLabels,renderContext:"label-selection",onLabelClick:this.props.onLabelClick,onMultiSelect:this.onMultiSelect})),a,r.default.createElement("div",{className:v.default.actionBtns},t,e)))}}L.displayName="ManageLabelModal";var T=(0,m.default)(L);t.default=T},47029:(e,t,a)=>{"use strict";var l=a(95318),s=a(20862);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(a(67294)),r=l(a(69439)),n=l(a(3395)),o=l(a(34727)),d=s(a(85002)),u=l(a(66761)),c=(0,i.forwardRef)(((e,t)=>i.default.createElement(n.default,{ref:t},i.default.createElement(d.default,{a8n:"drawer-title-auto-download",title:u.default.t(253),onBack:e.onClose,type:d.DRAWER_HEADER_TYPE.LARGE}),i.default.createElement(o.default,null,i.default.createElement(r.default,{key:"auto-download"})))));t.default=c},67919:(e,t,a)=>{"use strict";var l=a(95318),s=a(20862);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(76304),r=s(a(67294)),n=l(a(94067)),o=l(a(53852)),d=l(a(65500));class u extends r.Component{constructor(e){super(e),this._initCanvas=()=>{var e=this.props.editedMedia.originalImage;e.complete?this.onImageLoad():e.onload=this.onImageLoad},this.onImageLoad=()=>{var e=this.props.editedMedia.editData;this.props.editedMedia.editedImage=null;var t=this.props.editedMedia.originalImage;if(e.width||e.height||(e.width=t.naturalWidth,e.height=t.naturalHeight),!e.baseItem){var a=new i.Easel.Bitmap(t);e.baseItem=a}this.drawCanvas(!0)},this._maybeInitStage=e=>{var t;return this.state.stage?t=this.state.stage:(t=new i.Easel.Stage(e)).enableMouseOver(),this.props.mediaEditController.stage=t,t},this.drawCanvas=(e,t)=>{if(this._refStaticCanvas&&this._refStaticCanvas.refCanvas){var a=this._refStaticCanvas.refCanvas;t&&this.props.mediaPickerStatsLogger&&this.props.mediaPickerStatsLogger.logChange(this.props.activeMediaId||-1,t);var l=this.props.editedMedia,s=l.editData,i=this._maybeInitStage(a);e&&(a.width=s.width,a.height=s.height),i.removeAllChildren(),null!=s.baseItem&&i.addChild(s.baseItem),s.items&&i.addChild(...s.items);var r=l.originalImage.naturalWidth,n=l.originalImage.naturalHeight;i.regX=r/2,i.regY=n/2,i.rotation=s.rotation,s.width&&s.height&&(i.x=s.width/2+s.scale*s.offsetX,i.y=s.height/2+s.scale*s.offsetY),i.scaleX=s.scale,i.scaleY=s.scale,i.update(),this.setState({canvasSize:{width:a.width,height:a.height},stage:i})}},this.saveCanvas=()=>{this.drawCanvas(!0);var e=this._refStaticCanvas&&this._refStaticCanvas.refCanvas;e&&this.props.editedMedia.saveEditsFromCanvas(e)},this.clearStage=e=>{e&&(e.children.forEach((e=>{e.removeAllEventListeners()})),e.removeAllEventListeners(),e.removeAllChildren(),e.enableMouseOver(0),e.clear())},this._setRefStaticCanvas=e=>{this._refStaticCanvas=e},this._setRefMediaContainer=e=>{this._refMediaContainer=e},this._setRefCropOverlay=e=>{this._refCropOverlay=e},this.updateCanvasSize=(e,t)=>{this.setState({canvasSize:{width:e,height:t}})},this.state={canvasSize:{height:1,width:1},stage:null,mediaContainer:null}}componentDidMount(){this._initCanvas(),this.setState({mediaContainer:this._refMediaContainer}),this.cropOverlay=new i.Easel.Stage(this._refCropOverlay),this.cropOverlay.autoClear=!1,this.cropOverlay.enableMouseOver(),this._refMediaContainer&&(this.props.mediaEditController.mediaContainer=this._refMediaContainer),this.props.mediaEditController.cropOverlay=this.cropOverlay}componentWillUnmount(){var e=this.props.editedMedia.originalImage;e.complete||(e.onload=void 0),this.saveCanvas(),this.clearStage(this.state.stage),this.clearStage(this.cropOverlay)}render(){var e=r.default.createElement("canvas",{ref:this._setRefCropOverlay,className:n.default.cropOverlay});return r.default.createElement("div",{className:this.props.className,ref:this._setRefMediaContainer},r.default.createElement(o.default,{type:this.props.fitType||"scaleDown",size:this.state.canvasSize},e,r.default.createElement(d.default,{ref:this._setRefStaticCanvas,className:n.default.mediaViewerImg})))}}t.default=u,u.displayName="MediaEditCanvas"},29809:(e,t,a)=>{"use strict";var l=a(20862);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=l(a(40798));class i extends s.default{constructor(...e){super(...e),this.stage=(0,s.prop)(),this.cropOverlay=(0,s.prop)(),this.mediaContainer=(0,s.prop)(),this.isInitialized=(0,s.derived)(this._isInitialized,["stage","cropOverlay","mediaContainer"])}_isInitialized(){return!!this.stage&&!!this.cropOverlay&&!!this.mediaContainer}clearStage(e){e&&(e.children.forEach((e=>{e.removeAllEventListeners()})),e.removeAllEventListeners(),e.removeAllChildren(),e.clear())}}var r=(0,s.defineModel)(i);t.default=r},47506:(e,t,a)=>{"use strict";var l=a(20862),s=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(a(51463)),r=l(a(67294)),n=s(a(62067)),o=a(51976),d=s(a(3395)),u=s(a(34727)),c=l(a(85002)),f=s(a(29594)),h=s(a(66761)),p=s(a(4448)),m=s(a(40794)),v=s(a(10839)),g=s(a(92120)),E=s(a(62745)),_=s(a(51231)),C=s(a(77923));class S extends r.Component{constructor(e){super(e),this.onImageSet=(e,t)=>{this.setState({thumb:e,full:t})},this.onContinue=()=>{var e=(0,f.default)(this.state.text.trim());(0,o.createGroup)(e,this.state.thumb,this.state.full,this.props.participants,this.state.dogfoodingGroupsInternalOnly),this.props.onContinue()},this.onSubjectChange=e=>{this.setState({text:e})},this.setRefEmojiInput=e=>{this.refEmojiInput=e},this._onDogfoodingGroupChange=()=>{var e=!this.state.dogfoodingGroupsInternalOnly;this.setState({dogfoodingGroupsInternalOnly:e})},this.state={text:e.subject||"",thumb:e.thumb,full:e.full,dogfoodingGroupsInternalOnly:!1}}componentDidMount(){this.refEmojiInput&&this.refEmojiInput.restoreFocus()}render(){var e=this.state.text.trim().length>0,t=e?r.default.createElement("div",{className:p.default.nextButton},r.default.createElement(g.default,{a8nText:"create-group-btn",onClick:(0,i.default)(this.onContinue)},r.default.createElement(E.default,{name:"checkmark-medium"}))):null;return r.default.createElement(d.default,null,r.default.createElement(c.default,{title:h.default.t(1171),type:c.DRAWER_HEADER_TYPE.LARGE,onBack:this.props.onBack}),r.default.createElement(u.default,null,r.default.createElement("div",{className:p.default.section},r.default.createElement(m.default,{type:v.default.GROUP,attachToChat:!1,startImage:this.state.full,onImageSet:this.onImageSet})),r.default.createElement("div",{"data-a8n":n.default.key("group-subject"),className:p.default.section},r.default.createElement(_.default,{ref:this.setRefEmojiInput,value:this.state.text,maxLength:25,showRemaining:!0,onChange:this.onSubjectChange,placeholder:h.default.t(832),onEnter:e?(0,i.default)(this.onContinue):()=>{},supportsEmoji:!0})),null,r.default.createElement(C.default,{transitionName:"btn"},t)))}}t.default=S,S.displayName="NewGroupDrawer"},74854:(e,t,a)=>{"use strict";var l=a(20862),s=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(a(63105)),r=s(a(41609)),n=s(a(91966)),o=s(a(94184)),d=l(a(67294)),u=s(a(62067)),c=a(87577),f=s(a(97420)),h=s(a(58743)),p=s(a(69107)),m=s(a(51885)),v=s(a(3395)),g=s(a(34727)),E=l(a(85002)),_=a(4404),C=l(a(92246)),S=s(a(3152)),y=s(a(12063)),I=s(a(23418)),M=s(a(47312)),P=s(a(79766)),L=s(a(66761)),T=s(a(95575)),b=s(a(1398)),D=s(a(1600)),N=s(a(52206)),O=s(a(92120)),w=a(80493),k=s(a(86981)),R=s(a(17363)),A=s(a(62745)),x=l(a(9931)),F=s(a(77923)),U=(0,x.genId)("max_participant_toast");class B extends d.Component{constructor(...e){super(...e),this.state={searchText:"",participants:this.props.participants,shouldFocus:!0,isBusy:!1},this.flatListController=new y.default,this.setRefParticipantList=e=>{this.refParticipantList=e},this.setRefList=e=>{this.refList=e},this.onKeyDown=e=>{if("Backspace"===e.key&&!this.state.searchText&&!(0,r.default)(this.state.participants)){e.preventDefault();var t=this.state.participants;this.setState({participants:t.slice(0,t.length-1),shouldFocus:!0})}},this.onInput=e=>{this.setState({searchText:e.target.value})},this.onReset=()=>{this.setState({searchText:"",shouldFocus:!0})},this.focus=()=>{M.default.focus(this.refInput)},this.onBack=()=>{this.props.onBack()},this.onContinue=()=>{this.props.onContinue(this.state.participants)},this.onDelete=(e,t)=>{var a=(0,i.default)(this.state.participants,(e=>!e.id.equals(t.id)));this.setState({participants:a,shouldFocus:!a.length})},this.onContactClick=(e,t)=>{this.state.participants.find((e=>e.id.equals(t.id)))?this._removeContact(t):t.isBlocked()?f.default.openModal(d.default.createElement(h.default,{title:L.default.t(209),onOK:()=>{this._unblockAndAddContact(t),f.default.closeModal()},onCancel:()=>f.default.closeModal(),okText:L.default.t(1961),cancelText:L.default.t(1821)},L.default.t(207))):this.addContact(t)},this.onFocusList=e=>{this.refList&&(e.preventDefault(),e.stopPropagation(),I.default.shouldIndicateFocus(),this.refList&&this.refList.focusFirst())},this._onFocusParticipants=e=>{e.repeat||this.refInput&&0!==this.refInput.selectionStart||this.refParticipantList&&(e.preventDefault(),e.stopPropagation(),P.default.flashFocus=0,this.refParticipantList&&this.refParticipantList.focusLast())},this.onSelectFirst=e=>{e.preventDefault(),e.stopPropagation();var t=this.getFilteredContacts()[0];t&&this.onContactClick(e,t)},this.onFocusSearch=()=>{I.default.shouldIndicateFocus(),M.default.focus(this.refInput)},this.setRefInput=e=>{this.refInput=e},this._setRefSizer=e=>{this._refSizer=e}}componentDidMount(){this.focus()}componentDidUpdate(){this._adjustInput()}getFilteredContacts(){var e=(0,n.default)(p.default.getFilteredContacts(),this.state.participants),t=this.state.searchText;if(!t)return e;t=L.default.accentFold(t);var a=(0,b.default)(t);return e.filter((e=>e.searchMatch(t,a)))}_adjustInput(){if(this.refInput){var e,t=this.refInput.offsetParent.offsetWidth-10,a=this._refSizer.offsetWidth,l=a>t?t:a;this.refInput.style.width=l+"px",e=t-this.refInput.offsetLeft-l>0?t-this.refInput.offsetLeft:t,this.refInput.style.width=e+"px",this.state.shouldFocus&&this.focus()}}addContact(e){var t=this.state.participants;if(t.length>=k.default.maxParticipants){var a=L.default.t(98,{max:k.default.maxParticipants});f.default.openToast(d.default.createElement(x.default,{msg:a,id:U}))}else this.setState({participants:t.concat(e),searchText:"",shouldFocus:!0})}_removeContact(e){var t=this.state.participants;this.setState({participants:(0,i.default)(t,(t=>!e.id.equals(t.id))),shouldFocus:!0})}_unblockAndAddContact(e){this.setState({isBusy:!0}),(0,c.unblockContact)(e).checkpoint(this.props.rejectOnUnmount()).then((()=>{this.addContact(e),this.setState({isBusy:!1})})).catchType(C.Unmount,(()=>{})).catch((()=>{this.setState({isBusy:!1})}))}render(){var e;this.state.isBusy?e=d.default.createElement("div",{className:T.default.spinner},d.default.createElement(R.default,{stroke:6,size:24})):this.state.participants&&this.state.participants.length&&(e=d.default.createElement(O.default,{a8nText:"group-participants-btn",onClick:this.onContinue},d.default.createElement(A.default,{name:"arrow-forward",directional:!0})));var t=this.state.participants&&this.state.participants.length?" ":L.default.t(819),a={down:this.onFocusList,enter:this.state.searchText?this.onSelectFirst:this.state.participants&&this.state.participants.length?this.onContinue:()=>{},up:this._onFocusParticipants};a[L.default.LR("left","right")]=this._onFocusParticipants;var l,s=this.getFilteredContacts();return l=0===s.length?d.default.createElement(_.SearchContacts,null):d.default.createElement(m.default,{ref:this.setRefList,flatListController:this.flatListController,contacts:s,onClick:this.onContactClick,onFocusSearch:this.onFocusSearch,showPersonGroupDivisionHeader:!1}),d.default.createElement(v.default,null,d.default.createElement(E.default,{title:L.default.t(216),type:E.DRAWER_HEADER_TYPE.LARGE,onBack:this.onBack}),d.default.createElement(g.default,null,d.default.createElement("div",{className:T.default.search},d.default.createElement("div",null,d.default.createElement(P.default,{handlers:a,className:T.default.inputLine},d.default.createElement("div",{"data-list-scroll-container":!0},d.default.createElement(D.default,{ref:this.setRefParticipantList,theme:"list-names",contacts:this.state.participants,onDelete:this.onDelete,onFocusSearch:this.onFocusSearch})),d.default.createElement("input",{"data-a8n":u.default.key("inputarea"),className:(0,o.default)(T.default.inputarea,w.SELECTABLE_INPUT_CSS_CLASS),ref:this.setRefInput,placeholder:t,onKeyDown:this.onKeyDown,onChange:this.onInput,value:this.state.searchText,type:"text"}),d.default.createElement("span",{className:T.default.inputareaSizer,ref:this._setRefSizer},this.state.searchText)))),d.default.createElement(S.default,{className:T.default.contacts,flatListControllers:[this.flatListController]},l),d.default.createElement(F.default,{transitionName:"btn",className:T.default.drawerSection},e)))}}B.defaultProps={participants:[]},B.displayName="NewGroupParticipantsDrawer";var H=(0,N.default)(B);t.default=H},42047:(e,t,a)=>{"use strict";var l=a(95318),s=a(20862);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(a(67294)),r=l(a(82324)),n=l(a(3395)),o=l(a(34727)),d=s(a(85002)),u=l(a(66761)),c=l(a(1340)),f=(0,i.forwardRef)(((e,t)=>i.default.createElement(n.default,{ref:t},i.default.createElement(d.default,{a8n:"drawer-title-notifications",title:u.default.t(1189),onBack:e.onClose,type:d.DRAWER_HEADER_TYPE.LARGE}),i.default.createElement(o.default,null,i.default.createElement(r.default,{key:"notifications",mute:c.default.globalMute()})))));t.default=f},79149:(e,t,a)=>{"use strict";var l=a(95318),s=a(20862);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(a(67294)),r=l(a(62067)),n=a(72203),o=l(a(57984)),d=l(a(19049)),u=a(70924),c=l(a(97420)),f=l(a(58743)),h=l(a(3243)),p=l(a(46274)),m=l(a(74600)),v=l(a(3395)),g=l(a(34727)),E=l(a(31763)),_=s(a(85002)),C=l(a(25404)),S=l(a(75598)),y=l(a(29594)),I=s(a(92246)),M=a(56726),P=a(53615),L=l(a(28204)),T=l(a(92325)),b=l(a(66761)),D=l(a(5148)),N=a(66248),O=l(a(34498)),w=l(a(66915)),k=l(a(8092)),R=l(a(52206)),A=l(a(86981)),x=a(97876),F=l(a(82286)),U=a(38090),B=a(45739),H=l(a(51231)),G=l(a(24278));class V extends i.Component{constructor(e){super(e),this.onBack=()=>{this.props.onClose?this.props.onClose():this.props.uim.uie.requestDismiss()},this._validateStatus=e=>!!(e||"").trim(),this._onStatusBegin=()=>{this._isEditingStatus=!0},this._onSetStatusError=()=>{c.default.openModal(i.default.createElement(f.default,{onOK:()=>c.default.closeModal(),okText:b.default.t(1826)},b.default.t(197)))},this._onSetStatus=()=>{if(null!=this.state.status){this._isEditingStatus=!1;var e=this.props.status.status,t=(0,y.default)(this.state.status);if(t===e)return this.setState({status:t});this.setState({pendingStatus:!0}),(0,U.setMyStatus)((0,y.default)(this.state.status)).checkpoint(this.props.rejectOnUnmount()).then((()=>{this.setState({pendingStatus:!1})})).catchType(I.Unmount,(()=>{}))}else this._onCancelStatus()},this.onStatusChange=e=>{this.setState({status:e})},this._onCancelStatus=()=>{this._isEditingStatus=!1,this.setState({status:this.props.status.status})},this._onPushnameBegin=()=>{this._isEditingPushname=!0},this._validatePushname=()=>{var e,{pushname:t}=this.state;return(t=(t||"").trim())?/[\u2714\u2705\u2611]/g.test(t)&&(e=b.default.t(192)):e=b.default.t(189),!e||(this._onSetPushnameError(e),!1)},this._onSetPushname=()=>{if(this._isEditingPushname=!1,h.default.canSetMyPushname()){var{pushname:e}=this.state;if((e=(0,y.default)((e||"").trim()))===this.props.conn.pushname)return this.setState({pushname:e});this.setState({pendingPushname:!0}),(0,x.setPushname)(e).checkpoint(this.props.rejectOnUnmount()).then((()=>{this.setState({pendingPushname:!1})})).catchType(I.Unmount,(()=>{}))}},this._onSetPushnameError=e=>{c.default.openModal(i.default.createElement(f.default,{onOK:()=>c.default.closeModal(),okText:b.default.t(1826)},e))},this._onPushnameChange=e=>{this.setState({pushname:e})},this._onCancelPushname=()=>{this._isEditingPushname=!1,this.setState({pushname:this.props.conn.pushname})},this.state={pushname:e.conn.pushname,status:e.status.status,pendingPushname:!1,pendingStatus:!1,catalog:null}}componentDidMount(){h.default.isSMB&&(0,P.canEditBizProfile)()&&o.default.find((0,M.getMeUser)()).then((e=>{this.setState({catalog:e})})).catch((()=>{}));var{session:e}=(0,N.getProductCatalogContext)(this.context);e.isAccidental()&&c.default.setDrawerContext("left",(0,N.buildProductCatalogContext)(new O.default,D.default.BIZ_PLATFORM.SMB,D.default.CATALOG_ENTRY_POINT.CATALOG_ENTRY_POINT_SETTINGS))}renderProductCatalogSection(){var e,t;if(A.default.shopsProfileDrawerEntrypoint&&(null===(e=this.props.contact.businessProfile)||void 0===e||null===(t=e.profileOptions)||void 0===t?void 0:t.commerceExperience)===n.COMMERCE_EXPERIENCE_TYPES.SHOP)return null;var{session:a}=(0,N.getProductCatalogContext)(this.context);return a.isAccidental()?null:i.default.createElement(d.default,{catalog:this.state.catalog,onProductDetail:u.openCatalogManagementFlow,onProductCatalog:()=>(0,u.openCatalogManagementFlow)(),productsToShow:3,catalogEntryLabel:null==this.state.catalog?b.default.t(210):b.default.t(1542),showProductPlaceholders:!0,seeMoreOverlay:!0,sectionTheme:"refresh"})}_renderAboutInput(){var{status:e}=this.props,t=this._isEditingStatus||this.state.pendingStatus?this.state.status:e.status;return i.default.createElement(H.default,{a8n:"col-main-profile-input",value:t,editable:!0,pending:this.state.pendingStatus,showRemaining:!0,validate:this._validateStatus,maxLength:p.default.MAX_STATUS_LENGTH,onBeginEdit:this._onStatusBegin,onChange:this.onStatusChange,onSave:this._onSetStatus,onError:this._onSetStatusError,onCancel:this._onCancelStatus,theme:"text-input",supportsEmoji:!0,lockable:!0,lowProfile:!0})}_renderStandardEditSection(){var{conn:e}=this.props,t=this._isEditingPushname||this.state.pendingPushname?this.state.pushname:e.pushname,a=h.default.isSMB?b.default.t(375):b.default.t(1281),l=i.default.createElement(C.default,{a8nText:"col-main-profile",title:b.default.t(1906),theme:"padding"},this._renderAboutInput());return i.default.createElement(i.default.Fragment,null,i.default.createElement(C.default,{a8nText:"col-main-profile",title:b.default.t(1280),theme:"padding"},i.default.createElement(H.default,{a8n:"col-main-profile-input",value:t,editable:h.default.canSetMyPushname(),pending:this.state.pendingPushname,showRemaining:!0,validate:this._validatePushname,maxLength:p.default.MAX_PUSHNAME_LENGTH,onBeginEdit:this._onPushnameBegin,onChange:this._onPushnameChange,onSave:this._onSetPushname,onCancel:this._onCancelPushname,supportsEmoji:!0,lockable:!0,lowProfile:!0})),i.default.createElement("div",{"data-a8n":r.default.key("pushname-description"),className:w.default.nameWrapper},i.default.createElement(B.TextSpan,{theme:"muted"},a)),l)}_renderSection(e){return i.default.createElement(T.default,e)}_renderAboutSection(){var e=this._renderSection({icon:"info",content:this._renderAboutInput()}),t=this._renderSection({icon:"call-phone",iconClass:w.default.phoneIcon,content:i.default.createElement("div",null,i.default.createElement("div",{className:w.default.phoneField},(0,G.default)((0,M.assertGetMe)())),i.default.createElement("div",{className:w.default.infoText},b.default.t(395)))});return i.default.createElement(C.default,{title:b.default.t(385),theme:"refresh"},e,t)}_renderEditBizProfileEditSection(){return i.default.createElement("div",null,i.default.createElement(S.default,null),this.renderProductCatalogSection(),this._renderAboutSection())}_renderCoverPhoto(){return i.default.createElement(C.default,{theme:"padding-no-margin"},i.default.createElement(m.default,{contact:this.props.contact,editable:!0,profilePicThumb:this.props.profilePicThumb,hideStatusV3:!0}))}_renderProfilePicture(){return i.default.createElement("div",{className:w.default.photoPickerWrapper},i.default.createElement(k.default,{profilePicThumb:this.props.profilePicThumb}))}render(){var e=(0,P.canSeeBizProfileV3)()&&h.default.isSMB?this._renderCoverPhoto():this._renderProfilePicture(),t=(0,P.canEditBizProfile)()?this._renderEditBizProfileEditSection():this._renderStandardEditSection(),a=b.default.t(1020);return i.default.createElement(v.default,null,i.default.createElement(_.default,{a8n:"drawer-title-profile",title:a,onBack:this.onBack,type:_.DRAWER_HEADER_TYPE.LARGE}),i.default.createElement(g.default,null,e,t))}}V.contextType=E.default,V.CONCERNS={contact:["businessProfile","id","statusMute"],profilePicThumb:["imgFull","id"],status:["status"],conn:["pushname"]},V.displayName="ProfileDrawer";var j=(0,L.default)((0,R.default)((0,F.default)(V,V.CONCERNS)));t.default=j},37306:(e,t,a)=>{"use strict";var l=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return s.default.createElement(i.default,{primary:e.choiceText,onClick:e.onChoose,theme:"radio-button-row",image:s.default.createElement(r.default,{checked:e.isChosen,hover:!1,radio:!0,onChange:e.onChoose,systemUncheckedColor:!0})})};var s=l(a(67294)),i=l(a(79274)),r=l(a(8906))},56990:(e,t,a)=>{"use strict";var l=a(95318),s=a(20862);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(a(67294)),r=l(a(73132)),n=l(a(3395)),o=l(a(34727)),d=s(a(85002)),u=l(a(25404)),c=l(a(91072)),f=a(78572),h=a(67052),p=a(56726),m=l(a(66761)),v=l(a(4662)),g=l(a(86981)),E=a(53023),_=l(a(62745)),C=a(45739);class S extends i.PureComponent{constructor(e){super(e),this._onSecurityNotificationChange=()=>{var e=!this.state.securityNotificationEnabled;(0,p.setGlobalSecurityNotifications)(e),this.setState({securityNotificationEnabled:e})},this.state={securityNotificationEnabled:(0,p.getGlobalSecurityNotifications)()}}render(){var e=g.default.bspSystemMessageEnabled,t=e?i.default.createElement(i.default.Fragment,null,m.default.t(1352)," ",i.default.createElement(c.default,{href:(0,f.getCodeChangeFaqUrl)()},m.default.t(919))):m.default.t(1351);return i.default.createElement(n.default,null,i.default.createElement(d.default,{a8n:"drawer-title-security",title:m.default.t(1357),onBack:this.props.onClose,type:d.DRAWER_HEADER_TYPE.LARGE}),i.default.createElement(o.default,null,i.default.createElement(u.default,{theme:"padding-large",animation:!1},i.default.createElement(h.FlexColumn,{className:v.default.icon,align:"center",justify:"center"},i.default.createElement(h.FlexItem,null,i.default.createElement(_.default,{name:"security-shield"})),i.default.createElement(h.FlexColumn,{className:v.default.iconLock,align:"center",justify:"center"},i.default.createElement(h.FlexItem,null,i.default.createElement(_.default,{name:"security-lock"})))),i.default.createElement("div",{className:v.default.text},e?m.default.t(1356):m.default.t(1355)," ",i.default.createElement(c.default,{href:e?(0,E.securityUrl)():(0,f.getCodeChangeFaqUrl)()},e?m.default.t(1350):m.default.t(919))),i.default.createElement(h.FlexRow,{className:v.default.controls},i.default.createElement("div",{className:v.default.checkbox},i.default.createElement(r.default,{onChange:this._onSecurityNotificationChange,checked:this.state.securityNotificationEnabled})),i.default.createElement(h.FlexItem,null,i.default.createElement("div",{className:v.default.header},i.default.createElement(C.TextSpan,{theme:"title"},e?m.default.t(1354):m.default.t(1353))),i.default.createElement(C.TextDiv,{theme:"muted"},t))))))}}t.default=S,S.displayName="SecurityDrawer"},60138:(e,t,a)=>{"use strict";var l=a(95318),s=a(20862);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(a(67294)),r=l(a(97420)),n=l(a(58743)),o=l(a(98712)),d=l(a(66761));class u extends i.Component{constructor(...e){super(...e),this.onCancel=()=>{r.default.closeModal(),this.props.onOK()}}render(){var e=this.props.name||d.default.t(572),t=d.default.t(1387,{name:e});return i.default.createElement(n.default,{onOK:this.onCancel,okText:d.default.t(1826)},i.default.createElement("div",null,i.default.createElement(o.default,{text:t})))}}t.default=u,u.displayName="SendMsgToVerifyIdentityPopup"},50822:(e,t,a)=>{"use strict";var l=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return i.default.createElement("div",{className:o.default.container},e.children)},t.SettingsCheckListSection=d,t.SettingsCheckListItem=function(e){return i.default.createElement(d,{disabled:e.disabled},i.default.createElement("div",{"data-a8n":r.default.key(e.a8nText),className:o.default.control},i.default.createElement(n.default,{id:e.id,onChange:e.onChange,checked:e.checked,disabled:e.disabled})),i.default.createElement("label",{className:o.default.label,htmlFor:e.id},e.children))};var s=l(a(94184)),i=l(a(67294)),r=l(a(62067)),n=l(a(73132)),o=l(a(96601));function d(e){return i.default.createElement("div",{className:(0,s.default)(o.default.section,{[o.default.disabled]:e.disabled})},e.children)}},15105:(e,t,a)=>{"use strict";var l=a(95318),s=a(20862);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(a(67294)),r=l(a(79274)),n=l(a(3243)),o=s(a(27890)),d=l(a(3395)),u=l(a(34727)),c=l(a(61376)),f=s(a(85002)),h=l(a(98712)),p=a(56726),m=a(53615),v=l(a(66761)),g=l(a(82286)),E=l(a(2812)),_=l(a(62745)),C=l(a(60246));class S extends i.PureComponent{render(){var e,t,a,l=i.default.createElement(E.default,{id:this.props.profileId}),s=i.default.createElement(o.default,{id:(0,p.getMaybeMeUser)(),size:82,quality:o.DETAIL_IMAGE_QUALITY.HIGH}),g=i.default.createElement(h.default,{text:n.default.pushname,ellipsify:!0,titlify:!0});return(0,m.archiveV2Supported)()&&this.props.settings.archive.enabled&&(a=i.default.createElement(c.default,{icon:i.default.createElement(_.default,{name:"archived"}),onClick:this.props.onArchiveSettings},v.default.t(232))),C.default.supportsFeature(C.default.F.MD_BACKEND)&&(t=i.default.createElement(c.default,{a8nText:"li-security",icon:i.default.createElement(_.default,{name:"settings-security"}),onClick:this.props.onSecurity},v.default.t(1022))),e=i.default.createElement(c.default,{a8nText:"li-keyboard-shortcuts",icon:i.default.createElement(_.default,{name:"settings-keyboard"}),onClick:this.props.onKeyboardShortcuts},v.default.t(904)),i.default.createElement(d.default,{theme:"settings"},i.default.createElement(f.default,{title:v.default.t(1391),onBack:this.props.onClose,type:f.DRAWER_HEADER_TYPE.LARGE}),i.default.createElement(u.default,null,i.default.createElement(r.default,{onClick:this.props.onProfile,image:s,primary:g,theme:"identity",secondary:l}),i.default.createElement(c.default,{a8nText:"li-notifications",icon:i.default.createElement(_.default,{name:"settings-notifications"}),onClick:this.props.onNotifications},v.default.t(1018)),t,i.default.createElement(c.default,{icon:i.default.createElement(_.default,{name:"settings-theme"}),onClick:this.props.onThemeSettings},v.default.t(1025)),i.default.createElement(c.default,{icon:i.default.createElement(_.default,{name:"settings-wallpaper"}),onClick:this.props.onWallpaper},v.default.t(1026)),a,i.default.createElement(c.default,{a8nText:"li-blocked",icon:i.default.createElement(_.default,{name:"settings-blocked"}),onClick:this.props.onBlocked},v.default.t(1011)),undefined,undefined,e,i.default.createElement(c.default,{a8nText:"li-help",icon:i.default.createElement(_.default,{name:"settings-help"}),onClick:this.props.onHelp},v.default.t(1013)),undefined,undefined,undefined,undefined,undefined))}}S.CONCERNS={settings:["archive"]},S.displayName="SettingsDrawer";var y=(0,g.default)(S,S.CONCERNS);t.default=y},68612:(e,t,a)=>{"use strict";var l=a(20862),s=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(a(23493)),r=l(a(67294)),n=a(6653),o=s(a(56656)),d=s(a(97420)),u=s(a(46274)),c=s(a(25508)),f=s(a(3395)),h=s(a(34727)),p=l(a(85002)),m=a(4404),v=l(a(92246)),g=s(a(47312)),E=a(56726),_=s(a(60246)),C=s(a(28204)),S=s(a(79766)),y=s(a(66761)),I=s(a(48878)),M=a(3875),P=s(a(52206)),L=s(a(91382)),T=s(a(24927)),b=s(a(17363)),D=s(a(96363)),N=s(a(36734)),O=s(a(22221)),w=s(a(62745)),k=s(a(77923));class R extends r.Component{constructor(e){super(e),this._msgRefs={},this._setRefHotKeys=e=>{this._refHotKeys=e},this._refScrollContainer=(0,r.createRef)(),this._getInitialState=()=>{var{starredMsgs:e}=this.props;return{cursor:L.default.create({msgCollection:e,type:u.default.RENDER_CURSOR.STARRED_DRAWER}).loadAfter(e,{count:u.default.MSG_PRELOAD_THRESHOLD})}},this._handleStarChange=()=>{this._initSelectionObjects(),this.forceUpdate()},this._initSelectionObjects=()=>{var e=this.props.starredMsgs.toArray();this._currSelection.init(e,!0),this._activeSelection.init(e)},this.setRefMsgComponent=(e,t)=>{t?this._msgRefs[e.id.toString()]=t:delete this._msgRefs[e.id.toString()]},this.loadEarlierMsgs=()=>{var e=this.state.cursor,t=this.props.chat&&this.props.chat.id,{starredMsgs:a}=this.props,l=a.models;if(e.getEnd(a)<l.length)this.setState({cursor:e.loadAfter(a)});else{if(a.isSynced)return;this.props.starredMsgs.sync(t).checkpoint(this.props.rejectOnUnmount()).then((()=>{e.hasAfter(a)&&this.setState({cursor:e.loadAfter(a)})})).catchType(v.Unmount,(()=>{})).catch((e=>{__LOG__(2)`StarredDrawer:loadEarlierMsgs failed\n${e}`}))}},this.onClose=()=>{this.props.onClose?this.props.onClose():this.props.uim.uie.requestDismiss()},this.focus=()=>{this._refHotKeys&&g.default.focus(this._refHotKeys)},this.onFocusGain=e=>{this._refHotKeys&&((e?e.target:document.activeElement)===this._refHotKeys&&(this._currSelection.index<0?this._currSelection.setFirst(!0):this._currSelection.reset(!1)))},this._onNextMsg=e=>{e&&(e.preventDefault(),e.stopPropagation());var t=this._currSelection.next();this._currSelection.index!==t&&this._currSelection.setNext(!0)},this._onPrevMsg=e=>{e&&(e.stopPropagation(),e.preventDefault()),this._currSelection.prev()>-1&&this._currSelection.setPrev(!0)},this.onScroll=e=>{this.handleScroll(e.currentTarget)},this._handleScroll=e=>{this.updateMsgListInfo(),function(e){return e.scrollTop+u.default.SCROLL_FUDGE>e.scrollHeight-e.clientHeight}(e)&&this.loadEarlierMsgs()},this._selectMsg=e=>{this._currSelection.setVal(e),this._activeSelection.setVal(e),d.default.openChatAt(e.chat,e.chat.getSearchContext(e)),d.default.focusShowMsg(e.id)},this._getMsgList=()=>{var e=this.state.cursor,{starredMsgs:t}=this.props,a=t.toArray(),l=t.isSynced?e.getEnd(t):Math.min(e.getEnd(t),a.length);return a=a.slice(e.getStart(t),l),this.length=a.length,a},this.getMsgVisibility=e=>{if(!e)return u.default.VISIBILITY.BELOW;var t=this._refScrollContainer.current;if(t){var a=t.previousSibling;if(a&&a instanceof HTMLElement){var l=a.clientHeight,s=t.scrollTop+l,i=s+t.clientHeight,r=e.getContainerElement();return r?r.offsetTop+r.clientHeight<=s?u.default.VISIBILITY.ABOVE:r.offsetTop>=i?u.default.VISIBILITY.BELOW:u.default.VISIBILITY.VISIBLE:u.default.VISIBILITY.BELOW}}},this.isMsgVisible=(e,t=!1)=>!!this._msgListInfo.visibleMsgs[e.toString()]&&(!!t||this.getMsgComponent(e)),this.getMsgComponent=e=>{var t=this._msgRefs[e.toString()];if(t){var a=t.getWrapperRef();return a&&"function"==typeof a.getMsgComponentRef?a.getMsgComponentRef():void 0}},this._updateMsgListInfo=()=>{for(var e=this._getMsgList(),t={},a=0,l=this.length-1;a<l;){var s=Math.floor((a+l)/2),i=this._msgRefs[e[s].id.toString()];this.getMsgVisibility(i)===u.default.VISIBILITY.ABOVE?a=s+1:l=s}for(var r=a;r<e.length;r++){var n=this._msgRefs[e[r].id.toString()];if(this.getMsgVisibility(n)!==u.default.VISIBILITY.VISIBLE)break;t[e[r].id.toString()]=!0}this.pauseHiddenGifs(this._msgListInfo.visibleMsgs,t),this._msgListInfo.visibleMsgs=t},this.pauseHiddenGifs=(e,t)=>{for(var a in e)if(!t[a]){var l=this.props.starredMsgs.get(a);if(l&&l.isGif){var s=this.getMsgComponent(a);s&&s.getPlayCount()&&s.pause()}}},this.handleScroll=(0,i.default)(this._handleScroll,100),this.updateMsgListInfo=(0,i.default)(this._updateMsgListInfo,100),this._msgListInfo={visibleMsgs:{}},this.state=this._getInitialState(),this._currSelection=new T.default([],(e=>e.id.toString())),this._activeSelection=new T.default([],(e=>e.id.toString())),this._initSelectionObjects()}componentDidMount(){this.focus(),this.props.listeners.add(window,"resize",this.updateMsgListInfo),!this.props.starredMsgs.isSynced&&this.props.starredMsgs.length<u.default.PAGE_SIZE&&this.props.listeners.uiIdle(this.loadEarlierMsgs),this.props.listeners.add(this.props.starredMsgs,"reset sync",(()=>{this._initSelectionObjects(),this.forceUpdate()})),this.props.listeners.add(this.props.starredMsgs,"add remove",this._handleStarChange),this.onFocusGain(),this.props.listeners.add(this.props.starredMsgs,"reset",(()=>{this._msgListInfo={visibleMsgs:{}},this.setState(this._getInitialState()),this.loadEarlierMsgs()}))}componentWillUnmount(){this.handleScroll.cancel(),this.updateMsgListInfo.cancel()}componentDidUpdate(){this.updateMsgListInfo()}render(){var e,t,a=this._getMsgList(),l=this.state.cursor,{starredMsgs:s}=this.props,i=this.props.chat||null;if(t=s.isSynced&&l.getEnd(s)>=a.length?null:this.props.starredMsgs.syncPromise?r.default.createElement("div",{className:D.default.more,title:y.default.t(961)},r.default.createElement(b.default,{stroke:6,size:24})):r.default.createElement("div",{className:D.default.more},r.default.createElement("div",{title:y.default.t(958),onClick:this.loadEarlierMsgs},r.default.createElement(w.default,{name:"refresh"}))),a.length>0){var d=a.map((e=>{var t=e.type===u.default.MSG_TYPE.IMAGE||e.type===u.default.MSG_TYPE.VIDEO||e.type===u.default.MSG_TYPE.AUDIO;return r.default.createElement(O.default,{key:e.id.toString(),ref:t=>{this.setRefMsgComponent(e,t)},msg:e,isMsgVisible:t?this.isMsgVisible:()=>{},currSelection:this._currSelection,activeSelection:this._activeSelection,onClickMsg:this._selectMsg})}));e=r.default.createElement(k.default,{transitionName:"slide"},d)}else this.props.starredMsgs.isSynced?e=r.default.createElement(m.StarredMsgs,null):(e=r.default.createElement(m.Loading,null),t=null);var v,g={down:this._onNextMsg,up:this._onPrevMsg},C=a.length>0?r.default.createElement(M.MenuBarItem,{a8nText:"starred-menu",icon:r.default.createElement(w.default,{name:"menu"}),title:y.default.t(1028)},r.default.createElement(N.default,{chat:i,msgs:a})):null;if(_.default.supportsFeature(_.default.F.MD_BACKEND)&&(!i||i&&i.endOfHistoryTransferType===n.ConversationEndOfHistoryTransferModelPropType.COMPLETE_BUT_MORE_MESSAGES_REMAIN_ON_PRIMARY)){var I=o.default.relativeDateStr((0,E.getHistorySyncEarliestDate)());v=r.default.createElement(c.default,{icon:r.default.createElement(w.default,{name:"content-chat"}),theme:"list",secondary:y.default.t(588,{date:I})},y.default.t(586))}return r.default.createElement(f.default,{theme:"gallery"},r.default.createElement(S.default,{className:D.default.hotKeyWraper,handlers:g,onFocus:this.onFocusGain,"data-tab":u.default.TAB_ORDERS.CHAT_STARRED_DRAWER,onRef:this._setRefHotKeys},r.default.createElement(p.default,{title:y.default.t(1402),onBack:this.onClose,type:p.DRAWER_HEADER_TYPE.LARGE,menu:C}),r.default.createElement(h.default,{onScroll:this.onScroll,ref:this._refScrollContainer},e,t,v)))}}R.displayName="StarredDrawer";var A=(0,C.default)((0,P.default)((0,I.default)(R)));t.default=A},36734:(e,t,a)=>{"use strict";var l=a(95318),s=a(20862);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(a(67294)),r=l(a(97420)),n=l(a(68770)),o=l(a(59474)),d=l(a(66761)),u=l(a(57236));class c extends i.Component{constructor(...e){super(...e),this.sendUnstarAll=()=>{r.default.openModal(i.default.createElement(u.default,{msgs:this.props.msgs,chat:this.props.chat}))}}getElement(){return this._refDropdown}render(){var{msgs:e}=this.props;return i.default.createElement(n.default,{onRef:e=>{this._refDropdown=e},type:"dropdown_menu",flipOnRTL:!0,key:"StarredDrawerHeader",dirX:"LEFT"},i.default.createElement(o.default,{a8n:"mi-unstar-all menu-item",action:this.sendUnstarAll,disabled:0===e.length},d.default.t(1476)))}}t.default=c,c.displayName="StarredHeaderDropdown"},65500:(e,t,a)=>{"use strict";var l=a(20862);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=l(a(67294));class i extends s.Component{constructor(...e){super(...e),this._setRefCanvas=e=>{this.refCanvas=e}}shouldComponentUpdate(){return!1}render(){return s.default.createElement("canvas",{className:this.props.className,ref:this._setRefCanvas})}}t.default=i,i.displayName="StaticCanvas"},13154:(e,t,a)=>{"use strict";var l=a(20862),s=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(a(96391)),r=l(a(67294)),n=s(a(62067)),o=s(a(56656)),d=s(a(69107)),u=s(a(27890)),c=a(4404),f=l(a(47060)),h=s(a(3152)),p=s(a(12063)),m=a(56726),v=s(a(60246)),g=s(a(66761)),E=s(a(48878)),_=s(a(17636)),C=s(a(23519)),S=s(a(58036)),y=s(a(9479)),I=s(a(62745)),M="SEC_UNREAD",P="SEC_READ",L="SEC_MUTED",T="ROW_STATUS";class b extends r.Component{constructor(){super(...arguments),this.flatListController=new p.default,this.onStatusChange=()=>{var e=this._getUnreadStatusList(),t=this._getReadStatusList(),a=[...e,...t].filter((e=>e.contact.statusMute));this.setState({unreadStatusList:e.filter((e=>!e.contact.statusMute)),readStatusList:t.filter((e=>!e.contact.statusMute)),mutedStatusList:a,myStatus:C.default.getMyStatus()})},this._onContactMuteChange=()=>{var e=this._getUnreadStatusList(),t=this._getReadStatusList(),a=[...e,...t].filter((e=>e.contact.statusMute));this.setState({unreadStatusList:e.filter((e=>!e.contact.statusMute)),readStatusList:t.filter((e=>!e.contact.statusMute)),mutedStatusList:a,myStatus:C.default.getMyStatus()})},this._toggleMuted=()=>{this.setState((e=>({isMutedExpanded:!e.isMutedExpanded})))},this.renderItem=e=>{switch(e.type){case M:return r.default.createElement("div",{className:S.default.listSectionSep},r.default.createElement("hr",null),r.default.createElement("div",{className:S.default.listSectionText},r.default.createElement("span",null,g.default.t(1413))));case P:return r.default.createElement("div",{className:S.default.listSectionSep},r.default.createElement("hr",null),r.default.createElement("div",{className:S.default.listSectionText},r.default.createElement("span",null,g.default.t(1420))));case L:return r.default.createElement("div",{className:S.default.listSectionSep},r.default.createElement("hr",null),r.default.createElement("div",{className:S.default.listSectionText},r.default.createElement("span",null,g.default.t(1409)),r.default.createElement("button",{className:S.default.listSectionAction,onClick:this._toggleMuted},e.expanded?g.default.t(1406):g.default.t(1407))));case T:return r.default.createElement(_.default,{statusV3:e.status,onClick:()=>this.props.onOpenStatus(e.status,void 0,e.index),contact:e.status.contact});default:throw new f.UnknownDataError(e)}};var e=this._getUnreadStatusList(),t=this._getReadStatusList(),a=[...e,...t].filter((e=>e.contact.statusMute));this.state={unreadStatusList:e.filter((e=>!e.contact.statusMute)),readStatusList:t.filter((e=>!e.contact.statusMute)),mutedStatusList:a,myStatus:C.default.getMyStatus(),isMutedExpanded:!1}}componentDidMount(){this.props.listeners.add(C.default,"add remove bulk_add sort change:msgsChanged change:hasUnread",this.onStatusChange),this.props.listeners.add(d.default,"change:statusMute",this._onContactMuteChange),this.props.listeners.add(C.default,"sync",(()=>{this.forceUpdate()}))}_getUnreadStatusList(){return C.default.getUnexpired(!0)}_getReadStatusList(){return C.default.getUnexpired(!1)}getData(){var{unreadStatusList:e,readStatusList:t,mutedStatusList:a}=this.state,l=[];return e.length>0&&(l.push({type:M,itemKey:"section-unread",height:48}),l.push(...e.map(((e,t)=>({type:T,itemKey:e.id.toString(),height:64,status:e,index:t}))))),t.length>0&&(l.push({type:P,itemKey:"section-read",height:48}),l.push(...t.map(((e,t)=>({type:T,itemKey:e.id.toString(),height:64,status:e,index:t}))))),a.length>0&&(l.push({type:L,itemKey:"section-muted",height:48,expanded:this.state.isMutedExpanded}),this.state.isMutedExpanded&&l.push(...a.map(((e,t)=>({type:T,itemKey:e.id.toString(),height:64,status:e,index:t}))))),l}render(){var e,t=this.getData();return e=C.default.hasSynced()&&t.length>0?r.default.createElement(f.default,{className:"statusList",itemEnterAnimationsEnabled:!0,flatListController:this.flatListController,direction:"vertical",data:t,renderItem:this.renderItem}):r.default.createElement(c.ListStatus,null),r.default.createElement("div",{className:S.default.listPanel},r.default.createElement(D,{statusV3:this.state.myStatus,onOpenStatus:this.props.onOpenStatus}),r.default.createElement(h.default,{className:S.default.listBody,flatListControllers:[this.flatListController]},e))}}b.displayName="StatusV3ListPanel";class D extends r.Component{render(){var e,t,a,l=this.props.statusV3;l&&(a=l.msgs);var s,d,c,f,h=()=>{var e=l&&l.msgs;l&&e&&e.length&&this.props.onOpenStatus(l,e.head(),0)};if(l&&a&&a.length){e=r.default.createElement(y.default,{statusV3:l,contact:l.contact,onClick:h});var p=(0,i.default)(a.last(),"myMsgs.last()").t;t=r.default.createElement("span",{className:S.default.secondaryHeaderText},o.default.relativeDateAndTimeStr(p)),d={cursor:"pointer"},s=h}else e=r.default.createElement(u.default,{id:(0,m.getMaybeMeUser)(),theme:"status_v3",size:40}),t=r.default.createElement("span",{"data-a8n":n.default.key("status-no-updates"),className:S.default.secondaryHeaderText},g.default.t(1411));v.default.supportsFeature(v.default.F.STATUS_V3_UI_SENDING)&&(c=r.default.createElement(I.default,{name:"menu"}),f=r.default.createElement(I.default,{name:"status-v3-create"}));var E=r.default.createElement("span",{"data-a8n":n.default.key("my-status"),className:S.default.primaryHeaderText},g.default.t(1410));return r.default.createElement("div",{className:S.default.panelHeader,style:d,onClick:s},r.default.createElement("div",{className:S.default.headerButtonsPrimary},e),r.default.createElement("div",{className:S.default.headerText},E,t),r.default.createElement("div",{className:S.default.headerButtonsSecondary},f,c))}}D.displayName="StatusV3ListHeader";var N=(0,E.default)(b);t.default=N},84361:(e,t,a)=>{"use strict";var l=a(20862),s=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(a(94184)),r=l(a(67294)),n=s(a(97420)),o=a(56726),d=s(a(48878)),u=s(a(23519)),c=s(a(13154)),f=s(a(15750)),h=s(a(40577)),p=s(a(62745));class m extends r.Component{constructor(e){super(e),this._onStatusAddRemove=()=>{this.setState({status:u.default.getMyStatus()})},this.state={status:u.default.getMyStatus()}}shouldComponentUpdate(e,t){return t.status!==this.state.status}componentDidMount(){var{sessionId:e,listeners:t}=this.props;(0,o.setLastStatusUsage)(),t.add(u.default,"add remove",this._onStatusAddRemove),t.add(n.default,"dismiss_status_v3_viewer",(()=>{this.props.closeStatusViewer(!0)})),null!=e&&u.default.logMetrics({type:"session",sessionId:e})}render(){var{onOpenStatus:e}=this.props,t=(0,i.default)(f.default.v3_x,{});return r.default.createElement("div",{className:f.default.modalBackground,"data-animate-status-v3-modal-background":!0},r.default.createElement("div",{className:f.default.mainWrapper},r.default.createElement(c.default,{onOpenStatus:e}),r.default.createElement(h.default,{status:this.state.status,onOpenStatus:e}),r.default.createElement("button",{className:t,onClick:()=>this.props.closeStatusViewer(!0)},r.default.createElement(p.default,{name:"x-viewer"}))))}}m.displayName="StatusV3Main";var v=(0,d.default)(m);t.default=v},40577:(e,t,a)=>{"use strict";var l=a(95318),s=a(20862);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(a(67294)),r=l(a(62067)),n=l(a(56656)),o=l(a(27890)),d=a(66274),u=s(a(92246)),c=l(a(60246)),f=l(a(66761)),h=l(a(48878)),p=l(a(43174)),m=l(a(52206)),v=l(a(17363)),g=l(a(86020)),E=l(a(9479)),_=l(a(62745));class C extends i.Component{render(){var e,t,a=i.default.createElement(y,{statusV3:this.props.status,onOpenStatus:this.props.onOpenStatus});return c.default.supportsFeature(c.default.F.STATUS_V3_UI_SENDING)&&(e=i.default.createElement("div",{className:g.default.updateWrapper},i.default.createElement("div",{className:g.default.updateTitle},f.default.t(1416)),i.default.createElement("div",{className:g.default.uploadButtons},i.default.createElement("div",{className:g.default.buttonContainer},i.default.createElement(_.default,{name:"status-v3-upload",className:g.default.buttonIcon}),f.default.t(1417)),i.default.createElement("div",{className:g.default.buttonContainer},i.default.createElement(_.default,{name:"status-v3-camera",className:g.default.buttonIcon}),f.default.t(1405)))),t=i.default.createElement("hr",null)),i.default.createElement("div",{className:g.default.outStatusPanel},e,t,a)}}C.displayName="StatusV3OutStatusPanel";class S extends i.Component{constructor(...e){super(...e),this.rerender=()=>{this.forceUpdate()}}componentDidMount(){var{statusV3:e,listeners:t}=this.props;e&&(t.add(e,"change:msgsChanged",this.rerender),e.loadMore(e.totalCount).catch((e=>{__LOG__(3)`error while loading all out status: ${String(e)}`})))}componentDidUpdate(e){var{listeners:t,statusV3:a}=this.props,{statusV3:l}=e;l!==a&&(l&&t.remove(l,"change:msgsChanged",this.rerender),a&&t.add(a,"change:msgsChanged",this.rerender))}render(){var e=this.props.statusV3;if(e&&e.msgs.length>0){var t=e.msgs.map((t=>i.default.createElement(M,{key:t.id.toString(),msg:t,status:e,onOpenStatus:this.props.onOpenStatus})));return i.default.createElement("div",{className:g.default.viewWrapper},i.default.createElement("div",{className:g.default.viewTitle},f.default.t(1419)),i.default.createElement("div",{className:g.default.viewUpdates},t))}return i.default.createElement("div",{className:g.default.viewWrapper},i.default.createElement("div",{className:g.default.placeholderIcon},i.default.createElement(_.default,{name:"status-v3-placeholder"})),i.default.createElement("div",{"data-a8n":r.default.key("status-placeholder"),className:g.default.placeholderText},f.default.t(1412)))}}S.displayName="StatusV3OutViewerImpl";var y=(0,h.default)(S);class I extends i.Component{constructor(){super(...arguments),this.state={}}componentDidMount(){p.default.find(this.props.msg.id).checkpoint(this.props.rejectOnUnmount()).then((e=>{this.props.listeners.add(e.read,"add remove",(()=>{this.setState({seenCount:e.read.length})})),this.setState({seenCount:e.read.length})})).catchType(u.Unmount,(()=>{})).catchType(d.EphemeralDrop,(()=>{}))}render(){var e,{msg:t,status:a}=this.props;e=void 0!==this.state.seenCount?i.default.createElement(i.default.Fragment,null,i.default.createElement(_.default,{name:"status-v3-seen",className:g.default.iconSeen}),i.default.createElement("div",{className:g.default.seenCount},this.state.seenCount)):i.default.createElement(v.default,{stroke:3,size:12});var l=i.default.createElement(o.default,{id:t.sender,theme:"status_v3",size:80});return i.default.createElement("div",{className:g.default.outDetail},i.default.createElement(E.default,{statusV3:a,msg:t,onClick:()=>this.props.onOpenStatus(a,t),contact:a.contact,role:"button",theme:"status-panel",thumbnailPlaceholder:l}),i.default.createElement("div",{className:g.default.seen},e),i.default.createElement("div",{className:g.default.timestamp},n.default.relativeDateAndTimeStr(t.t)))}}I.displayName="StatusV3OutDetailImpl";var M=(0,m.default)((0,h.default)(I)),P=C;t.default=P},71530:(e,t,a)=>{"use strict";var l=a(95318),s=a(20862);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(a(67294)),r=l(a(97420)),n=l(a(58743)),o=l(a(66761)),d=l(a(25232)),u=l(a(69245)),c=l(a(97819));class f extends i.PureComponent{constructor(...e){super(...e),this.state={theme:"system"},this._handleThemeChange=e=>{var t=e.target.value;"light"!==t&&"dark"!==t&&"system"!==t||this.setState({theme:t})},this._handleOk=()=>{var{theme:e}=this.state;"system"===e?(this.context.setSystemThemeMode(!0),this.context.setTheme(u.default.currentTheme)):(this.context.setSystemThemeMode(!1),this.context.setTheme(e)),r.default.closeModal()},this._handleCancel=()=>{r.default.closeModal()}}componentDidMount(){this.setState({theme:this.context.systemThemeMode?"system":this.context.theme})}render(){var{theme:e}=this.state;return i.default.createElement(n.default,{title:o.default.t(1459),onOK:this._handleOk,onCancel:this._handleCancel},i.default.createElement("form",null,i.default.createElement("ol",null,i.default.createElement("li",{key:"light"},i.default.createElement("label",{className:d.default.label},i.default.createElement("input",{type:"radio",name:"theme",value:"light",className:d.default.input,checked:"light"===e,onChange:this._handleThemeChange}),o.default.t(1458))),i.default.createElement("li",{key:"dark"},i.default.createElement("label",{className:d.default.label},i.default.createElement("input",{type:"radio",name:"theme",value:"dark",className:d.default.input,checked:"dark"===e,onChange:this._handleThemeChange}),o.default.t(1457))),i.default.createElement("li",{key:"system"},i.default.createElement("label",{className:d.default.label},i.default.createElement("input",{type:"radio",name:"theme",value:"system",className:d.default.input,checked:"system"===e,onChange:this._handleThemeChange}),o.default.t(1460))))))}}t.default=f,f.contextType=c.default,f.displayName="ThemePopup"},57236:(e,t,a)=>{"use strict";var l=a(95318),s=a(20862);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(a(67294)),r=l(a(18917)),n=l(a(97420)),o=l(a(58743)),d=l(a(98712)),u=l(a(66761));class c extends i.Component{constructor(...e){super(...e),this.onCancel=()=>{n.default.closeModal()},this._onUnstar=()=>{var e=this.props.chat,t=this.props.msgs;e&&e.pendingAction++,r.default.unstarAllMessages(t,e).finally((()=>{e&&e.pendingAction--})),n.default.closeModal()}}render(){return i.default.createElement(o.default,{onOK:this._onUnstar,okText:u.default.t(1477),onCancel:this.onCancel},i.default.createElement("div",null,i.default.createElement(d.default,{text:u.default.t(1478)})))}}t.default=c,c.displayName="UnstarAllPopup"},83779:(e,t,a)=>{"use strict";var l=a(95318),s=a(20862);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(a(67294)),r=a(6653),n=l(a(3395)),o=l(a(34727)),d=s(a(85002)),u=l(a(98712)),c=l(a(79766)),f=l(a(66761)),h=s(a(18467)),p=l(a(92120)),m=l(a(62745)),v=l(a(83314)),g=l(a(18075)),E=a(7878);class _ extends i.Component{render(){var e,{contactList:t,onSend:a,onBack:l,chat:s}=this.props;switch(s.kind){case r.CHAT_KIND.CHAT:e=f.default.t(561,{chat:s.title(),count:f.default.n(t.length),_plural:t.length});break;case r.CHAT_KIND.GROUP:e=f.default.t(562,{chat:s.title(),count:f.default.n(t.length),_plural:t.length});break;case r.CHAT_KIND.BROADCAST:e=f.default.t(560,{chat:s.title(),count:f.default.n(t.length),_plural:t.length})}var g=e?i.default.createElement(u.default,{text:e,direction:"auto",titlify:!0,ellipsify:!0}):null;return i.default.createElement(h.default,{type:h.BoxModalType},i.default.createElement(n.default,null,i.default.createElement(d.default,{type:d.DRAWER_HEADER_TYPE.POPUP,onBack:l},g),i.default.createElement(o.default,null,i.default.createElement(c.default,null,i.default.createElement("div",{className:v.default.body},t.map(((e,t)=>this._renderVcard((0,E.vcardFromContactModel)(e),t.toString())))))),i.default.createElement("div",{className:v.default.btnContainer},i.default.createElement("div",{className:v.default.btnPosition},i.default.createElement(p.default,{large:!0,onClick:a},i.default.createElement(m.default,{name:"send",directional:!0}))))))}_renderVcard(e,t){var a=(0,E.parseVcard)(e.vcard);return a?i.default.createElement("div",{key:t,className:v.default.vcardWrapper},i.default.createElement(g.default,{parsedVcard:a,thumbnail:(0,E.vcardThumbnail)(a)})):null}}t.default=_,_.displayName="VcardConfirmModal"},45636:(e,t,a)=>{"use strict";var l=a(20862),s=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(a(94184)),r=a(54972),n=s(a(31339)),o=l(a(67294)),d=s(a(27413)),u=s(a(27306)),c=s(a(97420)),f=s(a(46274)),h=s(a(69107)),p=s(a(80908)),m=s(a(3395)),v=s(a(34727)),g=l(a(85002)),E=l(a(92246)),_=s(a(91072)),C=a(78572),S=a(68816),y=a(39655),I=a(56726),M=s(a(99213)),P=s(a(60246)),L=l(a(15178)),T=s(a(28204)),b=a(64724),D=s(a(66761)),N=s(a(48878)),O=l(a(8336)),w=s(a(52206)),k=s(a(31516)),R=a(80493),A=s(a(60138)),x=s(a(17363)),F=s(a(82286)),U=s(a(62745)),B=a(45739),H=s(a(10937)),G=s(a(17040)),V=s(a(28149)),j=a(39159),W=s(a(18136));class K extends o.Component{constructor(...e){super(...e),this.state={hover:!1,currentQRBinary:null,currentQRData:null},this.onMouseOver=()=>{this.state.hover||this.setState({hover:!0})},this.onMouseEnter=()=>{this.state.hover||this.setState({hover:!0})},this.onMouseLeave=()=>{this.state.hover&&this.setState({hover:!1})},this._setRefQRCodeContainer=e=>{this._refQRCodeContainer=e}}componentDidMount(){this.props.binary&&this._generateQRCode()}componentDidUpdate(){this._generateQRCode()}shouldComponentUpdate(e,t){return!(this._compareBinary(e.binary,this.props.binary)&&this._compareBinary(t.currentQRBinary,this.state.currentQRBinary)&&e.visible===this.props.visible&&t.hover===this.state.hover&&t.currentQRData===this.state.currentQRData)}_fingerprintsMatched(e,t){return!!e&&!!t&&oe(e.publicKey,t.publicKey)&&oe(e.identifier,t.identifier)}_compareBinary(e,t){if(!e&&!t)return!0;var a=(0,r.decodeProto)(y.CombinedFingerprintSpec,e),l=(0,r.decodeProto)(y.CombinedFingerprintSpec,t);if(!a&&!l)return!0;if(!(null!=a.version||null!=l.version||a.localFingerprint||l.localFingerprint||a.remoteFingerprint||l.remoteFingerprint))return!0;if(a.version!==l.version)return!1;var s=this._fingerprintsMatched(a.localFingerprint,l.localFingerprint),i=this._fingerprintsMatched(a.remoteFingerprint,l.remoteFingerprint);return s&&i}_generateQRCode(){var e=this._refQRCodeContainer,t=this.props.binary;if(e&&t){if(!this._compareBinary(this.state.currentQRBinary,t)){for(this.qr&&delete this.qr;e.firstChild;)e.removeChild(e.firstChild);this.qr=new k.default(e,{text:t,width:f.default.QR_EDGE/2,height:f.default.QR_EDGE/2,correctLevel:k.default.CorrectLevel.L}),this.setState({currentQRBinary:t});var a=e.getElementsByTagName("canvas")[0];a?this._storeQRData(a):this.setState({currentQRData:null})}}else this.setState({currentQRBinary:null,currentQRData:null})}_storeQRData(e){var t=document.createElement("canvas");t.width=e.width+10,t.height=e.height+10;var a=t.getContext("2d");a.fillStyle="white",a.fillRect(0,0,t.width,t.height),a.drawImage(e,5,5),t.toBlob((e=>this.setState({currentQRData:e})),"image/png")}render(){var e=null;if(this.props.visible){var t=null;if(this.state.hover&&this.state.currentQRData){var a=this.props.contact.formattedUser||"",l=h.default.assertGet((0,I.getMaybeMeUser)()).formattedUser;t=o.default.createElement(p.default,{file:this.state.currentQRData,download:"Verification Code between "+l+" and "+a,extension:S.AllowedFileExtensions.PNG},o.default.createElement(d.default,{text:D.default.t(1947)}))}e=o.default.createElement("div",{onMouseOver:this.onMouseOver,onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave},t,o.default.createElement("div",{className:G.default.circle,ref:this._setRefQRCodeContainer}))}return e}}function z({visible:e}){var t=null;return e&&(t=o.default.createElement("div",{className:G.default.circle},o.default.createElement("div",{className:G.default.spinner},o.default.createElement(x.default,{size:52,stroke:4})))),t}function Y({binary:e,contact:t,visible:a}){var l=null;return a&&(l=o.default.createElement("div",{className:(0,i.default)(G.default.container,G.default.circleContainer)},o.default.createElement(K,{visible:!!e,binary:e,contact:t}),o.default.createElement(z,{visible:!e}))),l}K.defaultProps={binary:null},K.displayName="VerificationQRCode";class q extends o.Component{shouldComponentUpdate(e){return e.string!==this.props.string}_numDigitsInVerificationString(){return 60}render(){if(!this.props.string)return o.default.createElement("div",null,D.default.t(960));var e=this.props.string;if(e.length!==this._numDigitsInVerificationString())return __LOG__(3)`verificationString:render this.props.stringshould be ${this._numDigitsInVerificationString()} characters long instead of ${e.length}.`,o.default.createElement("div",null,D.default.t(1953));for(var t=[],a=0;a<3;a++){for(var l=[],s=0;s<4;s++){for(var i=[],r=0;r<5;r++){var n=e.charAt(5*a*4+5*s+r);i.push(o.default.createElement("span",{className:G.default.digit,key:r},n))}l.push(o.default.createElement("span",{className:G.default.block,key:s},i))}t.push(o.default.createElement(R.SelectableDiv,{className:G.default.row,key:a,selectable:!0},l))}return o.default.createElement(R.SelectableDiv,{selectable:!0},t)}}function Z({visible:e}){var t=null;return e&&(t=o.default.createElement("div",{className:(0,i.default)(G.default.container,G.default.checkmarkContainer)},o.default.createElement("div",{className:G.default.checkmark}," "))),t}function $({visible:e}){var t=null;return e&&(t=o.default.createElement("div",{className:(0,i.default)(G.default.container,G.default.errorContainer)},o.default.createElement("div",{className:G.default.error},"!"))),t}function X({children:e}){return o.default.createElement("div",{className:G.default.errorBanner},e)}q.defaultProps={string:null},q.displayName="VerificationString";class J extends o.Component{constructor(...e){super(...e),this._refVerificationVideo=(0,o.createRef)(),this.onVideoLoaded=()=>{null==this._captureInterval&&(this._adjustOverlayPosition(),this._captureInterval=this.props.setInterval(this.capture,200))},this.capture=()=>{var e,t=null===(e=this._refVerificationVideo.current)||void 0===e?void 0:e.underlyingVideo();if(t){var a=document.createElement("canvas");a.width=t.videoWidth/2,a.height=t.videoHeight/2,a.getContext("2d").drawImage(t,a.width/2,a.height/2,a.width,a.height,0,0,a.width,a.height),a.toBlob((e=>{var t=window.URL.createObjectURL(e);__LOG__(2)`objectURL: ${t}`,this.props.onCapture(t)}),"image/jpeg",1)}},this._adjustOverlayPosition=()=>{var e,t=null===(e=this._refVerificationVideo.current)||void 0===e?void 0:e.underlyingVideo(),a=this._refVerificationOverlay;if(t&&a){var l=t.offsetHeight,s=t.offsetWidth,i=s/3,r=i;a.style.width=i+"px",a.style.height=r+"px",a.style.margin=(l-r)/2+"px "+(s-i)/2+"px"}},this._setRefVerificationOverlay=e=>{this._refVerificationOverlay=e}}componentDidMount(){this.props.listeners.add(window,"resize",this._adjustOverlayPosition),(0,O.isSrcObjectInVideoElement)()||(this._videoURL=window.URL.createObjectURL(this.props.stream))}componentWillUnmount(){var e,t;null!=this._captureInterval&&this.props.clearInterval(this._captureInterval),this.props.stream&&(null===(e=(t=this.props).disposeStream)||void 0===e||e.call(t),this._videoURL&&window.URL.revokeObjectURL(this._videoURL))}render(){var e=null;return this.props.stream&&(e=o.default.createElement("div",{className:G.default.webcam},o.default.createElement("div",{className:G.default.webcamVideo},o.default.createElement(V.default,{autoPlay:!0,ref:this._refVerificationVideo,onPlay:this.onVideoLoaded,src:this._videoURL?this._videoURL:void 0,srcObject:this._videoURL?void 0:this.props.stream,width:"100%"})),o.default.createElement("div",{className:G.default.overlay,ref:this._setRefVerificationOverlay}),o.default.createElement("button",{onClick:this.props.onClose,className:G.default.btnClose},o.default.createElement(U.default,{name:"x-alt"})))),e}}J.displayName="VerificationWebcamComponent";var Q=(0,N.default)((0,H.default)(J)),ee=0,te=1,ae=2,le=3,se=4,ie=5;class re extends o.Component{constructor(...e){super(...e),this.state={circleVisible:!0,checkmarkVisible:!1,errorIconVisible:!1,webcamVisible:!1,bannerVisible:!1,bannerText:null,stream:null,isDragging:!1,binaryMD:null,stringMD:null},this._onIdentityKeyMissing=()=>{c.default.openModal(o.default.createElement(A.default,{name:this.props.contact.formattedUser,onOK:()=>{this.props.onClose?this.props.onClose():this.props.uim.uie.requestDismiss()}}))},this.onDragChange=e=>{this.setState({isDragging:e})},this.onDrop=e=>{this.props.contact.verificationBinary&&this.props.contact.verificationString&&this._onUploadSelect(e)},this._setIdentityState=()=>{(0,W.default)(this.props.contact.id).checkpoint(this.props.rejectOnUnmount()).then((e=>{e?(oe(this.state.binaryMD,e.binary)&&!e.string!==this.state.stringMD||(null!=this.state.binaryMD&&c.default.openModal(o.default.createElement(j.E2EChangeModal,{contact:this.props.contact})),this.setState({binaryMD:e.binary,stringMD:e.string})),this._refreshTimer=this.props.setTimeout((()=>{this._setIdentityState()}),1e3)):(null!=this._refreshTimer&&this.props.clearTimeout(this._refreshTimer),this._onIdentityKeyMissing())})).catchType(E.Unmount,(()=>{}))},this._showWebcamHint=()=>{this.state.webcamVisible&&!this.state.bannerVisible&&this._showBanner(D.default.t(1957))},this._onWebcamOpen=()=>{var{asyncStream:e,disposeStream:t}=O.start("camera");this._disposeStream=t,e.then((e=>this._showWebcamStream(e))).catchType(E.GUM.NotAllowedError,(()=>{c.default.openModal(o.default.createElement(L.default,{messaging:L.Messaging.CAMERA_FAIL,type:L.default.TYPE.GUIDE_UNBLOCK}))})).catchType(E.GUM.GUMError,(()=>{c.default.openModal(o.default.createElement(L.default,{messaging:L.Messaging.CAMERA_MISSING,type:L.default.TYPE.GUIDE_NONE}))}))},this._onWebcamClose=()=>{this.setState({webcamVisible:!1,bannerVisible:!1,stream:null}),this._disposeStream=null},this._onWebcamCapture=e=>{this._verifyImage(e,!0)},this._onUploadClick=()=>{var e=this._refVerificationFilePickerInput;e&&e.click()},this._onUploadSelect=e=>{e.stopPropagation();var t=e.target.files||e.dataTransfer.files;if(t&&t[0]){var a=t[0],l=URL.createObjectURL(a);this._verifyImage(l,!1);var s=this._refVerificationFilePickerForm;s&&s.reset()}},this.onClose=()=>{this.props.onClose?this.props.onClose():this.props.uim.uie.requestDismiss()},this._hideCheckmark=()=>{this.state.errorIconVisible||this.setState({circleVisible:!0}),this.setState({checkmarkVisible:!1})},this._hideError=()=>{this.state.checkmarkVisible||this.setState({circleVisible:!0}),this.setState({errorIconVisible:!1})},this._hideBanner=()=>{this.setState({bannerVisible:!1})},this._setRefVerificationFilePickerForm=e=>{this._refVerificationFilePickerForm=e},this._setRefVerificationFilePickerInput=e=>{this._refVerificationFilePickerInput=e}}componentDidMount(){P.default.supportsFeature(P.default.F.MD_BACKEND)?this._setIdentityState():(0,b.queryIdentity)(this.props.contact)}componentDidUpdate(e){e.contact===this.props.contact||P.default.supportsFeature(P.default.F.MD_BACKEND)||(0,b.queryIdentity)(this.props.contact)}componentWillUnmount(){var e;null===(e=this._disposeStream)||void 0===e||e.call(this)}_showWebcamStream(e){this.setState({webcamVisible:!0,circleVisible:!0,checkmarkVisible:!1,errorIconVisible:!1,stream:e}),null!=this._hintTimer&&(this.props.clearTimeout(this._hintTimer),delete this._hintTimer),this._hintTimer=this.props.setTimeout(this._showWebcamHint,7e3)}_getErrorBannerText(e){var t,a=this.props.contact.formattedShortName;switch(e){case ae:t=D.default.t(1951,{contact:a});break;case le:case se:t=D.default.t(1950,{contact:a});break;case ie:default:t=D.default.t(1949)}return t}_showCheckmark(){this._onWebcamClose(),this.setState({circleVisible:!1,checkmarkVisible:!0,errorIconVisible:!1,bannerVisible:!1}),null!=this._iconTimer&&(this.props.clearTimeout(this._iconTimer),delete this._iconTimer),this._iconTimer=this.props.setTimeout(this._hideCheckmark,3e3)}_showErrorIcon(){this._onWebcamClose(),this.setState({circleVisible:!1,checkmarkVisible:!1,errorIconVisible:!0,bannerVisible:!1}),null!=this._iconTimer&&(this.props.clearTimeout(this._iconTimer),delete this._iconTimer),this._iconTimer=this.props.setTimeout(this._hideError,3e3)}_showErrorBanner(e){var t=this._getErrorBannerText(e);this._showBanner(t)}_showBanner(e){this.setState({circleVisible:!0,checkmarkVisible:!1,errorIconVisible:!1,bannerVisible:!0,bannerText:e}),null!=this._bannerTimer&&(this.props.clearTimeout(this._bannerTimer),delete this._bannerTimer),this._bannerTimer=this.props.setTimeout(this._hideBanner,5e3)}_validateFingerprint(e){if(!e||0===!e.version||!e.localFingerprint||!e.remoteFingerprint)return ie;var t=new ArrayBuffer(0);t=P.default.supportsFeature(P.default.F.MD_BACKEND)?this.state.binaryMD:this.props.contact.verificationBinary;var a=(0,r.decodeProto)(y.CombinedFingerprintSpec,t);if(oe(e.localFingerprint&&e.localFingerprint.identifier,a.localFingerprint&&a.localFingerprint.identifier)&&oe(e.remoteFingerprint&&e.remoteFingerprint.identifier,a.remoteFingerprint&&a.remoteFingerprint.identifier))return ee;var l=oe(e.remoteFingerprint&&e.remoteFingerprint.identifier,a.localFingerprint&&a.localFingerprint.identifier),s=oe(e.localFingerprint&&e.localFingerprint.identifier,a.remoteFingerprint&&a.remoteFingerprint.identifier);if(!l&&!s)return se;if(!l)return ae;if(!s)return le;var i=oe(e.remoteFingerprint&&e.remoteFingerprint.publicKey,a.localFingerprint&&a.localFingerprint.publicKey),n=oe(e.localFingerprint&&e.localFingerprint.publicKey,a.remoteFingerprint&&a.remoteFingerprint.publicKey);return i&&n?ee:te}_decodeQRCode(e){return new Promise(((t,a)=>{n.default.callback=(e,l)=>{if(l)a(l);else if(e.length<1)a("QR decoder did not return decoded binary");else{var s=new Uint8Array(e[0]);t(s)}},n.default.decode(e)}))}_verifyImage(e,t){this._decodeQRCode(e).then((e=>(0,r.decodeProto)(y.CombinedFingerprintSpec,e))).then((e=>{var a=this._validateFingerprint(e);a?t&&a===ie||(this.setState({errorType:a}),a===te?this._showErrorIcon():this._showErrorBanner(a)):this._showCheckmark()})).catch((()=>{t||(this.setState({errorType:ie}),this._showErrorBanner(ie))})).finally((()=>{window.URL.revokeObjectURL(e)}))}render(){var e=null,t=null,a=null,l=null,s=null,i=null,r=new ArrayBuffer(0),n="";return P.default.supportsFeature(P.default.F.MD_BACKEND)?(r=this.state.binaryMD,n=this.state.stringMD,i=D.default.t(1804,{contactName:this.props.contact.formattedShortName})):(r=this.props.contact.verificationBinary,n=this.props.contact.verificationString,i=D.default.t(1952)),r&&(M.default&&(e=o.default.createElement("div",{className:G.default.section},o.default.createElement(u.default,{type:"primary",onClick:this.state.webcamVisible?this._onWebcamClose:this._onWebcamOpen},this.state.webcamVisible?D.default.t(1956):D.default.t(1958)))),t=o.default.createElement("div",{className:G.default.section},o.default.createElement(u.default,{type:"primary",onClick:this._onUploadClick},D.default.t(1955)),o.default.createElement("p",{className:G.default.dragAndDropExplanation},this.state.isDragging?D.default.t(1948):null)),a=o.default.createElement("form",{ref:this._setRefVerificationFilePickerForm},o.default.createElement("input",{ref:this._setRefVerificationFilePickerInput,accept:"image/*",type:"file",style:{display:"none"},onChange:this._onUploadSelect,onClick:e=>e.stopPropagation()}))),this.state.webcamVisible&&this.state.stream&&(l=o.default.createElement(Q,{stream:this.state.stream,disposeStream:this._disposeStream,onCapture:this._onWebcamCapture,onClose:this._onWebcamClose})),this.state.bannerVisible&&(s=o.default.createElement(X,null,this.state.bannerText)),o.default.createElement(m.default,{theme:"verification",onDrop:this.onDrop,onDragChange:this.onDragChange},o.default.createElement(g.default,{type:g.DRAWER_HEADER_TYPE.SMALL,onBack:this.onClose},o.default.createElement(B.TextDiv,{theme:"title"},D.default.t(1954)),o.default.createElement(B.TextDiv,{theme:"small"},D.default.t(1964),", ",this.props.contact.formattedUser)),l,s,o.default.createElement(v.default,null,o.default.createElement("div",{className:G.default.form},o.default.createElement("div",{className:G.default.photo},o.default.createElement(Y,{binary:r,contact:this.props.contact,visible:this.state.circleVisible}),o.default.createElement(Z,{visible:this.state.checkmarkVisible}),o.default.createElement($,{visible:this.state.errorIconVisible})),o.default.createElement("div",{className:G.default.section},o.default.createElement("div",{className:G.default.code},o.default.createElement(q,{string:n}))),o.default.createElement("div",{className:G.default.section},o.default.createElement("p",{className:G.default.explanation},o.default.createElement("span",null,i,""),o.default.createElement(_.default,{href:(0,C.getE2EFaqUrl)()},D.default.t(919)))),e,t,a)))}}re.CONCERNS={contact:["verificationBinary","verificationString","formattedUser","formattedShortName","id"]},re.displayName="VerificationDrawer";var ne=(0,T.default)((0,w.default)((0,H.default)((0,F.default)(re,re.CONCERNS))));function oe(e,t){if(!e||!t)return!1;var a=new Uint8Array(e),l=new Uint8Array(t),s=a.length;if(s!==l.length)return!1;for(var i=0;i<s;i++)if(a[i]!==l[i])return!1;return!0}t.default=ne},2990:(e,t,a)=>{"use strict";var l=a(20862),s=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(a(94184)),r=l(a(67294)),n=s(a(62067)),o=s(a(28383)),d=s(a(73132)),u=s(a(97420)),c=s(a(46274)),f=s(a(3395)),h=s(a(34727)),p=l(a(85002)),m=s(a(66761)),v=s(a(86981)),g=s(a(82286)),E=a(45739),_=s(a(97819)),C=l(a(9931)),S=a(78263),y=s(a(26163));class I extends r.Component{constructor(...e){super(...e),this.state={hover:!1},this.onClick=()=>{var e=this._encodeColor(),t=o.default.get("defaultPreference");t&&e!==t.wallpaperColor&&(t.set("wallpaperColor",e),u.default.openToast(r.default.createElement(C.default,{msg:m.default.t(1634),id:(0,C.genId)()})))},this.onMouseOver=()=>{this.state.hover||(this.setState({hover:!0}),o.default.trigger("wallpaper_color_preview",this._encodeColor()))},this.onMouseEnter=()=>{this.state.hover||(this.setState({hover:!0}),o.default.trigger("wallpaper_color_preview",this._encodeColor()))},this.onMouseLeave=()=>{this.state.hover&&(this.setState({hover:!1}),o.default.trigger("wallpaper_color_preview"))},this._encodeColor=()=>{var{colorHex:e,isDefault:t}=this.props;return t?c.default.DEFAULT_CHAT_WALLPAPER:e}}render(){var e=this.props.isDefault?r.default.createElement("span",{className:y.default.wallpaperDefaultTitle,"data-a8n":n.default.key("wallpaper-default-title")},m.default.t(597)):null,t=(0,i.default)(y.default.wallpaperColorCanvas,{[y.default.canvasHover]:this.state.hover,[y.default.canvasActive]:this.props.isSelected,[y.default.canvasDefault]:this.props.isDefault});return r.default.createElement("span",{className:t,style:{backgroundColor:this.props.colorHex},onMouseOver:this.onMouseOver,onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,onClick:this.onClick,title:this.props.isDefault?m.default.t(597):null},e)}}I.displayName="ColorCanvas";class M extends r.Component{constructor(...e){super(...e),this._onWallpaperDoodleChange=()=>{var{chatPreference:e}=this.props;if(e){var t=!e.showDoodle;e.set("showDoodle",t),u.default.openToast(r.default.createElement(C.default,{msg:t?m.default.t(1635):m.default.t(1636),id:(0,C.genId)()}))}}}render(){var e,{chatPreference:t,colors:a}=this.props,l=t&&t.wallpaperColor,s=t&&t.showDoodle,i=a.map((e=>r.default.createElement(I,{colorHex:e,isSelected:l===e,isDefault:!1,key:e}))),n=r.default.createElement(I,{isSelected:l===c.default.DEFAULT_CHAT_WALLPAPER,isDefault:!0,key:c.default.DEFAULT_CHAT_WALLPAPER});i.unshift(n);for(var o=0;o<2;o++)i.push(r.default.createElement("div",{key:"emptyEl"+o,className:y.default.wallpaperColorEmpty}));return v.default.wallpapersV2&&(e=r.default.createElement("div",{className:y.default.wallpaperApplyDoodle},r.default.createElement(d.default,{onChange:this._onWallpaperDoodleChange,checked:!!s}),r.default.createElement(E.TextSpan,{className:y.default.checkboxLabel,theme:"small"},m.default.t(1633)))),r.default.createElement(r.default.Fragment,null,e,r.default.createElement("div",{className:y.default.wallpaperColorGrid},i))}}M.CONCERNS={chatPreference:["wallpaperColor","showDoodle"]},M.displayName="ColorGridClass";var P=(0,g.default)(M,M.CONCERNS);class L extends r.Component{componentWillUnmount(){o.default.trigger("wallpaper_color_preview"),v.default.wallpapersV2&&o.default.trigger("wallpaper_drawer_close")}componentDidMount(){v.default.wallpapersV2&&o.default.trigger("wallpaper_drawer_open")}render(){return r.default.createElement(f.default,null,r.default.createElement(p.default,{title:m.default.t(1637),onBack:this.props.onClose,type:p.DRAWER_HEADER_TYPE.LARGE}),r.default.createElement(h.default,null,r.default.createElement(P,{colors:(0,S.getWallpaperColors)(this.context.theme),chatPreference:o.default.get("defaultPreference")})))}}t.default=L,L.contextType=_.default,L.displayName="WallpaperDrawer"},43851:(e,t,a)=>{"use strict";var l=a(95318),s=a(20862);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(a(67294)),r=l(a(56656)),n=l(a(97420)),o=l(a(58743)),d=s(a(25246)),u=l(a(3395)),c=l(a(34727)),f=s(a(85002)),h=a(66274),p=l(a(95598)),m=l(a(12063)),v=l(a(66761)),g=l(a(50275)),E=l(a(55850)),_=l(a(23887)),C=a(45739);class S extends i.Component{constructor(e){super(e),this._orderFlatListController=new m.default,this.state={isLoading:!0,fetchState:"PENDING",order:null}}componentDidMount(){var{orderId:e,token:t,sellerJid:a}=this.props;g.default.findOrder(e,a,t).then((e=>{this.setState({fetchState:"SUCCESS",isLoading:!1,order:e})})).catchType(h.E404,(()=>{this._showNotFoundErrorToast(),this.setState({fetchState:"ERROR",isLoading:!1})})).catch((()=>{this.setState({fetchState:"ERROR",isLoading:!1}),__LOG__(4,!0,new Error,!0)`Catalog Order Display failed`,SEND_LOGS("OrderDetails: failed to display")}))}_getDrawerContent(){var{sellerJid:e}=this.props,{fetchState:t,order:a}=this.state;if(this.state.isLoading||null==a)return i.default.createElement(p.default,{fetchState:t});var l="";l=a.products.length>0?v.default.t(908,{count:a.totalItemCount||0,_plural:a.totalItemCount||0}):v.default.t(1218);var s=i.default.createElement(C.TextDiv,{theme:"title"},l),n=null;n=null!=a.total&&0!==a.total?v.default.t(1215,{subtotal:d.format(a.currency,a.total)}):v.default.t(1211);var o=i.default.createElement(C.TextDiv,{theme:"muted-small"},n),u=null;if(null!=a.createdAt){var c=r.default.timeStr(a.createdAt);u=i.default.createElement(C.TextSpan,{theme:"muted-small"},`${c}`)}return i.default.createElement(i.default.Fragment,null,i.default.createElement(p.default,{fetchState:t}),i.default.createElement("div",{className:E.default.info},s,o),i.default.createElement(_.default,{flatListController:this._orderFlatListController,onProductDetail:this.props.onProductDetail,order:a,sellerJid:e}),i.default.createElement("div",{className:E.default.date},u))}_showNotFoundErrorToast(){n.default.openModal(i.default.createElement(o.default,{onOK:()=>{n.default.closeModal()},okText:v.default.t(1826)},v.default.t(1212)))}onClose(){n.default.closeDrawerRight()}render(){var{userIsCartOwner:e}=this.props;return i.default.createElement(u.default,{theme:"striped",onDrop:this.onClose},i.default.createElement(f.default,{title:e?v.default.t(432):v.default.t(431),type:f.DRAWER_HEADER_TYPE.SMALL,onBack:this.onClose}),i.default.createElement(c.default,{flatListControllers:[this._orderFlatListController]},this._getDrawerContent()))}}t.default=S,S.displayName="OrderDetailDrawer"},23887:(e,t,a)=>{"use strict";var l=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var{order:t,onProductDetail:a,sellerJid:l}=e,f=e=>{var a=t.orderItemCollection.toArray();return(0,d.logOrderListImpression)({catalogContext:e,orderId:t.id,productCount:a.length,catalogOwnerJid:l}),a.map((e=>({itemKey:e.id.toString(),product:e})))};return s.default.createElement(r.default.Consumer,null,(t=>{var l=(0,c.getProductCatalogContext)(t);return s.default.createElement(o.default,{flatListControllers:[e.flatListController]},s.default.createElement(n.default,{flatListController:e.flatListController,direction:"vertical",forceConsistentRenderCount:!1,data:f(l),renderItem:t=>((t,l)=>{var{sellerJid:i}=e,{product:r}=t,n={productId:r.id,businessOwnerJid:i};return s.default.createElement(u.default,{product:r,onClick:()=>{(0,d.logOrderListItemClick)({catalogContext:l,orderId:e.order.id,catalogOwnerJid:i}),a(n)}})})(t,l),defaultItemHeight:i.default.PRODUCT_LIST_ITEM_HEIGHT}))}))};var s=l(a(67294)),i=l(a(46274)),r=l(a(31763)),n=l(a(47060)),o=l(a(3152)),d=a(25500),u=l(a(1999)),c=a(66248)},1999:(e,t,a)=>{"use strict";var l=a(20862),s=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var{product:t,onClick:a}=e,l=i.default.createElement(o.default,{text:t.name,ellipsify:!0,titlify:!0}),s=i.default.createElement(c.default,{mediaData:t.mediaData,theme:"list"}),h=d.default.t(1216,{quantity:t.quantity.toString()}),p=null;t.quantity&&(p=i.default.createElement(f.TextSpan,{className:u.default.quantity},h));var m=null;m=t.price&&0!==t.price?n.format(t.currency,t.price):d.default.t(424);var v=i.default.createElement(f.TextSpan,{className:u.default.price},m),g=null;null!=p&&(g=i.default.createElement("span",{className:u.default.separator},""));var E=i.default.createElement("div",null,v,g,p);return i.default.createElement(r.default,{key:t.id.toString(),image:s,customImage:!0,primary:l,secondary:E,theme:"order-product",onClick:a})};var i=s(a(67294)),r=s(a(79274)),n=l(a(25246)),o=s(a(98712)),d=s(a(66761)),u=s(a(20295)),c=s(a(38924)),f=a(45739)},54337:(e,t,a)=>{"use strict";var l=a(95318),s=a(20862);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(a(67294)),r=l(a(84816)),n=l(a(31763)),o=l(a(68770)),d=l(a(59474)),u=a(53615),c=l(a(66761)),f=l(a(77246)),h=a(94804),p=a(3875),m=a(66248),v=l(a(62745)),g=a(16241);class E extends i.PureComponent{_getCartIcon(){var{onCartClick:e,cartCount:t,catalogId:a}=this.props;if(e&&a){var l=(0,g.isNumber)(t)&&t>0?t.toString():void 0,s=(0,h.getOnCartClickWithLog)(e,a,(0,m.getProductCatalogContext)(this.context));return i.default.createElement(p.MenuBarItem,{a8nText:"menu-bar-cart-link",icon:i.default.createElement(r.default,{theme:"inherit-color"}),text:l,title:c.default.t(421),onClick:s})}return null}_getMenuItems(){var{canManageCatalog:e,onSendCatalog:t,onOpenCollections:a,onOpenSettings:l}=this.props;return e?i.default.createElement(p.MenuBarItem,{a8nText:"menu-bar-menu",icon:i.default.createElement(v.default,{name:"menu"}),title:c.default.t(1028)},i.default.createElement(o.default,{type:"dropdown_menu",flipOnRTL:!0,key:"CatalogDetailHeader",dirX:"LEFT"},i.default.createElement(d.default,{a8n:"mi-foward menu-item",action:t},c.default.t(747)),a&&i.default.createElement(d.default,{a8n:"mi-collections menu-item",action:a},c.default.t(544)),(0,u.canToggleCartOnOff)()&&l&&i.default.createElement(d.default,{a8n:"mi-settings menu-item",action:l},c.default.t(484)))):i.default.createElement(p.MenuBarItem,{a8nText:"menu-bar-catalog-link",icon:i.default.createElement(f.default,null),title:c.default.t(479),onClick:t})}render(){return i.default.createElement(i.default.Fragment,null,this._getCartIcon(),this._getMenuItems())}}t.default=E,E.contextType=n.default,E.displayName="DetailDrawerMenu"},40943:(e,t,a)=>{"use strict";var l=a(95318),s=a(20862);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.CatalogSettingsDrawer=void 0;var i=s(a(67294)),r=a(62601),n=l(a(99420)),o=l(a(93543)),d=l(a(97420)),u=l(a(3395)),c=l(a(34727)),f=s(a(85002)),h=l(a(25404)),p=a(78572),m=a(56726),v=l(a(66761)),g=l(a(48878)),E=l(a(52206)),_=l(a(37306)),C=l(a(17363)),S=a(45739),y=s(a(9931));function I({cartEnabled:e,setCartEnabled:t}){var a=a=>{t(a),(0,r.updateCartEnabled)(a).catch((()=>{__LOG__(4,!0,new Error,!0)`Failed to update cartEnabled value`,SEND_LOGS("updateCartEnabled: cartEnabled toggle error"),d.default.openToast(i.default.createElement(y.default,{msg:v.default.t(1991),duration:6e3,id:(0,y.genId)()})),t(e)}))},l=`\n    <a href="${(0,p.getCatalogCartOnOffFaqUrl)()}" target="_blank">\n      ${v.default.t(919)}\n    </a>`,s=v.default.t(482,{learn_more_link:l});return i.default.createElement(i.default.Fragment,null,i.default.createElement(h.default,{title:v.default.t(481),theme:"title-larger",animation:!1},i.default.createElement(_.default,{isChosen:e,onChoose:()=>{a(!0)},choiceText:v.default.t(486)}),i.default.createElement(_.default,{isChosen:!e,onChoose:()=>{a(!1)},choiceText:v.default.t(485)})),i.default.createElement(S.TextDiv,{theme:"plain",className:o.default.descriptionText},i.default.createElement("div",{dangerouslySetInnerHTML:{__html:s}})))}class M extends i.Component{constructor(e){super(e),this.updateCartEnabled=e=>{this.setState({cartEnabled:e})},this.state={isLoading:!0,cartEnabled:!1}}componentDidMount(){n.default.fetchBizProfile((0,m.getMeUser)()).then((e=>{var t=e.profileOptions;this.setState({cartEnabled:null!=t&&t.cartEnabled,isLoading:!1})})).catch((()=>{__LOG__(4,!0,new Error)`Error fetching the business profile.`,d.default.openToast(i.default.createElement(y.default,{msg:v.default.t(483),duration:6e3,id:(0,y.genId)()})),this.props.onBack()}))}_getDrawerContent(){return i.default.createElement(I,{cartEnabled:this.state.cartEnabled,setCartEnabled:this.updateCartEnabled})}render(){return i.default.createElement(u.default,{theme:"catalog",onDrop:this.props.onBack},i.default.createElement(f.default,{title:v.default.t(484),type:f.DRAWER_HEADER_TYPE.LARGE,onBack:this.props.onBack}),i.default.createElement(c.default,null,this.state.isLoading?i.default.createElement("div",{className:o.default.loadingSpinner},i.default.createElement(C.default,null)):this._getDrawerContent()))}}t.CatalogSettingsDrawer=M,M.displayName="CatalogSettingsDrawer";var P=(0,E.default)((0,g.default)(M));t.default=P},99568:(e,t,a)=>{"use strict";var l=a(20862),s=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.CatalogViewDrawer=void 0;var i=s(a(48926)),r=s(a(23493)),n=s(a(23279)),o=l(a(67294)),d=s(a(12772)),u=s(a(66281)),c=s(a(57984)),f=s(a(54337)),h=a(94360),p=s(a(87655)),m=s(a(46274)),v=s(a(3395)),g=s(a(34727)),E=l(a(85002)),_=a(84710),C=s(a(95598)),S=s(a(12063)),y=s(a(98607)),I=s(a(66761)),M=s(a(48878)),P=s(a(50187)),L=s(a(8685)),T=s(a(30401)),b=s(a(52206)),D=s(a(82286));class N extends o.Component{constructor(e){super(e),this._catalogFlatListController=new S.default,this._handleScroll=(e,t)=>{var a,l;this.props.setScrollOffset&&this.props.setScrollOffset(t.scrollTop),(null===(a=this.state.scrollHelper)||void 0===a?void 0:a.willLoadMore(t))&&this.setState({loadingMore:!0}),null===(l=this.state.scrollHelper)||void 0===l||l.onScroll(e,t).then((e=>{e&&this.setState({loadingMore:!1})})).catch((e=>{throw this.setState({loadingMore:!1}),e}))},this.handleScroll=(0,r.default)(this._handleScroll,100),this.onScroll=e=>{this.handleScroll(e,e.currentTarget)},this._onCartChange=()=>{var e=this.state.cart.itemCount;this.state.cartCount!==e&&this.setState({cartCount:e})},this._onCartClick=()=>{var{contact:e,onCartClick:t}=this.props;t&&t(e.id.toString())},this._onCatalogLinkClick=()=>{var{catalog:e}=this.state,{onCatalogLinkClick:t,contact:a}=this.props;e&&t(e,a)};var t=u.default.findCart(this.props.contact.id.toString());this.state={cartEnabled:!1,catalog:null,cartCount:t.itemCount,catalogFetchState:"NONE",dataSource:null,scrollHelper:null,loadingMore:!0,cart:t}}componentDidMount(){var{catalogId:e,listeners:t}=this.props;this._setupCatalog(),(0,p.default)(e).then((e=>{this.setState({cartEnabled:e}),e&&t.add(this.state.cart,"all",this._onCartChange)}))}_setupCatalog(){var{catalogId:e,rejectOnUnmount:t,canManageCatalog:a,scrollOffset:l}=this.props;c.default.find(e).checkpoint(t()).then((e=>{var t=new h.CatalogWithCollectionsDataSource(e,a||!1,m.default.PRODUCT_LIST_ITEM_HEIGHT),s=new h.CatalogListItemScrollHelper(t);this.setState({catalog:e,dataSource:t,scrollHelper:s,catalogFetchState:"SUCCESS"},(()=>{this.loadInitialItems(),this._watchProductCollection(),void 0!==l&&this._catalogFlatListController.setScrollFromStart(l)}))})).catch((e=>{(0,_.parseErrorState)(e,(e=>this.setState({catalogFetchState:e,loadingMore:!1})))}))}_watchProductCollection(){var{catalog:e}=this.state;this.props.autoUpdate&&null!=e&&(e.productCollection.on("add",(0,n.default)((()=>this.forceUpdate()),100)),e.productCollection.on("remove",(0,n.default)((()=>this.forceUpdate()),100)),e.collections.on("add",(0,n.default)((()=>this.forceUpdate()),100)),e.collections.on("remove",(0,n.default)((()=>this.forceUpdate()),100)))}_getDrawerContent(){var e,t,{catalog:a,cartEnabled:l,dataSource:s}=this.state,{contact:i,businessProfile:r,canManageCatalog:n,onAddProduct:u,onCartClick:c}=this.props,f=l&&c?this._onCartClick:void 0;return n&&u&&(e=o.default.createElement(d.default,{onClick:()=>u(),theme:"in-list"})),t=a&&s?o.default.createElement(P.default,{onCartOpen:f,onProductDetail:this.props.onProductDetail,flatListController:this._catalogFlatListController,catalog:a,canManageCatalog:this.props.canManageCatalog,shareLinks:this.props.canManageCatalog,onProductShare:this.props.onProductShare,onCollectionSeeAll:this.props.onCollectionSeeAll,data:s.getData(),onEditCollection:this.props.onEditCollection}):o.default.createElement(C.default,{fetchState:this.state.catalogFetchState}),o.default.createElement(o.default.Fragment,null,r&&o.default.createElement("div",{className:L.default.header},o.default.createElement(T.default,{profilePicThumb:i.getProfilePicThumb(),contact:i,businessProfile:r})),o.default.createElement("div",{className:L.default.list},e,t,this.state.loadingMore&&o.default.createElement(y.default,null)))}loadInitialItems(){var e=this;return(0,i.default)((function*(){var{dataSource:t}=e.state;yield null==t?void 0:t.loadInitialItems(),e.setState({loadingMore:!1})}))()}_renderDrawerMenu(){var e=this.state.cartEnabled?this._onCartClick:void 0;return o.default.createElement(f.default,{onSendCatalog:this._onCatalogLinkClick,onCartClick:e,cartCount:this.state.cart.itemCount,catalogId:this.props.catalogId.toString(),canManageCatalog:this.props.canManageCatalog,onOpenCollections:this.props.onOpenCollections,onOpenSettings:this.props.onOpenSettings})}render(){return o.default.createElement(v.default,{theme:"products",onDrop:this.props.onBack},o.default.createElement(E.default,{title:I.default.t(1247),type:this.props.headerType||E.DRAWER_HEADER_TYPE.SMALL,onBack:this.props.onBack,menu:this._renderDrawerMenu()}),o.default.createElement(g.default,{onScroll:this.onScroll,flatListControllers:[this._catalogFlatListController]},this._getDrawerContent()))}}t.CatalogViewDrawer=N,N.CONCERNS={contact:["id"]},N.displayName="CatalogViewDrawer";var O=(0,b.default)((0,M.default)((0,D.default)(N,N.CONCERNS)));t.default=O},31105:(e,t,a)=>{"use strict";var l=a(20862),s=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.CollectionContentDrawer=void 0;var i=s(a(48926)),r=s(a(23493)),n=l(a(67294)),o=s(a(12772)),d=s(a(66281)),u=s(a(57984)),c=s(a(54337)),f=a(94360),h=s(a(87655)),p=s(a(38778)),m=s(a(97737)),v=s(a(46274)),g=s(a(3395)),E=s(a(34727)),_=s(a(31763)),C=l(a(85002)),S=a(84710),y=s(a(95598)),I=s(a(12063)),M=s(a(98607)),P=s(a(66761)),L=s(a(48878)),T=s(a(50187)),b=s(a(52206)),D=s(a(82286));class N extends n.Component{constructor(e){super(e),this._collectionFlatListController=new I.default,this._onCartChange=()=>{var e=this.state.cart.itemCount;this.state.cartCount!==e&&this.setState({cartCount:e})},this._onCartClick=()=>{var{contact:e,onCartClick:t}=this.props;t&&t(e.id.toString())},this._onCatalogLinkClick=()=>{var{catalog:e}=this.state;if(e){var{onCatalogLinkClick:t,contact:a}=this.props;t(e,a)}},this._handleScroll=(e,t)=>{var a,l;this.props.setScrollOffset&&this.props.setScrollOffset(t.scrollTop),(null===(a=this.state.scrollHelper)||void 0===a?void 0:a.willLoadMore(t))&&this.setState({loadingMore:!0}),null===(l=this.state.scrollHelper)||void 0===l||l.onScroll(e,t).then((e=>{e&&this.setState({loadingMore:!1})})).catch((e=>{throw this.setState({loadingMore:!1}),e}))},this.handleScroll=(0,r.default)(this._handleScroll,100),this.onScroll=e=>{this.handleScroll(e,e.currentTarget)};var t=d.default.findCart(this.props.contact.id.toString());this.state={cartEnabled:!1,catalog:null,cartCount:t.itemCount,catalogFetchState:"NONE",dataSource:null,scrollHelper:null,loadingMore:!0,cart:t}}componentDidMount(){var{catalogId:e,listeners:t}=this.props;this._setupCatalog(),(0,h.default)(e).then((e=>{this.setState({cartEnabled:e}),e&&t.add(this.state.cart,"all",this._onCartChange)}))}_setupCatalog(){var{canManageCatalog:e,catalogId:t,rejectOnUnmount:a,scrollOffset:l}=this.props;u.default.find(t).then((t=>{var a;this.setState({catalog:t,catalogFetchState:"SUCCESS"});var s=new f.SingleCollectionDataSource(t,null===(a=this.props.collection)||void 0===a?void 0:a.id.toString(),e||!1,v.default.PRODUCT_LIST_ITEM_HEIGHT),i=new f.CatalogListItemScrollHelper(s);this.setState({dataSource:s,scrollHelper:i},(()=>{this.loadInitialItems(),this._watchProductCollection(),void 0!==l&&this._collectionFlatListController.setScrollFromStart(l)}))})).checkpoint(a()).catch((e=>{(0,S.parseErrorState)(e,(e=>this.setState({catalogFetchState:e,loadingMore:!1})))}))}_watchProductCollection(){var{collection:e}=this.props,{catalog:t}=this.state;null!=e&&(e.productCollection.on("add",(()=>this.forceUpdate())),e.productCollection.on("remove",(()=>this.forceUpdate()))),null!=t&&(t.productCollection.on("add",(()=>this.forceUpdate())),t.productCollection.on("remove",(()=>this.forceUpdate())),t.collections.on("add",(()=>this.forceUpdate())),t.collections.on("remove",(()=>this.forceUpdate())))}_getDrawerContent(){var e,{catalog:t,cartEnabled:a,dataSource:l,catalogFetchState:s,loadingMore:i}=this.state,{canManageCatalog:r,onCartClick:d,onProductDetail:u,onProductShare:c,collection:f}=this.props,h=a&&d?this._onCartClick:void 0;if(!t||!l)return n.default.createElement(y.default,{fetchState:s});var v=l.getData();if(0===v.length&&!i&&r&&f)return n.default.createElement(n.default.Fragment,null,n.default.createElement("div",{className:p.default.list},n.default.createElement(o.default,{theme:"in-list",onClick:()=>{this.props.onEditCollection&&this.props.onEditCollection(f)}}),n.default.createElement("div",{className:p.default.addItemsNotice},P.default.t(450))));var g=n.default.createElement(T.default,{onCartOpen:h,onProductDetail:u,flatListController:this._collectionFlatListController,catalog:t,canManageCatalog:r,shareLinks:r,onProductShare:c,collectionId:null===(e=this.props.collection)||void 0===e?void 0:e.id.toString(),data:v}),E=this.props.collection?n.default.createElement(m.default,{collection:this.props.collection,onEditCollection:this.props.onEditCollection}):void 0;return n.default.createElement(n.default.Fragment,null,n.default.createElement("div",{className:p.default.list},E,g,i&&n.default.createElement(M.default,null)))}loadInitialItems(){var e=this;return(0,i.default)((function*(){var{dataSource:t}=e.state;yield null==t?void 0:t.loadInitialItems(),e.setState({loadingMore:!1})}))()}_renderDrawerMenu(){var e=this.state.cartEnabled?this._onCartClick:void 0;return n.default.createElement(c.default,{onSendCatalog:this._onCatalogLinkClick,onCartClick:e,cartCount:this.state.cart.itemCount,catalogId:this.props.catalogId.toString(),canManageCatalog:this.props.canManageCatalog})}render(){var e,t=(null===(e=this.props.collection)||void 0===e?void 0:e.name)||P.default.t(539);return n.default.createElement(g.default,{theme:"products",onDrop:this.props.onBack},n.default.createElement(C.default,{title:t,type:this.props.headerType||C.DRAWER_HEADER_TYPE.SMALL,onBack:this.props.onBack,menu:this._renderDrawerMenu()}),n.default.createElement(E.default,{flatListControllers:[this._collectionFlatListController],onScroll:this.onScroll},this._getDrawerContent()))}}t.CollectionContentDrawer=N,N.contextType=_.default,N.CONCERNS={contact:["id"]},N.displayName="CollectionContentDrawer";var O=(0,b.default)((0,L.default)((0,D.default)(N,N.CONCERNS)));t.default=O},37665:(e,t,a)=>{"use strict";var l=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t,a,{collection:l,onSeeAll:f,allItems:h}=e;l?({name:t,id:a}=l):h&&(t=d.default.t(539));var p=s.default.createElement(c.TextDiv,{theme:"title"},s.default.createElement(o.default,{text:t,ellipsify:!0,titlify:!0}));function m(e){!function(e){e.preventDefault(),e.stopPropagation()}(e),f&&l?f(l):f&&f()}var v=void 0;if(l)switch(l.reviewStatus){case u.PRODUCT_REVIEW_STATUS.REJECTED:v=s.default.createElement("span",{className:n.default.reviewStateRejected},d.default.t(541))}return s.default.createElement(i.default,{key:a,primary:p,secondary:v,detail:s.default.createElement(r.default,{onClick:m},d.default.t(542)),theme:"product",idle:!0,className:n.default.collectionListItem})};var s=l(a(67294)),i=l(a(79274)),r=l(a(53318)),n=l(a(57139)),o=l(a(98712)),d=l(a(66761)),u=a(116),c=a(45739)},42552:(e,t,a)=>{"use strict";var l=a(95318),s=a(20862);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(a(67294)),r=l(a(95925)),n=l(a(70689)),o=l(a(59474)),d=l(a(98712)),u=l(a(66761)),c=l(a(62745)),f=l(a(47469)),h=l(a(1869));class p extends i.Component{constructor(...e){super(...e),this.state={active:!1,contextMenu:null},this.onDelete=e=>{e.preventDefault(),e.stopPropagation(),this.props.onDelete&&this.props.onDelete(this.props.collection)},this.onEdit=e=>{e.preventDefault(),e.stopPropagation(),this.props.onEdit&&this.props.onEdit(this.props.collection)},this.removeContext=()=>{this.setState({contextMenu:null})},this.onContext=e=>{if(this.state.contextMenu)this.setState({contextMenu:null});else{var t=[];this.props.canManage&&(t.push(i.default.createElement(o.default,{a8n:"mi-show-label",action:this.onEdit,key:"EditLabel"},u.default.t(445))),t.push(i.default.createElement(o.default,{a8n:"mi-show-label",action:this.onDelete,key:"DeleteLabel"},u.default.t(443)))),e.event&&e.event.persist(),this.setState({contextMenu:{menu:t,event:e.event,anchor:e.anchor}})}}}render(){var e,{collection:t,theme:a}=this.props,l=i.default.createElement("div",{className:n.default.collectionIcon},i.default.createElement("div",{className:n.default.iconContainer},i.default.createElement(c.default,{name:"collections_folder"}))),s=i.default.createElement(d.default,{text:t.name,ellipsify:!0,titlify:!0});return this.state.contextMenu&&(e=i.default.createElement(f.default,{displayName:"CollectionContextMenu",escapable:!0,popable:!0,requestDismiss:this.removeContext},i.default.createElement(h.default,{contextMenu:this.state.contextMenu}))),i.default.createElement(i.default.Fragment,null,i.default.createElement(r.default,{key:t.id.toString(),customImage:!0,image:l,primary:s,theme:a,active:this.state.active,contextEnabled:()=>this.props.canManage,onContext:this.onContext}),e)}}p.defaultProps={theme:"product",isMuted:!1},p.displayName="CollectionManageListItem";var m=p;t.default=m},38457:(e,t,a)=>{"use strict";var l=a(95318),s=a(20862);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(a(67294)),r=a(71509),n=l(a(42552)),o=l(a(46274)),d=l(a(47060)),u=l(a(3152)),c=l(a(82286)),f=a(79665);class h extends i.Component{constructor(...e){super(...e),this.onCollectionDelete=e=>{var{catalog:t}=this.props;(0,r.handleCollectionDelete)((0,f.unproxy)(t),e,"")},this.renderItem=e=>{var{collection:t}=e;return i.default.createElement(n.default,{collection:t,canManage:this.props.canManage,onDelete:this.onCollectionDelete,onEdit:this.props.onEditCollection})}}getData(){var e=[];return this.props.data.forEach((t=>{t.collection&&e.push({itemKey:t.collection.id,collection:t.collection})})),e}render(){return i.default.createElement(u.default,{flatListControllers:[this.props.flatListController]},i.default.createElement(d.default,{flatListController:this.props.flatListController,direction:"vertical",forceConsistentRenderCount:!1,data:this.getData(),renderItem:this.renderItem,defaultItemHeight:o.default.PRODUCT_LIST_ITEM_HEIGHT,itemEnterAnimationsEnabled:!0}))}}h.CONCERNS={catalog:["collections"]},h.displayName="CollectionsList";var p=(0,c.default)(h,h.CONCERNS);t.default=p},12283:(e,t,a)=>{"use strict";var l=a(20862),s=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.CollectionsManagementDrawer=void 0;var i=s(a(48926)),r=s(a(23493)),n=s(a(23279)),o=l(a(67294)),d=s(a(12772)),u=s(a(57984)),c=a(94360),f=s(a(38457)),h=s(a(69964)),p=s(a(46274)),m=s(a(3395)),v=s(a(34727)),g=l(a(85002)),E=s(a(12063)),_=s(a(98607)),C=a(56726),S=s(a(66761)),y=s(a(48878)),I=s(a(52206));class M extends o.Component{constructor(e){super(e),this._catalogFlatListController=new E.default,this._handleScroll=(e,t)=>{var a,l;this.props.setScrollOffset&&this.props.setScrollOffset(t.scrollTop),(null===(a=this.state.scrollHelper)||void 0===a?void 0:a.willLoadMore(t))&&this.setState({loadingMore:!0}),null===(l=this.state.scrollHelper)||void 0===l||l.onScroll(e,t).then((e=>{e&&this.setState({loadingMore:!1})})).catch((e=>{throw this.setState({loadingMore:!1}),e}))},this.handleScroll=(0,r.default)(this._handleScroll,100),this.onScroll=e=>{this.handleScroll(e,e.currentTarget)},this.state={loadingMore:!0,dataSource:null,scrollHelper:null}}componentDidMount(){var e=this.getCatalog();if(e){var t=new c.CollectionsDataSource(e,!0,p.default.PRODUCT_LIST_ITEM_HEIGHT);e.collections.on("add",(0,n.default)((()=>this.forceUpdate()),100)),e.collections.on("remove",(0,n.default)((()=>this.forceUpdate()),100));var a=new c.CatalogListItemScrollHelper(t);this.setState({dataSource:t,scrollHelper:a},(()=>{this.loadInitialItems()}))}}getCatalog(){var e=(0,C.getMeUser)();return u.default.get(e)}getDrawerContent(){var e=this.getCatalog(),t=this.state.dataSource;return e&&t?o.default.createElement("div",null,o.default.createElement(d.default,{onClick:()=>{this.props.editCollection(null)},theme:"in-list",title:S.default.t(448)}),o.default.createElement(f.default,{canManage:!0,catalog:e,onEditCollection:this.props.editCollection,data:t.getData(),flatListController:this._catalogFlatListController}),this.state.loadingMore&&o.default.createElement("div",{className:h.default.loadingSpinner},o.default.createElement(_.default,null))):null}loadInitialItems(){var e=this;return(0,i.default)((function*(){var{dataSource:t}=e.state;yield null==t?void 0:t.loadInitialItems(),e.setState({loadingMore:!1})}))()}render(){return o.default.createElement(m.default,{theme:"products",onDrop:this.props.onBack},o.default.createElement(g.default,{title:S.default.t(452),type:g.DRAWER_HEADER_TYPE.LARGE,onBack:this.props.onBack,menu:o.default.createElement(o.default.Fragment,null)}),o.default.createElement(v.default,{onScroll:this.onScroll,flatListControllers:[this._catalogFlatListController],scrollOffset:this.props.scrollOffset},this.getDrawerContent()))}}t.CollectionsManagementDrawer=M,M.displayName="CollectionsManagementDrawer";var P=(0,I.default)((0,y.default)(M));t.default=P},97737:(e,t,a)=>{"use strict";var l=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var{collection:t}=e;switch(t.reviewStatus){case o.PRODUCT_REVIEW_STATUS.PENDING:return s.default.createElement("div",{className:r.default.pendingBanner},n.default.t(543),s.default.createElement("div",{className:r.default.iconContainerPending},s.default.createElement(d.default,{name:"info"})));case o.PRODUCT_REVIEW_STATUS.REJECTED:return s.default.createElement("div",{className:r.default.rejectedBanner},n.default.t(545),s.default.createElement(i.default,{onClick:()=>{e.onEditCollection&&e.onEditCollection(e.collection)}},n.default.t(546)),s.default.createElement("div",{className:r.default.iconContainerRejected},s.default.createElement(d.default,{name:"info"})));default:return null}};var s=l(a(67294)),i=l(a(53318)),r=l(a(65491)),n=l(a(66761)),o=a(116),d=l(a(62745))},58865:(e,t,a)=>{"use strict";var l=a(95318),s=a(20862);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(a(67294)),r=l(a(46274)),n=l(a(47060)),o=l(a(3152)),d=l(a(47684));class u extends i.Component{constructor(...e){super(...e),this._handleSelect=(e,t,a)=>{var{selections:l,active:s,onSelectionChanged:i}=this.props;l.setVal(e,t,a),s.setVal(e,a),i()},this.renderItem=e=>{var{product:t}=e;return i.default.createElement(d.default,{key:t.id.toString(),product:t,selections:this.props.selections,onClick:()=>this._onProductClick(t),active:this.props.active})}}getData(){var{catalog:e}=this.props;return e.productCollection.getProductModels(!0).map((e=>({itemKey:e.id.toString(),product:e})))}_onProductClick(e){var t=this.props.selections.isSelected(e);this._handleSelect(e,!t,!1)}render(){return i.default.createElement(o.default,{flatListControllers:[this.props.flatListController]},i.default.createElement(n.default,{flatListController:this.props.flatListController,direction:"vertical",forceConsistentRenderCount:!1,data:this.getData(),renderItem:this.renderItem,defaultItemHeight:r.default.PRODUCT_LIST_ITEM_HEIGHT,itemEnterAnimationsEnabled:!0}))}}u.displayName="CollectionProductsSelectionList";var c=u;t.default=c},70547:(e,t,a)=>{"use strict";var l=a(20862),s=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.EditCollectionContent=void 0;var i=s(a(48926)),r=s(a(23493)),n=s(a(94184)),o=l(a(67294)),d=a(71509),u=a(94360),c=s(a(58865)),f=s(a(46274)),h=s(a(3395)),p=s(a(34727)),m=l(a(85002)),v=s(a(78518)),g=s(a(12063)),E=s(a(98607)),_=s(a(66761)),C=s(a(48878)),S=s(a(40469)),y=s(a(52206)),I=s(a(92120)),M=s(a(24927)),P=s(a(17363)),L=s(a(62745)),T=s(a(51231));class b extends o.Component{constructor(e){var t;super(e),this.active=new M.default([],(e=>e.id)),this.selections=new S.default([],(e=>e.id.toString())),this._collectionFlatListController=new g.default,this._handleScroll=(e,t)=>{var a,l;(null===(a=this.state.scrollHelper)||void 0===a?void 0:a.willLoadMore(t))&&this.setState({loadingMore:!0}),null===(l=this.state.scrollHelper)||void 0===l||l.onScroll(e,t).then((e=>{e&&this.setState({loadingMore:!1})})).catch((e=>{throw this.setState({loadingMore:!1}),e}))},this.handleScroll=(0,r.default)(this._handleScroll,100),this.onScroll=e=>{this.handleScroll(e,e.currentTarget)},this.state={saveEnabled:!0,dataSource:null,scrollHelper:null,name:null===(t=e.collection)||void 0===t?void 0:t.name,errorName:null,isUpdating:!1,loadingMore:!0}}componentDidMount(){this._setupDataSource()}_setupDataSource(){var e,t=new u.CollectionsContentDataSource(this.props.catalog,f.default.PRODUCT_LIST_ITEM_HEIGHT,null===(e=this.props.collection)||void 0===e?void 0:e.id),a=new u.CatalogListItemScrollHelper(t);this.setState({dataSource:t,scrollHelper:a},(()=>{t.loadInitialItems().then((()=>{this.setState({loadingMore:!1}),this.forceUpdate()}))}))}getNameEdit(){return o.default.createElement(T.default,{editable:!0,focusOnMount:!0,value:this.state.name,onChange:e=>{var t=this.state.errorName;t&&e&&(t=null),this.setState({name:e,errorName:t})},inputPlaceholder:_.default.t(440),theme:"text-input",error:this.state.errorName,maxLength:30})}_getDrawerContent(){var e,t=this.syncSelection();if(t>0||this.props.collection&&this.state.name!==this.props.collection.name){var a=_.default.t(446,{updated:t,_plural:t});e=o.default.createElement("div",{className:v.default.footer},a,o.default.createElement("div",{className:v.default.saveButton},o.default.createElement(I.default,{large:!0,onClick:()=>{this.save()}},o.default.createElement(L.default,{directional:!0,name:"checkmark-medium"}))))}var l=this.state.isUpdating?o.default.createElement("div",{className:v.default.spinner},o.default.createElement(P.default,{size:50,stroke:3})):null;return o.default.createElement(o.default.Fragment,null,l,o.default.createElement("div",{className:v.default.nameContainer},o.default.createElement("span",{className:v.default.nameIcon},o.default.createElement(L.default,{name:"collections_folder"})),o.default.createElement("span",{className:v.default.nameEdit},this.getNameEdit())),o.default.createElement("div",{className:v.default.operation},this.props.collection?_.default.t(451):_.default.t(439)),o.default.createElement("div",{className:v.default.listContainer},o.default.createElement(c.default,{catalog:this.props.catalog,flatListController:this._collectionFlatListController,active:this.active,selections:this.selections,onSelectionChanged:()=>this.forceUpdate()}),this.state.loadingMore&&o.default.createElement("div",{className:v.default.loadingSpinner},o.default.createElement(E.default,null))),e)}syncSelection(){var e=this.props.catalog.productCollection.getProductModels(!0),t=0;return e.forEach((e=>{this.selections.isInList(e)?e.checkmark!==this.selections.isSelected(e)&&t++:this.selections.setVal(e,e.checkmark)})),t}getProductDeltas(){var e=this.props.catalog.productCollection.getProductModels(!0),t=[],a=[];return e.forEach((e=>{var l=this.selections.isSelected(e);e.checkmark!==l&&(l?a.push(e):t.push(e))})),{added:a,removed:t}}save(){var e=this;return(0,i.default)((function*(){if(e.state.name){e.setState({isUpdating:!0});var{added:t,removed:a}=e.getProductDeltas();try{(yield(0,d.handleCollectionSave)(e.props.catalog,e.props.collection,e.state.name||"",t,a))&&e.props.onBack(),e.setState({isUpdating:!1})}catch(t){e.setState({isUpdating:!1})}}else e.setState({errorName:_.default.t(447)})}))()}render(){var e,t=(0,n.default)(v.default.container,{[v.default.isSending]:this.state.isUpdating}),a=(null===(e=this.props.collection)||void 0===e?void 0:e.name)||_.default.t(449);return o.default.createElement(h.default,{theme:"products",onDrop:this.props.onBack},o.default.createElement(m.default,{title:a,type:m.DRAWER_HEADER_TYPE.LARGE,onBack:this.props.onBack,menu:o.default.createElement(o.default.Fragment,null)}),o.default.createElement(p.default,{className:t,flatListControllers:[this._collectionFlatListController],onScroll:this.onScroll},this._getDrawerContent()))}}t.EditCollectionContent=b,b.displayName="EditCollectionContent";var D=(0,y.default)((0,C.default)(b));t.default=D},33023:(e,t,a)=>{"use strict";var l=a(20862),s=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.EditProductDrawer=void 0;var i=s(a(94184)),r=l(a(67294)),n=a(71509),o=s(a(27306)),d=s(a(73132)),u=s(a(97420)),c=a(32837),f=l(a(25246)),h=s(a(8053)),p=s(a(3395)),m=s(a(34727)),v=s(a(31763)),g=l(a(85002)),E=s(a(37201)),_=a(66274),C=a(56726),S=s(a(28204)),y=s(a(66761)),I=s(a(48878)),M=a(58635),P=l(a(53965)),L=a(4014),T=a(66248),b=s(a(47387)),D=s(a(52206)),N=s(a(86981)),O=s(a(17363)),w=s(a(82286)),k=s(a(51231)),R=l(a(9931)),A=s(a(53918));class x extends r.Component{constructor(e){var t;super(e),this._imagePanelRef=(0,r.createRef)(),this._onNameChange=e=>{this.setState({name:e,nameError:""===e?y.default.t(726):"",isModified:!0})},this.getServerPrice=e=>parseInt(parseFloat(e).toFixed(2).toString().replace(/\.|,/g,""),10),this._onPriceChange=e=>{var t=f.valueFromString(this.state.currency,e),a="";""===e||f.validatePriceString(this.state.currency,e,P.MIN_PRICE,P.MAX_PRICE)||(a=y.default.t(727)),this.setState({priceAmount1000:""===e?null:t,priceStr:`${e}`,priceError:a,isModified:!0})},this.onDescriptionChange=e=>{this.setState({description:e,isModified:!0})},this._onUrlChange=e=>{var t="";""===e||A.default.isValid(e)||(t=y.default.t(732)),this.setState({url:e,urlError:t,isModified:!0})},this._onUrlBlur=()=>{var{url:e}=this.state;""===e||A.default.isHttps(e)||A.default.isHttp(e)||this.setState({url:`https://${e}`})},this._onRetailerIdChange=e=>{this.setState({retailerId:e,retailerIdError:"",isModified:!0})},this._onHiddenChange=()=>{this.setState({isHidden:!this.state.isHidden})},this._getProductChanges=()=>{var{product:e}=this.props,{name:t,priceAmount1000:a,currency:l,description:s,url:i,retailerId:r,isHidden:n}=this.state;return new P.default({id:e.id,priceAmount1000:a,currency:l,description:s||"",imageCdnUrl:e.imageCdnUrl,additionalImageCdnUrl:e.additionalImageCdnUrl,name:t,retailerId:r,url:i,isHidden:n})},this._onSaveItem=()=>{var e,{catalog:t,product:a,newProduct:l}=this.props,s=this._getProductChanges();(l?(0,M.logAddProductClick)((0,T.getProductCatalogContext)(this.context)):(0,M.logEditProductClick)(a,(0,T.getProductCatalogContext)(this.context)),this.setState({isUpdating:!0}),l||this.state.isModified)?null===(e=this._imagePanelRef.current)||void 0===e||e.component.uploadImages().then((e=>{s.imageCdnUrl=e[0],s.additionalImageCdnUrl=e.slice(1),(l?t.addProduct:t.editProduct).call(t,s).then(this._handleEditSuccess).catchType(_.CatalogEditServerError,this._handleEditError).finally((()=>{this.setState({isUpdating:!1})}))})).catch((e=>{throw this.setState({isUpdating:!1}),e})):(0,L.productVisibilitySet)([{productId:a.id.toString(),isHidden:s.isHidden}]).then((()=>{a.isHidden=s.isHidden,this._handleEditSuccess(a)})).catchType(_.CatalogEditServerError,this._handleEditError).finally((()=>{this.setState({isUpdating:!1})}))},this._handleEditError=e=>{this.props.newProduct?(0,M.logAddProductFailed)((0,T.getProductCatalogContext)(this.context)):(0,M.logEditProductFailed)(this.props.product,(0,T.getProductCatalogContext)(this.context),e.statusCode),null!=e.errors&&e.errors.map((e=>{"media"===e.name&&"duplicate"===e.reason&&this.setState({imageError:y.default.t(722)}),"retailer_id"!==e.name&&"retailer-id"!==e.name||"duplicate"!==e.reason||this.setState({retailerIdError:y.default.t(723)})})),u.default.openToast(r.default.createElement(R.default,{msg:y.default.t(480),id:(0,R.genId)("catalog_save_item_failed")}))},this._handleEditSuccess=e=>{var{catalog:t,onEditSuccess:a,newProduct:l,onCreate:s}=this.props;t.productCollection.add(e,{merge:!0}),this.props.newProduct?(0,M.logAddProductSuccess)((0,T.getProductCatalogContext)(this.context)):(0,M.logEditProductSuccess)(this.props.product,(0,T.getProductCatalogContext)(this.context)),u.default.openToast(r.default.createElement(R.default,{msg:y.default.t(470),id:(0,R.genId)("catalog_item_saved")})),a(e),null!=l&&s&&s()},this._onDeleteItem=()=>{var{catalog:e,product:t,onDelete:a}=this.props;(0,n.handleProductDelete)(e,t,(0,T.getProductCatalogContext)(this.context)).then((e=>{e&&(u.default.closeDrawerMid(),a&&a())}))},this._onImageChange=e=>{var t="";0===e.length&&(t=y.default.t(725)),this.setState({imageError:t,hasImages:e.length>0,isModified:!0})},this.onDrop=e=>{var t;null===(t=this._imagePanelRef.current)||void 0===t||t.component.onFilePick(e)},this.onDragChange=e=>{this.setState({isDragging:e})};var{product:a}=this.props,l=null==a.priceAmount1000?null:a.priceAmount1000,s="";if(null!=l&&null!=a.currency){var i=f.formatToParts(a.currency,l);s=`${i.integer}${i.decimal}`}this.state={name:a.name||"",priceAmount1000:l,description:a.description||"",url:a.url||"",retailerId:a.retailerId||"",priceStr:s,currency:a.currency||f.currencyForCountryShortcode((0,c.getCountryShortcodeByPhone)(null===(t=(0,C.getMaybeMeUser)())||void 0===t?void 0:t.user)),isUpdating:!1,nameError:"",priceError:"",urlError:"",retailerIdError:"",imageError:"",hasImages:!!a.imageCdnUrl,isDragging:!1,isHidden:a.isHidden,isModified:!1}}componentDidMount(){var{listeners:e,product:t}=this.props;e.add(t,"change:isHidden",(()=>{this.setState({isHidden:this.props.product.isHidden})}))}isValid(){var{name:e,nameError:t,priceError:a,urlError:l,retailerIdError:s,imageError:i,hasImages:r}=this.state;return""!==e&&!1!==r&&t+a+l+s+i===""}render(){var{product:e,onBack:t,onCancel:a,newProduct:l}=this.props,{isUpdating:s,isDragging:n,currency:u,nameError:c,priceError:v,urlError:_,retailerIdError:C,imageError:S}=this.state,I=r.default.createElement(o.default,{type:"primary",onClick:this._onSaveItem,disabled:!this.isValid(),a8nText:"product-edit-drawer-save-button"},l?y.default.t(223):y.default.t(1327)),M=r.default.createElement("div",{className:E.default.drawerHeader},r.default.createElement("div",null,l?y.default.t(491):y.default.t(492)),r.default.createElement("div",{className:E.default.drawerHeaderButtonContainer},I)),L=l?null:r.default.createElement("div",{className:E.default.deleteButtonContainer},r.default.createElement(o.default,{type:"warning",onClick:this._onDeleteItem,a8nText:"product-edit-drawer-delete-button"},y.default.t(606))),T=(0,i.default)(E.default.productWrapper,{[E.default.isSending]:s}),D=n?r.default.createElement(h.default,null):null,w=s?r.default.createElement("div",{className:E.default.spinner},r.default.createElement(O.default,{size:50,stroke:3})):null,R=N.default.webCatalogProductsOnOff&&r.default.createElement("div",{className:E.default.hiddenContainer},r.default.createElement(d.default,{id:"product-hidden-check",onChange:this._onHiddenChange,checked:this.state.isHidden,disabled:!1}),r.default.createElement("label",{className:E.default.hiddenLabel,htmlFor:"product-hidden-check"},y.default.t(466)),r.default.createElement("div",{className:E.default.hiddenDescr},y.default.t(465)));return r.default.createElement(p.default,{key:"catalog-link-drawer",theme:"catalog",onDrop:this.onDrop,onDragChange:this.onDragChange},D,r.default.createElement(g.default,{a8n:"catalog-link-title",title:M,type:g.DRAWER_HEADER_TYPE.SMALL,onBack:t,onCancel:a}),r.default.createElement(m.default,null,r.default.createElement("div",{className:T},w,r.default.createElement(b.default,{product:e,maxImageCount:P.MAX_PRODUCT_IMAGES,onChange:this._onImageChange,ref:this._imagePanelRef,error:S}),r.default.createElement(k.default,{a8n:"product-edit-drawer-name-input",value:this.state.name,placeholder:y.default.t(913),onChange:this._onNameChange,theme:"small",customStyleThemes:["desaturated"],maxLength:150,error:c}),r.default.createElement(k.default,{a8n:"product-edit-drawer-price-input",value:this.state.priceStr,placeholder:y.default.t(914,{currencySymbol:f.formatToParts(u,0).symbol}),onChange:this._onPriceChange,theme:"small",maxLength:30,customStyleThemes:["desaturated"],error:v}),r.default.createElement(k.default,{a8n:"product-edit-drawer-description-input",value:this.state.description,placeholder:y.default.t(911),onChange:this.onDescriptionChange,theme:"small",maxLength:5e3,customStyleThemes:["desaturated"],multiline:!0}),r.default.createElement(k.default,{a8n:"product-edit-drawer-link-input",value:this.state.url,placeholder:y.default.t(912),onChange:this._onUrlChange,onBlur:this._onUrlBlur,theme:"small",customStyleThemes:["desaturated"],maxLength:75,error:_,managed:!0}),r.default.createElement(k.default,{a8n:"product-edit-drawer-retailer-id-input",value:this.state.retailerId,placeholder:y.default.t(910),onChange:this._onRetailerIdChange,theme:"small",customStyleThemes:["desaturated"],maxLength:100,error:C}),R,L)))}}t.EditProductDrawer=x,x.contextType=v.default,x.CONCERNS={product:["id","additionalImageCdnUrl","name","priceAmount1000","description","productImageCollection","reviewStatus","url","imageCdnUrl","retailerId","currency","isHidden"]},x.displayName="EditProductDrawer";var F=(0,S.default)((0,D.default)((0,w.default)((0,I.default)(x),x.CONCERNS)));t.default=F},78019:(e,t,a)=>{"use strict";var l=a(20862),s=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var{onBack:t,onAddProductClick:a,onCatalogAlreadyCreated:l}=e,[s,P]=(0,r.useState)(!1),L=r.default.createElement("div",{className:_.default.placeholderIcon}),T=`<a href="${u.default.FB_LEGAL_TERMS_URL}" target="_blank">${g.default.t(737)}</a>`,b=`<a href="${u.default.FB_COMMERCE_POLICY_URL}" target="_blank">${g.default.t(736)}</a>`,D=`<a href="${u.default.WA_COMMERCE_POLICY_URL}" target="_blank">${g.default.t(1969)}</a>`,N=g.default.t(460,{fb_product_link:T,fb_commerce_link:b,wa_commerce_policy_link:D});var O=(0,i.default)({[_.default.isLoading]:s}),w=s?r.default.createElement("div",{className:_.default.spinner},r.default.createElement(y.default,{size:50,stroke:3})):null,k=s?r.default.createElement(n.default,{onClick:()=>{},theme:"default",idle:!!s}):r.default.createElement(h.default.Consumer,null,(e=>r.default.createElement(n.default,{onClick:()=>{!function(e){P(!0),(0,E.logCreateProductCatalogClick)(e),(0,C.createCatalog)().then((()=>{(0,E.logCreateProductCatalogSuccess)(e),a()})).catchType(v.ServerStatusCodeError,(t=>{(0,E.logCreateProductCatalogFailed)(e,t.statusCode),d.default.openToast(r.default.createElement(M.default,{msg:g.default.t(721),id:(0,M.genId)("err_catalog_already_created")})),l()})).finally((()=>{P(!1)}))}((0,S.getProductCatalogContext)(e))},theme:"default",idle:!1})));return r.default.createElement(c.default,{key:"catalog-link-drawer"},r.default.createElement(p.default,{title:g.default.t(1247),type:p.DRAWER_HEADER_TYPE.LARGE,onBack:t}),r.default.createElement(f.default,{className:O},r.default.createElement(m.default,{theme:"padding-small",animation:!1},w,r.default.createElement(I.TextDiv,{theme:"title"},g.default.t(436)),k,r.default.createElement(I.TextDiv,{theme:"plain"},r.default.createElement("div",{dangerouslySetInnerHTML:{__html:N}})),r.default.createElement("div",{className:_.default.placeholderContainer},r.default.createElement(o.default,{theme:"add-item-placeholder",image:L,customImage:!0,className:_.default.addItemPlaceholder,primary:"",secondary:"",idle:!0}),r.default.createElement("div",{className:_.default.divider}),r.default.createElement(o.default,{theme:"add-item-placeholder",image:L,customImage:!0,className:_.default.addItemPlaceholder,primary:"",secondary:"",idle:!0}),r.default.createElement("div",{className:_.default.divider})))))};var i=s(a(94184)),r=l(a(67294)),n=s(a(12772)),o=s(a(79274)),d=s(a(97420)),u=s(a(46274)),c=s(a(3395)),f=s(a(34727)),h=s(a(31763)),p=l(a(85002)),m=s(a(25404)),v=a(66274),g=s(a(66761)),E=a(58635),_=s(a(97721)),C=a(4014),S=a(66248),y=s(a(17363)),I=a(45739),M=l(a(9931))},6853:(e,t,a)=>{"use strict";var l=a(95318),s=a(20862);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.ProductInfoDrawer=void 0;var i=s(a(67294)),r=l(a(27306)),n=l(a(3395)),o=l(a(34727)),d=l(a(31763)),u=s(a(85002)),c=l(a(25404)),f=l(a(98607)),h=a(56726),p=l(a(28204)),m=l(a(66761)),v=a(58635),g=a(86989),E=a(66248),_=a(116),C=l(a(32770)),S=l(a(10462)),y=l(a(3265)),I=l(a(20395)),M=l(a(1211)),P=l(a(86981)),L=l(a(82286)),T=l(a(43351)),b=a(45739);class D extends i.Component{constructor(e){super(e),this.onEditProduct=()=>{var{product:e}=this.props;this.props.onEditProduct&&this.props.onEditProduct(e)},this.onShareProduct=()=>{var{product:e}=this.props;this.props.onShareProduct&&this.props.onShareProduct(e)},this.onSendChat=()=>{this.props.onCancel(),(0,g.sendProductToChat)(this.props.product,this.props.catalog),(0,v.logProductMessageBusinessClick)(this.props.product,(0,E.getProductCatalogContext)(this.context))},this.state={isLoading:!0}}componentDidMount(){var{catalog:e,product:t}=this.props;e.pullProduct(t.id.toString()).finally((()=>{this.setState({isLoading:!1})})),(0,v.logProductDetailView)({product:t,catalogContext:(0,E.getProductCatalogContext)(this.context)})}render(){var{product:e,onCancel:t}=this.props,a=(0,h.getMaybeMeUser)(),l=T.default.get(a),s=i.default.createElement(b.TextDiv,{theme:"muted",className:S.default.businessInfoTitle},m.default.t(374)),d=e.reviewStatus!==_.PRODUCT_REVIEW_STATUS.APPROVED||e.isHidden&&P.default.webCatalogProductsOnOff,p=i.default.createElement("div",null,i.default.createElement("div",{className:S.default.buttonSeparator},i.default.createElement(r.default,{type:"strong",onClick:this.onEditProduct},m.default.t(641))),i.default.createElement(r.default,{type:"strong-primary",onClick:this.onShareProduct,disabled:d},m.default.t(1894))),v=i.default.createElement("div",{className:S.default.drawerHeader},i.default.createElement("div",{className:S.default.productName},e.name),i.default.createElement("div",{className:S.default.drawerHeaderButtonContainer},p)),g=l?i.default.createElement(c.default,{title:s,theme:"no-padding"},i.default.createElement(M.default,{status:l})):null,E=this.state.isLoading?i.default.createElement(f.default,null):i.default.createElement(i.default.Fragment,null,i.default.createElement(I.default,{product:e,isAvailable:!0,fetching:!1}),i.default.createElement(y.default,{product:e}),i.default.createElement(C.default,{product:e,onSendChat:this.onSendChat,isAvailable:!0}));return i.default.createElement(n.default,{key:"catalog-link-drawer",theme:"catalog"},i.default.createElement(u.default,{a8n:"catalog-product-title",title:v,type:u.DRAWER_HEADER_TYPE.SMALL,onCancel:t}),i.default.createElement(o.default,null,i.default.createElement(c.default,{theme:"center-column-fixed-width"},E),i.default.createElement("div",{className:S.default.productWrapper},g)))}}t.ProductInfoDrawer=D,D.contextType=d.default,D.CONCERNS={product:["id","catalogWid","name","priceAmount1000","description","productImageCollection","reviewStatus","url","canAppeal","imageCdnUrl","retailerId","currency","isHidden"]},D.displayName="ProductInfoDrawer";var N=(0,p.default)((0,L.default)(D,D.CONCERNS));t.default=N},3265:(e,t,a)=>{"use strict";var l=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var{product:t}=e;function a(){r.default.openModal(s.default.createElement(o.default.Consumer,null,(e=>s.default.createElement(i.default,{product:t,sessionId:(0,u.getProductCatalogSessionId)(e)}))))}var l=`<a href="${n.default.WA_COMMERCE_POLICY_URL}" target="_blank">${d.default.t(919)}</a>`;if(t.reviewStatus===c.PRODUCT_REVIEW_STATUS.APPROVED)return t.isHidden&&h.default.webCatalogProductsOnOff?s.default.createElement("div",{className:f.default.root},s.default.createElement("div",{className:f.default.icon},s.default.createElement(p.default,{name:"hide"})),s.default.createElement("div",{className:f.default.text},s.default.createElement(m.TextDiv,null,d.default.t(1251)))):null;if(t.reviewStatus===c.PRODUCT_REVIEW_STATUS.REJECTED){if(!0===t.canAppeal){var v=`${d.default.t(468,{learn_more_link:l})}`,g=s.default.createElement("div",{dangerouslySetInnerHTML:{__html:v}}),E=`<span class="${f.default.appealLink}">${d.default.t(469)}</span>`,_=`${d.default.t(461,{request_review_link:E})}`,C=s.default.createElement("div",{dangerouslySetInnerHTML:{__html:_}});return s.default.createElement("div",{className:f.default.root,"data-a8n":"product-appeal-rejected-initial-review"},s.default.createElement("div",{className:f.default.icon},s.default.createElement(p.default,{name:"info"})),s.default.createElement("div",{className:f.default.text},g,s.default.createElement(m.TextDiv,{className:f.default.appealText},s.default.createElement("div",{onClick:a,onKeyPress:a,role:"button",tabIndex:"0","data-a8n":"product-appeal-button"},C))))}var S=`${d.default.t(463,{learn_more_link:l})}`,y=s.default.createElement("div",{dangerouslySetInnerHTML:{__html:S}});return s.default.createElement("div",{className:f.default.root,"data-a8n":"product-appeal-rejected-final"},y)}if(t.reviewStatus===c.PRODUCT_REVIEW_STATUS.NO_REVIEW||t.reviewStatus===c.PRODUCT_REVIEW_STATUS.OUTDATED){var I=t.isHidden&&h.default.webCatalogProductsOnOff?`${d.default.t(478,{learn_more_link:l})}`:`${d.default.t(477,{learn_more_link:l})}`;return s.default.createElement("div",{className:f.default.root,"data-a8n":"product-appeal-pending-initial-review"},s.default.createElement("div",{dangerouslySetInnerHTML:{__html:I}}))}if(!1===t.canAppeal){var M=d.default.t(462);return s.default.createElement("div",{className:f.default.root,"data-a8n":"product-appeal-pending-appeal"},M)}return null};var s=l(a(67294)),i=l(a(75861)),r=l(a(97420)),n=l(a(46274)),o=l(a(31763)),d=l(a(66761)),u=a(66248),c=a(116),f=l(a(72974)),h=l(a(86981)),p=l(a(62745)),m=a(45739)},1211:(e,t,a)=>{"use strict";var l=a(95318),s=a(20862);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(a(67294)),r=l(a(79274)),n=l(a(3243)),o=l(a(27890)),d=a(56726),u=l(a(28204)),c=l(a(82286));class f extends i.Component{constructor(e){super(e)}render(){var{status:e}=this.props;return i.default.createElement(r.default,{image:i.default.createElement(o.default,{id:(0,d.getMaybeMeUser)()}),primary:n.default.pushname,secondary:e.status,idle:!0})}}f.CONCERNS={status:["status"]},f.displayName="ProfileLockup";var h=(0,u.default)((0,c.default)(f,f.CONCERNS));t.default=h},50187:(e,t,a)=>{"use strict";var l=a(95318),s=a(20862);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(a(67294)),r=a(71509),n=l(a(97420)),o=l(a(97737)),d=l(a(37665)),u=l(a(46274)),c=l(a(31763)),f=l(a(47060)),h=l(a(3152)),p=l(a(12063)),m=a(58635),v=a(66248),g=l(a(89709)),E=a(116),_=l(a(52206)),C=l(a(82286)),S=a(79665);class y extends i.Component{constructor(e){super(e),this._catalogFlatListController=new p.default,this.onProductDetail=e=>{var{onProductDetail:t}=this.props;return(0,m.logCatalogListDetailClick)({product:(0,S.unproxy)(e),catalogContext:(0,v.getProductCatalogContext)(this.context)}),this.setState({openedProductId:e.id.toString()}),t(e)},this.onProductShare=e=>{var{onProductShare:t}=this.props;t&&t(e)},this.onProductDelete=e=>{var{catalog:t}=this.props;(0,r.handleProductDelete)(t,e,(0,v.getProductCatalogContext)(this.context)).then((()=>{e.id===this.state.openedProductId&&(n.default.closeDrawerMid(),this.setState({openedProductId:void 0}))}))},this.onProductHideShow=e=>{(0,r.handleProductVisibilityChange)(e,(0,v.getProductCatalogContext)(this.context))},this.renderItem=e=>{var{collection:t,product:a,allItems:l,reviewBanner:s}=e,{onCartOpen:r,shareLinks:n}=this.props;return t?s?i.default.createElement(o.default,{collection:t,onEditCollection:this.props.onEditCollection}):i.default.createElement(d.default,{collection:t,onSeeAll:this.props.onCollectionSeeAll}):l?i.default.createElement(d.default,{allItems:l,onSeeAll:this.props.onCollectionSeeAll}):a?i.default.createElement(g.default,{product:a,onCartOpen:r,onClick:()=>this.onProductDetail(a),onProductShare:n?this.onProductShare:null,onProductDelete:this.onProductDelete,onProductHideShow:this.onProductHideShow,canManageCatalog:this.props.canManageCatalog}):null},this.state={openedProductId:void 0,loadingMore:!1,stopLoading:!1,catalogFetchState:e.catalog?"SUCCESS":"NONE"}}getData(){var{onCartOpen:e}=this.props,t=void 0!==e,a=this.props.data||[],l=[];return a.forEach((e=>{var a=e.collection,s=e.product,i=e.allItems;a&&s?l.push({itemKey:`${a.id.toString()}_${s.id.toString()}_${t.toString()}`,product:s}):a?(l.push({itemKey:a.id.toString(),collection:a}),a.reviewStatus!==E.PRODUCT_REVIEW_STATUS.PENDING&&a.reviewStatus!==E.PRODUCT_REVIEW_STATUS.REJECTED||l.push({itemKey:`${a.id.toString()}_reviewBanner`,collection:a,reviewBanner:!0})):i?l.push({itemKey:"view_all",allItems:i}):s&&l.push({itemKey:`${s.id.toString()}_${t.toString()}`,product:s})})),l}render(){var e=this.getData();return i.default.createElement(i.default.Fragment,null,i.default.createElement(h.default,{flatListControllers:[this._catalogFlatListController]},i.default.createElement(f.default,{flatListController:this._catalogFlatListController,direction:"vertical",forceConsistentRenderCount:!1,data:e,renderItem:this.renderItem,defaultItemHeight:u.default.PRODUCT_LIST_ITEM_HEIGHT,itemEnterAnimationsEnabled:!0})))}}y.CONCERNS={catalog:["productCollection","collections","afterCursor","id","index"]},y.contextType=c.default,y.displayName="ProductCollectionsList";var I=(0,_.default)((0,C.default)(y,y.CONCERNS));t.default=I},47387:(e,t,a)=>{"use strict";var l=a(95318),s=a(20862);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(a(67294)),r=l(a(23491)),n=l(a(97420)),o=l(a(46274)),d=a(79736),u=s(a(92246)),c=l(a(66761)),f=a(2893),h=a(46072),p=a(94490),m=l(a(97962)),v=l(a(62831)),g=l(a(38924)),E=l(a(52206)),_=l(a(62745)),C=s(a(9931)),S=l(a(77923));class y extends i.Component{constructor(e){super(e),this.onAddFileClick=()=>{this.refInput&&this.refInput.click()},this.onFilePick=e=>{(0,d.getFiles)(e,o.default.IMAGE_MIMES).then((e=>{var t=this.props.maxImageCount-this.state.images.length;e.length>t&&n.default.openToast(i.default.createElement(C.default,{msg:c.default.t(979),duration:6e3,action:{onAction:()=>{},actionText:c.default.t(790),dismiss:!0,theme:"success"},id:(0,C.genId)()})),e.slice(0,this.props.maxImageCount-this.state.images.length).map((e=>({file:e,filename:e.name,mimetype:e.type,type:p.TYPE.PRODUCT}))).map((e=>{var t,a=new r.default({file:Promise.resolve(e)});return null===(t=a.processPromise)||void 0===t?void 0:t.then((()=>{this._appendImage(a)}))}))})).checkpoint(this.props.rejectOnUnmount()).catchType(u.Unmount,(()=>{})),e.target&&e.target.value&&(e.target.value="")},this.uploadImages=()=>{var e=this.state.images.filter((e=>null==e.url)).map((e=>(0,f.uploadProductImage)(e.mediaData.mediaBlob,e.mediaData.filehash).then((t=>{e.url=t}))));return Promise.all(e).then((()=>this.state.images.map((e=>e.url||""))))},this.setRefInput=e=>{this.refInput=e};var t=e.product.productImageCollection.filter((e=>!e.old)).map((e=>({url:e.mediaUrl,mediaData:e.mediaData})));this.state={images:t}}_appendImage(e){e.mediaPrep.waitForPrep().then((t=>{if(this._validateImage(t)){t.mediaStage=h.MEDIA_DATA_STAGE.RESOLVED,t.renderableUrl=e.fullPreview;var a=t.mediaBlob;!a||a instanceof m.default||m.default.createFromData(a,a.type).then((e=>{t.mediaBlob=e})),this.setState({images:[...this.state.images,{url:null,mediaData:t}]}),this.props.onChange&&this.props.onChange(this.state.images)}}))}_validateImage(e){return!(this.state.images.filter((t=>t.mediaData.filehash===e.filehash)).length>0)||(n.default.openToast(i.default.createElement(C.default,{id:(0,C.genId)(),msg:c.default.t(722)})),!1)}_deleteImage(e){var t=this.state.images.filter((t=>t!==e));this.setState({images:t}),this.props.onChange&&this.props.onChange(t)}_renderTiles(){return this.state.images.filter((e=>e.mediaData)).map((e=>i.default.createElement("div",{key:e.mediaData.filehash,className:v.default.imageTile},i.default.createElement("div",{className:v.default.btnDelete,onClick:()=>this._deleteImage(e),role:"button"},i.default.createElement(_.default,{className:v.default.deleteIcon,name:"x-alt"})),i.default.createElement(g.default,{mediaData:e.mediaData,className:v.default.imageThumb}))))}_renderAddImageButton(){return this.state.images.length<this.props.maxImageCount?i.default.createElement("div",{className:v.default.btnAddContainer,onClick:this.onAddFileClick,role:"button"},i.default.createElement("div",{className:v.default.btnAdd},i.default.createElement(_.default,{name:"camera"}),i.default.createElement("div",{className:v.default.btnAddText},c.default.t(435)))):null}_renderFileInput(){return i.default.createElement("input",{ref:this.setRefInput,type:"file",accept:o.default.IMAGE_MIMES,style:{display:"none"},onChange:this.onFilePick,multiple:!0})}renderErrorMessage(){return i.default.createElement("div",{className:v.default.errorMessage},this.props.error)}render(){return i.default.createElement("div",{className:v.default.panel},i.default.createElement("div",{className:v.default.tileContainer},i.default.createElement(S.default,{transitionAppear:!0,transitionName:"thumb-scale-flex"},this._renderTiles(),this._renderAddImageButton()),this._renderFileInput()),this.renderErrorMessage())}}y.displayName="ProductImagesEditPanel";var I=(0,E.default)(y);t.default=I},59028:(e,t,a)=>{"use strict";var l=a(20862),s=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function({flatListController:e,onProductDetail:t,productMessageList:a}){var l=a.productCollection.getProductModels(),s=a.getSections(),_=a.getSectionsCount()>0,C=a.getTotalProductsFetchedOrFailed(),S=a.getProductSize()===C&&0===l.length,y=[];s.forEach((({title:e,products:t},a)=>{var s=[];t.forEach((({productId:e})=>{var t=l.find((t=>t.id===e));null!=t&&s.push({itemKey:`section-${a}-${t.id.toString()}`,product:t,type:"product",height:o.default.PRODUCT_LIST_ITEM_HEIGHT})})),s.length>0&&(null!=e&&""!==e&&y.push({itemKey:`header-${a}-${e}`,label:e,type:"section",height:72}),y.push(...s))}));var I=(0,r.useCallback)(((e,a)=>((0,f.logCatalogListDetailClick)({product:(0,E.unproxy)(e),catalogContext:a}),t(e))),[t]),M=(0,r.useCallback)((e=>{var t=null;switch(e.type){case"section":var{label:a}=e;t=r.default.createElement(g.default,{header:a});break;case"product":var{product:l}=e;t=r.default.createElement(d.default.Consumer,null,(e=>r.default.createElement(p.default,{product:l,onClick:()=>I(l,(0,h.getProductCatalogContext)(e)),canManageCatalog:!1})))}return t}),[I]);return(0,r.useEffect)((()=>{S&&n.default.openModal(r.default.createElement(v.default,{onConfirm:()=>{n.default.closeDrawerRight(),n.default.closeModal()}}))}),[S]),r.default.createElement("div",{className:(0,i.default)({[m.default.list]:!0,[m.default.noSections]:!_})},r.default.createElement(c.default,{flatListControllers:[e]},r.default.createElement(u.default,{flatListController:e,direction:"vertical",forceConsistentRenderCount:!1,data:y,renderItem:M,itemEnterAnimationsEnabled:!0})))};var i=s(a(94184)),r=l(a(67294)),n=s(a(97420)),o=s(a(46274)),d=s(a(31763)),u=s(a(47060)),c=s(a(3152)),f=a(58635),h=a(66248),p=s(a(89709)),m=s(a(30781)),v=s(a(7647)),g=s(a(84026)),E=a(79665)},23991:(e,t,a)=>{"use strict";var l=a(20862),s=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.ProductMessageListDrawer=void 0;var i=s(a(23493)),r=l(a(67294)),n=s(a(66281)),o=s(a(84816)),d=s(a(87655)),u=s(a(46274)),c=s(a(3395)),f=s(a(34727)),h=s(a(31763)),p=l(a(85002)),m=s(a(98712)),v=l(a(92246)),g=a(84710),E=s(a(95598)),_=s(a(12063)),C=s(a(98607)),S=s(a(66761)),y=s(a(48878)),I=a(94804),M=a(3875),P=a(66248),L=s(a(59028)),T=s(a(78656)),b=s(a(31025)),D=s(a(52206)),N=s(a(82286)),O=a(16241);class w extends r.Component{constructor(e){super(e),this._productListFlatListController=new _.default,this._handleScroll=e=>{this.state.loadingMore||e.scrollTop+u.default.SCROLL_FUDGE>e.scrollHeight-e.clientHeight&&this._loadMoreProduct()},this.handleScroll=(0,i.default)(this._handleScroll,100),this._loadMoreProduct=()=>{var{productListId:e}=this.props,{stopLoading:t,loadedProducts:a}=this.state;if(!t){var l=T.default.assertGet(e),s=l.getTotalProductsFetchedOrFailed(),i=l.getProductSize();s!==i?(this.setState({loadingMore:!0,loadedProducts:s}),T.default.update(e).checkpoint(this.props.rejectOnUnmount()).then((e=>{this.setState({loadingMore:!1}),(Array.isArray(e)?e[0]:e).getTotalProductsFetchedOrFailed()===a&&this.setState({stopLoading:!0}),s*u.default.PRODUCT_LIST_ITEM_HEIGHT<window.innerHeight&&this._loadMoreProduct()})).catchType(v.Unmount,(()=>{})).catch((()=>{this.setState({loadingMore:!1,stopLoading:!0})}))):this.setState({stopLoading:!0})}},this.onScroll=e=>{this.handleScroll(e.currentTarget),this.props.setScrollOffset&&this.props.setScrollOffset(e.currentTarget.scrollTop)},this._onCartChange=()=>{var e=this.state.cart.itemCount;this.state.cartCount!==e&&this.setState({cartCount:e})},this._onCartClick=()=>{var{contact:e,onCartClick:t}=this.props;t&&t(e.id.toString())};var t=T.default.get(this.props.productListId),a=n.default.findCart(this.props.contact.id.toString());this.state={loadingMore:!1,loadedProducts:0,stopLoading:!1,productMessageList:t,cart:a,cartCount:a.itemCount,cartEnabled:!1,productMessageListFetchState:t?"SUCCESS":"NONE"}}componentDidMount(){var{listeners:e,contact:t}=this.props;e.add(this.state.cart,"all",this._onCartChange),this.state.productMessageList?this._loadMoreProduct():this._findProductMessageList(),(0,d.default)(t.id).checkpoint(this.props.rejectOnUnmount()).then((e=>{this.setState({cartEnabled:e})})).catchType(v.Unmount,(()=>{}))}_findProductMessageList(){return T.default.find(this.props.productListId).checkpoint(this.props.rejectOnUnmount()).then((e=>{this.setState({productMessageList:e,productMessageListFetchState:"SUCCESS"}),this._loadMoreProduct()})).catch((e=>{(0,g.parseErrorState)(e,(e=>this.setState({productMessageListFetchState:e})))}))}_getDrawerContent(){var{productMessageList:e}=this.state;return e?r.default.createElement(r.default.Fragment,null,r.default.createElement("div",null,r.default.createElement(L.default,{productMessageList:e,flatListController:this._productListFlatListController,onProductDetail:this.props.onProductDetail}),this.state.loadingMore&&r.default.createElement(C.default,null))):r.default.createElement(E.default,{fetchState:this.state.productMessageListFetchState})}_getCartIcon(){var{onCartClick:e,contact:t}=this.props;if(e&&this.state.cartEnabled){var a=this.state.cartCount,l=(0,O.isNumber)(a)&&a>0?a.toString():void 0,s=(0,I.getOnCartClickWithLog)(this._onCartClick,t.id.toString(),(0,P.getProductCatalogContext)(this.context));return r.default.createElement(M.MenuBarItem,{a8nText:"menu-bar-cart-link",icon:r.default.createElement(o.default,{theme:"inherit-color"}),text:l,title:S.default.t(421),onClick:s})}return null}render(){var{productMessageList:e}=this.state;return r.default.createElement(c.default,{theme:"products",onDrop:this.props.onBack},r.default.createElement(p.default,{title:r.default.createElement("div",{className:b.default.title},r.default.createElement(m.default,{text:null==e?void 0:e.title,ellipsify:!0})),type:p.DRAWER_HEADER_TYPE.SMALL,onBack:this.props.onBack,menu:this._getCartIcon()}),r.default.createElement(f.default,{onScroll:this.onScroll,flatListControllers:[this._productListFlatListController],scrollOffset:this.props.scrollOffset},this._getDrawerContent()))}}t.ProductMessageListDrawer=w,w.contextType=h.default,w.CONCERNS={contact:["id"]},w.displayName="ProductMessageListDrawer";var k=(0,D.default)((0,y.default)((0,N.default)(w,w.CONCERNS)));t.default=k},7647:(e,t,a)=>{"use strict";var l=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function({onConfirm:e}){return s.default.createElement(i.default,{onOK:e,okText:n.default.t(1826)},s.default.createElement(r.default,{text:n.default.t(1254)}))};var s=l(a(67294)),i=l(a(58743)),r=l(a(98712)),n=l(a(66761))},43541:(e,t,a)=>{"use strict";var l=a(20862),s=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(a(96391)),r=l(a(67294)),n=s(a(57984)),o=s(a(66761)),d=l(a(30399)),u=s(a(38984)),c=(e,t)=>{var[a,l]=(0,r.useState)(!1),[s,c]=(0,r.useState)([]),f=r.default.createElement(u.default,{disabled:!a,onClick:()=>{var t,a=(0,i.default)(null===(t=s[0])||void 0===t?void 0:t.catalogWid,"products[0]?.catalogWid"),l=(0,i.default)(n.default.get(a),"CatalogCollection.get(catalogWid)");e.onShare(l)}});return r.default.createElement(d.default,{ref:t,title:o.default.t(1389),onCancel:e.onCancel,onConfirm:e.onConfirm,listType:d.ListType.PRODUCT_SELECT_MODAL,enableSearchBox:!1,customHeader:f,onSelectionChanged:(e,t,a)=>{l(0===a.length)},onDataLoaded:e=>{var t=e;c(t),l(t.length>0)}})},f=(0,r.forwardRef)(c);t.default=f},38984:(e,t,a)=>{"use strict";var l=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.disabled?o.default.disabled:"",a=e.disabled?null:e.onClick,l=s.default.createElement("span",{className:o.default.title},r.default.t(1244)),u=s.default.createElement(n.default,{theme:"compact",disabled:e.disabled},s.default.createElement(d.default,{name:"catalog"}));return s.default.createElement(i.default,{image:u,onClick:a,primary:l,theme:"list-button-compact",className:t})};var s=l(a(67294)),i=l(a(79274)),r=l(a(66761)),n=l(a(51432)),o=l(a(42082)),d=l(a(62745))},17636:(e,t,a)=>{"use strict";var l=a(20862),s=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(a(94184)),r=l(a(67294)),n=s(a(95925)),o=s(a(56656)),d=s(a(82286)),u=s(a(44710)),c=s(a(9479));class f extends r.PureComponent{render(){var{statusV3:e,contact:t}=this.props,a=(0,i.default)({[u.default.dimmed]:t.statusMute}),l=o.default.relativeDateAndTimeStr(e.t);return r.default.createElement(n.default,{className:a,key:e.id.toString(),customImage:!0,theme:"status-list",image:r.default.createElement(c.default,{statusV3:e,contact:t,onClick:this.props.onClick}),primary:t.formattedName,secondary:l,onClick:this.props.onClick,contextEnabled:()=>!1})}}f.CONCERNS={statusV3:["id","t","hasUnread","unreadCount","totalCount","contact"],contact:["formattedName","statusMute"]},f.displayName="StatusV3Cell";var h=(0,d.default)(f,f.CONCERNS);t.default=h},9479:(e,t,a)=>{"use strict";var l=a(20862),s=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(a(94184)),r=l(a(67294)),n=s(a(46274)),o=s(a(27890)),d=s(a(79553)),u=s(a(82286)),c=s(a(784)),f=a(79522),h=s(a(84080));class p extends r.PureComponent{constructor(...e){super(...e),this._handleContextMenu=()=>{}}_getMsgToRender(){var{statusV3:e,msg:t}=this.props;return null!=t?t:e.lastStatus}render(){var e,{statusV3:t,contact:a,theme:l,thumbnailPlaceholder:s}=this.props,n=E(l),d=this._getMsgToRender();return e=null!=s?s:d?r.default.createElement(o.default,{id:d.sender,theme:"status_v3",size:40}):null,r.default.createElement("div",{className:(0,i.default)(h.default.container,n),role:this.props.role||"",onContextMenu:null,onClickCapture:e=>{this.props.onClick&&this.props.onClick(),e.stopPropagation(),e.preventDefault()}},a.statusMute||"status-panel"===l?null:r.default.createElement(c.default,{statusV3:t}),r.default.createElement(m,{msg:d,theme:l,thumbnailPlaceholder:e}))}}function m(e){var{msg:t,theme:a,thumbnailPlaceholder:l}=e,s=E(a),o=h.default.statusImage;return t?t.type===n.default.MSG_TYPE.CHAT?r.default.createElement(v,{msg:t,theme:a}):r.default.createElement(d.default,{containerClassName:(0,i.default)(h.default.thumbContainer,s,h.default.statusImageFallbackBackground),childClassName:(0,i.default)(o,s),msg:t,thumbnailPlaceholder:l}):r.default.createElement("div",{className:(0,i.default)(o,s,h.default.statusImageFallbackBackground)})}function v(e){var{msg:t,theme:a}=e;return r.default.createElement("div",{className:(0,i.default)(h.default.statusImage,E(a)),style:{backgroundColor:t.statusV3TextBg}},r.default.createElement("div",{className:(0,i.default)(h.default.textThumb,E(a))},r.default.createElement(f.StatusV3Text,{msg:t,theme:null!=a?a:"status-thumbnail"})))}p.CONCERNS={statusV3:["lastStatus"],contact:["statusMute"]},p.displayName="StatusV3Thumbnail";var g=(0,u.default)(p,p.CONCERNS);function E(e){return"status-panel"===e?h.default.thumbSizeLarge:h.default.thumbSizeSmall}t.default=g},83756:(e,t,a)=>{"use strict";var l=a(95318),s=a(20862);Object.defineProperty(t,"__esModule",{value:!0}),t.search=function(e,t,a=30){var l={q:e,SafeSearch:"Strict",appid:"D41D8CD98F00B204E9800998ECF8427E4F4A7492",mkt:c[r.default.getLocale()]||c.en,size:u,aspect:d,count:a,offset:t},s=n.default.build("https://www.bingapis.com/api/v6/images/search",l);return o.default.get(s,o.default.RESP_TYPE.JSON).then((t=>{if(!t.response.hasOwnProperty("_type"))throw new i.InvalidServerResponseError(s,status,`Not a valid Bing response: ${JSON.stringify(t.response)}`);if("ErrorResponse"===t.response._type){var a=t.response;throw new i.BingServerError(e,t.status,a)}if("Images"!==t.response._type)throw new i.InvalidServerResponseError(s,status,`Did not receive an image search response, potentially malformed query ${JSON.stringify(t.response)}`);return t.response}))};var i=s(a(92246)),r=l(a(66761)),n=l(a(53918)),o=l(a(76563)),d="Square",u="Medium",c={ar:"ar-SA",da:"da-DK",de:"de-DE",en:"en-US",es:"es-US",fi:"fi-FI",fr:"fr-FR",it:"it-IT",ko:"ko-KR",nl:"nl-NL",pl:"pl-PL","pt-BR":"pt-BR",ru:"ru-RU",sv:"sv-SE",tr:"tr-TR","zh-CN":"zh-CN","zh-TW":"zh-TW","zh-HK":"zh-HK"}},94360:(e,t,a)=>{"use strict";var l=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.CatalogListItemScrollHelper=t.CollectionsContentDataSource=t.CollectionsDataSource=t.CatalogWithCollectionsDataSource=t.SingleCollectionDataSource=void 0;var s=l(a(48926)),i=l(a(57984)),r=l(a(46274));function n(e){var t=e.getData().length||0;return e.getCanLoadMore()&&o(t,e.listItemHeight)?e.loadMore().then((()=>o(e.getData().length||0,e.listItemHeight)?e.loadInitialItems():Promise.resolve(!0))):Promise.resolve(!0)}t.SingleCollectionDataSource=class{constructor(e,t,a,l){var s;(this.loading=null,this.catalog=e,this.collectionId=t,this.forCatalogManager=a,this.listItemHeight=l,t)?this.canLoadMoreCollectionItems=!(e.collections.length>0)||!!(null===(s=this.catalog.collections.get(t))||void 0===s?void 0:s.afterCursor):this.canLoadMoreAllItems=!(e.productCollection.length>0)||!!this.catalog.afterCursor}loadMore(){if(this.loading)return this.loading;if(!this.getCanLoadMore())return Promise.resolve();var e=this.collectionId;return this.loading=e?this.catalog.collections.findCollectionProducts(this.catalog.id,e,!1).then((()=>{var t;this.canLoadMoreCollectionItems=!!(null===(t=this.catalog.collections.get(e))||void 0===t?void 0:t.afterCursor),this.loading=null})):i.default.update(this.catalog.id).then((()=>{this.canLoadMoreAllItems=!!this.catalog.afterCursor,this.loading=null})),this.loading}loadInitialItems(){return n(this)}getCanLoadMore(){return this.canLoadMoreCollectionItems||this.canLoadMoreAllItems}getData(){var e,t,a=this.collectionId;a?e=(null===(t=this.catalog.collections.get(a))||void 0===t?void 0:t.productCollection.getProductModels(this.forCatalogManager))||[]:e=this.catalog.productCollection.getProductModels(this.forCatalogManager)||[];return e.map((e=>({product:e,collection:void 0})))}};t.CatalogWithCollectionsDataSource=class{constructor(e,t,a){this.loading=null,this.catalog=e,this.forCatalogManager=t,this.listItemHeight=a,this.canLoadMoreCollections=!(e.collections.length>0)||!!this.catalog.collections.afterCursor,this.canLoadMoreCatalog=!(e.productCollection.length>0)||!!this.catalog.afterCursor}loadMore(){return this.loading?this.loading:this.getCanLoadMore()?(this.canLoadMoreCollections?this.loading=this.catalog.collections.findCollectionsList(this.catalog.id,3,this.forCatalogManager).then((()=>{this.canLoadMoreCollections=!!this.catalog.collections.afterCursor,this.loading=null})):this.loading=i.default.update(this.catalog.id).then((()=>{this.canLoadMoreCatalog=!!this.catalog.afterCursor,this.loading=null})),this.loading):Promise.resolve()}loadInitialItems(){return n(this)}getCanLoadMore(){return this.canLoadMoreCollections||this.canLoadMoreCatalog}getData(){var e=this.catalog.collections.getCollectionModels(this.forCatalogManager),t=e.length>0,a=e.reduce(((e=[],t)=>{e.push({collection:t,product:void 0});var a=t.productCollection.getProductModels(this.forCatalogManager)||[];return a.length>3&&(a.length=3),e.push(...a.map((e=>({product:e,collection:t})))),e}),[]);if(this.canLoadMoreCollections)return a;t&&a.push({allItems:{totalItemsCount:a.length}});var l=this.catalog.productCollection.getProductModels(this.forCatalogManager).map((e=>({product:e,collection:void 0})));return a.push(...l),a}};t.CollectionsDataSource=class{constructor(e,t,a){this.loading=null,this.canLoadMoreCollections=!0,this.catalog=e,this.forCatalogManager=t,this.listItemHeight=a}loadMore(){return this.loading?this.loading:this.getCanLoadMore()?(this.canLoadMoreCollections&&(this.loading=this.catalog.collections.findCollectionsList(this.catalog.id,3,this.forCatalogManager).then((()=>{this.canLoadMoreCollections=!!this.catalog.collections.afterCursor,this.loading=null}))),this.loading||Promise.resolve()):Promise.resolve()}loadInitialItems(){return n(this)}getCanLoadMore(){return this.canLoadMoreCollections}getData(){return this.catalog.collections.getCollectionModels(this.forCatalogManager).map((e=>({collection:e,product:void 0})))}};function o(e,t){return e*t<window.innerHeight}t.CollectionsContentDataSource=class{constructor(e,t,a){this.loading=null,this.canLoadMore=!0,this.catalog=e,this.catalog.stale=!0,this.catalog.markProductCollectionOld(),this.catalog.productCollection.reset(),this.listItemHeight=t,this.collectionId=a}loadMore(){return this.loading?this.loading:this.getCanLoadMore()?(this.canLoadMore&&(this.collectionId?this.loading=i.default.findCollectionMembership(this.catalog.id,this.collectionId).then((()=>{this.canLoadMore=!!this.catalog.afterCursor,this.loading=null})):this.loading=i.default.update(this.catalog.id).then((()=>{this.canLoadMore=!!this.catalog.afterCursor,this.loading=null}))),this.loading||Promise.resolve()):Promise.resolve()}loadInitialItems(){return n(this)}getCanLoadMore(){return this.canLoadMore}getData(){return this.catalog.productCollection.getProductModels(!0).map((e=>({product:e,collection:void 0})))}};t.CatalogListItemScrollHelper=class{constructor(e){this.dataSource=e}isScrollAtBottom(e){return e.scrollTop+r.default.SCROLL_FUDGE>=e.scrollHeight-e.clientHeight}willLoadMore(e){return Boolean(this.dataSource.loading||this.isScrollAtBottom(e))}onScroll(e,t){var a=this;return(0,s.default)((function*(){return a.dataSource.loading?(yield a.dataSource.loading,!0):!!a.isScrollAtBottom(t)&&(yield a.dataSource.loadMore(),!0)}))()}}},18136:(e,t,a)=>{"use strict";var l=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return _.apply(this,arguments)};var s=l(a(48926)),i=a(94077),r=a(81291),n=a(16601),o=a(39655),d=a(56726),u=a(42816),c=l(a(34269)),f=a(8714);var h=/^([17]|2[07]|3[0123469]|4[013456789]|5[12345678]|6[0123456]|8[1246]|9[0123458]|\d{3})\d*?(\d{4,6})$/;function p(e){var t=h.exec(function(e){return e.user.split("@")[0]}(e));return r.Binary.build(t?t[1]+t[2]:e.toString()).readByteArray()}function m(e,t){return`00000${256*e.getUint32(t,!1)+e.getUint8(t+4)}`.slice(-5)}function v(e,t){for(var a=Promise.resolve(r.Binary.build(0,0,t,e).readByteArray()),l=0;l<5200;l++)a=a.then((e=>self.crypto.subtle.digest({name:"SHA-512"},r.Binary.build(e,t).readByteArray())));return a.then((e=>{var t=new DataView(e instanceof ArrayBuffer?e.slice(0,30):e.slice(0,30).buffer);return[m(t,0),m(t,5),m(t,10),m(t,15),m(t,20),m(t,25)].join("")}))}function g(e,t,a,l){return Promise.all([v(e,t),v(a,l)]).then((e=>e.sort().join("")))}function E(e,t,a,l){var s=new r.Binary;return(0,i.encodeProto)(o.CombinedFingerprintSpec,{version:0,localFingerprint:{publicKey:t,identifier:e},remoteFingerprint:{publicKey:l,identifier:a}},s),s.readBuffer()}function _(){return(_=(0,s.default)((function*(e){var t=(0,d.assertGetMe)(),a=yield(0,n.getFanOutList)([e,t]);try{yield(0,u.ensureE2ESessions)(a)}catch(e){__LOG__(4,void 0,new Error)`ensureE2ESessions with error`}var l=[],s=[];a.forEach((e=>{e.user===t.user?s.push(e):l.push(e)}));try{var i=yield(0,f.getAllIdentityKeysBytes)(l),r=yield(0,f.getAllIdentityKeysBytes)(s),o=yield c.default.getIdentityKeyPair();if(!o)return __LOG__(3)`getIdentityVerificationData: missing identity for device verification`,null;r.push(new Uint8Array(o.pubKey));var h=(0,f.identityKeysToBinary)(r),m=(0,f.identityKeysToBinary)(i),v=p((0,d.getMeUser)()),_=p(e),C=yield Promise.all([g(v,h,_,m),E(v,h,_,m)]);if(null==C)return null;var[S,y]=C;return{binary:y,string:S}}catch(e){return __LOG__(3)`getIdentityVerificationData: error ${e} when trying to generate identtiy QR code`,null}}))).apply(this,arguments)}},5535:(e,t,a)=>{"use strict";var l=a(20862),s=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,n.promiseLoop)((function(t,a,l){var s=(0,r.delayMs)(o.expBackoff(l,6e4,void 0,.1));return(u.default.state===u.STATE.CONNECTED?Promise.resolve():(0,d.default)(u.default,"change:state",(0,i.default)({state:u.STATE.CONNECTED}))).then((()=>e())).then((e=>{if(e.status>=500&&e.status<600)return s;t(e)})).catch((()=>s))}))};var i=s(a(6410)),r=a(73591),n=a(60561),o=l(a(19931)),d=s(a(70135)),u=l(a(11774))},48725:(e,t,a)=>{"use strict";var l=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.getTosUrl=function(){return`${i}?lg=${s.default.getLocale()}`},t.TOS_BASE_URL=void 0;var s=l(a(66761)),i="https://www.whatsapp.com/legal/";t.TOS_BASE_URL=i},71285:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.validateURL=t.validateEmail=t.EMAIL_REGEX=void 0;var l=a(53918),s=new RegExp(/^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?/);t.EMAIL_REGEX=s;t.validateEmail=e=>!e||s.test(e);t.validateURL=e=>!e||l.URL_REGEX.test(e)},11959:(e,t,a)=>{e.exports=a.p+"img/animated-doodle_600127bdb5f7627ede5cd4ef320f55b0.png"},87009:(e,t,a)=>{"use strict";a.r(t),t.default={editMain:"_2I1Ow",dayMain:"JQF0C",timeWrapper:"_3MRIR",hoursAnd:"_2JxoB",hoursMain:"_28Fp0",dayCheckbox:"_2TA8L",dayInfo:"_1nLa3",dayInfoText:"_3nHg5"}},50743:(e,t,a)=>{"use strict";a.r(t),t.default={editMain:"_3JLJ7",list:"_2E4iI",rowMain:"uomL_",rowCheckbox:"x3Vkl",rowLabel:"_2H7gl",disabled:"_2rN2h",loadingSpinner:"_2ZkHo",searchBackground:"kkGAP"}},76482:(e,t,a)=>{"use strict";a.r(t),t.default={businessHoursDayColumn:"_2e5cd",businessHoursTimeColumn:"ePJ9B",businessHoursSection:"_25cLK",businessHoursTime:"_1Fbr2",addAnotherWebsite:"_2ic4J",businessMap:"_2lFZs",mapOverlay:"_3KH8A",overlayHint:"zLudj",infoText:"egL-4",verifiedNameIcon:"vr8kz",noPaddingTop:"_3-G7O"}},62389:(e,t,a)=>{"use strict";a.r(t),t.default={loadingSpinner:"_3YfhH",retryButton:"_1Ks-M"}},89450:(e,t,a)=>{"use strict";a.r(t),t.default={editPencil:"_3n6oF",section:"_1SrUt",smallMargin:"_2TAxi",noMargin:"_3jvCQ",sectionPrimaryIcon:"_1rZAT",fieldPrimaryIcon:"p8Oeo",sectionMain:"_3rWgV",sectionContainerMain:"_39NMC",sectionEditIcon:"_3-M9v",sectionEmptyText:"qn8pr",hidden:"_1LUgV"}},19453:(e,t,a)=>{"use strict";a.r(t),t.default={info:"_3_VBJ",footer:"_1fPbz",emptyCartContainer:"_2o_Dj",emptyCardHeader:"_3hoSO",emptyCardText:"_8jb_l",btnSend:"_5P7L4",cartMessage:"_2F64R"}},65324:(e,t,a)=>{"use strict";a.r(t),t.default={price:"JOk72",actions:"_31IdY",deleteIcon:"_2fSr8",cartListItem:"_1kVL7"}},5323:(e,t,a)=>{"use strict";a.r(t),t.default={select:"_1xCOB"}},33776:(e,t,a)=>{"use strict";a.r(t),t.default={deleteIcon:"_19lTm"}},8959:(e,t,a)=>{"use strict";a.r(t),t.default={title:"_3Q5hz"}},39893:(e,t,a)=>{"use strict";a.r(t),t.default={notifyName:"_3Pmbe"}},78749:(e,t,a)=>{"use strict";a.r(t),t.default={title:"_13MJe",text:"hM3sj",icon:"_1p9YY"}},15308:(e,t,a)=>{"use strict";a.r(t),t.default={header:"_1vhuQ"}},72084:(e,t,a)=>{"use strict";a.r(t),t.default={container:"_2RE0a",border:"_3t6bN",square:"_36Gk7",avatar:"_1b8fw",count:"_1gLP4",two:"_1EzI5",first:"JOgRb",second:"_3Q0g1",three:"_33l2L",third:"_1MivT",four:"_18BoY",fourth:"_1P7KC"}},79169:(e,t,a)=>{"use strict";a.r(t),t.default={overlay:"gDU26",icon:"_28Ee5",text:"_3D1Iu"}},10721:(e,t,a)=>{"use strict";a.r(t),t.default={container:"_1E1m-",hasPrefixIcon:"FhjkT",hasPostfixIcon:"_2vpgU",content:"_1B-sn",icon:"_2rrog",prefixIcon:"_2zcko",paddedIcon:"_2SfKW"}},7890:(e,t,a)=>{"use strict";a.r(t),t.default={download_button:"_2LQ4-",downloadButton:"_2LQ4-"}},58780:(e,t,a)=>{"use strict";a.r(t),t.default={imageGallery:"_3uMAp",imageGalleryList:"_1WX5F",imageGalleryItem:"MkTEt",imageGalleryItemSpacer:"_2ppZW",imageGalleryItemImage:"_6CxGV",imageGalleryItemOverlay:"_7mUkD",selected:"_1KnO5",imageGalleryFooter:"PYlBE",focusAnimation:"_30mp5",focusAnimationKeyframes:"_3i50e"}},36344:(e,t,a)=>{"use strict";a.r(t),t.default={inputEmoji:"_3K0ya",wrapper:"_1paHP",textInput:"_3yEml",labelText:"_2YN70",clearInput:"_1U7gF",float:"_24wuh",textActive:"_1nfyj",suggestionsPositioner:"_25axk",suggestionsContainer:"_3X1SA",charCounter:"_3yMv6",inputControls:"_202sS",charCounterWithClearBtn:"T2VTG",spacer:"_3vk_J",noPlaceholder:"_1KJOl",buttonContainer:"_3Ai1P",active:"_2359L"}},20487:(e,t,a)=>{"use strict";a.r(t),t.default={container:"_3cOtp",body:"_1YLvc"}},95108:(e,t,a)=>{"use strict";a.r(t),t.default={tabContainer:"_2kl47",tab:"_3fLXe",selected:"_2TdgQ"}},6935:(e,t,a)=>{"use strict";a.r(t),t.default={versionInfo:"AwT3E"}},12843:(e,t,a)=>{"use strict";a.r(t),t.default={scaler:"_2EO74",scalerButton:"_1fjLC"}},84978:(e,t,a)=>{"use strict";a.r(t),t.default={inputContainer:"XVAlv",label:"_3zFV7",input:"_3RaCQ"}},5771:(e,t,a)=>{"use strict";a.r(t),t.default={body:"_1YHIM",thumbs:"_2il6K",thumbsContainer:"_3Sf3o",btnSend:"_19dz5",captionInput:"_1urgr",mediaBody:"_2VQwU",invalidContainer:"_2UMJ9",invalidMedia:"q5piz",mediaWarning:"eSHRj",btnAdd:"KmorN",btnAddDisabled:"_3UVYT",btnAddText:"DNiBl"}},54892:(e,t,a)=>{"use strict";a.r(t),t.default={thumb:"_2yXI9",active:"_30Jeb",body:"_2oWSB",btnDelete:"_1BdpB",bodyDoc:"_38Hry"}},46771:(e,t,a)=>{"use strict";a.r(t),t.default={container:"JKr_m",media:"_3R3yC"}},72763:(e,t,a)=>{"use strict";a.r(t),t.default={container:"_26L6R",preview:"_1yHz2",img:"_3hEGq"}},56342:(e,t,a)=>{"use strict";a.r(t),t.default={container:"_3fFxj",media:"_3lqv9",document:"hH6sl",text:"eAWMI",icon:"fDWKK"}},13149:(e,t,a)=>{"use strict";a.r(t),t.default={container:"_1ULgK",media:"_2gN82",img:"OunMM",audio:"_3ZDt1",videoContainer:"_33jN5",spinner:"_1-L7X",video:"_2Vd8_",staticPreview:"sWhPU"}},28469:(e,t,a)=>{"use strict";a.r(t),t.default={container:"_2nVq-",preview:"_1K_xd",caption:"_3xLDc",img:"_2zsdh",imgBorder:"_2Cuay"}},74481:(e,t,a)=>{"use strict";a.r(t),t.default={btnViewOnce:"_197l9",noMargin:"_2Ne5-",disabled:"_2f3_U"}},29669:(e,t,a)=>{"use strict";a.r(t),t.default={text:"woR8K",graphic:"PnU7f"}},53939:(e,t,a)=>{"use strict";a.r(t),t.default={list:"_2i0C9",hint:"_3sZ4R",button:"AoASc"}},55386:(e,t,a)=>{"use strict";a.r(t),t.default={container:"_3zKdl",body:"Sy3TC",captionInput:"_32AUO",footer:"_11gZr",retakeBtn:"rKFEM",retakeIcon:"_2rZzC",caption:"_1sxcB",videoContainer:"_2xIhM",video:"_2jZjN",btn:"_2kkeT",videoInactive:"_2eCp4",btnSend:"_1103Z",image:"_288ya",snapshot:"_3sE1m"}},43770:(e,t,a)=>{"use strict";a.r(t),t.default={container:"_sme7",chip:"_1Hi4U"}},71889:(e,t,a)=>{"use strict";a.r(t),t.default={newGroupButton:"EptxG"}},13550:(e,t,a)=>{"use strict";a.r(t),t.default={icon:"_2WtuC",body:"_3TCJd",spinner:"_1PKms",ack:"YYcY9",statusBlue:"_13UwK"}},11942:(e,t,a)=>{"use strict";a.r(t),t.default={deviceInfo:"vHpTf",deviceInfoLabel:"_1-Z2I",deviceInfoCheckbox:"IlQC9",emailLink:"_16vce"}},86088:(e,t,a)=>{"use strict";a.r(t),t.default={dropOverlay:"PHaD9",dropOverlayOutline:"WsbTY"}},25605:(e,t,a)=>{"use strict";a.r(t),t.default={btnSend:"_2fSLr",attributionLink:"_22sy6",mediaBody:"_2jVhQ",attribution:"_1kog_",footer:"_31LfW",containerBackground:"_1j68I",retake:"bZxYm",retakeIcon:"_1GJtK",mediaElementBase:"_1dxg6",mediaElement:"_1T8co _1dxg6"}},65813:(e,t,a)=>{"use strict";a.r(t),t.default={wrapper:"fvxZ_",icon:"_3kxe5",text:"sfUBV"}},32521:(e,t,a)=>{"use strict";a.r(t),t.default={linkContainer:"_3eSYR",descContainer:"_1r8tU",icon:"_3qnQ8"}},56081:(e,t,a)=>{"use strict";a.r(t),t.default={confirmationText:"_2rM2V"}},23533:(e,t,a)=>{"use strict";a.r(t),t.default={title:"_3X4ur",titleIcon:"_3v5-C",ack:"_3hJA9",statusBlue:"_31P1q",forwardCount:"_36jfD",spinner:"_3pJTm",list:"_34Zzk",footer:"W5HdQ"}},2021:(e,t,a)=>{"use strict";a.r(t),t.default={commentInput:"_2_o99",search:"_1Plju",groupInfo:"_2wLei",onSendInvite:"_2-WpU"}},51298:(e,t,a)=>{"use strict";a.r(t),t.default={animation:"o43XS","play-ltr":"_1-zyO",playLtr:"_1-zyO","play-rtl":"_27Hce",playRtl:"_27Hce",versionInfo:"_1hWGI"}},45227:(e,t,a)=>{"use strict";a.r(t),t.default={container:"srSIT",wallpaperColorCanvas:"_33YuY",wallpaperColorEmpty:"_1BHKm",canvasActive:"_3o6gY",canvasHover:"_3zuY0"}},44676:(e,t,a)=>{"use strict";a.r(t),t.default={addLabelBtContainer:"ohbFn"}},64677:(e,t,a)=>{"use strict";a.r(t),t.default={container:"_2BtE_",textContainer:"_2Tvyf",spinner:"HYKvS"}},14395:(e,t,a)=>{"use strict";a.r(t),t.default={container:"_2136P",list:"C1Dd9",header:"K1c_P",item:"_16f8P",right:"DMk3i",left:"_1mO8w",close:"_38Gu8",name:"_2z4ea",time:"_4VLPt"}},34600:(e,t,a)=>{"use strict";a.r(t),t.default={wrapper:"_9Gs_R",offline:"_3rEcJ",circle:"_2Xn1u",text:"_1nFpn",notification:"p9CjV",ended:"_2OrJW",lastUpdated:"_3VPfk"}},85529:(e,t,a)=>{"use strict";a.r(t),t.default={wrapper:"_26J0I",inactive:"_2ZG5x",offline:"Pc7bU",circle:"_1487t",text:"_2WNWn",backToCenter:"_3LWZ9",visible:"_2Ozk7"}},98057:(e,t,a)=>{"use strict";a.r(t),t.default={container:"_2BPRJ",map:"_312iE",authFailed:"xgGDH",loading:"L5P7F"}},48347:(e,t,a)=>{"use strict";a.r(t),t.default={container:"_3rs7K",selected:"_10G_J",glow:"h5TUN",stale:"_3WyhQ",expired:"_1HO_K",pin:"_2JeQm"}},67493:(e,t,a)=>{"use strict";a.r(t),t.default={list:"D0Q5P",stopSharingButton:"_8wYL"}},85753:(e,t,a)=>{"use strict";a.r(t),t.default={popup:"_1O7kH",container:"_1qWAL",twoLines:"_2dn9y",name:"_2UN5N",status:"_1fM0V",menuButton:"_2UenO",triangle:"_1NoUg"}},76747:(e,t,a)=>{"use strict";a.r(t),t.default={actionBtns:"_1s6Xm",newLabelBtn:"_3bYuL",plus:"_2ZM_7"}},94067:(e,t,a)=>{"use strict";a.r(t),t.default={mediaViewerImg:"_3X0ym",cropOverlay:"_2LR6k"}},4448:(e,t,a)=>{"use strict";a.r(t),t.default={nextButton:"_1Opmc",section:"_1p7Ee",label:"_1I3g8",control:"gwZYu"}},95575:(e,t,a)=>{"use strict";a.r(t),t.default={spinner:"_27bPO",search:"_3zFPA",inputarea:"_1x9wV",inputLine:"etp_f",contacts:"_2DdHI",drawerSection:"_37Xh5",inputareaSizer:"_2-opG"}},66915:(e,t,a)=>{"use strict";a.r(t),t.default={photoPickerWrapper:"_1Mc0y",scale:"_55HVY",nameWrapper:"_2LTDQ","well-animation":"_1EgwP",wellAnimation:"_1EgwP",phoneIcon:"_9P72S",phoneField:"_1zywm",infoText:"_3FDYs"}},4662:(e,t,a)=>{"use strict";a.r(t),t.default={icon:"_3nXFq",iconLock:"_1q7G4",text:"_2QEzO",controls:"_1O2-j",checkbox:"_3xbR9",header:"_1_8IZ"}},96601:(e,t,a)=>{"use strict";a.r(t),t.default={container:"_1J075",section:"_2BZQN",control:"_1iSYt",label:"_3AXj8",disabled:"_1Aj3d"}},96363:(e,t,a)=>{"use strict";a.r(t),t.default={more:"_394Lu",hotKeyWraper:"_3lwKF"}},83314:(e,t,a)=>{"use strict";a.r(t),t.default={body:"nWPOn",vcardWrapper:"j80SY",btnContainer:"_386ov",btnPosition:"_3o41r"}},26163:(e,t,a)=>{"use strict";a.r(t),t.default={wallpaperApplyDoodle:"_1aWJq",checkboxLabel:"XvSmy",wallpaperColorGrid:"KzJy3",wallpaperColorCanvas:"Iwkc0",wallpaperDefaultTitle:"_2jzUd",wallpaperColorEmpty:"_1qqLM",canvasHover:"_3Mp8z",canvasActive:"_2MCR7",canvasDefault:"GRVkn"}},55850:(e,t,a)=>{"use strict";a.r(t),t.default={date:"DFImE",info:"_22yfR"}},20295:(e,t,a)=>{"use strict";a.r(t),t.default={price:"_3VVtW",separator:"I8-Ql",quantity:"_3hg85"}},93543:(e,t,a)=>{"use strict";a.r(t),t.default={descriptionText:"HZZS9",loadingSpinner:"_1D_wr"}},38778:(e,t,a)=>{"use strict";a.r(t),t.default={list:"_7umF5",addItemsNotice:"FXt6h"}},57139:(e,t,a)=>{"use strict";a.r(t),t.default={collectionListItem:"_3adpN",reviewStateRejected:"hGYfr"}},70689:(e,t,a)=>{"use strict";a.r(t),t.default={collectionIcon:"_2niUF",iconContainer:"QOxRa"}},69964:(e,t,a)=>{"use strict";a.r(t),t.default={loadingSpinner:"yYjoG"}},65491:(e,t,a)=>{"use strict";a.r(t),t.default={pendingBanner:"_3oeDZ",iconContainerPending:"_1lkig",iconContainerRejected:"NHVOL",rejectedBanner:"_14t2G"}},78518:(e,t,a)=>{"use strict";a.r(t),t.default={nameContainer:"_29TgP",nameIcon:"_2VsX7",nameEdit:"ajaQb",listContainer:"g5Pwo",footer:"gsAan",saveButton:"_2992-",operation:"Ky876",spinner:"_10Kpf",isSending:"_2saS4",container:"g0kY2",loadingSpinner:"_1mBPZ"}},37201:(e,t,a)=>{"use strict";a.r(t),t.default={productWrapper:"nwLZK",drawerHeader:"_9loHN",drawerHeaderButtonContainer:"_3UHa1",deleteButtonContainer:"_1GJGf",isSending:"R3KoU",spinner:"_3Of6S",hiddenLabel:"_1wTLv",hiddenDescr:"_133oH",hiddenContainer:"dhIGH"}},97721:(e,t,a)=>{"use strict";a.r(t),t.default={addItemPlaceholder:"_13K6_",placeholderIcon:"_21z7W",placeholderContainer:"j43hv",divider:"_1fHvf",isLoading:"_3cWYA",spinner:"_3skoT"}},10462:(e,t,a)=>{"use strict";a.r(t),t.default={drawerHeader:"_361UW",productName:"_3oqif",buttonSeparator:"_1dmnE",drawerHeaderButtonContainer:"G-hW5",productWrapper:"_2OajO",businessInfoTitle:"_2Wol_"}},72974:(e,t,a)=>{"use strict";a.r(t),t.default={root:"_28jDA",appealText:"Cifen",appealLink:"_2cP3S",icon:"_3fJrr",text:"_2ZAuC"}},62831:(e,t,a)=>{"use strict";a.r(t),t.default={panel:"_2k6IR",tileContainer:"hFwyO",imageTile:"_37Ag3",imageThumb:"_2gPsu",btnDelete:"_2qZnM",deleteIcon:"_2ICL9",btnAdd:"SNrLn",btnAddContainer:"_JDHz",btnAddText:"_1rMC8",errorMessage:"_3Ueu_"}},30781:(e,t,a)=>{"use strict";a.r(t),t.default={list:"_3hjFg",noSections:"_3UBYX"}},31025:(e,t,a)=>{"use strict";a.r(t),t.default={title:"jm-c-"}},42082:(e,t,a)=>{"use strict";a.r(t),t.default={disabled:"_29h2z",title:"_2AWxj"}},44710:(e,t,a)=>{"use strict";a.r(t),t.default={dimmed:"khEuM"}},84080:(e,t,a)=>{"use strict";a.r(t),t.default={textThumb:"qgEhU",thumbSizeSmall:"_14N8a",thumbSizeLarge:"_2dKet",statusImage:"_37ckN",statusImageFallbackBackground:"_14MS9",container:"_3xFA4",thumbContainer:"_1cDhn"}}}]);