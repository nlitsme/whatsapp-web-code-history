/*! Copyright (c) 2022 WhatsApp Inc. All Rights Reserved. */
(self.webpackChunkwhatsapp_web_client=self.webpackChunkwhatsapp_web_client||[]).push([[3770],{63770:(e,t,n)=>{"use strict";var l=n(20862),r=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){let{chat:t}=e;const[n,l]=(0,u.useState)(Y.ORDER_SUMMARY),[r,i]=(0,u.useState)([]),[s,m]=(0,u.useState)(null),h=(0,c.hasCatalog)(d.BusinessProfileCollection.get((0,D.getMaybeMeUser)())),f=(0,a.default)((()=>{b.Cmd.closeDrawerRight()})),x=()=>{var e;r.length>0?(e=f,b.Cmd.openModal((0,V.jsx)(j.default,{title:o.fbt._("Discard changes?",null,{hk:"2aroAx"}),onOK:()=>{b.Cmd.closeModal(),e()},okText:o.fbt._("Discard",null,{hk:"2rIxjp"}),onCancel:()=>b.Cmd.closeModal(),children:(0,V.jsx)(U.TextDiv,{theme:"muted",children:o.fbt._("If you close this, your draft will be discarded.",null,{hk:"2Sbnur"})})}))):f()},g=()=>{l(Y.ORDER_SUMMARY)},p=()=>{l(Y.ADD_CATALOG_PRODUCTS)},C=e=>{m(Number.isInteger(e)?e:null),l(Y.CUSTOM_ITEM_FORM)},y=e=>{i((t=>[...t.slice(0,e),...t.slice(e+1)]))},S=e=>{null!=s?((e,t)=>{i((n=>[...n.slice(0,t),e,...n.slice(t+1)]))})(e,s):(e=>{i((t=>[...t,e]))})(e)},_=Q.indexOf(n);if(!n)return null;return(0,V.jsx)(W.default,{children:(0,V.jsx)(z.UIE,{displayName:`FlowDrawer${_}`,escapable:!0,requestDismiss:function(){f()},children:(0,V.jsx)("div",{children:function(e){switch(e){case Y.ADD_CATALOG_PRODUCTS:return(0,V.jsx)(ee,{onBack:g});case Y.CUSTOM_ITEM_FORM:return(0,V.jsx)(J,{onBack:g,onSaveCustomItem:e=>{S(e),g()},customItem:r[Number.isInteger(s)?Number(s):-1]});case Y.ORDER_SUMMARY:return(0,V.jsx)(te,{onBack:x,customItems:r,onAddItem:h?p:C,onDeleteItem:y,onEditCustomItem:C,chat:t})}}(n)})},_)})};var a=r(n(51463)),i=n(28298),o=n(48360),u=n(67294),s=r(n(56720)),d=n(93581),c=n(94010),m=r(n(39770)),h=n(9581),f=n(99989),x=n(64481),g=r(n(44356)),p=r(n(90233)),b=n(88102),j=r(n(52665)),C=n(79502),y=l(n(74764)),S=r(n(52814)),_=r(n(60453)),k=r(n(69637)),T=n(94790),A=r(n(33308)),M=n(47915),v=r(n(44942)),R=r(n(30855)),I=n(29623),D=n(99234),w=r(n(26757)),E=r(n(18985)),P=r(n(42116)),N=r(n(82240)),O=r(n(96152)),L=n(9468),B=r(n(88990)),F=r(n(23217)),U=n(13923),q=n(90011),z=n(18644),H=r(n(59909)),G=r(n(59552)),W=r(n(41956)),V=n(85893);const Y=n(54302).Mirrored(["ADD_CATALOG_PRODUCTS","CUSTOM_ITEM_FORM","ORDER_SUMMARY"]),Q=Array.from(Y.members()),X={drawerBody:{backgroundColor:"ihvf49ua"},buttonContainer:{display:"p357zi0d",flexDirection:"f8m0rgwh",alignItems:"gndfcl4n"},iconContainer:{display:"p357zi0d",alignItems:"gndfcl4n",width:"dyxdk6fi",height:"m3o1wsh7",borderTopStartRadius:"bbr44loe",borderTopEndRadius:"ooj5yc5b",borderBottomEndRadius:"m8i16etx",borderBottomStartRadius:"cw0ivh8j",backgroundColor:"lzol1dln"},iconSVG:{marginTop:"m3ct2rho",marginEnd:"k1jo73ug",marginBottom:"ec1z5skj",marginStart:"isfiuinm",color:"s4recxw2"},orderFieldsContainer:{gap:"sxkbojvh"},clickableText:{color:"o0rubyzf",cursor:"ajgl1lbb"}},$=y.currencyForCountryShortcode((0,C.getCountryShortcodeByPhone)((0,D.getMeUser)().user));function K(e){return Number.isInteger(e)&&+e>0}function Z(e){const t=y.formatAmount1000ToParts($,e);return`${t.symbol}${t.integer}${t.decimal}`}function J(e){let{customItem:t,onBack:n,onSaveCustomItem:l}=e;const[r,a]=(0,u.useState)(null==t?void 0:t.name),[d,c]=(0,u.useState)(Number.isInteger(null==t?void 0:t.priceAmount1000)?String(Number(null==t?void 0:t.priceAmount1000)/1e3):null),[h,f]=(0,u.useState)(Number(null==t?void 0:t.priceAmount1000)),[x,g]=(0,u.useState)(null==t?void 0:t.quantity),[p,b]=(0,u.useState)(Number.isInteger(null==t?void 0:t.quantity)?String(null==t?void 0:t.quantity):null),j=(0,u.useMemo)((()=>function(e){if(null==e)return"";const t=String(o.fbt._("Add a title",null,{hk:"3QauyV"}));return""===e.trim()?t:""}(r)),[r]),C=(0,u.useMemo)((()=>function(e){if(null==e)return"";const t=String(o.fbt._("Enter a valid price",null,{hk:"nzgo4"}));return""!==e.trim()&&y.validatePriceString($,e,L.MIN_PRICE,L.MAX_PRICE)?"":t}(d)),[d]),S=(0,u.useMemo)((()=>function(e){if(null==e)return"";const t=String(o.fbt._("Enter a valid quantity",null,{hk:"13oaEC"}));return K(Number(e))?"":t}(p)),[p]);return(0,V.jsxs)(_.default,{children:[(0,V.jsx)(T.DrawerHeader,{title:t?o.fbt._("Update items",null,{hk:"8H9jW"}):o.fbt._("Add items",null,{hk:"2SjafD"}),type:T.DRAWER_HEADER_TYPE.SMALL,onBack:n,focusBackOrCancel:!0}),(0,V.jsxs)(k.default,{className:(0,s.default)(X.drawerBody,i.uiPadding.all16),children:[(0,V.jsx)(q.TextInput,{a8n:"product-edit-drawer-item-name-input",value:r,placeholder:o.fbt._("Item name",null,{hk:"1LDktG"}),onChange:e=>{a(e)},theme:"small",customStyleThemes:["desaturated"],maxLength:150,error:j}),(0,V.jsx)(q.TextInput,{a8n:"product-edit-drawer-item-price-input",value:d,placeholder:o.fbt._("Price {symbol}",[o.fbt._param("symbol",y.formatAmount1000ToParts($,0).symbol)],{hk:"3yCPZW"}),onChange:e=>{const t=y.valueFromString($,e);f(t),c(e)},theme:"small",maxLength:30,customStyleThemes:["desaturated"],error:C}),(0,V.jsx)(q.TextInput,{a8n:"product-edit-drawer-item-quantity-input",value:p,placeholder:o.fbt._("Quantity (Optional)",null,{hk:"30uF5W"}),onChange:e=>{let t=""===e?null:Number(e);K(t)||(t=null),g(t),b(""===e?null:e)},theme:"small",maxLength:30,customStyleThemes:["desaturated"],error:S}),(0,V.jsx)("div",{className:(0,s.default)(X.buttonContainer,i.uiMargin.top16),children:(0,V.jsx)(m.default,{type:"primary",disabled:null==r||null==d||[j,C,S].some((e=>e)),onClick:()=>{l({name:r,priceAmount1000:h,quantity:x})},children:t?o.fbt._("Update",null,{hk:"iXFTM"}):o.fbt._("Add",null,{hk:"3ogfSW"})})})]})]})}function ee(e){let{onBack:t}=e;const n=(0,H.default)(),l=(0,G.default)((()=>new R.default)),r=(0,G.default)((()=>new w.default([],(e=>e.id.toString())))).current,a=e=>{const t=r.isSelected(e);r.setVal(e,t?0:1),n()},i=(e,t)=>{r.setVal(e,t),n()};return(0,V.jsxs)(_.default,{children:[(0,V.jsx)(T.DrawerHeader,{title:o.fbt._("Add items",null,{hk:"2nsVXo"}),type:T.DRAWER_HEADER_TYPE.SMALL,onBack:t,focusBackOrCancel:!0}),(0,V.jsx)(k.default,{children:(0,V.jsx)(v.default,{flatListControllers:[l.current],children:(0,V.jsx)(M.FlatList,{flatListController:l.current,direction:"vertical",forceConsistentRenderCount:!1,data:(()=>{const e=f.CatalogCollection.get((0,D.getMaybeMeUser)());if(!e)return[];return e.productCollection.getProductModels().map((e=>({itemKey:e.id.toString(),product:e})))})(),renderItem:e=>{let{product:t}=e;return(0,V.jsx)(ne,{product:t,selections:r,onProductClick:a,onProductQuantityChange:i})},defaultItemHeight:x.PRODUCT_LIST_ITEM_HEIGHT})})})]})}function te(e){let{chat:t,customItems:n,onBack:l,onAddItem:r,onDeleteItem:a,onEditCustomItem:d}=e;const[c,m]=(0,u.useState)(null),h=(0,V.jsx)("div",{className:(0,s.default)(X.iconContainer),children:(0,V.jsx)(F.default,{className:(0,s.default)(X.iconSVG),name:"add-item"})}),f=n.reduce(((e,t)=>{var n;return e+t.priceAmount1000*(null!==(n=t.quantity)&&void 0!==n?n:1)}),0),x=o.fbt._("Add a note",null,{hk:"2nf5qm"}),p=0!==n.length;return(0,V.jsxs)(_.default,{children:[(0,V.jsx)(T.DrawerHeader,{title:p?o.fbt._("Review Order",null,{hk:"1yDsQ1"}):o.fbt._("Create order",null,{hk:"3snLWG"}),onBack:l,type:T.DRAWER_HEADER_TYPE.SMALL}),(0,V.jsxs)(k.default,{children:[(0,V.jsx)(A.default,{xstyle:[i.uiPadding.top20,i.uiPadding.horiz16,i.uiPadding.bottom15],theme:"refresh-padding-title",children:(0,V.jsxs)(E.default,{children:[(0,V.jsx)(P.default,{sellerWid:(0,D.getMeUser)(),orderStatus:(0,V.jsx)(N.default,{})}),(0,V.jsxs)(I.FlexColumn,{align:"stretch",xstyle:i.uiMargin.horiz0,children:[(0,V.jsx)(g.default,{image:h,primary:o.fbt._("Add item",null,{hk:"3uoH1r"}),theme:"add-order-item",onClick:r}),(()=>{const e=(0,V.jsx)("div",{className:(0,s.default)(X.iconContainer),children:(0,V.jsx)(F.default,{className:(0,s.default)(X.iconSVG),name:"list-msg-icon"})});return n.map(((t,n)=>{const l=Z(t.priceAmount1000),r=o.fbt._("Quantity {item-quantity}",[o.fbt._param("item-quantity",t.quantity)],{hk:"39jSdf"});return(0,V.jsx)("div",{className:(0,s.default)(i.uiPadding.top20),children:(0,V.jsx)(g.default,{image:e,primary:t.name,secondary:null!=t.quantity?r:null,theme:"media",onMouseOver:()=>{m(n)},onMouseLeave:()=>{m(null)},detail:c===n?(0,V.jsx)(S.default,{onClick:e=>{e.stopPropagation(),a(n)}}):l,onClick:()=>{d(n)}})},n)}))})()]}),(0,V.jsxs)(I.FlexColumn,{align:"stretch",xstyle:X.orderFieldsContainer,children:[(0,V.jsxs)(I.FlexRow,{justify:"all",children:[(0,V.jsx)(U.TextSpan,{color:"secondary",size:"16",children:o.fbt._("Subtotal",null,{hk:"4ciFet"})}),(0,V.jsx)(U.TextSpan,{color:"secondary",size:"16",children:Z(f)})]}),p&&(0,V.jsx)(I.FlexRow,{justify:"all",align:"center",children:(0,V.jsx)("span",{className:(0,s.default)(X.clickableText),children:o.fbt._("Additional Charges",null,{hk:"3I4vSr"})})})]}),p&&(0,V.jsx)(I.FlexRow,{justify:"all",align:"center",children:(0,V.jsx)("span",{className:(0,s.default)(X.clickableText),children:o.fbt._("Add payment method",null,{hk:"1FNuLD"})})})]})}),p&&(0,V.jsxs)(A.default,{xstyle:[i.uiPadding.top20,i.uiPadding.horiz16],theme:"refresh-padding-title",children:[(0,V.jsxs)(I.FlexRow,{justify:"all",children:[(0,V.jsx)(U.TextSpan,{theme:"title",weight:"medium",children:o.fbt._("Total",null,{hk:"7xRrT"})}),(0,V.jsx)(U.TextSpan,{theme:"title",weight:"medium",children:"-"})]}),(0,V.jsx)(O.default,{chat:t,placeholder:x,value:"",onChange:()=>{},onSubmit:()=>{},buttonTitle:x,a8nTextButton:"order-create-button"})]})]})]})}function ne(e){let{product:t,selections:n,onProductClick:l,onProductQuantityChange:r}=e;return(0,V.jsx)(p.default,{model:t,selections:n,children:(0,V.jsx)(B.default,{product:t,onClick:()=>l(t),checkbox:!0,detail:n.isSelected(t)&&(0,V.jsx)("div",{children:(0,V.jsx)(le,{quantity:Number(n.getVal(t)),onChange:e=>r(t,e)})})})},t.id.toString())}function le(e){return(0,V.jsx)("div",{children:(0,V.jsx)("select",{onClick:function(e){e.preventDefault(),e.stopPropagation()},value:e.quantity,onChange:function(t){e.onChange(Number(t.currentTarget.value))},children:function(){const e=[];for(let t=1;t<=h.MAX_QUANTITY;t++)e.push((0,V.jsx)("option",{value:t,children:t},t));return e}()})})}}}]);
//# sourceMappingURL=https://web.whatsapp.com/3770.a493ccb47bc0d4fa423a.js.map
