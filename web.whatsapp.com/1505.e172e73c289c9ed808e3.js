/*! Copyright (c) 2022 WhatsApp Inc. All Rights Reserved. */
(self.webpackChunkwhatsapp_web_client=self.webpackChunkwhatsapp_web_client||[]).push([[1505],{158114:(e,l,a)=>{"use strict";Object.defineProperty(l,"__esModule",{value:!0}),l.JobBuilder=void 0,l.definePersistedJob=function(){return new r([])};var n=a(247901),t=a(892844);class r{constructor(e){this.steps=e}step(e,l){return this._stepWithOptions(e,"function"==typeof l?{code:l}:l)}_stepWithOptions(e,l){const{stopRetryIf:a,requirements:u,code:o}=l;let d=s(u,o,a);if(a){const{timePassedSeconds:e,appCrashed:l,onStopRetry:r}=a,u=s(null,function(e){return(l,a,t)=>Promise.resolve(e(l,a,t)).then((e=>e instanceof n.InterruptJob?e:new n.InterruptJob(e)))}(r),a);null!=e&&(d=i(((l,a,n)=>{let{jobStartTime:r}=n;return(0,t.happenedWithin)(r,e)}),d,u)),l&&(d=i(((e,l,a)=>{let{afterCrash:n}=a;return!n}),d,u))}return new r([...this.steps,{stepName:e,info:d}])}finalStep(e,l){const a=this.step(e,l);return{end:()=>a.steps}}}function i(e,l,a){return(n,t,r)=>e(n,t,r)?l(n,t,r):a(n,t,r)}function s(e,l,a){const n={requirements:e,code:l,stopRetryIf:a};return()=>n}l.JobBuilder=r},426046:e=>{"use strict";const l={fragment:{argumentDefinitions:a=[{defaultValue:null,kind:"LocalArgument",name:"request"}],kind:"Fragment",metadata:null,name:"queryProductListCatalogQuery",selections:r=[{alias:null,args:[{kind:"Variable",name:"request",variableName:"request"}],concreteType:"XWAProductCatalogGetProductListResponseSuccess",kind:"LinkedField",name:"xwa_product_catalog_get_product_list",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{alias:null,args:null,concreteType:"XWAProductCatalogGetProductListResponseSuccessProductList",kind:"LinkedField",name:"product_list",plural:!1,selections:[{alias:null,args:null,concreteType:"XWACatalogProduct",kind:"LinkedField",name:"products",plural:!0,selections:[n={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"retailer_id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_hidden",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"availability",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"currency",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"price",storageKey:null},{alias:null,args:null,concreteType:"XWAProductCatalogProductStatusInfo",kind:"LinkedField",name:"status_info",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"can_appeal",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"status",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XWAProductCatalogProductSalePrice",kind:"LinkedField",name:"sale_price",plural:!1,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"start_date",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"end_date",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XWAProductCatalogProductMedia",kind:"LinkedField",name:"media",plural:!1,selections:[{alias:null,args:null,concreteType:"XWAProductCatalogProductMediaImage",kind:"LinkedField",name:"images",plural:!0,selections:[n,{alias:null,args:null,kind:"ScalarField",name:"original_image_url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"request_image_url",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"belongs_to",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"compliance_category",storageKey:null},{alias:null,args:null,concreteType:"XWAProductCatalogProductComplianceInfo",kind:"LinkedField",name:"compliance_info",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"country_code_origin",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"importer_name",storageKey:null},{alias:null,args:null,concreteType:"XWAProductCatalogProductComplianceInfoImporterAddress",kind:"LinkedField",name:"importer_address",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"street1",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"street2",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"postal_code",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"city",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"region",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"country_code",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"queryProductListCatalogQuery",selections:r},params:{id:"queryProductListCatalogQuery",metadata:{},name:"queryProductListCatalogQuery",operationKind:"query",text:null}};var a,n,t,r;l.hash="2022513dc8cc1eb839cc2d3078d946a9",e.exports=l},578972:(e,l,a)=>{"use strict";Object.defineProperty(l,"__esModule",{value:!0}),l.defineWebPersistedJob=function(){return(0,n.definePersistedJob)()};var n=a(158114)},371505:(e,l,a)=>{"use strict";var n=a(595318);Object.defineProperty(l,"__esModule",{value:!0}),l.QueryProductListCatalog=void 0;var t,r=n(a(348926)),i=a(736184),s=n(a(653872)),u=n(a(145095)),o=a(831914),d=a(471914),c=a(492574),g=a(732624),p=a(248089),y=a(408139),_=a(801321),m=a(745454),f=n(a(357291)),k=a(578972),S=a(890667),h=a(653069),P=a(526002),F=a(139410);const K=new d.WapParser("productListResponse",(e=>{e.assertTag("iq"),e.assertFromServer();const l=e.child("product_list"),a=[];return l.forEachChildWithTag("product",(e=>{const l=e.maybeChild("id");if(!l)return;const n=e.maybeChild("status");(null==n?void 0:n.contentString())===P.INVALID_PRODUCT_TOKEN?a.push({id:l.contentString(),status:P.INVALID_PRODUCT_TOKEN}):a.push((0,S.parseProductNode)(e))})),a})),C=function(){var e=(0,r.default)((function*(e){let{catalogWid:l,productIds:a,width:n,height:t,directConnectionEncryptedInfo:r}=e;const s=(0,o.wap)("iq",{to:o.S_WHATSAPP_NET,type:"get",smax_id:"21",xmlns:"w:biz:catalog",id:(0,o.generateId)()},(0,o.wap)("product_list",{jid:(0,F.USER_JID)((0,m.createWid)(l))},a.map((e=>(0,o.wap)("product",null,(0,o.wap)("id",null,e)))).concat((0,f.default)([(0,o.wap)("width",null,n.toString()),(0,o.wap)("height",null,t.toString()),r?(0,o.wap)("direct_connection_encrypted_info",null,r):null])))),u=yield(0,i.sendIq)(s,K);if(u.success)return u.result;throw new c.ServerStatusCodeError(u.errorCode)}));return function(){return e.apply(this,arguments)}}(),L=function(){var e=(0,r.default)((function*(e){try{var l,n;const{catalogWid:r,productIds:i,width:s,height:o,directConnectionEncryptedInfo:d}=e,c=yield(0,_.fetchQuery)(void 0!==t?t:t=a(426046),{request:{product_list:{jid:r.toString(),products:i.map((e=>({id:e}))),width:String(s),height:String(o),direct_connection_encrypted_info:d}}},{eventLogger:(0,g.createCatalogEventLogger)(g.GRAPHQL_CATALOG_ENDPOINT.GET_PRODUCT_LIST)});return(0,u.default)(null==c||null===(l=c.xwa_product_catalog_get_product_list)||void 0===l||null===(n=l.product_list)||void 0===n?void 0:n.products.map(h.parseProductGraphQL),"data?.xwa_product_catalog_get_product_list?.product_list?.products.map(parseProductGraphQL)")}catch(l){return l instanceof p.GraphQLServerError&&(0,s.default)(l),__LOG__(3)`GraphQL: Failed fetching xwa_product_catalog_get_product_list query. Falling back to IQ.`,C(e)}}));return function(){return e.apply(this,arguments)}}(),b=(0,k.defineWebPersistedJob)().finalStep("sendStanza",(e=>((0,y.graphQLForCatalogM1Enabled)()?L:C)(e))).end();l.QueryProductListCatalog=b}}]);
//# sourceMappingURL=https://web.whatsapp.com/1505.e172e73c289c9ed808e3.js.map
