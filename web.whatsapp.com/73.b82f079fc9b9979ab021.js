/*! Copyright (c) 2022 WhatsApp Inc. All Rights Reserved. */
(self.webpackChunkwhatsapp_web_client=self.webpackChunkwhatsapp_web_client||[]).push([[73],{217810:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.JobBuilder=void 0,t.definePersistedJob=function(){return new i([])};var s=n(814271),r=n(990445);class i{constructor(e){this.steps=e}step(e,t){return this._stepWithOptions(e,"function"==typeof t?{code:t}:t)}_stepWithOptions(e,t){const{stopRetryIf:n,requirements:u,code:d}=t;let c=a(u,d,n);if(n){const{timePassedSeconds:e,appCrashed:t,onStopRetry:i}=n,u=a(null,function(e){return(t,n,r)=>Promise.resolve(e(t,n,r)).then((e=>e instanceof s.InterruptJob?e:new s.InterruptJob(e)))}(i),n);null!=e&&(c=o(((t,n,s)=>{let{jobStartTime:i}=s;return(0,r.happenedWithin)(i,e)}),c,u)),t&&(c=o(((e,t,n)=>{let{afterCrash:s}=n;return!s}),c,u))}return new i([...this.steps,{stepName:e,info:c}])}finalStep(e,t){const n=this.step(e,t);return{end:()=>n.steps}}}function o(e,t,n){return(s,r,i)=>e(s,r,i)?t(s,r,i):n(s,r,i)}function a(e,t,n){const s={requirements:e,code:t,stopRetryIf:n};return()=>s}t.JobBuilder=i},193182:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.defineWebPersistedJob=function(){return(0,s.definePersistedJob)()};var s=n(217810)},620073:(e,t,n)=>{"use strict";var s=n(595318);Object.defineProperty(t,"__esModule",{value:!0}),t.deleteReations=void 0;var r=s(n(348926)),i=n(798299),o=n(728088),a=n(193182),u=s(n(565754));const d=(0,a.defineWebPersistedJob)().step("deleteReactions",(e=>{let{chatId:t,parentMsgKeys:n}=e;return __LOG__(2)`Persisted: deleteReaction persisted job started`,{chatId:t,parentMsgKeys:n}})).step("deleteReactionsFromReactionsTable",function(){var e=(0,r.default)((function*(e){let{chatId:t,parentMsgKeys:n}=e;const s=yield(0,i.deleteReactionsByParentMessageKeys)(n);return s||(__LOG__(2)`Persisted: Deleting reactions from Reactions table returned undefined, parentMsgKeys length ${n.length}`,[])}));return function(){return e.apply(this,arguments)}}()).finalStep("deleteReactionsFromMessageTable",function(){var e=(0,r.default)((function*(e,t){let{chatId:n,parentMsgKeys:s}=t;const r=[];return e||__LOG__(2)`Persisted: Deleting reactions from Msg table, reactionMsgKeys is undefined, parentMsgKeys length ${s.length}`,e.forEach((e=>{u.default.fromString(e).fromMe&&r.push(e)})),r.length>0&&(yield(0,o.removeMessagesFromHistory)(r)),e}));return function(){return e.apply(this,arguments)}}()).end();t.deleteReations=d}}]);
//# sourceMappingURL=https://web.whatsapp.com/73.b82f079fc9b9979ab021.js.map
